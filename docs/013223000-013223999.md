# StackOverflow 问答 13223000-13223999

# php - 关于使用后退按钮的 Web 导航

> ID：13223000
> 
> 赞同：2
> 
> 时间：2012-11-04T21:15:30.330
> 
> 标签：php, html, http

我试图研究这个问题，但没有找到如何处理这个问题的运气。谁能指出我正确的方向？

考虑我要使用三个脚本：homepage.php、list.php、form.php。

从概念上讲，用户将在主页上表明他们想要查看列表。然后，用户可以单击列表的元素，以调出允许他们更改列表项属性的表单。用户提交表单并返回到列表，以便他们可以继续查看列表并在需要时对列表项进行更改。

现在问题来了，当用户回击这一点时，我希望他们返回主页，因为他们当前正在查看列表，并且在网络应用程序的上下文中，此时返回应该返回用户到主页。相反，如果他们回击，他们会返回表单（使用 PRG，因此双张贴没有问题），然后返回列表，然后返回主页。

**目前会发生什么：**

*   openbrowser -> 获取 homepage.php
*   homepage.php -> 获取列表.php
*   list.php -> 获取 form.php
*   form.php -> PRG（POST 到 form.php，重定向回 l​​ist.php）
*   list.php -> 用户回击，GET form.php
*   form.php -> 用户回击，GET list.php
*   list.php -> 用户回击，获取 homepage.php

**我想要发生的事情，但不知道如何：**

*   openbrowser -> 获取 homepage.php
*   homepage.php -> 获取列表.php
*   list.php -> 获取 form.php
*   form.php -> PRG（POST 到 form.php，重定向回 l​​ist.php）
*   list.php -> 用户回击，获取 homepage.php

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T15:39:27.653

```
header("Expires: Sun, 19 Nov 1978 05:00:00 GMT");
header("Last-Modified: " . gmdate("D, d M Y H:i:s") . " GMT");
header("Cache-Control: no-store, no-cache, must-revalidate");
header("Cache-Control: post-check=0, pre-check=0", FALSE); 
```

您可以在不希望浏览器缓存的页面中使用此标头，以便您可以控制用户何时点击后退按钮。

在您的情况下，您可以在 form.php 上有此标头，您可以使用会话或 HTTP 引荐来源网址或任何东西来跟踪页面来自何处并相应地重定向

# java - 如何在connection.release_mode（spring + hibernate）中设置Diffrent值然后'auto'

> ID：13223019
> 
> 赞同：0
> 
> 时间：2012-11-04T21:17:44.307
> 
> 标签：java, spring, hibernate, connection, isolation-level

是否可以为休眠属性设置一个不同的值然后“自动”-“connection.release_mode”？

我们将 Spring 与休眠一起使用，当我尝试在此属性中定义 - 'after_transaction' （当我在会话工厂定义中定义休眠属性时），在运行时我得到一个异常（Spring 异常），它是唯一有效的值（以 Spring 术语）因为这个道具是'on_close'。这个事实给我们带来了很多麻烦。我们使用 session-per-request 模式（意思是“客户端向运行 Hibernate 持久层的服务器发送请求。Hibernate 打开一个新 Session，所有数据库操作都在这个工作单元中执行。”（[hibernate doc](http://docs.jboss.org/hibernate/orm/4.0/devguide/en-US/html/ch02.html#session-per-operation) ). 当 on_close 被定义时 - 为每个服务分配连接（没有重用连接）。

我们使用 HibernateTransactionManager 结合 TransactionInterceptor 来管理事务。我们使用 AnnotationSessionFactoryBean（我们的会话工厂）处理会话，我尝试在“hibernateProperties”部分 -> connection.release_mode=after_transaction 中定义会话工厂声明。在运行时，当服务器尝试加载会话工厂时，我得到了这个异常：

```
org.springframework.transaction.InvalidIsolationLevelException: HibernateTransactionManager is not allowed to support custom isolation levels: make sure that its 'prepareConnection' flag is on (the default) and that the Hibernate connection release mode is set to 'on_close' (SpringTransactionFactory's default). Make sure that your LocalSessionFactoryBean actually uses SpringTransactionFactory: Your Hibernate properties should *not* include a 'hibernate.transaction.factory_class' property!
    at org.springframework.orm.hibernate3.HibernateTransactionManager.doBegin(HibernateTransactionManager.java:515)
    ... 121 more 
```

为什么春天这样做？是否有旁路

任何意见，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-10-11T12:51:41.440

要设置不同的连接释放模式，您必须创建一个文件

`src/main/resources/hibernate.properties`

并设置值

`hibernate.connection.release_mode=AFTER_STATEMENT`

其他可用值可以在[这里找到](https://docs.jboss.org/hibernate/stable/core.old/reference/en/html/transactions-connection-release.html)

# linux - bash 使用 getopts

> ID：13223020
> 
> 赞同：2
> 
> 时间：2012-11-04T21:17:52.537
> 
> 标签：linux, bash

脚本使用示例

```
./foo.sh -v -r /home/ -s /home/user/file
./foo.sh -r /home/ -s /home/user/file 
```

在参数中，我总是需要一个文件或文件夹来扫描和一个数据库文件（-s 数据库文件）

在 foo.sh 里面

```
function entrance()
{
while getopts "v:r:s" opt; do
  case $opt in
    v)
      echo "-v was triggered, Verbose mode" >&2
      ;;
    r)
      echo "-r was triggered, recursive mode: $OPTARG" >&2
      ;;
    s)
      echo "-s was triggered, DATABASE: $OPTARG" >&2
      ;;
    \?)
      echo "Invalid option: -$OPTARG" >&2
      exit 1
      ;;
    :)
      echo "Option -$OPTARG requires an argument." >&2
      exit 1
      ;;
  esac
done
} 
```

我不知道为什么它不起作用。

请修理我。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T21:39:57.260

您可能在调用函数时忘记了 $@。看到这个：

```
#!/bin/bash

function entrance() {
while getopts "v:r:s" opt; do
  case $opt in
    v)
      echo "-v was triggered, Verbose mode" >&2
      ;;
    r)
      echo "-r was triggered, recursive mode: $OPTARG" >&2
      ;;
    s)
      echo "-s was triggered, DATABASE: $OPTARG" >&2
      ;;
    \?)
      echo "Invalid option: -$OPTARG" >&2
      exit 1
      ;;
    :)
      echo "Option -$OPTARG requires an argument." >&2
      exit 1
      ;;
  esac
done
}

entrance "$@" 
```

还有一些解释：[在 bourne shell 的用户定义函数中使用 getopts](https://stackoverflow.com/questions/352044/using-getopts-within-user-defined-function-in-bourne-shell)

# matlab - Matlab - 编辑文本

> ID：13223021
> 
> 赞同：2
> 
> 时间：2012-11-04T21:18:10.130
> 
> 标签：matlab, user-interface, plot, handles

我想要做的是，当我输入“编辑文本”（称为`funkcia_edit`：）某些功能时，它会将我吸引到该功能。这是我想要做的图片，你可以看到我已经声明了变量 X 和 Y，其中 Y 代表`funkcia_edit`= `x.^2`，然后我想绘制（x，y）。任何人都可以帮助我如何使它工作吗？

谢谢

![在此处输入图像描述](../Images/5a8906d658631372df263123fc876a5c.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T22:36:48.753

我认为您缺少的是 Matlab 中的[eval](http://www.mathworks.com/help/matlab/ref/eval.html)函数。如果我没记错的话你想做的是

```
y = eval(get(hObject,'String')); 
```

请注意，虽然这可能是在 MATLAB 中编程此功能的最简单方法，但不一定是最安全的。用户可以编写`system('rm -rf *')`，您的程序将对其进行评估。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T07:44:41.363

您还可以使用`ezplot`：

```
 ezplot(get(hObject,'String')); 
```

# c++ - 如何访问字符串的元素？

> ID：13223026
> 
> 赞同：1
> 
> 时间：2012-11-04T21:18:43.873
> 
> 标签：c++

我无法访问二进制字符串的各个字符来确定它们是否已设置，我做错了什么？或者有没有更简单的方法？这是我的代码：

```
#include <iostream>
#include <string>

using namespace std;

float BinToDec(const string & bin) {
    short length = bin.length();
    float result = 1.0f;

    const char * str = bin.c_str();

    for (int i = 0; i < length; ++i) {
        if ( &str[i] == "1") cout << "SET" << endl << endl;
        else cout << "NOT SET" << endl << endl;
    }

    return result;
}

int main() {

    string bin = "";

    cout << "Input a binary number: ";
    cin >> bin;

    cout << BinToDec(bin) << endl << endl;

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T21:29:06.137

您可以直接在您的 string 上进行迭代`bin`，无需获取`const char *`，`&`这里也不需要操作符，因为通过使用`[]`您已经取消引用并获得 a `char`（这就是为什么您不应该将其与 "1" 进行比较，即不是 char 而是`string literal`)

总而言之，我认为这将是一个更好的方法：

```
for (int i = 0; i < length; ++i) {
        if ( bin[i] == '1') 
             cout << "SET" << endl << endl;
        else 
             cout << "NOT SET" << endl << endl;
} 
```

此外，现在将长度存储在 a 中`short`可能有效，但字符串长度超过了最大值`short`，因此您应该使用`size_t`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T21:24:27.913

它不适合你，因为：

*   你有点试图获得一个子字符串来与字符串进行比较`"1"`，但你的子字符串将在输入的末尾终止......即可能超过`1`字符。
*   比较 C 字符串与`==`仅比较指针值

相反，只比较单个字符：

```
if ( str[i] == '1') cout << "SET" << endl << endl;
//  ^          ^ ^
//  |        character literals are delimited by _single_ quotes
// no `&` required 
```

但我不明白你为什么要使用`.c_str()`；直接操作`bin`而不是创建这个 C-string `str`：

```
float BinToDec(const string& bin)
{
    size_t length = bin.length();
    float result = 1.0f;

    for (int i = 0; i < length; ++i) {
        if (bin[i] == '1')
           cout << "SET" << endl << endl;
        else
           cout << "NOT SET" << endl << endl;
    }

    return result;
} 
```

我还更正了`length`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T21:24:30.310

如果您确定要使用 C 样式的字符串执行此操作，请更改：

```
if ( &str[i] == "1") cout << "SET" << endl << endl; 
```

至

```
if ( str[i] == '1') cout << "SET" << endl << endl; 
```

这样，您将比较`str`with的单个字符`'1'`，即文字字符（而不是`"1"`包含 1 个字符的字符串。

您现有的代码将偏移量 i 的地址带入 c_str()，这实际上与从字符 i 开始的字符串结尾相同，并将其与文字字符串“1”进行比较。请注意，您不能像这样进行 C 风格的字符串比较，因为它会比较底层指针。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T21:28:00.777

由于您试图检查每个字符的值，因此使用单引号而不是双引号。

```
float BinToDec(const string & bin) {
    short length = bin.length();
    float result = 1.0f;

    const char * str = bin.c_str();

    char c; 
    for (int i = 0; i < length; ++i) {
        c = str[i];

        // Use single quotes and not double quotes here
        if ( c == '1') cout << "SET" << endl << endl;
        else cout << "NOT SET" << endl << endl;
    }

    return result;
} 
```

也就是说，我认为 lccarrasco 的方式是做你想要实现的目标的正确方式。

# c# - 如何将数字组合成一个唯一的和

> ID：13223029
> 
> 赞同：0
> 
> 时间：2012-11-04T21:18:51.147
> 
> 标签：c#, algorithm

我不记得这个名字了，但我记得见过一次。我需要总结一个序列：

```
2:hand 
5:leg 
13:head 
```

像 7 这样的数字。

然后当我得到 7 时，我知道是手+腿。如果我得到 20，我知道是手+腿+头。

这种技术叫什么名字？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T21:21:19.673

你的意思是一个[标志](http://msdn.microsoft.com/en-us/library/system.flagsattribute.aspx)枚举？

```
[Flags]
enum Parts
{
    Hand = 1,
    Leg = 2,
    Head = 4,
} 
```

*例子：*

```
Parts p = Parts.Hand | Parts.Leg;

bool isHand = (p & Parts.Hand) != 0; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T21:20:16.810

您说的是位掩码，通常使用用[[FlagsAttribute]](http://msdn.microsoft.com/en-us/library/system.flagsattribute.aspx)装饰的枚举来实现。这些值将是 2 的幂。

有关在 C# 中使用 [FlagsAttribute] 的说明，请参阅以下 SO 答案。

[https://stackoverflow.com/a/3261485/444610](https://stackoverflow.com/a/3261485/444610)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T21:21:56.127

这就是[子集和问题](http://en.wikipedia.org/wiki/Subset_sum_problem)。

# android - Android 上的日志消息：/dev/pmem: Unmapping buffer base

> ID：13223030
> 
> 赞同：5
> 
> 时间：2012-11-04T21:18:53.933
> 
> 标签：android, memory, logging, message

我刚刚“完成”了我的新应用程序。当我用我的低成本平板电脑（大量可用内存）对其进行测试时，一切似乎都很好。但如果我有时在我的 HTC 手机上运行它，我会在日志窗口中看到一条消息：

```
11-04 22:11:34.570: D/memalloc(16419): /dev/pmem: Unmapping buffer base:0x527a0000 size:6144000 offset:4608000 
```

我很难找到对此消息的解释。有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T04:21:09.440

发现这个：

> pmem 驱动程序用于管理在用户空间和内核驱动程序（dsp、gpu 等）之间共享的大型 (1-16+MB) 物理上连续的内存区域。它是专门为解决 MSM7201A 的硬件限制而编写的，但也可用于其他芯片组。现在，您可以安全地在 x86 上将其关闭。

[https://groups.google.com/forum/?fromgroups=#!topic/android-kernel/U05uERWkPKg](https://groups.google.com/forum/?fromgroups=#!topic/android-kernel/U05uERWkPKg)

# sql - 如何在不使用 SQL 中的相关子查询的情况下获取最早的日期？

> ID：13223035
> 
> 赞同：2
> 
> 时间：2012-11-04T21:19:29.723
> 
> 标签：sql, oracle, greatest-n-per-group, correlated-subquery

以下代码列出了所有发票，我只想要供应商的最旧发票：

```
SELECT DISTINCT vendor_name, i.invoice_number AS OLDEST_INVOICE, 
    MIN(i.invoice_date), i.invoice_total
FROM vendors v
JOIN invoices i
ON i.vendor_id = v.vendor_id
GROUP BY vendor_name, invoice_number, invoice_total
ORDER BY MIN(i.invoice_date); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T22:36:36.787

我们将使用`ROW_NUMBER()`按日期对每个供应商的发票进行“排名”，然后仅选择每个供应商最旧的发票：

```
SELECT vendor_name, invoice_number AS oldest_invoice, invoice_date, invoice_total
  FROM vendors v
 INNER JOIN (SELECT invoices.*,
                    ROW_NUMBER() OVER (PARTITION BY vendor_id ORDER BY invoice_date ASC)
                      AS rn
               FROM invoices) i
       ON i.vendor_id = v.vendor_id
          AND
          i.rn = 1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T22:18:31.100

TDQD 的时间——测试驱动的查询设计

每个供应商开具发票的最短日期为：

```
SELECT vendor_id, MIN(invoice_date) AS invoice_date
  FROM invoices
 GROUP BY vendor_id 
```

相应的最小发票编号（假设在为供应商开具发票的第一天可能已经发送了多张发票，如果`invoice_date`是没有时间组件的真实 DATE；如果 DATE 包含时间组件，则第二个 MIN() 可能是不必要的），是：

```
SELECT vendor_id, MIN(invoice_number) AS invoice_number
  FROM invoices AS i
  JOIN (SELECT vendor_id, MIN(invoice_date) AS invoice_date
          FROM invoices
         GROUP BY vendor_id
       ) AS j ON j.vendor_id = i.vendor_id AND j.invoice_date = i.invoice_date
 GROUP BY vendor_id 
```

您可以将此表达式与其他表连接以满足您的查询要求：

```
SELECT v.*, i.*
  FROM vendors AS v
  JOIN (SELECT vendor_id, MIN(invoice_number) AS invoice_number
          FROM invoices AS i
          JOIN (SELECT vendor_id, MIN(invoice_date) AS invoice_date
                  FROM invoices
                 GROUP BY vendor_id
               ) AS j ON j.vendor_id = i.vendor_id AND j.invoice_date = i.invoice_date
         GROUP BY vendor_id
       ) AS inv_info ON v.vendor_id = inv_info.vendor_id
  JOIN invoices AS i ON i.invoice_number = inv_info.invoice_number 
```

毫无疑问，还有其他设计方法。请注意，这些子查询都不是相关子查询。

TDQD 纯粹是名义上的；没有 DBMS 为检查这些查询在语法上是否有效而烦恼，更不用说返回正确的答案了。OTOH，这是一种标准技术。

`invoices`如果您喜欢在 GROUP BY 子句中列出大量列，则可以通过让`inv_info`子查询返回相关发票列而无需最终连接。我不喜欢写出很多列名——但如果我担心性能，我会衡量它是否会产生显着差异。

您可能会发现有一个 OLAP 函数/查询可以更快地完成这项工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T21:24:34.780

试试这个：

```
SELECT DISTINCT 
    v.vendor_name, 
    i.invoice_number AS OLDEST_INVOICE, 
    i2.MinDate, 
    i.invoice_total
FROM vendors v
INNER JOIN invoices i  ON i.vendor_id = v.vendor_id
INNER JOIN
(
    SELECT 
      invoice_number , 
      MIN(i.invoice_date) MinDate
    FROM invoices
    GROUP BY invoice_number
) i2 ON  i.invoice_number = i2.invoice_number
     AND i.invoice_date   = i2.MinDate
ORDER BY i2.MinDate; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T21:30:40.313

不会`HAVING`在这里工作吗？

```
SELECT DISTINCT vendor_name, i.invoice_number AS OLDEST_INVOICE, 
    MIN(i.invoice_date), i.invoice_total
FROM vendors v
JOIN invoices i
ON i.vendor_id = v.vendor_id
GROUP BY vendor_name, invoice_number, invoice_total
HAVING i.invoice_date = MIN (i.invoice_date)
ORDER BY MIN(i.invoice_date); 
```

# php - 在服务器上为多个用户运行进程的语言

> ID：13223042
> 
> 赞同：1
> 
> 时间：2012-11-04T21:20:22.907
> 
> 标签：php, web-applications, process, streaming

您好我想创建一个从 Twitter 收集数据的 Web 应用程序。问题是用户必须插入他希望服务器从 Twitter 收集数据的时间。我怎么做？我曾想过使用 Twitter 的 Search API，但是如何控制进程的运行时间？如果用户离开页面，它还会运行吗？提前致谢。

# android - 如何限制 ListView 中选中的框数

> ID：13223045
> 
> 赞同：3
> 
> 时间：2012-11-04T21:20:43.433
> 
> 标签：android

这是我第一次开发 Android 应用程序，所以这个问题可能是显而易见的。我想限制所选复选框的数量（即，用户应该只能选择最多 2 个复选框）。如何在 onCheckedChanged() 中执行此操作？

```
package com.mainak.walkbuddy;

import java.util.List;

import android.app.Activity;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.CheckBox;
import android.widget.CompoundButton;
import android.widget.TextView;

public class InteractiveArrayAdapter extends ArrayAdapter<Model>
{
    private final List<Model> list;
    private final Activity context;

    public InteractiveArrayAdapter(Activity context, List<Model> list) 
    {
        super(context, R.layout.activity_show_content, list);
        this.context = context;
        this.list = list;
    }

    static class ViewHolder 
    {
        protected TextView text;
        protected CheckBox checkbox;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent)
    {
        View view = null;
        int checkBoxCounter = 0;      
        int checkBoxInitialized = 0; 
        if (convertView == null) 
        {
            LayoutInflater inflator = context.getLayoutInflater();
            view = inflator.inflate(R.layout.activity_show_content, null);
            final ViewHolder viewHolder = new ViewHolder();
            viewHolder.text = (TextView) view.findViewById(R.id.label);
            viewHolder.checkbox = (CheckBox) view.findViewById(R.id.check);
            viewHolder.checkbox.setOnCheckedChangeListener(
                    new CompoundButton.OnCheckedChangeListener() 
                    {
                        @Override
                        public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) 
                        {
                            Model element = (Model) viewHolder.checkbox.getTag();
                            element.setSelected(buttonView.isChecked());
                        }
                    }
                    );
            view.setTag(viewHolder);
            viewHolder.checkbox.setTag(list.get(position));
        } 
        else
        {
            view = convertView;
            ((ViewHolder) view.getTag()).checkbox.setTag(list.get(position));
        }
        ViewHolder holder = (ViewHolder) view.getTag();
        holder.text.setText(list.get(position).getName());
        holder.checkbox.setChecked(list.get(position).isSelected());
        return view;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T21:34:42.977

添加一个表示检查项目数的 int 计数器，每次检查项目时，您检查计数器是否不大于 2。

如果它大于 2 则不做任何事情（不要将标志设置为选中），否则只需更改标志并增加计数器。

您应该将 onClickListener 设置为视图并将选中标志更改为选中/未选中，然后调用 notifydatasetchanged() 来更改选中状态。

因为在添加 onCheckedChangedListener 时保持选中状态可能会出现一些问题。

# java - 修剪输入框并添加到上下文 JSTL

> ID：13223050
> 
> 赞同：0
> 
> 时间：2012-11-04T21:21:05.787
> 
> 标签：java, spring, jakarta-ee, spring-mvc, jstl

我是 JSTL 世界的新手，所以请对我温柔一点，我已经在阅读但找不到解决方案。

我想从输入框的开头和结尾修剪空格，因此当用户单击提交按钮时，我的控制器会收到不带空格的字符串。

请不要建议我使用其他框架，因为我已经遇到了这个问题，当我掌握了这个，我会进入下一步。

这是我的 JSP 代码，我试过了，但没有用，似乎上下文没有保留我传递的值，之后我只是在尝试......任何帮助表示赞赏！

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<LINK REL=StyleSheet HREF="resources/index-style.css" TYPE="text/css">
<title>Submit a new academic!</title>
</head>
<div class="home">
    <a href="index"><img src="resources/home.png" /></a>
</div>
<div class="list">
    <h1>This is the place where you register a new Academic on the
        system!</h1>
</div>
<p></p>

<div class="list">
    <form action="addAcademicAction" method="post">
        <p>Submit your name:</p>
        <input type="text" name="academicName"><br>
        <p>Level of education</p>
        <input type="radio" name="educationLevel" value="student" checked>Student<br>
        <input type="radio" name="educationLevel" value="csstudent">Computer
        Science Student<br> <input type="radio" name="educationLevel"
            value="professor">Professor<br> <br>
        <button name="submit" type="submit" value="HTML">Add
            Academic!</button>
    </form>
</div>

<c:if test="${context.request.method=='POST'}">
    <c:set var="academicName" value="${fn:trim(param.academicName)}"/>
</c:if>

<body>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T21:37:03.727

您似乎不了解 JSP 是如何工作的。JSP 在服务器端执行。这只是编写 servlet 的另一种方式。它的目标是生成 HTML，并将其发送到浏览器。

该`<c:set>`标签用于设置页面范围属性。您可以将其视为当前 JSP 执行的本地变量。所以上面的内容或多或少等同于这个：

```
out.println("<html>");
out.println("<head>");
...
out.println("</div>");
String academicName = null;
if (request.getMethod().equals("POST")) {
    academicName = request.getParameter("academicName").trim();
}
out.println("</body>");
out.println("</html>"); 
```

因此，很明显，您正在定义一个从未使用过的局部变量。

如果你想修剪JSP生成的表单提交的内容，不是这个JSP必须修剪参数，而是Spring控制器将接收表单提交，因此映射到路径“addAcademicAction”。

# android - 如何使用异步任务返回对象？

> ID：13223052
> 
> 赞同：4
> 
> 时间：2012-11-04T21:21:14.500
> 
> 标签：android, multithreading

我试图从异步任务解析后返回推文列表....但我没有从任务中取回数组列表。任何人都可以提出解决方案吗？

```
public class Main extends ListActivity {
    String MY_APP_TAG = "com.list";

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        ArrayList listItems = new ArrayList();
        new myAsyncTask().execute(listItems);

        setListAdapter(new ArrayAdapter(this, R.layout.tweet, R.id.tweet,listItems));
        ListView lv = getListView();
        lv.setTextFilterEnabled(true);
        lv.setOnItemClickListener(new OnItemClickListener() {
            @Override
            public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
                // When clicked, show a Toaster
                Toast.makeText(getApplicationContext(), ((TextView) view).getText(), Toast.LENGTH_SHORT).show();
            }
        });
    }

    private class myAsyncTask extends AsyncTask<ArrayList<Object>, Void, Void>
    {
        ArrayList<Object> listItems;
        ProgressDialog dialog;
        @Override
        protected void onPreExecute() {
            dialog = ProgressDialog.show(Main.this, "", "Loading....");
        }
        @Override
        protected Void doInBackground(ArrayList<Object>... params) {

            String host = "api.twitter.com";
            String twitterURL = "http://"+host+"/1/statuses/user_timeline.json?screen_name=i1990jain&amp;count;=10";
            try {
                HttpClient client = new DefaultHttpClient();
                BasicHttpContext localContext = new BasicHttpContext();
                HttpHost targetHost = new HttpHost(host, 80, "http");
                HttpGet httpget = new HttpGet(twitterURL);
                httpget.setHeader("Content-Type", "application/json");
                HttpResponse response = client.execute(targetHost, httpget, localContext);
                HttpEntity entity = response.getEntity();
                Object content = EntityUtils.toString(entity);
                Log.d(MY_APP_TAG, "OK: " + content.toString());

                JSONArray ja = new JSONArray(content.toString());

                for(int i = 0; i < ja.length(); i++){
                    JSONObject jo = ja.getJSONObject(i);
                    listItems.add(jo.getString("text"));
                }
            } catch(Exception e) {
                e.printStackTrace();
            }
            return null;
        }
        @Override
        protected void onPostExecute(Void result) {
            dialog.dismiss();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T21:36:19.060

是`AsyncTask<Params, Progress, Result>`。所以你应该将它声明为`AsyncTask<Void, Void, ArrayList<Object>>`.

`doInBackground`从方法中返回列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T21:41:15.170

要使用来自异步线程的新数据更新您的活动，您可以使用 onProgressUpdate()/onPostExecute() 方法，或者如果您使用的是 Thead，您应该使用 Heandler。

```
//aciticty class:
final Handler mHandler = new Handler();

//inside an async thread
handler.post(new Runnable() {
    @Override
    public void run() {
        //update GUI thread here
    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T21:42:27.357

你想在哪里返回你的结果？您可以在以下位置访问 listItems：

```
protected void onPostExecute(Void result) { 
```

这就是您应该使用 listItems 来填充您的列表的地方。此方法在 UI 线程上运行，因此在其中执行它是安全的。

在您的 doInBackground 中，我没有看到 listItems 被初始化为任何值，因此它可能为空。您实际上应该创建单独的 listItems 实例以在 doInBackground 中使用，然后将其分配给 onPostExecute 内的 listView。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-05T21:13:20.250

我是如何让它工作的

```
public class Main extends ListActivity {

    String MY_APP_TAG = "com.vidyut";
    ArrayList<Object> list = new ArrayList<Object>();
        /** Called when the activity is first created. */
    @SuppressWarnings("unchecked")
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        myAsyncTask task = new myAsyncTask();
        task.execute();

}

    private class myAsyncTask extends AsyncTask<ArrayList<Object>, ArrayList<Object>, ArrayList<Object>>
    {
        ProgressDialog dialog;
        @Override
        protected void onPreExecute() {
            dialog = ProgressDialog.show(Main.this, "", "Loading....");
        }

        @Override
        protected ArrayList<Object> doInBackground(ArrayList<Object>... params) {

            String host = "api.twitter.com";
            String twitterURL = "http://"+host+"/1/statuses/user_timeline.json?screen_name=i1990jain&amp;count;=10";
         try {
          HttpClient client = new DefaultHttpClient();
             BasicHttpContext localContext = new BasicHttpContext();
             HttpHost targetHost = new HttpHost(host, 80, "http");
             HttpGet httpget = new HttpGet(twitterURL);
             httpget.setHeader("Content-Type", "application/json");
             HttpResponse response = client.execute(targetHost, httpget, localContext);
             HttpEntity entity = response.getEntity();
             Object content = EntityUtils.toString(entity);
             Log.d(MY_APP_TAG, "OK: " + content.toString());

             JSONArray ja = new JSONArray(content.toString());

          for(int i = 0; i < ja.length(); i++){
           JSONObject jo = ja.getJSONObject(i);
           list.add(jo.getString("text"));
          }
         } catch(Exception e) {
          e.printStackTrace();
         }
            return list;
        }
        protected void onPostExecute(ArrayList<Object> list) {
            dialog.dismiss();

             Log.d(MY_APP_TAG, "The returned list contains " +list.size()+ "elements");
             setListAdapter(new ArrayAdapter<Object>(Main.this, R.layout.tweet, R.id.tweet,list));
                ListView lv = getListView();
                lv.setTextFilterEnabled(true);
                lv.setOnItemClickListener(new OnItemClickListener() {
                 @Override
                 public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
                  // When clicked, show a Toaster
                      Toast.makeText(getApplicationContext(), ((TextView) view).getText(), Toast.LENGTH_SHORT).show();
             }
            });

        }

    }
} 
```

# c# - ASP.NET 应用程序对象获取器和设置器

> ID：13223053
> 
> 赞同：3
> 
> 时间：2012-11-04T21:21:18.040
> 
> 标签：c#, asp.net, .net, getter-setter

我很难找到一个访问应用程序对象的新手友好示例。我有一些东西（数组）我想存储在应用程序对象中作为持久数据保留大约 2 小时，直到 AppRecycle。

无论如何，我知道如何以这种方式设置应用程序对象变量：

```
// One way
String[] users = new String[1000];
Application["users"] = users;

// Another way
Application.Add("users", users); 
```

但是，一旦它们位于应用程序对象中，我不知道如何访问这些变量。有一个 Getter 方法`Get`。但是它需要`int index`. 另一种方法，`Contents`，得到一切，而不仅仅是我的数组。

在这里，我尝试检索我的 String[] 数组，但它给了我一个错误，我试图将 Object 转换为 String。

```
String[] usersTable = Application["users"];
// Since this is an object i also tried Application.users but gives error 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T21:24:36.533

在应用程序中，您只保存类型“对象”。您需要转换为所需的类型

```
string[] usersTable = (string[])Application["users"]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-04T21:23:33.667

您需要将值转换回`String[]`：

```
String[] usersTable = (String[])Application["users"]; 
```

请参阅如何：[从应用程序状态读取值](http://msdn.microsoft.com/en-us/library/y8hhek39%28v=vs.100%29.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-04T21:35:32.987

首先，我建议您在字符串上简单地使用静态变量

```
static String[] users = new String[1000]; 
```

并操纵它。优于应用程序状态。[微软怎么说](https://stackoverflow.com/questions/10960695/using-static-variables-instead-of-application-state-in-asp-net/10964038#10964038)：

> ASP.NET 包括应用程序状态，主要是为了与经典 ASP 兼容，以便更容易将现有应用程序迁移到 ASP.NET。**建议您将数据存储在**应用程序类的静态成员中，而不是应用程序对象中。这提高了性能，因为您可以比访问应用程序字典中的项目更快地访问静态变量。

现在，如果您继续使用应用程序，我强烈建议您使用 use`Application.Lock();`并且`Application.UnLock();` 当您操作应用程序的数据时，您的代码将如下所示：

```
String[] _users = null;
String[] users
{
    get
    {
        if (_users == null)
        {
            Application.Lock();
            if (!(Application["_users_"] is String[]))
            {
                Application["_users_"] = new String[1000];
            }
            _users = (String [])Application["_users_"];
            Application.UnLock();
        }

        return _users;
    }
} 
```

### 为什么我建议简单地使用 static ？

因为这`Application["_users_"]`实际上是对`Dictionary<k,v>`存储在其他数据中的静态的调用，并且您设置为 String[] 的数据。实际上没有理由这样做，静态可以做同样的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-05T04:57:09.110

更好的解决方案 IMO 将使用 WebCache (http://msdn.microsoft.com/en-us/library/d59zceh7.aspx)，因为您可以对过期和依赖项进行大量控制。这样，如果您不想再回收您的应用程序池，您仍然可以将数据保留一段有限的设定时间。

```
 string[] Cache["users"]; 
```

这就是访问对象缓存所需的全部内容。设置它也很容易。请参阅：http: [//msdn.microsoft.com/en-us/library/system.web.caching.cache.add (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/system.web.caching.cache.add(v=vs.100).aspx)

# text-to-speech - 减慢 Twilio 的 TwiML“说”命令用于文本到语音的数字

> ID：13223060
> 
> 赞同：9
> 
> 时间：2012-11-04T21:22:08.687
> 
> 标签：text-to-speech, twilio, twilio-twiml

我创建了一个 Twilio 应用程序，该应用程序涉及使用 Twilio 的 TwimL`<Say>`命令读取构成用户先前输入的 ID 的数字列表（例如，`3638194746219190`或类似的内容）。由于它是一长串数字，我让应用程序回读数字列表以确认用户已正确输入它们。由于它是动态的，我无法预先录制它——它必须与 一起使用`<Say>`，但 Twilio 读回它*的*速度太快了。

我目前在播放数字时使用空格和逗号来减慢它们的速度，例如：`'3, 6, 3, 8, 1, 9, 4, 7, 4, 6, 2, 1, 9, 1, 9, 0'`，这有点帮助，但它仍然太快地读取列表。

您知道如何强制 Twilio 的`<Say>`命令进一步减慢其文本到语音的播放速度吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-05T08:53:38.260

您可以尝试使用句点，例如`1\. 2\. 3\. 4\. 5\. 6\. 7\. 8\. 9.`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-10-27T15:35:59.317

您可以添加多个逗号或句点，它会增加暂停时间。您也可以考虑为每个 X 数字添加更长的休息时间，以便它具有更自然的节奏。

```
3,,,6,,,3,,,8,,,,,,,1,,,9,,,4,,,7,,,,,,,4,,,6,,,2,,,1 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-04T21:46:46.373

您可以添加一个`<Pause>`动词来暂停执行几秒钟。文档在这里： http: [//www.twilio.com/docs/api/twiml/pause](http://www.twilio.com/docs/api/twiml/pause)

在这个问题上有更多关于在 TwiML 中生成暂停的信息：[如何在 TwiML 中生成半秒暂停？](https://stackoverflow.com/questions/12628933/how-can-i-generate-a-half-second-pause-in-twiml)

# .net - 直接项目引用或通过 wcf 进行通信

> ID：13223062
> 
> 赞同：1
> 
> 时间：2012-11-04T21:22:23.497
> 
> 标签：.net, wcf, performance, serialization, .net-4.5

我目前正在构建我的 .net 4.5 应用程序。目前我有 web 层和 wcf 服务层。他们通过肥皂相互交流。

两层都位于一台服务器上。

我正在考虑从通过肥皂进行交流转向直接的项目参考。所以它从一个应用程序从两个移动。这背后的主要动机是提高性能，无需对 Web 和服务之间的通信进行序列化和反序列化。

我从这种变化中失去的是将来将我的服务层移动到单独的层（即不同的服务器）的可扩展性。

我正在寻找对此的反馈，序列化是否会对性能产生重大影响。对上面的想法？任何我应该认为我已经省略的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T21:55:08.073

根据我自己的个人经验，我更喜欢水平扩展（向 webfarm 添加更多网络服务器）而不是分发应用程序。

我认为将 WCF 与直接本地调用进行比较时，您可能会受到相当大的性能影响。但影响取决于您的架构以及每个请求实际发出的调用数。例如，如果您要获取 10 个实体，并且对于每个实体都需要一个单独的 WCF 调用，那么开销将比发出单个服务调用并同时返回所有 10 个要大得多。

现在，也许您可​​以探索的另一个选项是使用 NamedPipes 而不是 HTTP，因为它们当前将托管在同一环境中。

有关更多信息，请参阅[选择交通工具](http://msdn.microsoft.com/en-us/library/ms733769.aspx)。

# sql-server - 通过 FTP 将 SQL 复制到 SQL Compact 3.5？

> ID：13223063
> 
> 赞同：0
> 
> 时间：2012-11-04T21:22:29.773
> 
> 标签：sql-server, sql-server-ce, replication, merge-replication

我正在尝试将 SQL Server 数据库复制到装有 SQL Compact 3.5 的设备上，我可以通过 IIS 使复制工作正常。但是，发布可以选择使用 FTP 发布复制数据，但我似乎无法将 SQL Compact 配置为连接到 FTP 站点。网上没有说我不能这样做，但我也找不到演示我可以的演练。

有人知道我是否可以通过 FTP 而不是 IIS Web 将 SQL Compact 数据库连接到发布者？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T09:11:14.177

SQL Server Compact 不支持这一点，只有基于 IIS 的同步有效。

# mahout - 获取每个集群的成员 - mahout

> ID：13223064
> 
> 赞同：1
> 
> 时间：2012-11-04T21:22:46.733
> 
> 标签：mahout

```
 KMeansExample kmE = new KMeansExample();
    ArrayList<Integer> data = kmE.readData("c2010.csv"); // List of number

    int k = 3;
    List<Vector> dividedData = divideData(data, k); //divides data into list of k vectors

    List<Cluster> clusters = new ArrayList<>();

    /*   initial cluatersusing mahout */
    int clusterId = 0;
    for (Vector v : dividedData) {
        clusters.add(new Cluster(v, clusterId++, new EuclideanDistanceMeasure()));
    }

    /* final cluster using mahout KMeansClusterer */
    List<List<Cluster>> finalClusters = KMeansClusterer.clusterPoints(
            dividedData, clusters, new EuclideanDistanceMeasure(), 3, 50);
    kmE.printFinalClusters(finalClusters);

    where 

    private void printFinalClusters(List<List<Cluster>> fc) {
    for (List<Cluster> l : fc) {
        for (Cluster c : l) {
            System.out.println(c.asFormatString());
        }
    }
} 
```

结果是：-

> CL-0: {67:247.0,66:193.0,65:271.0,64:171.0,63:158.0,62:396.0,61:407.0,60:432.0,59:200.0,58:791.0,57:406.0,56 :205.0,55:55.0,54:394.0,53:230.0,52:38.0,51:508.0,50:414.0,49:52.0,48:572.0,47:121.0,46:724.0,45:1421.0,44:706.0 ,43:603.0,42:525.0,41:181.0,40:476.0,39:642.0,38:761.0,37:340.0,36:1273.0,35:1692.0,34:687.0,33:497.0,32:91.0,31 :309.0,30:1534.0,29:299.0,28:961.0,27:656.0,26:310.0,25:483.0,24:796.0,23:247.0,22:682.0,21:1348.0,20:1394.0,19:368.0 ,18:491.0,17:263.0,16:1117.0,15:1792.0,14:398.0,13:185.0,12:457.0,11:505.0,10:297.0,9:919.0,8:723.0,7:203.0,6 :2566.0,5:450.0,4:404.0,3:459.0,2:254.0,1:177.0,0:269.0} CL-1: {67:193.0,66:271.0,65:171.0,64:158.0,63: 396.0,62:407.0,61:432.0,60:200.0,59:791.0,58:406.0,57:205.0,56:55.0,55:394.0,54:230.0,53:38.0,52:508.0,51:414.0, 50:52.0,49:572.0,48:121.0,47:724.0,46:1421.0,45:706.0,44:603.0,43:525.0,42:181.0,41:476.0,40:642.0,39:761.0,38:340.0,37:1273.0,36:1692.0,35:687.0,34:497.0,33:91.0,32:309.0,31:1534.0,30:299.0,29: 961.0,28:656.0,27:310.0,26:483.0,25:796.0,24:247.0,23:682.0,22:1348.0,21:1394.0,20:368.0,19:491.0,18:263.0,17:1117.0, 16:1792.0,15:398.0,14:185.0,13:457.0,12:505.0,11:297.0,10:919.0,9:723.0,8:203.0,7:2566.0,6:450.0,5:404.0,4: 459.0,3:254.0,2:177.0,1:269.0,0:247.0} CL-2：{67:271.0,66:171.0,65:158.0,64:396.0,63:407.0,62:432.0,61:200.0 ,60:791.0,59:406.0,58:205.0,57:55.0,56:394.0,55:230.0,54:38.0,53:508.0,52:414.0,51:52.0,50:572.0,49:121.0,48 :724.0,47:1421.0,46:706.0,45:603.0,44:525.0,43:181.0,42:476.0,41:642.0,40:761.0,39:340.0,38:1273.0,37:1692.0,36:687.0 ,35:497.0,34:91.0,33:309.0,32:1534.0,31:299.0,30:961.0,29:656.0,28:310.0,27:483.0,26:796.0,25:247.0,24:682.0,23 :1348.0,22:1394.0,21:368.0,20:491.0,19:263.0,18:1117.0,17:1792.0,16:398.0,15:185.0,14:457.0,13:505.0,12:297.0,11:919.0,10:723.0,9:203.0,8:2566.0,7:450.0,6:404.0,5:459.0,4:254.0,3:177.0, 2:269.0,1:247.0,0:193.0} VL-0: {67:247.0,66:193.0,65:271.0,64:171.0,63:158.0,62:396.0,61:407.0,60:432.0,59 :200.0,58:791.0,57:406.0,56:205.0,55:55.0,54:394.0,53:230.0,52:38.0,51:508.0,50:414.0,49:52.0,48:572.0,47:121.0 ,46:724.0,45:1421.0,44:706.0,43:603.0,42:525.0,41:181.0,40:476.0,39:642.0,38:761.0,37:340.0,36:1273.0,35:1692.0,34 :687.0,33:497.0,32:91.0,31:309.0,30:1534.0,29:299.0,28:961.0,27:656.0,26:310.0,25:483.0,24:796.0,23:247.0,22:682.0 ,21:1348.0,20:1394.0,19:368.0,18:491.0,17:263.0,16:1117.0,15:1792.0,14:398.0,13:185.0,12:457.0,11:505.0,10:297.0,9 :919.0,8:723.0,7:203.0,6:2566.0,5:450.0,4:404.0,3:459.0,2:254.0,1:177.0,0:269.0} VL-1: {67:193.0,66: 271.0,65:171.0,64:158.0,63:396.0,62:407.0,61:432.0,60:200.0,59:791.0,58:406.0,57:205.0,56:55.0,55:394.0,54:230.0,53:38.0,52:508.0,51:414.0,50:52.0,49:572.0,48:121.0,47:724.0,46:1421.0,45:706.0,44: 603.0,43:525.0,42:181.0,41:476.0,40:642.0,39:761.0,38:340.0,37:1273.0,36:1692.0,35:687.0,34:497.0,33:91.0,32:309.0, 31:1534.0,30:299.0,29:961.0,28:656.0,27:310.0,26:483.0,25:796.0,24:247.0,23:682.0,22:1348.0,21:1394.0,20:368.0,19: 491.0,18:263.0,17:1117.0,16:1792.0,15:398.0,14:185.0,13:457.0,12:505.0,11:297.0,10:919.0,9:723.0,8:203.0,7:2566.0, 6:450.0,5:404.0,4:459.0,3:254.0,2:177.0,1:269.0,0:247.0} VL-2: {67:271.0,66:171.0,65:158.0,64:396.0,63 :407.0,62:432.0,61:200.0,60:791.0,59:406.0,58:205.0,57:55.0,56:394.0,55:230.0,54:38.0,53:508.0,52:414.0,51:52.0 ,50:572.0,49:121.0,48:724.0,47:1421.0,46:706.0,45:603.0,44:525.0,43:181.0,42:476.0,41:642.0,40:761.0,39:340.0,38 :1273.0,37:1692.0,36:687.0,35:497.0,34:91.0,33:309.0,32:1534.0,31:299.0,30:961.0,29:656.0,28:310.0,27:483.0,26:796.0,25:247.0,24:682.0,23:1348.0,22:1394.0,21:368.0,20:491.0,19:263.0,18:1117.0,17: 1792.0,16:398.0,15:185.0,14:457.0,13:505.0,12:297.0,11:919.0,10:723.0,9:203.0,8:2566.0,7:450.0,6:404.0,5:459.0, 4:254.0,3:177.0,2:269.0,1:247.0,0:193.0}

但我如何获得每个集群的成员？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-27T04:05:20.527

上述方法能够找到簇的质心，但最后一步是为每个向量分配一个簇质心。

作为下一步，您可以一个一个地获取每个向量并为其分配最近的质心。

# java - 褪色算法？

> ID：13223065
> 
> 赞同：3
> 
> 时间：2012-11-04T21:23:01.257
> 
> 标签：java, swing, user-interface, colors

我正在创建一些自定义 Swing 组件，我希望这些组件从一种颜色渐变到另一种颜色。目前我正在从 RGB 转换为 HSB，然后通过 Hue 值递增并在绘画之前转换回 RGB，工作正常。

然而，这会循环通过所有颜色（即尝试从蓝色渐变到绿色循环通过黄色、橙色、红色等）。是否有一种体面的算法/方法可以直接从一种颜色淡入另一种颜色？

编辑：我已经通过 Swing Timer 对其进行了更新（我尽量避免使用像瘟疫这样的线程接触组件）。今天晚上我会去看看你的建议，谢谢大家！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-05T00:40:52.047

基于这个[例子](https://stackoverflow.com/a/2124507/230513)，`Queue<Color>`下面的循环从`Color.green`到`Color.blue`到`Color.green`再到`N = 32`一步。请注意，`Color.green`它的数值小于`Color.blue`HSB 模型中的数值。另请参阅使用 HSB 的相关[示例。](https://stackoverflow.com/a/9875534/230513)

![在此处输入图像描述](../Images/e058e4532df74549baf764f1ec21b999.png)

```
public Flash(JComponent component) {
    this.component = component;
    float gHue = Color.RGBtoHSB(0, 1, 0, null)[0];
    float bHue = Color.RGBtoHSB(0, 0, 1, null)[0];
    for (int i = 0; i < N; i++) {
        clut.add(Color.getHSBColor(gHue + (i * (bHue - gHue) / N), 1, 1));
    }
    for (int i = 0; i < N; i++) {
        clut.add(Color.getHSBColor(bHue - (i * (bHue - gHue) / N), 1, 1));
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-04T22:53:28.710

我使用多种方法来实现相同的结果。

Baiscally 我使用一个类似的 API 接口作为`LinearGradientPaint`，我提供一个分数数组和一个颜色数组，然后基于`float`百分比，我计算得到的混合颜色。

这使我能够通过相同的算法产生许多有效的结果。

![在此处输入图像描述](../Images/9736e300ec8779eeab2c860a2e39d1d8.png)

虽然此示例旨在演示一系列颜色的混合，但您可以简单地提供两种颜色和两种颜色的一小`{0f, 1f}`部分

这也让我能够有效地制作彩色动画。

```
public class ColorFade {

    public static void main(String[] args) {
        new ColorFade();
    }

    public ColorFade() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
//                frame.add(new FadePane());
                frame.add(new ColorFadePane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class FadePane extends JPanel {

        private float[] fractions = new float[]{0f, 0.25f, 0.5f, 1f};
        private Color[] colors = new Color[]{Color.GREEN, Color.BLUE, Color.YELLOW, Color.RED};
        private float direction = 0.05f;
        private float progress = 0f;

        public FadePane() {
            Timer timer = new Timer(125, new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    if (progress + direction > 1f) {
                        direction = -0.05f;
                    } else if (progress + direction < 0f) {
                        direction = 0.05f;
                    }
                    progress += direction;
                    repaint();
                }
            });
            timer.setCoalesce(true);
            timer.setRepeats(true);
            timer.start();
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(100, 100);
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            Graphics2D g2d = (Graphics2D) g.create();
            int width = getWidth();
            int height = getHeight();
            Color startColor = blendColors(fractions, colors, progress);
            g2d.setColor(startColor);
            g2d.fillRect(0, 0, width, height);
            g2d.dispose();
        }
    }

    public class ColorFadePane extends JPanel {

        private float[] fractions = new float[]{0f, 0.25f, 0.5f, 1f};
        private Color[] colors = new Color[]{Color.GREEN, Color.BLUE, Color.YELLOW, Color.RED};

        public ColorFadePane() {
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(200, 100);
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);

            Graphics2D g2d = (Graphics2D) g.create();
            int width = getWidth();
            int height = getHeight();
            int bandWidth = width / 100;
            for (int index = 0; index < 100; index++) {
                float progress = (float)index / (float)100;
                Color color = blendColors(fractions, colors, progress);

                int x = bandWidth * index;
                int y = 0;
                g2d.setColor(color);
                g2d.fillRect(x, y, bandWidth, height);
            }
            g2d.dispose();
        }
    }

    public static Color blendColors(float[] fractions, Color[] colors, float progress) {
        Color color = null;
        if (fractions != null) {
            if (colors != null) {
                if (fractions.length == colors.length) {
                    int[] indicies = getFractionIndicies(fractions, progress);

                    float[] range = new float[]{fractions[indicies[0]], fractions[indicies[1]]};
                    Color[] colorRange = new Color[]{colors[indicies[0]], colors[indicies[1]]};

                    float max = range[1] - range[0];
                    float value = progress - range[0];
                    float weight = value / max;

                    color = blend(colorRange[0], colorRange[1], 1f - weight);
                } else {
                    throw new IllegalArgumentException("Fractions and colours must have equal number of elements");
                }
            } else {
                throw new IllegalArgumentException("Colours can't be null");
            }
        } else {
            throw new IllegalArgumentException("Fractions can't be null");
        }
        return color;
    }

    public static int[] getFractionIndicies(float[] fractions, float progress) {
        int[] range = new int[2];

        int startPoint = 0;
        while (startPoint < fractions.length && fractions[startPoint] <= progress) {
            startPoint++;
        }

        if (startPoint >= fractions.length) {
            startPoint = fractions.length - 1;
        }

        range[0] = startPoint - 1;
        range[1] = startPoint;

        return range;
    }

    public static Color blend(Color color1, Color color2, double ratio) {
        float r = (float) ratio;
        float ir = (float) 1.0 - r;

        float rgb1[] = new float[3];
        float rgb2[] = new float[3];

        color1.getColorComponents(rgb1);
        color2.getColorComponents(rgb2);

        float red = rgb1[0] * r + rgb2[0] * ir;
        float green = rgb1[1] * r + rgb2[1] * ir;
        float blue = rgb1[2] * r + rgb2[2] * ir;

        if (red < 0) {
            red = 0;
        } else if (red > 255) {
            red = 255;
        }
        if (green < 0) {
            green = 0;
        } else if (green > 255) {
            green = 255;
        }
        if (blue < 0) {
            blue = 0;
        } else if (blue > 255) {
            blue = 255;
        }

        Color color = null;
        try {
            color = new Color(red, green, blue);
        } catch (IllegalArgumentException exp) {
            NumberFormat nf = NumberFormat.getNumberInstance();
            System.out.println(nf.format(red) + "; " + nf.format(green) + "; " + nf.format(blue));
            exp.printStackTrace();
        }
        return color;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T21:30:35.447

提示

1.  使用[Swing Timer](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)获得慢动作效果
2.  将 RGB 的值递减一个数字，比如说`x`

Tadaaaa .. :-)

更新：如果你愿意，你可以在`x`.

在执行期间使用`Math.Random()`函数生成伪随机值`x`

HovercraftFullOfEels &mKorbel，感谢您的投入

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-04T22:03:19.490

最简单的方法是在每个 RGB 值之间进行插值。这对所有语言都是一样的——python代码看起来像：

```
steps = 10

rgb1 = [ 'AA', '08', 'C3' ]
rgb2 = [ '03', '88', '1C' ]

h1 = map( lambda s: int( '0x'+s, 0 ), rgb1 )
h2 = map( lambda s: int( '0x'+s, 0 ), rgb2 )

inc = [0, 0, 0]
for i in range(0,3):
    inc[i] = ( h2[i] - h1[i] ) / ( steps - 1 )

for i in range(0,steps-1):
    print '<span style="background: #%02x%02x%02x"> &nbsp; %i &nbsp; </span>' % ( 
            h1[0] + i * inc[0],
            h1[1] + i * inc[1],
            h1[2] + i * inc[2],
            i+1 )

print '<span style="background: #%02x%02x%02x"> &nbsp; %i &nbsp; </span>' % ( 
        h2[0], h2[1], h2[2], steps ) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-04T21:32:49.930

您可以线性插值从起始 rgb 颜色到您最终想要的颜色的过渡。

这意味着，例如，如果您有`rgb(255,255,0)`作为起始颜色和`rgb(50,50,50)`作为目标的颜色，并且您希望在 5 个步骤中达到最终颜色，那么您将`(-41 = (255-50)/5, -41, 10)`在每一步中适应导致以下颜色：

```
rgb(255,255,  0)
rgb(214,214, 10)
rgb(173,173, 20)
rgb(132,132, 30)
rgb( 91, 91, 40)
rgb( 50, 50, 50) 
```

这被称为线性渐变，并且很容易实现，但当然还有各种其他技术可以在颜色之间进行良好的过渡。

# python - Python 3.2：制作文件中整数列表的列表

> ID：13223066
> 
> 赞同：-1
> 
> 时间：2012-11-04T21:23:04.127
> 
> 标签：python, file, list, file-io, python-3.x

所以我有一个包含整数矩阵的文件。我需要读入文件的内容并将其存储在列表中。我无法完全弄清楚我必须如何做到这一点。

以下是文件 A.txt 所包含内容的示例：

```
3,7
1,2,3,4,5,6,7
11,12,13,14,15,16,17
21,22,23,24,25,26,27 
```

到目前为止，这是我的代码：

```
def main():

    A = open('A.txt')

    Alist = []

    for eachLine in A:

main() 
```

那么我该怎么做呢？我知道我必须以某种方式使用方法 readLine() 和 split() 但我不确定如何。它也必须是整数列表，而不是字符串。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T21:24:33.043

我们需要将每一行解析为一个整数列表，调用`split`以逗号将其分解，然后`int`将它们从字符串转换（如`['3', '7']`into `[3, 7]`），然后将它们累加：

```
with open('A.txt') as f:
    Alist = []
    for line in f:
        part = []
        for x in line.split(','):
            part.append(int(x))
        Alist.append(part) 
```

（这使用`with`语句来打开文件，这是首选方法，因为它会在您完成文件后自动关闭文件，即使同时出现错误也是如此。）

但是请注意我们有两个循环，它们只是初始化一个空列表，然后为每个元素添加一些东西？这是一种非常常见的模式，因此 Python 具有列表推导以使它们更好。我们先只做内部部分：

```
with open('A.txt') as f:
    Alist = []
    for line in f:
        part = [int(x) for x in line.split(',')]
        Alist.append(part) 
```

看看它是如何完全一样的？现在我们可以让它更短：

```
with open('A.txt') as f:
    Alist = [[int(x) for x in line.split(',')] for line in f] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T21:27:26.923

使用`map()`：

```
In [1]: with open("data1.txt") as f:
   ...:     lis=[map(int,x.split(",")) for x in f]
   ...:     print lis  
   ...:     
[[3, 7], [1, 2, 3, 4, 5, 6, 7], [11, 12, 13, 14, 15, 16, 17], [21, 22, 23, 24, 25, 26, 27]] 
```

或使用`ast.literal_eval()`：

```
In [5]: import ast

In [6]: with open("data1.txt") as f:
    lis=[list(ast.literal_eval(x)) for x in f]
    print lis
   ...:     
[[3, 7], [1, 2, 3, 4, 5, 6, 7], [11, 12, 13, 14, 15, 16, 17], [21, 22, 23, 24, 25, 26, 27]] 
```

# regex - 如何制作用于过滤文件类型和部分文件名的正则表达式

> ID：13223073
> 
> 赞同：0
> 
> 时间：2012-11-04T21:23:56.177
> 
> 标签：regex

我的基本字符串是

```
http://xx.com/3-115_high.mp4 
```

我试图弄清楚将给出以下内容的正则表达式：

1.  `true`如果以`.mp4`（我认为是`/(.(mp4))$/`）结尾
2.  `true`if 以结尾`.mp4`并且还包括字符串“_high”，最好在 之前，但如果在之前太难`.`，则可以作为其他选项在任何地方。`.`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T21:28:04.917

基本上`/\.mp4$/`都适用于这两种情况，但如果您需要更具体的一种，您可以尝试：`/(_high)?\.mp4$/`或者`/_high\.mp4$/`如果**需要**_high 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T21:29:30.590

没那么难：

1.  `/\.mp4$/`
2.  （`_high`任何地方）：`/_high.*\.mp4$/`
3.  （`_high`就在点之前）：`/_high\.mp4$/`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T22:51:40.073

1.  真，如果文件名以`.mp4`

    ```
    Regex.IsMatch(url, @"[.]mp4$") 
    ```

2.  真，如果文件名以`_high.mp4`

    ```
    Regex.IsMatch(url, @"_high[.]mp4$") 
    ```

3.  真，如果文件名以结尾`.mp4`并且文件名包含字符串`_high`

    ```
    Regex.IsMatch(url, @"_high[^/]*[.]mp4$") 
    ```

4.  是的，如果文件名以结尾`.mp4`并且 url 包含字符串`_high`

    ```
    Regex.IsMatch(url, @"_high.*[.]mp4$") 
    ```

# android - BaseAdapter 子类的 getView 方法创建的视图的生命周期

> ID：13223086
> 
> 赞同：3
> 
> 时间：2012-11-04T21:24:51.263
> 
> 标签：android, android-layout, android-widget

我有一个与 common 的自定义适配器创建的视图生命周期有关的问题`ListView`。我创建了一个自定义视图，如下所示：

```
 public class NSViewZoneLarge extends RelativeLayout
    {
        private long mZoneId;
        private ToggleButton mOnOffButton;

        public NSViewZoneLarge(Context context, boolean showSwitch, long zoneId)
        {
            super(context);
            LayoutInflater layoutInflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            layoutInflater.inflate(R.layout.view_zone_large, this);
            mOnOffButton = (ToggleButton) findViewById(R.id.toggleButtonOnOff);

            ImageView imgView = (ImageView)findViewById(R.id.imageViewZoneType);
            imgView.setFocusable(false);

            if (showSwitch)
            {
                mOnOffButton.setVisibility(View.VISIBLE);
            }
            else
            {
                mOnOffButton.setVisibility(View.INVISIBLE);
                mOnOffButton.setEnabled(false);
                mOnOffButton.setFocusable(false);
                mOnOffButton.setFocusableInTouchMode(false);
            }

            mZoneId = zoneId;
        }

        // ---------------------------------------------------------------------------------------
        public NSViewZoneLarge(Context context, AttributeSet attrs)
        {
            super(context, attrs);
        }

        // ---------------------------------------------------------------------------------------
        public void setZoneName(String zoneName)
        {
            TextView tVZoneName = (TextView) findViewById(R.id.textViewZoneName);
            tVZoneName.setText(zoneName);
        }

        // ---------------------------------------------------------------------------------------
        public String getZoneName()
        {
            TextView tVZoneName = (TextView) findViewById(R.id.textViewZoneName);
            return tVZoneName.getText().toString();
        }

        // ---------------------------------------------------------------------------------------
        public void setOnOffButton(boolean isOn)
        {
            ToggleButton onOffButton = (ToggleButton) findViewById(R.id.toggleButtonOnOff);
            onOffButton.setChecked(isOn);
        }

        // ---------------------------------------------------------------------------------------
        public boolean isOnOffButtonChecked()
        {
            ToggleButton onOffButton = (ToggleButton) findViewById(R.id.toggleButtonOnOff);
            return onOffButton.isChecked();
        }

        // ---------------------------------------------------------------------------------------
        public long getZoneId()
        {
            return mZoneId;
        }
} 
```

`getView()`然后我在我的子类的方法中实例化这个视图`BaseAdapter`：

```
// ---------------------------------------------------------------------------------------
@Override
public View getView(int position, View convertView, ViewGroup parent)
{
    NSDestinationContent destinationContent = mDestinationContents.get(position);
    NSViewZoneLarge viewZone = new NSViewZoneLarge(mContext, mShowSwitches, destinationContent.mDestinationContentId);

    viewZone.setZoneName(destinationContent.mName);

    if (mShowSwitches)
        viewZone.setOnOffButton(mOnOffStates.get(position));

    if (destinationContent.mDestinationTypeId.equals(DestinationTypeId.SPEAKERS_GROUP))
    {
        NSSpeakerGroup speakerGroup = (NSSpeakerGroup) destinationContent;
        viewZone.setZoneType(speakerGroup.mZoneTypeId);
    }

    return viewZone;
} 
```

最后，我设置`OnItemLongClickListener`为`listView`：

```
 mZonesListView.setOnItemLongClickListener(new OnItemLongClickListener()
    {
        public boolean onItemLongClick(AdapterView<?> parent, View view, int position, long id)
        {
            NSViewZoneLarge viewZoneLarge = (NSViewZoneLarge)view;
            long destinationId = viewZoneLarge.getZoneId();
            ClipData data = ClipData.newPlainText(NSConstants.DRAG_KEY_ZONE_ID, String.valueOf(destinationId));

            view.startDrag(data, new DragShadowBuilder(view), null, 0);

            Intent intent = new TrashBinIntent(true);
            LocalBroadcastManager localBroadcastManager = LocalBroadcastManager.getInstance(ApplicationNetSpeaker.getInstance());
            localBroadcastManager.sendBroadcast(intent);

            return true;
        }
    }); 
```

问题是尽管我通过方法中的构造函数正确`getZoneId()`设置了该值，但该方法始终返回 null 。`NSViewZoneLarge``getView()`

我知道为什么它返回 null；这是因为给了我一个不是由方法创建`OnItemLongClickListener`的实例。在某处，不知何故，实例是使用第二个 - 仅默认构造函数创建的。`NSViewZoneLarge``getView()``NSViewZoneLarge`

我还尝试使用`setTag()`方法将数据与视图相关联，但该`getTag()`方法总是返回 null ——同样，原始实例在某个地方丢失了，可能由 GC 释放，而我得到了一个没有设置标签的新实例。

有人可以解释一下为什么会发生这种情况，以及如何将任何类型的数据与`ListView`项目的特定视图相关联？

# ruby-on-rails - 指定下载文件夹

> ID：13223089
> 
> 赞同：2
> 
> 时间：2012-11-04T21:25:20.647
> 
> 标签：ruby-on-rails, ruby-on-rails-3

在我的 Rails 控制器中，我有这条线

```
send_file("#{Rails.root}/test/image.png") 
```

我希望我的网页有一个文本框，用户可以填写一个目录，例如`C:/OldPictures/All/`，然后当用户单击调用控制器的链接时，它还会读取文本框中的目录，并将文件下载`image.png`到指定的目录。我能做到吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T22:00:25.607

不。

出于安全原因，Web 服务器（以及一般的 Web 代码，[包括 JavaScript](https://stackoverflow.com/questions/4453798/specify-default-download-folder-possibly-with-javascript)）无法查看客户端的文件系统或指定文件下载到的位置。您可以为下载建议一个文件名，仅此而已（如果您想将其设置为文件在服务器上的名称以外的名称，请使用该`:filename`选项）。`send_file`下载位置由浏览器、操作系统和用户的某种组合决定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T21:44:43.803

简短的回答，是的

长答案，由于各种原因，我们通常不允许客户端应用程序了解服务器上的文件位置。在处理 Web 应用程序时，用户应该与文件实际物理存储的位置“解耦”

现在看代码：

```
<form action="your_action_url" method="get" >
  <input name="location" type="text" />
  ...
</form> 
```

同时，在您的控制器中

```
send_file(File.join(params[:location], "image.png")) 
```

# java - 使用 PHP 连接 MySQL 数据库进行 Android 开发

> ID：13223101
> 
> 赞同：3
> 
> 时间：2012-11-04T21:27:26.417
> 
> 标签：java, php, android, mysql, json

我正在阅读有关如何使用 php 接口通过 Internet 将 android 连接到 mysql 数据库的教程。我按照它说的做了一切。

php代码是这样的：

```
 $q=mysql_query("SELECT * FROM people WHERE birthyear>'".$_REQUEST['year']."'");
  while($e=mysql_fetch_assoc($q))
  $output[]=$e;

  print(json_encode($output));

  mysql_close();
?> 
```

java代码是这样的：

```
String result = "";
//the year data to send
ArrayList<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
nameValuePairs.add(new BasicNameValuePair("year","1980"));

//http post
try{
    HttpClient httpclient = new DefaultHttpClient();
    HttpPost httppost = new HttpPost("http://example.com/getAllPeopleBornAfter.php");
    httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
    HttpResponse response = httpclient.execute(httppost);
    HttpEntity entity = response.getEntity();
    InputStream is = entity.getContent();
}catch(Exception e){
    Log.e("log_tag", "Error in http connection "+e.toString());
}
//convert response to string
try{
    BufferedReader reader = new BufferedReader(new InputStreamReader(is,"iso-8859-1"),8);
    StringBuilder sb = new StringBuilder();
    String line = null;
    while ((line = reader.readLine()) != null) {
            sb.append(line + "\n");
    }
    is.close();

    result=sb.toString();
}catch(Exception e){
    Log.e("log_tag", "Error converting result "+e.toString());
}

//parse json data
try{
    JSONArray jArray = new JSONArray(result);
    for(int i=0;i<jArray.length();i++){
            JSONObject json_data = jArray.getJSONObject(i);
            Log.i("log_tag","id: "+json_data.getInt("id")+
                    ", name: "+json_data.getString("name")+
                    ", sex: "+json_data.getInt("sex")+
                    ", birthyear: "+json_data.getInt("birthyear")
            );
    }
}
}catch(JSONException e){
    Log.e("log_tag", "Error parsing data "+e.toString());
} 
```

现在的问题是它给了我一个错误，即变量“is”不存在！我该怎么办？

本教程来自网站 [helloandroid.com：http://www.helloandroid.com/tutorials/connecting-mysql-database](http://www.helloandroid.com/tutorials/connecting-mysql-database)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T21:31:08.927

```
try{
    InputStream is = entity.getContent();
    ...
    ...
} //'is' goes out of scope here! 
```

范围仅限于第一个 try-catch 块，因此`is`在第二个中不可用。

**做：**

```
InputStream is = entity.getContent(); // 'is' now accessible in both try-catch
HttpEntity entity = response.getEntity(); // 'entity' is now accessible in both try-catch
try{
    HttpClient httpclient = new DefaultHttpClient();
    HttpPost httppost = new HttpPost("http://example.com/getAllPeopleBornAfter.php");
    httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
    HttpResponse response = httpclient.execute(httppost);
    ...
    ...
} 
```

# java - 使用 jar 库自动部署应用程序

> ID：13223102
> 
> 赞同：0
> 
> 时间：2012-11-04T21:27:29.907
> 
> 标签：java, eclipse, maven, spring-mvc, jboss

我尝试使用 eclipse 和 maven 作为依赖解析器部署 Web 应用程序。但我看到了例外：

```
 00:05:31,883 WARN  [org.jboss.as.ee] (MSC service thread 1-6) JBAS011006: Not installing optional component org.springframework.web.context.ContextLoaderListener due to exception: java.lang.ClassNotFoundException: org.springframework.web.context.ContextLoaderListener from [Module "deployment.SpringMVCreName.war:main" from Service Module Loader]
    at org.jboss.modules.ModuleClassLoader.findClass(ModuleClassLoader.java:190) [jboss-modules.jar:1.1.1.GA]
    at org.jboss.modules.ConcurrentClassLoader.performLoadClassUnchecked(ConcurrentClassLoader.java:468) [jboss-modules.jar:1.1.1.GA]
    at org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:456) [jboss-modules.jar:1.1.1.GA]
    at org.jboss.modules.ConcurrentClassLoader.performLoadClass(ConcurrentClassLoader.java:398) [jboss-modules.jar:1.1.1.GA]
    at org.jboss.modules.ConcurrentClassLoader.loadClass(ConcurrentClassLoader.java:120) [jboss-modules.jar:1.1.1.GA]
    at java.lang.Class.forName0(Native Method) [rt.jar:1.7.0_09]
    at java.lang.Class.forName(Class.java:264) [rt.jar:1.7.0_09]
    at org.jboss.as.server.deployment.reflect.DeploymentClassIndex.classIndex(DeploymentClassIndex.java:54) [jboss-as-server-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.as.ee.component.deployers.EEModuleConfigurationProcessor.deploy(EEModuleConfigurationProcessor.java:79)
    at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:113) [jboss-as-server-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110) [rt.jar:1.7.0_09]
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603) [rt.jar:1.7.0_09]
    at java.lang.Thread.run(Thread.java:722) [rt.jar:1.7.0_09]

00:05:31,892 WARN  [org.jboss.as.ee] (MSC service thread 1-6) JBAS011006: Not installing optional component org.springframework.web.servlet.DispatcherServlet due to exception: java.lang.ClassNotFoundException: org.springframework.web.servlet.DispatcherServlet from [Module "deployment.SpringMVCreName.war:main" from Service Module Loader]
    at org.jboss.modules.ModuleClassLoader.findClass(ModuleClassLoader.java:190) [jboss-modules.jar:1.1.1.GA]
    at org.jboss.modules.ConcurrentClassLoader.performLoadClassUnchecked(ConcurrentClassLoader.java:468) [jboss-modules.jar:1.1.1.GA]
    at org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:456) [jboss-modules.jar:1.1.1.GA]
    at org.jboss.modules.ConcurrentClassLoader.performLoadClass(ConcurrentClassLoader.java:398) [jboss-modules.jar:1.1.1.GA]
    at org.jboss.modules.ConcurrentClassLoader.loadClass(ConcurrentClassLoader.java:120) [jboss-modules.jar:1.1.1.GA]
    at java.lang.Class.forName0(Native Method) [rt.jar:1.7.0_09]
    at java.lang.Class.forName(Class.java:264) [rt.jar:1.7.0_09]
    at org.jboss.as.server.deployment.reflect.DeploymentClassIndex.classIndex(DeploymentClassIndex.java:54) [jboss-as-server-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.as.ee.component.deployers.EEModuleConfigurationProcessor.deploy(EEModuleConfigurationProcessor.java:79)
    at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:113) [jboss-as-server-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110) [rt.jar:1.7.0_09]
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603) [rt.jar:1.7.0_09]
    at java.lang.Thread.run(Thread.java:722) [rt.jar:1.7.0_09]

00:05:32,007 ERROR [org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/SpringMVCreName]] (MSC service thread 1-5) Error configuring application listener of class org.springframework.web.context.ContextLoaderListener: java.lang.ClassNotFoundException: org.springframework.web.context.ContextLoaderListener from [Module "deployment.SpringMVCreName.war:main" from Service Module Loader]
    at org.jboss.modules.ModuleClassLoader.findClass(ModuleClassLoader.java:190)
    at org.jboss.modules.ConcurrentClassLoader.performLoadClassUnchecked(ConcurrentClassLoader.java:468)
    at org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:456)
    at org.jboss.modules.ConcurrentClassLoader.performLoadClass(ConcurrentClassLoader.java:398)
    at org.jboss.modules.ConcurrentClassLoader.loadClass(ConcurrentClassLoader.java:120)
    at org.jboss.as.web.deployment.WebInjectionContainer.newInstance(WebInjectionContainer.java:72) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final]
    at org.apache.catalina.core.StandardContext.contextListenerStart(StandardContext.java:3342) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:3850) [jbossweb-7.0.13.Final.jar:]
    at org.jboss.as.web.deployment.WebDeploymentService.start(WebDeploymentService.java:90) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811)
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110) [rt.jar:1.7.0_09]
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603) [rt.jar:1.7.0_09]
    at java.lang.Thread.run(Thread.java:722) [rt.jar:1.7.0_09]

00:05:32,024 ERROR [org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/SpringMVCreName]] (MSC service thread 1-5) Skipped installing application listeners due to previous error(s)
00:05:32,029 ERROR [org.apache.catalina.core.StandardContext] (MSC service thread 1-5) Error listenerStart
00:05:32,029 ERROR [org.apache.catalina.core.StandardContext] (MSC service thread 1-5) Context [/SpringMVCreName] startup failed due to previous errors
00:05:32,041 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-5) MSC00001: Failed to start service jboss.web.deployment.default-host./SpringMVCreName: org.jboss.msc.service.StartException in service jboss.web.deployment.default-host./SpringMVCreName: JBAS018040: Failed to start context
    at org.jboss.as.web.deployment.WebDeploymentService.start(WebDeploymentService.java:95)
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110) [rt.jar:1.7.0_09]
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603) [rt.jar:1.7.0_09]
    at java.lang.Thread.run(Thread.java:722) [rt.jar:1.7.0_09]

00:05:32,047 INFO  [org.jboss.as] (MSC service thread 1-5) JBAS015951: Admin console listening on http://127.0.0.1:9990
00:05:32,048 ERROR [org.jboss.as] (MSC service thread 1-5) JBAS015875: JBoss AS 7.1.1.Final "Brontes" started (with errors) in 3974ms - Started 170 of 249 services (2 services failed or missing dependencies, 76 services are passive or on-demand)
00:05:32,252 INFO  [org.jboss.as.server] (DeploymentScanner-threads - 2) JBAS015870: Deploy of deployment "SpringMVCreName.war" was rolled back with failure message {"JBAS014671: Failed services" => {"jboss.web.deployment.default-host./SpringMVCreName" => "org.jboss.msc.service.StartException in service jboss.web.deployment.default-host./SpringMVCreName: JBAS018040: Failed to start context"}}
00:05:32,278 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-5) JBAS015877: Stopped deployment SpringMVCreName.war in 26ms
00:05:32,280 INFO  [org.jboss.as.controller] (DeploymentScanner-threads - 2) JBAS014774: Service status report
JBAS014777:   Services which failed to start:      service jboss.web.deployment.default-host./SpringMVCreName: org.jboss.msc.service.StartException in service jboss.web.deployment.default-host./SpringMVCreName: JBAS018040: Failed to start context

00:05:32,282 ERROR [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) {"JBAS014653: Composite operation failed and was rolled back. Steps that failed:" => {"Operation step-2" => {"JBAS014671: Failed services" => {"jboss.web.deployment.default-host./SpringMVCreName" => "org.jboss.msc.service.StartException in service jboss.web.deployment.default-host./SpringMVCreName: JBAS018040: Failed to start context"}}}} 
```

我找到了解决这个问题的方法：[JBOSS 7 - Spring ContextLoaderListener ClassNotFoundException](https://stackoverflow.com/questions/7560990/jboss-7-spring-contextloaderlistener-classnotfoundexception)

**这很奇怪，因为..**

理论上这个问题已经解决了，但是昨天我在同一台服务器上开发了同样的应用程序，使用同样的设置，并且使用 maven 获取了同样的 jar，没有任何异常。

我想问如何在没有复制`.jar`文件的情况下解决问题。以及如何在没有手动（显式）用户干预的情况下自动执行此操作。

我只想做：

*   创建项目
*   使用 m2e 解决依赖关系
*   `jboss`并在使用时部署`run`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T21:40:39.900

您需要调查 java 类路径。当您的应用程序请求它们时，这些类必须可供类加载器加载。

通常对于 Web 应用程序，这意味着需要将包含类的 jar 打包到 WAR 的 /WEB-INF/lib 目录中。

使用 Maven，您应该使用包装类型**war**，而不是**jar**。然后maven的war插件（即[http://maven.apache.org/plugins/maven-war-plugin/usage.html](http://maven.apache.org/plugins/maven-war-plugin/usage.html)）会自动将所有依赖打包到war的lib文件夹中。

要使用 m2e 解决依赖关系，您应该

*   确保项目使用 maven 从命令行编译和打包
*   从eclipse中删除项目（不要删除文件）
*   删除 Eclipse 元数据文件（即 .project、.classpath、.settings）
*   打开日食
*   导入 --> 导入现有的 Maven 项目 --> 选择你的项目

此时 m2e 将为您创建所有 eclipse 设置，包括动态类路径库。

# ios - 使 iPad 屏幕关闭，但通过触摸唤醒（无锁定） - - iOS 6.0 / openFrameworks

> ID：13223105
> 
> 赞同：2
> 
> 时间：2012-11-04T21:27:56.117
> 
> 标签：ios, ipad, openframeworks, ios6

在 iPad iOS 6.0 上，如何使屏幕进入睡眠状态，或者以某种方式禁用图形以保持屏幕寿命，但 iPad 没有锁定，也没有必要按下按钮。相反，当触摸屏幕时，iPad 会完全唤醒，程序恢复并继续在屏幕上运行。

我知道当 iPad 真正进入睡眠状态时，触摸功能不起作用，那么是否有中间睡眠模式，屏幕会关闭所有像素亮度，但对任何触摸通知保持警觉？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T22:21:38.497

您将需要防止可以使用您的实例的`setIdleTimerDisabled:`方法完成的“真正的”锁定机制。`UIApplication`

```
[[UIApplication sharedApplication] setIdleTimerDisabled:YES]; 
```

`setBrightness:`然后您可以使用共享`UIScreen`实例的方法降低屏幕亮度。

```
[[UIScreen mainScreen] setBrightness:0.0f]; 
```

要“解锁”屏幕，请执行相反的操作：

```
[[UIApplication sharedApplication] setIdleTimerDisabled:NO];
[[UIScreen mainScreen] setBrightness:1.0f]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T21:53:10.303

在所有东西上放一个黑色的uiview，使用

```
[[UIScreen mainScreen] setBrightness:0.0]; 
```

将亮度调整到尽可能低，然后在触摸时反转这些步骤。

这是我能想到的在不使用某些私有 api 的情况下模拟您需要的功能的唯一方法。

编辑：setBrightness 仅适用于 ios 5.0 及更高版本

# c# - ToCharArray 生成两组数字而不是一组

> ID：13223109
> 
> 赞同：3
> 
> 时间：2012-11-04T21:28:08.680
> 
> 标签：c#

嗨，我正在尝试将一个字符串拆分为一个字符数组，但由于某种原因，结果不是我所期望的。我通过调试器抛出的这段代码，我给它字符串“34325”。当我到达部分出于某种原因将字符串转换为字符数组的代码中，我可以在调试器中看到两组字符。我得到如下信息：

char[0] = 51 '3' char[1] = 52 '4' char[2] = 51 '3' char[3] = 50 '2' char[4] = 53 '5'

然后，当我将 char 数组的每个元素转换为 int 时，第一个数字总是取：51、52、51、50、53。

我的问题是我怎样才能纠正这个，所以我得到 3 , 4 , 3 , 2 , 5 ？当我使用 toCharArray() 方法时，这些数字是从哪里来的：51 ,52 ,51 ,50 53？

这是我的代码：

```
 value = TextBox1.Text;

    char[] numberChars = value.ToCharArray();
    int[] numbers = numberChars.Select(x => Convert.ToInt32(x)).ToArray();

    for( int i = 0; i < numbers.Length; i++ ) {
        TextBox2.Text += numbers[i] + " ";
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T21:30:40.207

你得到的“其他”序列是ascii值的序列......

看一下`int.Parse(string)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T21:30:55.033

如果我正确理解您的问题，您希望将字符串拆分为代表数字的整数，如下所示：`"34325"`变成`new int[] {3,4,3,2,5}`.

如下更改您的代码，以将表示数字的每个字符解释为一位数：

```
 int[] numbers = numberChars.Select(x => ((int)x)-'0').ToArray(); 
```

这是[ideone 上演示的链接](http://ideone.com/HHQLnl)。

您看到 numbers `51`、`52`等的原因是您看到了对应数字的 ASCII 码。

# graphics - 渲染环形螺旋

> ID：13223115
> 
> 赞同：2
> 
> 时间：2012-11-04T21:29:03.607
> 
> 标签：graphics, curve, geometry-surface, helix

我正在使用[Sumanta Guha 的 Computer Graphics Through OpenGL 自学](http://www.sumantaguha.com/)计算机图形学。当谈到其中一个练习时，我似乎遇到了一个小障碍。

它要求读者“丰满”一个带有 n 个线圈的环形螺旋。这意味着将 3D 管道渲染为环绕 n 次的环形螺旋形状。我能够为环形螺旋曲线设计参数方程，但在求解 3D 管道的参数方程时遇到了数学问题。

环形螺旋曲线的参数方程如下：

被缠绕的圆环具有内半径（“甜甜圈”中心的孔）R 和外半径 r。

给定一个参数 t，在 [-PI, PI] 范围内

```
x = (R + r*cos(n*t)) * cos(t)
y = (R + r*cos(n*t)) * sin(t)
z = r*sin(n*t) 
```

显然，我们将需要另一个参数和实际管道的另一个半径。

关于如何开始解决这个问题的任何想法？我用头撞了一下它，但没能做到。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T09:05:48.017

对于螺旋上的每个点`p(t)`，您需要创建一个顶点圆。通过找到 ，计算曲线的切线`p(t+d)`，对于 的一些小值`d`。标准化矢量`p(t)->p(t+d)`- 这是管道顶点所在平面的法线。

将向量从`p(t)`到原点投影到这个平面上。圆中的第一个顶点应位于此投影上，其余顶点围绕平面法线旋转。这将为每个圆提供一致的方向，以便您可以将顶点拼接成三角形。

# java - 在 Java FX 2.2 上从外部控制器加载 FXML

> ID：13223123
> 
> 赞同：1
> 
> 时间：2012-11-04T21:29:56.957
> 
> 标签：java, javafx-2

我目前正在将一个小型应用程序从 Swing 重新编码为 JavaFX，因为它似乎是部署我目前拥有的 web 的最简单方法。

我似乎无法做一些非常简单的事情，而且我在文档和其他帖子中迷失了方向：

无论如何，我有调用相关 FXML 文件的主控制器：

```
public void start(Stage stage) throws Exception {
    Parent root = FXMLLoader.load(getClass().getResource("Login.fxml"));

    Scene scene = new Scene(root);

    stage.setScene(scene);
    stage.show();
} 
```

现在，从 Login.fxml 中，我有一个按钮，我希望该按钮打开另一个 FXML 文件。我可以让按钮成功加载事件，但我尝试了很多东西，但我无法让它工作。我正在尝试这样的事情：

```
private void handleButtonAction(ActionEvent event){

    FXMLLoader fxmlLoader = new FXMLLoader(getClass().getResource("GeneradorBases.fxml"));

   // fxmlLoader.setRoot(this); 
  //  fxmlLoader.setController(this);

    try {
        fxmlLoader.load(); 

    }
    catch (IOException e){
       throw new RuntimeException(e); 
    }
} 
```

我尝试按照我在 Stackoverflow 上看到的示例进行操作。基本上 .setRoot 和 .setController 会使应用程序崩溃。甚至 .load() 也这样做。

关于如何完成这项工作的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T11:22:14.143

鉴于您列出的例外情况，您需要设置所有标记为`@FXML`和类的字段`packet.OtherControllerController` **public**。

更新：您的另一个问题是您没有将 FXML 加载的结果分配给任何东西。

```
public class FirstController implements Initializable {

  @FXML
  public void handleButtonAction(ActionEvent event) throws Exception{
    Node node = (Node) event.getSource();
    Stage stage = (Stage) node.getScene().getWindow();
    Scene scene = stage.getScene();

    FXMLLoader fxmlLoader = new FXMLLoader(getClass().getResource("Second.fxml"));
    Parent root = (Parent) fxmlLoader.load();          

    scene.setRoot(root);
  }
} 
```

有关扩展示例，请参见教程：http: [//docs.oracle.com/javafx/2/get_started/fxml_tutorial.htm](http://docs.oracle.com/javafx/2/get_started/fxml_tutorial.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T08:34:46.263

您的解决方案对`fxmlLoader.load()`. 为了显示加载的 FXML 文件，您需要以某种方式将返回的值传递给您的主控制器（或应管理舞台或场景的代码的另一部分）并将其设置为新根（或例如窗格的子级）应在其中显示）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-10T14:25:33.040

如果提供的解决方案没有帮助，您可以尝试以下代码（对我来说这是可行的）：

```
final FXMLLoader fxmlLoader = new FXMLLoader(getClass().getResource("/fxml/page.fxml"));
      父根 = (父) fxmlLoader.load();

      场景 nscene = 新场景（根）；
      阶段 tStatge = new Stage();
      tStatge.setScene(nscene);
      tStatge.show();

```

# jquery - 透明png图像交换与jquery中的淡入淡出

> ID：13223124
> 
> 赞同：0
> 
> 时间：2012-11-04T21:30:01.410
> 
> 标签：jquery, png, transparent, fade, rollover

我有一个导航栏，其中包含需要翻转的图像，但它们是透明的 png。背景是有纹理的，所以透明的 png 是必须的。我这样做了：

```
 $('.fade').each(function() {  
        var std = $(this).attr("src");
        var hover = std.replace(".png", "_over.png");
        $(this).wrap('<div />').clone().insertAfter(this).attr('src', hover).removeClass('fadein').siblings().css({
            position:'absolute'
        });
        $(this).mouseenter(function() {
            $(this).stop().fadeTo(600, 0);
        }).mouseleave(function() {
            $(this).stop().fadeTo(600, 1);
        });
    }); 
```

此处作为解决方案发布： [A better implementation of a fading image swap with javascript / jQuery](https://stackoverflow.com/questions/7325445/a-better-implementation-of-a-fading-image-swap-with-javascript-jquery)

它可以工作，但问题是在页面加载时可以看到“淡入淡出”png（这只是一个阴影），因为它应该位于主图像后面：http: [//jsfiddle.net/qykwV/](http://jsfiddle.net/qykwV/)

我可以隐藏“_over.png”图像而不是将其放在第一个图像后面吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T00:57:22.007

好吧，我得到了这个工作 - 因为图像是透明的，所以我只是将“over”图像放在顶部然后隐藏它。我通过简单地将 html src 属性更改为过度图像并让脚本创建非“过度”图像来做到这一点，如下所示：

```
 $('.fade').each(function() {  
        var std = $(this).attr("src");
        var hover = std.replace("_over.png", ".png");
        $(this).wrap('<div />').clone().insertAfter(this).attr('src', hover).removeClass('fadein').siblings().css({
            position: 'absolute',
            opacity: '0'
        });
        $(this).mouseenter(function() {
            $(this).stop().fadeTo(600, 1);
        }).mouseleave(function() {

            $(this).stop().fadeTo(600, 0);
        });
    }); 
```

# c# - MVC3 发布策略

> ID：13223133
> 
> 赞同：1
> 
> 时间：2012-11-04T21:31:03.217
> 
> 标签：c#, asp.net, asp.net-mvc-3

我已经构建了一个小型 MVC3 应用程序，它根据环境（开发/生产）有一些不同的配置需求。

这主要体现在两个方面：

1.  **权限**：权限通过 Active Directory 组管理，但我的开发环境在另一个域中，然后是我的生产环境：

    ```
    //
    // GET: /Host/Search
    [Authorize(Roles = @"WIN2012\Main_v2_Read")]
    public ActionResult Search()
    {
        return View();
    } 
    ```

2.  **数据库连接**：在 Dev 中，集成安全性很好。对于生产，应使用服务帐户：

    ```
    < add name="MainContext" connectionString="Data Source=Main-DEV;Initial Catalog=Main;Integrated Security=True" providerName="System.Data.SqlClient" /> 
    ```

我该如何处理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T10:25:40.483

要在不同的配置中使用不同的 web.config，您必须交换此配置，并且在构建、发布、部署期间将使用此配置。您可以通过 Build 菜单底部的配置管理器更改活动配置。或从绿色运行箭头后的右侧选择。

对于有关 DataSource 的 web.congig 转换，请阅读：

[http://blog.discountasp.net/how-web-config-transformation-simplifies-web-deployment/](http://blog.discountasp.net/how-web-config-transformation-simplifies-web-deployment/)

至于问题的第一部分，我建议使用自定义 Authorize 属性，该属性会将您的一些预定义角色名称从您的代码交换为与 web.config 中保存的等效角色名称。这将更容易实现，因为您可以拥有更多的环境，并且每个环境都具有不同的 web.config 转换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T13:59:38.367

如果您需要在运行时注入不同的值，那么您可能应该考虑使用 IOC 来执行此操作。您可以将默认的 FilterProvider 替换为您自己的实现，该实现使用 IOC 容器。

这是统一的过滤器提供程序的实现：

```
public class InjectibleFilterProvider : FilterAttributeFilterProvider
{
    private IUnityContainer cont;
    public InjectibleFilterProvider(IUnityContainer container)
    {
        this.cont = container;
    }

    public override IEnumerable<Filter> GetFilters(ControllerContext controllerContext,
              ActionDescriptor actionDescriptor)
    {
        var filters = base.GetFilters(controllerContext, actionDescriptor);
        if (filters != null)
        {
            foreach (var filter in filters)
            {
                cont.BuildUp(filter.Instance.GetType(), filter.Instance);
            }
            return filters;
        }
        return default(IEnumerable<Filter>);
    }
} 
```

然后你只需要稍微包装一下 AuthorizeAttribute ：

```
public class ModifiedAuthFilter : AuthorizeAttribute
{
    [Dependency]
    public IRoleManager Manager { get; set; }
    public string DesiredRoles { get; set; }

    public override void OnAuthorization(AuthorizationContext filterContext)
    {
        this.Roles = Manager.GetRealRoleNames(this.DesiredRoles);
        base.OnAuthorization(filterContext);
    }
} 
```

我将把 RoleManager 留给你来实现和注入你的 IOC 容器。现在您只需使用新属性而不是旧属性：

```
[ModifiedAuth(DesiredRoles = @"Read_V2_Group")]
public ActionResult Search()
{
    return View();
} 
```

在 global.asax 中注册您的提供商，如下所示：

```
var oldProvider = FilterProviders.Providers.Single(
         f => f is FilterAttributeFilterProvider
    );
FilterProviders.Providers.Remove(oldProvider);
FilterProviders.Providers.Add(new InjectibleFilterProvider(this.Container)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T14:04:09.350

我会选择这个解决方案： [Specifying Roles in web.config of an asp.net MVC application](https://stackoverflow.com/questions/11539217/specifying-roles-in-web-config-of-an-asp-net-mvc-application)

然后使用带有一组设置的 debug.web.config 和带有生产设置的 release.web.config。应该轻而易举:)

# jquery - 在 Firefox 或 Chrome 中未调用 JQuery 委托

> ID：13223136
> 
> 赞同：1
> 
> 时间：2012-11-04T21:31:14.273
> 
> 标签：jquery, asp.net, gridview

我正在使用一个使用图像分页的gridview。每次我单击图像转到下一页时，这似乎都会执行双重回发（第一个会导致 SocketException），因此为了防止这种情况发生，我使用了：

```
$('#GridUpdatePanel').delegate(':input[type=image]', 'submit', function () {
     return false;
}); 
```

这似乎适用于 IE，因此只执行第二次（无错误）回发。然而，Firefox 和 Chrome 似乎甚至没有触发这个功能，这意味着它们仍然执行双重回发。

有任何想法吗？我目前正在使用 jquery 1.6.3

请注意，我的 Gridview 位于更新面板中，这就是我必须使用委托的原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T20:00:47.927

我发现了解决方案 - 我需要将“提交”更改为“点击”：

```
$('#GridUpdatePanel').delegate(':input[type=image]', 'click', function () {
     return false;
}); 
```

我有一种感觉，因为我使用的是旧版本的 jQuery，但由于目前升级不是我的选择，我将不得不坚持这一点。

# c - 如何在 C 中正确实现动态数组

> ID：13223137
> 
> 赞同：0
> 
> 时间：2012-11-04T21:31:13.793
> 
> 标签：c, dynamic-arrays

我试图用 C 语言编写一个简短的程序，该程序从标准输入中获取空格分隔的标记，对标记进行洗牌（置换），然后将洗牌标记打印到标准输出。我的洗牌算法工作正常，问题在于令牌解析。我想将标记存储在动态字符串数组中，以便程序可以支持通过标准输入传递任意数量的标记。但是，每当需要扩展数组时，我当前的动态数组实现都会导致分段错误。我做错了什么？

我的代码：

```
#include <time.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#define BUFFERSIZE 33

int main(int argc, char* argv[]) {
  int i,j,k;
  i=j=k=0;
  int arrSize = 10;
  /* Temp fix */
  /* Get token count as command line argument */
  //if (argc==2) { sscanf(argv[1],"%d",&arrSize); }
  char  c='\0';
  char* t;
  char** datArr = (char**)malloc(sizeof(char*)*arrSize);
  //char* datArr[arrSize];
  char  token[BUFFERSIZE];
  while ( (c=getc(stdin)) != EOF && c != '\0') {
    if(isspace(c)) {
      token[i] = '\0';
      i=0;
      if ( j >= arrSize) {
        arrSize *= 2;
        realloc(datArr, arrSize);
      }
      char* s = (char*)malloc(sizeof(char[BUFFERSIZE]));
      strcpy(s,token);
      datArr[j++] = s;
    }
    else if(i+1 < BUFFERSIZE) {
      token[i++] = c;
    }
  }
  /* Permutate & Print */
  srand(time(NULL));
  for(i=0;i<j;++i) {
    k = rand()%(j-i);
    t = datArr[k];
    datArr[k] = datArr[j-i-1];
    datArr[j-i-1] = t;
  }
  for(i=0;i<j;++i) { printf("%s ",datArr[i]); }
  printf("\n");
  return 0;
} 
```

**注意：**我知道我确实释放了内存

一些示例输入（保持卡片主题）：

```
2C 3C 4C 5C 6C 7C 8C 9C 10C JC KC QC AC 2S 3S 4S 5S 6S 7S 8S 9S 10S JS KS QS AS 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T23:13:50.437

您是否尝试过测试：

```
#include <time.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#define BUFFERSIZE 33

int main(int argc, char* argv[]) {
  int i,j,k;
  i=j=k=0;
  int arrSize = 10;
  /* Temp fix */
  /* Get token count as command line argument */
  //if (argc==2) { sscanf(argv[1],"%d",&arrSize); }
  char  c='\0';
  char* t;
  char** datArr = (char**)malloc(sizeof(char*)*arrSize);
  //char* datArr[arrSize];
  char  token[BUFFERSIZE];
  while ( (c=getc(stdin)) != EOF && c != '\0') {
       // Just read the file
  }
} 
```

我认为这是一个无限循环。

getc() 返回一个 int，而不是 char，所以它不应该停止读取文件，这是一个无限循环。这将耗尽内存，并最终保证一个段错误。

我建议从那里更改`char c='\0';`并`int c;`应用内存处理方面的改进。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T00:49:50.450

VaughnCato 对原始 OP 的评论是该问题的正确答案。

“你需要使用`datArr = (char**)realloc(datArr,arrSize*sizeof(char*));`”

谢谢沃恩卡托！

# c++ - 窗口 c++ 应用程序和 html 打印预览

> ID：13223138
> 
> 赞同：0
> 
> 时间：2012-11-04T21:31:28.280
> 
> 标签：c++, pdf-generation, print-preview

我正在开发一个 c++ 浏览器应用程序，它将在应用程序屏幕上呈现 html。我想打印应用程序屏幕的全部内容（就像 Internet Explorer 一样）。什么是正确且最简单的方法，我只将句柄传递给应用程序窗口并进行打印/pdf。

我用谷歌搜索了这个问题，但只找到了手工绘图。是否有一些库/技术，我通过当前窗口的处理程序并负责打印文本和图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T21:12:13.660

Windows 提供了`PrintWindow`获取窗口图像的功能。这是一个示例，取自我的来源，它将生成的屏幕截图放入剪贴板（考虑到某些 Windows 版本可能不支持该功能，但这似乎对问题并不重要）：

```
void PrintCapturedWindow(HWND hwnd)
{
  HDC hdc = GetDC(hwnd);
  if (hdc)
  {
    HDC hdcMem = CreateCompatibleDC(hdc);
    if (hdcMem)
    {
      RECT rc;
      GetClientRect(hwnd, &rc);

      HBITMAP hbitmap = CreateCompatibleBitmap(hdc, rc.right-rc.left, rc.bottom-rc.top);
      ReleaseDC(hwnd, hdc); hdc = 0;
      if (hbitmap)
      {
          typedef BOOL WINAPI (* pPrintWindow)(HWND hwnd, HDC hdcBlt, UINT nFlags);
          pPrintWindow ppw;

          HMODULE user_hand = GetModuleHandle("user32.dll");
          ppw = (pPrintWindow)GetProcAddress(user_hand, "PrintWindow");
          if(ppw)
          {
            SelectObject(hdcMem, hbitmap);
            (*ppw)(hwnd, hdcMem, 0);
          }

          ::OpenClipboard(NULL);
          ::EmptyClipboard();
          ::SetClipboardData(CF_BITMAP, hbitmap);
          ::CloseClipboard();

          DeleteObject(hbitmap);
      }
      DeleteObject(hdcMem);
    }
    if(hdc != 0) ReleaseDC(hwnd, hdc);
  }
} 
```

# c++ - 数据（错误）对齐的影响

> ID：13223141
> 
> 赞同：2
> 
> 时间：2012-11-04T21:32:07.053
> 
> 标签：c++, visual-studio, alignment

我正在使用 x86 英特尔机器和 Windows 7，以及 Visual C++（版本 2005/2012 express）

我一直在玩对齐（我只是将其作为学习练习。）当然，我理解填充方面对类/结构大小的影响。我相信我理解由于 CPU 指令的工作方式和期望数据的方式，它也可以更好地对齐。

我一直在查看许多不同的资源，例如（有趣的） [c++ 数据对齐/成员顺序和继承](https://stackoverflow.com/questions/2006504/c-data-alignment-member-order-inheritance) （以及其他链接，如维基百科）[http://en.wikipedia.org/wiki/Data_structure_alignment](http://en.wikipedia.org/wiki/Data_structure_alignment)

可能会受到影响的一个领域（我读过）似乎是性能，因为数据需要为寄存器的特定大小，未对齐的数据可能会导致问题（参见维基百科）。

我编写了一些代码，在其中创建了 3 个结构，所有结构都具有相同的成员，打包设置为 1 ，正常对齐，并且重新排列了成员。这给了我大小为 8、10 和 12 的对象。我为每个对象运行了类似于以下的代码：

```
struct MixedData1
{
    char Data1;
    short Data2;
    int Data3;
    char Data4;

    void operator() (MixedData1& md)
    {
        md.Data1 = 'a';
        md.Data2 = 1024;
        md.Data3 = 1000000;
        md.Data4 = 'b';
    }
};

typedef std::vector<MixedData1> MDVector;

int main(int argc, char* argv[])
{
    MixedData1 md;
    for(int count = 0; count < 10 ; count++)
    {    
        {
        std::cout << sizeof(md) << std::endl;
        boost::timer::auto_cpu_timer t;
        MDVector mdv(10000000); 
        std::fill(mdv.begin(),mdv.end(),md );
        std::for_each(mdv.begin(),mdv.end(),md);
        }
    }
} 
```

我对这些值并不感兴趣，因此向量中的每个元素都被初始化为相同的。无论如何，我得到的结果表明运行时间随着结构的大小而增加 - IE with pack(1) (8 bytes) 我得到了最快的 0.08s，而正常对齐 (12 bytes) 我得到了最慢的 0.105 。

我的问题是关于错误对齐的影响。*在我作为 C++ 程序员的X*年里，我认为我从来没有遇到过任何对齐问题，但当然它可能只是让我过去了。

（1）对齐在我的测试（编辑）中产生了影响（我相信），**但是正如尼尔发布的那样，这只是由于 struct size 的差异**。我尝试按照他的回复访问该成员，但我在那里没有看到任何实际效果....有更清晰的例子吗？有没有办法让我看到错位的巨大影响？（2）如果可能的话，有没有办法引起由错位引起的碰撞。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T22:07:32.740

您的代码所做的只是测试处理器复制内存的速度。内存越大，复制越慢。结构内各个成员的对齐方式与复制速度无关，只有结构的大小很重要。

如果要查看对齐的效果，则需要编写实际访问各个未对齐结构成员的代码。例如，您可以编写一个循环来增加每个结构的 data3 成员。根据架构的不同，编译器可能会意识到它必须使用不同的指令来执行算术；在 x86 上通常不是这种情况，编译器会发出看起来很自然的代码，因为处理器能够处理未对齐的访问。一些处理器实际上可以以与对齐数据相同的速度读取和写入未对齐数据。一个简单的例子是 8088，因为它只有一个 8 位数据总线，所以无论如何所有 16 位指令都是使用两个负载来模拟的，

如果你想通过错位引发崩溃，那么通常你需要在不同类型之间转换指针。然后编译器可能并不总是意识到您的指针可能未对齐，并且不会为未对齐的访问生成正确的指令。例如，您可以尝试在 cast char* 指针上调用 SSE 指令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T18:33:02.717

简短的回答：在实践中并不重要。

原因如下：1 或 2 次缓存未命中可能需要不到一毫秒的时间，因此只有在以下情况下访问未对齐的数据才会成为问题：

1.  数据跨越两条缓存线
2.  您访问了许多未对齐的数据，这些数据在内存中并不连续。

由于 2\. 无论如何都会产生大量缓存未命中，因此即使数据对齐，您也不应该处于这种情况。改进对齐方式可以将缓存未命中的数量提高不超过 2 倍，但连续存储数据可以将性能提高很多倍。

有一些指令需要对齐数据。如果您需要这些说明，您要么知道它，要么您的编译器应该为您确保对齐。这是否会影响性能取决于您的处理器的微架构和编译器。无论如何，您应该首先分析您的程序以找到瓶颈。如果对齐显着影响程序的性能，请修复它。否则不要担心。

# ruby - rails date_select 标题作为值

> ID：13223142
> 
> 赞同：0
> 
> 时间：2012-11-04T21:32:15.830
> 
> 标签：ruby, ruby-on-rails-3, datetime, validation

我正在使用 date_select 像这样

```
<%= f.label :birthday %>
<%= f.date_select :birthday , :order => [:month, :day, :year] ,:start_year => 1900, :end_year => Time.now.year-10 %> 
```

我希望每个字段中的第一个选项是“日”“月”和“年”，这将是无效的

如何添加这些值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:08:08.277

您的意思是您需要日期字段的自定义提示吗？

然后你需要使用 :prompt 选项：

date_select("生日", :prompt => { :day => 'day', :month => 'month', :year => 'year' })

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T21:39:39.343

您不能对 date_select 使用这些选项之一吗？

*   `:default => 3.days.from_now`
*   `:include_blank => true`

# c#-4.0 - C# Office PDF 导出后期绑定

> ID：13223143
> 
> 赞同：2
> 
> 时间：2012-11-04T21:32:25.630
> 
> 标签：c#-4.0, pdf, office-interop, late-binding

几个月前，在完成学业时，我创建了一个基本应用程序，可以将 word 和 excel 文档转换为 PDF。我开发应用程序的客户需要它能够使用任何版本的单词，所以当我发现我需要使用后期绑定时。现在，该应用程序使用 office interop 可以完美运行，但我无法将所有内容转换为使用后期绑定。

我有一个 word 文档要打开，但我遇到了以下问题。

```
Type wordType = Type.GetTypeFromProgID("Word.Application");
if(wordType == null)
    throw new Exception(message);

dynamic wordApplication = null;
wordApplication = Activator.CreateInstance(wordType);
if(wordApplication == null)
    throw new Exception(message);

dynamic wordDocument = null;
object paramSourceDocPath = sourceDocPath;
object paramMissing = Type.Missing;

WdExportFormat targetFormat = WdExportFormat.wdExportFormatPDF;
WdExportOptimizeFor paramExportOptimizeFor = WdExportOptimizeFor.wdExportOptimizeForOnScreen;
WdExportRange paramExportRange = WdExportRange.wdExportAllDocument;
int paramStartPage = 0;
int paramEndPage = 0;
WdExportItem paramExportItem = WdExportItem.wdExportDocumentContent;
bool paramIncludeDocProps = true;
bool paramKeepIRM = true;
WdExportCreateBookmarks paramCreateBookmarks = WdExportCreateBookmarks.wdExportCreateWordBookmarks;
bool paramDocStructureTags = true;
bool paramBitmapMissingFonts = true;
bool paramUseISO19005_1 = false;

try
{
    // Open the source document.
    wordDocument = wordApplication.Documents.Open(ref paramSourceDocPath, ref paramMissing, ref paramMissing, ref paramMissing,
        ref paramMissing, ref paramMissing, ref paramMissing, ref paramMissing, ref paramMissing, ref paramMissing,
        ref paramMissing, ref paramMissing, ref paramMissing, ref paramMissing, ref paramMissing, ref paramMissing);

    // Export it in the specified format.
    if (wordDocument != null)
        wordDocument.ExportAsFixedFormat(targetFilePath, targetFormat, openAfter, paramExportOptimizeFor,
            paramExportRange, paramStartPage, paramEndPage, paramExportItem, true, true, paramCreateBookmarks, true,
            true, false, ref paramMissing);
} 
```

无法解析 WdExportXXXXXX 项目，因为我删除了对办公室互操作程序集的引用。我从未真正使用过后期绑定，也不知道如何解决这些类型。我希望一旦我解决了 ExportAsFixedFormat 函数调用将起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T18:05:47.570

我发现[NetOffice](http://netoffice.codeplex.com/)可以完美地完成手头的任务。

# asp.net - wordpress 和 asp.net 一起

> ID：13223145
> 
> 赞同：2
> 
> 时间：2012-11-04T21:32:45.743
> 
> 标签：asp.net, wordpress, seo

我有 asp.net 网络应用程序并想将 WordPress 添加到我的网站中，我发现将 WordPress 添加到我的 asp.net 页面的一种方法是使用 iframe。

问题，如果我将 wordpress 添加到 iframe 中，它是否有 SEO 缺点？请解释一下，如果有人知道将 wordpress 添加到现有 asp.net 应用程序中的另一种方法，请分享。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T21:36:40.830

WordPress 是 PHP。一些服务器可以运行多种服务器语言。如果您的服务器支持 asp.net 和 PHP，您可以简单地将 WordPress 安装到子目录或子域中：

`mysite.com/blog/`或者`blog.mysite.com/`

我会与您的托管服务商联系以确定执行此操作的最佳方法，但这并不难。我不建议将它放在 iframe 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T12:50:54.083

您最大的问题是您的整个博客将由一个页面/网址表示。我会使用子域来托管博客。例如 blog.domain.com

# ruby-on-rails-3 - 为什么在使用 rspec 测试控制器时 response.body 是一个字符串实例

> ID：13223146
> 
> 赞同：2
> 
> 时间：2012-11-04T21:32:46.803
> 
> 标签：ruby-on-rails-3, rspec

在我的控制器的 rspec 测试中，响应的主体始终是 ActiveDispatch::Response 实例的字符串表示形式。

```
=> #<ActionController::TestResponse:0x00000007863010
 ...
 @body=["#<ActionDispatch::Response:0x00000007530d70>"],... 
```

有问题的控制器规格：

```
it 'should not allow invalid email' do
     json = { :format => 'json', :patron_profile => { :email =>   'bogusemail.com', :password => 'password' } }
     post :create, json
     response.status.should eq(302)
     response.body.to_json.should be_json_eql(%({ 'error' : 'error message'}))
end 
```

什么可能导致`response.body`上面显示的 ActionDispatch 字符串？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T18:11:54.083

[Devise](https://github.com/plataformatec/devise)的 Github 帐户上的问题[2074](https://github.com/plataformatec/devise/pull/2074)似乎是导致此问题的原因。

截至 2012 年 11 月 4 日，解决方法是在 Gemfile 中使用 Devise 的 git master 分支。

# jquery - 使用 JQUERY 选项卡显示 SQL 数据

> ID：13223148
> 
> 赞同：2
> 
> 时间：2012-11-04T21:32:50.903
> 
> 标签：jquery, codeigniter

我想将键盘应用程序重新设计为酒吧的触摸屏应用程序（我正在使用 Codeigniter）。

我希望文章分两部分显示：1.所有article_category的列表2.在选择article_category的选项卡下方显示article_name+article_price+article_image

葡萄藤啤酒饮料<-类别

WHITE VINE <-选项卡 VINES 下的不同文章名称

红藤

梅洛赤霞珠

我有带有结构的 SQL 表文章：article_id aicle_name article_category article_price article_image

在寻找解决方案时，我发现 JQUERY 选项卡可以帮助我解决问题。

我在网上找到了 CI 购物车演示。我用我的替换了它的数据库。它按标签的预期工作！我得到了标签中列出的所有类别。

但我不知道如何获取选定选项卡的数据（查看 category.php）？

我的文件：app/controllers/cart.php

```
<?php
    class Cart extends Controller { // Our Cart class extends the Controller class
        function Cart()
        {
            parent::Controller(); // We define the the Controller class is the parent.

            $this->load->model('cart_model'); // Load our cart model for our entire class
        }
        function index()
        {
            $data['categories'] = $this->cart_model->retrieve_category(); // Retrieve an array with all categories
            $data['products'] = $this->cart_model->retrieve_products(); // Retrieve an array with all products
            $data['content'] = 'cart/categories'; // Select view to display
            $this->load->view('index', $data); // Display the page
        }
    } 
```

我的文件：app/models/cart_model.php

```
<?php
class Cart_model extends Model {
    // Function to retrieve an array with all product information
    function retrieve_products(){
        $query = $this->db->get('phppos_item_kits');
        return $query->result_array();
    }
    // Function to retrieve an array with all product information
    function retrieve_category(){
        $this->db->select('distinct(category)');
        $this->db->from('phppos_item_kits');
        $query = $this->db->get();
        return $query->result_array();
    }
} 
```

我的文件：app/views/cart/categories.php

```
<head>
<link href="<?php echo base_url(); ?>assets/js/base/jquery-ui.css" media="screen" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="<?php echo base_url(); ?>assets/js/jquery-1.8.2.js"></script>
<script type="text/javascript" src="<?php echo base_url(); ?>assets/js/base/jquery-ui.js"></script>
  <script>
  $(document).ready(function() {
    $("#tabs").tabs({event: "mouseover"});
  });
  </script>
</head>
<div id="tabs">
    <ul>
    <?php foreach($categories as $c): ?>
        <li><a href="#fragment"><span><?php echo $c['category']; ?></span></a></li>
    <?php endforeach;?>
    </ul>
        <div id="fragment">
        <?php foreach($products as $p): ?>
                <li><?php echo $p['name']; ?>,<?php echo $p['category']; ?></li>
        <?php endforeach;?>
        </div>
</div> 
```

我的文件：app/views/index.php

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xml:lang="en-us" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>CodeIgniter Shopping Cart</title>
<link href="<?php echo base_url(); ?>assets/js/base/jquery-ui.css" media="screen" rel="stylesheet" type="text/css"/>
<link href="<?php echo base_url(); ?>assets/css/core.css" media="screen" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="<?php echo base_url(); ?>assets/js/jquery-ui.min.js"></script>
<script type="text/javascript" src="<?php echo base_url(); ?>assets/js/jquery-1.8.2.min.js"></script>
<script type="text/javascript" src="<?php echo base_url(); ?>assets/js/core.js"></script>
</head>
<body>
<div>
    <?php $this->view($content); ?>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-04T21:55:47.093

解决方案应该在 PHP 代码中（主要是），然后你应该相应地调整你的 JavaScript。

具体来说，**应该为每个类别分配一个属于该类别的产品列表。** 它可以用 SQL 或 PHP 来完成。

使用 SQL 可以通过一种简单的方法来完成 - 一次选择类别列表，然后每个类别选择一次，这意味着 1+n 选择问题。但是对于少量的类别可能是可以接受的。

或者它可以用 JOIN 来完成，这将消除 1+n 问题。如果您甚至需要显示空类别，则需要 LEFT OUTER JOIN，如果不需要，则需要 [INNER] JOIN。

希望能帮助到你。如果您需要澄清/示例，请告诉我。

# iphone - 钛iOS模块

> ID：13223150
> 
> 赞同：0
> 
> 时间：2012-11-04T21:33:31.400
> 
> 标签：iphone, ios, titanium, titanium-mobile

我正在尝试为我必须创建 UIView 的地方开发一个 iOS 模块，但它给了我

`[ERROR] Script Error = invalid method (createView) passed to ComTestModule at app.js`

我已经关注了这个链接 [iOS_Module_Development_Guide](http://docs.appcelerator.com/titanium/2.0/index.html#!/guide/iOS_Module_Development_Guide)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:39:06.610

看这里

[https://github.com/appcelerator/titanium_modules](https://github.com/appcelerator/titanium_modules)

具体例子在这里 [https://github.com/appcelerator/titanium_modules/blob/master/moddevguide/mobile/ios/example/demos/viewproxyDemo.js](https://github.com/appcelerator/titanium_modules/blob/master/moddevguide/mobile/ios/example/demos/viewproxyDemo.js)

# java - Java 中的泛型和类型推断

> ID：13223160
> 
> 赞同：3
> 
> 时间：2012-11-04T21:34:43.863
> 
> 标签：java, generics

我正在阅读“Thinking in Java 4th edition”中的泛型章节，并且有一个示例：

```
class Fruit{}
class Apple extends Fruit {} 
```

...

```
static <T> void writeExact(List<T> list, T item) {
            list.add(item);
    }

    static List<Apple> apples = new ArrayList<>();
        static List<Fruit> fruit = new ArrayList<>();

        static void f1() {
            writeExact(apples, new Apple());
            // writeExact(fruit, new Apple()); // Error:
            // Incompatible types: found Fruit, required Apple
        }

        static <T> void writeWithWildcard(List<? super T> list, T item) {
            list.add(item);
        }

        static void f2() {
            writeWithWildcard(apples, new Apple());
            writeWithWildcard(fruit, new Apple());
        } 
```

那些指示错误的注释行在 6 和 7 Java 中都不会产生任何错误。这对我来说似乎很奇怪，因为`writeExact`方法只接受确切类型的参数。那么它为什么起作用呢？既然它有效，那么超类型通配符的目的是什么？

**编辑**

所以我明白了，想再澄清一件事：谁是使用通配符进行类型推断的老大？返回类型，第一个参数，第二个参数，...。我的意思是如果 SomeClass.< **Fruit** >method(...) 没有指定

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T21:40:54.050

它之所以有效，是因为`T`in`writeExact`是方法本身的类型变量。看，它就在 void 返回类型之前：

```
static <T> void writeExact(List<T> list, T item) 
```

这意味着无论何时调用它，它`T`都会采用接受其参数所需的类型，只要有一个。您可以使用任何列表和适合该列表的对象调用它。

也许明确给出类型参数会更清楚，而不是让编译器推断它（您需要使用类的名称来为静态方法执行此操作；我假设它是`MyClass`）：

```
 MyClass.<Apple>writeExact(apples, new Apple());
        MyClass.<Fruit>writeExact(fruit, new Apple()); 
```

在第二次调用中，`T`有值`Fruit`，这意味着第一个参数必须是 a `List<Fruit>`，它是，第二个参数必须是 a `Fruit`，它是，因为`Apple`是 的子类型`Fruit`。

[Java 语言规范的第 15.12.2.7 节](http://docs.oracle.com/javase/specs/jls/se5.0/html/expressions.html#15.12.2.7)给出了隐式分配类型参数的规则。至少，我认为他们是；这不是一本容易阅读的书。

我猜这本书中的代码与你上面给出的代码并不完全相同。如果是，那么它肯定是不正确的，你应该写信给 Eckel 先生并告诉他。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T21:40:10.023

```
static <T> void writeExact(List<T> list, T item) {
            list.add(item);
    } 
```

会接受 (List of Applies,Apple or List of Fruits, Fruit or List of Applles, Fruit(as Fruit is the subtype of apple)) 因为您使用参数化类型**T**声明了它。

# windows - 是否有“编译”为 Windows 批处理语法的脚本语言？

> ID：13223161
> 
> 赞同：6
> 
> 时间：2012-11-04T21:34:45.970
> 
> 标签：windows, command-line, batch-file, cmd

有没有一种语言，类似于[CoffeeScript](http://coffeescript.org/)之于 JavaScript，可以编译成 windows 批处理|cmd|命令行的语言？

我指的 cmd 版本是基于 NT 的版本，尤其是 XP sp3 及更高版本。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-10-10T02:10:41.497

是的，有一种语言称为 Batsh，它可以编译为 Bash 和 Windows Batch。

项目：[https ://github.com/BYVoid/Batsh](https://github.com/BYVoid/Batsh)

在线演示：[http ://batsh.byvoid.com/](http://batsh.byvoid.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T23:00:34.607

据我所知，您所要求的并不存在，尽管创建这样的语言是可能的，而且这将是一个有趣的练习。

另一种选择是也“内置”到操作系统的其他语言。

其他人提到了 PowerShell，它非常强大，而且我认为是在 Win7 及更高版本中内置的。

另一种选择是 Windows Script Host，您可以使用 VBScript 和/或 Javascript 编写脚本。它内置于 WinXP 及更高版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T21:38:51.930

为了您的启迪，CoffeeScript 是一种基于 JavaScript 构建的特定领域语言，因此您理论上可以将两者混合使用。我不知道批处理文件的这种语言。windows powershell 可能值得一看。

# python - 我收到“[errno 22] 无效参数：'test.txt\r'

> ID：13223163
> 
> 赞同：2
> 
> 时间：2012-11-04T21:35:01.100
> 
> 标签：python, file, text, error-handling

我正在试验一个允许您编辑文本文件的 python 程序，稍后我将在其他程序中使用此功能，但我收到错误：[errno 22] Invealid argument: 'test.txt\r'。我也从未将 \r 添加到 test.txt 中。这是我的代码：

```
 def menu():
     print("Type in the full name of the text file you would like to add to.")
     file1 = input()
     with open(file1, "br") as add:
         print("What do you want to write?")
         text = input()
         add.write(text)
 menu() 
```

好吧，新问题。我编辑了代码，现在它说`file1 = input().strip()`并且它工作正常，直到我得到另一个错误。错误是：`io:UnsupportedOperation: write`。错误说它在第 7 行中说`add.write(text)`.

没关系，我将 with 更改为`open(file1, "br")`with `open(file1, "a")`，现在可以正常工作了。感谢您的所有帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T21:36:17.760

利用：

```
file1 = input().strip() 
```

`input()`在末尾返回新行，这会使文件名无效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T21:36:58.510

用于`input().strip()`从您的输入中删除尾随的换行符，这可能是由于在终端或 cmd 中运行您的程序。

# dependency-injection - MVC 4 和 Unity，将依赖项注入 WebAPI 控制器

> ID：13223166
> 
> 赞同：2
> 
> 时间：2012-11-04T21:35:05.353
> 
> 标签：dependency-injection, controller, asp.net-mvc-4, asp.net-web-api, unity-container

我是 MVC 的新手，我遇到了一个问题。我设法找到的所有示例都指的是简单的控制器，而不是 API 控制器。也许任何人都有一个工作代码示例，说明如何在 Application_Start() 上将依赖项注册到 Unity 并调整代码，以便在创建我的 apicontroller 类后，将正确的依赖项传递给它。假设这是我的控制器的定义：

```
public class BookController : ApiController
{
    private IBookService bookSerivce;

    public BookController (IBookService bookSerivce)
    {
        this.bookSerivce= bookSerivce;
    }
} 
```

我希望通过以下方式统一注册它：

```
UnityContainer container = new UnityContainer();

// Register services
container.RegisterType<IBookService , BookService>();

// Register controllers
container.RegisterType<IHttpController, BookController>("Books"); 
```

现在，为了让 MVC 使用统一解决依赖关系，开始创建此控制器的实例并将依赖关系传递给它，我需要做什么？

我正在使用 MVC 4。任何想法将不胜感激。

干杯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-05T06:22:17.853

Mark Seemann 有两篇关于使用 WebAPI 进行依赖注入的文章。

[使用 ASP.NET Web API 进行依赖注入和生命周期管理](http://blog.ploeh.dk/2012/09/28/DependencyInjectionandLifetimeManagementwithASP.NETWebAPI/)

[ASP.NET Web API 中的依赖注入与 Castle Windsor](http://blog.ploeh.dk/2012/10/03/DependencyInjectioninASP.NETWebAPIwithCastleWindsor/)

如果您将 Castle Windsor 替换为 Unity，则示例应该可以正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T06:13:53.457

看起来您正在使用 WebAPI。查看这篇关于 ASP.NET WebAPI 中的 Unity 集成的文章：

[介绍 Unity.WebAPI NuGet 包](http://www.devtrends.co.uk/blog/introducing-the-unity.webapi-nuget-package)

# java - 实现 java.util.List - 寻找 JUnit 测试进行验证

> ID：13223167
> 
> 赞同：1
> 
> 时间：2012-11-04T21:35:07.580
> 
> 标签：java, list, collections, junit

我正在实现`java.util.List`接口。

当我按方法实现它时，我也在`JUnit`4.10 中为它们编写测试用例。

我想知道，是否有任何已经准备好的测试涵盖了 a`List`提供的 100% 的功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T22:16:47.697

OpenJDK 没有使用 JUnit 进行测试，而是使用他们自己的工具 jreg 进行测试，因为当他们开始回归测试时，JUnit 还不可用或没有提供足够的功能。经过一番谷歌搜索，[这](https://github.com/openjdk-mirror/jdk7u-jdk/blob/master/test/java/util/Collection/MOAT.java)出现了，除了是一个 jreg 测试之外，它似乎就是你要找的东西。

至于JUnit，不知道有没有人做过。由于 JDK 使用了另一个工具，也许你可以看看 Apache Harmony 背后的人在使用什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-09T21:19:29.660

好的，我偶然发现了这篇博文： [Google Guava Collection Test Suite](http://www.gamlor.info/wordpress/2012/09/google-guava-collection-test-suite/)

*Google Guava Testlib 带来了一个完整的测试套件，用于测试 Set、List 和 Map 实现的行为。您可以指定您的集合支持哪些功能，然后从 Google 为您编写的数百个测试中获益。*

因此，在测试 Collection 接口的自定义实现时，这是真正要使用的交易。

# three.js - 开口端气缸未显示内部材料

> ID：13223168
> 
> 赞同：6
> 
> 时间：2012-11-04T21:35:12.270
> 
> 标签：three.js

jsFiddle 演示问题：http: [//jsfiddle.net/calvintennant/nnm64/1/](http://jsfiddle.net/calvintennant/nnm64/1/)

消息来源建议添加`mesh.flipSided = true`将在网格内部渲染材质，其他[消息来源](https://github.com/mrdoob/three.js/issues/388)提到`mesh.doubleSided = true`用于在内部和外部显示圆柱体。正如我的 jsFiddle 所示，这些似乎不起作用..

难道我做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-04T21:54:44.617

如[迁移](https://github.com/mrdoob/three.js/wiki/Migration)页面中所述，这在 r49 和 r50 之间发生了变化！

`object.flipSided`现在是`material.side = THREE.BackSide`。
`object.doubleSided`现在是`material.side = THREE.DoubleSide`。

固定 jsfiddle：http:
[//jsfiddle.net/nnm64/2/](http://jsfiddle.net/nnm64/2/)

# ruby - 将所有正则表达式匹配作为参数发送

> ID：13223170
> 
> 赞同：3
> 
> 时间：2012-11-04T21:35:23.233
> 
> 标签：ruby

我有一个存储在哈希中的替换规则“表”，其中每个键是规则，每个值是一个方法，它将获取匹配的文本并将其作为参数发送。每个方法都会返回一个字符串。除了我不知道如何发送所有比赛。我如何填写`send`电话中的评论以完成此操作？

```
Sub_Rules = {
   /N\[(\d+)\]/i          => :do_something,
   /N\[(\d+)\]\[(\d+)\]/i => :do_something_else
}

def do_something(*args)
  "something based on the args"
end

def do_something_else(*args)
  "something else based on the args"
end

text = "N[2]"
Sub_Rules.each {|rule, method|
  p text.gsub(rule) {send(method, #the matches?)}
} 
```

如果我想对其进行硬编码，我可能会执行以下操作：

```
text.gsub(/N\[(\d+)\]/i) { do_something($1) } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T22:30:21.203

如果`text.gsub(/N\[(\d+)\]/i) { do_something($1) }`有效，那么这也将：

```
Sub_Rules.each do |rule, method|
  p text.gsub(rule) { send(method, $1) }
end 
```

但我怀疑这`text.gsub(/N\[(\d+)\]/i) { do_something($1) }`实际上不起作用，因为它也没有“发送所有匹配”。相反，您可能想要

```
Sub_Rules.each do |rule, method|
  p text.gsub(rule) { send(method, $~.captures) }
end 
```

这将发送来自正则表达式中每个组的[捕获](http://ruby-doc.org/core-1.9.3/MatchData.html#method-i-captures)数组。

# python - 带有Django ORM的抽象类中的子依赖字段

> ID：13223173
> 
> 赞同：0
> 
> 时间：2012-11-04T21:35:37.080
> 
> 标签：python, inheritance, django-models, django-orm

我有这两个模型：

```
class Interface(models.Model):
    # fields
class OldInterface(models.Model):
    interface = models.ForeignKey(_base,related_name='old_versions')
    class Meta:
        abstract = True 
```

由他们的“空间”和“功能”变体继承：

```
class SpatialInterface(Interface):
    # fields
class OldSpatialInterface(OldInterface):
    _base = SpatialInterface

class FunctionalInterface(Interface):
    # fields
class OldFunctionalInterface(OldInterface):
    _base = FunctionalInterface 
```

当然我的代码失败了，因为 _base 没有在父模型中定义。

我的问题是：有什么办法或技巧告诉 ForeignKey 从子 Model 读取目标模型？

或者更一般地说，有什么方法可以在父类中动态读取位于子类中的变量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T08:38:33.870

根据我的研究，我认为这是不可能的，因为 syncdb 解析 models.py : 的`__init__()`方式**没有**被调用，所以我没有找到任何方法来根据孩子动态设置 ForeignKey 目标。

# asynchronous - 在后台定期下载内容 ios 5

> ID：13223176
> 
> 赞同：0
> 
> 时间：2012-11-04T21:36:06.903
> 
> 标签：asynchronous, background, download, connection, task

嗨在我的应用程序中，我需要在应用程序处于后台时每隔确定的时间下载新内容。我一直在阅读有关使用 NSOperation、异步调度和使用 beginBackgroundTaskWithExpirationHandler 的内容，但我没有清楚地了解这一点，我不知道是否需要使用一些计时器来让我的应用程序每小时下载一次内容。

谁能告诉我实现这一目标的最佳方法是什么？或者至少为我指出正确的方向以及我需要使用哪些对象。

谢谢你们的评论。

编辑：在互联网上阅读我发现有些人说当应用程序进入锁定屏幕时 NSTimer 停止。这是真的？我怎样才能让我的应用程序每小时从服务中下载新内容？即使应用程序在后台并且设备处于锁定屏幕。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T21:42:18.330

在 iOS 中，您的应用程序只能在某些例外情况下（如 VoIP、基于位置和其他一些）在后台运行，否则不允许在后台运行。此外，iOS 可以随时终止您的应用程序，以节省一些内存。

# java - 在java中使用多个分隔符拆分字符串

> ID：13223183
> 
> 赞同：4
> 
> 时间：2012-11-04T21:36:48.607
> 
> 标签：java, string, stop-words

我正在研究一种数据挖掘算法，我需要使用多个单词对字符串进行标记。我有一个单独的文件，其中包含所有停用词。我需要做的是通过任何作为分隔符的单词（停用词）来标记输入字符串。例如。 如果
文件按 原样 包含
停用 词

输入字符串变成
“一个计算机集群由一组松散连接的计算机组成，它们一起工作”
输出变成
计算机集群由
一组
松散连接的计算机
一起工作

递归地检查所有停用词的字符串会非常耗时吗？有什么好的方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-04T21:44:56.167

构造形式的正则表达式

```
delim1|delim2|delim3 
```

然后使用`String`'`split()`方法通过任何分隔符分割文本。

为了构造正则表达式，请阅读每个分隔符，并将其传递给，`Pattern.quote`然后再附加到您构建的正则表达式。这将使您的分隔符也可以使用正则表达式元字符。

# jsf - 将枚举值作为方法参数传递时出现 javax.el.MethodNotFoundException (JBoss 7.1.1)

> ID：13223189
> 
> 赞同：0
> 
> 时间：2012-11-04T21:37:21.083
> 
> 标签：jsf, jsf-2, el, jboss7.x

以下 JSF 视图片段：

```
<h:commandLink value="Search" action="#{personSearch.search('SEARCH_TERM')}" styleClass="btn btn-primary" />

<h:commandLink value="Search" action="#{personSearch.search('SPECIALITY_CODE')}" styleClass="btn btn-primary" /> 
```

调用以下 bean 方法：

```
public void search(SearchType searchType) {
    ... 
```

它将以下枚举类型作为参数：

> 公共枚举 SearchType { SEARCH_TERM, SPECIALITY_CODE }

因 MethodNotFoundException 而失败：

```
10:34:06,851 ERROR [org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/core-webapp].[FacesServlet]] (http--0.0.0.0-8080-1) Servlet.service() for servlet FacesServlet threw exception: javax.el.MethodNotFoundException: /person/search.xhtml @59,39 action="#{personSearch.search('SPECIALITY_CODE')}": Method not found: Proxy for view class: net.hl.core.view.PersonSearch of EJB: PersonSearch.search(java.lang.String)
    at com.sun.faces.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:109) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:88) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:102) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at javax.faces.component.UICommand.broadcast(UICommand.java:315) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:794) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:1259) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:81) [jsf-impl-2.1.7-jbossorg-2.jar:] 
```

我正在使用**JBoss AS 7.1.1.Final 和 Mojarra 2.1.7-jbossorg-1**。

有什么想法可能会出错吗？

# c# - DbContext 试图创建表

> ID：13223190
> 
> 赞同：1
> 
> 时间：2012-11-04T21:37:48.980
> 
> 标签：c#, frameworks, entity

我有一个自定义 DbContext 类。我在系统中有现有的表。我已经建立了一个基于 POCO 的系统。

当我尝试在 DbSet 中查询表时，它会尝试创建表。现在表已经存在于数据库中，sql server 会抛出异常。

如何禁止通过 EF 创建表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T21:48:06.013

当应用程序启动时（例如`Application_Start()`方法`global.asax.cs`）指示您要用于创建数据库的策略：

```
 Database.SetInitializer(new DropCreateDatabaseIfModelChanges<YourContext>()); 
```

`Database`在`System.Data.Entity`命名空间中。

如果使用`new DropCreateDatabaseIfModelChanges<YourContext>()`它将删除数据库并尝试创建数据库模式和 POCO 之间的更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T21:52:59.567

把它放在你的 DbContext 实现中：

```
// static constructor
static MyDbContext()
{
    Database.SetInitializer<MyDbContext>(null);
} 
```

# python - 动画绘制networkx边缘

> ID：13223191
> 
> 赞同：5
> 
> 时间：2012-11-04T21:38:09.720
> 
> 标签：python, matplotlib, networkx

我有一个代表网络拓扑的 networkx spring 布局 关键节点的颜色为红色，另一个为蓝色 到关键节点边缘的路由用破折号表示 如何以指定的时间间隔为绘制 networkx 边缘设置动画？

```
#!/usr/bin/env python

import matplotlib.pyplot as plt
import networkx as nx
import matplotlib as mpl

G=nx.Graph()

G.add_edge('a','b',weight=0.6)
G.add_edge('a','c',weight=0.2)
G.add_edge('c','d',weight=0.1)
G.add_edge('c','e',weight=0.7)
G.add_edge('c','f',weight=0.9)
G.add_edge('a','d',weight=0.3)

elarge=[(u,v) for (u,v,d) in G.edges(data=True) if d['weight'] >0.5]
esmall=[(u,v) for (u,v,d) in G.edges(data=True) if d['weight'] <=0.5]

#specify an initial position that is not random e.g. use a circular layout
pos=nx.circular_layout(G)
pos=nx.spring_layout(G,dim=2,pos=pos) # positions for all nodes
#pos=nx.spring_layout(G) # positions for all nodes
print "Graph xy positions"
print  pos

# nodes
nx.draw_networkx_nodes(G,pos,node_size=700)

# edges
nx.draw_networkx_edges(G,pos,edgelist=elarge,
                width=6)
nx.draw_networkx_edges(G,pos,edgelist=esmall,
                width=6,alpha=0.5,edge_color='b',style='dashed')

# labels
nx.draw_networkx_labels(G,pos,font_size=20,font_family='sans-serif')

plt.xlim(-0.05,1.05)
plt.ylim(-0.05,1.05)
plt.axis('off') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T03:45:37.837

试试这个[`animation`模块](http://matplotlib.org/api/animation_api.html)。另请参阅这个很棒的[教程](http://jakevdp.github.com/blog/2012/08/18/matplotlib-animation-tutorial/)，[Matplotlib 对图像进行动画处理](https://stackoverflow.com/questions/12666990/matplotlib-animate-over-an-image/12676593#12676593)，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T17:00:21.120

在这里我所做的，您可以使用 plt.figure() 获取图形的实例并将其粘贴到画布中，然后使用例如 vbox 将画布添加到面板：

```
import matplotlib.pyplot as plt
import networkx as nx
import wx
from matplotlib.backends.backend_wxagg import \
FigureCanvasWxAgg as FigCanvas, \
NavigationToolbar2WxAgg as NavigationToolbar

class NetworkFrame(wx.Frame):

def __init__(self):
    wx.Frame.__init__(self, None, -1)
    self.panel = wx.Panel(self)
    self.fig = plt.figure()
    self.canvas = FigCanvas(self.panel, -1, self.fig)
    G=nx.house_graph()
pos={0:(0,0),
    1:(1,0),
    2:(0,1),
    3:(1,1),
    4:(0.5,2.0)}

nx.draw_networkx_nodes(G,pos,node_size=2000,nodelist=[4])
nx.draw_networkx_nodes(G,pos,node_size=3000,nodelist=[0,1,2,3],node_color='b')
nx.draw_networkx_edges(G,pos,alpha=0.5,width=6)
plt.axis('off')
self.vbox = wx.BoxSizer(wx.VERTICAL)
    self.vbox.Add(self.canvas, 1, wx.LEFT | wx.TOP | wx.GROW)
    self.toolbar = NavigationToolbar(self.canvas)
    self.vbox.Add(self.toolbar, 0, wx.EXPAND)
    self.panel.SetSizer(self.vbox)
    self.vbox.Fit(self)

#plt.savefig("house_with_colors.png") # save as png
#plt.show() # display

if __name__ == '__main__':
  app = wx.PySimpleApp()
  app.frame = NetworkFrame()
  app.frame.Show()
  app.MainLoop() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T22:10:47.433

试试这个

```
def animate():
    tstart = time.time()                  
    nf = 100
    for i in np.arange(1,nf):
        #...
        #update plot code
        #...
        fig.canvas.draw()                 

        # stop execution of animate() untill the generators next() method is called
        yield True                        # continue animation
    print 'FPS:' , nf/(time.time()-tstart)
    raise SystemExit 
```

# apache - Apache 是否以原子方式处理 HTTP Post - 即它是否确保文件在完全下载之前不可用

> ID：13223192
> 
> 赞同：1
> 
> 时间：2012-11-04T21:38:29.730
> 
> 标签：apache, post, https, atomic

我们有一个 Apache 服务器（Unix 变体），它将为少量文件提供服务以响应传入的请求。通过从另一个系统传输替换文件（不，我们无法更改），这些文件将随机更新（它们包含实时数据）。当前提出的传输更新的方法是通过 HTTPS POST 替换整个文件（这里有一些灵活性）。我想知道 Apache 是否会自动处理传入的 POST 请求 - 即。如果入站 GET 请求与 POST 更新同时发生，Apache 是否会确保 GET 接收到文件的旧版本或新版本，而不是错误或某种组合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T21:44:11.027

Apache 不处理 POST 请求。您可能会有一个 CGI 程序，一个实际处理 POST 过程的脚本。GET 请求的行为取决于此脚本如何覆盖现有文件。最安全的方法是将 POST 数据下载到单独的文件中，然后将其重命名为现有文件，这将导致所需的行为。

# path - GWT / SmartGWT / 跨站点相对路径问题

> ID：13223194
> 
> 赞同：2
> 
> 时间：2012-11-04T21:38:59.310
> 
> 标签：path, linker, smartgwt, skin, cross-site

我正在努力解决以下简短描述的问题：Loading module cross site results in no skin due to wrong image paths etc.

我在尝试什么：我正在尝试提供一个 HTML 代码片段，它可以嵌入到发布者网站中，并且正在加载我的 SmartWGT 模块之一。在使用 GWT 链接器“xs”以及我自己在 *.gwt.xml 中链接的 CSS 后加载 JavaScript 工作正常，但 SmartGWT 皮肤和我的图像丢失。当我检查皮肤图像等的来源时，这指向发布者网站的主机而不是我的主机。

这是我用于嵌入的 HTML 片段：

```
 <script type="text/javascript" src="https://www.xanaroo.de/xanaroo/org.xanaroo.XanarooLite/org.xanaroo.XanarooLite.nocache.js"></script>
    <div id="xanaroo_lite"></div> 
```

请有人告诉我这将如何工作，因为我不知道如何进行。由于 SmartGWT JavaScript 文件在编译期间出现问题，GWT 链接器“xsiframe”无法工作。所以，一定有其他的解决办法！？非常感谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T15:44:25.303

我认为您需要使用`setSkinDir`来指示另一台主机，而不是您的模块正在运行的主机。你可以看看这个旧[帖子](http://forums.smartclient.com/showthread.php?t=3511&highlight=setskindir)

# php - 将动态 xml 插入 JavaScript

> ID：13223195
> 
> 赞同：0
> 
> 时间：2012-11-04T21:39:00.387
> 
> 标签：php, javascript, xml

我有一个从 xml 获取数据的时间轴 javascript。我设法编写了 xml 生成器。时间线，当它从 xml 提供时，工作正常。

但是当我连接 xml 生成器而不是 XML 文件时，它会失败。我检查了，生成器输出正确的数据（我将其保存到 XML 文件并检查了时间线插件）

```
//WORKS: 
Timeline.loadXML("./example.xml", function(xml, url) { eventSource.loadXML(xml, url); })

//DOES NOT WORK
Timeline.loadXML("./TimelineReportXML.php", function(xml, url) { eventSource.loadXML(xml, url); }) 
```

怎么了？Javascript 无法从具有 .php 扩展名的文件中获取 XML？我有哪些选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T21:42:58.423

在 PHP 中，您需要添加 XML 内容类型标头：

```
header('Content-type: application/xml'); 
```

此行必须在任何输出之前包含在您的 PHP 脚本中。

# rest - collection.fetch 和 collection.create 中的主干模型解析

> ID：13223198
> 
> 赞同：1
> 
> 时间：2012-11-04T21:39:16.420
> 
> 标签：rest, backbone.js

在我的 Backbone 支持的应用程序中，我正在使用 REST 函数。在后端，它的 PHP。我正在为对服务器进行的任何 REST 调用使用特定的响应结构。响应类型是这样的：

```
$response = array(
    "success" => // true/false,
    "data" => // can be an array or a value
    "message" => // a string
) 
```

我有一个名为 team_member 的模型**和一个名为****team_members**的集合。当调用 team_members.fetch() 时，服务器响应（在成功的情况下）如下：

```
$response = array(
    "success" => // true
    "data" => array(
          array (some member data),
          array (some member data),
          array (some member data)
     ),
    "message" => "Found 3 members"
) 
```

问题是，当获取单个模型时，我仍然想像上面的样式一样响应，而不仅仅是发送成员数据数组。但是当我这样做时，它不能很好地工作，因为在 collection.fetch() 中数组是不同的。

解决此问题的最佳方法是什么，请记住我希望后端响应样式保持一致，无论是单个模型还是集合。我希望我解释得很好。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T21:48:07.633

好的，我解决了这个问题。我可以打电话`collection.fetch({ parse: false })`。这确实会调用集合上的 parse 方法，但会抑制每个模型上的解析。因此，当我创建/更新特定模型时，我能够使用 model.parse() 函数。

# c# - 如何通过电子邮件发送 Excel 文件？

> ID：13223200
> 
> 赞同：9
> 
> 时间：2012-11-04T21:39:29.773
> 
> 标签：c#, excel, email, attachment

我有一个 excel 文件（Excel 2003 / xls 格式），我想用 c# 通过电子邮件发送它。我的代码发送成功，但是当我尝试打开响应文件时，它似乎编码错误。

例如这里是响应文件名：

> =_utf-8_B_RWxzesOhbW9sw6FzXzIwMTJfMTBfMTZf.dat

这是响应文件本身：

> =?utf-8?B?VEdWdmJIWmhjMkZ1Wk1Pelh6UXlYekZmPz0NCiA9P3V0Zi04P0I/VGtW?=\ \ =?utf-8?B?TlgwZFRXaTU0YkhNPT89?=" 内容传输编码：base64 内容处置：附件
> 
> 0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAEAAAAWAAAAEAAAD+////AAAAAAAAAAD//////////////////////////////////// ///////////////////////////////////////// ///////////////////// ....

这是我的代码片段：

```
...
var attachment = new Attachment(WriteFileToMemory("fileFullPath"), "fileName.xls");
attachment.ContentType = new ContentType("application/vnd.ms-excel");
attachmentCollection.Add(attachment);
...

private Stream WriteFileToMemory(string filePath)
{
    var memoryStream = new MemoryStream();
    _openedStreams.Add(memoryStream);
    using (var file = new FileStream(filePath, FileMode.Open, FileAccess.Read))
    {
        var bytes = new byte[file.Length];
        file.Read(bytes, 0, (int) file.Length);
        memoryStream.Write(bytes, 0, (int) file.Length);
        file.Close();
    }
    memoryStream.Position = 0;
    return memoryStream;
} 
```

如何设置附件编码类型，以及我应该对 Excel 文件使用哪种编码？

请帮我解决这个问题。提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-05T08:19:37.827

正如@Magnus 指出的那样，你让它太复杂了，`new Attachment()`可以处理`FileStream`s 所以只需将一个新的文件流传递给构造函数。

```
...
var attachment = new Attachment(File.Open("fileFullPath", FileMode.Open), "fileName.xls");
attachment.ContentType = new ContentType("application/vnd.ms-excel");
attachmentCollection.Add(attachment);
... 
```

警告一句，kind 是题外话，你不能多次发送这样的邮件，因为流不会总是正确地重置自己。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-07-27T10:43:34.863

如果您想从 DataTable 生成 Excel，并通过邮件发送，您可以按如下方式附加 excel 文件：

```
Workbook theWorkbook = new Workbook();
theWorkbook.SetCurrentFormat(WorkbookFormat.Excel2007);
Worksheet theWorkSheet = theWorkbook.Worksheets.Add("Sheet1");

int iRow = 0;
int iColumn = 0;
theWorkSheet.Rows[0].CellFormat.Font.Bold = ExcelDefaultableBoolean.True;

//Titles
foreach (DataColumn column in DataTable.Columns)
{
    theWorkSheet.Rows[iRow].Cells[iColumn].Value = column.ColumnName;
    iColumn++;
}

//Values
foreach (DataRow row in DataTable.Rows)
{
    iColumn = 0;
    iRow++;

    foreach (var item in row.ItemArray)
    {
        theWorkSheet.Rows[iRow].Cells[iColumn].Value = item.ToString();
        iColumn++;
    }                    
}
System.IO.MemoryStream theStream = new System.IO.MemoryStream();
theWorkbook.Save(theStream);
byte[] byteArr = theStream.ToArray();
System.IO.MemoryStream stream1 = new System.IO.MemoryStream(byteArr, true);
stream1.Write(byteArr, 0, byteArr.Length);
stream1.Position = 0;
message.Attachments.Add(new Attachment(stream1, "filename.xlsx")); 
```

它至少对我有用 .NET 框架 4 和 Excel 2016。

问候。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-10T17:40:16.863

我找到了一个解决方案：

```
...
var attachment = CreateAttachment(WriteFileToMemory(Common.TempPath + excelName), excelName);
attachmentCollection.Add(attachment);
...

private Stream WriteFileToMemory(string filePath)
{
    var fileStream = new FileStream(filePath, FileMode.Open, FileAccess.Read);
    _openedStreams.Add(fileStream);
    return fileStream;
}

public static Attachment CreateAttachment(Stream attachmentFile, string displayName)
{
    var attachment = new Attachment(attachmentFile, displayName);
    attachment.ContentType = new ContentType("application/vnd.ms-excel");
    attachment.TransferEncoding = TransferEncoding.Base64;
    attachment.NameEncoding = Encoding.UTF8;
    string encodedAttachmentName = Convert.ToBase64String(Encoding.UTF8.GetBytes(displayName));
    encodedAttachmentName = SplitEncodedAttachmentName(encodedAttachmentName);
    attachment.Name = encodedAttachmentName;
    return attachment;
}

private static string SplitEncodedAttachmentName(string encoded)
{
    const string encodingtoken = "=?UTF-8?B?";
    const string softbreak = "?=";
    const int maxChunkLength = 30;
    int splitLength = maxChunkLength - encodingtoken.Length - (softbreak.Length * 2);
    IEnumerable<string> parts = SplitByLength(encoded, splitLength);
    string encodedAttachmentName = encodingtoken;
    foreach (var part in parts)
    {
        encodedAttachmentName += part + softbreak + encodingtoken;
    }
    encodedAttachmentName = encodedAttachmentName.Remove(encodedAttachmentName.Length - encodingtoken.Length, encodingtoken.Length);
    return encodedAttachmentName;
}

private static IEnumerable<string> SplitByLength(string stringToSplit, int length)
{
    while (stringToSplit.Length > length)
    {
        yield return stringToSplit.Substring(0, length);
        stringToSplit = stringToSplit.Substring(length);
    }
    if (stringToSplit.Length > 0)
    {
        yield return stringToSplit;
    }
} 
```

**基于此来源：** [http ://social.msdn.microsoft.com/Forums/en-US/dotnetframeworkde/thread/b6c764f7-4697-4394-b45f-128a24306d55](http://social.msdn.microsoft.com/Forums/en-US/dotnetframeworkde/thread/b6c764f7-4697-4394-b45f-128a24306d55)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-09T19:32:28.230

包含非 ASCII 字符且长度超过 41 个 UTF-8 编码字节的电子邮件附件名称在传输之前在为 .NET Framework 4 编译的应用程序中被编码两次。出现此问题的原因是 . NET Framework 4。重写了 SMTP 编码，以包括根据 RFC 标准的行长限制正确折叠。当名称字符串太长时，此行为会插入额外的回车换行符 (CRLF) 字符。这些额外的控制字符会导致附件名称再次被编码。更多您可以在这里找到[http://support.microsoft.com/kb/2402064](http://support.microsoft.com/kb/2402064)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-12T19:15:01.440

我通过更正 MailMessage 属性解决了同样的问题：

```
bool SendEmail(string subject, string message, Attachment attachment)
{
    try
    {
        SmtpClient smtpClient = CreateProductionSMTPClient();
        MailMessage msg = new MailMessage();
        msg.Subject = subject;
        msg.Body = message;
        msg.To.Add(ConfigurationHelper.EmailTo);
        msg.From = new MailAddress(ConfigurationHelper.EmailFrom);
        msg.BodyEncoding = Encoding.UTF8;

        //commented line cause the problem
        // msg.Headers.Add("Content-Type", "text/html");
        //instead of that use next line
        msg.IsBodyHtml = true;

        if (attachment != null)
        {
            msg.Attachments.Add(attachment);
        }

        smtpClient.Send(msg);
        return true;
    }
    catch (Exception ex)
    {
        return false;
    }
}

//Attachment building
Attachment WrapExcelBytesInAttachment(byte[] excelContent)
{
    try
    {
        Stream stream = new MemoryStream(excelContent);
        Attachment attachment = new Attachment(stream, "fileName.xls");
        attachment.ContentType = new ContentType("application/vnd.ms-excel");
        return attachment;
    }
    catch (Exception ex)
    {
        return null;
    }
} 
```

# android - 在Android中将日期和时间转换为毫秒

> ID：13223203
> 
> 赞同：29
> 
> 时间：2012-11-04T21:39:49.463
> 
> 标签：android, datepicker, datetimepicker, timepicker

我有来自和的**日期**和**时间**。现在我想将选定的日期和时间更改为**毫秒**。我怎样才能做到这一点？？？**`DatePicker`****`TimePicker`**

 **例如，我选择了**日期****`2-5-2012`**，**时间**是**`20:43`**

现在我必须将此日期时间转换为**毫秒**，例如

**DateTimeInMilliseconds** =**`1234567890`**

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-11-04T21:45:41.910

您可以使用 DatePicker 和 TimePicker 中的值创建一个 Calendar 对象：

```
Calendar calendar = Calendar.getInstance();
calendar.set(datePicker.getYear(), datePicker.getMonth(), datePicker.getDayOfMonth(), 
             timePicker.getCurrentHour(), timePicker.getCurrentMinute(), 0);
long startTime = calendar.getTimeInMillis(); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-11-04T21:42:33.220

将两个字符串合并在一起，并使用[`SimpleDateFormat`](http://developer.android.com/reference/java/text/SimpleDateFormat.html).

像这样的东西：

```
String toParse = myDate + " " + myTime; // Results in "2-5-2012 20:43"
SimpleDateFormat formatter = new SimpleDateFormat("d-M-yyyy hh:mm"); // I assume d-M, you may refer to M-d for month-day instead.
Date date = formatter.parse(toParse); // You will need try/catch around this
long millis = date.getTime(); 
```

IDEOne 上的示例：http: [//ideone.com/nOJYQ4](http://ideone.com/nOJYQ4)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-12-11T16:28:32.577

您可以使用此代码

```
String string_date = "12-December-2012";

SimpleDateFormat f = new SimpleDateFormat("dd-MMM-yyyy");
Date d = f.parse(string_date);
long milliseconds = d.getTime(); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-11-04T21:46:01.487

该类的`getTime()`方法`Date`返回一个`long`以毫秒为单位的时间。

[http://developer.android.com/reference/java/util/Date.html](http://developer.android.com/reference/java/util/Date.html)

因此，如果您在某处有一个 Date 对象，例如：

```
Date date; 
```

你可以做：

```
System.out.println(date.getTime()); 
```

它会以毫秒为单位打印出时间。**

# playn - PlayN - ArrayBufferView 大小不是一个足够小的正整数

> ID：13223210
> 
> 赞同：0
> 
> 时间：2012-11-04T21:40:14.227
> 
> 标签：playn

我有一个非常简单的井字游戏，它使用 PlayN 和 Tomcat，在 Java 中运行良好。但是，Chrome 上的 html 版本不断得到：

[致命] 未捕获的 JavaScript 异常 [未捕获的 RangeError：ArrayBufferView 大小不是足够小的正整数。]

一旦服务器在套接字上写入一些东西。

在 Firefox 上，例外情况是：

[致命] 在...中未捕获的 JavaScript 异常 [错误：无效参数]

缓冲区如何“不够小”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T16:47:17.457

以下是对该错误的可能解释：

[http://code.google.com/p/chromium/issues/detail?id=129854](http://code.google.com/p/chromium/issues/detail?id=129854)

这听起来像一个[类型化的数组](https://developer.mozilla.org/en-US/docs/JavaScript_typed_arrays)被错误地初始化。通常，当我遇到这样的问题时，这是 Google Web Toolkit 以错误或意外的方式编译的东西。

在您的 Java 代码中跟踪该数组并尝试给它一个不同的参数，或者更改您正在使用的数据类型。

希望有帮助。

# apache - mvc上的php 404状态处理

> ID：13223212
> 
> 赞同：-2
> 
> 时间：2012-11-04T21:40:37.840
> 
> 标签：apache, .htaccess, http-headers, php

> **可能重复：**
> [PHP 中的“警告：标头已发送”](https://stackoverflow.com/questions/8028957/warning-headers-already-sent-in-php)

您好，对于不在我网站中的页面，我无法获得 404 状态代码。我的 .htaccess 看起来像这样：

> 重写引擎开启
> 
> RewriteCond %{REQUEST_FILENAME} !-d RewriteCond %{REQUEST_FILENAME} !-f RewriteCond %{REQUEST_FILENAME} !-l
> 
> RewriteRule ^(.+)$ index.php?url=$1 [QSA,L]

因此，我所有的页面都从那里转到 index.php，它们转到引导程序，然后将其发送到错误控制器。在错误视图中进行：

> header("HTTP/1.1 404 未找到");

但它给了我一个错误“无法修改标头信息 - 标头已发送”。现在，如果我删除此行，我会得到 200 Ok 状态。我认为这是因为我将所有内容都发送到 index.php 并且该状态为 200 Ok。那么如何从 .htaccess 中改变这些文件呢？或者你有其他方法来解决这个问题吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:52:41.227

可能您在错误的位置发送 HTTP 标头。

如果您使用的是 MVC PHP 框架，则需要阅读框架的文档以完全理解调度、路由和请求处理过程。答案取决于框架。必须有关于处理请求和发送标头的信息。

如果没有，那么 index.php 和引导文件是你自己的，你需要尝试在引导文件或控制器级别（错误控制器？）中发送 404 标头，而不是在视图文件中。视图层是在 MVC 结构中发送标头的不好地方。

另外不要忘记在发送标头之前确保您没有向客户端发送任何输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T00:46:50.120

除了 foozy 的回答之外，请检查您的 PHP 代码在开始`<?php`标记之前是否有任何空格（空格、制表符、换行符等）。如果您发现任何内容，请将其删除。

如果有任何空格，这将导致“无法修改标头信息”错误。

Another useful way to debug this is to put an `exit('stopped');` right before `header("HTTP/1.1 404 Not Found");`. When you refresh the page and view the source, ideally you should see `stopped` as the very first thing printed (with NO spacing in front). If spacing exists, there's the problem.

# javascript - 询问远程 iframe

> ID：13223216
> 
> 赞同：0
> 
> 时间：2012-11-04T21:40:40.647
> 
> 标签：javascript, iframe

我在网站上使用 LinkedIn 按钮，这些按钮是通过 iframe 引入的。内容是特定于访问者的，例如“关注”按钮会根据访问者是否已经关注公司而显示“关注我们”或“已关注”。

几个月来，LinkedIn 一直在为这些按钮抛出随机 403 错误，我一直在尝试找到一种在失败时优雅降级的方法。

由于域安全，我似乎无能为力。在将页面发送到浏览器之前，我无法进行服务器端测试，因为请求需要来自用户。我不能进行 ajax 调用来获取内容，然后自己渲染它，因为它是跨域的。我看不出 iframe 的内容是否是错误的，因为它是跨域的。

Linkedin 本身也没有很好的降级——他们只是用他们的大标志提出了他们的“LinkedIn 存在间歇性问题”，其中只有一部分出现在 iframe 按钮将占据的空间中。它只是看起来很乱。

我想抑制 iframe，直到我知道它是正确的，或者如果它不包含我想要的内容（显示：无），则将其删除，但我看不到解决域问题的方法。

有任何想法吗？

# sql - 想要创建一个分布式文件系统？

> ID：13223217
> 
> 赞同：-1
> 
> 时间：2012-11-04T21:40:41.237
> 
> 标签：sql, distributed-system, filetable

在我工作的地方，大约有 400 名员工分布在两个主要校区的几个校区之间，我们设置了服务器并在服务器上共享文件夹。我想设置一个系统，因此我们有一个用户可以看到的共享文件夹，然后在两台服务器上都有所有文件的副本，并根据用户所在的校园访问文件，以阻止人们在文件传输时等待，然后只有如果文件被更改，则强制他们必须访问该文件的最新副本，然后在夜间传输所有更改的文件，这样就不会在白天降低网络速度。

谁能告诉我是否有一个系统已经这样做了？或者在尝试搜索执行此操作的系统时应该使用哪些关键字？

我一直在考虑使用 MS SQL Server 2012 FileTables 创建一个系统来执行此操作，并在表上放置触发器以检查哪个表具有文件的最新副本，并创建一个存储过程以在一夜之间压缩和传输更改的文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T21:56:08.623

为此有多个分布式文件系统。

AFS（Andrew FileSystem）可能很有趣： [http ://www.openafs.org/](http://www.openafs.org/)

其他一些解决方案是：

对于 Linux

*   FedFS，目前仅使用 NFS的[联合文件系统](http://wiki.linux-nfs.org/wiki/index.php/FedFsUtilsProject)
*   桑巴舞的 DFS

窗口

*   DFS = 分布式文件系统，在 Wikipedia 上搜索它（我不允许在这里发布 >2 个链接，因为我是新用户）

我个人对这些解决方案没有太多经验。但是，我建议您先研究 AFS，它是一个维护良好的跨平台系统。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T21:48:15.077

[分布式文件系统](http://technet.microsoft.com/en-en/library/cc787066%28v=ws.10%29.aspx)呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T22:05:58.653

假设您在整个公司都使用 Windows，BranchCache 可能会引起您的兴趣。注意：这要求您的用户至少使用 Windows 7。

[http://technet.microsoft.com/en-us/library/hh831696.aspx](http://technet.microsoft.com/en-us/library/hh831696.aspx)

这允许您在中央服务器上托管文件，缓存副本保存在每个分支机构的本地服务器或本地计算机上（即，如果您的分支机构没有服务器机房/不想在缓存服务器上额外投资） . 如果该选项可用，我建议在每个办公室都有一个缓存服务器，因为这将提高文件可用性的可靠性（即不受用户重新启动或关闭其工作站的影响）。

我不认为有任何预缓存 OOTB（尽管不是 100% 肯定），但这可以通过脚本轻松启用（即在每个分支都有一个脚本来请求任何新文件，从而导致它们被缓存）。

# php - jQuery变量中的PHP？

> ID：13223221
> 
> 赞同：0
> 
> 时间：2012-11-04T21:41:11.130
> 
> 标签：php, javascript, jquery

这样的事情可能吗？

```
var name = "<?php username_exists( $('input#register_name').val() ); ?>" 
```

在哪里

```
$('input#register_name').val() 
```

是jquery代码吗？所以基本上将这两个代码组合在一起，以便 PHP 函数使用该 JQuery 代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T21:44:25.230

并不真地。

1.  PHP 在服务器上运行。
2.  它输出一些文本。
3.  浏览器将该文本解释为 HTML/JavaScript

当您点击第 3 步时，PHP 已经完成。

如果你想将数据从 JS 传递到 PHP，你必须在一个新的 HTTP 请求中这样做（通过链接、表单提交、Ajax 等）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T21:43:55.607

不，简单的答案。服务器端代码不能直接对客户端代码进行操作。但是使用 AJAX，您可以将 jQuery 数据发送回 PHP

喜欢：

```
 var name = $('input#register_name').val();
 $.post('checkuser.php', { name: name }, function(data) {
      alert("Hey");
 }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T21:44:31.807

快速回答：没有。您可以使用 ajax 向 PHP 发送输入值并解析响应:)。

针对您的上述评论：

```
$('#my_input').blur(function() { // Change 'my_input' to ID of your input
    if ($(this).val() != '') { // Make sure it isn't blank to avoid unnecessary requests
        $.post('my_file.php', $(this).serialize(), function(response) {
            alert(response); // Variable 'response' contains response form php script
        });
    }
}); 
```

# php - mysql查询获取表1中的所有字段并从表2中获取部分字段

> ID：13223223
> 
> 赞同：1
> 
> 时间：2012-11-04T21:41:14.050
> 
> 标签：php, mysql, sql

回到我非常古老的 mysql 技能，我需要以下查询。

我有两张桌子

一个是名为 products 的所有项目的表格，其中包含项目名称、项目编号

二是带有cols item num, date的购买项目表

结果我需要的是这样的

```
ITEM-----PURCHASED
item1-------0 
item2-------0
item3-------0
item4-------1  This item purchased
item5-------0
item6-------1  This item purchased
item7-------0
item8-------0
.
.
.
itemX-------0 
```

输出包含所有项目，如果项目存在于购买的项目表中，则在购买的列中为 1，如果尚未购买，则为 0。

很抱歉，如果这很容易，我的大脑目前处于崩溃模式，我需要这样的东西已经很长时间了

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T21:45:44.110

使用 a`LEFT JOIN`和 a在连接表中`CASE`进行测试`NULL`，您可以相应地返回零或 1（我使用过`CASE`，但您也可以`IFNULL()`在 MySQL 中这样做）：

```
SELECT
  products.name, 
  products.item_num
  /* items that have no related rows in `purchased` will be NULL */
  CASE WHEN purchased.item_num IS NULL then 0 ELSE 1 END AS purchased
  /* Could also just do:
       (purchesd.item_num IS NULL) AS purchased
     because MySQL will return a 0 or 1 from the boolean condition, 
     but the CASE is more portable */
FROM 
  products
  LEFT JOIN purchased ON products.item_num = purchased.item_num 
```

# iphone - 从另一个类函数调用一个类函数

> ID：13223224
> 
> 赞同：0
> 
> 时间：2012-11-04T21:41:30.163
> 
> 标签：iphone, xcode, class, function, methods

我正在制作我的第一个 iPhone 应用程序，并尝试从另一个类函数访问一个类函数。为什么这不起作用？

基本上我有两个类，“DateViewController”和“inputMilesViewController”。在“DateViewController”中，我从日期指针中获取日期并将其转换为字符串，我想将其发送到“inputMilesViewController”中的函数，该函数将更改该场景中按钮上的标签以显示传入的字符串.

在 DateViewController.m 我输入了 #import "inputMilesViewController.h" 我试过做

```
[inputMilesViewController changeButtonText:msg]; 
```

*我无法通过错误消息“选择器'changeButtonText：'没有已知的类方法：'

inputMilesViewController.m 具有以下...

```
-(void) changeButtonText:(NSString*) dateStringForInput{

 NSLog(@"we got to changebuttontext");
  //[_myTodayButton setTitle:dateStringForInput forState:UIControlStateNormal];
} 
```

现在我不太关心实际更改文本，我只是想让它打印这个 NSLog，这样我就知道我可以进入这个函数了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T21:57:07.947

> ```
>  [inputMilesViewController changeButtonText:msg]; 
> ```
> 
> *我无法通过错误消息“选择器'changeButtonText：'没有已知的类方法：'

您将消息发送到类而不是该类的实例。这就解释了这个问题。

解决这个问题的方法是让一个控制器知道另一个控制器，以便您可以将消息发送到控制器的已知实例。这可以通过一种称为“依赖注入”的技术来完成，简单来说，这意味着您将对您的`inputMilesViewController`实例的引用“注入”到另一个控制器中，以便后者可以向前者发送消息。

例如，您可以将指向您的`inputMilesViewController`实例的指针传递给`DateViewController`的初始化方法。

```
@interface DateViewController
...
@property (nonatomic, retain/strong) inputMilesViewController* inputMilesController;
...
- (id)initWithInputMilesViewController:(inputMilesViewController*)controller;
...
@end

@implementation DateViewController
...
   [self.inputMilesController changeButtonText:msg];
...
@end 
```

或者您可以简单地定义一个属性`DateViewController`并在正确的时间（即在调用之前`dateStringForInput`）设置它的值。

在 Objective-C 中处理依赖注入的一个好方法是通过“委托”或“数据源”的概念。（我希望这一切对你来说听起来很熟悉，这样你就可以找到一个好的设计方法）。

另一种方法是使用通知中心，因此不是直接向 发送消息`inputMilesViewController`，而是通过通知中心发送消息。该解决方案确保了两个类之间的较低耦合。在[这篇文章](https://stackoverflow.com/questions/2191594/how-to-send-and-receive-message-through-nsnotificationcenter-in-objective-c)中，您可以找到如何实现它的描述。

编辑：

调用类方法（`+`而不是`-`）不是解决方案，因为您想真正访问类实例，而不是类本身。类方法很好，例如，当您拥有类的**所有实例**共享的静态数据时。在这种情况下，您有一个控制器，它被实例化以备份屏幕上的某些视图；该视图中有一些按钮，您想更改其文本。这都是在实例级别固有地定义的。查看这篇文章，了解[类和实例方法之间的区别](https://stackoverflow.com/questions/1053592/objective-c-class-vs-instance-methods)。

我的建议是让您找出我上面描述的方法之一来正确解决两个控制器之间的通信。这是一个如此普遍的问题，您将不得不在您的编程项目中一遍又一遍地解决它。如果您拿起一个并想了解更多详细信息，请索取。

# drupal - 在模块中拥有自己的主题

> ID：13223229
> 
> 赞同：3
> 
> 时间：2012-11-04T21:41:59.890
> 
> 标签：drupal, drupal-7, drupal-modules, drupal-theming

我正在为 drupal 7 编写模块。模块在该块 ['content'] 内生成块和项目列表。当我使用标准主题（'item_list', array('items' => $items)) 一切正常，但是当我想定义我自己的主题来代替 item_list 时，阻止消失。我一直在阅读文档和各种示例，但没有任何帮助。在我的模块文件中，我写道：

```
function lastposts_thm_theme() {
  return array(
   'lastposts_thm' => array(
   'variables' => array('items' => NULL),
   //template file, path, ....
   ),
 );
}
function theme_lastposts_thm($variables) {
  $node = $variables['items'];
  $build = node_view($node);
  $output = drupal_render($build);

  return $output;
} 
```

当我从 block_view 函数调用它时，它不起作用主题（'lastposts_thm'，$...）。我在哪里弄错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T04:41:07.233

检查您的主题是否打印块的变量并在主题的信息字段中定义区域。这可能是您面临的问题。.

# c# - 将列表中的连续重复模式减少为单次出现

> ID：13223230
> 
> 赞同：-4
> 
> 时间：2012-11-04T21:42:06.707
> 
> 标签：c#, algorithm, pattern-matching

请为以下问题提出方法或算法参考。

要求：

*   图案必须是连续的。
*   如果在第一组减少之后可以做更多的事情，那么他们应该进一步应用
*   请不要建议正则表达式解决方案，因为在我的情况下，我必须减少一些列表
*   结果列表必须是最短的
*   对于相同的输入，它必须始终产生相同的归约

前任：

1.  ABBABBB (B in BB and Bin BBB 匹配归约模式) => ABAB (AB 匹配归约模式) => AB
2.  ABCDBCDA（BCD 匹配缩减模式）=> ABCDA
3.  ABC => ABC
4.  ABBA => ABA
5.  ABCBCBCBC（模式可以是BC或BCBC，选择最短的一个：BC）=> ABC
6.  ABCDBC => ABCDBC

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T22:48:16.063

```
class Program
{
    static List<T> removePatterns<T>(List<T> list)
    {
        List<T> cleaned = new List<T>();
        List<T> pattern = new List<T>();

        for (int i = 0; i < list.Count; i++)
        {
            cleaned.Add(list[i]);
            pattern.Add(list[i]);
            // check if a pattern can be found ahead, increase pattern size slowly until something can be found
            int patternSize = -1;
            for (patternSize = 1; patternSize < pattern.Count + 1; patternSize++)
            {
                List<T> currentPattern = pattern.Skip(pattern.Count - patternSize).ToList();
                Boolean matches = true;
                for (int o = 0; o < currentPattern.Count() && matches; o++)
                    matches = i + 1 + o < list.Count && list[i + 1 + o].Equals(currentPattern[o]);
                if (matches)
                {
                    pattern = new List<T>();
                    i += currentPattern.Count;
                    break;
                }
            }
        }
        if (cleaned.Count != list.Count)
            return removePatterns(cleaned);
        return cleaned;
    }

    static void test(String list, String expected)
    {
        String result = String.Join("", removePatterns<String>(list.Select(c => c.ToString()).ToList()).ToArray());
        Console.WriteLine(list + " => " + result + " = " + expected);
        Console.WriteLine(result.Equals(expected) ? "Passed" : "Failed");
    }

    static void Main(string[] args)
    {
        test("ABBABBB", "AB");
        test("ABCDBCDA", "ABCDA");
        test("ABC", "ABC");
        test("ABBA", "ABA");
        test("ABCBCBCBC", "ABC");
        test("ABCDBC", "ABCDBC");

        Console.ReadKey();
    }
} 
```

这是我从头开始编造的。对于测试用例，它按预期工作。但它可能包含错误。

# java - 如何在一个 int 数组中找到两个不同的值？

> ID：13223235
> 
> 赞同：1
> 
> 时间：2012-11-04T21:42:31.387
> 
> 标签：java, arrays

如果我有多组数组，并且我想查看任何数组中是否包含两个值，我将如何去做。

这是我之前尝试过的：

```
public boolean multiIdTasks(int[] arrayToTest, int slayerTask, int npcKilled){
    for(int j = 0; j < arrayToTest.length; j++){
        if(arrayToTest[j] == slayerTask){
            if(confirmSlayerKill(arrayToTest, arrayToTest[j])){
                return true;
            } else {
                continue;
            }
        }
    }
    return false;
}

public boolean confirmSlayerKill(int[] arrayToTest, int npcKilled){
    for(int g = 0; g < arrayToTest.length; g++){
        if(arrayToTest[g] == npcKilled){
            return true;
        }
    }
    return false;
} 
```

我需要检查被杀死的 npc 是否包含在给定任务的数组中。例如，如果你的任务是一只鸟，而你杀死了一只鹰，我希望减少任务的计数，但我还没有找到一个好方法来检查任务的值和被杀死的 npc 的值。

调用它的方法在这里：

```
public boolean getValidKills(int slayerTask, int npcKilled){
    if( multiIdTasks(SlayerData.BANSHEES, slayerTask, npcKilled) || 
        multiIdTasks(SlayerData.BATS, slayerTask, npcKilled) ||  
        multiIdTasks(SlayerData.BIRDS, slayerTask, npcKilled) || 
        multiIdTasks(SlayerData.BEARS, slayerTask, npcKilled)  ||  
        multiIdTasks(SlayerData.CAVE_BUGS, slayerTask, npcKilled)  ||  
        multiIdTasks(SlayerData.CAVE_SLIMES, slayerTask, npcKilled)  ||  
        multiIdTasks(SlayerData.COWS, slayerTask, npcKilled)  ||  
        multiIdTasks(SlayerData.DESERT_LIZARDS, slayerTask, npcKilled)  ||  
        multiIdTasks(SlayerData.DOGS, slayerTask, npcKilled)  ||  
        multiIdTasks(SlayerData.DWARVES, slayerTask, npcKilled)  ||  
        multiIdTasks(SlayerData.GHOSTS, slayerTask, npcKilled)  ||  
        multiIdTasks(SlayerData.GOBLINS, slayerTask, npcKilled)  ||  
        multiIdTasks(SlayerData.ICEFIENDS, slayerTask, npcKilled)  ||  
        multiIdTasks(SlayerData.MINOTAURS, slayerTask, npcKilled)  ||  
        multiIdTasks(SlayerData.MONKEYS, slayerTask, npcKilled)  ||  
        multiIdTasks(SlayerData.SCORPIONS, slayerTask, npcKilled)  ||  
        multiIdTasks(SlayerData.SKELETONS, slayerTask, npcKilled)  ||  
        multiIdTasks(SlayerData.SPIDERS, slayerTask, npcKilled)  ||  
        multiIdTasks(SlayerData.TROLLS, slayerTask, npcKilled)  ||  
        multiIdTasks(SlayerData.WOLVES, slayerTask, npcKilled)  ||  
        multiIdTasks(SlayerData.ZOMBIES, slayerTask, npcKilled)) {
        return true;
    } else {
        return false;
    }
} 
```

如果`getValidKills`为真，则计数应减少。但是我不能让它正常工作，有人可以帮忙吗？如果您需要更多信息，请告诉我...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T23:30:41.513

```
 /**
 * Search for {@code value1} and {@code value2} in {@code array} array.
 * 
 * @param array given array to be searched.
 * @param value1 value to be searched.
 * @param value2 value to be searched.
 * @return true if found both values in the given array.
 */
private static boolean hasBothValues(int[] array, int value1, int value2) {
    int totalMatches = 0;
    for (int value : array) {
        if (value == value1 || value == value2)
            totalMatches++;
        if (totalMatches >= 2)
            return true;
    }
    return false;
} 
```

# dynamic - 在 Elixir 或 Erlang 中，如何在运行时动态创建和加载模块？

> ID：13223238
> 
> 赞同：39
> 
> 时间：2012-11-04T21:42:46.407
> 
> 标签：dynamic, module, erlang, elixir

基本场景是这样的：我需要从数据库中加载文本，然后将该文本转换为 Elixir 模块（或 Erlang 模块），然后对其进行调用。该文本实际上与模块文件相同。所以这是热代码加载的一种形式。我想编译“文件”，然后加载生成的模块，然后调用它。稍后我会卸载它。唯一的区别是代码存在于数据库中而不是磁盘上的文件中。（并且在我编写将加载它的代码时它不存在。）

我知道 Erlang 支持热代码加载，但似乎专注于在磁盘上编译文件然后加载梁。我希望将其作为一个更动态的过程来执行，并且我不会替换正在运行的代码，而是加载代码，然后运行它，然后卸载它。

Elixir 中有几个工具可以在运行时评估代码。我正在尝试弄清楚如何使用它们，并且文档有点稀疏。

```
Code.compile_string(string, "nofile") 
```

“返回一个元组列表，其中第一个元素是模块名称，第二个是它的二进制”。所以，现在我有了模块名称和它们的二进制文件，但我不知道如何将二进制文件加载到运行时并调用它们。我该怎么做？（我可以看到代码库中没有相应的功能。）

可能我可以使用 Erlang 函数：

```
:code.load_binary(Module, Filename, Binary)  ->
           {module, Module} | {error, What} 
```

好的，所以这会返回一个带有原子“模块”的元组，然后是模块。如果从数据库加载的字符串定义了一个名为“Paris”的模块，那么我将如何在我的代码中执行

```
paris.handler([parameters]) 
```

因为我事先不知道会有一个名为 paris 的模块？我可以知道，通过将字符串“paris”也存储在数据库中，这是名称，但是有没有办法调用模块，使用字符串作为您正在调用的模块的名称？

还有：

```
eval(string, binding // [], opts // []) 
```

它评估字符串的内容。这个字符串可以是模块的完整定义吗？看来不是。我希望能够编写这个正在评估的代码，它具有多个相互调用的函数 - 例如一个完整的小程序，具有预定义的入口点（这可能是一个主要的，比如作为“DynamicModule.handle（[参数，列表]）”

然后是 EEx 模块，它有：

```
compile_string(source, options // []) 
```

这对于制作模板非常有用。但最终它似乎只适用于存在字符串并且您已将 Elixir 代码嵌入其中的用例。它在选项的上下文中评估字符串并生成一个字符串。我正在寻求将字符串编译成一个或多个我可以调用的函数。（如果我只能制作一个很好的功能，那么该功能可以进行模式匹配或切换到做其他需要的事情......）

我知道这是非常规的，但我有这样做的理由，而且他们是好的。我正在寻找有关如何执行此操作的建议，但不需要被告知“不要那样做”。看起来应该是可能的，Erlang 支持热代码加载，并且 Elixir 非常动态，但我只是不知道语法或正确的功能。我会密切关注这个问题。提前致谢！

* * *

**基于第一个答案的编辑：**

感谢您的回答，这是一个很好的进展。正如 Yuri 所展示的， eval 可以定义一个模块，并且正如 José 指出的那样，我可以将代码 eval 用于带有绑定的一小部分代码。

正在评估的代码（无论是否转换为模块）将相当复杂。它的开发最好涉及将其分解为函数并调用这些函数。

为了提供帮助，让我提供一些背景信息。假设我正在构建一个 Web 框架。从数据库加载的代码是特定 URI 的处理程序。所以，当一个 HTTP 调用进来时，我可能会加载 example.com/blog/ 的代码。这个页面可能涉及几个不同的东西，比如评论、最近的帖子列表等。

由于很多人同时点击该页面，我正在生成一个进程来处理每个页面视图。因此，对于不同的请求，可以多次同时评估此代码。

模块解决方案允许将代码分解为页面不同部分的函数（例如：帖子列表、评论等），并且我会在启动时加载模块一次，并让许多进程产生该调用进去。该模块是全局的，对吗？

如果已经定义了一个模块会发生什么？EG：当模块发生变化时，已经有进程调用了该模块。

在 iex 中，我可以重新定义已经定义的模块：

```
iex(20)> Code.eval "defmodule A do\ndef a do\n5\nend\nend"
nofile:1: redefining module A 
```

如果我在运行时将模块重新定义到当前调用该模块的所有进程，会发生什么？此外，这种重新定义是否会在 iex 之外正常运行？

假设重新定义模块会有问题，并且全局模块可能会遇到命名空间冲突的问题，我研究了使用 eval 来定义函数。

如果我只能让数据库中的代码定义函数，那么这些函数在任何进程的范围内，并且我们没有全局冲突的可能性。

但是，这似乎不起作用：

```
iex(31)> q = "f = function do
...(31)> x, y when x > 0 -> x+y
...(31)> x, y -> x* y
...(31)> end"
"f = function do\nx, y when x > 0 -> x+y\nx, y -> x* y\nend"
iex(32)> Code.eval q
{#Fun<erl_eval.12.82930912>,[f: #Fun<erl_eval.12.82930912>]}
iex(33)> f
** (UndefinedFunctionError) undefined function: IEx.Helpers.f/0
    IEx.Helpers.f()
    erl_eval.erl:572: :erl_eval.do_apply/6
    src/elixir.erl:110: :elixir.eval_forms/3
    /Users/jose/Work/github/elixir/lib/iex/lib/iex/loop.ex:18: IEx.Loop.do_loop/1

iex(33)> f.(1,3)
** (UndefinedFunctionError) undefined function: IEx.Helpers.f/0
    IEx.Helpers.f()
    erl_eval.erl:572: :erl_eval.do_apply/6
    erl_eval.erl:355: :erl_eval.expr/5
    src/elixir.erl:110: :elixir.eval_forms/3
    /Users/jose/Work/github/elixir/lib/iex/lib/iex/loop.ex:18: IEx.Loop.do_loop/1 
```

我也试过：

```
 iex(17)> y = Code.eval "fn(a,b) -> a + b end"
{#Fun<erl_eval.12.82930912>,[]}
iex(18)> y.(1,2)
** (BadFunctionError) bad function: {#Fun<erl_eval.12.82930912>,[]}
    erl_eval.erl:559: :erl_eval.do_apply/5
    src/elixir.erl:110: :elixir.eval_forms/3
    /Users/jose/Work/github/elixir/lib/iex/lib/iex/loop.ex:18: IEx.Loop.do_loop/1 
```

所以，总结一下：

1.  当有进程调用模块时，可以使用 Code.eval 重新定义模块吗？

2.  是否可以使用 Code.eval 来制作范围绑定到调用 Code.eval 的进程的函数？

3.  如果你明白我想要做什么，你能建议一个更好的方法吗？

另外，如果有更好的论坛我应该问这个问题，请随时告诉我。如果有我应该阅读的文档或相关示例，请随时向我指出。我不是想让你做所有的工作，我只是自己无法弄清楚。

我正在学习 Elixir 专门用于动态评估代码的能力，但我的 Elixir 知识现在很少——我刚刚开始——而且我的 erlang 也生疏了。

非常感谢！

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-11-05T18:11:57.117

正如您所描述的，您可以采用许多不同的方法，最终它们归结为两个不同的类别：1）代码编译和 2）代码评估。您上面描述的示例需要编译，它将定义一个模块，然后您必须调用它。但是，正如您所发现的，它需要定义模块名称，并在数据库更改时可能会清除和丢弃这些模块。另外，请注意，定义模块可能会耗尽原子表，因为为每个模块创建一个原子。如果您需要编译最多十几个模块，我只会使用这种方法。

（一个小说明，`Code.compile_string`已经定义了模块，所以你不需要调用`load_binary`）。

也许更简单的方法是调用`Code.eval`从数据库中传递代码，从而进行代码评估。如果您只想评估一些自定义规则，它可以正常工作。接受一个绑定，这`Code.eval`将允许您将参数传递给代码。假设您在数据库中存储了“a + b”，参数在哪里`a`和`b`是，您可以将其评估为：

```
Code.eval "a + b", [a: 1, b: 1] 
```

**根据问题的编辑进行编辑**

如果您正在评估代码，请记住`Code.eval`返回评估代码和新绑定的结果，因此您上面的示例最好写成：

```
q = "f = function do
x, y when x > 0 -> x+y
x, y -> x* y
end"

{ _, binding } = Code.eval q
binding[:f].(1, 2) 
```

但是，鉴于您的用例，我不会考虑使用 eval 但我确实会编译一个模块。由于信息来自数据库，您可以使用此事实为您生成每条记录的唯一模块。例如，您可以假设开发人员会将模块的内容添加到数据库中，例如：

```
def foo, do: 1
def bar, do: 1 
```

从数据库中获取此信息后，您可以使用以下命令对其进行编译：

```
record   = get_record_from_database
id       = record.id
contents = Code.string_to_quoted!(record.body)
module   = Module.concat(FromDB, "Data#{record.id}")
Module.create module, contents, Macro.Env.location(__ENV__)
module 
```

其中记录是您从数据库中返回的任何内容。假设记录 id 是`1`，它将定义一个模块`FromDB.Data1`，然后您就可以调用`foo`and `bar`。

关于代码重新加载，两者都`defmodule`用于`Module.create`加载`:code.load_binary`模块。这意味着如果您更新模块，旧版本仍然会保留，直到加载另一个新版本。

您还应该添加的一件事是缓存过期，因此您不需要针对每个请求编译模块。如果您在每次更改记录内容时递增的数据库中有一个 lock_version，则可以做到这一点。最终代码将类似于：

```
record  = get_record_from_database
module  = Module.concat(FromDB, "Data#{record.id}")
compile = :code.is_loaded(module) == false or
            record.lock_version > module.lock_version

if compile do
  id       = record.id
  contents = Code.string_to_quoted!(record.body)
  contents = quote do
    def lock_version, do: unquote(record.lock_version)
    unquote(contents)
  end
  Module.create module, contents, Macro.Env.location(__ENV__)
end

module 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-11-04T22:14:04.423

Code.eval 可用于定义模块：

```
iex(1)> Code.eval "defmodule A do\ndef a do\n1\nend\nend" 
{{:module,A,<<70,79,82,49,0,0,2,168,66,69,65,77,65,116,111,109,0,0,0,98,0,0,0,11,8,69,108,105,120,105,114,45,65,8,95,95,105,110,102,111,95,95,4,100,111,99,115,9,102,117,...>>,{:a,0}},[]}
iex(2)> A.a
1 
```

这有帮助吗？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-05T09:21:57.683

你检查过吗：[`Dynamic Compile Library by Jacob Vorreuter`](https://github.com/jkvor/dynamic_compile)。请参阅下面的示例

```
1> String = "-module(add).\n -export([add/2]). \n add(A,B) -> A + B. \n".
"-module(add).\n -export([add/2]).\n add(A,B) -> A + B.\n"
2> 动态编译：加载从字符串（字符串）。
{模块，添加}
3> 添加：添加（2,5）。
7
4>

```

另外，请查看此[问题](https://stackoverflow.com/q/7917108/431620)及其[答案](https://stackoverflow.com/a/7927649/431620)

# xml - Oracle 能否在本地文件系统上使用 XSD 模式验证 XML？

> ID：13223246
> 
> 赞同：8
> 
> 时间：2012-11-04T21:43:48.967
> 
> 标签：xml, oracle, plsql, xml-parsing, xsd

我想问一个关于针对相应 XML 模式进行 XML 文档验证的问题，如果您能帮帮我，我将不胜感激。实际上，我刚刚开始学习 XML 模式（我完全是个初学者）。我购买了 Priscilla Walmsley（第 2 版）编写的“Definitive XML Schema”一书，其中介绍了 XML Schema 1.1（我相信它是最新版本）。

现在的问题是，在本书的所有示例和练习中，模式文件的名称空间和位置都是使用 Web URL 给出的。

这是本书的一个例子：

这是架构

```
<xs:schema  xmlns:xs="http://www.w3.org/2001/XMLSchema"
            targetNamespace="http://datypic.com/prod"
            xmlns:prod="http://datypic.com/prod">

    <xs:element name="product" type="prod:ProductType"/>
    <xs:complexType name="ProductType">
        <xs:sequence>
            <xs:element name="number" type="xs:integer"/>
            <xs:element name="size" type="prod:SizeType"/>
        </xs:sequence>
        <xs:attribute name="effDate" type="xs:date"/>
    </xs:complexType>
    <xs:simpleType name="SizeType">
        <xs:restriction base="xs:integer">
            <xs:minInclusive value="2"/>
            <xs:maxInclusive value="18"/>
        </xs:restriction>
    </xs:simpleType>
</xs:schema> 
```

而要针对上述验证的 XML 内容是这样的

```
<prod:product xmlns:prod="http://datypic.com/prod" 
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:schemaLocation="http://datypic.com/prod prod.xsd"
          effDate="2011-04-12">
    <number>557</number>
    <size>10</size>
</prod:product> 
```

显然，[http://datypic.com/prod] 是作者维护的站点，因此在阅读本书时，我无法在此站点上添加或删除任何文件以进行练习。因此，我需要将 XML 和 XSD 文档都放在本地硬盘上（我使用的是 Linux Fedora Core 17 X86_64）。所以我所做的就是将架构的内容放在一个名为“Example- **01.xsd** ”的文件中，并将 XML 内容放在一个名为“ **Example-01.xml** ”的文件中。

我使用 oracle PL/SQL 包 DBMS_XMLSCHEMA（企业版 11.2.0.1.0）首先注册架构，然后调用 XMLType 对象的 validate 方法，以便根据架构验证我的 XML 文档，类似于以下链接：

[https://forums.oracle.com/forums/thread.jspa?messageID=2462207](https://forums.oracle.com/forums/thread.jspa?messageID=2462207)

我在 oracle 中创建了一个目录（通过 CREATE DIRECTORY）语句：

/home/train/Documents/myutl_file_dir/

我把我的 XML 和 XSD 文档放在哪里。这正是我更改上述 XML 内容以便在本地引用 XSD 的方式

```
<prod:product xmlns:prod="http://datypic.com/prod" 
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:schemaLocation="http://datypic.com/prod file:///home/train/Documents/myutl_file_dir/Example-01.xsd"
               effDate="2011-04-12">
    <number>557</number>
    <size>10</size>
</prod:product> 
```

因此，如果您将新的 XML 内容与上述示例进行比较，我添加的唯一内容是**file:///home/train/Documents/myutl_file_dir/Example-01.xsd在****xsi:schemaLocation**的值末尾命令指的是本地硬盘。我在这里找到了这个方法：

[http://lists.w3.org/Archives/Public/xmlschema-dev/2001Dec/0161.html](http://lists.w3.org/Archives/Public/xmlschema-dev/2001Dec/0161.html)

现在，问题是它不起作用。当我运行脚本以通过调用 XMLType 对象的 schemaValidate() 方法来验证文档时，这里是 oracle 错误消息：

```
BEGIN
*
ERROR at line 1:
ORA-19030: Method invalid for non-schema based XML Documents.
ORA-06512: at "SYS.XMLTYPE", line 354
ORA-06512: at "TRAIN2012.ZXML_PKG", line 176
ORA-06512: at line 2 
```

我从错误消息“ **Method invalid for non-schema based XML Documents”**中了解到，oracle 只是忽略了我为模式文件定义的文件路径，它认为没有为此 XML 文档声明任何模式。

任何的想法？我该如何处理这个问题？

提前致谢，

达里约什

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-08T17:12:22.247

好的，经过大量谷歌搜索并感谢 stefan nebesnak 的评论，我发现了两个导致错误的问题：

第一个，正如 Stefan 所提到的，DBMS_XMLSCHEMA.registerSchema 只能应用于基于模式的文档。最初，我在 PL/SQL 代码中所做的事情是这样的：

```
l_xml_file_content := XMLType('Here I put the content of my XML document')
l_xml_file_content.schemaValidate(); 
```

如您所见，注册模式和引用我的 XML 文档的 XMLType 对象之间绝对没有链接。我必须做的是：

```
l_xml_file_content := 
   XMLType(
            'Here I put the content of my XML document'
          ).createSchemaBasedXML('and here I put the very same schema URL used during registereation while I registered the schema by calling the DBMS_XMLSCHEMA.registerSchema method') 
```

所以，第一个问题解决了，我的 XML 文档变成了基于模式的。

第二个问题是，在本书中，要针对模式进行验证的 XML 文档是按以下方式定义的：

```
<prod:product xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xmlns:prod="http://datypic.com/prod"
              xsi:schemaLocation="http://datypic.com/prod prod.xsd" 
              effDate="2011-04-12">

    <number>557</number>
    <size>10</size>
</prod:product> 
```

我从 ' **xsi:schemaLocation="http://datypic.com/prod prod.xsd"** ' 中了解到的是它的第一部分，即**http://datypic.com/prod**指的是 targetNameSpace 和第二部分由空格分隔，即**prod.xsd**，用于引用模式文档的位置（作为 URL），这是真的。但我不知道的是，在 oracle DBMS_XMLSCHEMA 实现中，这第二部分必须是用于通过调用 DBMS_XMLSCHEMA.RegisterSchema 方法注册模式的相同 URL，否则它将不起作用。这是确认这一点的 oracle 文档的链接：

[http://docs.oracle.com/cd/B19306_01/appdev.102/b14259/xdb03usg.htm#BABBGBDA](http://docs.oracle.com/cd/B19306_01/appdev.102/b14259/xdb03usg.htm#BABBGBDA)

> 如果目标 XML 模式声明了目标名称空间，则 schemaLocation 属性用于标识 XML 模式。该属性的值是一对用空格分隔的值：
> 
> *   XML 模式中声明的目标命名空间的值
> *   **模式位置提示，当模式注册到数据库时传递给过程 DBMS_XMLSCHEMA.registerSchema 的唯一标识符**

这正是我没有做的，我已经用' **http://datypic.com/prod** '注册了模式，只是因为在书中有一个文件名作为 xsi:schemaLocation 的第二部分（产品.xsd) 我认为我所要做的就是将架构内容放在一个名为 Example-01.xsd 的文件中，然后提供该文档的文件 URL，**file:///home/train/Documents/myutl_file_dir /Example-01.xsd**. Which was really a silly thing because, when you register a schema with oracle by calling the DBMS_XMLSchema.registerSchema, oracle registers the content of the XML schema document. So what oracle needs is the schemaURL used during registeration which allows to find and identify uniquely the specific schema. And this was exactly my mistake I had thought that oracle is looking for physical location of my file.

Conclusion: I had registered the schema by the targetNameSpace : 'http://datypic.com/prod' (well, it was just an example, I could have chosen other value)

So, the correct value of schemaLocation inside my XML document was this:

```
xsi:schemaLocation="http://datypic.com/prod prod.xsd 
                    http://datypic.com/prod prod.xsd" 
```

And this solved the problem.

I hope this can help those who have encountered the same problem.

Regards,

Dariyoosh

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:24:47.943

该方法只能在**基于模式的**xmltype 对象上调用。

在注册他们引用的 XML 模式之前，尝试删除并重新加载文档。

[Oracle XML DB 开发人员指南](http://docs.oracle.com/cd/B28359_01/appdev.111/b28369/xdb05sto.htm)：

> 注册 XML 模式时，请记住，注册模式的行为不会影响已加载到引用 XML 模式的 Oracle XML DB 存储库中的任何实例文档的状态。由于 XML 模式尚未注册，因此此类实例文档在加载时不是基于模式的。**在模式注册后，它们仍然是非基于模式的。**
> 
> 您必须删除此类实例文档，并在注册模式后重新加载它们，以获得基于模式的文档。

[Oracle XML 存储教程](http://www.exforsys.com/tutorials/oracle-11g/oracle-xml-storage.html#structured)。

您可以将架构放置在与引用它的 XML 相同的目录中。在这种情况下，您只需要像这样指定文件名：

```
 xsi:noNamespaceSchemaLocation="Example-01.xsd" 
```

（有效的相对 URI 引用）

# javascript - 通过 jQuery 用它的索引替换一个 html 元素

> ID：13223247
> 
> 赞同：1
> 
> 时间：2012-11-04T21:43:53.063
> 
> 标签：javascript, jquery, replace

我正在尝试替换`HTML element`我通过它的索引获得的，我正在尝试这个但它不起作用：

```
<div class="results">
    <div id="61">Result 1 content</div>
    <div id="8762">Result 2 content</div>
    <div id="234">Result 3 content</div>
</div>

<script>
    var index = 0;
    var html = '<div id="243">Result 1 content</div>';
    var element = $('.results').get(index);
    element.replaceWith(html);
</script> 
```

`HTML element`我怎样才能通过它来替换整个`index`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T21:46:42.660

```
$('.results div').eq(index).replaceWith(html); 
```

[**小提琴**](http://jsfiddle.net/Uy4pB/)

您应该使用[`.eq()`](http://api.jquery.com/eq/)它的索引来过滤 jQuery 对象内的匹配元素集。也`$('.results')`只有 1 个元素（本身）。我假设您正在寻找其中的`div`s 。

* * *

此外，如果您`div`的 s 中有`div`s，请使用更具体的[子选择器](http://api.jquery.com/child-selector/)：

```
$('.results > div').eq(index).replaceWith(html); 
```

这与使用带有选择器过滤器的[`.children`方法](http://api.jquery.com/children/)具有相同的效果：

```
$('.results').children(':eq(' + index + ')').replaceWith(html); 
```

或者更简单地说，将它们全部连接到一个选择器中：

```
$('.results > div:eq(' + index + ')').replaceWith(html); 
```

[**小提琴**](http://jsfiddle.net/Uy4pB/1/)

使用 jQuery 有许多其他方法可以完成这项工作，但这些应该绰绰有余。`=]`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T21:47:13.023

`.get`检索索引处的 DOM 元素。你正在寻找的是[`.eq`](http://api.jquery.com/eq/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T21:48:37.390

```
var index = 0
$($('.results div')[index]).replaceWith('<div id="243">Result 1 content</div>') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T21:49:56.267

```
var element = $('.results').find('div'); 
```

# php - 导入numpy时从php调用python失败

> ID：13223249
> 
> 赞同：0
> 
> 时间：2012-11-04T21:43:57.730
> 
> 标签：php, python, numpy

当从 Android 发出 GET HTTP 请求时，尝试从 php 调用 python (2.6) 脚本，但如果 import numpy 在我的脚本中，我会失败，如果我将其删除，则脚本/调用有效。我正在计算 MySQL 中数字字段的 FFT 谱，所以我需要 numpy（或者我需要吗？）。

我看过关于 SO 的类似问题， @dietrich-epp 回答的[这个](https://stackoverflow.com/questions/8704519/php-script-cant-get-output-from-python-script)问题是最好的问题，但是当我尝试相同的建议时，我的脚本仍然失败。

这是我的 python 脚本的导入部分：

```
import  os, os.path, sys
import numpy
import string
import math
import MySQLdb 
```

我的 PHP 文件的开头：

```
<?php
putenv('PYTHONPATH=/usr/lib/python2.6/site-packages:');
... 
```

这就是我调用python脚本的方式：

```
$command = "/var/www/html/tremcam/tst0.py localhost baseline@nd.edu 2>&1";
$pid = popen( $command,"r");
while( !feof( $pid ) )
{
 #echo fread($pid, 256);
 print(json_encode(fread($pid, 256)));
 flush();
 ob_flush();
 usleep(100000);
}
pclose($pid); 
```

我的环境变量将 PYTHONPATH 设置为：

```
/var/www/html/tremcam/pythons
/usr/lib/python2.6/site-packages
/usr/lib
/usr/lib/python26.zip
/usr/lib/python2.6
/usr/lib/python2.6/plat-linux2
/usr/lib/python2.6/lib-tk
/usr/lib/python2.6/lib-old
/usr/lib/python2.6/lib-dynload
/usr/lib/python2.6/site-packages/gtk-2.0
/usr/lib/python2.6/site-packages/setuptools-0.6c11-py2.6.egg-info
/usr/lib/python2.6/site-packages/setuptools-0.6c11-py2.6.egg-info 
```

这个 ( `PYTHONPATH=/usr/lib/python2.6/site-packages`) 应该指向`/usr/lib/python2.6/site-packages/numpy`吗？

我将尝试使用 passthru() 而不是我目前在 PHP 中使用它的方式。请注意，在我能够将 numpy 作为 np 导入后，代码将需要几秒钟才能完成，这也会是一个问题吗？

更新：如果我使用：`passthru('/var/www/html/tremcam/tst0.py localhost baseline@nd.edu 2>&1',$result);`

我得到退出状态码 139，所以这对我没有太大帮助，你觉得呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T08:40:30.187

尝试 `setsebool httpd_tmp_exec on` 是否有效，使其永久有效 `setsebool -P httpd_tmp_exec on`

应该是 SELinux 拒绝 Apache 您的 pytonpath 目录（是的，如果它仍然不起作用，您应该提供非常 numpy 的文件夹，但根本没有必要）。

稍微不那么干净的方法是`import ctypeslib`在`/<your numpy path>/numpy/__init__.py`

我遇到了同样的问题，两种方法都运行良好（虽然后者可能会导致以后的开发出现一些不一致，因此我建议你先尝试 setsebool）

# java - 如何从 YAML 文件加载 DATETIME 对象？

> ID：13223250
> 
> 赞同：5
> 
> 时间：2012-11-04T21:44:05.457
> 
> 标签：java, playframework-2.0, yaml, jodatime, playframework-2.1

我正在使用 JODA TIME 库来持久化 DATETIME。在我运行测试之前，我需要设置测试数据。所以我有一个 yaml 文件，我在其中定义了带有日期的测试数据，我希望这些数据可以转换为 DATETIME 对象，但事实并非如此。

我正在使用 Play Framework 2.0。知道如何将 YAML 日期转换为真正的 DATETIME 对象。

这是我的 yaml 文件的样子

```
users:
    - !!models.User
        createdOn:     2001-09-09T01:46:40Z
        fName:         Mike
        lName:         Roller 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-24T18:14:17.570

取自[snakeyaml 项目WIKI](https://bitbucket.org/asomov/snakeyaml/wiki/Howto#markdown-header-how-to-parse-jodatime)。例子在[这里](https://bitbucket.org/asomov/snakeyaml/src/tip/src/test/java/examples/jodatime/)。

# 如何解析 JodaTime

由于 JodaTime 不是 JavaBean（因为它没有空的构造函数），因此在解析时需要一些额外的处理：

```
private class ConstructJodaTimestamp extends ConstructYamlTimestamp {
    public Object construct(Node node) {
        Date date = (Date) super.construct(node);
        return new DateTime(date, DateTimeZone.UTC);
    }
} 
```

当 JodaTime 实例是 JavaBean 属性时，您可以使用以下内容：

```
Yaml y = new Yaml(new JodaPropertyConstructor());

class JodaPropertyConstructor extends Constructor {
    public JodaPropertyConstructor() {
        yamlClassConstructors.put(NodeId.scalar, new TimeStampConstruct());
    }

    class TimeStampConstruct extends Constructor.ConstructScalar {
        @Override
        public Object construct(Node nnode) {
            if (nnode.getTag().equals("tag:yaml.org,2002:timestamp")) {
                Construct dateConstructor = yamlConstructors.get(Tag.TIMESTAMP);
                Date date = (Date) dateConstructor.construct(nnode);
                return new DateTime(date, DateTimeZone.UTC);
            } else {
                return super.construct(nnode);
            }
        }

    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T19:07:10.860

```
org.joda.time.DateTime getDateFromFile(final String string, final String path) throws IOException {
   final BufferedReader f = new BufferedReader(new FileReader(path));
   String s;
   final Pattern pattern = Pattern.compile(".+" + string + ".+([0-9\\-:ZT]+)");
   while ((s = f.readLine()) != null)
    {
       final Matcher m = pattern.matcher(s);
       if (m.matches())
       {
           return ISODateTimeFormatter.dateTimeNoMillis().parseDateTime(m.group(1));
       }
    }

    return null;
} 
```

使用方法

```
getDateFromFile("createdOn:", pathToFile) 
```

# xcode - 启用 AVX 时，Clang 会产生较慢的代码？

> ID：13223260
> 
> 赞同：2
> 
> 时间：2012-11-04T21:44:48.343
> 
> 标签：xcode, clang, sse, vectorization, avx

我将 Xcode 4.5.2 与“Apple LLVM Compiler 4.1”（Clang）一起使用。

我试图编译一个严重依赖于启用了 AVX 的 SSE 内在函数的代码（没有 _mm256* 函数和没有 __m256 变量）并且得到的代码比仅启用 SSE 4.2 时得到的代码要慢。

对此有什么合理的解释吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T00:20:44.973

目前 LLVM 已经打开了与 AVX 性能相关的错误，[例如这个](http://llvm.org/bugs/show_bug.cgi?id=10928)。

可以在[此处](http://llvm.org/bugs/buglist.cgi?quicksearch=avx)找到完整的 avx 相关错误列表。

# redis - ServiceStack.Redis 中的 TYPE 命令在哪里？

> ID：13223261
> 
> 赞同：1
> 
> 时间：2012-11-04T21:44:49.093
> 
> 标签：redis, servicestack

我正在使用 ServiceStack.Redis.IRedisNativeClient 但此界面不包含 TYPE 命令。为什么？如何访问此功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T22:25:24.377

ServiceStack.Redis.RedisNativeClient 包含一个“Type”方法和一个“GetEntryType”方法（它返回一个枚举而不是字符串）。接口中缺少这些方法（IRedisNativeClient）

# sql - 如何从嵌套 SELECT 评估 SQL 函数结果和查询

> ID：13223264
> 
> 赞同：1
> 
> 时间：2012-11-04T21:45:30.553
> 
> 标签：sql, select, aggregate-functions, ormlite

如何在 ORMLite 中实现这个 SQL 查询并评估结果？

```
SELECT SUM(column1 * column2) AS total FROM (ANOTHER_SELECT_QUERY) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T19:45:46.873

Couple different ways to do this. One way would be the simple:

```
long sum = dao.queryRawValue(
        "SELECT SUM(column1 * column2) AS total FROM (...)"); 
```

You can use the `QueryBuilder` to build the query.

```
QueryBuilder<Foo, Integer> qb = dao.queryBuilder();
qb.selectRaw("SUM(column1 * column2) AS total");
qb.where()...
long sum = dao.queryRawValue(qb.prepareStatementString()); 
```

I don't think you need to have the inner since `column1` and `column2` I assume are in the inner query and the `WHERE` can be just moved to the outer query.

# ruby-on-rails - 我可以将 DOM 元素传递给 rails 渲染方法吗？

> ID：13223265
> 
> 赞同：0
> 
> 时间：2012-11-04T21:45:32.237
> 
> 标签：ruby-on-rails

我正在构建的博客上有一个评论表。

博客文章很长，因此表单位于页面底部的**屏幕外。**

如果评论未通过验证，则用户将返回页面顶部，但错误消息会显示在表单所在的位置。

发生这种情况时，我希望浏览器关注评论部分，以便用户可以看到**验证错误消息**。

这是我的 comments_controller 的创建操作：

```
def create
  @article = Article.find(params[:article_id])
  @comment = @article.comments.build(params[:comment])
  if @comment.save
    redirect_to article_path(@article), notice: "Thanks for your comment"
  else
    # is there anyway to pass an id (like #comments) to this render call??
    render 'articles/show'
  end
end 
```

如您所见，`render 'articles/show'`如果验证失败，我会打电话。我希望能够做这样的事情：

```
render 'articles/show', :anchor => '#comments' 
```

在理想情况下，上面的代码会渲染article#show，并将视口焦点设置在评论部分。我知道我可以在使用时通过锚点`link_to`，但我可以这样做`render`吗？

这样的事情可能吗，还是我需要使用 Ajax 解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:20:04.157

您不需要 Ajax - 简单的 jquery 应该可以工作。

像这样的东西（用你的错误类替换'.error-messages'）：

```
$(document).ready(function(){

  if ($(.error-messages).length) {
      $('body').animate({scrollTop:$('.error-messages').offset().top})
  }

}) 
```

在页面加载时，如果有任何错误消息，页面将滚动到错误消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T22:17:22.290

我不认为`render`可以做你想做的工作。因为`render`将呈现整个页面（包括布局），但不是您要更改的唯一文本。

我建议你使用 jQuery 的 Ajax，它更加优雅和简单。

# ruby-on-rails - NilClass:Class 的未定义方法 `model_name' (has_one a belongs_to 关系)

> ID：13223268
> 
> 赞同：1
> 
> 时间：2012-11-04T21:45:51.770
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

您好，我试图为我的 user_information 模型创建创建视图，但出现此错误：

```
NoMethodError in User_informations#new

undefined method `model_name' for NilClass:Class 
```

这是用户模型：

```
class User < ActiveRecord::Base
  attr_accessible :email, :password, :password_confirmation
  has_one :user_information
  has_secure_password

  before_save { |user| user.email = email.downcase }
  before_save :create_remember_token

  VALID_EMAIL_REGEX = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i
  validates :email, presence: true, format: { with: VALID_EMAIL_REGEX }, uniqueness: { case_sensitive: false }
  validates :password, presence: true, length: { minimum: 6 }, confirmation: true, unless: Proc.new { |a| !a.new_record? && a.password.present? }

    def send_password_reset
        self.password_reset_token = SecureRandom.urlsafe_base64
        self.password_reset_at = Time.zone.now
        self.password = self.password
        self.save!(:validate => false )
        UserMailer.password_reset(self).deliver
    end

    def reset_password_token
        self.password_reset_token = nil
        self.password_reset_at = nil
        save!
    end

  private

    def create_remember_token
        if self.new_record?
            self.remember_token = SecureRandom.urlsafe_base64
        end
    end

end 
```

这里的 user_information 模型：

```
class UserInformation < ActiveRecord::Base
  belongs_to :user
  attr_accessible :address, :address2, :business, :descripcion, :identification_number, :mobile_cell, :name, :phone_number
  validates :address, presence: true, length: { :maximum => 250 } 
  validates :address2, length: { :maximum => 250 } 
  validates :descripcion, presence: true, length: { :maximum => 300 } 
  validates :identification_number, presence: true
  validates :phone_number, presence: true, length: { :is => 11 } 
  validates :mobile_cell, :length => { :is => 11 }
  validates :user_id, presence: true
end 
```

和观点：

```
<%= form_for(@user_information) do |f| %>
    <%= render 'shared/error_messages', object: f.object %>
    <%= f.text_field  :name %>
    <%= f.text_field  :descripcion %>
    <%= f.text_field  :address %>
  <%= f.button "<i class=\"icon-user icon-white\"></i> Salvar".html_safe, :tabindex => 3,  class: "btn btn-warning", :style => "width:220px;margin-bottom:5px;" %>

<% end %> 
```

控制器

```
class UserInformationsController < ApplicationController

    def index
    end

    def create
        @user_information = current_user.userinformations.build(params[:user_information])
        if @user_information.save
            flash[:success] = "Micropost created!"
            redirect_to redirect_to
        else

        end
    end

end 
```

谁能帮我理解一下。

* * *

路线

```
 resources :users do
      member do
        resource :user_information
      end
  end
  resources :sessions, only: [:new, :create, :destroy]
  resources :password_resets

  root to: 'users#new'

  match '/signup',  to: 'users#new'
  match '/signin',  to: 'sessions#new'
  match '/signout', to: 'sessions#destroy', via: :delete 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T21:48:58.877

您必须`@user_information`在控制器中定义，如下所示：

```
class UserInformationsController < ApplicationController

   def new
     @user_information = UserInformation.new
   end

end 
```

此外，这一行是不正确的：

```
@user_information = current_user.userinformations.build(params:user_information) 
```

它应该是：

```
@user_information = current_user.build_user_information(params[:user_information]) 
```

# mysql - 用于存储来自外部网站的用户数据的数据库设计模式

> ID：13223270
> 
> 赞同：1
> 
> 时间：2012-11-04T21:46:19.303
> 
> 标签：mysql, sql, facebook, database-design, twitter

我正在开发一个允许用户通过`facebook`or注册的应用程序，`twitter`我希望能够使用来自这些网站的个人数据，并想知道我应该如何存储它。到目前为止，这是我想出的：

![在此处输入图像描述](../Images/35b7acef2024854a01549580d3897ada.png)

该`user`表将存储无论用户如何注册都应该存在的信息，例如`first_name`.

该`user_property`表将用作`key-value`缓存并存储特定于`facebook`或`twitter`（由`origin`字段表示）的信息。我将存储可单独用作`API`调用或`SQL`查询的一部分的属性，例如 users' `facebook id`，我将存储`API`以格式序列化的其他调用的结果`JSON`，例如 users' `facebook friends`。

那样：

*   我在表格中有共同的信息，`user`通过一个单一的信息，`SELECT`我可以获得一些关于用户的基本有用信息
*   我有一些额外的属性来自`facebook/twitter`（例如用户 ID）单独存储，我仍然可以使用`JOIN`between`user`和查找`user_property`。
*   我可以检索过于昂贵而无法标准化存储的信息（例如，创建一个表来存储人们的朋友并且每个朋友有一个表条目）仍然具有`JOIN`between `user`and `user_property`。

这就是我现在想知道的：

**Q1：这可能是一个有点可持续的数据库设计，还是我弄错了会遇到一些问题，如果是这样，哪些问题？**

**Q2：当存储经常变化的信息（例如朋友/关注者列表）时，您如何保持信息最新（您首先将信息存储在数据库中吗？如果是，那么标准/触发器是什么？您是否使用来决定何时再次提取信息）？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T23:35:40.203

您的设计具有 EAV 模式（实体-属性-值）的大多数（坏）属性。在这件事上寻求[维基百科，也看看这个网站。](http://en.wikipedia.org/wiki/Entity%E2%80%93attribute%E2%80%93value_model)

EAV 最不可持续的设计决策是（恕我直言），一开始这似乎可以很好地扩展。但是，一旦您的数据增长，您就会高速撞上混凝土墙。这是因为为了加载*一个*用户的数据，数据库必须使用*随机访问来接触物理表的**很大*一部分。当数据增长和经常变化时，调整数据库以将一个用户的行保持在相邻页面中是一项繁重的任务。*`user_property`*

# cakephp - Cron 调度程序错误 - CakePHP 2.0

> ID：13223272
> 
> 赞同：0
> 
> 时间：2012-11-04T21:46:25.130
> 
> 标签：cakephp, cron, cakephp-2.0

在[这篇文章](https://stackoverflow.com/a/8722519/836343)之后，我在让我的 cron 运行时遇到了一些问题。

我按照附件中的说明进行了设置，但是我的 cron 在运行时收到此错误：

```
Status: 302 Found
X-Powered-By: PHP/5.3.8
Set-Cookie: CAKEPHP=7ae47e0238594f2b9b93d2e9017ddd63; expires=Mon, 05-Nov-2012 21:00:07 GMT; path=/; HttpOnly
Location: https:// /tasks/cron_emailer
Content-Type: text/html; charset=UTF-8 
```

我的 cron 路径如下： **php /home/village/public_html/app/webroot/cron_dispatcher.php /tasks/cron_emailer**

知道我哪里出错了吗？从错误中的位置开始，这似乎是我的路径问题。

# c++ - 如何强制执行“覆盖”关键字？

> ID：13223277
> 
> 赞同：57
> 
> 时间：2012-11-04T21:46:49.460
> 
> 标签：c++, visual-c++, c++11, visual-studio-2012, overriding

有没有办法`override`在 Visual C++ 2012 中强制使用 C++11 关键字？

（即如果我忘记说`override`，那么我想得到一个警告/错误。）

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-04T22:28:01.167

C++11 几乎拥有了你想要的东西。

最初，该`override`关键字是一个更大的提案（[N2928](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2928.htm)）的一部分，其中还包括强制使用它的能力：

```
class A
{
  virtual void f();
};

class B [[base_check]] : public A
{
    void f();  // error!
};

class C [[base_check]] : public A
{
  void f [[override]] ();  // OK
}; 
```

该属性会导致在不使用关键字`base_check`的情况下覆盖虚函数是错误的。`override`

还有一个`hiding`属性表示函数隐藏了基类中的函数。If`base_check`被使用并且一个函数从基类中隐藏一个而不使用`hiding`它是一个错误。

But most of the proposal was dropped and only the `final` and `override` features were kept, as "identifiers with special meaning" rather than attributes.

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-12-12T21:05:26.043

There are few ways to do this in VC++ and equivalent ways with GCC as well.

**VC++**

Below are the relevant warning numbers in VC++:

```
C4263 (level 4) 'function': member function does not override any base class virtual member function
C4266 (level 4) 'function': no override available for virtual member function from base 'type'; function is hidden 
```

To enable these two warnings, you can use one of following options:

1.  Set warning level to 4 in project settings and then disable the warnings you don't want. This is my prefered way. To disable unwanted Level 4 warnings, go to project settings > C/C++ > Advanced and then enter warning numbers in Disable Specific Warnings box.
2.  Enable above two warnings using code.

    ```
    #pragma warning(default:4263)
    #pragma warning(default:4266) 
    ```

3.  在项目设置 > C/C++ > 命令行中启用以上两个警告，然后输入 /w34263 /w34266。这里 /wNxxxx 选项意味着在 N 级启用 xxxx 警告（N = 3 是默认级别）。您还可以执行 /wdNxxxx 来禁用 N 级中的 xxxx 警告。

**海合会**

GCC 5.1+ 添加了新的警告建议覆盖，您可以将其作为命令行选项传递`-Wsuggest-override`。

**铛**

Clang 3.5+ 有`-Winconsistent-missing-override`，但是这只检测某些覆盖成员或基类使用`override`但其他覆盖成员不使用的情况。您可能还想看看 clang-tidy 工具。

# c++ - 模板函数调用被模板之前声明的签名错误的函数混淆

> ID：13223278
> 
> 赞同：4
> 
> 时间：2012-11-04T21:46:56.170
> 
> 标签：c++, templates

GCC 4.6 不接受以下代码：

```
void F(int x,char y)
{
}
template<typename T>
void G(T t)
{
    F(t);
}
void F(int x)
{
}

int main()
{
    G(5);
    return 0;
} 
```

应该是吗？

如果没有，是否有人有解决方法的好主意？发生这种情况的真实世界场景是 G 是用于解决特定类型问题的库的一部分，需要一个名为 F 的用户提供的辅助函数。但是，对于不同类型的问题，F 采用不同数量的参数。库附带了一些 F 的示例实现。

发生的情况是，根据客户端使用的#include-order，只有 F 的“错误类型”可能在模板声明时可见，然后 GCC 放弃，而不等到用户提供正确的 F被定义为。即使模板实例化发生在定义正确的 F 之后也是如此。

更新：是的，我知道如果 F 的所有声明都发生在 G 之前，或者如果 F 的所有声明都发生在 G 之后，它会起作用。但是，这对我并没有太大帮助。

更新：在这个最小示例改编的代码中，F 真的被称为“读取”。并且第一个 read 声明与第二个完全没有关系。第一个声明在一个头文件中，第二个在另一个头文件中。我不想介绍有关包含文件顺序的“奇怪”规则，尤其是当“读取”的版本彼此无关时。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T22:13:39.430

在实例化时，只进行参数相关的查找。您可以使用类型位于您的命名空间中的参数来解决您的问题`F`

```
void F(int x,char y)
{
}
template<typename T>
void G(T t)
{
    F(t);
}
void F(int x)
{
}

template<typename T>
struct wrapper {
 operator T() const { return t; }
 T t;
};

template<typename T> wrapper<T> make_wrapper(T t) {
  wrapper<T> w = { t };
  return w;
}

int main()
{
    G(make_wrapper(5));
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T21:49:43.093

一种可能的解决方法是确保声明在声明`void F(int x)`之前可用`template<typename T> void G(T t);`

```
void F(int x);

template<typename T> void G(T t) { .... } 
```

在您的示例中，`F(int)`从属名称，so 在*两阶段查找的第二阶段进行查找*。但是，查找规则。在草案 n3337 的第 14.6.4 节中指定，指定名称必须在模板的定义点可见，或在与函数参数类型关联的命名空间中（参数依赖查找）：

> 在解析从属名称时，会考虑来自以下来源的名称：
> 
> — 在模板定义时可见的声明。
> 
> — 来自实例化上下文 (14.6.4.1) 和定义上下文中与函数参数类型相关联的命名空间的声明。

因此，另一种解决方法是将函数带入`T`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T21:49:39.363

尝试将`F(int)`重载放在*上面* `G`。

```
void F(int x) {}

template <typename T> void G(T t) { F(t); } // works 
```

函数没有被提升；在使用它们之前，您必须对它们进行原型设计或定义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T21:50:55.577

> 如果没有，是否有人有解决方法的好主意？

在您定义该模板时，`F()`编译器唯一知道的是`void F(int x,char y)`，这显然与`G(T t)`.

解决方案很简单：在定义`void F(int x)` **之前**定义或声明`template<typename T> void G(T t)`。

# bash - 源文件如何继承陷阱调试？

> ID：13223279
> 
> 赞同：10
> 
> 时间：2012-11-04T21:47:04.157
> 
> 标签：bash, debugging, bash-trap

运行以下代码段：

```
#!/bin/bash

function preexec ()
{
    echo -e "\n-->preexec command: $BASH_COMMAND"
}
trap 'preexec' DEBUG

function testfunc ()
{
    echo "testfunc called $1"
}

testfunc "main"
source "source.sh"

exit 0 
```

source.sh 在哪里

```
#!/bin/bash

testfunc "source" 
```

给出：

```
-->preexec command: testfunc "main"
testfunc called main

-->preexec command: source "source.sh"
testfunc called source

-->preexec command: exit 0 
```

这意味着源文件中的每个命令都不会被 DEBUG 陷阱捕获。
实际上，如果我添加该行

```
trap 'preexec' DEBUG 
```

在 source.sh 中作为第二行，一切都按需要进行（源文件中的命令也被捕获）。

如何将其设为默认行为以避免对我需要获取的任何文件重复上述行？换句话说：有没有机会告诉源文件继承调试陷阱？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-03T15:53:45.453

我解决了主文件中的设置：

```
set -o functrace 
```

来自 BASH 人：

> 如果设置，则 DEBUG 和 RETURN 上的任何陷阱都将由 shell 函数、命令替换和在子 shell 环境中执行的命令继承。在这种情况下，通常不会继承 DEBUG 和 RETURN 陷阱。

作为*“源”*一个shell函数，它们是被继承的。

# jquery - 我想将图像保存到 cakephp image uploadify 中运行时的子目录

> ID：13223280
> 
> 赞同：0
> 
> 时间：2012-11-04T21:47:08.223
> 
> 标签：jquery, cakephp, cakephp-2.0

我试试这个..但不创建子文件夹...我不明白问题出在哪里..

```
$user_id = $this->User->id;
if(!empty($prof_image['name'])){
$image_name = str_replace($prof_image['name'], 'profile', $prof_image['name']);
$dest = WWW_ROOT . DS . 'img' . DS . 'filocity_img' . DS . 'user_'. $user_id . DS . $image_name . '.jpg';
if(move_uploaded_file($prof_image['tmp_name'], $dest)){
    echo json_encode('Information successfully updated');
}
} 
```

谁能帮我？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T18:01:11.027

> 但不创建子文件夹

如果要将图像保存在不存在的子目录中，则必须在调用之前创建它`move_uploaded_file()`

[目标目录必须存在；move_uploaded_file() 不会自动为您创建它](http://www.php.net/manual/en/function.move-uploaded-file.php#105026)

如果这不是问题，那么您需要在问题中提供更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:22:34.793

您可以使用 CakePHP 文件和文件夹实用程序轻松完成。

首先添加：

```
<?php 
App::uses('Folder', 'Utility');
App::uses('File', 'Utility'); 
```

然后试试这个：

```
$user_id = $this->User->id;
if(!empty($prof_image['name'])){
   $image_name = str_replace($prof_image['name'], 'profile', $prof_image['name']);
   $dest = WWW_ROOT . DS . 'img' . DS . 'filocity_img' . DS . 'user_'. $user_id;
 $dir = new Folder($dest, true, 0777);
 $file = new File($dir. DS . $image_name . '.jpg');
 if($file){
    echo json_encode('Information successfully updated');
   }

} 
```

# c - C 中的多进程、分叉和管道

> ID：13223286
> 
> 赞同：0
> 
> 时间：2012-11-04T21:47:41.390
> 
> 标签：c, fork, pipe

我之前发布了一个关于[在 C 中使用 fork() 和管道的问题](https://stackoverflow.com/questions/13213864/multiprocessing-and-pipes-in-c) 。我稍微改变了设计，让它读取一个常规的 txt 文件并对文件中的单词进行排序。到目前为止，这是我想出的：

```
 for (i = 0; i < numberOfProcesses; ++i) {
    // Create the pipe
    if (pipe(fd[i]) < 0) {
      perror("pipe error");
      exit(1);
    }

    // fork the child
    pids[i] = fork();
    if (pids[i] < 0) {
      perror("fork error");
    } else if (pids[i] > 0) {     
      // Close reading end in parent
      close(fd[i][0]);

    } else {     
      // Close writing end in the child
      close(fd[i][1]);

      int k = 0;
      char word[30];

      // Read the word from the pipe
      read(fd[i][0], word, sizeof(word));

      printf("[%s]", word);    <---- **This is for debugging purpose**

     // TODO: Sort the lists  
    }
  }

  // Open the file, and feed the words to the processes
  file_to_read = fopen(fileName, "rd");

  char read_word[30];
  child = 0;

  while( !feof(file_to_read) ){
    // Read each word and send it to the child
    fscanf(file_to_read," %s",read_word);

    write(fd[child][1], read_word, strlen(read_word));
    ++child;
    if(child >= numberOfProcesses){
      child = 0;
    }
  } 
```

where`numberOfProcesses`是一个命令行参数。所以它的作用是读取文件中的每个单词并将其发送到一个进程。然而，这不起作用。当我在子进程中打印单词时，它没有给我正确的输出。我是否正确地从管道中写入/读取单词？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T21:56:26.150

在父级中，您写入`strlen()`可能小于 30 个字节的字节。但是，在孩子中，您总是尝试读取 30 个字节。您还必须以 NUL 终止单词，否则您可能会在`printf()`语句中看到垃圾或失控的字符串。

在孩子中，您必须在单词边界解析和拆分输入，或者按照[@JonathanLeffler 的](https://stackoverflow.com/a/13215681/1741542)建议使用 stdio。当您使用 stdio 时，您可以免费获得所有这些缓冲和单词阅读。

```
int n;
char word[31];

/* Read the word from the pipe */
n = read(fd[i][0], word, sizeof(word) - 1);
if (n == -1) {
    perror("read");
    /* do error handling */
} else {
    word[n] = 0;
    printf("[%s]", word);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T22:10:24.773

单词是否以错误的顺序打印或交错？问题是，当您向管道写入一个单词时，您期望处理该管道的进程立即被调度并打印该单词。然后您希望主进程再次运行，并将下一个单词写入下一个管道等。

但这并不保证会发生。您的主循环可能会在安排任何其他进程之前将所有单词写入所有管道。这些过程可能不会按照您期望的顺序安排。并且 printf 调用可能会相互干扰，从而使它们的输出交错。

如果你真的想做你想做的事，那么 Posix 线程会更好。如果您只是想了解有关使用多个进程的知识，那么我想您已经 :-)

# wordpress - 根据另一个自定义字段的值显示帖子

> ID：13223287
> 
> 赞同：0
> 
> 时间：2012-11-04T21:47:51.610
> 
> 标签：wordpress, custom-post-type

您如何根据其自定义字段之一的值显示帖子？我下面的代码似乎不起作用：

```
$args = array(
    'post_type' => 'sample-cpt',
    'meta_query ' => array(array('key'=>'cpt_display', 'value' => 1))
);
$samples = new WP_Query($args); 
```

即使值为`cpt_display`a ，这仍会返回所有帖子`0`。我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T23:42:13.057

尝试这个..

添加 meta_key = key 作为 args 的一部分，然后将其再次包含在 meta_query 数组中

```
 $args = array(
   'post_type' => 'sample-cpt',
   'meta_key' => 'key',
   'order' => 'ASC',
   'meta_query' => array(
       array(
           'key' => 'key',
           'value' => 1
       )
   )
 );
 $samples = new WP_Query($args); 
```

[http://codex.wordpress.org/Class_Reference/WP_Query](http://codex.wordpress.org/Class_Reference/WP_Query)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T05:44:07.217

我找到了答案。的值`'meta_value'`必须是数组而不是字符串。[这与WP_Query Codex](http://codex.wordpress.org/Class_Reference/WP_Query)存在巨大偏差，需要修复。

```
$args = array(
    'post_type' => 'sample-cpt',
    'meta_key' => 'cpt_display',
    'meta_value' => array(1)
);
$samples = new WP_Query($args);
wp_reset_query(); 
```

现在它只显示自定义字段值为 的帖子`1`。查看请求查询，它表明通过使用数组，请求被转换为使用 SQL`IN()`来搜索帖子，而不是`'='`：

```
...postmeta.meta_key='cpt_display' AND CAST(postmeta.meta_value AS CHAR) IN ('1'))... 
```

来源：[按​​自定义字段日期范围显示自定义帖子类型](http://wordpress.org/support/topic/display-custom-post-type-by-custom-field-date-range#post-2797124)

# dart - Dart 库和部件不是双向解析的

> ID：13223288
> 
> 赞同：4
> 
> 时间：2012-11-04T21:48:04.170
> 
> 标签：dart, dart-editor

我有一个库“foo”，它由一个部分“bar”组成，并导入 dart:io 库。库和部件在 'foo.dart' 中声明如下：

```
// in foo.dart

library foo;
import 'dart:io';
part "bar.dart"; // resolves

class Foo {
  Bar bar = new Bar(); // resolves
  HttpServer server = new HttpServer(); // resolves
} 
```

'foo.dart' 和 'bar.dart' 位于同一目录中。

'bar.dart' 引用库 foo，如下所示：

```
// in bar.dart

part of foo; // does not resolve

class Bar {
  Foo foo = new Foo(); // does not resolve
  HttpServer server = new HttpServer // does not resolve
} 
```

但在 Dart 编辑器中，我在“bar.dart”中看到一条警告，说“无法解析 foo”。因此，我在 foo.dart 中声明的任何导入（例如 'dart:io'）都不适用于 bar.dart，我的任何 foo.dart 定义也不可用，并且由于 bar.dart 是 foo 的一部分，因此它是不允许导入任何其他库或声明任何其他部分。

我想以这样的方式组织我的代码： * 我带入 foo.dart 的任何导入都可用于 bar.dart（和其他源部分） * 在一个库源部分中创建的库定义可用于其他库源部分。*（显然）bar.dart 中的库定义可用于 foo.dart（这已经按预期工作）

有人可以帮我理解如何完成这些吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T22:04:34.320

我认为这只是编辑器中的一个错误。你试过运行你的程序吗？它应该工作。

编辑器有时仍然会收到卡住警告，关闭文件或关闭编辑器以获得真正卡住的警告通常会清除它。我会看看我是否找到了错误报告，这样你就可以给它加星标，或者如果它一直发生在你身上，也可以添加一个日志文件。

# android - 通过 ActionBar 后退图标返回 Activity 时 AsyncTask 不恢复

> ID：13223289
> 
> 赞同：1
> 
> 时间：2012-11-04T21:48:05.510
> 
> 标签：android, multithreading, android-asynctask, android-activity

我有一个`AsyntTask`开始`onCreate`并无限循环，更新 UI 元素。

更新以这种方式完成（Async 扩展类的简化表示，我们称之为`asyncExtender().execute()`）：

```
doInBackground(){
    while (!isCancelled()) {
        Thread.sleep(2000);
        publishProgress(someValue);
    }
}
protected void onProgressUpdate() {
    super.onProgressUpdate(values);
    // UI update here, e.g. TextView.setText
} 
```

另一个活动开始了，我们称之为SecondActivity。SecondActivity 利用操作栏中的分层后退按钮返回到上一个活动 ( `NavUtils.navigateUpFromSameTask(this)`in `onOptionsItemSelected`)。

问题是，当我在 SecondActivity**的操作栏中**点击后退按钮时，AsyncTask 似乎不再在第一个活动中运行（UI 不会每 2 秒更新一次）。另一方面，如果我使用**硬件“后退”按钮，它工作正常**- AsyncTask 继续运行。

为什么行为差异以及如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T21:53:04.510

AsyncTasks 不应该同时启动，它们也不应该运行太长时间，最多几秒钟。根据您所针对的 API，AsyncTasks 可能会同步运行，因此您的新 AsyncTask 将仅在所有以前的任务完成后运行，文档摘录：

[http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

> 首次引入时，AsyncTask 在单个后台线程上串行执行。从 DONUT 开始，这被更改为允许多个任务并行运行的线程池。从 HONEYCOMB 开始，任务在单个线程上执行，以避免并行执行导致的常见应用程序错误。

# java - 试图让自定义 android 相机工作

> ID：13223295
> 
> 赞同：1
> 
> 时间：2012-11-04T21:48:42.973
> 
> 标签：java, android, android-camera

我已经开发了一个基本的相机，并试图让它工作。

这是相机代码

```
package com.example.camera;

   import java.io.IOException;

import android.content.Context;
import android.hardware.Camera;
import android.view.SurfaceHolder;
import android.view.SurfaceView;

public class CameraView extends SurfaceView implements SurfaceHolder.Callback {

private SurfaceHolder holder;
 private Camera camera; 
 Object size;

 public CameraView(Context context) {

        super(context);
        holder = this.getHolder();
        holder.addCallback(this);
        holder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS); 
        holder.addCallback(this);
}
 public Camera getCamera(){
        return camera;
} 

 public void surfaceChanged(SurfaceHolder holder, int format, int width, int height) {

      Camera.Parameters params = camera.getParameters();//Getting paramaters.

        if(size!=null){ //make sure we don't pull a NullException.
                params.setPreviewSize(width, height);//gotta set the size, since we know it. 
        } 
        camera.setParameters(params);//gotta set the paramaters now. 
        camera.startPreview();//starting the preview.
}

public void surfaceCreated(SurfaceHolder arg0) {
    try{
        camera = Camera.open();//setting the camera up.
        camera.setPreviewDisplay(holder);//making the display our current SurfaceHolder
} catch (IOException e){
        e.printStackTrace();//printing out the error message if it happens.
} 

}

public void surfaceDestroyed(SurfaceHolder arg0) {
    camera.stopPreview();
    camera.release();
    camera = null;

} 

        } 
```

现在我试图从我的主要方法调用相机，但我似乎无法让它工作

包 com.example.camera;

```
import java.io.ByteArrayInputStream;
import java.io.InputStream;

import android.graphics.Bitmap;
 import android.graphics.BitmapFactory;
 import android.hardware.Camera;
 import android.os.Bundle;
 import android.view.View;
 import android.widget.Button;
 import android.widget.ImageView;

public class main {
private static final int CAMERA_REQUEST = 1888; 
private ImageView imageView;

     public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.main);
            this.imageView = (ImageView)this.findViewById(R.id.imageView1);
            Button photoButton = (Button) this.findViewById(R.id.button1);
            photoButton.setOnClickListener(new View.OnClickListener() {
                public void onClick(View v) {
                     cam = cv.getCamera(); //notice how we used that method? ;)
                     cam.takePicture(null,null,PictureCallback_);

                }
            });
        }
     Camera.PictureCallback PictureCallback_ = new Camera.PictureCallback() {

            public void onPictureTaken(byte[] imageData, Camera c) {

                    InputStream is = new ByteArrayInputStream(imageData);

                    Bitmap bmp = BitmapFactory.decodeStream(is); 
            } 
    } ; 
```

任何帮助表示赞赏。尝试调用原始相机活动 getCamera 然后获取照片并将其放入 imageView1 任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T23:04:05.830

尝试在您的 onClick() 方法中执行此操作：

```
cam.autoFocus(new AutoFocusCallback(){
    Camera.ShutterCallback shutterCallback = new Camera.ShutterCallback() {
        public void onShutter() {
          // If you want to play your own sound (otherwise, it plays the sound by default)
        }
    };

    @Override
    public void onAutoFocus(boolean arg0, Camera arg1) {
        cam.takePicture(shutterCallback, null, PictureCallback_);
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T05:19:39.447

我在[这里创建了一个相机库项目，](https://github.com/girishnair12345/Girish-Camera-Library-Project)您可以使用该[库](https://github.com/girishnair12345/Girish-Camera-Library-Project/tree/master/Girish%20Camera%20Library%20Project/Library)来调用相机并拍照并保存它或阅读有关如何使用相机的代码。[样品](https://github.com/girishnair12345/Girish-Camera-Library-Project/tree/master/Girish%20Camera%20Library%20Project/CameraSample)已提供，您可以查看

# assembly - 在程序集中检索内存位置

> ID：13223298
> 
> 赞同：1
> 
> 时间：2012-11-04T21:48:50.597
> 
> 标签：assembly, x86

我的问题是我必须编写一个使用汇编语言调用 malloc 的程序。但是我不知道如何检索分配区域的地址。它将它存储在某个地方的内存中，如果是，我如何找到它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T22:03:21.710

最简单的解决方案是编写一个简单的 C 程序，该程序调用 malloc 并执行一些您可以轻松跟踪结果的事情（例如将其存储在外部变量中），编译它，然后查看生成的汇编代码。

例如：

```
extern void * somePointer;
extern int someInt;
void callMalloc(void) 
{
     somePointer = malloc(someInt);
} 
```

在 Linux 上编译它，x86_64 给出：

```
 movslq  someInt(%rip), %rdi
    call    malloc
    movq    %rax, somePointer(%rip) 
```

所以这正是您需要做的——将字节数放入`%rdi`，调用`malloc`，然后从`%rax`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T21:32:54.313

`malloc`是一个 C 库函数，所有 C 函数都遵循所谓的[调用约定](http://en.wikipedia.org/wiki/X86_calling_conventions)。这描述了如何传入参数，以及如何返回结果。

如果您从程序集中调用 C 函数，您应该真正知道 C 代码使用什么调用约定。

不同的编译器/库有不同的调用约定，但最常见的都是`eax`在 x86 上的寄存器中返回整数/指针值（至少`cdecl`在 Linux/gcc 和`syscall`Windows API 上如此）。

下面是一个调用`malloc`using的例子`cdecl`：

```
push 24       ; Push the number of bytes we want to allocate    
call _malloc  ; Call malloc
add esp, 4    ; Undo the push

mov dword ptr [eax], 10   ; Set the first dword of the block to 10
mov dword ptr [eax+4], 5  ; Set the second dword of the block to 5 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T20:56:43.057

如果您使用的是 Win32，它看起来像是在 EAX 中返回它（抓取了我几年前编写的一些旧代码，这就是宏返回它的样子）。

# regex - 使用 WWW::Mechanize 跟踪图像链接时遇到问题

> ID：13223309
> 
> 赞同：4
> 
> 时间：2012-11-04T21:49:51.003
> 
> 标签：regex, perl, www-mechanize

我正在编写一个 Perl 脚本来获取“当天的天文图像”并将其设置为我的墙纸。然后我会设置一个 cronjob 每天为我做这件事。但是我很难让脚本跟随指向全尺寸图像的图像链接，然后才下载它。我正在尝试类似下面的代码（请记住，我只是一个对 Perl 正则表达式不太了解的 Perl 初学者）：

```
#!/usr/bin/perl -w
use strict;
use warnings;
use WWW::Mechanize;

my $url = "http://apod.nasa.gov/apod/astropix.html";

my $mech = WWW::Mechanize->new();
$mech->get($url);
    #debugging
if ($mech->follow_link(url_regex=>qr/\.(?:jpg|png)$/)){
    print "Following the image link...";
}else{
    print "Couldn't find the link...";
}

my @img = $mech->find_image(alt_regex => qr/image/i);

    foreach my $img(@img){
     $mech->get($img->url, ':content_file'=>'astro.jpg');
    }

    print "\n";

    exit(0); 
```

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T22:17:30.403

您的脚本几乎是正确的。NASA页面的结构是：

```
<html>
<body>
  ...
  <a href="http://.../blah.jpg"><img src="http://.../blah-lowres.jpg"></a>
  ...
</body>
</html> 
```

因此，如果`$mech->follow_link`成功，您已经在`$mech->content`.

试试这个：

```
$mech->get($url) or die "unable to get $url";
$mech->follow_link(url_regex => qr/\.(jpg|png)\z/) or die "unable to follow image link";
open(my $fh, ">astro.jpg");
print {$fh} $mech->content;
close($fh);
print "saved image as astro.jpg\n"; 
```

# jquery - 如何使用 Jquery 从带有通配符的所有元素中删除类

> ID：13223314
> 
> 赞同：1
> 
> 时间：2012-11-04T21:50:49.860
> 
> 标签：jquery, html, css, jquery-mobile

我正在制作一个响应式网站。对于移动版本，我使用的是 jQuery mobile，它为我的 HTML 添加了很多类。我不希望这些类用于桌面版本。

所有 jQuery 移动类都以“ui”为前缀。虽然我可以使用，但我必须为每个类和每个 HTML 元素`.removeClass('')`使用单独的减速。`.removeClass('')`

如何使用通配符方法删除所有以 ui 开头的类，而不管它们位于哪个元素上？

我找到了一个名为[jQuery alterClass](https://gist.github.com/1517285)的插件，它应该可以做到这一点，但我似乎无法让它工作。我完全按照说明进行操作，但它不会删除课程。我在[这里设置了一个 JSFiddle](http://jsfiddle.net/big_smile/acyJT/)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T21:56:51.007

**在你的小提琴中，** 你的锚标签有 id：`<a id="#foo"`

您在 JQuery 中将其称为`$('#foo')`. 那是指带有 的元素`id = foo`。

（**[小提琴](http://jsfiddle.net/acyJT/1/)**）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T22:20:43.377

这应该删除以任何元素开头的任何类`ui`，它不是很有效，您应该考虑传递一个更具体的选择器。

有时 jQuery UI/mobile 会在加载 DOM 后添加类，因此仅在文档准备好后运行一次并不能保证`ui`类不会再次出现：

```
$('*').attr('class', function(i, classes) {
    return classes.replace(/\sui[^\s]*|^ui[^\s]*/gi, '');
}); 
```

[**小提琴**](http://jsfiddle.net/acyJT/2/)

我会认真考虑寻找另一种方法来做到这一点，例如如果网站不是移动版本等，则不包括库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T22:28:49.723

要获得所有从 UI 开始的类，您可以使用它。[完全以给定的字符串开头](http://api.jquery.com/attribute-starts-with-selector/)

```
//handles classes like UI1, UI2 ...
$('[class^="UI"]') 
```

你可以阅读更多关于[Jquery 文档](http://api.jquery.com/attribute-starts-with-selector/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T22:38:31.957

如果要从具有以 开头的类的所有元素中删除所有类`UI`：

```
$('[class^=UI]').removeClass(); 
```

# php - AJAX请求在php中失败

> ID：13223316
> 
> 赞同：0
> 
> 时间：2012-11-04T21:51:22.100
> 
> 标签：php, ajax

我有两个 php 页面。

1.  选择月份时会显示日历。
2.  其他是将日历弹出到第一页的文件。

我正在使用 XMLHttRequest 发送月份值并获取该月的日期。

**第一个 PHP 页面**

```
<html>
<head>
<script type="text/javascript">
function showMonth(str)
{
if (str=="")
  {
  document.getElementById("txtHint").innerHTML="";
  return;
  } 
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("txtHint").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","showmonthCalender.php?month="+str,true);
xmlhttp.send();
}
</script>  
</head>
<body>
<form>
                        <select name="month" class="default" tabindex="2" onChange="showMonth(this.value)">
                                    <option value="01">JANUARY</option>
                                    <option value="02">FEBRUARY</option>
                                    <option value="03">MARCH</option>
                                    <option value="04">APRIL</option>
                                    <option value="05">MAY</option>
                                    <option value="06">JUNE</option>
                                    <option value="07">JULY</option>
                                    <option value="08">AUGUST</option>
                                    <option value="09">SEPTEMBER</option>
                                    <option value="10">OCTOBER</option>
                                    <option value="11">NOVEMBER</option>
                                    <option value="12">DECEMBER</option>
                        </select>
                        </form>

<div id="txtHint">display here</div>
</body>
</html> 
```

**第二个 PHP 文件 (showmonthCalender.php)**

```
<?php
$monthfetch = $_GET['month'];
$carry = "<div class='clear'></div>";
if ($monthfetch == '01' || $monthfetch == '03' || $monthfetch == '05' || $monthfetch == '07' || $monthfetch == '08' || $monthfetch == '10' || $monthfetch == '12')
    {
        for($i=01; $i<32; $i++)
        {
            $d = $i;
            $y = date('Y');
            $theDate = $y.'-'.$monthfetch.'-'.$d;
            $day = date("l", mktime(0, 0, 0, $monthfetch, $d, $y));
            $carry = $carry . "<div class='dateHolder'>
                        <div class='date'>
                            <div class='valueHoliday'>
                                $d
                            </div>
                        </div>
                        <div class='day'>
                            <div class='valueHoliday'>
                                $day
                            </div>
                        </div>
                        <div class='clear'></div>";
        }
        echo "$carry";
    }
?> 
```

出于测试目的，我只选择有 31 天的月份。但是当我从第一个 php 文件中选择一个月时，什么都没有显示。我无法解决问题。

需要帮助。

# c# - 如何解析文本中的数字并将其显示在文本框中？C＃

> ID：13223321
> 
> 赞同：0
> 
> 时间：2012-11-04T21:52:06.157
> 
> 标签：c#, text, numbers, tokenize

我有一个带有以下文本的字符串：

```
:0c4b7fcdffc38322555a9e35c22c9469:Nick:194176015020283762507: 
```

如何解析最终数字？IE：

```
194176015020283762507 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T21:53:30.580

您应该首先使用[`String.Split()`](http://msdn.microsoft.com/en-us/library/b873y76a.aspx)冒号 (':') 分隔符来分隔字符串。然后访问正确的元素。

```
var input = ":0c4b7fcdffc38322555a9e35c22c9469:Nick:194176015020283762507:";
var split = input.Split(':');
var final = split[3]; 
```

请注意，默认情况下，`Split()`保留空条目。由于初始冒号和结尾冒号，您将在开头和结尾都有一个。您还可以使用：

```
var split = input.Split(new[] {':'}, StringSplitOptions.RemoveEmptyEntries);
var final = split[2]; 
```

正如选项所暗示的那样，它从数组中删除空条目。因此，您的号码将位于索引 2 而不是 3。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T21:53:51.663

```
string str = ":0c4b7fcdffc38322555a9e35c22c9469:Nick:194176015020283762507:";
string num = str.Split(':')[3]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T21:55:34.443

```
var finalNumber = input.Split(new char[] { ':' }, StringSplitOptions.RemoveEmptyEntries)
                       .Last() 
```

此代码会将您的输入字符串拆分为字符串，用分隔符分隔`:`（从序列的开头和结尾删除空字符串）。并返回最后一个字符串，即您的 finalNumber。

# kml - 在 Google 地球上移动 3D 模型

> ID：13223323
> 
> 赞同：0
> 
> 时间：2012-11-04T21:52:08.977
> 
> 标签：kml, latitude-longitude, google-earth-plugin, 3d-model

我正在研究一个 KML 文件，用于通过插值（平滑）在空间中移动模型。

我开发了以下代码，但它不起作用。有什么建议吗？

```
<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2"
xmlns:gx="http://www.google.com/kml/ext/2.2">
<Placemark>
  <name>SketchUp Model</name>
  <description>University.</description>
  <LookAt>
    <longitude>12.491456</longitude>
    <latitude>41.889687</latitude>
    <altitude>6</altitude>
    <range>127.2393107680517</range>
    <tilt>65.74454495876547</tilt>
    <heading>-27.70337734057933</heading>
  </LookAt>    
</Placemark>
<Folder>
<name>Arrivals</name>
<Placemark>
 <name>Modello</name>
   <description>University of Colorado</description>         
     <gx:Track>
   <altitudeMode>relativeToGround</altitudeMode>              
   <when>2010-05-01T13:00:00-05</when>
   <when>2010-05-01T13:00:04-05</when>
   <when>2010-05-01T13:00:08-05</when>
   <when>2010-05-01T13:00:12-05</when>
   <when>2010-05-01T13:00:16-05</when>
   <gx:coord>12.491436 41.889687 0</gx:coord>
   <gx:coord>12.491456 41.889657 0</gx:coord>
   <gx:coord>12.491446 41.889667 0</gx:coord>
   <gx:coord>12.491426 41.889617 0</gx:coord>
   <gx:coord>12.491466 41.889627 0</gx:coord>
   <gx:angles>20 0 0</gx:angles>
   <gx:angles>20 0 0</gx:angles>
   <gx:angles>20 0 0</gx:angles>
   <gx:angles>20 0 0</gx:angles>
   <gx:angles>20 0 0</gx:angles>
   <Model>
      <altitudeMode>relativeToGround</altitudeMode>
      <Location>
          <longitude>12.491456</longitude>
          <latitude>41.889687</latitude>
          <altitude>2</altitude>
      </Location>
      <Orientation>
          <heading>0</heading>
          <tilt>0</tilt>
          <roll>0</roll>
      </Orientation>
      <Scale>
          <x>1.0</x>
          <y>1.0</y>
          <z>1.0</z>
      </Scale>
      <Link>
          <href>models/Citizen Extras_Male 03.dae</href>
      </Link>
</Model>
</gx:Track> 
</Placemark>
</Folder>
</kml> 
```

当我使用 fetchKml(...) 加载 html 文件时，没有任何反应。我只在太空中看到地球...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T12:50:17.563

如果您想在 Google 地球中为任何模型制作动画，您应该看到以下示例： [http](http://www.barnabu.co.uk/geapi/bounce/) ://www.barnabu.co.uk/geapi/bounce/ http://earth-api-samples.googlecode.com/svn/trunk /examples/event-frameend.html 我知道动画模型的唯一方法是使用 KML Tours 或使用 frameend 事件

# java - 如何编写一个测试友好的不可变值类？

> ID：13223337
> 
> 赞同：2
> 
> 时间：2012-11-04T21:54:10.203
> 
> 标签：java, testing, mocking, immutability

我标记了一个不可变数据模型类，`final`以确保更改其值的唯一方法是创建一个新实例。（不幸的是，这些字段不能是最终的，因为它们需要由 Hibernate 填充。）

这工作得很好，直到我想检查另一个类在使用无效的模型实例调用时抛出正确的异常。模型的构造函数验证参数，因此必须使用反射来设置字段。这是非常笨拙的，因为模型有很多字段并且字段名称必须是硬编码的。

由于它是最终模型，我也无法模拟该模型。（是否应该使用接口来启用模拟同时保持类不可变是否也值得商榷。通过使用接口，没有办法以编程方式强制方法必须在实例的整个生命周期中返回相同的值。）

在这种情况下，人们通常会怎么做？有什么标准的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T02:30:55.197

一般来说，您不应该模拟数据对象。数据对象应该没有逻辑，也没有外部依赖，所以模拟对象并没有多大用处。相反，可以很容易地创建假实例，您可以根据需要在方法中填充这些实例。

此外，您可能希望避免将 Hibernate 持久对象视为不可变的其他一些原因：

*   Hibernate 提供的对象本质上[不是线程安全的](https://developer.atlassian.com/display/CONFDEV/Hibernate+Sessions+and+Transaction+Management+Guidelines#HibernateSessionsandTransactionManagementGuidelines-Multi-threading)，因此失去了不可变值对象通常提供的线程安全优势。
*   您可能会发现您的对象实际上是[代理](https://stackoverflow.com/questions/2594804/why-is-hibernate-returning-a-proxy-object)，可能会削弱`final`语义。
*   Hibernate 控制的对象的操作完全不同[，无论它们的会话是否仍然打开](http://docs.jboss.org/hibernate/orm/3.6/javadocs/org/hibernate/Session.html)（附加与分离），这使得它们对于不可变对象来说是一个非常糟糕的选择。如果您的不可变对象依赖于会话生命周期，那么它并不是真正不可变的。
*   听起来有些对象可能在应用程序层有效或无效，超出了数据库层验证。这使得封装您的验证问题变得更加困难。
*   您需要有一个公共的无参数构造函数，这与不可变值对象的典型实例控制类型是对立的。
*   因为对象本质上是可变的，所以[覆盖 equals 和 hashCode](https://stackoverflow.com/a/1638886/1426891)更加复杂。

* * *

我的建议？如果您需要比 Hibernate DAO 提供的更多的不变性和数据验证保证，那么创建一个具有最终字段（或私有构造函数和静态工厂方法）的*真正的*最终不可变类，然后创建一个构造函数（或静态工厂方法）从您的 Hibernate DAO 复制值。

*如果您决定使用此选项，您将面临两个*大致并行更改的数据对象的开销，但您还可以获得分离关注点的好处（以防 Hibernate 对象应该发散）和真正不可变的易用性， equals-and-hashcode-overriding、session-agnostic、保证有效的对象，您可以轻松地为测试创建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T02:34:16.060

为清楚起见，将类设为 final 可以防止它被子类化。这在类不需要进一步细化的情况下很好。

将类级别变量标记为 final 意味着它只会被分配一次。对于像 String 这样的原语和不可变对象，这具有使变量不可变（默认情况下）的副作用。

但是，对于像 Date 这样的可变对象，您的变量将始终引用同一个实例，但其他有权访问该实例的人仍然能够更改它的状态。例如，如果你有一个方法

```
public Date getCreatedDate(){
     return this.created; // class variable declared as private final Date created...;
} 
```

然后任何调用者都可以访问创建的实例并更改它的状态。您最好只返回真正不可变的值，或者返回一个克隆。

```
public Date getCreatedDate(){
     return this.created.clone();
} 
```

**编辑**

> “我将不可变数据模型类标记为 final，以确保更改其值的唯一方法是创建一个新实例”

据我了解，您的问题是 A 类依赖于 B 类。您希望测试 A 类并且您无法模拟 B 类，因为您已将其标记为最终。您将 Class B 标记为 final 以使其不可变（防止其内部状态被更改）。这是不正确的，因为将类标记为 final 会阻止它被子类化。它与更改实例内部状态的能力无关。

您对 final 的使用没有达到预期的效果。将字段标记为 final 不是一种选择，并且由于上述原因不会使类不可变。保护数据的唯一方法是防止数据的客户端访问构成其内部状态的对象。

假设您不是唯一的开发人员，您需要保护数据的用户免受意外更新。确保从 getter 返回克隆是一种方法。让团队成员子类和更改数据只是糟糕的编程，不是无意的，并且可以通过策略和代码审查来管理。

如果您希望保护您的代码免受未知开发人员的外部干扰（例如编写使用相同命名空间来注入其代码的代码），则可以使用其他方法，例如包密封。

# android - 获取上下文的 Android 意图

> ID：13223342
> 
> 赞同：-1
> 
> 时间：2012-11-04T21:54:33.603
> 
> 标签：android, android-intent

我只是好奇下面的代码是做什么的？我目前正在学习 Intents。

```
Intent i = new Intent(v.getContext(), Viewmap.class); 
```

我是否认为这是在创建一个 Intent 对象，它将启动 Viewmap 类，并且 getContext() 方法将通知 Viewmap 类意图来自哪里？我想我对 v.getContext 实际上在做什么感到更加困惑。（v 是视图对象）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T21:58:43.027

> 我只是好奇下面的代码是做什么的？

它创建一个[`Intent`](http://developer.android.com/reference/android/content/Intent.html)从[`Context`](http://developer.android.com/reference/android/content/Context.html)包含启动的`v`. this`Intent`的目标是`Viewmap`的类（在这种情况下，它应该是`Activity`在清单中注册的）。

> 我是否认为这是在创建一个 Intent 对象，它将启动 Viewmap 类，并且 getContext() 方法将通知 Viewmap 类意图来自哪里？

关闭。您提供的`Context`通知系统可以在哪个包中找到`Viewmap`该类。

> 我想我对 v.getContext 实际上在做什么感到更加困惑。

`Context`它只是返回`v`实现的方式。`Context`包含包名称、资源标识符等内容。该文档将其描述为一个“ *[i]关于应用程序环境的全局信息的接口。......它允许访问特定于应用程序的资源和类，以及对应用程序级操作的调用，例如启动活动、广播和接收意图等*”。

# css - 放大/缩小时 CSS 布局中断

> ID：13223351
> 
> 赞同：1
> 
> 时间：2012-11-04T21:55:39.363
> 
> 标签：css

我是一名自学成才的网页设计师，拥有惊人的 3 个网站左右。我刚刚为一位朋友完成了网站的第一页，因此比“真正的”客户更有耐心。

我喜欢这些网站的外观，它在流行浏览器的范围内相当一致，总的来说，我对此感到非常自豪，直到我意识到一个主要问题，说实话，离让我放弃成为我的梦想只有两步之遥网页设计师。

使用 Chrome、Safari 或旧版本的 Explorer 时，如果有人将缩放设置为 100% 以外的任何值，网站的布局就会崩溃。

这让我沮丧到近乎抑郁的地步。我使用了一个 div 来包围整个主体，并且页面布局，在这种情况下是一个 MENU，几乎完全由绝对定位的 UL（无序列表）完成。

该网站的组成方式使所有部分都连接在一起（几乎就像一个谜题），如果某些部分不合时宜，那是非常明显的。

我听到放大的数字，可能会在这里和那里需要几个低 alpha 像素，但在我的情况下，一些块元素实际上是 25-50 像素不合适的。

[http://www.stevemarcella.com](http://www.stevemarcella.com)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:01:49.767

还没有必要让你的梦想破灭：> 总有希望。

您应该做的第一件事是检查所有错误，根据验证器，主页上有 536 个错误。我建议您运行验证器并一一纠正错误。它可以解决你的问题。我注意到的第一个错误是您在正文之外有一个 div 元素。您应该将所有内容都保留在正文标签中。

这是在身体之外。

```
<div class="wrapAroundBody" id="IdWrappingWholeBody"> 
```

希望能帮助到你。

# .net - 关于新的 EF5 自动编译查询功能

> ID：13223353
> 
> 赞同：6
> 
> 时间：2012-11-04T21:55:53.730
> 
> 标签：.net, entity-framework, entity-framework-5

我对新的 EF5 自动编译查询功能进行了一些测试。问题是我看不出性能上有什么不同。

我使用 .NET 4.0 和 EF4.0 制作了一个项目，但没有使用编译查询。我用 .NET 4.0 和 EF4.0 编写了另一个带有编译查询的项目——性能提高了 50%。

然后我尝试使用EF 5.0创建一个项目，其中性能基本没有差异。

所有项目都是 asp.net mvc（前两个是版本 3，最后一个是版本 4）。

我在这里错过了什么吗？我需要做一些特别的事情来启用自动编译功能吗？我刚刚创建了带有预构建 EF5 的 MVC 4 项目。

我正在测试的查询相当冗长，里面有三个连接和多个过滤器。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T00:14:09.630

自动编译的查询在 .NET Framework 4.5 中的 EF5 部分可用。如果您在 .NET Framework 4 上运行 EF5，则不会自动编译查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T08:43:44.467

帕维尔，

谢谢回答。实际上，我从 MS 站点下载了 .NET 4.5：

[http://www.microsoft.com/en-us/download/details.aspx?id=30653](http://www.microsoft.com/en-us/download/details.aspx?id=30653)

我安装了它，我还在 Visual Studio 的项目选项卡中设置了 .NET 4.5 目标并设置了它。但是当我查看程序集时，它们都是 4.0 。

我不确定为什么会这样。

我还升级到了 EF 6.0 alpha。

仍然绝对没有性能提升。

# java - Java - 查找像素序列

> ID：13223354
> 
> 赞同：0
> 
> 时间：2012-11-04T21:55:53.450
> 
> 标签：java

只是想知道如何检查每个像素，从屏幕顶部到底部（或只是一个 500x500 矩形）中的像素图案。示例查看所有像素，并查看是否有 20 个连续的红色像素（在屏幕上搜索红色框）。对不起，糟糕的描述，让我知道，我会尽量让它更具体。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:03:45.693

您正在尝试做的是在图像处理社区中称为[模板匹配，您应该首先检查一下。](http://en.wikipedia.org/wiki/Template_matching)

对于实现部分，您可以访问`BufferedImage`（使用`getRGB/getRGBs`方法）的像素，或者如果您想做任何严肃的事情，您可以使用 JAI 或 JavaCV 更好。

# java - Java - 包含同一超类的一组不同子类的数据结构

> ID：13223357
> 
> 赞同：2
> 
> 时间：2012-11-04T21:55:57.780
> 
> 标签：java, class, data-structures, superclass

我需要某种可以包含同一个超类的异构子类的数据结构，所有这些都是我自己实现的。

到目前为止，我试图拥有一个`ArrayList<SuperClass> list = new ArrayList<SuperClass>();` 然后，我假设我将能够将列表的每个插槽转换为任何一个子类，但这并不是那么好。

我需要一种有效的方法来完成上述工作。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T22:05:34.537

您可以使用任何存在的数据结构来完成，我建议使用 a`List`或 a `Set`。例如：

```
Collection<Super> supers = new ArrayList<Super>(); 
```

现在当你这样说：

> 我假设我将能够将列表的每个插槽转换为任何一个子类，

这是一个无效的假设。该集合将包含任何扩展的对象，`Super`但是您不能将每个元素任意转换为您想要的任何对象。`instanceof`如果您正在寻找该类型的功能，则 需要对每个元素进行测试，示例如下：

```
for(Super currentSuper : supers)  
{  
    if(currentSuper instanceof SubA)  
    {  
         SubA subA = (Suba) currentSuper);  
         // do stuff with subA
    }  
    else if(currentSuper instanceof SubB)  
    {  
         SubB subB = (SubB) currentSuper);  
         // do stuff with subB
    } 
} 
```

视需要而定。

现在关于弗拉德：

> 更好的设计不是测试实际的类是什么，而只是调用一个虚拟方法，无论如何它都会做正确的事情

如果您可以保证所有潜在子类的功能并且对覆盖您的类的人没有任何问题（如果您没有将它们标记为最终），则不需要进行测试实例。相反，您的代码可能很简单：

```
for(Super currentSuper : supers)  
{  
    currentSuper.doSomethingNifty();
} 
```

# python - python按周或月拆分熊猫数据框，并根据这些sp对数据进行分组

> ID：13223360
> 
> 赞同：2
> 
> 时间：2012-11-04T21:56:14.953
> 
> 标签：python, datetime, group-by, dataframe, pandas

```
DateOccurred    CostCentre  TimeDifference
03/09/2012  2073    28138
03/09/2012  6078    34844
03/09/2012  8273    31215
03/09/2012  8367    28160
03/09/2012  8959    32037
03/09/2012  9292    30118
03/09/2012  9532    34200
03/09/2012  9705    27240
03/09/2012  10085   31431
03/09/2012  10220   22555
04/09/2012  6078    41126
04/09/2012  7569    31101
04/09/2012  8273    30994
04/09/2012  8959    30064
04/09/2012  9532    34655
04/09/2012  9705    26475
04/09/2012  10085   31443
04/09/2012  10220   33970
05/09/2012  2073    28221
05/09/2012  6078    27894
05/09/2012  7569    29012
05/09/2012  8239    42208
05/09/2012  8273    31128
05/09/2012  8367    27993
05/09/2012  8959    20669
05/09/2012  9292    33070
05/09/2012  9532    8189
05/09/2012  9705    27540
05/09/2012  10085   28798
05/09/2012  10220   23164
06/09/2012  2073    28350
06/09/2012  6078    35648
06/09/2012  7042    27129
06/09/2012  7569    31546
06/09/2012  8239    39945
06/09/2012  8273    31107
06/09/2012  8367    27795
06/09/2012  9292    32974
06/09/2012  9532    30320
06/09/2012  9705    37462
06/09/2012  10085   31703
06/09/2012  10220   7807
06/09/2012  14573   186
07/09/2012  0   0
07/09/2012  0   0
07/09/2012  2073    28036
07/09/2012  6078    31969
07/09/2012  7569    32941
07/09/2012  8273    30073
07/09/2012  8367    29391
07/09/2012  9292    31927
07/09/2012  9532    30127
07/09/2012  9705    27604
07/09/2012  10085   28108
08/09/2012  2073    28463
10/09/2012  6078    31266
10/09/2012  8239    16390
10/09/2012  8273    31140
10/09/2012  8959    30858
10/09/2012  9532    30794
10/09/2012  9705    28752
11/09/2012  0   0
11/09/2012  0   0
11/09/2012  0   0
11/09/2012  0   0
11/09/2012  0   0
11/09/2012  2073    28159
11/09/2012  6078    36835
11/09/2012  8239    45354
11/09/2012  8273    30922
11/09/2012  8367    31382
11/09/2012  8959    29670
11/09/2012  9292    33582
11/09/2012  9705    29394
11/09/2012  10085   17140
12/09/2012  2073    28283
12/09/2012  6078    31139
12/09/2012  7042    35063
12/09/2012  8273    31075
12/09/2012  8367    29795
12/09/2012  9292    33496
12/09/2012  9532    31669
12/09/2012  9705    26166
12/09/2012  10085   29889
12/09/2012  10220   35656
13/09/2012  2073    28144
13/09/2012  6078    30544
13/09/2012  7097    30866
13/09/2012  8273    30772
13/09/2012  8367    32387
13/09/2012  8959    29307
13/09/2012  9292    32348
13/09/2012  9532    28137
13/09/2012  9705    28823
13/09/2012  10085   31543
13/09/2012  10220   28293
14/09/2012  0   12433
14/09/2012  0   12434
14/09/2012  0   12434
14/09/2012  0   12434
14/09/2012  0   12434
14/09/2012  0   0
14/09/2012  0   0
14/09/2012  0   0
14/09/2012  0   12433
14/09/2012  0   0
14/09/2012  0   12433
14/09/2012  0   0
14/09/2012  0   0
14/09/2012  0   0
14/09/2012  0   0
14/09/2012  0   0
14/09/2012  0   0
14/09/2012  0   0
14/09/2012  0   0
14/09/2012  0   0
14/09/2012  0   0
14/09/2012  0   0
14/09/2012  0   0
14/09/2012  0   0
14/09/2012  0   0
14/09/2012  0   0
14/09/2012  0   0
14/09/2012  0   1720
14/09/2012  0   0
14/09/2012  0   0
14/09/2012  0   0
14/09/2012  0   0
14/09/2012  0   0
14/09/2012  0   0
14/09/2012  0   0
14/09/2012  0   384
14/09/2012  0   0
14/09/2012  0   0
14/09/2012  0   0
14/09/2012  0   383
14/09/2012  2073    28438
14/09/2012  6078    27255
14/09/2012  8273    29989
14/09/2012  8959    26892
14/09/2012  9292    33202
14/09/2012  9532    30862
14/09/2012  9705    26857
14/09/2012  10085   32657
14/09/2012  10220   27296
15/09/2012  6078    3832
17/09/2012  6078    30004
17/09/2012  7569    30390
17/09/2012  8239    41421
17/09/2012  8273    26337
17/09/2012  8367    31631
17/09/2012  8959    17989
17/09/2012  9292    35703
17/09/2012  9532    36542
17/09/2012  9705    27488
17/09/2012  10085   30849
17/09/2012  10220   32575
18/09/2012  2073    28293
18/09/2012  6078    27450
18/09/2012  7569    30323
18/09/2012  8239    38481
18/09/2012  8273    31154
18/09/2012  8367    27944
18/09/2012  8959    28196
18/09/2012  9292    30844
18/09/2012  9532    33128
18/09/2012  9705    32100
19/09/2012  2073    28227
19/09/2012  6078    32243
19/09/2012  7569    29041
19/09/2012  8239    42791
19/09/2012  8273    30966
19/09/2012  8367    26420
19/09/2012  8959    29394
19/09/2012  9292    14865
19/09/2012  9532    23618
19/09/2012  10085   31614
19/09/2012  10220   8686
20/09/2012  2073    28260
20/09/2012  6078    30446
20/09/2012  7097    34909
20/09/2012  7569    30869
20/09/2012  8273    31079
20/09/2012  8367    30162
20/09/2012  9292    13104
20/09/2012  9532    36614
20/09/2012  9705    35617
20/09/2012  10085   31821
20/09/2012  10220   30055
20/09/2012  14573   468
21/09/2012  0   0
21/09/2012  0   0
21/09/2012  0   0
21/09/2012  0   0
21/09/2012  0   0
21/09/2012  0   0
21/09/2012  0   0
21/09/2012  0   0
21/09/2012  0   0
21/09/2012  0   3
21/09/2012  0   0
21/09/2012  0   0
21/09/2012  0   3
21/09/2012  2073    28308
21/09/2012  6078    33833
21/09/2012  7569    32335
21/09/2012  9292    33824
21/09/2012  9532    33376
21/09/2012  10220   21002
22/09/2012  2073    28402
23/09/2012  2073    28109
24/09/2012  2073    28431
24/09/2012  6078    30027
24/09/2012  7097    31914
24/09/2012  8239    35617
24/09/2012  8273    30670
24/09/2012  8367    29084
24/09/2012  8959    31023
24/09/2012  9292    34394
24/09/2012  9532    31255
24/09/2012  9705    18758
24/09/2012  10085   29290
24/09/2012  10220   33230
25/09/2012  2073    28506
25/09/2012  6078    32043
25/09/2012  7042    34953
25/09/2012  7569    30898
25/09/2012  8239    41297
25/09/2012  8273    31012
25/09/2012  8367    29645
25/09/2012  8959    29904
25/09/2012  9532    37875
25/09/2012  9705    13280
25/09/2012  10085   35023
25/09/2012  10220   31359
26/09/2012  2073    28388
26/09/2012  6078    29765
26/09/2012  7097    31561
26/09/2012  7569    29151
26/09/2012  8239    40369
26/09/2012  8367    28174
26/09/2012  8959    26554
26/09/2012  9292    32104
26/09/2012  9532    33194
26/09/2012  9705    30377
26/09/2012  10085   31503
26/09/2012  10220   28310
27/09/2012  0   0
27/09/2012  0   0
27/09/2012  0   0
27/09/2012  0   0
27/09/2012  0   0
27/09/2012  0   0
27/09/2012  0   0
27/09/2012  0   0
27/09/2012  2073    28491
27/09/2012  6078    31137
27/09/2012  8239    38403
27/09/2012  8273    31117
27/09/2012  8367    28462
27/09/2012  9292    32387
27/09/2012  9532    23023
27/09/2012  9705    32790
27/09/2012  10085   33460
27/09/2012  10220   31782
28/09/2012  0   161
28/09/2012  2073    28381
28/09/2012  7569    32322
28/09/2012  8239    38362
28/09/2012  8273    30533
28/09/2012  8959    17128
28/09/2012  9292    32484
28/09/2012  9532    18586
28/09/2012  9705    27902
29/09/2012  2073    28583 
```

1.  以上是具有一百万条记录的数据框的示例
2.  ***如何按周或月对其进行切片或分组，并按成本中心对秒列求和。？********
3.  我已经阅读/尝试了本网站上的 30 篇文章，这些文章是通过搜索
    列表项 pandas、python、groupby、split、dataframe、week 出现的，但均未成功。
4.  我正在使用 python 2.7 和 pandas 0.9。
5.  我已阅读 pandas 0.9 教程中的时间序列/日期功能部分，但无法使用数据框进行任何操作。我想使用那里的功能，例如商业周刊

**预期产出**

```
DateOccurred CostCentre TimeDifference
2012-03-11            0         500000
2012-03-11         2073         570000
2012-03-18            0         650000
2012-03-18         2073         425000 
2012-03-25            0         378000
2012-04-25         2073         480000 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T18:10:44.570

这是一种获取您的输入（作为文本）并按照您想要的方式对其进行分组的方法。关键是为每个分组（日期，然后是中心）使用字典。

```
import collections
import datetime
import functools

def delta_totals_by_date_and_centre(in_file):
    # Use a defaultdict instead of a normal dict so that missing values are
    # automatically created. by_date is a mapping (dict) from a tuple of (year, week)
    # to another mapping (dict) from centre to total delta time.
    by_date = collections.defaultdict(functools.partial(collections.defaultdict, int))

    # For each line in the input...
    for line in in_file:
        # Parse the three fields of each line into date, int ,int.
        date, centre, delta = line.split()
        date = datetime.datetime.strptime(date, "%d/%m/%Y").date()
        centre = int(centre)
        delta = int(delta)

        # Determine the year and week of the year.
        year, week, weekday = date.isocalendar()
        year_and_week = year, week

        # Add the time delta.
        by_date[year_and_week][centre] += delta

    # Yield each result, in order.
    for year_and_week, by_centre in sorted(by_date.items()):
        for centre, delta in sorted(by_centre.items()):
            yield year_and_week, centre, delta 
```

对于您的示例输入，它会生成此输出（第一列是`year-week_of_the_year`）。

```
2012-36     0      0
2012-36  2073 141208
2012-36  6078 171481
2012-36  7042  27129
2012-36  7569 124600
2012-36  8239  82153
2012-36  8273 154517
2012-36  8367 113339
2012-36  8959  82770
2012-36  9292 128089
2012-36  9532 137491
2012-36  9705 146321
2012-36 10085 151483
2012-36 10220  87496
2012-36 14573    186
2012-37     0  89522
2012-37  2073 113024
2012-37  6078 160871
2012-37  7042  35063
2012-37  7097  30866
2012-37  8239  61744
2012-37  8273 153898
2012-37  8367  93564
2012-37  8959 116727
2012-37  9292 132628
2012-37  9532 121462
2012-37  9705 139992
2012-37 10085 111229
2012-37 10220  91245
2012-38     0      6
2012-38  2073 169599
2012-38  6078 153976
2012-38  7097  34909
2012-38  7569 152958
2012-38  8239 122693
2012-38  8273 119536
2012-38  8367 116157
2012-38  8959  75579
2012-38  9292 128340
2012-38  9532 163278
2012-38  9705  95205
2012-38 10085  94284
2012-38 10220  92318
2012-38 14573    468
2012-39     0    161
2012-39  2073 170780
2012-39  6078 122972
2012-39  7042  34953
2012-39  7097  63475
2012-39  7569  92371
2012-39  8239 194048
2012-39  8273 123332
2012-39  8367 115365
2012-39  8959 104609
2012-39  9292 131369
2012-39  9532 143933
2012-39  9705 123107
2012-39 10085 129276
2012-39 10220 124681 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T03:32:14.207

也许先按 CostCentre 分组，然后使用 Series/DataFrame `resample()`？

```
In [72]: centers = {}

In [73]: for center, idx in df.groupby("CostCentre").groups.iteritems():
   ....:     timediff = df.ix[idx].set_index("Date")['TimeDifference']
   ....:     centers[center] = timediff.resample("W", how=sum)

In [77]: pd.concat(centers, names=['CostCentre'])
Out[77]: 
CostCentre  Date      
0           2012-09-09         0
            2012-09-16     89522
            2012-09-23         6
            2012-09-30       161
2073        2012-09-09    141208
            2012-09-16    113024
            2012-09-23    169599
            2012-09-30    170780
6078        2012-09-09    171481
            2012-09-16    160871
            2012-09-23    153976
            2012-09-30    122972 
```

**额外细节：**

当`parse_dates`用于`True`pd.read_* 函数时，`index_col`也必须设置。

```
In [28]: df = pd.read_clipboard(sep=' +', parse_dates=True, index_col=0,
   ....:                        dayfirst=True)

In [30]: df.head()
Out[30]: 
              CostCentre  TimeDifference
DateOccurred                            
2012-09-03          2073           28138
2012-09-03          6078           34844
2012-09-03          8273           31215
2012-09-03          8367           28160
2012-09-03          8959           32037 
```

由于 resample() 需要一个 TimeSeries 索引的帧/系列，因此在创建期间设置索引消除了为每个组单独设置索引的需要。GroupBy 对象也有一个 apply 方法，它基本上是围绕上面使用 pd.concat() 完成的“组合”步骤的语法糖。

```
In [37]: x = df.groupby("CostCentre").apply(lambda df: 
   ....:         df['TimeDifference'].resample("W", how=sum))

In [38]: x.head(12)
Out[38]: 
CostCentre  DateOccurred
0           2012-09-09           0
            2012-09-16       89522
            2012-09-23           6
            2012-09-30         161
2073        2012-09-09      141208
            2012-09-16      113024
            2012-09-23      169599
            2012-09-30      170780
6078        2012-09-09      171481
            2012-09-16      160871
            2012-09-23      153976
            2012-09-30      122972 
```

# facebook - 向在我的网站上点赞链接的 Facebook 用户发布更新

> ID：13223361
> 
> 赞同：0
> 
> 时间：2012-11-04T21:56:21.017
> 
> 标签：facebook, facebook-graph-api, facebook-like

我试图弄清楚如何到达一个可以与那些“喜欢”我网站上的链接的人互动的地方。我在 Stack 上看过这两篇文章，但它们对我没有帮助。

[Facebook Like 按钮 + Open Graph + 网站 = 推送点赞更新？](https://stackoverflow.com/questions/11582321/facebook-like-button-open-graph-website-pushing-updates-to-likes)

[Facebook 上没有“管理页面”链接 网页上的“赞”按钮](https://stackoverflow.com/questions/8451158/no-admin-page-link-on-facebook-like-button-on-a-web-page)

我感觉上面的第二个链接对于新的 Facebook 来说已经不是最新的了。

我的网站是[http://www.UpcomingEvents.com](http://www.UpcomingEvents.com)。

任何帮助将不胜感激！！我们有一些非常喜欢的网址，如果能够向感兴趣的人提供信息，那就太好了。

提前致谢！

丹尼斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:53:08.697

我必须说，幸运的是，这已经不可能了。我不想仅仅因为我喜欢网站上的一篇文章/页面而突然在我的 Facebook 流中获取内容。

这是信息： [https ://developers.facebook.com/docs/reference/plugins/like/migration/](https://developers.facebook.com/docs/reference/plugins/like/migration/)

> 弃用此管理页面后，开发人员将无法再向单击特定“赞”按钮的用户发布更新。用于发布赞按钮更新的 REST 端点也将被弃用。

# python - 试图在python中只打印一行文本文档

> ID：13223363
> 
> 赞同：-1
> 
> 时间：2012-11-04T21:56:27.767
> 
> 标签：python, file, text

我正在制作一个程序，可以让您在 python 中编辑或阅读文本文档，但我还没有完成，我被困在阅读部分。我希望它只打印一行，而我正在为如何做到这一点画一个空白。读取部分在“def read():”中

```
def menu():
    print("What would you like to do?")
    print("\n(1) Write new text")
    print("(2) Read line 3")
    choice = float(input())
    if choice == 1:
        write()
    elif choice == 2:
        read()

def read():
    with open('test.txt', 'r') as read:
        print()

def write():
    print("\nType the full name of the file you wish to write in.")
    file1 = input().strip()
    with open(file1, "a") as add:
        print("What do you want to write?")
        text = input()
        add.write("\n"+ text)

menu() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T21:57:53.843

```
def read():
    with open('test.txt', 'r') as f:
        for line in f:
            print(line) 
```

* * *

### 编辑：

```
def read():
    with open('test.txt', 'r') as f:
        lines = f.readlines()
        print lines[1] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T22:06:03.167

您可以将该文件用作可迭代文件，并对其进行循环，或者您可以调用`.next()`它以一次推进一行。

如果您需要阅读 1 条特定的行，这意味着您可以在使用`.next()`调用之前跳过这些行：

```
def read():
    with open('test.txt', 'r') as f:
        for _ in range(2):
            f.next()  # skip lines

        print(f.next())  # print the 3rd line 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-05T21:43:54.533

因为我不使用'def'函数，所以我很晚才发现我的，但这会打印出你想要打印的行

```
import os.path

bars = open('bars.txt', 'r')
first_line = bars.readlines()
length = len(first_line)
bars.close()
print(first_line[2]) 
```

# iphone - 滚动视图如何像涂鸦跳跃或爸爸跳跃一样工作？

> ID：13223365
> 
> 赞同：0
> 
> 时间：2012-11-04T21:56:43.697
> 
> 标签：iphone, xcode, uiscrollview

我正在制作一个无尽类型的游戏，其中视图滚动类似于涂鸦跳跃，除了它垂直向下滚动而不是垂直向上滚动。你如何做到这一点？我应该设置滚动视图并使用手动滚动的方法吗？我只是觉得这会在一段时间后导致内存泄漏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:12:39.920

这不是 ScrollVIew，这只是 OpenGL，或基于它的框架（如前面提到的 Cocos2D）

# c - 系统命令 rm 在期望程序中不起作用

> ID：13223369
> 
> 赞同：0
> 
> 时间：2012-11-04T21:57:13.803
> 
> 标签：c, linux, bash, expect, rm

我有一个代码（1）应该在另一个代码中执行测试（它是一个伪 bash）。此代码 (1) 是使用“用户模拟”的“期望”编写的。

问题是当这段代码（1）执行一个系统（在这种情况下，系统“rm totoExpect.txttitiExpect.txt”）时，它只是没有找到titiExpected.txt，但是在那里！

这两个文件没有什么不同，即使权限相同，我也想不出一个不起作用的原因。

这是出现问题的代码 (1) 部分：

```
# test 5
proc t5 {} {
    send "ls > totoExpect.txt\r"
    send "cat < totoExpect.txt | wc -l > titiExpect.txt\r"
    send "cat titiExpect.txt\r"
    expect -re "(0|1|2|3|4|5|6|7|8|9)+.*>" { ok 5; } default { abort 5 }
    system "rm totoExpect.txt titiExpect.txt"
} 
```

和错误信息：

```
ls > totoExpect.txt
out: totoExpect.txt
seq[0]: 'ls' 
-----3
ensishell>c
 ***** TEST 5 ok

rm: não foi possível remover "titiExpect.txt": Arquivo ou diretório não encontrado
child process exited abnormally
    while executing
"system "rm totoExpect.txt titiExpect.txt""
    (procedure "t5" line 6)
    invoked from within
"t5"
    ("eval" body line 1)
    invoked from within
"eval "t$t;" "
    ("foreach" body line 1)
    invoked from within
"foreach t {0 1 2 3 4 5 6 7} { eval "t$t;" } "
    invoked from within
"expect_user {
    -timeout 30 "auto\n" {
    puts "AUTO:\n";
    foreach t {0 1 2 3 4 5 6 7} { eval "t$t;" } 
    }
    -timeout 30 -re "(\[0123456789 \]+)\..."
    (file "./testshell.expect" line 99)
make: ** [test] Erro 1 
```

其中“rm: não foi possível remover "titiExpect.txt": Arquivo ou diretório não encontrado" 的意思是“rm: it is not possible to remove "titiExpect.txt": file or directory not found”（抱歉...）

这是错误消息之后的 ls -l （所以titiExpect.txt 不应该在那里）：

```
-rwxrwxr-x   1 fernando       fernando    273 Out 23 17:53 #Makefile#
-rwxrwxr-x   1 fernando       fernando   6238 Nov  5 21:18 #ensishell.c#
-rwxrwxr-x   1 fernando       fernando   1271 Out 24 20:30 #readcmd.h#
-rwxrwxr-x   1 fernando       fernando   3250 Nov  5 21:07 #testshell.expect#
-rwxrwxrwx   1 fernando       fernando    303 Out 24 20:21 Makefile
drwxrwxr-x   2 fernando       fernando   4096 Nov  4 19:06 SEPC shell
-rw-rw-r--   1 fernando       fernando 193453 Out 18 18:25 Sujet_shell.pdf
-rwxrwxr-x   1 fernando       fernando  25451 Nov  5 21:17 ensishell
-rwxrwxrwx   1 fernando       fernando   6238 Nov  5 20:32 ensishell.c
-rw-rw-r--   1 fernando       fernando  10664 Nov  5 21:17 ensishell.o
-rwxrwxr-x   1 fernando       fernando   7251 Nov  4 00:33 foo
-rw-rw-r--   1 fernando       fernando    173 Nov  4 00:33 foo.c
-rw-rw-r--   1 fernando       fernando     16 Nov  4 01:15 in.txt~
-rwxrwxrwx   1 fernando       fernando   6603 Out 23 00:37 readcmd.c
-rwxrwxrwx   1 fernando       fernando   1271 Out 23 01:24 readcmd.h
-rwxrwxrwx   1 fernando       fernando   1271 Out 23 00:37 readcmd.h~
-rw-rw-r--   1 fernando       fernando  11216 Nov  5 21:17 readcmd.o
-rwxrwxrwx   1 fernando       fernando   3250 Nov  5 20:41 testshell.expect
-rwx------   1 fernando       fernando   1263 Nov  5 12:43 toto.txt 
```

最糟糕的问题是这段代码不应该被修改，但在我看来，这是失败的程序错误。（实际上，注释行解决问题..）

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T03:16:57.853

看。

```
# test 5
proc t5 {} {
    send "ls > totoExpect.txt\r"
    send "cat < totoExpect.txt | wc -l > titiExpect.txt\r"
    send "cat titiExpect.txt\r"
    expect -re "(0|1|2|3|4|5|6|7|8|9)+.*>" { ok 5; } default { abort 5 }
    system "rm totoExpect.txt titiExpect.txt"
} 
```

第一个`send`板条箱创建一个名为`totoExpect.txt\r`.

第二个`send`生成一个名为`titiExpect.txt\r`. 该`cat`部分实际上失败了，因为没有 file `totoExpect.txt`，但是由于该命令是管道的一部分，而不是所述管道中的最后一个命令，因此 expect 不会将其视为错误。（你会看到`titiExpect.txt\r`文件是空的。）

以上`\r`是CR字符，可能是你错过的原因。在 Linux 中，文件名中完全允许使用字符（仅`/`作为`\0`禁止使用）。只需将其从测试中删除，您就会发现它工作正常。

或者，如果您坚持保留它，请始终保持它：

```
# test 5
proc t5 {} {
    send "ls > totoExpect.txt\r"
    send "cat < totoExpect.txt\r | wc -l > titiExpect.txt\r"
    send "cat titiExpect.txt\r"
    expect -re "(0|1|2|3|4|5|6|7|8|9)+.*>" { ok 5; } default { abort 5 }
    system "rm totoExpect.txt\r titiExpect.txt\r"
} 
```

最后，删除文件时，建议使用该`-f`标志，因此`rm`如果其中一个文件碰巧不存在，则不会抱怨。

我的建议是将该测试重写为

```
# test 5
proc t5 {} {
    send "ls > totoExpect.txt"
    send "cat < totoExpect.txt | wc -l > titiExpect.txt"
    send "cat titiExpect.txt"
    expect -re "(0|1|2|3|4|5|6|7|8|9)+.*>" { ok 5; } default { abort 5 }
    system "rm -f totoExpect.txt titiExpect.txt"
} 
```

根除 那些 飘忽不定`\r`的 .

# caliburn.micro - Caliburn Micro：如何在列表框底部添加文本并显示

> ID：13223371
> 
> 赞同：3
> 
> 时间：2012-11-04T21:57:29.363
> 
> 标签：caliburn.micro

我试图弄清楚如何将文本添加到列表框的底部并显示它。在带有代码的 WPF 中，我会抓住 ScrollViewer 并对其进行操作，但我不知道如何使用 Caliburn 来完成它......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T22:30:36.657

你有几个选择。

1) 在您的 ViewModel 中，您可以调用`GetView`并将其转换为您的视图类型并获取对 ScrollViewer 的引用。就像是：

```
var myView = this.GetView() as MyView;
var myScrollView = myView.MyScrollView; 
```

这可以正常工作，但如果您试图不将视图耦合到视图模型，则并不理想。

选项 2) 是实现 IResult，请参阅[此处](http://caliburnmicro.codeplex.com/wikipage?title=IResult%20and%20Coroutines&referringTitle=Documentation)的文档。

```
public class ScrollViewResult : IResult
    {
        public event EventHandler<ResultCompletionEventArgs> Completed = delegate { };

        private ScrollViewResult ()
        {
        }

        public void Execute (ActionExecutionContext context)
        {
            var view = context.View as FrameworkElement;
            var scrollViewer = FindVisualChild<ScrollViewer>(view);

            //do stuff to scrollViewer here

            Completed (this, new ResultCompletionEventArgs { });
        }

        private static TChildItem FindVisualChild<TChildItem> (DependencyObject obj)
            where TChildItem : DependencyObject
        {
            for (var i = 0; i < VisualTreeHelper.GetChildrenCount (obj); i++)
            {
                var child = VisualTreeHelper.GetChild (obj, i);
                if (child != null && child is TChildItem)
                    return (TChildItem)child;

                var childOfChild = FindVisualChild<TChildItem> (child);
                if (childOfChild != null)
                    return childOfChild;
            }
            return null;
        }

        //this isn't required of course but comes in handy for 
        //having a static method and passing parameters to the
        //ctor of the IResult
        public static IResult DoSomething ()
        {
            return new ScrollViewResult ();
        } 
```

然后你可以这样称呼它：

```
public IEnumerable<IResult> SomeAction()
        {
            yield return ScrollViewResult.DoSomething();
        } 
```

# c# - Libspotify 播放问题

> ID：13223372
> 
> 赞同：2
> 
> 时间：2012-11-04T21:57:35.513
> 
> 标签：c#, multithreading, interop, spotify

我正在围绕 libspotfiy 编写 C# 包装器，并且在播放曲目时遇到问题。据我所知，当我想在会话中第一次开始流式传输曲目时，我应该打电话

```
sp_session_player_load(sessionHandle, trackHandle)
sp_session_player_play(sessionHandle, true); 
```

这就是我正在做的，它工作正常。当我想玩别的东西时，问题就开始了。有一首曲目仍在播放，我该怎么做才能播放新曲目？我应该打电话

```
sp_session_player_play(sessionHandle, false);
sp_session_player_unload(sessionHandle); 
```

在此之前调用新一轮的加载/播放？我问是因为当我这样做时，我经常看到我的程序在我调用卸载时挂起，或者使用 false 参数调用 play。我正在使用 get_audio_buffer_stats 回调。我有适当的线程同步，所以我想知道我是否错误地唱了 api？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-05T10:48:22.693

这正是 Mac 和 iOS 官方库所做的，并且运行良好：

第一次玩时：

```
sp_session_player_load(sessionHandle, trackHandle)
sp_session_player_play(sessionHandle, true); 
```

再次播放时：

```
sp_session_player_play(sessionHandle, false);
sp_session_player_unload(sessionHandle);
sp_session_player_load(sessionHandle, trackHandle)
sp_session_player_play(sessionHandle, true); 
```

不过，您可以检查几件事：

*   我见过的最常见的挂起是由于程序如何实现`notify_main_thread`回调。*当你得到这个时，你必须以非阻塞的*`sp_session_process_events`方式在主线程上安排一个调用。即，您的实现应该在另一个线程上调用之前返回。*`notify_main_thread``sp_session_process_events`*

**   尝试取出你的`get_audio_buffer_stats`实现。这个 Mac/iOS 库根本没有实现这一点 - 它不是必需的。* 

 *如果这还不够，请尝试获取挂起的堆栈跟踪。如果你在调试器中捕获它，点击暂停通常就足够了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T17:50:32.067

我的代码通过简单地向另一个线程发出信号来对 notify_main_thread 回调做出反应，因此它完全是非阻塞的。

我似乎已经解决了一些问题，但我仍然有些困惑。我确实删除了 get_audio_buffer_stats 回调。但是，似乎有帮助的是在调用 sp_session_player_unload 之前停止在 music_delivery 回调中执行任何操作。

我锁定了我在 music_delivery 回调中所做的一切，以及保护 sp_session_player_unload 的相同锁定。因此，似乎在执行 sp_session_player_unload 时，libspotify 中的另一个线程会触发 music_delivery 回调，这自然要等待 sp_session_player_unload 完成。看来这可能会导致死锁。

我认为我通过确保music_delivery 回调和其他libspotify 函数（即sp_session_player_unload）应该受到同一个互斥锁保护来做正确的事情？也许在 music_delivery 中正确的做法是立即返回，如果尝试获取锁失败，则报告没有采样？（那么对于在 process_events 线程之外进行的所有回调，情况是否如此？）*

# android - 安卓p2p通信

> ID：13223375
> 
> 赞同：2
> 
> 时间：2012-11-04T21:57:50.490
> 
> 标签：android, networking

我正在为运行 RTSP 服务器的 android 开发应用程序。服务器通过提供本地 IP 为 192.xxx 来处理来自连接到同一 wifi 的设备的请求，但如果我通过提供远程 IP 为 37.xxx 发送请求，则服务器不会响应。我的问题是如何将我的 android 设备与远程 ip 绑定，以便我可以接受请求并从任何连接到互联网的设备发送响应。请注意，我使用 api 级别 10 作为最低 sdk 级别

# makefile - 匹配包含模式的文件的规则

> ID：13223378
> 
> 赞同：0
> 
> 时间：2012-11-04T21:58:21.963
> 
> 标签：makefile

如何创建与包含`foo`、like`a/foo.h`或的任何文件匹配的规则`foo.c`？双`%`标无效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T22:38:31.793

```
FOOS := $(shell find . -name "*foo*")

$(FOOS):
    @echo do something with $@ 
```

# css - ：专注于一个img

> ID：13223380
> 
> 赞同：0
> 
> 时间：2012-11-04T21:58:51.030
> 
> 标签：css

我有一个工作正常的作品集，但我目前正在为它构建一个 CMS，以便我可以简单地上传图像并将其添加到我的网站。在我构建它之前，我正在重新构建一些零碎的代码，并将由 JS 驱动的画廊转换为由 CSS 驱动的画廊。

我正在尝试在 CSS 中实现这种点击效果。[http://www.tomdwyerdesign.com/graphics/](http://www.tomdwyerdesign.com/graphics/)

我以为我可以通过 :focus 选择器做到这一点，但我遇到了一个小问题。

这是 HTML：

```
<a class="tile" href="#">
        <img src="images/thumbs/DLPWD.png" class="dlpwd" />
</a> 
```

这是CSS：

```
.tile:focus img{
background-image: url("images/large/DLPWD.png");
width: 771px;
height: 600px;
} 
```

它似乎没有正确选择它。有谁知道为什么？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:24:21.327

问题是一个链接在点击时不一定是焦点，当你导航到它时它是焦点。您可以使用键盘执行此操作，也可以向链接添加点击处理程序。当然，此时您又回到了 javascript，但它显示了正在发生的事情。

例如

```
<a class="tile" href="#" onclick="this.focus()">
    <img src="images/thumbs/DLPWD.png" class="dlpwd" />
</a> 
```

幸运的是，有一个更好的解决方案，并且不需要 javascript。如果您将 tabindex 添加到链接，即使 href 无处可去，单击它也会将其聚焦。所以...

```
<a class="tile" href="#" tabindex="0">
    <img src="images/thumbs/DLPWD.png" class="dlpwd" />
</a> 
```

应该做你想做的。

（您的下一个问题将是背景图像在 src 图像前不可见 - 您将获得缩略图的拉伸版本。但我认为这是一个不同的问题）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T22:05:15.807

`:focus`仅在接收键盘输入的元素（即表单元素）上可用。您可以尝试`:active`，但它只会在鼠标按钮按下时应用 CSS。

# objective-c - Coredata & NSPersistentDocument：列号总和崩溃

> ID：13223381
> 
> 赞同：2
> 
> 时间：2012-11-04T21:59:13.310
> 
> 标签：objective-c, xcode, cocoa, core-data, nspersistentdocument

我的程序中的列的@sum 绑定有问题：

我正在做一个基于 Coredata、NSPersistentDocument 的程序。我主要从 IB 做所有事情，创建数据模型、NSArrayController 和 NSTableView ......

我只有 1 个具有 62 个属性（61 个 NSString 和 1 个 NSNumber）的实体。我导入了一个包含 12722 条记录的 CSV 文件。导入效果很好，可以保存到 xml、二进制、sqlite...我已经仔细检查了整个过程是否完美。可以保存/加载。一切都在那里。

我遇到的问题：我创建了一个标签，我将其绑定到具有 NSNumber 属性的列的@sum。我就是这样做的

```
>     label->Bindings Inspector->Value
>      Bind to: My_Entity_NSArrayController
>       Controller Key: selection
>       Model Key Path: @sum.myNumericAttribute 
```

当我运行程序时，单击导入，选择所有行，@sum 运行良好。它很快，但是这是第一个问题：一旦我保存文件（尝试了所有... binary/xml/sqlite）并稍后**加载它并尝试再次选择全部，程序崩溃而没有错误**。

通过“配置文件”-> 分配尝试。我注意到：

*   我没有内存泄漏
*   从磁盘加载然后全选时：速度非常慢。5 分钟后还没有完成（我停止了它），我看到了 +45MB 的 CFNumber（实时字节）和 >1.500.00#Overall。所以，这里出了点问题，因为我说的是 12722 行/Interger32 类型的寄存器。

第二个问题是相同的，但从不同的角度再现。我没有使用“选择”，而是尝试使用“arrangedObjects”。在这种情况下，即使从 CSV 导入也会出现问题，它变得非常缓慢，最终崩溃。尝试打开已经创建的文件也会崩溃。

这就是我做标签->绑定检查器->值的方式

```
>    label->Bindings Inspector->Value
>      Bind to: My_Entity_NSArrayController
>       Controller Key: arrangedObjects
>       Model Key Path: @sum.myNumericAttribute 
```

您能否帮助我了解要查找的内容或可以帮助我找到问题所在的想法？

非常感谢。

路易斯

* * *

***---- 更多研究后的新编辑 ----***

我找到了一个我不理解的解决方法，请评论/回答非常感谢。

我的程序使用 Coredata (SQLite)、NSPersistentDocument、NSTableView 和 NSArrayController。我想让一个工作的 NSTextField 绑定到 @sum 集合操作

问题：只要我打开一个填充了 SQLite DB 的现有文档，并尝试从 NSWindowController 绑定到排列对象。@sum.t_24_Bookings，程序就会崩溃。

我最初的猜测与[加载 nib 后无法访问对象控制器的内容有关，](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdTroubleshooting.html#//apple_ref/doc/uid/TP40002320-SW6)但是我遵循了执行第一次 Fetch 的建议，但没有成功：

```
- (void) awakeFromNib
{
    :
    BOOL ok = [[self out_CtEn_Transaction] fetchWithRequest:nil merge:NO error:&error];
    : 
```

继续这个想法，我发现如果我创建一个“真正的”完整 Fetch + 我从 Document 子类执行 @sum 访问，那么它就可以工作。

这是我为了使解决方法起作用而放置的带有注释的代码。

**ABDocument 接口**（一个 NSPersistentDocument 子类）

```
@interface ABDocument : NSPersistentDocument {

    BOOL        ivNewDocument;
    NSArray     *ivFetchedTransactions;
    NSNumber    *ivTotalBookings;
}

@property (nonatomic, getter=isNewDocument) BOOL newDocument;
@property (nonatomic, retain) NSArray   *fetchedTransactions;
@property (nonatomic, retain) NSNumber  *totalBookings;

: 
```

**AB文档实施**

```
#import "ABDocument.h"
#import "ABWindowController.h"

@implementation ABDocument

@synthesize newDocument                 = ivNewDocument;
@synthesize totalBookings               = ivTotalBookings;
@synthesize fetchedTransactions         = ivFetchedTransactions;

:

/** @brief Create one instance of my custom NSWindowController subclass (ABWindowController)
 *
 * In my NSPersistentDocument I do override makeWindowControllers, where I create 
 * one instance of my custom NSWindowController subclass and use addWindowController: 
 * to add it to the document. 
 *
 */
- (void) makeWindowControllers
{
    // Existing Document?
    if ( ![self isNewDocument]) {
        // NSLog(@"%@:%@ OPENING EXISTING DOCUMENT", [self class], NSStringFromSelector(_cmd));

        // Opening existing document (also has an existing DDBB (SQLite)), so
        // make sure I do perform a first complete "fetch + @sum" to void issues
        // with my NIB bind's.
        [self firstFetchPreventsProblems];
    }

    // Now I can create the Window Controller using my "MainWindow.xib".
    ABWindowController *windowController = [[ABWindowController alloc] init];
    [self addWindowController:windowController];
    [windowController release];    
}

/** @brief First complete "fetch + @sum" to void issues with my NIB bind's.
 *
 *  Before I create the Window Controller with "MainWindow.xib" I have to perform a
 *  first Fetch AND also retrieve a @sum of an NSNumber column.
 *
 *  My NIB has an NSTextField BOUND to @arrangedObjects.@sum.<property> through a NSArrayController
 *  If I don't call this method before the NIB is loaded, then the program will crash.
 *
 */
- (void) firstFetchPreventsProblems {

    // Prepare the Fetch
    NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"Transaction"];

    // 1) Perform the Fetch
    NSError *error = nil;
    [self setFetchedTransactions:[[self managedObjectContext ] executeFetchRequest:request error:&error]];
    if ([self fetchedTransactions] == nil)
    {
        NSLog(@"Error while fetching\n%@",
              ([error localizedDescription] != nil) ? [error localizedDescription] : @"Unknown Error");
        exit(1);
    }

    // 2) Execute Collection Operation @sum
    [self setTotalBookings:[[self fetchedTransactions] valueForKeyPath:@"@sum.t_24_Bookings"]];
} 
```

**ABWindowController**（加载我的NIB的控制器）

```
- (void)windowDidLoad
{

:
        // PROGRAM CRASH HERE 
        // IF [self firstFetchToPreventsProblems]; is NOT CALLED
        // ABDocument's "makeWindowControllers:"
       [[self totalSumField] bind: @"value" toObject: [self out_CtEn_Transaction]
                       withKeyPath:@"arrangedObjects.@sum.t_24_Bookings" options:nil];

} 
```

请如果你能评论真的很感激，我有一个解决方案，但我不明白为什么。

坦克，
路易斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T20:27:17.233

经过几天的研究，我自己发现了这个问题。这很容易（现在我知道了）：

与此同时，我正在创建一个辅助线程，并且碰巧我正在从两个不同的线程访问数据模型。正如 Stackoverflow 的几个问答中所解释的那样，这是非常危险的。

我已经将评论的解决方案应用于在辅助线程中创建辅助 MOC 的几篇文章中。

现在我的代码根据与 coredata 相关的操作是线程安全的，因此程序不会崩溃。

再次感谢社区。

路易斯

# c++ - C ++：从不同目录显示并动态加载DLL

> ID：13223383
> 
> 赞同：8
> 
> 时间：2012-11-04T21:59:33.430
> 
> 标签：c++, dll, manifest, loadlibrary, vcredist

# 我正在努力实现的长篇故事

我正在开发一个将 DLL 作为插件动态加载的程序。我正在使用 Microsoft Visual C++ 2008 编译程序。不过，我们假设应该支持 Qt 使用的任何 Visual C++ 版本。程序目录布局如下：

```
| plugins/
|   plugin1.dll
|   plugin2.dll
| QtCore4.dll
| QtGui4.dll
| program.exe 
```

`program.exe`发现所有插件 DLL 文件，对其执行 LoadLibrary() 并调用某个签名函数来确定它是否真的是插件。这在安装了 vcredist for MSVC90 的计算机上运行良好。自然，为了使程序在所有计算机上运行，​​我必须使用 msvc*.dll 文件和适当的清单文件重新分发它。Qt DLL 也需要 redist 才能运行。

现在，我已经将 cmake 设置为根据所选的 Visual Studio 版本自动复制适当的 redist DLL 和清单。为了简单起见，让我们继续假设我正在使用 MSVC90。当 redist 被复制到程序目录时，布局如下所示：

```
| plugins/
|   plugin1.dll
|   plugin2.dll
| QtCore4.dll
| QtGui4.dll
| msvcm90.dll
| msvcp90.dll
| msvcr90.dll
| Microsoft.VC90.CRT.manifest (I'm also aware that this file is bugged in VS2008)
| program.exe 
```

*关于清单文件中的错误：[http ://www.cmake.org/pipermail/cmake/2008-September/023822.html](http://www.cmake.org/pipermail/cmake/2008-September/023822.html)*

# 问题

具有这种布局的程序现在可以在没有安装 redist 的计算机上运行，**​​但**插件没有被加载。为了让插件加载，我必须执行以下操作之一：

1.  将清单文件复制到`plugins/`目录。从清单文件中删除对 msvc*.dll 文件的所有引用。这行得通，但不是很好，因为我必须支持不同版本的已编辑清单文件，具体取决于使用的 MSVC 的版本。另外，我不知道这是否不会与 2008 年以外的 Visual Studio 中断。
2.  将整个 redist 复制到`plugins/`目录。这不需要对清单文件进行任何修改，但现在`program.exe`愚蠢地尝试加载 msvc*.dll 文件，认为它们是插件。自然，这会优雅地失败，因此不会造成太大的伤害。另一个缺点是程序包的大小增加了 1 MB 以上。不过，这两个问题都是我可以忍受的。
3.  使用 /MT 开关编译插件。简短的测试表明这确实有效，但我不确定如果 Qt 和`program.exe`都是 /MD 将来它是否不会破坏任何东西。

# 问题

最好的解决方案是什么？什么是正确的解决方案？如果有多个正确的解决方案，那么最佳实践是哪个？我是第一个尝试这样做的人吗？

# 更新 1（2012 年 11 月 18 日）

虽然这个问题仍未得到解答，但我决定走最不让人头疼的路线。到目前为止，我一直在使用第 1 号解决方案，我决定坚持使用它。如果 CMake 检测到用户使用的 MSVC 版本与 2008 不同，它将显示一条警告消息，指出不完全支持自动打包。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-27T11:41:36.160

您可以为“LoadLibrary”提供完整的文件路径，这样您就可以使用它们的路径加载您的插件。我已经使用这种精确的布局从 Visual Studio 2005 中当前 dll 的子目录加载同一库的多个版本。

您首先需要使用以下命令获取当前 dll 的当前路径：

```
static LPSTR strDLLPath1 = new TCHAR[_MAX_PATH+1];
::GetModuleFileName((HINSTANCE)&__ImageBase, strDLLPath1, _MAX_PATH); 
```

尽管如果您的 program.exe 已经在发现这些插件文件，我会假设您已经可以访问它们的完整路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T11:00:04.567

如果您的目标操作系统的 _WIN32_WINNT >= 0x0502 则可以使用函数

```
SetDllDirectory() 
```

在加载插件之前。

放置主程序文件夹的路径。

该调用覆盖系统加载顺序：

1.  加载应用程序的目录。
2.  SetDllDirectory() 调用中的路径指定的目录。

因此，您可以在应用程序启动后调用该函数。在所有情况下都是安全的。祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T15:56:11.593

您可以在安装过程中使用 CreateHardLink() 函数创建到 VC dll 的硬链接。使用您描述的方法（1），VCRT dll的不同副本可能存在一些问题。Hardlinks 或 SetDllDirectory() 似乎是最好的解决方案。

不要混合到 MSVCRT 的单个进程静态和动态链接 - 它总是会给你带来问题！

# android - 如何在android中为..Activity.java中的按钮设置背景图像？

> ID：13223386
> 
> 赞同：1
> 
> 时间：2012-11-04T22:00:11.400
> 
> 标签：android, android-button

我写了以下代码：

```
 ImageButton b = (ImageButton) v;  
                b.setBackgroundResource(R.drawable.tom); 
```

tom.png 位于 res/drawable 中。上面的代码可以运行，但我将图像名称保存在数据库中（例如“tom”）。我尝试了后面的代码：

```
 InfoDataSource datasourceRuta = new InfoDataSource(this);
    datasourceRuta.open();

    String strInfo = "";        

    List<Info> objInfo = datasourceRuta.GetInfo()

    for (Info info : objInfo) {
        strInfo = info.getImg0();

            ImageButton b = (ImageButton) v;  
                b.setBackgroundResource(R.drawable.strInfo);  

        } 
```

strInfo = "tom"，我得到一个错误：strInfo 无法解析或不是一个字段。你有我的解决方案吗？我应该将图像保存在数据库中吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T02:52:10.260

当您将“tom”图像复制到可绘制文件夹时，Android 会在 gen/R.java 中生成一个 tom 字段。在这种情况下。R.java 中没有 strInfo，所以无法访问。

在这种情况下，您应该从图像文件中读取，为您的按钮创建一个位图和 setBackground。您可以参考：[How to read a file into a Java Bitmap?](https://stackoverflow.com/questions/4097088/how-to-read-a-file-into-a-java-bitmap)

# android - 将 android:id 添加到 xml 会破坏整个应用程序

> ID：13223388
> 
> 赞同：2
> 
> 时间：2012-11-04T22:00:47.377
> 
> 标签：android, android-layout, android-xml

我有这个 XML 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
          android:orientation="vertical"
          android:layout_width="fill_parent"
          android:layout_height="fill_parent">
    <Button android:text="Disable Filter" android:background="@drawable/buttons" style="@style/ButtonText" android:layout_weight="25" />
    <ImageView android:id="@+id/imageFilter" android:layout_width="fill_parent" android:layout_height="wrap_content" android:layout_weight="75" />
    <HorizontalScrollView android:layout_width="fill_parent" android:layout_height="wrap_content">
        <LinearLayout android:id="@+id/horizontal" android:orientation="horizontal" android:layout_width="fill_parent" android:layout_height="fill_parent">
        </LinearLayout>
    </HorizontalScrollView>
</LinearLayout> 
```

一旦我添加`android:id="@+id/btnFilterPreview"`到`Button`我的应用程序停止工作。这是为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:29:17.733

在 Netbeans 中解决问题，右键单击项目并选择：`Clean and Build`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T07:28:10.943

It may also be caused Android automatically adds `android.R` in its header file remove it

and then `Build Project` Again

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T07:32:36.153

此外`Clean and Build`，请确保您没有重复的 ID。

假设您有另一个具有相同 ID 的 ImageView，它可能会在某些代码时崩溃

`(Button)findViewById(R.id.btnFilterPreview)`

被执行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-05T05:42:34.527

清洁构建您的项目，以便重新生成所有 id，并且应用程序将找到新 id 的引用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-05T06:10:03.653

这是您的相同代码。运行完美没有任何变化。

我`just Clean & Re-Build Project`什么都没有。

试试看。

```
<Button
    android:id="@+id/btnFilterPreview"
    android:layout_width="wrap_content"
    android:layout_height="match_parent"
    android:layout_weight="25"
    android:background="@drawable/ic_action_search"
    android:text="Disable Filter" />

<ImageView
    android:id="@+id/imageFilter"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_weight="75" />

<LinearLayout
    android:id="@+id/horizontal"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_weight="25"
    android:orientation="horizontal" >
</LinearLayout>

<HorizontalScrollView
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" >
</HorizontalScrollView> 
```

# c++ - 我可以将具有浮点数的 POD 数组转换为浮点数*吗？

> ID：13223389
> 
> 赞同：7
> 
> 时间：2012-11-04T22:00:51.450
> 
> 标签：c++, arrays, containers

考虑以下：

```
#include <vector>
using namespace std;

struct Vec2
{
  float m_x;
  float m_y;
};

vector<Vec2> myArray;

int main()
{
  myArray.resize(100);

  for (int i = 0; i < 100; ++i)
  {
    myArray[i].m_x = (float)(i);
    myArray[i].m_y = (float)(i);
  }

  float* raw;
  raw = reinterpret_cast<float*>(&(myArray[0]));
} 
```

`raw`保证有 200 个具有正确值的连续浮点数吗？也就是说，标准是否保证这一点？

**编辑**：如果以上得到保证，并且如果`Vec2`有一些功能（非虚拟）和构造函数，那么保证仍然存在吗？

> **注意：**我意识到这很危险，在我的特殊情况下，我别无选择，因为我正在使用 3rd 方库。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T22:20:17.387

> 我意识到这很危险，在我的特殊情况下，我别无选择，因为我正在使用 3rd 方库。

您可以添加结构大小的编译时检查：

[现场演示](http://ideone.com/LZJ4cp)

```
struct Vec2
{
    float a;
    float b;
};

int main()
{
        int assert_s[ sizeof(Vec2) == 2*sizeof(float) ? 1 : -1 ];
} 
```

这将增加您对方法的信心（如上所述，由于 reinterpret_cast 仍然不安全）。

* * *

> raw = reinterpret_cast(&(myArray[0]));

**ISO C++98** 9.2/17：

> 使用**reinterpret_cast**适当转换的指向 POD 结构对象的指针指向其初始成员（或者如果该成员是位字段，则指向它所在的单元），反之亦然。[注意：因此，标准布局结构对象中可能存在未命名的填充，但不是在其开头，这是实现适当对齐所必需的。——尾注]

* * *

最后，相应地址的运行时检查将使这种解决方案相当安全。它可以在单元测试期间甚至在程序的每次启动时完成（在小型测试阵列上）。

把它们放在一起：

[现场演示](http://ideone.com/3AHK0v)

```
#include <vector>
#include <cassert>
using namespace std;
struct Vec2
{
    float a;
    float b;
};

int main()
{
    int assert_s[ sizeof(Vec2) == 2*sizeof(float) ? 1 : -1 ];
    typedef vector<Vec2> Vector;
    Vector v(32);
    float *first=static_cast<float*>(static_cast<void*>(&v[0]));
    for(Vector::size_type i,size=v.size();i!=size;++i)
    {
        assert((first+i*2) == (&(v[i].a)));
        assert((first+i*2+1) == (&(v[i].b)));
    }
    assert(false != false);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-04T22:17:01.340

不，这是不安全的，因为编译器可以自由地`float`在结构中的两个 s 之间或之后插入填充，因此结构的`float`s 可能不连续。

如果您仍然想尝试它，您可以添加编译时检查以更加确定它会起作用：

```
static_assert(sizeof(Vec2) == sizeof(float) * 2, "Vec2 struct is too big!");
static_assert(offsetof(Vec2, b) == sizeof(float), "Vec2::b at the wrong offset!"); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-04T22:15:52.437

a 给出的唯一保证`reinterpret_cast`是，当您`reinterpret_cast`将对象转换回原始数据类型时，您将获得原始对象。

特别是，`raw`不能保证有 200 个具有正确值的连续浮点数。

# android - 登录 HttpPost Android 的异步任务

> ID：13223391
> 
> 赞同：2
> 
> 时间：2012-11-04T22:01:12.467
> 
> 标签：android, login, android-asynctask

我正在关注 youtube 指南以在 android 中登录。到目前为止，我已经达到了，我相信 youtube 指南依赖于早期的 SDK 来使其工作。对于 ICS 和更新版本，我已经读到我需要使用异步（我得到了 NetworkOnMainThreadException）。我已经工作了 2 天，试图弄清楚如何实现这一点。

这一直停留在加载终端，直到应用程序停止工作。是因为我在 RunInBackground() 里面有太多东西吗？

我将如何让我的方法在适当的时间内发挥作用。

我感谢任何人对此的帮助。顺便说一句，我已经阅读了很多文件说要实现异步任务，但我的问题更多的是我将如何做到这一点？

**也是后端：应用程序在 wamp 服务器上发送 index.php 信息，然后 php 与数据库对话。

```
package com.sokies.my_team;

public class MainActivity extends Activity implements OnClickListener {

    EditText etUser, etPass;
    Button bLogin;

    //Create string variables that will have the input assigned to them
    String username, password;

    //Create a HTTPClient as the form container
    HttpClient httpclient;

    //Use HTTP POST method
    HttpPost httppost;

    //Create an array list for the input data to be sent
    ArrayList<NameValuePair> nameValuePairs;

    //Create a HTTP Response and HTTP Entity
    HttpResponse response;
    HttpEntity entity;

    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        initialise();

    }

    private void initialise() {
        etUser = (EditText) findViewById(R.id.etUser);
        etPass = (EditText) findViewById(R.id.etPass);
        bLogin = (Button) findViewById(R.id.bSubmit);
        //Now to set an onClickListener
        bLogin.setOnClickListener(this);
    }

    public void onClick(View v)  {
        // This is where we will be working now

        new MyAsyncTask().execute();

    }//END onClick()

    private static String convertStreamToString(InputStream is) {
        /*
         * To convert the InputStream to String we use the BufferedReader.readLine()
         * method. We iterate until the BufferedReader return null which means
         * there's no more data to read. Each line will appended to a StringBuilder
         * and returned as String.
         */
        BufferedReader reader = new BufferedReader(new InputStreamReader(is));
        StringBuilder sb = new StringBuilder();

        String line = null;
        try {
            while ((line = reader.readLine()) != null) {
                sb.append(line + "\n");
            }
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            try {
                is.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
        return sb.toString();
    }//END convertStreamToString()

    private class MyAsyncTask extends AsyncTask<Void, Void, Void>
{
        ProgressDialog mProgressDialog;
        @Override
        protected void onPostExecute(Void result) {
            mProgressDialog.dismiss();
        }

        @Override
        protected void onPreExecute() {
            mProgressDialog = ProgressDialog.show(MainActivity.this, "Loading...", "Data is Loading...");
        }

        @Override
        protected Void doInBackground(Void... params) {

            //Create new default HTTPClient
            httpclient = new DefaultHttpClient();

            //Create new HTTP POST with URL to php file as parameter
            httppost = new HttpPost("http://10.0.2.2/myteamapp/index.php"); 

            //Assign input text to strings
            username = etUser.getText().toString();
            password = etPass.getText().toString();

            //Next block of code needs to be surrounded by try/catch block for it to work
            try {
                //Create new Array List
                nameValuePairs = new ArrayList<NameValuePair>(2);

                //place them in an array list
                nameValuePairs.add(new BasicNameValuePair("user", "username"));
                nameValuePairs.add(new BasicNameValuePair("pass", "password"));

                //Add array list to http post
                httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

                //assign executed form container to response
                response = httpclient.execute(httppost); //response from the PHP file

                //check status code, need to check status code 200
                if(response.getStatusLine().getStatusCode() == 200){

                    //assign response entity to http entity
                    entity = response.getEntity();

                    //check if entity is not null
                    if(entity != null){

                        //Create new input stream with received data assigned
                        InputStream instream = entity.getContent();

                        //Create new JSON Object. assign converted data as parameter.
                        JSONObject jsonResponse = new JSONObject(convertStreamToString(instream));

                        //assign json responses to local strings
                        String retUser = jsonResponse.getString("user");//mySQL table field
                        String retPass = jsonResponse.getString("pass");

                        //Validate login
                        if(username.equals(retUser)&& password.equals(retPass)){ //Check whether 'retUser' and 'retPass' matches username/password 

                            //Display a Toast saying login was a success
                            Toast.makeText(getBaseContext(), "Successful", Toast.LENGTH_SHORT).show();

                        } else {
                            //Display a Toast saying it failed.

                            Toast.makeText(getBaseContext(), "Invalid Login Details", Toast.LENGTH_SHORT).show();
                        }

                    }

                }

            } catch(Exception e){

               // e.printStackTrace();
                //Display toast when there is a connection error
                //Change message to something more friendly
               Toast.makeText(getBaseContext(), e.toString(), Toast.LENGTH_SHORT).show();
               Toast.makeText(getBaseContext(), "Connection Error", Toast.LENGTH_SHORT).show();

               return null;
            }

            return null;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T23:33:21.507

您正在尝试`Toast`从后台线程使用 UI（在您的情况下它正在显示）执行操作，这在 android 中是被禁止的。尝试在方法中返回一个值（fe，1 表示成功，0 表示失败）并在 UI 线程上调用`doInBackground`它进行处理。`onPostExecute`

换句话说，始终在主线程上执行用户界面操作：在运行后台任务之前和之后的方法中，尊重`onPreExecute`。`onPostExecute`

# php - 提交时的 PHP 回发

> ID：13223398
> 
> 赞同：0
> 
> 时间：2012-11-04T22:02:31.077
> 
> 标签：php, forms, submit, postback

我有一个关于 php 回发的问题

我的代码是：

```
<?php
if(isset($_POST["Delete"]))
{  
   echo "DELETE";
}

if(isset($_POST["Modifier"]))
{  
   echo "Modifier";
}

if(!empty($_SESSION["Status"]))
{
    if($_SESSION["Status"] == "u")
    {
        header("Location: Index.php?Action=Acceuil");
    }

    if($_SESSION["Status"] == "a")
    {
        $Connection = mysql_connect("localhost","root") or die(mysql_error());                
        mysql_select_db("tpw34") or die("Nope.");                
        $query = "Select * From Products";
        $result = mysql_query($query);

        While($ligne = mysql_fetch_assoc($result))
        {
            //Index.php?Action=AdminDeleteProduct&Delete=".$ligne["ProductID"]."
            echo "<form method='POST' Action='#'>";
                echo "<table border='1'>";
                echo "<tr>";
                echo "<td colspan='2'><center><img  width='250' height='250' src='".$ligne["Image"]."'/></center></td>";
                echo "</tr>";
                echo "<tr>";
                    echo "<th>Nom du produit :</th>";
                    echo "<td>".$ligne["ProductName"]."</td>";
                echo "</tr>";
                echo "<tr>";
                    echo "<th>Prix :</th>";
                    echo "<td>".$ligne["Prix"]."</td>";
                echo "</tr>";
                echo "<tr>";
                    echo "<th>Description :</th>";
                    echo "<td>".$ligne["Description"]."</td>";
                echo "</tr>";
                echo "<tr>";
                    echo "<td colspan='2'h><input type='Submit' value='Delete' name='Delete'/><input type='Submit' value='Modifier' name='Modifier'/></td>";
                echo "</tr>";
                echo "</table>";
                echo "<br>";
            echo "</form>";
        }
    }
}

?> 
```

我的问题是：我想获取项目的 ProductID（在表格中）`$_POST["Delete"]`，`$_POST["Modifier"]`但我不想更改按钮上的文本。我想保留 DELETE 和 MODIFIER。我在网上阅读了很多东西，但我没有找到正确的答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T22:44:55.667

您可以使用会话，您可以在其中临时保存您的信息。

[会话](http://php.net/manual/de/features.sessions.php)

或者像 Tim Dearborn 建议的那样，使用隐藏的输入将其与下一个表单提交一起发送。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T22:06:04.463

包括 ProductID 的隐藏表单值。然后您可以检索 $_POST['ProductID'] 中的值

```
 echo "<input type=hidden name='ProductID' value='" . $ligne["ProductID"] . "'>"; 
```

# c++ - 在 C++ 中删除指针

> ID：13223399
> 
> 赞同：103
> 
> 时间：2012-11-04T22:02:31.430
> 
> 标签：c++, pointers, delete-operator

背景：我正试图将我的头包裹在指针上，我们几周前在学校看到它们，今天在练习时我遇到了一个傻子？问题，这对您来说可能非常简单，但我几乎没有编程经验。

我在 SO 中看到了很多关于删除指针的问题，但它们似乎都与删除一个类而不是一个“简单”指针（或任何适当的术语）有关，这是我正在尝试的代码跑：

```
#include <iostream>;

using namespace std;

int main() {
  int myVar,
      *myPointer;

  myVar = 8;
  myPointer = &myVar;

  cout << "delete-ing pointers " << endl;
  cout << "Memory address: " << myPointer << endl;

  // Seems I can't *just* delete it, as it triggers an error 
  delete myPointer;
  cout << "myPointer: " << myPointer << endl;
  // Error: a.out(14399) malloc: *** error for object 0x7fff61e537f4:
  // pointer being freed was not allocated
  // *** set a breakpoint in malloc_error_break to debug
  // Abort trap: 6

  // Using the new keyword befor deleting it works, but
  // does it really frees up the space? 
  myPointer = new int;
  delete myPointer;
  cout << "myPointer: " << myPointer << endl;
  // myPointer continues to store a memory address.

  // Using NULL before deleting it, seems to work. 
  myPointer = NULL;
  delete myPointer;
  cout << "myPointer: " << myPointer << endl;
  // myPointer returns 0.

} 
```

所以我的问题是：

1.  为什么第一个案例不起作用？使用和删除指针似乎是最直接的用法？该错误表示未分配内存，但“cout”返回了一个地址。
2.  在第二个示例中，错误没有被触发，但是对 myPointer 的值进行 cout**仍然**返回内存地址？
3.  #3真的有用吗？似乎对我有用，指针不再存储地址，这是删除指针的正确方法吗？

很抱歉这个问题很长，想让这个尽可能清楚，也重申一下，我没有什么编程经验，所以如果有人可以用外行的术语回答这个问题，将不胜感激！

* * *

## 回答 #1

> 赞同：189
> 
> 时间：2012-11-04T22:06:52.383

**1 & 2**

```
myVar = 8; //not dynamically allocated. Can't call delete on it.
myPointer = new int; //dynamically allocated, can call delete on it. 
```

第一个变量是在堆栈上分配的。您只能在使用`new`运算符动态（在堆上）分配的内存上调用 delete。

**3.**

```
 myPointer = NULL;
  delete myPointer; 
```

以上什么也没**做**。您没有释放任何东西，因为指针指向 NULL。

* * *

**不应执行以下操作：**

```
myPointer = new int;
myPointer = NULL; //leaked memory, no pointer to above int
delete myPointer; //no point at all 
```

您将其指向 NULL，留下泄漏的内存（您分配的新 int）。你应该释放你指向的内存。无法再访问分配`new int`的内存，因此内存泄漏。

* * *

**正确的方法：**

```
myPointer = new int;
delete myPointer; //freed memory
myPointer = NULL; //pointed dangling ptr to NULL 
```

* * *

**更好的方法：**

如果您使用的是 C++，**请不要**使用原始指针。改用[智能指针](https://stackoverflow.com/q/106508/759019)，它可以为您处理这些事情，而且开销很小。C++11 带有[几个](http://en.cppreference.com/w/cpp/memory).

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-11-05T00:00:39.987

我相信你还没有完全理解指针是如何工作的。
当您有一个指向某个内存的指针时，您必须了解三件不同的事情：
- 指针（内存）“指向什么”
- 这个内存地址
- 并非所有指针都需要删除它们的内存：您只需需要删除动态分配的内存（使用的`new`运算符）。

想象：

```
int *ptr = new int; 
// ptr has the address of the memory.
// at this point, the actual memory doesn't have anything.
*ptr = 8;
// you're assigning the integer 8 into that memory.
delete ptr;
// you are only deleting the memory.
// at this point the pointer still has the same memory address (as you could
//   notice from your 2nd test) but what inside that memory is gone! 
```

当你做了

```
ptr = NULL;
// you didn't delete the memory
// you're only saying that this pointer is now pointing to "nowhere".
// the memory that was pointed by this pointer is now lost. 
```

C++ 允许您尝试指向`delete`一个指针，`null`但它实际上并没有做任何事情，只是没有给出任何错误。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-11-04T22:15:35.513

指针类似于普通变量，因为您不需要删除它们。它们在函数执行结束和/或程序结束时从内存中删除。

但是，您可以使用指针来分配内存“块”，例如：

```
int *some_integers = new int[20000] 
```

这将为 20000 个整数分配内存空间。很有用，因为堆栈的大小有限，您可能想在没有堆栈溢出错误的情况下处理大量“整数”。

每当您调用 new 时，您都应该在程序结束时“删除”，否则您会发生内存泄漏，并且某些分配的内存空间将永远不会返回给其他程序使用。去做这个：

```
delete [] some_integers; 
```

希望有帮助。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-11-04T22:08:29.073

> C++ 中有一条规则，每一个**new**都有一个**delete**。

1.  **为什么第一个案例不起作用？使用和删除指针似乎是最直接的用法？该错误表示未分配内存，但“cout”返回了一个地址。**

new 永远不会被调用。所以 cout 打印的地址是 myVar 的内存位置的地址，或者在这种情况下分配给 myPointer 的值。通过写作：

```
myPointer = &myVar; 
```

你说：

> *myPointer = myVar 中数据的存储地址*

2.  **在第二个示例中，错误没有被触发，但是对 myPointer 的值进行 cout 仍然返回内存地址？**

它返回一个地址，该地址指向已删除的内存位置。因为首先创建指针并将其值分配给 myPointer，然后删除它，然后打印它。因此，除非您为 myPointer 分配另一个值，否则删除的地址将保留。

3.  **#3真的有用吗？似乎对我有用，指针不再存储地址，这是删除指针的正确方法吗？**

NULL 等于 0，你删除 0，所以你什么也不删除。它打印 0 的逻辑是因为您这样做了：

```
myPointer = NULL; 
```

这等于：

```
myPointer = 0; 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-11-04T22:11:40.417

1.  您正在尝试删除分配在堆栈上的变量。你不可以做这个
2.  删除指针实际上并不会破坏指针，只是将占用的内存返回给操作系统。您可以访问它，直到内存用于另一个变量或以其他方式操作。因此，最好在删除后将指针设置为 NULL (0)。
3.  删除 NULL 指针不会删除任何内容。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-11-04T22:15:46.150

```
int value, *ptr;

value = 8;
ptr = &value;
// ptr points to value, which lives on a stack frame.
// you are not responsible for managing its lifetime.

ptr = new int;
delete ptr;
// yes this is the normal way to manage the lifetime of
// dynamically allocated memory, you new'ed it, you delete it.

ptr = nullptr;
delete ptr;
// this is illogical, essentially you are saying delete nothing. 
```

# mongodb - MongoDB 聚合 $project

> ID：13223400
> 
> 赞同：6
> 
> 时间：2012-11-04T22:02:31.623
> 
> 标签：mongodb, aggregation-framework

我将我们的 Web 服务器日志存储在[MongoDB](http://www.mongodb.org/)中，架构如下所示：

```
[
  {  
    "_id" : 12345,
    "url" : "http://www.mydomain.com/xyz/abc.html",
    ....
  },
  ....
] 
```

在我开始通过聚合管道传递我的集合之前，我正在尝试使用[`$project`](http://docs.mongodb.org/manual/reference/aggregation/#_S_project)运算符来稍微重塑这个模式。基本上，我需要添加一个名为“type”的新字段，稍后将用于执行分组。新领域的逻辑非常简单。

```
if "url" contains "pattern_A" then set "type" = "sales lead";
else if "url" contains "pattern_B" then set "type" = "existing client";
... 
```

我想它必须是这样的：

```
db.weblog.aggregate(
  { 
    $project : {
      type : { /* how to implement the logic??? */ }
    }
  }
); 
```

我知道如何使用 map-reduce 来做到这一点（通过将“keyf”属性设置为实现上述逻辑的自定义 JS 函数），但现在我正在尝试使用[新的聚合框架](http://docs.mongodb.org/manual/reference/aggregation/)来做到这一点。我尝试使用[表达式运算符](http://docs.mongodb.org/manual/reference/aggregation/#aggregation-expression-operators)来实现逻辑，但到目前为止还不能让它工作。任何帮助/建议将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:00:16.613

我正在分享我的“解决方案”，以防其他人遇到像我一样的需求。

在研究了几周后，正如@asya-kamsky 在他的一个评论中所建议的那样，我决定在我原来的 MongoDB 模式中添加一个计算字段。这并不理想，因为每当计算字段的逻辑发生更改时，我都必须进行批量更新以更新我的集合中的所有文档，但要么就是这样，要么重写我的代码以使用 MapReduce。我暂时选择了前者。在查看 MongoDB Jira 板时，似乎很多人都要求为[$project](http://docs.mongodb.org/manual/reference/aggregation/#_S_project)运算符添加更多不同的运算符，我当然希望 MongoDB 开发团队能够尽快添加它们

[基于分隔符拆分字符串的运算符。](https://jira.mongodb.org/browse/SERVER-6773)

[新的投影运算符 $elemMatch](https://jira.mongodb.org/browse/SERVER-2238)

[在 $project 中允许 $slice 运算符](https://jira.mongodb.org/browse/SERVER-6074)

[将 $inOrder 运算符添加到 $project](https://jira.mongodb.org/browse/SERVER-6257)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T00:35:21.850

您需要使用多个运算符和表达式的组合。

首先，`$cond`运算符 in`$project`让您实现 if then else 逻辑。

`$cond`: 接受一个包含三个元素的数组，第一个是布尔表达式，第二个和第三个是用于字段值的值 - 如果布尔表达式为真，则使用第二个元素作为值，如果不是，则使用第三个元素。

你可以嵌套这些，以便第三个元素本身就是一个`$cond`表达式来获取 if-then-else-if-then-etc。

字符串操作有点尴尬，但你确实有`$substr`。

如果您发布一些您尝试过的确切示例，我可能会发现它为什么不起作用。

# php - Magento CLI 索引器 catalog_url 刹车 url 重写

> ID：13223403
> 
> 赞同：1
> 
> 时间：2012-11-04T22:02:56.580
> 
> 标签：php, magento, url-rewriting

我对 Magento 1.7.0.2 有一个奇怪的问题

当我通过 cli 重新索引“目录 URL 重写”时

> php shell/indexer.php --reindex catalog_url

我得到了**没有 .html**的路径，并且商店中的链接不起作用。

当我在管理中使用索引管理工具重新索引它时，一切正常。

**产品 URL 后缀**和**类别 URL 后缀**设置为**.html**

有人有任何线索吗？

**解决了**

问题是任何脚本都无法使用 Mage::getStoreConfig() 获取任何配置

**刷新 Magento 缓存和缓存存储解决了问题。**

# android - Android 意图和 MODE_PRIVATE

> ID：13223406
> 
> 赞同：1
> 
> 时间：2012-11-04T22:03:06.727
> 
> 标签：android, android-intent

一年前我做了一个应用程序，我使用此代码将页面下载到本地文件，然后在浏览器意图中打开它：

```
FileOutputStream fos = openFileOutput("summary.html", Context.MODE_PRIVATE);
fos.write(msg.obj.toString().getBytes());
fos.close();
Intent i = new Intent(Intent.ACTION_VIEW);
i.setDataAndType(Uri.fromFile(getFileStreamPath("summary.html")),"text/html");
startActivity(i); 
```

它在当时奏效了。现在我不得不再次拿起应用程序，这不再有效。在浏览器意图窗口中，我得到一个

> 网页不可用
> 文件：//....的网页无法加载（等）

我仍在使用与一开始 (2.1) 相同的 android 版本运行，因此它与部署的操作系统版本无关。但是从那以后SDK已经更新了，也许有些改变了？

如果我从*MODE_PRIVATE*切换到*MODE_WORLD_READABLE*它可以工作，但意图不是以与调用应用程序相同的用户 ID 运行吗？

关于如何执行此操作并将文件保存在*MODE_PRIVATE*中的任何选项？

以及有关发生这种情况可能发生的变化的任何信息？我用谷歌搜索并没有发现任何东西......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T22:08:44.097

> 它在当时有效

我觉得这很难相信。

> 但是从那以后SDK已经更新了，也许有些改变了？

不，应用程序始终在自己的进程中运行，具有自己的用户 ID，因此没有其他应用程序可以访问您的`MODE_PRIVATE`文件。

> 如果我从 MODE_PRIVATE 切换到 MODE_WORLD_READABLE 它可以工作，但意图不是以与调用应用程序相同的用户 ID 运行吗？

不，对于您的短语“意图运行”的任何可能定义。每个应用程序都在自己的进程中运行，在自己的用户 ID 下。

> 关于如何执行此操作并将文件保存在 MODE_PRIVATE 中的任何选项？

自己显示在`WebView`.

# python - 如何在图形/绘图（在 matplotlib 中）上显示对象的值？

> ID：13223412
> 
> 赞同：1
> 
> 时间：2012-11-04T22:04:02.890
> 
> 标签：python, matplotlib, plot

我希望能够显示一个对象；在我的 matplotlib 图表上将其称为“坡度”。例如：

```
import numpy as np
import matplotlib.pyplot as plt

range1 = a[(-5\. <= a) & (-3\. >= a)]
range2 = b[(-5\. <= a) & (-3\. >= a)]

'''Calculate slope value from endpoints in the data range (linear).'''

xslopeentry1 = range1[0]
xslopeentry2 = range1[-1]
yslopeentry1 = range2[0]
yslopeentry2 = range2[-1]
Slope = (yslopeentry2-yslopeentry1)/(xslopeentry2-xslopeentry1)

plt.plot(range1,range2)
plt.show() 
```

现在，我将如何能够“打印”或在我的绘图上显示为“斜率”获得的值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T06:18:56.697

在 matplotlib 中添加文本有几个选项。对它们的最佳解释来自[文档](http://matplotlib.org/users/text_intro.html)。

出于您的目的，有 3 个选项可能有意义：

1.)[相对于轴的文本](http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.text)：

```
matplotlib.pyplot.text(Slope,x,y) 
```

其中 x 和 y 是文本相对于轴的坐标。

2.)[相对于图的文字](http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.figtext)：

```
matplotlib.pyplot.figtext(Slope,x,y) 
```

其中 x 和 y 是文本相对于图形的坐标

3.)[注释](http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.annotate)：

这将创建一个引用特定数据点的文本注释。这在这里没有多大意义，但它确实允许轻松创建箭头，如果您想要一个指向与坡度相关的线的箭头。

```
matplotlib.pyplot.annotate(Slope, xy=(xx, yy), xytext=(x, y),
        arrowprops=dict(facecolor='black', shrink=0.05)) 
```

其中 x 和 y 是文本坐标，xx, yy 是箭头指向的点的坐标。

**请注意，上面的示例仅将斜率的值放在图上。如果您想要“斜率：值”，请将上面的“斜率”替换为：

```
"Slope: {0}".format(Slope) 
```

# android - 我应该如何将我的 Android 设备连接到我的笔记本电脑（对于我的应用程序）？

> ID：13223413
> 
> 赞同：1
> 
> 时间：2012-11-04T22:04:19.030
> 
> 标签：android, bluetooth, usb, sync

我见过一些人以几种不同的方式提出这个问题，但答案总是太复杂或不够详细。

我想对参加机器人比赛的很多人进行调查。我问他们问题，并在我的基于 Android 的设备上的复选框、单选按钮、下拉菜单等中标记答案。事实上，我将有多个人与我一起工作并问人们与我相同的问题。我会让一个人坐在他的桌子旁，用一台笔记本电脑。每当有人让几个人填写表格时，他们需要将数据放在笔记本电脑上。这就是问题所在。

我们不会在这个位置使用 WiFi。我们可能会有蓝牙，我不确定，但似乎使用 USB 连接将是最简单的方法（如果我错了，请纠正我）。我有一个“同步”按钮。当他们按下“同步”时，Android 设备应将其所有新数据发送到笔记本电脑，而笔记本电脑应将其所有新数据（来自其他调查人员）发送到 android 设备。我在两个设备上都使用 java。我该如何进行这样的沟通？

这就是我*想要*的，但如果我需要使它更容易，我愿意将程序削弱为：您一次只能存储一个表单，并且“同步”按钮只会发送该 1 个表单安卓设备到笔记本电脑，笔记本电脑不会发回任何数据。这很好，因为他们真的应该在每张表格之后将文件发送到笔记本电脑，而且他们并不真的需要表格。

*编辑：*如果蓝牙更容易，请说出原因。我的猜测（如果更容易的话）是因为每个 Android 设备可能有不同的端口连接到笔记本电脑，但我认为蓝牙更难，因为我不确定如何将设备与笔记本电脑配对。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T09:06:03.053

你应该做什么：

1.  每部用于调查的手机都应该已经与您的笔记本电脑配对。你应该知道如何做到这一点。
2.  让您的表单等在没有通信部分的情况下执行您的 Android 应用程序，并确保在本地正确存储您的表单。
3.  对于传输，您只需在 PC 和 Android 上打开 BluetoothSockets。查看[BluetoothChat](http://code.google.com/p/android-bluetooth-chat/)示例。这很简单。请记住，由于 Android 启动连接，它应该是客户端，而 PC 是服务器。[这](http://developer.android.com/reference/android/bluetooth/package-summary.html)是 Android 文档页面。
4.  对于 PC 和智能手机的逻辑同步，您应该有某种协议。例如，起初他们都说他们有什么表格编号（PC 可能有表格编号 1-19、21、23）（Android 可能有表格编号 20-23）。然后他们将只交换独家信息。

如果它是有用的信息，请不要忘记投票。

# performance - 在 OpenGL 的视口之外绘图是否昂贵？

> ID：13223416
> 
> 赞同：4
> 
> 时间：2012-11-04T22:04:37.640
> 
> 标签：performance, opengl

我有几千个四边形要绘制，其中一些可能完全落在视口之外。我可以编写代码来检测哪些四边形完全落在视口之外，并要求 OpenGL 只绘制至少部分可见的四边形。或者，我可以简单地让 OpenGL 绘制所有四边形，无论它们是否与视口相交。

我没有足够的 OpenGL 经验来知道其中一个是否明显更好（或者 OpenGL 是否提供了一些我可以使用的快速视口交叉测试）。视口之外的绘制是否接近于无操作，或者它们是否足够昂贵以至于我应该尽量避免它们？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T23:16:12.117

这取决于你的情况。

绘制最好分批进行，最好是结构上是静态的批次（即：每个批次都是完整绘制的）。所以你不应该在四级水平上剔除。但是对大组的四边形进行一些剔除并不是不受欢迎的。

您将失去的主要性能是顶点变换（又名：您的顶点着色器）。顶点着色器必须在您提供的每个顶点上运行，不管其他什么。但是，硬件会丢弃视口之外的三角形，因此您不会吸收任何填充率或其他性能。

*但是*，这并不意味着您的顶点 T&L 便宜就可以。渲染不可见的大块三角形可能会使光栅化器停滞不前，因为所有三角形都被剔除。也就是说，如果您绘制了很多因离开屏幕而被剔除的东西，那么您可能在实际可见的三角形上使用的填充率可能会丢失。

因此，不顾一切地向 GPU 投掷几何图形并不是一个好主意。

在任何情况下，如果您正在执行 2D 渲染，那么对离散的四边形组进行粗略剔除确实是您所需要的。您可以将瓷砖地图分成屏幕大小的部分，并根据相机的位置最多绘制 4 个。

# c++ - 在 B 类中使用 A 类类型的向量

> ID：13223430
> 
> 赞同：4
> 
> 时间：2012-11-04T22:06:47.670
> 
> 标签：c++, class, vector

我创建了一个 A 类和一个 B 类，我试图在 A 中设置一个 B 类型的向量，在 B 中设置一个 A 类型的向量：

**A类标题：**

```
#ifndef A_H_
#define A_H_

#include "B.h"
#include <vector>
using namespace std;
class A {

public:
    vector<B> bvector; // here is the error
    A();
};

#endif /* A_H_ */ 
```

**B类标题：**

```
#ifndef B_H_
#define B_H_
#include "A.h"
#include <vector>

using namespace std;

class B {
vector<A> aVector; //Here is the error

public:
    B();
};

#endif /* B_H_ */ 
```

但我收到以下错误：

> “..\src/Bh:16:8: 错误: 'A' 未在此范围内声明
> 
> ..\src/Bh:16:9：错误：模板参数 1 无效
> 
> ..\src/Bh:16:9：错误：模板参数 2 无效”

如果我删除 B 中的坏行，则翻转到哪个`A.h`。我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T22:24:14.780

> 我创建了一个 A 类和一个 B 类，我试图在 A 中设置一个 B 类型的向量，在 B 中设置一个 A 类型的向量

您正在创建类之间的[循环依赖](http://en.wikipedia.org/wiki/Circular_dependency)关系。这通常是一件坏事，尤其是在 C++ 中。

编译器为了编译 A，需要知道 B 的定义（#include "Bh"）。不幸的是，B 标头包含对 A 类的引用（这里是循环引用）。编译器无法处理这种情况，因为 A 标头已包含在当前 TU 中（请参阅包含防护）。

尽管经常有循环引用是糟糕设计的征兆，但您最终可以使用前向声明来克服这个问题。例如，您可以这样修改 B：

```
#ifndef B_H_
#define B_H_

#include <vector>

using namespace std;
class A; //forward declaration of class A
class B {
vector<A*> aVector; //note that you must only use pointer to A now 

public:
    B();
};

#endif /* B_H_ */ 
```

Using a forward declaration basically tells the compiler that a type A will be defined somewhere else. The compiler can rely on this fact, but it does not know anything about A (particularly it ignores the size of A and its methods). So inside B, if you have forward declared A, you can use only pointers to A classes (pointers have always the same size) and you can't call any methods of an A class from inside B.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T22:20:59.363

这里的诀窍是您需要转发声明两个类之一。不幸的是，前向声明不允许您在标头中使用完整类型——它们只允许您使用指向该类型的指针。因此，即使在这种情况下也行不通。

你可以使用**PIMPL idiom (Pointer to IMPlementation)** (google that) 来规避这个问题。

PIMPL 成语基本上会让您创建第三种类型。然后你的 B 类型将持有一个指向包含 A 类型向量的实现类的指针。应该在 B 中保存的向量的所有操作都将转发到实际保存 A 向量的新实现类。

**例如：**

```
//Forward declare impl class.
class BImpl;

class B {
    private:
        BImpl* impl;

    public:
        void PrintVector() { impl->PrintVector(); }
};

class A {
    private:
        std::vector<B> vec;

    public:
        void PrintVector() { /* Do printing */ }
};

class BImpl {
    private:
        std::vector<A> vec;

    public:
        void PrintVector() { /* Do Printing */ }
}; 
```

我没有包含这些类的构造函数或填充方法，但是您应该了解总体思路:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T22:22:56.577

你有一个循环依赖。

`A.h`包括`B.h`which contains `A.h`，但是`A_H_`已经定义了守卫，因此`A.h`跳过了 的内容，因此`B.h`处理`A`了`A.h``#define``#include``A.h`

# video - 如何制作虚拟网络摄像头？（例如：Manycam）

> ID：13223432
> 
> 赞同：2
> 
> 时间：2012-11-04T22:07:08.020
> 
> 标签：video, streaming, virtual, webcam, skype

我一直在研究创建自己的视频捕捉和流媒体软件（我只是想挑战自己，所以这不是一个重要的项目）并且找到了我需要的所有信息，而不是如何将视频流式传输为一个虚拟网络摄像头。

例如，Manycam 将接受几个不同的输入（我已经介绍过），当您进入一个程序（如 Skype）时，它会被列为网络摄像头源。当您选择它作为网络摄像头源时，将显示您将 Manycam 软件设置为流式传输的任何内容。

我不是要答案。正如我所说，我正在接受挑战。我特别关注这是如何实现的，我在哪里可以开始研究这个？我一直在通过谷歌挖掘，只找到了我已经介绍过的屏幕录制信息。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-11T18:35:51.650

Windows 中有一些 API 可处理视频捕获并提供枚举设备的功能，并使用特定设备进行捕获：Video For Windows、DirectShow、Media Foundation。

长话短说，绝大多数现有应用程序都使用[DirectShow](http://msdn.microsoft.com/en-us/library/windows/desktop/dd375454%28v=vs.85%29.aspx)，包括 Skype。在 DirectShow 中，您可以创建软件用户模式视频源并实现虚拟视频设备以自定义流视频、复制源或合成任何内容。请参阅以下主题，其中包含指向其他问题的链接，这些问题正是讨论该主题，还指向示例项目：[Virtual webcam input as byte stream](https://stackoverflow.com/questions/8557723/virtual-webcam-input-as-byte-stream)。

# python - 带线程的交互式脚本

> ID：13223437
> 
> 赞同：1
> 
> 时间：2012-11-04T22:07:45.547
> 
> 标签：python, multithreading

我正在尝试使用线程将阻塞调用包装在 pyaudio 中，以使我能够通过队列进行非阻塞访问。但是，我遇到的问题不在于 pyaudio 或队列，而在于尝试测试线程的问题。为了与“尽可能少地剥离示例”保持一致，所有 pyaudio 的东西都消失了，只留下线程类及其在 main.c 中的实例化。

我希望的是一个我可以创建的对象，然后在后台继续处理它的东西，而我用控制台或 tk 来控制东西。我认为下面的 max-stripped 示例应该让线程做一些事情，而 main 运行并询问我它是否工作。raw_input 提示永远不会出现。如果我从 IDLE 运行它，我不会对此感到惊讶，这不是线程安全的，但如果我直接从操作系统运行脚本，我会得到相同的行为。我准备看到原始输入提示消失在“运行”打印推动的屏幕上，但即使这样也没有发生。提示永远不会出现。这是怎么回事？它确实响应 ctrl-C 并关闭窗口，但我仍然希望能够看到 main 运行。

```
import threading
import time

class TestThread(threading.Thread):
    def __init__(self):
        threading.Thread.__init__(self)
        self.running=True
        self.run()

    def run(self):        
        while self.running:
            time.sleep(0.5)
            print 'running'                            

    def stop(self):
        self.running=False

if __name__=='__main__':

    tt=TestThread()
    a=raw_input('simple stuff working ? -- ')
    tt.stop() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T22:10:02.133

您应该使用 self.start() 而不是 self.run() 来启动线程。在这种情况下，您只是像运行任何其他普通函数一样运行线程函数。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-04T22:13:57.823

通常你不会从 Thread 继承。相反，您使用`Thread(target=func2run).start()`

# c - 动态分配的结构数组中的 SegFault，C

> ID：13223438
> 
> 赞同：0
> 
> 时间：2012-11-04T22:07:59.737
> 
> 标签：c, struct, segmentation-fault, dynamic-allocation

```
typedef struct {
  double x;
  double y;
  long out_x;
  long out_y;
} coords;

typedef struct {
  char name[FIGURE_LEN + 1];
  int coordcount, size_tracker;
  coords *coordinate;
} fig;

fig figure;
fig * figpoint; 
```

这是从 parser.c 源文件中调用的函数。

```
void initialize_fig(int n, char * name, double x, double y,
                         fig *fig_point)
{
  printf("inside function\n");
  strncpy(fig_point[n].name, name, FIGURE_LEN + 1);
  fig_point[n].size_tracker = 1;
  fig_point[n].coordinate = malloc(sizeof(coords) * fig_point[n].size_tracker);
  assert(fig_point[n].coordinate != NULL);
  fig_point[n].coordcount = 0;
  fig_point[n].coordinate[fig_point[n].coordcount].x = x;
  fig_point[n].coordinate[fig_point[n].coordcount].y = y;
}

void create_FigArray(fig * fig_point, int fig_size)
{
  fig_point = malloc(sizeof(fig) * fig_size);
  assert(fig_point != NULL);
  fig_point = &figure
} 
```

我首先像这样调用create_FigArray ...

```
create_FigArray(fig_point, 16); 
```

我在这里没有seg错误......但后来我打电话......

```
initialize_fig(0, Qe, 10.0000, 10.0000, fig_point); 
```

参数实际上是通过变量传递的，但我只是想表明它们是正确的参数，并举例说明传递了什么值。无论如何它击中

```
strncpy(fig_point[n].name, name, FIGURE_LEN + 1); 
```

并停止.. segfault 必须在这里发生，但为什么呢？！

请帮助，解释并展示如何解决这个问题。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:12:29.107

您分配内存，然后更改指针

```
fig_point = malloc(sizeof(fig) * fig_size); // allocate here
assert(fig_point != NULL);
fig_point = &figure;  // now you make fig_point point to something else 
```

因此您的`fig_point`指针不再指向您动态分配的内存。如果你这样做

```
fig_point[n] 
```

您正在访问内存或范围，因为`figure`它不是数组。此外，您直接将指针传递`fig_point`给`create_FigArray`。这将创建指针的副本，因此您对该参数所做的任何更改实际上只是对`copy`. 这意味着您在`fig_array`之后存储的地址`create_FigArray`返回的动态内存与之前相同 - 它只是`copy`函数更改的内存。如果要更改指针，则需要对函数使用双指针参数，然后使用类似

```
void create_FigArray(fig** fig_point, int fig_size)
{
    *fig_point = malloc(sizeof(fig) * fig_size);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T22:13:14.343

我不知道，但是：

首先你为 fig_point 分配内存：

```
fig_point = malloc(sizeof(fig) * fig_size); 
```

之后，您将 figure 的地址分配给它，您不应该这样做。

```
fig_point = &figure; 
```

你可以这样做：

```
figure = *fig_point; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T22:25:14.387

*   在`create_FigArray`你这样做： fig_point = malloc(sizeof(fig) * fig_size); 然后这个： `fig_point = &figure; //figure is a global variable and this causes a memory leak`

*   而是这样写：

> ```
> void create_FigArray(fig * fig_point, int fig_size)
> {
>   fig_point = malloc(sizeof(fig) * fig_size);
>   assert(fig_point != NULL);
>   fig_point = &figure;//Remove this line
> } 
> ```

*   在您调用`initialize_fig()`或某处的函数中，确保释放分配的内存。

*   使用前将所有指针设为 NULL，并在处理指针的函数中添加 NULL 参数检查，并在使用前检查 NULL 指针。

# asynchronous - AMD 插件中的 Dojo 要求未触发回调

> ID：13223448
> 
> 赞同：0
> 
> 时间：2012-11-04T22:09:02.283
> 
> 标签：asynchronous, dojo

在以下插件中，正确调用了 load 方法，但从未触发过内部回调：

```
define("App/FooLoader", [], function() {

    return {

        load: function(id, require, callback) {
            require(["App/Foo"], function(foo) {
                callback(foo);
            });

        }
    }
}); 
```

有了上述内容，我期待包含在内时，如下所示：

```
// in Bar.js
require(['App/Fooloader!'], function(foo) { // do stuff with foo }); 
```

那：

1.  `App/FooLoader`已加载，并`load`执行该方法
2.  `App/Foo`被加载，内部回调被执行
3.  `App/FooLoader`body 回调与`foo`loading 的结果一起执行`App/Foo`。

但是，只有 (1) 发生，回调 (2) 和 (3) 永远不会发生。怎么会？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T01:01:01.877

它对我有用，如下所示：

```
define("App/Foo", [], function() {
    return 'bar';            
});
define("App/FooLoader", [], function() {
    return {
        load: function(id, require, callback) {
            console.log('inside load', arguments);
            require(["App/Foo"], function(foo) {
                console.log('inside require, foo=', foo);
                callback(foo);
            });
        }
    }
});

require(["App/FooLoader!"], function(fooload) {
  console.log('fooloaded', fooload);
})​ 
```

我创建了这个 JSFiddle 来演示：http: [//jsfiddle.net/fMR3Z/1/](http://jsfiddle.net/fMR3Z/1/)

也许您的文件结构有错误？

# php - 为什么 urlencode 和 urldecode 不起作用？

> ID：13223451
> 
> 赞同：2
> 
> 时间：2012-11-04T22:09:27.427
> 
> 标签：php, url, get

这是我正在使用的代码：

```
$from=urldecode($_GET['from']);
$str =urldecode("%2B");
echo "$str<br>";
echo "$from<br>"; 
```

这是网址的一部分：`from=%2B995594262653`

为什么这回声

```
+
 995594262653 
```

? （注意，数字前面有一个空格）。我`$str`用来检查该功能是否有效。显然，它适用于简单的`%2B`. 可能是什么问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T22:17:49.510

它正在工作，但您需要意识到 PHP 会自动对它放入 $_GET 数组中的数据[进行 urldecode 。](http://www.php.net/manual/en/reserved.variables.get.php)您正在*第二*次执行此操作并进一步转换输入。

当您的脚本运行时，`$_GET['from']`包含`+995594262653`

当您通过 urldecode 运行该值时，`+`将转换为空格。

# php - 在 Wordpress 中获取循环之外的帖子摘录

> ID：13223455
> 
> 赞同：2
> 
> 时间：2012-11-04T22:10:13.160
> 
> 标签：php, wordpress

在过去的三天里，我一直在尝试使用以下代码**在 Loop 之外获取帖子的摘录：**

```
1) <?php the_excerpt(); ?>
2) the_excerpt();
3) <?php get_the_excerpt(); ?>
4) get_the_excerpt();
5) '.apply_filters('the_excerpt',get_the_excerpt()).' 
```

以上都不起作用，我认为这是因为我试图将摘录放在循环之外。一些在插件页面上生成的文本，一些在不同的位置破坏了我的主题，还有一些完全没有做任何事情。我什至用谷歌搜索了从循环外部获取摘录的方法，但是对于其中大多数，您必须输入`post_id`要从中摘录的内容。

这是应该输出异常的完整代码。我列出了我认为摘录应该放在哪里的 div “摘录”：

```
private function cg_get_title($single) {
    global $cg_url;
    if($this->params['title']) {
        $title_array = get_post_meta($single->ID, $this->params['title']);
        $title = $title_array[0];
        if(!$title) {
            $title = $single->post_title;
        }
    }
    else {
        $title = $single->post_title;
    }
    $returnlink = ($this->params['lightbox']) ? ('"' . $cg_url . '/includes/CatGridPost.php?ID=' . $single->ID . '" class="cgpost"') : ('"' . get_permalink($single->ID)) . '"';
    $cgfontsize = $this->cg_get_font_size();
    $cgtitle = '<div class="cgback cgnojs ' . $this->params['showtitle'] . '"></div><div class="cgtitle cgnojs '
            . $this->params['showtitle'] . '"><p style="font-size:' . $cgfontsize . 'px;line-height:' . (1.2 * $cgfontsize) . 'px;">
            <a href=' . $returnlink . '>' . $title . '</a></p><DIV ID="EXCERPT">EXCERPT SHOULD GO HERE</DIV></div>';
    return $cgtitle;
} 
```

再说一次，我现在真的不知道该去哪里，所以我来到了这里。有没有人可以帮助我用这个插件显示每篇文章的摘录？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T23:37:02.663

`$post->post_excerpt`假设您有一个帖子对象，您可以使用 获取未过滤的帖子摘录。在上面的代码中，您需要调用：

```
$excerpt = apply_filters('get_the_excerpt', $single->post_excerpt); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-04-01T05:58:17.727

我正在使用以下函数，它通过 $post_id 获取帖子，如果它在 admin 中设置了摘录，则返回它，如果没有，它使用 WordPress 函数生成它。我喜欢它，因为这样创建的摘录尊重您的 WP 设置，并且将具有与以标准方式在循环中创建的其他摘录相同的样式。

```
function my_excerpt($post_id) {
    $post = get_post($post_id);
    if ($post->post_excerpt) {
        // excerpt set, return it
        return apply_filters('the_excerpt', $the_post->post_excerpt);

    } else {
        setup_postdata( $post );
        $excerpt = get_the_excerpt();
        wp_reset_postdata();
        return $excerpt;
    }
} 
```

# css - Safari 的对齐问题 - 几个 px 差距

> ID：13223458
> 
> 赞同：0
> 
> 时间：2012-11-04T22:10:35.413
> 
> 标签：css, alignment

由于某种原因，我的标题没有完全对齐。我设置了 100% 的宽度，但有一些像素间隙（顶部和左侧 - 见图）。我怎样才能解决这个问题？Tks

![在此处输入图像描述](../Images/395312f0a0f2b32f06263a08ae0b8f87.png)

```
#header {
position:absolute; 
top:0px; 
left:0px; 
width: 100%;
height:50px;
background: #FFF; /* Fallback background color for non supported browsers */         
background-image: -moz-linear-gradient(top, #fff, #f3F3F3); /* Firefox 3.6 */
background-image: -webkit-gradient(linear,left bottom,left top,color-stop(0, #F3F3F3),color-stop(1, #fff)); /* Safari & Chrome */
filter: progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='#fff', endColorstr='#F3F3F3'); /* IE6 & IE7 */
-ms-filter: "progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='#fff', endColorstr='#F3F3F3')"; /* IE8 */
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T22:12:07.970

尝试 ：

```
html, body
{
margin:0;   
padding:0;   
} 
```

html 或 body 标签有一个默认的边距或填充。这应该清除它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T22:12:16.110

尝试将其添加到您的 CSS 中。

```
*{padding: 0; margin: 0;} 
```

希望能帮助到你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T22:17:03.740

发生这种情况的原因很可能是因为您`#header`的位置绝对*相*对于`body`可能具有填充或边距的位置。*或者*它可以相对于`html`可能具有填充或边距的位置定位。

因此，请尝试为`html`to`0`或为`body`

```
html {
    padding: 0;
    margin: 0;
} 
```

或者

```
body {
    padding: 0;
    margin: 0;
} 
```

或两者 ：）

绝对*不要*做 Marko Franceković 建议的事情，因为这会将所有元素的填充和边距设置为`0`

# macos - 类似于 acme 的现代文本编辑器

> ID：13223460
> 
> 赞同：10
> 
> 时间：2012-11-04T22:10:49.937
> 
> 标签：macos, ide, editor, sublimetext2, vi

在使用 vi 15 年的大部分时间后，我在使用 Go 时一时兴起尝试了 Rob Pike 的 Acme。我真的很喜欢它的小巧轻便。现代 unix 风格的东西在 Acme 中表现不佳，而 Ruby 开发在那种环境中充其量是令人讨厌的（然而，它与 Go 和 C 配合得很好）。

我已经在 vim 中适应了 Acme 的一些“特性”，但我现在正在寻找选项。是否有任何文本编辑器具有以下（有些主观的）功能而不是其他功能？

*   没有语法高亮或行号
*   在 osx 和 linux 上运行
*   缓冲区/窗口分割
*   浅色背景，深色前景（或改变这一点的能力）
*   几乎没有膨胀
*   在编辑器中运行打开终端或从中运行命令的能力

我不知道有任何编辑器可以为我提供 Acme 的鼠标支持，但这些天我使用的是魔术触控板，所以没有必要。我尝试过 Sublime，但感觉有点臃肿，而且拆分窗口会浪费空间。全屏模式接近我正在寻找的内容，但我无法确定缺少的内容。如果我也可以在窗口中打开终端，Sublime 可能会起作用。

我目前的环境是 iTerm2 全屏，使用 vim 进行代码编辑。这工作相对较好，但使用鼠标会很方便。我搜索的一个巨大动力是 Aqua 用窗口边框/阴影浪费了太多空间，并且没有足够的平铺窗口管理器可用于 OSX。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T22:47:15.090

我不知道有任何模仿 Acme 的“现代”编辑器，但您所要求的一切都在 Vim 和 Emacs 中，但它们可能不是您所说的“现代”，而且它们的操作与 Acme 的操作完全相反。

不过，列表中的最后一项在 Emacs 中比在 Vim 中更容易、更自然。

我知道您想要一个 GUI 编辑器，但您似乎抱怨 Mac OS X 的窗口管理。我的印象是，您在真正的平铺桌面环境中会很自在。您是否尝试过 Awesome 或 WMII 或其他？

最后，您可以使用鼠标在 Vim 中进行光标定位、视觉选择、窗口焦点和单击选项卡，只需`set mouse=a`在`~/.vimrc`.

除了我在 Acme 中看到的用鼠标完成的非常特别的东西之外，我认为你想要的一切都在那里：

![vim](../Images/d0ccad204d768c6a649a31e7f7085133.png)

# jquery - 随着窗口大小的变化，调整 div 中所有图像的大小

> ID：13223461
> 
> 赞同：0
> 
> 时间：2012-11-04T22:10:59.720
> 
> 标签：jquery, html, css, image, scale

我有一个创建为主页的图像。我使用 Photoshop 将其切片并将其保存为一组样式化的 div。通常，当我制作这种性质的网站时，我会创建一些不同的大小并使用 javascript 来检测可用的窗口大小并加载适当的页面。我想加强我的游戏并做同样风格的网站，但是使用某种形式的 jquery 来重新调整所有图像的大小，同时随着屏幕变小/变大来限制比例。网站可以有一个最大尺寸并变得更小，甚至可能加载最大尺寸取决于可用的屏幕宽度/高度。

现在我找到了一个名为[jquery-imagefit](http://www.ollicle.com/projects/jquery/imagefit/eg/)的插件，它在随窗口大小变化缩放图像方面做得很好。由于某种原因，当我实现它时，图像彼此分离，从而在每个图像之间产生间隙。

谁能帮我在这个网站上实现 imagefit。理想情况下，图像会漂浮在屏幕底部并从那里增长和缩小。这是该页面的链接：

[http://www.uvm.edu/~areid/homesite/div-style/index.html](http://www.uvm.edu/~areid/homesite/div-style/index.html)

谢谢

凯蒂

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T23:05:11.470

如果我理解正确，请尝试不要在图像标签中应用宽度并将 DIV 的 CSS 设置为：

```
#divID img {
    max-width: 100%;
    max-height: 100%;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T00:13:37.353

正如我上面建议的，您可以使用 CSS 浮动来组织图像并使用百分比调整它们的大小。

我输入了一些可能对你有帮助的代码。

HTML：

```
<div class="everything">

    <div class="row">
        <img src="http://www.uvm.edu/~areid/homesite/div-style/images/01.gif" style="width:100%">
    </div>

    <div class="row">
        <img src="http://www.uvm.edu/~areid/homesite/div-style/images/02.gif" style="width:31%">
        <img src="http://www.uvm.edu/~areid/homesite/div-style/images/forehead-mouse.gif" style="width:38%">
        <img src="http://www.uvm.edu/~areid/homesite/div-style/images/04.gif" style="width:31%">
    </div>

</div>​ 
```

CSS：

```
.everything{
    width:100%;
}

.row{
    overflow:hidden;
}

.row img{
    float:left;
}​ 
```

您可以在 JSfiddle 上查看：http: [//jsfiddle.net/9MEn7/5/](http://jsfiddle.net/9MEn7/5/)

显然，这不是我创建的完整解决方案，但它应该可以帮助您入门。我建议您以更实际的方式切割图像，例如将“行”中的图像设置为相同的高度。

# java - 错误“主要无法解析或不是字段”

> ID：13223464
> 
> 赞同：2
> 
> 时间：2012-11-04T22:11:50.400
> 
> 标签：java, android, google-maps-api-3, syntax-error

“主要无法解决或不在字段中”它在 setcontentview 的主要活动中给出错误“主要无法解决或不在字段中。
这是我的代码请帮助我，因为我厌倦了寻找出路请删除此错误“这是我的主要活动”

```
package com.exampl.goglemaps;

import android.os.Bundle;
import com.exampl.goglemaps.R;
import com.google.android.maps.MapActivity;
import com.google.android.maps.MapView;

public class MainActivity extends MapActivity {

    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        //fetch the map view from the layout
        MapView mapView = (MapView) findViewById(R.id.mapview);

        //make available zoom controls
        mapView.setBuiltInZoomControls(true);
    }

    @Override
    protected boolean isRouteDisplayed() {

        return false;

    }
} 
```

我的清单文件

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.exampl.goglemaps"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="14" />

    <uses-permission android:name="android.permission.INTERNET"/>

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
      <uses-library android:name="com.google.android.maps" />
    </application>
</manifest> 
```

那是我的xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

       <com.google.android.maps.MapView
        android:id="@+id/mapview"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:apiKey="Your Google Maps API key"
        android:clickable="true" />
</LinearLayout> 
```

**这在 setContentView(R.layout.main) 中调用 mainactivity 中的错误；说“主要不能解决或不在一个领域”**我几乎搜索了每个论坛但未能通过这个，请帮助我解决这个错误。

# 标题

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:15:42.230

我认为您应该使用`R.layout.MainActivity`.`R.layout.main`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-19T07:28:56.833

您也可以尝试activity_main，当您使用eclipse创建应用程序时会发生这种情况您将活动名称保留为activity_main（通常有些人不会更改）并且很少有人根据他们的约定进行更改。

# android - Android中多项选择测验中的滑动效果

> ID：13223467
> 
> 赞同：1
> 
> 时间：2012-11-04T22:12:13.960
> 
> 标签：android, android-activity, android-animation, android-dialog, android-sliding

我在多项选择测验应用程序中面临一个问题，其中只有一项活动一一显示所有问题。当前场景：屏幕上出现多项选择题，如果答案正确，则会显示一个对话框，然后对话框在延迟一段时间后关闭，并在同一活动中加载下一个问题。我面临的问题是：如果我想加载下一个问题（如果答案正确），在同一活动中关闭对话框后，该问题会自动从正确的方向滑入（而不是通过滑动），我该如何进行相同的操作？任何指针？谢谢您的帮助。

# c# - RESTful API 中的向后兼容性

> ID：13223470
> 
> 赞同：4
> 
> 时间：2012-11-04T22:12:28.010
> 
> 标签：c#, .net, rest, asp.net-web-api

我目前正在设计一个使用 ASP.NET Web API 实现的 RESTful API。
非常重要的一点是向后兼容性。
我想让实际的 API 代码没有任何关于向后兼容性的想法，以确保干净和最新的设计。
我想通过有一层版本翻译器来解决这个问题。
这些翻译器中的每一个都知道如何将一个特定版本 (vPrevious) 的请求和响应转换为另一个特定版本 (vCurrent) 的请求和响应。
这些翻译器可以轻松堆叠，以确保与任意数量的旧版本向后兼容。
这些翻译器中的每一个都将负责做各种事情，比如为新属性设置默认值，甚至执行一系列不同的操作。

我考虑过实现一个`DelegatingHandler`检查客户端想要使用的 API 的版本号，并据此知道要使用哪些翻译器。
但是，我看不到我将如何实际实施这一点。正如我所看到的，每个翻译器实际上都需要一个完整的 ASP.NET Web API，以及一个路由表和控制器。这实际上是可以接受的，但是翻译控制器如何将数据路由到链中的下一个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T23:13:20.233

我认为最干净的方法是让您需要支持的每个版本保持运行。这意味着每个版本在您的 VCS 中都有自己的分支，并且专注于为使用该特定版本的客户端提供服务。代码很干净，专注于一个版本。如果您需要处理通用组件/数据库等，我认为您应该在架构中进一步实现该层，而不是在 REST API 层中。这个版本控制层应该是第一层，位于 REST API 之后。

如果它真的不起作用，我可能会设计它，以便最新的 API 是唯一适用于您的真实后端的 API。其他版本只是通过常规 HTTP 请求调用其他版本……旧版本是新 API 的 REST 客户端。这不是超级快，但设计非常简洁，并且很容易理解版本控制代码的去向。如果您有许多客户端使用旧的 API 版本，这可能会导致解决方案太慢，您需要找到更有效的方法来做到这一点，但是，我们几乎回到了第一个解决方案。

# jquery - 按日期排序 HTML/JavaScript 时间线（按最旧/最新排序）

> ID：13223472
> 
> 赞同：1
> 
> 时间：2012-11-04T22:12:39.090
> 
> 标签：jquery

我正在尝试为我的 HTML/JavaScript 时间线创建一个功能，以便在页面加载时按最新日期（英国格式）对条目进行排序，并为用户提供按最新/最旧条目对时间线条目进行排序的选项。

我将如何做到这一点？我希望对所有具有日期 id 的 div`<div id="date">17/10/2011</div>`进行排序（排序时带有简短的动画）。这是我到目前为止所做的：http: [//jsfiddle.net/Rf5ww/1/](http://jsfiddle.net/Rf5ww/1/)

HTML

```
<div id="containertop" >
    <a href="#">Newest First</a><br>
    <a href="#">Oldest First</a>
</div>
  <div id="container">

       <div class="timeline_container">
            <div class="timeline">
                <div class="plus"></div>
            </div>
        </div>

      <div class="item ">
           <a href='#' class='deletebox'>X</a>
          <div><div id="date">12/10/2012</div>
              <div id="content">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas sit amet metus tellus. Suspendisse potenti. Fusce et arcu magna. In hac habitasse platea dictumst. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam luctus tempor euismod. Cras quis tellus nisl, tincidunt feugiat arcu. In tristique lorem a leo tincidunt mattis. Proin eu augue sit amet urna dictum malesuada et vitae est. Donec vitae mauris ipsum. Curabitur imperdiet condimentum aliquet. Aenean a lectus purus. Integer sodales leo quis tellus rutrum sagittis non mattis tellus. Curabitur ornare quam non felis luctus non facilisis nibh ultrices.
</div>
</div>
          </div>
<div class="item ">
 <a href='#' class='deletebox'>X</a>
          <div><div id="date">17/10/2011</div>
              <div id="content">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas sit amet metus tellus. Suspendisse potenti. Fusce et arcu magna. In hac habitasse platea dictumst. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam luctus tempor euismod. Cras quis tellus nisl, tincidunt feugiat arcu. In tristique lorem a leo tincidunt mattis. Proin eu augue sit amet urna dictum malesuada et vitae est. Donec vitae mauris ipsum. Curabitur imperdiet condimentum aliquet. Aenean a lectus purus. Integer sodales leo quis tellus rutrum sagittis non mattis tellus. Curabitur ornare quam non felis luctus non facilisis nibh ultrices.
</div>
        </div>        
      </div>
      <div class="item ">
 <a href='#' class='deletebox'>X</a>
              <div>
       <div id="date">10/10/2011</div>
                  <div id="content">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas sit amet metus tellus. Suspendisse potenti. Fusce et arcu magna. In hac habitasse platea dictumst. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam luctus tempor euismod. Cras quis tellus nisl, tincidunt feugiat arcu. In tristique lorem a leo tincidunt mattis. Proin eu augue sit amet urna dictum malesuada et vitae est. Donec vitae mauris ipsum. Curabitur imperdiet condimentum aliquet. Aenean a lectus purus. Integer sodales leo quis tellus rutrum sagittis non mattis tellus. Curabitur ornare quam non felis luctus non facilisis nibh ultrices.
</div>
         </div>
      </div>

      <div class="item">
 <a href='#' class='deletebox'>X</a>
              <div>
                  <div id="date">02/12/2011</div>
                  <div id="content">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas sit amet metus tellus. Suspendisse potenti. Fusce et arcu magna. In hac habitasse platea dictumst. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam luctus tempor euismod. Cras quis tellus nisl, tincidunt feugiat arcu. In tristique lorem a leo tincidunt mattis. Proin eu augue sit amet urna dictum malesuada et vitae est. Donec vitae mauris ipsum. Curabitur imperdiet condimentum aliquet. Aenean a lectus purus. Integer sodales leo quis tellus rutrum sagittis non mattis tellus. Curabitur ornare quam non felis luctus non facilisis nibh ultrices.
</div>
    <br/><br/>
                <script type="text/javascript"><!--
                google_ad_client = "ca-pub-6904774409601870";
                /* newtwitter */
                google_ad_slot = "7972402542";
                google_ad_width = 336;
                google_ad_height = 280;
                //-->
                </script>
                <script type="text/javascript"
                src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
                </script>
              </div>        
          </div>
        <div class="item">
     <a href='#' class='deletebox'>X</a>
                  <div>

                    <div id="date">13/10/2013</div>

                      <div id="content">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas sit amet metus tellus. Suspendisse potenti. Fusce et arcu magna. In hac habitasse platea dictumst. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam luctus tempor euismod. Cras quis tellus nisl, tincidunt feugiat arcu. In tristique lorem a leo tincidunt mattis. Proin eu augue sit amet urna dictum malesuada et vitae est. Donec vitae mauris ipsum. Curabitur imperdiet condimentum aliquet. Aenean a lectus purus. Integer sodales leo quis tellus rutrum sagittis non mattis tellus. Curabitur ornare quam non felis luctus non facilisis nibh ultrices.
</div>

                  </div>        
              </div>
      <div class="item">
 <a href='#' class='deletebox'>X</a>
              <div>
                  <div id="date">12/10/2014</div>
                  <div id="content">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas sit amet metus tellus. Suspendisse potenti. Fusce et arcu magna. In hac habitasse platea dictumst. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam luctus tempor euismod. Cras quis tellus nisl, tincidunt feugiat arcu. In tristique lorem a leo tincidunt mattis. Proin eu augue sit amet urna dictum malesuada et vitae est. Donec vitae mauris ipsum. Curabitur imperdiet condimentum aliquet. Aenean a lectus purus. Integer sodales leo quis tellus rutrum sagittis non mattis tellus. Curabitur ornare quam non felis luctus non facilisis nibh ultrices.
</div>
      </div>

    </div>

    </div>​ 
```

CSS

```
body { background-color: #E7EBF2; font-family:arial; font-size:13px }
#container, #containertop    {    width:860px; margin: 0 auto;     }

.borderclass { border:1px solid #A9B6D2; }
.item {
  width: 408px;
  margin: 10px;
  float: left;
  margin-top:10px;
  background-color:#ffffff;
  border:solid 1px #B4BBCD;
min-height:50px;
text-align:justify;
word-wrap:break-word; 
}
.topbox
{
margin: 10px;

margin-top: 10px;
background-color: white;
border: solid 1px #B4BBCD;

}

.item div, .topbox div
{
padding:8px;    
}
.rightCorner { 
    background-image: url("images/right.png");
    display: block;
    height: 15px;
    margin-left: 408px;
    margin-top: 8px;
    padding: 0;
    vertical-align: top;
    width: 13px;
z-index:2;

    position: absolute;
}
.leftCorner{
background-image: url("images/left.png");
display: block;
height: 15px;
width: 13px;
margin-left: -13px;
margin-top: 8px;
position: absolute;
z-index:2;
}
#popup{ display: block; 
 width: 408px;
  float: left;
  margin-top:10px;
  background-color:#ffffff;
  border:solid 1px #A9B6D2;
  min-height:60px;
  display:none;
  position:absolute;
  margin:10px;
 }
.Popup_rightCorner
{
background-image: url("images/right.png");
    display: block;
    height: 15px;
    margin-left: 408px;
    margin-top: 8px;
    padding: 0;
    vertical-align: top;
    width: 13px;
z-index:2;

    position: absolute;
}
 #box
{
padding:8px;    

}
#update
{
width:100%;
}

 .timeline_container{
                width: 16px;
                text-align: center;
                margin: 0 auto;
                cursor:pointer;
                    display: block;
            }
            .timeline{

                margin: 0 auto;
                 background-color:#e08989;
    display: block;
    float: left;
    height: 100%;
    left: 428px;
    margin-top: 10px;
    position: absolute;
    width: 4px;
            }
            .timeline:hover{
                cursor: pointer;
                margin: 0 auto;
            }
            .timeline div.plus{
                width: 14px;
                height: 14px;

                position: relative;
                left: -6px;
            }
            #update_button {
background-color: #cc0000;
color: white;
font-weight: bold;
padding: 5px;
border: solid 1px #333;
margin-top: 5px;
cursor: pointer;
}
.shade{box-shadow:0px 0px 18px #000;-moz-box-shadow:0px 0px 18px #000;-webkit-box-shadow:0px 0px 18px #000}
h1{ font-family: 'Georgia',Times New Roman; }
.timeline:hover
{
cursor: none;
}
.deletebox
{
font-weight:bold;
float:right;
text-decoration:none;
margin:8px 10px 8px 10px;
color:#cc0000
}​ 
```

JS

```
$(document).ready(function() {

    function Arrow_Points() {
        var s = $('#container').find('.item');
        $.each(s, function(i, obj) {
            var posLeft = $(obj).css("left");
            $(obj).addClass('borderclass');
            if (posLeft == "0px") {
                html = "<span class='rightCorner'></span>";
                $(obj).prepend(html);
            }
            else {
                html = "<span class='leftCorner'></span>";
                $(obj).prepend(html);
            }
        });
    }

    $('.timeline_container').mousemove(function(e) {
        var topdiv = $("#containertop").height();
        var pag = e.pageY - topdiv - 26;
        $('.plus').css({
            "top": pag + "px",
            "background": "url('images/plus.png')",
            "margin-left": "1px"
        });
    }).
    mouseout(function() {
        $('.plus').css({
            "background": "url('')"
        });
    });

    $("#update_button").live('click', function() {
        var x = $("#update").val();
        $("#container").prepend('<div class="item"><a href="#" class="deletebox">X</a><div>' + x + '</div></div>');

        //Reload masonry
        $('#container').masonry('reload');

        $('.rightCorner').hide();
        $('.leftCorner').hide();
        Arrow_Points();

        $("#update").val('');
        $("#popup").hide();
        return false;
    });

    // Divs
    $('#container').masonry({
        itemSelector: '.item',
    });
    Arrow_Points();

    //Mouseup textarea false
    $("#popup").mouseup(function() {
        return false
    });

    $(".timeline_container").click(function(e) {
        var topdiv = $("#containertop").height();
        $("#popup").css({
            'top': (e.pageY - topdiv - 33) + 'px'
        });
        $("#popup").fadeIn();
        $("#update").focus();

    });

    $(".deletebox").live('click', function() {
        if (confirm("Are your sure?")) {
            $(this).parent().fadeOut('slow');
            //Remove item
            $('#container').masonry('remove', $(this).parent());
            //Reload masonry
            $('#container').masonry('reload');
            $('.rightCorner').hide();
            $('.leftCorner').hide();
            Arrow_Points();
        }
        return false;
    });

    //Textarea without editing.
    $(document).mouseup(function() {
        $('#popup').hide();

    });

});​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T22:39:25.070

将所有`id="date"`' 切换为`class="date"`' 后，您应该执行以下操作：

# [---> 这里是 JSFiddle <---](http://jsfiddle.net/vDN3w/4/)

或见下文...

```
$(function(){
    var itemsArray = $('div.item');
    itemsArray.sort(function(a,b){
        var aTime = new Date($(a).find('.date').text()).getTime();
        var bTime = new Date($(b).find('.date').text()).getTime();
        return aTime - bTime;
    });

    $('#sortAsc').click(function(){
        $("#container").empty();
        $(itemsArray).each(function(){
            $("#container").prepend($(this));
        });
    });

    $('#sortDesc').click(function(){
        $("#container").empty();
        $(itemsArray).each(function(){
            $("#container").append($(this));
        });
    });
}) 
```

# facebook - Facebook like 按钮弹出出现然后消失在没有其他内容的页面上

> ID：13223476
> 
> 赞同：0
> 
> 时间：2012-11-04T22:13:36.560
> 
> 标签：facebook, facebook-like, flyout

我在我的页面上添加了一个类似 facebook 的按钮，但是当单击它时，弹出窗口会出现，然后消失。

起初我以为是页面上的其他元素隐藏了它，但即使在空白页面上问题仍然存在。

尝试了 facebook 生成的 iframe 和 html 5 代码，但似乎都不起作用。

iframe - [http://jsfiddle.net/aDK95/1/](http://jsfiddle.net/aDK95/1/) Html 5 - [http://jsfiddle.net/L9nZZ/1/](http://jsfiddle.net/L9nZZ/1/)

在这两种情况下，它似乎都被 hidden_​​elem 类隐藏了：

```
 #facebook .hidden_elem {
display: none !important;
} 
```

它似乎与5 月份在 FB 上报告的[这个错误](http://developers.facebook.com/bugs/333196690088728?browse=search_5096e5c9eb3261e85539689)非常相似。不过似乎并没有太大的动静。

有没有其他人遇到过这个？知道任何解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T08:26:59.150

我遇到了这个错误，它让我困惑了很长一段时间。我采取的纠正措施如下：

1.  确保您已放入 Javascript SDK 初始化
2.  确保#fbroot div 不在隐藏的 div 中
3.  在页面上的 Open Graph 标记中，og:url 必须设置为 https 协议而不是 http 协议

[通过https://developers.facebook.com/tools/debug](https://developers.facebook.com/tools/debug)上的 Facebook 调试器运行您的页面以检查是否有任何错误。另一个帮助我解决这个问题的有趣点是，当您在 Like 配置器中输入“URL to Like”值时，生成的动态喜欢按钮会显示该 url 是否可以正常工作。

# jquery - jquery淡入淡出addClass

> ID：13223481
> 
> 赞同：0
> 
> 时间：2012-11-04T22:14:12.870
> 
> 标签：jquery

我正在使用 jQuery 将类应用于悬停时的元素，即`addClass('active')`

该类添加了一个边框并更改了背景颜色，但我希望这些更改淡入，而不是仅仅打开或关闭。

这是否可以使用 jQuery 即添加一个类并让该类添加的效果淡入？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T22:18:00.963

尝试使用 jQuery UI [.addClass](http://jqueryui.com/addClass/)和[.removeClass](http://jqueryui.com/removeClass/)。

```
$(function() {
    $("div.className").hover(function() {
        $(this).stop(true,true).addClass("active", 500);
    }, function() {
        $(this).stop(true,true).removeClass("active", 100);
    });    
}); 
```

您还可以使用 .animate 来获得所需的效果。见下文，

请注意，您需要[jQueryUI](http://jqueryui.com/)才能正常工作。

```
$(function() {
    $("div.className").hover(function() {
        $(this).stop().animate({
            backgroundColor: "#a7bf51"
        }, 800);
    }, function() {
        $(this).stop().animate({
            backgroundColor: "#FFFFFF"
        }, 800);
    });

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T22:17:06.540

如果您使用 jQueryUI，它将在[http://api.jqueryui.com/addClass/](http://api.jqueryui.com/addClass/)中构建，如果没有，我要做的就是从类中提取所有属性并一一设置动画。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T22:24:13.957

`.animate()`如果该功能对您不利（因为您有图像背景或其他东西），也许是一个很好的解决方案。

创建`div`具有相同内容和新类的元素。将新`div`元素放在你的元素上，然后`fade in`它。

# ruby-on-rails - 如何“利用”已经存储在数据库中的关系数据？

> ID：13223482
> 
> 赞同：3
> 
> 时间：2012-11-04T22:14:12.790
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, activerecord, associations

我正在使用 Ruby on Rails v3.2.2。我有以下模型类

```
class Country < ActiveRecord::Base
  has_many :regions, :foreign_key => 'country_id'
end

class Region < ActiveRecord::Base
  belongs_to :country, :foreign_key => 'country_id'
  has_many :cities, :foreign_key => 'region_id'
end

class City < ActiveRecord::Base
  belongs_to :region, :foreign_key => 'region_id'
end 
```

*我想做`City` `belongs_to :country`*一个.

我知道最简单的方法是在数据库表中添加一个`country_id`数据库表列`City`并声明相关的 ActiveRecord 关联，这样：

```
class Country < ActiveRecord::Base
  # ...
  has_many :cities, :foreign_key => 'country_id'
end

class City < ActiveRecord::Base
  # ...
  belongs_to :country, :foreign_key => 'country_id'
end 
```

但是，为了存储*更少的数据库数据*，我想我可以“使用”已经存储在`Region`表中的数据，*因为一个城市属于一个地区，而该地区又属于一个国家（这意味着一个城市属于一个国家）*但是，在这种情况下，我不知道如何正确地声明 ActiveRecord 关联`City`，`Country`因此“利用”提到的关系信息隐含地“通过”`Region`模型类呈现。

我应该如何进行？

* * *

*注意*：我“强制”`belongs_to :country`在模型类中声明 ActiveRecord 关联，`City`因为我想使用 RoR[`:counter_cache`](http://guides.rubyonrails.org/association_basics.html#belongs_to-counter_cache)功能（*仅*适用于`belongs_to`关联）来计算一个国家/地区的城市。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:48:20.190

根据 rails 文档，您可以在关系`:through`上指定一个选项`has_one`：

> **：通过**
> 
> 指定用于执行查询的连接模型。:class_name、:primary_key 和 :foreign_key 的选项被忽略，因为关联使用源反射。您只能通过连接模型上的 has_one 或 belongs_to 关联使用 :through 查询。

所以，你想要的是添加`has_one :country, :through => :region`到`City`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T23:27:45.920

使用 :through 选项。正如我在以下答案中的评论中看到的那样（顺便说一句，这是正确的），您只需添加以下内容：

```
has_one :country, :through => :region 
```

到你的城市班。如果你想为城市应用 counter_cache ，那么你还必须在 country 类中建立关系，如下所示：

```
has_many :cities, :through => :regions 
```

然后你可以有你的计数栏

# php - php - 无效的参数号：未定义参数

> ID：13223483
> 
> 赞同：1
> 
> 时间：2012-11-04T22:14:26.707
> 
> 标签：php, mysql, sql, pdo

我在执行一个简单的 INSERT 请求时遇到了一些问题。如标题中所述，我收到此消息“无效的参数编号：未定义参数”。第一个值是一个 id（主自动递增）

```
$req = $pdo->prepare('INSERT INTO championnat_classement 
                        VALUES (
                        "",
                        :Equipe,
                        :Championnat,
                        :Saison,
                        :Journee,
                        :Points,
                        :NbMatch,
                        :Position,
                        :Victoire,
                        :Nul,
                        :Defaite,
                        :MatchJoueDomicile,
                        :PointsDomicile,
                        :VictoireDomicile,
                        :NulDomicile,
                        :DefaiteDomicile,
                        :ButPourDomicile,
                        :ButContreDomicile,
                        :MatchJoueExterieur,
                        :PointsExterieur,
                        :VictoireExterieur,
                        :NulExterieur,
                        :DefaiteExterieur,
                        :ButPourExterieur,
                        :ButContreExterieur     
                        )');
if ($req->execute(array(
                        "Equipe" => $this->idEquipe1,
                        "Championnat" => $this->idChamp,
                        "Saison" => $this->saison,
                        "Journee" => $this->journee,
                        "Points" => $this->pointsTotaux,
                        "NbMatch" => $this->matchJouesTotal,
                        "Position" => $this->position,
                        "Victoire" => $this->matchGagneeTotal,
                        "Nul" => $this->matchNulTotal,
                        "Defaite" => $this->matchPerduTotal,
                        "MatchJoueDomicile" => $this->matchJouesDomicile,
                        "PointsDomicile" => $this->pointsDomicile,
                        "VictoireDomicile " => $this->matchJouesDomicile,
                        "NulDomicile" => $this->matchNulDomicile,
                        "DefaiteDomicile" => $this->matchPerduDomicile,
                        "ButPourDomicile" => $this->butMarquesDomicile,
                        "ButContreDomicile" => $this->butEncaissesDomicile,
                        "MatchJoueExterieur" => $this->matchJouesExterieur,
                        "PointsExterieur" => $this->pointsExterieur,
                        "VictoireExterieur" => $this->matchGagneeExterieur,
                        "NulExterieur" => $this->matchNulExterieur,
                        "DefaiteExterieur" => $this->matchPerduExterieur,
                        "ButPourExterieur" => $this->butMarquesExterieur,
                        "ButContreExterieur" => $this->butEncaissesExterieur
                    ))) {
                return "ok";
            } 
```

如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:19:34.827

在 VALUES 之前的第一个 () 中写下所有列名，并在第二个跳过你的 id，你放 "" .. !!! 我不知道您的列的确切名称，因此您必须编写它们..

```
$req = $pdo->prepare('INSERT INTO championnat_classement 
                            (
                            Equipe,
                            Championnat,
                            Saison,
                            Journee,
                            Points,
                            NbMatch,
                            Position,
                            Victoire,
                            Nul,
                            Defaite,
                            MatchJoueDomicile,
                            PointsDomicile,
                            VictoireDomicile,
                            NulDomicile,
                            DefaiteDomicile,
                            ButPourDomicile,
                            ButContreDomicile,
                            MatchJoueExterieur,
                            PointsExterieur,
                            VictoireExterieur,
                            NulExterieur,
                            DefaiteExterieur,
                            ButPourExterieur,
                            ButContreExterieur
                            ) VALUES (
                            :Equipe,
                            :Championnat,
                            :Saison,
                            :Journee,
                            :Points,
                            :NbMatch,
                            :Position,
                            :Victoire,
                            :Nul,
                            :Defaite,
                            :MatchJoueDomicile,
                            :PointsDomicile,
                            :VictoireDomicile,
                            :NulDomicile,
                            :DefaiteDomicile,
                            :ButPourDomicile,
                            :ButContreDomicile,
                            :MatchJoueExterieur,
                            :PointsExterieur,
                            :VictoireExterieur,
                            :NulExterieur,
                            :DefaiteExterieur,
                            :ButPourExterieur,
                            :ButContreExterieur     
                        )'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T22:17:34.817

如果 id 是自动生成的（即在 mysql 中使用 AUTO_INCREMENT），则不必在属性列表中指定它。

[在这里](http://dev.mysql.com/doc/refman/5.0/en/example-auto-increment.html)，您可以找到一些有关如何正确编写格式良好的插入查询的示例。

例子：

```
INSERT INTO table_name (att2, att3, ..., attN) VALUES (value2, value3, ..., valueN); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-04T22:19:28.937

正是他上面所说的，但您可以将插入的值指定为 Null 而不是“”，因为这两者是完全不同的东西。它在作为来源提到的站点 rano 中的示例之外的第二行。[http://dev.mysql.com/doc/refman/5.0/en/example-auto-increment.html](http://dev.mysql.com/doc/refman/5.0/en/example-auto-increment.html)

# java - 为什么当我按下连续按钮时它不连续运行？

> ID：13223484
> 
> 赞同：2
> 
> 时间：2012-11-04T22:14:39.373
> 
> 标签：java, android

```
public class TestingActivity extends Activity implements View.OnClickListener
{
ScheduledThreadPoolExecutor scheduler = new ScheduledThreadPoolExecutor(1);

ScheduledFuture now = null;
public void onCreate(Bundle savedInstanceState)
{
    //oncreate
}
public void rollthedice()
{
//rollthedice
}

 public void onClick(View view)
{

    Runnable runner = new Runnable()
    {
        public void run()
        {
            rollthedice();
        }
    };

    if(view.equals(continuous))
    {
    if(now == null)
        now = scheduler.scheduleAtFixedRate(runner, 0, 250, TimeUnit.MILLISECONDS);
    else
        return;
    }
    if(view.equals(stop))
    {
        if(now != null)
        {
            now.cancel(true);
            now = null;
        }

        else
            return;
    }
    if(view.equals(roll))
        rollthedice();
    if(view.equals(exit))
        System.exit(0);
} 
```

我在Java应用程序中使用它，它工作正常，我把它放到android项目中，它不起作用我希望连续按钮连续运行rollthedice（），停止按钮停止它，然后连续再次启动它并停止回来和向前

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:22:41.893

因为您需要在带有标志的while循环中添加它，所以试试这个：

```
public void run()
{
while (runningFlag){
//do something here
}
} 
```

在开始时，您需要将标志设置为 true，然后启动线程，当您希望它停止时，将标志设置为 false。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T22:23:45.970

你确定 onCLick 被执行了吗？你打电话了吗

```
continuous.setOnClickListener(this);
stop.setOnClickListener(this); 
```

ETC？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-05T00:32:10.453

您可以有一个 while 循环并将条件设置为 true 以停止它（因为！）。您还应该高度考虑在单独的线程中滚动。如果你这样做，你可能需要也可能不需要处理程序。

```
boolean mPaused = false;

while(!mPaused) {
    doSomething();
}

//to stop it set mPaused = true
//to resume call the method again 
```

处理程序

```
//called by
Message msg0 = new Message();
msg0.obj = "someting";
handler.sendMessage(msg0);

private Handler handler = new Handler() {
    @Override
    public void handleMessage(Message msg) {
        if (msg.obj.equals("something")) {
            doSomething();
        }
    }
}; 
```

# magento-1.7 - Magento：从 csv 导入数据并在 Magento 1.7.0.0 中获取带有外部 url 的图像

> ID：13223485
> 
> 赞同：1
> 
> 时间：2012-11-04T22:14:56.917
> 
> 标签：magento-1.7

我是 Magento 的初学者开发人员。我在 Magento 1.7.0.0 中成功导入了一个包含 20,000 个产品的 CSV 文件。我的 CSV 文件中有带有外部 URL 的图像，例如 (http://mydomianname.xyz.net/images/ac123/image2/myimage.jpg)

导入产品后，我无法获取图像。当我检查现有网站上的图像路径时：

```
http://exisitingdomianname/media/catalog/product/cache/1/small_image/213x252/9df78eab45656d03d6e5sb8d27136e95/images/catalog/product/placeholder/small_image.jpg 
```

请，任何人都可以指导我如何从magento中的任何外部网址获取图像。

如果我无法正确解释我的问题，请随时问我。

# c++ - C++ va_list 返回奇数值

> ID：13223486
> 
> 赞同：0
> 
> 时间：2012-11-04T22:14:57.173
> 
> 标签：c++

我正在尝试在 C++ 中为一个项目实现一种反射形式。这个想法是你将带有标签的类注册到一个映射中作为一种模板，然后调用共享基类的 cloneNew 方法来实际创建你想要的对象。但是，当我尝试使用 va_list 来实现此功能时，我得到了奇怪的结果。问题代码是：

```
GameObject* SphereObstacle::cloneNew(const Vector& position, double charge, const Vector&         dipole, ...)
{
    va_list v1;
    va_start(v1, dipole);
    double radius = va_arg(v1, double);
    va_end(v1);
    return new SphereObstacle(position, charge, dipole, radius);
} 
```

每次我尝试从 va_list 读取时，它都会返回一个巨大的值。它几乎看起来像是一个指针。我唯一的想法是问题是由于这是基类中虚拟方法的实现这一事实引起的，但我没有在网上找到任何表明这是问题的东西。我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T22:20:00.557

问题在于`dipole`属于参考类型。关于`va_start`，引用 [support.runtime]/3：

> 参数 parmN 是函数定义的可变参数列表中最右边参数的标识符（就在 ... 之前的那个）。如果使用函数、数组或引用类型声明参数 parmN，或者使用与传递没有参数的参数时产生的类型不兼容的类型，则行为未定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T07:34:43.273

更改声明，如...

GameObject* SphereObstacle::cloneNew(const Vector& position, double charge, Vector dipole, ...)

# objective-c - 技术选择 UIImageView 或自定义 UIButton

> ID：13223489
> 
> 赞同：0
> 
> 时间：2012-11-04T22:15:08.357
> 
> 标签：objective-c, ios

我想做一个像图片一样的测验，当点击一个国家时，它会显示正确的答案

我的问题：我可以这样做：

1.  每个国家都是一个 UIImageView 或
2.  每个国家都是一个自定义 UIButton。

女巫是最好的解决方案？任何帮助请

![在此处输入图像描述](../Images/3ffdab9581d36ed0f52be50f9947168a.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T22:22:12.693

您可以`UIButton`为此使用 s。在这两种情况下，您都必须解决按钮或视图形状不规则的问题。

在 github 上，您可以找到[Ole Begemann 的一个项目，](http://github.com/ole/OBShapedButton)该项目进行了扩展`UIButton`，以便仅检测按钮图像不透明的触摸。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T22:27:27.910

由于这些国家甚至还没有接近矩形，恐怕你必须想出一种更复杂的方法来检测触摸。a`UIImageView`和 a`UIButton`都不会满足您的需求。

解决此类任务的一种方法可能是为每个国家/地区分配唯一的颜色，然后获取触摸位置的像素颜色。您必须在颜色和国家/地区之间创建某种映射，以确定哪个国家/地区被触及。

请参阅[如何从 UIImage (Cocoa Touch) 或 CGImage (Core Graphics) 获取像素数据？](https://stackoverflow.com/questions/448125/how-to-get-pixel-data-from-a-uiimage-cocoa-touch-or-cgimage-core-graphics)了解如何获取触摸像素的颜色。

# c# - 需要 C# LINQ 帮助阅读 XML

> ID：13223491
> 
> 赞同：2
> 
> 时间：2012-11-04T22:15:31.673
> 
> 标签：c#, linq-to-xml

我有看起来像我下面的xml。我可以阅读标题，但无法访问 media:content 的 url。有什么建议么？我的非工作 c# 与 xml 一起在下面。

```
 XNamespace xmlns = "http://www.w3.org/2005/Atom";
        var names =
            (from data in         XDocument.Load("http://channel9.msdn.com/Events/Build/2012/rss").Descendants("item")
             let xElement = data.Element("title")
             let xElementUrls = data.Element("media")
             where xElement != null
             select new
                        {
                           Title = xElement.Value,
                           Urls = data.Elements(xmlns + "media:group")
                           //MediaGroup = data.Element("media:group")
                        }).ToList(); 
```

和 XML：

```
 <?xml-stylesheet type="text/xsl" media="screen" href="/styles/xslt/rss.xslt"?>
    <rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" 
       xmlns:atom="http://www.w3.org/2005/Atom" 
       xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/" 
       xmlns:wfw="http://wellformedweb.org/CommentAPI/" 
       xmlns:slash="http://purl.org/rss/1.0/modules/slash/" 
       xmlns:media="http://search.yahoo.com/mrss/" 
       xmlns:itunes="http://www.itunes.com/dtds/podcast-1.0.dtd" 
       xmlns:c9="http://channel9.msdn.com">
    <channel>

    <item>
      <title>Building Windows 8 LOB Apps (Repeat)</title>
        <media:group>
          <media:content url="http://video.ch9.ms/sessions/build/2012/2-104R.mp4" 
             expression="full" duration="0" fileSize="1" type="video/mp4" medium="video"/>
          <media:content url="http://video.ch9.ms/sessions/build/2012/2-104R.wmv" 
             expression="full" duration="0" fileSize="1" type="video/x-ms-wmv" medium="video"/>
        </media:group>
    </item>
    <item>
    <item>
    ...
    </item> 
```

*   根据 LB 的建议添加了此内容，但我不知道如何获取 url（它现在按预期返回每个项目的 URL 列表。

    ```
    var items = xDoc.Descendants("item")
        .Where(g => g.Element(media + "group") != null)
        .Select(g => new {
                        Title = g.Element("title").Value,
                        Url = g.Element(media + "group")
                                .Element(media + "content")
                                .Attribute("url").Value
                        })
        .ToList(); 
    ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T22:33:32.367

```
var xDoc = XDocument.Load("http://channel9.msdn.com/Events/Build/2012/rss");
XNamespace media = "http://search.yahoo.com/mrss/";

var items = xDoc.Descendants("item")
            .Where(g => g.Element(media + "group") != null)
            .Select(g => new {
                            Title = g.Element("title").Value,
                            Url = g.Element(media + "group")
                                    .Element(media + "content")
                                    .Attribute("url").Value
                            })
            .ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T22:19:36.730

`media`是命名空间别名，而不是元素。

您需要获取命名空间中的`group`元素`http://search.yahoo.com/mrss/`：

```
XNamespace m = "http://search.yahoo.com/mrss/";

let xElementUrls = data.Element(m + "group") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T22:31:57.117

你有错误的命名空间...

```
XNamespace xmlns = "http://www.w3.org/2005/Atom"; 
```

应该

```
XNamespace xmlns = "http://search.yahoo.com/mrss/"; 
```

而且您错误地组合了命名空间和元素名称

```
...
Urls = data.Elements(xmlns + "group")
.... 
```

# javascript - 更改类主干引导带

> ID：13223495
> 
> 赞同：0
> 
> 时间：2012-11-04T22:15:46.360
> 
> 标签：javascript, backbone.js

我正在使用主干，引导程序“崩溃”。单击按钮时，我正在尝试更改类..

html

```
<button id="btnCollapse" class="btn"  type="button">
    <i id="accordionIcon-{{id}}" class="icon-down"></i>
</button> 
```

js

```
CollapsePress : function(event) {

    //change the class back and forth with every click (icon-down to icon-right)
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T23:41:01.653

你没有给我足够的信息来确保这是正确的，但试试这个：

```
$(event.target).find('i').toggleClass('icon-down icon-right') 
```

# python - 使用 Matplotlib 绘制二维数组

> ID：13223497
> 
> 赞同：4
> 
> 时间：2012-11-04T22:16:01.603
> 
> 标签：python, numpy, plot, matplotlib

所以我有一个二维数组（名为 Data），如下所示：

```
 Shape 0       Shape 1     ...      Shape N
            -------       -------              -------

Scale 0  |  Value00   ,   Value01     ...      Value0N |

Scale 1  |  Value10   ,   Value11     ...      Value1N |

  .
  .
  .

Scale N  |  ValueN0   ,   ValueN1     ...      ValueNN | 
```

我想创建一个 3D 图，其中 ValueXXs 是 Z 轴。我尝试了两次尝试，但每次都给了我一个相对于另一个旋转的表面，所以我让自己有点困惑。这是我第一次尝试解决方案：

```
x,y = numpy.mgrid[0:50:50j,0:50:50j]
f = Data
fig = plt.figure()
ax = Axes3D(fig)
ax.plot_surface(x,y,f,rstride=1,cstride=1) 
```

这是我的第二次尝试：

```
nx, ny = 50, 50
x = range(nx)
y = range(ny)
hf = plt.figure()
ha = hf.add_subplot(111, projection='3d')
X, Y = numpy.meshgrid(x, y)  
ha.plot_surface(X,Y,Data,rstride=1,cstride=1) 
```

检查 X 和 Y 并没有帮助，因为它是一个正方形。我不确定 X 何时代表我的“比例”与何时代表我的“形状”。

那么，这两个例子到底发生了什么？有没有更好的方法来绘制这个数组？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T23:11:24.297

如果我理解正确，那么困惑是哪个轴是哪个轴，对吗？如果是这种情况，您可以轻松绘制已知的不对称形状，并且该图会告诉您一切。例如，采用[图库中的示例](http://matplotlib.org/examples/mplot3d/surface3d_radial_demo.html)：

```
# By Armin Moser

from mpl_toolkits.mplot3d import Axes3D
import matplotlib
import numpy as np
from matplotlib import cm
from matplotlib import pyplot as plt
step = 0.04
maxval = 1.0
fig = plt.figure()
ax = fig.add_subplot(111, projection='3d')

# create supporting points in polar coordinates
r = np.linspace(0,1.25,50)
p = np.linspace(0,2*np.pi,50)
R,P = np.meshgrid(r,p)
# transform them to cartesian system
X,Y = R*np.cos(P),R*np.sin(P)

#Z = ((R**2 - 1)**2)
Z = (X**2 + 0.2*Y**2 -1)**2   # <------- edit

ax.plot_surface(X, Y, Z, rstride=1, cstride=1, cmap=cm.jet)
#ax.set_zlim3d(0, 1)
ax.set_xlabel(r'$\phi_\mathrm{real}$')
ax.set_ylabel(r'$\phi_\mathrm{im}$')
ax.set_zlabel(r'$V(\phi)$')
plt.show() 
```

# css - 动态内容忽略 Chrome CSS

> ID：13223498
> 
> 赞同：0
> 
> 时间：2012-11-04T22:16:13.553
> 
> 标签：css, google-chrome

我的 CSS 有问题。我用最新的 FF 和 IE 测试它没有问题，但 Chrome 不能正确渲染它。

我想将标签的所有子元素显示为我使用的块

```
Tag > * {
    display:block;
} 
```

它在 IE 和 FF 中都可以正常工作，但不能在 chrome 中正常工作。我尝试使用控制台强制它并放置 display:block 但它失败了。好像 chrome 忽略了 display:block ？

编辑：标签实际上是一个自定义标签 CurrentWeather

完整的CSS：

```
CurrentWeather > * {
    display:block;
}

body {
    text-align:center;
  }

div#result{
    text-align:left;
    margin: 0 auto;
    width:50%;
} 
```

编辑2：

我认为这是一个 ajax 问题，因为当我对添加的 html 进行编码时，它可以正常工作。chrome 不会对动态内容应用 css 吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T22:25:21.643

选择器`tag > *`不会针对标签的所有子项，仅针对直接子项。

`tag *`如果你想针对*所有*孩子，你会使用。

Chrome 没有像 ignoring 这样严重的错误`display:block`，因此必须有一些特定于您的情况的东西。

不看代码很难准确判断它是什么，但有一些可能的原因：

*   该标记是一个内联标记，并且您没有使用 HTML5 文档类型。

*   标记已损坏，因此子元素不是您认为的元素。（特别是浏览器之间的不同行为对于损坏的标记是典型的。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T22:26:43.137

对我来说很好：http: [//jsfiddle.net/DigitalBiscuits/nkymw/1/](http://jsfiddle.net/DigitalBiscuits/nkymw/1/)

您的 css 中的某处可能存在错误，导致 Chrome 停止处理 CSS。如果你有一个失踪`;`或`}`铬不喜欢这个。

您需要向我们展示您的所有代码，或者使用 CSS 验证器查看您的代码 [http://jigsaw.w3.org/css-validator/](http://jigsaw.w3.org/css-validator/)

# c - 问题在 C 中为 pthreads 的线程函数计时

> ID：13223509
> 
> 赞同：2
> 
> 时间：2012-11-04T22:17:44.297
> 
> 标签：c, pthreads, time.h

所以我在计算每个线程的线程函数的运行时间时遇到问题，我需要能够找到所有线程的总运行时间，但它没有正确执行。（见代码下面的输出）

```
#include <unistd.h>
#include <sys/types.h>
#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <pthread.h>
#include <string.h>
#include <math.h>
#include <time.h>

int numthread;
double x1;
double x2;
double h; 
double totalintegral;
int n;              //number of trapezoids
int localn;

double gnolock;
double gmute;
double gbusy;
double gsema;

double doTrapRule(double localx1, double localx2, double h, int localn);
double doFunction(double x);
void *threadCalc(void* threadid);

int main(int argc, char * argv[])
{
    int i;
    x1 = 0.0;
    x2 = 20.0;
    n = 200000;

    numthread = 10;

    pthread_t* threads = malloc(numthread*sizeof(pthread_t));

    h = (x2 - x1)/n;
    localn = n/numthread;

    for(i = 0; i < numthread; i++)
    {
        pthread_create(&threads[i], NULL, (void *) &threadCalc, (void*) i);
    }

    for(i = 0; i < numthread; i++)
    {
        pthread_join(threads[i], NULL);
    }

    printf("Trap rule result with %d trap(s) is %f\n", n, totalintegral);
    fflush(stdout);
    printf("no lock completed in %f\n", gnolock);
    exit(0);
}

void *threadCalc(void* threadid)
{
    clock_t start = clock();
    double localx1;
    double localx2; 
    double localintegral;
    int cur_thread = (int)threadid;

    localx1 = x1 + cur_thread * localn * h;
    localx2 = localx1 + localn * h;

    localintegral = doTrapRule(localx1, localx2, h, localn);

    totalintegral = totalintegral + localintegral;
    //printf("Trap rule result with %d trap(s) is %f", n, totalintegral);
    clock_t stop = clock();
    double time_elapsed = (long double)(stop - start)/CLOCKS_PER_SEC;
    printf("time elapsed of each thread %f\n",time_elapsed);
    gnolock = gnolock + time_elapsed;
    return NULL;
}

double doTrapRule(double localx1, double localx2, double h, int localn)
{
    //time start here
    double localtrapintegral;
    double tempx1;
    int i;

    localtrapintegral = (doFunction(localx1) + doFunction(localx2)) / 2.0;

    for(i = 1; i <= (localn - 1); i++)
    {
        tempx1 = localx1 + i * h;
        localtrapintegral = localtrapintegral + doFunction(tempx1);
    }

    localtrapintegral = localtrapintegral * h;
    //time end here, add elapsed to global
    return localtrapintegral;
}

double doFunction(double x)
{
    double result;
    result = x*x*x;

    return result;
} 
```

输出：

```
time elapsed of each thread 0.000000
time elapsed of each thread 0.000000
time elapsed of each thread 0.000000
time elapsed of each thread 0.000000
time elapsed of each thread 0.000000
time elapsed of each thread 0.000000
time elapsed of each thread 0.010000
time elapsed of each thread 0.010000
time elapsed of each thread 0.000000
time elapsed of each thread 0.000000
Trap rule result with 200000 trap(s) is 40000.000001
no lock completed in 0.020000 
```

正如您所看到的，无论出于何种原因，只有线程中的某个人实际上正在返回时间。我运行了多次，每次只有几个线程返回结果。正如 FYI gnolock 是我的变量，它存储经过的总时间。我猜为什么这不起作用是因为小数点超出范围，但它不应该吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T22:47:06.933

如果您调用`clock()`您的系统，它的分辨率为 10 毫秒。因此，如果一个进程需要 2 毫秒，那么它通常会报告 0.00 秒或 0.01 秒的时间，这取决于你无法控制的一堆事情。

请改用其中一个高分辨率时钟。可以用`clock_gettime`或`CLOCK_THREAD_CPUTIME_ID`，`CLOCK_PROCESS_CPUTIME_ID`相信这个时钟的分辨率比 好几个数量级`clock()`。

有关`man 2 clock_gettime`更多信息，请参阅。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T22:36:29.650

最有可能的是，您的时钟滴答对于您尝试测量的经过时间来说太粗糙了。大多数开始和停止时钟是相同的。偶尔，在您的线程执行期间发生时钟滴答，您会看到 1 个滴答。（这实际上是迪特里希上面所说的）。

举例说明这意味着什么，假设您的线程需要一个小时才能完成，而您的时钟每天在午夜滴答一次。大多数情况下，当您运行线程时，线程会在同一天开始和结束。但是，如果您碰巧在午夜后的一个小时内运行它，您将看到不同日期的开始和停止（1 个滴答声）。那么你需要的是一个更快的时钟，但这样的时钟很可能不可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T23:07:44.033

您使用了错误的工具。`clock`不测量经过的时间，但

> clock() 函数返回程序使用的**处理器时间**的近似值。

这是两个完全不同的东西。也许您的线程不会占用太多处理器时间。

# mysql - 如何使用 Laravel 的流畅查询构建器选择计数？

> ID：13223512
> 
> 赞同：70
> 
> 时间：2012-11-04T22:18:08.840
> 
> 标签：mysql, activerecord, fluent, laravel, eloquent

这是我使用流利查询生成器的查询。

```
 $query = DB::table('category_issue')
        ->select('issues.*')
        ->where('category_id', '=', 1)
        ->join('issues', 'category_issue.issue_id', '=', 'issues.id')
        ->left_join('issue_subscriptions', 'issues.id', '=', 'issue_subscriptions.issue_id')
        ->group_by('issues.id')
        ->order_by(DB::raw('COUNT(issue_subscriptions.issue_id)'), 'desc')
        ->get(); 
```

如您所见，我是按连接表中的计数排序的。这工作正常。但是，我希望这个计数与我的选择一起返回。

这是我的原始续集查询，效果很好。

```
Select issues.*, COUNT(issue_subscriptions.issue_id) AS followers 
FROM category_issue JOIN Issues ON category_issue.issue_id = issues.id 
LEFT JOIN issue_subscriptions ON issues.id = issue_subscriptions.issue_id
WHERE category_issue.category_id = 1
GROUP BY issues.id
ORDER BY followers DESC 
```

我将如何使用 Laravel 的流畅查询构建器进行此选择？我知道我可以使用原始 sql 查询，但如果可能的话，我想避免这种情况。任何帮助将不胜感激，在此先感谢！

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2012-11-30T02:29:30.870

您可以在 select() 中使用数组来定义更多列，并且可以在其中使用 DB::raw() 并将其别名为关注者。应该是这样的：

```
$query = DB::table('category_issue')
    ->select(array('issues.*', DB::raw('COUNT(issue_subscriptions.issue_id) as followers')))
    ->where('category_id', '=', 1)
    ->join('issues', 'category_issue.issue_id', '=', 'issues.id')
    ->left_join('issue_subscriptions', 'issues.id', '=', 'issue_subscriptions.issue_id')
    ->group_by('issues.id')
    ->order_by('followers', 'desc')
    ->get(); 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2012-11-05T11:44:48.273

```
$count = DB::table('category_issue')->count(); 
```

会给你项目的数量。

有关更多详细信息，请查看[精美的 Laravel 文档中的](http://laravel.com/docs/queries)**Fluent Query Builder**部分。

# objective-c - NSManagedObjectContext 传递给 NSWindowController 变为 nil

> ID：13223513
> 
> 赞同：1
> 
> 时间：2012-11-04T22:18:17.093
> 
> 标签：objective-c, xcode, macos, core-data, nsmanagedobjectcontext

我真的很想弄清楚我的托管对象上下文消失在哪里。

我最初是在我的应用程序委托中实例化它，然后将它传递给 NSWindowController 中的保留属性，如下所示：

```
self.TPWC = [[TestPanelWindowController alloc] initWithWindowNibName:@"TestPanel"];
self.TPWC.managedObjectContext = self.managedObjectContext;
self.TPWC.persistentStoreCoordinator = self.persistentStoreCoordinator;
[TPWC.window makeKeyAndOrderFront:nil]; 
```

然后我有一个按钮，应该实例化一个`NSManagedObject`并将其插入到托管对象上下文中，如下所示：

```
 NSManagedObject *newInstanceOfSomeEntity =

 [NSEntityDescription insertNewObjectForEntityForName:@"SomeEntity" 
 inManagedObjectContext:self.managedObjectContext]; 
```

至此，`self.managedObjectContext`不知何故变成了nil。

我已经在 windowDidLoad 中插入了一个断点，我可以确认此时我们确实有一个有效的 an 实例`NSManagedObjectContext`，但它在 viewDidLoad 和尝试插入托管对象之间以某种方式变为 nil 。

我尝试创建一个自定义初始化程序来设置，`NSManagedObjectContext`但它仍然为零。

Core Data 对我来说很新，我很难理解出了什么问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T23:02:58.940

这不是您为什么看到您的上下文消失的直接答案，但它仍然可以解决您的问题：

从架构的角度来看，您真的不应该在对象之间传递托管对象上下文，尤其是 UI 对象。

相反，您应该有一个全局单例类来实例化托管对象上下文（可能还有协调器和持久存储），然后通过公共属性提供对它的访问。然后，从您的窗口控制器中，您只需从单例对象访问它。

（如果您使用多线程，请注意从不同线程访问和使用相同的上下文。）

# push-notification - 所谓的推真的不拉吗？

> ID：13223517
> 
> 赞同：3
> 
> 时间：2012-11-04T22:18:45.597
> 
> 标签：push-notification

自从在 IOS 中引入推送服务以来，我想知道它是如何工作的。

从我发现推送功能基本上是一个开放的连接，不会关闭服务器端。

但是移动设备在互联网的不同点连接，服务器知道移动设备连接位置的唯一方法是移动设备告诉服务器它已更改位置的位置。

我读了一些关于轮询连接以使其保持打开状态的内容。

管理和保持不断变化的开放连接与仅检查是否要拉动相比有什么优势？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T23:45:39.820

在内部是的，推送是通过让您的手机轮询新数据来实现的。推送通知之所以吸引人的地方在于它们是通过 Apple 的服务进行路由的，这有很多优势。

从手机的角度来看，它只需要从一项服务进行轮询，这意味着它可以节省带宽并搭载手机保持在线的正常操作。这意味着使用更少的电池，并且您可以将手机设置为仅每半小时接收一次推送通知，这意味着每半小时有 29 分钟您可以关闭数据连接。

从服务器的角度来看，您不再需要缓存消息或提供服务质量保证。如果您想向在手机信号塔范围之外的手机发送推送通知几分钟，您可能需要将消息存储相当长的时间，直到手机恢复在线。Apple 会为您处理所有这些，并让您的服务器只负责创建通知，而不是存储和中继它们。

# asp.net - asp如何处理所有重定向的参数

> ID：13223519
> 
> 赞同：1
> 
> 时间：2012-11-04T22:18:51.697
> 
> 标签：asp.net

如何处理所有重定向的参数？

例如，如果我在我的 studentinformationpage.aspx 上，并且我有一个 UserID=Admin&StudentID=Apple 的参数。即使用户离开该页面，我如何保留 userID 的参数？

如果用户按下重定向按钮，他们将被重定向到 admin.aspx，但当他们转到 admin.aspx 时，用户不再有任何参数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T22:25:48.647

根据您在做什么以及如何构建您的网站，您的两个主要选项是将 userId 存储在会话中（使用会话变量），因此直到用户的会话过期/注销，Id 将在那里；或者您也可以将查询字符串 UserId=Admin&... 添加到您要重定向的页面。

在这里查看会话状态

[http://msdn.microsoft.com/en-us/library/ms178581%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/ms178581%28v=vs.100%29.aspx)

# javascript - 一般数据理解

> ID：13223521
> 
> 赞同：0
> 
> 时间：2012-11-04T22:19:09.010
> 
> 标签：javascript, highstock

我在理解 highstock 的一般数据格式时遇到了重大问题。我看到了文档的一部分，它看起来像这样：

```
 data: [[5, 2], [6, 3], [8, 2]] 
```

现在我正试图让它工作。在 jsfiddle 我有 2 种数据输入方式。

为什么这行得通

```
[1336168800000, 15] 
```

但这会出错

```
 var CheckinData = new Array();
 CheckinData.push(new Array(1336168800000, 15)); 
```

[http://jsfiddle.net/3uWPz/](http://jsfiddle.net/3uWPz/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T22:40:39.827

`],`在注释掉系列数据之后，您的 jsfiddle 代码中出现了杂散。

请参阅此版本：http: [//jsfiddle.net/3uWPz/1/](http://jsfiddle.net/3uWPz/1/)

顺便说一句，您可以使用以下样式更简洁地编写代码：

```
var CheckinData = [];
CheckinData.push([1336168800000, 15]); 
```

# c - Linux下编译C文件时出现汇编错误

> ID：13223525
> 
> 赞同：6
> 
> 时间：2012-11-04T22:19:36.247
> 
> 标签：c, assembly

嗨，我正在尝试在我的计算机中编译简单的 C 程序，并且在编译时我从终端下得到了类似的消息 [参见图片]，说明了某种汇编错误。我不知道这是否是计算机内存/堆栈问题（尽管我已经重新启动了计算机）或其他任何问题，但我可以肯定的是，过去几天我一直在以相同的方式编译 C 程序。

代码：

```
 #include <stdio.h>
   main(){
      printf("hello");
   } 
```

输出：

/tmp/cconajAc.s：汇编程序消息：/tmp/cconajAc.s:9：错误：后缀或操作数对“推送”无效

请告诉我如何解决这个问题！

*已编辑：我刚刚从另一个计算机实验室房间的工作站更换，它工作正常，没有任何组装错误。我的猜测是安装在其他实验室的那些计算机中的开发工具有错误。我想现在这对我有用，尽管知道我在另一台计算机中遇到的问题的根源会很有趣。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:21:26.827

该错误似乎很奇怪，但请尝试在您的`main()`:中添加返回类型`int main()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T22:38:08.280

在 vi 编辑器中编写并将文件保存为“hello.c”：

```
 #include <stdio.h>
 int main() {   printf("hello");   return 0; } 
```

检查您是否安装了 32 位 glibc 头文件。
在 ubuntu 中试试这个来安装：
`# apt-get install gcc-multilib`

然后尝试：
`# gcc -m32 -o hello hello.c`

`# gcc Wa,--32`别的

`# gcc -m32 --32`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-20T00:29:45.963

如果它对其他人有帮助，对我来说，这似乎是由不匹配的工具链组件引起的——我有时必须获取修改我的外部点文件`PATH`（为了满足复杂的构建系统，叹息）。汇编器是`/usr/bin/as`，但是`gcc`是一些古老的版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-21T02:04:08.363

运行 gcc 时您在哪个 shell 中？

尝试切换到 tcsh/csh。我在 bash 中遇到了同样的错误并将 shell 切换到 tcsh。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-20T03:19:27.433

错误：“push”的后缀或操作数无效

检查您的系统架构：

```
# arch
x86_64   

# arch
i386 
```

或者使用这个：

```
#uname -m 
x86_64 
```

在汇编中：32 位（i386）：

```
pushl instruction  ;notice the suffix is l 
```

64位（x86_64）：

```
pushq instruction  ;notice the suffix is q 
```

我想知道你的系统的arch是x86_64，当你使用32位的指令时会出现这个错误。要解决这个问题：

```
#gcc -m32 -o test test.c 
```

请参阅[何时应使用 gcc 的 -m32 选项？](https://stackoverflow.com/questions/2426478/when-should-m32-option-of-gcc-be-used)

# java - 如何在画布剪辑中获取内接矩形

> ID：13223543
> 
> 赞同：4
> 
> 时间：2012-11-04T22:22:16.950
> 
> 标签：java, android, android-canvas

在 android canvas 中，我定义了一个具有许多形状（一个矩形和 2 个圆形）的剪切区域。我想得到由剪切区域定义的内接矩形。

Canvas 有一个名为的方法`getClipBounds()`，它给了我外接矩形，我如何获得内接矩形？

![在此处输入图像描述](../Images/0c21a39710227487756a9112905d1f9b.png)

编辑：以下是有关如何制作原始形状的一些信息：

1.  首先为大圆圈添加一个剪辑`Region.Op.INTERSECT`
2.  然后为垂直矩形添加一个剪辑`Region.Op.INTERSECT`
3.  然后为一个较小的圆圈添加一个剪辑`Region.Op.DIFFERENCE`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:45:23.350

如果您知道两个圆的半径和中心，这可以通过数学方式确定。

用 getClipBounds() 矩形找到两个圆的交点。- 红色圆圈和getClipBounds() 矩形之间的第二高交点保存矩形的上y 坐标。- 白色圆圈和 getClipBounds() 矩形之间的高交点保存矩形的下 y 坐标。- x 边界已经由 getClipBounds() 矩形给出。

您可以从那里构建您的三个形状。

# windows-8 - 从代码中将图像添加到 FlipView

> ID：13223544
> 
> 赞同：1
> 
> 时间：2012-11-04T22:22:20.000
> 
> 标签：windows-8, microsoft-metro

我正在尝试`FlipView`使用以下代码向 a 添加一些图像：

```
for (int N = 1; N < 30; N++)
{
    string name = String.Format(@"ms-appx:/Gallery/{0:00}.jpg", N);
    Uri uri = new Uri(name);
    BitmapImage img = new BitmapImage(uri);
    MainFlipView.Items.Add(img);
} 
```

但它只显示一些文本。`FlipView`我在我的 XAML 中定义了：

```
 <FlipView x:Name="MainFlipView">
    </FlipView> 
```

我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T09:04:14.923

显示的文本是对 BitmapImage 的 ToString 方法的调用，因为您没有定义 DataTemplate。定义：

```
<FlipView>
    <FlipView.ItemTemplate>
        <DataTemplate>
            <Image Source="{Binding}" />
         </DataTemplate>
    </FlipView.ItemTemplate>
 </FlipView> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-05T09:02:57.730

试试这种格式输入文件名

 **> ```
> 图片\\照片\\italia1.jpg
> ```* 

*.here images 和 photos 显然是文件夹，italia1.jpg 是 pic 文件。我已经使用它将此图像设置为设备的锁定屏幕。所以也许这是可以解决您的翻转视图问题的格式。*

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T08:42:33.433

您的图像路径应如下所示：

```
string name = String.Format(ApplicationData.Current.LocalFolder.Path + @"/Gallery/{0:00}.jpg", N); 
```**

# php - 用 PHP 5 解析 xml 文件？

> ID：13223545
> 
> 赞同：-3
> 
> 时间：2012-11-04T22:22:37.873
> 
> 标签：php, xml-parsing, simplexml

只是我用

```
simplexml_load_file 
```

解析xml文件

当我用它来解析文件时它工作得很好并返回所有文件内容

```
<?php
//$homepage = file_get_contents('');
$x = simplexml_load_file('http://www.metacafe.com/api/videos?vq=sexy&max-results=50');
echo "<pre>";
print_r($x);
echo "</pre>";

?> 
```

输出就好了

```
SimpleXMLElement Object
(
    [@attributes] => Array
        (
            [version] => 2.0
            [source] => Metacafe
        )

    [title] => Metacafe
    [channel] => SimpleXMLElement Object
        (
            [title] => SimpleXMLElement Object
                (
                )

            [link] => http://www.metacafe.com/tags/sexy/
            [image] => SimpleXMLElement Object
                (
                    [url] => http://s.mcstatic.com/Images/MCLogo4RSS.jpg
                    [link] => http://www.metacafe.com
                    [title] => Metacafe
                    [height] => 65
                    [width] => 229
                )

            [description] => SimpleXMLElement Object
                (
                )

            [item] => Array
                (
                    [0] => SimpleXMLElement Object
                        (
                            [id] => 9310776
                            [author] => ORLIK MUSCLE VIDEO
                            [title] => Muscle Worship. MEET: 18 Y.o. Vlad
                            [link] => http://www.metacafe.com/watch/9310776/muscle_worship_meet_18_y_o_vlad/
                            [rank] => 4.33
                            [category] => Sports
                            [description] => SimpleXMLElement Object
                                (
                                )

                            [guid] => http://www.metacafe.com/watch/9310776/muscle_worship_meet_18_y_o_vlad/
                            [pubDate] => 01-Nov-12 +0000
                        )

                    [1] => SimpleXMLElement Object
                        (
                            [id] => yt-RU2yJxjxMtw
                            [author] => Metacafe Affiliate U
                            [title] => 10 Minute Intense Sexy Bikini ABS WORKOUT!! TRY IT!!
                            [link] => http://www.metacafe.com/watch/yt-RU2yJxjxMtw/10_minute_intense_sexy_bikini_abs_workout_try_it/
                            [rank] => 4.33
                            [category] => How To
                            [description] => SimpleXMLElement Object
                                (
                                )

                            [guid] => http://www.metacafe.com/watch/yt-RU2yJxjxMtw/10_minute_intense_sexy_bikini_abs_workout_try_it/
                            [pubDate] => 30-Oct-12 +0000
                        )

                    [2] => SimpleXMLElement Object
                        (
                            [id] => 9296344
                            [author] => Sonia Wari
                            [title] => Arab Real Hot Girl Desi Video
                            [link] => http://www.metacafe.com/watch/9296344/arab_real_hot_girl_desi_video/
                            [rank] => 4.33
                            [category] => Entertainment
                            [description] => SimpleXMLElement Object
                                (
                                )

                            [guid] => http://www.metacafe.com/watch/9296344/arab_real_hot_girl_desi_video/
                            [pubDate] => 28-Oct-12 +0000
                        )

                    [3] => SimpleXMLElement Object
                        (
                            [id] => 9299266
                            [author] => lehren.tv
                            [title] => Sherlyn Chopra In 3D Kamasutra
                            [link] => http://www.metacafe.com/watch/9299266/sherlyn_chopra_in_3d_kamasutra/
                            [rank] => 4.22
                            [category] => Entertainment
                            [description] => SimpleXMLElement Object
                                (
                                )

                            [guid] => http://www.metacafe.com/watch/9299266/sherlyn_chopra_in_3d_kamasutra/
                            [pubDate] => 29-Oct-12 +0000
                        )

                    [4] => SimpleXMLElement Object
                        (
                            [id] => cb-r3B4NEf5A8sw
                            [author] => CBS
                            [title] => Can the New Dart Give Dodge a Sexy Italian Accent? CNET On Cars, Episode 5
                            [link] => http://www.metacafe.com/watch/cb-r3B4NEf5A8sw/can_the_new_dart_give_dodge_a_sexy_italian_accent_cnet_on_cars_episode_5/
                            [rank] => 4.00
                            [category] => Entertainment
                            [description] => SimpleXMLElement Object
                                (
                                )

                            [guid] => http://www.metacafe.com/watch/cb-r3B4NEf5A8sw/can_the_new_dart_give_dodge_a_sexy_italian_accent_cnet_on_cars_episode_5/
                            [pubDate] => 30-Oct-12 +0000
                        )

                    [5] => SimpleXMLElement Object
                        (
                            [id] => cb-jZx26n5Iweg1
                            [author] => CBS
                            [title] => The Young and the Restless - 10/30/2012 Sneak Peek - Season 40
                            [link] => http://www.metacafe.com/watch/cb-jZx26n5Iweg1/the_young_and_the_restless_10_30_2012_sneak_peek_season_40/
                            [rank] => 4.00
                            [category] => Entertainment
                            [description] => SimpleXMLElement Object
                                (
                                )

                            [guid] => http://www.metacafe.com/watch/cb-jZx26n5Iweg1/the_young_and_the_restless_10_30_2012_sneak_peek_season_40/
                            [pubDate] => 30-Oct-12 +0000
                        )

                )

        )

) 
```

当我尝试仅打印项目数组时问题才刚刚开始

```
<?php
//$homepage = file_get_contents('');
$x = simplexml_load_file('http://www.metacafe.com/api/videos?vq=sexy&max-results=50');
echo "<pre>";
print_r($x->channel->item);
echo "</pre>";

?> 
```

这个只得到项目数组的第一个对象而不是整个数组

```
SimpleXMLElement Object
(
    [id] => 9310776
    [author] => ORLIK MUSCLE VIDEO
    [title] => Muscle Worship. MEET: 18 Y.o. Vlad
    [link] => http://www.metacafe.com/watch/9310776/muscle_worship_meet_18_y_o_vlad/
    [rank] => 4.33
    [category] => Sports
    [description] => SimpleXMLElement Object
        (
        )

    [guid] => http://www.metacafe.com/watch/9310776/muscle_worship_meet_18_y_o_vlad/
    [pubDate] => 01-Nov-12 +0000
) 
```

我需要做的是检索项目数组的整个对象

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T22:24:31.210

```
<?php
//$homepage = file_get_contents('');
$x = simplexml_load_file('http://www.metacafe.com/api/videos?vq=sexy&max-results=50');
echo "<pre>";
foreach($x->channel->item as $key=>$value){
    print_r($value);
}
echo "</pre>";
?> 
```

只是在foraech循环中制作它？

# ruby-on-rails - 无法让 Accepts_nested_attributes 在 Rails 3 中工作

> ID：13223549
> 
> 赞同：1
> 
> 时间：2012-11-04T22:23:25.683
> 
> 标签：ruby-on-rails, ruby, nested-forms

这可能是我失明的情况......不知何故我无法让我的 layout_positions_attributes 到达 layout_positions

```
l = Layout.new
…
[17] pry(main)> l.layout_positions
=> []
[18] pry(main)> l.layout_positions_attributes=[{:name=>'xxx'}]
=> [{:name=>"xxx"}]
[19] pry(main)> l.layout_positions
=> [] # WTF!
[20] pry(main)> l.layout_positions.build({:name=>'xxx'})
=> #<LayoutPosition id: nil, name: "xxx", active: true, columns: nil, rows: nil, layout_id: nil, pos: -1>
[21] pry(main)> l.layout_positions
=> [#<LayoutPosition id: nil, name: "xxx", active: true, columns: nil, rows: nil, layout_id: nil, pos: −1>] 
```

父类：

```
class Layout < ActiveRecord::Base
  attr_accessible :name, :active, :layout_positions_attributes
  has_many :layout_positions
  accepts_nested_attributes_for :layout_positions,
                                :reject_if => lambda { |a| a[:content].blank? },
                                :allow_destroy => true
  validates_presence_of :name
end 
```

以及属性应该去哪里……</p>

```
class LayoutPosition < ActiveRecord::Base
  attr_accessible :name, :active, :columns, :rows, :pos
  belongs_to :layout
  validates_presence_of :name
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T22:38:59.853

如果对象为空白`content`，您将告诉它拒绝它。`layout_position`在您的示例中，在“WTF”上方，您没有传递任何内容。因此，这是删除属性。

调用`build`不依赖`accepts_nested_attributes_for`，因此可以正常工作。

# c# - C# ~ 关于 List<> 的几个问题

> ID：13223551
> 
> 赞同：0
> 
> 时间：2012-11-04T22:23:37.457
> 
> 标签：c#, list

我通常不在 Windows 上开发，但最近我不得不用 C# 做一些工作，并且我正在努力解决一些事情。我一直在浏览 MSDN，但找不到我要找的东西。

无论如何，据我所知，一个 List 被索引，就像一个数组。但是，如果我使用 RemoveAt() 删除了位置 X 的一个项目，它会移动所有项目，以便一个新项目现在填充位置 X？还是位置 X 只是空的？

如果您有一个字符串或整数列表，那么使用 Remove() 似乎也相当简单，但是如果您有一个对象列表，是否可以使用 Remove() 删除对象字段具有特定值的项目？

例如

假设我有列表，其中每个汽车对象都有品牌、型号和颜色。

我可以做一些类似的事情吗

```
 cars.Remove(cars.color="red"); 
```

我确信这是非常错误的，但我来自 PHP 背景，所以我现在对很多语法感到很困惑。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T22:29:02.767

`List<T>`不会有洞。
删除一个项目会将所有后续项目上移一个。

`RemoveAll()`您可以通过使用 lambda 表达式调用来删除所有符合条件的项目：

```
list.RemoveAll(o => o.Color == "Red"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-04T22:29:43.327

> 如果我使用 RemoveAt() 在位置 X 删除了一个项目，它会移动所有项目，以便一个新项目现在填充位置 X？

是的。

> 如果您有一个对象列表，是否可以使用 Remove() 删除对象字段具有特定值的项目？

是的，使用`RemoveAll`方法：

```
cars.RemoveAll(c => c.color == "red"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T22:32:28.620

当物品被移除时，该位置被下一个占据。由于列表是集合，您可以将 lambda 与 remove all 一起使用

```
Cars.RemoveAll( x=> x.colour == "red"); 
```

将删除所有重新汽车。

# proxy - 仅代理一位用户

> ID：13223552
> 
> 赞同：1
> 
> 时间：2012-11-04T22:23:41.373
> 
> 标签：proxy

我们的俱乐部有一个不允许同时登录的网络服务帐户（我们都使用相同的凭据）。

从技术上讲，可能有 2 个用户同时登录，但服务的一般条款告诉我们，如果他们注意到，我们将被终止。

我正在寻找用户和服务之间的某种代理服务，以确保只有一个用户同时连接。（最好的我可以安装在 linux 服务器上）

鱿鱼能做到吗？

# asp.net - 如何将字符串转换为标题大小写并删除重复空格

> ID：13223553
> 
> 赞同：0
> 
> 时间：2012-11-04T22:23:44.123
> 
> 标签：asp.net, stored-procedures, crystal-reports

我有一个长字符串（“sara james joseph NAUMAN”），它使用存储过程在 VS2008（c#）中使用 Crystal Reports 显示。

1.  我想将其转换为标题大小写（“Sara Williams Joseph Nauman”）
2.  如果单词之间有两个以上，我也想删除空格。

我想知道如何在存储过程、Crystal Reports 公式或 .cs 文件中进行转换。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T06:40:11.857

有一个名为 ProperCase(str) 的函数可以修复大小写。

```
`ProperCase("sara james joseph NAUMAN")` 
```

借用一点 Hariharan Anbazhagan 的代码；如果字符串前后有空格，请使用 Trim(str)。没有想到删除单词之间空格的功能，因此此代码将完成这项工作。

```
stringvar str1;
stringvar str2;
numbervar counter;
numbervar leng;

str2 := Trim("   Big     Space   ");

leng := len(str2);
if leng>0 then
(
    for counter := 1 to leng do
    (
        If Not(Mid(str2, counter, 1) = " " and (Mid(str2, counter+1, 1)) = " ") Then
        (
            str1:=str1 + Mid(str2, counter, 1)
        )
    );
str1
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T18:00:54.600

自定义公式`Format()`：

```
// Format()
Function (Stringvar value, Optional Stringvar delimiter:=",")

    // create an array of formetted names (and blanks)
    // "sara james joseph       NAUMAN" => "Sara James Joseph       Nauman"
    Local Stringvar Array temp:=Split( ProperCase(value), " ");

    Local Stringvar Array values;

    Local Numbervar i;

    // remove empty array positions
    For i:= 1 To Ubound(temp) Do (

      If temp[i]<>"" Then (

        Redim Preserve values[Ubound(values)+1];
        values[Ubound(values)]:=temp[i]

      )

    );

    // delimited list
    Join(values, delimiter); 
```

在公式中引用它：

```
// returns "Sara,James,Joseph,Nauman"
Format("sara james joseph       NAUMAN") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-18T17:11:32.837

在 VB.net 中，等价于：

```
str1 = StrConv(str1, vbProperCase) 
```

这只是一个仅供参考，以防其他人在 VB.net 中寻找它。

# ruby-on-rails - 在 Ruby on Rails 中保存模型失败。更新工作正常

> ID：13223559
> 
> 赞同：0
> 
> 时间：2012-11-04T22:24:23.893
> 
> 标签：ruby-on-rails

我有一个小型 Rub​​y on Rails 应用程序，我正在尝试重构它，并且在此过程中破坏了保存一些数据的能力。我确实花了一*整天*的时间试图解决这个问题（我是一个 Rails 新手，基本上仅限于尝试改进我已经拥有的应用程序）。

我有与它们相关联的位置的文档：

```
class Document < ActiveRecord::Base   
  has_many :locations, :dependent => :destroy
end

class Location < ActiveRecord::Base
  belongs_to :document
end 
```

我可以编辑已添加到文档中的位置（来自文档/locations.html）：

```
<% @locations.each do |location| %>
  <% unless location.new_record? %>
    <%@location = location%>
    <%= form_for(@location,:url=>document_location_path(@document,@location),:method=>:put) do |f| %>
      <%= render :partial => "document_locations/form", :locals => {:f => f } %>
    <% end %>
  <% end %> 
<% end %> 
```

但是尝试添加新位置不会出错，但也不要添加保存

```
<% @location = @document.locations.new %>
<%= form_for(@location,:url=>:document_locations, :method=>:post) do |f| %>
  <%= render :partial => "document_locations/form", :locals => {:f => f } %>
<%end%> 
```

当我耙路线时，我看到以下内容

```
 document_locations        /documents/:document_id/locations(.:format)                   {:controller=>"documents", :action=>"locations"}

    document_document_locations GET    /documents/:document_id/document_locations(.:format)          {:action=>"index", :controller=>"document_locations"}
                                POST   /documents/:document_id/document_locations(.:format)          {:action=>"create", :controller=>"document_locations"}
 new_document_document_location GET    /documents/:document_id/document_locations/new(.:format)      {:action=>"new", :controller=>"document_locations"}
edit_document_document_location GET    /documents/:document_id/document_locations/:id/edit(.:format) {:action=>"edit", :controller=>"document_locations"}
     document_document_location GET    /documents/:document_id/document_locations/:id(.:format)      {:action=>"show", :controller=>"document_locations"}
                                PUT    /documents/:document_id/document_locations/:id(.:format)      {:action=>"update", :controller=>"document_locations"}
                                DELETE /documents/:document_id/document_locations/:id(.:format)      {:action=>"destroy", :controller=>"document_locations"} 
```

我猜我的路线和控制器处于正确的旧混乱状态，但任何关于我如何开始排除故障的建议将不胜感激。

development.log 在我尝试添加位置时显示了这一点：

```
Started POST "/documents/210/locations" for 127.0.0.1 at 2012-11-04 23:14:16 +0000
DEPRECATION WARNING: class_inheritable_attribute is deprecated, please use class_attribute method instead. Notice their behavior are slightly different, so refer to class_attribute documentation first. (called from acts_as_taggable_on at /home/christian/Documents/business/development/pastpaper/vendor/plugins/acts-as-taggable-on/lib/acts_as_taggable_on/acts_as_taggable_on.rb:34)
  Processing by DocumentsController#locations as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"OEsBVZPX8NznM0oO/O38/BSrjlpJrNV7oEZTWTcQV9c=", "location"=>{"street1"=>"xian1", "street2"=>"xian2", "town"=>"xian3", "county"=>"", "state"=>"", "country"=>""}, "commit"=>"Save", "document_id"=>"210"}
  Document Load (0.6ms)  SELECT `documents`.* FROM `documents` WHERE `documents`.`id` = 210 LIMIT 1
  DocumentAttribute Load (0.6ms)  SELECT `document_attributes`.* FROM `document_attributes` WHERE `document_attributes`.`document_id` IN (210) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T23:33:25.450

如我所见，为该位置生成的资源路由包含一个必须存在的 document_id。我假设您随后将位置资源路由定义为文档路由的嵌套。因此：

```
<%= form_for(@location,:url=>:document_locations, :method=>:post) do |f| %> 
```

看起来不完整，因为您没有将文档传递给路线。尝试：

```
<%= form_for(@document, @location) do |f| %> 
```

# javascript - Javascript 等值变量 .value

> ID：13223562
> 
> 赞同：0
> 
> 时间：2012-11-04T22:24:42.970
> 
> 标签：javascript, jquery

这是我正在使用的代码：http: [//jsfiddle.net/9B84H/26/](http://jsfiddle.net/9B84H/26/)

```
function autosuggest() {
var input = document.getElementById('location');
    var options = {types: [],};
    var autocomplete = new google.maps.places.Autocomplete(input, options);
}

function getLatLng() {
    var geocoder = new google.maps.Geocoder();
    var address = document.getElementById('location').value;
    geocoder.geocode({
        'address': address
    }, function (results, status) {
        if (status === google.maps.GeocoderStatus.OK) {
            $('#lat').val(results[0].geometry.location.lat());
            $('#lng').val(results[0].geometry.location.lng());
        } else {
            alert("Geocode failed: " + status);
        }
    });
} 
```

有两个变量几乎相同​：

```
var address = document.getElementById('location').value;
var input = document.getElementById('location'); 
```

有没有机会将它组合成一行作为全局变量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T22:35:05.243

您可以使用匿名自调用函数或仅使用 jQuery 中的 dom-ready 方法来包装您的代码（如果您不将 JS 代码放在页面底部，dom-ready 似乎是一个更好的主意）。

我做了一个示例，删除了您输入的 onclick、onfocus 属性并将它们放在 javascript 部分中：http: [//jsfiddle.net/9B84H/27/](http://jsfiddle.net/9B84H/27/)

```
$(function() {
    var location = document.getElementById('location');
    var getLatLng = function() {
        var geocoder = new google.maps.Geocoder();
        var address = location.value;
        geocoder.geocode({
            'address': address
        }, function (results, status) {
            if (status === google.maps.GeocoderStatus.OK) {
                $('#lat').val(results[0].geometry.location.lat());
                $('#lng').val(results[0].geometry.location.lng());
                alert("Geocode success");
            } else {
                alert("Geocode failed: " + status);
            }
        });
    };
    var autosuggest = function() {
        var options = {types: []};
        var autocomplete = new google.maps.places.Autocomplete(location, options);
    };
    $("#location").on("focus", autosuggest);
    $(":button[name='Geocode']").on("click", getLatLng);
}); 
```

您现在有一个名为的局部变量`location`，它引用文档中的#location 元素。

# android - 没有 XML 的 Android 首选项屏幕

> ID：13223564
> 
> 赞同：4
> 
> 时间：2012-11-04T22:24:48.283
> 
> 标签：android, android-preferences, preferenceactivity, preferencescreen

我想在不编写 XML 布局文件的情况下创建首选项屏幕。我想将设置存储在 SQLite 数据库中。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:52:15.953

您可以简单地创建一个首选项层次结构（可能在`onCreate()`中`PreferenceFragment`）：

```
PreferenceScreen screen = new PreferenceScreen(); 
```

并将首选项添加到`screen`using `addPreference`。在`PreferenceFragment`（或`PreferenceActivity`，如果您不使用片段）中，只需`setPreferenceScreen`在构建层次结构后调用它。

# sql - 如何将一条记录分成两条并设置空值？

> ID：13223565
> 
> 赞同：1
> 
> 时间：2012-11-04T22:24:57.723
> 
> 标签：sql, sql-server, stored-procedures

我有以下记录：

```
Id    Date          MondayMorning  MondayEvening  TuesdayMorning TuesdayEvening and so on
1   2012-01-01          2               3               2              2
2   2012-01-02          2               2               2              2 
```

我想将记录 1 分成两条记录，因为 mondaymorning 和 mondayevening 的状态不一样。如果状态相同，则什么也不做。

我期望的结果：

```
Id    Date          MondayMorning  MondayEvening  TuesdayMorning  TuesdayEvening
1   2012-01-01          2               NULL          2                 2
1   2012-01-01          NULL            3             NULL              NULL
2   2012-01-02          2               2             2                 2 
```

请记住，其他日子也可能有所不同。

我已经有一个查询，但是，印楝一些变化。请参阅 [SQL Fiddle](http://sqlfiddle.com/#!3/d41d8/5712)上的查询。您可以在此处看到的输出是出错的情况。对于周二晚上和周一晚上，我期待 2。

SQL Fiddle 上的信息是：

```
Declare @t Table(Id int identity,[Date] Datetime,MondayMorning Int,MondayEvening Int,TuesdayMorning Int,TuesdayEvening Int)
Insert Into @t Select '2012-01-01',0,2,0,2

SELECT id
    ,date
    ,MondayMorning
    ,(CASE WHEN MondayEvening <> MondayMorning THEN NULL ELSE MondayEvening END) AS MondayEvening
    ,TuesdayMorning
    ,(CASE WHEN TuesdayEvening <> TuesdayMorning THEN NULL ELSE TuesdayEvening END) AS TuesdayEvening
FROM @t 

UNION ALL 

SELECT id
    ,date
    ,NULL AS MondayMorning
    ,(CASE WHEN MondayEvening = MondayMorning THEN NULL ELSE MondayEvening END) AS MondayEvening
    ,NULL AS TuesdayMorning
    ,(CASE WHEN TuesdayEvening = TuesdayMorning THEN NULL ELSE TuesdayEvening END) AS TuesdayEvening
FROM @t
WHERE --MondayMorning <> MondayEvening
--OR TuesdayMorning <> TuesdayEvening
MondayMorning <> MondayEvening
AND (MondayMorning != 0 and MondayEvening != 0)
OR TuesdayMorning <> TuesdayEvening
AND (TuesdayEvening != 0 and TuesdayMorning != 0) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:52:57.540

SQL Server 2008+，`VALUES`用于优雅地构造子查询。

```
Declare @t Table(Id int identity,[Date] Datetime,MondayMorning Int,MondayEvening Int,TuesdayMorning Int,TuesdayEvening Int)
Insert Into @t Select '2012-01-01',0,2,3,2

     SELECT t.Id, t.[Date],
            Case when MondayMorning=v.state then MondayMorning end MondayMorning,
            Case when MondayEvening=v.state then MondayEvening end MondayEvening,
            Case when TuesdayMorning=v.state then TuesdayMorning end TuesdayMorning,
            Case when TuesdayEvening=v.state then TuesdayEvening end TuesdayEvening
       FROM @t t
CROSS APPLY (select distinct State
               from (values(MondayMorning),
                           (MondayEvening),
                           (TuesdayMorning),
                           (TuesdayEvening)) v(state)) v(state) 
```

在 SQL Server 2005 上，将`VALUES()`派生表替换为 SELECT .. UNION ALL，例如

```
CROSS APPLY (select distinct State
               from (SELECT MondayMorning UNION ALL
                     SELECT MondayEvening UNION ALL
                     SELECT TuesdayMorning UNION ALL
                     SELECT TuesdayEvening) v(state)) v(state) 
```

# python - Rally API：如何复制测试文件夹和成员测试用例

> ID：13223568
> 
> 赞同：0
> 
> 时间：2012-11-04T22:25:13.717
> 
> 标签：python, ruby, rest, rally, pyral

之前另一个用户提出了这个问题：

[使用 Rally Python 或 Ruby API 复制测试用例和测试文件夹 [关闭]](https://stackoverflow.com/questions/13036251/copying-test-cases-and-test-folder-using-rally-python-or-ruby-api)

但被主持人关闭为一个过于广泛的问题。[但是，鉴于无法在Rally UI](https://rally1.rallydev.com)中复制测试文件夹及其成员测试用例，这是 Rally 用户的常见需求。

因此 - 我将重新提出这个问题，希望有足够的细节来作为一个有效的问题。我还将重新发布我为原始问题开发的答案。

问题：作为 Rally Python 和 Ruby REST API 的[Rally](https://www.rallydev.com)用户和开发人员：我如何利用[Rally API 工具包](http://developer.rallydev.com/help/rest-apis)来完成这项任务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T22:29:32.120

**Python：**

这是执行此任务的脚本 - 它将*所有*测试用例从由 FormattedID 标识的源测试文件夹复制到同样由 FormattedID 标识的目标测试文件夹。它还将复制*所有*测试步骤和附件。目标测试文件夹必须存在，即如果找不到目标，脚本不会为您创建测试文件夹。

该脚本不会将新测试用例与原始测试用例的工作产品（即缺陷、用户故事）相关联，或复制讨论项、测试用例结果或上次构建、判断等，因为假定需要新测试用例处于“空白”状态。

对于那些需要安装和配置 Rally Python REST 库的人：

[Rally 开发者门户：Pyral 下载和安装](http://developer.rallydev.com/help/python-toolkit-rally-rest-api)

[Pyral 文档](http://pyral.readthedocs.org/en/latest/)

```
#!/usr/bin/env python

#################################################################################################
#
#  copy_test_folder.py -- Copy all Test Cases in Source Test Folder to Target. Includes Test Steps
#                         and attachments. Target Test Folder must exist (i.e. the script will not
#                         create a new targeet Test Folder for you)
#
USAGE = """
Usage: copy_test_folder.py
"""
#################################################################################################
# import needed python libs
import sys, os
import re
import string
import base64

from pprint import pprint

# import needed pyral libs
from pyral import Rally, rallySettings, RallyRESTAPIError

errout = sys.stderr.write

my_server      = "rally1.rallydev.com"
my_user        = "user@company.com"
my_password    = "topsecret"
my_workspace   = "My Workspace"
my_project     = "My Project"

source_test_folder_formatted_id = "TF1"
target_test_folder_formatted_id = "TF4"

rally = Rally(my_server, my_user, my_password, workspace=my_workspace, project=my_project)
# rally = Rally(my_server, my_user, my_password, workspace=my_workspace, project=my_project, debug=True)
rally.enableLogging('copy_test_folder.log')

# Query for source and target test folders
source_test_folder_response = rally.get('TestFolder', fetch=True, query='FormattedID = %s' % source_test_folder_formatted_id)
target_test_folder_response = rally.get('TestFolder', fetch=True, query='FormattedID = %s' % target_test_folder_formatted_id)

# Check to make sure folders exist
if source_test_folder_response.resultCount == 0:
                 errout('No Source Test Folder Found matching Formatted ID: %s\n' % (source_test_folder_formatted_id))
                 sys.exit(4)

if target_test_folder_response.resultCount == 0:
                 errout('No Target Test Folder Found matching Formatted ID: %s\n. Target Test Folder must be created before copying.' % (target_test_folder_formatted_id))
                 sys.exit(4)

# Get references to source Test Folder and Test Cases, etc.                 
source_test_folder = source_test_folder_response.next()
source_test_cases = source_test_folder.TestCases

# Get reference to target Test Folder
target_test_folder = target_test_folder_response.next()

for source_test_case in source_test_cases:
                 # Create update fields for target Test Case
                 # Does NOT associate new Test Case to original Test Case's work product (i.e. Defect, User Story)
                 # Does NOT copy Discussion items - as the old Discussions are likely not desired on new Test Case
                 # Does NOT copy Last Build, Last Run, Last Update Date, Last Verdict as new Test Case will effectively
                 # be "blank" and not have any results associated to it
                 if source_test_case.Owner != None:
                                  target_owner = source_test_case.Owner.ref
                 else:
                                  target_owner = None
                 target_test_case_fields = {
                                  "Package": source_test_case.Package,
                                  "Description": source_test_case.Description,
                                  "Method": source_test_case.Method,
                                  "Name": source_test_case.Name,
                                  "Objective": source_test_case.Objective,
                                  "Owner": target_owner,
                                  "PostConditions": source_test_case.PostConditions,
                                  "PreConditions": source_test_case.PreConditions,
                                  "Priority": source_test_case.Priority,
                                  "Project": source_test_case.Project.ref,
                                  "Risk": source_test_case.Risk,
                                  "ValidationInput": source_test_case.ValidationInput,
                                  "ValidationExpectedResult": source_test_case.ValidationExpectedResult,
                                  "TestFolder": target_test_folder.ref,
                 }

                 # Create the target test case
                 try:
                                  target_test_case = rally.create("TestCase", target_test_case_fields)
                                  message = "Copied Source Test Case: " + source_test_case.FormattedID + \
                                            " To: " + target_test_folder.FormattedID + ": " + target_test_folder.Name + \
                                            ": " + target_test_case.FormattedID
                                  print message

                 except RallyRESTAPIError, details:
                                  sys.stderr.write('ERROR: %s \n' % details)
                                  sys.exit(2)

                 # Copy Test Steps
                 # Add Test Case Steps
                 source_test_case_steps = source_test_case.Steps
                 for source_step in source_test_case_steps:
                                  target_step_fields = {
                                                  "TestCase"          : target_test_case.ref,
                                                  "StepIndex"         : source_step.StepIndex,
                                                  "Input"             : source_step.Input,
                                                  "ExpectedResult"    : source_step.ExpectedResult                                                   
                                  }
                                  target_test_case_step = rally.put('TestCaseStep', target_step_fields)
                                  print "===> Copied  TestCaseStep: %s   OID: %s" % (target_test_case_step.StepIndex, target_test_case_step.oid)                 

                 # Copy Attachments
                 source_attachments = rally.getAttachments(source_test_case)

                 for source_attachment in source_attachments:

                                  # First copy the content
                                  source_attachment_content = source_attachment.Content
                                  target_attachment_content_fields = {
                                                   "Content": base64.encodestring(source_attachment_content)
                                  }

                                  try:
                                                   target_attachment_content = rally.put('AttachmentContent', target_attachment_content_fields)
                                                   print "===> Copied AttachmentContent: %s" % target_attachment_content.ref
                                  except RallyRESTAPIError, details:
                                                   sys.stderr.write('ERROR: %s \n' % details)
                                                   sys.exit(2)

                                  # Next copy the attachment object
                                  target_attachment_fields = {
                                                   "Name": source_attachment.Name,
                                                   "Description": source_attachment.Description,
                                                   "Content": target_attachment_content.ref,
                                                   "ContentType": source_attachment.ContentType,
                                                   "Size": source_attachment.Size,
                                                   "Artifact": target_test_case.ref,
                                                   "User": source_attachment.User.ref
                                  }
                                  try:
                                                   target_attachment = rally.put('Attachment', target_attachment_fields)
                                                   print "===> Copied Attachment: %s" % target_attachment.ref
                                  except RallyRESTAPIError, details:
                                                   sys.stderr.write('ERROR: %s \n' % details)
                                                   sys.exit(2)

                 # Copy Tags
                 source_tags = source_test_case.Tags;
                 target_tags = list()
                 for source_tag in source_tags:
                                  target_tags.append({"_ref":source_tag.ref})

                 target_test_case_fields = {
                                  "FormattedID": target_test_case.FormattedID,
                                  "Tags": target_tags
                 }

                 try:
                                  update_response = rally.update('TestCase', target_test_case_fields)
                 except RallyRESTAPIError, details:
                                  sys.stderr.write('ERROR: %s \n' % details)
                                  sys.exit(2) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T22:26:55.693

**红宝石：**

此 Ruby 脚本会将所有测试用例从由 FormattedID 标识的源测试文件夹复制到同样由 FormattedID 标识的目标测试文件夹。它还将复制所有测试步骤和附件。目标测试文件夹必须存在，即如果找不到目标，脚本不会为您创建测试文件夹。

该脚本不会将新测试用例与原始测试用例的工作产品（即缺陷、用户故事）相关联，或复制讨论项、测试用例结果或上次构建、判断等，因为假定需要新测试用例处于“空白”状态。

对于那些需要安装和配置 Ruby REST 工具包的人，链接在这里：

[开发人员门户：Ruby 的 Rally REST API](http://developer.rallydev.com/help/ruby-toolkit-rally-rest-api-json)

[Github](https://github.com/RallyTools/RallyRestToolkitForRuby)

```
 # Copyright 2002-2012 Rally Software Development Corp. All Rights Reserved.

    require 'rally_api'

    $my_base_url       = "https://rally1.rallydev.com/slm"
    $my_username       = "user@company.com"
    $my_password       = "password"
    $my_workspace      = "My Workspace"
    $my_project        = "My Project"
    $wsapi_version     = "1.37"

    # Test Folders
    $source_test_folder_formatted_id = "TF4"
    $target_test_folder_formatted_id = "TF8"

    # Load (and maybe override with) my personal/private variables from a file...
    my_vars= File.dirname(__FILE__) + "/my_vars.rb"
    if FileTest.exist?( my_vars ) then require my_vars end

    #==================== Make a connection to Rally ====================
    config                  = {:base_url => $my_base_url}
    config[:username]       = $my_username
    config[:password]       = $my_password
    config[:workspace]      = $my_workspace
    config[:project]        = $my_project
    config[:version]        = $wsapi_version

    @rally = RallyAPI::RallyRestJson.new(config)

    begin

      # Lookup source Test Folder
      source_test_folder_query = RallyAPI::RallyQuery.new()
      source_test_folder_query.type = :testfolder
      source_test_folder_query.fetch = true
      source_test_folder_query.query_string = "(FormattedID = \"" + $source_test_folder_formatted_id + "\")"

      source_test_folder_result = @rally.find(source_test_folder_query)

      # Lookup Target Test Folder
      target_test_folder_query = RallyAPI::RallyQuery.new()
      target_test_folder_query.type = :testfolder
      target_test_folder_query.fetch = true
      target_test_folder_query.query_string = "(FormattedID = \"" + $target_test_folder_formatted_id + "\")"

      target_test_folder_result = @rally.find(target_test_folder_query)

      if source_test_folder_result.total_result_count == 0
        puts "Source Test Folder: " + $source_test_folder_formatted_id + "not found. Exiting."
        exit
      end

      if target_test_folder_result.total_result_count == 0
        puts "Target Test Folder: " + $target_test_folder_formatted_id + "not found. Target must exist before copying."
        exit
      end

      source_test_folder = source_test_folder_result.first()
      target_test_folder = target_test_folder_result.first()

      # Populate full object for Target Test Folder
      full_target_test_folder = target_test_folder.read

      # Get Target Project
      target_project = full_target_test_folder["Project"]

      # Grab collection of Source Test Cases
      source_test_cases = source_test_folder["TestCases"]

      # Loop through Source Test Cases and Copy to Target
      source_test_cases.each do |source_test_case|
        # Get full object for Source Test Case
        full_source_test_case = source_test_case.read

        # Check if there's an Owner
        if !full_source_test_case["Owner"].nil?
          source_owner = full_source_test_case["Owner"]
        else
          source_owner = nil
        end

        # Populate field data from Source to Target
        target_test_case_fields = {}
        target_test_case_fields["Package"] = full_source_test_case["Package"]
        target_test_case_fields["Description"] = full_source_test_case["Description"]
        target_test_case_fields["Method"] = full_source_test_case["Method"]
        target_test_case_fields["Name"] = full_source_test_case["Name"]
        target_test_case_fields["Objective"] = full_source_test_case["Objective"]
        target_test_case_fields["Owner"] = source_owner
        target_test_case_fields["PostConditions"] = full_source_test_case["PostConditions"]
        target_test_case_fields["PreConditions"] = full_source_test_case["PreConditions"]
        target_test_case_fields["Priority"] = full_source_test_case["Priority"]
        target_test_case_fields["Project"] = target_project
        target_test_case_fields["Risk"] = full_source_test_case["Risk"]
        target_test_case_fields["ValidationInput"] = full_source_test_case["ValidationInput"]
        target_test_case_fields["ValidationExpectedResult"] = full_source_test_case["ValidationExpectedResult"]
        target_test_case_fields["Tags"] = full_source_test_case["Tags"]
        target_test_case_fields["TestFolder"] = target_test_folder

        # Create the Target Test Case
        begin
          target_test_case = @rally.create(:testcase, target_test_case_fields)
          puts "Test Case: #{full_source_test_case["FormattedID"]} successfully copied to #{full_target_test_folder["FormattedID"]}"
        rescue => ex
          puts "Test Case: #{full_source_test_case["FormattedID"]} not copied due to error"
          puts ex
        end

        # Now Copy Test Steps
        # Add Test Case Steps
        source_test_case_steps = full_source_test_case["Steps"]

        source_test_case_steps.each do |source_test_case_step|
          full_source_step = source_test_case_step.read
          target_step_fields = {}
          target_step_fields["TestCase"] = target_test_case
          target_step_fields["StepIndex"] = full_source_step["StepIndex"]
          target_step_fields["Input"] = full_source_step["Input"]
          target_step_fields["ExpectedResult"] = full_source_step["ExpectedResult"]
          begin
            target_test_case_step = @rally.create(:testcasestep, target_step_fields)
            puts "===> Copied TestCaseStep: #{target_test_case_step["_ref"]}"
          rescue => ex
            puts "Test Case Step not copied due to error:"
            puts ex
          end
        end

          # Now Copy Attachments
          source_attachments = full_source_test_case["Attachments"]

        source_attachments.each do |source_attachment|
          full_source_attachment = source_attachment.read
          source_attachment_content = full_source_attachment["Content"]
          full_source_attachment_content = source_attachment_content.read

          # Create AttachmentContent Object for Target
          target_attachment_content_fields = {}
          target_attachment_content_fields["Content"] = full_source_attachment_content["Content"]
          begin
            target_attachment_content = @rally.create(:attachmentcontent, target_attachment_content_fields)
            puts "===> Copied AttachmentContent: #{target_attachment_content["_ref"]}"
          rescue => ex
            puts "AttachmentContent not copied due to error:"
            puts ex
          end

          # Now Create Attachment Container
          target_attachment_fields = {}
          target_attachment_fields["Name"] = full_source_attachment["Name"]
          target_attachment_fields["Description"] = full_source_attachment["Description"]
          target_attachment_fields["Content"] = target_attachment_content
          target_attachment_fields["ContentType"] = full_source_attachment["ContentType"]
          target_attachment_fields["Size"] = full_source_attachment["Size"]
          target_attachment_fields["Artifact"] = target_test_case
          target_attachment_fields["User"] = full_source_attachment["User"]
          begin
            target_attachment = @rally.create(:attachment, target_attachment_fields)
            puts "===> Copied Attachment: #{target_attachment["_ref"]}"
          rescue => ex
            puts "Attachment not copied due to error:"
            puts ex
          end
        end
      end
    end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-22T10:44:46.127

相同 Python 脚本的改进，添加了以下功能

*   测试文件夹（源和目标）在参数中传递，而不是硬编码
*   创建是递归完成的（即在其中复制测试文件夹和测试用例）
*   如果测试用例已经存在，则替换测试用例（基于名称）
*   使用 API Key 连接而不是密码
*   在放弃之前尝试 5 次连接到 Rally

要使用它复制`TF10`到`TF99`（已经存在）：`python copy_test_folder TF10 TF99`

```
#!/usr/bin/env python

#################################################################################################
#
#  copy_test_folder.py -- Copy all Test Cases in Source Test Folder to Target. Includes Test Steps
#                         and attachments. Target Test Folder must exist (i.e. the script will not
#                         create a new targeet Test Folder for you)
#
USAGE = """
Usage: copy_test_folder.py TF_src TF_dest
"""
#################################################################################################
# import needed python libs
import sys, os
import re
import string
import base64

from pprint import pprint

# import needed pyral libs
from pyral import Rally, rallySettings, RallyRESTAPIError

errout = sys.stderr.write

my_server      = "rally1.rallydev.com"
my_user        = "name@domain.com"
my_password    = "<PASSWORD>"
my_workspace   = "<WORKSPACE>"
my_project     = "<PROJECT>"
my_key         = "<API KEY>"

def connect(nb_attempts=5):
    '''Connect to Rally'''
    global is_connected
    global rally
    #Connect
    if not is_connected and nb_attempts>0:
        print "...Attempting to connect to Rally for project %s..." % my_project
        try:
            # rally = Rally(my_server, my_user, my_password, workspace=my_workspace, project=my_project)
            rally = Rally(my_server, apikey=my_key, workspace=my_workspace, project=my_project)
            print "Connected to Rally for project %s (%s)" % (my_project, my_workspace)
            is_connected=True
            rally.enableLogging('copy_test_folder.log')
        #Errors during connection (attempting to connect again)
        # except Exception, details: 
        except AttributeError: 
            if nb_attempts>1:
                connect(nb_attempts-1)
            else:
                errout('Error during connection to Rally (%s)\n' % details)
                exit(4)
    else: pass

def copyTF(src_TF, dest_TF):
    '''Copy Test Cases from one folder into another (including children Test Folders)'''
    # List names and FormattedID of existing Test Cases in destination
    dest_TCs = dest_TF.TestCases
    existing_dest_TC = {tc.Name:tc.FormattedID for tc in dest_TCs} 

    # Copy Test Cases to destination folder (replace if Test Case with same name exists)
    src_TCs = src_TF.TestCases
    for src_TC in src_TCs:
        # Create update fields for target Test Case
        # Does NOT associate new Test Case to original Test Case's WorkProduct (i.e. Defect, User Story)
        # Does NOT copy Discussion items - as the old Discussions are likely not desired on new Test Case
        # Does NOT copy Last Build, Last Run, Last Update Date, Last Verdict as new Test Case will effectively
        # be "blank" and not have any results associated to it
        tcName = src_TC.Name
        dest_TC_fields = {
            "Package": src_TC.Package,
            "Description": src_TC.Description,
            "Method": src_TC.Method,
            "Name": tcName,
            "Objective": src_TC.Objective,
            "Owner": getattr(src_TC.Owner, 'ref', None),
            "PostConditions": src_TC.PostConditions,
            "PreConditions": src_TC.PreConditions,
            "Priority": src_TC.Priority,
            "Project": src_TC.Project.ref,
            "Risk": src_TC.Risk,
            "ValidationInput": src_TC.ValidationInput,
            "ValidationExpectedResult": src_TC.ValidationExpectedResult,
            "TestFolder": dest_TF.ref,
         }

        # Create/Update the target test case
        try:
            if existing_dest_TC.has_key(tcName):
                operation = "Update"
                dest_TC_fields['FormattedID'] = existing_dest_TC[tcName]
                dest_TC = rally.update("TestCase", dest_TC_fields)
            else:
                #Create
                operation = "Create"
                dest_TC = rally.create("TestCase", dest_TC_fields)

            message = operation + "d Source Test Case: " + src_TC.FormattedID + \
                " To: " + dest_TF.FormattedID + ": " + dest_TF.Name + \
                ": " + dest_TC.FormattedID
            print message

        except RallyRESTAPIError, details:
            sys.stderr.write('ERROR: %s \n' % details)
            sys.exit(2)

        # Copy Test Steps
        #Cleared-up all Test Steps in destination if Test Case is updated
        if operation == "Update":
            dest_TC_steps = dest_TC.Steps
            for dest_step in dest_TC_steps:
                rally.delete('TestCaseStep', dest_step.oid)
            print "===> Cleared all Test Steps"

        # Add Test Case Steps
        src_TC_steps = src_TC.Steps
        for src_step in src_TC_steps:
            target_step_fields = {
                "TestCase"          : dest_TC.ref,
                "StepIndex"         : src_step.StepIndex,
                "Input"             : src_step.Input,
                "ExpectedResult"    : src_step.ExpectedResult                                                   
            }
            dest_TC_step = rally.put('TestCaseStep', target_step_fields)
            print "===> Copied  TestCaseStep: %s   OID: %s" % (dest_TC_step.StepIndex, dest_TC_step.oid)                 

        # Copy Attachments
        source_attachments = rally.getAttachments(src_TC)

        for source_attachment in source_attachments:
            # First copy the content
            source_attachment_content = source_attachment.Content
            target_attachment_content_fields = {
                "Content": base64.encodestring(source_attachment_content)
            }

            try:
                target_attachment_content = rally.put('AttachmentContent', target_attachment_content_fields)
                print "===> Copied AttachmentContent: %s" % target_attachment_content.ref
            except RallyRESTAPIError, details:
                sys.stderr.write('ERROR: %s \n' % details)
                sys.exit(2)

            # Next copy the attachment object
            target_attachment_fields = {
                "Name": source_attachment.Name,
                "Description": source_attachment.Description,
                "Content": target_attachment_content.ref,
                "ContentType": source_attachment.ContentType,
                "Size": source_attachment.Size,
                "Artifact": dest_TC.ref,
                "User": source_attachment.User.ref
            }
            try:
                target_attachment = rally.put('Attachment', target_attachment_fields)
                print "===> Copied Attachment: %s" % target_attachment.ref
            except RallyRESTAPIError, details:
                sys.stderr.write('ERROR: %s \n' % details)
                sys.exit(2)

        # Copy Tags
        source_tags = src_TC.Tags;
        target_tags = list()
        for source_tag in source_tags:
            target_tags.append({"_ref":source_tag.ref})

        dest_TC_fields = {
            "FormattedID": dest_TC.FormattedID,
            "Tags": target_tags
         }

        try:
            update_response = rally.update('TestCase', dest_TC_fields)
        except RallyRESTAPIError, details:
            sys.stderr.write('ERROR: %s \n' % details)
            sys.exit(2)

    # Recursive call for each child Test Folder (after creating it)
    src_children_TFs = src_TF.Children
    dest_children_TFs = dest_TF.Children
    existing_dest_TF = {tf.Name:tf for tf in dest_children_TFs} 
    for src_child_TF in src_children_TFs:
        tfName = src_child_TF.Name
        # Create Test Folder if needed
        if existing_dest_TF.has_key(tfName):
            dest_child_TF = existing_dest_TF[tfName]
        else:
            target_TF_fields = {
                'Name': tfName,
                'Parent': dest_TF.ref
            }
            dest_child_TF = rally.put('TestFolder', target_TF_fields)
            print "Created Test folder %s (%s)" % (tfName, dest_child_TF.FormattedID)
        # Copy Test Cases of this folder
        copyTF(src_child_TF, dest_child_TF)

if '__main__' in __name__:

    # Get source and destination test folders
    src_TF_formatted_id = sys.argv[1]
    dest_TF_formatted_id = sys.argv[2]

    # Connect to Rally
    global is_connected
    is_connected = False
    connect(5)

    # Query for source and target test folders
    global rally
    src_TF_response = rally.get('TestFolder', fetch=True, query='FormattedID = %s' % src_TF_formatted_id)
    dest_TF_response = rally.get('TestFolder', fetch=True, query='FormattedID = %s' % dest_TF_formatted_id)

    # Check to make sure folders exist
    if src_TF_response.resultCount == 0:
        errout('No Source Test Folder Found matching Formatted ID: %s\n' % (src_TF_formatted_id))
        sys.exit(4)

    if dest_TF_response.resultCount == 0:
        errout('No Target Test Folder Found matching Formatted ID: %s\n. Target Test Folder must be created before copying.' % (dest_TF_formatted_id))
        sys.exit(4)

    # Get Objects of source and target Test Folders                
    src_TF = src_TF_response.next()
    dest_TF = dest_TF_response.next()

    # Copy file
    copyTF(src_TF, dest_TF) 
```

# java - 矩形对象抛出错误，说它在 java 中找不到 .contains() 方法

> ID：13223571
> 
> 赞同：0
> 
> 时间：2012-11-04T22:25:31.550
> 
> 标签：java, vector, applet, rectangles

我正在尝试在 mouseClicked 中创建一段代码，以删除从 Vector 中单击的所有矩形。所有矩形都正确存储在向量中，并且我正在检查的点在我运行程序时是有效的。查看文档，确实有一种`rectangle.contains(point)`方法，所以我不确定为什么以下代码段无效。谢谢！

```
public void mouseClicked(MouseEvent m)
    {

      Point p = new Point(m.getPoint());
      Vector v = ball.r; //ball.r is where they are put into in another object's method
      boolean done = false;
      int i = 0;

      while (!done)
      {
        if(v.elementAt(i).contains(p))
        {
          v.removeElement(i);
          i--; //prevent i from incrementing
        }
        i++;
      }
    } 
```

我也没有在 for 循环中这样做，因为据我所知，当一个元素被删除时，向量将“重新打包”并且我将跳过向量的一个元素。不确定我说/这样做是对还是错。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T22:46:39.013

Java [Vector](http://docs.oracle.com/javase/6/docs/api/java/util/Vector.html)可以用作[泛型](http://en.wikipedia.org/wiki/Generics_in_Java)或非泛型。并且您已将其用作非泛型。所以`elementAt(int index)`方法返回一个`Object`，而不是一个`Rectangle`。解决此问题的最简单方法是将返回的内容强制`Object`转换为`Rectangle`对象。像这样，

```
import java.awt.Rectangle;  // Don't forget the to import

public void mouseClicked(MouseEvent m)
{

  Point p = new Point(m.getPoint());
  Vector v = ball.r;
  boolean done = false;
  int i = 0;

  while (!done)
  {
    if( ((Rectangle)(v.elementAt(i)).contains(p))   // casting
    {
      v.removeElement(i);
      i--;
    }
    i++;
  }
} 
```

更好的解决方案是使用泛型。

```
import java.awt.Rectangle;

public void mouseClicked(MouseEvent m)
{

  Point p = new Point(m.getPoint());
  Vector<Rectangle> v = ball.r;   // remember, bar.r Vector must be a Vector<Rectagle> 
  boolean done = false;
  int i = 0;

  while (!done)
  {
    if( (v.elementAt(i).contains(p))   // No casting
    {
      v.removeElement(i);
      i--;
    }
    i++;
  }
} 
```

请记住，您可以将泛型集合分配给非泛型引用，但不能将非泛型对象分配给泛型引用。[您可以在此处](http://docs.oracle.com/javase/tutorial/java/generics/)了解泛型。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-04T22:29:27.437

由于您已定义`Vector v`为原始类型向量，因此它不知道其中的元素类型，即`v.elementAt(i)`，因此无法找到匹配该方法的`contains()`方法。这就是问题的原因。

你有两个选择。在调用方法之前定义`Vector`或`type cast`元素时使用泛型。`contains()`

例如

```
 Vector<Rectangle> v  = (Vector<Rectangle>)ball.r; 
```

或者

```
 if(((Ractangle)v.elementAt(i)).contains(p)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-04T22:34:22.150

```
C:\Users\Alex\Downloads\Bounce2\Bounce2.java:217: cannot find symbol symbol : method contains(java.awt.Point) location: class java.lang.Object if(v.elementAt(i).contains(p)) 
```

此错误消息表明编译器正在寻找类中的`contains()`方法`Object`。换句话说，`v.elementAt(i)`返回一个`Object`，而不是一个`Rectangle`。要解决此问题，您需要更改您的声明`v`如下：

```
Vector<Rectangle> v = ball.r; 
```

希望这可以帮助！

# performance - 在 O(1) 时间内检索堆栈中的 Min 元素

> ID：13223574
> 
> 赞同：7
> 
> 时间：2012-11-04T22:26:00.037
> 
> 标签：performance, algorithm, data-structures, stack

我问这个问题的原因是因为我不明白为什么我认为的方式不能应用于这个特定问题

*“你会如何设计一个堆栈，除了 push 和 pop，还有一个函数 min 可以返回最小元素？push、pop 和 min 都应该在 O(1) 时间内运行*”

**我的基本解决方案：**如果我们在**堆栈**类中有一个变量，那么当我们将一个项目推入堆栈时，我们会检查它是否**小于**我们的**最小**变量。如果将值分配给最小值，则忽略。

你仍然会得到 O(1) 作为 min 函数；

```
int getMinimum(){
  return min;
} 
```

为什么从未提及此解决方案，或者我的想法有什么问题？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-11-04T22:27:36.007

如果您从堆栈中弹出数字，这将不起作用。

前任。2,4,5,3,1。在您弹出 1 次后，您的最低限额是多少？

解决方案是保留一堆最小值，而不仅仅是一个值。如果遇到小于等于当前最小值的值，则需要将其压入最小堆栈。

前任。

```
Push(4):
Stack: 4
Min-stack: 4

Push(2):
Stack: 4 2
Min-stack: 4 2

Push(2):
Stack: 4 2 2
Min-stack: 4 2 2

Push(5):
Stack: 4 2 2 5
Min-stack: 4 2 2

Push(3):
Stack: 4 2 2 5 3
Min-stack: 4 2 2

Push(1):
Stack: 4 2 2 5 3 1
Min-stack: 4 2 2 1

Pop():
Stack: 4 2 2 5 3
Min-stack: 4 2 2

Pop():
Stack: 4 2 2 5
Min-stack: 4 2 2

Pop():
Stack: 4 2 2
Min-stack: 4 2 2

Pop():
Stack: 4 2
Min-stack: 4 2

Pop():
Stack: 4
Min-stack: 4 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-26T09:14:44.313

使用链表来跟踪将成为头部的最小值。

请注意，linkedlist.app= append （我们将值放在尾部）。linkedlist.pre =prepend （我们把值作为链表的头部）

公共类堆栈{

```
int[] elements;
int top;
Linkedlists min;

public Stack(int n) {
    elements = new int[n];
    top = 0;
    min = new Linkedlists();
}

public void realloc(int n) {
    int[] tab = new int[n];
    for (int i = 0; i < top; i++) {
        tab[i] = elements[i];
    }

    elements = tab;
}

public void push(int x) {
    if (top == elements.length) {
        realloc(elements.length * 2);
    }
    if (top == 0) {
        min.pre(x);
    } else if (x < min.head.data) {
        min.pre(x);
    } else {
        min.app(x);
    }
    elements[top++] = x;
}

public int pop() {

    int x = elements[--top];
    if (top == 0) {

    }
    if (this.getMin() == x) {
        min.head = min.head.next;
    }
    elements[top] = 0;
    if (4 * top < elements.length) {
        realloc((elements.length + 1) / 2);
    }

    return x;
}

public void display() {
    for (Object x : elements) {
        System.out.print(x + " ");
    }

}

public int getMin() {
    if (top == 0) {
        return 0;
    }
    return this.min.head.data;
}

public static void main(String[] args) {
    Stack stack = new Stack(4);
    stack.push(2);
    stack.push(3);
    stack.push(1);
    stack.push(4);
    stack.push(5);
    stack.pop();
    stack.pop();
    stack.pop();
    stack.push(1);
    stack.pop();
    stack.pop();
    stack.pop();
    stack.push(2);
    System.out.println(stack.getMin());
    stack.display();

} 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-09T04:27:45.513

我在[这里找到了这个解决方案](http://leetcode.com/2010/11/stack-that-supports-push-pop-and-getmin.html)

```
struct StackGetMin {
  void push(int x) {
    elements.push(x);
    if (minStack.empty() || x <= minStack.top())
      minStack.push(x);
  }
  bool pop() {
    if (elements.empty()) return false;
    if (elements.top() == minStack.top())
      minStack.pop();
    elements.pop();
    return true;
  }
  bool getMin(int &min) {
    if (minStack.empty()) {
      return false;
    } else {
      min = minStack.top();
      return true;
    }
  }
  stack<int> elements;
  stack<int> minStack;
}; 
```

# c# - 为什么 WPF 应用程序中的 Application.Current.Windows 总是为空

> ID：13223575
> 
> 赞同：1
> 
> 时间：2012-11-04T22:26:04.437
> 
> 标签：c#, wpf

我有一个程序，它有一个自定义的 Main 方法（即不是从 App.xaml 自动生成的），除了一件事之外，一切都没有问题；我需要获取所有窗口的集合，并且`WindowCollection`通过 Application.Current.Windows 访问的窗口始终为空（非空但计数 == 0）。

Application 实例的其他属性（例如 MainWindow）可用，但由于某种原因，此集合从未添加到。我错过了接线吗？

作为旁注，每当在 WPF 应用程序中打开新窗口时，是否有任何事件通知？

# php - 自动化网页测试

> ID：13223579
> 
> 赞同：2
> 
> 时间：2012-11-04T22:27:09.097
> 
> 标签：php, javascript

我想在我的网页上自动化一些测试，主要是用无效数据填写表格，看看会发生什么。Javascript可以吗？如果没有，PHP可以吗？该脚本应处理会话和 cookie。

[这](http://www.cs.bgu.ac.il/~kahilm/myForms/)是一个非常简单的示例，它有 3 页。在第一个中您应该输入“x”并单击提交，在第二个中您应该输入“3”并单击提交。如果成功，最后一页应该会显示“你知道了！”。这可以自动化，以便我加载脚本并立即看到“你明白了”吗？**请注意**：为简单起见，这没有 cookie\sessions，但我想要一个支持这些的答案。

*   我尝试制作另一个`iframe`包含上述网站的页面。但无法访问内部的元素`iframe`
*   我尝试使用[cURL](http://php.net/manual/en/book.curl.php)制作一个发送请求的 PHP 脚本，但我无法转发 cookie。
*   [我已经对这个答案](https://stackoverflow.com/questions/189288/automate-getting-report-from-webpage/189358#comment17960209_189358)发表了评论，但没有得到回复。

为方便起见，这里是代码：（您实际上并不需要它，但以防万一..）
**index.html**

```
<!DOCTYPE html>
<html>
First page: please enter x
<form method="post" action="next.php">
<input type="text" id="id" name="id" />
<input type="submit" />
</form>
<html> 
```

**下一个.php**

```
<?php
if(isset($_POST) && isset($_POST['id']) && $_POST['id']!='x'){
    echo '<script>window.location = "http://www.cs.bgu.ac.il/~kahilm/myNavigator/";</script>';
}
?>
<!DOCTYPE html>
<html>
Second page: please enter 3
<form method="POST" action="last.php">
<input type="text" name="code" />
<input type="submit" />
</form>
</html> 
```

**最后一个.php**

```
<?php
if(isset($_POST) && isset($_POST['code']) && $_POST['code']=='3'){
    echo 'you got it!';
}else{
    echo 'you sent something, please make it a "3"... :)';
}
?> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-04T22:29:21.653

考虑 Selenium 浏览器自动化框架 - 它允许您浏览页面、验证条件、填写表格。非常稳定，非常成熟。

[http://seleniumhq.org/](http://seleniumhq.org/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T22:29:19.363

您应该查看以编程方式控制浏览器以执行此类测试。[Selenium](http://seleniumhq.org/)是一个流行的选项，并且在文档中提到了 PHP 绑定（尽管我通常使用 Perl 或 Python）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T22:30:19.227

**基于 PHP 的解决方案：**不会从前端进行测试，仅从服务器后端进行测试，因此不会模拟真实输入。

**JS：**不会跨页面持续存在。

因此，您要么寻找浏览器扩展，要么寻找完全独立于浏览器的独立实用程序。

**你可以试试：**

1.  **[然而， Sikuli](http://www.sikuli.org/)**是通用的，不是针对网页，而是针对一般的 GUI。
2.  **[水或硒](https://stackoverflow.com/questions/417380/watin-or-selenium)**

# jquery - 花式框对话框关闭后如何删除特定的表格行？

> ID：13223580
> 
> 赞同：-3
> 
> 时间：2012-11-04T22:27:15.790
> 
> 标签：jquery, fancybox

这是我调用fancybox对话框的代码：

```
$('.btnUpdateitem').fancybox({
    openEffect  : 'elastic',
    closeEffect : 'elastic',
}); 
```

这是我删除特定表格行的代码：

```
$(this).closest('tr').remove(); 
```

但我的表格是基于 ajax 结果的：

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T22:41:07.107

不知道 $(this) 应该指什么上下文，所以：

在正确的背景下

```
$cachedClosest = $(this).closest('tr'); 
```

调用fancybox

```
$('.btnUpdateitem').fancybox({
    openEffect  : 'elastic',
    closeEffect : 'elastic',
afterClose: function() {
    $cachedClosest.remove();
  })
}); 
```

希望它有一点帮助

# javascript - 如何使用 javascript 压缩 CSS 选择器字符串

> ID：13223584
> 
> 赞同：1
> 
> 时间：2012-11-04T22:27:51.237
> 
> 标签：javascript, jquery, css

也许有一个图书馆已经这样做了？我能找到的只有在线工具。我想在 javascript 中执行此操作的原因是因为我想知道该字符串`a > b, a`与`a> b,a`. 如果我可以将它压缩为 CSS，那么所有版本都将以相同的字符串结束。

更好地解释我为什么要这样做：我为自己编写了一个 jQuery 插件来缓存 jQuery 选择器（这个东西`$('div')`）。它通过存储一个键值对来工作，其中键是我的选择器字符串，值是找到的 DOM 元素。这就是我想比较 CSS 选择器字符串的原因，否则我会存储本质上是相同选择器的不同键。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-04T22:44:46.613

Uglify.js (https://github.com/mishoo/UglifyJS) 可以让你自动压缩 CSS。它将删除所有不必要的空格和注释。这应该允许您标准化您想要的任何内容。您将需要查看 Uglify 源并尝试仅提取所需的组件。

当我在[http://refresh-sf.com/yui/](http://refresh-sf.com/yui/)上进行实验时，似乎选择器总是被适当地缩小（尽管那是使用 YUI 而不是 uglifyjs）。唯一剩下的问题是 a>b,b 和 b,a>b 之间的区别。为此，我建议先缩小，然后用“，”分割；然后按字母顺序对数组进行排序；最后重新加入拆分数组。完成后，您可以使用该值作为哈希。

# cuda - 启动资源不足

> ID：13223589
> 
> 赞同：1
> 
> 时间：2012-11-04T22:28:19.757
> 
> 标签：cuda, pycuda

我编写了以下简单的 CUDA 内核：

```
__global__ void pr_kernel(float* O, const float* I, const float* W, int N)
{
  int x = threadIdx.x;
  float sum;
  int i;
  if (x < N) {
    for (i = 0; i < N; i++) {
      if (i == x) continue;
      sum += W[x*N+i] * I[x];
    }
    O[x] = (0.15 / N) + 0.85 * sum;
  }
} 
```

Python中的变量分配如下：

```
N      = np.int32(4)
W      = np.float32(np.asarray(
         [0, 1, 0, 1, 1, 0, 1, 1, 
         0, 1, 0, 1,1, 1, 0]))
I      = np.float32(np.asarray(
         [0.25, 0.25, 0.25, 0.25]))
O      = np.float32(np.zeros(N)) 
```

我正在使用 传输变量`gpuarray.to_gpu`，并且正在使用以下行调用 Tesla C2070 上的内核：

```
pr_kernel(O_d, I_d, W_d, N_d, block=blocksize, grid=gridsize) 
```

在哪里：

```
blocksize = (128, 1, 1)
gridsize = (1, 1) 
```

我收到错误消息：

```
pycuda.driver.LaunchError: cuLaunchKernel failed: launch out of resources. 
```

即使我将块大小减少到类似`(8, 1, 1)`. 我可以在 GPU 上运行其他块大小为的 CUDA 程序，`(512, 1, 1)`所以我相信这不是由于 GPU 配置问题。

我究竟做错了什么？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T02:01:09.107

问题是我`N`使用 将整数传输到 GPU `gpuarray.to_gpu`，而我应该直接传递`N`给`pr_kernel`函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-30T03:00:25.490

当我在定义中使用不同的类型并作为内核的参数时，我遇到了类似的问题。后者需要更多资源的事实可能会产生错误。

# facebook - Facebook like 按钮的评论弹出窗口显示一半。

> ID：13223590
> 
> 赞同：2
> 
> 时间：2012-11-04T22:28:36.463
> 
> 标签：facebook, wordpress, facebook-likebox

我正在使用 Wordpress 的 21 个主题。

在其他主题中，没有问题，但在 21 中，Facebook 的点赞按钮的评论弹出窗口有问题。它显示了一半。当我点击“Like”按钮时，视图如下：

* * *

[http://i.stack.imgur.com/Hgawi.png](http://i.stack.imgur.com/Hgawi.png)

* * *

我为 Wordpress 使用 Facebook 插件。我该如何解决这个问题？

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T10:54:43.290

这是 21 中的一个错误（以及其他一些主题，可能是复制粘贴的）。打开你的 style.css 并寻找：

```
embed,
iframe,
object {
  max-width: 100%;
  width: 100%;
} 
```

如果您删除最大宽度线，它应该可以工作！也许有一个更优雅的解决方案，但老实说，我不知道为什么 iframe 的大小应该总是限制在它的容器中（在这种情况下是 FB 按钮）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-18T21:53:56.167

也许这是一个更好的方法！在您的 Facebook Like Button div 上放置一个类，在这种情况下，我使用了“fb-like”类。

```
.fb-like iframe,
.fb_iframe_widget iframe {
    max-width: none;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-29T15:51:34.060

寻找/测试很多解决方案，我发现一个隐藏评论窗口的解决方案（来源：[https](https://stackoverflow.com/a/12829375/3687838) ://stackoverflow.com/a/12829375/3687838 ）然后我写了一个显示窗口而不显示一半的解决方案。我不是程序员，但根据我调整 wordpress 插件的小经验，我想出了这个想法：

```
.fb-like {
    z-index: 200;
    position: absolute;
} 
```

将其复制/粘贴到您的自定义 CSS 主题文件中。如果您希望窗口位于所有内容之上，z-index 值甚至可以更改为 10000。如果要隐藏评论窗口，请使用上面链接中提供的解决方案，其值为 27px 而不是 20px。

# asp.net - 根据开始和结束日期将多行插入 SQL Server

> ID：13223599
> 
> 赞同：1
> 
> 时间：2012-11-04T22:29:39.283
> 
> 标签：asp.net, sql-server, tsql

我需要在基于文本框`Start Date`的SQL Server 数据库中插入几行。`End Date`

EG `tbStartDate.Text = "25/12/2012"`，`tbEndDate.Text = "29/12/2012"`因此我需要为以下日期插入单独的行：

```
25/12/2012
26/12/2012
27/12/2012
28/12/2012
29/12/2012 
```

请你能帮我用必要的 T-SQL 来实现这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T22:38:47.223

```
Declare @Startdate datetime
Select @Startdate='20121025'
While @Startdate<='20121029'
    begin
      if not exists(select * from dummy where DATE=@Startdate)
        insert into dummy (date) values (@Startdate)
        set @Startdate=@Startdate + 1
    end; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T22:55:58.630

一如既往，有几种方法。这里是其中的一些：

1.  您可以在应用程序中编写代码，循环遍历这些天并每天插入一条记录。（一般是最差的设计）

2.  您可以调用一些 SQL 脚本在数据库中完成所有操作。

3.  您可以将 SQL 脚本包装在存储过程中，并传入开始和结束日期，然后让存储过程为您执行此操作。

4.  您可以交叉连接到预先存在的计数表并使用它来生成记录。

如果你能提供

- 您正在使用的 SQL Server 版本

- 桌子长什么样

-无论您使用的是 C# 还是 VB

然后我们可以提供进一步的帮助，因为将日期传递到数据库中可能很困难。如果您不验证它们可能会特别困难。

无论如何，这是适合您的选项 3。

```
CREATE PROC dbo.t_test 
@StartDate DATETIME,
@EndDate DATETIME
AS

WHILE @StartDate <= @EndDate
BEGIN
    INSERT INTO YourTable(YourDateField) VALUES (@StartDate)
    SET @StartDate = DATEADD(d,1,@StartDate)
END 
```

然后，您需要从 ASP.Net 调用此存储过程（称为 dbo.t_test）并将两个日期参数作为日期传递。

# google-maps - 在 gmap3 插件中自动打开 onload 选定的 infoWindow

> ID：13223601
> 
> 赞同：1
> 
> 时间：2012-11-04T22:29:43.620
> 
> 标签：google-maps, jquery-gmap3

我尝试在加载地图的 gmap3 插件中打开选定的窗口（例如 infWin1 或 infWin2 或两者） - 而不是点击或悬停。

附上代码。

任何帮助，提示将不胜感激。

```
$('#googleMap')
    .gmap3(
    { 动作：'初始化'，
        选项：{
        中心：[49.651626,2.145664]，
        缩放：15
        }
    },

    {动作：'addMarkers'，
        标记：[
            {lat:49.628059, lng:2.117512, data:"some infoWin lbl"}, //infWin1
            {lat:49.59558, lng:2.121529, data:"some other infoWin lbl"} //infWin2
            ],
        标记：{
          选项：{
              可拖动：假
          },
          事件：{
              点击：功能（标记，事件，数据）{

              var map = $(this).gmap3('get'),
              infowindow = $(this).gmap3({action:'get', name:'infowindow'});
              如果（信息窗口）{
                  infowindow.setOptions({maxWidth:250});
                  infowindow.open（地图，标记）；
                  infowindow.setContent(数据);
              } 别的 {
                  $(this).gmap3({action:'addinfowindow', anchor:marker, options:{content: data,maxWidth:250}});

              }
              }
          }

          }
      }

      ,{动作：“自动调整”}

      );

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T08:43:43.020

将点击事件更改为鼠标悬停

```
marker:{
      options:{
          draggable: false
      },
      events:{
          mouseover: function(marker, event, data){

          var map = $(this).gmap3('get'),
          infowindow = $(this).gmap3({action:'get', name:'infowindow'});
          if (infowindow){
              infowindow.setOptions({maxWidth:250});
              infowindow.open(map, marker);
              infowindow.setContent(data);
          } else {
              $(this).gmap3({action:'addinfowindow', anchor:marker, options:{content: data,maxWidth:250}});

          }
      }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T07:26:04.943

所以，只需将其添加到请求的高级别，而不是事件中

*请注意，5.0 版本已于上周发布*

# c# - 错误地检查响应 c#

> ID：13223602
> 
> 赞同：0
> 
> 时间：2012-11-04T22:29:50.090
> 
> 标签：c#, if-statement, call, messagebox

我有一个从 POST 请求中获得响应的代码：

```
//Запрос авторизации бухаря
        WebRequest request = WebRequest.Create("http://clannr.org/scripts/login/auth.php");
        request.Method = "POST";
        string postData = "user=" + Login.Text + "&password=" + Password.Text + "&version=13";
        byte[] byteArray = Encoding.UTF8.GetBytes(postData);
        request.ContentType = "application/x-www-form-urlencoded";
        request.ContentLength = byteArray.Length;
        Stream dataStream = request.GetRequestStream();
        dataStream.Write(byteArray, 0, byteArray.Length);
        dataStream.Close();
        WebResponse response = request.GetResponse();
        Console.WriteLine(((HttpWebResponse)response).StatusDescription);
        dataStream = response.GetResponseStream();
        StreamReader reader = new StreamReader(dataStream);
        string responseFromServer = reader.ReadToEnd();
        reader.Close();
        dataStream.Close();
        response.Close(); 
```

但是在检查响应时：

```
 Match match = regex.Match(responseFromServer);

if (match.Success)
        {
            var input = responseFromServer;
            var split = input.Split(':');
            var final = split[3];
            ProcessStartInfo mcStartInfo = new ProcessStartInfo("javaw", "-Xms1024m -Xmx1024m -cp \"" + appData + "\\.ClanNR\\bin\\minecraft1.jar;" + appData + "\\.ClanNR\\bin\\jinput.jar;" + appData + "\\.ClanNR\\bin\\lwjgl.jar;" + appData + "\\.ClanNR\\bin\\lwjgl_util.jar \" -Djava.library.path=\"" + appData + "\\.ClanNR\\bin\\natives\" net.minecraft.client.Minecraft" + " " + username + " " + final + " " + server1);
            Process.Start(mcStartInfo);
            this.Close();

        }

        else if (responseFromServer == " Bad Login")
        {
            MessageBox.Show("Uncorrect login/password!");
        }
        else if (responseFromServer == " Old version")
        {
            MessageBox.Show("Launcher is old!");
        } 
```

我的代码只调用了 2 个函数，即 show 2 MessageBox

如何解决？

更新

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T22:33:31.577

因为如果，比如说，`responseFromServer`变量等于，`"Foo"`那么它同时满足这两个条件，因为它不等于`" Bad Login"`也不等于`" Old version"`

你可能想要的是`else if`：

```
 if (responseFromServer != " Bad Login")
    {
        MessageBox.Show("Uncorrect login/password!");
    }
    else if (responseFromServer != " Old version")
    {
        MessageBox.Show("Launcher is old!");
    } 
```

或者你可能想要`==`而不是`!=`

```
if (responseFromServer == " Bad Login") 
```

所以现在你的工作就是找出你真正想要实现的目标。

PS：两个字符串开头的空格是有意的吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T22:35:43.097

首先，`!=`运算符表示不相等。
如果我错了，请纠正我，但我认为你想使用`==`.

```
if (responseFromServer == " Bad Login")
{
    MessageBox.Show("Uncorrect login/password!");
}

else if (responseFromServer == " Old version")
{
    MessageBox.Show("Launcher is old!");
} 
```

其次，你应该使用 else if。如果第一个条件为真，那么它不会检查另一个。

# c++ - 一对向量而不是一个向量 ?

> ID：13223604
> 
> 赞同：3
> 
> 时间：2012-11-04T22:30:09.733
> 
> 标签：c++, search, dictionary, vector, std-pair

我正在寻找一个可以实现类似于 std::map 和 multimap 的库，但没有树，而是向量，比如`pair<vector<key>,vector<value>>`. 该库必须保持向量同步和排序。

我想比较地图`vector<pair<key,value>>`和这样的库的性能。我不会尝试做一个通用的基准测试，我只想要对我的应用程序更快的东西。

我可以像其他人一样使用地图，但是——我*不*知道我在说什么——我担心缓存未命中太多。我疯狂的、未受过教育的猜测是，我的应用程序只做很少的分组插入和许多分散的搜索，将受益于更紧凑和连续的键。

事实上，如果我要编写代码，我会用两个类来完成。一个未排序的版本，只允许快速的 push_back 插入，然后转换为排序的版本，该版本将采用未排序的版本，对其进行排序，可能检查重复性，然后允许快速搜索和较慢的排序插入。这实际上是 Scott Meyers 的 Effective STL 的第 23 条：“考虑用排序的向量替换关联容器”。

**编辑：正如关于**[flat_(multi)map/set](http://www.boost.org/doc/libs/1_52_0/doc/html/container/non_standard_containers.html#container.non_standard_containers.flat_xxx)的 Boost 文档所指出的，Matt Austern 而不是 Scott Meyers 首先建议用向量替换地图和集合：http: [//lafstern.org/matt/col1.pdf](http://lafstern.org/matt/col1.pdf)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T11:00:02.347

也许您正在寻找类似Boost.Container 中的[flat_(multi)map/set](http://www.boost.org/doc/libs/1_52_0/doc/html/container/non_standard_containers.html#container.non_standard_containers.flat_xxx)的东西？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T10:57:12.117

您应该查看[std::make_heap](http://www.cplusplus.com/reference/algorithm/make_heap/)和相关函数，它们将集合作为排序堆进行管理。它几乎完全符合您对快速、未排序插入和从已排序集合中快速检索的要求。

# haskell - 如何编写一个函数来修改一个 Char 列表并在 Haskell 中返回它？

> ID：13223605
> 
> 赞同：1
> 
> 时间：2012-11-04T22:30:15.107
> 
> 标签：haskell

修改很可能只是对 Char ascii 值加 3。我浏览了几本书，找不到现成的解决方案。（返回 Char 列表可以是不同的列表变量。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-04T22:33:08.910

```
import Data.Char
shiftAscii :: String -> String
shiftAscii xs = map (chr.(+3).ord) xs 
```

会做你问的。

它之所以有效，是因为`map`使用提供的函数编辑字符串中的每个字符。

`ord`将 the`Char`转换为其`Int`值
`(+3)`将 (ascii) 移动 3
`chr`转换回 a `Char`，

这`chr.(+3).ord`三个也是用函数组合串起来的`.`

* * *

为了更灵活，你可以写

```
shiftAsciiBy :: Int -> String -> String
shiftAsciiBy n = map (chr.(+ n).ord) 
```

请注意，移位 ascii 不尊重字母边界，因此如果您需要它来进行`rot13`编码或类似的简单移位，您最好使用仅编辑字母的手动移位功能

```
addAscii :: Int -> Char -> Char
addAscii n c | isUpper c = chr $ ((ord c - ord 'A' + n) `mod` 26) + ord 'A'
             | isLower c = chr $ ((ord c - ord 'a' + n) `mod` 26) + ord 'a'
             | otherwise = c 
```

例如

```
['A'..'z']
"ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz" 
```

我们只移动字母 ascii：

```
map (addAscii 5) ['A'..'z']
"FGHIJKLMNOPQRSTUVWXYZABCDE[\\]^_`fghijklmnopqrstuvwxyzabcde" 
```

# javascript - 在 TinyMCE 插入的标题上自动生成 id

> ID：13223611
> 
> 赞同：1
> 
> 时间：2012-11-04T22:31:32.470
> 
> 标签：javascript, ruby-on-rails, ruby, tinymce, nokogiri

TinyMCE 中的默认行为是这样创建标题：

```
<h1>My heading text!</h1> 
```

我们目前正在为使用 TinyMCE 的应用程序构建目录宏。我希望生成的标题包含一个随机 ID，以便我们可以轻松地从生成的目录链接到它们。

有没有一种我没有看到的方法来自定义 TinyMCE 如何为标题生成 HTML，以便我可以为每个标题包含一个 id？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T06:03:28.737

我最终决定使用 Nokogiri 来做这个服务器端。TinyMCE 生成的标题正在通过 xpath 查询进行迭代，我正在以这种方式设置它们的 id。

```
doc.xpath(%w(h1 h2 h3 h4 h6).map { |h| Nokogiri::CSS.xpath_for("body #{h}") }.join("|")).each do |node|
  node['id'] = to_anchor(node.content)
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T22:53:16.430

编辑：划掉我之前说的，看起来这就是你想要的：

```
tinyMCE.activeEditor.dom.addClass(tinyMCE.activeEditor.dom.select('h1'), 'myClass'); 
```

请原谅我对 tinyMCE 的不熟悉，我不确定您是否需要在调用它之前创建/选择一个“活动”编辑器（我会假设是这样），但我敢打赌你可以弄清楚那部分:)

# delphi - Delphi XE2 / XE3 & Windows 8 平板电脑 / 手机

> ID：13223612
> 
> 赞同：0
> 
> 时间：2012-11-04T22:31:37.023
> 
> 标签：delphi, windows-8, app-store, delphi-xe2, delphi-xe3

是否可以使用 Delphi XE2 或 XE3 为 Windows 8 平板电脑和手机开发应用程序？我认为 XE3 ust 支持 UI。我不确定我们是否可以使用 Delphi 为 Win8 平板电脑创建应用程序。我在某处读过我们需要将 Prism XE3 与 Visual Studio 一起使用。我不想仅仅因为这个而购买/升级到 XE3。我相信我们甚至可以使用 XE2 进行开发，但不确定。

另外，有谁知道微软是否接受用 Delphi 编写的 appstore 应用程序？

谢谢。

-K

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T22:46:06.610

[Embarcadero](http://www.embarcadero.com/delphi)上提供的 Delphi XE2 和 XE3 情况说明书清楚地提到了 IDE 支持哪些操作系统和 CPU，WinRT 和 ARM 不在列出的范围内。所以答案是“不”。

# c# - 看似 Catch-22 的重新：在非 ARM 设备上开发 ARM 解决方案

> ID：13223615
> 
> 赞同：2
> 
> 时间：2012-11-04T22:32:14.270
> 
> 标签：c#, visual-studio-2012, windows-runtime, arm, winrt-xaml

为了在设计器中查看我的 XAML 表单，我必须将调试平台设置为 x86（如果我将其设置为 ARM，我会在设计器中收到一条消息，即设置为 ARM 时无法显示 XAML 表单）。那么：我怎么知道我正在做的事情（例如使用某些功能或编程结构）实际上在 ARM 设备上不起作用？IOW，我想要我的蛋糕（可视化 XAML 表单）并吃掉它（让它在 ARM 上工作，即使我告诉 Visual Studio 将其视为 x86 项目）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T23:34:25.697

这就是为什么你应该选择`Any CPU`。

![在此处输入图像描述](../Images/6f37947009fcf0849f00a02bce723b7f.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T04:21:01.313

正如 Mayank 所说，将您的项目设置为针对任何 CPU。这将允许它在任何设备、英特尔或 ARM 上运行。不要担心做一些你不被允许做的事情。如果您留在 SDK 中，则保证您是安全的。如果您开始尝试破解系统，那么您将面临针对英特尔芯片的风险，但如果您这样做，您将无法获得商店认证:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-05T16:54:21.777

如果您不使用本机代码，任何 CPU 都应该可以工作。如果你是 - 好吧，那么你确实需要使用 x86 来使用设计器，但不用担心 - Blend 的布局与正在运行的应用程序不同，所以如果你想要像素完美的布局 - 你需要运行应用程序，无论如何都要截取屏幕截图并使用放大镜计算您的像素推动偏移量。

# objective-c - 如何在没有 NavigationController 的情况下显示新的 UIViewController

> ID：13223616
> 
> 赞同：0
> 
> 时间：2012-11-04T22:32:18.753
> 
> 标签：objective-c, ios

我有一个活动视图，根据用户的要求，我想从 NIB 加载不同的 viewController。
该 viewController 有一个`cancel`按钮，用户可以通过该按钮返回上一个视图。
我没有 UINavigationBar 来处理 segue，但我确实需要在需要时使用新的 ViewController。
我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:34:33.097

您可以使用`presentViewController:animated:completion:`来呈现新的`viewController`和`removeFromParentViewController`删除它。

# javascript - 作为参考的对象的新实例？

> ID：13223618
> 
> 赞同：0
> 
> 时间：2012-11-04T22:32:22.980
> 
> 标签：javascript, object, reference, prototype, instance

我在创建对象的新实例时遇到问题。

使用下面的代码，我期望每个元素都有自己的随机值（正在发生）。

但是后来我也期望该`this.element`值包含在对象的每个实例中，但是每次在对象的任何实例中更改值时，它都会在所有实例中更新。

```
var Instance = function(element) {
    this.$element = $(element);
    this.subInstance.parent = this;
}

Instance.prototype = {

    subInstance: {

        parent: null,
        $element: null,

        init: function() {
            var $this = this;
            this.$element = this.parent.$element;

            //test for what this.$element refers to in init function
            var random = Math.random();
            $('.element', this.$element).text('Updated ' + random);

            //test for what this.$element refers to in an event handler
            $('.element', this.$element).on('click', function(e) {
                $this.$element.css('background-color', '#f00');
            });
        }
    }
}
$('div.instance').each(function(i, o) {
    var instance = new Instance(o);
    instance.subInstance.init();
});​ 
```

现在我知道我可以将 subInstance 移出原型并使用构造函数，`this.subInstance = {...`但这似乎是错误的，为什么`this.$element`不包含在对象的每个实例中？

两个示例的 JSFiddle：http: [//jsfiddle.net/q7zAg/](http://jsfiddle.net/q7zAg/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:37:57.300

这似乎是错误的，但事实并非如此。如果从构造函数创建的每个对象都需要使用唯一的`subInstance`，则您需要为每个单独的实例创建一个新对象。在`prototype`它将被共享。

*但是*，您可以做的一件事是使用`Object.create`创建一个从原型继承的新实例`subInstance`。然后你得到一些重用的好处，每个实例都可以修改它自己的对象。

```
var Instance = function(element) {
    this.$element = $(element);
    this.subInstance = Object.create(this.subInstance);
    this.subInstance.parent = this;
} 
```

现在有些人可能会争辩说，`subInstance`仍然不应该在 上`prototype`，而应该是 IIFE 中的局部变量。我倾向于同意这一点。

这是一个例子：

```
var Instance = (function() {
    var _subInstance = {
        parent: null,
        $element: null,
        init: function() {
            // ...
        }
    };

    var Instance = function(element) {
        this.$element = $(element);
        this.subInstance = Object.create(_subInstance);
        this.subInstance.parent = this;
    };

       // other prototyped props
    Instance.prototype.foo = "bar";

    return Instance;
})(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T07:30:03.843

```
var Obj = 
{
    internal:null,

    __init:function(data){
        this.internal = data;
        return this
    },
    get:function(){
        return this.internal;
    },
    init:function(){
        var args = arguments,instance = function(){
             return this.__init.apply(this,args);
        };
        instance.prototype = this;
        return new instance();
    }
}

console.log(Obj.init(123).get());
console.log(Obj.get());
console.log(Obj.init(321).get());
console.log(Obj.get()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T23:29:06.100

请注意，函数的`this`设置取决于函数的调用方式，而不是它的声明或初始化方式（使用*bind*除外）。

在您的代码中，您有：

```
> Instance.prototype = {
>     subInstance: { 
```

它将对象分配给`Instance.prototype`具有`subInstance`Object 属性的对象。

然后是：

```
>         init: function() {
>             var $this = this;
>             this.$element = this.parent.$element; 
```

该方法被称为：

```
> instance.subInstance.init(); 
```

所以`this`在`init`方法内总是引用同一个对象（即`Instance.prototype.subInstance`），所以赋值要`this.$element`不断替换值。

# java - 自定义控件内的 Android 微调器 - OnItemSelectedListener 不会触发

> ID：13223620
> 
> 赞同：1
> 
> 时间：2012-11-04T22:32:27.673
> 
> 标签：java, android, android-layout

我正在编写一个扩展 LinearLayout 的自定义控件。在该控件中，我使用微调器让用户从列表中选择一个项目。我遇到的问题是 OnItemSelectedListener 事件没有触发。将相同的代码移动到 Activity/Fragment 时，一切正常。

我遵循了一些其他人询问相同问题的答案，但没有任何帮助。事件仍然没有触发。

这是我遵循建议将微调器放在我的布局 XML 中而不是通过代码的答案之后的代码。当我尝试“new Spinner(ctx)”时，我得到了相同的结果......

布局 XML：

```
 <Spinner
    android:id="@+id/accSpinner"        
    android:layout_width="0dip"
    android:layout_height="0dip" /> 
```

控件的初始化函数（在控件构造函数上调用）：

```
private void init()
{
    LayoutInflater layoutInflater = LayoutInflater.from(mContext);
    mAccountBoxView = layoutInflater.inflate(R.layout.control_accountselector, null);

    mTxtAccount = (TextView)mAccountBoxView.findViewById(R.id.txtAccount);
    mSpinner = (Spinner)mAccountBoxView.findViewById(R.id.accSpinner);

    mAccountBoxView.setOnClickListener(new OnClickListener()
        {
            @Override
            public void onClick(View v)
            {
                mSpinner.performClick();
            }
        });

    setSpinner();
    addView(mAccountBoxView);
}

private void setSpinner()
{       
    ArrayAdapter<String> dataAdapter = new ArrayAdapter<String>(mContext, android.R.layout.simple_spinner_item, mItems);
    dataAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);             
    mSpinner.setAdapter(dataAdapter);

    mSpinner.setOnItemSelectedListener(new OnItemSelectedListener()
        {
            @Override
            public void onItemSelected(AdapterView<?> parent, View view, int position, long id)
            {
                String selectedItem = mItems.get(position);
                handleSelectedItem(selectedItem);
            }

            @Override
            public void onNothingSelected(AdapterView<?> parent)
            {

            }
        });     
} 
```

当我触摸我的控件时，微调器会很好地升起，并且项目列表应该在那里。当我单击一个项目时，微调器会关闭，但我永远不会到达 onItemSelected 或 onNothingSelected..

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:57:49.907

找到了答案！

我已经用一个空的项目数组列表初始化了微调器适配器。然后使用此公共函数添加实际项目：

```
public void addItem(String item)
{
    mItems.add(item);       
} 
```

我已将功能更改为：

```
public void addItem(String item)
{
    mItems.add(item);
    mDataAdapter.notifyDataSetChanged();
} 
```

现在适配器知道了新项目并触发了事件。

当我将代码移动到一个活动时，没有什么可以从外部调用它，所以在我设置适配器之前这些项目就在数组中，这就是它在那里工作的原因。

# c - 使用线程时 printf 无法正常工作

> ID：13223621
> 
> 赞同：1
> 
> 时间：2012-11-04T22:32:27.687
> 
> 标签：c, multithreading, posix

嗨，使用线程时 printf 有一点问题。问题是终端稍后打印一个 printf 语句，应该更早打印。这是我面临这个问题的部分。

```
.
.
.
        while(1){

        printf("waiting for a connection\n");

        csock = (int*)malloc(sizeof(int));

        if((*csock = accept( hsock, (struct sockaddr*)&sadr, &addr_size))!= -1){
            printf("---------------------\nReceived connection from %s\n",inet_ntoa(sadr.sin_addr));
            client_counter++;
            pthread_create(&thread_id,0,&SocketHandler, (void*)csock );
        }

        else{
            fprintf(stderr, "Error accepting %d\n", errno);
        }
        }// end while
.
.
. 
```

这是线程使用的功能。

```
void* SocketHandler(void* lp){

    int *csock = (int*)lp;
    char buffer[1024];
    int buffer_len = 1024;
    int bytecount;
    char* str_exit="exit";

        while(1){

            memset(buffer, 0, buffer_len);

            if((bytecount = recv(*csock, buffer, buffer_len, 0))== -1){
            fprintf(stderr, "Error receiving data %d\n", errno);
            exit(0);
            }

            if(strcmp(buffer,str_exit)==0){
                break;
            }

            printf("Received bytes %d\nReceived string \"%s\"\n", bytecount, buffer);
            strcat(buffer, " SERVER ECHO");

            if((bytecount = send(*csock, buffer, strlen(buffer), 0))== -1){
            fprintf(stderr, "Error sending data %d\n", errno);
            exit(0);
            }

                //printf("Sent bytes %d Sent String %s\n", bytecount,buffer);
        }

    printf("Client disconnected\n");
    free(csock);
    return 0;
} 
```

每当客户端（线程）连接到服务器时，输出都是这样的。

```
waiting for a connection
---------------------
Received connection from 127.0.0.1
waiting for a connection
Client disconnected
---------------------
Received connection from 127.0.0.1
waiting for a connection
Client disconnected 
```

当第一个客户端连接时，输出正常工作，但是当第二个客户端连接时，字符串`"waiting for a connection"`在`"Received connection"`. 那么它应该以对比的方式工作。如果你能提供帮助，我会很高兴，无论如何，谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T22:49:04.937

没有问题。除了第一次进入循环外，“等待连接”将是客户端连接后接受线程打印的最后一件事。

换句话说，这个循环在 accept() 调用处开始/结束，除非是第一次进入。这是“异常”的第一次，而不是随后的循环。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T22:36:31.253

```
setbuf(stdout,NULL);
setbuf(stderr,NULL); 
```

**关闭输出缓冲**。printf**不是可重入的**，因此它使用全局锁进行同步。当输出被缓冲时，一个线程可能不会在另一个线程开始打印之前释放它的锁。

多线程时，始终建议**[关闭输出缓冲](https://stackoverflow.com/questions/4220911/why-to-turn-off-the-standard-output-buffer-when-multithreading)**或手动调用[`fflush()`](http://linux.die.net/man/3/fflush)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T22:59:22.340

没有问题（或者至少你所描述的不是问题）。这是一些带注释的输出：

```
waiting for a connection             # 1
---------------------                # 1
Received connection from 127.0.0.1   # 1
waiting for a connection             #   2
Client disconnected                  #        thread handling connection 1
---------------------                #   2
Received connection from 127.0.0.1   #   2
waiting for a connection             #     3
Client disconnected                  #        thread handling connection 2 
```

如果你稍微改变你的 while 循环，输出将变成自我记录：

```
int i = 0;
while(1) {

    printf("%d: waiting for a connection\n", i);

    csock = (int*)malloc(sizeof(int));

    if((*csock = accept( hsock, (struct sockaddr*)&sadr, &addr_size))!= -1) {
        printf("%d: ---------------------\n%d: Received connection from %s\n", 
            i, i, inet_ntoa(sadr.sin_addr));
        client_counter++;
        pthread_create(&thread_id,0,&SocketHandler, (void*)csock );
    }

    else{
        fprintf(stderr, "%d: Error accepting %d\n", i, errno);
    }

    ++i;
}// end while 
```

您可能希望为您的线程添加一个类似的 ID 以打印出来 - 例如，不要传入一个`int`表示套接字的单个 ID，而是传入一个包含套接字和`client_counter`（或 `i 或更有用的）值的小结构创建线程的时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T22:36:56.630

如果您混合使用 stderr 和 stdout，除非您在每次使用后刷新，否则您不能期望正确排序。多线程会使事情变得更加复杂（刷新是不够的），所以我认为你应该选择一个流（stdout 或 stderr）并坚持下去。

# python - sqlselect() 最多接受 2 个参数（给定 3 个）谎言

> ID：13223625
> 
> 赞同：1
> 
> 时间：2012-11-04T22:32:48.840
> 
> 标签：python, sqlalchemy

我没有看到第三个论点。当我运行这个命令时：

```
used_emails = [row.email for row
    in db.execute(halo4.select([halo4.c.email],[halo4.c.email!='']))] 
```

它说：

TypeError: select() 最多接受 2 个参数（给定 3 个）

第三个论点在哪里？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T22:35:23.683

Python 中的方法*至少*接受自动参数`self`，因此该方法可能类似于：

```
def select(self, someargument):
    # ... 
```

Python 会处理这个`self`参数，然后还有一个参数需要你传入。当你传入*两个*参数时，你最终会得到 3 个参数，这太多了。

# java - SurfaceView 运行方法代码

> ID：13223626
> 
> 赞同：1
> 
> 时间：2012-11-04T22:32:58.427
> 
> 标签：java, android, algorithm

我正在尝试绘制一个 10x10 的交替颜色网格。在我的 run() 方法中，我有这个

```
 int xinc = this.getWidth() / 10;
int yinc = this.getHeight() / 10;
Log.d("xinc - ", String.valueOf(xinc));
Log.d("yinc - ", String.valueOf(yinc));
int x1 = 0;
int y1 = 0;
int x2 = xinc;
int y2 = yinc;
boolean red = true;

for (int xx = 0; xx < 10; xx++) {

    for (int yy = 0; yy < 10; yy++) {

        if (red) {
            myPaint.setColor(Color.RED);
            red = false;
        } else {
            myPaint.setColor(Color.GREEN);
            red = true;
        }
        c.drawRect(x1, y1, x2, y2, myPaint);
        y1 += yinc;
        y2 += yinc;

    }
    x1 += xinc;
    x2 += xinc;
}

holder.unlockCanvasAndPost(c); 
```

我得到了第一行垂直替代框，但仅此而已。屏幕的其余部分保持白色。就好像 x1 和 x2 变量没有增加一样，所以外部循环没有影响。但是我已经确认它们是通过对这些变量使用 logcat 来确认的，它们会按预期增加。谁能看到这里有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T22:42:05.333

您忘记重置 y1 和 y2！我认为一个简单的 `y1 = 0; y2 = yinc;`

前

`x1 += xinc; x2 += xinc;`

应该这样做。

# c# - 如何将 DllGetClassObject 编写为 C# 委托？

> ID：13223629
> 
> 赞同：1
> 
> 时间：2012-11-04T22:33:10.513
> 
> 标签：c#, delphi, pinvoke

有一个用delphi写的dll导出方法： DllGetClassObject: function(const CLSID, IID: TGUID; var Obj): HResult; 标准调用；

我需要在 c# 中编写等效方法作为委托。它应该是什么样子？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T07:30:19.303

像这样：

```
[UnmanagedFunctionPointer(CallingConvention.StdCall)]
public delegate uint DllGetClassObjectDelegate(
    [MarshalAs(UnmanagedType.LPStruct)]
    Guid rclsid,
    [MarshalAs(UnmanagedType.LPStruct)]
    Guid riid,
    [MarshalAs(UnmanagedType.IUnknown, IidParameterIndex=1)]
    out object ppv
); 
```

来源：[http ://blog.kutulu.org/2012/01/com-interop-part-9-custom-activations.html?m=1](http://blog.kutulu.org/2012/01/com-interop-part-9-custom-activations.html?m=1)

# c++ - 直接调用类运算符

> ID：13223631
> 
> 赞同：1
> 
> 时间：2012-11-04T22:33:21.673
> 
> 标签：c++, c++builder, c++builder-xe2

我想问你为什么在这种情况下我需要直接调用类运算符：

```
void __fastcall TForm2::statusDrawPanel(TStatusBar *StatusBar, TStatusPanel *Panel,
                                        const TRect &Rect)
{
  //if (Panel == StatusBar->Panels[1]) This doesn't work for me, compiler throws E2096 Illegal structure operation
    if (Panel == StatusBar->Panels->operator [](1)) // but this is working
    {
      int i  = 0;
    }
} 
```

我正在使用 Borland 的 C++ Builder XE2。我也想问一下，什么情况下需要直接调用类操作员。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T22:39:16.560

`Panels`显然是一个指针，当您`[]`在指针上使用时，它会将其视为指向数组的指针，并尝试将偏移量添加到指针以获取`Panels`给定偏移量处的对象，这不是您想要的。

您需要取消引用指针，或者使用`Panels->operator[](1)`或`(*StatusBar->Panels)[1]`获取对象并调用`operator[]`它，这可能是您想要的行为。

# ios5 - 重绘 UINavigationBar 以反映标题文本颜色的变化

> ID：13223632
> 
> 赞同：3
> 
> 时间：2012-11-04T22:33:21.960
> 
> 标签：ios5, uikit, uinavigationbar

我正在尝试使用 UINavigationBar 标题文本颜色作为向用户指示我的应用程序是否与外部附件连接的指示，例如红色表示断开连接，绿色表示连接。

更新 UINavigationBar 以具有正确的标题文本颜色没有问题，当连接状态发生变化时，通过使用 setTitleTextAttributes 方法然后调用 [self.navigationBar setNeedsDisplay]。但是，这种变化不会立即反映出来。

我还使用 [[UINavigationBar appearance] setTitleTextAttributes:... ] 以便将来创建的任何新 UINavigationBars 都将具有正确的值。如果我导航到新视图，导航栏标题是正确的颜色。

如何使用更新的标题颜色强制 UINavigationBar 立即重绘？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T22:59:07.737

我想我刚刚遇到了同样的问题。这是解决此问题的更简单方法。假设这`UINavigationBar`是标准`UINavigationController`栏，您只需要重新分配正在显示的文本。那是你的控制器的`title`财产。诀窍是，您需要更改其值才能使其正常工作。

```
self.navigationController.navigationBar.titleTextAttributes = @{...}

self.title = nil;
self.title = @"##Actual Title##"; 
```

# django - 覆盖现有的 Django 模板标签

> ID：13223633
> 
> 赞同：17
> 
> 时间：2012-11-04T22:33:28.113
> 
> 标签：django, django-templates

是否可以覆盖现有的 Django 模板标签，或者是否需要自定义模板文件并创建新的模板标签？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-11-15T20:15:32.167

我一直在寻找相同的答案，所以想在这里分享我的解决方案。我想覆盖 django 中的默认 url 模板标签，而不必使用自定义模板标签并将其加载到每个模板文件中。

目标是用 +（加号）替换 %20（空格）。这就是我想出的...

在 `__init__.py`

```
from django.template.defaulttags import URLNode

old_render = URLNode.render
def new_render(cls, context):
  """ Override existing url method to use pluses instead of spaces
  """
  return old_render(cls, context).replace("%20", "+")
URLNode.render = new_render 
```

这个页面很有用[https://github.com/django/django/blob/master/django/template/defaulttags.py](https://github.com/django/django/blob/master/django/template/defaulttags.py)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-10-08T14:54:19.777

我假设“现有的 Django 模板标签”是指不同应用程序中的标签。

创建一个`templatetags/tagfile.py`注册同名标签的。确保它`tagfile`与模板加载`{% load tagfile %}`用于获取原始标签的名称相同。

此外，请确保您的应用列在`INSTALLED_APPS`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-05T09:43:31.457

是的。

由于 django 基本上是一个 python 库（与 python 中的所有内容一样），您可以覆盖任何您想要的内容。

目前尚不清楚您到底想做什么，但滚动您自己的模板标签确实很容易，文档非常清楚： [https ://docs.djangoproject.com/en/dev/howto/custom-template -tags/#writing-custom-template-tags](https://docs.djangoproject.com/en/dev/howto/custom-template-tags/#writing-custom-template-tags)

这是疯狂的基础，但这是我用来开始构建自定义模板标签的模板：

myapp/templatetags/my_custom_tags.py（必须`__init__.py`在这个目录下）

```
from django import template
register = template.Library()

class CustomTag(template.Node):
    def render(self, context):
        context['my_custom_tag_context'] = "this is my custom tag, yeah"
        return ''

@register.tag(name='get_custom_tag')
def get_custom_tag(parser, token):
    return CustomTag() 
```

您的模板中的用法如下所示：

```
{% load my_custom_tags %}
{% get_custom_tag %}
{{my_custom_tag_context}} 
```

您可能想要解析`token`，并且您可能想要在课堂上使用某种东西`__init__`，但它确实表明它是多么基本。

* * *

您可以浏览现有的“默认”模板标签，将它们复制并修改为您喜欢的内容。

那里确实有一些很棒的东西： [https ://github.com/django/django/blob/master/django/template/defaulttags.py](https://github.com/django/django/blob/master/django/template/defaulttags.py)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-04-09T16:25:29.240

我很确定您要求完全覆盖 django `templatetag`。

简短的回答是 -`Yes`您可以覆盖现有的`templatetag`.

以下是如何实现它：

*   您必须将模板目录包含在`settings`：

```
 TEMPLATES = [
        {
            'BACKEND': 'django.template.backends.django.DjangoTemplates',
            'DIRS': [os.path.join(BASE_DIR, 'your_app/templates')],
            'APP_DIRS': True,
            'OPTIONS': {
                'context_processors': [
                    'django.template.context_processors.debug',
                    'django.template.context_processors.request',
                    'django.contrib.auth.context_processors.auth',
                    'django.contrib.messages.context_processors.messages',
                    'django.template.context_processors.static',
                ],
            },
        },
    ] 
```

*   您必须在以下内容中包含要覆盖的应用`templatetag`程序 `INSTALLED_APPS`：

```
INSTALLED_APPS = [
        'django.contrib.admin',
        'django.contrib.auth',
        'django.contrib.contenttypes',
        'django.contrib.sessions',
        'django.contrib.messages',
        'django.contrib.staticfiles',
        'your_app_name',
        ...
    ] 
```

### 重要的是在 django 的应用程序之后拥有您的应用程序！

这是由于 django 的工作方式。我们将获得使用权。

*   现在，在您的应用程序中创建一个文件夹，命名为`templatetags`. `__init__.py`里面有文件很重要`templatetags`，所以django可以理解它是一个python包！：

`your_app_name/templatetags/__init__.py`.

*   创建`templatetag`要覆盖的。在那个例子中，我将使用`admin_list.py`标签。

在这种情况下，它应该像这样放置：

`your_app_name/templatetags/admin_list.py`

*   现在复制`admin_list.py` （非常重要！）的全部内容`django.contrib.admin.templatetags.admin_list.py`并修改您想要的任何内容。

重要的是拥有 django 管理员的全部内容，`admin_list.py`而不仅仅是一段代码，否则它将无法工作！

* * *

工作原理：Django 在您的应用程序中查找`templatetags`文件夹并使用其中的模板标签。它将您`admin's`的模板标签放在标签之后，简而言之 - 它会覆盖它们，因为它们`django.admin`放在`INSTALLED_APPS`.

不要忘记：

*   `./manage.py collectstatic`
*   放`DEBUG = False`

在生产中。

我已经测试过它的`result_list(cl)`功能覆盖，它正在工作。

* * *

此解决方案在没有自定义 html 模板文件的情况下有效。

希望有帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-01-25T15:39:49.213

如果您不想依赖 settings.py 中应用程序的顺序`INSTALLED_APPS`，则可以尝试以下操作：

像往常一样创建模板标签函数/类。假设您要覆盖`otherapp_tags.current_time`从名为`other_app`. 首先，创建您自己的该函数/类的版本：

```
def my_current_time(format_string):
    return datetime.datetime.now().strftime(format_string) 
```

然后，不要在您的应用程序命名空间中注册此函数/类，而是从另一个应用程序修补现有函数：

```
from other_app.templatetags import otherapp_tags

otherapp_tags.register.tags['current_time'] = my_current_time 
```

通常，您应该在`AppConfig`'s`ready()`方法中执行此操作。

# path - 完美水平路径的 SVG 渐变

> ID：13223636
> 
> 赞同：14
> 
> 时间：2012-11-04T22:33:38.753
> 
> 标签：path, svg, gradient

我正在使用 svg 绘制折线图，​​并且需要对其应用渐变。对于每一行，我使用一个路径元素并将笔画设置为我的线性渐变元素之一。

这适用于除纯水平线之外的所有内容 - 在这种情况下，我的线上根本没有颜色。

我做了一个小提琴来显示问题：http: [//jsfiddle.net/b6EQT/](http://jsfiddle.net/b6EQT/)

```
<svg>
    <defs>
        <linearGradient id="grad" x1="0%" x2="100%" y1="0%" y2="0%">
            <stop class="" offset="0%" style="stop-color: red;"></stop>
            <stop class="" offset="33%" style="stop-color: yellow;"></stop>
            <stop class="" offset="66%" style="stop-color: pink;"></stop>
            <stop class="" offset="100%" style="stop-color: blue"></stop>
        </linearGradient>
    </defs>
<-- Gradient not applied -->
<path stroke="url(#grad)" d="M20,20L400,20" style="stroke-width: 10px;"></path>

<-- Gradient applied since height of 1px -->
<path stroke="url(#grad)" d="M20,40L400,41" style="stroke-width: 10px;"></path>

<-- Gradient applied because of fake initial "move to" -->
<path stroke="url(#grad)" d="M-1,-1,M20,60L400,60" style="stroke-width: 10px;"></path>
</svg>​ 
```

没有出现纯水平线（第一条路径），而第二条（y 的轻微变化）出现了。

我尝试了一些小技巧来启动它 - 在开始时放置一个假的 M-1,-1，这似乎可以解决 IE 和 Chrome 中的问题，但不能解决 Firefox。这让我觉得我在理解 SVG 渐变和路径时遗漏了一些东西。有没有办法让它工作？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-04T22:52:29.353

[gradientUnits](http://www.w3.org/TR/SVG/pservers.html#LinearGradients)的默认值是 objectBoundingBox。您遇到的关键问题在[规范文本](http://www.w3.org/TR/SVG/coords.html#ObjectBoundingBox)的最后一段中进行了描述......

> 当适用元素的几何形状没有宽度或没有高度时（例如水平或垂直线的情况），即使当由于具有非零笔划宽度而查看时线条具有实际厚度时，也不应使用关键字 objectBoundingBox边界框计算忽略笔画宽度。当适用元素的几何形状没有宽度或高度并且指定了 objectBoundingBox 时，将忽略给定的效果（例如，渐变或过滤器）。

如果你有一条水平线，为什么不使用带有填充的矩形而不是带有笔划的路径？或者使用 userSpaceOnUse 单位。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-01-29T09:51:16.533

**gradientUnits="userSpaceOnUse"**可以修复它。

# [演示](http://jsfiddle.net/yv92f9k2/)

```
<linearGradient 
    id="grad" x1="0%" x2="100%" y1="0%" y2="0%" 
    gradientUnits="userSpaceOnUse">
    <stop class="" offset="0%" style="stop-color: red;"></stop>
    <stop class="" offset="33%" style="stop-color: yellow;"></stop>
    <stop class="" offset="66%" style="stop-color: pink;"></stop>
    <stop class="" offset="100%" style="stop-color: blue"></stop>
</linearGradient> 
```

# [更详细的回答](https://stackoverflow.com/a/21639059/2179748)

# c# - MessageWebSocket 用来连接的 URI 可以是 IP 地址，对吗？

> ID：13223637
> 
> 赞同：1
> 
> 时间：2012-11-04T22:33:47.263
> 
> 标签：c#, sockets, windows-8, websocket

[我在http://msdn.microsoft.com/en-us/library/windows/apps/xaml/Hh994397(v=win.10).aspx](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/Hh994397(v=win.10).aspx)看到这条线：

```
Uri server = new Uri(ServerAddressField.Text.Trim());
...
await webSocket.ConnectAsync(server); 
```

我希望传递给 URI 构造函数的字符串可以是 IP 地址；是这样吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T23:04:44.193

该类应接受传递给它的任何有效的统一资源标识符[`Uri`。](http://msdn.microsoft.com/en-us/library/system.uri.aspx)

因此，例如，如果您的端点没有 DNS 记录并且您需要通过 IP 地址指定，那么使用 IP 地址代替域名应该没问题。

```
//By Name
var namedUri = Uri("http://websocketserver/myendpoint");
//By IP address
var addressUri = new Uri("http://127.0.0.1/myendpoint"); 
```

# c - 使用共享库时的函数原型

> ID：13223646
> 
> 赞同：0
> 
> 时间：2012-11-04T22:34:49.220
> 
> 标签：c, gcc, linker, shared-libraries, x86-64

我不确定用来描述这个问题的正确术语，但我会尽力而为。

我正在编写一个玩具程序，在 test.c 中打印 12 和 13 的阶乘：

```
#include <stdio.h>

int main(void)
{
    printf("%ld\n", factorial(12));
    printf("%ld\n", factorial(13));
    return 0;
} 
```

阶乘函数在与 source fact.c 的共享库中定义

```
long factorial(int n)
{
    long r = 1;
    while (n > 1) r *= n--;
    return r;
} 
```

我正在使用以下命令编译共享库和我的程序：

```
$ gcc -shared -fPIC -o libfact.so fact.c
$ gcc -L. -lfact test.c 
```

我在 x86-64 上，所以我希望`factorial(13)`(13! = 6227020800) 不会溢出 64 位长度。但是，我得到了一个奇怪的结果。

```
$ LD_LIBRARY_PATH=. ./a.out
479001600
1932053504 
```

这里，1932053504 恰好是正确结果的低 32 位的十进制值。但是，如果我`long factorial(int)`在 test.c 的顶部插入函数原型并重新编译，我会得到正确的结果。

```
$ LD_LIBRARY_PATH=. ./a.out
479001600
6227020800 
```

这给我留下了几个问题：

1.  如果我没有在 test.c 中指定原型，假定的返回类型是什么？这个编译器依赖吗？
2.  如果没有原型，我似乎可以将任意数量的参数传递给`factorial`. 这与[关于 C void arguments](https://stackoverflow.com/questions/693788/c-void-arguments)的问题和[关于函数原型](https://stackoverflow.com/questions/946765/are-there-any-benefits-to-not-using-function-prototypes-in-c)的问题有关吗？
3.  为什么链接器不抛出未定义的引用错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T07:35:45.287

从 C 标准的 1990 版本开始，如果您调用没有可见声明的函数，编译器会假定它返回 type `int`。`factorial()`因此，对于主程序中的调用，编译器很可能会将`long`它返回的值*解释*为一个`int`值。如果`long`并且`int`碰巧具有相同的表示，这可能会起作用。如果`long`比 宽`int`，它*可能会*发生工作，也可能会失败。但无论哪种方式，行为都是未定义的。

1999 版的 C 标准 (C99) 删除了“隐式 int”规则。调用没有可见声明的函数是*违反约束*的，需要编译器诊断。然后编译器可能会拒绝该程序，或者继续编译它——但如果是这样，则行为是未定义的。

要纠正这个问题，您需要在调用它`factorial()` *之前有一个可见的声明。*最好的方法是创建一个头文件，`factorial.h`：

**阶乘.h：**

```
#ifndef FACTORIAL_H
#define FACTORIAL_H

long factorial(int n);

#endif 
```

**阶乘.c：**

```
#include <stdio.h>
#include "factorial.h"

long factorial(int n)
{
    printf("factorial(%d)", n);
    long r = 1;
    while (n > 1) r *= n--;
    printf(" --> %ld\n", r);
    return r;
} 
```

**主.c：**

```
#include <stdio.h>
#include "factorial.h"

int main(void)
{
    printf("%ld\n", factorial(12));
    printf("%ld\n", factorial(13));
    return 0;
} 
```

请注意，如果只有 32 位，这*仍然*不起作用，因为 13 阶乘超过 2 ^(31) -1。检查系统的值和/或：`long`^(`LONG_MAX``sizeof (long)`)

```
printf("LONG_MAX = %ld, sizeof (long) = %d\n", LONG_MAX, (int)sizeof (long)); 
```

考虑使用`long long`而不是`long`- 或，更好的是，`int64_t`或`uint64_t`，在`<stdint.h>`.

（据我所知，您对共享库的使用不会影响这一切。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T22:38:33.613

*   如果函数返回类型未知，则编译器认为它是`int`. 在这种情况下发生的转换解释了`printf`语句的有线输出。无论如何，更喜欢使用标准`long long int`中`long int`定义的 , 来处理最大值最小值`2^31 - 1`

§5.2.4.2.1

> — long int 类型对象的最大值
> 
> LONG_MAX +2147483647 // 2^31− 1

*   链接器不会抛出任何未定义的引用错误，因为如果函数确实存在，它不会检查动态库。它绑定它，并在执行时尝试加载它。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-04T22:42:05.950

`long`在 64 位架构上不必是 8 字节，标准要求它不少于 4 字节。你有一个溢出。

# javascript - 如何调用位于单独文件中的 javascript？

> ID：13223650
> 
> 赞同：1
> 
> 时间：2012-11-04T22:35:17.507
> 
> 标签：javascript, visual-studio-2010, visual-web-developer-2010

我有一个 .js 文件：

```
function date() 
{
    document.getElementById("id1").innerHTML = Date();
} 
```

还有一个页面：

```
<p id="id1"></p>
<button type="button" onclick="date()">Click here</button> 
```

但是点击它并没有做任何事情。少了什么东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T22:36:47.047

只需添加

`<script type='text/javascript' src="path_to_js_file"></script>`

在您的 html 页面顶部

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T22:52:17.340

我在这里发现了一个问题：

首先，您需要创建一个 Date 对象，如下所示：

```
var d = new Date(); 
```

然后使用`getDate()`, `getMonth()`, 等等...

```
var full = d.getMonth + 1; // getMonth returns 0 - 11
full += "/" + d.getDate;
full += "/" + d.getFullYear;
document.getElementById("id1").innerHtml = full; 
```

另外，不要忘记包含`<script src="script.js"></script>`在您的脑海中。

# c - C fread没有得到整个文件

> ID：13223666
> 
> 赞同：2
> 
> 时间：2012-11-04T22:37:35.217
> 
> 标签：c, fread

我正在尝试读取二进制文件并将内容存储到 char 数组中。此功能非常适用于文本文件，但对于非文本文件（例如 PNG 文件）则无法按预期工作。下面是代码和结果。怎么了？

代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <sys/stat.h>
#include <fcntl.h>

unsigned int readFile(const char *fileName, char **contents);

int main(int argc, char *argv[])
{
    char *contents = 0;
    unsigned int length = readFile(argv[1], &contents);

    fprintf(stderr, "File length: %d\r\n", length);
    fprintf(stderr, "File contents:\r\n%s\r\n", contents);

    exit(0);
}

unsigned int readFile(const char *fileName, char **contents)
{
    struct stat stbuf;
    unsigned int length = 0;

    // Open a file descriptor
    int fd = open(fileName, O_RDONLY);

    // Check that file descriptor was opened
    if (fd == -1) {
        fprintf(stderr, "Fatal Error: Failed to open the file for fstat (file: %s)!\r\n", fileName);
        exit(-1);
    }

    // Get information from fstat
    if (fstat(fd, &stbuf) == -1) {
        fprintf(stderr, "Fatal Error: Failed to find file length (file: %s)!\r\n", fileName);
        exit(-1);
    }

    // Store the file length
    length = stbuf.st_size;

    // Close file descriptor
    if (close(fd) == -1) {
        fprintf(stderr, "Fatal Error: Failed to close file descriptor (file: %s)!\r\n", fileName);
        exit(-1);
    }

    // Check if the file contains data
    if (length > 0) {
        // Open the file for reading
        FILE *file = fopen(fileName, "rb");

        // Check that the file was opened
        if (file != NULL) {
            freopen(fileName, "rb", file);
            // Prepare the contents variable
            *contents = 0;
            *contents = (char*)calloc(length + 1, sizeof(char));

            // Read the file and put it in the contents variable
            int lengthRead = fread(*contents, length, 1, file);

            // Check for file read error
            if (ferror(file)) {
                fprintf(stderr, "Fatal Error: Failed to read file (file: %s)!\r\n", fileName);
                exit(-1);
            }
            else if (lengthRead != 1 || strlen(*contents) < length) {
                fprintf(stderr, "Fatal Error: File read error (file: %s)!\r\n", fileName);
                fprintf(stderr, "Characters expected: %d, Characters read: %d\r\n", length, strlen(*contents));
                fprintf(stderr, "Content read:\r\n%s\r\n", *contents);
                fprintf(stderr, "Aborting!\r\n", fileName);

                // Close file and exit
                fclose(file);
                exit(-1);
            }

            // Close binary file
            fclose(file);
        }
        else {
            fprintf(stderr, "Fatal Error: Failed to open the file: %s!\r\n", fileName);
            exit(-1);
        }
    }
    else {
        fprintf(stderr, "Fatal Error: File was empty (file: %s)!\r\n", fileName);
        exit(-1);
    }

    return length;
} 
```

结果：

```
devious@devious-kubuntu:~/Workspace/test$ ls                                                                                                                                                                                                                                   
test  test.c  test.png  test.txt
devious@devious-kubuntu:~/Workspace/test$ ./test test.txt 
File length: 43
File contents:
This is a test file!

With multiple lines!

devious@devious-kubuntu:~/Workspace/test$ ./test test.png 
Fatal Error: File read error (file: test.png)!
Characters expected: 50243, Characters read: 8
Content read:
?PNG
¦

Aborting! 
```

如果我以文本模式打开文件，我会期待这些结果，但由于它是以二进制模式打开的，我不明白为什么会发生这种情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T22:47:42.303

该`strlen`函数专门用于 C 风格的字符串。没有办法通过查看其内容来判断任意二进制数据的长度。你的长度在`lengthRead`.

```
 fprintf(stderr, "Content read:\r\n%s\r\n", *contents); 
```

这里同样的问题。`%s`格式说明符用于 C 风格的字符串，而不是任意二进制数据。您需要编写自己的函数以某种适当的格式打印数据。

# asp.net - vb.net 验证选定日期字段中的天数

> ID：13223667
> 
> 赞同：0
> 
> 时间：2012-11-04T22:37:39.760
> 
> 标签：asp.net, vb.net, validation, date

我有两个文本框，它们是日期选择器。`tbStartDate`和`tbEndDate`。用户应该只选择一个从星​​期一开始到星期五结束的日期，例如

```
tbStart.text = 05/11/2012 (Mon 5th November 2012)
tbEndDate.text = 09/11/2012 (Fri 11th November 2012) 
```

我需要验证开始日期和结束日期分别是星期一和星期五。

我正在使用 asp.net (Visual Basic)。我的问题的最佳解决方案是什么？谢谢

**解决：**

```
Sub GetDayOfWeek()
Dim MyDate As Date = "2012/11/04"
        If MyDate.DayOfWeek.ToString() = "Sunday" Then
            Response.Write("Cannot be a weekend!")
         Else
            Response.Write("Weekday Detected!")
        End If
    End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T23:39:05.850

```
Sub GetDayOfWeek()
Dim MyDate As Date = "2012/11/04"
        If MyDate.DayOfWeek.ToString() = "Sunday" Then
            Response.Write("Cannot be a weekend!")
         Else
            Response.Write("Weekday Detected!")
        End If
    End Sub 
```

# android - SherlockActivity 在 ListView 中使用 ArrayList/ArrayAdapter 崩溃

> ID：13223673
> 
> 赞同：1
> 
> 时间：2012-11-04T22:38:07.877
> 
> 标签：android, arraylist, actionbarsherlock, android-arrayadapter

我的 SherlockActivity，它使用 EditText、Button 和 ListView 来扩展布局。

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".MainActivity" >

<ListView
    android:id="@+id/listView1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_below="@+id/editText1" >
</ListView>

<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBottom="@+id/editText1"
    android:layout_alignParentRight="true"
    android:layout_alignParentTop="true"
    android:text="Add"
    tools:ignore="HardcodedText" />

<EditText
    android:id="@+id/editText1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:layout_toLeftOf="@+id/button1"
    android:ems="10"
    android:hint="Click add!"
    android:inputType="text"
    tools:ignore="HardcodedText" >
</EditText> 
```

我的 MainActivity 扩展了 BaseActivity，它扩展了以下菜单布局文件

```
<menu xmlns:android="http://schemas.android.com/apk/res/android" >

<item
    android:id="@+id/menu_settings"
    android:orderInCategory="100"
    android:showAsAction="never"
    android:title="@string/menu_settings"/>
<item
    android:id="@+id/add_item"
    android:orderInCategory="1"
    android:showAsAction="ifRoom"
    android:title="@string/add"/>
<item
    android:id="@+id/calendar"
    android:orderInCategory="2"
    android:showAsAction="ifRoom"
    android:title="@string/show_cal"/>
</menu> 
```

我创建了一个扩展 SherlockActivity 的 BaseActivity。

```
package com.courseorganizer;

import com.actionbarsherlock.app.SherlockActivity;
import com.actionbarsherlock.view.Menu;

public class BaseActivity extends SherlockActivity {
    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getSupportMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
} 
```

MainActivity 是我遇到问题的地方。我扩展 BaseActivity 并设置 onOptionsItemSelected() 以便如果选择“添加”选项卡，则调用输入字段。然后，我将 OnClickListener 设置为按钮，以将用户的输入添加到 ListView 中，该 ListView 填充在放入 ArrayAdapter 的 ArrayList 中。

这是主要活动：

```
 package com.courseorganizer;

import java.util.ArrayList;

import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ListView;

import com.actionbarsherlock.view.MenuItem;

public class MainActivity extends BaseActivity {

private final String TAG = "Main Activity";

// LIST OF ARRAY STRINGS WHICH WILL SERVE AS LIST ITEMS
ArrayList<String> listItems = new ArrayList<String>();

// DEFINING STRING ADAPTER WHICH WILL HANDLE DATA OF LISTVIEW
ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,android.R.layout.simple_list_item_1, listItems);

Button addItem = (Button)findViewById(R.id.button1);
EditText input = (EditText)findViewById(R.id.editText1);
ListView courseList = (ListView)findViewById(R.id.listView1);

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    addItem.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            listItems.add(input.getText().toString());
            courseList.setAdapter(adapter);
        }
    });
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
    case R.id.add_item:
        input.requestFocus();
        Log.i(TAG, "Add Clicked");
        return true;
    case R.id.calendar:
        Log.i(TAG, "Calendar Clicked");
        return true;
    default:
        return super.onOptionsItemSelected(item);
    }
}
} 
```

我感谢您的帮助！

编辑：这是我的 logcat 输出：

```
11-04 19:16:24.517: D/AndroidRuntime(305): Shutting down VM
11-04 19:16:24.517: W/dalvikvm(305): threadid=1: thread exiting with uncaught exception     (group=0x4001d800)
11-04 19:16:24.569: E/AndroidRuntime(305): FATAL EXCEPTION: main
11-04 19:16:24.569: E/AndroidRuntime(305): java.lang.RuntimeException: Unable to     instantiate activity ComponentInfo{com.courseorganizer/com.courseorganizer.MainActivity}:     java.lang.IllegalStateException: System services not available to Activities before     onCreate()
11-04 19:16:24.569: E/AndroidRuntime(305):  at     android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2585)
11-04 19:16:24.569: E/AndroidRuntime(305):  at     android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
11-04 19:16:24.569: E/AndroidRuntime(305):  at     android.app.ActivityThread.access$2300(ActivityThread.java:125)
11-04 19:16:24.569: E/AndroidRuntime(305):  at     android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
11-04 19:16:24.569: E/AndroidRuntime(305):  at     android.os.Handler.dispatchMessage(Handler.java:99)
11-04 19:16:24.569: E/AndroidRuntime(305):  at android.os.Looper.loop(Looper.java:123)
11-04 19:16:24.569: E/AndroidRuntime(305):  at     android.app.ActivityThread.main(ActivityThread.java:4627)
11-04 19:16:24.569: E/AndroidRuntime(305):  at     java.lang.reflect.Method.invokeNative(Native Method)
11-04 19:16:24.569: E/AndroidRuntime(305):  at     java.lang.reflect.Method.invoke(Method.java:521)
11-04 19:16:24.569: E/AndroidRuntime(305):  at     com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
11-04 19:16:24.569: E/AndroidRuntime(305):  at     com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
11-04 19:16:24.569: E/AndroidRuntime(305):  at dalvik.system.NativeStart.main(Native     Method)
11-04 19:16:24.569: E/AndroidRuntime(305): Caused by: java.lang.IllegalStateException:     System services not available to Activities before onCreate()
11-04 19:16:24.569: E/AndroidRuntime(305):  at     android.app.Activity.getSystemService(Activity.java:3526)
11-04 19:16:24.569: E/AndroidRuntime(305):  at     android.widget.ArrayAdapter.init(ArrayAdapter.java:271)
11-04 19:16:24.569: E/AndroidRuntime(305):  at android.widget.ArrayAdapter.<init>    (ArrayAdapter.java:150)
11-04 19:16:24.569: E/AndroidRuntime(305):  at com.courseorganizer.MainActivity.<init>    (MainActivity.java:24)
11-04 19:16:24.569: E/AndroidRuntime(305):  at java.lang.Class.newInstanceImpl(Native     Method)
11-04 19:16:24.569: E/AndroidRuntime(305):  at     java.lang.Class.newInstance(Class.java:1429)
11-04 19:16:24.569: E/AndroidRuntime(305):  at     android.app.Instrumentation.newActivity(Instrumentation.java:1021)
11-04 19:16:24.569: E/AndroidRuntime(305):  at     android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2577)
11-04 19:16:24.569: E/AndroidRuntime(305):  ... 11 more
11-04 19:16:26.998: I/Process(305): Sending signal. PID: 305 SIG: 9 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T01:02:39.473

`findViewById()`不能在`onCreate()`and之前调用`setContentView()`，因为没有要搜索的上下文或布局。

将这些行移到`onCreate()`after`setContentView()`中。

```
addItem = (Button)findViewById(R.id.button1);
input = (EditText)findViewById(R.id.editText1);
courseList = (ListView)findViewById(R.id.listView1); 
```

# guid - 没有连字符的 GUID 是否安全？

> ID：13223674
> 
> 赞同：2
> 
> 时间：2012-11-04T22:38:25.583
> 
> 标签：guid, uniqueidentifier

我已经阅读了有关 guid 的各种内容以及它们对于不重复相同值的安全性。不过，我对这个问题有一点看法：Guids 似乎总是使用连字符将它们分成块。如果我处理这些连字符，是否会以任何方式损害数字的唯一性？如果我记得，每个块总是填充到相同的位数，所以如果这是真的，我会假设他们不应该因为删除连字符而受到影响。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T22:44:59.653

你是对的。连字符仅用于格式化。如果您查看[http://docs.python.org/2/library/uuid.html](http://docs.python.org/2/library/uuid.html)，您会注意到所有不同的格式实际上都是相同的 UID。

# android - PageViewer 未通过类显示视图

> ID：13223675
> 
> 赞同：1
> 
> 时间：2012-11-04T22:38:27.873
> 
> 标签：android, android-layout, android-widget

对于我的应用程序，我有一个基本的主要活动，其中包含一个页面查看器。在活动课上，我有：

```
MyPagerAdapter adapter = new MyPagerAdapter(this);
viewPager.setAdapter(adapter); 
```

适配器类如下所示：

```
private class MyPagerAdapter extends PagerAdapter {

private ArrayList<LinearLayout> views;

public MyPagerAdapter(Context context) {
    views = new ArrayList<LinearLayout>();
    views.add(new questionListView(context));
}

    @Override
    public void destroyItem(View view, int arg1, Object object) {
        ((ViewPager) view).removeView((LinearLayout) object);
    }

    @Override
    public void finishUpdate(View arg0) {

    }

    @Override
    public int getCount() {
        return views.size();
    }

    @Override
    public Object instantiateItem(View view, int position) {
        View myView = views.get(position);
        ((ViewPager) view).addView(myView);
        return myView;
    }

    @Override
    public boolean isViewFromObject(View view, Object object) {
        return view == object;
    }

    @Override
    public void restoreState(Parcelable arg0, ClassLoader arg1) {

    }

    @Override
    public Parcelable saveState() {
        return null;
    }

    @Override
    public void startUpdate(View arg0) {

    }

    }
    }
} 
```

questionListView 类看起来像：

```
public class questionListView extends LinearLayout {

public questionListView(Context context, AttributeSet attrs) {
    super(context, attrs);
    init();
}

public questionListView(Context context) {
    super(context);
    init();
}

private void init() {

    LayoutInflater factory = LayoutInflater.from(getContext());
    View myView = factory.inflate(R.layout.view1,null);

    addView(myView);

}

} 
```

主要活动布局：

```
<android.support.v4.view.ViewPager xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/pager"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

    <!--
    This title strip will display the currently visible page title, as well as the page
    titles for adjacent pages.
    -->

    <android.support.v4.view.PagerTitleStrip
        android:id="@+id/pager_title_strip"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_gravity="top"
        android:alpha="4"
        android:paddingBottom="4dp"
        android:paddingTop="4dp"
        android:textColor="#000000" />

</android.support.v4.view.ViewPager> 
```

view1 是一个布局视图，一个带有其他布局的线性布局。

当我运行该应用程序时，会显示主要活动，但没有显示带有 view1-layout 的视图。

为什么不，我在这里做错了什么？我没有收到任何错误。

rg，埃里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T21:27:11.873

Luksprog 帮助解决了这个问题。将 PagerTitleStrip 设置为 wrap_content 解决了它。

# ajax - 您应该重定向还是重写 ?_escaped_fragment_= URL？

> ID：13223679
> 
> 赞同：0
> 
> 时间：2012-11-04T22:38:41.387
> 
> 标签：ajax

有谁知道在处理 ?_escaped_fragment_= 查询字符串值时使用 Google/Bing 处理 AJAX 索引的正确重定向方法是什么？是否最好重定向 URL（如果是这样，这应该是 302 重定向）吗？还是最好通过重写静态内容来掩盖 URL（URL 将保持不变，但您的应用程序会将其路由到幕后）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T15:01:16.357

最好的情况是避免任何额外的 HTTP 请求，因为搜索引擎已经够忙了。因此 a`rewrite`应该是最好的解决方案。

# forms - 使用 HTML 表单 GET 压缩 URL

> ID：13223680
> 
> 赞同：1
> 
> 时间：2012-11-04T22:38:43.680
> 
> 标签：forms, get, gzip

我有一个包含太多创建配置的元素的表单，有时表单无法一直填写，所以我一直使用 GET 而不是 POST 来保留书签。但是我想出了超过 2000 个字符并且它被截断了。尝试使用 gzip 压缩 url 的那部分（超出？），或者任何可以减少至少 30% 的简单方法。

在[http://www.boutell.com/newfaq/misc/urllength.html](http://www.boutell.com/newfaq/misc/urllength.html)，他们解释了它可以做到，但不是如何做到的。在这里，他们展示了功能，但没有展示如何即时执行。[http://www.rahji.com/wordpress/2005/12/16/compressing-urls/](http://www.rahji.com/wordpress/2005/12/16/compressing-urls/)

我是网络人，所以如果我遗漏了一些基本的东西，我深表歉意。

# ios - 向上滚动后我的单元格调整大小？

> ID：13223682
> 
> 赞同：0
> 
> 时间：2012-11-04T22:38:46.443
> 
> 标签：ios, uitableview, uiscrollview

我的 TableViewCell 布局有问题。目前，当我在 tableView 中向上滚动时，我发现了一个奇怪且烦人的错误。当我决定释放“滚动”时，意味着我正在放下“滚动”，因此“视图”将返回到显示所有 TableView 内容的正常位置，我的一些单元格可以出于某种原因重新调整自己的大小宽度。我不知道为什么会发生这种情况或问题可能是什么。

我的所有单元格都根据我论坛中标签（commentLabel）的高度定制为 fitSize。我认为问题可能在于我如何尝试自定义单元格的内容。我将发布我的相关代码并发布到下面的图片中。

**在开始向上拖动滚动之前**：[http ://tinypic.com/view.php?pic=2rfsum9&s=6](http://tinypic.com/view.php?pic=2rfsum9&s=6)

**释放/放下卷轴后，再次回到正常位置。现在其中一个单元格发生了变化**：[http ://tinypic.com/view.php?pic=swxnqv&s=6](http://tinypic.com/view.php?pic=swxnqv&s=6)

**代码**：

```
- (UITableViewCell *)tableView:(UITableView *)pTableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"ForumthreadCell";
    UITableViewCell *cell = [pTableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil)
    {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    Feedback *item = [self.items objectAtIndex:indexPath.row];

    UILabel *aliasLabel = (UILabel *)[cell viewWithTag:1];
    UILabel *commentLabel = (UILabel *)[cell viewWithTag:2];
    UILabel *dateLabel = (UILabel *)[cell viewWithTag:3];

    [aliasLabel setText:item.alias];
    [commentLabel setText:item.comment];
    [dateLabel setText:[self.dateFormatter stringFromDate:[NSDate dateWithTimeIntervalSince1970:(double)item.time]]];

    commentLabel.numberOfLines = 0;
    [commentLabel sizeToFit];
    [aliasLabel sizeToFit];
    [dateLabel sizeToFit];

    return cell;
}

-(CGFloat)getLabelHeightForText:(NSString *)text andWidth:(CGFloat)labelWidth
{

    CGSize maximumSize = CGSizeMake(labelWidth, 10000);

    //provide appropriate font and font size
    CGSize labelHeighSize = [text sizeWithFont: [UIFont fontWithName:@"Trebuchet MS" size:12.0f]
                         constrainedToSize:maximumSize
                             lineBreakMode:UILineBreakModeTailTruncation];
    return labelHeighSize.height;
 }

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    Feedback *item = [self.items objectAtIndex:indexPath.row];

    CGFloat commentTextHeight = [self getLabelHeightForText:item.comment andWidth:162];
    return commentTextHeight + 39;
} 
```

**编辑**

```
NSLog(@"bounds.origin.x: %f", commentLabel.bounds.origin.x);
NSLog(@"bounds.origin.y: %f", commentLabel.bounds.origin.y);
NSLog(@"bounds.size.width: %f", commentLabel.bounds.size.width);
NSLog(@"bounds.size.height: %f", commentLabel.bounds.size.height);

NSLog(@"frame.origin.x: %f", commentLabel.frame.origin.x);
NSLog(@"frame.origin.y: %f", commentLabel.frame.origin.y);
NSLog(@"frame.size.width: %f", commentLabel.frame.size.width);
NSLog(@"frame.size.height: %f", commentLabel.frame.size.height); 
```

导致 1 个单元格的此输出（1 个 commentLabel 输出）

```
purgeIdleCellConnections: found one to purge conn = 0x1dd654f0
 bounds.origin.x: 0.000000
 bounds.origin.y: 0.000000
 bounds.size.width: 162.000000
 bounds.size.height: 10039.000000
 frame.origin.x: 12.000000
 frame.origin.y: 28.000000
 frame.size.width: 162.000000
 frame.size.height: 10039.000000 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T03:09:32.393

重复使用单元格时，应设置所有标签的框架。原因是 -sizeToFit 会改变标签的框架，所以当你重用单元格时，标签的框架已经改变了。

**编辑**

你可以这样做：

```
static const CGFloat kLabelWidth = 162;
static const CGFloat kOffset = 39;

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *identifier = @"identifier";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:identifier];
    if (!cell) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:identifier];
    }

    UILabel *commentLabel = (UILabel *)[cell.contentView viewWithTag:2];
    CGRect frame = commentLabel.frame;
    frame.size.width = kLabelWidth;
    frame.size.height = 10000;
    commentLabel.frame = frame;
    commentLabel.text = @"your text";
    [commentLabel sizeToFit];

    frame = commentLabel.frame;
    frame.size.height += kOffset;
    commentLabel.frame = frame;

    return cell;
}

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath  {
    CGFloat commentTextHeight = [self getLabelHeightForText:@"your text" andWidth:kLabelWidth];
    return commentTextHeight + kOffset;
} 
```

# php - 提交表格的方法

> ID：13223684
> 
> 赞同：-1
> 
> 时间：2012-11-04T22:38:47.067
> 
> 标签：php, jquery

这只是一个一般性问题，可以看到其他人对更好方法的想法。对于我的表单，最好继续使用常规表单提交表单操作，或者禁用表单的默认设置并使用 jQuery ajax 函数调用提交？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:42:11.377

好吧，这完全取决于您要达到的目标？JavaScript 解决方案可能对用户更友好，但它们最终都实现了相同的目标。

如果您确实选择了 jQuery 路线，请确保您在用户没有启用 JS 的情况下有一个备用方案。

# java - Java - KeyEvent 变量

> ID：13223687
> 
> 赞同：0
> 
> 时间：2012-11-04T22:38:55.803
> 
> 标签：java, awtrobot

所以。我有一个小问题。最有可能是因为我对 java 很陌生。无论如何，我的问题是：为什么这不起作用？

```
public static void pressKey(KeyEvent key) throws AWTException {
    Robot r = new Robot();
    r.keyPress(KeyEvent.key);
    r.keyRelease(KeyEvent.key);
} 
```

我怎样才能让这样的事情起作用？这会让我的生活轻松很多。提前谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:47:20.987

没有调用公共静态字段`key`，`KeyEvent`这就是为什么

```
//just pass they argument to your method as argument to those methods
r.keyPress(key);
r.keyRelease(key); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T22:47:38.770

你必须使用

```
 public static void pressKey(int key) throws AWTException {
    Robot r = new Robot();
    r.keyPress(key);
    r.keyRelease(key);
} 
```

让它工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T03:20:49.570

该“关键”变量是一个整数。KeyEvent 只是一种易于记忆的使用方式，但**两者都是整数**。

这意味着该方法使用**integer**，而不是**KeyEvent**。

假设我们有以下方法：

```
public static void press(int event) throws AWTException {
    Robot bot = new Robot();
    bot.keyPress(event);
    bot.keyRelease(event);
} 
```

它可以通过两种方式调用：KeyEvent 和整数。都一样（不要忘记添加“抛出”语句或“尝试/捕获”）：

```
press(KeyEvent.VK_SLASH); 
```

或者：

```
press(46); 
```

如果我是对的，两者都会发送一个斜线（如果我错了，请纠正我）。但是 KeyEvents 更容易。

另外，请记住，并非所有键盘都具有相同的布局。根据密钥的不同，将发送完全不同的密钥，或者更糟糕的是，机器人会抛出 IllegalArgumentException。我建议您对不是字母/数字的字符使用 Alt 代码。

# c++ - 我有一个未声明的标识符错误，我无法弄清楚

> ID：13223689
> 
> 赞同：0
> 
> 时间：2012-11-04T22:38:59.437
> 
> 标签：c++, visual-studio-2010

我不知道为什么这行不通。当我运行它时，我的对象 c1 和客户上出现各种未声明的标识符错误。如果我做一个 Customer* c1 = new Customer(); 我仍然遇到同样的错误，它不会让我设置客户 ID。它可能很愚蠢，任何输入都会很棒。

```
void checkout(){

    srand(time(NULL));
    int random = rand() % 3 + 1;

    Customer c1;
    c1.setcustomerID("0");
}

class Customer{
public:
    string customerID;
    string list;
public:
    Customer(){}
    ~Customer(){}

    string getcustomerID(){
        return customerID;
    }
    string getList(){
        return list;
    }
    void setcustomerID(string x){
        customerID = x;
    }
    void setList(int x){
        if(x==1)
            list = "bread";
        if(x==2)
            list = "eggs";
        if(x==3)
            list = "cheese";
    }

}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:40:10.837

你应该把：

```
class Customer{ 
```

在您的 checkout() 方法之前

# javascript - 调用新图像来精灵表动画？

> ID：13223693
> 
> 赞同：1
> 
> 时间：2012-11-04T22:39:24.757
> 
> 标签：javascript, html, function, loops, easeljs

我制作了一个动画并将其变成了多个精灵表，我有一个精灵可以完美地使用这段代码：

```
<script type="text/javascript">

var ctx;
var count = 0;
var x;
var y;

var img = new Image();
img.src = "iphone.png";
img.onload = draw;

function init (){
    ctx = document.getElementById("canvas").getContext("2d");
}

function draw(){
    requestAnimationFrame(draw);

    ctx.clearRect(0, 0, 204, 97);

    x = (count % 10) * 204;
    y = Math.floor(count / 10) * 97;
    ctx.drawImage(img, x, y, 204, 97, 0, 0, 204, 97);
    if(count==240)
        count = 0;
    else
        count++;
} 
```

我现在要做的是在当前精灵表达到 IF 语句所在的“240”时调用另一个精灵表。换句话说，不是循环动画，而是调用另一个图像并再次执行相同的功能（使用该图像）。我正在做噩梦试图找到这个问题的答案，但我不禁认为这是非常简单的事情，对吗？

# asp.net - 多个用户可同时访问的线程安全集合

> ID：13223696
> 
> 赞同：1
> 
> 时间：2012-11-04T22:39:44.083
> 
> 标签：asp.net, thread-safety

我正在开发多人游戏，我有一个写在`asp.net`. 游戏用户向服务器发送请求以寻找对手并加入某种战斗。战斗请求可以有一些参数，但也可能没有（估计是最流行的场景），所以发送方应该连接到任何已经发送过请求的用户并等待连接。

将所有等待请求存储在线程安全集合中是个好主意吗？它总是会包含相当多的元素（因为很快就可以找到战斗的匹配项），但是，很多线程会尝试一次访问这个集合。为每个`N`请求创建不同的集合是个好主意吗？的最佳尺寸是`N`多少？或者也许还有其他想法？我的关键问题是在不损害服务器性能的情况下快速找到匹配项，即使当前连接的数量非常大。

**UPD**

看来我没有很清楚地描述我的问题。所有战斗信息——参与用户、战斗中的动作、获胜者等，都存储在数据库中。我需要的是处理加入战斗的请求（请求可能只包含发送者 ID 和战斗过滤器）。一般情况下，对手会很快找到，所以不需要存储请求数据（找到比赛后应该删除，所有战斗数据都会存储在数据库中），但是，我必须准备好处理大量的同时提出要求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:46:19.493

如果不考虑匹配玩家的标准，则在编写 Web 应用程序时不应将用户会话数据保存在内存中。您的 Web 应用程序有时会被回收，从而导致数据丢失。

正如 SLaks 所说，您应该将这些数据存储在数据库中并从中进行选择。您应该从这个基线考虑性能优化，具体取决于用户匹配逻辑。要么选择前 n 个用户，要么根据所需条件创建查询。

# javascript - 检查跨度并删除第一个孩子

> ID：13223700
> 
> 赞同：0
> 
> 时间：2012-11-04T22:40:48.983
> 
> 标签：javascript, jquery, cycle, html

基本上，单击时会前进到下一个隐藏跨度。

标记：

```
<div id="facts">
    <span>click to cycle</span>
    <span>fact 1</span>
    <span>fact 2</span>
    <span>fact 3</span>
    <span>fact 4</span>
</div> 
```

js：

```
$(document).ready(function() {
    var current = 1;
          $('#facts span').click(function() {
              // Hide all of them
              $('#facts span').hide();
              // Unhide the current one:
              $('#facts span:eq(' + (current % $('#facts span').length) + ')').show();
              // Increment the variable
              console.log(current % 4);
              current++;
          });

    // Unhide the first one on load
    $('#facts span:first-child').show();
});​ 
```

我现在要做的是在点击后删除第一个跨度，因为用户没有必要再次看到“点击循环”指令。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:45:53.227

将特定的 id 分配给原始的，并为其他的分配一个类。

```
<span id='removeme'>click to cycle</span>
<span class='cycleme'>fact 1</span>
<span class='cycleme'>fact 2</span>
<span class='cycleme'>fact 3</span>
<span class='cycleme'>fact 4</span> 
```

`removeme`通过 CSS显示和隐藏所有其他

```
#removeme {
  display: inline;
}
span.cycleme {
  display: none;
} 
```

在脚本中，将单击事件绑定到原始事件以简单地删除它。后续的处理程序与之前的处理程序相同。

```
$(document).ready(function() {
    // Initialize
    var current = 1;

   // Bind the first one's onclick to remove itself
   $('#removeme').click(function() {
      $(this).remove();
      // And display the first one
      $('#facts span:first-child').show();
   });

   // Target the others via their class
   $('#facts span.cycleme').click(function() {
      // Hide all of them
      $('#facts span').hide();
      // Unhide the current one:
      $('#facts span:eq(' + (current % $('#facts span.cycleme').length) + ')').show();
      // Increment the variable
      current++;
   });
});​ 
```

[这是现场示例](http://jsfiddle.net/tnJ7e/7/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T22:57:43.633

干得好

[**小提琴**](http://jsfiddle.net/videsignz/KDMaK/)

**HTML**

```
<div id="facts">
    <span id='remove'>click to cycle</span>
    <span>fact 1</span>
    <span>fact 2</span>
    <span>fact 3</span> 
   <span>fact 4</span>
</div> 
```

**jQuery**

```
$(document).ready(function() {
    var current = 1;
          $('#facts span').click(function() {
              $('#remove').remove();
              // Hide all of them
              $('#facts span').hide();
              // Unhide the current one:
              $('#facts span:eq(' + (current % $('#facts span').length) + ')').show();// Increment the variable
              console.log(current % 4);
              current++;
          });

    // Unhide the first one on load
    $('#facts span:first-child').show();
}); 
```

# android - 基于线程的游戏的Android生命周期

> ID：13223706
> 
> 赞同：1
> 
> 时间：2012-11-04T22:42:17.940
> 
> 标签：android, lifecycle

例如，在被用户或电话置于后台后，我试图让我的游戏正常运行时遇到了一些麻烦。

我的应用程序有一个名为 GameView 的 SurfaceView 类，它具有 onDraw() 方法来为我的游戏和两个线程执行所有必要的绘制 - 一个用于调用 onDraw()，另一个用于为游戏逻辑进行必要的计算。

我成功实现了 onPause() 和 onResume()。（按下后退按钮时我暂停了两个线程，并在用户在 AlertDialog 中取消后恢复它们。）

现在我想让游戏在 onStop() 被调用时以同样的方式暂停。我暂停了两个线程并将我的字符位置保存在 savedInstanceState 中，但是当我再次启动我的应用程序时，没有调用任何方法（我检查了 Logcat）。我认为应该首先调用 onRestart()，然后调用 onStart()，然后调用 onResume()，但这些都没有发生。我究竟做错了什么？

（没有包含任何代码，因为这似乎是我不了解生命周期的问题，而不是代码的问题。如果有必要，我会发布您要求的部分。）

# c++ - CMake 找不到提升

> ID：13223707
> 
> 赞同：2
> 
> 时间：2012-11-04T22:42:21.807
> 
> 标签：c++, boost, cross-platform, cmake

Windows 7\. 64 位。CMake 2.8.10。

脚步：

*   下载提升：http: [//sourceforge.net/projects/boost/files/boost/1.51.0/](http://sourceforge.net/projects/boost/files/boost/1.51.0/)
*   把它放到**C:\work\lib\boost_1_51_0-MT**
*   打开“开始->所有程序->Microsoft Visual Studio 2010->Visual Studio 工具->Visual Studio 命令提示符（2010）”
*   命令：  

```
cd C:\work\lib\boost_1_51_0-MT
引导程序.bat
bjam --toolset=msvc-10.0 --variant=release --build-type=complete -j 4 --with-regex --with-test --with-filesystem --with-date_time --with-random -- with-system --with-thread --with-program_options --with-chrono --with-math stage link=static threading=multi runtime-link=static

```

*   命令：  

```
设置 BOOST_ROOT=C:\work\lib\boost_1_51_0-MT
cmake M:\项目

  找不到请求的 Boost 库。

  增强版：1.51.0

  Boost 包含路径：C:/work/lib/boost_1_51_0-MT

  找不到以下 Boost 库：

          升压系统
          boost_thread
          boost_random
          boost_chrono

  没有找到 Boost 库。您可能需要将 BOOST_LIBRARYDIR 设置为
  包含 Boost 库或 BOOST_ROOT 的目录到
  促进。

```

M:\project\CMakeLists.txt 包含：（我需要静态链接提升）

```
...
set_property（全局属性 FIND_LIBRARY_USE_LIB64_PATHS ON）
设置（USE_STATIC_BOOST ON）
添加定义（-DBOOST_THREAD_USE_LIB）
添加定义（-DBOOST_ALL_NO_LIB）

find_package（Boost 1.48.0 COMPONENTS 系统线程随机计时需要）
...

```

这个 CMakeLists.txt 很旧，适用于其他 boost 安装（由我完成，而不是我过去完成，但收据丢失了）。

**解决了**

```
设置（Boost_USE_STATIC_LIBS ON）

```

...现在 CMake 找到了 boost 库！虽然我的 "set(USE_STATIC_BOOST ON)" 一定有同样的效果，但它不...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-05T18:52:20.447

**解决了**

```
设置（Boost_USE_STATIC_LIBS ON）

```

...现在 CMake 找到了 boost 库！虽然我的 CMakeLists.txt 有`set(USE_STATIC_BOOST ON)`which 必须有相同的效果，但它没有......

要使用`set(Boost_USE_STATIC_LIBS OFF)`，您需要添加：

```
if( WIN32 )
  # Needed for boost to turn off autolinking for dynamic linking
  add_definitions( -DBOOST_ALL_NO_LIB )
endif() 
```

查看更多： [在 Windows 上使用 Boost_USE_STATIC_LIB OFF 链接 boost 库](https://stackoverflow.com/questions/28887680/linking-boost-library-with-boost-use-static-lib-off-on-windows)

# c# - 提取事件

> ID：13223708
> 
> 赞同：0
> 
> 时间：2012-11-04T22:42:23.190
> 
> 标签：c#, visual-studio-2010, linq, extraction, web-testing

所以我有以下代码：

```
 public override void Extract(object sender, ExtractionEventArgs e)
    {
            if (e.Response.HtmlDocument != null)
            {

                var myParam = e.Request.QueryStringParameters.Where(parameter => parameter.Name == QueryName).Select(parameter => parameter.Value).Distinct();

                myParam.

                // add the extracted value to the web performance test context
                e.WebTest.Context.Add(this.ContextParameterName, myParam.ToString());
                e.Success = true;
                return;

            }

        // If the extraction fails, set the error text that the user sees
        e.Success = false;
        e.Message = String.Format(CultureInfo.CurrentCulture, "Not Found: {0}", QueryName);
    } 
```

它回来了：

```
System.Linq.Enumerable+<DistinctItem>d_81`1[system.string] 
```

我期待以下内容：

```
0152-1231-1231-123d 
```

我的问题是如何从`extractioneventargs`. 他们说有可能，但我不知道。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:51:06.797

你可以使用`string.Join`：

```
string resultAsString = string.Join("-", myParam);
e.WebTest.Context.Add(this.ContextParameterName, resultAsString); 
```

我在这里假设查询字符串参数值为*0152*、*1231*等，并且您希望将它们与破折号组合。

由于[`WebTest.Context.Add`](http://msdn.microsoft.com/en-us/library/ms244024%28v=vs.100%29.aspx)可以接受一个对象，因此如果适合您的目的，您还可以将结果添加为数组：

```
e.WebTest.Context.Add(this.ContextParameterName, myParam.ToArray()); 
```

* * *

（请注意，此字符串`System.Linq.Enumerable+<DistinctItem>d_81``1[system.string]`是类型名称，这是`ToString()`默认情况下为任何对象返回的名称（除非它已被覆盖）。）

# iphone - NSTimer 无法调用 UIButton setHidden:YES/NO

> ID：13223710
> 
> 赞同：0
> 
> 时间：2012-11-04T22:42:31.900
> 
> 标签：iphone, ios, xcode, ipad, cocoa

我不明白为什么这不起作用。我试图在计时器周期被击中时显示 lblstatus ：

```
-(void) viewDidAppear:(BOOL)animated
{
        [NSTimer scheduledTimerWithTimeInterval:1
                                         target:self
                                       selector:@selector(TimeForPictureCycle)
                                       userInfo:nil
                                        repeats:NO];
}

-(void)TimeForPictureCycle
{
    while(YES)
    {
        [lblStatus setHidden:NO];
        sleep(2);
        [lblStatus setHidden:YES];
        sleep(3);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T22:51:33.787

您在主线程上的调用`sleep()`，这意味着在您将标签设置`hidden`为该线程后会暂停并阻止运行循环继续，因此它无法更新您的 UI。您当前的代码简单地阻塞了您的整个应用程序。

你可以做的是：

```
-(void) viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];
    self.showTimer = [NSTimer scheduledTimerWithTimeInterval:1
                                         target:self
                                       selector:@selector(showLabel)
                                       userInfo:nil
                                        repeats:NO];
}

-(void)showLabel
{ 
    [lblStatus setHidden:NO];
    self.hideTimer = [NSTimer scheduledTimerWithTimeInterval:2
                                         target:self
                                       selector:@selector(hideLabel)
                                       userInfo:nil
                                        repeats:NO];
}

-(void)hideLabel
{        
    [lblStatus setHidden:YES];
    self.showTimer = [NSTimer scheduledTimerWithTimeInterval:3
                                         target:self
                                       selector:@selector(showLabel)
                                       userInfo:nil
                                        repeats:NO];
}

- (void)viewWillDisappear:(BOOL)animated
{
    [super viewWillDisappear:animated];
    [self.showTimer invalidate];
    [self.hideTimer invalidate];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T23:57:53.020

你可以简单地做到这一点：

```
-(void)viewDidAppear:(BOOL)animated {
    [lblStatus performSelector:@selector(setHidden:) withObject:0 afterDelay:1];
    [lblStatus performSelector:@selector(setHidden:) withObject:@1 afterDelay:3];
} 
```

我不太确定为什么我可以将 0 作为对象传递，但它确实有效。

# haskell - C 与 Haskell 中的幼稚斐波那契

> ID：13223712
> 
> 赞同：4
> 
> 时间：2012-11-04T22:42:52.680
> 
> 标签：haskell, ghc

请问，如何使`g`（fib）的评估完全严格？（**我知道这个指数解决方案不是最优的。**我想知道如何使递归**完全严格**/如果可能/）

**哈斯克尔**

```
g :: Int -> Int
g 0 = 0
g 1 = 1
g x = g(x-1) + g(x-2)
main = print $ g 42 
```

这样它的运行速度大约与天真的 C 解决方案一样快：

**C**

```
#include <stdio.h>

long f(int x)
{
    if (x == 0) return 0;
    if (x == 1) return 1;
    return f(x-1) + f(x-2);
}

int main(void)
{
    printf("%ld\n", f(42));
    return 0;
} 
```

**注意**：这个 fibs-recursion 仅用作一个超级简单的示例。我完全知道，有几十种更好的算法。但是肯定有递归算法没有那么简单和更有效的替代方案。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-04T23:07:29.263

答案是，GHC 自己使评估完全严格（当你通过优化编译给它机会时）。原始代码产生核心

```
Rec {
Main.$wg [Occ=LoopBreaker] :: GHC.Prim.Int# -> GHC.Prim.Int#
[GblId, Arity=1, Caf=NoCafRefs, Str=DmdType L]
Main.$wg =
  \ (ww_s1JE :: GHC.Prim.Int#) ->
    case ww_s1JE of ds_XsI {
      __DEFAULT ->
        case Main.$wg (GHC.Prim.-# ds_XsI 1) of ww1_s1JI { __DEFAULT ->
        case Main.$wg (GHC.Prim.-# ds_XsI 2) of ww2_X1K4 { __DEFAULT ->
        GHC.Prim.+# ww1_s1JI ww2_X1K4
        }
        };
      0 -> 0;
      1 -> 1
    }
end Rec } 
```

如您所见，如果您了解 GHC 的核心，它是完全严格的，并且使用未装箱的原始机器整数。

（不幸的是，gcc 从 C 源代码生成的机器代码更快。）

GHC 的严格度分析器相当好，在像这里这样的简单情况下，没有涉及多态性并且函数不太复杂，您可以指望它发现它可以将所有值拆箱以使用 unboxed `Int#`s 生成工人。

然而，在这种情况下，生成快速代码不仅仅是在机器类型上操作。本机代码生成器以及 LLVM 后端生成的程序集基本上是将代码直接翻译为程序集，检查参数是 0 还是 1，如果不是，则调用两次函数并添加结果。两者都会产生一些我不理解的进入和退出代码，而在我的机器上，本机代码生成器会产生更快的代码。

对于 C 代码，`clang -O3`生成简单的程序集，减少繁琐并使用更多寄存器，

```
.Ltmp8:
    .cfi_offset %r14, -24
    movl        %edi, %ebx
    xorl        %eax, %eax
    testl       %ebx, %ebx
    je          .LBB0_4
# BB#1:
    cmpl        $1, %ebx
    jne         .LBB0_3
# BB#2:
    movl        $1, %eax
    jmp         .LBB0_4
.LBB0_3:
    leal        -1(%rbx), %edi
    callq       recfib
    movq        %rax, %r14
    addl        $-2, %ebx
    movl        %ebx, %edi
    callq       recfib
    addq        %r14, %rax
.LBB0_4:
    popq        %rbx
    popq        %r14
    popq        %rbp
    ret 
```

（由于某种原因，今天在我的系统上的性能比昨天好得多）。从 Haskell 源代码和 C 语言生成的代码之间的许多性能差异来自在后者使用寄存器的情况下，前者使用间接寻址，算法的核心在两者中是相同的。

没有任何优化的 gcc 使用一些间接寻址产生的结果基本相同，但比 GHC 使用 NCG 或 LLVM 后端产生的结果要少。同上`-O1`，但间接寻址更少。使用`-O2`，您将获得一个转换，因此程序集不会轻易映射回源，并且使用`-O3`， gcc 会产生相当惊人的效果

```
.LFB0:
    .cfi_startproc
    pushq   %r15
    .cfi_def_cfa_offset 16
    .cfi_offset 15, -16
    pushq   %r14
    .cfi_def_cfa_offset 24
    .cfi_offset 14, -24
    pushq   %r13
    .cfi_def_cfa_offset 32
    .cfi_offset 13, -32
    pushq   %r12
    .cfi_def_cfa_offset 40
    .cfi_offset 12, -40
    pushq   %rbp
    .cfi_def_cfa_offset 48
    .cfi_offset 6, -48
    pushq   %rbx
    .cfi_def_cfa_offset 56
    .cfi_offset 3, -56
    subq    $120, %rsp
    .cfi_def_cfa_offset 176
    testl   %edi, %edi
    movl    %edi, 64(%rsp)
    movq    $0, 16(%rsp)
    je      .L2
    cmpl    $1, %edi
    movq    $1, 16(%rsp)
    je      .L2
    movl    %edi, %eax
    movq    $0, 16(%rsp)
    subl    $1, %eax
    movl    %eax, 108(%rsp)
.L3:
    movl    108(%rsp), %eax
    movq    $0, 32(%rsp)
    testl   %eax, %eax
    movl    %eax, 72(%rsp)
    je      .L4
    cmpl    $1, %eax
    movq    $1, 32(%rsp)
    je      .L4
    movl    64(%rsp), %eax
    movq    $0, 32(%rsp)
    subl    $2, %eax
    movl    %eax, 104(%rsp)
.L5:
    movl    104(%rsp), %eax
    movq    $0, 24(%rsp)
    testl   %eax, %eax
    movl    %eax, 76(%rsp)
    je      .L6
    cmpl    $1, %eax
    movq    $1, 24(%rsp)
    je      .L6
    movl    72(%rsp), %eax
    movq    $0, 24(%rsp)
    subl    $2, %eax
    movl    %eax, 92(%rsp)
.L7:
    movl    92(%rsp), %eax
    movq    $0, 40(%rsp)
    testl   %eax, %eax
    movl    %eax, 84(%rsp)
    je      .L8
    cmpl    $1, %eax
    movq    $1, 40(%rsp)
    je      .L8
    movl    76(%rsp), %eax
    movq    $0, 40(%rsp)
    subl    $2, %eax
    movl    %eax, 68(%rsp)
.L9:
    movl    68(%rsp), %eax
    movq    $0, 48(%rsp)
    testl   %eax, %eax
    movl    %eax, 88(%rsp)
    je      .L10
    cmpl    $1, %eax
    movq    $1, 48(%rsp)
    je      .L10
    movl    84(%rsp), %eax
    movq    $0, 48(%rsp)
    subl    $2, %eax
    movl    %eax, 100(%rsp)
.L11:
    movl    100(%rsp), %eax
    movq    $0, 56(%rsp)
    testl   %eax, %eax
    movl    %eax, 96(%rsp)
    je      .L12
    cmpl    $1, %eax
    movq    $1, 56(%rsp)
    je      .L12
    movl    88(%rsp), %eax
    movq    $0, 56(%rsp)
    subl    $2, %eax
    movl    %eax, 80(%rsp)
.L13:
    movl    80(%rsp), %eax
    movq    $0, 8(%rsp)
    testl   %eax, %eax
    movl    %eax, 4(%rsp)
    je      .L14
    cmpl    $1, %eax
    movq    $1, 8(%rsp)
    je      .L14
    movl    96(%rsp), %r15d
    movq    $0, 8(%rsp)
    subl    $2, %r15d
.L15:
    xorl    %r14d, %r14d
    testl   %r15d, %r15d
    movl    %r15d, %r13d
    je      .L16
    cmpl    $1, %r15d
    movb    $1, %r14b
    je      .L16
    movl    4(%rsp), %r12d
    xorb    %r14b, %r14b
    subl    $2, %r12d
    .p2align 4,,10
    .p2align 3
.L17:
    xorl    %ebp, %ebp
    testl   %r12d, %r12d
    movl    %r12d, %ebx
    je      .L18
    cmpl    $1, %r12d
    movb    $1, %bpl
    je      .L18
    xorb    %bpl, %bpl
    jmp     .L20
    .p2align 4,,10
    .p2align 3
.L21:
    cmpl    $1, %ebx
    je      .L58
.L20:
    leal    -1(%rbx), %edi
    call    recfib
    addq    %rax, %rbp
    subl    $2, %ebx
    jne     .L21
.L18:
    addq    %rbp, %r14
    subl    $2, %r13d
    je      .L16
    subl    $2, %r12d
    cmpl    $1, %r13d
    jne     .L17
    addq    $1, %r14
.L16:
    addq    %r14, 8(%rsp)
    subl    $2, 4(%rsp)
    je      .L14
    subl    $2, %r15d
    cmpl    $1, 4(%rsp)
    jne     .L15
    addq    $1, 8(%rsp)
.L14:
    movq    8(%rsp), %rax
    addq    %rax, 56(%rsp)
    subl    $2, 96(%rsp)
    je      .L12
    subl    $2, 80(%rsp)
    cmpl    $1, 96(%rsp)
    jne     .L13
    addq    $1, 56(%rsp)
.L12:
    movq    56(%rsp), %rax
    addq    %rax, 48(%rsp)
    subl    $2, 88(%rsp)
    je      .L10
    subl    $2, 100(%rsp)
    cmpl    $1, 88(%rsp)
    jne     .L11
    addq    $1, 48(%rsp)
.L10:
    movq    48(%rsp), %rax
    addq    %rax, 40(%rsp)
    subl    $2, 84(%rsp)
    je      .L8
    subl    $2, 68(%rsp)
    cmpl    $1, 84(%rsp)
    jne     .L9
    addq    $1, 40(%rsp)
.L8:
    movq    40(%rsp), %rax
    addq    %rax, 24(%rsp)
    subl    $2, 76(%rsp)
    je      .L6
    subl    $2, 92(%rsp)
    cmpl    $1, 76(%rsp)
    jne     .L7
    addq    $1, 24(%rsp)
.L6:
    movq    24(%rsp), %rax
    addq    %rax, 32(%rsp)
    subl    $2, 72(%rsp)
    je      .L4
    subl    $2, 104(%rsp)
    cmpl    $1, 72(%rsp)
    jne     .L5
    addq    $1, 32(%rsp)
.L4:
    movq    32(%rsp), %rax
    addq    %rax, 16(%rsp)
    subl    $2, 64(%rsp)
    je      .L2
    subl    $2, 108(%rsp)
    cmpl    $1, 64(%rsp)
    jne     .L3
    addq    $1, 16(%rsp)
.L2:
    movq    16(%rsp), %rax
    addq    $120, %rsp
    .cfi_remember_state
    .cfi_def_cfa_offset 56
    popq    %rbx
    .cfi_def_cfa_offset 48
    popq    %rbp
    .cfi_def_cfa_offset 40
    popq    %r12
    .cfi_def_cfa_offset 32
    popq    %r13
    .cfi_def_cfa_offset 24
    popq    %r14
    .cfi_def_cfa_offset 16
    popq    %r15
    .cfi_def_cfa_offset 8
    ret
    .p2align 4,,10
    .p2align 3
.L58:
    .cfi_restore_state
    addq    $1, %rbp
    jmp     .L18
    .cfi_endproc 
```

这比其他任何测试都快得多。gcc 将算法展开到一个显着的深度，而 GHC 和 LLVM 都没有，这在这里产生了巨大的差异。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-04T22:51:19.853

从使用更好的算法开始！

```
fibs = 0 : 1 : zipWith (+) fibs (tail fibs)

fib n = fibs !! n-1 
```

`fib 42`会给你更快的答案。

使用更好的算法比进行细微的速度调整更重要*。*

您可以使用这个定义（它的长度为 25801 位）愉快而快速地`fib 123456`在 ghci 中计算（即解释，甚至不编译）。您可能会让您的 C 代码计算得更快，但您将花费相当长的时间来编写它。这几乎没有花费我任何时间。我花了更多时间写这篇文章！

德：

1.  使用正确的算法！
2.  Haskell 让你编写干净的代码版本，简单地记住答案。
3.  有时，定义一个无限的答案列表并获取您想要的答案比编写一些更新值的循环版本更容易。
4.  哈斯克尔很棒。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-04T22:54:01.500

这是完全严格的。

```
g :: Int -> Int
g 0 = 0
g 1 = 1
g x = a `seq` b `seq` a + b where
   a = g $! x-1
   b = g $! x-2
main = print $! g 42 
```

`$!`与`$`（低优先级函数应用程序）相同，只是它在函数参数中是严格的。

`-O2`尽管我很好奇您为什么不想使用更好的算法，但您也需要编译。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-05T12:23:25.467

该功能已经非常严格。

函数严格的通常定义是，如果你给它未定义的输入，它本身就是未定义的。我从上下文假设您正在考虑不同的严格概念，即如果函数在产生结果之前评估其参数，则该函数是严格的。但通常检查一个值是否未定义的唯一方法是评估它，因此两者通常是等价的。

根据第一个定义，`g`肯定是严格的，因为它必须在知道要使用定义的哪个分支之前检查参数是否等于 0，所以如果参数未定义，`g`它会在尝试读取它时阻塞。

根据一个更非正式的定义，好吧，什么会`g`做错呢？前两个子句显然很好，这意味着当我们到达第三个子句时，我们必须已经评估了`n`。现在，在第三个子句中，我们增加了两个函数调用。更完整地说，我们有以下任务：

1.  减去 1`n`
2.  减去 2`n`
3.  调用`g`结果为 1。
4.  调用`g`结果为 2。
5.  将 3\. 和 4\. 的结果相加。

懒惰可能会稍微扰乱这些操作的顺序，但是由于两者都`+`需要`g`它们的参数值才能运行它们的代码，所以实际上没有任何东西可以延迟任何大量的东西，当然编译器可以自由地运行这些操作严格的顺序，如果它只能表明它`+`是严格的（它是内置的，所以不应该太难）并且`g`是严格的（但它*显然*是）。所以任何合理的优化编译器都不会对此有太大的麻烦，而且任何非优化的编译器都不会因为做完全幼稚的事情而产生任何显着的开销（这当然不像 的情况`foldl (+) 0 [1 .. 1000000]`）。

教训是，当一个函数立即将它的参数与某个东西进行比较时，该函数已经是严格的，任何体面的编译器都能够利用这一事实来消除通常的惰性开销。这并不意味着它将能够消除其他开销，例如启动运行时系统所花费的时间，这些开销往往会使 Haskell 程序比 C 程序慢一点。如果您只是查看性能数据，那么除了您的程序是严格还是懒惰之外，还有很多事情要做。

# excel - 如何让 Querytables 结果落在同一张纸上

> ID：13223714
> 
> 赞同：1
> 
> 时间：2012-11-04T22:42:59.130
> 
> 标签：excel, vba

当某些数据集包含 100 条记录时，我正在从一个站点提取数据，该站点一次将数据的呈现限制为 75 行
（为什么从来没有针对 ALL RECORDS 的选项）？

我可以安排我的循环来创建一个新工作表，但这会增加更多工作
，因为我必须单击多达 50 个工作表才能将工作表合并为一个。

到目前为止，我的脚本提取了数据，并设置了一个计数器来偏移
结果的位置，因此没有任何内容被覆盖。但是，在脚本完成后，我最终会得到
1500 个空白行，然后是数据集的最后几行。所以基本上我得到了 1000 个元素数据集的最后 75 行左右（一种情况下是 3 行）
不确定我在这里缺少什么。Querytables 是否总是将链接数据放在 $A$1 中？

编码：

```
Sub getHistoricalData()
Dim sheetname As String, url As String
Dim x_wsnames As Range
Dim ws As Worksheet, destinationRange As Range
Dim fillRange As Range, cell As Range, startCell As Range, endCell As Range
Dim operationalRange As Range, max As Integer
Dim last_objid As Integer, m As Integer
Dim startPage As Boolean, divider As String
On Error Resume Next

For Each x_wsnames In Sheets("data").Range("B2:B11")
'url = x_wsnames.Offset(0, 2).Value
max = x_wsnames.Offset(0, 2).Value
sheetname = x_wsnames.Value
'  Sheets.Add.Name = sheetname
Sheets(sheetname).Select
  Set ws = Sheets(sheetname)
  Select Case sheetname
    Case "A"
         position = "one"
    Case "B"
        position = "two"
    Case "C"
        position = "three"
    Case "D"
    position = "four"
  Case "E"
    position = "five"
  Case "F"
    position = "six"
   Case "G"
    position = "seven"
  Case "H"
    position = "eight"
  Case "I"
    position = "nine"
  Case "J"
    position = "ten"
End Select
Debug.Print "Processing cycleThroughWorksheets() " & sheetname

m = 0
For i = 1 To max
   url = "http://dataplace/search?category=type&dataType=historical&locations=ALL&d-112233-w=" & i & "&filter=" & divider

'Debug.Print i, url
If i = 1 Then
    Set destinationRange = Range("$A$1")
    Debug.Print destinationRange.Address
Else
    m = m + 75
    Set destinationRange = Range("$A$" & m)
    Debug.Print destinationRange.Address
End If
With ActiveSheet.QueryTables.Add(Connection:= _
    "URL;" & url, destination:= _
    destinationRange)
    .Name = sheetname
    .FieldNames = True
    .RowNumbers = False
    .FillAdjacentFormulas = False
    .PreserveFormatting = True
    .RefreshOnFileOpen = False
    .BackgroundQuery = True
    .RefreshStyle = xlInsertDeleteCells
    .SavePassword = False
    .SaveData = True
    .AdjustColumnWidth = True
    .RefreshPeriod = 0
    .WebSelectionType = xlEntirePage
    .WebFormatting = xlWebFormattingNone
    .WebPreFormattedTextToColumns = True
    .WebConsecutiveDelimitersAsOne = True
    .WebSingleBlockTextImport = False
    .WebDisableDateRecognition = False
    .WebDisableRedirections = False
    .Refresh BackgroundQuery:=False
End With
Next

Next 
End Sub 
```

# c# - 求一个范围内有多少个数可以被5整除

> ID：13223722
> 
> 赞同：-2
> 
> 时间：2012-11-04T22:44:45.817
> 
> 标签：c#

我的任务是：编写一个程序，读取两个正整数并打印它们之间存在多少个数字 p，这样除以 5 的提示符为 0（含）。示例：p(17,25) = 2。

```
Console.Write("Enter min: ");
            int min = int.Parse(Console.ReadLine());
            Console.Write("Enter max: ");
            int max = int.Parse(Console.ReadLine());
            Console.WriteLine("The numbers devidable by 5 without remainder from {0} to {1} are: ",min,max);
            for (int i = min; i <= max; i++)
            {
                if (i % 5 == 0)
                {

                    Console.WriteLine(i);
                }
            } 
```

这将打印出该范围内可被 5 整除的数字......我如何计算有多少并在控制台中打印计数？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-04T22:52:28.247

对于积极的论点，你可以在 O(1) 中做：

```
int DivisibleBy5From0To(int n)
{
    return (n / 5) + 1;
}

int DivisibleBy5FromTo(int lo, int hi)
{
    return DivisibleBy5From0To(hi) - DivisibleBy5From0To(lo - 1);
} 
```

对于可能不是积极的论点，您需要使用`Math.Floor(n / 5.0)`而不是`n / 5`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-04T22:49:28.130

也许：

```
int numMod5Between = Enumerable.Range(first, second - first + 1)
                               .Where(i => i % 5 == 0)
                               .Count(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-04T22:50:46.650

```
Console.WriteLine(Enumerable.Range(min,max-min+1).Count(n => n % 5 == 0)); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-04T22:48:13.730

```
 int total = 0;
        for (int i = min; i <= max; i++)
        {
            if (i % 5 == 0)
            {
                total = total + 1;
            }
        }
        //print total 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-04T22:49:22.443

这很容易，当您在 for 循环中有特殊情况时，只需在其中增加一个计数器。

```
 Console.Write("Enter min: ");
            int min = int.Parse(Console.ReadLine());
            Console.Write("Enter max: ");
            int max = int.Parse(Console.ReadLine());
            Console.WriteLine("The numbers devidable by 5 without remainder from {0} to {1} are: ",min,max);
            int count = 0;
            for (int i = min; i <= max; i++)
            {
                if (i % 5 == 0)
                {

                    Console.WriteLine(i);
                    count++;
                }
            }
            Console.WriteLine("Total number dividable by 5 is: " + count.ToString()); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-04T22:48:21.987

```
 int count=0;
    Console.Write("Enter min: ");
                int min = int.Parse(Console.ReadLine());
                Console.Write("Enter max: ");
                int max = int.Parse(Console.ReadLine());
                Console.WriteLine("The numbers devidable by 5 without remainder from {0} to {1} are: ",min,max);
                for (int i = min; i <= max; i++)
                {
                    if (i % 5 == 0)
                    {
                        count++;
                    }
                }
Console.WriteLine(count); 
```

您添加一个`count`变量，将其设置为 0，并在找到可分割的数字时将其增加，最后打印`count`.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-11-04T22:49:49.260

```
Console.Write("Enter min: ");
        int min = int.Parse(Console.ReadLine());
        Console.Write("Enter max: ");
        int max = int.Parse(Console.ReadLine());
        Console.WriteLine("The numbers devidable by 5 without remainder from {0} to {1} are: ",min,max);
        int count = 0;
        for (int i = min; i <= max; i++)
        {
            if (i % 5 == 0)
            {

                Console.WriteLine(i);
                count++;
            }
        }
        Console.WriteLine(count); 
```

新行是`int count = 0;`和`count++;`跟随`Console.WriteLine(count);`。逻辑是每次`i % 5 == 0`都是真的然后你增加计数。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-04-07T14:04:35.753

```
 Console.Write("Enter min: ");
        int min = int.Parse(Console.ReadLine());
        Console.Write("Enter max: ");
        int max = int.Parse(Console.ReadLine());
        Console.WriteLine("The numbers dividable by 5 without remainder from {0} to {1} are: ", min, max);
        for (int i = min; i <= max; i++)
        {
            if (i % 5 != 0)

            continue;
            Console.WriteLine(i); 
```

这是使用 continue 语句解决此问题的另一种方法。

# java - 我无法弄清楚的扫描仪错误：NoSuchElementException

> ID：13223723
> 
> 赞同：1
> 
> 时间：2012-11-04T22:44:49.950
> 
> 标签：java, exception, java.util.scanner

它在 do-while 循环内的第三行崩溃，并且不等待我的输入：

```
 input = kb.nextInt(); 
```

堆栈跟踪：

> 线程“主”java.util.NoSuchElementException 中的异常
> 
> 在 java.util.Scanner.throwFor（未知来源）
> 
> 在 java.util.Scanner.next（未知来源）
> 
> 在 java.util.Scanner.nextInt（未知来源）
> 
> 在 java.util.Scanner.nextInt（未知来源）
> 
> 在 main.MainDriver.main(MainDriver.java:50)

相关代码：

```
do
    {
        displayFullMenu();
        System.out.print("Selection: ");
        input = kb.nextInt();

        switch (input)
        {
        //Create new survey
        case 1:     currentSurvey = new Survey();
                    break;

        //Display current survey            
        case 2:     currentSurvey.display();
                    break;

        //Save current survey           
        case 3:     saveSurvey(currentSurvey);
                    break;

        //Load a survey
        case 4:     currentSurvey = loadSurvey();
                    break;

        //Modify a survey
        case 5:     currentSurvey.modify();
                    break;

        /*******************Test Functions*******************/

        //Create new test
        case 6:     currentSurvey = new Test();
                    break;

        //Display current test
        case 7:     currentSurvey.display();
                    break;

        //Save current test
        case 8:     saveSurvey(currentSurvey);
                    break;

        //Load a test
        case 9:     currentSurvey = loadTest();
                    break;

        //Modify a test
        case 10:    currentSurvey.modify();

        default:    System.out.println("Invalid choice. Please make a valid choice: ");
                    input = kb.nextInt();
                    System.out.println();
        }
    } while (input != 99);
    kb.close(); 
```

在我选择选项 9 后它崩溃了。它正确保存了文件，然后返回到循环的顶部，并在前面提到的行处崩溃。我希望它要求更多的输入。

是什么赋予了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T22:58:34.920

> 当我选择选项 8 时`saveSurvey()`，它必须创建一个新的 Scanner（在该方法中），因为所有这些都在我的 main 方法中。这可能是问题吗？

是的，这可能是问题所在。如果它与d`Scanner`具有相同的源（`System.in`？） ，则关闭底层流，并且无法再获取输入。`kb``close()``kb`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T23:04:37.913

我想到了。

整个问题是由于我没有在 main 中创建静态扫描仪引起的 - 当我在 main 之外的其他方法中需要它时，我创建了新的。

代替

```
public class MainDriver
{
    public static Scanner kb = new Scanner(System.in);
    public void main(String[] args) throws IOException 
   { 
```

我有：

```
public class MainDriver
{
    public static void main(String[] args) throws IOException 
    {
        public static Scanner kb = new Scanner(System.in); 
```

然后用其他方法创建新的扫描仪。在这些方法结束时，我关闭了扫描仪。我猜它正在关闭本地扫描仪，因为当我摆脱`close()`了其他方法中的所有语句时，问题就消失了。

# php - 带有文件的 PHP 数据库

> ID：13223728
> 
> 赞同：0
> 
> 时间：2012-11-04T22:45:02.457
> 
> 标签：php, database

例如，我有一个文件`.user1-info`，文件的内容是：

```
nick="Test"
password="403926033d001b5279df37cbbe5287b7c7c267fa"
join_date="1111111111"
rank="1" 
```

如何制作包含内容的数组以将其用作数据库？例如：

`echo $usr_info['nick']`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T22:50:09.847

我不怀疑您与数据库的关系。
要将文件中的数据转换为这种格式（我认为这是一种格式 .ini），您可以使用原生 php 函数[parse_ini_file](http://php.net/manual/pt_BR/function.parse-ini-file.php)。

```
// Parse without sections
$ini_array = parse_ini_file(".user1-info");
print_r($ini_array);

/*
Array
(
    [nick] => "Test"
    [password] => "403926033d001b5279df37cbbe5287b7c7c267fa"
    [pasjoin_dateword] => "1111111111"
    [rank] => "1"
)
*/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T22:51:13.800

您可以将其解析为`ini`文件，因为您的格式非常相似，请为此使用[parse_ini_file()](http://php.net/manual/en/function.parse-ini-file.php)，如下所示：

```
$usr_info = parse_ini_file($file_path); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T22:49:47.417

使用[explode](http://php.net/manual/en/function.explode.php)用等号分割每一行。

```
$array = explode("=", $line, 1); // splits only by first equal sign 
```

第一个数组元素将是您的键，第二个将非常接近您的值。

# xml - XML 到 XML 使用 XSLT php

> ID：13223734
> 
> 赞同：0
> 
> 时间：2012-11-04T22:45:44.990
> 
> 标签：xml, xslt

我想通过 xslt 使用 php 将 xml 文件转换为另一个文件。在输出上我需要一些调整，但我不知道如何调整我的 xsl 样式表。

谢谢你的帮助

需要对输出进行调整：

*   向类别元素添加动态计数，例如`<category1> <category2>`...
*   将 PRODUCT/COLORS/COLOR/AVAILABLE_SIZE 的元素 SIZE 的所有内容添加到`<$color>`类似元素`<green>S:M:L:XL</green> <orange>L:M</orange>`
*   向图像元素添加动态计数，例如`<image1> <image2>`

源代码：

```
<?xml version="1.0" encoding="utf-8"?>
<PRODUCTS>
 <PRODUCT>
  <CODE>19</CODE>
  <NAME>daisy</NAME>
  <MANUFACTURER>79</MANUFACTURER>
  <DESCRIPTION>t-shirt</DESCRIPTION>
  <SIZES></SIZES>
  <PRICE>33.33</PRICE>
  <PRICE_AKCIA>24.17</PRICE_AKCIA>
  <CATEGORY_ID>42</CATEGORY_ID>
  <CATEGORIES>
    <CATEGORY>clothes</CATEGORY>
    <CATEGORY>t-shirt</CATEGORY>
    <CATEGORY>latest</CATEGORY>
  </CATEGORIES>
  <COLORS>
   <COLOR>
    <NAME>green</NAME>
    <IMAGE>http://www.xyz.com/userfiles/daisy_green.png</IMAGE>
    <AVAILABLE_SIZES>
     <SIZE>S</SIZE>
     <SIZE>M</SIZE>
    </AVAILABLE_SIZES>
    <SIZES>
     <SIZE>S</SIZE>
     <SIZE>M</SIZE>
     <SIZE>L</SIZE>
     <SIZE>XL</SIZE>
    </SIZES>
   </COLOR>
   <COLOR>
    <NAME>orange</NAME>
    <IMAGE>http://www.xyz.com/userfiles/daisy_orange.png</IMAGE>
    <AVAILABLE_SIZES>
     <SIZE>L</SIZE>
     <SIZE>M</SIZE>
    </AVAILABLE_SIZES>
    <SIZES>
     <SIZE>S</SIZE>
     <SIZE>M</SIZE>
     <SIZE>L</SIZE>
     <SIZE>XL</SIZE>
    </SIZES>
   </COLOR>
  </COLORS>
 </PRODUCT>
</PRODUCTS> 
```

xsl 样式表：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" version="1.0" encoding="UTF-8" indent="yes"/>

<xsl:template match="/">
    <xsl:element name="products">
        <xsl:apply-templates select="PRODUCTS/PRODUCT"/>
    </xsl:element>
</xsl:template>

<xsl:template match="PRODUCTS/PRODUCT"> 
    <xsl:element name="product">
        <xsl:element name="id">
            <xsl:value-of select="CODE"/>
        </xsl:element>
        <xsl:element name="name">
            <xsl:value-of select="NAME"/>
        </xsl:element>
        <xsl:element name="model">
            <xsl:value-of select="CODE"/>
        </xsl:element>
        <xsl:element name="manufacturer">
            <xsl:value-of select="MANUFACTURER"/>
        </xsl:element>
        <xsl:element name="category_id">
            <xsl:value-of select="CATEGORY_ID"/>
        </xsl:element>
        <xsl:apply-templates select="CATEGORIES"/>
        <xsl:element name="description">
            <xsl:value-of select="DESCRIPTION"/>
        </xsl:element>
        <xsl:element name="price">
            <xsl:value-of select="PRICE"/>
        </xsl:element>
        <xsl:element name="special">
            <xsl:value-of select="PRICE_AKCIA"/>
        </xsl:element>
        <xsl:apply-templates select="COLORS/COLOR"/>
        <xsl:apply-templates select="COLORS"/>
    </xsl:element>
</xsl:template>

<xsl:template match="CATEGORIES">
    <xsl:for-each select="CATEGORY">    
      <xsl:element name="category">
        <xsl:value-of select="."/>
      </xsl:element>
    </xsl:for-each>
</xsl:template>

<xsl:template match="COLORS">
    <xsl:for-each select="COLOR/NAME">    
      <xsl:variable name="color" select="." />
      <xsl:element name="{$color}">
        <xsl:apply-templates select="COLOR/AVAILABLE_SIZES"/>
      </xsl:element>
    </xsl:for-each>
</xsl:template>

<xsl:template match="COLORS/COLOR">
    <xsl:for-each select="IMAGE">    
      <xsl:element name="image">
        <xsl:value-of select="."/>
      </xsl:element>
    </xsl:for-each>
</xsl:template>

<xsl:template match="COLOR/AVAILABLE_SIZES">
    <xsl:for-each select="SIZE">    
      <xsl:value-of select="."/>:
    </xsl:for-each>
</xsl:template>

</xsl:stylesheet> 
```

结果：

```
<?xml version="1.0" encoding="UTF-8"?>
<products>
  <product>
    <id>19</id>
    <name>daisy</name>
    <model>19</model>
    <manufacturer>79</manufacturer>
    <category_id>42</category_id>
    <category>clothes</category>
    <category>t-shirt</category>
    <category>latest</category>
    <description>t-shirt</description>
    <price>33.33</price>
    <special>24.17</special>
    <image>http://www.xyz.com/userfiles/daisy_green.png</image>
    <image>http://www.xyz.com/userfiles/daisy_orange.png</image>
    <green/>
    <orange/>
  </product>
</products> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T09:32:35.117

如果要动态命名元素，可以使用属性值模板来指定元素名称。

所以，如果你想要**category1**、**category2**等，而不仅仅是**category**你会这样做

```
 <xsl:element name="category{position()}"> 
```

花括号表示这是一个要计算的表达式。

但是，如果您直接使用图像代码执行此操作，您会看到它们都以 1 为后缀。

```
<xsl:template match="COLORS/COLOR">
    <xsl:for-each select="IMAGE">    
      <xsl:element name="image{position()}">
        <xsl:value-of select="."/>
      </xsl:element>
    </xsl:for-each>
</xsl:template> 
```

这是因为您正在获取**IMAGE**元素在**COLOR**元素中的位置。你真的想要父**COLOR**元素的位置。**相反，在这里匹配COLORS**元素可能会更好，然后您可以获得**COLOR**元素的位置。

```
<xsl:template match="COLORS">
    <xsl:for-each select="COLOR">    
      <xsl:element name="image{position()}">
        <xsl:value-of select="IMAGE"/>
      </xsl:element>
    </xsl:for-each>
</xsl:template> 
```

当然，这意味着您最终会得到两个匹配**颜色**的模板，因此您可能希望将它们组合起来。但是，另一个模板存在问题。您正在迭代**COLOR/NAME**，这意味着您将定位在循环内的**NAME**元素上。因此，当您尝试选择**COLOR/AVAILABLE_SIZES**时，它会在当前元素下方寻找它们，但它们不存在。你可能应该这样做

```
<xsl:template match="COLORS">
    <xsl:for-each select="COLOR">    
      <xsl:variable name="color" select="NAME" />
      <xsl:element name="{$color}">
        <xsl:apply-templates select="AVAILABLE_SIZES"/>
      </xsl:element>
    </xsl:for-each>

    <!-- Code to do images from above -->
</xsl:template> 
```

还有几件事需要注意。如果你想要动态元素名称（如上所示），你只需要使用**xsl:element ，否则直接输出元素。**

此外，在许多情况下，您所做的只是将大写名称转换为小写。有一个通用模板可能会更简单

```
<xsl:template match="*">
   <xsl:element name="{translate(
         local-name(), 
         'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 
         'abcdefghijklmnopqrstuvwxyz')}">
      <xsl:apply-templates />
     </xsl:element>
</xsl:template> 
```

这将减少您需要编写的代码。当您想将元素名称更改为完全不同的名称时，您只需要特定的模板。

尝试以下 XSLT

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" version="1.0" encoding="UTF-8" indent="yes"/>

   <xsl:template match="*">
      <xsl:element name="{translate(local-name(), 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz')}">
         <xsl:apply-templates/>
      </xsl:element>
   </xsl:template>

   <xsl:template match="CODE">
      <id>
         <xsl:value-of select="."/>
      </id>
   </xsl:template>

   <xsl:template match="PRICE_AKCIA">
      <special>
         <xsl:value-of select="."/>
      </special>
   </xsl:template>

   <xsl:template match="CATEGORIES">
      <xsl:for-each select="CATEGORY">
         <xsl:element name="category{position()}">
            <xsl:value-of select="."/>
         </xsl:element>
      </xsl:for-each>
   </xsl:template>

   <xsl:template match="COLORS">
      <xsl:for-each select="COLOR">
         <xsl:variable name="color" select="NAME"/>
         <xsl:element name="{$color}">
            <xsl:apply-templates select="AVAILABLE_SIZES"/>
         </xsl:element>
      </xsl:for-each>
      <xsl:for-each select="COLOR">
         <xsl:element name="image{position()}">
            <xsl:value-of select="IMAGE"/>
         </xsl:element>
      </xsl:for-each>
   </xsl:template>

   <xsl:template match="AVAILABLE_SIZES">
      <xsl:for-each select="SIZE">
         <xsl:if test="position() > 1">:</xsl:if>
         <xsl:value-of select="."/>
      </xsl:for-each>
   </xsl:template>
</xsl:stylesheet> 
```

应用于您的示例 XML 时，将输出以下内容

```
<products>
   <product>
      <id>19</id>
      <name>daisy</name>
      <manufacturer>79</manufacturer>
      <description>t-shirt</description>
      <sizes/>
      <price>33.33</price>
      <special>24.17</special>
      <category_id>42</category_id>
      <category1>clothes</category1>
      <category2>t-shirt</category2>
      <category3>latest</category3>
      <green>S:M</green>
      <orange>L:M</orange>
      <image1>http://www.xyz.com/userfiles/daisy_green.png</image1>
      <image2>http://www.xyz.com/userfiles/daisy_orange.png</image2>
   </product>
</products> 
```

# c - 是否可以暂停/恢复部分全双工连接？

> ID：13223736
> 
> 赞同：0
> 
> 时间：2012-11-04T22:45:54.787
> 
> 标签：c, ruby, sockets, select

是的，不是吗？

我怎样才能实现这样的目标：

**在客户端**

```
loop do
    socket.read(MAX_LEN)
    socket.pause_read   # the client is busy, do not send any more data, similar to: C system call shutdown(sock, SHUT_RD)
    # ... working

    socket.resume_read  # the client is ready to work again. 
end 
```

**在服务器端**

```
loop do
    rd, wr, _ = select(rdsockets, wrsockets)
    # wr is an array fill of clients ready to work
    wr.each {}
end 
```

PS：可以使用 C 或 Ruby 提供帮助。先感谢您。

编辑：传入数据具有预定义的格式，并且传入数据的长度会有所不同。

EDIT2：操作系统：Linux

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T23:17:47.820

如果你什么都不做，它就已经是这样了。“做工作”需要一些时间，所以客户端`read`在完成之前不会再次调用。服务器将继续发送数据一段时间，直到客户端的接收缓冲区（系统 TCP 实现的一部分）填满；那么服务器将被限制并且`select`不会将该客户端返回为可写的。总体效果是，对于长期连接，服务器只会以客户端可以处理的速度发送数据。

如果您需要对客户端接收缓冲区的大小进行细粒度控制，可以使用[setsockopt](http://pubs.opengroup.org/onlinepubs/007904875/functions/setsockopt.html) ( `SO_RCVBUF`, *size* )。

# python - 如何在python中读取其他目录中的文件

> ID：13223737
> 
> 赞同：32
> 
> 时间：2012-11-04T22:46:02.957
> 
> 标签：python

我在名为 `5_1.txt`的目录中有一个名为 的文件`direct`，如何使用 读取该文件`read`？

我使用以下方法验证了路径：

```
import os
os.getcwd()
os.path.exists(direct) 
```

结果是
真

```
x_file=open(direct,'r') 
```

我得到了这个错误：

```
Traceback (most recent call last):
File "<pyshell#17>", line 1, in <module>
x_file=open(direct,'r')
IOError: [Errno 13] Permission denied 
```

我不知道为什么我无法读取文件？有什么建议么？

谢谢 。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-11-04T23:01:15.757

看起来您正试图打开一个*目录*进行读取，就好像它是一个常规文件一样。许多操作系统不会让你这样做。无论如何你都不需要，因为你想要的（从你的描述来看）是

```
x_file = open(os.path.join(direct, "5_1.txt"), "r") 
```

或者干脆

```
x_file = open(direct+"/5_1.txt", "r") 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-11-04T22:57:12.357

如果您不在指定目录中（即直接），则应使用（在 linux 中）：

```
x_file = open('path/to/direct/filename.txt') 
```

请注意引号和目录的相对路径。

这可能是您的问题，但您也无权访问该文件。也许您正试图以其他用户身份打开它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-04T23:00:15.573

您不能使用该功能“打开”*目录。*`open`这个函数是用来打开*文件*的。

在这里，您要做的是打开*目录*中的*文件*。您必须做的第一件事是计算此文件的路径。该函数将允许您通过连接部分路径（目录和文件名）来做到这一点：*`os.path.join`*

 *```
fpath = os.path.join(direct, "5_1.txt") 
```

然后您可以打开该文件：

```
f = open(fpath) 
```

并阅读其内容：

```
content = f.read() 
```

* * *

此外，我相信在 Windows 上，`open`在目录上使用确实会返回`PermissionDenied`异常，尽管情况并非如此。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-05T00:25:47.840

我发现这种方式也很有用。

```
import tkinter.filedialog
from_filename = tkinter.filedialog.askopenfilename() 
```

这里会出现一个窗口，您可以浏览直到找到该文件，然后单击它，然后您可以继续使用打开和阅读。

```
from_file = open(from_filename, 'r')
contents = from_file.read()
contents 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-04-21T10:36:35.840

**对于 Windows**，您可以使用带有 '\\' 的完整路径（**Linux 和 Mac 的为**'/' ）作为分隔符，您可以使用 os.getcwd 来获取当前工作目录并提供参考当前工作目录的路径

```
data_dir = os.getcwd()+'\\child_directory'
file = open(data_dir+'\\filename.txt', 'r') 
```

当我试图完全给出 child_diectory 的路径时，它导致了错误。例如在这种情况下：

```
file = open('child_directory\\filename.txt', 'r') 
```

结果出错。但我认为它必须有效，否则我的做法有些错误，但它对我不起作用。about 方法总是有效的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-04T22:52:39.713

正如错误消息所说，您的应用程序无权从目录中读取。当您作为一个用户创建目录并作为另一个用户运行脚本时，可能会出现这种情况。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-09-01T22:18:36.423

对于像我这样查看已接受答案但不理解为什么它不起作用的人，您需要在子目录周围添加引号，在绿色选中的示例中，

```
x_file = open(os.path.join(direct, "5_1.txt"), "r") 
```

实际上应该是

```
x_file = open(os.path.join('direct', "5_1.txt"), "r") 
```*

# eclipse - GWT Eclipse 未编译最新的代码更改

> ID：13223741
> 
> 赞同：2
> 
> 时间：2012-11-04T22:46:35.920
> 
> 标签：eclipse, gwt, compilation

在 Eclipse 中创建了一个新的 GWT 项目，并使用了它附带的“生成的示例代码”。编译我的代码很好，我在 Chrome 中运行它没有问题。

现在，当我更改代码中的任何内容时，这些更改不会反映在页面上。

我清理+重新编译代码。我也刷新了网页。没有什么。

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T12:10:11.950

在将代码部署到服务器之前，您不必重新编译代码，尝试在开发模式下运行。使用选项作为 Web 应用程序运行或作为 Web 应用程序调试。每次您进行更改时，您都必须重新加载 gwt 模块，以便停止您的项目并再次运行，如我上面所说

# ruby - RubyGems 安装失败的 Ubuntu 11.04

> ID：13223743
> 
> 赞同：0
> 
> 时间：2012-11-04T22:46:59.293
> 
> 标签：ruby, rubygems, installation

我正在尝试在 Ubuntu 11.04 中安装 ruby​​gems1.8

我做了

```
sudo apt-get install rubygems1.8 
```

然后当我这样做

```
gem install rubygems-update 
```

我明白了

> 该程序`gem`当前未安装。您可以通过键入以下内容来安装它：
> 
> ```
> sudo apt-get install rubygems1.8 
> ```

我试着再做`sudo apt-get install rubygems1.8`一次，我得到了

> rubygems1.8 已经是最新版本了

就我浏览互联网而言，这种方法似乎对每个人都有效。任何故障排除的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T04:08:08.893

引用[http://ryanbigg.com/2010/12/ubuntu-ruby-rvm-rails-and-you/](http://ryanbigg.com/2010/12/ubuntu-ruby-rvm-rails-and-you/)（反过来引用[这个](http://news.ycombinator.org/item?id=2039438)）：

> 在任何情况下，您都不应从 apt-get 安装 Ruby、Rubygems 或任何与 Ruby 相关的软件包。这个系统已经过时，并导致严重的头痛。对于与 Ruby 相关的软件包，请避免使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T03:15:13.767

如果您在此处搜索有关从 安装 ruby​​ 的任何问题`apt-get`，它们都是一样的。使用[RVM](https://rvm.io/rvm/install/)。

# html - HTML 选择元素中选项的位置

> ID：13223745
> 
> 赞同：3
> 
> 时间：2012-11-04T22:47:09.230
> 
> 标签：html, css

我有一个包含选项的元素。该元素的宽度为 150 像素，但有些选项更宽。所以在渲染的时候，浏览器会向右显示溢出。如何使选项列表溢出到左侧？**[JSFiddle](http://jsfiddle.net/bG4Jw/1/)** 选择位于右上角的 div 内，并溢出到左侧。

谢谢。

```
<select id="MySelect">
      <option value="60" selected="selected"></option><option value="-60">(UTC-01:00) Azores</option>
      <option value="-60">(UTC-01:00) Cape Verde Is.</option><option value="0">(UTC) Casablanca</option>
      <option value="0">(UTC) Dublin, Edinburgh, Lisbon, London</option><option value="0">(UTC) Monrovia, Reykjavik</option>
      <option value="60">(UTC+01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague</option>
      <option value="60">(UTC+01:00) Brussels, Copenhagen, Madrid, Paris</option>
      <option value="60">(UTC+01:00) Sarajevo, Skopje, Warsaw, Zagreb</option>
      <option value="60">(UTC+01:00) West Central Africa</option>
      <option value="120">(UTC+01:00) Windhoek</option>
</select>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​

​#MySelect{
    margin-top:20px;
    margin-left:200px;
    width:150px;}​​​ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T22:59:44.740

```
#MySelect{
    margin-top:20px;
    margin-left:300px;
    width:150px;
    direction: rtl;
} 
```

这是一种非常老套的方法，但它确实有效。我想不出别的办法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T22:59:26.273

你可以使用

```
<select id="MySelect" dir="rtl"> 
```

# azure - 在本地调试 Azure Web 角色时，是否可以编辑站点内容？

> ID：13223749
> 
> 赞同：0
> 
> 时间：2012-11-04T22:47:17.853
> 
> 标签：azure

基本上我正在尝试加快开发速度，似乎如果我想修复一个 javascript 错误或更新一些 CSS，我必须完全停止部署，进行更改，然后再次部署到本地模拟器，最后导航到哪里我曾是。

我无法在模拟器之外运行这个项目，因为我正在使用新的同位缓存选项。

我觉得我在这里错过了一些简单的东西。我注意到我可以启动模拟器（30 秒左右），然后直接在 web 项目上启动第二个调试会话（另外 10 秒），它似乎可以与模拟器交谈，至少是这样远的。这更好，但仍然很痛苦。

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T00:09:36.520

如果您谈论的是 Visual Studio 和 ASP.NET，那么这一切都应该可以正常工作。如果您正在更改 JavaScript 或 CSS 之类的静态文件，您应该能够只保存然后查看结果。如果要更改代码，则需要重新构建 Web 角色项目（*而不是*云服务项目），并且在刷新时应该会显示更改。当然，要使其正常工作，您必须按 Ctrl+F5（无需调试即可运行）...否则您将根本无法进行更改。

# assembly - 汇编 - 算术右移 (Sar)

> ID：13223756
> 
> 赞同：1
> 
> 时间：2012-11-04T22:47:58.590
> 
> 标签：assembly, sar

> **可能重复：**
> [X86 程序集中带有一个参数的 SAR 命令](https://stackoverflow.com/questions/12813962/sar-command-in-x86-assembly-with-one-parameter)

当 sar 指令中只有源参数而没有目标参数时，这意味着什么？

例如：`sar %eax`，通常什么时候指令是类型`sar source, destination`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T22:52:13.763

它与 SAR EAX,1 相同。

“看起来反编译器使用 SAR EAX,1 的简写，其操作码为 0xD1F8。当立即数不是 1 时，即 SAR EAX,xx，操作码为 0xC1F8 xx，请参阅英特尔指令参考，第 2B 卷， 4-353。” 来源-> [http://www.tinyguru.com/error/qid12813962.html](http://www.tinyguru.com/error/qid12813962.html)

# post - 使用 cURL 进行 POST 但服务器显示 GET

> ID：13223757
> 
> 赞同：1
> 
> 时间：2012-11-04T22:47:58.700
> 
> 标签：post, curl, get

我正在尝试做一个简单的 POST。我正在使用下面的代码，但是当我查看服务器日志时，它显示它正在执行 POST 而不是 GET。知道为什么吗？代码如下。

谢谢，马克

```
$url = 'http://www.mydomain.com/api.php';
$ch = curl_init();
$data = array('name' => 'Foo', 'file' => '@path\file.jpg');

  $headers = array(
    'Content-Type: image/jpeg'
  );

curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_TIMEOUT, '3');
curl_setopt($ch, CURLOPT_HEADER      ,1);

curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);
curl_setopt($ch, CURLOPT_POSTFIELDS, $data);

$result = curl_exec( $ch ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T08:58:05.003

我猜您的标头会混淆服务器，如果您需要将其发布为 multipart/form-data，请不要设置标头，并将您的数据数组更改为此，它应该会有所帮助。

```
$data = array('name' => 'Foo', 'file' => '@path\file.jpg;type=image/jpeg'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T22:51:54.060

只要你有这条线：

```
 curl_setopt($ch, CURLOPT_POST, 1); 
```

这将是一个 POST 请求。如果您删除该行，它将是一个 GET 请求...然后您需要将数据放入查询中。

# javascript - 生成的解析器为 Node.js 上的转义引号引发错误

> ID：13223758
> 
> 赞同：2
> 
> 时间：2012-11-04T22:48:00.613
> 
> 标签：javascript, node.js, parser-generator, peg

我正在使用[PEG.js](http://pegjs.majda.cz/)创建一个包含解析字符串的解析器。
包含任何类型字符的字符串都用引号括起来`"`，并且可能包含转义引号`\"`。
到目前为止，我有以下规则：

```
start
    = ["] string:(( '\\"' {return '"';} / [^"])*) ["]
        {return string.join('');} 
```

它适用于[PEG.js 在线版本](http://pegjs.majda.cz/online)并`"abc\"def"`为给定的输入生成`"abc\"def"`。

为带有 PEG.js 版本 0.7.0 的 Node.js 版本 0.6.21 生成的解析器按以下方式执行

```
var result = parser.parse('"abc\"def"'); 
```

并产生以下错误：

```
{ name: 'SyntaxError',
  expected: [],
  found: 'd',
  message: 'Expected end of input but "d" found.',
  offset: 5,
  line: 1,
  column: 6 } 
```

但是，使用`\\"`而不是`\"`成功并获得预期的输出。

```
var result = parser.parse('"abc\\"def"'); // parses correctly 
```

这个问题有解释或解决方法吗？特别是，我不可能对解析器的预期输入中的所有引号进行双重转义。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T22:55:50.940

此语句中的字符串文字...

`var result = parser.parse('"abc\"def"');`

...实际上不包含反斜杠。在 JavaScript 中，这一系列符号 - `\"`- 被解析为单个 - `"`- 无论使用什么引号来分隔字符串 - 双引号或单引号。JS 不会在字符串中插入变量和表达式，它们之间基本上没有区别。

这个字符串 - `'"abc\\"def"'`- 然而，有一个反斜杠：它是由那个`\\`序列编码的。请注意，不必使用另一个反斜杠来转义双引号本身（因为分隔符是单引号）。但是，如果`"\"abc\\\"def\""`使用表单，您就必须这样做。

# powershell - 使用 Powershell 比较 xml 结构

> ID：13223765
> 
> 赞同：3
> 
> 时间：2012-11-04T22:48:44.097
> 
> 标签：powershell

我有两个 xml 配置文件，我只需要比较两个文件的结构并显示差异。请注意：比较时，应忽略 xml 节点内的值。

前任：

```
XML 1 
----
<recipe>
  <ingredients>
      <ingredient1></ingredient1><ingredient2></ingredient2>
  </ingredients>
  <description></description>
</recipe>

XML 2
-----
<recipe>
  <ingredients>
    <ingredient1></ingredient1>
  </ingredients>
  <description></description>
  <images></images>
</recipe> 
```

结果应该是两个 xml 文件的差异。

```
xml1 <ingredient2>
xml2 <images> 
```

非常感谢帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-05T09:25:09.787

我能想到的最快的解决方案是：

```
[xml]$xml1 = @"
<recipe>
  <ingredients>
      <ingredient1>
      </ingredient1>
      <ingredient2>
      </ingredient2>
  </ingredients>
  <description></description>
</recipe>
"@

[xml]$xml2 = @"
<recipe>
  <ingredients>
    <ingredient1>dada</ingredient1>
  </ingredients>
  <description>dadad</description>
  <images></images>
</recipe>
"@

$docDiffs=Compare-Object ($xml1.SelectNodes("//*") | Select-Object -Expand Name) ($xml2.SelectNodes("//*") | Select-Object -Expand Name) 

$docDiffs 
```

您需要做一些工作才能获得所需的确切格式，但主要工作已经完成。如果您想改进它，您可以考虑使用 Select-XML 替代。

# java - 在 Python 中解密用 Java 加密的字符串

> ID：13223772
> 
> 赞同：2
> 
> 时间：2012-11-04T22:49:22.553
> 
> 标签：java, python, encryption, aes

我正在使用 Python 开发一个服务器应用程序，以及一个用 Java 连接到它的应用程序。我需要在 Java 中加密字符串，然后在 Python 中解密。

Java 代码一切正常，但 Python 代码存在问题。

```
from Crypto.Cipher import AES
obj        = AES.new('0123456789abcdef', AES.MODE_CBC,IV="fedcba9876543210")
BLOCK_SIZE = 16
PADDING    = " "
pad        = lambda s: s + (BLOCK_SIZE - len(s) % BLOCK_SIZE) * PADDING
plain      = "password"
plain      = pad (plain)
ciph       = obj.encrypt(plain)
obj        = AES.new('0123456789abcdef', AES.MODE_CBC,IV="fedcba9876543210")
decrypted  = obj.decrypt(ciph)
result     = ""
for char in ciph:
    result += str((hex(ord(char))))[2:]
print result
print decrypted 
```

结果是：

```
2af41fc02b33765b56433f59edb67dd3
password 
```

这是我所期望的并与 Java 输出匹配，但是当我插入两行中的第一行以在 Python 代码中对其进行解密时，输出完全关闭并显示随机字符。我认为这是由于最后的 for 循环使其与 Java 输出相同。有没有办法撤消那个for循环？同样使用至少与此类似的代码是否有一种不错的方法来解密两个输出字符串中的第一个字符串（在 Python 中）？

感谢所有回复，提前感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T23:12:37.340

中的每一对数字`result`都是十六进制字符的字符代码。这是一个重现转换并撤消它的片段（有更优雅的方法可以做到这一点，但它很简单并且有效）。

```
import re

ciph = "hello there"
result = ""
for c in ciph:
    result += str((hex(ord(c))))[2:]

# reverse it
orig = ""
for code in re.findall('..', result):
    orig += chr(int(code, 16))
print orig  # "hello there" 
```

# file - 按日期命名的批量生产文件

> ID：13223773
> 
> 赞同：-1
> 
> 时间：2012-11-04T22:49:25.843
> 
> 标签：file, rename, autohotkey, autoit

使用 AutoHotkey 或 AutoIt 我需要创建（并命名）日期格式的数据库 (.db) 文件。

文件应命名为`January/01/2000.db`,`January/02/2000.db`等。直到现在；每天一个新文件。

此外，创建的文件需要位于与文件同名的新文件夹中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-05T01:53:23.727

**January/01/2000.db**不是有效的文件名，而是文件夹路径！下面的 AutoHotkey 片段可以做到这一点：

```
#SingleInstance, Force
SetWorkingDir %A_ScriptDir%  
SetBatchLines -1

DatB := 20000101000000
DatE := SubStr( A_Now,1,8 ) . "000000"
While ( DatB <= DatE ) {
 FormatTime, DT, %DatB%, MMMM\dd
 FormatTime, YY, %DatB%, yyyy
 DatB += 1, Day
 FileCreateDir, %A_ScriptDir%\%DT%
 FileAppend,, %DT%\%YY%.db
} 
```

# sql - XML 解析错误：将值插入表时出现“预期的字符串文字”

> ID：13223781
> 
> 赞同：3
> 
> 时间：2012-11-04T22:50:30.700
> 
> 标签：sql, xml, sql-server-2008, tsql, insert

在 Microsoft SQL Server 2008 中，我试图将值插入到带有**数据类型 int 的列 type_id 和数据**类型**XML 的 xml_info**的 sql 表中。我正在使用以下查询：

```
INSERT INTO tbl_applied_devices ([type_id],[xml_info])
VALUES (1,'<Profile ID=99><Server><ID>BC4A18CA-AFB5-4268-BDA9-C990DAFE7783</ID>  <Name>localhost</Name><Services></Services></Server></Profile>') 
```

但我不断收到此错误：

> 消息 9413，级别 16，状态 1，第 4
> 行 XML 解析：第 1 行，字符 13，应为字符串文字

我做错了什么？

**编辑：** 我发现错误的来源是 xml 元素的 ID 属性，`<Profile ID=99>`似乎是导致错误的原因。如何正确插入带有属性的 xml？我需要以某种方式逃避其中一个角色吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-04T23:21:51.330

XML 文档本质上是**文本的。**这不是网页的 HTML，因此您需要引号中的所有属性值（单引号或双引号）。

```
INSERT INTO tbl_applied_devices ([type_id],[xml_info])
VALUES (1,'<Profile ID="99"><Server><ID>BC4A18CA-AFB5-4268-BDA9-C990DAFE7783</ID>  <Name>localhost</Name><Services></Services></Server></Profile>') 
```

解析[XML 1.0 规范非常困难，但这里有一个适用于](http://www.w3.org/TR/REC-xml/)[.Net 4.5](http://msdn.microsoft.com/en-us/library/ms256152.aspx)的 Microsoft 版本，它与 SQL Server XML 一样相关。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-04T23:20:32.830

属性，ID是一个属性，必须加引号。试试 ID="99"

# c++ - C++、数组声明、模板、链接器错误

> ID：13223782
> 
> 赞同：0
> 
> 时间：2012-11-04T22:50:44.320
> 
> 标签：c++, templates, linker-errors

我的软件中有链接器错误。我正在使用以下基于 h、hpp、cpp 文件的结构。有些类是模板化的，有些不是，有些有函数模板。SW 包含数百个包含的类...

宣言：

```
test.h
#ifndef TEST_H
#define TEST_H

class Test
{
   public: 
        template <typename T>
        void foo1();

        void foo2 ();
};

#include "test.hpp" 

#endif 
```

定义：

```
test.hpp
#ifndef TEST_HPP
#define TEST_HPP

template <typename T>
void Test::foo1() {}

inline void Test::foo2() {} //or in cpp file

#endif 
```

CPP 文件：

```
test.cpp
#include "test.h"

void Test::foo2() {} //or in hpp file as inline 
```

我有以下问题。变量 vars[] 在我的 h 文件中声明

```
test.h
#ifndef TEST_H
#define TEST_H

char *vars[] = { "first", "second"...};

class Test
{
    public: void foo();
};

#include "test.hpp"

#endif 
```

并用作在 hpp 文件中作为内联定义的 foo() 方法内的局部变量。

```
test.hpp
#ifndef TEST_HPP
#define TEST_HPP

inline void Test::foo() {
    char *var = vars[0];   //A Linker Error
}

#endif 
```

但是，会发生以下链接器错误：

```
Error   745 error LNK2005: "char * * vars" (?vars@@3PAPADA) already defined in main.obj 
```

如何以及在何处声明 vars[] 以避免链接器错误？包括后

```
#include "test.hpp" 
```

声明已经晚了……

正如我所写，该软件包含很多cpp，并且hpp文件相互包含（所有包含都已检查）。无法发送整个示例...

main.obj 代表一个包含主类的文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T23:07:16.257

`vars`使用外部链接在标题中声明

```
extern const char* vars[]; 
```

并将其定义在一个源文件中

```
const char* vars[] = {"foo", "bar"}; 
```

请注意`const`，从字符串文字到的转换`char*`已被弃用。你现在拥有它的方式，你违反了[一个定义规则](https://stackoverflow.com/questions/4192170/what-exactly-is-one-definition-rule-in-c)（你在`vars`你的标题包含的每个翻译单元中重新定义）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T23:06:11.470

我认为您只需要在 test.hpp

```
extern char *vars[]; 
```

...这在 test.cpp

```
char *vars[] = { "first", "second"...}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T23:04:35.263

我假设您没有声明两个名为`Test`. 如果你是，那将给你带来无穷无尽的问题。你不能这样做。

所以我假设完整的声明`class Test`看起来像这样：

```
class Test
{
 public:
   void foo();

   template <typename T>
   void foo1();

   void foo2 ();
}; 
```

如果是这种情况，那么你的问题就很清楚了。

您需要更改`vars`. 你需要有这个`test.h`：

```
extern char *vars[]; 
```

这在`test.cpp`：

```
char *vars[] = { "first", "second"...}; 
```

否则编译器会认为你试图`vars`在每个文件中声明一个新版本。

# sencha-touch-2 - sencha dataitem 数据映射 setItems

> ID：13223786
> 
> 赞同：0
> 
> 时间：2012-11-04T22:51:00.250
> 
> 标签：sencha-touch-2

我正在尝试遵循此处给出的小猫示例 [http://www.sencha.com/blog/dive-into-dataview-with-sencha-touch-2-beta-2#comment_form](http://www.sencha.com/blog/dive-into-dataview-with-sencha-touch-2-beta-2#comment_form)

我有复杂的组件，其中我的数据属性之一是对象列表。我正在使用 setItems 方法将我的列表对象映射到 Ext.Container。但是，它似乎不起作用。在警报点，我将对象视为未定义。但是如果我将 setItems 更改为 setText，那么我会得到对象的字符串表示形式。有人对我缺少什么有任何建议吗？

```
Ext.define('MyListItem', {

    extend: 'Ext.dataview.component.DataItem',
    requires: ['Ext.Container'],
    xtype: 'mylistitem',   

    config: {
        sponsor: true,
        dataMap: {
            getSponsor: {
                setItems: 'sponsor'
            }
        }
    },

    applySponsor: function(config) {
        // I put an alert here to see if I get getSponsor() but the object I get here is undefined
        alert(this.getSponsor());
        return Ext.factory(config, Ext.Container, this.getSponsor());
    },

    updateSponsor: function(newNameButton, oldNameButton) {
        if (oldNameButton) {
            this.remove(oldNameButton);
        }

        if (newNameButton) {
            this.add(newNameButton);
        }
    },

    onSponsorTap: function(button, e) {
        var sponsors = record.get('sponsor');
        //my specific action
    }
});

Ext.define('MyApp.model.Sponsors', {
    extend: 'Ext.data.Model',
    xtype:'Sponsors_m',
    config: {
        fields: [
            {name: 'level', type: 'auto'},
            {name: 'id', type: 'int'},
            {name: 'sponsor', type: 'Sponsor'}
        ]
    }
});

Ext.define('MyApp.model.Sponsor', {
    extend: 'Ext.data.Model',
    xtype:'Sponsor_m',
    config: {
        fields: [
            {name: 'name', type: 'auto'},
            {name: 'image', type: 'auto'},
            {name: 'url', type: 'auto'},
            {name: 'description', type: 'auto'}
        ]
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T08:18:02.940

唔...

您的模型中没有任何名为“赞助商”的字段

```
config: {
    sponsor: true,
    dataMap: {
        getSponsor: {
            ***setItems: 'sponsor'*** //this supposed to map your component to the datafield
        }
    }
}, 
```

尝试将粗体字体更改为您的字段名称（setItems：'name'）

如果我没记错的话，更新方法的参数命名有严格的规定，即：***以“赞助商”作为配置名称的示例

> 新赞助商，旧赞助商

所以赞助商的更新方法应该是：

```
updateSponsor: function(**newSponsor**, **oldSponsor**) {
        if (oldSponsor) {
            this.remove(oldSponsor);
        }

        if (newSponsor) {
            this.add(newSponsor);
        }
    }, 
```

# html - 使用 form method=get 删除尾随问号

> ID：13223812
> 
> 赞同：5
> 
> 时间：2012-11-04T22:53:00.797
> 
> 标签：html, forms, button

当我单击它时，我正在使用表单按钮将我发送到一个页面[http://example.com/folder/upload/](http://example.com/folder/upload/)但由于某种原因，当我单击该按钮时，它会在末尾添加一个尾随问号，如下所示：[http://example.com/folder/upload/](http://example.com/folder/upload/)？

我当前的代码如下所示：

```
<form method="get" action="http://example.com/folder/upload/"><button type="submit" class="green button"><i  class="photo" ></i></button></form> 
```

如何在不使用 method="post" 的情况下摆脱问号，因为我希望用户能够在不弹出确认表单重新提交对话框的情况下刷新页面。

是否有另一种方法可以在不使用 method="post" 的情况下解决此问题？

如果可能的话，我更喜欢不使用 onclick 或任何 javascript 的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-05T05:20:34.820

问号是[使用 GET 方法提交表单的定义的](http://www.w3.org/TR/REC-html40/interact/forms.html#h-17.13.1)一部分，所以不是。

您可以通过使用链接而不是不真正提交任何内容的人工表单提交来摆脱问号。[链接想成为链接](http://www.cs.tut.fi/~jkorpela/www/links.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-09T07:17:44.203

如果您可以控制服务器，则可以使用重定向在服务器端解决此问题。

php 语言示例：

添加这个

```
 if (isset($_GET['keywords']) && !empty($_GET['keywords'])) { 
    $key=$_GET['keywords'];
    header("Location:http://website.com/search/$key"); } 
```

**为这个表格添加**

```
<form  method="get">
    <input type="text"  name="keywords">
</form> 
```

# c# - AppHarbor ASP.NET Google 电子表格托管

> ID：13223819
> 
> 赞同：0
> 
> 时间：2012-11-04T22:53:35.880
> 
> 标签：c#, asp.net, visual-studio, visual-web-developer

我最近使用 Visual Web Developer 2010 创建了一个 ASP.NET 网站。在我的代码中，我使用这些引用来访问 Google 电子表格：

```
Google.GData.Client
Google.GData.Extensions
Google.GData.Spreadsheets 
```

使用 Git Shell 将项目推送到 AppHarbor 网站后，我收到以下错误：

```
C:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.Common.targets(1578,5): warning MSB3245: Could not resolve this reference. Could not locate the assembly "Google.GData.Client". Check to make sure the assembly exists on disk. If this reference is required by your code, you may get compilation errors. [D:\temp\orluajnw.mop\input\DVPT\DVPT\DVPT.csproj]
     C:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.Common.targets(1578,5): warning MSB3245: Could not resolve this reference. Could not locate the assembly "Google.GData.Extensions". Check to make sure the assembly exists on disk. If this reference is required by your code, you may get compilation errors. [D:\temp\orluajnw.mop\input\DVPT\DVPT\DVPT.csproj]
     C:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.Common.targets(1578,5): warning MSB3245: Could not resolve this reference. Could not locate the assembly "Google.GData.Spreadsheets". Check to make sure the assembly exists on disk. If this reference is required by your code, you may get compilation errors. [D:\temp\orluajnw.mop\input\DVPT\DVPT\DVPT.csproj] 
```

如何防止这些错误并包含这些参考？所有帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T04:22:58.613

看来您可能正在引用 GAC 中的那些 dll。在这种情况下，由于它们在 AppHarbor 的构建机器的 GAC 中不可用，因此您必须在上传的代码中包含 dll。

一种简单的方法是创建一个*libs*文件夹（在您的解决方案所在的同一级别将是一个好位置），并将所有需要的 dll 放在那里。然后从当前项目中删除对这些 dll 的现有引用，然后再次添加它们，但要从该*libs*文件夹中添加。此外，对于这些引用中的每一个，您可能需要将`CopyLocal`属性设置为`True`（如果单击引用，您将在解决方案资源管理器下方的“属性”选项卡中看到 CopyLocal）。

可以在此处找到有关“复制本地”的更多信息：http: [//msdn.microsoft.com/en-us/library/vstudio/t1zz5y8c (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/vstudio/t1zz5y8c(v=vs.100).aspx)

这样，AppHarbor 将能够构建代码，因为它会在您刚刚上传的*libs*文件夹中查找那些 dll 以及其余代码。

# postgresql - PostgreSQL 删除所有内容

> ID：13223820
> 
> 赞同：173
> 
> 时间：2012-11-04T22:53:37.020
> 
> 标签：postgresql

您好，我想删除我的 postgresql 表中的所有数据，但不是表本身。我怎么能这样做？

* * *

## 回答 #1

> 赞同：196
> 
> 时间：2012-11-04T22:55:50.973

使用[`TRUNCATE TABLE`](https://www.postgresql.org/docs/current/sql-truncate.html)命令。

* * *

## 回答 #2

> 赞同：156
> 
> 时间：2014-08-07T13:31:03.777

可以通过多种方式删除 PostgreSQL 数据库中表/表的内容。

**使用sql删除表格内容：**

删除一张表的内容：

```
TRUNCATE table_name;
DELETE FROM table_name; 
```

删除所有命名表的内容：

```
TRUNCATE table_a, table_b, …, table_z; 
```

删除命名表和引用它们的表的内容（我将在此答案后面更详细地解释它）：

```
TRUNCATE table_a, table_b CASCADE; 
```

**使用 pgAdmin 删除表格内容：**

删除一张表的内容：

```
Right click on the table -> Truncate 
```

删除引用它的表格和表格的内容：

```
Right click on the table -> Truncate Cascaded 
```

**删除和截断的区别：**

从文档中：

> DELETE 从指定表中删除满足 WHERE 子句的行。如果没有 WHERE 子句，则效果是删除表中的所有行。 [http://www.postgresql.org/docs/9.3/static/sql-delete.html](http://www.postgresql.org/docs/9.3/static/sql-delete.html)
> 
> TRUNCATE 是一个 PostgreSQL 扩展，它提供了一种更快的机制来从表中删除所有行。TRUNCATE 从一组表中快速删除所有行。它与每个表上的非限定 DELETE 具有相同的效果，但由于它实际上并不扫描表，因此速度更快。此外，它会立即回收磁盘空间，而不需要后续的 VACUUM 操作。这在大表上最有用。 [http://www.postgresql.org/docs/9.1/static/sql-truncate.html](http://www.postgresql.org/docs/9.1/static/sql-truncate.html)

**使用从其他表引用的表：**

当您的数据库具有多个表时，这些表可能具有关系。例如，有三个表：

```
create table customers (
customer_id int not null,
name varchar(20),
surname varchar(30),
constraint pk_customer primary key (customer_id)
);

create table orders (
order_id int not null,
number int not null,
customer_id int not null,
constraint pk_order primary key (order_id),
constraint fk_customer foreign key (customer_id) references customers(customer_id)
);

create table loyalty_cards (
card_id int not null,
card_number varchar(10) not null,
customer_id int not null,
constraint pk_card primary key (card_id),
constraint fk_customer foreign key (customer_id) references customers(customer_id)
); 
```

以及为这些表准备的一些数据：

```
insert into customers values (1, 'John', 'Smith');

insert into orders values 
(10, 1000, 1),
(11, 1009, 1),
(12, 1010, 1);        

insert into loyalty_cards values (100, 'A123456789', 1); 
```

表orders 引用表customers 和表loyality_cards 引用表customers。当您尝试从其他表引用的表中截断/删除时（其他表对命名表有外键约束），您会收到错误消息。要从所有三个表中删除内容，您必须命名所有这些表（顺序不重要）

```
TRUNCATE customers, loyalty_cards, orders; 
```

或者只是使用 CASCADE 关键字引用的表（您可以命名更多的表而不仅仅是一个）

```
TRUNCATE customers CASCADE; 
```

这同样适用于 pgAdmin。右键单击客户表并选择 Truncate Cascaded。

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2012-11-05T05:10:51.807

对于*小型*表[`DELETE`](http://www.postgresql.org/docs/current/interactive/sql-delete.html)，通常速度更快，并且需要较少积极的锁定（对于繁重的并发负载）：

```
DELETE FROM tbl; 
```

没有`WHERE`条件。

对于*中型或更大的*桌子，请使用`TRUNCATE tbl`，例如发布的@Greg。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2021-04-20T11:38:28.283

[对于可能使用DBeaver 之](https://dbeaver.io/)类的工具的每个人，我都找到了一种非常简单快捷的方法：您只需要选择所有要截断的表（`SHIFT + click`或`CTRL + click`）然后`right click`

[![enter image description here](../Images/5e60adef24e71f9ca6f5dc258a341c5c.png)](https://i.stack.imgur.com/Ng44P.png)

And if you have foreign keys, select also `CASCADE` option on `Settings` panel. `Start` and that's all it takes!

# c - recv 不会将整个消息保存在缓冲区中

> ID：13223821
> 
> 赞同：0
> 
> 时间：2012-11-04T22:53:51.653
> 
> 标签：c, sockets

我使用 send 和 recv 在客户端和服务器之间传递消息。在服务器端，当我在缓冲区 fname 上收到一条消息时，保存的消息不是从客户端发送的整个消息

服务器

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <sys/types.h>      /*For Sockets*/
#include <sys/socket.h>     /*For Sockets*/
#include <netdb.h>      /*For gethostbyaddr()*/
#include <netinet/in.h>     /*For internet sockets*/
#include <dirent.h>

/*Function for creating the lof file of Server*/

void log_event (char *message,char *filename)
{

FILE *file; 
char *log_this;

time_t system_time; //Get the system time
time(&system_time);

log_this=strcat(ctime(&system_time),message); //Create the message to log 

/*Check for filename and log as appropiate*/

if (filename!=NULL)
    {
        file = fopen(filename,"a+"); 
        fprintf(file,"%s",log_this); /*writes the message*/
        fclose(file); /*done!*/     
    }
else    
    {
        file = fopen("ftp_tracelog.txt","a+"); 
        fprintf(file,"%s",log_this); /*writes the message*/
        fclose(file); /*done!*/ 
    }

}

int main (int argc,char *argv[])
{

/*DECLERATIONS*/

char *filename; 
char message [1024];
char *temp;
char temp_2[1024];
char fname[128];
char request[1024];
char op[1000];
char command[5];
FILE *fp;
DIR *dp;
char list[1024];
int port,sock,newsock,serverlen,clientlen,fname_len,recvMsgSize,i;
char buf[256];

struct sockaddr_in server,client;
struct sockaddr *serverptr, *clientptr;
struct hostent *rem;
struct dirent *ep;     

/*END OF DECLERATIONS*/

/*Check for required arguments and get them as appropiate*/

if (argc < 2) { 
/* Check if server's port number is given */
printf("Please give the port number!!!\n");
exit(1);
}

/*if server's port number is given and filename for log is given*/

if(argc>2){
filename=argv[1];
port=atoi(argv[2]);
}

/*If only port is given*/

if (argc==2){
port=atoi(argv[1]);
filename=NULL;
}
temp="--Server is Starting!!--";
sprintf(message,"%s\n",temp);
log_event(message,filename);

/* Create socket */

if ((sock = socket(PF_INET, SOCK_STREAM, 0)) < 0)
{perror("socket"); exit(1); }

server.sin_family = PF_INET; /* Internet domain */
server.sin_addr.s_addr = htonl(INADDR_ANY); /* My Internet address */
server.sin_port = htons(port); /* The given port */
serverptr = (struct sockaddr *) &server;
serverlen = sizeof (server);

/* Bind socket to address */

if (bind(sock, serverptr, serverlen) < 0) {
perror("bind"); exit(1); }

/* Listen for connections */

if (listen(sock, 40) < 0) { /* 5 max. requests in queue */
perror("listen"); exit(1); }

temp="---Listening for connections to port";
sprintf(temp_2,"%d----",port);
sprintf(message,"%s:%s\n",temp,temp_2);
log_event(message,filename);

/*Accepting Connecttion*/

while(1) {
clientptr = (struct sockaddr *) &client;
clientlen = sizeof(client);
/* Accept connection */
if ((newsock = accept(sock, clientptr, &clientlen)) < 0) {
perror("accept"); exit(1); }
/* Find client's address */
if ((rem = gethostbyaddr((char *) &client.sin_addr.s_addr,
sizeof (client.sin_addr.s_addr), client.sin_family)) == NULL) {
perror("gethostbyaddr"); exit(1);
}

temp="----Accepted connection from ";
sprintf(temp_2,"%s----", rem -> h_name);
sprintf(message,"%s:%s\n",temp,temp_2);
log_event(message,filename);

/* Create child for serving the client */
switch (fork()) {

case -1:
perror("fork"); exit(1);

case 0: /* Child process */
do{
/* Receive message from client */
if ((recvMsgSize = recv(newsock,request,sizeof(request),0))< 0)
perror("recv() failed");
//printf("%s\n",request);

strncpy(command,request,4);
printf("%s\n",command);
/*IF YOU ARE GOING TO EXECUTE AN LS COMMAND*/

if (strcmp(command,"ls")==0)
{
dp = opendir ("./");

if (dp != NULL)
  { /*LOG LS REQUEST*/

    temp="--Client ";
    sprintf(temp_2,"%s requested ls -------",rem -> h_name);
    sprintf(message,"%s:%s\n",temp,temp_2);
    log_event(message,filename);

    /*SEND ALL DIRECTORY LISTING*/    

    while (ep = readdir (dp))
{
    strcpy(list,ep->d_name);
    //printf("sending:%s\n",list);
    if (send(newsock,list,sizeof(list), 0)!= sizeof(list))
    perror("send() sent a different number of bytes than expected");
}
    //IF DIRECORY IS FINISHED SEND A LAST MESSAGE FOR ENDING

    (void) closedir (dp);
    if (send(newsock,"end",sizeof("end"), 0)!= sizeof("end"))
    perror("send() sent a different number of bytes than expected");    
  }
  else
    perror ("Couldn't open the directory");
}
/*IF THE COMMAND IS PUT*/

if (strcmp(command,"put")==0) 
{
printf("execute put!!\n");

bzero(fname, sizeof fname); /* Initialize buffer */

if ((recvMsgSize = recv(newsock,fname,128, MSG_WAITALL)) < 0)
perror("recv() failed");

printf("%s!!!!\n",fname);

}
}while (strcmp(request,"end")!=0); //run until client sents end request

/*LOG EXIT OF CLIENT*/

temp="--Client";
    sprintf(temp_2,"%s is disconnected---",rem -> h_name);
    sprintf(message,"%s:%s\n",temp,temp_2);
    log_event(message,filename);

close(newsock); /* Close socket */
exit(0);
} /* end of switch */
} /* end of while(1) */

} 
```

客户

```
#include <stdlib.h>
#include <string.h>
#include <stdio.h>
#include <netdb.h>
#include <netinet/in.h>
#include <sys/socket.h>
#include <sys/types.h>

int main (int argc,char *argv[])
{

int port, sock, serverlen,recvMsgSize;
int fname_len,msg_len,request_len;
char buf[256];
char fname[128];
char request[1204];
char list[1024];
char msg[512];
char op[1000];
char temp[5];
char *temp3;
FILE *fp;

struct sockaddr_in server;
struct sockaddr *serverptr;
struct hostent *rem;

temp3="put";

/* Are server's host name and port number given? */
if (argc < 3) {
printf("Please give host name and port number\n"); exit(1);

}

/* Create socket */
if ((sock = socket(PF_INET, SOCK_STREAM, 0)) < 0) {
perror("socket");
exit(1);
}

/* Find server address */
if ((rem = gethostbyname(argv[1])) == NULL) {
herror("gethostbyname"); exit(1);
}

/* Convert port number to integer */
port = atoi(argv[2]);

/* Internet domain */
server.sin_family = PF_INET; 
bcopy((char *) rem -> h_addr, (char *) &server.sin_addr,
rem -> h_length);

/*Server's Internet address and port*/
server.sin_port = htons(port); 
serverptr = (struct sockaddr *) &server;
serverlen = sizeof(server);

if (connect(sock, serverptr, serverlen) < 0) { /* Request connection */
perror("connect"); 
exit(1); }

printf("Requested connection to host %s port %d\n", argv[1], port);

do{
printf("Please enter request\n:");
scanf("%s",request);

request_len=sizeof(request);

/* Send the string to the server */
if (send(sock,request,request_len, 0)!= request_len)
perror("send() sent a different number of bytes than expected");

strncpy(temp,request,4);
printf("%s\n",temp);

if(strcmp(temp,"ls")==0)
{
sprintf(list,"");

/*Recieve from server*/
while(strcmp(list,"end")!=0){

if ((recvMsgSize = recv(sock,list,sizeof(list),0))< 0)
perror("recv() failed");

if(strcmp(list,"end")!=0){
    printf("%s\n",list);
        }
}
}

/*Command for put*/
if(strcmp(request,temp)==0)
{
printf("Please enter filename:\n");
scanf("%s",fname);

if (send(sock,fname,128, MSG_DONTWAIT)!= 128)
perror("send() sent a different number of bytes than expected");

}
}while (strcmp(request,"end")!=0);
close(sock); /* Close socket */
exit(0);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T23:00:37.083

当您调用 时[`recv`](http://linux.die.net/man/2/recv)，您需要检查接收到的字节数。如果它小于您的要求，您需要`recv`再次调用，并添加到先前接收到的缓冲区的末尾。可能发生的情况是，当您第一次调用时，只有部分消息到达`recv`。

```
char buf[N];
char* p = buf;
ssize_t bytesRemaining = N;
while (bytesRemaining) {
   ssize_t recvd;
   recvd = recv(sock, p, bytesRemaining, 0);
   bytesRemaining -= recvd;     // keep track of bytes left
   p += recvd;                  // advance buffer pointer
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T23:02:05.590

永远不能依赖`recv()`函数在一个调用实例中接收所有数据。您可能必须在循环中重复调用它以获取所有数据（等于数据的长度。

# android - Eclipse 相对布局很难工作

> ID：13223823
> 
> 赞同：2
> 
> 时间：2012-11-04T22:54:29.483
> 
> 标签：android, eclipse, layout

我不知道你们是否经常使用这种类型的布局，但这让我抓狂。

例如，当我在屏幕中间放置一个按钮，然后在按钮附近放置一个 textview 时，IDE 突然对它们重新排序，textview 位于顶部，按钮位于右侧。

在屏幕上使用太多元素时可能会出现问题。
从那时起我使用线性布局，但它也有一些限制。

谢谢，我是android开发的新手（4天开始学习）所以我希望你们能帮助我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T23:14:30.067

我很少使用 RelativeLayout 作为活动的主要布局。建议使用 LinearLayout 并设置`android:weightSum`，以便您的应用程序可以对屏幕有更大的支持。如您所知，运行 Android 的设备种类繁多，具有不同的屏幕尺寸。仅当您希望该视图位于具有该固定大小的特定位置时，才使用 RelativeLayout。

请参阅使用 LinearLayouts 创建具有许多元素的活动的示例，如您所指：

```
<LinearLayout
xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"  
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:baselineAligned="false"
android:padding="@dimen/padding_small"
android:weightSum="3"
tools:ignore="HardcodedText" >

<LinearLayout
    android:id="@+id/picker_time_hour"
    android:layout_width="0dp"
    android:layout_height="wrap_content"
    android:layout_weight="1"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/picker_time_hour_text"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:gravity="center"
        android:text="@string/hours"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <Button
        android:id="@+id/picker_time_hour_up"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginLeft="@dimen/padding_medium"
        android:layout_marginRight="@dimen/padding_medium"
        android:gravity="center"
        android:text="+" />

    <EditText
        android:id="@+id/picker_time_hour_value"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginLeft="@dimen/padding_medium"
        android:layout_marginRight="@dimen/padding_medium"
        android:gravity="center"
        android:inputType="number" />

    <Button
        android:id="@+id/picker_time_hour_down"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginLeft="@dimen/padding_medium"
        android:layout_marginRight="@dimen/padding_medium"
        android:gravity="center"
        android:text="-" />
</LinearLayout>

<LinearLayout
    android:id="@+id/picker_time_minute"
    android:layout_width="0dp"
    android:layout_height="wrap_content"
    android:layout_weight="1"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/picker_time_minute_text"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:gravity="center"
        android:text="@string/minutes"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <Button
        android:id="@+id/picker_time_minute_up"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginLeft="@dimen/padding_medium"
        android:layout_marginRight="@dimen/padding_medium"
        android:gravity="center"
        android:text="+" />

    <EditText
        android:id="@+id/picker_time_minute_value"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginLeft="@dimen/padding_medium"
        android:layout_marginRight="@dimen/padding_medium"
        android:gravity="center"
        android:inputType="number" />

    <Button
        android:id="@+id/picker_time_minute_down"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginLeft="@dimen/padding_medium"
        android:layout_marginRight="@dimen/padding_medium"
        android:gravity="center"
        android:text="-" />
</LinearLayout>

<LinearLayout
    android:id="@+id/picker_time_second"
    android:layout_width="0dp"
    android:layout_height="wrap_content"
    android:layout_weight="1"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/picker_time_second_text"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:gravity="center"
        android:text="@string/seconds"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <Button
        android:id="@+id/picker_time_second_up"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginLeft="@dimen/padding_medium"
        android:layout_marginRight="@dimen/padding_medium"
        android:gravity="center"
        android:text="+" />

    <EditText
        android:id="@+id/picker_time_second_value"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginLeft="@dimen/padding_medium"
        android:layout_marginRight="@dimen/padding_medium"
        android:gravity="center"
        android:inputType="number" />

    <Button
        android:id="@+id/picker_time_second_down"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginLeft="@dimen/padding_medium"
        android:layout_marginRight="@dimen/padding_medium"
        android:gravity="center"
        android:text="-" />
</LinearLayout>

</LinearLayout> 
```

结果是：

![在此处输入图像描述](../Images/4eabda0fd0a9c6c45ead0f3fdd4b8137.png)

正如你所看到的，我的意见是你应该使用 LinearLayouts，但是[阅读这个主题](http://logc.at/2011/10/18/when-to-use-linearlayout-vs-relativelayout/)，它也可以帮助你选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T23:11:18.723

根据我的经验，您不应该使用 Eclipse 拖放 ui 构建器。它只会引起混乱和问题。它还不够成熟（即使它在过去几年取得了很大进展）。

特别是作为初学者，您应该直接使用 xml。这将使您更好地理解布局机制。我不知道有哪个 android 开发人员认真地与 ide builder 合作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T23:04:46.023

相对布局已经证明是我最常用的布局。除了真正可定制的事实（尽管可能不如 LinearLayout 简单）之外，它也非常“快”。“快速”意味着当您使用嵌套的 LinearLayout 时会有一定的开销，您可以通过使用 RelativeLayout 来避免这种开销。具体来说：

> 不幸的是，坚持基本功能并不是创建用户界面的最有效方式。一个常见的例子是滥用 LinearLayout，这导致视图层次结构中的视图激增。添加到应用程序中的每个视图——或者更糟糕的是，每个布局管理器——都是有代价的：初始化、布局和绘图变得更慢。当您嵌套多个使用权重参数的 LinearLayout 时，布局传递可能会特别昂贵，这需要对子元素进行两次测量。

# arrays - Matlab中不同大小的矩阵数组

> ID：13223825
> 
> 赞同：3
> 
> 时间：2012-11-04T22:55:02.090
> 
> 标签：arrays, matlab, matrix

是否可以在 Matlab 中创建具有不同大小的矩阵数组。例如

```
Array_Mat(:,:,1) = zeros(3);
Array_Mat(:,:,2) = zeros(4); 
```

这给出了错误。那我如何制作矩阵数组？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-04T23:00:35.803

你可以使用细胞。

```
>> a{1}=[1 2 ;3 4]

a = 

    [2x2 double]

>> a{2}=zeros(4)

a = 

    [2x2 double]    [4x4 double]

>> a{1}(2,1)

ans =

     3

>> a{2}(3,4)

ans =

     0 
```

# h2 - 通过 Apache ServiceMix 4.2.2 从 xml 文件读取并填充 H2 DB 表

> ID：13223826
> 
> 赞同：2
> 
> 时间：2012-11-04T22:55:06.743
> 
> 标签：h2, apache-servicemix

我正在尝试使用 Apache Service Mix(ASM) ESB 将一个简单的企业应用程序集成到数据源（现在是 xml 文件）。基本上我需要让 ESB 从 xml 文件中提取内容并在 H2 数据库（我的应用程序链接到）中填充相应的表。我不确定我应该使用 ASM 的哪些功能。如果有人能给我一个关于我应该如何去做的高级想法，我将非常感激。我查看了 Fuse ESB 的文档以及 ASM 文档，但此时我完全糊涂了。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T16:45:16.777

由于 ServiceMix 使用 Camel 进行此类工作，我的第一个建议是查看 Apache Camel。

以您为例，一条简单的路线如下所示：

```
from("file:location_of_file").unmarshal(registered-jaxB-structure)
.split(simple("probably_your_entities")).to("jdbc:dataSource?sql_insert"); 
```

您从 *location_of_file* 中读取传入的文件，将其解组，因为它是带有 jaxb 的对象结构的 XML 文件。之后，您可能需要遍历 xml 文件中的实体，最好通过拆分来完成。现在，您的结构很可能以某种方式用于存储 jpa、sql 或 jdbc。

# ruby-on-rails - 使用种子随机序列代替 100M 行关系表

> ID：13223833
> 
> 赞同：3
> 
> 时间：2012-11-04T22:56:58.103
> 
> 标签：ruby-on-rails, ruby, postgresql, random

我们在 Ruby on Rails/postgres 服务器上托管 iPhone 社交游戏的后端。

每个游戏都有 54 个问题，通过数据库中的关系表连接。由于我们目前有大约 200 万个正在进行的游戏，关系表包含大约 100M 行。这会占用大量内存。我们现在正在考虑构建一个算法，该算法使用由 game_id 播种的伪随机序列生成 54 个问题 id。这个想法是产生一个看似随机的问题集合，而不将明确的游戏问题关系保存到数据库中。通过这种方式，我们可以将负载从数据库转移到应用程序服务器。这是一个好主意吗？

**伪代码：**

```
r = Random.new(game_id)
q1_id = r.rand(n_questions)
q2_id = r.rand(n_questions)
... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T15:09:02.100

是的，你所需要的只是一个确定性函数，它接受游戏 ID 并产生一个序列。像在 gameId 中添加盐并对结果进行散列这样简单的事情就可以了，然后只需将结果值映射到问题 ID 即可。（看看那种东西的组合学。）

如果您正在处理看起来像由游戏标识符键入的问题标识符列表的东西，并且您需要对答案的持久性支持，那么有比 RDBMS 更好的选择。首先看一下 Redis。

# python - 重置密码时删除所有用户的 cookie/会话

> ID：13223839
> 
> 赞同：0
> 
> 时间：2012-11-04T22:57:59.803
> 
> 标签：python, turbogears, repoze.who

我有兴趣提高我的 TurboGears 2.2 应用程序的安全性，以便当用户更改他的密码时，它将他从所有会话中注销并且他必须再次登录。目标是当用户在浏览器 1 上更改密码时，他也必须在浏览器 2 上重新登录。实验表明情况并非如此，尤其是在浏览器 2 启用了“记住我”的情况下。

这是使用 repoze.who 的标准快速启动应用程序。看来我可能需要更改 AuthTktCookiePlugin，但如果不进行大量重新布线，就没有办法做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T13:43:38.867

将上次更改密码的时间戳存储在内部`request.identity['userdata']`应该可以在用户返回时检查它，如果它与上次更改密码的时间不同，则将其注销。

# javascript - Dart JavaScript 与 jQuery 的互操作回调

> ID：13223840
> 
> 赞同：11
> 
> 时间：2012-11-04T22:58:02.190
> 
> 标签：javascript, dart

如何将以下 jquery 代码转换为 Dart？我很难让警报回调使用 js.interop 工作。

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script>
  $(function () {
    $('p').hide('slow', function() {
      alert("The paragraph is now hidden");
    });
  });
</script> 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-05T05:44:46.923

谢谢你的提问！我自己不确定，但事实证明这是可能的。:)

首先，添加`js`到您的 pubspec.yaml：

```
name:  jquerydart
description:  A sample application

dependencies:
  js: any 
```

然后，通过命令行或 Dart 编辑器运行*pub install 。*

然后，在你的 Dart 文件中：

```
import 'dart:html';
import 'package:js/js.dart' as js;

hideIsDone() {
  window.alert('all done!');
}

void main() {
  js.scoped(() {
    js.context.jQuery('p').hide(1000, new js.Callback.once(() => hideIsDone()));
  });
} 
```

请注意，要从 JS 回调到 Dart，您需要创建一个 Callback 对象。

另请注意，您不能使用`$`jQuery 变量，因为 dart2js 也使用`$`. 所以同时你需要`jQuery`在你的 Dart 代码中使用。

说了这么多，我们可以通过 JS-Dart 互操作使用 jQuery 很酷，但是 Dart 真的应该为我们做这件事。所以我打开了错误[http://code.google.com/p/dart/issues/detail?id=6526](http://code.google.com/p/dart/issues/detail?id=6526)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-05T07:39:31.530

首先将`js`依赖项添加到您的*pubspec.yaml*：

```
dependencies:
  js: any 
```

通过使用*js-interop ，您可以编写与**javascript*中几乎相同的代码。

```
import 'dart:html';
import 'package:js/js.dart' as js;

void main() {
  js.scoped(() {
    js.context.$(new js.Callback.once(($) {
      $('p').hide('slow', new js.Callback.once(() {
        js.context.alert("The paragraph is now hidden");
      }));
    }));
  });
} 
```

主要区别是：

*   您必须使用`js.Callback.once`或`js.Callback.many`设置您的回调函数。`js.Callback.once`如果您的回叫仅调用一次，请使用。
*   您的代码必须用`js.scoped`. 基本上，[管理代理生命周期](http://www.dartlang.org/articles/js-dart-interop/#managing-proxy-lifetimes)是为了防止内存泄漏。

也就是说，您可以简化上面的代码：

```
import 'dart:html';
import 'package:js/js.dart' as js;

void main() {
  js.scoped(() {
    js.context.$('p').hide('slow', new js.Callback.once(() {
      window.alert("The paragraph is now hidden");
    }));
  });
} 
```

变化是：

*   `js.context.$(new js.Callback.once(($) {`不需要，因为`main`它相当于 jQuery `$(function)`。
*   `js.context.alert`已被替换为：直接使用*DART*函数而不是与*JS*`window.alert`通信更有效。

# c++ - 如何在其他两个之间设置工具栏

> ID：13223845
> 
> 赞同：0
> 
> 时间：2012-11-04T22:58:54.843
> 
> 标签：c++, qt, qtoolbar

我有多个彼此相邻的工具栏。我希望第一个是第三个或在另一个之前的工具栏。我不知道如何实现它。有人可以帮忙吗？

这是我的`.cpp`

```
 QPixmap pix(16, 16);
 pix.fill(Qt::black);
 fntColorAct = new QAction(pix, tr("&Color"), this);
 connect(fntColorAct, SIGNAL(triggered()), this, SLOT(fontColor()));

 fontToolBar = new QToolBar(this);
 fontToolBar->setAllowedAreas(Qt::TopToolBarArea | Qt::BottomToolBarArea);
 addToolBar(fontToolBar);
 fontToolBar->setWindowTitle(tr("&Format Actions"));
 addToolBarBreak(Qt::TopToolBarArea);
 addToolBar(fontToolBar);

 cmbStyle = new QComboBox(fontToolBar);
 fontToolBar->addWidget(cmbStyle);
 cmbStyle->addItem("Standard");
 cmbStyle->addItem("Bullet List (Disc)");
 cmbStyle->addItem("Bullet List (Circle)");
 cmbStyle->addItem("Bullet List (Square)");
 cmbStyle->addItem("Ordered List (Decimal)");
 cmbStyle->addItem("Ordered List (Alpha lower)");
 cmbStyle->addItem("Ordered List (Alpha upper)");
 cmbStyle->addItem("Ordered List (Roman lower)");
 cmbStyle->addItem("Ordered List (Roman upper)");
 connect(cmbStyle, SIGNAL(activated(int)), this, SLOT(fontStyle(int)));

 fntComboBox = new QFontComboBox(fontToolBar);
 fontToolBar->addWidget(fntComboBox);
 connect(fntComboBox, SIGNAL(activated(QString)), this, SLOT(fontFamily(QString)));

 cmbSize = new QComboBox(fontToolBar);
 cmbSize->setObjectName("cmbSize");
 fontToolBar->addWidget(cmbSize);
 cmbSize->setEditable(true);

 QFontDatabase database;
 foreach(int size, database.standardSizes())
     cmbSize->addItem(QString::number(size));

 connect(cmbSize, SIGNAL(activated(QString)),
         this, SLOT(fontSize(QString)));
 cmbSize->setCurrentIndex(cmbSize->findText(
           QString::number(QApplication::font().pointSize())));
}

 void MainWindow::createMenus() {
     fileMenu = menuBar()->addMenu(tr("&File"));
     fileMenu->addAction(newAct);
     fileMenu->addAction(openAct);
     fileMenu->addAction(saveAct);
     fileMenu->addAction(saveAsAct);
     fileMenu->addSeparator();
     fileMenu->addAction(printAct);
     fileMenu->addAction(printPreviewAct);
     fileMenu->addSeparator();
     fileMenu->addAction(exitAct);

     editMenu = menuBar()->addMenu(tr("&Edit"));
     editMenu->addAction(cutAct);
     editMenu->addAction(copyAct);
     editMenu->addAction(pasteAct);
     editMenu->addSeparator();
     editMenu->addAction(undoAct);
     editMenu->addAction(redoAct);

     formatMenu = menuBar()->addMenu(tr("Format"));
     formatMenu->addAction(boldAct);
     formatMenu->addAction(underlineAct);
     formatMenu->addAction(italicsAct);
     formatMenu->addSeparator()->setText(tr("Alignment"));
     formatMenu->addAction(alignLeftAct);
     formatMenu->addAction(alignCenterAct);
     formatMenu->addAction(alignRightAct);
     formatMenu->addAction(justifyAct);
     formatMenu->addAction(fntColorAct);

     menuBar()->addSeparator();
     helpMenu = menuBar()->addMenu(tr("&Help"));
     helpMenu->addAction(aboutAct);

     menuBar()->addSeparator();
     settingsMenu = menuBar()->addMenu(QIcon(":/icons/cog.png"), tr("&Settings")); }

 void MainWindow::createToolBars() {
     fileToolBar = addToolBar(tr("File"));
     fileToolBar->addAction(newAct);
     fileToolBar->addAction(openAct);
     fileToolBar->addAction(saveAct);

     editToolBar = addToolBar(tr("Edit"));
     editToolBar->addAction(cutAct);
     editToolBar->addAction(copyAct);
     editToolBar->addAction(pasteAct);
     editToolBar->addAction(undoAct);
     editToolBar->addAction(redoAct);

     formatToolBar = addToolBar(tr("Format"));
     formatToolBar->addAction(boldAct);
     formatToolBar->addAction(underlineAct);
     formatToolBar->addAction(italicsAct);
     formatToolBar->addAction(alignLeftAct);
     formatToolBar->addAction(alignCenterAct);
     formatToolBar->addAction(alignRightAct);
     formatToolBar->addAction(justifyAct);
     formatToolBar->addAction(fntColorAct); 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:21:13.063

[QMainWindow::insertToolBar()](http://qt-project.org/doc/qt-4.8/qmainwindow.html#insertToolBar)允许您在另一个工具栏之前插入一个工具栏。

# r - ggplot2 带有表达式的两行标签

> ID：13223846
> 
> 赞同：67
> 
> 时间：2012-11-04T22:58:58.367
> 
> 标签：r, ggplot2

我想用一条`expression()`语句在两行上写一个轴标签。但是，`plotmath`并且`expression`不允许这样做（例如，下标文本出现在最右侧）。我在 2005 年发现[了这个关于](https://stat.ethz.ch/pipermail/r-help/2005-February/066776.html)类似问题的讨论，但他们提供的解决方法并没有转化为我在 ggplot2 中的应用程序。[最近的一个问题](https://stackoverflow.com/questions/13198170/combining-expression-with-n)解决了多行表达式语句的不同排列，但再次提供的解决方法不适用于此处。

例子：

```
p <- ggplot(mtcars,aes(x=wt,y=mpg))+
  geom_point()+
  xlab(expression(paste("A long string of text goes here just for the purpose \n of illustrating my point Weight "[reported])))
try(ggsave(plot=p,filename=<some file>,height=4,width=6)) 
```

产生一个图像，当我希望它坐在前一个单词旁边时，下标“reported”被踢到右边。 ![ggplot2 带有表达式的两行标签](../Images/a04be70b153ef6d91cd409b723ddb7bd.png)

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-11-05T02:31:19.080

我认为这是一个错误。（或“不支持多行表达式”这一事实的结果，如您链接到的对话中所述）。

Gavin Simpson 提到的解决方法是：

```
#For convenience redefine p as the unlabeled plot
p <- ggplot(mtcars,aes(x=wt,y=mpg))+geom_point()

#Use atop to fake a line break
p + xlab(expression(atop("A long string of text for the purpose", paste("of illustrating my point" [reported])))) 
```

![在此处输入图像描述](../Images/ffc070a9a5f8d3c10444ddc8e7a47b71.png)

可以使用带下标的真正换行符。在下面的简短示例中，它与您的示例具有相同的形式，下标正确放置在文本的其余部分附近，但两行文本未正确居中：

```
p + xlab(expression(paste("line1 \n line2 a" [b]))) 
```

![在此处输入图像描述](../Images/e74d68c5c0a8c3964a6c4806b480e127.png)

我认为在这两种情况下，当上一行文本长于下一行文本时，下标放置错误。相比

```
p + xlab(expression(paste("abc \n abcd" [reported]))) 
```

![在此处输入图像描述](../Images/b4efba4d26a9b34c006e059a4929b81a.png)

```
p + xlab(expression(paste("abc \n ab" [reported]))) 
```

![在此处输入图像描述](../Images/ec314745eb589b7568ec66fe06651317.png)

下标总是与上线右端的右侧对齐。

```
p + xlab(expression(paste("abcdefghijklmnop \n ab" [reported]))) 
```

![在此处输入图像描述](../Images/2f1e17c3a738534935c63942a146b6e6.png)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2019-01-14T15:03:43.120

# 1）解决方案`cowplot::draw_label()`

也可以使用`draw_label()`包中的注释功能[`cowplot`](https://cran.r-project.org/web/packages/cowplot/index.html)（在[此](https://github.com/stefano-meschiari/latex2exp/issues/11#issuecomment-441577714)讨论中建议）。我们可以调用`cowplot::draw_label()`尽可能多的文本行。当`cowplot::draw_label()`与 结合使用时`cowplot::ggdraw()`，它可以在画布/工作表上的任意位置进行注释，坐标范围从 0 到 1（相对于整个画布）。

需要调整注释位置并为自定义轴标题留出足够的空间。

请注意，该`cowplot`包当前更改了默认的 ggplot 主题，因此，如果需要，请`theme_set()`在加载包后使用，如此[处](https://stackoverflow.com/a/41096936/5193830)所述。

另请注意，该函数在后台`cowplot::draw_label()`使用`ggplot2::annotation_custom()`。我将在下面的第二部分中更多地提及这一点。

```
library(ggplot2)
library(cowplot)
#> 
#> Attaching package: 'cowplot'
#> The following object is masked from 'package:ggplot2':
#> 
#>     ggsave

# If needed, revert to default theme (cowplot modifies the theme); 
# theme_set(theme_grey())

p <- ggplot(mtcars, aes(x = wt, y = mpg)) + geom_point()
# Make enough space for the custom two lines axis title
p <- p + 
  xlab("") + # empty label
  # Tweak the margins (push the label down by forcing a wider top margin)
  theme(axis.title.x = element_text(size = 10, # also adjust text size if needed
                                    margin = margin(t = 10, r = 0, b = 0, l = 0,
                                                    unit = "mm")))

# The two lines we wish on the plot
line_1 <- "A long string of text for the purpose"
line_2 <- expression(paste("of illustrating my point" [reported]))
# Or avoid paste() (is not actually needed)
# line_2 <- expression("of illustrating my point" [reported])

# Call cowplot::draw_label two times to plot two lines of text
ggdraw(p) + 
  draw_label(line_1, x = 0.55, y = 0.075) + # use relative coordinates for positioning
  draw_label(line_2, x = 0.55, y = 0.025) 
```

![](../Images/5bf17a2e7807d8068f3ecd229b76ce1d.png)

请注意，`cowplot::draw_label()`也可以与设置裁剪结合使用`coord_cartesian(clip = "off")`，这允许在画布上的任何位置进行绘图。这次我们不再使用相对坐标，而是使用绘图/数据中的坐标（绝对坐标）：

```
# Other two expressions
line_1b <- expression(bolditalic('First line'))
line_2b <- expression(integral(f(x)*dx, a, b))

p + coord_cartesian(clip = "off") + # allows plotting anywhere on the canvas
  draw_label(line_1b, x = 3.5, y = 8.2) + # use absolute coordinates for positioning
  draw_label(line_2b, x = 3.5, y = 6) 
```

![](../Images/a91f25e0a5faac4d47e830e6606d53eb.png)

^(由[reprex 包](https://reprex.tidyverse.org)（v0.2.1）于 2019 年 1 月 14 日创建)

* * *

# 2）解决方案`ggplot2::annotation_custom()`

如前所述，`cowplot::draw_label()`是`ggplot2::annotation_custom()`. 因此，`cowplot::draw_label()`我们可以直接`ggplot2::annotation_custom()`与设置裁剪结合使用，而不是`coord_cartesian(clip = "off")`，这在合并[此拉取请求](https://github.com/tidyverse/ggplot2/pull/2539)时可用。

然而，这种方法更冗长，有更多的坐标参数，我们需要使用`grid::textGrob()`.

```
# Some other two lines we wish on the plot as OX axis title
line_1c <- expression("Various fonts:" ~ bolditalic("bolditalic") ~ bold("bold") ~ italic("italic"))
line_2c <- expression("this" ~~ sqrt(x, y) ~~ "or this" ~~ sum(x[i], i==1, n) ~~ "math expression")
# the ~~ ads a bit more space than ~ between the expression's components

p + coord_cartesian(clip = "off") +
  annotation_custom(grid::textGrob(line_1c), xmin = 3.5, xmax = 3.5, ymin = 7.3, ymax = 7.3) +
  annotation_custom(grid::textGrob(line_2c), xmin = 3.5, xmax = 3.5, ymin = 5.5, ymax = 5.5) 
```

![](../Images/7b2beb00bce4a393a444b83e59b46754.png)

^(由[reprex 包](https://reprex.tidyverse.org)（v0.2.1）于 2019 年 1 月 14 日创建)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2015-08-29T00:37:02.857

你可以用这个技巧，

```
library(gridExtra)
library(grid)

element_custom <- function() {
  structure(list(), class = c("element_custom", "element_text"))
}

element_grob.element_custom <- function(element, label="", ...)  {

  mytheme <- ttheme_minimal(core = list(fg_params = list(parse=TRUE, 
                                                         hjust=0, x=0.1)))
  disect <- strsplit(label, "\\n")[[1]]
  tableGrob(as.matrix(disect), theme=mytheme)
}

# default method is unreliable
heightDetails.gtable <- function(x) sum(x$heights)

ggplot(iris, aes(Sepal.Length, Sepal.Width)) +
  geom_line() + 
  labs(x= "First~line \n italic('and a second') \n integral(f(x)*dx, a, b)")+
  (theme_grey() %+replace% theme(axis.title.x = element_custom())) 
```

[![在此处输入图像描述](../Images/368419c6ecc9973566c85d0961d5d456.png)](https://i.stack.imgur.com/JtFZj.png)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2020-03-06T02:35:30.430

该包[`ggtext`](https://github.com/wilkelab/ggtext)提供了一个不同的选项，允许 HTML 标签格式化/自定义标签和文本。

```
library(ggtext)
ggplot(mtcars, aes(wt, mpg)) +
  geom_point() +
  xlab("A long string of text goes here just for the purpose<br>of illustrating my point Weight<sub>reported</sub>") +
  theme(axis.title.x = element_markdown()) 
```

[![在此处输入图像描述](../Images/1cfcf4376c21f0d3bb467ef21efd576e.png)](https://i.stack.imgur.com/CNupz.png)

# iphone - “在类方法中访问的实例变量‘xxx’......为什么？

> ID：13223847
> 
> 赞同：1
> 
> 时间：2012-11-04T22:59:01.747
> 
> 标签：iphone, xcode, methods, instance, instance-variables

所以请原谅我，因为我对stackoverflow和一般的ios编程都很陌生。

我正在尝试更改我拥有的按钮的文本，用`dateStringForInput`我从另一个类传入的日期字符串 () 替换当前文本。该按钮被调用`myTodayButton`并在我的`.h`文件中为我的班级声明`inputMilesViewController`... `@property (strong, nonatomic) IBOutlet UIButton *myTodayButton`；

以下是我的 .m 中的代码。

```
+(void) changeButtonText:(NSString*) dateStringForInput{

     NSLog(@"we got to changebuttontext");
     [_myTodayButton setTitle:dateStringForInput forState:UIControlStateNormal];
} 
```

我`_myTodayButton`在类方法中访问了以下错误“实例变量”。

我知道这是用类方法而不是实例方法编写的，但我不知道如何使这种更改发生。提示此调用的按钮`changeButtonText` 位于另一个正在创建的类中`dateStringForInput`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-05-05T11:20:04.077

### 试试这样...

**对于 (+) 实例。**

`+ (void) changeButtonText`: 只能访问 self 对象。

--**步骤 1：****从头**文件中删除以下行

```
@property (strong, nonatomic) IBOutlet UIButton *myTodayButton; 
```

--**第二步：**

*   全局添加`UIButton *myTodayButton`你的类文件..
*   这意味着之前声明`@implementation`

例如：在**.m 文件中**

```
#import "Controller.h"
UIButton *myTodayButton // Add like this before @implementation

@implementation Controller 
```

* * *

**例如**

`- (void) changeButtonText`: 只能访问实例方法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T23:05:34.753

将方法更改为实例方法而不是类方法（“-”而不是“+”）创建类的实例，然后像这样简单地调用它：

```
MyClass *classInstance = [[MyClass alloc] init];
[classInstance changeButtonText:@"stringText"]; 
```

还建议对 IBOutlets 具有弱属性。

```
@property (nonatomic, weak) IBOutlet UIButton *myButton; 
```

[编辑]

关于你与 segues 的第二个问题。首先，您真的需要一个不同的视图控制器来简单地显示 UIDatePicker 吗？我通常使用 actionSheet 在同一个 UIViewController 中显示它们，它需要做一些工作才能做到恰到好处，但可以解决这个问题。如果你愿意，我可以发布代码吗？

无论如何，如果您想保留当前的设置，我会执行以下操作：

1.  在包含按钮的 ViewController 中，在 .h 文件中创建一个新的公共 NSString 属性。

    @property (nonatomic, strong) NSString *dateString;

2.  在包含日期选择器的 View Controller 中，在用户选择日期后，覆盖 perpareForSegue 方法。在这里获取目标视图控制器（即上面第一点中创建的具有按钮和新字符串属性的视图控制器）并设置 dateString。

    ```
    - (void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {

    MyViewController *todayViewController = (MyViewController*)[segue destinationViewController];
    [todayViewController setDateString:@"valueYouRequire"]; 
    ```

    }

3.  在带有按钮的 ViewController 中，将 viewDidLoad 中的按钮标题设置为 dateString。

    *   (void)viewDidLoad { [超级 viewDidLoad];

    if (self.dateString) [self.myTodayButton setTitle:self.dateString forState:UIControlStateNormal]; }

[编辑]

如果你想沿着 actionSheet 路线走，然后使用按钮将此方法添加到 ViewController 并调整帧大小以满足你的需要。下面的方法创建一个日期选择器，将其添加到 actionSheet 并显示 actionSheet。

```
- (IBAction) datePressed:(id)sender {

if (!_actionSheet) {

_actionSheetFrame = CGRectMake(0, self.view.frame.size.height - 373, 320, 403);
_actionSheetBtnFrameOk = CGRectMake(20, 330, 280, 50);
_actionSheetBtnFreameCancel = CGRectMake(20, 275, 280, 50);
_pickerFrame = CGRectMake(0, 50, 320, 216);

    _actionSheet = [[UIActionSheet alloc] initWithTitle:@"Select Date" delegate:self cancelButtonTitle:@"Cancel" destructiveButtonTitle:nil otherButtonTitles:@"OK", nil];
    _datePicker = [[UIDatePicker alloc] init];
    [_datePicker setDatePickerMode:UIDatePickerModeDate];

    [_actionSheet addSubview:_datePicker];
}

[_datePicker setMaximumDate:[NSDate date]];

[_actionSheet showInView:self.view.superview];
[[[_actionSheet subviews] objectAtIndex:kActionBtnIndexOk] setFrame:_actionSheetBtnFrameOk];
[[[_actionSheet subviews] objectAtIndex:kActionBtnIndexCancel] setFrame:_actionSheetBtnFreameCancel];

[_actionSheet setFrame:_actionSheetFrame];
[_datePicker setFrame:_pickerFrame]; 
```

}

一旦用户选择了他想要的日期，您还必须实现 UIActionSheetDelegate 方法来设置按钮的文本。

```
#pragma mark - UIActionSheet Delegate Methods

- (void) actionSheet:(UIActionSheet *)actionSheet didDismissWithButtonIndex:(NSInteger)buttonIndex {

    if (buttonIndex == 0) {
        [self.myTodayButton setTitle:self.dateStringFromSelectedDate forState:UIControlStateNormal];
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T23:08:47.160

类方法无权访问实例变量，这就是您收到您所看到的错误的原因。

您需要将方法更改为实例方法：

```
- (void)changeButtonText:(NSString *)dateStringForInput; 
```

然后，您需要将包含该方法的类的*实例*的引用传递或获取到调用该方法的类。

我希望这是有道理的......如果您需要任何澄清，请添加评论！

# java - GWT App中静态HTML文件的内容管理

> ID：13223853
> 
> 赞同：2
> 
> 时间：2012-11-04T22:59:49.920
> 
> 标签：java, mongodb, gwt

我正在使用 Mongo 构建一个 GWT 应用程序以实现持久性。此 Web 应用程序具有静态内容，例如“条款和条件”、“帮助”、“常见问题解答”等。此静态内容必须通过管理控制台进行编辑，方法是上传较新版本或在线编辑。

我的问题是...

*** 我应该以什么格式存储这个静态内容？**

*** 如何在我的 GWT 应用程序中显示此静态（但动态）内容？**

*** 我应该将这些文件存储在 Mongo 还是文件系统中？**

*** 让管理员上传编辑过的内容还是让他们在线编辑更好？**

任何意见是极大的赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T23:58:31.453

GWT 为这个问题提供了一个很好的解决方案：ExternalTextResource：

[https://developers.google.com/web-toolkit/doc/latest/DevGuideClientBundle#TextResource](https://developers.google.com/web-toolkit/doc/latest/DevGuideClientBundle#TextResource)

您只需使用文本创建 HTML 文件，并提供对这些文件的引用作为外部文本资源。您可以按照自己喜欢的方式编辑这些 HTML 文件。

开发人员指南中的示例在 TextArea 上显示了 setText()，但在您的情况下，您应该使用带有 setHtml() 的 HTML 小部件。

# opengl - 循环是在 GPU 上按顺序执行还是并行执行？

> ID：13223854
> 
> 赞同：4
> 
> 时间：2012-11-04T22:59:52.217
> 
> 标签：opengl, glsl, gpu

我的问题是关于 GLSL 语言的。当我在顶点着色器中运行 for 循环时，循环是在 GPU 上顺序执行还是并行执行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T23:18:50.903

着色器的单个调用不会“并行”执行。同一个着色器的不同调用（例如，同一个顶点着色器，但给定来自两个不同顶点的两个不同输入值）并行执行，但每个着色器按顺序执行（或者如果不是，它必须表现得*好像*它在执行顺序，这是同一件事）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T23:09:28.753

它是按顺序执行的。顶点着色器程序的不同实例在所有处理过的三角形中并行执行。

# http - 用于字节块的 HTTP“内容类型”是什么？

> ID：13223855
> 
> 赞同：60
> 
> 时间：2012-11-04T22:59:55.663
> 
> 标签：http, http-headers, content-type, pickle

在响应客户端的 GET 请求时返回字节块时使用的 HTTP“内容类型”是什么？

在这种情况下，信息负载是使用 Python 的[Pickle](http://docs.python.org/2/library/pickle.html)库序列化的对象。

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2012-11-04T23:05:10.143

你应该使用`application/octet-stream`.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-04T23:54:38.480

您应该使用正确的 MIME 类型：

```
application/python-pickle 
```

这是事实上的标准（这意味着：它不是 application/pickle 或 application/pickle-python）。

RFC2046 指出：

***4.5.3\. 其他应用程序子类型**预计将来会定义许多其他“应用程序”子类型。MIME 实现必须至少将任何无法识别的子类型视为等同于“应用程序/八位字节流”。*

因此，对于非 pickle 感知系统，流看起来像任何其他八位字节流（您不会做任何会破坏现有应用程序的事情），但对于 pickle 感知系统来说，这是至关重要的信息。

# php - 将 Facebook 登录与自己的用户数据库集成

> ID：13223856
> 
> 赞同：1
> 
> 时间：2012-11-04T23:00:14.980
> 
> 标签：php, facebook

也许是一个被问了 1000 次的问题，但我找不到复杂的答案。

我有一个带有自己的用户数据库的 PHP/MySQL 用户登录系统（基于会话）。该结构具有一些用户数据，如年龄、关于我等。

我可以通过编程来完成这一切，没问题，但是 - 我有一些“概念”问题，我希望有人能给我建议：

1.  假设我的用户数据库具有 FB 未涵盖的某些字段。我应该问他们让我们说当用户第一次使用 FB 登录时？
2.  更好地获取配置文件 PIC 并将其保存在本地或从远程服务器读取？
3.  最好将 FB 数据（如姓名、关于我等）保存在本地或一直从远程服务器读取？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T09:56:07.760

> 假设我的用户数据库具有 FB 未涵盖的某些字段。我应该问他们让我们说当用户第一次使用 FB 登录时？

允许用户稍后添加它们或提示他们可以更新他们的少量信息会相当不错

> 更好地获取配置文件 PIC 并将其保存在本地或从远程服务器读取？

取决于，如果您想显示用户的个人资料图片以反映他的当前状态，则使用个人资料图片链接，如果您有空间存储用户的所有图片，那么最好使用本地存储，尽管它可能不会更新，但您可以添加选择选项来上传新的。

> 最好将 FB 数据（如姓名、关于我等）保存在本地或一直从远程服务器读取？

现在为此，我建议您复制在本地检索到的信息，以提高速度，导致一次又一次地取回值会影响页面速度，从而影响用户体验。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T23:11:48.160

1) 我会坚持一些默认设置，并避免要求用户一开始可能只想四处浏览，然后在他们更多参与并想要分享时让他们填写。

2) 我认为 facebook 个人资料图片是一个取决于用户 ID 的 url。只需将用户 ID 附加到图像链接中。

3）我认为可以保存的数据和不能保存的数据有一些规则；如果您已经拥有它，则可以更快地提供它，但它可能会变得陈旧。所以可能会在 24 小时或其他合理的时间范围后再次获取它。即，将其保存在缓存中，如果陈旧则再次获取，如果陈旧则清除缓存以为最近的查询腾出空间。

# php - CSS 不适用于 PHP 脚本

> ID：13223858
> 
> 赞同：3
> 
> 时间：2012-11-04T23:00:16.227
> 
> 标签：php, css

您好，我正在按照本教程制作一个 php 日历

[http://www.youtube.com/watch?v=l76uglZBjpk](http://www.youtube.com/watch?v=l76uglZBjpk)

我有三个文件

show_calendar.php

```
 <!DOCTYPE html>
<html>
<head>
<link href="calCss.css" rel="stylesheet" type="text/css" media="all" />
</head>
<body>
<?php include ("calendar_start.php"); ?>
</body>
</html> 
```

日历开始.php

```
<?php
//$showmonth = $_POST['showmonth'];
//$showyear = $_POST['showyear'];
$showmonth = 11;
$showyear = 2012;

$day_count = cal_days_in_month(CAL_GREGORIAN, $showmonth, $showyear);
$pre_days = date('w', mktime(0,0,0, $showmonth, 1, $showyear));
$post_days = (6 - (date('w', mktime(0,0,0, $showmonth, $day_count,$showyear))));

echo '<div id="calendar_wrap">';
echo '<div class="title_bar">';
echo '<div class="previous_month"></div>';
echo 'div class="show_month">' . $showmonth . '/' . $showyear . '</div>';
echo '<div class="next_month"></div>';
echo '</div>';
echo '<div class="week_days">';
echo '<div class="days_of_the_week">Sun</div>';
echo '<div class="days_of_the_week">Mon</div>';
echo '<div class="days_of_the_week">Tue</div>';
echo '<div class="days_of_the_week">Wed</div>';
echo '<div class="days_of_the_week">Thur</div>';
echo '<div class="days_of_the_week">Fri</div>';
echo '<div class="days_of_the_week">Sat</div>';
echo '<div class="clear"></div>';
echo '</div>';

/* Previous Month Filler Days */
if ($pre_days != 0) {
for($i = 1 ; $i<=$pre_days;$i++) {
    echo '<div class="non_cal_day"></div>';
}
}

/* Current Month */
for($i=1; $i<= $day_count; $i++) {
echo '<div class="cal_day">';
echo '<div class="day_heading">' . $i . '</div>';
echo '</div>';

}
/* Next Month Filler Days */
if ($post_days != 0) {
for ($i=1; $i<=$post_days; $i++) {
     echo '<div class="non_cal_day"></div>';
}
}
echo '</div>';
?> 
```

和 css 文件 calCss.css

```
#calendar_wrap {
width: 924px;
margin-left: auto;
margin-right: auto;
overflow: hidden;
}
.title_bar {
width: 100%; 
height: 30px;
}
.previous_month {
float: left;
width: 308px;
height: 30px;
text-align: left;
}
.show_month {
float: left;
width: 308px;
height: 30px;
text-align: center;
}
.next_month {
float: left;
width: 308px;
height: 30px;
text-align: right;
}
.week_days {
width: 100%;
}       
.days_of_week  {
float: left;
width: 14%;
text-align: center;
}      
.cal_day {
position: relative;
float: left;
margin-right: 4px;
margin-bottom: 4px;
width: 128px;
height: 95px;
background-color: #9C9;
}
.day_heading {
position: relative;
float: left;
width: 40px;
height: 16px;
padding: 6px;
color: #000;
font-family: Arial;
font-size: 14px;
}    
.openings {
width: 100%;
clear:left;
text-align: center;
}
.non_cal_day {
position: relative;
float: left;
margin-right: 4px;
margin-bottom: 4px;
width: 128px;
height: 95px;
background-color: #CCC;
}

.clear {
clear: both;
} 
```

我的问题是 show_calendar.php 没有显示任何仅显示星期几的 css 文本和月份中的数字。我不确定我做错了什么，有人有什么想法吗？我使用 xampp 本地服务器查看 php 文件。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-12T16:36:12.773

我已经检查了所有内容，没有发现这不起作用的原因。可能无法加载您的 css 文件。您应该检查浏览器控制台的内容。

这是调试此问题的方法：

*   在浏览器中启动脚本

*   按**shift + strg + j**启动开发者工具（如果你有 IE，这个快捷方式适用于 Forefox 和 Chrome f12）

*   选择“控制台”

*   检查您的 CSS 是否存在加载错误

    如果您使用的是 Windows，那么第二个问题来源可能是隐藏的文件扩展名。也许您的文件名不是*calCss.css*而是*calCss.css.txt*或类似名称。这只是一个猜测，但我之前遇到过这类问题。如果它适用于您的问题，**[这就是您可以显示隐藏文件扩展名的方式](http://en.kioskea.net/faq/28650-windows-8-display-file-extensions)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-03T22:55:06.740

例如，如果您使用像 (dreamweaver) 这样的 IDE，请确保将 localhost 的 Web URL 设置为 (localhost/myProject) 而不是 (localhost/myProject/index.php) .. 因为它有时会出错，到达css目录..我有那个错误，并且修复了它，希望它对你有用:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T23:34:17.897

我只看到一个小错误：

你忘了一个 < 这里： `echo 'div class="show_month">' . $showmonth . '/' . $showyear . '</div>';`

我像那样测试了它，对我来说很好用..

# c# - 我将如何手动（没有第三方库）从 C# 中的字符串评估方程？

> ID：13223864
> 
> 赞同：2
> 
> 时间：2012-11-04T23:01:00.863
> 
> 标签：c#, asp.net

> **可能重复：**
> [C# - Parse Math Expression](https://stackoverflow.com/questions/3972854/c-sharp-parse-math-expression)
> [C#，用户定义的公式](https://stackoverflow.com/questions/10062875/c-user-defined-formula)

该等式将仅使用加法、减法、乘法、除法运算符，不会使用括号。我不认为它会这么难，但我一直在思考它几个小时，同时尝试不同的事情并写出不同的想法。

我认为可能有某种方法可以通过拆分每个字符上的字符串并对输出做一些事情，或者通过逐个字符循环字符串并想出一些东西，但我猜我不够聪明。

无论如何，我很想听听其他人的想法，因为我很难过。我不想使用某种第三方库，这是每个人在我一直在查看的旧线程中所建议的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-04T23:08:19.907

对于这样简单的方程，它可以用一个拆分和两个循环来实现。

对于这样的字符串：`"4+5*6/2-8"`

拆分运算符，将它们保留在结果中：

```
"4", "+", "5", "*", "6", "/", "2", "-", "8" 
```

遍历运算符并计算乘法和除法，将结果放回列表中：

```
"4", "+", "30", "/", "2", "-", "8"
"4", "+", "15", "-", "8" 
```

再次循环运算符并计算这次的加法和减法：

```
"19", "-", "8"
"11" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T23:21:16.603

最简单的方法是利用 JIT 编译器来评估计算。这就是它的用途。您甚至可以将 Math.Acos(4) 之类的代码传递给表达式，或者在您正在使用的对象中“创建”一个函数 Acos，让用户不必担心数学。字首。

```
string code = string.Format  // Note: Use "{{" to denote a single "{" 
( 
   "public static class Func{{ public static Acos(double d) { return Math.ACos(d); }
                               public static int func(){{ return {0};}}}}", expression 
); 
```

如果您需要任何其他功能，您也可以包含其他名称空间，但如果没有任何额外功能，代码如下所示：

```
using System; 
using System.Reflection; 
using System.CodeDom.Compiler; 

using Microsoft.CSharp; 

class Program 
{ 
   static void Main() 
   { 
      TestExpression("2+1-(3*2)+8/2"); 
      TestExpression("1*2*3*4*5*6"); 
      TestExpression("Invalid expression"); 
   } 

   static void TestExpression(string expression) 
   { 
      try 
      { 
         int result = EvaluateExpression(expression); 
         Console.WriteLine("'" + expression + "' = " + result); 
      } 
      catch (Exception) 
      { 
         Console.WriteLine("Expression is invalid: '" + expression + "'"); 
      } 
    } 

    public static int EvaluateExpression(string expression) 
    { 
      string code = string.Format  // Note: Use "{{" to denote a single "{" 
      ( 
         "public static class Func{{ public static int func(){{ return {0};}}}}", expression 
      ); 

      CompilerResults compilerResults = CompileScript(code); 

      if (compilerResults.Errors.HasErrors) 
      { 
         throw new InvalidOperationException("Expression has a syntax error."); 
      } 

      Assembly assembly = compilerResults.CompiledAssembly; 
      MethodInfo method = assembly.GetType("Func").GetMethod("func"); 

      return (int)method.Invoke(null, null); 
   } 

   public static CompilerResults CompileScript(string source) 
   { 
      CompilerParameters parms = new CompilerParameters(); 

      parms.GenerateExecutable = false; 
      parms.GenerateInMemory = true; 
      parms.IncludeDebugInformation = false; 

      CodeDomProvider compiler = CSharpCodeProvider.CreateProvider("CSharp"); 

      return compiler.CompileAssemblyFromSource(parms, source); 
   } 
} 
```

[答案是从http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/abff98e3-93fe-44fa-bfd4-fcfe297dbc43/](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/abff98e3-93fe-44fa-bfd4-fcfe297dbc43/)复制的，因为我不喜欢自己编写代码，感谢 Matthew华生，我不必。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T00:13:39.803

如评论中所述，我更喜欢[Recursive Descent Parsing 。](http://en.wikipedia.org/wiki/Recursive_descent_parser)这是链接的 Wikipedia 文章中的 C 示例的 C# 中非常快速的*部分改编。*

[我发现一个简单的递归下降比调车场方法](http://en.wikipedia.org/wiki/Shunting-yard_algorithm)更容易阅读（注意递归下降函数如何与 EBNF 非终端定义紧密匹配）并且更具可扩展性。以下可以简单地调整以允许括号或“外部”函数。

更健壮的实现实际上将支持符号类并更优雅地处理无效语法；再一次，添加这样的递归下降解析设置是微不足道的。标记输入（阅读：拆分字符串并将数字转换为双精度）留给读者作为练习。

```
class RecDec {
    St x; // ugly shared state, it's a quick example
    public double eval (params object[] tokens) {
        x = new St(tokens);
        return expression();
    }
    double expression() {
        double res = term();
        string accepted;
        while ((accepted = x.acceptOp(new [] {"+", "-"})) != null) {
            res = accepted == "+"
                ? res + term()
                : res - term();
        }
        return res;
    }
    double term() {
        double res = factor();
        string accepted;
        while ((accepted = x.acceptOp(new [] {"*", "/"})) != null) {
            res = accepted == "*"
                ? res * factor();
                : res / factor();
        }
        return res;
    }
    double factor() {
        var val = x.acceptVal();
        if (val == null) {
            throw new Exception(x.ToString());
        }
        return (double)val;
    }
} 
```

“状态”/token-feader 类：

```
class St {
    IEnumerable<object> src;
    public St (IEnumerable<object> src) {
        this.src = src;
    }
    public object acceptVal () {
        var first = src.FirstOrDefault();
        if (first is double) {
            src = src.Skip(1);
            return first;
        } else {
            return null;
        }
    }
    public string acceptOp (params string[] syms) {
        var first = src.FirstOrDefault();
        if (syms.Contains(first)) {
            src = src.Skip(1);
            return (string)first;
        } else {
            return null;
        }
    }
    public override string ToString () {
        return "[" + string.Join(",", src.ToArray()) + "]";
    }
} 
```

和用法（`Dump`是[LINQPad](http://linqpad.net)扩展方法，使用`eval`返回值适用）：

```
void Main()
{
    var rd = new RecDec();
    // Use results - i.e. Remove Dump - if not on LINQPad
    rd.eval(1d, "+", 2d).Dump();
    rd.eval(2d, "*", 1d, "+", 2d, "*", 9d, "/", 4d).Dump();
} 
```

# php - 军事折扣 PHP

> ID：13223865
> 
> 赞同：-4
> 
> 时间：2012-11-04T23:01:09.780
> 
> 标签：php, discount

目标是在 php 中为（美国）军人制作折扣系统。我在网上搜索了某种 api 来检查某种兵役编号，但找不到。自动实现此功能的最佳方法是什么。手动检查数字不是一种选择，因为这将延迟交易，除非这是唯一可能的方式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T23:10:00.750

根据您的业务性质，最简单的方法是在使用军事 ID 或类似的东西创建帐户时建立身份。由于我假设是安全原因，没有已知的系统可以以编程方式检查服务声明的有效性。

# git - 尽管“文件末尾没有换行符”警告，如何在 git gui 中逐行分段

> ID：13223868
> 
> 赞同：5
> 
> 时间：2012-11-04T23:01:24.540
> 
> 标签：git, newline, git-gui, git-index, line-by-line

我使用*git gui*来选择要为提交暂存的行。这通常像一个魅力。我知道在命令行上执行相同操作的选项。

每当文件最初在文件末尾没有新行时，*git gui*会识别这一点并在编辑器中附加一条警告消息，如屏幕截图所示。

![吉特桂](../Images/c157c2c4d0bbcbb75e8b6af2c5c93255.png)

## 问题

缺少换行符导致的问题是**不能再暂存和提交单独的行**。当我右键单击以选择特定行并`Stage line for commit`从上下文菜单中选择时，会弹出一条错误消息。

> 错误：致命：第 11 行的损坏的 parch。

该问题并非特定于操作系统，可以在 Windows、MacOSX 和 Linux 上重现。我知道如果我在文件中添加一个新行并在继续选择单独的行之前提交这个版本，我可以避免这个问题。

## 重现问题的步骤

1.  初始化一个新的存储库。
2.  创建一个包含三行内容的文件，每行都带有单词“Hallo”。不要在文件末尾添加新行。
3.  添加并提交文件。
4.  编辑同一个文件，将单词放在三行之间。
5.  打开*git gui*并尝试逐行进行更改。

## 要求

我想知道 Git 是否有一些配置可以让我规避这个问题。一些自动操作，例如添加所需新行的钩子也可以。

## 错误报告

我向 Git 邮件列表发送了一个错误报告。[您可以在此处](http://git.661346.n2.nabble.com/git-gui-Warning-quot-No-newline-at-end-of-file-td7571185.html)关注并参与讨论。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-10T08:29:09.127

感谢[Heiko Voigt](http://github.com/hvoigt)，该行为有一个错误修复。我们在[Git-Merge 会议](http://git-merge.com)上解决了这个问题——感谢 GitHub 组织了这个。该补丁目前正在邮件列表中等待处理。一旦它被合并和发布，我就会在这里更新这篇文章。

*   [http://www.mail-archive.com/git@vger.kernel.org/msg25556.html](http://www.mail-archive.com/git@vger.kernel.org/msg25556.html)
*   [http://github.com/hvoigt/git/tree/hv/git-gui-fix-no-newline](http://github.com/hvoigt/git/tree/hv/git-gui-fix-no-newline)

* * *

最后，[gitgui-0.18.0](https://github.com/git/git/tree/gitgui-0.18.0)已合并到[git v1.8.4](https://github.com/git/git/tree/v1.8.4)中，并且是正式版本的一部分（2013 年 8 月 23 日）。现在，无论文件末尾是否有新行，每个人都可以享受逐行提交的乐趣。再次感谢海科！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T11:56:31.920

我找到了一个**预提交钩子**来解决这个问题。虽然，它不是完美的解决方案，因为该修复直到您实际*提交*文件才适用。我为脚本创建了一个要点，所以如果你想改进它，你可以修改它。

*   [预提交钩子](https://gist.github.com/4024222)

原始[脚本由 Matt Baker 发布](http://eng.wealthfront.com/2011/03/corrective-action-with-gits-pre-commit.html)。我将其简化为**添加新行**的事实，但还包括**删除尾随空格**的例程。然而，换行符有一个变化：我添加了`\n`与马特的建议相反的内容。

**问题案例：**

*我在git rebase*工作流程中使用了该脚本。这导致 git 更改所有具有尾随空格的文件。这导致了巨大的差异。因此，我建议考虑使用脚本。

* * *

此外，我发现这个关于如何[将钩子集成到多个存储库](https://stackoverflow.com/questions/2293498/git-commit-hooks-global-settings)中的讨论非常有趣。在设置自己的钩子时，您可能想研究一下。

# ruby-on-rails - ActiveRecord::StatementInvalid: PG::Error: ERROR: cannot execute UPDATE in a read-only transaction error in Heroku

> ID：13223870
> 
> 赞同：8
> 
> 时间：2012-11-04T23:01:47.337
> 
> 标签：ruby-on-rails, postgresql, heroku

我使用追随者在 Heroku 上创建了一个新数据库。在它落后 0 次提交之后，我取消关注主数据库并将其提升为默认值。

似乎工作正常，但看起来是只读的。当我现在尝试从控制台获取记录时，我看到了这个错误

```
ActiveRecord::StatementInvalid: PG::Error: ERROR:  cannot execute UPDATE in a read-only transaction 
```

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-05T13:43:27.230

复制品从未真正得到提升。看评论。

您可以判断副本何时跟随主服务器，因为：

```
SELECT pg_is_in_recovery(); 
```

将返回真。这不能在主服务器中返回 true，因为主服务器唯一可以恢复的时间是它仍在启动时 - 然后您无法连接到它，因此您无法运行该命令。从 9.2 和 9.3beta 开始就是这样；这可能会在未来的版本中发生变化，因此如果您正在阅读本文并在较新的版本中检查用于检查服务器是否为副本的专用功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-04T16:30:02.677

在某些情况下，您需要在活动记录控制台上明确设置写入模式。尝试运行：

`readwrite!`

这可能与 Heroku 控制台没有直接关系，但我想我会在这里为任何需要这个特定解决方案的人发帖。

# c# - 会话超时时注销用户

> ID：13223874
> 
> 赞同：0
> 
> 时间：2012-11-04T23:02:10.160
> 
> 标签：c#, asp.net-mvc, session, asp.net-mvc-4, global-asax

我正在创建一个 mvc4 应用程序，在这里我正在创建一个 cookie，以便用户根据他们的角色和事物访问各种页面。但我有不同的疑问。人们通常倾向于关闭浏览器窗口，而不是注销。因此，当发生这种情况时，我使 cookie 不存储登录中的任何数据（或者我认为这就是发生的情况，根据我目前阅读的博客和答案！）

我只希望 10 个用户一次访问该站点。因此，当用户关闭浏览器或会话结束时，我希望它执行 LogOff 函数来跟踪登录的人数并打开该端口会话以供其他人使用。

我尝试在 global.asax 页面中添加 session_end ，但它似乎永远不会到达那里。出于测试目的，我让它在几分钟内到期。但它确实会转到同一个 global.asax 页面中的 Session_start。

关于如何让它发挥作用的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T23:59:04.013

这是我必须做的（希望它不傻！）：在 web.config 中，需要在此处添加超时以触发 session_end `<system.web> <sessionState mode ="InProc" timeout="10"/> </system.web>` 虽然，在同一个 web.config 中这里有超时，但我不知道它去了哪里.

```
<authentication mode="Forms">
    <forms loginUrl="/SiteUsers/Logon" timeout="10" />
    </authentication> 
```

如果你们有其他方法来解决这个问题，请告诉我，我全神贯注！我仍处于尝试和测试所有阶段，因此将不胜感激任何帮助:)

多谢你们！希望这有助于解决某人的问题。

# objective-c - 我的根视图控制器出现错误

> ID：13223876
> 
> 赞同：-1
> 
> 时间：2012-11-04T23:02:21.387
> 
> 标签：objective-c, ios

我知道这是一个非常常见的错误.. 我正在使用情节提要并且收到此错误，这是我的[AppDelegate.m 屏幕截图](http://i.stack.imgur.com/GdLe3.jpg)

请记住，我是初学者，其原因可能很愚蠢:)提前致谢！

（这不是错误，但我只是在模拟器上出现黑屏）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T23:04:07.583

利用：

```
window.rootViewController = viewController; 
```

代替：

```
[window addSubview:viewController.view]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T23:22:40.773

如果我没记错的话，您`UIWindow`在使用情节提要时不会自己创建。使用情节提要时，`UIWindow`将为您创建主要内容。由于您创建了自己的`UIWindow`，它只是重叠并覆盖了现有的`UIWindow`. 通过将该箭头指向它来设置`rootViewController`它。`.storyboard`

顺便问一下，您是创建了单视图应用程序还是空应用程序？

# python - 使用 Python 解析 DNS rdata

> ID：13223879
> 
> 赞同：4
> 
> 时间：2012-11-04T23:03:19.243
> 
> 标签：python

我还想通过解析 TXT 字段数据来扩展下面的代码。我只是添加了对 TXT 字段的检查并开始解析数据。但是 rdata 字段采用小端格式。我打算使用正则表达式去除 Base64 编码字符串带来的垃圾，我认为会有更好的方法来做到这一点。

[原始代码](https://mmishou.wordpress.com/2010/04/13/passive-dns-mining-from-pcap-with-dpkt-python/)

```
#!/usr/bin/env python

import dpkt, socket, sys

if len(sys.argv) < 2 or len(sys.argv) > 2:
 print "Usage:\n", sys.argv[0], "filename.pcap"
 sys.exit()

f = open(sys.argv[1])
pcap = dpkt.pcap.Reader(f)

for ts, buf in pcap:
 # make sure we are dealing with IP traffic
 # ref: http://www.iana.org/assignments/ethernet-numbers
 try: eth = dpkt.ethernet.Ethernet(buf)
 except: continue
 if eth.type != 2048: continue
 # make sure we are dealing with UDP
 # ref: http://www.iana.org/assignments/protocol-numbers/
 try: ip = eth.data
 except: continue
 if ip.p != 17: continue
 # filter on UDP assigned ports for DNS
 # ref: http://www.iana.org/assignments/port-numbers
 try: udp = ip.data
 except: continue
 if udp.sport != 53 and udp.dport != 53: continue
 # make the dns object out of the udp data and check for it being a RR (answer)
 # and for opcode QUERY (I know, counter-intuitive)
 try: dns = dpkt.dns.DNS(udp.data)
 except: continue
 if dns.qr != dpkt.dns.DNS_R: continue
 if dns.opcode != dpkt.dns.DNS_QUERY: continue
 if dns.rcode != dpkt.dns.DNS_RCODE_NOERR: continue
 if len(dns.an) < 1: continue
 # now we're going to process and spit out responses based on record type
 # ref: http://en.wikipedia.org/wiki/List_of_DNS_record_types
 for answer in dns.an:
   if answer.type == 5:
     print "CNAME request", answer.name, "\tresponse", answer.cname
   elif answer.type == 1:
     print "A request", answer.name, "\tresponse", socket.inet_ntoa(answer.rdata)
   elif answer.type == 12:
     print "PTR request", answer.name, "\tresponse", answer.ptrname 
```

我添加了

```
elif answer.type == 16:
     print "TXT request", repr(answer.name), "\tresponse", repr(answer.rdata) 
```

输出

```
Cr\xe0ax\xdac`\xe0`p\xe5`0\xf9\x9b\xe3\xc0\xe0\xc0\xf6\xf5\xd7\x81\x15\xc9\x8c@\xcc\xc4 \xb6\xfd\x98\xa7\x8dA\xd9\xf9\nI\xf7\x06\x01\xc6\xf9\x06\xb7\x19\x18\x18\x199\xb8\x18\x98_81\xc8\xfc\xb2\x05\x00\xef|\x115 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T23:18:44.933

包[dnslib](http://pypi.python.org/pypi/dnslib)具有编码/解码 DNS 有线格式数据包的功能。

# html - 即使没有任何东西，也要保持跨度的宽度

> ID：13223884
> 
> 赞同：20
> 
> 时间：2012-11-04T23:04:06.547
> 
> 标签：html, css

如果跨度为空，是否可以以某种方式保持跨度的宽度？

我有以下 HTML 伪表：

```
<p><span class="col1">Day:</span><span class="col2"><?php echo somephp ?></span></p>
<p><span class="col1">Time:</span><span class="col2"><?php echo somephp ?></span></p>
<p><span class="col1">Class:</span><span class="col2"><?php echo somephp ?></span></p>
<p><span class="col1">Teacher:</span><span class="col2"><?php echo somephp ?></span></p> 
```

使用 CSS：

```
span.col1 {width: 100px;float: left;}
span.col2 {width: 100px;} 
```

有时，在 col2 中回显的 PHP 是空的，当这种情况发生时，col2 的宽度为 0，并且下面段落中的 col1 最终堆积在上面段落中 col1 旁边。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-11-04T23:06:56.203

您的`col2`跨度忽略了宽度，因为它们是内联元素。您需要使它们成为内联块元素。

```
span.col2 { width: 100px; display: inline-block } 
```

另外请记住，您*可能*需要根据显示的位置为其添加高度，否则您最终会得到一个 100 像素宽但 0 像素高的跨度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T23:08:02.670

默认情况下`span`显示为内联。

因此，要么添加`display:block`给它一个块元素，要么另外你可以使用`display:inline-block`它来保持它与文本的其余部分内联（不使用`float`）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T23:06:40.517

默认 span 元素是一个内联元素，它会忽略宽度。

尝试将 display:block 添加到您的跨度。

```
span.col1 {width: 100px;float: left; display:block;}
span.col2 {width: 100px; display:block;} 
```

希望能帮助到你。

# iphone - iOS6游戏中心无法加载分数

> ID：13223891
> 
> 赞同：0
> 
> 时间：2012-11-04T23:04:41.657
> 
> 标签：iphone, ios, game-center

很长一段时间以来，我一直在使用苹果示例 GKTapper（从 2010 年开始）来管理分数。它在 iOS6 中停止工作。我不确定该怎么做，因为我添加了以下代码段，而排行榜仍然显示“无法加载”。（我能够登录，但没有加载任何分数）。请帮忙！

```
#define SYSTEM_VERSION_LESS_THAN(v) ([[[UIDevice currentDevice] systemVersion] \
compare:v options:NSNumericSearch] == NSOrderedAscending)

- (void) authenticateLocalUser
{

if([GKLocalPlayer localPlayer].authenticated == NO)
{

 if (SYSTEM_VERSION_LESS_THAN(@"6.0"))
 {

     [[GKLocalPlayer localPlayer] authenticateWithCompletionHandler:^(NSError *error)
      {
          [self callDelegateOnMainThread: @selector(processGameCenterAuth:) withArg: NULL error: error];
      }];
 }else{

     [[GKLocalPlayer localPlayer] setAuthenticateHandler:(^(UIViewController* viewcontroller, NSError *error) {
         if (!error && viewcontroller)
         {
             [self callDelegateOnMainThread: @selector(processGameCenterAuth:) withArg: NULL error: error];
         }
         else
         {
             //do nothing
         }
     })];
 }
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T19:05:52.823

对于 iOS6，您必须自己呈现 UIViewController。这是在 processGameCenterAuth: 中完成的吗？

IOW 你需要这样的代码：

```
[self presentViewController: viewcontroller]; 
```

块内。

# objective-c - 通过块完成回调将 AFNetworking AFXMLRequestOperation 集成到我自己的方法中

> ID：13223898
> 
> 赞同：0
> 
> 时间：2012-11-04T23:05:36.483
> 
> 标签：objective-c, ios, objective-c-blocks, afnetworking

我正在使用`AFXMLRequestOperation`奇妙的方法`AFNetworking`。我想使用的是使用以下内容，但使用我自己的完成回调将我自己的方法包裹起来。

```
NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL URLWithString:@"http://api.flickr.com/services/rest/?method=flickr.groups.browse&api_key=b6300e17ad3c506e706cb0072175d047&cat_id=34427469792%40N01&format=rest"]];
AFXMLRequestOperation *operation = [AFXMLRequestOperation XMLParserRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, NSXMLParser *XMLParser) {
  XMLParser.delegate = self;
  [XMLParser parse];
} failure:nil];
[operation start]; 
```

是否可以执行以下操作？

```
+ (void)makeRequestWithURL:(NSURL *)url completion:(void (^)(BOOL finished))completion {

    NSURLRequest *request = [NSURLRequest requestWithURL:url]];
    AFXMLRequestOperation *operation = [AFXMLRequestOperation XMLParserRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, NSXMLParser *XMLParser) {
        XMLParser.delegate = self;
        [XMLParser parse];
    } failure:nil];
    [operation start];

    if (completion) {
        // How can I call my cometion block when AFXMLRequestOpersation is finished?
    }

} 
```

然后使用以下命令调用它：

```
[MyClass makeRequestWithURL:url completion^(BOOL finished){
        if (finished) {
            NSLog(@"AFNetworking Finished");
        }
}]; 
```

我可以知道`AFNetworking`我的完成块何时完成吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T23:25:17.477

只需在成功块中调用您的完成块：

```
+ (void)makeRequestWithURL:(NSURL *)url completion:(void (^)(BOOL finished))completion {

    NSURLRequest *request = [NSURLRequest requestWithURL:url]];
    AFXMLRequestOperation *operation = [AFXMLRequestOperation XMLParserRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, NSXMLParser *XMLParser) {
        XMLParser.delegate = self;
        [XMLParser parse];
        // call completion block here
        if (completion) {
          completion(YES);
        }

    } failure:nil];
    [operation start];
} 
```

您还应该实现`AFXMLRequestOperation`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T23:28:48.103

假设无论结果如何，都会运行完成块，并且 BOOL 显示成功/失败，它需要如下所示：

```
NSURLRequest *request = [NSURLRequest requestWithURL:url]];
AFXMLRequestOperation *operation = [AFXMLRequestOperation XMLParserRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, NSXMLParser *XMLParser) {
  XMLParser.delegate = self;
  [XMLParser parse];

  if (completion) {
    completion(YES);
  }

} failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, NSXMLParser *XMLParse) {

  if (completion) {
    completion(NO);
  }

}];
[operation start]; 
```

# php - .htaccess 整洁的 url，如果 $_GET 数据有空间，它会重定向到 404 页面

> ID：13223902
> 
> 赞同：2
> 
> 时间：2012-11-04T23:06:05.447
> 
> 标签：php, .htaccess

我使用 .htaccess 将我的网址从

```
www.mysite.com/profile.php?name=name 
```

到

```
www.mysite.com/name/name 
```

但是我遇到了一个问题，如果名称有空格而不是显示用户数据，它会将我带到我的 404 页面。我已经对名称进行了编码，因此如果有空格，它会用 %20 替换它，但它仍然不工作..没有空格的名字工作得很好

重写规则：

```
RewriteEngine On
RewriteRule ^([a-zA-Z0-9_-]+)$ profile.php?name=$1
RewriteRule ^([a-zA-Z0-9_-]+)/$ profile.php?name=$1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T23:31:51.520

看看你的重写规则。你有一个正则表达式，上面写着“一个或多个字母或数字”：

[a-zA-Z0-9_-]+

空格不是其中之一。这就是为什么它不匹配。将 \s 添加到正则表达式：

[a-zA-Z0-9_-\s]+

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T23:32:04.560

您用于重写的正则表达式不考虑空格或编码字符。相反，它只匹配字母、数字、下划线或破折号。

试试这个：

```
RewriteRule /(.+) /profile.php?name=$1 [L] 
```

根据您的示例，我希望该规则看起来更像：

```
RewriteRule /name/(.+) /profile.php?name=$1 [L,QSA] 
```

这将匹配整个 GET 路径并将其作为 $1 传递给重写。如果您需要附加其他查询字符串参数，请参阅`QSA`标志。

# spring - 休眠logback sql

> ID：13223905
> 
> 赞同：6
> 
> 时间：2012-11-04T23:06:35.227
> 
> 标签：spring, hibernate, logback, spring-data

我想在使用 Hibernate 时查看我的 SQL 查询的实际参数。我将此添加到我的 logback.xml 以查看查询（带问号）：

```
<logger name="org.hibernate.type" level="TRACE" /> 
```

但没有效果。

有什么必要的特殊配置吗？

OnConsoleStatusListener 向我展示了正确的配置

```
23:48:15,246 |-INFO in ch.qos.logback.classic.joran.action.LoggerAction - Setting level of logger [org.hibernate.type] to TRACE 
```

但 org.hibernate.type 包没有输出。

我正在将 Spring 与 Jpa 一起使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T01:27:51.930

您必须确保的事项：

1.  你确定 SLF4J + LogBack 在你的应用程序中工作吗？
2.  您的记录器是否指向任何附加程序？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T13:55:28.027

我正在使用这个配置，它对我有用：

```
<logger name="org.hibernate.type" level="trace" additivity="false">
  <appender-ref ref="consoleAppender" />
</logger> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-13T01:42:45.380

适合我的记录器如下：

```
<logger name="org.hibernate.type" level="TRACE" /> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-05T02:01:03.723

你配置了一个附加的？

```
<configuration>
  <appender name="FILE" class="ch.qos.logback.core.FileAppender">
    <!-- "application-name" is a variable -->
    <File>c:/logs/${application-name}.log</File>
    <layout class="ch.qos.logback.classic.PatternLayout">
      <Pattern>%d %p %t %c - %m%n</Pattern>
    </layout>
  </appender>
  <root level="debug">
    <appender-ref ref="FILE"/>
  </root>
</configuration> 
```

# php - mysql_query 在自定义 php 函数中不起作用

> ID：13223907
> 
> 赞同：2
> 
> 时间：2012-11-04T23:06:47.067
> 
> 标签：php, mysql

我无法让 mysql 查询在函数中工作。我不明白为什么会这样：

```
 $datetime = date('m/d/Y h:i:s a', time());

    $query = "INSERT INTO 1_posts (title_post, time_post, key_words_post, content_post) VALUES ('$title2', '$datetime', '$keywords2', '$text2')";

    mysql_query($query, $con); 
```

但这不会：

```
function insert_post($title2, $keywords2, $text2)
{

    $datetime = date('m/d/Y h:i:s a', time());

    $query = "INSERT INTO 1_posts (title_post, time_post, key_words_post, content_post) VALUES ('$title2', '$datetime', '$keywords2', '$text2')";

    mysql_query($query, $con);

} 
```

当然，我有一个到数据库的连接，我正在调用该函数。我试图用一些回声进行调试，我发现该函数停止了 ant mysql_query，但我不知道为什么。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-04T23:08:41.313

```
function insert_post($title2, $keywords2, $text2)
{
 global $con;
    $datetime = date('m/d/Y h:i:s a', time());

    $query = "INSERT INTO 1_posts (title_post, time_post, key_words_post, content_post) VALUES ('$title2', '$datetime', '$keywords2', '$text2')";

    mysql_query($query, $con);

} 
```

是一种让它工作的肮脏方式（$con 没有在你的函数中设置）。但是请看一下PDO！

# opengl - openGL中移动相机的问题

> ID：13223910
> 
> 赞同：1
> 
> 时间：2012-11-04T23:07:15.383
> 
> 标签：opengl

好的，我想首先说我知道我实际上并没有移动相机，但这样更容易解释。

我的问题是我试图在自上而下的 2d rpg 中使用我的角色移动相机，但我找不到正确的方法。我知道 glTranslate() 但是我只能使用速度而不是 x 和 y 坐标。我不确定如何移动相机以记住增量。我什至不知道 glTranslate() 是否是我应该使用的方法。

如果我没有任何意义（这很可能），这是我的一些代码。

我的测试while循环：

```
while(!Keyboard.isKeyDown(Keyboard.KEY_ESCAPE)&&!Display.isCloseRequested())
    {
        glClear(GL11.GL_COLOR_BUFFER_BIT);

        delta=getDelta();
        update(delta);
        glTranslatef(speedx, speedy, 0);

        level1.checkCurrent(x, y);
        level1.draw();
        Display.update();
        Display.sync(60);
    } 
```

这是我设置速度的地方：

```
 if(Keyboard.isKeyDown(Keyboard.KEY_DOWN))
    {
        y+=0.5*delta;
        screenY+=0.5*delta;
        speedy=(int) (-0.5*delta);
        direction=2;
    }
    else if(Keyboard.isKeyDown(Keyboard.KEY_UP))
    {
        y-=0.5*delta;
        screenY-=0.5*delta;
        speedy=(int) (0.5*delta);
        direction=8;
    }
    else
        speedy=0; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T00:05:12.043

现在，您将 OpenGL 视为场景图。然而，OpenGL 只是为了在屏幕上绘制东西。无论您做什么，您都应该始终以某种方式考虑您的问题，就好像所有其他基础设施都不存在一样。

你想加速一个物体？好吧，那么您需要随着时间增加一些速度变量，并且该速度变量乘以时间会添加到位置。本质上是牛顿运动定律：

```
a = dv/dt => v = a*t + v_0
v = dr/dt => r = v*t + r_0 = a*t² + v_0*t + r_0 
```

您对每个对象进行评估。然后在*绘制*动画时，使用状态相应地放置对象几何体。

# django - collectstatic 命令正在将静态文件上传到根目录

> ID：13223913
> 
> 赞同：1
> 
> 时间：2012-11-04T23:07:32.590
> 
> 标签：django, amazon-s3

您在哪里设置命令`collectstatic`上传文件的路径？

我以为是`STATIC_ROOT`。我的设置如下`settings.py`

`STATIC_ROOT = 'http://%s.s3.amazonaws.com/static/' % AWS_STORAGE_BUCKET_NAME`

但是，它将我的文件上传到`http://%s.s3.amazonaws.com/`根目录而不是`static`文件夹中并将其转储。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T03:20:26.497

`STATIC_ROOT`用于`django.contrib.staticfiles.storage.StaticFilesStorage`标识将静态文件写入的本地文件系统路径。这不是你想要做的。

相反，您需要[从云服务或 CDN 提供静态文件的操作](https://docs.djangoproject.com/en/dev/howto/static-files/#staticfiles-from-cdn)方法。正如该指南所建议的那样，您需要来自某个项目的存储后端，例如[django-storages](http://code.larlet.fr/django-storages/)。

# c# - 为什么 ShowDialogue() 在 Show() 中设置 Visible = false 时会触发 Close()？

> ID：13223917
> 
> 赞同：1
> 
> 时间：2012-11-04T23:07:47.880
> 
> 标签：c#, winforms

当我在 ShowDialogue() 显示的表单的显示事件中设置 Visible = false 时，表单将自动调用它的关闭事件。我不想关闭表单...只是隐藏它。所以我必须改为调用 Show() 。但是，这不会阻止。

为什么使用 ShowDialogue() 设置 Visible = false 会导致表单接近触发？这是一个错误吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T18:22:24.080

尝试触发`Show()`，而不是`ShowDialogue()`，如果它不起作用，您可以尝试使用`Hide()`或修改该`Opacity`属性。

# visual-studio-2010 - 如果我通过 Windows Phone Express 安装 VS 2010 Ultimate，会不会搞砸

> ID：13223928
> 
> 赞同：0
> 
> 时间：2012-11-04T23:09:01.663
> 
> 标签：visual-studio-2010

我有 VS 2010 Windows Phone Express，但它不包含我需要的功能。如果我在该版本的 Visual Studio 上安装 Ultimate，有什么事情会搞砸吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T23:19:05.890

不，这两种产品应该可以很好地并排工作。

# java - 是否有跨 JVM 的 Java 信号量？

> ID：13223930
> 
> 赞同：2
> 
> 时间：2012-11-04T23:09:12.013
> 
> 标签：java, semaphore

C# Semaphore 类有一种模式，您可以在其中命名它，并且同一台机器上的多个应用程序可以访问该信号量。Java有这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T23:23:42.943

要加入另一种选择，您可以使用带有[Jedis 客户端库](https://github.com/xetorthio/jedis/blob/master/README.md)[的外部 Redis 服务器](http://redis.io/)和[类似的技术](http://www.davidverhasselt.com/2011/08/06/a-distributed-mutex-and-semaphore-using-redis/)来构建信号量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T23:25:30.430

如果您正在执行基于 RMI 的 RPC，那么构建共享同步器将是微不足道的。`java.util.concurrent`用远程对象包装信号量可以正常工作。取决于您的用例...这不是您可以做的对性能最敏感的事情，尤其是当您谈论的是同一节点上的共享 Jvm 时。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T23:15:31.260

*我们需要更深入*——在[hazelcast](/questions/tagged/hazelcast "显示标记为“hazelcast”的问题")中有一个分布式信号量可以在整个网络中工作：[`ISemaphore`](http://www.hazelcast.com/docs/2.4/javadoc/com/hazelcast/core/ISemaphore.html). 但这并不是您想要的，简单的答案是：不，Java 没有这样的工具。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-04T23:15:51.973

Java 不支持此功能。

但是，开源 Java 库 CLIPC 链接到 DLL 以提供本机信号量功能。

[http://clipc.sourceforge.net/](http://clipc.sourceforge.net/)

# php - 如何防止 iframe 中的网站刷新整个网站？

> ID：13223931
> 
> 赞同：0
> 
> 时间：2012-11-04T23:09:13.823
> 
> 标签：php, javascript, jquery, html, mysql

我的网站中有一个简单的 iframe，可以显示其他网站。用户提交他们的网站，然后其他用户可以在我网站的 iframe 中查看该网站。它很好用，但问题是某些网站会刷新整个网站，用户最终会离开我的网站并访问 iframe 中的网站。我将如何防止这种情况发生？我不介意用户是否单击链接并离开我的网站，但我不希望他们最初离开我的网站。非常感谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T23:54:23.373

但是，如果您不希望他们离开，您可以随时使用目标选项在另一个窗口中打开该链接。

# c - UNIX 中的编程 - 信号量，C 中的共享内存

> ID：13223935
> 
> 赞同：1
> 
> 时间：2012-11-04T23:09:42.100
> 
> 标签：c, unix, shared-memory, semaphore

一周前我开始理解和使用信号量和共享内存，并实际创建了这个程序，问题是我找不到任何问题我一直在看它几个小时，一切似乎都是正确的。代码编译，我可以创建构建但是当我执行它时没有任何反应......

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/ipc.h> 
#include <sys/shm.h>
#include <stdio.h>
#include <sys/fcntl.h>
#include <semaphore.h>

#define MAXCHILDS 4
#define MAX_SIZE 10
#define MAX_WRITES 4

typedef struct{
    int m[MAX_SIZE][MAX_SIZE];
} matrix;

/*fork variables*/
pid_t child[MAXCHILDS];
/*semphores variables */
sem_t *empty, *full, * mutex;
/*share memory id*/
int shmid;
/*shared memory array pointer */
matrix * sh_mem;
/*pointer to matrix*/
int **p;

void init(){
      /*create pointer to matrix*/
      p = &sh_mem->m;
     /*semaphores unlink and creation */    
     sem_unlink("EMPTY");
     empty=sem_open("EMPTY",O_CREAT|O_EXCL,0700,MAX_WRITES);
     sem_unlink("FULL");
     full=sem_open("FULL",O_CREAT|O_EXCL,0700,0);
     sem_unlink("MUTEX");
     mutex=sem_open("MUTEX",O_CREAT|O_EXCL,0700,1);
    /*initialize shared memory */
    shmid = shmget(IPC_PRIVATE,sizeof(matrix),IPC_CREAT|0777);
    /*map shared memory*/
    sh_mem = (matrix*)shmat(shmid,NULL,0);
    if(sh_mem== (matrix*)(-1)){
        perror("shmat");
    }
}
void writer(int ** m){
    int i,k;
    for(i = 0;i<MAX_SIZE;i++){
        for(k= 0;k<MAX_SIZE;k++){
            m[i][k] = 0;
        }
    }

}
void reader(int **m){
    int i = 0;
    int k = 0;
    for(i = 0;i<MAX_SIZE;i++){
        for(k= 0;k<MAX_SIZE;k++){
            printf(m[i][k]);
        }
        printf("\n");
    }

}

void terminate() {
  sem_close(empty);
  sem_close(full);
  sem_close(mutex);
  sem_unlink("EMPTY");
  sem_unlink("FULL");
  sem_unlink("MUTEX");
  shmctl(shmid, IPC_RMID, NULL);
}

int main(int argc, char **argv)
{
    int i;
    init();

    for(i = 0;i<MAXCHILDS;i++){
        if((child[i]= fork()) < 0) // error occured
        {
            perror("Fork Failed");
            exit(1);
        }
        if((child[i] =fork())==0){
            writer(p);
            exit(0);
        }
    }
    /*father*/  
    reader(p);
    wait(NULL);

    terminate();

    return 0;
} 
```

孩子应该在共享内存中写入矩阵，而父亲应该读取共享内存数组并打印矩阵。你能帮我解决这个问题吗？谢谢您的帮助 ...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T01:59:17.780

您的代码有几个问题。

*   你声明你的`p`变量如下：

    ```
    int **p; 
    ```

    但是您的数组的实际类型是`int[MAXSIZE][MAXSIZE]`. 尽管它们都可以被视为二维数组，但它们根本不是同一类型，并且在内存中不共享相同的结构：

    *   `int **`是一个指向整数的指针。当用作二维数组时，它描述了一个 2 级数组。第一级（取消引用指针一次）包含一个`int *`指针数组，每个指针指向一维整数数组。
    *   `int[MAXSIZE][MAXSIZE]`是一个平面二维数组。`MAXSIZE*MAXSIZE`它是指向整数数组的单个指针。`int[MAXSIZE*MAXSIZE]`尽管它提供了使用 2 级下标的便利，但它具有与一维数组相同的内存结构。

    在 C 中传递指向`type[][]`-style 数组的指针是不直观的，并且很难正确处理。我不建议这样做。您可能会考虑将指针传递给您的`matrix`类型。尽管如此，还是可以让它与这个声明一起工作：

    ```
    typedef int array2d[MAX_SIZE][MAX_SIZE];
    array2d *p; 
    ```

    那么您必须将`m`参数更改为`reader`and`writer`来`array2d *m`代替 or`int **m`并将其用作`*m`而不是 just `m`。这变得丑陋。就像我说的，考虑改用你的`matrix`类型。

    这个问题应该已经被编译器发现了。它应该给你很多类型不匹配的警告。确保您始终编译`gcc -Wall`并旨在让您的程序编译时没有错误和警告。

*   在`init()`中，你设置`p`得太早了。您应该在分配后将其设置在函数的末尾`sh_mem`，而不是在函数的开头。

*   正如上面的评论中所讨论的，你在你的函数中`fork()`处理了太多的进程。`main()`您可能打算`fork()`每次通过`for`循环只调用一次，而不是两次。

*   您不必等到编写者完成了共享内存结构的填写后，才继续阅读其内容。

    请注意，即使您`wait(NULL)`在调用之前将您的移动到`reader()`，这还不够，因为`wait(NULL)`只会等待一个子进程完成，而不是所有子进程。

通常，您应该在启用警告的情况下编译您的程序，注意警告，并在想知道您的程序可能有什么问题之前修复它们。如果它仍然做一些意想不到的事情，你应该在调试器下运行它，使用断点，检查变量，并尝试看看发生了什么。使用这两种技术，您可能已经解决了您的问题，而无需在此处发布。

# objective-c - @property & @synthesize

> ID：13223938
> 
> 赞同：-3
> 
> 时间：2012-11-04T23:09:51.753
> 
> 标签：objective-c, ios

> **可能重复：**
> [@property @synthesize](https://stackoverflow.com/questions/2032826/property-synthesize)

我对这两种方法有点困惑，有人可以向我解释一下吗？

他们做什么，为什么他们比只使用 -(void)variable 更好；和 -(void)variable{}?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T23:18:54.640

> 他们在做什么

它们分别声明和实现属性访问器方法（getter 和 setter）。`@property`声明，`@synthesize`告诉编译器为声明的方法发出一个自动生成的实现。

> 为什么它们比仅使用 -(void)variable 更好；和 -(void)variable{}?

因为它们更短，所以更简洁并使代码更具可读性。此外，它们本身没有错误——如果你要编写一堆访问器方法，我相信你最终会错过一些东西，而且你不能看在上帝的份上，知道一个神秘的分段错误来自哪里。声明的属性不会发生这种情况（因此它们被称为）。

一个小警告是旧的 Objective-C 编译器不支持声明的属性。可能是这样的情况（尽管可能性很小），有一天您需要使用旧的编译器编译代码，并且由于这种语法，这是不可能的。但同样，这不太可能发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T23:18:15.247

这只是为变量定义标准 getter/setter 方法的一种更方便的方法，因为一遍又一遍地编写简单的标准 getter 和 setter 方法可能是一个真正的痛苦......并且属性提供了一种简单的内存管理方法（例如强的、非原子的等等）。

# vim - Windows 7 和 gVim makeprg/shellpipe 设置以显示构建输出

> ID：13223940
> 
> 赞同：4
> 
> 时间：2012-11-04T23:10:06.483
> 
> 标签：vim

我正在尝试在 Windows 上设置 vim 以像在 Linux 中一样工作。基本上，当我在 linux 中键入 ":make" 时，我会通过 vim 本身获得 makeprg 的流式输出。

在 Windows 上，我得到一个 cmd 提示，但在 vim 后面。我必须切换焦点以查看结果，直到它们完成，然后可以在 quickfix 窗口中查看它们。

我尝试下载“tee”的副本并将shellpipe 设置为|tee，但这并没有真正改变任何东西。以下是我的 vimrc 中的相关设置，我使用 ninja，但如果我切换到 nmake 或类似的东西，也会发生同样的情况。

```
set makeprg=ninja\ -C\ build-ninja
set shellpipe=2>&1\ \|tee
set efm+=%Dninja:\ Entering\ directory\ `%f',%Xninja:\ leaving\ directory 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T02:27:47.727

我认为[这](https://stackoverflow.com/questions/12886722/vim-autocmd-silent-execution)与您想要的有关，但仅提供部分解决方案，因为它不会等到程序完成运行：

> 设置 makeprg=start\ /min\ ninja\ -C\ build-ninja

让它工作并非易事（见评论），这似乎是对 Windows 版本的 Vim 的重要疏忽，因为 start 不能从 makeprg 执行（见评论），只能从内部（更有限的 !start）执行。

[您可以在这个问题](https://serverfault.com/questions/31608/can-i-run-a-gui-program-in-the-background-on-the-windows-command-line/31621#31621)中找到启动程序的完整文档（您似乎需要以某种方式调用）

# javascript - .replaceWith jquery

> ID：13223942
> 
> 赞同：0
> 
> 时间：2012-11-04T23:10:36.810
> 
> 标签：javascript, jquery, html

我正在为我正在设计的 web 应用程序使用 jquery 的 .replaceWith() 函数。我的 HTML 是这样的：

```
{% for service in services %}                   
<div id="service" name="name" value="{{service.name}}">
{{service.name}} <a href='main/name/{{service.name}}'> Click if you want to see more </a>
<div id="rating_services">
<form name="rating">
{% csrf_token %}
    <input name="star1" id="star_1" type="radio" class="star" value="1"/>
<input name="star1" id="star_2" type="radio" class="star" value="2"/>
<input name="star1" id="star_3" type="radio" class="star" value="3"/>
<input name="star1" id="star_4" type="radio" class="star" value="4"/>
<input name="star1" id="star_5" type="radio" class="star" value="5"/> 
<input type="submit" class="button" id="submit_btn" value="Rate this agency!">
</form>
{% endfor %}
</div> 
```

我的javascript是这样的：

```
$(function() 
{  
$(".button").click(function()
  {  
  $('#rating_services').replaceWith("<div id='thanks'> Thanks! </div>");    
  }
}); 
```

我想做的是用户是否评分。显示感谢而不是评分。但是，信息显示在 for 循环中（用于显示多个“代理”）。所以，我只能一个一个地评价，一次一个。如何更改它以便我可以不按顺序进行评分？我试图将 div 更改`id`为`{{forloop.counter}}`，但随后 javascript 可以处理`#`和`{{forloop.counter}}`。有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T23:22:01.017

我认为`div`由于您的循环，您有多个 ID 为“rating_services”的 s？

如果是这样，而不是硬编码`div`你想替换的 ID，你应该给每个`div`sa 类（即，`class="rating_services"`而不是），然后使用 jQuery 函数动态`id="rating_services"`检索，如下所示：`div``closest()`

```
$(function()
{
  $(".button").click(function()
    {
      $(this).closest('.rating_services').replaceWith("<div id='thanks'> Thanks! </div>");
    }
  );
}); 
```

更多关于最接近（）函数的信息：http: [//api.jquery.com/closest/](http://api.jquery.com/closest/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T23:24:59.877

```
$(function() {
    $("form[name=rating]").submit(function(e) {
        e.preventDefault();
        $('#rating_services').replaceWith("<div id='thanks'> Thanks! </div>");
    });
}); 
```

[**小提琴**](http://jsfiddle.net/FrSCA/1/)

不要将`click`处理程序绑定到提交按钮，而是将处理程序绑定`submit`到表单和[`preventDefault()`](http://api.jquery.com/event.preventDefault/)事件，这样页面就不会提交给自己。

* * *

此外，如果您的模板生成了重复的 ID，那是无效的 HTML，JS 将无法正常工作。

您应该改用类：

```
<div class="rating_services"> 
```

和 JS：

```
$(function() {
    $("form[name=rating]").submit(function(e) {
        e.preventDefault();
        $(this).closest('.rating_services').replaceWith("<div id='thanks'> Thanks! </div>");
    });
}); 
```

[**小提琴**](http://jsfiddle.net/FrSCA/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T23:23:19.210

由于点击是在按钮上，也许把id放在按钮上

```
$('input.button#'+forloop.counter).click(function() 
 {
$('#rating_services'+ forloop.counter).replaceWith(...
 } 
```

这可能是很多事件处理程序，所以你可能想使用

```
$('div.parent_div').delegate('input.button#'+forloop.counter, ...).. 
```

# python - 检索广告 URL

> ID：13223945
> 
> 赞同：0
> 
> 时间：2012-11-04T23:11:08.073
> 
> 标签：python

我正在寻找一种方法来检索该网站的广告 URL。 [http://www.quiltingboard.com/resources/](http://www.quiltingboard.com/resources/)

我想要做的可能是编写一个脚本来不断刷新页面并获取广告 URL。

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T23:28:00.883

单靠 BeautifulSoup 并不能解决问题。广告是通过 javascript 注入的（它们是双击广告）。

您的选择是：

*   在页面加载后 10-15 秒编写类似 selenium 的脚本来查找 url
*   如果你留在纯 python 中，你需要：

    1.  发出初始请求以用漂亮的汤进行解析
    2.  弄清楚谷歌将用 javascript 注入什么
    3.  发出二次请求以双击 iframe 或有效负载 url

这些方法只会为您提供处理转化跟踪的双击网址。如果您想找出他们重定向到的位置，您需要打开这些 url 以发现他们的重定向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T23:33:54.983

我会检查[Scrapy](http://doc.scrapy.org/en/latest/intro/tutorial.html)。

这是一个网络抓取库。它使您可以很容易地从网站上抓取和抓取信息。上面的链接指向官方教程，其中包含大量示例代码，包括跨越您需要的内容的内容。

根据网站简单抓取：

```
from scrapy.spider import BaseSpider
from scrapy.selector import HtmlXPathSelector

from tutorial.items import DmozItem

class DmozSpider(BaseSpider):
   name = "dmoz"
   allowed_domains = ["dmoz.org"]
   start_urls = [
       "http://www.dmoz.org/Computers/Programming/Languages/Python/Books/",
       "http://www.dmoz.org/Computers/Programming/Languages/Python/Resources/"
   ]

   def parse(self, response):
       hxs = HtmlXPathSelector(response)
       sites = hxs.select('//ul/li')
       items = []
       for site in sites:
           item = DmozItem()
           item['title'] = site.select('a/text()').extract()
           item['link'] = site.select('a/@href').extract()
           item['desc'] = site.select('text()').extract()
           items.append(item)
       return items 
```

这是使用库来抓取链接的一个小例子，它产生：

> [dmoz] 调试：从 <200 [http://www.dmoz.org/Computers/Programming/Languages/Python/Books/](http://www.dmoz.org/Computers/Programming/Languages/Python/Books/) > {'desc': [u' - David Mertz; 艾迪生卫斯理。正在预订，全文，ASCII 格式。要求反馈。[作者网站, Gnosis Software, Inc.\n], 'link': [u'http://gnosis.cx/TPiP/'], 'title': [u'Text Processing in Python']} [dmoz]调试：取自 <200 [http://www.dmoz.org/Computers/Programming/Languages/Python/Books/](http://www.dmoz.org/Computers/Programming/Languages/Python/Books/)> {'desc': [u' - Sean McGrath; Prentice Hall PTR，2000，ISBN 0130211192，有 CD-ROM。快速构建 XML 应用程序的方法，Python 教程，DOM 和 SAX，新的 Pyxie 开源 XML 处理库。[Prentice Hall PTR]\n'], 'link': [u'http://www.informit.com/store/product.aspx?isbn=0130211192'], 'title': [u'使用 Python 处理 XML ']}

很酷。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T23:15:47.627

[Beautiful Soup](http://www.crummy.com/software/BeautifulSoup/)正是您想要的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T23:17:28.530

我假设您正在谈论屏幕顶部的文字广告。

您将无法为此直接使用 Python 解析库，因为这些链接是在页面加载后使用 JavaScript 加载的。

一种选择是使用像[selenium](http://pypi.python.org/pypi/selenium)这样的工具，它允许您在浏览器中加载页面。完成后，您可以使用 BeautifulSoup 扫描您正在寻找的链接：

```
from bs4 import BeautifulSoup

soup = BeautifulSoup(html)    
ads_div = soup.find('div', attrs={'class': 'ads'})
if ads_div:
    for link in ads_div.find_all('a'):
        print link['href'] 
```

# php - 如何在 CakePHP 中为一个模型动态使用多个数据库

> ID：13223946
> 
> 赞同：16
> 
> 时间：2012-11-04T23:11:11.373
> 
> 标签：php, mysql, cakephp, model, multiple-databases

好的，我的第一个问题被修改了很多次，所以我选择删除它并重新提出我的问题。我制作了一个具有不同型号名称的小型测试用例项目，以找到适合我的问题的解决方案。

**警告**：不要将**数据库**与**表混在一起**

**动机**：出于法律和性能问题，我将用户数据分离到多个**数据库中。**

目前，我正在开发一个**CakePHP**项目，该项目有多个`User`'s 并且每个`User`都有自己的**数据库**和多个**表**（`cars`是**表**之一）。现在，我需要先解释一下：

每个`User`人都有自己的**数据库**（不是表，是**数据库**），所以数据库名称如下。

*   [DATABASE] `app`（这是应用程序的主数据库）
    *   [桌子]`users`
    *   [TABLE] `permissions`（*与此问题无关*）
*   [DATABASE] `app_user1`（`User.id`1 拥有整个**数据库**）
    *   [TABLE] `cars`（完全由1拥有的**表）**`User.id`
*   [DATABASE] `app_user2`（`User.id`2 拥有整个**数据库**）
    *   [TABLE] `cars`（完全由2拥有的**表）**`User.id`
*   ETC...

我画了一张小图，可以阐明**数据库**/**表**定义及其与模型的关系：

![如何在 CakePHP 中为一个模型动态使用多个数据库](../Images/4f287f3fb3ebab75935a6dbcce991ce9.png)

**问题！！！**

我不知道要连接到哪个**数据库**`User`，直到登录。`User`和他们的**数据库**是动态创建的，所以我不能使用`app/Config/database.php`.

所以我目前正在编写`Model`和`ConnectionManager`类的扩展来绕过 CakePHP 的基本数据库行为。所以`Car`模型知道要使用哪个**数据库**。但我只是觉得这可以更容易地完成！

所以我想这一切都归结为一个问题：

**有没有更简单的方法来做到这一点？！**

感谢任何愿意花时间和精力阅读和理解我的问题的人！

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-11-05T00:45:44.003

[这位先生](https://stackoverflow.com/questions/5512327/cakephp-switch-database-using-same-datasource-on-the-fly/6058764#6058764)（[奥利维尔](https://stackoverflow.com/users/520129/olivier)）也有同样的问题！（一年前）[他](https://stackoverflow.com/questions/5512327/cakephp-switch-database-using-same-datasource-on-the-fly/6058764#6058764)`Controller`为s!写了一个小改编！它非常小，事实证明，它适用于**1.3**和**2.x**。

无论如何，这是我的最终解决方案，我将其放入`app/Model/AppModel.php`：

```
class AppModel extends Model
{
  /**
   * Connects to specified database
   *
   * @param String name of different database to connect with.
   * @param String name of existing datasource
   * @return boolean true on success, false on failure
   * @access public
   */
    public function setDatabase($database, $datasource = 'default')
    {
      $nds = $datasource . '_' . $database;      
      $db  = &ConnectionManager::getDataSource($datasource);

      $db->setConfig(array(
        'name'       => $nds,
        'database'   => $database,
        'persistent' => false
      ));

      if ( $ds = ConnectionManager::create($nds, $db->config) ) {
        $this->useDbConfig  = $nds;
        $this->cacheQueries = false;
        return true;
      }

      return false;
    }
} 
```

这是我在我的`app/Controller/CarsController.php`：

```
class CarsController extends AppController
{
  public function index()
  {
    $this->Car->setDatabase('cake_sandbox_client3');

    $cars = $this->Car->find('all');

    $this->set('cars', $cars);
  }

} 
```

我敢打赌，我不是第一个或最后一个遇到这个问题的人。所以我真的希望这些信息能找到人们和 CakePHP 社区。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-31T09:47:47.983

我不喜欢在代码中写下数据库的实际名称的想法。对于多个数据库，您有 database.php 文件，您可以在其中设置任意数量的数据库。

如果您想动态“切换”特定模型的数据库**，请**使用**setDataSource**方法。（见[这里](http://api.cakephp.org/class/model#method-ModelsetDataSource)）

例如，如果您有两个数据库，您可以在 database.php 文件中将它们定义为“默认”和“沙盒”，例如。

然后，在您的代码中：

```
$this->Car->setDataSource('sandbox'); 
```

沙盒是配置的名称，数据库的实际名称只在database.php文件中写入一次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-02T21:35:29.363

您始终可以在 mysql 中使用完整符号查询任何数据库。例如：

```
SELECT * FROM my_schema_name.table_name; 
```

蛋糕方式：

```
$db = $this->getDataSource();
$query = array(
    'fields' => array('*'),
    'table' => 'my_schema_name.table_name'
);
$stmt = $db->buildStatement($query, $this);
$result = $db->execute($stmt); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-01-23T05:56:08.527

在你的 database.php

```
public $mongo = array(
    'datasource' => 'Mongodb.MongodbSource',
    'database' => 'database_name_mongo',
    'host' => 'localhost',
    'port' => 27017,
); 
```

在您的控制器中，您可以使用

```
$this->Organisation->setDataSource('mongo'); 
```

然后应用查询

```
this->Organisation->find('all'); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-02-27T10:30:51.800

这是公认的答案。如果新数据源已经存在，这将防止错误：

```
public function setDatabase($database, $datasource = 'default')
{
    $newDatasource = $datasource . '_' . $database;
    try {
        // return the new datasource if it's already existed
        $db = ConnectionManager::getDataSource($newDatasource);
        $this->useDbConfig  = $newDatasource;
        $this->cacheQueries = false;
        return true;
    } catch (Exception $e) {
        // debug($e->getMessage());
    }

    $db  = ConnectionManager::getDataSource($datasource);
    $db->setConfig(array(
        'name'       => $newDatasource,
        'database'   => $database,
        'persistent' => false
    ));

    if ( $ds = ConnectionManager::create($newDatasource, $db->config) ) {
        $this->useDbConfig  = $newDatasource;
        $this->cacheQueries = false;
        return true;
    }

    return false;
} 
```

# html - Facebook分享按钮：如何实现

> ID：13223951
> 
> 赞同：9
> 
> 时间：2012-11-04T23:11:43.590
> 
> 标签：html, facebook, share, facebook-apps

我试图弄清楚如何实现 Share 按钮，就像它[在此处](http://www.buzzfeed.com/andrewgauthier/marathoners-run-to-deliver-supplies-to-hurricane-v)实现的方式一样。我希望能够让用户将给定的链接发布到他们的新闻提要，而不需要任何类型的应用程序权限以及他们可以添加到其中的一些可选文本。BuzzFeed 是如何做到的？Facebook 文档让我非常困惑，这就是为什么我自己很难实现它。如果有人可以安排需要采取的步骤，那就太好了。我究竟需要在我的 HTML 页面中添加什么？我需要创建 Facebook 应用程序吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-04T23:13:41.993

要共享您的网页，您**无需**创建 facebook 应用程序。

你可以把那个 Facebook 分享的图片放在那里，用`href = "http://www.facebook.com/sharer.php?u=<your url>"`

Facebook 的点赞按钮也允许分享。为您的网站生成的代码在**[官方文档](http://developers.facebook.com/docs/reference/plugins/like/)**中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-10-12T16:12:06.477

编辑您要共享的页面，将这些添加到头部的元标记中。

```
<meta property="og:image" content="http://www. XXXX url of a jpg image you want to be displayed  on shared content has to be 200x200 pixels (make it in photoshop ect.) XXXX"/>
<meta property="og:title" content="xxxx A title you want to be dispayed in shared content xxxx"/>
<meta property="og:url" content="http://www. url of the page you want shared including the slash after .com xxx .com/"/>
<meta property="og:description" content="xxxx discription of the shared content xxx "/> 
```

除了这些之外，还有一个 og 属性列表 - [http://ogp.me/](http://ogp.me/)

接下来将其插入页面上您想要共享按钮的位置，

```
<a title="xxx Share mypage.com xxx" href="http://www.facebook.com/sharer.php? u=http://www. xxx url of page you edited above xxx .com &t=xxx a title you want to use xxx" target="_blank"><img  src="http://www. xxx an image for the share button (make it in photoshop ect.)xxx" width="xx" height="xx" alt="Share"/></a> 
```

显然取出 xxx 并留下 " " ，如果您在测试时更改上述任何内容，您可能必须转到 facebook 调试器并对其进行调试，因为它有时会保留原始内容。

希望这可以帮助

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-15T17:30:46.137

如果您想自定义该共享页面，请尝试以下操作：

Javascript 弹出窗口示例：

```
var title = 'My Title';
var summary = 'This is my summary';
var url = 'http://www.mydomain.com/path/to/page';
var image = 'http://www.mydomain.com/images/myimage.png';

var fb = window.open('http://www.facebook.com/sharer.php?s=100&p[title]='+encodeURIComponent(title)+'&p[url]='+encodeURIComponent(url)+'&p[summary]='+encodeURIComponent(summary)+'&p[images][0]='+encodeURIComponent(image));
fb.focus(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-23T17:14:57.523

这是有效的。

在 HTML 中：

```
<a href="http://www.facebook.com/sharer.php?u=<http://google.com">Facebook Link</a> 
```

您将[http://google.com](http://google.com)替换为您的 URL 的位置。

在 PHP 中，如果您希望它提取您所在的网址：

```
<a href="http://www.facebook.com/sharer.php?u=<<?php echo "http://$_SERVER[HTTP_HOST]$_SERVER[REQUEST_URI]"; ?>">Facebook</a> 
```

# lua - 如何从 pastebin 访问原始私有粘贴？

> ID：13223953
> 
> 赞同：7
> 
> 时间：2012-11-04T23:12:06.607
> 
> 标签：lua, pastebin

我知道如何使用 pastebin API 生成用户密钥，但如何使用此用户密钥访问原始私有粘贴？

我为此使用 Lua。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-07T14:03:53.397

获取原始粘贴箱输出*不是粘贴箱*[API](http://pastebin.com/api#13)的一部分：

> 此选项实际上不是我们 API 的一部分，但您可能仍想使用它。要获取粘贴的 RAW 输出，您可以使用我们的 RAW 数据输出 URL：
> 
> ```
> http://pastebin.com/raw.php?i= 
> ```
> 
> 只需在该 URL 的末尾添加**paste_key**，您将获得 RAW 输出。

由于私有粘贴只能由创建它们的用户看到，我猜他们使用 logincookie 进行身份验证。在这种情况下，您需要将其与 HTTP 请求一起发送。

* * *

关于在 Lua 中实现这一点，（因为你没有说你正在使用哪个库）我会继续推荐 LuaSocket 中的[HTTP 模块](http://w3.impa.br/~diego/software/luasocket/http.html)或精彩的 Luvit（[http://luvit.io](http://luvit.io)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-07-25T18:50:14.447

这是为您准备的代码示例：

```
local https = require('ssl.https')
    https.TIMEOUT= 15

    local private_raw_url="https://pastebin.com/raw/YOURPAGE" -- Change raw link
    local user_name, user_password = "USER", "PASS"           -- and user with password

    local request_body = "submit_hidden=submit_hidden&user_name=".. user_name .. "&user_password=" .. user_password .. "&submit=Login"

    local resp = {}
    local res, code, headers, status = https.request ( {
                            method = 'POST',
                            url = "https://pastebin.com/login",
                            headers = { 
                              Host = "pastebin.com", 
                              ["Content-Type"] = "application/x-www-form-urlencoded",
                              ["Content-Length"] = string.len(request_body), 
                              Connection = "keep-alive",
                            }, 
                            source = ltn12.source.string(request_body),
                            sink = ltn12.sink.table(resp),
                            protocol =  "tlsv1", 
                            verify = "none",
                            verifyext = {"lsec_continue", "lsec_ignore_purpose"},
                            options = { "all", "no_sslv2", "no_sslv3" } 
                        } )
    if not headers['set-cookie']:find('pastebin_user') then 
           print('bad login')
           return
    end
    resp={}
    local cookie = headers['set-cookie'] or ''
    local cookie1, cookie2, cookie3 = cookie:match("(__cfduid=%w+; ).*(PHPSESSID=%w+; ).*(pastebin_user=%w+; )" )   
    if cookie1 and cookie2 and cookie3 then
            cookie = cookie1 .. cookie2 .. cookie3
            body, code, headers= https.request{
                url = private_raw_url ,
                headers = { 
                            --Host = "pastebin.com", 
                            ['Cookie'] = cookie,
                            ['Connection'] = 'keep-alive'
                                },         
                sink = ltn12.sink.table(resp)     
             }  

            if code~=200 then  return  end 

           print( table.concat(resp) )
    else
        print("error match cookies!" )
    end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-21T06:58:52.970

我知道回答这个问题有点晚了，但我希望这对以后的人有所帮助。

如果要访问原始私有粘贴，您首先需要列出用户创建的粘贴。这是 API 的一部分。这需要用户登录。

> 使用此 API，您可以列出某个用户创建的所有粘贴。您需要向以下 URL 发送有效的 POST 请求才能访问数据：

```
http://pastebin.com/api/api_post.php 
```

您将获得的响应将是一个 XML 响应，如下所示：

```
<paste>
    <paste_key>0b42rwhf</paste_key>
    <paste_date>1297953260</paste_date>
    <paste_title>javascript test</paste_title>
    <paste_size>15</paste_size>
    <paste_expire_date>1297956860</paste_expire_date>
    <paste_private>0</paste_private>
    <paste_format_long>JavaScript</paste_format_long>
    <paste_format_short>javascript</paste_format_short>
    <paste_url>http://pastebin.com/0b42rwhf</paste_url>
    <paste_hits>15</paste_hits>
</paste> 
```

一旦你有了它，解析 XML 以获取`paste_key`和`paste_private`. 您需要检查 的值，`paste_private`因为您只需要私人粘贴。文档说：

> 我们有 3 个可用的有效值，您可以将其与 'api_paste_private' 参数一起使用：
> 
> ```
> 0 = Public
> 1 = Unlisted
> 2 = Private (only allowed in combination with api_user_key, as you have to be logged into your account to access the paste) 
> ```

因此，如果您的粘贴已`paste_private`设置为`2`，请获取`paste_key`它。

获得 后`paste_key`，使用 API 调用获取 RAW 粘贴。拥有私人粘贴的粘贴密钥后，无需用户名或密码。

玩得开心！

# html - 在 iPad 上的 UIWebView 中设置 HTML5 视频的 currentTime 会跳转到与设置不同的时间

> ID：13223954
> 
> 赞同：1
> 
> 时间：2012-11-04T23:12:14.827
> 
> 标签：html, ipad, video, uiwebview

正如标题已经说过的那样，我在设置嵌入在 iPad 上的 UIWebView 中的 HTML 中的视频的 currentTime 时遇到了问题（xcode-Simulator）。例如，当我尝试跳转到 vid.currentTime = 7 时，它会跳转到 6,599999947

意思是：**视频永远不会完全跳到我设置的值。它总是从一个不同的时间开始，这个时间很接近，但不准确**

就我而言，我有一系列开始和结束时间，可以通过滑动跳转到某些章节。

这可能是视频编解码器问题、iPad 错误，还是有其他想法？

任何帮助表示赞赏 - Fab

# c# - WinRT gridview 添加磁贴

> ID：13223958
> 
> 赞同：2
> 
> 时间：2012-11-04T23:13:24.553
> 
> 标签：c#, windows, gridview, windows-runtime

我有一个`GridView`，它绑定到`List`项目。我希望它有一个静态项目，以便用户可以单击它来添加更多项目。如果我点击其他项目，我会生成一个项目详细信息页面。

我怎样才能拥有与 中的每个其他网格项目具有完全不同行为的静态图块`GridView`？就像下图中的最后一个图块。

![在此处输入图像描述](../Images/03fcaa50266003a8aaaf7dfff2897947.png)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-04T23:57:29.383

在我们的项目中，我们找到了一个干净的解决方案：您的 GridView ItemsSource 绑定到 ViewModel 的集合。最后一个可以是众所周知的 VM，例如`LoadMoreViewModel`实例。

它允许您创建 DataTemplateSelector 实现并将其设置为 GridView 的 ItemTemplateSelector 属性。

```
public class LoadMoreTemplateSelector: DataTemplateSelector
{
    public DataTemplate LoadMoreTemplate { get; set; }
    public DataTemplate DefaultTemplate { get; set; }

    protected override Windows.UI.Xaml.DataTemplate SelectTemplateCore(object item, Windows.UI.Xaml.DependencyObject container)
    {
        if (item is LoadMoreViewModel)
        {
            return LoadMoreTemplate;
        }
        else
        {
           return DefaultTemplate;
        }
    }
} 
```

在您的 xaml 文件中创建此 TemplateSelector 的实例作为资源，并设置适当的模板：

```
<selectors:LoadMoreTemplateSelector x:Key="LoadMoreTemplateSelector" 
       DefaultTemplate="{StaticResource Template1}" 
       LoadMoreTemplate="{StaticResource LoadMoreTemplate}"/> 
```

您的 gridView 可以使用此模板选择器

```
<GridView ...
    ItemTemplateSelector="{StaticResource LoadMoreTemplateSelector}" /> 
```

LoadMoreTemplate 应如下所示：

```
<DataTemplate x:Key="LoadMoreTemplate">
   <Button Command="{Binding LoadMore}" Content="+"/>
</DataTemplate> 
```

剩下的唯一问题是您必须在 LoadMoreViewModel 中实现 ICommand 以将加载更多按钮绑定到模板中，或者创建一个 UserControl 以便能够对 Click 事件做出反应。

编辑：这是一个简单的 ICommand 实现。单击按钮时，它将执行传递给构造函数的操作。

```
public class DelegateCommand : ICommand
{
    private readonly Predicate<object> _canExecute;
    private readonly Action<object> _execute;

    public event EventHandler CanExecuteChanged;

    public DelegateCommand(Action<object> execute) 
                   : this(execute, null)
    {
    }

    public DelegateCommand(Action<object> execute, 
                   Predicate<object> canExecute)
    {
        _execute = execute;
        _canExecute = canExecute;
    }

    public override bool CanExecute(object parameter)
    {
        if (_canExecute == null)
        {
            return true;
        }

        return _canExecute(parameter);
    }

    public override void Execute(object parameter)
    {
        _execute(parameter);
    }

    public void RaiseCanExecuteChanged()
    {
        if( CanExecuteChanged != null )
        {
            CanExecuteChanged(this, EventArgs.Empty);
        }
    }
} 
```

当您实例化您的 LoadMoreViewModel 时，您可以提供当用户单击加载更多按钮时要执行的操作。

```
public class LoadMoreViewModel:BindableBase
{
   public ICommand LoadMore{get;private set;}
   public LoadMoreViewModel(Action<object> action)
   {
     LoadMore = new DelegateCommand(action);
   }
} 
```

而在 ViewModel 页面中，当在列表中加载更多项目时，删除列表末尾的当前 LoadMoreViewModel，然后添加其他项目，最后再次添加 LoadMoreViewModel（如果需要）：

```
public void LoadMoreItems()
{
  if(Items.Last() is LoadMoreViewModel)
  {
    Items.Remove(Items.Last());
  }
  //Insert here add new items logic.
  Items.Add(new LoadMoreViewModel(_=>LoadMoreItems());
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T16:22:45.450

您可以简单地编辑 GridView 的控件模板：

```
<Setter Property="Template">
    <Setter.Value>
        <ControlTemplate TargetType="GridView">
            <Border BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="{TemplateBinding BorderThickness}"
                    Background="{TemplateBinding Background}">
                <ScrollViewer x:Name="ScrollViewer">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="50" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <!-- Your custom buttons -->
                        <StackPanel Orientation="Vertical"
                                    Grid.Column="0">

                        </StackPanel>

                        <ItemsPresenter Grid.Column="1"
                                        HeaderTemplate="{TemplateBinding HeaderTemplate}"
                                        Header="{TemplateBinding Header}"
                                        HeaderTransitions="{TemplateBinding HeaderTransitions}"
                                        Padding="{TemplateBinding Padding}" />
                    </Grid>
                </ScrollViewer>
            </Border>
        </ControlTemplate>
    </Setter.Value>
</Setter> 
```

# caching - 缓存破坏本地浏览器缓存但确保来自 Azure CDN 而不是来自源服务器的响应（Web 角色）

> ID：13223965
> 
> 赞同：2
> 
> 时间：2012-11-04T23:14:27.027
> 
> 标签：caching, azure-web-roles, proxy-server, azure-cdn

我正在尝试向 Azure CDN（生产站点）上的项目发出 HEAD 请求，但希望避免来自本地浏览器缓存或源服务器（我的 Web 角色）的响应。这将是一个访问量很大的网站，内容都是静态的，因此从我的 Web 角色的 /cdn 文件夹中缓存在 Azure CDN 上。

我已经通过调用解决了避免本地浏览器缓存的问题：

```
$.ajaxSetup({cache: false}); 
```

此外，我的 HEAD 请求用于简单地检索响应日期，因为我想要的是 GMT 中的保证当前时间（Azure 全部设置为 GMT）：

```
$.ajax({
    type: "HEAD",
    async: true,
    url: "small.png",
    success: function (message, text, response) {
        doSomething(response.getResponseHeader("Date"));
    }
}); 
```

现在我保证我的响应绝对不会被浏览器上的缓存副本完成，但我不确定如何验证响应是来自 Azure CDN 还是来自源服务器（Web 角色）。我想保证如果“small.png”在 Azure CDN 上，我的响应来自那里。基本上，我需要确认我的源服务器不会被请求轰炸，并且 CDN 将限制 99.999999% 的请求，包括这个请求。但是，由于我在 HEAD 请求 ($.ajaxSetup({cache: false}); 之前将一个唯一的查询字符串附加到请求之前的缓存清除，我不确定 Azure CDN 是否决定将请求转发到源服务器。

请注意，通过 Azure 门户，我在我的 CDN 上未选中“启用查询字符串”。我认为这足以让我满意，但我想要一种温暖而模糊的感觉，即我的响应确实来自 Azure CDN 而不是起源。Fiddler 中是否有任何指标可以向我证明我的响应来自 CDN（代理服务器）而不是源服务器？

目前我的所有内容都有 30 分钟的缓存过期，但是当我们上线时我会调整/优化它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T00:07:07.380

保持“启用查询字符串”未选中完全符合您的要求。

至于确定 CDN 是否在给定请求上返回源服务器，您拥有源服务器，对吗？所以你可以在那里看到你是否被击中。我不确定是否有办法仅通过查看 CDN 的响应来判断它是缓存命中还是缓存未命中。

# php - 如何在 php 中为 htmlentities() 函数默认设置 ENT_QUOTES 标志

> ID：13223967
> 
> 赞同：6
> 
> 时间：2012-11-04T23:14:40.093
> 
> 标签：php, codeigniter, html-entities

`htmlentities($data, ENT_QUOTES)`在显示之前，我正在使用从数据库中获取的任何数据。

`ENT_QUOTES`有没有一种方法可以默认为函数设置标志`htmlentities()`，这样即使我写`htmlentities($data)`它也应该作为`htmlentities($data, ENT_QUOTES)`.

正如 php 文档中所写，默认值为`ENT_COMPAT | ENT_HTML401`.

供您参考，我正在使用 codeigniter 框架 php5。

更新 1：按照 Michael 的建议使用自定义函数进行包装可能会有所帮助，但我已经在网站中的任何地方都使用了它，没有 ENT_QUOTES 标志，并且想知道 php 是否提供了一种方法来更改其函数的默认值。

更新 2：我认为 codeigniter 提供的 html_escape() 内置函数（由 Wesley 建议）对我来说是最好的，这样我就不必编写自己的包装函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T03:18:58.613

没有办法更改我所知道的默认标志，但在评论中给你的建议绝对是解决这个问题的最佳方法：使用包装函数。

方便的是，Codeigniter 已经内置了一个，适当命名：

```
echo html_escape($string); 
```

您也可以传入数组，这是它的作用：

```
/**
* Returns HTML escaped variable
*
* @access   public
* @param    mixed
* @return   mixed
*/
if ( ! function_exists('html_escape'))
{
    function html_escape($var)
    {
        if (is_array($var))
        {
            return array_map('html_escape', $var);
        }
        else
        {
            return htmlspecialchars($var, ENT_QUOTES, config_item('charset'));
        }
    }
} 
```

只需在您的项目中搜索`htmlentities`并（小心）替换为`html_escape`. 这也为您提供了在未来轻松进行更改的机会，因为您可以更改功能。这是一个初步的时间投资，但非常值得。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T06:05:01.230

如果您直接访问变量。例如：$this->model_name->variable；

然后您可以在模型名称中使用 __get 函数并在它从对象访问之前对其进行处理。 [http://www.php.net/manual/en/language.oop5.overloading.php#object.get](http://www.php.net/manual/en/language.oop5.overloading.php#object.get)

# asp.net-mvc - 带有 jQ uery mobile 的 MVC3，具有不同的布局页面和视图

> ID：13223970
> 
> 赞同：0
> 
> 时间：2012-11-04T23:14:55.447
> 
> 标签：asp.net-mvc, asp.net-mvc-3, mobile, jquery-mobile

我认为我正在尝试做的事情已经内置，但它似乎并没有工作。据我了解，使用 asp.net MVC，您可以这样命名您的视图：

```
_view.cshtml

_view.Mobile.cshtml 
```

如果来自移动设备，它将使用移动设备，并在台式机上使用非移动设备。

它不会自动为我做这件事，我还需要做些什么吗？我引用了所有 jquery 移动脚本和 css。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T21:29:06.730

正如评论中所指出的，本教程：asp.net/mvc/tutorials/mvc-4/aspnet-mvc-4-mobile-features 是一个很好的方法。

我的特殊问题是默认共享视图文件夹中没有任何内容，因此路由不正确。

# python - Python 3 从辩论文件中提取候选词

> ID：13223971
> 
> 赞同：3
> 
> 时间：2012-11-04T23:15:12.770
> 
> 标签：python

这是我的第一篇文章，所以如果我做错了什么，我很抱歉。也就是说，我搜索了这个问题，发现由于 OP 没有提供足够的信息而从未回答过的类似问题。这也是作业，所以我只是在寻找提示。我真的很想自己得到这个。

我需要读入一个辩论文件 (.txt)，然后提取并存储一位候选人说要放入词云的所有行。文件格式应该会有所帮助，但我对如何做到这一点一无所知。提示是每次新人说话时，他们的名字后跟冒号是第一行的第一个单词。但是，候选人的数据可以跨越多行。我应该分别存储每个人的台词。这是该文件的示例：

> 莱勒：本次辩论和接下来的三场辩论——两场总统辩论，一名副总统辩论赛——由总统辩论委员会赞助。今晚的 90 分钟将讨论国内问题，并将遵循委员会设计的格式。将有六个大约 15 分钟的片段，第一个问题有两分钟的答案，然后对每个片段的其余部分进行公开讨论。
> 
> 先生们，欢迎你们俩。让我们开始经济，第一部分，让我们从工作开始。你们两人在如何创造新工作方面的主要区别是什么？
> 
> LEHRER：你有两分钟的时间。你们每个人都有两分钟的时间开始。抛硬币决定，总统先生，你先走。
> 
> 奥巴马：嗯，非常感谢吉姆，给我这个机会。我要感谢罗姆尼州长和丹佛大学的热情款待。
> 
> 今晚我想说的有很多，但最重要的是，20 年前我成为了地球上最幸运的人，因为米歇尔奥巴马同意嫁给我。

到目前为止，这就是我所拥有的功能：

```
def getCandidate(myFile):    
    file = open(myFile, "r")
    obama = []
    romney = []
    lehrer = []
    file = file.readlines() 
```

我只是不确定如何遍历数据，以便正确区分每个人的单词。我创建了一个虚拟文件来创建词云，并且我能够做到这一点，所以我想知道的是如何提取我需要的信息。

谢谢！如果我可以提供更多信息，请告诉我。这是一门 Python 入门课程。

编辑：从响应中添加的新代码。这在一定程度上有效，但只抓住了每个候选人回答的第一行，而不是他们的全部回答。我需要编写代码继续存储该候选下的每一行，直到新名称位于行的开头。

```
def getCandidate(myFile, candidate):   
    file = open(myFile, "r")
    OBAMA = []
    ROMNEY = []
    LEHRER = []
    file = file.readlines()
    for line in file:
        if line.startswith("OBAMA:"):
            OBAMA.append(line)
        if line.startswith("ROMNEY:"):
            ROMNEY.append(line)
        if line.startswith("LEHRER:"):
            LEHRER.append(line)
    if candidate == "OBAMA":
        return OBAMA
    if candidate == "ROMNEY":
        return ROMNEY 
```

编辑：我现在有一个新问题。如何概括文件，以便我可以打开两个人和主持人之间的任何辩论文件？我在这个问题上遇到了很多麻烦。

提示我查看行首并查看每行的最后一个单词是否以“：”结尾，但我仍然不确定如何执行此操作。我尝试在空格上分割每一行，然后查看该行中的第一个项目，但这就是我所得到的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T23:45:01.413

提示是这样的：拆分行后，遍历它们并检查每个候选行的字符串函数**startswith ，然后追加。**

对文件的迭代非常简单：

```
for row in file:
    do_something_with_row 
```

编辑：要继续放置线条，直到找到新的候选人，您必须跟踪看到的最后一个候选人的变量，如果您在该行的开头没有找到任何匹配项，您坚持使用相同的候选人前。

```
if line.startswith('OBAMA'):
    last_seen=OBAMA
    OBAMA.append(line)
elif blah blah blah

else:
    last_seen.append(line) 
```

顺便说一句，我会改变函数的定义：与其取候选人的名字并只返回他的行，不如返回一个字典，其中候选人的名字作为键，他们的行作为值，所以你不会不需要多次解析文件。当您使用更大的文件时，这可能是一个救星。

# python - 如何解码这个字符串（它是十六进制？）？

> ID：13223972
> 
> 赞同：0
> 
> 时间：2012-11-04T23:15:24.583
> 
> 标签：python, utf-8, character-encoding

我试图了解编码/解码字符串在 Python 中是如何工作的，但我很困惑。

如果我有这样的字符串：

```
'\x87\x0e)\xb9\xb0\x0f\t"c\xc7\xf1\x97B\xc6\x17\xee\xab\x1d\xbf\xc0\xd0\x06j\xc3' 
```

这是哪种类型？十六进制？以及如何将其转换为 utf-8？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T23:22:09.473

这样你就可以用这个字符串构造 Unicode 对象

```
u='\x87\x0e)\xb9\xb0\x0f\t"c\xc7\xf1\x97B\xc6\x17\xee\xab\x1d\xbf\xc0\xd0\x06j\xc3'.decode('UTF16')
print type(u) 
```

# ruby-on-rails - Rails回形针`'identify'命令无法识别`

> ID：13223973
> 
> 赞同：4
> 
> 时间：2012-11-04T23:15:28.863
> 
> 标签：ruby-on-rails, ruby-on-rails-3, imagemagick, paperclip, homebrew

尝试将 a 保存`png`到带有回形针附件的模型时出现错误。

我的`User`模型：

```
class User < ActieRecord::Base
  attr_accessible :icon
  has_attached_file :icon, :url => "/system/users/icon/:hash.:extension",
    :hash_secret => "superSecretHashSecret",
    :styles => { :medium => "300x300>", :thumb => "100x100>" }
end 
```

尝试设置图标的示例：

```
u = User.last
u.icon = open(Rails.root + "spec/fixtures/files/example.png")
u.save 
```

示例模型错误：

```
:icon => ["/var/folders/43/810gn/T/example20121104-36855-1v7t136.png is not recognized by the 'identify' command."] 
```

有很多人发布了与这个类似的问题，尤其是[这个](https://stackoverflow.com/questions/1996102/rails-paperclip-and-passenger-is-not-recognized-by-the-identify-command)，但这些解决方案都不适合我。

我的 command_path 设置正确：

```
O:~ $ which identify
/usr/local/bin/identify 
```

在`development.rb`

```
Paperclip.options[:command_path] = "/usr/local/bin/" 
```

**不过，这仍然可能是问题所在。** 尝试直接使用 `identify 时，出现以下错误：

```
O:~ $ identify workspace/app/spec/fixtures/files/example.png 
dyld: Library not loaded: /usr/lib/libltdl.7.dylib
  Referenced from: /usr/local/bin/identify
  Reason: image not found
Trace/BPT trap: 5 
```

**关于这里发生了什么的任何建议？**

我已经尝试重新安装 ImageMagick

```
brew unlink imagemagick
brew install imagemagick 
```

其他人建议添加`Rmagick`. 这绝对不是使用 Paperclip 的要求，它也没有帮助。

建议的另一个解决方案是删除该`:style`属性。但这不是解决方案。我需要对图像进行处理。

我有 Paperclip 在我的项目中处理另一个模型，该模型处理不是图像的文档/不进行任何处理。所以我知道这可能与此有关。

关于如何解决这个问题的任何其他建议？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-05T00:02:15.820

这是一个 ImageMagick 安装问题。

第一次尝试

```
brew update
brew upgrade imagemagick 
```

如果这不起作用，请使用*magick-installer*脚本来解决这个问题： [https ://github.com/maddox/magick-installer](https://github.com/maddox/magick-installer)

```
curl https://raw.github.com/maddox/magick-installer/master/magick-installer.sh | sh 
```

或者，使用具有较新版本的依赖库的*magick-installer*的分支：

```
curl https://raw.github.com/GTSouza/magick-installer/master/magick-installer.sh | sh 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-05T00:08:15.510

解决方案最终是安装`libtool`. 这也是[这里](https://stackoverflow.com/questions/7412208/imagemagick-and-os-x-lion-trouble)最好的建议。我的问题被证明更复杂，因为`homebrew`不是最新的，并且在不强制结帐的情况下无法更新的状态。

对于将来遇到此问题的人，我建议手动检查该`identify`命令是否确实有效，即使它在您的路径中也是如此。

```
identify /path/to/some/image 
```

如果失败，它将显示如下内容：

```
O:~ $ identify workspace/app/spec/fixtures/files/example.png 
dyld: Library not loaded: /usr/lib/libltdl.7.dylib
  Referenced from: /usr/local/bin/identify
  Reason: image not found
Trace/BPT trap: 5 
```

在这种情况下，请尝试安装`libtool`.

```
brew install libtool 
```

如果失败，请运行`brew update`. 如果它继续失败，请确保您安装了最新的 Xcode 并再次尝试更新。

如果您可以成功使用`identity`. 它看起来像这样：

```
O:~ $ identify ~/workspace/app/spec/fixtures/files/example.png 
~/workspace/app/spec/fixtures/files/example.png PNG 200x201 200x201+0+0 8-bit DirectClass 66.1KB 0.000u 0:00.000 
```

glebm 的答案可能也很有效。我没有看过那个安装程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-26T19:23:20.633

这可能是由于将旧版本的 Paperclip 与较新且不兼容的 Cocaine gem 版本一起使用造成的。您可以使用更新回形针 gem 版本`bundle update paperclip`。它将根据兼容性更新回形针和可卡因版本。

[https://github.com/thoughtbot/paperclip/issues/1038](https://github.com/thoughtbot/paperclip/issues/1038)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-04T14:59:31.817

在我的 Mac 上升级到 Mavericks 后，我刚刚遇到了同样的问题。

以下是解决问题的步骤：

```
brew update
brew install libtool
brew link libtool
brew upgrade imagemagick 
```

# python - 仅当对象不是“无类型”时如何进行 rstrip

> ID：13223982
> 
> 赞同：0
> 
> 时间：2012-11-04T23:16:22.380
> 
> 标签：python

findloc 是我创建的另一个子例程，当调用 parse 时，有时它返回 None 有时返回一个值，当尝试 rstrip 时我收到以下错误？如何仅在对象不是“nonetype”时使用 rstrip 或请建议任何其他方法.

```
 build_loc=parse(findloc(targetmeta_cid).strip())
    Target_list.append(build_loc.rstrip('\r\n')) 
```

错误

```
 Target_list.append(build_loc.rstrip('\r\n'))AttributeError: 'NoneType' object has no attribute 'rstrip' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T23:23:39.953

你可以这个

```
if build_loc is not None:
    Target_list.append(build_loc.rstrip('\r\n')) 
```

为了使它工作。希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T23:20:19.397

```
Target_list.append( build_loc.rstrip('\r\n') if build_loc is not None else None ) 
```

或者

```
build_loc = parse(findloc(targetmeta_cid).strip()) or '' 
```

* * *

更清洁的方法可能是确保`parse`不会返回`None`！

# sql - 使用子查询和连接

> ID：13223985
> 
> 赞同：0
> 
> 时间：2012-11-04T23:17:03.223
> 
> 标签：sql, postgresql, join

我有以下声明：

> 1997 年购买的客户的姓名和地址列表。

所以我认为以下两种方法是正确的，但它们不是；为什么？

```
select contactname, address from customers
       inner join orders
       on customers.customerid = orders.customerid
       where date_part('year', orderdate) = 1997
       order by contactname

select contactname, address from customers
       where customerid in
             (select customerid from orders 
              where date_part('year', orderdate) = 1997)
       order by contactname 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-05T00:28:39.087

有很多*正确*的方法可以做到这一点。半连接[`EXISTS`](http://www.postgresql.org/docs/current/interactive/functions-subquery.html#FUNCTIONS-SUBQUERY-EXISTS)可能是 PostgreSQL 中最快的，如果您只想要一个不同客户的列表并且除了至少存在 1 个订单之外没有来自订单的更多详细信息：

```
SELECT c.contactname, c.address
FROM   customers c
WHERE  EXISTS (
    SELECT 1
    FROM   orders o 
    WHERE  o.customerid = c.customerid
    AND    o.orderdate >= '1997-1-1'::date
    AND    o.orderdate <  '1998-1-1'::date
    )
ORDER BY contactname; 
```

为什么使用？

```
 WHERE  o.orderdate >= '1997-1-1'::date
    AND    o.orderdate <  '1998-1-1'::date 
```

代替：

```
 WHERE  date_part('year', orderdate) = 1997 
```

使用您的表达式，PostgreSQL 必须在检查条件之前为每一行计算一个值。在替代形式中，列（原样）与两个常数项匹配。这也可以更轻松地使用索引。应该更快。

还要注意我如何使用[表别名](http://www.postgresql.org/docs/current/interactive/queries-table-expressions.html#QUERIES-TABLE-ALIASES)使查询更易于阅读。

您的*第一个*查询由于`JOIN`. 如果表中的一行在表中`customer`有多个匹配的行，则`orders`每个订单都会得到一行。您可以使用以下方法解决此问题`GROUP BY`：

```
SELECT c.contactname, c.address
FROM   customers c
JOIN   orders o USING (customerid)
WHERE  o.orderdate >= '1997-1-1'::date
AND    o.orderdate <  '1998-1-1'::date
GROUP  BY c.customer_id   --- or whatever is the primary key of c 
ORDER  BY c.contactname 
```

..这是另一种方法。但很可能更慢。如果您还想从表中检索其他（聚合）数据，则可以使用此表单`orders`..

`DISTINCT`将是 的替代方案`GROUP BY`，在这种简单的情况下几乎相同。删除`GROUP BY`this 的子句并添加`DISTINCT`after `SELECT`。

您也可以使用 修复您的第二个查询`DISTINCT`，而是使用我的第一个示例。

# android - 单击通知时显示原始对话框

> ID：13223987
> 
> 赞同：1
> 
> 时间：2012-11-04T23:17:12.830
> 
> 标签：android, dialog, notifications

我有一个短信应用程序，当我收到短信时，会创建一个对话框来显示消息，并且还会在通知栏中创建一个通知。我的问题是，当我单击通知时，它会启动我的活动并在原始对话框之上创建一个新对话框，而不是仅仅重新关注已经创建的对话框。

```
 NotificationManager manger = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);
   Notification notification = new Notification(R.drawable.sms,smsBody, System.currentTimeMillis());

   Intent notificationIntent = new Intent(this, SendSMSActivity.class);
   PendingIntent contentIntent = 
           PendingIntent.getActivity(this, 0, notificationIntent, PendingIntent.FLAG_ONE_SHOT );

   notification.setLatestEventInfo(this, ContactName,smsBody,contentIntent);
   notification.flags = Notification.FLAG_AUTO_CANCEL;
   //notification.sound = Uri.parse("file:///sdcard/notification/ringer.mp3");

   notification.defaults = notification.DEFAULT_SOUND | notification.DEFAULT_VIBRATE;
   manger.notify(1, notification); 
```

我的活动代码

```
public void onCreate(Bundle savedInstanceState) {
       super.onCreate(savedInstanceState);

        //wakeup screen
        PowerManager pm = (PowerManager) getApplicationContext().getSystemService(Context.POWER_SERVICE);
        WakeLock wakeLock = pm.newWakeLock((PowerManager.SCREEN_BRIGHT_WAKE_LOCK | PowerManager.FULL_WAKE_LOCK | PowerManager.ACQUIRE_CAUSES_WAKEUP), "TAG");
        wakeLock.acquire();

        final String sender = getIntent().getStringExtra("PhoneNumber");
        final String body = getIntent().getStringExtra("smsBody");
        final String contactId = getIntent().getStringExtra("contactId");
        final String SenderName = getIntent().getStringExtra("SenderName");

        new ContactNameAsyncTask().execute();//this start the create dialog 
```

这是我的对话代码

私人无效 ShowMessage(){

```
 NotificationManager manger = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);
   Notification notification = new Notification(R.drawable.sms,smsBody, System.currentTimeMillis());

   Intent notificationIntent = new Intent(this, SendSMSActivity.class);
   PendingIntent contentIntent = 
           PendingIntent.getActivity(this, 0, notificationIntent, PendingIntent.FLAG_ONE_SHOT );

   notificationIntent.putExtra("NotificationMessage", "focused");
   notificationIntent.setData((Uri.parse("foobar://"+SystemClock.elapsedRealtime())));

   notification.setLatestEventInfo(this, ContactName,smsBody,contentIntent);
   notification.flags = Notification.FLAG_AUTO_CANCEL;
   //notification.sound = Uri.parse("file:///sdcard/notification/ringer.mp3");

   notification.defaults = notification.DEFAULT_SOUND | notification.DEFAULT_VIBRATE;
   manger.notify(1, notification);

    final Dialog dialog = new Dialog(this);
    dialog.requestWindowFeature(Window.FEATURE_NO_TITLE);
    dialog.setContentView(R.layout.custom);

    try {
        TextView text = (TextView) dialog.findViewById(R.id.text);
        text.setMovementMethod(ScrollingMovementMethod.getInstance());
        text.setText(smsBody);

        TextView stext = (TextView) dialog.findViewById(R.id.sender);
        stext.setText(ContactName);
    }catch(NumberFormatException nfe) {
        TextView text = (TextView) dialog.findViewById(R.id.text);
        text.setMovementMethod(ScrollingMovementMethod.getInstance());
        text.setText("message not found check your inbox");

        TextView stext = (TextView) dialog.findViewById(R.id.sender);
        stext.setText("unknown");
    } 

    ImageView image = (ImageView) dialog.findViewById(R.id.image);
    image.setPadding(2, 2, 2, 2);
    image.setBackgroundColor(Color.GRAY);

    //get contact photo
    try {

        image.setImageURI(ContactPicUri);
    } catch(NumberFormatException nfe) {
        image.setImageResource(R.drawable.sender);
        //Toast.makeText(context,"Contact image not found "+ nfe,Toast.LENGTH_LONG).show();
    } 

    //end get contact photo
    //button1
    Button dialogButtonReply = (Button) dialog.findViewById(R.id.dialogButtonReply);
    dialogButtonReply.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
             NotificationManager manger = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);
            manger.cancel(1);
                smsReply(PhoneNumber, smsBody);
                 goHome();
            }
    });
    //button1 end

    Button dialogButtonClose = (Button) dialog.findViewById(R.id.dialogButtonClose);
    dialogButtonClose.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
             NotificationManager manger = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);
            manger.cancel(1);
            //markMessageRead(context,PhoneNumber,smsBody);
            goHome();

        }
    });

    Button dialogButtonQuickReply = (Button) dialog.findViewById(R.id.dialogButtonQuickReply);
    dialogButtonQuickReply.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
             NotificationManager manger = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);
            manger.cancel(1);
            QuickReply();

        }
    });
    dialog.show(); 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T01:13:22.903

您应该避免`Dialog`按照 Android[文档](http://developer.android.com/guide/topics/ui/dialogs.html)直接使用。因此，出于这个原因，我将向您指出[DialogFragment](http://developer.android.com/reference/android/app/DialogFragment.html)。但是代码相当简单。

```
FragmentTransaction ft = getFragmentManager().beginTransaction();
Fragment prev = getFragmentManager().findFragmentByTag("dialog");
if (prev != null) {
    ft.remove(prev);
}
ft.addToBackStack(null);

// Create and show the dialog.
DialogFragment newFragment = MyDialogFragment.newInstance(mStackLevel);
newFragment.show(ft, "dialog"); 
```

如果你看一下链接，你会看到当你`show()`使用片段时，你将它传递到一个标签中，在这种情况下调用它`dialog`。因此，这可以确保没有其他 Dialog 正在显示，这意味着它不会在原始 Dialog 之上显示另一个。当然，您必须扩展`DialogFragment`该类以制作您的自定义版本，但它还不错:)

# matlab - Mex 函数在完成时崩溃

> ID：13223990
> 
> 赞同：4
> 
> 时间：2012-11-04T23:17:59.607
> 
> 标签：matlab, segmentation-fault, mex

我在这里有一个可以正确执行的 C mex 文件，但是在 MATLAB 执行完成后，它会因段错误而崩溃。由于它在程序完成执行后崩溃，这让我认为 MATLAB 自动释放分配的内存导致了这个问题。但是，我释放了我自己的动态分配的变量，并且不尝试释放 mxArray 结构。请看一下，看看您是否可以帮助我确定导致 MATLAB 崩溃的原因。

```
#include <mex.h>
#include <matrix.h>
#include <stdio.h>

void mexFunction(
int nlhs, mxArray *plhs[],
int nrhs, const mxArray *prhs[])
{ 
    /* Declare variables. */
    int i ,j, numdims, *ipos, count;
    const mwSize *dim_array;
    mwSize size;
    double *pos, rad;

    /* Ingest inputs. */
    numdims = mxGetNumberOfDimensions(prhs[0]);
    dim_array = mxGetDimensions(prhs[0]);
    rad = mxGetScalar(prhs[1]);
    pos = mxGetData(prhs[0]);
    size = dim_array[0]*dim_array[1];

    ipos = (int*) mxMalloc(size);
    for (i = 0; i < size; i++)
        ipos[i] = (int) (pos[i]*rad);
    count = 0;
    for (i = 0; i < size; i+=2)
        for (j = i + 2; j < size; j+=2)
            if (ipos[i] == ipos[j])
                if (ipos[i+1] == ipos[j+1])
                    count++;
    mxFree(ipos);

    /* Generate output */
    plhs[0] = mxCreateDoubleScalar(count);
    printf("\nProgram finished executing!\n");
} 
```

提前感谢您的帮助！

编辑：我还应该注意，程序的输入是（按顺序）一个 2 xn 矩阵和一个标量，其中 n 可以是任何正整数。实际的程序会正确检查尺寸，但我没有在此处包含这些行以节省代码空间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T23:41:57.550

**UPD。**你是对的 - 当矩阵变大时，它会崩溃:)

所以我想我有一个想法：

尝试更改您的两行代码

```
plhs[0] = mxCreateDoubleMatrix(1, 1, mxREAL);
mxGetPr(plhs[0])[0] = (double) count; 
```

对于新的单行

```
plhs[0] = mxCreateDoubleScalar(count); 
```

完成后它不再崩溃。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T18:18:39.900

在编写了几百个具有动态内存分配的 C 程序之后，我有点惭愧地说错误是这样的：

代替

```
 ipos = (int*) mxMalloc(size); 
```

和

```
 ipos = (int*) mxMalloc(size*sizeof(int)); 
```

似乎总是最愚蠢的错误在逃避我。我要感谢所有可能花一两分钟时间看帖子的人。

# c++ - 架构 x86_64 的 C++ Hello World 未定义符号：

> ID：13223992
> 
> 赞同：4
> 
> 时间：2012-11-04T23:18:18.197
> 
> 标签：c++, undefined

应该很简单，但是当我编译 C++ Hello World 代码时会返回一堆未定义的符号错误。

```
// my first program in C++
#include <iostream>
using namespace std;

int main ()
{
  cout << "Hello World!";
  return 0;
} 
```

下面是我的编译方式：打开终端，cd 到目录，gcc hello.cpp

然后我得到错误。有什么想法吗？我觉得我可能弄坏了一些东西......或者我只是错过了一些非常明显的东西。任何帮助是极大的赞赏！

继承人的错误：

```
Undefined symbols for architecture x86_64:
"std::cout", referenced from:
      _main in ccfUAf5i.o
  "std::basic_ostream<char, std::char_traits<char> >& std::operator<< <std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*)", referenced from:
      _main in ccfUAf5i.o
  "std::ios_base::Init::Init()", referenced from:
      __static_initialization_and_destruction_0(int, int)in ccfUAf5i.o
  "std::ios_base::Init::~Init()", referenced from:
      ___tcf_0 in ccfUAf5i.o
ld: symbol(s) not found for architecture x86_64
collect2: ld returned 1 exit status 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-04T23:21:32.443

您需要用于`g++`编译和链接 C++ 代码：

```
g++ hello.cpp -o hello 
```

或者完全兼容 Stack Overflow：

```
g++ -W -Wall -Werror -pedantic -o hello hello.cpp 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T23:21:30.877

使用 g++ 而不是 gcc。但无论如何，您的 gcc 安装似乎已损坏。您还想在 32 位机器/操作系统上编译 64 位 exec 吗？

# plot - 将结果存储在 fortran 77 的列中

> ID：13223993
> 
> 赞同：1
> 
> 时间：2012-11-04T23:18:20.043
> 
> 标签：plot, fortran, fortran77

我正在将我的一个代码转换为 fortran 77，但我在存储结果时遇到了问题。

我使用了以下代码

```
OPEN(UNIT=21, FILE='name.TXT', STATUS='REPLACE')
WRITE(UNIT = 21,*) results
CLOSE(UNIT=21) 
```

然后在 Matlab 中加载文件 name.txt 进行绘图。但是，结果作为二维数组写入文件，因此 matlab 以错误的顺序识别条目。我认为解决方案是将结果作为一维数组写入 name.txt 中。

任何人都可以对将 fortran 的结果写成数组有任何建议吗？例如，我想获取一个文件，其中条目的排序为

1 2 3 4 5 6 7 8 9 10

以外

1 2 3 4 5
6 7 8 9 10。

当然，如果您知道任何更好的方法来绘制从 Fortran 77 获得的结果，它对我也很有用。

顺便说一句，我在 UNIX 上工作。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-17T23:21:15.043

当您使用自由格式输出（通常称为

```
*
```

格式说明符），Fortran 将输出的详细信息留给编译器。一个这样的细节是单行中的字符数。大多数编译器会在一定数量的字符后将输出换行，当您使用自由格式时，您无法影响这一点。所以它并不是真的被写成一个“二维数组”，它是按顺序写出来的，当它用完“空间”（由编译器定义）时，它会定期移动到一个新行。尝试使用这样的格式：

```
WRITE(UNIT=21, '(I)') results
```

使用上面的格式，编译器被迫将变量**结果**打印为整数（或一堆整数），并且由于格式中没有换行指令，它将在一行上打印出**结果**的所有元素. 事实上，它会将它们打印出来，中间没有空格，这可能不是你想要的。添加一个“X”字段标识符以在每个整数之间放置一个空格。

```
WRITE(UNIT=21, '(I, X)') results
```

这应该会在您的文件中为您提供一个完整的整数行。如果您改用浮点变量，请将**I**替换为**F**。

查看此页面以获取有关 Fortran77 格式的进一步说明： [http ://www.oc.nps.edu/~bird/oc3030_online/fortran/io/io.html](http://www.oc.nps.edu/~bird/oc3030_online/fortran/io/io.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-10T09:09:49.323

您可以尝试使用具有明确数量的整数（固定长度）的格式：

```
WRITE(UNIT = 21, '(100i5)') return 
```

如果数组中的元素数量已知，则可以使用隐式循环：

```
WRITE(UNIT = 21, '(100i5)') ( return(j), j=1,n ) 
```

# image - 如何使响应式图像和标题相处融洽？

> ID：13223995
> 
> 赞同：3
> 
> 时间：2012-11-04T23:18:24.270
> 
> 标签：image, html, css, responsive-design, viewport

在这种情况下，图像符合响应式设计，但**标题并没有随之调整**。

在代码中是有道理的，但是如何在不设置`max-width`像素值的情况下完成呢？

单个 中有两个图像`section`，每个图像都包含在`figure`a 中`figcaption`：

```
<section>    
    <figure>
        <img src="link.jpg">
        <figcaption>Caption</figcaption>
    </figure>
    <figure>
        <img src="link.png">
        <figcaption>Caption</figcaption>
    </figure>
</section> 
```

[在 CSS](http://jsfiddle.net/Baumr/XjthT/21/)中，我们设置了一些东西，但最重要的是，`img`已经`max-width: 100%`设置了，但似乎没有办法让标题做同样的事情：

![在此处输入图像描述](../Images/bd3705e880ca94e713df398e342610a6.png)

**在考虑到旧浏览器的响应式设计中，如何避免这种重叠？**除了设置`max-width: 300px`or`figure`元素`section`。

请注意，任何解决方案都应考虑当窗口变小时，它应该允许图像变小：

![在此处输入图像描述](../Images/b2520b3171614977f629bbf694ff058a.png)

换句话说，`auto margins`应该消失。（水平边距会在狭窄的视口上浪费空间。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T18:00:11.603

要将 绑定`figcaption`到 的宽度，`img`您需要将它们都包裹在一个元素内，该元素将折叠到 的宽度`img`，在这种情况下，我使用了`div`：

```
<figure>
    <div>
        <img src="http://www.phibetaiota.net/wp-content/uploads/2012/10/Google-Data-Center.jpg">
        <figcaption>First example caption</figcaption>
    </div>
</figure> 
```

使用 CSS：

```
section figure div {
    position: relative;
    display: inline-block;
    max-width: 100%;
    padding: 0;
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/XjthT/23/)。

您可能希望调整它的`overflow`属性`div`，显然，调整到口味。但是，如果您想将`figure`元素保持为 100% 宽度，那么您需要另一个元素来包含`img`and `figcaption`，以便将 的宽度限制`figcaption`为`img`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-28T10:55:18.917

我不确定我是否完全理解您想要实现的目标，但这就是您想要的吗？[http://jsfiddle.net/XjthT/124/](http://jsfiddle.net/XjthT/124/)

我在 img 和标题周围添加了一个跨度：

```
section figure span{
    display: inline-block;
    position: relative;
} 
```

# java - 使用数组实现队列 - Java

> ID：13223996
> 
> 赞同：1
> 
> 时间：2012-11-04T23:18:29.060
> 
> 标签：java, arrays, queue

我正在尝试使用数组来实现队列 ADT 来完成家庭作业（如果由我决定，我会使用链表，但我猜教授希望我们学习新事物或 XD 的东西）。无论如何，我正在研究一种将元素添加到队列末尾的方法，如果它超出范围，同样的方法应该创建一个新的调整大小的数组，这就是我正在努力解决的方法（ enqueue() 方法）。这是我的代码：

```
import java.util.Arrays;

public class Queue<T> implements QueueInterface<T> {

    private T[] a;
    private int sz;

    public Queue(int capacity) {
        sz = 0;
        @SuppressWarnings("unchecked")
        T[] tempQueue = (T[])new Object[capacity];
        a= tempQueue;
    }

    public void enqueue(T newEntry) {
        try {
        for (int i=0; i<a.length; i++) {
                if (a[i] == null) {
                    a[i] = newEntry;
                    break;
                }
            }
        sz++;
        }
        catch (ArrayIndexOutOfBoundsException e) {
            @SuppressWarnings("unchecked")
            T[] tempQueue = (T[])new Object[a.length*+5];
            a= tempQueue;
            for (int i=0; i<a.length; i++) {
                if (a[i] == null) {
                    a[i] = newEntry;
                    break;
                }

            }
        }
    }

    public T dequeue() {
        T result = a[0];
        a[0] = null;
        for (int i=1; i<a.length;i++) {
            a[i-1] = a[i];
        }
        sz--;
        return result;
    }

    public T getFront() {
        return a[0];
    }

    public boolean isEmpty() {
        for (int i=0; i<a.length; i++) {
            if (a[i] != null) {
                return false;
            }
        }
        return true;
    }

    public void clear() {
        for (int i=0; i<a.length; i++) {
            a[i] = null;
            sz--;
        }
    }

    @Override
    public String toString() {
        return "Queue [a=" + Arrays.toString(a) + ", sz=" + sz + "]";
    }

} 
```

非常感谢大家的时间！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T23:45:08.997

如果要使用数组实现队列，我认为最好的方法是使用循环数组。这样，当您`dequeue`. 但是由于您想实现一个可调整大小（有界）的队列，因此循环数组实现变得有点困难。这里有一些有用的链接，

*   [圆形缓冲器](http://en.wikipedia.org/wiki/Circular_buffer)
*   [重新调整圆形数组的大小](https://stackoverflow.com/questions/5695042/queue-implementation-with-circular-arrays-which-is-the-best-way-to-resize-a-cir?rq=1)
*   [确定队列的开始 & 和](https://stackoverflow.com/questions/4002797/circular-arrays-in-queues)

如果您想要一个实现，只需谷歌即可。

（*这可能不是您问题的答案，但我无法评论您的问题。*）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T23:39:12.153

检查数组长度以检测出界 - 异常是昂贵的。

要复制数组，请创建一个适当大小的新数组，然后使用 System.arrayCopy

经验法则不是将大小增加固定数量，而是增加原始大小的百分比（例如大 30%）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T23:29:23.390

尝试将调整大小的逻辑放入一个名为`ensureSize`或其他的私有方法中。在那里检查所需的尺寸；如果它太小，请调整数组大小并复制内容。从可能需要增加数组大小的任何方法中调用此方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T23:30:22.343

您的实现可能不是使用数组来实现队列的最有效方式，但鉴于您已决定以这种方式实现它，您的入队方法比它需要的要复杂一些。

您有一个字段`sz`可用于确定必须放置新条目的位置，而不是检查以查找第一个非空值。并且由于出队没有清除向前移动的最后一个元素，因此对非 null 的搜索无论如何都不会正常工作。

该`sz`字段还会告诉您何时需要调整大小，而不是通过异常检测该需求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-04T23:33:15.663

补充 Alan Krueger 的回答：调整大小时不必再次遍历整个数组。创建一个临时变量来存储旧数组的长度并从它开始迭代。