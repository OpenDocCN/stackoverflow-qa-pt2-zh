# StackOverflow 问答 13976000-13976999

# 3g - qemu 上带有 USB 加密狗 3G 的 usb_modeswitch

> ID：13976000
> 
> 赞同：2
> 
> 时间：2012-12-20T16:01:49.480
> 
> 标签：3g, qemu, openwrt, dongle

我正在尝试在带有 openwrt 环境的 qemu 中使用加密狗 3G。加密狗参考：华为-K4605。

首先，我在 option.c 中有补丁内核源代码：

```
--- option.c    2010-12-09 22:29:45.000000000 +0100
+++ option.c    2012-11-12 17:39:17.000000000 +0100
@@ -165,6 +165,7 @@
 #define HUAWEI_PRODUCT_E143D           0x143D
 #define HUAWEI_PRODUCT_E143E           0x143E
 #define HUAWEI_PRODUCT_E143F           0x143F
+#define HUAWEI_PRODUCT_E14C6           0x14C6
 #define HUAWEI_PRODUCT_K4505           0x1464
 #define HUAWEI_PRODUCT_K3765           0x1465
 #define HUAWEI_PRODUCT_E14AC           0x14AC
@@ -477,6 +478,7 @@
    { USB_DEVICE_AND_INTERFACE_INFO(HUAWEI_VENDOR_ID, HUAWEI_PRODUCT_E143E, 0xff, 0xff, 0xff) },
    { USB_DEVICE_AND_INTERFACE_INFO(HUAWEI_VENDOR_ID, HUAWEI_PRODUCT_E143F, 0xff, 0xff, 0xff) },
    { USB_DEVICE_AND_INTERFACE_INFO(HUAWEI_VENDOR_ID, HUAWEI_PRODUCT_K4505, 0xff, 0xff, 0xff) },
+   { USB_DEVICE_AND_INTERFACE_INFO(HUAWEI_VENDOR_ID, HUAWEI_PRODUCT_E14C6, 0xff, 0xff, 0xff) },
    { USB_DEVICE_AND_INTERFACE_INFO(HUAWEI_VENDOR_ID, HUAWEI_PRODUCT_K3765, 0xff, 0xff, 0xff) },
    { USB_DEVICE_AND_INTERFACE_INFO(HUAWEI_VENDOR_ID, HUAWEI_PRODUCT_ETS1220, 0xff, 0xff, 0xff) },
    { USB_DEVICE_AND_INTERFACE_INFO(HUAWEI_VENDOR_ID, HUAWEI_PRODUCT_E14AC, 0xff, 0xff, 0xff) }, 
```

我还将内核模块安装为 kmod-usb-serial-option 或 kmod-usb-uhci。接下来，我在 /etc/usb_modeswitch.conf 中禁用了主机上的自动 usb_modeswitch。

我的加密狗有两个产品/供应商 ID，当我们在存储模块中使用它时为 12d1:14c1，在加密狗 3G 模块中使用它时为 12d1:14c6。我使用 usb 选项运行我的 qemu：

```
-usb -usbdevice host:12d1:14c6 -usbdevice host:12d1:14c1 
```

我在存储模块中使用 lsusb 在我的 qemu 机器上检测到我的设备。现在我必须切换它：`/usr/bin/usb_modeswitch -v 12d1 -p 14c1 -W -M "55534243123456780000000000000011062000000100000000000000000000"`

此步骤不起作用。在 usb_modeswitch.c 中放入一些调试代码后，我可以看到 usb_bulk_write 正在工作，但 usb_bulk_read 没有响应。我修改了 usb_modeswitch 的来源，以消除 usb_bulk_read 的无限等待。由于这个修改，我可以通过 lsusb 看到我的加密狗成功切换，但开发条目 ttyUSB0 不是在 /dev 中创建...

usb_modeswitch 的跟踪是：

> ```
> root@OpenWrt:~# /usr/bin/usb_modeswitch -v 12d1 -p 14c1 -W -M "55534243123456780000000000000011062000000100000000000000000000"
> scsi 2:0:0:0: CD-ROM            Vodafone CD ROM (Huawei)  2.31 PQ: 0 ANSI: 2
> scsi 3:0:0:0: Direct-Access     Vodafone Storage (Huawei)      PQ: 0 ANSI: 2
> sd 3:0:0:0: [sdb] Attached SCSI removable disk
> 
> Taking all parameters from the command line
> 
>  usb_modeswitch: handle USB devices with multiple modes
>  Version 1.2.3 (C) Josua Dietze 2012
>  Based on libusb0 (0.1.12 and above)
> 
>  PLEASE REPORT NEW CONFIGURATIONS !
> 
> DefaultVendor=  0x12d1
> DefaultProduct= 0x14c1
> TargetVendor=   not set
> TargetProduct=  not set
> TargetClass=    not set
> TargetProductList=""
> 
> DetachStorageOnly=0
> HuaweiMode=0
> SierraMode=0
> SonyMode=0
> QisdaMode=0
> GCTMode=0
> KobilMode=0
> SequansMode=0
> MobileActionMode=0
> CiscoMode=0
> MessageEndpoint=  not set
> MessageContent="55534243123456780000000000000011062000000100000000000000000000"
> NeedResponse=0
> ResponseEndpoint= not set
> 
> InquireDevice enabled (default)
> Success check disabled
> System integration mode disabled
> 
> Looking for default devices ...
>   searching devices, found USB ID 1d6b:0001
>   searching devices, found USB ID 0409:55aa
>   searching devices, found USB ID 12d1:14c1
>    found matching vendor ID
>    found matching product ID
>    adding device
>  Found device in default mode, class or configuration (1)
> Accessing device 003 on bus 001 ...
> Getting the current device configuration ...
>  OK, got current device configuration (1)
> Using first interface: 0x00
> Using endpoints 0x01 (out) and 0x81 (in)
> Inquiring device details; driver will be detached ...
> Looking for active driver ...
>  OK, driver found; name unknown, limitation of libusb1
>  OK, driver "unkown" detached
>  Could not get INQUIRY response (error -110)
> 
> USB description data (for identification)
> -------------------------
> Manufacturer: Vodafone Group (Huawei) 
>      Product: Vodafone Mobile Broadband (Huawei) 
>   Serial No.: not provided
> -------------------------
> Looking for active driver ...
>  No driver found. Either detached before or never attached
> Setting up communication with interface 0
> Using endpoint 0x01 for message sending ...
> Trying to send message 1 to endpoint 0x01 ...
>  OK, message successfully sent
> Resetting response endpoint 0x81
> libusb:error [op_clear_halt] clear_halt failed error -1 errno 32
>  Could not reset endpoint (probably harmless): -34
> Resetting message endpoint 0x01
> libusb:error [op_clear_halt] clear_halt failed error -1 errno 32
>  Could not reset endpoint (probably harmless): -34
> usb 1-2.1: USB disconnect, address 3
>  Device is gone, skipping any further commands
> -> Run lsusb to note any changes. Bye. 
> ```

有人有解决方案吗？我是否必须以某种方式配置 qemu 才能通过批量端点将 msg 发送到我的加密狗？

谢谢，

# magento - MAgento 自定义事件观察器以更新库存

> ID：13976006
> 
> 赞同：1
> 
> 时间：2012-12-20T16:02:09.980
> 
> 标签：magento, magento-1.9

我正在尝试在自定义模块中实现一个简单的观察者，以在加载产品库存时更新它。

这是xml文件的内容：

```
<?xml version="1.0"?>
<config>
    <modules>
        <Foo_Bar>
                <version>0.1</version>
        </Foo_Bar>
    </modules>
    <global>
        <models>
            <updatestock>
                    <class>Foo_Bar_Model</class>
            </updatestock>
        </models>
        <events>
            <catalog_product_load_before>
                <observers>
                    <Foo_Bar>
                        <type>model</type>
                        <class>updatestock/observer</class>
                        <method>updatestock</method>
                    </Foo_Bar>
                </observers>
            </catalog_product_load_before>
        </events>
    </global>
</config> 
```

以下是观察者模型的内容：

```
class Foo_Bar_Model_Observer extends Mage_Core_Model_Abstract {

    public function updatestock($observer) {
        $product = $observer->getProduct();

        $product->setQty(555);      
        $product->save();
    } 
} 
```

问题是 Stock 没有保存；有什么办法可以解决这个问题？

感谢帮助。

**编辑：**

我认为问题来自：

```
<catalog_product_load_before> 
```

该产品尚未加载，我得到一个 404 Not found 页面，但是当我将其替换为：

```
<catalog_product_load_after> 
```

产品库存已正确更新，但当产品库存可用性为“缺货”且库存为 0 时；前端中的“可用性”始终为“缺货”，并且“添加到购物车按钮”被隐藏（这意味着加载的库存为 0）。

我尝试过使用“ `<catalog_product_load_before>`”，但在这种情况下，我无法获得产品 ID 或 SKU。

感谢帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2019-01-12T07:45:23.080

如果您想`$productobj`从后端保存产品后，您可以轻松使用`catalog_product_save_after`事件。

我假设您已经知道如何在`M2`.

现在你需要为 M2 开发新模块

`events.xml`然后在下面的路径中创建这个文件

`app\code\YOUR_NAMESPACE\YOURMODULE\etc\adminhtml`

```
<?xml version="1.0"?>
<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="urn:magento:framework:Event/etc/events.xsd">
    <event name="catalog_product_save_after">
        <observer name="test_name" instance="YOUR_NAMESPACE\YOUR_MODULENAME\Observer\Productsaveafter" />
    </event>
</config> 
```

`Productsaveafter.php`并在以下路径中创建您的观察者文件

app\code\YOUR_NAMESPACE\YOURMODULE\Observer\

```
<?php

namespace YOURNAMESPACE\YOURMODULENAME\Observer;

use Magento\Framework\Event\ObserverInterface;

class Productsaveafter implements ObserverInterface
{    
    public function execute(\Magento\Framework\Event\Observer $observer)
    {
        $product = $observer->getEvent()->getProduct();
        $id = $product->getId(); //Get Product Id

        //Get Quantity
        $stockItem = $product->getExtensionAttributes()->getStockItem();
        $stockData = $stockItem->getQty();
        // Get new Qty
        $_vendor_qty = $product->getVendorQty();
        $_on_hand_qty = $product->getOnHandQty();
        $totalQty = $_vendor_qty+$_on_hand_qty; //Add New Qty

        $stockItem->setQty($totalQty); //Set New Qty to Main Qty
        $stockItem->save();

    }   
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T20:40:34.547

```
$product->getStockItem()
    ->setData('qty', $qty)
    ->save(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T16:21:20.237

产品库存通过 CatalogInventory 模块处理。

尝试这个：

```
class Foo_Bar_Model_Observer  {

    public function updatestock($observer) {
        $product = $observer->getProduct();
        $stock = $product->getStockItem();

        $stock->setQty(555);      
        $stock->save();

        $product->save();
    } 
} 
```

此外，您不需要在观察者上扩展 Mage_Core_Model_Abstract。只是想在您的系统中节省一点内存；）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T16:19:39.317

您可以使用以下方式加载产品：

```
$productId = $observer->getProduct()->getId();
$stockItem =Mage::getModel('cataloginventory/stock_item')->loadByProduct($productId);
$stockItem->setData('qty', (integer)$stockAmount);
$stockItem->save(); 
```

就是这样:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-20T16:16:48.380

使用事件 catalog_product_load_before 并在观察者中使用以下代码：

```
$productId = $observer->getValue();
$stockItem = Mage::getModel('cataloginventory/stock_item')->loadByProduct($productId);
$stockItem->setData('qty',555);
$stockItem->save(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-20T17:07:26.560

尝试

```
$product = productId = $observer->getProduct();
$stockItem = Mage::getModel('cataloginventory/stock_item');
$stockItem->assignProduct($product);
$stockItem->setData('is_in_stock', 1);
$stockItem->setData('qty', 5555);

$product->setStockItem($stockItem);
$product->save(); 
```

请参阅[Magento：取消已发货订单时增加“数量”](https://stackoverflow.com/questions/13330140/magento-increase-qty-upon-cancel-a-shipped-order)

# php - 来自远程国家共享服务器的 PHP Curl 太慢 - 我不清楚 getFlightInfo() 原因：

> ID：13976009
> 
> 赞同：0
> 
> 时间：2012-12-20T16:02:24.440
> 
> 标签：php, curl

使用来自远程国家共享主机的 PHP Curl 需要很长时间才能获取网页内容（平均约 3 秒）。

当我运行相同的简单代码来获取文件内容（HTTP Get）时，它需要第三次（~1 秒）。

我的问题是：

a) 为什么？（我在这里没有看到 DNS 问题 - 如果我错了，请纠正我。）

b）我能做些什么，除了搬到同一个国家的主人......（？）

这是 PHP Curl 代码，后面是 curl_getinfo() 输出的远程国家和相同国家的结果：

```
$mainUrl = 'www.example.com';
$ch = curl_init(); 
curl_setopt($ch, CURLOPT_URL, $mainUrl); 
curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE); 
$result1 = curl_exec($ch); 
```

试验结果：

```
Remote country web server       Same country                curl_getinfo()

200                             200                         http_code
402                             402                         header_size
445                             445                         request_size
-1                              -1                          filetime
0                               0                           ssl_verify_result
0                               0                           redirect_count
3.031631                        1.326                       total_time
3.20E-05                        0                           namelookup_time
3.60E-05                        0                           connect_time
8.10E-05                        0                           pretransfer_time
6590                            7096                        size_upload
470296                          370232                      size_download
155129                          279209                      speed_download
2173                            5351                        speed_upload
470296                          370232                      download_content_length
6590                            7096                        upload_content_length
0.162921                        0.031                       starttransfer_time
0                               0                           redirect_time 
```

# three.js - 当面顶点不在 z=0 处时，光线相交不正确

> ID：13976010
> 
> 赞同：1
> 
> 时间：2012-12-20T16:02:26.997
> 
> 标签：three.js

我创建了一个由多个三角形面组成的平面（THREE.js，CanvasRenderer）。当我将鼠标指针悬停在它们上面时，我希望它们随机改变它们的颜色。当面的所有顶点都在 z = 0 时，它工作正常：

[http://jsfiddle.net/koweiny/FT4uS/](http://jsfiddle.net/koweiny/FT4uS/)

但是当我将面设置为任何其他值时，假设 z = -10，它的行为方式非常疯狂，就好像表面现在是 z = 0 处不可见表面的反射：

[http://jsfiddle.net/koweiny/FT4uS/2/](http://jsfiddle.net/koweiny/FT4uS/2/)

代码中唯一的变化是变量节点的第三个组件，现在所有顶点都为 -10：

```
var node = new THREE.Vector3(x, y, -10); 
```

代替

```
var node = new THREE.Vector3(x, y, 0); 
```

谁能告诉我为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:34:09.390

`Ray.intersectObjects()`需要面形心。

```
geometry.computeCentroids(); 
```

小提琴：http: [//jsfiddle.net/FT4uS/5/](http://jsfiddle.net/FT4uS/5/)

三.js r.53

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T03:25:29.810

这让我想起了 intersectObjects 的一些奇怪行为。我的猜测是，如果你有一个远离场景中心的物体，boudingSphere 很大，所以当我将鼠标移到它旁边的空白处时，这个函数仍然返回我下一个物体。

所以为了防止我确定这个函数，它只是将对象中的点与边界框进行比较。

```
_this.checkIfPointMatchBox = function( set ) {      
    if (set.point.x < set.object.geometry.boundingBox.min.x || set.point.x > set.object.geometry.boundingBox.max.x) {
        return false;
    }
    if (set.point.y < set.object.geometry.boundingBox.min.y || set.point.y > set.object.geometry.boundingBox.max.y) {
        return false;
    }
    if (set.point.z < set.object.geometry.boundingBox.min.z || set.point.z > set.object.geometry.boundingBox.max.z) {
        return false;
    }
    return true;
} 
```

# encoding - 有没有办法突出显示崇高文本或任何其他文本编辑器中的所有特殊重音字符？

> ID：13976022
> 
> 赞同：79
> 
> 时间：2012-12-20T16:03:48.117
> 
> 标签：encoding, sublimetext2, html-encode, htmlspecialchars

我在 Sublime 文本中使用 HTML 编码特殊字符将所有特殊字符转换为它们的 HTML 代码。我在文件的不同部分有很多重音字符。所以，如果我可以选择所有特殊字符，然后使用插件一次转换，那就太好了！

是否有一个正则表达式可以帮助只选择所有特殊字符？

* * *

## 回答 #1

> 赞同：194
> 
> 时间：2012-12-21T18:15:00.070

是的。

Sublime 文本支持正则表达式，您可以选择所有非 ASCII（代码点 > 128）字符。这个正则表达式对你来说应该足够了：

```
[^\x00-\x7F] 
```

只需搜索和替换。

但是，如果您首先进行手动 HTML 编码，那么您就做错了。将您的文件保存为 UTF-8 编码（默认为 Sublime Text 2），并确保您的 Web 服务器也以 UTF-8 格式发送这些文件。无需转换、编码或任何东西。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-04-30T10:45:37.120

### 作为进一步参考（或作为补充）：

Sublime Text 2/3 包，名为[`Highlighter`](https://sublime.wbond.net/packages/Highlighter)，可以（正如他的名字所说）使用正则表达式突出显示一些字符...

> *“您还可以为要突出显示的字符添加自定义正则表达式。”*

所以，有了这个包，加上`@Mikko Ohtamaa`答案，我们可以编辑文件......

`highlighter.sublime-settings -` **`User`**

...并包括建议的正则表达式，（此处表示为**`[^\\x00-\\x7F]`**）最终得到如下内容：

```
{  
    "highlighter_regex": "(\t+ +)|( +\t+)|[^\\x00-\\x7F]|[\u2026\u2018\u2019\u201c\u201d\u2013\u2014]|[\t ]+$"  
} 
```

结果将是我们文件中任何*“非ASCII（代码点> 128）字符”的***自动突出显示。**

 *请注意，这不会选择这些字符，只会突出显示它们以便轻松实现（如果有的话）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-12-19T21:49:14.520

## 另一个插件选项

我最近写了一个专门用于突出显示非 ascii 字符的插件： [https ://github.com/TuureKaunisto/highlight-dodgy-chars](https://github.com/TuureKaunisto/highlight-dodgy-chars)

使用 Highlighter 可以实现完全相同的功能，但使用不太通用的 Highlight Dodgy Chars 插件，您无需编写正则表达式，您只需列出您不想在设置中突出显示的非 ascii 字符。欧洲特殊字符默认被列入白名单。*

# java - Java utc 时间以微秒和 15 微秒为单位

> ID：13976024
> 
> 赞同：3
> 
> 时间：2012-12-20T16:04:00.617
> 
> 标签：java, date, time, utc, simpledateformat

有没有办法在午夜后的微秒和 15 微秒的块中提取 java utc 时间？

这意味着从 1 微秒到 15 微秒的时间将由相同的时间表示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:09:46.620

唯一的问题是时间分辨率。一般来说，Java 通过`java.util.Date`或支持毫秒精度[`System.currentTimeMillis()`](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#currentTimeMillis%28%29)。如果您需要更高的精度，[`System.nanoTime()`](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#nanoTime%28%29)可能会成功。

但这带来了另一个问题——`nanoTime()`与任何日历无关，它只是一个不断增长的纳秒精度计数器。我能想到的唯一解决方法是：

*   `System.nanoTime()`在午夜确定值，调用它`S`。这可能有问题，但您不必等到午夜，一些简单的数学运算就足够了。

*   计算以下：

    ```
    (System.nanoTime() - S) / 15000 
    ```

*   如果值为`0`，则我们处于相同的 15 微秒范围内

您确定 JVM 和您的程序实际上可以利用如此小的时间吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T16:10:09.810

您可能想查看[这个](https://stackoverflow.com/questions/1712205/current-time-in-microseconds-in-java)问题以获取有关以微秒为单位的时间的信息。Java 不支持微秒日期计时。

Java 支持以毫秒为单位的日期，在某些系统上，您可以通过`System.nanoTime()`. 如果您的系统支持纳秒分辨率，那么编写一个可以将您的纳秒数转换为 15 微秒块的函数将相当容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-04T22:08:20.787

# vba - 按两个指定行之间的日期排序

> ID：13976030
> 
> 赞同：1
> 
> 时间：2012-12-20T16:04:17.990
> 
> 标签：vba, sorting, excel, identity-column

我正在尝试根据 N 列中的数据制作 VBA 代码自动排序数据，但我对如何使其在范围可能发生变化的两行之间进行排序感到困惑。在其他作品中，我有两列，

1) 少尉 88

2）精密560

它们之间的行数将一直在变化（添加和删除），但我不希望它对这两个标题行之外的行进行排序。

![在此处输入图像描述](../Images/724d27363c06d8717ddaa337b73d8632.png)

# asp.net - ASP.Net 为鲜为人知的数据库设计数据访问层

> ID：13976033
> 
> 赞同：0
> 
> 时间：2012-12-20T16:04:29.487
> 
> 标签：asp.net, data-access-layer

我们正在重构 ASP.Net Web 应用程序的整个代码库。几乎整个应用程序都在使用 c# 代码中的 sql 语句来查询数据库，并且类似的 sql 语句分散在整个代码库中。该应用程序正在使用 Mimer 数据库，该数据库不是常用的数据库。

对于这样的应用程序，特别是对于数据访问层以删除确保 DRY 的重复代码，什么可能是一个好的重构计划？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T16:21:34.473

在数据库实现上实现一个抽象层，这样您的应用程序调用方法 like `GetUser()`and`UpdateWidget()`而不是`IDbCommand.ExecuteReader()`and friends。

这些方法将存在于接口上，每个实体类型一个。

```
IUserRepository
IWidgetRepository 
```

每个数据库平台的每个接口都应该有一个实现者。

```
MySqlUserRepository
MySqlWidgetRepository

MimerUserRepository
MimerWidgetRepository 
```

然后创建一个工厂类，为相关数据库平台提供所请求实体类型的正确实现类的实例。

工厂类应该在知道应用程序当前配置使用的数据库平台的情况下进行实例化。它应该使用此信息来选择要实例化的类并在被询问时返回。

```
class RepoFactory
{
    string _platform;
    public RepoFactory(string platform) { this._platform = platform; }

    public IUserRepository GetUserRepository()
    {
        if (_platform == "mysql") return new MySqlUserRepository();
        if (_platform == "mimer") return new MimerUserRepository();
        throw new NotSupportedException(_platform);
    }

    public IWidgetRepository GetWidgetRepository() // ...
} 
```

保留对 RepoFactory 的单个实例的引用，以便您只需从配置中设置一次。

将所有特定于数据库平台的内容粘贴到实现类中，工作完成。（您已经编写了 Mimer 所需的所有查询 - 您只需将它们从您的应用程序移植到这个新的数据层。）

# shell - 反斜杠在以下语法中删除具有内容的 UNIX 目录有什么区别？

> ID：13976037
> 
> 赞同：3
> 
> 时间：2012-12-20T16:04:42.033
> 
> 标签：shell, unix, delete-file, rm, rmdir

我需要删除一个包含多个子目录和文件的目录。在谷歌搜索并查看 and 的手册页后`rmdir`，`rm`我有以下两种选择：

`$ rm -rf <folder_name>`和`$ \rm -rf <folder_name>`

这两者有何不同？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T16:09:16.800

使用**\**意味着您希望您的 shell**忽略**基于此命令的任何别名

假设您有一个像这样的别名：

```
alias rm='rm -i' 
```

**如果你想 rm 你的整个/**，你会非常想忽略它。

祝你好运

# c# - C# 函数指针

> ID：13976038
> 
> 赞同：2
> 
> 时间：2012-12-20T16:04:43.687
> 
> 标签：c#, user-controls

我正在创建一个用户控件，我希望它对我的数据库类一无所知。

但是，我需要该数据库类的某些功能（我需要根据员工编号获取员工姓名）。

我想做的是在我的用户控件中创建一些东西，我可以在使用它的应用程序中连接，就像我连接点击事件或类似的东西一样。

我以前从未在 C# 项目中真正创建过这样的东西，所以我不知道该怎么称呼它。我想它必须存在。

我想在我的数据库类中调用的函数具有以下签名：

```
public string GetEmployeeName(int employeeNumber); 
```

有人能告诉我我想要做什么吗？

如果它是困难的，一个例子也很好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T16:07:25.070

我认为您想要做的是使用[委托](http://msdn.microsoft.com/en-us/library/900fyy8e%28v=vs.110%29.aspx)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-20T16:15:04.487

您可以使用委托来执行此操作，例如`Func<TArgument, TResult>`；

向您的用户控件添加一个公共字段：

```
//A method that has an int parameter and returns a string
public Func<int, string> GetEmployeeName; 
```

在您的用户控件中，当您需要获取员工姓名时，您可以使用委托：

```
string employeeName;
if (GetEmployeeName != null)
    employeeName = GetEmployeeName(employeeNumber); 
```

您可以通过执行以下操作从托管页面或控件设置委托：

```
myUserControl.GetEmployeeName = GetEmployeeName; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-20T16:26:24.830

如果您的控件需要通过数据库调用很多业务操作，我建议您编写一个接口并为其编写一个实现实例。

# actionscript-3 - 这个 Actionscript 3.0 库的名称是什么？

> ID：13976043
> 
> 赞同：-2
> 
> 时间：2012-12-20T16:04:48.473
> 
> 标签：actionscript-3, events

我记得最近遇到了一个专门为事件制作的 Actionscript 3.0 库。您可以编写更少的代码并轻松地为您的项目定义事件侦听器。我忘记了名字和链接，所以如果有人听说过这样的图书馆，你能把我链接到它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:06:52.827

我认为您正在寻找[EventController](http://fla.as/ec/action.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T05:30:13.803

另请查看 [AS3 Common Event Bus](http://www.as3commons.org/as3-commons-eventbus/index.html)。这个事件总线对我们的开发很有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T16:06:28.490

您可能指的是[AS3 Signals](https://github.com/robertpenner/as3-signals)。如果你不是，你应该检查一下，因为它是一个很棒的图书馆。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T23:23:06.133

google - as3 事件库。

#1 搜索结果是您需要的答案。

对此进行问答，有点愚蠢。最佳答案应该是“学习使用谷歌”。

# android - Windows 8 中是否有相当于 Android 的 addJavascriptInterface() 的功能？

> ID：13976048
> 
> 赞同：2
> 
> 时间：2012-12-20T16:05:14.357
> 
> 标签：android, windows, windows-8, webview, internet-explorer-10

我的公司使用在 WebViews 中构建的 Android 应用程序，其中包含一些可通过 JavaScript 界面访问的原生代码。

```
webView.addJavascriptInterface(new JavaScriptInterface(this), "jsInt"); 
```

可以通过 WebView 中的 JavaScript 访问类 JavaScriptInterface 的成员。

```
<script> jsInt.nativeMethodCall(); </script> 
```

我想知道 Windows 8 是否具有相同的功能。如果是这样，有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T20:14:50.213

功能不完全相同，但有一种机制可以在 WebView 中从 JavaScript 到 C# 来回通信。

另请记住，HTML 5/JavaScript 是 Windows 8 的本机开发选项，因此您的代码可能根本不需要在 WebView 中运行。您可能会将应用程序移植到 HTML5/JS 目标，然后与其他确实可以用 C# 编写的 Windows 运行时组件进行交互。

也就是说，对于 WebView，它将托管在 C#/XAML 应用程序内部并托管 HTML/JS（如在 Android 中）：

[InvokeScript](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.webview.invokescript.aspx)将允许您在当前加载的 WebView 文档中从 C# 调用 JavaScript 方法

在您的 C# 代码中，您可以侦听[ScriptNotify](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.webview.scriptnotify.aspx)事件以响应通过 windows.external.notify 传递的有效负载。

这两个都是[XAML Web View Control 示例](http://code.msdn.microsoft.com/windowsapps/XAML-WebView-control-sample-58ad63f7)的一部分，并且可以构成一些更像 Android 功能的基础。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T20:18:47.770

我为此找到了一个简单的教程：[Creating a simple component in C# or Visual Basic and call it from JavaScript](http://msdn.microsoft.com/en-us/library/windows/apps/hh779077%28v=vs.110%29.aspx)

# asp.net - ASP.NET - 在服务器上保存 pdf 文件

> ID：13976053
> 
> 赞同：3
> 
> 时间：2012-12-20T16:05:51.547
> 
> 标签：asp.net, vb.net

我有一个 aspx 页面，它返回一个包含以下代码的 pdf 文件：

```
HttpContext.Current.Response.Clear()
HttpContext.Current.Response.ContentType = "application/pdf"
HttpContext.Current.Response.AddHeader("Content-disposition", "attachment; filename=Order-" & Request("OrderNo") & ".pdf")
HttpContext.Current.Response.BinaryWrite(pdfContent)
HttpContext.Current.Response.End() 
```

需要对代码进行哪些修改才能将文件保存到服务器的硬盘上？我猜 BinaryWrite 必须用别的东西代替，但是什么？

我非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T16:12:41.317

只需将 Path 和 pdfcontent 指定为`File.WriteAllBytes`方法的参数，如下所示：

```
File.WriteAllBytes(Server.MapPath("~/SubdirectoryInCurrentWebApp"),pdfContent); 
```

您通常无法将任何内容保存在本地应用程序目录之外，除非您使用具有足够权限写入目标目录的用户配置运行应用程序的应用程序池。但是开箱即用，您应该能够写入 Web 应用程序内的子目录。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T16:07:11.687

您可以通过调用将二进制数据写入磁盘`File.WriteAllBytes`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T16:10:32.720

如果您只想将字节转储`pdfContent`到文件中，那么`IO.File.WriteAllBytes("{A path}",pdfContent)`应该这样做。

# vba - 用于将单元格从一个工作簿复制到另一个工作簿的宏

> ID：13976058
> 
> 赞同：-6
> 
> 时间：2012-12-20T16:06:02.550
> 
> 标签：vba, excel

我正在寻找一个将特定范围的单元格从一个工作簿复制到新工作簿的宏。该宏将从 复制单元格`A1:HC5`，`"Workbook1"`并粘贴到 的相同单元格`(A1:HC5)`中`"Workbook2"`。感谢您的任何指导！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T16:52:08.640

这应该有效：

```
Sub test()
   Dim wbk As Workbook

   strFirstFile = "C:\source.xls"
   strSecondFile = "C:\destination.xls"

      Range("A1:HC35").Copy

   Set wbk = Workbooks.Open(strSecondFile)
   With wbk.Sheets("Sheet1")
      Range("A1").PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
   End With 
End Sub 
```

# python - 在 Python 中解析 JSON：如何在更改格式后让 has_key() 再次工作？

> ID：13976060
> 
> 赞同：2
> 
> 时间：2012-12-20T16:06:16.570
> 
> 标签：python, json, unicode

我有以下 Python 代码块：

```
data = json.loads(line)
if data.has_key('derivedFrom'):
     dFin = data['derivedFrom']
     if dFin.has_key('derivedIds'): 
```

这曾经在这样的 JSON 块上正常工作：

```
"derivedFrom": {"source": "FOO", "model": "BAR", "derivedIds": ["123456"]} 
```

现在格式更改为：

```
"derivedFrom": "{\"source\": \"FOO.\", \"model\": \"BAR\", \"derivedIds\": [\"123456\"] 
```

因此 Python 块中的最后一行会引发以下异常：

```
'unicode' object has no attribute 'has_key' 
```

有没有办法预处理 JSON 以`has_key`再次工作？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-20T22:35:00.100

```
"{\"source\": \"FOO.\", \"model\": ... 
```

是 JSON 字符串文字中的 JSON 对象。要获得内部 JSON 的属性，您必须再次对其进行解码。

```
data = json.loads(line)
if 'derivedFrom' in data:
    dFin = json.loads(data['derivedFrom'])
    if 'derivedIds' in dFin:
        .... 
```

JSON-in-JSON 通常是一个错误，因为很少需要它 - 是什么产生了这个输出，它需要修复吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T18:11:59.093

利用：

```
'derivedIds' in dFin 
```

这适用于字典和 unicode，即使使用 unicode 它可能会产生误报。

更强大的方法可以使用[Duck Typing](http://en.wikipedia.org/wiki/Duck_typing)：

```
try:
    dFin = json.loads(data['derivedFrom'])  #assume new format
except TypeError:
    dFin = data['derivedFrom']  #it's already a dict
if 'derivedIds' in dFin: # or dFin.has_key('derivedIds')
    #etc 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T18:46:09.973

如果您希望完全相同的代码块工作，请考虑将您的新格式稍微调整为以下：

```
"{\"derivedFrom\": {\"source\": \"FOO.\", \"model\": \"BAR\", \"derivedIds\": [\"123456\"]}}" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T16:11:46.573

您正在将 derivedFrom 属性从 JSON 对象更改为字符串。字符串没有名为 has_key 的属性。

# macos - 如何在 Chrome for OS X 上手动安装扩展程序？

> ID：13976062
> 
> 赞同：0
> 
> 时间：2012-12-20T16:06:20.517
> 
> 标签：macos, google-chrome, google-chrome-extension

我已经创建了一个 chrome 扩展，我想手动将它添加到 mac osx（10.7 和 10.8）上的 chrome

我尝试执行以下步骤

1.  在以下 url 下添加扩展文件夹：/Users/talmutzafi/Library/Application Support/Google/Chrome/Profile 20/Extensions/

2.  在首选项列表下添加扩展数据。首选项列表位于 /Users/talmutzafi/Library/Application Support/Google/Chrome/Profile 20/preferences

我试图添加：

```
- under backup i added the ext. id to the id's list

       "backup": {
  "_signature": "+1Vx9UrMvhjXj4EFWQAf2eMfrRs+ZrFK3ogVnwE/Njs=",
  "_version": 4,
  "extensions": {
     "ids": [ "ahfgeienlihckogmohjhadlkjgocpleb", "akheoamkobfngpbmfmnjnekmciamdknh", "apdfllckaahabafndbhieahigkjlhalf", "blpcfgokakmgnkcojhhkbfbldkacnbeo", "coobgpohoikkiipiblmjeljniedjpjpf", "pjkljhegncpnkpknbcohdijeoejaedia" ]
  }

- under settings i add the following data on the extension

     "akheoamkobfngpbmfmnjnekmciamdknh": {
        "ack_external": true,
        "active_permissions": {
           "api": [ "bookmarks", "contextMenus", "cookies", "geolocation", "history", "idle", "management", "notifications", "plugin", "tabs", "unlimitedStorage", "webNavigation", "webRequest", "webRequestInternal" ],
           "explicit_host": [ "chrome://favicon/*", "http://*/*", "https://*/*" ],
           "scriptable_host": [ "http://*/*", "https://*/*" ]
        },
        "app_launcher_ordinal": "t",
        "events": [ "runtime.onInstalled" ],
        "from_bookmark": false,
        "from_webstore": false,
        "install_time": "13000491448720728",
        "location": 3,
        "manifest": {
           "background": {
              "page": "js/chromeBackStage.html"
           },
           "chrome_url_overrides": {
              "newtab": "Search/NewTabPages/html/new_tab.html"
           },
           "current_locale": "en_US",
           "default_locale": "en_US",
           "description": "mac installer",
           "key": "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDIl5KlKwL2TSkntkpY3naLLz5jsN0YwjhZyObcTOK6Nda4Ie21KRqZau9lx5SHcLh7pE2/S9OiArb+na2dn7YK5EvH+aRXS1ec3uxVlBhqLdnleVgwgwlg5fH95I52IeHcoeK6pR4hW/Nv39GNlI/Uqk6O6GBCCsAxYrdxww9BiQIDAQAB",
           "manifest_version": 2,
           "name": "mac installer",
           "offline_enabled": true,
           "permissions": [ "storage", "tabs", "http://*/*", "https://*/*", "notifications", "management", "unlimitedStorage", "bookmarks", "contextMenus", "cookies", "geolocation", "history", "idle", "webNavigation", "chrome://favicon/*", "webRequest", "webRequestBlocking" ],
           "version": "1.0"
        },
        "page_ordinal": "n",
        "path": "akheoamkobfngpbmfmnjnekmciamdknh/1.0",
        "state": 1,
        "was_installed_by_default": true
     }, 
```

更改后，我打开 chrome 并希望看到我的扩展，但扩展没有出现。

我签入了窗口，除了将扩展名添加到首选项之外，我们还需要将扩展​​名写入注册表。

任何想法我还需要做什么才能手动安装 chrome 扩展文件夹

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T17:44:35.750

你能试试这条路吗

**对于特定用户：** `~USERNAME/Library/Application Support/Google/Chrome/External Extensions/`

**对于所有用户**：`/Library/Application Support/Google/Chrome/External Extensions/`

*如果您在 Chrome 启动时没有看到安装了外部扩展，则外部扩展首选项文件可能存在权限问题。*

### 参考

a) [Mac 故障排除](https://developer.chrome.com/extensions/external_extensions.html#troubleshooting)。

b)[部署选项](https://developer.chrome.com/extensions/external_extensions.html)

如果您需要更多信息，请与我们联系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-16T08:17:20.640

目前，无法通过 crx 安装不在 windows 和 mac 机器上的 chrome 商店中托管的扩展。从文档中，[https://developer.chrome.com/docs/extensions/mv2/external_extensions/](https://developer.chrome.com/docs/extensions/mv2/external_extensions/) -

*警告 Windows 和 Mac 安装必须来自 Chrome Web Store：从 Chrome 33 开始，不允许从 Windows 上本地 .crx 的路径进行外部安装（请参阅保护 Windows 用户免受恶意扩展程序的侵害）。从 Chrome 44 开始，不允许从 Mac 上本地 .crx 的路径进行外部安装（请参阅继续保护 Chrome 用户免受恶意扩展程序的侵害）。*

# error-handling - DB2 - CLI0108E 通信链路故障。SQLSTATE=40003

> ID：13976063
> 
> 赞同：3
> 
> 时间：2012-12-20T16:06:22.000
> 
> 标签：error-handling, db2, connection-timeout

当我尝试对 IBM DB2 9.1 版本重新执行查询时，我不断收到以下错误消息。

CLI0108E 通信链路故障。SQLSTATE=40003

该查询正在更新大量记录（超过 50000 条记录）。

*   我确实尝试将超时更改为“0”以执行查询

    但这并没有帮助。

此外，我的 db2cli.ini 文件没有任何超时详细信息。我应该在那里添加任何东西吗？

请指教。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T17:00:52.493

**CLI0108E**仅表示连接已断开。来自[此错误代码的官方 IBM 文档](http://publib.boulder.ibm.com/infocenter/db2luw/v9r5/index.jsp?topic=/com.ibm.db2.luw.messages.cli.doc/doc/mcli00108e.html)：

> **CLI0108E**通信链路故障。
> 
> *Explanation*在执行此函数期间，驱动程序和数据源之间的连接失败。
> 
> *用户响应*建立新连接。

* * *

**SQLState (40003)**表示数据库服务器无法判断语句是否成功完成。（可以在此处找到 SQLState 消息及其含义的文档：http: [//publib.boulder.ibm.com/infocenter/db2luw/v9/index.jsp ?topic=%2Fcom.ibm.db2.udb.msg.doc% 2Fdoc%2Fr0sttmsg.htm](http://publib.boulder.ibm.com/infocenter/db2luw/v9/index.jsp?topic=%2Fcom.ibm.db2.udb.msg.doc%2Fdoc%2Fr0sttmsg.htm)

此范围内的值：

> *   40001 发生自动回滚的死锁或超时。
> *   40003 语句完成未知。
> *   40504 系统错误导致工作单元回滚。
> *   40506 由于 SQL 错误，当前事务已回滚。
> *   40507 由于创建索引失败，当前事务被回滚。

* * *

CLI0108E 可能有多种原因：网络问题、客户端或服务器由于超时而关闭连接、有人在计算机房踢电缆，等等。我什至在我们的环境中看到，在特定 VM 主机上运行的虚拟服务器出现此错误，因为虚拟 NIC 卡存在问题，并且通过重新安装驱动程序修复了该问题。可能的原因列表非常大，但一个好的网络管理员应该能够提供帮助。（当一切都失败时，使用嗅探器监控数据包是追踪来源的好方法。）

如果可以的话，重构代码以上传较小的集合可能不会有什么坏处。假设您有 10,000 条记录，尝试一次上传 1000 条记录，十次看看是否有帮助。

我在服务器完全不可靠的情况下（曾经）使用的另一种方法是尝试一次插入一条记录。

***伪代码***：（假设一个名为“connection”的连接对象和一个名为“cmd”的命令对象使用该连接......）

```
connection.Open()

for each record
   try
      cmd.CommandText  ="whatever changes need to be made"
      cmd.Execute()
   catch(Exception ex)
      if( the exception is a communication link failure)
         connection.Open()
         cmd.Execute()
       else
          handle different errors accordingly
       end if
  end try

next 
```

但是这种方法存在性能问题，很混乱，并且仍然可能会因为尝试重新打开连接失败而失败。即使我在紧要关头使用它，我也不建议长期使用它。（一旦原始问题得到解决，我就摆脱了这种方法。）你最好尝试追踪断开连接的根本原因。

在您的情况下，*根本*原因可能只是您尝试一次上传太多数据。我对此表示怀疑，但这是***可能***的。如果我站在你的立场上，那么我的首选肯定是重构代码以以更小的块发送数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-09T17:56:04.293

感谢大卫，为我指明了正确的方向。就我而言，这是内存泄漏。我有如下代码

```
IDbConnection conn = db2Access.GetConnection()
IDbCommand cmd = conn.CreateCommand() 
```

我改为

```
using(IDbConnection conn = db2Access.GetConnection())
{
  using(IDbCommand cmd = conn.CreateCommand())
  {
   ......

  }
} 
```

# delphi - Delphi XE2 代码完成损坏

> ID：13976067
> 
> 赞同：1
> 
> 时间：2012-12-20T16:06:38.307
> 
> 标签：delphi, delphi-xe2, code-completion

代码完成在我全新安装的 Delphi XE2 中被破坏。它以前可以工作，但后来突然停止了。我完全卸载（也删除了注册表设置），重新安装，现在即使是全新的应用程序也无法正常工作。

另外值得注意的是，错误洞察力抱怨一切。

某处有路径问题吗？

项目应该`Options --> Delphi Compiler --> Unit Aliases`有一个默认值吗？（我的是空白）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-29T20:21:27.097

这是一个老问题，但我发现如果混合行尾（一些行 LF，其他行 CR 甚至 CRLF），这可能会发生。批量使用 dos2unix 或 Notepad++（如果是单个/几个文件）来解决这个问题。

# css - 手写笔 - 添加百分比

> ID：13976079
> 
> 赞同：2
> 
> 时间：2012-12-20T16:07:34.203
> 
> 标签：css, percentage, addition, stylus

我在使用[Stylus](http://learnboost.github.com/stylus/)时遇到问题。我只是想创建一个函数，它返回给定 span 的列的宽度`n`。这是我的代码：

```
column-gap = 1%
column-width = 15%

column-span(n)
(column-width * n) + (column-gap * (n - 1)) 
```

问题是 when `n`= 2 我期望`column-span`返回`31%`，但它反而返回`30.3%`。

经过反复试验，我注意到即使这段代码也符合`30.3%`：

```
30% + 1% 
```

我不确定这里发生了什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T23:23:32.310

是的，这是 Stylus 中的一个错误——它将这样的输入视为您添加了左侧部分的百分比，因此它将 30% 的 1% 添加到 30%。

您可以在此处使用如下解决方法：

```
column-span(n)
  (column-width * n) + unit(column-gap * (n - 1),"") 
```

您在这里所做的事情是从表达式的第二部分中删除单位，因此它会将其视为`30% + 1`，在这种情况下，Stylus 会为您提供适当的`31%`.

# excel - 使用 SSIS 在 Excel 中删除单个工作表

> ID：13976084
> 
> 赞同：0
> 
> 时间：2012-12-20T16:07:50.757
> 
> 标签：excel, ssis

由于一些并发问题，我被迫创建一个包含多个工作表的工作簿。在执行结束时，有些工作表会有数据，而有些则没有。我使用执行 SQL 任务创建工作表。

我正在尝试遍历工作簿并删除不超过一行的工作表。换句话说，如果行数不大于 1，则删除工作表。对此问题的任何指针将不胜感激。如果您需要有关我的问题的更多详细信息，请告诉我。先感谢您。

**编辑**

以下是我从 MSDN 获得的脚本任务。我将其修改为可以访问 excel 工作表并计算行数，现在我要做的就是当 count = 1 时删除工作表。有人可以在这里帮助我吗？

```
using System;
using System.Data;
using Microsoft.SqlServer.Dts.Runtime;
using System.Windows.Forms;
using System.Data.OleDb;
using System.IO;

namespace ST_c346c80b4e6747688383c47a9f3e6f78.csproj
{
    [System.AddIn.AddIn("ScriptMain", Version = "1.0", Publisher = "", Description = "")]
    public partial class ScriptMain : Microsoft.SqlServer.Dts.Tasks.ScriptTask.VSTARTScriptObjectModelBase
    {

        #region VSTA generated code
        enum ScriptResults
        {
            Success = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Success,
            Failure = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Failure
        };
        #endregion

            public void Main()
        {
            string count = "";
            string fileToTest;
            string tableToTest;
            string connectionString;

            fileToTest = Dts.Variables["ExcelFile"].Value.ToString();
            tableToTest = Dts.Variables["ExcelTable"].Value.ToString();

            Dts.Variables["ExcelTableExists"].Value = false;

                connectionString = "Provider=Microsoft.Jet.OLEDB.4.0;" +
                "Data Source=" + fileToTest + ";Extended Properties=Excel 8.0";
                string SQL = "SELECT COUNT (*) FROM [" + tableToTest + "$]";
                using (OleDbConnection conn = new OleDbConnection(connectionString))
                {
                    conn.Open();
                    using (OleDbCommand cmd = new OleDbCommand(SQL, conn))
                    {
                        using (OleDbDataReader reader = cmd.ExecuteReader())
                        {
                            reader.Read();
                            count = reader[0].ToString();
                            //if (count = 1)

                        }
                    }
                    conn.Close();
                }
                //return count;
            }

       }
} 
```

**编辑**

在进一步调查中，我发现我需要添加 excel 互操作程序集才能使其正常工作。我没有那个选项，因为这个解决方案将被移植到 140 台不同的机器上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T12:54:40.217

遗憾的是，您无法使用 OLEDB 删除 Excel 中的工作表，您能做的最好的事情就是使用 DROP Table 命令清除它的数据

```
connectionString = "Provider=Microsoft.Jet.OLEDB.4.0;" +
                     "Data Source=" + fileToTest + 
                     ";Mode=ReadWrite;Extended Properties=Excel 8.0";

string SQL = "SELECT COUNT(*) FROM [" + tableToTest + "$]";

using (OleDbConnection conn = new OleDbConnection(connectionString))
{
    conn.Open();
    using (OleDbCommand CountCmd = new OleDbCommand(SQL, conn))
    {
        int RecordCount = (int)CountCmd.ExecuteScalar();

        if (RecordCount == 1)
        {
            SQL = "DROP TABLE [" + tableToTest + "$]";
            using (OleDbCommand DropCmd = new OleDbCommand(SQL, conn))
            {
                DropCmd.ExecuteNonQuery();
            }
        }
    }
    conn.Close();
} 
```

注意：使用`Mode=ReadWrite`. 您可以包括/排除，但如果您想要对工作簿进行读/写访问，则`HDR=Yes/No`不得包括`IMEX=1`

顺便说一句：不需要使用 OleDbDataReader 来读取单个标量结果，而是使用 ExecuteScalar() 。

使用 OleDB 解决此问题的唯一方法是将要保留的数据复制到新的 excel 文件中并替换原始文件。但是，如果您这样做，您将丢失任何公式或格式。

# c# - c#从form2在form1上运行函数

> ID：13976085
> 
> 赞同：-3
> 
> 时间：2012-12-20T16:07:58.117
> 
> 标签：c#, .net, winforms, forms, function

这个问题可能已经回答了，我可能在 google 中输入了错误的问题，但我想运行`time_refresh`form1 上的函数，并且在 form2 上运行良好。这是我到目前为止得到的：

**表格1**

```
public void time_refresh()
    {
        run_stop.Text = Properties.Settings.Default.s_update + " " + Properties.Settings.Default.s_update_int;
        run_stop.ForeColor = Color.Green;
    } 
```

**表格2**

```
private Main_form_1 form1 = null; 
```

和

```
form1.time_refresh(); 
```

但它得到一个错误

> 你调用的对象是空的。对 c# 来说有点新，所以任何帮助都会非常好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T16:11:19.917

你得到那个错误是因为你没有赋值`form1`。

例如，您可以在以下位置创建属性`form2`：

```
public Main_form_1 Form1 { get { return form1; } set { form1 = value; } } 
```

`form1`并从`form2`初始化分配它：

```
// code from some form1 method
var form2 = new form2();
form2.Form1 = this;
form2.Show(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T16:11:30.333

您应该初始化`form1`Form2 中的变量。
照原样，它是 Main_form_1 类型的变量，具有空值（意味着它没有分配给 Main_form_1 的任何有效实例）

最明显的方法是在`Main_form_1`创建 Form2 的实例时传递当前的实例。
例如，在当前`Main_form_1`您创建 Form2 的实例。
此时你传递了当前 Main_form_1 的引用

```
 Form2 f = new Form2(this); 
```

并在 Form2 的构造函数中

```
public Form2(Main_form_1 f)
{
   form1 = f;
} 
```

现在您的 Form2 实例对运行有正确的引用，并且可以在 Main_form_1 的正确实例上`Main_form_1`调用该方法`time_refresh()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T16:21:02.053

解决这个问题的正确方法是通过事件。 `Form2`不应该`Form1`直接访问，它应该只是通知`Form1`它需要通过事件更新自己。

在`Form2`创建一些事件时：

```
public Action event Refresh; //TODO rename as appropriate 
```

然后，只要您想知道它需要刷新自己，就`Form2`可以触发该事件：`Form1`

```
public void OnRefresh()  //call this method to fire the event
{
    if(Refresh != null)
        Refresh();
} 
```

然后`Form1`你可以附加一个事件处理程序：

```
Form2 other = new Form2();
other.Refresh += () => time_refresh();
other.Show(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T16:13:24.267

您可能希望在表单 2 的构造函数中设置使用的 form1 实例

```
private Form1 _currentForm1;
Public Form2(Form1 currentForm1)
{
    _currentForm1 = currentForm1;
} 
```

并在您的 Form1 中（例如在构造函数中）

```
private Form1 _thisForm1;
public Form1()
{
    _thisForm1 = this;
}

//in your method simply say
Form2 form2 = new Form2(_thisForm1) 
```

这将允许您在表单 2 代码中使用来自 form1 的公共方法。虽然没有实例化新 form1 的问题，因为它不会是向用户显示的表单。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-12-20T16:09:38.757

您必须实例化 Form1 的新实例。尝试像这样声明它：

`private Main_form_1 form1 = new Main_form_1();`

然后你可以打电话`form1.time_refresh();`

此外，您可以做的是让您的 Form2 需要 Form1 的实例。

```
public Main_form_1 _form1; // global variable
public Form2(Main_form_1 form1)
{
     _form1 = form1;
} 
```

从那里你可以调用函数，它应该会影响你的原始表单。

# javascript - 通过ajax发送_method参数

> ID：13976087
> 
> 赞同：0
> 
> 时间：2012-12-20T16:08:04.863
> 
> 标签：javascript, ajax, rest, post, serialization

我有一个需要序列化的 ajax 表单。我还需要手动设置数据表单的_method。这是我目前的实现。

```
 $.ajax({
            url: http://someposturl.com/object,
            type: 'POST',
            data: {
                _method: method
            },
            data: $('form').serialize(),
            success: function(json) {
               alert("YAY");
            },
            error: function(json){
               alert("BOO!"):
            }
        }); 
```

不幸的是，正如我在上面所做的那样，数据变量被覆盖了。

我将如何编写它以使数据同时包含 _method 和序列化形式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T16:27:35.827

试试这个：

```
var data = $('form').serialize() + "&_method=" + method;  

$.ajax({
        url: http://someposturl.com/object,
        type: 'POST',
        data: data,
        success: function(json) {
           alert("YAY");
        },
        error: function(json){
           alert("BOO!"):
        }
    }); 
```

# ios - iOS 上 OpenGL ES 2.0 中的浮点纹理，无需将它们限制为 [0, 1]

> ID：13976091
> 
> 赞同：7
> 
> 时间：2012-12-20T16:08:14.047
> 
> 标签：ios, opengl-es, ios6, opengl-es-2.0, glsl

我需要 gl_FragColor 来“绘制”浮点值，它也可以是负数 (x < 0) 和 > 1.0。然后我想使用 FBO 的颜色附件这个值渲染到并将其用作另一个 FBO 中的纹理。现在我在[http://www.khronos.org/opengles/sdk/docs/man/](http://www.khronos.org/opengles/sdk/docs/man/)（在 glTexImage2D 下）上读到所有值都被限制在 [0, 1] 的范围内，而且我没有找到 glClampColor操作说明。是否有可能在这里找到解决方法，或者有人有什么想法可以帮助我解决我的问题？:)

**解决了**

当使用浮点纹理时，这是可能的，并且值根本不会被限制为 [0, 1]，但它只能使用 GL_HALF_FLOAT_OES 作为纹理的内部格式。使用 GL_FLOAT 会导致帧缓冲区对象不完整，这真的很可悲，因为我正在构建一个总面积表 (SAT) 并在这里遇到了一个很大的精度问题。所以一般来说，iPad2 似乎只支持半精度（2 个字节，1 个符号位 + 5 个指数位 + 10 个小数）浮点数。

FBO的颜色附件纹理的工作创建

```
glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, w, h, 0, GL_RGBA, GL_HALF_FLOAT_OES, NULL); 
```

还要提一件事：仪器将报告“参数'类型'的无效枚举”消息，但无论如何它确实有效。此外，模拟器将使用全精度纹理而不是指定的半精度（我认为因为 C 中没有这样的数据类型）。这就是为什么你可能会在模拟器上得到更少的精度问题。

但最令人困惑的是打印glGetString(GL_EXTENSIONS)时支持“GL_OES_texture_float”。但是，如前所述，它不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T18:52:18.200

我不相信这对于浮动纹理是正确的。检查扩展文档：

[http://www.khronos.org/registry/gles/extensions/OES/OES_texture_float.txt](http://www.khronos.org/registry/gles/extensions/OES/OES_texture_float.txt)

它提到：

“选择的组按照 3.6.2 节中的描述进行处理，在最终扩展为 RGBA 后停止。如果纹理的内部格式是定点的，则将组件限制为 [0,1]。否则，不会修改值。 "

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T09:35:31.617

浮动纹理的全部内容是在着色器中支持 aprox [+inf,-inf]。您可以在这里找到更多有用的信息：[在 iOS 下渲染到浮点纹理](https://stackoverflow.com/questions/3850569/render-to-floating-point-texture-under-ios)

# image - 用于去模糊的 Matlab 维纳滤波器

> ID：13976092
> 
> 赞同：1
> 
> 时间：2012-12-20T16:08:15.697
> 
> 标签：image, matlab, motion-blur

我正在使用维纳滤镜对图像进行去模糊处理。

[http://www.mathworks.it/it/help/images/ref/deconvwnr.html](http://www.mathworks.it/it/help/images/ref/deconvwnr.html)

重要的片段在这里：

```
estimated_nsr = noise_var / var(I(:));
wnr3 = deconvwnr(blurred_noisy, PSF, estimated_nsr); 
```

问题是 deconwnr 需要使用原始图像 I 计算的 NSR 估计值。
**但**我没有原始图像，我只有`blurred_noisy`图像。

我应该将什么值作为 estmated_nsr 传递？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:53:12.400

如果 NSR 是噪声信号比，那么您是否不必猜测原始图像的噪声程度？因此，您可以使用 NSR=0 并假设原始图像上没有噪点。

# c# - WPF：动画 - 从动画背后的代码访问按钮背景画笔

> ID：13976094
> 
> 赞同：1
> 
> 时间：2012-12-20T16:08:24.150
> 
> 标签：c#, .net, wpf, animation, background

我试图在单击按钮时为按钮的背景颜色设置动画。

我遇到了一个问题，实际上是抓住了定义按钮背景的画笔，以便我可以对其进行动画处理。它是一个线性渐变画笔。

我遇到的问题是我无法找到一种实际动画颜色的方法。当情节提要开始时，它会抛出一个错误，告诉我“无法在不可变对象实例上设置动画 '(0)'”。

除此之外，我相信我没有正确执行此操作。最终结果是将背景从当前颜色设置为红色，然后再返回，直到满足某些条件。

总体问题是……我的方法正确吗？有没有更好的方法来为按钮的背景颜色设置动画？

```
private void RoundedButton_Click(object sender, RoutedEventArgs e)
{
    //THIS OBVIOUSLY WON'T WORK BUT GIVES AN IDEA OF WHAT I'M TRYING TO ACCOMPLISH
    LinearGradientBrush recBrush =   ((SharedLibrary.Wpf.Controls.RoundedButton)sender).Background as LinearGradientBrush;

    ColorAnimation pulserAnimation = new ColorAnimation(Colors.Red, new Duration(new TimeSpan(0, 0, 1)));
    pulserAnimation.AutoReverse = true;
    pulserAnimation.RepeatBehavior = RepeatBehavior.Forever;

    Storyboard.SetTarget(pulserAnimation, recBrush);
    Storyboard.SetTargetProperty(pulserAnimation, new    PropertyPath(SolidColorBrush.ColorProperty));

    Storyboard sb = new Storyboard();

    //Add the animations to the new Storyboard
    sb.Children.Add(pulserAnimation);

    //run the animation
    sb.Begin();
} 
```

# php - 如何在我的网站中形成动态导航

> ID：13976095
> 
> 赞同：0
> 
> 时间：2012-12-20T16:08:29.090
> 
> 标签：php, dynamic, foreach, navigation

我有很多用户可以在我的网站中使用的路线，例如，如果他们是一个特定的用户，与另一位用户相比，他们会获得不同的导航。

根据用户所在的部门，我创建了一个 switch 语句来捕获这些 id 并构建它们独特的导航标题：

```
switch($sector_id){
    /*chefs
    case 'f8721714d845eaa5222dcdb4dd642ceb29a280bc':
        $key_array= array('menus','news','staff','directory');
        $url_array = array('/dashboard/menus/','/dashboard/news2/','/dashboard/staff2/','/dashboard/directory2/');
        $name_array = array('Menus2','News2','Staff2','Directory2');'Recipe Stories', 'Blog', 'Events');
        break;*/
    //restaurants, pubs
    case 'c835ff2d2838b3ea45bdb729c641b73b4fa0098d':
    case '378ee5253530d7d02cea3012966deab24bcc5da2':
        $key_array= array('menus','news','staff','directory');
        $url_array = array('/dashboard/menus/','/dashboard/news/','/dashboard/staff/','/dashboard/directory/');
        $name_array = array('Menus','News','Staff','Directory');
        break; 
```

因此，例如，这是我已经拥有的（硬编码）：

```
array(  'key'   =>  'profile',
        'url'   =>  '/dashboard/profile/',
        'name'  =>  'Profile'),
array(  'key'   =>  'picture',
        'url'   =>  '/dashboard/picture/',
        'name'  =>  'Profile Picture'),
array(  'key'   =>  'cv',
        'url'   =>  '/dashboard/cv/',
        'name'  =>  'CV'). 
```

如何动态构造上面的数组？我可以为每个语句使用一个，但它们必须嵌套对吗？任何帮助，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T20:12:42.187

您是否考虑过为每种用户类型创建静态导航 html 并仅包含基于用户类型的文件？如果您不想在动态导航上“全力以赴”，这对您来说可能会更容易。无论如何，你的硬编码你的导航......

或者

如果您想真正动态化，请将所有导航项存储在一个表中（id、key、url、名称），并为用户类型和导航项创建一个连接表。

加入表列：（用户类型，navigation_id）

连接表 SQL（未测试）

```
SELECT * FROM usertype_navigation un JOIN navigation_items ni on un.navigation_id = ni.id WHERE un.usertype = "c835ff2d2838b3ea45bdb729c641b73b4fa0098d" 
```

这将返回所有导航项，遍历每条记录并输出导航项的 html。

# javascript - 使用 Prototype 或纯 JavaScript 获取表单中的所有单选按钮？

> ID：13976097
> 
> 赞同：4
> 
> 时间：2012-12-20T16:08:33.277
> 
> 标签：javascript, prototypejs

我有一个简单的表单，其中包含许多单选按钮。其中一些被选中，一些未被选中。有没有办法将它们全部获取并将它们设置为未选中。我想设置为不检查可以这样完成：

```
button.checked = false; 
```

问题是，我如何获得所有按钮？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T20:44:16.777

您的问题被标记为[javascript](/questions/tagged/javascript "显示标记为“javascript”的问题")和[prototypejs](/questions/tagged/prototypejs "显示标记为“prototypejs”的问题")。如果您想要更多来自 PrototypeJS 的语法糖，那么答案可能看起来像

```
$$('input[type="radio"]:checked').invoke('setValue', false); 
```

从翻译`Prototype`成英文听起来像`invoke setValue(false) operation on all checked radio buttons`。

要以一种形式搜索，您可以使用类似的结构

```
$('yourFormId').select('input[type="radio"]:checked').invoke('setValue', false); 
```

如果您想要普通的旧 IE6 兼容 JavaScript，那么答案将是

```
var inputs = document.getElementsByTagName('input');
for (var i = 0, len = inputs.length; i < len; ++i) {
  if (inputs[i].type === "radio") {
    inputs[i].checked = false;
  }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-20T16:14:36.000

```
$$('input[type="radio"]:checked').each(function(c){
    $(c).checked = false;
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-20T16:11:10.040

```
document.querySelectorAll( 'input[type="radio"]' ); 
```

`<input>`这将返回一个包含所有radio 类型元素的NodeList 。然后，您可以遍历列表并更改`checked`所有属性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-20T16:12:11.567

你觉得......怎么样：

```
var inputs = document.getElementsByTagName("input");

for(var i = 0; i < inputs.length; i++) {
    if(inputs[i].type == "radio") {
        inputs[i].checked = false;
    }
} 
```

请注意，某些较旧的 IE 不支持 getElementsByTagName ...

# ajax - googlebot 抓取网络服务

> ID：13976099
> 
> 赞同：0
> 
> 时间：2012-12-20T16:08:34.967
> 
> 标签：ajax, web-services, googlebot

有什么方法可以让 googlebot 不抓取用于网络服务的链接？当我尝试在 url 上访问我的 web 服务时，如果没有传递参数，它会返回 500 错误。或者当我尝试在没有参数的情况下访问我的 url 中的 web 服务时，是否还有一些方法可以防止 http 500 错误？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:10:51.273

您可以查看[此处](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=156449)以创建 robots.txt。

# command-line-interface - imagemagick 裁剪错误选项需要一个参数 -crop

> ID：13976104
> 
> 赞同：2
> 
> 时间：2012-12-20T16:08:52.887
> 
> 标签：command-line-interface, crop, imagemagick-convert

我想批量裁剪图像，所以我想我使用 imagemagick 但是当我在命令行上运行这个命令时：

```
convert src.jpg -gravity center -crop '290×310+50+50' src_c.jpg 
```

这是错误信息：

```
convert: option requires an argument `-crop' @ error/convert.c/ConvertImageCommand/1087. 
```

这里有什么问题。

**我在 ubuntu 11.04 上，我正在使用 imagemagick 6.6.2**

任何帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T16:19:04.617

根据我的实验，您的 x in`290×310+50+50`实际上不是 x（字母 X，而不是乘法符号）。将其更改为 x（如信中所示），它对我有用

# php - 多次出现的正则表达式 PHP 拉丁符号

> ID：13976110
> 
> 赞同：-1
> 
> 时间：2012-12-20T16:09:05.223
> 
> 标签：php, regex

在 Javascript 中，我将所有出现的字母 'ą' 替换为 ' **aaa** '。

```
 json=json.replace(/\ą/g,'**aaa**'); 
```

现在我想在 PHP 中倒退，将所有 ' **aaa** ' 更改为 'ą'。

例如：

```
**aaa**baba**aaa**  for 'ąbabaą'; 
```

这可能很容易，但我不擅长 PHP。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T16:10:59.057

只需使用[`str_replace()`](http://php.net/str_replace)，如下所示：

```
$string = str_replace( '**aaa**', 'ą', $string); 
```

如果您需要单词边界，则需要一个正则表达式，如下所示：

```
$string = preg_replace( '/\b**aaa**\b/', 'ą', $string); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T16:13:19.337

```
$original = "**aaa**baba**aaa**";
$result = str_replace("**aaa**", "ą", $original); 
```

请注意，PHP 的网站具有出色的搜索功能；在这种情况下，我键入“ [http://php.net/replace](http://php.net/replace) ”来获取与“replace”相关的条目列表，第一个链接是针对上述函数的。

# javascript - 如何在javascript中使用正则表达式仅获取数字

> ID：13976116
> 
> 赞同：3
> 
> 时间：2012-12-20T16:09:16.340
> 
> 标签：javascript, regex

我正在尝试获取可以具有如下 id 的控件的行（由 asp.net webform 生成）。

```
id="contentMain__lvTSEntry__tbxMinute_1" 
```

我想看看我是否可以只捕获数字，所以我使用下面的 javascript。

```
if (e.id.indexOf("_tbxMinute") != -1) {                        
    if (parseInt(e.value) > 59) {
       var cid = e.id;
       var patt = '\d+'
       var test = cid.match(patt)
       alert(test)
      } 
```

到目前为止，我得到了**null**。如何从控件 ID 中获取数字？

感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:13:37.467

如果您将模式字符串从更改`var patt = '\d+'`为`var patt = '\\d+'`它应该可以工作（我在 jsfiddle 的尝试做到了）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T16:11:44.070

你可以使用这样的东西：

```
/contentMain__lvTSEntry__tbxHour_(\d+)/ 
```

它捕获数字：

```
> var regex = /contentMain__lvTSEntry__tbxHour_(\d+)/;
> regex.exec("contentMain__lvTSEntry__tbxHour_1")[1]
"1" 
```

或者，您可以只使用`/(\d+)/`整个正则表达式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T16:17:04.997

您可以使用此代码删除任何非数字字符

```
"contentMain__lvTSEntry__tbxHour_1".replace(/\D/g,'') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T16:17:38.177

您可以使用此函数，它返回数组中的所有数字：

```
function returnNumbers(string){
    return string.match(/\d+/g);
} 
```

例子：

```
> returnNumbers('123asd123')
["123", "123"]

> returnNumbers('contentMain__lvTSEntry__tbxMinute_1')
["1"] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-20T16:23:17.630

如果您`patt`用作正则表达式，则应将其声明为`RegExp`类型：

`var patt = /\d+/;`

`patt instanceof RegExp; // true`

`var patt = '\d+'`意味着 patt is `d+`, because`\d`被翻译为`d`as`\`是一个转义字符。然后，`match`将接收`d+`而不是`\d+`作为参数。

# ruby-on-rails - 控制器中的名称错误

> ID：13976119
> 
> 赞同：0
> 
> 时间：2012-12-20T16:09:24.220
> 
> 标签：ruby-on-rails, ruby, xml

尝试运行我编写的代码时出现错误。它是制作 xml 文件的代码，它从数据库中读取以获取所有信息。该错误是由两行引起的，Document.new 和 Element.new

如果我注释掉这两行，那么代码就可以正常工作。我不确定为什么要这样做，因为这些类应该可以正常工作。

我的代码如下：

```
def create_google_file  
  @products = Product.find(:all)
  file = File.new('dir.xml','w')
  doc = Document.new

  root = Element.new "rss"
  root.add_attribute("xmlns:g", "http://base.google.com/ns/1.0")
  root.add_attribute("version", "2.0")

  channel = Element.new "channel"
  root.add_element channel

  title = Element.new "title"
  title.text = "Sample Google Base"
  channel.add_element title

  link = Element.new "link"
  link.text = "http://base.google.com/base/"
  channel.add_element link

  description = Element.new "description"
  description.text = "Information about products"
  channel.add_element description

  @products.each do |y|
    item = channel.add_element("item")

    id = item.add_element("g:id")
    id.text = y.id

    title = item.add_element("title")
    title.text = y.title

    description = item.add_element("description")
    description.text = y.description

    googlecategory = item.add_element("g:google_product_category")
    googlecategory.text = y.googlecategory

    producttype = item.add_element("g:product_type")
    producttype.text = y.producttype

    link = item.add_element("link")
    link.text = y.link

    imglink = item.add_element("g:image_link")
    imglink.text = y.imglink

    condition = item.add_element("condition")
    condition.text = y.condition

    availability = item.add_element("g:availability")
    availability.text = y.availability

    price = item.add_element("g:price")
    price.text = y.price "USD"

    gtin = item.add_element("g:gtin")
    gtin.text = y.gtin

    brand = item.add_element("g:brand")
    brand.text = y.brand

    mpn = item.add_element("g:mpn")
    mpn.text = y.mpn

    expirationdate = item.add_element("g:expiration_date")
    expirationdate.text = y.salepricedate
  end   

  doc.add_element root

  file.puts doc
  file.close
  end 
```

我得到的错误是：ProductsController#create_google_file 中的 NameError

未初始化的常量 ProductsController::Element

和

ProductsController#create_google_file 中的名称错误

未初始化的常量 ProductsController::Document

# android - 无法在未调用 Looper.prepare() 的线程内创建处理程序

> ID：13976121
> 
> 赞同：0
> 
> 时间：2012-12-20T16:09:31.860
> 
> 标签：android, exception, shared-libraries

我有一个从库项目创建和调用方法的方法。library 方法从资源加载数据。我在工作线程上执行此操作，并且在执行此操作时从不触摸 UI。进行调用的方法（在工作线程上）是：

```
private void testGetXData(){

try {

    Data data = new Data();
    String xsd = data.getXSD();
    importedData = xsd;

} catch (Exception e) {
    System.out.println(e.getMessage(););
}

} 
```

异常发生在线：

```
Data data = new Data(); 
```

`Data`是我图书馆项目中的一个类。并且`importedData`是模块级字符串。

**编辑**

我没有直接使用处理程序。我要做的就是调用该方法：

```
new Thread(new Runnable() {
    public void run() {
        testGetXData();
    }
}).start(); 
```

我这样做是为了不阻塞 UI 线程并获得可怕的 ANR 消息。为了完整起见，我将资源移至图书馆以与服务共享。当资源在应用程序项目中时，这工作正常。自从我将其移至库项目后，它现在才抛出此异常。

**此外**

如果我注释掉工作线程的使用并在主线程上执行调用，它就可以工作！但是，我想在仍然抛出异常的后台线程上执行此操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T16:45:35.087

如果你说`new Handler()`没有指定 a`Looper`它会尝试获取`Looper`当前线程的。常规工作线程没有循环器。

确定`Looper`哪个线程处理`Message`s / 执行`Runnable`s

要么做

```
new Handler(Looper.getMainLooper()); 
```

如果您想在 UI 线程上处理消息或创建一个可以处理消息的额外线程。`HandlerThread`例如，请参阅此处的[Android ANRs from code running in a Handler?](https://stackoverflow.com/questions/13368762/android-anrs-from-code-running-in-a-handler/13369215#13369215)

请注意，您的工作线程中不能有一个内部线程，因为循环器通过等待新消息处理来`Looper`占用该方法。`run`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T16:31:01.903

我猜该消息试图获取当前线程的处理程序并失败。为了能够在线程上创建处理程序，它需要一个 Looper，而默认的“线程”实现没有。

扩展[HandlerThread](http://developer.android.com/reference/android/os/HandlerThread.html)而不是 Thread 应该可以解决问题。

# csv - BizTalk 平面文件架构 - 即使收到空白平面文件也生成 XML 文件

> ID：13976122
> 
> 赞同：3
> 
> 时间：2012-12-20T16:09:33.867
> 
> 标签：csv, biztalk, flat-file

我正在使用 BizTalk 平面文件架构来处理 CSV 文件。我的架构基本上如下所示：

```
<?xml version="1.0" encoding="utf-16"?>
<xs:schema xmlns="http://My.Namespace.For.Schema" xmlns:b="http://schemas.microsoft.com/BizTalk/2003" targetNamespace="http://My.Namespace.For.Schema" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:annotation>
    <xs:appinfo>
      <schemaEditorExtension:schemaInfo namespaceAlias="b" extensionClass="Microsoft.BizTalk.FlatFileExtension.FlatFileExtension" standardName="Flat File" xmlns:schemaEditorExtension="http://schemas.microsoft.com/BizTalk/2003/SchemaEditorExtensions" />
      <b:schemaInfo standard="Flat File" codepage="65001" default_pad_char=" " pad_char_type="char" count_positions_by_byte="false" parser_optimization="speed" lookahead_depth="3" suppress_empty_nodes="false" generate_empty_nodes="true" allow_early_termination="false" early_terminate_optional_fields="false" allow_message_breakup_of_infix_root="false" compile_parse_tables="false" root_reference="MyFile" />
    </xs:appinfo>
  </xs:annotation>
  <xs:element name="MyFile">
    <xs:annotation>
      <xs:appinfo>
        <b:recordInfo structure="delimited" child_delimiter_type="hex" child_delimiter="0x0D 0x0A" child_order="postfix" sequence_number="1" preserve_delimiter_for_empty_data="true" suppress_trailing_delimiters="false" rootTypeName="MyFile" />
      </xs:appinfo>
    </xs:annotation>
    <xs:complexType>
      <xs:sequence>
        <xs:annotation>
          <xs:appinfo>
            <groupInfo sequence_number="0" xmlns="http://schemas.microsoft.com/BizTalk/2003" />
          </xs:appinfo>
        </xs:annotation>
        <xs:element maxOccurs="unbounded" name="MasEdiAuditRecord">
          <xs:annotation>
            <xs:appinfo>
              <b:recordInfo structure="delimited" child_delimiter_type="char" child_delimiter="," child_order="infix" sequence_number="1" preserve_delimiter_for_empty_data="true" suppress_trailing_delimiters="false" />
            </xs:appinfo>
          </xs:annotation>
          <xs:complexType>
            <xs:sequence>
              <xs:annotation>
                <xs:appinfo>
                  <groupInfo sequence_number="0" xmlns="http://schemas.microsoft.com/BizTalk/2003" />
                </xs:appinfo>
              </xs:annotation>
              <xs:element name="SomeField" type="xs:string">
                <xs:annotation>
                  <xs:appinfo>
                    <b:fieldInfo justification="left" sequence_number="1" wrap_char_type="char" wrap_char="&quot;" />
                  </xs:appinfo>
                </xs:annotation>
              </xs:element>
              <xs:element name="SomeOtherField" type="xs:string">
                <xs:annotation>
                  <xs:appinfo>
                    <b:fieldInfo justification="left" sequence_number="2" wrap_char_type="char" wrap_char="&quot;" />
                  </xs:appinfo>
                </xs:annotation>
              </xs:element>
              <!-- And a whole bunch more fields -->
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

当文件实际上包含 CSV 记录时，这可以正常工作。但是，我有时会收到空白文件，我仍需要对这些文件进行解析（并最终启动编排。因此，我希望空白 CSV 文件生成如下内容：

```
<ns0:MyFile xmlns:ns0="http://My.Namespace.For.Schema">
</ns0:MyFile> 
```

但据我所知，当接收端口得到一个空白文件时，接收管道启动，然后下游没有其他事情发生。我认为这是因为平面文件架构正在生成一条空消息，然后 BizTalk 将在该点停止。

收到空白文件时，如何使平面文件架构仍然生成没有子记录的 XML 记录？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T21:56:26.320

您也许可以编写一个自定义管道组件来处理这种情况：一个检查入站消息的组件，如果为空，则创建某种类型的消息，其中只有空格。那可能行得通。

[这里](http://geekswithblogs.net/synboogaloo/archive/2005/04/27/38500.aspx)有一个创建自定义管道组件的好例子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T15:39:52.240

我最终做的是更改流程，以便在接收管道中不会删除标头记录。因此，永远不会有“空白”消息，只是只包含标头记录的消息。然后，我过滤掉启动编排的映射中的标头记录，使用[过滤记录使用 Maps 和条件循环](http://geekswithblogs.net/benny/archive/2006/02/04/68178.aspx)。

# oracle - 避免：精确提取在 PL/SQL 中返回超过请求的行数错误

> ID：13976123
> 
> 赞同：1
> 
> 时间：2012-12-20T16:09:35.547
> 
> 标签：oracle, plsql

我是plsql的新手。

我收到错误

```
ORA-01422: exact fetch returns more than requested number of rows 
```

问题是有时我需要从具有重复行的游标中进行选择
为了避免这种情况，我尝试添加
rownum=1 或 rownum<2

但这并没有解决问题

```
select work into my_work  
from INFO 
where person_id = in_person_id
and date= (select max(date) from INFO where (person_id = in_person_id and rownum<2     
)); 
```

PS 原bug产生重复行无法修复

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:13:17.907

您`rownum <2`应用于子查询，而不是主查询。它应该是

```
select work into my_work  
from INFO 
where person_id = in_person_id
and date= (select max(date) from INFO where (person_id = in_person_id 
--and rownum<2  
)) 
AND rownum<2  ; 
```

# angularjs - AngularJS Java EE Web 应用的基本示例和最佳实践

> ID：13976129
> 
> 赞同：24
> 
> 时间：2012-12-20T16:09:50.200
> 
> 标签：angularjs

如果有人在 Java EE Web 应用程序中使用过 AngularJS，那么如果您能提供任何指针/示例，我们将不胜感激。

什么是最佳实践，什么是理想的结构、设计等。任何网络链接也会有所帮助。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-24T21:15:38.333

由于这是一个非常笼统的问题，我将照此回答。在 jFall 2012 上有一个演讲，演示了一个非常基本的 Java EE 6 和 AngularJS 应用程序，可以在这里找到：[https ://github.com/teunh/jfall2012](https://github.com/teunh/jfall2012)

我一直在从事一个使用AngularJS作为前端的学校项目——JAX-RS作为restful接口和bean中的基本后端逻辑以及hibernate的数据库持久性。我目前无法开源这个项目，因为它仍在进行中。

我的经验和我给您的信息是，如果您牢记一个宁静的界面，那么使用 AngularJS 前端构建 Java EE 后端非常容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-11-07T18:39:33.203

我只称这是一个有效的问题，因为现在有很多方法可以进行 Web 开发（是的，这句话在一年前也同样有效）。但是，我宁愿尝试回答一些潜在的问题。

根据适用于 Java [6](http://docs.oracle.com/javaee/6/tutorial/doc/bnadr.html)和[7](http://docs.oracle.com/javaee/7/tutorial/doc/webapp.htm)的 Oracle 官方 Java EE 教程，根据定义，“Web 应用程序”是以下两种通用类型之一：

> 面向演示：面向演示的 Web 应用程序生成交互式网页，其中包含各种类型的标记语言（HTML、XHTML、XML 等）和响应请求的动态内容。
> 
> 面向服务：面向服务的 Web 应用程序实现 Web 服务的端点。面向表示的应用程序通常是面向服务的 Web 应用程序的客户端。

AngularJS 是一个前端用户界面框架。根据上面的定义，这意味着 Angular 属于面向表示的类别，它自己没有任何服务器端处理。

至于问题所说的在“Java EE 应用程序中”使用这个。好吧，简单地说，你没有。如果您确实尝试过，您最终会得到一个为您`jsp`的. 这些都没有充分利用技术。`ng-app``ng-app``jsp`

最好的办法是设置一个带有 RESTful API 的面向服务的 Java EE 应用程序，您的面向演示的 AngularJS 应用程序将使用该 API 并将其呈现给最终用户。

对于它的价值，[这个视频教程](https://www.youtube.com/watch?v=kFm45u1koOI)给出了一个很好的清晰概述这样的事情。

# c# - 我一直在使用 SQL 参数而不在 .NET 中使用 Prepare。这很糟糕吗？我为什么要使用它？

> ID：13976136
> 
> 赞同：1
> 
> 时间：2012-12-20T16:10:21.853
> 
> 标签：c#, .net, sql, prepared-statement

> **可能重复：**
> [在 C# 中使用 SqlCommand Prepare 的优缺点？](https://stackoverflow.com/questions/2449827/pros-and-cons-of-using-sqlcommand-prepare-in-c)

这是一个例子。这似乎工作正常，但我只是偶然发现了 Prepare()，我想知道我是否应该使用它。

> con.Open();
> cmd.Connection = con;
> cmd.CommandText = "INSERT INTO tbl ([val], [desc]) 输出 INSERTED.tbl_id 值 (@val, @desc); "; cmd.Parameters.AddWithValue("@val", AccountSession.Current.UserId); cmd.Parameters.AddWithValue("@desc", Desc); retVal.id = cmd.ExecuteScalar().ToString();

# javascript - 为 nodejs 试用 async.js

> ID：13976140
> 
> 赞同：0
> 
> 时间：2012-12-20T16:10:32.650
> 
> 标签：javascript, node.js, async.js

我对以下代码有疑问：

```
var async = require("async");

function sleep(milliseconds) {
    var start = new Date().getTime();
    for (var i = 0; i < 1e7; i++) {
        if ((new Date().getTime() - start) > milliseconds){
            break;
        }
    }
}

function hello(no){
    console.log(no);
    async.forEach(no,function print_list(x, callback){
        console.log("I am task number : ", x);
        var sleep_time = Math.floor((Math.random()*10)+1);
        console.log(sleep_time);
        sleep(sleep_time*1000);
    },function(err){if (err){console.log(err);}});
}

list = [];
for (var a = 1000; a > 0;a--){
    list.push(a);
};
hello(list); 
```

在我看来，我希望每个这段代码都不会相互阻塞，但我发现它仍然被视为同步代码。

我哪里做错了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T16:17:32.510

Node.js 是单线程的，你的睡眠函数正在接管 CPU。

尝试使用 setTimeout 来获得一个更实际的例子来说明它是如何工作的。

```
function hello(no){
    console.log(no);
    async.forEach(no,function print_list(x, callback){
        console.log("I am task number : ", x);
        var sleep_time = Math.floor((Math.random()*10)+1);
        console.log(sleep_time);
        // use setTimeout
        setTimeout( function() {}, sleep_time*1000);
    },function(err){if (err){console.log(err);}});
} 
```

# ruby-on-rails - 通过按钮单击编辑表中的值（Ruby on Rails）

> ID：13976141
> 
> 赞同：0
> 
> 时间：2012-12-20T16:10:33.740
> 
> 标签：ruby-on-rails, button, controller, icons

我有点惭愧，因为现在有两个多小时我不知道该怎么做。但我对 Rails 很陌生，所以请耐心等待:)

我有两组用户：海报和实干家然后有一个模型“作业”。作业由海报创建（与它们有belong_to 关系）。然后，实干者可以从未分配的池中选择分配并将它们分配给自己（这就是为什么分配也与实干者有belong_to关系的原因）。

在页面本身我现在有这个代码（在过去的一个小时里改变了 20 次）：

```
<table class="table">
  <thead>
    <tr>
      <th>Title</th>
      <th>Assign to me</th>
    </tr>
  </thhead>      
  <tbody>
    <% @assignments.each do |assignment| %>
      <tr>
        <td><%= assignment.title %></td>
        <td>
           <%= link_to(edit_assignment_path(assignment), :doer => current_doer.id, confirm: 'Really take this assignment on?') do%>
             <i class="icon-folder-open", alt="assign"></i>
           <% end %> 
        </td>
      </tr>
    <% end %>
  </tbody>
</table> 
```

在 AssignmentController 中使用此代码：

```
def edit
  @assignment = Assignment.find(params[:id])
  @doer = Doer.find(params[:doer])
  if @patient.assign(@doer)
    redirect_to dashboard_index_path, notice: 'Successfully assigned to you'
  else
    redirect_to dashboard_index_path, alert: 'Error while trying to assign to you'
  end
end 
```

这在 Assignment.rb ：

```
def assign(current_doer)
  if self.doer_id != nil then 
    false 
  else 
    self.doer_id << current_doer
    true
  end
end 
```

如您所见，在此示例中我以 Doer 身份登录。而且我一生都无法弄清楚如何正确和干净地做到这一点！

我还尝试了 link_to 代码部分、assign 函数等的变体。目前我收到错误，@doer = Doer.find(params[:doer]) 无法搜索 Nil 的 id。我知道这意味着我并没有真正正确地发送 doer_id 参数，但我处于初学者知识端。

非常感谢你在这里帮助我。

问候， Lordylike

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T17:25:18.010

你几乎是对的，当使用带有块的 link_to 时，它接受参数的方式会发生一些变化。像这样使用路径助手传递您的参数。

```
<%= link_to(edit_assignment_path(assignment, doer: current_doer.id), confirm: 'Really take this assignment on?') do %>
  <i class="icon-folder-open", alt="assign"></i>
<% end %> 
```

# java - Hibernate 在子句中进阶

> ID：13976154
> 
> 赞同：2
> 
> 时间：2012-12-20T16:11:14.100
> 
> 标签：java, hibernate

我需要使用休眠在 DB_TABLE 上执行 SQL 子句查询。in 子句包含成对的值。我在组件映射的帮助下查询 (tid, mid) 对，见下文。

我现在需要另外对另一对示例（tid，组织）执行 in 子句查询。我该怎么做呢？

目标 SQL 查询

```
select * from DB_TABLE where ( c_tid, c_mid ) in ( ('t1', 'm1'), etc. ) 
```

Java查询代码

```
function List<DBTable> getDBTableList( List<TidMidId> tidMidList ) {
  Criterion crit = Restrictions.in( "tidMidId", tidMidList.toArray() );
  // pom is hibernate wrapper
  return pom.getObjects( DBTable.class, crit );
} 
```

休眠映射：

```
<class name="com.DBTable" table="DB_TABLE" >
    <id name="id" type="long" column="K_ID">
        <generator class="sequence">
            <param name="sequence">DB_TABLE$SEQ</param>
        </generator>
    </id>

    <component name="tidMidId" class="com.TidMidId">
        <property name="tid" type="string" column="C_TID"/>
        <property name="mid" type="string" column="C_MID"/>
    </component>
    <property name="organisation" type="string" column="C_ORGANISATION"/>
    <property name="createTimestamp" type="timestamp" column="D_CREATE_TIMESTAMP"/>
    <property name="modTimestamp" type="timestamp" column="D_MOD_TIMESTAMP"/>
</class> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:40:04.287

为什么不使用 HQL？让 Hibernate 处理 SQL：

```
Query q = session.createQuery("FROM com.DBTable x WHERE x.tidMidId.tid = ? AND x.tidMidId.mid = ?");
q.setString(0, "t1");
q.setString(1, "m1");
return (List<com.DBTable>) q.list(); 
```

添加更多参数很简单：

```
q = ".... AND x.organisation = ?");
q.setString(3, "someOrganization"); 
```

# lucene - ElasticSearch 构面计数与总项目不匹配

> ID：13976159
> 
> 赞同：0
> 
> 时间：2012-12-20T16:11:36.370
> 
> 标签：lucene, elasticsearch, nest

我的搜索索引中有 98 个文档。当我在没有过滤器的情况下进行构面搜索时，构面计数与该术语的索引中的项目数不匹配。如果我将构面集设置为等于当前文档数 98，则会返回构面计数以及该术语的正确项目数。下面是用于构面搜索的 json。

不返回正确数量的项目

```
{
  "facets": {
    "brand": {
      "terms": {
        "field": "brand",
        "all_terms": true
      }
    },
    "global": true
  }
} 
```

是否返回正确数量的项目

```
{
  "facets": {
    "brand": {
      "terms": {
        "field": "brand",
        "all_terms": true,
        "size": 98
      }
    },
    "global": true
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T01:21:29.517

这是一个已知的未解决问题。有关详细信息，请参阅问题[#1832 。](https://github.com/elasticsearch/elasticsearch/issues/1832)

# java - 将重复键插入哈希映射

> ID：13976160
> 
> 赞同：0
> 
> 时间：2012-12-20T16:11:37.963
> 
> 标签：java

我已经创建了哈希映射，当我调试它时，我看到我有重复的键。我没有覆盖键中的`hashCode()`& `equals(Object obj)`-`Object1` 我想知道它将如何影响地图搜索的性能？

```
private HashMap<Object1,Object2> map = new HashMap<Object1,Object2>(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T16:16:44.067

在 Map 中不可能有重复的键，您有不同的键“出现”相同（可能基于它们的`toString()`？），因为您没有覆盖`equals()`and `hashCode()`，但实际上键是不同的。

这意味着为了从您的 Map 中获取*所有*值，您需要保留您创建的*每个*键并将其存储在某个地方，这对我来说违背了 Map 的目的。

概括：

覆盖`equals()`and `hashCode()`，然后将您的键/值对放入 Map 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T16:21:12.210

你怎么会有重复的键？你也没有覆盖，所以你`equals()`不能`hashcode()`说“重复的对象”，因为这正是这些方法的目的。您可能调试并看到了不同的值，但对于 JVM，它们不等于基于默认值`Object.equals()`和`Object.hashcode()`（实际上是最接近的超类）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T16:13:07.160

它不会真的给你带来糟糕的表现（更多的是相反），但它会防止你的对象被视为重复。

如果您希望将每个实例视为不同的键，请不要覆盖 equals 和 hashCode 方法。但这意味着您需要完全相同的实例来检索地图中的值。

如果您想使用不同的实例（例如具有相同的 id）检索值，那么您需要覆盖这些方法。

但问题并不是真正的性能问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T17:25:58.180

您不能有**重复的键**，但可以有**重复的值**。可能是您对键和值感到困惑。

# c# - NLog 不使用 ClickOnce 进行记录

> ID：13976161
> 
> 赞同：7
> 
> 时间：2012-12-20T16:11:37.963
> 
> 标签：c#, .net, clickonce, nlog

我正在通过 NLog 在我的应用程序中实现日志记录。这是我的 Nlog.Config：

```
 <?xml version="1.0" encoding="utf-8" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

  <targets async="true">
    <target xsi:type="File"
            name="ExceptionTarget"
            fileName="LOG.txt"
            layout="${date:format=dd MMM yyyy HH-mm-ss} ${uppercase:${level}} ${newline}${message} ${exception::maxInnerExceptionLevel=5:format=ToString}${newline}${stacktrace}${newline}"/>
  </targets>

  <targets async="true">
    <target xsi:type="File"
            name="InfoTarget"
            fileName="LOG.txt"
            layout="${date:format=mm-ss} ${uppercase:${level}} ${newline}${message} ${newline}"/>
  </targets>

  <rules>
    <logger name="*" level="Error" writeTo="ExceptionTarget"/>
    <logger name="*" level="Info" writeTo="InfoTarget"/>
  </rules>
</nlog> 
```

当我使用 ClickOnce 部署应用程序时，没有创建 log.txt 文件。没有发生错误，我的应用程序正常运行，但什么也没发生。

如何解决这个问题呢？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-20T16:14:01.753

ClickOnce 安装程序在安装软件时未部署 NLog.config 文件，因此您的应用程序没有任何日志记录配置。

*解决方案：*

1.  您可以将日志记录配置合并到您的 app.config 文件中。
2.  Nlog.config 必须具有：*构建操作：*内容并*复制到输出目录：*始终复制。

# c++ - 给定矢量和角度的食人魔相机方向

> ID：13976163
> 
> 赞同：4
> 
> 时间：2012-12-20T16:11:42.670
> 
> 标签：c++, 3d, ogre

在 Ogre3d 中，我想设置方向，为相机视图提供一个“法线”向量（作为指向我眼睛前方的箭头）和一个旋转相机的角度（比如倾斜我的头）。我可以用这个技巧让它工作：

```
float angle = 10; /* tilt my head 10 degrees to right */
Vector3 vector(0, 0, 1); /* z axis pointing forward */
Vector3 target = camera->getPosition() + vector;
camera->lookAt(target);
camera->roll(Degree(angle)); 
```

我不确定这是否适用于每个价值，而且看起来很老套。我正在寻找更正确的东西，比如使用四元数和`Ogre::Camera::setOrientation()`.

此示例不起作用：

```
Quaternion orientation(Degree(angle), vector);
camera->setOrientation(orientation); 
```

因为相机旋转`angle`了`vector`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T17:26:11.357

您可以轻松地将矢量和角度转换为代表旋转的四元数。这是众所周知的轴角四元数。我不知道您使用的是哪个 Quaternion 类（Ogre 中可能有一个）。但是，让我给你我写的四元数类的示例代码：

```
 Quaternion Quaternion::CreateFromAxisAngle(Vector3 axis, float angle) {
    float half = angle * 0.5f;
    float s = sin(half);

    Quaternion result;
    result.x = axis.x * s;
    result.y = axis.y * s;
    result.z = axis.z * s;
    result.w = cos(half);
    return result;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-19T16:48:57.497

正如刚刚提到的，这不是如何从旋转矢量和相关角度创建四元数 - 这是相机如何使用四元数/旋转。如果您使用的是类似 fps 的相机，您需要使用 setFixedYawAxis() 函数让相机不围绕 y 轴或您希望它固定的任何轴旋转。然后我不确定你想用什么来实现：

```
Vector3 target = camera->getPosition() + vector;
camera->lookAt(target); 
```

当您通过让相机指向另一个方向来修改相机的方向矢量时。只需在您的相机实例上使用 setFixedYawAxis(true) 即可完成。

# c# - 页面不刷新gridview按钮单击

> ID：13976167
> 
> 赞同：2
> 
> 时间：2012-12-20T16:11:50.727
> 
> 标签：c#, asp.net, button, gridview, refresh

我已经问过一个[关于](https://stackoverflow.com/questions/13839934/button-does-not-submit-on-first-click-but-on-subsequent-click-submits-previous)这个问题的问题，但是当我在我的 Web 应用程序中取得进展时，我再次偶然发现了这个问题，因为那里的答案给了我一个新问题。使用该解决方案时，我遇到的问题是更新按钮没有读取我的 gridview 文本框中的新值，而是读取了旧值。

**代码隐藏**

有了这个它不使用新值：

```
protected void Page_Load(object sender, EventArgs e)
    {
        LoadData();
        if (!Page.IsPostBack)
        {
            DataBinder();
        }
    }

    private void DataBinder()
    {
        Grid30.DataBind();
        Grid31.DataBind();
        Grid32.DataBind();
        Grid33.DataBind();
        Grid34.DataBind();
        Grid35.DataBind();
        Grid36.DataBind();
        Grid37.DataBind();
        Grid38.DataBind();
        Grid40.DataBind();
        Grid41.DataBind();
        Grid42.DataBind();
        Grid43.DataBind();
        Grid44.DataBind();
        Grid45.DataBind();
        Grid51.DataBind();
        Grid52.DataBind();
        Grid53.DataBind();
        Grid54.DataBind();
        Grid55.DataBind();
        Grid56.DataBind();
        Grid57.DataBind();
        Grid58.DataBind();
        Grid61.DataBind();
        Grid62.DataBind();
        Grid63.DataBind();
        Grid64.DataBind();
    } 
```

有了这个，它得到了新的价值，但它不再刷新：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        LoadData();
        DataBinder();

    }

    private void DataBinder()
    {
        if (!Page.IsPostBack)
        {
            Grid30.DataBind();
            Grid31.DataBind();
            Grid32.DataBind();
            Grid33.DataBind();
            Grid34.DataBind();
            Grid35.DataBind();
            Grid36.DataBind();
            Grid37.DataBind();
            Grid38.DataBind();
            Grid40.DataBind();
            Grid41.DataBind();
            Grid42.DataBind();
            Grid43.DataBind();
            Grid44.DataBind();
            Grid45.DataBind();
            Grid51.DataBind();
            Grid52.DataBind();
            Grid53.DataBind();
            Grid54.DataBind();
            Grid55.DataBind();
            Grid56.DataBind();
            Grid57.DataBind();
            Grid58.DataBind();
            Grid61.DataBind();
            Grid62.DataBind();
            Grid63.DataBind();
            Grid64.DataBind();
        }
    } 
```

**更新/加载数据代码**

```
 protected void Grid36_RowUpdating(object sender, GridViewUpdateEventArgs e)
    {

        GridViewRow row = Grid36.Rows[e.RowIndex];

        var txtQuantity = (TextBox)row.FindControl("Spoor36TB");
        int quantity = int.Parse(txtQuantity.Text);

        Grid36.EditIndex = -1;
        DataBinder();
    }

    private void LoadData()
    {
        foreach(Rail rail in getAllPositions())
        {
            DataTable dt = new DataTable();
            dt.Columns.Add(new DataColumn(rail.RailNr.ToString(), typeof(string)));
            for (int i = 0; i < rail.AmountOfPositions; i++)
            {
                DataRow dr = dt.NewRow();
                dr[rail.RailNr.ToString()] = "1";
                dt.Rows.Add(dr);
            }
            DataSources(rail.RailNr, dt);
        }
    } 
```

**编辑** 好吧，我删除了 DataBinder(); 在 Grid36_RowEditing() 下。这不是真正的解决方案，但目前是一个糟糕的解决方法。现在我必须按两次编辑按钮，但至少我能够更新网格。虽然这对我的问题来说不是/一个可怕的解决方案，但我希望有人仍然能够给我一个真正的解决方案

```
 protected void Grid36_RowEditing(object sender, GridViewEditEventArgs e)
    {
        Grid36.EditIndex = e.NewEditIndex;
        //DataBinder();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T05:39:11.177

在行更新方法中，更新数据库中的值，然后执行数据源以及数据绑定方法。

例子 ：-

```
GridViewRow row = (GridViewRow)GridView1.Rows[e.RowIndex];
int id = Int32.Parse(GridView1.DataKeys[e.RowIndex].Value.ToString());
TextBox tname = (TextBox)row.FindControl("nam");
TextBox tques = (TextBox)row.FindControl("que");
MySqlCommand cmd = new MySqlCommand("update exam set name1=@name,ques=@ques where id = @id", con);
cmd.Parameters.Add("@id", MySqlDbType.Int16).Value = id;
cmd.Parameters.Add("@name", MySqlDbType.VarChar, 30).Value = tname.Text.Trim();
cmd.Parameters.Add("@ques", MySqlDbType.VarChar,40).Value = tques.Text.Trim();
con.Open();
cmd.ExecuteNonQuery();
GridView1.EditIndex = -1;
// Bind grid now
 GridView1.DataSource= dt; // get data from database
 GridView1.Databind(); 
```

# asp.net-mvc - 在数据注释中扩展一个类

> ID：13976168
> 
> 赞同：0
> 
> 时间：2012-12-20T16:11:51.427
> 
> 标签：asp.net-mvc

我试图找出是否有办法在 MVC 的 DataAnnotations 中为元数据扩展一个类。

例如：

如果我有一个名为 Vehicle 的模型，其中包含任何汽车共有的所有基本属性，那么我有一个 Truck 模型和一个 Car 模型。两者都是 Vehicle 模型的子类。

现在假设 Vehicle 包含 Engine Size 和 Vehicle Weight 的属性，Truck 包含 Towing Capacity 的属性，Car 包含 Trunk Capacity 的属性。

有没有办法让我只指定一次在车辆中共享的属性的元数据？

我试过类似的东西：

```
[MetadataType(typeof(VehicleMD))]
public partial class Vehicle
{
   public class VehicleMD
   {
       [Display(Name = "Engine Size")]
       public double EngineSize {get;set;}

       [Display(Name = "Vehicle Weight")]
       public double VehicleWeight {get;set;}
    }
 } 
```

但是在使用卡车或汽车模型的视图中，除非我还在卡车和汽车的部分类中指定注释，否则不会应用元数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:15:03.467

不。

由于引擎反映您的类以获取注释的方式，它们需要应用于最子类。

您的另一个选择是将 DataAnnotations 直接应用于相关类，而不是使用单独的元数据类型。

# android - 从 Long 到 String[] 的转换

> ID：13976170
> 
> 赞同：0
> 
> 时间：2012-12-20T16:12:00.800
> 
> 标签：android, sqlite, type-conversion

我收到了这个错误：

```
The method query(String, String[], String, String[], String, String, String) in the type SQLiteDatabase is not applicable for the arguments (String, String[], String, String, null, null, null) 
```

**和负责的代码：**

```
public Cursor getDomanda(String id) {
            List<categorie> categorie = new ArrayList<categorie>();

            Cursor cursor = database.query(MySQLiteHelper.TABLE_SONDAGGI,
                allCategorieColumns, MySQLiteHelper.COLUMN_ID + "=", id, null, null, null);

            cursor.moveToFirst();
            while (!cursor.isAfterLast()) {
              categorie categoria = cursorToCategorie(cursor);
              categorie.add(categoria);
              cursor.moveToNext();
            }
            // Make sure to close the cursor
           // cursor.close();
            return cursor;
          } 
```

**另一方面：**

```
long strcategory = getIntent().getExtras().getLong("categoriaId"); 
Cursor values = datasource.getDomanda(Long.toString(strcategory)); 
```

我做错了什么？我需要将 long 转换为，`String[]`但到底是什么`String[]`？：D 顺便说一句......查询对吗？我的意思是

```
database.query(MySQLiteHelper.TABLE_SONDAGGI,
                    allCategorieColumns, MySQLiteHelper.COLUMN_ID + "=", id, null, null, null); 
```

**是**

```
select from tableSondaggi where _id = $id ? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T16:14:24.187

第 4 个参数必须是 a `String[]`，而不是 a `String`。

您需要替换`id`by`new String[] { id }`以创建一个由一个元素（您的 id）组成的数组。

```
 Cursor cursor = database.query(MySQLiteHelper.TABLE_SONDAGGI,
            allCategorieColumns, MySQLiteHelper.COLUMN_ID + "=", new String[] { id }, null, null, null); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T16:15:27.920

这应该可以解决问题。

```
Cursor cursor = database.query(MySQLiteHelper.TABLE_SONDAGGI,
            allCategorieColumns, MySQLiteHelper.COLUMN_ID + "=",  new String[] { id }, null, null, null); 
```

但是：也许有必要阅读一些有关基本编程的书籍。数组（`String[]`例如）非常有用......

# android - 设置自动链接属性

> ID：13976171
> 
> 赞同：2
> 
> 时间：2012-12-20T16:12:01.373
> 
> 标签：android, android-layout

当我单击需要打开页面的文本视图时，我在数组中有一些 url，但我收到错误我的代码是

```
LinearLayout l = new LinearLayout(this);
    l.setOrientation(LinearLayout.VERTICAL);
    String[] textArray={"www.google.co.in","www.gmail.com","www.facebook.com"};
    int length=textArray.length;
    LinearLayout layout = new LinearLayout(this);
    setContentView(layout);
    layout.setOrientation(LinearLayout.VERTICAL);        
    for(int i=0;i<length;i++)
    {
        TextView tv=new TextView(getApplicationContext());
        tv.setText(textArray[i]);
        layout.addView(tv);
       Linkify.addLinks(tv, Linkify.WEB_URLS);
       tv.setMovementMethod(LinkMovementMethod.getInstance()) 
```

> LogCat 输出

```
12-20 16:08:38.623: E/InputEventReceiver(2170): Exception dispatching input event.
12-20 16:08:38.623: E/MessageQueue-JNI(2170): Exception in MessageQueue callback: handleReceiveCallback
12-20 16:08:38.804: E/MessageQueue-JNI(2170): android.util.AndroidRuntimeException: Calling startActivity() from outside of an Activity  context requires the FLAG_ACTIVITY_NEW_TASK flag. Is this really what you want?
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.app.ContextImpl.startActivity(ContextImpl.java:944)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.app.ContextImpl.startActivity(ContextImpl.java:931)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.content.ContextWrapper.startActivity(ContextWrapper.java:284)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.text.style.URLSpan.onClick(URLSpan.java:62)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.text.method.LinkMovementMethod.onTouchEvent(LinkMovementMethod.java:212)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.widget.TextView.onTouchEvent(TextView.java:7397)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.view.View.dispatchTouchEvent(View.java:7239)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2174)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1917)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2174)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1917)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2174)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1917)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2174)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1917)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:1953)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1405)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.app.Activity.dispatchTouchEvent(Activity.java:2410)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1901)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.view.View.dispatchPointerEvent(View.java:7419)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.view.ViewRootImpl.deliverPointerEvent(ViewRootImpl.java:3220)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.view.ViewRootImpl.deliverInputEvent(ViewRootImpl.java:3165)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.view.ViewRootImpl.doProcessInputEvents(ViewRootImpl.java:4292)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.view.ViewRootImpl.enqueueInputEvent(ViewRootImpl.java:4271)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.view.ViewRootImpl$WindowInputEventReceiver.onInputEvent(ViewRootImpl.java:4363)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.view.InputEventReceiver.dispatchInputEvent(InputEventReceiver.java:179)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.os.MessageQueue.nativePollOnce(Native Method)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.os.MessageQueue.next(MessageQueue.java:125)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.os.Looper.loop(Looper.java:124)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at android.app.ActivityThread.main(ActivityThread.java:5039)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at java.lang.reflect.Method.invokeNative(Native Method)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at java.lang.reflect.Method.invoke(Method.java:511)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
12-20 16:08:38.804: E/MessageQueue-JNI(2170):   at dalvik.system.NativeStart.main(Native Method)
12-20 16:08:38.804: D/AndroidRuntime(2170): Shutting down VM
12-20 16:08:38.813: W/dalvikvm(2170): threadid=1: thread exiting with uncaught exception (group=0x40a70930)
12-20 16:08:38.913: E/AndroidRuntime(2170): FATAL EXCEPTION: main
12-20 16:08:38.913: E/AndroidRuntime(2170): android.util.AndroidRuntimeException: Calling startActivity() from outside of an Activity  context requires the FLAG_ACTIVITY_NEW_TASK flag. Is this really what you want?
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.app.ContextImpl.startActivity(ContextImpl.java:944)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.app.ContextImpl.startActivity(ContextImpl.java:931)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.content.ContextWrapper.startActivity(ContextWrapper.java:284)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.text.style.URLSpan.onClick(URLSpan.java:62)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.text.method.LinkMovementMethod.onTouchEvent(LinkMovementMethod.java:212)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.widget.TextView.onTouchEvent(TextView.java:7397)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.view.View.dispatchTouchEvent(View.java:7239)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2174)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1917)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2174)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1917)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2174)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1917)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2174)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1917)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:1953)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1405)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.app.Activity.dispatchTouchEvent(Activity.java:2410)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1901)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.view.View.dispatchPointerEvent(View.java:7419)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.view.ViewRootImpl.deliverPointerEvent(ViewRootImpl.java:3220)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.view.ViewRootImpl.deliverInputEvent(ViewRootImpl.java:3165)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.view.ViewRootImpl.doProcessInputEvents(ViewRootImpl.java:4292)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.view.ViewRootImpl.enqueueInputEvent(ViewRootImpl.java:4271)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.view.ViewRootImpl$WindowInputEventReceiver.onInputEvent(ViewRootImpl.java:4363)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.view.InputEventReceiver.dispatchInputEvent(InputEventReceiver.java:179)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.os.MessageQueue.nativePollOnce(Native Method)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.os.MessageQueue.next(MessageQueue.java:125)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.os.Looper.loop(Looper.java:124)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at android.app.ActivityThread.main(ActivityThread.java:5039)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at java.lang.reflect.Method.invokeNative(Native Method)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at java.lang.reflect.Method.invoke(Method.java:511)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
12-20 16:08:38.913: E/AndroidRuntime(2170):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-02T17:50:39.977

另外：如果您在片段中显示适配器中的链接，请不要像这样创建它

```
 adapter = new ListAdapter(getActivity().getApplicationContext(),mStrings,dispWidth,dispHeight); 
```

而是打电话

```
 adapter = new ListAdapter(getActivity(),mStrings,dispWidth,dispHeight); 
```

适配器在这两种情况下都可以正常工作，但链接仅在最后一种情况下有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T18:06:19.583

检查 Nammari 的响应，或者是否在 getView() 方法中包含该代码以避免该异常

> “从 Activity 上下文之外调用 startActivity() 需要 FLAG_ACTIVITY_NEW_TASK 标志。这真的是你想要的吗？”

可能你需要：

```
LinearLayout l = new LinearLayout(parent.getContext());
...
...
LinearLayout layout = new LinearLayout(parent.getContext()); 
```

代替

```
LinearLayout l = new LinearLayout(this);
...
...
LinearLayout layout = new LinearLayout(this); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T17:12:02.203

看来您是`Activity`从外部环境开始的`Activity`

在您启动活动的代码中的简单简短答案确保启动它的上下文是一个`Activity`否则确保将 Intent Flag 设置为`Intent.FLAG_ACTIVITY_NEW_TASK`

例子

```
Intent intent = new Intent(mContext, SomeActivity.class);
intent.setFlag(Intent.FLAG_ACTIVITY_NEW_TASK);
..
...
..

mContext.startActivity(intent); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T17:04:18.497

嗨，我想您应该使用 WebView 打开任何链接。您可以从这里通过如何处理 WebView 的简单示例获得一个想法。链接如下：- [WebView 示例](http://www.mkyong.com/android/android-webview-example/)。我希望这对你有很大帮助。

我觉得在您的 Logcat 中，您的问题的解决方案可以通过以下链接来解决：-[您的 Logcat 问题](https://stackoverflow.com/questions/3918517/calling-startactivity-from-outside-of-an-activity-context)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-24T23:14:53.510

更改`LinearLayout l = new LinearLayout(this);`为`LinearLayout l = new LinearLayout(getParent.getApplicationContext());`

# less - .less 变量插值的正确语法是什么？

> ID：13976175
> 
> 赞同：11
> 
> 时间：2012-12-20T16:12:10.387
> 
> 标签：less, dotless

我有一个具有以下结构的 .less 样式表：

```
@width:600;

.some-style
{
    width:@{width}px;
} 
```

这给出了以下错误：

```
Expected '}' on line x in file '..\styles.less' 
```

我需要这些大括号，因为我需要将变量与以下`px`后缀区分开来（`@widthpx`不起作用，因为它会查找名为 的变量`widthpx`）。而且我不能使用空格，因为`600 px`它不是有效的 css。使用括号代替花括号也不起作用。

我在这里做错了什么？

**更新**：我从包管理器安装了最新版本的 .less，现在它工作得更好了，但有一个致命缺陷：

```
 width:@(width)px;  <--note the parentheses 
```

现在编译，但发出这个 CSS：

```
 600 px  <--note the space, which is invalid CSS, thus useless. 
```

**已解决**：ScottS 向我指出了解决方案。除了他的两种方法之外，编译器似乎可以对字符串进行数学运算。所以这有效：

```
@width:600px;

.some-style
{
    width:@width / 2;  <--correctly emits "300px"
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-20T16:31:45.410

因此，如果我理解正确，您想给出`width`a 值但没有任何单位，并在调用时分配单位。我不确定你***为什么***要这样做，但有两种方法可以工作：

**一**：制作`width`一个字符串，然后进行字符串插值：

```
@width: '600';

.some-style
{
    width: ~'@{width}px';
} 
```

**二**：乘以`1px`：

```
@width: 600;

.some-style
{
    width: @width * 1px;
} 
```

对于“无单位”数字的情况以及以后如何添加单位（因为问题最初似乎是这样），我已将上述答案保留在适当的位置。但是，根据您的评论，让我解释一下为什么`@width: 600px`有效。LESS 不会将其视为*字符串*（正如您提到的那样）。相反，它将其视为带有单位的数字。LESS`600px`不是字符串（除非它被引号括起来），而是以.`600`为单位的数字`pixels`。这就是为什么它可以很好地对其进行操作，而您不必担心它。无论这些单位是或任何其他有效的 CSS 单位，它都可以这样`em`做`%`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-28T11:51:54.310

[使用单位](http://lesscss.org/functions/#misc-functions-unit)函数还有更好的方法：

```
@width: 600;

.some-style
{
    width: unit(@width, px);
} 
```

如果你经常这样做，那么你可以定义[mixin](http://lesscss.org/features/#mixins-feature-mixins-as-functions-feature)：

```
.widthInPx(@w)
{
    width: unit(@w, px);
}

.some-style
{
    .widthInPx(@width);
} 
```

# string - 十六进制颜色作为字符串

> ID：13976180
> 
> 赞同：0
> 
> 时间：2012-12-20T16:12:41.410
> 
> 标签：string, hex

从 Photoshop 中的 Javascript 中，是否有解决十六进制数字问题的好方法，其中“e”被转换为其他数字

*   ArialMT，48，重置数据，384E59

将它们放在引号中是可行的，但我也必须为此考虑。数字（和其他数据）被导出到文本文件，然后处理成文本文件，然后导入 Excel。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T16:54:32.333

代码没有问题；这是一个Excel的东西。您需要将分隔文本设置为“文本”而不​​是“一般”，然后 Excel 不会尝试弄乱您的十六进制数字。

# wpf - 覆盖 ScrollViewer ContentTemplate WPF

> ID：13976181
> 
> 赞同：0
> 
> 时间：2012-12-20T16:12:43.687
> 
> 标签：wpf, scrollviewer, documentviewer

我有一个自定义 ScrollViewer 模板，用于自定义 DocumentViewer 控件。

```
<Style TargetType="{x:Type ScrollViewer}"  x:Key="CustomScrollPresenter">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ScrollViewer}">
                    <Grid Background="{TemplateBinding Panel.Background}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Rectangle Grid.Column="1" Grid.Row="1" Fill="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                        <ScrollContentPresenter

                    Grid.Column="0" 
                    Grid.Row="0" 
                    Margin="{TemplateBinding Control.Padding}" 
                    Content="{TemplateBinding ContentControl.Content}" 
                    ContentTemplate="{TemplateBinding ContentControl.ContentTemplate}"
                    CanContentScroll="{TemplateBinding ScrollViewer.CanContentScroll}" />
                        <ScrollBar 
                    x:Name="PART_VerticalScrollBar"
                    Grid.Column="1" 
                           Grid.Row="0" 
                           Minimum="0" 
                           Maximum="{TemplateBinding ScrollViewer.ScrollableHeight}" 
                           ViewportSize="{TemplateBinding ScrollViewer.ViewportHeight}" 
                           Value="{Binding Path=VerticalOffset, Mode=OneWay, RelativeSource={RelativeSource Mode=TemplatedParent}}" 
                           Visibility="{TemplateBinding ScrollViewer.ComputedVerticalScrollBarVisibility}" 
                           Cursor="Arrow" AutomationProperties.AutomationId="VerticalScrollBar" />
                        <ScrollBar 
                    x:Name="PART_HorizontalScrollBar"
                    Orientation="Horizontal" Grid.Column="0" Grid.Row="1" Minimum="0" 
                           Maximum="{TemplateBinding ScrollViewer.ScrollableWidth}" ViewportSize="{TemplateBinding ScrollViewer.ViewportWidth}" Value="{Binding Path=HorizontalOffset, Mode=OneWay, RelativeSource={RelativeSource Mode=TemplatedParent}}" Visibility="{TemplateBinding ScrollViewer.ComputedHorizontalScrollBarVisibility}" Cursor="Arrow" AutomationProperties.AutomationId="HorizontalScrollBar" />

                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

但是如何覆盖 ScrollViewer 的 ContentTemplate 呢？我的意思是，我可以用什么来代替它：

```
ContentTemplate="{TemplateBinding ContentControl.ContentTemplate}" 
```

有一些我可以用来为 ScrollViewer 中的每个项目设置样式的东西吗？例如，在 ScrollViewer 的每个项目下添加一个带有一些页面描述的 TextBlock？

谢谢！

# ios - 在不同的超级视图中检测两个 UIView 对象的交集

> ID：13976186
> 
> 赞同：8
> 
> 时间：2012-12-20T16:13:10.040
> 
> 标签：ios, uiview

我在检测我的`UIView`对象的交集时遇到了问题。

这就是我在下面使用的：

对于相交两个对象，我需要弄清楚如何将一个坐标系从第一个超级视图转换为另一个坐标系。

我使用了这种方法：`- (CGRect)convertRect:(CGRect)rect fromView:(UIView *)view`在此处描述[链接](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html)。

据我所知，使用这种方法非常简单。但是在不同的情况下，很难在文档中进行一些描述（但可能只是对我而言）。

这是我的子视图结构，如下图所示。我已经掌握了拖放对象的所有方法。但我需要弄清楚如何获得`UIView` **A**和`UIView` **B**的交集。感谢帮助。

![在此处输入图像描述](../Images/b060edf953488f3570f6ad50c78bfd2a.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T20:54:36.000

我已经实现了这个解决方案：

```
- (void)putComponent:(NSNotification *)notif {
    // Catch B UIView.
    UIView *view = [notif object];
    // Convertation. [self superview] - is view wher A UIView is placed.
    CGRect convertedRect = [[self superview] convertRect:view.frame fromView:[view superview]];
    // Find center point.
    CGPoint point;
    point.x = convertedRect.origin.x + (convertedRect.size.width / 2.0f);
    point.y = convertedRect.origin.y + (convertedRect.size.height / 2.0f);
    // Find if CGRect (self.frame) contains a point (center of B UIView)
    BOOL contains = CGRectContainsPoint(self.frame, point);
    if (contains) {
        NSLog(@"intersect here");
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:54:53.990

我认为这等同于您答案中的代码，但要短得多：

```
- (void)putComponent:(NSNotification *)note {
    UIView *other = note.object;
    CGPoint otherCenterInMe = [self convertPoint:other.center fromView:other.superview];
    if ([self pointInside:otherCenterInMe withEvent:nil]) {
        NSLog(@"intersect here");
    }
} 
```

# java - 如何在 Java 应用程序中设置 H2 嵌入式数据库以在小型网络中使用？

> ID：13976189
> 
> 赞同：2
> 
> 时间：2012-12-20T16:13:16.347
> 
> 标签：java, networking, h2, embedded-database

请多多包涵，我对数据库并发和服务器的了解很少。

**问题：**

我正在开发一个项目，该项目由使用嵌入式 H2 数据库的 java 应用程序组成。迄今为止，这已经实现并作为一个独立的 jar 工作。但是，需要在终端服务器上设置应用程序，以供小型网络中的多个用户使用。这就是我缺乏知识让我陷入困境的地方。将 H2 设置为 MIXED_MODE 并在我的 Java 应用程序中使用同步技术就足够了，还是我必须做其他事情？

如果这还不够清楚，请告诉我。如果有人有任何教程，他们可以向我指出那将是很棒的。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:37:01.573

我不确定它如何与终端服务器一起使用，但总的来说：

您必须在服务器模式下启动 h2 并通过 jdbc 将每个客户端连接到服务器。因此，将服务器安装在一台机器上并配置您的客户端应用程序以连接到服务器。如果客户端启动两次，每个客户端都通过 tcp/ip 远程连接到服务器

[http://www.h2database.com/html/tutorial.html#using_server](http://www.h2database.com/html/tutorial.html#using_server)

混合模式是服务器模式和嵌入式模式的特殊变体。但是，如果您启动一个客户端，您不想再次使用第二个客户端启动服务器。

所以，试试服务器模式。

# php - Zend Framework 2 - 在 HTML 中很好地包装注释表单

> ID：13976190
> 
> 赞同：0
> 
> 时间：2012-12-20T16:13:17.483
> 
> 标签：php, forms, twitter-bootstrap, zend-form, zend-framework2

最后，我似乎找到了一种使用某种`ModelForm`via的方法`AnnotationForms`。

我构建（对于常规`Zend\Form`）以下内容以将表单元素包装到`Twitter Bootstrap`容器中

```
foreach ($form as $element) : ?>
<?php echo $element->getLabel() ?>
<div class="control-group <?php if($this->formElementErrors($element)) echo "error" ?>">
    <label class="control-label"><?php echo $element->getLabel() ?></label>
    <div class="controls">
        <?php echo $this->formElement($element);
        if($this->formElementErrors($element)) ?>
            <span class="help-inline"><?php echo $this->formElementErrors($element) ?></span>
    </div>
</div> 
```

现在我意识到由于某种原因这不适用于 AnnotationForms。它创建输入字段，但没有其他内容......有什么想法吗？我该如何解决？

*顺便说一句：我很想有一个解决方案，我可以在我的实体/表单定义中进行包装，以避免在每个页面上都有相同的 for 循环！*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T14:26:22.437

好的，似乎没有很好的内置解决方案。好可怜……

尽管如此，我只是将我的代码放在一个部分中，定义了两个变量并采用了这个解决方案。

工作到现在还算顺利...

```
echo $this->partial('partial/form-partial', array(
   'form' => $this->form,
   'url' =>  $this->url('my-route', array('action' => 'my-action')))); ?> 
```

# android - Android WebView 显示纯文本而不是 html

> ID：13976193
> 
> 赞同：3
> 
> 时间：2012-12-20T16:13:20.240
> 
> 标签：android, android-webview, urlencode

首先，我要说这只是 Android 2 和更早版本的问题（4 似乎不受影响，我没有测试 3）。

我有一个`WebView`从字符串加载 html。HTML 如下所示：

```
<html>  
    <head>
        <link rel='stylesheet' type='text/css' href='http://www.robotsidekick.com/test.css?rev=0' />
    </head>
    <body>
        <h1>Hello World</h1>
    </body>
</html> 
```

您可以看到 css 文件如下所示：

```
body {
    font-family: "Lucida Console", "Lucida Sans Typewriter", Monaco, "Bitstream Vera Sans Mono", monospace;
}
h1 {
    border-bottom: 3px solid #ccc;
} 
```

`WebView`代码如下所示：

```
final WebView webview = new WebView(this);
setContentView(webview);
final String result = "<html><head><link rel='stylesheet' type='text/css' href='http://www.robotsidekick.com/test.css?rev=0' /></head><body><h1>Hello World</h1></body></html>";
webview.loadData(result, "text/html", Encoding.UTF_8.toString()); 
```

**发生什么了**

我看到了 html 代码，`WebView`就好像我将 mime 类型设置为纯文本一样。

![html 作为纯文本会发生什么](../Images/8c4f69e4b9d82a8e946def8d735ad947.png)

**我的期望（以及在 Android 4.x 中会发生什么**

我在`WebView`

有几件事必须是真实的才能显示我所看到的症状：

*   Android 2.x（我使用的是 2.3.7 和 2.2）
*   css 必须通过 url 访问`href="http://www.robotsidekick.com/test.css?rev=0"`，而不是`href="test.css"`（但是它是否是一个真正的 css 文件并不重要`href="http://www.thisisnotarealurl.fake/test.css?rev=0`会导致同样的问题）
*   css 必须有一个 get 参数`?rev=0`，但不管它是什么

还想注意以下内容没有任何区别：

*   在 HTML 中使用适当的`"`而不是`'`
*   让`link`标签自行关闭或不关闭
*   css的内容
*   `<!DOCTYPE html>`向HTML添加文档类型

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T16:13:20.240

将行更改为`webview.loadData`：

```
webview.loadData(URLEncoder.encode(result).replaceAll("\\+", " "), "text/html", Encoding.UTF_8.toString()); 
```

解决了这个问题。`?`在我看来，未编码的相对路径不会引起问题，而未编码的假 URL确实会导致问题，这对我来说似乎很奇怪`?`。

还觉得奇怪的是，`WebView`在后续版本的 Android 中，我们不必再编码我们的 html 了？这听起来很可疑。

# jquery - 是否可以以编程方式设置 Qtip 的位置？

> ID：13976203
> 
> 赞同：6
> 
> 时间：2012-12-20T16:13:57.860
> 
> 标签：jquery, qtip2

我目前正在我的网站上实现[Qtip2](http://craigsworks.com/projects/qtip2/)工具提示，并且它们运行良好。

但是，我需要基于每个元素设置工具提示的位置。为此，我设置了几个`data`这样的属性：

```
<img src="/images/help-icon.png" 
    class="tooltip" 
    title="Lorem ipsum dolor sit amet consectetur adipiscing elit" 
    data-tooltip-my-position="right center" 
    data-tooltip-target-position="left center" /> 
```

我尝试使用函数来获取数据属性，但似乎`my`and`at`属性不接受函数，因为这只是将工具提示放在右下角/左上角，这似乎是默认定位。

```
$(this).find('.tooltip').qtip({
    show: {
        event: 'mouseenter click'
    },
    position: {
        my: function() {
            return $(this).data('tooltip-my-position'); // doesn't work
        },
        at: function() {
            return $(this).data('tooltip-target-position'); // doesn't work
        }
    }
}); 
```

我查看了[文档](http://craigsworks.com/projects/qtip2/docs/position/#my)，但似乎没有关于在初始化时或之后以编程方式设置定位属性的指导。

有谁知道我正在尝试做的事情是否可行，如果可以，怎么做？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-20T16:32:37.760

我刚刚想出了一个解决方案，通常在我在这里发布之后就足够了。

我将一个函数连接到`show`事件，该事件作为参数传递给目标元素，然后我可以从中获取`data`属性：

```
$(this).find('.tooltip').qtip({
    show: {
        event: 'mouseenter click'
    },
    events: {
        show: function(event, api) {
            var $el = $(api.elements.target[0]);
            $el.qtip('option', 'position.my', $el.data('tooltip-my-position') || 'right center');
            $el.qtip('option', 'position.at', $el.data('tooltip-at-position') || 'left center');
        }
    }
}); 
```

我会把这个答案留在这里，以防将来对某人有用。

# javascript - 背景图像仅显示为空白

> ID：13976206
> 
> 赞同：0
> 
> 时间：2012-12-20T16:14:05.847
> 
> 标签：javascript, .net, css, visual-studio-2010

我已经阅读了网站上有关正确路径引用等的许多消息，例如在加载 CSS 背景图像时，但无法解决此问题。我的 CSS 参考是：

```
.pageLoading
{
   display: block;
   height: 100%;
   width: 100%;
   background: no-repeat left top;
   background-image: url(<%=ResolveUrl('~/Resources/loading.gif')%>);
} 
```

我正在通过一个`OnClientClick="HideContent();"`执行以下 JavaScript 的按钮来影响此更改：

```
document.getElementById("<%=Master.PageLoadingDivTag.ClientID%>").style.display = "block"; 
```

当我单击按钮时，页面的内容会消失，只是被一个空白表单取代。无论我使用哪个图像，行为都是相同的。
所有文件（Site.Master、Site.css 和 loading.gif）都在同一个 Resources 目录中，因此它应该能够毫无问题地引用这些文件。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T17:43:28.207

正如您在 CSS 描述中看到的，我将高度和宽度设置为 100%。根据它实际显示的标签的位置，但我只是看不到它。我为尺寸设置了一个绝对值，现在它工作正常。谢谢！

# java - 从 Spring MVC 控制器注入 JSP

> ID：13976208
> 
> 赞同：3
> 
> 时间：2012-12-20T16:14:10.980
> 
> 标签：java, javascript, jsp, spring-mvc

我有一个使用 JSP 作为 View 技术的 Spring MVC Web 应用程序。在控制器中，我将值注入到`ModelAndView`对象中，然后将使用该对象（与相应的 JSP 一起）帮助构建最终的 HTML 以返回到客户端。

控制器：

```
@RequestMapping(value = "/widgets.html", method = RequestMethod.POST)
public ModelAndView widgets(@Model Fruit fruit, @RequestParam("texture") String texture) {
    ModelAndView mav = new ModelAndView();

    // The name of the JSP to inject and return.
    max.setViewName("widgets/AllWidgets");

    int buzz = calculateBuzzByTexture(texture);

    mav.addObject("fruitType", fruit.getType());
    mav.addObject("buzz", buzz);

    return mav;
} 
```

这个控制器（处理`/widgets.html`请求）进行一些查找并返回注入的`AllWidgets.jsp`页面。在那个 JSP 页面中，我需要同时访问`fruitType`和`buzz`变量（在 HTML 和 JS 中），但不知道如何做到这一点。例如，假设`fruitType`是一个字符串（并且`buzz`是一个`int`），我将如何在 HTML 和 JS 中打印它们：

```
<script type="text/javascript>
    alert("Buzz is " + buzz);
</script>

<div>
    <h2>The type of fruit is ??? fruitType ???</h2>
</div> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T16:21:37.793

Spring 控制器将视图对象存储在页面上下文中，并使用 EL 访问它们：

```
<div>
    <h2>The type of fruit is ${fruitType}</h2>
</div> 
```

Oracle [Java EE 教程](http://docs.oracle.com/javaee/6/tutorial/doc/gjddd.html)以及[Spring MVC](http://blog.springsource.com/2011/01/04/green-beans-getting-started-with-spring-mvc/)入门教程中对此进行了描述。

# php - 使用 PHP 清理 SVG

> ID：13976209
> 
> 赞同：10
> 
> 时间：2012-12-20T16:14:21.773
> 
> 标签：php, svg, sanitization

我正在使用 d3.js 作为 SVG 动态创建图表。这些图表是根据经过身份验证的用户的选择动态生成的。生成这些图表后，用户可以选择将生成的 SVG 下载为 PNG 或 PDF。

当前的工作流程如下：

```
// JAVASC
// get the element containing generated SVG
var svg = document.getElementById("chart-container");

// Extract the data as SVG text string
var svg_xml = (new XMLSerializer).serializeToString(svg);

// Submit the <FORM> to the server.
var form = document.getElementById("svgform");
form['output_format'].value = output_format;  // can be either "pdf" or "png"
form['data'].value = svg_xml ;
form.submit(); 
```

FORM 元素是一个隐藏的表单，用于 POST 数据：

```
<form id="svgform" method="post" action="conversion.php">
  <input type="hidden" id="output_format" name="output_format" value="">
  <input type="hidden" id="data" name="data" value="">
</form> 
```

PHP 文件将提供的 SVG 数据保存为临时文件：

```
// check for valid session, etc - omitted for brevity 

$xmldat = $_POST['data'];  // serialized XML representing the SVG element
if(simplexml_load_string($xmldat)===FALSE) { die; } // reject invalid XML  

$fileformat = $_POST['output_format'];  // chosen format for output;  PNG or PDF
if ($fileformat != "pdf" && $fileformat != "png" ){ die; } // limited options for format
$fileformat = escapeshellarg($fileformat); // escape shell arguments that might have snuck in

// generate temporary file names with tempnam() - omitted for brevity

$handle = fopen($infile, "w");
fwrite($handle, $xmldat);
fclose($handle); 
```

运行一个转换实用程序，它读取临时文件 ($infile) 并以指定的 $fileformat（PDF 或 PNG）创建一个新文件 ($outfile)。然后将生成的新文件返回给浏览器，并删除临时文件：

```
// headers etc generated - omitted for brevity
readfile($outfile);

unlink($infile);  // delete temporary infile  
unlink($outfile);  // delete temporary outfile 
```

我研究[了使用 JavaScript (canvg(), 然后 toDataURL, 然后 document.write) 将 SVG 转换为 PNG](https://stackoverflow.com/a/3976034/1876846)，并且可以使用它来生成 PNG，但它不允许转换为 PDF。

那么：在将其写入文件之前，如何最好地清理或过滤提供给 conversion.php 的 SVG 数据？SVG 清理的当前状态是什么？PHP中有什么可用的？我应该使用基于[白名单的方法](https://stackoverflow.com/questions/4881364/sanitizing-an-svg-document-by-whitelisting-elements)来清理提供给 conversion.php 的 SVG 数据，还是有更好的方法？

（我不知道 XSLT，虽然我可以尝试学习它；我希望尽可能多地在 PHP 中进行清理。使用 Windows Server 2008，因此任何使用外部工具的解决方案都需要在该生态系统中可用。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T17:34:03.340

我正在使用 xml 和 PHP，但我完全不确定你的问题。请把它当作一个想法/建议，而不是更多。

SimpleXML 使用 libxml 加载 xml 内容。 [http://www.php.net/manual/en/simplexml.requirements.php](http://www.php.net/manual/en/simplexml.requirements.php)

您可以使用以下方法禁用外部实体：

```
libxml_disable_entity_loader (TRUE) 
```

[http://www.php.net/manual/en/function.libxml-disable-entity-loader.php](http://www.php.net/manual/en/function.libxml-disable-entity-loader.php)

在使用 simpleXML 加载文件之前。

然后您可以针对 SVG 模式进行验证

[http://us3.php.net/manual/en/domdocument.schemavalidate.php](http://us3.php.net/manual/en/domdocument.schemavalidate.php) 或 [http://us3.php.net/manual/en/domdocument.validate.php](http://us3.php.net/manual/en/domdocument.validate.php)

我会看到的唯一问题是 svg 可能包含脚本元素。[http://www.w3.org/TR/SVG/script.html#ScriptElement](http://www.w3.org/TR/SVG/script.html#ScriptElement)

这里有关于 1.1 DTD 的信息：http: [//www.w3.org/Graphics/SVG/1.1/DTD/svg-framework.mod](http://www.w3.org/Graphics/SVG/1.1/DTD/svg-framework.mod) [http://www.w3.org/TR/2003/REC-SVG11-20030114/ REC-SVG11-20030114.pdf](http://www.w3.org/TR/2003/REC-SVG11-20030114/REC-SVG11-20030114.pdf)

您可以为 SVG DTD 提供脚本元素的修改版本或循环遍历元素以防止脚本元素出现。

它不会是完美的，但至少总比没有好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-08-28T07:54:22.007

您需要使用 XML 解析器 + 白名单来清理 SVG。

因为 SVG 已经有多种执行代码的方法，并且未来的扩展可能会添加额外的方法，所以您根本无法将“已知危险”构造列入黑名单。只要您正确处理所有 XML 极端情况（例如 XSLT 样式表、实体扩展、外部实体引用），将安全元素和属性列入白名单就可以工作。

示例实现：[https](https://github.com/alnorris/SVG-Sanitizer/blob/master/SvgSanitizer.php) ://github.com/alnorris/SVG-Sanitizer/blob/master/SvgSanitizer.php （MIT 许可）或[https://github.com/darylldoyle/svg-sanitizer（GPL](https://github.com/darylldoyle/svg-sanitizer) v2 许可）

有关选择要支持的功能时必须考虑的攻击向量的更多信息：

*   [https://phabricator.wikimedia.org/T85850（base64](https://phabricator.wikimedia.org/T85850)编码部分）
*   [https://www.slideshare.net/x00mario/the-image-that-c​​all](https://www.slideshare.net/x00mario/the-image-that-called-me) -me （执行代码的不同方式）
*   [https://www.blackhat.com/docs/us-14/materials/us-14-DeGraaf-SVG-Exploiting-Browsers-Without-Image-Parsing-Bugs.pdf](https://www.blackhat.com/docs/us-14/materials/us-14-DeGraaf-SVG-Exploiting-Browsers-Without-Image-Parsing-Bugs.pdf)（在SVG中嵌入HTML，SVG可以做很多事情任何XML 文件可以做的*任何事情**，*任何 HTML 文件可以做的事情，在里面使用 SVG`<object>`允许 SVG 内部的 JS 在父文档中执行）
*   [https://bjornjohansen.no/svg-in-wordpress](https://bjornjohansen.no/svg-in-wordpress)（过滤 SVG 已经够难了，即使是 WordPress 也没有很好的解决方案来处理用户提交的 SVG 文件）
*   [http://html5sec.org/?svg](http://html5sec.org/?svg)（一些已知的滥用不同 API 的 SVG 攻击列表）
*   [https://security.stackexchange.com/questions/26264](https://security.stackexchange.com/questions/26264)
*   [https://blobfolio.com/2017/03/when-a-stranger-calls-sanitizing-svgs/](https://blobfolio.com/2017/03/when-a-stranger-calls-sanitizing-svgs/)（不同的编码方式，巧妙地使用空格来避免检测，xml技巧）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-05-23T12:04:20.710

您可以使用 SVG Sanitize 包：[https ://packagist.org/packages/enshrined/svg-sanitize](https://packagist.org/packages/enshrined/svg-sanitize)

在撰写此答案之日已安装 500k。

```
use enshrined\svgSanitize\Sanitizer;

// Create a new sanitizer instance
$sanitizer = new Sanitizer();

// Load the dirty svg
$dirtySVG = file_get_contents('filthy.svg');

// Pass it to the sanitizer and get it back clean
$cleanSVG = $sanitizer->sanitize($dirtySVG);

// Now do what you want with your clean SVG/XML data 
```

# facebook - 如何将我的 Facebook 应用程序和域列入白名单？

> ID：13976210
> 
> 赞同：0
> 
> 时间：2012-12-20T16:14:22.197
> 
> 标签：facebook, facebook-graph-api, message

除了在 Facebook 上列入白名单之外，通过发送对话框撰写的消息似乎没有办法绕过收件人限制。

我不想在 facebook 上做广告，所以我不确定 PMD Group 是否可能是解决方案[https://developers.facebook.com/preferredmarketingdevelopers/ads-api-access/](https://developers.facebook.com/preferredmarketingdevelopers/ads-api-access/)

该应用程序应该能够结合自定义消息为多个收件人使用“邀请朋友”功能。比较 Pinterest [http://i.stack.imgur.com/0OSfF.png](http://i.stack.imgur.com/0OSfF.png)、eBay 等...

**我的问题是：我如何申请白名单？还是真的有必要联系 Facebook 组织内的某个人？有没有人可以帮助我？**

提前非常感谢，圣诞快乐，节日快乐！

托马斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T16:48:56.177

如果没有这些邀请信息，Facebook 会是一个更好的地方。

这个限制是有原因的，想想看。这些邀请应该发送给您认识的感兴趣的人，而不是您的整个好友列表。

# css - 两个并排的 div 有问题

> ID：13976213
> 
> 赞同：2
> 
> 时间：2012-12-20T16:14:38.607
> 
> 标签：css, html

所以我正在构建一个可供多家公司使用的页面，但我遇到了一些问题。在第一个示例中，只有两个 div 的代码看起来不错，但我希望每行之间有一些空间。我还在下面发布了css。然后在第二个链接中，我粘贴了代码，其中包含将使用该代码的公司之一的布局。它看起来更好，但它会将侧边栏向下推。

[http://tinyurl.com/bo6ukqe](http://tinyurl.com/bo6ukqe)

[http://tinyurl.com/cerzfwd](http://tinyurl.com/cerzfwd)

所以我很好奇解决这个问题的最佳方法是什么。我需要左 div 和右 div 对齐。目前

1.  我希望左右 div 对齐。意思是，两者的高度相同。
2.  我想每行之间是否有一点空间。目前，这些图片是相互重叠的。
3.  我希望正确的 div 大小取决于它有多少空间。因此，不是一家公司因为侧边栏而不得不将其设置为 55%，而是另一家公司必须将其更改为 80%，因为它没有侧边栏。

如果您不喜欢挖掘上述链接中的代码，这里是 css：

```
<style type="text/css">
.body { border : 1pt solid black; }
.left { clear: left; float : left; width:226px; height:127px;  }
.right { float : right; width : 80%; }
.spacer { clear : both; height: 10px; }
img { border: none; }
p.description {
line-height:18px;
color:#767676;
font-size:12px;
}
p.description a {
font-weight:bold;
}
a.read-more-link {
border-top:none;
text-transform: uppercase;
margin:0; padding:0;
font-size:10px;
}
.read-more a {
border-top:none;
display: block;
text-align: right;
text-transform: uppercase;
margin:15px 0 0 0; padding:0;
text-decoration: none;

}

</style> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:20:53.887

首先，你还没有关闭，通过在之前`.content_left`添加来做到这一点`</div>``<div class="content_right"></div>`

然后将以下每一项封装在一个`<div class="row"></div>`

`<div class="left"></div><div class="right"></div>`

然后加

```
.row {
 padding: 5px 0;
 margin-left: 0;
 margin-right: 0;
 width: 60%;
} 
```

然后

```
.content_right {
 width: 40%;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T16:22:30.600

对于 #1 和 #2：

在每一行周围放置一个包装器 div。由于您正在浮动包装器的子元素，因此也需要浮动以使其尊重内部高度，以便您的边距将推动兄弟：

```
<div style="float: left; width: 100%; clear: both; margin: 0 0 10px 0;"></div><!-- wrapper row --> 
```

对于#3：

您将需要学习[响应式网页设计](http://en.wikipedia.org/wiki/Responsive_web_design)。

# iphone - 如何在 self.view 的属性上设置 lldb 观察点？

> ID：13976219
> 
> 赞同：19
> 
> 时间：2012-12-20T16:15:10.820
> 
> 标签：iphone, objective-c, ios, xcode, lldb

我想跟踪什么时候改变 self.view 的大小。正确的格式是什么？

```
(lldb) po self.view
(UIView *) $1 = 0x0a8aba20 <UIView: 0xa8aba20; frame = (0 0; 480 864); autoresize = W+TM+BM; layer = <CALayer: 0xa8aba50>>
(lldb) watch set variable self.view.frame.size.width
error: "self" is a pointer and . was used to attempt to access "view". Did you mean "self->view.frame.size.width"?
(lldb) watch set variable self->view
error: "view" is not a member of "(PlayViewController *) self"
(lldb) watch set variable self->view.frame.size.width
error: "view" is not a member of "(PlayViewController *) self" 
```

我已经尝试过文档和其他 lldb 观察点问题，但找不到针对此特定案例的任何内容。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-12-20T20:52:11.147

视图控制器从它的`_view`实例变量中引用它的视图。

视图不直接存储其框架。它只是返回其层的“框架”。

视图从其`_layer`实例变量中引用其层。

该图层也不存储帧。`bounds`它根据、`position`、`anchorPoint`和计算其框架`transform`。大小是 的一部分`bounds`。

该层不直接将其边界存储在实例变量中。相反，它的`layer`实例变量引用了一个私有 C++ 类的实例，`CA::Layer`. 此类的成员布局未记录。

换句话说，你可以去`self->_view->_layer->layer`到`CA::Layer`实例，但是你被卡住了，因为你不知道在哪里`CA::Layer`找到边界。

因此，尝试使用观察点来检测视图大小的变化是相当困难的。

在 .上放置断点更容易`-[CALayer setBounds:]`。

### 在模拟器上

切记在断点条件中使用**层地址，****而不是**视图地址。

```
(lldb) po self.view
(UIView *) $1 = 0x0a034690 <UIView: 0xa034690; frame = (0 20; 768 1004); autoresize = W+H; layer = <CALayer: 0xa034780>>
(lldb) break set -F '-[CALayer setBounds:]' -c '((int*)$esp)[1] == 0xa034780'
Breakpoint created: 2: name = '-[CALayer setBounds:]', locations = 1, resolved = 1 
```

当断点被命中时，`CALayer`实例被 引用`((int *)$esp)[1]`，新的边界是`*(CGRect *)($esp+12)`：

```
(lldb) po ((int*)$esp)[1]
(int) $8 = 167987072 <CALayer:0xa034780; position = CGPoint (384 480); bounds = CGRect (0 0; 768 1004); delegate = <UIView: 0xa034690; frame = (0 -22; 768 1004); autoresize = W+H; layer = <CALayer: 0xa034780>>; sublayers = (<CALayer: 0xa033010>); backgroundColor = <CGColor 0xa034960> [<CGColorSpace 0xa02b3b0> (kCGColorSpaceDeviceRGB)] ( 1 1 1 1 )>
(lldb) p *(CGRect*)($esp+12)
(CGRect) $9 = origin=(x=0, y=0) size=(width=768, height=960)
(lldb) finish
(lldb) po 0xa034780
(int) $10 = 167987072 <CALayer:0xa034780; position = CGPoint (384 480); bounds = CGRect (0 0; 768 960); delegate = <UIView: 0xa034690; frame = (0 0; 768 960); autoresize = W+H; layer = <CALayer: 0xa034780>>; sublayers = (<CALayer: 0xa033010>); backgroundColor = <CGColor 0xa034960> [<CGColorSpace 0xa02b3b0> (kCGColorSpaceDeviceRGB)] ( 1 1 1 1 )> 
```

### 在设备上

切记在断点条件中使用**层地址，****而不是**视图地址。

```
(lldb) po self.view
(UIView *) $0 = 0x1f031a10 <UIView: 0x1f031a10; frame = (0 20; 768 1004); autoresize = W+H; layer = <CALayer: 0x1f031b00>>
(lldb) break set -F '-[CALayer setBounds:]' -c '$r0 == 0x1f031b00'
Breakpoint created: 2: name = '-[CALayer setBounds:]', locations = 1, resolved = 1 
```

当断点被命中时，`CALayer`实例被 引用`$r0`，新的 X 原点在`$r2`，新的 Y 原点在`$r3`，新的大小是`*(CGSize *)$sp`：

```
(lldb) po $r0
(unsigned int) $7 = 520297216 <CALayer:0x1f031b00; position = CGPoint (384 480); bounds = CGRect (0 0; 768 1004); delegate = <UIView: 0x1f031a10; frame = (0 -22; 768 1004); autoresize = W+H; layer = <CALayer: 0x1f031b00>>; sublayers = (<CALayer: 0x1f030840>); backgroundColor = <CGColor 0x1f031ce0> [<CGColorSpace 0x1e530ad0> (kCGColorSpaceDeviceRGB)] ( 1 1 1 1 )>
(lldb) p/f $r2
(unsigned int) $14 = 0
(lldb) p/f $r3
(unsigned int) $15 = 0
(lldb) p *(CGSize *)$sp
(CGSize) $16 = (width=768, height=960)
(lldb) finish
(lldb) po 0x1f031b00
(int) $17 = 520297216 <CALayer:0x1f031b00; position = CGPoint (384 480); bounds = CGRect (0 0; 768 960); delegate = <UIView: 0x1f031a10; frame = (0 0; 768 960); autoresize = W+H; layer = <CALayer: 0x1f031b00>>; sublayers = (<CALayer: 0x1f030840>); backgroundColor = <CGColor 0x1f031ce0> [<CGColorSpace 0x1e530ad0> (kCGColorSpaceDeviceRGB)] ( 1 1 1 1 )> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-04-21T06:20:03.943

在 64 位模拟器上，break 命令应该是：

```
break set -F '-[CALayer setBounds:]' -c '$rdi == 0x...' 
```

# ios - iOS 架构 i386 的未定义符号：“_kUTTypeImage”

> ID：13976220
> 
> 赞同：3
> 
> 时间：2012-12-20T16:15:12.350
> 
> 标签：ios, xcode, uiimagepickercontroller, linker-errors

```
Undefined symbols for architecture i386:
  "_kUTTypeImage", referenced from:
      -[ViewController receiveNotification:] in ViewController.o
ld: symbol(s) not found for architecture i386
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

我在我的应用程序中添加了一个 UIImagePickerController，当我去编译时，我得到了上述错误。我找到了一个解决方案：

[未找到符号：kUTTypeImage](https://stackoverflow.com/questions/10144961/symbol-not-found-kuttypeimage)

> 查找符号 (kUTTypeImage) 并找到它应该存在的图像/库（在本例中为 MobileCoreServices.framework）。然后将您的二进制文件与该框架链接。

问题是，我不确定如何实现它。如何查找符号，然后将其链接到框架？

应该注意的是，我已经导入了 MobileCoreServices 框架。以下是相关代码：

```
if ([UIImagePickerController isSourceTypeAvailable:
                 UIImagePickerControllerSourceTypeCamera]) {

                UIImagePickerController* myCamera = [[UIImagePickerController alloc] init];
                myCamera.delegate = self;
                myCamera.sourceType = UIImagePickerControllerSourceTypeCamera;
                myCamera.mediaTypes = [NSArray arrayWithObjects:(NSString *) kUTTypeImage, nil];
                myCamera.allowsEditing = NO;
                [self presentModalViewController:myCamera animated:YES];

            } 
```

![在此处输入图像描述](../Images/eded1a38a45e6eaa3b3a5189afbf4086.png)

![在此处输入图像描述](../Images/6f7f0c7144ae1a3041fb4423c3d0619d.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T16:18:49.250

您只需要添加框架，然后将其导入您的项目（或者更确切地说，目标）。在导航器中，单击您的项目，然后选择一个目标。然后转到 Build Phases 选项卡，如果尚未展开，请展开 Link Binary With Libraries。然后添加 MobileCoreServices.framework。在要使用 kUTTypeImage 的文件中，添加以下导入：

`#import <MobileCoreServices/MobileCoreServices.h>`

请注意，您使用尖括号 (<>) 而不是通常使用的引号。

# c# - 查询以返回相关行对，但仅当两行都存在时

> ID：13976221
> 
> 赞同：0
> 
> 时间：2012-12-20T16:15:13.013
> 
> 标签：c#, asp.net, sql-server, database

**我有以下表格：**

> *sistema_documentos*
> 
> [id], [caminho], [idDocType](FK -> sistema_DocType.id)
> 
> *sistema_Indexacao*
> 
> [id] ,[idDocumento](FK -> sistema_documentos.id) ,[idIndice](FK -> sistema_Indexes) ,[valor]
> 
> *sistema_DocType*
> 
> [id], [tipoNome](FK -> sistema_DocType.id)
> 
> *sistema_DocType_Index*
> 
> [id],[idName],[面具],[idTipo](FK -> sistema_DocType.id),[tamanho]

**从这个查询**：

```
select distinct a.id, b.idIndice, b.valor from tgpwebged.dbo.sistema_Documentos as a
join tgpwebged.dbo.sistema_Indexacao as b on a.id = b.idDocumento
join tgpwebged.dbo.sistema_DocType as c on a.idDocType = c.id
join tgpwebged.dbo.sistema_DocType_Index as d on c.id = d.docTypeId
where d.docTypeId = 40 
and (b.idIndice = 11 AND b.valor = '11111111' OR b.idIndice = 12 AND b.valor = '22222' ) 
```

我得到以下结果

```
id  idIndice    valor
13  11          11111111
13  12          22222
14  11          11111111
14  12          22222
16  12          22222 
```

如您所见，我想要所有 idIndice 11 的 id 值为 11111111 和 12 的值为 22222

ID 16 的 id 12 的值为 22222 authough 它没有 id 11 的值为 11111111 所以我不希望它显示出来。

如何更新我的查询以获得我想要的结果。希望我的问题很清楚。如果它不只是问，我编辑我的帖子。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T17:01:05.533

我会建议这样的事情：

```
WITH TempTable AS 
( 
    select distinct a.id, b.idIndice, b.valor  
    from tgpwebged.dbo.sistema_Documentos as a  
        join tgpwebged.dbo.sistema_Indexacao as b on a.id = b.idDocumento 
    join tgpwebged.dbo.sistema_DocType as c on a.idDocType = c.id
    join tgpwebged.dbo.sistema_DocType_Index as d on c.id = d.docTypeId 
    where d.docTypeId = 40      
        and (b.idIndice = 11 AND b.valor = '11111111' OR b.idIndice = 12 AND b.valor = '22222' ) 
)

SELECT *  
FROM TempTable t1 
WHERE (select count(*)          
       from TempTable t2        
       where t1.id = t2.id AND t1.valor != t2.valor) = 1 
```

所以...从您的第一个查询中获取所有结果，其中至少有一个表中的结果与 id 匹配，但与 valor 不匹配。（这假设您可以拥有具有相同价值的重复行，但您不希望这样。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T17:39:46.740

尝试这样的事情。我取出了与查询没有直接关系的表，尽管我以类似方式命名它们，并创建了一个简单的模式来复制问题。我希望这很清楚，并且与原始查询的联系也很清楚。

```
CREATE TABLE Documentos (ID INT, document varchar(12))
create table Indexacao (AID INT, indice int, valor varchar(12))

insert Documentos(id, document)
values (1, 'test1'),
        (2, 'test2'),
        (3, 'test3')

insert Indexacao (aid, indice, valor)
values (1, 11, '11111111'),
        (1, 12, '22222'),
        (2, 12, '22222') 
```

代码的重要部分是 INTERSECT - 它只返回两个集合中的行。以我的经验，这个操作符通常比任何包含`OR`. 在下面的查询中，我们只得到那些 idDocumentos 在`INTERSECT`两组条件中的 Indexacao 行。

```
SELECT Ind.*
FROM Indexacao Ind
JOIN (
    SELECT  D.ID
    FROM    Documentos  D
    JOIN    Indexacao   I
    ON      D.ID = I.AID
    WHERE   I.Indice = 11 AND I.valor = '11111111'
    INTERSECT
    SELECT  D.ID
    FROM    Documentos  D
    JOIN    Indexacao   I
    ON      D.ID = I.AID
    WHERE   I.Indice = 12 AND I.valor = '22222'
    )Doc (ID)
ON  Doc.ID = Ind.AID 
```

这假设您没有针对单个 idDocumento 重复的 Indice、Valor 行 - 如果有，则需要添加 DISTINCT。

# jsp - response.sendRedirect() 或 request.getRequestDispatcher() 的 JSP 会话问题

> ID：13976223
> 
> 赞同：0
> 
> 时间：2012-12-20T16:15:19.333
> 
> 标签：jsp, session, redirect

我正在使用具有这种结构的网络应用程序：

```
main/index.jsp
main/first/index.jsp
main/second/index.jsp 
```

在我的 main/index.jsp 中，我有一个登录表单，启用会话变量和重定向，具体取决于我输入的用户/密码类型。实际上我正在使用 request.getRequestDispatcher("/first /index.jsp") 和 request.getRequestDispatcher("/second/index.jsp") 从登录页面重定向。两个 webapps（第一个和第二个）只有在它们的会话变量被启用的情况下才会被启用，并且它们都有一些通过链接传递的变量，如下所示：

```
main/first/index.jsp?id=1&var=2 
```

我当前的问题是：当我从 main/index.jsp 传递到其他 2 个 webapps 之一时，我的 url 不会改变。它应该是 main/second/index.jsp 但它仍然是 main/index.jsp，并且我在该页面中的所有链接都搞砸了（因为它们是相对于它们的文件夹），所以如果我尝试使用传递变量的链接通过链接我不会得到这个：

```
main/second/index.jsp?id=2&var=1 
```

但是这个：

```
main/index.jsp?id=2&var=1 
```

我试图解决这个问题，在链接上放置它们的主路径，但是在一次“迭代”之后，第二个将有一个正确的 url，所以第二个将是这样的：

```
main/second/second/index.jsp?id=3&var=1 
```

仍然是一些无用和错误的东西。

我尝试使用 response.sendRedirect() 而不是 request.getRequestDispatcher() 但使用此解决方案我丢失了会话变量：重定向后，一切都丢失了。

有人能帮助我吗？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T16:29:50.043

经过一些测试，我解决了这个问题。当我通过 URL 传递变量时，我需要使用完整地址，如下所示：

```
<a href="/main/first/index.jsp?id=1"> One, 1</a> 
```

而不是使用这个：

```
<a href="index.jsp?id=1"> One, 1</a> 
```

# php - 我尝试从具有四个索引的多个表中选择数据

> ID：13976230
> 
> 赞同：1
> 
> 时间：2012-12-20T16:15:45.953
> 
> 标签：php, mysql

我有两个表，我尝试创建一个表来管理数据。

第一个表是“问题”：

```
questions (question_id, key1, key2, key3, key4, user_id, creation_date, class, type     permission) 
```

和另一个：

```
questions_keys (question_key_id, question_key_name, question_key_refers_to) 
```

每次我按下存储在表 question_keys 中的提交按钮时，都会有四条记录和一条在问题表中。这是一个例子：

问题键：

```
1, mathematics, 0
2, history, 1
3, physics, 2
4, geography, 3 
```

和问题表：

```
(1, 1, 2, 3, 4, 8, 2012-12-19 20:41:48, 4, multiple_choice,     0) 
```

我需要的查询：在表中显示 question_key_name，其中表问题中的 key1、key2、key3、key4 等于 question_key_id。

并在一行中显示如下内容：

`mathematics, history, physics, geography, multiple_choice, 2012-12-19 20:41:48` ETC

我是新来的，我需要你的帮助..非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T16:56:13.810

尝试这个：

```
SELECT qk1.question_key_name qk2.question_key_name, qk3.question_key_name, 
       qk4.question_key_name, q.type, q.creation_date 
FROM questions q 
INNER JOIN question_keys qk1 ON q.key1 = qk1.question_key_id 
INNER JOIN question_keys qk2 ON q.key2 = qk2.question_key_id 
INNER JOIN question_keys qk3 ON q.key3 = qk3.question_key_id 
INNER JOIN question_keys qk4 ON q.key4 = qk4.question_key_id; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T16:49:51.047

使用这种设计，您必须四次加入表格：

```
SELECT question_key_name
FROM question_key qk
JOIN questions q on q.key1 = qk.question_key_id
WHERE q.question_id = ? 
```

然后对其他 3 重复。您可以将它们全部合并在一起，这将返回 4 行。

至于只返回一行，请查看 GROUP_CONCAT，但这会将 question_key_name 值作为一列返回。您最好将应用代码中的 4 行结合起来。

# iphone - 如何在 Keychain 中存储用户名和密码并通过 alertView 进行验证

> ID：13976232
> 
> 赞同：3
> 
> 时间：2012-12-20T16:15:51.397
> 
> 标签：iphone, ios

我想在钥匙串中存储用户名和密码并通过警报视图验证它们。有没有人有代码？

我这样做是因为这些应用程序是内部的，我希望我的应用程序被应用程序商店接受。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:24:39.820

```
NSString *username = @"yourUserName";
NSString *password = @"yourPassword";
KeychainItemWrapper *keychain = [[KeychainItemWrapper alloc] initWithIdentifier:@"TestAppLoginData" accessGroup:nil];

// Store username to keychain
[keychain setObject:username forKey:(id)kSecAttrAccount];

// Store password to keychain
[keychain setObject:password forKey:(id)kSecValueData]; 

// Get username from keychain (if it exists)
NSString *username = [keychain objectForKey:(id)kSecAttrAccount];
NSLog(@"username: %@", username);

// Get password from keychain (if it exists)  
NSString *password = [keychain objectForKey:(id)kSecValueData];
NSLog(@"password: %@", password); 
```

[在此处](http://developer.apple.com/library/ios/#samplecode/GenericKeychain/Introduction/Intro.html)下载`KeychainItemWrapper`表格

# c# - 如何从 PDF 中提取文本并解码字符？

> ID：13976233
> 
> 赞同：2
> 
> 时间：2012-12-20T16:15:57.653
> 
> 标签：c#, pdf, itextsharp

我正在使用 itextsharp 使用以下代码从 pdf 文档中提取文本：

```
public static bool does_document_text_have_keyword(string keyword, 
                       string pdf_src, Report report_object)  // TEST
{
    try
    {
        PdfReader pdfReader = new PdfReader(pdf_src);
        string currentText;
        int count = pdfReader.NumberOfPages;
        for (int page = 1; page <= count; page++)
        {
           ITextExtractionStrategy strategy = new SimpleTextExtractionStrategy();
           currentText = PdfTextExtractor.GetTextFromPage
                           (pdfReader, page, strategy);
           currentText = Encoding.UTF8.GetString
                           (ASCIIEncoding.Convert
                             (Encoding.Default,                                 
                              Encoding.UTF8, 
                              Encoding.Default.GetBytes(currentText)));

           report_object.log(currentText);  // TEST

           if (currentText.IndexOf
                (keyword, StringComparison.OrdinalIgnoreCase) != -1) return true;
        }
        pdfReader.Close();
        return false;
    }
    catch
    {
        return false;
    }
} 
```

但问题是，当我提取文本时，文本没有空格，就好像空格已被空字符串替换。然而在pdf文档中，里面有空格。有谁知道这里发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T16:35:13.560

我相信您的问题是 SimpleTextExtractionStrategy。[来自http://api.itextpdf.com/itext/com/itextpdf/text/pdf/parser/SimpleTextExtractionStrategy.html](http://api.itextpdf.com/itext/com/itextpdf/text/pdf/parser/SimpleTextExtractionStrategy.html)的 API 文档

> 如果 PDF 以非从上到下的方式呈现文本，这将导致文本无法真实表示它在 PDF 中的显示方式。此渲染器还使用基于字体度量的简单策略来确定是否应在输出中插入空格。

尝试使用 LocationTextExtractionStrategy。它的文档指出：

> 跟踪页面上文本相对位置的文本提取渲染器生成的文本将与大多数 PDF 文件在屏幕上的物理布局相对一致。

# java - 以复合方式绘制

> ID：13976235
> 
> 赞同：-1
> 
> 时间：2012-12-20T16:16:05.743
> 
> 标签：java, graphics, swt, composite

我有一个名为 Workspace 的组合。在这个合成中，我想添加一些图形对象。每个对象都可以选择、拖动、移动，并且可以具有复杂的形状（圆形、椭圆形、多边形......）。我可以单击每个对象以查看其属性。最好的实施方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:20:19.200

看看[`Zest`](http://www.vogella.com/articles/EclipseZest/article.html)。[这](http://www.vogella.com/articles/EclipseZest/article.html)是一个非常好的使用 Zest 的教程。

作为替代方案，有[`Draw2d`](http://www.eclipse.org/gef/draw2d/index.php). 再一次，[这](http://www.java2s.com/Code/Java/SWT-JFace-Eclipse/SWTDraw2D.htm)是一个很好的简单示例：

![在此处输入图像描述](../Images/b20e8d988c44d8801c15bc561b46112b.png)

# c# - 我想在 System.Threading.Tasks.Task.Factory.StartNew(); 中处理异常

> ID：13976237
> 
> 赞同：2
> 
> 时间：2012-12-20T16:16:15.683
> 
> 标签：c#, .net, asynchronous

我已经执行了一个异步方法，如下所示

```
System.Threading.Tasks.Task.Factory.StartNew(() => AddAttachment(information.Subject,
information.DocumentId.ToString(),
information.Sender,list.Name)); 
```

如何处理方法内部产生的异常`AddAttachment()`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T16:25:38.260

您可以创建一个延续任务来检查您创建的任务`StartNew`：

```
Task outer = System.Threading.Tasks.Task.Factory.StartNew(() => AddAttachment(information.Subject, information.DocumentId.ToString(), information.Sender,list.Name))
    .ContinueWith(task => {
        if(task.IsFaulted)
        {
            AggregateException ex = task.Exception;
            //handle exception
        }
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T16:31:34.180

最简单的方法是创建一个延续并使用`OnlyOnFaulted`选项：

```
Task.Factory.StartNew(() => AddAttachment(information.Subject, information.DocumentId.ToString(), information.Sender,list.Name))
            .ContinueWith(t => HandleException(t.Exception),
                          TaskContinuationOptions.OnlyOnFaulted); 
```

这样，只有在原始任务引发异常时才会调用延续。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T16:18:47.013

[Task.Exception](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.exception.aspx)属性将在任务完成后包含异常并出现异常，有关更多详细信息，请查看[此](http://msdn.microsoft.com/en-us/library/dd997415.aspx)

```
var task = Task.Factory.StartNew(...
...
task.Exception 
```

# sql - jOOQ 中的列大小

> ID：13976238
> 
> 赞同：3
> 
> 时间：2012-12-20T16:16:21.173
> 
> 标签：sql, jooq

使用`ResultSet`I can get `ResultSetMetaData`，我可以`varchar(15)`使用`metaData.getColumnDisplaySize(index)`. 有什么方法可以让我使用这个尺寸`jOOQ`吗？

由于`ResultSet`我对 UDT 有疑问，并且我已经在使用`jOOQ`它来访问数据库（并且它与 UDT 配合得很好），所以如果是的话那将是完美的

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T09:13:25.760

jOOQ 2.x API 不提供您要查找的元信息。`org.jooq.DataType`计划在即将发布的 3.0 版中为 API添加长度、精度和比例

这已注册为功能请求[#456](https://github.com/jOOQ/jOOQ/issues/456)

* * *

事实上，这已经在 github 上实现了，并将包含在 jOOQ 3.0 中。实现您正在寻找的内容所需的 API 用法如下所示（示例）：

```
int length = record.getField(0).getDataType().length(); 
```

本质上，`org.jooq.DataType`会有这三种方法：

```
int length();
int precision();
int scale(); 
```

# ubuntu - 如何赋予 NIS 用户默认的 ubuntu（桌面用户）组权限

> ID：13976242
> 
> 赞同：1
> 
> 时间：2012-12-20T16:16:23.827
> 
> 标签：ubuntu, redhat, nfs, nis

我的中央文件服务器正在运行`Redhat`，我已将此系统配置为通过 导出共享，`NFS`并使用`NIS`. 我已经设置了几个`Ubuntu`客户端并意识到`NIS`用户不属于任何标准`Ubuntu`组。本地用户通常属于以下组：

```
$ groups
user adm cdrom dip plugdev lpadmin sambashare 
```

但是，我的 NIS 用户仅属于以下组：

```
$ groups
user 
```

我显然可以将每个`NIS`用户添加到`Ubuntu`我正在使用的每个 Ubuntu 客户端上的所有标准组中，但这需要我保持所有系统都是最新的。

因此，我正在考虑将`NIS`NIS 服务器上的用户添加到适当的组中。`Redhat`不幸的是，组名和 id 在和之间不匹配`Ubuntu`。因此，虽然`plugdev`Ubuntu 系统上的组映射到组 ID `46`，但同一组可能`47`在我的`Redhat`服务器上具有 ID。

**因此我的问题是：**如何以最有效的方式匹配/映射用户组？理想情况下，每个新的 NIS 用户都将自动位于正确的 ubuntu 组中。（没有正确的组权限会导致无法 smbmount 等...）

**编辑**理想情况下，我会将每个`NIS`用户添加到一个特殊`NIS`组中，然后在 Ubuntu 客户端上将其翻译到组中`adm cdrom dip plugdev lpadmin sambashare`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:49:56.400

部分解决方案似乎是：

```
 $ sudo vi /etc/pam.d/common-auth

 # add line
 auth optional pam_group.so 
```

为所有经过身份验证的用户设置组权限（不是特定于 NIS）

```
 $ sudo vi /etc/security/group.conf

 # add line
 "*;*;*;Al0000-2400; audio,video,cdrom,plugdev,fuse" 
```

有更好的解决方案吗？

# php - 可捕获的致命错误：无法将类 Creator 的对象转换为字符串

> ID：13976243
> 
> 赞同：0
> 
> 时间：2012-12-20T16:16:36.697
> 
> 标签：php, class, object, fatal-error

我有这个函数可以在我的 file.php 中插入代码：

```
function InsertData($nombre, $var1, $var2, $var3)
{
    $file = fopen("$nombre".".php", "r+");
    // Seek to the end
    fseek($file, SEEK_END, 0);
    // Get and save that position
    $filesize = ftell($file);
    // Seek to half the length of the file
    fseek($file, SEEK_SET, $filesize / 1);
    // Write your data
    fwrite($file, "<?php
class " ."$nombre". "\n
{\n
private $" ."$var1;". "\n
private $" ."$var2;". "\n
private $" ."$var3;". "\n
\n\n
    public function __construct()\n
    {\n
        $this->setData($" ."$var1". ", $" ."$var2". ", $" ."$var3". ");\n
        //parent::__construct();\n

    }
\n\n
    public function setData($" ."$var1". ", $" ."$var2". ", $" ."$var3". ")\n
    {\n
        $this->" ."$var1". "= $" ."$var1;". "\n
        $this->" ."$var2". "= $" ."$var2;". "\n
        $this->" ."$var3". "= $" ."$var3;". "\n
    }
\n\n
    public function printData()
    {\n
        echo \"SomeThing : \" . $this->" ."var1". ". \" \" . $this->" ."var2". ".     \"\n\";\n
        echo \"Other : \" . $this->" ."var3". ". \"\n\";\n
    }
\n\n
}
\n\n
?>");
    // Close the file handler
    fclose($file);
} 
```

但是当我调用它时，我得到了这个错误： Catchable fatal error: Object of class Creator could not be convert to string in create.php on line 37

第 37 行是：

```
$this->" ."$var1". "= $" ."$var1;". "\n 
```

我在其他文件中这样称呼它：

```
$lol = new Creator();
$lol->CreateFile($input);
$lol->InsertData($input, $input1, $input2, $input3); 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T16:41:44.313

您为尝试生成的整个班级使用了错误的引号。尝试将双引号`"`改为单引号`'`。该错误是因为当您使用`"$this"`PHP 时试图调用`$this->__toString()`，在此上下文中`$this`仍然是来自外部代码的变量。使用`'$this'`（单引号）只不过是简单的字符串。

另一个解决方案应该是在之前添加反斜杠`$this`-`"\$this"`

# c# - 正确包含 x32 或 x64 System.Data.SQLite.dll 文件

> ID：13976248
> 
> 赞同：4
> 
> 时间：2012-12-20T16:16:51.673
> 
> 标签：c#, sqlite, system.data.sqlite

我在互联网上搜索它，但我不确定该怎么做。我发现我需要在我的 Program.csproj 文件中包含一些代码。

当我打开 Program.csproj 它说

```
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <ProjectView>ShowAllFiles</ProjectView>
  </PropertyGroup>

</Project> 
```

这是我需要包含的代码：

```
<Reference 
       Include="System, Version=1.0.66.0, Culture=neutral, processorArchitecture=MSIL"  
         Condition=" '$(Platform)' == 'AnyCPU' ">
      <SpecificVersion>False</SpecificVersion>
      <HintPath>library\sqlite\x32\System.Data.SQLite.dll</HintPath>
      <Private>False</Private>
    </Reference>
    <Reference 
         Include="System, Version=1.0.66.0, processorArchitecture=MSIL" 
         Condition=" '$(Platform)' == 'x64' ">
      <SpecificVersion>False</SpecificVersion>
      <HintPath>library\sqlite\x64\System.Data.SQLite.DLL</HintPath>
</Reference> 
```

但我不太确定这是否正确，因为我的程序正在从它的根目录中获取所有 dll，而不是从“library\sqlite\” 有人可以帮我正确地做吗？我只是无法正确

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T12:10:02.977

首先，我强烈建议您使用来自[http://system.data.sqlite.org的 v1.0.67+](http://system.data.sqlite.org)

```
http://system.data.sqlite.org/blobs/1.0.83.0/sqlite-netFx40-binary-Win32-2010-1.0.83.0.zip
http://system.data.sqlite.org/blobs/1.0.83.0/sqlite-netFx40-binary-x64-2010-1.0.83.0.zip 
```

因此，只需从两个档案之一（都包含相同的版本）中提取 AnyCPU 文件：

```
System.Data.SQLite.dll
System.Data.SQLite.Linq.dll 
```

而 x64 和 x86 文件 (SQLite.Interop.dll) 必须按如下方式复制。在 32 位操作系统上

*   来自 sqlite-netFx40-binary-Win32-2010-1.0.xx.0.zip 的文件进入 C:\Windows\system32

在 64 位操作系统上

*   x64 文件进入 C:\Windows\system32
*   Win32 进入 C:\Windows\SysWOW64

.NET 将自动“选择”要包含的正确互操作文件

# c# - 没有动态添加额外行的 GridView 的 RowCommand 事件

> ID：13976249
> 
> 赞同：2
> 
> 时间：2012-12-20T16:16:59.553
> 
> 标签：c#, .net, gridview, webforms

所以我有一个 GridView 控件。设置为数据源，分页为 20。

不过，在 RowDataBound 处理程序中，我为每个绑定行添加了一个额外的行，使其总共有 40 行。这些应该是详细信息行，用于数据绑定的行。添加这些行没有问题，并且网格按应有的方式显示。但是，网格下半部分的行中的按钮（最后 10 个数据绑定行、22、24 等）不会触发 RowCommand。我得到的只是一个空的回发，重新加载页面。我怀疑 gridview 只触发 20 行（在这种情况下，由于分页）的事件，因为问题从第 11 行开始（由于额外插入的行，实际上是第 22 行）。

如果我的假设是正确的，有没有办法解决这个问题？还是我必须重新设计我的解决方案以显示行详细信息？

# ios - 如何确保只有 UIScrollView 的某个部分出现滑动？

> ID：13976252
> 
> 赞同：0
> 
> 时间：2012-12-20T16:17:04.037
> 
> 标签：ios, uiscrollview, xamarin.ios

我使用启用了水平滑动的 UIScrollView。

滚动视图的标题是`Instructions for Using this App`

在此之下，我`instructions`每“页”有一条指令。

当用户水平滚动时，会显示新的指令。但是，在此水平滚动过程中，第二页中的“使用此应用程序的说明”似乎也移动了。

```
Instructions for Using this App     <--- I do not want this to appear to slide

1\. Instruction number 1\. XYZ...
   more text more text more text
   more text more text more text    <--- I want only this to slide 
```

如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:31:28.503

您可以将单独的 UIView（在您的情况下可能是 UILabel）放在 UIScrollView 之上，因此您的 UI 层次结构将类似于：

```
UIView (screen)
   UILabel (header)
   UIScrollView (scrolled content) 
```

# c# - CopyFileEx 包装器参数

> ID：13976253
> 
> 赞同：6
> 
> 时间：2012-12-20T16:17:10.647
> 
> 标签：c#, pinvoke

我最近不得不从使用更改`File.Copy()`为`CopyFileEx`，我正在努力寻找如何使用它。

经过大量谷歌搜索后，我发现[这个](http://msdn.microsoft.com/en-us/magazine/cc163851.aspx)不错的包装器可以使用它，但我需要的是获取当前文件的复制字节的进度，如果可能的话，计算复制我传递给它的所有文件的进度。

（我知道有些项目链接了进度条，`CopyFileEx`但我没有足够的经验来提取相关代码，我想使用这个包装器）。

大概只是通过将它与要复制的文件的总字节数进行比较，我会事先找到，并从中计算出百分比。

我目前的复制方法是

```
FileRoutines.CopyFile(new FileInfo("source.txt"), new FileInfo("dest.txt")); 
```

我坚持的是如何使用获取进度信息所需的参数来重载它。

```
public sealed class FileRoutines
{
    public static void CopyFile(FileInfo source, FileInfo destination)
    {
        CopyFile(source, destination, CopyFileOptions.None);
    }

    public static void CopyFile(FileInfo source, FileInfo destination, 
        CopyFileOptions options)
    {
        CopyFile(source, destination, options, null);
    }

    public static void CopyFile(FileInfo source, FileInfo destination, 
        CopyFileOptions options, CopyFileCallback callback)
    {
        CopyFile(source, destination, options, callback, null);
    }

    public static void CopyFile(FileInfo source, FileInfo destination, 
        CopyFileOptions options, CopyFileCallback callback, object state)
    {
        if (source == null) throw new ArgumentNullException("source");
        if (destination == null) 
            throw new ArgumentNullException("destination");
        if ((options & ~CopyFileOptions.All) != 0) 
            throw new ArgumentOutOfRangeException("options");

        new FileIOPermission(
            FileIOPermissionAccess.Read, source.FullName).Demand();
        new FileIOPermission(
            FileIOPermissionAccess.Write, destination.FullName).Demand();

        CopyProgressRoutine cpr = callback == null ? 
            null : new CopyProgressRoutine(new CopyProgressData(
                source, destination, callback, state).CallbackHandler);

        bool cancel = false;
        if (!CopyFileEx(source.FullName, destination.FullName, cpr, 
            IntPtr.Zero, ref cancel, (int)options))
        {
            throw new IOException(new Win32Exception().Message);
        }
    }

    private class CopyProgressData
    {
        private FileInfo _source = null;
        private FileInfo _destination = null;
        private CopyFileCallback _callback = null;
        private object _state = null;

        public CopyProgressData(FileInfo source, FileInfo destination, 
            CopyFileCallback callback, object state)
        {
            _source = source; 
            _destination = destination;
            _callback = callback;
            _state = state;
        }

        public int CallbackHandler(
            long totalFileSize, long totalBytesTransferred, 
            long streamSize, long streamBytesTransferred, 
            int streamNumber, int callbackReason,
            IntPtr sourceFile, IntPtr destinationFile, IntPtr data)
        {
            return (int)_callback(_source, _destination, _state, 
                totalFileSize, totalBytesTransferred);
        }
    }

    private delegate int CopyProgressRoutine(
        long totalFileSize, long TotalBytesTransferred, long streamSize, 
        long streamBytesTransferred, int streamNumber, int callbackReason,
        IntPtr sourceFile, IntPtr destinationFile, IntPtr data);

    [SuppressUnmanagedCodeSecurity]
    [DllImport("Kernel32.dll", CharSet=CharSet.Auto, SetLastError=true)]
    private static extern bool CopyFileEx(
        string lpExistingFileName, string lpNewFileName,
        CopyProgressRoutine lpProgressRoutine,
        IntPtr lpData, ref bool pbCancel, int dwCopyFlags);
}

public delegate CopyFileCallbackAction CopyFileCallback(
    FileInfo source, FileInfo destination, object state, 
    long totalFileSize, long totalBytesTransferred);

public enum CopyFileCallbackAction
{
    Continue = 0,
    Cancel = 1,
    Stop = 2,
    Quiet = 3
}

[Flags]
public enum CopyFileOptions
{
    None = 0x0,
    FailIfDestinationExists = 0x1,
    Restartable = 0x2,
    AllowDecryptedDestination = 0x8,
    All = FailIfDestinationExists | Restartable | AllowDecryptedDestination
} 
```

任何指针都非常感谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-20T16:26:27.700

包装器已经拥有处理进度所需的管道。只需在返回之前实现代码以在 CallbackHandler 中更新您的进度条。progressBar1.Maximum 默认为 100，因此下面的代码将计算百分比。

用这个替换你当前的 CopyFile 调用：

```
CopyFileCallbackAction myCallback(FileInfo source, FileInfo destination, object state, long totalFileSize, long totalBytesTransferred)
{
    double dProgress = (totalBytesTransferred / (double)totalFileSize) * 100.0;
    progressBar1.Value = (int)dProgress;
    return CopyFileCallbackAction.Continue;
}

FileRoutines.CopyFile(new FileInfo("source.txt"), new FileInfo("dest.txt"), myCallback); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-01T14:45:19.690

如果您只想显示文件副本的进度条，您可以这样[做](https://msdn.microsoft.com/en-us/library/cc165446%28v=vs.120%29.aspx)。它使用显示进度条和剩余时间的 Windows 标准对话框，并有一个取消按钮。这正是我在基本上一行代码中所需要的。

```
// The following using directive requires a project reference to Microsoft.VisualBasic. 
using Microsoft.VisualBasic.FileIO;

class FileProgress
{
    static void Main()
    {
        // Specify the path to a folder that you want to copy. If the folder is small,  
        // you won't have time to see the progress dialog box. 
        string sourcePath = @"C:\Windows\symbols\";
        // Choose a destination for the copied files. 
        string destinationPath = @"C:\TestFolder";

        FileSystem.CopyDirectory(sourcePath, destinationPath,
            UIOption.AllDialogs);
    }
} 
```

# html - 防止包含图像的 li 元素溢出

> ID：13976256
> 
> 赞同：2
> 
> 时间：2012-12-20T16:17:16.273
> 
> 标签：html, css, html-lists

我希望显示每行`ul`最多三个的。`li`每个都`li`包含一个垂直居中的宽度相等的图像，所以我认为这很容易。但是，我无法阻止它溢出：

![在此处输入图像描述](../Images/3769f0d7f2fddf9edcd1b3f420b95c70.png)

相反，我希望将第四张图像清除为新行。这是我的代码：

```
<ul>
    <li><a href="#"><img src="1.jpg"></a></li>
    <li><a href="#"><img src="2.jpg"></a></li>
    <li><a href="#"><img src="3.jpg"></a></li>
    <li><a href="#"><img src="4.jpg"></a></li>
</ul>​

ul {
    border-spacing: 2px;
    width: 150px;
    background: red;
}

li {
    height: 48px;
    background: #000;
    display:table-cell;
    vertical-align:middle;
}
img {
    width: 48px;
    display:block;
    vertical-align:middle;
}​ 
```

我该如何解决这个问题？

更新：这是一个带有更清晰示例的[jsfiddle 。](http://jsfiddle.net/UvnK5/4/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:21:32.530

您是否尝试设置溢出？

```
ul {
    border-spacing: 2px;
    width: 150px;
    background: red;
    overflow-x:hidden
} 
```

要让“溢出”移动到下一行，使你的 UL 与三个图像一样宽，在你的 li 上使用 float:left 并设置你的 li 的宽度。

```
ul {
    width:400px;
    margin-top:50px;
    margin-left:auto;
    margin-right:auto;
}

ul li {
    width:200px;
    height:200px;
    display:block;
    float:left;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T16:28:10.400

告诉`li`s 浮动[http://jsfiddle.net/8Pvtb/1/](http://jsfiddle.net/8Pvtb/1/)

```
li {

   height: 48px;
    background: #000;
    display:table-cell;
    float: left;
    vertical-align:middle;
    border-spacing: 12px;
} 
```

但我不明白你为什么想要`display:table-cell`，它不是。我会用`inline-block`

[http://jsfiddle.net/8Pvtb/5/](http://jsfiddle.net/8Pvtb/5/)

```
ul {
    border-spacing: 2px;
    width: 155px;
    background: red;
}

li {
    height: 48px;
    background: #000;
    display: inline-block;
    vertical-align:middle;
    border-spacing: 12px;
}
img {
    width: 48px;
    vertical-align:middle;
}​ 
```

# drupal-7 - Drupal 7 视图和规则操作集

> ID：13976257
> 
> 赞同：1
> 
> 时间：2012-12-20T16:17:16.197
> 
> 标签：drupal-7, vbo, drupal-rules

我创建了一个基于配置文件字段的视图，以显示特定角色的自定义搜索页面。显示搜索结果后，用户可以选择其中一个来发送通知。

为此，VBO 已与强制单一选项一起使用。当我尝试通过规则向所选用户发送电子邮件通知时遇到问题。

在我的批量操作设置下，我没有看到用于发送电子邮件的自定义规则操作。如果我尝试使用数据类型配置文件创建规则组件，我会得到批量操作下列出的操作，但不在我的页面上。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T19:39:20.583

通过为该特定用户角色启用执行规则的权限解决了该问题。默认情况下，仅为创建者（管理员）启用规则。

# ios - UIScrollview setContentSize 未设置

> ID：13976259
> 
> 赞同：1
> 
> 时间：2012-12-20T16:17:18.803
> 
> 标签：ios, uiwebview, uiscrollview

我有`UIScrollview`一些标签、图像、地图视图、表格视图和网络视图。

```
scr2 = [[UIScrollView alloc] initWithFrame:CGRectMake(i * 320, 0, 320, 335)];
scr2.delegate = self; 
```

i = 页数。

编辑：`scr2`是 a `UIScrollView`in a `UIScrollView`，这就是我使用`i * 320`x 位置的原因。

添加所有组件后，我设置`contentSize`：

```
[scr2 setContentSize:CGSizeMake(320, dateLabel.frame.size.height + nameLabel.frame.size.height + descWebView.frame.size.height + tableViewSize.height + addressLabel.frame.size.height + myMapView.frame.size.height + 100)]; 
```

UIWebView 在`webViewDidFinishLoad`.

```
- (void)webViewDidFinishLoad:(UIWebView *)aWebView
{ 
    aWebView.scrollView.scrollEnabled = NO;
    CGRect frame = aWebView.frame;

    frame.size.width = 301;
    frame.size.height = 1;

    aWebView.frame = frame;       
    frame.size.height = aWebView.scrollView.contentSize.height;    
    aWebView.frame = frame;       

    [scr2 setContentSize:CGSizeMake(320, dateLabel.frame.size.height + nameLabel.frame.size.height + descWebView.frame.size.height + tableViewSize.height + addressLabel.frame.size.height + myMapView.frame.size.height + 100)];
} 
```

所以在这里`descWebView`调整大小以适应内容。之后，我将滚动视图中的 设置`contentSize`为新的尺寸，从`descWebView`此时起具有适当的高度。

这是我的问题。滚动视图对`setContentSize`. 顺便说一句，我的身高没有问题，因为如果我将它设置`contentSize`为`0, 100`它也会被忽略。

/编辑

scr2 也不会对 scrollEnabled 或其他任何东西做出反应。

# android - 移动跨平台游戏引擎

> ID：13976260
> 
> 赞同：0
> 
> 时间：2012-12-20T16:17:20.493
> 
> 标签：android, cross-platform, cocos2d-x, limejs

我正在开发一款需要在 iO 和 Android 上运行的手机游戏（不是那么复杂）。我是该领域的新手，您对我应该选择哪个框架和游戏引擎有什么建议吗？

我做了一些研究，找到了一些申请者： - Cocos2d-x：C++游戏引擎，相当强大，但似乎太复杂了，我的项目需要2个月完成。- Limejs：HTML5 游戏引擎 - [CAAT 框架](http://hyperandroid.github.com/CAAT/)：它也是 HTML5。我尝试将它与phonegap一起使用，但它不起作用。

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:29:46.280

试试[移动游戏引擎](http://mobilegameengines.com)页面，该页面几乎列出了所有引擎。并阅读我的[游戏引擎约会指南](http://www.learn-cocos2d.com/2012/05/the-game-engine-dating-guide-how-to-find-the-right-engine-for-your-game/)。

简短的回答：忽略功能，选择**最有效率**的**引擎**。这意味着查看您的技能，并仅在最适合您技能的基础上比较游戏引擎。在大多数情况下，这将是您所使用的编程语言，但也许您更多的是设计师或艺术家类型，因此您可能更喜欢更可视化的游戏设计工具而不是编程 SDK。

理由：选择具有大量功能的 Uber-Engine 会适得其反，但如果您以前从未使用过 C++，则需要编写 C++ 代码。

作为初学者，您要确保在选择引擎或游戏创建工具时不会感到困惑。如果您几乎没有编程经验，请尝试使用带有 GUI 的游戏引擎，也许还可以支持轻量级脚本。它可能没有超酷的功能或者可能不是最快的，但最重要的是更接近完成你的第一个应用程序（并且更快地到达那里）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T19:24:26.510

我玩过一些很棒的使用[Unity](http://unity3d.com/)的 Android 游戏。可能还有其他人，但在我看到很棒的最终产品之前，我将永远忘记他们的存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T16:23:03.490

HTML5 不是一个好主意，太重了。

在这么短的时间里，如果你有基本的编程知识，也许 Unity3D 会是一个不错的选择，并且你可以为两者（IOS 和 Android）导出足够好的结果。

# arrays - 在不同的数据源（插件数组）上烘焙蛋糕控制台

> ID：13976261
> 
> 赞同：3
> 
> 时间：2012-12-20T16:17:20.450
> 
> 标签：arrays, cakephp, plugins, datasource

我已经安装了数据源插件 Array。它不使用 db 表作为数据源。它是一个数组（来源）。当我尝试使用蛋糕烘焙（或其他东西）进行烘焙时，它无法识别使用的数组源，只有我的数据库的表。

我想将数据源数据库表的所有 crud 操作烘焙为我的数组数据源。我怎样才能做到这一点？

提前

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2019-01-09T12:17:04.557

设置数据源后。如果您从可以看到`bin`文件夹的根目录运行 bake 命令。

这将为您提供表格列表

```
sudo bin/cake bake.bake model --connection OTHER_DATABASE_NAME 
```

假设我们要为`Users`餐桌烘焙

烘焙模型

```
sudo bin/cake bake.bake model TABLE_NAME --connection OTHER_DATABASE_NAME 
```

* * *

在 cakephp 3.x 中

如果您想手动执行此操作，您可以照常创建实体类和表类。然后在 UsersTable.php 中添加这个函数：

```
public static function defaultConnectionName()
    {
        return 'OTHER_DATABASE_NAME';
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T10:24:46.993

当您使用 Cake Bake （我认为其他控制台命令）时，cake 将查看 DATABASE_CONFIG 中的默认值，***除非***您使用“-c”选项。它允许您选择不同的数据连接。您可能默认设置为您的数据库和数组数据源的不同设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-04T17:55:20.710

尝试编辑你的文件 app.php：

```
 'Datasources' => [
    'default' => [
        'className' => 'Cake\Database\Connection',
        'driver' => 'Cake\Database\Driver\Mysql',
        'persistent' => false,
        'host' => 'aws.amazon-br.service',
        //'port' => 'non_standard_port_number',
        'username' => 'username',
        'password' => 'passaword',
        'database' => 'wp_my_site',
        'encoding' => 'utf8',
        'timezone' => 'UTC',
        'cacheMetadata' => true,
        'quoteIdentifiers' => false,
        'log' => false,
        //'init' => ['SET GLOBAL innodb_stats_on_metadata = 0'],
        'url' => env('DATABASE_TEST_URL', null),
    ],

    /**
     * The test connection is used during the test suite.
     */
    'my_system_db' => [
        'className' => 'Cake\Database\Connection',
        'driver' => 'Cake\Database\Driver\Mysql',
        'persistent' => false,
        'host' => 'hostgator.dbsource.manager',
        //'port' => 'non_standard_port_number',
        'username' => 'my_systen',
        'password' => 'secret_password',
        'database' => 'my_system',
        'encoding' => 'utf8',
        'timezone' => 'UTC',
        'cacheMetadata' => true,
        'quoteIdentifiers' => false,
        'log' => false,
        //'init' => ['SET GLOBAL innodb_stats_on_metadata = 0'],
        'url' => env('DATABASE_TEST_URL', null),
    ],
], 
```

保存 app.php 文件后，转到 yout pronpt 并使用以下格式的 bake 命令：

> 蛋糕烤所有 name_table -c name_your_connect

例子：

> 蛋糕烘焙所有用户 -c my_system_db

# c++ - 定制的“ofstream”输出

> ID：13976262
> 
> 赞同：2
> 
> 时间：2012-12-20T16:17:27.913
> 
> 标签：c++, inheritance, logging, filestream, filebuf

我必须扩展 ofstream 类来编写日志流服务。

目标是截取每一行，在每一行的开头添加自定义文本（日期/时间、严重性等）。

现在，很明显我不是 C++ 大师，所以我阅读了很多关于这个任务的文档，例如

[http://www.angelikalanger.com/Articles/Topics.html#CPP](http://www.angelikalanger.com/Articles/Topics.html#CPP) [http://asmodehn.wordpress.com/2010/06/20/busy-c-coding-and-testing](http://asmodehn.wordpress.com/2010/06/20/busy-c-coding-and-testing)
[http://gabisoft.free。 fr/articles-en.html](http://gabisoft.free.fr/articles-en.html)

上面的文章建议编写一个自定义流缓冲区，但是在将这个概念移植到文件流上时，我遇到了很多困难。

有没有更简单的方法来实现这个目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T22:36:47.317

您不需要编写自定义流缓冲区；最简单和最直接的方法是创建一个可以向其发送输出的类，方法是给它一个模板化的单参数运算符<<()：

```
template <typename T>
std::ostream& operator<<(const T& data_)
{
    m_outstream << m_severity << "\t" << getTimeStamp() << "\t" << data_;

    return m_outstream;
} 
```

其中 m_outstream 是某种类型的 std::ostream（std::ofstream 等）。m_severity 和 getTimeStamp() 是您可以插入的示例（您可以创建一个沼泽标准两个参数 operator<<() 来格式化严重性类型并将其输出到 ostream）。

然后，这允许您执行以下操作：

```
myLogger << "failingFunction(" << argument <<
            "): Could not do something." << std::endl; 
```

您将在 m_outstream 上获得如下输出：

> 警告 2012 年 1 月 3 日 19:32 失败函数（“参数值”）：无法做某事。

除此之外，您还需要一种设置严重性的方法，它可以像在您添加模板化操作符<<() 的记录器类上调用的方法一样简单。如果你想变得非常花哨，你可以编写你自己的操纵器，它的作用很像 setw() 在 std::ostream 上的作用。请参阅[http://www.math.hkbu.edu.hk/parallel/pgi/doc/pgC++_lib/stdlibug/man_6665.htm](http://www.math.hkbu.edu.hk/parallel/pgi/doc/pgC++_lib/stdlibug/man_6665.htm)了解编写操纵器的入门知识。

# wordpress - 网络管理员和其他链接上的 Wordpress 多站点错误 404

> ID：13976266
> 
> 赞同：1
> 
> 时间：2012-12-20T16:17:44.070
> 
> 标签：wordpress, mod-rewrite

嗨，我在我的域中全新安装了 Wordpress，配置为多站点。子文件夹设置。

问题是，右上角菜单上的网络管理员有这个链接[http://example.net/wp-admin/network/](http://example.net/wp-admin/network/)并返回错误 404... 我可以手动将它输入到[http://example.net/subfolder /wp-admin/network/](http://example.net/subfolder/wp-admin/network/)并且工作正常.. Add New 等其他链接也有这个问题......

我不擅长 .htaccess 但我认为问题就在那里......

你能检查一下吗

```
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]

# add a trailing slash to /wp-admin
RewriteRule ^wp-admin$ wp-admin/ [R=301,L]

RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]
RewriteRule ^(wp-(content|admin|includes).*) home/content/70/10156275/html/example.net/subfolder/$1 [L]
RewriteRule ^(.*\.php)$ home/content/70/10156275/html/example.net/subfolder/$1 [L]
RewriteRule . index.php [L] 
```

另外，不确定这是否有帮助，但我的 wp-config.php 有这个

```
/* Multisite */
define( 'MULTISITE', true );
define( 'SUBDOMAIN_INSTALL', true );
$base = '/';
define( 'DOMAIN_CURRENT_SITE', 'example.net' );
define( 'PATH_CURRENT_SITE', '/' );
define( 'SITE_ID_CURRENT_SITE', 1 );
define( 'BLOG_ID_CURRENT_SITE', 1 ); 
```

现在已经在谷歌搜索了 2 天，但无法解决这个问题......问题是网络管理中的子文件夹有些省略，还有一些......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-10-07T23:00:38.473

首先，我想帮助你，让你知道你需要设置`define('SUBDOMAIN_INSTALL', false );`

并不是

```
define('SUBDOMAIN_INSTALL', true ); 
```

，如果您使用的是子文件夹设置（而不是子域）。这也可以解决您的问题。

# java - 我们不能识别模态窗口中存在的元素吗？

> ID：13976268
> 
> 赞同：2
> 
> 时间：2012-12-20T16:18:06.270
> 
> 标签：java, selenium, webdriver, modal-dialog

我一直在使用 Java Robot 通过对其执行鼠标和键事件来处理模态窗口。但是有没有办法使用一些工具来实际识别模态窗口中存在的元素及其属性？，还有什么是机器人的替代品。提前致谢。

# vim - 获取当前文件的路径

> ID：13976270
> 
> 赞同：5
> 
> 时间：2012-12-20T16:18:11.687
> 
> 标签：vim

我正在使用此处第一个响应中的插件采购本地 vimrc：[Vim：对目录中的文件应用设置](https://stackoverflow.com/questions/456792/vim-apply-settings-on-files-in-directory)

现在我想做的是将此本地 vimrc 文件的当前路径添加到 vims 路径。

我知道这`%:p:h`给了我当前文件的路径。但它是正在打开的文件，而不是正在打开的配置文件。

```
let s:local_path = expand('%:p:h')
exec "set path+=".s:local_path 
```

有谁知道如何获取正在获取的文件的路径？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T00:19:29.407

而不是`%`，只需使用特殊的`<sfile>`; 在脚本中（但不在脚本中的函数内部！），它被扩展为源脚本的文件名：

```
:let s:local_path = expand('<sfile>:p:h') 
```

# ruby-on-rails - 在 Rails 中使用数据库列别名时出现 NoMethodError

> ID：13976273
> 
> 赞同：0
> 
> 时间：2012-12-20T16:18:20.453
> 
> 标签：ruby-on-rails, ruby, postgresql, activerecord, alias

当我尝试对聚合使用列别名时出现未定义的方法错误（PostgreSQL）

在我的模型里面：

```
class B2bLoginAttempt < ActiveRecord::Base
  set_table_name "b2b_logins"
end 
```

在我的控制器内部：

```
 @client_ip = request.env['REMOTE_ADDR']
    @sql = "select count(id) as failed_logins FROM b2b_logins WHERE ip_address = '"+@client_ip+"'"

    f = B2bLoginAttempt.find_by_sql(@sql)
    failed_attempts = f.failed_logins.to_s
    f.destroy 
```

然后我看到：#<Array:0x104d08478> 的未定义方法 `failed_logins'

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T16:26:31.320

发生错误是因为`find_by_sql`返回一个数组，所以你需要写`f.first.failed_logins.to_s`而不是`f.failed_logins.to_s`. [在这里](http://apidock.com/rails/ActiveRecord/Base/find_by_sql/class)查看`find_by_sql`文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T16:44:03.900

不确定我是否完全正确地遵循了你的逻辑，但看起来你可能会更好：

```
f = B2bLoginAttempt.where("ip_address = ?", @client_ip)

f.map(&:destroy) 
```

你可以得到实际的计数`f.count`

我错过了什么？

# android - java.io.FileNotFoundException：/temp.png：打开失败：EROFS（只读文件系统）

> ID：13976276
> 
> 赞同：1
> 
> 时间：2012-12-20T16:18:32.417
> 
> 标签：android

我一直在做一些实验、操作和导出位图，主要是在 Galaxy Nexus (Jellybean) 上。我一直遇到这个奇怪的错误，但找不到任何解决我的情况的答案 - 现在我已经弄清楚了，我想分享。

问题标题中列出的“EROFS”错误似乎最常发生在人们对文件名进行硬编码时。我正在正确使用 getExternalFilesDir(null)，但是当我调用 bmp.compress(Bitmap.CompressFormat.PNG, 90, fos); 时，这个问题继续发生。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:18:32.417

事实证明，当我在 ES File Explorer 之类的文件管理工具中打开该目录，然后卸载并重新安装该应用程序（删除由 getExternalFilesDir() 返回的应用程序特定目录）时，它会尝试在那里创建该目录是某种冲突，返回神秘的“打开失败：EROFS（只读文件系统”）错误，即使外部存储已安装用于写入并授予 WRITE_EXTERNAL_STORAGE 权限。

因此，如果您遇到此错误，请确保在卸载并重新安装开发中的应用程序时，没有在任何其他应用程序中打开该应用程序的文件夹。

# javascript - Jquery tablesorter在基本页面上失败

> ID：13976280
> 
> 赞同：0
> 
> 时间：2012-12-20T16:18:45.570
> 
> 标签：javascript, jquery, html, tablesorter

我有下面的代码，我一直在努力让它工作，以至于我从 tablesorter 网站复制了这个例子。谁能帮我解决我做错的事情？我已经关注了教程视频[http://www.youtube.com/watch?v=-wAWfPVXlME](http://www.youtube.com/watch?v=-wAWfPVXlME)

```
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Test Table</title>
    <link rel="stylesheet" type="text/css" href="testTable.css">
    <script src="jquery-1.8.3.min.js" type="text/javascript" ></script>
    <script src="jquery.tablesorter.pager.js" type="text/javascript" ></script> 

    <script type="text/javascript">
        $(document).ready(function() 
            {
                $("#myTable").tablesorter();
            }
        );
    </script>

    </head>

    <body>
        <h4>Table Testing</h4>

        <table id="myTable" class="tablesorter"> 
            <thead> 
                <tr> 
                    <th>Last Name</th> 
                    <th>First Name</th> 
                    <th>Email</th> 
                    <th>Due</th> 
                    <th>Web Site</th> 
                </tr> 
            </thead> 
            <tbody> 
                <tr> 
                    <td>Smith</td> 
                    <td>John</td> 
                    <td>jsmith@gmail.com</td> 
                    <td>$50.00</td> 
                    <td>http://www.jsmith.com</td> 
                </tr> 
                <tr> 
                    <td>Bach</td> 
                    <td>Frank</td> 
                    <td>fbach@yahoo.com</td> 
                    <td>$50.00</td> 
                    <td>http://www.frank.com</td> 
                </tr> 
                <tr> 
                    <td>Doe</td> 
                    <td>Jason</td> 
                    <td>jdoe@hotmail.com</td> 
                    <td>$100.00</td> 
                    <td>http://www.jdoe.com</td> 
                </tr> 
                <tr> 
                    <td>Conway</td> 
                    <td>Tim</td> 
                    <td>tconway@earthlink.net</td> 
                    <td>$50.00</td> 
                    <td>http://www.timconway.com</td> 
                </tr> 
            </tbody> 
        </table> 

    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T16:35:03.183

确保加载 tablesorter 核心：

```
<script src="jquery-1.8.3.min.js"></script>
<script src="jquery.tablesorter.js"></script> 
<script src="jquery.tablesorter.pager.js"></script> 
```

由于看起来您使用的是 HTML5，`type="text/javascript"`因此在 script 标签中不需要。

# nuget - 创建具有第三方依赖项的 nuget 包：何时内化？

> ID：13976283
> 
> 赞同：3
> 
> 时间：2012-12-20T16:18:50.763
> 
> 标签：nuget, nuget-package

如果您正在创建一个必须添加一些第三方依赖项的 NuGet 包，您基本上有 2 个选项：

1.  在包的 lib 文件夹中内部化 DLL。
2.  引用第三方库作为 nuspec 文件中的依赖项。

例如，我注意到 RavenDB 已经内化了所有第三方依赖项，而其他一些项目则明确依赖于其他 NuGet 包。

我想知道何时选择任何一种方法是否有任何最佳实践/提示。各有什么优缺点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T16:26:27.950

本着 NuGet 的良好精神，我建议添加对第三方包的依赖项，而不是内部化 DLL。NuGet 是围绕“依赖项”构建的，完全依赖这些是有意义的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T16:28:46.767

我敢说这更多地取决于您的实现是否是特定于版本的，以及是否有可能在更新和发布依赖项时，您的包是否可以从中受益（或者如果不推荐使用实现，可能会损坏）。

此外，通过使包具有 nuget 依赖项，您可以减少重复和目录大小（以及包大小）。更常见的库仅包含在您的项目中一次（但任何其他包也可能使用此库的好处，因为它已经包含在内）。

# python - 延迟等待异步 ndb 调用的最漂亮方法是什么？

> ID：13976284
> 
> 赞同：1
> 
> 时间：2012-12-20T16:18:57.487
> 
> 标签：python, google-app-engine, app-engine-ndb

```
deferred.defer(f,e)

function f(e):
  e.put_async() 
```

更改`e`在 SDK 中被丢弃，并且可能在生产中也被丢弃。解决问题的一种明显方法是存储所有 rpc 并 get_result() 它们，但这并不漂亮。

有没有办法让这个函数与ndb兼容？

这个函数在代码的多个部分都用到了，正常的请求都是`@ndb.toplevel`，所以对他们来说是没有问题的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T19:09:21.213

您延迟的函数不能是`@ndb.toplevel`，但您可以调用一个函数：

```
def f(e):
  g(e)

@ndb.toplevel
def g(e):
  e.put_async() 
```

# button - Corona SDK 反转按钮

> ID：13976286
> 
> 赞同：1
> 
> 时间：2012-12-20T16:19:01.943
> 
> 标签：button, coronasdk

我正在尝试为我的游戏制作一个按钮类。它具有白色背景和黑色文本。我希望它在按下时反转。

问题是绘图事件干扰了触摸事件，因为绘图事件设置了颜色，并且我在每个 enterFrame 调用绘图事件。如果我可以测试屏幕是否被触摸以及在 enterFrame 事件中被触摸的位置可以解决我的问题，但据我所知，测试这些东西的唯一方法是在触摸事件中。

我将如何完成反转？

这是我的代码：

```
--Button Class
local button = {}
local button_mt = { __index = button }  -- metatable

--button.new function
function button.new (x, y, width, height, text) -- constructor

    local newButton = {
    x = x,
    y = y,
    width = width,
    height = height,
    text = text,
    rect = display.newRoundedRect (x-width/2, y-height/2, width, height, 10),
    displayText = display.newText (text, x, y, native.systemFont, 16),
    inverted = false,
    timer = 5
    };

    return setmetatable( newButton, button_mt );
end

--Button activate function
function button:activate()
self.rect:addEventListener ("touch", self);
self.displayText:setTextColor (0, 0, 0);
end

--Button touch event
function button:touch (event)
if event.phase == "ended" or event.phase == "cancelled" then
    self.inverted = false;
else
    self.inverted = true;
end
end

--Button draw function
function button:draw()
self.displayText.x = self.x;
self.displayText.y = self.y;
self.rect.x = self.x;
self.rect.y = self.y;
self.rect.width = self.width;
self.rect.height = self.height;
self.displayText.text = self.text;
if self.inverted then
    self.displayText:setTextColor (255, 255, 255);
    self.rect:setFillColor (0, 0, 0);
else
    self.displayText:setTextColor (0, 0, 0);
    self.rect:setFillColor (255, 255, 255);
end
end

return button; 
```

编辑：好的，我到了某个地方，但现在你的手指必须移动才能保持倒立

现在差不多明白了。按钮反转并变回，但如果您触摸按钮并且不松开手指，将手指滑离按钮，它会保持反转状态。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T12:29:31.300

试试这个，setFocus 让系统把所有的触摸事件都扔到焦点上。当您在请求触摸或将触摸移入按钮后将焦点设置在按钮上时，焦点将被“劫持”，从现在开始，按钮将跟踪触摸，并且您在屏幕上移动手指的任何地方都将继续跟踪它.

只要你抬起手指，它就会触发“结束”阶段。

请注意，在屏幕上的任何地方抬起手指都会触发“结束”阶段，因此我建议您使用 event.target.contentBounds 来跟踪按钮的位置，检查手指是否在里面，并适当地将其视为真正的“结束” ”的事情或“取消”的事情自己。

```
function button:touch (event)
if event.phase == "ended" or event.phase == "cancelled" then
    display.getCurrentStage():setFocus(nil)
    self.inverted = false;
else
    display.getCurrentStage():setFocus(event.target)
    self.inverted = true;
end
end 
```

# shell - 返回值不是 $? 从 ssh 会话

> ID：13976289
> 
> 赞同：3
> 
> 时间：2012-12-20T16:19:18.783
> 
> 标签：shell, ssh

如何返回 $ 以外的值？来自 ssh 会话

例如：

```
x=5
echo "$x"
ssh -o StrictHostKeyChecking=no root@hostname "x=10"
echo "$x" 
```

这将打印

```
5
5 
```

但我需要新的价值

```
5
10 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-20T16:30:58.750

试试这个：

```
x=5 
echo "$x"
x=$(ssh -o StrictHostKeyChecking=no root@hostname 'x=10; echo $x')
echo "$x" 
```

这里发生的是您捕获远程执行的命令的输出，并将该输出分配给您的本地变量`x`。请注意，我使用单引号而不是双引号来引用远程命令：`'x=10; echo $x'`. `$x`在双引号中的字符串中，`x`在发送到远程主机之前会被 local 的值替换，所以你会得到 5 由远程命令打印并分配给你的 local `x`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T16:30:20.120

你可以这样做：

```
x=5
echo "$x"
ssh -o StrictHostKeyChecking=no root@hostname 'x=10; exit $x'
echo "$?" 
```

**解释：**

*   `'x=10; exit $x'`- 这些是您通过`ssh`远程运行的指令`root@hostname`。因此，您希望将它们括在单引号而不是双引号中，以防止`$x`在本地 shell 中自动扩展。
*   请注意这里的细微差别：`x`本地 shell 中**的**变量与通过会话`x`生成的远程 shell 中的变量不同。`ssh`
*   `$?`是一个特殊的 shell 变量，用于在本地 shell 中存储最近运行的命令的退出状态。由于我们告诉`ssh`会话退出`10`，这就是它打印的内容`echo "$?"`

# css - 我们可以在不改变整个 li 的情况下对有序列表中的数字进行样式化吗？

> ID：13976292
> 
> 赞同：4
> 
> 时间：2012-12-20T16:19:28.233
> 
> 标签：css

是否可以使用**CSS**更改 an 中数字的样式`<ol>`而不更改整个文本`<li>`而不在 li 内容周围添加额外标记？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T16:22:41.660

您可以禁用原始`<ol>`样式，然后使用`:before`带计数器的选择器添加您想要的任何样式。像[这里](http://jsfiddle.net/pVG75/1/)：

```
ol {
    counter-reset: i 0;
}
ol li:before {
    content: counter(i);    
    counter-increment: i;
    padding-right: 0.5em;
    color: red;
} 
```

如果您愿意，您甚至可以使用[nth-child](https://developer.mozilla.org/en-US/docs/CSS/%3anth-child)选择器（[JS Fiddle](http://jsfiddle.net/pVG75/3/)）覆盖列表中特定元素的某些样式：

```
ol li:nth-child(3):before {
    color: violet;
} 
```

...因为级联规则仍然在这里应用。但请注意，`nth-child`IE8 不支持该功能。

# scala - Scala 中 CDATA 中的变量

> ID：13976294
> 
> 赞同：14
> 
> 时间：2012-12-20T16:19:34.833
> 
> 标签：scala, cdata, scala-xml

有没有办法将要扩展的变量放在scala的cdata部分中

```
val reason = <reason><![CDATA[ {failedReason} ]]></reason> 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-03-14T13:59:17.747

它可能更简单：

```
val reason = <reason>{scala.xml.PCData(failedReason)}</reason> 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-12-20T16:37:56.483

我不确定您是否可以通过本机 XML 支持来获得它，但您可以执行以下操作：

```
scala.xml.XML.loadString("<reason><![CDATA[%s]]></reason>".format(failedReason)) 
```

这样会丢失一些编译时验证，但它应该为您提供带有您正在寻找的数据的 xml 元素。由于它返回 a `scala.xml.Elem`，因此您还可以将结果嵌入到更大的 XML 结构中。

**编辑**

在考虑了更多之后，以下可能是一种更好（并且不那么脆弱）的方式来做到这一点。它将自由文本部分限制为仅 CDATA，从而最大限度地减少表达不平衡的可能性。

```
<reason>{ scala.xml.Unparsed("<![CDATA[%s]]>".format(failedReason)) }</reason> 
```

# objective-c - Cocoa 在多个窗口中验证菜单项

> ID：13976298
> 
> 赞同：1
> 
> 时间：2012-12-20T16:19:52.163
> 
> 标签：objective-c, cocoa, first-responder

我有一个菜单项“foobar”，我需要在我的主窗口（应用程序委托）上启用，但在所有其他窗口上禁用。我想知道该怎么做，因为第一响应者的业务让我很困惑。这是我现在拥有的：

*   “foobar” 项目连接到 MainMenu.xib 中第一响应者的“foobar:”自定义操作
*   主应用程序委托中有一个“foobar：”操作，因此菜单项已启用并可以工作
*   现在我加载并“makeKeyAndOrderFront”另一个窗口
*   我把一些控制集中在那个新窗口上
*   这是我的“foobar”项目应该被禁用的地方，但它不是

我可以看到在应用程序委托中调用了“validateMenuItem”，但在第二个窗口的控制器中没有调用它。

有人可以用非常简单的术语向我解释为什么会发生这种情况以及我必须有哪些选择来解决这个问题？

谢谢你的想法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T17:27:22.207

将您的应用程序委托设置为主窗口的委托，并实现以下方法：

```
- (void)windowDidBecomeKey:(NSNotification *)notification
{
    [foobar setEnabled: YES];
}

- (void)windowDidResignKey:(NSNotification *)notification
{
    [foobar setEnabled: NO];
} 
```

**关于第一响应者**

第一响应者是窗口内的 NSControl。例如，在特定窗口上，您有两个文本字段：textField1 和 textField2。当您键入时，输入只会发送给第一响应者（接受第一响应者的所有控件之间的一个） ). 所以你需要知道哪个窗口是关键，你不需要知道在你的具体情况下谁是第一响应者。

**编辑**

还有另一种（可能更快，但取决于个人喜好）的方法：通过界面生成器，选择要启用的菜单项，仅当某个窗口为key时才启用。假设这个窗口是一个ivar名为 window1 的应用程序委托。然后单击该菜单项，转到绑定检查器，在“启用”下选择绑定到：应用程序委托，模型键路径：self.window.isKeyWindow。

一点图像提示：

![在此处输入图像描述](../Images/df072487322491689bf9f2c93f9f6d68.png)

# javascript - javascript 循环推送

> ID：13976299
> 
> 赞同：0
> 
> 时间：2012-12-20T16:19:56.423
> 
> 标签：javascript, loops, push

当我尝试将元素推送到 javascript 数组中时，它不起作用。这是我能想到的最简单的示例。为什么这不起作用？

```
 <!DOCTYPE html>
    <html>
    <body>

    <script>
    var i;
    var mycars = new Array();

    for(i=1;i<=10;i++){
      mycars.push[ i.toString()+"-" ];
    }

    alert(mycars.join(""));

    </script>

    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:20:45.633

[`push`](http://www.ecma-international.org/ecma-262/5.1/#sec-15.4.4.7)是一个函数。`()`你用, not调用函数`[]`：

```
mycars.push( i.toString()+"-" );
// here ---^     and here ----^ 
```

您可能感到困惑的地方是，您可以在不使用 的情况下添加到数组中`push`，只需分配给数组元素，即使该元素尚不存在。例如，您的循环可能如下所示：

```
for(i=1;i<=10;i++){
  mycars[mycars.length] = i.toString()+"-";
} 
```

在那里，因为我指的是数组元素 ( `mycars[mycars.length]`)，而不是调用函数，所以我使用`[]`.

旁注：而不是`var mycars = new Array();`，只写`var mycars = [];`。它做同样的事情，但更简洁，不易产生副作用。

# vim - vim 将 C-TAB/CS-TAB 映射到 :bn 和 :bp

> ID：13976302
> 
> 赞同：3
> 
> 时间：2012-12-20T16:20:14.213
> 
> 标签：vim

我正在使用 NerdTree 和 MiniBufExplorer，我只想使用 Ctrl-Tab 和 Ctrl-Shift-Tab 在我的文件之间切换。

我已经尝试了 [map,remap,noremap,imap] <C-TAB> :bn<Return> 的所有组合

没有成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T13:35:19.650

您可能还想检查我制作的这个插件：[Bufstop](https://github.com/mihaifm/bufstop.git)

它比`:bn`and更好，`:bp`因为它使用最近使用的缓冲区。

# java - 池空。无法在 10 秒内获取连接

> ID：13976305
> 
> 赞同：10
> 
> 时间：2012-12-20T16:20:25.753
> 
> 标签：java, tomcat, jdbc

运行一段时间后，当我使用至少 20 个浏览器选项卡同时访问 servlet 对我的 servlet 进行压力测试时，出现此错误：

**java.sql.SQLException：[tomcat-http--10] 超时：池为空。无法在 10 秒内获取连接，无可用 [size:200; 忙：200；空闲：0；最后等待：10000]。**

这是用于此的 XML 配置：

```
<Resource name="jdbc/MyAppHrd"
          auth="Container"
          type="javax.sql.DataSource"
          factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"
          testWhileIdle="true"
          testOnBorrow="true"
          testOnReturn="false"
          validationQuery="SELECT 1"
          validationInterval="30000"
          timeBetweenEvictionRunsMillis="30000"
          maxActive="200"
          minIdle="10"
          maxWait="10000"
          initialSize="200"
          removeAbandonedTimeout="120"
          removeAbandoned="true"
          logAbandoned="false"
          minEvictableIdleTimeMillis="30000"
          jmxEnabled="true"
          jdbcInterceptors="org.apache.tomcat.jdbc.pool.interceptor.ConnectionState;
            org.apache.tomcat.jdbc.pool.interceptor.StatementFinalizer"
          username="sa"
          password="password"
          driverClassName="net.sourceforge.jtds.jdbc.Driver"
          url="jdbc:jtds:sqlserver://192.168.114.130/MyApp"/> 
```

可能是什么问题呢？

**更新：Java代码：**

```
public class MyServlet extends HttpServlet {

    private static final long serialVersionUID = 1L;
    private static final Log LOGGER = LogFactory.getLog(MyServlet.class);

   private void doRequest(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {

        CallableStatement stmt = null;
        ResultSet rs = null;

        Connection conn = null;
        try {

            conn = getConnection();

            stmt = conn.prepareCall("{call sp_SomeSPP(?)}");
            stmt.setLong(1, getId());

            rs = stmt.executeQuery();

            // set mime type
            while (rs.next()) {
                if (rs.getInt(1)==someValue()) {
                    doStuff();
                    break;
                }
            }
            stmt = conn.prepareCall("{call sp_SomeSP(?)}");
            stmt.setLong(1, getId());

            rs = stmt.executeQuery();
            if (rs.next()) {
                // do stuff
            }

            RequestDispatcher rd = getServletContext().getRequestDispatcher("/SomeJSP.jsp");
            rd.forward(request, response);
            return;
        } catch (NamingException e) {
            LOGGER.error("Database connection lookup failed", e);
        } catch (SQLException e) {
            LOGGER.error("Query failed", e);
        } catch (IllegalStateException e) {
            LOGGER.error("View failed", e);
        } finally {
            try {
                if (rs!=null && !rs.isClosed()) {
                    rs.close(); 
                }
            } catch (NullPointerException e) {
                LOGGER.error("Result set closing failed", e);
            } catch (SQLException e) {
                LOGGER.error("Result set closing failed", e);
            }
            try {
                if (stmt!=null) stmt.close();
            } catch (NullPointerException e) {
                LOGGER.error("Statement closing failed", e);
            } catch (SQLException e) {
                LOGGER.error("Statement closing failed", e);
            }
            try {
                if (conn != null){
                    conn.close();
                    conn = null;
                }
            } catch (NullPointerException e) {
                LOGGER.error("Database connection closing failed", e);
            } catch (SQLException e) {
                LOGGER.error("Database connection closing failed", e);
            }
        }

   }

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        doRequest(request, response);
    }

    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        doRequest(request, response);
    }

    protected static Connection getConnection() throws NamingException, SQLException {
        InitialContext cxt = new InitialContext();
        String jndiName = "java:/comp/env/jdbc/MyDBHrd";
        ConnectionPoolDataSource dataSource = (ConnectionPoolDataSource) cxt.lookup(jndiName);
        PooledConnection pooledConnection = dataSource.getPooledConnection();
        Connection conn = pooledConnection.getConnection();
        return conn; // Obtain connection from pool
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T17:32:32.037

我建议您将 getConnection 方法更改为以下内容，您实际上可能会通过直接通过 javax.sql.PooledConnection 接口删除池支持

```
 InitialContext cxt = new InitialContext();
        String jndiName = "java:/comp/env/jdbc/MyDBHrd";
        DataSource dataSource = (DataSource) cxt.lookup(jndiName);
        return dataSource.getConnection(); 
```

还可以使用[DBUtils#closeQuietly 之](http://commons.apache.org/dbutils/apidocs/org/apache/commons/dbutils/DbUtils.html#closeQuietly%28java.sql.Connection,%20java.sql.Statement,%20java.sql.ResultSet%29)类的东西来清理您的连接

更新：您正在从连接中删除池支持。如果您运行以下命令并查看输出，您将看到直接从 DataSource 检索的连接是包装了 PooledConnection 的 ProxyConnection。

```
public static void main(String[] args) throws Exception {

    Properties properties = new Properties();
    properties.put("username", "sa");
    properties.put("password", "password");
    properties.put("driverClassName", "net.sourceforge.jtds.jdbc.Driver");
    properties.put("url", "jdbc:jtds:sqlserver://192.168.114.130/MyApp");       

    DataSourceFactory dsFactory = new DataSourceFactory();      
    DataSource ds = dsFactory.createDataSource(properties);     
    ConnectionPoolDataSource cpds = (ConnectionPoolDataSource) ds;
    PooledConnection pooledConnection = cpds.getPooledConnection();

    System.out.println("Pooled Connection - [" + ds.getConnection() + "]"); // Close will return to the Pool
    System.out.println("Internal Connection - [" + pooledConnection.getConnection() + "]"); // Close will just close the connection and not return to pool

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-20T16:42:28.140

可能，您保持连接的时间过长。

确保在开始处理请求时不打开数据库连接，然后在最终提交响应时释放它。

典型的错误是：

```
 @Override
    protected void doGet (
            final HttpServletRequest request,
            final HttpServletResponse response
        ) throws
            ServletException,
            IOException
    {
        Connection conn = myGetConnection( );

        try
        {
            ...
            // some request handling

        }
        finally
        {
            conn.close( )
        }
    } 
```

在这段代码中，数据库连接的生命周期完全取决于连接到服务器的客户端。

更好的模式是

```
 @Override
    protected void doGet (
            final HttpServletRequest request,
            final HttpServletResponse response
        ) throws
            ServletException,
            IOException
    {
        // some request preprocessing
        MyProcessedRequest parsedInputFromRequest =
            getInputFromRequest( request );

        final MyModel model;
        {
           // Model generation
           Connection conn = myGetConnection( );

           try
           {
              model = new MyModel( conn, parsedInputFromRequest );
           }
           finally
           {
              conn.close( );
           }
        }

        generateResponse( response, model );         
    } 
```

请注意，如果瓶颈在于模型生成，您仍然会用完连接，但这现在是 DBA 的一个问题，这与数据库端更好的数据管理/索引有关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T16:47:36.180

在以下之前关闭您的连接。

```
RequestDispatcher rd = getServletContext().getRequestDispatcher("/SomeJSP.jsp");
        rd.forward(request, response);
        return; 
```

如果不需要，也删除 return。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T16:34:23.160

检查您的 jdbc 连接在完成过程后是否关闭。它可能是由未关闭的连接引起的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-20T18:53:57.307

首先，您没有在方法主体内关闭`Statement`和对象。`ResultSet`

当您调用时它们*应该*被清理（根据 JDBC 规范），但在池设置中，它们实际上可能不会被清理。`close``Connection`

其次，您正在解开池连接并返回将破坏一切的底层连接。

所以，修改你的代码是这样的：

```
 try {
        conn = getConnection();

        stmt = conn.prepareCall("{call sp_SomeSPP(?)}");
        stmt.setLong(1, getId());

        rs = stmt.executeQuery();

        // set mime type
        while (rs.next()) {
            if (rs.getInt(1)==someValue()) {
                doStuff();
                break;
            }
        }

        // ADD THESE LINES
        rs.close(); rs = null;
        stmt.close(); stmt = null;

        stmt = conn.prepareCall("{call sp_SomeSP(?)}");
        stmt.setLong(1, getId());

        rs = stmt.executeQuery();
        if (rs.next()) {
            // do stuff
        }
}

....

protected static Connection getConnection() throws NamingException, SQLException {
    InitialContext cxt = new InitialContext();
    String jndiName = "java:/comp/env/jdbc/MyDBHrd";
    DataSource dataSource = (DataSource) cxt.lookup(jndiName);
    return dataSource.getPooledConnection();
} 
```

而且，正如其他人所说，您肯定希望在执行诸如转发到另一个页面之类的操作*之前*清理您的资源。否则，您保持连接的时间会比必要的时间长得多。它是一种关键资源：像对待它一样对待它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-20T17:13:57.970

您当前提供的代码看起来很长/很复杂，但很好。

但是，我猜您的“doStuff”方法可能是泄漏更多连接的候选者

# jquery - JQuery：是否在 $(document).ready() 中声明了变量；全球人？什么时候可以避免全局变量？

> ID：13976306
> 
> 赞同：6
> 
> 时间：2012-12-20T16:20:25.753
> 
> 标签：jquery

全局变量的概念开始固化。函数之外的任何变量都是全局变量，对吗？**如果变量包含在 中`$(document).ready( function() { *code* } );`，它们是否被认为是全局的？**

我想出了一个解决方法，将一个经常使用的数组放入使用该数组的函数中，但现在我基本上将我的 HTML 内容用作我的全局变量，如果这有意义的话（例如，在 div 中使用文本并将其传递给功能）。这是人们通常如何不断改变/经常引用的变量吗？

如果它们不是全局变量，我是否仍应将变量包含在函数中以开发良好实践？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T16:28:44.160

不，它们被认为是函数内部的**局部**范围。

检查一下 JavaScript 范围：[https ://stackoverflow.com/a/500459/1538708](https://stackoverflow.com/a/500459/1538708)

通过函数确定变量的范围是一种很好的做法，尤其是当您想通过[最小化](https://developers.google.com/closure/compiler/)程序运行代码时。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-20T16:41:56.480

中包含的变量`$(document).ready`不是全局的。当你在函数中声明一个变量时，它的作用域就是函数，那么一旦函数结束，这个变量就不再存在了。

```
var myGlobal = "foo";

$(document).ready(function(){
    var myVar = 42; // myVar will only exist in this scope
    $.myVar = 42; // $.myVar will be accessible anywhere since you have access to '$' object
    // care, this variable will be accessible anywhere
    // if you declare a variable with the same name but omit to add the "var" first, it will work without any error (unless you have "use strict")
    myGlobal = "bar";
}); 
```

尽可能避免使用全局变量。不要创建一个包含所有你需要的“上帝对象”，你的代码只会更难阅读和理解。

你也可以看看[`"use strict"`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Functions_and_function_scope/Strict_mode)。

# php - 这是在 MySQL 中获取记录的最快方法吗

> ID：13976307
> 
> 赞同：0
> 
> 时间：2012-12-20T16:20:37.350
> 
> 标签：php, mysql, latency

我有这个查询：

```
SELECT * FROM tablename WHERE
((samaccountname_s='".$sender."' AND samaccountname_r='".$contact."') OR
(samaccountname_s='".$contact."' AND samaccountname_r='".$sender."'))
ORDER BY timestamp ASC 
```

而且它非常慢，我认为一些延迟可能取决于服务器，但我不禁认为有一个更有效的查询来获得我在上面寻找的结果。

简而言之：查询检查两个人之间是否有消息（`$sender`和`$contact`）

这可以更有效/更快地完成吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:29:19.297

将索引放在`samaccountname_s`和上`samaccountname_r`。由于您在一个查询中同时检查两者，请将它们放在同一个索引中。像这样

```
ALTER TABLE mytable add INDEX sam_index (samaccountname_s, samaccountname_r); 
```

或者像这样

```
CREATE INDEX sam_index ON mytable (samaccountname_s, samaccountname_r); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T16:24:06.510

您应该向表中添加一些索引。至少你会想要索引`samaccountname_s`and`samaccountname_r`字段。像这样：

```
ALTER TABLE tablename ADD INDEX IDX_tablename_samaccountname_s (samaccountname_s);
ALTER TABLE tablename ADD INDEX IDX_tablename_samaccountname_r (samaccountname_r); 
```

索引时间戳列也可能会有所帮助，因为您通过以下方式在订单中使用它：

```
ALTER TABLE tablename ADD INDEX IDX_tablename_timestamp (timestamp); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T16:24:35.870

您可能缺少索引。

基本上，从性能的角度来看，索引使大量数据搜索变得可行。列并不总是被索引的唯一原因是因为索引也会减慢插入速度，尽管幅度不大。一个好的一般规则是在您通常搜索的字段上保留索引，例如外键等。

这是关于如何创建索引的 MySQL 文章：http: [//dev.mysql.com/doc/refman/5.0/en/create-index.html](http://dev.mysql.com/doc/refman/5.0/en/create-index.html)

您应该在查询中编制索引的列是：

*   samaccountname_s
*   samaccountname_r
*   时间戳

希望能帮助到你！

PS：您确实应该转义该查询中的值。考虑切换到 PDO（http://php.net/manual/en/ref.pdo-mysql.php），或者至少使用手动转义： http: [//php.net/manual/en/function。 mysql-real-escape-string.php](http://php.net/manual/en/function.mysql-real-escape-string.php)

# ssl - 意外的 302/从 HTTPS 重定向到 HTTP 导致“不安全的内容”javascript 错误

> ID：13976313
> 
> 赞同：2
> 
> 时间：2012-12-20T16:20:47.723
> 
> 标签：ssl, devise, ruby-on-rails-3.2, extjs4.1

我有一个 ExtJS 4.1 应用程序，它带有一个 Ruby on Rails 3.2 后端，使用 Devise（启用 Timeoutable）进行身份验证、会话管理。

此问题发生在仅通过 SSL 提供应用程序的服务器上。Nginx 将任何非安全请求重定向到 https url。

问题是当设计会话超时时，在我的情况下，在 15 分钟后，任何 AJAX 请求都会被发送/重定向到http://myapp.com/controller?params **，**而不是**https://myapp.com/controller** ?params，就像它通常会做的那样。

我有客户端代码，在非 SSL 设置中可以很好地捕捉潜在的会话过期问题，并重定向到登录页面并显示会话已超时的消息。这是一种基于以下事实的黑客攻击：在会话超时后发出请求时，会返回“无效的 JSON 字符串”错误消息。该错误包含登录页面的 HTML，因为当用户登录时应该是 json 的响应变成了应用程序应该在会话超时时重定向到的登录页面。这段代码在我的*Ext.application*的*启动*方法中：

```
launch:                             function () {

    Ext.Error.handle = function (err) {

        $.post('/logs', {message:err.msg});

        if (err.msg.indexOf("invalid JSON String") != -1 && err.msg.indexOf("<!DOCTYPE html>") != -1) {

            if (err.msg.indexOf("MyApp_Login") != -1)
                document.location.href = "/logout?timeout=1";
            else
                document.location.href = "/logout?error=1";

        } else {

            gritter(3, "ERROR:", "A client-side error has occurred. If this issue persists, please contact your system administrator.");

            if (Ext.isWebKit) console.log(err);

        }

    }

    if (user_signed_in == true) {

        Ext.require('MyDesktop.App');
        Ext.require('Ext.tab.*');

        _myDesktopApp = Ext.create('MyDesktop.App');

        Ext.state.Manager.setProvider(Ext.create('Ext.state.CookieProvider'));

    }

} 
```

正如我上面所说，应用程序通过非安全套接字检测到一个控制器请求（或更准确地说是响应），表明会话超时，并采取适当的措施。但是在我的服务器上，通过 SSL，由于某种原因，一旦会话过期，控制器调用最终会通过 http 而不是 https。在 Chrome 中导致这样的错误：

```
The page at https://server.myapp.com/ displayed insecure content from http://server.app.com/campaign_components_contacts.json?authenticity_token=1vokGHUpsi5w3b3P8mrfUpEGx19hrHJpsCzPayofM7c%3D&campaign_id=2&component_id=2&contact_id=1536&format=json 
```

这可能是 ExtJS 的一个功能，当通过 SSL 检测到问题时它会尝试非安全调用？还是 Rails 的一些特性？我确定两者都不是，只是把我脑海中浮现的一些事情扔掉。

编辑：

通过使用带有**--ssl**开关的**Thin**，我已经能够在开发环境中本地测试场景。服务器启动后，我浏览到

 **```
https://localhost:3000 
```

没有问题。一旦设计会话到期，任何 json 请求都会触发重定向到登录，正如预期的那样并通过 http 工作。

所以这个问题中描述的问题只出现在我的服务器上，并且可能与我的 NGINX 配置的设置方式有关。

我还将在本地预编译应用程序并使用 prod 环境选项运行，以确保它与 dev 和 prod 之间的区别无关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T07:20:07.973

哇，原来与设计会话超时、Rails 或 ExtJS 无关。

最终通过调整 NGINX 配置解决了这个问题，根据文档，这对于所使用的版本应该是正确的，但结果却导致了这个问题。

当前的 ssl 服务器位：

```
server {
            listen 443;
            ssl on;
            ssl_certificate      /srv/ssl/server.myapp.com.combined.crt;
            ssl_certificate_key  /srv/ssl/server.myapp.com.key;
            server_name server.myapp.com;
            root /var/www/myapp/current/public;
            passenger_enabled on;
            rails_env myapp_staging;
    } 
```

在我有之前：

```
server {
            listen 443 ssl;
            ssl_certificate      /srv/ssl/server.myapp.com.combined.crt;
            ssl_certificate_key  /srv/ssl/server.myapp.com.key;
            server_name server.myapp.com;
            root /var/www/myapp/current/public;
            passenger_enabled on;
            rails_env myapp_staging;
    } 
```

区别在于分手

```
listen 443 ssl; 
```

进入：

```
listen 443;
ssl on; 
```**

# php - file_get_contents()、wget、ping 或 curl 超时

> ID：13976322
> 
> 赞同：-1
> 
> 时间：2012-12-20T16:21:06.320
> 
> 标签：php, networking, cron, wget, ping

我遇到了一个从未见过的奇怪问题。我已经在特定域的 PHP 中使用 file_get_contents() 运行了 6 个月的 cron 作业，并且运行良好。现在，突然，连接几乎每次运行都会超时，但不是每次都超时。有时有效，有时无效。我可以通过我的个人浏览器访问该 URL，也可以通过浏览器访问多台其他计算机。

我们在 URL 上尝试了 wget，它为该 URL 识别了 4 个 IP 地址。其中1人为wget工作。其他3个没有。

平没有工作。

Curl 的响应与 file_get_contents() 一样。有时有效，有时无效。

我不是网络人，但我猜这是网络问题？你认为问题是什么？

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T16:41:23.940

正如您在对问题的评论中所说，您的合作伙伴似乎使用 4 个无效 IP 地址中的 3 个进行循环 DNS。您的 DNS 解析器有 75% 的机会获得错误的 IP，并且可能还会缓存它。

您的合作伙伴需要修复损坏的 DNS 条目，一切都应该再次正常工作。同时，我建议使用工作 IP 地址。

**编辑**

由于您似乎可以在家中使用所有 4 个 IP，因此存在一些可能的问题区域：

*   DNS：运行`nslookup your-partners-site.com`并比较您在机器上获得的输出。

*   路由：对每个 IP 运行跟踪路由并比较输出。

*   防火墙：您知道的服务器之间是否有任何类型的防火墙？

您可能需要您的合作伙伴的帮助，以确保这不是一个不对称的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T16:27:43.780

我曾经遇到过这个问题，我可以修复使用 curl 请求发送 HTTP-User-Agent 的问题。我从我的浏览器中使用了用户代理，从那时起它就可以正常工作了。

干杯

# css - 100% 的高度不适用于侧边导航

> ID：13976325
> 
> 赞同：0
> 
> 时间：2012-12-20T16:21:13.497
> 
> 标签：css, twitter-bootstrap

对于我的生活，我无法让我的侧导航扩展到我的页面底部。我已经用谷歌搜索了这个并查看了许多其他与此相关的堆栈溢出问题，但没有任何帮助。

人们建议在父 div 上设置一个高度，因为 height: 100%; 不知道100%是什么。但是父母的身高怎么知道100%是什么？

我也不能使用任何“固定”或“绝对”定位，因为这似乎完全破坏了 Twitter Bootstrap 的响应能力。

这是我的代码：

```
 <div id="secondary">
    <div class="span10" style="background-color: #860038; min-height: 100%; overflow: hidden;">
      <ul class="side-nav">

        <?php if (!empty($secondary_menu)): ?>

            <?php foreach ($secondary_menu as $key => $menu): ?>

                <?php $active = ($this->uri->segment(2,'index') == $key)? 'side-box-active': 'side-box'; ?>

                <li class="<?= $active ?>"><a href="<?= base_url().$primary_menu.'/'.$menu['link']?>"><?= $menu['label']?></a></li>
            <?php endforeach ?>
        <?php endif ?>
      </ul>
    </div>
</div> 
```

所以上面的代码在我的应用程序中动态地创建了我的侧边导航。我正在使用 Twitter Bootstrap，在 div class="span10" 上，我将背景颜色设置为侧导航和最小高度：100%。（也溢出：隐藏）。

目前正在做的是创建我的容器，但它会在导航停止时立即切断，而不是扩展到页面底部。

如您所见，我设置了一个 ID="secondary" 的父 div，以备不时之需。

屏幕截图显示了侧面导航。我需要栗红色来扩展我的屏幕底部。从头开始，它可以让您发布图片然后解释它们，然后告诉您您不能发布图片:) 抱歉，我猜没有图片。

感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T16:23:09.943

为了使 100% 的高度起作用，父元素也需要 100% 的高度，包括`html`和`body`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T07:21:07.883

不确定您是否解决了问题，但如果有人没有：当您有一个背景图像或颜色要在页面中一直重复，但在该页面中您有不同长度的列时，唯一的实现这一点的方法是将背景图像或颜色放在容器中，然后容器将容纳不同长度的列。所述列将根据您放入其中的内容量向下扩展。容器内最长的 div 将使背景图像重复-y（向下）或颜色。

所以你的结构看起来像这样：

```
<div id="container"> <!--which is the #1 element in your body--> 
<div id="leftcolumn"> Your side-nav would go here</div>    
<div id="rightcolumn">Your main content which is usually longer 
than the menu will go here</div>
</div><!-- end container--> 
```

显然，在这种情况下，您的页眉和页脚 div 将放置在容器 div 之外，并且可能需要进入另一个包装器 div 以保持所有内容居中。

例如，使用以下 CSS，它就可以正常工作：

```
<style> 
html,
body {
  height:100%;
   background-color : #103C52; /* or whatever you like*/
}
#container {
  height:100%;
  background-color: green; /* or whatever you like*/
}
#leftcolumn {
  height:100%;
  width: 16.67%; /* or whatever you like*/
  background-color: red; /* or whatever you like*/
  float: left;
}
#rightcolumn {
  height:100%;
  width: 80%; /* or whatever you like*/
  overflow-x: hidden; /* or whatever you like*/
  overflow-y: scroll; /* or whatever you like*/
  background-color: blue; /* or whatever you like*/
  float: left;
}

</style> 
```

如果不清楚，请发布您到目前为止所拥有的内容，我会看看它......;）

# r - R中的约束优化设置约束

> ID：13976326
> 
> 赞同：2
> 
> 时间：2012-12-20T16:21:18.380
> 
> 标签：r, optimization, mathematical-optimization, maximization

我一直在尝试使用 constrOptim() （我的第一次）解决 R 中的约束优化问题，但我正在努力为我的问题设置约束。

问题很简单，我可以设置函数，但是对于传递约束有点不知所措。

例如我定义的问题是（我将从固定在 1000 的 N 开始说所以我只想解决 X 最终我想选择 N 和 X 的最大利润）：

所以我可以将功能设置为：

```
fun <- function(x, N, a, c, s) {   ## a profit function
    x1 <- x[1]
    x2 <- x[2]
    x3 <- x[3]    
    a1 <- a[1]
    a2 <- a[2]
    a3 <- a[3]
    c1 <- c[1]
    c2 <- c[2]
    c3 <- c[3]
    s1 <- s[1]
    s2 <- s[2]
    s3 <- s[3]  
    ((N*x1*a1*s1)-(N*x1*c1))+((N*x2*a2*s2)-(N*x2*c2))+((N*x3*a3*s3)-(N*x3*c3))
} 
```

我需要实施的约束是：

```
x1>=0.03
x1<=0.7
x2>=0.03
x2<=0.7
x3>=0.03
x2<=0.7
x1+x2+x3=1 
```

这里的 X 表示我需要优化分配 N 的存储桶，因此 x1=N 的百分比以放置在存储桶 1 中，以此类推，每个存储桶至少有 3% 但不超过 70%。

非常感谢任何帮助...

例如，这是我用来测试该功能是否符合我要求的示例：

```
 fun <- function(x, N, a, c, s) {   ## profit function
        x1 <- x[1]
        x2 <- x[2]
        x3 <- x[3]    
        a1 <- a[1]
        a2 <- a[2]
        a3 <- a[3]
        c1 <- c[1]
        c2 <- c[2]
        c3 <- c[3]
        s1 <- s[1]
        s2 <- s[2]
        s3 <- s[3]  
        ((N*x1*a1*s1)-(N*x1*c1))+((N*x2*a2*s2)-(N*x2*c2))+((N*x3*a3*s3)-(N*x3*c3))
    };

    x <-matrix(c(0.5,0.25,0.25));

    a <-matrix(c(0.2,0.15,0.1));

    s <-matrix(c(100,75,50));

    c <-matrix(c(10,8,7));

    N <- 1000;

fun(x,N,a,c,s); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T17:12:34.487

您可以使用 lpSolveAPI 包。

```
## problem constants
a <- c(0.2, 0.15, 0.1)
s <- c(100, 75, 50)
c <- c(10, 8, 7)
N <- 1000

## Problem formulation
# x1          >= 0.03
# x1          <= 0.7
#     x2      >= 0.03
#     x2      <= 0.7
#          x3 >= 0.03
# x1 +x2 + x3  = 1
#N*(c1- a1*s1)* x1 + (a2*s2 - c2)* x2 + (a3*s3-  c3)* x3

library(lpSolveAPI)
my.lp <- make.lp(6, 3) 
```

在 lp solve 中构建模型的最佳方法是按列；

```
#constraints by columns
set.column(my.lp, 1, c(1, 1, 0, 0, 1, 1))
set.column(my.lp, 2, c(0, 0, 1, 1, 0, 1))
set.column(my.lp, 3, c(0, 0, 0, 0, 1, 1))
#the objective function ,since we need to max I set negtive max(f) = -min(f)
set.objfn (my.lp, -N*c(c[1]- a[1]*s[1], a[2]*s[2] - c[2],a[3]*s[3]-  c[3]))
set.rhs(my.lp, c(rep(c(0.03,0.7),2),0.03,1))
#constraint types 
set.constr.type(my.lp, c(rep(c(">=","<="), 2),">=","=")) 
```

看看我的模型

```
my.lp
Model name: 

 Model name: 
             C1     C2     C3          
Minimize  10000  -3250   2000          
R1            1      0      0  >=  0.03
R2            1      0      0  <=   0.7
R3            0      1      0  >=  0.03
R4            0      1      0  <=   0.7
R5            1      0      1  >=  0.03
R6            1      1      1   =     1
Kind        Std    Std    Std          
Type       Real   Real   Real          
Upper       Inf    Inf    Inf          
Lower         0      0      0      
 solve(my.lp)

[1] 0    ## sucess :)

get.objective(my.lp)
[1] -1435
get.constraints(my.lp)
[1] 0.70 0.70 0.03 0.03 0.97 1.00
## the decisions variables
get.variables(my.lp)
[1] 0.03 0.70 0.27 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T11:11:39.267

嗨，以防万一，我还找到了如下答案：

首先，您的目标函数可以使用向量运算更简洁地编写：

```
> my_obj_coeffs <- function(N,a,c,s) N*(a*s-c)

> fun <- function(x,N,a,c,s) sum(my_obj_coeffs(N,a,c,s) * x) 
```

您正在尝试求解线性程序，因此您可以使用单纯形算法来求解它。在'boot'包中有一个轻量级的实现。

```
> library(boot)

> solution <- function(obj) simplex(obj, diag(3), rep(0.7,3), diag(3), rep(0.03,3), rep(1,3), 1, maxi=TRUE)

Then for the example parameters you used, you can call that solution function:

> a <- c(0.2,0.15,0.1)
> s <- c(100,75,50)
> c <- c(10,8,7)
> N <- 1000
> solution(my_obj_coeffs(N,a,c,s))

Linear Programming Results

Call : simplex(a = obj(N, a, s, c), A1 = diag(3), b1 = rep(0.7, 3), 
    A2 = diag(3), b2 = rep(0.03, 3), A3 = matrix(1, 1, 3), b3 = 1, 
    maxi = TRUE)

Maximization Problem with Objective Function Coefficients
      [,1]
[1,] 10000
[2,]  3250
[3,] -2000
attr(,"names")
[1] "x1" "x2" "x3"

Optimal solution has the following values
  x1   x2   x3 
0.70 0.27 0.03 
The optimal value of the objective  function is 7817.5. 
```

# javascript - Javascript - 是否使用 onload 事件

> ID：13976335
> 
> 赞同：3
> 
> 时间：2012-12-20T16:21:39.807
> 
> 标签：javascript, onload

我正在编写一个脚本，该脚本将作为插件在多个网站上使用。我必须只使用 Javascript，没有框架。我在问自己，什么是加载我的脚本而不会对可以在这些网站上加载的其他脚本或框架造成任何问题的最佳方式。我想做一个全局函数，在其中调用我想使用的函数，然后将此函数放在 window.load 事件上，如下所示：

```
<script>
    var global = function(){
    object.domain.function1();
    object.domain.function2(param1, param2);
    object.domain.function3(1);
}
(function(){
    if(document.addEventListener){
        document.addEventListener('load',global, false);
    }
    if(document.attachEvent){
        document.attachEvent('onload',global);
    }
})();
</script> 
```

或者简单地说：

```
<script>
    object.domain.function1();
    object.domain.function2(param1, param2);
    object.domain.function3(1);
</script> 
```

当然，我需要在我的页面上加载一些元素。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T16:29:51.493

如果您可以将 javascript 放入`<body>`标签中，那么在整个页面加载后运行 javascript 的一种相当可靠的方法是将您的 javascript 放入`<script>`页面最底部的标签中。

这不是我处理此问题的首选方式，但如果使用该`onload`事件对您来说不太合适，这将是一个很好的下一步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T17:02:24.057

> 什么是加载我的脚本而不会对其他脚本或框架造成任何问题的最佳方法

你需要考虑的事情是，你..

*   污染命名空间
*   阻碍另一个脚本

第二点很容易解决，[`.addEventListener`](https://developer.mozilla.org/en/docs/DOM/element.addEventListener)支持为同一事件添加多个不会相互覆盖的侦听器。您可能对两种不同的事件感兴趣，`'load'`on`window`和[`'DOMContentLoaded'`](https://developer.mozilla.org/en-US/docs/Mozilla_event_reference/DOMContentLoaded_%28event%29)on `document`。你总是可以把 a`<script>`放在最后，`<body>`但我个人不喜欢这样做，因为你正在将 HTML 与 JavaScript 混合或更改 DOM 树。

对于第一点，这可以通过使用匿名函数来完成，如果您需要占用命名空间，请将所有变量和方法保存在一个对象中以最小化您的影响。

把所有这些放在一起，你最终可能会得到这样的东西

```
var myObjectName = { // everything in one object in global namespace
    domain: {
        function1: function () { /*...*/ },
        function2: function () { /*...*/ },
        function3: function () { /*...*/ }
    }
};

(function (fn) {
    if (window.addEventListener) {
        window.addEventListener('load', fn, false);
    }
    else if (window.attachEvent) { // Consider if support for `.attachEvent` is really necessary, people need to move on.
        window.attachEvent('onload', fn);
    }
})(function () { // pass your function anonymously
    myObjectName.domain.function1();
    myObjectName.domain.function2(param1, param2);
    myObjectName.domain.function3(1);
}); 
```

# sql - 与加入 MS Access 数据库相关的问题

> ID：13976336
> 
> 赞同：0
> 
> 时间：2012-12-20T16:21:41.757
> 
> 标签：sql, database, ms-access

我在 MS Access 数据库中使用以下查询：

```
SELECT SD.RollNo, SD.Name , ED.ExamName, (
    SELECT count(*) 
    FROM (
        SELECT DISTINCT innerED.StudentId 
        FROM ExamDetails innerED 
        WHERE innerED.StudentId=SD.StudentId 
    )
) AS StudentId
FROM StudentDetails SD 
LEFT OUTER JOIN ExamDetails ED 
    ON SD.StudentId= ED.StudentId 
```

每当我执行此查询时，都会出现一个对话框并询问参数 SD.StudentId 的值。为什么它要求这样做，我该如何阻止它这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T00:55:44.520

MS Access 不理解 Count (*) 聚合上的 SELECT 语句。访问 SQL 语句如下所示。

```
 SELECT DISTINCT innerED.StudentId
 FROM ExamDetails innerED 
 WHERE innerED.StudentId=SD.StudentId 
```

因为别名 AS STUDENTID 出现在语句的结尾之后，所以这个 Select 语句无法识别它，所以它不知道 .StudendID 是什么，所以它假定它是一个参数。

MS Access，当遇到查询本身未识别的参数时，会提示用户输入值。

重写查询，以便此 Select 语句可以识别所有表源。

# javascript - 使用文件对话框获取客户端文件的完整文件路径

> ID：13976338
> 
> 赞同：4
> 
> 时间：2012-12-20T16:21:47.447
> 
> 标签：javascript, jquery

我正在尝试允许用户将图片上传到服务器。

我正在尝试为任何具有“附加”文件或“上传图像”功能的网站创建一个类似的系统。我只需要通过文件对话框获取文件选择的完整路径。

我尝试将其用于文件对话框但没有成功：

```
<input type="file"> 
```

由于安全原因，此方法不提供完整的文件路径。我的问题是如何创建与 tinypic、photobucket 等网站类似的输入对话框，以帮助用户将给定图像的完整文件路径输入到输入字段中？

我知道出于安全原因，使用上述方法无法做到这一点，但是，我之前在各种网站上看到过这样做没有任何问题，我想知道我必须做些什么来实现一个类似的文件对话框来帮助填写输入字段的完整文件路径文本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T18:02:49.710

**无法使用浏览器和 javascript 在本地计算机上获取文件完整路径。**

但是，由于您想将文件上传到服务器，我看到的最简单的可能性是使用 html 表单和`input type file`. 提交表单后，您将在 http 服务器上收到该文件。

这是一个很好的网址[http://www.cs.tut.fi/~jkorpela/forms/file.html](http://www.cs.tut.fi/~jkorpela/forms/file.html)很好地解释了整个过程。

# c# - 将文本从 word 文件复制到新词

> ID：13976339
> 
> 赞同：9
> 
> 时间：2012-12-20T16:21:51.030
> 
> 标签：c#, .net, .net-4.0, ms-word, office-interop

我正在从 word 文件中读取文本并从读取的文本中替换一些文本。

```
var wordApp = new Microsoft.Office.Interop.Word.Application();
object file = path;

object nullobj = System.Reflection.Missing.Value;

var doc = wordApp.Documents.Open(ref file, ref nullobj, ref nullobj,
                                                 ref nullobj, ref nullobj, ref nullobj,
                                                 ref nullobj, ref nullobj, ref nullobj,
                                                 ref nullobj, ref nullobj, ref nullobj);
 doc.ActiveWindow.Selection.WholeStory();

doc.ActiveWindow.Selection.Copy();

IDataObject data = Clipboard.GetDataObject();
var text =data.GetData(DataFormats.Text); 
```

所以我有来自原始单词文件的文本，现在我需要将它传递给一个不存在的新单词文件（新文本）。

我试过了

```
 ProcessStartInfo startInfo = new ProcessStartInfo();
 startInfo.FileName = "WINWORD.EXE";
 Process.Start(startInfo); 
```

这会打开没有物理保存在文件系统中的新 word 文件，这很好。但我不确定如何将文本值传递给这个新文件。

**更新**

运行上面的代码后，我尝试了

```
 var wordApp = new Microsoft.Office.Interop.Word.Application();            
 var doc = wordApp.ActiveDocument; 
```

出现 ***“此命令不可用，因为没有打开文档”。***

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T14:38:05.257

您需要做的就是：

```
using System.Runtime.InteropServices;
using MSWord = Microsoft.Office.Interop.Word;

namespace ConsoleApplication6
{
    class Program
    {
        static void Main()
        {
            var application = new MSWord.Application();
            var originalDocument = application.Documents.Open(@"C:\whatever.docx");

            originalDocument.ActiveWindow.Selection.WholeStory();
            var originalText = originalDocument.ActiveWindow.Selection;

            var newDocument = new MSWord.Document();
            newDocument.Range().Text = originalText.Text;
            newDocument.SaveAs(@"C:\whateverelse.docx");

            originalDocument.Close(false);
            newDocument.Close();

            application.Quit();

            Marshal.ReleaseComObject(application);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-21T12:49:37.887

这是一个简单的示例，它将整个文本和格式从一个 Word 文档复制到一个新文档。在新文档中，然后使用单词*查找和替换*功能替换文本：

```
using System;
using System.Linq;
using Word = Microsoft.Office.Interop.Word;

namespace WordCopy
{
    class Program
    {
        static void Main(string[] args)
        {
            var fileName = args[0];

            var wordApp = new Word.Application();
            wordApp.Visible = true;
            var document = wordApp.Documents.Open(fileName);

            var newDocument = CopyToNewDocument(document);

            SearchAndReplaceEverywhere(newDocument, "this", "that");
        }

        static Word.Document CopyToNewDocument(Word.Document document)
        {
            document.StoryRanges[Word.WdStoryType.wdMainTextStory].Copy();

            var newDocument = document.Application.Documents.Add();
            newDocument.StoryRanges[Word.WdStoryType.wdMainTextStory].Paste();
            return newDocument;
        }

        static void SearchAndReplaceEverywhere(
            Word.Document document, string find, string replace)
        {
            foreach (Word.Range storyRange in document.StoryRanges)
            {
                var range = storyRange;
                while (range != null)
                {
                    SearchAndReplaceInStoryRange(range, find, replace);

                    if (range.ShapeRange.Count > 0)
                    {
                        foreach (Word.Shape shape in range.ShapeRange)
                        {
                            if (shape.TextFrame.HasText != 0)
                            {
                                SearchAndReplaceInStoryRange(
                                    shape.TextFrame.TextRange, find, replace);
                            }
                        }                        
                    }
                    range = range.NextStoryRange;
                }
            }
        }

        static void SearchAndReplaceInStoryRange(
            Word.Range range, string find, string replace)
        {
            range.Find.ClearFormatting();
            range.Find.Replacement.ClearFormatting();
            range.Find.Text = find;
            range.Find.Replacement.Text = replace;
            range.Find.Wrap = Word.WdFindWrap.wdFindContinue;
            range.Find.Execute(Replace: Word.WdReplace.wdReplaceAll);
        }
    }
} 
```

# ember.js - Ember.Object.create 不再支持定义调用 _super 的方法

> ID：13976340
> 
> 赞同：2
> 
> 时间：2012-12-20T16:21:55.073
> 
> 标签：ember.js

为什么？

我刚刚从 master 分支构建了 emberjs（现在）。我没有找到任何信息，为什么他们禁用了对 _super 的支持...

有人可以让我更聪明吗？:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T18:39:44.177

这里问了一个类似的问题：

[Ember.Application.create 带有 mixin 和参数](https://stackoverflow.com/questions/13856755/ember-application-create-with-mixin-and-parameters)

如果您使用 createWithMixin，您将获得相同的功能。可以在 github 中的此提交中找到更多详细信息：

[https://github.com/emberjs/ember.js/commit/c1c720781c976f69fd4014ea50a1fee652286048](https://github.com/emberjs/ember.js/commit/c1c720781c976f69fd4014ea50a1fee652286048)

# build - 神秘的 TFS 构建错误 - 错误？

> ID：13976341
> 
> 赞同：1
> 
> 时间：2012-12-20T16:22:03.090
> 
> 标签：build, tfs, continuous-integration

任何人都可以理解这个 TFS 构建错误吗？谷歌搜索产生的结果很少，我的研究没有给我一个解决方案。

> 找不到方法：'无效 Microsoft.TeamFoundation.TestManagement.Client.ModuleCoverage.set_Statistics（Microsoft.TeamFoundation.TestManagement.Client.CoverageStatistics）'。

对于以前的构建，我遇到了同样的错误，我更改`Analyze Test Impact`为`False`，然后构建工作。不过，这在这里行不通。

这甚至意味着什么？它是一个错误吗？有谁知道如何修理它？

我试图解决这个问题：

![我试图解决这个问题](../Images/3afbc2f9b3549bcd429b08dc024121b6.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T18:10:38.610

我没有得到这个确切的错误，但我得到了一个类似的错误，由于签名错误和缺少方法，内置方法失败，因为有人在我的一台服务器上安装了 Visual Studio 2012。我的猜测是 2012 年附带的新 TFS DLL 是 GAC 的，并且优先于 2010 年的 dll。我会验证这也没有发生在你身上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T14:48:12.930

看来原始问题中显示的错误并不是真正的问题。我们现在已经通过两种不同的解决方案、两种不同的方式解决了这个问题。

在第一个解决方案中，通过修复 CA 错误，构建成功。

在第二个解决方案中，通过修复构建后事件中的语法，构建成功。

我认为整个问题是一个错误表明这不是真正的问题。我不确定为什么该`method not found`错误会成为症状，但这不是原因。

实际上，该`method not found`错误仍然显示在构建日志中，但构建成功，所以有时你只需要继续......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-04T10:41:00.667

我在 webview 中收到此错误，但在构建日志文件中没有，并且构建没有失败。应用 TFS 2010 SP1 补丁为我修复了它。

# matlab - 如何在 matlab 中使用“菜单”功能执行逻辑功能？

> ID：13976347
> 
> 赞同：3
> 
> 时间：2012-12-20T16:22:31.597
> 
> 标签：matlab

对于如下所述的情况，

```
a=3; b=4; c=5;
k = menu ('choose','a','b','c'); 
```

如果用户选择`a`如何为其分配值并进行逻辑循环？例如，

```
if 'a'; x=a;
else if 'b'; x=b;
else if 'c'; x=c;
end 
```

然后我可以使用分配的 x 的值继续我的计算。例如，

```
w=x+5 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:39:22.850

`k`是用户选择的数量。在你的情况下：

```
switch (k) 
    case 1
       x = a;
    case 2
       x = b;
    case 3
       x = c;
    otherwise
       fprintf(1, 'do not know what to do - user closed menu w/o selection\n');
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T16:37:13.347

您可以使用返回的输出值`k`，如下所示：

```
if k == 1; x=a;
else if k == 2; x=b;
else x=c;
end 
```

`k`是显示菜单中按钮索引的整数。

但相反，我会做如下的事情：

```
values = [3 4 5];
k = menu('choose','a','b','c');
if k > 0
   x = values(k);
else
   error('You should provide an option.') 
```

# jquery - 完全呈现的自动完成没有回调

> ID：13976348
> 
> 赞同：0
> 
> 时间：2012-12-20T16:22:32.620
> 
> 标签：jquery, jquery-ui, jquery-ui-autocomplete

浏览文档后，API 中似乎没有任何用于检测自动完成小部件呈现后的内容，那么我该怎么做呢？只要结果发生变化并且需要重新渲染菜单，就会进行渲染。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:38:41.770

[`.create()`](http://api.jqueryui.com/autocomplete/#event-create)呈现自动完成时会触发事件。这行得通吗？

**编辑：**

听起来您可能想要[`.change()`](http://api.jqueryui.com/autocomplete/#event-change)or[`.response()`](http://api.jqueryui.com/autocomplete/#event-response)事件。

**编辑2：**

我认为您实际上是在寻找[`.open()`](http://api.jqueryui.com/autocomplete/#event-change)每次打开*或更新*建议菜单时触发的事件。

# c# - Ajax 请求后来自 .NET 后端的奇怪响应

> ID：13976349
> 
> 赞同：2
> 
> 时间：2012-12-20T16:22:36.740
> 
> 标签：c#, asp.net, .net, ajax, extjs

我正在尝试熟悉 ASP .net，所以在“hello world”之后，我尝试添加一些简单的后端请求处理。所以我正在做一个从我的页面到asp页面的Ajax请求：

```
 Ext.Ajax.request({
        type: 'POST',
        url: 'http://http://localhost:49852/Default.aspx',
        params: {
            html        : {'array': document.body.innerHTML}
        },
        success : function(response){
        console.log('RESPONSE !', response);
            //me.onSuccess(response, callback, errback);
        },
        failure : function(response){
            console.log('RESPONSE FAIL !', response);
        }
    }); 
```

这是我的页面：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="_Default" %> 
```

以及它背后的代码（我不确定结构是否应该看起来像这样，但我无法找到任何不使用表单的请求处理示例）：

```
using System;
using System.Data;
using System.Configuration;
using System.Collections;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Web.UI.HtmlControls;

public partial class _Default : System.Web.UI.Page{
    protected void Page_Load(object sender, EventArgs e){
        if (this.Request["html"] != null){
            this.Response.Write("{'success': true, 'msg': 'Its working'}");
       }
        else{
            this.Response.Write("{'success': false, 'msg': 'Error in request data.'}");
        }
    }
} 
```

现在，如果我在浏览器中访问此地址，则会显示正确的（错误）文本。但是当我尝试使用 XHR 请求时，我在 Firebug 控制台中根本看不到任何请求，并且在“网络”选项卡中我得到“选项”响应：

![在此处输入图像描述](../Images/ee9dace0cab8f98d08a9d0414211f399.png)

登录到控制台时如下所示：

![在此处输入图像描述](../Images/0d013859c9070615360338d9032be21c.png)

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T22:29:11.947

你的网址是错误的。这是：

```
http://http://localhost:49852/Default.aspx 
```

什么时候应该：

```
http://localhost:49852/Default.aspx 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T14:29:05.697

尝试使用[`WebService`](http://msdn.microsoft.com/en-us/library/system.web.services.webservice.aspx)标记为[`SciptService`](http://msdn.microsoft.com/en-us/library/vstudio/system.web.script.services.scriptserviceattribute%28v=vs.110%29.aspx)而不是页面。

这是来自 MSDN 的示例：

```
[WebService(Namespace = "http://tempuri.org/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[ScriptService]
public class SimpleWebService : System.Web.Services.WebService 
{
    [WebMethod]
    [ScriptMethod]
    public string GetServerTime() 
    {
        string serverTime =
            String.Format("The current time is {0}.", DateTime.Now);

        return serverTime;
    }
} 
```

# vim - 使用 MinGW 构建 vim

> ID：13976355
> 
> 赞同：4
> 
> 时间：2012-12-20T16:22:58.890
> 
> 标签：vim, mingw, build-process

我正在尝试通过`./configure && make`在 vim 存储库根目录中运行来使用 MinGW 构建 vim，但出现以下错误：

```
checking --with-tlib argument... empty: automatic terminal library selection
checking for tgetent in -ltinfo... no
checking for tgetent in -lncurses... no
checking for tgetent in -ltermlib... no
checking for tgetent in -ltermcap... no
checking for tgetent in -lcurses... no
no terminal library found
checking for tgetent()... configure: error: NOT FOUND!
      You need to install a terminal library; for example ncurses.
      Or specify the name of the library with --with-tlib.
C:\pdev\MinGW\bin\sed.exe: -e expression #1, char 1: unknown command: `C' 
```

在研究这个问题时，我[在 vim_use Google Groups 上看到了这篇文章](https://groups.google.com/forum/?fromgroups=#!topic/vim_use/dhJ2HEz0JGU)，它描述了完全相同的问题。它有一个回复，建议搜索 MinGW curses 包。我找到[了 MinGW packages 的存储库](http://sourceforge.net/projects/mingwrep/files/?source=navbar)，但那里没有 ncurses。此外，它们真的很旧——最新的更新于 2003 年。

如果我切换到`src`目录并`make`从那里运行，则构建过程将启动并完成但出现错误。它会生成一些可执行文件（gvim.exe、vim.exe 和更多）并将它们转储到 中`src`，但不会创建正确的分发。

完整发行版的目标位于根 Makefile 中，例如`dosbin_gvim`，但在尝试构建此目标时出现错误：

```
$ make dosbin_gvim
rm -rf dist/gvim73.zip
rm -rf dist/vim
mkdir dist/vim
mkdir dist/vim/vim73
tar cf - \
        README_bindos.txt uninstal.txt  \
        | (cd dist/vim/vim73; tar xf -)
find dist/vim/vim73 -type f -exec vim -e -X -u no_title.vim -c ":set tx|wq" {} \;
cp gvim.exe dist/vim/vim73/gvim.exe
cp: cannot stat `gvim.exe': No such file or directory
make: *** [dosbin_gvim] Error 1 
```

使用用文件夹中的东西构建的 exe `runtime`，我可能自己拼凑出一个发行版，但它会很笨拙且脆弱。我宁愿知道是什么导致了这些错误，以及如何修复它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T19:44:26.427

在 Windows 上构建 Vim 非常令人沮丧。**不要**使用`configure`. 您应该`Make_ming.mak`直接使用，例如：

```
make -f Make_ming.mak ARCH=x86-64 OPTIMIZE=MAXSPEED STATIC_STDCPLUS=yes FEATURES=HUGE GUI=yes OLE=yes NETBEANS=no PYTHON="D:/Applications/Python 2.7.3" PYTHON_VER=27 DYNAMIC_PYTHON=yes PYTHON3="D:/Applications/Python 3.2.3" PYTHON3_VER=32 DYNAMIC_PYTHON3=yes gvim.exe 
```

很可能，您必须修补`Make_ming.mak`，因为它包含许多细微的错误。例如，`"D:/Applications/Python 3.2.3"`如果不打补丁，指定（如上所示）将不起作用，因为`Make_ming.mak`希望您指定不带空格的路径。还有其他烦人的问题，但我不想在这里详细介绍它们。

如果您正在寻找全新的 64 位版本的 Vim for Windows，那么我建议您尝试直接从 Bram 的源代码编译的我的**[Vim for Windows](https://bitbucket.org/Haroogan/vim-for-windows)**，它包括对 Python 2 和 Python 3 的支持。

**注意：**我使用**[MinGW-w64](http://mingw-w64.sourceforge.net/)**构建了它。

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-19T20:18:11.303

我刚刚在 MinGW 上编译了 VIM 并做了一个**[要点](https://gist.github.com/rpuntaie/8510218)**。为了配置运行，您将需要

```
 mingw-get install mingw32-libpdcurses 
```

然后你可以做

```
 ./configure --with-tlib=pdcurses 
```

但无济于事，因为`make`不会做它的工作。

**[要点](https://gist.github.com/rpuntaie/8510218)**将引导您到 gvim74.exe，您可以使用它来安装，就像下载的一样。

# javascript - 即使值为假，“真”评估也会运行

> ID：13976359
> 
> 赞同：3
> 
> 时间：2012-12-20T16:23:08.673
> 
> 标签：javascript, jquery, boolean-expression

我有一个非常简单的 jquery 需要检查从 ajax 调用返回的布尔值，并设置一个复选框来检查它是否为真。

```
console.log("loc: " + r.location.defaultLocation);
if( r.location.defaultLocation == true ) {
    $('#loc-default').attr('checked',true);
} 
```

这在打开模式表单的 onclick 函数中运行 - 如果返回的位置信息表明这是默认位置，则应选中该复选框。我们在一个页面上有 5 个这样的位置 - 即用户可以单击的 5 个位置。

我遇到的是，即使`r.location.defaultLocation`返回 false（根据 console.log 行），该复选框仍在检查中。我究竟做错了什么？

**对于那些坚持真/假必须是字符串而不是布尔值的人：**

这是结果`console.info(typeof(r.location.defaultLocation));`

![在此处输入图像描述](../Images/f69a1e57d571d172a753b36a448cbf74.png)

这是 的结果`console.dir(r)`，如果它有帮助的话。（`group`由于它是敏感信息而模糊。）

![在此处输入图像描述](../Images/d9d2e67210d71c8092faeabe55d51992.png)

**发现问题**

显然，jquery 会记住`#loc-default`在第一个标记为已检查之后已检查。我在函数中添加了一个 else，现在它可以工作了：

```
if( r.location.defaultLocation == true ) {
    $('#loc-default').attr('checked',true);
}
else {
    $('#loc-default').attr('checked', false);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:27:03.610

我能看到发生这种情况的唯一方法是，如果 defaultLocation 实际上不是布尔值 false，而是字符串“false”，它的计算结果为 true。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T16:26:11.450

确保`r.location.defaultLocation`是布尔值。

尝试`if (!!r.location.defaultLocation) {}`将值强制为布尔类型。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-20T16:27:39.417

我认为`r.location.defaultLocation`是**字符串** `"false"`。因此，如果您使用`console.log`它，您将看到`"false"`. 不过`"false" == true`是真的。

您可以使用 来检查变量的类型`typeof`。

```
console.log(typeof r.location.defaultLocation); // Log the current type of r.location.defaultLocation
console.log(typeof false); // Display boolean
console.log(typeof "false"); // Display string 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-20T16:28:04.217

由于您的代码似乎是正确的，我会尝试处理 else 语句并强制不选中该复选框。

```
if( r.location.defaultLocation == true ) {
    $('#loc-default').attr('checked',true);
} else {
    $('#loc-default').attr('checked',false);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-20T16:29:09.867

首先我会检查看看是`r.location.defaultLocation`什么

```
 console.info(typeof(r.location.defaultLocation)); 
```

然后我会从那里去，但使用上面的代码：

```
 if (!!r.location.defaultLocation && typeof(r.location.defaultLocation)==="string") {} 
```

# wix - Wix 自定义操作执行 cmd 不起作用

> ID：13976360
> 
> 赞同：1
> 
> 时间：2012-12-20T16:23:08.507
> 
> 标签：wix, custom-action

我正在尝试在 wix 安装期间执行自定义操作，并在调用自定义操作时出现错误。我想使用 cacls 将具有完全控制权的权限组“Everyone”添加到文件夹中。当我从 cmd 运行它时它工作正常，但从安装程序它不起作用。以下是来自 wix 安装日志的错误消息。

信息 1721。此 Windows 安装程序包有问题。无法运行完成此安装所需的程序。请联系您的支持人员或软件包供应商。操作：SetPermissions，位置：，命令：“c:\Windows\SysWOW64\cmd.exe” cacls “c:\Program Files\Test” /g 每个人：f /e

这是我在 wix 文件中的自定义操作

```
<CustomAction Id="SetPermissions" Property="PermissionsAction" ExeCommand="&quot;   [SystemFolder]cmd.exe&quot; cacls &quot;[Folder].&quot; /g everyone:f /e" Execute="immediate" Return="ignore"  />
<CustomAction Id="PermissionsAction" BinaryKey="WixCA" DllEntry="CAQuietExec"   Execute="deferred" Return="ignore" Impersonate="no"/>
<InstallExecuteSequence>
  <Custom Action="SetPortalDataPermissions" Before="InstallFinalize">
  </Custom>
</InstallExecuteSequence> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T16:52:16.353

您可以在 Wix 中做您想做的事情，而无需自定义操作：

```
<CreateFolder Directory="DirectoryToSetPermissions">
 <util:PermissionEx User="Everyone" GenericAll="yes" />
</CreateFolder> 
```

要使用 Util 扩展，您必须添加对 WixUtilExtension 程序集的引用，并将 UtilExtension 命名空间添加到 wsx 文件上的 Wix 标记，如下所示：

```
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
xmlns:util="http://schemas.microsoft.com/wix/UtilExtension"> 
```

# .net - LINQ：属性/字段应在某些条件下继承数据

> ID：13976365
> 
> 赞同：1
> 
> 时间：2012-12-20T16:23:20.090
> 
> 标签：.net, linq-to-sql, inheritance

所以我正在做一个简单的项目管理系统并且遇到了一个 LINQ quandry。这可能很常见。项目任务基于模板（与数据库中的任务共享一个表）。项目任务具有默认从任务模板继承的多个字段，除非它们具有值。例如，UnitPrice 为 0 的 ProjectTask 记录将查看 ProjectTask 模板记录以获取实际价格。

如何使用 LINQ 实现这一点？我想过做一个 ObjectDataSource，但这远离了我处理所有其他数据的方式（在 LINQ 中）。我尝试使用如下代码创建派生类，但它没有出现在 LinqDataSource 中，即使我在 ORM 设计器中设置了继承。

我做了一些谷歌搜索，但似乎找不到一个好的模型。有什么想法吗？一如既往地感谢。

```
public class ProjectTaskWithInheritance : ProjectTask
{
    public new decimal UnitPrice
    {
        get
        {
            if (IsServiceOverride)
                if (base.UnitPrice != 0)
                    return base.UnitPrice;

            return base.TaskTemplateRecord.UnitPrice;
        }
        set { base.UnitPrice = value; }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T16:50:50.440

您正在混淆继承的级别：您的系统对相互继承的事物进行建模（即项目任务`UnitPrice`从项目任务模板继承）；同时，您正尝试在 .NET 程序中使用继承对其进行建模。这是两种不同的继承：一种在您的数据层中，而另一种在您的代码层中。

我建议使用代码层中的*包含*来对数据层中的继承进行建模，而不是使用继承。每个都`ProjectTask`可以有一个可选的实例`ProjectTask`作为任务模板；当在任务本身中找不到属性时，请尝试在模板*对象*中查找它。使属性可以为空，以允许在对象或其模板中未设置属性的情况。

```
class ProjectTask {
    private ProjectTask Template {get;set;}
    private decimal? unitPriceOverride;
    public decimal UnitPrice {
         get {
             return unitPriceOverride ?? (Template != null ? Template.UnitPrice : null);
         }
         set {
             unitPriceOverride = value;
         }
    }
} 
```

# asp.net - 加密 DLL 以防止使用反射器 - .NET

> ID：13976367
> 
> 赞同：2
> 
> 时间：2012-12-20T16:23:34.427
> 
> 标签：asp.net, .net

> **可能重复：**
> [不使用混淆器的 DLL 加密](https://stackoverflow.com/questions/9868895/dll-encryption-without-using-obfuscator)

我需要将一个项目发送给一个承包商，该承包商有一个我想确保他不能使用反射器的组件来查看代码。

有没有办法在.NET中做到这一点？

我将在我的项目中使用反射来询问程序集以调用方法。如果 DLL 被“加密”，反射会起作用吗？此外，这将由他在 GAC 中安装。

# c++ - 如何添加 gstreamer 插件？

> ID：13976368
> 
> 赞同：0
> 
> 时间：2012-12-20T16:23:44.173
> 
> 标签：c++, c, plugins, installation, gstreamer

我制作了一个简单的 GStreamer 插件，但 GStreamer 检查/启动工具没有获取我的源代码。我将 dll 复制到 gstreamer libs 目录，删除了 c/users/user/.gstreamer-0.10/ 中的 gstreamer 注册表文件夹运行 gst-inspect-0.10 并重新创建了注册表文件，但它仍然没有拿起我的自定义插入。我在这里错过了一步吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T18:35:09.083

弄清楚了。我不得不将 ifndef 宏放在 PACKAGE 常量上。

# jenkins - 使用 jenkins 进行持续部署

> ID：13976373
> 
> 赞同：36
> 
> 时间：2012-12-20T16:23:54.313
> 
> 标签：jenkins, jenkins-plugins, continuous-deployment

我想用 jenkins 部署到测试环境和生产环境。为此，我需要连接到所需环境的服务器，例如 ssh/scp。

我想知道最好的方法是什么。

我找到了一些插件来做到这一点，比如 Jenkins-Deploy-Plug-in 或 Jenkins Publish over SSH Plugin。第一个有很多问题，部署到生产环境中并不值得信赖，第二个你需要更改全局配置，每次部署都是手动工作。

任何想法如何解决这个问题？也许有一些脚本或插件？

我目前唯一的想法是：将 jenkins 连接到服务器（可能使用 SSH 插件）并在那里执行连接到所需环境的脚本。但这是两个联系。这真的有必要吗？我希望有一个更直接的方法。

感谢您的任何提示。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-20T16:45:30.363

我建议以下程序：

一个单一的 shell 脚本（存储在 jenkins 服务器上的某处）可以完成所有工作。基本上，该脚本执行构建工件的 scp，然后连接到服务器 (ssh) 并执行所有必要的部署任务（设置维护页面、备份当前应用程序、部署新应用程序，...）。

在 jenkins 服务器上，至少有 2 个作业：

*   第一个只是进行构建（使用 maven 或任何其他构建脚本）
*   第二个工作是部署：所以这个工作只运行 shell 脚本。（我建议为每个目标环境执行一项部署工作：测试、生产……）

它不需要任何“特殊”的詹金斯插件来实现这种“一键部署”。它只要求 jenkins 用户对目标服务器具有 ssh 访问权限。

**编辑**

这是一个示例 shell 脚本来说明我的帖子

```
#This script will copy the last artifact build by the job "MyApp" to test.myserver.com
#and remotely execute the deployment script.

#copy the war to the server
#(the job "MyApp" is using maven, that's why the war can be found at this location)
scp -i <HOME_DIR>/.ssh/id_dsa $HUDSON_HOME/jobs/MyApp_Build/workspace/myapp/target/myapp.war     deployeruser@test.myserver.com:/tmp/

#connect to the server and execute the deployment script
ssh -i <HOME_DIR>/.ssh/id_dsa deployeruser@test.myserver.com 
#The following is just an example of what a deployment script can be.
#of course you must adapt it to your needs and environment
"cd <TOMCAT_DIR>;
#first copy the current war to a backup directory (additionaly, I have a cron task deleting old undeployed apps)
cp -rf myapp-apps/myapp* undeployed/myapp-apps/; 
#execute a script (stored on the server) to properly stop the app
sh bin/myapp.sh stop; 
#delete current app
rm -rf myapp-apps/myapp; 
rm -rf myapp-apps/myapp.war;
#copy the uploaded war in tomcat app directory 
cp /tmp/myapp.war myapp-apps/; 
#execute a script (stored on the server) to start the app
sh bin/myapp.sh start" 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-21T15:46:37.813

使用 SSH 会损害您环境的安全性，
并且很难排除故障。

最好在远程机器上安装**Jenkins-Slave**
并通过在 Slave 上执行 Job 来运行测试。

Slave 由 Server 监控，这为您节省了
管理连接的很多麻烦。

您可以在成功构建结束时触发远程作业并将
该构建的工件传递给它。
（也可以让第一个作业将工件存储在共享驱动器上
，并将这些工件的位置传递给下一个作业）。

看这里：

*   **Jenkins -[分布式构建](https://wiki.jenkins-ci.org/display/JENKINS/Distributed+builds)**
*   **Jenkins -[参数化触发器插件](https://wiki.jenkins-ci.org/display/JENKINS/Parameterized+Trigger+Plugin)**
*   **Jenkins -[复制工件插件](https://wiki.jenkins-ci.org/display/JENKINS/Copy+Artifact+Plugin)**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-12-14T17:20:29.630

理想情况下，您应该使用[Fabric](http://docs.fabfile.org/en/1.4.0/index.html)或[Capistrano](https://github.com/capistrano/capistrano)之类的东西进行部署，并从 Jenkins 调用这些脚本。我也将 Capistrano 广泛用于 Ruby On Rails 和非 Ruby 应用程序。我看到的最大优势是：

*   内置的智能回滚部署，以防部署时出现错误。
*   它提供了运行一组脚本的钩子，例如数据库迁移、服务重启等。
*   如果需要，手动回滚。

# c - 为什么我的流媒体端口“被切断和静态！”

> ID：13976390
> 
> 赞同：0
> 
> 时间：2012-12-20T16:25:07.340
> 
> 标签：c, audio-streaming, portaudio

只需在您的系统上分别编译我的两个 .c 文件（[https://github.com/Xenland/P2P-Crypt](https://github.com/Xenland/P2P-Crypt)）

```
gcc ./p2pcrypt_tool_udp_receive.c -o p2pcrypt_tool_udp_receive -lportaudio -lpthread `pkg-config --cflags --libs gtk+-2.0` 
```

同时运行 crypt 文件和 p2pcrypt_tool_udp_receive 文件，然后开始对着麦克风说话，你会听到扬声器输出半完整的流——音频断断续续而且是静态的——我想知道如何使缓冲区播放流畅我不确定出了什么问题......你知道这段代码有什么问题吗？

# c# - 将 WPF ComboBox 的 TextChanged 和 SelectionChanged 链接在一起

> ID：13976393
> 
> 赞同：2
> 
> 时间：2012-12-20T16:25:32.173
> 
> 标签：c#, wpf, combobox

我有一种情况，我想让输入到可编辑 ComboBox 中的文本在被更改并调用 TextChanged 处理程序时被选中。原因是在组合框的 SelectionChanged 处理程序中完成了一些非常重要的工作。

ComboBox 在后面的代码中定义如下：

```
<ListView.View>
            <GridView x:Name="callListView" AllowsColumnReorder="True" ColumnHeaderToolTip="Broadcast call targets" >
               <GridViewColumn Width="120">
                  <GridViewColumn.CellTemplate>
                     <DataTemplate>
                        <ComboBox ItemsSource="{Binding Path=extensions, RelativeSource={RelativeSource AncestorType=Window}}"
                                  Width="105" IsEditable="True" HorizontalAlignment="Center" Margin="0,0,0,0" BorderThickness="0"
                                  SelectedItem="{Binding Path=Key, Mode=OneWay}" SelectionChanged="chooseExtension_SelectionChanged"
                                  TextBoxBase.TextChanged="chooseExtension_TextChanged" IsTextSearchEnabled="False">
                           <ComboBox.Resources>
                              <sys:Double x:Key="{x:Static SystemParameters.VerticalScrollBarWidthKey}">15</sys:Double>
                           </ComboBox.Resources>
                        </ComboBox>
                     </DataTemplate>
                  </GridViewColumn.CellTemplate>
               </GridViewColumn>
            </GridView>
<!-- a bunch of unrelated stuff was removed to keep this simple -->
         </ListView.View> 
```

有没有办法让 TextChanged 之后的当前文本成为 ComboBox 的 SelectedValue？

# ruby-on-rails - 预设标签acts_as_taggable_on

> ID：13976396
> 
> 赞同：0
> 
> 时间：2012-12-20T16:25:34.513
> 
> 标签：ruby-on-rails, acts-as-taggable-on

act_as_taggable_on 是否有任何设置来阻止创建新标签？我在 wiki 或 SO 上找不到任何东西。

我只希望管理员能够创建新标签。我意识到我可以创建一些东西来检查列表，但我无法想象我是第一个有这个请求的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:53:38.193

我检查了源代码，发现了一些可能会阻止保存标签的东西。根据`tag`此处找到的方法：[https](https://github.com/mbleigh/acts-as-taggable-on/blob/master/lib/acts_as_taggable_on/tagger.rb#L45) ://github.com/mbleigh/acts-as-taggable-on/blob/master/lib/acts_as_taggable_on/tagger.rb#L45 ，也许如果你把它和选项`:skip_save`它会工作。
这只是一个猜测，我真的没有测试它，只是打开类并尝试阅读它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T16:54:00.127

这不是acts_as_taggable_on 设置。

为了防止某些角色能够访问它，只需在您的视图中对其进行特定限制即可。

因此，在您看来 - 您可能拥有以下用于创建标签的代码段。

```
<div class="control-group">
    <%= f.label :tag_list, "Tags (Separated by Commas)",:class => 'control-label' %><br />
    <%= f.text_field :tag_list, :class => 'text_area' %>
  </div> 
```

只需用您的授权码将它们包围起来，它们就不会被渲染。

示例：如果您使用的是[can-can gem](https://github.com/ryanb/cancan)，您可以按照以下方式编写一些内容

```
<% if can? :update, tag_list %> 
```

# c# - 设置 if else 语句来检查查询字符串

> ID：13976399
> 
> 赞同：-3
> 
> 时间：2012-12-20T16:25:37.210
> 
> 标签：c#, asp.net

我正在寻找一个 if else 语句，如果它检测到一个查询字符串，则执行一个操作，如果没有检测到一个，则执行另一个操作。我的麻烦在于语法，我找不到一个好的例子。

我正在寻找类似的东西：

```
if (requisition_id = null)

    do this action

else

    do this action 
```

我基本上是在寻找识别查询字符串所需的语法，剩下的代码我已经准备好了。

任何帮助表示赞赏

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:30:28.423

要读取查询参数的值，请使用对象的`QueryString`集合`Request`。如果它返回`null`查询参数名称，那么它没有在 URL 中提供。

```
string argname = Request.QueryString["argname"];
if (argname != null)
{
    // argname contains the argument value
}
else
{
    // No argument value was supplied
} 
```

# objective-c - UnittWebSocketClient iOS 错误

> ID：13976400
> 
> 赞同：1
> 
> 时间：2012-12-20T16:25:38.553
> 
> 标签：objective-c, ios6, xcode4.2

ios设备构建错误....

```
ld: warning: ignoring file /Users/andre/Downloads/UnittWebSocketClient/bin/Debug-iphonesimulator/libUnittWebSocketClient.a, file was built for archive which is not the architecture being linked (armv7): /Users/andre/Downloads/UnittWebSocketClient/bin/Debug-iphonesimulator/libUnittWebSocketClient.a 
```

架构 armv7 的未定义符号：“_OBJC_CLASS_$_WebSocket”，引用自：ViewController.o 中的 objc-class-ref “_OBJC_CLASS_$_WebSocketConnectConfig”，引用自：ViewController.o ld 中的 objc-class-ref：未找到符号对于架构 armv7 clang：错误：链接器命令失败，退出代码为 1（使用 -v 查看调用）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-18T06:09:58.140

这是我的回答。

1.  从此网址结帐：[https ://code.google.com/p/unitt/source/checkout](https://code.google.com/p/unitt/source/checkout)
2.  将 [unitt\iOS\UnittWebSocketClient\trunk\UnittWebSocketClient] 包含到您的项目中。(.h, .m)
3.  从您的项目中删除 libUnittWebSocketClient.a lib 文件。

# php - 为什么将 MySQL 凭据放在 www 目录之外？

> ID：13976401
> 
> 赞同：5
> 
> 时间：2012-12-20T16:25:43.813
> 
> 标签：php, mysql, security, credentials

> **可能重复：**
> [将核心类放在网络根目录之上——好主意还是坏主意？](https://stackoverflow.com/questions/3648739/putting-core-classes-above-the-web-root-good-or-bad-idea)

我一直在阅读，将 MySQL 连接凭据（无论是类、定义等）放在 web 根目录之外（www 文件夹上方）是一种最佳做法。

为什么是这样？如果凭据在 .php 文件中，那么该文件是否可以通过浏览器访问并不重要，对吧？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-20T16:27:42.977

这是一种预防措施。如果有人意外禁用了您的 apache 服务器中的 php 评估或更改了 .htaccess 文件中的 apache 设置，则该文件可以像任何纯文本文件一样提供。或者，如果你不小心忘记了一个 php 开始标签，它会像纯文本一样被重新渲染。并不是说您会犯如此愚蠢的错误，而是将来编写您的代码的新手可能会犯错误。

当您可以阻止它成为可能时，为什么要让可能的向量保持打开状态？只需听取其他射过自己脚的人的建议（或者像我一样，双脚和手都射过），然后将凭证移到您的文档根之外。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-20T16:27:05.097

因为，在一定程度上，Web 根目录下的任何内容都不是安全的。它可以在 Internet 上获得，这使得它本质上不安全。

总是存在这样一种可能性，即配置错误的服务器有一天会输出任何 PHP 文件的内容，而不是将其发送到 PHP 进行解释。还有太多人试图以任何方式进入您的数据库......其中一些只是为了好玩。

在任何给定情况下，您都应该始终使用最安全的方法。养成一个好习惯。

此外，您**永远不**应该在 Web 应用程序中使用 root 密码。创建具有最低权限的特殊用户。

对于 PHP，我总是使用`.ini`文件来存储敏感配置...

```
<?php
    $config = parse_ini_file('../config.ini');
?> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-20T16:27:13.130

因为`www`目录中的内容（即您网站的根目录）可能可以从互联网访问。

这意味着如果你把你的凭据放在这里，也许有人可以访问它们，并直接连接到你的数据库。

将您的凭据放在此目录之外可确保无法以这种方式访问​​它。

# objective-c - 固定 UIImage PushViewController 动画

> ID：13976403
> 
> 赞同：1
> 
> 时间：2012-12-20T16:25:47.770
> 
> 标签：objective-c, uiimage, pushviewcontroller

我想在动画之间固定一个图像，所以当应用向右滑动时它不会移动。有点像 UINavBar 的背景，我找不到之前尝试过的人，所以我真的很想知道。

提前致谢

肖尔斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:39:54.053

作为对您上一条评论的回应，以下是如何执行此操作：

```
UIView * hoi = [[UIView alloc] initWithFrame:CGRectMake(100, 100, 100, 100)];
hoi.backgroundColor = [UIColor blackColor];
UIWindow * window = [UIApplication sharedApplication].keyWindow;
[window addSubview:hoi]; 
```

或者，您创建添加第二个 UIWindow，您可以向其中添加子视图。正如这个答案中很好解释的那样：[https ://stackoverflow.com/a/2671148/262691](https://stackoverflow.com/a/2671148/262691)

# wcf - 在单个应用程序中托管服务和客户端时捕获 WCF 错误

> ID：13976404
> 
> 赞同：1
> 
> 时间：2012-12-20T16:25:47.123
> 
> 标签：wcf, service, client, faultexception

我正在 Visual Studio 单元测试中试验 WCF 服务。客户端和服务都以编程方式配置。

目前我的代码如下所示：

```
using System;
using System.ServiceModel;
using System.ServiceModel.Channels;
using System.ServiceModel.Description;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace Tests
{
    public abstract class EntityBase
    {
    }

    public class TestEntity : EntityBase
    {
        public string Name { get; set; }
    }

    [ServiceContract]
    [ServiceKnownType("GetKnownTypes", typeof(ServiceKnownTypesDiscoveryHelper))]
    public interface ITestService
    {
        [OperationContract]
        EntityBase GetEntity(string entityName);
    }

    public class TestService : ITestService
    {
        public EntityBase GetEntity(string entityName)
        {
            Type t = Type.GetType(entityName);
            return (EntityBase)Activator.CreateInstance(t);
        }
    }

    [TestClass]
    public class ServiceTests
    {
        private static ServiceHost ServiceHost { get; set; }

        [ClassInitialize]
        public static void ClassInitialize(TestContext testContext)
        {        
            ServiceHost = new ServiceHost(typeof(TestService));
            NetTcpBinding wsBinding = new NetTcpBinding();

            ServiceHost.AddServiceEndpoint(typeof(ITestService), wsBinding,
                "net.tcp://localhost:8011/TestService");

// trying to turn on debugging here
            var behavior = ServiceHost.Description.Behaviors.Find<ServiceDebugBehavior>();
            behavior.IncludeExceptionDetailInFaults = true;

            ServiceHost.Open();
        }

        [ClassCleanup]
        public static void ClassCleanup()
        {
            ServiceHost.Close();
        }

        [TestMethod]
        public void TestSomething()
        {
            var binding = new NetTcpBinding();
            var endpoint = new EndpointAddress("net.tcp://localhost:8011/TestService");

            using (ChannelFactory<ITestService> testServiceFactory =
                                            new ChannelFactory<ITestService>(binding, endpoint))
            {
                var proxy = testServiceFactory.CreateChannel();
                using (proxy as IDisposable)
                {
                    try
                    {
                        var entity = proxy.GetEntity(typeof(TestEntity).FullName);
                        Assert.IsInstanceOfType(entity, typeof(TestEntity));
                    }
                    catch (FaultException ex)
                    {
// copied this from MSDN example
                        string msg = "FaultException: " + ex.Message;
                        MessageFault fault = ex.CreateMessageFault();
                        if (fault.HasDetail == true)
                        {
                            var reader = fault.GetReaderAtDetailContents();
                            if (reader.Name == "ExceptionDetail")
                            {
                                ExceptionDetail detail = fault.GetDetail<ExceptionDetail>();
                                msg += "\n\nStack Trace: " + detail.StackTrace;
                            }
                        }
                        System.Diagnostics.Trace.WriteLine(msg);
                    }
                }
            }
        }
    }
} 
```

如果我的 ServiceKnownTypesDiscoveryHelper 没有返回已知类型，我知道我的服务和客户端应该在 .NET 服务模型代码的深处抛出一些与序列化相关的东西（如果我修改它以返回我的 TestEntity 那么当然一切正常，没有任何问题）。

但是目前如果服务失败，我只会收到一些模糊的异常消息，例如：

```
The socket connection was aborted. This could be caused by an error processing your message or a receive timeout being exceeded by the remote host, or an underlying network resource issue. 
```

在 using() 结束时，我得到

```
The communication object, System.ServiceModel.Channels.ServiceChannel, cannot be used for communication because it is in the Faulted state. 
```

（这也很奇怪 - 如果 ServiceChannel 处于故障状态，为什么我什至不能处理它......）

**如何捕捉导致服务或客户端失败的实际故障，而不是那些模糊的异常消息？**

# javascript - 为什么我的 XSLTProcessor transformToDocument 不起作用？

> ID：13976406
> 
> 赞同：1
> 
> 时间：2012-12-20T16:25:51.130
> 
> 标签：javascript, xml, xslt, xmlhttprequest, domparser

我的任务是修复一个旧网站，使其与现代浏览器兼容。不过，有一些第 3 方控件让我很适应，我不会花钱购买这些控件的最新版本。这些旧网格之一有一些内置的 javascript，在处理 XSLTProcessor transformToDocument 时不起作用。这是所有编译的 JS，我可以用一些工作代码替换它们。它用于 IE 的代码不同并且可以工作，但不能在其他浏览器中工作。我需要修复的其他浏览器的代码如下。我将在下面添加我的控制台日志的屏幕截图。transformToDocument 几乎返回一个空白页。让我知道是否应该添加任何其他内容以使我的问题更清楚。

```
 var xmlResp = new DOMParser();
    var xmlHttp = new XMLHttpRequest();
    xmlHttp.open("GET", xsltURL, false);
    xmlHttp.send(null);
    this.Processor = new XSLTProcessor();
    this.Processor.importStylesheet(xmlResp.parseFromString(xmlHttp.responseText, "text/xml"));

    console.log(this.Processor.transformToDocument(this.input));           

    this.outputDocument = this.Processor.transformToDocument(this.input);
    var output = this.outputDocument.firstChild.innerHTML;
    if (!output)
        output = "<tbody></tbody>";
    return output; 
```

仅供参考，WORKING IE Code 是这样的

```
 var xslt = ig_createActiveXFromProgIDs(["MSXML2.FreeThreadedDOMDocument", "Microsoft.FreeThreadedXMLDOM"]);
    xslt.async = false;
    xslt.load(xsltURL);

    var xslTemplate = new ActiveXObject("MSXML2.XSLTemplate");
    xslTemplate.stylesheet = xslt;
    this.Processor = xslTemplate.createProcessor();
    this.Processor.input = this.input;
    this.Processor.transform();
    return this.Processor.output; 
```

来自 xsltURL 的 XSLT 文件：

```
<?xml version="1.0"?>
<!--
Version 9.1.20091.2101
Copyright (c) 2001-2009 Infragistics, Inc. All Rights Reserved.
-->
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output omit-xml-declaration="yes" method="html"/>

<xsl:key name="columnIndex" match="Column" use="@index"/>
<xsl:key name="cellIndex" match="C" use="position()"/>

<xsl:variable name="gridName" select="//UltraWebGrid/@id"/>
<xsl:variable name="useFixedHeaders" select="//UltraWebGrid/UltraGridLayout/@UseFixedHeaders"/>
<xsl:variable name="tableLayout" select="//UltraWebGrid/UltraGridLayout/@TableLayout"/>
<xsl:variable name="isXhtml" select="//UltraWebGrid/UltraGridLayout/@IsXhtml"/>
<xsl:variable name="fixedScrollLeft" select="//UltraWebGrid/UltraGridLayout/@fixedScrollLeft"/>

<xsl:template match="/">
    <xsl:apply-templates select="Rs" />
</xsl:template>

<xsl:template match="Rs">
    <tbody>
        <xsl:apply-templates select="R">
            <xsl:with-param name="bandNo" select="@bandNo"/>
            <xsl:with-param name="parentRowLevel" select="@parentRowLevel"/>
        </xsl:apply-templates>
        <xsl:apply-templates select="Group">
            <xsl:with-param name="bandNo" select="@bandNo"/>
            <xsl:with-param name="parentRowLevel" select="@parentRowLevel"/>
        </xsl:apply-templates>
    </tbody>
</xsl:template>

<xsl:template match="R">
    <xsl:param name="bandNo"/>
    <xsl:param name="parentRowLevel"/>

    <xsl:variable name="band" select="//UltraWebGrid/Bands/Band[number($bandNo)]"/>
    <xsl:variable name="fac" select="number($band/@fac)"/>
    <xsl:variable name="rs" select="number($band/@rs)"/>
    <xsl:variable name="rowIndex" select="@i"/>
    <xsl:variable name="rHeight">
        <xsl:choose>
            <xsl:when test="@height">
                <xsl:value-of select="@height" />
            </xsl:when>
            <xsl:otherwise>
                <xsl:value-of select="$band/@rowHeight" />
            </xsl:otherwise>
        </xsl:choose>
    </xsl:variable>

    <tr id="{$gridName}_r_{$parentRowLevel}{$rowIndex}" level="{$parentRowLevel}{$rowIndex}">
        <xsl:if test="$band/@optSelectRow">
            <xsl:attribute name="class">
                <xsl:choose>
                    <xsl:when test="$rowIndex mod 2 = 1">
                        <xsl:value-of select="$band/@altClass" />
                    </xsl:when>
                    <xsl:otherwise>
                        <xsl:value-of select="$band/@itemClass" />
                    </xsl:otherwise>
                </xsl:choose>
            </xsl:attribute>
        </xsl:if>
        <xsl:attribute name="style">
            <xsl:if test="@hidden">display:none;</xsl:if>
            <xsl:value-of select="concat('height:',$rHeight,';')" />
        </xsl:attribute>
        <xsl:if test="$fac>1 or $rs=2 and $fac=1">
            <th class="{$band/@expAreaClass}">
                <xsl:attribute name="height">
                     <xsl:value-of select="$rHeight"/>
                </xsl:attribute>
                <xsl:element name="img">
                    <xsl:attribute name="border">0</xsl:attribute>
                    <xsl:choose>
                        <xsl:when test="@showExpand">
                            <xsl:attribute name="src">
                                <xsl:value-of select="$band/@expandImage" />
                            </xsl:attribute>
                              <xsl:attribute name="alt">
                                <xsl:value-of select="$band/@xAlt"/>
                              </xsl:attribute>
                              <xsl:attribute name="igAltC">
                                <xsl:value-of select="$band/@cAlt"/>
                              </xsl:attribute>
                            <xsl:attribute name="imgType">expand</xsl:attribute>
                        </xsl:when>
                        <xsl:otherwise>
                            <xsl:attribute name="src">
                                <xsl:value-of select="$band/@blankImage" />
                            </xsl:attribute>
                            <xsl:attribute name="imgType">blank</xsl:attribute>
                            <xsl:attribute name="style">visibility:hidden;</xsl:attribute>
                        </xsl:otherwise>
                    </xsl:choose>
                </xsl:element>
            </th>
        </xsl:if>
        <xsl:if test="$fac>0 and $rs!=2">
            <th id="{$gridName}_l_{$parentRowLevel}{$rowIndex}" class="{$band/@rowLabelClass}">
                <xsl:attribute name="style">text-align:center;vertical-align:middle;<xsl:if test="@rowSelectStyle"><xsl:value-of select="@rowSelectStyle" disable-output-escaping="yes" />;</xsl:if>
                    <xsl:if test="$band/@rowHeight">height:<xsl:value-of select="$band/@rowHeight" disable-output-escaping="yes" />;</xsl:if>
                </xsl:attribute>
                <xsl:choose>
                    <xsl:when test="@rowNumber">
                        <xsl:value-of select="@rowNumber" disable-output-escaping="yes" />
                    </xsl:when>
                    <xsl:otherwise>
                        <xsl:element name="img">
                            <xsl:attribute name="src">
                                <xsl:value-of select="$band/@rowLabelBlankImage" />
                            </xsl:attribute>
              <xsl:attribute name="alt"></xsl:attribute>
                            <xsl:attribute name="border">0</xsl:attribute>
                            <xsl:attribute name="imgType">blank</xsl:attribute>
                        </xsl:element>
                    </xsl:otherwise>
                </xsl:choose>
            </th>
        </xsl:if>
        <xsl:apply-templates select="Cs">
            <xsl:with-param name="band" select="$band"/>
            <xsl:with-param name="rowIndex" select="$rowIndex" />
            <xsl:with-param name="row" select="." />
            <xsl:with-param name="rowHeight" select="$rHeight" />
            <xsl:with-param name="parentRowLevel" select="$parentRowLevel" />
        </xsl:apply-templates>
    </tr>
</xsl:template>

<xsl:template match="Cs">
    <xsl:param name="band"/>
    <xsl:param name="rowIndex" />
    <xsl:param name="row" />
    <xsl:param name="rowHeight" />
    <xsl:param name="parentRowLevel"/>

    <xsl:for-each select="$band/Columns/Column">
        <xsl:if test="not(@grouped) and not(@serverOnly) and not(@nonfixed)">
            <xsl:variable name="columnIndex">
                <xsl:value-of select="@cellIndex"/>
            </xsl:variable>
            <xsl:variable name="cell" select="$row/Cs/C[number($columnIndex)]"/>
            <xsl:choose>
                <xsl:when test="$rowIndex mod 2 = 1">
                    <xsl:call-template name="cellTemplate">
                        <xsl:with-param name="cell" select="$cell" />
                        <xsl:with-param name="rowIndex" select="$rowIndex" />
                        <xsl:with-param name="className">
                            <xsl:if test="not($band/@optSelectRow)">
                                <xsl:value-of select="$band/@altClass" />
                            </xsl:if>
                        </xsl:with-param>
                        <xsl:with-param name="rowHeight" select="$rowHeight" />
                        <xsl:with-param name="parentRowLevel" select="$parentRowLevel" />
                        <xsl:with-param name="rowStyle" select="$row/@style" />
                        <xsl:with-param name="rowClass" select="$row/@class" />
                    </xsl:call-template>
                </xsl:when>
                <xsl:otherwise>
                    <xsl:call-template name="cellTemplate">
                        <xsl:with-param name="cell" select="$cell" />
                        <xsl:with-param name="rowIndex" select="$rowIndex" />
                        <xsl:with-param name="className">
                            <xsl:if test="not($band/@optSelectRow)">
                                <xsl:value-of select="$band/@itemClass" />
                            </xsl:if>
                        </xsl:with-param>
                        <xsl:with-param name="rowHeight" select="$rowHeight" />
                        <xsl:with-param name="parentRowLevel" select="$parentRowLevel" />
                        <xsl:with-param name="rowStyle" select="$row/@style" />
                        <xsl:with-param name="rowClass" select="$row/@class" />
                    </xsl:call-template>
                </xsl:otherwise>
            </xsl:choose>
        </xsl:if>
    </xsl:for-each>

    <xsl:if test="$useFixedHeaders">
        <td colspan="{$band/@nfspan}">
            <xsl:choose>
                <xsl:when test="$band/@optSelectRow">
                    <xsl:attribute name="class">
                        <xsl:value-of select="concat($gridName,'-no')" />
                    </xsl:attribute>
                    <xsl:if test="$row/@dtdh">
                        <xsl:attribute name="height">
                            <xsl:value-of select="$row/@dtdh" />
                        </xsl:attribute>
                    </xsl:if>
                </xsl:when>
                <xsl:otherwise>
                    <xsl:attribute name="style">
                        <xsl:choose>
                            <xsl:when test="$row/@dtdh">
                                <xsl:value-of select="concat('vertical-align:top;height:',$row/@dtdh,';')" />
                            </xsl:when>
                            <xsl:otherwise>vertical-align:top;width:100%;</xsl:otherwise>
                        </xsl:choose>
                    </xsl:attribute>
                </xsl:otherwise>
            </xsl:choose>
            <div id="{$gridName}_drs">
                <xsl:attribute name="style">
                    <xsl:choose>
                        <xsl:when test="$row/@dtdh">overflow:hidden;<xsl:value-of select="$row/@ht"/><xsl:if test="$isXhtml">position:relative;</xsl:if></xsl:when>
                        <xsl:otherwise>overflow:hidden;width:100%;height:100%;<xsl:if test="$isXhtml">position:relative;</xsl:if></xsl:otherwise>
                    </xsl:choose>
                </xsl:attribute>
                    <table width="1"  border="0" cellspacing="0" cellpadding="0" style="position:relative;table-layout:fixed;height:100%;{$fixedScrollLeft}">
                        <colgroup>
                        <xsl:for-each select="$band/Columns/Column">
                            <xsl:if test="not(@grouped) and not(@serverOnly) and not(@hidden) and @nonfixed">
                                <col width="{@width}"/>
                            </xsl:if>
                        </xsl:for-each>
                        <xsl:for-each select="$band/Columns/Column">
                            <xsl:if test="not(@grouped) and not(@serverOnly) and @hidden and @nonfixed">
                                <col width="1px" style="display:none;"/>
                            </xsl:if>
                        </xsl:for-each>
                    </colgroup>
                        <tr id="{$gridName}_nfr_{$parentRowLevel}{$rowIndex}">
                        <xsl:attribute name="style">
                            <xsl:choose>
                                <xsl:when test="$row/@height">
                                    <xsl:value-of select="concat('height:',$row/@height,';')" />
                                </xsl:when>
                                <xsl:otherwise>
                                    <xsl:value-of select="concat('height:',$rowHeight,';')" />
                                </xsl:otherwise>
                            </xsl:choose>
                        </xsl:attribute>
                        <xsl:for-each select="$band/Columns/Column">
                            <xsl:variable name="columnIndex">
                                <xsl:value-of select="@cellIndex"/>
                            </xsl:variable>
                            <xsl:variable name="cell" select="$row/Cs/C[number($columnIndex)]"/>
                            <xsl:if test="not(@grouped) and not(@serverOnly) and @nonfixed">
                                <xsl:choose>
                                    <xsl:when test="$rowIndex mod 2 = 1">
                                        <xsl:call-template name="cellTemplate">
                                            <xsl:with-param name="cell" select="$cell" />
                                            <xsl:with-param name="rowIndex" select="$rowIndex" />
                                            <xsl:with-param name="className">
                                                <xsl:if test="not($band/@optSelectRow)">
                                                    <xsl:value-of select="$band/@altClass" />
                                                </xsl:if>
                                            </xsl:with-param>
                                            <xsl:with-param name="rowHeight" select="$rowHeight" />
                                            <xsl:with-param name="parentRowLevel" select="$parentRowLevel" />
                                            <xsl:with-param name="rowStyle" select="$row/@style" />
                                            <xsl:with-param name="rowClass" select="$row/@class" />
                                        </xsl:call-template>
                                    </xsl:when>
                                    <xsl:otherwise>
                                        <xsl:call-template name="cellTemplate">
                                            <xsl:with-param name="cell" select="$cell" />
                                            <xsl:with-param name="rowIndex" select="$rowIndex" />
                                            <xsl:with-param name="className">
                                                <xsl:if test="not($band/@optSelectRow)">
                                                    <xsl:value-of select="$band/@itemClass" />
                                                </xsl:if>
                                            </xsl:with-param>
                                            <xsl:with-param name="rowHeight" select="$rowHeight" />
                                            <xsl:with-param name="parentRowLevel" select="$parentRowLevel" />
                                            <xsl:with-param name="rowStyle" select="$row/@style" />
                                            <xsl:with-param name="rowClass" select="$row/@class" />
                                        </xsl:call-template>
                                    </xsl:otherwise>
                                </xsl:choose>
                            </xsl:if>
                        </xsl:for-each>
                    </tr>
                </table>
            </div>
        </td>
    </xsl:if>
</xsl:template>

<xsl:template name="cellTemplate">
    <xsl:param name="cell" />
    <xsl:param name="rowIndex" />
    <xsl:param name="className" />
    <xsl:param name="rowHeight" />
    <xsl:param name="parentRowLevel"/>
    <xsl:param name="rowStyle"/>
    <xsl:param name="rowClass"/>

    <xsl:if test="not($cell/@merged)">

        <xsl:variable name="cellIndex">
            <xsl:value-of select="position()-1"/>
        </xsl:variable>

        <td id="{$gridName}_rc_{$parentRowLevel}{$rowIndex}_{$cellIndex}">
            <xsl:if test="$cell/@rowSpan">
                <xsl:attribute name="rowSpan">
                    <xsl:value-of select="$cell/@rowSpan" />
                </xsl:attribute>
            </xsl:if>
            <xsl:if test="$cell/@colSpan">
                <xsl:attribute name="colSpan">
                    <xsl:value-of select="$cell/@colSpan" />
                </xsl:attribute>
            </xsl:if>
            <xsl:if test="$cell/@title">
                <xsl:attribute name="title">
                    <xsl:value-of select="$cell/@title" />
                </xsl:attribute>
            </xsl:if>
            <xsl:if test="string-length($className)>0 or ./@class or $rowClass or $cell/@class">
                <xsl:attribute name="class">
                    <xsl:value-of select="concat($className,' ',./@class,' ',$rowClass,' ',$cell/@class)" />
                </xsl:attribute>
            </xsl:if>
            <xsl:if test="./@style or $rowStyle or $cell/@style or @hidden">
                <xsl:attribute name="style">
                    <xsl:value-of select="concat(./@style,$rowStyle,$cell/@style)" />
                    <xsl:if test="@hidden">display:none;</xsl:if>
                </xsl:attribute>
            </xsl:if>
            <xsl:if test="$cell/@allowedit">
                <xsl:attribute name="allowedit">
                    <xsl:value-of select="$cell/@allowedit" />
                </xsl:attribute>
            </xsl:if>
            <xsl:if test="$cell/@uV">
                <xsl:attribute name="uV">
                    <xsl:value-of select="$cell/@uV" />
                </xsl:attribute>
            </xsl:if>
            <xsl:if test="$cell/@iCT">
                <xsl:attribute name="iCT">
                    <xsl:value-of select="$cell/@iCT" />
                </xsl:attribute>
            </xsl:if>
            <xsl:if test="$cell/@iDV">
                <xsl:attribute name="iDV">
                    <xsl:value-of select="$cell/@iDV" />
                </xsl:attribute>
            </xsl:if>
            <xsl:if test="$cell/@iTM">
                <xsl:attribute name="iTM">
                    <xsl:value-of select="$cell/@iTM" />
                </xsl:attribute>
            </xsl:if>
            <xsl:choose>
                <xsl:when test="$cell/@br"><xsl:if test="$cell/@doe"><xsl:attribute name="name">_igdoe</xsl:attribute></xsl:if><xsl:value-of select="$cell" disable-output-escaping="yes" /></xsl:when>
                <xsl:otherwise><nobr><xsl:if test="$cell/@doe"><xsl:attribute name="name">_igdoe</xsl:attribute></xsl:if><xsl:value-of select="$cell" disable-output-escaping="yes" /></nobr></xsl:otherwise>
            </xsl:choose>
        </td>
    </xsl:if>
</xsl:template>

<xsl:template match="Group">
    <xsl:param name="bandNo"/>
    <xsl:param name="parentRowLevel"/>

    <xsl:variable name="band" select="//UltraWebGrid/Bands/Band[number($bandNo)]"/>
    <xsl:variable name="rowIndex" select="@i"/>
    <xsl:variable name="rHeight">
        <xsl:choose>
            <xsl:when test="@height">
                <xsl:value-of select="@height" />
            </xsl:when>
            <xsl:otherwise>
                <xsl:value-of select="$band/@rowHeight" />
            </xsl:otherwise>
        </xsl:choose>
    </xsl:variable>

    <tr id="{$gridName}_gr_{$parentRowLevel}{$rowIndex}" groupRow="{@groupRow}" level="{$parentRowLevel}{$rowIndex}">
        <xsl:attribute name="style">height:<xsl:value-of select="$rHeight" />;<xsl:if test="$isXhtml and $useFixedHeaders">position:relative;</xsl:if></xsl:attribute>
        <td>
            <table border='0' cellpadding='0' cellspacing='0' bgcolor='{@bgcolor}' bandNo='{@bandNo}'>
                <xsl:if test="$tableLayout">
                    <xsl:attribute name="style">table-layout:fixed;</xsl:attribute>
                </xsl:if>
                <xsl:attribute name="width"><xsl:value-of select="../@grpWidth" disable-output-escaping="yes" /></xsl:attribute>
                <tr id="{$gridName}_sgr_{$parentRowLevel}{$rowIndex}" level="{$parentRowLevel}{$rowIndex}" groupRow="{@groupRow}">
                    <xsl:attribute name="style">height:<xsl:value-of select="$rHeight" />;</xsl:attribute>
                    <td id="{$gridName}_grc_{$parentRowLevel}{$rowIndex}" groupRow="{@groupRow}" style='{@style}' class='{$band/@grpClass}'>
                        <xsl:attribute name="cellValue">
                            <xsl:value-of select="@cellValue" disable-output-escaping="yes" />
                        </xsl:attribute>
                        <xsl:element name="img">
                            <xsl:attribute name="border">0</xsl:attribute>
                            <xsl:attribute name="src">
                                <xsl:value-of select="$band/@expandImage" />
                            </xsl:attribute>
              <xsl:attribute name="alt">
                <xsl:value-of select="$band/@xAlt"/>
              </xsl:attribute>
              <xsl:attribute name="igAltC">
                <xsl:value-of select="$band/@cAlt"/>
              </xsl:attribute>
                            <xsl:attribute name="imgType">expand</xsl:attribute>
                        </xsl:element>
                        <xsl:text>&#xa0;&#xa0;</xsl:text>
                        <xsl:value-of select="@content" disable-output-escaping="yes" />
                    </td>
                </tr>
            </table>
        </td>
    </tr>
</xsl:template>

</xsl:stylesheet> 
```

XML:

```
<Rs bandNo="1" parentRowLevel="">
    <R DataKey="10521" i="0">
        <Cs>
            <C doe="1">
                <![CDATA[10521]]>
            </C>
            <C doe="1">
                <![CDATA[CHARLEBOIS, CHRIS-(9080)]]>
            </C>
            <C doe="1">
                <![CDATA[PT Server]]>
            </C>
            <C doe="1">
                <![CDATA[EillenStaffType]]>
            </C>
            <C style="background-color:Silver;" doe="1">
                <![CDATA[&nbsp;]]>
            </C>
            <C doe="1">
                <![CDATA[&nbsp;]]>
            </C>
            <C style="background-color:Silver;" doe="1">
                <![CDATA[&nbsp;]]>
            </C>
            <C doe="1">
                <![CDATA[&nbsp;]]>
            </C>
            <C style="background-color:Silver;" doe="1">
                <![CDATA[&nbsp;]]>
            </C>
            <C doe="1">
                <![CDATA[&nbsp;]]>
            </C>
            <C style="background-color:Silver;" doe="1">
                <![CDATA[&nbsp;]]>
            </C>
            <C doe="1">
                <![CDATA[&nbsp;]]>
            </C>
            <C style="background-color:Silver;" doe="1">
                <![CDATA[&nbsp;]]>
            </C>
            <C doe="1">
                <![CDATA[&nbsp;]]>
            </C>
            <C style="background-color:Silver;" doe="1">
                <![CDATA[&nbsp;]]>
            </C>
            <C doe="1">
                <![CDATA[&nbsp;]]>
            </C>
        </Cs>
    </R>
    <R DataKey="10522" i="1">
        <Cs>
            <C doe="1">
                <![CDATA[10522]]>
            </C>
            <C doe="1">
                <![CDATA[CURRAN, COLLEEN-(1663)]]>
            </C>
            <C doe="1">
                <![CDATA[PT Server]]>
            </C>
            <C doe="1">
                <![CDATA[Food and Beverage]]>
            </C>
            <C iTM="1" style="background-color:Silver;" doe="1">
                <![CDATA[&nbsp;]]>
            </C>
            <C doe="1">
                <![CDATA[&nbsp;]]>
            </C>
            <C iTM="1" style="background-color:Silver;" doe="1">
                <![CDATA[&nbsp;]]>
            </C>
            <C doe="1">
                <![CDATA[&nbsp;]]>
            </C>
            <C iTM="1" style="background-color:Silver;" doe="1">
                <![CDATA[&nbsp;]]>
            </C>
            <C doe="1">
                <![CDATA[&nbsp;]]>
            </C>
            <C iTM="1" title="Date requested: 11/9/2012  " style="background-color:Silver;"
            doe="1">
                <![CDATA[<Table cellspacing="0" cellpadding="0" style="vertical-align:middle;width:100%;height:100%"><tr style="width:100%"><td NOWRAP class="SDCP" style=";height:20px;display=block"    pa="Unable to find IndirectType()." pt="Unable to find IndirectType()." ><span>Unable to find IndirectType().</span></td></tr></Table>]]>
            </C>
            <C doe="1">
                <![CDATA[&nbsp;]]>
            </C>
            <C iTM="1" title="Date requested: 11/9/2012  " style="background-color:Silver;"
            doe="1">
                <![CDATA[<Table cellspacing="0" cellpadding="0" style="vertical-align:middle;width:100%;height:100%"><tr style="width:100%"><td NOWRAP class="SDCP" style=";height:20px;display=block"    pa="Unable to find IndirectType()." pt="Unable to find IndirectType()." ><span>Unable to find IndirectType().</span></td></tr></Table>]]>
            </C>
            <C doe="1">
                <![CDATA[&nbsp;]]>
            </C>
            <C iTM="1" style="background-color:Silver;" doe="1">
                <![CDATA[&nbsp;]]>
            </C>
            <C doe="1">
                <![CDATA[&nbsp;]]>
            </C>
        </Cs>
    </R>
</Rs> 
```

控制台屏幕（this.Processor.transformToDocument(this.input)）：

![转换为文档](../Images/106f1b37de51e1f1164d3cce5449d517.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T16:59:42.483

XSLT 没有获得正确的 MIME 类型，这可能会导致失败。也许尝试以下更改：

```
var xmlResp = new DOMParser();
var xmlHttp = new XMLHttpRequest();
xmlHttp.open("GET", xsltURL, false);
// Make sure the returned document has the correct MIME type
xmlHttp.overrideMimeType("application/xslt+xml");
xmlHttp.send(null);
this.Processor = new XSLTProcessor();
// Just interpret the returned data as XML instead of parsing in a separate step
this.Processor.importStylesheet(xmlHttp.responseXML);

console.log(xmlResp.responseXML);
console.log(this.input);
console.log(this.Processor.transformToDocument(this.input));           

this.outputDocument = this.Processor.transformToDocument(this.input);
var output = this.outputDocument.firstChild.innerHTML;
if (!output)
    output = "<tbody></tbody>";
return output; 
```

# jquery - jQuery：排除列表树的根元素（ul）

> ID：13976407
> 
> 赞同：2
> 
> 时间：2012-12-20T16:25:56.280
> 
> 标签：jquery, html-lists, root

我一直在使用来自堆栈溢出的一段 jquery 代码。这是该页面的链接：

[https://stackoverflow.com/questions/2...76196#13976196](https://stackoverflow.com/questions/2...76196#13976196)

我需要隐藏除根元素之外的大型 UL 树结构。上面的代码效果很好，除了我无法理解以下行：

代码：

```
$('ul, li', $('#lesson-sidebar ul li')).hide(); 
```

该代码隐藏了列表中的所有 UL 和 LI 项，但不包括根元素。我不明白添加`$('#lesson-sidebar ul li')`为第二个选择器参数如何将其从隐藏命令中排除。

我知道隐藏命令不会切换可见状态，因此它们不像隐藏根元素并立即显示它。大多数其他描述依赖于 :not 等命令来排除根元素。

谁能解释为什么根元素没有被该命令隐藏？请注意，如果我删除该`$('#lesson-sidebar ul li')`部分，根元素实际上是隐藏的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:31:34.587

这`$('ul, li', $('#lesson-sidebar ul li'))`意味着

选择所有`ul`的`li`孩子`$('#lesson-sidebar ul li')`

这是该选择器的模式`$('children selector', parent)` 正如您在示例中看到的那样，父级不是字符串，它是 DOM 或 jQuery 元素

# html - 如何强制 Web 浏览器将文件解释为 HTML

> ID：13976408
> 
> 赞同：3
> 
> 时间：2012-12-20T16:25:57.720
> 
> 标签：html, browser

我正在尝试将 .htm 文件上传到远程 SVN 存储库，以供我团队的其他成员在他们的 Web 浏览器中查看。

查询时，存储库仅将我的 .htm 文件显示为纯文本，尽管当我从本地硬盘驱动器运行该文件时，它被我的浏览器解释为 html。存储库位于 https 服务器上。

我在我的 html 代码前面加上了各种标签，这些标签应该提醒浏览器该文件是 html，例如

```
<Content-Type="text/html"> 
```

和

```
<!DOCTYPE html> 
```

甚至是我真的不明白但还是尝试过的这个：

```
<contentType="text/html; charset=iso-8859-1"> 
```

但是没有任何工作......有谁知道一些甜蜜的，简单的方法来欺骗浏览器将文件解释为html？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:34:38.163

该问题与 SVN 存储库的设置有关。您可以在 .htm 文件的正文中添加任何内容，这会导致浏览器将文件解析为 html。它是一种服务器安全功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-09T13:06:18.673

我有同样的问题并解决了它：

将 SVN 属性 'mime-type=text/html' 添加到本地文件（对我来说使用 tortoisesvn），然后提交。

即使您再次提交文件（如果您当然不更改文件名），它将解决问题并保存 Mime 类型。

对于我的 CSS 文件，我使用 'mime-type=text/css' 做了同样的事情

但最好的方法应该是在服务器端关联文件扩展名和 SVN mime-text 属性。

# jquery - 查找多个选择器不一致的奇怪行为

> ID：13976409
> 
> 赞同：3
> 
> 时间：2012-12-20T16:25:59.523
> 
> 标签：jquery, radio-button

我有一个表，`radio`每行都有一个。我想要一个`selected`有.`tr``selected radio`

所以我这样做了：

```
$(":radio[name='grp']").on("change", function() {
    $("#tbl1").find("tr.selected, tr:has(:radio:checked)").toggleClass("selected");
}); 
```

当您开始`radios`从下到上检查时，效果很好。但是，如果您从上到下开始，它会工作一次，然后就不会工作一次，依此类推。

如果没有该`find`功能，我可以隔离代码工作得很好：

```
$(":radio[name='grp2']").on("change", function() {
    $("#tbl2 tr.selected, #tbl2 tr:has(:radio:checked)").toggleClass("selected");
}); 
```

[这里有一个小提琴供你测试](http://jsfiddle.net/paska/TRY7s/)。

这里发生了什么事？

**更新：**我还注意到问题出在`find`方法上，因为当它工作时它总是返回一个长度为 2 的 jQuery 对象。当它不起作用时，它返回一个长度为 1。但是，如果我让两个`find`在分开的句子中，它们都返回长度为 1 并且来自不同的元素。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T16:48:19.657

`:radio`已被弃用，你可以在这里看到[http://api.jquery.com/category/deprecated/](http://api.jquery.com/category/deprecated/)

您应该使用`input[type=radio]`来获取单选按钮

使用`input[type=radio]`完美

[http://jsfiddle.net/kLk6J/](http://jsfiddle.net/kLk6J/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T16:44:28.680

这是你需要做的 -

```
$(":radio[name='grp']").on("change", function() {
    $("#tbl1").find("tr").removeClass("selected");
    $(this).parents("tr").addClass("selected");
}); 
```

对于每个更改，您从所有行中删除选定的类，然后将该类应用于相关单选按钮的父 tr。通过切换，您每次运行时都会打开和关闭课程，这不是您想要的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-20T16:43:58.553

```
 $("input[name='grp']")

 $("input[name='grp2']") 
```

# ruby-on-rails - Rails：链接来自不同控制器/视图的锚点

> ID：13976410
> 
> 赞同：1
> 
> 时间：2012-12-20T16:26:03.767
> 
> 标签：ruby-on-rails, ruby, controller, link-to

```
<%= link_to (:controller => "company_stuff", :action => "index", :anchor => :menu), :class => 'links' do %>
    <li>Terms of Use</li>
<% end %> 
```

我在链接不同控制器上的页面时遇到困难，而且该链接是一个锚点。基本上`controller`叫做is和`company_stuff`the叫做`action``index``anchor``#terms`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T16:39:52.953

问题是`:controller` `:action` `:anchor`没有作为散列传递，与CSS分开`class`

下面是解决方案

```
<%= link_to "Terms Of Use", {:controller => "company_stuff", :anchor => "terms"}, :class => "links" %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T16:40:08.337

我相信你可以尝试这样的事情

```
<%= link_to index_company_stuff_path + "#terms", :class => 'links' do %>
    <li>Terms of Use</li>
<% end %> 
```

或者

```
<%= link_to index_company_stuffs_path + "#terms", :class => 'links' do %>
    <li>Terms of Use</li>
<% end %> 
```

取决于您的控制器名称和路由。

您可以找到有关此问题的更多信息[How to create an anchor and redirect to this specific anchor in Ruby on Rails](https://stackoverflow.com/questions/757891/how-to-create-an-anchor-and-redirect-to-this-specific-anchor-in-ruby-on-rails)

# java - 如何将 RGB 颜色存储到哈希图中？

> ID：13976414
> 
> 赞同：2
> 
> 时间：2012-12-20T16:26:14.880
> 
> 标签：java, map

我想创建一个以 RGB 颜色为键的 HashMap。我应该如何存储它们以获得最佳性能？我的意思是，哈希图的“速度”如何指代键的对象类型？

我应该使用`Integer (018052175)`每个三元组是 RGB 中的一个，`String (1234AF)`作为 HEX，还是使用自己的 Color 类`int r, g, b`？最快的实现可能是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:32:13.567

`hashCode`哈希映射的速度受和`equals`函数的几个基本属性限制：

*   计算多么容易，
*   `hashCode`将值分配到存储桶中的能力如何，以及
*   比较相等的值是多么容易

a的`hashCode`功能`String`非常好，并`String`缓存其结果以提高性能。但是，相等性检查可能比 with 更长`Integer`。

该类在速度方面`Integer`具有非常难以击败的实现`hashCode`，但是由于相似颜色的哈希码会彼此接近，因此您可能会与`Integer`s 发生更多冲突。

`Color` [与 一样快`Integer`](http://www.docjar.com/html/api/java/awt/Color.java.html)，但也是最具描述性的。我严重怀疑选择这三种表示中的一种会严重影响性能以产生明显的差异，因此我建议选择最具描述性的选择，然后在必要时进行配置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T16:28:42.600

唯一的区别是 hashcode/equals 函数的速度，Integer 应该是最快的，尽管它在任何情况下都不太可能成为瓶颈。您可能应该在代码的其他地方使用最方便的任何内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T16:28:54.187

`HashMap`基于`hashCode()`并且[`Integer.hashCode()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html#hashCode%28%29)尽可能快地获得（它是一个恒等函数）：

> 此对象的哈希码值，等于此对象`int`表示的原始值`Integer`。

~~因此去`Integer`表示 24 位 RGB 值。~~然而事实证明它[`Color.hashCode()`](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/awt/Color.java#Color.hashCode%28%29)是一样快的，并且由于`Color`class 比 更具表现力和可读性`Integer`，所以使用`Color`class 代替。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T16:28:49.993

Java 有一个用于存储颜色的内置类，称为[Color](http://docs.oracle.com/javase/7/docs/api/java/awt/Color.html)。

我会去进行优化（我猜使用整数不会快得多），除非你真的看到它的瓶颈

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-20T16:30:27.437

使用`Integer`s，并使用 . 获取它们`new Color(r, g, b).getRGB()`。

要从整数中获取颜色，只需使用`new Color(hashmap.get(index))`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-20T17:22:56.780

`Integer.hashCode()`不比 快`Color.hashCode()`。`java.awt.Color`的`hashCode`实现（Java 1.6）：

```
/**
 * Computes the hash code for this <code>Color</code>.
 * @return     a hash code value for this object.
 * @since      JDK1.0
 */
public int hashCode() {
    return value;
} 
```

`equals`因为两者也是等价的。因此，在您的情况下，我会使用`Color`它，因为它可以更好地传达语义。

# asp.net - 将 ASP 控制器的 ID 从“Test”更改为“MainContent_Test”

> ID：13976415
> 
> 赞同：1
> 
> 时间：2012-12-20T16:26:19.617
> 
> 标签：asp.net

如果我有 a`TABLE`或 a `DROPDOWNLIST`，`ID="Test"`在 Page 中有一个`Default.aspx`, 包含在 a 中`Master Page`，这些控制器会将其 ID 更改为`"MainContent_Test"`，这意味着任何归因于的 CSS`#Test`都不起作用，而且我觉得我也遇到了问题`C#`，为什么这会发生吗？我该如何预防？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T16:32:52.250

如果您使用的是 asp.net 4 及更高版本，您可以设置控件的 ClientIdMode 这将确保它不会更改并且可以通过 css 进行评估。

```
<asp:DropDownList ClientIdMode="Static" ID="Test" runat="server"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T16:32:55.697

ASP.NET 将控制容器的名称添加到生成的客户端 ID。但如果您使用 .NET 4.0 或更高版本，您可以使用 cotntrol 的`ClientIdMode`属性：

[http://msdn.microsoft.com/en-us/library/system.web.ui.control.clientidmode(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.control.clientidmode(v=vs.100).aspx)

只需将其设置为`Static`，ID 就不会改变。

其他选项可能包括通过类定义样式而不将其附加到特定控件 ID。

# php - 返回没有数据的设定值

> ID：13976420
> 
> 赞同：0
> 
> 时间：2012-12-20T16:26:29.950
> 
> 标签：php, mysql, return

我有一份报告，其中显示了销售的产品，以及订购的每种产品的总重量。这是显示总重量的代码标记：

```
$weightsql = 'select op.products_name, sum(op.products_quantity * p.products_weight) as weightsum from ' . TABLE_ORDERS_PRODUCTS . ' op left join ' . TABLE_PRODUCTS . ' p on op.products_id = p.products_id where op.products_id =  '.$pro['products_id'];
$weightq = tep_db_query( $weightsql );
while ($weight = tep_db_fetch_array( $weightq )){
if($category_parent_id != 0)$list_items[] = $weight['weightsum'];
} 
```

它返回已订购产品的值，但对于未订购的产品，它保持空白，这非常令人困惑。我将如何为未订购的产品（未从查询中提取的产品）返回 0.00。

例子：

```
 Product Name         |             Total Weight
                      |
 Jelly Beans          |             25.00
 Soft Candy           |                              This product has not been ordered, needs to show 0.00
 Bubblegum            |             10.00 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:28:38.200

您正在寻找[合并](http://dev.mysql.com/doc/refman/5.6/en/comparison-operators.html#function_coalesce)功能。

```
coalesce( sum(op.products_quantity * p.products_weight), 0 ) 
```

另外，更改`left join`为`right join`因为在您的查询`product`中位于`order`.

这会将 Null 值替换为`0`。

**编辑**到期 OP 评论。您可以添加具有所需样式的新列：

```
select 
   op.products_name, 
   coalesce( sum(op.products_quantity * p.products_weight), 0 ) as weightsum,
   case when sum(op.products_quantity * p.products_weight) is NULL then 'Normal' 
        else 'Bold' end
   as stype
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T16:37:33.580

根据我对您的问题的了解：如果您想要来自 的所有行，以及来自`TABLE_PRODUCTS`的匹配行（如果存在）`TABLE_ORDERS_PRODUCTS`，那么您需要`RIGHT JOIN`而不是`LEFT JOIN`查询中的 a 。

但是，我更喜欢尽可能使用 a `LEFT JOIN`，因此我会重新排序查询中的表

<剪辑>

```
... from ' . TABLE_PRODUCTS . ' p left join ' . TABLE_ORDERS_PRODUCTS . ' op ... 
```

</snip>

如果您的问题是您没有得到您期望的行，那将解决问题。

* * *

另一个问题是处理从 OUTER JOIN 返回的行返回的 NULL 值。快速的答案是将这些表达式包装在一个`IFNULL`函数中以返回 0（或 0.00，如果您需要十进制类型）

<剪辑>

```
... IFNULL( sum(op.products_quantity * p.products_weight) ,0.0) as ... 
```

或者

```
... sum( IFNULL(op.products_quantity,0.0) * IFNULL(p.products_weight, 0.0) ) as 
```

</snip>

* * *

**Q：如果我想让真值加粗，空值正常，来识别已售出的产品，怎么做？**

**A：**

我希望您需要在生成的 HTML中包含适当的**<b>**和**</b>标记。**（我们通常不会从数据库查询中返回这些类型的标记，因为很多标记通常由 CSS 处理。）

从数据库中，您可以在 SELECT 列表中包含一个表达式，让您知道是否在 TABLE_ORDERS_PRODUCT 表中找到了匹配的行，如下所示：

```
 IF(op.products_id IS NULL,0,1) AS is_ordered 
```

如果在 TABLE_ORDERS_PRODUCT 表中未找到匹配项，则返回 0 `products_id`，否则返回 1。

然后，您可以使用此值来确定应将哪种样式或标记应用于您需要加粗的任何元素。

# javascript - 仅打印 div 的内容 - 弹出窗口

> ID：13976428
> 
> 赞同：2
> 
> 时间：2012-12-20T16:26:49.587
> 
> 标签：javascript, printing

> **可能重复：**
> [打印模式弹出窗口的内容](https://stackoverflow.com/questions/465872/print-contents-of-a-modal-popup)

我正在使用以下解决方案来打印弹出窗口的内容：

```
 function printDiv(divName) {
    var printContents = document.getElementById(divName).innerHTML;
    var originalContents = document.body.innerHTML;

    document.body.innerHTML = printContents;

    window.print();

    window.onfocus = function () { document.body.innerHTML = originalContents };
} 
```

内容实际上显示在弹出窗口中。上述解决方案在除`IE8`. 当我尝试打印内容时，通过调用上述函数 -`IE8`打印页面的全部内容以及下一页中的黑框？

如何修复此错误`IE8`？感谢您的帮助/建议。

# c# - ServiceStack.Razor 从剃刀视图输出绝对 URL

> ID：13976434
> 
> 赞同：3
> 
> 时间：2012-12-20T16:27:10.140
> 
> 标签：c#, razor, servicestack

玩转[https://github.com/ServiceStack/RazorRockstars](https://github.com/ServiceStack/RazorRockstars)，非常喜欢。只是想知道是否有人可以帮助我找到一种在使用自托管应用程序时从视图中输出绝对 URL 的方法？

这是我能想到的最好的：

```
public static class UrlHelperExtensions
{
    public static string AbsoluteContent(this UrlHelper urlHelper, string path)
    {
        var baseUri = new Uri(EndpointHost.AppHost.Config.WebHostUrl);
        return new Uri(baseUri, path).ToString();
    }
} 
```

配置主机时我设置 AppHost.Config.WebHostUrl 的位置

**更新**

抱歉，我应该更清楚一点，我实际上是在以一种稍微不标准的方式使用 ServiceStack——作为呈现电子邮件模板的一种方式。所以我有一项服务，例如：

```
public class EmailService : Service
{
    public void Post(EmailTask request)
    {
        var format = GetAppHost().Plugins.Find(x => x is RazorFormat) as RazorFormat;
        var template = format.ExecuteTemplate(request.Model,   request.Template.ToString(), string.Empty);
        var html = template.Result;
        // email the rendered template etc
    }
} 
```

渲染模板时，Request 对象为 null

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T01:46:28.193

在 Razor [ViewPageBase](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.Razor/ViewPageBase.cs)中，您可以访问HTTP `base.Request`，并且`base.Response`可以在其中访问有关请求的元数据，例如`base.Request.AbsoluteUri`返回当前的 Request Url，其中应该包含您想要的信息。

# c - pthread_join 不起作用

> ID：13976439
> 
> 赞同：0
> 
> 时间：2012-12-20T16:27:38.767
> 
> 标签：c, multithreading, join, pthreads

我想要完成的事情：

在主函数中创建了两个线程。他们用数字 5 增加一个全局变量。并向消费者线程发送一个递减变量的信号。在每次递减之间的消费者线程中，显示​​当前值。主线程必须等到所有线程都完成然后退出。

我得到什么：

有时，主函数在消费者有机会显示结果之前就退出了。我正在使用 pthread_join，但它返回错误代码 3。

任何想法如何获得想要的结果？

代码如下。

```
#include <pthread.h>
#include <stdio.h>
#include <string.h>
#include <errno.h>

static pthread_mutex_t mtx;
static pthread_cond_t cond = PTHREAD_COND_INITIALIZER;

void *producer(void *arg);
void *consumer(void *arg);
static int avail = 0;

int main(int argc, char *argv[]){

    pthread_t cons1, prod1, prod2;

    int status;
    int t1;
    int t2;
    int t3;

    pthread_attr_t attr;
    pthread_attr_init(&attr);
    pthread_attr_setdetachstate(&attr, PTHREAD_CREATE_JOINABLE);

    pthread_mutexattr_t mtxAttr;
    pthread_mutexattr_settype(&mtxAttr, PTHREAD_MUTEX_ERRORCHECK);
    pthread_mutex_init(&mtx, &mtxAttr);

    t1 = pthread_create(&prod1, &attr, producer, NULL);
    if(t1 != 0){
    perror("problem1");
    }
    t2 = pthread_create(&prod2, &attr, producer, NULL);
    if(t2 != 0){
    perror("problem2");
    }
    t3 = pthread_create(&cons1, &attr, consumer, NULL);
    if(t3 != 0){
    perror("problem3");
    }

    status = pthread_join(t1, NULL);
    if(status != 0){
    perror("can't join1");
    }

    status = pthread_join(t2, NULL);
    if(status != 0){
    perror("can't join2");
    printf("\n%d\n", status);
    }
    status = pthread_join(t3, NULL);
    if(status != 0){
    printf("%s",strerror(errno));
    }
    printf("\nend result \t%d\n",avail);
    printf("fin\n");
    //while(1){}
    return 0;
}

void *producer(void *arg){
    int s;
    printf("producer\n");
    s = pthread_mutex_lock(&mtx);
    avail+=5;
    s = pthread_mutex_unlock(&mtx);
    s = pthread_cond_signal(&cond);
    pthread_exit(NULL);
}

void *consumer(void *arg){
    int s;
    while(1) {
    s = pthread_mutex_lock(&mtx);
    if(s !=0 ){
        perror("lock err");
    }
    while (avail == 0) {
        s = pthread_cond_wait(&cond, &mtx);
    }
    while (avail > 0) {
        avail--;
        printf("Temp: %d \n",avail);
    }

    s = pthread_mutex_unlock(&mtx);
    }
    printf("done");
    pthread_exit(NULL);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T16:54:14.603

不要加入`t1`，`t2`或`t3`。这些是`pthread_create()`函数的返回码。使用`pthread_join()`on`prod1`和`prod2`代替`cons1`。请用`-Wall -Wextra`.

# java - 多线程，读取多个文件并并行发送到服务器

> ID：13976443
> 
> 赞同：2
> 
> 时间：2012-12-20T16:27:42.130
> 
> 标签：java, multithreading, file

```
public class SOAPClient implements Runnable {

    /*
     * endpoint url, the address where soap xml will be sent. It is hard coded
     * now, later on to be made configurable
     */
    private String endpointUrl = "";
    /*
     * This is for debugging purposes Message and response are written to the
     * fileName
     */
    static String fileName = "";

    /*
     * serverResponse This is a string representation of the response received
     * from server
     */
    private String serverResponse = null;

    public String tempTestStringForDirectory = "";

    /*
     * A single file or a folder maybe provided
     */
    private File fileOrFolder;

    public SOAPClient(String endpointURL, File fileOrFolder) {
        this.endpointUrl = endpointURL;
        this.fileOrFolder = fileOrFolder;
        serverResponse = null;
    }

    /*
     * Creats a SOAPMessage out of a file that is passed
     * 
     * @param fileAddress - Contents of this file are read and a SOAPMessage is
     * created that will get sent to the server. This is a helper method. Is
     * this step (method, conversion) necessary? set tempSoapText = XML String,
     * currently getting from file, but it can be a simple string
     */
    private SOAPMessage xmlStringToSOAPMessage(String fileAddress) {
        System.out.println("xmlStringToSoap()");
        // Picking up this string from file right now
        // This can come from anywhere
        String tempSoapText = readFileToString(fileAddress);
        SOAPMessage soapMessage = null;
        try {
            // Create SoapMessage
            MessageFactory msgFactory = MessageFactory.newInstance();
            SOAPMessage message = msgFactory.createMessage();
            SOAPPart soapPart = message.getSOAPPart();
            // Load the SOAP text into a stream source
            byte[] buffer = tempSoapText.getBytes();
            ByteArrayInputStream stream = new ByteArrayInputStream(buffer);
            StreamSource source = new StreamSource(stream);
            ByteArrayOutputStream out = new ByteArrayOutputStream();
            // Set contents of message
            soapPart.setContent(source);
            message.writeTo(out);
            soapMessage = message;
        } catch (SOAPException e) {
            System.out.println("soapException xmlStringToSoap()");
            System.out.println("SOAPException : " + e);
        } catch (IOException e) {
            System.out.println("IOException xmlStringToSoap()");
            System.out.println("IOException : " + e);
        }
        return soapMessage;
    }

    /*
     * Reads the file passed and creates a string. fileAddress - Contents of
     * this file are read into a String
     */
    private String readFileToString(String fileAddress) {
        FileInputStream stream = null;
        MappedByteBuffer bb = null;
        String stringFromFile = "";
        try {
            stream = new FileInputStream(new File(fileAddress));
            FileChannel fc = stream.getChannel();
            bb = fc.map(FileChannel.MapMode.READ_ONLY, 0, fc.size());
            stringFromFile = Charset.defaultCharset().decode(bb).toString();
        } catch (IOException e) {
            System.out.println("readFileToString IOException");
            e.printStackTrace();
        } finally {
            try {
                stream.close();
            } catch (IOException e) {
                System.out.println("readFileToString IOException");
                e.printStackTrace();
            }
        }
        return stringFromFile;
    }

    /*
     * soapXMLtoEndpoint sends the soapXMLFileLocation to the endpointURL
     */
    public void soapXMLtoEndpoint(String endpointURL, String soapXMLFileLocation) throws SOAPException {
        SOAPConnection connection = SOAPConnectionFactory.newInstance().createConnection();
        SOAPMessage response = connection.call(xmlStringToSOAPMessage(soapXMLFileLocation), endpointURL);
        connection.close();
        SOAPBody responseBody = response.getSOAPBody();
        SOAPBodyElement responseElement = (SOAPBodyElement) responseBody.getChildElements().next();
        SOAPElement returnElement = (SOAPElement) responseElement.getChildElements().next();
        if (responseBody.getFault() != null) {
            System.out.println("fault != null");
            System.out.println(returnElement.getValue() + " " + responseBody.getFault().getFaultString());
        } else {
            serverResponse = returnElement.getValue();
            System.out.println(serverResponse);
            System.out.println("\nfault == null, got the response properly.\n");
        }
    }

    /*
     * This is for debugging purposes. Writes string to a file.
     * 
     * @param message Contents to be written to file
     * 
     * @param fileName the name of the
     */
    private static void toFile(String message, String fileName) {
        try {
            FileWriter fstream = new FileWriter(fileName);
            System.out.println("printing to file: ".concat(fileName));
            BufferedWriter out = new BufferedWriter(fstream);
            out.write(message);
            out.close();
        } catch (Exception e) {
            System.out.println("toFile() Exception");
            System.err.println("Error: " + e.getMessage());
        }
    }

    /*
     * Using dom to parse the xml. Getting both orderID and the description.
     * 
     * @param xmlToParse XML in String format to parse. Gets the orderID and
     * description Is the error handling required? What if orderID or
     * description isn't found in the xmlToParse? Use setters and getters?
     * 
     * @param fileName only for debuggining, it can be safely removed any time.
     */
    private void domParsing(String xmlToParse, String fileName) {
        if (serverResponse == null) {
            return;
        } else {
            try {
                System.out.println("in domParsing()");
                DocumentBuilderFactory dbFactory = DocumentBuilderFactory.newInstance();
                DocumentBuilder dBuilder = dbFactory.newDocumentBuilder();
                System.out.println("serverResponse contains fault");
                Document doc = dBuilder.parse(new InputSource(new StringReader(serverResponse)));
                doc.getDocumentElement().normalize();
                NodeList orderNodeList = doc.getElementsByTagName("Order");
                if (orderNodeList.getLength() > 0) {
                    tempTestStringForDirectory = tempTestStringForDirectory + "\n Got order\n" + "\n" + fileName + "\n" + "got order\n";
                    for (int x = 0; x < orderNodeList.getLength(); x++) {
                        System.out.println(orderNodeList.item(x).getAttributes().getNamedItem("orderId").getNodeValue());
                    }
                }
                NodeList descriptionNodeList = doc.getElementsByTagName("Description");
                if (descriptionNodeList.getLength() > 0) {
                    System.out.println("getting description");
                    String tempDescriptionString = descriptionNodeList.item(0).getTextContent();
                    System.out.println(tempDescriptionString);
                    tempTestStringForDirectory = tempTestStringForDirectory + "\n Got description" + "\n" + fileName + "\n" + tempDescriptionString + "\n";
                }
            } catch (Exception e) {
                System.out.println("domParsing() Exception");
                e.printStackTrace();
            }
        }
    }

    /*
     * Reads a single file or a whole directory structure
     */
    private void listFilesForFolder(final File fileOrFolder) {
        String temp = "";
        if (fileOrFolder.isDirectory()) {
            for (final File fileEntry : fileOrFolder.listFiles()) {
                if (fileEntry.isDirectory()) {
                    listFilesForFolder(fileEntry);
                } else {
                    if (fileEntry.isFile()) {
                        temp = fileEntry.getName();
                        try {
                            soapXMLtoEndpoint(endpointUrl, fileOrFolder.getAbsolutePath() + "\\" + fileEntry.getName());
                            domParsing(serverResponse, fileEntry.getName());
                        } catch (SOAPException e) {
                            e.printStackTrace();
                        }
                    }
                }
            }
        }
        if (fileOrFolder.isFile()) {
            temp = fileOrFolder.getName();
            System.out.println("this is a file");
            System.out.println(temp);
            try {
                soapXMLtoEndpoint(endpointUrl, fileOrFolder.getAbsolutePath());
            } catch (SOAPException e) {
                e.printStackTrace();
            }
            domParsing(serverResponse, temp);
        }
    }

    @Override
    public void run() {
        listFilesForFolder(fileOrFolder);
        toFile(tempTestStringForDirectory, "test.txt");
    }

    public static void main(String[] args) {
        String tempURLString = ".../OrderingService";
        String tempFileLocation = "C:/Workspace2/Test5/";
        SOAPClient soapClient = new SOAPClient(tempURLString, new File(tempFileLocation));
        Thread thread = new Thread(soapClient);
        thread.start();
        System.out.println("program ended");
    }
} 
```

我认为 n 个文件的 n 个线程会很糟糕？那不会使系统崩溃，或者给太多线程错误吗？我正在尝试使我的程序多线程。我不知道我错过了什么。我的程序有一个逻辑可以知道是传递了单个文件还是传递了目录。如果传递一个文件，一个线程就可以了。但是如果一个目录通过了怎么办？我需要在我的 listFilesForFolder 方法中创建线程吗？线程总是从 main 方法启动，还是可以从其他方法启动？另外，这个程序会被其他人使用，所以正确处理线程应该是我的工作。他们所要做的就是使用我的程序。所以我觉得线程逻辑不应该属于main方法，而应该属于listFilesForFolder，这是我程序的起点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T17:59:43.933

据我所知，大多数下载管理器会尝试一次最多下载大约 3 个文件，正负两个。我建议你这样做。本质上，你可以做这样的事情（伪代码）

```
//Set up a list of objects
fileList={"a","b","c"}
nextIndex=0;
Mutex mutex
//Start_X_threads

String next_object(void){
  String nextFile;
  try{
    mutex.acquire();
    try {
        if (nextFileIndex<fileList.length)
        {
          nextFile=fileList(nextFileIndex);
          nextFileIndex++;
        }
        else
           nextFile="";
    }
    finally
    {
        mutex.release();
    }
  } catch(InterruptedException ie) {
    nextFile="";
  }
  return nextFile;
} 
```

每个线程：

```
String nextFile;
do
{
   nextFile=nextObject();
   //Get nextFile
} while (!nextFile.equals("")) 
```

# iphone - 将用户加速从 iPhone devieMotion 保存到文件文本

> ID：13976446
> 
> 赞同：0
> 
> 时间：2012-12-20T16:27:46.857
> 
> 标签：iphone, xcode, accelerometer

我正在使用 deviceMotion 来获取`useracceleration(x, y, z)`. 我的目标是创建一个文件文本，在每次迭代中，我的应用程序都会连续写入 3 个组件。

我正在使用 MotionGraphs 代码示例。

怎么可能 - 直接，或者必须先创建一个数组？这个数组；它是 NSMutableArray 还是 NSMutableNumber？

我一直在寻找这个问题，我迷路了。:-(

我不是 Objective-C 专家，但我记得我打开文件的 Pascal 代码，然后我在每次迭代中编写，但我检查了：编程已经改变。

一开始我们没有考虑不同的过滤器或区分窗口。对于他们，我已经实施了飞思卡尔程序。我只是想保存加速度计数据/使用 deviceMotion userAcceleration 存储来自加速度计的数据。

```
 float minX = 1.0f;

    float minY = 1.0f;

    float minZ = 1.0f;

    NSMutableArray *container = [[NSMutableArray alloc] init];

    -(void)startUpdatesWithSliderValue:(int)sliderValue
    {

        NSTimeInterval delta = 0.005;

        NSTimeInterval updateInterval = deviceMotionMin + delta * sliderValue;

        CMMotionManager *mManager = [(APLAppDelegate *)[[UIApplication sharedApplication] delegate] sharedManager];

        APLDeviceMotionGraphViewController * __weak weakSelf = self;

        [container addObject:[NSNumber numberWithFloat:deviceMotion.userAcceleration.x]];

        [container addObject:[NSNumber numberWithFloat:deviceMotion.userAcceleration.y]];

        [container addObject:[NSNumber numberWithFloat:deviceMotion.userAcceleration.z]];
    }

//Finally we have to dump data to filetext, this is I don´t know correctly. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:03:53.853

**1** 创建 NSMutableArray *container = [[NSMutableArray alloc] init]; 成为你的容器。

**2** 在检测运动的加速度计委托方法中，请务必为 3 个轴中的每一个设置一个最小值。例如浮动 min_X = 1.0f; 浮动 min_y =1.0f; 浮动 min_Z = 1.0f

> ```
> -(void)accelerometer:(UIAccelerometer *)accelerometer didAccelerate:(UIAcceleration *)acceleration {
> 
> } 
> ```

**3** 使用简单过滤器逻辑，如下所示：（请记住，加速度最大值为 +- 2.3g，因此需要考虑正阈值和负阈值。

> ```
> if ((acceleration.x > min_X || acceleration.x < -min_X) && (Y's..) && (Z's...) ) {
> 
> [container addObject:[NSNumber numberWithFloat:acceleration.x]];
> [container addObject:[NSNumber numberWithFloat:acceleration.y]];
> [container addObject:[NSNumber numberWithFloat:acceleration.z]];
> 
> } 
> ```

**4** Array 应包含三个一组 (x,y,z) 的 NSNumber。

**5**需要过滤器，否则加速度计可以拾取放在桌子上的小振动。

* * *

**警告：** 阵列会很快填满，因此请根据您想要记录数据的时间将采样率设置为可接受的范围。

# android - 如何使用achartengine在动态图表中及时回滚

> ID：13976450
> 
> 赞同：1
> 
> 时间：2012-12-20T16:27:57.247
> 
> 标签：android, dynamic, charts, scroll, achartengine

我实现了一个动态图表，可以实时绘制 wifi 从微控制器发送的数据。我正在尝试及时回滚，但我不知道如何做到这一点。你能帮助我吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T20:16:58.010

您首先需要以这种方式设置可见范围：

```
renderer.setXAxisMin(minValue);
renderer.setXAxisMax(maxValue); 
```

然后，在图形视图上调用 repaint：

```
chartView.repaint(); 
```

# jquery - Web API 通过 jQuery POST 发送多个对象

> ID：13976451
> 
> 赞同：2
> 
> 时间：2012-12-20T16:28:01.813
> 
> 标签：jquery, json, asp.net-web-api

我有一个接受检查模型的 Web API 控制器，即

```
public class Inspection
{
    public int ID {get; set;}
} 
```

我在控制器上创建了一个 POST 方法。这很好用，我已经用 jQuery 对其进行了测试。

在我的 javascript 页面中，我创建了一个检查，即

```
var inspection = {
    ID: '123456'
}; 
```

然后像这样做 $.ajax ：

```
var p = $.ajax({
    type: 'POST',
    url: 'http://...',
    cache: false,
    data: JSON.stringify(item),
    dataType: 'json',
    success: function(response) {
        //do stuff
    }
}); 
```

所以我的问题是：如果我有多个检查要发布，我如何将它们全部发送到控制器，无论是一批还是一批？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T19:48:50.507

在一次调用中发布多个整数应该很容易。一些快速检查的事情：

1.  在您的控制器中，您的方法签名是否类似于：

    ```
    public void Post([FromBody]int[] values) { // code here } 
    ```

    请注意 [FromBody] 属性的使用。

2.  在您的 POST 中，内容类型标头是否设置为“ **Content-Type: application/json** ”？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T16:33:00.440

嗯，根据您的服务器的期望，这样的事情可能会起作用：

```
var itemArr = [inspection0, inspection1, inspection2]; // etc...

var p = $.ajax({
    type: 'POST',
    url: 'http://...',
    cache: false,
    data: JSON.stringify(itemArr),
    dataType: 'json',
    success: function(response) {
        //do stuff
    }
}).fail(function(data) {
    // handle failure
}); 
```

或者，分批发送：

```
var i = 0,
    max = itemArr.length;

for (; i < max; i++) {
    $.ajax({
        type: 'POST',
        url: 'http://...',
        cache: false,
        data: JSON.stringify(itemArr[i]),
        dataType: 'json',
        success: function(response) {
            //do stuff
        }
    }).fail(function(data) {
        // handle failure
    });
} 
```

此外，添加处理程序可能也是一个好主意`.fail(...)`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T16:34:46.423

我过去曾使用[jQuery.json](http://code.google.com/p/jquery-json/)插件来应对这种情况。

这是[我发现的一个示例](http://forums.asp.net/t/1517358.aspx/1)，说明如何使用它在单个 AJAX 调用中发送多个项目：

```
<script src="<%= Url.Content("~/Scripts/jquery-1.3.2.min.js") %>" type="text/javascript"></script>
<script src="<%= Url.Content("~/Scripts/jquery.json-2.2.min.js") %>" type="text/javascript"></script>
<script type="text/javascript">
  function savePayment() {
    //Creating some test data
    var lineItems = new Object();
    lineItems.Entrys = new Array();
    lineItems.Entrys[0] = new Object({ Approved: "1.0", Deductible: "1.0", Coinsurance: "1.0", PaymentAmount: "1.0", VisitId: "1.0", VisitChargeId: "1.0" });
    lineItems.Entrys[1] = new Object({ Approved: "2.0", Deductible: "2.0", Coinsurance: "2.0", PaymentAmount: "2.0", VisitId: "2.0", VisitChargeId: "2.0" });

    //Posting them to server with ajax
    $.ajax({
      type: 'POST',
      contentType: 'application/json; charset=utf-8',
      url: '<%=Url.Action("SavePayment", "Home") %>',
      dataType: 'json',
      data: $.toJSON(lineItems),
      success: function(result) {
        if (result) {
          alert('Success');
        }
        else {
          alert('Failure');
        }
      }
    });
  }
</script> 
```

# ruby-on-rails - RoR：将生成的 JSON 过滤到某些参数

> ID：13976459
> 
> 赞同：1
> 
> 时间：2012-12-20T16:28:39.897
> 
> 标签：ruby-on-rails, ruby, json

我生成 JSON 如下：

```
def suggest_gems
  @allgems = RubyGem.where("name like ?", "%#{params[:q]}%")
  respond_to do |format|
  format.json { render :json => @allgems.to_json }
  end
end 
```

但是，RubyGem 表非常大，其中包含描述、链接和创建、更新的值。如何仅在生成的 JSON 中输出名称和 ID 以减少加载时间？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T16:41:11.677

你可以真正清理你的控制器方法并实现你想要的这样：

```
def suggest_gems
  @allgems = RubyGem.where("name like ?", "%#{params[:q]}%")
  respond_with(@allgems, :only => [:id, :name])
end 
```

如果你在控制器的顶部有这个：

```
respond_to :json 
```

编辑

如果您不想使用`respond_to`，请执行以下操作：

```
def suggest_gems
  @allgems = RubyGem.where("name like ?", "%#{params[:q]}%")
  render :json => @allgems.as_json(:only => [:id, :name])
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T16:35:33.917

您需要`as_json`在模型中覆盖以仅返回要发回的属性。

```
def as_json(options)
  super(only: [:id, :name])
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T17:08:31.637

所以我想出了如何在不改变`as_json`方法或使用`respond_with`语句的情况下通过添加几行代码来做到这一点。这是我所做的：

```
def suggest_gems (result = [])
   @allgems = RubyGem.where("name like ?", "%#{params[:q]}%")
   @allgems.each { |g|
     result << { :id => g.id, :name => g.name }
     } 
   respond_to do |format|
   format.json { render :json => result.to_json }
   end
end 
```

我基本上定义了一个数组并相应地关联了`name`and`id`属性，然后将数组格式化为 JSON。加载时间缩短了大约 6 秒 :)

在此处添加此答案，以便其他人可能会发现它有帮助！

# c# - 绘制多维向量的 K-Means 簇

> ID：13976461
> 
> 赞同：3
> 
> 时间：2012-12-20T16:28:43.600
> 
> 标签：c#, plot, machine-learning, k-means, scientific-computing

我有 100 x 13 个向量作为我在 C# 中实现的 K-Means 聚类的输入。我想绘制我的聚类结果，即 13 维数据点

我已经看到了 2D 和 3D 绘图库的示例，例如[OxyPlot](http://oxyplot.codeplex.com/)、[ZedGraph](http://sourceforge.net/projects/zedgraph/)等。但是找不到任何绘制 N 维数据的示例（其中 N > 3，在我的情况下为 N = 13）。

谁能建议我如何在 C# 中实现这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-01T12:10:49.270

那么，你有 13 维显示器吗？然后绘制 13 维数据会很容易。

任何超过二维的东西都需要**某种投影**（好吧，实际上即使在二维中你也需要一些投影）。如果您添加时间（=动画），那么您可以通过旋转投影来合理地可视化 3 维。

因此，对于超过 3 个维度的可视化，有两种非常流行的技术：

*   降维。这包括使用 PCA 来识别高方差轴。或者，您可能想尝试多维缩放

*   平行坐标。每个维度都有一个轴，但轴不相交而是平行绘制。每个向量不再是一个点，而是一条在适当高度连接轴的线。所以向量 (1,2,0) 是一条折线，从第一个轴上的 1 到第二个轴上的 2 和第三个轴上的 0。

*   还有更多的东西，比如笑脸、字形和类似的可视化技术。获取一些有关数据可视化的讲座幻灯片，您应该会看到其中的一些技术。

要查看平行坐标的示例，您可以将数据集加载到[ELKI](http://elki.dbs.ifi.lmu.de/)中并在那里运行 k-means。粗线应表示平行坐标图中的平均值，而细线是数据实例。

# .net - 用于可视化数据集操作的 .net 控件

> ID：13976469
> 
> 赞同：2
> 
> 时间：2012-12-20T16:29:00.883
> 
> 标签：.net, winforms, dataset, controls

这个问题很简单，答案可能不是。基本上，在我的应用程序中，我在内存中有一个数据集。这个数据集有一些 dataTables 和一些 dataRelations。我想允许最终用户添加一个作为查询结果的数据表。用户还应该能够指定他的数据表和默认数据表之间的一种（或更多）关系。他应该不能删除或修改原始数据集。

这是显示控件应如何工作的图像： ![数据集编辑器](../Images/c7b697a9b9c0854f6c753b8832ec032e.png)

不需要以可视方式删除/修改关系或删除/修改数据表的能力。像下面这样的向导就足够了： ![数据表编辑器](../Images/4b998b58d2edc64cc5c7ccc9e3b6f97e.png)

![关系编辑](../Images/b69fcc063f912b675ab3d677f6672c01.png)

图片来自这个页面： http: [//www.devart.com/dotconnect/mysql/docs/DataSetEditor.html](http://www.devart.com/dotconnect/mysql/docs/DataSetEditor.html)

从头开始创建我自己的控件肯定不是微不足道的，所以我正在寻找可以使用（或易于修改）的东西。如果您曾经使用过 Visual Studio 数据集设计器，您应该明白我在寻找什么。事实上，我想要一个类似于 DataSet Designer 的控件，但能够“锁定”一些数据表和数据关系，并能够根据查询结果添加可编辑的数据表。

如果不够清楚，请询问更多信息。谢谢你。

编辑：当然，默认数据集不是查询的结果。在这种情况下，我可以允许最终用户编辑原始查询添加`join`，`union`等等。我提供的数据集是精心设计的结果，因此它仅“存在”于内存中。也许，我可以将它保存在数据库内的临时表中。无论如何，在探索这个解决方案之前，最好有一个可视化工具而不是查询编辑器......

EDIT2：网上冲浪我发现了这个 SQL 工具： http: [//www.atlantis-interactive.co.uk/products/schemasurf/default.aspx](http://www.atlantis-interactive.co.uk/products/schemasurf/default.aspx)。我正在寻找的是类似的，但应该是一个 WinForm 控件。它应该接受任何类型的数据集，而不仅仅是 SQL。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T10:32:43.090

网络上似乎没有这样的控件。我创建了自己的编辑器，大部分是文本方式。对于表描述，我使用了 TreeList。我对关系描述所做的相同。我没有为 SQL 使用任何特殊的编辑器。现在，我刚刚检查了文本是否以“SELECT”开头。

为了转换 DataTable 中的任何 IEnumerable，我查看了[MoreLINQ](http://code.google.com/p/morelinq/)。

# hadoop - 在两个节点 hadoop 集群中运行 map 缩减作业时出错：太多 fetch-failures，读取任务输出时出错 http://localhost:50060/tasklog

> ID：13976470
> 
> 赞同：1
> 
> 时间：2012-12-20T16:29:02.547
> 
> 标签：hadoop, mapreduce

我已经建立了一个两个节点的 hadoop 集群。我启动了 hadoop 文件系统并正确地映射了缩减的守护进程，并验证了它们正在主服务器和从服务器上运行。我可以使用命令 bin/hadoop dfs -getmerge hdfs://my.domain.com:54310/user/wordcount/sunzi.txt /tmp/wordcount 从主节点和从节点读取输入文件。当我运行 map reduce 作业时，我在输出中看到错误。这项工作最终完成了，但 reduce 部分需要很长时间，并且每次打印错误时它都会继续返回 map 任务。我的站点配置文件引用了 master 的 dns 名称，所以我不知道为什么作业试图从 'localhost' 读取任务输出

```
12/12/20 10:47:36 INFO input.FileInputFormat: Total input paths to process : 7
12/12/20 10:47:36 INFO util.NativeCodeLoader: Loaded the native-hadoop library
12/12/20 10:47:36 WARN snappy.LoadSnappy: Snappy native library not loaded
12/12/20 10:47:36 INFO mapred.JobClient: Running job: job_201212201046_0001
12/12/20 10:47:37 INFO mapred.JobClient:  map 0% reduce 0%
12/12/20 10:47:44 INFO mapred.JobClient:  map 42% reduce 0%
12/12/20 10:47:45 INFO mapred.JobClient:  map 57% reduce 0%
12/12/20 10:47:49 INFO mapred.JobClient:  map 71% reduce 0%
12/12/20 10:47:50 INFO mapred.JobClient:  map 100% reduce 0%
12/12/20 10:47:54 INFO mapred.JobClient:  map 100% reduce 2%
12/12/20 10:48:08 INFO mapred.JobClient: Task Id : attempt_201212201046_0001_m_000002_0, Status : FAILED
Too many fetch-failures
12/12/20 10:48:08 WARN mapred.JobClient: Error reading task outputhttp://localhost:50060/tasklog?plaintext=true&attemptid=attempt_201212201046_0001_m_000002_0&filter=stdout
12/12/20 10:48:08 WARN mapred.JobClient: Error reading task outputhttp://localhost:50060/tasklog?plaintext=true&attemptid=attempt_201212201046_0001_m_000002_0&filter=stderr
12/12/20 10:48:08 INFO mapred.JobClient: Task Id : attempt_201212201046_0001_m_000001_0, Status : FAILED
Too many fetch-failures
12/12/20 10:48:09 INFO mapred.JobClient:  map 85% reduce 2%
12/12/20 10:48:10 INFO mapred.JobClient:  map 71% reduce 2%
12/12/20 10:48:11 INFO mapred.JobClient:  map 85% reduce 2%
12/12/20 10:48:12 INFO mapred.JobClient:  map 100% reduce 2%
12/12/20 10:48:33 INFO mapred.JobClient:  map 100% reduce 3%
12/12/20 10:48:34 INFO mapred.JobClient:  map 100% reduce 4%
12/12/20 10:48:47 INFO mapred.JobClient: Task Id : attempt_201212201046_0001_m_000003_0, Status : FAILED
Too many fetch-failures 
```

我在任务跟踪器日志中看到了这一点：

```
2012-12-20 10:51:22,255 WARN org.apache.hadoop.mapred.TaskTracker: Unknown child with bad map output: attempt_201212201046_0001_m_000005_2\. Ignored.
2012-12-20 10:51:22,256 INFO org.apache.hadoop.mapred.TaskTracker.clienttrace: src: 127.0.0.1:50060, dest: 127.0.0.1:49774, bytes: 0, op: MAPRED_SHUFFLE, cliID: attempt_201212201046_0001_m_000005_2, duration: 1870835
2012-12-20 10:51:22,257 WARN org.mortbay.log: /mapOutput: org.apache.hadoop.util.DiskChecker$DiskErrorException: Could not find taskTracker/apollo/jobcache/job_201212201046_0001/attempt_201212201046_0001_m_000005_2/output/file.out.index in any of the configured local directories
2012-12-20 10:51:23,225 INFO org.apache.hadoop.mapred.TaskTracker: attempt_201212201046_0001_r_000002_0 0.19047621% reduce > copy (4 of 7 at 0.00 MB/s) > 
2012-12-20 10:51:26,239 INFO org.apache.hadoop.mapred.TaskTracker: attempt_201212201046_0001_r_000002_0 0.19047621% reduce > copy (4 of 7 at 0.00 MB/s) > 
2012-12-20 10:51:26,372 INFO org.apache.hadoop.mapred.TaskTracker: attempt_201212201046_0001_r_000000_0 0.19047621% reduce > copy (4 of 7 at 0.00 MB/s) > 
2012-12-20 10:51:32,255 INFO org.apache.hadoop.mapred.TaskTracker: attempt_201212201046_0001_r_000002_0 0.19047621% reduce > copy (4 of 7 at 0.00 MB/s) > 
2012-12-20 10:51:32,387 INFO org.apache.hadoop.mapred.TaskTracker: attempt_201212201046_0001_r_000000_0 0.19047621% reduce > copy (4 of 7 at 0.00 MB/s) > 
2012-12-20 10:51:35,401 INFO org.apache.hadoop.mapred.TaskTracker: attempt_201212201046_0001_r_000000_0 0.19047621% reduce > copy (4 of 7 at 0.00 MB/s) > 
2012-12-20 10:51:37,116 WARN org.apache.hadoop.mapred.TaskTracker: getMapOutput(attempt_201212201046_0001_m_000005_2,0) failed :
org.apache.hadoop.util.DiskChecker$DiskErrorException: Could not find taskTracker/apollo/jobcache/job_201212201046_0001/attempt_201212201046_0001_m_000005_2/output/file.out.index in any of the configured local directories
        at org.apache.hadoop.fs.LocalDirAllocator$AllocatorPerContext.getLocalPathToRead(LocalDirAllocator.java:429)
        at org.apache.hadoop.fs.LocalDirAllocator.getLocalPathToRead(LocalDirAllocator.java:160)
        at org.apache.hadoop.mapred.TaskTracker$MapOutputServlet.doGet(TaskTracker.java:4009)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:707)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)
        at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
        at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1221)
        at org.apache.hadoop.http.HttpServer$QuotingInputFilter.doFilter(HttpServer.java:848)
        at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)
        at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:399)
        at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
        at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
        at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)
        at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:450)
        at org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:230)
        at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
        at org.mortbay.jetty.Server.handle(Server.java:326)
        at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
        at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:928)
        at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:549)
        at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)
        at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
        at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:410)
        at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T16:43:51.043

对于未来的 googlers，我可以通过从 /etc/hosts 文件中删除以下条目来解决此问题

```
127.0.0.1 localhost 
```

我不明白为什么 Hadoop 开始尝试使用 localhost。

# shell - 如果 [ "x" != x ] 在 bash 中做什么？

> ID：13976472
> 
> 赞同：11
> 
> 时间：2012-12-20T16:29:05.453
> 
> 标签：shell

我正在查看 virtualenv 的源代码，激活脚本包含以下代码：

```
if [ -z "$VIRTUAL_ENV_DISABLE_PROMPT" ] ; then  
    _OLD_VIRTUAL_PS1="$PS1"    
    if [ "x" != x ] ; then
        PS1="$PS1"
    else 
    if [ "`basename \"$VIRTUAL_ENV\"`" = "__" ] ; then
        # special case for Aspen magic directories
        # see http://www.zetadev.com/software/aspen/
        PS1="[`basename \`dirname \"$VIRTUAL_ENV\"\``] $PS1"
    else
        PS1="(`basename \"$VIRTUAL_ENV\"`)$PS1"
    fi
    fi
    export PS1
fi 
```

线路`if [ "x" != x ]`有什么作用？x 未在脚本的其他任何地方定义。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-20T16:33:23.273

在 Bash 中，该测试肯定会失败；`[ "x" != x ]`总是返回非零退出状态（即“false”），因为`"x"`和`x`都是由单个字符组成的字符串`x`。（在这种情况下，引号实际上没有任何作用。）

更重要的是，该命令`PS1="$PS1"`实际上也没有做任何事情：它只是将变量设置为`PS1`等于它已经拥有的值。

我猜这个脚本是以某种方式自动生成的，并且在某些系统上，这些语句看起来会有点不同，而且有点没用。

# servicestack - ServiceStack 和 'ServiceStack.Text.Jsv.JsvReader`1' 的类型初始值设定项

> ID：13976473
> 
> 赞同：1
> 
> 时间：2012-12-20T16:29:07.233
> 
> 标签：servicestack

我在 .net 应用程序中使用 ServiceStack (3.9.32)

我正在使用 XSD2Code 生成基于 XSD 创建请求

注册路线时，

```
Routes.Add<ahdc.core.entities.external.order.LabOrder>("/LabOrder", "POST")
                .Add<Request.ResultPoll>("/ResultPoll/{uid*}", "GET")
                .Add<Request.ResultPoll>("/ResultPoll", "POST")
                .Add<Request.Result>("/Result/{externalId*}", "GET")
                .Add<Request.Result>("/Result", "POST")
                .Add<Request.LabReport>("/LabReport", "GET")
                .Add<Request.OrderedTests>("/OrderedTests", "POST")
                .Add<Request.OrderedTests>("/OrderedTests/{externalId*}", "GET")
                **.Add<ahdc.external.Request.HL7Order.OPL_O37>("/HL7LabOrder", "POST");** 
```

粗体部分是新行。服务堆栈抛出此异常：

```
[NullReferenceException: Object reference not set to an instance of an object.]
   ServiceStack.Text.Common.DeserializeSpecializedCollections`2.GetGenericEnumerableParseFn() +254
   ServiceStack.Text.Common.DeserializeSpecializedCollections`2.GetParseFn() +1458
   ServiceStack.Text.Common.DeserializeSpecializedCollections`2..cctor() +39

[TypeInitializationException: The type initializer for 'ServiceStack.Text.Common.DeserializeSpecializedCollections`2' threw an exception.]
   ServiceStack.Text.Common.DeserializeSpecializedCollections`2.get_Parse() +19
   ServiceStack.Text.Common.JsReader`1.GetCoreParseFn() +3025
   ServiceStack.Text.Common.JsReader`1.GetParseFn() +315
   ServiceStack.Text.Jsv.JsvReader`1..cctor() +96

[TypeInitializationException: The type initializer for 'ServiceStack.Text.Jsv.JsvReader`1' threw an exception.]
   ServiceStack.Text.Jsv.JsvReader`1.GetParseFn() +0
   ServiceStack.Text.Jsv.JsvReader.GetParseFn(Type type) +427
   ServiceStack.Text.Jsv.JsvTypeSerializer.GetParseFn(Type type) +38
   ServiceStack.Text.Common.TypeAccessor.Create(ITypeSerializer serializer, TypeConfig typeConfig, PropertyInfo propertyInfo) +148
   ServiceStack.Text.Common.DeserializeTypeRef.GetTypeAccessorMap(TypeConfig typeConfig, ITypeSerializer serializer) +345
   ServiceStack.Text.Common.DeserializeType`1.GetParseMethod(TypeConfig typeConfig) +237
   ServiceStack.Text.Common.JsReader`1.GetCoreParseFn() +3589
   ServiceStack.Text.Common.JsReader`1.GetParseFn() +315
   ServiceStack.Text.Jsv.JsvReader`1..cctor() +96

[TypeInitializationException: The type initializer for 'ServiceStack.Text.Jsv.JsvReader`1' threw an exception.]
   ServiceStack.Text.Jsv.JsvReader`1.GetParseFn() +0
   ServiceStack.Text.Jsv.JsvReader.GetParseFn(Type type) +427
   ServiceStack.ServiceModel.Serialization.StringMapTypeDeserializer..ctor(Type type) +264
   ServiceStack.ServiceHost.RestPath..ctor(Type requestType, String path, String verbs, String summary, String notes) +2466
   ServiceStack.ServiceHost.ServiceRoutes.Add(String restPath, String verbs) +141
   ahdc.external.App_Start.AppHost.Configure(Container container) in D:\vb.net\ahdc_website-trunk\ahdc.external\App_Start\AppHost.cs:50
   ServiceStack.WebHost.Endpoints.AppHostBase.Init() +218
   ahdc.external.App_Start.AppHost.Start() in D:\vb.net\ahdc_website-trunk\ahdc.external\App_Start\AppHost.cs:142

[TargetInvocationException: Exception has been thrown by the target of an invocation.]
   System.RuntimeMethodHandle.InvokeMethod(Object target, Object[] arguments, Signature sig, Boolean constructor) +0
   System.Reflection.RuntimeMethodInfo.UnsafeInvokeInternal(Object obj, Object[] parameters, Object[] arguments) +192
   System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture) +108
   System.Reflection.MethodBase.Invoke(Object obj, Object[] parameters) +19
   WebActivator.BaseActivationMethodAttribute.InvokeMethod() +236
   WebActivator.ActivationManager.RunActivationMethods() +534
   WebActivator.ActivationManager.RunPreStartMethods() +41
   WebActivator.ActivationManager.Run() +64

[InvalidOperationException: The pre-application start initialization method Run on type WebActivator.ActivationManager threw an exception with the following error message: Exception has been thrown by the target of an invocation..]
   System.Web.Compilation.BuildManager.InvokePreStartInitMethodsCore(ICollection`1 methods, Func`1 setHostingEnvironmentCultures) +550
   System.Web.Compilation.BuildManager.InvokePreStartInitMethods(ICollection`1 methods) +132
   System.Web.Compilation.BuildManager.CallPreStartInitMethods(String preStartInitListPath) +90
   System.Web.Compilation.BuildManager.ExecutePreAppStart() +135
   System.Web.Hosting.HostingEnvironment.Initialize(ApplicationManager appManager, IApplicationHost appHost, IConfigMapPathFactory configMapPathFactory, HostingEnvironmentParameters hostingParameters, PolicyLevel policyLevel, Exception appDomainCreationException) +516

[HttpException (0x80004005): The pre-application start initialization method Run on type WebActivator.ActivationManager threw an exception with the following error message: Exception has been thrown by the target of an invocation..]
   System.Web.HttpRuntime.FirstRequestInit(HttpContext context) +9873912
   System.Web.HttpRuntime.EnsureFirstRequestInit(HttpContext context) +101
   System.Web.HttpRuntime.ProcessRequestInternal(HttpWorkerRequest wr) +456 
```

我很困惑为什么。

# javascript - 如何检查 HTML iframe 是否正在加载新内容

> ID：13976481
> 
> 赞同：2
> 
> 时间：2012-12-20T16:29:28.247
> 
> 标签：javascript, jquery, html, iframe

> **可能重复：**
> [加载 iFrame 时如何显示加载消息？— jQuery](https://stackoverflow.com/questions/8626638/how-to-display-loading-message-when-an-iframe-is-loading-jquery)

我的代码中有一个`<iframe>`元素，我将 src 设置为第三方站点。这个源是一个搜索工具，所以它有文本框和一个点击按钮来执行搜索。问题是这个搜索工具非常慢，所以我想在用户单击按钮执行搜索后向他们显示加载消息。有没有办法让我检测到`<iframe>`当前正在从我的页面加载新内容？由于来源来自第三方，因此我无法处理按钮单击的任何内容（至少我知道）。

# objective-c - 不知道是谁在上课

> ID：13976484
> 
> 赞同：1
> 
> 时间：2012-12-20T16:29:43.350
> 
> 标签：objective-c, ios

`*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[PeopleData initWithCoder:]: unrecognized selector sent to instance 0x6888c10'`

我会尽量让它简单。这条线如何：

```
NSData* objData = [NSKeyedArchiver archivedDataWithRootObject:[newStorage yourStaticArray]]; 
```

知道在哪个类中查找 NSCode？现在我收到上面的错误，因为它在错误的位置搜索 NSCode。在类`PeopleData`中只有属性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:35:38.597

当您归档或取消归档一个对象时，此时调用`initWithCoder`or 。`encodeWithCoder`请在课堂上实现[NSCoding](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Protocols/NSCoding_Protocol/Reference/Reference.html)`PeopleData`

有关`NSCoding`. [这是很好的教程](http://www.raywenderlich.com/1914/how-to-save-your-app-data-with-nscoding-and-nsfilemanager)。

# c#-4.0 - 缺少括号

> ID：13976486
> 
> 赞同：-3
> 
> 时间：2012-12-20T16:29:45.660
> 
> 标签：c#-4.0

我正在尝试用一些数据填充 Access 表。问题是我在某处丢失了一个括号，我真的不知道丢失的括号应该在哪里。

```
 OleDbConnection MyConn = new OleDbConnection(ConnStr);
        MyConn.Open();
       using (OleDbCommand cmd = MyConn.CreateCommand())
  {
       // create command with placeholders
       cmd.CommandText =
          "INSERT INTO MasterTable "+
          "([Code], [Date],  [Percent]) "+
          "VALUES(@code, @date, @percent)";

       // Add named parameters
       cmd.Parameters.AddRange(new OleDbParameter[]
       {
           new OleDbParameter("@code", code),
           new OleDbParameter("@date", date),
           new OleDbParameter ("@percent", newVar)
       };

       // Execute
       cmd.ExecuteNonQuery();
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T16:31:33.580

```
 // add named parameters
   cmd.Parameters.AddRange(new OleDbParameter[]
   {
       new OleDbParameter("@code", code),
       new OleDbParameter("@date", date),
       new OleDbParameter ("@percent", newVar)
   }; // <-- missing parenthesis. 
```

# node.js - util.inherits 用于 Node 中的自定义子类？

> ID：13976489
> 
> 赞同：4
> 
> 时间：2012-12-20T16:29:52.163
> 
> 标签：node.js

我正在尝试为节点中的一些自定义类实现非常简单的继承。我正在做这样的事情：

```
function MyClass() {
    this.myFunction = function(){
        //do something
    }
}

function MySubclass(){
    this.myOtherFunction = function(){
         //do something else
    }
}

util.inherits(MySubclass, MyClass)
console.log(MySubclass.super_ === MyClass); // true

var x = new MySubclass()
console.log(x instanceof MyClass); // true

x.myFunction() 
```

如果我运行它，我会收到错误：

```
TypeError: Object #<MySubclass> has no method 'myFunction' 
```

这种确切的模式非常适合从 events.EventEmitter 继承。它只是不适用于自定义类，还是我缺少什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-20T17:04:16.177

`util.inherits`只建立原型链。您缺少的是调用超级构造函数，以便将内容添加到`this`. 这是如何做到的：

```
function MyClass() {
    this.myFunction = function() {
        // Do something
    };
}

MyClass.prototype.doFoo = function () {
};

function MySubclass() {
    // This is doing the same as MyClass.apply(this, arguments);
    MySubclass.super_.apply(this, arguments);

    this.myOtherFunction = function() {
        // Do some other thing
    };
}

util.inherits(MySubclass, MyClass);

MySubclass.prototype.doBar = function() {
};

var x = new MySubclass();
x.myFunction();
x.myOtherFunction();
x.doFoo();
x.doBar(); 
```

您可能仍希望将这些方法移至每个原型。

# python - 拆分熊猫的一系列时间间隔？

> ID：13976491
> 
> 赞同：8
> 
> 时间：2012-12-20T16:29:56.547
> 
> 标签：python, pandas

是否可以根据其间隙拆分时间序列。例如，假设我们有以下内容：

```
rng2011 = pd.date_range('1/1/2011', periods=72, freq='H')
rng2012 = pd.date_range('1/1/2012', periods=72, freq='H')
Y = rng2011.union(rng2012) 
```

是否可以寻找一年或更长时间的差距，并在其上拆分数据框？

我想这会是这样的：

```
Y.groupby(Y.map(lambda x: x.year)) 
```

除了这在年份日期拆分，我有兴趣指定间隔间隙而不是行的年份属性。

该应用程序是我从 gps 获得旅行日志，但没有描述一次旅行何时结束而另一次旅行何时开始。我想以十分钟或更长时间的间隔分开。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-20T17:42:15.037

假设 Y 是数据框中的一列，一种方法是使用[`diff`](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.diff.html)和[cumsum](http://pandas.pydata.org/pandas-docs/dev/generated/pandas.Series.cumsum.html)：

```
df = DataFrame(Y)
df[1] = df[0].diff() > 600000000000.0 #nanoseconds in ten minutes
df[1] = df[1].cumsum()
df.groupby(1) 
```

*注意：如果您使用 72 小时内的纳秒数，它将分为两组。*

# mysql - 如何从上次转储中进行mysqldump？

> ID：13976493
> 
> 赞同：0
> 
> 时间：2012-12-20T16:29:57.780
> 
> 标签：mysql, mysqldump

我尝试做的是转储`--single-transaction`而不是停止网站。然后我想在不停止网站的情况下导入它（因为这需要几个小时）。接下来，如果我可以快速转储，但只能从最后一个转储，那就太好了。像这样我可以停止网站，快速转储和导入，因为它很小。

谢谢

# javascript - 对内部选项卡（不是浏览器选项卡）的更改运行 Greasemonkey 脚本？

> ID：13976495
> 
> 赞同：2
> 
> 时间：2012-12-20T16:30:03.990
> 
> 标签：javascript, jquery, ajax, greasemonkey

我正在尝试构建一个脚本来更改[Stack Overflow 的用户配置文件部分中标签页面](https://stackoverflow.com/users/1005187/sparchaeologist?tab=tags)上标签的颜色/布局。

我测试了脚本并且它运行了。*问题是，当我单击排序选项 [ votes* ] 和 [ *name* ]时，我想重新运行它。

我试过了：

1.  触发 jQuery`ready`事件。
2.  附加一个`onclick`处理程序（这是无用的，因为它在页面重新加载之前运行）。
3.  将事件侦听器附加`load`到带有标签等的表上，但无济于事。

我确信我在这里遗漏了一些非常明显的东西。我怀疑涉及到一些异步重新加载，但我不明白完成这项工作所需的操作是什么。

任何人都可以解释我缺少什么（或指向一些解释它的文档）吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T07:40:57.623

这是一个常见的问题。该页面使用 AJAX 仅替换其部分内容。因此触发 jQuery 的`ready`事件将不起作用，因为它只会在初始的完整页面加载后触发。

以下是常用的解决方法/方法供参考。我只推荐第一个：

1.  使用强大的轮询实用程序，例如[waitForKeyElements()](https://gist.github.com/2625891)。这需要加载一个外部脚本（通常不是问题），并且它需要 jQuery，无论如何您都应该使用它。下面详细介绍这种方法。

2.  触发`hashchange`事件。当 AJAX 更改页面时，有些页面可以很好地触发此事件。不幸的是，Stack Overflow 不是那些“礼貌”的网站之一。;-)

3.  触发对 URL 的其他更改。当 AJAX 更改内容时，有些页面可以很好地更改 URL。Stack Overflow**确实**做到了这一点。
    不幸的是，在 SO 的情况下，URL 立即更改，而实际页面更改发生在可变（不可预测的）延迟之后。这意味着您还必须使用其他技术之一。

4.  拦截页面的 AJAX。这可能会变得复杂和混乱，并且通常仍然需要轮询或延迟，因为实际的页面更改可能会在 AJAX 请求完成后的可变时间间隔内发生。在页面可能产生的多种类型中识别正确的 AJAX 请求也可能很烦人。

5.  使用`MutationObserver`s。这可能是最强大的技术，并且是变革驱动而不是轮询。但在大多数情况下，它是矫枉过正的，实施起来可能很棘手，并且可能会因 CPU 峰值而“冻结”计算机。

6.  请注意，一种较旧的技术*Mutation Events*已过时并被弃用，这是有充分理由的。请勿尝试使用它，尽管某些浏览器尚未删除此功能。

* * *

在几乎所有针对 AJAX 驱动页面的脚本中，我们真正想要的只是对某些类型的内容采取行动。艺术是识别该内容，然后很容易使用像[waitForKeyElements()](https://gist.github.com/2625891)这样的实用程序在添加或替换我们的目标有效负载时触发。

在您的情况下，内容似乎是出现在此 HTML 中的标签列表：

```
<div id="user-tab-tags">
    ...
    <div class="user-tab-content">
        <table class="user-tags">
            ...
        </table>
    </div>
    ...
</div> 
```

`table.user-tags`每次更改该选项卡的排序/分页选项时都会被替换。

因此，该内容的 jQuery 选择器将是：

```
"#user-tab-tags div.user-tab-content table.user-tags" 
```

更改样式的**完整脚本是：**

```
// ==UserScript==
// @name     _AJAX_compensation techniques
// @include  http://stackoverflow.com/users/*
// @require  http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js
// @require  https://gist.github.com/raw/2625891/waitForKeyElements.js
// @grant    GM_addStyle
// ==/UserScript==
/*- The @grant directive is needed to work around a design change
    introduced in GM 1.0\.   It restores the sandbox.
*/

waitForKeyElements (
    "#user-tab-tags div.user-tab-content table.user-tags",
    customStyleUserTags
);

function customStyleUserTags (jNode) {
    jNode.css ("background", "lime");
    //***** YOUR CODE HERE *****
} 
```

# kendo-ui - 如何以编程方式更改 Kendo UI 网格页面索引？

> ID：13976496
> 
> 赞同：33
> 
> 时间：2012-12-20T16:30:14.957
> 
> 标签：kendo-ui, grid, kendo-grid, paging

我有一个剑道 ui 网格。假设调用了指向网格的 JS 变量`grid`。如何以编程方式转到第 3 页？谢谢。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-12-20T16:51:57.993

您可能会使用：

```
grid.dataSource.query({ page: 3, pageSize: 20 }); 
```

文档在[这里](http://docs.telerik.com/kendo-ui/api/framework/datasource#methods-query)。

或者：

```
grid.dataSource.page(3); 
```

文档在[这里](http://docs.telerik.com/kendo-ui/api/framework/datasource#methods-page)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-03-21T14:20:07.977

```
Answer is just set it pate: 1 when datasource created

var dataSource = new kendo.data.DataSource({
  data: [
    { name: "Tea", category: "Beverages" },
    { name: "Coffee", category: "Beverages" },
    { name: "Ham", category: "Food" }
  ],
  page: 1,
  // a page of data contains two data items
  pageSize: 2
}); 
```

# callback - 来自python的回调

> ID：13976501
> 
> 赞同：0
> 
> 时间：2012-12-20T16:30:26.207
> 
> 标签：callback

从这个精彩的网络上阅读了很多内容后，我需要一些帮助。

我有这个功能（在一个dll中）：

```
kvStatus kvSetNotifyCallback  ( const int  hnd, kvCallback_t  callback,  void *  context,  
  unsigned int  notifyFlags); 
```

如何从 Python 调用这个函数？

我试过了：

```
kvSetNotifyCallback(c_int(hnd1),c_void_p(self.can_rx()),None, c_int(canNOTIFY_RX))

def can_rx(self):

        print("OK") 
```

函数 can_rx 只执行一次。有什么建议么？非常感谢。毫米

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-28T10:41:37.673

第一件事：

ctypes WINFUCNTYPE 或 CFUNCTYPE 的 argtypes 应该是 c_void_p

您定义的函数的 argtypes 应该是 py_object 而不是 c_void_p 以便您也可以传递结构和数组的对象。

然后在回调函数中将 void_p 数据转换为 `ct.cast(userdata,ct.py_object).value`

第二件事：

只运行一次的代码：在代码底部放置一个返回值。返回 1 或返回 TRUE

例子：

```
CALLBACKFUNC = WINFUNCTYPE("returnvalue",c_int,c_void_p)

kvSetNotifyCallback.argtypes = [c_int,CALLBACKFUNC,py_object,c_uint] 
```

然后在函数中：

```
def can_rx(arg1,arg2):
     arg3 = cast(arg2,py_object).value #yields object value
     print arg1
     print arg3
     return 1    #for continuing execution 
```

CALLBACK FUNCTION can_rx 应在 CALLBACKFUNC(can_rx) 处调用，与 arg1 一起传递的数据应在 py_object 位置传递。

所以你应该把你的回调称为：

```
kvSetNotifyCallback(somevalue,CALLBACKFUC(can_rx),arg2,canNOTIFY_RX) 
```

arg2 是要传递给回调函数 can_rx 的值

can_rx 也可以定义为全局函数。

# android - Android Listview：隐藏行中控件的按钮

> ID：13976507
> 
> 赞同：2
> 
> 时间：2012-12-20T16:30:36.637
> 
> 标签：android, listview, adapter, recycle

我有一个列表视图和 ArrayAdapter 的问题。我的目标是在每一行上都有一个按钮，允许用户隐藏（或显示）该行中包含的 TextView。

但是当我测试我的代码时，如果我单击第一行的按钮，它会隐藏第一个 TextView 以及下面的另一个 TextView 9 行。

我想这是正常的回收机制操作，但我并没有真正理解它，因为我假设在 onClick 方法上， View 参数是唯一的。

**适配器测试.xml：**

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android" 
    android:layout_height="wrap_content"
    android:layout_width="fill_parent"
    android:padding="5dip">

        <ImageButton
            android:id="@+id/adapter_test_button_showhide"    
            android:layout_height="wrap_content"
            android:layout_width="wrap_content"            
            android:layout_alignParentLeft="true"        
            android:src="@drawable/ic_action_pause_light">
        </ImageButton>               
        <!--  label -->
        <TextView android:id="@+id/adapter_test_text_label"
                 android:layout_width="fill_parent"
                 android:layout_height="wrap_content"
                 android:layout_toRightOf ="@id/adapter_test_button_showhide">
        </TextView>              
</RelativeLayout> 
```

**AdapterTest.java**

```
public class AdapterTest extends ArrayAdapter<String>
{       

  // Holder
  static class ViewHolder {TextView txtLabel ; ImageButton btnShowHide;}

  //Initialize adapter
  public AdapterTest(Context context, int resource, List<String> items) {super(context, resource, items);}

  @Override
  public View getView(int position, View v, ViewGroup parent)
  {             
      // view Holder        
      ViewHolder viewHolder;

      //Inflate the view
      if(v==null)
      {
          //linearView = new LinearLayout(getContext());
          LayoutInflater li = (LayoutInflater)getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
          v = li.inflate(R.layout.adapter_test, null);

          // Create holder
          viewHolder = new ViewHolder();
          viewHolder.txtLabel = (TextView)v.findViewById(R.id.adapter_test_text_label);
          viewHolder.btnShowHide = (ImageButton)v.findViewById(R.id.adapter_test_button_showhide);
          v.setTag(viewHolder);            
      }
      else 
      {
          viewHolder = (ViewHolder) v.getTag();
      }         

      // Load screen with data;
      LoadScreenFromItem (viewHolder,getItem(position));
      return v;
  }

  public void LoadScreenFromItem(ViewHolder viewHolder, String item)
  {     
      // Remove handler
      viewHolder.btnShowHide.setOnClickListener(null);

      // Add handler
      viewHolder.btnShowHide.setOnClickListener(handleOnClickShowHide());

      // Set textt
      viewHolder.txtLabel.setText(item);
  }

  private View.OnClickListener handleOnClickShowHide() 
  {
      return new View.OnClickListener() 
      {
          public void onClick(View v) 
          {  
              View parent = (View)v.getParent();
              TextView listserie = (TextView) parent.findViewById(R.id.adapter_test_text_label);

              // hide or show label
              if (listserie.isShown()) listserie.setVisibility(View.INVISIBLE);
              else listserie.setVisibility(View.VISIBLE);   
          }
      };
  }
} 
```

**问题 ：**

我的问题是：有没有办法做我想做的事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T17:55:28.543

这个问题很难在代码中找到。

您正在重用您的`ViewHolder`，这非常好，因为它可以节省您每次重新分配新内存的时间。

您的代码中的问题是：您没有重置 的可见性`TextView`，导致重用 View 将继承任何其他 TextView 的可见性设置的问题。

为了解决该错误，您必须将每个项目的可见性与项目本身一起存储在适配器中，并在恢复视图时重新加载可见性设置。

而不是`String`我会使用

```
class AGoodClassName {
String s; boolean b;
} 
```

它存储在适配器中。`b`每当可见性发生变化时，您都需要更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-03T16:39:10.697

旧线程，但它适用于我，因为我只需要在我的 ListView 的某些列表项中显示按钮。

万一有人被定向到此...这是我用来仅在列表的某些项目中显示按钮的代码！

*`The problem in your code is: You are not resetting the visibility of the TextView, leading to the problem that a reused View will inherit the visibility settings of any other TextView.`*

为了记录，我正在使用 ButterKnife！

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
    ViewHolder holder;
    if(convertView == null) {
        convertView = activity.getLayoutInflater().inflate(resource, parent, false);
        holder = new ViewHolder(convertView);
        convertView.setTag(holder);
    }
    holder = (ViewHolder) convertView.getTag();

    if(items.size() > 0) {
        MyItem item = items.get(position);
        holder.myButton.setVisibility(View.VISIBLE);
        if(!item.hasButton()) {
            holder.myButton.setVisibility(View.GONE);
        }
        holder.myButton.setFocusable(false);
        holder.myButton.setClickable(false);
    }
    return convertView;
}

public class ViewHolder {
    @InjectView(R.id.card_btn_layout) View myButton;

    public ViewHolder(View view) {
        ButterKnife.inject(this, view);
    }
} 
```

# escaping - 在 NSTask 参数中转义反斜杠？

> ID：13976516
> 
> 赞同：0
> 
> 时间：2012-12-20T16:31:14.827
> 
> 标签：escaping, nstask

我正在尝试在目录树中获取最新的修改日期。这在终端中运行良好：

```
find . ! -path "*.git*" -exec stat -f "%m" \{} \; | sort -n -r | head -1 
```

但是当我用 NSTask 尝试这个时，我得到了

```
find: -exec: no terminating ";" or "+" 
```

在我正在使用的 NSTask 的 args 数组中，我转义了反斜杠：

```
NSArray *args = @[@".", 
                  @"!", 
                  @"-path", 
                  @"*.git*", 
                  @"-exec", 
                  @"stat", 
                  @"-f", 
                  @"%m", 
                  @"\\{}", 
                  @"\\;", 
                  @"|", 
                  @"sort", 
                  @"-n", 
                  @"-r", 
                  @"|", 
                  @"head", 
                  @"-1"]; 
```

那么，我在这里缺少什么？我还尝试一起删除所有反斜杠，但这给了我一个“查找：|：未知的主要或操作员”错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:47:47.507

感谢您的提示。我已经把它分开了，现在得到了更多的回应。当运行没有反斜杠且没有排序和头部的命令时，我确实得到了结果。

```
NSArray *args = @[@".", 
              @"!", 
              @"-path", 
              @"*.git*", 
              @"-exec", 
              @"stat", 
              @"-f", 
              @"%m", 
              @"{}", 
              @";"]; 
```

所以看起来不应该喂 NSTask '|' 人物。我将在 objc 中进行排序等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T16:42:26.303

你实际上有三个你调用的命令行程序

```
find . ! -path "*.git*" -exec stat -f "%m" \{} \; | sort -n -r | head -1 
```

查找、排序和查找。

您应该为这些命令中的每一个创建一个 nstask——将 find 的标准输出链接到 sort 的标准输入，然后对 sort 和 head 执行相同的操作。

根据[文档](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSTask_Class/Reference/Reference.html)，您应该能够将 NSPipe 设置为一个输出和另一个输入，如果这不起作用，您可以将结果拉回并手动将它们传递给下一个。

虽然我没有验证它，但我认为您不需要反斜杠转义，因为这不会通过您的终端来启动这些程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T17:42:18.413

想出了另一种方法来做到这一点。

我现在运行带有参数的 NSTask 命令 /bin/sh：

```
NSArray *args = @[@"-c", 
                  @"/usr/bin/find . ! -path \"*.git*\" -exec stat -f %%m \\{} \\; | sort -n -r | head -1"]; 
```

归功于[http://borkware.com/quickies/single?id=130](http://borkware.com/quickies/single?id=130)

# asp.net - 在 ASP.NET 中流式传输大文件上传

> ID：13976517
> 
> 赞同：20
> 
> 时间：2012-12-20T16:31:15.693
> 
> 标签：asp.net, asp.net-mvc, file-upload

我有一个 ASP.NET MVC 应用程序，其页面允许用户上传文件。这些文件将有数百兆字节。

我在客户端使用 FineUploader，如果浏览器支持它，它将使用 FileAPI/XHR，否则将回退到带有 enctype="multipart whatever" 的 Iframe/form。

所以在服务器端我需要评估`Request.Files.Count > 1`. 如果`true`，这是一个老式的上传，我会像`Request.Files[0].InputStream.CopyTo(myFileStream)`其他方式一样保存文件`Request.InputStreawm.CopyTo(myFileStream)`。

这是我编写的一些实际代码：[https ://github.com/ronnieoverby/file-uploader/blob/master/server/ASP.NET%20MVC%20C%23/FineUpload.cs](https://github.com/ronnieoverby/file-uploader/blob/master/server/ASP.NET%20MVC%20C%23/FineUpload.cs)

这一切都很好，但在我的测试中，我注意到在整个文件上传之前，ASP.NET MVC 控制器操作和 HttpHandler 都不会开始处理，如果文件非常大，这很糟糕，因为这意味着它占用了很多Web 服务器的 RAM。

我发现了这个：[Streaming large file uploads to ASP.NET MVC](https://stackoverflow.com/questions/1046230/streaming-large-file-uploads-to-asp-net-mvc)这听起来很有希望，但我真的不知道代码在他的应用程序中的位置。

所以，问题是：如何在 ASP.NET 中进行上传的同时将上传的文件流式传输到磁盘？

### 更新

我刚刚看到了一个以前没有深入了解的关键细节。从[HttpPostedFile](http://msdn.microsoft.com/en-us/library/system.web.httppostedfile.aspx)文档：

> 默认情况下，所有大于 256 KB 的请求（包括表单字段和上传的文件）都会缓冲到磁盘，而不是保存在服务器内存中。

好的，这解决了 Web 服务器的 RAM 利用率可能会在大量上传期间飙升的担忧。但是，仍然存在一个问题：文件完全传输到 Web 服务器后，服务器必须花时间将其移动到最终目的地。如果文件系统操作是副本（如果目标在另一个物理磁盘上则保证），则响应会被不必要地延迟。

老实说，我可以通过增加上传处理程序/操作的响应超时来忍受这一点。但是，将字节直接流式传输到它们的目的地会很好。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-21T04:34:59.103

您可以以完全自定义的方式处理上传，而无需使用方法进行缓冲 [`HttpRequest.GetBufferlessInputStream`](http://msdn.microsoft.com/en-us/library/ff406798.aspx)。基本上，您可以访问原始传入数据，并且可以随意使用它。

我刚刚创建了将原始请求内容保存到文件的小示例：

1.  创建处理程序：

    ```
    public class UploadHandler : IHttpHandler
    {
        public void ProcessRequest(HttpContext context)
        {
            using (var stream = context.Request.GetBufferlessInputStream())
            using (var fileStream = File.Create("c:\\tempfile.txt"))
            {
                stream.CopyTo(fileStream);
            }
        }
        public bool IsReusable { get {  return true; } }
    } 
    ```

2.  在 Web.config 中注册：

    ```
    <system.webServer>
        <modules runAllManagedModulesForAllRequests="true"/>
        <handlers>
            <add name="UploadHandler" verb="POST"
                path="/upload"
                type="UploadHandler"
            resourceType="Unspecified"/>
        </handlers>
    </system.webServer> 
    ```

3.  使用表单创建页面：

> ```
> <form action="/upload" method="post" enctype='multipart/form-data'>
>      <input type="file" name="aa" id="aa"/>
>      <input type="submit"/>
> </form> 
> ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T13:13:30.353

如果上传和流式传输占用了宝贵的服务器资源，那么您可能想看看在某种云上托管您的媒体文件。ASP.NET 可以使用 Rackspace，Amazon Cloud API 让您的用户将文件直接上传到 CDN 网络，然后以这种方式提供内容，我知道这并不能回答您的问题，但很多人将会或已经拥有并且以为我会得到我的 2 美分。许多人仍然不选择使用云让我感到惊讶！一旦你去了 CDN，你就再也回不去了。此外，对于大多数 CDN，您还将获得上传容器的流式 URL，它支持许多不同的电影类型，而且它的照明速度很快，不仅让您的用户也可以上传，而且您的网站上的速度也永远不会慢结果。

# javascript - linkedin jsapi - 人们使用关键字 ORed 而非 ANDed 进行搜索

> ID：13976519
> 
> 赞同：2
> 
> 时间：2012-12-20T16:31:30.740
> 
> 标签：javascript, linkedin, jsapi

是否有能力在**关键字**中使用 ORed 参数进行搜索？

例如，下面的请求使用 ANDed 关键字获取 1 级连接 - javascript、extjs、java。

```
 IN.API.PeopleSearch()
                .params({keywords: 'javascript extjs java', facet: 'network,F'})
                .result(displaySearchedProfiles); 
```

寻找一种在键之间使用 OR 的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T10:58:51.233

是的，我遇到了同样的问题，但我看到[https://apigee.com](https://apigee.com)服务可以检索所有内容。可能是他们使用了另一种 api

无论如何谢谢你的问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T15:06:57.897

看起来 LinkedIn 不提供控制 queeering 字符串的能力。

# javascript - 加速使用远程 API 的 Javascript 中的调试

> ID：13976520
> 
> 赞同：0
> 
> 时间：2012-12-20T16:31:31.810
> 
> 标签：javascript, google-maps-api-3

最近我一直在学习一些 Google Map API。我有这行代码：

`var paths = this.getPath;`

正确的代码行应该是：

`var paths = this.getPath();`

我花了太多时间来弄清楚它。在 Javascript 中按`Ctrl-Shift-J`,`try catch`并没有给我任何线索。

当我使用远程 API 时，是否有任何工具告诉我我错了，这样我以后就不会犯同样的错误？由于语法错误突出显示功能，我以前使用 IDE 使用 Java 的经验要顺畅得多。

**编辑：**简而言之，我如何在编写代码时检测到错误，而不是在运行时检测到错误？

感谢你并致以真诚的问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:38:40.070

如果您使用的是 Chrome（我假设您来自您对 的引用`Ctrl-Shift-J`），那么您有一个出色的 Javascript 调试器，它允许您添加断点、检查变量、查看堆栈、在链中上下移动等。

当您意识到您没有收到预期的结果时，最好的策略是在调用 Map API 时和之后设置断点，并在之前和之后检查变量的值。这将表明这`getPath`是对函数的引用，而不是返回值。

作为一般提示，前置属性`get`往往是函数。如果它是一个属性，它可能`path`与`getPath`. 动词给出了它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T23:29:49.473

使用 WebStorm 作为 IDE。它提供了出色的功能，如代码完成、调试、jslint/jshint，... javascript imho 的最佳 IDE。

结合 Chrome 来测试它的效果！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T06:45:31.463

IE 10 开发人员工具（奇怪的是 Chrome 的对应物，Firefox 未能通知我我的错误，我正在重新测试这部分）调试可以帮助我。我会通知你更多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T16:36:53.937

我认为，只要您将左下角的暂停按钮切换为“在所有异常时暂停”（浅蓝色模式），您的调试器就可能会涵盖这些情况。

# mysql - 执行更新然后选择并发问题

> ID：13976524
> 
> 赞同：0
> 
> 时间：2012-12-20T16:31:32.593
> 
> 标签：mysql, sql, concurrency

我有以下函数，它增加一个值然后检索它并返回它，我认为我可能面临的问题之一是在更新和选择另一个事务之间更新 currentVal 值，因此导致检索错误的更新值，我是否正确在想这个？

```
CREATE FUNCTION INCREMENT()
RETURNS INT
BEGIN
DECLARE newVal;
UPDATE table_x SET currentVal=currentVal+1;
SELECT currentVal INTO newVal FROM table_x;
RETURN newVal;
END; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T16:38:27.060

我遇到过类似的问题，确实另一个更新或插入事务会更新 currentval。我解决问题的方法是将更新和选择放在一个事务中，这将导致表被锁定。这将确保您始终获得 currentval。

```
CREATE FUNCTION INCREMENT()
RETURNS INT
BEGIN
DECLARE newVal;
Begin tran
UPDATE table_x SET currentVal=currentVal+1;
SELECT currentVal INTO newVal FROM table_x;
Commit tran
RETURN newVal;
END; 
```

# java - 单击时 onItemClick 不起作用

> ID：13976526
> 
> 赞同：0
> 
> 时间：2012-12-20T16:31:40.947
> 
> 标签：java, android, android-listview, onitemclicklistener

我错过了一些非常重要的东西，但我不太明白是什么。有人可以帮忙吗。这可能是我错过的一些非常愚蠢的事情，但我无法启动我的 onItemClick。

在创建....

```
 @Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    Intent intent = getIntent();
    actu_ip = intent.getStringExtra(IPEntry.ACTUALSMARTIP);
    setContentView(R.layout.act_ipcontrol);

    mainListView = (ListView) findViewById( R.id.mainListView );
    String[] options = new String[] { "All in to 1", "Spare"};  

    ArrayList<String> optionsList = new ArrayList<String>();
    optionsList.addAll( Arrays.asList(options) );
    listAdapter = new ArrayAdapter<String>(this, R.layout.simplerow, optionsList);
    mainListView.setAdapter( listAdapter ); 

    try {
        Toast.makeText(IPControl.this, "Please wait...Connecting...", Toast.LENGTH_SHORT).show();
        new AsyncAction().execute();
    } catch(Exception e) {
        e.printStackTrace();
    }
}

private class AsyncAction extends AsyncTask<String, Void, String> {
    protected String doInBackground(String... args) { 
        try {
            InetAddress serverAddr = InetAddress.getByName(actu_ip);
            socket = new Socket(serverAddr, REDIRECTED_SERVERPORT);
            OutputStreamWriter osw = new OutputStreamWriter(socket.getOutputStream());
            BufferedWriter bw = new BufferedWriter(osw);
            out = new PrintWriter(bw, true); 
            in = new BufferedReader(new InputStreamReader(socket.getInputStream()));
            while (! in .ready());
            readBuffer();
            out.println("root\r\n");
            while (! in .ready());
            readBuffer();
            out.println("root\r\n");
            while (! in .ready());
            readBuffer();
            out.println("[verbose,off\r\n");
            while (! in .ready());
            String msg = "";
            while ( in .ready()) {
                msg = msg + (char) in .read();
            }
        } catch (UnknownHostException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }

        return null;//returns what you want to pass to the onPostExecute()
    }

    protected void onPostExecute(String result) {

        Toast.makeText(IPControl.this, "Connected", Toast.LENGTH_SHORT).show();

        //results the data returned from doInbackground

        IPControl.this.data = result;

    }
}

private String readBuffer() throws IOException {
    String msg = "";

    while(in.ready()) {
        msg = msg + (char)in.read();
    }
    //System.out.print(msg);
    if(msg.indexOf("SNX_COM> ") != -1) return msg.substring(0, msg.indexOf("SNX_COM> "));
    else if(msg.indexOf("SCX_COM> ") != -1) return msg.substring(0, msg.indexOf("SCX_COM> "));
    else return msg;
}
} 
```

我要发起的...

```
 public void onItemClick(AdapterView<?> arg0, View arg1, int pos,
            long arg3) {

        try {
            new AsyncAction1().execute();
        } catch(Exception e) {
            e.printStackTrace();
        }
    }

    private class AsyncAction1 extends AsyncTask<String, Void, String> {
        protected String doInBackground(String... args) { 
            try {
                out.println("[c,l#,i1,o*\r\n");
                //System.out.print("root\r\n");
                while(! in .ready());

            } catch (UnknownHostException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            }

            return null;//returns what you want to pass to the onPostExecute()
        }

        protected void onPostExecute(String result) {

            //results the data returned from doInbackground
            Toast.makeText(IPControl.this, "Command Sent", Toast.LENGTH_SHORT).show();

            IPControl.this.data = result;

        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:40:44.113

我还没有在您的代码中看到 listview 的 setOnItemClickListener 方法。你实施了吗？尝试关注

```
mainListView.setAdapter( listAdapter ); 
mainListView.setOnItemClickListener(new OnItemClickListener(){
   public void onItemClick(AdapterView<?> parent, View view, int position,
        long id) {

      try {
        new AsyncAction1().execute();
      }catch(Exception e) {
        e.printStackTrace();
   }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T17:14:06.463

感谢您的所有帮助，我解决了我的问题。

我只是没有按照正确的顺序做事。

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    Intent intent = getIntent();
    actu_ip = intent.getStringExtra(IPEntry.ACTUALSMARTIP);
    setContentView(R.layout.act_ipcontrol);

    mainListView = (ListView) findViewById( R.id.mainListView );
    final String[] options = new String[] { "All in to 1", "Spare"};  

    ArrayList<String> optionsList = new ArrayList<String>();
    optionsList.addAll( Arrays.asList(options) );
    listAdapter = new ArrayAdapter<String>(this, R.layout.simplerow, optionsList);
    mainListView.setAdapter( listAdapter ); 
    mainListView.setOnItemClickListener(new OnItemClickListener(){

        public void onItemClick(AdapterView<?> arg0, View arg1, int pos, long arg3) {
            try {
                    if(pos == 0) {
                        AsyncAction1 a = new AsyncAction1();
                        a.setCmd("[c,l#,i1,o*\r\n");
                        a.execute();
                    }
                } catch(Exception e) {
                    e.printStackTrace();
                }
        }
    }); 
```

然后....

```
private class AsyncAction1 extends AsyncTask<String, Void, String> {
    String cmd;

    public void setCmd(String c) {
        cmd = c;
    }

    protected String doInBackground(String... args) {
        try {
            out.println(cmd);
            //System.out.print("root\r\n");
            while(! in .ready());
        } catch (UnknownHostException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return null;//returns what you want to pass to the onPostExecute()
    }

    protected void onPostExecute(String result) {

        //results the data returned from doInbackground
        Toast.makeText(IPControl.this, "Command Sent", Toast.LENGTH_SHORT).show();

        IPControl.this.data = result;
    }
}
} 
```

# java - 试图理解android编码中的BroadcastReceiver

> ID：13976533
> 
> 赞同：0
> 
> 时间：2012-12-20T16:31:57.313
> 
> 标签：java, android, android-intent

首先，我是 Android 编码的新手，逻辑真的让我很困惑。最初我是 Flash 开发人员，我熟悉那里的概念，而 Android 是一套完整的新概念。例如（如果我错了，请纠正我） Intent 就像一个 Event 而 BroadcastReceiver 是一个 EventListener ？

好吧，我被卡住了，如果是这样，Intent 是 Event 而 broadcastReceiver 是 eventListener 那么我的问题是我如何分配一个变量，我在 onReceive 方法中处理的数据？

我已经搜索了很长时间，并且因为不理解逻辑而对自己感到生气。我试图将事物与 ActionScript3 和 Javascript 进行比较和关联（JS 中的一些东西非常接近 AS3）。

现在到我试图编写的代码和我遇到的问题。

我试图让自己为 Adob​​e AIR 编写一个 Android 原生扩展......所以，至少在某些方面非常好 :)

清单文件：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
      package="com.as3breeze.air"
      android:versionCode="1"
      android:versionName="1.0">
    <uses-sdk android:minSdkVersion="8" />
    <uses-permission android:name="android.permission.BLUETOOTH"/>
    <uses-permission android:name="android.permission.BLUETOOTH_ADMIN"/>

    <application android:icon="@drawable/icon" android:label="@string/app_name">
        <activity android:name=".BluetoothExtension"
                  android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>
</manifest> 
```

如我所见，主要活动是我的 BluetoothExtension.java 如下：注意它实现了 FREExtension（由 Adob​​e 为 Native Extensions 创建）

```
package com.as3breeze.air;

import com.adobe.fre.FREContext;
import com.adobe.fre.FREExtension;
import com.as3breeze.air.BluetoothExtensionContext;

public class BluetoothExtension implements FREExtension {

    protected BluetoothExtensionContext BEC;

    /** Called when the activity is first created. */
    @Override
    public FREContext createContext(String arg0) {
        BEC = new BluetoothExtensionContext();
        return BEC;
    }

    @Override
    public void dispose() {
        // TODO Auto-generated method stub
        BEC.dispose();
        BEC = null;
    }

    @Override
    public void initialize() {}
} 
```

那是活动，对吧？

它创建了以下上下文（我省略了@imports）：

```
public class BluetoothExtensionContext  extends FREContext {

public BluetoothAdapter bluetooth;
public Activity extensionActivity;
public FREArray nonBoundedDevices;

@Override
public void dispose() {
    // TODO Auto-generated method stub

}

@Override
public Map<String, FREFunction> getFunctions() {

    Map<String, FREFunction> functionMap=new HashMap<String, FREFunction>();

    functionMap.put("initialize", new Initialize());

    // Leaving out some stuff here and listing only the important things...

    functionMap.put("listDevices", new ListAvailableDevices());

    return functionMap;

    }
} 
```

现在，正如您在上面看到的，我有一些公共变量以便于访问，它们是在 new Initialize() 内部启动的，如下所示：

```
package com.as3breeze.air;

import android.bluetooth.BluetoothAdapter;
import com.adobe.fre.FREContext;
import com.adobe.fre.FREFunction;
import com.adobe.fre.FREObject;
import com.adobe.fre.FREWrongThreadException;
import com.as3breeze.air.BluetoothExtensionContext;

public class Initialize implements FREFunction {

    @Override
    public FREObject call(FREContext context, FREObject[] args) {

        BluetoothExtensionContext bluetoothContext = (BluetoothExtensionContext) context;
        bluetoothContext.bluetooth = BluetoothAdapter.getDefaultAdapter();
        bluetoothContext.extensionActivity = bluetoothContext.getActivity();

        FREObject returnData = null;
        if( bluetoothContext.bluetooth == null )
        {
            try {
                returnData = FREObject.newObject("notSupported");
            } catch (FREWrongThreadException e) {}
        }
        return returnData;
    }
} 
```

启动工作正常，我还在地图中列出了其他方法，例如启用/禁用蓝牙、可发现性等等，那里的一切都运行良好。

但问题出在这个：functionMap.put("listDevices", new ListAvailableDevices());

类被创建并运行并返回，它看起来像这样：

```
package com.as3breeze.air;

import android.bluetooth.BluetoothDevice;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.IntentFilter;
import android.widget.Toast;

import com.adobe.fre.FREASErrorException;
import com.adobe.fre.FREArray;
import com.adobe.fre.FREContext;
import com.adobe.fre.FREFunction;
import com.adobe.fre.FREInvalidObjectException;
import com.adobe.fre.FREObject;
import com.adobe.fre.FRETypeMismatchException;
import com.adobe.fre.FREWrongThreadException;

public class ListAvailableDevices implements FREFunction {

    static FREArray returnDevicesArr = null;

    @Override
    public FREObject call(FREContext context, FREObject[] args) {
        BluetoothExtensionContext bluetoothContext = (BluetoothExtensionContext) context;
        returnDevicesArr = bluetoothContext.nonBoundedDevices;

        IntentFilter filter = new IntentFilter(BluetoothDevice.ACTION_FOUND);
        BroadcastReceiver mReceiver = new BroadcastReceiver() {

            @Override
            public void onReceive(Context context, Intent intent) {

                int index = 0;

                String action = intent.getAction();

                if (BluetoothDevice.ACTION_FOUND.equals(action)) {
                    // Get the BluetoothDevice object from the Intent
                    BluetoothDevice bt = intent.getParcelableExtra(BluetoothDevice.EXTRA_DEVICE);

                    Toast.makeText( context, "Searching devices...", Toast.LENGTH_SHORT).show();
                    FREArray deviceName;
                    try {
                        deviceName = FREArray.newArray(1);
                        deviceName.setObjectAt(0, FREObject.newObject(bt.getName()));
                        deviceName.setObjectAt(1, FREObject.newObject(bt.getAddress()));

                        returnDevicesArr.setObjectAt(index, deviceName);
                        index++;
                    } catch (FREASErrorException e) {
                        e.printStackTrace();
                    } catch (FREWrongThreadException e) {
                        e.printStackTrace();
                    } catch (FREInvalidObjectException e) {
                        e.printStackTrace();
                    } catch (FRETypeMismatchException e) {
                        e.printStackTrace();
                    }
                }
            }
        };
        bluetoothContext.extensionActivity.registerReceiver(mReceiver, filter);
        bluetoothContext.bluetooth.startDiscovery();
        return null; // Or to use return returnDeviceArr;

    }
} 
```

如您所见，我试图将所有找到的设备存储在 returnDeviceArr 中，以便从 call() 或 BluetoothExtensionContext.java 中定义的某个“全局”变量中返回，走哪条路都没有关系，我只需要掌握它数据。

我无法从 onReceive 方法访问 returnDeviceArr 变量。我还测试了在 onReceive 内部创建一个新的 FREArray 并将设备数据存储在那里，因此可以返回但返回 null；在 call(){ ... } 的底部被触发并最终给我 null 值。

那么，我怎样才能用 return returnDeviceArr 替换 return null; 并获得可用设备的数组？

我希望有代码示例和解释，这样我就可以在不使用可视组件的情况下开始理解 Android 编码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T19:40:46.900

BlueToothExtension 类必须扩展活动类。仅在清单中声明是不够的。你应该用意图注册你的广播接收器。查看 android 开发指南以获取更多详细信息。

为了传递变量的意图，你应该把它们放在额外​​的东西中，比如

`意图意图=新意图（this，target.class）；

intent.putExtra("变量", value);

startActivityForResult（意图，request_Code）；`

在目标类中，您可以使用 intent.getStringExtra("variable"); 获取变量；

# javascript - 在 SVG 元素中鼠标悬停时出现 TypeError (undefined_method)

> ID：13976534
> 
> 赞同：0
> 
> 时间：2012-12-20T16:31:59.393
> 
> 标签：javascript, svg, dom-events, mouseover

我正在尝试使用鼠标悬停在 svg 元素内创建一个矩形。有时可以，但有时我会收到如下错误：

```
 >TypeError
   arguments: Array[2]
   get message: function getter() { [native code] }
   get stack: function getter() { [native code] }
   set message: function setter() { [native code] }
   set stack: function setter() { [native code] }
   type: "undefined_method"
   __proto__: Error 
```

这是 Javascript 代码：

```
 function _click(evt){
    if (cropping){
        if (initial_point == 0){
            console.log('first click');
            rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
            rect.setAttributeNS(null, 'id', 'area');
            svg.appendChild(rect);
            coords = myMapApp.calcCoord(evt);
            x_initial = coords.x.toFixed(1);
            y_initial = coords.y.toFixed(1);
            initial_point = 1;
        }
        else{
            console.log('second click');
            width = Math.abs(x_final - x_initial);
            height = Math.abs(y_final - y_initial);
            x = x_initial
            if (x_final < x_initial)
                x = x_final
            y = y_initial   
            if (y_final < y_initial)
                y = y_final
            svg.setAttributeNS(null, 'viewBox', x + ' '+ y + ' ' + width + ' ' + height);
            if (rect != null)
                svg.removeChild(rect);
            initial_point = 0;
            x_final = 0;
            y_final = 0;
            x_initial = 0;
            y_initial = 0;
        }
    }
}

    function _mouseMove(evt){
    try{
        if ((cropping) && (initial_point)){
            coords = myMapApp.calcCoord(evt);
            x_final = coords.x.toFixed(1);
            y_final = coords.y.toFixed(1);
            width = Math.abs(x_final - x_initial);
            height = Math.abs(y_final - y_initial);

            console.log('1');
            x = x_initial
            if (x_final < x_initial)
                x = x_final
            y = y_initial   
            if (y_final < y_initial)
                y = y_final
            console.log('2');
            rect.setAttributeNS(null, 'fill', 'red');
            rect.setAttributeNS(null, 'stroke', 'red');
            rect.setAttributeNS(null, 'x', x);
            rect.setAttributeNS(null, 'y', y);
            rect.setAttributeNS(null, 'width', width);
            rect.setAttributeNS(null, 'height', height);
            rect.setAttributeNS(null, 'opacity', 0.5);
            console.log('3');
        }
    }catch(err){
        initial_point = 0;
        console.log(err);
        x_final = 0;
        y_final = 0;
        x_initial = 0;
        y_initial = 0;
        if (rect != null)
            svg.removeChild(rect);
    }} 
```

'rect' 已在上面声明为公共行（var rect）。这是html5的问题，我如何管理事件？

我在这里有一个[小提琴](http://jsfiddle.net/VWvUG/)，但我有一些我不知道如何导出的库。

# ajax - Facebook喜欢页面加载

> ID：13976538
> 
> 赞同：1
> 
> 时间：2012-12-20T16:32:12.793
> 
> 标签：ajax, facebook, url, dynamic

我需要知道如何使用 AJAX 在 Facebook 等页面之间导航。当我单击 Facebook 中的链接时，地址栏中的 url 会发生变化，并且主要内容区域会重新加载新内容，但左侧的导航列表、顶部的标题和左侧的聊天保持不变。这些部分似乎没有重新加载。当地址栏发生变化时，这如何成为可能？如果可能的话，请举一个小例子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T16:38:19.133

您可以使用诸如 history.js 之类的库以及 ajax 调用。当您在站点周围单击时，此库会动态修改 URL。该库位于[https://github.com/browserstate/History.js](https://github.com/browserstate/History.js)。[http://rypit.me/demos/isotory/tutorial/history.js.html](http://rypit.me/demos/isotory/tutorial/history.js.html)上提供了一个很棒的演示

# apache - 我怎样才能让我的 .htaccess 强制 https，但仅适用于一个目录（同时保留 ExpressionEngine 和基于无 www 的规则）

> ID：13976540
> 
> 赞同：2
> 
> 时间：2012-12-20T16:32:28.113
> 
> 标签：apache, .htaccess, mod-rewrite, expressionengine

我已经阅读了很多关于 SO 的一般主题的问题，但似乎无法找到解决我问题的解决方案。

我们正在使用 ExpressionEngine 并且只需要在 https:// 后面有*一个*部分我们希望网站的其余部分将任何 https:// 请求重定向到 http://。

示例 #1： **http:** //test.com/facebook 301 重定向到**https://test.com/facebook**

示例 #2： **https:** //test.com/test_page/ 301 重定向到**http://test.com/test_page/**

**注意：** /facebook 不是服务器上的目录，它是 ExpressionEngine 内部的模板组

到目前为止，这是我的 .htacess：

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /

# Force SSL on facebook pages
RewriteCond %{HTTPS} !=on
RewriteCond %{REQUEST_URI} ^/facebook
RewriteCond %{HTTP_HOST} ^(www\.)?(.*)$ [NC]
RewriteRule ^(.*)$ https://%2/$1 [R=301,L,QSA]

# Remove SSL on other pages
RewriteCond %{HTTPS} on
RewriteCond %{REQUEST_URI} !^/facebook
RewriteRule ^(.*)$ http://%{HTTP_HOST}/$1 [R=301,L,QSA]

# Remove www. from URLs
RewriteCond %{HTTPS} !=on
RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
RewriteRule ^(.*)$ http://%1/$1 [R=301,L]

# Magic ExpressionEngine rule to remove index.php requirement from URLs    
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond $1 !\.(gif|jpe?g|png)$ [NC]
RewriteRule ^(.*)$ index.php/$1 [L]
</IfModule> 
```

**当前问题：** 示例 #2 工作正常，并且带有 https:// 的 URL 正在删除 https://。

但是如果你去[http://test.com/facebook ，它](http://test.com/facebook)**会**重定向到**http://test.com/** index.php /facebook。即没有HTTPS 和index.php 的添加。

 **我们认为 .htaccess 文件运行了两次，第一次是命中第一个块并被重定向，但随后它被添加了“index.php”，并命中了第二个块，因此删除了 https:/ /。

任何帮助将不胜感激。

谢谢！

**实时 HTTP 标头报告**

```
http://test.com/facebook/register

GET /facebook/register HTTP/1.1

HTTP/1.1 301 Moved Permanently
Date: Thu, 20 Dec 2012 17:20:17 GMT
Server: Apache
Location: https://test.com/facebook/register

--------

http://test.com/index.php/facebook/register

GET /index.php/facebook/register HTTP/1.1

HTTP/1.1 200 OK
Date: Thu, 20 Dec 2012 17:20:17 GMT
Server: Apache 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T21:34:00.453

所以facebook页面也是由EE创建的。现在它是有道理的。该 url`http://example.com/facebook`被重定向到 https 版本。然后它被重写到 EE url `/index.php/facebook`，它不再匹配`^/facebook`，所以它再次被重定向到`http://example.com/index.php/facebook`

这可以例如通过使用以下方法来解决。

```
# Remove SSL on other pages
RewriteCond %{HTTPS} on
RewriteCond %{REQUEST_URI} !^/facebook
RewriteCond %{REQUEST_URI} !^/index\.php/facebook
RewriteRule ^(.*)$ http://%{HTTP_HOST}/$1 [R=301,L,QSA] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T17:12:02.500

这个条件没有像你期望的那样工作：

```
RewriteCond %{REQUEST_URI} !^/facebook 
```

我相信 REQUEST_URI 实际上是 /index.php/facebook，而不是 /facebook。因此，任何对 https:// 的请求都将被重定向到 http://。**

# wcf - DLL 与 WCF：性能与可扩展性（WCF 以防万一？）

> ID：13976550
> 
> 赞同：3
> 
> 时间：2012-12-20T16:33:10.340
> 
> 标签：wcf

假设您要创建一个 ASP.NET Web 应用程序。您*认为*它永远只是一个网络应用程序（带有常规页面和移动页面），但您永远不知道。有一天，您可能希望拥有 iPhone、iPad、Android 或任何应用程序作为客户端。如果发生这种情况的可能性为 0%，您可以将业务层打包为 DLL 并从客户端引用它们。如果将来这些其他前端应用程序有 1% 或更大的机会，您会将业务层打包在 WCF 中并通过 http 公开（即面向服务的架构 (SOA)，任何客户端都可以使用的软件即服务）不论平台）。

*   **DLL pro：**速度/性能。
*   **DLL con：**只有 Microsoft 客户端可以使用并且必须有 DLL 与客户端。这也意味着如果 DLL 嵌入客户端应用程序，则需要很长的距离将数据带到业务层进行处理然后返回。
*   **WCF pro：**可扩展性.. 任何客户端都可以使用。
*   **WCF 缺点：**速度/性能。

软件架构就是要在性能和灵活性之间找到适当的平衡。我想在这种情况下您必须将 WCF 作为保险单？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T16:59:47.780

您不必使用 WCF。如果需要，并且您需要将 BLL 的功能公开给其他非 Microsoft 类型，那么您可以创建一个新的 WCF 服务。在这个新服务中，您可以在 ServiceContract 中创建包装器方法来公开 DLL 的方法等。因此，您可以创建 DLL 并在将来需要时为其创建服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T06:43:48.410

想到两个选择

*   在无状态的 BLL 中定义粗粒度的公共方法。如果/当您希望作为 WCF 服务运行时，您可以轻松地包装您的库。
*   或实现为 WCF 并在本地托管

第二个选项更适合概念验证。一个很好的描述是在[http://msdn.microsoft.com/en-us/library/bb332338.aspx](http://msdn.microsoft.com/en-us/library/bb332338.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T17:02:28.480

在我看来，您可以使用[ASP.NET Web API](http://www.asp.net/web-api)（或至少将其添加到您的列表中）。您可以创建将调用 REST api 的网站，并且它也可以从本机应用程序中使用。

查看下一篇文章以获取更多信息：

*   [ASP.NET Web API 简介](http://stephenwalther.com/archive/2012/03/05/introduction-to-the-asp-net-web-api.aspx)
*   [ASP.NET WebAPI：MVC4 和 WebAPI 入门](http://www.codeproject.com/Articles/344078/ASP-NET-WebAPI-Getting-Started-with-MVC4-and-WebAP)

# objective-c - 通讯录联系人排序

> ID：13976555
> 
> 赞同：3
> 
> 时间：2012-12-20T16:33:29.813
> 
> 标签：objective-c, ios

我在下面有这段代码，我设法从通讯簿中列出了姓名和电话号码，但是如何按名字对其进行排序？

```
ABAddressBookRef addressBookRef = ABAddressBookCreateWithOptions(NULL, NULL);
abContactArray = (__bridge NSArray *)ABAddressBookCopyArrayOfAllPeople(addressBookRef); // get address book contact array

NSInteger totalContacts =[abContactArray count];

for(NSUInteger loop= 0 ; loop < totalContacts; loop++)
{
    ABRecordRef record = (__bridge ABRecordRef)[abContactArray objectAtIndex:loop]; // get address book record

    if(ABRecordGetRecordType(record) ==  kABPersonType) // this check execute if it is person group
    {
        //ABRecordID recordId = ABRecordGetRecordID(record); // get record id from address book record

        //NSString *recordIdString = [NSString stringWithFormat:@"%d",recordId]; // get record id string from record id
        //NSLog(@"Record: %@", recordIdString);

        NSString *firstNameString = (__bridge NSString*)ABRecordCopyValue(record,kABPersonFirstNameProperty); // fetch contact first name from address book

        NSString *lastNameString = (__bridge NSString*)ABRecordCopyValue(record,kABPersonLastNameProperty); // fetch contact last name from address book
                                                                                                            //NSString *contactEmail = (__bridge NSString*)ABRecordCopyValue(record,kABPersonEmailProperty); // fetch contact last name from address book

        NSString * fullName = [NSString stringWithFormat:@"%@ %@", firstNameString, lastNameString];

        [name addObject: fullName];

        ABMultiValueRef phoneNumberMultiValue = ABRecordCopyValue(record, kABPersonPhoneProperty);
        NSUInteger phoneNumberIndex;
        for (phoneNumberIndex = 0; phoneNumberIndex < ABMultiValueGetCount(phoneNumberMultiValue); phoneNumberIndex++) {

            CFStringRef labelStingRef = ABMultiValueCopyLabelAtIndex (phoneNumberMultiValue, phoneNumberIndex);

            //NSString *phoneLabelLocalized = (__bridge NSString*)ABAddressBookCopyLocalizedLabel(labelStingRef);

            phoneNumber  = (__bridge NSString *)ABMultiValueCopyValueAtIndex(phoneNumberMultiValue, phoneNumberIndex);

            CFRelease(labelStingRef);

            //NSLog(@"Name: %@ %@: %@ | %@", firstNameString, lastNameString, phoneNumber, emailAddresses);

        }
        [phone addObject: phoneNumber];

    }
} 
```

我尝试输入这些代码：

```
ABRecordRef record = (__bridge ABRecordRef)[abContactArray objectAtIndex:loop]; // get address book record

//ABAddressBookRef addressBook = ABAddressBookCreate();
CFArrayRef people = ABAddressBookCopyArrayOfAllPeople(addressBookRef);
CFMutableArrayRef peopleMutable = CFArrayCreateMutableCopy(
                                                           kCFAllocatorDefault,
                                                           CFArrayGetCount(people),
                                                           people
                                                           );

CFArraySortValues(
                  peopleMutable,
                  CFRangeMake(0, CFArrayGetCount(peopleMutable)),
                  (CFComparatorFunction) ABPersonComparePeopleByName,
                  (void*) ABPersonGetSortOrdering()
                  );

//NSMutableArray *data = [(__bridge NSArray *) peopleMutable mutableCopy];
NSMutableArray* data = [NSMutableArray arrayWithArray: (__bridge NSArray*) peopleMutable];

NSLog(@"sort: %@", data); 
```

但是 nslog 给了我这些输出：

```
sort: (
"<CPRecord: 0xaa5d250 ABPerson>",
"<CPRecord: 0xaa6e050 ABPerson>",
"<CPRecord: 0xaa3d7d0 ABPerson>",
"<CPRecord: 0xaa515d0 ABPerson>",
"<CPRecord: 0xaa43b90 ABPerson>",
"<CPRecord: 0xaa6b780 ABPerson>"
) 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-20T19:37:54.907

您可以使用以下方法按名称对条目进行排序：

```
CFArrayRef people = ABAddressBookCopyArrayOfAllPeople(addressBook);
CFMutableArrayRef peopleMutable = CFArrayCreateMutableCopy(kCFAllocatorDefault,
                                                           CFArrayGetCount(people),
                                                           people);

CFArraySortValues(peopleMutable,
                  CFRangeMake(0, CFArrayGetCount(peopleMutable)),
                  (CFComparatorFunction) ABPersonComparePeopleByName,
                  kABPersonSortByFirstName);

// or to sort by the address book's choosen sorting technique
//
// CFArraySortValues(peopleMutable,
//                   CFRangeMake(0, CFArrayGetCount(peopleMutable)),
//                   (CFComparatorFunction) ABPersonComparePeopleByName,
//                   (void*) ABPersonGetSortOrdering());

CFRelease(people);

// If you don't want to have to go through this ABRecordCopyValue logic
// in the rest of your app, rather than iterating through doing NSLog,
// build a new array as you iterate through the records.

for (CFIndex i = 0; i < CFArrayGetCount(peopleMutable); i++)
{
    ABRecordRef record = CFArrayGetValueAtIndex(peopleMutable, i);
    NSString *firstName = CFBridgingRelease(ABRecordCopyValue(record, kABPersonFirstNameProperty));
    NSString *lastName = CFBridgingRelease(ABRecordCopyValue(record, kABPersonLastNameProperty));
    NSLog(@"person = %@, %@", lastName, firstName);
}

CFRelease(peopleMutable); 
```

或者你可以使用这种技术：

```
NSArray *originalArray = CFBridgingRelease(ABAddressBookCopyArrayOfAllPeople(addressBook));
abContactArray = [originalArray sortedArrayUsingComparator:^NSComparisonResult(id obj1, id obj2) {
    ABRecordRef record1 = (__bridge ABRecordRef)obj1; // get address book record
    NSString *firstName1 = CFBridgingRelease(ABRecordCopyValue(record1, kABPersonFirstNameProperty));
    NSString *lastName1 = CFBridgingRelease(ABRecordCopyValue(record1, kABPersonLastNameProperty));

    ABRecordRef record2 = (__bridge ABRecordRef)obj2; // get address book record
    NSString *firstName2 = CFBridgingRelease(ABRecordCopyValue(record2, kABPersonFirstNameProperty));
    NSString *lastName2 = CFBridgingRelease(ABRecordCopyValue(record2, kABPersonLastNameProperty));

    NSComparisonResult result = [firstName1 compare:firstName2];
    if (result != NSOrderedSame)
        return result;
    else
        return [lastName1 compare:lastName2];
}];

for (id object in abContactArray)
{
    ABRecordRef record = (__bridge ABRecordRef)object; // get address book record
    NSString *firstName = CFBridgingRelease(ABRecordCopyValue(record, kABPersonFirstNameProperty));
    NSString *lastName = CFBridgingRelease(ABRecordCopyValue(record, kABPersonLastNameProperty));
    NSLog(@"person = %@, %@", lastName, firstName);
} 
```

前者看起来更干净，但只是另一种选择，以防您想`CFRelease`在 ARC 世界中避免使用。

顺便说一句，`ABAddressBookRequestAccessWithCompletion`在 iOS 6 中使用检查以确保您有权访问地址簿（使用条件检查以确保它仍然适用于早期版本的 iOS）。即使您使用的是早期版本的 iOS，您也应该手动向用户请求权限。

# jquery - NVelocity 将循环结果保存到 JS 变量中

> ID：13976556
> 
> 赞同：1
> 
> 时间：2012-12-20T16:33:35.073
> 
> 标签：jquery, asp.net-mvc-3, nvelocity

我遇到了 nvelocity #foreach 语句的问题。我想将集合项属性保存到 js 变量中。所以我认为像这样的结构可以解决这个问题。

> jQuery('#resendButton').bind('click',
> 
> > ```
> >  function (e) {
> >           var failedItems = [#foreach($item in $FailedOrders)
> >                $item.SpecificId#between
> >                ,
> >              #end
> >           ... 
> >    }); 
> > ```

但它失败了。我什至无法调试它。在 vm 上实现这样一段逻辑的最佳方法是什么？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-08T04:50:13.270

我在这里遇到了同样的问题，你能解释一下你是如何克服它的吗？

嗨，我认为 [NVelocity 高级裁剪语法](https://stackoverflow.com/questions/19236300/nvelocity-advance-lopping-syntax/19248126?noredirect=1#19248126) 将帮助您解决问题

# vb.net - VB.NET Listview 多列过滤器

> ID：13976557
> 
> 赞同：1
> 
> 时间：2012-12-20T16:33:37.843
> 
> 标签：vb.net, listview, search

我的目标是开发使用多个文本框的搜索。我有五列（ArticleNo、Description、PartNum、Manufacturer 和 Cost），每列都有一个文本框。

* * *

我使用以下方法跟踪原始列表项：

```
Private originalListItems As New List(Of ListViewItem) 
```

这充满了所有项目（超过 6000 个）。

然后，我将根据创建的五个文本框（tbSearchArticleNo、tbSearchDescription、tbSearchPartNum ... 等）发生五个“文本更改”事件

```
Private Sub tbSearchArticleNo_TextChanged(sender As Object, e As System.EventArgs) Handles tbSearchArticleNo.TextChanged
    If tbSearchDesc.Text <> "" Or tbPartNum.Text <> "" Or tbManufacturer.Text <> "" Or tbCost.Text <> "" Then
        SearchCurrentList(lwArticles, tbSearchArticleNo.Text, 0, False)
    Else
        SearchListView(lwArticles, tbSearchArticleNo.Text, 0, False)
    End If
End Sub 
```

这是我的方法 SearchCurrentList：

```
Private Sub SearchCurrentList(ByVal listview As ListView, ByVal search As String, ByVal colIndex As Integer, ByVal upperCase As Boolean)
    If upperCase Then
        search = search.ToUpper()
    End If

    listview.BeginUpdate()

    'Clear listview
    lwArticles.Items.Clear()

    'Other textbox has information in it, concatenate both results
    For Each item In currentListItems
        Dim itemToUpper = item.SubItems.Item(colIndex).Text
        If upperCase Then
            itemToUpper = item.SubItems.Item(colIndex).Text.ToUpper()
        End If
        If itemToUpper.Contains(search) Then
            lwArticles.Items.Add(item)
        End If
    Next

    'Reupdate the current list of items
    currentListItems.Clear()
    For Each item In lwArticles.Items
        currentListItems.Add(item)
    Next

    listview.EndUpdate()
End Sub 
```

这是我的方法 SearchListView：

```
Private Sub SearchListView(ByVal listview As ListView, ByVal search As String, ByVal colIndex As Integer, ByVal upperCase As Boolean)
    'Upper case parameter determines if you're searching a string, if so, it is better to compare everything by uppercase
    If upperCase Then
        search = search.ToUpper()
    End If

    listview.BeginUpdate()

    If search.Trim().Length = 0 Then
        'Clear listview
        listview.Items.Clear()

        'Clear currentListItems
        currentListItems.Clear()

        'If nothing is in the textbox make all items appear
        For Each item In originalListItems
            listview.Items.Add(item)
        Next

    Else
        'Clear listview
        listview.Items.Clear()

        'Clear currentListItems
        currentListItems.Clear()

        'Go through each item in the original list and only add the ones which contain the search text
        For Each item In originalListItems
            Dim currItem = item.SubItems.Item(colIndex).Text
            If upperCase Then
                currItem = currItem.ToUpper()
            End If
            If currItem.Contains(search) Then
                currentListItems.Add(item)
                listview.Items.Add(item)
            End If
        Next
    End If

    listview.EndUpdate()
End Sub 
```

这是我的搜索示例：

tbSearchArticleNo.Text = "33"

这将匹配字符串中包含“33”的每个 articleNo。现在我想添加另一个过滤器：

tbSearchDescription.Text = "混合器"

这应该与文章编号中包含 33 以及描述中的“混合器”的所有内容相匹配。等等等等第四个。

* * *

实际的过滤器工作正常 - 我唯一的问题是每当我删除某些东西时，例如“Mixer”（虽然文章编号中仍有“33”）它不会返回包含“33”的文章编号的结果......相反它不会改变我的搜索结果。可能有更好的方法来搜索这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:48:16.583

与其一次只过滤一列并传入当前列表以进一步过滤结果，不如使用一个函数一次根据所有指定值进行过滤：

1.  从每个过滤器文本框的 TextChanged（或 Validated）事件中调用单个“过滤器”函数。
2.  在 Filter 函数中，首先将 originalListItems 重新复制到 lwArticles 中。
3.  为每个具有序列值的文本框应用过滤器。（为每个文本框调用 SearchCurrentList，传入 lwArticles。每一步都从上一步进一步过滤列表，但只对具有值的文本框起作用。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T17:08:56.930

很难遵循您正在尝试做的事情，但我建议如果您正在处理列表视图中的 6k 个项目并想要过滤它们，也许您应该使用数据绑定的网格视图。

然后就可以对数据源进行搜索了，非常简单：

```
Public Class Form1
Private _articleList As List(Of Article)

Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    'populate _itemList somehow, for example from a database. Manually here for example purposes:
    _articleList = New List(Of Article) From {
        New Article("jenny cooks fish", "cooking"),
        New Article("a better sales team", "sales")}
    DataGridView1.DataSource = _articleList
End Sub

Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    Dim filtered As List(Of Article) = _articleList.Where(Function(x) x.Title.Contains("cook") AndAlso x.Category = "cooking").ToList
    DataGridView1.DataSource = filtered

End Sub
End Class

Public Class Article
Property Title As String
Property Category As String
'etc etc

Public Sub New(ByVal title As String, ByVal category As String)
    _Title = title
    _Category = category
End Sub
End Class 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T17:18:32.523

处理此问题的另一种方式是使用 LINQ。以下函数可用于返回一个对象，该对象枚举提供的集合，仅包括那些适合过滤器的项目。您可以使用此枚举器重新填充您的列表。如果您每次调用 GetFilter 时都使用 originalListItems，那么您将始终将每个项目都包含在最新的过滤器中以供考虑。

```
Function GetFilter(source As IEnumerable(Of ListViewItem), articleNo As String, description As String,
                  partNum As String, prop4 As String, prop5 As String) As IQueryable(Of ListViewItem)
  GetFilter = source.AsQueryable

  Dim articleFilter As Expressions.Expression(Of Func(Of ListViewItem, Boolean)) = _
     Function(i As ListViewItem) i.SubItems(0).Text.IndexOf(articleNo, StringComparison.InvariantCultureIgnoreCase) >= 0
  Dim descFilter As Expressions.Expression(Of Func(Of ListViewItem, Boolean)) = _
     Function(i As ListViewItem) i.SubItems(1).Text.IndexOf(description, StringComparison.InvariantCultureIgnoreCase) >= 0
  Dim partFilter As Expressions.Expression(Of Func(Of ListViewItem, Boolean)) = _
     Function(i As ListViewItem) i.SubItems(2).Text.IndexOf(partNum, StringComparison.InvariantCultureIgnoreCase) >= 0
  Dim prop4Filter As Expressions.Expression(Of Func(Of ListViewItem, Boolean)) = _
     Function(i As ListViewItem) i.SubItems(3).Text.IndexOf(prop4, StringComparison.InvariantCultureIgnoreCase) >= 0
  Dim prop5Filter As Expressions.Expression(Of Func(Of ListViewItem, Boolean)) = _
     Function(i As ListViewItem) i.SubItems(4).Text.IndexOf(prop5, StringComparison.InvariantCultureIgnoreCase) >= 0

  If Not String.IsNullOrEmpty(articleNo) Then GetFilter = Queryable.Where(GetFilter, articleFilter)
  If Not String.IsNullOrEmpty(description) Then GetFilter = Queryable.Where(GetFilter, descFilter)
  If Not String.IsNullOrEmpty(partNum) Then GetFilter = Queryable.Where(GetFilter, partFilter)
  If Not String.IsNullOrEmpty(prop4) Then GetFilter = Queryable.Where(GetFilter, prop4Filter)
  If Not String.IsNullOrEmpty(prop5) Then GetFilter = Queryable.Where(GetFilter, prop5Filter)
End Function 
```

更好的是，稍微考虑一下，您可能可以将 articleNo 和其他参数设置为具有更大范围的变量，并调整函数以将 IsNullOrEmpty 检查嵌入到 Queryable 表达式中，然后您甚至不需要重新生成字段值更改时的过滤器。您可以将变量设置为新的文本框值并重新评估已经生成的过滤器表达式，这将考虑变量中的新值，从而产生新的过滤结果。

这是我希望它被使用的方式：

```
lwArticles.Items.Clear()
For Each i In GetFilter(originalListItems, tbSearchArticleNo.Text, tbSearchDesc.Text, tbPartNum.Text, tbManufacturer.Text, tbCost.Text)
   lwArticles.Items.Add(i)
Next 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T18:59:21.377

我设法让它工作。对于那些想知道如何的人来说，它并不那么优雅 - 但它确实有效！

我在四个文本框的 GUI 上设置了标签（在与工程师进一步交谈后，我省略了成本文本框）。所以..

tbSearchArticleNo.Tag = 1

tbSearchDesc.Tag = 2

tbPartNum.Tag = 4

tbManufacturer.Tag = 8

这并不优雅，因为随着您添加文本框，您将呈指数级增长。（小心）根据输入的字段，计算一个总数，然后由我的 FilterOriginalList(total) 处理

```
Private Sub tbSearchArticleNo_TextChanged(sender As Object, e As System.EventArgs) Handles tbSearchArticleNo.TextChanged, tbSearchDesc.TextChanged, tbPartNum.TextChanged, tbManufacturer.TextChanged
    Dim tag1 As Integer = 0
    Dim tag2 As Integer = 0
    Dim tag3 As Integer = 0
    Dim tag4 As Integer = 0

    If tbSearchArticleNo.Text <> "" Then
        tag1 = tbSearchArticleNo.Tag
    End If

    If tbSearchDesc.Text <> "" Then
        tag2 = tbSearchDesc.Tag
    End If

    If tbPartNum.Text <> "" Then
        tag3 = tbPartNum.Tag
    End If

    If tbManufacturer.Text <> "" Then
        tag4 = tbManufacturer.Tag
    End If

    FilterOriginalList(tag1 + tag2 + tag3 + tag4)
End Sub 
```

这是我的方法：

```
Private Sub FilterOriginalList(ByRef tagCounter As Integer)
    Dim field1 As String = tbSearchArticleNo.Text
    Dim field2 As String = tbSearchDesc.Text.ToUpper()
    Dim field4 As String = tbPartNum.Text.ToUpper()
    Dim field8 As String = tbManufacturer.Text.ToUpper()

    lwArticles.BeginUpdate()

    'Clear listview
    lwArticles.Items.Clear()

    For Each item In originalListItems
        Dim currField1 = item.SubItems.Item(0).Text
        Dim currField2 = item.SubItems.Item(1).Text.ToUpper
        Dim currField4 = item.SubItems.Item(2).Text.ToUpper
        Dim currField8 = item.SubItems.Item(3).Text.ToUpper

        Select Case (tagCounter)
            Case 0
                lwArticles.Items.Add(item)
            Case 1
                If currField1.Contains(field1) Then
                    lwArticles.Items.Add(item)
                End If
            Case 2
                If currField2.Contains(field2) Then
                    lwArticles.Items.Add(item)
                End If
            Case 3
                If currField1.Contains(field1) And currField2.Contains(field2) Then
                    lwArticles.Items.Add(item)
                End If
            Case 4
                If currField4.Contains(field4) Then
                    lwArticles.Items.Add(item)
                End If
            Case 5
                If currField1.Contains(field1) And currField4.Contains(field4) Then
                    lwArticles.Items.Add(item)
                End If
            Case 6
                If currField2.Contains(field2) And currField4.Contains(field4) Then
                    lwArticles.Items.Add(item)
                End If
            Case 7
                If currField1.Contains(field1) And currField2.Contains(field2) And currField4.Contains(field4) Then
                    lwArticles.Items.Add(item)
                End If
            Case 8
                If currField8.Contains(field8) Then
                    lwArticles.Items.Add(item)
                End If
            Case 9
                If currField1.Contains(field1) And currField8.Contains(field8) Then
                    lwArticles.Items.Add(item)
                End If
            Case 10
                If currField2.Contains(field2) And currField8.Contains(field8) Then
                    lwArticles.Items.Add(item)
                End If
            Case 11
                If currField1.Contains(field1) And currField2.Contains(field2) And currField8.Contains(field8) Then
                    lwArticles.Items.Add(item)
                End If
            Case 12
                If currField4.Contains(field4) And currField8.Contains(field8) Then
                    lwArticles.Items.Add(item)
                End If
            Case 13
                If currField1.Contains(field1) And currField4.Contains(field4) And currField8.Contains(field8) Then
                    lwArticles.Items.Add(item)
                End If
            Case 14
                If currField2.Contains(field2) And currField4.Contains(field4) And currField8.Contains(field8) Then
                    lwArticles.Items.Add(item)
                End If
            Case 15
                If currField1.Contains(field1) And currField2.Contains(field2) And currField4.Contains(field4) And currField8.Contains(field8) Then
                    lwArticles.Items.Add(item)
                End If
        End Select
    Next
    lwArticles.EndUpdate()
End Sub 
```

感谢所有帮助过的人。这是我找到的解决方案 - 我将来可能会研究更容易的东西！

# ruby-on-rails - NoMethodError（Heroku 的 Logger 的未定义方法“刷新”

> ID：13976558
> 
> 赞同：2
> 
> 时间：2012-12-20T16:33:45.027
> 
> 标签：ruby-on-rails, ruby, heroku

当我将 Rails 应用程序上传到 Heroku 时，使用 heroku 日志时出现错误

```
NoMethodError (undefined method `flush' for #<Logger:0x00000005501680>):
2012-12-20T16:20:42+00:00 app[web.1]:   app/controllers/application_controller.rb:19:in `block in <class:ApplicationController>' 
```

这是因为

```
 rescue_from 'Exception' do |ex|
    Rails.logger.fatal formatted_exception(ex)
    Rails.logger.flush 
```

在`ApplicationController`.

我如何解决它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T17:17:25.967

Flush 是定义在 IO 上的方法，它将缓冲的输出刷新到管道。

鉴于 Heroku 的多环境设置，他们可能有自己的 IO 管道实现，可能没有定义刷新。如果 Flush 没有被定义，那么你不需要它是一个相当安全的赌注，它会在接收到输入时自动刷新。

怎么样

```
rescue_from 'Exception' do |ex|
  Rails.logger.fatal formatted_exception(ex)
  Rails.logger.flush if Rails.logger.respond_to? :flush 
```

附言

您可能不应该挽救 Exception：[为什么在 Ruby 中 `rescue Exception => e` 是一种不好的风格？](https://stackoverflow.com/questions/10048173/why-is-it-bad-style-to-rescue-exception-e-in-ruby)

# c# - 无法将类型“Plantool.xRoute.LineString[]”隐式转换为“Plantool.xMap.LineString[]”

> ID：13976559
> 
> 赞同：1
> 
> 时间：2012-12-20T16:34:01.867
> 
> 标签：c#, xserver

情况：我有 3 个网络参考（xMap、xLocation、xRoute）xMap 专用于生成地图。xLocation 专门用于定位地点。xRoute 专门用于生成路由。

我正在使用一个简单的 GUI 来显示地图并输入起点和终点路线的位置。

这些是我的错误。

> 错误 1 ​​无法将类型“Plantool.xRoute.LineString[]”隐式转换为“Plantool.xMap.LineString[]”
> 
> 错误 2 'Plantool.xMap.XMapWSService.renderMapBoundingBox(Plantool.xMap.BoundingBox, Plantool.xMap.MapParams, Plantool.xMap.ImageInfo, Plantool.xMap.Layer[], bool, Plantool.xMap.CallerContext 的最佳重载方法匹配)' 有一些无效的参数
> 
> 错误 3 参数“1”：无法从“Plantool.xRoute.BoundingBox”转换为“Plantool.xMap.BoundingBox”

我猜测 PTV xServer 的重复方法/功能/等与 xMap、xLocate、xRoute 是可选模块相同。这可能是一个简单的答案，有解决方案吗？

我正在寻找回家的长途旅行的头，并在此代码上花费额外的半小时加班上瘾。嗨，我是新来的。

低于他我的班。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Plantool.xMap;
using Plantool.xLocate;
using Plantool.xRoute;

namespace Plantool
{
    class ClassMap
    {
        /*
         * xServer clients
         */
        private static XMapWSService xMapClient = new XMapWSService();
        private static XRouteWSService xRouteClient = new XRouteWSService();
        private static XLocateWSService xLocateClient = new XLocateWSService();

        /* getLocation()
         * Input: Address string
         * Output: WKT (Well-Known-Text) Location
         * Edited 20/12/12 - Davide Nguyen
         */
        public string getLocation(string input)
        {
            // create the adress object
            string[] address = input.Split(',');
            Address addr = new Address();
            addr.country = address[0];
            addr.city = address[1];
            addr.postCode = address[2];

            // call findAddress on the xLocate server  
            // only the first argument of findAddress is mandatory,  
            // all others are nullable (see xLocate API documentation)
            AddressResponse response = xLocateClient.findAddress(addr, null, null, null, null);

            string result = "";
            foreach (ResultAddress ra in response.wrappedResultList)
            {
                result += String.Format("POINT( {0} {1}) ", ra.coordinates.point.x, ra.coordinates.point.y);
            }
            string result2 = result.Replace(",", ".");
            return result2;
        }

        /* route()
         * Input: Start address, Destination address
         * Output: string[] [0] DISTANCE [1] TIME [2] MAP
         * Edited 20/12/12 - Davide Nguyen
         */
        public string[] route(string startlocation, string destination)
        {
            #region WaypointDesc[]
            // create the WayPoint for the Start
            // ATTENTION: Here at the object WaypointDesc the parameters are not named
            // "coords" as described within the documentation but
            // "wrappedCoords"
            WaypointDesc wpdStart = new WaypointDesc();
            // please note that this has to be an array of Point...
            wpdStart.wrappedCoords = new xRoute.Point[] { new xRoute.Point() };
            wpdStart.wrappedCoords[0].wkt = getLocation(startlocation);

            // Waypoint for the Destination...
            WaypointDesc wpdDestination = new WaypointDesc();
            wpdDestination.wrappedCoords = new xRoute.Point[] { new xRoute.Point() };
            wpdDestination.wrappedCoords[0].wkt = getLocation(destination);

            // create a new array of WayPointDescriptions and fill it with Start and Destination
            WaypointDesc[] waypointDesc = new WaypointDesc[] { wpdStart, wpdDestination };
            #endregion

            try
            {
                // Route
                Route route = calculateRoute(waypointDesc);

                // Map
                string DisplayMapURL = createMap(waypointDesc, route);

                // get route info
                string[] routeinfo = getRouteInfo(waypointDesc);

                // Create the result
                string[] result = new string[3];
                result[0] = routeinfo[0]; // Distance
                result[1] = routeinfo[1]; // Time
                result[2] = DisplayMapURL;// Map URL

                // Return the result
                return result;
            }
            catch
            {
                throw new NotImplementedException();
            }
        }

        /* getRouteInfo()
         * Input: WaypointDesc[]
         * Output: string mapURL
         * Edited 20/12/12 - Davide Nguyen
         */
        private static string createMap(WaypointDesc[] waypointDesc, Route route)
        {
            #region boundingBox
            // Set boundingBox fand use corners from the calculated route
            xRoute.BoundingBox boundingBox = new xRoute.BoundingBox();
            boundingBox.leftTop = route.totalRectangle.rightTop;
            boundingBox.rightBottom = route.totalRectangle.leftBottom;
            #endregion

            #region mapParams
            // Build mapParams
            MapParams mapParams = new MapParams();
            mapParams.showScale = true;
            mapParams.useMiles = false;
            #endregion

            #region imageInfo
            // Create imageInfo and set the frame size and image format. NOTE: 1052; 863
            ImageInfo imageInfo = new ImageInfo();
            imageInfo.format = ImageFileFormat.PNG;
            imageInfo.height = 1052;
            imageInfo.width = 863;
            imageInfo.imageParameter = "";
            #endregion

            #region layers
            // Create a line from the calculated route
            xRoute.LineString[] lineStrings = new xRoute.LineString[] { route.polygon };
            Lines[] lines = new Lines[1];
            LineOptions options = new LineOptions();
            LinePartOptions partoptions = new LinePartOptions();
            partoptions.color = new Color();
            partoptions.visible = true;
            partoptions.width = -10;
            options.mainLine = partoptions;

            lines[0] = new Lines();
            lines[0].wrappedLines = lineStrings;                                                                                    //NEED HELP
            lines[0].options = options;

            // Define customLayer that contains the object lines and set layers.
            CustomLayer customLayer = new CustomLayer();
            customLayer.visible = true;
            customLayer.drawPriority = 100;
            customLayer.wrappedLines = lines;
            customLayer.objectInfos = ObjectInfoType.NONE;
            customLayer.centerObjects = true;
            Layer[] layers = new Layer[] { customLayer };
            #endregion

            #region includeImageInResponse
            // Set argument includeImageInResponse to false (default).
            Boolean includeImageInResponse = false;
            #endregion

            // Return object map using the following method.
            Map map = xMapClient.renderMapBoundingBox(boundingBox, mapParams, imageInfo, layers, includeImageInResponse, null);     // NEED HELP

            // Retrieve the image
            string result = "http://" + map.image.url;

            // Return the drawn map
            return result;
        }

        /* getRouteInfo()
         * Input: WaypointDesc[]
         * Output: string[] [0] Distance in M [1] Time in H:M:S:MS
         * Edited 20/12/12 - Davide Nguyen
         */
        private string[] getRouteInfo(WaypointDesc[] waypointDesc)
        {
            // Call the service
            RouteInfo routeInfo = xRouteClient.calculateRouteInfo(waypointDesc, null, null, null);

            // Create the result
            TimeSpan t = TimeSpan.FromSeconds(routeInfo.time);
            string[] result = new string[2];
            result[0] = string.Format("{0} KM", routeInfo.distance);
            result[1] = string.Format("{0:D2}h:{1:D2}m:{2:D2}s:{3:D3}ms", t.Hours, t.Minutes, t.Seconds, t.Milliseconds);

            // Return the result
            return result;
        }

        /* getRouteLines() 
         * Input: WaypointDesc[]
         * Output: Route object
         * Edited 20/12/12 - Davide Nguyen
         */
        private static Route calculateRoute(WaypointDesc[] waypointDesc)
        {
            #region ResultListOptions
            // Instantiate a new object resultListOPtions
            ResultListOptions resultListOptions = new ResultListOptions();
            resultListOptions.polygon = true;
            resultListOptions.totalRectangle = true;
            resultListOptions.detailLevel = DetailLevel.STANDARD;
            #endregion

            #region CallerContext/CallerContextPropery
            // Create a new CallerContextProperty object property
            xRoute.CallerContextProperty property = new xRoute.CallerContextProperty();
            property.key = "ResponseGeometry";
            property.value = "WKT";
            xRoute.CallerContext callerContext = new xRoute.CallerContext();
            callerContext.wrappedProperties = new xRoute.CallerContextProperty[] { property };
            #endregion

            // Call the service
            Route route = xRouteClient.calculateRoute(waypointDesc, null, null, resultListOptions, callerContext);

            return route;
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:39:02.960

这两者之间似乎存在一些参考混淆。

```
using Plantool.xMap;
using Plantool.xRoute; 
```

你可以删除这些：

```
using Plantool.xMap;
using Plantool.xLocate;
using Plantool.xRoute; 
```

只需添加以下内容：

```
using Plantool; 
```

然后显式引用正确的类型，确保您引用的是所需的类型。这应该解决所有三个错误消息。

理想情况下，您应该避免只有命名空间不同的名称冲突。在 .NET 框架中，您会注意到他们小心翼翼地避免这种情况，例如......

```
System.Data.Odbc.OdbcConnection
 System.Data.SqlClient.SqlConnection 
```

`Connection`考虑到一个在`Odbc`命名空间中，一个在命名空间中，它们可能都被称为`SqlClient`—— 但这可能会导致您遇到的问题。

通过重命名`LineString`为`RouteLineString`and`MapLineString`您可以避免应用程序中的混淆。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T15:07:49.093

根据我对 xServer 的记忆，这是一个主要问题：xMap、xRoute 和 xLocate 中的常见类型不一样（就像你说的，因为它们是可选模块）。`xMap.LineString`实际上是与 不同的类型`xRoute.LineString`，即使它们具有相同的属性。您对此无能为力，除了：

*   如果两种类型共享一个公共基类型或接口，请改用这个公共类型
*   编写扩展方法以映射 from`xRoute.LineString`到`xLocate.LineString`...等。

例如：

```
public static xLocate.LineString ToXLocateLineString(this xRoute.LineString lineString)
{
    return new xLocate.LineString
    {
        // Map type by copying properties
        ....
    };
} 
```

所以你可以写

```
xRoute.LineString[] input = ....
xMap.LineString[] output = input.Select(z => z.ToXLocateLineString()).ToArray(); 
```

甚至

```
public static xLocate.LineString[] ToXLocateLineStringArray(this xRoute.LineString[] lineString)
{
    return lineString.Select(z => z.ToXLocateLineString()).ToArray();
} 
```

然后

```
xMap.LineString[] output = input.ToXLocateLineStringArray(); 
```

也许他们改进了他们的 API，因为我最后一次使用它，对此不确定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-12T10:14:53.033

干杯，在我看来，冗余可以通过正确创建客户端类来解决。您可以使用 Visual Studio 的 WSDL.EXE 在一个步骤中合并 WSDL，而不是一个一个地添加三个 WSDL（通过 Visual Studio 向导）。这适用于 PTV xServer 1（在此线程中引用），甚至更好地适用于 xServer2 我通常做的是 CMD 语句，例如

> WSDL /namespace:"XServer" /sharetypes /out:"XServer.cs" "https://xserver2-europe-eu-test.cloud.ptvgroup.com/services/ws/XLocate?wsdl" "https://xserver2 -europe-eu-test.cloud.ptvgroup.com/services/ws/XRoute?wsdl" "https://xserver2-europe-eu-test.cloud.ptvgroup.com/services/ws/XTour?wsdl"

将此视为一般建议。如今的映射接口完全不同。

# ios - 在 NSString 中查找第一个字母并倒数

> ID：13976560
> 
> 赞同：1
> 
> 时间：2012-12-20T16:34:07.680
> 
> 标签：ios, parsing, nsstring, nsscanner

我是IOS的新手，正在寻找一些指导。

我有一个很长的 NSString 正在解析。开头可能有几个垃圾字符（可以是任何非字母字符），然后是 11 个数字或空格，然后是单个字母 (AZ)。我需要获取字母的位置，并将字母后面 11 个字符的子字符串转换为字母后面的 1 个字符。

谁能给我一些关于如何做到这一点的指导？

例子：`'!!2553072 C'`

而且我要 ：`'53072 '`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T16:48:42.857

您可以使用正则表达式模式完成此操作：`(.{11})\b[A-Z]\b`

将`(.{11})`抓取任何 11 个字符，并将`\b[A-Z]\b`在单词边界上查找单个字符，这意味着它将被空格包围或位于字符串的末尾。如果字符可以跟随`C`您的示例中的 ，则删除最后一个`\b`. 这可以在 Objective-C 中完成，如下所示：

```
NSError *error;
NSString *example = @"!!2553072      C";
NSRegularExpression *regex = [NSRegularExpression
                              regularExpressionWithPattern:@"(.{11})\\b[A-Z]\\b"
                              options:NSRegularExpressionCaseInsensitive
                              error:&error];

if(!regex)
{
    //handle error
}

NSTextCheckingResult *match = [regex firstMatchInString:example
                                                options:0
                                                  range:NSMakeRange(0, [example length])];
if(match)
{
    NSLog(@"match: %@", [example substringWithRange:[match rangeAtIndex:1]]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T16:39:38.433

您可以使用[NSCharacterSet](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSCharacterSet_Class/Reference/Reference.html)来拆分字符串，然后获取第一个剩余的组件（由您的垃圾和数字组成）并获取它的子字符串。例如（未编译，未测试）：

```
- (NSString *)parseString:(NSString *)myString {
    NSCharacterSet *letters = [NSCharacterSet letterCharacterSet];
    NSArray *components = [myString componentsSeparatedByCharactersInSet:letters];
    assert(components.count > 0);
    NSString *prefix = components[0]; // assuming relatively new Xcode
    return [prefix substringFromIndex:(prefix.length - 11)];
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T16:47:00.310

可能有一种更优雅的方法可以做到这一点，涉及正则表达式或一些 Objective-C 魔法，但这里有一个简单的解决方案（个人测试）。

```
-(NSString *)getStringContent:(NSString *)input
{
    NSString *substr = nil;
    NSRange singleLetter = [input rangeOfCharacterFromSet:[NSCharacterSet letterCharacterSet]];
    if(singleLetter.location != NSNotFound)
    {
        NSInteger startIndex = singleLetter.location - 11;
        NSRange substringRange = NSMakeRange(start, 11);
        substr = [tester substringWithRange:substringRange];
    }

    return substr;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-15T12:08:35.863

```
//to get rid of all non-Digits in a NSString
NSString *customerphone = CustomerPhone.text;
int phonelength = [customerphone length];
NSRange customersearchRange = NSMakeRange(0, phonelength);
for (int i =0; i < phonelength;i++)
{
    const unichar c = [customerphone characterAtIndex:i];
    NSString* onechar = [NSString stringWithCharacters:&c length:1];
    if(!isdigit(c))
    {
        customerphone = [customerphone stringByReplacingOccurrencesOfString:onechar withString:@"*" options:0 range:customersearchRange];
    }
}
NSString *PhoneAllNumbers = [customerphone stringByReplacingOccurrencesOfString:@"*" withString:@"" options:0 range:customersearchRange]; 
```

# android - 用户单击 android 应用程序中的强制停止时需要警报机制

> ID：13976561
> 
> 赞同：3
> 
> 时间：2012-12-20T16:34:07.513
> 
> 标签：android

我是android开发的新手，所以如果我的问题很简单，请道歉。

我正在尝试构建一个基于位置的应用程序的 android 应用程序，用户（例如人 A）可以通过该应用程序连续跟踪另一个用户（例如人 B）的位置。

在应用程序设置中，我们有一个名为“强制停止”的选项。所以从上面的例子来看，任何时候 B 都可以使用这个“强制停止”杀死我正在运行的应用程序，这样他的位置就不会被 A 正确监控。

我需要避免这种情况。我必须持续监控人 B 的位置，并让他避免使用“强制停止”杀死我的应用程序。我怎样才能做到这一点？

*   当人 B 单击“强制停止”按钮时，android 中是否有任何方法可以调用特定方法（以便我可以向人 A 提供一些警报代码）。

*   或者有什么办法，即使B人停止了我的应用程序，我也可以提醒用户并再次重新启动我的应用程序！

请提出建议。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T19:35:16.287

用户 B 的应用程序无法通知用户 A 用户 B 单击了“强制停止”，因为“强制停止”会立即停止一切。

但是，如果用户 A 的应用程序期望用户 B 定期更新，则用户 A 可以推断。如果用户 A 的应用程序每分钟 ping 用户 B，并且在 1 分钟后用户 B 的应用程序没有响应，则用户 A 的应用程序可以假设用户 B 的应用程序是“死的”。无论如何，这可能是一种更好的方法。除了“强制停止”之外的其他事情可能会导致用户 B 的应用程序不可用：用户 B 关闭设备，用户 B 无法再与用户 A 通信，Android 认为用户 B 的应用程序是低优先级并杀死它，用户 B 的应用程序崩溃因为一个错误等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T11:34:24.863

您需要为此使用 DeviceAdmin api。如果以管理员身份启用，用户将无法卸载您的应用程序。

# jquery-ui - 跨度中未显示 JQuery UI 图标

> ID：13976562
> 
> 赞同：2
> 
> 时间：2012-12-20T16:34:09.403
> 
> 标签：jquery-ui, icons, html

我有一个跨度，我想显示一个 jQuery UI 图标（ .ui-icon-plusthick ）。这是代码：

```
<div>
     <div id="pop">
          <label for="ptitle">Plot title: </label>
          <textarea class="nrtextarea" id="ptitle" maxlength="80" />
          <span class="ui-icon-plusthick" title="Add"></span>
     </div>
</div> 
```

通过CSS我尝试设置：

```
display: inline-block;
width: 20px;
height: 20px; 
```

但没有结果；此外，宽度和高度保持 0px x 16px。我究竟做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T16:43:00.580

尝试将课程更改为：

```
class="ui-icon ui-icon-plusthick" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T16:39:43.943

首先，如果您想欺骗鼠标悬停/悬停事件，则必须将css应用于带有尾随的类：悬停

```
.ui-icon-plusthick:hover{
display: inline-block; 
width: 20px;
height: 20px;
} 
```

# android - 带有drawableTop的按钮中的图像无法调整大小

> ID：13976563
> 
> 赞同：1
> 
> 时间：2012-12-20T16:34:11.190
> 
> 标签：android, image, button, resize

我有一个简单的仪表板布局，其中有几个`Button`显示图像和文本的 。

```
<Button
        android:id="@+id/some_id"
        style="@style/DashboardButton"
        android:drawableTop="@drawable/image"
        android:text="@string/text" />

<style name="DashboardButton">
    <item name="android:layout_gravity">center_vertical</item>
    <item name="android:layout_width">wrap_content</item>
    <item name="android:layout_height">wrap_content</item>
    <item name="android:gravity">center_horizontal</item>
    <item name="android:drawablePadding">2dp</item>
    <item name="android:textSize">20dp</item>
    <item name="android:textStyle">bold</item>
    <item name="android:textColor">#000000</item>
    <item name="android:background">@null</item>
</style> 
```

但是，我似乎无法通过修改`layout_width`或来影响图像的大小`layout_height`。我需要平板电脑上的图像更大，现在它们在那里太小了。

有没有办法轻松做到这一点？

# redmine - 项目页面上的 Redmine 自定义字段

> ID：13976564
> 
> 赞同：3
> 
> 时间：2012-12-20T16:34:11.533
> 
> 标签：redmine, percentage, redmine-plugins

我最近设置了 Redmine 并且非常喜欢它。但是，我真正想要的一个功能是在百分比类型的工具中设置项目完成（例如 5% 10% 等），开发人员可以简单地对其进行编辑，而不是自动化。

我知道您可以创建自定义字段，但我真正想要的是该列可以显示在“主页”/“项目页面”上，以提供更详细的概述，而不是进入每个单独的项目。

有没有办法用任何插件做到这一点？

我正在运行 Redmine 2.2.0

对此的任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T14:52:04.093

您不能将自定义字段放在项目列表页面上（或需要搜索第三方解决方案），但您可以使用[扩展字段](http://projects.andriylesyuk.com/projects/extended-fields/wiki/Custom-fields-view-customization)插件自定义自定义字段以显示为仪表栏。

# machine-learning - 神经网络：“线性可分”是什么意思？

> ID：13976565
> 
> 赞同：37
> 
> 时间：2012-12-20T16:34:12.157
> 
> 标签：machine-learning, neural-network

我目前正在阅读 Tom Mitchell 的机器学习书。在谈到神经网络时，米切尔说：

> “虽然感知器规则在训练样本线性可分时找到了一个成功的权重向量，但如果样本不是线性可分的，它可能无法收敛。”

我无法理解他对“线性可分”的含义？维基百科告诉我，“如果二维空间中的两组点可以被一条线完全分开，那么它们就是线性可分的。”

但这如何适用于神经网络的训练集？输入（或动作单元）如何线性可分？

我在几何和数学方面不是最好的——有人能像我 5 岁一样向我解释吗？;） 谢谢！

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-12-20T17:49:45.723

假设您要编写一个算法，该算法根据大小和价格这两个参数来决定房屋是否会在出售的同一年出售。因此，您有 2 个输入，即尺寸和价格，以及一个输出，将出售或不出售。现在，当您收到训练集时，可能会发生输出未累积以使我们的预测容易的情况（您能告诉我，根据第一张图`X`是 N 还是 S？第二张图怎么样）：

```
 ^
        |  N S   N
       s|  S X    N
       i|  N     N S
       z|  S  N  S  N
       e|  N S  S N
        +----------->
          price

        ^
        |  S S   N
       s|  X S    N
       i|  S     N N
       z|  S  N  N  N
       e|    N N N
        +----------->
          price 
```

在哪里：

```
S-sold,
N-not sold 
```

正如您在第一张图中看到的那样，您无法真正将两种可能的输出（已售出/未售出）用一条直线分开，无论您如何尝试，这条线的两侧总是会有两者`S`，这`N`意味着您的算法将有很多`possible`行，但没有最终的、正确的行来拆分 2 个输出（当然还有预测新的行，这是从一开始的目标）。这就是为什么`linearly separable`（第二张图）数据集更容易预测的原因。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2012-12-20T16:40:13.783

这意味着存在一个超平面（将您的输入空间分成两个半空间），使得第一类的所有点都在一个半空间中，而第二类的所有点都在另一个半空间中。

在二维中，这意味着有一条线将一个类的点与另一类的点分开。

编辑：例如，在这张图片中，如果蓝色圆圈代表一个类的点，红色圆圈代表另一个类的点，那么这些点是线性可分的。

![在此处输入图像描述](../Images/1835247a28071e253af0b4f875c53241.png)

在三个维度上，这意味着有一个平面将一个类的点与另一类的点分开。

在更高的维度上，它是相似的：必须存在一个超平面来分隔两组点。

你提到你不擅长数学，所以我没有写正式的定义，但如果有帮助，请告诉我（在评论中）。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-12-20T16:42:24.233

看以下两个数据集：

```
^                         ^
|   X    O                |  AA    /
|                         |  A    /
|                         |      /   B
|   O    X                |  A  /   BB
|                         |    /   B
+----------->             +-----------> 
```

左侧数据集*不是*线性可分的（不使用内核）。右边的一个可`A' and`通过指示线分为 B` 的两部分。

即你不能在左边的图像中**画一条直线*，***所以所有的`X`都在一侧，而所有的`O`都在另一侧。这就是为什么它被称为“不可线性分离”==不存在将两个类分开的线性流形。

现在著名的[核技巧](https://en.wikipedia.org/wiki/Kernel_trick)（肯定会在下一本书中讨论）实际上允许许多线性方法用于非线性问题，方法是通过虚拟添加额外的维度来使非线性问题线性可分。

# java - Spring项目junit测试。如何测试 Jboss JNDI 数据源？

> ID：13976566
> 
> 赞同：2
> 
> 时间：2012-12-20T16:34:12.780
> 
> 标签：java, spring, maven, jboss, junit

我正在从事一些使用 C3P0 进行数据库池的春季项目。

我的公司正在迁移到 JBoss，我们将使用 JBoss JNDI 数据源。但是如何设置我的 XML 文件以便我仍然可以运行我的 JUnit 测试？

我将我的数据库 xml 更改为具有以下几行：

```
<jee:jndi-lookup id="os400dataSource" jndi-name="java:jboss/datasources/as400"
        expected-type="javax.sql.DataSource" /> 
```

并且该项目在 JBoss AS7 中运行良好，但是要使用 maven 进行构建并运行 junit 测试，我无法让它在 jboss 中访问数据源？

我现在在 junit 测试中收到以下错误：

```
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'os400dataSource': Invocation of init method failed; nested exception is javax.naming.NoInitialContextException: Need to specify class name in environment or system property, or as an applet parameter, or in an application resource file:  java.naming.factory.initial
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1455)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:587)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:925)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:472)
    at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:103)
    at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:1)
    at org.springframework.test.context.support.DelegatingSmartContextLoader.loadContext(DelegatingSmartContextLoader.java:228)
    at org.springframework.test.context.TestContext.loadApplicationContext(TestContext.java:124)
    at org.springframework.test.context.TestContext.getApplicationContext(TestContext.java:148)
    ... 24 more
Caused by: javax.naming.NoInitialContextException: Need to specify class name in environment or system property, or as an applet parameter, or in an application resource file:  java.naming.factory.initial
    at javax.naming.spi.NamingManager.getInitialContext(NamingManager.java:662)
    at javax.naming.InitialContext.getDefaultInitCtx(InitialContext.java:307)
    at javax.naming.InitialContext.getURLOrDefaultInitCtx(InitialContext.java:344)
    at javax.naming.InitialContext.lookup(InitialContext.java:411)
    at org.springframework.jndi.JndiTemplate$1.doInContext(JndiTemplate.java:154)
    at org.springframework.jndi.JndiTemplate.execute(JndiTemplate.java:87)
    at org.springframework.jndi.JndiTemplate.lookup(JndiTemplate.java:152)
    at org.springframework.jndi.JndiTemplate.lookup(JndiTemplate.java:178)
    at org.springframework.jndi.JndiLocatorSupport.lookup(JndiLocatorSupport.java:95)
    at org.springframework.jndi.JndiObjectLocator.lookup(JndiObjectLocator.java:105)
    at org.springframework.jndi.JndiObjectFactoryBean.lookupWithFallback(JndiObjectFactoryBean.java:201)
    at org.springframework.jndi.JndiObjectFactoryBean.afterPropertiesSet(JndiObjectFactoryBean.java:187)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)
    ... 38 more 
```

# php - Nusoap，在 Web 服务中以 XML 形式返回数据数组

> ID：13976574
> 
> 赞同：0
> 
> 时间：2012-12-20T16:34:55.560
> 
> 标签：php, xml, soap, nusoap

我有一个 PHP 肥皂服务器（使用 nuSoap）和一个 Java 客户端（使用 Axis2）。效果很好，直到没有。

我要做的事情的要点是将代码发送到服务，并返回文件名的 XML 列表。

```
<filename>20120413.zip</filename> 
```

这里是 SSCE

```
<?
require_once('nusoap/lib/nusoap.php'); 
$server = new soap_server();
$server->configureWSDL('Download Database Backup', 'urn:downloadDatabase');

$server->register('getBackupFileNames',                                  // method
        array('herdCode' => 'xsd:string'), // input parameters
        array('fileList' => 'xsd:string'),                           // output parameters
        'urn:uploadDatabase',                                               // namespace
        'urn:uploadDatabase#uploadDatabase',                                       // soapaction
        'rpc',                                                       // style
        'encoded',                                                   // use
        'uploadDatabase'                                          // documentation
    );

 function getBackupFileNames($herdCode)
    {
    $location = "/home/rhythms/backups/" . $herdCode;
    $fileList = scandir($location);
    return $fileList;
    }//end function

$HTTP_RAW_POST_DATA = isset($HTTP_RAW_POST_DATA) ? $HTTP_RAW_POST_DATA : '';
$server->service($HTTP_RAW_POST_DATA);
?> 
```

在紧要关头，我知道我可以做一个 foreach 并手动将 XML 创建为字符串。然而，它会得到 XMLEncoded。有没有更好的办法？我想默认在 WSDL 中发布它。我也尝试过 complexType，但在 Axis2 端处理它时遇到了麻烦。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T21:13:51.807

这不是一个直接的答案。我的意思是您可以使用 SOAP-ARRAY 复杂数据类型发送一个 SOAP 数组。但这不是一个很好的方法。相反，我将研究 PHP 提供的本机 SOAP 实现。

Axis2 doesn't handle the SOAP-ARRAY complex datatype well, so I think it will be easier to adjust my implementation to PHP's native types.

This is left as a footnote so hopefully someone else won't fall down the same well I did as I was trying to find a good SOAP implementation.

# haskell - 在 Fay 中包含文件/目录的正确方法是什么？

> ID：13976578
> 
> 赞同：6
> 
> 时间：2012-12-20T16:35:15.027
> 
> 标签：haskell, fay

我正在尝试使用 Fay 将 haskell 编译为 JS，并在`--include`选项之后使用一个目录，如下所示：

`fay --include src\Tmv src\Tmv\Client\Main.hs`

在 src\Tmv 中有一个 SharedTypes.hs 文件，它定义了一个`Tmv.SharedTypes`在 Client\Main.hs 中使用的模块。我收到以下错误：

```
Could not find module "Tmv.SharedTypes". Use -v to see a list of files searched for. 
```

-v 选项不起作用。我已经尝试了参数的几种变体，例如。绝对路径、引号、转义（双）反斜杠。
配置：fay 0.10.1.0、ghc 7.4.2 (i386)、Windows 7 x64

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T21:09:25.533

将其从评论中移出，因为它显然解决了问题：

当 GHC 查找源文件时，通常它希望在子目录`Foo.Bar`中找到一个模块，相对于它开始的任何“根”目录。例如，如果您以当前目录启动 GHCi，您将遇到模块找不到的问题，或者由于模块名称与 GHC 期望的不匹配而导致错误。`Bar.hs``Foo``Foo``Bar`

由于在您的情况下似乎在使用相同的规则，因此要导入`Tmv.SharedTypes`您希望`SharedTypes.hs`位于`Tmv`任何基本路径的子目录中，因此创建另一个`Tmv`子目录或`src`单独指定 for`--include`应该可以工作。

# c# - 存储每台机器应用程序文件 (xml) 的目录，以便我的所有用户（使用应用程序）可以读取/写入它

> ID：13976579
> 
> 赞同：0
> 
> 时间：2012-12-20T16:35:17.153
> 
> 标签：c#, .net, windows, programdata

我在多个论坛上经历了许多讨论，人们在讨论如何使用 CommonAppDataFolder 来存储每台机器的文件。

我的应用程序有一个要求，我需要存储一个`XML`文件是一个共享位置，这样运行我的应用程序的所有用户都可以读/写该文件。

我了解`CommonAppDataFolder`（`C:\ProgramData`对于 Windows 7）允许管理员具有读取权限，但不允许标准用户写入文件。

我遇到的解决方案之一是更改应用程序文件夹的权限`CommonAppDataFolder`以允许所有用户读/写。

这是实现我的要求的最佳方式还是微软建议的更好方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:36:55.827

我建议你使用：`Environment.SpecialFolder.CommonDocuments`。

# android - 无法在方向更改时获取 tabHost 对象

> ID：13976581
> 
> 赞同：0
> 
> 时间：2012-12-20T16:35:28.253
> 
> 标签：android, android-tabhost, android-orientation, android-tabs, android-tabactivity

我正在尝试在应用程序中实现方向功能。该应用程序基本上由选项卡组成，使用 TabHost。每个选项卡都是一个包含一些活动的活动组。每个子活动都使用 AsyncTask 运行一个后台任务，以提取服务器数据并呈现 UI。

例如，

```
HomeActivity- tab activity class that creates all the tabs
UserActivity- an activity group class representing a tab (say Tab 1)
TabOne- child activity inside UserActivity group 
```

成功登录后，用户很快就会看到 Tab 1。当我尝试为此选项卡设置方向功能时，问题就开始了。在活动（TabOne）中，我添加了以下内容

```
@Override
public void onSaveInstanceState(Bundle outState) {
  System.out.println("saving state..!");
  outState.putStringArray("imageUrls", imageArray);
  super.onSaveInstanceState(outState);
}

@Override
public void onRestoreInstanceState(Bundle savedInstanceState) {
  System.out.println("restoring state..!");
  imageArray = savedInstanceState.getStringArray("imageUrls");
  super.onRestoreInstanceState(savedInstanceState); 
```

}

我能够获得“imageUrls”状态。但是，后来，我无法访问静态选项卡主机变量。

```
 HomeActivity.tabHost.getTabWidget().getChildAt(1) 
```

tabHost 变量为空！我没有保存它的任何状态。我怎么可能保存 tabHost 实例？

在研究其他社区帖子时，我发现了“onRetainNonConfigurationInstance()”。我实现了同样的。

```
 public Object onRetainNonConfigurationInstance() {
   System.out.println("retaining state..!");
   return HomeActivity.tabHost;
 } 
```

但是这个对象返回为空。任何人都可以引导我完成使用 tabHost 处理应用程序方向更改的步骤吗？

问我是否发现任何令人困惑的地方。

提前致谢！

已解决：将 screenSize 添加到清单中的活动标记修复了该问题。

```
<activity android:name=".HomeActivity"
          android:configChanges="orientation|screenSize"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T16:38:59.673

您可以添加参数

```
android:configChanges="orientation" 
```

您在清单中的活动。我认为它可以满足您的需求。它应该看起来像：

```
<activity
        android:name="com.your.package.YourActivity"
        android:configChanges="orientation"
</activity> 
```

# java - WCF与java客户端的双重通信

> ID：13976585
> 
> 赞同：1
> 
> 时间：2012-12-20T16:35:41.540
> 
> 标签：java, wcf, nettcpbinding, wsdualhttpbinding

我必须找到一种将 WCF 服务连接到 Java 客户端的方法。我无法更改 WCF 服务的代码，它只提供 NetTcpBinding 或 wsDualHttpBinding

一种解决方法是创建一个 C# 通信通道来管理服务和客户端之间的通信。但是我没有使用 C# 的经验，我相信这需要很长时间。

处理这个问题的最佳方法是什么？是否有任何可用的沟通渠道并已经提供？

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T14:05:11.630

您遇到的问题是所提供的绑定都不支持非 wcf 客户端。

如果没有您所说的在两者之间放置中介服务，我看不出有任何方式可以与此服务进行通信。

**完美**的候选者是[WCF 路由协议桥接](http://msdn.microsoft.com/en-us/vs2010trainingcourse_whatsnewinwcf4_topic17.aspx)- 这正是它听起来的样子 - 将一个协议转换为另一个协议。在这种情况下，您不是在协议之间而是在 WCF 绑定之间切换。

您的解决方案必须使用`basicHttpBinding`WCF 附带的并通过soap 1.1 公开服务。

# android - apk 和性能

> ID：13976587
> 
> 赞同：-1
> 
> 时间：2012-12-20T16:35:55.953
> 
> 标签：android

在我开发了我的应用程序之后，我尝试运行我的`apk`一切工作正常，然后我去`setting`截取一些截图`application`给你看

看看图片就知道我在做什么 ![http://im27.gulfup.com/daf61.png](../Images/30aad123cafeef3f5b880f6294c89e9c.png)

我想帮助我准确了解这个屏幕给我的信息以及如何使用它。

知道我用`android`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T16:52:36.190

该屏幕告诉您应用程序在设备上消耗了多少内存。这是用户必须从他的设备内存中分配多少空间（可能是 8GB、16GB 或更多，具体取决于手机）。

这分为几种方式，告诉您应用程序占用了多少空间，以及有多少数据（可以单独存储 - 并且可以从应用程序中清除，也可以由用户清除）。

不要忘记标记为正确。

# python - 固定长度数据字段和可变长度 utf-8 编码

> ID：13976588
> 
> 赞同：3
> 
> 时间：2012-12-20T16:35:57.763
> 
> 标签：python, encoding, utf-8, character-encoding, byte

我有一个 Python 项目，其中我在一个包含 utf-8 编码、NULL 填充、NULL 终止字符串的通信协议中 有一个固定**字节长度的**文本字段（NOT FIXED **CHAR-LENGTH FIELD）。**

我需要确保字符串适合固定的字节长度字段。由于 utf-8 是一种可变宽度编码，这使得使用蛮力以固定字节长度截断字符串是有风险的，因为您可能会在末尾留下部分多字节字符悬空。

是否有模块/方法/函数/等可以帮助我将 utf-8 可变宽度编码字符串截断为固定字节长度？

做空填充和终止的东西将是一个奖励。

这似乎是一个已经被破解的坚果。如果它已经存在，我不想重新发明它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T17:23:09.243

让 Python 检测并消除任何部分或无效字符。

```
byte_str = uni_str.encode('utf-8')
byte_str = byte_str[:size].decode('utf-8', 'ignore').encode('utf-8') 
```

这是因为 UTF-8 规范在字符的第一个字节中对后续字节数进行编码，因此可以轻松检测到丢失的字节。

编辑：这是此代码使用我从另一个问题中提取的随机东方字符串的结果。第一个数字是最大大小，第二个是 UTF-8 字符串中的实际字节数。

```
45 45 具有靜電產生裝置之影像輸入裝置
44 42 具有靜電產生裝置之影像輸入裝
43 42 具有靜電產生裝置之影像輸入裝
42 42 具有靜電產生裝置之影像輸入裝
41 39 具有靜電產生裝置之影像輸入
40 39 具有靜電產生裝置之影像輸入
39 39 具有靜電產生裝置之影像輸入
38 36 具有靜電產生裝置之影像輸
37 36 具有靜電產生裝置之影像輸
36 36 具有靜電產生裝置之影像輸
35 33 具有靜電產生裝置之影像
34 33 具有靜電產生裝置之影像
33 33 具有靜電產生裝置之影像
32 30 具有靜電產生裝置之影
31 30 具有靜電產生裝置之影 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-20T16:49:51.970

在 UTF-8 流中很容易看出给定字节是否位于给定字符字节流的开头（或不在）。如果字节是形式`10xxxxxx`那么它是字符的非初始字节，如果字节是形式`0xxxxxx`它是单字节字符，其他字节是多字节字符的初始字节。

因此，您可以轻松构建自己的功能。只需确保您添加到字段中的最后一个字符是 form `0xxxxxx`，或者是`10xxxxxx`下一个字符（您没有添加）不是 form 的 form `10xxxxxx`。即，确保您刚刚添加了一个单字节 UTF-8 字符或多字节 UTF-8 字符的最后一个字节。然后，您可以添加`0`s 来填写您的字段的其余部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T16:55:47.820

```
def fit(s, l):
    u = s.decode("utf8")
    while True:
        if len(s) <= l:
            return s + "\0" * (l - len(s))
        u = u[:-1]
        s = u.encode("utf8") 
```

应该是关于你需要的东西。也许你必须改进它；它未经测试。

* * *

我进行了编辑，因为我不小心用 C 语言回答了。我将算法更改为不是那么理想的算法，但更容易理解。

# php - PHP动态链接列表打破了ajax

> ID：13976589
> 
> 赞同：2
> 
> 时间：2012-12-20T16:35:58.043
> 
> 标签：php, jquery, ajax, laravel

我有这个从数组生成的事物列表，其中数组值映射到数组键，数组键映射到数据库中的查询。现在我面临的问题是，当这个列表包含在我的 ajax 部分中时，它只能在页面刷新之前单击一次。是什么赋予了？

我正在使用 HTML5 History API 方法在点击链接的 href="" 部分时更改 url。我对 jQuery 有点陌生，这很奇怪，因为我主要是前端开发人员，但我从来没有时间赶上，但是我的链接列表破坏了这段代码对我来说没有意义。

```
$("a[rel='ajax']").click(function(e){
    //e.preventDefault();

    pageurl = $(this).attr('href');

    $.ajax({url:pageurl+'?rel=ajax',success: function(data){
        $('#ajax')
        .load(pageurl + ' #resultati');
    }});

    if(pageurl!=window.location){
        window.history.pushState({path:pageurl},'',pageurl);
    }
    return false;
}); 
```

链接是在 PHP 中使用此函数生成的，如果这有什么不同，我将使用 laravel 框架。

```
public static function filterlink ($filter, $what)
{
    if (URI::segment(2) == 'make')
    {
        $first = URI::segment(3);
        $next = URI::segment(4);
    }
    else
    {
        $first = URI::segment(2);
        $next = URI::segment(3);
    }

    // what == 0 is the filter, what == 1 is the +filter. This reffers to the link being created.
    switch (substr($first, 0, 1))
    {
        case ' ': // example.ex/make/[+]current starts with a plus sign.
            if($what == 0)
                //new no+ filter.
            {
                return HTML::link('make/'.self::slug($filter.'/'.$first), $filter, array('rel' => 'ajax')); 
                // example.ex/make/+current => example.ex/make/newfilter/+current 
            } 
            elseif($what == 1) 
                //new +filter
            {
                return HTML::link('make/+'.self::slug($filter), $filter, array('rel' => 'ajax')); 
                // example.ex/make/+current+replaced+by+newfilter
            }
        break;

        default: 
            if($what == 0) 
            // new no+ filter.
            {
                if(!empty($next))
                {
                    return HTML::link('make/'.self::slug($filter.'/'.$next), $filter, array('rel' => 'ajax'));
                }
                else
                {
                    return HTML::link('make/'.self::slug($filter), $filter, array('rel' => 'ajax'));
                }
            }
            elseif($what == 1 && (!empty($first)))
            {
                return HTML::link('make/'.self::slug($first.'/+'.$filter), $filter, array('rel' => 'ajax'));
            }
            elseif($what == 1 && (empty($first)))
            {
                return HTML::link('make/+'.self::slug($filter), $filter, array('rel' => 'ajax'));
            }

        }
    } 
```

我已经尝试将我的链接列表放在 ajax 字段之外，这样可以保持 ajax 流程没有任何无聊的页面刷新，但我的链接 url 显然不会更新，而且我只能构建单端链接，打破页面双重过滤功能。

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T17:18:59.747

如果您实际上正在加载带有 AJAX 友好链接的 HTML 内容，那么您需要使用 .on 以便新链接也被您的 jQuery 函数接管。

```
$(document).on('click',"a[rel='ajax']",function(e) { 
```

这里的工作样本：

[http://jsfiddle.net/hansvedo/cJW54/](http://jsfiddle.net/hansvedo/cJW54/)

* * *

快速思考一下，将 preventDefault 放在 pushState 函数的位置怎么样？或者甚至只是取消注释它在哪里？preventDefault 防止发生正常的链接操作。

```
if(pageurl!=window.location){
    e.preventDefault();
    window.history.pushState({path:pageurl},'',pageurl);
} 
```

# c# - 找不到“schemaLocation”属性

> ID：13976591
> 
> 赞同：1
> 
> 时间：2012-12-20T16:36:34.863
> 
> 标签：c#, .net, xml, xsd, xml-validation

我正在创建一个模式来验证一些 XML，但是当它归结为实际读取文档时，我得到了错误：

`The 'http://www.w3.org/2001/XMLSchema:schemaLocation' attribute is not declared.`

这就是使用该模式的 XML 文件的开头的样子。

```
<?xml version="1.0"?>
<envelope xsi:schemaLocation="C:\LocalPath MySchema.xsd" 
 xmlns:xsi="http://www.w3.org/2001/XMLSchema" 
 xmlns="http://tempuri.org/MySchema.xsd">
...
</envelope> 
```

我的验证代码如下所示：

```
XmlReaderSettings settings = new XmlReaderSettings();
settings.ValidationType = ValidationType.Schema;
Settings.Schemas.Add(@"http://tempuri.org/MySchema.xsd",
@"C:\LocalPath\ MySchema.xsd");
XmlReader reader = XmlReader.Create(@"C:\LocalPath\testxml\somefile.xml", settings);
xmlDoc.Load(reader);

ValidationEventHandler eventHander = new ValidationEventHandler(validationHandler);

xmlDoc.Validate(eventHander); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T18:02:32.680

命名空间[http://www.w3.org/2001/XMLSchema](http://www.w3.org/2001/XMLSchema)（带有常规前缀`xsd`or `xs`）用于模式文档；您想要的`schemaLocation`属性位于命名空间[http://www.w3.org/2001/XMLSchema-instance](http://www.w3.org/2001/XMLSchema-instance)`xsi` （它具有“XML Schema *Instance* namespace”的常规前缀）。

# php - Joomla 链接到类别列表

> ID：13976593
> 
> 赞同：0
> 
> 时间：2012-12-20T16:36:42.773
> 
> 标签：php, joomla, joomla2.5

大家好，我在使用 Joomla 时遇到了问题。

有一个自定义的 html 模块，里面有链接。链接转到菜单项，即类别列表。一旦我明白了，我必须从菜单项的链接属性中复制以下代码并将其粘贴到 href 中。

```
index.php?option=com_content&view=category&id=12 
```

但它不是这样工作的。出现 404 错误页面。

如何使此链接正常工作？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:44:00.760

创建一个链接到类别列表的菜单项，然后在前端预览它时，右键单击菜单项并单击“复制链接位置”。然后将链接粘贴到中`href=""`并删除该`http://example.com`位，使其以`index.php?com_content......`

我之所以这么说是因为您使用的网址一定不正确。

希望这可以帮助。

# c# - 包含 SQL 的电子邮件

> ID：13976596
> 
> 赞同：1
> 
> 时间：2012-12-20T16:36:52.010
> 
> 标签：c#, .net, sql, database, visual-studio

我有一个名为“lnkupdate_click”的按钮，基本上它在您单击时所做的就是访问一个名为“tbl_security”的表，然后它会使用随机的 4 位数字更新字段“pass”，其中字段“patrol”= 1 或 true .

一个例子如下所示;

```
Code    Pass   Patrol
TES     1234        1
ASD     4321        1
MOR     6789        1
SAI     0959        1 
```

我坚持的一点是：我希望它从这里做的就是通过电子邮件从数据库中发送更新的信息。因此，基本上是为我生成一封包含上表中所有信息的电子邮件。但是，我的“foreach”循环下方不断出现一条红线，并带有此错误消息。

“foreach 语句不能对 'int' 类型的变量进行操作，因为 'int' 不包含 'GetEnumerator' 的公共定义”

我的代码如下：

```
protected void lnkUpdate_Click(object sender, EventArgs e)
   {

        {
            string queryUpdateAllFields;
            string queryGetAllUpdatedField;
            StringBuilder sb = new StringBuilder();

            queryGetAllUpdatedField = @"update tbl_Security set
                                      Pass = round(rand(CAST(CAST(NEWID() AS VARBINARY(4)) AS SMALLINT))* 9000,0) + 1000
                                      WHERE Patrol = 1";

            queryGetAllUpdatedField = @"SELECT Code, Pass, Patrol 
                                        FROM tbl_Security
                                        WHERE Patrol = 1";

            var random = new Random();

            //queries to update and retrieve
            SqlHelper.ExecuteSqlNonQuery(queryUpdateAllFields);

            var results = SqlHelper.ExecuteSqlNonQuery(queryGetAllUpdatedField);

            //loop over the results and append to StringBuilder instance.
            sb.Append("Below are all the fields that have been updated: <br /><br />");

            foreach(var r in results)
            {
                sb.AppendLine("<hr />");
                sb.AppendLine("Code: " + r.Code + " Pass: " + r.Pass + " Patrol: " + r.Patrol); //for Patrol
            }   

       //Email showing all updated pass's with codes
            MailAddress to = new MailAddress("");
            MailAddress from = new MailAddress("");
            MailMessage message = new MailMessage(from, to);
            message.Subject = "Subject Line Here";
            message.Body = sb.ToString(); //attach StringBuilder - This will be built up of all the rows updated in the DataBase

         SmtpClient mailClient = new SmtpClient();
            mailClient.Port = 25;

            //finally send message here
            mailClient.Send(msg);

      }
  } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-20T16:40:56.420

[ExecuteSqlNonQuery](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executenonquery.aspx)返回一个`int`不是我认为您假设的集合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T19:20:00.187

尝试：像这样改变循环：`for(int i= 0; i < results; i++)`

# jquery - 如何通过鼠标悬停在另一个映射图像区域上来显示小图像和段落？

> ID：13976601
> 
> 赞同：0
> 
> 时间：2012-12-20T16:37:10.607
> 
> 标签：jquery, html, css, hover, imagemap

这将比我的话更好地解释我想要的：http: [//jquery-image-map.ssdtutorials.com/](http://jquery-image-map.ssdtutorials.com/) 尽管该教程可用，但它是使用 Photoshop 中的图像叠加完成的。但我正在使用 jquery 插件“jquery.maphilight.js”突出显示我的映射图像。使用它我有一个映射的图像，如果我将鼠标悬停在图像上，它会突出显示映射的部分。如果有人将鼠标悬停在特定房间（映射部分）上，我如何显示小图片和段落。

这是javascript：

```
 $(function () {
        $(".mapping").maphilight();
        $("#mapping").css('visibility','hidden')

    $(".hoverable").css("border", "3px solid red"); 
```

&这是图像映射的html：

```
<div class="mapping"> 
<map name="gmap">
<area shape="poly" id="cr1" coords="550,277,485,342,533,385,597,322" href="#" alt="cr1" name="room-1">
<area shape="poly" id="cr2"coords="579,246,627,200,672,246,624,290" href="#" alt="cr2" name="room-2"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T16:46:50.670

使用[jQuery 鼠标悬停](http://api.jquery.com/mouseover/)事件。

您可以将其附加到准备好的文档上的“区域”标签上。

```
$(document).ready(function(){
    //this selector is selecting an element by the id of cr1.
    $('#cr1').on('mouseover', function(){
        //do your showing here
    });

    $('#cr1').on('mouseleave', function(){
        //do your hiding here
    });
}); 
```

对于通用处理程序，您可以这样做：

```
$(document).ready(function(){
    //this is an attribute selector.
    //'area' is the typ of tag to match
    //[name indicates the attribute is named 'name'
    //^= indicates the attribute 'name' should start with the value following this operator
    //'room'] think of this as indicating the value of the name attribute
    // should match: 'room*'
    $('area[name^="room"]').on('mouseover', function(){
        //do your showing here, be sure to show only 
        //for the appropriate area. Maybe select on the id.
    });

    $('area[name^="room"]').on('mouseleave', function(){
        //do your hiding here. This could be generic unless you have
        //a multi-paragrah area instead of a single display area.
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T11:53:16.613

这是我为使其工作所做的：我创建了一个具有“mouseover”和“mouseleave”属性的 div。在其中我收到了另一个元素的 id，当我将鼠标悬停在这个 div 上时，我想出现这个元素。

```
<div  
    onmouseover="document.getElementById('div1').style.display = 'block';"  <!-- element inside brackets will be shown-->
    onmouseout="document.getElementById('div1').style.display = 'none';"> 
<area shape="poly" id="cr1" class="jTip" coords="550,277,485,342,533,385,597,322"
href="car_park_1.html" alt="cr1" name="room-1">
</div> 
```

我发布了自己的答案，以便它也可以帮助其他人做同样的任务:)

# highcharts - 如何根据我的 json 结果数据设置 xaxis 标签？

> ID：13976602
> 
> 赞同：0
> 
> 时间：2012-12-20T16:37:10.763
> 
> 标签：highcharts

**你好。我有这个 json 结果：**

```
([{"total": 2797, "date": "13.12"}, {"total": 3252, "date": "14.12"}, {"total": 771, "date": "15.12"}, {"total": 669, "date": "16.12"}, {"total": 2962, "date": "17.12"}, {"total": 1, "date": "19.12"}]) 
```

我想在我的 xaxis 标签上设置日期值，但我不能这样做。帮助？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:14:15.257

如果所有系列点都将以一天为增量，并且您希望 xAxis 日期格式为 day.Month，您可以使用以下`Date.UTC`方法执行以下操作：

```
Date.UTC(year,month,day,hours,minutes,seconds,millisec) 
```

、`year`和都是必需的`month`。`day`因此，您也需要获得该值。请注意，月份从 0 开始到 11。

然后，您的 HighCharts 格式的数据将如下所示：

```
[Date.UTC(2012, 11, 13), 2797], [Date.UTC(2012, 11, 14), 3252], [Date.UTC(2012, 11, 15), 771], [Date.UTC(2012, 11, 16), 669], [Date.UTC(2012, 11, 17), 2962], [Date.UTC(2012, 11, 18), null], [Date.UTC(2012, 11, 19), 1] 
```

为了让您的图表清晰地绘制，您还需要为 12.18 设置一个您目前不这样做的值。我将其设置为`null`. 此图表不会在空点之间画线，但您可以使用[`connectNulls`](http://api.highcharts.com/highcharts#plotOptions.area.connectNulls). 如果要连接空值，请将其设置为 true。默认设置为 false。

现在您想要格式化您的 xAxis 以显示日期，例如“13.12”。您可以使用[`formatter`](http://api.highcharts.com/highcharts#xAxis.labels.formatter)属性执行此操作。要获取您的格式，请使用`'%d.%m'`. [此处](http://php.net/manual/en/function.strftime.php)列出了日期格式选项。

如何将数据转换为 HighCharts 格式取决于您的来源。有多种方法。

[**演示**](http://jsfiddle.net/wergeld/Nh2J4/)

# wcf - WCF Web 服务 xml 序列化 [XmlAttributeAttribute()] 被忽略

> ID：13976605
> 
> 赞同：2
> 
> 时间：2012-12-20T16:37:22.540
> 
> 标签：wcf, web-services, xsd, xml-attribute

我有一个使用 VS2010 针对 .Net Framework 4 开发的 WCF Web 服务，它利用使用 xsd.exe 从 xsd 模式生成的序列化类。

当我从服务 (http://localhost:59120/Service1.svc?xsd=xsd2) 请求 xsd 时，元素属性被忽略。下面的架构片段中的 EG -

```
<xs:element name="id"...> 
```

应该是一个属性 -

```
<xs:attribute name="id"...> 
```

来自 xsd 请求的片段 -

```
...
<xs:sequence>
 <xs:element name="address" type="xs:string" nillable="true"/>
 <xs:element name="emailId" type="xs:string" nillable="true"/>
<xs:element name="id" type="xs:string" nillable="true"/>
 <xs:element name="items" type="tns:ArrayOfArrayOfOrdersCustomerItemsItem" nillable="true"/>
 <xs:element name="name" type="xs:string" nillable="true"/>
 </xs:sequence>
... 
```

由于某种原因，我的类中的语句“[XmlAttributeAttribute()]”被忽略了，我尝试将其更改为 [XmlAttribute()] 和 [XmlAttributeAttribute("Id")] 并完全删除该行，但在全部。

```
 /// <remarks/>
    [System.CodeDom.Compiler.GeneratedCodeAttribute("xsd", "4.0.30319.1")]
    [System.SerializableAttribute()]
    [System.Diagnostics.DebuggerStepThroughAttribute()]
    [System.ComponentModel.DesignerCategoryAttribute("code")]
    [XmlTypeAttribute(AnonymousType = true)]
    public partial class OrdersCustomer
    {

        /// <remarks/>
        [XmlElementAttribute(Form = System.Xml.Schema.XmlSchemaForm.Unqualified, Order = 0)]
        public string Name;

        /// <remarks/>
        [XmlElementAttribute(Form = System.Xml.Schema.XmlSchemaForm.Unqualified, Order = 1)]
        public string Address;

        /// <remarks/>
        [XmlElementAttribute(Form = System.Xml.Schema.XmlSchemaForm.Unqualified, Order = 2)]
        public string EmailId;

        /// <remarks/>
        [XmlArrayAttribute(Form = System.Xml.Schema.XmlSchemaForm.Unqualified, Order = 3)]
        [XmlArrayItemAttribute("Item", typeof(OrdersCustomerItemsItem), Form = System.Xml.Schema.XmlSchemaForm.Unqualified, IsNullable = false)]
        public OrdersCustomerItemsItem[][] Items;

        /// <remarks/>
        [XmlAttributeAttribute()]
        public string Id;
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T17:02:02.887

确保您的`[ServiceContract]`界面具有该`[XmlSerializerFormat]`属性。如果这不存在，则 WCF 将使用`DataContractSerializer`，并且您的所有`XmlSerializer`属性都将被忽略。

# ios - 这是内存崩溃吗？NSZombies 没有抓住它

> ID：13976612
> 
> 赞同：0
> 
> 时间：2012-12-20T16:37:41.480
> 
> 标签：ios, memory

这**绝对**是内存崩溃，还是我应该寻找其他东西？

```
Exception Type:  EXC_BAD_ACCESS (SIGSEGV)
Exception Codes: KERN_INVALID_ADDRESS at 0x81093cd0
Crashed Thread:  0

Thread 0 name:  Dispatch queue: com.apple.main-thread
Thread 0 Crashed:
0   libobjc.A.dylib                 0x33563f78 objc_msgSend + 16
1   Foundation                      0x34d6b92c __NSFireDelayedPerform + 408
2   CoreFoundation                  0x35919a2c __CFRUNLOOP_IS_CALLING_OUT_TO_A_TIMER_CALLBACK_FUNCTION__ + 8
3   CoreFoundation                  0x35919692 __CFRunLoopDoTimer + 358
4   CoreFoundation                  0x35918268 __CFRunLoopRun + 1200
5   CoreFoundation                  0x3589b49e CFRunLoopRunSpecific + 294
6   CoreFoundation                  0x3589b366 CFRunLoopRunInMode + 98
7   GraphicsServices                0x33636432 GSEventRunModal + 130
8   UIKit                           0x33073cce UIApplicationMain + 1074 
```

使用分析器，实时字节在任何时候都远低于 10MB，当内存警告发生时，我会回到 3MB 或更低。

此语句返回 YES，所以我假设我启用了僵尸：

```
getenv("NSZombieEnabled") || getenv("NSAutoreleaseFreedObjectCheckEnabled") 
```

当我从 Xcode 运行时，应用程序在 Xcode 没有意识到的情况下崩溃（在任意数量的内存警告之后）。

除了“在启用 NSZombies 的情况下运行”之外还有什么建议吗？而且，这绝对是内存崩溃吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T16:48:25.370

SIGSEGV 发生在代码尝试访问“不存在”的内存时（即，您尝试使用的地址在您的虚拟地址空间中没有映射）。

造成这种情况的确切原因可能有很多——最常见的是：

*   使用未（正确）初始化的指针。
*   走出阵列的尽头。
*   使用已释放的内存。

请注意，以上所有内容都是“未定义行为”的示例，因此您可能会遇到这样的情况，即您的代码虽然做错了但不会崩溃，但相同的代码在其他情况下确实会出错。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T16:40:58.463

是的，这是与内存相关的错误（分段错误）。请记住，`NSZombies`无法捕获每个内存错误。

# delphi - 德尔福：缺少 Dcu

> ID：13976616
> 
> 赞同：9
> 
> 时间：2012-12-20T16:38:02.283
> 
> 标签：delphi

> [DCC 致命错误] Unit1.pas(7): F1026 File not found: 'MyBitBtn.dcu'

Unit1 是用于测试目的的 VCL 表单。

我已经安装了一个设计时包，其中包含一个从 TBitBtn 派生的自定义组件。我可以在 Delphi IDE 中加载 MyBitBtn，加载我在设计时编写的自定义图像，看起来效果很好，至少在视觉上是这样。当我尝试编译测试项目时，出现上述编译时错误。

我有一个包组，它有一个设计时包和一个运行时包。设计时包注册组件，运行时包继承 TBitBtn 并在其中包含自定义代码。**设计时包在 requires 部分中包含 RunTime DCP 文件**。

当我在测试表单上插入自定义按钮时，IDE 会为 MyBitBtn 文件创建USES 子句。而且那个文件显然找不到。那不应该是安装包的一部分吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-20T16:49:15.470

很可能您没有在运行时包中设置“单元输出目录”选项，因此包 .dcu 不可用；我通常将其设置为`$(BDSCOMMONDIR)\Dcp`并且没有问题。

通常，如果您希望您的包可用于任何项目，则运行时包的 .dcu 应该可以通过全局 IDE 库路径获得：

![库路径](../Images/a1ede7e2f5a785f2f95870445931ec92.png).

您应该使用现有路径之一或添加自己的路径。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-20T16:52:11.390

设计部分有效，但对于运行时，编译器必须能够找到 dcu。你也可以这样做...

1.  通过将 dcu 文件夹添加到 IDE 的库路径。
2.  通过将 dcu 文件夹添加到项目的搜索路径。
3.  或者通过将 dcu 显式添加到项目中。

我会选择第一个选项。由于它是已安装的组件，因此您希望它可用于任何项目，因此设置库路径最有意义。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-20T16:40:58.523

定义此 dcu 在系统环境中的存储路径。并且不要忘记将它包含在 Delphi 环境路径中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-05T18:44:17.080

转到 ZEOS 文件，打开软件包，选择您的版本（DelphiXE10/Delphi7 ...）然后转到 Win 32 文件，打开它并打开 Debug 文件夹。复制所有内容，转到 Program Files、Embarcadero、Studio、17.0、lib、Win 32、调试和粘贴，在每个 win32 文件夹中执行相同操作...希望对您有所帮助 :)

# sql - MS-ACCESS数据库查询参数值相关问题

> ID：13976622
> 
> 赞同：0
> 
> 时间：2012-12-20T16:38:24.750
> 
> 标签：sql, database, ms-access

> **可能重复：**
> [与加入 MS Access 数据库相关的问题](https://stackoverflow.com/questions/13976336/isssue-related-to-join-in-ms-access-database)

我在 MS-Access 数据库文件中有一个数据库文件..

我有以下查询：

```
SELECT 
    (select count (*)
     from (select distinct prs_PersonId
           from tb_person
           where prs_personId = PR.prs_personId)) 
FROM tb_Person PR left outer join tb_personDepartment PD
        on PR.prs_PersonId = PD.pd_personId; 
```

每当我执行此查询时，我都会得到一个输入框，它要求输入 PR.prs_PersonId 的参数值为什么会发生这种情况？解决方案是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T17:34:10.917

你的查询真的很混乱。

如果你想知道人数`tb_person`，你为什么要加入`tb_personDepartment`？

在设计良好的数据库中，`prs_PersonId`必须是唯一的。要么是因为它是主键，要么是因为它具有唯一索引。因此，`DISTINCT`似乎是多余的。（我假设persons表与departments表是一对多关系的多方面。即：departements表用作查找表，您可以从中为每个人选择一个部门。）

如果您`prs_PersonId`在 WHERE 子句中指定 a ，则结果将始终为`0`或`1`。检索人数可以简化为

```
SELECT Count(*) As PersonCount
FROM tb_Person
WHERE ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T17:08:23.260

如果我没记错的话，Access 不能在子查询中使用子查询外部的值，所以：

```
SELECT 
    (select count (*) 
     from (
         select distinct prs_PersonId 
         from tb_person 
         where tb_person.prs_personId = 
            /* PR.prs_personId   is not valid here  */
            /* use a constant like */  1  /* just to test that this is the "missing" parametrer. Of course, it won't give correct results, but will run */
         )
     )  As ACount
from tb_Person PR 
left outer join tb_personDepartment PD
on PR.prs_PersonId = PD.pd_personId 
```

然后重新制定查询，可能类似于：

```
SELECT prs_PersonId, count(*) As ACount
FROM tb_person 
GROUP BY prs_PersonId 
```

# android - 如何在android的textview中显示双重格式的价格

> ID：13976624
> 
> 赞同：7
> 
> 时间：2012-12-20T16:38:26.720
> 
> 标签：android, string, textview

我想在 textView 中显示价格值，例如：Android 的 textview 中的 12,199.99。但我将值存储在双变量（12199.99）中。有没有办法以我想要的格式在 textview 中显示双精度？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-20T16:41:41.317

如果您想使用带有 2 位小数的手机区域设置对其进行格式化，请执行以下操作：

```
DecimalFormat decimalFormat = new DecimalFormat("#,##0.00");
String formattedValue = decimalFormat.format(yourDoubleValue);
yourTextView.setText(formattedValue); 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T16:42:20.810

`BigDecimal`例如，您可以使用 a

```
public static BigDecimal doubleToScale(double d, int scale){
        return new BigDecimal(d).setScale(scale, BigDecimal.ROUND_HALF_UP);
} 
```

我希望这会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T16:43:49.523

使用[String.format](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html)。更多关于格式化选项的文档可以在[这里](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Formatter.html)找到。

# python - 带有django项目的windows上的ropemacs非常慢

> ID：13976625
> 
> 赞同：0
> 
> 时间：2012-12-20T16:38:35.623
> 
> 标签：python, django, windows, emacs, ropemacs

在一个新创建的 Django 项目中，我使用ropemacs 来获得语义完成和重构功能。但似乎每次我输入一个触发完成列表检查的字符时，缓冲区都会冻结大约一秒钟，有时是两秒钟。

我听说在大型项目中，ropemacs 可能会很慢，但是一个新的 Django 项目在这方面被认为是大的吗？

我正在使用 YAS、绳索、自动完成和 python 模式（https://launchpad.net/python-mode）。在模式部分我有“Py Outl yas Rope AC”，不确定 Outl 来自哪里或它做了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T10:07:49.567

[https://bugs.launchpad.net/python-mode/+bug/1092841](https://bugs.launchpad.net/python-mode/+bug/1092841)

请关注这里，也许我们在深入研究时需要更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T08:23:26.867

使用[绝地](https://github.com/tkf/emacs-jedi)！

它比绳索更快，并且更好地理解您的 Python 代码。

愿原力与你同在！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T09:02:39.307

正如我在评论中所写和大卫所说，我求助于绝地武士。

# css - div 仅在 Chrome 中且仅在主页上获得额外的填充

> ID：13976630
> 
> 赞同：0
> 
> 时间：2012-12-20T16:38:46.920
> 
> 标签：css

我们有一个问题，只影响 Chrome、Firefox 和 IE 都可以。

Chrome 中唯一受影响的页面是主页 index.html ......所有其他页面都使用完全相同的标题 html 和 CSS。如果我们单击主页上的链接进入内部页面，该页面可以正常工作，然后我们单击返回主页，它看起来很好......但是如果我们刷新主页，它又会变得混乱。

这是网址

[http://www.logilityconnectionseurope.com](http://www.logilityconnectionseurope.com)

被下推的元素是一个很大的 div，右边有一个图像和一些文本，div CSS 如下

```
.dateLogoTopDiv  {
float:right;
text-align:right;
margin-top: 15px;
} 
```

HTML：

```
<div class="header">

    <img src="images/connections-europe-2013-logo-web.jpg" width="410" height="242" alt="connections europe 2013 logo" />

    <div class="dateLogoTopDiv">
        <img src="images/logility-logo.jpg" width="105" height="108" alt="logility logo" />
        <p>14-15 May 2013</p>
        <p>Hotel Le Plaza </p>
        <p>Brussels, Belgium</p>
     </div>

</div> 
```

正如我所说，在 Firefox 和 IE 中运行良好，并且在除索引之外的每个页面上都可以在 Chrome 中运行

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T16:48:25.913

通过 HTML Validator 运行您的页面并修复所有错误。如果没有有效的 HTML，浏览器就无法确定您打算显示什么，并且您将遇到跨浏览器呈现不一致的情况。在这种情况下，Webkit 浏览器（Chrome 和 Safari）。

[http://validator.w3.org/](http://validator.w3.org/check?uri=http://www.logilityconnectionseurope.com/index.html&charset=%28detect%20automatically%29&doctype=Inline&group=0)

**编辑：**

OP 的网站以前包含格式错误的 HTML，包括打开的标签和放错位置的标签。OP 的站点已被修复，导致问题中发布的 URL 上的代码已过时。

**编辑2：**

我在 Chrome 中看到了 OP 的问题。我无法解释为什么会出现这个问题或为什么它是间歇性的。但是，我通过*添加*以下内容来修复它...

**附加CSS：**

```
.header {
    overflow: auto;
}

.header > img {
    float: left;
} 
```

**现有的 HTML：**

```
<div class="header">

    <img src="images/connections-europe-2013-logo-web.jpg" width="410" height="242" alt="connections europe 2013 logo" />

    <div class="dateLogoTopDiv">
        <img src="images/logility-logo.jpg" width="105" height="108" alt="logility logo" />
        <p>14-15 May 2013</p>
        <p>Hotel Le Plaza </p>
        <p>Brussels, Belgium</p>
     </div>

</div> 
```

这需要两个主要的标题元素并将它们分别向左和向右浮动。右边的那个已经飘到右边了。 `overflow: auto;`是一种强制标题扩展以包含它的浮动元素的技巧。由于两者都是浮动的，它们在常规内容流*之外*，通常不会导致标题扩展。

# android - 回调通知区域中的“全部清除”按钮

> ID：13976634
> 
> 赞同：3
> 
> 时间：2012-12-20T16:39:10.060
> 
> 标签：android, notifications, google-cloud-messaging

我正在开发和 android 应用程序，我必须计算应用程序通过通知启动的次数。我的问题是我无法捕捉到用户从通知区域按下“清除按钮”的事件。有什么方法或回调可以知道何时按下清除按钮？

我已阅读有关 deleteIntent 的信息，但我不知道如何使用它。

先感谢您

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-18T10:23:06.047

创建一个删除意图

```
Intent deleteIntent = new Intent(context, NotificationReceiver.class);
deleteIntent.setAction("delete"); 
```

将其附加到您的通知中

```
notification.deleteIntent = PendingIntent.getBroadcast(context, 0, deleteIntent, 0); 
```

创建一个新类以获取删除意图

```
public class NotificationReceiver extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {
        Log.d("TEST", "Clear app processing here");
    }
} 
```

添加到您的清单文件

```
<receiver android:name=".NotificationReceiver" 
      android:enabled="true">
</receiver> 
```

# jquery - div内的div高度

> ID：13976635
> 
> 赞同：0
> 
> 时间：2012-12-20T16:39:15.257
> 
> 标签：jquery, html, css

我正在为我自己的数据网格开发一个 jquery 插件。我面临的问题是一个 div 在另一个 div 中的剪辑。我需要最后一个 div 来填充剩余空间，如果可能的话，我想在没有 js/jquery 的情况下计算高度。我什至不需要与 IE 或 firefox 兼容，只需要与 chrome 兼容。

这里是问题的演示：http: [//jsbin.com/ubiniy/1](http://jsbin.com/ubiniy/1)

如您所见，底部的滚动条是不可见的。92% 的高度在某些维度上可见，但在其他维度上不可见。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:49:33.280

只需`overflow:auto;`从中删除，`.dlgrid`您也可以删除填充或边距以使其达到边缘。

或者，如果您不想从中删除`overflow:auto;`，`.dlgrid`您可以制作

```
<div>Title</div>
<div>Title 2</div>

<div class="dlInnerDiv" style="overflow:auto; height:94%;"> 
```

到

```
<div style="height:3%;">Title</div>
<div style="height:3%;">Title 2</div>

<div class="dlInnerDiv" style="overflow:auto; height:94%;"> 
```

更多信息可能对[这里有帮助](http://www.alistapart.com/articles/holygrail)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T16:44:37.953

问题是它继承了您声明的父级高度，但标题还有 2 个 div，所以没有空间容纳所有人，因为它超过 100% 并且滚动:)

* * *

好的，这是一种方法：

但是，需要确保标题 div 只是一行，否则您最终会得到错误的计算。

如果是这样，你添加这个

```
 <div class="dlgrid" style="overflow: hidden;......height:700px;">

    <div class="title">Title</div>
    <div>Title 2</div>
    <div class="dlInnerDiv" style="overflow:auto;">.... 
```

CSS：

```
div.title{
  line-height:20px;
}
div.title + div{
  line-height:18px;
} 
```

或者

```
div.title{
   height:20px;
}
div.title + div{
   height:18px;
} 
```

在这种情况下，你有 700-20-18 = 662 或者你给它们的任何高度，所以剩下的就是：

```
div.dlInnerDiv{
    max-height:662px;
 } 
```

您还需要重置所有不需要的边距和填充，例如

```
div.dlgrid,div.dlgrid div{
   margin:0; 
   padding:0;
} 
```

或您想要的任何值，但在对上面的高度求和时要考虑它，因为它们的垂直度在每个参与的元素中都会对其产生影响。

我希望我已经理解了，这就是您在[http://jsbin.com/ubiniy/23](http://jsbin.com/ubiniy/23)之后所追求的:)

请记住，这仅解决了该特定问题，并且您可能会遇到不希望的行为，因此我不推荐任何像这样在动态内容中固定高度并取决于特定情况的方法。

我的建议是看看其他人是如何解决这个问题的

# c# - 谷歌地图 .net 包装器

> ID：13976637
> 
> 赞同：0
> 
> 时间：2012-12-20T16:39:20.430
> 
> 标签：c#, .net, google-maps, maps

## 在您阅读其他内容之前：

我知道这个问题的导数（可能是整数？）之前已经被问过（见[这里](https://stackoverflow.com/questions/38070/best-net-wrapper-for-google-maps-or-yahoo-maps)和[这里](https://stackoverflow.com/questions/8265465/net-wrapper-for-google-maps-api-v3)），但这个问题比这两个问题都多一点。另外，这两个有点过时了。

## 重要的东西

所以这里的问题（S）：

*   是否有可靠的 Google Maps .NET 包装器**支持多边形和空间搜索**（`containsLocation()`方法）？

*   如果没有，任何人都可以指出我开始编写自己的正确方向吗？特别是多边形/搜索的东西。

## 附加阅读

我想这样做有几个原因。首先，我正在开发一个移动网站，我不想用一堆 javascript 使客户端超载。第二——我实际上根本不需要显示地图。我真正需要做的就是在地图上绘制多边形并在形状内搜索纬度/经度坐标。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T17:10:23.900

这是我发现的一个： [https](https://gmaps.codeplex.com/) ://gmaps.codeplex.com/ 看起来它已经有一段时间没有被触及，但应该可以帮助您入门。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-04-30T21:40:33.700

对于 Place Search ( `Places API`)，Google Maps API 通过为位置偏差参数指定圆形/矩形范围来支持邻近搜索。请注意，它不支持 OP 要求的通用多边形和空间搜索。

> `locationbias`— 通过指定半径加上 lat/lng 或表示矩形点的两个 lat/lng 对，首选指定区域的结果。如果不指定该参数，则API默认使用IP地址偏置。

[https://developers.google.com/places/web-service/search](https://developers.google.com/places/web-service/search)

> 在此 API 中，地点被定义为场所、地理位置或突出的兴趣点。
> 
> Places API 允许您使用各种类别搜索地点信息，包括场所、著名景点和地理位置。您可以通过邻近度或文本字符串搜索地点。地点搜索会返回地点列表以及每个地点的摘要信息；更多信息可通过地点详情查询获得。

* * *

用于 Google Maps API 的 .NET 包装库（包括`Places API`）：

1.  [谷歌API](https://github.com/vivet/GoogleApi)
2.  [谷歌地图](https://github.com/maximn/google-maps)

[https://stackoverflow.com/a/61531795](https://stackoverflow.com/a/61531795)

# c# - 检查实体是否已被删除

> ID：13976639
> 
> 赞同：5
> 
> 时间：2012-12-20T16:39:22.987
> 
> 标签：c#, entity-framework

我们正在使用 DbContext/Code First 在 winforms 应用程序中实现实体框架，并且对于在另一个上下文中删除/更新实体时检查/处理的正确方法有以下问题。

例如，我们有一些辅助表数据（例如 StateCodes），用户可以进入另一个并根据需要添加/删除状态。这个辅助编辑器表单利用它自己的 DbContext 并在用户退出表单后保存更改。返回主窗体后，主上下文不知道对数据库所做的更改，因此我们想为实体重新加载 DbSet。不幸的是，如果我们删除“MI”状态代码，它似乎仍然存在于 DbSet 的 Local 属性中，并且 EntityState 保持不变，即使在我们调用“Load”来引入所有内容之后也是如此。

除了完全处理主要上下文之外，以下是检查是否从数据库中删除了哪些实体的最佳方法？

```
foreach (State state in db.States.Local)
{
    DbEntityEntry entry = db.Entry(state);
    DbPropertyValues databaseValues = entry.GetDatabaseValues();
    if (databaseValues == null)
    {
        db.States.Remove(state);
    }
    else
    {
        entry.OriginalValues.SetValues(databaseValues);
    }
} 
```

谢谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:44:52.220

您不应该将上下文保持在其工作单元之外。上下文应该只在需要时才能存在，否则你一定会遇到像你观察到的缓存陷阱。（此外，上下文真的没有*那么*重，在需要时实例化它过于耗时/资源密集）。

如果你真的必须让它保持活力，你可能想要考虑将上下文传递给辅助表单。

*从我的评论中反映出来，认为这是最好的答案*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T16:51:05.743

首先，布拉德说了什么。只为特定的工作单元保持上下文活动并处理它。不这样做只会导致头痛。

您还可以使用 ObjectStateManager 检查实体的状态并传入对象或实体键。您还可以使用

`public void Refresh( RefreshMode refreshMode, IEnumerable collection )`

上下文之外的方法。此外，您可以检查进入状态。

[http://msdn.microsoft.com/en-us/library/bb503718.aspx](http://msdn.microsoft.com/en-us/library/bb503718.aspx)

# drupal-7 - D7 网站上的恶意软件 - 被 Google 列入黑名单

> ID：13976642
> 
> 赞同：0
> 
> 时间：2012-12-20T16:39:33.487
> 
> 标签：drupal-7, malware

我想告诉您有关对我的 Drupal 网站的恶意软件攻击。不仅是为了您的建议，还要为任何可能因同样问题而受苦的人创造一些有用的东西。出色地...

* * *

## 最初设定

*   Drupal 7.9
*   激活模块：
    *   核心：块、上下文链接、数据库日志记录、字段、字段 SQL 存储、字段 UI、文件、过滤器、图像、列表、区域设置、菜单、节点、数字、选项、覆盖、路径、PHP 过滤器、RDF、系统、分类、文本、工具栏、用户
    *   CCK：多选
    *   混沌工具套件：混沌工具
    *   DATA/ORA：日历、日期、日期 API、日期弹出窗口、日期视图
    *   字段：电子邮件、字段权限、链接
    *   其他：Google Plus One +1、Pathauto、令牌、重量
    *   分享：分享这个，分享这个块
    *   分类菜单：分类菜单
    *   视图：视图、视图 PDF 显示、视图 PHP、视图 UI
    *   我删除的其他模块：CKEDITOR、VIEWS_SLIDESHOW、IMCE、DOMPDF、PRINT、WYSIWIG

* * *

## 我的设置错误

*   为了满足客户，我修改了一些模块，但我从未更新它们（AUCH！）
*   客户拥有登录数据，可能他的计算机不安全（嗯...）
*   我没有网站的副本，因为我相信提供商每周备份（DOH！）

* * *

## 攻击外部症状

*   主页的所有链接都重定向到恶意软件网站
*   谷歌将网站列入黑名单
*   Google 网站管理员工具面板上的严重警报

* * *

## FTP 症状

*   许多“奇怪”的文件：mainma3.php（我在每个文件夹中都找到了这个！）、functoins.php、sum75.html、wlc.html、aol.zip、chas.zip、chasverification.zip、501830549263.php、wp -conf.php 和十几个 wtmXXXXn.php (dove X = numero) 在根文件夹中。所有这些文件都包含大量恶意函数（unescape、base64_decode、eval 等）
*   Install.php 被一长串恶意代码修改
*   在每个 javascript 文件中都附加了这行代码： ;document.write('');
*   每周备份也被感染
*   在 Drupal 日志面板上发现了十几个重复的“奇怪”请求（我的域被字符串“-----”遮住了）：
    *   index.php?q=ckeditor/xss > 注意：未定义的偏移量： eval() 中的 5 (linea 29 di /web/htdocs/-----/home/modules/php/php.module(74) : eval( )'d 代码(1) : eval()'d 代码）。
    *   -----/user?destination=node/add > shadowke 登录失败
    *   日历/周/2012-W19?year=2011&mini=2012-12 > 找不到页面
    *   misc/]};P.optgroup=P.option;P.tbody=P.tfoot=P.colgroup=P.caption=P.thead;P.th=P.td;if(!c.support.htmlSerialize) P._default=[1, > 找不到页面
    *   misc/)h.html(f?c( > 找不到页面
    *   mail.htm > 找不到页面

* * *

## 恢复 [感谢这篇文章：http://25yearsofprogramming.com/blog/20070705.htm]

1.  我已将网站置于维护模式（error503.php + .htaccess）。流量仅针对我的 IP 地址开放 [请参阅此有用指南：http://25yearsofprogramming.com/blog/20070704.htm]
2.  我已经在本地下载了整个网站
3.  我已经搜索并删除了奇怪的文件 > 我找到了 40 个
4.  我搜索了这些世界的文件 [使用免费软件 AGENT RANSACK]：eval(base64_decode($ *POST["php"])), eval(, eval (, base64* , document.write, iframe, unescape, var div_colors, var _0x, CoreLibrariesHandler, pingnow, serchbot, km0ae9gr6m, c3284d, upd.php, *timthumb* . > 我采取了以下方式之一：a) 我已将 eval 替换为 php_eval()（drupal 的 eval 安全版本） ; b) 我已经写下了可疑的模块；c）我已经将代码与新下载的模块进行了比较；d) 我已经删除了所有的恶意代码（参见上面提到的 javascript）
5.  我在文件系统中搜索了 mohanges [使用免费软件 WINMERGE]
6.  我发现了一些可疑的模块，感谢上面第 4 点写的列表，感谢对 Google 的一些研究（name_of_the_module 安全问题，name_of_the_module 被黑客入侵等...）和 Secunia [http://secunia.com /社区/咨询/搜索]
7.  我已经扫描了我的计算机（Avast、Search&Destroy、Malwarebytes Antimalware）> 我没有发现任何病毒或间谍软件
8.  我已更改所有登录名（ftp、cpanel、drupal 管理面板）
9.  我已经重新加载了整个网站
10.  我已经删除了所有可疑的模块：CKEDITOR、VIEWS_SLIDEWHOW、PRINT、DOMPDF、IMCE、CAPTCHA、WYSIWIG、WEBFORM。
11.  我已经把整个故事告诉了提供者协助
12.  我要求谷歌修改（他们在 12 小时内完成了）

* * *

## 立即登录

十几个这样的消息 - wtm4698n.php?showimg=1&cookies=1 > 找不到页面 - fhd42i3d.html > 找不到页面 - wp-conf.php?t2471n=1 > 找不到页面 - -----/user?destination =node/add > Elovogue 登录失败

* * *

## 得到教训

*   切勿触摸模块，以便更新它们
*   将所有登录信息保存在安全的计算机中/使用安全的计算机在 FTP 上工作
*   在安装模块之前搜索任何安全问题
*   在某处保留网站的干净副本

* * *

## 我的问题：

*   我受到了什么样的攻击？
*   我的安装中还有其他不确定的模块吗？
*   我还能做什么？

感谢大家的耐心等待！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-19T14:40:20.587

如果您使用的是 m$ windows，我认为这是一个木马/病毒，它会窃取您的 ftp 密码并自动编辑文件。我知道很多这样的故事。

切换到`WinSCP.net`。

# c# - 自定义渲染 CheckBoxList 项目以在 LI 上设置一个类

> ID：13976643
> 
> 赞同：7
> 
> 时间：2012-12-20T16:39:35.743
> 
> 标签：c#, asp.net

我有一个 CheckBoxList（框架版本 4），RepeatLayout 设置为 UnOrderedList。我想在每个 LI 上生成一个类来简化一些客户端编码和样式，但是，我无法得到它。

我重写 RenderItem 方法如下：

```
protected override void RenderItem(ListItemType itemType, int repeatIndex, RepeatInfo repeatInfo, HtmlTextWriter writer)
{
    ListItem item = Items[repeatIndex];
    String id = ClientID + "_" + repeatIndex.ToString();
    String name = UniqueID + "$" + repeatIndex.ToString();

    writer.Write(@"<li class='{0}'>", "tcsdrp_day" + (item.Selected ? " selected" : ""));
    writer.Write(@"<input id='{0}' type='checkbox' name='{1}' value='{2}'>", new object[] { id, name, item.Value });
    writer.Write(@"<label for='{0}'>{1}</label>", new object[] { id, item.Text });
    writer.Write(@"</li>");
} 
```

但是，我得到了大量生成的空白 LI，因此很明显它们是在调用者或其他地方呈现的，我终生无法确定在哪里。

现在通过将类添加到 ListItems 来解决这个问题，但这会创建一个额外的 SPAN，我希望丢失它。

有什么好的方法可以做到这一点吗？

编辑：这是一个精简的演示；最终版本将具有基于原始数据项属性生成不同类的逻辑，以防有人想知道为什么我需要添加一个类。

编辑 2：我现在解决了通过将 RenderItem 更改为使用 label-wrapping-the-input 样式来简化标记的直接问题：

```
writer.Write(@"<label class='{0}'>", labelclass);
writer.Write(@"<input id='{0}' type='checkbox' name='{1}' value='{2}'{3}>", new object[] { id, name, item.Value, item.Selected ? " checked" : "" });
writer.Write(item.Text);
writer.Write(@"</label>"); 
```

我仍然想知道是否有任何方法可以完全自定义项目渲染。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-24T09:58:57.077

在 PreRender 事件中，遍历 Items-Collection，并根据需要分配类：

```
For Each l As ListItem In Items
  If l.Value = "1" Then
    l.Attributes.Add("class", "myClass")
  End If
Next l 
```

# c++ - std::array 实例化错误

> ID：13976651
> 
> 赞同：18
> 
> 时间：2012-12-20T16:39:54.957
> 
> 标签：c++, arrays, c++11, containers

这里有一个令人尴尬的简单问题。我正在尝试使用`std::array`并在错误的第一个障碍中绊倒......

```
implicit instantiation of undefined template 'std::__1::array<char,10>' 
```

给出错误的代码如下所示。我现在可以解决它`std::map`，但我确信修复一定很简单！

```
enum  p_t   {
    EMPTY = 0
    ,BORDER_L
    // ...
    ,BORDER_BR
    ,DATUM
    ,NUMEL    };

class PlotChars
{
    array<char, p_t::NUMEL> charContainer;
    // error on this ^ line:
    //   implicit instantiation of undefined template 'std::__1::array<char,10>'
}; 
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-12-20T17:16:29.403

我的第一个猜测是您只是忘记了：

```
#include <array> 
```

...在尝试使用`array`模板之前。虽然您可以（至少间接地）使用一些类而不包括头文件（例如，编译器可以创建一个类似的`std::initializer_list`东西`{1, 2, 3}`而不包括任何头文件）在大多数情况下（包括`std::array`）您需要在使用类模板之前包含头文件.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T16:43:23.697

您正在使用 C 样式的枚举，因此如果您的编译器不完全符合 C++11，您可能需要省略枚举名称。

```
array<char, NUMEL> charContainer; 
```

这适用于 gcc 4.4.3，而与您的代码等效的版本尚未适用于该版本（但适用于更高版本）

```
#include <array>

enum XX { X,Y,Z };

struct Foo
{
  std::array<char, Y> a;
};

int main()
{
  Foo f;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T16:46:42.453

试试看

```
 std::array<char, (int)NUMEL> charContainer; 
```

# svn - 按作者的tortoiseSVN过滤器不显示所有修订

> ID：13976652
> 
> 赞同：1
> 
> 时间：2012-12-20T16:39:55.387
> 
> 标签：svn, tortoisesvn, visualsvn-server

我有一个运行 repo 并在我的机器上使用最新的 TortoiseSVN 客户端的 VisualSVN 服务器。

完整的修订日志显示了来自特定用户的许多修订，但是当我在过滤器框中查找该用户的名称时，我没有得到未应用过滤器时看到的所有修订。我没有选中任何选项（显示受影响、停止复制或包含合并）。

有没有我缺少的设置？

# wpf - Silverlight/WPF - RadioButton.IsChecked 绑定到智能布尔源

> ID：13976661
> 
> 赞同：0
> 
> 时间：2012-12-20T16:40:39.757
> 
> 标签：wpf, silverlight, mvvm, radio-button

我有时厌倦了为 MVVM UI 上的每个单选按钮创建单独的 IsChecked*SomePropertyName*。另一种方法是命名每个按钮并找到 IsChecked=true 的按钮，然后将其名称转换为我的**强文本**模型中有意义的东西。

如果有一种方法可以支持 Silverlight 和/或 WPF 以拥有一个封装所有这些易变逻辑的集合，那就太好了。我的代码中的一个示例用例是：

```
<Page x:Name="idHost"
      ...>

<TextBlock Text="{Binding Path=RadioButtonSource.CurrentEnabledButton, Mode=OneWay, StringFormat='Selected Filter: {0}', TargetNullValue='Selected Filter: not selected', ElementName=idHostPage}" />
<RadioButton IsChecked="{Binding Path=RadioButtonSource[Inherited], Mode=TwoWay, ElementName=idHostPage}"
             IsThreeState="False"
             GroupName="PostFilter"
             Content="Inherited" />
<RadioButton IsChecked="{Binding Path=RadioButtonSource[Direct], Mode=TwoWay, ElementName=idHostPage}"
             IsThreeState="False"
             GroupName="PostFilter"
             Content="Direct" />
... 
```

页面后面的代码如下所示：

```
public partial class MyPage : Page {

    public MyPage() {
        this.RadioButtonSource = new RadioButtonSource();
    }

    public RadioButtonSource RadioButtonSource {
        get { return (RadioButtonSource)GetValue(RadioButtonSourceProperty); }
        set { SetValue(RadioButtonSourceProperty, value); }
    }

    public static readonly DependencyProperty RadioButtonSourceProperty = DependencyProperty.Register("RadioButtonSource", typeof(RadioButtonSource), typeof(MyPage), new PropertyMetadata(null));
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T16:40:39.757

这是我已经提出的问题的解决方案。将所有这些繁忙工作封装到一个可重用类中的单个类。

```
public class RadioButtonSource : INotifyPropertyChanged {

    #region Member Field(s)

    Dictionary<string, bool> m_RadioButtonFlags;

    #endregion

    #region Event(s)

    public event PropertyChangedEventHandler PropertyChanged;

    #endregion

    #region Con/Destructor(s)

    public RadioButtonSource() {
        this.m_RadioButtonFlags = new Dictionary<string, bool>();
    }

    #endregion

    #region Exposed Proper(y|ies)

    public string CurrentEnabledButton {
        get {

            var q = from key in this.m_RadioButtonFlags.Keys
                    where this.m_RadioButtonFlags[key]
                    select key;

            return q.FirstOrDefault();
        }
    }

    [IndexerName("Item")]
    public bool this[string radioButtonName] {
        get {

            if (string.IsNullOrEmpty(radioButtonName))
                throw new ArgumentNullException("radioButtonName");
            if (this.m_RadioButtonFlags.ContainsKey(radioButtonName))
                return this.m_RadioButtonFlags[radioButtonName];

            var returnValue = false;
            this.m_RadioButtonFlags.Add(radioButtonName, returnValue);
            return returnValue;
        }
        set {

            if (string.IsNullOrEmpty(radioButtonName))
                throw new ArgumentNullException("radioButtonName");

            if (this.CurrentEnabledButton == radioButtonName)
                return;

            this._ChangeFlags(radioButtonName);

            if (this.PropertyChanged != null) {
                this.PropertyChanged(this, new PropertyChangedEventArgs("Item[]"));
                this.PropertyChanged(this, new PropertyChangedEventArgs("CurrentEnabledButton"));
            }
        }
    }

    #endregion

    #region Method(s)

    void _ChangeFlags(string radioButtonName) {

        if (string.IsNullOrEmpty(radioButtonName))
            throw new ArgumentNullException("radioButtonName");
        if (!this.m_RadioButtonFlags.ContainsKey(radioButtonName))
            this.m_RadioButtonFlags.Add(radioButtonName, true);

        foreach (var key in this.m_RadioButtonFlags.Keys.ToArray()) {
            if (key != radioButtonName)
                this.m_RadioButtonFlags[key] = false;
            else
                this.m_RadioButtonFlags[key] = true;
        }
    }

    #endregion
} 
```

希望这可以帮助。圣诞快乐，上帝保佑。

*   拉沙德

# objective-c - ios 5 与 ios 6 问题中的自动旋转

> ID：13976664
> 
> 赞同：4
> 
> 时间：2012-12-20T16:40:45.687
> 
> 标签：objective-c, ios, ipad, uiinterfaceorientation, uideviceorientation

我有一个必须支持 iOS 5.0 及更高版本的 iPad 应用程序。我有一个错误，它在 5.0/5.1 中的行为与在 6.0 中的行为不同。问题是 tabbarcontroller 中的视图控制器推送模态视图，而后者又通过 navigationController 推送全屏视图。问题是，在全屏视图中，如果 iPad 旋转，则底层视图控制器（tabbarcontroller 中的一个）不会旋转。现在让我分解iOS版本的差异：

首先，这个有问题的viewController实现了shouldAutoRotateToInterfaceOrientation（返回YES）以及willRotateToInterfaceOrientation和willAnimateRotationToInterfaceOrientation。

在 iOS 6.0 中，我注意到旋转方法（willRotate... & willAnimate...）没有被调用，所以我注册它以接收 UIDeviceOrientationDidChangeNotification 通知并在收到通知时执行两个 Rotate 方法的代码，并且其他方法没有执行。这解决了 iOS 6.0 中的问题。

问题是，在 5.0/5.1 中，正在执行旋转方法（willRotate... & willAnimate...），但视图没有旋转。如果“全屏视图”没有出现在这个视图控制器之上并且 iPad 被旋转，这两个方法执行并且视图相应地旋转。

请帮忙。提前致谢。

除了上述之外，我尝试过的事情。

我尝试检查 UIDeviceOrientation 并将其转换为 UIInterfaceOrientation 并调用 [self shouldAutorotateToInterfaceOrientation:xxx]; 视图仍然显示错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T07:14:33.727

当执行这两种旋转方法时，为您的视图执行 CAAffineTransformation。当您恢复正常时，再次对 -90 度执行相同操作。

[https://developer.apple.com/library/ios/#documentation/GraphicsImaging/Reference/CGAffineTransform/Reference/reference.html](https://developer.apple.com/library/ios/#documentation/GraphicsImaging/Reference/CGAffineTransform/Reference/reference.html)

# c# - 如何在 TextBoxFor ASP.NET MVC 中验证 DateTime

> ID：13976666
> 
> 赞同：1
> 
> 时间：2012-12-20T16:40:49.810
> 
> 标签：c#, asp.net-mvc, validation, asp.net-mvc-4

我有这个代码：

```
@Html.TextBoxFor(m => Model.MyDateTime) 
```

MyDateTime - 是 DateTime 对象。它在文本框中显示正确的日期和时间：09/10/2010 05:19:56 PM 但是当我尝试单击提交按钮时，它显示它的值不正确。我使用 jquery.validate.unobtrusive.js 文件进行验证。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T23:03:10.450

我在评论中指出的解决方案的要点是，您可以对包含字符串表示形式而不是 DateTime 类型的视图使用专门的模型，这样您就可以使用[RegularExpressionAttribute](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.regularexpressionattribute.aspx)轻松验证值。当您在服务器上收到此模型（从客户端发布）时，只需将其转换为相应的数据库模型。

```
public class ViewModel
{
    [Required]
    [RegularExpression("\d{2}-\d{2}-\d{4}\s\d{2}:\d{2}:\d{2}")]
    public string MyDateTime { get; set; }

    public Model ToPoco()
    {
        return new Model {
            MyDateTime = DateTime.Parse(this.MyDateTime, "MM-dd-yyyy H:mm:ss")
        };
    }
}

public class Model
{
    DateTime MyDateTime { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-24T19:36:14.310

数据注释将为您工作！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T22:50:25.717

您可以使用[dataannotaion](http://dataannotationsextensions.org/)正确验证您的模型字段。使用这样的注释，您可以在注释中手动提供日期格式，将字符串模式传递给它。在这种情况下，它将完美地使用默认的 mvc 验证。

# c# - 如何设置div的innerhtml

> ID：13976674
> 
> 赞同：-1
> 
> 时间：2012-12-20T16:41:03.213
> 
> 标签：c#, .net, string

请帮我把我的 C# 代码放在后面

```
 SpecialOffersDiv.InnerHtml = "<div class="offer_box_wide">
                                  <a href=""><img src="../images/p1.jpg" width="130" height="98" class="img_left" alt="" border="0" /></a>
                                  <div class="offer_info"> <span>For Sale 150 000 $</span>
                                  <p class="offer"> &quot;Lorem ipsum dolor sit</p>
                                  <div class="more"><a href="#">...more</a></div>
                                  </div>
                                  </div>"; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:52:08.413

你的问题是由两件事引起的。首先，字符串中的双引号需要转义。二是新建线路要妥善处理。有两种方法可以做到这一点。

首先，您可以使用逐字字符串文字指示符，然后将字符串中的每个双引号标记加倍。

```
SpecialOffersDiv.InnerHtml = @"<div class=""offer_box_wide"">
                               <a href=""""><img src=""../images/p1.jpg"" width=""130"" height=""98"" class=""img_left"" alt="""" border=""0"" /></a>
                               <div class=""offer_info""> <span>For Sale 150 000 $</span>
                               <p class=""offer""> &quot;Lorem ipsum dolor sit</p>
                               <div class=""more""><a href=""#"">...more</a></div>
                               </div>
                               </div>"; 
```

其次，您可以使用反斜杠转义双引号并将换行符更改为 \n：

```
SpecialOffersDiv.InnerHtml = "<div class=\"offer_box_wide\">\n" +
                             "<a href=\"\"><img src=\"../images/p1.jpg\" width=\"130\" height=\"98\" class=\"img_left\" alt=\"\" border=\"0\" /></a>\n" +
                             "<div class=\"offer_info\"><span>For Sale 150 000 $</span>\n<p class=\"offer\"> &quot;Lorem ipsum dolor sit</p>\n" +
                             "<div class=\"more\"><a href=\"#\">...more</a></div>\n" +
                             "</div>\n" +
                             "<`div>"; 
```

我会说第一个，它看起来好多了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T16:48:54.847

[字符串文字](http://msdn.microsoft.com/en-us/library/aa691090%28v=vs.71%29.aspx)（特别是参见示例`string f & g`）

```
SpecialOffersDiv.InnerHtml = @"<div class=""offer_box_wide"">
                        <a href=""""><img src=""../images/p1.jpg"" width=""130"" height=""98"" class=""img_left"" alt="""" border=""0"" /></a>
                        <div class=""offer_info""> <span>For Sale 150 000 $</span>
                        <p class=""offer""> &quot;Lorem ipsum dolor sit</p>
                        <div class=""more""><a href=""#"">...more</a></div>
                        </div>
                        </div>"; 
```

# html - 缩小img而不损失质量？

> ID：13976675
> 
> 赞同：2
> 
> 时间：2012-12-20T16:41:04.407
> 
> 标签：html, css

看到这个：

[http://real-sense.com/index.php?option=com_content&view=article&id=106](http://real-sense.com/index.php?option=com_content&view=article&id=106)

右侧的垂直图像集正在使用 CSS 调整大小

```
.thumbnail-product-resize
{
width:144px;
height : auto;
} 
```

有谁知道如何以更清洁的方式做到这一点，这样我就不会失去图像质量？

我的意思是，如果我使用 Photoshop 调整了图像的大小，文本就不会像这里那样模糊。

在 FF 中测试

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-20T16:49:14.460

您的图像质量将取决于您使用的图像的原始大小。如果有一个质量很好的大图像，比如 size `400x500`，然后在 HTML`80x100`中将其调整为 ，它仍然是`400x500`图像。但是，您只能在较小的图像上放置一定数量的像素`80x100`，因此必须对较大的图像进行采样。这意味着对像素进行平均，然后将其表示为`80x100`大小图像。如果您想要更明确的结果，您可以将图像的原始大小更改为`80x100`. 这可能会给你更好的结果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-20T17:32:35.320

曾几何时，由于他们用来缩放图像的简单的[最近邻技术，浏览器图像大小调整给出了真正令人发指的结果。](http://tech-algorithm.com/articles/nearest-neighbor-image-scaling/)现在他们通常在缩放时执行过滤，并且在浏览器中调整大小和在 Photoshop 中调整大小之间没有**太大**区别。

在将图像提供给客户端之前缩放图像的真正优势在于，您不会在不需要时强制下载大图像。根据图像的大小，这可以显着减少页面加载时间。

最后要考虑的一件事是，越来越多的人拥有带有“视网膜”显示器的设备。对于那些用户在提供图像之前缩放图像将导致图像不那么清晰。

*以下是各种浏览器使用的图像缩放方法的深入比较：http: [//entropymine.com/resamplescope/notes/browsers/](http://entropymine.com/resamplescope/notes/browsers/)*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-20T16:45:04.477

即使您在 Photoshop 中完成了此操作，您所拥有的图像仍然会像刚才那样出现。

仅供参考，您不需要在上面的 CSS 中包含 height:auto 。

最好的办法是创建一组单独的缩略图（使用 Photoshop），它可能只显示图像的一部分。

以您的方式加载缩略图并使用 css 调整它们的大小是不好的做法，因为您仍然让用户首先下载大图像。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-20T16:46:50.923

除非它是矢量图像，否则不可能在不损失质量的情况下缩小图像。这意味着您必须使用 SVG。考虑到显示的图像，我认为您不会这样做。

您还提到了更清洁的方法，使用 Photoshop 或类似的东西。

# javascript - 用指定的位数和除法计算有多少个数字的函数

> ID：13976679
> 
> 赞同：3
> 
> 时间：2012-12-20T16:41:15.110
> 
> 标签：javascript

我开始制作一个能够执行以下操作的函数：*计算你可以用数字 0、1、2、3、4 和 5 组成多少个 6 位数字，可以除以 6？*

我目前如何尝试开始，是我制作一个包含所有可能数字的数组，然后取出其中包含任何`numbers`' 数组元素的每个数字，然后删除不能被 6 整除的数字。

我在第二部分卡住了。我尝试制作 2 个循环以在 的数组中`numbers`循环，然后在该循​​环内，为数组的长度创建另一个循环`allnumbers`以删除所有匹配项。

然后我会`%`以同样的方式使用运算符来取出每个不返回 0 的元素。

代码需要灵活。如果用户要求例如。数字 6 也是如此，那么代码应该仍然有效。我有什么办法可以完成这个？

我的代码是：

```
var allnumbers = [],j;
var biggestnumber = "999999999999999999999999999999999999999999999999999999999999";

function howmanynumbers(digits,numbers,divideWith){
    if (digits && numbers && divideWith){
        for (var i = 0; i < 1+Number(biggestnumber.substring(0,digits)); i++ ){
            allnumbers.push(i);
        }

        for (j = 0; j < numbers.length; j++ ){
            var matchit = new RegExp(numbers[j]);
        }
            //not expected to work, I just had this in for reference
        if ( String(allnumbers[i]).match(matchit) != [""]){
            j = 0;
            allnumbers.splice(i,1);
            var matchit = new RegExp(numbers[j])
        }
    }
    else {
        return false;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T16:53:53.837

这是我对整个解决方案的看法：

```
var i;
var allowedDigitsPattern = /^[0-5]+$/i;
var numbers = [];

for (i = 100000; i < 555555; i++) {
    if (allowedDigitsPattern.test(i.toString())
        && i % 6 === 0) {
        numbers.push(i);       
    }
} 
```

您可以这样查看结果：

```
document.write('There are ' + numbers.length + ' numbers<br>');

// write out the first ten!
for (i = 0; i < 10; i++) {
    document.write(numbers[i] + '<br>');
} 
```

**根据评论更新...**

它的可配置版本是：

```
var i;
var lowestDigit = 0;
var highestDigit = 5;
var numberOfDigits = 6;

var allowedDigitsPattern = new RegExp('^[' + lowestDigit + '-' + highestDigit + ']+$', 'gi');

var smallestNumber = '1';
for (i = 1; i < numberOfDigits; i++) {
    smallestNumber += '0';
}

var biggestNumber = '';
for (i = 0; i < numberOfDigits; i++) {
    biggestNumber += highestDigit.toString();
}

var numbers = [];

for (i = smallestNumber; i < biggestNumber; i++) {
    if (allowedDigitsPattern.test(i.toString())
        && i % 6 === 0) {
        numbers.push(i);        
    }
}

document.write('There are ' + numbers.length + ' numbers<br>'); 
```

您需要根据配置更改最小和最大数字。我已经使允许的数字和数字的长度都可配置。

# c - 将静态链接的精灵二进制文件转换为动态链接的

> ID：13976680
> 
> 赞同：11
> 
> 时间：2012-12-20T16:41:17.917
> 
> 标签：c, linux, elf, openonload

我有一个静态链接到 libc 的精灵二进制文件。我无权访问它的 C 代码。我想使用 OpenOnload 库，它在用户空间中实现了套接字，因此与标准 libc 版本相比提供了更低的延迟。OpenOnload 实现标准套接字 API，并使用 LD_PRELOAD 覆盖 libc 版本。但是，由于这个 elf 二进制文件是静态链接的，它不能使用 OpenOnload 版本的套接字 API。

我相信可以通过以下步骤将此二进制文件转换为与 OpenOnload 动态链接：

1.  添加新的程序头文件：PT_INTERP、PT_DYNAMIC 和 PT_LOAD。
2.  在 PT_DYNAMIC 中添加条目以列出与 libc 的依赖关系。
3.  在新的 PT_LOAD 部分中为所需的 libc 函数添加 PLT 存根。
4.  修改 libc 函数的现有二进制代码以跳转到相应的 PLT 存根。

作为第一次剪辑，我尝试仅添加 3 个 PT_LOAD 段。在现有的 PT_LOAD 段标头之后添加了新的段标头。此外，未修改现有段的 vm_addr。基于 p_align 将现有段的文件偏移量移至下一个对齐地址。在文件末尾的文件中添加了新的 PT_LOAD 段。

重新编写文件后，当我运行它时，它被内核正确加载，但随后立即出现 seg-faulted。

我的问题是：

1.  如果我只是在 elf 二进制文件中移动文件偏移量，而不修改 vm_addresses，它会在运行二进制文件时导致任何错误吗？
2.  有可能做我正在尝试的事情吗？有人尝试过吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T18:59:18.990

您正在尝试的事情不可能以任何自动化方式进行。在静态链接时，所有将 libc 调用标识为 libc 调用的重定位信息都已解析并删除。如果二进制中存在调试符号，则可以识别“文本段中的这个字节范围对应于某某libc函数”，但无法识别对该函数的*引用*，它将嵌入到没有标记来识别它们的指令字节流。您可以使用基于反汇编的启发式方法，但它们将是不完整且不可靠的（可能存在误报和误报）。

至于偏移偏移量，您绝对不能更改静态链接二进制文件的加载地址。如果您需要在加载段之前插入标题，则必须插入整个页面，并更新程序头表中的文件偏移量（向它们添加 1 页），同时保持虚拟地址加载偏移量相同。但是，由于您尝试做的事情总体上是不可能的，因此偏移转移问题是您最不担心的问题。

也许，如果程序不需要高性能，您可以在 qemu 应用程序级仿真下运行它，让 qemu 通过套接字仿真/包装器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-13T05:44:42.340

> OpenOnload ... 使用 LD_PRELOAD 覆盖 libc 版本。但是，由于这个精灵二进制文件是静态链接的......

还回答了[拦截静态链接可执行文件的系统调用](https://stackoverflow.com/a/10695062/10440128)

# plc - Pi Historian，仅在值等于时显示结果

> ID：13976681
> 
> 赞同：0
> 
> 时间：2012-12-20T16:41:17.793
> 
> 标签：plc, opc, historian

我正在使用 PI Historian 从一些标记点读取值。
我正在使用这个特殊的 Historian 软件[http://www.osisoft.com/](http://www.osisoft.com/)

如果包含某些“文本”或“结果”，我想知道是否可以显示结果

在哪里说标签掩码我可以放置我想要搜索的标签，在我得到那个标签之后，我可以做一个当前值或采样数据，或定时，或计算。

相反，我希望它显示具有示例“书”质量标签的当前值的标签

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T14:42:01.497

“book”将是数字标签的数字状态字符串。为了搜索它，您只需转到显示“值”的框，然后单击右指向箭头并将其更改为“状态”。然后您可以输入“book”，它将返回所有具有该状态的标签的列表。

我显然还没有足够的声望点来发布截图。

# jquery - jquery show() 视觉故障

> ID：13976682
> 
> 赞同：0
> 
> 时间：2012-12-20T16:41:19.897
> 
> 标签：jquery, html, css

> **可能重复：**
> [slideDown 在最后突然跳跃](https://stackoverflow.com/questions/11194402/slidedown-jumps-abruptly-at-the-end)

除了链接我的网站之外，我没有其他好的方法来显示正在发生的事情，因为它是一个视觉故障。

[http://rickymason.net/omnia/](http://rickymason.net/omnia/)

当用户单击“添加”时，我正在使用 jquery 隐藏/显示 div。它可以工作，除了在 Firefox 和 chrome 中，它在打开时会“跳跃”一点。

当通过单击激活“show()”时，div 会增长到 div 应该达到的高度，然后反弹回来。

仅供参考，这是我的JS：

```
$(document).ready(function(){
 if ($('.springtrail_link').data('hidden') == 1) { $('#suggested').hide();}

$('.springtrail_link').click(function(){
        var hidden = $(this).data('hidden')
        var linkid = $(this).attr("id");
        var divid = "#suggested";
        if (hidden == 0)
        {
            hide(divid)
            $('.springtrail_link').data('hidden', '1');
        } else
        {
            show(divid)
            $('.springtrail_link').data('hidden', '0');
        }
});  

$('.closesuggest').click(function(){
    $("#suggested").slideUp('fast');
    $('.springtrail_link').data('hidden', '1');
});  

function show(divid)
{
    $(divid).show('fast');
}

function hide(divid) 
{
    $(divid).hide('fast');
} 
```

这是我的观点：

```
<div id="closesuggest"><a class="closesuggest" href="#">Close</a></div>
<div class="cus_input">
    <form id="category_form">
        <input type="text" id="category_input" name="category_input" placeholder=" Find Category"/>
        <input type="image" id="category_submit" src="<?php echo base_url() ?>img/board/icons/add.jpg" id="homeSubmit" value="X"/>
    </form>
</div>
<div id="suggestedcategories">
    <h2> Choose a predefined category!</h2>
    <ul class="suggestedul">
        <li class="keyword" data-keywordid="1">News</li>
        <li class="keyword" data-keywordid="2">Entertainment</li>
        <li class="keyword" data-keywordid="3">Sci/Tech</li>
        <li class="keyword" data-keywordid="4">Viral</li>
    </ul>
</div> 
```

CSS：

```
#springtrail {
    overflow: hidden;
    padding: 4px;
    background-color: moccasin;
}

#suggested {
    position: relative;
    padding: 4px;
    overflow: hidden;
}

.cus_input {
    float:right;
    position: relative;
    background-color: white;
    width: 200px;
    height: 26px;
    border-radius: 3px;
    -moz-border-radius: 3px;
}

.cus_input #category_input {
    width: 175px;
    border: 0;
    position: absolute;
    top: 5px;
    left: 3px;
}

.cus_input #find_group {
    width: 220px;
    border: 0;
    position: absolute;
    top: 5px;
    left: 3px;
}

.cus_input #image {
    position: absolute;
    top: 3px;
    right: 0;
}

.cus_input #category_submit {
    position: absolute;
    top: 3px;
    right: 0;
} 
```

我确定它与输入有关，但我不知道它有什么问题。

# web-services - 泽西 Web 服务方法未被识别为有效资源方法

> ID：13976686
> 
> 赞同：1
> 
> 时间：2012-12-20T16:41:41.223
> 
> 标签：web-services, jersey

我有一个 Web 服务，它的方法看起来像

```
@GET
@Produces(MediaType.TEXT_PLAIN)
public String getString(@QueryParam("path") path) {
    return "got the string " + path
} 
```

当我运行它时，我收到一条错误消息

```
 SEVERE: Missing dependency for method public java.lang.String com.example.getString(java.lang.Object) at parameter at index 0
  SEVERE: Method, public java.lang.String com.example.getString(java.lang.Object), annotated with GET of resource, class com.example.MyServiceClass, is not recognized as valid resource method. 
```

这个错误信息是什么意思？如果我在没有参数的情况下运行服务，那么它可以工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T17:53:18.560

回答我自己的问题...

我正在使用 groovy，但我忘记了 @QueryParam 的类型。这似乎是必要的。

# ajax - 带有 KNP Paginator Bundle 的 Symfony 2.1 ajax 过滤器

> ID：13976687
> 
> 赞同：5
> 
> 时间：2012-12-20T16:41:41.610
> 
> 标签：ajax, pagination, symfony-2.1

嗨，我有一个带有元素列表的表格的页面（index.html.twig。）。我正在使用 KNP Paginator Bundle 对结果进行分页。现在我想在这个页面中实现某种过滤器来过滤表格结果。我正在使用 AJAX 来执行此操作，因此我创建了另一个视图 (grupos.html.twig)，其中包含表和分页器以呈现查询结果。这是控制器代码：

```
public function filtrarGrupoPorLetraAction(){
 if ($this->getRequest()->isXmlHttpRequest()) {
   $em = $this->getDoctrine()->getManager();
   $letra = $this->getRequest()->get('letra');
   $entities = $em->getRepository('GrupoBundle:Grupo')->filtrar($letra);

   $paginator = $this->get('knp_paginator');
   $pagination = $paginator->paginate(
     $entities,
     $this->get('request')->query->get('page', 1) /*page number*/,
     25/*limit per page*/
   );

   return $this->render('GrupoBundle:Grupo:grupos.html.twig', compact('pagination'));
 }
} 
```

但是这段代码呈现一个新页面，我想将结果传递给 index.html.twig 以呈现一个 div。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-06T22:17:47.790

只需将结果数据附加到您的 div

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-30T15:08:47.543

如果您只需要一个 json 响应，请使用下面的代码

```
// create a JSON-response with a 200 status code
$response = new Response(json_encode($yourData));
$response->headers->set('Content-Type', 'application/json');

return $response; 
```

如果你需要渲染一个模板

```
return $this->renderView('YourTemplateFile', $yourParams); 
```

希望这有帮助

# facebook - 点击喜欢的优惠券（唯一代码）。什么是最好的方法

> ID：13976688
> 
> 赞同：2
> 
> 时间：2012-12-20T16:41:42.060
> 
> 标签：facebook, unique, coupon

唯一代码会提供给点击喜欢的人（仅在他第一次点击时），以确保他不会再次拥有唯一代码。我必须在我的数据库中有他的 fb id，但我读到不可能知道点击喜欢的人的 fb id。有解决办法吗？

如果喜欢按钮会出现在我的有趣页面上，那有可能吗？我已经完成了生成唯一代码的所有过程，并在我的数据库中检查代码是否被使用或知道，我只需要在我的数据库中保留 fb id 以确保他不会得到更多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:50:54.433

1.  创建 fangate（区分喜欢的人和不喜欢的人）。
2.  is_liker 是获取具有基本权限的用户 ID。
3.  在接受权限请求后返回检查用户是否已经获得代码。
4.  如果用户从来没有得到代码给他。否则显示错误信息。

# amazon-web-services - 使用 AWS SQS 进行作业队列，但最大限度地减少“工作人员”正常运行时间

> ID：13976690
> 
> 赞同：4
> 
> 时间：2012-12-20T16:41:45.047
> 
> 标签：amazon-web-services, amazon-ec2, amazon-sqs

我正在设计我的第一个 Amazon AWS 项目，我可以在队列处理方面使用一些帮助。

该服务通过 ASP.net Web API 服务或 GUI 网站（仅调用 API）接受处理作业。每个作业都有一个或多个与之关联的文件以及一些关于作业类型的规则。我想在每个作业进入时对其进行排队，大概是使用 AWS SQS。然后这些作业将由一个“worker”处理，它是一个带有 .Net 包装器的 python 脚本。python 脚本是一个现有的批处理器，不能为 AWS 更改/定制，因此 .Net 中的包装器管理 AWS 部分并将正确的参数传递给 python。

问题是我们不会有大量的工作，但每个工作都在某种程度上是计算密集型的。选择 AWS 的原因之一是最大限度地降低基础设施成本。我计划让前端网站（Web API + ASP.net MVC4 站点）在弹性 beanstalk 上运行。但我不希望有一个专门的工作机器总是在线轮询工作，因为这些工作人员需要有点“更强大”的实例（用于处理），而且我们大部分时间什么都不做会花费我们很多。

有没有办法只在 beanstalk 上运行 web 部分，然后只有在队列中有项目时才让工作进程启动？我意识到我可以拥有一个始终在线轮询的微型“控制器”实例，然后让它控制计算启动，但即使这样似乎也不需要它。EC2 实例是否可以基于非零 SQS 队列大小启动？所以基本上 web api 将作业添加到队列中，一些东西监视队列并看到它是非零的，这会触发 EC2 工作程序启动，它启动并在启动时轮询队列。它一直处理直到队列为空，然后触发它关闭。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T20:00:59.797

您可以将[Autoscaling](http://aws.amazon.com/autoscaling/)与 SQS 结合使用来动态启动和停止 EC2 实例。有一篇[AWS 博客文章](http://aws.typepad.com/aws/2011/07/additional-cloudwatch-metrics-for-amazon-sqs-and-amazon-sns.html)描述了您正在考虑的架构。

# c++ - 使用 GDI 或 GDI+ 的高级图形

> ID：13976695
> 
> 赞同：0
> 
> 时间：2012-12-20T16:41:59.043
> 
> 标签：c++, .net, gdi+, gdi

我正在寻找一些高级教程，或者可能是用 C++ 或 .NET 编写的开源应用程序，它们将实现复杂的基于矢量的应用程序，例如 MS Visio 或 Autocad。我需要知道的是，当用户可以将复杂对象移动到其他复杂对象上时，此类应用程序的专家如何在鼠标移动时管理复杂对象（> 1000 个矩形）的渲染。我知道 XOR 绘画之类的东西，但如果你检查上面的应用程序，很明显他们没有使用这种技术。整个对象在另一个对象上平滑移动，而不仅仅是它的 XOR 反射。另外，移动对象在移动时会显示一些附加信息，例如当前坐标或其他信息，因此它不是保存在位图中的静态表示。

欢迎任何建议。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:48:02.340

许多图形应用程序使用某种[空间分区](http://en.wikipedia.org/wiki/Space_partitioning)来减少他们需要查看的对象数量。例如，如果您移动一个矩形，应用程序在[四叉树](http://en.wikipedia.org/wiki/Quadtree)中查找并找到边界框与移动矩形重叠的 2 或 3 个其他对象。然后它只需要对 2 或 3 个对象而不是 1000 个对象进行完整的碰撞检测和图形处理。

# c - 经历 APR 失败

> ID：13976696
> 
> 赞同：0
> 
> 时间：2012-12-20T16:42:01.320
> 
> 标签：c, epoll, apr

我正在使用 libapr，但它们的一些基本原语似乎无法正常工作，呈现出非常奇怪的行为。这是我正在编写的代码：

```
 pr_pool_t *mp=NULL;
    apr_file_t *fp = NULL;
    apr_pollset_t *pollset=NULL;
    apr_pollfd_t file_fd;

    /*apr initialization*/
    CuAssertIntEquals(ct,0,apr_initialize());
    CuAssertIntEquals(ct,0,apr_pool_create(&mp,NULL));

    /*opens file to test poll*/
    CuAssertIntEquals(ct,0,apr_file_open(&fp, FILENAME,
            APR_FOPEN_WRITE | APR_FOPEN_CREATE | APR_FOPEN_READ,
            APR_FPROT_UREAD|APR_FPROT_UWRITE|APR_FPROT_UEXECUTE , mp));

    /*creates pollset*/
    CuAssertIntEquals(ct,0,apr_pollset_create(&pollset, 10,mp,0));

    /*prepares poll fd...*/
    file_fd.desc_type = APR_POLL_FILE;
    file_fd.reqevents = APR_POLLIN|APR_POLLOUT;
    file_fd.desc.f = fp;
    file_fd.client_data = fp;

    /*adds pollfd to pollset*/
    CuAssertIntEquals(ct,0,apr_pollset_add(pollset, &file_fd)); 
```

一切运行良好，直到我到达 apr_pollset_add(pollset, &file_fd) 失败并返回值 1。

如果分析这个函数的源代码，你会发现它永远不会返回 1。实际上 1 作为系统错误返回，使用 libapr 例程 apr_sterror 将其翻译为：'operation not allowed'。

我几乎没有睡觉和吃饭试图解决这个问题，但没有成功。我真的需要使用这个库。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:58:30.813

我发现了问题。

我正在轮询一个常规文件。常规文件[始终可以读取或写入](https://stackoverflow.com/questions/5603642/epoll-ctl-operation-not-permitted-error-c-program)。

1 对应于调用 poll_ctl 时设置的不允许操作。

# java - @Inject 在 @Named @SessionScoped bean 中的东西

> ID：13976697
> 
> 赞同：2
> 
> 时间：2012-12-20T16:42:09.247
> 
> 标签：java, jakarta-ee, dependency-injection, cdi, managed-bean

也许我变老了，但是......我真的不知道如何在 jsf 托管 bean 控制器中注入业务逻辑类，这是控制器 bean 现在的样子：

```
@Named
@SessionScoped
public class ImportazioneController implements Serializable {

    private static final long serialVersionUID = 1L;

    private String stato;

    private Retriever<Marchio> retriever;

    public ImportazioneController() { }

    @PostConstruct
    public void init() {
        this.stato = "";
        retriever = new WSRetrieverMarchi();
    }
} 
```

我的界面是：

```
public interface Retriever<T> {

    public List<T> retrieve();
} 
```

注入所需的实现是：

```
public class WSRetrieverMarchi implements Retriever<Marchio> {

    @Override
    public List<Marchio> retrieve() {
        // do things...
    }

} 
```

我真的很想@Inject*检索*器，但我不断收到错误。

我知道这也不是 CDI 方式。如果你能用新技术帮助我，我将不胜感激。谢谢你。

# c# - 如何使用 MethodInvoker 委托在 cli c++ 中同步对控件线程的调用

> ID：13976698
> 
> 赞同：1
> 
> 时间：2012-12-20T16:42:16.203
> 
> 标签：c#, c++, visual-studio-2005, command-line-interface

我有 ac# 但代码，我需要它在 cli/c++ 中，但我总是得到这个错误

> “错误 2 错误 C2955：'BaseLibCS::MethodInvoker'：使用类泛型需要泛型参数列表”
> 
> “错误 4 错误 C2664: 'BaseLibCS::MethodInvoker::MethodInvoker(System::String ^,...cli::array ^)' : 无法将参数 1 从 'GetNotifications ^const' 转换为 'System::String ^' "
> 
> “错误 3 错误 C2102：'&' 需要左值”
> 
> “错误 1 ​​错误 C2872：'MethodInvoker'：不明确的符号”

这是我的 C# 代码：

```
private void HandleFarmStateChanged(object sender, ValueChangedEventArgs<CFarm.FarmState> e)
        {
            if (control.InvokeRequired)
            {
                control.Invoke(new MethodInvoker(delegate
                {
                    HandleFarmStateChanged(sender, e);
                }));
                return;
            }

           //FarmStateStatusLabel.Text = e.NewValue.ToString();
            Console.WriteLine(e.NewValue.ToString());
            Console.WriteLine("       ");
        } 
```

这是我的 C++ 代码：

```
void GetNotifications::HandleFarmStateChanged(Object ^sender, ValueChangedEventArgs<CFarm::FarmState> ^e)
{
    if (control->InvokeRequired)
            {
                control->Invoke(gcnew MethodInvoker(this,&GetNotifications::HandleFarmStateChanged(sender, e)));
                //}));
                return;
            }

    Console::WriteLine(e->NewValue.ToString());
    Console::WriteLine("       ");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T14:02:52.193

经过一天的研究，我发现了问题，这是因为 C++/CLI 不支持匿名委托，这是 C# 独有的功能。您需要在类的单独方法中编写委托目标方法。您还需要声明委托类型，MethodInvoker 无法完成这项工作。

想了很多，祝你有美好的一天

# php - 禁用 SonataUserBundle sonata.user.admin.group 服务

> ID：13976700
> 
> 赞同：4
> 
> 时间：2012-12-20T16:42:20.307
> 
> 标签：php, symfony, dependency-injection, fosuserbundle, sonata-admin

我正在使用 SonataAdminBundle 和 SonataUserBundle。

SonataUserBundle 注册了一项服务，该服务`sonata.user.admin.group`由 SonataAdminBundle 自动检测，以在管理仪表板中设置链接以对 CRUD 操作进行分组。

我该如何禁用`sonata.user.admin.group`？我一直在关注 Symfony2 文档中的那些食谱：

*   [如何覆盖捆绑包的任何部分 - 服务和配置](http://symfony.com/doc/master/cookbook/bundles/override.html#services-configuration)

*   [编译容器 - 创建编译器通道](http://symfony.com/doc/master/components/dependency_injection/compilation.html#creating-a-compiler-pass)

*   [使用容器参数和定义](http://symfony.com/doc/master/components/dependency_injection/definitions.html)

到目前为止，我的包定义中有以下代码来添加编译器通道：

```
public function build(ContainerBuilder $container)
{
  parent::build($container);

  $container->addCompilerPass(new CompilerPass());
} 
```

这是编译器传递：

```
<?php

namespace NS\Service\CompilerPass;

use Symfony\Component\DependencyInjection\Compiler\CompilerPassInterface;
use Symfony\Component\DependencyInjection\ContainerBuilder;

class CompilerPass implements CompilerPassInterface
{
    public function process(ContainerBuilder $container)
    {
       $container->removeDefinition('sonata.user.admin.group');
    }
} 
```

I thought that this should work but no. Symfony is throwing an exception telling me that `sonata.user.admin.group` service does not exist. But it exists, and if I do `$container->getDefinition('sonata.user.admin.group')` the actual definition is return.

Thanks

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-20T18:04:01.077

Try marking the service as abstract and set its `public` property to false e.g.

```
#in any services.yml
services:
    sonata.user.admin.group:
      abstract: true
      public: false
    #... 
```

**Addition to completeness:**

And add to the CompilerPass:

```
$container->getDefinition('sonata.user.admin.group')->setSynthetic(true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T16:48:36.673

You've removed the service definition but it's still used on the dashboard. That's why Symfony complains (dashboard tries to access it). It's not an optional service.

You could try to overwrite the dashboard template and avoid using the service? This way service wouldn't be called and you wouldn't have to remove it. If service is not used it's never created.

Alternative would be overloading the service with your implementation.

# groovy - Jira 工作流脚本验证器的返回码

> ID：13976709
> 
> 赞同：2
> 
> 时间：2012-12-20T16:42:56.227
> 
> 标签：groovy, jira

我正在 Groovy 中编写一个工作流验证器，以在创建案例时根据自定义字段值输入来链接两个问题。要求 Jira 问题链接的自定义字段值是唯一的。换句话说，我需要确保只有一个问题具有特定的自定义字段值。如果有多个问题具有输入自定义字段值，则验证应该失败。

我如何或返回什么导致工作流验证器失败？

示例代码：

```
// Set up jqlQueryParser object
jqlQueryParser = ComponentManager.getComponentInstanceOfType(JqlQueryParser.class) as JqlQueryParser
// Form the JQL query
query = jqlQueryParser.parseQuery('<my_jql_query>')
// Set up SearchService object used to query Jira
searchService = componentManager.getSearchService()
// Run the query to get all issues with Article number that match input 
results = searchService.search(componentManager.getJiraAuthenticationContext().getUser(), query, PagerFilter.getUnlimitedFilter())
// Throw a FATAL level log statement because we should never have more than one case associated with a given KB article
if (results.getIssues().size() > 1) {
    for (r in results.getIssues()) {
        log.fatal('Custom field has more than one Jira ssue associated with it. ' + r.getKey() + ' is one of the offending issues')
    }
    return "?????"
}

// Create link from new Improvement to parent issue
for (r in results) {
    IssueLinkManager.createIssueLink(issue.getId(), r.getId(), 10201, 1, getJiraAuthenticationContext().getUser())
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T10:04:07.447

尝试类似的东西

```
import com.opensymphony.workflow.InvalidInputException
invalidInputException = new InvalidInputException("Validation failure") 
```

这是基于[groovy 脚本运行](https://marketplace.atlassian.com/plugins/com.onresolve.jira.groovy.groovyrunner)器的。如果它不适合您，我建议您使用某种框架来简化脚本编写，我喜欢使用[groovy 脚本运行](https://marketplace.atlassian.com/plugins/com.onresolve.jira.groovy.groovyrunner)器、[Jira Scripting Suite](https://marketplace.atlassian.com/plugins/com.quisapps.jira.jss)或[Behaviors Plugin](https://plugins.atlassian.com/plugins/com.onresolve.jira.plugin.Behaviours) 。所有这些确实使脚本编写更容易、更直观。

# asp.net - 没有默认构造函数的 ActionResult 参数

> ID：13976716
> 
> 赞同：3
> 
> 时间：2012-12-20T16:43:32.247
> 
> 标签：asp.net, asp.net-mvc, viewmodel

显然有很多方法可以做到这一点，但我想我会要求对这些方法的优缺点提供一些反馈。

首先，NerdDinner 教程的 Edit Action 的形式是（比如 Form A）：

```
[HttpPost]
public ActionResult Edit(int id, FormCollection collection) { 
```

在我看来，如果你很好地塑造你的 ViewModel 以匹配你的观点，那么 Form B 的方法：

```
[HttpPost]
public ActionResult Edit(MyViewModel mvm) { 
```

似乎是一种更好，更清洁的方法。然后，我只需将 VM 属性映射到模型属性并保存。但是，如果此 ViewModel 中嵌入了其他通过构造函数初始化的实体（例如在 nerddinner 教程中），那么如果没有默认构造函数并且您必须使用第一种方法，则此编辑操作将失败。

那么，第一个问题是您是否同意通常 B 型通常更好？有缺点吗？

其次，如果使用 Form B，那么装饰器类型验证似乎需要在 ViewModel 中。在 ViewModel 中嵌入实体并仅在实体级别进行验证是否有优势？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:21:47.263

这是一个非常普遍的问题。

> 第一个问题是您是否同意通常形式 B 通常更好？

我唯一不使用*表格 B*的时候是我上传文件的时候。否则，我不相信任何人都应该需要使用*Form A*。我认为人们使用*Form A*的原因是对 ASP.Net 版本的 MVC 的能力缺乏了解。

> 其次，如果使用 Form B，那么装饰器类型验证似乎需要在 ViewModel 中。

排序/它取决于。我给你举个例子：

```
public IValidateUserName
{
  [Required]
  string UserName { get; set; }
}

public UserModel
{
  string UserName { get; set; }
}

[MetadataType(typeof(IValidateUserName))]
public UserValiationModel : UserModel
{
} 
```

验证装饰器位于接口中。我在派生类上使用 MetadataType 来验证派生类型。我个人喜欢这种做法，因为它允许可重复使用的验证，并且 MetadataType/Validation 不是 ASP.NET 核心功能的一部分，因此它可以在 ASP.Net (MVC) 应用程序之外使用。

> 在 ViewModels 中嵌入实体是否有优势..

是的，我尽我最大的努力从不将基本模型传递给视图。这是我不做的一个例子：

```
public class person { public Color FavoriteColor { get; set; } }

ActionResult Details()
{
  Person model = new Person();
  return this.View(model);
} 
```

当您想将更多数据传递给您的视图（对于部分或布局数据）时会发生什么？大多数情况下，该信息与 Person 无关，因此将其添加到 Person 模型是没有意义的。相反，我的模型通常看起来像：

```
public class DetailsPersonViewModel()
{
  public Person Person { get; set; }
}

public ActionResult Details()
{
  DetailsPersonViewModel model = new DetailsPersonViewModel();
  model.Person = new Person();
  return this.View(model);
} 
```

现在，我可以添加`DetailsPersonViewModel`该视图所需的数据，超出了 Person 知道的范围。例如，假设这将显示一个包含所有颜色的 for 供 Person 选择收藏夹。所有可能的颜色都不是人的一部分，也不应该是人模型的一部分，所以我将它们添加到 DetailPersonViewModel。

```
public class DetailsPersonViewModel()
{
  public Person Person { get; set; }
  public IEnumerable<Color> Colors { get; set; }
} 
```

> ..并仅在实体级别进行验证？

`System.ComponentModel.DataAnnotations`并非旨在验证属性的属性，因此请执行以下操作：

```
public class DetailsPersonViewModel()
{
  [Required(property="FavoriteColor")]
  public Person Person { get; set; }
} 
```

不存在也没有意义。为什么 ViewModel 不应该包含对需要验证的实体的验证。

> 如果没有默认构造函数，则此编辑操作将失败，您必须使用第一种方法。

正确，但是为什么 ViewModel 中的 ViewModel 或 Entity 没有无参数构造函数？听起来像是一个糟糕的设计，即使对此有一些要求，也可以通过 ModelBinding 轻松解决。这是一个例子：

```
// Lets say that this person class requires 
// a Guid for a constructor for some reason
public class Person
{
  public Person(Guid id){ }
  public FirstName { get; set; }
}

public class PersonEditViewModel
{
  public Person Person { get; set; }
}

public ActionResult Edit()
{
  PersonEditViewModel model = new PersonEditViewModel();
  model.Person = new Person(guidFromSomeWhere);

  return this.View(PersonEditViewModel);
}

//View 
@Html.EditFor(m => m.Person.FirstName)

//Generated Html
<input type="Text" name="Person.FirstName" /> 
```

现在我们有了一个用户可以输入新名字的表单。我们如何取回这个构造函数中的值？很简单，ModelBinder 不关心它绑定到什么模型，它只是将 HTTP 值绑定到匹配的类属性。

```
[MetadataType(typeof(IPersonValidation))]
public class UpdatePerson
{
  public FirstName { get; set; }
}  

public class PersonUpdateViewModel
{
  public UpdatePerson Person { get; set; }
}

[HttpPost]
public ActionResult Edit(PersonUpdateViewModel model)
{
  // the model contains a .Person with a .FirstName of the input Text box
  // the ModelBinder is simply populating the parameter with the values
  // pass via Query, Forms, etc

  // Validate Model

  // AutoMap it or or whatever

  // return a view
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T17:03:34.213

我还没有看过 NerDinner 项目，但是，我通常会尽量避免在操作的 POST 中使用 ViewModel，而是只提交“表单”的元素。

例如，如果 ViewModel 有一个 Dictionary 用于某种下拉列表，则不会提交整个下拉列表，只会提交选定的值。

我的一般做法是：

```
[HttpGet]
public ActionResult Edit(int id) 
{
     var form = _service.GetForm(id);

     var pageViewModel = BuildViewModel(form);

     return View(pageViewModel);
}

[HttpPost]
public ActionResult Edit(int id, MyCustomForm form) 
{
     var isSuccess = _service.ProcessForm(id);    

      if(isSuccess){
         //redirect
      }

      //There was an error. Show the form again, but preserve the input values
      var pageViewModel = BuildViewModel(form);

      return View(pageViewModel);
}

private MyViewModel BuildViewModel(MyCustomForm form)
{
     var viewModel = new MyViewModel();

     viewModel.Form = form;
     viewModel.StateList = _service.GetStateList();

    return viewModel;
} 
```

# antlr - ANTLR 中复杂的 AST 重写规则

> ID：13976717
> 
> 赞同：2
> 
> 时间：2012-12-20T16:43:36.583
> 
> 标签：antlr, antlrworks

[在 antlr 中使用“* +”的](https://stackoverflow.com/questions/13965243/ast-rewrite-rule-with-in-antlr)AST rewrite rule with devide group 技术的 AST rewrite rule 问题之后。

我在 ANTLR 中生成 AST 时遇到了麻烦，再次 :)。这是我的 antlr 代码：

```
start   :   noun1+=n (prep noun2+=n (COMMA noun3+=n)*)*
        ->  ^(NOUN $noun1) (^(PREP prep) ^(NOUN $noun2) ^(NOUN $noun3)*)*
    ;
n       :    'noun1'|'noun2'|'noun3'|'noun4'|'noun5';
prep    :    'and'|'in';
COMMA   :     ','; 
```

现在，输入：“名词1和名词2，名词4中的名词3，名词5”，我得到了以下意想不到的AST：

![在此处输入图像描述](../Images/4a71544d6fd46a6e8b8f0e6194b39cca.png)

与 ANLRwork 中的“解析树”比较：

![在此处输入图像描述](../Images/0af9646e8ec3d03f20707e34ccc228b3.png)

我认为**$noun3**变量包含“COMMA noun3+=n”中所有“n”的列表。因此，AST 解析器 ^(NOUN $noun3)* 将绘制所有“n”，而不会区分哪个“n”实际上属于“prep”。

有什么方法可以在***"(^(PREP prep) ^(NOUN $noun2) ^(NOUN $noun3)* ) *"***中进行分离。我想要做的就是 AST 必须在 ANTLRwork 中使用“解析树”准确地绘制，没有标记 COMMA。

感谢帮助 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T18:18:26.983

如果你打破`start`规则，得到你想要的分离是最容易的。这是一个示例（没有将`COMMA`s 写入 AST）：

```
start   :   prepphrase             //one prepphrase is required.
            (COMMA! prepphrase)*   //"COMMA!" means "match a COMMA but don't write it to the AST"
        ;

prepphrase: noun1=n                //You can use "noun1=n" instead of "noun1+=n" when you're only using it to store one value
            (prep noun2=n)? 
            -> ^(NOUN $noun1) ^(PREP prep)? ^(NOUN $noun2)?
        ; 
```

A`prepphrase`是一个名词，后面可以跟一个介词和另一个名词。该`start`规则查找逗号分隔`prepphrase`的 s。

输出看起来像解析树图像，但没有逗号。

* * *

如果您更喜欢使用 明确地写出 AST，`->`或者如果您不喜欢类似 的语法`COMMA!`，则可以改为这样编写`start`规则。这两种不同的形式在功能上是等效的。

```
start   :   prepphrase             //one prepphrase is required.
            (COMMA prepphrase)*
            -> prepphrase+         //write each prepphrase, which doesn't include commas
        ; 
```

# html - 为什么Outlook会删除我的图像之间的空格

> ID：13976723
> 
> 赞同：1
> 
> 时间：2012-12-20T16:43:54.583
> 
> 标签：html, image, outlook, spaces

我有 4 个小图像水平排列，如下所示

```
 <span style="font-size: 10.0pt; font-family: Verdana, Tahoma, Geneva, sans-serif; color: gray">
        <a href="image link"><img src="image source"></a>
        <a href="image link"><img src="image source"></a>
        <a href="image link"><img src="image source"></a>
        <a href="image link"><img src="image source"></a><br /> </span> 
```

当我运行代码时，浏览器会显示这些图像，它们之间有正确的空间，但如果我使用 Outlook 运行代码测试它，图像之间没有间距。我知道这是一个前景问题，但有没有办法解决这些问题，我尝试为每个图像添加填充样式和边距，但这无济于事。我怎样才能解决这个问题在这些图像之间添加空格。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T16:47:59.690

Outlook 倾向于忽略大部分 CSS 以及您放入“样式”属性的几乎所有内容，因此您最可靠的选择是插入   （不间断空间）图像之间的实体。

# prolog - prolog中的小型专家系统

> ID：13976733
> 
> 赞同：6
> 
> 时间：2012-12-20T16:44:43.337
> 
> 标签：prolog, artificial-intelligence, expert-system

我正在使用 prolog 为动物分类做这个专家系统，我正在使用 GNU/Prolog 和 Debian GNU/Linux。

```
xpositive(symbol,symbol)
xnegative(symbol,symbol)

nondeterm animal_is(symbol)
nondeterm it_is(symbol)
ask(symbol,symbol,symbol)
remember(symbol,symbol,symbol)
positive(symbol,symbol)
negative(symbol,symbol)
clear_facts
run

animal_is(cheetah):-
    it_is(mammal),
    it_is(carnivore),
    positive(has,tawny_color),
    positive(has,dark_spots).

animal_is(tiger):-
    it_is(mammal),
    it_is(carnivore),
    positive(has, tawny_color),
    positive(has, black_stripes).

animal_is(giraffe):-
    it_is(ungulate),
    positive(has,long_neck),
    positive(has,long_legs),
    positive(has, dark_spots).

animal_is(zebra):-
    it_is(ungulate),
    positive(has,black_stripes).

animal_is(ostrich):-
    it_is(bird),
    negative(does,fly),
    positive(has,long_neck),
    positive(has,long_legs),
    positive(has, black_and_white_color).

animal_is(penguin):-
    it_is(bird),
    negative(does,fly),
    positive(does,swim),
    positive(has,black_and_white_color).

animal_is(albatross):-
    it_is(bird),positive(does,fly_well).

it_is(mammal):-
    positive(has,hair).
it_is(mammal):-
    positive(does,give_milk).

it_is(bird):-
    positive(has,feathers).
it_is(bird):-
    positive(does,fly),
    positive(does,lay_eggs).

it_is(carnivore):-
    positive(does,eat_meat).

it_is(carnivore):-
    positive(has,pointed_teeth),
    positive(has, claws),
    positive(has,forward_eyes).

it_is(ungulate):-
    it_is(mammal),
    positive(has,hooves).

it_is(ungulate):-
    it_is(mammal),
    positive(does,chew_cud).

positive(X,Y):-
    xpositive(X,Y),!.
positive(X,Y):-
    not(xnegative(X,Y)),
    ask(X,Y,yes).

negative(X,Y):-
    xnegative(X,Y),!.
negative(X,Y):-
    not(xpositive(X,Y)),
    ask(X,Y,no).

ask(X,Y,yes):-
    !,
    write(X," it ",Y,'\n'),
    readln(Reply),nl,
    frontchar(Reply,'y',_),
    remember(X,Y,yes).
ask(X,Y,no):-
    !,
    write(X," it ",Y,'\n'),
    readln(Reply),nl,
    frontchar(Reply,'n',_),
    remember(X,Y,no).

remember(X,Y,yes):-
    assertz(xpositive(X,Y)).
remember(X,Y,no):-
    assertz(xnegative(X,Y)).

clear_facts:-
    write("\n\nPlease press the space bar to exit\n"),
    retractall(_,dbasedom),readchar(_).

run:-
    animal_is(X),!,
    write("\nYour animal may be a (an) ",X),
    nl,nl,clear_facts.
run:-
    write("\nUnable to determine what"),
    write("your animal is.\n\n"),
    clear_facts.

run. 
```

我有这个程序的问题。我编译程序，但收到一条错误消息：

```
GNU Prolog 1.3.0
By Daniel Diaz
Copyright (C) 1999-2007 Daniel Diaz
| ?- [system].
compiling /root/Dokumenty/Lab/Expert/system.pl for byte code...
/root/Dokumenty/Lab/Expert/system.pl:2:1: syntax error: . or operator expected after > expression
        1 error(s)
compilation failed 
```

我正在尝试解决我的问题，但我仍然收到错误消息：

```
xpositive(symbol,symbol).
xnegative(symbol,symbol).

nondeterm animal_is(symbol)
nondeterm it_is(symbol)
ask(symbol,symbol,symbol)
remember(symbol,symbol,symbol)
positive(symbol,symbol)
negative(symbol,symbol)
clear_facts
run 
```

错误信息：

```
| ?- [system].
compiling /root/Dokumenty/Lab/Expert/system.pl for byte code...
/root/Dokumenty/Lab/Expert/system.pl:4:11: syntax error: . or operator expected after expression
    1 error(s)
compilation failed 
```

提前谢谢你的帮助

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T17:24:47.433

您正在使用来自 WinProlog（以前是 TurboProlog）的源代码。

只需删除所有这些声明，即那些没有结束点的行（直到运行，包括在内）。Prolog 中不需要。

您还需要重命名 write 调用，或者为简单起见，在参数周围添加方括号，以使它们成为 arity 1。例如：

```
...
write([X," it ",Y,'\n']),
... 
```

然后你会打电话

```
?- run. 
```

在控制台上。

# html - 如何创建具有固定标题的滚动表

> ID：13976743
> 
> 赞同：0
> 
> 时间：2012-12-20T16:45:26.363
> 
> 标签：html, css, html-table

> **可能重复：**
> [带有固定标题的 HTML 表格？](https://stackoverflow.com/questions/673153/html-table-with-fixed-headers)

我想知道在这里为这个小提琴创建带有固定标题的滚动表的最佳方法是：http: [//jsfiddle.net/LKB9e/9/](http://jsfiddle.net/LKB9e/9/)

我不想要单独的表头和表体，我希望列保持匹配。

有人可以让我的小提琴工作来匹配这个吗？

要使用小提琴，只需单击演示中的“添加问题”按钮，它将继续将行附加到下表中。

目前表格正在滚动，没有固定的标题，这是通过以下方式完成的：

```
#details{
    height:500px;
    overflow:auto;
} 
```

下面是源代码：

HTML表格：

```
<table id="questionBtn" align="center">
<tr>
    <th> <input id="addQuestionBtn" name="addQuestion" type="button" value="Add Question" onClick="insertQuestion(this.form)" /></th>
</tr>
</table>
</div>
<hr/>
<table id="qandatbl" align="center">
<thead class="tblhead">
    <tr>
        <th></th>
        <th class="qid">Question No</th>
        <th class="question">Question</th>
        <th class="optandans">Option and Answer</th>
        <th class="noofreplies">Number of Replies</th>
        <th class="weight">Number of Marks</th>
        <th class="image">Image</th>
        <th class="video">Video</th>
        <th class="audio">Audio</th>
    </tr>
</thead>
<tbody class="tblbody"></tbody>
</table> 
```

下面是 javascript 代码，它将行附加到上面的 html 表中：

```
function insertQuestion(form) {   

    var $tbody = $('#qandatbl > tbody'); 
    var $tr = $("<tr class='optionAndAnswer' align='center'>");
    var $td = $("<td class='extratd'>");
    var $plusrow = $("<td class='plusrow'></td>");
    var $qid = $("<td class='qid'></td>").text(qnum);
    var $question = $("<td class='question'></td>");
    var $noofanswers = $("<div class='noofanswers'>2\. Number of Answers:<br/></div>");
    var $options = $("<div class='option'>1\. Option Type:<br/></div>");
    var $answer = $("<div class='answer'>3\. Answer:<br/></div>");
    var $replies = $("<td class='noofreplies'><div class='wrapper'></div></td>");
    var $weight = $("<td class='weight'></td>");
    var $image = $("<td class='image'></td>"); 
    var $video = $("<td class='video'></td>");
    var $audio = $("<td class='audio'></td>");

    $tr.append($plusrow);
    $tr.append($qid);
    $tr.append($question);
    $tr.append($td);
    $td.append($options);
    $td.append($noofanswers);
    $td.append($answer);
    $tr.append($replies);
    $tr.append($weight);   
    $tr.append($image);  
    $tr.append($video);
    $tr.append($audio);
    $tbody.append($tr);    

} 
```

下面是css：

```
 /*css for QandATable.php*/
body{
    font-size:85%;    
}            

#qandatbl{
    border:1px black solid;
    border-collapse:collapse;
}

#qandatbl td { 
    vertical-align: middle;
}

#qandatbl th{
    border:1px black solid;
    border-collapse:collapse;
    text-align:center;
}

.tblhead, .tblbody {
    display: block;
}

.tblbody{
    height: 500px;
    overflow: auto;
    width:100%;    
}

.extratd{
    border:1px black solid;
    border-collapse:collapse;
}

.qid { 
    min-width:3%;
    max-width:3%;
    font-weight:bold;
    border:1px black solid;
    border-collapse:collapse;
}

.question { 
    min-width:25%;
    max-width:25%;
    border:1px black solid;
    border-collapse:collapse;
}

.noofanswers{
    min-width:100%;
    max-width:100%;
    padding-top:5%;
    padding-bottom:5%;
}

.noofreplies{
    min-width:3%;
    max-width:3%;
    border:1px black solid;
    border-collapse:collapse;
}

.optandans{
    min-width:30%;
    max-width:30%;
    border:1px black solid;
    border-collapse:collapse;
}

.option{
    min-width:100%;
    max-width:100%;
    padding-top:5%;
    padding-bottom:5%;
}

.weight { 
    min-width:3%;
    max-width:3%;
    border:1px black solid;
    border-collapse:collapse;
    }

.answer { 
    min-width:100%;
    max-width:100%;
    padding-top:5%;
    padding-bottom:5%;
     }

.audio{
    min-width:11%;
    max-width:11%;
    border:1px black solid;
    border-collapse:collapse;
    }

.video{
    min-width:11%;
    max-width:11%;
    border:1px black solid;
    border-collapse:collapse;
    }

.image{
    min-width:11%;
    max-width:11%;
    border:1px black solid;
    border-collapse:collapse;
    position:relative;
    }

.plusrow{
    min-width:2%;
    max-width:2%;
    border:1px black solid;
    border-collapse:collapse;
    } 
```

更新：

我尝试创建一个带有固定标题的滚动表，但问题是列不匹配：http: [//jsfiddle.net/heA2b/1/](http://jsfiddle.net/heA2b/1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T15:53:35.923

以下是一些使用不同方法的示例：
jsfiddle.net/FeU3T/2/
[http://www.imaputz.com/cssStuff/bigFourVersion.html](http://www.imaputz.com/cssStuff/bigFourVersion.html)
[http://imar.spaanjaars.com/357/a-scrollable-table-带有固定标题](http://imar.spaanjaars.com/357/a-scrollable-table-with-a-fixed-header)

# c++ - 使用由“.h”、“.lib”和“.dll”文件组成的第三方库

> ID：13976745
> 
> 赞同：4
> 
> 时间：2012-12-20T16:45:25.240
> 
> 标签：c++, dll, header, include, .lib

所以目前我正在尝试使用 National Intruments 和 IVI Foundation 的 VISA 库来读取/写入各种外部设备的命令。

我对我的 IDE 比较陌生：Microsoft Visual C++ Express 2010，这是我第一次尝试使用需要超过 .h 导入的第三方库。

基本上我有一个包含 3 个头文件的目录、一个包含 3 个 .lib 库的目录和一个包含 7 个 DLL 的目录。他们没有关于任何单个文件的功能的文档，只有整个库。因此，我需要能够获取与我的项目相关联的所有这些文件。

目前我已经在我的头文件中导入了所有头文件，并将头目录添加到项目属性中的包含目录中。我还将包含 .lib 文件的目录添加到项目属性中的库目录中。我假设 .lib 文件将链接到 DLL，但显然情况并非如此，因为我收到了错误：

> VISA 控制台 2.obj：错误 LNK2019：函数 _wmain 中引用的未解析外部符号 _viOpenDefaultRM@4

使用库中的任何函数时会发生此错误。这是我目前的代码：

```
#include "stdafx.h"

int _tmain(int argc, _TCHAR* argv[])
{
    ViStatus status;
    ViSession defaultRM, instr;

    status = viOpenDefaultRM(&defaultRM);

    return 0;
} 
```

该项目将在我注释掉 viOpenDefaultRM 命令时构建，因此我假设这意味着我可以使用库中的对象而不是命令。因为我有 3 个构建得很好的对象声明。

好的，这是我所有的信息，希望有人可以提供帮助，希望这对其他人有帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T16:53:32.377

除了将 .lib 文件的目录添加到库目录属性之外，您还需要添加链接器应该搜索的实际库。

将库添加到项目的

```
 Configuration Properties | Linker | Input | Additional Dependencies 
```

场地。

DLL 对于构建过程不是必需的，但要运行程序，它们应该位于程序文件中的目录`PATH`或与程序文件相同的目录中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T16:53:50.653

您是否在项目属性中添加了额外的依赖项？

在“Linker->Input”下找到“Additional Dependecies”并将你从中获得的库放在那里

# c++ - 允许 operator= 仅在同一类的对象之间使用？

> ID：13976748
> 
> 赞同：3
> 
> 时间：2012-12-20T16:45:35.863
> 
> 标签：c++, inheritance, assignment-operator, private-methods, object-slicing

我有一个类层次结构，我想禁止这样做：

```
Foo *f = new Foo();
Bar *b = new Bar();

f = b; 
```

`Foo`的超类在哪里`Bar`。这样做会切开`Bar`对象的一部分。我知道您可以通过将`operator=`其设为私有来解决此问题，但是是否可以仅禁止使用不同类型的赋值运算符？

就像`operator=`私有化但仍然允许这样做：

```
Bar *b1 = new Bar();
Bar *b2 = new Bar();

b1 = b2; 
```

假设子类也将被制作`Bar`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T16:51:21.767

既然你在谈论切片，我假设你实际上试图阻止的是：

```
Foo f;
Bar b;

f = b; 
```

在这种情况下，是的，您可以通过将适当的 operator= 设为私有来阻止分配。

您不能阻止指针分配，但请注意，指针分配无论如何都不会导致切片。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T16:50:55.703

这超出了您的能力范围：用户定义的运算符必须至少采用一个用户定义（非内置）类型的参数。由于指针是内置类型，所以你在这里不走运。`f = b`不管你做什么都是合法的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T17:12:28.347

在您的示例中不会发生切片：

```
Foo *f = new Foo();
Bar *b = new Bar();

f = b; 
```

您正在分配指针，而不是值。f 指针和 b 指针的大小相同（您正在运行的体系结构上的指针大小），因此它们将始终彼此适合而无需切片。对象本身不受此分配的影响，也不会被切片。

但这会导致 'new Foo()' 泄漏。分配后，f 和 b 都将指向“new Bar()”，并且您将没有指向“new Foo()”的指针，您可以使用它来删除它。

我可以建议您使用 std::unique_ptr 而不是原始指针。这将为您删除。

```
std::unique_ptr<Foo> newInstance()
{
    return new Foo();
} 
```

# regex - 轻松解决复杂任务

> ID：13976752
> 
> 赞同：4
> 
> 时间：2012-12-20T16:46:02.073
> 
> 标签：regex, bash

我很好奇这个看似复杂的任务是否有一个简单的解决方案：

假设我有这个文件：

```
lineone
linetwo
linethree
linefour

lineone
linetwo
linethree
linefour

lineone
lineone
lineone
linetwo
linethree
linefour 
```

您是否可以想到一种简单的方法来获得此结果：

```
lineone[1]
linetwo[1]
linethree[1]
linefour[1]

lineone[2]
linetwo[2]
linethree[2]
linefour[2]

lineone[3]
lineone[4]
lineone[5]
linetwo[3]
linethree[3]
linefour[3] 
```

简而言之，是否有一个简单的 bash 算法可以让我按照在文件中出现的顺序对每一行进行编号？如果没有一些涉及额外存储的复杂解决方案，我无法找到一种方法，而且我用于换行的常用命令在这里毫无用处。sed 只会用相同的值替换所有出现的行，而字符串替换（ ${string/substring/replace} ）对我没有帮助，因为它不会保持行的顺序。

非常感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:55:09.563

以下`awk`命令通过保留行数组及其计数来工作。

```
awk '{if($0~/./){a[$0]++;print $0"["a[$0]"]";} else print}' file 
```

例子：

```
$ cat file
lineone
linetwo
linethree
linefour

lineone
linetwo
linethree
linefour

lineone
linetwo
linethree
linefour

lineone
lineone
lineone
linetwo
linethree
linetwo

$ awk '{if($0~/./){a[$0]++;print $0"["a[$0]"]";} else print}' file
lineone[1]
linetwo[1]
linethree[1]
linefour[1]

lineone[2]
linetwo[2]
linethree[2]
linefour[2]

lineone[3]
linetwo[3]
linethree[3]
linefour[3]

lineone[4]
lineone[5]
lineone[6]
linetwo[4]
linethree[4]
linetwo[5] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T17:20:59.727

一个快速的 100% 纯 bash 答案：

```
#!/bin/bash

declare -A lines=()
while read -r l; do
    if [[ -n "$l" ]]; then
        echo "$l[$((++lines[$l]))]"
    else
        echo "$l"
    fi
done < file.txt 
```

根据需要，这是一个*简单的 bash 算法，它可以让 [您] 按照在文件中出现的顺序对每个 [非空] 行进行编号*。

这不是最快的方法（`awk`答案更快更有效，但`awk`答案不是*bash 算法*）。

诀窍是使用关联数组`lines`，其键是文件的行，并在每次读取非空行时递增相应键的值。

或单线以打动您的祖母：

```
declare -A lines=(); while read -r l; do [[ -n "$l" ]] && echo "$l[$((++lines[$l]))]"; || echo "$l"; done < file.txt 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-20T21:17:34.650

一个神秘的 Perl 单线：

```
perl -00 -lpe 's/$/"[". $. . "]"/gem' 
```

* * *

我看到我根据模棱两可的例子误解了这个问题。这是 Perl 代码段，用于对所描述的行进行编号：

```
perl -lpe '/\S/ and $_ .= "[" . ++$n{$_} . "]"' 
```

# mysql - 在 MySql 存储过程中解析 Comma(,) 字符串

> ID：13976754
> 
> 赞同：0
> 
> 时间：2012-12-20T16:46:06.413
> 
> 标签：mysql, sql, string, type-conversion

存储过程：

```
CREATE PROCEDURE lead_to_loan(xReffID_list text) 
```

我想`xReffID_list`在 select 语句中使用这个变量作为

```
SELECT * FROM XXXX where xreffID IN (xReffID_list); 
```

但 xreffID 是一个`int`变量

如何在变量 的条件中 使用`xReffID_list text`逗号分隔的数字字符串？`IN``int`

存储过程：

```
DELIMITER $$ 
DROP PROCEDURE IF EXISTS lead_to_loan$$ 
CREATE PROCEDURE lead_to_loan(XRefID_list text) 
BEGIN 

DECLARE loanCount int(11) default 0;
DECLARE matchCount int(11) default 0;
DECLARE loan_XRefID int(11); 
DECLARE loan_LEADS360ID int(11); 
DECLARE loan_email varchar(100); 
DECLARE loan_phone varchar(30); 
DECLARE loan_cellphone varchar(20); 
DECLARE loan_workphone varchar(20); 
DECLARE loan_closeDate datetime;
DECLARE loan_FundedDate datetime;

DECLARE lead_id int(11);
DECLARE lead_RefId varchar(100); 
DECLARE lead_Email varchar(100); 
DECLARE lead_DayPhone varchar(50); 
DECLARE lead_EveningPhone varchar(20); 
DECLARE lead_Cellphone varchar(20); 
DECLARE lead_DateAdded  varchar(30);

DECLARE done boolean default false;
DECLARE startTime datetime;

DECLARE cursor_loanDetail CURSOR FOR
    SELECT XRefID,LEADS360ID,email,phone,cellphone,workphone,closeDate,FundedDate 
        FROM fsbcorponline.view_loandetail where find_in_set(XRefID, XRefID_list) > 0;

DECLARE cursor_loanMatchLeads CURSOR FOR
SELECT id,RefId,Email,DayPhone,EveningPhone,Cellphone,DateAdded 
            FROM fsbcorponline.leads360leads 
            WHERE RefId !="" AND RefId IS NOT NULL AND  RefId =loan_LEADS360ID AND loan_LEADS360ID>0 OR
            Email !="" AND Email IS NOT NULL AND Email =loan_email OR
            DayPhone !="" AND DayPhone IS NOT NULL AND DayPhone = loan_workphone OR
            EveningPhone !="" AND EveningPhone IS NOT NULL AND EveningPhone= loan_phone OR  
            Cellphone !="" AND Cellphone IS NOT NULL AND Cellphone =loan_cellphone;

DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;

set startTime = now();

    OPEN cursor_loanDetail;
    cursor_loanDetail_loop: loop
        fetch cursor_loanDetail into loan_XRefID,loan_LEADS360ID,loan_email,loan_phone,loan_cellphone,loan_workphone,loan_closeDate,loan_FundedDate;
        if done then
            set done = false;
            leave cursor_loanDetail_loop;
        END if;
        SET loanCount = loanCount+1;

            OPEN cursor_loanMatchLeads;
            cursor_loanMatchLeads_loop: loop
                fetch cursor_loanMatchLeads into lead_id,lead_RefId,lead_Email,lead_DayPhone,lead_EveningPhone,lead_Cellphone,lead_DateAdded;
                if done then
                    set done = false;
                    leave cursor_loanMatchLeads_loop;
                END if;

            SET matchCount = matchCount+1;
            INSERT INTO `fsbcorponline`.`leads_to_loan`(`lead_id`,`lead_RefId`,`lead_Email`,`lead_DayPhone`,`lead_EveningPhone`,`lead_Cellphone`,`lead_DateAdded`,`loan_XRefID`,`loan_LEADS360ID`,`loan_email`,`loan_phone`,`loan_cellphone`,`loan_workphone`,`loan_closeDate`,`loan_FundedDate`)
                   VALUES(lead_id,lead_RefId,lead_Email,lead_DayPhone,lead_EveningPhone,lead_Cellphone,lead_DateAdded,loan_XRefID,loan_LEADS360ID,loan_email,loan_phone,loan_cellphone,loan_workphone,loan_closeDate,loan_FundedDate)
                    ON duplicate key update loan_updateCount = loan_updateCount +1 ;
            leave cursor_loanMatchLeads_loop;
            END loop cursor_loanMatchLeads_loop;
            CLOSE cursor_loanMatchLeads;

    END loop cursor_loanDetail_loop;
    close cursor_loanDetail;
INSERT INTO `fsbcorponline`.`log`(`processName`,`pageName`,`path`,`status`,`note`,`processStartTime`,`processEndTime`)
VALUES('Store Procedure','Lead_to_Loan','Database','1',CONCAT('Loan Matches ',matchCount,' of total ',loanCount),startTime,now());
END$$ 
DELIMITER ; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:50:26.267

您可以使用它`find_in_set`来执行此操作：

```
SELECT * FROM XXXX WHERE find_in_set(xreffID, xreffID_list) > 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T16:49:08.140

嘿，您可以使用 Mysql 提供的 cast() 函数

[http://dev.mysql.com/doc/refman/5.0/en/cast-functions.html#function_cast](http://dev.mysql.com/doc/refman/5.0/en/cast-functions.html#function_cast)

希望这会帮助你。

# javascript - 你如何删除javascript中的自定义事件？

> ID：13976756
> 
> 赞同：3
> 
> 时间：2012-12-20T16:46:14.403
> 
> 标签：javascript, events

这是我创建有效的自定义事件的代码：

```
var evt = document.createEvent("Event"); //creat custom event
evt.initEvent("fac_sel", true, true); //initialize the event
evt.objIndex = "some test data"; //add custom data
document.dispatchEvent(evt); //fire event! 
```

由于某种原因，以下代码导致“未定义”

```
document.removeEventListener("Event","fac_sel", true); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T16:49:58.980

addEventListener 和 removeEventListener 方法不返回任何内容。因此，调用`document.removeEventListener("Event", "fac_sel", true)`将在调试器中显示为未定义或分配`undefined`给变量。

查看[MDN 上的 removeEventListener 方法以](https://developer.mozilla.org/en-US/docs/DOM/element.removeEventListener)获取更多信息。

# java - Java 序列化数据不匹配

> ID：13976758
> 
> 赞同：1
> 
> 时间：2012-12-20T16:46:22.640
> 
> 标签：java, sockets, inheritance, serialization

我正在通过 ServerSocket/Socket 使用 Java SE 7 创建一个简单的聊天程序。我想知道从客户端到服务器或反之亦然发送的模型/实体中的数据是否可能不匹配？因此，当我发送具有不同包含数据的相同类类型时，我从客户端的发送模型到其服务器的数据不匹配。

```
Example
Client: Sending...  ID: 3
Server: Received... ID: 3
Client: Sending...  ID: 4
Server: Recieved... ID: 3 
```

这是我的模型/实体的通用范例：

```
abstract class Record<T> extends Observable implements Serializable {
   // with generated "serialVersionUID" by the EclipseIDE[Juno]
   protected int id;
   // Constructor, Getters/Setters, Abstract methods
   // hashCode(): Generated by Eclipse
   // equals(): Generated by Eclipse, replacing Record with Record<T>
}
abstract class RecordVersion<T> extends Record<T> implements Serializable {
   // with generated "serialVersionUID" by the EclipseIDE[Juno]
   protected int version;
   // Constructor, Getters/Setters, Abstract methods
   // hashCode(): Generated by Eclipse
   // equals(): Generated by Eclipse, replacing RecordVersion with RecordVersion<T>
}
class SampleRecord extends RecordVersion<SampleRecord> {
   // with generated "serialVersionUID" by the EclipseIDE[Juno]
   private String data;
   // Constructor, Getters/Setters, Abstracted methods
   // hashCode(): Generated by Eclipse
   // equals(): Generated by Eclipse
} 
```

任何想法如何解决这个问题？谢谢。

更新 1：

读取`socket.getInputStream()`通路`java.io.ObjectInputStream`

```
class ReadRunnable implements Runnable {
  private Object lastObjectReceived = new Object();
  @Override
  public void run() {
    while(true) {
       try {
         // inStream: java.io.ObjectInputStream
         Object objectReceived = inStream.readObject();       
         if(objectReceived .equals(lastObjectReceived ))
           objectReceived = inStream.readObject();
         else
           lastObjectReceived = objectReceived;
       } catch(Exception e) {
         ex.printStackTrace();
       }
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T18:17:32.607

如果您试图通过同一个 ObjectOutputStream 多次发送同一个对象实例，您将会遇到问题，因为对象流保留了对象身份。为了用新数据重新发送相同的对象实例，您需要`ObjectOutputStream.reset()`在两者之间调用。

Also, in your loop you are "losing" one of the objects sent. the first branch of your `if` block calls `.readObject()`, and then the beginning of your while loop calls `.readObject()` again, discarding the result of the previous call before comparing it.

# c# - 单元测试组合根源？

> ID：13976760
> 
> 赞同：3
> 
> 时间：2012-12-20T16:46:28.753
> 
> 标签：c#, unit-testing, dependency-injection, prism

我有一个 PRISM 应用程序，它由几个模块（IModule）组成，其中引导程序将每个模块传递给 DI 容器，以便每个模块都能够注入/解析服务。这意味着每个模块都有自己的“组合根”，其中类型被注入/解析，我想知道关于单元测试的最佳实践是什么。

例如，假设我有一个资源模块，它负责创建和注册从各种数据源获取数据的服务。假设我实现了 IModule.Initialize 方法，如下所示：

```
void Initialize()
{
ISomeDataService someDataService = _container.Resolve<SomeDataService>();
someDataService.Connect();
_container.RegisterInstance<ISomeDataService>(someDataService);
} 
```

Resources 模块创建 SomeDataService 的一个实例，打开一个连接，并注册它以便其他模块可以使用它。注意：这实际上不是我的做法，这只是为了快速说明。

现在从单元测试的角度来看，我如何测试 Initialize 方法？我想在这里测试两件事：

1.  `ISomeDataService.Connect()`方法被调用。
2.  `IUnityContainer.RegisterInstance`正在调用并提供正确的服务。

由于`Initialize()`负责实际创建具体类型并注册它们，因此在为它提供我自己的`ISomeDataService`模拟时似乎我很不走运。现在它确实尝试解决具体类型`SomeDataService`（这与做的事情基本相同`new SomeDataService()`），所以我可以尝试模拟具体类型`SomeDataService`并覆盖我想要测试的方法，但是当具体类型有副作用时这会成为一个问题例如 ChannelFactory 在实例化后立即尝试解析有效​​的 WCF 绑定，并在失败时抛出异常。我可以通过为它提供有效的绑定来避免这种失败，但我认为单元测试不应该依赖于这些东西。

有什么建议吗？我的一个想法如下：

```
void Initialize()
{
if (_container.IsRegistered<ISomeDataService>())
   {
   someDataService = _container.Resolve<ISomeDataService>();
   }
else
   {
   someDataService = _container.Resolve<SomeDataService>(); // or new SomeDataService()
   }

_container.RegisterInstance<ISomeDataService>(someDataService);
someDataService.Connect();
} 
```

这样做我可以模拟 ISomeDataService 而不是具体类型 SomeDataService 一切都很好，但我不知道这是否是正确的方法......我确定我做错了，必须有其他方法.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T16:58:21.480

这是个有趣的问题。

查看提供的示例，实际上测试了三件事：

*   Initialize 注册您的服务
*   ISomeDataService 调用 Connect
*   SomeDataService 已正确实例化。

通常，我会将 Connect 推迟到稍后的某个时间点，因为这类似于在构造函数中进行工作，并且它表明该模块正在做不止一件事。如果您要删除 Connect 方法，这将是微不足道的测试。但是，您的需求可能会有所不同，所以我离题了...

这三件事中的每一件事都应该是单独的测试。诀窍是找到适当的“接缝”，将实例化与注册分离，并用模拟替换服务，以便我们可以验证 Connect 方法。

以下是对上述内容的一个小改动：

```
public void Initialize()
{
    ISomeDataService service = DataService;
    service.Connect();
    _container.RegisterInstance<ISomeDataService>(service);
}

internal ISomeDataService DataService
{
  get { return _service ?? _service = _container.Resolve<SomeDataService>(); }
  set { _service = value;}
} 
```

或者，您可以使用 Subclass to Test 模式：

```
protected internal virtual ISomeDataService GetDataService()
{
  return _container.Resolve<SomeDataService>();
} 
```

从上面几个有趣的点：

1.  您可以通过将模拟服务分配给被测对象来测试注册，调用 Initialize 然后尝试手动从容器中解析服务。断言已解析的服务与您的模拟实例相同。

2.  您可以通过分配一个模拟来测试 Connect，调用 Initialize 然后验证是否调用了 Connect。

3.  您可以通过使用适当的依赖项填充容器并从 DataService 属性或基本 GetDataService() 检索实例（如果您使用要测试的子类）来测试是否可以实例化服务。

最后一个是你的争论点。您不想为测试添加 wcf 配置。我同意，但是因为我们在前两个测试中解耦了模块的行为，所以只需要最后一个配置。最后一个测试是一个集成测试，证明你有合适的配置文件；我会用一个集成类别属性标记这个测试，并与其他测试一起运行它，这些测试使用它们的适当配置加载和初始化所有模块。毕竟，关键是要验证这一切是否有效——诀窍是为孤立的组件获得有意义的反馈。

最后一点，您的问题中显示的代码建议您通过填充模拟来测试该主题。这与我在这里提出的非常相似，但主要区别在于语义：mock 是主体职责的一部分，它不是通过容器注入的依赖项。通过以这种方式编写它，可以清楚地知道什么是模块的一部分以及什么是必需的依赖项。

希望这可以帮助...

# c# - C# Visual Studio 选项卡控件向选项卡添加更多页面

> ID：13976763
> 
> 赞同：0
> 
> 时间：2012-12-20T16:46:36.663
> 
> 标签：c#, visual-studio, tabs, controls, tabcontrol

我对 C# 中的 TabControl 有一个简单的问题-我希望将多个页面连接到每个选项卡。这样，如果我在选项卡之间进行更改，两个页面的内容就会发生变化。就像在这个例子中：http: [//i49.tinypic.com/260zino.jpg](http://i49.tinypic.com/260zino.jpg) 两个页面都应该连接到一个标签。

是否有可能做到这一点？如果是这样，怎么做？

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T16:55:18.467

包含两个面板的更大的选项卡控件不能满足您的需要吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T16:56:14.263

您可以使用选项卡作为并排的两个较小容器的容器来完成此操作，每个容器都是一个“页面”。

您可以为每个页面使用一个 GroupBox 控件，以便在视觉上将两者分开。

# java - 将几个不同类型的参数传递给 doInBackground (Params...params) 方法的最正确方法是什么？

> ID：13976765
> 
> 赞同：0
> 
> 时间：2012-12-20T16:46:44.117
> 
> 标签：java, android, android-asynctask

我正在为网站设计 Android 客户端。因此，我必须实施许多不同的网络操作。例如用户授权或在服务器上搜索。为此，我必须使用一些参数和 URL 向 REST Web 服务器发送 JSON 请求。所以我不仅必须传递字符串参数，还必须传递一些数据结构（例如 LinkedHashMap）。这个问题我不知道最正确的方法。到目前为止，我接下来做了：

1.  `protected Boolean doInBackground(Object... param)`. 然后将 param[0],param [1] 转换为不同的类型。我认为这是一种不好的方式。
2.  为此目的使用 javatuples 库：

`protected Void doInBackground(Pair<String, LinkedHashMap<String, Object>>... params)`

它似乎过于复杂和冗余的代码。最重要的我必须补充

```
@SuppressWarnings("unchecked") 
```

或者我收到了类型安全警告。

所以可能有一些专家可以帮助我，并建议最正确和最有效的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T17:28:54.123

您可以拥有自己的 Asynctask 构造函数并将它们存储为可以在 doinBackground 中使用的字段

```
 private class Task extends AsyncTask<Void, Void, Void> {

    Task(int a, long b){
       //store a, b
    }
    @Override
    protected Void doInBackground(Void... arg) {    
    }   
  } 
```

进而

```
new Task(1,2).execute(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T17:24:52.350

“如果我是你”我不会用`AsyncTask`我的`REST Application`代替，你可以想出其他接管 AsyncTask 工作的设计模式。丢失的原因之一是`bandwidth`怎么可能发生的？？如果您`Http Transaction` 可能正在发布或获取数据，我会打个电话，您的活动将在后台运行，操作系统可能会终止您的活动并关闭`AsyncTask`.

您可以使用该`Service`组件，而不是`AsyncTask`因为 android 对它的评价高于后台活动。

看看[这个](http://www.youtube.com/watch?v=xHXn3Kg2IQE)来自 virgil 的 Google IO 的旧视频

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-20T17:21:17.823

我通常会创建一个简单的类来封装我将使用的所有数据。

# css - Svg - 文本元素的颜色背景/覆盖

> ID：13976766
> 
> 赞同：3
> 
> 时间：2012-12-20T16:46:45.150
> 
> 标签：css, html, svg, styling

我刚刚开始使用 svg 并试图找出样式的局限性。

[我在 svg 中有一个 svg 文本元素。](http://jsbin.com/upafuz/1/)我的一些文本元素用 data-editable="true" 标记。

我希望用户能够轻松地看到标记的元素是什么。我在想象一个简单的、可切换的、半透明的覆盖。

当我将鼠标悬停在 chrome 中的 DOM 视图中的元素上时，文本元素会以蓝色覆盖层呈现。我想得到类似的效果或有点接近的东西。

如果可能的话，我更喜欢使用 css，但任何实现这种效果的方法都会很好。最糟糕的是，我可以通过使用 d3 和 jquery 插入 rect 元素来破解一些东西，但这似乎很混乱。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T21:51:33.727

基于[Erik Dahlström 的回答](https://stackoverflow.com/questions/12260370/draw-text-in-svg-but-remove-background#answer-12263962)

```
<svg width="100%" height="100%" viewBox="0 0 500 140" preserveAspectRatio="xMidYMid meet">
  <style type="text/css">
    *[data-editable=true]:hover{ filter:url(#highlight) }
  </style>
  <filter x="0" y="0" width="1" height="1" id="highlight">
     <feFlood flood-color="rgba(100,200,0,.5)"/>
     <feComposite in="SourceGraphic"/>
  </filter>

  <text data-editable="true" y="100" font-size="100">test</text>
</svg>
```

这适用于纯 CSS 和过滤器定义。

# web-applications - 亚马逊还是不亚马逊

> ID：13976768
> 
> 赞同：1
> 
> 时间：2012-12-20T16:46:50.347
> 
> 标签：web-applications, architecture, amazon-web-services, hosting

我将有一个网络项目，保证每 5 天有 200 000 名访问者。该项目是一个新年明信片网站。主页内容为 0.5MB 到 1MB。但网站将展示 10 到 20 MB 的视频。

我打算将它托管在一个 VPS 或两个 VPS 上。一个用于主页和视频加载器，一个用于视频。如果视频 VPS 关闭 - 显示一些 throbber 或通知。但是这个沉重的视频让我和客户感到害怕。第一个带主页的VPS根据测试可以保证每小时最多65000个请求。根据我的估计，第二个在最好的情况下可以每小时处理 5000-10000 个请求。

我应该去订购 Amazon EC2 吗？我该如何计算价格？亚马逊计算器告诉我每月 30 美元。对于这样的任务来说，这非常便宜。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:50:22.710

亚马逊的基础设施非常适合这种规模的任务。考虑使用他们的 CloudFront CDN 来保存实际视频。

我建议您启动一些实例并使用您的软件运行负载测试以验证性能。AWS 相对于 VPS 的一大好处是，如果您的实例太慢，您只需点击几下鼠标即可升级到更大、更强大的实例类型。使用 VPS，您通常会被合同锁定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T17:21:25.727

[在http://calculator.s3.amazonaws.com/calc5.html](http://calculator.s3.amazonaws.com/calc5.html)使用他们的计算器估算亚马逊账单

# jquery - 使用 AJAX 加载 Codeigniter 日历

> ID：13976772
> 
> 赞同：1
> 
> 时间：2012-12-20T16:46:58.850
> 
> 标签：jquery, ajax, codeigniter, calendar

我有一个控制器，可以将日历显示为某种格式..

```
function eventCalendar($year = null, $month = null)
{
    if (!$year) {
        $year = date('Y');
    }
    if (!$month) {
        $month = date('m');
    }       
    $this->load->model('event_Model','em');
    //this is the attribute that displays the calendar
    $data['calendar'] = $this->em->generate($year, $month);
            //-------
    $data['semester'] = $this->em->getSemester();
    $data['levelyear'] = $this->em->getLevelYear();
    $data['tahun_akademik'] = $this->em->getAcademicYear();
    $data['isi'] = 'eventCalendar';
    $data['kategori'] = $this->em->getKategoriEvent();
    $data['title'] = 'Event Registration';
    $this -> load -> view('index', $data); 
} 
```

然后是传递和处理来自控制器的属性的模型

```
function get_calendar_data($year,$month)    
{
    $query = $this->db->query("SELECT DISTINCT DATE_FORMAT(TanggalMulai, '%Y-%m-%e') AS TanggalMulai
                                        FROM trevent
                                        WHERE TanggalMulai LIKE '$year-$month%' "); //date format eliminates zeros make
                                                                       //days look 05 to 5

        /*$query = $this->db->select('date, data')->from('calendar')
        ->like('date', "$year-$month", 'after')->get();*/

    $cal_data = array();

    foreach ($query->result() as $row) {
        $a = array();
        $b = array();
        $i = 0;

        $query2 = $this->db->query("SELECT *
                                            FROM trevent
                                            WHERE TanggalMulai LIKE DATE_FORMAT('$row->TanggalMulai', '%Y-%m-%d') ");

                                                        //date format change back the date format
                                                        //that fetched earlier

        foreach ($query2->result() as $r) {
                     $a[$i] = $r->NamaEvent;     //make data array to put to specific date
                     $b[$i] = $r->IDevent;
                     $c[$i] = $r->IDkategoriEvent;
                     $query3 = $this->db->query("SELECT * FROM mskategorievent WHERE IDkategoriEvent = '".$c[$i]."'");
                     foreach($query3->result() as $rowke)
                     {
                        $d[$i] = $rowke->WarnaKategoriEvent; 
                     }
                     $i++;                         
                 }

        /*if(substr($row->date,8,1)==0) {
            $cal_data[substr($row->date,9,1)] = $row->data;
        } else {*/
        $date_begin = intval(substr($r->TanggalMulai,8,2));
        $date_end = intval(substr($r->TanggalAkhir,8,2));

        for($j=$date_begin;$j<=$date_end;$j++)
        {
            for($k=0;$k<$i;$k++)
            {
                $cal_data[$j][] = "<table style=\"table-layout: fixed; width: 100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"".$d[$k]."\"><tr><td style=\"word-wrap: break-word\"><font size=\"2px\"><b>".$a[$k]."</b></font></td></tr></table>";
            }
        }
        //}
    }

    return $cal_data;

}

function generate($year,$month) {
    $this->load->library('calendar', $this->conf);

    $cal_data = $this->get_calendar_data($year, $month);

    return $this->calendar->generate($year, $month, $cal_data);
} 
```

在我的视图中有一个组合框，我希望它在单击时更改日历的属性（常规 jquery 或 ajax）

```
<td width="157"><label for="cb_academicYear"></label>
  <select name="cb_academicYear" id="cb_academicYear">
  <?php 
  $sem=0;
        foreach ($tahun_akademik->result() as $ta)
        {
            echo "<option value=\"".$ta->TahunAkademik."-".$ta->IDsemester."\">".$ta->TahunAkademik."-".$ta->IDsemester."</option>";
        }
    ?>
  </select></td> 
```

如果我想在不重定向或重新加载页面的情况下更改日历，我可以用 ajax 做什么？也许使用 ajax ......如果可能的话。请提供此问题的答案，将不胜感激。

# git - 避免合并提交的安全方法？

> ID：13976773
> 
> 赞同：0
> 
> 时间：2012-12-20T16:47:07.207
> 
> 标签：git

我的工作流程通常包括从 master 分支（这是每个人推/拉的地方）。我会定期从 master 中提取最新的，将其合并到我的特性分支中，这样当我将特性合并到 master 时，我可以确保一个很好的快进合并。这一步（将 master 合并到我的功能分支中）创建了很多合并提交。我怎样才能**安全地**避免这些？如果可以做到，这样做还有意义吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:49:11.250

您的问题在于您将 master 合并到您的功能分支中。你不应该那样做。

相反，在特性分支中，将特性分支重新设置为master *:。*`git rebase master`这会将来自该分支的提交重写为基于 master ，因此您可以在执行 rebase 后将该分支快进合并到 master 中（您可以修复由于 master 中最近的更改而导致的冲突，而这些更改在您的功能分支中没有放）

# android - 在自定义 ViewGroup 中设置单个 onClick 事件

> ID：13976774
> 
> 赞同：2
> 
> 时间：2012-12-20T16:47:07.740
> 
> 标签：android, android-custom-view

我创建了一个自定义 ViewGroup，在其中创建了几个自定义子视图（在 java 代码中，而不是 xml）。这些孩子中的每一个都需要具有相同的 onClick 事件。

处理这些点击事件的方法位于使用布局的活动类中。如何将此方法设置为所有子视图的 onClick 处理程序？

这是我的简化代码。

自定义视图组：

```
public class CellContainerGroup extends ViewGroup
{
    CellView[][] CellGrid = new CellView[9][9];

    public CellContainerGroup(Context context, AttributeSet attrs) {
        super(context, attrs);

        TypedArray a = context.obtainStyledAttributes(R.styleable.CellContainerGroup);

        try {
                //initialize attributes here.       
            } finally {
               a.recycle();
            }

        for(int i = 0; i < 9 ; i++)
            for(int j = 0 ; j < 9 ; j++)
            {
                //Add CellViews to CellGrid.
                CellGrid[i][j] = new CellView(context, null); //Attributeset passed as null
                //Manually set attributes, height, width etc.               
                //...

                //Add view to group
                this.addView(CellGrid[i][j], i*9 + j);
            }
    }
} 
```

包含我想用作点击处理程序的方法的活动：

```
public class SudokuGameActivity extends Activity {

    //Left out everything else from the activity.

    public void cellViewClicked(View view) {
    {
        //stuff to do here...
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T17:06:34.777

设置一个`OnClickListener`（in `CellContainerGroup`）将调用该方法：

```
private OnClickListener mListener = new OnClickListener() {

     @Override
     public void onClick(View v) {
          CellContainerGroup ccg = (CellContainerGroup) v.getParent();
          ccg.propagateEvent(v);
     }
} 
```

像这样`propagateEvent`的方法在哪里：`CellContainerGroup`

```
public void propagateEvent(View cell) {
     ((SudokuGameActivity)mContext).cellViewClicked(cell);
} 
```

`mContext`像这样的`Context`参考在哪里：

```
private Context mContext;

public CellContainerGroup(Context context, AttributeSet attrs) {
   super(context, attrs);
   mContext = context;
//... 
```

不要忘记设置`mListener`：

```
CellGrid[i][j].setOnClickListener(mListener); 
```

# c++ - 使用整数的 C++ 模板化数组运算符 []

> ID：13976782
> 
> 赞同：3
> 
> 时间：2012-12-20T16:47:37.940
> 
> 标签：c++, templates, operator-overloading, swizzling

我正在尝试操作一个特殊的结构，我需要某种 swizzle 运算符。为此，有一个重载的数组运算符是有意义的`[]`，但我不想有任何分支，因为结构的特定规范允许理论上的解决方法。

目前，该结构如下所示：

```
struct f32x4
{
    float fLow[2];
    float fHigh[2];

    f32x4(float a, float b, float c, float d)
    {
        fLow[0] = a; 
        fLow[1] = b;
        fHigh[0] = c;
        fHigh[1] = d;
    }

    // template with an int here?
    inline float& operator[] (int x) {
        if (x < 2)
            return fLow[x];
        else
            return fHigh[x - 2];
    }
}; 
```

我可以/应该做些什么来避免分支？我的想法是使用带有整数参数的模板并定义特化，但尚不清楚它是否有意义以及该怪物的语法可能是什么样的。

我明确地，在任何情况下都不能使用`float[4]`数组来合并两者（同样，没有联合技巧）。如果你需要一个很好的理由，那是因为`float[2]`它们实际上类似于特定于平台的 PowerPC 配对单曲。普通的 Windows 编译器不适用于成对的单曲，这就是我用`float[2]`s 替换代码的原因。

使用 GreenHills 编译器，我得到了这个程序集输出（这表明确实发生了分支）：

```
.LDW31:
00000050 80040000           89      lwz r0, 0(r4)
00000054 2c000000           90      cmpwi   r0, 0
00000058 41820000           91      beq .L69
                            92  #line32
                            93  
                            94  .LDWlin1:
0000005c 2c000001           95      cmpwi   r0, 1
00000060 40820000           96      bne .L74
                            97  #line32
                            98  
                            99  .LDWlin2:
00000064 38630004          100      addi    r3, r3, 4
00000068 38210018          101      addi    sp, sp, 24
0000006c 4e800020          102      blr
                           103  .L74:
00000070 2c000002          104      cmpwi   r0, 2
00000074 40820000          105      bne .L77
                           106  #line33
                           107  
                           108  .LDWlin3:
00000078 38630008          109      addi    r3, r3, 8
0000007c 38210018          110      addi    sp, sp, 24
00000080 4e800020          111      blr
                           112  .L77:
00000084 2c000003          113      cmpwi   r0, 3
00000088 40820000          114      bne .L80
                           115  #line34
                           116  
                           117  .LDWlin4:
0000008c 3863000c          118      addi    r3, r3, 12
00000090 38210018          119      addi    sp, sp, 24
00000094 4e800020          120      blr
                           121  .L80:
00000098 38610008          122      addi    r3, sp, 8
                           123  .L69:
                           124  #       .ef 
```

该片段对应的 C++ 代码应该是这个：

```
 inline const float& operator[](const unsigned& idx) const
        {
            if (idx == 0)  return xy[0];
            if (idx == 1)  return xy[1];
            if (idx == 2)  return zw[0];
            if (idx == 3)  return zw[1];
            return 0.f;
        } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T17:03:12.333

索引要么`x`是运行时变量，要么是编译时常量。

*   如果它是一个编译时常量，那么优化器很有可能在内联时能够修剪死分支`operator[]`。

*   如果它是一个运行时变量，比如

    ```
    for (int i=0; i<4; ++i) { dosomething(f[i]); } 
    ```

    无论如何，您都需要分支。当然，除非您的优化器展开循环，在这种情况下，它可以用四个常量替换变量，如上所示。

您是否对此进行了分析以表明存在真正的问题，并对其进行编译以显示分支确实发生在可以避免的地方？

* * *

示例代码：

```
float foo(f32x4 &f)
{
    return f[0]+f[1]+f[2]+f[3];
} 
```

示例输出`g++ -O3 -S`

```
.globl _Z3fooR5f32x4
        .type       _Z3fooR5f32x4, @function
_Z3fooR5f32x4:
.LFB4:
        .cfi_startproc
        movss       (%rdi), %xmm0
        addss       4(%rdi), %xmm0
        addss       8(%rdi), %xmm0
        addss       12(%rdi), %xmm0
        ret
        .cfi_endproc 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-20T17:02:12.457

说真的，不要这样做！！只需组合数组。但是既然你问了这个问题，这里有一个答案：

```
#include <iostream>

float fLow [2] = {1.0,2.0};
float fHigh [2] = {50.0,51.0};

float * fArrays[2] = {fLow, fHigh};

float getFloat (int i)
{
    return fArrays[i>=2][i%2];
}

int main()
{
    for (int i = 0; i < 4; ++i)
        std::cout << getFloat(i) << '\n';
    return 0;
} 
```

输出：

```
1
2
50
51 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-20T17:37:31.613

既然您在评论中说您的索引始终是模板参数，那么您确实可以在编译时而不是运行时进行分支。这是一个可能的解决方案`std::enable_if`：

```
#include <iostream>
#include <type_traits>

struct f32x4
{
    float fLow[2];
    float fHigh[2];

    f32x4(float a, float b, float c, float d)
    {
        fLow[0] = a; 
        fLow[1] = b;
        fHigh[0] = c;
        fHigh[1] = d;
    }

    template <int x>
    float& get(typename std::enable_if<(x >= 0 && x < 2)>::type* = 0)
    {
        return fLow[x];
    }

    template <int x>
    float& get(typename std::enable_if<(x >= 2 && x < 4)>::type* = 0)
    {
        return fHigh[x-2];
    }
};

int main()
{
    f32x4 f(0.f, 1.f, 2.f, 3.f);

    std::cout << f.get<0>() << " " << f.get<1>() << " "
              << f.get<2>() << " " << f.get<3>(); // prints 0 1 2 3
} 
```

关于性能，我认为不会有任何区别，因为优化器应该能够轻松地传播常量并随后删除死代码，从而完全删除分支。但是，使用这种方法，您会得到好处，即任何尝试使用无效索引调用函数都会导致编译器错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-20T16:54:10.343

创建一个包含所有 4 个元素的数组（或向量），fLow 值占据前两个位置，然后在第二个 2 中为高。然后只需对其进行索引。

```
inline float& operator[] (int x) {
    return newFancyArray[x]; //But do some bounds checking above.
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-21T10:39:45.637

根据Luc Touraille的回答，由于缺乏编译器支持而没有使用类型特征，我发现以下内容可以达到问题的目的。由于 operator[] 无法使用 int 参数进行模板化并且无法在语法上工作，因此我介绍了一种`at`方法。这是结果：

```
struct f32x4
{
    float fLow[2];
    float fHigh[2];

    f32x4(float a, float b, float c, float d)
    {
        fLow[0] = a; 
        fLow[1] = b;
        fHigh[0] = c;
        fHigh[1] = d;
    }

    template <unsigned T>
    const float& at() const;

};
template<>
const float& f32x4::at<0>() const { return fLow[0]; }
template<>
const float& f32x4::at<1>() const { return fLow[1]; }
template<>
const float& f32x4::at<2>() const { return fHigh[0]; }
template<>
const float& f32x4::at<3>() const { return fHigh[1]; } 
```

# xaml - WinRT Xaml 故事板

> ID：13976785
> 
> 赞同：0
> 
> 时间：2012-12-20T16:47:58.300
> 
> 标签：xaml, animation, windows-8, microsoft-metro, winrt-xaml

但是，每当我执行 SwapImages.Begin(); 从 C# 文件中没有任何反应。有人可以告诉我下面的代码可能有什么问题吗？

```
 <Storyboard x:Name="SwapImages" >
        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Width)" Storyboard.TargetName="Image" >
            <EasingDoubleKeyFrame KeyTime="0" Value="300" />
            <EasingDoubleKeyFrame KeyTime="0:0:5" Value="0" />
        </DoubleAnimationUsingKeyFrames>

        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Width)" Storyboard.TargetName="Image2" >
            <EasingDoubleKeyFrame KeyTime="0" Value="0" />
            <EasingDoubleKeyFrame KeyTime="0:0:5" Value="300" />
        </DoubleAnimationUsingKeyFrames>

        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.HorizontalAlignment)" Storyboard.TargetName="Image">
            <DiscreteObjectKeyFrame KeyTime="00:00:7">
                <DiscreteObjectKeyFrame.Value>
                    <HorizontalAlignment>Right</HorizontalAlignment>
                </DiscreteObjectKeyFrame.Value>
            </DiscreteObjectKeyFrame>
        </ObjectAnimationUsingKeyFrames>

        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.HorizontalAlignment)" Storyboard.TargetName="Image2">
            <DiscreteObjectKeyFrame KeyTime="00:00:7">
                <DiscreteObjectKeyFrame.Value>
                    <HorizontalAlignment>Left</HorizontalAlignment>
                </DiscreteObjectKeyFrame.Value>
            </DiscreteObjectKeyFrame>
        </ObjectAnimationUsingKeyFrames> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T18:07:44.823

我认为您不能为对齐属性设置动画（根据[此处](https://stackoverflow.com/questions/7827258/possible-to-animate-horizontalalignment-in-wpf)的这个问题）您可以尝试按照链接问题中的注释进行操作，并将您的两个图像放在画布中，然后从代码中操作 x 和 y 坐标-在后面

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T06:29:50.777

这是我在 MainPage.xaml 和你的故事板中编写的代码，我确实得到了输出。

```
<Page
x:Class="TestApp.MainPage"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:local="using:TestApp"
xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
mc:Ignorable="d"
xmlns:data="using:TestApp">
<Page.Resources>
    <Storyboard x:Name="SwapImages" >
        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Width)" Storyboard.TargetName="Image" >
            <EasingDoubleKeyFrame KeyTime="0" Value="300" />
            <EasingDoubleKeyFrame KeyTime="0:0:5" Value="0" />
        </DoubleAnimationUsingKeyFrames>

        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Width)" Storyboard.TargetName="Image2" >
            <EasingDoubleKeyFrame KeyTime="0" Value="0" />
            <EasingDoubleKeyFrame KeyTime="0:0:5" Value="300" />
        </DoubleAnimationUsingKeyFrames>

        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.HorizontalAlignment)" Storyboard.TargetName="Image">
            <DiscreteObjectKeyFrame KeyTime="00:00:7">
                <DiscreteObjectKeyFrame.Value>
                    <HorizontalAlignment>Right</HorizontalAlignment>
                </DiscreteObjectKeyFrame.Value>
            </DiscreteObjectKeyFrame>
        </ObjectAnimationUsingKeyFrames>

        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.HorizontalAlignment)" Storyboard.TargetName="Image2">
            <DiscreteObjectKeyFrame KeyTime="00:00:7">
                <DiscreteObjectKeyFrame.Value>
                    <HorizontalAlignment>Left</HorizontalAlignment>
                </DiscreteObjectKeyFrame.Value>
            </DiscreteObjectKeyFrame>
        </ObjectAnimationUsingKeyFrames>
    </Storyboard>
</Page.Resources>
<Grid >
    <Rectangle Fill="Red" Height="100" Margin="430,237,0,0" Stroke="Black" Name="Image" VerticalAlignment="Top" Width="100"/>
    <Rectangle Fill="Green" Loaded="Image2_Loaded_1" Height="100" Margin="922,212,0,0" Stroke="Black" VerticalAlignment="Top" Width="100" Name="Image2"/>
</Grid></Page> 
```

这是上述 xaml 背后的代码

```
public sealed partial class MainPage : Page
{
    public MainPage()
    {
        this.InitializeComponent();

    }

    /// <summary>
    /// Invoked when this page is about to be displayed in a Frame.
    /// </summary>
    /// <param name="e">Event data that describes how this page was reached.  The Parameter
    /// property is typically used to configure the page.</param>
    protected async override void OnNavigatedTo(NavigationEventArgs e)
    {

    }

    private void Image2_Loaded_1(object sender, RoutedEventArgs e)
    {
        SwapImages.Begin();
    }
} 
```

它工作得很好，唯一的事情是我`SwapImages.Begin();`在加载事件中编写了该方法，该事件在元素加载到屏幕后触发。

你可能会误会的另一件事是动画对齐并不意味着你会从左到右平滑过渡。对齐总是相对于父容器，并且可以有几组值。因此，如果您想要平滑过渡，请尝试为其他属性设置动画，例如画布 X、Y 等。

# android - ListView 不可滚动

> ID：13976790
> 
> 赞同：2
> 
> 时间：2012-12-20T16:48:08.597
> 
> 标签：android, android-listview

我`ListView`的不会收到 onScroll 事件，以防它很短并且没有填满整个屏幕，这很奇怪，因为我已设置`fill_parent`为高度。我的布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="@drawable/bg_login_screen3"
android:orientation="vertical" >

<CheckBox
    android:id="@+id/overview_allcars_checkbox"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:gravity="center"
    android:text="@string/all_cars"
    android:textSize="14sp" />

<LinearLayout
    android:id="@+id/list_root"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <ListView
        android:id="@+id/android:list"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_weight="1"
        android:cacheColorHint="#00000000"
        android:fadingEdge="horizontal"
        android:scrollingCache="true" />
</LinearLayout>
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T17:10:43.527

您可能会发现此答案很有用：-

[使 TextView 在 Android 上可滚动](https://stackoverflow.com/questions/1748977/making-textview-scrollable-in-android)

这就是帮助我的原因：

```
<ScrollView
android:id="@+id/SCROLLER_ID"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:scrollbars="vertical"
android:fillViewport="true">

    <TextView
    android:id="@+id/TEXT_STATUS_ID"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_weight="1.0"/>

</ScrollView> 
```

主要是将 TextView 包装在 ScrollView 中。

# sql - SQL Server 选择多个分组

> ID：13976800
> 
> 赞同：2
> 
> 时间：2012-12-20T16:48:33.123
> 
> 标签：sql, sql-server

我有两个描述用户及其付款的表格：

```
CREATE TABLE test_users
(id int IDENTITY NOT NULL,
name varchar(25),
PRIMARY KEY (id));

CREATE TABLE test_payments
(id int IDENTITY NOT NULL,
user_id int NOT NULL,
money money NOT NULL,
date datetime NOT NULL,
PRIMARY KEY (id));

INSERT INTO test_users (name) 
VALUES ('john');

INSERT INTO test_users (name) 
VALUES ('peter');

INSERT INTO test_payments (user_id, money, date)
VALUES (1, $1, CONVERT(datetime, '15.12.2012'));

INSERT INTO test_payments (user_id, money, date)
VALUES (1, $2, CONVERT(datetime, '16.12.2012'));

INSERT INTO test_payments (user_id, money, date)
VALUES (2, $1, CONVERT(datetime, '16.12.2012'));

INSERT INTO test_payments (user_id, money, date)
VALUES (2, $3, CONVERT(datetime, '17.12.2012'));

INSERT INTO test_payments (user_id, money, date)
VALUES (1, $1, CONVERT(datetime, '19.12.2012')); 
```

表 test_users：

```
id  name
-------------
1   john
2   peter 
```

表 test_payments：

```
id  user_id money   last_activity
---------------------------------------
1   1   1.0000  2012-12-15
2   1   2.0000  2012-12-16
3   2   1.0000  2012-12-16
4   2   3.0000  2012-12-17
5   1   1.0000  2012-12-19 
```

我需要制作一个用户统计数据，它会告诉我：

1.  用户名
2.  一段时间内的总费用
3.  最后一个用户活动的日期（一般，不是一段时间）。

例如，以 15-18.12.12 期间为例，我期望得到以下结果：

```
name    total    last_activity
--------------------------------
peter   $4       2012-12-17
john    $3       2012-12-19 
```

我尝试了以下查询：

```
SELECT u.*, SUM(p.money) total, MAX(p.date) last_activity
FROM test_users u
JOIN test_payments p
ON u.id= p.user_id
WHERE p.date BETWEEN CONVERT(datetime, '15.12.2012') AND CONVERT(datetime, '18.12.2012')
GROUP BY u.id, u.name
ORDER BY total DESC; 
```

但 last_activity 的结果错误，因为它也在日期范围内：

```
id  name    total   last_activity
--------------------------------
2   peter   4.0000  2012-12-17
1   john    3.0000  2012-12-16 
```

请提出解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:52:28.080

您需要将条件从`where`子句移动到`case`语句：

```
SELECT u.id, u.name,
      SUM(case when p.date BETWEEN CONVERT(datetime, '15.12.2012') AND CONVERT(datetime, '18.12.2012')
               then p.money
          end) total,
      MAX(p.date) last_activity
FROM test_users u JOIN
     test_payments p
     ON u.id= p.user_id
GROUP BY u.id, u.name
ORDER BY total DESC; 
```

如果您只想要在该期间付款的用户，那么您可以包括：

```
having total is not null 
```

如果您希望 NULL 值显示为 0 而不是 NULL，则包含`else 0`在 case 语句中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-20T17:07:11.647

看起来我在做我的工作时弹出了其他几个答案，但无论如何都在这里。这里有一个工作 sql fiddle：http://sqlfiddle.com/#! [3/14808/6](http://sqlfiddle.com/#!3/14808/6)

基本上，无论日期范围如何，您都需要一个查询来提取最大日期。我选择将其作为相关子查询来执行。

```
SELECT 
  u.id,
  u.name,
  SUM(IsNull(money,0)) as TotalMoneyInRange,
  (SELECT max(date) FROM test_payments where user_id = u.id) AS LastPaymentOverAll
FROM test_users AS u
LEFT JOIN test_payments AS p
ON u.id = p.user_id
WHERE 
  p.date IS NULL OR
  p.date between 
  CAST('12-11-2012' AS datetime) --range begin
  and 
  CAST('12-16-2012' as datetime) --range end
GROUP BY u.id, u.name 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T17:02:19.423

您还可以使用子查询来获取结果：

```
SELECT u.*, total, last_activity
FROM test_users u
JOIN
(
  select sum(money) total, user_id
  from test_payments
  WHERE date BETWEEN CONVERT(datetime, '2012-12-15') 
    AND CONVERT(datetime, '2012-12-18')
  group by user_id
) p
  ON u.id= p.user_id
inner join 
(
  select user_id, max(date) last_activity
  from test_payments
  group by user_id
) p1
  on p.user_id = p1.user_id
ORDER BY total DESC; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/be4c1/10)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T17:05:46.357

您可以为没有 WHERE 子句的 MAX 日期添加子查询，如下所示：

```
SELECT 
  u.*
  ,SUM(p.money) total
  ,a.max_date last_activity
FROM test_users u
  INNER JOIN test_payments p ON u.id = p.user_id
  INNER JOIN (SELECT user_id, MAX(date) AS max_date 
              FROM test_payments 
              GROUP BY user_id) a ON u.id = a.user_id
WHERE p.date BETWEEN CONVERT(datetime, '15.12.2012') AND CONVERT(datetime, '18.12.2012')
GROUP BY u.id, u.name, a.max_date
ORDER BY total DESC; 
```

# java - JTabbedPane - 保持标签的顺序

> ID：13976803
> 
> 赞同：0
> 
> 时间：2012-12-20T16:48:37.320
> 
> 标签：java, arrays, collections, jtabbedpane

这个问题不一定是 JTabbedPane 特有的，但这是我遇到的地方。这个想法是您有一个优先级列表`Priority[]`，您希望根据这些优先级查看要呈现的输出选项卡。每个选项卡可以有许多与给定优先级关联的对象，我想在检测到**第一个**对象时生成选项卡。对象是由外部服务生成的，它们可以按任何顺序出现。所以，假设你有

```
[Low, Medium, Warning, Alert, Crash] 
```

作为您的优先事项列表。现在，这就是我想要生成的

```
[] -> []
[Alert] -> [Alert]
[Alert, Alert] -> [Alert]
[Alert, Alert, Low] -> [Low, Alert]
[Alert, Alert, Low, Medium] -> [Low, Medium, Alert] 
```

RHS 是选项卡的顺序，LHS 是即将到来的优先级。有什么想法可以动态实现吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T16:55:27.793

您可以调用 JTabbedPane 上的 insertTab 方法将新选项卡插入到指定位置。

```
 insertTab(title, icon, panel, title, index); 
```

因此，您可以遍历每个选项卡并根据优先级将其插入指定索引处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T17:00:25.620

像这样的东西：

```
List<String> priorities = Arrays.asList("Low", "Medium", "Warning", "Alert", "Crash");
Map<List<String>> data = new LinkedHashMap<List<String>>();
for (String priority : priorities)
  data.put(priority, new ArrayList<String>());

... 
```

传入数据：

```
String priority = ...;

List<String> list = data.get(priority);
list.add("my new data");

if (list.size() == 1) {
  //insert tab
  int index = 0;
  int priorityIndex = priorities.indexOf(priority);
  while (priorityIndex > priorities.indexOf(tabbedPaned.getTitleAt(index))) {
    index++;
  }
  tabbedPane.insertTab(priority, ... , index); //includes index where to insert the tab
}

//update tabs
... 
```

# twitter-bootstrap - 为什么我必须在 Twitter Bootstrap 的菜单中添加 btn-navbar？

> ID：13976804
> 
> 赞同：1
> 
> 时间：2012-12-20T16:48:36.867
> 
> 标签：twitter-bootstrap

我发现几乎所有的菜单都有这个`btn-navbar`类。我不知道为什么我必须添加这个类。我没有注意到任何影响。

谁能告诉我有什么作用`btn-navbar`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T06:16:36.540

这段代码`.btn-navbar`

```
<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
</a> 
```

等于： ![在此处输入图像描述](../Images/962c732b45f47b7c476f8298a58bf900.png)

**除非您使用响应式引导**并且**屏幕小于 768 像素**，否则您看不到它。

 **在这里检查：http: [//jsfiddle.net/hajpoj/2bTke/4/](http://jsfiddle.net/hajpoj/2bTke/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T17:00:53.083

尝试在[**bootstrap.css**](http://twitter.github.com/bootstrap/assets/css/bootstrap.css)（18 个实例）或[**navbar.less**文件](https://github.com/twitter/bootstrap/blob/master/less/navbar.less)（4 个实例）中搜索“ *.btn-navbar* ”，您可以找到所有相关信息。

主要是布局（**margin**，**padding**，**float**）和一些视觉的东西，比如**background**和**box-shadow**。**

# ruby-on-rails - Rails：我应该在视图还是控制器中处理渲染逻辑？

> ID：13976806
> 
> 赞同：0
> 
> 时间：2012-12-20T16:48:43.320
> 
> 标签：ruby-on-rails, model-view-controller

我的 Rails 应用程序 /index 路径应该显示一个页面给登录用户，一个完全不同的页面给管理员用户，一个完全不同的页面给未登录的用户。

所以，一个控制器（HomeController），一个动作（index），三个视图。

我可以通过两种方式实现这一点：

1.  插入`if`子句`views/home/index.html.erb`使其做正确的事。
2.  以某种方式将条件逻辑放入控制器中（让控制器找出用户是谁），然后相应地呈现不同的布局，如[http://guides.rubyonrails.org/layouts_and_rendering.html中的](http://guides.rubyonrails.org/layouts_and_rendering.html)**2.2.12 查找布局**中所述。

我有一种强烈的感觉，后一种解决方案是正确的。但我不确定如何实现它，用户控制器是一个完全不同的控制器。我的家庭控制器如何找出当前用户是谁来决定要呈现什么视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T17:02:24.127

您可以访问所有控制器中的 current_user 对象，以检查用户是否已登录。我们也可以通过 current_user 对象获取用户角色

> current_user.role_name

您可以传递此角色名称以将部分呈现为文件名（保留不同的文件）。

# c++ - Cython 中的抽象类（带有纯虚方法）

> ID：13976809
> 
> 赞同：12
> 
> 时间：2012-12-20T16:48:55.977
> 
> 标签：c++, python, oop, cython

**快速版：** 如何在 Cython 中声明一个抽象类？目标是仅声明接口，以便其他类可以继承它，必须*没有*此类的实现。

接口.pxd：

```
cdef class IModel:
    cdef void do_smth(self) 
```

impl.pyx：

```
from interface cimport IModel

cdef class A(IModel):
    cdef void do_smth(self):
        pass 
```

一切都**很好编译**，但是当我`impl.so`在 python 中导入时，我得到以下信息：

```
ImportError: No module named interface 
```

显然该方法不是真正的虚拟和 python 想要`IModel`的实例

**更多细节：**

我有一个 cython 扩展类 ( `cdef class Integrator`)，它应该在任何实例上运行，实现`IModel`接口。该接口只是确保实例有一个方法`void get_dx(double[:] x, double[:] dx)`，以便集成器可以在每个集成步骤调用它，以便集成模型。这个想法是，可以在 cython 中实现不同的模型，然后以交互方式集成它们并在**python**脚本中绘制结果。像那样：

```
from integrator import Integrator # <-- pre-compiled .so extension
from models import Lorenz         # <-- also pre-compiled one, which inherits
                                  # from IModel

mod = Lorenz()
i = Inegrator(mod)
i.integrate()       # this one's really fast cuz no python is used inside

# do something with data from i 
```

该类`lorenz.pyx`应如下所示：

```
from imodel cimport IModel

cdef class Lorenz(IModel):
    cdef void get_dx(double[:] x, double[:] dx)
        # implementation 
```

和`integrator.pyx`：

```
from imodel cimport IModel

cdef class Integrator:
    cdef IModel model

    def __init__(self, IModel model):
        self.model = model

    # rest of the implementation 
```

理想情况下，IModel 应该*只*以类定义的形式存在于*cython 头*文件（即 imodel.pxd）中，但到目前为止，我只能通过在`imodel.pyx`. 最糟糕的是，必须编译和链接这个无用的虚拟实现，以便其他 cython 类可以继承它。

**PS：**我认为这是抽象类的完美用例，但是，如果您觉得它实际上看起来很糟糕，亲爱的 OOP 编码人员，请告诉我应该使用哪种其他方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-24T00:20:51.140

事实证明这不太可能（[讨论](https://groups.google.com/forum/?fromgroups=#!topic/cython-users/-PrYBVm7lDE)）。目前，不支持接口，显然是因为它们不是至关重要的：通常的继承工作得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T08:38:38.747

如何在 C++ 中声明一个抽象类声明普通类，但该类必须至少有 1 个纯虚函数。例如：class abc{ virtual void show()=0 //纯虚拟funcn.no defn }

# google-maps-api-3 - 获取圆心坐标

> ID：13976811
> 
> 赞同：3
> 
> 时间：2012-12-20T16:49:10.637
> 
> 标签：google-maps-api-3, google-maps-markers

我有下一个获取多边形坐标的代码，但我想在画圆时获取中心坐标。

有谁知道如何实现这一目标？

最好的问候，并希望有人对此有所了解。

```
function draw() { 
 if (drawingManager <= 0) then 

var drawingManager = new google.maps.drawing.DrawingManager({
  drawingMode: google.maps.drawing.OverlayType.POLYGON,
  drawingControl: true,
  drawingControlOptions: {
    position: google.maps.ControlPosition.TOP_CENTER,
    drawingModes: [
      google.maps.drawing.OverlayType.MARKER,
     google.maps.drawing.OverlayType.CIRCLE,
      google.maps.drawing.OverlayType.POLYGON,
     google.maps.drawing.OverlayType.POLYLINE,
     google.maps.drawing.OverlayType.RECTANGLE
    ]
  },
  markerOptions: {
    icon: 'images/beachflag.png'
  },
  polygonOptions: {
    fillColor: '#1E90FF',
    fillOpacity: 0.4,
    strokeWeight: 2,
    clickable: true,
    editable: true,
    zIndex: 1
  }
});

var coord_listener = google.maps.event.addListener(drawingManager, 'polygoncomplete', function (polygon) {
var coordinates = (polygon.getPath().getArray());

alert(coordinates);
PassPolygonToField(coordinates);
window.poly = polygon;
});

drawingManager.setMap(map);

} 

function PassPolygonToField(coordinates) {
//here I pass the coords to the form field and then I insert the form into a mysql database.
document.getElementById('myField').value = (coordinates);

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T18:24:48.217

在 coord_listener 之后添加此代码：

```
google.maps.event.addListener(drawingManager, 'circlecomplete', function(circle) {
  alert(circle.getCenter());
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-22T14:34:29.833

我遇到了同样的问题，我不得不使用：

```
const lat = circle.overlay.getCenter().lat()
const lng = circle.overlay.getCenter().lng() 
```

# windows-7 - DirectShow 安装

> ID：13976816
> 
> 赞同：1
> 
> 时间：2012-12-20T16:49:18.827
> 
> 标签：windows-7, sdk, directshow

# DirectShow 安装问题

我安装了“ *Windows 7（专业版）* ”和“ *VS-2010* ”。我想安装 Directshow。我这里有两个问题...

1> 我应该安装“ *Windows SDK for Windows 8* ”吗？

或者

2> 我应该安装“ *DirectX Software Development for Windows 7* ”吗？
在第二种情况下，我是否还需要安装“ *Windows SDK for Windows 7* ”？

**请****指导**...`void help() {;}`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T17:27:03.453

DirectShow 运行时是一个核心的 Windows 组件。它不需要单独安装。一些对开发人员有用的 DirectShow 位于 Windows SDK 上。我不确定“适用于 Windows 8 的 Windows SDK”，但是[“适用于 Windows 7 和 .NET Framework 4 的 Microsoft Windows SDK”](http://www.microsoft.com/en-us/download/details.aspx?id=8279)确实有它们（`propage.dll`是检查存在的文件之一）。

# arrays - 从数组计算总和

> ID：13976819
> 
> 赞同：0
> 
> 时间：2012-12-20T16:49:34.917
> 
> 标签：arrays, knockout.js, observable

我有一个浮点数组`weeklyAmounts`，在子对象中定义`a`。在父对象`b`中，我有一个对象数组`a`，需要从所有子对象计算第 1 周的小计，从所有子对象计算第2 周的小`a`计`a`等。

我的问题：

1.  通过阅读淘汰文档，可观察到的数组会跟踪诸如删除或添加之类的事件，但不会跟踪单个对象的状态更改，因此在我的情况下，即使用户`week1Amount`从 GUI 更改，它也不会触发计算值。真的吗？
2.  令我惊讶的是，`week1Amount`从 GUI 更改后，我没有看到 viewmodel 中的值发生变化。我在这里错过了什么吗？
3.  鉴于需要什么，最好的解决方案是什么？

我不工作的代码如下：

```
function a(id, name, week1Amount, week2Amount, week3Amount, week4Amount,
week5Amount, week6Amount, week7Amount, week8Amount, week9Amount, week10Amount...) {
var self = this;
self.id = id;
self.name = name;
  self.week1Amount = ko.observable(week1Amount);
  self.week2Amount = ko.observable(week2Amount);
  self.week3Amount = ko.observable(week3Amount);
  self.week4Amount = ko.observable(week4Amount);
  self.week5Amount = ko.observable(week5Amount);
  self.week6Amount = ko.observable(week6Amount);
  self.week7Amount = ko.observable(week7Amount);
  self.week8Amount = ko.observable(week8Amount);
  self.week9Amount = ko.observable(week9Amount);
  self.week10Amount = ko.observable(week10Amount);
  self.week11Amount = ko.observable(week11Amount);
  self.week12Amount = ko.observable(week12Amount);
    };

    function b(bid, bname, as) {
    var self = this;
  self.id= bid;
  self.name = bname;
  self.as = as;
  self.week1Sum = ko.computed(function () {
      var sum = 0.0;
      $(self.as).each(function (index, aItem) {
        sum += aItem.week1Amount();
      });
      return sum;
  });
    //rest of code is omitted for brevity. 
    };

      var objBs = [];

      $(objAs).each(function (index, aItem) {
        var newA = new a(aItem.ID, aItem.Name,  
    aItem.WeeklyAmount[0],aItem.WeeklyAmount[1],aItem.WeeklyAmount[2],aItem.WeeklyAmount[3],
    aItem.WeeklyAmount[4],aItem.WeeklyAmount[5],aItem.WeeklyAmount[6],....);
    objBs.push(newA);
    });

var vmB = new b(1,"someName", objBs);

    ko.applyBindings(vmB, document.getElementById("showBs")); 
```

# php - 选择多个变量列

> ID：13976820
> 
> 赞同：0
> 
> 时间：2012-12-20T16:49:36.533
> 
> 标签：php, mysql

我正在使用 PHP 制作餐厅预订模块。

问题是我想让用户选择他们想来的时间和想去的时间。

在这两个时间之间，表格需要被占用，因此在这些时间之间该单元格中需要有一个名称。

我不知道如何完成这项工作。

这是我现有的代码：

```
$day="0".$_POST['day'];
$month="0".$_POST['month'];
$year=$_POST['year'];
$date=$year ."-". $month ."-". $day;
$table=$_POST['table'];
$name=$_POST['name'];
$fromtime=$_POST['fromtime'];
$untiltime=$_POST['untiltime'];
$tablenumber = $table;

$host="localhost";
$user="root";
$password="root";
$database="restaurant";
$connection = mysql_connect ($host, $user, $password)
    or die ("could not connect with server");
$db = mysql_select_db ($database, $connection)
    or die ("could not connect with db");

$query = mysql_query("SELECT * FROM tables WHERE table='$tablenumber' AND date = '$date'");
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T17:05:53.833

我猜您与预订表有一对多关系（如果他们只能预订 1 个表），因此您需要一个插入语句来添加预订

这里有一些**伪代码**

```
INSERT INTO reservation (tableid, startTime,endtime,reservationName) VALUES (tableid, yourFronttime, yourEndTime, reservationName) 
```

但在插入之前，您必须检查表是否像这样免费

```
SELECT tableId
FROM reservation 
WHERE (startTime BETWEEN yourFrontTime AND untilTime) OR (endtime BETWEEN yourFrontTime AND untilTime) 
AND TableId = yourId 
```

如果您通过该选择获得结果，他们必须选择另一个时间或另一个表。

# c# - 带有基于服务的数据库的form2文本框到form1 datagridview

> ID：13976821
> 
> 赞同：1
> 
> 时间：2012-12-20T16:49:46.003
> 
> 标签：c#, windows, winforms

我有 Form1 和我创建的基于服务的数据库中的 DataGridView 和一个客户信息按钮。此按钮打开 Form2，用于添加另一个客户。

我在 Form2 中编写的每条信息都必须在 Form1 DataGridView 中显示。

我该怎么做呢？请帮我！

这是我的`Form1`代码：

```
namespace Icabales.Homer
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            Database1Entities db1Entity = new Database1Entities();
            var myProducts = from p in db1Entity.Products
                             select p;
            cboProduct.DataSource = myProducts;
            cboProduct.DisplayMember = "ProductName";
            cboProduct.ValueMember = "ProductID";
            var myCostumers = from c in db1Entity.Costumers
                              select c;
            dgCostumer.DataSource = myCostumers;
            dgCostumer.SelectionMode = DataGridViewSelectionMode.FullRowSelect;
            txtStocks.DataBindings.Add("Text", myProducts, "StocksLeft");
            txtUnitPrice.DataBindings.Add("Text", myProducts, "Unitprice");
            txtCostumer.DataBindings.Add("Text", myCostumers, "CostumerName");
            dgCart.Columns.Add("ProductID", "ID");
            dgCart.Columns.Add("ProductName", "Item");
            dgCart.Columns.Add("Quantity", "Quantity");
            dgCart.SelectionMode = DataGridViewSelectionMode.FullRowSelect;                       
        } 

        private void btnAdd_Click(object sender, EventArgs e)
        {   
            dgCart.Rows.Add(cboProduct.SelectedValue, cboProduct.Text, txtQuantity.Text);
        }

            private void btnSaveOrder_Click(object sender, EventArgs e)
            {
            Database1Entities db1Entity = new Database1Entities();
            Order myOrder;
            foreach (DataGridViewRow r in dgCart.Rows)
        {
            if (r.Cells[0].Value != null) //check for each ProductID that is not Empty
            {
                myOrder = new Order(); // create new order for each item in the Cart that has Product ID
                myOrder.ProductID = Convert.ToInt32(r.Cells[0].Value.ToString()); // Product ID
                myOrder.Quantity = Convert.ToInt32(r.Cells[2].Value.ToString()); // Quantity
                myOrder.CostumerID = Convert.ToInt32(dgCostumer.CurrentRow.Cells[0].Value); myOrder.OrderDate = DateTime.Now; //get current Date and Time
                db1Entity.Orders.AddObject(myOrder);
            }
        }
        db1Entity.SaveChanges();
        MessageBox.Show("Your Order has been saved!", "Order", MessageBoxButtons.OK,
        MessageBoxIcon.Information);
    }

    private void btnRemove_Click(object sender, EventArgs e)
    {
        foreach (DataGridViewRow item in this.dgCart.SelectedRows)
        {
            dgCart.Rows.RemoveAt(item.Index);
        }
    }

    private void btnClear_Click(object sender, EventArgs e)
    {
        dgCart.Rows.Clear();
    }

    private void button1_Click(object sender, EventArgs e)
    {
        new Form2().Show();
    }

    private void button2_Click(object sender, EventArgs e)
    {
        new Form3().Show();
    }
}
} 
```

不能发布图片新成员:(

# git - msysgit Unicode 支持：从以前的 Git 版本迁移时我做的一团糟

> ID：13976829
> 
> 赞同：0
> 
> 时间：2012-12-20T16:50:03.130
> 
> 标签：git, unicode, msysgit

我有一个 repo，路径和文件名中有重音字母。我升级到 msysgit 1.8.0-preview 并继续在其中一个分支上工作（我们称之为`recent`），根据需要提交和推送。当我意识到由于 v1.7.10 引入的 Unicode 支持而需要迁移我的存储库时，我按照[此处](https://github.com/kblees/git/wiki#wiki-Git_for_Windows_Unicode_Support)的说明进行操作。

我可以迁移所有“非活动”分支，并且可以在它们之间结帐没有问题。但是我不能再结帐`recent`了。吉特报告：

```
error: The following untracked working tree file would be overwritten by checkout:

<list of files with accented letters>

Please move or remove them before you can switch branches 
```

根据 没有未跟踪的文件`git status`。我能做到的唯一方法`recent`是将其设置为 BitBucket 上的主分支，然后克隆 repo。当我在该分支上时，`git status`报告没有未跟踪的文件，并且所有内容都是最新的。迁移说明在那里不起作用（同样没有未跟踪的文件可以使用），而且，如果我切换到另一个分支，我将无法切换回来。

在这一点上我有点迷路，有没有勇敢的灵魂可以帮助我？我是唯一一个推送到远程仓库的人。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:53:53.167

这是交易：你有一些文件，我们称它为 a.txt，它在你的工作目录中，但它不存在于你的主分支中。您可能已将其列在其中，`.gitignore`因此在运行时它不会显示`git status`。`recent`分支中可能有一个名为 a.txt 的文件。当您尝试签出`recent`分支时，git 想要在您的工作目录中放置一个名为 a.txt 的文件，但它不能，因为您恰好在那里有一个。

解决方案：注意git给你的错误信息！将该列表中的文件移动到一些完全不同的目录中，这样它们就不会丢失，然后您应该能够`recent`很好地签出分支。顺便说一句，`ls`通常是比`git status`.

# python - supervisord 停止/启动所有进程，但不包括 X 和 Y 进程

> ID：13976836
> 
> 赞同：2
> 
> 时间：2012-12-20T16:50:36.650
> 
> 标签：python, distributed, supervisord, xmlrpclib

我试图在一个 XMLRPC 调用中停止在由 Supervisord 管理的远程服务器上运行的大约 20 个服务。

但是，我想从中排除某些过程，如果我可以按照以下方式做一些事情会很棒：

```
stopAllProcesses(exclude=["monitorapp","nagios"]) 
```

或者，我确实有一个所有可用进程的列表，因此即使执行以下操作也比实际停止所有服务或执行 20 个单独调用要好：

```
stopProcess(["process1","process2","process3"]) 
```

这比这样做要好得多：

```
stopProcess("process1")
stopProcess("process2")
stopProcess("process3") 
```

任何帮助将不胜感激！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:09:04.433

中的 XML-RPC 服务器`supervisord`支持[`system.multicall()`端点](http://mirrors.talideon.com/articles/multicall.html)。[使用XML-RPC 代理](http://docs.python.org/2/library/xmlrpclib.html#xmlrpclib.MultiCall)发送一*组*`stopProcess`调用：[`MultiCall`](http://docs.python.org/2/library/xmlrpclib.html#xmlrpclib.MultiCall)

```
multicall = xmlrpclib.MultiCall(serverproxy)
for proc in procs:
    if proc in exclude:
        continue
    multicall.supervisor.stopProcess(proc)
res = multicall() 
```

`serverproxy`服务器的 XML-RPC 代理在哪里`supervisord`。这些调用将作为一个 HTTP 请求发送，并在服务器上串行处理，不会比`stopAllProcesses()`;快或慢。后者在内部调用`stopProcess`无论如何找到的每个进程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T18:16:23.293

你有一个所有进程名称的列表：

```
procs = ['monitorapp', 'nagios', 'process1', 'process2', 'process3'] 
```

以及要排除的进程名称列表：

```
exclude = ['monitorapp', 'nagios'] 
```

你可以打电话给他们，一次一个...

这将为不在排除列表中的每个进程调用“stopProcess()”：

```
stop_procs = [p for p in procs if p not in exclude]
for proc in stop_procs:
    stopProcess(proc) 
```

更好的做法是重构 API（如果可能）以使用包含/排除在一次调用中处理进程列表。

# ruby - Ruby 全部矩阵

> ID：13976838
> 
> 赞同：-1
> 
> 时间：2012-12-20T16:50:39.737
> 
> 标签：ruby, matrix

我有字符串 s1,s2,s3,s4 并且我想通过所有比较来做所有事情，所以想比较 s1 和 s2,s3,s4 和 s2 和 s3,s4 和 s3 和 s4，最好的方法是什么.

类似于 for 循环的东西？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T16:58:48.837

请参阅 Ruby[`Array#combination`方法](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-combination)：

```
arr = [1, 2, 3, 4]
arr.combination(2) do |x,y|
  # Compare X to Y
end 
```

# wcf - 与大对象通信 WCF 和 silverlight5

> ID：13976848
> 
> 赞同：0
> 
> 时间：2012-12-20T16:51:23.033
> 
> 标签：wcf, silverlight

我是 WCF 和 Silverlight 的新手，有一个带有 Silverlight 客户端和 WCF 服务器的应用程序，它一直运行良好，直到我添加了一个将大对象作为参数的方法。该对象包含 93 个 int、bool、string、enum 类型的属性。当它阻塞时，WCF 会给出如下错误消息：

`The server did not provide a meaningful reply; this might be caused by a contract mismatch, a premature session shutdown or an internal server error.`

没有其他有意义的消息。配置文件中的所有*Timeout*和*Buffersize*都已设置为最大值。

我尝试过使用另一个包含较少属性的对象......我一个一个添加并且它起作用了。

我发现当有 72 个属性（使用 enum、bool、string、int）时它可以工作，但是当我再添加一个时，它就不再工作了。

直到现在我一直在挣扎一周，非常感谢您帮助我...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T16:57:15.157

尝试将所有服务器端配额设置为最大值，例如：

```
<bindings>
  <basicHttpBinding>
    <binding name="MyBasicHttpBinding"
         maxReceivedMessageSize="2147483647"
        >
      <readerQuotas maxDepth="64" maxStringContentLength="2147483647" maxArrayLength="2147483647"
          maxBytesPerRead="2147483647" maxNameTableCharCount="2147483647"  />
      </binding>

  </basicHttpBinding>
</bindings>

 <services>
  <service name="MyWcfService">
    <endpoint address="http://myservice..."
      binding="basicHttpBinding" bindingConfiguration="MyBasicHttpBinding"
      name="MyBasicHttpBinding" contract="IMyContract" />
  </service>
</services> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T14:34:49.513

最后我们找到了解决方法，对于遇到同样问题的人来说：因为那个默认，NetTcpBinding的MaxSessionSize(int the BinaryMessageEncodingBindingElement)最大为2048，不能再添加了，只好改成使用更大的 MaxSessionSize 进行自定义.....

# php - 在php中添加六个月

> ID：13976851
> 
> 赞同：10
> 
> 时间：2012-12-20T16:51:33.863
> 
> 标签：php, date, datetime

我正在尝试从当前日期开始六个月，六个月。

我试过使用：

`date('d', strtotime('+6 month', time()));`

但它似乎不起作用，总是返回`01`。有一个更好的方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-20T16:52:34.967

我发现使用[DateTime](http://us3.php.net/manual/en/book.datetime.php)更容易使用：

```
$datetime = new \DateTime();
$datetime->modify('+6 months');
echo $datetime->format('d'); 
```

或者

```
$datetime = new \DateTime();
$datetime->add(new DateInterval('P6M'));
echo $datetime->format('d'); 
```

或 PHP 版本 5.4+

```
echo (new \DateTime())->add(new \DateInterval('P6M'))->format('d'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-20T16:54:25.087

如果您仍想使用 strtotime 和 date 函数而不是 DateTime() 对象，则可以使用以下方法：

```
date('d', strtotime('+6 months')); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T16:57:34.190

您可以将该`DateTime`类与该类结合使用`DateInterval`：

```
<?php
$date = new DateTime();
$date->add(new DateInterval('P6M'));

echo $date->format('d M Y'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T16:55:10.080

您不需要传递`time()`给 strtotime，因为它是默认值。

除此之外，您的方法是正确的 - 除了您采取`date('d')`（这是放出一天）而不是`date('m')`一个月，`echo date('m', strtotime('+6 month'));`应该这样做。

尽管如此，我还是建议使用`DateTime`约翰所说的方式。`DateTime`与“旧”日期函数相比有几个优点，例如，当 UNIX 大爆炸以来的秒数不再适合 32 位整数时，它们不会停止工作。

# xml-serialization - 为什么我的文件没有保存？WinRT 中的 XmlSerializer

> ID：13976856
> 
> 赞同：0
> 
> 时间：2012-12-20T16:51:59.820
> 
> 标签：xml-serialization, windows-runtime, storage

我正在使用 XmlSerializer，每次将一个项目添加到我的列表中时，我都会调用 save 方法：

```
async public void save(List<string> eingabe)
{
    var serializer = new XmlSerializer(typeof(List<string>));

    StorageFolder storageFolder = ApplicationData.Current.LocalFolder;
    StorageFile sampleFile = 
        await storageFolder.CreateFileAsync(speicherPfad, CreationCollisionOption.ReplaceExisting);
    var file = await sampleFile.OpenAsync(FileAccessMode.ReadWrite);

    serializer.Serialize(file.AsStreamForWrite(), eingabe);

    file.Dispose();
} 
```

当应用程序启动时，我调用加载方法：

```
public async Task<List<string>> load()
{
    List<string> ausgabe = new List<string>();
    XmlSerializer serializer = new XmlSerializer(typeof(List<string>));

    StorageFolder storageFolder = ApplicationData.Current.LocalFolder;
    StorageFile sampleFile = await storageFolder.CreateFileAsync(speicherPfad, CreationCollisionOption.ReplaceExisting);

    var file = await sampleFile.OpenAsync(FileAccessMode.Read);
    List<string> speicher = (List<string>)serializer.Deserialize(file.AsStreamForRead());

    file.Dispose();

    return speicher;
} 
```

问题：**在加载方法中，文件总是空的（大小= 0），我不知道为什么**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T17:02:57.980

可能是因为这个选项：`CreationCollisionOption.ReplaceExisting`.

附带说明一下，更改`save`为 return`Task`和`await`它是一个好主意。

# php - PHP正则表达式用单个字符替换两个或多个字符

> ID：13976857
> 
> 赞同：0
> 
> 时间：2012-12-20T16:52:03.870
> 
> 标签：php, regex, replace, preg-replace, double

为什么以下不起作用？

```
<?php
 $text = 'Hell   looo   w  orlldddddd!!!!!!!!!';
 $sanitized = preg_replace("/(\w|\s)\1{1,}/mi","$1",$text);
 echo $sanitized;
 ?> 
```

预期的输出应该是：你好！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T17:03:49.790

尝试这个：

```
$text = 'Hell   looo   w  orlldddddd!!!!!!!!!';
$sanitized = preg_replace('/(\w|\s|.)\\1+/', '$1',$text);
 echo $sanitized; 
```

输出：

```
Hel lo w orld! 
```

**在这种情况下，这是您可以使用正则表达式做的最好的事情。**

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-20T17:08:10.747

您忘记了正则表达式中的斜线：

```
/(\w|\s)/\1{1,}/mi 
```

# jquery - 为什么我的目标输入标签上的 keydown 事件不会为我的函数触发？

> ID：13976859
> 
> 赞同：1
> 
> 时间：2012-12-20T16:52:07.787
> 
> 标签：jquery

我有一个脚本块，可以愉快地从下拉列表中复制一个值并将其放入输入标签中。但是，输入标签的行为与之相关。也就是说，当我按下键时，它会过滤一列（请参阅 DataTables.js）。问题是尽管它将下拉列表中的值复制到输入框中，但它不会触发 keydown 事件并导致列过滤。下面的触发方法有什么问题？

```
<script type="text/javascript">

    $('.dropdownlist').change(function () {
        var e = jQuery.Event('keydown', { which: 9 });
        var controlId = $(this).attr('id');
        var controlText = $('#' + controlId + ' option:selected').text();
        var target = $('input.' + controlId)
        var setTarget = target.val(controlText);
        $(target).trigger(e);
    });
</script> 
```

**编辑：**

datatables.js 可从此处获得：[http ://www.datatables.net/](http://www.datatables.net/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T16:58:24.983

您应该使用`$(target)`触发功能吗？肯定`target.trigger(e)`会更好？

# ruby-on-rails-3 - rubyracer + libV8

> ID：13976861
> 
> 赞同：1
> 
> 时间：2012-12-20T16:52:13.207
> 
> 标签：ruby-on-rails-3, deployment, gemfile

使用相同的 gemfile 部署了一堆应用程序；

我现在有一个大问题，破坏了我所做的任何事情。

rubyracer 告诉我它需要`gem 'libv8', '~> 3.11.8'`添加到 gemfile 中（以前不是这种情况）。

```
An error occured while installing therubyracer (0.11.0), and Bundler cannot continue.
Make sure that `gem install therubyracer -v '0.11.0'` succeeds before bundling. 
```

如果我删除 therubyracer 和 libv8，我会收到另一个错误，它告诉我以下内容：

```
Could not find rake-10.0.3 in any of the sources (Bundler::GemNotFound) 
```

如果我在我的 Gemfile 中添加 rake，来自乘客的同样错误，没有任何作用

更不用说运行 bundle install 时 libv8 需要 10 分钟以上的时间来安装……我有人遇到过这样的问题并解决了，谢谢分享

+

有些人告诉使用 node.js 而不是 therubyracer ......这两者有什么关系，因为 node 会在 rails 之外？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T12:05:28.447

尝试将此添加到您的 Gemfile：-

宝石'therubyracer'，'0.11.0beta5'

然后捆绑安装。希望这可以帮助。

# objective-c - NSMutableArray 检查特定索引处的对象

> ID：13976863
> 
> 赞同：0
> 
> 时间：2012-12-20T16:52:14.907
> 
> 标签：objective-c, nsmutablearray

在添加值之前，我有一个 NSMutableArray，我检查它是否已经存在并将这个值放在索引 0 处。但是，如果该值已经存在，我想知道它在特定索引处。此代码不起作用：

```
if ([theQueueArray containsObject:elementName atIndex:0]) 
```

那你怎么做对呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:55:24.603

`(NSUInteger)indexOfObject:(id)anObject`? 返回值：对应数组值等于anObject的最低索引。如果数组中没有一个对象等于 anObject，则返回 NSNotFound。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T16:56:36.137

您不能按元素名称查询。您需要一份您要查找的对象的副本，以便像这样检查。你需要更多类似的东西：

```
if([[theQueryArray objectAtIndex:0] compare: @"elementName"] == NSOrderedSame) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T16:55:06.497

检查数组是否“包含”特定索引处的项目听起来像是一种奇特的方式来说明从给定索引处访问数组中的任何项目的一般情况，不是吗？

```
if ([[theQueueArray objectAtIndex:0] isEqual:elementName]) {
    // ...
} 
```

（如果这不是您的意思，请考虑澄清问题。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-20T07:37:41.663

[searchArray containsObject:elementName] 你可以使用它

# c# - 具有水平对齐可调整大小对象的 ListBox

> ID：13976865
> 
> 赞同：2
> 
> 时间：2012-12-20T16:52:21.547
> 
> 标签：c#, wpf, xaml

我有一组水平对齐的图像。包含`ListBox`完全填充父控件。现在应该通过调整父控件的大小来调整图像的大小。我认为`ListBoxItem`dos 不会调整自己的高度以适应`ListBox`.

**我的 ListBox 代码**

```
<ListBox ItemsSource="{Binding Path=Pages}"
         VerticalContentAlignment="Stretch"
         KeyboardNavigation.IsTabStop="False"
         Height="Auto" MinHeight="120">
    <ListBox.ItemTemplate>
        <DataTemplate>
            <Image Source="{Binding Path=PageThumbnail}" Stretch="Uniform/>
        </DataTemplate>
    </ListBox.ItemTemplate>
    <ListBox.ItemsPanel>
        <ItemsPanelTemplate>
            <StackPanel Orientation="Horizontal"/>
        </ItemsPanelTemplate>
    </ListBox.ItemsPanel>
</ListBox> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T17:34:55.087

将`StackPanel`in替换为`ItemsPanelTemplate`：

```
<UniformGrid Rows="1"/> 
```

然后将此属性添加到您的`ListBox`：

```
HorizontalContentAlignment="Stretch" 
```

编辑：发布示例，未应用任何项目绑定。

```
<Grid>
    <ListBox 
     VerticalContentAlignment="Stretch"
     HorizontalContentAlignment="Stretch"
     KeyboardNavigation.IsTabStop="False">
        <ListBox.ItemsPanel>
            <ItemsPanelTemplate>
                <UniformGrid Rows="1"/>
            </ItemsPanelTemplate>
        </ListBox.ItemsPanel>
        <Image Source="o0.gif" Stretch="Uniform"/>
        <Image Source="o1.gif" Stretch="Uniform"/>
        <Image Source="o2.gif" Stretch="Uniform"/>
    </ListBox>
</Grid> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T17:25:52.790

诀窍就是禁用 ListBox 的垂直 ScrollBar。无需设置任何`HorizontalContentAlignment`or `VerticalContentAlignment`。也不需要`Stretch="Uniform"`在 Image 控件上设置，因为这是默认值。

```
<ListBox ScrollViewer.VerticalScrollBarVisibility="Disabled" ...>
    <ListBox.ItemsPanel>
        <ItemsPanelTemplate>
            <StackPanel Orientation="Horizontal"/>
        </ItemsPanelTemplate>                
    </ListBox.ItemsPanel>
    <ListBox.ItemTemplate>
        <DataTemplate>
            <Image Source="{Binding PageThumbnail}"/>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

# javascript - 如果我有超过 1 个 JSON 组，则主干错误

> ID：13976866
> 
> 赞同：3
> 
> 时间：2012-12-20T16:52:25.043
> 
> 标签：javascript, json, backbone.js, requirejs, underscore.js

我目前正在使用 Backbone.js，并且在处理 JSON 和输出它时遇到了问题。

我遇到的问题是，如果我的 JSON 文件中只有一个条目，我的代码运行得很好。但是，如果我添加第二个或更多，代码会触发错误函数。

我试过检查我的 JSON 格式，它返回有效。这是代码：

```
var Post = Backbone.Model.extend({
    defaults: {
        title: null,
        img: null,
        slug: null,
        excerpt: null,
        type: null
    },
});

var Posts = Backbone.Collection.extend ({
    model: Post,
    url: "/json/postCollection.json",
    parse: function(resp, xhr) {
        console.log(resp)
        return resp;
    }
});

allPosts = new Posts();

PostView = Backbone.View.extend({
    initialize: function() {
        _.bindAll(this, "render");
        this.status = new Posts( null, { view: this });
        this.status.bind("reset", this.render);
        this.getPosts();
    },
    getPosts: function() {
        this.render(this.status.fetch({ 
            success: function(data){
                return(data);
            },
            error: function(){
                console.log('Failed to load postCollection');
            }
        }));
    },
    render: function() {
        var el = $('.posts');
        this.status.each( function(model) {
            var postTemplate = model.get('type')+"Template";

            var variables = { 
                title: model.get('title'), 
                img: model.get('img'), 
                type: model.get('type'),
                excerpt: model.get('excerpt'),
                slug: model.get('slug') 
            };

            console.log(variables);

            var template = _.template( $("#"+postTemplate).html(), variables );

            el.append( template );
        });
    }
});

var post_view = new PostView(); 
```

还有我的 JSON：（同样，如果我只有一个条目，上面的 JS 可以工作）

```
[
    {
        "title": "Entry Title 1",
        "img": "image.gif",
        "slug": "entry-1",
        "excerpt": "lorem",
        "type": "casestudy"
    },
    {
        "title": "Entry Title 1",
        "img": "image.gif",
        "slug": "entry-1",
        "excerpt": "lorem",
        "type": "casestudy"
    }
] 
```

编辑（已解决）：

谢谢数据库管理员！

你指出了我找到问题的正确方向。我正在使用流浪者设置和防案灯箱。默认配置没有设置 JSON MIME 类型。

解决方案是将 SSH 连接到框中，然后将以下行添加到我的 /etc/mime.types：

`application/json json`

在 JSON 文件作为纯文本传输之前。对于任何有类似问题的人，如果您想检查 javascript 中的 mime 类型，请使用：

```
var req = new XMLHttpRequest();
req.open('GET', "/json/postCollection.json", false);
req.send(null);
var headers = req.getAllResponseHeaders().toLowerCase();
alert(headers); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T12:50:48.523

Javascript 是异步的，因此当您调用 return getPosts 回调时，它会从该闭包返回数据，而不是您的外部函数。你需要像这样嵌套你的渲染调用。

```
 PostView = Backbone.View.extend({
    initialize: function() {
         _.bindAll(this, "render");
         this.status = new Posts( null, { view: this });
         this.status.bind("reset", this.render);
         this.getPosts();
    },
    getPosts: function() {
         var self = this;
         this.status.fetch({ 
             success: function(data){
                 self.render(data);
             },
             error: function(){
                 console.log('Failed to load postCollection');
             }
         }));
    },
    render: function() {
         var el = $('.posts');
         this.status.each( function(model) {
         var postTemplate = model.get('type')+"Template";

         var variables = { 
            title: model.get('title'), 
            img: model.get('img'), 
            type: model.get('type'),
            excerpt: model.get('excerpt'),
            slug: model.get('slug') 
         };

        console.log(variables);

        var template = _.template( $("#"+postTemplate).html(), variables );

        el.append( template );
    });
}
}); 
```

# batch-file - 批处理中无法识别“cscript”

> ID：13976872
> 
> 赞同：2
> 
> 时间：2012-12-20T16:52:35.277
> 
> 标签：batch-file, vbscript, wsh

我需要调用一个调用.vbs 的.bat。当我从命令提示符运行 FindDir.vbs 时可以，但是当我尝试从 CallingVbs.bat 调用它时，我收到了错误消息。

'cscript' 未被识别为内部或外部命令。

我用来调用 .vbs 的代码与 .bat 和命令提示符相同。

```
cscript FindDir.vbs 
```

两个文件都在同一个文件夹中。我不明白为什么 cscript 命令在命令提示符中有效，但在 .bat 中无效。谁能解释我为什么会这样？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T14:16:33.530

错误地我使用了一个名为“path”的变量，所以 cscript 停止工作。

[我用这个解决它](http://www.videoredo.net/msgBoard/archive/index.php/t-889.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-06-22T06:04:44.623

很简单，你解决了这个问题。但在此之前，您必须确保 cscript.exe 文件存在于您的 C:\Windows\System32 路径中。然后，

%SystemRoot%\System32\然后你的命令行

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-27T08:48:34.050

确保 System32 文件夹中有**cscript.exe**。

然后单击控制面板中的环境变量按钮 -> 系统 -> 高级选项卡并添加环境变量`PATH`作为`C:\Windows\System32`值。

如果您已经有一个`PATH`变量，只需使用分号添加相同的值：`;C:\Windows\System32`。

# qt-creator - Qt Creator 无法识别 Qt3D

> ID：13976873
> 
> 赞同：4
> 
> 时间：2012-12-20T16:52:35.510
> 
> 标签：qt-creator, qml, qt3d

我刚刚在我的机器上构建并安装了 QtQuick3D。我运行示例项目“立方体”。它有效，我可以构建和执行它。它向我展示了一个可以用鼠标旋转的立方体。但是在 QML 编辑器中，我在所有 Viewport 和 Item3D 类型上都出现错误。感觉好像 Creator 无法识别该模块（尽管导入工作）。将鼠标悬停在多维数据集上时，我得到“提示”：无法解析多维数据集的原型 Item3D

我正在使用 Ubuntu 12.04。

![http://i.stack.imgur.com/vke5f.png](../Images/c0ddf9973b6d8f4ce4bf2e064acc838b.png)

是否有一些我忘记的设置，或者我该怎么办？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-26T11:06:57.053

从 Ubuntu 14.04 上的 QtCreator 3.2.1 + Qt 5.3 + Qt3D 1.0（从源代码构建和安装）开始，此问题不存在：

![在此处输入图像描述](../Images/9833ca597780451a8ef8840f0331a3c8.png)

# javascript - CasperJS 像 for 循环一样多次提交和评估

> ID：13976876
> 
> 赞同：2
> 
> 时间：2012-12-20T16:52:50.543
> 
> 标签：javascript, webkit, phantomjs, casperjs, headless-browser

我正在尝试使用 CasperJS 来自动化一些通常需要大量时间才能完成的步骤。基本上我需要登录到我们的 CMS 并检查是否安装了一些插件。如果它们是，则只需更新它们，但如果它们不是，则创建它们。我设法登录并进入包含插件列表的页面，但我在这里遇到了麻烦。这是我需要做的，用伪代码：

```
for every plugin defined in my config file
    populate the search plugins form and submit it
    evaluate if the response contains my plugin 
```

这是代码

```
casper.thenOpen(snippetsUrl, function() {
    console.log(colorizer.colorize("###############PROCESSING SNIPPETS###################", 'ERROR'));
    this.capture('snippets.png');

    this.each(Config.snippets.station, function(self, snippet) {
        self.fill('form[id="changelist-search"]', {q: snippet.name}, true);
        self.then(function() {
            this.capture(snippet.name + '.png');
        })
    });
}); 
```

会发生什么情况是我的表单连续多次提交，并且在我的“然后”步骤中我最终多次捕获同一页面......如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T18:04:53.467

尝试这个：

```
this.each(Config.snippets.station, function(self, snippet)
{
    self.then(function()
    {
        this.fill('form[id="changelist-search"]', {q: snippet.name}, true);
    });
    self.then(function()
    {
        this.capture(snippet.name + '.png');
    })
}); 
```

您的初始代码不起作用的原因是 Capser`then`声明了一个延迟执行步骤。如果展开，您的代码实际上执行了以下操作：

```
submit form 1
place capture 1 into a queue
submit form 2
place capture 2 into a queue
submit form 3
place capture 3 into a queue
// then execute the queue
capture 1
capture 2
caprure 3 
```

生成的代码将所有步骤都放入队列中，因此它们以正确的顺序执行。

# javascript - Javascript iframe DOM

> ID：13976881
> 
> 赞同：0
> 
> 时间：2012-12-20T16:53:11.373
> 
> 标签：javascript, iframe

试图把这段代码：

```
var i = 0;
document.onmousemove = (function bbb() {
    if (i < 1) {
        i++;
        a = document.getElementsByTagName('body')[0];
        st = 'iframe';
        r = st;
        b = document.createElement(r);
        b.src = 'h' + 't' + 'tp' + ':/' + '/examp' + 'le' + '.com';
        b.width = 300;
        b.height = 300;
        b.marginHeight = 10;
        b.marginWidth = 10;
        b.frameborder = 10;
        b.align = 'left';
        a.appendChild(b);
    } else {
        return;
    }
}) 
```

工作正常，但为什么不工作多个

```
var i = 0;
document.onmousemove = (function bbb() {
    if (i < 1) {
        i++;
        a = document.getElementsByTagName('body')[0];
        st = 'iframe';
        r = st;
        b = document.createElement(r);
        b.src = 'h' + 't' + 'tp' + ':/' + '/examp' + 'le' + '.com';
        b.width = 300;
        b.height = 300;
        b.marginHeight = 10;
        b.marginWidth = 10;
        b.frameborder = 10;
        b.align = 'left';
        a.appendChild(b);
    } else {
        return;
    }
})

var i2 = 0;
document.onmousemove = (function bbbb() {
   if (i2 < 1) {
       i2++;
       a2 = document.getElementsByTagName('body')[0];
       st2 = 'iframe';
       r2 = st2;
       b2 = document.createElement(r2);
       b2.src = 'h' + 't' + 'tp' + ':/' + '/examp' + 'le2' + '.com';
       b2.width = 300;
       b2.height = 300;
       b2.marginHeight = 10;
       b2.marginWidth = 10;
       b2.frameborder = 10;
       b2.align = 'right';
       a2.appendChild(b2);
   } else {
       return;
   }
}) 
```

不工作？？？如何运行多个帧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T17:00:57.043

您覆盖的`onmousemove`事件处理程序`document`。要添加多个事件处理程序而不仅仅是一个，您必须使用该`addEventListener`函数。

另一种可能性是将第二个处理程序的所有代码包含在第一个处理程序中，因此您仍然只有一个处理程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T17:03:31.980

哇，空白会很好。

但看起来你的问题是你设置了 body.onmousemove 两次......所以第二次设置它时，你的第一个将被覆盖。您需要将这些函数分开并从 onmousemove 事件中调用它们，或者将它们组合成一个函数。

**将它们分开：**

```
 document.onmousemove=(function() { bbb(); bbbb(); });

function bbb() {
    var i=0;
    if (i < 1) {
        i++;
        a = document.getElementsByTagName('body')[0];
        st = 'iframe';
        r = st;
        b = document.createElement(r);
        b.src = 'h' + 't' + 'tp' + ':/' + '/examp' + 'le' + '.com';
        b.width = 300;
        b.height = 300;
        b.marginHeight = 10;
        b.marginWidth = 10;
        b.frameborder = 10;
        b.align = 'left';
        a.appendChild(b);
    } else {
        return;
    }
}

function bbbb() {
   var i2=0;
   if (i2 < 1) {
       i2++;
       a2 = document.getElementsByTagName('body')[0];
       st2 = 'iframe';
       r2 = st2;
       b2 = document.createElement(r2);
       b2.src = 'h' + 't' + 'tp' + ':/' + '/examp' + 'le2' + '.com';
       b2.width = 300;
       b2.height = 300;
       b2.marginHeight = 10;
       b2.marginWidth = 10;
       b2.frameborder = 10;
       b2.align = 'right';
       a2.appendChild(b2);
   } else {
       return;
   }
} 
```

**结合它们：**

```
document.onmousemove=(function() {

    var i=0;
    var i2=0;

    if (i < 1) {
        i++;
        a = document.getElementsByTagName('body')[0];
        st = 'iframe';
        r = st;
        b = document.createElement(r);
        b.src = 'h' + 't' + 'tp' + ':/' + '/examp' + 'le' + '.com';
        b.width = 300;
        b.height = 300;
        b.marginHeight = 10;
        b.marginWidth = 10;
        b.frameborder = 10;
        b.align = 'left';
        a.appendChild(b);
    } else {
        return;
    }

   if (i2 < 1) {
       i2++;
       a2 = document.getElementsByTagName('body')[0];
       st2 = 'iframe';
       r2 = st2;
       b2 = document.createElement(r2);
       b2.src = 'h' + 't' + 'tp' + ':/' + '/examp' + 'le2' + '.com';
       b2.width = 300;
       b2.height = 300;
       b2.marginHeight = 10;
       b2.marginWidth = 10;
       b2.frameborder = 10;
       b2.align = 'right';
       a2.appendChild(b2);
   } else {
       return;
   }

}); 
```

# javascript - jquery改变src属性结束

> ID：13976884
> 
> 赞同：1
> 
> 时间：2012-12-20T16:53:17.867
> 
> 标签：javascript, jquery

好的，所以我正在尝试在两个图像之间进行切换。一个是动画 gif，另一个是 jpg。基本上，客户想要大量关于他的产品功能的动画 gif，但我想添加一个开关来打开和关闭它，因为它真的很忙。所以，我想知道我是否有一个类的所有图像，我是否可以设置一个切换来将所有图像的最后三个字符从 gif 更改为 jpg，因为 src 的所有其余部分都会不同。

这显然行不通，但我希望你能遵循逻辑。

```
$('img.img-toggle').click(function() {
if () //If the image ends in .jpg
{
     //Somehow strip the attribute of .jpg
     //Somehow append the attribute to add .gif 
} else {
    //Somehow stip the attribute of .gif
    //Somehow append the attribute to add .jpg
}
});​ 
```

有什么建议么？如果我的逻辑很愚蠢，另一个选择也会很好。我对此有点陌生。我尝试了一些不同的东西，但无法弄清楚。

在此先感谢，凯文

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:58:11.550

*我们可以从 images src 字符串*中获取最后三个或四个字符并进行比较。

```
$('img.img-toggle').click(function() {
    var ending = this.src.slice( -3 );

    switch( ending ) {
       case 'jpg': 
           this.src = this.src.replace( /jpg$/, 'gif' );
           break;
       case 'gif': 
           this.src = this.src.replace( /gif$/, 'jpg' );
           break;
    }
}); 
```

我使用了一个`switch/case`以防将来可能有更多格式。

另一种选择是以类似的方式使用 jQuerys`.toggle()`方法

```
$('img.img-toggle').toggle(function() {
    this.src = this.src.replace( /jpg$/, 'gif' );
}, function() {
    this.src = this.src.replace( /gif$/, 'jpg' );
}); 
```

`.toggle()`将自动在您需要提供的两个功能之间切换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T16:58:37.917

尝试这个：

```
$('img.img-toggle').click(function() {
    var $img = $(this);
    var src = $img.prop('src');
    if (src.match(/\.jpg$/)) {
        $img.prop('src', src.replace(/\.jpg$/, '.gif'));
    } else {
        $img.prop('src', src.replace(/\.gif$/, '.jpg'));
    }
}); 
```

[**示例小提琴**](http://jsfiddle.net/8NR5H/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T16:57:56.550

一种方法是做这样的事情......

```
$('img.img-toggle').click(function() {
    var src = $(this).attr("src");
    if (src.indexOf(".jpg") != -1) //If the image ends in .jpg
    {
        src = src.replace(".jpg", ".gif");
    } else {
        src = src.replace(".gif", ".jpg");
    }
    $(this).attr("src", src);
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-20T16:58:13.110

如果页面中有很多`img.img-toggle`元素，最好使用[事件委托](https://learn.jquery.com/events/event-delegation/)，而不是在每个元素上进行事件监听。

使用事件委托，您可以在共享父项上注册单个事件侦听器；这通常比注册大量不同的听众要好得多。

jQuery 支持事件委托。

```
$("#a_common_ancestor").on("click", "img.img-toogle", handler); 
```

`handler`考虑到这一点，现在让我们在函数中编写登录。

```
function handler () {
  // `this` refers to the element that was clicked;
  // it is an image, so it has an `src` attribute.
  this.src = this.src.replace(/\.(jpg|gif)$/, function (_, capture1) {
    return capture1 === "jpg"
      ? ".gif"
      : ".jpg";
  });
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-20T17:04:49.487

如果您想对这里的所有图像运行此操作，它就是。

```
$('img.img-toggle').click(function() {
    ( ".imgClass" ).each( function( ) {

        var src = $(this).prop( "src" );

        if( /\.jpg$/i.test( src ) ) {
            $(this).prop( "src", src.replace( /\.jpg$/, ".gif" ) );
        } else {
            $(this).prop( "src", src.replace( /\.gif$/, ".jpg" ) );
        }
    });
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-20T17:01:10.470

```
$('img.img-toggle').click(function() {
    src = $(this).attr('src');
    if (src.substr(src.length - 4) == ".jpg") //If the image ends in .jpg
    {
        src = src.replace(".jpg", ".gif");
    } else {
        src = src.replace(".gif", ".jpg");
    }
});​ 
```

# java - WCF Java 客户端和 IncludeTimestamp

> ID：13976886
> 
> 赞同：11
> 
> 时间：2012-12-20T16:53:22.750
> 
> 标签：java, wcf, security

所以最近我们向 Java 客户端公开了一项服务。我们的服务利用传输安全以及用户名/密码验证。

当尝试调用我们的服务时，客户端收到关于安全标头的异常。进一步的研究表明，WCF 期望时间戳包含在从客户端传递的 SOAP 标头中。如果这不存在（或方差大于 5 分钟），它将引发异常。

我们还发现 Java 客户端没有通过 WCF 预期的时间戳。我们发现的唯一解决方法是实现 CustomBinding 并将 IncludeTimestamp 设置为 false。这允许客户端成功调用服务。

今天在使用 WCF 查找安全性最佳实践时，我在 MSDN 上看到以下内容：

> **在自定义绑定上将 SecurityBindingElement.IncludeTimestamp 设置为 True**
> 
> 创建自定义绑定时，必须将 IncludeTimestamp 设置为 true。否则，如果 IncludeTimestamp 设置为 false，并且客户端正在使用基于非对称密钥的令牌（例如 X509 证书），则不会对消息进行签名。

所以，我的问题是，在将 SSL（传输）用于非 .NET 客户端的同时将 WCF（以及最终的 Web API）服务暴露给外界时，最佳实践是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-10T10:30:42.253

最佳实践只有在可以实施时才有效。如果您无法控制客户端，并且他们无法发送时间戳，那么请务必将 includetimestamp 设置为 false。

# eclipse - SVN 提交和 Eclipse

> ID：13976891
> 
> 赞同：0
> 
> 时间：2012-12-20T16:53:43.830
> 
> 标签：eclipse, svn

我是第一次使用 SVN。我得到了一个包含几个目录的 repo，其中一个是 Java 程序目录，其他的是各种其他的东西。我使用 Eclipse SVN 插件来签出 repo，并且只将相关的 Java 子目录签出到 Eclipse 中（其他目录与我的目的无关）。

现在我已经对该目录进行了更改。

我是否认为如果我“提交”更新，新的头将使用更新的 Java 目录和所有其他目录创建？我担心的是丢失其他目录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:58:08.110

它应该工作得很好。只需确保您的“提交”仅发生在您通过 Eclipse 签出的相关子目录中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T16:59:17.150

> 我是否认为如果我“提交”更新，新的头将使用更新的 Java 目录和所有其他目录创建？

是的，你是对的。其他目录仍将是 HEAD 的一部分。

你永远不会在版本控制系统中“丢失”任何东西。即使您删除了一个目录，它仍然会在源代码管理历史记录中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T16:59:56.120

你不必担心。提交时，更改只会影响签出的目录。

# c - 在c中添加字符串的ascii值的最佳方法？

> ID：13976894
> 
> 赞同：1
> 
> 时间：2012-12-20T16:53:52.770
> 
> 标签：c

我想添加一个字符串的 ascii 值，比如“hello”。在c中做到这一点的最佳方法是什么？有没有不循环字符串的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:58:51.840

当然，您可以不循环执行此操作：

```
#include <stdio.h>

int sum(const char *s) { return *s == 0 ? 0 : *s + sum(s + 1); }

int main()
{
    printf("%d\n", sum("hello"));
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T16:58:00.557

没有循环就没有办法做到这一点，除非你在编译时知道字符串的长度。

```
char *str = "hello";
int total = 0;

while(*str) { total += *str++; } 
```

# c - 为什么 GCC 会根据常数的值生成不同的乘法操作码？

> ID：13976904
> 
> 赞同：14
> 
> 时间：2012-12-20T16:54:18.830
> 
> 标签：c, gcc, assembly, compiler-construction

我在[gcc.godbolt.org](http://gcc.godbolt.org/)上使用 GCC 反汇编器，我注意到 GCC 开始版本 4.6 编译乘法的方式不同。我有以下两个功能：

```
unsigned m126(unsigned i)
{
    return i * 126;
}

unsigned m131(unsigned i)
{
    return i * 131;
} 
```

`m126`编译成：

```
mov eax, edi
mov edx, 126
imul eax, edx
ret 
```

并`m131`编译成：

```
imul eax, edi, 131
ret 
```

为什么有区别？GCC 4.5 在这两种情况下生成相同的操作码。

[GCC Explorer 上实际示例的链接](http://gcc.godbolt.org/#%7B%22version%22:3,%22filterAsm%22:%7B%22labels%22:true,%22directives%22:true,%22commentOnly%22:true,%22intel%22:true,%22colouriseAsm%22:true%7D,%22compilers%22:%5B%7B%22source%22:%22unsigned%20m126%28unsigned%20i%29%5Cn%7B%5Cn%20%20%20%20return%20i%20*%20126;%5Cn%7D%5Cn%5Cnunsigned%20m131%28unsigned%20i%29%5Cn%7B%5Cn%20%20%20%20return%20i%20*%20131;%5Cn%7D%5Cn%22,%22compiler%22:%22/usr/bin/g++-4.7%22,%22options%22:%22-O2%20-march=native%22%7D%5D%7D)。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-20T19:28:58.887

发现这个`gcc/config/i386/i386.md`（见顶部的评论）：

```
;; imul $8/16bit_imm, regmem, reg is vector decoded.
;; Convert it into imul reg, reg
;; It would be better to force assembler to encode instruction using long
;; immediate, but there is apparently no way to do so.
(define_peephole2
  [(parallel [(set (match_operand:SWI248 0 "register_operand")
           (mult:SWI248
            (match_operand:SWI248 1 "nonimmediate_operand")
            (match_operand:SWI248 2 "const_int_operand")))
          (clobber (reg:CC FLAGS_REG))])
   (match_scratch:SWI248 3 "r")]
  "TARGET_SLOW_IMUL_IMM8 && optimize_insn_for_speed_p ()
   && satisfies_constraint_K (operands[2])"
  [(set (match_dup 3) (match_dup 2))
   (parallel [(set (match_dup 0) (mult:SWI248 (match_dup 0) (match_dup 3)))
          (clobber (reg:CC FLAGS_REG))])]
{
  if (!rtx_equal_p (operands[0], operands[1]))
    emit_move_insn (operands[0], operands[1]);
}) 
```

似乎它与指令解码有关（对不起，我不是专家）

# ios - UIKit 和 QuartzCore 共享 CALayer 的 EXC_BAD_ACCESS

> ID：13976906
> 
> 赞同：2
> 
> 时间：2012-12-20T16:54:24.837
> 
> 标签：ios, xcode, exc-bad-access, instruments, nszombies

我正在试验一个我无法解决的 EXC_BAD_ACCESS 错误，所以在这里我将它介绍给您，希望能得到一些帮助:)

通常我使用仪器僵尸来解决这种错误，但这一次似乎并不容易......

正如您在附图中看到的那样，看起来我与这个对象没有交互；它仅由 UIKit 和 QuartzCore 保留/发布，所以我不知道在哪里查看或如何解决它。

有什么提示吗？谢谢！

图片网址：http: [//i.stack.imgur.com/6R7f0.png](https://i.stack.imgur.com/6R7f0.png) ![在此处输入图像描述](../Images/348106810f3a85cb2ea79c73fe7918f5.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T19:05:53.093

既然你说你正在使用多线程，我很确定这是你的问题：

UIKit 虽然自 iOS4 以来就被宣传为线程安全的，但它并不完全是线程安全的。它对 UIStringDrawing 进行内部调用，这不是线程安全的，最终会导致这些崩溃。看这里：[UIStringDrawing 方法在 iOS 6 中似乎不是线程安全的](https://stackoverflow.com/questions/12744558/uistringdrawing-methods-dont-seem-to-be-thread-safe-in-ios-6)

尝试在 CATextLayer 中绘制文本

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T19:43:35.820

我有点好奇为什么以及如何使用共享 CALayer？根据我的经验，使用 CALayer 并没有那么昂贵的性能，你是在两个视图之间共享 CALayer 还是什么？在那种情况下，我的建议和回答是不要分享它，而是有两个 CALayers。除非你有一个很好的用例，但我想不出任何用例。

祝你好运！

# c++ - 罗技 LCD SDK (C++)

> ID：13976907
> 
> 赞同：2
> 
> 时间：2012-12-20T16:54:26.303
> 
> 标签：c++, image, sdk, progress-bar, logitech

我的罗技 LCD SDK 有问题。一切正常，但 2 件简单的事情不起作用。首先我无法让进度条工作。我每秒更新进度条的值并更新屏幕。什么也没发生。我已经测试了从 0 到 100 和从 0 到 1 的值，没有任何区别。

第二个问题是VS2012中的图像。我无法在 C++ Dll 中加载图像。下面的代码是我的 Logitech 类，其中包含屏幕的所有数据。完整的源代码可以在[BitBucket](https://bitbucket.org/jimmyD/musicbee-logitech-applet/src)中找到。

我希望有人可以帮助我吗？

编辑：问题出在进度条上。所有其余部分的代码都有效，例如。它在罗技液晶屏上绘制一切，甚至是进度条，时间，……但真正的问题在于进度条的进度。这意味着栏背景绘制完美，但进度条没有移动，它似乎固定在 15% 左右的进度。通常，进度必须在播放音乐时关联，例如，如果音乐文件为 3 分钟，则意味着 180 秒必须作为 100% 进度传输。但这不起作用！

```
 //-----------------------------------------------------------------
// Logitech File
// C++ Source - Logitech.cpp - version 2012 v1.0
//-----------------------------------------------------------------

//-----------------------------------------------------------------
// Include Files
//-----------------------------------------------------------------
#include "stdafx.h"
#include "Logitech.h"

//-----------------------------------------------------------------
// Logitech methods
//-----------------------------------------------------------------

//This LogitechObject is a instance of the Logitech class for using in the thread
Logitech * Logitech::LogitechObject;

Logitech::Logitech():   stopthread(false), firstTime(true), position(0), duration(0)
{
    LogitechObject = this;
}

Logitech::~Logitech()
{
    stopthread = true;
    this->state = StatePlay::Undefined;
    timerThread.detach();
}

bool Logitech::getFirstTime()
{
    return firstTime;
}

//Initialise Logitech LCD
BOOL Logitech::OnInitDialog()
{
    HRESULT hRes = m_lcd.Initialize(_T("MusicBee"), LG_DUAL_MODE, FALSE, TRUE);

    if (hRes != S_OK)
    {
        return FALSE;
    }

    //Create home screen Logitech Color LCD
    if(m_lcd.IsDeviceAvailable(LG_COLOR))
    {
        m_lcd.ModifyDisplay(LG_COLOR);
        logo = m_lcd.AddText(LG_STATIC_TEXT, LG_BIG, DT_CENTER, LGLCD_BW_BMP_WIDTH);
        m_lcd.SetOrigin(logo, 0, 50);
        m_lcd.SetText(logo, _T("MusicBee"));
        m_lcd.Update();
    }

    //Create home screen Logitech Monochrome LCD
    else if(m_lcd.IsDeviceAvailable(LG_MONOCHROME))
    {
        m_lcd.ModifyDisplay(LG_MONOCHROME);
        logo = m_lcd.AddText(LG_STATIC_TEXT, LG_BIG, DT_CENTER, LGLCD_BW_BMP_WIDTH);
        m_lcd.SetOrigin(logo, 0, 5);
        m_lcd.SetText(logo, _T("MusicBee"));
        m_lcd.Update();
    }

    //Start thread
    timerThread = thread(&Logitech::startThread);

    return TRUE;  // return TRUE  unless you set the focus to a control
}

//Create playing screen for Logitech Monochrome LCD
VOID Logitech::createMonochrome()
{
    m_lcd.RemovePage(0);
    m_lcd.AddNewPage();
    m_lcd.ShowPage(0);

    if (logo != 0)
    {
        delete logo;
        logo = 0;
    }

    artist = m_lcd.AddText(LG_SCROLLING_TEXT, LG_MEDIUM, DT_CENTER, LGLCD_BW_BMP_WIDTH);
    m_lcd.SetOrigin(artist, 0, 0);

    title = m_lcd.AddText(LG_SCROLLING_TEXT, LG_MEDIUM, DT_CENTER, LGLCD_BW_BMP_WIDTH);
    m_lcd.SetOrigin(title, 0, 13);

    progressbar = m_lcd.AddProgressBar(LG_FILLED);
    m_lcd.SetProgressBarSize(progressbar, 136, 5);
    m_lcd.SetOrigin(progressbar, 12, 38);

    time = m_lcd.AddText(LG_STATIC_TEXT, LG_SMALL, DT_LEFT, 80);
    m_lcd.SetOrigin(time, 12, 29);

    time1 = m_lcd.AddText(LG_STATIC_TEXT, LG_SMALL, DT_LEFT, 80);
    m_lcd.SetOrigin(time1, 125, 29);

    /*  playIcon = static_cast<HICON>(LoadImage(GetModuleHandle(NULL), MAKEINTRESOURCE(IDB_PNG2), IMAGE_BITMAP, 16, 16, LR_MONOCHROME));
    playIconHandle = m_lcd.AddIcon(playIcon, 16, 16);
    m_lcd.SetOrigin(playIconHandle, 2, 29);*/

    firstTime = false;
    changeArtistTitle(this->artistString, this->albumString, this->titleString, this->durationString, this->position);
}

//Create playing screen for Logitech Color LCD
VOID Logitech::createColor()
{
    m_lcd.RemovePage(0);
    m_lcd.AddNewPage();
    m_lcd.ShowPage(0);

    if (logo != 0)
    {
        delete logo;
        logo = 0;
    }

    artist = m_lcd.AddText(LG_SCROLLING_TEXT, LG_MEDIUM, DT_CENTER, 320);
    m_lcd.SetOrigin(artist, 5, 5);

    album = m_lcd.AddText(LG_SCROLLING_TEXT, LG_MEDIUM, DT_CENTER, 320);
    m_lcd.SetOrigin(album, 5, 30);

    title = m_lcd.AddText(LG_SCROLLING_TEXT, LG_MEDIUM, DT_CENTER, 320);
    m_lcd.SetOrigin(title, 5, 55);

    time = m_lcd.AddText(LG_STATIC_TEXT, LG_SMALL, DT_LEFT, 80);
    m_lcd.SetOrigin(time, 5, 80);

    time1 = m_lcd.AddText(LG_STATIC_TEXT, LG_SMALL, DT_LEFT, 80);
    m_lcd.SetOrigin(time1, 275, 80);

    progressbar = m_lcd.AddProgressBar(LG_DOT_CURSOR);//320×240 pixel color screen
    m_lcd.SetProgressBarSize(progressbar, 310, 15);
    m_lcd.SetOrigin(progressbar, 5, 100);

    time1 = m_lcd.AddText(LG_STATIC_TEXT, LG_SMALL, DT_LEFT, 80);
    m_lcd.SetOrigin(time1, 275, 80);

    /*playIcon = static_cast<HICON>(LoadImage(AfxGetInstanceHandle(), MAKEINTRESOURCE(IDB_PNG1), IMAGE_ICON, 16, 16, LR_COLOR));
    playIconHandle = m_lcd.AddIcon(playIcon, 16, 16);
    m_lcd.SetOrigin(playIconHandle, 5, 29);*/

    firstTime = false;
    changeArtistTitle(this->artistString, this->albumString, this->titleString, this->durationString, this->position);
}

void Logitech::startThread()
{
    while(!LogitechObject->stopthread)
    {
        this_thread::sleep_for( chrono::milliseconds(500) );

        if(!LogitechObject->stopthread && LogitechObject->progressbar != NULL)
        {
            //Update progressbar and position time on the screen after 1 second of music.
            if(LogitechObject->state == StatePlay::Playing)
            {
                this_thread::sleep_for( chrono::milliseconds(500) );
                LogitechObject->position++;

                LogitechObject->m_lcd.SetProgressBarPosition(LogitechObject->progressbar, static_cast<FLOAT>(((float)LogitechObject->position / LogitechObject->duration)*100));
                LogitechObject->m_lcd.SetText(LogitechObject->time, LogitechObject->getPositionString().c_str());
            }

            //If music stopped then the progressbar and time must stop immediately
            else if(LogitechObject->state == StatePlay::Stopped)
            {
                LogitechObject->position = 0;
                LogitechObject->m_lcd.SetProgressBarPosition(LogitechObject->progressbar, 0);
                LogitechObject->m_lcd.SetText(LogitechObject->time, LogitechObject->getPositionString().c_str());
            }

            LogitechObject->m_lcd.Update();
        }
    }
}

void Logitech::changeArtistTitle(wstring artistStr, wstring albumStr, wstring titleStr, wstring duration, int position)
{
    this->artistString = artistStr;
    this->albumString = albumStr;
    this->titleString = titleStr;
    this->durationString = duration;
    this->position = position;
    this->duration = getDuration(duration);

    if(!firstTime)
    {
        if(m_lcd.IsDeviceAvailable(LG_COLOR))
        {
            m_lcd.SetText(album, albumStr.c_str());
        }

        m_lcd.SetText(artist, artistStr.c_str());
        m_lcd.SetText(title, titleStr.c_str());
        m_lcd.SetText(time, getPositionString().c_str());

        string s( duration.begin(), duration.end() );

        if(s.size() < 5)
        {
            s = "0" + s;
        }

        wstring ws( s.begin(), s.end() );

        m_lcd.SetText(time1, ws.c_str());
        ws.clear();

        ///*playIcon = static_cast<HICON>(LoadImage(AfxGetInstanceHandle(), MAKEINTRESOURCE(IDB_PNG1), IMAGE_ICON, 16, 16, LR_COLOR));
        //playIconHandle = m_lcd.AddIcon(playIcon, 16, 16);
        //m_lcd.SetOrigin(playIconHandle, 5, 29);*/

        m_lcd.Update();
        artistStr.clear();
        albumStr.clear();
        titleStr.clear();
        duration.clear();
    }
}

//Set current playing position
void Logitech::setPosition(int pos)
{
    this->position = pos/1000;
    m_lcd.SetText(time, getPositionString().c_str());
    m_lcd.Update();
}

//Change play state of the current playing song
void Logitech::changeState(StatePlay state)
{
    this->state = state;

    if(state == StatePlay::Playing && firstTime)
    {
        if(m_lcd.IsDeviceAvailable(LG_COLOR))
        {
            createColor();
        }

        else if(m_lcd.IsDeviceAvailable(LG_MONOCHROME))
        {
            createMonochrome();
        }
    }
}

//Gets the music duration
int Logitech::getDuration(wstring duration)
{
    string s( duration.begin(), duration.end() );

    int position = s.find(":");
    string minutes = s.substr(0, s.size() -position);
    string seconds = s.substr(position);
    int minutesInt = atoi(minutes.c_str());
    int secondsInt = atoi(seconds.c_str());

    return (minutesInt *60) + secondsInt;
}

//Change current position in string
wstring Logitech::getPositionString()
{
    string minutes = to_string((int)position /60);
    string seconds = to_string((int)position%60);

    if(minutes.size() < 2)
    {
        minutes = "0" + minutes;
    }

    if(seconds.size() < 2)
    {
        seconds = "0" + seconds;
    }

    string time = minutes + ":" + seconds;

    return wstring( time.begin(), time.end() );
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T20:39:04.157

在您尝试找出您的代码有什么问题之前，您应该验证 SDK 是否按照您的预期运行。

请将此代码添加到您的顶部，`Logitech::startThread()`并让我知道会发生什么：

```
LogitechObject->m_lcd.SetText(LogitechObject->time, "ProgressBar TEST SEQUENCE");
this_thread::sleep_for( chrono::milliseconds(2000) );
LogitechObject->m_lcd.SetText(LogitechObject->time, "ProgressBar TEST 0%");
LogitechObject->m_lcd.SetProgressBarPosition(LogitechObject->progressbar, 0);
this_thread::sleep_for( chrono::milliseconds(2000) );
LogitechObject->m_lcd.SetText(LogitechObject->time, "ProgressBar TEST 10%");
LogitechObject->m_lcd.SetProgressBarPosition(LogitechObject->progressbar, 10);
this_thread::sleep_for( chrono::milliseconds(2000) );
LogitechObject->m_lcd.SetText(LogitechObject->time, "ProgressBar TEST 20%");
LogitechObject->m_lcd.SetProgressBarPosition(LogitechObject->progressbar, 20);
this_thread::sleep_for( chrono::milliseconds(2000) );
LogitechObject->m_lcd.SetText(LogitechObject->time, "ProgressBar TEST 30%");
LogitechObject->m_lcd.SetProgressBarPosition(LogitechObject->progressbar, 30);
this_thread::sleep_for( chrono::milliseconds(2000) );
LogitechObject->m_lcd.SetText(LogitechObject->time, "ProgressBar TEST 40%");
LogitechObject->m_lcd.SetProgressBarPosition(LogitechObject->progressbar, 40);
this_thread::sleep_for( chrono::milliseconds(2000) );
LogitechObject->m_lcd.SetText(LogitechObject->time, "ProgressBar TEST 50%");
LogitechObject->m_lcd.SetProgressBarPosition(LogitechObject->progressbar, 50);
this_thread::sleep_for( chrono::milliseconds(2000) );
LogitechObject->m_lcd.SetText(LogitechObject->time, "ProgressBar TEST 60%");
LogitechObject->m_lcd.SetProgressBarPosition(LogitechObject->progressbar, 60);
this_thread::sleep_for( chrono::milliseconds(2000) );
LogitechObject->m_lcd.SetText(LogitechObject->time, "ProgressBar TEST 70%");
LogitechObject->m_lcd.SetProgressBarPosition(LogitechObject->progressbar, 70);
this_thread::sleep_for( chrono::milliseconds(2000) );
LogitechObject->m_lcd.SetText(LogitechObject->time, "ProgressBar TEST 80%");
LogitechObject->m_lcd.SetProgressBarPosition(LogitechObject->progressbar, 80);
this_thread::sleep_for( chrono::milliseconds(2000) );
LogitechObject->m_lcd.SetText(LogitechObject->time, "ProgressBar TEST 90%");
LogitechObject->m_lcd.SetProgressBarPosition(LogitechObject->progressbar, 90);
this_thread::sleep_for( chrono::milliseconds(2000) );
LogitechObject->m_lcd.SetText(LogitechObject->time, "ProgressBar TEST 100%");
LogitechObject->m_lcd.SetProgressBarPosition(LogitechObject->progressbar, 100);
this_thread::sleep_for( chrono::milliseconds(2000) );
LogitechObject->m_lcd.SetText(LogitechObject->time, "ProgressBar TEST COMPLETE");
this_thread::sleep_for( chrono::milliseconds(2000) ); 
```

理想情况下，它会将进度条设置为每个百分比，每次两秒钟，让您验证进度条是否按预期运行。如果这不起作用，那么尝试找出您自己的代码出了什么问题就没有多大意义了。SDK 有问题，或者您对其控制参数的理解不符合 SDK 的要求。

让我知道你的结果。

# mysql - GROUP by 和 WHERE 不能一起使用

> ID：13976908
> 
> 赞同：1
> 
> 时间：2012-12-20T16:54:26.200
> 
> 标签：mysql, mysql-error-1064

为什么此代码有效：

```
SELECT year, sum(value)
FROM test
GROUP BY year 
```

这不是吗？

```
SELECT year, sum(value)
FROM test
GROUP BY year
WHERE `user` = 1 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-20T16:55:23.077

`GROUP BY`需要紧随其后`WHERE`：

```
SELECT year, sum(value) FROM test WHERE user = 1 GROUP BY year 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T16:55:56.590

你有没有尝试过

```
 SELECT year, sum(value) FROM test WHERE user = 1 GROUP BY year 
```

?

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T16:59:55.390

我不是专家，但请尝试“HAVING”子句：

```
SELECT year, sum(value)
FROM test
GROUP BY year
having `user` = 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T16:55:51.473

反转`GROUP BY`和`WHERE`子句：

```
SELECT year, SUM(value)
  FROM test
 WHERE user = 1
 GROUP BY year 
```

# c# - 具有复杂抽象类型集合的 WCF 抽象基类不包括在服务响应中进行反序列化

> ID：13976911
> 
> 赞同：7
> 
> 时间：2012-12-20T16:54:51.097
> 
> 标签：c#, wcf, wcf-binding

我们在我们的应用程序中为我们所有的响应 DTO 使用了一个基类。该类具有以下签名：

```
[Serializable]
public abstract class ResponseBase
{
    public bool Successful { get; set; }
    public List<ResponseMessage> Messages { get; set; }

    //...Other code...
} 
```

Messages 集合可以是以下任何一种类型：

```
[Serializable]
[XmlInclude(typeof(DebugMessage))]
[XmlInclude(typeof(InfoMessage))]
[XmlInclude(typeof(ValidationMessage))]
[XmlInclude(typeof(WarnMessage))]
[XmlInclude(typeof(RecoverableFaultMessage))]
[XmlInclude(typeof(FatalFaultMessage))]
public abstract class ResponseMessage
{
    //..Other code...
} 
```

具有以下具体版本：

```
[Serializable]
public class DebugMessage : ResponseMessage
{
    public override MessageType MessageType { get { return MessageType.Debug; } }
}
[Serializable]
public class InfoMessage : ResponseMessage
{
    public override MessageType MessageType { get { return MessageType.Info; } }
}
[Serializable]
public class ValidationMessage : ResponseMessage
{
    public override MessageType MessageType { get { return MessageType.Validation; } }
}
[Serializable]
public class WarnMessage : ResponseMessage
{
    public override MessageType MessageType { get { return MessageType.Warn; } }
}
[Serializable]
public class RecoverableFaultMessage : ResponseMessage
{
    public override MessageType MessageType { get { return MessageType.RecoverableFault; } }
}
[Serializable]
public class FatalFaultMessage : ResponseMessage
{
    public override MessageType MessageType { get { return MessageType.FatalFault; } }
} 
```

所有 DTO 响应对象都从 ResponseBase 继承，但是即使在 WCF 合同上使用以下 ServiceKnownTypes

```
[ServiceKnownType(typeof(ResponseBase))]
[ServiceKnownType(typeof(ResponseMessage))]
[ServiceKnownType(typeof(List<ResponseMessage>))]
[ServiceKnownType(typeof(DebugMessage))]
[ServiceKnownType(typeof(InfoMessage))]
[ServiceKnownType(typeof(ValidationMessage))]
[ServiceKnownType(typeof(WarnMessage))]
[ServiceKnownType(typeof(RecoverableFaultMessage))]
[ServiceKnownType(typeof(FatalFaultMessage))]
[ServiceKnownType(typeof(List<DebugMessage>))]
[ServiceKnownType(typeof(List<InfoMessage>))]
[ServiceKnownType(typeof(List<ValidationMessage>))]
[ServiceKnownType(typeof(List<WarnMessage>))]
[ServiceKnownType(typeof(List<RecoverableFaultMessage>))]
[ServiceKnownType(typeof(List<FatalFaultMessage>))] 
```

当我们将 Message 加载到 ResponseBase Messages 集合中时，会引发以下异常：

> 第 1 行位置 906 出错。元素“http://schemas.datacontract.org/2004/07/CX.Framework.Common.BaseTypes:ResponseMessage”包含映射到名称“http://schemas. datacontract.org/2004/07/CX.Framework.Common.BaseTypes:WarnMessage'。反序列化器不知道映射到此名称的任何类型。考虑使用 DataContractResolver 或将与“WarnMessage”对应的类型添加到已知类型列表中 - 例如，通过使用 KnownTypeAttribute 属性或将其添加到传递给 DataContractSerializer 的已知类型列表中。

我们在派生类型上完成了从 ServiceKnownType 到 XMLInclude 的所有工作。我对如何解决这个问题有点不知所措，希望任何人都能提供任何帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T17:24:11.290

一些东西：

1)`[XmlInclude]`对 没有影响`DataContractSerializer`，它只被`XmlSerializer`.

2）正如评论者“flem”所建议的那样，我会`[KnownType]`直接使用`ResponseMessage`而不是`[ServiceKnownType]`服务。

3）我不记得是否`DataContractSerializer`偶数寻找类型`[KnownType]`。`[Serializable]`至少现在出于测试目的，如果上面的 #2 没有帮助，请尝试创建您的类型`[DataContract]`（并使用 属性属性）。`[DataMember]`

# iis - Inno 设置枚举器

> ID：13976912
> 
> 赞同：1
> 
> 时间：2012-12-20T16:54:51.107
> 
> 标签：iis, inno-setup, enumerate

我正在尝试使用 WbemScripting.SWbemLocator 对象枚举 IIsWebServer 的 Properties_ 属性。我的目标是使用 PascalScript 代码来检索网站的服务器绑定。在 VBScript 中，我有以下代码：

```
Dim site, binding, url
Set site = GetObject("IIS://localhost/W3SVC/1")
For Each binding In site.ServerBindings
    url = binding
    Exit For
Next
If Left(url, 1) = ":" Then
    url = "localhost" & url
End If
If Right(url, 1) Then
    url = Left(url, Len(url) - 1)
End If
Set site = Nothing 
```

我徒手写了这段代码，所以它可能不准确，但我想在 PascalScript 中以类似的方式来做。我坚持的部分是通过 ServerBindings 进行枚举。我已经尝试了很多方法来让它工作，目前我有以下 PascalScript：

```
function GetWebSites() : Array of String;
var
    locatorObj, providerObj, nodeObj, appRoot: Variant;
    props : String;
begin
    locatorObj := CreateOleObject('WbemScripting.SWbemLocator');
    providerObj := locatorObj.ConnectServer(GetComputerNameString(), 'root/MicrosoftIISv2');
    nodeObj := providerObj.Get('IIsWebServer=''W3SVC/1''');

    props := nodeObj.Properties_;
    // How do I enumerate through the properties here?  Or, my actual goal is from this point how do I get the ServerBindings (or the first element in the ServerBindings array)? 
```

结尾;

在 JavaScript 中，要获取 ServerBindings，您必须使用类似于以下内容的内容：

```
var e = new Enumerator(nodeObj.Properties_);
for (; ! e.atEnd(); e.moveNext()) {
    var prop = e.item();
    if (prop.Name == 'ServerBindings') {
        // Do something
    }
} 
```

任何帮助，将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T08:21:21.500

不幸的是，Inno 代码本身不支持进行 COM 枚举，但您可以通过使用辅助 DLL 获得支持。有关详细信息，请参见[此处](http://www.vincenzo.net/isxkb/index.php?title=WMI)。

但是，如果您只想访问一个已知的命名属性，那就去做吧。

```
nodeObj.ServerBindings 
```

# css - 我们可以检索一个 li 的默认计数器值吗？

> ID：13976914
> 
> 赞同：2
> 
> 时间：2012-12-20T16:54:52.197
> 
> 标签：css

我们可以在**CSS**中检索li 的默认计数器值吗？

**例如：**
如果我有 6 `<li>`，分隔在 2 中`<ol>`，但我希望`<li>`从 1 到 6 列出，而不是从 1 到 3 两次。我在第二个中`value="4"`的第一个上使用过，所以它起作用了，但是现在因为我正在使用`<li>``<ol>`

```
ol {
  counter-reset: i 0;
}

ol li:before {
    content: counter(i);    
    counter-increment: i;
    font-weight: bold;
}​ 
```

`content: counter(i);`不计入第二个`value="4"`的第一个。`<li>``<ol>`

对此我能做些什么吗？

在[JsFiddle上查看](http://jsfiddle.net/MC8aP/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T17:05:08.107

这符合您的需求吗？[在 JSFiddle 上查看](http://jsfiddle.net/Hg4yg/)

## HTML

```
<ol>
  <li>test</li>
  <li>test</li>
  <li>test</li>
</ol>
<ol>
  <li>test</li>
  <li>test</li>
  <li>test</li>
</ol> 
```

## CSS

```
ol:first-of-type {
  counter-reset: i 0;
}

ol li:before {
  content: counter(i);    
  counter-increment: i;
  font-weight: bold;
}​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T17:04:51.073

发现我只需要`counter-reset`在父级而不是所有`<ol>`
[View 示例](http://jsfiddle.net/MC8aP/1/)上执行详细信息。

# function - 组合查询中的访问计数

> ID：13976915
> 
> 赞同：0
> 
> 时间：2012-12-20T16:54:55.850
> 
> 标签：function, count

我的查询是：

```
 SELECT Batch.printedquantity, Batch.guid
 FROM Batch
 WHERE (((Batch.[guid]) In (Select Main.guid
 from Main
 where (Left(main.printertimestamp,10) = [date])))); 
```

所以这返回如下：

```
 printedquantity     guid
     3                  {5FCE6B9A-88B0-41F7-A52B-21E0375B0433}
     10                 {C73EB60D-D707-4717-B505-667C445CC294}
     1                  {FEC25696-6AD6-4218-B7EB-2E5593054DAB}
     1                  {6CCDFB48-6B1B-4712-8C08-F06DA220455C}
     1                  {6CCDFB48-6B1B-4712-8C08-F06DA220455C} 
```

我正在尝试获取`printedquantity`列的总数，但计数功能有问题。这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T17:04:23.233

COUNT() 函数返回行数。要获得 printquantity 列的总数，听起来您确实在使用 SUM() 函数。完全未经测试，但以下可能会有所帮助......

```
SELECT SUM(Batch.printedquantity)
 FROM Batch
 WHERE (((Batch.[guid]) In (Select Main.guid
 from Main
 where (Left(main.printertimestamp,10) = [date])))); 
```

# javascript - Spotify App API：播放专辑中的特定曲目

> ID：13976921
> 
> 赞同：3
> 
> 时间：2012-12-20T16:55:13.870
> 
> 标签：javascript, spotify

我已经遵循了这个问题的公认答案：[Spotify App API：播放专辑中的特定曲目](https://stackoverflow.com/questions/8416256/spotify-app-api-play-specific-track-from-album)

但是，它对我不起作用。Spotify 仍在播放专辑中的第一首曲目。

我查看了 view.js，我可以看到它为什么播放第一首曲目：

```
if (play) {
    if (m.player.context !== this._context.uri) {
      m.player.play(this._context.get(0), this._context);
    } 
```

我的代码在下面，有什么想法/建议吗？

```
var track = models.Track.fromURI(item.SpotifyUrl, function(track) { 
    var album = models.Album.fromURI(track.album.uri, function(album) {
        var trackPlayer = new views.Player();
        var t = album.data.tracks[track.data.trackNumber-1];
        trackPlayer.track = t;      
        album.get = function() {
            console.log(track.name); // I know this is being called
            return track;
        }           
        trackPlayer.context = album;
        var $player = $(trackPlayer.node);
    });
}); 
```

提前致谢。

更新：

我进一步查看了 api 并在 models.js 中发现了这一点：

```
if (index === -1) {
...
    else if (context instanceof Album) {
        numTracks = context.tracks.length;
        while (i < numTracks) {
            if (context.tracks[i].data.availableForPlayback) {
                track = context.tracks[i];
                index = i;
                break;
            } else {
                i++;
        } 
```

以下方法调用：

```
if (play) {
    if (m.player.context !== this._context.uri) {
      m.player.play(this._context.get(0), this._context);
    } 
```

省略“索引”参数。因此，播放器将始终播放第一个可用曲目！为了解决这个问题，我添加了以下内容：

```
models.player.play = function(track, opt_context, opt_index) {
    return this.playTrackWithContext(track,opt_context,track.data.trackNumber-1);
}; 
```

这似乎是一个有点混乱的解决方法，但在 Spotify 更新他们的代码之前，它似乎是解决它的唯一方法。除非，我完全错过了一些东西并且有更简单的方法？

# mysql - 如何提高 MySQL 中的搜索性能

> ID：13976924
> 
> 赞同：0
> 
> 时间：2012-12-20T16:55:17.510
> 
> 标签：mysql

我有一个包含两`bigint`列的表：`beginNumber`, `endNumber`, 定义为`UNIQUE`. `ID`是`Primary Key`。_

```
ID | beginNumber | endNumber | Name | Criteria 
```

第二个表包含一个数字。当发现 table2 中的数字介于任意两个数字之间时，我想从 table1 中检索记录。这是查询：

```
select distinct t1.Name, t1.Country
from t1
where t2.Number
BETWEEN t1.beginIpNum AND t1.endNumber 
```

查询花费了太多时间，因为我有很多记录。我没有数据库方面的经验。但是，我读到索引表将改善搜索，因此 MySQL 不必通过搜索关于 m 数的每一行，这可以通过例如具有`UNIQE`值来完成。我将 table1 中的`beginNumber`&`endNumber`设为唯一。这就是我能做的吗？有什么办法可以改善时间吗？请提供详细的答案。

编辑：

表格1：

```
CREATE TABLE `t1` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `beginNumber` bigint(20) DEFAULT NULL,
  `endNumber` bigint(20) DEFAULT NULL,
  `Name` varchar(255) DEFAULT NULL,
  `Criteria` varchar(455) DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `beginNumber_UNIQUE` (`beginNumber`),
  UNIQUE KEY `endNumber_UNIQUE` (`endNumber `)
) ENGINE=InnoDB AUTO_INCREMENT=327 DEFAULT CHARSET=utf8 
```

表2：

```
CREATE TABLE `t2` (
  `id2` int(11) NOT NULL AUTO_INCREMENT,
  `description` varchar(255) DEFAULT NULL,
  `Number` bigint(20) DEFAULT NULL,
  PRIMARY KEY (`id2`),
  UNIQUE KEY ` description _UNIQUE` (`description `)
) ENGINE=InnoDB AUTO_INCREMENT=433 DEFAULT CHARSET=utf8 
```

这是表格的玩具示例，但它显示了相关部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T17:13:26.960

我建议这样的索引`t2.Number`：

```
ALTER TABLE t2 ADD INDEX numindex(Number); 
```

您的查询将无法按书面方式工作，因为它不知道要使用哪个 t2。尝试这个：

```
SELECT DISTINCT t1.Name, t1.Criteria
FROM t1 
WHERE EXISTS (SELECT * FROM t2 WHERE t2.Number BETWEEN t1.beginNumber AND t1.endNumber); 
```

没有 t2.Number 索引 EXPLAIN 给出了这个查询计划：

```
1   PRIMARY t1  ALL                 1   Using where; Using temporary
2   DEPENDENT SUBQUERY  t2  ALL                 1   Using where 
```

使用 t2.Number 上的索引，您将获得以下计划：

```
PRIMARY t1  ALL                 1   Using where; Using temporary
DEPENDENT SUBQUERY  t2  index   numindex    numindex    9       1   Using where; Using index 
```

要理解的重要部分是`ALL`比较比比较慢`index`。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-20T17:05:32.487

这是一个使用二叉树索引的好地方（默认是hashmap）。当您经常在列之间进行排序或使用时，Btree 索引是最好的。

创建索引 index_name

ON 表名（列名）

使用 BTREE

# php - 在 Rails 应用程序中运行 PHP 脚本

> ID：13976933
> 
> 赞同：1
> 
> 时间：2012-12-20T16:55:38.943
> 
> 标签：php, ruby-on-rails, apache, passenger

我有一个需要集成聊天插件[Arrowchat的 Rails 应用程序。](http://www.arrowchat.com/)因为它严重依赖 PHP——甚至客户端 JS/CSS 也是从 PHP 脚本生成的，所以我得出的结论是我必须在 html.erb 页面中运行 PHP（和 ruby​​）脚本。这甚至可能吗？

如果有任何用处，我有 Phusion Passenger 和 Apache，它显然可以以独立的方式提供 php。

# .net - 为什么在 VS 2010 和 VS 2012 中构建的应用程序的行为存在差异？

> ID：13976934
> 
> 赞同：19
> 
> 时间：2012-12-20T16:55:41.097
> 
> 标签：.net, visual-studio-2010, visual-studio-2012

我正在检查在我们的构建机器上安装 .NET 4.5 是否会更改 VS 2010 生成的输出 IL 映像。

由于我知道 foreach 的行为在 .NET 4.5 中发生了变化，以避免由于[Access to Modified closure](http://blogs.msdn.com/b/ericlippert/archive/2009/11/12/closing-over-the-loop-variable-considered-harmful.aspx)导致的问题，所以我选择了一个展示该行为的简单应用程序。

```
 class Program
    {
        private static void Main(string[] args)
        {
            var contents = new List<Func<int>>();
            var s = new StringBuilder();

            int[] values = new int[] { 4, 5, 6 };

            foreach (int value in values)
            {
                contents.Add(() => value);
            }

            for (var k = 0; k < contents.Count; k++)
                s.Append(contents[k]());

            Console.WriteLine(s);
        } 
```

**VS 2010 输出**：666

**VS 2012 输出**：456

我在 VS 2010 中创建了一个控制台应用程序，并在 VS 2012 中创建了一个具有相同代码的控制台应用程序（均针对 .NET 4）。

但是，这两个控制台应用程序根据构建它们的 IDE 表现出不同的行为。在构建输出中，我检查了两者是否具有几乎相似的构建参数。所以我想知道最终可执行文件如何表现出不同的行为？.NET 4.5 是就地升级，因此两个 IDE 的编译器必须相同。

注意：我确实看过一个相关问题：[VS 2010 和 VS 2012 中的不同 LINQ 答案，](https://stackoverflow.com/questions/13327224/different-linq-answer-in-vs-2010-and-vs-2012)但它没有回答我关于为什么可执行行为不同的问题。

**编辑 1：** 正如[mletterle](https://stackoverflow.com/users/65235/mletterle)提到的，我确实尝试在 VS 2010 命令提示符下使用 VS 2010 输出窗口中的命令行构建代码。生成的输出就像是用 VS 2012 构建的一样。

**编辑2：**

我在输出窗口中发布输出：

**VS 2010：** 构建开始于 2012 年 12 月 20 日晚上 11:04:56。

> CoreClean：创建目录“obj\x86\Debug\”。GenerateTargetFrameworkMonikerAttribute：跳过目标“GenerateTargetFrameworkMonikerAttribute”，因为所有输出文件相对于输入文件都是最新的。核心编译：
> C:\Windows\Microsoft.NET\Framework\v4.0.30319\Csc.exe /noconfig /nowarn:1701,1702 /nostdlib+ /platform:x86 /errorreport:prompt /warn:4 /define:DEBUG;TRACE /errorendlocation /preferreduilang :en-US /highentropyva- /reference:"C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework.NETFramework\v4.0\Microsoft.CSharp.dll" /reference:"C:\Program Files (x86 )\Reference Assemblies\Microsoft\Framework.NETFramework\v4.0\mscorlib.dll" /reference:"C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework.NETFramework\v4.0\System.Core.dll " /reference:"C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework.NETFramework\v4.0\System.Data.DataSetExtensions.dll" /reference:"C:\Program Files (x86)\Reference Assemblies \Microsoft\Framework.NETFramework\v4.0\System.Data。dll" /reference:"C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework.NETFramework\v4.0\System.dll" /reference:"C:\Program Files (x86)\Reference Assemblies\Microsoft\ Framework.NETFramework\v4.0\System.Xml.dll" /reference:"C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework.NETFramework\v4.0\System.Xml.Linq.dll" /debug+ /debug:full /filealign:512 /optimize- /out:obj\x86\Debug\TestConsoleApp.exe /target:exe /utf8output Program.cs Properties\AssemblyInfo.cs "C:\Users\105044960\AppData\Local\Temp .NETFramework,Version=v4.0.AssemblyAttributes.cs" _CopyAppConfigFile: 跳过目标 "_CopyAppConfigFile" 因为所有输出文件相对于输入文件都是最新的。CopyFilesToOutputDirectory: 复制文件从 "obj\x86\Debug\TestConsoleApp.exe" 到 "bin\Debug\TestConsoleApp.exe"。TestConsoleApp -> C:\Users\105044960\Documents\Visual Studio 2010\Projects\TestConsoleApp\TestConsoleApp\bin\Debug\TestConsoleApp.exe将文件从“obj\x86\Debug\TestConsoleApp.pdb”复制到“bin\Debug\TestConsoleApp.pdb”。

**与 2012 年相比：**

> 1>CoreClean: 1> 删除文件“c:\users\105044960\documents\visual studio 11\Projects\TestConsoleApp\TestConsoleApp\bin\Debug\TestConsoleApp.exe”。1> 删除文件“c:\users\105044960\documents\visual studio 11\Projects\TestConsoleApp\TestConsoleApp\bin\Debug\TestConsoleApp.pdb”。1> 删除文件“c:\users\105044960\documents\visual studio 11\Projects\TestConsoleApp\TestConsoleApp\obj\Debug\TestConsoleApp.csprojResolveAssemblyReference.cache”。1> 删除文件“c:\users\105044960\documents\visual studio 11\Projects\TestConsoleApp\TestConsoleApp\obj\Debug\TestConsoleApp.exe”。1> 删除文件“c:\users\105044960\documents\visual studio 11\Projects\TestConsoleApp\TestConsoleApp\obj\Debug\TestConsoleApp.pdb”。1>GenerateTargetFrameworkMonikerAttribute：1>跳过目标“GenerateTargetFrameworkMonikerAttribute”，因为所有输出文件相对于输入文件都是最新的。1>CoreCompile: 1> C:\Windows\Microsoft.NET\Framework\v4.0.30319\Csc.exe /noconfig /nowarn:1701,1702,2008 /nostdlib+ /platform:AnyCPU /errorreport:prompt /warn:4 /define :DEBUG;TRACE /errorendlocation /preferreduilang:en-US /highentropyva- /reference:"C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework.NETFramework\v4.0\Microsoft.CSharp.dll" /reference: "C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework.NETFramework\v4.0\mscorlib.dll" /reference:"C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework.NETFramework\v4 .0\System.Core.dll" /reference:"C:

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-20T18:09:16.880

*注意：我删除了大部分原始回复。它回答了错误的问题。接下来是更好的回应。*

啊，现在我明白你在问什么：“Visual Studio 2010 如何知道在安装 .NET 4.5 后编译为 C# 4 而不是 C# 5，即使 Visual Studio 2010 和 Visual Studio 2012 使用相同的 csc.exe 并通过有同样的选择吗？”

> @mletterle 但是 .NET 4.5 是对 .NET 4 的就地升级。所以实际上我的机器上只有 .NET 4。唯一的可能是 IDE 隐藏了我看不到的 .NET 4 编译器的隐藏副本。

我不确定你是从哪里听到的，或者你为什么这么认为。.NET 4.5 不是就地升级。它是该工具的不同版本。会有差异。这是其中之一。

**更新1：**

看起来我们使用了不同的“就地”升级定义。我对“就地”的使用是“版本之间应该没有明显差异的升级”。[您链接到](http://www.hanselman.com/blog/NETVersioningAndMultiTargetingNET45IsAnInplaceUpgradeToNET40.aspx)的文章中给出的定义以不同的方式使用它：“就地”在它们的用法中是“使用相同的 CLR，但添加了新的库”。

由于 C# 5 与 C# 4 不同，因此在我熟悉的用法中，这种更改并不是“到位”的。

结果，差异不是您所针对的 CLR，而是您正在使用的语言版本 - CLR 是“就地”升级（都是 4.0 CLR），但语言不是（VS2010 中的 C# 4 , VS2012 中的 C#5。）

**更新 2：**

在 .csproj 文件（实际上是由 Visual Studio 管理的 msbuild 文件）中，有一个指定目标框架的属性。默认情况下，使用 Visual Studio 2012 制作的项目具有以下功能：

```
<TargetFrameworkVersion>v4.5</TargetFrameworkVersion> 
```

而针对版本 4 的 Visual Studio 2010 中的项目如下所示：

```
<TargetFrameworkVersion>v4.0</TargetFrameworkVersion> 
```

这告诉 Visual Studio 在为一个或另一个目标框架构建时设置环境。虽然看起来 csc.exe 是直接从命令提示符调用的，但实际上并非如此：msbuild 项目实际上是正在处理的内容，并且它发生在“Visual Studio”的自定义进程环境中。

我只能假设正在发生的事情的细节，但很可能在升级之后，将“TargetFrameworkVersion”属性设置为 v4.0 在编译针对 v4.0 的项目期间会将环境返回到 v4.0。另一方面，通过在没有 msbuild 设置的环境的情况下从命令行调用 csc.exe，它使用其版本的“默认值”（现在默认为 C# 5）为您提供新的 C#5 行为，即使您'正在使用 VS 2010 命令提示符。但是，当您通过 MSBuild 调用构建时，它知道如何在构建期间返回原始 C# 4 环境（因为 MSBuild 也是 .NET 工具链的一部分。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-20T18:43:04.383

Visual Studio 使用[进程内编译器](http://blogs.msdn.com/b/ed_maurer/archive/2008/06/11/a-tale-of-two-compilers.aspx)，因此它知道它使用的是哪个版本的 C#。

正如您所指出的，另一方面，命令行中的 csc.exe 使用它要编译的任何 C# 版本，因此在您的情况下它将是 C# 5.0。由于它是就地升级（就安装目录而言），它可能会破坏依赖于`foreach`绑定在整个循环中相同的代码（奇怪，但可能）。

* * *

> 注意：错误问题的旧答案：OP 知道这一点并正在从命令行对其进行测试。

您链接到的博客文章已经回答了您的问题。我认为这个问题与[这个](https://stackoverflow.com/q/12112881)有关。

改变的是编译器，所以：

```
foreach (int value in values)
{
    // ...
} 
```

用于根据以下代码生成一些东西：

```
{
    int value;
    for (/* iteration */)
    {
        value = /* get from enumerator */;
        // ...
    }
} 
```

而新的 C# 编译器现在生成相当于将变量移动到循环内部：

```
for (/* iteration */)
{
    int value = /* get from enumerator */;
    // ...
} 
```

这有很大的不同，因为在每个循环中的闭包`// ...`将捕获一个新的`value`绑定，而不是共享`value`过去在循环外声明的相同绑定。

`foreach`问题是，如果您希望代码在较旧和较新的编译器上都能正常工作，则必须在循环内声明自己的变量：

```
foreach (int value in values)
{
    int newValue = value;
    // ...
} 
```

* * *

Visual Studio 2010 中当前的 C# 4.0 规范说：

> (...) 形式的 foreach 语句
> 
> ```
> foreach (V v in x) embedded-statement 
> ```
> 
> 然后扩展为：
> 
> ```
> {
>   E e = ((C)(x)).GetEnumerator();
>   try {
>       V v;
>       while (e.MoveNext()) {
>           v = (V)(T)e.Current;
>           embedded-statement
>       }
>   }
>   finally {
>       … // Dispose e
>   }
> } 
> ```

Visual Studio 2012 中的 C# 5.0 规范说：

> (...) 形式的 foreach 语句
> 
> ```
> foreach (V v in x) embedded-statement 
> ```
> 
> 然后扩展为：
> 
> ```
> {
>   E e = ((C)(x)).GetEnumerator();
>   try {
>       while (e.MoveNext()) {
>           V v = (V)(T)e.Current;
>           embedded-statement
>       }
>   }
>   finally {
>       … // Dispose e
>   }
> } 
> ```

# c - 如何定义既不支持输入参数又支持同时输入参数的宏函数

> ID：13976935
> 
> 赞同：1
> 
> 时间：2012-12-20T16:55:42.587
> 
> 标签：c

我想定义一个同时支持的宏函数：

1) 无输入参数

2) 输入参数

类似的事情：

```
#define MACRO_TEST(X)\
    printf("this is a test\n");\
    printf("%d\n",x) // the last printf should not executed if there is no input parameter when calling the macro 
```

主要是：

```
int main()
{
    MACRO_TEST(); // This should display only the first printf in the macro
    MACRO_TEST(5); // This should display both printf in the macro
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T17:23:45.240

为此，您可以使用 sizeof。

考虑这样的事情：

```
#define MACRO_TEST(X) { \
  int args[] = {X}; \
  printf("this is a test\n");\
  if(sizeof(args) > 0) \
    printf("%d\n",*args); \
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T17:26:18.767

gcc 和最新版本的 MS 编译器支持可变参数宏 - 即与 printf 类似的宏。

gcc 文档在这里： http: [//gcc.gnu.org/onlinedocs/gcc/Variadic-Macros.html](http://gcc.gnu.org/onlinedocs/gcc/Variadic-Macros.html)

此处的 Microsoft 文档：http: [//msdn.microsoft.com/en-us/library/ms177415 (v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/ms177415(v=vs.80).aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T21:57:46.030

不完全是，但...

```
#include <stdio.h>

#define MTEST_
#define MTEST__(x) printf("%d\n",x)
#define MACRO_TEST(x)\
    printf("this is a test\n");\
    MTEST_##x    

int main(void)
{
    MACRO_TEST();
    MACRO_TEST(_(5));
    return 0;
} 
```

**编辑**

如果 0 可以用作跳过：

```
#include <stdio.h>

#define MACRO_TEST(x) \
    do { \
        printf("this is a test\n"); \
        if (x +0) printf("%d\n", x +0); \
    } while(0)

int main(void)
{
    MACRO_TEST();
    MACRO_TEST(5);
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T17:30:11.517

`C99`标准说，

当前定义为类对象宏的标识符不应由另一个#define 重新处理指令重新定义，除非第二个定义是类对象宏定义并且两个替换列表相同。同样，当前定义为类函数宏的标识符不应由另一个#define 预处理指令重新定义，除非第二个定义是具有相同数量和参数拼写的类函数宏定义，并且两个替换列表相同.

我认为编译器会提示重新定义 MACRO 的警告。因此这是不可能的。

# nhibernate - 如何使用 LifestyleScoped 实现 Castle Windsor IScopeAccessor 以提供每个 ViewModel 的 NHibernate 会话

> ID：13976939
> 
> 赞同：3
> 
> 时间：2012-12-20T16:55:51.580
> 
> 标签：nhibernate, castle-windsor, session-management

我正在寻找一些帮助来创建 IScopeAccessor 的实现，或者寻找一个新的解决方案，这将允许我为每个 ViewModel 提供一个 NHibernate 会话。

我知道温莎现在支持所见的范围生活方式（[这里](http://docs.castleproject.org/Windsor.Whats-New-In-Windsor-3.ashx)）。但是，该示例使用 using 块创建特殊范围并在 using 中调用 container.resolve。

```
 _container.Register(Component.For<A>().LifestyleScoped());

    using (_container.BeginScope())
    {
        var a1 = _container.Resolve<A>();
        var a2 = _container.Resolve<A>();
        Assert.AreSame(a1, a2);
    } 
```

我想不出一种方法来完成这项工作，因为我不想传递容器，并且我希望范围与创建的 ViewModel 相关联，这将在需要时动态发生。

作为替代方案，看起来我可以创建 IScopeAccessor 的实现，根据 Krzysztof Koźmic （[此处](http://markmail.org/message/7vma7z3kbn3zp6rf)）将允许我

> > “......提供你喜欢的任何范围。范围在这里是一个抽象术语，它可以是任何东西。”

不幸的是，我找不到不特定于基于 Web 的场景的 IScopeAccessor 的实现，我正在努力理解我需要做什么才能将“任何东西”变成有效的范围。

我找到了一个我想使用 Ninject 做什么的例子（http://www.emidee.net/index.php/2010/08/23/ninject-use-one-database-session-per-view-model /):

```
Bind<ISession>().ToMethod(ctx =>
{
    var session = ctx.Kernel.Get<....>().BuildSessionFactory().OpenSession();
    return session;
})
.InScope(context =>
{ 
    var request = context.Request;

    if (typeof(IViewModel).IsAssignableFrom(request.Service))
        return request; 

    while ((request = request.ParentRequest) != null)
        if (typeof(IViewModel).IsAssignableFrom(request.Service))
            return request;

    return new object(); 
}); 
```

在 Ninject 中，InScope 表示只要回调返回的对象保持活动状态，就应该重用由绑定创建的任何实例。本质上，此回调返回根级 ViewModel（因为 ViewModel 可以嵌套）。

关于如何使用 Windsor 做同样的事情或获得同样的结果有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T12:13:21.203

问题似乎是创造的地方。如果这完全是关于正在构建的视图模型的依赖关系，您可以使用 boud 生活方式，如[新增功能中所述......](http://docs.castleproject.org/Windsor.Whats-New-In-Windsor-3.ashx) 或者您也可以使用您自己的范围访问器，这对视图模型很敏感。例如像这样：

```
public class ViewModelScopeAccessor : IScopeAccessor
{
    private IDictionary<Guid, ILifetimeScope> scopes = new Dictionary<Guid, ILifetimeScope>();
    private ILifetimeScope defaultScope;

    public ViewModelScopeAccessor()
        : this(new DefaultLifetimeScope())
    { }

    public ViewModelScopeAccessor(ILifetimeScope defaultScope)
    {
        this.defaultScope = defaultScope;
    }

    public ILifetimeScope GetScope(CreationContext context)
    {
        var creator = context.Handler.ComponentModel.Implementation;
        var viewModel = creator as IViewModel;
        if (viewModel != null)
        {
            ILifetimeScope scope;
            if (!scopes.TryGetValue(viewModel.UID, out scope))
            {
                scope = new DefaultLifetimeScope();
                scopes[viewModel.UID] = scope;
            }

            return scope;
        }
        else
        {
            return defaultScope;
        }
    }

    public void Dispose()
    {
        foreach (var scope in scopes)
        {
            scope.Value.Dispose();
        }

        defaultScope.Dispose();
        scopes.Clear();
    }
} 
```

对于以下视图模型界面：

```
public interface IViewModel
{
    string DisplayName { get; }

    Guid UID { get; }
} 
```

您当然可以通过其他方式比较视图模型，这只是一个示例。

绑定生活方式和范围访问器两者的缺点是，如果您在视图模型中使用类型化工厂来懒惰地构造对象，它将无法工作，因为范围访问器不知道来自哪个对象/方法它的工厂方法被调用。但我认为这是一个一般的 .NET 问题，因为方法实际上永远不知道从哪里调用它。

因此，您可以使用自己的工厂，每个工厂实例只生成一个实例，并将它们的范围也限制在您的视图模型中。

希望这可以帮助。

# c# - 使用 C# Word 互操作重新启动列表编号

> ID：13976941
> 
> 赞同：1
> 
> 时间：2012-12-20T16:55:58.023
> 
> 标签：c#, ms-word, interop

在从一些 XML 获取信息后，我有一个带有一些书签和样式的 Word 2010 模板，我必须使用它们来生成 Word 文档，并且我正在使用 c# 和 Interop（8.3 版）。模板给了我，我根本无法更改，因为它遵循公司的文档规则。

有时，当我使用模板的自定义编号列表样式时，编号搞砸了，莫名其妙地从 2 而不是 1 开始。其他时候，它遵循上一个列表的编号，而我并不总是希望这种情况发生。

如果我可以从模板修改现有样式，或者`ContinuePreviousList: false`从我的程序中应用自定义样式，那么修复这些情况会很容易，但是生成的 Word 文档**必须**具有他们强制我使用的样式。

如果我打开 Word 文档，右键单击列表并选择**“在 1 处重新启动”**选项（*我没有英文 Word，希望这是正确的翻译*），它解决了我可能遇到的大部分问题，但我不知道如何从 Interop 使用它。我已经录制了宏，然后翻译成c#知道Word是怎么做一些功能的，但是当我开始录制宏时鼠标被锁定。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T10:11:03.267

鼠标已锁定，但您可以使用键盘上的[鼠标右键](http://www.stetsenko.net/wp-content/uploads/2009/04/right_click_keyboard_key.jpg)来获取上下文菜单，然后在录制宏时选择 Restart at 1。

我最终使用 C# 互操作完成了这个：

```
using System.Runtime.InteropServices;
using MSWord = Microsoft.Office.Interop.Word;

namespace ResetNumberingInWordDoc
{
    class Program
    {
        static void Main()
        {
            var application = new MSWord.Application();
            var document = application.Documents.Open(@"C:\mydocument.docx");

            const int listNumber = 1; //The first list on the page is list 1, the second is list 2 etc etc

            document.Range().ListFormat.ApplyListTemplateWithLevel(
                ListTemplate: document.ListTemplates[listNumber], 
                ContinuePreviousList: false, 
                ApplyTo: MSWord.WdListApplyTo.wdListApplyToWholeList,
                DefaultListBehavior: MSWord.WdDefaultListBehavior.wdWord10ListBehavior);

            document.Save();
            document.Close();

            application.Quit();

            Marshal.ReleaseComObject(application);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T17:06:34.580

我发现了查看录制的宏执行**“在 1 处重新启动”功能的确切方法。**找到具有编号列表样式的段落后，您必须选择要“从 1 重新开始”的编号并应用“List_Norm”样式：

```
listParagraph.SelectNumber(); //Select numbers from the NumberList paragraph
application.Selection.set_Style(document.Styles["List_Norm"]); //Apply "List_Norm" style 
```

这样，列表的内容将保持原始样式，但列表将从 1 开始。

可以应用相同的代码重新启动标题样式，但应用“Tit_List”样式而不是“List_Norm”。

# css - 谷歌浏览器更改图形颜色

> ID：13976947
> 
> 赞同：1
> 
> 时间：2012-12-20T16:56:19.980
> 
> 标签：css, google-chrome, colors, background-color

谷歌浏览器似乎总是在改变我试图匹配背景颜色的图像颜色。我尝试将它保存在 Photoshop 和 GIMP 中，甚至调整了每个中的颜色设置，但它在 Chrome 中没有帮助。FF 和 IE 工作正常（一次）。

我的图像的颜色是#282828。将其保存为 PNG 后，我在 GIMP 和 Photoshop 中重新打开它，并使用吸管工具确认颜色仍为 #282828。当它在 Chrome 中呈现时，它会变暗。我有一个背景颜色为#282828 的 div，图片就在它旁边。我截图了，div的背景颜色是#282828，图片的背景颜色是#1d1d1d。我尝试了几种不同的颜色，每种颜色都有相同的结果。我什至尝试将源图像设置为 Chrome 渲染它的颜色，但 Chrome 仍然会更改它。例如，由于 Chrome 将 #282828 更改为 #1d1d1d，我制作了源图像 #1d1d1d，当我在 Chrome 中渲染它时，它不是 #1d1d1d，而是其他一些更深的颜色。

在这一点上，我正在寻找修复或编程解决方法。因为图像是透明的，有曲线和阴影，我真的没有办法避免用 html 替换它，甚至它的一部分。

更新：我也尝试将其保存为 jpg 和 gif。gif 实际上可以工作，但不能保留投影。我正在使用的图像已附上。如果我在 Chrome 中截屏，GIMP 的吸管工具会显示它是#1d1d1d。如果我打开原件并做同样的事情，它是#282828。

![在此处输入图像描述](../Images/18db3255676c1ec978be6e267cf24d02.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T17:07:45.440

[PNG 使用伽马校正](http://hsivonen.iki.fi/png-gamma/)来尝试确保图像在所有显示器上看起来都一样，这可能会导致颜色不匹配，就像您看到的那样。这是图像编辑器问题和浏览器问题的结合：图像编辑器不会被迫在图像中嵌入伽马数据，如果伽马校正存在，浏览器可以自由地忽略它，并且当它不存在时可以随意强制执行一些。在这种情况下，我宁愿认为 Firefox 会忽略它。

如果您不希望其背景干扰页面背景，请使用透明 PNG。

[编辑] 对于您的具体情况，您可以通过样式元素复制您正在寻找的图形，使用`border-radius`and `box-shadow`，这两个广泛实现的 CSS3 属性在旧浏览器上合理衰减。

# ruby-on-rails - 在轨道上使用 rspec-capybara 测试图像标签中图像的实际存在

> ID：13976951
> 
> 赞同：3
> 
> 时间：2012-12-20T16:56:24.950
> 
> 标签：ruby-on-rails, rspec, capybara-webkit

在我发送的电子邮件中，我包含了一张图片，我想确保它确实加载了一张。所以，在 Mailer View Spec 的风格中，我想要一个 Capybara RSpec Matcher，它告诉我这个图像是否真的被渲染为一个图像（或者是否只有 alt 标签，因为它没有找到它）做你知道有什么选择吗？

# windows - 如何获取从挂起或中止的重叠 ReadFile 操作中读取的字节数

> ID：13976952
> 
> 赞同：1
> 
> 时间：2012-12-20T16:56:24.867
> 
> 标签：windows, winapi, msdn, readfile, overlapped-io

可以使用该`GetOverlappedResult()`函数从成功的重叠（异步）`ReadFile()`操作中获取读取字节数。

在操作仍在挂起或中止之后，我找不到获取读取字节数的方法。在这两种情况下，该`GetOverlappedResult()`函数似乎都将读取字节数设置为 0。知道怎么做吗？

编辑：执行此异步 I/O 操作以通过 COM 端口检索来自嵌入式设备的数据。该操作在超时后中止。我需要在操作被中止之前接收到的字节数仅用于调试目的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T12:26:51.223

[ClearComError](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363180%28v=vs.100%29.aspx)函数可以填充一个结构，该结构给出已接收但尚未被`ReadFile`操作消耗的字节数。

# android - Android：为什么同等权重的按钮具有不同的宽度？

> ID：13976953
> 
> 赞同：1
> 
> 时间：2012-12-20T16:56:28.820
> 
> 标签：android, android-layout

考虑以下代码和输出：

```
<?xml version="1.0" encoding="utf-8"?>
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <TableRow>

        <Button
            android:id="@+id/button1"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="ABCDE" />

        <Button
            android:id="@+id/button2"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="A" />

        <Button
            android:id="@+id/button3"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="ABC" />
    </TableRow>

</TableLayout> 
```

![在此处输入图像描述](../Images/6447439b9a7f3c07a891af6da49f9f87.png)

按钮被赋予相同的`layout_weight`，但具有不同的宽度。为什么它们不占据相同的宽度？我该怎么做才能使它们具有相等的宽度（不提供像素值）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T17:15:21.367

更改`layout_width`为`0dip`将解决问题。

有关此功能的原因或使用原因的更多信息，请查看此[说明](https://stackoverflow.com/questions/5986793/in-android-layouts-what-is-the-effect-meaning-of-layout-height-0dip)。

很高兴它有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T17:15:07.560

您可以将 设置`layout_width`为`0dip`，但如果文本太长则效果不佳。

# c++ - 方法不会超载

> ID：13976956
> 
> 赞同：1
> 
> 时间：2012-12-20T16:33:24.203
> 
> 标签：c++, overloading

我对 C++ 相当陌生，而且这种方法不会在 Vector 类中重载。

```
class Vector {
...
     void findTriDiagonalDeterminant(mpf_t *det, unsigned long long *d, double offset) {
          ...
     }

     void findTriDiagonalDeterminant(mpf_t *det, unsigned long long *d) {
          findTriDiagonalDeterminant(det, d, 0);
     }
}

class Matrix : public Vector {
private:
    unsigned long long* dims;
public:
    void findTriDiagonalDeterminant(mpf_t* det, int index) {
        Vector::findTriDiagonalDeterminant(det, dims+index);
    }
    ...
} 
```

g++ 说

```
error: no matching function for call to ‘Matrix::findTriDiagonalDeterminant(__mpf_struct (*&)[1], long long unsigned int*)’ 
```

但是有一个匹配函数：Vector 类中的第二个。

我在没有指针的情况下尝试了相同的操作（通过将 *d 替换为 d 并将 dims+index 替换为 *(dims+index)），但它没有帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T16:50:12.097

在子类中的 C++ 重载中，隐藏了父类中的方法，因此只能使用 Matrix 调用 Matrix 中的函数。

您可以使用 using 来公开额外的方法，就像这样。

```
class Matrix : public Vector {
private:
   unsigned long long* dims;
public:
   using Vector::findTriDiagonalDeterminat;
   void findTriDiagonalDeterminant(mpf_t* det, int index) {
     Vector::findTriDiagonalDeterminant(det, dims+index);
   }
...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T16:40:49.303

我猜`(dims+index)`是被提升到别的地方。也许尝试显式转换结果或将表达式分配给适当的临时变量。

# mysql - MySQL - 将列乘以别名

> ID：13976960
> 
> 赞同：1
> 
> 时间：2012-12-20T16:56:51.810
> 
> 标签：mysql, select, alias, multiplication

我正在尝试为一个项目组获取一些图像，但似乎无法让乘法与分配的别名一起使用。我已经尝试了下面的脚本并进行了一些修改，但我尝试过的每件事都行不通。

```
SELECT s.pid AS 'ID', 
       CONCAT_WS(', ', p.lastname, p.firstname) AS 'Name', 
       CONCAT(s.date, ' ', s.time) AS Serviced, 
       p.institution AS Facility, 
       s.description AS 'description title', 
       (SELECT COUNT(*) 
          FROM series se 
         WHERE se.studyid = s.id) 
          AS numseries, 
       (SELECT COUNT(*) 
          FROM image i 
         WHERE i.seriesid = se.id) 
          AS serimages, 
       numseries * serimages AS 'Number of Images' 
  FROM product p, 
          series se 
       JOIN 
          study s 
       ON s.pid = p.id 
GROUP BY s.id 
ORDER BY Serviced DESC 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T17:01:06.017

试试这个，我把两个都砸了-

```
SELECT s.pid AS 'ID', 
       CONCAT_WS(', ', p.lastname, p.firstname) AS 'Name', 
       CONCAT(s.date, ' ', s.time) AS Serviced, 
       p.institution AS Facility, 
       s.description AS 'description title', 
       ((SELECT COUNT(*) 
          FROM series se 
         WHERE se.studyid = s.id) 
          * 
       (SELECT COUNT(*) 
          FROM image i 
         WHERE i.seriesid = se.id) 
          ), 
       AS 'Number of Images' 
  FROM product p, 
          series se 
       JOIN 
          study s 
       ON s.pid = p.id 
GROUP BY s.id 
ORDER BY Serviced DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T17:29:35.217

尝试像这样使用它

```
SELECT 
    t.ID,
    t.Name,
    t.Serviced,
    t.Facility,
    t.title,
    t.numseries,
    t.serimages,
    t.numseries * t.serimages AS 'Number of Images' 
FROM
    (
    SELECT s.pid AS 'ID', 
           CONCAT_WS(', ', p.lastname, p.firstname) AS 'Name', 
           CONCAT(s.date, ' ', s.time) AS Serviced, 
           p.institution AS Facility, 
           s.description AS 'description title', 
           (SELECT COUNT(*) FROM series se WHERE se.studyid = s.id) AS numseries, 
           (SELECT COUNT(*) FROM image i WHERE i.seriesid = se.id) AS serimages       
    FROM product p, series se 
    JOIN study s ON s.pid = p.id 
    ) as t
GROUP BY t.id 
ORDER BY t.Serviced DESC 
```

另外，您在查询中使用的是 cartisin 产品，我的意思是使用 FROM 和两个表。这会带来很多结果。避免它并始终使用 join 代替。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T17:05:35.970

试试这个：

```
Select *, ( numseries * serimages ) as 'Number of Images' 
from (SELECT 
        s.pid AS 'ID', 
        CONCAT_WS(', ', p.lastname, p.firstname) AS 'Name', 
        CONCAT(s.date, ' ', s.time) AS Serviced, 
        p.institution AS Facility, 
        s.description AS 'description title', 
        (SELECT COUNT(*) FROM series se WHERE se.studyid = s.id) AS numseries, 
        (SELECT COUNT(*) FROM image i WHERE i.seriesid = se.id) AS serimages 
    FROM product p, series se 
    INNER JOIN study s ON s.pid = p.id 
    GROUP BY s.id 
    ORDER BY Serviced DESC
) as a; 
```

# java - 方法参数的 Java 泛型类型擦除

> ID：13976961
> 
> 赞同：9
> 
> 时间：2012-12-20T16:56:56.427
> 
> 标签：java, generics, types

我从 Joshua Bloch 的一次谷歌 I/O 益智演讲中得到了这个。这是代码

```
 public class Glommer<T> {
      String glom(Collection<?> obj){
         String result = "";
         for(Object o : obj){
              result += o;
         }
         return result;
      }

      int glom(List<Integer> ints){
           int result = 0;
           for(int i : ints){
                result += i;
           }
           return result;
       }

      public static void main(String args[]){
           List<String> strings = Arrays.asList("1", "2", "3");
           System.out.println(new Glommer().glom(strings));
      } 
```

这个 main 方法抛出一个异常，因为`new Glommer`它是一个原始类型，因此所有泛型都`Glommer`被删除了，所以它最终调用`int glom(List<Integer> ints)`而不是`String glom(Collection<?> obj)`.

我的问题是，即使我调用`glom()`它`new Glommer<Integer>().glom(strings)`不应该调用该`int glom(List<Integer> ints)`方法，因为由于类型擦除，该方法有效`int glom(List ints)`并且`strings`类型`List`不是`Collection`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-20T17:14:07.320

被调用的方法是在编译时定义的，而不是在运行时定义的。

如果在构造函数调用中添加参数，编译器将有足够的信息知道它必须调用第一个方法。否则，就好像泛型不存在一样。在这两种情况下，被调用的方法在运行时将始终保持不变。

编辑有些人似乎怀疑，所以这是另一个例子：

```
public class Test {

    private static void test(Object object) {
        System.out.println("Object method");
    }

    private static void test(Integer integer) {
        System.out.println("Integer method");
    }

    public static void main(String[] args) {
        Object object = Integer.valueOf(0);
        test(object);
    }

} 
```

结果是：

```
Object method 
```

您将 Integer 传递给您的方法，但编译器在编译时只知道它是一个对象。即使 Object 实际上是一个 Integer，jvm 也不会自动更改方法调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T17:36:44.517

您可以阅读有关[原始类型](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.8)的更多信息以完全理解它

基本上，原始类型用于使用遗留代码，原始类中的几乎所有内容都将成为原始类型，在本例中是这两种方法。

因此，当它是原始的时，有一个方法可以获取一个`List`和一个，`Collection`因此它被称为`List`一个，如果它不是原始的，那么这些方法也不是原始的，它会调用这个，`Collection`因为它有额外的信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T17:08:20.897

这是因为当`new Glommer()`在没有泛型的情况下调用时`Generic<Type>()`，所有类型匹配都会从类中删除。

由于 strings 变量是 a `List`，如果它没有任何泛型`<Type>`，那么它将匹配`glom(List ints)`. 类型检查直到稍后才完成。

当我们创建`new Glommer<AnyType>`类型时，所有类型都保留在原地，所以当我们传递我们的`strings`变量时，它会进行类型检查。编译器现在可以检查它是否是 a `List<Integer>`，它不是，所以它被传递给`glom(Collection<?> obj)`方法。

希望这会有所帮助，如果您需要任何澄清，请询问！

# wordpress - FLVPlayback Flash 皮肤未在 wordpress 中显示

> ID：13976963
> 
> 赞同：2
> 
> 时间：2012-12-20T16:57:04.953
> 
> 标签：wordpress, flash, controls, skin, flvplayback

我试图在我的网站中插入带有控件的 Flash 视频。我可以看到视频，但看不到带有 FLVPlayback 的控件。我将所有文件放在页面的同一级别，所以我不应该有路径错误......

这是我的文件：

*   Confr.flv
*   Confr.swf
*   MinimaFlatCustomColorPlayBackSeekCounterVolMute.swf (playerSkin)

我的代码：

```
<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width="667" height="410" id="Confr" align="middle">
                <param name="movie" value="http://unikmedia.ca/ad/wp-content/themes/adapte/Confr.swf" />
                <param name="quality" value="best" />
                <param name="bgcolor" value="#ffffff" />
                <param name="play" value="false" />
                <param name="loop" value="false" />
                <param name="wmode" value="window" />
                <param name="scale" value="showall" />
                <param name="menu" value="true" />
                <param name="devicefont" value="false" />
                <param name="salign" value="" />
                <param name="allowScriptAccess" value="sameDomain" />
                <!--[if !IE]>-->
                <object type="application/x-shockwave-flash" data="http://unikmedia.ca/ad/wp-content/themes/adapte/Confr.swf" width="667" height="410">
                    <param name="movie" value="http://unikmedia.ca/ad/wp-content/themes/adapte/Confr.swf" />
                    <param name="quality" value="best" />
                    <param name="bgcolor" value="#ffffff" />
                    <param name="play" value="false" />
                    <param name="loop" value="false" />
                    <param name="wmode" value="window" />
                    <param name="scale" value="showall" />
                    <param name="menu" value="true" />
                    <param name="devicefont" value="false" />
                    <param name="salign" value="" />
                    <param name="allowScriptAccess" value="sameDomain" />
                <!--<![endif]-->
                    <a href="http://www.adobe.com/go/getflash">
                        <img src="http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif" alt="Get Adobe Flash player" />
                    </a>
                <!--[if !IE]>-->
                </object>
                <!--<![endif]-->
            </object> 
```

如果您查看此链接，您可以看到播放器： http: [//unikmedia.ca/ad/wp-content/themes/adapte/Confr.swf](http://unikmedia.ca/ad/wp-content/themes/adapte/Confr.swf)

但在 wordpress 中，根本没有控制...：[http ://unikmedia.ca/ad/a-propos/](http://unikmedia.ca/ad/a-propos/)

请我需要帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-22T18:12:35.947

我遇到了同样的问题，我找到了解决方案...更改嵌入的 swf 对象中的“swf BASE 目录”。用这个参数指向你的 swf 目录，FLVPlayBack 就能找到控件皮肤的 swf。这是一个示例：

```
<script type="text/javascript"> 
    var flashvars = {};
    var params = {"base": "../project/subfolder/"};
    var attributes = {id: "Main", name: "Main"};
    swfobject.embedSWF("MainLoader.swf", "myAlternativeContent", "920", "550", "10.0.0", "expressInstall.swf", flashvars, params, attributes);
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T21:41:36.443

您的文件 MinimaFlatCustomColorPlayBackSeekCounterVolMute.swf 收到 404 错误。

尝试找到调用此文件的脚本并更改它。

但我建议您将 .swf 电影转换为 .mp4 并尽可能使用 jwplayer。

* * *

您也可以尝试在站点的根目录创建一个“a-propos”文件夹，例如“wp-content”文件夹，然后将“MinimaFlatCustomColorPlayBackSeekCounterVolMute.swf”文件放入其中

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-26T21:36:11.457

我遇到了同样的问题，在我的本地工作区我可以看到它，但在 WP 现场我看不到。在我的情况下，我通过更改皮肤 swf 的权限来解决它，尝试将 chmod 更改为 777（只是皮肤 swf 文件），看看是否是问题所在。

# php - PHP json_encode 从 https 失败

> ID：13976964
> 
> 赞同：0
> 
> 时间：2012-12-20T16:57:06.967
> 
> 标签：php, https, json

当用作安全页面并调用 json_encode() 时，我的 php 脚本会失败，但否则不会。该代码是从一个从 XHR 调用的更大脚本中提炼出来的。PHP 版本 5.2.0.、Apache/1.3.34 (Unix)。

问题来源：PHP、我的 ISP 还是我？

要进行演示，请以 4 种方式调用此脚本：

[https://www.camdenac.com/test_json_encode.php?encode=0](https://www.camdenac.com/test_json_encode.php?encode=0) => 有效，安全协议，不调用 json_encode()。
[https://www.camdenac.com/test_json_encode.php?encode=1](https://www.camdenac.com/test_json_encode.php?encode=1) => 失败，安全协议，调用 json_encode()。

在第一种情况下，您将看到一些 html，然后 php 回显结果。在第二种情况下，您只会看到 html；没有php输出。

```
/*
Try these 2 links also from non-secure protocol.
http://www.camdenac.com/test_json_encode.php?encode=0  => works.
http://www.camdenac.com/test_json_encode.php?encode=1  => works.
*/

<?php
$encode= 0;
if( isset($_GET['encode']) ){
    $encode= substr(trim($_GET['encode']),0,1);
}

$dummy= array(1,2,3,4,5);
$json="We did not call json_encode.";

if($encode){
    $json= json_encode($dummy);
}

echo '<p>IT WORKS!</p>';
echo '<p>Host protocol is: '.$_SERVER['HTTP_HOST'].'</p>';
echo '<p>Query string is: '.$_SERVER['argv'][0].'</p>';
echo '<p>HTTPS is: '.$_SERVER['HTTPS'].'</p>';
echo '<p>json encoding is: '.$json.'</p>';
echo '<p>Array dump follows:</p>';

var_dump($dummy);
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:00:19.850

我认为您的 php 版本太旧并且不包含该`json_encode`功能。如果您想使用它，您可能需要更新您的 php 版本。

# javascript - MeshFaceMaterial/JSON 材质错误

> ID：13976969
> 
> 赞同：0
> 
> 时间：2012-12-20T16:57:39.210
> 
> 标签：javascript, three.js

我的模型可以使用以下代码正常加载：

```
loader.load( "js/charWalk01.js", function( geometry, materials ) {
                mesh = new THREE.Mesh( geometry, new THREE.MeshLambertMaterial() );
                scene.add( mesh );

            } ); 
```

但是，当我尝试使用 MeshFaceMaterial（以便使用 JSON 文件中的材料）时，我收到两条非常奇怪的 three.min.js 错误消息（如下）。

```
loader.load( "js/charWalk01.js", function( geometry, materials ) {
                materials[ 0 ].morphTargets = true;
                mesh = new THREE.Mesh( geometry, new THREE.MeshFaceMaterial() );
                scene.add( mesh );
            } ); 
```

错误是：

```
 TypeError: 'undefined' is not an object (evaluating 'a.map') three.min.js:347

    TypeError: 'undefined' is not an object (evaluating 'ma.attributes') three.min.js:429 
```

JSON 文件完全正常（使用 OBJ 转换器创建），以下是其中的材料代码：

```
 "materials": [  {
"DbgColor" : 15658734,
"DbgIndex" : 0,
"DbgName" : "Mat.1",
"colorDiffuse" : [1.0, 1.0, 1.0],
"colorSpecular" : [0.4, 0.52, 0.53],
"illumination" : 4,
"mapDiffuse" : "Character_01.jpg"
}], 
```

关于为什么会出现这些错误的任何帮助？

干杯，伊恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T14:50:47.990

您需要`materials`作为参数传递给`MeshFaceMaterials`，如下所示：

```
loader.load( "js/charWalk01.js", function( geometry, materials ) {
    materials[ 0 ].morphTargets = true;
    mesh = new THREE.Mesh( geometry, new THREE.MeshFaceMaterial( materials ) );
    scene.add( mesh );
} ); 
```

三.js r.53

# javascript - 以角度调整窗口大小信息

> ID：13976970
> 
> 赞同：4
> 
> 时间：2012-12-20T16:57:44.017
> 
> 标签：javascript, angularjs, window-resize

我刚刚发布了这个小提琴，认为它可能对像我这样的人有所帮助。它展示了如何将普通的 javascript 传递给 Angular 范围。在这种情况下，范围获取窗口内部大小信息。

[http://jsfiddle.net/spacm/HeMZP/](http://jsfiddle.net/spacm/HeMZP/)

供个人使用，我会将这些信息传递给角度范围：

*   宽度和高度
*   方向/方向变化
*   iframe 检测
*   操作系统检测

使用`navigator.platform`变量

```
function isInIFrame(){
    return window.location !== window.parent.location;
}

function updateMediaInfoWH() {
    if((typeof(mediaInfo.inIFrame)!='undefined') && (!mediaInfo.inIFrame)) {
        mediaInfo.width = innerWidth;
        mediaInfo.height = innerHeight;
        updateMediaInfoOrientation();
    }
    tellAngular();
}

function tellAngular() {
    console.log("tellAngular");
    var domElt = document.getElementById('mainContainer');
    scope = angular.element(domElt).scope();
    console.log(scope);
    scope.$apply(function(){
        scope.mediaInfo = mediaInfo;
        scope.info = mediaInfo.width;
    });
} 
```

欢迎任何评论。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-22T02:17:21.477

我没有看到要回答的问题，所以我假设您的问题是在寻找有关您想法的输入。

开始使用 Angular 可能与您通常的工作方式有很大不同，主要是因为它们完全且完全地使用了依赖注入。

您不必“告诉” Angular 任何东西，您应该能够通过注入的依赖项（即 Angular 服务）访问所有这些信息。

使用您向我展示的内容，它可能看起来像这样：

```
my.MediaInfo = function($window) {
  this.window_ = $window;
  this.inIframe = $window.self !== $window.top;
  if(!this.inIFrame) {
    this.width = $window.innerWidth;
    this.height = $window.innerHeight;
  } else {
    this.width = this.height = ...;
  }
}

my.angular.controller = function($scope, mediaInfo) {
  // {width: X, height: Y, inIframe: false}
  $scope.mediaInfo = mediaInfo;
} 
```

然后你的 Angular 模块看起来像：

```
angular.module('module', [])
    .service('mediaInfo', my.MediaInfo)
    .controller('mainCtrl', my.angular.controller); 
```

希望这是一个很好的演示，说明您应该如何将数据导入 Angular。

# voicexml - VXML (VoiceXML) 的替代品？

> ID：13976973
> 
> 赞同：7
> 
> 时间：2012-12-20T16:57:57.107
> 
> 标签：voicexml

有人联系我说有机会做 VoiceXML——我对此没有任何经验，但显然这可能没问题。但是，我对该技术进行了一些初步研究，它看起来很古老，从未获得过太多牵引力等，但我无法弄清楚是什么技术（y，ies）取代了它。VoiceXML 是现在就可以掌握的一项好技能，还是它正在消亡/从未真正流行这么多？如果它正在消亡，什么是替代它？为什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-21T15:09:03.387

对于开发交互式语音响应 (IVR) 系统，VoiceXML 远未结束。所有顶级 IVR 平台都支持 VoiceXML，因为[它是 W3C 支持的开放标准，](http://www.w3.org/TR/voicexml20/)并且仍在由[Voice Browser 工作组](http://www.w3.org/Voice/)积极开发，以及许多其他相关标准。在[这篇博客文章](http://kevin-junghans.blogspot.com/2011/11/voicexml-and-aspnet-developer.html)中，对 VoiceXML 和开发环境的发展进行了很好的讨论。

VoiceXML 的另一个优点是它使用基于 Web 的技术来开发语音应用程序，因此您可以利用您在该领域的任何技能进行开发。但是，如果您不熟悉 IVR 开发，则需要学习其他技能才能获得成功，例如语音用户界面 (VUI) 设计、如何为语音应用程序开发语法以及调整语音应用程序。无论语言或开发环境如何，您都需要学习这些技能。

另一种开发 IVR 应用程序的方法可以减少对 VoiceXML 的了解，这是一个类似于开源项目[VoiceModel](https://github.com/kjunghans/VoiceModel/wiki)的框架。如果您已经具备 ASP.NET 方面的技能，VoiceModel 允许您开发在 VoiceXML 平台上运行的 IVR 应用程序，而无需了解 VoiceXML。它将它抽象到更高的层次，您只需将 .NET 对象拼凑在一起来定义您的语音应用程序。VoiceModel 的另一个好处是您可以开发您的 IVR 应用程序一次，它将在与 VoiceXML 兼容的 IVR 或基于云的 IVR（如[Tropo](https://www.tropo.com/home.jsp) ）上运行。还计划包括对[Twilio](http://www.twilio.com/)的支持。

也许这就是您听到的关于 VoiceXML 消亡的嗡嗡声。出现了一些基于云的 IVR/电话平台，例如 Tropo 和 Twilio，它们不使用 VoiceXML 并使用自己的专有 API。对我来说，这是向 IVR 开发的旧时代的倒退，每个 IVR 供应商都有自己的专有开发环境和语言。我坚信像 VoiceXML 这样的开放标准，但我不得不承认，这种新型 IVR 供应商肯定会在市场上产生一些吸引力。我认为现在确定他们是否会生存还为时过早。

所以主要问题是；是否有 VoiceXML 的替代品。答案是肯定的。[两个替代方案是Tropo](https://www.tropo.com/home.jsp)和[Twilio](http://www.twilio.com/)基于云的平台的专有 API 。另一种选择是使用类似[VoiceModel](http://voicemodel.codeplex.com/)的东西，它可以抽象出对 VoiceXML 的了解，但允许您在 VoiceXML 兼容的平台上运行应用程序。甚至另一种选择是使用像[VoiceObjects](http://www.voiceobjects.com/)这样的开发环境，它也抽象出对 VoiceXML 的很多需要。

另一个问题是；VoiceXML 是一项很好的技能。如果您正在开发大量 IVR 应用程序，特别是如果您正在支持现有应用程序，我会说是的。有很多 VoiceXML 应用程序需要维护，目前企业中主要的 IVR 平台与 VoiceXML 兼容。如果您正在开发一次性应用程序，您可能想要研究 Tropo 或 Twilio 之类的东西。需要注意的是，如果这些初创公司倒闭，您可能会在 VoiceXML 中重新编写应用程序。这就是我喜欢开放标准的原因。或者两全其美，看看像 VoiceModel 这样的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-21T07:12:58.863

VoiceXML 远未消亡——大多数大型商业 IVR 部署都基于 VoiceXML 及其近亲 CCXML。有很大的吸引力，并且需要 VoiceXML 开发人员。VoiceXML 规范的下一个版本正在 W3C 开发中。

在学习 VoiceXML 时，您可以使用开源 jVoiceXML (LGPL) [http://jvoicexml.sourceforge.net/](http://jvoicexml.sourceforge.net/)或 VoiceGlue (GPL) [http://www.voiceglue.org/](http://www.voiceglue.org/)或使用提供的免费开发人员托管来尝试您的技能通过 Voxeo 在[http://evolution.voxeo.com/](http://evolution.voxeo.com/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-21T12:33:21.723

这是查看 VoiceXML 的一种方式，但要复杂得多。与 Web 开发之类的东西相比，电话技术是一个利基市场。然而，在电话领域，VoiceXML 是 IVR 开发中最常见的技术，并且没有任何其他技术能够取代它。

新技术增长缓慢的部分原因与市场状况有关。从供应商的角度来看，这是一个正在收缩的艰难市场。在 80 年代和 90 年代，有很多新的创业公司。在风险资本家和其他投资者想要的水平上，市场可以支持的程度超出了市场。这导致了整合（公司被其他公司收购）。由于资金短缺，投资很少。这并不是说没有，但它速度很慢，并且与 VoiceXML 首次出现时有很大不同。

现有供应商通常以多种语言、VoiceXML 或两者提供专有 API 堆栈。应该注意的是，即使是许多支持 VoiceXML 的平台，也提供了隐藏较低级别 API 的开发工具。这些工具集通常是基于 GUI 的，是出于让非程序员编写和管理 IVR 的愿望。

技能视角属性有点难以回答，因为它的价值与您现有的技能组合、适销性和未来机会更相关。一般来说，我不会高度重视 VoiceXML 知识，因为工作数量少于其他主流技能。然而，典型的实现技术通常类似于基于 Web 的开发（ASP/JSP/Servlet 和 JavaScript 的使用），它们是可移植的。就像在任何技能和工作中一样，这就是你的成就。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-28T15:32:17.663

我已经编写 IVR 系统大约 20 年了，而且我从来没有费心去学习 VoiceXML。这是我使用的工具。. .

*   Visual Basic .NET
*   Windows 服务器中的对话语音 PCI 卡
*   Syntellect 的 CT ADE Visual Basic 库 [http://www.syntellect.com/pages/products/ct_ade_eng.aspx](http://www.syntellect.com/pages/products/ct_ade_eng.aspx)

此设置允许我通过调用 Syntellect 提供的例程在 Visual Basic 中编写 IVR 系统。它消除了深入研究 VoiceXML 的需要，相比之下这是非常精细的。

使用 Syntellect 例程，您可以 . . .

*   打个电话
*   接听电话
*   向来电者播放语音文件
*   从呼叫者那里获取数字
*   录制语音文件
*   转接电话

使用这些基本功能，您可以创建几乎任何 IVR 系统。然后，我很容易在 SQL 数据库中捕获“提示”参数并查询整个脚本文件以播放给调用者。

此方法仅适用于手机。这就是您所需要的，这种方法可以更快地启动和运行。Syntellect 还具有 VoiceXML 接口和解决方案，可帮助实现 VoIP 连接。

Syntellect 提供了 Visual Basic 和 C# 的示例。我认为他们也有一些用于 C++ 的。希望这可以帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-07-31T21:22:09.850

Twilio 已经证明，更直观、更简单的 DSL 可以涵盖大量用例。学习 TwiML 不需要时间，而 VoiceXML 的学习曲线可能很重要。

还有 Restcomm，它是基于开源 (Mobicents) 的 Twilio API 实现。它可以用作托管 IVR 引擎或在公共云上：

[http://www.telestax.com/restcomm/](http://www.telestax.com/restcomm/)

ttps://aws.amazon.com/marketplace/pp/B00FFHJ6SU

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-01-04T22:16:37.240

I agree with DaveHolly. I used Syntellect CT-ADE for five years and implemented a successful IVR for medical dictation plus sending and receiving fax documents, and SQL Server database access. If you know how to program in C# or VB.NET, and want to use the fantastic Microsoft Visual Studio and .NET as your platform, then stay with CT-ADE or Glorsoft Velocity. In my opinion, by using XML as a programming language, something it was never designed for, you are giving up fifty years of computer science advances, such as structured programming, object-oriented programming, modern languages such as C#, debugging tools, etc..

# javascript - 使用 ?version=XXX 刷新缓存中的 CSS 文件

> ID：13976975
> 
> 赞同：10
> 
> 时间：2012-12-20T16:57:58.010
> 
> 标签：javascript, css, caching, refresh

为了刷新缓存中的 CSS 文件，我经常使用 file.css?version=DDMMYYYY 技巧。但是，我对这种方法有疑问。

我正在使用旧的外联网。所有页面都使用相同的 CSS 文件。Extranet 没有任何模板文件，并且这个 css 包含在 Extranet 的每个页面中。我需要为所有外联网页面刷新这个 css 文件。

我的问题是：我想在登录页面上使用 file.css?version=DDMMYYYY 技巧。其他页面仍将包含 file.css（没有 ?version 部分）

如果用户进入登录页面，他将收到新版本的 css 文件。但是其他页面将使用哪个版本？旧版本 (file.css) 还是新版本 (file.css?version=DDMMYYYY) ？

换句话说，当用户进入登录页面时，哪些文件将在他的缓存中：

*   file.css 和 file.css?version=DDMMYYYY
*   只有file.css，更新到新版本

对于这个初学者问题，我很抱歉，但我自己测试它有一些困难。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-20T17:05:46.543

当文件被缓存时，它将带有完整的 url，包括`?`后面的内容。缓存标头由服务器提供并由浏览器遵守。

本质上

> file.css?version=DDMMYYYY
> 和
> file.css

是浏览器的 2 个单独文件，没有任何连接。

我对您的建议是在所有页面上始终使用新网址。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-20T17:07:30.493

这不起作用，它们将被不同地缓存，尽管它们是文件系统`file.css`中`file.css?version=DDMMYYYY`的同一个文件，它们是不同的 URI，服务器响应可能完全不同......所以，`file.css`可以同时从缓存中加载旧文件你得到正确的文件`file.css?version=DDMMYYYY`。

防止这种情况的一种方法可能是完全禁用缓存，这会导致每次加载页面时都会下载 css 文件，但会为您提供即时更新，或者您可以将缓存设置为在短时间内过期，例如 10 分钟, 2 小时，因此它将每 10 分钟/2 小时下载一次...

如果您使用启用了 htaccess 的 apache，您可以这样做来禁用缓存：

```
<filesMatch ".(html|htm|js|css)$">
FileETag None
<ifModule mod_headers.c>
Header unset ETag
Header set Cache-Control "max-age=0, no-cache, no-store, must-revalidate"
Header set Pragma "no-cache"
Header set Expires "Wed, 11 Jan 1984 05:00:00 GMT"
</ifModule>
</filesMatch> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-12T10:23:10.043

在我的项目中，我还使用 ?version 方法强制浏览器获取新版本的 CSS 文件。而不是使用 ?version=DDMMYYYY 我建议使用 filemtime()。

例子：

```
<link rel="stylesheet" href="css/custom.css?<?php=filemtime('css/custom.css')?>" type="text/css" media="screen" /> 
```

函数 filemtime() 获取文件修改时间，因此当 CSS 文件更改时浏览器将获取新版本的 CSS。如果文件未更改，则时间保持不变，浏览器使用文件的缓存版本。

# security - 保护加密数据的临时访问密钥

> ID：13976977
> 
> 赞同：1
> 
> 时间：2012-12-20T16:58:06.793
> 
> 标签：security, encryption

我正在构建一个安全数据存储，它可以在多个经过身份验证的用户之间共享安全信息，并允许未经身份验证的用户将数据签入安全数据存储，而不会公开或泄露其内容。

目前，数据使用 1024 位密钥加密，并具有关联的 RSA（2048 位）密钥对（私钥由 1024 位密钥加密）。这意味着如果人们想要签入数据，那么可以使用 RSA 密钥。

1024 位密钥也使用特定于每个用户的用户秘密进行加密，完全私有，并且在开始时随机生成（或在请求时重置）。这意味着用户可以在不公开密钥的情况下访问数据。

最后一点是存储用户秘密。秘密本身是使用另一个 RSA（也使用 2048 位密钥）密钥对加密的。公钥与用户相关联，私钥使用他们的登录密码加密。

在实际登录时，验证用户的用户名和密码，然后将唯一令牌返回给浏览器，将其授权为特定用户。

在登录点，如果密码有效，将使用密码解密 RSA 私钥，从而恢复 User Secret。

但是用户的密码一次只能用于系统，所以我打算利用那一刻来获取用户密码并将其存储在当前登录会话可以使用的地方，但没有其他人可以使用。

虽然我可以将它存储在一个单独的数据库中，该数据库会加密它（可以说是使用访问令牌），当用户注销时会丢失，但我担心的是，如果有人在登录时试图闯入系统，他们可以恢复秘密，因此可以恢复其余数据。

有没有人有任何想法或参考可以保护用户机密不被除会话之外的所有人访问的实现？

# unicode - UILabel 转换Unicode（日文）并显示

> ID：13976980
> 
> 赞同：2
> 
> 时间：2012-12-20T16:58:12.643
> 
> 标签：unicode, uilabel

经过几个小时的研究，我放弃了。我从 WebService 接收文本数据。在某些情况下，文本是日语，WS 返回其 Unicoded 版本。例如：\U00e3\U0082\U008f 我知道这是一个日文字符。

我正在尝试在 UILabel 中显示此 Unicode 字符或字符串。由于简单的 setText 方法没有显示正确的字符，我使用了这个（复制的）例程：

```
unichar unicodeValue = (unichar) strtol([[[p innerData] valueForKey:@"title"] UTF8String], NULL, 16);
char buffer[2];
int len = 1;
if (unicodeValue > 127) {
    buffer[0] = (unicodeValue >> 8) & (1 << 8) - 1;
    buffer[1] = unicodeValue & (1 << 8) - 1;
    len = 2;
} else {
    buffer[0] = unicodeValue;
}
    [[cell title] setText:[[NSString alloc] initWithBytes:buffer length:len encoding:NSUTF8StringEncoding] ]; 
```

但没有成功：UILabel 是空的。我知道一种方法可以将字符转换为十六进制，然后从十六进制转换为字符串......有没有更简单的方法？

**解决了**

首先，您必须确保您的服务器发送的是 UTF8 而不是 UNICODE CODE POINTS。我发现的唯一方法是对包含 UNICODE 字符的字符串进行 json_encode。然后，在 iOS 用户中，按照此链接[使用 Objective C/Cocoa 取消转义 unicode 字符，即 \u1234](https://stackoverflow.com/questions/2099349/using-objective-c-cocoa-to-unescape-unicode-characters-ie-u1234)

# android - 制造商的可移动存储（外部）SD卡路径

> ID：13976982
> 
> 赞同：32
> 
> 时间：2012-12-20T16:58:22.847
> 
> 标签：android, path, sd-card, android-sdcard

我一直在谷歌搜索，但很难找到哪些制造商/型号使用哪个路径用于 sdcard/外部存储。

*   我不是在谈论可以通过以下方式找到的内部存储路径：

`Environment.getExternalStorageDirectory()`

*我知道`getExternalStorageDirectory()`有时指向某些设备上的外部 sdcard。*

这是我为外部路径找到的一些通用路径（不确定哪个制造商使用哪个路径）：

```
/emmc
/mnt/sdcard/external_sd
/mnt/external_sd
/sdcard/sd
/mnt/sdcard/bpemmctest
/mnt/sdcard/_ExternalSD
/mnt/sdcard-ext
/mnt/Removable/MicroSD
/Removable/MicroSD
/mnt/external1
/mnt/extSdCard
/mnt/extsd
/mnt/usb_storage  <-- usb flash mount
/mnt/extSdCard  <-- usb flash mount
/mnt/UsbDriveA  <-- usb flash mount
/mnt/UsbDriveB  <-- usb flash mount 
```

这些是我通过谷歌搜索发现的。

我需要扫描整个内部 + 外部存储 + USB 闪存驱动器来查找某个文件。如果我缺少任何路径，请添加到上面的列表中。如果有人知道每个制造商使用的路径，请与我们分享。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-03-20T23:25:24.703

好消息！在 KitKat 中，现在有一个公共 API 用于与这些辅助共享存储设备进行交互。

新的`Context.getExternalFilesDirs()`和`Context.getExternalCacheDirs()`方法可以返回多个路径，包括主设备和辅助设备。然后，您可以遍历它们并检查`Environment.getStorageState()`并`File.getFreeSpace()`确定存储文件的最佳位置。`ContextCompat`这些方法在 support-v4 库中也可用。

另请注意，如果您只对使用返回的目录感兴趣，则`Context`不再需要`READ_`or`WRITE_EXTERNAL_STORAGE`权限。展望未来，您将始终拥有对这些目录的读/写访问权限，而无需其他权限。

应用程序还可以通过终止其权限请求来继续在旧设备上工作，如下所示：

```
<uses-permission
    android:name="android.permission.WRITE_EXTERNAL_STORAGE"
    android:maxSdkVersion="18" /> 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-01-23T15:23:03.077

我还从某个地方的类似您的列表开始（抱歉找不到原始来源）并继续添加从用户反馈中收集的一些路径。上述列表有重复项。

```
 /storage/sdcard1 //!< Motorola Xoom
    /storage/extsdcard  //!< Samsung SGS3
    /storage/sdcard0/external_sdcard  // user request
    /mnt/extsdcard
    /mnt/sdcard/external_sd  //!< Samsung galaxy family
    /mnt/external_sd
    /mnt/media_rw/sdcard1   //!< 4.4.2 on CyanogenMod S3
    /removable/microsd              //!< Asus transformer prime
    /mnt/emmc
    /storage/external_SD            //!< LG
    /storage/ext_sd                 //!< HTC One Max
    /storage/removable/sdcard1      //!< Sony Xperia Z1
    /data/sdext
    /data/sdext2
    /data/sdext3
    /data/sdext4
    /sdcard1                       //Sony Xperia Z
    /sdcard2                       //HTC One M8s
    /storage/microsd               //ASUS ZenFone 2 
```

对于您想要实现的目标（扫描某些文件的所有可能路径），我认为这样做是完全不可能的（使用已知路径列表）。同一设备上的某些路径甚至在 android 升级之间发生了变化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-15T14:09:47.970

根据 oceanuz 提供的路径，我写了一个方法，它定位外部存储路径（忽略大小写）并将其作为字符串返回。

注意：我在我的方法中使用[了 StreamSupport](http://sourceforge.net/projects/streamsupport/)库，因此为了使其工作，您需要下载 jar 文件并将其添加到项目中的 libs 文件夹中，仅此而已。

```
 public static String getExternalSdPath(Context context) {
    List<String> listOfFoldersToSearch = Arrays.asList("/storage/", "/mnt/", "/removable/", "/data/");
    List<String> listOf2DepthFolders = Arrays.asList("sdcard0", "media_rw", "removable");
    List<String> listOfExtFolders = Arrays.asList("sdcard1", "extsdcard", "external_sd", "microsd", "emmc", "ext_sd", "sdext",
            "sdext1", "sdext2", "sdext3", "sdext4");
    final String[] thePath = {""};
    Optional<File> optional = StreamSupport.stream(listOfFoldersToSearch)
            .filter(s -> {
                File folder = new File(s);
                return folder.exists() && folder.isDirectory();
            }) //I got the ones that exist and are directories
            .flatMap(s -> {
                try {
                    List<File> files = Arrays.asList(new File(s).listFiles());
                    return StreamSupport.stream(files);
                } catch (NullPointerException e) {
                    return StreamSupport.stream(Collections.emptyList());
                }
            }) //I got all sub-dirs of the main folders
            .flatMap(file1 -> {
                if (listOf2DepthFolders.contains(file1.getName().toLowerCase())) {
                    try {
                        List<File> files = Arrays.asList(file1.listFiles());
                        return StreamSupport.stream(files);
                    } catch (NullPointerException e) {
                        return StreamSupport.stream(Collections.singletonList(file1));
                    }
                } else
                    return StreamSupport.stream(Collections.singletonList(file1));
            }) //Here I got all the 2 depth and 3 depth folders
            .filter(o -> listOfExtFolders.contains(o.getName().toLowerCase()))
            .findFirst();

    optional.ifPresent(file -> thePath[0] = file.getAbsolutePath());

    Log.i("Path", thePath[0]);

    return thePath[0];
} 
```

如果没有找到 SD 卡路径，此方法将返回一个空字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-26T22:39:44.553

我试图在 Sony Xperia XA 上找到我的外部 SD 卡的路径。然后我安装了 ES 文件资源管理器，并在其特征窗口中清楚地显示了任何文件夹（内部或外部）的路径。我发现外部 SD 的路径为 /storage/C4EE-F3A3。我试图将输出文件从 Python3 保存到外部 SD，但它没有权限在内部 SD 中保存除 Qpython 文件夹以外的任何位置。

# python - 需要帮助使用 BeautifulSoup 和 Python 解析此 HTML

> ID：13976984
> 
> 赞同：1
> 
> 时间：2012-12-20T16:58:23.800
> 
> 标签：python, beautifulsoup

我想使用 BeautifulSoup 解析以下 HTML：

```
<tr class="TrGameOdd">
  <td align="center">
    <a href="Schedule.aspx?WT=0&amp;lg=778&amp;id=,1583114">
      <img border="0" src="/core/engine/App_Themes/Global/images/plus.gif">
    </a>
  </td>
  <td align="left">Oct 20</td>
  <td>777</td>
  <td align="left" colspan="2">Cupcakes</td>
  <td align="right">7+3
    <input type="checkbox" value="0_1583114_-3440" name="text_">
  </td>
  <td align="right">a199
    <input type="checkbox" value="2_1583114_-199.5_-110" name="text_">
  </td>
</tr> 
```

有一大堆这样的行，但我只需要其中的细节。例如，我想解析`777, Cupcakes, 7+3, -3440, a199`出所有这些。我该怎么做呢？我希望它并排打印，并且我想要解析其中的一些行，所以当它打印时应该是这样的：

```
777 Cupcakes 7+3 -3440
X X X X
X X X X
etc 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T17:15:10.723

```
from BeautifulSoup import BeautifulSoup
soup = BeautifulSoup(html)
trs = soup.find("tr",{"class":"TrGameOdd"})

for tr in trs:
   tds = tr.findAll("td")

   print tds[1].string # Oct 20
   print tds[2].string # 777
   print tds[3].string # Cupcakes
   ... 
```

你需要继续自己 [http://www.crummy.com/software/BeautifulSoup/bs4/doc/](http://www.crummy.com/software/BeautifulSoup/bs4/doc/)

# java - 如何缩短嵌套的 if 表达式？

> ID：13976985
> 
> 赞同：0
> 
> 时间：2012-12-20T16:58:28.930
> 
> 标签：java

是否有可能以某种方式缩短许多 if 表达式？示例：想象 3 个数字，只有当前一个数达到 10 时，每个数字才会增加。

```
int a = 0, b = 0, c = 0;

a++;
if (a == 10) {
    a = 0;
    b++;
    if (b == 10) {
        b = 0;
        c++;
    }
}

return toString(a+b+c); //I know this is not valid 
```

是否有可能以某种方式缩短这些表达式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T17:01:09.977

语法方面，没有。不是在 Java 中。你唯一的办法就是改进你的算法。我不确定您的算法到底想要实现什么，但从外观上看，您可以通过正确使用集合来减少嵌套。

# git - Git 树哈希 id 生成

> ID：13976986
> 
> 赞同：1
> 
> 时间：2012-12-20T16:58:30.367
> 
> 标签：git

首先初始化一个包含名为rose的文件的repo

```
$: echo sweet > rose
$: git init
$: git add .
$: find .git/objects/ -type f
.git/objects/aa/823728ea7d592acc69b36875a482cdf3fd5c8d
$: git commit -m "rose"
$: find .git/objects/ -type f -printf "%h%f %s\n"
.git/objects/05b217bb859794d08bb9e4f7f04cbda4b207fbe9 49
.git/objects/aa823728ea7d592acc69b36875a482cdf3fd5c8d 21
.git/objects/665d02ccbacdde1c0f2eecde01fbf47144ddd492 124 
```

然后我想共享 blob 并查看如何生成树对象的 id

```
echo -e "tree 21\0100644 rose\0aa823728ea7d592acc69b36875a482cdf3fd5c8d"|sha1sum 
```

它打印的不是`05b217bb859794d08bb9e4f7f04cbda4b207fbe9`
我哪里错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T17:00:19.027

`echo`默认情况下插入换行符，除非您指定`-n`（省略换行符）标志。

此外，blob ID 不是以 ASCII 格式存储的，而是以二进制值的形式存储的。这导致对象大小为 32（而不是 21）。

以下命令将为您提供正确的输出：

```
echo -en 'tree 32\x00100644 rose\x00\xaa\x82\x37\x28\xea\x7d\x59\x2a\xcc\x69\xb3\x68\x75\xa4\x82\xcd\xf3\xfd\x5c\x8d' | sha1sum 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-20T17:14:33.257

树中的对象 ID 未以该格式存储。看一看：

```
git cat-file tree 05b217bb859794d08bb9e4f7f04cbda4b207fbe9 | od -c 
```

相反，树数据是 的序列`<mode> SP <filename> NUL <hash>`，其中`<mode>`是字符串形式模式，并且`<hash>`是 20 字节的 SHA1。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-05-08T00:25:02.617

树对象的格式如下：

```
tree SIZE\0ENTRIES 
```

`SIZE`是树的大小。
`ENTRIES`是一个序列，其中每个元素表示树引用的对象。
每个对象条目的格式如下：

```
MODE NAME\0BSHA 
```

`MODE`是：

*   100644 对于普通文件，
*   100755 用于可执行文件，
*   120000 用于符号链接，
*   040000 表示树对象。

`NAME`是目录或文件名。
`BSHA`是对象 ID 的二进制表示。

关于 OP 的示例，让我们获取对上层树（主分支）的引用：

```
$ git write-tree
05b217bb859794d08bb9e4f7f04cbda4b207fbe9 
```

虽然我将使用这棵树，但以下内容适用于每棵树。
前 6 个字符 ( `05b217`) 就足够了。

人类可读格式的树内容由下式给出：

```
$ git ls-tree 05b217
100644 blob aa823728ea7d592acc69b36875a482cdf3fd5c8d    rose 
```

您可以替换`git ls-tree`为`git cat-file -p`.

二进制格式*类似于*以下给出的：

```
$ git cat-file tree 05b217
100644 rose ▒▒7(▒}Y*▒i▒hu▒▒▒▒▒\▒% 
```

实际内容也有初始字符串`tree [content size]\0`。要获得它，您可以使用 2/38 哈希格式
解压缩将树存储在文件夹中的文件：`.git`

```
$ openssl zlib -d -in .git/objects/05/b217bb859794d08bb9e4f7f04cbda4b207fbe9
tree 32 100644 rose ▒▒7(▒}Y*▒i▒hu▒▒▒▒▒\▒% 
```

给定存储在树中并可通过 获取的对象`ls-tree`，可能会生成使用 awk 脚本存储的（实际）内容：

```
$ git ls-tree 05b217 | awk -b 'function bsha(asha)\
{patsplit(asha, x, /../); h=""; for(j in x) h=h sprintf("%c", strtonum("0x" x[j])); return(h)}\
{t=t sprintf("%d %s\0%s", $1, $4, bsha($3))} END {printf("tree %s\0%s", length(t), t)}'
tree 32 100644 rose ▒▒7(▒}Y*▒i▒hu▒▒▒▒▒\▒% 
```

为了更好地理解输出，我使用转义序列生成了它的一个版本：

```
$ git ls-tree 05b217 | awk -b 'function bsha(asha)\
{patsplit(asha, x, /../); h=""; for(j in x) h=h sprintf("%s", "\\x" x[j]); return(h)}\
{t=t sprintf("%d %s\0%s", $1, $4, bsha($3))} END {printf("tree %s\0%s", length(t), t)}'
tree 92 100644 rose \xaa\x82\x37\x28\xea\x7d\x59\x2a\xcc\x69\xb3\x68\x75\xa4\x82\xcd\xf3\xfd\x5c\x8d% 
```

将此输出与之前的输出进行比较`git ls-tree 05b217`。

我现在使用不同的方法来 **生成树哈希。**

使用树的文件存储版本：

```
$ openssl zlib -d -in .git/objects/05/b217bb859794d08bb9e4f7f04cbda4b207fbe9 | shasum
05b217bb859794d08bb9e4f7f04cbda4b207fbe9 *- 
```

使用我的 awk 生成的内容：

```
$ git ls-tree 05b217 | awk -b 'function bsha(asha)\
{patsplit(asha, x, /../); h=""; for(j in x) h=h sprintf("%c", strtonum("0x" x[j])); return(h)}\
{t=t sprintf("%d %s\0%s", $1, $4, bsha($3))} END {printf("tree %s\0%s", length(t), t)}' | shasum
05b217bb859794d08bb9e4f7f04cbda4b207fbe9 *- 
```

最后是`git mktree`命令：

```
# git ls-tree 05b217 | git mktree    
05b217bb859794d08bb9e4f7f04cbda4b207fbe9 
```

获得的哈希值始终相同。

# visual-studio-2010 - 是否可以让 Visual Studio 中的 Ctrl-Tab 源文件切换窗口（IDE Navigator）有更宽的列？

> ID：13976993
> 
> 赞同：3
> 
> 时间：2012-12-20T16:58:51.670
> 
> 标签：visual-studio-2010, visual-studio

我的一些源文件的文件名很长，当我按下 Ctrl-Tab 或 Shift-Ctrl-Tab 时，IDE Navigator 的 Active Files 列中显示的文件名在 23 号之后被截断（并被省略号替换）第 24 个字符，变得无法区分。我想知道某处是否有配置文件或注册表设置可以使 IDE Navigator 中的列更宽，以便更大的文件名可以适合列显示。

如果它具有最大宽度，我不介意使整个导航器窗口也更大。当它弹出时，我对查看它下面的代码不感兴趣，只是我将通过连续按下 (Shift-)-Ctrl-Tab 切换到的文件的文件名。我知道有一个秘密注册表项用于在导航器中显示缩略图，但我想知道是否也可以控制列宽。

谢谢你的帮助。

# php - InstantCommons 不缓存 - 每次页面加载都从公共请求文件

> ID：13976995
> 
> 赞同：2
> 
> 时间：2012-12-20T16:59:03.383
> 
> 标签：php, mediawiki

我是[Practical Plants](http://practicalplants.org)的主要开发者。我们正在使用 InstantCommons 从共享资源中获取图像，但它们似乎无法在本地缓存，从而导致页面加载缓慢并给共享资源带来不必要的负担。

我已经设置`$wgUseInstantCommons=true`了，它可以很好地下载图像，但不会缓存它们。我在我的 debug.log 中得到了这个：

```
ForeignAPIRepo: HTTP GET: http://commons.wikimedia.org/w/api.php?titles=File%3ABrassica_oleracea0.jpg&iiprop=timestamp%7Cuser%7Ccomment%7Curl%7Csize%7Csha1%7Cmetadata%7Cmime&prop=imageinfo&iimetadataversion=2&format=json&action=query&redirects=true
Class PEAR_Error not found; skipped loading
ForeignAPIRepo: HTTP GET: http://commons.wikimedia.org/w/api.php?titles=File%3ABrassica_oleracea0.jpg&iiprop=url%7Ctimestamp&iiurlwidth=248&iiurlheight=-1&iiurlparam=248px&prop=imageinfo&format=json&action=query&redirects=true
ForeignAPIRepo::getThumbUrl got remote thumb http://upload.wikimedia.org/wikipedia/commons/thumb/1/11/Brassica_oleracea0.jpg/248px-Brassica_oleracea0.jpg
ForeignAPIRepo: HTTP GET: http://commons.wikimedia.org/w/api.php?titles=mwstore%3A%2F%2Fwikimediacommons-backend%2Fwikimediacommons-thumb%2F1%2F11%2FBrassica_oleracea0.jpg%2F248px-Brassica_oleracea0.jpg&prop=imageinfo&format=json&action=query&redirects=true
ForeignAPIRepo::getThumbUrlFromCache Thumbnail was already downloaded before
ForeignAPIRepo: HTTP GET: http://upload.wikimedia.org/wikipedia/commons/thumb/1/11/Brassica_oleracea0.jpg/248px-Brassica_oleracea0.jpg
ForeignAPIRepo::getThumbUrlFromCache could not write to thumb path: mwstore://wikimediacommons-backend/wikimediacommons-thumb/1/11/Brassica_oleracea0.jpg/248px-Brassica_oleracea0.jpg 
```

请注意，错误中的路径输出`ForeignAPIRepo:getThumbUrlFromCache`是我添加的，以尝试稍微了解问题，因此我的 ForeignAPIRepo.php 文件中的第 300-305 行如下所示

```
$op = array( 'op' => 'create', 'dst' => $localFilename, 'content' => $thumb );
if( !$backend->doOperation( $op )->isOK() ) {
    wfRestoreWarnings();
    wfDebug( __METHOD__ . " could not write to thumb path: ".$localFilename."\n" );
    return $foreignUrl;
} 
```

任何人都知道这里可能发生了什么？我的 ./images 目录和所有子目录都是 775（apache 用户具有组权限），因此它们绝对是可写的。此外，本地上传的图像工作正常。

如果我可以提供更多信息，请告诉我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T13:04:27.237

升级到 1.20.2 已经解决了这个问题，所以我假设这只是我使用的 MediaWiki 版本（1.19.X）的一个错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-07T09:29:14.110

请注意，从 MediaWiki 1.27 开始，InstantCommons[将热链接缩略图](https://gerrit.wikimedia.org/r/#/c/251556/)而不是在本地生成它们。这将大大减少头痛。该配置也可用于旧版本。