# StackOverflow 问答 14351000-14351999

# python - 在 sweetpie 中更新多个资源上的字段

> ID：14351000
> 
> 赞同：2
> 
> 时间：2013-01-16T03:39:18.353
> 
> 标签：python, django, tastypie

我有一个美味的模型资源，我想用它来一次更新这个模型的多个实例的一个字段。

```
class Message(models.Model):
    # ... fields etc
    unread = models.BooleanField(default=True) 
```

我试图发送一个 PATCH 请求（目前在测试中），但这不起作用：

```
api = TestApiClient()
data = {'unread': False}
api.patch('/path/to/resource/', data=data) 
```

有没有人有任何想法？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T15:57:12.343

如果您使用补丁请求来更新多个实例的字段，则必须发送对象。像这样：

```
data = {objects:[{'unread':False,'resource_uri':'uri/of/your/instance'},{'unread':False,'resource_uri':'uri/of/your/instance'}]} 
```

更多信息[在这里](http://django-tastypie.readthedocs.org/en/latest/interacting.html#bulk-operations)和[这里](http://django-tastypie.readthedocs.org/en/latest/resources.html#patch-list)

# php - 自定义 Composer 自动加载器

> ID：14351001
> 
> 赞同：2
> 
> 时间：2013-01-16T03:39:26.887
> 
> 标签：php, static, constructor, composer-php, autoloader

无论如何都可以在 Composer 中使用自定义自动加载器吗？

我有一些包含数百个类的库，它们按照 PSR-0 排列在目录结构中。

然而，它们也包括一个静态构造器（类似于 Java 的静态初始化器）。

我在作曲家之前使用的自动加载器会：

```
if (method_exists($class, '__static')) {
    call_user_func(array($class, '__static'));
} 
```

那么有没有办法扩展作曲家的默认自动加载器来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T09:35:31.167

## 黑客作曲家

您可以通过修改`ClassLoader.php`（在供应商目录中找到）来破解 Composer 的自动加载器以支持此功能：

```
public function loadClass($class)
{
    if ($file = $this->findFile($class)) {
        include $file;

        // Added your custom code:
        if (method_exists($class, '__static')) {
            call_user_func(array($class, '__static'));
        }

        return true;
    }
} 
```

但是这个文件每次运行都会更新`composer update`（源码包含在里面`composer.phar`），所以修改一次也不好；您需要一种使这种修改“永久”的方法。

我能想到的有两种方法：

### 修改 Composer 本身

该解决方案涉及修改`composer.phar`，这意味着：

*   修改完成后，hack 将始终有效，无需任何额外设置
*   运行`composer self-update`会用最新的官方版本覆盖修改过的 Composer 源码，撤销 hack

我编写了一个简短的 PHP 脚本，它在 Composer 源上执行有针对性的查找/替换；它只会修改它所针对的确切代码，这意味着您每次都需要在未修改的 Composer 版本上运行它（它会拒绝触及已经修改的版本）：

```
<?php

if (!Phar::canWrite()) {
    die ('The config setting phar.readonly must be set to 0 in php.ini');
}

$phar = new Phar('composer.phar');
$fileName = 'src/Composer/Autoload/ClassLoader.php';

try {
    $source = file_get_contents($phar[$fileName]);
}
catch (BadMethodCallException $e) {
    echo $e->getMessage();
    die;
}

$find = <<<'END_ORIGINAL'
    public function loadClass($class)
    {
        if ($file = $this->findFile($class)) {
            include $file;

            return true;
        }
    }
END_ORIGINAL;

$replaceWith = <<< 'END_REPLACEMENT'
    public function loadClass($class)
    {
        if ($file = $this->findFile($class)) {
            include $file;

            // Add your custom code here!
            return true;
        }
    }
END_REPLACEMENT;

$find = preg_replace('/\s+/', '\\s+', preg_quote($find));
$modified = preg_replace('/'.$find.'/', $replaceWith, $source);

if ($source == $modified) {
    echo 'Could not find replacement target, aborting';
    die;
}

file_put_contents($phar[$fileName], $modified);
echo 'Replacement done, file saved'; 
```

### 使用更新后脚本

Composer 允许您将[脚本](http://getcomposer.org/doc/articles/scripts.md)附加到您的根包；一个修改后的更新脚本`ClassLoader.php`是一个很好的方法，可以使更改在更新中保持不变，同时保持 Composer 的源完整。

调整上一节中的代码来执行此操作非常简单。理想情况下，脚本将是一个静态 PHP 类方法，但为了做到这一点，您*必须*创建一个新的 Composer 包，该包使用 Composer 的 PSR-0 自动加载器自动加载，因为该类必须自动加载，目前[无法](https://github.com/composer/composer/issues/1430)使用类映射自动加载类在 Composer 的更新过程中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-23T16:20:53.203

无论文件如何加载（自动加载、显式要求或包含），一个更安全的替代方法是在类定义之后简单地调用静态初始化器：

```
class Foo {
    private static $__constructed = false;

    public static function __static() {
        if (self::$__constructed) return;

        // do initialization
        self::$__constructed = true;
    }
}

Foo::__static(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T23:16:20.267

我最终做的是：

*   修改`vendor/composer/ClassLoader.php`
*   提交修改后的类加载到项目（但忽略供应商目录的其余部分）
*   `git checkout vendor/composer/ClassLoader.php`后`composer update`

# bash - 如何在bash中有条件地抑制重定向？

> ID：14351012
> 
> 赞同：1
> 
> 时间：2013-01-16T03:41:00.723
> 
> 标签：bash, io-redirection

我有一个名为“run”的shell函数，通常只是将其参数视为命令行（即，好像没有使用'run（）'。）但是，如果脚本在a中运行`$TESTMODE`，则'run（） ' 将回显其参数，而不是：

```
run ()
{
  cmd="$@"
  if [ -z "$TESTMODE" ]; then
    $cmd
  else
    echo "### RUN: '$cmd'"
  fi
} 
```

这个想法是，该命令`run rm -Rf /`通常会尝试删除整个根文件系统。但是，如果定义了 $TESTMODE，那么它会回显

```
### RUN: rm -Rf / 
```

它工作得很好，直到您尝试在包含重定向的命令行上使用 run() ：

```
run which which
run which bash >quiet 
```

在这种情况下，当`$TESTMODE`定义时，`echo`人眼将永远无法看到所需的内容：

```
$ rm quiet
$ TESTMODE=yes ./runtest.sh
### RUN: 'which which'
$ cat quiet
### RUN: 'which bash' 
```

我试图用字符串替换来纠正这个问题：

```
run ()
{
  cmd="$@"
  if [ -z "$TESTMODE" ]; then
    $cmd
  else
    cmd=${cmd//\>/\\>}
    cmd=${cmd//\</\\<}
    echo "### RUN: '$cmd'"
  fi
} 
```

...在命令行测试中似乎很有希望：

```
$ test1="foo >bar"
$ echo $test1
foo >bar
$ test2=${test1//\>/\\>}
$ echo $test2
foo \>bar 
```

...但在我的 bash 脚本中惨遭失败（行为没有明显变化）。

帮助？我确信这与引用有关，但我不确定如何解决它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T03:51:41.787

> 运行 which bash >quiet

这会使 STDOUT 的输出静音，但不会静音 STDERR

所以你可以试试这个

```
echo "### RUN: '$cmd'" >/dev/stderr 
```

或者干脆

```
echo "### RUN: '$cmd'" >&2 
```

[**参考**](https://stackoverflow.com/questions/2990414/echo-that-outputs-to-stderr)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T04:06:03.873

这不是逃避的问题；重定向发生在您的函数甚至开始之前，并且不在函数的控制范围内。例如，当 bash 看到 command 时`run which bash >quiet`，bash 首先将输出重定向到文件“quiet”，然后执行带有参数“which”和“bash”的“run”函数。您的函数发送到标准输出的任何内容都会自然地进入“安静”文件。

您的脚本还有另一个问题。当您将命令存储在变量 ( `cmd="$@"`) 中时，它会丢失参数之间的中断。例如，您无法判断该命令是`run touch "foo bar"`还是`run touch "foo" "bar"`-- 在任何一种情况下，$cmd 都设置为“touch foo bar”。这对于打印命令可能没问题，但是由于您以这种形式执行它，因此可能会引起麻烦。要解决此问题，请避免将其存储在变量中，或者将其存储为数组（`cmd=("$@")`; 然后将其执行为`"${cmd[@]}"`）。

有几种方法可以解决输出重定向问题。您可以将输出发送到 stderr 而不是 stdout：

```
run ()
{
  if [ -z "$TESTMODE" ]; then
    "$@"
  else
    echo "### RUN: '$*'" >&2
  fi
} 
```

...但这有一些问题：它仍然执行重定向而不是打印它（`run which bash >quiet`将创建一个名为“quiet”的空文件，然后打印“### RUN: 'which bash'”）。

此外，如果 stderr 已被重定向，它将打印到那个而不是终端。这可能是好是坏，取决于您的意图。另一种可能性是直接发送到终端`echo "### RUN: '$*'" >/dev/tty`。这里可能存在的问题：如果没有 tty（例如在 cron 作业中），它将失败。

最后说明：在`echo`命令中，我使用`$*`了代替，`$@`因为我希望将整个命令视为带有空格而不是一系列字符串的单个字符串。这使得打印输出模棱两可（例如`run touch "foo bar"`与`run touch "foo" "bar"`-- 两者都会 print `### RUN: 'touch foo bar'`），但这并不像正确执行命令那么重要。如果你想要明确的日志记录，你必须做一些更复杂的事情，比如：

```
echo "### RUN:" >&2
printf " %q" "$@" >&2
echo >&2 
```

printf 的`%q`格式将为命令及其参数使用明确的（和 shell 可执行的）格式。

# python - 尝试通过 Python API 上传 YouTube 会出现“此操作所需的开发人员密钥”错误

> ID：14351016
> 
> 赞同：0
> 
> 时间：2013-01-16T03:41:08.240
> 
> 标签：python, youtube, gdata

我正在尝试使用与特定用户的凭据配对获得的开发人员密钥将视频上传到 YouTube。在我看来，我的 YoutubeService 对象应该具有正确的开发人员凭据，但服务器返回 403：此操作所需的开发人员密钥。

```
import gdata
import gdata.youtube
import gdata.youtube.service
client_id = 'dummy-client'
developer_key = 'xxxxxxx......'
youtube_user = 'sampleuser@gmail.com'
youtube_password = 'passwordgoeshere'
yt_service = gdata.youtube.service.YouTubeService(client_id, developer_key)
yt_service.ssl = True
yt_service.developer_id = developer_key
yt_service.client_id = client_id
yt_service.email = youtube_user
yt_service.password = youtube_password
yt_service.source = client_id
yt_service.ProgrammaticLogin() #Successfully login with the developer key and the user's credentials

my_media_group = gdata.media.Group(
    title=gdata.media.Title(text='video.avi'),
    description=gdata.media.Description(description_type='plain', text='My Video'),
    keywords=gdata.media.Keywords(text=''),
    category=[gdata.media.Category(
    text='Autos',
    scheme='http://gdata.youtube.com/schemas/2007/categories.cat', label='Autos')],
    player=None,
    private=gdata.media.Private()
)
video_entry = gdata.youtube.YouTubeVideoEntry(media=my_media_group)
video_file_location = '/path/to/video.avi'

#Use the supposedly authenticated and developer_id associated YoutubeService object to upload the video
new_entry = yt_service.InsertVideoEntry(video_entry, video_file_location)

#Receive the following error:
#
#Traceback (most recent call last):
#  File "<stdin>", line 1, in <module>
#  File "/usr/lib/python2.7/dist-packages/gdata/youtube/service.py", line 661, in InsertVideoEntry
#    raise YouTubeError(e.args[0])
#gdata.youtube.service.YouTubeError: {'status': 403, 'body': 'Developer key required     for this operation', 'reason': 'Forbidden'} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T16:07:23.667

您的开发者 ID 和开发者密钥是不同的东西。您需要将您的密钥（与您的帐户相关联，而不是与特定的注册应用程序相关联）放入 yt_service.developer_key

# windows-7 - 无法从 py2exe 或 pyinstaller 创建功能性 .exe

> ID：14351017
> 
> 赞同：1
> 
> 时间：2013-01-16T03:41:18.413
> 
> 标签：windows-7, python-2.7, py2exe, pyinstaller

我正在尝试将 python 脚本打包到 exe 中。python 脚本本身运行良好，但我没有使用 py2exe 或 pyinstaller。两个程序都完成并给了我一个 .exe，但它并没有成功执行该程序，它只是拉出一个命令提示符，太快而无法阅读，而不是 GUI。几个星期以来，我一直在谷歌上搜索和挠头，我被难住了。Py2exe 以关于二进制依赖的可怕警告结束：

```
***binary dependencie ***
Your executable(s) also depend on these dlls which are not included,
you may or may not need to distribute them.
Make sure you have the license if you distribute any of them, and
make sure you don't distribute files belonging to the operating system.

fftpack_lite.pyd - C:\Users\user\Desktop\Python\lib\site-packages\num
fftpack_lite.pyd
OLEAUT32.dll - C:\Windows\system32\OLEAUT32.dll
USER32.dll - C:\Windows\system32\USER32.dll
IMM32.dll - C:\Windows\system32\IMM32.dll
SHELL32.dll - C:\Windows\system32\SHELL32.dll
ole32.dll - C:\Windows\system32\ole32.dll
RPCRT4.dll - C:\Windows\system32\RPCRT4.dll
COMDLG32.dll - C:\Windows\system32\COMDLG32.dll
ADVAPI32.dll - C:\Windows\system32\ADVAPI32.dll
msvcrt.dll - C:\Windows\system32\msvcrt.dll
WS2_32.dll - C:\Windows\system32\WS2_32.dll
WINSPOOL.DRV - C:\Windows\system32\WINSPOOL.DRV
GDI32.dll - C:\Windows\system32\GDI32.dll
VERSION.dll - C:\Windows\system32\VERSION.dll
KERNEL32.dll - C:\Windows\system32\KERNEL32.dll
mfc90.dll - C:\Users\user\Desktop\Python\lib\site-packages\Pythonwin\ll
COMCTL32.dll - C:\Windows\system32\COMCTL32.dll
SETUPAPI.dll - C:\Windows\system32\SETUPAPI.dll
KERNELBASE.dll - C:\Windows\system32\KERNELBASE.dll
ntdll.dll - C:\Windows\system32\ntdll.dll* 
```

假设如果我将这些文件复制到 dist 文件夹中，.exe 将正常运行是否安全？如果我打算分发包裹，我可以合法地这样做吗？为什么 Pyinstaller 给了我类似的最终结果？Pyinstaller 输出：

```
C:\Users\user\Desktop\pyinstaller-2.0>python pyinstaller.py exe.py 
13 INFO: wrote C:\Users\user\Desktop\pyinstaller-2.0\exe\exe.spec 26 INFO: Testing for 
ability to set icons, version resources... 52 INFO: ... resource update available 55 
INFO: UPX is not available. 1003 WARNING: library python%s%s required via ctypes not 
found 1046 INFO: checking Analysis 1046 INFO: building Analysis because out00-
Analysis.toc non existent 1046 INFO: running Analysis out00-Analysis.toc 1046 INFO: 
Adding Microsoft.VC90.CRT to dependent assemblies of final executable
1091 INFO: Searching for assembly x86_Microsoft.VC90.CRT_1fc8b3b9a1e18e3b_9.0.21 
022.8_none ... 1092 INFO: Found manifest C:\Windows\WinSxS\Manifests
\x86_microsoft.vc90.crt_1fc 8b3b9a1e18e3b_9.0.21022.8_none_bcb86ed6ac711f91.manifest 
1092 INFO: Searching for file msvcr90.dll 1093 INFO: Found file C:\Windows\WinSxS
\x86_microsoft.vc90.crt_1fc8b3b9a1e18e3b_ 
9.0.21022.8_none_bcb86ed6ac711f91\msvcr90.dll 1093 INFO: Searching for file 
msvcp90.dll 1093 INFO: Found file C:\Windows\WinSxS
\x86_microsoft.vc90.crt_1fc8b3b9a1e18e3b_ 
9.0.21022.8_none_bcb86ed6ac711f91\msvcp90.dll 1093 INFO: Searching for file 
msvcm90.dll 1093 INFO: Found file C:\Windows\WinSxS
\x86_microsoft.vc90.crt_1fc8b3b9a1e18e3b_ 
9.0.21022.8_none_bcb86ed6ac711f91\msvcm90.dll     1154 INFO: Analyzing C:\Users
\user\Desktop\pyinstaller-2.0\support\_pyi_bootstr ap.py 2126 WARNING: library 
python%s%s required via ctypes not found 2154 INFO: Analyzing C:\Users\user\Desktop
\pyinstaller-2.0\PyInstaller?\loader\a rchive.py 2253 INFO: Analyzing C:\Users
\user\Desktop\pyinstaller-2.0\PyInstaller?\loader\c archive.py 2351 INFO: Analyzing 
C:\Users\user\Desktop\pyinstaller-2.0\PyInstaller?\loader\i u.py 2368 INFO: Analyzing 
exe.py 2503 INFO: checking Tree 2504 INFO: building because out00-Tree.toc missing or 
bad 2504 INFO: building Tree out00-Tree.toc 2632 INFO: checking Tree 2632 INFO: 
building because out01-Tree.toc missing or bad 2632 INFO: building Tree out01-Tree.toc 
4046 WARNING: pythoncom is changing its name to pythoncom27 4060 WARNING: pywintypes 
is changing its name to pywintypes27 5055 INFO: Hidden import 'encodings' has been 
found otherwise 5055 INFO: Looking for run-time hooks 5056 INFO: Analyzing rthook 
C:\Users\user\Desktop\pyinstaller-2.0\support/rthoo ks/pyi_rth_Image.py 5065 INFO: 
Analyzing rthook C:\Users\user\Desktop\pyinstaller-2.0\support/rthoo 
ks/pyi_rth_PIL_Image.py 5072 INFO: Analyzing rthook C:\Users\user\Desktop\pyinstaller-
2.0\support/rthoo ks/pyi_rth_Tkinter.py 5155 INFO: Analyzing rthook C:\Users
\user\Desktop\pyinstaller-2.0\support/rthoo ks/pyi_rth_encodings.py 5237 INFO: 
Analyzing rthook C:\Users\user\Desktop\pyinstaller-2.0\support/rthoo 
ks/pyi_rth_versioneddll.py 5328 INFO: Analyzing rthook C:\Users\user\Desktop
\pyinstaller-2.0\support/rthoo ks/pyi_rth_win32comgenpy.py 5424 INFO: Analyzing rthook 
C:\Users\user\Desktop\pyinstaller-2.0\support/rthoo ks/pyi_rth_versioneddll.py 6231 
INFO: Adding Microsoft.VC90.MFC to dependent assemblies of final executable
6274 INFO: Searching for assembly x86_Microsoft.VC90.MFC_1fc8b3b9a1e18e3b_9.0.21 
022.8_none ... 6274 INFO: Found manifest C:\Windows\WinSxS\Manifests
\x86_microsoft.vc90.mfc_1fc 8b3b9a1e18e3b_9.0.21022.8_none_b81d038aaf540e86.manifest 
6276 INFO: Searching for file mfc90.dll 6276 INFO: Found file C:\Windows\WinSxS
\x86_microsoft.vc90.mfc_1fc8b3b9a1e18e3b_ 9.0.21022.8_none_b81d038aaf540e86\mfc90.dll 
6276 INFO: Searching for file mfc90u.dll 6277 INFO: Found file C:\Windows\WinSxS
\x86_microsoft.vc90.mfc_1fc8b3b9a1e18e3b_ 9.0.21022.8_none_b81d038aaf540e86\mfc90u.dll 
6277 INFO: Searching for file mfcm90.dll 6277 INFO: Found file C:\Windows\WinSxS
\x86_microsoft.vc90.mfc_1fc8b3b9a1e18e3b_ 9.0.21022.8_none_b81d038aaf540e86\mfcm90.dll 
6277 INFO: Searching for file mfcm90u.dll 6279 INFO: Found file C:\Windows\WinSxS
\x86_microsoft.vc90.mfc_1fc8b3b9a1e18e3b_ 
9.0.21022.8_none_b81d038aaf540e86\mfcm90u.dll 6910 INFO: Adding 
Microsoft.Windows.Common-Controls to dependent assemblies of f inal executable 7081 
INFO: Warnings written to C:\Users\user\Desktop\pyinstaller-2.0\exe\build\ 
pyi.win32\exe\warnexe.txt 7092 INFO: checking PYZ 7092 INFO: rebuilding out00-PYZ.toc 
because out00-PYZ.pyz is missing 7092 INFO: building PYZ out00-PYZ.toc 9139 INFO: 
checking PKG 9139 INFO: rebuilding out00-PKG.toc because out00-PKG.pkg is missing 9141 
INFO: building PKG out00-PKG.pkg 9151 INFO: checking EXE 9151 INFO: rebuilding out00-
EXE.toc because exe.exe missing 9151 INFO: building EXE from out00-EXE.toc 9152 INFO: 
Appending archive to EXE C:\Users\user\Desktop\pyinstaller-2.0\exe\b uild\pyi.win32
\exe\exe.exe 9184 INFO: checking COLLECT 9184 INFO: building COLLECT out00-
COLLECT.toc* 
```

感谢您的任何指导或建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-27T00:54:19.197

尝试开发版本的 pyinstaller。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T02:31:20.013

长话短说，当您不尝试打包 scipy 时，cxFreeze 就可以工作！

# powershell - PowerShell：最后执行结果是否有自动变量？

> ID：14351018
> 
> 赞同：54
> 
> 时间：2013-01-16T03:41:28.827
> 
> 标签：powershell

我正在寻找可与 Python 交互式 shell 的“_”变量相媲美的功能。在 PowerShell 我想要这样的东西：

```
> Get-Something # this returns an object and display it to the output.
# Now I want to assign that object to some variable
> $anObj = ??? 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-01-16T04:02:16.187

不，没有这样的自动变量。

你所要做的：

```
$output = Get-Something
$output
$anObj = $output 
```

获得行为

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2018-09-24T18:25:57.363

如前所述，没有对此的*内置*支持，但这是一个**简单但次优的 PSv3+*自定义*解决方案**：

笔记：

*   有关适当但重要的解决方案，请参阅[BartekB 的有用答案](https://stackoverflow.com/a/14354043/45375)。

*   [GitHub 功能请求 #7853](https://github.com/PowerShell/PowerShell/issues/7853)要求将此功能构建到未来的 PowerShell Core 版本中（撰写本文时的当前版本是 PowerShell (Core) 7.2）。

* * *

将以下内容添加到您的`$PROFILE`文件中：

```
# Store previous command's output in $__
$PSDefaultParameterValues['Out-Default:OutVariable'] = '__' 
```

^(命名变量的名称`$__`（例如本例中的（2 个下划线））由您决定，但**请注意名称冲突，尤其是与`$_`**在许多上下文中表示手头输入对象的*自动*变量的名称冲突。)

**这将**`$__`******通过 PowerShell 全局预设参数默认值的能力来捕获**交互式会话中****最近执行的*****PowerShell*****命令 [产生终端输出]的*****终端绑定***[`Get-Help about_Parameters_Default_Values`](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_parameters_default_values)输出 - 请参阅.**

 **`-OutVariable`是一个[通用参数](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_commonparameters)，旨在将 cmdlet/高级函数的输出对象收集到变量中，并且上述定义将此参数*隐式*应用于所有`Out-Default`调用，每当 PowerShell 向终端输出某些内容时，都会在后台调用该参数 - 但是，请注意下面提到的例外情况。

**注意事项**：

*   **如果需要，请使用`$saved = $__.Clone()`保存捕获的输出以供以后使用**，因为它`$__`会在每个命令上重新分配（当然，如果您提前知道要保留命令的输出，请使用以开头的分配：）`$saved = <command>`。

    *   请注意，just`$saved = $__`不起作用，*因为*这`$saved`指向与 相同的`[ArrayList]`实例`$__`，该实例将在下一个命令中重新填充。
*   *在以下情况下***不会*****捕获****输出：***

     **   **来自*外部程序***的输出，例如`git`，因为根据设计 PowerShell 将来自外部程序的输出流直接传递到终端（除非它们被重定向或捕获），因此不会调用`Out-Default`. 最简单的解决方法是通过管道传输`Write-Output`（类似于`*>&1`通过 PowerShell 流显式路由的方法不起作用）；例如：

        *   `whoami.exe | Write-Output # $__ is now populated`
    *   ***显式调用格式化 cmdlet*****的命令的输出**- `Format-Custom`、`Format-Hex`、`Format-List`、`Format-Table`或`Format-Wide`.

        *   尝试用 来解决这个问题很诱人`$PSDefaultParameterValues['Format-*:OutVariable'] = '__'`，但不幸的是，这会收集*格式化对象*（指令）而不是 中的*原始数据*，`$__`这是不希望的。*一个不令人满意的解决方法是在不同*的变量中捕获`Format-*`输出，这不仅需要您考虑需要定位哪个变量，而且您仍然只能看到格式化对象而不是数据，而且由于cmdlet 甚至在幕后都涉及如果您没有明确使用它们，那么*没有*调用的命令的输出将被捕获*两次*- 一次作为数据， in ，另一次作为格式化对象，在另一个变量中。*`Format-*` *`Format-*`*`$__`**** 
****   由于[设计怪癖](https://github.com/PowerShell/PowerShell/issues/3154)，**`$__` *总是*包含一个*数组列表***（类型`[System.Collections.ArrayList]`），即使前面的命令只输出一个*对象*。如有疑问，请使用`$($__)`(或`$__[0]`) 来获取单个输出对象。

    *   注意产生非常大的输出集的命令，因为`$__`会将它们收集*在内存中*。

    *   `$__`只会捕获输出到*终端*的对象- 就像`_`在 Python 中一样；一个不产生输出的命令或`$null`/ 一个 s 的数组会保留`$null`任何先前的`$__`值不变。*** 

 *** * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-16T06:45:35.013

您还可以使用 OutVariable 参数打印命令的结果并捕获输出对象，然后使用 $anObj 显示变量内容。

```
Get-Something -OutVariable anObj 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-01-16T08:26:15.223

最后一个需要大部分工作的选项，但 IMO 为您提供了您所要求的：创建将覆盖 Out-Default 的代理（如果您不使用其他内容，则始终在管道末尾隐式调用该代理）。

Jeffrey Snover 在一次 PowerShell Deep Dives（我认为这是第一次）中对它进行了介绍 - 你可以在[Dmitry Sotnikov 博客](http://dmitrysotnikov.files.wordpress.com/2011/09/scripts-tec-2011-jeffrey-snover-proxy-functions.pdf)上找到他使用的脚本（包括上面提到的默认） 。您还可以观看其中的[视频](http://www.youtube.com/watch?v=JWgPYWf1ZaA)以了解整个概念。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-01-16T04:00:40.713

不完全是。**有 $_ 自动值，其中包含管道**中的当前对象。

管道是将结果从一个 cmdlet 传递到下一个的常用方法，并且 cmdlet 被设置为接受来自管道的参数或管道中对象的属性，从而使“最后结果”变量的使用无关紧要。

仍然有些情况确实需要对“管道”对象的特定引用，对于那些有 $_ 自动值。

下面是它的用法示例：[使用 Where-Object Cmdlet](http://technet.microsoft.com/en-us/library/ee177028.aspx)，这里是 powershell 的自动变量列表：[第 4 章。PowerShell 自动变量](http://my.safaribooksonline.com/book/operating-systems-and-server-administration/microsoft-windows-powershell/9780596521783/powershell-automatic-variables/powershell_automatic_variables)

powershell 中的脚本编写需要与 Python 中的编程不同的风格（就像 Python 需要与 C++ 不同的风格一样。）

Powershell 的构建使得管道被广泛使用，如果您想将管道分解为更程序化的逐步结构，您需要将结果保存在命名变量中，而不是自动变量中。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-11-07T16:47:54.707

用“r”（Invoke-History 的别名）调用最后一个命令并将其包裹在括号（）中以首先执行它怎么样？

是的，这会重新运行最后一个命令，但在我的用例中，这是迄今为止最精简的解决方案，尤其是当我没有意识到我首先需要最后一个命令输出的时候。

它还保持对象结构完整。

```
PS C:\Users\user> Get-NetAdapter -InterfaceIndex 3 | Where {$_.State -match "2"}

Name                      InterfaceDescription                    ifIndex Status       MacAddress             LinkSpeed
----                      --------------------                    ------- ------       ----------             ---------
Ethernet                  Intel(R) Ethernet Connection I217-LM          3 Up           XX-XX-XX-XX-XX-XX       100 Mbps

PS C:\Users\user> (r) |where {$_.LinkSpeed -eq "100 Mbps"}
Get-NetAdapter -InterfaceIndex 3 | Where {$_.State -match "2"}

Name                      InterfaceDescription                    ifIndex Status       MacAddress             LinkSpeed
----                      --------------------                    ------- ------       ----------             ---------
Ethernet                  Intel(R) Ethernet Connection I217-LM          3 Up           XX-XX-XX-XX-XX-XX       100 Mbps

PS C:\Users\user> (r).MacAddress
Get-NetAdapter -InterfaceIndex 3 | Where {$_.State -match "2"}
XX-XX-XX-XX-XX-XX 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-08-08T15:26:50.563

对于我的特定用例，我从 PowerShell 运行批处理文件，我想实时打印该批处理文件的输出并将输出保存到变量中。我可以通过将呼叫操作员的输出传送到`Tee-Object`：

```
$args = @('-r', '-a');
& "C:\myFile.bat" $args | Tee-Object -Variable output;
$output | Set-Clipboard; 
```

第一个命令为批处理文件设置我的参数。第二个命令使用带有我的参数的调用运算符运行批处理文件，并将输出通过管道传递给`Tee-Object`命令，该命令实时打印调用运算符的输出，但还将所有信息保存到一个名为*output*的新变量中。最后一个命令只是将 的内容复制`$output`到剪贴板。

`Tee-Object`还允许将输出保存到文件（Unicode 编码），如果我需要保存到文件*和*变量（除了打印到控制台），我可以将多个调用链接到`Tee-Object`一个管道中。有关更多信息，请参阅此链接：

[https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/tee-object](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/tee-object)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-08-11T14:54:34.973

这是来自 Windows Powershell in Action。在你的 $profile 中获取它，它使 $last 包含最后一个命令的输出。它还将通过在 la zsh 中键入目录名称来更改目录，或者通过键入网站的 url 在浏览器中访问网站。它创建了一个 Out-Default 函数，该函数覆盖 Out-Default cmdlet 并调用它。我添加了“start-process $__command”行，所以去一个网站可以在 osx 中工作。

这是相当具有侵略性的。后来我出于某种原因在我的 $profile 中禁用了它。

```
#
# Wrapping an exiting command with a function that uses
# steppable pipelines to "remote-control" the wrapped command.

function Out-Default
{
  [CmdletBinding(ConfirmImpact="Medium")]
  param(
    [Parameter(ValueFromPipeline=$true)] 
    [System.Management.Automation.PSObject] $InputObject
  )

  begin {
    $wrappedCmdlet = $ExecutionContext.InvokeCommand.GetCmdlet(
      "Out-Default")
    $sb = { & $wrappedCmdlet @PSBoundParameters }
    $__sp = $sb.GetSteppablePipeline()
    $__sp.Begin($pscmdlet)
  }

  process {
    $do_process = $true
    if ($_ -is [System.Management.Automation.ErrorRecord]) {
      if ($_.Exception -is 
      [System.Management.Automation.CommandNotFoundException]) {
        $__command = $_.Exception.CommandName
        if (test-path -path $__command -pathtype container) {
          set-location $__command
          $do_process = $false
        }
        elseif ($__command -match '^http://|\.(com|org|net|edu)$') {
          if ($matches[0] -ne "http://") {$__command = "HTTP://" + 
            $__command }
          # [diagnostics.process]::Start($__command)
          start-process $__command
          $do_process = $false
        } 
      } 
    }
    if ($do_process) {
      $global:LAST = $_;
      $__sp.Process($_)
    }  
  }

  end {
    $__sp.End()
  }

} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-01-28T21:00:41.783

一种对我有用的方法是将命令的输出`Select-Object`作为传递来处理。例如，我有一个控制台 EXE，它输出详细输出到`stderr`和有意义的输出到`stdout`，我只想捕获最后一行。

```
$UtilityPath = ""

(UpdateUtility.exe $ArgList 2>&1) | % {
    If ($_ -Is [System.Management.Automation.ErrorRecord]) {
        $_.Exception.Message
    }
    Else {
        $_
        $UtilityPath = $_
    }
} 
```

调用此脚本的方式，在 PowerShell 的`Error`输出流上输出被认为是一个硬错误，这与 PowerShell 获取外部应用程序的`stderr`输出并将其转换为`Error`输出的方式不符。这种包装输出的方法使我能够控制它如何通过，以及捕获`stdout`我想要的行。在我看来，这将是一种相当灵活的方法，可以让您拦截输出并在输出通过时对其执行任何您想做的事情。例如：

```
$CommandOutput = ""

SomeOtherCommand | % {
    $CommandOutput += "$_`r`n"
    $_
} 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2016-09-14T13:43:29.830

使用模块 PowerShellCookbook 并将对 Add-ObjectCollector 的调用添加到您的启动脚本

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2021-10-04T11:07:40.073

您可以尝试“ **(Get-History)[-1].CommandLine** ”。****

# ruby-on-rails-3 - has_many-relationship 列中有许多模型记录

> ID：14351020
> 
> 赞同：0
> 
> 时间：2013-01-16T03:41:55.977
> 
> 标签：ruby-on-rails-3, has-many, belongs-to

我有一个`Brand`模型和一个`Price`模型，因此：

**品牌.rb**

```
class Brand < ActiveRecord::Base
  attr_accessible :name, :a4_single, :a4_double, :a3_double, :two_a3_double
  has_many :prices, :dependent => :destroy
end 
```

**价格.rb**

```
class Price < Brand
  attr_accessible :type, :quantity, :price, :brand_id
  belongs_to :brand
end 
```

我希望能够在**每个**产品列中插入**多** `Price`条记录，例如 10条记录 in 、8 条 in 、2条 in和 8 条 in 。**`Price``:a4_single``:a4_double``:a3_double``:two_a3_double`**

 **我只是猜测`has_many`上面定义的关系是正确的，我真的不知道如何从这里着手。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T05:25:32.363

你不应该再继续下去了。

做这样的事情

```
class Brand < ActiveRecord::Base
  has_many :brand_prices
  has_many :prices, :through => :brand_prices
  attr_accessible :name
end

class Price < ActiveRecord::Base
  has_many :brand_prices
  has_many :brands, :through => :brand_prices
  attr_accessible :price, :quantity, :type
end

class BrandPrice < ActiveRecord::Base
  belongs_to :brand
  belongs_to :price
end 
```**

# php - 自mysql时间戳PHP以来的时间

> ID：14351022
> 
> 赞同：4
> 
> 时间：2013-01-16T03:42:18.907
> 
> 标签：php, mysql, timestamp

我正在寻找一种简单的方法来计算自 TIMESTAMP 进入 mysql 数据库以来的时间。我想用php。

时间戳是 unix 格式 -`2013-01-15 12:46:11`

如果是目前`2013-01-15 19:46:11`，计算两者之间差异的最简洁的编码是什么？

谢谢你的帮助！杰森

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T03:46:25.777

```
 echo ((strtotime("2013-01-15 19:46:11")-strtotime("2013-01-15 12:46:11"))/3600); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T03:47:54.360

你想要`DateInterval's`格式方法：`$date->diff`

```
$date = new \DateTime();
$date->setTimestamp($timestamp);
$interval = $date->diff(new \DateTime('now'));
echo $interval->format('%y years, %m months, %d days, %h hours and %i minutes ago'); 
```

将现在更改为您的日期。

[PHP 自函数以来的时间？](https://stackoverflow.com/questions/5010016/php-time-since-function)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-16T03:49:40.500

尝试以下操作：

```
<?php 
    echo(time()-strtotime("2013-01-15 19:46:11"));
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T03:47:41.213

看看下面一些有用的链接。

[https://gist.github.com/822283](https://gist.github.com/822283)

[如何从php中的两个时间戳计算确切的小时数？](https://stackoverflow.com/questions/6470411/how-to-calculate-exact-hours-from-two-timestamp-in-php)

[http://www.if-not-true-then-false.com/2010/php-calculate-real-differences-between-two-dates-or-timestamps/](http://www.if-not-true-then-false.com/2010/php-calculate-real-differences-between-two-dates-or-timestamps/)

我推荐第一个链接**（GITHUB）**

# php - 如何在 PHP OOP 中大声朗读“->”或“::”符号？

> ID：14351024
> 
> 赞同：14
> 
> 时间：2013-01-16T03:42:53.150
> 
> 标签：php, oop

我们经常在 PHP 中使用 OOP `$class_object->class_procedure`。`self::class_procedure`在大声朗读您的代码时，您如何读出这些约定？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-16T03:45:30.400

`->`是[对象运算符](http://php.net/manual/en/language.oop5.properties.php)。通常在对话中称为*箭头。*如果我正在阅读代码，我可能会说：

> 类对象*箭头*类方法

`::`是[静态解析算子](http://php.net/manual/en/language.oop5.paamayim-nekudotayim.php)。我在谈话中也没有阅读。文档说*双冒号*。我可能会说：

> 类*冒号冒号*静态方法

**注意：**无论您如何命名语法，大声阅读代码可能会很尴尬。此外，这在很大程度上取决于您的听众。我正在分享我听到的、在书中看到的或在文档中找到的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-16T03:48:10.897

您可以使用他们的[令牌名称](http://php.net/manual/en/tokens.php)：

*   `->`（对象操作员又名箭头）
*   `::`（Paamayim Nekudotayim OR 双冒号 OR 静态对象运算符）

或者只是说：

> [静态] 对象 Y 的方法 X

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T03:45:59.450

类对象的类过程

自我上课流程

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-16T03:47:13.067

对于静态版本（`self::class_procedure`），保持简单..“双冒号”

# ruby - 当在另一个方法中定义 lambda 时，lambda 中的“Regexp.last_match”调用为“nil”

> ID：14351036
> 
> 赞同：-1
> 
> 时间：2013-01-16T03:45:11.510
> 
> 标签：ruby, regex, lambda

我在 a 的 replace 参数中使用 lambda `gsub!`。当 lambda 在不同的方法中定义`Regexp.last_match`或`$~`为空时，与 lambda 在调用时评估表达式的预期行为背道而驰。如果我运行这段代码，我会得到一个错误，但如果我取消注释转录中的第一行，它就会工作。

```
class Test
  def initialize
    @@replace = lambda { "#{callback('*', Regexp.last_match)}" }
  end

  def transcribe(s)
    #@@replace = lambda { "#{callback('*', Regexp.last_match)}" }
    s.gsub!( /(?<l>.?)[aeiou](?<r>.?)/ ) do
      $~[:l] + (@@replace).call + $~[:r]
    end
    s
  end

  def callback( replace, match )
    raise "Error: Match is empty" if match.nil?
    return replace.upcase
  end
end

t = Test.new
puts t.transcribe('example') 
```

谁能告诉我我做错了什么，或者这是一个错误？

我用谷歌搜索了它：[ruby​​ Regexp.last_match lambda](https://www.google.com/search?hl=en&safe=off&tbo=d&spell=1&q=ruby%20Regexp.last_match%20lambda)，在不同的情况下似乎有一个错误`$1`，但我不明白它是否与这个有关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T09:12:46.767

正则表达式全局变量（`Regexp.last_match`只是 $~ 的访问器）根本不是真正的全局变量。从[文档](http://www.ruby-doc.org/core-1.9.3/Regexp.html#method-c-last_match)中`last_match`

> 请注意，last_match 对于进行模式匹配的方法的线程和方法范围是本地的。

因此，当您的 lambda 在不同的方法中定义时，方法范围是不同的，因此它访问自己的未设置的私有 Regexp.last_match。最简单的事情可能是`Regexp.last_match`作为参数传递给你的 lambda

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T05:34:02.477

您可以将匹配作为参数传递给块

```
s.gsub!( /(?<l>.?)[aeiou](?<r>.?)/ ) do |match|
  $~[:l] + (@@replace).call(match) + $~[:r]
end 
```

这应该可以解决您的问题。

一般来说，`$~`除非它与正则表达式在同一行，否则我不会使用魔法。它使代码更具可读性。

# c - C - 澄清 strtok 中的分隔符

> ID：14351038
> 
> 赞同：2
> 
> 时间：2013-01-16T03:45:19.977
> 
> 标签：c, delimiter, strtok

我正在尝试分解一个shell命令，该命令包含管道（|）和用strtok表示为数组中字符的OR符号（||），除了OR命令也可以是两个相邻的管道。具体来说，我需要知道何时 |、;、&& 或 || 出现在命令中。

有没有办法指定一个分隔符在哪里结束，另一个在 strtok 中开始，因为我知道通常分隔符是一个字符长，你只需将它们全部列出，中间没有空格或任何东西。

哦，换行符是有效的分隔符吗？还是 strtok 只做空格？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T03:52:43.843

从你的最后一个问题开始：是的，`strtok`可以使用换行符作为分隔符没有任何问题。

不幸的是，您的第一个问题的答案几乎没有那么积极。`strtok`将所有分隔符视为相等，并且不区分单个分隔符和任意数量的连续分隔符。换句话说，如果您将`|&;`其作为分隔符，它将以完全相同的方式处理`|||||||||`或`&&&`或全部。`&|&|;`

我会走得更远一点：我会冒险并陈述一个事实，即`strtok`根本不适合将 shell 命令分解成组成部分——我很确定没有办法将它用于这项工作将产生有用的结果。

特别是，您没有任何*仅用*作分隔符的东西。出于您的目的，`&`、`|`和`||`是它们自己的标记。在提供给 shell 的字符串中，您不一定有*任何*符合`strtok`“认为”它们的分隔符的条件。

`strtok`面向由分隔符分隔的标记，除了分隔符之外*什么都不*是。在`strtok`读取标记时，它们之间的分隔符被完全忽略（并且，就此而言，被销毁）。对于 shell，类似这样的字符串`a|b`实际上是三个标记——你需要`a`、 the`|`和`b`the——它们之间没有任何东西`strtok`可以安全地覆盖和/或忽略——但这是`strtok`工作方式的要求。为了给您提供第一个`a`，它会用 覆盖下一个字符（`|`在本例中为 ）`'\0'`。然后它无法恢复该管道来告诉您下一个令牌应该是什么。

我认为您可能需要一个贪婪的标记器 - 即构建最长的可以作为标记的字符串，并在遇到不能成为当前标记一部分的字符时停止。当您要求下一个标记时，它从前一个标记结束后的第一个字符开始，而不会（必然）跳过/忽略任何内容（当然，如果它遇到未引用的空格之类的东西不知何故，它可能会跳过它）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T03:50:49.770

`strtok()`是一个基本的、通用的解析函数。对于更高级的解析，我不推荐使用它。

例如，在“|”的情况下，您确实需要检查下一个字符以确定您是否找到了“|” 或“||”。

我已经完成了大量的这种性质的解析，包括编写一个小型语言解释器。如果你把它分解成更小的任务，这并不难。但我的建议是在这种情况下编写自己的解析例程。

而且，是的，换行符是有效的分隔符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T03:53:05.227

出于您的目的，`strtok()`不是正确使用的工具；它会破坏分隔符，因此如果有人键入，您无法分辨令牌末尾的内容`ls|wc`。它可能是一个管道、一个分号和一个 & 符号，或者一个空格。此外，它将多个相邻分隔符视为单个分隔符的一部分。

看`strspn()`和`strcspn()`; 两者都在标准 C 中，并且是`strtok()`.

`strtok()`很乐意使用换行符作为分隔符；事实上，除此之外的任何字符都`'\0'`可以用作分隔符之一。

使用 非常谨慎还有其他原因`strtok()`，例如线程安全以及在库代码中使用它是非常不明智的事实。

# sed - sed 在模式之间打印第一个匹配结果

> ID：14351039
> 
> 赞同：-1
> 
> 时间：2013-01-16T03:45:25.003
> 
> 标签：sed

像这样的文件：

> 文件 /home/user/
> 
> int yl_init（无效）；
> 
> 文件 /home/user/
> 
> int yl2_init(void);

我想使用`sed -n '/File/,/;/p'`文件，但它表明

> 文件 /home/user/
> 
> int yl_init（无效）；
> 
> 文件 /home/user/
> 
> int yl2_init(void);

我只想获得第一个匹配结果，例如：

> 文件 /home/user/
> 
> int yl_init（无效）；

我只想要 sed 。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T06:44:34.523

这可能对你有用（GNU sed）；

```
sed '/File/,/;/!d;/;/q' file 
```

*   `/File/,/;/!d`删除所有不在 and 之间`File`的行`;`
*   `/;/q`遇到包含的行时退出`;`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T06:15:03.563

当第二个模式匹配时，您可以使用`q`命令使 sed 退出：

```
sed -n '/File/,$p;/;/q' 
```

# java - 在网络事件上运行 Java 程序

> ID：14351041
> 
> 赞同：-2
> 
> 时间：2013-01-16T03:45:39.963
> 
> 标签：java, windows, network-programming, lan

从长远来看，我想做的是在以太网电缆连接到计算机时更改一些 LAN 属性。

每次检测到 LAN 网络时，我都想运行我的 Java 程序。我发现了一些关于如何在 中执行此操作的问题`C++`，但具体而言与 Java 无关。这是否只涉及我分发最终应用程序的方式？例如，我可以使用`Jar2Exe Wizard`将我的 Java 程序打包为 Windows 服务，然后弄清楚如何在启动时运行它。但是有没有办法在 Java 程序本身中做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T04:07:49.220

不知道你的具体需求是什么，但你可以试试这个。这显示了如何从 java 内部运行 windows 命令，因此您不必创建外部批处理文件。

[如何使用 Java 执行 Windows 命令 - 更改网络设置](https://stackoverflow.com/questions/7112259/how-to-execute-windows-commands-using-java-change-network-settings)

另请查看有关在 java 中检索网络名称的答案。那么你可以将两者结合起来！

[如何在java中获取wifi网络接口名称](https://stackoverflow.com/questions/4507628/how-to-get-the-wifi-network-interface-name-in-java)

# python - django缓存功能是否会导致模板

> ID：14351045
> 
> 赞同：1
> 
> 时间：2013-01-16T03:46:09.933
> 
> 标签：python, django, templates, caching

我有`models.py`：

```
class Team(models.Model):
    x = models.IntegerField()
    y = models.IntegerField()

    a = models.IntegerField()
    b = models.IntegerField()

    def get_stat(self):
        return {
            'xy': self.x + self.y,
            'ab': self.a + self.b
        }

    stat = property(get_stat) 
```

在`team.html`我有：

```
xy stat: {{ team.stat.xy }}
ab stat: {{ team.stat.ab }} 
```

问题是：“django`get_stat`每次我调用时都会执行函数`stat`还是缓存结果？”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T04:05:10.470

不，`property`不缓存任何结果。

如果您希望将其缓存以进行大量重复访问，则典型的设计模式是：

```
def get_stat(self):
    if not hasattr(self, '__get_stat'):
         self.__get_stat =  {
            'xy': self.x + self.y,
            'ab': self.a + self.b
         }
    return self.__get_stat 
```

当然，如果正在做一些奇怪的事情，例如处理已就地修改但未提交到数据库的实例，这将不起作用。我相信 99% 的使用涉及**DB->Object->Action**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T09:08:57.923

这不是一个具体的答案，因为您已经了解到它没有被缓存，而是一些一般性的建议。通常，确定此类内容是否被缓存（或调用一些随机代码）的方法是在其中添加一些日志记录或调试语句。

```
def get_stat(self):
    # logging or debugging statement here, e.g. import ipdb; ipdb.set_trace()
    # for ipdb, you need to pip install ipdb
    return {
        'xy': self.x + self.y,
        'ab': self.a + self.b
    } 
```

您还可以在 django 自己的代码中使用它来查看提供页面时所采用的执行路径。

# python - Django 可选 url 参数

> ID：14351048
> 
> 赞同：200
> 
> 时间：2013-01-16T03:46:35.593
> 
> 标签：python, django, django-views, django-urls

我有一个这样的 Django URL：

```
url(
    r'^project_config/(?P<product>\w+)/(?P<project_id>\w+)/$',
    'tool.views.ProjectConfig',
    name='project_config'
), 
```

**视图.py：**

```
def ProjectConfig(request, product, project_id=None, template_name='project.html'):
    ...
    # do stuff 
```

问题是我希望`project_id`参数是可选的。

我想要`/project_config/`并且`/project_config/12345abdce/`是同样有效的 URL 模式，这样**如果** `project_id`通过了，**那么**我可以使用它。

就目前而言，当我在没有`project_id`参数的情况下访问 URL 时得到 404。

* * *

## 回答 #1

> 赞同：441
> 
> 时间：2013-01-16T04:03:10.923

有几种方法。

一种是在正则表达式中使用非捕获组： `(?:/(?P<title>[a-zA-Z]+)/)?`
[Making a Regex Django URL Token Optional](https://stackoverflow.com/questions/2325433/making-a-regex-django-url-token-optional)

另一种更容易遵循的方法是拥有多个符合您需求的规则，所有规则都指向同一个视图。

```
urlpatterns = patterns('',
    url(r'^project_config/$', views.foo),
    url(r'^project_config/(?P<product>\w+)/$', views.foo),
    url(r'^project_config/(?P<product>\w+)/(?P<project_id>\w+)/$', views.foo),
) 
```

请记住，在您的视图中，您还需要为可选的 URL 参数设置默认值，否则您会收到错误消息：

```
def foo(request, optional_parameter=''):
    # Your code goes here 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2019-01-24T14:13:38.413

**Django > 2.0 版本**：

[该方法与Yuji 'Tomita' Tomita's Answer](https://stackoverflow.com/a/14351174/1622937)中给出的方法基本相同。然而，受影响的是语法：

```
# URLconf
...

urlpatterns = [
    path(
        'project_config/<product>/',
        views.get_product, 
        name='project_config'
    ),
    path(
        'project_config/<product>/<project_id>/',
        views.get_product,
        name='project_config'
    ),
]

# View (in views.py)
def get_product(request, product, project_id='None'):
    # Output the appropriate product
    ... 
```

使用[`path()`](https://docs.djangoproject.com/en/dev/ref/urls/#path)您还可以使用类型为的可选参数[将额外参数传递给视图](https://docs.djangoproject.com/en/dev/topics/http/urls/#passing-extra-options-to-view-functions)。在这种情况下，您的视图不需要属性的默认值：`kwargs``dict``project_id`

```
 ...
    path(
        'project_config/<product>/',
        views.get_product,
        kwargs={'project_id': None},
        name='project_config'
    ),
    ... 
```

*有关如何**在最新的 Django 版本**中完成此操作，请参阅[有关 URL 调度的官方文档](https://docs.djangoproject.com/en/dev/topics/http/urls/#specifying-defaults-for-view-arguments)。*

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2014-03-24T22:51:25.473

**您可以使用嵌套路由**

*姜戈 <1.8*

```
urlpatterns = patterns(''
    url(r'^project_config/', include(patterns('',
        url(r'^$', ProjectConfigView.as_view(), name="project_config")
        url(r'^(?P<product>\w+)$', include(patterns('',
            url(r'^$', ProductView.as_view(), name="product"),
            url(r'^(?P<project_id>\w+)$', ProjectDetailView.as_view(), name="project_detail")
        ))),
    ))),
) 
```

*Django >=1.8*

```
urlpatterns = [
    url(r'^project_config/', include([
        url(r'^$', ProjectConfigView.as_view(), name="project_config")
        url(r'^(?P<product>\w+)$', include([
            url(r'^$', ProductView.as_view(), name="product"),
            url(r'^(?P<project_id>\w+)$', ProjectDetailView.as_view(), name="project_detail")
        ])),
    ])),
] 
```

这要干得多（假设您想将`product`kwarg 重命名为`product_id`，您只需更改第 4 行，它将影响以下 URL。

*为 Django 1.8 及更高版本编辑*

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2014-07-07T12:38:39.627

更简单的是使用：

```
(?P<project_id>\w+|) 
```

“(a|b)”表示 a 或 b，因此在您的情况下，它将是一个或多个单词字符 (\w+) 或什么都没有。

所以它看起来像：

```
url(
    r'^project_config/(?P<product>\w+)/(?P<project_id>\w+|)/$',
    'tool.views.ProjectConfig',
    name='project_config'
), 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2014-02-18T00:51:56.697

以为我会在答案中添加一点。

如果您有多个 URL 定义，则必须分别命名它们。所以你在调用 reverse 时失去了灵活性，因为一个 reverse 会需要一个参数，而另一个不会。

另一种使用正则表达式来容纳可选参数的方法：

```
r'^project_config/(?P<product>\w+)/((?P<project_id>\w+)/)?$' 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-04-03T16:01:46.307

姜戈 = 2.2

```
urlpatterns = [
    re_path(r'^project_config/(?:(?P<product>\w+)/(?:(?P<project_id>\w+)/)/)?$', tool.views.ProjectConfig, name='project_config')
] 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-05-03T17:52:23.303

利用 ？工作得很好，你可以检查[pythex](https://pythex.org/?regex=project_config%2F(%3FP%3Cproduct%3E%5Cw%2B)%3F(%2F(%3FP%3Cproject_id%3E%5Cw%2B%2F)%3F)%3F&test_string=project_config%2F%0Aproject_config%2Fdrink%2F%0Aproject_config%2Fdrink%2F12%2F%0A&ignorecase=0&multiline=0&dotall=0&verbose=0)。记得在视图方法的定义中添加参数 *args 和 **kwargs

```
url('project_config/(?P<product>\w+)?(/(?P<project_id>\w+/)?)?', tool.views.ProjectConfig, name='project_config') 
```

# android - 如何在具有多个项目的大型 ListView 上处理 switch case

> ID：14351049
> 
> 赞同：0
> 
> 时间：2013-01-16T03:46:40.023
> 
> 标签：android, listview, onclicklistener

我有一个包含大约 50 个项目的 ListView。根据单击的列表项，我需要显示不同的输出。用户还可以检查多个列表项。

我正在使用 Switch case 来处理这个问题，但是当列表太大时代码会变得很长。例如，我的清单有大约 50 项。在这种情况下，当用户单击 ListView 时，有人可以建议如何处理。谢谢！

```
 listView.setOnItemClickListener(new OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> arg0, View view, int position,
                long arg3) {
            CheckedTextView selectedItem = (CheckedTextView) view;
            boolean isChecked = selectedItem.isChecked();
            Log.e("TAG","item clicked position = " + position + " isChecked = " + isChecked);
            switch(position){
                case 0:
                 //code comes here
                    break;
                case 1:
                    //code comes here
                    break;
                    .
                    .
                    .
                    case 40:
                      //code
                       break;

            }

        }
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T04:16:05.520

是html格式吗？您可以做的另一件事是，只需将位置/数据传递给下一个活动，并基于该位置或数据，您就可以实现您的期望目标。

希望你明白这一点。

# c# - WPF：我可以在代码中为 Grid.Background 设置动画吗？

> ID：14351050
> 
> 赞同：0
> 
> 时间：2013-01-16T03:46:40.590
> 
> 标签：c#, wpf

我的代码是这样的。我想动态创建网格。创造就是成功，但我无法为它的颜色设置动画。我的错误是什么？

```
 Grid[] grid = new Grid[99];
        for (int i = 0; i < 10; i++) {
            grid[i] = new Grid();
            grid[i].Width = grid[i].Height = 100;
            grid[i].Background = Brushes.WhiteSmoke;

            Storyboard sb = new Storyboard();
            ColorAnimation ca = new ColorAnimation(Colors.DarkTurquoise, TimeSpan.FromMilliseconds(250));
            Storyboard.SetTarget(ca, grid[i]);
            Storyboard.SetTargetProperty(ca, new PropertyPath("Fill.Color"));
            sb.Children.Add(ca);
            grid[i].MouseEnter += delegate(object sender2, MouseEventArgs e2) {
                sb.Begin(this);
            };

            stackMain.Children.Add(grid[i]);
        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T04:55:51.163

WPF`Grid`没有`Fill`您必须使用的属性`Background`

```
 Storyboard.SetTargetProperty(ca, new PropertyPath("Background.Color")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T09:25:21.317

除了 sa_ddam 所说的之外，您还必须*创建*一个画笔，因为无法为内置画笔（如`Brushes.WhiteSmoke`您的示例中的示例）设置动画。

```
grid[i].Background = new SolidColorBrush(Colors.WhiteSmoke);
...

Storyboard.SetTargetProperty(ca, new PropertyPath("Background.Color")); 
```

* * *

如果您省略情节提要并直接运行动画，它也可能会节省一些代码：

```
var brush = new SolidColorBrush(Colors.WhiteSmoke);
grid[i].Background = brush;

var ca = new ColorAnimation(Colors.DarkTurquoise, TimeSpan.FromMilliseconds(250));

grid[i].MouseEnter +=
    (o, e) => brush.BeginAnimation(SolidColorBrush.ColorProperty, ca); 
```

# modernizr - 我如何回溯我的 modernizr 以找到所有自定义下载包含的内容？

> ID：14351064
> 
> 赞同：0
> 
> 时间：2013-01-16T03:48:32.850
> 
> 标签：modernizr

我有 2 个程序需要“modernizr”基础插件。

第一个插件包括：modernizr.custom.17475.js

第二个插件包括：modernizr.custom.87626.js

它们是缩小版本，我无法弄清楚它们包含的所有内容，因为我不想在我的网站上两次加载相同的功能。

我如何回溯这些以获取它们包含的内容的列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-13T06:37:20.663

大多数情况下，缩小的构建包括创建构建的自定义 url（例如，类似[http://modernizr.com/download/#-csstransforms-csstransitions-touch-shiv-cssclasses-prefixed-teststyles-testprop-testallprops-前缀-domprefixes-load](http://modernizr.com/download/#-csstransforms-csstransitions-touch-shiv-cssclasses-prefixed-teststyles-testprop-testallprops-prefixes-domprefixes-load)）。之间的每个单词`-`都是一个单独的测试。

如果被剥离，您可以只在浏览器中运行每个脚本，然后比较创建的 Modernizr 对象。

# php - 在全局范围内定义的变量在函数中不可访问

> ID：14351065
> 
> 赞同：1
> 
> 时间：2013-01-16T03:48:42.740
> 
> 标签：php

这可能是一个愚蠢的问题，但我有一些代码，例如：

```
$userData = array_map('htmlentities', mysql_fetch_assoc(mysql_query(
    "SELECT * FROM `smf_members` 
    WHERE `id_member` = (SELECT `id_member` FROM `smf_log_online` WHERE `session` = '" . mysql_real_escape_string($session) . "')"
    )));

function printHeader() 
{
    $header = <<<eof
<!DOCTYPE html>
<html lang="en">
<head>
        ...
            <li><a href="#"><img src="images/avatar.gif" alt="" /> {$userData['member_name']}</a>
        ...
eof;
    echo $header;
} 
```

那是在一个名为的文件中`config.php`，并`require`在我的索引页面中编辑，如下所示：

```
<?php require 'config.php';printHeader(); ?> 
```

但是在`printHeader()`函数内部`$userData`没有设置，好像我`print_r($userData)`在全局范围内设置了它。我是否需要将其余的“全局”代码放在某种构造函数中？还是我错过了一些非常小的东西。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T03:53:15.607

使用[`global`](http://php.net/global)关键字。

```
$userData = array_map('htmlentities', mysql_fetch_assoc(mysql_query(
    "SELECT * FROM `smf_members` 
    WHERE `id_member` = (SELECT `id_member` FROM `smf_log_online` WHERE `session` = '" . mysql_real_escape_string($session) . "')"
    )));

function printHeader() 
{
            global $userData;

    $header = <<<eof
<!DOCTYPE html>
<html lang="en">
<head>
        ...
            <li><a href="#"><img src="images/avatar.gif" alt="" /> {$userData['member_name']}</a>
        ...
eof;
    echo $header;
}

<?php require 'config.php';printHeader(); ?> 
```

# pdf - jasper报告的pdf中的汉字不支持粗体吗？

> ID：14351066
> 
> 赞同：0
> 
> 时间：2013-01-16T03:48:47.863
> 
> 标签：pdf, jasper-reports

我使用 jasper 报告导出为 pdf。在那个报告中英文字符支持粗体，但中文字符不支持。

我用过这个配置。

```
 pdf font: STSong-Light
  Pdf embedded: true
  pdf encoding: uniGB-UCS2-H 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-12T10:33:47.293

需要将 iTextAsian.jar 添加为 java 库的一部分。可以在 Option -> Classpath 中包含 jar 文件。*记得重启iReport

# php - 从外部页面加载内容，特别是来自外部页面的样式表

> ID：14351067
> 
> 赞同：0
> 
> 时间：2013-01-16T03:48:52.957
> 
> 标签：php, html, ajax, jquery

我已经尝试解决这个问题已经有一段时间了。我有一个朋友的独特请求，要帮助他们构建一个网页，该网页从外部页面（不同的服务器）动态提取 div 标签，以便当该页面更新时，它会在此页面上更新。我通过使用 jquery 的 .load 来指定要拉入的 .div 解决了这个问题，但是样式也没有流入，因为它不驻留在 div 标签本身中，而是在标签中。因此，我试图弄清楚如何从其他页面中提取内容，特别是样式表（如果可能的话）并将其放置在我页面的标签中。

我对此感到茫然，我真的很感激一些帮助。

这是我现在的页面设置：

proxy.php（拉入外部页面）

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Untitled Document</title>
<base target="_blank">
</head>

<body>
<?php
    $url = 'www.EXAMPLE.com/';
    $htm = file_get_contents($url);
    echo $htm;
?>
</body>
</html> 
```

实际页面显示具体内容：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title> - Products</title>
<?php 
$file = file_get_contents("proxy.php");
$head = preg_replace("#(.*)<head>(.*?)</head>(.*)#is", '$2', $file);
echo $head;
?>
<script language="javascript" type="text/javascript" src="js/jquery-1.9.0.min.js"></script>
<link href="css/main.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="wrapper">
<div id="contentWrapper">
<div id="contentMain">
<script>
$("#contentMain").load("proxy.php #content");
</script>
</div>
</div>
</div>
</body>
<!-- InstanceEnd -->
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T12:37:09.327

`file_get_contents`您可以为远程文件创建 cURL 版本，因为`allow_url_fopen`出于安全原因，很可能未在主机服务器上设置。

```
function curl_file_get_contents($url) {
    $ch = curl_init();

    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_TIMEOUT, 12);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);

    $result = curl_exec($ch);
    $status = curl_getinfo($ch, CURLINFO_HTTP_CODE);

    $curlError = curl_errno($ch);

    curl_close($ch);

    // Return result if we don't have errors, if there is a result, and if we have a 200 OK
    if (!$curlError && $result && $status == '200') {
        return $result;
    } else {
        return false;
    }
}

$stylesheet = curl_file_get_contents('http://www.example.com/css/style.css');
echo "<pre>";
var_dump($stylesheet);
echo "</pre>"; 
```

# php - Doctrine Custom Repositories - 重新声明的类错误

> ID：14351071
> 
> 赞同：0
> 
> 时间：2013-01-16T03:49:36.233
> 
> 标签：php, doctrine-orm

我对 Doctrine2 很陌生，并且正在尝试设置自定义存储库，但是我遇到了一个错误，我似乎无法通过谷歌搜索：

这是实体：

```
// entities/Customer.php
namespace Entities;

/** @Entity (repositoryClass="Repositories\CustomerRepository") 
 *  @Table (name="customer") */
class Customer { /* ... */ } 
```

这是存储库：

```
// repositories/CustomerRepository.php
namespace Repositories;
use Doctrine\ORM\EntityRepository;

class CustomerRepository extends EntityRepository {
  public function getAllEnterprises() {
    return $this->_em->createQuery(
      'SELECT c FROM Customer c WHERE column_x IS NOT NULL')->getResult();
  }
} 
```

PHP 冲我大喊：

> PHP 致命错误：无法在第 10 行的实体/Customer.php 中重新声明类 Entities\Customer

PHP 5.4.6，通过作曲家安装的学说。

引导程序.php：

```
// bootstrap.php
if (!class_exists('Doctrine\Common\Version', false)) {
  require_once "bootstrap_doctrine.php";
}

require_once "entities/Customer.php";
require_once "repositories/CustomerRepository.php";
require_once "entities/Location.php"; 
```

bootstrap_doctrine.php

```
// bootstrap_doctrine.php
use Doctrine\ORM\Tools\Setup;
require_once "vendor/autoload.php";

// Create a simple "default" Doctrine ORM configuration 
$isDevMode = true;
$config = Setup::createAnnotationMetadataConfiguration(
            array(__DIR__."/entities"), $isDevMode);

// database configuration parameters
$conn = array(
  'driver'      => 'pdo_mysql',
  'host'        => 'localhost',
  'user'        => 'someuser',
  'password'    => 'somepassword',
  'dbname'      => 'somename',
  'unix_socket' => '/var/run/mysqld/mysqld.sock',
);

// obtaining the entity manager
$entityManager = \Doctrine\ORM\EntityManager::create($conn, $config); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T02:26:04.103

我得到了这份工作。看来问题与我发布的内容无关，而是与我用来测试它的代码有关。执行摘要（现在看来很明显）的`->find()`成员`EntityManager`和任何`->getRepository()`回报都完全不同。将它与引用没有命名空间的类结合起来，这就是发生的事情：

我有：

```
$customer = $em
  // ->getRepository('Customer')
  ->find('Customer', (int)$cid); 
```

并试图取消注释第二行的工作。我在这里猜了一点，但我相信发生的事情是这以某种方式导致学说寻找一个类`Customer`（不是`Entity\Customer`），我告诉它我将我的实体保存在`entities`文件夹中......它在那里找到一个`Customer.php`......它愉快地尝试加载。

是的，这将重新定义`Entity/Customer`，这甚至不是它正在寻找的类。

此外，一旦我修复了您收到事务错误的问题，因为存储库（已经是正确的存储库`Entity/Customer`）不需要将类的名称作为第一个参数（回想起来，当然！）。

我不得不说，到目前为止，我从 Doctrine 得到的错误信息一直被证明基本上是无用的。这让我担心采用它。

感谢所有花时间查看此内容的人，以及将其正确标记为 Doctrine2 而不是 Doctrine 的人。

使用此作为参考的正确方法：

```
$em->getRepository('Entity\Customer')->find((int)$cid); 
```

或者

```
$em->getRepository('Entity\Customer')->getAllEnterprises(); 
```

# jquery - jquery 数据表 - 刷新不起作用

> ID：14351076
> 
> 赞同：1
> 
> 时间：2013-01-16T03:50:44.383
> 
> 标签：jquery, datatables

我有一个用 jquery dataTables 构建的 htnl 表。我使用的代码是：

```
var oTable = jQuery('#webcam-table').dataTable({
   "sPaginationType": "full_numbers",
   "bStateSave": true,
   "aaSorting": [[1,"desc"]],
   "aoColumnDefs": [
     { "bSortable": false, "aTargets": [ 4 ] }
   ]
}); 
```

该表还有一个表单，每行都有一个复选框，用户可以在其中选择一个或多个并点击删除按钮。这使用 jquery `ajax`：

```
jQuery(".deletebutton").on("click", function(e) {
    e.preventDefault(); //cancel click event on start
    var testchecked = jQuery(':checkbox:checked').length;
    if (testchecked == 0) {
        alert('Please select at least one video');
        e.preventDefault();
    }
    else
    {
        if (confirm("Are you sure you want to delete the selected videos?"))
        {
            var checked = jQuery('input:checkbox:checked').map(function () {
                return this.value;
            }).get();
            var $this = jQuery(this);
            jQuery.ajax({
                type: 'POST',
                url: 'index.php?option=com_recordings&task=deletevideos&format=raw',
                data: {checkedarray:checked},
                success: function(data){
                    jQuery('#deleteform input:checkbox').each(function(){
                        if(this.checked){
                            jQuery('input:checkbox:checked').parents("tr").remove();
                        }
                    });

                }
            });
        }
    }
}); 
```

这样做是删除表中的一行。这是我对 dataTable 有问题的地方，因为它有页面，当我删除一个或多个时，它不会刷新表。

所以我想我应该能够添加`fnDraw`到代码中：

```
jQuery('#deleteform input:checkbox').each(function(){
       if(this.checked){
            jQuery('input:checkbox:checked').parents("tr").remove();
        }
oTable.fnDraw(); 
```

I thought this would refresh the table after my AJAX delete and after I've removed the row. But this doesn't even remove the row anymore nor does it update the table accordingly. Of course when I refresh the page manually everything is fine. Any ideas on how I can remove the rows selected and then refresh the dataTable?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T20:43:59.167

The [DataTable API](http://datatables.net/api#fnDeleteRow) has a delete row function.

fnDeleteRow Remove a row for the table

**Input parameters:**

*   {mixed}: The index of the row from aoData to be deleted, or the TR element you want to delete
*   {function|null}: Callback function
*   {bool} [default=true]: Redraw the table or not

**Return parameter:**
{array}: The row that was deleted

**Code example:**

```
$(document).ready(function() {
  var oTable = $('#example').dataTable();

  // Immediately remove the first row
  oTable.fnDeleteRow( 0 );
} ); 
```

# javascript - WinJS缓存facebook个人资料图片

> ID：14351080
> 
> 赞同：0
> 
> 时间：2013-01-16T03:51:03.097
> 
> 标签：javascript, facebook-graph-api, windows-8, windows-store-apps, winjs

我为 Windows 8 制作了一个 Facebook 游戏，用户可以在其中连接到 Facebook 并分享他们的分数。

当用户关闭游戏然后重新打开游戏时，我会缓存他们的用户名和用户 ID；但是，我使用图形 api url 获得了他们的图像。

当用户在离线时打开我的应用程序时，就会出现我的问题。我可以正确显示他们的名字，因为它被缓存了，但我无法显示他们的图像，因为它没有被缓存。如何在我的 WinJS 应用程序中缓存他们的图像，以便在他们离线时仍然可用？

这是我的代码来显示他们的形象：

```
$('#FbUserExterno img').attr('src', 'https://graph.facebook.com/' + RS.getUserId() + '/picture'); 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T04:17:19.167

在您连接时，下载图像文件并将其保存在本地（例如，使用[WinJs.xhr](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/br229787.aspx)）。

然后，您可以将[ms-appdata:///local/](http://msdn.microsoft.com/en-us/library/windows/apps/Hh781229.aspx)方案用于指向本地存储中下载文件的图像源。

当然，您会希望以某种频率刷新本地存储中的图像，也许当您检测到您有网络连接时重新下载它。

# sql - 需要简化多个 Select 查询

> ID：14351082
> 
> 赞同：1
> 
> 时间：2013-01-16T03:51:25.943
> 
> 标签：sql, sql-server, sql-server-2008

这是我现有 SQL 查询的结构：

```
SELECT * FROM (

    SELECT *, 'A' AS Status FROM Table1
    WHERE Field1 NOT IN 
    (
    SELECT Field1 FROM Table2 WHERE Field 1 = 'val' AND ...
    )

    UNION

    SELECT *, 'B' AS Status FROM Table1
    WHERE Field1 IN 
    (
    SELECT Field1 FROM Table2 WHERE Field 1 = 'val' AND ...
    )

) AS Result 
```

在这里，我从表中选择两组数据并为该列分配**两个不同的值**`Status`（A 和 B），并将 Union 都设置为一个作为 Result。

这种方法的问题是，它需要复制内部选择查询`SELECT Field1 FROM Table2 WHERE Field 1 = 'val' AND ...`（我原来的 sql 查询比上面显示的要复杂一些）

如何将其重写为单个 Select 查询？有没有可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T09:58:29.560

You could simply move the WHERE condition to a CASE expression, like this:

```
SELECT
  *,
  CASE 
    WHEN Field1 IN (
      SELECT Field1 FROM Table2 WHERE Field1 = 'val' AND ...
    )
    THEN 'B'
    ELSE 'A'
  END AS Status
FROM Table1
; 
```

You could also use a LEFT JOIN method like others suggested, but if `Table2` produces duplicates for the specified filter, you might get duplicates in the output as well. To avoid that, you would probably need to use a derived table that only returns distinct values, something like this:

```
SELECT
  t1.*,
  CASE 
    WHEN t2.Field1 IS NULL THEN 'A'
    ELSE 'B'
  END AS Status
FROM Table1 t1
LEFT JOIN (
  SELECT DISTINCT Field1 FROM Table2 WHERE Field1 = 'val' AND ...
) t2
  ON t1.Field1 = t2.Field2
; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T03:54:50.070

你可以简单地使用`LEFT JOIN`它，

```
SELECT  a.*,
        CASE WHEN b.field1 IS NULL
            THEN 'A'
            ELSE 'B'
        END AS Status
FROM    table1 a
        LEFT JOIN table2 b
            ON a.field1 = b.field1 AND
                b.field1 = 'VAL' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T04:03:33.430

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T05:35:35.630

U can achieve this by using `LEFT JOIN` and `CASE` as follows

```
SELECT  a.*,
    (CASE b.Field1
           WHEN 'Val' 
           THEN 'B' ELSE 'A' END) as status
FROM  Table1 a LEFT JOIN Table2 b ON a.field1 =b.field1 
```

If multiple conditions are there for status try the following one

```
SELECT  a.*,
    (CASE 
           WHEN (SELECT COUNT(Field1) 
                 FROM Table2 
                 WHERE field1 =a.field1 AND Field 1 ='val' AND ...) >0
           THEN 'B' ELSE 'A' END) as status
FROM  Table1 a LEFT JOIN Table2 b ON a.field1 =b.field1 
```

# objective-c - 如何为 Class 方法构建 NSInvocation？

> ID：14351086
> 
> 赞同：1
> 
> 时间：2013-01-16T03:51:48.810
> 
> 标签：objective-c

我想为类方法和选择器使用 NSClassFromString 和 NSSelectorFromString 构建调用。我尝试通过以下方式构建调用：

```
NSMethodSignature *signature;
NSInvocation *inv;

Class targetClass = NSClassFromString(@"NSString");
SEL selector   = NSSelectorFromString(@"stringWithString:");
id arg = @"argument";

Method method = class_getInstanceMethod(targetClass, selector); 
```

// 为什么我运行代码时方法是 nil？

```
struct objc_method_description* desc = method_getDescription(method);

if (desc == NULL || desc->name == NULL){
    return nil;
}

signature = [NSMethodSignature signatureWithObjCTypes:desc->types];
inv = [NSInvocation invocationWithMethodSignature:signature];
[inv setSelector:selector];
[inv setArgument:&arg atIndex:2];
[inv invoke];

__autoreleasing id returnObj;    
[inv getReturnValue:&returnObj];    // get created object 
```

由于“方法”总是“零”，这种方法不起作用。为什么？
通过调用上述代码执行类方法的正确方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T04:49:46.233

你的代码太复杂了。`NSMethodSignature*`您可以在不弄乱运行时的情况下获取对象。

```
signature = [NSString methodSignatureForSelector:@selector(stringWithString:)]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-16T04:39:33.097

`stringWithString:`是一个类方法，您的代码正在使用`class_getInstanceMethod()`.

尝试更改`class_getInstanceMethod()`为`class_getClassMethod()`.

# ios - iOS 应用程序在释放保留的属性时崩溃

> ID：14351089
> 
> 赞同：2
> 
> 时间：2013-01-16T03:52:36.873
> 
> 标签：ios, objective-c, properties, uikit, autorelease

我有个问题。这个问题可能有一个非常简单的解决方案，但我还无法弄清楚。如果我使用属性说`@property(nonatomic, retain)UIView *mainView`.

现在我在 .m 文件中合成它并在 dealloc 方法中释放它，如下所示：

```
- (void)dealloc {
   [mainView release], mainView = nil;
   [super dealloc];
} 
```

然后在我的 中`viewDidLoad`，我正在分配它并将其添加为我的子视图，`self.view`如下所示：

```
- (void) viewDidLoad {

  mainView = [[UIView alloc] init];
  .
  .
  .
  [self.view addSubView: mainView];
} 
```

现在我明白了，此时我`mainView`将有 3 个引用计数（一个来自 alloc，一个因为它是保留属性，第三个当我将它添加到时`self.view`），它的父控制器也将拥有它。现在，我的问题是，如果在将我的视图添加到 self.view 之后，我使用

```
[mainView release]; 
```

当我将释放发送到已释放的对象时，当我返回上一个视图时，我的应用程序崩溃了。现在我的问题是我如何在这里过度释放我的观点。我错过了什么，因为当我使用以下代码时它工作正常并且没有发生崩溃。

```
- (void) viewDidLoad {
  UIView *newView = [[UIView alloc] init];
  self.mainView = newView;
  [newView release];
  .
  .
  .
  [self.view addSubView: mainView];
} 
```

我知道为什么第二个 viewDidLoad 方法有效，但我不知道为什么第一个会失败，我应该在将其添加到 self.view 后释放我的视图。对？

**注意：我知道在第一个 viewDidLoad 中，我可以使用 autorelease 方法来释放分配给 ivar 的视图，它不会崩溃，但重点是我试图尽可能减少 autorelease 的使用。而且我根本没有使用ARC**

我非常感谢您的解释和建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T03:58:35.557

从你的问题：

> 现在我明白了，此时我的 mainView 将有 3 个引用计数（一个来自 alloc，一个因为它的保留属性，第三个当我将它添加到 self.view 时）

您没有通过属性进行分配，而是直接分配给实例变量，因此没有保留；只有在 ARC 中，分配给实例变量的值才会保留。因此，请勿执行手动释放。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T03:58:43.897

为了让您`@property`保留`mainView`，您应该将其用作`self.mainView`而不只是`mainView`. 如果您单独使用后者，它将不会保留它。基本上，如果你调用它，它就是调用一个在内部执行`self.mainView = ...`的 setter 方法。当你直接分配它时，它不会执行这个setter，也不会执行retain。`mainView``[mainView retain];`

你应该这样试试

```
self.mainView = [[[UIView alloc] init] autorelease];
[self.view addSubView:self.mainView]; 
```

或如您的问题所示。

```
UIView *newView = [UIView alloc] init];
self.mainView = newView;
[newView release];
[self.view addSubView:self.mainView]; 
```

您也可以尝试将 ARC 用于您的项目。您的代码在 ARC 中将如下所示，

```
self.mainView = [[UIView alloc] init];
[self.view addSubView:self.mainView]; 
```

查看[文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/EncapsulatingData/EncapsulatingData.html#//apple_ref/doc/uid/TP40011210-CH5-SW2)以获取更多详细信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-16T03:59:00.250

在您的第一个 viewDidLoad 方法中，您不是指 self.mainView 仅 mainView 这就是它不保留的原因，为了保留属性工作，您必须使用 self.mainView 设置 mainView！

# php - PHP 会话数组 - 查询数据库

> ID：14351091
> 
> 赞同：0
> 
> 时间：2013-01-16T03:52:42.997
> 
> 标签：php, database, arrays, session

这是对上一个问题的后续。

我的主页上有 4 个按钮，每个按钮都有自己的 ID。当有人单击按钮时，Jquery 会获取按钮 ID 并通过 Ajax 将其发送到 PHP，然后将其添加为会话变量。如果人们单击多个按钮，它将发送每个按钮的 ID。所以最后我有可能在数组中有 4 个变量。

Session 被创建为一个数组，以便它可以保存多个 ID：像这样：

```
 <?php
    session_start();

    if ( ! is_array( $_SESSION['ids'] ) ) {
       $_SESSION['ids'] = array();
    }

    if ( ! in_array($_POST['session'], $_SESSION['ids'] ) ) {
       $_SESSION['ids'][] = $_POST['session'];
    }
 ?> 
```

一切正常，如果我`print_r $_SESSION['ids']`正确显示了被点击和存储的每个按钮的 id，例如：

```
[0] => 1, null, [1] => 3, null, [2] => 4 
```

（存储的按钮 ID 是 1、3 和 4。

现在的问题是我需要在数据库中查询已存储的按钮 ID。

如何分解数组并仅获取值，例如：按钮`ID 1, 3`和`4`. 这样我就可以用它们查询数据库了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T04:00:06.067

您可以使用[此处](http://php.net/manual/en/function.implode.php)`implode()`描述的功能。

```
$in = implode(',',$_SESSION['ids']);
mysql_query("SELECT * from yourbd where id in ($in)");//just an eg. mysql_* is deprecated 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T03:57:45.663

看看[这个](http://php.net/manual/en/function.implode.php "使用粘合字符串连接数组元素。")功能。祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T04:00:07.453

```
$buttons=$_SESSION['ids'];
$str=implode(', ',$buttons);
$sqlquery = mysql_query("Select * from table where btn_id IN ($str)"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T04:00:31.890

## 更改数组

```
 foreach ($IdsArray as $myId) {
    $newIds[] = 'my_id = ' . $myId;
  }
  $orSeparatedIds = implode(" OR ", $newIds); 
```

## 在查询中使用

```
$query = "select my_id from mytable where $orSeparatedIds"; 
```

# javascript - Meteor.users.update() 在注销 + 登录时不起作用

> ID：14351093
> 
> 赞同：2
> 
> 时间：2013-01-16T03:52:46.920
> 
> 标签：javascript, meteor, javascript-framework

我有一个用户个人资料视图，用户可以在其中编辑他们的个人资料信息。下面的一切都很好，更新成功。但是，当我注销帐户并使用其他用户帐户登录时，更新失败并返回`Access denied`错误。直到我刷新页面，我才能使用第二个帐户再次编辑个人资料信息。

我知道这种情况非常罕见，用户通常不会退出一个帐户，用另一个帐户登录并尝试更新他们的个人资料，但我想更好地理解为什么会发生这种情况。用户注销时客户端令牌是否未刷新，或者是否有其他需要完全重新加载页面的内容被保留？

在客户端 JS 上：

```
Template.user_profile_form.events({
    'click #submit_profile_btn': function(evt) {
        evt.preventDefault();
        var first_name = $('#profile_first_name').val()
            ,last_name = $('#profile_last_name').val()
            ,email = $('#profile_email').val()
            ,email_lower_case = email.toLowerCase()
            ,gravatar_hash = CryptoJS.MD5(email_lower_case)
        ;

        gravatar_hash = gravatar_hash.toString(CryptoJS.enc.Hex);

        // TODO need to create user sessions so that when you log out and log back in, you have a fresh session
        Meteor.users.update({_id: this.userId }, {
            $set: {
                profile: {
                    first_name: first_name,
                    last_name: last_name,
                    gravatar_hash: gravatar_hash
                }
            }
        }, function(error) {
            if (!error) {
                Session.set('profile_edit', 'success');
                Meteor.setTimeout(function() {
                    Session.set('profile_edit', null);
                }, 3000);
            } else {
                Session.set('profile_edit', 'error');
                Template.user_profile_form.error_message = function() {
                    return error.reason;
                };
            }
        });

        Meteor.call('changeEmail', email);
    }
}); 
```

服务器JS：

```
Meteor.publish('list-all-users', function () {
    return Meteor.users.find({_id: this.userId }, {
        fields: {
            profile: 1,
            emails: 1
        }
    });
});

Meteor.methods({
    sendEmail: function(to, from, subject, text) {
        this.unblock();

        Email.send({
            to: to,
            from: from,
            subject: subject,
            text: text
        });
    },
    changeEmail: function(newEmail) {
        // TODO Need to validate that new e-mail does not already exist
        Meteor.users.update(Meteor.userId(), {
            $set: {
                emails: [{
                    address: newEmail,
                    verified: false
                }]
            }
        });
     }
}); 
```

模板：

```
<template name="user_profile_form">
    <h2>Update Profile</h2>
    <div id="profile-form">
        {{#if success}}
            <div class="alert alert-success">
                <strong>Profile updated!</strong> Your profile has been successfully updated.
            </div>
        {{/if}}
        {{#if error}}
            <div class="alert alert-error">
                <strong>Uh oh!</strong> Something went wrong and your profile was not updated. {{error_message}}.
            </div>
        {{/if}}
        <p>
            {{#each profile}}
            <input type="text" id="profile_first_name" placeholder="First Name" value="{{first_name}}">
            <input type="text" id="profile_last_name" placeholder="Last Name" value="{{last_name}}">
            {{/each}}
            <input type="email" id="profile_email" placeholder="Email" value="{{email_address}}">
        </p>
    </div>
    <div id="submit-btn">
        <input type="submit" id="submit_profile_btn" class="btn btn-primary">
    </div>
</template> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:13:21.700

Meteor 注销功能几乎什么都不做。它当然不会破坏会话状态或应用程序的其余部分。您的代码必须在应用程序的注销事件期间重置这些变量。手动刷新页面会导致客户端 JavaScript 重新加载以清除现有的 Session 数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-22T13:03:14.390

如果您不想弄乱*accounts-ui*模板内部，您可以使用以下模式（CoffeeScript 代码）从`Session`：

```
Deps.autorun (c) ->
  user = Meteor.user()
  if user
    # Setup code on login (if required)
  else if not user
    # Clear session on logout
    Session.set "profile_edit", undefined 
```

# python - 在不满足游戏结束条件的情况下如何退出我的游戏？

> ID：14351095
> 
> 赞同：1
> 
> 时间：2013-01-16T03:53:01.663
> 
> 标签：python

这是我第一次尝试 Python 编码，或者任何与此相关的编码。我制作了这个简单的小游戏，它似乎运行良好，但我想为它添加另一个选项。

代码生成一个随机角色，HP，攻击力，XP和等级，然后生成一条HP和攻击力的龙，游戏然后决定每次攻击谁，如果玩家获胜，他可以获得一些Xp并升级，如果龙赢了玩家就死了，它会要求你再玩一次。

我想补充的是，如果我在战斗中，不想继续，我想问用户他们是否想继续战斗，如果不是，游戏结束。

我试过这样做，但我失败了。另外，如果有什么我可以做的来增强我的代码。

提前致谢。

```
import random

def charGen():
    char = [random.randint(1,10),random.randint(1,3), 0, 0]#[hp, power,xp,level]
    return char
def drgnGen():
    drgn = [random.randint(1,5),random.randint(1,5)]
    return drgn
def playAgain():
    print('do you want to play again?(y)es or no')
    return input().lower().startswith('y')

def xpValues(levels):
    for i in range(levels):
        n=0
        n=((i+2)**2)
        xpLevels.append(n)

def xpIncrement(XP,xpLevels,char):
    #returns the level of the character( the bracket in which the character XP level lies within) 
    #level = char[3]
    for i in range(len(xpLevels)):
        if XP>= xpLevels[i] and XP<xpLevels[i+1]:
            #level = i+1
            return i

def levelUp(char,level):
     if level+1>char[3]:
         char[0] += 1
         char[3] += 1
         print ('you are now at level %s!, your health now is %s points'%((level+1),char[0]))

def isNotDead(char):
    if char[0]>0:
        return True
    else:
        return False

while True:
    XP = 5 #the default XP gain after battle win
    char = charGen() #generate the character

    xpLevels=[]
    xpValues(15)
    print (xpLevels)
    print ('______________________________________')
    print ('Welcome to the Battle of the dragons!')
    print ("you are a fierce Warrior with %s health points and A power of %s points" %(char[0],char[1]))
    print ('------------------------------------------------------------------------')
    while isNotDead(char):
        print(' ')
        print ('While adventuring you have met a scary looking dragon')
        print('Without hesitation you jump to fight it off!')
        print('=============================================')
        print(' ')
        drgn = drgnGen() #generate a dragon
        while True:

            roll = random.randint(0,1)
            if roll == 0:
               print("the dragon hits you for %s points" %drgn[1])
               char[0] = char[0] - drgn[1]
               if isNotDead(char) :
                   print("you have %s health left!" %char[0])
                   input('Press Enter to continue')
                   print(' ')
               else:
                    print("you're dead!Game Over")
                    print(' ')
                    break

            else:
                print("you hit the dragon for %s points"%char[1])
                drgn[0] = drgn[0] - char[1]

                if drgn[0] >0:
                    print("the dragon have %s health left!" %drgn[0])
                    input('Press Enter to continue')
                    print(' ')
                else:
                    char[2]+= XP
                    print("Horaay!you have killed the dragon!and your experience points are now %s"%char[2])
                    levelUp(char,(xpIncrement(char[2],xpLevels,char)))                    
                    input('Press Enter to continue')
                    break

    if not playAgain():
        break 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T05:13:22.440

获得所需内容的快速解决方法是设置几个标志来标记用户是否在战斗。您也可以将打印输出延迟到最内层循环结束，以避免重复太多`print`：

```
new_dragon = True
while new_dragon:
    print(' ')
    print ('While adventuring you have met a scary looking dragon')
    print('Without hesitation you jump to fight it off!')
    print('=============================================')
    print(' ')
    drgn = drgnGen() #generate a dragon
    fighting = True
    while fighting:
        message = []
        roll = random.randint(0,1)
        if roll == 0:
           message.append("the dragon hits you for %s points" %drgn[1])
           char[0] = char[0] - drgn[1]
           if isNotDead(char) :
               message.append("you have %s health left!" %char[0])
           else:
               message.append("you're dead!Game Over")
               fighting = False
               new_dragon = False
        else:
            message.append("you hit the dragon for %s points"%char[1])
            drgn[0] = drgn[0] - char[1]

            if drgn[0] >0:
                message.append("the dragon have %s health left!" %drgn[0])
            else:
                char[2]+= XP
                message.append("Horaay!you have killed the dragon!and your experience points are now %s"%char[2])
                levelUp(char,(xpIncrement(char[2],xpLevels,char)))                    
                continue_flag = False
        for m in message:
            print (m)
        print ('')
        if fighting:
            r = input("Press enter to continue or enter q to quit")
            if r is 'q':
                fighting = False 
```

为了更普遍地改进代码：

*   为 Player 和 Dragon 创建一个 Character 类以及继承 Character 类的共享属性的类
*   只需比较是否 new_xp > xpLevels[previous_xp] 就可以大大简化是否升级的检查
*   如果只使用嵌套的 while 循环继续扩展程序，程序很快就会变得过于复杂。您需要的是单个while 循环、游戏的每个阶段/状态的函数（或类）、记录游戏当前状态的变量（例如存在的任何龙）以及决定下一步做什么的条件。
*   使用类给事物提供清晰的描述性名称，例如 player.power 而不是 char[2]

比如下面...

```
import random

class Character:
    def __init__(self, max_hp, max_power):
        self.hp = random.randint(1, max_hp)
        self.power = random.randint(1, max_power)
    def is_dead(self):
        return self.hp <= 0
    def hit_by(self, enemy):
        self.hp -= enemy.power

class Player(Character):
    def __init__(self):
        Character.__init__(self, max_hp=10, max_power=3)
        self.xp = 0
        self.level = 0
        self.xp_thresholds = [(i + 2) ** 2 for i in range(15)]
    def battle_win(self):
        self.xp += battle_win_xp
        if self.level < len(self.xp_thresholds) and self.xp > self.xp_thresholds[self.level + 1]:
            self.level_up()
    def level_up(self):
        self.hp += 1
        self.level += 1
        print('you are now at level %s!, your health now is %s points' % (self.level + 1, self.hp))

def begin():
    game.player = Player()
    print('______________________________________')
    print('Welcome to the Battle of the dragons!')
    print("you are a fierce Warrior with %s health points and A power of %s points" %(game.player.hp, game.player.power))
    print('------------------------------------------------------------------------')
def new_dragon():
    print('While adventuring you have met a scary looking dragon')
    print('Without hesitation you jump to fight it off!')
    print('=============================================')
    game.dragon = Character(5, 5)
def fight():
    player, dragon = game.player, game.dragon
    if random.randint(0, 1):
        player.hit_by(dragon)
        print("the dragon hits you for %s points" % dragon.power)
        if player.is_dead():
            print("you're dead! Game over")
            return
        else:
            print("you have %s health left!" % player.hp)
    else:
        dragon.hit_by(player)
        print("you hit the dragon for %s points" % player.power)
        if dragon.is_dead():
            print("Horaay!you have killed the dragon!and your experience points are now %s"%player.xp)
            player.battle_win()
            game.dragon = None
            return
        else:
            print ("the dragon have %s health left!" %dragon.hp)
    print "Press enter to continue (q to quit)"
    if input() is 'q':
        game.finished = True
def play_again():
    print 'do you want to play again?(y)es or no'
    if input().lower().startswith('y'):
        game.__init__()
    else:
        game.finished = True
battle_win_xp = 5 #the default XP gain after battle win
class Game:
    def __init__(self):
        self.dragon = None
        self.player = None
        self.finished = False
game = Game()
while not game.finished:
    if not game.player:
        begin()
    elif game.player.is_dead():
        play_again()
    elif not game.dragon:
        new_dragon()
    else:
        fight() 
```

# sqlalchemy - 对查询中的字段求和

> ID：14351099
> 
> 赞同：5
> 
> 时间：2013-01-16T03:53:29.023
> 
> 标签：sqlalchemy, func

这应该是一个问过的问题，我搜索过，但我找不到任何答案。对不起，如果它是重复的。我有一个查询可以说：

```
my_query=session.query(Item).filter(somefilter) 
```

现在，Item 有一列，可以说`counter`，我想找到这一列的总和`my_query`。我可以这样做：

```
sum=0
for row in query:
    sum+=row.counter 
```

但我不认为这是在大型数据库中专门执行此操作的有效方法。我知道这是可能的：[sqlalchemy simple example of `sum`, `average`, `min`, `max`](https://stackoverflow.com/questions/11830980/sqlalchemy-simple-example-of-sum-average-min-max)，但这需要过滤`qry`（从页面借用），我已经给出了过滤版本`my_query`。`qry`我不知道在 on 上再次进行过滤是否真的更有效`my_query`。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-07-09T23:02:34.177

我有同样的问题。我在 irc.freenode.org#sqlalchemy 上询问，inklesspen 将我指向[Query#with_entities()](http://docs.sqlalchemy.org/en/rel_0_9/orm/query.html#sqlalchemy.orm.query.Query.with_entities)。

```
sum = my_query.with_entities(func.sum(Item.counter)).scalar() 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-16T16:30:49.260

sqlalchemy.func 中有一大堆 SQL“组”函数：

```
from sqlalchemy import func
my_query = session.query(func.sum(Item.counter)).filter(somefilter) 
```

# internet-explorer-9 - URL 转发强制 IE 进入怪癖模式。服务器问题？

> ID：14351100
> 
> 赞同：1
> 
> 时间：2013-01-16T03:53:37.810
> 
> 标签：internet-explorer-9, quirks-mode

我有一个基本网站，我遇到了一些 IE9 怪癖模式问题。

该站点是“ [http://www.darrendifilippo.com.au/top-fuel-funny-car](http://www.darrendifilippo.com.au/top-fuel-funny-car) ”上的 OpenCart 安装。客户希望此站点从另一个域“ [http://www.dpe.net.au](http://www.dpe.net.au) ”重定向到。

[在“ http://www.darrendifilippo.com.au](http://www.dpe.net.au) ”托管网站的公司与“ [http://www.dpe.net.au](http://www.darrendifilippo.com.au) ”所在的公司不同。

设置了 URL 转发来执行此重定向。此转发是在我的域公司帐户中设置的（无法访问 ftp 以获取 htaccess 或类似的东西）。

我的问题是：我将网站上传到“darrendifilippo”服务器上，目的是上线并完成所有内容。当我转到“ [http://www.dpe.net.au](http://www.dpe.net.au) ”并单击 Top Fuel 按钮以转到新站点时（“ [http://www.darrendifilippo.com.au/top-fuel-funny -car](http://www.darrendifilippo.com.au/top-fuel-funny-car) ") Internet Explorer 以血腥的怪癖模式显示该站点。

我检查了我的 DOCTYPE，它们看起来还不错。我也有 XUA hack 正在运行。

我有点困惑，当我直接导航到“ [http://www.darrendifilippo.com.au/top-fuel-funny-car](http://www.darrendifilippo.com.au/top-fuel-funny-car) ”而不通过 URL 转发时，网站页面默认更改为 IE 9 标准模式。

我以为这可能是服务器问题？也许转发服务器正在将所有内容切换到 Quirks 模式。

它只是不加起来！

这是我的代码：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<meta http-equiv="X-UA-Compatible" content="IE=Edge"/>

<head> 
```

* * *

几天后....

好的，所以情节有点厚了..

当我的网页从 dpe.net.au 域导航到时，我发现有些东西正在注释掉我的 Doctype 声明。当直接导航到 (darrendifilippo.com.au/top-fuel-funny-car/) 时，我的代码仍然不受限制。

此注释仅显示在开发人员工具窗口中。查看这两个示例的来源没有发现任何区别。我在下面附上了图片。第一张图片是我的代码，因为它应该是所有显示良好时的代码（不确定空文本节点是什么，但无论如何..），第二张图片显示了一些注释掉我的 Doctype 并添加到 Frameset 中的内容.

![这是我的代码，当一切正常时应该是这样](../Images/01fdba4987c5899c8ffcd0c799e54932.png)

![有些东西正在改变我的代码！ 您可以看到添加了一个框架集，并且我的 Doctype 被注释掉了](../Images/e0f7d0065596e449b9cd71b76e8cb257.png)

如果有人对这可能是什么有任何想法，我们将不胜感激。我仍然认为这是一个服务器端问题，也许有人为重定向设置了默认文档声明，或者使用框架集创建了某种安排，该框架集被贴在每个文档上......我不知道......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T03:57:38.337

由于您使用的是 html 4 strict dtd，因此应避免使用自闭合标签：

```
<meta http-equiv="X-UA-Compatible" content="IE=Edge"/> 
```

应该：

```
<meta http-equiv="X-UA-Compatible" content="IE=Edge"> 
```

或者更好的是，将您的文档类型更改为：

```
<!DOCTYPE html> 
```

我不确定这是否是您的问题，但这肯定与您的标记有关。服务器端没有任何东西会导致 IE 以 quirksmode 呈现，除非它当然改变了你的标记。

# xml-namespaces - 如何让 Google XML Pages 识别并允许新的 HTML 5 元素？

> ID：14351104
> 
> 赞同：0
> 
> 时间：2013-01-16T03:54:12.473
> 
> 标签：xml-namespaces, gxp

[Google XML Pages](http://code.google.com/p/gxp/)说他们支持“标准 html，只要它被格式化为 xml”，但他们似乎只支持 html 4.0。用于支持 html 的命名空间是`http://www.w3.org/1999/xhtml`并从 gxp 生成输出，该 gxp 包含类似`<header>` `<nav>`或`<footer>`抱怨该元素在[http://www.w3.org/1999/xhtml](http://www.w3.org/1999/xhtml)命名空间中未知的元素。

我应该使用一些不同的命名空间还是 gxps 真的只支持 HTML 4？

这是一个参考示例 gxp 文件，其中删除包装`header`标签可以正常工作：

```
<gxp:template
  name='com.example.gxps.Test'
  xmlns:gxp='http://google.com/2001/gxp'
  xmlns='http://www.w3.org/1999/xhtml'>
<html>
  <body>
    <header>
      <b>
        <gxp:msg>Hello,</gxp:msg>
        <br/>
        <gxp:msg>World!</gxp:msg>
      </b>
    </header>
  </body>
</html>
</gxp:template> 
```

尽管如此，它会输出如下内容：

> > java/com/example/gxps/Test.gxp:7:5:7:5：未知元素`<header>`（在[http://www.w3.org/1999/xhtml](http://www.w3.org/1999/xhtml)命名空间中）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T01:27:57.050

GXP 必须有一个（旧）版本的命名空间定义，内置于其中。

看起来 HTML5 和 HTML4 使用相同的命名空间，因此您不需要在 GXP 页面中使用不同的命名空间。这只是更新/添加内部 GXP 定义的问题。

下载源代码并查找定义在哪里！理想情况下，您可以将更新发布/提交回 GXP 项目。

（我和其他人自己对 GXP 很感兴趣，所以.. 这将是非常好的工作。）

让我知道你怎样去！

# delphi - 如何在 Fire Monkey 中提供时间准确的计时器？

> ID：14351108
> 
> 赞同：1
> 
> 时间：2013-01-16T03:54:48.413
> 
> 标签：delphi, timer, delphi-xe2, firemonkey

我必须在 10 秒内显示一个计时器以进行体育比赛。我已经使用 TTimer 的 OnTimer 事件来做到这一点。间隔设置为 100。我的例程正确显示当前 min:sec.10th（例如：02:45.7），但如果我比较，我的计时器似乎每分钟松动约 4 秒。到正常时钟。

在 Delphi XE2（或 XE3）中有更好的方法来获得时间精度计时器吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T04:07:36.860

您可以使用计时器来*显示**时钟*的当前值，但使用不同的方法来计算经过的时间。

您必须知道 Windows 计时器的*时间不准确*，即使您将其设置为每 100 毫秒经过一次，触发 OnTimer 事件也可能需要更多时间，如果由于某种原因之前经过两次或更多次，它甚至可能会错过一些时间间隔你的申请处理它。

例如，您可以使用系统[高分辨率性能计数器](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644904%28v=vs.85%29.aspx)以纳秒精度跟踪时间。

您还可以使用 Delphi [TStopwatch](http://docwiki.embarcadero.com/Libraries/XE2/en/System.Diagnostics.TStopwatch)类，它封装了系统调用并在您的机器中没有高分辨率性能计数器时回退到其他方法 (GetTickCount)。

另请查看[如何使用高分辨率性能计数器](http://delphi.about.com/od/windowsshellapi/a/delphi-high-performance-timer-tstopwatch.htm)delphi.about.com 准确测量经过时间的文章。

# ember.js - 如何在 emberjs DS.Store 中升级修订版

> ID：14351113
> 
> 赞同：0
> 
> 时间：2013-01-16T03:55:22.330
> 
> 标签：ember.js, ember-data

我是 emberJS 的新手，我想知道关于 DS.Store 修订值的一件事。

从文档和[Katz 的 peepcode 视频](https://peepcode.com/products/play-by-play-wycats-ii-emberjs)（我强烈推荐）中，当版本太高时，您会在控制台中收到一条不错的小错误消息，例如：

```
App.store = DS.Store.create({
  revision: 11,
  adapter: DS.RESTAdapter.create({
    namespace: 'api'
  })
}); 
```

可以返回：

```
Uncaught Error: Error: The Ember Data library has had breaking API changes since the last time you updated the library. Please review the list of breaking changes at https://github.com/emberjs/data/blob/master/BREAKING_CHANGES.md, then update your store's `revision` property to 4 
```

我知道，当显示此消息时，您必须返回到[ember-data 源代码的重大更改页面，](https://github.com/emberjs/data/blob/master/BREAKING_CHANGES.md)但对于我需要查看的内容，我真的很困惑。

对于**第 5 版**（我想我也在尝试升级的版本），有很多东西，但似乎没有一个真正适用于我的应用程序。

因此，就升级修订的方法而言，有人可能会为我提供一些指导。您是否需要解决修订说明，然后增加修订号（然后重复），或者这是否意味着某些内容已被破坏并且您需要暂时使用该修订号？

很抱歉这篇冗长的帖子，但我正试图摆脱自己的困惑:)

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T04:31:30.933

很高兴看到你给 ember 一个机会！

因此，该错误消息以相反的方式起作用-它抱怨您的修订版 (5) 对于 ember-data.js 的版本来说太低了。Ember 迫使您手动更新您的转速以匹配当前的转速。Ember-data 库变化如此之快，他们想让每个人都意识到重大变化。如果您正在构建新的东西，只需将修订设置为当前的（截至今天为 11）

那个窥视代码视频很好，但已经过时了。在使用当前版本的 ember 时尝试跟随是行不通的。在过去的几周里，Ember 发生了很大的变化，您在网上找到的大多数教程/等都没有跟上。现在最好的信息来源是指南：[http ://emberjs.com/guides](http://emberjs.com/guides)

另外，我建议上个月在西雅图 Ember.js 聚会上观看 Tom Dale 和 Yehuda Katz 的演讲：[http ://www.youtube.com/watch?v=_6yMxU-_ARs](http://www.youtube.com/watch?v=_6yMxU-_ARs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-14T09:24:03.457

正如迈克尔所说，该教程有点过时了。我更新了库的实际版本（jquery、handlebars、ember 和 ember-data）。DS 的当前版本为 12

```
App.Store = DS.Store.extend({
    revision: 12,
adapter: 'DS.FixutreAdapter' 
```

});

# breeze - 如何更新微风.js 库

> ID：14351114
> 
> 赞同：1
> 
> 时间：2013-01-16T03:55:33.420
> 
> 标签：breeze

我可以使用一些关于如何在 Breeze 版本及其依赖项之间手动更新的指导。我不相信我可以只使用 NuGet 包管理器进行更新。

我一直在用 Breeze、Knockout、WebAPI 等开发我的单页应用程序。我一直在使用 Breeze 0.61 版并想升级到最新版本，这样我就可以利用 ODataActionFilters 而不必解析 Request.QueryString 来提取参数和过滤器。例如当我打电话时

```
 var getMachineById(machineId) {
            var query = EntityQuery
            .from("Machines")
            .where("machineId", "eq", machineId);

            return manager.executeQuery(query)
            .then(function (data) {
                do_something_with(data.results);
            })
            .fail(queryFailed);
       } 
```

Breeze 必须有办法为我处理这个问题，所以我可以这样做：

```
 [AcceptVerbs("GET")]
    public IQueryable<Machine> Machines()
    {
        return _contextProvider.Context.Machines;
    } 
```

代替

```
 // eg "?$filter=machineId%20eq%205"
    [AcceptVerbs("GET")]
    public IQueryable<Machine> Machines()
    {
        IQueryable<Machine> x = _contextProvider.Context.Machines;
        List<ODataQueryString> list = null;
        string qs = Request.RequestUri.Query.ToString(CultureInfo.CurrentCulture);  
        list = new ODataQueryStringParser(qs).Parse();
        if (list != null)
        {
            int machineId = int.Parse(list[0].Value); // covert string to an int
            x = x.Where(o => o.MachineId == machineId);
        }

        return x;
    } 
```

1.  我注意到控制器中的属性装饰在示例中发生了变化。我的也需要换吗？

    ```
    namespace PilotPlantBreeze.Controllers
    {
        [JsonFormatter, ODataActionFilter]
        public class BreezeController : ApiController
        {
            readonly EFContextProvider<PilotPlantDbContext> _contextProvider =
            new EFContextProvider<PilotPlantDbContext>();

            [AcceptVerbs("GET")]
            public string Metadata()
            {
                return _contextProvider.Metadata();
            }
            [AcceptVerbs("POST")]
            public SaveResult SaveChanges(JObject saveBundle)
            {
                return _contextProvider.SaveChanges(saveBundle);
            }
     ... etc.
        }
    } 
    ```

2.  我在文件夹 ~\Scripts\lib 中有我的 3rd 方库。如果我使用 NuGet 包管理器进行更新，它会将所有替换项放在 ~\Scripts 中。如何将文件移动到 lib 文件夹中而不弄乱我的 Team Foundation Server (Azure) 源代码控制？

3.  Antlr3.Runtime.dll、Breeze.WebApi.dll、Irony.dll、Newtonsoft.Json.dll、WebActivator.dll 和 WebGrease.dll 的运行时版本是否在版本之间兼容。我打赌不会。我必须在 Visual Studio 中更改什么吗？

4.  我可以只更改 packages.config 中包文件夹中的版本条目吗？

    谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T17:48:53.550

我认为你最好的方法是从你的项目中删除任何现有的微风'.js'文件和webApi和irony.dlls，然后简单地安装最新的微风nuget包。安装 nuget 包后，您可以继续将文件移动到项目中的其他位置以匹配它们的“旧”位置。我也会为 NewtonSoft nuget 包做同样的事情，以防万一（微风会为你添加这个）。展望未来，您可以更新到最新的 nuget，然后移动文件。

正如您所注意到的，您还需要替换这些属性

[JsonFormatter，ODataActionFilter]

有这个属性

[微风控制器]

这假定您没有运行 ASP.MVC4 的 beta 版本。我认为其他论坛中的帖子讨论了如何从测试版迁移。

# iphone - 对象和非免费桥接类型之间的转换

> ID：14351116
> 
> 赞同：2
> 
> 时间：2013-01-16T03:55:56.043
> 
> 标签：iphone, ios, objective-c

正如我们所知，在免费桥接类型和 Objective-c 类型（例如`CFArrayRef`和）之间进行转换非常容易`NSArray`。昨天，我发现了一段代码可以将`CGImageRef`（不是免工具桥接类型）转换`id`为如下：

```
CALayer *imgLayer = [CALayer layer];  
imgLayer.contents = (id)aImage.CGImage; 
```

但是，它工作正常。但我不明白，因为`CGImageRef`根据苹果的文档，它不属于免费桥接类型。看第二行代码，`imgLayer`应该保留赋值给属性内容的值。因为`CGImageRef`被转换为`id`所以我认为在属性内容的 setter 方法中，它会像这样向该对象发送保留消息`[xxx retain]`。但`aImage.CGImage`不是一个对象，所以我认为这个保留消息不会正确执行（但它会）。所以我的问题是这种转换背后的实际行动是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T04:00:01.160

这些方法是 Apple 为方便起见而添加的规则的一个例外。由于编译器知道 Objective-C 命名约定和隐含的内存管理，因此 Objective-C 函数返回的 Core Foundation 对象将被自动转换并正确处理。

请参阅[本文档](http://developer.apple.com/library/mac/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html)中**的编译器处理从 Cocoa 方法返回的 CF 对象部分**

免费桥接是一个有点过时的术语。它指的是Core Foundation C 对象和Objective-C 对象之间的无缝转换。但是，使用 ARC，转换不再那么无缝，因为编译器需要在桥接相应对象后提示如何处理它们。但是，在这种情况下，它从方法的命名约定中获得提示。

此外，所有 Core Foundation 对象本质上都可以转换为 Objective-C 对象。如果没有相应的类型，那么它们将简单地变成一个特殊的包罗万象的类（`NSCFType`），就是为此目的而设计的。

# redirect - 我的网站自动重定向到移动设备中不需要的网站

> ID：14351121
> 
> 赞同：0
> 
> 时间：2013-01-16T03:57:11.910
> 
> 标签：redirect, mobile, joomla

我为我的网站使用`JA_Rasite`模板：[www.nll.com.vn](http://www.nll.com.vn)。但是现在当我在 mobie 上访问我的网站时，它会自动重定向到随机（不需要的）网站。有时是色情网站，有时是广告网站。有人有解决这个问题的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:26:16.517

如果您确定它取决于您使用的模板，很可能它已被黑客入侵，首先要做的是重新安装原始的 JA_Rasite 模板包。

当然，您最好检查并保护您的网站以防止进一步的攻击。

# android - StackView 的这些 XML 属性的动态等效项

> ID：14351128
> 
> 赞同：3
> 
> 时间：2013-01-16T03:58:21.893
> 
> 标签：android, stackview

我`StackView`在我的 Android 项目中动态创建一个对象。如何通过代码动态完成以下等效属性？

```
android:animateLayoutChanges="true"
android:loopViews="true" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T04:06:34.897

这是第一个：

[http://developer.android.com/reference/android/view/ViewGroup.html#setLayoutTransition](http://developer.android.com/reference/android/view/ViewGroup.html#setLayoutTransition)

第二个显然没有相关的方法：

[http://developer.android.com/reference/android/widget/AdapterViewAnimator.html#attr_android:loopViews](http://developer.android.com/reference/android/widget/AdapterViewAnimator.html#attr_android:loopViews)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T04:10:21.727

对于 animateLayoutChanges 你可以参考[这个。](http://developer.android.com/reference/android/view/ViewGroup.html#attr_android%3aanimateLayoutChanges)

而对于 loopViews 我没有得到任何方法，但你可以参考[这个。](http://developer.android.com/reference/android/widget/AdapterViewAnimator.html#attr_android%3aloopViews)

希望你明白这一点。您可以在 Android 的开发者网站上轻松搜索任何其他方法/功能及其属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T04:23:12.150

无法更改循环视图，但您可以尝试使用样式通过构造函数传递它。

# java - 在java中填充数组

> ID：14351136
> 
> 赞同：-4
> 
> 时间：2013-01-16T03:59:46.293
> 
> 标签：java

所以基本上我试图用 9 个值填充 array[] 元素，但是我不确定如何在这段代码中获取索引。我希望它每次都填充数组中的下一个元素。

```
public boolean check(int data[][], int x, int y){
int array[] = new int[9];
int xmax = x+3;
int ymax = y+3;

        for(int i = x; i<xmax; i++){
            for(int j = y; j<ymax; j++){
                array[] = data[i][j];//array[what here?]
            }
        }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T04:03:46.887

```
for (int i = x; i < xmax; ++i) {
    for (int j = y; j < ymax; ++j) {
        array[3 * (i - x) + (j - y)] = data[i][j];
    }
} 
```

# iphone - 如何为 iPhone 相机设置最大采样率

> ID：14351138
> 
> 赞同：0
> 
> 时间：2013-01-16T03:59:53.710
> 
> 标签：iphone, camera, frame-rate

我找到了有关如何为 iphone 相机应用程序编程不同帧速率的[参考资料：](https://stackoverflow.com/questions/10344637/capture-60fps-in-iphone-app)

这表明您需要将`videoMinFrameDuration`/设置`videoMaxFrameDuration = CMTimeMake(1,60);`为 60fps。

我找不到任何有关最大 fps 捕获的文档，也找不到捕获分辨率的影响。[此处记录了](https://developer.apple.com/library/mac/#documentation/AVFoundation/Reference/AVCaptureConnection_Class/Reference/Reference.html)该属性，但未提供其他信息。有评论说 ios 5.0.1 的最大帧速率为 59，但不确定最新的帧速率是多少。

另外，我不想保存帧，而是想对帧进行一些计算，然后只存储每种颜色的平均强度。有没有办法使用 AVFoundation 来完成这个而不将数据写入磁盘？

# javascript - 如何使用 document.write 或其他方法将 html 写入页面？

> ID：14351143
> 
> 赞同：0
> 
> 时间：2013-01-16T04:00:11.860
> 
> 标签：javascript, html

我想使用 document.write(string.fromcharcode(encoded html....

```
<html> 
```

# perl - Perl - 通过 fork/exec 传递一个打开的套接字

> ID：14351147
> 
> 赞同：9
> 
> 时间：2013-01-16T04:00:25.597
> 
> 标签：perl, sockets, exec, fork

我想让 Perl 守护进程**监听**并**接受**来自客户端的传入连接，然后**fork** & **exec**另一个 Perl 程序以继续与客户端的对话。

简单地分叉时我可以做到这一点 - 守护程序代码还包含子代码。但是我看不到打开的套接字如何通过 exec() “传递”到另一个 Perl 程序。

不知何故，我觉得这在 Unix（这是我的环境）中很容易，因此在 Perl 中也是如此。真的可以做到吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-16T04:45:17.717

这可以通过大约三个步骤完成：

1.  清除文件描述符上的*close-on-exec标志。*
2.  告诉执行程序使用哪个文件描述符。
3.  将文件描述符恢复为句柄。

**1.** Perl（默认情况下）在它打开的文件描述符上设置 close-on-exec 标志。这意味着文件描述符不会在`exec`. 您必须先清除此标志：

```
use Fcntl;

my $flags = fcntl $fh, F_GETFD, 0 or die "fcntl F_GETFD: $!";
fcntl $fh, F_SETFD, $flags & ~FD_CLOEXEC or die "fcntl F_SETFD: $!"; 
```

**2.**现在文件描述符将保持打开状态`exec`，您需要告诉程序它是哪个描述符：

```
my $fd = fileno $fh;
exec 'that_program', $fd;  # pass it on the command line
# (you could also pass it via %ENV or whatever) 
```

**3.**恢复另一边的文件句柄：

```
my $fd = $ARGV[0];  # or however you passed it
open my $fh, '+<&=', $fd;  # fdopen
$fh->autoflush(1);  # because "normal" sockets have that enabled by default 
```

现在您又拥有了一个 Perl 级别的句柄`$fh`。

*附录：*正如 ikegami 在评论中提到的，您还可以确保套接字正在使用三个“标准”文件描述符之一（0（stdin）、1（stdout）、2（stderr）），它们是 1\. 保持打开状态默认跨 execs，2\. 有已知的数字，所以不需要传递任何东西，3\. perl 会自动为它们创建相应的句柄。

```
open STDIN, '+<&', $fh;  # now STDIN refers to the socket
exec 'that_program'; 
```

现在`that_program`可以简单地使用`STDIN`. 这甚至适用于输出；文件描述符 0、1、2 没有固有的限制，它们只能用于输入或输出。这只是所有 Unix 程序都遵循的约定。

# python-2.7 - 如何获取循环中已计算的总数并将它们加在一起？

> ID：14351148
> 
> 赞同：2
> 
> 时间：2013-01-16T04:00:29.667
> 
> 标签：python-2.7

我在 Python 2.7.3 中创建了这个程序，我在计算机科学课上做了这个。他把它分成两部分。在第一部分，我们必须创建一个程序来计算五个客户的每月手机账单。用户输入使用的文本数、分钟数和数据。此外，还有超额费用。超过限制的每 GB 数据 10 美元，超过限制每分钟 0.4 美元，超过限制发送的每条文本 0.2 美元。500 是短信的限制量，750 是分钟的限制量，2 GB 是计划的数据量限制。

对于作业的第 2 部分。我必须计算征收的总税款、总费用（每个客户账单加在一起）、征收的政府总费用、超额客户总数等。

现在我想要的只是将客户账单加在一起。正如我之前所说，当您运行该程序时，它会打印 5 个客户的总帐单。我不知道如何将这些单独的总数分配给一个变量，将它们加在一起，然后最终将它们打印为一个大变量。

```
TotalBill = 0    
monthly_charge = 69.99
data_plan = 30
minute = 0
tax = 1.08
govfees = 9.12
Finaltext = 0
Finalminute = 0
Finaldata = 0
Finaltax = 0
TotalCust_ovrtext = 0
TotalCust_ovrminute = 0
TotalCust_ovrdata = 0
TotalCharges = 0

for i in range (1,6):
    print "Calculate your cell phone bill for this month"

    text = input ("Enter texts sent/received ")

    minute = input ("Enter minute's used ")

    data = input ("Enter Data used ")
    if data > 2:
        data = (data-2)*10
        TotalCust_ovrdata = TotalCust_ovrdata + 1        
    elif data <=2:
        data = 0
    if minute > 750:
        minute = (minute-750)*.4
        TotalCust_ovrminute = TotalCust_ovrminute + 1
    elif minute <=750:
        minute = 0
    if text > 500:
        text = (text-500)*.2
        TotalCust_ovrtext = TotalCust_ovrtext + 1
    elif text <=500:
        text = 0

    TotalBill = ((monthly_charge + data_plan + text + minute + data) * (tax)) + govfees 
    print ("Your Total Bill is... " + str(round(TotalBill,2))) 

print "The toatal number of Customer's who went over their minute's usage limit is... " ,TotalCust_ovrminute
print "The total number of Customer's who went over their texting limit is... " ,TotalCust_ovrtext
print "The total number of Customer's who went over their data limit is... " ,TotalCust_ovrdata 
```

一些创建的变量没有在程序中使用。请忽略它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-10T06:38:40.227

正如 Preet 建议的那样。

创建另一个变量，例如 TotalBill 即

```
AccumulatedBill = 0 
```

然后在你的循环结束时放。

```
AccumulatedBill += TotalBill 
```

这会将每个 TotalBill 添加到 Accumulated。然后只需在最后打印出结果。

```
print "Total for all customers is: %s" %(AccumulatedBill) 
```

注意：您通常不会在单词的第一个字母的变量上使用大写字母。使用 camelCase 或 underscore_separated。

# django - 对于与 ElasticSearch 的索引文本不完全匹配的查询，您如何获得结果？

> ID：14351153
> 
> 赞同：1
> 
> 时间：2013-01-16T04:01:03.593
> 
> 标签：django, elasticsearch, django-haystack

该字符串已编入索引：“Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua。”

我的查询是：“**你好世界**。Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua。**其他文本。** ”

当我运行查询时，我没有得到任何结果。如果我的查询中有一点“垃圾”文本，我怎样才能得到结果？

我正在使用 Django、Haystack 和 ElasticSearch。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T11:54:27.203

如果您使用带有默认运算符“或”的“匹配”查询，那么您将获得匹配任何单词的命中，但匹配*大量*单词的命中将排在匹配单词*少*的命中之上。

[http://www.elasticsearch.org/guide/reference/query-dsl/match-query.html](http://www.elasticsearch.org/guide/reference/query-dsl/match-query.html)

但是，如果您的意思是您只想匹配那个确切的短语，但允许在任一端添加一些额外的文本，我不确定您是否能做到这一点。

如果您可以放宽对精确短语匹配的要求，一种选择是使用 shingle 令牌过滤器分析文档（和查询）。

[http://www.elasticsearch.org/guide/reference/index-modules/analysis/shingle-tokenfilter.html](http://www.elasticsearch.org/guide/reference/index-modules/analysis/shingle-tokenfilter.html)

然后带有“或”运算符的匹配查询将对单词的对、三元组、四元组等进行操作（取决于过滤器配置）。将 shingle 大小设置为 2 或 3 将使包含许多与查询相同的单词的文档（偶然）不太可能获得高分。

或者您可以使用带有 slop 的短语查询（请参阅上面匹配查询页面的底部）。

不过，这两种方法都允许插入以及前缀/后缀。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T14:44:35.717

Elasticsearch 具有非常强大的[More Like This Query](http://www.elasticsearch.org/guide/reference/query-dsl/mlt-query.html)，它允许您基于文本片段生成查询。

# emacs - 组织模式大纲级别特定的填充列值

> ID：14351154
> 
> 赞同：1
> 
> 时间：2013-01-16T04:01:07.327
> 
> 标签：emacs, org-mode, word-wrap

我想知道是否可以为大纲的不同级别设置不同的填充列值。目前我将其设置为 78，并且对于较低级别 ()，该列的计数方式似乎不同，因此，较低级别的文本超过 78 列。

在邮件列表中提出了同样的问题，但没有回复： http: [//lists.gnu.org/archive/html/emacs-orgmode/2011-05/msg00654.html](http://lists.gnu.org/archive/html/emacs-orgmode/2011-05/msg00654.html)

最好的，俊

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-29T14:12:09.457

我添加了计算 apt 偏移量并调用常规组织填充的函数：

```
(defun calc-offset-on-org-level ()
  "Calculate offset (in chars) on current level in org mode file."
  (* (or (org-current-level) 0) org-indent-indentation-per-level))

(defun my-org-fill-paragraph (&optional JUSTIFY)
  "Calculate apt fill-column value and fill paragraph."
  (let* ((fill-column (- fill-column (calc-offset-on-org-level))))
    (org-fill-paragraph JUSTIFY)))

(defun my-org-auto-fill-function ()
  "Calculate apt fill-column value and do auto-fill"
  (let* ((fill-column (- fill-column (calc-offset-on-org-level))))
    (org-auto-fill-function))) 
```

并在我的 .emacs 中设置 org-mode 以使用此功能（请参阅 org.el、org-setup-filling）：

```
(defun my-org-mode-hook ()
  (setq fill-paragraph-function   'my-org-fill-paragraph
        normal-auto-fill-function 'my-org-auto-fill-function)

(add-hook 'org-load-hook 'my-org-mode-hook)
(add-hook 'org-mode-hook 'my-org-mode-hook) 
```

结果我得到了（所见即所得）：

```
* Top level heading
  This is sufficiently long string, and, as you see fill-column is not far
  from screen edge on the top level.  My fill-column value is 77.

        * Level 5
          Offset is 12 chars on this level, but we set there fill column to
          the 78 - 12 = 66 chars.

                                  * Derived 18 (?)
                                    Auto fill mode works too due to function
                                    my-org-auto-fill-function. 
```

# php - PHP使用函数调用获得的变量检查method_exists是否存在

> ID：14351157
> 
> 赞同：0
> 
> 时间：2013-01-16T04:01:13.060
> 
> 标签：php, function, call

以下 try..catch 旨在运行一个方法（如果存在）并运行不同的方法（如果不存在）。

```
 $heading = new HeadingMan();
        try {
            if (!is_callable($heading->{$this->breadcrumbs->getCrumb(3)}())) {
                throw new Exception ('<b>Error - HeadingMan class can not handle: </b>' . $this->breadcrumbs->getCrumb(3));
            }
            $heading->{$this->breadcrumbs->getCrumb(3)};
        }
        catch (Exception $e) {
            $heading->latest();
        } 
```

但是，catch 语句总是触发，并抛出一个新的异常（运行语句的 catch 部分）。

如何使用一系列函数调用检查类中是否存在方法

```
$this->breadcrumbs->getCrumb(3); 
```

获取函数的名称。？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T04:08:02.813

$bool = method_exists($class,$method);

[http://php.net/manual/en/function.method-exists.php](http://php.net/manual/en/function.method-exists.php)

# objective-c - 有没有办法删除 UITabBar/或为 UIViewController 和所有其他 UIViewcontroller 添加到 UINavigationBar Stack 之上？

> ID：14351159
> 
> 赞同：0
> 
> 时间：2013-01-16T04:01:48.450
> 
> 标签：objective-c, xcode

这是我正在使用的方法：

```
-(void)viewWillAppear:(BOOL)animated
{
    [super viewWillDisappear:animated];
    [self.tabBarController hideTabBar];
}

-(void) viewWillDisappear:(BOOL)animated
{
    [self.tabBarController showTabBar];
    [super viewWillDisappear:animated];
} 
```

使用这种方法，如果我在导航堆栈中添加一些内容，UITabBar 将再次显示。

如果我希望仅在用户导航到另一个选项卡或按下后退按钮时才显示 UITabBar，而不是所有的 viewWillDisappear 情况，该怎么办？

在导航堆栈顶部推送 UIViewController 不应改变这一点

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T10:40:11.293

您也可以使用 NSNotification，因此无论何时需要隐藏标签栏。在那一刻触发将显示/隐藏您的标签栏的通知。

NSNotification 的好处是，您可以在整个应用程序生命周期中触发它，它并不特定于任何视图控制器或任何类。可以独立于任何类/视图控制器使用它。

希望这是您正在寻找的。

问候， Mrunal

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-16T04:08:45.180

在您的视图中执行以下操作将出现方法

```
-(void)viewWillAppear:(BOOL)animated
{
    [super viewWillDisappear:animated];
    self.navigationController.tabBarController.tabBarController.tabBar.hidden=TRUE;
} 
```

这将从特定控制器中删除标签栏。并且导航堆栈不会改变。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T06:45:30.357

这就是我所做的

在 viewDidDisappear，我检查 self.navigationController 是否为空。如果它是空的，我只知道该视图已从导航控制器中弹出，这是将该视图从窗口层次结构中取出的唯一方法。

# jndi - 将 EAP5 迁移到 JBoss7 - 远程调用错误

> ID：14351161
> 
> 赞同：1
> 
> 时间：2013-01-16T04:02:01.723
> 
> 标签：jndi, jboss7.x, ejb-3.1

嗨，这是我的场景，

我正在尝试将应用程序从 JBoss5 迁移到 JBoss7。

我正在使用 jboss-as-7.1.1.Final。

我得到的错误是：

```
No EJB receiver available for handling [appName:,modulename:myapp-ejb,distinctname:] combination for invocation context org.jboss.ejb.client.EJBClientInvocationContext@6b9bb4bb
     at org.jboss.ejb.client.EJBClientContext.requireEJBReceiver(EJBClientContext.java:584) [jboss-ejb-client-1.0.5.Final.jar:1.0.5.Final]
     at org.jboss.ejb.client.ReceiverInterceptor.handleInvocation(ReceiverInterceptor.java:119) [jboss-ejb-client-1.0.5.Final.jar:1.0.5.Final]
     at org.jboss.ejb.client.EJBClientInvocationContext.sendRequest(EJBClientInvocationContext.java:181) [jboss-ejb-client-1.0.5.Final.jar:1.0.5.Final]
     at org.jboss.ejb.client.EJBInvocationHandler.doInvoke(EJBInvocationHandler.java:136) [jboss-ejb-client-1.0.5.Final.jar:1.0.5.Final]
     at org.jboss.ejb.client.EJBInvocationHandler.doInvoke(EJBInvocationHandler.java:121) [jboss-ejb-client-1.0.5.Final.jar:1.0.5.Final]
     at org.jboss.ejb.client.EJBInvocationHandler.invoke(EJBInvocationHandler.java:104) [jboss-ejb-client-1.0.5.Final.jar:1.0.5.Final] 
```

我查看了几个带有相同错误消息的讨论，但我无法弄清楚我做错了什么。

在部署目录中，我只有一个 myapp.war。我不部署 .ear 文件。我有一个作为模块部署的依赖项（myapp-ejb.jar）。

我已按照“迁移 EAP”部分中[https://docs.jboss.org/author/display/AS71/How+do+I+migrate+my+application+from+AS5+or+AS6+to+AS7](https://docs.jboss.org/author/display/AS71/How+do+I+migrate+my+application+from+AS5+or+AS6+to+AS7)中的说明进行操作5 对 AS 7 进行远程调用的已部署应用程序"。

服务器在 myapp-ejb.jar 我有一堆 JNDI 名称，如：

```
public static final String ACCOUNT_REMOTE = "ejb:/myapp-ejb//AccountBean!com.company.myapp.ejb.account.AccountRemote"; 
```

查找是通过调用 myapp-ejb.jar 中定义的这个静态方法从客户端完成的：

```
public static AccountRemote getAccountRemote() throws NamingException {
  if (accountRemote == null){
        InitialContext ic = new InitialContext();
        Object ref = ic.lookup(JNDINames.ACCOUNT_REMOTE); 
        accountRemote = (AccountRemote) PortableRemoteObject.narrow(ref, AccountRemote.class); 
  }
  return accountRemote;
} 
```

所有远程接口都用于无状态 EJB，例如：

```
@Stateless
@Remote(AccountRemote.class)
public class AccountBean implements AccountRemote { 
```

客户端 从 myapp.war 我使用上述静态方法 getAccountRemote() 对 myapp-ejb.jar 进行远程调用。在 myapp.war/WEB-INF 目录中，我添加了一个 jndi.properties 和一个 jboss-ejb-client.properties。

jndi.properties 只包含一个值：

```
java.naming.factory.url.pkgs=org.jboss.ejb.client.naming 
```

jboss-ejb-client.properties 包含：

```
remote.connectionprovider.create.options.org.xnio.Options.SSL_ENABLED=false

remote.connections=default

remote.connection.default.host=localhost
remote.connection.default.port=4447
remote.connection.default.connect.options.org.xnio.Options.SASL_POLICY_NOANONYMOUS=false 
```

我已从standalone.xml 中删除了远程处理的安全领域：

```
<subsystem xmlns="urn:jboss:domain:remoting:1.1">
          <connector name="remoting-connector" socket-binding="remoting" />
</subsystem> 
```

我已将 JBOSS_HOME/bin/client/jboss-client.jar 添加到 myapp.war/WEB-INF/lib。

应用程序成功部署，没有任何错误，但是当我启动 localhost:8080/ 时，我得到 No EJB 接收器可用于处理错误。

有谁知道我错过了什么？有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-24T12:22:37.497

如果您使用 JBOSS 作为您的应用服务器，您实际上并不需要**jboss-client.jar 。**请将以下属性添加到您的 initialContext 或 jndi.propeties 文件中，一切都会好起来的。

```
jboss.naming.client.ejb.context=true 
```

除非您从独立客户端或 Jboss 以外的服务器调用，否则请删除该属性。

```
java.naming.factory.url.pkgs=org.jboss.ejb.client.naming 
```

尝试使用这些设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-21T11:43:16.897

```
"EJB client API approach" for remote EJB invocation from one node to another node in clustered JBOSS:
------------------------------------------------------------------------------------
1\. To call EJB from remote location we need to enable "remoting-ejb-receiver" on server side.
    Please refer to “standalone_changes.xml” to know change details.
2\. Also we need to register the "remoting-ejb-receiver" to the application, so that the application can receive remote EJB.
    Please refer to “jboss-ejb-client.xml” section.
3\. Now we need to call remote EJB in "EJB client API approach" way, which needs to have JNDI name pattern as:
  ejb:<app-name>/<module-name>/<distinct-name>/<bean-name>!<fullclassname-of-the-remote-interface>
  In our case it will be: ejb:myapp-ejb//node1/AccountBean!com.company.myapp.ejb.account.AccountRemote
  Important to note that identification to remote location IP address is not based on InitialContext as InitialContext will not contain any IP address as normally happens with "remote://URL:Port".
  The remote location identification is based on <distinct-name> passed in JNDI. JBOSS will internally identify the remote IP based on <distinct-name>.
  Hence is required to provide unique <distinct-name> to the application running on different nodes.
  Add "<distinct-name>${jboss.node.name}</distinct-name>" to “jboss-app.xml”. Make sure that jboss.node.name property is always unique.
  But then jboss.node.name should be added as environmental property while server startup.
  For test purpose we can provide hardcoded value like: 
        For node1: "<distinct-name>node1</distinct-name>" to “jboss-app.xml”.
        For node2: "<distinct-name>node2</distinct-name>" to “jboss-app.xml”.

standalone_changes.xml:
------------------------------------------------------------------------------------
   <subsystem xmlns="urn:jboss:domain:remoting:1.1">
        <outbound-connections>
            <remote-outbound-connection name="remote-ejb-connection-host2" outbound-socket-binding-ref="remote-ejb-host2" username="xxx" security-realm="ejb-security-realm">
                <properties>
                    <property name="SASL_POLICY_NOANONYMOUS" value="false"/>
                    <property name="SSL_ENABLED" value="false"/>
                </properties>
            </remote-outbound-connection>
            ...........
            ...........
        </outbound-connections>
    </subsystem>
    ...........
    ...........
    <socket-binding-group name="standard-sockets" default-interface="public" port-offset="${jboss.socket.binding.port-offset:0}">   
        <outbound-socket-binding name="remote-ejb-host2">
            <remote-destination host="${jboss.ejb.host2}" port="${jboss.ejb.host2.port}"/>
        </outbound-socket-binding>
        ...........
        ...........
    </socket-binding-group>
    ...........
    ...........
    <management>
        <security-realms>
            <security-realm name="ejb-security-realm">
                <server-identities>
                    <secret value="${jboss.ejb.remoting.password}"/>
                </server-identities>
            </security-realm>
            ...........
            ...........         
        </security-realms>
    </management>

jboss-app.xml:
------------------------------------------------------------------------------------
<?xml version="1.0" encoding="UTF-8"?>
<jboss-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.jboss.com/xml/ns/javaee">
    <distinct-name>node1</distinct-name>
    <security-domain>xyz</security-domain>
    <unauthenticated-principal>guest</unauthenticated-principal>
    <library-directory>lib</library-directory>
</jboss-app>

jboss-ejb-client.xml
------------------------------------------------------------------------------------
<jboss-ejb-client xmlns="urn:jboss:ejb-client:1.0">
    <client-context>
        <ejb-receivers>
            <remoting-ejb-receiver outbound-connection-ref="remote-ejb-connection-host2"/>
            <!-- <remoting-ejb-receiver outbound-connection-ref="${jboss.remote.outbound.connection.host3}"/> -->
        </ejb-receivers>
    </client-context>
</jboss-ejb-client>

For more details refer to:
"https://docs.jboss.org/author/display/AS71/Remote+EJB+invocations+via+JNDI+-+EJB+client+API+or+remote-naming+project" which tells us different way of remote EJB location. 
```

# c# - 构建动态且不对称的多级层次结构树

> ID：14351164
> 
> 赞同：0
> 
> 时间：2013-01-16T04:02:12.707
> 
> 标签：c#, wpf, xaml, telerik, hierarchy

我什至不知道从哪里开始。我可以建立一个有父母和孩子的telerik树，但我不知道如何在它并不总是对称的地方制作它。这是一个验证树，因此它会告诉用户错误消息。例如，它应该如下所示：

```
Object ID (Main Property)
- Must start with a number (Description)
Employee Name (Main Property)
   Employee 1 (SubProperty)
       - Cannot be blank (Description)
   Employee 2 (Subproperty)
       - Cannot be blank (Description) 
```

对此的任何帮助或将引导我朝着正确方向前进的任何帮助都会有所帮助。这是我第一次在 WPF/C# 中使用树，所以请善待哈哈。

编辑：因为我同意这是非常模糊的：附件是我的代码的图像。因为我正在通过一个虚拟机，所以我不得不做屏幕截图。

视图模型库： ![在此处输入图像描述](../Images/4424d45e75fc92246c07e7107461bba6.png)

视图模型续： ![在此处输入图像描述](../Images/f68044dc93a4c94693cfe5786a3115ed.png)

XAML：

![在此处输入图像描述](../Images/7f62f82950821cd64d60346f46fb8775.png)

验证信息： ![在此处输入图像描述](../Images/5d106ce89d481fca98de3d8ce3308e75.png)

无效属性： ![在此处输入图像描述](../Images/4580d96703ed7aebe8cac10f9a9119fc.png)

如果您需要查看任何其他特定代码，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T04:22:26.520

这是一个有点模糊的问题，但是类定义如下；

```
class ValidationNode
{
    bool IsValid { get; }
    object EntityToValidatate { get; set; }
    string ErrorMessage { get; set; }

    ValidationNode Parent { get; set; } 

    IList<ValidationNode> Children { get; set; }
} 
```

听起来像你想从什么开始？每个节点可以有 N 个子节点，每一步都有某种附加的验证逻辑。

毫无疑问，这不会完全回答您的问题，建议您在此处添加更多信息。

# javascript - 合并和导出多个文本区域？

> ID：14351168
> 
> 赞同：1
> 
> 时间：2013-01-16T04:02:39.460
> 
> 标签：javascript, html

我是 javascript 的新手，想知道是否有任何方法可以在新窗口中将几个 s 的内容合并到一个 textarea 中？

我有一个文档，用户当前必须在其中分别复制/粘贴不同文本区域的内容。我希望他们可以选择单击按钮来生成它。

我浏览了这个论坛并设法接近使用：

```
<input type="button" value="combine" onclick="document.getElementById('textarea3').value=document.getElementById('textarea2').value+' '+document.getElementById('textarea3').value" /> 
```

但是，我只是成功地将这两个文本区域组合到同一页面上的另一个文本区域。我无法将此 onclick 事件与 newWindow 函数结合使用以生成带有预期文本的干净页面。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T04:11:27.920

您必须将组合 textarea 的值传递给某个持久变量。我会建议使用 localStorage。下面是一些例子：

第一页

```
<script type="text/javascript"> 
function combine(){
    // store your text to localStorage when someone click the link
    var textToPass=document.getElementById('textarea2').value+' '+document.getElementById('textarea3').value;
    localStorage.setItem("myText", textToPass);
}

</script>
<a onclick="combine()" href="secondPage.html" id="link">Go to second page</a> 
```

在第二页上，将此脚本块放在正文的底部

```
<script type="text/javascript"> 
var myText = localStorage.getItem("myText");
document.getElementById('textarea3').value = myText;
</script> 
```

# jquery - li 点击事件未触发

> ID：14351172
> 
> 赞同：1
> 
> 时间：2013-01-16T04:02:58.710
> 
> 标签：jquery

我有以下 HTML：

```
<ul id="tags">
<li class="tab1 tabactive">New Arrivals</li>
<li class="tab2" id="hot-home">Best Deals</li>
<li style="border-right: 0;" class="tab3">Today's Sale</li>
</ul> 
```

我在 Firebug 中添加了以下内容：

```
jQuery('#tags li').click(function(){
alert("Hello dreamdu!");
 }); 
```

当我单击 LI 时，警报没有显示，谁能帮我理解为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T04:08:53.003

查看您的网站，带有 ID 的 div 似乎位于您的元素`tagContent`之上。`tags`您的代码很好，您只需要修复您的 CSS 以便可以实际点击您想要的元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T04:12:01.000

```
You can Refer 
```

[将事件绑定到 li](https://stackoverflow.com/questions/835993/jquery-add-click-event-to-li-or-span-elements)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T04:15:20.183

试试这个对我有用的代码。我在你的页面上试过了。

```
jQuery(document).ready(function($){
$("#con > ul li").click(function(){
 alert("working");
});
}); 
```

# iphone - 如何在 iOS 上通过 OpenGL ES 镜像图像数据

> ID：14351178
> 
> 赞同：0
> 
> 时间：2013-01-16T04:03:32.953
> 
> 标签：iphone, ios, opengl-es

我正在越狱设备上开发一个工具。我通过 IOSurfaceGetBaseAddress 获得了一个帧缓冲区，它提供了一个镜像数据。所以我想把图像镜像回来。逐个像素地反转它太慢了，所以我想用OpenGL ES来镜像它。有人有这种示例代码吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T04:14:43.740

您可以渲染纹理的背面。然后，像素在水平方向上反转。

# java - 某处有Java概率库吗？

> ID：14351182
> 
> 赞同：0
> 
> 时间：2013-01-16T04:03:46.820
> 
> 标签：java, random, probability

例如，允许我创建一个具有指定 lambda 的泊松随机变量并用它生成随机数，或者从离散的联合概率分布函数计算边际？

还是我应该自己滚动？（这只是为了好玩，我只是想玩一下概率，所以还没有实际用途:)）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T04:12:09.507

[Commons Math](http://commons.apache.org/math/)有一个名为[PoissonDistribution](http://commons.apache.org/math/api-3.1.1/org/apache/commons/math3/distribution/PoissonDistribution.html)的类，您可以从中采样随机值`sample()`

另外，如果你想玩概率，你应该看看[R](http://www.r-project.org/)，一种为概率编程定制的语言（它似乎也有一个[非常活跃的 SO 存在](https://stackoverflow.com/questions/tagged/r)）

# objective-c - 如何在 Objective-C 中将枚举转换为字节数组？

> ID：14351186
> 
> 赞同：0
> 
> 时间：2013-01-16T04:04:14.340
> 
> 标签：objective-c

我有一个枚举，我想将它的一个值传递给一个期望`char *`直接而不是创建另一个变量的 Objective-C 方法。我该怎么办？

例如

```
typedef enum { value1 = 0xAA, value2 = 0xBB, value3 = 0xCC } myValue;

NSMutableData *data = [[NSMutableData alloc] init];

// want to pass in the enum directly as char * but won't work

[data appendBytes:(char *){ value1 } length: 1];

// this will work, why? and is this the best way?

[data appendBytes:(char []){ value1 } length: 1]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T04:26:32.597

您使用的示例将`(char[]){value1}`a`char*`指向`value1`解释为 a`char`是完全合法的。等效代码可能看起来像

```
char achar = value1;
[data appendBytes:&achar length:1]; 
```

但是你`(char[]){value1}`的代码显然少了一行，所以我说去吧。

* * *

对于任何困惑的人来说，`(char[]){value1}`是一个[复合文字](http://gcc.gnu.org/onlinedocs/gcc/Compound-Literals.html)。这是一种将任何类型的值（包括聚合）构造为表达式的方式。在这种特殊情况下，它构造了一个 s 数组，`char`初始化器包含一个元素，因此它构造了 a `char[1]`，然后在传递给方法时将其隐式转换为指针。有趣的是，您甚至可以获取复合文字的地址（尽管该地址仅对找到复合文字的完整表达式有效），因此在这种情况下等效为`&(char){value1}`.

# unix - 以不同于 ssh 密钥所有者的用户身份使用 rsync+ssh+public 密钥同步本地和远程目录

> ID：14351190
> 
> 赞同：8
> 
> 时间：2013-01-16T04:04:31.127
> 
> 标签：unix, deployment, permissions, ssh, rsync

目标是通过 ssh 同步本地和远程文件夹。

我当前的用户是*user1*，并且我通过 ssh 对服务器*server1*进行了无密码访问设置。我想通过**rsync**实用程序将本地文件夹与*server1上的文件夹同步。*通常我会运行：

 **```
rsync -rtvz /path/to/local/folder server1:/path/to/remote/folder 
```

**ssh**访问按预期工作，**rsync**能够通过**ssh**连接，但它返回“Permission denied”错误，因为在*server1*上，该文件夹`/path/to/remote/folder`归*user2*拥有：*user2*。文件夹的文件权限不允许其他任何人更改。 *user1是**server1*上的 sudoer，因此在**ssh**会话期间工作。**ssh**到服务器时如何强制**rsync**切换用户？`sudo su - *user2*`

 ******将*user1*添加到组*user2*不是一个选项，因为服务器上的所有用户/组管理都是自动完成的，并且每 X 分钟从中央存储库复制一次，我无法访问。

更改目标文件夹的权限/所有权也是如此：它会定期自动更新，并重置所有权限。

我想到的可能解决方案是一个脚本，它将本地文件夹与服务器上*user1*拥有的临时中间远程文件夹同步，然后将两个远程文件夹同步为*user2*。

谷歌搜索更短更漂亮的解决方案并没有取得任何成功。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T23:51:56.537

我自己没有尝试过，但是使用 rsync 的 '--rsync-path' 选项怎么样？

```
rsync -rtvz --rsync-path='sudo -u user2 rsync' /path/to/local/folder server1:/path/to/remote/folder 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T21:49:50.183

要解决权限问题，您需要在以 user2 身份远程登录的 SSH 会话上运行 rsync：

```
rsync avz -e 'ssh -i privatekeyfile' /path/to/local/folder/ user2@server1:/path/to/local/folder 
```

以下答案解释了如何设置 SSH 密钥。

*   [Ant，从远程机器下载文件集](https://stackoverflow.com/questions/12191713/ant-download-fileset-from-remote-machine/12206460#12206460)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T04:20:08.403

*为user1*设置无密码访问权限以访问*user2@server1*，然后执行：

```
rsync -rtvz /path/to/local/folder user2@server1:/path/to/remote/folder 
```********

# c++ - 带有引用参数的 C++ 模板隐式实例化

> ID：14351191
> 
> 赞同：4
> 
> 时间：2013-01-16T04:04:32.610
> 
> 标签：c++, templates

在下面的简单示例中，我预计输出将是“2222”。但是 VC++ 11.0 和 g++ 4.6.1 的实际输出都是“2122”。

```
#include <iostream>

template <class T>
void func(T x)
{
    x = 2;
    std::cout << x;
}

int main()
{
    int x = 1;

    func((int &)x);
    std::cout << x;

    func<int &>(x);
    std::cout << x;

    return 0;
} 
```

我反汇编发现第一个func调用func((int &)x)使用了func<int>而不是func<int &>。这是为什么以及如何发生的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T04:08:31.430

模板类型参数推导就是这样工作的。强制转换为`int&`无效，因为变量`x`已经是左值。当参数是左值且参数不是引用时，模板类型推导将推导类型不是引用。

# objective-c - 如何在 NSScrollView 中更改 NSTableView？

> ID：14351193
> 
> 赞同：0
> 
> 时间：2013-01-16T04:04:55.010
> 
> 标签：objective-c, cocoa, nstableview, nsscrollview

我正在构建一个简单的数据库查看器，对于不同的表，`database`我需要`TableViews`在我的主表单上有所不同（具有固定列的标识符和计数）。那么我怎样才能以编程方式改变 `NSTableView`呢`NSScrollView`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T04:14:04.743

试试这个：[scrollView setDocumentView:YOUR_TABLEVIEW];

# html - 如何在 HTML(CSS) 中显示 XML 数据(列表)

> ID：14351194
> 
> 赞同：0
> 
> 时间：2013-01-16T04:05:07.957
> 
> 标签：html, css

我想建立一个网站，它有两个“表”来显示两个存储在 XML 中的数据列表。类别和项目（想想待办事项列表。一个类别有多个项目）

我不确定如何显示数据列表。我应该使用什么样的具体技术？我只能使用 HTML 和 CSS 来实现吗（我朋友说我必须使用 javascript）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T04:16:18.780

你需要为此目的使用 AJAX。AJAX 代表 Asynchronous Javascript XML... 这将帮助您将 XML 数据加载到网页上

# cordova - 非移动浏览器中的 ChildBrowser，用于测试/调试

> ID：14351201
> 
> 赞同：1
> 
> 时间：2013-01-16T04:05:57.020
> 
> 标签：cordova, webview, childbrowser, ripple

我正在编写一个 PhoneGap/Cordova 应用程序，并且正在使用**ChildBrowser**插件打开类似于 iOS 或 Android 中的 WebView 的页面。我经常在本地浏览器（通常是 Chrome）上测试我的网页，因为在本地查看我的页面比将其部署到设备或模拟器上要快得多。使用浏览器还允许我利用调试工具，例如 Chrome 的 Inspect 功能或 Firefox 的 Firebug 插件。

问题是 ChildBrowser 插件无法在非移动平台上运行。是否有任何解决方法可以让我在将 ChildBrowser 部署到设备/模拟器之前对其进行测试？

顺便说一句，使用**Ripple**对我不起作用，因为 Ripple 尚不支持 ChildBrowser。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T05:57:13.237

我会使用设备模型来检测打开页面的内容，放置一个 if 语句来说明它是否不是电话设备，然后正常打开页面并绕过子浏览器。

[http://docs.phonegap.com/en/2.3.0/cordova_device_device.model.md.html#device.model](http://docs.phonegap.com/en/2.3.0/cordova_device_device.model.md.html#device.model)

# javascript - 应用程序级别的 PageLoaded 事件处理程序

> ID：14351204
> 
> 赞同：-1
> 
> 时间：2013-01-16T04:06:28.093
> 
> 标签：javascript, windows-8

在我的 Windows 8 应用程序中，我需要在加载页面时运行一些代码，但我需要在我的 default.js 文件中的应用程序级别运行它。当页面加载到 DOM 时，我可以使用一个事件来一般附加到该事件吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T05:43:42.977

在 default.js 中，已经有对[WinJS.Navigation](http://msdn.microsoft.com/en-us/library/windows/apps/br229778.aspx)的引用，因此您可以执行以下操作：

```
nav.addEventListener("navigated", function (e) { 
     console.log('loaded a new page ' + e.detail.location); 
}); 
```

当您从一个页面导航到另一个页面而不是实际加载到 DOM 时，这将触发（不确定您的意思有多具体）。

如果您希望在真正将页面加载到 DOM 时发生某些事情，您可以在页面中添加覆盖[加载](http://msdn.microsoft.com/en-us/library/windows/apps/hh770588.aspx)，然后调用[WinJS.Application](http://msdn.microsoft.com/en-us/library/windows/apps/br229774.aspx)上的方法，例如（其中`unload`是您已经获得的页面代码的一部分生成）

```
 load: function()
    {
        WinJS.Application.doSomething();
    },

    unload: function () {
        this._items.dispose();
    }, 
```

在 app.js 中的应用程序代码中，您将拥有

```
 app.doSomething = function () { console.log("I did something"); } 
```

虽然我正在追捕这里有一个小故障。一旦我覆盖[load](http://msdn.microsoft.com/en-us/library/windows/apps/hh770588.aspx)，我会在第二次调用时看到 HierarchyRequestError 。

# jquery - jQuery xpath 选择器

> ID：14351208
> 
> 赞同：1
> 
> 时间：2013-01-16T04:07:01.930
> 
> 标签：jquery, xpath, jquery-selectors

好的，所以我有一个带有单选按钮的元素，当单击添加按钮时我克隆了这个元素；但是，一旦我这样做，初始元素上的按钮就会被取消选中。我知道为什么会发生这种情况，但是一旦我开始实施一项工作，它就不像我预期的那样做。

这是我的解决方案：

```
 //This stores the value of the checked element into a variable before the clone
    var radioKeep = $('input.event'+(numOfParts-1)+':checked').val();

    //Cloned the element passed into the function
    $(element).parent().clone(true, false).insertAfter($(element).parent()); 
```

然后在克隆之后，我尝试确保使用以下 jquery 和 xpath 的组合重新检查初始单选按钮。

```
 $('input.event'+(numOfParts-1)+'[@value='+radioKeep+']').attr('checked', 'checked'); 
```

结果是检查了所有的无线电元素……为什么？？？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T06:51:15.207

当您克隆元素时，新元素与旧元素具有相同的值和类，然后您设置它们的检查值，但是只能检查一个，因此最后一个接受检查。.first 会解决这个问题

```
$('input.event'+(numOfParts-1)+'[@value='+radioKeep+']').first().attr('checked', 'checked'); 
```

但是，如果您使用比 1.3.2 更新的 jquery，这仍然不起作用，因为在 1.3.2 中删除了 xpath 支持，只需删除`@`

```
$('input.event'+(numOfParts-1)+'[value='+radioKeep+']').attr('checked', 'checked'); 
```

现在我们有一个可能的未来证明问题，你`.attr()`用来设置一个属性，你真的应该使用它`.prop("checked", true)`。

```
$('input.event'+(numOfParts-1)+'[value='+radioKeep+']').prop('checked', true); 
```

如果这不能解决您的问题，我建议发布示例 html 和一个我们可以用来测试您的代码的工作函数。由于缺少周边功能和缺少html，我这里做了很多假设。

# python - SQLAlchemy 选择所有多对多关系对象作为列表

> ID：14351210
> 
> 赞同：6
> 
> 时间：2013-01-16T04:07:02.590
> 
> 标签：python, sqlalchemy, flask, flask-sqlalchemy

鉴于这种多对多关系：

```
tagmap = db.Table('tagmap', db.Model.metadata,
    db.Column('post_id', db.Integer, db.ForeignKey('posts.id'),
    db.Column('tag_id', db.Integer, db.ForeignKey('tags.id'),)

class Post(db.Model):
    __tablename__ = 'posts'
    id    = db.Column(db.Integer, primary_key=True)
    text  = db.Column(db.Text)
    tags  = db.relationship('Tag', secondary=tagmap, backref='posts')

class Tag(db.Model):
    __tablename__ = 'tags'
    id    = db.Column(db.Integer, primary_key=True)
    name  = db.Column(db.String) 
```

您将如何构造一个查询来选择所有帖子，包括关联标签对象的可迭代列表？

所需的查询结果结构：

```
[ <Post 1, "Blah",      [<Tag "Goober">, <Tag "Mexico">]>,
  <Post 2, "Daft Punk", [<Tag "French">]>,
  <Post 3, "Slurpee",   [<Tag "Diabetes">, <Tag "Tasty">, <Tag "Sugary">]>,
  <Post 4, "Lasers",    []> ] 
```

Jinja 模板中期望的结果用法示例：

```
{% for post in posts %}
    {{ post.text }}
    <hr>
    {% for tag in post.tags %}
        {{ tag.name }}, 
    {% endfor %}
{% endfor %} 
```

**编辑**：

尝试扩展查询时，不再包含标签。请参阅下面的失败查询：

```
Post.query.join(User)\
    .options(db.joinedload(Post.tags))\
    .order_by(Post.create_date.desc()).limit(5)\
    .values(User.name.label('author'),
            Post.create_date,
            Post.text,) 
```

**编辑 2**：

所以这个查询很好用：

```
posts = db.session.query(Post, User.name.label('author')).join(User)\
            .options(db.joinedload(Post.tags))\
            .order_by(Post.created.desc()).limit(5) 
```

但如果我想对 Post 中的列有选择性，我选择：

```
# I only need the post text, nothing else
posts = db.session.query(Post.text, User.name.label('author')).join(User)\
            .options(db.joinedload(Post.tags))\
            .order_by(Post.created.desc()).limit(5) 
```

它开始迅速瓦解：

```
ArgumentError: Query has only expression-based entities - can't find property named 'tags'. 
```

所以我尝试添加标签：

```
# Yes, I know this is wrong
posts = db.session.query(Post.text, Post.tags, User.name.label('author'))\
            .join(User)\               
            .options(db.joinedload(Post.tags))\
            .order_by(Post.created.desc()).limit(5) 
```

仍然失败。

因此，如果您只想要父对象（Post）中的特定列，那么您在表达式中的哪个位置说“我仍然想要标签”？

现在它并不那么重要，但我认为知道它会很有用。或者甚至知道这是不可能的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-16T12:06:11.890

我假设您想对关系使用**急切加载**。您可以通过在与or`lazy`的关系中设置关键字参数来实现：`'joined'``'subquery'`

```
class Post(db.Model):
    # ...
    tags = db.relationship('Tag', secondary=tagmap, backref='posts',
                           lazy='joined')    # Or lazy='subquery' 
```

或者您可以为每个查询设置它：

```
q = Post.query.options(db.joinedload(Post.tags)).all()
# Or db.subqueryload(Post.tags) 
```

有关更多详细信息，请参阅 ORM 教程的[Eager Loading](http://docs.sqlalchemy.org/en/latest/orm/loading_relationships.html#joined-eager-loading)部分和[关系加载技术](http://docs.sqlalchemy.org/en/latest/orm/loading_relationships.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T07:04:17.697

SQLAlchemy 会在您访问它时自动加载该`post.tags`属性，因此您只需要加载您想要的所有帖子。

`db.Column('tag_id', db.Integer, db.ForeignKey('quotes.id'),)`

那`quotes.id`是错字吗？

# backbone.js - 如何使用主干和下划线仅呈现值？

> ID：14351216
> 
> 赞同：0
> 
> 时间：2013-01-16T04:07:46.550
> 
> 标签：backbone.js, underscore.js, template-engine

我已经准备好 html 标记，这不会改变，我只想在这个标记中添加/更新变量。

我如何使用主干和下划线来做到这一点？

我尝试了以下方法，

**骨干：**

```
testView = Backbone.View.extend({
    initialize: function(){
        this.render();
    },

    render: function(){
        var variables = {reqNumber: 10};
        /*This is where I'm having problems, how do I use only variables in my template??
        * How do I write this next line
        */
        var template = _.template(this.$el.html(), variables);

        this.$el.html(template);
    }
});

var test_view = new testView({ el: $("div.container") }); 
```

**HTML：**

```
<a href="#">
    <i class="icon-home icon-white"></i> 
    Requests <span class="badge badge-warning"><%= reqNumber %></span>
</a> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T04:47:08.487

像这样的东西有效。问题是，您没有确定模板在哪里 this.$el 指向视图的容器，而不是模板（请参阅模板脚本）。

JS：

```
$(function() {
    var testView = Backbone.View.extend({
        initialize: function(){
            this.render();
    },
    render: function(){
        var variables = {'reqNumber': '10'};
        var template = _.template($('#test-templ').html(), variables);

        this.$el.html(template);
   }
   var test_view = new testView({ el: $("div.container") });});
}); 
```

HTML：

```
<script id="test-templ" type="text/html">
    <a href="#">
        <i class="icon-home icon-white"></i> 
        Requests <span class="badge badge-warning"><%= reqNumber %></span>
    </a>
</script>   
<div class="container"></div> 
```

# regex - 如何找到用于分隔字符串的正则表达式

> ID：14351227
> 
> 赞同：-1
> 
> 时间：2013-01-16T04:08:59.937
> 
> 标签：regex, linux

我有这个文件

```
xorg-fonts-misc-1.0b-1
Xorg-font-bitstream-75dpi-1.0.0-2.i386
Xorg-font-bitstream-100dpi-1.2a-2.arm
Other-Third-Party-1.2.2-1-any 
```

我想分开并想要这样的输出

```
xorg-fonts-misc-               1.0b-1
Xorg-font-bitstream-75dpi-     1.0.0-2.i386
Xorg-font-bitstream-100dpi-    1.2a-2.arm
Other-Third-Party-             1.2.2-1-any 
```

我试过这个

`-[^a-zA-Z][0-9\.\w-]+[^a-zA-Z][\w-]*?[\d\w]*\n`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T04:18:29.957

这会将您的文本放入两个匹配的组中。我在两组之间放置了空格，但如果你愿意，你可以在其中放置制表符或其他任何东西

```
/^(.*?)((\d[a-z]?\.)+.*)$/\1    \2/gmi 
```

[regex101](http://regex101.com/r/fS5uX3)是测试正则表达式的好地方。该链接包含正则表达式和您的测试输入，并完整说明了正则表达式的工作原理

# android - Android - 拖放图像视图（仅在受限区域中的拖放区）

> ID：14351229
> 
> 赞同：3
> 
> 时间：2013-01-16T04:09:17.137
> 
> 标签：android, drag-and-drop, android-imageview

我正在我的项目中进行拖放`imageview`。它工作正常。但我只想`imageview`特别删除`Layout`。例如，如果我有一个线性布局的 id->l1 和另一个线性布局的 id->l2。图像视图可以拖到两个布局中，但放置区域必须在第一个线性布局内（id->11）。id->l2 的第二个线性布局不能是拖动图像视图的放置区。

我很感激有关如何实现这一点的见解。

# c# - 内存泄漏，文件正在被另一个进程异常使用

> ID：14351230
> 
> 赞同：0
> 
> 时间：2013-01-16T04:09:18.437
> 
> 标签：c#, .net, memory-leaks, exception-handling, filesystemwatcher

这个应用程序似乎吃了很多内存。也许我没有正确管理内存。有人可以弄清楚需要优化哪些代码。其次，文件复制无法正常工作。它有时会引发异常，无法访问另一个进程正在使用的文件，这个异常在监视文件夹和我正在复制的目标文件夹的两端都被抛出。让我简要介绍一下我在这里想要实现的目标。

我有一个系统，它会给我一个 ansi 格式的 xml 文件。这个文件会定期更新，可能每 3-4 分钟有时甚至 10-20 秒。现在我正在查看这个文件夹，一旦它被更改，我将它转换为 UTF-8 并通过 sftp 将它复制到另一台服务器。此 sftp 文件夹映射到发生转换的同一台机器上。所以我面临的问题是它抛出的异常，无法访问另一个进程正在使用的文件，一段时间后这个 get 被清除。甚至内存异常，即系统内存不足。它也在泄漏内存。从 5k 开始，几个小时后达到 1.2gb 的内存使用量。现在我需要运行 3 个类似的程序来观看 3 个不同的文件夹。我的问题有任何线索吗？

```
class Test
{
    class Class1
    {
        private static FileSystemWatcher watcher = new FileSystemWatcher();

        public static void Main()
        {
            WatchFile();
            Console.ReadLine();
        }

        private static void WatchFile()
        {
            watcher.Path = @"c:\test";
            watcher.NotifyFilter = NotifyFilters.LastWrite;
            watcher.Filter = "*.xml";
            watcher.Changed += new FileSystemEventHandler(convert);
            watcher.Error += new ErrorEventHandler(WatcherError);
            watcher.EnableRaisingEvents = true;

            Console.WriteLine("Press \'q\' to quit.");
            Console.WriteLine("Press \'q\' to quit.");
            while (Console.Read() != 'q') ;
        }

        public static string CrL = "\r\n";

        private static void convert(object source, FileSystemEventArgs f)
        {
           string FileName = f.FullPath;
           string destinationFile = @"z:\xml\test.xml";

           Thread.Sleep(2000);
           try
           {
                watcher.EnableRaisingEvents = false;
                Encoding utf8 = new UTF8Encoding(false);
                Encoding ansi = Encoding.GetEncoding(1256);
                Thread.Sleep(2000);

                string xml = File.ReadAllText(FileName, ansi);
                XDocument xmlDoc = XDocument.Parse(xml);
                File.WriteAllText(FileName, @"<?xml version=""1.0"" encoding=""utf-8""?>" + xmlDoc.ToString(), utf8);

                 if (File.Exists(destinationFile))
                     File.Delete(destinationFile);
                 File.Copy(FileName, destinationFile,true);
                 Console.WriteLine("File Copied"); // for troubleshoooting only
                 Console.Write(CrL);
            }
            catch (Exception e)
            {
                Console.WriteLine("The process failed: {0}", e.ToString());
            }
            finally
            {
                watcher.EnableRaisingEvents = true;
            }
        }

        private static void WatcherError(object source, ErrorEventArgs e)
        {
            Exception watchException = e.GetException();
            watcher = new FileSystemWatcher();
            while (!watcher.EnableRaisingEvents)
            {
                try
                {
                    WatchFile();
                    Console.WriteLine("I'm Back!!");
                }
                catch
                {
                    Thread.Sleep(2000);
                }
            }
        }
    }  
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T04:38:07.247

~~每次遇到错误时，都会`WatchFile()`再次调用，这会将`convert`and`WatcherError`方法再次添加到`Changed`and`Error`调用列表中。这可以解释缓慢的内存泄漏。委托调用列表不断增长。~~

由于事件是在池线程上引发的，因此您的代码可能会同时处理多个更改的事件。

~~您的错误处理程序应该只是重新启用事件（即`Watcher.EnableRaisingEvents = true;`）它当然不应该再次添加事件处理程序。~~

您还需要在您的`convert`方法中同步访问。您可以使用锁来执行此操作，但可能更好的主意是使用`Monitor.TryEnter`，如下所示：

```
private static object lockObject = new Object();
private static void convert(object source, FileSystemEventArgs f)
{
    if (!Monitor.TryEnter(lockObject))
    {
        // unable to get lock, return.
        return;
    }
    try
    {
        // do stuff here
    }
    finally
    {
        Monitor.Exit(lockObject);
    } 
```

# javascript - 带有启动图像的 flowplayer 不使用嵌入代码

> ID：14351234
> 
> 赞同：0
> 
> 时间：2013-01-16T04:10:18.127
> 
> 标签：javascript, html, video-streaming, flowplayer

我已经配置了一个带有 RTMP 流和嵌入代码生成功能的 flowplayer，嵌入代码生成使用基于对象的方法，主要问题是，我无法在嵌入代码中添加启动图像，我已经搜索了很多但得到任何解决方案。如果有人知道如何在 flowplayer 嵌入代码上添加启动图像，请在此线程中发布您的宝贵建议。

```
<object data="http://adultseotraining.com/player/flowplayer.commercial-3.2.15.swf" height="400" id="undefined" name="undefined" type="application/x-shockwave-flash" width="730">
  <param name="movie" value="http://adultseotraining.com/player/flowplayer.commercial-3.2.15.swf"/>
  <param name="allowfullscreen" value="true"/>
  <param name="allowscriptaccess" value="always"/>
  <param name="flashvars" value="config={"key":"#$4ce811ab676ba73755d","clip":{"autoPlay":false,"provider":"rtmp","connectionProvider":"secure","autoBuffering":true,"url":"mp4:test.mp4"},"plugins":{"rtmp":{"url":"http://adultseotraining.com/player/flowplayer.rtmp-3.2.11.swf","netConnectionUrl":"rtmpe://142.4.13.20:1935/vod"},"secure":{"url":"http://adultseotraining.com/player/flowplayer.securestreaming-3.2.8.swf","token":"R%23Mk%25F5%256d@1E0%23wa"},"gatracker":{"url":"http://adultseotraining.com/player/flowplayer.analytics-3.2.8.swf","events":{"all":false,"resume":"Unpause","mute":false,"unmute":false},"debug":false,"accountId":"UA-37520370-1"},"controls":{"url":"http://adultseotraining.com/player/flowplayer.controls-3.2.14.swf","backgroundGradient":"none","sliderColor":"#FFFFFF","sliderBorder":"1.5px solid rgba(160,160,160,0.7)","volumeSliderColor":"#FFFFFF","volumeBorder":"1.5px solid rgba(160,160,160,0.7)","timeColor":"#ffffff","durationColor":"#FFFFFF","tooltipColor":"rgba(255, 255, 255, 0.7)","tooltipTextColor":"#000000"}},"playlist":[{"autoPlay":false,"provider":"rtmp","connectionProvider":"secure","autoBuffering":true,"url":"mp4:test.mp4"}]}"/>
</object> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T03:09:22.473

我们遇到了同样的问题，解决方法是使用播放列表，第一项作为图像文件，第二项作为视频。基本上只是将“剪辑”中的所有内容转储到第二个播放列表项中。

# c - C: malloc() 忽略请求的大小？

> ID：14351238
> 
> 赞同：1
> 
> 时间：2013-01-16T04:10:28.737
> 
> 标签：c, malloc, free

我很久没用过 C 了，显然我忘记的比我想象的要多。在尝试使用 malloc() 分配字符串时，我不断获取该字符串的旧数据，包括它的旧数据，当请求的空间较短时长度较长。这种情况确实包括指向被 free()'d 并设置为 NULL 的字符串的指针。这是我在终端中看到的示例运行：

```
yes, quit, or other            (<-message from program)
oooo                           (<-user input; this will be put to upper case and token'd)

------uIT LENGTH:4             (<-debug message showing length of userInputToken)

preC--tmp:                     (<-contents of tmp variable)

pstC--tmp:OOOO                 (<-contents of temp variable)
bad input                      (<-program response)
yes, quit, or other
yes

------uIT LENGTH:3

preC--tmp:OOOO                 (<-: tmp = malloc(sizeof(char)*(strlen(userInputToken)-1)); )

pstC--tmp:YESO                 (<-: strncpy(tmp,userInputToken,strlen(userInputToken)-1);  )
bad input
yes, quit, or other
yes

------uIT LENGTH:3

preC--tmp:YESO

pstC--tmp:YESO
bad input
yes, quit, or other
quit

------uIT LENGTH:4

preC--tmp:YESO

pstC--tmp:QUIT                 (<-: Successful quit because I only did 4 chars; if 5 were used, this would have failed) 
```

如您所见， strlen(userInputToken) 获得了正确的长度，并用于获取正确数量的复制字符——但无论是 free() 还是 malloc() 似乎都不关心它。我无法弄清楚这里发生了什么！这是将 C 留给 Python 的惩罚吗？

更重要的是，应该清除 tmp 变量，而不管 free() 是什么，因为它受到其范围的限制。这是一切都失败的代码：

在 main.c 中：

```
void run() {
    outputFlagContainer *outputFlags = malloc(sizeof(outputFlagContainer));

    while(true) {
        puts("yes, quit, or other");
        outputFlags = getUserInput(outputFlags);
        if (outputFlags->YES) {
            puts("It was a yes!");
        } else if (outputFlags->QUIT) {
            break;
        } else {
            puts("bad input");
        }
    }

    free(outputFlags);
} 
```

在 messageParserPieces.h 中：

```
outputFlagContainer *getUserInput(outputFlagContainer *outputFlags) {
    outputFlags = resetOutputFlags(outputFlags);
    char *userInput = NULL;
    char user_input[MAX_INPUT];
    char *userInputToken = NULL;
    char *tmp = NULL;
    char *finalCharacterCheck = NULL;

    // Tokens to search for:
    char QUIT[] = "QUIT";
    char YES[] = "YES";

    userInput = fgets(user_input, MAX_INPUT-1, stdin);
    int i = 0;
    while(userInput[i]) {
        userInput[i] = toupper(userInput[i]);
        i++;
    }

    userInputToken = strtok(userInput, " ");
    if (userInputToken) {
        finalCharacterCheck = strchr(userInputToken, '\n');
        if (finalCharacterCheck) {
            int MEOW = strlen(userInputToken)-1; // DEBUG LINE
            printf("\n------uIT LENGTH:%d\n", MEOW); // DEBUG LINE

            // The problem appears to happen here and under the circumstances that
            // userInput is (for example) 4 characters and then after getUserInput()
            // is called again, userInput is 3 characters long. 
            tmp = malloc(sizeof(char)*(strlen(userInputToken)-1));
            if (tmp == NULL) {
                exit(1);
            }

            printf("\npreC--tmp:%s\n", tmp); // This shows that the malloc DOES NOT use the given length.

            strncpy(tmp,userInputToken,strlen(userInputToken)-1);

            printf("\npstC--tmp:%s\n", tmp); // Copies in the correct number of characters.

            userInputToken = tmp;
            free(tmp);
            tmp = NULL;
        }
    }

    while (userInputToken != NULL) { // NULL = NO (more) tokens.
        if (0 == strcmp(userInputToken, YES)) {
            outputFlags->YES = true;
        } else if (0 == strcmp(userInputToken, QUIT)) {
            outputFlags->QUIT = true;
        }

        userInputToken = strtok(NULL, " ");
        if (userInputToken) {
            finalCharacterCheck = strchr(userInputToken, '\n');
            if (finalCharacterCheck) {
                tmp = malloc(sizeof(char)*(strlen(userInputToken)-1));
                if (tmp == NULL) {
                    exit(1);
                }
                strncpy(tmp,userInputToken,strlen(userInputToken)-1);
                userInputToken = tmp;
                free(tmp);
                tmp = NULL;
            }
        }
    }
    return outputFlags;
} 
```

我假设这是某种明显的错误，但我今晚尝试用谷歌搜索它大约 2 小时。我想不出如何搜索这个不带 malloc() 教程的东西——我已经看过几个了。

任何见解都将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T04:19:47.283

```
tmp = malloc(sizeof(char)*(strlen(userInputToken)-1));
if (tmp == NULL) {
    exit(1);
}

printf("\npreC--tmp:%s\n", tmp); // This shows that the malloc DOES NOT use the given length.

strncpy(tmp,userInputToken,strlen(userInputToken)-1);
printf("\npstC--tmp:%s\n", tmp); // Copies in the correct number of characters. 
```

此片段显示您希望`tmp`使用某些内容进行初始化。这不是真的。您必须在分配内存后对其进行初始化。这就是你所做的`strncpy`。

还有一个问题，因为您没有分配足够的字节来保存字符串，因此您无法使用纯`%s`格式说明符显示它。您正在分配`strlen(userInputToken)-1`字节并复制相同的数字。这意味着没有空字符的空间，`strncpy`因此不会终止您的字符串。你应该总是多加一个字节，如果 NULL 字符不会被复制，`strncpy`那么你必须自己设置它：

```
size_t length = strlen(userInputToken)-1;
tmp = malloc(length + 1);
strncpy(tmp, userInputToken, length);
tmp[length] = 0; 
```

所以，为了清楚起见，你有三个问题：

1.  在初始化之前显示新分配的“字符串”；
2.  您没有分配足够的内存来保存字符串
3.  您不会终止字符串（也不会，`strncpy`因为它没有在允许的字节数内遇到字符串终止符）。

* * *

我刚刚在你的循环中发现了其他东西`while (userInputToken != NULL)`......你总是在循环开始时使用字符串比较`userInputToken`，但在循环内部（以及循环上方的部分）你这样做：

```
userInputToken = tmp;
free(tmp); 
```

这意味着`userInputToken`是一个*悬空指针*。它指向已被释放的内存，你不能使用它。您将不得不重新考虑您的方法，并让它一直存在，直到不再需要它为止。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T04:19:03.357

您可能应该使用 calloc。您也不应该像这样使用未初始化的内存。Malloc 以块的形式分配内存。当您释放一个块时，它可能会被重用。您没有得到确切的大小，并且在您使用 malloc 设置内存之前，不能保证其字节的值是多少。您所知道的是，您有一块至少与您请求的大小一样大的内存可供使用。所以在这个例子中，你在写入之前打印内存块的旧内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T04:23:39.110

您使用此行对分配长度的验证不正确：

```
printf("\npreC--tmp:%s\n", tmp); // This shows that the malloc DOES NOT use the given length. 
```

`malloc`将分配请求的字节数，但不会初始化分配的内存。因此，当您尝试将其打印为应以 结尾的字符串时`'\0'`，它将尝试打印所有字符，直到`'\0'`在内存中找到为止。终止字符可能不是来自同一个内存块。的存在`'\0'`是不确定的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T12:41:56.497

我希望这有帮助

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <ctype.h>

#define MAX_INPUT 128
#define true 1
#define false 0

typedef struct _outputFlagContainer{

int  YES, QUIT;

}outputFlagContainer;

void run();
outputFlagContainer *getUserInput(outputFlagContainer *outputFlags);
outputFlagContainer *resetOutputFlags(outputFlagContainer *outputFlags);

int main(int argc, char *argv[]){

run();      
return 0;
}    

void run() {

    outputFlagContainer *outputFlags = malloc(sizeof(outputFlagContainer));

    while(true) {       

        puts("yes, quit, or other");

        outputFlags = getUserInput(outputFlags);

        if (outputFlags->YES) 
        {
            puts("It was a yes!");
        }
        else if (outputFlags->QUIT) 
        {
            break;
        }
        else
        {
            puts("bad input");
        }

    }

    free(outputFlags);
}

outputFlagContainer *resetOutputFlags(outputFlagContainer *outputFlags) {

    if(outputFlags!= NULL){

        outputFlags->YES = false;
        outputFlags->QUIT = false;      

    }

    return outputFlags;

}

outputFlagContainer *getUserInput(outputFlagContainer *outputFlags) {

    int len;
    char user_input[MAX_INPUT]={0};     // Zero Initialization

    char *userInput = NULL;
    char *userInputToken = NULL;
    char *tmp = NULL;
    char *finalCharacterCheck = NULL;

    // Tokens to search for:        // Immutable Strings
    char *QUIT = "QUIT";
    char *YES = "YES";

    // Reset The Structure
    outputFlags = resetOutputFlags(outputFlags);

    userInput = fgets(user_input, MAX_INPUT, stdin);        // it copies one less than MAX_INPUT 

    // Converting to Upper Case
    int i = 0;
    while(userInput[i]) {
        userInput[i] = toupper(userInput[i]);
        i++;
    }

    userInputToken = strtok(userInput, " ");

    if (userInputToken) {

        finalCharacterCheck = strchr(userInputToken, '\n');

        if (finalCharacterCheck) {

            len = strlen(userInputToken);

            printf("\n------uIT LENGTH:%d\n", len); // DEBUG LINE

            tmp = malloc(sizeof(char)*(len+1));
            if (tmp == NULL)
                exit(1);

            strncpy(tmp,userInputToken,len);
            tmp[len]='\0';

            printf("\npstC--tmp:%s\n", tmp); // Copies in the correct number of characters.

            strcpy(user_input,tmp);
            userInputToken = user_input;
            free(tmp);
            tmp = NULL;
        }
    }

    while (userInputToken != NULL) { // NULL = NO (more) tokens.

        if (0 == strcmp(userInputToken, YES)) {

            outputFlags->YES = true;

        } 
        else if (0 == strcmp(userInputToken, QUIT)) {

            outputFlags->QUIT = true;

        }

        userInputToken = strtok(NULL, " ");

        if (userInputToken) {

            finalCharacterCheck = strchr(userInputToken, '\n');

            if (finalCharacterCheck) {

                len = strlen(userInputToken);        
                tmp = malloc(sizeof(char)*(len+1));
                if (tmp == NULL) {
                    exit(1);
                }

                strncpy(tmp,userInputToken,len);
                tmp[len]='\0';

                strcpy(user_input,tmp);
                userInputToken = user_input;                                                
                free(tmp);
                tmp = NULL;
            }
        }
    }

    return outputFlags;
} 
```

# ruby-on-rails - 升级 rails 后 Html 显示为文本

> ID：14351241
> 
> 赞同：0
> 
> 时间：2013-01-16T04:10:48.993
> 
> 标签：ruby-on-rails, ruby-on-rails-3

最近在 Rails 中发现安全问题后，我将我的应用程序升级到了 3.0.19 版本。升级后我开始在视图上看到这个

<div style="margin:0;padding:0;display:inline" > <input name="authenticity_token" type="hidden" value="NUvSsQPtm09ho5A5qlfuXTQ6ipgmbA80jALLRGG5CdY="/></div>

像文本一样显示。

知道为什么会发生这种情况吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T04:34:59.637

```
"<div>...</div>".html_safe 
```

Rails 3 改变了处理 html 字符串的方式。查看[这篇文章](http://origami.co.uk/blog/2010/02/rails-3-html-escaping)以了解更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T04:31:09.780

这是因为默认情况下使用 rails > 3 html safe，以避免这种使用`raw`

```
Ex: raw ("<h1>Header</h1>") => will print html h1 tag 
```

高温高压

# eclipse - 提交时 Mercurial“在嵌套回购中”问题

> ID：14351242
> 
> 赞同：2
> 
> 时间：2013-01-16T04:11:03.937
> 
> 标签：eclipse, mercurial

我是 Eclipse 的 Mercurial 插件的新手。

刚刚意识到我正在使用*工作区*文件夹进行提交。所以我将提交的文件夹更改为项目文件夹。

现在，当我尝试提交时，我得到了错误：

```
 path 'FragmentsApp/bin/classes.dex' is inside nested repo 'FragmentsApp' 
```

FragmentsApp 是我的项目。

猜猜我应该删除/删除*工作区*上以前的提交以开始提交而不会出现问题，但我不知道该怎么做。

# python - 我应该学习什么？Python 2 还是 Python 3？

> ID：14351245
> 
> 赞同：3
> 
> 时间：2013-01-16T04:11:42.637
> 
> 标签：python, python-3.x, python-2.x

我知道这个问题已经在这个网站上被问过很多次了。但是，时代变了。很久以前就有人问过他们，我想我现在可以从 python 3 开始了吗？你说什么？ **Python 2.x 还是 3？并解释为什么？**感谢您的任何支持。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T04:15:39.557

你可以学习任何一个，python 2.x 和 python 3 在语法上是相似的，你获得的知识通常适用于任何一个版本。因此，只需选择一个并[潜入](http://getpython3.com/diveintopython3/)！

至于你应该*使用*哪个，答案是 - 像往常一样 - 这取决于。如果不知道您打算使用 python 做什么，我们无法回答这个问题，因为事情在很大程度上取决于您可能想要使用哪些 3rd-party 库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T04:16:52.057

它在很大程度上取决于您要使用它的上下文。有许多较旧的模块，即使是仍在开发和社区支持的模块，也可以在 Python 2 上运行，但尚未与 Python 3 兼容——一个非常值得注意的例子是[**Pygame**](http://www.pygame.org/news.html)。他们可能会不时声称不这样做，但他们对 Python 3 的支持在很大程度上是一项粗略的工作。因此，如果您依赖于某些外部模块，Python 2 是一个非常安全的选择，可以保持与所有内容的向后兼容性。

# android - 如何在地图上的图钉上点击图片？

> ID：14351246
> 
> 赞同：0
> 
> 时间：2013-01-16T04:11:45.633
> 
> 标签：android, image, google-maps, annotations

我制作了一个简单的地图应用程序，其中我放置了一个可点击和可缩放的地图视图，我在地图上放置了一个静态点，具有静态纬度和经度以及一个图钉图像来指出该地点，现在我想要的是当我单击时在该引脚上应该打开一个评论框图像。我的代码如下：

**MainActivity.java**

```
package com.example.maps;

import java.util.List;

import com.google.android.maps.GeoPoint;
import com.google.android.maps.MapActivity;
import com.google.android.maps.MapController;
import com.google.android.maps.MapView;
import com.google.android.maps.Overlay;
import com.google.android.maps.OverlayItem;

import android.os.Bundle;
import android.app.Activity;
import android.graphics.drawable.Drawable;
import android.view.Menu;
import android.widget.ImageView;

public class MainActivity extends MapActivity {
MapView mapview;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        mapview = (MapView)findViewById(R.id.mapview);
        mapview.setBuiltInZoomControls(true);
        mapview.setSatellite(true); 
        mapview.setTraffic(true); 

        MapController mc =mapview.getController();
        double lat = Double.parseDouble("23.0355018");
        double lon = Double.parseDouble("72.5630625");
        GeoPoint gp = new GeoPoint((int)(lat*1E6),(int) (lon*1E6));
        mc.animateTo(gp);
        mc.setZoom(15);
        mapview.invalidate();
        List<Overlay> mapOverlays = mapview.getOverlays();
        Drawable drawable = this.getResources().getDrawable(R.drawable.pin);
       // Drawable drawable1 = this.getResources().getDrawable(R.drawable.yellowhite1comment);

        AddItemizedOverlay itemizedOverlay =
        new AddItemizedOverlay(drawable, this);

        OverlayItem overlayitem = new OverlayItem(gp, "Hello", "Sample Overlay item");

        itemizedOverlay.addOverlay(overlayitem);
        mapOverlays.add(itemizedOverlay);
    }

    @Override
    protected boolean isRouteDisplayed() {
        // TODO Auto-generated method stub
        return true;
    }
} 
```

**AddItemizedOverlay.java**

```
 package com.example.maps;

import java.util.ArrayList;
import java.util.Collection;

import javax.crypto.spec.IvParameterSpec;

import android.R.bool;
import android.R.drawable;
import android.content.Context;
import android.graphics.drawable.Drawable;
import android.util.Log;
import android.widget.ImageView;
import android.widget.Toast;

import com.google.android.maps.ItemizedOverlay;
import com.google.android.maps.OverlayItem;

public class AddItemizedOverlay extends ItemizedOverlay<OverlayItem> {
private ArrayList<OverlayItem> mapOverlays = new ArrayList<OverlayItem>();
private Context context;
MainActivity mainact = new MainActivity();

    public AddItemizedOverlay(Drawable defaultmarker) {

        super(boundCenterBottom(defaultmarker));
        // TODO Auto-generated constructor stub
    }
public AddItemizedOverlay(Drawable defaultmarker,Context context){
    this(defaultmarker);
    this.context=context;

}
    @Override
    protected OverlayItem createItem(int i) {
        // TODO Auto-generated method stub

        return mapOverlays.get(i);
    }

    @Override
       protected boolean onTap(int index) {

           OverlayItem item = mapOverlays.get(index);

           //Initialize context in the AddItemizedClass Constructor.
           item.setMarker(context.getResources().getDrawable(R.drawable.yellowhite1comment));

           mapOverlays.add(itemizedOverlay);

           //itemizedOverlay is like a global object;

           itemizedOverlay.populateNow();

           return true;
       }
    public void populateNow()
    {
        populate(); 
    }
    public void addOverlay(OverlayItem overlay) {
        mapOverlays.add(overlay);
         this.populate();
     }
    @Override
    public int size() {
        // TODO Auto-generated method stub
        return 0;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T04:33:22.727

在 AddItemizedOverlay 类中使​​用它

```
 @Override
   protected boolean onTap(int index) {

       OverlayItem item = mapOverlays.get(index);

       //Initialize context in the AddItemizedClass Constructor.
       item.setMarker(context.getResources().getDrawable(R.drawable.comment_box));

       mapOverlays.add(itemizedOverlay);

       //itemizedOverlay is like a global object;

       itemizedOverlay.populateNow();

       return true;
   } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T04:54:16.183

试试这个：

> ```
> public class MapendPointsOverlay extends ItemizedOverlay<OverlayItem> {
> private ArrayList<OverlayItem> m_overlays = new ArrayList<OverlayItem>();
> private BalloonOverlayView m_balloonView;
> private OverlayItem m_overlayitem;
> private Context m_context;
> private int m_viewOffset;
> private MapController m_mapController;
> private MapView m_mapView;
> private int m_screenWidth;
> private int m_screenHeight;
> private Display m_screen;
> private boolean m_fromroutepath = false;
> public MapendPointsOverlay(Drawable p_drawable) {
>     super(p_drawable);
> }
> public MapendPointsOverlay(Drawable p_defaultMarker, Context p_context,
>         MapView p_mapview, boolean p_fromroutepath) {
>     super(boundCenterBottom(p_defaultMarker));
>     m_context = p_context;
>     m_mapView = p_mapview;
>     m_mapController = p_mapview.getController();
>     m_viewOffset = 35;
>     m_fromroutepath = p_fromroutepath;
>     m_screen = ((WindowManager) m_context           .getSystemService(Context.WINDOW_SERVICE)).getDefaultDisplay();
>     m_screenWidth = m_screen.getWidth();
>     m_screenHeight = m_screen.getHeight();
> }
> /**
>  * Method that creates an OverlayItem from the list of OverlayItem at index
>  * given by <b>p_arg0</b>
>  */
> @Override
> protected OverlayItem createItem(int p_arg0) {
>     return m_overlays.get(p_arg0);
> }
> @Override
> public int size() {
>     return m_overlays.size();
> }
> @Override
> protected boolean onTap(int p_index) {
>     boolean m_isRecycled;
>     GeoPoint m_point;
>     m_point = createItem(p_index).getPoint();
>     m_overlayitem = m_overlays.get(p_index);
>     if (m_balloonView == null) {
>         m_balloonView = new BalloonOverlayView(m_context, m_viewOffset);
>         m_isRecycled = false;
>     } else {
>         m_isRecycled = true;
>     }
>     m_balloonView.setVisibility(View.GONE);
>     m_balloonView.setData(m_overlayitem);
>     m_balloonView.setVisibility(View.VISIBLE);
>     MapView.LayoutParams m_params = new MapView.LayoutParams(
>      LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT, m_point,MapView.LayoutParams.BOTTOM_CENTER);
>     m_params.mode = MapView.LayoutParams.MODE_MAP;
>     List<Overlay> m_mapOverlays = m_mapView.getOverlays();
>     if (m_mapOverlays.size() > 1) {
>         hideOtherBalloons(m_mapOverlays);
>     }
>     if (m_isRecycled) {
>         m_balloonView.setLayoutParams(m_params);
>     } else {
>         m_mapView.addView(m_balloonView, m_params);
>     }
>     m_mapController.animateTo(m_point);
>     m_mapController.setCenter(m_point);
>     return true;
> }
> /**
>  * Sets the visibility of this overlay's balloon view to GONE.
>  */
> private void hideBalloon() {
>     if (m_balloonView != null) {
>         m_balloonView.setVisibility(View.GONE);
>     }
> }
> /**
>  * Hides the balloon view for any other BalloonItemizedOverlay instances
>  * that might be present on the MapView.
>  * 
>  * @param p_overlays
>  *            - list of overlays (including this) on the MapView.
>  */
> private void hideOtherBalloons(List<Overlay> p_overlays) {
>     for (Overlay m_overlay : p_overlays) {
>         if (m_overlay instanceof MapendPointsOverlay && m_overlay != this) {
>             ((MapendPointsOverlay) m_overlay).hideBalloon();
>         }
>     }
> }
> /**
>  * Override this method to handle a "tap" on a balloon. By default, does
>  * nothing and returns false.
>  * 
>  * @param p_index
>  *            - The index of the item whose balloon is tapped.
>  * @return true if you handled the tap, otherwise false.
>  */
> protected boolean onBalloonTap(int p_index) {
>     return false;
> }
> /**
>  * Method to filter all points based on the projection given by
>  * <b>p_projection</b>, FrameWidth <b>p_frameWidth</b>, FrameHeight
>  * <b>p_frameHeight</b>
>  * 
>  * @param p_projection
>  *            The projection of the mapview
>  * @param p_frameWidth
>  *            The width of the screen
>  * @param p_frameHeight
>  *            The height of the screen
>  */
> public void filterAllPoints(Projection p_projection, int p_frameWidth,
>         int p_frameHeight) {
>     try {
>         for (int m_i = 0; m_i < AppConstants.m_geoItems.length; m_i++) {
>             GeoItem m_tempLoc = AppConstants.m_geoItems[m_i];
>             GeoPoint m_geopoint = m_tempLoc.getLocation();
>             Point m_scPoint = new Point();
>             p_projection.toPixels(m_geopoint, m_scPoint);
>             if (m_scPoint.x > 20 && m_scPoint.y > 20
>                     && m_scPoint.x < (p_frameWidth)
>                     && m_scPoint.y < (p_frameHeight)) {
>                 OverlayItem m_overlayitem = new OverlayItem(m_geopoint, ""
>                         + m_tempLoc.m_id, "location"/*
>                                                      * Integer.toString(tempLoc
>                                                      * .getLocationId())
>                                                      */);
>                 addOverlay(m_overlayitem);
>             }
>         }
>     } catch (Exception p_e) {
>          p_e.printStackTrace();
>     }
> }
> /**
>  * 
>  * Method to filter <b>p_recordCount</b> points based on the projection
>  * given by <b>p_projection</b>, FrameWidth <b>p_frameWidth</b>, FrameHeight
>  * <b>p_frameHeight</b>
>  * 
>  * @param p_recordCount
>  *            Th number of points to be filtered
>  * @param p_projection
>  *            The projection of the mapview
>  * @param p_frameWidth
>  *            The width of the screen
>  * @param p_frameHeight
>  *            The height of the screen
>  */
> public void filterPoints(int p_recordCount, Projection p_projection,
>         int p_frameWidth, int p_frameHeight) {
>     int m_noOfRecords = 0;
>     try {
>         for (int m_i = 0; m_noOfRecords < p_recordCount
>                 && m_i <= AppConstants.m_geoItems.length - 1; m_i++) {
>             GeoItem m_tempLoc = AppConstants.m_geoItems[m_i];
>             GeoPoint m_geopoint = m_tempLoc.getLocation();
>             Point m_scPoint = new Point();
>             p_projection.toPixels(m_geopoint, m_scPoint);
>             if (m_scPoint.x > 20 && m_scPoint.y > 20
>                     && m_scPoint.x < (p_frameWidth)
>                     && m_scPoint.y < (p_frameHeight)) {
>                 OverlayItem m_overlayitem = new OverlayItem(m_geopoint, ""
>                         + m_tempLoc.m_id, "location"
>                 addOverlay(m_overlayitem);
>                 m_noOfRecords++;                }
>         }
>     } catch (Exception e) {
>         // TODO: handle exception
>          e.printStackTrace();
>     }
> }
> /**
>  * Method to set the first 10 defined points in the Array of geoitems
>  * AppConstants.m_first10geoItems
>  */
> public void setFirst10Points() {
>     try {
>         for (int m_i = 0; m_i < AppConstants.m_first10geoItems.length; m_i++) {
>             GeoItem m_tempLoc = AppConstants.m_first10geoItems[m_i];
>             GeoPoint m_geopoint = m_tempLoc.getLocation();
>             OverlayItem m_overlayitem = new OverlayItem(m_geopoint, ""
>                     + m_tempLoc.m_id, "location"
>             addOverlay(m_overlayitem);
>         }
>     } catch (Exception p_e) {
>         // TODO: handle exception
>     }
> }
> /**
>  * Method to set the overlays on the Mapview given by <b>p_mapView</b>
>  * 
>  * @param p_mapView
>  *            The mapview on which the overlays are to be drawn
>  */
> public void setLocationOverlays(MapView p_mapView) {
>     clearOverlays();
>     int m_zoomLevel = p_mapView.getZoomLevel();
>     Projection m_mapViewprojection = p_mapView.getProjection();
>     try {
>         // if (!(m_zoomLevel > 16) && !(m_zoomLevel < 12))
>         if (!(m_zoomLevel < 12)) {
>             if (AppConstants.m_geoItems != null
>                     && AppConstants.m_geoItems.length > 0) {
>                 if (m_zoomLevel == 12) {
>                     if (AppConstants.m_geoItems.length == 1) {
>                         filterAllPoints(m_mapViewprojection,
>                                 (m_screenWidth - 5), (m_screenHeight - 25));
>                     } else {
>                         if (AppConstants.m_first10geoItems != null) {
>                             setFirst10Points();
>                         }
>                     }
>                 }
>                 else if (m_zoomLevel > 12) {
>                     // Display 10 Records
>                     filterPoints(10, m_mapViewprojection,
>                             (m_screenWidth - 5), (m_screenHeight - 25));
>                 } else {
>                     // Display all the records available in the current                     // screen
>                     filterAllPoints(m_mapViewprojection,
>                             (m_screenWidth - 5), (m_screenHeight - 25));
>                 }
>                 p_mapView.invalidate();
>             }
>         }  
>         }
>     } catch (Exception p_e) {
>     }
> }
> /**
>  * Method to set the listener for the zoom controls of mapview given by
>  * <b>p_controls</b>
>  * 
>  * @param p_controls
>  *            The Zoom controls of the mapview
>  */
> public void setZoomControlListener(ZoomControls p_controls) {
>     p_controls.setOnZoomInClickListener(new OnClickListener() {
>         public void onClick(View v) {
>             hideBalloon();
>             if (m_mapView.getZoomLevel() > 16) {
>             } else {
>                 m_mapView.getController().zoomIn();
>                 setLocationOverlays(m_mapView);
>             }
>         }
>     });
>     p_controls.setOnZoomOutClickListener(new OnClickListener() {
>         public void onClick(View v) {
>             hideBalloon();
>             if (m_mapView.getZoomLevel() > 12) {
>                 m_mapView.getController().zoomOut();
>                 setLocationOverlays(m_mapView);
>             }
>         }
>     });
> }
> @Override
> public boolean onTouchEvent(MotionEvent p_event, MapView p_mapView) {
>     if (!(p_mapView.getZoomLevel() > 16)
>             && !(p_mapView.getZoomLevel() < 12)) {
>         if (p_event.getAction() == MotionEvent.ACTION_DOWN) {
>             hideBalloon();
>         }
>         if (p_event.getAction() == MotionEvent.ACTION_UP) {
>             if (m_fromroutepath) {
>                 System.out.println("From RoutePath");
>             } else {
>                 setLocationOverlays(p_mapView);
>             }
>         }
>     } else {
>         hideBalloon();
>         if (p_mapView.getZoomLevel() > 16) {
>             p_mapView.getController().setZoom(16);
>         }
>     }
>     return super.onTouchEvent(p_event, p_mapView);
> }
> /**
>  * Method to add the overlay given by <b>p_overlay</b> on the ampview
>  * 
>  * @param p_overlay
>  *            The overlay to be added in the list of overlays on the map
>  */
> public synchronized void addOverlay(OverlayItem p_overlay) {
>     m_overlays.add(p_overlay);
>     // m_mapView.getOverlays().add(p_overlay);
>     populate();
> }
> /**
>  * Method to clear all the overlays from the mapview
>  */
> public synchronized void clearOverlays() {
>     m_overlays.clear();
>     populate();
> }} 
> ```

**BallonOverlay 类**

> ```
>  public class BalloonOverlayView extends FrameLayout
>   {
> private LinearLayout m_layout;
> private TextView m_title;
> private TextView m_snippet;
> /**
>  * Create a new BalloonOverlayView.
>  * 
>  * @param p_context
>  *            - The activity context.
>  * @param p_balloonBottomOffset
>  *            - The bottom padding (in pixels) to be applied when rendering this view.
>  */
> public BalloonOverlayView(Context p_context, int p_balloonBottomOffset)
> {
>     super(p_context);
>     setPadding(10, 0, 10, p_balloonBottomOffset);
>     m_layout = new LinearLayout(p_context);
>     m_layout.setVisibility(VISIBLE);
>     LayoutInflater m_inflater = (LayoutInflater) p_context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
>     View m_view = m_inflater.inflate(R.layout.balloonoverlay, m_layout);
>     m_title = (TextView) m_view.findViewById(R.id.balloon_item_title);
>     m_snippet = (TextView) m_view.findViewById(R.id.balloon_item_snippet);
>     m_snippet.setVisibility(View.GONE);
>     ImageView m_close = (ImageView) m_view.findViewById(R.id.close_img_button);
>     m_close.setOnClickListener(new OnClickListener(){
>         public void onClick(View v)
>         {
>             m_layout.setVisibility(GONE);
>         }
>     });     
>     FrameLayout.LayoutParams m_params = new FrameLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT);
>     m_params.gravity = Gravity.NO_GRAVITY;
>     addView(m_layout, m_params);
> }   
> /**
>  * Sets the view data from a given overlay item.
>  * 
>  * @param p_item
>  *            - The overlay item containing the relevant view data (title and snippet).
>  */
> public void setData(OverlayItem p_item)
> {
>     m_layout.setVisibility(VISIBLE);
>     if (p_item.getTitle() != null)
>     {
>         m_title.setVisibility(VISIBLE);
>         m_title.setText(p_item.getTitle());
>     }
>     else
>     {
>         m_title.setVisibility(GONE);
>     }       
>     if (p_item.getSnippet() != null)
>     {
>         m_snippet.setVisibility(VISIBLE);
>         m_snippet.setText(p_item.getSnippet());
>     }
>     else
>     {
>         m_snippet.setVisibility(GONE);
>     }
>      }  
> /**
>  * Method to set the view data from a given geopoint
>  * 
>  * @param p_point
>  *            The geopoint
>  */
> public void setData(GeoPoint p_point)
> {
>     m_layout.setVisibility(VISIBLE);
>     m_title.setText("Latitude=" + p_point.getLatitudeE6() + "\n Longitude=" + p_point.getLongitudeE6());
> }
> } 
> ```

# pagination - 使用 ember-data RESTAdapter 返回分页数据的正确模式？

> ID：14351251
> 
> 赞同：14
> 
> 时间：2013-01-16T04:12:19.357
> 
> 标签：pagination, ember.js, ember-data

我在页面中显示使用 Ember Data RESTAdapter 获取的文章列表。我需要实现一个引导式分页器（请参阅：http: [//twitter.github.com/bootstrap/components.html#pagination](http://twitter.github.com/bootstrap/components.html#pagination)）并且似乎无法找到一个理智的模式来返回分页数据，例如页数、文章数，当前页面，在单个请求中。

例如，我希望 API 返回如下内容：

```
{
  articles: [{...}, {...}],
  page: 3,
  article_count: 4525,
  per_page: 20
} 
```

一个想法是添加一个 App.Paginator DS.Model 以便响应看起来像：

```
{
  articles: [{...}, {...}],
  paginator: {
    page: 3,
    article_count: 4525,
    per_page: 20
  }
} 
```

但这似乎为一件如此微不足道的事情而拼凑起来有点过头了。有没有人解决了这个问题或找到了他们喜欢的特定模式？是否有一种简单的方法来管理 RESTAdapter 映射以解决此类情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-24T00:26:40.600

尝试使用[Ember 分页支持 Mixin](https://gist.github.com/1608481)并提供您自己的以下方法的实现。您可以在用户浏览页面时获取所需的内容，而不是加载所有内容。您最初需要的只是记录的总帐户。

```
didRequestRange: function(rangeStart, rangeStop) {
    var content = this.get('fullContent').slice(rangeStart, rangeStop);
    this.replace(0, this.get('length'), content);
  } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-29T08:41:32.300

使用 ember-data-beta3，您可以在结果中传递`meta`-property。默认的 RESTSerializer 会查找该属性并将其存储。您可以像这样访问元数据：

```
var meta = this.get("store").metadataFor("post"); 
```

如果您无法更改从服务器返回的 JSON，您可以覆盖`extractMeta`ApplicationSerializer（或任何其他特定于模型的序列化程序）上的 -hook。

```
App.ApplicationSerializer = DS.RESTSerializer.extend({
  extractMeta: function(store, type, payload) {
    if (payload && payload.total) {
      store.metaForType(type, { total: payload.total });  // sets the metadata for "post"
      delete payload.total;  // keeps ember data from trying to parse "total" as a record
    }
  }
}); 
```

[在此处阅读有关元数据的更多信息](http://emberjs.com/guides/models/handling-metadata/)

# javascript - 第一次记录后返回未定义的函数

> ID：14351253
> 
> 赞同：0
> 
> 时间：2013-01-16T04:12:46.910
> 
> 标签：javascript

我正在尝试设置图像交换功能。到目前为止，这是我的代码：

```
var imageChanger = function(start, end) {

var start = 1;
var end = 22;

return {
    count: function(url) {

        var self = this;

        if(start > end) {
            start = 1;
        }

        console.log(url);
        console.log(start++);

        imageSwapper = setTimeout( function() {
            self.count();
        }, 2000)

    },
    stopCount: function() {
        clearTimeout(imageSwapper);
    }
}

} 
```

如您所见，这是一个带有两个参数的函数。然后它使用两种方法返回它自己的对象。当我`count`在初始`imageChanger`函数调用后调用该方法并将参数传递给`url`它时，只记录我传递的一次，然后当`setTimeout`函数运行时，未定义的后续时间。

我不确定我在这里做错了什么。为什么这个`count`函数在第一个日志后返回未定义？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T04:15:22.163

在 setTimeout 中，您应该`self.count`使用`url`参数而不是无参数调用，即

```
self.count(url); 
```

# jquery - Ajax 调用在刷新间隔期间不刷新 DIV 部分

> ID：14351254
> 
> 赞同：1
> 
> 时间：2013-01-16T04:12:48.127
> 
> 标签：jquery, ajax, spring, sqljdbc

请帮忙。我有以下 JSP 文件，其中包含对 DIV 'alertDIV' 的 AJAX 调用，我需要每 3 秒刷新一次。我想每 3 秒加载一次 jsp 文件 'alertbar.jsp'。文件 alertbar.jsp用于运行查询并返回结果..

现在，当我运行项目时，调用 JSP 文件（'userhome.jsp'）每 3 秒刷新一次 DIV。但是，当我在后端更改值时，新值不会被刷新。但是，当我刷新页面，显示更改的结果。我参考了很多建议并添加了“$.ajaxSetup ({cache: false});”这一行。仍然没有变化...我创建了一个简单的项目并单独使用这两个文件，令我惊讶的是，它显示了正确的结果。我刚刚将在示例项目中工作的同一组代码复制到现有的项目...但没有工作..我对使应用程序保留缓存的原因一无所知（如果这就是原因）

如果需要，我可以发送代码.. 但这与本网站建议的刷新 DIV 相同...

代码看起来像这样

## 用户主页。jsp

```
<script src="http://ajax.googleapis.com/ajax/
libs/jquery/1.3.0/jquery.min.js"></script>
<script>
var auto_refresh = setInterval(
function()
{
$.ajaxSetup ({
    cache: false
    });

$('#alertdiv').fadeOut('slow').load('alertbar.jsp').fadeIn("slow");
}, 3000);
</script> 
```

和

警报栏.jsp

```
<div >
    <%
        try 
        {
           %>  Alerts over  <% 
           Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
           Connection con = DriverManager.getConnection("jdbc:sqlserver://localhost:1455;DatabaseName=card8","sa","adminadmin");
           Statement st=con.createStatement();
           ResultSet resultSet=st.executeQuery("select case(filetype) when 103 then 'file1' when 104 then 'file2' when 111 then 'file3' when 117 then 'file4' when 120 then 'file5' when 143 then 'file6' end , count(*)  from filecontrol where state = 101 group by filetype ");
           while(resultSet.next())
           {
            %>
            <%= resultSet.getString(1)  + ": (" + resultSet.getInt(2)+ ")   |   " %>    
            <%
           }
           %>  Alerts over  <% 
        } 
        catch( ClassNotFoundException e)
        {
            e.printStackTrace();
        } catch( SQLException e) 
        {
            e.printStackTrace();
        } catch(Exception e) 
        {
            e.printStackTrace();
        }
    %>      
</div> 
```

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:31:17.723

只需在 setInterval 函数中使用类似的东西

```
$.ajax({    
    cache: false,
    url : urlName,
    type : 'GET',
    async: false,
    data : {},              
    success : function(data) {
        $('#alertdiv').html(data);
    },
    error: function (e) {
        alert('Error: ' + e); 
    }
}); 
```

干杯，vrathore.blogspot

# python - 处理大型 Numpy 数组的技术？

> ID：14351255
> 
> 赞同：25
> 
> 时间：2013-01-16T04:12:57.003
> 
> 标签：python, arrays, optimization, memory-management, numpy

有时您必须对一个或多个大型`Numpy`数组执行许多中间操作。这会很快导致`MemoryError`s。到目前为止，在我的研究中，我发现 Pickling（Pickle、CPickle、Pytables 等）`gc.collect()`是缓解这种情况的方法。我想知道在处理大量数据时是否有经验丰富的程序员使用的任何其他技术（当然，除了删除策略/代码中的冗余）。

另外，如果我确定有一件事是没有什么是免费的。使用其中一些技术，有哪些权衡（即速度、鲁棒性等）？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-01-16T05:47:34.567

我感觉到你的痛苦......你有时最终会存储数倍于你的数组大小的值，你以后会丢弃。一次处理数组中的一项时，这是无关紧要的，但在矢量化时可能会杀死您。

我将使用工作中的示例进行说明。我最近使用 numpy对[此处描述的算法进行了编码。](http://www.hpl.hp.com/techreports/98/HPL-98-95.pdf)它是一种颜色映射算法，它采用 RGB 图像，并将其转换为 CMYK 图像。对每个像素重复的过程如下：

1.  使用每个 RGB 值的最高有效 4 位作为 3 维查找表的索引。这确定了 LUT 中立方体的 8 个顶点的 CMYK 值。
2.  根据上一步的顶点值，使用每个 RGB 值的最低有效 4 位在该立方体内进行插值。最有效的方法需要计算 16 个 uint8 数组，其大小与正在处理的图像的大小相同。对于一个 24bit 的 RGB 图像，相当于需要存储图像的 x6 倍来处理它。

你可以做几件事来处理这个问题：

## 1.分而治之

也许您无法一次处理 1,000x1,000 数组。但是，如果您可以使用 python for 循环遍历 10 个 100x1,000 的数组，它仍然会以非常大的优势击败超过 1,000,000 个项目的 python 迭代器！它会变慢，是的，但不会那么慢。

## 2.缓存昂贵的计算

这与我上面的插值示例直接相关，虽然值得留意，但更难遇到。因为我在一个每个维度有 4 位的三维立方体上进行插值，所以只有 16x16x16 个可能的结果，可以存储在 16 个 16x16x16 字节的数组中。所以我可以预先计算它们并使用 64KB 的内存存储它们，并为整个图像逐个查找值，而不是以巨大的内存成本为每个像素重做相同的操作。这已经为小至 64x64 像素的图像带来了回报，并且基本上允许处理像素数量为 x6 倍的图像，而无需细分阵列。

## 3.`dtypes`明智地使用你的

如果您的中间值可以放在单个`uint8`中，请不要使用`int32`s 数组！由于静默溢出，这可能会变成一场神秘错误的噩梦，但如果你小心的话，它可以节省大量资源。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-16T16:54:55.243

第一个最重要的技巧：分配一些大数组，并使用和回收其中的一部分，而不是让大量*临时*数组变得生机勃勃并丢弃/垃圾收集。听起来有点过时，但通过仔细的编程加速可以令人印象深刻。（您可以更好地控制对齐和数据局部性，因此可以使数字代码更有效率。）

第二：使用[`numpy.memmap`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.memmap.html#numpy.memmap)并希望操作系统缓存对磁盘的访问足够有效。

第三：正如@Jaime 所指出的，如果整个矩阵太大，请对子矩阵进行处理。

编辑：

正如SE中的这个[答案](https://stackoverflow.com/a/14372746/1499402)所指出的，避免不必要的列表理解。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-05-03T16:57:26.370

[dask.array](http://dask.pydata.org/en/latest/array.html)库提供了一个 numpy 接口，该接口使用阻塞算法来处理具有多个内核的大于内存的数组。

您还可以查看[Spartan](https://github.com/spartan-array/spartan)、[Distarray](http://docs.enthought.com/distarray/)和[Biggus](https://github.com/SciTools/biggus)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-17T16:12:48.720

如果可能，请使用[numexpr](https://github.com/pydata/numexpr "数字表达式")。`a**2 + b**2 + 2*a*b`对于像（对于`a`和`b`作为数组）这样的数字计算，它

1.  如果相同的数组在您的表达式中出现多次，将编译将快速执行且内存开销最小的机器代码，并处理内存局部性问题（以及缓存优化），

2.  使用双核或四核 CPU 的所有内核，

3.  是 numpy 的扩展，而不是替代方案。

对于中型和大型数组，单独使用 numpy 更快。

看看上面给出的网页，有一些例子可以帮助你理解 numexpr 是否适合你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-10-29T04:16:00.557

除了其他答案中所说的所有内容之外，如果我们想存储计算的所有中间结果（因为我们并不总是需要将中间结果保存在内存中），我们还可以在各种类型的聚合之后使用`accumulate`from ：`numpy`

**骨料**

对于二进制 ufunc，有一些有趣的聚合可以直接从对象中计算出来。例如，如果我们想通过特定操作减少数组，我们可以使用任何 ufunc 的 reduce 方法。reduce 重复地将给定的操作应用于数组的元素，直到只剩下一个结果。

例如，在 add ufunc 上调用 reduce 会返回数组中所有元素的总和：

```
x = np.arange(1, 6)
np.add.reduce(x) # Outputs 15 
```

同样，在 multiply ufunc 上调用 reduce 会得到所有数组元素的乘积：

```
np.multiply.reduce(x) # Outputs 120 
```

**积累**

如果我们想存储计算的所有中间结果，我们可以使用累加：

```
np.add.accumulate(x) # Outputs array([ 1,  3,  6, 10, 15], dtype=int32)
np.multiply.accumulate(x) # Outputs array([  1,   2,   6,  24, 120], dtype=int32) 
```

明智地使用这些 numpy 操作，同时对一个或多个大型 Numpy 数组执行许多中间操作，可以在不使用任何其他库的情况下为您提供出色的结果。

# vba - Excel VBA 根据另一个工作簿中的单元格范围过滤工作表

> ID：14351258
> 
> 赞同：1
> 
> 时间：2013-01-16T04:13:25.603
> 
> 标签：vba, excel, autofilter

晚上好，

在过去的几个月里，我一直在学习如何使用 VBA 来自动化一些报告。这个网站提供了很大的帮助，我已经能够弄清楚如何做很多事情，但这个问题的解决方案仍然让我望而却步。我有一个相对复杂的宏，它已经完全自动化了这个特定的报告，除了这一步，如果我能解决这个问题，我可以实现报告的完全自动化。

系统会生成一个 .xls 格式的原始数据文件，其中包含必须清理并添加到报告模板中的月份的新数据。X 列包含商品描述，但是许多数据行包含不可接受的商品描述，需要将这些行复制到单独的工作表中并发送给其他人以找到正确的描述。在主报告模板中，我创建了一个可接受的商品描述列表，我希望能够对原始数据文件进行过滤，以便在 X 列中具有不在可接受列表中的值的任何行显示和所有已包含可接受描述的行将被隐藏。

我尝试过操作过滤器、录制宏并尝试操作代码但没有运气。这是我记录动作时得到的。数组开头的一些项目是可接受描述的示例（有意义的东西），最后的随机内容是我想要显示的项目类型的示例，这些需要研究和手动更正。

```
Sub hiderows()
    Windows("stop level data.xls").Activate
    Rows("1:1").Select
    Selection.AutoFilter

    ActiveSheet.Range("$A$1:$AB$1290").AutoFilter Field:=24, Criteria1:=Array( _
    "Cotton", "Covers", "Displays", "Fabric", "Fasteners", "Fiber", "Fiber Rolls", _
    "Fibers", "Foam", "Foam Rolls", "Frames", "Labels", "Latex", "Lumber", "Machines",_
    "Mattresses", "Pads", "Plastic", "PO #Avi", "PO #P0005557/SO #3203687", _
    "PO #P0005615/SO #3203693", "PO #P0007297/SO#3203828", "Rolls", "Serta", "Springs"_
    , "T000216", "T000247", "T000269", "T000270", "T000278", "T000286", "T000294", _
    "T000296", "Tape", "Thread", "Tick", "Ticking", "Transfer from", "Wood", _
    "="), Operator:=xlFilterValues
End Sub 
```

作为第一步，我试图让上面的代码隐藏行而不是通过插入 <> 而不是 = 以多种不同的方式显示它们，但没有运气。我真正想做的是过滤工作表`Windows("Stop level data.xls")`，以便如果`column X`特定行的值不等于`Windows("master template.xlsm").Sheets("lookups").Range("AE2:AE100")`

提前感谢您的时间，我已经花了无数个小时来解决这个问题，并且真的离解决方案更近了。

# verilog - 将 8 位 bmp 转换为半色调 bmp

> ID：14351259
> 
> 赞同：0
> 
> 时间：2013-01-16T04:13:29.347
> 
> 标签：verilog

我现在正在详细解释我的问题，因为我意识到我没有很好地解释我的问题。

我是 Verilog 的初学者。为了学习这门语言，我正在编写一些示例应用程序。
目前我正在编写 Verilog 代码，使用[Floyd-Steinberg](http://en.wikipedia.org/wiki/Floyd%E2%80%93Steinberg_dithering)算法将 8 位 BMP 图像转换为半色调 BMP 图像。基本上我使用上述算法将 8 位像素转换为 1 位。

[我在《 Advanced Digital Design with the Verilog HDL - Michael D. Ciletti](http://books.google.co.in/books/about/Advanced_Digital_Design_with_the_Verilog.html?id=6tW8PQAACAAJ)》一书中找到了该算法的示例代码，第 555 页。我已经成功地在 ModelSim 中模拟了该设计。

问题是该示例是针对大小为 6 x 8 的图像给出的，但为了学习和练习，我正在尝试将此代码转换为不同的格式和大小。作为第一个目标，我尝试修改此代码（我已经很好理解）以适用于大小为 1000 x 1000 的图像。由于该示例仅适用于 48 像素（6 x 8），因此编写说明更容易手动在模块内部，如下面的代码所示。但如果我有 10,00000 像素（1000 x 1000），我该如何更改代码。我不能写这样的方程：

```
 PPDU a0(err_1,htpv_1[1],8'b00,8'b00,8'b00,8'b00,pixel_1); 
```

10,00000 手动（请参阅下面给出的代码）。

我想必须有某种方法可以使这项工作自动化。

在 CI 中，可以使用 for 循环*来*自动化许多事情。但是作为 Verilog 的新手，我无法继续。如果有人能指出一个有用的链接，我真的会很高兴。

```
// pixel processor datapath unit//
module PPDU(err_0,htpv,err_1,err_2,err_3,err_4,pv);
output [7:0]err_0;
output htpv;
input [7:0]err_1,err_2,err_3,err_4,pv;
wire [9:0]cpv,cpv_round,e_av;
parameter w1=2,w2=8,w3=4,w4=2;
parameter threshold =128;
assign e_av=(w1*err_1+w2*err_2+w3*err_3+w4*err_4)>>4;
assign cpv=pv+e_av;
assign cpv_round=(cpv<threshold)?0:255;
assign htpv=(cpv_round==0)?0:1;
assign err_0=cpv-cpv_round;
endmodule

module image_converter (pixel_1,pixel_2,pixel_3,pixel_4,pixel_5,pixel_6,pixel_7,pixel_8,pixel_9,
   pixel_10,pixel_11,pixel_12,pixel_13,pixel_14,pixel_15,pixel_16,pixel_17,
   pixel_18,pixel_19,pixel_20,pixel_21,pixel_22,pixel_23,pixel_24,pixel_25,
   pixel_26,pixel_27,pixel_28,pixel_29,pixel_30,pixel_31,pixel_32,pixel_33,
   pixel_34,pixel_35,pixel_36,pixel_37,pixel_38,pixel_39,pixel_40,pixel_41,
   pixel_42,pixel_43,pixel_44,pixel_45,pixel_46,pixel_47,pixel_48,htpv_1,
      htpv_2,htpv_3,htpv_4,htpv_5,htpv_6
      );
 input [7:0]pixel_1,pixel_2,…..,pixel_47,pixel_48;
 output [1:8]htpv_1,htpv_2,htpv_3,htpv_4,htpv_5,htpv_6;
 wire [7:0]err_1,err_2,……., err_47,err_48;
 PPDU a0(err_1,htpv_1[1],8'b00,8'b00,8'b00,8'b00,pixel_1);
 ...
 PPDU a7(err_8,htpv_1[8],err_7,8'b00,8'b00,8'b00,pixel_8);                       
 PPDU b1(err_9,htpv_2[1],8'b00,8'b00,err_1,err_2,pixel_9);
 ...     PPDU b8(err_16,htpv_2[8],err_15,err_7,err_8,8'b00,pixel_16);
 PPDU c1(err_17,htpv_3[1],8'b00,8'b00,err_9,err_2,pixel_17);
 ….
 PPDU c8(err_24,htpv_3[8],err_23,err_15,err_16,8'b00,pixel_24);
 PPDU d1(err_25,htpv_4[1],8'b00,8'b00,err_17,err_18,pixel_25);
 ….
 PPDU d8(err_32,htpv_4[8],err_31,err_23,err_24,8'b00,pixel_32);
 PPDU e1(err_33,htpv_5[1],8'b00,8'b00,err_25,err_26,pixel_33);
 ….
 PPDU e8(err_40,htpv_5[8],err_39,err_31,err_32,8'b00,pixel_40);
 PPDU fi(err_41,htpv_6[1],8'b00,8'b00,err_33,err_34,pixel_41);
 ….
 PPDU f8(err_48,htpv_6[8],err_47,err_39,err_40,8'b00,pixel_40);  
 end
 endmodule 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:59:24.197

听起来您正在为每个像素实例化一个模块。这一切都很好，但最终会为 1000x1000 图像使用大量硬件，因为每个模块都是一堆门和触发器。这将导致您“一次”转换整个图像，这也意味着您必须“一次”将整个图像获取到这个硬件，这是一个非常多的引脚。

您可能想要做的是：

*   将图像存储在内存中，然后编写状态机读取内存的相关部分，执行抖动并写回
*   通过一些逻辑流式传输图像，该逻辑保持对先前像素的足够了解以执行抖动。我对 FS 抖动不太熟悉，但它可能只需要了解正在处理的那一行之上的一两行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T07:18:58.630

两个想法：

1.  您可以将该`generate`语句用作一种循环来实例化太多而无法输入的模块。我对这个结构不太熟悉，但也许谷歌搜索这个关键字会为你指明正确的方向。

2.  虽然 verilog 是一种硬件描述语言，但没有什么要求您实际手动写出文件。您可以随意使用任何您喜欢的编程语言来生成 verilog 文件（Perl 是我的最爱）。如果你必须根据某种算法生成 100 万个模块，那么你可以编写一个简单的脚本来打印一个 100 万行的 verilog 文件。您不必手动编写它。

# javascript - HTML5 Chrome 检查有效性 onBlur

> ID：14351260
> 
> 赞同：9
> 
> 时间：2013-01-16T04:13:32.983
> 
> 标签：javascript, html, google-chrome, validation

我正在尝试对模糊的数字输入字段进行简单的检查有效性，但无法使其正常工作。这在 Chrome 中还有效吗？例如：

```
<input onBlur="checkValidity()" type="number" name="x" id="x" min="64" max="2048" value=64> 
```

或者

```
<input onBlur="this.checkValidity()" type="number" name="x" id="x" min="64" max="2048" value=64> 
```

好像什么都没做。但是，在控制台中，

```
$("#x")[0].checkValidity() 
```

确实根据输入框中的当前值和上述 (64,2048) 的限制返回 true 或 false。这是坏了，还是我做错了？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-17T03:15:27.780

这是您可能想要前往的演示：

[http://jsfiddle.net/9gSZS/](http://jsfiddle.net/9gSZS/)

```
<input type="number" min="64" max="256" onblur="validate(this);" /> 
```

```
function validate(obj)
{
  if(!obj.checkValidity())
  {
    alert("You have invalid input. Correct it!");
    obj.focus();
  }
} 
```

注意到我只是在这里**展示**这个*概念*；`alert`可能会造成非常**不愉快**的体验，所以不要一味照搬。

使用一些浮动的 DIV 来吸引您的用户，而不是完全阻塞的`alert`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2020-10-31T06:04:27.190

我意识到这个问题在这一点上已经存在*很多*年了，但如果其他人遇到它，实现 OP 想要的行为的正确方法似乎是`onblur="reportValidity()"`改用`onblur="checkValidity"`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T04:28:41.023

您应该使用 onChange 事件

例如

```
var input1 = document.getElementById('txt_username');
    input1.onchange = function(){
        input1.setCustomValidity(input1.validity.patternMismatch ? 'username must match a-z,A-Z,0-9,4-16 character' : ''); 
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-06-22T19:26:24.160

这是一个解决方案

```
$("form").focusout(function(){
        if(!$("form")[0].checkValidity()){
            setTimeout(function(){$(":submit").eq(0).trigger('click');},0);
        }
    }); 
```

如果您的任何表单元素失去焦点，请检查表单有效性。如果表单无效，请让 jquery 单击第一个提交按钮。出于某种原因必须使用超时才能使其正常工作。超时为零只是将函数移动到函数队列的末尾。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-01-17T06:49:29.803

`onblur="checkValidity()"`没有效果，因为`blur`事件是不可取消的。

# opencl - 对长序列的内核和读取进行排队时的内存注意事项

> ID：14351261
> 
> 赞同：0
> 
> 时间：2013-01-16T04:13:37.877
> 
> 标签：opencl

我有很长的内核序列，我需要在一些数据上运行，比如

```
data -> kernel1 -> data1 -> kernel2 -> data2 -> kernel3 -> data3 etc. 
```

我还需要将所有中间结果复制回主机，所以这个想法类似于（伪代码）：

```
inputdata = clCreateBuffer(...hostBuffer[0]);

for (int i = 0; i < N; ++i)
{
    // create output buffer
    outputdata = clCreateBuffer(...);

    // run kernel
    kernel = clCreateKernel(...);
    kernel.setArg(0, inputdata);
    kernel.setArg(1, outputdata);
    enqueueNDRangeKernel(kernel);

    // read intermediate result
    enqueueReadBuffer(outputdata, hostBuffer[i]);

    // output of operation becomes input of next
    inputdata = outputdata;
} 
```

有几种方法可以安排这些操作：

*   最简单的是总是等待上一个入队操作的事件，所以我们在继续下一个内核之前等待读取操作完成。我可以在不需要缓冲区时立即释放它们。
*   或者使一切尽可能异步，其中内核和读取队列只等待以前的内核，因此缓冲区读取可以在另一个内核运行时发生。

在第二种（异步）情况下，我有几个问题：

*   我是否必须在长链操作中保留对所有 cl_mem 对象的引用并在一切完成后释放它们？
*   *重要的是，当所有内存对象的总和超过设备上可用的总内存时，OpenCL 如何处理这种情况？*在任何时候内核都只需要输入和输出内核（应该适合内存），但是如果这些缓冲区中有 4 或 5 个超过了总数，OpenCL 如何在幕后分配/释放这些内存对象？这对读取有何影响？

如果有人能澄清在这些情况下会发生什么，我将不胜感激，也许在 OpenCL 规范中有与此相关的内容。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T23:34:35.457

你的第二种情况是要走的路。

> 在第二种（异步）情况下，我有几个问题：
> 
> ```
> Do I have to keep references to all cl_mem objects 
> in the long chain of actions and release them after 
> everything is complete? 
> ```

是的。但是，如果所有数据数组的大小相同，我将只使用 2 个，并且每次迭代一个接一个地覆盖。那么你只需要有 2 个内存区域，并且释放和分配应该只发生在开始/结束。

不要担心数据有错误的值，如果您设置正确的事件，处理将等待 I/O 完成。IE：

```
data -> kernel1 -> data1 -> kernel2 -> data -> kernel3 -> data1
                -> I/O operation    -> I/O operation 
```

为此，只需设置一个条件，强制 kernel3 仅在第一个 I/O 完成时启动。您可以通过这种方式链接所有事件。

**注意：**使用 2 个队列，一个用于 I/O，另一个用于处理将带来并行 I/O，速度提高 2 倍。

> 重要的是，当所有内存对象的总和超过设备上可用的总内存时，OpenCL 如何处理这种情况？

分配时给出错误 OUT_OF_RESOURCES 或类似错误。

> 在任何时候内核都只需要输入和输出内核（应该适合内存），但是如果这些缓冲区中有 4 或 5 个超过了总数，OpenCL 如何在幕后分配/释放这些内存对象？这对读取有何影响？

它不会自动执行此操作，除非您已将内存设置为主机 PTR。但我不确定 OpenCL 驱动程序是否能正确处理它。如果我是你，我不会分配超过最大值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T19:37:06.083

我的印象是（对不起，我打算引用规范但今天找不到，所以我降低了我的断言的强度）当你用 cl_mem 引用将内核排入队列时，它需要保留这些对象，并且内核完成后释放它们。

这可以让您在将内核加入队列后释放这些对象，而无需等待内核完成运行。这就是异步“clEnqueue”操作与同步操作（即内存释放）协调的方式，并防止运行时和内核使用释放的内存对象。

# c# - 如何使 PerspectiveTransform 工作？

> ID：14351262
> 
> 赞同：5
> 
> 时间：2013-01-16T04:13:49.640
> 
> 标签：c#, image-processing, opencv, emgucv, perspective

我只想重现[此处](http://nuigroup.com/forums/viewthread/3414/)发布的结果。

我将源代码重写为 EmguCV 表单。

```
 Image<Bgr, byte> image = new Image<Bgr, byte>(@"B:\perspective.png");

    CvInvoke.cvShowImage("Hello World!", image);

    float[,] scrp = { { 43, 18 }, { 280,40}, {19,223 }, { 304,200} };
    float[,] dstp = { { 0,0}, { 320,0}, { 0,240 }, { 320,240 } };
    float[,] homog = new float[3, 3];

    Matrix<float> c1 = new Matrix<float>(scrp);
    Matrix<float> c2 = new Matrix<float>(dstp);
    Matrix<float> homogm = new Matrix<float>(homog);

    CvInvoke.cvFindHomography(c1.Ptr, c2.Ptr, homogm.Ptr, Emgu.CV.CvEnum.HOMOGRAPHY_METHOD.DEFAULT, 0, IntPtr.Zero);
    CvInvoke.cvGetPerspectiveTransform(c1, c2, homogm);

    Image<Bgr, byte> newImage = image.WarpPerspective(homogm, Emgu.CV.CvEnum.INTER.CV_INTER_CUBIC, Emgu.CV.CvEnum.WARP.CV_WARP_DEFAULT, new Bgr(0, 0, 0));

    CvInvoke.cvShowImage("newImage", newImage); 
```

这是测试图像。 ![在此处输入图像描述](../Images/f2d8b95a400ac503990deff57408970e.png)

newImage 始终是空白图像。

谁能帮我让我的源代码工作？？？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T04:30:59.060

希望我自己找到了答案。

我将源代码改写为错误的形式。我应该使用 Point[] 并且有`CameraCalibration.GetPerspectiveTransform`功能可以使用。

```
 PointF[] srcs = new PointF[4];
    srcs[0] = new PointF(253, 211);
    srcs[1] = new PointF(563, 211);
    srcs[2] = new PointF(563, 519);
    srcs[3] = new PointF(253, 519);

    PointF[] dsts = new PointF[4];
    dsts[0] = new PointF(234, 197);
    dsts[1] = new PointF(520, 169);
    dsts[2] = new PointF(715, 483);
    dsts[3] = new PointF(81, 472);

    HomographyMatrix mywarpmat = CameraCalibration.GetPerspectiveTransform(srcs, dsts);
    Image<Bgr, byte> newImage = image.WarpPerspective(mywarpmat, Emgu.CV.CvEnum.INTER.CV_INTER_NN, Emgu.CV.CvEnum.WARP.CV_WARP_FILL_OUTLIERS, new Bgr(0, 0, 0)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-27T09:32:10.247

这是 EmguCV 版本 3 的扩展方法（不推荐使用许多功能）：

```
public static Image<TColor, TDepth> GetAxisAlignedImagePart<TColor, TDepth>(
    this Image<TColor, TDepth> input,
    Quadrilateral rectSrc,
    Quadrilateral rectDst,
    Size targetImageSize)
    where TColor : struct, IColor
    where TDepth : new()
{
    var src = new[] { rectSrc.P0, rectSrc.P1, rectSrc.P2, rectSrc.P3 };
    var dst = new[] { rectDst.P0, rectDst.P1, rectDst.P2, rectDst.P3 };

    using (var matrix = CvInvoke.GetPerspectiveTransform(src, dst))
    {
        using (var cutImagePortion = new Mat())
        {
            CvInvoke.WarpPerspective(input, cutImagePortion, matrix, targetImageSize, Inter.Cubic);
            return cutImagePortion.ToImage<TColor, TDepth>();
        }
    }
} 
```

# .net - LinqToSql 重复记录插入关系

> ID：14351263
> 
> 赞同：0
> 
> 时间：2013-01-16T04:13:50.013
> 
> 标签：.net, windows-phone-7, linq-to-sql, async-await

我有一个奇怪的情况，我无法弄清楚原因。在启动 Windows Phone 应用程序时，我有以下代码，其中我只是创建了一些`Group`s，然后创建了一些`Account`s，其中先前创建`Group`的 s 是与 s 相关的对象`Account`。

```
public async static void SampleData()
{
     var grp1 = await Manager.GroupManager.SaveGroupAsync(new Group { GroupName = "Wells Fargo" });
     var grp2 = await Manager.GroupManager.SaveGroupAsync(new Group { GroupName = "Chase" });
     var grp3 = await Manager.GroupManager.SaveGroupAsync(new Group { GroupName = "Citi" });

     var acct1 = await Manager.AccountManager.SaveAccountAsync(new Account { AccountName = "Spending", AccountType = (int)Enums.AccountType.Banking, Group = grp1 }); //0
     var acct2 = await Manager.AccountManager.SaveAccountAsync(new Account { AccountName = "Credit Card", AccountType = (int)Enums.AccountType.Credit, Group = grp1 }); //1
     var acct3 = await Manager.AccountManager.SaveAccountAsync(new Account { AccountName = "Mortgage", AccountType = (int)Enums.AccountType.Banking, Group = grp2 }); //2
     var acct4 = await Manager.AccountManager.SaveAccountAsync(new Account { AccountName = "Savings", AccountType = (int)Enums.AccountType.Banking, Group = grp2 }); //3
     var acct5 = await Manager.AccountManager.SaveAccountAsync(new Account { AccountName = "Spending", AccountType = (int)Enums.AccountType.Banking, Group = grp2 }); //4
     var acct6 = await Manager.AccountManager.SaveAccountAsync(new Account { AccountName = "Credit Card", AccountType = (int)Enums.AccountType.Credit, Group = grp3 }); //5
} 
```

相应的方法：

**经理人**

```
public async static Task<Group> SaveGroupAsync(Group group)
{
    await DataAccess.GroupData.SaveGroupAsync(group);

    return group;
}

public async static Task<Account> SaveAccountAsync(Account account)
{
    await DataAccess.AccountData.SaveAccountAsync(account);

    return account;
} 
```

**数据访问**

```
public async static Task<Group> SaveGroupAsync(Group group)
{
    using (var dc = new CbmDataContext(DBHelper.LocalConnectionString))
    {
        if (group.GroupId == 0)
            dc.Groups.InsertOnSubmit(group);

        dc.SubmitChanges();

        return group;
    }
}

public async static Task<Account> SaveAccountAsync(Account account)
{
    using (var dc = new CbmDataContext(DBHelper.LocalConnectionString))
    {
        if (account.AccountId == 0)
            dc.Accounts.InsertOnSubmit(account);

        dc.SubmitChanges();

        return account;
    }
} 
```

当组的前 3 个保存运行时，我看到插入了 3 个新对象。这是我的预期行为。当代码为第一个新帐户运行时**，**我看到了新帐户，但我还在组表中看到了引用帐户的新条目。我最终得到了 2 个同名的组。

我做错了什么导致这种情况发生？我可以看到 Account.GroupId 设置为下面设置的组的 ID。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T14:38:41.967

所以我偶然发现了一个*解决方案*，但不是一个答案。

我从这里的一个答案的评论中找到了方向 - [LINQ to SQL - 你的 DataContext 住在哪里？](https://stackoverflow.com/questions/196253/linq-to-sql-where-does-your-datacontext-live)

> 据我了解，您仍然需要一个 DataContext 来管理实体的生命周期，以便 SubmitChanges() 能够在不重新附加实体的情况下正常工作。正确的？获取->编辑->提交。在这种情况下，您的 DataContext 位于方法范围之外，并且“使用”的价值较低。

在其他 DAO 继承自 BaseData 类上，我抛出了我的数据上下文的静态实例，并刚刚从 DAO 中删除了所有使用，所以现在它们使用相同的数据上下文。

```
public static CbmDataContext dc = new CbmDataContext(DBHelper.LocalConnectionString); 
```

所以我想因为我在这里使用相同的数据上下文实例，它能够更好地跟踪实体，而不是新实例。

# wpf - WPF 和视频逐帧处理

> ID：14351264
> 
> 赞同：0
> 
> 时间：2013-01-16T04:14:00.247
> 
> 标签：wpf, image-processing, webcam, video-processing

谁能给我一个关于如何在 WPF 中访问网络摄像头并逐帧处理它以更快地进行视频处理的示例？在每一帧上，我都必须找到对象以进行进一步的图像处理

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-22T20:17:15.967

使用[WPFMediaKit](http://wpfmediakit.codeplex.com/)（开源项目）并使用控件

```
WPFMediaKit.DirectShow.Controls.VideoCaptureElement 
```

只需设置它的属性`VideoCaptureDevice`

```
myVideoCaptureElementcontrol.VideoCaptureDevice = MultimediaUtil.VideoInputDevices[0]; 
```

0 是视频输入设备的索引。

# ruby-on-rails - 带有身份验证令牌的 Rspec 存根/模拟 (authlogic)

> ID：14351265
> 
> 赞同：1
> 
> 时间：2013-01-16T04:14:03.340
> 
> 标签：ruby-on-rails, rspec, authlogic

第一次在这个有用的社区上发帖，但自从我开始编程之旅以来就一直在使用它。我是 Rails 新手，无法编写测试。到目前为止，我一直在尝试基于[Authlogic perishable token guide](http://www.binarylogic.com/2008/11/16/tutorial-reset-passwords-with-authlogic/)编写控制器测试。

但是在测试过程中，一直卡在线上

```
#controller
@user = User.find_using_perishable_token(params[:activation_code], 1.week) || (redirect_to new_user_session_url and return) 
```

这是测试中遇到麻烦的那一行：

```
#test
User.any_instance.stub(:find_using_perishable_token) {mock_model(User, stubs(:active => true)) }
get :create, :activation_code => 'valid'
response.should render_template 'new'

response.code.should == "200"
#the test response is 302, not 200
response.should redirect_to("/")
#the test shows the path as user_sessions/new,
#meaning it didn't pass the condition in the controller with the find_using_pt method 
```

下面是测试输出：

```
Failure/Error: response.should render_template 'new' expecting <"new"> but rendering with <""> 
# ./spec/controllers/activations_controller_spec.rb:18:in `block (3 levels) in <top (required)>' 
```

在阅读[了发布的答案之一后](https://stackoverflow.com/questions/4446378/understanding-rails-3s-respond-with)，似乎我没有正确创建存根/模拟，这就是为什么它不断获得 redirect_to (302) 而不是继续测试的原因。（find_using_pt 是 Authlogic 的一种方法）。因此，问题在于 redirect_to 行，因为它永远不会继续控制器/页面渲染

任何建议将不胜感激。谢谢。

# c# - 按下回车键时更改焦点控制

> ID：14351267
> 
> 赞同：6
> 
> 时间：2013-01-16T04:14:15.117
> 
> 标签：c#, .net, winforms

我有一个 Windows 窗体，当用户按下`Enter`设置焦点到下一个控件时我需要。知道如何实现这一点（不使用按键事件）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T04:35:26.820

您可以捕获表单的 KeyPreview。在构造函数中将 KeyPreview 设置为 true ，然后您可以使用它：

```
protected override bool ProcessKeyPreview(ref Message m)
{
    if (m.Msg == 0x0100 && (int)m.WParam == 13)
    {
        this.ProcessTabKey(true);
    }
    return base.ProcessKeyPreview(ref m);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T04:46:13.213

您可以使用 ProcessCmdKey 检查 keyData 是否包含`Enter`密钥，然后使用[`SelectNextControl`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.selectnextcontrol%28v=vs.100%29.aspx)方法设置焦点。

```
protected override bool ProcessCmdKey(ref Message msg, Keys keyData)
{
    if (keyData.HasFlag(Keys.Enter)) 
    {
        SelectNextControl(ActiveControl,true,true,true,true);
        return true; //Stops the beeping
    }

    return base.ProcessCmdKey(ref msg, keyData);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T04:38:32.437

如果您不想使用按键事件，则必须覆盖`ProcessCmdKey`

```
protected override bool ProcessCmdKey(ref Message msg, Keys keyData)
{
    if (keyData == Keys.Return)
    {
        MessageBox.Show("You pressed the Enter key");
    }
    return base.ProcessCmdKey(ref msg, keyData);
} 
```

# php - 表 '/mysql-tmp/#sql_78b5_0.MYI' 的密钥文件不正确；或“从存储引擎得到错误 x”

> ID：14351268
> 
> 赞同：1
> 
> 时间：2013-01-16T04:14:15.507
> 
> 标签：php, mysql, codeigniter

我将 CodeIgniter 框架用于我的一个 Web 应用程序。

我在运行应用程序的开发环境中没有任何问题，而且在大多数情况下，我的应用程序在生产环境中运行良好。

但是，我和我的用户收到了一些关于数据库的零星错误。

1.  表 '/mysql-tmp/#sql_78b5_0.MYI' 的密钥文件不正确；
2.  从存储引擎收到错误 28
3.  从存储引擎得到错误-1

数据库错误消息如下所示：

> 错误 -2013-01-15 13:56:35 --> 数据库错误消息：
> 
> 错误号：126
> 
> 表 '/mysql-tmp/#sql_78b5_0.MYI' 的密钥文件不正确；尝试修复它
> 
> SELECT bw.bw_id ,bw.wod_date ,CASE WHEN ifnull(bw.simple_title,'') = '' THEN 'No name given' ELSE simple_title END AS simple_title ,COUNT(mw.bw_id) ASrecorded_wod FROM box_wod bw LEFT JOIN member_wod mw ON bw.bw_id = mw.bw_id AND mw.member_id = 15 WHERE box_id = 3 GROUP BY bw.bw_id, bw.wod_date, simple_title, mw.bw_id ORDER BY bw.wod_date DESC
> 
> 文件名：/hermes/.../box_model.php
> 
> 行号：400

我对答案的搜索都指向一条路径：可用磁盘空间。

我试图向我的托管服务提供商指出这一点，但他们声称这不是问题：

> 我已经检查了您报告的问题。没有 MySQL 服务器问题。我检查了提供的错误日志，您的数据库表似乎存在问题。目前，您的网站运行良好，没有任何问题。请检查您的数据库表。
> 
> “表'/mysql-tmp/#sql_78b5_0.MYI'的密钥文件不正确;” 如果您还有其他问题，请更新支持控制台。

我已经对我所有的桌子进行了维修；我的数据库大约是一兆字节。我仍然得到这个问题。

是否有任何其他设置问题（CI 或我的数据库）可能导致此问题？

CI 框架是否会创建可能损坏的临时表？

我确实写了我的 SQL 语句，但在我发送它们之前它们都可以工作。

我只是想了解什么（除了磁盘空间）可能导致这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T15:50:41.423

简而言之，答案是你得到你所支付的。

我的托管服务提供商在服务器上发生了一些事情。在支持下来回走了很多次后，他们擦干了这个问题。此外，它们不会让用户访问存储您的代码的服务器；所以除了在我的开发机器上运行良好的代码之外，我没有什么可以解决的。

因此，我选择搬到新的托管服务提供商，问题就消失了。

# ruby - 为什么我得到“文件：类的未定义方法'存在'”？

> ID：14351272
> 
> 赞同：3
> 
> 时间：2013-01-16T04:14:59.693
> 
> 标签：ruby

我刚刚在我的 Ubuntu 机器上安装了 Ruby，然后这样做了：

```
$ ruby --version
ruby 1.9.3p0 (2011-10-30 revision 33570) [i686-linux]

$ ruby
p File.basename("foo")
p File.exist("foo")
"foo"
-:2:in `<main>': undefined method `exist' for File:Class (NoMethodError) 
```

我阅读[文件](http://www.ruby-doc.org/core-1.9.3/File.html)文档页面的方式，这不应该吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-16T04:16:40.647

`?`您忘记了末尾的问号 ( )：

```
File.exist? 'foo'
File.exists? 'foo' 
```

一般来说，回答问题的方法总是以问号结尾。

在这种情况下，方法是提出`File`问题`does 'foo' exist?`。班级将返回答案。

# asp.net - 需要建议 Asp.Net DropDown LIist 过滤

> ID：14351273
> 
> 赞同：0
> 
> 时间：2013-01-16T04:15:00.093
> 
> 标签：asp.net

3262点

662个帖子需要建议

17 小时 13 分钟前|LINK

我有一个插入数据页面，页面上有一个下拉菜单项正在从 SQL 数据源填充（使用后面的代码）我需要应用一些过滤器从下拉菜单中删除某些值（用户将选择一些单选按钮，然后应用过滤器，当过滤器应用时，它将从下拉列表中删除不需要的项目）

现在我不知道什么是最好的程序，我做过：1）使用AJAX更新面板，所以当用户点击应用时，我正在重新生成查询并重新绑定下拉列表）所以它涉及服务器往返，每次用户点击应用按钮。最好的一点是，如果用户想一个一个地插入记录，那么用户不必一次又一次地应用过滤器（一旦应用它只会在每次插入记录后显示过滤后的值）

2）使用客户端javascript我已经实现了相同但这里的大问题是一旦插入记录，页面将刷新，因此下拉菜单将再次显示所有未过滤的值

我需要关于在这方面我应该遵循哪种技术的建议，请帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T05:52:26.360

使用 ajax 是最好的选择，但是在 sql 中创建一个存储过程，这样它可能会减少重新生成查询的时间。

# jquery - jquery error Uncaught SyntaxError: Unexpected end of input

> ID：14351277
> 
> 赞同：1
> 
> 时间：2013-01-16T04:15:31.497
> 
> 标签：jquery, jquery-plugins

我正在使用 jquery 插件来上传内容。但是当我上传内容时出现错误，显示输入意外结束。这是代码片段

```
 function uploadPacket(packet){

    var xhr = new XMLHttpRequest();
    var url = self.url + "?fileid="+self.fileDetails.fileId+"&token="+self.fileDetails.token+"&packet="+self.fileDetails.currentPackage;
    //alert(url);
    var fileDetails = self.fileDetails;
    updateProgress(fileDetails,0);
    xhr.open('POST', url, true);
    xhr.onprogress = function(e){
        updateProgress(fileDetails,e.position);

    // var percentComplete = (e.position / e.totalSize)*100;
    //console.log(percentComplete);
    //   progressBar.value = percentComplete;
    //  loadedSize.innerHTML = e.position;
    // speed.innerHTML = ((e.position-startedBytes)/1024)/((new Date().getTime()-timer)/1000)+ " kbps";

    };

    /**
     * If the server uploaded the packet successfully, then go to updateDetails() where log the success,
     * and initiate uploading the next package (if we not paused while it uploaded)
     */
    xhr.onload = function (e){
        //alert(e);
        var response = JSON.parse(xhr.responseText);  // here is the error showing

        if (response.action=="new_packet" && response.result=="success"){                
            updateDetails(fileDetails);
        }      

    }; 

    xhr.send(packet);
} 
```

请任何人帮助我

# asp.net - 数据库/表更改频繁的良好应用程序设计

> ID：14351279
> 
> 赞同：0
> 
> 时间：2013-01-16T04:15:47.750
> 
> 标签：asp.net, sql-server, entity-framework, application-design

在微软开发环境中，即。.net、c#、sql server、实体框架等：对于由于业务需求而频繁向底层数据库中的表添加表和列的应用程序，最佳设计是什么。

在这种情况下使用 ORM/Entity 框架的问题在于，您必须更新模型、重新编译和重新部署应用程序，这可能会很痛苦 + 如果添加这些新列需要简单到复杂的数据验证，那么您有还要在正确的地方仔细编写代码。

只是想找出是否有一种简单有效的方法来使用 ORM 的强大功能，而不是为每一件小事都创建 SP。

* * *

同一问题的第 2 部分：

为什么我不能告诉 ORM 我想使用这些表（或整个数据库），然后它会在运行时生成类。我知道事情不会因此而被强类型化。最大的一个缺点是设计时/编译时错误不会像在强类型设计中那样发生，这会迫使您编写更少的错误代码（或至少因此节省大量时间）。

但这至少会解决以下问题：

*   它将从 db 中获取所有列（包括新列）
*   你不必编译，部署因为小的变化

现在，如果有一种简单的方法可以使用 ORM 或有助于这种设计的东西来实现一个好的设计，请告诉我。建议将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T05:55:29.480

正如您所建议的那样，数据库模式的不断扩展使其成为维护噩梦。而是考虑采用垂直方法。例如，设想一个模式映射表，其中每个新记录代表该实体的一个新属性。每当需要一个新属性（本质上是水平表结构上的一个新列）时，它就被简单地创建为一个新记录。

```
PropertyID(PK)      PropertyName
1                   ID
2                   Name
3                   Description
4                   LastModDate 
```

第二个表将保存实体实例记录

```
InstanceID      PropertyID(FK)  PropertyValue
1               1               1
1               2               Target Field
1               3               Minnesota Twins baseball stadium
1               4               1/15/2013 12:00:00 PM 
```

然后，您的 C# 模型将保存代表实体实例的通用属性对象列表。特定实体的属性列表及其值将在运行时从实体的实例记录中填充。

```
public class EntityInstance
{
    public int InstanceID { get; set; }
    public List<InstanceProperty> Properties { get; set; }
}

public class InstanceProperty
{
    public int PropertyID { get; set; }
    public string PropertyName { get; set; }
    public object PropertyValue { get; set; }
} 
```

这种方法可以扩展您的数据模型架构，而无需不断地重新生成实体，或者更糟糕的是，每次都向您的托管代码添加特定的新属性以使用它们。

我们非常成功地为我们庞大的产品线实施了一个高度可配置的规则引擎，然后驱动了整个公司使用的多个独立应用程序的选项、工作流程和行为。我上面的例子有点陈词滥调，但它们有助于说明这一点。

同样，关键是“垂直”而不是“水平”思考。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-16T05:55:33.740

在这样的环境中尽量保持每个表独立，我的意思是表之间没有很多关系。我们也面临同样的问题，为此我们遵循 AGILE 方法。此链接将帮助您 [敏捷地进行更改](http://martinfowler.com/articles/evodb.html)

# android - ExpandableListView 项目点击次数

> ID：14351280
> 
> 赞同：0
> 
> 时间：2013-01-16T04:15:48.110
> 
> 标签：android, expandablelistview, onclicklistener, android-menu, expandablelistadapter

我正在尝试在[SlidingMenu](https://github.com/jfeinstein10/SlidingMenu)中使用 ExpandableListView 。我无法让我的 OnItemClickListeners 响应项目点击。我已通过以下方式将 SlidingMenu 附加到 Activity：

```
slidingMenu = new SlidingMenu(this);
slidingMenu.setMode(SlidingMenu.LEFT);
slidingMenu.setTouchModeAbove(SlidingMenu.TOUCHMODE_MARGIN);
slidingMenu.attachToActivity(this, SlidingMenu.SLIDING_CONTENT);
slidingMenu.setSlidingEnabled(true);
slidingMenu.setBehindWidth(getSlidingMenuWidth());
slidingMenu.setMenu(R.layout.slideoutmenu); 
```

ExpandableListView 位于从 R.layout.slideoutmenu 膨胀的视图中，并且我将单击侦听器设置如下： `((ExpandableListView)findViewById(R.id.slidingmenu_explist)).setOnItemClickListener(this);` 单击项目时永远不会触发事件侦听器。如何处理 SlidingMenu 视图中的点击事件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-28T20:45:44.563

将 click 事件写在 expandlistview 适配器中。在您定义内容的地方。现在使用 framelayout 替换视图的内容

# sql - 在 SQL 中透视 3 列

> ID：14351282
> 
> 赞同：2
> 
> 时间：2013-01-16T04:15:51.307
> 
> 标签：sql, sql-server-2008, pivot

嗨，我有一个包含 140 万条记录的表。表结构如下

```
Col_1 INT, -- this column has post Codes
Col_2 VARCHAR, -- This Column Shop Names 
Col_3 MONEY, -- this column has distance from every Shop Name to post code with in 50 KM radius.

Total distinct post shop names are = 350
Total Distinct post codes are = 50,000 
```

我想对数据进行透视，以便在 excel（以矩阵形式排序）中轻松使用数据，其中 1 列包含所有邮政编码，第一行包含所有商店名称，并且在邮政编码和商店名称的交点处是相应的距离。我可以使用 powerpivot 旋转数据，但由于记录数，它每次都会崩溃。

### 表例：

```
1\. Col_1    Col_2  Col_3
2\. 521025   Rams   7
3\. 526256   Rams   8
4\. 521025   SPhi   9
5\. 526252   pho    10 
```

### 需要输出

```
1\. PostCode Rams  Sphi  Pho
2\. 521025   7     9     0
3\. 526256   8     0     10 
```

我如何在 SQL 中实现这一点 任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T10:15:13.830

这种从行到列的转换称为[`PIVOT`](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx). 在 SQL Server 2005+ 中添加了一个可以执行此轮换的函数。

如果您提前知道这些值，那么您可以使用静态数据对它们进行硬编码：

```
select col_1, 
  IsNull(Rams, 0) Rams, 
  IsNull(Sphi, 0) Sphi, 
  IsNull(pho, 0) Pho
from
(
  select col_1, col_2, col_3
  from yourtable
) src
pivot
(
  sum(col_3)
  for col_2 in (Rams, Sphi, Pho)
) piv 
```

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/99423/2)。

但是，如果您有未知数量的值需要转置到列中，那么您可以使用动态 sql 来执行此操作：

```
DECLARE @cols AS NVARCHAR(MAX),
    @colsNull AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT distinct ',' + QUOTENAME(col_2) 
                    from yourtable
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

select @colsNull = STUFF((SELECT distinct ', IsNull(' + QUOTENAME(col_2)+', 0) as '+QUOTENAME(col_2)
                    from yourtable
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT col_1,' + @colsNull + ' from 
             (
                select col_1, col_2, col_3
                from yourtable
            ) x
            pivot 
            (
                sum(col_3)
                for col_2 in (' + @cols + ')
            ) p '

execute(@query) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/9cb33/2)

两者的结果是：

```
|  COL_1 | PHO | RAMS | SPHI |
------------------------------
| 521025 |   0 |    7 |    9 |
| 526252 |  10 |    0 |    0 |
| 526256 |   0 |    8 |    0 | 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T04:33:10.083

请检查

```
SELECT 
    Col_1 AS PostCode, 
    ISNULL(Rams, 0) Rams, 
    ISNULL(Sphi, 0) Sphi, 
    ISNULL(Pho, 0)Pho
FROM(
    SELECT Col_1, Col_2, Col_3 FROM YourTable
)UP
PIVOT(SUM(Col_3) FOR Col_2 IN (Rams, Sphi, Pho)) AS PVT 
```

# html - 仅将 HTML 发送到没有 css、js 等的爬虫/机器人？它会导致负面排名谷歌吗？

> ID：14351286
> 
> 赞同：0
> 
> 时间：2013-01-16T04:16:12.380
> 
> 标签：html, web-crawler, strip, markup-extensions

今天，一些爬虫通过了我的网站，并试图访问几个 css、js、图像和其他文件。这也是一个聪明的方法，它也解释了 javascript 并希望执行一个在 javascript 代码中组装（并且只知道）的 url！这让我很担心分配。

尽管我在网站上的代码检测到了这种奇怪的行为并向我发送了三封关于它的电子邮件（这是我过去制作的一个拦截器类，它运行良好并阻止了进一步的访问（在攻击者停止三次攻击后），我希望最大限度地消除这些坏人，以减少网络流量、保护服务和花在这个 b*llsh*t 上的时间。

所以我只是在想，将剥离的 html 文件内容（没有表单、css 和 js 声明）发送到机器人/爬虫，但它不能影响好的内容。这背后的想法是爬虫不需要标记的东西，只有内容很重要，对吧？只有坏人会尝试访问对排名不重要的文件....但是当它不存在时，没有什么可担心的。所以我的问题是：

这样做是否安全，我的意思是，谷歌不会“认为”你伪造内容吗？为爬虫移除部分与原始内容略有不同。

有没有人有这方面的经验？

PS：对我来说，这很容易实现，因为我的模板系统可以使用用户代理/设备特定条件来服务例如另一个标记或设置。为了让您了解它是如何工作的，这里是一个手持设备的示例：

```
<!-- #IF $is_handheld -->
<!-- iPhone, iPad mobile/handheld devices -->
<meta name="viewport" content="width=device-width,initial-scale=0.9,maximum-scale=2.0,user-scalable=1" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<!-- #ENDIF --> 
```

这是我想实现的一个例子：

```
<!-- #IF !$is_robot -->
<link rel="stylesheet" type="text/css" charset="utf-8" href="css/dialog.css" />
<link rel="stylesheet" type="text/css" charset="utf-8" href="css/general.css" />
<script rel="combine,minify" type="text/javascript" charset="utf-8" src="js/general.js"></script>
<!-- #ENDIF --> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T23:52:18.073

对此进行了一段时间的测试，没有任何副作用，它不会造成负面排名。

此外，另一个积极的事情是坏机器人找不到任何 css 和 js 文件来搞乱，因为它们没有被指定。因此，在某些方面，它也是保护其他内容的安全方式。

此外，当您仅使用背景图像时，您可以避免它被机器人索引。

# asp.net - 如何布局项目如何在asp gridview中显示？

> ID：14351287
> 
> 赞同：1
> 
> 时间：2013-01-16T04:16:15.003
> 
> 标签：asp.net

我想根据以下格式更改 gridview 显示其项目的方式。

* * *

```
 <img1>          <img2>           <img3>          <img4>
<caption1>      <caption1>        <caption1>     <caption1>

  <img5>          <img6>           <img7>          <img8>
<caption5>      <caption6>        <caption7>     <caption8> 
```

等等...

* * *

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T04:32:37.510

您可以将自定义格式选项与**DataList 或 Repeater 控件**一起使用，而不是 GridView。检查这些示例以获得帮助：

[http://csharpdotnetfreak.blogspot.com/2009/05/aspnet-creating-shopping-cart-example.html](http://csharpdotnetfreak.blogspot.com/2009/05/aspnet-creating-shopping-cart-example.html)。

[http://www.asp.net/web-forms/tutorials/data-access/displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data- VB](http://www.asp.net/web-forms/tutorials/data-access/displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-vb)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T04:20:04.543

将`AutoGenerateColumn`gridview 的属性设置为 false ，然后使用 `<asp:TemplateField><ItemTemplate>`under `<Columns>`section 以您喜欢的方式添加控件。

# javascript - javascript逻辑运算符不返回正确的值

> ID：14351301
> 
> 赞同：0
> 
> 时间：2013-01-16T04:17:24.547
> 
> 标签：javascript

我有这样的代码。

```
No1 : <input type="text" name="no1">  value = 45
No2 : <input type="text" name="no2">  value = 55

<script>
      var no1 = $('input[name=no1]').val();
      var no2 = $('input[name=no2]').val();
</script> 
```

但我这样检查，它总是返回`false`。

```
parseFloat(no1) < parseFloat(no2);
//false 
```

请解释这背后的理论。我是 JavaScript 新手。我谷歌也找不到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T04:19:31.900

好吧，就目前而言，两个输入都有一个空值，所以`parseFloat`给`NaN`，这是不可比较的，因此任何涉及它的比较都是错误的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-16T04:24:42.487

我同意 Kolink 试试这个。

```
No1 : <input type="text" name="no1">
No2 : <input type="text" name="no2">

<script>
      var no1 = document.getElementsByName('no1')[0].value;
      var no2 = document.getElementsByName('no2')[0].value;
      // will evaluate properly as long as you supply number inside input text
      parseFloat(no1) > parseFloat(no2);
</script> 
```

# asp.net - 在 asp.net 中获取我的文档路径

> ID：14351302
> 
> 赞同：0
> 
> 时间：2013-01-16T04:17:35.053
> 
> 标签：asp.net, windows-7, iis-7

不要将其视为与此完全相同的[副本](https://stackoverflow.com/questions/7052644/environment-getfolderpathenvironment-specialfolder-internetcache-returns-empty)

我在 vs 2010 中开发 asp.net 站点。我需要获取**MyDocuments 路径**以用于某些存储目的。所以我使用了以下内容。

```
Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments) 
```

当我在 VS 中运行我的网站时，它可以工作。但是如果我在 IIS（本地）上运行，它会返回空值。

所以试图设置`AppPoolIdentity to LocalSystem`. 但这也行不通。

如何克服这种情况？请给我建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T04:24:39.263

考虑到您将 NetworkServices 或 LocalSystem 用于 AppPool，这似乎是一个放置文档的奇怪地方。为什么不在 web.config 文件中放置一个路径？

# java - Servlet doGet、doPost 和 Ajax

> ID：14351303
> 
> 赞同：0
> 
> 时间：2013-01-16T04:17:40.073
> 
> 标签：java, servlets

**简介：** 我对 servlet 中的 doGet 和 doPost 之间的关系有点陌生。

**范围：** 我正在构建一个工具来帮助我建立一个在线拍卖网站，其中：

1.  我（用户）在表单（html 页面）中输入一个名称，这个名称将是一个 URL（可能出售 -> 业务方法通过 API 确定）
2.  html 表单在 doPost 中发布表单名称，然后 doPost 使用表单名称作为参数来调用业务方法
3.  在调用业务方法后，我重定向到结果 html/js 页面，该页面使用 Ajax 调用 doGet 方法以获取关联的输出（业务逻辑方法中填充的公共类字符串）

**问题：** Ajax 页面似乎没有从 doGet 获得输出（实际上 doGet 似乎没有要给出的字符串，没有错误 - 只是像 String="" 这样的空白。直到业务逻辑方法添加到它为止）。

***问题 1：*** 如何使用 doPost 请求表单 String 'st' 以便我可以调用业务方法，同时也可以重定向到 html/js 结果页面，并且还可以从 Ajax 调用 doGet

***问题 2：*** 我一直在尝试通过阅读 SO 和其他网站来解决我的答案——但想正式提问而不是推测：使用 servlet 是实现 Scope（以上）的最快方法吗？与 JSP 或任何其他 Java 服务器端库/框架相反？

硬件/软件：CentOS 6.3，16gb ram，物理节点，corei7 @3.2，容器是 tomcat 7

HTML

```
<html>
<head>
<title>URL Search Page</title>
</head>
<body>
<CENTER>
 <FORM ACTION="/ResultServlet/Results" METHOD=GET>
   <INPUT TYPE=TEXT NAME="st">
   <INPUT TYPE=SUBMIT VALUE=Submit>
  </FORM>
</CENTER>
</body>
</html> 
```

小服务程序

```
@WebServlet("/Results")
public class Results extends HttpServlet {
    private static final long serialVersionUID = 1L;
       public static String str="";

    public static void businessLogic(String q){
        try {
            str = new compute.URL.GetAvailURI( "https://www.registerdomains.com/auctionAPI/Key:a05u3***1F2r6Z&urlSearch="+q);
            /*more boring number crunching */
            }

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        response.setContentType("text/html");
        PrintWriter printWriter  = response.getWriter();
        printWriter.println(str);
    }

    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String st = request.getParameter("st");
        businessLogic(st);
        response.sendRedirect("results/resultActionURL.html");

    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T05:08:07.477

您形成方法的一个问题是，当您提交表单时，它将在 servlet 中运行 doget 方法，这对您的情况没有任何作用。

所以先把方法改成post然后试试运行，把你写过ajax代码的html页面的代码也贴一下。

我认为您正在从 ajax 方法调用相同的 servlet，但当时 str 中的值不会保留，因此在重定向到时附加所需的数据作为查询字符串

```
response.sendRedirect("results/resultActionURL.html?st="+ st); 
```

您可以通过使用 javascript 获得此值

```
 function getParameterByName(name) {
                name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
                var regexS = "[\\?&]" + name + "=([^&#]*)";
                var regex = new RegExp(regexS);
                var results = regex.exec(window.location.search);
                if (results == null)
                    return "";
                else
                    return decodeURIComponent(results[1].replace(/\+/g, " "));
 }
 var st=getParameterByName(st);
 //add your ajax call code and pass st as data there. 
```

希望这能回答你的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T04:50:51.373

您正在通过这样做使您的应用程序有状态。您正在跨请求将数据存储在服务器中。

这意味着您的逻辑取决于按顺序触发相同的 servlet 对象的事实

1.  发布请求 - 调用业务方法并填充字符串
2.  获取请求 - 尝试检索上次请求中填充的字符串。

首先，这根本不需要，您可以在从 doPost 本身重定向期间将填充的字符串作为参数或 cookie 值传递给浏览器。

即使你想在会话中存储这个字符串 `request.getSession().setAttribute("str", populated string)`

并在 doGet 方法中使用

`request.getSession().getAttribute("str"`

这比在你的 servlet 中有一个实例变量要好得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T04:51:28.900

一旦你重定向到其他页面 servlet 将破坏请求和响应对象和变量值......所以你不能得到旧的......所以尝试在重定向之前获取或将其保存在会话对象上......

# c++ - 被释放的指针没有分配？

> ID：14351304
> 
> 赞同：1
> 
> 时间：2013-01-16T04:17:58.103
> 
> 标签：c++, pointers

请告诉我第三行在做什么。

```
int main(){

int *p = new int[3];

*p++=0; // What's this line doing?

delete p;

return 0;   
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T04:22:29.327

`*p++=0;`这意味着：

1.  将零字节写入`sizeof(int)`存储在`p`.
2.  增加 的`p`值`sizeof(int)`。

换句话说——你已经增加了指针，然后你传递给`delete`的内容与 operator 返回的内容不同`new[]`。

正如@FredLarson 也提到的，您必须使用`delete [] p;`才能删除数组。

另外，我建议您阅读指针、指针算术和前/后增量。[从我们的权威 C++ 书籍指南和列表](https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list)中挑选一本书。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T06:02:25.980

数组中的第一个元素设置为 0，p 前进 1 以指向第二个元素。

```
delete p; // this has undefined behaviour 
```

改为使用`delete [] p;`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T04:22:09.217

您正在将 p[0] 设置为 0 并将指针推进到 p[1]。你想做什么？

# c# - 生成一个自定义 HtmlHelper 方法html字符串

> ID：14351305
> 
> 赞同：1
> 
> 时间：2013-01-16T04:18:00.607
> 
> 标签：c#, asp.net-mvc, html, lambda

据我所知，`HtmlHelper`类中没有（扩展）方法可以生成 HTML5`input`类型的元素，`range`所以我试图通过扩展`HtmlHelper`类来实现我自己的：

```
public static class MvcHtmlHelper
{
    public static HtmlString RangeFor<TModel, TProperty>
    (this HtmlHelper<TModel> htmlHelper,
        Expression<Func<TModel, TProperty>> expression,
        object htmlAttributes)
    {
        var name = ExpressionHelper.GetExpressionText(expression);
        var metadata = ModelMetadata.FromLambdaExpression(expression,
                       htmlHelper.ViewData);
        //var min = (string)((ViewDataDictionary<TModel>)htmlAttributes)["min"];
        //var max = (string)((ViewDataDictionary<TModel>)htmlAttributes)["max"];
        //var value = (string)((ViewDataDictionary<TModel>)htmlAttributes)["value"];
        return Range(htmlHelper, min, max, value);
    }

    public static HtmlString Range(this HtmlHelper htmlHelper, 
        string name, string min, string max, string value = "0")
    {
        var builder = new TagBuilder("input");
        builder.Attributes["type"] = "range";
        builder.Attributes["name"] = name;
        builder.Attributes["min"] = min;
        builder.Attributes["max"] = max;
        builder.Attributes["value"] = value;
        return new HtmlString(builder.ToString(TagRenderMode.SelfClosing));
    }
} 
```

我正在尝试模拟现有的`TextBoxFor`扩展方法，该方法允许调用者`htmlAttributes`通过匿名对象指定额外的。但是，我在`InvalidCastException`上面的注释行中得到了一个。

谁能指出我从匿名`htmlAttributes`对象中获取值的正确方法（类似于如何`TextBoxFor`处理`htmlAttributes`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T06:42:38.893

InputExtensions.TextBoxFor 以下列方式处理属性：

```
public static MvcHtmlString TextBoxFor<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TProperty>> expression, object htmlAttributes)
{
  return InputExtensions.TextBoxFor<TModel, TProperty>(htmlHelper, expression, (IDictionary<string, object>) HtmlHelper.AnonymousObjectToHtmlAttributes(htmlAttributes));
} 
```

所以你必须在使用它之前从异常对象创建属性字典

# iphone - 如何从字符串中删除（

> ID：14351310
> 
> 赞同：0
> 
> 时间：2013-01-16T04:18:31.723
> 
> 标签：iphone, ipad

> **可能重复：**
> [iphone sdk - 从字符串中删除除数字 0-9 之外的所有字符](https://stackoverflow.com/questions/1160403/iphone-sdk-remove-all-characters-except-for-numbers-0-9-from-a-string)

我有一个带有电话号码的字符串

> 我的号码 = @"(334)687-6619";

我在用

```
NSString *phoneURLString = [NSString stringWithFormat:@"tel:%@", phoneNumber];
NSURL *phoneURL = [NSURL URLWithString:phoneURLString];
[[UIApplication sharedApplication] openURL:phoneURL]; 
```

拨打电话。但是由于“（”，“）”，我的方法无法拨打电话。

请建议我制作一个正确的字符串，例如

> “1-800-555-1212”或类似的东西。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T04:27:48.697

您可以使用

```
NSString *s = @"(334)687-6619";
NSCharacterSet *doNotWant = [NSCharacterSet characterSetWithCharactersInString:@"("];
s = [[s componentsSeparatedByCharactersInSet: doNotWant] componentsJoinedByString: @""];

s = [s stringByReplacingOccurrencesOfString:@")" withString:@"-"];
NSLog(@"%@", s); 
```

因此，它将用“”替换“（”并将“）”替换为“-”。

谢谢。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-16T04:28:26.710

使用此代码

```
NSString *str = @"(334)687-6619";
str = [str stringByReplacingCharactersInRange:NSMakeRange(0, 1) withString:@""];
str = [str stringByReplacingCharactersInRange:NSMakeRange(3, 1) withString:@"-"];    
NSLog(@"%@",str); 
```

**输出为：** 334-687-6619

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-16T04:26:34.330

要从字符串中删除字符：

```
NSCharacterSet *set = [NSCharacterSet characterSetWithCharactersInString:@"()"];
NSArray *comps = [string componentsSeparatedByCharactersInSet:set];
NSString *newString = [comps componentsJoinedByString:@""]; 
```

# node.js - 如何格式化以年和月为单位的持续时间？

> ID：14351312
> 
> 赞同：2
> 
> 时间：2013-01-16T04:18:34.297
> 
> 标签：node.js, momentjs

我正在使用带有[moment.js](http://momentjs.com/docs/#/durations/)的 node.js来格式化时间。我想将患者的年龄格式化为月和年。这是我到目前为止所得到的：

```
patient: {
    ...
    birthDate: moment('Dec 15, 2009'),
    getAgeString: function() {
        var age = moment.duration(moment() - this.birthDate);
        return util.format('%d years, %d months', age.years(), age.months());
    }
} 
```

该`getAgeString`函数给了我 back `3 years, 1 months`，这非常接近我想要的，除了我希望它被正确地复数。据我所知，moment 并没有为持续时间提供适当的复数形式。

`this.birthDate.fromNow(true)`是“智能的”，但它似乎没有提供任何关于显示内容的自定义选项。

我可以让 moment.js 做我想做的事，还是有更好的 node 时间库？

* * *

现在必须这样做：

```
getAgeString: function() {
    var age = moment.duration(moment() - this.birthDate);
    var years = age.years(), months = age.months();
    return util.format('%d year%s, %d month%s', years, years === 1 ? '' : 's', months, months === 1 ? '' : 's');
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T04:25:16.357

您希望正确复数的单词似乎是您自己代码中的字符串文字，而不是基于格式化模块。您可以执行条件 age.years() 或 age.months() 等于 1。如果是，则使用字符串“year”或“month”，否则使用“years”或“months”。

# c++ - 将大文件读入数组会导致崩溃

> ID：14351313
> 
> 赞同：3
> 
> 时间：2013-01-16T04:18:35.767
> 
> 标签：c++

我有一个任务，我需要输入一个 7 位数字（电话号码）并检查它是否在 pi 的数字中找到。pi 的数字存储在提供的空格分隔的文本文件中。这似乎相当简单：将输入分解为一个数组，将 pi 的数字读入一个数组，然后检查是否找到匹配项。长话短说，我得到了令我满意的程序。我们提供了文本文档，其中 pi 的数字是 10、100 等的倍数，最多可达 100 万位。我的程序最多可以处理 100,000 位数字。但无论出于何种原因，在 100 万位数的文件中，它都会因一般 Windows 错误而崩溃。我没有关于它为什么崩溃的信息，也没有给出错误消息（除了通用的“问题导致该程序停止工作”消息）。

注意到赋值状态的限制我不能使用任何面向对象的代码，除了 cin、cout 和文件流对象（这个限制是因为我们还没有进入类并且他们不希望我们在不知道的情况下使用函数它们是如何工作的）。

无论如何，我正在寻找有关程序崩溃原因的见解。我在应该需要它们的每个变量（包括计数器和函数返回）上使用长整数，这应该足够了，因为它们可以达到大约 20 亿，并且这里不应该有任何大于一百万的数字。

谢谢你的帮助。在过去的几个小时里，我一直在这样做，但没有成功。

```
const long int numberOfDigits = 1000000;
int digitsOfPi[numberOfDigits]; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-16T04:23:23.193

```
int digitsOfPi[numberOfDigits]; 
```

**堆栈**没有足够的空间来容纳这么大的数组。堆栈是存储[自动变量](http://en.wikipedia.org/wiki/Automatic_variable)（AKA 局部变量）的地方。当执行进入函数时，会自动为局部变量分配内存，并在函数返回时释放。由于这种自动内存管理，堆栈很棒，但一个限制是它的大小是有限的。

大对象应该放在**堆上**。¹堆是一个巨大的内存池，您可以随时从其中动态分配块。堆和栈的区别在于你负责分配和释放堆内存。它不会自动为您释放。

要在 C++ 中在堆上分配内存，请使用[`new`](http://www.cplusplus.com/reference/new/operator%20new/)运算符，每个运算符都有`new`一个对应[`delete`](http://www.cplusplus.com/reference/new/operator%20delete/)的，用于在不再需要内存时释放内存。（或者在我们的例子中，我们使用[`new[]`](http://www.cplusplus.com/reference/new/operator%20new[]/)and[`delete[]`](http://www.cplusplus.com/reference/new/operator%20delete[]/)因为我们正在处理一个数组。）

```
// Allocate memory on the heap.
int *digitsOfPi = new int[numberOfDigits];

// Use it.

// Then free it.
delete[] digitsOfPi;

// Or better yet, once you're allowed to use the STL...
std::vector<int> digitsOfPi; 
```

然而，更大的问题是为什么你需要一次将 π 的所有数字读入内存。一个更好的设计，虽然代码更复杂，但只需要固定的 O(1) 内存量——比如一次 7 位。

### 也可以看看

*   [堆栈和堆是什么以及在哪里？](https://stackoverflow.com/questions/79923/what-and-where-are-the-stack-and-heap)

* * *

¹您可以探索编译器的选项来增加堆栈大小，但这不是正确的解决方案。

# mysql - 根据 mysql 中的逗号分隔列检查内爆字符串

> ID：14351318
> 
> 赞同：0
> 
> 时间：2013-01-16T04:19:13.460
> 
> 标签：mysql

我需要像 `where (1,2,3) match (column2)`这里一样检查 column2 本身是一个逗号分隔的字符串，如果 column2 中有任何值，我们需要获取该行。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T04:23:24.457

使用 MySQL 的[`IN`](http://dev.mysql.com/doc/en/comparison-operators.html#function_in)运算符：

```
WHERE column2 IN (1,2,3) 
```

# objective-c - 在 ARC 下将新值分配给包含旧值的 __autoreleasing inout 参数时出现内存警告

> ID：14351322
> 
> 赞同：2
> 
> 时间：2013-01-16T04:19:43.230
> 
> 标签：objective-c, automatic-ref-counting, autorelease

我正在实现键值验证，如下所示：

```
- (BOOL)validateValue:(__autoreleasing id *)value forKey:(NSString *)key error:(NSError *__autoreleasing *)error
{
    NSAttributeDescription *attribute = [[self.entity attributesByName] objectForKey:key];
    if (attribute && attribute.attributeType == NSStringAttributeType) {
        *value = [NSString stringWithFormat:@"%@ modified", *value];
        return YES;
    }
    return [super validateValue:value forKey:key error:error];
} 
```

当它运行时，内存会不断增加，直到应用程序收到内存警告并在 250 MB 标记处崩溃。

有趣的是，通过以下变化，总内存占用保持稳定在 5 MB 左右。

```
*value = [NSString stringWithFormat:@"%@", *value];
*value = [NSString stringWithFormat:@"%@ modified", NSStringFromClass([self class])]; 
```

对于第一个变体，我怀疑 +stringWithFormat 被优化为简单地返回 *value 不变。

第二个变体只是我试图确保编译器或目标 c 运行时不会返回已经存在的对象而不分配任何新对象。

只有当我创建一个包含传入值的新字符串对象时，内存才会增加。

我试过做

```
NSString * __unsafe_unretained tmp = *value;
*value = [NSString stringWithFormat:@"%@ modified", tmp];

CFStringRef tmp = (__bridge_retained CFStringRef)*value;
*value = [NSString stringWithFormat:@"%@ modified", tmp];
CFRelease(tmp); 
```

无济于事。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-19T01:10:32.663

> 顺便提一下，注意你不需要写`(__autoreleasing id *)`; 光写`(id *)`就够了。ARC 假定`__autoreleasing`默认情况下指向对象指针的指针。事实上，[Apple 的 Key-Value Validation 文档中就](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/KeyValueCoding/Articles/Validation.html#//apple_ref/doc/uid/20002173)只有`(id *)`这个参数。但这绝对与您的内存泄漏无关。

你能发布一个完整的、可编译的例子吗？（Pastebin 链接可能是执行此操作的适当方式。）

*   如果您将 Cocoa 退出循环并直接调用您的`-validateValue:forKey:error:`方法几百万次，内存泄漏是否仍然会重现？

*   如果替换为 ，内存泄漏是否仍会`return [super ...]`重现`return YES;`？

> 对于第一个变体，我怀疑 +stringWithFormat 被优化为简单地返回 *value 不变。

这很容易检查，你知道吗？做吧

```
id oldValue = *value;
*value = [NSString stringWithFormat:@"%@", *value];
assert(*value == oldValue);  // TESTING -- is the value unchanged? 
```

事实上，Apple 对非可变`NSString`实例的实习（重复数据删除）意味着您的猜测是正确的。包含相同字符数据的非可变`NSString`s 通常会比较指针相等。（当然你不应该依赖这个怪癖来编写代码！）

就个人而言，我的钱完全没有泄漏，但只是很多（递归？）调用 `-validateValue:forKey:error:`. 看，每次调用该函数时，它都会采用任何字符串*作为*值并将其扩展为`strlen(" modified")`字节。因此，第一次验证`@"foo"`时，您会得到`@"foo modified"`；当你确认*你*得到了`@"foo modified modified"`；当你确认*你*得到了`@"foo modified modified modified"`；最终你的程序内存不足并崩溃。

尝试这个：

```
- (BOOL)validateValue:(id *)value forKey:(NSString *)key error:(NSError **)error
{
    NSAttributeDescription *attribute = [[self.entity attributesByName] objectForKey:key];
    if (attribute && attribute.attributeType == NSStringAttributeType) {
        if ([*value hasSuffix: @" modified"]) {
            NSLog(@"Uh-oh! I refuse to modify an already modified value!");
        } else {
            *value = [NSString stringWithFormat:@"%@ modified", *value];
        }
        return YES;
    }
    return [super validateValue:value forKey:key error:error];
} 
```

这是否解决了您的内存泄漏？

# sql - DQL 查询中的多个条件

> ID：14351324
> 
> 赞同：-1
> 
> 时间：2013-01-16T04:19:49.843
> 
> 标签：sql, symfony, doctrine-orm, dql

我需要为我的约会网站构建一个 SQL/DQL 查询，它检索所有具有一些匹配字段（如性别、年龄、位置和 3 个兴趣）的用户。我不知道如何在我的 DQL 查询中创建多个条件。我从这样的事情开始：

`SELECT u FROM MyUserBundle:User u WHERE u.sex LIKE :preference"); $query->setParameters(array('preference' => '%' . $preference . '%' 'age' => '%' . $age . '%' 'location' => '%' . $location . '%' 'interest' => '%' . $interests . '%')); $users = $query->getResult();`

我正在使用 Symfony2 和 Doctrine2，但它对我不起作用。有人可以告诉我如何在我的查询中管理多个条件吗？谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T05:30:53.337

如果查询更复杂，最好使用 Doctrine2 [Query Builder](http://docs.doctrine-project.org/en/2.0.x/reference/query-builder.html)

```
$qb =  $this->getDoctrine()->getEntityManager()->createQueryBuilder();

$qb
   ->select('u')
   ->from('MyUserBundle:User', 'u')
   ->where($qb->expr()->like('u.sex', ':preferense'))
   ->andWhere($qb->expr()->like('u.age', ':age'))
   ->andWhere($qb->expr()->like('u.location', ':location'))
   ->andWhere($qb->expr()->like('u.interest', ':interest'))
   ->setParameters(array(
      'preferense' => '%'.$preference.'%',
      'age' => '%'.$location.'%',
      'location' => '%'.$location.'%',
      'interest' => '%'.$interests.'%',
   ));

$users = $qb->getQuery()->getResult(); 
```

提示：如果 $interests 是数组，请使用 foreach。

# ruby - 提取 SVG 值并将它们除以 1000

> ID：14351330
> 
> 赞同：0
> 
> 时间：2013-01-16T04:20:09.933
> 
> 标签：ruby, svg

我在 XML 文件中有 SVG 值，例如`209499.728041`：

```
 <path id="dwg-object-136" d="M 209499.728041,19994.245007 209499.728041,27254.245007" style="fill:none;stroke:blue;strok    e-width:4px" />
 <path id="dwg-object-137" d="M 220719.728041,27254.245007 220719.728041,18564.245007" style="fill:none;stroke:blue;strok    e-width:4px" />
 <path id="dwg-object-138" d="M 220719.728041,19994.245007 209499.728041,19994.245007" style="fill:none;stroke:blue;strok    e-width:4px" />
 <path id="dwg-object-209" d="M 214304.728041,35614.245007 A 2000.000000,2000.000000 0 0 0 212304.728041,37614.245007" fi    ll="none" stroke="blue" stroke-width="0.100000" />
 <path id="dwg-object-210" d="M 230819.728041,37614.245007 A 2000.000000,2000.000000 0 0 0 228819.728041,35614.245007" fi    ll="none" stroke="blue" stroke-width="0.100000" />
 <path id="dwg-object-211" d="M 216007.728041,39574.245007 216007.728041,35614.245007" style="fill:none;stroke:blue;strok    e-width:4px" /> 
```

有没有办法将所有这些值除以 1000，这样就可以了`209.499728041`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T17:56:16.573

如果您只想让您的 SVG 内容以 1/100 比例显示在文件中，最简单的方法是将它们包装在一个通用转换中：

```
<g transform="scale(0.01)">
  <!-- all your paths here -->
</g> 
```

但是，如果你真的想修改路径数据，你可以使用 SVG DOM：

```
// Untested code
function scalePath( path, scaleFactor ){
  var scalable = ['x','y','x1','y1','x2','y2','r1','r2'];
  for (var i=0,segs=path.pathSegList,len=segs.numberOfItems;i<len;++i){
    var seg = segs.getItem(i);
    for (var j=scalable.length;j--;){
      var prop = scalable[j];
      if (prop in seg) seg[prop] *= scaleFactor;
    }
  }
} 
```

请注意，这（希望）不会触及 arc-to 命令的`angle`、`largeArcFlag`或`sweepFlag`属性。

您可以通过打开段的属性并缩放每个段类型的正确属性来使上述代码的性能稍微提高一些`pathSegTypeAsLetter`，但我懒得这样做，而且计算机速度很快。

如果您这样做是为了在序列化中保存字节，您可能希望对这些值进行四舍五入：

```
if (prop in seg) seg[prop] = Math.round(seg[prop]*scaleFactor); 
```

# sql-server-2012 - 如何在 SQL Server 2012 的表格模型数据库中添加 Active Directory 用户组作为登录名

> ID：14351333
> 
> 赞同：0
> 
> 时间：2013-01-16T04:20:29.893
> 
> 标签：sql-server-2012, database-permissions, tabular

我需要授予对表格模型数据库的“Active Directory 用户组”读取权限。搜索时我无法找到该组，将其添加到角色中。

[正如这里](https://stackoverflow.com/questions/5029014/how-to-add-active-directory-user-group-as-login-in-sql-server)提到的数据库实例，将组添加到“安全”文件夹中的“登录”是第一步。但是在表格模型的情况下，“安全”文件夹不存在，如下面的屏幕截图所示。3 个中的第一个是表格模型实例：

[![第一个实例显示表格模型](../Images/56407c66688751ea747fb999911daccc.png)](https://i.stack.imgur.com/2ZRlu.png)
[（来源：[sqlmusings.com](http://www.sqlmusings.com/wp-content/uploads/2012/04/Different-SSAS-Models-in-SSMS.png)）]

如果需要，我是服务器的管理员。如何授予“Active Directory 用户组”对表格模型的读取权限？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T15:53:50.723

首先，必须在表格模型中定义一个角色。然后将活动目录组添加到成员列表中。如果模型是从无权访问域的系统开发/部署的，则必须在事后添加该组。这可以通过 SSMS 完成...

导航到角色文件夹：

```
<SSAS Tabular Instance> | Databases | <tabular model> | Roles 
```

*   右键单击要添加活动目录组的角色
*   选择会员页面
*   点击添加

...此时，请确保选择了正确的对象（用户、组等）和位置（网络、域等）...此窗口在 Windows 应用程序中非常标准。

![在此处输入图像描述](../Images/25e09e970361792c519392a3771e7c12.png)

# php - Ajax/PHP 在第一次发布后没有回显

> ID：14351334
> 
> 赞同：1
> 
> 时间：2013-01-16T04:20:39.867
> 
> 标签：php, html, ajax, echo

我已经为用户创建了一个设置页面，我遇到的问题是，在您发送一次表单并说您收到“请填写所有字段”之类的错误之后，您再次提交它不会回显任何更多错误或成功消息，但它会更新您的密码。

JS：

```
<script type="text/javascript">
    $(document).ready(function() {
        $("#changePassword").click(function(){
                var userIdSettings  = <?php echo $_SESSION['id']; ?>;
                var currPass        = $("#currentPass").val();
                var newPass         = $("#newPass").val();
                var newPassRe       = $("#newPassRe").val();
                $.post("inc/ajax.php", {userIdSettings: userIdSettings, currPass: currPass, newPass: newPass, newPassRe: newPassRe}, function(data){
                    $(".message").html(data).delay(2000).fadeOut('slow', function(){

                    });
                });
        });
    });
</script> 
```

PHP：

```
 if ($_POST['userIdSettings']) {

    $userIdSettings     = $_POST['userIdSettings'];
    $currPass           = $_POST['currPass'];
    $newPass            = md5($_POST['newPass']);
    $newPassRe          = md5($_POST['newPassRe']);

    if (!empty($currPass) && !empty($newPass) && !empty($newPassRe)) {

        $data = new db();
        $data->dbConnect();
        $data->dbSelect();

        $currPass  = md5($currPass);
        $checkPass = mysql_query("SELECT * FROM users WHERE id = '$userIdSettings'") or die("Error: ".mysql_error());
        $checkPass = mysql_fetch_assoc($checkPass);

        if ($currPass == $checkPass['password']) {
            if ($newPass == $newPassRe) {
                mysql_query("UPDATE users SET password = '$newPassRe' WHERE id = '$userIdSettings'") or die("Error: ".mysql_error());
                echo '<div class="messages green large"><span></span>Your password has been updated!</div>';
                exit;
            } else {
                echo '<div class="messages red large"><span></span>Your new passwords dont match!</div>';
                exit;
            }
        } else {
            echo '<div class="messages red large"><span></span>Your current password is not correct!</div>';
            exit;
        }

    } else {
        echo '<div class="messages red large"><span></span>Please fill in all fields!</div>';
        exit;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T04:36:00.697

```
$(".message").html(data).show().delay(2000).fadeOut('slow', function(){}); 
```

注意`.show()`

您正在将数据打印到页面上，然后使用`fadeOut`最终结果集的方法`display:none`。然后您尝试输出更多数据，但显示仍然是`none`，导致页面上没有显示任何内容，即使正在更新 DOM 元素。如果添加`show()`方法，这将确保 CSS 值`display`设置为`block`; 显示 DOM 元素的新文本​​；然后fadeOut...慢慢... 2秒后。

# jquery - 更改触发文本

> ID：14351338
> 
> 赞同：1
> 
> 时间：2013-01-16T04:21:05.103
> 
> 标签：jquery, toggle

```
$("a.question").click(function () {
    var $this = $(this);
    $this.next(".answer").slideToggle('fast', function () {
        $this.text($(this).is(':visible') ? "Show Question" : "Hide Question");
    });
}); 
```

小提琴：http: [//jsfiddle.net/9tSww/1/](http://jsfiddle.net/9tSww/1/)

..现在这几乎可以工作，除非您第一次单击触发器，它现在不会更新标签，它仅在第二次单击时才有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T04:26:30.243

```
$(this).is(':visible') 
```

至

```
!$(this).is(':visible') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T04:26:40.193

请改用以下内容。

```
var $this = $(this);
$this.next(".answer").slideToggle('fast', function () {
  $this.text(function(i, text) {
    return text == 'Show Question' ? 'Hide Question' : 'Show Question';
  });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T04:34:44.797

或更改`:visible`为`:hidden`

[http://jsfiddle.net/9tSww/2/](http://jsfiddle.net/9tSww/2/)

# javascript - 带有咖啡子类问题的 EventEmitter

> ID：14351339
> 
> 赞同：0
> 
> 时间：2013-01-16T04:21:08.947
> 
> 标签：javascript, node.js, coffeescript

我不确定为什么这不起作用。有人可以给我线索吗？我没有看到任何事件被记录下来，但它们确实得到`emitted`了……嗯，我想:)

```
{EventEmitter} = require 'events'

class Base extends EventEmitter

class App extends Base

  constructor: (cb) ->

    console.log 'setup'

    @on 'listener:1', (data) ->
      console.log 'listener 1: ' + data

    @on 'listener:2', (data) ->
      console.log 'listener 2: ' + data

    cb()

class One extends Base

  fire: () ->

    console.log 'fire 1'

    @emit 'listener:1', 1

class Two extends Base

  fire: () ->

    console.log 'fire 2'

    @emit 'listener:2', 2

new App(
  () ->
    setTimeout (->
      one = new One()
      one.fire()
      setTimeout (->
        two = new Two()
        two.fire()
      ), 2000
    ), 2000
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T04:35:30.647

程序的输出符合预期；仅`App`在其自身上设置侦听器，但它从不做`emit`任何事情（只有`One`and `Two`，它们*不是*的子类`App`，这样做）。也许您正在寻找更像以下的东西？

```
{EventEmitter} = require 'events'

class Base extends EventEmitter
  constructor: ->
    console.log 'setup'

    @on 'listener:1', (data) ->
      console.log 'listener 1: ' + data

    @on 'listener:2', (data) ->
      console.log 'listener 2: ' + data

class App extends Base
  constructor: (cb) ->
    super()
    cb()

class One extends Base
  fire: ->
    console.log 'fire 1'
    @emit 'listener:1', 1

class Two extends Base
  fire: ->
    console.log 'fire 2'
    @emit 'listener:2', 2

new App(
  ->
    setTimeout (->
      one = new One()
      one.fire()
      setTimeout (->
        two = new Two()
        two.fire()
      ), 2000
    ), 2000
) 
```

# google-app-engine - 应用引擎通道已成功创建但无法使用

> ID：14351343
> 
> 赞同：1
> 
> 时间：2013-01-16T04:21:26.303
> 
> 标签：google-app-engine, channel-api

我在使用 App Engine 通道 API 时遇到了间歇性问题。在大多数情况下，也许 90% 的时间里，一切正常。但是剩下的 10% 的时间我得到一个不可用的频道。看了几个月的代码，我坚信这个问题不是由于逻辑错误造成的。我所说的不可用通道是指即使客户端成功连接到它，服务器也无法向它发送消息。客户端和服务器上涉及的大部分操作都成功完成：

*   在服务器上，我创建了一个具有会话唯一的新客户端 ID 的通道
*   客户端获取相应的令牌并连接到它
*   在客户端，在通道套接字上调用 onOpen()

没有成功的一件事是为这些有缺陷的通道调用 /_ah/channel/connected。我已经尝试了几十种可能的解决方法，但都没有成功。现在我通过优雅地重试直到成功来处理这个问题，但是如果没有这些技巧，它会非常好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T08:15:20.010

我还没有看到任何代码，但从你所说的可能与

[间歇性错误代码 400，客户端连接通道上的描述“”](https://stackoverflow.com/questions/13962739/intermittent-error-code-400-description-on-client-connecting-to-channel?rq=1)

我正在对所有客户端套接字使用一种蛮力循环消息传递（即使它们已经关闭，它也有点多余，但开销似乎很低）并且还没有发现任何问题（我也没有很好地对其进行测试） )

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-19T03:44:35.440

似乎他们在最后一个版本 1.8.2 中修复了通道 APi 中的泄漏：[https ://code.google.com/p/googleappengine/issues/detail?id=9283](https://code.google.com/p/googleappengine/issues/detail?id=9283) [https://code.google.com/ p/googleappengine/wiki/SdkForJavaReleaseNotes](https://code.google.com/p/googleappengine/wiki/SdkForJavaReleaseNotes)

# android - 如何在整个活动中保持 Android 购买

> ID：14351344
> 
> 赞同：0
> 
> 时间：2013-01-16T04:21:26.597
> 
> 标签：android, in-app-purchase, in-app-billing

我已经知道如何在整个 Android 活动中保留正常数据，但我想知道相同的方法是否可以安全地用于 Android 购买数据。

我正在制作一个使用应用内购买来解锁所有内容的免费应用。这是我目前正在检查初始屏幕活动以自定义 UI 的内容，但是我在整个应用程序中也需要此信息。

最好在每个活动中查询，还是共享首选项足够安全？

作为说明，我使用的是 Android 计费库的 v3。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T04:41:56.607

共享首选项适用于此。您的数据被沙盒化，就像它是数据库一样。（安全方面，两者都一样安全）

无论如何，您都需要查询数据库或 SharedPreferences 以在您的 Activity 中获取此数据。从哪个数据存储中检索它并不重要。

您不必担心用户更改您的数据（以某种方式将他们的本地状态更改为“付费”），因为他们无法更改您的 SharedPrefs（或数据库值）——因为他们无权访问这些安全数据商店。

# sql - 加入两个表在sql oracle中添加选择性数据

> ID：14351350
> 
> 赞同：1
> 
> 时间：2013-01-16T04:22:47.687
> 
> 标签：sql, oracle

这些是我的桌子

```
C_ID  USAGE B_ID
4     100   2
2     400   1
3     200   2
1     300   1 
```

和

```
B_ID  ZONE_NAME
2     central
1     west 
```

这是我的查询，

```
select 
    sum(usage)  
from 
(
    select 
        usage_679.c_id,
        usage_679.b_id,usage_679.usage,
        zone_679.zone_name 
    from usage_679 inner join zone_679
        on zone_679.b_id = usage_679.b_id
)
where zone_name like 'w%'; 
```

问题是它只能打印与西部区域相关的数据。我想打印两个区域名称以及各个区域的总使用量。

预期产出

```
zone_name  sum(usage)
1            700
2            300 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T04:55:42.940

这是示例执行的[SQL FILLDE 链接](http://sqlfiddle.com/#!4/944d0/14/7)。你不需要**WHERE**条件。您可以通过**GROUP BY**

```
select 
    sum(usage),zone_name  
from 
(
    select 
        usage_679.c_id,
        usage_679.b_id,usage_679.usage,
        zone_679.zone_name 
    from usage_679 inner join zone_679
        on zone_679.b_id = usage_679.b_id
)
group by  zone_name 
```

**输出**

```
| SUM(USAGE) | ZONE_NAME |
--------------------------
|        700 |      west |
|        300 |   central | 
```

即使这样也可以：（不需要 2 SELECTS）

```
SELECT
    sum(USAGE),zone_name

    FROM usage_679 INNER JOIN zone_679
        ON zone_679.b_id = usage_679.b_id

GROUP BY  zone_name 
```

**输出：**

```
| SUM(USAGE) | ZONE_NAME |
--------------------------
|        700 |      west |
|        300 |   central | 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T04:40:24.370

您可以使用`GROUP BY`子句来获得结果。请试试。

```
select 
    zone_679.zone_name,
    zone_679.b_id,
    SUM(usage_679.usage)
from usage_679 inner join zone_679
    on zone_679.b_id = usage_679.b_id 
group by zone_679.zone_name, zone_679.b_id; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T05:29:53.290

只需添加@priyanks 答案...如果您只想要西方的结果，则添加一个`having`子句，即

```
SELECT
sum(USAGE),zone_name

FROM usage_679 INNER JOIN zone_679
    ON zone_679.b_id = usage_679.b_id

GROUP BY  zone_name
HAVING zone_name like 'w%' --Filter added for result 
```

# c++ - C++11 中的 async(launch::async) 是否会使线程池过时以避免昂贵的线程创建？

> ID：14351352
> 
> 赞同：132
> 
> 时间：2013-01-16T04:23:21.447
> 
> 标签：c++, multithreading, asynchronous, c++11, threadpool

它与这个问题松散相关：[Are std::thread pooled in C++11?](https://stackoverflow.com/questions/12993451/c11-stdthread-pooled) . 尽管问题不同，但意图是相同的：

**问题 1：使用您自己的（或第三方库）线程池来避免昂贵的线程创建是否仍然有意义？**

另一个问题的结论是你不能依赖于`std::thread`被汇集（它可能会或可能不会）。但是，`std::async(launch::async)`似乎有更高的机会被合并。

它不认为它是由标准强制的，但恕我直言，如果线程创建速度很慢，我希望所有好的 C++11 实现都会使用线程池。只有在创建新线程成本低廉的平台上，我希望它们总是产生一个新线程。

**问题2：这只是我的想法，但我没有事实可以证明。我很可能弄错了。这是一个有根据的猜测吗？**

最后，在这里我提供了一些示例代码，首先展示了我认为线程创建可以通过以下方式表达的方式`async(launch::async)`：

示例 1：

```
 thread t([]{ f(); });
 // ...
 t.join(); 
```

变成

```
 auto future = async(launch::async, []{ f(); });
 // ...
 future.wait(); 
```

示例 2：触发并忘记线程

```
 thread([]{ f(); }).detach(); 
```

变成

```
 // a bit clumsy...
 auto dummy = async(launch::async, []{ f(); });

 // ... but I hope soon it can be simplified to
 async(launch::async, []{ f(); }); 
```

**问题 3：您更喜欢`async`版本而不是`thread`版本？**

* * *

**其余的不再是问题的一部分，而只是为了澄清：**

为什么必须将返回值分配给虚拟变量？

不幸的是，当前的 C++11 标准强制您捕获 的返回值`std::async`，否则会执行析构函数，该析构函数会阻塞直到操作终止。一些人认为这是标准中的错误（例如，Herb Sutter）。

这个来自[cppreference.com](http://en.cppreference.com/w/cpp/thread/async)的例子很好地说明了这一点：

```
{
  std::async(std::launch::async, []{ f(); });
  std::async(std::launch::async, []{ g(); });  // does not run until f() completes
} 
```

* * *

另一个澄清：

我知道**线程池可能有其他合法用途，但在这个问题上，我只对避免昂贵的线程创建成本方面感兴趣**。

我认为仍然存在线程池非常有用的情况，尤其是在您需要对资源进行更多控制的情况下。例如，服务器可能决定同时处理固定数量的请求，以保证快速响应时间并增加内存使用的可预测性。线程池应该没问题，在这里。

线程局部变量也可能是您自己的线程池的参数，但我不确定它在实践中是否相关：

*   `std::thread`在没有初始化线程局部变量的情况下创建一个新线程。也许这不是你想要的。
*   在由 产生的线程中`async`，对我来说有点不清楚，因为线程可以被重用。据我了解，线程局部变量不能保证被重置，但我可能会弄错。
*   另一方面，如果您真的需要，使用您自己的（固定大小的）线程池可以让您完全控制它。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2013-01-16T04:37:24.960

**问题一**：

我把它从原来的地方改了，因为原来的东西是错的。我的印象是[Linux 线程创建非常便宜](http://www.cs.utexas.edu/%7Ewitchel/372/lectures/POSIX_Linux_Threading.pdf)，经过测试，我确定在新线程中调用函数的开销与普通线程相比是巨大的。创建线程来处理函数调用的开销比普通函数调用慢 10000 倍或更多倍。因此，如果您要发出大量小函数调用，线程池可能是个好主意。

很明显，g++ 附带的标准 C++ 库没有线程池。但我绝对可以为他们看到一个案例。即使必须通过某种线程间队列来推动调用的开销，它也可能比启动一个新线程更便宜。标准允许这样做。

恕我直言，Linux 内核人员应该致力于使线程创建比目前更便宜。但是，标准 C++ 库也应该考虑使用 pool 来实现`launch::async | launch::deferred`.

并且 OP 是正确的，使用`::std::thread`启动线程当然会强制创建一个新线程，而不是使用池中的一个。所以`::std::async(::std::launch::async, ...)`是首选。

**问题 2**：

是的，基本上这个'隐式'启动一个线程。但实际上，发生的事情仍然很明显。所以我真的不认为隐含这个词是一个特别好的词。

我也不相信强迫您在销毁之前等待退货一定是错误的。我不知道您应该使用`async`调用来创建不希望返回的“守护程序”线程。如果他们预计会返回，那么忽略异常是不行的。

**问题 3**：

就个人而言，我喜欢线程启动是明确的。我非常看重可以保证串行访问的岛屿。否则你最终会得到一个可变状态，你总是必须在某个地方包装一个互斥锁并记住使用它。

与“未来”模型相比，我更喜欢工作队列模型，因为周围存在“串行孤岛”，因此您可以更有效地处理可变状态。

但实际上，这完全取决于你在做什么。

## 性能测试

因此，我测试了各种调用方法的性能，并在运行使用 clang 版本 7.0.1 和 libc++（不是 libstdc++）编译的 Fedora 29 的 8 核（AMD Ryzen 7 2700X）系统上得出了这些数字：

```
 Do nothing calls per second:   35365257                                      
        Empty calls per second:   35210682                                      
   New thread calls per second:      62356                                      
 Async launch calls per second:      68869                                      
Worker thread calls per second:     970415 
```

在 OSX 10.13.6 下，在我的 MacBook Pro 15"（Intel(R) Core(TM) i7-7820HQ CPU @ 2.90GHz）上`Apple LLVM version 10.0.0 (clang-1000.10.44.4)`，我得到了这个：

```
 Do nothing calls per second:   22078079
        Empty calls per second:   21847547
   New thread calls per second:      43326
 Async launch calls per second:      58684
Worker thread calls per second:    2053775 
```

对于工作线程，我启动了一个线程，然后使用无锁队列将请求发送到另一个线程，然后等待发回“完成”回复。

“什么都不做”只是为了测试测试工具的开销。

很明显，启动线程的开销是巨大的。即使是带有线程间队列的工作线程，在 VM 中的 Fedora 25 上也会将速度减慢 20 倍左右，在本机 OS X 上减慢大约 8 倍。

我创建了一个包含用于性能测试的代码的 OSDN 室。可以在这里找到：[https ://osdn.net/users/omnifarious/pf/launch_thread_performance/](https://osdn.net/users/omnifarious/pf/launch_thread_performance/)

# python - Python - line.split()

> ID：14351356
> 
> 赞同：0
> 
> 时间：2013-01-16T04:23:34.833
> 
> 标签：python, split

嗨，我刚开始 Python 编程，所以准备好看到我很多问题。第一个，我正在制作一个小程序，它将从我以这种格式创建的 .txt 文件中获取信息：

10-50-100 11-78-245 12-123-354 等...

如果用户想去获取以“10”开头的行。我怎样才能得到它并返回所有信息（10、50和100）？当我使用 line.split() 时，它只返回该行的第一个条目...

这是我的代码：

```
levelChart = open("RunescapeLevelsChart.txt", "r")
actualLevel = raw_input("Level : ")
if actualLevel in open("RunescapeLevelsChart.txt").read() :
    actualLevelSplit = actualLevel.split()
    print actualLevelSplit
else :
    print("Failed.")
raw_input("End") 
```

例如，如果我输入 10。我希望程序返回 10、50 和 100。但它只返回 10。如何正确使用 line.split() 使其返回行上的所有值？

谢谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T06:40:31.583

通过阅读您的帖子，我假设每组 3 个数字并不总是在不同的行上。并且您正在寻找以用户正在寻找的任何内容（例如 10）开头的每个集合。

浏览您的代码...

```
levelChart = open("RunescapeLevelsChart.txt", "r")
actualLevel = raw_input("Level : ") 
```

到目前为止，一切都很好。

```
if actualLevel in open("RunescapeLevelsChart.txt").read() : 
```

此时， actualLevel 是您的输入（例如“10”）

open("RunescapeLevelsChart.txt").read() 将整个文本文件存储在内存中。

因此，您正在从整个文件中搜索“10”。从你的例子中，将评估为“真”

```
 actualLevelSplit = actualLevel.split()
    print actualLevelSplit 
```

split() 用空格分割你的字符串。所以在这里，你将“10”分成['10']（一个列表）

```
else:
    print("Failed.")
raw_input("End") 
```

*   raw_input 将在尝试继续之前等待用户输入，我假设您在这里尝试“暂停”。你所拥有的应该工作。

现在已经说过了..这应该可以满足您的需求..

```
levelChart = open("RunescapeLevelsChart.txt", "r")
actualLevel = raw_input("Level : ")

for line in levelchart: # Read the file line-by-line.
  number_sets = line.split()
  for set in number_sets:
    if set.startswith(actualLevel + '-'):
      print set 
      #>>> "10-50-100"
      # Now you can further split each number into individual numbers
      nums = set.split('-')
      print nums 
      #>>> ['10', '50', '100']

      # At this point, you can fetch the numbers from the list

levelChart.close() # Dont' forget to close the file object when you're done. 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T04:28:06.147

问题远不止这些。

例如，如果您输入 23，它将找到以下条目：`12-123-354`

如果您只想查找以 10 开头的内容，那么您希望以不同的方式执行此操作。例如，如果你不想`78`找到第二个例子，你肯定需要做一些不同的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T04:31:17.237

您打开同一个文件两次，以及代码中的其他一些问题。这是一个清理后的版本：

```
lines = []
with open("RunescapeLevelsChart.txt", "r") as the_file:
    for line in the_file:
       lines.append(line)

actualLevel = raw_input("Level : ")

for each_line in lines:
   if actualLevel in each_line:
       print each_line
   else:
       print "Didn't find it"

print "End" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T04:31:30.107

你的问题是

你在做`actualLevel.split()`，这`actualLevel`是`10`

并且只会`actualLevel.split()`返回`10`

```
In [23]: actualLevel = '10'

In [24]: actualLevel.split()
Out[24]: ['10'] 
```

在这里，您应该从文件中拆分包含实际级别的行

你应该做类似的事情

```
In [28]: content = open("RunescapeLevelsChart.txt").read()

In [29]: y = [x for x in content.split(' ') if actualLevel in x]

In [30]: y
Out[30]: ['10-50-100']

In [31]: y[0].split('-')
Out[31]: ['10', '50', '100'] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-16T04:31:33.157

您最好将整个列表存储在一个文件中：

```
f = open("RunescapeLevelsChart.txt", "r")
lines = f.readlines()
for i in lines:
    if i.startswith(actualLevel + '-'):  # so it's actually the first element
        print i  # this prints the line
        print i.split('-')  # use this is you want a list of the numbers
# rest of code (don't forget to close the file!) 
```

您的代码正在返回第一个元素，因为您正在尝试 split `actualLevel`，而不是行本身。

# javascript - 无法使用引导程序和节点获取 POST 数据

> ID：14351359
> 
> 赞同：1
> 
> 时间：2013-01-16T04:23:56.667
> 
> 标签：javascript, html, node.js

我正在使用引导程序构建表单，但是当单击提交按钮时，没有 POST 数据发送到我的后端服务器。

Front的代码是：

```
 <form class="form-horizontal" id="level_form" method="post" action="" data-confirm="Ready to submit?">
            <div class="control-group">
                <label class="control-label" for="startDate"></label>
                <div class="controls">
                    <input type="date" id="startDate">
                    <span class="label label-important hidden" id="startDateHelper"></span>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label" for="stopDate"></label>
                <div class="controls">
                    <input type="date" id="stopDate">
                    <span class="label label-important hidden" id="stopDateHelper"></span>
                </div>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-primary">submit</button>
                <button type="button" class="btn">preview</button>
            </div>
    </form> 
```

后端是：

```
app.use(express.bodyParser());

app.engine('html', cons.mustache);
app.set('view engine', 'html');
app.set('views', __dirname+'/views');
app.use(express.static(__dirname + '/public'));

app.use(express.basicAuth(function(user, pass){
    return user == 'admin' && pass == 'solid'
}));

app.use(app.router);

app.get('/', function(req, res){
    res.render('index', {});
});

app.get('/new_level', function(req, res){
    res.render('level_editor', {action_url:'/new_level'});
});
app.post('/new_level', function(req, res){
    console.log(req.body);
    res.send(req.body);
}); 
```

但我得到的只是一个'{}'，我哪里做错了？html部分还是节点部分？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T04:40:46.480

在您的 html 中`action="/new_level"`，您的所有输入都应该具有`name`属性。在此处检查[Node.js/Express 表单发布 req.body 不起作用](https://stackoverflow.com/questions/7522034/node-js-express-form-post-req-body-not-working)

# spring - 在哪里可以找到 spring3.1 方面的 Java 源代码。似乎在 github 或其他任何地方都没有

> ID：14351368
> 
> 赞同：0
> 
> 时间：2013-01-16T04:25:34.427
> 
> 标签：spring, aspectj

通常我 `frameworks`通过阅读源代码的每一行来学习新知识

我`spring 3.2`在我的`eclipse`项目中有但`java aspect classes`不包括在内。我试过了`decompile`，但他们看起来一团糟

我在哪里可以找到它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T09:12:28.610

你可以在这里找到一个使用 maven 的 spring 3.2 项目的良好配置，

[https://github.com/andonescu/springmvc-freemarker](https://github.com/andonescu/springmvc-freemarker)

并使用 maven 下载源代码，请参阅此链接以帮助您 [Maven – 始终下载源代码和 javadocs](https://stackoverflow.com/questions/5780758/maven-always-download-sources-and-javadocs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T04:57:31.497

如果你的代码是一个 maven 项目，并且设置得很好，它会自动下载源代码。所以我建议你在 Maven 中设置你的项目。

# python - 如何在 Windows 上为 python 安装 boto 库？

> ID：14351373
> 
> 赞同：11
> 
> 时间：2013-01-16T04:26:24.283
> 
> 标签：python, installation, boto

我正在使用`windows 7`系统和`python`编程。我如何安装`boto`库`windows7`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-16T04:43:18.427

[从http://boto.googlecode.com/files/boto-2.6.0.tar.gz](http://boto.googlecode.com/files/boto-2.6.0.tar.gz)下载 boto 包到您的计算机

解压它。使用 CMD 提示遍历解压缩的文件夹。

并运行以下命令：

```
setup.py install 
```

通过尝试在 python 中导入 boto 来验证安装。

如果你安装了 pip，你可以运行：

```
pip install -U boto 
```

编辑：如果 setup.py install 无法识别，请尝试`python setup.py install`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-16T04:28:55.053

答案[在github上的boto仓库中给出](https://github.com/boto/boto)

```
$ git clone git://github.com/boto/boto.git
$ cd boto
$ python setup.py install 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-16T04:36:31.363

实际上，如果您可以搜索一段时间，这个问题的答案非常简单。但我假设你对 python 真的很陌生。我会建议使用一些 python 包管理器。一个例子是 pip [http://www.pip-installer.org/en/latest/](http://www.pip-installer.org/en/latest/)。完成安装后，只需在命令行中运行它

```
pip install boto 
```

要检查安装结果打开 python 控制台并运行

```
import boto 
```

如果没有错误消息，那么您已成功安装 boto

# c# - 创建设置后未创建与数据库的连接

> ID：14351379
> 
> 赞同：1
> 
> 时间：2013-01-16T04:27:01.737
> 
> 标签：c#, sql-server-2008

我已经开发了`C# application`。并使用外部工具制作主题。

在为此应用程序创建设置之前，它可以正常工作。并且数据库连接没有问题。

但是在为此应用程序创建设置并安装后，未创建与数据库的连接。

我已经使用`app.config`文件来获取连接字符串。由于外部主题，我在创建设置或问题时遗漏了什么？

我的 app.config 代码

```
<?xml version="1.0" encoding="utf-8" ?> 
<configuration> <connectionStrings> 
<add name="connectionStrings" connectionString="Data Source=SUMEET-PC\SQLSERVERNEW; Initial Catalog=ClothShop;User Id=sa;Password=123;" /> 
</connectionStrings> 
</configuration> 
```

# java - 如何处理可能的非终端？

> ID：14351382
> 
> 赞同：0
> 
> 时间：2013-01-16T04:27:22.300
> 
> 标签：java, grammar, ebnf

假设我有一个这样的 EBNF：

```
<Expr> -> <Term> {( + | - ) <Term>} 
```

{} 括号意味着选择零个或多个，所以我怎么知道我什么时候有`<Term>`什么`<Term> + <Term> + <Term>`时候我正在逐个字符地读取行字符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T04:35:39.987

假设您有一个递归下降解析器，您想要做的是**向前看**一个令牌。如果您刚刚阅读 a`<Term>`并且下一个标记是`+`or`-`然后您遵循此生产。如果不是，那么这个`<Expr>`生产就完成了，你返回给调用者。

要在代码中实现这一点，您需要一个全局`lookaheadToken`变量之类的东西。您可以使用该令牌来决定如何在实际提交特定生产和*使用*令牌之前进行解析。

# gridview - webforms.js vs2012 用法

> ID：14351387
> 
> 赞同：3
> 
> 时间：2013-01-16T04:28:25.730
> 
> 标签：gridview, visual-studio-2012

我是新的 VS 2012 我在 Bundle.config 文件中看到 webforms.js。它有 GridView.js 文件。这是 Jquery gridview 还是原始 Asp.net gridview。如果有任何使用 GridView.js 文件的教程，请告诉我

# asp.net-mvc - 在 MVC3 框架中创建移动应用程序的最佳组合

> ID：14351389
> 
> 赞同：0
> 
> 时间：2013-01-16T04:28:27.613
> 
> 标签：asp.net-mvc, jquery-mobile

使用 MVC3 框架、MVC 框架与 jquery mobile 或任何其他框架创建移动应用程序的最佳组合是什么？我是 jquery 移动和移动应用程序开发的新手，有什么关于如何在 MVC3 中开始使用 jquery mobile 的建议吗？我想开发一些示例移动应用程序来理解目的..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T09:26:56.587

1.  [煎茶界面](http://www.sencha.com/)

    一年前它是最好的解决方案，比 jQuery Mobile 和 Kendo UI 要好得多。如果你不介意它的 UI，它仍然对 MVC 风格的应用程序设计有更好的支持。

2.  [jQuery 移动](http://jquerymobile.com/demos/1.0rc1/)

    目前 jQuery Mobile 可能是最常用的 js 移动应用程序框架。您会发现大量可用的教程，并且（与 JSP 和 PHP 不同）MVC3 在这里是安全的选择。

3.  [剑道用户界面](http://www.kendoui.com/)

    不太好的教程和支持，但它对 MVC 样式应用程序设计的支持比 jQuery Mobile 更好，并且比 Sencha UI 更快的学习曲线。

4.  轻触

    它可以与 MVC3 一起使用，但可用的支持很少。

5.  [jQMobi](http://app-framework-software.intel.com/)（现在也称为英特尔应用程序框架）

    它可以与 MVC3 一起使用，但可用的支持很少。

**最后的想法：**

如果您正在使用 MVC3 的全部潜力或做一个专业而复杂的 Web 应用程序，请坚持使用 Kendo UI。在任何其他情况下都坚持使用 jQM，主要是如果您不想超越 jquery 语法。跳过 Sencha UI，你会花太多时间学习它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T04:43:36.547

我认为您可以使用[jquery](http://jquerymobile.com/demos/1.0rc1/) mobile 或[kendo ui](http://www.kendoui.com/)或[sencha](http://www.sencha.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T19:14:55.320

在去年评估了几个选项，包括使用 JQMobi 和 JQuery Mobile 构建整个应用程序后，我想说这个决定仅仅是营销/可用性问题，而不是编码风格/框架决定。

目前仍有[约 50% 的 Android 手机运行 2.x 版](http://developer.android.com/about/dashboards/index.html)——我拥有其中一个漏洞，性能确实具有挑战性（充其量）。如果您想在这些手机上提供良好的用户体验，您将真的想尝试[jQMobi](http://app-framework-software.intel.com/api/)，因为性能方面它是不折不扣的[赢家](http://www.codefessions.com/2012/08/performance-of-jquery-compatible-mobile.html)。如果您对这些手机上的错误或缓慢的过渡以及较差的可用性感到满意，请使用任何其他框架。到目前为止，只有我的两分钱。

Cannot advise on MVC3 integration, that will be possible to work along any ajax application i guess. As a beginner, i strongly advice you to take at testdrive at [AppMobi's free XDK](http://www.html5m.com/) that Intel just took over last week (together with jqMobi and the whole staff, so there's a lot of momentum in this project). It has everything you need to built a full app (with one of the best performing solutions to tackle HTML5 audio and video, from what i've read), w/o the need to install any the additional XDK, set up a phonegap project, and so on...

# ruby - 使用正则表达式在 Ruby 中读取文件

> ID：14351390
> 
> 赞同：0
> 
> 时间：2013-01-16T04:28:33.610
> 
> 标签：ruby, regex, file

我正在做一个像这样工作的程序的项目：

*   用户输入他们想要的最小和最大难度。
*   程序读取包含问题和答案的文件，并根据难点打印问题。
*   用户回答问题。
*   将用户的答案与实际答案进行比较。

该文件如下所示：

```
D 1
Q What color are the clouds? 
A white
D 2 
Q What is 3 + 4? 
A 7 
```

假设我只想抓取`D 1`问题和答案。我必须构建可以读取`D 1`的正则表达式和接下来的两行（`Q`和`A`）。到目前为止，这是我想出的：

```
if(File.exists?("quiz.txt"))
  myFile = File.open("quiz.txt")
  array = Array.new
  i = 0
  q = nil
  d = nil
  a = nil
  answer_array = Array.new
  myFile.each{|line| 
    if(line =~ (/^D #{minimum}/ =~ line || /^D #{maximum}/ =~ line))
      d = line
      d.slice!(0..1)
     if(/^Q/ =~ line)
       i= i+1
       q = line
       q.slice!(0..1)
     end
      if(/^A/ =~ line)
        a = line
        a.slice!(0..1)
      end
    end
    } 
```

我所拥有的不起作用。`if`检查 like 开头是否以 a 开头的第一个语句，`D`其他两个语句必须始终为 true`if`才能运行，但它们还必须读取下一行，该行必须在`D`if之外陈述。我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T04:38:22.233

Ruby 的 Enumerable 有一个很棒的方法，叫做[`slice_before`](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-slice_before)：

```
file = [
  'D 1',
  'Q What color are the clouds?',
  'A white',
  'D 2',
  'Q What is 3 + 4?',
  'A 7'
]

file.slice_before(/^D/).select{ |a| a.first[/^D 1/] }
=> [["D 1", "Q What color are the clouds?", "A white"]] 
```

`slice_before`适用于数组或可枚举，所以使用类似的东西[`File.open`](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-slice_before)来做到这一点。另一种方法是使用`File.read('path/to/file').split("\n")`或`File.readlines`创建一个数组，但您也可以使用`open`并让 Ruby 针对返回的枚举器发挥其魔力：

```
File.open('path/to/file').slice_before(/^D/).select{ |a| a.first[/^D 1/] } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T04:44:28.503

Ruby 的 each_slice 在这里也很有用；

```
File.open("test.txt").each_slice(3) do |(d, q, a)|
  if d > min && d < max
     ...
  end
end 
```

希望这有帮助！

# javascript - 我的功能运行但仅在第二次尝试时执行部分功能

> ID：14351394
> 
> 赞同：0
> 
> 时间：2013-01-16T04:28:58.133
> 
> 标签：javascript

这是我的代码。它是德国 Enigma 机器的草稿。我正在尝试制作我将实际通过机器运行的消息，除非它不会创建该消息，直到我第二次运行该函数。奇怪的是我知道函数运行是因为我看到它的一部分执行，但就代码而言`toWorkWith`，第一次运行时是空的，第二次运行时填充？

```
function encode(){
        var alphabet = ["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]
        var rotor_1 = {"A":["E"],"B":["K"],"C":["M"],"D":["F"],"E":["L"],"F":["G"],"G":["D"],"H":["Q"],"I":["V"],"J":["Z"],"K":["N"],"L":["T"],"M":["O"],"N":["W"],"O":["Y"],"P":["H"],"Q":["X"],"R":["U"],"S":["S"],"T":["P"],"U":["A"],"V":["I"],"W":["B"],"X":["R"],"Y":["C"],"Z":["J"]};
        var rotor_2 = {"A":["A"],"B":["J"],"C":["D"],"D":["K"],"E":["S"],"F":["I"],"G":["R"],"H":["U"],"I":["X"],"J":["B"],"K":["L"],"L":["H"],"M":["W"],"N":["T"],"O":["M"],"P":["C"],"Q":["Q"],"R":["G"],"S":["Z"],"T":["N"],"U":["P"],"V":["Y"],"W":["F"],"X":["V"],"Y":["O"],"Z":["E"]};
        var rotor_3 = {"A":["B"],"B":["D"],"C":["F"],"D":["H"],"E":["J"],"F":["L"],"G":["C"],"H":["P"],"I":["R"],"J":["T"],"K":["X"],"L":["V"],"M":["Z"],"N":["N"],"O":["Y"],"P":["E"],"Q":["I"],"R":["W"],"S":["G"],"T":["A"],"U":["K"],"V":["M"],"W":["U"],"X":["S"],"Y":["Q"],"Z":["O"]};
        var reflector = {"A":["A"],"B":["B"],"C":["C"],"D":["D"],"E":["E"],"F":["F"],"G":["G"],"H":["H"],"I":["I"],"J":["J"],"K":["K"],"L":["L"],"M":["M"],"N":["N"],"O":["O"],"P":["P"],"Q":["Q"],"R":["R"],"S":["S"],"T":["T"],"U":["U"],"V":["V"],"W":["W"],"X":["X"],"Y":["Y"],"Z":["Z"]};
        document.simulator.encoder.value.toUpperCase();
        var message = document.simulator.encoder.value.trim();
        message.toUpperCase();
        document.simulator.encoder.value = message.toUpperCase();
        var code = []
        //Turns the rotors
        function updateRotorState(rotorNum){
                var rotor1state = document.simulator.rotor1.value.toUpperCase();
                var rotor2state = document.simulator.rotor2.value.toUpperCase();
                var rotor3state = document.simulator.rotor3.value.toUpperCase();
                if(rotorNum == 1){
                        var rotorPos = alphabet.indexOf(rotor1state);

                        var newPos = rotorPos + 1;

                        if(rotor1state == "V"){
                                document.simulator.rotor1.value=alphabet[newPos]
                                updateRotorState(2);
                        }
                        if(rotorPos == 25){
                                newPos = 0;
                        }
                        document.simulator.rotor1.value = alphabet[newPos];
                }
                if(rotorNum == 2){
                        var rotorPos = alphabet.indexOf(rotor2state);
                        var newPos = rotorPos + 1;
                        if(rotor2state == "E"){
                                document.simulator.rotor2.value = alphabet[newPos];
                                updateRotorState(3);
                        }
                        if(rotorPos == 25){
                                newPos = 0;    
                        }
                        document.simulator.rotor2.value = alphabet[newPos];
                }
                if(rotorNum == 3){
                        var rotorPos = alphabet.indexOf(rotor3state);
                        var newPos = rotorPos + 1;
                        if(rotorPos == 25){
                                newPos = 0;    
                        }
                        document.simulator.rotor3.value = alphabet[newPos]
                        //Eventually need to add code to make next rotor turn over
                }
        }
        //Turns the message into a stripped output. Removes all non letter characters including spaces
        function workingMessageGen(message){
                var workingMessage = ""
                var messageArray = message.split('');
                for(var char in messageArray){
                        for(var letter in alphabet){
                                if(messageArray[char] == alphabet[letter]){
                                        workingMessage += alphabet[letter];
                                }
                        }
                }
                return workingMessage;
        }
        toWorkWith = workingMessageGen(message);
        for(var letter in message){
                updateRotorState(1);
        }
        document.simulator.decoder.value=toWorkWith;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T04:50:57.117

我不确定您期望会发生什么，但代码中存在一些缺陷：

*   JavaScript 字符串值是不可变的——它们不是对象。调用类似的函数`toUpperCase`不会改变变量，而是*返回*新值。`document.simulator.encoder.value.toUpperCase()`因此`message.toUpperCase()`是无用的。
*   后面缺少分号`var code = []`（尽管这无关紧要，但您永远无法确定）
*   `toWorkWith`缺少`var`声明 - 似乎不是有意的
*   `for(var char in messageArray)`- 从不枚举数组属性！使用 for 循环迭代它的 indizes（请参阅[为什么使用“for...in”和数组迭代是个坏主意？](https://stackoverflow.com/q/500504/1048572)）
*   `for(var letter in message)`- 因为`message`是一个字符串，所以不要试图枚举它的属性！a) 这在 IE 中不起作用 b) 你可能会在`String.prototype`. 相反，使用普通的 for 循环和`message.length`.
*   在整个脚本中，您都在混合代码逻辑和 DOM 访问。您是否使用 DOM 来检索、显示、存储值？分 3 步完成：从 DOM 读取输入，执行逻辑，写入输出。

# linux - 使用 tslib 触摸屏的数据流是什么？

> ID：14351399
> 
> 赞同：2
> 
> 时间：2013-01-16T04:30:22.127
> 
> 标签：linux, qt, embedded, arm, linux-device-driver

我不明白 tslib 是如何工作的。假设我有一个串行触摸屏，据我了解，数据以下列方式流动： `ts press -> serial port -> ts driver -> tslib -> device file (like /dev/input/eventX)` 对吗？还是我需要在`ts driver`和之间插入一些代码`tslib`以便他们可以通信？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T00:30:00.213

Tslib 不在触摸屏驱动程序和输入设备文件之间运行——它代表使用它的应用程序访问设备文件。使用 tslib 时的关键数据流是`device file -> tslib -> application`.

应用程序指定输入设备文件（触摸设备的）tslib 应该与`ts_open()`函数一起使用，然后使用其他 tslib 函数来获取触摸样本。

tslib API 在[tslib.h](https://github.com/kergoth/tslib/blob/master/src/tslib.h)中定义，源代码中有许多使用示例，`tests`包括简单的[ts_print.c](https://github.com/kergoth/tslib/blob/master/tests/ts_print.c)。

# java - JFreeChart 图像在 JSP 中不刷新

> ID：14351409
> 
> 赞同：0
> 
> 时间：2013-01-16T04:31:30.573
> 
> 标签：java, jsp, jfreechart

我有一个 jsp 页面，其中包含两个文本字段开始日期和结束日期。用户将输入开始日期和结束日期，然后我将在数据库中查询这些日期之间的数据。当我点击提交时，它只会将其转发到当前页面，我会将日期作为参数传递。到目前为止一切顺利，但问题是图像 jfreechart 不会刷新，除非我刷新浏览器本身。

这是我的表格。

```
 <form method="GET" action='monitor' name="check">
  <table>
  <tr>
  <td>Start Date (dd/MM/yyyy format):</td>
  <td><input type="text" name="startDate"
  value="<%=startDate%>"></td>
  </tr>
  <tr>
  <td>End Date (dd/MM/yyyy format):</td>
  <td><input type="text" name="endDate" value="<%=endDate%>"></td>
  </tr>
  <tr>
  <td><input type="submit" value="check"></td>
  </tr>
  </table>
  </form>

  <img src="lineChart.png" width="600" height="400" border="0" usemap="#chart" /> 
```

这是我用于生成图表的内联代码

```
 final File file1 = new File(getServletContext().getRealPath(".") + "/lineChart.png");
   ChartUtilities.saveChartAsPNG(file1, chart, 600, 400, info); 
```

我尝试做 writeChartAsPNG 但它会覆盖整个页面。页面应该仍然看起来像，

```
Start Date:
End Date: 

[ VIEW ] 

Monitor Data Chart
[  chart here ] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T04:49:33.250

当您单击时，您必须进行相当大的更改才能使图像在页面内刷新`View`，并且您最终将编写相当多的 javascript

基本上必须发生的事情（这是相当高的水平）

1.  制作`View`一个常规按钮，而不是在表单上提交。
2.  将点击监听器附加到视图按钮（查看[jQuery 文档](http://api.jquery.com/click/)以了解它的点击功能）
3.  在侦听器中，从 Start Date 和 End Date 输入中获取值
4.  将图像的 src 属性（使用[类似于此 SO 答案](https://stackoverflow.com/questions/1077041/refresh-image-with-a-new-one-at-the-same-url)的机制）设置为 jsp 或 servlet，将开始和结束日期作为 get 变量发送（在查询字符串中，例如`?startdate= ... &enddate= ...`
5.  在该 jsp 或 servlet 中，生成图表并返回来自 jFreeChart 的原始 png 输出，内容类型为`image/png`(use `response.setContentType("text/png")`)。这将正确显示 img 标签中的图像，您也不必将文件写入磁盘。

此过程将在您每次点击时更新图像`View`，并使用您输入表单的值。

这是很多步骤，如果不了解更多关于您的设置的信息，我无法真正深入了解实施的细节，但希望这会为您指明正确的方向

# xml - org.w3c.dom.Document xml 解析错误

> ID：14351417
> 
> 赞同：0
> 
> 时间：2013-01-16T04:32:39.617
> 
> 标签：xml, dom, sax, xerces

我正在使用 apache xerces DOMParser 和 org.w3c.dom.Document 来解析 xml 文档。在尝试查找元素并设置一些文本内容时，没有抛出错误，但 setNodeValue(String) 方法没有为节点设置任何内容。该节点是一个文本节点。当我调试时，我看到像 nextSibling 或 firstChild 这样的属性是#text 或 \n。如何删除这些空格和 #text ？为什么 setNodeValue() 方法不起作用？

我还有一个问题：如何 getElementBytagName 具有名称空间的文档元素，例如 "tns:result" ？

在下面的 xml 中：

```
<document xmlns:tns="....">
<header>
 <tns:username/>
</header>
</document> 
```

document.getElementsByTagName("tns:username").items(0).setNodeValue("hello");

但这样做之后，结果 xml 仍然是一样的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T07:11:35.513

当节点类型为`ELEMENT_NODE`（在您的情况下）时，调用`setNodeValue(...)`无效（请参阅文档`Node#setNodeValue(String ...)`。您必须改为创建一个子文本节点。

至于您看到的文本节点，它们在文档中。如果您删除它们，您会将所有标签放在一行上。在处理 XML 时，您必须准备好忽略无关紧要的空格。解析器无法为您执行此操作，因为它不知道哪个空格对*您*无关紧要。

# ajax - 使用ajax显示html表单

> ID：14351419
> 
> 赞同：2
> 
> 时间：2013-01-16T04:32:55.410
> 
> 标签：ajax, forms

我想创建一个基于 ajax 的页面，我可以在其中调用另一个 php 文件中的表单以在用户请求时显示它，并通过另一个 ajax 提交表单数据。后面的过程很熟悉，但我对前者有些困惑。我该怎么做？谁能帮忙？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-20T10:29:56.980

You may be trying for this:

Consider this:

index.php(or other file where the form should be called):

```
<!doctype html>
<head>
<script>
var xmlhttp=new XMLHttpRequest();
xmlhttp.onreadystatechange=function(){
  if(xmlhttp.readyState==4&&xmlhttp.status==200){
    document.getElementById("result").innerHTML=xmlhttp.responseText;
  }
}
xmlhttp.open("GET", "form.php?id="+Math.random(), true);
xmlhttp.send();
function later_process(){//form submission here(since you are familiar.I may also provide it just give a comment.}
</script>
</head>
<body>
<div id="result"></div>
</body>
</html> 
```

form.php

```
/* No body/head/!doctype declarations */
<form method="post">
</form> 
```

# gcc - 如果 C_INCLUDE_PATH 包含尾随 `:`，为什么 `.` 会自动添加到 gcc 标头搜索路径中

> ID：14351430
> 
> 赞同：0
> 
> 时间：2013-01-16T04:34:20.910
> 
> 标签：gcc

实际上我在编译 gcc-4.7.2 时遇到了这个问题。但我可以简单地重现问题如下：

我有一个简单的源文件 hello.c 用于测试。它的内容只是一个包含指令：

```
#include "hello.h" 
```

在 bash 中，我首先运行以下命令：

```
export C_INCLUDE_PATH=/home/dwang/local/include: 
```

然后我运行：

```
gcc -v -E hello.c 
```

它输出搜索路径：

```
#include "..." search starts here:
#include <...> search starts here:
/home/dwang/local/include
/export/scratch/packages/include/
.
/usr/lib/gcc/x86_64-linux-gnu/4.6.1/include
[...] 
```

`:`然后，如果我从以下位置删除尾随`C_INCLUDE_PATH`：

```
export C_INCLUDE_PATH=/home/dwang/local/include 
```

搜索路径为：

```
#include "..." search starts here:
#include <...> search starts here:
/home/dwang/local/include
/export/scratch/packages/include/
/usr/lib/gcc/x86_64-linux-gnu/4.6.1/include
[...] 
```

似乎如果有尾随`:`，`C_INCLUDE_PATH`将`.`自动添加。这是gcc的功能还是错误？

这里说明了这如何破坏我的 gcc 编译：[Error Compiling gcc-4.7.2](https://stackoverflow.com/questions/14350488/error-compiling-gcc-4-7-2/14351132)

编译器：gcc-4.6.1

操作系统：Ubuntu 11.10

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T15:12:34.423

这是 gcc 的一个功能，如此[处所述](http://gcc.gnu.org/onlinedocs/cpp/Environment-Variables.html)

引用文档：

> 在所有这些变量中，一个空元素指示编译器搜索其当前工作目录。空元素可以出现在路径的开头或结尾。例如，如果 CPATH 的值为 :/special/include，则与 `-I. -我/特别/包括'。

# java - 如何使用 JPA 在 Hibernate 中获取计数？

> ID：14351435
> 
> 赞同：1
> 
> 时间：2013-01-16T04:34:48.193
> 
> 标签：java, mysql, hibernate, jpa

我将 Hibernate 与 JPA 和 MySql 一起使用。

SQL表有`ClassTable`----> `TimeTable`-----> `Skillset`----->课程

上面的箭头标记显示`one to many`关系。

现在在我的 Java 代码中......

```
public List<ClassTableVO> getClassTables() {
    return entityManager.createQuery("from ClassTableVO",
            ClassTableVO.class).getResultList();
} 
```

但我的要求是计算课程，ClassTable 中有多少。

例如 ClassTabel 有 10 条记录和 4 条记录`java`和 6 条记录`flex`现在我想要这些计数并存储一个整数变量......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T04:41:42.440

从 classtable 中选择 count(courses) where courses='java' (OR) 从 classtable group by(courses) 中选择 count(courses)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T04:43:26.837

干得好，

```
public int getRecordCount(String subject) {
    return session.createCriteria(ClassTableVO.class)
            .add(Restrictions.eq("subject", subject)).getResultList()
            .size();
} 
```

# google-chrome - HTTP OPTIONS 飞行前请求加载已取消，Chrome 中处于待处理状态

> ID：14351437
> 
> 赞同：6
> 
> 时间：2013-01-16T04:34:52.847
> 
> 标签：google-chrome, sencha-touch-2, cors, http-options-method

我正在使用 Sencha Touch 2.1.0。我正在进行 HTTP GET 调用。这是一个 CORS 请求。因此它按预期发送 Pre-flight HTTP OPTIONS 命令。

我已经在我的服务器上安装了 CORS 过滤器并进行了配置。直到昨天，来自我的代码的调用都进行得很好。今天突然停止加载数据。当我在 Chrome 中检查网络调用时，我看到 OPTIONS 方法显示为“已取消加载”

方法：OPTIONS
状态文本：“Load cancelled”
类型：pending
发起者：Connection.js:319

我第一次配置 CORS 过滤器时遇到了类似的问题。当我清除浏览器缓存时，它开始工作。这一次，我不知道为什么它突然停止工作了。即使我清除浏览器中的缓存和历史记录，它也没有得到修复。

如果我在 Firefox 中从 HTTPRequestor 进行相同的调用，效果会非常好。这是电话。由于保密原因，我屏蔽了网址。

```
OPTIONS http://myurl/rest/items?_dc=1358304888220&page=1&start=0&limit=25 HTTP/1.1
Access-Control-Request-Method: GET
Origin: http://localhost:8080
Access-Control-Request-Headers: accept, origin, x-requested-with 
```

相同的请求给了我来自 HTTPRequestor 的非常好的响应。结果如下：

```
OPTIONS http://myurl/rest/items?_dc=1358304888220&page=1&start=0&limit=25
Access-Control-Request-Headers: accept, origin, x-requested-with
Access-Control-Request-Method: GET
Origin: http://localhost:8080

 -- response --
200 OK
Date:  Wed, 16 Jan 2013 03:19:27 GMT

Server:  Apache-Coyote/1.1

Access-Control-Allow-Origin:  http://localhost:8080

Access-Control-Allow-Credentials:  true

Access-Control-Allow-Methods:  HEAD, GET, POST, OPTIONS

Access-Control-Allow-Headers:  X-Requested-With, Origin, Accept, Content-Type

Content-Length:  0

Strict-Transport-Security:  max-age=15768000, includeSubDomains

Keep-Alive:  timeout=15, max=100

Connection:  Keep-Alive 
```

商店中的 Sencha 代码进行此调用：

```
 proxy: {
        type: 'ajax',
        method: 'GET',
        url: 'http://myurl/rest/items',
        withCredentials: true,
        useDefaultXhrHeader: false,
        disableCaching: false,
        headers: {
            "Accept": "application/json"
        },
        failure: function(response) {
            if (response.timedout) {
                Ext.Msg.alert('Timeout', "The server timed out :(");
            } else if (response.aborted) {
                Ext.Msg.alert('Aborted', "Looks like you aborted the request");
            } else {
                Ext.Msg.alert('Bad', "Something went wrong with your request");
            }
        },
        success: function(response){
            Ext.Msg.alert(response.responseText);
        }
    },
    autoLoad: true, 
```

请帮助我了解如何解决此问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T02:38:24.793

由于上次 Google Chrome 更新，这似乎是一个问题。当我尝试使用 Iron 浏览器时，它可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T17:01:47.233

我在 Webkit 浏览器的 beta 版本中遇到了类似的问题。事实证明，`Content-Type`为包含 Blob 的 XMLHttpRequests 隐式设置了标头，因此我必须将其添加到`Access-Control-Allow-Headers`我的上传服务器上。

见：[https ://bugs.webkit.org/show_bug.cgi?id=99983](https://bugs.webkit.org/show_bug.cgi?id=99983)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-07T15:53:27.190

我刚刚解决了这个问题。服务器响应标头应设置为：

```
"Access-Control-Allow-Origin": "*"
"Access-Control-Allow-Headers": "Origin, X-Requested-With, Content-Type, Accept" 
```

你已经这样做了。我认为如果 GET 或 POST 方法包含 X-Requested-With 标头，则将首先发送 OPTIONS 方法。X-Requested-With 标头在默认的 XHR 标头中。所以我们应该将'useDefaultXhrHeader'设置为false。Ext.data.Store 不支持此参数。编辑 sdk/src/data/Connection.js，将 useDefaultXhrHeader 的默认值更改为 false。

# php - 在循环内循环更新数据库记录

> ID：14351445
> 
> 赞同：2
> 
> 时间：2013-01-16T04:35:32.330
> 
> 标签：php, mysql, loops

我有一个包含以下数据的交易表：

```
dealID   |   date    |   followUP  |  user
1        |2012-10-15 |    Yes      |
2        |2012-12-24 |    Yes      |
3        |2013-01-05 |             |
4        |2013-02-02 |    Yes      |
5        |2013-02-02 |    Yes      | 
```

还有一个包含我的用户列表的用户表

```
userID    | name
1         | john
2         | eric
3         | anne 
```

我想做的是查询第一个将 followUP 设置为“YES”的表，然后从结果中从 users 表中按顺序为他们分配一个用户，这样我的最终交易表将如下所示

```
dealID   |   date    |   followUP  | userID
1        |2012-10-15 |    Yes      | 1
2        |2012-12-24 |    Yes      | 2
3        |2013-01-05 |             |
4        |2013-02-02 |    Yes      | 3
5        |2013-02-02 |    Yes      | 1 
```

我知道它是一个循环，但由于某种原因，我无法弄清楚如何设置第二个循环来分配用户的价值。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T05:01:44.060

首先将您的用户 ID 放入一个数组中，使其看起来：

```
$uids = array(1, 2, 3); 
```

然后，当从交易表中读取记录时，会像这样编写更新查询：

```
$follow_up_user_idx = 0;
$update_queries = array();
while($row=mysqli_fetch_assoc($result)) {
    // ... do whatever you need to
    if($row['followUP'] != 'Yes') continue;
    $update_queries[] = "UPDATE `deals` SET `user` = '" . $uids[$follow_up_user_idx] . "'
                         WHERE `dealID` = '" . $row['dealID'] . "' LIMIT 1";
    $follow_up_user_idx++;
    if($follow_up_user_idx > count($uids) - 1) $follow_up_user_idx = 0;
} 
```

现在您有了所有更新查询。只需执行它们：

```
foreach($update_queries as $uq) {
    mysqli_query($link, $uq);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T05:04:28.227

您将必须遵循一系列步骤来实现您所提到的。

1）从数据库中获取`followUP`“是”的所有记录。
可以说第一张桌子是`deals`. `followUP`因此，获取“是”的所有记录。
可以说，您有 $deals_details 的结果。

2）从数据库中获取所有用户（名称）。
可以说第二张桌子是`users`. 因此，获取所有用户。
可以说，您在 $users_details 数组中拥有所有用户的姓名。
在单独的变量 $users_count 中获取系统中的总用户数。

3) 循环遍历$deals_details，从$users_details依次为每个用户分配。

```
$i = 0;
foreach($deals_details as $keyDD => $valueDD){
    $user = $users_details[$i];
    $i++;
    if($i == $users_count)
        $i = 0;
    $query = "update `deals` set user = '".$user."' where dealID = '".$valueDD['dealID']."'";

    //fire query
    //$link is connection variable.
    mysqli_query($link, $query);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T06:07:49.557

表用户 +---------------+----------------+------------+ | 用户 ID | 用户名 | 用户级别 | +---------------+---------------+------------+ | 1 | 超级管理员 | 管理员 | | 2 | 副管理员 | 管理员 | | 3 | 团队1 | 团队 | | 4 | 团队2 | 团队 | | 5 | 团队3 | 团队 | | 6 | 客户1 | 客户 | | 7 | 客户2 | 客户 | | 8 | 客户3 | 客户 | | 9 | 客户4 | 客户 | +---------------+---------------+------------+ 餐桌投诉：+---------------+---------------+------------+ | 投诉ID | 投诉 | 用户 ID | +---------------+---------------+------------+ | 1 | 操作系统问题 | 7 | | 2 | USB 问题 | 8 | | 3 | 操作系统currepted | 7 | | 4 | 高清问题 | 9 | | 5 | DVD发行| 6 | | 6 | 软件问题 | 9 | | 7 | 网络问题| 9 | | 8 | 系统问题 | 6 | +---------------+---------------+------------+表assign_work +- --------------+------------+ | 投诉ID | 用户 ID | +---------------+------------+ | 1 | 3 | | 2 | 4 | | 3 | 5 | | 4 | 3 | | 5 | 4 | | 6 | 5 | | 7 | 3 | | 8 | 4 | +---------------+------------+

当客户提出投诉时，投诉数据也应该保存在投诉表中，最后一个投诉_id应该保存在assign_work表中，同时
user_id也顺序保存，从用户表中获取只有该人ID的团队。我是ph新手，请任何人帮助我。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T05:29:17.200

这可能是一个糟糕的设计决策。在不了解您的应用程序的更多信息的情况下，我很想等待用户可用/请求交易，然后（从队列中）为他们分配需要跟进的下一个交易。即使您有充分的理由在用户“可用”之前分配用户，您也可能会考虑在基于某些适当业务逻辑的交易创建/修改时这样做（例如，维护要分配给下一个交易的用户队列）。

确实，没有特别好的方法可以通过简单的`UPDATE`语句来执行此操作。`Users`纯粹在数据库中完成它的一种方法是使用存储过程（尽管它不是特别安全的并发，因为在关闭和重新打开游标之间更改表`_curUser`可能会导致不良影响；可以改为将其复制`Users`到临时表出于此过程的目的，取决于您所需的逻辑）：

```
DELIMITER //

CREATE PROCEDURE assignDeals() BEGIN
  DECLARE _userID, _dealID BIGINT UNSIGNED;
  DECLARE _done BOOLEAN DEFAULT FALSE;

  DECLARE _curUser CURSOR FOR
    SELECT   userID
    FROM     users
    ORDER BY userID;

  DECLARE _curDeal CURSOR FOR
    SELECT   dealID
    FROM     deals
    WHERE    followUP = 'Yes'
    ORDER BY dealID
    FOR UPDATE;

  DECLARE CONTINUE HANDLER FOR NOT FOUND
    SET _done := TRUE;

  PREPARE stmt FROM 'UPDATE deals SET userID = ? WHERE dealID = ?';

  OPEN _curUser;
  OPEN _curDeal;

  readDeal: LOOP
    FETCH _curDeal INTO _dealID;
    IF _done THEN
      LEAVE readDeal;
    END IF;

    FETCH _curUser INTO _userID;
    IF _done THEN
      SET _done := FALSE;
      CLOSE _curUser;
      OPEN  _curUser;
      FETCH _curUser INTO _userID;
      IF _done THEN
        SIGNAL SQLSTATE VALUE '45000' SET
          MESSAGE_TEXT = 'No users';
        LEAVE readDeal;
      END IF;
    END IF;

    SET @userID := _userID, @dealID := _dealID;
    EXECUTE stmt USING @userID, @dealID;
  END LOOP readDeal;

  CLOSE _curUser;
  CLOSE _curDeal;

  DEALLOCATE PREPARE stmt;
END//

DELIMITER ; 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/869c9/1/1)上查看。

# android - 如何知道活动组中的最后一个标签 ID？

> ID：14351449
> 
> 赞同：0
> 
> 时间：2013-01-16T04:36:00.197
> 
> 标签：android, tabs, tabactivity

我已经在选项卡主机中实现了活动组。有 4 个活动组。在每个活动组的每个第一个活动中，我都有一个后退按钮。我面临一个问题。假设我有 4 个活动组，比如 A、B、C、D。现在当应用程序启动时，那时活动组 A 将在那里，当我从 A->B 切换而不是从 B->C 切换时，现在我在名为 C 的活动组中。现在当我单击活动组的返回按钮时一个C.在那个时候，标签主机的当前标签应该是我已经导航到C的上一个标签主机。是否有任何标准方法可以做到这一点，或者我们需要按照我们的逻辑放置？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T05:52:02.133

没有标准的方法可以做到这一点，但话又说回来，任何事情都是有可能的！我在早期的应用程序中遇到了类似的问题。我通过维护一堆最后打开的选项卡来解决它，然后覆盖按下的后退按钮以从堆栈中删除选项卡。下面给出了一些示例代码。
初始化变量如下

```
tabIdStack = new Stack<Integer>();
openedTab = 0; 
```

然后覆盖`onTabChanged()`

```
@Override
    public void onTabChanged(String tabId) {
        if (!backButtonPressed) {
            if (tabIdStack != null) {
                if (tabIdStack.size() == noOfTabs)
                    tabIdStack.remove(0);
                tabIdStack.push(openedTab);
                openedTab = tabHost.getCurrentTab();
            }
        }
        backButtonPressed = false; 
```

然后你也应该覆盖`onBackPressed()`

```
@Override
    public void onBackPressed()
    {
        backButtonPressed = true;
        if (tabIdStack.size() == 0)
            this.finish();
        else {
            tabHost.setCurrentTab(tabIdStack.get(tabIdStack.size() - 1));
            tabIdStack.remove(tabIdStack.size() - 1);
        }       
    } 
```

# ios - 在表格视图单元格中编辑文本字段的最佳方法

> ID：14351451
> 
> 赞同：5
> 
> 时间：2013-01-16T04:36:02.737
> 
> 标签：ios, objective-c, cocoa-touch, uitableview

在我的应用程序中，我有许多`views`需要就地的东西`editable`。我已经`tableviewcells`设置了包含`UITextField`启用的设置，并且可以更改文本，这很好，它可以工作。

我的问题是跟踪这些的最佳方法是什么？我是不是该 ：

*   保留每个`textfield`. 如果是的话
    *   `cell`如果仅实例化一次，如何确保每个字段都具有正确的字段？
*   `textfield`在创建时添加一个`cell`，并在配置时简单地设置它的值`cell`。如果是的话
    *   我如何跟踪这些值？如果`cell`退出`view`然后返回，则其值将重置为其原始值，而不是编辑后的值。

对于这种情况，您通常倾向于使用什么方法？`cells`特别是如果您正在处理大量此类问题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-16T06:15:54.960

1.  将所有文本字段的值存储在数据模型中的可变数组中。

2.  在`tableView:willDisplayCell:forRowAtIndexPath:`设置文本字段的值时，使用基于索引路径的数组中的值。

3.  当文本字段结束编辑时，立即将值存储回数组中。已经有一个协议（所以不需要自己编写），但它比正常的有点棘手，因为你没有得到 indexPath 并且需要找到与你的文本字段关联的那个：

    ```
    - (void) textFieldDidEndEditing:(UITextField *)textField {
        CGRect location = [self convertRect:textField.frame toView:self.tableView];
        NSIndexPath *indexPath = [[self.tableView indexPathsForRowsInRect:location] objectAtIndex:0];

        // Save the contents of the text field into your array:
        [yourArray replaceObjectAtIndex:indexPath.row withObject:textField.text];
    } 
    ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-16T05:42:20.920

*   子类 UITableViewCell 并在它的 init 方法中添加一个 UITextField 。

*   为自定义单元类创建协议。当 UITextField 开始编辑或结束编辑时调用委托的方法。

*   在控制器中，实现自定义单元格的协议并将 indexpath 行值设置为 tableView:cellForRowAtIndexPath 中的单元格标记：

所以每次编辑 UITextField 时，您都可以在控制器中知道正在编辑哪一行（通过单元格的标签）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-16T05:10:05.607

最好的方法是遵循 MVC 并实现您的模型，在您的情况下是文本字段值。您所做的是将这些值存储在一个数组中，并在您的 cellForIndexPath 方法中引用数组中的正确值。例如，表的第一行 (indexPath.row == 0) 将检索数组中的第一个元素。textField 中的更改将记录在数组中的相应元素上。

# wpf - 如何冻结wpf中列表框的第一项？

> ID：14351452
> 
> 赞同：0
> 
> 时间：2013-01-16T04:36:18.860
> 
> 标签：wpf, xaml, listbox, listboxitem

我有一个带有单选按钮的列表框作为其项目。列表框是可滚动的，可以添加尽可能多的项目。但是，我必须保持第一个项目冻结，因为它应该一直可见。请问有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T06:53:47.553

它有点棘手。您可以编辑 Listbox 的模板并在滚动查看器上方添加一个 ListBoxItem。类似的东西

```
<Style x:Key="ListBoxTopItemFixedStyle" TargetType="{x:Type ListBox}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ListBox}">
                    <Border x:Name="Bd" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" Padding="1" SnapsToDevicePixels="true">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <ListBoxItem Content="{Binding Path=FreezeItem.PropertyName, 
                                                    RelativeSource={RelativeSource AncestorType={x:Type Window}}}" 
                                         Grid.Row="0"/>
                            <ScrollViewer Focusable="false" Padding="{TemplateBinding Padding}"  Grid.Row="1">
                                <ItemsPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                            </ScrollViewer>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsEnabled" Value="false">
                            <Setter Property="Background" TargetName="Bd" Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"/>
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsGrouping" Value="true"/>
                                <Condition Property="VirtualizingPanel.IsVirtualizingWhenGrouping" Value="false"/>
                            </MultiTrigger.Conditions>
                            <Setter Property="ScrollViewer.CanContentScroll" Value="false"/>
                        </MultiTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

我还使用了 FreezeItem，它是控制上下文中集合中的一个项目。您可以使用相同的概念并根据需要对其进行修改。如果你想避免 FreezeItem，你也可以使用转换器来获取第一个集合。

# android - 使用eclipse在android中的M3u广播流

> ID：14351453
> 
> 赞同：-1
> 
> 时间：2013-01-16T04:36:24.807
> 
> 标签：android, streaming, android-mediaplayer, m3u

我正在开发一个 Android 无线电流应用程序。我想使用 M#U 文件流式传输音乐。你能告诉我怎样才能做到这一点吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T04:44:02.793

以前的一些问题可能会对您有所帮助

*   [流式传输 .m3u 音频](https://stackoverflow.com/questions/6688758/streaming-m3u-audio)
*   [使用流媒体播放器](http://blog.infidian.com/2008/04/04/tutorial-custom-media-streaming-for-androids-mediaplayer/)
*   [适用于 Android 的在线广播流媒体应用](https://stackoverflow.com/questions/6283568/online-radio-streaming-app-for-android)
*   [相同的一些错误](https://stackoverflow.com/questions/3648758/streaming-from-m3u-on-android)

# php - jQuery 发出 post 请求并检索结果

> ID：14351463
> 
> 赞同：0
> 
> 时间：2013-01-16T04:38:39.887
> 
> 标签：php, jquery, post

所以我有一个测试输入和一个提交按钮。我想通过 jQuery 发送数据并从 post 请求中检索结果，然后显示 post 请求返回的值，而不刷新页面。

这是我的html：

```
<div id="middle">
    <form id="searchForm" action="/">
        <input placeholder="E.g. http://www.google.co.nz" id="url" type="text" name="forward_to"/>
        <input id="button" type="submit" name="shorten" value="Go"/>
    </form>

    <div id="result"></div>

</div> 
```

这是我的php

```
if($query) {
    print("<div id='content'>http://www.website.co.nz/u/$short</div>");
} else {
    print("<div id='content'>Error</div>");
} 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T04:41:54.387

```
$(document).ready(function(){
    $('#button').click(function(e){
        e.preventDefault();
        $.ajax({
            type: 'post',
            url: '/',
            data: { query:  $('#url').val() },
            success: function(data) {
               $("#result").html(data);
            },
            error: function() {
              $("#result").html("Some error occurred.");
            }
        });
    });
}); 
```

# windows-ce - WinCE 6.0 - 如何以编程方式显示/隐藏输入面板？

> ID：14351465
> 
> 赞同：0
> 
> 时间：2013-01-16T04:39:03.113
> 
> 标签：windows-ce

我在装有 win ce 6.0 (ARMV41) 的设备上运行了一个 MFC 应用程序（基于对话框）。您知道显示/隐藏软件输入面板的 API 函数吗？

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T21:05:53.247

在 Windows CE 中，您必须处理一个名为 的窗口`SipWndClass`，一旦发现您已经向它发送了适当的窗口消息以隐藏或显示它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T14:04:18.307

使用[`SipShowIM`API](http://msdn.microsoft.com/en-us/library/ee502869%28v=winembedded.60%29.aspx)。[MSDN here 中](http://msdn.microsoft.com/en-us/library/ms838341.aspx)有一个示例，但本质上，为了显示它，它看起来像这样：

```
SipShowIM(SIPF_ON); 
```

隐藏它看起来像这样：

```
SipShowIM(SIPF_OFF); 
```

# iphone - 从 [myarray objectAtIndex:indexPath.row] 而不是 NSString 获取对象

> ID：14351469
> 
> 赞同：-3
> 
> 时间：2013-01-16T04:39:14.440
> 
> 标签：iphone, ios, uitableview

我有一个名为`contact`. 此类具有`name, address`等属性。我希望创建一个类型数组`contact`并在 UItableview 的自定义单元格中显示每个属性的值。将数据存储在数组中的代码：

```
while(sqlite3_step(compiledStatement) == SQLITE_ROW) {
            // Read the data from the result row
            NSString *aName = [NSString stringWithUTF8String:(char *)sqlite3_column_text(compiledStatement, 1)];
            myContact.nm = aName;
            NSString *aAddress = [NSString stringWithUTF8String:(char *)sqlite3_column_text(compiledStatement, 2)];
            myContact.address = aAddress;

            NSLog(@"%@",aName);     
            [list.details addObject:myContact];
            NSLog(@"%@", list.details);

} 
```

`@property(nonatomic,retain)NSMutableArray *details;`这里的 details 是一个声明为.h的数组

我的问题是我如何检索每个索引上的值，例如：

```
[0]->name
[0]->address

[1]->name
[1]->address .... 
```

我在 tableview.m 中的代码：

```
cell.name.text = [details objectAtIndex:indexPath.row]; // not working 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T05:00:00.893

首先制作一个类的对象。

```
Contact *con = [details objectAtIndex:indexPath.row]; 
```

它将所有数组存储在“con”对象中。

然后，使用它，

```
NSLog("Name :: %@", con.nm);
NSLog("Addr :: %@", con.address); 
```

它将引用该特定联系人对象的名称和地址。

谢谢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-15T17:08:20.340

```
[[details objectAtIndex:indexPath.row] nm]; 
```

在`nm`你只需要输入你的对象。这对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T04:56:24.753

你需要：

```
cell.name.text = [[details objectAtIndex:indexPath.row] nm]; 
```

当您使用此行时：

```
[details objectAtIndex:indexPath.row]; 
```

它返回一个类型的对象`contact`。然后您需要获取`nm`存储名称的属性。所以你需要像这样使用：

```
[[details objectAtIndex:indexPath.row] nm]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T04:52:10.080

`[details objectAtIndex:indexPath.row];`返回`Contact`对象。您需要的是代表代码中名称的对象`nm`属性。`Contact`

尝试这个，

```
Contact *myContacts = [details objectAtIndex:indexPath.row]; 
cell.name.text = [myContacts nm]; //or [[details objectAtIndex:indexPath.row] nm]; 
```

同样你也可以得到`[myContacts address]`。

**编辑：** 根据您在评论中的问题，答案是：

```
while(sqlite3_step(compiledStatement) == SQLITE_ROW) {

        Contact *myContact = [[Contact alloc] init]; //you should add this here, not outside the loop
        // Read the data from the result row
        NSString *aName = [NSString stringWithUTF8String:(char *)sqlite3_column_text(compiledStatement, 1)];
        myContact.nm = aName;
        NSString *aAddress = [NSString stringWithUTF8String:(char *)sqlite3_column_text(compiledStatement, 2)];
        myContact.address = aAddress;

        NSLog(@"%@",aName);
        [list.details addObject:myContact];
        NSLog(@"%@", list.details);

    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-16T04:41:36.280

那么，你在寻找

```
cell.name.text = [[details objectAtIndex:indexPath.row] name]; 
```

?

# eclipse - 如何在 Mac 上安装 Oracle OC4J

> ID：14351472
> 
> 赞同：0
> 
> 时间：2013-01-16T04:39:40.447
> 
> 标签：eclipse, macos, oc4j

我正在使用 Eclipse 创建一个 Java EE 项目，并且需要“Oracle OC4J Standalone 10.1.3.n 运行时”。

如何在我的 Mac 上安装它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T18:38:37.297

我建议安装 virtal box 并使用 oracle VM。[在https://tech.lds.org/wiki/Oracle_VM](https://tech.lds.org/wiki/Oracle_VM)找到更多信息

# wordpress - wordpress 仪表板上一个奇怪的 jquery 问题

> ID：14351473
> 
> 赞同：0
> 
> 时间：2013-01-16T04:39:41.230
> 
> 标签：wordpress

我无法在我的 wordpress 仪表板上传页面中上传文件，它注意到“JQuery 未定义”，似乎所有包含 jquery 的页面都不起作用，不仅是上传页面，只是在 chrome 和 firefox 中，但是，我的朋友登录我的仪表板，一切正常。我不确定它是由我的主题或浏览器引起的。我尝试重新安装 chrome 和 WordPress，甚至都没有关系。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T08:49:15.773

您是否将您的 Wordpress 更新到新版本？升级到 3.5 版本后，我遇到了同样的问题。

我的主题中的 JQuery 版本和 Wordpress 中的版本之间存在冲突。尝试升级 Jquery。这个对我有用 ：）

# jquery - jquery onClick 动态加载图像并将其淡入

> ID：14351476
> 
> 赞同：0
> 
> 时间：2013-01-16T04:40:11.723
> 
> 标签：jquery, dynamic, fadein

我正在尝试通过单击另一个 div 将图像动态加载到 div 中。我正在尝试使用 div 的 id 来调用匹配的照片，然后让它淡入。

我不能让它工作，这是小提琴[http://jsfiddle.net/X82zY/36/](http://jsfiddle.net/X82zY/36/)

我也会把代码放在这里

HTML：

```
<div id="container">
    <img id="preload" onload="fadeIn(this)" src="#" style="display:none;" />
</div>

<div id="TDodd" class="iso"></div> 
```

JS

```
function fadeIn() {
    $(this).fadeIn(1000);
}

$(".iso").click(function() {

  var id = $(this).attr('id');

    $('#container 
img').attr('src','http://www.klossal.com/klossviolins/instruments/violins/full/' + id + '.jpg');

    fadeIn();

}); 
```

感谢您在这里提供的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T04:40:50.667

语法错误：

```
$('.iso').click(function() {
       ^ 
```

您还可以通过`id`而不是通过`class`.
另一个问题是您的内容是动态创建的，因此您必须`on`改用并将事件绑定到文档。

所以你的代码应该是：

```
$(document).on('click', '#TDodd', function() {
  var id = this.id;
  $('#preload').prop('src', 'http://www.klossal.com/klossviolins/instruments/violins/full/' + id + '.jpg');

  fadeIn('#TDodd');
}); 
```

[**演示**](http://jsfiddle.net/ricardolohmann/X82zY/42/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T04:51:40.517

有几点不对：

1.）您的小提琴未绑定到加载功能。

2.) .iso 选择器上已经指出的引号不匹配

3.）点击事件中的fadeIn方法调用。

最终的 js 应该是这样的：

```
function fadeIn(obj) {
    $(obj).fadeIn(1000);
}

$('.iso').click(function()
{
  var id = $(this).attr('id');

    $('#container img').attr('src','http://www.klossal.com/klossviolins/instruments/violins/full/' + id + '.jpg');

    fadeIn($('#container img'));
}); 
```

[http://jsfiddle.net/X82zY/40/](http://jsfiddle.net/X82zY/40/)

# c# - 如何在运行时在 asp.net 中的树视图中添加子节点？

> ID：14351478
> 
> 赞同：0
> 
> 时间：2013-01-16T04:40:31.140
> 
> 标签：c#, asp.net

我的网页中有 treeView 控件，它有三个父节点`Parent1`, `Parent2`, `Parent3`. 然后我将如何在运行时添加孩子。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T04:47:45.453

您可以通过创建`TreeNode`. IE

```
foreach (TreeNode objTN in TreeView1.Nodes)
{
    if (objTN.Text == "You Parent Name")
        {
            TreeNode child = new TreeNode();
                child.Text = "childText";
                objTN.ChildNodes.Add(child);
    }
} 
```

有关详细信息，请参阅链接[在 c# 中动态地将子项添加到树节点。](https://stackoverflow.com/questions/5326411/adding-children-to-a-treenode-dynamically-in-c-sharp)

# jquery - jquery/js：在输入按键上动态更改跨度文本

> ID：14351482
> 
> 赞同：0
> 
> 时间：2013-01-16T04:41:01.927
> 
> 标签：jquery, text, keypress, html

```
 <span>This Changes as You Type in Input1</span><br>

 <input type="text" id="input1"><br><br>

 <span>This Changes as You Type Type in Input2</span><br>

 <input type="text" id="input2"><br><br> 
```

当用户在输入文本中输入时，我希望 jquery 搜索上面的 span 标签并在用户输入时动态更改它。我只是在此示例中使用更改，因为如果我使用 keypress 它会忽略最后一次按下的按键。

```
 //my jquery attempt that's not working
 $('#input1').change(function() {
 $(this).closest('span').html($(this).val()    
 }); 
```

想知道我是否可以使用类有效地编写代码，而不是为每个 id 重复这个更改函数。例如，如果我可以将其设为一个类并且它会更改其上方最近标签上的文本？

```
 //Like this?
 $('.inputclass').change(function() {
 $(this).closest('span').html($(this).val()    
 }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T04:44:04.023

问题是 javascript 格式错误。你错过了`)`你的结束`.html()`

```
 $(this).closest('span').html($(this).val() 
```

至

```
 $(this).closest('span').html($(this).val()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T04:49:01.193

虽然`.closest()`可以正常工作，但我建议您执行以下操作以获得更好的 html 结构。

```
<div>
    <span>This Changes as You Type in Input1</span><br>
    <input type="text" id="input1"><br><br>
</div>

<div>
    <span>This Changes as You Type in Input2</span><br>
    <input type="text" id="input2"><br><br>
</div> 
```

将您的`input`和它对应`span`在父元素中。显然，使用类，因为它可以避免代码中的冗余。

一旦你这样做了，`.closest()`就可以正常工作，但你会更好地使用它`.siblings()`。

**jQuery：**

你缺少一个右括号`)`，`.html()`你的行需要是这样的，

```
$(this).closest('span').html($(this).val()) 
```

# javascript - jQuery 事件处理程序不适用于使用 jQuery 插入的对象

> ID：14351483
> 
> 赞同：1
> 
> 时间：2013-01-16T04:41:07.807
> 
> 标签：javascript, jquery

```
<button id="first">Click me first</button>

$('#first').click(function(){
  $('body').append('<button id="second">Now click me</button>');
});

$('#second').click(function(){
  $(this).hide();
}); 
```

[jsFiddle](http://jsfiddle.net/VnCEs/)

当`#first`被点击时，`#second`被附加。当`#second`被点击时，我希望它隐藏自己。

为什么这不起作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T04:42:59.450

当您启动此事件处理程序时

```
 $('#second').click(function(){
  $(this).hide();
}); 
```

'#second' 元素尚不存在。稍后您添加元素，但该元素未使用任何事件处理程序启动。

你可以试试这个

```
$('#first').click(function(){
  $('body').append('<button id="second">Now click me</button>');
  // event handler will attached for already exist '#second' element
  // attach event if only #second doesn't have event yet
  if(!($('#second').data('events') != null && $('#second').data('events').click != undefined && $('#second').data('events').click.length == 1))
  $('#second').click(function(){
    $(this).hide();
  });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T04:45:23.623

使用 jQuery`on`函数。

```
$(document).on('click', '#second', function(){
  $(this).hide();
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T04:43:56.947

它不起作用，因为`$('#second')`它在执行时不匹配任何内容。

在添加到 DOM 之前尝试将点击处理程序分配给元素：

```
$('#first').click(function(){
  var $button = $('<button id="second">Now click me</button>');
  $button.click(function() {
    // handler
  });
  $('body').append($button);
}); 
```

如果您需要在元素存在之前“附加”事件处理程序，您还可以使用[`on`](http://api.jquery.com/on/)委托事件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-16T04:53:08.473

利用`on()`

```
$(document).on('click', '#second', function(){
  $(this).hide();
}) 
```

参考

[http://api.jquery.com/on/](http://api.jquery.com/on/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-16T04:47:01.757

尝试

```
$('#second').on("click",function(){
 $(this).hide();
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-16T04:51:57.820

澄清为什么您的代码不起作用：在#second 的事件处理的定义期间， div 不存在。在确定页面中存在 DOM 元素 $("#second") 之后，您应该定义事件处理。

# c# - 如何从 WCF 服务返回图像？

> ID：14351485
> 
> 赞同：2
> 
> 时间：2013-01-16T04:41:23.563
> 
> 标签：c#, asp.net, wcf

我正在尝试从 WCF 服务返回图像。

IService1.cs 代码：

```
[ServiceContract(Namespace = "http://Microsoft.ServiceModel.Samples")]
public interface IService1
{
    [OperationContract]
    [WebGet]
    [WebInvoke(BodyStyle = WebMessageBodyStyle.WrappedRequest)]
    Stream GetImage(int width, int height);
} 
```

service1.cs 代码：

```
namespace SecondService
{
    public class Service1 : IService1
    {
        public Stream GetImage(int width, int height)
        {
            // Although this method returns a jpeg, it can be
            // modified to return any data you want within the stream
            Bitmap bitmap = new Bitmap(width, height);
            for (int I = 0; I < bitmap.Width; I++)
            {
                for (int j = 0; j < bitmap.Height; j++)
                {
                    bitmap.SetPixel(I, j, (Math.Abs(I - j) < 2) ? Color.Blue : color.Yellow);
                }
            }

            MemoryStream ms = new MemoryStream();
            bitmap.Save(ms, System.Drawing.Imaging.ImageFormat.Jpeg);
            ms.Position = 0;

            System.ServiceModel.Channels.TcpTransportBindingElement transport = new  
                System.ServiceModel.Channels.TcpTransportBindingElement();
            transport.TransferMode = TransferMode.Streamed;
            WebOperationContext.Current.OutgoingResponse.ContentType = "image/jpeg";

            return ms;
        }
    }
} 
```

这是我的调用页面的 web.config：

```
<system.serviceModel>
  <bindings>
    <wsHttpBinding>
      <binding name="WSHttpBinding_IService1"
               closeTimeout="00:01:00"    openTimeout="00:01:00"
               receiveTimeout="00:10:00"  sendTimeout="00:01:00"
               bypassProxyOnLocal="false" transactionFlow="false"
               hostNameComparisonMode="StrongWildcard"
               maxBufferPoolSize="524288" maxReceivedMessageSize="65536" 
               textEncoding="utf-8" useDefaultWebProxy="true"
               allowCookies="false">

        <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
                      maxBytesPerRead="4096" maxNameTableCharCount="16384" />
        <reliableSession ordered="true" inactivityTimeout="00:10:00"
                         enabled="false" />
        <security mode="Message">
          <transport clientCredentialType="Windows" proxyCredentialType="None"
                     realm="" />
          <message clientCredentialType="Windows" negotiateServiceCredential="true"
                   algorithmSuite="Default" />
        </security>
      </binding>
    </wsHttpBinding>
  </bindings>

  <client>
    <endpoint address="http://localhost:8732/Design_Time_Addresses/SecondService/Service1/"
              binding="wsHttpBinding" bindingConfiguration="WSHttpBinding_IService1"
              contract="ServiceReference1.IService1" name="WSHttpBinding_IService1">

      <identity>
        <dns value="localhost" />
      </identity>
    </endpoint>
  </client>
</system.serviceModel> 
```

当我调用该服务时，我收到以下错误：

> 响应消息的内容`image/jpeg`类型与绑定的内容类型 ( ) 不匹配`application/soap+xml; charset=utf-8`。如果使用自定义编码器，请确保`IsContentTypeSupported`正确实施该方法。

我是 WCF 服务的新手，希望为 WCF 初学者提供有用的链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T07:51:48.483

您不能返回流，您必须使用如下代码将图像编码为字节数组：

```
ImageSourceConverter oConverter = new ImageSourceConverter();
BitmapSource oImageSource = (BitmapSource)oConverter.ConvertFromString(sResourceName); // Your resource name

Byte[] oResult; // This is your byte array

using (MemoryStream oStream = new MemoryStream()) 
{
    oEncoder.Frames.Add(BitmapFrame.Create(oImageSource));
    oEncoder.Save(oStream);

    oResult = new byte[oStream.Length];     
    oStream.Position = 0;

    oStream.Read(oResult, 0, (int)oStream.Length);  
    oStream.Close(); 
} 
```

# asp.net-mvc - 从数据库中获取所有值到 ASP MVC ASPX 的 webgrid

> ID：14351486
> 
> 赞同：-1
> 
> 时间：2013-01-16T04:41:24.920
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-4, webgrid

嗨，我只从 webgrid 中的数据库中获取最后一个值。我已经使用 foreach 从数据库中获取所有值并将其绑定到 webgrid 但它只显示 webgrid 中的最后一个值。请指导我

```
 var listobject = list ;

  foreach (var m in ViewBag.Model)
  {
      var  list = new[] 
                {                     

                    new { Name = m.Name, Genre =m.Genre }                        

                };
      listobject = list;

  }

  WebGrid studentGrid = new WebGrid();
  studentGrid.Bind(listobject, autoSortAndPage: false, rowCount: 3); 
```

%>

```
 <%= studentGrid.GetHtml(columns: 
new WebGridColumn[]
    {
        studentGrid.Column("Name", "name"),
        studentGrid.Column("Genre", "Genre"),

    }) 
```

%>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T16:46:44.030

在每次迭代中，您都会重置“列表”，这就是为什么您会丢失在上一次迭代中分配给它的任何值。只需传入 ViewBag.Model：

```
var grid = new WebGrid(ViewBag.Model);

@grid.GetHtml() 
```

# java - Listview 自定义 ListItem 模板

> ID：14351487
> 
> 赞同：0
> 
> 时间：2013-01-16T04:41:30.790
> 
> 标签：java, android, xml, android-listview, adt

我是 Android 编程新手，

**产品 ：**

**XML**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal" >

    <ImageView
        android:id="@+id/Picture"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/ic_launcher" />

    <LinearLayout
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:orientation="vertical" >

        <TextView
            android:id="@+id/Name"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Large Text"
            android:textAppearance="?android:attr/textAppearanceLarge" />
    </LinearLayout>

</LinearLayout> 
```

**JAVA**

```
public class Product {
    private String Name;
    private byte[] Picture;

    public String getName() {
        return Name;
    }
    public void setName(String name) {
        Name = name;
    }
    public byte[] getPicture() {
        return Picture;
    }
    public void setPicture(byte[] picture) {
        Picture = picture;
    }

    public Product(String Name) {
        this.setName(Name);
    }

} 
```

* * *

**产品 ：**

**XML**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <ListView
        android:id="@+id/Products"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >
    </ListView>

</LinearLayout> 
```

**JAVA**

```
 public class Products extends Activity {
    private ArrayList<Product> Products = null;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.products);
        Products = new ArrayList<Product>();
        Products.add(new Product("Ahmed"));
        ((ListView) findViewById(R.id.Products))
                .setAdapter(new ProductAdapter(getApplicationContext(),
                        R.layout.product, R.id.Name, Products));

    }

    public class ProductAdapter extends ArrayAdapter<Product> {

        private List<Product> Products;

        public ProductAdapter(Context context, int resource,
                int textViewResourceId, List<Product> objects) {
            super(context, resource, textViewResourceId, objects);
            this.Products = objects;

        }

        @Override
        public int getCount() {
            // TODO Auto-generated method stub
            return Products.size();
        }

        @Override
        public View getView(int position, View convertView, ViewGroup parent) {
            ProductHolder Holder;
            if (convertView == null) {
                convertView = getLayoutInflater().inflate(R.layout.product,
                        null);
                Holder = new ProductHolder();
                Holder.Name = (TextView) convertView.findViewById(R.id.Name);
                Holder.Picture = (ImageView) convertView
                        .findViewById(R.id.Picture);
                convertView.setTag(Holder);
            } else {
                Holder = (ProductHolder) convertView.getTag();
            }
            Product product = Products.get(position);
            if (product != null) {
                Holder.Name.setText(product.getName());
            }
            return convertView;
        }
    }

    public static class ProductHolder {
        public TextView Name;
        public ImageView Picture;
    }
} 
```

* * *

**AndroidManifest**

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="info.Ghoneim.Dealer"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="14"
        android:targetSdkVersion="17" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="info.Ghoneim.Dealer.Products"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

* * *

**问题 ：**

只是显示一个白色的空活动！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T04:49:07.800

我认为，您在这一行错了，您在 setContentView() 和每一行的布局中使用了相同的布局

```
 setContentView(R.layout.products); 
```

用这种方式

```
 setContentView(R.layout.XML_FILE_WHICH_CONTAIN_LISTVIEW); 
```

**编辑**：

就放

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <ListView
        android:id="@+id/Products"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >
    </ListView>

</LinearLayout> 
```

这里的这个 xml 名称就像

```
R.layout.products 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T04:45:52.247

你应该扩展这个`ListActivity`类。不是`Activity`班级

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T04:53:56.193

尝试改变：

```
<ListView
    android:id="@+id/Products"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >
</ListView> 
```

# android - Android 输入法管理器获取仅数字键盘

> ID：14351496
> 
> 赞同：4
> 
> 时间：2013-01-16T04:42:16.093
> 
> 标签：android, android-edittext

我们用

```
InputMethodManager imPharamcy = (InputMethodManager)getSystemService(Context.INPUT_METHOD_SERVICE);
imPharamcy .toggleSoftInput(0, InputMethodManager.SHOW_IMPLICIT); 
```

强行拿到键盘。但键盘不仅仅是数字键盘。如何使用 inputMethod Manager 获取仅数字键盘。

在xml中我已经给出了

```
 android:inputType="phone"
   android:imeOptions="actionNext" 
```

editText 只接受数字奇怪的是，在模拟器中出现了一个只有数字的键盘，但在电话号码和特殊字符键盘上出现了

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T04:46:43.700

见下面的代码：

```
 // TYPE_CLASS_NUMBER: Class for numeric text. This displays the numbers/symbols keyboard.
editText.setInputType(InputType.TYPE_CLASS_NUMBER);

// TYPE_CLASS_PHONE: Class for a phone number. This displays the phone number keypad.
editText.setInputType(InputType.TYPE_CLASS_PHONE); 
```

希望你明白了。

# xaml - 如何在 StandardStyles.xaml 中定义基元

> ID：14351497
> 
> 赞同：4
> 
> 时间：2013-01-16T04:42:23.767
> 
> 标签：xaml, windows-8, styles, .net-4.5, windows-store-apps

我想定义双精度值，以便可以在许多情况下重用它`UIElements`

```
<Double x:Key="MyWidth">100</Double>
<String x:Key="MyString">This is my text</String> 
```

它给了我错误**`Double is not supported in a Windows App project.`**，字符串也是如此。

如果我包含**`xmlns:sys="using:System"`**在 StandardStyles.xaml 中，那么它正在编译。

```
<sys:Double x:Key="MyWidth">100</sys:Double>
<sys:String x:Key="MyString">This is my text</sys:String> 
```

它在运行时给出异常**`XAML Parsing Failed. The type 'Double' was not found.`**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T05:01:19.680

不需要包括**`System`**命名空间。
已经包含一个命名空间**`xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"`**

```
<x:Double x:Key="MyWidth">100</x:Double>
<x:String x:Key="MyString">This is my text</x:String> 
```

# javascript - JavaScript 注释中的特殊字符

> ID：14351498
> 
> 赞同：2
> 
> 时间：2013-01-16T04:42:47.160
> 
> 标签：javascript, comments, character, special-characters

我想将作弊码嵌入到 JavaScript 文件的注释中。如果人们查看源代码，这是一个[复活节彩蛋。](https://en.wiktionary.org/wiki/Easter_egg#Noun)这些特殊字符（箭头）会对 JavaScript 解释器造成问题吗？

```
/*
 ( " ↑ ↑ ↓ ↓ ← → ← → B A ENTER " )
*/ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T08:53:51.127

它是安全的。在注释中，可以使用任何字符，除了那些被语言规范识别为终止注释的字符。根据 ECMAScript 标准，注释可以包含任何 Unicode 代码单元，并且没有理由怀疑实现不遵守这一点（他们只需要跳过那里的所有字符数据，只识别注释终止）。

但是，查看 .js 文件的用户可能会也可能不会正确看到字符，具体取决于字符编码设置。你不能保证这一点，但你可以通过从服务器提供 .js 文件来帮助解决这个问题`Content-Type: text/javascript; charset=utf-8`（如果你的文件是 UTF-8 编码的，因为它很可能是在这种情况下）并使用引用`charset=utf-8`的`script`元素中的属性文件。哦，对 BOM 使用 UTF-8。

即使正确处理了编码问题，用于查看 .js 文件的程序也有可能使用不包含您在评论中的字符的字体，因此偷看的访问者不会看到它们。但这并不影响功能。

# ios - 如何在 iOS 中将照片保存在特定相册中

> ID：14351500
> 
> 赞同：0
> 
> 时间：2013-01-16T04:43:00.637
> 
> 标签：ios

我正在使用此代码将图像保存到相册中，但图像正在保存在相机胶卷相册中。我想将图像保存在 WEAVE 相册中。我正在使用这段代码：

```
CGRect screenRect=CGRectMake(0, 0, viewPlay.frame.size.width, viewPlay.frame.size.height);
UIGraphicsBeginImageContext(screenRect.size);
CGContextRef ctx=UIGraphicsGetCurrentContext();
[[UIColor whiteColor] set];
CGContextFillRect(ctx, screenRect);
[self->viewPlay.layer renderInContext:ctx];
UIImage *screenImage=UIGraphicsGetImageFromCurrentImageContext();
UIImageWriteToSavedPhotosAlbum(screenImage, nil, nil, nil);
UIGraphicsEndImageContext(); 
```

这段代码对我来说很好。请给我任何建议，我在这里做了哪些更改以将图像保存到 WEAVE 文件夹中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T05:09:19.660

您可以使用以下代码执行此操作：

```
ALAssetsLibrary *library = [[ALAssetsLibrary alloc] init];

[library saveImage:image toAlbum:@"Midhun" withCompletionBlock:^(NSError *error) {
        if (error!=nil)
        {
            NSLog(@"Error: %@", [error description]);
        }
    }]; 
```

还可以查看本教程：[**自定义相册**](http://www.touch-code-magazine.com/ios5-saving-photos-in-custom-photo-album-category-for-download/)

有关[**ALAssetsLibrary的更多信息**](http://developer.apple.com/library/ios/#documentation/AssetsLibrary/Reference/ALAssetsLibrary_Class/Reference/Reference.html)

# animation - 在 Three.js 中动画 Blender collada 导出

> ID：14351502
> 
> 赞同：1
> 
> 时间：2013-01-16T04:43:17.037
> 
> 标签：animation, three.js, blender, skin, collada

[http://www.diviniaro.com/WGClient/js/three.js/examples/webgl_loader_collada_Gate.html](http://www.diviniaro.com/WGClient/js/three.js/examples/webgl_loader_collada_Gate.html)

在尝试了几件事之后，我们只是茫然地从搅拌器中获取导出的动画以进行加载。我注意到与 collada 加载程序中的示例“monster.dae”文件存在一些差异。无论我们尝试过什么，动画似乎都不会开始。

其他意见和第二组知识渊博的眼睛将不胜感激。动画在搅拌机中播放良好。有 31 个关键帧。控制台上也没有错误。

编辑：我认为这个问题与three.js collada loader的这些问题有关。 [https://github.com/mrdoob/three.js/issues/2963](https://github.com/mrdoob/three.js/issues/2963)

# magento - 创建帐户并且产品在购物车中后重定向到结帐

> ID：14351513
> 
> 赞同：0
> 
> 时间：2013-01-16T04:44:08.130
> 
> 标签：magento

我有一个特殊情况，用户必须通过帐户注册页面（例如/customer/account/create/）注册一个帐户。完成后，如果他们在购物车中有产品，我需要将他们重定向回结帐屏幕。

我目前有一个监听器来监听`customer_register_success`事件。观察者通过以下代码将用户帐户升级为成员组：

```
class Hatclub_MembershipHandler_Model_Observer {

    // members group id
    const GROUP_ID = 4;

    // called when a customer registers for the site
    public function registrationSuccess(Varien_Event_Observer $observer) {

        // extract customer data from event
        $customer = $observer->getCustomer();

        // a cookie should have been set with the membership id
        if (isset($_COOKIE['membership_account_id'])) {

            $customer
                ->setGroupId(self::GROUP_ID)
                ->setRmsId($_COOKIE['membership_account_id']);

        }

        return $this;

    }

} 
```

还有其他我可以听的更适合我想做的活动吗？如果有帮助，我也有一个可用的 redirect_to cookie。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T05:47:14.373

经过多次试验和错误，我找到了一个解决方案。由于我已经在使用该`customer_register_success`事件并与我的观察者一起修改用户数据，因此我不得不使用另一个名为的事件`customer_save_after`，它就像一个魅力。

**config.xml 事件块**

```
<customer_save_after>
    <observers>
        <customer_session_observer>
            <class>hatclub_membership_handler/observer</class>
            <method>customerSave</method>
            <type>singleton</type>
        </customer_session_observer>
    </observers>
</customer_save_after> 
```

**观察者.php 方法**

```
public function customerSave() {

        // set redirect url from cookie, default to null
        $redirect_url = (isset($_COOKIE['redirect_url'])) 
            ? isset($_COOKIE['redirect_url']) : null;

        // if a redirect url was specified
        if (isset($redirect_url)) {

            // remove cookie to prevent infinite loop
            unset($_COOKIE['redirect_url']);

            // redirect to provided url
            Mage::app()->getResponse()
              ->setHeader('Location', $redirect_url)
              ->sendHeaders();

        }

} 
```

观察者内的重定向有点困难，但我设法使用它来完成它

```
Mage::app()->getResponse()
    ->setHeader('Location', $redirect_url)
    ->sendHeaders(); 
```

欢迎提出建议和批评。

# javascript - getJSON typeerror e 未定义

> ID：14351514
> 
> 赞同：1
> 
> 时间：2013-01-16T04:44:10.640
> 
> 标签：javascript, jquery, asp.net-mvc, jquery-ui

我在下面有这个 jQuery：

```
$.getJSON('../GetCities?', { term: inputString }, function (data) {            
  var anchorTagElements = '';
  console.log("line 39 ");
  $.each(data.items, function (i, item) {
    console.log("line 41 " );    
    anchorTagElements = anchorTagElements + '<a href=""><span class="searchheading">' +
      item.City + ', </span></a>';
  });
}); 
```

我可以看到数据正在使用 firebug 从服务器返回我可以看到第 39 行打印到日志中，但第 41 行并不意味着它在第 41 行 console.log 之前失败

我收到的错误消息是**TypeError: e is undefined**

![错误信息](../Images/0663e3bab0f23597f98c255d9cbb9256.png)

任何想法在哪里看？

**编辑**

使用 jQuery 非缩小我得到：

> TypeError: obj is undefined
> length = obj.length,

尝试获取要评估的长度时失败`i`。我不确定为什么我可以看到数据正确返回。

这是返回的数据：

![数据](../Images/ddd335482a8e11c6dac9c2e8cc0953b8.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T05:09:39.880

```
$.each(data, function (i, item) {  
            anchorTagElements = anchorTagElements + '<a href=""><span class="searchheading">' +
                item.City + ', </span></a>';
}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-16T04:52:37.323

尝试：

```
$(data.items).each(function (i, item) { 
```

另外，尝试打印`data`以查看它是否有效。

# c# - 如何动态构建 Linq 查询

> ID：14351516
> 
> 赞同：2
> 
> 时间：2013-01-16T04:44:30.140
> 
> 标签：c#, .net, linq

我看过一些旧帖子，但无法弄清楚如何实现这一点，请举个例子。

我正在对 DataTable 运行查询以对所有列进行分组。数字列只会被称为运行时，因此我需要动态构建查询。

```
var newGroup = from row in dataTable.AsEnumerable() 
group row by new { ID = row.Field<string>("column1"), group1 = row.Field<string>("column2") }; 
```

我需要为`n number of columns`.

请解释如何通过遍历列列表并构建 Lambda 表达式来构建 ParameterExpression。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T04:48:03.813

**简而言之：**有不同的方法可以实现这一目标。困难的方法是通过使用表达式来构建 Func 和 Predicates 的组合。更简单的方法是使用库 -`LINQ Dynamic Query Library`如下所述：

**解决方案#1：**这是一个很好的起点——[在 C# 运行时构建 LINQ 查询](http://tomasp.net/articles/dynamic-linq-queries.aspx)

**解决方案＃2：**您应该也可以通过使用来做到这一点`Linq Dynamic Query`，因为它为此目的而构建 -[动态 LINQ（第 1 部分：使用 LINQ 动态查询库）](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T06:26:55.213

我多次看到这个问题，所以我决定创建一个博客，而不是从 C# 操作数据。我通过使用动态 SQL 完成了 SQL 数据库级别的繁重工作。

[这是链接](http://vierx.blogspot.com/2013/01/connecting-c-application-using-linq-to.html)。希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-09T19:07:03.313

我有一种情况，我需要为查询的左侧和右侧动态生成 LINQ 查询。换句话说，Where("some property == some value")。我从 LINQPad 的人那里玩过 PredicateBuilder，并尝试了其他一些东西，但最终 LINQ 动态查询库 (System.Linq.Dynamic) 使这项任务变得非常简单。

在不详细介绍所有细节的情况下，我所拥有的是一种方法，它采用参数来过滤和排序 MVC 页面上 jqGrid 上的项目。一个名为 QueryOptions 的对象包含各种查询设置。Data.ImportDataSearchView 是绑定到后端数据库视图的实体框架实体。

过滤器表达式是通过调用建立的：

```
 options.FilterExpression += filterList.BuildFilterExpression<Data.ImportDataSearchView>(); 
```

BuildFilterExpression 的一部分如下：

```
 public string BuildFilterExpression<T>()
    {
        var type = typeof(T);
        var exp = string.Empty;

        foreach (Filter filter in this)
        {
            var typeName = filter.DataType.ToLower();

            // Skip if no values
            if (!filter.Values.Any())
                continue;

            switch (typeName)
            {
                case "string":
                    // html decode string and escape single quotes
                    var stringVal = System.Web.HttpUtility.HtmlDecode(filter.Values[0]);
                    stringVal = stringVal.Replace("'", "''");

                    if (filter.Operator == Enums.FilterOperator.CONTAINS)
                        exp += string.Format("{0}.Trim().ToLower().Contains(\"{1}\")", filter.Attribute, stringVal.Trim().ToLower());

                    else if (filter.Operator == Enums.FilterOperator.DOES_NOT_EQUAL)
                        exp += string.Format("!{0}.ToLower().Equals(\"{1}\")", filter.Attribute, stringVal.ToLower());

                    else if (filter.Operator == Enums.FilterOperator.DOES_NOT_CONTAIN)
                        exp += string.Format("!{0}.Trim().ToLower().Contains(\"{1}\")", filter.Attribute, stringVal.Trim().ToLower());

                    else if (filter.Operator == Enums.FilterOperator.ENDS_WITH)
                        exp += string.Format("{0}.Trim().ToLower().EndsWith(\"{1}\")", filter.Attribute, stringVal.Trim().ToLower());

                    else if (filter.Operator == Enums.FilterOperator.EQUALS)
                        exp += string.Format("{0}.ToLower().Equals(\"{1}\")", filter.Attribute, stringVal.ToLower());

                    else if (filter.Operator == Enums.FilterOperator.STARTS_WITH)
                        exp += string.Format("{0}.Trim().ToLower().StartsWith(\"{1}\")", filter.Attribute, stringVal.Trim().ToLower());

                    break;

                //case "select": -- for dropdowns
                //case "datetime": -- for dates, etc. etc.

            // add spaces around expression
            exp = string.Format(" {0} ", exp);

            // add and/or to expression
            if (this.IndexOf(filter) != this.Count() - 1)
                exp += string.Format(" {0} ", ExpressionType.ToLower() == "and" ? "&&" : "||");
        }

        return exp;
    } 
```

然后在构建表达式字符串后，按如下方式检索数据：

```
 options.OrderBy = string.IsNullOrEmpty(sortIndex) ? "TrackingId asc" : string.Format(" {0} {1} ", sortIndex, sortOrder);

        var db = new Data.BmpDB();
        var list = string.IsNullOrEmpty(options.FilterExpression)
            ? db.ImportDataSearchViews.OrderBy(options.OrderBy).ToList()
            : db.ImportDataSearchViews.Where(options.FilterExpression).OrderBy(options.OrderBy).ToList(); 
```

下面的 options.FilterExpression 字符串是三个搜索条件字段的示例，这些字段由 BuildFilterExpression 方法拼凑成一个漂亮、简单的 LINQ where 子句谓词字符串：

"BmpName.Trim().ToLower().Contains(\"crops\") && DataProviderId.ToLower().Equals(\"123\") && StatusId == 1"

# php - 存储与每个用户相关的大量数据？

> ID：14351517
> 
> 赞同：0
> 
> 时间：2013-01-16T04:44:33.057
> 
> 标签：php, mysql

我正在设计一个学习语言的抽认卡网站，现在我有一个用户登录信息表和一个词汇表。

我有一个区域可以测试你对动词/形容词/等共轭的知识，所以我需要检查多个阅读，我可以这样做，但我需要保存这些数据，所以一旦你学会了某些单词，我就可以拥有它等级，你解锁更多。

不幸的是，我对 MySQL 的了解有限，所以我不确定如何在不创建天文数量的条目的情况下做到这一点。

基本上对于每个项目（词汇），我需要保存 1 到 4 个读数的正确/错误百分比，以及下一次审查到期的日期，这适用于每个用户，适用于每个项目。

我并不是要求任何人为我完成我所有的工作，但如果有人可以向我指出一些关于如何存储如此大量数据（相当有效）的信息，那就太好了。

实际上，它不一定是企业效率，因为它只是我和一些使用它的朋友（可能像 100 个用户顶部？）但它也不会太可怕：/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T04:56:45.000

由于这更像是一个讨论问题，我会尽力而为！

MySQL 可能是存储大量数据的最佳选择。Facebook 使用 MySQL，你只能想象他们对每个人的数据量！

MySQL 的好处：1、最适合初学者 2、PHP 的“goto”数据库语言 3、大规模开源

最重要的是要记住数据库的结构。您可以处理大量信息，但请记住，设置数据类型可以并且将会限制特定列的空间量。

您可能会研究的其他一些资源：

[MySQL TEXT/BLOB 列](http://dev.mysql.com/doc/refman/5.0/en//blob.html)

[PostgreSQL](http://www.postgresql.org/)

# codeigniter - Codeigniter、REST_Controller 和 Backbone.js 不说话

> ID：14351523
> 
> 赞同：1
> 
> 时间：2013-01-16T04:45:17.067
> 
> 标签：codeigniter, backbone.js, codeigniter-2, codeigniter-restserver

使用[Phil Sturgeon 的](https://github.com/philsturgeon/codeigniter-restserver)REST_Controller

Backbone.js 集合：

```
define([
    'jquery',
    'underscore',
    'backbone',
    'models/project/ProjectModel2'
], function($, _, Backbone, ProjectModel2){
    var ProjectsCollection2 = Backbone.Collection.extend({

        initialize: function() {
            this.on('all', function(e) { console.log("ProjectCollectiona: " + e); });
        },
        model: ProjectModel2,
        url: "http://subdomain.domain.com/index.php/test/index"

    });

    return ProjectsCollection2;
}); 
```

Codeigniter 控制器：

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');
require(APPPATH'.libraries/REST_Controller.php');  
class Test extends REST_Controller {

    public function index_get()
    {
        $this->response(array('success' => 'get'), 200);
    }

    public function index_post()
    {
        $this->response(array('success' => 'post'), 200);  
    }
} 
```

通过 Chrome Inspector 输出的标头：

```
Request URL:http://subdomain.domain.com/index.php/test/index
Request Method:GET
Status Code:500 Internal Server Error
Request Headersview source
Accept:application/json, text/javascript, */*; q=0.01
Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3
Accept-Encoding:gzip,deflate,sdch
Accept-Language:en-US,en;q=0.8
Connection:keep-alive
Content-Type:application/x-www-form-urlencoded
Cookie:__utma=218955780.1934049331.1355591749.1355591749.1355591749.1; __utmc=218955780; __utmz=218955780.1355591749.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); ci_session=a%3A5%3A%7Bs%3A10%3A%22session_id%22%3Bs%3A32%3A%22698c724d973d37b869d90ca059b326c5%22%3Bs%3A10%3A%22user_agent%22%3Bs%3A119%3A%22Mozilla%2F5.0+%28Macintosh%3B+Intel+Mac+OS+X+10_7_5%29+AppleWebKit%2F537.17+%28KHTML%2C+like+Gecko%29+Chrome%2F24.0.1312.52+Safari%2F537.17%22%3Bs%3A13%3A%22last_activity%22%3Bi%3A1358311296%3Bs%3A9%3A%22user_data%22%3Bs%3A0%3A%22%22%3B%7D164f4b5137bde1a0f31c3db5cc6723bf
Host:subdomain.domain.com
Referer:http://subdomain.domain.com/
User-Agent:Using Chrome on Mac
X-Requested-With:XMLHttpRequest
Response Headersview source
Connection:close
Content-Encoding:gzip
Content-Length:20
Content-Type:text/html
Date:Wed, 16 Jan 2013 04:41:36 GMT
Server:Apache
Vary:Accept-Encoding 
```

两个问题：

第一个很明显，在为 Codeigniter 控制器定义 URL 时得到 500。我是否错误地定义了 URL？

第二个令人困惑，我试图从库中自动加载 REST_Controller.php，当我运行上面的代码时，我得到一个空白浏览器，Chrome 检查器中也没有任何内容。

非常感谢任何指导。

# iphone - 使用 RestKit 发布导致发布 nil 对象

> ID：14351531
> 
> 赞同：4
> 
> 时间：2013-01-16T04:45:56.640
> 
> 标签：iphone, ios, ipad, core-data, restkit

我在使用 RestKit 0.20pre6 发布 NSManagedObject 时遇到问题，这会导致在我的 Rails 站点上创建一个具有 nil 值的条目。我怀疑映射器，但据我所知，我已经正确设置了我的 RK 对象。例子很少，支持也很有限。该示例处理 NSObjects 而不是 CoreData，因此我不得不做出一些假设。

这是我的发布代码，后面是控制台输出。该应用程序可以很好地从服务器获取对象。

```
 // Sync the added object to the server
    // ****************************************

    RKObjecMapping *responseMapping = [RKObjectMapping mappingForClass:[Event class]];
//  RKEntityMapping *responseMapping = [RKEntityMapping mappingForEntityForName:@"Event" inManagedObjectStore:self.managedObjectStore];
    [responseMapping addAttributeMappingsFromDictionary:@{
     @"id": @"eventId",
     @"name": @"name",
     @"amount": @"amount",
     @"length": @"length",
     @"updated_at": @"updatedAt",
     @"created_at": @"createdAt",
     @"latitude": @"latitude",
     @"longitude": @"longitude",
     @"thumbnail": @"thumbnail",
     @"airTemp": @"airTemp",
     }];

    NSIndexSet *statusCodes = RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful); // Anything in 2xx
    RKResponseDescriptor *eventDescriptor = [RKResponseDescriptor responseDescriptorWithMapping:responseMapping
                                                                                    pathPattern:@"/events"
                                                                                        keyPath:@"events"
                                                                                    statusCodes:statusCodes
                                                                                                ];

    RKObjectMapping *requestMapping = [RKObjectMapping requestMapping]; // objectClass == NSMutableDictionary

    [requestMapping addAttributeMappingsFromDictionary:@{
     @"id": @"eventId",
     @"name": @"name",
     @"amount": @"amount",
     @"length": @"length",
     @"updated_at": @"updatedAt",
     @"created_at": @"createdAt",
     @"latitude": @"latitude",
     @"longitude": @"longitude",
     @"thumbnail": @"thumbnail",
     @"airTemp": @"airTemp",
     }];

    // For any object of class Article, serialize into an NSMutableDictionary using the given mapping and nest
    // under the 'article' key path
    RKRequestDescriptor *requestDescriptor = [RKRequestDescriptor requestDescriptorWithMapping:requestMapping
                                                                                   objectClass:[Event class]
                                                                                   rootKeyPath:@"events"
                                                                                                ];

    LocationsAppDelegate *appDelegate = (LocationsAppDelegate *)[[UIApplication sharedApplication] delegate];
//  RKObjectManager *manager = [RKObjectManager managerWithBaseURL:gBaseURL];

    [RKObjectManager sharedManager].requestSerializationMIMEType = RKMIMETypeJSON;
    [[RKObjectManager sharedManager] addRequestDescriptor:requestDescriptor];
    [[RKObjectManager sharedManager] addResponseDescriptor:eventDescriptor];

    NSLog(@"RVC-addEvent %@ - %@", appDelegate.user.login, appDelegate.user.password);
    [[NBEventManager sharedManager] setUsername:appDelegate.user.login andPassword:appDelegate.user.password];
    appDelegate.objectManager.HTTPClient = [NBEventManager sharedManager];

    event = [eventsArray objectAtIndex:0];
    [[RKObjectManager sharedManager] postObject:event
                                           path:@"/events"
                                     parameters:nil
                                        success:nil
                                        failure:nil
                                                ];

} 
```

> 2013-01-15 23:25:52.857 鱼[38803:13403] 我 restkit.network:RKHTTPRequestOperation.m:152 POST 'http://localhost:3000/events' 2013-01-15 23:25:52.969 鱼[ 38803:16903] 我 restkit.network:RKHTTPRequestOperation.m:179 POST 'http://localhost:3000/events' (201 Created) [0.1121 s] 2013-01-15 23:25:52.971 fish[38803:17507] D restkit.object_mapping:RKMapperOperation.m:360 为表示执行映射操作：{ event = { airTemp = ""; 金额 = ""; "created_at" = "2013-01-16T04:25:52Z"; ID = 54; 纬度 = ""; 长度 = ""; 经度 = ""; 名称 = ""; 缩略图 = ""; "updated_at" = "2013-01-16T04:25:52Z"; “用户ID”=“”；}; } 和目标对象：（实体：事件；id：0x9c7f710；数据：{ airTemp = 0；数量 = nil；createdAt =“2013-01-16 04:25:52 +0000”；eventId = 0；纬度 =“28.158466” ；长度 = 0；经度 =“-82.509215”；名称 = 无；照片 = 无；缩略图 = 无；更新时间 = 无；}) 2013-01-15 23:25:52.971 鱼[38803:17507] D restkit.object_mapping :RKMapperOperation.m:287 在 keyPath 'event' 找到可映射的数据：{ airTemp = ""; 金额 = ""; "created_at" = "2013-01-16T04:25:52Z"; ID = 54; 纬度 = ""; 长度 = ""; 经度 = ""; 名称 = ""; 缩略图 = ""; "updated_at" = "2013-01-16T04:25:52Z"; “用户ID”=“”；} 2013-01-15 23:25:52.971 fish[38803:17507] D restkit.object_mapping:RKMapperOperation.m:232 要求映射源对象 { airTemp = ""; 金额 = ""; "created_at" = "2013-01-16T04:25:52Z"; ID = 54; 纬度 = ""; 长度 = ""; 经度 = ""; 名称 = ""; 缩略图 = ""; "updated_at" = "2013-01-16T04:25:52Z"; “用户ID”=“”；} 使用映射 eventId>"、"name>"、"amount>"、"length>"、"updatedAt>"、"createdAt>"、"latitude>"、“经度>”、“airTemp>”、“缩略图>”)> 2013-01-15 23:25:52.971 fish[38803:17507] D restkit.object_mapping:RKMappingOperation.m:754 开始映射操作... 2013- 01-15 23:25:52.972 fish[38803:17507] D restkit.object_mapping:RKMappingOperation.m:818 成功完成映射操作... 2013-01-15 23:25:52.973 fish[38803:17507] D restkit. object_mapping:RKMapperOperation.m:316 在 keyPath 找到不可映射的值：事件 2013-01-15 23:25:52.973 fish[38803:17507] D restkit.object_mapping:RKMapperOperation.m:389 完成执行对象映射。结果：{ event = " (entity: Event; id: 0x9c7f710 ; data: {\n airTemp = nil;\n amount = nil;\n createdAt = \"2013-01-16 04:25:52 +0000\" ;\n eventId = 54;\n 纬度 = nil; 13403] D restkit.core_data:RKManagedObjectRequestOperation.m:534 跳过删除孤立对象：仅针对 GET 请求执行。2013-01-15 23:25:52.976 fish[38803:11f03] D restkit.core_data:RKManagedObjectRequestOperation.m:599 刷新映射的目标对象（实体：事件；ID：0x9c7f710；数据：{ airTemp = nil；数量 = nil； createdAt = "2013-01-16 04:25:52 +0000"; eventId = 54; latitude = nil; length = nil; longitude = nil; name = nil; photo = nil; thumbnail = nil; updatedAt = "2013- 01-16 04:25:52 +0000"; }) 在上下文中 13403] D restkit.core_data:RKManagedObjectRequestOperation.m:534 跳过删除孤立对象：仅针对 GET 请求执行。2013-01-15 23:25:52.976 fish[38803:11f03] D restkit.core_data:RKManagedObjectRequestOperation.m:599 刷新映射的目标对象（实体：事件；ID：0x9c7f710；数据：{ airTemp = nil；数量 = nil； createdAt = "2013-01-16 04:25:52 +0000"; eventId = 54; latitude = nil; length = nil; longitude = nil; name = nil; photo = nil; thumbnail = nil; updatedAt = "2013- 01-16 04:25:52 +0000"; }) 在上下文中

这是我的代码，因为我已将所有映射移至应用程序委托并实现了 RKEntityMapping。我仍然没有收到附加到 POST 调用的 JSON 对象。

```
 RKEntityMapping *eventMapping = [RKEntityMapping mappingForEntityForName:@"Event" inManagedObjectStore:managedObjectStore];
[eventMapping addAttributeMappingsFromDictionary:@{
 @"id": @"eventId",
 @"name": @"name",
 @"amount": @"amount",
 @"length": @"length",
 @"updated_at": @"updatedAt",
 @"created_at": @"createdAt",
 @"latitude": @"latitude",
 @"longitude": @"longitude",
 @"thumbnail": @"thumbnail",
 @"airTemp": @"airTemp",
 }];
eventMapping.identificationAttributes = @[ @"eventId" ];

//RKRelationshipMapping *eventRelationship = [RKRelationshipMapping relationshipMappingFromKeyPath:@"events"
//                                                                                     toKeyPath:@"events"
//                                                                                   withMapping:eventMapping];
//[eventMapping addPropertyMapping:eventRelationship];

// Register our mappings with the provider
RKResponseDescriptor *responseDescriptor = [RKResponseDescriptor responseDescriptorWithMapping:eventMapping
                                                                                   pathPattern:nil
                                                                                       keyPath:@"event"
                                                                                   statusCodes:RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful)];
[objectManager addResponseDescriptor:responseDescriptor];

RKEntityMapping *eventRequestMapping = [eventMapping inverseMapping];
RKRequestDescriptor *eventRequestDescriptor = [RKRequestDescriptor requestDescriptorWithMapping:eventRequestMapping
                                                                                    objectClass:[Event class]
                                                                                    rootKeyPath:@"event"
                                                                                                ];
[objectManager addRequestDescriptor:eventRequestDescriptor];
[RKObjectManager sharedManager].requestSerializationMIMEType = RKMIMETypeJSON; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T17:23:45.910

RESTKit 0.20pre6 中有一个错误，它将 HTTP 正文打印到 NSLog，POST 请求为（null），即使它是一个对象。我在开发分支中修复了它。 [https://github.com/RestKit/RestKit/pull/1139](https://github.com/RestKit/RestKit/pull/1139)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-20T16:06:03.100

对于`NSManagedObject`映射，您应该使用`RKManagedObjectMapping`或`RKEntityMapping`，这取决于您使用的 RestKit 版本，而不是`RKObjectMapping`. 如果您使用的是最后一个，那么它应该是`RKEntityMapping`.

`NSObject`和的指定初始化`NSManagedObject`器不相同，从而导致空值。

您可以在他们的 wiki 站点上阅读有关对象映射的更多信息：[RestKit 对象映射](https://github.com/RestKit/RestKit/wiki/Object-Mapping)，尤其是核心数据部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T16:44:22.013

在更好地了解 managedObjectContexts 以及 RestKit 如何特别利用其中两个之后，我能够进入正确的上下文。有两个用 createContexts 创建一个 mainQueue 和一个 persistentStore 上下文。同样不是我需要在数据模型中选择我的事件实体并将类从 NSManagedObject 更改为 Event，然后 RestKit 将实体识别为类 Event 的实体。

# php - 计算每个选中的复选框

> ID：14351532
> 
> 赞同：0
> 
> 时间：2013-01-16T04:46:00.057
> 
> 标签：php

我创建了一个表单来从主要类别中选择类别项目。在这里，我使用复选框来选择类别项目。在我的表格中，有许多主要类别并有自己的子类别。示例课程及其主题。

使用此表格，我需要检查为一个类别选择了多少子项目。而且我还需要查看在所有主要类别中至少选择了一个子类别，如果可以的话，我希望限制最多 10 个子类别可供选择。

我试过这样的东西..但在这里它计算所有选定的子类别。

```
if ( isset ( $_POST['sub-category']) && is_array( $_POST['sub-category'])) {    
    $totalCategory = count( $_POST['sub-category']);

    if ( $totalCategory >= 1 && $totalCategory <= 10 ) {

        $_SESSION['sub-category'] = $_POST['sub-category'];                 
        $url = BASE_URI . 'register.php'; // Define the URL:        
                header("Location: $url");
                exit(); // Quit the script.         

    } else {        
        echo 'ERROR: Please select atleast 1, not more than 10.';           
    }           
} else {                
    echo 'ERROR: Please select atleast one category.';  
} 
```

**更新：**

这是我用来生成的 PHP

```
echo "<input type='checkbox' value='{catId:subID}' name='subject{$lastCatId}[]' />{$lastCatName}"; 
```

他们的 HTML 生成类似这样的东西..

```
<h3>Main Category 01 
    <input type='checkbox' value='3:4' name='subject3[]' />sub category
    <input type='checkbox' value='3:6' name='subject3[]' />sub category

<h3>Main Category 02 
    <input type='checkbox' value='4:6' name='subject4[]' />sub category
    <input type='checkbox' value='4:2' name='subject4[]' />sub category

<h3>Main Category 01 
    <input type='checkbox' value='5:8' name='subject5[]' />sub category
    <input type='checkbox' value='5:4' name='subject5[]' />sub category 
```

问题是我如何分别获取子类别的值，然后需要计算......

我希望有人帮助我...谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T04:56:16.793

将您的 html 代码更改为

```
<h3>Main Category 01 
    <input type='checkbox' value='' name='sub_cat1[]' />sub category
    <input type='checkbox' value='' name='sub_cat1[]' />sub category
    <input type='checkbox' value='' name='sub_cat1[]' />sub category
    <input type='checkbox' value='' name='sub_cat1[]' />sub category

<h3>Main Category 02 
    <input type='checkbox' value='' name='sub_cat2[]' />sub category
    <input type='checkbox' value='' name='sub_cat2[]' />sub category
    <input type='checkbox' value='' name='sub_cat2[]' />sub category
    <input type='checkbox' value='' name='sub_cat2[]' />sub category

<h3>Main Category 01 
    <input type='checkbox' value='' name='sub_cat3[]' />sub category
    <input type='checkbox' value='' name='sub_cat3[]' />sub category
    <input type='checkbox' value='' name='sub_cat3[]' />sub category
    <input type='checkbox' value='' name='sub_cat3[]' />sub category 
```

并提交表格，它会给你输出

```
$count_cat1 = count($_POST['sub_cat1']);
$count_cat2 = count($_POST['sub_cat2']);
$count_cat3 = count($_POST['sub_cat3']); 
```

您可以将其放入循环中以减少代码长度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T04:54:20.270

命名复选框时，请使用以下格式：

```
<input type="checkbox" name="subject[math][algebra]">
<input type="checkbox" name="subject[math][calculus]"> 
```

在 PHP 中：

```
<?php
    $subjects = $_POST['subject'];
    $math = $subjects['math'];
    $algebra = $math['algebra'];
... 
```

这就是基本思想。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T04:55:50.150

尝试这个：

```
<h3>Main Category 01 
<input type='checkbox' value='sub_cat_1' name='main_cat_1_subject[]' />sub category1
<input type='checkbox' value='sub_cat_2' name='main_cat_1_subject[]' />sub category2
<input type='checkbox' value='sub_cat_3' name='main_cat_1_subject[]' />sub category3
<input type='checkbox' value='sub_cat_4' name='main_cat_1_subject[]' />sub category4

<h3>Main Category 02 
<input type='checkbox' value='sub_cat_1' name='main_cat_2_subject[]' />sub category1
<input type='checkbox' value='sub_cat_2' name='main_cat_2_subject[]' />sub category2
<input type='checkbox' value='sub_cat_3' name='main_cat_2_subject[]' />sub category3
<input type='checkbox' value='sub_cat_4' name='main_cat_2_subject[]' />sub category4

<h3>Main Category 01 
<input type='checkbox' value='sub_cat_1' name='main_cat_3_subject[]' />sub category1
<input type='checkbox' value='sub_cat_2' name='main_cat_3_subject[]' />sub category2
<input type='checkbox' value='sub_cat_3' name='main_cat_3_subject[]' />sub category3
<input type='checkbox' value='sub_cat_4' name='main_cat_3_subject[]' />sub category4 
```

和PHP：

```
if(isset($_POST['main_cat_1_subject']) && !empty($_POST['main_cat_1_subject'])){
    $main_cat_subjects = $_POST['main_cat_1_subject'];
    //do the stuff.
    foreach($main_cat_subjects as $index => $main_cat_subject){
        //Sub category items by index here.
    }
} else {
    echo 'Please select atleast on subject for Main Category 1';
    //redirect or die
} 
```

对所有类别重复此循环并更改`$_POST`数组中的名称。

# javascript - javascript中的超卡界面构建器？

> ID：14351533
> 
> 赞同：0
> 
> 时间：2013-01-16T04:46:07.620
> 
> 标签：javascript, interface-builder, wysiwyg

我一直在玩“可编辑混搭”的方法——有点受到前端 HyperCard 和后端 Yahoo Pipes 的启发。

有一些很好的“管道”数据流工具——deri 管道是最完整的。

我想知道是否有任何界面构建器或 js 库完全在浏览器窗口中运行——HyperCard 让人们简单地进入“编辑模式”，然后拖放界面元素（按钮、字段、小部件）在页面上；将这些元素链接到代码；并最终得到一个功能齐全的网页？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T06:08:08.933

我确实希望看到（或建立）这样的项目。但我认为应该以正确的方式来做，重点放在用户体验上。我认为编写自定义编辑器在控制用户界面方面的好处超过了所涉及的工作成本。借助现代 JS 库，DHTML 变得更加容易。

互联网需要 HyperCard——激发人们创造事物。（就像客户端 js 一样，任何人都可以打开 HyperCard 堆栈并查看源代码）。我在粗略的克隆上取得了不错的进展。不过，我还不知道如何为移动设备或 ipad 设计这个，这些地方的需求可能更大。

# ruby-on-rails-3 - 应用程序控制器中的轨道活动记录对象

> ID：14351538
> 
> 赞同：0
> 
> 时间：2013-01-16T04:46:24.467
> 
> 标签：ruby-on-rails-3, activerecord

我正在添加一个站点范围的表单，用于在 Rails 站点上提问。**资源问题**的模型/视图/控制器已经创建。Going to question/new 会按照您的预期显示表单。现在我想显示一个站点范围的问题表单（与这个唯一的区别是它只显示必填字段）。问题：我应该在 application_controller 中创建一个新的问题对象并将其传递给 rails **form_for**助手，还是应该创建一个新的**_form2**部分（在问题视图中）并将其包含在我的站点范围模板中？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T04:48:46.863

在文件夹中创建一个`question_form`部分`views/shared`，并从站点范围的模板中引用它。

编辑：回复从哪里获取@question 变量

你有两个选择，你可以在 ApplicationController 中加载变量：

```
class ApplicationController < ActionController::Base

  before_filter :load_question

  def load_question
    @question = Question.new
  end

  ...

end 
```

（在这种情况下，您应该小心与 @question 变量的冲突）

或者可能更好，您可以在 ApplicationHelper 中创建一个方法：

```
module ApplicationHelper

  def question_form

    question = Question.new

    raw render 'shared/question_form', :question => question
  end

  ...
end 
```

然后在您看来，不是引用部分，而是引用助手：

```
<%= question_form %> 
```

在这种情况下，您需要将局部变量中的变量引用为局部变量，`question`而不是`@question`.

希望有帮助。

# java - 使用 Eclipse 创建可执行 jar

> ID：14351549
> 
> 赞同：2
> 
> 时间：2013-01-16T04:47:46.777
> 
> 标签：java, eclipse, jar, executable

它可以很好地导出为 Jar，但是当我双击该项目时，它不会加载。

我正在构建一个 Java Slick2d 游戏（我的第一个）。我在 Windows 7 和 Ubuntu 12.10 上都试过了。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T05:07:22.973

如果您从终端运行导出的 jar 文件，您将看到一个`Unsatisfied Link Error`. 要解决此问题，您需要包含 LWJGL 本机。如果您想要一个独立的 jar 中的所有内容，最简单的方法是使用[JarSplice](http://ninjacave.com/jarsplice)。

让我们逐步介绍如何执行此操作。

1.  打开 JarSplice

    ![打开屏幕](../Images/f8ebce3c16ddec5aafbebb5d07f096fc.png)

2.  添加从 Eclipse 导出的 jar。

    ![添加导出的jar](../Images/2d502e1ec6444a57a43dc8272848cfd6.png)

3.  添加 LWJGL 本地人。这些可以从 下载`http://www.lwjgl.org/download.php`。我将为 Linux 导出，所以我将包含 Linux 本机文件。本机文件应位于名为`native`.

    ![添加本地人](../Images/9d7f5f647250d22b78b9c4aaa5cfe2df.png)

4.  现在指定项目中的主类。不要忘记包含类的包。

    ![指定主类](../Images/ecc010f88c225fe74249cdbea9d6721f.png)

5.  点击`Create Fat Jar`，你就完成了！您还可以导出到 Linux `.sh`、Mac`.app`或 Windows `.exe`。只要确保你包括适当的本地人。

    ![创建胖罐](../Images/073b12fb6e96a69dc2a9160b1fb22234.png)

6.  与他人分享您的游戏，玩得开心！

    ![游戏！](../Images/2fff67ab10b120a268ef260d0a36a5ff.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T05:09:23.037

在jar文件中找到文件“MANIFEST”，并添加行：“Main-Class：{您的可执行类名称（带有main方法的类）}”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T04:50:39.773

> 确保你提到主类：在 META-INF

**详细说明**

下面列出了为独立 SWT 文件创建可执行 JAR 文件的详细说明。

1.  在您的系统上为所需的运行时目标创建一个运行时文件夹（例如，c:\swt\runtime-linux）。请注意，目标平台不需要与您的开发平台相同。

2.  为所需的目标平台找到正确的 SWT JAR 文件。您可以从 SWT 网站下载所需的 ZIP 文件。例如，对于 Eclipse 3.3 和 Linux 的目标平台，下载文件 swt-3.3.1.1-gtk-linux-x86.zip。展开此 ZIP 文件并将 swt.jar 文件复制到运行时文件夹。请记住，此 swt.jar 文件特定于一个平台，在本例中为 Linux。

    3\. 使用 Eclipse 文本编辑器为您的应用程序创建一个清单文件（例如，myapplication-manifest.txt）。清单的文本应如下所示：

    清单版本：1.0

    类路径：swt.jar

    主类：mypackage.MyClassWithMainMethod

    （文件末尾的空白行）

4.确保清单文件以空行结尾。输入包含 Main-Class 的 main() 方法的包和类的名称。在 Eclipse 中，选择 File/Export/Java/Jar 文件并按 Next。

1.  在 JAR File Specification 对话框中，选择应用程序中所需类的源文件。在导出目标中，浏览到运行时文件夹并输入所需的 JAR 文件名称（例如，myapplication.jar 或 myapplication_linux.jar）。按下一步。

2.  在 JAR Packaging Options 对话框中，确保选中“Export class files with compile warnings”框。否则，如果您的源文件有任何编译警告，它们将不会包含在 JAR 文件中。按下一步。

3.  在 JAR 导出对话框中，选择“使用工作区中的现有清单”选项。浏览到您在上面创建的清单文件。按完成。

4.  如果 JAR 文件已经存在，系统会要求您覆盖它。选择是。如果您的项目有任何编译警告，将显示一条消息。如果是这样，请按 OK。此时，您的应用程序的 JAR 文件已在运行时目录中创建。如果需要（即您的目标平台与您的开发平台不同），请将运行时目录复制到目标平台上的目录中。

5.  在操作系统的文件资源管理器中，浏览到运行时目录并运行 JAR 文件。例如，在 Windows 中，您可以在 Windows 文件资源管理器中双击它，或者在“cmd”提示符下输入命令：java -jar myapplication.jar。应用程序应该运行。

# java - 在 unix 中使用 Cobertura 生成代码覆盖率报告

> ID：14351550
> 
> 赞同：0
> 
> 时间：2013-01-16T04:47:51.010
> 
> 标签：java, cobertura

我正在使用 cobertura-1.9.4.1 生成代码覆盖率报告。首先，我将类路径设置为 cobertura.jar 和 lib 文件夹中的其他 jar。然后我执行 cobertura-instrument.sh。但是在执行时，我得到了关于 0 classes 的错误加载信息。我给出了编译类的完整路径，但它仍然无法检测这些类。那么，我错过了什么或可能的原因是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T05:18:11.223

您的意思是错误是在检测期间，还是在运行测试后，覆盖率仍然显示为零？

这是一个检测示例（使用 Ant）：

```
<target name="--coverage.instrument">
    <delete file="cobertura.ser"/>
    <mkdir dir="${coverage.instrumented.dir}"/>
    <cobertura-instrument todir="${coverage.instrumented.dir}">
        <fileset dir="${classes.main.dir}">
            <include name="**/*.class"/>
            <exclude name="**/*Test.class"/>
        </fileset>
    </cobertura-instrument>
</target> 
```

***不要忘记在测试时需要这个 sysproperty（例如在 Ant Junit 任务中）：***

```
<sysproperty key="net.sourceforge.cobertura.datafile" file="cobertura.ser"/> 
```

一旦设置了 Cobertura，就会发生检测，执行示例：

```
<target name="--test.unit">
    <mkdir dir="${temp.dir}/unit-tests"/>

    <junit forkmode="perBatch" printsummary="yes" haltonfailure="no" haltonerror="no"
           failureproperty="unit.tests.failed">

        <sysproperty key="net.sourceforge.cobertura.datafile" file="cobertura.ser"/>
        <classpath refid="classpath.test.utest"/>
        <formatter type="xml"/>

        <batchtest fork="yes" todir="${temp.dir}/unit-tests">
            <fileset dir="${java.src.utest.dir}" includes="**/*Test.java"/>
        </batchtest>
    </junit>

</target> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T13:09:38.553

我相信最近版本的 Cobertura 不能很好地与 JDK5 配合使用。强烈建议升级JDK。

# asp.net - 任何人都可以在正则表达式中帮助我只允许数字和数字范围应该从 0.1 到 9999.99 吗？

> ID：14351552
> 
> 赞同：-2
> 
> 时间：2013-01-16T04:47:51.600
> 
> 标签：asp.net

任何人都可以在正则表达式中帮助我只允许数字和数字范围应该从 0.1 到 9999.99 吗？只允许使用 2 位小数。

我用这个表达试过了

```
^([1-9]\d{,3}(\.\d{1,2})?)?|(0\.([1-9]\d?)|(0\.0[1-9]))$ 
```

但不工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T12:35:02.973

我认为这个正则表达式应该可以满足您的需求。请注意，最外层组中的第一项明确定义最小值，第二项定义最大值。

**正则表达式**

```
^(?:(?:0{1,4}\.1\d?)|(?:\d{0,3}[1-9](?:\.[1-9]\d?)?))$ 
```

**测试**

```
9999.99 -> success
2324 -> success
3241 -> success
0 -> failure
0.1 -> success
0.04 -> failure
9999.10 -> success
0.12 -> success 
```

# ios - 如何为除 iPad 屏幕上的一个视图之外的所有其他视图创建触摸事件？

> ID：14351556
> 
> 赞同：1
> 
> 时间：2013-01-16T04:48:21.340
> 
> 标签：ios, cocoa-touch, uiview

在我的 iPad 应用程序中，屏幕上显示了多个视图。我希望为除一个视图之外的所有其他显示视图创建一个触地事件？我该怎么做？（我可以逐个创建触摸事件，但我认为这不是一个好主意）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T09:06:41.710

这很简单……

只是写触摸开始像....

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch *touch=[[event allTouches] anyObject];
    if([touch view]!=< your view that you dont want to touch >)
    {
       // <# Your Code #>
    }
} 
```

# java - 设置从 JTextField 检索到的文本的字体

> ID：14351563
> 
> 赞同：3
> 
> 时间：2013-01-16T04:49:15.047
> 
> 标签：java, swing, fonts, jlabel, jtextfield

我让用户通过 JTextField 输入一些单词。我想设置字符串的字体。这是我到目前为止所拥有的。

```
Font f;
f = new Font(input.getText(), Font.ITALIC, 32);
word = new JLabel(f, SwingConstants.CENTER); 
```

不幸的是，Java 给我一个编译器错误，因为 JLabel 不接受 Font 作为参数。是否可以设置从文本字段中检索的字符串的字体并将其显示在 JFrame 上？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T04:54:04.453

见[`JComponent.setFont(Font)`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JComponent.html#setFont%28java.awt.Font%29)。

> 设置此组件的字体。

* * *

但比设置字体名称的文本字段更好，请参阅（样式）组合的[此答案](https://stackoverflow.com/a/8365030/418556)[或](https://stackoverflow.com/questions/6965038/getting-fonts-sizes-bold-etc/6965149#6965149)使用列表的此答案：

![](../Images/49ea3b806a041e122016e395ad6bf0d9.png) ![](../Images/03783e3b304d85575780e28388d092cf.png)

# android - 从 ActionBar 选项卡获取当前片段

> ID：14351573
> 
> 赞同：5
> 
> 时间：2013-01-16T04:50:09.567
> 
> 标签：android, android-fragments, android-actionbar

我有两个片段（Fragment1 和 Fragment2），使用自定义 TabListener 类创建了 ActionBar 导航。每个选项卡的内容都是我的片段之一。但现在我有一个问题 - 我无法访问/获取片段的实例。

```
public void onCreate( Bundle savedInstanceState )
    {   
        super.onCreate( savedInstanceState );
        getSupportActionBar().setNavigationMode( getSupportActionBar().NAVIGATION_MODE_TABS );

        Tab tab = getSupportActionBar().newTab()
            .setText( R.string.frag1 )
            .setTabListener( 
                new MyTabListener( this, 
                    Fragment1.class.getName() ) );
        getSupportActionBar().addTab( tab );

        tab = getSupportActionBar().newTab()
            .setText( R.string.frag2 )
            .setTabListener( 
                new MyTabListener( this, 
                    Fragment2.class.getName() ) );
        getSupportActionBar().addTab( tab );

        Fragment1 f1 = (Fragment1) getSupportFragmentManager().findFragmentByTag("FRAG1");
        if(f1 != null) {
            Toast.makeText(this, "It's not empty", Toast.LENGTH_SHORT).show();
        }
    }

    @Override
    public void onActivityResult(int requestCode, int resultCode, Intent data) {
        Toast.makeText(this, "Photo Intent Goes Here", Toast.LENGTH_SHORT).show();

        if(data != null) {
            Toast.makeText(this, "It's not empty", Toast.LENGTH_SHORT).show();

             if (resultCode == RESULT_OK) {  

                }  

        } else {
            Toast.makeText(this, "It's empty", Toast.LENGTH_SHORT).show();
        }
    }

    private class MyTabListener  implements TabListener
    {
        private SherlockFragment mFragment;
        private final Activity mActivity;
        private final String mFragName;

        public MyTabListener( Activity activity, 
            String fragName )
        {
            mActivity = activity;
            mFragName = fragName;
        }

        @Override
        public void onTabSelected(Tab tab,
                android.support.v4.app.FragmentTransaction ft) {
            mFragment = (SherlockFragment) SherlockFragment.instantiate( mActivity, 
                    mFragName );

            if( mFragment instanceof Fragment1 ) {
                Fragment1 f1temp = (Fragment1) mFragment;

                //Toast.makeText(mActivity, "Frag1", Toast.LENGTH_SHORT).show();

                  ft.add( android.R.id.content, mFragment,"FRAG1");
            }

            else {
                  ft.add( android.R.id.content, mFragment,"ELSE");
            }

            //Toast.makeText(mActivity, mFragName, Toast.LENGTH_SHORT).show();
        }

        @Override
        public void onTabUnselected(Tab tab,
                android.support.v4.app.FragmentTransaction ft) {
            ft.remove( mFragment );
            mFragment = null;

        }

        public SherlockFragment getCurrentFragment() {
            return mFragment;
        }

        @Override
        public void onTabReselected(Tab tab,
                android.support.v4.app.FragmentTransaction ft) {
            // TODO Auto-generated method stub

        }

    } 
```

我不能使用 `getSupportFragmentManager().findFragmentById( id )`，因为我也没有 id 我也尝试过`getSupportFragmentManager().findFragmentByTag( tag )`，但它也不起作用，因为我只调用`add()`方法`FragmentTransaction`类而不是`replace()`

有什么方法可以获取当前选项卡片段实例，以便我可以调用片段的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T16:52:13.837

我找到了解决方案。我试图在`onActivityResult()`方法中获取片段实例，并且确实有效。

```
 public void onActivityResult(int requestCode, int resultCode, Intent data) {

Toast.makeText(this, "Photo Intent Goes Here", Toast.LENGTH_SHORT).show();

        if(data != null) {
            Toast.makeText(this, "It's not empty", Toast.LENGTH_SHORT).show();

             if (resultCode == RESULT_OK) {  
                   Fragment1 f1 = (Fragment1) getSupportFragmentManager().findFragmentByTag("FRAG1");
                  f1.onCameraResult(requestCode,resultCode,data); // Your method   of the fragment

                }  

        } else {
            Toast.makeText(this, "It's empty", Toast.LENGTH_SHORT).show();
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-26T12:24:50.130

我从`FragmentPagerAdapter`实例中获取片段：

```
FragmentPagerAdapter adapter = (FragmentPagerAdapter) viewPager.getAdapter();
Fragment fragment = adapter.getItem(tabLayout.getSelectedTabPosition()); 
```

# c# - 用于 MailChimp 的 C# 中的 JSON 多维数组/字典

> ID：14351575
> 
> 赞同：1
> 
> 时间：2013-01-16T04:50:16.937
> 
> 标签：c#, json, mailchimp

我有一个工作代码，可以[将订阅者的电子邮件发送到 C# 中的 MailChimp](http://apidocs.mailchimp.com/api/1.3/listsubscribe.func.php)。

我只需要将 FirstName 添加到其中。从[文档](http://apidocs.mailchimp.com/api/1.3/listsubscribe.func.php)来看，`merge_vars`似乎是一个多维 JSON 数组。你如何在 C# 中做到这一点？

这是代码

```
using (var streamWriter = new StreamWriter(httpWebRequest.GetRequestStream()))
{
  Dictionary<string,string> data = new Dictionary<string,string>();
  data.Add("apikey", ApiKey);
  data.Add("id", ListId);
  data.Add("email_address", email);
  //data.Add("merge_vars[FNAME]", firstname); // <-- This is what I tried adding but doesn't work

  string json = new JavaScriptSerializer().Serialize(data);

  streamWriter.Write(json);
  streamWriter.Flush();
  streamWriter.Close();

  var httpResponse = (HttpWebResponse)httpWebRequest.GetResponse();
  using (var streamReader = new StreamReader(httpResponse.GetResponseStream()))
  {
    var response = streamReader.ReadToEnd();
    //...
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T04:54:50.307

你有没有尝试过：

```
data.Add("merge_vars", new Dictionary<string, string> { {"FNAME", firstname} }); 
```

# asp.net - 将数据集分配为下拉列表的数据源时出现 NullReferenceException

> ID：14351579
> 
> 赞同：0
> 
> 时间：2013-01-16T04:50:49.190
> 
> 标签：asp.net, vb.net

我想分配位于 gridview 控件内的下拉列表的数据源。但是当我执行以下代码时，我得到了 NullReferenceException。

```
Protected Sub grvStudent_DataBound(ByVal sender As Object, ByVal e As GridViewRowEventArgs)
    If e.Row.RowType = DataControlRowType.DataRow Then
        Try
            Dim Connection As SqlConnection = New SqlConnection(ConnectionString)
            Dim Query As String = "select Course from Courses"
            Dim Command As SqlCommand
            Command = New SqlCommand(Query, Connection)
            Dim Da As New SqlDataAdapter(Command)
            Dim Ds As New DataSet()
            Connection.Close()
            Dim ddlCourse = DirectCast(e.Row.FindControl("ddlCourse"), DropDownList)
            Da.Fill(Ds)
            ddlCourse.DataSource = Ds    //Exception is here
            ddlCourse.DataTextField = "Course"
            ddlCourse.DataValueField = "Id"
            ddlCourse.DataBind()
        Catch ex As Exception
            MsgBox(ex.ToString)
        End Try
    End If
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T05:22:54.943

您在填充数据集之前关闭连接，并且您还没有打开连接，因此首先打开连接然后填充数据集，然后您可以关闭连接。

```
Protected Sub grvStudent_DataBound(ByVal sender As Object, ByVal e As GridViewRowEventArgs)
If e.Row.RowType = DataControlRowType.DataRow Then
    Try
        Dim Connection As SqlConnection = New SqlConnection(ConnectionString)
        Dim Query As String = "select Course from Courses"
        Dim Command As SqlCommand
        Command = New SqlCommand(Query, Connection)
        Dim Da As New SqlDataAdapter(Command)
        Dim Ds As New DataSet()
        Connection.Open()
        Dim ddlCourse = DirectCast(e.Row.FindControl("ddlCourse"), DropDownList)
        Da.Fill(Ds)
        ddlCourse.DataSource = Ds    //Exception is here
        ddlCourse.DataTextField = "Course"
        ddlCourse.DataValueField = "Id"
        ddlCourse.DataBind()

    Catch ex As Exception
        MsgBox(ex.ToString)
    Finally
        Connection.Close()
    End Try

End If
End Sub 
```

编辑：添加这一行并运行

```
 If (ds.Tables.Count > 0) Then

    //your binding code....

  Else

     MsgBox(ex.ToString)

  End If 
```

以供参考

[关联](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.basedataboundcontrol.datasource.aspx?cs-save-lang=1&cs-lang=vb#code-snippet-3)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-13T22:46:36.187

确保您的下拉列表位于 HTML 代码网格的 ItemTemplate 部分，您可能仅在编辑部分中有它..

```
 <asp:TemplateField HeaderText="Course">
            <EditItemTemplate>
                     <asp:DropDownList ID="ddlCourse" runat="server">
                    </asp:DropDownList>
            </EditItemTemplate>
            <ItemTemplate>
                 <asp:DropDownList ID="ddlCourse" runat="server">
                    </asp:DropDownList>
                <asp:Label ID="lblCourse" runat="server"  />
            </ItemTemplate>
     </asp:TemplateField> 
```

# java - 如何从 Hibernate 调用 MySQL 存储过程

> ID：14351589
> 
> 赞同：0
> 
> 时间：2013-01-16T04:51:43.943
> 
> 标签：java, mysql, database, hibernate, stored-procedures

我正在尝试从使用 MySQL 的 Java 应用程序调用 MySQL 存储过程。下面是 DAO 中我用来调用存储过程“insertComm”的部分

```
String opt="REFUND";
        Query query = this.getSession().createSQLQuery("CALL insertComm (:remitNo,     :opt)")
           .setParameter("remitNo", remitNo)
               .setParameter("opt", opt);
opt=query.toString();
hemappLogger.info(opt); 
```

但是当我查询数据库并检查时，存储过程尚未执行。'opt' 值显示为 SQLQueryImpl(CALL insertComm (:remitNo, :opt))

参数没问题，应用程序也没有显示错误。我看不到我错过了什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-11-04T09:22:27.873

考虑到您有一个输出基本类型的简单存储过程：

```
CREATE PROCEDURE count_comments (
   IN postId INT, 
   OUT commentCount INT
) 
BEGIN
    SELECT COUNT(*) INTO commentCount 
    FROM post_comment  
    WHERE post_comment.post_id = postId; 
END 
```

您可以使用 JPA 调用此存储过程`StoredProcedureQuery`：

```
StoredProcedureQuery query = entityManager
    .createStoredProcedureQuery("count_comments")
    .registerStoredProcedureParameter(
        "postId", Long.class, ParameterMode.IN)
    .registerStoredProcedureParameter(
        "commentCount", Long.class, ParameterMode.OUT)
    .setParameter("postId", 1L);

query.execute();

Long commentCount = (Long) query
    .getOutputParameterValue("commentCount"); 
```

如果您的存储过程返回 a`REFCURSOR`或`TABLE`结果：

```
CREATE PROCEDURE post_comments(IN postId INT) 
BEGIN
    SELECT *  
    FROM post_comment   
    WHERE post_id = postId;  
END 
```

您需要按如下方式调用存储过程：

```
StoredProcedureQuery query = entityManager
    .createStoredProcedureQuery("post_comments");
query.registerStoredProcedureParameter(1, Long.class, ParameterMode.IN);

query.setParameter(1, 1L);

List<Object[]> postComments = query.getResultList(); 
```

对于数据库函数，返回结果集而不是将其放入`OUT`变量中：

```
CREATE FUNCTION fn_count_comments(postId integer)
RETURNS integer
DETERMINISTIC 
READS SQL DATA 
BEGIN
    DECLARE commentCount integer; 
    SELECT COUNT(*) INTO commentCount 
    FROM post_comment  
    WHERE post_comment.post_id = postId; 
    RETURN commentCount; 
END 
```

Hibernate 4.x 和 5.x API 对您没有帮助，您必须改用 JDBC：

```
int commentCount = session.doReturningWork(connection -> {
    try (CallableStatement function = connection.prepareCall(
            "{ ? = call fn_count_comments(?) }")) {
        function.registerOutParameter(1, Types.INTEGER);
        function.setInt(2, 1);
        function.execute();
        return function.getInt(1);
    }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T05:16:11.603

不幸的是，您不能使用`Session.createSQLQuery()`. 顾名思义，它允许创建 SQL **Query**。过程调用不是查询。

但不要害怕，解决方法是这样的。

```
Connection conn = getSession().connection();
CallableStatment stat = conn.prepareCall("{CALL insertComm (?,?)}");
stat.setString(1, remitNo); // Assuming both parameters are String
stat.setString(2, opt);

stat.executeUpdate();
stat.close(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T05:06:04.843

您没有将实体添加到会话对象中... .addEntity(classname.class).setParameter()

# javascript - 有没有根据 div 宽度自动设置字母间距？

> ID：14351591
> 
> 赞同：0
> 
> 时间：2013-01-16T04:51:59.643
> 
> 标签：javascript, css

我有一个流体宽度的网站，我计划在其中放置一些文本`<div>`。这个想法是

```
<div>FIRST LINE TEXT HERE</div>
<div>THE SECOND LINE TEXT HERE. BUT QUITE LENGTHY</div>
<div>THIRD LINE IS HERE. NOT THAT MUCH LENGTH<div> 
```

我需要通过根据内部内容和可用宽度动态添加字母间距来显示所有三行看起来像一个合理的字母`<div>`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T09:39:02.697

您可以在 JavaScript 中计算文本的宽度，然后计算所需的字母间距，并添加它。请注意，这会将单词空间视为任何其他字符，因此添加的间距越大，单词之间的距离就越近。结果在其他方面也会有印刷问题：如果字母间距太大，单词看起来不太好。

如果只需要一点间距，通常最好添加*字*间距，您可以在某些浏览器（不是 Chrome）上使用`text-align-last: justify`. 您可以考虑使用 Additional `text-justify: newspaper`，因为它可能会在字母之间添加部分间距，而不仅仅是在单词之间。见[jsfiddle](http://jsfiddle.net/yucca42/6UWgv/1/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T05:06:51.250

我建议你试试这个..给这些线三个不同的类，即 first_line、second_line 和类似的 third_line

然后为类编写css。对于 first_line，您将字母间距保持在您想要的范围内。同样，您也可以为其他两行指定字母间距。

# mysql - 在mysql中创建表错误。1071 错误

> ID：14351592
> 
> 赞同：-1
> 
> 时间：2013-01-16T04:52:00.393
> 
> 标签：mysql

大家好，有人可以帮助我，在mysql中创建表时我收到以下错误

MySQL 错误 1071：指定的键太长；最大密钥长度为 767 字节

我的表定义如下。

```
CREATE TABLE oauth_consumer (id char(36)  NOT NULL ,
  name varchar(255)  NULL ,
  date_entered datetime  NULL ,
  date_modified datetime  NULL ,
  modified_user_id char(36)  NULL ,
  created_by char(36)  NULL ,
  description text  NULL ,
  deleted bool  DEFAULT '0' NULL ,
  assigned_user_id char(36)  NULL ,
  c_key varchar(255)  NULL ,
  c_secret varchar(255)  NULL, 
  PRIMARY KEY (id),
  UNIQUE ckey (c_key)
); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T05:00:03.940

您的查询没有问题。可能是您正在运行旧版本的 MySql。使用新版本。如果您使用的是新版本，请尝试使用以下查询来创建表

```
CREATE TABLE `oauth_consumer` (
    `id` CHAR(36) NOT NULL,
    `name` VARCHAR(255) NULL DEFAULT NULL,
    `date_entered` DATETIME NULL DEFAULT NULL,
    `date_modified` DATETIME NULL DEFAULT NULL,
    `modified_user_id` CHAR(36) NULL DEFAULT NULL,
    `created_by` CHAR(36) NULL DEFAULT NULL,
    `description` TEXT NULL,
    `deleted` TINYINT(1) NULL DEFAULT '0',
    `assigned_user_id` CHAR(36) NULL DEFAULT NULL,
    `c_key` VARCHAR(255) NULL DEFAULT NULL,
    `c_secret` VARCHAR(255) NULL DEFAULT NULL,
    PRIMARY KEY (`id`),
    UNIQUE INDEX `ckey` (`c_key`)
)
COLLATE='latin1_swedish_ci'
ENGINE=InnoDB; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T07:24:02.413

首先，您的数据库字符集很可能设置为 utf8，因此您的 255 个字符被炸毁为 765 个字符；虽然很接近，但并不大于 767 的强制限制，但它可以让您了解为什么您仍然会达到该限制。

无论如何，不​​建议使用这么宽的键；您可以计算该值的 md5 或 sha1 并将其用作唯一键（顺便说一句，您应该使用哈希的二进制表示）。

# java - JTable table.getSelectedRows() 问题

> ID：14351593
> 
> 赞同：1
> 
> 时间：2013-01-16T04:52:04.917
> 
> 标签：java, swing, jtable, selection, listselectionlistener

我创建了一个`JTable`具有定制模型和特征的模型。我有一个很长的书面课程，可以正确执行设置和渲染。我看到该`.getSelectedRows()`方法不起作用，并且永远不会评估为值。我试图获取选择的第一行和最后一行的索引。这是我的代码。

```
public void actionPerformed(ActionEvent event) {

    String command = event.getActionCommand();

    rows = table.getSelectedRows();

    firstRow = rows[0];

    int rowCount = rows.length;

    lastRow = rows[(rowCount - 1)];

    if (command.equals("Run Threw")) {

    }else if (command.equals("Shield Bash")) {
        this.attack(firstRow, lastRow, command);
    }

        public boolean block (int defendersRow) {
}

public boolean fumble (int attackersRow) {   
}

public boolean dodge (int defendersRow) {
}

public boolean critical (int attackersRow, int attackRoll) {
}

public void attack(int firstRow, int lastRow, String command) {
    command = this.command;
    firstRow = this.firstRow;
    lastRow = this.lastRow;

    if (command == "Bludgeon" || command == "React" || command == "ShieldBash") {
        attackersRow = this.lastRow;
        defendersRow = this.firstRow;
    }else if(command == "Attack" || command == "Skill") {
        attackersRow = this.firstRow;
        defendersRow = this.lastRow;
    }else {

    }
    table.setValueAt(true, attackersRow, 16);
    fumbled = this.fumble(attackersRow);
    if (fumbled == true) {
        outputString = "fumbled";
    }
    Object maxDamageObject = table.getValueAt(attackersRow, 10);
    int maxDamage = (Integer) maxDamageObject;
    attackRoll = generator.nextInt(100) + 1;
    this.critical(attackersRow, attackRoll);
    if (criticaled == true) {
        outputString = "criticaled";
    }
    dodged = this.dodge(defendersRow);
    if (dodged == true) {
        outputString = "dodged";
    }
    blocked = this.block(defendersRow);
    if (blocked == true) {
        outputString = "blocked";
    }
    int defenseRoll = generator.nextInt(100) + 1;
    Object attackBaseObject = table.getValueAt(attackersRow, 6);
    Object defenseBaseObject = table.getValueAt(defendersRow, 11);
    int attackBase = (Integer) attackBaseObject;
    int defenseBase = (Integer) defenseBaseObject;
    int attack = attackRoll + attackBase;
    int defense = defenseRoll + defenseBase;
    Object minDamageObject = table.getValueAt(attackersRow, 9);
    int minDamage = (Integer) minDamageObject;
    damage = generator.nextInt((maxDamage - minDamage))+minDamage;

    if (criticaled == true) {
        damage = maxDamage * 2;
    }else if (attack >= (defense + 50)) {
        damage = damage * 2;
    }else if (attack >= defense) {
        damage = damage;
    }else {
        damage = 0;
    }

    this.outputSelection(outputString, attackersRow, defendersRow, command, damage);
    this.damage(defendersRow, damage);
}

private void damage(int defendersRow, int damage) {
}

private void outputSelection(String outputString, int attackersRow, int defendersRow, String command, int damage) {

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T05:47:28.820

我没有看到代码有问题。也许您可以交叉检查以下几点：

1.  你能选择单行/多行吗？或者检查 jTableObject.getRowSelectionAllowed() 返回什么
2.  **仅在**选择行后才调用您的代码。您的代码应在选择某些行后执行，以便它可以返回您的预期值。
3.  调用上述代码的监听器是否添加到表中。

小点但最好交叉检查:)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T06:58:24.440

如这个工作[示例](https://stackoverflow.com/a/12306104/230513)所示，您可以将 a 添加`ListSelectionListener`到您的表格中`ListSelectionModel`，看看是否有任何结果。它可能有助于确定出问题的地方：例如，`table`遮蔽预期引用的本地引用。

# c++ - 通过引用传递空 QString

> ID：14351601
> 
> 赞同：2
> 
> 时间：2013-01-16T04:53:12.890
> 
> 标签：c++, qt

我有一个具有此签名的方法

```
void SetFoo(QString& foo); 
```

我正在尝试内联传递一个空字符串，但以下都没有编译

```
SetFoo("");
SetFoo(QString("")); 
```

> （错误：没有匹配的函数调用 'MyClass::SetFoo(QString)'）

但是如果我创建一个这样的变量，它就可以工作。

```
QString emptyFoo = "";
SetFoo(emptyFoo); 
```

有没有办法在不显式创建变量的情况下调用该方法？

注意：使用 vc++ 编译器在 windows 环境中似乎一切正常，但我在使用 g++ 的 linux 环境中遇到上述编译错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T04:57:00.733

您可以创建一个全局对象作为 a`const QString nullStr()`并在任何地方使用它 - 有点类似于[Null Object Pattern](http://en.wikipedia.org/wiki/Null_Object_pattern)。

或者，正如 billz 提到的那样，`const`可以存在对临时的引用，因此使其`const Qstring&` [启用前 2 个版本](http://liveworkspace.org/code/3RSRwM%241)

`const Qstring&`无论如何，如果您不打算修改它，您应该更改引用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T04:55:58.403

要将引用绑定到临时对象，您需要`const`限定符，如果 QString 构造函数接受`char*`输入，请尝试：

```
void SetFoo(const QString& foo); 
```

仅将对过期变量的引用传递给 SetFoo 是有意义的：

```
void SetFoo(QString& foo);
QString s;
SetFoo(s); 
```

. 注意：使用 vc++ 编译器在 windows 环境中似乎一切正常，但我在使用 g++ 的 linux 环境中遇到上述编译错误。

VisualStudio 因其 C++ 扩展而闻名（无论好坏），您的代码在 VS 上编译并不意味着它是 C++ 标准。更好的方法是在编写代码时打开编译警告（级别 4），它应该给你一个绑定临时对象引用的警告。
还要查找 C++ 标准，查找编译器手册以确保您的代码是可移植的。

# php - PHP LDAP 获取用户属性，包括关联的组

> ID：14351602
> 
> 赞同：10
> 
> 时间：2013-01-16T04:53:16.683
> 
> 标签：php, active-directory, ldap

在当前用户上运行搜索以检索所有属性（包括使用 LDAP/PHP 的 Active Directory 中的关联组）的最佳方法是什么？

对于属性，主要是名字、姓氏和显示名。

对于关联组，只有用户所属的组，例如 memberOf 函数。

我尝试了一些选项，但似乎无法获得正确的过滤器/搜索组合，并且大多数示例都涵盖了检索存在已知组的用户列表。

我尝试在成功绑定后运行它：

```
$attributes = array("displayname");
$filter = "(&(sAMAccountName=$username))";
$result = ldap_search($ds, $ldapconfig['basedn'], $filter, $attributes);
$entries = ldap_get_entries($ds, $result);
if($entries["count"] > 0){
  echo "displayName: ".$entries[0]['displayname'][0]."<br/>";
 } else {
 echo("msg:'".ldap_error($ds)."'</br>");
 } 
```

返回以下错误：“没有这样的对象”。

**更新：**

这是我尝试过的最新块，并且当我 print_r $info 变量时能够得到结果，但是 for 子句仍然在某个地方出错。我将 basedn 更改为仅 dc 属性：

```
$filter="($SearchField=$SearchFor)";
$sr=ldap_search($ds, $basedn, $filter, $LDAPFieldsToFind);
$info = ldap_get_entries($ds, $sr);

if($info["count"] > 0) {
    for ($x=0; $x<$info["count"]; $x++) {
        $sam=$info[$x]['samaccountname'][0];
        $giv=$info[$x]['givenname'][0];
        $tel=$info[$x]['telephonenumber'][0];
        $email=$info[$x]['mail'][0];
        $nam=$info[$x]['cn'][0];
        $dir=$info[$x]['homedirectory'][0];
        $dir=strtolower($dir);
        $pos=strpos($dir,"home");
        $pos=$pos+5;
            if (stristr($sam, $SearchFor) && (strlen($dir) > 8)) {
              print "\nActive Directory says that:\n";
              print "CN is: ".$nam." \n";
              print "SAMAccountName is: ".$sam." \n";
              print "Given Name is: ".$giv." \n";
              print "Telephone is: ".$tel." \n";
              print "Home Directory is: ".$dir." \n";
            }   
    }
    } 
```

结果的 print_r 是：

```
( [count] => 1 [0] => Array ( [cn] => Array ( [count] => 1 [0] => George ) [0] => cn [givenname] => Array ( [count] => 1 [0] => George ) [1] => givenname [memberof] => Array ( [count] => 4 [0] => CN=EQCStaff,CN=Users,DC=EQC,DC=local [1] => CN=RDS Users,OU=Security Groups,OU=Service,DC=EQC,DC=local [2] => CN=SFTP Client Folders,OU=Security Groups,OU=Service,DC=EQC,DC=local [3] => CN=EQC Staff,OU=Security Groups,OU=Service,DC=EQC,DC=local ) [2] => memberof [samaccountname] => Array ( [count] => 1 [0] => gortiz ) [3] => samaccountname [mail] => Array ( [count] => 1 [0] => user@domain.com ) [4] => mail [count] => 5 [dn] => CN=George,OU=Users,OU=Accounts,DC=EQC,DC=local ) ) 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-16T17:34:59.120

这是我们用于转储广告信息的脚本，也许它会对您有所帮助：

```
<?php
$ldap_columns = NULL;
$ldap_connection = NULL;
$ldap_password = 'top_secret_password';
$ldap_username = 'top_secret_username@'.LDAP_DOMAIN;

//------------------------------------------------------------------------------
// Connect to the LDAP server.
//------------------------------------------------------------------------------
$ldap_connection = ldap_connect(LDAP_HOSTNAME);
if (FALSE === $ldap_connection){
    die("<p>Failed to connect to the LDAP server: ". LDAP_HOSTNAME ."</p>");
}

ldap_set_option($ldap_connection, LDAP_OPT_PROTOCOL_VERSION, 3) or die('Unable to set LDAP protocol version');
ldap_set_option($ldap_connection, LDAP_OPT_REFERRALS, 0); // We need this for doing an LDAP search.

if (TRUE !== ldap_bind($ldap_connection, $ldap_username, $ldap_password)){
    die('<p>Failed to bind to LDAP server.</p>');
}

//------------------------------------------------------------------------------
// Get a list of all Active Directory users.
//------------------------------------------------------------------------------
$ldap_base_dn = 'DC=xyz,DC=local';
$search_filter = "(&(objectCategory=person))";
$result = ldap_search($ldap_connection, $ldap_base_dn, $search_filter);
if (FALSE !== $result){
    $entries = ldap_get_entries($ldap_connection, $result);
    if ($entries['count'] > 0){
        $odd = 0;
        foreach ($entries[0] AS $key => $value){
            if (0 === $odd%2){
                $ldap_columns[] = $key;
            }
            $odd++;
        }
        echo '<table class="data">';
        echo '<tr>';
        $header_count = 0;
        foreach ($ldap_columns AS $col_name){
            if (0 === $header_count++){
                echo '<th class="ul">';
            }else if (count($ldap_columns) === $header_count){
                echo '<th class="ur">';
            }else{
                echo '<th class="u">';
            }
            echo $col_name .'</th>';
        }
        echo '</tr>';
        for ($i = 0; $i < $entries['count']; $i++){
            echo '<tr>';
            $td_count = 0;
            foreach ($ldap_columns AS $col_name){
                if (0 === $td_count++){
                    echo '<td class="l">';
                }else{
                    echo '<td>';
                }
                if (isset($entries[$i][$col_name])){
                    $output = NULL;
                    if ('lastlogon' === $col_name || 'lastlogontimestamp' === $col_name){
                        $output = date('D M d, Y @ H:i:s', ($entries[$i][$col_name][0] / 10000000) - 11676009600); // See note below
                    }else{
                        $output = $entries[$i][$col_name][0];
                    }
                    echo $output .'</td>';
                }
            }
            echo '</tr>';
        }
        echo '</table>';
    }
}
ldap_unbind($ldap_connection); // Clean up after ourselves.
?> 
```

用户[inventor96](https://stackoverflow.com/users/3404349/inventor96)建议使用11644473600 而不是11676009600。我可以确认11644473600 在Linux 环境中是正确的——我猜inventor96 是在Windows 环境中。

# excel - 当日期采用多种不同格式时，从 Microsoft Excel 文件中提取日期

> ID：14351604
> 
> 赞同：1
> 
> 时间：2013-01-16T04:54:00.923
> 
> 标签：excel

我得到了一个 excel 文件，其中一列中有大约 17000 行的日期。这里的问题是日期不可靠并且单元格具有不同的格式。有些是纯文本格式，有些是“通用”格式，还有一些是几种可用日期格式之一。在一种情况下，我什至在格式为 mm/dd/yyyy 的单元格中找到了一个日期，但日期显示为 20/05/1989。

日期唯一一致的是，对于人类读者来说，它们实际上是日期第一和月份第二，无论单元格的格式是什么。另一件事是日期分隔符的使用不一致，有些日期有连字符，有些有斜线，还有一些使用点作为分隔符。

我打算在带有日期的列旁边添加另一列，并将此列格式化为纯文本。现在，如果我使用公式 =TEXT() 那么这当然会给我序列（excel）日期。

有没有办法将这些日期作为文本获取，必要时使用 VBA？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T05:06:28.443

如果我理解正确，您希望获得 Excel 工作表中显示的文本版本。简单的方法是将工作表（或只是另一个工作表中的列）保存为格式化文本（空格分隔）（*.prn）文件。当您重新打开文件时，它将被视为可导入的文本文件。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-16T05:01:09.470

请尝试这个公式和建议。

```
=DAY(A1)&"-"&MONTH(A1)&"-"&YEAR(A1) 
```

问候湿婆

# javascript - 如何确定文本区域 html 上的 unicode（utf8/utf16/non-latin 或 latin）输入及其使用 javascript 的验证

> ID：14351605
> 
> 赞同：1
> 
> 时间：2013-01-16T04:54:01.583
> 
> 标签：javascript, html

我需要知道如何在 html 的文本区域类型上确定 unicode 输入 Utf8/Utf16（非拉丁语）或拉丁语，并使用 javascript 对其进行验证。我用谷歌搜索但找不到我要找的东西。

# r - 着色一点并在ggplot2中添加注释？

> ID：14351608
> 
> 赞同：21
> 
> 时间：2013-01-16T04:54:11.620
> 
> 标签：r, dataframe, ggplot2

我有一个`a`包含三列的数据框：

`GeneName`, `Index1`,`Index2`

我画了一个这样的散点图

```
ggplot(a, aes(log10(Index1+1), Index2)) +geom_point(alpha=1/5) 
```

然后我想为一个点着色，并在该`GeneName`点`"G1"`附近添加一个文本框，最简单的方法是什么？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-01-16T05:02:15.453

您可以创建一个仅包含该点的子集，然后将其添加到图中：

```
# create the subset
g1 <- subset(a, GeneName == "G1")

# plot the data
ggplot(a, aes(log10(Index1+1), Index2)) + geom_point(alpha=1/5) +  # this is the base plot
  geom_point(data=g1, colour="red") +  # this adds a red point
  geom_text(data=g1, label="G1", vjust=1) # this adds a label for the red point 
```

注意：由于每个人都在对这个问题进行投票，我想我会让它更容易阅读。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-01-16T05:16:59.927

像这样的东西应该工作。您可能需要弄乱`x`和的`y`参数`geom_text()`。

```
library(ggplot2)

highlight.gene <- "G1"

set.seed(23456)
a <- data.frame(GeneName = paste("G", 1:10, sep = ""),
                   Index1 = runif(10, 100, 200),
                   Index2 = runif(10, 100, 150))

a$highlight <- ifelse(a$GeneName == highlight.gene, "highlight", "normal")
textdf <- a[a$GeneName == highlight.gene, ]
mycolours <- c("highlight" = "red", "normal" = "grey50")

a
textdf

ggplot(data = a, aes(x = Index1, y = Index2)) +
    geom_point(size = 3, aes(colour = highlight)) +
    scale_color_manual("Status", values = mycolours) +
    geom_text(data = textdf, aes(x = Index1 * 1.05, y = Index2, label = "my label")) +
    theme(legend.position = "none") +
    theme() 
```

![截屏](../Images/d663c62b681ee0fc6c930503ea1c47df.png)

# android - 将值插入 Google 日历

> ID：14351609
> 
> 赞同：0
> 
> 时间：2013-01-16T04:54:13.633
> 
> 标签：android, google-calendar-api

运行此代码时出现错误...这是我的代码：

```
alendar cal = Calendar.getInstance();     
    Uri EVENTS_URI = Uri.parse(getCalendarUriBase(this) + "events");
    ContentResolver cr = getContentResolver();

    // event insert
    ContentValues values = new ContentValues();
    values.put("calendar_id", 1);
    values.put("title", edSubject.getText().toString());
    values.put("allDay", 0);
    values.put("dtstart", dateStart.toString()); // event starts at 11 minutes from now
    values.put("dtend", cal.getTimeInMillis()+60*60*1000); // ends 60 minutes from now
    values.put("description", "Reminder description");
    values.put("visibility", 0);
    values.put("hasAlarm", 1);
    Uri event = cr.insert(EVENTS_URI, values);

    // reminder insert
    /*Uri REMINDERS_URI = Uri.parse(getCalendarUriBase(this) + "reminders");
    values = new ContentValues();
    values.put( "event_id", Long.parseLong(event.getLastPathSegment()));
    values.put( "method", 1 );
    values.put( "minutes", 10 );
    cr.insert( REMINDERS_URI, values );*/ 
```

* * *

```
 private String getCalendarUriBase(ActivityAppointment act) {

        String calendarUriBase = null;
        Uri calendars = Uri.parse("content://calendar/calendars");
        Cursor managedCursor = null;
        try {
            managedCursor = act.managedQuery(calendars, null, null, null, null);
        } catch (Exception e) {
        }
        if (managedCursor != null) {
            calendarUriBase = "content://calendar/";
        } else {
            calendars = Uri.parse("content://com.android.calendar/calendars");
            try {
                managedCursor = act.managedQuery(calendars, null, null, null, null);
            } catch (Exception e) {
            }
            if (managedCursor != null) {
                calendarUriBase = "content://com.android.calendar/";
            }
        }
        return calendarUriBase;
    } 
```

日志猫：

```
01-16 15:34:27.620: E/AndroidRuntime(3114): FATAL EXCEPTION: main
01-16 15:34:27.620: E/AndroidRuntime(3114): java.lang.NullPointerException
01-16 15:34:27.620: E/AndroidRuntime(3114):     at android.os.Parcel.readException(Parcel.java:1327)
01-16 15:34:27.620: E/AndroidRuntime(3114):     at android.database.DatabaseUtils.readExceptionFromParcel(DatabaseUtils.java:182)
01-16 15:34:27.620: E/AndroidRuntime(3114):     at android.database.DatabaseUtils.readExceptionFromParcel(DatabaseUtils.java:136)
01-16 15:34:27.620: E/AndroidRuntime(3114):     at android.content.ContentProviderProxy.insert(ContentProviderNative.java:447)
01-16 15:34:27.620: E/AndroidRuntime(3114):     at android.content.ContentResolver.insert(ContentResolver.java:721)
01-16 15:34:27.620: E/AndroidRuntime(3114):     at com.sree.weekdayview.calendar.activities.ActivityAppointment.SaveData(ActivityAppointment.java:348)
01-16 15:34:27.620: E/AndroidRuntime(3114):     at com.sree.weekdayview.calendar.activities.ActivityAppointment$3.onClick(ActivityAppointment.java:117)
01-16 15:34:27.620: E/AndroidRuntime(3114):     at android.view.View.performClick(View.java:3122) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T05:16:23.787

而不是使用 managedQuery 尝试内容解析器查询方法。它与 managedQuery 相同，只需将其替换为查询，如下所示..

```
ContentResolver cr = getContentResolver();
    Cursor cursor = cr.query(intent.getData(), null, null, null, null); 
```

# xml - Oracle XML 森林

> ID：14351615
> 
> 赞同：0
> 
> 时间：2013-01-16T04:54:45.073
> 
> 标签：xml, oracle

我使用 XML 森林创建了一个 XML，我面临的问题是当值为空时它不会创建空标签。这个问题有出路吗？

问候，卡蒂克。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T07:50:37.517

你必须使用 xmlelement 是你想用一个空白选项卡表示一个 NULL 。

例如

```
SQL> select xmlelement("test", xmlagg(xmlelement("foo", a)))
  2  from (select 'a' a from dual union all select null from dual);

XMLELEMENT("TEST",XMLAGG(XMLELEMENT("FOO",A)))
--------------------------------------------------------------------------------
<test><foo>a</foo><foo></foo></test> 
```

对比

```
SQL> select xmlelement("test", xmlagg(xmlforest(a as "foo")))
  2  from (select 'a' a from dual union all select null from dual);

XMLELEMENT("TEST",XMLAGG(XMLFOREST(AAS"FOO")))
--------------------------------------------------------------------------------
<test><foo>a</foo></test> 
```

# javascript - 这会触发 ASI（自动分号插入）吗？

> ID：14351616
> 
> 赞同：0
> 
> 时间：2013-01-16T04:54:45.510
> 
> 标签：javascript

这会触发 ASI（自动分号插入）吗？

```
if (abc === def) {

    doSomething();
} // <-- here
else {  

    doDifferently();
}

try {

    doSomething();
} // <-- here
catch(e) {

    doCatch();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T04:55:45.107

不。自动分号插入仅发生在语句之间，而您的示例并非如此。

一个`if - else`语句是一个**单一的语句**。在那里插入分号绝对没有意义。分号插入“功能”就是要理解一系列**不**以分号分隔的单独语句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T04:55:54.433

不 - 您可以根据自己的喜好构建大括号。

# php - 使用“AND”表达式构建动态 SQL 而不混淆嵌套条件？

> ID：14351617
> 
> 赞同：3
> 
> 时间：2013-01-16T04:54:46.550
> 
> 标签：php, sql, if-statement, dynamic-sql

我对 php 和一般编码相当陌生。

我有一系列条件需要测试它们是否已设置。它们是 $option1、$option2、$option3

```
if (isset($option1)){
    if (isset($option2)){
        if (isset($option3)){
            $query = "SELECT *
                               FROM Group
                               WHERE FirstOption = '$option1' AND SecondOption = '$option2' AND ThirdOption = '$option3'";
        }
        else {
            $query = "SELECT *
                               FROM Group
                               WHERE FirstOption = '$option1' AND SecondOption = '$option2";
        }
    }
    else {
        $query = "SELECT *
                           FROM Group
                           WHERE FirstOption = '$option1' AND ThirdOption = '$option3";
    }
}
else {
    // .. snip, much more duplicated code ..
} 
```

所以这里的问题是我需要根据条件是否设置来对 mysql 进行唯一查询。但它们彼此之间有很多，我实际上有 7 种选择，所以分支绝对是巨大的！在几乎让自己感到困惑之后，我在三点停了下来。

必须有一种更优越的方式来写这个 - 任何人都可以帮助我更好地理解吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T05:09:09.973

无需动态 sql 构建。只需使用逻辑。

```
SELECT *
  FROM Group
 WHERE (FirstOption = '$option1' or '$option1' = '') 
   AND (SecondOption = '$option2' or '$option2' = '')
   AND (ThirdOption = '$option3' or '$option3' = '') 
```

理想情况下，您会使用占位符和准备好的语句，但以上内容对于教学目的来说是最清楚的。

万一有人好奇 - 这没有显着的查询开销。任何现代数据库引擎都会将`'$option1' = ''`表达式优化为一个常量值，仅将其评估为布尔值一次。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-16T05:01:50.707

```
$baseSQL = "SELECT * FROM Group";

if(isset($option1)){
    sprintf("%s world. Day number %u",$str,$number);
    $whereSQL[] = sprintf("FirstOption = '%s'",mysqli_real_escape_string($mysqli,$option1));
}
if(isset($option2)){
    $whereSQL[] = sprintf("SecondOption = '%s'",mysqli_real_escape_string($mysqli,$option2));
}
if(isset($option3)){
    $whereSQL[] = sprintf("ThirdOption = '%s'",mysqli_real_escape_string($mysqli,$option3));
}

if(isset($whereSQL)){
    $query = $baseSQL ." WHERE " . implode(" AND ",$whereSQL);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-16T05:03:34.447

我的普通方式：

```
$cond=array();
$bind=array();
if(isset($option1))
{
    $cond[]="FirstOption=?";
    $bind[]=$option1;
}
if(isset($option2))
{
    $cond[]="SecondOption=?";
    $bind[]=$option2;
}
if(isset($option3))
{
    $cond[]="ThirdOption=?";
    $bind[]=$option3;
}
$sql="SELECT * FROM `group`";
if(count($cond)>0) $sql.=" WHERE ".implode(" AND ",$cond);
$stmt=$mysqli->prepare($sql);
if(count($bind)>0)
{
    foreach($bind as $idx=>$val)
    {
        $stmt->bind_param("s",$bind[$idx]);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-16T05:15:44.817

试试这个

```
$sql = "Select * from Group where 1=1 ";
$whr = "";

if(isset($option1)){
$whr .= " and FirstOption = $option1";
}
if(isset($option2)){
$whr .= " and SecondOption = $option2";
}
if(isset($option3)){
$whr .= " and ThirdOption = $option3";
}
// nth element ...

if(isset($optionN)){
$whr .= " and nTHOption = $optionN";
}

$sql .= $whr; 
```

这样，您可以在 where 条件下向查询中添加任意数量的选项。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-16T04:58:36.677

```
if(isset($option1)||isset($option2)||isset($option3)){
$sqlToAdd = (isset($option1)?" FirstOption=$option1":"");
$sqlToAdd .= ($sqlToAdd==""?"":" AND ").(isset($option2)?" SecondOption=$option2":"");
$sqlToAdd .= ($sqlToAdd==""?"":" AND ").(isset($option3)?" ThirdOption=$option3":"");
$sql = "SELECT *
                               FROM Group
                               WHERE $sqlToAdd";
} 
```

# cordova - 重新打开应用程序时显示的 Phonegap 弹出窗口

> ID：14351621
> 
> 赞同：1
> 
> 时间：2013-01-16T04:55:12.977
> 
> 标签：cordova, popup, alert

我正在创建一个 iOS Phonegap 应用程序。我在其中使用来自[http://docs.phonegap.com/en/1.0.0/phonegap_notification_notification.md.html的脚本](http://docs.phonegap.com/en/1.0.0/phonegap_notification_notification.md.html)

```
// Show a custom alert

function showAlert() {
    navigator.notification.alert(
      "Do you really want to delete this item?",  // message
        alertDismissed,         // callback
        "Delete",            // title
        "Ok, Cancel"                  // buttonName
    );
}

 // alert dialog dismissed
         function alertDismissed() {
 //      alert("Test this");// write your necessary code here
} 
```

我在我的 html 中调用了 .js 文件

我遇到的问题很奇怪。我单击按钮以查看我的应用程序中的弹出窗口，但没有任何反应。但是，如果我关闭并重新打开应用程序，我会看到弹出窗口，这是我之前应该看到的！

有人可以帮忙吗！

# git - Git删除子模块并添加另一个叉子

> ID：14351622
> 
> 赞同：2
> 
> 时间：2013-01-16T04:55:31.303
> 
> 标签：git, github

我正在从 Github分叉[mapbox-ios-sdk 。](https://github.com/mapbox/mapbox-ios-sdk.git)mapbox-ios-sdk 使用[FMDB](https://github.com/ccgus/fmdb)作为子模块。我想要我自己的[自定义版本的 FMDB](https://github.com/t2wu/fmdb) （实际上只是从另一个项目中添加一个 sqlite3.h），因此我想要我自己的 sdk 分支。

所以在我自己的 fork 上，我尝试删除原来的 FMDB 子模块并添加我自己的 fork。我根据[这个线程](https://stackoverflow.com/questions/1260748/how-do-i-remove-a-git-submodule)删除了子模块。然后我通过以下方式在与原始 FMDB 子模块**相同的目录**中添加了我自己的 FMDB 分支：

`git submodule add https://github.com/t2wu/fmdb ./MapView/Map/FMDB`

现在我遇到了我无法解释的事情。上面的命令不起作用！它会下载 FMDB 好，但我不会在`./MapView/Map/FMDB/src`. （而且`git log --graph`我没有看到我自己对 sqlite3.h 的提交，而且我在 master 上。）但是，如果我只是把它放在其他地方，比如说

`git submodule add https://github.com/t2wu/fmdb ./MapView/MapView/FMDB`

或者

`git submodule add https://github.com/t2wu/fmdb FMDB`

然后我确实看到了 sqlite3.h。会发生什么？它与 mapbox-ios-sdk 显然也支持的 CocoaPod 有什么关系吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T05:39:47.690

尽管您删除了旧的子模块，但元数据仍保留在 .git/modules/MapView/Map/FMDB 中。

从 git 1.7.8 开始，git 将子模块元数据存储在父存储库的 .git 目录中，而不是子模块中的单独 .git 。这就是为什么您会看到旧子模块的历史记录和工作树。

要让一切恢复原状，请转到父存储库的基础并运行：

```
git submodule sync
cd MapView/Map/FMDB
git fetch
git checkout origin/master 
```

# java - 如何在大文本文件中查找单词的第 n 次出现（反向）？

> ID：14351633
> 
> 赞同：5
> 
> 时间：2013-01-16T04:56:16.787
> 
> 标签：java, c, string, algorithm, large-files

这是一个面试问题和对效率的担忧。当有一个非常大的文件（以 GB 为单位）时，类似于日志文件。我们如何从文件末尾找到第 10 次出现“error”或“java”等单词。我只能想到扫描整个文件，然后以相反的顺序找出发生的情况。但我认为这不是正确的做法！（最好用 C 或 Java 编码）

我还想知道另一件事。当面试官特别提到它是一个非常大的文件时，我们开始编写代码时应该考虑哪些因素（除了要记住扫描是非常昂贵的事情）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T05:22:02.647

为了在大文本中搜索单词，[Boyer Moore](http://www.cs.utexas.edu/~moore/best-ideas/string-searching/index.html)算法被广泛使用。

原理（实例见链接）：在文件的某个位置（索引）开始比较时，如果被比较的文本的第一个字母根本不在被搜索的单词中，则无需比较它的其他 [wordLength - 1] 字符与文本，并且索引可以向前移动单词长度。如果字母在单词中，不完全是在这里，而是移动了几个字符，比较也可以移动几个字符等......

*   根据字长和与文本的相似性，搜索可能会加快很多（最高可达 naiveSearchTime / wordLength）。

*编辑*由于您从文件末尾搜索，因此首先要比较单词的第一个字母（不是最后一个）。例如，在“2001 a space odyssey”中搜索“space”，单词*空间*'s'将与*odssey* first 'y'进行比较。下一个比较是与文本*空间*“c”相同的“s”。
最后，为了找到第 n 次出现，每次找到单词时都会减少一个简单的计数器（初始化为*n ），当它达到 0 时，就是这样。*

该算法易于理解和实现。面试的理想选择。

您可能还会问该文件是否只搜索一次或多次？如果打算多次搜索，您可以建议从文件中索引单词。即在内存中创建一个结构，该结构允许快速查找一个单词是否在其中，在哪里，多少次等等......我喜欢[Trie 算法](http://en.wikipedia.org/wiki/Trie)也很容易理解，而且速度非常快（也可能非常贪内存，这取决于文本）。它的复杂度是*O(wordLength)*。

--

当面试官提到“非常大的文件”时，需要考虑很多因素，比如

*   搜索算法如上
*   文本是否适合记忆？（例如在处理所有文件时）我是否必须实现文件搜索算法（即一次只使用内存中的部分文件）
*   文件在哪里？内存（快速）、硬盘（较慢但至少在本地）、远程（通常较慢、连接问题、远程访问、防火墙、网络速度等）
*   文件被压缩了吗？（解压后会占用更多空间）
*   文件是由一个文件还是几个块组成的？
*   它包含文本还是二进制文件？如果是文本，它的语言给出了字母出现概率的指示（例如，在英语中，Y 比在法语中出现的频率高得多）。
*   提供索引文件单词（如果相关）
*   提议从大文件创建一个更简单的文件（如删除重复的单词等），以便拥有更容易处理的更小文件

...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T05:51:00.977

这个问题的答案有两个部分。一种是使用的算法，它可以是任何好的字符串搜索算法（Boyer Moore / KMP / Trie 等）。另一部分是IO。为了加快速度，因为您无法真正从文件中向后读取，一个好的方法是：

1.  分配一块内存，比如 10MB
2.  for (i = 1; (文件大小 - 10MB * i) >= 0; i++) {
3.  寻找 (filesize - 10MB * i) 并将 10MB 读入内存
4.  *向后*搜索当前块中的字符串并增加一个计数器
5.  当计数器达到 10 时停止

这是一个面向 IO 的问题，您可以使用多线程系统或多台机器改进这种方法，在这些机器中，您可以并行执行搜索和从文件读取到内存（即步骤 3 和 4）。

这是 C++ 代码，但您知道如何在 Java 中执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T05:52:31.163

添加@AlexeyFrunze 的评论，请参阅此处的相关帖子：[向后读取文件（最后一行首先）](https://stackoverflow.com/questions/6922829/read-file-backwards-last-line-first)。然而，也许面试官对一个解决方案感兴趣，在这个解决方案中，你可以正常向前阅读，看看你将如何解决记忆力有限的问题。

@ring0 的精彩帖子，所以我只提一些关于在一个非常**大的文件中****从末尾开始专门查找第 k 个单词**的问题，其中**k**像 10 一样小，这表明你不应该记住整个文件和然后向后搜索。

 **您可以维护一个先进先出缓冲区，即大小为**k的****队列**，您可以在其中存储遇到匹配项的位置。随着您找到越来越多的匹配项，您将忘记之前的匹配项。给定并初始化为零，并且，您可以解决排队问题。到达文件末尾后，**`const int k = 10;``long match_pos[k];``count``match_pos[count % k] = pos`**

 **```
if (count >= k)
{
    int kth_match_pos = match_pos[(count + 1) % k];
    // ...
} 
```

检查缓冲区中最旧的条目，因此您可以跳回**n**字节，其中**n**是`pos - kth_match_pos`. 如果相关上下文也存储在队列中，则无需查找。****

# liferay - 在社交办公室主题中添加水平菜单栏

> ID：14351634
> 
> 赞同：2
> 
> 时间：2013-01-16T04:56:21.473
> 
> 标签：liferay, liferay-6

我正在使用 Liferay 6.1.1 CE。

默认情况下，SO 中的菜单栏作为侧边栏垂直放置，我们可以添加页面。

但是我需要水平页面顶部的另一个菜单栏，我可以添加页面。

我怎样才能将它添加到 SO？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-03T04:38:23.057

您可能需要处理主题。你可以在navigation.vm中设置

# javascript - jquery点击事件不适用于动态字段

> ID：14351636
> 
> 赞同：9
> 
> 时间：2013-01-16T04:56:29.070
> 
> 标签：javascript, jquery, onclick

> **可能重复：**
> [jQuery - Click 事件不适用于动态生成的元素](https://stackoverflow.com/questions/6658752/jquery-click-event-doesnt-work-on-dynamically-generated-elements)

我只有一个可点击的添加按钮来添加新的表格行。表格行包括一个删除按钮。我注意到，当我动态添加新行时，按钮不会触发单击事件，但如果在页面加载时按钮存在，那么它可以正常工作。我该如何纠正？

Javascript：

```
$('#btnAdd').click(function () {

        var newTr = '<tr><td><input id="column_0" name="column[0]" style="width:40%;" type="text" /> <img alt="Delete-icon24x24" class="btnDel clickable" id="" src="/assets/delete-icon24x24.png" /></td></tr>';
        $('#columns').append(newTr);
    });

$('.btnDel').click(function () {
    alert('hey');
    console.log('test');
    var row = $(this).closest("tr");
    alert(row);

    row.remove();
}); 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-16T04:57:44.357

您需要使用事件委托：

```
$("table").on("click", ".btnDel", function () {
    /* Respond to click here */
}); 
```

原因是您不能将处理程序绑定到当前不存在于 DOM 中的项目。但是，您可以将处理程序绑定到委托目标（将保留在 DOM 中的父元素）。点击会在 DOM 中冒泡，最终到达委托目标。

我们监听点击`table`并评估它们是否来自一个`.btnDel`元素。现在，这将响应`.btnDel`页面加载时加载的元素的点击，以及稍后动态添加的点击。

最后，不要重复使用 ID 值。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-16T04:58:03.793

您需要使用[**on()**](http://api.jquery.com/on/)进行动态添加的 html 元素的事件委托。如果可以的话，您可以将事件委托给`parent`动态添加元素的元素，或者您可以委托给`document`.

```
$(document).on('click', '.btnDel', function () {
    alert('hey');
    console.log('test');
    var row = $(this).closest("tr");
    alert(row);

    row.remove();
}); 
```

**[委托活动](http://api.jquery.com/on/)**

> 委托事件的优点是它们可以处理来自以后添加到文档的后代元素的事件。通过选择在附加委托事件处理程序时保证存在的元素，您可以使用委托事件来避免频繁附加和删除事件处理程序的需要。

要进一步理解，请阅读这篇文章[理解事件委托](http://learn.jquery.com/events/event-delegation/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-16T04:58:23.517

利用`on()`

```
$(document).on('click', '.btnDel', function(){
  //your code
}) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T05:51:27.413

这将起作用

```
 $('#btnAdd').click(function () {

       var newTr = '<tr><td><input id="column_0" 
       name="column[0]"style="width:40%;"type="text" />
      <img alt="Delete-icon24x24" class="btnDel clickable" id="" 
       src="/assets/delete- icon24x24.png" /></td></tr>';
    $('#columns').append(newTr);

       $('.btnDel').click(function () {
       alert('hey');
       console.log('test');
       var row = $(this).closest("tr");
       alert(row);

       row.remove();
     });

      }); 
```

# ssrs-2008 - 我可以在多种颜色波段中为图表区域背景着色 - SSRS 2008 R2

> ID：14351638
> 
> 赞同：1
> 
> 时间：2013-01-16T04:56:29.600
> 
> 标签：ssrs-2008, reporting-services

我可以在多色带中为我的图表区域背景着色吗

那是基于 Y - 垂直轴是否有可能有多个波段例如：在 Y 轴上的比例为 1 到 100，是否可能有 - 0 -30 绿色、30-70 蓝色和 70 -100 三个红色波段不同的颜色

通过交替颜色可以将两种颜色作为背景，这样可以使用 3 种或更多颜色。

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T15:17:04.190

您可以使用 rownumber 表达式为行替换颜色。

```
=iif(columnnumber(nothing) mod 2, "Green", "blue") 
```

对于列，它有点棘手。使用您知道将是某个值的列值显式绑定颜色会容易得多。

```
IIF( (ColumnName) = (predicate), "Red", 
  IIF( (ColumnName) = (predicate2), "Green", "Blue")) 
```

要执行其中任何一项，只需转到行、列或单元格的属性并转到背景。点击下拉菜单，选择“表达式”并输入代码。

编辑：下面的工作示例仅适用于 TABLE 对象而不是矩阵。Matrix 可以具有动态变化的值，因此您需要更多代码来解决这个问题。

在桌子上交替三种颜色：

```
=iif(rownumber(nothing) mod 3=1, "Green", 
    iif(rownumber(nothing) mod 3=0, "Blue", "Gray")) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T07:21:59.597

SSRS 图表上的不同背景色带是通过**StripLines**功能实现的。

查看以下相关问题中的最佳答案：[折线图中的条件背景颜色](https://stackoverflow.com/questions/14842297/conditional-background-color-in-line-charts)

# header - 星号修改标题

> ID：14351648
> 
> 赞同：0
> 
> 时间：2013-01-16T04:57:41.803
> 
> 标签：header, asterisk

我想用星号替换我的 SPA2102。如何修改标头，例如 From、To 和 Contact？我需要替换标题，例如

```
From: "asterisk" <sip:XXXX174264@ip.ip.ip.6>;tag=as1ea48bca 
```

到标头，例如 SPA2102。

我的 SPA2102 发送它就像

```
"XXXX174264" <sip:XXXX174264@ip.ip.ip.6> 
```

如何

```
#  tcpdump -nAieth0 port 5060 and net ip.ip.ip.0/24

10:47:55.801914 IP 10.37.93.21.5060 > ip.ip.ip.6.5060: SIP, length: 906
E....j..@...
%].............INVITE sip:474264@ip.ip.ip.6 SIP/2.0
Via: SIP/2.0/UDP 10.37.93.21:5060;branch=z9hG4bK20d7bc88
Max-Forwards: 70
From: "asterisk" <sip:XXXX174264@ip.ip.ip.6>;tag=as1ea48bca
To: <sip:474264@ip.ip.ip.6>
Contact: <sip:XXXX174264@10.37.93.21:5060>
Call-ID: 6b4c893e70628a626286cd0a748f93de@ip.ip.ip.6
CSeq: 102 INVITE
User-Agent: Linksys/SPA2102-5.2.5
Date: Wed, 16 Jan 2013 04:47:55 GMT
Allow: INVITE, ACK, CANCEL, OPTIONS, BYE, REFER, SUBSCRIBE, NOTIFY, INFO, PUBLISH
Supported: replaces, timer
Content-Type: application/sdp
Content-Length: 333

v=0
o=- 233070007 233070007 IN IP4 10.37.93.21
s=Asterisk PBX 11.2.0
c=IN IP4 10.37.93.21
t=0 0
m=audio 10004 RTP/AVP 0 8 3 111 101
a=rtpmap:0 PCMU/8000
a=rtpmap:8 PCMA/8000
a=rtpmap:3 GSM/8000
a=rtpmap:111 G726-32/8000
a=rtpmap:101 telephone-event/8000
a=fmtp:101 0-16
a=silenceSupp:off - - - -
a=ptime:20
a=sendrecv

10:47:55.822359 IP ip.ip.ip.6.5060 > 10.37.93.21.5060: SIP, length: 348
E..x..@.>.#.....
%]......d.CSIP/2.0 100 Trying
Via: SIP/2.0/UDP 10.37.93.21:5060;branch=z9hG4bK20d7bc88
From: "asterisk" <sip:XXXX174264@ip.ip.ip.6>;tag=as1ea48bca
To: <sip:474264@ip.ip.ip.6>
Call-ID: 6b4c893e70628a626286cd0a748f93de@ip.ip.ip.6
CSeq: 102 INVITE
Contact: <sip:474264@ip.ip.ip.6:5060>
Server: MERA MVTS3G v.4.3.0-38t
Content-Length: 0 
```

我尝试使用 SPA 和 Asterisk 拨打电话。两者都注册成功。但是 Asterisk 不能打电话。这是来自 SPA 的 tcpdump：

```
00:58:00.778565 IP 10.37.93.23.5060 > ip.ip.ip.6.5060: SIP, length: 892
Eh..........
%].............INVITE sip:474264@ip.ip.ip.6 SIP/2.0
Via: SIP/2.0/UDP 10.37.93.23:5060;branch=z9hG4bK-9b906813
From: XXXX174264 <sip:XXXX174264@ip.ip.ip.6>;tag=e9377d83dbc079fo0
To: <sip:474264@ip.ip.ip.6>
Remote-Party-ID: XXXX174264 <sip:XXXX174264@ip.ip.ip.6>;screen=yes;party=calling
Call-ID: 27e34e53-cdeded0f@10.37.93.23
CSeq: 101 INVITE
Max-Forwards: 70
Contact: XXXX174264 <sip:XXXX174264@10.37.93.23:5060>
Expires: 240
User-Agent: Linksys/SPA2102-5.2.5
Content-Length: 268
Allow: ACK, BYE, CANCEL, INFO, INVITE, NOTIFY, OPTIONS, REFER
Supported: x-sipura, replaces
Content-Type: application/sdp

v=0
o=- 93383 93383 IN IP4 10.37.93.23
s=-
c=IN IP4 10.37.93.23
t=0 0
m=audio 16186 RTP/AVP 8 0 18 4 100
a=rtpmap:8 PCMA/8000
a=rtpmap:0 PCMU/8000
a=rtpmap:18 G729a/8000
a=rtpmap:4 G723/8000
a=rtpmap:100 NSE/8000
a=fmtp:100 192-193
a=ptime:20
a=sendrecv

00:58:00.782580 IP ip.ip.ip.6.5060 > 10.37.93.23.5060: SIP, length: 342
....E..r..@.>.#.....
%]......^..SIP/2.0 100 Trying
Via: SIP/2.0/UDP 10.37.93.23:5060;branch=z9hG4bK-9b906813
From: "XXXX174264" <sip:XXXX174264@ip.ip.ip.6>;tag=e9377d83dbc079fo0
To: <sip:474264@ip.ip.ip.6>
Call-ID: 27e34e53-cdeded0f@10.37.93.23
CSeq: 101 INVITE
Contact: <sip:474264@ip.ip.ip.6:5060>
Server: MERA MVTS3G v.4.3.0-38t
Content-Length: 0

00:58:02.479539 IP ip.ip.ip.6.5060 > 10.37.93.23.5060: SIP, length: 683
....E.....@.>."p....
%].......<.SIP/2.0 180 Ringing
Via: SIP/2.0/UDP 10.37.93.23:5060;branch=z9hG4bK-9b906813
From: "XXXX174264" <sip:XXXX174264@ip.ip.ip.6>;tag=e9377d83dbc079fo0
To: <sip:474264@ip.ip.ip.6>;tag=109877804-3792792162-4082950052-3026001148
Call-ID: 27e34e53-cdeded0f@10.37.93.23
CSeq: 101 INVITE
Contact: <sip:474264@ip.ip.ip.6:5060>
Content-Type: application/sdp
Server: MERA MVTS3G v.4.3.0-38t
Content-Length:   258

v=0
o=- 1358621882 1358621882 IN IP4 ip.ip.ip.5
s=-
c=IN IP4 ip.ip.ip.5
t=0 0
m=audio 39878 RTP/AVP 8 0 18
a=rtpmap:8 PCMA/8000
a=rtpmap:0 PCMU/8000
a=rtpmap:18 G729/8000
a=fmtp:18 annexb=no
a=ptime:20
a=sendrecv
a=silenceSupp:off - - - -

00:58:30.832778 IP 10.37.93.23.5060 > ip.ip.ip.6.5060: SIP, length: 339
Eh.o........
%]..........[O.CANCEL sip:474264@ip.ip.ip.6 SIP/2.0
Via: SIP/2.0/UDP 10.37.93.23:5060;branch=z9hG4bK-9b906813
From: XXXX174264 <sip:XXXX174264@ip.ip.ip.6>;tag=e9377d83dbc079fo0
To: <sip:474264@ip.ip.ip.6>
Call-ID: 27e34e53-cdeded0f@10.37.93.23
CSeq: 101 CANCEL
Max-Forwards: 70
User-Agent: Linksys/SPA2102-5.2.5
Content-Length: 0

00:58:30.836782 IP ip.ip.ip.6.5060 > 10.37.93.23.5060: SIP, length: 385
....E.....@.>.#.....
%].......7.SIP/2.0 200 OK
Via: SIP/2.0/UDP 10.37.93.23:5060;branch=z9hG4bK-9b906813
From: "XXXX174264" <sip:XXXX174264@ip.ip.ip.6>;tag=e9377d83dbc079fo0
To: <sip:474264@ip.ip.ip.6>;tag=109877804-3792792162-4082950052-3026001148
Call-ID: 27e34e53-cdeded0f@10.37.93.23
CSeq: 101 CANCEL
Contact: <sip:474264@ip.ip.ip.6:5060>
Server: MERA MVTS3G v.4.3.0-38t
Content-Length: 0

00:58:30.838775 IP ip.ip.ip.6.5060 > 10.37.93.23.5060: SIP, length: 450
....E.....@.>.#Y....
%].........SIP/2.0 487 Request Terminated
Via: SIP/2.0/UDP 10.37.93.23:5060;branch=z9hG4bK-9b906813
From: "XXXX174264" <sip:XXXX174264@ip.ip.ip.6>;tag=e9377d83dbc079fo0
To: <sip:474264@ip.ip.ip.6>;tag=109877804-3792792162-4082950052-3026001148
Call-ID: 27e34e53-cdeded0f@10.37.93.23
CSeq: 101 INVITE
Contact: <sip:474264@ip.ip.ip.6:5060>
Server: MERA MVTS3G v.4.3.0-38t
Reason: SIP;cause=487;text="Request Terminated"
Content-Length: 0

00:58:30.845777 IP 10.37.93.23.5060 > ip.ip.ip.6.5060: SIP, length: 437
Eh.........&
%].............ACK sip:474264@ip.ip.ip.6 SIP/2.0
Via: SIP/2.0/UDP 10.37.93.23:5060;branch=z9hG4bK-9b906813
From: XXXX174264 <sip:XXXX174264@ip.ip.ip.6>;tag=e9377d83dbc079fo0
To: <sip:474264@ip.ip.ip.6>;tag=109877804-3792792162-4082950052-3026001148
Call-ID: 27e34e53-cdeded0f@10.37.93.23
CSeq: 101 ACK
Max-Forwards: 70
Contact: XXXX174264 <sip:XXXX174264@10.37.93.23:5060>
User-Agent: Linksys/SPA2102-5.2.5
Content-Length: 0 
```

和来自 Asterisk 的 tcpdump：

```
E...W,..@.      .
%].............INVITE sip:474264@ip.ip.ip.6 SIP/2.0
Via: SIP/2.0/UDP 10.37.93.21:5060;branch=z9hG4bK6422ee1e
Max-Forwards: 70
From: "asterisk" <sip:XXXX174264@ip.ip.ip.6>;tag=as43ada6c8
To: <sip:474264@ip.ip.ip.6>
Contact: <sip:XXXX174264@10.37.93.21:5060>
Call-ID: 6e8b22967d9c55ea349abb636c0e5263@ip.ip.ip.6
CSeq: 102 INVITE
User-Agent: Linksys/SPA2102-5.2.5
Date: Sat, 19 Jan 2013 18:49:27 GMT
Allow: INVITE, ACK, CANCEL, OPTIONS, BYE, REFER, SUBSCRIBE, NOTIFY, INFO, PUBLISH
Supported: replaces, timer
Content-Type: application/sdp
Content-Length: 333

v=0
o=- 413424664 413424664 IN IP4 10.37.93.21
s=Asterisk PBX 11.2.0
c=IN IP4 10.37.93.21
t=0 0
m=audio 10008 RTP/AVP 0 8 3 111 101
a=rtpmap:0 PCMU/8000
a=rtpmap:8 PCMA/8000
a=rtpmap:3 GSM/8000
a=rtpmap:111 G726-32/8000
a=rtpmap:101 telephone-event/8000
a=fmtp:101 0-16
a=silenceSupp:off - - - -
a=ptime:20
a=sendrecv

00:49:27.073977 IP ip.ip.ip.6.5060 > 10.37.93.21.5060: SIP, length: 348
E..x..@.>.#.....
%]......d..SIP/2.0 100 Trying
Via: SIP/2.0/UDP 10.37.93.21:5060;branch=z9hG4bK6422ee1e
From: "asterisk" <sip:XXXX174264@ip.ip.ip.6>;tag=as43ada6c8
To: <sip:474264@ip.ip.ip.6>
Call-ID: 6e8b22967d9c55ea349abb636c0e5263@ip.ip.ip.6
CSeq: 102 INVITE
Contact: <sip:474264@ip.ip.ip.6:5060>
Server: MERA MVTS3G v.4.3.0-38t
Content-Length: 0

00:49:27.100102 IP ip.ip.ip.6.5060 > 10.37.93.21.5060: SIP, length: 478
E.....@.>.#?....
%].........SIP/2.0 603 Subscriber account disabled
Via: SIP/2.0/UDP 10.37.93.21:5060;branch=z9hG4bK6422ee1e
From: "asterisk" <sip:XXXX174264@ip.ip.ip.6>;tag=as43ada6c8
To: <sip:474264@ip.ip.ip.6>;tag=179071226-3792791650-4082950052-3026001148
Call-ID: 6e8b22967d9c55ea349abb636c0e5263@ip.ip.ip.6
CSeq: 102 INVITE
Contact: <sip:474264@ip.ip.ip.6:5060>
Server: MERA MVTS3G v.4.3.0-38t
Reason: Centrex;cause=179;text="Subscriber account disabled"
Content-Length: 0

00:49:27.100295 IP 10.37.93.21.5060 > ip.ip.ip.6.5060: SIP, length: 433
E...W-..@.
.
%]...........#,ACK sip:474264@ip.ip.ip.6 SIP/2.0
Via: SIP/2.0/UDP 10.37.93.21:5060;branch=z9hG4bK6422ee1e
Max-Forwards: 70
From: "asterisk" <sip:XXXX174264@ip.ip.ip.6>;tag=as43ada6c8
To: <sip:474264@ip.ip.ip.6>;tag=179071226-3792791650-4082950052-3026001148
Contact: <sip:XXXX174264@10.37.93.21:5060>
Call-ID: 6e8b22967d9c55ea349abb636c0e5263@ip.ip.ip.6
CSeq: 102 ACK
User-Agent: Linksys/SPA2102-5.2.5
Content-Length: 0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:50:26.230

尝试更改 sip.conf 如下：

```
[general]
realm=yourprovider-domain-here
useragent = Linksys/PAP2T-5.1.6(LS)
sdpsession= Linksys/PAP2T-5.1.6(LS) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-10T17:56:49.403

你可以在拨号方案中使用 SipAddHeader，比如

```
SipAddHeader(P-Preferred-Identity: <sip:XXXXXX@10.0.10.10> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T09:25:56.547

有两个地方可以更改这些标题。

从某种意义上说，在您的 PBX 中，`PBX -> SPA`您应该像这样修改您的`sip.conf`文件：

```
[general]
...
realm = my_realm.com ; This will substitute From: "asterisk" 
```

在您的 SPA2102 通话中，`SPA -> PBX`您必须输入 SPA 配置并更改您的订阅者信息。这是本指南的第 5 步：[http](http://www.voipvoip.com/spa-2101/) ://www.voipvoip.com/spa-2101/其中显示“显示名称”

# java - 如何修改此代码以使其在 Android API 3.0 上运行？

> ID：14351651
> 
> 赞同：0
> 
> 时间：2013-01-16T04:57:47.197
> 
> 标签：java, android, eclipse, json, android-asynctask

我们正在制作一个具有登录功能和存储在服务器上的 mySQL 数据库的 Android 应用程序。我找到了一段代码，让它在低于 API 级别 3.0 的 Android 设备上正常工作。除此之外的任何事情都会崩溃。我被告知使用 Asynctask 来解决我的问题。要将 UI 代码与网络代码分开？被告知应该很容易，但我不知道如何让它工作。谁能告诉我我需要做什么才能使这段代码正常工作？我花了无数个小时研究这个问题，但仍然没有运气。我很感激任何帮助。谢谢

```
public class RegisterActivity extends Activity {
Button btnRegister;
Button btnLinkToLogin;
EditText inputFullName;
EditText inputEmail;
EditText inputPassword;
TextView registerErrorMsg;

// JSON Response node names
private static String KEY_SUCCESS = "success";
private static String KEY_ERROR = "error";
private static String KEY_ERROR_MSG = "error_msg";
private static String KEY_UID = "uid";
private static String KEY_NAME = "name";
private static String KEY_EMAIL = "email";
private static String KEY_CREATED_AT = "created_at";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.register);

    // Importing all assets like buttons, text fields
    inputFullName = (EditText) findViewById(R.id.registerName);
    inputEmail = (EditText) findViewById(R.id.registerEmail);
    inputPassword = (EditText) findViewById(R.id.registerPassword);
    btnRegister = (Button) findViewById(R.id.btnRegister);
    btnLinkToLogin = (Button) findViewById(R.id.btnLinkToLoginScreen);
    registerErrorMsg = (TextView) findViewById(R.id.register_error);

    // Register Button Click event
    btnRegister.setOnClickListener(new View.OnClickListener() {
        public void onClick(View view) {
            String name = inputFullName.getText().toString();
            String email = inputEmail.getText().toString();
            String password = inputPassword.getText().toString();
            UserFunctions userFunction = new UserFunctions();
            JSONObject json = userFunction.registerUser(name, email, password);

            // check for login response
            try {
                if (json.getString(KEY_SUCCESS) != null) {
                    registerErrorMsg.setText("");
                    String res = json.getString(KEY_SUCCESS);
                    if(Integer.parseInt(res) == 1){
                        // user successfully registred
                        // Store user details in SQLite Database
                        DatabaseHandler db = new DatabaseHandler(getApplicationContext());
                        JSONObject json_user = json.getJSONObject("user");

                        // Clear all previous data in database
                        userFunction.logoutUser(getApplicationContext());
                        db.addUser(json_user.getString(KEY_NAME), json_user.getString(KEY_EMAIL), json.getString(KEY_UID), json_user.getString(KEY_CREATED_AT));
                        // Launch Dashboard Screen
                        Intent dashboard = new Intent(getApplicationContext(), DashboardActivity.class);
                        // Close all views before launching Dashboard
                        dashboard.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                        startActivity(dashboard);
                        // Close Registration Screen
                        finish();
                    }else{
                        // Error in registration
                        registerErrorMsg.setText("Error occured in registration");
                    }
                }
            } catch (JSONException e) {
                e.printStackTrace();
            }
        }
    });

    // Link to Login Screen
    btnLinkToLogin.setOnClickListener(new View.OnClickListener() {

        public void onClick(View view) {
            Intent i = new Intent(getApplicationContext(),
                    LoginActivity.class);
            startActivity(i);
            // Close Registration View
            finish();
        }
    });
}
} 
```

这里也是 logCatError

```
 D/AndroidRuntime(10040): Shutting down VM
 W/dalvikvm(10040): threadid=1: thread exiting with uncaught exception (group=0x416f2930)
 E/AndroidRuntime(10040): FATAL EXCEPTION: main
 E/AndroidRuntime(10040): android.os.NetworkOnMainThreadException
 E/AndroidRuntime(10040):    at     android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1117)
 E/AndroidRuntime(10040):    at libcore.io.BlockGuardOs.connect(BlockGuardOs.java:84)
 E/AndroidRuntime(10040):    at libcore.io.IoBridge.connectErrno(IoBridge.java:127)
 E/AndroidRuntime(10040):    at libcore.io.IoBridge.connect(IoBridge.java:112)
 E/AndroidRuntime(10040):    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:192)
 E/AndroidRuntime(10040):    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:459)
 E/AndroidRuntime(10040):    at java.net.Socket.connect(Socket.java:842) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T05:07:02.753

从 ICS 及以上版本 Android 将不允许在 UI 线程中进行任何网络操作。它应该在单独的线程中完成，这样它就不会挂起 UI。在单独的线程中尝试您的网络通信代码。

请参阅此[链接](http://www.androiddesignpatterns.com/2012/06/app-force-close-honeycomb-ics.html)。它解释了为什么会在 Android 3.0 及更高版本上发生这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T05:18:53.363

确实，android 对 UI 线程变得非常严格，并且不允许您在 UI 线程上执行后台计算，因为它会降低性能。您被告知使用异步任务执行网络通信是正确的。您可以使用 `new yourTask().execute()`; 在注册按钮的 onCLick 处执行 asyncTask 来完成。

然后像这样写一个 asyncTask 类

```
private class yourTask extends AsyncTask<Integer, Void, Integer> {
    @Override
    protected void onPreExecute() {
        super.onPreExecute();
        //show a progress bar 
    }

    @Override
    protected String doInBackground(Integer... params) {
       // your network communication code will be here.
        return 0; 
    }      

    @Override
    protected void onPostExecute(Integer result) {
        super.onPostExecute(result);
       //show the result here
    }
} 
```

# php - Magento 中用于管理员登录身份验证的 API

> ID：14351657
> 
> 赞同：4
> 
> 时间：2013-01-16T04:58:38.250
> 
> 标签：php, api, magento, authentication

Magento 中是否有任何用于管理员登录身份验证的 Api？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T06:18:02.977

我认为 magento 具有管理员身份验证的扩展名[这可能会对您有所帮助](http://www.magentocommerce.com/magento-connect/catalogsearch/result/?q=admin+login+authentication&pl=0)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-16T07:46:00.847

```
if(isset($_REQUEST['admin_name']) && isset($_REQUEST['admin_password']))
             $user = Mage::getModel('admin/user');
             $user->login($_REQUEST['admin_name'],$_REQUEST['admin_password']);
             $result=$user->getId();
             if($result)
             {
                 $result1=$user->getUsername();
                 $result2=$user->getFirstname();
                 $result3=$user->getLastname();
                 $result4= $user->getEmail();
                 echo $result4;
             } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T07:19:02.247

目前尚不清楚，您要实现什么。因此，我为三个可能的目标提供了指导。

**1）如果您想通过某个 3rd 方系统对管理员进行身份验证**，因此他不需要在标准的“登录/密码”表单中输入他的凭据，**那么您需要使用 Magento 代码库灵活性**并安装一些自定义解决方案或编写它靠自己。没有开箱即用的 3rd 方身份验证功能，因为它过于专业并且有许多身份验证提供程序/API。

像任何系统一样，Magento 不可能是万能的瑞士刀，它通过初始系统包提供所有解决方案。相反，该平台具有许多有用的电子商务功能以及完全定制的能力。因此，如果任何店主想要为其商店添加新功能，那么他可以轻松开发自己的定制解决方案。或者尝试在 Magento Connect（即 Magento 的 App Store）上找到一个，@naveen 已经提供了一个[链接。](http://www.magentocommerce.com/magento-connect/catalogsearch/result/?q=admin%20login%20authentication&pl=0)

**2) 如果您想使用 API 代表管理员用户执行一些后端操作（产品创建、客户管理等），那么您可以使用 Magento 的 REST 或 SOAP API。**请注意，这些系统不使用管理员帐户，而是拥有自己的用户，这些用户在后端进行配置。[您可以在官方文档](http://www.magentocommerce.com/api/soap/introduction.html)中找到有关 Magento API 的更多信息。

**3) 如果你想在 PHP 中使用内部 API 来验证管理员登录名和密码，那么你应该使用`Mage_Admin_Model_User`or `Mage_Admin_Model_Session`。**

身份验证有两种方法`Mage_Admin_Model_User`：

*   `authenticate($username, $password)`- 加载用户模型，返回认证是否成功

```
$adminUser = Mage::getModel('admin/user');
if ($adminUser->authenticate($username, $password)) {
    echo 'Success';
} else {
     echo 'Failure';
} 
```

*   `login($username, $password)`- 加载用户模型，记录不成功的身份验证尝试

```
$adminUser = Mage::getModel('admin/user');
$adminUser->login($username, $password)
if ($adminUser->getId()) {
    echo 'Success';
} else {
    echo 'Failure';
} 
```

并且有一种方法`Mage_Admin_Model_Session`- `login($username, $password)`。该模型本身旨在管理管理会话 - 在成功登录时启动它，将 cookie 设置到浏览器，让管理员在登录后浏览后端。`login()`如果登录成功，该方法将启动新会话并返回用户模型。

```
$adminSession = Mage::getSingleton('admin/session');
$adminUser = $adminSession->login($username, $password)
if ($adminUser) {
    echo 'Success';
} else {
    echo 'Failure';
} 
```

# python - wx.BoxSizer 项目未正确对齐

> ID：14351658
> 
> 赞同：2
> 
> 时间：2013-01-16T04:59:06.727
> 
> 标签：python, wxpython

我正在使用 wx.BoxSizers 来对齐我的（这里是简化的）程序的元素。我需要蓝色面板 1 的形状为 4:3 的纵横比，但要扩展以填充框架，为此我给它的比例=1。但是我希望文本直接位于 panel1 下方，但尽可能小（portion=0）

然而，当我设置它时，panel1 会向下扩展（尽管它被认为是成形的），并且文本被推到窗口的底部。即使调整了窗口大小，我也希望文本“拥抱”panel1。我该如何解决？谢谢！

```
import wx

class myWindow(wx.Window):
    def __init__(self, parent, size):
        wx.Window.__init__(self, parent=parent, size=size)
        self.SetBackgroundColour(wx.BLUE)

class MainWindow(wx.Frame):
    def __init__(self, parent):
        wx.Frame.__init__(self, parent=parent, size=(500,500) )

        self.panel1 = myWindow(self, size=(400,300))
        self.text = wx.StaticText(self, label="This is text.")

        self.mainSizer = wx.BoxSizer(wx.VERTICAL)
        self.mainSizer.Add(self.panel1, 1, wx.ALIGN_TOP | 
                           wx.SHAPED | wx.EXPAND | wx.ALL, border=10)
        self.mainSizer.Add(self.text, 0, wx.EXPAND | 
                           wx.ALIGN_TOP | wx.LEFT, border=10)
        self.SetSizer(self.mainSizer)
        self.Show()

app = wx.App(False)
panel = MainWindow(None)
app.MainLoop() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T16:07:21.687

由于面板的形状不同，您无法准确地得到它。当您将框架设置得太小时，会导致面板从文本中缩小。不过，您可以使用其 SetSizeHints 方法设置 Frame 的最小尺寸，这样可以防止该问题。接下来，您应该在文本后添加一个分隔符，以帮助使其与面板保持一致。我只是使用了一个简单的 tuple hack。这是略有不同的代码：

```
import wx

class myWindow(wx.Panel):
    def __init__(self, parent, size):
        wx.Panel.__init__(self, parent=parent, size=size)
        self.SetBackgroundColour(wx.BLUE)

class MainWindow(wx.Frame):
    def __init__(self, parent):
        wx.Frame.__init__(self, parent=parent, size=(500,500) )

        topPanel = wx.Panel(self)
        self.panel1 = myWindow(topPanel, size=(400,300))
        self.text = wx.StaticText(topPanel, label="This is text.")

        self.mainSizer = wx.BoxSizer(wx.VERTICAL)
        self.mainSizer.Add(self.panel1, 8, wx.ALIGN_TOP | 
                           wx.SHAPED | wx.EXPAND | wx.ALL, border=10)
        self.mainSizer.Add(self.text, 0,  
                           wx.ALIGN_TOP | wx.LEFT | wx.BOTTOM, 10)
        self.mainSizer.Add((1,1), 1, wx.EXPAND)
        topPanel.SetSizer(self.mainSizer)
        self.SetSizeHints(500, 500, 3500, 3500)
        self.Show()

app = wx.App(False)
panel = MainWindow(None)
app.MainLoop() 
```

请注意，我将您的 wx.Window 类替换为 wx.Panel 类，因为无论如何您都称它为面板。我还在框架上放置了一个面板，因为它可以帮助改善应用程序跨平台的外观（并且它可以在小部件之间进行选项卡）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T19:09:01.007

在将项目添加到 sizer 时，您可能还想尝试使用 wx.SHAPED 标志。它旨在使 sizer 保持项目的纵横比，尽管我自己使用它已经很长时间了，以至于我不知道它是否仍然可以正常工作。;-)

# javascript - 如何在 Backbone 中将模型（数据）从一个视图传递到另一个视图并编辑/删除它？

> ID：14351659
> 
> 赞同：1
> 
> 时间：2013-01-16T04:59:13.157
> 
> 标签：javascript, backbone.js, backbone-views, backbone.js-collections, backbone-model

我有一个使用 BackboneJS 的 Web 应用程序。在这个应用程序中，我有一个**LayoutView.js**文件，其中有一个主干视图（称为 LayoutView）。LayoutView 还有其他调用其他视图的函数（方法）。我在 LayoutView 的初始化函数中获取一些数据，我需要在另一个视图中获取相同的数据（模型）并对其进行处理（更新/删除）。下面是我如何将数据从 LayoutView 传递到 myView：

```
var LayoutView = Backbone.View.extend({
    el: $("#mi-body"),
    initialize: function () {
        var that = this;
        this.ConfigData = new Configurations(); //Configurations is a collection
        this.ConfigData.fetch({ 
            success: function () {
                alert("success");
            },
            error: function () {
                alert("error");
            }
        });
        this.render();
        Session.on('change:auth', function (session) {
            var self = that;
            that.render();

        });
    },

    render: function () {
        // other code

    },

    events: {
        'click #logout': 'logout',
        'click #divheadernav .nav li a': 'highlightSelected'
    },

    myView: function () {
        if (Session.get('auth')) {
            this.$el.find('#mi-content').html('');
            this.options.navigate('Myview');
            return new MyLayout(this.ConfigData);
        }
    }
}); 
```

尽管如此，我仍然不知道如何在 myView 中“获取”/访问这些数据作为我当前的*数据/模型/集合*（我不确定哪个术语是正确的），并使用 Backbone 的“ *model.save()”模型来处理它。销毁（）* ”方法。此外，每当发生编辑/删除时，应修改 ConfigData 的数据，并且更新应反映在向用户显示的 html 中。

下面是来自 MyView 的代码：

```
 var MyView = Backbone.View.extend({

    tagName: 'div',

    id: "divConfigurationLayout",

    initialize: function (attrs) {
        this.render();

    },
    render: function () {
        var that = this;

    },

    events: {
        "click #Update": "update",
        "click #delete": "delete"
    },

    update: function(){
//code for updating the data like model.save...
},

delete: function(){
//code for deleting the data like model.destroy...
}
}); 
```

现在我传递的数据在**初始化**函数的**attrs**中。如何完成这个..？

 *** * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T14:04:46.247

实例化 Backbone 视图的语法是`new View(options)`where `options`is an `Object`with key-value 对。

要将集合传递给您的视图，您可以像这样实例化它：

```
new MyLayout({
    collection : this.configData
}); 
```

在您看来，`this.collection`将引用您的`configData`收藏。**

# wcf - AES加密和解密导致文件与原始文件不同

> ID：14351661
> 
> 赞同：2
> 
> 时间：2013-01-16T04:59:25.467
> 
> 标签：wcf, encryption, aes

我决定在我的服务中实现文件传输加密。在此之前的文件传输没有加密，它们以完全相同的字节数完美地发送和接收。

现在我已经在混合中引入了`asymmetrical`加密`symmetrical`，以便在数据通过 TCP 协议时对其进行加密。我用来`asymmetrical`进行初始握手，将`symmetrical`密钥传递给由公钥加密的另一方`asymmetric`。从那时起，文件的接收者周期性地调用发送者，发送者生成一个新`initialization vector`的，用密钥加密数据`symmetric`，然后发送给接收者使用IV和相同的`symmetric`密钥解密。

我使用的块大小是 2mb，这样生成的块的字节大小，除了最后一个不同的块之外，是`2097152`. `PaddingMode.PKCS7`当 AES 使用和加密此文件时`CipherMode.CBC`，生成的字节大小为`2097168`. 在加密过程中它获得了大约 16 个字节。

现在最初我认为这是我的问题所在，但是当我在接收端解密数据时，它会回到`2097152`字节长度并将其写入文件。我已经向自己证明了它确实可以加密和解密数据。

在足够小的文件上，从原始文件到发件人的文件大小似乎完全相同。然而，当我增加更大的文件大小时，存在一个递减。在大小为 的视频文件（来自 Windows 7 安装的 Wildlife.wmv）上`26,246,026 bytes`，我收到的是`26,246,218 bytes`.

为什么会有这种大小差异？我在这里做错了什么？

这是我的一些代码。

对于我的加密，我使用以下类来加密或解密，以字节数组的形式返回结果。

```
public class AesCryptor
{
    public byte[] Encrypt(byte[] data, byte[] key, byte[] iv)
    {
        using (SymmetricAlgorithm aes = new AesManaged())
        {
            aes.Key = key;
            aes.IV = iv;
            aes.Padding = PaddingMode.PKCS7;
            aes.Mode = CipherMode.CBC;

            using (ICryptoTransform encryptor = aes.CreateEncryptor(key, iv))
            {
                return Crypt(data, key, iv, encryptor);
            }
        }
    }

    public byte[] Decrypt(byte[] data, byte[] key, byte[] iv)
    {
        using (SymmetricAlgorithm aes = new AesManaged())
        {
            aes.Key = key;
            aes.IV = iv;
            aes.Padding = PaddingMode.PKCS7;
            aes.Mode = CipherMode.CBC;

            using (ICryptoTransform decryptor = aes.CreateDecryptor(key, iv))
            {
                return Crypt(data, key, iv, decryptor);
            }
        }
    }

    private byte[] Crypt(byte[] data, byte[] key, byte[] iv, ICryptoTransform transform)
    {
        using (MemoryStream memoryStream = new MemoryStream())
        {
            using (CryptoStream cryptoStream = new CryptoStream(memoryStream, transform, CryptoStreamMode.Write))
            {
                cryptoStream.Write(data, 0, data.Length);
                cryptoStream.FlushFinalBlock();
            }
            return memoryStream.ToArray();
        }
    }
} 
```

文件的发送者正在使用此代码加密数据（在私有对称密钥握手之后）（以及更多与实际加密过程无关的内容。注意 chunkedFile.NextChunk()。这调用了一个方法在为我进行文件分块的类上，返回 2mb 块大小，除非最终大小更小。

```
 byte[] buffer;
        byte[] iv = new byte[symmetricEncryptionBitSize / 8];
        using (var rngCrypto = new RNGCryptoServiceProvider())
            rngCrypto.GetBytes(iv);

        AesCryptor cryptor = new AesCryptor();

        buffer = cryptor.Encrypt(chunkedFile.NextChunk(), symmetricPrivateKey, iv); 
```

下面的代码是文件的接收者使用的（不是全部，这是与数据解密有关的）。数据正在写入文件流（`writer`）。

```
 FileMessage message = hostChannel.ReceiveFile();
                    moreChunks = message.FileMetaData.MoreChunks;

                    UpdateTotalBytesTransferred(message);

                    writer.BaseStream.Position = filePosition;

                    byte[] decryptedStream;

                    // Copy the message stream out to a memory stream so we can work on it afterwards.
                    using (var memoryStream = new MemoryStream())
                    {
                        message.ChunkData.CopyTo(memoryStream);
                        decryptedStream = cryptor.Decrypt(memoryStream.ToArray(), symmetricPrivateKey, message.FileMetaData.InitializationVector);
                    }

                    writer.Write(decryptedStream); 
```

顺便说一句，如果需要，NextChunk 是一个非常简单的方法。

```
 public byte[] NextChunk()
    {
        if (MoreChunks) // If there are more chunks, procede with the next chunking operation, otherwise throw an exception.
        {
            byte[] buffer;
            using (BinaryReader reader = new BinaryReader(File.OpenRead(FilePath)))
            {
                reader.BaseStream.Position = CurrentPosition;
                buffer = reader.ReadBytes((int)MaximumChunkSize);
            }
            CurrentPosition += buffer.LongLength; // Sets the stream position to be used for the next call.

            return buffer;
        }
        else
            throw new InvalidOperationException("The last chunk of the file has already been returned.");
    } 
```

**编辑：**似乎对于每个传输的块，因此每次加密，我都获得了 16 字节的文件大小。极小的文件大小不会发生这种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T06:26:58.557

好吧，我解决了这个问题。

事实证明，我在消息数据中发送`chunkLength`了加密的块数据。因此，对于我发送的每个块，即使我解密并写入了正确的文件数据，我也会将流位置推进加密数据的长度。这意味着每次我解密时，当传输超过 1 个块时（这就是为什么只有 1 个块大小的小文件没有问题）我在文件大小上增加了 16 个字节。

帮助我的人可能无法弄清楚这一点，因为我没有在客户端或服务器端包含所有数据来查看这一点。但谢天谢地，我设法自己回答了这个问题。

在发件人方面，我正在像这样创建我的 FileMessage。

```
 FileMessage message = new FileMessage();
            message.FileMetaData = new FileMetaData(chunkedFile.MoreChunks, chunkedFile.ChunkLength, chunkedFile.CurrentPosition, iv);
            message.ChunkData = new MemoryStream(buffer); 
```

如果你看到`FileMetaData`构造函数的第二个参数，我传入的`chunkedFile.ChunkLength`应该是块的长度。我对加密的块数据执行此操作，导致发送的块长度不正确。

另一方面，客户正在接收这些额外信息。如果你看接近尾声，你会看到代码`filePosition += message.FileMetaData.ChunkLength;`。我正在使用该错误`chunkLength`来推进文件位置。事实证明，甚至不需要设置 streamPosition。

```
using (BinaryWriter writer = new BinaryWriter(File.OpenWrite(fileWritePath)))
            {
                writer.BaseStream.SetLength(0);

                while (moreChunks)
                {
                    FileMessage message = hostChannel.ReceiveFile();
                    moreChunks = message.FileMetaData.MoreChunks;

                    UpdateTotalBytesTransferred(message);

                    writer.BaseStream.Position = filePosition;

                    byte[] decryptedStream;

                    // Copy the message stream out to a memory stream so we can work on it afterwards.
                    using (var memoryStream = new MemoryStream())
                    {
                        message.ChunkData.CopyTo(memoryStream);
                        Debug.WriteLine("Received Encrypted buffer Length: " + memoryStream.Length);
                        decryptedStream = cryptor.Decrypt(memoryStream.ToArray(), symmetricPrivateKey, message.FileMetaData.InitializationVector);
                        Debug.WriteLine("Received Decrypted buffer Length: " + decryptedStream.Length);
                    }

                    writer.Write(decryptedStream);

                    TotalBytesTransferred = message.FileMetaData.FilePosition;

                    filePosition += message.FileMetaData.ChunkLength;
                }

                OnTransferComplete(this, EventArgs.Empty);
                StopSession();
            } 
```

**如此简单的错误，但根本没有迅速向我扑来。**

# android - ArrayAdapter - 每 10 篇文章的广告效果很好，但取代了一篇文章

> ID：14351667
> 
> 赞同：0
> 
> 时间：2013-01-16T05:00:31.167
> 
> 标签：android, android-arrayadapter

我有一个文章列表，每 10 篇文章有一个广告。问题是 - 而不是广告被添加到列表中，它实际上取代了一篇文章。

**正在发生的事情的示例：**

```
- ad //taking the place of article 1
- article 2
- article 3
- article 4
...
- article 9
- article 10
- ad //taking the place of article 11
- article 12 
```

我让它在每 X 篇文章中展示广告的方式是`ArrayAdapter`：

```
@Override
//determines which view type I want to use
public int getItemViewType(int position) {
    this.currentLayout = position % 11 == 0 ? 1 : 0;
    return this.currentLayout;
}

@Override
//says there are 2 different view types I want to use
public int getViewTypeCount() {
    return 2;
} 
```

所以 - 我想现在我看到它发生了，这是有道理的为什么，但是......我怎样才能让广告出现然后下一篇文章？

**以前的尝试：**

我以前在我的 XML 中将文章放在文章本身的下方，然后根据 # 将其打开/关闭，但被告知这是过多的 XML（并且无论如何都有一些问题）。

我还尝试在显示广告时将文章添加为下一个项目，但是 - 如果我不是这样的菜鸟，我会立即意识到这不起作用（它会重复文章 - 很多）：

```
public int getItemViewType(int position) {
    //...
    if(this.currentLayout == 1) this.insert(this.getItem(position), position);
    //... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T06:00:51.553

退房[`MergeAdapter`](https://github.com/commonsguy/cwac-merge)。它允许您将适配器和视图混合到一个统一的适配器中，并负责为您校正位置。您可能必须创建多个实例`ArrayAdapter`来创建部分，然后像有部分标题一样放置广告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T05:04:48.990

> 我怎样才能让广告出现，然后下一篇文章？

在您的适配器中，您需要覆盖`getCount()`以考虑广告，然后进行调整`position`以`getView()`不加载错误的数据。

在您的示例中：

*   `getCount()`应该在您的示例中返回返回 12 篇文章 + 2 个广告 = 14 行。
*   `getView()``position`当你打电话时应该调整一下`getItem()`，也许：（`getItem(position - (position / 11) + 1)`但老实说我很累我的数学可能会很差。）

# c++ - 右值引用：为什么不隐式移动右值？

> ID：14351669
> 
> 赞同：10
> 
> 时间：2013-01-16T05:00:37.957
> 
> 标签：c++, c++11, rvalue-reference

在关于 C++ 右值参考 ( [http://www.artima.com/cppsource/rvalue.html](http://www.artima.com/cppsource/rvalue.html) ) 的 Artima 文章中，有一句话：*这就是为什么在传递给基类时有必要说 move(x) 而不仅仅是 x . 这是移动语义的一个关键安全特性，旨在防止从某个命名变量意外移动两次。*

我想不出这样的双招可以执行的情况。你能举个例子吗？换句话说，如果所有成员`T&&`都是右值引用而不仅仅是引用，会出现什么问题？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-16T05:15:08.087

考虑这种情况：

```
void foo(std::string x) {}
void bar(std::string y) {}

void test(std::string&& str)
{
    // to be determined
} 
```

我们想调用`foo`with `str`，然后调用`bar`with `str`，两者都具有相同的值。最好的方法是：

```
foo(str); // copy str to x
bar(std::move(str)); // move str to y; we move it because we're done with it 
```

这样做是错误的：

```
foo(std::move(str)); // move str to x
bar(std::move(str)); // move str to y...er, except now it's empty 
```

因为在第一次移动之后， 的值`str`是未指定的。

所以在右值引用的设计中，这种隐含的举动是不存在的。如果是这样，我们上面最好的方法就行不通了，因为第一次提到的`str`是`std::move(str)`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-16T08:24:00.533

我的看法是，如果我们有一些右值引用 x：

```
T&& x = ...; 
```

我们使用 x 作为参数调用了一些函数：

```
f(x) 
```

我们需要以某种方式告诉 f 它是否会损坏 x（或“获得 x 的所有权”，或“是最后一个使用 x 的客户端”）。

一种设计方法是限定每个调用：

```
f(yours_now(x)) // ok to damage
f(still_mine(x)) // dont damage 
```

并使不合格的呼叫非法。

另一种方法是将一种方式设为默认方式：

任何一个：

```
f(yours_now(x)) // ok to damage
f(x) // dont damage 
```

或者

```
f(x) // ok to damage
f(still_mine(x)) // dont damage 
```

因此，如果我们同意限定每次使用都过于庞大，我们应该默认使用一种方式，哪种方式最好？好吧，让我们看看在这两种情况下意外选择默认值的成本：

在第一种情况下，损坏是可以的，但我们不小心说它不是。在这种情况下，我们会失去性能，因为制作了不必要的副本，但除此之外没什么大不了的。

在第二种情况下，损坏物体是不行的，但我们不小心说它是。这可能会导致程序中难以检测到逻辑错误，因为 x 现在在 f 返回时处于损坏状态，但作者预计不会如此。

所以第一种情况是因为它“更安全”而被选择的。

# jquery - 为什么我在使用 jQuery 插件后得到“$ is undefined”？

> ID：14351673
> 
> 赞同：1
> 
> 时间：2013-01-16T05:01:03.033
> 
> 标签：jquery, jquery-plugins

> **可能重复：**
> [jQuery 美元符号未定义](https://stackoverflow.com/questions/13482022/jquery-dollar-sign-is-undefined)

我想知道为什么会`TypeError: $ is undefined`发生错误，我知道替代方法是使用 jQuery 来解决问题，为什么 $ 是未定义的，即使在使用正确的 jQuery 插件之后也是如此。

谁能给我解释一下，我知道要使用的替代方案以及为什么该替代方案有效。请任何人解释一下。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-16T05:10:59.480

如果您的意图是在调用时使用 jQuery 库`$()`，那么`$`jQuery 库在加载时通​​常会定义一个函数。如果在您尝试使用该符号时未定义该符号，则有以下可能性：

1.  您尚未将 jQuery 库加载到出现此错误的页面中。
2.  您试图在`$`加载 jQuery 之前引用该函数，在这种情况下，您需要在页面中更早地移动 jQuery 库，或者在加载 jQuery 之后移动有问题的代码。
3.  调用了一些 jQuery 代码[`jQuery.noConflict()`](http://api.jquery.com/jQuery.noConflict/)，导致`$`符号未定义。在这种情况下， using`jQuery()`将代替`$()`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T05:03:02.037

$ 只是一个指向 jQuery 对象的变量。您的 jQuery 库没有定义。您可以将其更改为指向您的对象或函数。以下示例将`$`指出 function `myfun`。

```
$ = myfun;

function myfun()
{
 alert("myfun");
}

$(); 
```

**[现场演示](http://jsfiddle.net/rajaadil/Mpnew/1/)**

> 许多 JavaScript 库使用 $ 作为函数或变量名，就像 jQuery 一样。在 jQuery 的例子中，$ 只是 jQuery 的别名，所以所有功能都可以在不使用 $ 的情况下使用。如果您需要在 jQuery 旁边使用另一个 JavaScript 库，请通过调用[$.noConflict()](http://api.jquery.com/jQuery.noConflict/)将 $ 的控制权返回给另一个库。$ 的旧引用在 jQuery 初始化期间被保存；noConflict() 只是恢复它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T05:17:16.827

你可以做的是：

*   要么替换 the`$`中`jQuery`的 the ，`script which causing the error`要么定义`$`一些变量并将其与 this 的替代项一起使用。

我的意思是这样：

```
 jQuery(document).ready(function(){
  jQuery('selector').click(function(){
     jQuery('other_selector').hide();
  });
}); 
```

或者这样：

```
var jQ = $;

jQ(document).ready(function(){
  jQ('selector').click(function(){
     jQ('other_selector').hide();
  });
}); 
```

或者还有其他用途`jQuery.noConflict()`。

`Try this and see if this helps.`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-16T05:06:23.063

您必须在页面上包含 jquery 文件（min.js 或 jquery-latest.js）

# android - 将数据从服务发送到活动 Android

> ID：14351674
> 
> 赞同：12
> 
> 时间：2013-01-16T05:01:06.677
> 
> 标签：android, android-activity, android-service

我正在构建一个使用服务进行播放的音乐播放器。我有一个控制（播放、暂停、下一步、...）服务的活动 UI。当按下下一个或上一个按钮时，我想从我的服务更新 UI。我想传递一个整数值。这是我的代码：

我使用信使进行通信。我的服务中的代码如下所示：

```
enum Event {
    NextSongChanged, CurrentPlayingSong
};

public synchronized void registerHandler(Messenger m) {
    clients.add(m);
}

private void emit(Event e) {
    for (Messenger m : clients) {
        try {
            m.send(Message.obtain(null, e.ordinal()));
        } catch (RemoteException exception) {
            /* The client must've died */
            clients.remove(m);
        }
    }
} 
```

我在单击下一个按钮时调用的方法：

```
public synchronized void playnext() {
    reset();
    if(songIndex <  (songsList.size() - 1)) {
        songIndex += 1;
        playSong(songIndex);
    } else {
        songIndex = 0;
        playSong(songIndex);
    }
    emit(Event.NextSongChanged);
} 
```

一旦我触发 NextSongChanged 事件，我想将“songIndex”变量传递到我的活动中。关于如何实现这一目标的任何想法？

我处理事件的活动代码：

```
private Messenger playerMessenger = new Messenger(new Handler() {
    @Override
    public void handleMessage(Message msg) {
        switch (MyService.Event.values()[msg.what]) {
            case NextSongChanged:
                //String songTitle = songsList.get(currentSongIndex+1).get("songTitle");
                //currentSongIndex += 1;
                //songTitleLabel.setText(songTitle);
                //updatePlaying();
                break;

            case CurrentPlayingSong:
                break;
        }
    }
}); 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2015-05-14T10:46:57.343

示例代码希望对其他人有所帮助

**1.**设置Handler（接收消息）和Messenger（通信）`MainActivity.java`

```
Messenger msgService;
boolean isBound;

ServiceConnection connection = new ServiceConnection() {

    @Override
    public void onServiceDisconnected(ComponentName name) { isBound = false; }

    @Override
    public void onServiceConnected(ComponentName name, IBinder service) {
        isBound = true;
        msgService = new Messenger(service);
    }
};

public void sendMessage(View view) {
    if (isBound) {
        try {
            Message message = Message.obtain(null, MessangerService.MESSAGE, 1, 1);
            message.replyTo = replyMessenger;

            Bundle bundle = new Bundle();
            bundle.putString("rec", "Hi, you hear me");
            message.setData(bundle);

            msgService.send(message); //sending message to service

        } catch (RemoteException e) {
            e.printStackTrace();
        }
    }
}
//setting reply messenger and handler
Messenger replyMessenger = new Messenger(new HandlerReplyMsg());

class HandlerReplyMsg extends Handler {
    @Override
    public void handleMessage(Message msg) {
        super.handleMessage(msg);
        String recdMessage = msg.obj.toString(); //msg received from service
        toast(recdMessage);
    }
} 
```

**2.**设置服务类`MessengerService.java`

```
Messenger replyMessanger;
final static int MESSAGE = 1;

class IncomingHandler extends Handler {

    @Override
    public void handleMessage(Message msg) {

        if (msg.what == MESSAGE) {
            Bundle bundle = msg.getData();
            toast(bundle.getString("rec"));//message received
            replyMessanger = msg.replyTo; //init reply messenger
            doSomething();
        }
    }
}

private void doSomething() {
    // do stuff

    if (replyMessanger != null)
        try {
            Message message = new Message();
            message.obj = "Yes loud and clear";
            replyMessanger.send(message);//replying / sending msg to activity
        } catch (RemoteException e) {
            e.printStackTrace();
        }
}
Messenger messenger = new Messenger(new IncomingHandler());

@Override
public IBinder onBind(Intent intent) {
    return messenger.getBinder();
} 
```

确保您声明了 Service in`manifest`和`binding/unbinding`Service in 活动。

# php - 使用 mysql 和 php 搜索

> ID：14351683
> 
> 赞同：0
> 
> 时间：2013-01-16T05:02:13.393
> 
> 标签：php, mysql

请访问此链接：[http ://tndoctors.in/doctors.php](http://tndoctors.in/doctors.php)

在那六个下拉框中没有....（州，地区，位置，医学，专业，等级）

我将所有数据从 SQL DB 提取到所有下拉框。

我创建了像

```
STATE (state id & state name) [st.id as primary key]

DISTRICT(district id , district name and used state id as foreign key here)

location (location id , location name and used district id as foreign key here) 
```

医药、专业、等级同上....

最后我创建了一张桌子

```
DOCTOR_DETAIL ( name , address , reg.no , contact details , age , and specialty , grade , medicine , district and state) 
```

对于专业、年级、医学、地区和州，我使用上表 id作为表`(primary key)`中的外键`doctor _detail`

例如，如果我选择

州：TAMILNADU 区：COIMBATORE 位置：一些数据医学：同种疗法专业：心脏外科医生等级：一些数据....

如果我从下拉列表中选择以上所有内容...并单击“开始”按钮...

我必须得到可能的搜索结果

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T05:07:49.300

加入表是最好的选择

```
SELECT * FROM DOCTOR_DETAIL
LEFT JOIN DISTRICT ON  DISTRICT.district id = DOCTOR_DETAIL.district id
LEFT JOIN STATE ON STATE.state_id = DOCTOR_DETAIL.state_id
..for all tables required
WHERE DISTRICT.name = '".$district_name."' AND SATET.name = '".$state_name."'
...For all filters that you reqiored 
```

希望这可以帮助 ：）

# javascript - THREE.js - 相对于具有旋转/缩放父项的屏幕移动对象

> ID：14351686
> 
> 赞同：3
> 
> 时间：2013-01-16T05:02:43.680
> 
> 标签：javascript, three.js, webgl

在 THREE.js 中，我试图根据鼠标位置在屏幕上移动对象。在看了一些[例子](http://jabtunes.com/labs/3d/spline3editor.html)之后，它似乎很困难。这是我从一个示例中借来的一些代码，这些示例主要满足我的需要：

```
function mouseMove(e){
    mouse2D.x = ( (e.pageX-canvas.offsetParent.offsetLeft) / canvas.clientWidth ) * 2 - 1;
    mouse2D.y = - ( (e.pageY-canvas.offsetParent.offsetTop) / canvas.clientHeight ) * 2 + 1;

    if (selected) {
      var ray = projector.pickingRay(mouse2D, PGL._camera).ray;
      var targetPos = ray.direction.clone().addSelf(ray.origin);
      targetPos.subSelf(_offset);

      obj.position.x = initPos.x + targetPos.x;
      obj.position.y = initPos.y + targetPos.y;
    }
  } 
```

这适用于在场景中移动直接子级。问题是试图移动具有旋转和/或缩放的父对象的对象。你会怎么处理呢？将对象`matrixRotationWorld`应用于运动可能吗？我仍在努力解决这些问题。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T10:26:40.607

请参阅这些示例，它们可以帮助您：

[http://mrdoob.github.com/three.js/examples/misc_controls_fly.html](http://mrdoob.github.com/three.js/examples/misc_controls_fly.html)

或者

[http://mrdoob.github.com/three.js/examples/webgl_interactive_voxelpainter.html](http://mrdoob.github.com/three.js/examples/webgl_interactive_voxelpainter.html)

# sql - 在 oracle SQL 中使用 insrt 函数遇到“ORA-00907：缺少右括号”

> ID：14351688
> 
> 赞同：0
> 
> 时间：2013-01-16T05:03:03.590
> 
> 标签：sql, oracle, ora-00907

我正在尝试测试这个 sql 查询，但我总是遇到一个错误，指出第 1 行缺少右括号。我猜它与 INSTR 函数有关，因为如果我用列名替换 INSTR 函数，我的查询就可以正常工作。

```
* row 1 
SELECT INSTR(diary.entry, 'service', 1, 1 > 0)
FROM   diary journal
WHERE  journal.req_time >= '00:00:00'
       AND journal.req_time <= '00:10:59'; 
```

有人愿意帮忙吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T05:05:04.447

我觉得是这样的

```
SELECT INSTR(diary.entry, 'service', 1, 1) > 0 
```

*   [指令功能](http://docs.oracle.com/cd/B19306_01/server.102/b14200/functions068.htm)
*   [INSTR 函数*示例*](http://www.techonthenet.com/oracle/functions/instr.php)

# java - 在没有任何标签引用的情况下读取 xml？

> ID：14351689
> 
> 赞同：0
> 
> 时间：2013-01-16T05:03:04.680
> 
> 标签：java, xml

在我当前的 xml 结构中

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">

<properties>

    <entry key="Azmth Interval">30</entry>

    <entry key="Lowest Elevation">true</entry>

    <entry key="Offset Latitude">18.89</entry>

    <entry key="Plot Size">500</entry>

    <entry key="Offset Display Range">250.0</entry>

</properties> 
```

我使用标签名称（硬编码）作为检索值的参考。

我是否可以在没有任何参考的情况下空白读取 xml，因为我已将数据写入 HDF 复合数据集，就像复制粘贴一样。

# c# - EF5 Code First（无法从用法中推断出错误）

> ID：14351690
> 
> 赞同：0
> 
> 时间：2013-01-16T05:03:11.733
> 
> 标签：c#, linq, entity-framework, ef-code-first, entity-framework-5

好的，我一直在拔头发，因为我根本无法建立多对多的关系。我有以下两个模型：

```
public class UserProfile
{
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int UserId { get; set; }
    public string UserName { get; set; }
    public string CompanyName { get; set; }
    public string FirstName { get; set; }
    public string Lastname { get; set; }
    public string EmailAddress { get; set; }
    public string PhoneNumber { get; set; }
    public bool? ChangePassword { get; set; }
    public bool? Deletable { get; set; }

    //Add more Properties for more fields

    public virtual IQueryable<CompanyInformation> ParentCompany { get; set; }
} 
```

和

```
public class CompanyInformation
{
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int id { get; set; }

    [DisplayName("Company Name:")]
    public string companyName { get; set; }

    [DisplayName("Website Address:")]
    [Url(ErrorMessage="The Website field is not a valid fully-qualified http, https, or ftp URL. (Example: http://www.website.com)")]
    public string website { get; set; }
    public string contactTitle { get; set; }

    [DisplayName("Contact First Name:")]
    public string contactFirstName { get; set; }
    //[Required]
    [DisplayName("Contact Last Name:")]
    public string contactLastName { get; set; }

    [Phone]
    [DisplayName("Phone Number:")]
    public string contactPhoneNumber { get; set; }

    [DisplayName("Address Display?")]
    public bool displayAddress { get; set; }
    [DisplayName("Phone Number?")]
    public bool displayPhoneNumber { get; set; }

    [DisplayName("Address 1:")]
    public string address1 { get; set; } 
    [DisplayName("Address 2:")]
    public string address2 { get; set; }

    [DisplayName("City:")]
    public string city { get; set; }

    [DisplayName("State:")]
    public string state { get; set; }

    [DisplayName("Zip/Postal Code:")]
    public string zipCode { get; set; }

    [DisplayName("Search Engine?")]
    public bool allowSearchEngines { get; set; }

    //Navigation Property
    public virtual IQueryable<UserProfile> CompanyUsers{ get; set; }

} 
```

我正在尝试在这两者之间建立多对多的关系，但我无法弄清楚如何正确地做到这一点。我应该提一下，我对 EF Code First 非常陌生。我的上下文类如下所示：

```
public class myDB : DbContext
{
    public SchedulerDB()
        : base("DefaultConnection")
    {

    }

    public DbSet<UserProfile> UserProfiles { get; set; }
    public DbSet<CompanyInformation> Companies { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Entity<UserProfile>().HasMany(e => e.ParentCompanies).WithMany(e => e.CompanyUsers);            
    }

} 
```

好的，只要我添加上面的模型构建器，我就会收到以下错误：

```
The type arguments for method 'System.Data.Entity.ModelConfiguration.EntityTypeConfiguration<Scheduler.Model.UserProfile>.HasMany<TTargetEntity>(System.Linq.Expressions.Expression<System.Func<Scheduler.Model.UserProfile,System.Collections.Generic.ICollection<TTargetEntity>>>)' cannot be inferred from the usage. Try specifying the type arguments explicitly.  C:\Users\Hiva\Documents\Project\ToDo\Infrastructure\myDB.cs 
```

我究竟做错了什么？我似乎找不到任何以不同方式使用模型构建器来实现两个表之间的多对多关系的示例。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T05:06:15.920

您应该将 ICollection 用于导航属性：

```
ICollection<UserProfile> CompanyUsers{ get; set; } 
```

和

```
ICollection<UserProfile> ParentCompanies{ get; set; } 
```

代替`IQueriable`

# javascript - if 语句在我的 forloop 中不起作用

> ID：14351696
> 
> 赞同：-1
> 
> 时间：2013-01-16T05:04:05.663
> 
> 标签：javascript

目前我正在研究 Java 脚本项目。该项目用于检查从 UDDF 文件中选择的值与 UDDF 文件中的全部值。但用于比较的 if 语句不起作用。我已将我的代码放在下面

```
function parseUddf(){
var myArray=new Array("null","airportID","airportSiteNo","faaRgn","uddfVer","null","airportName","verificationDate",
"city","state","horizontalelevationdatum","horiAccuracy","elevAccuracy","orthoDatum","orthoAccuracy",
"magDec","verificationDate","airportOrthoElev","airportEllipsoidElev","airportElevationLoc",
"verificationDate","towerFloorOrthoElev","towerFloorEllipElev","verificationDate","arpLatitude","arpLongitude");
var selt=document.getElementById("textdis").value;
var x = document.getElementById("uddf").value;
x = x.split("@");
var x0 = x[0];
x0 = x0.split("|");
var j=x0.length;
alert(j);
for(var i=1;i<x0.length;i++){
        alert("selt="+selt.toString());
    if(selt.toString()==x0[i])
 {
          alert("success");
          alert("i="+i);
          alert(myArray[i]);
//document.getElementById("textdistitleid").value=myArray[i];
 break;
    }

    }
} 
```

UDDF 文件值为：

|FAI |50219.A |AAL |1.07| |费尔班克斯国际机场 |1592011| |费尔班克斯 |阿拉斯加 | |NAD83 |5 厘米 |15 厘米 |NAVD88 |25 厘米 | |-20.4|1592011| | 439.0| 470.0|20R+3990|1592011| | 529.0| | | | 644854.4|-1475123.2|

我需要你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T05:31:59.417

`==`您可以使用 .equals()而不是使用：

```
selt.toString().trim().equals(x0[i].trim()) 
```

[您可以从此处](https://stackoverflow.com/questions/498970/how-do-i-trim-a-string-in-javascript)获取 javascript 的 trim() 函数

# php - mysql在oop php中选择

> ID：14351700
> 
> 赞同：1
> 
> 时间：2013-01-16T05:04:34.997
> 
> 标签：php, mysql, oop

我在 OOP PHP 中选择 MYSQL 时遇到问题。我不知道怎么写正确。我的代码是：

```
$sql = "SELECT name_mcategory 
            FROM web_main_category WHERE userid=('".$userid."')";
    $result = mysql_query($sql);
    $e=0;
    $maincat=array ();
    while($data=mysql_fetch_array($result))
    { 
        $maincat[$e]=$data['name_mcategory'];
        $e++;

    } 
```

如何在 OOP 中编写它？我已经尝试过了，但它不起作用。

```
class nweb {
var $userid;
var $mcategory;

function Getmain_category () {

$rs = mysql_query("SELECT name_mcategory 
            FROM web_main_category WHERE userid=$this->userid");
  }
$this->tab=mysql_fetch_object($rs);
}
   } 
```

在打印页面

```
$mcat = new nweb();
$mcat->getmain_category ();
$mcat->mcategory=$this->name_mcategory; 
```

如何获取 $maincat[$e]=$data['name_mcategory'] 之类的数据；

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T05:21:34.817

如果要使用 OOP，请使用 OOP DB 层，例如`PDO`：

```
class nweb extends PDO {

  public $userid, $mcategory;

  public function __construct($hostname, $dbname, $username, $password) {
    parent::__construct($hostname,$dbname,$username,$password);
  }

  public function getmain_category() {
     return $this->query("SELECT name_mcategory FROM web_main_category WHERE userid = {$this->userid}")->fetch();
  }
}

$mcat = new nweb('hostname', 'dbname', 'username', 'password');
var_dump($mcat->getmain_category()); 
```

注意：您添加了一些错误处理，请参阅[`pdo::query`](http://php.net/manual/en/pdo.query.php).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T05:11:18.907

在 OOP 中，我们通常创建一个单独的类来处理数据库操作。例如Database.php，它执行查询并将结果返回给Category.php 或使Category 继承Database.php。如果您想要更好的方法，请使用[PHP Activerecord。](http://www.phpactiverecord.org/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T05:12:07.513

像这样检查

```
 class nweb {
   var $userid;
   var $mcategory;

  function getmain_category () {

             $rs = mysql_query("SELECT name_mcategory 
                    FROM web_main_category WHERE userid = {$this->userid}");

             return mysql_fetch_object($rs);
  }

}

//print page

   $mcat = new nweb();
   $data = $mcat->getmain_category ();

   $e=0;
   $maincat=array ();
   while($data=mysql_fetch_array($result))
   { 
        $maincat[$e]=$data['name_mcategory'];
        $e++;
   } 
```

# python - 将 Python 记录为 MS Word 可读格式

> ID：14351702
> 
> 赞同：0
> 
> 时间：2013-01-16T05:04:37.307
> 
> 标签：python, ms-word, doc

我正在尝试为一个没有特别详细记录的小型 Python 代码库生成一个开发后的“接口控制文档”。为了适应就地文档架构，它需要作为平面 Word 文档提供。它主要需要从代码中提取出来。

到目前为止，我唯一的候选人是 doxygen 的 .rtf 功能。doxygen 对 Python 来说有点马马虎虎。rtf 也是如此。所以。任何人都可以提出更好的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T05:22:46.353

python 社区是[ReST](http://docutils.sourceforge.net/rst.html)格式的坚定支持者。在不得不处理大量的word文档之后，我已经爱上了它。[Sphinx](http://sphinx-doc.org/)是一个很棒的文档工具，可用于记录您的项目，并由[http://readthedocs.org](http://readthedocs.org)使用，尽管对于一个小项目来说设置它可能有点多。

因此，我建议使用[ReST 编写代码，并通过 pandoc](http://johnmacfarlane.net/pandoc/)[查看](http://docutils.sourceforge.net/rst.html)它如何转换为单词。

实际上，[pandoc](http://johnmacfarlane.net/pandoc/)支持将以下格式转换为 word 和许多其他格式，因此如果您想避免使用 word 编写文档，您可以使用多种格式编写文档：

*   降价
*   重构文本 (ReST)
*   纺织品
*   HTML
*   文档书
*   乳胶

# java - 调用 DefaultValidator.getValidFileName() 时出现 NoSuchMethoException

> ID：14351705
> 
> 赞同：1
> 
> 时间：2013-01-16T05:04:54.997
> 
> 标签：java, xss, esapi

我正在尝试使用 ESAPI 提供的 jar (esapi-2.0_rc11) 中 DefaultValidator 类的 getValidFileName (String, String, list, boolean) 方法来验证文件名。但是在运行时得到没有这样的方法异常。

这是我的代码：

```
public static String getValidFileName(String input,String[] strFileExtns, Boolean isNullable) throws Exception
{   
    List <String> fileExtnsList = new ArrayList <String>();

if (strFileExtns != null && strFileExtns.length > 0)
    for(int i=0; i<strFileExtns.length; i++)
    fileExtnsList.add(strFileExtns[i]);

    return new DefaultValidator().getValidFileName("FileNameValidation", input, fileExtnsList, isNullable);
} 
```

我正进入（状态 `java.lang.NoSuchMethodError:org/owasp/esapi/reference/DefaultValidator.getValidFileName(Ljava/lang/String;Ljava/lang/String;Ljava/util/List;Z)Ljava/lang/String;`

jar中的代码：

```
public String getValidFileName(String context, String input, List<String> allowedExtensions, boolean allowNull)
    throws ValidationException, IntrusionException
  {
    if ((allowedExtensions == null) || (allowedExtensions.isEmpty())) {
      throw new ValidationException("Internal Error", "getValidFileName called with an empty or null list of allowed Extensions, therefore no files can be uploaded");
    }

    String canonical = "";
    try
    {
      if (isEmpty(input)) {
        if (allowNull) return null;
        throw new ValidationException(context + ": Input file name required", "Input required: context=" + context + ", input=" + input, context);
      }

      canonical = new File(input).getCanonicalFile().getName();
      getValidInput(context, input, "FileName", 255, true);

      File f = new File(canonical);
      String c = f.getCanonicalPath();
      String cpath = c.substring(c.lastIndexOf(File.separator) + 1);

      if (!(input.equals(cpath)))
        throw new ValidationException(context + ": Invalid file name", "Invalid directory name does not match the canonical path: context=" + context + ", input=" + input + ", canonical=" + canonical, context);
    }
    catch (IOException e)
    {
      throw new ValidationException(context + ": Invalid file name", "Invalid file name does not exist: context=" + context + ", canonical=" + canonical, e, context);
    }

    Iterator i = allowedExtensions.iterator();
    while (i.hasNext()) {
      String ext = (String)i.next();
      if (input.toLowerCase().endsWith(ext.toLowerCase()))
        return canonical;
    }

    throw new ValidationException(context + ": Invalid file name does not have valid extension ( " + allowedExtensions + ")", "Invalid file name does not have valid extension ( " + allowedExtensions + "): context=" + context + ", input=" + input, context);
  } 
```

有人请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T07:16:04.513

java.lang.NoSuchMethodError 错误通常是由依赖问题引起的。如果您使用的是 maven（我假设您可能是，因为它经常会出现此错误），请按如下方式排除错误：

尝试在命令行上发出“mvn dependency:tree -Dverbose”并检查包含 org/owasp/esapi/reference/DefaultValidator 的库是否是您想要的版本。如果没有，您可以使用 excludes 标记从包含不正确版本的依赖项中排除不正确的版本。

还要检查生成的类路径是否以正确的顺序列出了依赖项。

# grails - 使用 CAS 进行用户身份验证为 grails 应用程序中的 groovy 部署新战争时出现问题

> ID：14351709
> 
> 赞同：0
> 
> 时间：2013-01-16T05:05:22.747
> 
> 标签：grails, spring-security, cas

我面临一个问题。我已使用 CAS 对我的应用程序的用户登录进行身份验证。每次我部署应用程序战争和浏览时，我都会收到一个休眠异常错误，并且在连续刷新 5,6 次后出现登录页面。我无法跟踪问题。请帮忙。

这是日志-

```
Could not synchronize database state with session
org.hibernate.HibernateException: No Hibernate Session bound to thread, and configuration does not allow creation of non-transactional one here
        at org.springframework.orm.hibernate3.SpringSessionContext.currentSession(SpringSessionContext.java:63)
        at org.hibernate.impl.SessionFactoryImpl.getCurrentSession(SessionFactoryImpl.java:574)
        at org.codehaus.groovy.grails.orm.hibernate.validation.HibernateDomainClassValidator.validate(HibernateDomainClassValidator.java:66)
        at org.codehaus.groovy.grails.validation.GrailsDomainClassValidator.validate(GrailsDomainClassValidator.java:126)
        at org.codehaus.groovy.grails.orm.hibernate.metaclass.ValidatePersistentMethod.doInvokeInternal(ValidatePersistentMethod.java:117)
        at org.codehaus.groovy.grails.orm.hibernate.metaclass.AbstractDynamicPersistentMethod.invoke(AbstractDynamicPersistentMethod.java:59)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite$PojoCachedMethodSite.invoke(PojoMetaMethodSite.java:188)
        at org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite.call(PojoMetaMethodSite.java:52)
        at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:132)
        at org.codehaus.groovy.grails.plugins.orm.hibernate.HibernatePluginSupport$_addValidationMethods_closure19.doCall(HibernatePluginSupport.groovy:484)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:90)
        at org.codehaus.groovy.runtime.metaclass.ClosureMetaMethod.invoke(ClosureMetaMethod.java:80)
        at org.codehaus.groovy.grails.orm.hibernate.support.ClosureEventListener.onPreUpdate(ClosureEventListener.java:264)
        at org.codehaus.groovy.grails.orm.hibernate.support.ClosureEventTriggeringInterceptor.onPreUpdate(ClosureEventTriggeringInterceptor.java:167)
        at org.hibernate.action.EntityUpdateAction.preUpdate(EntityUpdateAction.java:237)
        at org.hibernate.action.EntityUpdateAction.execute(EntityUpdateAction.java:88)
        at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:279)
        at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:263)
        at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:168)
        at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:321)
        at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:50)
        at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1027)
        at org.springframework.orm.hibernate3.HibernateAccessor.flushIfNecessary(HibernateAccessor.java:390)
        at org.springframework.orm.hibernate3.HibernateTemplate.doExecute(HibernateTemplate.java:407)
        at org.springframework.orm.hibernate3.HibernateTemplate.executeFind(HibernateTemplate.java:343)
        at org.codehaus.groovy.grails.orm.hibernate.metaclass.ListPersistentMethod.doInvokeInternal(ListPersistentMethod.java:53)
        at org.codehaus.groovy.grails.orm.hibernate.metaclass.AbstractStaticPersistentMethod.invoke(AbstractStaticPersistentMethod.java:64)
        at org.codehaus.groovy.grails.orm.hibernate.metaclass.AbstractStaticPersistentMethod.invoke(AbstractStaticPersistentMethod.java:57)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite$PojoCachedMethodSite.invoke(PojoMetaMethodSite.java:188)
        at org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite.call(PojoMetaMethodSite.java:52)
        at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:132)
        at org.codehaus.groovy.grails.plugins.orm.hibernate.HibernatePluginSupport$_addQueryMethods_closure45.doCall(HibernatePluginSupport.groovy:619)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:90)
        at groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:233)
        at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1058)
        at groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1070)
        at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:886)
        at groovy.lang.Closure.call(Closure.java:282)
        at org.codehaus.groovy.runtime.metaclass.ClosureStaticMetaMethod.invoke(ClosureStaticMetaMethod.java:59)
        at org.codehaus.groovy.runtime.callsite.StaticMetaMethodSite$StaticMetaMethodSiteNoUnwrapNoCoerce.invoke(StaticMetaMethodSite.java:148)
        at org.codehaus.groovy.runtime.callsite.StaticMetaMethodSite.call(StaticMetaMethodSite.java:88)
        at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:40)
        at org.codehaus.groovy.runtime.callsite.StaticMetaClassSite.call(StaticMetaClassSite.java:55)
        at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:120)
        at org.codehaus.groovy.grails.plugins.springsecurity.ReflectionUtils.loadAllRequestmaps(ReflectionUtils.groovy:72)
        at org.codehaus.groovy.grails.plugins.springsecurity.RequestmapFilterInvocationDefinition.loadRequestmaps(RequestmapFilterInvocationDefinition.java:64)
        at org.codehaus.groovy.grails.plugins.springsecurity.RequestmapFilterInvocationDefinition.reset(RequestmapFilterInvocationDefinition.java:51)
        at org.codehaus.groovy.grails.plugins.springsecurity.RequestmapFilterInvocationDefinition.initialize(RequestmapFilterInvocationDefinition.java:41)
        at org.codehaus.groovy.grails.plugins.springsecurity.AbstractFilterInvocationDefinition.findConfigAttributes(AbstractFilterInvocationDefinition.java:99)
        at org.codehaus.groovy.grails.plugins.springsecurity.AbstractFilterInvocationDefinition.getAttributes(AbstractFilterInvocationDefinition.java:81)
        at org.springframework.security.access.intercept.AbstractSecurityInterceptor.beforeInvocation(AbstractSecurityInterceptor.java:171)
        at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:106)
        at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83)
        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:378)
        at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:97)
        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:378)
        at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:78)
        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:378)
        at org.springframework.security.web.authentication.rememberme.RememberMeAuthenticationFilter.doFilter(RememberMeAuthenticationFilter.java:112)
        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:378)
        at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:54)
        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:378)
        at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:187)
        at org.codehaus.groovy.grails.plugins.springsecurity.RequestHolderAuthenticationFilter.doFilter(RequestHolderAuthenticationFilter.java:40)
        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:378)
        at org.springframework.deerwalk.impl.CustomCasAuthenticationFilter.doFilter(CustomCasAuthenticationFilter.java:113)
        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:378)
        at org.codehaus.groovy.grails.plugins.springsecurity.MutableLogoutFilter.doFilter(MutableLogoutFilter.java:79)
        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:378)
        at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:79)
        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:378)
        at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:167)
        at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:237)
        at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:167)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at com.planetj.servlet.filter.compression.CompressingFilter.doFilter(CompressingFilter.java:270)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at org.jasig.cas.client.session.SingleSignOutFilter.doFilter(SingleSignOutFilter.java:106)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at org.jasig.cas.client.session.SingleSignOutFilter.doFilter(SingleSignOutFilter.java:106)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:88)
        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
        at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:237)
        at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:167)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)
        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)
        at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
        at java.lang.Thread.run(Thread.java:619) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-03T12:08:29.013

我已经在像 servletcontext requestmap 这样的引导程序中将 requestmap 设置在 memeory 中，并在 Cas COde 的 requestUtils 中调用了它，我就像一个魅力一样工作！

# android - Looper 不在 Thread 类之外调用

> ID：14351710
> 
> 赞同：0
> 
> 时间：2013-01-16T05:05:37.133
> 
> 标签：android, handler, looper

我正在学习如何在android开发中使用Looper和Handler类 [http://developer.android.com/reference/android/os/Looper.html](http://developer.android.com/reference/android/os/Looper.html) android开发 中给出的例子不清楚是什么用法和如何使用它。我不知道如何在 Looper 中添加 Handler 以及如何调用 Looper 进行循环。如果有的话，谁能给我一个简单的例子来使用它。

```
public class LooperTest extends Activity{

public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
}
private class LooperTesting extends Thread
{
    public Handler handler;
    public void run()
    {
        Looper.prepare();
        handler = new Handler()
        {
            public void handlerMessage(Message msg)
            {
                    // do something
            }
        };
        Looper.loop();

    }
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T05:09:36.247

希望这个链接对你有帮助

1.  [链接1](http://mindtherobot.com/blog/159/android-guts-intro-to-loopers-and-handlers/)
2.  [链接2](http://rxwen.blogspot.in/2010/08/looper-and-handler-in-android.html)
3.  [链接3](http://stephendnicholas.com/archives/42)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T17:19:49.613

在您的示例中，您只定义了一个带有 Looper 的线程。您需要使用关联的 Looper 启动 Thread，然后才能向其发布任何消息。我在您的示例中添加了一些代码来说明必须做什么：

```
public class LooperTest extends Activity{

    LooperTesting mBgThread;

    public void onCreate(Bundle savedInstanceState)
    { 
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        mBgThread = new mBgThread();

        // Start the thread. When started, it will wait for incoming messages.
        // Use the post* or send* methods of your handler-reference.
        mBgThread.start();
    }

    public void onDestroy() {
        // Don't forget to quit the Looper, so that the
        // thread can finish. 
        mBgThread.handler.getLooper().quit();
    }

    private class LooperTesting extends Thread
    {
        public Handler handler;
        public void run()
        {
            Looper.prepare();
            handler = new Handler()
            {
                public void handlerMessage(Message msg)
                {
                    // do something
                }
            };
            Looper.loop();
        }
    }
} 
```

# ruby - Ruby 中的冻结对象

> ID：14351716
> 
> 赞同：7
> 
> 时间：2013-01-16T05:06:44.077
> 
> 标签：ruby, arrays, string

在 Ruby 中，`String`或`Array`（等）对象被“冻结”是什么意思？如何/在哪里设置或修改此属性？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-16T05:10:49.813

这意味着你不能修改它。你通过`freeze`方法设置它。

```
s = "a" 
```

`concat`修改字符串实例。

```
s.concat("b")
# => "ab" 
```

当您冻结字符串时：

```
s.freeze 
```

那么，你就不能再申请`concat`了。

```
s.concat("c")
# => RuntimeError: can't modify frozen String 
```

但是，您可以应用不修改接收器的方法：

```
s + "c"
# => "abc" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T05:12:55.360

防止对 obj 进行进一步修改。如果尝试修改，将引发 RuntimeError。无法解冻冻结的对象。另请参见 Object#frozen?。

```
a = [ "a", "b", "c" ]
a.freeze
a << "z" 
```

产生：

```
prog.rb:3:in `<<': can't modify frozen array (RuntimeError)
from prog.rb:3 
```

[多可](http://ruby-doc.org/core-1.9.3/Object.html#method-i-freeze)

# php - 是否可以在没有类的情况下使用命名空间

> ID：14351717
> 
> 赞同：4
> 
> 时间：2013-01-16T05:06:45.840
> 
> 标签：php

是否可以在没有类的情况下使用命名空间？

例如：

```
namespace Foo;
// rest of the procedural code and functions 
```

问是因为我知道命名空间只在有类的地方使用。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T05:24:51.757

是的，您可以使用没有类的[命名空间](http://php.net/manual/en/language.namespaces.php)，例如：

```
//demo.php file
namespace FooDemo;
function first() { return "First"; }
function second() { return "Second"; }
function third() { return "Third"; }

//test.php file
require_once 'demo.php';
foreach (array("first","second","third") as $funcs) {
    echo call_user_func('FooDemo\\'.$funcs);
} 
```

你的意思是这样的吗

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T05:25:41.323

是的。见[`documentation`](http://php.net/manual/en/language.namespaces.basics.php)。

提炼：

```
<?php
namespace Foo\Bar;
include 'file1.php';

const FOO = 2;
function foo() {}
class foo
{
    static function staticmethod() {}
}

/* Unqualified name */
foo(); // resolves to function Foo\Bar\foo
foo::staticmethod(); // resolves to class Foo\Bar\foo, method staticmethod
echo FOO; // resolves to constant Foo\Bar\FOO

/* Qualified name */
subnamespace\foo(); // resolves to function Foo\Bar\subnamespace\foo
subnamespace\foo::staticmethod(); // resolves to class Foo\Bar\subnamespace\foo,
                              // method staticmethod
echo subnamespace\FOO; // resolves to constant Foo\Bar\subnamespace\FOO

/* Fully qualified name */
\Foo\Bar\foo(); // resolves to function Foo\Bar\foo
\Foo\Bar\foo::staticmethod(); // resolves to class Foo\Bar\foo, method staticmethod
echo \Foo\Bar\FOO; // resolves to constant Foo\Bar\FOO
?> 
```

# xcode - 麻烦构建firebreath xcode

> ID：14351718
> 
> 赞同：0
> 
> 时间：2013-01-16T05:06:46.650
> 
> 标签：xcode, macos, linker, firebreath

对不起我的英语不好

我为浏览器制作了一个插件来firebreath构建ois库，它将在firebreath上包含插件并出现错误

```
Undefined symbols for architecture i386:
  "_IOCreatePlugInInterfaceForService", referenced from:
      OIS::MacHIDManager::iterateAndOpenDevices(unsigned int) in libois.a(MacHIDManager.o)
  "_IODestroyPlugInInterface", referenced from:
      OIS::MacHIDManager::iterateAndOpenDevices(unsigned int) in libois.a(MacHIDManager.o)
  "_IOIteratorNext", referenced from:
      OIS::MacHIDManager::iterateAndOpenDevices(unsigned int) in libois.a(MacHIDManager.o)
  "_IOObjectRelease", referenced from:
      OIS::MacHIDManager::iterateAndOpenDevices(unsigned int) in libois.a(MacHIDManager.o)
  "_IORegistryEntryCreateCFProperties", referenced from:
      OIS::MacHIDManager::iterateAndOpenDevices(unsigned int) in libois.a(MacHIDManager.o)
  "_IOServiceGetMatchingServices", referenced from:
      OIS::MacHIDManager::lookUpDevices(int, int) in libois.a(MacHIDManager.o)
  "_IOServiceMatching", referenced from:
      OIS::MacHIDManager::lookUpDevices(int, int) in libois.a(MacHIDManager.o)
  "_kIOMasterPortDefault", referenced from:
      OIS::MacHIDManager::lookUpDevices(int, int) in libois.a(MacHIDManager.o)
ld: symbol(s) not found for architecture i386
clang: error: linker command failed with exit code 1 (use -v to see invocation)
```

链接有问题？或其他？我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T16:44:03.387

您似乎没有链接所需的库。快速的[google 搜索](http://bit.ly/UQrxPI)表明您需要链接到 IOKit 框架以获取这些符号中的至少一些。

我建议您查看 Firebreath.org 上的[Using Libraries](http://www.firebreath.org/display/documentation/Using+Libraries#UsingLibraries-UsingMacFrameworks)页面，了解有关如何链接到 Mac 框架的信息。它看起来像这样：

```
find_library(FRAMEWORK_IOKIT IOKit)
target_link_libraries(${PROJECT_NAME} ${FRAMEWORK_IOKIT}) 
```

这需要在您的 add_mac_plugin 调用之后的某个地方进入 Mac/projectDef.cmake。

# drupal - 查看 Drupal 克隆

> ID：14351719
> 
> 赞同：1
> 
> 时间：2013-01-16T05:06:47.833
> 
> 标签：drupal, drupal-7, drupal-views

我购买了一个主题，结果证明没有很好的文档或支持，在几乎完成我的网站后，我遇到了一个我无法解决的问题:(

我应该开始说我是新手，这可能真的很容易，但我似乎找不到答案。

我创建了一个视图的克隆，它的样式非常好：

[http://www.calaverastattoo.com/portfolio/category/](http://www.calaverastattoo.com/portfolio/category/)

我的克隆看起来像这样：

[http://www.calaverastattoo.com/portfolio/category/angel](http://www.calaverastattoo.com/portfolio/category/angel)

如果有人知道如何解决此问题，我将非常感谢您的帮助。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T07:24:25.867

这可能是因为缺少 CSS 样式。确保在新主题中复制所需的 CSS 代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T14:21:22.433

您需要复制以下文件并将它们放在与原始文件相同的文件夹位置。

因此，例如 /sites/all/themes/YOURTHEME/templates （这是猜测）将包含以下文件。我认为天使是你新观点的名称？

原始--views-view-fields--portfolio--page.tpl.php
重复--views-view-fields--angel--page.tpl.php

原始 - 视图-视图-字段--投资组合--items-summary.tpl.php
重复--视图-视图-字段--天使--items-summary.tpl.php

原始 - 视图-视图-字段--投资组合--items-summary.tpl.php
重复--视图-视图-字段--天使--items-summary.tpl.php

原始 - 视图-视图-未格式化--portfolio--items-summary.tpl.php
重复--视图-视图-未格式化--angel--items-summary.tpl.php

原始的-views-view-unformatted--portfolio--page.tpl.php
重复的-views-view-unformatted--angel--page.tpl.php

原始的-views-view-unformatted--portfolio--page.tpl.php
重复的-views-view-unformatted--angel--page.tpl.php

由于这是您购买的自定义主题，因此我不是 100% 了解它如何加载模板文件，以上示例适用于大多数 drupal 基本主题。

干杯丹

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T09:55:31.157

我猜你购买的模板附带的视图有它自己的模板，它将是主题目录中的一个文件，称为这样的东西（可能在一个名为 tempaltes 的目录中）

视图-视图-页面--portfolio--portfolio.tpl.php

如果您在页面的右下角编辑原始视图，则会有一个名为主题的选项和一个名为信息的链接。单击信息，它会显示哪些模板文件将影响该视图。

谢谢

# css-position - 在溢出 div 中居中绝对 div

> ID：14351721
> 
> 赞同：0
> 
> 时间：2013-01-16T05:06:57.697
> 
> 标签：css-position, centering, css

我正在寻找一个绝对位于溢出 div 内的 div 居中。

这是我的 HTML。 [小提琴](http://jsfiddle.net/lucasjd/kKMbY/)

```
 <header class="contain960"> 
      <div class="brand_logo"></div>
      <nav>
            <ul>
                <li class="active">Boats</li>
                <li>Cars</li>
                <li>Powersports</li>
                <li>RV's</li>
                <li>Consignment</li>
            </ul>
      </nav>
 </header>

 <div class="site_line top"></div>
 <div class="site_line custom"></div>
 <div class="site_line bottom"></div> 
```

和CSS。

```
section {
  position: relative;
  max-width: 1280px;
  min-width: 960px;
  width: 100%;
  overflow: hidden;
}

.site_line {
  position: absolute;
  width: 1280px;
  height: 1px
  //Gradient Fill
  //Center the DIV;
}

.site_line.top{
  top: 0px;
}

.site_line.bottom{
  bottom: 0px;
} 
```

.site_line 元素应始终保持在 div 的中心，即使该部分的宽度小于 1280 像素并且不会被推到左侧。我以前用背景图像和背景位置属性做过这个。但我一生都无法弄清楚如何使用javascript来做到这一点。

任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T05:16:03.380

### 不要使用`position: absolute;`！

而是使用`margin: auto;`：

```
.site_line {
  margin: auto;
  width: 1280px;
  height: 1px
  //Gradient Fill
} 
```

# android - 我想拒绝特定号码的来电，但它不起作用

> ID：14351724
> 
> 赞同：1
> 
> 时间：2013-01-16T05:07:08.877
> 
> 标签：android

我正在尝试阻止特定号码的来电。首先我尝试所有来电。它运作良好。但是当我通过以下代码尝试特定号码时，呼叫不会被拒绝并且电话正在响铃，我尝试使用我的 android 手机..

```
 @Override
     public void onReceive(Context context, Intent intent) {
      Log.v(TAG, "Receving....");
      String t1="01741297163",t2="08801741297163";
      TelephonyManager telephony = (TelephonyManager) 
      context.getSystemService(Context.TELEPHONY_SERVICE);  
      try {
       Class c = Class.forName(telephony.getClass().getName());
       Method m = c.getDeclaredMethod("getITelephony");
       m.setAccessible(true);
       Bundle b=intent.getExtras();
       num=b.getString(telephony.EXTRA_INCOMING_NUMBER);
       if(num.equals(t1)||num.equals(t2)){
       telephonyService = (ITelephony) m.invoke(telephony);
       //telephonyService.silenceRinger();
       telephonyService.endCall();
      } }catch (Exception e) {
       e.printStackTrace();
      } 
```

我不知道从 Telephonymanager 获得的传入号码的格式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T05:53:11.263

```
import java.lang.reflect.Method;

import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.media.AudioManager;
import android.os.Bundle;
import android.preference.PreferenceManager;
import android.telephony.PhoneStateListener;
import android.telephony.TelephonyManager;
import android.widget.Toast;

import com.android.internal.telephony.ITelephony;

public class PhoneCallStateListener extends PhoneStateListener {    

private Context context;
public PhoneCallStateListener(Context context){
    this.context = context;
}

@Override
public void onCallStateChanged(int state, String incomingNumber) {  
SharedPreferences prefs=PreferenceManager.getDefaultSharedPreferences(context);

switch (state) {

    case TelephonyManager.CALL_STATE_RINGING:       

      String block_number = prefs.getString("block_number", null);
            AudioManager audioManager = (AudioManager) context.getSystemService(Context.AUDIO_SERVICE); 
            //Turn ON the mute
    audioManager.setStreamMute(AudioManager.STREAM_RING, true);                 
            TelephonyManager telephonyManager = (TelephonyManager) context.getSystemService(Context.TELEPHONY_SERVICE);
    try {
    Toast.makeText(context, "in"+block_number, Toast.LENGTH_LONG).show();
    Class clazz = Class.forName(telephonyManager.getClass().getName());
    Method method = clazz.getDeclaredMethod("getITelephony");
    method.setAccessible(true);
    ITelephony telephonyService = (ITelephony) method.invoke(telephonyManager);     
    //Checking incoming call number
    System.out.println("Call "+block_number);
    if (incomingNumber.equalsIgnoreCase("+91"+block_number)) {
    //telephonyService.silenceRinger();//Security exception problem
     telephonyService = (ITelephony) method.invoke(telephonyManager);
     telephonyService.silenceRinger();
    System.out.println(" in  "+block_number);
    telephonyService.endCall();
    }
    } catch (Exception e) {
    Toast.makeText(context, e.toString(), Toast.LENGTH_LONG).show();
    }
        //Turn OFF the mute     
    audioManager.setStreamMute(AudioManager.STREAM_RING, false);
    break;
    case PhoneStateListener.LISTEN_CALL_STATE:
    }
    super.onCallStateChanged(state, incomingNumber);
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T05:17:26.157

为什么不尝试在日志中打印传入的电话号码，然后将其与您存储的号码进行比较？无论如何，您存储的电话号码`t1`和`t2`没有标准/国际代码。正确的电话号码（如果在印度）将是

```
t1="+911741297163" 
```

就像印度男女同校一样`+91`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T05:37:52.447

您也应该在号码中添加国家代码。对印度说 +91。试试吧！

# c - 使用 dlopen 加载的共享库是否会自动关闭？

> ID：14351727
> 
> 赞同：1
> 
> 时间：2013-01-16T05:07:16.883
> 
> 标签：c, shared-libraries, dlopen, dynamic-loading

如果我使用打开一个动态库`dlopen`并且我的程序在没有相应的情况下终止`dlclose`，引用计数会减少吗？如果没有，会发生什么？库会一直加载到下次重新启动吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T07:47:08.737

动态加载器是用户空间代码（linux/glibc 中的 ld.so.1）。它被加载到您正在运行的程序的用户空间中，并且不与其他进程交互。所以没有全局引用计数器。

但是，有一种方法可以在进程之间共享动态库的代码。动态加载器使用 mmap() 将库代码加载到进程内存中。同一个库的 mmap 数据将在所有使用它的进程之间共享（直到他们向这些数据页写入任何内容，这将使用 COW 创建他们自己的数据副本）。当你的程序终止时，所有的 mmap 区域都会被释放。您可以认为这是一种引用计数器递减 - 您的数据页副本现已发布。

# firefox - Firefox 中 kineticjs 的生涩拖拽动作

> ID：14351731
> 
> 赞同：3
> 
> 时间：2013-01-16T05:07:26.700
> 
> 标签：firefox, kineticjs

我似乎发现 Firefox 中的 Kineticjs 存在问题，该问题在 Firefox 浏览器（版本 17.0.1）和 kineticjs v4.3.0 中产生缓慢而生涩的拖动。仅供参考：我也在运行 Fedora 17。Chrome 不会出现这个问题。

这可能是 Firefox 17 的问题。它不会出现在运行 Firefox 15 的 10 英寸 android 4.0.3 平板电脑或运行 android 4.0.4 和 Opera mobile 12 的 HTC-oneS 手机上。

演示代码将两个矩形形状放在一个图层中，并将最上面的一个设置为可拖动。除非鼠标拖动速度低于某个阈值，否则可拖动矩形不会刷新其在屏幕上的位置。如果鼠标持续移动得足够快，则拖动矩形似乎永远不会更新其在屏幕上的位置。效果是一个非常生涩的阻力。

对于像这样的拖拽，舞台的宽度和高度必须 > 256 并且小于宽度 = 1050 和高度 = 293。取消注释将舞台的宽度和高度设置为 256 的行会导致问题离开。第二个矩形的存在是必需的。它可以是可拖动的，也可以是不可拖动的，这无关紧要。如果不存在，则拖动很好。似乎存在质而非量的差异。它要么完全滞后，要么没有。

此外，我尝试将对象放置在不同的层（见注释行），但这并没有提高性能。

提前致谢，

史蒂夫

```
<!DOCTYPE HTML>
<html>
  <head>
    <style>
      body {
        margin: 0px;
        padding: 0px;
      }
    </style>
    <script  type="text/javascript" src="/resources/kinetic.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
 </head>
  <body>
    <div id="container"></div>
    <script>

   var w = $("#container").innerWidth();
   var h=  $(window).innerHeight();
   // w = 256;  h=  256; // uncomment this line and dragging is smooth in firefox

   console.log("Stage size w:" + w + " h:" + h);

   var stage = new Kinetic.Stage({
       container: 'container',
       width: w,
       height: h
  });

   var gimage = new Kinetic.Rect({
        x:10,
        y: 10,
        fill: '#00D2FF',
       // image: images["folder"],
        width: 36,
        height: 36,
   });

   var fimage = new Kinetic.Rect({
        x:30,
        y: 30,
        fill: '#A0D2FF',
        width: 36,
        height: 36,
       draggable: true
   });

      var layer = new Kinetic.Layer();
      //var layer2 = new Kinetic.Layer();
     layer.add(gimage);
      layer.add(fimage);
    //  layer2.add(fimage);
      stage.add(layer);
     // stage.add(layer2);
    </script>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-09T09:02:11.363

我用最新的 kineticjs 4.7.4 测试了这段代码。

一切正常。

# clojure - 如何在启动时自动启动 clojure 应用程序

> ID：14351735
> 
> 赞同：2
> 
> 时间：2013-01-16T05:07:46.400
> 
> 标签：clojure

我只是想在启动时运行一个环形服务器。我正在使用 ubuntu 12.04 并且想知道其他人如何部署他们的应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T07:38:38.117

您需要生成 init 或 upstart 脚本。[leiningen wiki](https://github.com/technomancy/leiningen/wiki/Plugins)提到了自动生成和安装脚本的[lein-init-script 。](https://github.com/strongh/lein-init-script)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T03:59:48.087

新贵的食谱非常令人生畏……但比我想象的要容易。新贵的脚本实际上写起来很简单。

以下是我为使其工作而采取的步骤：

### (1) 在你的 project.clj 中，放一个`:main`指向要运行的类的关键字。例如：

```
（defproject 青金石“0.1.0-SNAPSHOT”
  : 依赖...
  ...文件的其余部分...
  :main lapis.app)

```

### (2) 然后在类中，添加一个`:gen-class`指令到命名空间以及一个`-main`函数：

```
(ns lapis.app
  (:gen-class)
  （：采用 ....）
  （：要求...））

(defn -main [&args]
  ……）

```

### (3)使用lein uberjar in生成jar文件：

```
$ lein uberjar
> Including fs-1.3.2.jar
> Including jetty-io-7.6.1.v20120215.jar
> ........
> Including jetty-continuation-7.6.1.v20120215.jar

> Created /home/example/lapis/target/lapis-0.1.0-SNAPSHOT-standalone.jar 
```

### (4) 确保`.jar`文件运行：

```
$ java -jar target/lapis-0.1.0-SNAPSHOT-standalone.jar 
```

并在您的项目目录之外对其进行测试，因为您的`resources`目录中的文件可能存在您可能不知道的问题：

```
$ cd ~
$ java -jar /home/example/lapis/target/lapis-0.1.0-SNAPSHOT-standalone.jar 
```

### (5) 如果一切正常，upstart 文件放在 /etc/init/.conf 中。

我的脚本是 5 行：

```
$ cat /etc/init/lapis.conf
> -------------
> start on started

> script
>  exec /usr/bin/java -jar  /home/example/lapis/target/lapis-0.1.0-SNAPSHOT-standalone.jar >> /var/log/lapis/lapis.log 2>&1
> end script
> -------------- 
```

### (6) 测试看服务是否有效：

```
$ sudo start lapis
>  lapis start/running, process 2543

$ sudo stop lapis
> lapis stop/waiting 
```

# jquery - 忽略文档长度中的绝对位置 Div

> ID：14351741
> 
> 赞同：0
> 
> 时间：2013-01-16T05:08:19.113
> 
> 标签：jquery, html, css

基本上我有几个绝对位置的 div，这些只是点击打开并显示内容的标签。

我也有垂直滚动分页（就像 Facebook 的永久滚动一样）。

现在有了标签，其中一些位于页面下方几千像素的位置，这意味着它们正在拉伸页面，因此在垂直滚动分页开始之前有一个巨大的白色间隙。

我试过了

*   最初通过 Jquery 隐藏所有 div
*   将它们包装在 div 中并浮动
*   不同的 z-index
*   设置身体高度的变化。

我的目标是强迫浏览器以某种方式忽略它们。

万一这有助于：

对于我正在使用的标签：TabSlideOut - [http://www.building58.com/examples/tabSlideOut-muliple.html](http://www.building58.com/examples/tabSlideOut-muliple.html)

对于滚动分页 - [http://www.contextllc.com/dev_tools/jQuery/scrollExtend/latest/jquery.scrollExtend.example.html](http://www.contextllc.com/dev_tools/jQuery/scrollExtend/latest/jquery.scrollExtend.example.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T06:42:40.430

**我希望我理解你的问题：** 你有一个绝对位置的 div，你需要能够隐藏它们，直到页面上发生事件。

当我不需要简单的 .hide() 时，我发现有用的是“隐藏”视口中的内容。（我用精灵图遇到过这个问题。）

我使用的一种方法是创建一个 CSS 类 .hidden 并使用以下命令调用它：`$(selector).addClass('hidden');`

```
.hidden{position: absolute; top: -9999px !important; left: -9999px !important;} 
```

!important 是……嗯，很重要。简单地说，如果一个类有 !important，而另一个没有，那么通常会优先处理。如果您开始使用 JQuery 来传递 CSS 操作，您最终可能会否决 !important。

然后我把这个类分配给`<div>`我需要的东西。我还创建了一个 --[ [jsfiddle](http://jsfiddle.net/michaeltr/kuAcY/) ]-- 来演示将内容带入视口的两种方法。

第一个（aTab）使用 .hidden 技术。第二个 (bTab) 使用 .slideToggle() 您可以为下一组要加载的内容实现它，或者与您的 silder 插件结合使用。

希望这可以帮助！

# c - 传递数组或传递指针

> ID：14351742
> 
> 赞同：0
> 
> 时间：2013-01-16T05:08:20.330
> 
> 标签：c, arrays, pointers

```
gcc 4.7.2
c89 
```

你好，

函数 GetCallRef(...) 需要一个指向此第三个参数的缓冲区的指针，即 call_id 是我的指针。但是，我不知道将在 call_id 中返回的字符串的长度。此 call_id 将仅在此函数中使用，因此将仅具有本地范围，因此我将仅使用函数中返回的 call_id。

所以我的问题是；可以声明一个指针并传递它吗？

```
char *call_id = NULL; 
```

或者最好声明一个非常大的数组（因为我不知道大就足够大）

```
char call_id[1024] 
```

实际功能。

```
if(GetCallRef(crn, GET_CALLID, call_id) == 0) {
    /* use the call id - not used outside of this function */
} 
```

我没有实际功能的源代码，`GetCallRef(...)`因为它已关闭。

我猜缓冲区会更好，因为内部函数可以直接复制到该缓冲区中。但是，由于数组衰减为函数参数中的指针，并且我没有传递大小，因为它不是这个函数签名的一部分，它的长度只有 4 个字节。该函数如何知道我的数组有多大？这不可以。

如果我传递一个指针，它可以分配存储字符串值的地址，即并返回它。

```
call_id = call_reference_id; 
```

所有文件都说缓冲区应该足够大以存储呼叫ID，但没有说明它应该有多大。

非常感谢您的任何建议，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T05:15:58.790

如果文档说*“缓冲区应该足够大以存储调用 ID”*，则意味着该函数希望调用者传递一个预先分配的缓冲区，无论是在堆栈上还是在堆上。

> **重要的问题是应该为传递的缓冲区分配多少内存？**

该函数的文档应该提到这一点！
如果没有函数告诉您这些信息，就不可能 100% 安全。
也许您需要检查其他一些采用类似参数的 api 或检查记录此参数的功能规范。

如果一切都失败了，你最后的选择是分配一个足够大的数组，也许`1024`并严格测试代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T05:16:15.603

在这种情况下，您绝对应该传递一个数组。如果文档说该函数需要一个缓冲区，那么仅传递一个指针可能会导致段错误。如果它没有给出“足够大”有多大的任何迹象，那么这就是糟糕的文档。如果您知道可能是哪种字符串`call_id`，则可以猜测要创建的合适大小的缓冲区。如果没有，您是否能够测试该函数并查看它返回的值是什么类型的？这可能会提供足够的想法来工作。

尝试使用一个有足够空间的数组（你建议的大小为 1024 似乎是一个很好的起点），并查看它作为`call_id`. 多次这样做。例如，您可能会发现它始终是一个 64 个字符的字符串，在这种情况下，您可以将一个至少包含 64 个元素的数组传递给它，应该没问题。

# postgresql - 在 postgres 中将表列名称更改为大写

> ID：14351743
> 
> 赞同：9
> 
> 时间：2013-01-16T05:08:24.063
> 
> 标签：postgresql, postgresql-9.2

我正在使用 postgres 9.2。我需要将 postgres db 中所有表的所有列名更改为大写。

有没有办法做到这一点？我需要更改 postgres 中的任何配置吗？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-01-16T05:51:41.430

在我解释如何做到这一点之前，我**强烈**建议不要这样做。

在 PostgreSQL 中，如果表名或列​​名未加引号，例如：

```
SELECT Name FROM MyTable WHERE ID = 10 
```

它们实际上首先自动*折叠为小写*，因此上面的查询与以下内容相同：

```
SELECT name FROM mytable WHERE id = 10 
```

如果您要将所有名称转换为大写，则此语句**将不起作用**：

```
SELECT NAME FROM MYTABLE WHERE ID = 10 
```

您必须在此查询中用双引号括起每个名称才能使其正常工作：

```
SELECT "NAME" FROM "MYTABLE" WHERE "ID" = 10 
```

另一方面，如果您使用标准 PostgreSQL 仅小写协议，则可以使用任何大小写组合，只要您不引用任何名称，它就可以工作。

* * *

现在，如果您仍然坚持转换为大写，您可以通过将数据库模式转储到使用[`pg_dump --schema-only`](http://www.postgresql.org/docs/9.2/static/app-pgdump.html).

完成后，检查所有语句并基于此转储[`CREATE TABLE`](http://www.postgresql.org/docs/9.2/static/sql-createtable.html)构造适当的语句 - 您必须编写一些脚本（Perl 或 Python）来执行此操作。[`ALTER TABLE`](http://www.postgresql.org/docs/9.2/static/sql-altertable.html)

或者，您可以阅读[INFORMATION_SCHEMA.TABLES](http://www.postgresql.org/docs/9.2/static/infoschema-tables.html)和/或[INFORMATION_SCHEMA.COLUMNS](http://www.postgresql.org/docs/9.2/static/infoschema-columns.html)并构造和执行适当`ALTER TABLE`的语句。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-10-31T15:17:49.457

下面的查询创建 SQL 语句，您可以运行这些语句将表的列名更改为小写。如果要广泛应用，请删除 table_name 检查。有关更多详细信息，请参阅[此帖子](http://www.postgresonline.com/journal/archives/141-Lowercasing-table-and-column-names.html)

```
SELECT array_to_string(ARRAY(SELECT 'ALTER TABLE ' || quote_ident(c.table_schema) || '.'
  || quote_ident(c.table_name) || ' RENAME "' || c.column_name || '" TO ' || quote_ident(lower(c.column_name)) || ';'
  FROM information_schema.columns As c
  WHERE c.table_schema NOT IN('information_schema', 'pg_catalog') 
      AND c.column_name <> lower(c.column_name) 
      and table_name = 'your_table_name'
  ORDER BY c.table_schema, c.table_name, c.column_name
  ) , 
   E'\r') As ddlsql; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2021-03-30T06:04:05.503

this query must work

```
 Alter table if exists tablename rename to "TABLENAME" 
```

# php - SQL 查询以显示与特定事件最近的数据

> ID：14351745
> 
> 赞同：1
> 
> 时间：2013-01-16T05:08:36.767
> 
> 标签：php, mysql, sql

我试图弄清楚如何编写一个 MySQL 查询，该查询将返回最接近的数据，其中 Actor = 210 表示 E_id = 3。

这是我原来的表：

```
Session              Player  E_id  Time                     Actor  PosX  PosY  index
-------------------  ------  ----  -----------------------  -----  ----  ----  -----
23131885ccc560bb6c8  10125   17    01-11-2012 08:56:38.323  210    906   466   6
23131885ccc560bb6c8  10125   17    01-11-2012 08:56:38.323  210    342   540   7
23131885ccc560bb6c8  10125   17    01-11-2012 08:56:38.323  31     812   244   8
23131885ccc560bb6c8  10125   17    01-11-2012 08:56:38.323  210    248   614   9
23131885ccc560bb6c8  10125   17    01-11-2012 08:56:38.323  21     342   688   10
23131885ccc560bb6c8  10125   17    01-11-2012 08:56:38.323  49     812   170   11
23131885ccc560bb6c8  10125   17    01-11-2012 08:56:38.323  50     248   466   12
23131885ccc560bb6c8  10125   17    01-11-2012 08:56:38.323  210    718   318   13
23131885ccc560bb6c8  10125   17    01-11-2012 08:56:38.323  52     154   466   14
23131885ccc560bb6c8  10125   17    01-11-2012 08:56:38.323  211    499   250   15
23131885ccc560bb6c8  10125   3     01-11-2012 08:56:40.63   208    510   414   16
23131885ccc560bb6c8  10125   17    01-11-2012 08:56:38.323  210    248   466   17
23131885ccc560bb6c8  10125   15    01-11-2012 08:56:38.323  20     718   318   18
23131885ccc560bb6c8  10125   17    01-11-2012 08:56:38.323  52     154   466   19
23131885ccc560bb6c8  10125   17    01-11-2012 08:56:38.323  11     499   250   20
23131885ccc560bb6c8  10125   3     01-11-2012 08:56:40.63   208    510   414   21 
```

如果我触发查询

```
select * from table where E_id = 3 or Actor = 210; 
```

我得到这个结果

```
Session              Player  E_id  Time                     Actor  PosX  PosY  index
-------------------  ------  ----  -----------------------  -----  ----  ----  -----
23131885ccc560bb6c8  10125   17    01-11-2012 08:56:38.323  210    906   466   6
23131885ccc560bb6c8  10125   17    01-11-2012 08:56:38.323  210    342   540   7
23131885ccc560bb6c8  10125   17    01-11-2012 08:56:38.323  210    248   614   9
23131885ccc560bb6c8  10125   17    01-11-2012 08:56:38.323  210    718   318   13
23131885ccc560bb6c8  10125   3     01-11-2012 08:56:40.63   208    510   414   16
23131885ccc560bb6c8  10125   17    01-11-2012 08:56:38.323  210    248   466   17
23131885ccc560bb6c8  10125   3     01-11-2012 08:56:40.63   208    510   414   21 
```

**预期结果是：** 第 16 行索引第 13 行和第 21 行索引第 17 行

索引 16 和 21 的**e_id**均为**3**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T05:29:58.153

您的输入是 E_ID、Index 和 Actor。索引似乎是一个唯一列，因此您不需要 E_ID。

此查询将找到最近的（按索引距离）。但它只会查找索引较低（向上）的行。

```
select   *
from     your_tbl
where 16 - `index` >= 0 and Actor = 210
order by 16 - `index`
limit 1 
```

16 给你 13 和 21 给你 17

还有另一个查询没有只查找的限制。它将找到最接近的索引：

```
select   *
from     your_tbl
where Actor = 210
order by abs(21 - `index`)
limit 1 
```

我提出了两个问题，因为我不明白问题中最接近的意思。如果它在索引距离 abs(index1 - index2) 方面最接近，那么对于 16 17 来说，结果与 13 一样好，因为它们都有 Actor = 210 并且它们是相邻的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T07:25:04.730

这是一个非动态的答案。这意味着使用 a`union`并不是最好的。（归功于 sqlfiddle 的 Eggyal）

*   [SQLFIDDLE 演示](http://sqlfiddle.com/#!2/87f91/77)

询问：

```
select   session, player, e_id,
time, actor, max(`index`)
from     your_tbl
where    Actor = 210
union
select   session, player, e_id,
time, actor, `index`
from     your_tbl
where    e_id = 3
;

|             SESSION | PLAYER | E_ID |                      TIME | ACTOR | MAX(`INDEX`) |
------------------------------------------------------------------------------------------
| 23131885ccc560bb6c8 |  10125 |   17 | January, 11 2012 08:56:38 |   210 |           17 |
| 23131885ccc560bb6c8 |  10125 |    3 | January, 11 2012 08:56:40 |   208 |           16 |
| 23131885ccc560bb6c8 |  10125 |    3 | January, 11 2012 08:56:40 |   208 |           21 | 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T07:56:45.470

[这是它有效的测试](http://sqlfiddle.com/#!2/a58f2/50/4)

我真的不知道是否真的需要第 3 个或语句，但如果您的应用程序可能将其用作特殊情况，您可以根据需要删除它。如果要删除我使用的额外行，而不是**select ***在变量赋值之后，将其更改为：

```
select `Session`, `Player`, `E_id`, `Time`, `Actor`, `PosX`, `PosY`, `index` ... 
```

我没有包括，因为 [ ` ] 在 PHP 中并不总是受欢迎的

```
 set @i = 0; 
    set @j = 0; 
    set @k = 0;
    set @l = 0;

    select * from (select *, @i:=@i+1 as myrow from your_tbl where E_id = 3 or Actor=210) as tb1 
    where myrow in
    (select myrow2-1 from 
    (select *, @j:=@j+1 as myrow2 from your_tbl where E_id = 3 or Actor=210) as tb2 
         where E_id=3) or myrow in
    (select myrow3+1 from 
    (select *, @k:=@k+1 as myrow3 from your_tbl where E_id = 3 or Actor=210) as tb3 
         where E_id=3) or myrow in
    (select myrow4 from 
    (select *, @l:=@l+1 as myrow4 from your_tbl where E_id = 3 or Actor=210) as tb4 
         where E_id=3) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-16T08:49:43.043

我通过@eggyal 示例解决方案得到我的答案[，](http://sqlfiddle.com/#!2/87f91/44)当我得到最终查询时它是如此简单

# tfs - TFS 2012 团队警报不起作用

> ID：14351753
> 
> 赞同：3
> 
> 时间：2013-01-16T05:09:27.280
> 
> 标签：tfs

我已经安装了 TFS 2012 Update 1 并在 TFS 管理控制台的应用程序层中设置了电子邮件警报。之后，我向项目团队添加了几个测试帐户并设置了一些默认的团队警报（例如“当工作项分配给我时”），所有这些都是通过 Web 访问。

问题是没有人收到任何电子邮件，但是当用户在“我的警报”下单独订阅这些相同的警报时，一切正常。有没有人经历过这样的事情？我在事件查看器中没有发现任何错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T00:48:03.257

I think the problem happen when it concatenates all emails together, so try to make sure all names are straightforward without any apostrophe or special characters, try to have only one member and test and start increasing the number of members each time with test till you get your problem.

# makefile - Linux内核模块编程Makefile

> ID：14351758
> 
> 赞同：2
> 
> 时间：2013-01-16T05:09:44.073
> 
> 标签：makefile, kernel

我正在尝试创建一个 helloworld 模块。我必须写一个如下的makefile。

```
ifneq ($(KERNELRELEASE), )
obj-m := hello.o
else
KDIR := /path/to/kernel/sources
all:
    make -C  $(KDIR) M= 'pwd' modules
endif 
```

我知道这个makefile运行了两次。它如何通过只调用一次来运行两次？

这里何时`obj-m`使用该值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T05:18:45.970

这个 makefile 有一个规则：

```
all:
    make -C $(KDIR) M= 'pwd' modules 
```

英文：“进入目录`$(KDIR)`并执行Make（目标是`modules`）”。

因此，当*您*使用此 makefile 调用 Make 时，*它​​会*使用另一个 makefile 调用 Make。

你应该从更简单的开始。如果您告诉我们您要做什么，我们可以提供帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T12:24:10.460

看起来这个文件*可能*有一个规则，但前提`KERNELRELEASE`是它是空的。 *只有在不*为空`obj-m`时才被定义`KERNELRELEASE`，在这种情况下不会真正做任何事情......我猜这将被内核使用，包括这个（在定义之后）在它自己的一个中，以防你实际构建它进入内核而不是作为动态加载的模块。*`Makefile``obj-m``Makefile``KERNELRELEASE`*

# usability - Access 2010 - 条件格式许多字段

> ID：14351760
> 
> 赞同：1
> 
> 时间：2013-01-16T05:10:03.233
> 
> 标签：usability, ms-access-2010, conditional-formatting

我需要有条件地格式化 24 个文本框，每个文本框有 2 条规则。每个规则都略有不同，基于月份。有什么方法可以在一个屏幕上输入我的条件格式规则，这样我就不必点击这么多按钮了？另外，如果我什至需要编辑规则，这将节省大量时间。伪代码：

```
Style1 = FontFill.Red
Style2 = FontFill.Yellow

txtField1.ConditionalFormatting.Add("<rule text>", Style1)
txtField1.ConditionalFormatting.Add("<rule text>", Style2)

txtField2.ConditionalFormatting.Add("<rule text>", Style1)
txtField2.ConditionalFormatting.Add("<rule text>", Style2) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T09:26:25.157

您可以使用[FormatConditions.Add 方法](http://msdn.microsoft.com/en-us/library/office/ff194814%28v=office.14%29.aspx)代替您的伪代码。在设计视图中打开“Form3”后，我在立即窗口中执行了以下操作：

```
Forms("Form3").Controls("txtNote").FormatConditions.Add acFieldValue, acBetween, 10, 100
Forms("Form3").Controls("txtNote").FormatConditions(0).ForeColor = vbRed
' confirm the FormatCondition is enabled ...
? Forms("Form3").Controls("txtNote").FormatConditions(0).Enabled
True 
```

然后从表单属性检查格式条件给了我这个......

![条件格式屏幕截图](../Images/8e59aa8fa35b72d5edf0262caad81ac5.png)

对于 24 个控件，您可以创建一个应用条件格式的过程。当规则改变时修改程序。或者将规则存储在表中，并让过程从表中读取规则。

# java - Apk 静默安装 android

> ID：14351764
> 
> 赞同：0
> 
> 时间：2013-01-16T05:10:34.330
> 
> 标签：java, android

我想知道，如何在不使用意图的情况下以编程方式安装 apk（即无用户提示的静默安装）？

我对此进行了研发，只有在设备已植根的情况下才有可能，但我看到很少有像 Appbrain 和 airwatch 这样的应用程序，我正在要求 enterprice 应用程序，有什么解决方法吗？

我也参考这个线程[在 Android 设备上静默安装](https://stackoverflow.com/questions/3438637/silent-installation-on-android-devices)

你有什么主意吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T05:16:05.530

您需要有根设备来执行此操作。 [ACTION_PACKAGE_INSTALL](http://developer.android.com/reference/android/content/Intent.html#ACTION_PACKAGE_INSTALL)从未实际使用过，据说需要作为系统应用程序。

```
exec = Runtime.getRuntime().exec(new String[]{"mv /path/to.apk /system/app/theapp.apk"}); 
```

# css - 禁用仅适用于 ipad 的 Web 应用程序中的按钮

> ID：14351767
> 
> 赞同：0
> 
> 时间：2013-01-16T05:10:57.147
> 
> 标签：css, ipad

我有一个具有上传功能的网络应用程序。当通过 ipad 查看页面时，我想禁用该按钮。

那可能吗。我的想法是检查分辨率。但是如果设备的分辨率提高了怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T05:13:09.703

尝试检查 PHP 中的用户代理。看到[这个问题](https://stackoverflow.com/questions/2153877/what-is-the-ipad-user-agent "什么是 ipad 用户代理？")。然后，如果评论标签与 iPad 用户的预期用户代理匹配，则回显评论标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T06:30:28.600

### 使用 CSS 媒体查询

对于 iPad 相关的 CSS，您可以使用：

```
@media only screen
and (min-device-width : 768px)
and (max-device-width : 1024px) {
  .no-ipad {
    display: none;
  }
} 
```

添加`no-ipad`使元素不显示在 iPad 上的类。

### 对于安卓（*如果你需要*）

```
@media only screen
and (min-device-width : 320px)
and (max-device-width : 480px) {
  .no-android {
    display: none;
  }
} 
```

添加`no-android`用于使元素不显示在 Android 上的类。

# php - 未打印 FPDF A4 尺寸

> ID：14351770
> 
> 赞同：2
> 
> 时间：2013-01-16T05:11:32.990
> 
> 标签：php, fpdf

我在我的项目中使用 FPDF 生成 PDF。我想生成 A4 大小的页面，我使用以下行。

```
$fpdf = new PDF('P','mm',array(595.28,841.89));
$fpdf->AddPage('P', 'A4'); 
```

我使用此代码生成 PDF 并打印出来。然后我意识到页面大小不适合 A4。
有人可以在这方面帮助我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T05:49:22.270

问题是您将错误的默认页面大小（595.28 毫米 x 841.89 毫米）传递给 FPDF 构造函数，顺便说一句，它应该是`FDPF`. 如果在纵向模式下，[A4为 210 毫米 x 297 毫米。](http://en.wikipedia.org/wiki/A4_paper#A_series)

所以你应该这样调用构造函数：

```
$pdf = new FPDF('P','mm','A4'); 
```

或者

```
$pdf = new FPDF('P','mm',array(210,297)); 
```

之后，您可以在调用时省略页面大小参数`AddPage()`。

这是一个完整的*Hello World*示例：

```
<?php
require('fpdf.php');

$pdf = new FPDF('P','mm','A4');
$pdf->AddPage();
$pdf->SetFont('Arial','B',16);
$pdf->Cell(40,10,'Hello World!');
$pdf->Output();
?> 
```

# javascript - 使用javascript打开弹出窗口

> ID：14351771
> 
> 赞同：31
> 
> 时间：2013-01-16T05:11:51.773
> 
> 标签：javascript

我希望同时在两个不同的弹出窗口中打开一个 aspx 页面（test.aspx）。

到目前为止，我拥有的第二个替换第一个并首先重新创建页面。

我认为这里需要更多澄清，所以，

基本上我创建了一个图形并将其放在 test.aspx 中，然后将该图形保存为图像文件。我在 test.aspx 上放了一个按钮，它与 stimulsoft 报告链接，该报告显示该图像的 pdf 格式。现在，如果我用 test.aspx 打开它会替换图像页面。但我想同时查看图形和pdf。一种解决方案是我创建一个新的空白 aspx 页面来显示报告，但我尽量避免添加新页面，因为可以在 test.aspx 上安装报告。

问题只是同时打开一个 POPUP 窗口两次，但它可能是否可行。并且每个弹出窗口都包含自己的动态控件和报告，例如 mrt。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2013-01-16T06:02:33.190

在两个不同的调用中更改窗口名称：

```
function popitup(url,windowName) {
       newwindow=window.open(url,windowName,'height=200,width=150');
       if (window.focus) {newwindow.focus()}
       return false;
     } 
```

当您打开具有相同 url 的新窗口时，windowName 必须是唯一的，否则将刷新相同的窗口。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-01-16T05:36:21.307

要创建弹出窗口，您需要以下脚本：

```
<script language="javascript" type="text/javascript">

function popitup(url) {
newwindow=window.open(url,'name','height=200,width=150');
if (window.focus) {newwindow.focus()}
return false;
}

</script> 
```

然后，您通过以下方式链接到它：

```
 <a href="popupex.html" onclick="return popitup('popupex.html')">Link to popup</a> 
```

如果您愿意，您也可以直接从 document.ready 调用该函数。或者也许来自另一个功能。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-01-16T06:15:48.807

第一点是 - 在可用性方面显示多个弹出窗口是不可取的。

但是您可以通过使用多个弹出名称来实现它

```
var newwindow;
function createPop(url, name)
{    
   newwindow=window.open(url,name,'width=560,height=340,toolbar=0,menubar=0,location=0');  
   if (window.focus) {newwindow.focus()}
} 
```

更好的方法是在两个不同的 iFrame 或 Div 的单个页面中显示两者。

**更新：**

所以我会建议在test.aspx页面中新建一个tab来显示报告，而不是替换图片内容并放置pdf。

# java - 如何制作客户端，从原位置下载文件？

> ID：14351772
> 
> 赞同：0
> 
> 时间：2013-01-16T05:11:54.240
> 
> 标签：java, jakarta-ee, tomcat, tomcat7, network-protocols

让我们假设有两个节点。

节点 1 的 IP =`100.100.100.1`

节点 2 的 IP =`100.100.100.2`

Node-2 有一个名为的文件`foo.mp3`，并且正在运行一个服务器。让我们说，Tomcat。`Node-1`正在寻找该文件`foo.mp3`并知道`node-2`它在其硬盘驱动器上的某个位置。`foo.mp3`假设到on的路径`node-2`是`E:/foo/foo.mp3`。`Node-2`可以简单地复制`foo.mp3`到他的`webapps`文件夹中`tomcat`并创建如下链接：

```
<a href="./foo.mp3">Click to download</a> 
```

但是有什么办法可以让他摆脱复制文件的责任呢？有没有办法让他可以给出一个文件的路径，它已经存在了这么久！喜欢 ：

```
<a href="E:/foo/foo.mp3">Click to download</a> 
```

`node-1`因为除非和`node-2`相同，否则这是行不通的！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T14:08:18.320

如果 Node-1 知道文件在 Node-2 上的位置，为什么 Node-1 不直接指向 Node-2 的链接，如下：

```
<a href="http://100.100.100.2/foo/foo.mp3">Click to download</a> 
```

# ruby - rvm 升级失败 - OSX Lion

> ID：14351773
> 
> 赞同：0
> 
> 时间：2013-01-16T05:11:58.540
> 
> 标签：ruby, macos, rvm

> **可能重复：**
> [使用 RVM (OSX 10.8) 安装 Ruby 时出错](https://stackoverflow.com/questions/14072524/error-installing-ruby-with-rvm-osx-10-8)

我正在尝试升级我的 Ruby 版本——现在我在 p194 上——我看到有 p362 可用。注意：我是新来的，如果我误解了什么，对不起。

我在 Macbook Pro、OSX 10.7.5 上，我的 ruby​​ 版本是：

```
[~]$红宝石 -v
ruby 1.9.3p194（2012-04-20 修订版 35410）[x86_64-darwin11.4.0]
```

因此，当我尝试使用 RVM 升级时，我运行以下命令：

```
[~]$rvm 升级 1.9.3-p194 1.9.3-p362
```

然后它要求我确认，我说是，然后它运行，然后它给了我错误：

```
安装新的 ruby​​ ruby​​-1.9.3-p362
没有可用的二进制红宝石：downloads/ruby-1.9.3-p362。

继续编译。请阅读“rvm mount”以获取有关二进制红宝石的更多信息。

从源代码安装 Ruby 到：/usr/local/rvm/rubies/ruby-1.9.3-p362，这可能需要一段时间，具体取决于您的 cpu... 

ruby​​-1.9.3-p362 - #downloading ruby​​- 1.9.3-p362，这可能需要一段时间，具体取决于您的连接... 

ruby​​-1.9.3-p362 - #extracted to /usr/local/rvm/src/ruby-1.9.3-p362（已经提取）

补丁segfault_fix_7629 已应用。

ruby-1.9.3-p362 - #configuring

错误运行 'env LDFLAGS=-L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active/include ./configure --enable -shared --disable-install-doc --prefix=/usr/local/rvm/rubies/ruby-1.9.3-p362 --with-opt-dir=/usr/local/rvm/usr'，请阅读/ usr/local/rvm/log/ruby-1.9.3-p362/configure.log

运行configure时出现错误。停止安装。

将 gem 从 1.9.3-p194 迁移到 ruby​​-1.9.3 

-p362 未安装 Ruby 'ruby-1.9.3-p362' - 请先安装它。

迁移 gem 时出错。

```

然后我运行：

```
[~]$rvm 安装 ruby​​-1.9.3-p362
```

我得到这个错误：

```
没有可用的二进制红宝石：downloads/ruby-1.9.3-p362。
继续编译。请阅读“rvm mount”以获取有关二进制红宝石的更多信息。
从源代码安装 Ruby 到：/usr/local/rvm/rubies/ruby-1.9.3-p362，这可能需要一段时间，具体取决于您的 CPU...
ruby-1.9.3-p362 - #downloading ruby​​-1.9.3-p362，这可能需要一段时间，具体取决于您的连接...
ruby-1.9.3-p362 - #extracted to /usr/local/rvm/src/ruby-1.9.3-p362 (已经提取)
补丁 segfault_fix_7629 已应用。
ruby-1.9.3-p362 - #configuring
错误运行 'env LDFLAGS=-L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active/include ./configure --enable -shared --disable-install-doc --prefix=/usr/local/rvm/rubies/ruby-1.9.3-p362 --with-opt-dir=/usr/local/rvm/usr'，请阅读/ usr/local/rvm/log/ruby-1.9.3-p362/configure.log
运行配置时出现错误。停止安装。
```

于是我打开了它所引用的那个日志文件，下面是内容：

```
[2013-01-15 23:01:13] env LDFLAGS=-L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/活动/包括 ./configure --enable-shared --disable-install-doc --prefix=/usr/local/rvm/rubies/ruby-1.9.3-p362 --with-opt-dir=/usr/local /rvm/usr
检查构建系统类型... x86_64-apple-darwin11.4.2
检查主机系统类型... x86_64-apple-darwin11.4.2
检查目标系统类型... x86_64-apple-darwin11.4.2
检查 C 编译器默认输出文件名...
配置：错误：C 编译器无法创建可执行文件
更多细节见“config.log”。
```

请告知这里发生的事情以及如何纠正这个问题。

先感谢您。

# character-encoding - iMacros 字符编码问题

> ID：14351777
> 
> 赞同：0
> 
> 时间：2013-01-16T05:12:11.977
> 
> 标签：character-encoding, macros, web-scraping, imacros

我正在尝试从网站上抓取，但 iMacro 不加载页面。网址转到=http://www.grosshandel-produkte.com/adressen/detail/id/13500

在 Firefox 17 Web 控制台上出现错误提示，

GET [http://www.grosshandel-produkte.com/adressen/detail/id/13500](http://www.grosshandel-produkte.com/adressen/detail/id/13500) [HTTP/1.0 500 内部服务器错误 598ms]

未声明 HTML 文档的字符编码。如果文档包含 US-ASCII 范围之外的字符，则文档将在某些浏览器配置中呈现乱码。页面的字符编码必须在文档或传输协议中声明。

有没有办法在 iMacros 中强制执行字符集？我尝试更改浏览器字符集。它也没有用。该网站是德国的。我尝试了 utf-8，但没有用。

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:53:54.827

使用 smartsniff 或 Fiddler2 并正常导航到该站点，它们会告诉您在尝试加载站点并识别故障时使用什么编码等。

```
GET http://www.grosshandel-produkte.com/adressen/detail/id/13500 HTTP/1.1
Host: www.grosshandel-produkte.com
Connection: keep-alive
Cache-Control: max-age=0
User-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.97 Safari/537.11
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Encoding: gzip,deflate,sdch
Accept-Language: en-GB,en-US;q=0.8,en;q=0.6
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3
Cookie: symfony=9pebil173uvj7j4r61ntbu3072; __utma=21097197.1518127093.1358333525.1358333525.1358333525.1; __utmb=21097197.0.10.1358333525; __utmc=21097197; __utmz=21097197.1358333525.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none) 
```

回应是：

```
HTTP/1.1 200 OK
Date: Wed, 16 Jan 2013 10:53:09 GMT
Server: Apache
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Pragma: no-cache
P3P: CP="ALL CURa ADMa DEVa TAIa OUR BUS IND PHY UNI PUR COM NAV INT DEM"
X-Powered-By: PleskLin
Connection: close
Transfer-Encoding: chunked
Content-Type: text/html; charset=utf-8 
```

分块响应：P

# python - 读取子进程的 STDERR

> ID：14351778
> 
> 赞同：0
> 
> 时间：2013-01-16T05:12:32.847
> 
> 标签：python, subprocess

我在使用 subprocess.Popen 时遇到了一个问题。我在[这里](https://stackoverflow.com/questions/2804543/read-subprocess-stdout-line-by-line)解决了这个问题。当我将以下编辑添加到 fake_utility.py 时，即在 subprocess.Popen 添加**stderr=** subprocess.PIPE ：

```
#fake_utility.py
import time
i = 0
while True:
   print hex(i)*512
   i += 1
   time.sleep(0.5)

#python interpreter
import subprocess
proc = subprocess.Popen(['python','fake_utility.py'],stdout=subprocess.PIPE, stderr=subprocess.PIPE)
for err in proc.stderr:
    print "err::", err

for line in proc.stdout:
   print "test:", line.rstrip() 
```

程序没有响应。当我按下 Ctrl-C 时，我得到以下信息：

```
Traceback (most recent call last):
File "run_fake_utility.py", line 6, in <module>
    err = proc.stderr.readline()
KeyboardInterrupt 
```

它在 proc.stderr.readline() 中被阻止。如果我删除从 proc.stderr 读取的行，程序运行良好。

可能的错误是什么？我正在使用 Python2.6。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T05:20:37.997

阻止从 STDERR 读取将表明子进程尚未向该文件句柄写入任何内容。

你真的期待什么吗？（即：如果您从 shell 手动运行相同的命令并将 STDERR - `2>file.txt`- 重定向到文件，该文件是非空的吗？）

否则，可能会发生一些常见的事情：

*   您尚未在 STDERR 输出中收到换行符
*   您还没有收到足够的数据来填充一些底层缓冲区

# python - PySide QtTreeWidget 第一列 srretches

> ID：14351779
> 
> 赞同：1
> 
> 时间：2013-01-16T05:12:36.747
> 
> 标签：python, qt, pyside

我正在使用 PySide，并且我有一个带有 8 个标题列的 QtTreeWidget。第一列仅包含复选框，但第一列的扩展超出了应有的范围。有什么我想念的吗？

# c# - 使用 linq 组合两个数据表并从第二个表中获取金额

> ID：14351780
> 
> 赞同：3
> 
> 时间：2013-01-16T05:12:41.203
> 
> 标签：c#, .net, linq

我有两个表，如下所示。

表格1

```
╔══════════════╦═════╦════╗
║     NAME     ║ AGE ║ ID ║
╠══════════════╬═════╬════╣
║ firstname 1  ║  20 ║  1 ║
║ firstname 2  ║  21 ║  2 ║
║ firstname 3  ║  22 ║  3 ║
║ firstname 4  ║  23 ║  4 ║
║ firstname 5  ║  24 ║  5 ║
║ firstname 6  ║  25 ║  6 ║
║ firstname 7  ║  26 ║  7 ║
║ firstname 8  ║  27 ║  8 ║
║ firstname 9  ║  28 ║  9 ║
║ firstname 10 ║  29 ║ 10 ║
╚══════════════╩═════╩════╝ 
```

表 2

```
╔════════╦══════════╗
║ LINKID ║ QUANTITY ║
╠════════╬══════════╣
║      1 ║        1 ║
║      1 ║        1 ║
║      2 ║        1 ║
║      2 ║        1 ║
║      2 ║        1 ║
║      3 ║        1 ║
║      3 ║        1 ║
║      3 ║        1 ║
║      3 ║        1 ║
║      4 ║        1 ║
║      4 ║        1 ║
║      4 ║        1 ║
║      4 ║        1 ║
║      4 ║        1 ║
║      5 ║        1 ║
║      5 ║        1 ║
║      5 ║        1 ║
║      5 ║        1 ║
║      5 ║        1 ║
║      5 ║        1 ║
║      6 ║        1 ║
║      6 ║        1 ║
║      6 ║        1 ║
║      6 ║        1 ║
║      6 ║        1 ║
║      6 ║        1 ║
║      6 ║        1 ║
║      7 ║        1 ║
║      7 ║        1 ║
║      7 ║        1 ║
║      7 ║        1 ║
║      7 ║        1 ║
║      7 ║        1 ║
║      7 ║        1 ║
║      7 ║        1 ║
║      8 ║        1 ║
║      8 ║        1 ║
║      8 ║        1 ║
║      8 ║        1 ║
║      8 ║        1 ║
║      8 ║        1 ║
║      8 ║        1 ║
║      8 ║        1 ║
║      8 ║        1 ║
║      9 ║        1 ║
║      9 ║        1 ║
║      9 ║        1 ║
║      9 ║        1 ║
║      9 ║        1 ║
║      9 ║        1 ║
║      9 ║        1 ║
║      9 ║        1 ║
║      9 ║        1 ║
║      9 ║        1 ║
║     10 ║        1 ║
║     10 ║        1 ║
║     10 ║        1 ║
║     10 ║        1 ║
║     10 ║        1 ║
║     10 ║        1 ║
║     10 ║        1 ║
║     10 ║        1 ║
║     10 ║        1 ║
║     10 ║        1 ║
║     10 ║        1 ║
╚════════╩══════════╝ 
```

结果表如下所示。

```
╔══════════════╦═════╦════╦═════╗
║     NAME     ║ AGE ║ ID ║ QTY ║
╠══════════════╬═════╬════╬═════╣
║ firstname 1  ║  20 ║  1 ║   2 ║
║ firstname 2  ║  21 ║  2 ║   3 ║
║ firstname 3  ║  22 ║  3 ║   4 ║
║ firstname 4  ║  23 ║  4 ║   5 ║
║ firstname 5  ║  24 ║  5 ║   6 ║
║ firstname 6  ║  25 ║  6 ║   7 ║
║ firstname 7  ║  26 ║  7 ║   8 ║
║ firstname 8  ║  27 ║  8 ║   9 ║
║ firstname 9  ║  28 ║  9 ║  10 ║
║ firstname 10 ║  29 ║ 10 ║  11 ║
╚══════════════╩═════╩════╩═════╝ 
```

我希望在 1 个 linq 语句内完成此操作。（如果完全不可能，2 个陈述）

到目前为止，我已经完成了我的声明。

```
 var resultQuery = from a in dtbl1.AsEnumerable()
                      join b in dtbl2.AsEnumerable()
                      on a.Field<int>("ID") equals b.Field<int>("LinkID")

                      select new
                      {
                          ID = a["ID"],
                          Name = a["Name"],
                          Age = a["Age"],
                          Qty = b["Quantity"]
                      }
                      ; 
```

该语句将结合 2 个表，但我不知道如何继续计算数量。

任何的想法？

* * *

如果我必须使用第二个查询，它已经完成。

```
 var secondResultQuery = from row in resultQuery
                            group row by new { row.ID, row.Name, row.Age } into g
                            select new
                            {
                                g.Key.ID,
                                g.Key.Name,
                                g.Key.Age,
                                totalCount = g.Sum(count => (int)count.Qty)
                            }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T06:37:52.360

```
var resultSet   =   from a in dtbl1.AsEnumerable()
                    join b in dtbl2.AsEnumerable()
                        on a.ID equals b.LinkID
                    group a by new
                        {
                            a.Name,
                            a.Age,
                            a.ID
                        } into g
                    select new
                        {
                            g.Key.Name,
                            g.Key.Age,
                            g.Key.ID,
                            g.Count()
                        }; 
```

* * *

要使用的查询`DataTable`

```
var resultSetTicketNo   =   from a in dtbl1.AsEnumerable()
                        join b in dtbl2.AsEnumerable()
                        on a.Field<int>("ID") equals b.Field<int>("LinkID")
                        group a by new
                        {
                            Age = a["Age"],
                            ID = a["ID"],
                            Name = a["Name"]
                        } into g
                        select new
                        {
                            g.Key.Name,
                            g.Key.Age,
                            g.Key.ID,
                            Counter=g.Count()
                        };

    foreach (var a in resultSetTicketNo)
    {
        Response.Write(a.ID + "~" + a.Name + "~" + a.Age + "~" + a.Counter + "<br/>");
    }

    Response.Write("<br/><br/>end of resultSetTicketNo<br/><br/>"); 
```

# java - 更新图形

> ID：14351784
> 
> 赞同：1
> 
> 时间：2013-01-16T05:12:53.037
> 
> 标签：java, swing

我在这段代码中遇到了一些问题，由于某些奇怪的原因，图形似乎不想更新。我不知道如何解决这个问题，尝试解决这个问题真的很烦人，请帮忙！这是代码：

```
package org.jeopredy;

import java.awt.*;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.util.ArrayList;

import javax.swing.*;

public class Main extends JFrame {

public Main() {
    super("Jeopredy");
    this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    this.setSize(517, 640);
    this.setVisible(true);
    this.add(new panel());
    this.addMouseListener(new panel());
}

public static void main(String args[]) {
    new Main();
}

private class panel extends JPanel implements MouseListener {

    public Rectangle[][] tiles = new Rectangle[5][6];

    public boolean start, question, answer;

    public String[][] Catagories = { { "House of", "representitives" },
            { "Senate" }, { "President" }, { "Vice president" },
            { "Supreme court" } };

    public String[][] Questions = { { "1", "2", "3", "4", "5" },
            { "1", "2", "3", "4", "5" }, { "1", "2", "3", "4", "5" },
            { "1", "2", "3", "4", "5" }, { "1", "2", "3", "4", "5" } };

    public String[][] Answers = { { "", "", "", "", "" },
            { "", "", "", "", "" }, { "", "", "", "", "" },
            { "", "", "", "", "" }, { "", "", "", "", "" } };

    public Point q, a;

    public ArrayList<Point> used = new ArrayList<Point>();

    public panel() {
        start = true;
        for (int x = 0; x < 500; x += 100) {
            for (int y = 0; y < 600; y += 100) {
                tiles[x / 100][y / 100] = new Rectangle(x, y, 100, 100);
            }
        }
        repaint();
    }

    @Override
    public void paint(Graphics g) {
        // super.paintComponent(g);
             //g.setColor(Color.white);

         System.out.println("Start: " + start + " question: " + question
         + " answer: " + answer);
        if (start) {
            int i = 0;
            for (String[] str : Catagories) {
                if (str.length == 1) {
                    g.drawString(str[0], tiles[i][0].x, tiles[i][0].y + 20);
                } else {
                    g.drawString(str[0], tiles[i][0].x, tiles[i][0].y + 20);
                    g.drawString(str[1], tiles[i][0].x, tiles[i][0].y + 30);
                }
                i++;
            }
            for (Rectangle[] rect : tiles) {
                for (Rectangle r : rect) {
                    g.drawRect(r.x, r.y, r.width, r.height);
                }
            }
        } else if (question) {
            // System.out.println("QUeStionJOSNLN");
            g.drawString(Questions[q.x][q.y], 100, 100);
        }
        repaint();
    }

    @Override
    public void mouseClicked(MouseEvent arg0) {
        Point p = new Point(arg0.getPoint().x - 17, arg0.getPoint().y - 40);
        // repaint();
        if (start) {
            for (int x = 0; x < tiles.length; x++) {
                for (int y = 0; y < tiles[x].length; y++) {
                    if (tiles[x][y].contains(p) && y != 0) {
                        question = true;
                        start = false;
                        answer = false;
                        q = new Point(x, y - 1);
                        used.add(q);
                    }
                }
            }
        } else if (question) {
            answer = true;
            question = false;
            start = false;
        } else if (answer) {
            start = true;
            answer = false;
            question = false;
        }

    }

    @Override
    public void mouseEntered(MouseEvent arg0) {
        // TODO Auto-generated method stub

    }

    @Override
    public void mouseExited(MouseEvent arg0) {
        // TODO Auto-generated method stub

    }

    @Override
    public void mousePressed(MouseEvent arg0) {
        // TODO Auto-generated method stub

    }

    @Override
    public void mouseReleased(MouseEvent arg0) {
        // TODO Auto-generated method stub

    }
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T05:23:04.907

1.  首先，你永远不应该覆盖`paint()`. 我认为这是你的问题的**主要原因**。

[Swing中paint、paintComponent和paintComponents的区别](https://stackoverflow.com/questions/9389187/difference-between-paint-paintcomponent-and-paintcomponents-in-swing)

2.  用于`SwingUtilities.invokeLater()`加载 GUI

3.  不要扩展JFrame，完全不推荐，在上面的代码中也没用

4.  `private class panel extends JPanel implements`类应该以大写字母开头`MyPanel`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-16T05:26:52.630

在我四处挖掘的同时，让我们从...

```
public void paint(Graphics g) { // <<-- This is bad
    // super.paintComponent(g);
    //g.setColor(Color.white);

    System.out.println("Start: " + start + " question: " + question+ " answer: " + answer);
    if (start) {
        int i = 0;
        for (String[] str : Catagories) {
            if (str.length == 1) {
                g.drawString(str[0], tiles[i][0].x, tiles[i][0].y + 20);
            } else {
                g.drawString(str[0], tiles[i][0].x, tiles[i][0].y + 20);
                g.drawString(str[1], tiles[i][0].x, tiles[i][0].y + 30);
            }
            i++;
        }
        for (Rectangle[] rect : tiles) {
            for (Rectangle r : rect) {
                g.drawRect(r.x, r.y, r.width, r.height);
            }
        }
    } else if (question) {
        // System.out.println("QUeStionJOSNLN");
        g.drawString(Questions[q.x][q.y], 100, 100);
    }
    repaint(); // <<-- This is bad
} 
```

您应该避免覆盖`paint`. 有很多原因，但基本上，现在你已经完全摧毁了整个油漆链。Swing 中的绘画很复杂，而且很容易毁掉。你必须打电话`super.paint(g)`。

最好覆盖`paintComponent`，别忘了打电话`super.paintComponent`！！

切勿在任何绘制方法中更改 UI。通常调用 Paint 以响应重绘请求，修改任何可能导致另一个请求的 UI 将使您陷入 CPU 过载和资源占用的滑坡......

**更新**

```
this.add(new panel());
this.addMouseListener(new panel()); 
```

这永远不会将鼠标事件发送到屏幕上的面板。您需要针对`panel`屏幕上的那个注册鼠标侦听器。

你实际上会更好地这样做......

```
public panel() {
    addMouseListener(this);
    //...continue...
} 
```

**更新#2**

试着记住，油漆是无国籍的。之前绘制的内容不会出现在下一个绘制周期中。无论你需要画什么，都必须在每个周期上画。

**更新#3**

我对你的程序想要达到的目标有点困惑，但看看这些改动，看看是否有帮助......

```
public class Main extends JFrame {

  public Main() {
    super("Jeopredy");
    this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    this.setSize(517, 640);
    this.add(new panel());
    this.setVisible(true);
  }

  public static void main(String args[]) {
    EventQueue.invokeLater(new Runnable() {
      @Override
      public void run() {
        new Main();
      }
    });
  }

  private class panel extends JPanel implements MouseListener {

    public Rectangle[][] tiles = new Rectangle[5][6];
    public boolean start, question, answer;
    public String[][] Catagories = {{"House of", "representitives"},
      {"Senate"}, {"President"}, {"Vice president"},
      {"Supreme court"}};
    public String[][] Questions = {{"1", "2", "3", "4", "5"},
      {"1", "2", "3", "4", "5"}, {"1", "2", "3", "4", "5"},
      {"1", "2", "3", "4", "5"}, {"1", "2", "3", "4", "5"}};
    public String[][] Answers = {{"", "", "", "", ""},
      {"", "", "", "", ""}, {"", "", "", "", ""},
      {"", "", "", "", ""}, {"", "", "", "", ""}};
    public Point q, a;
    public ArrayList<Point> used = new ArrayList<Point>();

    public panel() {
      addMouseListener(this);
      start = true;
      for (int x = 0; x < 500; x += 100) {
        for (int y = 0; y < 600; y += 100) {
          tiles[x / 100][y / 100] = new Rectangle(x, y, 100, 100);
        }
      }
      repaint();
    }

    @Override
    protected void paintComponent(Graphics g) {
      super.paintComponent(g); 

      System.out.println("Start: " + start + " question: " + question
          + " answer: " + answer);
      if (start) {
        int i = 0;
        for (String[] str : Catagories) {
          if (str.length == 1) {
            g.drawString(str[0], tiles[i][0].x, tiles[i][0].y + 20);
          } else {
            g.drawString(str[0], tiles[i][0].x, tiles[i][0].y + 20);
            g.drawString(str[1], tiles[i][0].x, tiles[i][0].y + 30);
          }
          i++;
        }
        for (Rectangle[] rect : tiles) {
          for (Rectangle r : rect) {
            g.drawRect(r.x, r.y, r.width, r.height);
          }
        }
      } else if (question) {
        // System.out.println("QUeStionJOSNLN");
        g.drawString(Questions[q.x][q.y], 100, 100);
      }
//      repaint();
    }

    @Override
    public void mouseClicked(MouseEvent arg0) {
//      Point p = new Point(arg0.getPoint().x - 17, arg0.getPoint().y - 40);
      Point p = arg0.getPoint();
      // repaint();
      if (start) {
        for (int x = 0; x < tiles.length; x++) {
          for (int y = 0; y < tiles[x].length; y++) {
            if (tiles[x][y].contains(p) && y != 0) {
              question = true;
              start = false;
              answer = false;
              q = new Point(x, y - 1);
              used.add(q);
            }
          }
        }
      } else if (question) {
        answer = true;
        question = false;
        start = false;
      } else if (answer) {
        start = true;
        answer = false;
        question = false;
      }

      repaint();

    }

    @Override
    public void mouseEntered(MouseEvent arg0) {
      // TODO Auto-generated method stub
    }

    @Override
    public void mouseExited(MouseEvent arg0) {
      // TODO Auto-generated method stub
    }

    @Override
    public void mousePressed(MouseEvent arg0) {
      // TODO Auto-generated method stub
    }

    @Override
    public void mouseReleased(MouseEvent arg0) {
      // TODO Auto-generated method stub
    }
  }
} 
```

# php - 如何从我的表单将图像上传到 mysql db？

> ID：14351787
> 
> 赞同：0
> 
> 时间：2013-01-16T05:13:03.550
> 
> 标签：php, html, forms

如何从我的表单将图像上传到 mysql db？在我设置的表单中，我还在我的数据库中将此字段的数据类型定义为 longblob 但没有将图像输入到 db

我只是简单地将其插入到数据库中插入查询。

请帮帮我。。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T05:21:29.527

在数据库中使用 blob 数据类型字段。

```
 $image_url = 'http://www.technew.in/templates/dino/images/technew_head.png';
  $imageData = chunk_split(base64_encode(file_get_contents($image_url)));
  $query = "INSERT INTO db_image (image_data) VALUES('$imageData')";
  mysql_query($query) or die(mysql_error()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T05:16:25.597

为您的列使用 blob 数据类型，读取上传的文件并使用带斜杠。下面是一个例子。

```
//open a file
$file = fopen($_FILES['fileToUpload']['tmp_name'], "r") or die("Error");

//read the contents of file
$contents = fread($file, filesize($_FILES['fileToUpload']['tmp_name']));

//add slashes. For details refer http://php.net/manual/en/function.addslashes.php
$contents = addslashes($contents);

//fire query to insert
mysql_query("INSERT INTO content(`img`) VALUES ('$contents');") or die(mysql_error()); 

//close file
fclose($file); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T05:21:14.770

您可以查看以下快速链接以获取上述工作示例。

1.  [http://forum.codecall.net/topic/40286-tutorial-storing-images-in-mysql-with-php/](http://forum.codecall.net/topic/40286-tutorial-storing-images-in-mysql-with-php/)
2.  [http://www.tizag.com/phpT/fileupload.php](http://www.tizag.com/phpT/fileupload.php)
3.  [http://www.techtoolblog.com/archives/upload-files-to-mysql-using-php-tutorial](http://www.techtoolblog.com/archives/upload-files-to-mysql-using-php-tutorial)

查看它们...您可以使用 Upload.PHP 相同的内容，然后将文件存储在数据库中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T05:27:31.853

最好将图片保存在项目的根目录中，例如图像文件夹。
并使用 nvarchar 或 varchar 数据类型将图片路径或图片名称保存在数据库中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-16T05:17:21.180

您要做的是将已上传到您确定的特定文件夹的图像的路径存储起来。阅读下面的链接。

我认为从链接中复制和粘贴代码是没有用的。

[http://staffweb.cms.gre.ac.uk/~mk05/web/PHP/imageUpload.html](http://staffweb.cms.gre.ac.uk/~mk05/web/PHP/imageUpload.html)

[http://www.namepros.com/webmaster-tutorials/81935-upload-image-to-mysql-database-php.html](http://www.namepros.com/webmaster-tutorials/81935-upload-image-to-mysql-database-php.html)

[http://www.namepros.com/webmaster-tutorials/81935-upload-image-to-mysql-database-php.html](http://www.namepros.com/webmaster-tutorials/81935-upload-image-to-mysql-database-php.html)

如果您有任何问题，请告诉我

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-16T05:17:56.460

上传文件并将文件保存路径存储为 varchar

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-16T05:20:52.847

`move_uploaded_file`使用函数将文件上传到服务器中的文件夹

并将此路径保存在您的数据库字段中。

# activerecord - 扩展 Propel 以模拟数据库功能

> ID：14351792
> 
> 赞同：0
> 
> 时间：2013-01-16T05:13:45.033
> 
> 标签：activerecord, orm, propel

我需要将应用程序从 MySQL 转换为 SQL Server。

有许多涉及 MySQL 数据库函数的硬编码查询，例如**NOW()**、**LCASE()**、**MATCH() AGAINST()**，它们在 SQL Server 中具有等价物，但语法和结构不同。

我选择**Propel**是因为它似乎易于使用。

我正在寻找一种通过扩展 Propel 类来模拟**NOW()** *{MySQL}*和**GETDATE()** *{SQL Server}等数据库函数的方法。*

我认为是这样的：

```
$result = Function::NOW(); // MySQL
$result = Function::GETDATE(); // SQL Server 
```

当函数接受参数时，例如**LCASE()** *{MySQL}*或**LOWER()** *{SQL Server}*，它可能是这样的：

```
$table = new MyTable();
$result = Function::LCASE($table->getName()); // MySQL
$result = Function::LOWER($table->getName()); // SQL Server 
```

或者

```
$table = new MyTable();
$result = Function::MD5($table->getPassword()); // MySQL
$result = Function::HASHBYTES('MD5', $table->getPassword()); // SQL Server 
```

完美的解决方案是，如果我可以在来自不同数据库（MySQL 和 SQL Server）的具有相同目的的两个函数之间创建等价。

因此，我可以始终使用**Function::MD5()**而不是在我的 PHP 代码中使用**Function::HASHBYTES(** ) ，因为它更简单，并且当我的应用程序在内部连接到 SQL Server 数据库时，*HASHBYTES()*被调用。

# c# - 标签字段与winform中的TextField重叠

> ID：14351811
> 
> 赞同：1
> 
> 时间：2013-01-16T05:17:02.380
> 
> 标签：c#, winforms

我正在`winform`用 C# 设计一个基于桌面的应用程序。该应用程序在 Windows 7 中运行得非常好。但是，当我安装在运行 Windows XP 的客户端系统中时，该应用程序的外观看起来非常不同。

我已经`Pixel`为设计中的每个控件使用了单位，并且希望在 XP 和 Windows 7 中看起来都一样。

我尝试更改系统分辨率但没有成功。

举个例子，标签字段与 Combo 字段重叠。

![在此处输入图像描述](../Images/0a5dff96030017f390cb795c8b58908b.png)

除此之外，还有一些控制发生这种重叠的地方。任何想法，可能出了什么问题？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T05:28:13.010

您的 XP 机器可能正在使用大字体或超大字体。

右键单击桌面的空白部分，单击“属性”，选择“外观”选项卡，您将看到“字体大小”组合框。如果未设置为“正常”，请将其更改为“正常”并重新启动。

# c++ - 在 C++ 中记录动态数据

> ID：14351817
> 
> 赞同：0
> 
> 时间：2013-01-16T05:17:38.070
> 
> 标签：c++, logging, sequence

我的程序中有一些动态队列，可以在处理过程中在后面或中间添加元素/从前面删除元素，一旦处理完成就永远不会将元素存储在内存中。但是我想记录/序列化序列的动态状态，包括出于自省目的而删除的所有元素。

例如

```
 struct element1{};
    struct element2{};
    std::deque<element1> v1;
    std::deque<element2> v2;

    if(some_cond1)
    {
       v1.push_back(element1{});
       //log v1.back()
       v1.push_back(element1{});
       //log v1.back()
    }
    if(some_cond2)
    {
       v2.push_back(element2{});
       //log v2.back()
       v2.push_back(element2{});
       //log v2.back()
    }
    if(another_cond)
    {
       v1.pop_front();//presently I am not logging removal of elements
       v2.pop_front();
    }
    if(a_third_cond)
    {
       v1.insert(some_pos,element1{});
       //log v1,some_pos
    } 
```

我正在寻找两种替代解决方案。

*   是否有一些数据格式（比如 JSON）允许数组/对象分布在不同的位置并通过一些唯一的名称/ID 引用，因为我没有保留内存中准备好的所有元素以写入文件并仅记录部分我去的顺序？

例如

```
 { 
     "v1" : [],
     "v2" : [],
     append("v1"):
     [
        "elem1_v1", "elem2_v1"
     ],
     append("v2"):
     [
        "elem1_v2", "elem2_v2"
     ],
     insert("v1",1):
     [
        "elem3_v1"
     ]
   } 
```

*   是否可以将多个不同的位置写入单个文件，以便每个序列跟踪自己的位置并写入该位置，以便最终结果是简单的连续序列描述？（我能想到的只是文件支持的 SGI 绳索实现）

在这种情况下，最终结果可能如下所示，

```
 { 
     "v1" : ["elem1_v1","elem3_v1","elem2_v1"],
     "v2" : ["elem1_v2","elem2_v2"]
   } 
```

当然，以一种粗略的方式，我可以将所有元素记录在一个平面文件中，并以一些信息为前缀，例如哪个序列和位置，然后在整个文件中搜索它们以重建它们。但是，如果可以处理此类问题，我正在寻找一种更强大、更结构化的替代方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T07:56:17.157

您最好的选择是顺序记录（带有标识符）加上以后的重建。

随机访问日志的问题有两个：

*   在大多数磁盘上，随机写入比顺序写入慢得多
*   你应该预留多少空间？当它精疲力竭时你会做什么？

大多数时候，日志记录*不是*应用程序的主要目标。它是出于调查目的而添加的。因为它不是必需的，所以它应该是平淡无奇的：

*   不工作？好吧，应用程序没有理由崩溃
*   慢得要命？好吧，没有理由减慢应用程序的速度
*   ...

让离线流程完成繁重的工作并协调数据。

# ruby-on-rails - Rails 中的大礼包定制

> ID：14351818
> 
> 赞同：0
> 
> 时间：2013-01-16T05:17:43.887
> 
> 标签：ruby-on-rails, ruby-on-rails-3, spree

在 Rails 中自定义 spree 应用程序的最佳方法以及从哪里可以看到应用程序的现有代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T11:52:58.350

你可以在机器上找到它...

1.  找到您的应用

2.  运行命令，`"bundle show spree`"

例如在我的机器上：

```
/home/rathore/.rvm/gems/ruby-1.9.2-p320/gems/spree-1.2.0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T11:15:56.367

[您可以在其 git hub 站点https://github.com/spree/spree](https://github.com/spree/spree)查看默认的 spree 代码。

自定义 Spree 站点的最佳方法是通过 deface overrides，一个很好的示例可以在预先存在的 Spree 主题的代码中找到，例如演示 spree 站点 RDR 的主题，可以在[https://找到github.com/spree/spree_rdr_theme](https://github.com/spree/spree_rdr_theme)。

基本上任何已经存在于 Spree 代码库中的页面都可以使用 Deface 覆盖，简单的介绍可以在 Spree 定制指南[http://guides.spreecommerce.com/customization.html中找到](http://guides.spreecommerce.com/customization.html)

# iphone - rev mob 的展示位置 ID 是什么

> ID：14351822
> 
> 赞同：1
> 
> 时间：2013-01-16T05:18:17.127
> 
> 标签：iphone, revmob

我尝试寻找有关它的信息，但我仍然不清楚它是什么。主要是它在 iPhone 开发中的用途？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T16:41:41.050

展示位置 ID 是您在应用内识别广告的方式。有了这个，您将能够查看个人统计信息并控制此特定广告（播放暂停）。

例如，如果您想在游戏阶段结束时放置全屏，但您不确定是否是一个好地方。您可以为此广告设置展示位置 ID，并检查统计信息以评估它是否是一个好主意。如果效果不佳，您可以只暂停此广告，而无需提交新版本或暂停所有广告。

# tinymce - TinyMCE 无法浏览图像或文件

> ID：14351824
> 
> 赞同：1
> 
> 时间：2013-01-16T05:18:18.440
> 
> 标签：tinymce, modx, modx-revolution

我有一个关于 TinyMCE (4.3.3) 的问题，如果您单击图像图标，然后浏览，我会在弹出的浏览窗口中收到服务器错误：

`Error 324 (net::ERR_EMPTY_RESPONSE): The server closed the connection without sending any data.`

如果我单击链接图标，也会发生同样的情况。

这与权限有关吗？如果是这样，我改变哪个文件目录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-04T14:44:04.007

可能是您的文件夹中有一个图像，文件名中有一个非英文字母吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T10:08:52.760

确保服务器用户可以访问 tinymce 目录中的所有文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-17T13:14:19.673

进入文件夹或查看图像的问题通常会丢失权限。[请在您的 linux-server 上](http://www.linuxtopia.org/online_books/introduction_to_linux/linux_The_chmod_command.html)检查chmod 和 chown 。使用 FTP 客户端（如 filezilla、totalcommander）或通过 SSH 检查文件和文件夹的属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-18T08:03:59.133

如果不起作用，您也可以尝试重新安装 TinyMCE 或 MODX。如果操作正确，您将不会丢失数据。这样，所有权限和文件都将被恢复。

# java - 如何获取 HashMap 中特定值的键？

> ID：14351825
> 
> 赞同：2
> 
> 时间：2013-01-16T05:18:24.680
> 
> 标签：java, hashmap

> **可能重复：**
> [Java Hashmap：如何从值中获取键？](https://stackoverflow.com/questions/1383797/java-hashmap-how-to-get-key-from-value)

我有一个哈希图

```
private static HashMap<ObjectClass, UUID> projectileSet = new HashMap<ObjectClass, UUID>(); 
```

和一个未完成的方法，我想返回对应于 UUID 的 ObjectClass

```
public static LegendaryItem getClass(UUID uniqueId) {
    return projectileSet.getKey(uniqueId);

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T05:22:27.480

您可以使用“KeySet()”方法从 HashMap 返回键。

```
HashMap objH=new HashMap<>();
Set objSet=objH.keySet();
public static LegendaryItem getClass(UUID uniqueId) {
    Iterator objItr=objSet.iterator();
    while(objItr.hasNext()){
        UUID objStr=(UUID) objItr.next();
        if(objStr.equals(uniqueId)){
            return objStr;
        }
    }
} 
```

迭代 ObjSet 并获取每个键

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T05:26:56.233

要获得这样的方法，`getKey`您需要一个支持从值到键的查找的双向哈希映射，如[Java 是否有带有反向查找的哈希映射？](https://stackoverflow.com/questions/1670038/does-java-have-a-hashmap-with-reverse-lookup). Apache Commons( [BiDiMap](http://commons.apache.org/collections/api-release/org/apache/commons/collections/BidiMap.html) ) 或 Guava( [BiMap](http://guava-libraries.googlecode.com/svn/tags/release09/javadoc/com/google/common/collect/BiMap.html) ) 似乎提供了这个功能。

或者，您可以采用 Amith 提出的迭代方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T05:33:34.550

亲爱的朋友，您的代码有问题。当你有唯一的 id 作为你的值时，你可以使用这个 id 作为 hashmap 键，你不必做任何复杂的编码。只需这样做：

```
private static HashMap<UUID, ObjectClass> projectileSet = new HashMap<UUID, ObjectClass>(); 
```

进而：

```
projectileSet.get(uniqueId); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T05:28:08.650

您无法直接在标准 Java 地图中获得该功能。因为 java map 不支持逆视图，所以从给定值获取键。为此，最好使用双向地图实现。示例之一：[BiMap](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/BiMap.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-16T05:28:53.340

通过使用`keySet()`，您可以... 它将以 set... 的形式返回所有键

# android - 屏幕关闭时调用广播接收器

> ID：14351827
> 
> 赞同：1
> 
> 时间：2013-01-16T05:18:39.150
> 
> 标签：android

我正在做一个如果我们摇晃手机会锁定屏幕的应用程序，我已经编写了屏幕关闭的代码，但现在的问题是我需要一个广播接收器来检查屏幕是关闭还是打开，我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T07:19:50.473

如果您需要检查屏幕是否在特定时刻关闭或打开，这是一个适合您的好方法，无需注册接收器

```
PowerManager powerManager = (PowerManager) getSystemService(POWER_SERVICE);
boolean isScreenOn = powerManager.isScreenOn();
if (!isScreenOn) {//lock screen
   //do something
} 
```

如果您想在屏幕关闭时收听，那么您需要注册一个接收器。对于 Intent.ACTION_SCREEN_OFF 和 Intent.ACTION_SCREEN_ON 你不能在你的 Android Manifest 中声明它们，但它们必须在你的 JAVA 代码中的 IntentFilter 中注册，并且不需要添加任何权限

```
public class ScreenReceiver extends BroadcastReceiver {

    public static boolean wasScreenOn = true;

    @Override
    public void onReceive(Context context, Intent intent) {
        if (intent.getAction().equals(Intent.ACTION_SCREEN_OFF)) {
            // do whatever you need to do here
            wasScreenOn = false;
        } else if (intent.getAction().equals(Intent.ACTION_SCREEN_ON)) {
            // and do whatever you need to do here
            wasScreenOn = true;
        }
    }

} 
```

然后在您的活动的 onCreate 中注册接收器

```
 @Override
    protected void onCreate() {
       //your code
        BroadcastReceiver mReceiver = new ScreenReceiver();
        registerReceiver(mReceiver, filter);            
    } 
```

并在您的活动的 onDestroy 中取消注册

```
 @Override
    protected void onDestroy() {
       //your code
        unregisterReceiver(mReceiver);         

    } 
```

希望这对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T05:23:00.737

希望这个[链接](http://thinkandroid.wordpress.com/2010/01/24/handling-screen-off-and-screen-on-intents/)

**如果屏幕在 Android 中关闭，**这有助于您更好地实现BroadCastReciever 调用。

**编辑**：

您必须将权限添加到清单中，就像：

```
<receiver android:name=".MyBroadCastReciever">
    <intent-filter>
        <action android:name="android.intent.action.SCREEN_OFF"/>
        <action android:name="android.intent.action.SCREEN_ON"/>
        <action android:name="android.intent.action.BOOT_COMPLETED"/>
    </intent-filter>
</receiver> 
```

# c++ - 创建二维数组以输出 pmm 文件 C++

> ID：14351831
> 
> 赞同：0
> 
> 时间：2013-01-16T05:19:31.840
> 
> 标签：c++, arrays, rgb, ppm

给我的指示非常模糊，我完全不知道我应该做什么。需要一些帮助。我会尽力解释，希望有人能帮助我。

当您使用值 col 设置像素 (i,j) 的颜色时，我需要生成一个指定宽度和高度的 ppm 文件，如下所示：

`float col = float (((i & 0x08) == 0) ^ ((j & 0x08) == 0));`

您可能希望对 RGB 颜色使用以下结构：

```
struct RGB {
    float r;
    float g;
    float b;
}; 
```

数组中的每个元素都在 [0.0, 1.0] 的范围内，并且必须在写入文件之前转换为 [0, 255]。

这与我所掌握的信息一样多。我真的只是迷失了他真正想让我做什么。对于更有经验的人来说，这可能是足够的信息，但对我来说不是。有人可以详细说明一下。另外，第一个公式/代码片段到底是做什么的？

**我仍然不知道 i 和 j 是什么，或者公式是什么，或者如何生成要写入 RGB 二维数组的值！？！？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T05:59:14.017

PPM 是非常简单的位图格式，您在问题中基本上已经描述了它。要查看更多详细信息，请使用 Google 或查看[http://netpbm.sourceforge.net/doc/ppm.html](http://netpbm.sourceforge.net/doc/ppm.html)。

要从范围 [0.0 .. 1.0] 转换为 [0 .. 255]，您只需对每个像素分量执行乘以 255.0。

总结一下：将 ppm 标头写入文件，遍历所有像素，将其分量乘以 255，转换为整数，以文本形式写入文件。文件中的所有值都用空格分隔。

第一个代码片段告诉您如何生成图片。这基本上意味着如果 i 和 j 坐标的右数第四位不同，则颜色为白色，如果它们相同，则颜色为黑色。这应该会生成一个 16 x 16 方格的棋盘图案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T05:57:48.357

在第一个公式中，您将不会得到[0 1]*范围内的值，而**只会得到* `0s`and `1s`，因为 operator == 返回`true`或`false`（位表示中的 0 或 1）。对 0 和/或 1 的 XOR (^) 操作也将返回 0 或 1。

这是一个异或运算的真值表

```
-----------------
| a | b | a ^ b |
-----------------
| 0 | 0 |   0   |
-----------------
| 0 | 1 |   1   |
-----------------
| 1 | 0 |   1   |
-----------------
| 1 | 1 |   0   |
----------------- 
```

从范围 [0 1] 到 [0 255] 的转换只是将值乘以 255。

```
void convertTo_255( struct RGB * array, size_t count {
    for ( size_t i = 0; i < count; i++ ) {
        array[ i ].r *= 255;
        array[ i ].g *= 255;
        array[ i ].b *= 255;
    } 
```

# java - Phonegap - 键盘不显示

> ID：14351833
> 
> 赞同：0
> 
> 时间：2013-01-16T05:19:38.193
> 
> 标签：java, android, cordova

我已经尝试使用以下代码在应用程序加载后立即显示软键盘，并借助此[url](http://phonegap.pbworks.com/w/page/27915465/How%20to%20show%20and%20hide%20soft%20keyboard%20in%20Android)中的代码，但软键盘不显示。不知道我做错了什么。

```
public class MainActivity extends DroidGap {    

        /** Called when the activity is first created. */
        @Override
        public void onCreate(Bundle savedInstanceState) 
        {
            super.onCreate(savedInstanceState);
            //KeyBoard keyboard = new KeyBoard(this, appView);
           // appView.addJavascriptInterface(keyboard, "KeyBoard");
            super.loadUrl("file:///android_asset/www/index.html");
            InputMethodManager mgr = (InputMethodManager) this.getSystemService(Context.INPUT_METHOD_SERVICE);
            // only will trigger it if no physical keyboard is open
            mgr.showSoftInput(appView, InputMethodManager.SHOW_IMPLICIT);

            ((InputMethodManager) this.getSystemService(Context.INPUT_METHOD_SERVICE)).showSoftInput(appView, 0); 

         }

} 
```

# python - vim 代码完成和 PyDoc 问题

> ID：14351835
> 
> 赞同：1
> 
> 时间：2013-01-16T05:20:04.660
> 
> 标签：python, vim, code-completion, vim-plugin, rope

不幸的是，我无法将 os.path.join 作为代码完成仅 os.path。另一个问题是 pydoc 没有在源代码上方的新窗口中自动打开。怎么可能解决这个问题？

我做了 :RopeOpenProject 并且我的 PHYTHONPATH 看起来如下：

```
>>> import sys
>>> sys.path
['', '/home/user977828/apps/pymodules/lib/python2.7/site-packages/pysam-0.6-py2.7-linux-x86_64.egg', '/home/user977828/apps/pymodules/lib/python2.7/site-packages/tornado-2.4.1-py2.7.egg', '/home/user977828/apps/pymodules/lib/python2.7/site-packages/pyflakes-0.4.0-py2.7.egg', '/home/user977828/apps/pymodules/lib/python2.7/site-packages/pylint-0.26.0-py2.7.egg', '/home/user977828/apps/pymodules/lib/python2.7/site-packages/pep8-1.4-py2.7.egg', '/home/user977828/apps/pymodules/lib/python2.7/site-packages/flake8-1.7.0-py2.7.egg', '/usr/lib/entropy/lib', '/usr/lib/portage/pym', '/home/user977828/apps/pymodules/lib/python2.7/site-packages', '/home/user977828/apps/pymodules/lib64/python2.7/site-packages', '/usr/lib64/python27.zip', '/usr/lib64/python2.7', '/usr/lib64/python2.7/plat-linux2', '/usr/lib64/python2.7/lib-tk', '/usr/lib64/python2.7/lib-old', '/usr/lib64/python2.7/lib-dynload', '/usr/lib64/python2.7/site-packages', '/usr/lib64/python2.7/site-packages/PIL', '/usr/lib64/python2.7/site-packages/gtk-2.0', '/usr/lib64/python2.7/site-packages/wx-2.8-gtk2-unicode', '/usr/lib64/portage/pym' 
```

我通过以下方式安装了 Vim 的所有插件

```
sudo  equo install setuptools ctags ipython rope ropemode 
easy_install --prefix=/home/uqmlore1/apps/pymodules -UZ git+git://github.com/kevinw/pyflakes.git
easy_install --prefix=/home/uqmlore1/apps/pymodules -UZ pylint
easy_install --prefix=/home/uqmlore1/apps/pymodules -UZ pep8
easy_install --prefix=/home/uqmlore1/apps/pymodules -UZ flake8

mkdir -p ~/.vim/colors && cd ~/.vim/colors 
wget -O wombat256mod.vim http://www.vim.org/scripts/download_script.php?src_id=13400
mkdir -p ~/.vim/autoload ~/.vim/bundle
curl -so ~/.vim/autoload/pathogen.vim https://raw.github.com/tpope/vim-pathogen/HEAD/autoload/pathogen.vim

cd ~/.vim/
git init
git submodule add https://github.com/Lokaltog/powerline.git bundle/powerline
git submodule add https://github.com/kien/ctrlp.vim.git bundle/ctrlp.vim
git submodule add https://github.com/ivanov/vim-ipython bundle/vim-ipython      #videos avaible
git submodule add https://github.com/majutsushi/tagbar bundle/tagbar
git submodule add https://github.com/vim-scripts/indentpython.vim bundle/indentpython
git submodule add https://github.com/scrooloose/syntastic bundle/syntastic
git submodule add https://github.com/scrooloose/nerdtree bundle/nerdtree
git submodule add https://github.com/scrooloose/nerdcommenter bundle/nerdcommenter
git submodule add https://github.com/vim-scripts/mru.vim bundle/mru.vim
git submodule add https://github.com/tpope/vim-surround.git bundle/vim-surround #?
git submodule add https://github.com/ervandew/supertab.git bundle/supertab
git submodule add https://github.com/nvie/vim-flake8.git bundle/vim-flake8
git submodule add https://github.com/sjl/gundo.vim.git bundle/gundo.vim
git submodule add https://github.com/fs111/pydoc.vim.git bundle/pydoc.vim
git submodule add https://github.com/alfredodeza/pytest.vim.git bundle/pytest.vim
git submodule add https://github.com/reinh/vim-makegreen bundle/vim-makegreen
git submodule add https://github.com/sontek/rope-vim.git bundle/rope-vim
git submodule init
git submodule update
git submodule foreach git submodule init
git submodule foreach git submodule update
rm -rf .git .gitmodules

mkdir -p ~/.vim/ftplugin 
wget -O ~/.vim/ftplugin/python_editing.vim http://www.vim.org/scripts/download_script.php?src_id=5492 
```

我使用的 .vimrc 看起来像这样：

```
" Sample .vimrc file by Martin Brochhaus
" Presented at PyCon APAC 2012

" ============================================
" Note to myself:
" DO NOT USE <C-z> FOR SAVING WHEN PRESENTING!
" ============================================

" Automatic reloading of .vimrc
autocmd! bufwritepost .vimrc source %

" Better copy & paste
" When you want to paste large blocks of code into vim, press F2 before you
" paste. At the bottom you should see ``-- INSERT (paste) --``.

set pastetoggle=<F2>
set clipboard=unnamed

" Mouse and backspace
set mouse=a  " on OSX press ALT and click
"" set bs=2     " make backspace behave like normal again

" Rebind <Leader> key
" I like to have it here becuase it is easier to reach than the default and
" it is next to ``m`` and ``n`` which I use for navigating between tabs.
let mapleader = ","

" Bind nohl
" Removes highlight of your last search
" ``<C>`` stands for ``CTRL`` and therefore ``<C-n>`` stands for ``CTRL+n``
noremap <C-n> :nohl<CR>
vnoremap <C-n> :nohl<CR>
inoremap <C-n> :nohl<CR>

" Quicksave command
"" noremap <C-Z> :update<CR>
"" vnoremap <C-Z> <C-C>:update<CR>
"" inoremap <C-Z> <C-O>:update<CR>

" Quick quit command
"" noremap <Leader>e :quit<CR>  " Quit current window
"" noremap <Leader>E :qa!<CR>   " Quit all windows

" bind Ctrl+<movement> keys to move around the windows, instead of using Ctrl+w + <movement>
" Every unnecessary keystroke that can be saved is good for your health :)
map <c-j> <c-w>j
map <c-k> <c-w>k
map <c-l> <c-w>l
map <c-h> <c-w>h

" easier moving between tabs
map <Leader>n <esc>:tabprevious<CR>
map <Leader>m <esc>:tabnext<CR>

" map sort function to a key
vnoremap <Leader>s :sort<CR>

" easier moving of code blocks
" Try to go into visual mode (v), thenselect several lines of code here and
" then press ``>`` several times.
vnoremap < <gv  " better indentation
vnoremap > >gv  " better indentation

" Show whitespace
" MUST be inserted BEFORE the colorscheme command
autocmd ColorScheme * highlight ExtraWhitespace ctermbg=red guibg=red
au InsertLeave * match ExtraWhitespace /\s\+$/

" Color scheme
" mkdir -p ~/.vim/colors && cd ~/.vim/colors
" wget -O wombat256mod.vim http://www.vim.org/scripts/download_script.php?src_id=13400
set t_Co=256
color wombat256mod

" Enable syntax highlighting
" You need to reload this file for the change to apply
filetype off
filetype plugin indent on
syntax on

" Showing line numbers and length
set number  " show line numbers
set tw=79   " width of document (used by gd)
set nowrap  " don't automatically wrap on load
set fo-=t   " don't automatically wrap text when typing
set colorcolumn=80
highlight ColorColumn ctermbg=233

" easier formatting of paragraphs
vmap Q gq
nmap Q gqap

" Useful settings
set history=700
set undolevels=700

" Real programmers don't use TABs but spaces
set tabstop=4
set softtabstop=4
set shiftwidth=4
set shiftround
set expandtab

" Make search case insensitive
set hlsearch
set incsearch
set ignorecase
set smartcase

" Disable stupid backup and swap files - they trigger too many events
" for file system watchers
set nobackup
set nowritebackup
set noswapfile

" Setup Pathogen to manage your plugins
" mkdir -p ~/.vim/autoload ~/.vim/bundle
" curl -so ~/.vim/autoload/pathogen.vim https://raw.github.com/tpope/vim-pathogen/HEAD/autoload/pathogen.vim
" Now you can install any plugin into a .vim/bundle/plugin-name/ folder
call pathogen#infect()

" ============================================================================
" Python IDE Setup
" ============================================================================

" Settings for vim-powerline
" cd ~/.vim/bundle
" git clone git://github.com/Lokaltog/vim-powerline.git
source ~/.vim/bundle/powerline/powerline/ext/vim/source_plugin.vim
let g:Powerline_symbols = 'fancy'
set laststatus=2

" Settings for ctrlp
" cd ~/.vim/bundle
" git clone https://github.com/kien/ctrlp.vim.git
let g:ctrlp_max_height = 30
set wildignore+=*.pyc
set wildignore+=*_build/*
set wildignore+=*/coverage/*

" Settings for python-mode
" cd ~/.vim/bundle
" git clone https://github.com/klen/python-mode
map <Leader>g :call RopeGotoDefinition()<CR>
let ropevim_enable_shortcuts = 1
let g:pymode_rope_goto_def_newwin = "vnew"
let g:pymode_rope_extended_complete = 1
let g:pymode_breakpoint = 0
let g:pymode_syntax = 1
let g:pymode_syntax_builtin_objs = 0
let g:pymode_syntax_builtin_funcs = 0
map <Leader>b Oimport ipdb; ipdb.set_trace() # BREAKPOINT<C-c>

" Better navigating through omnicomplete option list
" See http://stackoverflow.com/questions/2170023/how-to-map-keys-for-popup-menu-in-vim
"" set completeopt=longest,menuone
function! OmniPopup(action)
if pumvisible()
    if a:action == 'j'
    return "\<C-N>"
    elseif a:action == 'k'
    return "\<C-P>"
    endif
endif
return a:action
endfunction

inoremap <silent><C-j> <C-R>=OmniPopup('j')<CR>
inoremap <silent><C-k> <C-R>=OmniPopup('k')<CR>

" Python folding
" mkdir -p ~/.vim/ftplugin
" wget -O ~/.vim/ftplugin/python_editing.vim http://www.vim.org/scripts/download_script.php?src_id=5492
set nofoldenable

" SuperTab plugin can be used to avoid needing to press Ctrl-X then Ctrl-O to invoke the popup completion menu. 
let g:SuperTabDefaultCompletionType = "context"

" Now we just enable the menu and pydoc preview to get the most useful 
" information out of the code completion
set completeopt=menuone,longest,preview 
```

# oracle - 通过 pl/sql 函数检查 oracle 用户身份验证

> ID：14351838
> 
> 赞同：0
> 
> 时间：2013-01-16T05:20:37.517
> 
> 标签：oracle, authentication

我正在开发一个使用 Oracle 的 Java Web 应用程序。Web 应用程序使用 Glassfish AS 并通过配置的连接池连接到 Oracle。

客户执行用户认证的要求是尝试在提供的用户登录名/密码下创建oracle会话，如果成功，则用户成功登录。

我想到的第一个想法是编写一个函数，该函数接受登录名/密码，执行散列并将散列与存储的散列进行比较。但我担心，如果我这样做，我会遇到一些陷阱，比如哈希算法可以随时更改，oracle 帐户可能会被锁定，所以我必须执行额外的检查等等。

除了创建与 Oracle 的会话之外，任何人都可以建议我检查 oracle 用户身份验证的可靠方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:24:29.587

一开始我不会这样做。
我会使用现有的众多工具之一在 Web 应用程序中进行身份验证。
更重要的是，我将连接池的 db 用户设置为代理用户，并且从不提供或检查应用程序中用户的 DB 密码（如[本 asktom 帖子](http://asktom.oracle.com/pls/asktom/f?p=100:11:0%3a%3a%3a%3ap11_question_id:21575905259251)中所述）。

但是既然*执行用户身份验证的客户要求是尝试创建 oracle session*，那么为什么不这样做呢？

从 Web 应用程序中访问密码`DBA_USERS`听起来是个非常糟糕的主意......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T16:34:02.287

我有另一个*（非常糟糕的）*想法给你-

您可以在 plsql 中创建一个为用户动态创建 DBLink 的函数。
然后，您将尝试（再次动态地）`DUAL`使用该 dblink 查询表，
如果它有效 - 返回 ok 否则返回 not ok。
然后删除（再次动态）dblink。

应该看起来像这个匿名块-

```
DECLARE
  res NUMBER := 1;
BEGIN
  EXECUTE IMMEDIATE 'create database link temp_dblink connect to user identified by password using ''dbname''';

  BEGIN
    EXECUTE IMMEDIATE 'select 1 from dual@temp_dblink';

  EXCEPTION
    WHEN others THEN
      res := 0;
  END;

  ROLLBACK;
  dbms_session.close_database_link('temp_dblink');

  EXECUTE IMMEDIATE 'drop database link temp_dblink';
END; 
```

这当然不能“原样”，
你需要绑定“用户名”和“密码”，
需要为每个用户/尝试（网络会话）设置不同的 tmp_dblink 名称，
等等......

另请注意，这可能会在您的数据库中留下不需要的 dblink 等等

**我不推荐使用这个解决方案**
（我写它更多是为了它的运动......）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T18:06:29.300

我通过`$GLASSFISH_ROOT/domains/domain1/domain.xml`使用以下代码解析 glassfish 域配置文件解决了这个问题：

```
 private String getGlassfishConfigParameterJdbcUrl() {
    String instanceRoot = System.getProperty("com.sun.aas.instanceRootURI");
    URI configUri = null;
    try {
        configUri = new URI(instanceRoot);

        File configFile = new File(configUri.getPath(), "config" + File.separator + "domain.xml");
        XmlNode node = XmlNode.fromFile(configFile);
        return node.getNode("domain/resources/jdbc-connection-pool[@name=\"GLASSFISH_DB_POOL_NAME\"]/property[@name=\"URL\"]").getAttribute("value");
    } catch (URISyntaxException e) {
        throw new RuntimeException(e);
    }
} 
```

XmlNode 是我用于 xml 解析的实用程序类。

# cakephp - 如何在 cakephp 中为表单分配名称

> ID：14351840
> 
> 赞同：0
> 
> 时间：2013-01-16T05:20:38.240
> 
> 标签：cakephp

我在 CakePHP 中制作表单 我想要该表单的 HTML 如下

```
<form action="/abc/sessionapps/login" name="UserLoginForm" id="UserLoginForm" method="post" accept-charset="utf-8"> 
```

到目前为止，我已经在 CakePHP 中编写了以下代码

```
echo $this->Form->create('User', array('url' => array('controller' => 'sessionapps', 'action' =>'login'),array('name'=>'UserLoginForm'))); 
```

它正在生成以下输出

```
<form action="/abc/sessionapps/login" 0="0" id="UserLoginForm" method="post" accept-charset="utf-8"> 
```

请帮忙

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T05:39:25.537

尝试：

```
echo $this->Form->create('User', 
   array(
      'url' => array('controller' => 'sessionapps', 'action' =>'login'), 
      'name' => 'UserLoginForm' 
   )
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T05:40:03.030

```
<?php
echo $this->Form->create('User', array('name'=>'UserLoginForm','url' => array('controller' => 'sessionapps', 'action' =>'login')));
?> 
```

通常我们将模型名称作为表单名称，这样我们就可以将数组作为 $this->data[Model] 来保存，只需将此数组传递给保存查询即可。

# algorithm - 将一个数字序列编码为一个数字——使用中国剩余定理

> ID：14351841
> 
> 赞同：2
> 
> 时间：2013-01-16T05:20:45.043
> 
> 标签：algorithm, chinese-remainder-theorem

我需要用整数编码`S`任意数量的元素（但有限）的序列`K`，并且能够解码`K`以获得初始序列。

我需要这样做，以便计算机能够很好地处理这个数字`K`。

我这样做了（在 lisp 中）：

*   假设序列 S 有 n 个元素 e1, ... en

*   生成前 n 个素数 p1 ... pn

*   写 K = p1^e1 + p2 ^ e2 + ... + pn ^ en

我试过这个方法。但是，我得到了巨大的数字。

我知道可以用`chinese remainder theorem`来解决问题，`K`得到的so并没有那么大。

有人可以帮助我使用这个定理来编码一个序列吗？

编辑：

我希望`ch r th`使用一个具体的简单示例来查看编码算法。我无法理解维基百科和其他网络资源中的理论思想。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T12:16:16.813

您正在寻找[Gödel 序列编号](http://en.wikipedia.org/wiki/G%C3%B6del_numbering_for_sequences)。这是一种将（有限）数字序列编码为单个数字的方法。中国剩余定理给出了一种递归的构造方法。

# random - CUDA CURAND 是否容易受到数据竞争的影响？

> ID：14351845
> 
> 赞同：1
> 
> 时间：2013-01-16T05:21:11.953
> 
> 标签：random, cuda, gpgpu, race-condition

我从我的内核生成**1 个 256 个线程块**`Setup()`来设置一个`RNGstates`具有 256 个 CURAND 状态的数组：

```
__global__ void Setup(curandState *RNGstates, long seed) {
    int tid = threadIdx.x;
    curand_init(seed, tid, 0, &RNGstates[tid]);
} 
```

现在，我从内核中生成**1000 个 256 个线程的块，**用 256,000 个随机数`Generate()`填充数组。`result`但是，我只使用 256 个状态`RNGstates`，这样每个状态将被 1000 个线程访问（每个块一个）：

```
__global__ void Generate(curandState *RNGstates, float *result) {
    int tid = blockIdx.x*blockDim.x + threadIdx.x;
    float rnd = curand_uniform(&RNGstates[threadIdx.x]);
    result[tid] = rnd;
} 
```

我知道调用`curand_uniform()`会以某种方式更新状态，所以我认为正在发生一些写操作。

那么，当映射到 256 个 CURAND 状态中的每一个的 1000 个线程尝试通过隐式更新状态时，我是否应该担心发生数据竞争`curand_uniform()`？这会影响我的随机数的质量（例如获得频繁的重复值）吗？

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T07:03:18.073

我认为共享状态肯定会影响质量。重复值是共享状态的最佳情况。数据竞赛可能会彻底毁掉各州。

您可以为每个线程保留一个状态。

当使用 1000 个块时，您的案例需要 256,000 个状态。代码应该像

```
__global__ void Setup(curandState *RNGstates, long seed) {
  int tid = blockIdx.x*blockDim.x + threadIdx.x;
  curand_init(seed, tid, 0, &RNGstates[tid]);
} 
```

和

```
__global__ void Generate(curandState *RNGstates, float *result) {
  int tid = blockIdx.x*blockDim.x + threadIdx.x;
  float rnd = curand_uniform(&RNGstates[tid]);
  result[tid] = rnd;
} 
```

为了减少对多个块的内存要求，您可以将#block 限制为一个较小的数字，并为每个线程生成多个随机数，而不是每个线程生成 1 个随机数。

```
__global__ void generate_uniform_kernel(curandState *state, 
                                unsigned int *result)
{
    int id = threadIdx.x + blockIdx.x * 64;
    unsigned int count = 0;
    float x;
    /* Copy state to local memory for efficiency */
    curandState localState = state[id];
    /* Generate pseudo-random uniforms */
    for(int n = 0; n < 10000; n++) {
        x = curand_uniform(&localState);
        /* Check if > .5 */
        if(x > .5) {
            count++;
        }
    }
    /* Copy state back to global memory */
    state[id] = localState;
    /* Store results */
    result[id] += count;
} 
```

有关如何处理多个块的完整示例，请参阅cuRAND 参考手册中的[设备 API 示例部分。](http://docs.nvidia.com/cuda/curand/index.html#topic_1_3_6)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-22T11:28:10.633

您还可以使用 curandStateMtgp32_t 每个块只需要一个（如果每个块最多有 256 个线程）[http://docs.nvidia.com/cuda/curand/device-api-overview.html#bit-generation-1](http://docs.nvidia.com/cuda/curand/device-api-overview.html#bit-generation-1)

# php - jQuery 幻灯片预加载结果

> ID：14351848
> 
> 赞同：0
> 
> 时间：2013-01-16T05:21:30.743
> 
> 标签：php, jquery, html, slide

我需要的是从外部页面预加载 5 个结果并将它们放在像[bxSlider](http://bxslider.com/examples/auto-show-start-stop-controls)这样的幻灯片中所以当预加载 5 个结果时，我可以使用 bxSlider 或任何类型的幻灯片将下一个结果从 5 个预加载中滑出加载。然后每次单击下一张幻灯片时，我想删除第一个预加载的结果并在末尾添加 1，就像使用 append 一样。所以最后我想为加载时间预加载 x 个结果，然后当我去删除已经查看的结果并将 1 添加到当前结果时。

例子：

```
<div>Pre-loaded Result1</div>

<div>Pre-loaded Result2</div>

<div>Pre-loaded Result3</div>

<div>Pre-loaded Result4</div>

<div>Pre-loaded Result5</div> 
```

滑动

```
<div>New Result1</div>

<div>New Result2</div>

<div>New Result3</div>

<div>New Result4</div>

<div>New Result5</div> 
```

所以就像上面的例子一样，从外部 php 页面预加载结果，当我浏览它们时，添加新的并删除已经看到的。谢谢

这是我到目前为止的索引页面：

```
var nextUser = 0; 
var slider = $("#slider1").bxSlider();
$("#slider1")
.load("find_get.php?num="; + nextUser, function() {
nextUser++; slider.goToNextSlide(); });

    <div id="slider1" class="find_outer">
    Loading...
</div> 
```

这是我对 fin_get 页面的内容：

```
$num = isset($_GET['num']) ? $_GET['num'] : exit ;
$query = "SELECT * FROM user WHERE id != '$user_id' LIMIT $num,1";
$stmt = $db -> query($query) or die (mysql_error());
while ($rows = $stmt -> fetch(PDO::FETCH_ASSOC)) {
$id = $rows['id'];
$firstname = $rows['firstname'];
$lastname = $rows['lastname'];

$display_info .= '<div class="bxdr" id="'.$id.'">' . $firstname . ' 
' . $lastname .   '</div>';
}
echo $display_info; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T05:34:32.047

这可以通过将所有孩子包装`div`在父母之下来轻松完成`div`。

```
 <div id="ParentDiv">
      <div>Pre-loaded Result1</div>
      <div>Pre-loaded Result2</div>
      <div>Pre-loaded Result3</div>
      <div>Pre-loaded Result4</div>
      <div>Pre-loaded Result5</div>
 </div> 
```

所以得到结果后，可以用这个[$.html()](http://api.jquery.com/html/)替换成这样的内容

```
$("#ParentDiv").html(...updated slide contents here...); 
```

# ios - 枚举器的重新定义、先前的属性声明和重复的接口错误

> ID：14351853
> 
> 赞同：1
> 
> 时间：2013-01-16T05:21:57.747
> 
> 标签：ios, objective-c, xcode

在我的项目中，我有一个子项目。两者都依赖于可达性类。

出现重复符号错误。

所以我取消了我项目的 Reachabilty 的链接，并且依赖于子项目的 Reachabilty，因为它会首先被编译。

现在我只有一份 Reachability 的副本，但在这里我也得到了枚举的重新定义、先前的属性声明和重复的接口错误。

所有这些错误都让我无法同时吞下。

我只是想将我的模块集成到现有的大项目中。

我应该如何摆脱这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T05:49:42.337

经典的 iOS 问题。你的子项目的格式是什么？您有权访问代码吗？你能从子项目中公开可达性吗？

在绝对最坏的情况下，您可以重命名项目中的可达性符号名称。我以前做过……这伤害了我的自尊心，但有时这是必要的。

# javascript - 如何指定使用两个云端发行版中的哪一个？

> ID：14351854
> 
> 赞同：0
> 
> 时间：2013-01-16T05:21:58.943
> 
> 标签：javascript, python, django, amazon-s3, amazon-cloudfront

我正在设置一个使用 S3 进行存储的 Django 应用程序。我想对视频使用流式云端分发，对图像使用下载分发。

有没有办法指定我想使用哪个发行版来托管特定文件？我将使用此处描述的方法将文件直接从浏览器上传到 S3：http: [//aws.amazon.com/articles/1434](http://aws.amazon.com/articles/1434)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T16:13:43.417

你肯定可以做到这一点。对于通过“下载”云端分发提供图像和通过“流”分发提供视频，您可以只拥有一个云端流分发。它会工作得很好。您必须使用 CORS 才能直接从浏览器上传文件。此外，对于将视频流式传输到某些 Flash 播放器（flowplayer 等），您可能需要 crossdomain.xml，并且如果您正在执行私有流式传输，请在创建“流式传输”云端分发时定义 Origin-access-identity。

# javascript - 如何使用 Javascript 知道按下的键？

> ID：14351856
> 
> 赞同：0
> 
> 时间：2013-01-16T05:22:09.330
> 
> 标签：javascript, dom-events, onkeypress

> **可能重复：**
> [js：如何找出按下了什么字符键？](https://stackoverflow.com/questions/1846599/js-how-to-find-out-what-character-key-is-pressed)

我想知道如何在按键时创建一个事件并指定仅使用 Javascript 按下哪个键。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T05:24:15.457

```
<script type="text/javascript">
    function myKeyPress(e){

        var keynum;

        if(window.event){ // IE                 
            keynum = e.keyCode;
        }else
            if(e.which){ // Netscape/Firefox/Opera                  
                keynum = e.which;
             }
        alert(String.fromCharCode(keynum));
    }
   </script>

 <form>
  <input type="text" onkeypress="return myKeyPress(event)" />
 </form> 
```

参考[如何找出按下了什么字符键？](https://stackoverflow.com/questions/1846599/js-how-to-find-out-what-character-key-is-pressed)

# python - 服务器忙时返回响应

> ID：14351864
> 
> 赞同：1
> 
> 时间：2013-01-16T05:22:48.843
> 
> 标签：python, web-services

我正在开发一个允许人们上传图片的网站。主要是学习经验，我是用python写的。它应该能够做的一件事是获取图像所在的 url，然后将其重新上传到自己的服务器。那么问题来了：

一个人给我的网站一个网址，然后我的服务器开始下载图像。当它正在下载该图像时，另一个请求进来了。有没有办法让服务器给出响应（比如说服务器很忙），即使它正在做其他事情？有没有更好的方法来解决这个问题？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T06:29:02.003

我写了一个例子，希望对你有所帮助。它由一个`urls.txt`列出要处理的作业的文件和一个使用多个进程下载的 xdownloader.py 文件组成。我在运行 Python 2.7 的 Linux 机器上对其进行了测试。

**xdownloader.py**

```
from multiprocessing import Process
import urllib2

def main():

  try:

    # Read URLs/Destinations from a file
    jobs = []
    with open("urls.txt","r") as ifile:
      for line in ifile:
        jobs.append(line.split(" "))

    # Create a process list to keep track of running processes
    process_list = []
    # Iterate through our jobs list
    for url, save_to in jobs:
      # Create a new process that runs function 'download'
      p = Process(target=download, args=(url, save_to))
      # Save it to a list
      process_list.append(p)
      # Start the process
      p.start()
  except KeyboardInterrupt:
    print("Received keyboard interrupt (ctrl+c). Exiting...")
  finally:
    # Wait for all processes to finish before exiting
    for process in process_list:
       # Wait for this process to finish
       process.join()
    print("All processes finished successfully!")

def download(url, destination):
  # Open a request
  request = urllib2.urlopen(url)
  # Read and save the webpage data to a file
  with open(destination, "w+") as save_file:
    print("Downloading {0}".format(url))
    save_file.write(request.read())

if __name__=="__main__":
  main() 
```

**网址.txt**

```
http://google.com google.html
http://yahoo.com yahoo.html
http://news.google.com news.google.html
http://reddit.com reddit.html
http://news.ycombinator.com news.ycombinator.html 
```

运行`python xdownloader.py`我得到：

```
mike@localhost ~ $ python xdownloader.py 
Downloading http://news.ycombinator.com
Downloading http://reddit.com
Downloading http://news.google.com
Downloading http://google.com
Done downloading http://google.com
Done downloading http://news.ycombinator.com
Done downloading http://reddit.com
Downloading http://yahoo.com
Done downloading http://news.google.com
Done downloading http://yahoo.com 
```

您可以看到这些作业正在异步运行……有些作业开始得早，但完成得比其他作业晚。（我在看你 news.google.com！）如果这个例子不符合你的需要，请在评论中告诉我。

# android - 发送.txt文件，文档文件到android中的服务器

> ID：14351870
> 
> 赞同：3
> 
> 时间：2013-01-16T05:23:05.560
> 
> 标签：android, file, client-server

我正在开发一个应用程序，在该应用程序中我以字符串格式向服务器发送数据。下面是我的代码。它工作正常。但现在我的问题是如何将整个 .txt 文件和 .doc 文件发送到服务器。在我的 GUI 中，我必须提供用户选择的路径。意味着用户必须选择他/她要发送的文件路径...请帮我解决我的问题...谢谢...

activity_main.xml 文件

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

    <EditText
        android:id="@+id/editText1"
        android:layout_width="170sp"
        android:layout_height="40sp"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:layout_marginTop="16dp"
        android:ems="10"
        android:hint="@string/ip" />

    <EditText
        android:id="@+id/editText2"
        android:layout_width="100sp"
        android:layout_height="40sp"
        android:layout_alignBaseline="@+id/editText1"
        android:layout_alignBottom="@+id/editText1"
        android:layout_marginLeft="24dp"
        android:layout_toRightOf="@+id/editText1"
        android:ems="10"
        android:hint="@string/port"
        android:inputType="number" >

        <requestFocus />
    </EditText>

    <EditText
        android:id="@+id/editText3"
        android:layout_width="300sp"
        android:layout_height="200sp"
        android:layout_below="@+id/editText1"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="38dp"
        android:ems="10"
        android:hint="@string/msg" />

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_centerHorizontal="true"
        android:layout_marginBottom="64dp"
        android:text="@string/send" />

</RelativeLayout> 
```

.java 文件

```
import java.io.IOException;
import java.io.PrintWriter;
import java.net.Socket;
import java.net.UnknownHostException;

import android.os.Bundle;
import android.app.Activity;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;

public class MainActivity extends Activity {

    private Socket client;
    private PrintWriter printwriter;
    private EditText etMsg, etIP, etPort;
    private Button button;
    private String messsage;
    int port = 0;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        etIP = (EditText) findViewById(R.id.editText1);
        etPort = (EditText) findViewById(R.id.editText2);
        etMsg = (EditText) findViewById(R.id.editText3);
        button = (Button) findViewById(R.id.button1);
        button.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub

                messsage = etMsg.getText().toString();
                etMsg.setText("");
                port = Integer.parseInt(etPort.getText().toString());

                new Thread(new Runnable() 
                {

                    @Override
                    public void run() {
                        // TODO Auto-generated method stub
                        try 
                        {
                            client = new Socket(etIP.getText().toString(), port);
                            printwriter = new PrintWriter(client.getOutputStream(),true);
                            printwriter.write(messsage);
                            printwriter.flush();
                            printwriter.close();
                            client.close();
                        }

                        catch (UnknownHostException e) {
                            e.printStackTrace();
                        } catch (IOException e) {
                            // TODO Auto-generated catch block
                            e.printStackTrace();
                        }       
                    }
                }).start();

            }
        });
    }

}

<uses-permission android:name="android.permission.INTERNET" /> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-11-25T06:33:40.640

试试这个代码..这对我来说非常有用..

```
public class ServerActivity extends Activity {

    TextView messageText;
    Button uploadButton;
    int serverResponseCode = 0;
    ProgressDialog dialog = null;

    String upLoadServerUri = null;

    final String uploadFilePath = "mypath";
     final String uploadFileName = "myfile";

    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_server);

        uploadButton = (Button)findViewById(R.id.uploadButton);
        messageText  = (TextView)findViewById(R.id.messageText);

        messageText.setText("Uploading file path :- 'path"+uploadFileName+"'");

        upLoadServerUri = "serverpath";

        uploadButton.setOnClickListener(new OnClickListener() 
        {            
            @Override
            public void onClick(View v)
            {

                dialog = ProgressDialog.show(UploadToServer.this, "", "Uploading file...", true);

                new Thread(new Runnable()
                {
                        public void run() 
                        {
                             runOnUiThread(new Runnable() 
                             {
                                    public void run() 
                                    {
                                        messageText.setText("uploading started.....");
                                    }
                                });                      

                             uploadFile(uploadFilePath + "" + uploadFileName);

                        }
                      }).start();        
                }
            });
    }

    public int uploadFile(String sourceFileUri)
    {

          String fileName = sourceFileUri;

          HttpURLConnection conn = null;
          DataOutputStream dos = null;  
          String lineEnd = "\r\n";
          String twoHyphens = "--";
          String boundary = "*****";
          int bytesRead, bytesAvailable, bufferSize;
          byte[] buffer;
          int maxBufferSize = 1 * 1024 * 1024; 
          File sourceFile = new File(sourceFileUri); 

          if (!sourceFile.isFile())
          {

               dialog.dismiss(); 

               Log.e("uploadFile", "Source File not exist :"
                                   +uploadFilePath + "" + uploadFileName);

               runOnUiThread(new Runnable() 
               {
                   public void run() 
                   {
                       messageText.setText("Source File not exist :" +uploadFilePath + "" + uploadFileName);
                   }
               }); 

               return 0;

          }
          else
          {
               try 
               { 

                     // open a URL connection to the Servlet
                   FileInputStream fileInputStream = new FileInputStream(sourceFile);
                   URL url = new URL(upLoadServerUri);

                   // Open a HTTP  connection to  the URL
                   conn = (HttpURLConnection) url.openConnection(); 
                   conn.setDoInput(true); // Allow Inputs
                   conn.setDoOutput(true); // Allow Outputs
                   conn.setUseCaches(false); // Don't use a Cached Copy
                   conn.setRequestMethod("POST");
                   conn.setRequestProperty("Connection", "Keep-Alive");
                   conn.setRequestProperty("ENCTYPE", "multipart/form-data");
                   conn.setRequestProperty("Content-Type", "multipart/form-data;boundary=" + boundary);
                   conn.setRequestProperty("uploaded_file", fileName); 

                   dos = new DataOutputStream(conn.getOutputStream());

                   dos.writeBytes(twoHyphens + boundary + lineEnd); 
                   dos.writeBytes("Content-Disposition: form-data; name=\"uploaded_file\";filename=\""
                                             + fileName + "\"" + lineEnd);

                   dos.writeBytes(lineEnd);

                   // create a buffer of  maximum size
                   bytesAvailable = fileInputStream.available(); 

                   bufferSize = Math.min(bytesAvailable, maxBufferSize);
                   buffer = new byte[bufferSize];

                   // read file and write it into form...
                   bytesRead = fileInputStream.read(buffer, 0, bufferSize);  

                   while (bytesRead > 0) 
                   {

                     dos.write(buffer, 0, bufferSize);
                     bytesAvailable = fileInputStream.available();
                     bufferSize = Math.min(bytesAvailable, maxBufferSize);
                     bytesRead = fileInputStream.read(buffer, 0, bufferSize);   

                    }

                   // send multipart form data necesssary after file data...
                   dos.writeBytes(lineEnd);
                   dos.writeBytes(twoHyphens + boundary + twoHyphens + lineEnd);

                   // Responses from the server (code and message)
                   serverResponseCode = conn.getResponseCode();
                   String serverResponseMessage = conn.getResponseMessage();

                   Log.i("uploadFile", "HTTP Response is : " 
                           + serverResponseMessage + ": " + serverResponseCode);

                   if(serverResponseCode == 200)
                   {

                       runOnUiThread(new Runnable() 
                       {
                            public void run()
                            {

                                String msg = "File Upload Completed.\n\n See uploaded file here : \n\n"+" serverpath"
                                              +uploadFileName;

                                messageText.setText(msg);
                                Toast.makeText(UploadToServer.this, "File Upload Complete.", 
                                             Toast.LENGTH_SHORT).show();
                            }
                        });                
                   }    

                   //close the streams //
                   fileInputStream.close();
                   dos.flush();
                   dos.close();

              } 
               catch (MalformedURLException ex) 
               {

                  dialog.dismiss();  
                  ex.printStackTrace();

                  runOnUiThread(new Runnable() 
                  {
                      public void run() 
                      {
                          messageText.setText("MalformedURLException Exception : check script url.");
                          Toast.makeText(UploadToServer.this, "MalformedURLException", Toast.LENGTH_SHORT).show();
                      }
                  });

                  Log.e("Upload file to server", "error: " + ex.getMessage(), ex);  
              } 
               catch (Exception e) 
               {

                  dialog.dismiss();  
                  e.printStackTrace();

                  runOnUiThread(new Runnable() 
                  {
                      public void run()
                      {
                          messageText.setText("Got Exception : see logcat ");
                          Toast.makeText(UploadToServer.this, "Got Exception : see logcat ", 
                                  Toast.LENGTH_SHORT).show();
                      }
                  });
                  Log.e("Upload file to server Exception", "Exception : " 
                                                   + e.getMessage(), e);  
              }
              dialog.dismiss();       
              return serverResponseCode; 

           } 
         }
     } 
```

希望这会帮助你:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-24T06:16:03.453

```
HttpURLConnection connection = null;
DataOutputStream outputStream = null;
DataInputStream inputStream = null;
String pathToOurFile = "/data/file_to_send.mp3";
String urlServer = "http://192.168.1.1/handle_upload.php";
String lineEnd = "\r\n";
String twoHyphens = "--";
String boundary =  "*****";

int bytesRead, bytesAvailable, bufferSize;
byte[] buffer;
int maxBufferSize = 1*1024*1024;

try
{
    FileInputStream fileInputStream = new FileInputStream(new File(pathToOurFile) );

    URL url = new URL(urlServer);
    connection = (HttpURLConnection) url.openConnection();

    // Allow Inputs &amp; Outputs.
    connection.setDoInput(true);
    connection.setDoOutput(true);
    connection.setUseCaches(false);

    // Set HTTP method to POST.
    connection.setRequestMethod("POST");

    connection.setRequestProperty("Connection", "Keep-Alive");
    connection.setRequestProperty("Content-Type", "multipart/form-data;boundary="+boundary);

    outputStream = new DataOutputStream( connection.getOutputStream() );
    outputStream.writeBytes(twoHyphens + boundary + lineEnd);
    outputStream.writeBytes("Content-Disposition: form-data; name=\"uploadedfile\";filename=\"" + pathToOurFile +"\"" + lineEnd);
    outputStream.writeBytes(lineEnd);

    bytesAvailable = fileInputStream.available();
    bufferSize = Math.min(bytesAvailable, maxBufferSize);
    buffer = new byte[bufferSize];

    // Read file
    bytesRead = fileInputStream.read(buffer, 0, bufferSize);

    while (bytesRead &gt; 0)
    {
        outputStream.write(buffer, 0, bufferSize);
        bytesAvailable = fileInputStream.available();
        bufferSize = Math.min(bytesAvailable, maxBufferSize);
        bytesRead = fileInputStream.read(buffer, 0, bufferSize);
    }

    outputStream.writeBytes(lineEnd);
    outputStream.writeBytes(twoHyphens + boundary + twoHyphens + lineEnd);

    // Responses from the server (code and message)
    serverResponseCode = connection.getResponseCode();
    serverResponseMessage = connection.getResponseMessage();

    fileInputStream.close();
    outputStream.flush();
    outputStream.close();
}
catch (Exception ex)
{
    //Exception handling
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T17:41:23.867

尝试使用此代码创建 txt 文件，将字符串写入该文件并将其发送到服务器...

```
File f = new File(Environment.getExternalStorageDirectory(),"new");
        if(!f.exists())
        {
            f.mkdir();
        }
        File file = new File("new.txt");
        FileWriter w = new FileWriter("/sdcard/new/new.txt");
        BufferedWriter out = new BufferedWriter(w);
        out.write(data);
        out.flush();
        out.close();
                          String file_name = "/sdcard/new/new.txt";

        File file1 = new File(file_name);  
        socket = new Socket("117.218.28.70", 2020);

        ObjectInputStream ois = new ObjectInputStream(socket.getInputStream());  
        ObjectOutputStream oos = new ObjectOutputStream(socket.getOutputStream());  

        oos.writeObject(file1.getName());  

        FileInputStream fis = new FileInputStream(file1);  
        byte [] buffer = new byte[450000];  
        Integer bytesRead = 0;  

        while ((bytesRead = fis.read(buffer)) > 0) 
        {  
            oos.writeObject(bytesRead);  
            oos.writeObject(Arrays.copyOf(buffer, buffer.length));  
        }  
        oos.close();  
        ois.close();  
        System.exit(0); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-16T05:43:52.063

此代码将数据（图像、mp3、文本文件等）上传到 HTTP 服务器

```
HttpURLConnection connection = null;
DataOutputStream outputStream = null;
DataInputStream inputStream = null;

String pathToOurFile = "/data/file_to_send.mp3";
String urlServer = "http://192.168.1.1/handle_upload.php";
String lineEnd = "\r\n";
String twoHyphens = "--";
String boundary =  "*****";

int bytesRead, bytesAvailable, bufferSize;
byte[] buffer;
int maxBufferSize = 1*1024*1024;

try
{
FileInputStream fileInputStream = new FileInputStream(new File(pathToOurFile) );

URL url = new URL(urlServer);
connection = (HttpURLConnection) url.openConnection();

// Allow Inputs & Outputs
connection.setDoInput(true);
connection.setDoOutput(true);
connection.setUseCaches(false);

// Enable POST method
connection.setRequestMethod("POST");

connection.setRequestProperty("Connection", "Keep-Alive");
connection.setRequestProperty("Content-Type", "multipart/formdata;boundary="+boundary);

outputStream = new DataOutputStream( connection.getOutputStream() );
outputStream.writeBytes(twoHyphens + boundary + lineEnd);
outputStream.writeBytes("Content-Disposition: form-data;
name=\"uploadedfile\";filename=\"" + pathToOurFile +"\"" + lineEnd);
outputStream.writeBytes(lineEnd);

bytesAvailable = fileInputStream.available();
bufferSize = Math.min(bytesAvailable, maxBufferSize);
buffer = new byte[bufferSize];

// Read file
bytesRead = fileInputStream.read(buffer, 0, bufferSize);

while (bytesRead > 0)
{
outputStream.write(buffer, 0, bufferSize);
bytesAvailable = fileInputStream.available();
bufferSize = Math.min(bytesAvailable, maxBufferSize);
bytesRead = fileInputStream.read(buffer, 0, bufferSize);
}

outputStream.writeBytes(lineEnd);
outputStream.writeBytes(twoHyphens + boundary + twoHyphens + lineEnd);

// Responses from the server (code and message)
serverResponseCode = connection.getResponseCode();
serverResponseMessage = connection.getResponseMessage();

fileInputStream.close();
outputStream.flush();
outputStream.close();
}
catch (Exception ex)
{
//Exception handling
  } 
```

# google-maps - 在谷歌地图中使用地理编码 API 搜索位置

> ID：14351873
> 
> 赞同：1
> 
> 时间：2013-01-16T05:23:41.613
> 
> 标签：google-maps, google-maps-api-3, geolocation, geocoding

我想 `"http://maps.google.co.in/maps?q=canara+bank&hl=en&sll=12.953997,77.63094&sspn=1.069318,1.234589&hq=canara+bank&t=m&z=10"`使用谷歌地图 API 获得从谷歌地图 url 呈现的完全相同的结果。

我尝试过使用 geoCode API，但有些无法获得类似的结果。

```
<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<style type="text/css">
   html {
          height: 100%
   }

   body {
      height: 100%;
      margin: 0;
      padding: 0
   }

  #map_canvas {
      height: 100%
   }
 </style>
<script type="text/javascript"
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDjW1WmSDPUaziJY6DtwMtRLhsGrzy7YLA&sensor=false">
</script>
<script type="text/javascript">

function getLocation()
{
if (navigator.geolocation)
{
    navigator.geolocation.getCurrentPosition(populateData,showError);
}
else{alert("Geolocation is not supported by this browser.");}
}

function showError(error)
  {
  switch(error.code) 
    {
    case error.PERMISSION_DENIED:
     alert("User denied the request for Geolocation.");
      break;
    case error.POSITION_UNAVAILABLE:
      alert("Location information is unavailable.");
      break;
    case error.TIMEOUT:
      alert("The request to get user location timed out.");
      break;
    case error.UNKNOWN_ERROR:
      alert("An unknown error occurred.");
      break;
    }
  }

function populateData(position)
{

   var geocoder = new google.maps.Geocoder();
   var address = "canara bank";

    geocoder.geocode( {
                        'address': "canara bank"                        
                    }, function(results, status) {

    if (status == google.maps.GeocoderStatus.OK) {
        var latitude = results[0].geometry.location.lat() ;
        var longitude = results[0].geometry.location.lng();

       var mapOptions = {
                     //display the map center from the user location
                     center: new google.maps.LatLng(position.coords.latitude,position.coords.longitude),
                     zoom: 9,
                     zoomControl:true,
                     zoomControlOptions: {
                     style:google.maps.ZoomControlStyle.SMALL
                     },
             mapTypeId: google.maps.MapTypeId.ROADMAP
            };
           var map = new google.maps.Map(document.getElementById("map_canvas"),
            mapOptions);

     var marker = new google.maps.Marker({    
             position: new google.maps.LatLng(results[0].geometry.location.lat(), results[0].geometry.location.lng()),    
             map: map    
            });

//for placing the markers
    var markers;
    var i;      
    for(i=0;i<results.length;i++){
        markers = new google.maps.Marker({    
            position: new google.maps.LatLng(results[i].geometry.location.lat(), results[i].geometry.location.lng()),    
            map: map,
           });
     }

     var circleOptions = new google.maps.Circle({
                  center: new google.maps.LatLng(latitude, longitude),
                  radius: 2000,
                  strokeColor: "#FF0000",
                  strokeOpacity: 0.5,
                  strokeWeight: 2,
                  fillColor: "#FF0000",
                  fillOpacity: 0.35,
                  map: map
                });       

    }
} );

}

</script>

</head>
<body onload="getLocation()">

<div id="map_canvas" style="width: 100%; height: 50%"></div>
<form name="form_simple" action=" " method="get">
    <center>
        <label id="d1"> map test</label>
    </center>
</form> 
```

我还想知道在使用地理编码 API 时是否有**sll**（谷歌地图中用于指定 lat 和 lng 的参数）替代方案。

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T06:51:34.673

“Canara Bank”不是地址。[地理编码 API](https://developers.google.com/maps/documentation/geocoding/)将地址转换为坐标（来自文档）：

> 地理编码是将地址（如“1600 Amphitheatre Parkway, Mountain View, CA”）转换为地理坐标（如纬度 37.423021 和经度 -122.083739）的过程

您想要[Places API](https://developers.google.com/places/)：

> Google Places API 是一项服务，可返回有关 Places 的信息——在此 API 中定义为场所、地理位置或著名的兴趣点

[例子](http://www.geocodezip.com/v3_GoogleEx_places-searchboxC.html?q=Canara%20Bank,%20Connaught%20Place,%20New%20Delhi,%20Delhi,%20India)

# css - DIV 包装器内的 DIV 不保留包装器背景

> ID：14351874
> 
> 赞同：0
> 
> 时间：2013-01-16T05:23:50.637
> 
> 标签：css, html, header, wrapper

我一直在开发一个具有非常标准的布局、页眉、内容、页脚的网站，每个都是一个在页面范围的 DIV 内具有 900px 宽度的 DIV，就像在这个问题中描述的那样：

[全宽背景，没有包装](https://stackoverflow.com/questions/6201508/full-width-background-without-a-wrapper)

现在问题本身是，每当浏览器窗口的宽度小于指定的 DIV 宽度（900 像素）时，包装器的背景似乎就会消失，显示网站本身的背景颜色。使用上述问题中的代码时也会发生这种情况。

这是CSS代码：

```
#headerwrapper {
    height: 229px;
    background: url(imagenes/header.gif);
    background-repeat: repeat;}

#header {
    width:900px;
    height:229px;
    padding:0px;
    margin:0 auto;
} 
```

这是HTML代码：

```
<div id="headerwrapper">
    <div id="header">
      Content goes here.
    </div>
</div> 
```

任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T21:09:39.047

您可能在滚动区域中看不到背景。您需要设置`min-width: 900px;`或`max-width: 900px;`使背景显示在滚动区域中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T21:28:30.593

如果你不为 指定宽度`#headerwrapper`，浏览器会将其设为父容器（div 或 body）的 100%。因此，如果视图区域的宽度小于 900px -`#header`变得比 宽`#headerwrapper`，因此重叠部分不会显示背景。您可以添加`overflow:auto;`滚动`#headerwrapper`条，但我认为这不是解决方案。所以最好为`#header`或添加背景`min-width`。`#headerwrapper`PS 指定

```
 min-width:900px;
  width:auto !important; 
```

因为`#headerwrapper`应该做的伎俩。

# python - 在 django 中保存模型

> ID：14351879
> 
> 赞同：1
> 
> 时间：2013-01-16T05:24:32.317
> 
> 标签：python, django, django-models, multiple-sites

我正在开发一个***多站点项目***，为此我正在使用**夹层 + 墨盒**。我想*为两个站点使用相同的库存*。但是这样做有一些问题：表中有一个字段`site_id`存储`product`了当前站点的 ID。因此，我不能重用`product`网站。

有什么方法（比如借助信号或任何东西）可以在数据库中保存一个条目两次，并更改某些字段的值？

如果这是可能的，那么我只需要覆盖`site_id`：其余内容与上一个条目中的内容相同。从而减少了为不同站点两次输入产品的工作量。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T09:04:18.800

我会告诫不要把同样的东西写两次。有些事情肯定会出错，你会有两个不匹配的数据库。为什么不把site_id-product关系做成M2M，这样就可以拥有多个`site_id`呢？

# android - 如何在 Eclipse（Android）中打开“启动器图标创建向导”？

> ID：14351881
> 
> 赞同：24
> 
> 时间：2013-01-16T05:24:56.017
> 
> 标签：android, eclipse, icons

创建新的 android 项目时会出现此向导。

我想更改一个 android 项目的应用程序图标。手动将我的新版本图标图像编辑成不同的密度效率有点低，因此我想再次在 eclipse 中打开这个向导。我该怎么做？

向导的图像： ![在此处输入图像描述](../Images/d238b5ae41885dbdac2ca282938c17d5.png)

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2013-01-16T05:32:28.757

1.  右键单击您的项目。
2.  选择`New`然后`other`。
3.  在`type filter text`部分中输入`android icon set`.
4.  从结果中选择`Android Icon Set`并单击`Next`。您可以在那里再次创建启动器图标！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-10-25T21:53:50.307

***图标创建向导***

*   选择您的项目
*   Ctrl+n
*   安卓图标集

# html - CSS 和嵌套 Divs - 父 Div 不会采用子高度，溢出：自动不是一个好的修复

> ID：14351883
> 
> 赞同：2
> 
> 时间：2013-01-16T05:25:14.503
> 
> 标签：html, height, css

**上下文：**

我正在为我的角色扮演星际迷航舰队（书呆子，是的，我知道）构建一个与 jQuery 或 PhP 一起使用的 div 名册。我需要我的 div 以某种方式运行，以使其足够健壮以从 XML 中提取并自动生成名册并自动调整我的 div 大小以适应添加的许多名称。

***使用 Firebug 等查看[我当前的构建示例](http://quae.ideagonk.com/art/TFA/LCARS/orders_stackoverflow_example.html)将有助于了解我在做什么。***

* * *

**要求：**

每个小节（前哨人员、前哨防御）都需要有多个 div：

1) 背景图片和小节容器（本例中的 div id= outpostPersonnel）

2) 列表左右两边的子分区容器。（想想报纸的段落。）

3) 在需求 1 中填充/对齐该背景图像所需的前 n 个名册名称。（div id= initialCommandTags（左侧列表）和 initialPersonnelTags（右侧列表））

4) 具有 n 个附加名册名称的 Div。(div id = overflowCommandTags, overflowPersonnelTags, )

5) 让 LCARS 看起来像 LCARS 的彩色 div 条纹仍在封装要求 4 中的 n 个名册名称。（div id = colorStretchLeft）

* * *

**问题：**

我无法让父小节 - 来自 1（outpostPersonnel）的 div 完全遵守其所有子 div 的高度 - 一直到 overflowCommandTags/overflowPersonnelTags div 的高度。

我尝试过的一种方法是，下一个小节（前哨防御）与overflowCommandTags div 重叠。另一个——这是我现在的例子（以及我放弃的地方）的方式——在overflowTags div的末尾和下一个小节（outpostDefense）的顶部之间放置了一个~160像素高的空白空间。

如果你触发[我当前的构建示例](http://quae.ideagonk.com/art/TFA/LCARS/orders_stackoverflow_example.html)，你会看到父 div (outpostPersonnel) 向下延伸，即使它的子 div 都没有那么高。

据我所知，Overflow:auto 和 Overflow:hidden 不是可行的解决方案，因为我需要 div 完全展开并且没有滚动条。

我完全被难住了。看它也是一个非常简单的解决方案。这是否与父 div 只是一个 BG 而子 div 具有实际内容的事实有关？

谢谢你陪我走到这一步！干杯!

（（另外我的 div 样式的东西是内联的原因是因为我将它嵌入到 Enjin 页面上并且我不能调用 *.css 文件。））

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T22:13:38.067

这里有几件事要提到，但我将从两个部分之间存在差距的原因开始。

从我从您使用的内联样式中可以看出，您使用了`position: relative`不同`top`的`left`值来实现所需的布局。`personnelContainer`在您已添加ID 的元素上`top: -230px`。这就是造成差距的原因。

当您相对定位一个元素时，您必须想象该元素处于其原始位置并且您只是在视觉上移动了它。换句话说，移动元素不会改变页面的流向，因此在您的示例中应用负顶部值不会改变容器的高度。（很好的参考：[http](http://reference.sitepoint.com/css/relativepositioning) ://reference.sitepoint.com/css/relativepositioning ）

考虑到这一点，您可以对后面的`top`每个部分应用负值以缩小差距，但是您可能会发现这会使问题进一步复杂化并导致内容重叠。

我能给出的最好建议是阅读以下关于浮动布局的文章：
[http://css-tricks.com/all-about-floats/](http://css-tricks.com/all-about-floats/)
[http://www.quirksmode.org/css/clearing.html](http://www.quirksmode.org/css/clearing.html)

相对定位有它的应用程序，但在这种情况下，您应该使用该`float`属性来实现您的布局。如果您阅读上面的文章，它将为您提供浮动布局的良好基础，以及如何确保您的部分正确包含所有内容。只要您没有在任何子元素上设置任何固定高度，您就会发现它们会扩展以容纳任意数量的内容。

# c# - 从两个不同的应用程序生成一个 XML(LogData.xml) 文件而不使用线程

> ID：14351885
> 
> 赞同：1
> 
> 时间：2013-01-16T05:25:37.530
> 
> 标签：c#, asp.net, xml

我想将来自两个或多个应用程序的 XML 日志文件写入 LogData.xml 文件。在运行一个应用程序时，它会正确创建 LogData.xml 文件，但同时所有图像都同时运行并尝试写入 LogData.xml 文件，它会给我一条错误消息，例如**进程无法访问文件 Log_Data.xml ' 因为它正被另一个进程使用。** 我使用此代码

```
public void WriteXmlLog(string logType, string logFlag, string logModule, string logLocation, string logText, string logStackTrace)
        {
 if (!File.Exists(_logFilePath))
            {
                //File.WriteAllText(_logFilePath, "<?xml version='1.0' encoding='utf-8' standalone='yes'?>\r\n<AppXmlLogWritter></AppXmlLogWritter>");
                XmlTextWriter textWritter = new XmlTextWriter(_logFilePath, null);
                textWritter.WriteStartDocument();
                textWritter.WriteStartElement("AppXmlLogWritter");
                textWritter.WriteEndElement();
                textWritter.Close();
            }
            XmlDocument xmlDoc = new XmlDocument();
            using (FileStream fileStream = new FileStream(_logFilePath, FileMode.OpenOrCreate, FileAccess.ReadWrite, FileShare.ReadWrite))
            {

                string currentDateTime = DateTime.Now.ToString("yyyyMMddHHmmss");
                xmlDoc.Load(fileStream);
                XmlElement newelement = xmlDoc.CreateElement("LogData");
                XmlElement xmlLogID = xmlDoc.CreateElement("LogID");
                XmlElement xmlLogDateTime = xmlDoc.CreateElement("LogDateTime");
                XmlElement xmlLogType = xmlDoc.CreateElement("LogType");
                XmlElement xmlLogFlag = xmlDoc.CreateElement("LogFlag");
                XmlElement xmlLogApplication = xmlDoc.CreateElement("LogApplication");
                XmlElement xmlLogModule = xmlDoc.CreateElement("LogModule");
                XmlElement xmlLogLocation = xmlDoc.CreateElement("LogLocation");
                XmlElement xmlLogText = xmlDoc.CreateElement("LogText");
                XmlElement xmlLogStackTrace = xmlDoc.CreateElement("LogStackTrace");

                xmlLogID.InnerText = _logIDPrefix + currentDateTime + randomNumber;
                xmlLogDateTime.InnerText = currentDateTime;
                xmlLogType.InnerText = ((LogTypes)Convert.ToInt32(logType)).ToString();
                xmlLogFlag.InnerText = logFlag;
                xmlLogApplication.InnerText = _logApplication;
                xmlLogModule.InnerText = logModule;
                xmlLogLocation.InnerText = logLocation;
                xmlLogText.InnerText = logText;
                xmlLogStackTrace.InnerText = logStackTrace;

                newelement.AppendChild(xmlLogID);
                newelement.AppendChild(xmlLogDateTime);
                newelement.AppendChild(xmlLogType);
                newelement.AppendChild(xmlLogFlag);
                newelement.AppendChild(xmlLogApplication);
                newelement.AppendChild(xmlLogModule);
                newelement.AppendChild(xmlLogLocation);
                newelement.AppendChild(xmlLogText);

                xmlDoc.DocumentElement.AppendChild(newelement);

                //}
                //finally
                //{
                //    objMutex.ReleaseMutex();
                //}

            }
            xmlDoc.Save(_logFilePath);
        } 
```

**我想在没有线程的情况下实现这一点**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T05:43:02.993

也许尝试在两个应用程序中使用[NLog](http://nlog-project.org/)实现日志记录，并将相同的 xml 设置为目标。

# actionscript-3 - 使用 AS3 从服务器（不带对话框）下载 zip 文件到桌面

> ID：14351892
> 
> 赞同：0
> 
> 时间：2013-01-16T05:26:45.960
> 
> 标签：actionscript-3

我想从服务器下载一个 zip 文件并保存在本地机器上，无需任何用户操作（没有对话框）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T05:34:26.570

不可能。想想你在问什么，特别是在安全方面。

# android - 如何使webview的父布局的宽度和高度为-10dp？

> ID：14351897
> 
> 赞同：0
> 
> 时间：2013-01-16T05:27:08.930
> 
> 标签：android, layout, webview

如何使 webview 具有 -10dp 宽度和高度的父布局，背景图像如下图所示：

更新：蓝色框是屏幕。黑框是外部布局（@+id/wrapper），红框是 webview（@+id/webview），绿框是其他布局。

![演示](../Images/f41a63631b286ce462dc21fda325984f.png)

我尝试使用以下代码但没有成功。如果 webview 中的内容太长，外部布局会被拉伸。我想在布局内有一个固定大小的 webview，但我不知道如何实现这一点。

附言。黑匣子的背景图片不是全屏的。

有人会给我一些提示吗？

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@drawable/common_background" >

    ... some other layout ...

    <LinearLayout
        android:id="@+id/wrapper"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_centerInParent="true"
        android:background="@drawable/wrapper_background" >

        <WebView
            android:id="@+id/webview"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:layout_margin="10dp" />
    </LinearLayout>

    ... some other layout ...

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T05:41:24.290

请改用此代码

```
<LinearLayout
    android:id="@+id/wrapper"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_above="@+id/someOtherLayout"
    android:layout_centerInParent="true"
    android:background="@drawable/wrapper_background" >

    <WebView
        android:id="@+id/webview"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_margin="10dp" />
</LinearLayout>

<Some Other Layout
    android:id="@+id/someOtherLayout"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T05:41:36.727

利用

> android:padding="10dip" 到 webview 的父级。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T05:43:54.690

请改用此代码

它看起来像如图所示 ![在此处输入图像描述](../Images/11f3736d550d0a04e8c9d145d3bd0b5a.png)

xml代码：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@drawable/ic_launcher" >

  ... some other layout ...
    <LinearLayout
        android:id="@+id/wrapper"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_centerInParent="true"
        android:background="@drawable/ic_launcher" >

        <WebView
            android:id="@+id/webview"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:layout_margin="10dp" />
    </LinearLayout>
  ... some other layout ...

</RelativeLayout> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T05:44:02.273

未经测试，但你可以试试这个：

```
<LinearLayout
        android:id="@+id/wrapper"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_centerInParent="true"
        android:padding="10dp"
        android:background="@drawable/wrapper_background" > 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-16T05:45:14.163

试试这个：

> ```
>  <?xml version="1.0" encoding="utf-8"?>
>  <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
>      xmlns:tools="http://schemas.android.com/tools"
>      android:layout_width="match_parent"
>      android:layout_height="match_parent"
>      android:background="@drawable/common_background" >
> ... some other layout ...
> <LinearLayout
>     android:id="@+id/wrapper"
>     android:layout_width="match_parent"
>     android:layout_height="match_parent"
>     android:layout_centerInParent="true"
>     android:padding="10dip"                   <---- Apply this in your layout.
>     android:background="@drawable/wrapper_background" >
>     <WebView
>         android:id="@+id/webview"
>         android:layout_width="match_parent"
>         android:layout_height="match_parent"
>          />
>   </LinearLayout>
>    ... some other layout ...
>   </RelativeLayout> 
> ```

# iphone - 如何在目标c的iphone设置中创建目录

> ID：14351899
> 
> 赞同：-3
> 
> 时间：2013-01-16T05:27:23.847
> 
> 标签：iphone, ios, objective-c, download, directory

我是目标 c 的新程序员。我想在 i 手机内创建“下载”目录（路径：设置（i 手机设置目录））我想知道这可能吗？我正在使用我的手机模拟器来测试程序。

另一个问题是，我如何访问在手机模拟器中创建的目录。下面包含我尝试在手机中创建文件夹的代码。但我无法使用手机模拟器访问该目录。这段代码有什么问题？

```
NSString *error;
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *dataPath = [documentsDirectory stringByAppendingPathComponent:@"/Test"];

if (![[NSFileManager defaultManager] fileExistsAtPath:dataPath])
    [[NSFileManager defaultManager] createDirectoryAtPath:dataPath withIntermediateDirectories:NO attributes:nil error:&error]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T05:36:07.343

您可以像这样在文档目录中创建目录作为子文件夹：-

```
-(IBAction)CreatDirInDocDir
{

    NSFileManager *filemgr = [NSFileManager defaultManager];
    NSString *documentsDirectory = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) lastObject];
    NSString *dir = [NSString stringWithFormat:@"%@",DirName];
    NSString *path = [documentsDirectory stringByAppendingPathComponent:dir];

    NSError *error;

    if ([filemgr fileExistsAtPath:path ] == YES){

    }
    else
    {
        NSLog (@"File not found");

        [[NSFileManager defaultManager] createDirectoryAtPath:path withIntermediateDirectories:NO attributes:nil error:&error];
    }

} 
```

当您在文档目录文件夹中创建目录时，您可以像这样获取所有已创建自定义目录的列表：-

```
//Get all Directory

 NSFileManager *fileMan = [NSFileManager defaultManager];

    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];

    NSArray *filePathsArray = [[NSFileManager defaultManager] subpathsOfDirectoryAtPath:documentsDirectory  error:nil];

    NSLog(@"files array %@", filePathsArray);

    NSMutableArray *directoryList=[[NSMutableArray alloc]init];

    for ( NSString *direPath in filePathsArray )
    {
        NSString *path = [documentsDirectory stringByAppendingPathComponent:direPath];
        BOOL isDir = NO;
        [fileMan fileExistsAtPath:path isDirectory:(&isDir)];
        if(isDir) {
            NSString *fullPath = [documentsDirectory stringByAppendingPathComponent:path];
            NSLog(@"log path ==%@",fullPath);
            [directoryList addObject:fullPath];
        }
    } 
```

> NSLog(@"列表路径 ==%@",directoryList);

现在你有了所有目录的数组，你可以得到任何带有索引的目录:) 希望它可以帮助你

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T07:00:36.947

所有这里发布的方法都是正确的，并且有很多关于它们的答案，但我想警告你一个概念。自 iCloud 推出以来，Apple 开始拒绝将大量数据保存在文档目录中的应用程序，当它们通过缓存的方式使用或以后可以再次下载时。这里的问题是您可以在云上备份您的 ios 设备，并且文档目录是备份的目录之一。你能想象自己在云上的应用程序上备份 1 GB 吗？这就是苹果拒绝的解释。
为避免临时/可重新下载/缓存的数据应保存在缓存目录中。当设备在“磁盘”上的空间不足时，这个有用的目录会被释放，例如当您尝试安装新应用程序并且您没有足够的空间时。因此，如果您的数据可以再次下载并且不是必不可少的，那就可以了。
另一种方法是将数据保留在文档目录中但告诉系统不要备份它们，这可以在保存文件的 doc 子目录中添加一个特殊标志，这里是[链接](https://developer.apple.com/library/ios/ipad/#qa/qa1719/_index.html)方式，注意这种方法是仅从 5.0.1 可用，因此如果您针对较低的 ioses，您需要检查它的存在。在这种情况下，系统不会释放您的数据并且不会备份它们，这对于苹果指南来说是安全的。
希望这可以帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T05:35:44.100

要创建目录，您可以使用：

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *dataPath = [documentsDirectory stringByAppendingPathComponent:@"Test"];
NSError *error;

if (![[NSFileManager defaultManager] createDirectoryAtPath:dataPath withIntermediateDirectories:NO attributes:nil error:&error])
{
     NSLog(@"Couldn't create directory error: %@", error);
} 
```

要获取该目录中的文件，您可以使用：

```
NSArray *datArray = [[NSFileManager defaultManager] contentsOfDirectoryAtPath:dataPath error:&error];
if(error)
{
     NSLog(@"Could not get list from directory, error = %@",error);
} 
```

这里所有的文件名都在`datArray`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T05:46:37.547

无需附加 '/' 。只需使用

```
NSString *dataPath = [documentsDirectory stringByAppendingPathComponent:@"Test"]; 
```

试试这个

```
 NSArray *dirPath;
NSString *docsDir;
NSFileManager *filemgr = [NSFileManager defaultManager];
dirPath = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
docsDir = [dirPath objectAtIndex:0];

if ([filemgr changeCurrentDirectoryPath: docsDir] == NO)
{
    NSLog(@"Error");
}else {
    NSString *currentPath = [filemgr currentDirectoryPath];
    NSLog(@"%@",currentPath);
}

NSString *dataDirectory = [docsDir stringByAppendingPathComponent:@"Test"];
if ([filemgr fileExistsAtPath:dataDirectory]){
        NSLog(@"dir Exist");
    }else{
NSLog(@"Creating Dir");
[filemgr createDirectoryAtPath:dataPath withIntermediateDirectories:NO attributes:nil error:&error];
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-17T04:09:13.323

任何人都想在我的手机模拟器中显示您创建的目录，请按照以下步骤操作：

1.  前往查找器
2.  单击 Command +Shift + g
3.  输入 ~/Library 然后点击 Go
4.  打开应用程序支持 --> i 手机模拟器

然后你可以找到你创建的应用程序和目录..

# c - C - 从字符串的中间开始遍历

> ID：14351904
> 
> 赞同：1
> 
> 时间：2013-01-16T05:27:57.047
> 
> 标签：c, string

只是仔细检查一下，因为我一直混淆 C 和 C++ 或 C#，但说我有一个字符串，我正在使用 strcspn() 解析。它返回字符串的长度，直到它找到的第一个分隔符。使用 strncpy （仅 C++ 还是在 C 中也可用？）我将字符串的第一部分复制到其他地方并有一个变量存储我的位置。假设 strcspn 返回 10 （所以分隔符是第 10 个字符）

现在，我的代码做了一些其他的事情，最终我想继续遍历字符串。我是否必须复制字符串的后半部分，然后从头开始调用 strncspn()。我可以创建一个指针并将其指向字符串的第 11 个字符并将其传递给 strncspn()（我猜是 char* pos = str[11] 之类的东西）吗？我只是想念其他更简单的东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T05:29:06.580

您的意思`str[9]`是第 10 个字符或`str[10]`第 11 个字符，但是是的，您可以这样做。

请注意，您访问的不是超出字符串长度和分配的内存大小。

听起来您正在执行**标记化**，我建议您可以直接使用**[`strtok`](http://www.cplusplus.com/reference/cstring/strtok/)**它，它会更干净，并且它已经处理了您想要做的事情（strcspn+strncpy 并在分隔符之后继续解析）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T05:32:57.990

您可以`strcspn`再次调用`(str + 11)`作为第一个参数。但要确保长度`str`大于`11`。

```
n = strcspn(str, pattern);
while ((n+1) < strlen(str))
{
    n2 = strcspn((str+n), pattern);
    n += n2;
} 
```

注意：使用`char *pos = str[11]`是错误的。你应该使用喜欢`char *pos = str + 11;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T05:34:24.443

您可以获得指向字符串中间位置的指针，而无需复制字符串的后半部分来执行此操作。

```
char * offset = str + 10; 
```

和

```
char * offset = &str[10]; 
```

意思相同，都做你想做的事。

# vba - excel vba同步问题

> ID：14351911
> 
> 赞同：3
> 
> 时间：2013-01-16T05:29:02.897
> 
> 标签：vba, excel, synchronization

我正在使用excel做一些数据分析工作。场景是这样的：我使用一些 excel 插件组件从远程站点获取数据。例如，`=get_the_latest_data(ID)`输入`A1`，则调用此函数，并将 ID 的数据`A2`填入`A11`。我的目标是

```
for each id in id_array
    sheet1.range("a1") = get_the_latest_data(id)
    create a new sheet named id
    save data from a2 to a11 to thi new sheet
next 
```

我的问题是函数需要一些时间`get_the_latest_data`才能从远程获取所有数据。因此，在我的代码中，新工作表无法获得正确的结果。在将数据从 sheet1 复制到新工作表之前，我尝试使用 application.wait。但它没有用。

有什么方法可以确保在从远程获取所需数据后将数据复制到新工作表中？顺便说一句，我无权访问`get_the_latest_data`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T07:20:33.557

通常，VBA 仅在前一步完全完成后才执行下一步。除非调用触发了一些后台操作（例如，刷新启用了“后台刷新”的数据连接。

您可以执行以下操作来解决问题：

**禁用后台刷新：**如果您查看连接的属性，请取消选择“启用后台刷新”

**等到刷新完成数据查询特定检查：**通过以下方式修改您的代码：

```
    Range("A11").Clear '启用检查
    subCallToTriggerDataLoadHere
    While Range("A11").Value "" ' 或任何其他特定检查以查看您的刷新是否完成
        做事件
    文德
    ...

```

**使用查询的 AfterRefresh 事件：** [有关详细信息，请参阅此帖子](https://stackoverflow.com/questions/3585369/excel-vba-and-refreshall-ended-message)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T10:31:22.590

这似乎是第三方数据供应商的典型案例，他们的泛型数据请求是**ashynchronus**的，这对用户的公开程度不是很好。在这种情况下，您可能需要与您的供应商核实您正在调用的方法的行为。必须至少设置某种`boolean`类型的变量以选择具有异步或同步请求/检索。

例如。如果您要发送一个索引代码以获得前 10 名成员，那么此方法现在正在收集您的所有索引代码并用所有数据回击您。因此，请检查返回的数据是否可以**拆分**，例如它是一个多维数组，您可以根据`id`. 否则，请与此应用程序的 API 开发人员交谈，因为`DoEvents`他们可能太弱而无法处理此问题。

* * *

~~我建议您使用 anarrayList/collection 项来保存从您的方法返回的每个 id 的数据。完成后，您可以开始创建工作表，因为您已经在本地捕获了数据。~~

 ~~```
Dim al as Object

Set al = CreateObject("System.Collections.ArrayList")
for each id in id_array
    al.add get_the_latest_data(id) '--possibly returning a variant
next

'--for each item in arrayList then you create a sheet by outputing the data    

for i = 0 to al.Count
   '--Create new sheet put your code here
   '--transpose the data 
   Sheets(i+1).Range("A2").Resize(UBound(al(i))) = Application.Transpose(al(i))
Next i 
```~~

# php - 智能地限制匿名评级？

> ID：14351914
> 
> 赞同：3
> 
> 时间：2013-01-16T05:29:23.173
> 
> 标签：php, api, rest, rate-limiting

这对我来说很奇怪。我有一个客户想要一个 5 星匿名评级系统为他们的网站。我决定现在不是使用其他人的解决方案而是深入研究骨干/下划线的好时机，以此为切入点。

问题是我不确定我应该如何限制匿名连接以避免滥用评级系统？

我最初的想法是每 2 秒进行 1 次评分，每分钟 15 次评分，每个 IP 每小时 200 次配额。但是，这可能会限制大型 NAT 下的那些问题。我可以通过混合用户代理来解决这个问题，但后来我遇到了一个问题，即他们可以轻松地伪造每个请求以绕过整个限制系统。我可以尝试 cookie，但同样，它们很容易被删除。

对经过验证的解决方案有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T06:57:05.237

我建议通过 IP 和用户代理的组合来识别不同的匿名用户。关于速率限制 - 每 2 秒 1 个评分太频繁了，每天 1 个评分怎么样？

# python - 请求的“配置”选项去哪儿了？

> ID：14351915
> 
> 赞同：2
> 
> 时间：2013-01-16T05:29:30.870
> 
> 标签：python, logging, python-requests

根据[这个问题](https://stackoverflow.com/questions/14348857/requests-library-not-properly-directing-http-requests-through-proxies)的建议，我`requests`从 git 更新到最新版本以使代理工作。但是，我看到`config`kwarg 不见了，阻止我`config={'verbose': sys.stderr}`在我的代码中使用等记录。

它去哪儿了？它仍然建在我找不到的地方吗？这非常有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T05:41:51.000

如[更改日志](https://github.com/kennethreitz/requests/blob/master/HISTORY.rst)中所示，配置在 1.0 中被彻底删除。

基于[这个问题](https://stackoverflow.com/questions/11029717/how-do-i-disable-log-messages-from-the-requests-library)，似乎日志记录是通过标准库`logging`模块执行和配置的。

# javascript-events - 使用 Jquery 1.3 触发 beforeunload

> ID：14351920
> 
> 赞同：0
> 
> 时间：2013-01-16T05:30:32.067
> 
> 标签：javascript-events, jquery

我需要在 Jquery 1.3 中收听 beforeunload。

在 Jquery 1.4 中，我可以使用

> $(window).bind('beforeunload', function(){ ... });

由于绑定方法在 JQ 1.3 中不可用，我有哪些选项可以收听此事件。

# c# - 在 C# 中只打开一次 Windows 窗体

> ID：14351925
> 
> 赞同：2
> 
> 时间：2013-01-16T05:31:06.970
> 
> 标签：c#, winforms

> **可能重复：**
> [如何避免在 c# 中出现多个 windows 窗体实例](https://stackoverflow.com/questions/1403600/how-to-avoid-multiple-instances-of-windows-form-in-c-sharp)

我想在应用程序中只显示一次打开的表单而不将它们创建为 MDI 表单。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-16T05:32:32.717

在从您的代码中打开表单之前，请检查[Application.OpenForms](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.openforms.aspx)属性并查看该表单是否存在于集合中。

就像是：

```
if ((Application.OpenForms["Form1"] as Form1) != null)
{
 //Form is already open
}
else
{
// Form is not open
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T05:36:34.073

您可以只使用 show\hide 方法来打开您的表单。每次显示后，您还需要初始化所有表单字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T05:36:34.137

使用默认值为 false 的布尔变量，一旦显示表单，您将其设置为 true，并在表单打开时检查变量。

# ruby-on-rails-3 - 将 rails 升级到 3.2.11 后黄瓜测试失败

> ID：14351926
> 
> 赞同：0
> 
> 时间：2013-01-16T05:31:09.187
> 
> 标签：ruby-on-rails-3, cucumber

这个让我难过了几天。。

我有一个黄瓜测试，它在 rails 3.2.11 上失败，但在 rails 3.2.3 上通过。我收到一条没有路线匹配的错误，但是当我在网站上手动执行完全相同的步骤时，它可以工作。

我的路线是 -

```
 get 'reward_player/:id' => 'reward_players#show', :as => :reward_player 
```

我得到的错误是

```
 No route matches {:controller=>"admin/reward_player", :action=>"show", :id=>nil} 
```

我访问此页面的步骤只是 click_link “奖励玩家”。当我使用 save_and_open_page 查看页面时，id 在链接中。我真的不确定发生了什么，或者它是否是一个应该一直失败的测试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T06:08:18.970

所以它最终成为我的路线，它应该是

```
 get 'reward_player/:user_id' => 'reward_players#show', :as => :reward_player 
```

看到控制器正在寻找参数中的 user_id。所以最终成为一个不应该真正通过的测试。

# gwt - 如何在 GWT 中从一个页面重定向到另一个页面

> ID：14351928
> 
> 赞同：4
> 
> 时间：2013-01-16T05:31:19.460
> 
> 标签：gwt

我想从一个 GWT 页面重定向到另一个页面。我知道一个 GWT 模块在 war 文件中只有一个 .html 页面。但是有没有办法从一个 .html 页面重定向到另一个模块中的另一个 GWT 页面。？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T05:53:13.447

```
Window.Location.replace(newModuleUrl) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T05:37:30.950

您可以使用以下代码执行此操作：

```
UrlBuilder builder = Location.createUrlBuilder().setParameter(
          queryParam, value);
Window.Location.replace(builder.buildString()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-22T23:39:45.307

要在历史记录中留下痕迹，请使用：

```
Window.Location.assign(newModuleUrl) 
```

要不在浏览器历史记录中留下记录的当前 URL，请使用：

```
Window.Location.replace(newModuleUrl) 
```

*谢谢托马斯布罗[耶](https://stackoverflow.com/users/116472/thomas-broyer)*

# ektron - 在 Ektron 中使用 API 检索以前版本的内容

> ID：14351930
> 
> 赞同：3
> 
> 时间：2013-01-16T05:31:33.727
> 
> 标签：ektron

我正在开发 Ektron 8.6。

如何通过使用 API 传递内容 ID 来检索以前版本的内容？以前的版本是指编辑前的内容数据（一个内容可能有多次编辑）。它可以通过API检索这些不同的版本吗？

ektron 中是否有任何实用程序可以直接将内容转换为文档？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T22:39:20.940

这是一个示例：

```
var contentManager = new ContentManager();
var historyList = contentManager.GetHistoryList(contentId);
foreach(var historyData in historyList)
{
     var contentData = contentManager.GetContentByHistoryId(historyData.Id);
} 
```

您可以在此处找到您要使用的相关命名空间：Ektron.Cms.Framework.Content.ContentManager。

# css - 尝试添加背景图像时 Sass 语法错误无效的 CSS

> ID：14351934
> 
> 赞同：3
> 
> 时间：2013-01-16T05:31:56.233
> 
> 标签：css, ruby-on-rails, background-image, sass

我正在尝试在“css.scss”文件中添加背景图像。我不断收到此错误：

> "...und-image: url(": expected ")" 之后的无效 CSS 是 "<%=asset_path(..." (在 /Users/caseyrees/Projects/citycreek/app/assets/stylesheets/custom. css.scss)

我是这样写的：

```
background-image: url( <%= asset_path 'home/facebook.png' %>); 
```

如果我将文件扩展名更改为“css.erb”，它似乎可以工作。我需要它来处理 .scss 文件扩展名。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T05:41:43.307

你不想写`assert_path`，试试这个，（来自我的一个工作 css.scss 文件）

```
background: url(image_path('footer_bg.jpg')) repeat-x center top; 
```

我的`footer_bg.jpg`形象在`app/asset/images`

高温高压

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-22T00:36:16.050

我遇到了同样的问题，并通过在 ruby​​ 代码周围添加引号来解决它，如下所示：

背景图片: url('<%=asset_path 'home/facebook.png' %>');

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T05:37:10.533

由于它位于 .scss 文件中，因此您的 ruby​​ 代码似乎没有被执行。

当我在 PHP 中做类似的事情时，我的解决方案是链接到一个包含真实 .scss 文件的 php 文件。就像是

```
@file:<?php echo($value);?>;
<php include("style.less"); ?> 
```

然后在您的文档中链接到这个文件，而不是您的 .scss 文件

编辑：如果您需要在链接文件中添加 .scss 扩展名，请尝试 @import-ing 一个 .erb 文件

# android - 每次滚动回屏幕时，Android listview 项目都会更新

> ID：14351938
> 
> 赞同：-1
> 
> 时间：2013-01-16T05:32:02.477
> 
> 标签：android, listview, random

我有一个`listView`内容为随机生成的数字。如果其中的一项`listView`滚动出屏幕，然后又滚动回屏幕，则随机生成的数字会更改（它会生成一个新数字）。

有什么办法可以防止这种情况发生吗？

示例代码在[这里](https://bitbucket.org/androidplot/androidplot/src/c6aa6d346f37/Examples/DemoApp/src/com/androidplot/demos/ListViewActivity.java?at=master)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T05:38:10.320

这是因为每次您的项目离开屏幕并再次出现在前面时，它都会调用 getview() 方法。为了解决这个问题，您可以将所有随机生成的数字存储在一个数组中，并使用它来显示项目。或者我认为使用视图持有者类（我没有尝试）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T05:43:54.800

只需尝试此代码用于 listview 实现侦听器和/或每次向上和/或向下滚动时调用的 getview() 方法，

```
mListView.setOnScrollListener(new OnScrollListener() {

        @Override
        public void onScrollStateChanged(AbsListView view, int scrollState) {
            // write down your code here
            // i think notifyDataSetChanged() this method calling whatever u require.
        }

        @Override
        public void onScroll(AbsListView view, int firstVisibleItem, 
                int visibleItemCount, int totalItemCount) {
            // write down your code here
        }
    }); // mListView.setOnScrollListener close 
```

# api - 在 facebook 上使用 https 调用 api，而foursquare 不工作

> ID：14351939
> 
> 赞同：-1
> 
> 时间：2013-01-16T05:32:06.377
> 
> 标签：api, facebook-graph-api, https, foursquare

我在使用 facebook 和foursquare API 时遇到奇怪的问题 我无法通过HTTPS 从我的机器调用API，即使我可以使用HTTPS 打开facebook 和许多其他使用HTTPS 但不能 [打开api.foursquare.com](https://api.foursquare.com)和[graph.facebook.com 的网站](https://graph.facebook.com)

非常感谢任何帮助

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T05:35:06.660

可能是您的 SSL 证书没有通过验证？自签名我可以想象，因为您是从本地主机调用的？

# scala - 设置 sbt 环境以一次破解多个库

> ID：14351940
> 
> 赞同：7
> 
> 时间：2013-01-16T05:32:20.333
> 
> 标签：scala, sbt

sbt 中是否有与 Leiningen 的“结帐”功能等效的功能？

这是我想要完成的事情：

我有两个项目，一个应用程序**Foo**和库“ **Bar** ”。我想独立发布这些项目中的每一个。 **Foo**依赖于**Bar** ，每当第三方尝试构建“Foo”（这是典型行为）时，sbt 项目将指示 sbt 从存储库下载“ **Bar ”的 jar。**

现在，假设我想同时破解**Foo**和**Bar**。例如，在处理**Foo**时，我想直接编辑和调试**Bar**的一些源代码，以便编辑影响**Foo**（然后在方便时重建**Bar ）。**

在这个 hack 会话期间，我如何指示 sbt从它在我的机器（而不是我的本地存储库）上的源代码满足它对**Bar的依赖？**

（PS 我对 Clojure/Leiningen提出了[类似的问题。Leiningen 具有完成此任务的](https://stackoverflow.com/questions/8846706/workflow-for-hacking-on-clojure-libraries-using-swank-clojure)[“结帐”](http://jakemccrary.com/blog/2012/03/28/working-on-multiple-clojure-projects-at-once/)功能。我想知道 sbt 中是否有类似的东西......）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-16T06:35:20.220

您可以通过项目引用声明从 Foo 到 Bar 的源依赖项：

```
import sbt._

object FooBuild extends Build {
  lazy val root = Project(
    id = "foo",
    base = file(".")
  ) dependsOn(theBarBuild)

  lazy val theBarBuild = ProjectRef(
    base = file("/path/to/bar"),
    id = "bar")
} 
```

每当您编译 Foo 时，这也应该重新编译 Bar（如果它已更改）。请注意，`id`项目引用的 id 必须与 Bar 项目的实际 id 匹配，这可能类似于例如`default-edd2f8`，如果您使用简单的构建定义（`.sbt`仅限文件）。

这种技术对插件特别有用（请参阅我关于此主题的[博客文章）。](http://blog.flierl.eu/2012/05/project-references-for-sbt-plug-in.html)

**编辑：**

您可以像这样重新编码结帐行为：

```
import sbt._

object FooBuild extends Build {
  lazy val root = addCheckouts(Project(id = "foo", base = file(".")))

  def addCheckouts(proj: Project): Project = {
    val checkouts = proj.base.getCanonicalFile / "checkouts"
    if (! checkouts.exists) proj
    else proj.dependsOn(IO.listFiles(DirectoryFilter)(checkouts).map { dir =>
      ProjectRef(base = dir, id = dir.name): ClasspathDep[ProjectReference]
    }:_*)
  }
} 
```

这将检查您的项目目录中的`checkouts`目录，如果存在，则将其中的目录（应该是其他项目的符号链接）添加为项目的项目引用。它期望符号链接被命名为链接项目的实际 ID（例如`default-edd2f8`或`bar`）。如果该目录不存在，则构建就像以前一样工作。

当您在 checkouts 目录（或目录本身）中添加或删除符号链接时，您必须重新加载 Foo 项目以获取更改。

希望这可以帮助。

# node.js - node.js 天蓝色存储 blob

> ID：14351944
> 
> 赞同：3
> 
> 时间：2013-01-16T05:32:33.587
> 
> 标签：node.js, azure, azure-blob-storage

我是 Azure&node.js 初学者。我试图在 node.js 上执行下面的文件上传示例，但它在`blob.client.createContainerIfNotExists()`.

错误显示：

```
Error: createContainerIfNotExists 
```

这意味着`createContainerIfNotExists()`简单地显示错误情况。

不知是不是我写错了，`blob.client.createContainerIfNotExists()`还是`azure.createBlobService()`没能成功。

```
node.js version v0.6.12
express version 2.5.11
azure version 0.5.3 
```

谢谢！

```
/**********************/
  File upload sample:
/**********************/

var DEVSTORE_STORAGE_ACCOUNT = 'xxxxx';
var DEVSTORE_STORAGE_ACCESS_KEY= 'xxxx';
var DEVSTORE_BLOB_HOST = 'xxxxx';

var express = require('express')
, routes = require('./routes');

var util   = require('util');

// Azure module
var azure  = require('azure');
var blob   = require('./blob.js');

// BLOB container
blob.CONTAINER = 'nodejs';

// BLOB service
 blob.client = azure.createBlobService(
  DEVSTORE_STORAGE_ACCOUNT,
  DEVSTORE_STORAGE_ACCESS_KEY,
  DEVSTORE_BLOB_HOST);

var app = module.exports = express.createServer();

 // Configuration

app.configure(function() {
  app.set('views', __dirname + '/views');
  app.set('view engine', 'ejs');
  app.use(express.bodyParser());
  app.use(express.methodOverride());
  // app.use(express.logger());
  app.use(app.router);
  app.use(express.static(__dirname + '/public'));
});

app.configure('development', function(){
  app.use(express.errorHandler({ dumpExceptions: true, showStack: true }));
});

app.configure('production', function(){
  app.use(express.errorHandler());
});

// Routes

app.get('/', routes.index);

// BLOB upload
app.get('/upload', routes.upload);

// BLOB upload
app.post('/uploadtoblob', routes.uploadblob);

// BLOB list
app.get('/list', routes.listblobs);

// BLOB delete
app.post('/delete/:id', routes.deleteblob);

// BLOB property
app.get('/info/:id', routes.information);

// BLOB container create
blob.client.createContainerIfNotExists(blob.CONTAINER, function(err) {
  if (err) {
    console.log('Error : createContainerIfNotExists');
    process.exit(1);
  } else {

    blob.client.setContainerAcl(blob.CONTAINER,         azure.Constants.BlobConstants.BlobContainerPublicAccessType.BLOB, function(err) {
      if(err) {
    console.log('Error : setContainerAcl');
    process.exit(1);
      }
    });
  }
});

var port = process.env.port || 3000;
app.listen(port, function(){
  console.log("Express server listening on port %d in %s mode", app.address().port,     app.settings.env);
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T05:13:53.457

用于节点的最新 azure sdk 需要节点版本 > 0.6.l5。我建议同时升级 sdk 和你的节点版本。

您可以按如下方式更改代码以获取有关特定错误的更多信息：

console.log('错误：createContainerIfNotExists' + JSON.stringify(err));

您需要让 azure 存储模拟器在本地运行，*或者*您需要为应用程序可以使用的 azure 存储帐户提供凭据。这通常通过 AZURE_STORAGE_ACCOUNT 和 AZURE_STORAGE_ACCESS_KEY 环境变量来完成，或者通过将连接字符串传递给 createBlobService 工厂来完成。

有关使用 blob 存储设置您的第一个应用程序的分步示例，请参阅：

[http://www.windowsazure.com/en-us/develop/nodejs/how-to-guides/blob-storage/](http://www.windowsazure.com/en-us/develop/nodejs/how-to-guides/blob-storage/)

# search - 使用 Web 服务从 Netsuite 会计科目表中检索期初余额

> ID：14351947
> 
> 赞同：0
> 
> 时间：2013-01-16T05:32:49.447
> 
> 标签：search, account, netsuite

当我尝试使用 Webservice 从 Netsuite 检索帐户详细信息时，期初余额始终返回 null。

我正在使用以下代码来检索帐户详细信息：

```
AccountSearch accountSearch = new AccountSearch();
AccountSearchBasic accBasic = new AccountSearchBasic();
accountSearch.setBasic(accBasic);
port.search(accountSearch); 
```

我还尝试使用 port.get(recordRef)、port.getList(recordRef[]) 和 port.getAll(getAllrecord) 但得到了相同的结果。还有其他方法可以使用 webservice 检索 Netsuite 的帐户详细信息吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T02:10:15.393

这可能会有所帮助

```
public boolean performSearch(NetSuitePortType p_objportCall) throws Exception
{
    boolean status = false;
    AccountSearchBasic l_objaccountSearchBasic = new AccountSearchBasic();
    try
    {
        SearchResult l_objSearchResult = p_objportCall.search(l_objaccountSearchBasic);
        System.out.println(" Account Search Number of records: " +l_objSearchResult.getTotalRecords());
        if (l_objSearchResult.getTotalRecords() > 0 )
        {
           processResults(l_objSearchResult.getRecordList());
        }
    }
    catch (Exception e)
    {
        System.err.println("Acct Search performsearch: "+e.toString());
        throw e;
    }
    return status; 
```

# java - 以特定元素顺序从三个列表元素创建一个新列表

> ID：14351954
> 
> 赞同：-1
> 
> 时间：2013-01-16T05:33:04.353
> 
> 标签：java, algorithm, list

假设我有三个列表：

```
 a = {a, b, c, d, e}  
 b = {A, B, C}  
 c = {aa, bb, cc, dd} 
```

现在我需要从每个列表中取出 3 个元素并将它们插入到一个新列表中，从列表 a 到 c。所以新的列表应该是：

```
newlist = {a, b, c, A, B, C, aa, bb, cc, d, e, dd} 
```

我想知道在 Java 中最快的方法是什么？

[更新]
统一数据类型，让需求更清晰。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T05:48:58.683

使用`Iterables.concat(Iterable<T> ...)`，它会创建所有可迭代对象的实时视图，并将其串联为一个（如果更改可迭代对象，则串联版本也会更改）。`Iterables.unmodifiableIterable(Iterable<T>)`然后用（我之前没有看到只读要求）包装连接的迭代。

来自`Iterables.concat( .. )`JavaDocs：

将多个可迭代对象组合成一个可迭代对象。返回的迭代器有一个迭代器，它遍历输入中每个迭代器的元素。输入迭代器只有在必要时才会轮询。当对应的输入迭代器支持时，返回的迭代器的迭代器支持 remove()。

虽然这没有明确说明这是一个实时视图，但最后一句暗示它是（`Iterator.remove()`仅当支持迭代器支持该方法时才支持该方法，除非使用实时视图，否则这是不可能的）

示例代码：

```
final List<Integer> first  = Lists.newArrayList(1, 2, 3);
final List<Integer> second = Lists.newArrayList(4, 5, 6);
final List<Integer> third  = Lists.newArrayList(7, 8, 9);
final Iterable<Integer> all =
    Iterables.unmodifiableIterable(
        Iterables.concat(first, second, third));
System.out.println(all);
third.add(9999999);
System.out.println(all); 
```

输出：

```
[1, 2, 3, 4, 5, 6, 7, 8, 9]
[1, 2, 3, 4, 5, 6, 7, 8, 9, 999, 9999] 
```

得到结果后，您可以对单个列表进行排序。

归并排序真的很简单。

```
/**
 * Mergesort algorithm.
 * @param a an array of Comparable items.
 */
public static void mergeSort( Comparable [ ] a ) {
    Comparable [ ] tmpArray = new Comparable[ a.length ];
    mergeSort( a, tmpArray, 0, a.length - 1 );
}

/**
 * Internal method that makes recursive calls.
 * @param a an array of Comparable items.
 * @param tmpArray an array to place the merged result.
 * @param left the left-most index of the subarray.
 * @param right the right-most index of the subarray.
 */
private static void mergeSort( Comparable [ ] a, Comparable [ ] tmpArray,
        int left, int right ) {
    if( left < right ) {
        int center = ( left + right ) / 2;
        mergeSort( a, tmpArray, left, center );
        mergeSort( a, tmpArray, center + 1, right );
        merge( a, tmpArray, left, center + 1, right );
    }
}

/**
 * Internal method that merges two sorted halves of a subarray.
 * @param a an array of Comparable items.
 * @param tmpArray an array to place the merged result.
 * @param leftPos the left-most index of the subarray.
 * @param rightPos the index of the start of the second half.
 * @param rightEnd the right-most index of the subarray.
 */
private static void merge( Comparable [ ] a, Comparable [ ] tmpArray,
        int leftPos, int rightPos, int rightEnd ) {
    int leftEnd = rightPos - 1;
    int tmpPos = leftPos;
    int numElements = rightEnd - leftPos + 1;

    // Main loop
    while( leftPos <= leftEnd && rightPos <= rightEnd )
        if( a[ leftPos ].compareTo( a[ rightPos ] ) <= 0 )
            tmpArray[ tmpPos++ ] = a[ leftPos++ ];
        else
            tmpArray[ tmpPos++ ] = a[ rightPos++ ];

    while( leftPos <= leftEnd )    // Copy rest of first half
        tmpArray[ tmpPos++ ] = a[ leftPos++ ];

    while( rightPos <= rightEnd )  // Copy rest of right half
        tmpArray[ tmpPos++ ] = a[ rightPos++ ];

    // Copy tmpArray back
    for( int i = 0; i < numElements; i++, rightEnd-- )
        a[ rightEnd ] = tmpArray[ rightEnd ];
} 
```

# hibernate - 休眠过滤器未在 Grails 服务/作业中应用

> ID：14351955
> 
> 赞同：3
> 
> 时间：2013-01-16T05:33:05.340
> 
> 标签：hibernate, grails, grails-orm

我的域使用如下休眠过滤器：

```
class UserMapping {
    // Senseless App Logic here
    static hibernateFilters = {
        typeFilter(condition: "type = 'IDENTIFIED'", default: true)
        flagFilter(condition: "flags = 'ACTIVE'", default: true)
    }
} 
```

当我在控制器中使用它们时，它们似乎适用，但是当我在我的服务或工作中执行相同的 findBy.. 时，它们不会被应用。有什么建议么？

如果有什么不同，我会在 mixin 中调用 findBy。

这个问题似乎相关，但它不完全是我正在寻找的： [启用 grails hibernate filters](https://stackoverflow.com/questions/6113436/enabling-grails-hibernate-filters)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T11:43:41.693

唯一一次自动启用过滤器是在 Web 请求期间 - 这是由于插件`HibernateFilterFilters`在每个 Web 请求之前应用所有启用的过滤器。但是没有全局自动过滤逻辑——这是不切实际的。

而是使用[插件文档](http://grails.org/plugin/hibernate-filter)中描述的方法之一，例如

```
UserMapping.withHibernateFilters {
   ..code to execute
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-17T16:19:21.133

就我而言，我发现我忘记了“default：true”标志。:o

我们在 BootStrap.groovy 中也有启用休眠过滤器的代码：

```
def init = { servletContext ->
    //Hibernate filters
    MyDomainObject.enableHibernateFilter('myFilter')
} 
```

（我意识到这个问题已经得到解答，但我希望这可以帮助其他正在寻找的人。）

# python - Python，返回值设计的建议

> ID：14351961
> 
> 赞同：1
> 
> 时间：2013-01-16T05:33:41.820
> 
> 标签：python

这个问题很模糊，因为问题是出于正当理由滥用 Python。假设我有 python 作为程序输入：

```
scf() # produces F,C that are somehow available globally
ci() # uses F,C 
```

问题是，可以`scf`修改调用者的模块吗？

第二种情况：

```
F,C = scf() # F,C are not set globally. 
```

所以基本上要么捕获值（x），要么全局设置它。如何做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T05:43:22.073

分享这个让我很不舒服，但是在 CPython 中你可以改变堆栈帧：

```
import sys
def scf():
    frame = sys._getframe(1) #caller's frame (probably)
    frame.f_globals['F'] = 'F' #add/overwrite globals
    frame.f_globals['C'] = 'C'

def ci():
    print F, C

scf()
ci() # prints 'F C' 
```

但是，为什么需要无形地改变调用者的命名空间呢？这是糟糕的设计。`scf()`应该返回东西并且`ci()`应该接受这些东西作为参数。如果您分享更多关于您正在做的事情，也许我们可以建议更好的方法。

## 更新

因此，您试图在 Python 程序的外部执行字符串之间保持某种状态。这在 Python 中是微不足道的：只需保留一个显式的局部变量和全局变量命名空间，并在调用和 Friends 之间传递[`exec`它](http://docs.python.org/2/library/functions.html#eval)。

```
s1 = """
foo = 'bar'
"""

s2 = """
def myImpureFunction():
    global foo
    foo = 1
myImpureFunction()
"""

lvars, gvars = {}, {}

exec s1 in lvars, gvars
print gvars
exec s2 in lvars, gvars
print gvars 
```

也许为了保持*一些*理智，您可以向您的用户保证在运行之间将保留一个特殊的 var：

```
s1 = """
stash.foo = 'bar'
"""

s2 = """
def myImpureFunction():
    stash.foo = 'foo'
myImpureFunction()
"""

from types import ModuleType

lvars = {'stash': ModuleType('stash')}

exec s1 in lvars
print lvars['stash'].foo
exec s2 in lvars
print lvars['stash'].foo 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T06:26:22.440

我通常通过创建类似于以下的对象池来解决这个问题

```
>>> class Pool:
    from collections import namedtuple, defaultdict, OrderedDict
    namespace = defaultdict(OrderedDict)
    @staticmethod
    def add(ns='default', **kwargs):
        Pool.namespace[ns].update(kwargs)
    @staticmethod
    def pop(ns='default', *args):
        return [Pool.namespace[ns].pop(k) for k in args]
    @staticmethod
    def remove(ns):
        if ns == 'default':
            raise AttributeError
        del Pool.namespace[ns]
    @staticmethod
    def get(ns='default', **kwargs):
        if kwargs:
            return namedtuple(ns,kwargs.keys())(Pool.namespace[ns][k] for k in kwargs)
        else:

            return namedtuple(ns,Pool.namespace[ns].keys())(*Pool.namespace[ns].values())
    @staticmethod
    def ns():
        return Pool.namespace.keys()
    @staticmethod
    def purge():
        Pool.namespace = defaultdict(OrderedDict)

>>> Pool.add('NS1',F=10,G=20)
>>> Pool.add('NS2',A=1,B=2)
>>> Pool.pop('NS1')
[]
>>> Pool.pop('NS1','F')
[10]
>>> Pool.get('NS1')
NS1(G=20)
>>> Pool.add(X=100,Y=200)
>>> Pool.ns()
['', 'NS1', 'NS2']
>>> Pool.remove('NS1')
>>> Pool.ns()
['', 'NS2']

>>> def sci():
    Pool.add("sci",F=20,G=30)

>>> def ci():
    ns_sci = Pool.get("sci")
    print ns_sci.F, ns_sci.G

>>> sci()
>>> ci()
20 30
>>> 
```

您现在可以跨函数或模块使用它，而不会污染全局命名空间。您还可以跨命名空间分布它，以便多个命名空间可以共存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T05:37:50.073

你可以创建一个类：

```
class A(object):
    def scf(self):
        self.F = 10
        self.C = 20
    def ci(self):
        print self.F, self.C 
```

**更新：**

或“独立”类：

```
class B(object):
    @staticmethod
    def scf():
        B.F = 10
        B.C = 20
    @staticmethod
    def ci():
        print B.F, B.C

B.scf()
B.ci() 
```

# java - 通过java程序从图像中读取字符值

> ID：14351962
> 
> 赞同：7
> 
> 时间：2013-01-16T05:33:45.420
> 
> 标签：java, image-processing

![在此处输入图像描述](../Images/39ca121d33af60a0531f6818ca08441d.png)

大家好，

如图所示，我有一个图像，其中包含图像中的用户名、城市和工作字段。我只想用 java 程序从这个图像中读取这些字符字段值。如果有人对此有任何想法，请告诉我

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T11:34:32.357

您可以通过图像使用 Java 字符识别进行谷歌搜索，并且此[示例也有很好的方法。](http://asprise.com/product/ocr/download.php?lang=java)这个罐子你可以用来测试

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T02:51:17.627

[Tess4J](http://tess4j.sf.net)是 Tesseract 引擎的 Java 包装器，可以识别此类图像（重新缩放到 300 DPI 后）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T05:37:08.223

您应该开始研究[此处所示](http://www.javawhat.com/showCategory.do?id=2138003)的字符识别库。另外，看看这个问题[here](https://stackoverflow.com/questions/1813881/java-ocr-implementation)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T07:18:21.237

要读取图像，您可以使用 BufferedImage：[http ://docs.oracle.com/javase/tutorial/2d/images/loadimage.html](http://docs.oracle.com/javase/tutorial/2d/images/loadimage.html)

加载图像后，您可以运行 OCR 模块来获取其文本。以下是一些 OCR 软件的示例，从好到坏排序：ABBYY（但它不是免费的）、Tesseract、Java OCR、Asprise...

仅此而已！

# ruby-on-rails - 使用 JST 支持前后共享 Rails 模板

> ID：14351963
> 
> 赞同：0
> 
> 时间：2013-01-16T05:33:52.883
> 
> 标签：ruby-on-rails, templates, sprockets, jst

我想在 Rails 应用程序的前后共享 js 模板，以应对代码重复的情况。

要求是：

*   下划线 (ejs) 或车把/小胡子模板。最好是 ejs，因为我已经在使用下划线客户端。
*   我还想利用 rails 资产管道将它们拉入 JST 对象/函数中，这样我就可以将模板文件分开，并可以获得缓存等其他好处。

我发现了一些适用于一种情况或另一种情况的宝石，例如 handlebars_haml_assets、ejs、FlavourSaver 等，但没有一个能够满足所有这些要求。前后共享 js 模板以及在 rails 3 应用程序中使用 JST 的最佳方式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:48:53.617

Rails 3.2 资产管道，开箱即用，支持 Embedded Javascript (EJS) 或 Embedded CoffeeScript (Eco) 模板，并使用`JST`（JavaScript 模板）命名空间提供。只需适当地命名您的文件：

```
app/assets/templates/top_level.jst.ejs
app/assets/templates/subdir/nested.jst.eco 
```

要在您的 javascript 中使用它们：

```
var html = JST['top_level']({ data: 'something' });
var html = JST['subdir/nested']({ data: 'something' }); 
```

# c# - 与 Fluent API（现有数据库）的多对多关系

> ID：14351964
> 
> 赞同：0
> 
> 时间：2013-01-16T05:33:58.047
> 
> 标签：c#, sql-server, asp.net-mvc

我的应用程序将有用户和组。A`User`可以是多个 1 的一部分`Group`。一个`Group`也可以有多个`User`。

我一直用[这个](http://blog.staticvoid.co.nz/2012/7/17/entity_framework-navigation_property_basics_with_code_first)作为参考。特别是底部附近标有“许多关系”的部分。该示例与我的项目之间的区别在于我的表已经存在，我需要将我的模型映射到它。我怀疑我应该能够从`Membership`表中删除我的主键并且它可能会起作用（因为它更接近示例），但我想在弄乱数据库表之前确保。我也很可能`Fluent`是完全错误的。

**编辑**

在我进一步研究这个问题的答案时，我偶然发现了一些可以提高所提供答案质量的东西。我想指出的是，它需要能够独立地添加`User`、`Usergroup`和`Membership`。

**SQL**

```
CREATE TABLE TestDB.[UserGroup]
(
    GroupID int identity not null,
    Name varchar(100) not null,
    Comment varchar(1000)

    PRIMARY KEY(GroupID)
)
CREATE TABLE TestDB.[User]
(
    SomeID int not null,
    FirstName varchar(100) not null,
    LastName varchar(100) not null,
    Middle varchar(1) not null,
    Email varchar(100) not null,
    Phone varchar(16) not null,
    Comment varchar(1000)

    PRIMARY KEY(SomeID)
)
CREATE TABLE TestDB.[Membership]
(
    MembershipID int identity not null,
    GroupID int not null,
    SomeID int not null

    PRIMARY KEY(MembershipID)
    FOREIGN KEY(GroupID) references TestDB.[UserGroup](GroupID),
    FOREIGN KEY(SomeID) references TestDB.[User](SomeID)
) 
```

注意：`SomeID`之所以这样命名，是因为 ID 是通过另一个系统给出的。数据库不会自动生成此特定 ID。它保证是唯一的。

**模型**

```
public class UserGroup
{ 
    public int GroupID { set; get; }
    public string Name { set; get; }
    public string Comment { set; get; }

    public virtual ICollection<User> Users { set; get; }
}
public class User
{
    public string SomeID { set; get; }
    public string FirstName { set; get; }
    public string LastName { set; get; }
    public string Email { set; get; }
    public string Phone { set; get; }
    public string Comment { set; get; }

    public virtual ICollection<UserGroup> UserGroups { set; get; }
} 
```

**流利的映射**

```
modelBuilder.Entity<User>().ToTable("User", "TestDB");
modelBuilder.Entity<User>().HasKey(r => new { r.SomeID });
modelBuilder.Entity<User>()
            .HasMany(r => r.UserGroups)
            .WithMany(r => r.Users)
            .Map(m =>
                {
                    m.MapLeftKey("SomeID");
                    m.MapRightKey("GroupID");
                    m.ToTable("Membership");
                });

modelBuilder.Entity<UserGroup>().ToTable("UserGroup", "TestDB");
modelBuilder.Entity<UserGroup>().HasKey(r => new { r.GroupID }); 
```

**当前问题** 代码已更新以反映我目前拥有的内容。我可以同时独立查询`Users`，`UserGroups`但它不允许我访问`Navigation Properties`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T07:31:24.537

我想到了。我最初的问题非常愚蠢，而且我比我想象的更接近。其中一个愚蠢的错误实际上是将两个实体映射到同一个表，这会破坏对该数据库的每次调用。

你需要做的第一件事是确保你所有的`Navigation properties`都是虚拟的。

```
public virtual ICollection<User> Users { set; get; } 
```

从这里你需要弄清楚 Fluent API 映射。我最初忘记包含 的架构`ToTable`，它不允许我从 到`User`遍历`UserGroup`。在您不在现有数据库上工作的情况下，不需要该`.Map`块。将自动生成一个包含 Keys`SomeID`和`GroupID`. 表名将是两个子表名连接的结果。[在这里](http://blog.staticvoid.co.nz/2012/7/17/entity_framework-navigation_property_basics_with_code_first)阅读更多。使用现有数据库时，这只会将它创建的表映射到您已经创建的表。

```
modelBuilder.Entity<User>()
        .HasMany(r => r.UserGroups)
        .WithMany(r => r.Users)
        .Map(m =>
            {
                m.MapLeftKey("SomeID");
                m.MapRightKey("GroupID");
                m.ToTable("Membership", "TempDB");
            }); 
```

[另一个伟大的来源](https://stackoverflow.com/questions/7050404/create-code-first-many-to-many-with-additional-fields-in-association-table)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T05:49:33.787

您不需要或不希望在用户组和用户组中拥有用户。你应该选择其中之一。恕我直言，我会`List <user>`从 UserGroups 对象中删除。

仍然可以使用 Linq 查询对象集合`User`以生成属于特定组的用户列表。

# c - C 宏中的#x 是什么意思？

> ID：14351971
> 
> 赞同：50
> 
> 时间：2013-01-16T05:34:40.107
> 
> 标签：c, macros

例如我有一个宏：

```
#define PRINT(int) printf(#int "%d\n",int) 
```

我有点知道结果是什么。但是#int 怎么会代表整个事情呢？

我有点忘记这个细节了。任何人都可以给我一个提示吗？

谢谢！

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-01-16T05:43:35.377

在这种情况下（应用于宏定义中的参数引用），井号表示将此参数扩展为传递给宏的参数的文字文本。

在这种情况下，如果您调用`PRINT(5)`宏扩展将是`printf("5" "%d\n", 5);`which 将打印`5 5`; 不是很有用；但是，如果您调用`PRINT(5+5)`宏扩展将是`printf("5+5" "%d\n", 5+5);`哪个 print `5+5 10`，那么微不足道。

这个例子[在 C 预处理器的教程中进行了](http://www.cprogramming.com/tutorial/cpreprocessor.html)解释（顺便说一下，它是谷歌第一次点击[c 宏磅符号](https://www.google.com/search?q=c+macro+pound+sign)）。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-01-16T05:56:32.820

“#”可以显示变量的名称，最好将宏定义为：

```
#define PRINT(i) printf(#i " = %d\n", i) 
```

并像这样使用它：

```
int i = 5;
PRINT(i); 
```

结果显示：

```
i = 5 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-16T05:36:46.270

这是宏参数名称的错误选择，但无害（感谢dreamlax）。

基本上如果我这样写

```
PRINT(5); 
```

它将被替换为

```
printf("5" "%d\n",5); 
```

或者

```
printf("5 %d\n",5); 
```

这是一个称为[Stringification](https://gcc.gnu.org/onlinedocs/gcc-4.7.0/cpp/Stringification.html)的过程，#int 被替换为由其内容组成的字符串，5 -> "5"

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-07-20T08:03:05.147

'#' 称为字符串化运算符。Stringize 运算符在传递的参数周围加上引号并返回一个字符串。它仅用于带参数的 marco 语句中。

```
#include<stdio.h> 

#define stringLiteral(sl) #sl

int main()
{
   char StringizeOpreator = 'a'; 
   printf(stringLiteral(StringizeOpreator));
   return 0;
} 
```

在这里，`stringLiteral`marco 接受形式参数`sl`并返回`#sl`。传递的实际参数是`StringizeOpreator`可变的。return 语句`#sl`有`#`运算符，它在参数周围加上引号`"StringizeOpreator"`并返回一个字符串。

所以上述程序的输出是实参'StringizeOpreator'的名称，而不是传递的实参中存储的值。

```
output :
StringizeOperator
...
exitcode 0 
```

要了解更多信息，请访问此链接： [字符串化运算符](https://docs.microsoft.com/en-us/cpp/preprocessor/stringizing-operator-hash?view=vs-2019)

# asp.net - 如何在客户端身份验证流程中禁用使用 Open ID 提供程序的动态注册？

> ID：14351973
> 
> 赞同：0
> 
> 时间：2013-01-16T05:35:09.573
> 
> 标签：asp.net, openid, dotnetopenauth, google-openid

**背景**：我在我的 asp.net 网站中使用 Open ID 身份验证。以下是它目前的工作方式 - 用户将从下拉列表（google/yahoo/myopenid/etc..）中选择一个 Open ID 提供程序，然后单击登录按钮。然后，应用程序会将用户传递到提供者身份验证页面。在开放 ID 提供程序站点上成功进行身份验证和授权后，用户将被定向到我的应用程序。到目前为止，一切都很好。

**问题**：在 Open ID 提供者身份验证页面上，如果用户选择/单击“注册”，则提供者将遵循自己的工作流程，并且控件永远不会返回到我的应用程序。

**问题**：有没有一种方法可以禁用提供程序的动态注册（即注册）？这样，用户就需要向提供程序注册然后使用我的应用程序？或者
有没有办法在动态注册完成后找回控制权？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T05:49:41.193

不可以。OpenID 协议没有这样的规定，虽然提供者记住最终将他们的新用户重定向回您的站点是有礼貌的，但并非所有人都这样做。

# javascript - 悬停时颜色去饱和图像，鼠标移出时再次去饱和 html5 css3

> ID：14351976
> 
> 赞同：3
> 
> 时间：2013-01-16T05:35:30.747
> 
> 标签：javascript, html, css

代码已准备好，但我希望图像在鼠标悬停时变为彩色（即删除 IMG 的灰度属性），当鼠标离开时，图像应该再次变为灰度。

如果仅通过 css 是不可能的。javascript 也可以，但请不要使用 jquery，我不知道 jquery。

代码如下：

```
<style type="text/css">

#ajabox:hover #ajainner{
    height:100px;
    top:-100px;
}

#ajainner{
    width:332px;
    overflow:hidden;
        height:0px;
    background-image:url(../../images/bg_black_50.png);
    position:relative;
    top:-1px;
    transition: top .4s ease-in, height .4s ease-in;
    -ms-transition: top .4s ease-in, height .4s ease-in;
    -webkit-transition: top .4s ease-in, height .4s ease-in;
    -o-transition: top .4s ease-in, height .4s ease-in;
    -moz-transition: top .4s ease-in, height .4s ease-in;
}

#ajabox{
    width:332px;
    margin:0px;
    padding:0px;
    border:0px;
    height:209px
    display:-webkit-box;
    display:box;
    display:-moz-box;
    display:-ms-box;
    display:-o-box;
    overflow:hidden;
}
span{
     color:#FFF; 
     font-family:Verdana, Geneva, sans-serif; 
     left:10px; 
     top:10px; 
     position:relative;
}
img.desaturate { 
    filter: grayscale(100%);
    -webkit-filter: grayscale(100%);
    -moz-filter: grayscale(100%);
    -ms-filter: grayscale(100%);
    -o-filter: grayscale(100%);
    filter: url(desaturate.svg#greyscale);
    -webkit-filter: grayscale(1);
    filter: gray;
}

</style>
<script type="text/javascript">
</script>
<body bgcolor="#000000">
<div id="ajabox">
    <img src="http://fc03.deviantart.net/fs70/f/2011/123/c/9/adam_jensen__s_army_____________by_gtanmay-d3fh5pw.png" style="width:332px;" class="desaturate"/>
    <div id="ajainner">
        <span>Adam Jensen's Army</span>
        <br />
        <span style="font-size:12px">Made from the CD cover of "Assassin's Creed: Brotherhood"<br />Feat. Adam Jensen(Deus Ex: Human Revolution)</span>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-16T06:23:37.093

```
img { /* Universal settings */
    -webkit-transition:all .4s;
    -moz-transition:all .4s;
    -ms-transition:all .4s;
    -o-transition:all .4s;
    transition:all .4s;
}
img:not(:hover) {
    -webkit-filter:grayscale(100%);
    -moz-filter:grayscale(100%);
    -ms-filter:grayscale(100%);
    -o-filter:grayscale(100%);
    filter:grayscale(100%);
}
img:hover {
    -webkit-filter:grayscale(0%);
    -moz-filter:grayscale(0%);
    -ms-filter:grayscale(0%);
    -o-filter:grayscale(0%);
    filter:grayscale(0%);
} 
```

:not 选择器在较旧的浏览器中不起作用，但也不会过滤，所以它应该不是什么大问题。

[示例小提琴。](http://jsfiddle.net/ddhboy/rNVpJ/)

# python - 功能属性

> ID：14351978
> 
> 赞同：3
> 
> 时间：2013-01-16T05:35:31.963
> 
> 标签：python, python-2.7

我想使用函数属性来设置变量值作为使用全局变量的替代方法。但有时我会为函数分配另一个短名称。该行为似乎总是按照我的意愿行事，即无论我使用长名称还是短名称，都会将值分配给函数，如下所示。这有什么危险吗？

```
def flongname():
    pass

f = flongname
f.f1 = 10
flongname.f2 = 20
print flongname.f1, f.f2 
```

最后一行返回`10 20`显示不同的函数名引用同一个函数对象。正确的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T05:38:25.390

`id`表明两者`f`和`flongname`都是对同一对象的引用。

```
>>> def flongname():
...     pass
... 
>>> f = flongname
>>> id(f)
140419547609160
>>> id(flongname)
140419547609160
>>> 
```

所以是的-您正在经历的行为是预期的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-16T05:43:43.400

```
f = flongname  # <- Now f has same id as flongname
f.f1 = 10 # <- a new entry is added to flongname.__dict__
flongname.f2 = 20 # <- a new entry is added to flongname.__dict__
print flongname.f1, f.f2 # Both are refering to same dictionary of the function 
```

照原样看起来并不危险，只要记住没有其他人在修改它`dict`

```
In [40]: f.__dict__
Out[40]: {}

In [41]: flongname.__dict__
Out[41]: {}

In [42]: f.f1=10

In [43]: flongname.__dict__
Out[43]: {'f1': 10}

In [44]: f.__dict__
Out[44]: {'f1': 10}

In [45]: flongname.f2 = 20

In [46]: f.__dict__
Out[46]: {'f1': 10, 'f2': 20} 
```

# magento - Magento：无法开票、发货或完成零美元总订单

> ID：14351980
> 
> 赞同：0
> 
> 时间：2013-01-16T05:35:34.590
> 
> 标签：magento, magento-1.7

我们的 Magento 商店 (1.7) 有一些促销代码，允许选择个人免费订购。促销代码工作正常。问题是，当订单进入后端时，我们无法为应付零余额的订单开具发票或发货。我们使用“免费送货”付款方式完成交易。

订单视图页面中缺少发票和取消按钮。发货按钮在那里，但是当我进入发货屏幕时，没有提交发货按钮。

有谁知道如何为应付总额为 0 美元的订单解决此问题？

# php - 使用 php 在浏览器中打开 Excel 文档

> ID：14351983
> 
> 赞同：0
> 
> 时间：2013-01-16T05:35:43.837
> 
> 标签：php, excel, ms-word

> **可能重复：**
> [php在浏览器中打开excel文件](https://stackoverflow.com/questions/3861397/php-open-excel-file-in-browser)

我上传了一个 Excel 表格到我的服务器，现在我想在浏览器中打开它，而不是强制下载。是否有任何 php 库可用于这样做。

我想将其显示为带有行和列的 excel 表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T05:42:47.937

实际上这里有一个很好的答案！[php在浏览器中打开excel文件](https://stackoverflow.com/questions/3861397/php-open-excel-file-in-browser)

希望这可以帮助！

# javascript - 使用 Javascript 填充 HTML 表格并保留 CSS 样式

> ID：14351985
> 
> 赞同：1
> 
> 时间：2013-01-16T05:35:48.377
> 
> 标签：javascript, jquery, html, mobile, html-table

到目前为止，我有下面的代码工作。我唯一的问题是当表格插入其父 div 时，没有应用 HTML 表格的关联样式。解决此问题的最佳方法是什么？我将 jQuery 与 jQuery mobile 结合使用。

```
var tableBase = '<table data-role="table" id="score-table" style="margin-left: auto; margin-right: auto;" class="ui-responsive table-stroke ui-table ui-table-reflow"><thead><tr><th data-priority="1">Event</th><th data-priority="2">Score</th></tr></thead><tbody>';
function buildTable(data) {
     var tableCopy = tableBase;
     data.forEach(function(element, index, array) {
         tableCopy = tableCopy + '<tr><td>' + element.event + '</td><td>'
            + element.points + '<td></tr>';
      });
tableCopy = tableCopy + '</tbody></table>';
return tableCopy;
} 
```

然后我有一个`#('#targetDiv').html(buildTable(myData))`将表格html插入到它的div中。除了未应用样式外，一切正常。我正在使用来自 jQuery mobile 的响应式/重排表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T08:56:02.910

我认为您在将表插入 DOM 后也重新运行了该表的插件：http: [//jquerymobile.com/demos/1.2.0-alpha.1/docs/pages/page-dynamic.html](http://jquerymobile.com/demos/1.2.0-alpha.1/docs/pages/page-dynamic.html)

```
// Pages are lazily enhanced. We call page() on the page
// element to make sure it is always enhanced before we
// attempt to enhance the listview markup we just injected.
// Subsequent calls to page() are ignored since a page/widget
// can only be enhanced once.
$page.page();

// Enhance the listview we just injected.
$content.find( ":jqmData(role=listview)" ).listview(); 
```

# c# - 如何在不使用 Assembly.LoadFile() 的情况下在 EXE 中合并 System.Data.SQLite.DLL

> ID：14351989
> 
> 赞同：0
> 
> 时间：2013-01-16T05:36:21.713
> 
> 标签：c#, system.data.sqlite

System.Data.SQLite.DLL 是一个混合代码 DLL。它包含 C 和 C#。我知道如何将其添加为嵌入式资源，将其写入临时文件并使用 Assembly.LoadFile() 加载它。

我的问题是有没有其他方法可以在不将其写入临时文件的情况下加载它？我希望将它与 EXE 组合成单个程序集。

谢谢任何建议

**对答案的回应：**

**致：奥列格·伊格纳托夫**

嗨，我修改它以加载如下：

```
static System.Reflection.Assembly CurrentDomain_AssemblyResolve(object sender, ResolveEventArgs args)
{
    Assembly asm = null;
    AppDomain domain = (AppDomain)sender;
    if (args.Name.Contains("System.Data.SQLite"))
    {
        try
        {
            asm = domain.Load(WindowsFormsApplication24.Properties.Resources.System_Data_SQLite);
        }
        catch (Exception ex)
        {
            Form f = new Form();
            TextBox t = new TextBox(); t.Dock = DockStyle.Fill;
            t.Multiline = true; t.ScrollBars = ScrollBars.Both;
            f.Controls.Add(t);
            t.Text = ex.ToString();
            f.ShowDialog();
        }
    }
    return asm;
} 
```

它生成以下异常消息：

```
System.IO.FileLoadException: Could not load file or assembly 'System.Data.SQLite, Version=1.0.82.0, Culture=neutral, PublicKeyToken=db937bc2d44ff139' or one of its dependencies. Attempt to load an unverifiable executable with fixups (IAT with more than 2 sections or a TLS section.) (Exception from HRESULT: 0x80131019)
File name: 'System.Data.SQLite, Version=1.0.82.0, Culture=neutral, PublicKeyToken=db937bc2d44ff139' ---> System.IO.FileLoadException: Attempt to load an unverifiable executable with fixups (IAT with more than 2 sections or a TLS section.) (Exception from HRESULT: 0x80131019)
   at System.Reflection.RuntimeAssembly.nLoadImage(Byte[] rawAssembly, Byte[] rawSymbolStore, Evidence evidence, StackCrawlMark& stackMark, Boolean fIntrospection, SecurityContextSource securityContextSource)
   at System.AppDomain.Load(Byte[] rawAssembly)
   at WindowsFormsApplication24.Program.CurrentDomain_AssemblyResolve(Object sender, ResolveEventArgs args) 
```

这与我以前这样做的结果相同：

```
byte[] ba = null;
Assembly asm = null;
Assembly curAsm = Assembly.GetExecutingAssembly();
string embeddedResource = "WindowsFormsApplication24.System.Data.SQLite.dll";
using (Stream stm = curAsm.GetManifestResourceStream(embeddedResource))
{
    ba = new byte[(int)stm.Length];
    stm.Read(ba, 0, (int)stm.Length);
    asm = Assembly.Load(ba);
}
return asm; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-08T07:47:56.743

您是否检查过您的目标机器是否安装了 MS Visual C++ 运行时可再发行组件？

如果没有，您可以将 Visual C++ 运行时可再发行组件动态链接到您的项目，因为 System.Data.SQLite 依赖于 Visual C++ 运行时可再发行组件。

```
.Net 2   - MS Visual C++ 2005 redistributable
.Net 3   - MS Visual C++ 2008 redistributable
.Net 4   - MS Visual C++ 2010 redistributable
.Net 4.5 - MS Visual C++ 2012 redistributable 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T05:46:05.413

您可以处理 AssemblyResolve 事件并使用 AppDomain.Load 方法：

```
AppDomain.CurrentDomain.AssemblyResolve += new ResolveEventHandler(CurrentDomain_AssemblyResolve);
Assembly CurrentDomain_AssemblyResolve(object sender, ResolveEventArgs args)
{
    AppDomain domain = (AppDomain)sender;
    if (args.Name.Contains("YourDll"))
    {
        return domain.Load(WindowsFormsApplication1.Properties.Resources.YourDll);
    }
    return null;
} 
```

# powershell - 使用 PowerShell v2 从大文本文件中获取行的子集

> ID：14351991
> 
> 赞同：9
> 
> 时间：2013-01-16T05:36:26.887
> 
> 标签：powershell, text-files

我正在处理一个大文本文件，我的意思是超过 100 MB 大，我需要遍历特定数量的行，一种子集，所以我正在尝试这个，

```
$info = Get-Content -Path $TextFile | Select-Object -Index $from,$to
foreach ($line in $info)
{
,,, 
```

但它不起作用。就像它只获取子集中的第一行一样。

我没有找到关于 Index 属性的文档，所以这是可能的还是应该考虑文件大小尝试使用不同的方法？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-16T07:52:34.690

```
PS> help select -param index

-Index <Int32[]>
    Selects objects from an array based on their index values. Enter the indexes in a comma-separated list.

    Indexes in an array begin with 0, where 0 represents the first value and (n-1) represents the last value.

    Required?                    false
    Position?                    named
    Default value                None
    Accept pipeline input?       false
    Accept wildcard characters?  false 
```

基于以上所述，'8,13' 只会得到两行。您可以做的一件事是传递一个数字数组，您可以使用范围运算符：

```
Get-Content -Path $TextFile | Select-Object -Index (8..13) | Foreach-Object {...} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-16T07:27:42.420

行是固定长度的吗？如果是这样，您可以通过简单地计算`offset*row length`和使用类似 .Net 的东西来寻找所需的位置`FileStream.Seek()`。如果不是，您所能做的就是逐行读取文件。

要提取行 m，n，请尝试类似

```
# Open text file
$reader = [IO.File]::OpenText($myFile)
$i=0
# Read lines until there are no lines left. Count the lines too
while( ($l = $reader.ReadLine()) -ne $null) {
    # If current line is within extract range, print it
    if($i -ge $m -and $i -le $n) {
        $("Row {0}: {1}" -f $i, $l)
    }
    $i++
    if($i -gt $n) { break } # Stop processing the file when row $n is reached.
}
# Close the text file reader
$reader.Close()
$reader.Dispose() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-07-18T03:28:33.997

以下对我有用。它提取两行之间的所有内容。

```
$name     = "MDSinfo"
$MDSinfo  = "$PSScriptRoot\$name.txt" #create text file
$MDSinfo  = gc $MDSinfo

$from =  ($MDSinfo | Select-String -pattern "sh feature" | Select-Object LineNumber).LineNumber
$to =  ($MDSinfo  | Select-String -pattern "sh flogi database " | Select-Object LineNumber).LineNumber

$i = 0
$array = @()
foreach ($line in $MDSinfo)
{
foreach-object { $i++ }
    if (($i -gt $from) -and ($i -lt $to))
    {
    $array += $line      
    }
}
$array 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-11T13:31:00.080

试试这个代码：

```
Select-String $FilePath -pattern "FromHere" | Out-Null

$FromHereStartingLine = Select-String $FilePath -pattern "FromHere" | Select-Object LineNumber

$UptoHereStartingLine = Select-String $FilePath -pattern "UptoHere" | Select-Object LineNumber

for($i=$FromHereStartingLine.LineNumber; $i -lt $UptoHereStartingLine.LineNumber; $i+=1)
{
    $HoldInVariable += Get-Content -Path $FilePath | Foreach-Object { ($_  -replace "`r*`n*","") } | Select-Object -Index $i
}

Write-Host "HoldInVariable : " $HoldInVariable 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-20T21:39:06.340

Get-Content cmdlet 具有 readcount 和 totalcount 参数。我会玩弄这些并尝试对其进行设置，以便将您感兴趣的行分配给一个对象，然后将该对象用于您的循环。