# StackOverflow 问答 14283000-14283999

# asp.net-mvc - ASP.NET MVC 4 IEnumerable 客户端验证

> ID：14283006
> 
> 赞同：0
> 
> 时间：2013-01-11T17:00:33.807
> 
> 标签：asp.net-mvc, jquery, asp.net-mvc-4

我有主视图和部分视图：

// // 获取：/问题/添加/

```
public ActionResult Add()
{
    return View();
}

//
// Post: /Question/GetAnswerContainers/
[HttpPost]
public ActionResult GetAnswerContainers(int count)
{
    ViewBag.AnswerCount = count;
    return PartialView();
} 
```

主视图相当简单：

```
@using (@Html.BeginForm())
{
    @Html.AntiForgeryToken()

    <fieldset>
        <legend>Add Question Form</legend>

        <div id="question_answers">
            @Html.LabelFor(m => m.AnswerCount)
            @Html.TextBoxFor(m => m.AnswerCount, 
              new {
                      @class = "answer_count", 
                      action = @Url.Action("GetAnswerContainers")
                  })<br/>
            @Html.ValidationMessageFor(m => m.AnswerCount)<br/>

            <div id="answers"></div>
        </div>

        <input type="submit" value="Add" />
    </fieldset>
} 
```

我的文本框也有 jQuery：

```
$(function () {
    $('#question_answers input[type="text"].answer_count').keyup(function () {
        var answerCount = $(this).val();
        if (isNaN(answerCount))
            return;            

        $.ajax({
            type: 'POST',
            data: { count: $(this).val() },
            url: $(this).attr("action"),
            timeout: 2000,
            async: false,
            success: function (data) {
                removeAnswers();
                addAnswers(data);

                $('form').removeData('validator');
                $('form').removeData('unobtrusiveValidation');
                $.validator.unobtrusive.parse('form');
            },
            error: null
        });
    });
});

function addAnswers(data) {
    var answersContainer = $('#question_answers #answers');    
    answersContainer.append($((data)));
} 
```

部分观点：

```
@model Quiz.Models.Question.QuestionAnswer

@Html.LabelFor(m => m.AnswerText)
@for (var i = 0; i < ViewBag.AnswerCount; i++)
{
    @Html.TextBoxFor(m => m.AnswerText) 
    @Html.ValidationMessageFor(m => m.AnswerText)       
} 
```

模型：

```
public class QuestionAnswer
{
    [Required]
    [Display(Name = "Answers")]
    public string AnswerText { get; set; } 
} 
```

所以我的问题是标准的 asp.net 客户端验证无法处理 QuestionAnswer 模型的许多对象，它从`for`循环中获取第一个文本框并将其用于验证所有部分视图。是否可以在客户端正确验证来自一个模型的多个对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:08:02.913

这里的问题在于`AnswerText`文本框的名称。它们都具有相同的名称，并且不显眼的客户端验证框架不会如何附加到哪个项目。所以它只是附加到第一个。

我建议您阅读[`following article`](http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/)Steven Sanderson 在其中说明了一个很好的小助手`Html.BeginCollectionItem`，它使用 Guids 来获取集合项的索引。这将允许客户端验证正常工作。

# git - 获取指定提交的所有父母的一般方法

> ID：14283012
> 
> 赞同：1
> 
> 时间：2013-01-11T17:00:46.257
> 
> 标签：git

是否有一种*通用的 * 方法可以以**纯*** git 方式获取所有提交的父母？

是的，合并提交的父级可以从`git show`命令中解析出来，而简单提交的父级可以用`$HASH^`类似的东西来获取。但在我看来，它既丑陋又笨拙。

所以，我想要的是：

```
$> git parents $NON_MERGE_COMMIT_HASH
HASH1

$> git parents $MERGE_COMMIT_HASH
HASH1
HASH2
... 
```

* * *

*general* * - 用于非合并提交和合并提交的单个命令。

*pure* ** - 简单的 git 命令，没有任何输出解析。即获取当前分支名称`git rev-parse --abbrev-ref HEAD`是一个纯粹的命令，`git branch`而不是。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T17:09:31.503

以下似乎可以完成这项工作： `git log -1 --pretty=tformat:%P <hash>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T17:29:30.140

```
git rev-parse "${HASH}"^@ 
```

后缀的`^@`意思是“所有修订的父母”（按顺序）。见`git help revisions`。

# python - 为什么python对此给出错误？

> ID：14283019
> 
> 赞同：-4
> 
> 时间：2013-01-11T17:01:10.673
> 
> 标签：python, python-3.x

这是[Wikibooks Python 教程](http://en.wikibooks.org/wiki/Python_Programming/Variables_and_Strings)的链接。我正在练习该页面上给出的“组合数字和字符串”。第一个代码肯定会产生错误（它写在那里），但第二个代码也会产生错误：

```
print ("Please give me a number:",) 
response = raw_input()   
number = int(response) 
Traceback (most recent call last):   File "<pyshell#2>", line 1, in <module>
number = int(response) ValueError: invalid literal for int() with base 10: '' 
```

我似乎无法找到如何解决它。我正在使用 Python 3.3.0，我知道它是 input() 而不是 raw_input()。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:14:55.707

您将一个空字符串传递给`int()`，这就是它抛出的原因`ValueError`：

```
>>> int('')

ValueError: invalid literal for int() with base 10: '' 
```

你可以使用一个`try-except`块来解决这个问题。

```
>>> try:
    response = input("enter a number: ") 
    print (int(response),"valid input")
except ValueError:    
    print ("invalid input")
   .....:     
enter a number: 123               #input
123 valid input

>>> try:
    response = input("enter a number: ") 
    print (int(response),"valid input")
except ValueError:    
    print ("invalid input")
   .....:     
enter a number: abc                        #input
invalid input 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T17:03:55.293

您正在组合一个字符串和一个整数。

```
print ("Please give me a number: ")
number = input()

plusTen = int(number) + 10
print ("If we add 10 to your number, we get " + str(plusTen)) 
```

是正确的代码。

# django - 如何在 heroku 上的 django 中使用 (django-celery,RQ) worker 执行视频文件类型转换 (ffmpeg)（我的代码在本地工作）

> ID：14283021
> 
> 赞同：1
> 
> 时间：2013-01-11T17:01:24.100
> 
> 标签：django, heroku, python-2.7, ffmpeg, django-celery

我网站的一部分包含一个允许用户上传视频的表单。我使用 ffmpeg 将视频转换为 flv。我的媒体和静态文件存储在 Amazon S3 上。我可以让一切在本地完美运行，但是我似乎无法弄清楚如何使用工作人员在生产中运行视频转换子流程。我的应用程序中安装了 dj-celery 和 rq。在我看来，我能够在本地工作的代码是：

```
#views.py
def upload_broadcast(request):
    if request.method == 'POST':
        form = VideoUploadForm(request.POST, request.FILES)
        if form.is_valid():
            new_video=form.save()
            def convert_to_flv(video):
                filename = video.video_upload
                sourcefile = "%s%s" % (settings.MEDIA_ROOT, filename)
                flvfilename = "%s.flv" % video.id
                imagefilename = "%s.png" % video.id
                thumbnailfilename = "%svideos/flv/%s" % (settings.MEDIA_ROOT, imagefilename)
                targetfile = "%svideos/flv/%s" % (settings.MEDIA_ROOT, flvfilename)
                ffmpeg = "ffmpeg -i %s -acodec mp3 -ar 22050 -f flv -s 320x240 %s" % (sourcefile, targetfile)
                grabimage = "ffmpeg -y -i %s -vframes 1 -ss 00:00:02 -an -vcodec png -f rawvideo -s 320x240 %s" % (sourcefile, thumbnailfilename)
                print ("SOURCE: %s" % sourcefile)
                print ("TARGET: %s" % targetfile)
                print ("TARGET IMAGE: %s" % thumbnailfilename)
                print ("FFMPEG TASK CODE: %s" % ffmpeg)
                print ("IMAGE TASK CODE: %s" % grabimage)
                try:
                    ffmpegresult = subprocess.call(ffmpeg)
                    print "---------------FFMPEG---------------"
                    print ffmpegresult
                except:
                    print "Not working."
                try:
                    videothumbnail = subprocess.call(grabimage)
                    print "---------------IMAGE---------------"
                    print videothumbnail
                except:
                    print "Not working."
                video.flvfilename = flvfilename
                video.videothumbnail = imagefilename
                video.save()

            convert_to_flv(new_video)

            return HttpResponseRedirect('/video_list/')
    else:
... 
```

这是我第一次尝试使用工人（或曾经将项目推向生产），所以即使有文档，我仍然不清楚我需要做什么。我尝试了几种不同的方法，但似乎没有任何效果。是否有一种简单的方法可以告诉 celery 运行 ffmpegresult = subprocess.call(ffmpeg)？提前感谢您的任何帮助或见解。

编辑-添加了heroku日志

```
2013-01-10T20:58:57+00:00 app[web.1]: TARGET: /media/videos/flv/8.flv
2013-01-10T20:58:57+00:00 app[web.1]: IMAGE TASK CODE: ffmpeg -y -i /media/videos/practice.wmv -vframes 1 -ss 00:00:02 - an -vcodec png -f rawvideo -s 320x240 /media/videos/flv/8.png
2013-01-10T20:58:57+00:00 app[web.1]: SOURCE: /media/videos/practice.wmv
2013-01-10T20:58:57+00:00 app[web.1]: FFMPEG TASK CODE: ffmpeg -i /media/videos/practice.wmv -acodec mp3 -ar 22050 -f fl v -s 320x240 /media/videos/flv/8.flv
2013-01-10T20:58:57+00:00 app[web.1]: TARGET IMAGE: /media/videos/flv/8.png
2013-01-10T20:58:57+00:00 app[web.1]: Not working.
2013-01-10T20:58:57+00:00 app[web.1]: Not working. 
```

较新的编辑

我尝试添加一个tasks.py并添加了任务：

```
celery = Celery('tasks', broker='redis://guest@localhost//')

@celery.task
def ffmpeg_task(video):
    converted_file = subprocess.call(video)
    return converted_file 
```

然后我将视图的相关部分更改为：

```
...
try:
    ffmpeg_task.delay(ffmpeg)
    print "---------------FFMPEG---------------"
    print ffmpegresult
except:
    print "Not working."
... 
```

我的新日志是：

```
2013-01-15T13:19:52+00:00 app[web.1]: TARGET IMAGE: /media/videos/flv/12.png
2013-01-15T13:19:52+00:00 app[web.1]: SOURCE: /media/videos/practice.wmv
2013-01-15T13:19:52+00:00 app[web.1]: FFMPEG TASK CODE: ffmpeg -i /media/videos/practice.wmv -acodec mp3 -ar 22050 -f fl v -s 320x240 /media/videos/flv/12.flv
2013-01-15T13:19:52+00:00 app[web.1]: IMAGE TASK CODE: ffmpeg -y -i /media/videos/practice.wmv -vframes 1 -ss 00:00:02 -an -vcodec png -f rawvideo -s 320x240 /media/videos/flv/12.png
2013-01-15T13:19:52+00:00 app[web.1]: TARGET: /media/videos/flv/12.flv
2013-01-15T13:20:17+00:00 app[web.1]: 2013-01-15 13:20:17 [2] [CRITICAL] WORKER TIMEOUT (pid:12)
2013-01-15T13:20:17+00:00 app[web.1]: 2013-01-15 13:20:17 [2] [CRITICAL] WORKER TIMEOUT (pid:12)
2013-01-15T13:20:17+00:00 app[web.1]: 2013-01-15 13:20:17 [19] [INFO] Booting worker with pid: 19 
```

我完全错过了什么吗？我会继续努力，但会非常感谢任何方向或帮助。

# scala - scala嵌套自我类型

> ID：14283023
> 
> 赞同：0
> 
> 时间：2013-01-11T17:01:27.860
> 
> 标签：scala, self-type

为什么这不起作用：

```
scala> trait A
defined trait A

scala> class Z {
     | this: A =>
     | }
defined class Z

scala> class Y {
     | this: A =>
     | val z = new Z()
     | }
<console>:11: error: class Z cannot be instantiated because it does not conform to its self-type Z with A
       val z = new Z() 
```

我希望混入 Y 中的 A 再次混入 Y 中 Z 的实例中。我该怎么做？

编辑（在上面的例子中试图过于简短。这是我的实际问题）：

```
scala> import scala.slick.driver.ExtendedProfile
import scala.slick.driver.ExtendedProfile

scala> class Z {
     | this: ExtendedProfile =>
     | }
defined class Z

scala> class Y {
     | this: ExtendedProfile =>
     | val z = new Z() with ExtendedProfile
     | }
<console>:21: error: illegal inheritance;
 self-type Z with scala.slick.driver.ExtendedProfile does not conform to scala.slick.driver.ExtendedProfile's selftype scala.slick.driver.ExtendedDriver
       val z = new Z() with ExtendedProfile
                        ^ 
```

我想我理解为什么不能编译，但这不应该是隐式的（不是实际的 scala 关键字'隐式'，只是一般隐式;））？如果一个 ExtendedProfile 总是必须有一个 ExtendedDriver，为什么 new Z() 抱怨它需要一个 ExtendedDriver？

仅供参考：[http ://slick.typesafe.com/doc/1.0.0-RC1/api/#scala.slick.driver.ExtendedProfile](http://slick.typesafe.com/doc/1.0.0-RC1/api/#scala.slick.driver.ExtendedProfile)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:20:03.890

编译错误表明您需要提供一个`A`混合来实例化一个`Z`对象。正如 om-non-nom 建议的那样，您的代码只需稍作改动即可编译，

```
trait A

class Z { this: A =>
}

class Y { this: A =>
  val z = new Z with A
} 
```

这是使用继承而不是自我类型的替代方案，并且可能更接近您的意图：

```
trait Y extends A {
  val z = new Z with Y
} 
```

**编辑**

为了回答您更新的问题，自我类型是对类型构造的*约束。*自类型与继承的不同之处在于它们*不扩展*类型的外部接口。

从您链接的 Scaladoc 来看，情况如下：

```
trait ExtendedDriver extends ExtendedProfile
trait ExtendedProfile { self: ExtendedDriver => }

class Z { this: ExtendedProfile => }

class Y {
  this: ExtendedProfile =>
  val z = new Z() with ExtendedProfile
} 
```

问题是它`ExtendedProfile`不继承自`ExtendedDriver`，所以它不能独立；它需要提供一个明确的`ExtendedDriver`. 你可以这样做

```
new Z() with ExtendedProfile with ExtendedDriver 
```

这实际上是多余的，因为`ExtendedProfile`已经混合了。你只需要，

```
new Z() with ExtendedDriver 
```

# python - python 3：使用预读从标准输入管道读取字节

> ID：14283025
> 
> 赞同：12
> 
> 时间：2013-01-11T17:01:31.120
> 
> 标签：python, python-3.x

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-12T11:26:57.177

The exception doesn't come from Python, but from the operating system, which doesn't allow seeking on pipes. (If you redirect output from a regular pipe, it can be seeked, even though it's standard input.) This is why you get the error in one case and not in the other, even though the classes are the same.

The classic Python 2 solution for readahead would be to wrap the stream in your own stream implementation that implements readahead:

```
class Peeker(object):
    def __init__(self, fileobj):
        self.fileobj = fileobj
        self.buf = cStringIO.StringIO()

    def _append_to_buf(self, contents):
        oldpos = self.buf.tell()
        self.buf.seek(0, os.SEEK_END)
        self.buf.write(contents)
        self.buf.seek(oldpos)

    def peek(self, size):
        contents = self.fileobj.read(size)
        self._append_to_buf(contents)
        return contents

    def read(self, size=None):
        if size is None:
            return self.buf.read() + self.fileobj.read()
        contents = self.buf.read(size)
        if len(contents) < size:
            contents += self.fileobj.read(size - len(contents))
        return contents

    def readline(self):
        line = self.buf.readline()
        if not line.endswith('\n'):
            line += self.fileobj.readline()
        return line

sys.stdin = Peeker(sys.stdin) 
```

In Python 3 supporting the full `sys.stdin` while peeking the undecoded stream is complicated—one would wrap `stdin.buffer` as shown above, then instantiate a new `TextIOWrapper` over your peekable stream, and install that `TextIOWrapper` as `sys.stdin`.

However, since you only need to peek at `sys.stdin.buffer`, the above code will work just fine, after changing `cStringIO.StringIO` to `io.BytesIO` and `'\n'` to `b'\n'`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-04-27T10:41:25.033

user4815162342's solution, while extremely useful, appears to have an issue in that it differs from the current behaviour of the io.BufferedReader peek method.

The builtin method will return the same data (starting from the current read position) for sequential peek() calls.

user4815162342's solution will return sequential chunks of data for each sequential peek call. This implies the user must wrap peek again to concatenate the output if they wish to use the same data more than once.

Here is the fix to return builtin behaviour:

```
def _buffered(self):
    oldpos = self.buf.tell()
    data = self.buf.read()
    self.buf.seek(oldpos)
    return data

def peek(self, size):
    buf = self._buffered()[:size]
    if len(buf) < size:
        contents = self.fileobj.read(size - len(buf))
        self._append_to_buf(contents)
        return self._buffered()
    return buf 
```

[See the full version here](https://github.com/racitup/magicrescue-vmdk/blob/master/vmdk.py)

There are other optimisations that could be applied, e.g. removal of previously buffered data upon a read call that exhausts the buffer. The current implementation leaves any peeked data in the buffer, but that data is inaccessible.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-21T18:40:08.910

**Try this:**

```
import sys

ssb = sys.stdin.buffer.read(1)
if ssb == b'h':
    print(ssb+sys.stdin.buffer.read()) 
```

**Echo a string:**

```
a@fuhq:~$ echo 'hi' | python3 buf_test.py 
b'hi\n' 
```

**Redirect a file:**

```
a@fuhq:~$ cat hi.text
hi
a@fuhq:~$ python3 buf_test.py   <  hi.text
b'hi\n' 
```

# java - 线程似乎工作正常，但不应该

> ID：14283026
> 
> 赞同：1
> 
> 时间：2013-01-11T17:01:32.280
> 
> 标签：java, multithreading, concurrency

我有一个程序，其任务是证明我的类不是线程安全的，但我得到了很好的结果，但不明白为什么......

该应用程序基本上是将所有工人的工资增加一倍，并使用 100 个线程执行 1000 次，因此结果应该增加 100.000，就可以了：/

**测试类：**

```
final int THREADGROUPSIZE = 100;
        Thread threads[] = new Thread[THREADGROUPSIZE];

        for (int i=0; i <THREADGROUPSIZE; ++i) {
            threads[i] = new Thread(new CompManagerThread());
            threads[i].run();
        }

        for (int i=0; i <THREADGROUPSIZE; ++i) {
            try {
                threads[i].join();
            }
            catch (InterruptedException e) {
                System.out.print("Join interrupted\n");
            }
        }

        System.out.print("Waiting for threads to complete\n");
        System.out.println("-------PRINTING THREADED WORKERS----------");
        Company threadCompany = Company.getInstance();
        ArrayList<Worker> workerThreadArray = threadCompany.GetWorkersOrderedInSalary();
        for (Worker worker : workerThreadArray) {
            System.out.println(worker);
        }

        System.out.println("-------PRINTING ORIGIN WORKERS----------");
        ArrayList<Worker> workerArray = companyFromHSQL.GetWorkersOrderedInSalary();
        for (Worker worker : workerArray) {
            System.out.println(worker);
        } 
```

**线程类：**

```
public class CompManagerThread implements  Runnable {

        Company threadCompany;

        CompManagerThread(){
            threadCompany = Company.getInstance();
        }

        @Override
        public void run() {
            for (int i = 0; i < 1000; i++) {
                increaseSalary(1);
                increaseBudget(1);
            }

    //        for (int i = 0; i < 1000; i++) {
    //           decreaseSalary(1);
    //           decreaseBudget(1);
    //        }
        }

        /**
         * Increase the Salary by one.
         *
         * @param number we increasing the salaries
         */
        public void increaseSalary(Number number) {
            for (Map.Entry<String, Worker> workerEntry : threadCompany.getAllWorkers().entrySet()) {
                workerEntry.getValue().setSalary(workerEntry.getValue().getSalary().intValue() + number.intValue());
            }
        }

        /**
         * Increase the Budget by one.
         *
         * @param number we increasing the budgets
         */
        public void increaseBudget(Number number) {
            for (Map.Entry<String, Project> projectEntry : threadCompany.getProjects().entrySet()) {
                projectEntry.getValue().setBudget(projectEntry.getValue().getBudget().intValue() + number.intValue());
            }
        }

        /**
         * Decrease the Salary by one.
         *
         * @param number we decreasing the salaries
         */
        public void decreaseSalary(Number number) {
            for (Map.Entry<String, Worker> workerEntry : threadCompany.getAllWorkers().entrySet()) {
                workerEntry.getValue().setSalary(workerEntry.getValue().getSalary().intValue() - number.intValue());
            }
        }

        /**
         * Decrease the Budget by one.
         *
         * @param number we decreasing the budgets
         */
        public void decreaseBudget(Number number) {
            for (Map.Entry<String, Project> projectEntry : threadCompany.getProjects().entrySet()) {
                projectEntry.getValue().setBudget(projectEntry.getValue().getBudget().intValue() - number.intValue());
            }
        }
    } 
```

****结果：* ***

```
-------PRINTING THREADED WORKERS----------
Fejlesztő János is a WorkerDeveloper and has 310000HuF salary.
Fejlesztő Csaba is a WorkerDeveloper and has 350000HuF salary.
Fejlesztő Béla is a WorkerDeveloper and has 400000HuF salary.
Konzulens Béla is a WorkerConsultant and has 400000HuF salary.
Konzulens Csaba is a WorkerConsultant and has 410000HuF salary.
ProjectVezető Béla is a LeaderProject and has 500000HuF salary.
VezetőFejlesztő Béla is a LeaderDeveloper and has 500000HuF salary.
VezetőFejlesztő Csaba is a LeaderDeveloper and has 500000HuF salary.
ProjectVezető János is a LeaderProject and has 500000HuF salary.
ProjectVezető Csaba is a LeaderProject and has 500000HuF salary.
VezetőFejlesztő János is a LeaderDeveloper and has 500000HuF salary.
VezetőKonzulens Béla is a LeaderConsultant and has 600000HuF salary.
VezetőKonzulens János is a LeaderConsultant and has 610000HuF salary.
VezetőKonzulens Csaba is a LeaderConsultant and has 620000HuF salary.
-------PRINTING ORIGIN WORKERS----------
Fejlesztő János is a WorkerDeveloper and has 210000.0HuF salary.
Fejlesztő Csaba is a WorkerDeveloper and has 250000.0HuF salary.
Fejlesztő Béla is a WorkerDeveloper and has 300000.0HuF salary.
Konzulens Béla is a WorkerConsultant and has 300000.0HuF salary.
Konzulens Csaba is a WorkerConsultant and has 310000.0HuF salary.
ProjectVezető Béla is a LeaderProject and has 400000.0HuF salary.
VezetőFejlesztő Béla is a LeaderDeveloper and has 400000.0HuF salary.
VezetőFejlesztő Csaba is a LeaderDeveloper and has 400000.0HuF salary.
ProjectVezető János is a LeaderProject and has 400000.0HuF salary.
ProjectVezető Csaba is a LeaderProject and has 400000.0HuF salary.
VezetőFejlesztő János is a LeaderDeveloper and has 400000.0HuF salary.
VezetőKonzulens Béla is a LeaderConsultant and has 500000.0HuF salary.
VezetőKonzulens János is a LeaderConsultant and has 510000.0HuF salary.
VezetőKonzulens Csaba is a LeaderConsultant and has 520000.0HuF salary. 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-11T17:03:12.387

您没有同时运行这些线程。

```
 threads[i].run(); 
```

应该读

```
 threads[i].start(); 
```

`Thread.start()`实际上*产生*了那个线程。`Thread.run()`只会调用`Runnable`'`run()`方法。从文档：

> 如果该线程是使用单独的 Runnable 运行对象构造的，则调用该 Runnable 对象的 run 方法；否则，此方法不执行任何操作并返回。

不太清楚为什么存在这种方法。这是一个常见的混淆来源。

# javascript - 无效的标记重复属性

> ID：14283040
> 
> 赞同：0
> 
> 时间：2013-01-11T17:02:05.717
> 
> 标签：javascript, html

我在 Dreamweaver CS6 中收到以下错误：“无效标记，重复属性”。我有一个 onClick 运行函数并交换图像的图像。它两者都做，但 Dreamweaver 却在发牢骚。这是否必须以另一种方式编写？

```
<input type="image" onClick="javascript:displayPlace()" onMouseOver="MM_swapImage ('Search','','SearchByPlace.jpg',1)" onMouseOut="MM_swapImgRestore()" src="Glass- Place.jpg"src="Glass-Place.jpg" alt="Place" align="middle" width="160" height="151"> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T17:02:42.710

你有`src="Glass- Place.jpg"src="Glass-Place.jpg"`，所以`src`在那里两次。

此外，这些值是不同的（第一个中的额外空间）。

# sql - SQL查询具有不同时间戳的相同ID的多个实例

> ID：14283043
> 
> 赞同：1
> 
> 时间：2013-01-11T17:02:09.793
> 
> 标签：sql, sql-server-2008

我有一张代表测试用例执行的表，对于一个特定的测试用例，可能有许多具有不同状态的执行。

```
id  |  testcase_id  |  status   |  timestamp
-------------------------------------------------------
1   |  2            |  fail     |  2013-01-11 15:00:00
-------------------------------------------------------
2   |  2            |  pass     |  2013-01-11 15:05:00
-------------------------------------------------------
3   |  4            |  fail     |  2013-01-11 16:00:00
-------------------------------------------------------
4   |  4            |  pass     |  2013-01-11 16:04:00 
```

而我想从这张表中提取的是最新的执行结果，即：

```
id  |  testcase_id  |  status   |  timestamp
-------------------------------------------------------
2   |  2            |  pass     |  2013-01-11 15:05:00
-------------------------------------------------------
4   |  4            |  pass     |  2013-01-11 16:04:00 
```

我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:03:57.433

```
SELECT id,testcase_id,status,timestamp
FROM 
    (
        SELECT id,testcase_id,status,timestamp,
                ROW_NUMBER() OVER (PARTITION BY testcase_id
                                    ORDER BY timestamp DESC) rn
        FROM tableName
    ) s
WHERE Rn = 1 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!3/1c810/1)

或者

```
WITH latestRecord
AS
(
  SELECT id,testcase_id,status,timestamp,
  ROW_NUMBER() OVER (PARTITION BY testcase_id ORDER BY timestamp DESC) rn
  FROM tableName
) 
SELECT id,testcase_id,status,timestamp
FROM latestRecord
WHERE Rn = 1 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!3/1c810/4)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T17:06:29.593

```
select tc.*
from testcases tc
inner join (
     select testcase_id,
     max(timestamp) maxTimestamp
     from testcases
     group by testcase_id
     ) tcMaxes
on tc.testcase_id = tcMaxes.testcase_id 
and tc.timestamp = tcMaxes.maxTimestamp 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T17:24:54.743

试试这个

```
select top 2* from TableName where status='pass' order by timestamp asc 
```

输出：[http ://sqlfiddle.com/#!3/1c810/38/0](http://sqlfiddle.com/#!3/1c810/38/0)

# ruby - 在 SU Ruby 中调整纹理图像的大小

> ID：14283044
> 
> 赞同：0
> 
> 时间：2013-01-11T17:02:18.260
> 
> 标签：ruby, sketchup

在 Sketchup Ruby 中导出 COLLADA 后，我需要调整纹理图像文件的大小。

有没有办法使用普通的 Sketchup Ruby API 从磁盘读取图像（PNG、JPG），调整它们的大小并将它们保存回磁盘？

我知道如何读取/写入文件，只是不知道“图像解码、调整大小、编码”部分。

我发现的大多数图像调整大小示例都涉及一些在 Sketchup ruby​​ 发行版中不可用的图像处理库或 gem。如果有一个易于使用我的 SU Ruby 插件分发的便携式解决方案，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T16:39:00.383

SketchUp Ruby API 不包含直接操作图像的方法。

您可以在使用纹理的模型中创建材质，而不仅仅是加载图像资源。

您可能可以使用一种方法：`Material.write_thumbnail`(SU8M1+)，根据您的描述，您可以迭代模型中的材料并导出缩略图。

但是，该方法有一个非常烦人的限制：

> `Material.write_thumbnail`具有在某些情况下限制其可用性的行为。
> 
> **如果您指定的尺寸等于或大于原件的宽度或高度，则该方法将失败。换句话说，分辨率参数必须比原始纹理的长度或宽度的最小单位小 1px。**
> 
> 这会产生宽高比大的纹理问题。如果您想生成最大 128x128px 的缩略图，并且您为其生成缩略图的材质具有 64x512px 的纹理，那么它会失败。对于给定的纹理，缩略图的最大尺寸为 63 像素（比最小尺寸小 1 像素。）——导致缩略图为 8×63。
> 
> 出于这个原因，该方法应该具有理想的缩略图宽度和高度，以便真正可用。唉。希望这将在以后的版本中得到改进。

（有关 SketchUp 中材料的更多信息：[http](http://www.thomthom.net/thoughts/2012/03/the-secrets-of-sketchups-materials/#material-thumbnails) ://www.thomthom.net/thoughts/2012/03/the-secrets-of-sketchups-materials/#material-thumbnails ）

要在开发 SketchUp 插件时真正控制图像，您确实需要使用第三方库。

你可以看看 Aerilius 在这方面做了很多工作的插件“Texture Resizer”。[http://sketchucation.com/forums/viewtopic.php?f=323&t=40720#p360679](http://sketchucation.com/forums/viewtopic.php?f=323&t=40720#p360679)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-11T18:56:42.400

看来，如果您在这里查看[http://www.sketchup.com/intl/en/developer/docs/ourdoc/image](http://www.sketchup.com/intl/en/developer/docs/ourdoc/image)`height=`，这些方法`width=`应该可以满足您的需求。

# mysql - MySQL - 选择日期范围内的行数

> ID：14283052
> 
> 赞同：0
> 
> 时间：2013-01-11T17:02:49.910
> 
> 标签：mysql

我正在尝试选择特定日期范围之间存在的行序列并计算具有该日期的行数。但是，可能有一个日期没有条目，因此在表中不存在。

该表包含具有以下数据的行：

```
2012-12-25
2012-12-25
2012-12-27
2012-12-27
2012-12-27
2012-12-28 
```

根据这个问题，我创建了一个数字表来生成日期范围 [MySQL 如何填充范围内缺失的日期？](https://stackoverflow.com/questions/3538858/mysql-how-to-fill-missing-dates-in-range)

我当前的查询在附近失败`('SELECT * FROM wp_paypal_logs WHERE STR_TO_DATE(wp_paypal_logs.created, '%Y-%m-%d')`

```
SELECT x.ts AS timestamp,
          COALESCE(COUNT(SELECT * FROM wp_paypal_logs WHERE STR_TO_DATE(wp_paypal_logs.created, '%Y-%m-%d' ) = x.ts), 0) AS cnt
     FROM (SELECT DATE_FORMAT(DATE_ADD('2012-12-25', INTERVAL n.id - 1 DAY), '%Y-%m-%d') AS ts
             FROM numbers n
            WHERE DATE_ADD('2012-12-25', INTERVAL n.id - 1 DAY) <= '2012-12-31') x
LEFT JOIN TABLE wp_paypal_logs ON STR_TO_DATE(wp_paypal_logs.created, '%Y-%m-%d') = x.ts 
```

如何让我的结果集看起来像这样？

```
2012-12-25      2
2012-12-26      0
2012-12-27      3
2012-12-28      1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:13:03.977

不确定是否需要该`COALESCE`部分，因为您正在`LEFT JOIN`学习，如果您指望左连接表中的一个字段可能会起作用（因为它不会计算 NULL）：

```
SELECT 
   x.ts AS timestamp,
   COUNT(wp_paypal_logs.created) AS cnt
FROM (
    SELECT 
       DATE_FORMAT(DATE_ADD('2012-12-25', INTERVAL n.id - 1 DAY), '%Y-%m-%d') AS ts
    FROM numbers n
    WHERE DATE_ADD('2012-12-25', INTERVAL n.id - 1 DAY) <= '2012-12-31'
) x
LEFT JOIN wp_paypal_logs 
   ON STR_TO_DATE(wp_paypal_logs.created, '%Y-%m-%d') = x.ts
GROUP BY x.ts 
```

# php - 尝试使用 Codeigniter/MVC 实现登录...期待 TRUE，接收 FALSE。为什么？

> ID：14283062
> 
> 赞同：0
> 
> 时间：2013-01-11T17:03:20.170
> 
> 标签：php, javascript, facebook, codeigniter

我正在尝试实现 Facebook 登录程序，但它不起作用。我有一个 POST 到 AJAX，它似乎错误地解释了返回的 TRUE。尽管我已经将日志放在整个过程中以跟踪逻辑流......它似乎并没有像我预期的那样流动。你能看出问题吗？

这是我发布到 AJAX 的 .js

```
function initUserFbConnect(response){
    console.log("initUserFacebookConnect");
    // checking if the user is in the DB or first visit
    $.post('../ajax/checkFbMember', { facebookId: response.id },
        function(data){
            if(data){
                console.log("trying to set login time");
                $.post('../ajax/setLoginTime', { facebookId:response.id },
                    function(data2){
                        if(data2 == true){
                            console.log("Login time logged");
                        }else{
                            console.log("problem logging time");
                        }
                    }
                );
            }else{
                console.log("returned false from AJAX post");
                console.log(data);
                console.log("you are NOT a FB member");
            }
        }
    );
} 
```

这里是 ../ajax/checkFbMember

```
public function checkFbMember()
{
    $facebookId = $this->input->post('facebookId');
    ChromePhp::log("checking checkFBmember " . $facebookId  );
    $this->load->model('Member_model');
    if( $this->Member_model->mCheckFbMember( $facebookId )){
        ChromePhp::log('FB id found in system');
        return TRUE;
    }else{
        ChromePhp::log('FB id NOT found in system');
        return FALSE;
    }
} 
```

这是我的 Member_model

```
public function mCheckFbMember( $facebookId )
{
    ChromePhp::log('Inside model and checking');
    $_query = $this->db->query( "SELECT users.id FROM users WHERE users.facebookID=$facebookId" );
    if ( $_query->num_rows() > 0 ){ // user is found
        ChromePhp::log('Inside model and FOUND member');
        return TRUE;
    }else{ // means first visit
        ChromePhp::log('Inside model FAIL');
        return FALSE;  
    }
} 
```

但这就是我正在记录的内容..顺序很奇怪

```
initUserFacebookConnect
returned false from AJAX post  // << this seems to come too early!
// console.log(data) doesn't log anything .. why?
you are NOT a FB member
checking checkFBmember 657322189
Inside model and checking 
Inside model and FOUND member
FB id found in system 
```

所以我要发布到 ajax .. 我正在点击我的模型并将 TRUE 返回到我的控制器，控制器将 TRUE 返回到 initUserFbConnect .. 但不知何故那个 POST 方法接收 FALSE？不仅如此..它会直接跳过并在我的任何其他方法触发 *之前*向我显示“返回错误” ？

我很困惑为什么我要返回 FALSE，因为我在数据库中找到了该成员。但我也对我的日志记录触发的顺序感到困惑。我希望 initUserFbConnect 中的 IF 语句在其他所有内容返回*后解决。*但它似乎在跳枪。它必须首先通过 PHP 和 DB 检查才能*知道*它已收到 TRUE/FALSE，对吗？

谁能解释发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:15:23.087

看起来响应中没有返回任何内容。

仅从您发布的代码中，您将返回`TRUE`或`FALSE`从函数中返回，但 JavaScript 只会读取`echo`已从页面中删除的文本。

最简单的解决方案是`echo` `"TRUE"`或`"FALSE"`基于返回值`checkFbMember()`，然后将您的 ajax 解析更改为：

```
if (data2 == "TRUE") {
    ...
} 
```

# java - 使用 Maven 属性连接到数据库

> ID：14283066
> 
> 赞同：3
> 
> 时间：2013-01-11T17:03:43.483
> 
> 标签：java, maven

我有一个针对数据库运行一些测试的 Maven 项目。我可以运行这些测试，`mvn clean verify`但我想指定一些数据库属性，例如。数据库名称，端口名称等...在我的 pom.xml 文件中，我可以在 Java 中使用它来创建数据库连接。

我已将此添加到我的 POM 中，

```
 <properties>
    <server>localhost</server>
    <database>mydatabase</database>
    <port>1433</port>
  </properties> 
```

我可以从我的 Java 代码中访问这些属性，还是需要创建一个 Maven 插件并将这些属性作为参数传递给我的插件并`clean verify`从我的自定义插件中调用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T17:39:00.050

启用资源过滤（例如，用于测试资源）：

```
<build>
  <testResources>
    <testResource>
      <directory>src/test/resources</directory>
      <filtering>true</filtering>
    </testResource>
  </testResources>
</build> 
```

在下面创建一个 db.properties `src/test/resources`：

```
server=${server}
port=${port} 
```

在您的测试中，请阅读`db.properties`：

```
InputStream inputStream = getClass().getResourceAsStream("/db.properties")
Properties props = new Properties();
props.load(inputStream); 
```

[Maven: The Complete Reference](http://www.sonatype.com/books/mvnref-book/reference/resource-filtering-sect-description.html)概述了它的工作原理：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T17:11:04.467

当您运行测试时，您可以在运行测试的命令行上使用与 -D 等效的 Surefire 插件将 Maven 属性传递到 java 应用程序。\

这显示了如何做到这一点：

[http://maven.apache.org/surefire/maven-surefire-plugin/examples/system-properties.html](http://maven.apache.org/surefire/maven-surefire-plugin/examples/system-properties.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T17:17:33.423

不，您不能从您的项目中使用这些属性（Maven 属性）`System.getProperty()`。

因为 maven 在构建时工作，而您的代码在运行时工作。但是您可以让 maven 在构建过程中设置一些属性（例如属性文件），然后您的类可以获得这些值。

通常系统属性是在 jvm 启动时设置的。如果您的项目正在运行的虚拟机是从 maven 启动的，例如通过某些插件，`mvn jetty:run`那么您就有机会获得在 maven 中定义的属性。但是，如果您的项目在与 maven 无关的 VM 上运行，则您无法获取这些属性。

# wpf - 具有系统自定义短日期格式的 WPF 数据网格日期列

> ID：14283068
> 
> 赞同：2
> 
> 时间：2013-01-11T17:03:44.843
> 
> 标签：wpf, datetime, wpfdatagrid

这与使用 WPF 数据网格的自定义日期格式线程略有不同。

我的 Win7 盒子有一个自定义短日期字符串，在控制面板中定义为 dd-MM-yy。我希望 DataGrid 中的日期列使用该设置进行显示。视图模型有一个称为“日期”的日期时间。

我试过这个：

```
 <DataGrid AutoGenerateColumns="False" Name="dataCondition" ItemsSource="{Binding}">
    <DataGrid.Columns>
      <DataGridTextColumn Binding="{Binding Name}" ></DataGridTextColumn>
      <DataGridTextColumn Binding="{Binding Date, StringFormat=d}" />
      <DataGridTextColumn Binding="{Binding Comment}"></DataGridTextColumn>
    </DataGrid.Columns>
  </DataGrid> 
```

日期列显示为 m/d/yyyy。DataGrid 不使用系统短日期设置，不管它是否是自定义的？

WPF DatePickers 的工作方式似乎有所不同。即使没有 StringFormat（并且直接绑定到视图模型中的 DateTime），也会使用自定义短日期格式。

我可以通过在 getter 使用 DateTime.ToShortDateString 的视图模型（Date -> DateFormatted）中创建一个字符串属性来解决 DataGrid 中的这个问题，但我不确定这是最好的方法。而且我还没有制定出绑定的 TwoWay 部分......：P

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-11T17:58:54.170

尝试将其设置/绑定为您的`Converter`：

```
[ValueConversion(typeof(DateTime), typeof(String))]
public class DateConverter : IValueConverter
{
    private const string _format = "dd-MM-yy";

    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        DateTime date = (DateTime)value;

        return date.ToString(_format);
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        return DateTime.ParseExact((string) value, _format, culture);
    }

} 
```

然后像这样设置您的 XAML：

```
<Window.Resources>
    <wpfDataGridMisc:DateConverter x:Key="dateConverter"/>
</Window.Resources>

<DataGridTextColumn Binding="{Binding Date, Converter={StaticResource dateConverter}}"/> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-12T08:09:26.473

我认为解决方案相当简单。`StringFormat`您使用的是无效的，因此它会被忽略并采用`DataGridTextColumn`默认格式。如果您改为指定`dd`as `StringFormat`，它将按预期工作。

因此您的最终绑定将如下所示（包括 TwoWay）：

```
<DataGridTextColumn Binding="{Binding Date, StringFormat=dd, Mode=TwoWay}" /> 
```

但是，请注意，这在编辑模式下会令人困惑，因为即使列显示的只是一个数字（日期），它实际上会希望您在接受该输入并重新格式化之前输入一个有效的日期要求它。您可以通过使用 a `DataGridTemplateColumn`instead 并在其中指定`CellTemplate`and来解决此`CellEditingTemplate`问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-01T04:10:43.123

这允许您配置日期时间格式。

VB代码

```
Imports System.Windows.Data

Public Class DateTimeToString
    Implements IValueConverter

    Private _Format As String
    Public Property Format() As String
        Get
            Return _Format
        End Get
        Set(ByVal value As String)
        End Set
    End Property

    Public Function Convert(ByVal value As Object, _
                            ByVal targetType As System.Type, _
                            ByVal parameter As Object, _
                            ByVal culture As System.Globalization.CultureInfo) As Object _
                            Implements System.Windows.Data.IValueConverter.Convert
        Dim DateTimeValue As DateTime
        If DateTime.TryParse(value, DateTimeValue) Then
            Return DateTimeValue.ToString(_Format)
        End If
        Return value
    End Function

    Public Function ConvertBack(ByVal value As Object, _
                                ByVal targetType As System.Type, _
                                ByVal parameter As Object, _
                                ByVal culture As System.Globalization.CultureInfo) As Object _
                                Implements System.Windows.Data.IValueConverter.ConvertBack
        Dim StringValue As String = value.ToString
        Dim DateTimeValue As DateTime
        If DateTime.TryParse(StringValue, DateTimeValue) Then
            Return DateTimeValue
        End If
        Return value
    End Function
End Class 
```

C# 代码

```
public class DateTimeToString : IValueConverter
{
    public string Format { get; set; }

    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        DateTime DateTimeValue = (DateTime)value;
        return DateTimeValue.ToString(Format);
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        string strValue = value.ToString();
        DateTime DateTimeValue;
        if (DateTime.TryParse(strValue, out DateTimeValue))
            return DateTimeValue;
        return value;
    }
} 
```

XAML 代码

```
<TextBlock Text="{Binding BirthDate, Converter={StaticResource DateToString}}" /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-21T15:02:23.117

您必须将`UICulture`应用程序启动的时间设置为应有的状态。然后它将使用计算机中的正确格式。XAML 资源始终默认为`en-US`您所见。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-11T17:20:50.937

创建一个转换器并在 datetime 列的绑定中使用它。继承 IValueConverter 的类。接收一个日期时间并返回一个字符串。

# javascript - javascript 连接到另一个浏览器实例

> ID：14283069
> 
> 赞同：0
> 
> 时间：2013-01-11T17:03:46.793
> 
> 标签：javascript, internet-explorer-6, hta

我正在制作一个 hta 应用程序，它从它自己的窗口的文本框（由用户输入）读取数据，并在另一个 Web 浏览器窗口（基于会话，并且已经打开）中更新这些数据，我如何使用 javascript 与其他浏览器窗口连接。

系统：基于客户端的机器，IE v6

带着敬意

# flash-builder - 使用 xml 中的属性进行过滤

> ID：14283076
> 
> 赞同：0
> 
> 时间：2013-01-11T17:04:12.110
> 
> 标签：flash-builder

我的 xml 名称是 flashbuilder 4.5 中的 dp

```
<?xml version="1.0" encoding="utf-8"?>
<POWER_OK>
    <yes id="1" name="POWER SEATED">
        <yes id="11" name="IS 110 VOLT"></yes>
        <no id="12" name="CHANGE IT"></no>
    </yes>
    <no id="2" name="DATA IN SCREEN">
        <yes id="21" name="RETRY BOOT"></yes>
        <no id="22" name="VIDEO FALURE"></no>
    </no> 
```

我正在尝试使用 dp.yes.(@id = "11") 过滤此数据不起作用请帮助我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T03:47:30.427

试试这个：

```
dp.yes.(@id == "11"); 
```

（注意双等号）

# entity-framework - 如何强制实体框架将特定迁移标记为已应用？

> ID：14283082
> 
> 赞同：19
> 
> 时间：2013-01-11T17:04:29.370
> 
> 标签：entity-framework, entity-framework-migrations

我在项目中使用 Entity Framework 5，并且启用了迁移。

这是场景：

新的开发人员 (dev1) 出现并从源代码构建项目。由于以前的开发人员过去一直在从事该项目，因此存在现有的迁移。

当该开发人员第一次运行 ASP.NET MVC 项目时，数据库会自动构建，并且不会出现任何错误。

然而，在那之后，另一个开发人员 (dev2) 添加了一个新的迁移。当 Dev1 尝试运行`Update-Database`时，***之前***的所有迁移都会尝试运行。但是它们已经被应用了，因为它们是Dev1 看到的***初始模型的一部分。***这通常会导致架构错误，因为它试图应用已经存在的架构更改。

因此，最好将本地数据库“快进”到当前迁移。但我不知道有什么方法可以做到这一点。或者，是否有其他方法来初始化数据库，以便我可以在初始化期间应用所有迁移？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-01-11T20:58:02.160

我想出了一个技巧。

跑`Update-Database -Script`

挑选出所有已经运行的迁移

```
INSERT INTO [__MigrationHistory] ([MigrationId], [Model], [ProductVersion]) VALUES 
```

打开 Sql Server Management Studio，并手动运行这些 sql 语句。

新的迁移应该可以正常工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-11T21:04:56.267

团队环境中的实体框架迁移可能很棘手。尤其是与源代码控制结合使用时。听起来您遇到了针对不同开发数据库运行不同代码优先迁移的问题。

针对特定数据库运行的所有迁移都存储在 __MigrationHistory 表中。如果您的项目中有一个迁移文件并且 EF 在 __MigrationHistory 表中没有看到它，它将在您运行 Update-Database 时尝试执行它。如果您通过将记录插入 MigrationHistory 来欺骗 EF 认为它已经应用了这些迁移文件，它将首先破坏 EF 代码的最佳功能之一。您将无法使用 update-database -TargetMigration 对迁移进行角色化。

如果每个开发人员都有自己的一组迁移，并且他们可能有重叠的更改，这可能会在您运行 update-database 时导致各种 sql 错误。

我对此的解决方案是忽略所有与主动开发有关的迁移文件（因为它们往往会被大量修改）。当开发人员获得新的更改集时，他们只需创建自己的本地迁移。

一旦我准备好将一项新功能发布到生产环境中，我会将所有这些更改整合到一个大迁移中，并且我通常以我将应用程序递增到的版本号来命名它。我将这些迁移文件检查到源代码管理中。这些充当我的主迁移文件，以使任何新数据库与生产保持同步。

当我创建一个新的这些主迁移时，所有开发人员都将他们的本地更改恢复到上一个​​主要版本，删除他们不再需要的那些（因为它们已包含在主迁移中），然后运行 ​​update-database。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-14T17:56:14.380

我采用了 Doug 的技术并创建了一个自动化它的 DatabaseInitializer。

只需使用

```
 Database.SetInitializer(new CreateDbWithMigrationHistoryIfNotExists<EntityContext, Configuration>()); 
```

在您的 DbContext 中，如果不存在，它将创建一个新数据库，并更新迁移历史记录表以包含所有现有迁移。

这是课程：

```
using System;
using System.Collections.Generic;
using System.Data;
using System.Data.Common;
using System.Data.Entity;
using System.Data.Entity.Migrations;
using System.Data.Entity.Migrations.Infrastructure;
using System.Data.Entity.Migrations.Model;
using System.IO;
using System.IO.Compression;
using System.Linq;
using System.Reflection;
using System.Text.RegularExpressions;
using System.Xml.Linq;

namespace EfStuff
{
    public class CreateDbWithMigrationHistoryIfNotExists<TContext, TMigrationsConfiguration> :
        IDatabaseInitializer<TContext>
        where TContext : DbContext
        where TMigrationsConfiguration : DbMigrationsConfiguration<TContext>
    {
        private readonly Regex _pattern = new Regex("ProviderManifestToken=\"([^\"]*)\"");
        private readonly TMigrationsConfiguration _config;

        public CreateDbWithMigrationHistoryIfNotExists()
        {
            _config = Activator.CreateInstance<TMigrationsConfiguration>();
        }

        public void InitializeDatabase(TContext context)
        {
            if (context.Database.Exists()) return;
            context.Database.Create();

            var operations = GetInsertHistoryOperations();
            if (!operations.Any()) return;
            var providerManifestToken = GetProviderManifestToken(operations.First().Model);
            var sqlGenerator = _config.GetSqlGenerator(GetProviderInvariantName(context.Database.Connection));
            var statements = sqlGenerator.Generate(operations, providerManifestToken);
            statements.ToList().ForEach(x => context.Database.ExecuteSqlCommand(x.Sql));
        }

        private IList<InsertHistoryOperation> GetInsertHistoryOperations()
        {
            return
                _config.MigrationsAssembly.GetTypes()
                       .Where(x => typeof (DbMigration).IsAssignableFrom(x))
                       .Select(migration => (IMigrationMetadata) Activator.CreateInstance(migration))
                       .Select(metadata => new InsertHistoryOperation("__MigrationHistory", metadata.Id,
                                                                      Convert.FromBase64String(metadata.Target)))
                       .ToList();
        }

        private string GetProviderManifestToken(byte[] model)
        {
            var targetDoc = Decompress(model);
            return _pattern.Match(targetDoc.ToString()).Groups[1].Value;
        }

        private static XDocument Decompress(byte[] bytes)
        {
            using (var memoryStream = new MemoryStream(bytes))
            {
                using (var gzipStream = new GZipStream(memoryStream, CompressionMode.Decompress))
                {
                    return XDocument.Load(gzipStream);
                }
            }
        }

        private static string GetProviderInvariantName(DbConnection connection)
        {
            var type = DbProviderServices.GetProviderFactory(connection).GetType();
            var assemblyName = new AssemblyName(type.Assembly.FullName);
            foreach (DataRow providerRow in (InternalDataCollectionBase) DbProviderFactories.GetFactoryClasses().Rows)
            {
                var typeName = (string) providerRow[3];
                var rowProviderFactoryAssemblyName = (AssemblyName) null;
                Type.GetType(typeName, (a =>
                                            {
                                                rowProviderFactoryAssemblyName = a;
                                                return (Assembly) null;
                                            }), ((_, __, ___) => (Type) null));
                if (rowProviderFactoryAssemblyName != null)
                {
                    if (string.Equals(assemblyName.Name, rowProviderFactoryAssemblyName.Name,
                                      StringComparison.OrdinalIgnoreCase))
                    {
                        if (DbProviderFactories.GetFactory(providerRow).GetType().Equals(type))
                            return (string) providerRow[2];
                    }
                }
            }
            throw new Exception("couldn't get the provider invariant name");
        }
    }
} 
```

# mysql - 数据库设计：使用多个选择存储多个选项的最佳方式

> ID：14283083
> 
> 赞同：0
> 
> 时间：2013-01-11T17:04:31.953
> 
> 标签：mysql, database, database-design

所以我试图确定什么是最好的方法：我会尽量让这个尽可能简单，但要提供足够的信息

我有一个包含大型数据集的数据库。对于此示例，每辆车都是某人正在寻找的汽车

我有一张桌子：

```
CREATE TABLE cars (
`car_id` INT(10),
`car_name` VARCHAR(20)
) 
```

和选项表

```
CREATE TABLE `car_selected_options` (
`car_sel_id`   INT       NOT NULL AUTO_INCREMENT,
`car_id`       INT       //the id of the car record created
`value`        INT       //id of info in a ref table
`key`          VARCHAR(20)   //from the car_option_reference,
) 
```

一些例子是：值是参考表中更多信息的ID（注意两个电子）

```
car_id=1, value='10',    key='exterior_color'  10='red'
car_id=1, value='21',    key='interior_color'  21='blue' 
car_id=1, value='100',   key='electronics'     100='radio'
car_id=1, value='101',   key='electronics'     101='nav' 
```

我需要找到所有红色的汽车 ID，并且有导航和收音机，我正在做类似的事情：

```
SELECT distinct(c.car_id)
FROM `car` c 
   INNER JOIN `car_selected_options` AS o ON c.car_id = o.car_id
WHERE 
o.car_sel_id IN 
        ( SELECT car_sel_id 
            FROM car_selected_options so 
            WHERE so.`key` = 'exterior_color' 
              AND so.value IN ('10' ) AND b.buyer_id = bm.buyer_id )
    AND
o.car_sel_id IN 
        ( SELECT car_sel_id 
            FROM car_selected_options so 
            WHERE so.`key` = 'electronics'  
              AND so.value IN ('100','101' ) AND b.buyer_id = bm.buyer_id ) 
```

还是最好不要在一个表中使用键和所有内容，而是将每个 key.option 与每个事物的单独表分开，例如：

```
car_exterior_color (could have one entry per car or multiples if this person is ok with a red or a blue colored car)
car_interior_color 
car_electronics 
```

而不是做这些多个子选择（可能很多），做多个内部连接？

我希望这是有道理的，感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T17:57:59.197

您发布的查询似乎缺少某些内容，因为我看不到“b”和“bm”表是什么。忽略该子句，您可以大大简化查询，而无需执行多个子选择：

```
SELECT c.car_id
FROM `car` c 
   INNER JOIN `car_selected_options` AS o ON c.car_id = o.car_id
WHERE 
   (o.key = 'exterior_color' AND o.value = 10) OR
   (o.key = 'electronics' AND o.value = 100) OR
   (o.key = 'electronics' AND o.value = 101) OR
GROUP BY c.car_id
HAVING COUNT(*) = 3; 
```

在这种情况下，“3”是您应用的标准数量。这里的诀窍是，对于每辆匹配的汽车，您应该恰好有三个匹配的行，所以如果您按 car_id 分组，并按 count(*) = 3 过滤，您将只选择符合所有条件的汽车。

# java - 解密哈希密码

> ID：14283084
> 
> 赞同：0
> 
> 时间：2013-01-11T17:04:33.120
> 
> 标签：java, security, passwords, password-protection, password-encryption

我有以下代码来加密密码，但是当我尝试对其进行解码时，我没有得到预期的结果，这里是代码。

```
BASE64Encoder encoder = new BASE64Encoder();
String afterhex=toSHA1("mypassword".getBytes());
String encodedBytes = encoder.encodeBuffer(afterhex.getBytes());

public static String toSHA1(byte[] convertme) {
    MessageDigest md = null;
    try {
        md = MessageDigest.getInstance("SHA-1");
    } catch (NoSuchAlgorithmException e) {
        e.printStackTrace();
    }
    return new String(md.digest(convertme));
} 
```

例如，如果您尝试编码，吉尔您应该得到`LQBIF2TS0FSDYtGjaNmC2gl/klw=`

任何恢复它的建议:)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-11T17:09:57.837

散列算法不是加密/解密算法。

**散列**是一种将可变长度的大数据集（例如消息）映射到固定长度的较小数据集（散列）的单向过程**。**长度取决于散列算法。

并且**不可能**执行从哈希返回到您的消息的反向操作。

即使可以找到一条生成相同哈希的*消息*（例如使用[彩虹表](http://en.wikipedia.org/wiki/Rainbow_table)；对于像 MD5 这样较弱的哈希算法更容易），您**永远不知道**该消息是否与用于生成哈希的原始消息相同。*防止查找（猜测*）生成相同哈希值的消息（密码）的方法之一是在对消息（密码）进行哈希处理时使用[盐](http://en.wikipedia.org/wiki/Salt_%28cryptography%29)。

**编辑**

我还推荐*Bruce Schneier*的任何书籍，例如“*密码学工程：设计原则和实际应用*”（以非常好的和*易于理解*的方式编写），它将详细描述密码学和散列。

# python - Python：将字符串转换为对象

> ID：14283086
> 
> 赞同：0
> 
> 时间：2013-01-11T17:04:43.123
> 
> 标签：python, eval

假设我有一个文件以如下格式描述图形：

```
Directional:True
Simplicity:True
{
    1:[2,3]
    2:[1,3]
} 
```

我有一个如下定义的图形类：

```
class Graph:

def __init__(self,directional = False,simple=True,Filename=None):
    self.adjacencyList = {}
    self.directional = directional
    self.simple = simple
    if not Filename:
        _readFile(Filename) 
```

无论如何可以**轻松地**将这个文件转换为这个类。我知道我可以编写一个函数来逐行读取文件并自己做这件事。但是由于python是一种高度发达的语言，有什么简单的方法可以做到吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T17:13:42.323

不，因为该文件不符合任何标准/流行格式。它接近 YAML，但不足以直接解析。

# php - CSS 登录用户无法识别

> ID：14283088
> 
> 赞同：-5
> 
> 时间：2013-01-11T17:04:52.207
> 
> 标签：php, mysql, login

此代码无法识别我数据库上的登录用户。我已经尝试了几件事，到目前为止都没有任何影响。有人可以指出错误吗

```
 <?php
 session_start();
 include("dbconnect.php");
 $numrows=0;
 $sqlMember = mysql_real_escape_string($_POST["Membership_Number"]);
$sqlPassword = mysql_real_escape_string($_POST["Password"]); 

 $query="SELECT First_name, Last_name, Membership_Number FROM members WHERE Membership_Number='$member' AND Password='$password'";

 $link = mysql_query($query);
 if (!$link) {
  die('login error');
 }
 $numrows=mysql_num_rows($link);
 if ($numrows>0){  // authentication is successfull
  while($row = mysql_fetch_array($query));
  $_SESSION['user']['first_name']=$row['first_name'];
  $_SESSION['user']['last_name']=$row['last_name'];
  $_SESSION['user']['Membership_Number ']=$row['Membership_Number '];
  echo $_SESSION['user']['fname'].' '.$_SESSION['user']['lname'];
  header("location:members_area.php");
 } else {
  header("location:../invalid.php");  // authentication was unsuccessfull
 }
?> 
```

HTML

```
<form id="jjjj" action="Send_log_details.php" class="register" method="POST">
        <ul>
        <li>
        Membership Number:<br>
        <input type="text" id="Membership_Number" name="Membership_Number">
        </li>
        <li>
        Password:<br>
        <input type="password"  id="Password" name="Password" value="Log in">
        </li>
        <li>

        <input type="submit" name="register" value="Login" onclick="logMeIn()">             
        </li>
        </ul>
        </form> 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:08:43.903

您有`$link`包含 MYSQL 查询的变量，并且您正在使用`$query`变量。

```
if ($numrows>0){
  while($row = mysql_fetch_array($link)) {
      $_SESSION['user']['first_name']=$row['first_name'];
      $_SESSION['user']['last_name']=$row['last_name'];
      $_SESSION['user']['Membership_Number']=$row['Membership_Number'];
  }
  echo $_SESSION['user']['fname'].' '.$_SESSION['user']['lname'];
  header("Location: members_area.php");

 } else {
  header("Location: ../invalid.php");
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T17:11:57.200

这条线可能是问题所在：

```
$_SESSION['user']['Membership_Number ']=$row['Membership_Number ']; 
```

它应该是：

```
$_SESSION['user']['Membership_Number']=$row['Membership_Number']; 
```

我已经从数组键名的末尾删除了空格。

# actionscript-3 - 使用 Bulk-Loader 加载 Facebook 个人资料图片

> ID：14283094
> 
> 赞同：0
> 
> 时间：2013-01-11T17:05:20.707
> 
> 标签：actionscript-3, facebook-graph-api, bulkloader

我必须在我的 Flash Facebook 应用程序 (iframe) 中加载用户的个人资料图片。但是加载它有一些不寻常的东西。我的加载代码是：

```
var context1:LoaderContext = new LoaderContext();
var req:URLRequest = new URLRequest("http://graph.facebook.com/" + uidvar + "/picture?type=large");

Security.loadPolicyFile("http://graph.facebook.com/crossdomain.xml");
Security.loadPolicyFile("http://profile.ak.fbcdn.net/crossdomain.xml");
Security.allowDomain("*");
Security.allowInsecureDomain("*");

context1.checkPolicyFile = true;
loader.add(req, {id:"profilephoto", context:context1}); // I defined the "loader" as a BulkLoader object before.
loader.start(); 
```

但是当我在 Firefox 中调试 swf 时，它说

> 错误 #2044：未处理的安全错误：。text=Error #2048：安全沙箱违规：*MYSWFURL*无法从*FACEBOOK IMG URL加载数据*

对我来说，一切都很完美，但我遇到了这个错误。为什么？

# c# - 触摸派生自同一个 LibraryBar 的 ScatterViewItem 后重新启用 LibraryBar 项目

> ID：14283095
> 
> 赞同：0
> 
> 时间：2013-01-11T17:05:25.123
> 
> 标签：c#, wpf, xaml, pixelsense

我有一个`MainWindow.xaml`with a `ScatterView`，其中有一个`TagVisualization.xaml`在放置标签时出现的 a 。在里面`TagVisualization`，我有一个`PhotoGallery.xaml`有一个`LibraryBar`，它由一个名为 的外部类填充`PhotoGalleryViewModel.cs`。我已经实现了这个`DragDropScatterView`类，所以我可以将项目从 中`LibraryBar`拖放到`ScatterView`. 当一个新`ScatterViewItem`的被创建时，它有一个关闭按钮。当我单击它时，该项目应该从 中删除`ScatterView`并在`LibraryBar`. 我的问题是重新启用该项目，因为我似乎无法访问`PhotoGallery.xaml`.

前段时间我有类似的事情，有人给了我以下解决方案：

```
private void SurfaceButton_TouchDown(object sender, TouchEventArgs e) {
    ScatterViewItem _host = MyApplication.Helpers.VisualTree.FindVisualParent<ScatterViewItem>(this);

    if (_host != null) {
        DependencyObject parent = VisualTreeHelper.GetParent(this);
        ScatterViewItem svi = null;
        while (parent as DragDropScatterView == null)
        {
            if (parent is ScatterViewItem)
                svi = parent as ScatterViewItem;
            parent = VisualTreeHelper.GetParent(parent);
        }

        // Access directly to the LibraryBar
        LibraryBar lb = _host.Tag as LibraryBar;
        lb.SetIsItemDataEnabled(_host.Content, true);

        ((DragDropScatterView)parent).Items.Remove(this.DataContext);
    } 
```

但是，在我目前的项目中，这不起作用，因为`_host.Tag`总是`null`. 我设法想出了这个：

```
private void scatterCloseButton(object sender, TouchEventArgs e) {
    ScatterViewItem _host = MyApplication.Model.VisualTree.FindVisualParent<ScatterViewItem>(this);

    if (_host != null) {

        DependencyObject parent = VisualTreeHelper.GetParent(this);
        ScatterViewItem svi = null;
        while (parent as DragDropScatterView == null) {
            if (parent is ScatterViewItem)
                svi = parent as ScatterViewItem;
            parent = VisualTreeHelper.GetParent(parent);
        }

        // The data of the item
        PhotoGalleryViewModel lb = _host.DataContext as PhotoGalleryViewModel;

        if (lb != null) {
            // The Tag Visualizer relative to that tag
            TagVisualizer tagVisualizer = SurfaceFiturApp.Model.VisualTree.FindVisualParent<TagVisualizer>(this);
            if (tagVisualizer != null) {
                // The PhotoGallery object where the gallery is in
                PhotoGallery photoGallery = SurfaceFiturApp.Model.VisualTree.FindVisualChild<PhotoGallery>(tagVisualizer);
                if (photoGallery != null) {
                    // Enable the item in the library
                    photoGallery.setLibraryItemEnabled(lb);
                }
            }
        }

        // Remove the object from the ScatterView
        ((DragDropScatterView)parent).Items.Remove(this.DataContext);

    }

} 
```

但是这个问题（除了它的效率低下，因为我一路走到 the`TagVisualization`并且一路走来得到`LibraryBar`）是我无法区分不同的`LibraryBar's`，即，如果我在表面上有两个标签，只有其中一个将重新启用该项目，而其他人则什么都不做。

所以我的问题是：给定第一块代码，我怎样才能让它为我工作？我怎样才能从那里到达我的，即从( )`LibraryBar`一路走到a 内部的那个，也就是说，轮到 a和 a 的内部？`ScatterViewItem``PhotoGalleryViewModel``LibraryBar``TagVisualization``MainWindow``ScatterView`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T09:43:25.337

我设法解决了我的问题，`DragDropScatterView.cs`我需要将我的保存`dragSource`到`ScatterViewItem`，以便稍后激活它。所以我添加以下代码：

```
private void OnCursorDrop(object sender, SurfaceDragDropEventArgs args) {
    (...)
    svi.Tag = droppingCursor.DragSource;
    (...)
} 
```

这样我就可以使用我的第一篇文章中显示的第一部分代码，因为现在我有了`dragSource`.

# android - 菜单项不可见

> ID：14283101
> 
> 赞同：1
> 
> 时间：2013-01-11T17:05:58.350
> 
> 标签：android, menu, menuitem

我正在做菜单项。但我无法在屏幕上查看菜单项。查看菜单项需要做什么。我的代码：

```
 public boolean onCreateOptionMenu(Menu menu){
      super.onCreateOptionsMenu(menu);

       int group1 = 1;
       int group2 = 2;

      MenuItem info = menu.add(group1,1,1,"About");
      info.setIcon(R.drawable.ic_launcher);
      MenuItem set = menu.add(group2,2,2,"App Setting");
      set.setIcon(R.drawable.images);

       return true;
      }

         private boolean MenuChoice(MenuItem item){

            switch(item.getItemId()){
                case 1:
                Toast.makeText(this, "You clicked on item 1",    Toast.LENGTH_LONG).show();
                return true;
        }

       return false;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:12:20.110

我也有这个问题......在我的情况下，这是因为图像保存在文件夹“ `drawable`”中。我把它们移到了“ `drawable-hdpi`”那一个，问题就解决了！干杯。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T17:13:01.267

用这个 ：

```
public boolean onCreateOptionsMenu(Menu menu){
    Log.d(TAG, "CreateMenu");

     MenuInflater inflater = getMenuInflater();
     inflater.inflate(R.layout.menu, menu);
       return true;

}

@Override
public boolean onOptionsItemSelected(MenuItem item)
{    

        switch(item.getItemId()) {
                    case R.id.x:

            Toast.makeText(this, "You clicked on item 1",    Toast.LENGTH_LONG)         }
                        break;
                    }

    }
    return true;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T17:12:24.567

缺少菜单充气机：

```
MenuInflater inflater = getMenuInflater();
inflater.inflate(R.menu.game_menu, menu);
```

通过：http: [//developer.android.com/guide/topics/ui/menus.html](http://developer.android.com/guide/topics/ui/menus.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T17:12:49.693

[Android Developers](http://developer.android.com)上有一个关于[Menus](http://developer.android.com/guide/topics/ui/menus.html)的很好的参考资料。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-11T17:12:54.030

`super.onCreateOptionsMenu(menu)`从回来后试试`onCreateOptionMenu`

```
 public boolean onCreateOptionMenu(Menu menu){

   int group1 = 1;
   int group2 = 2;

   menu.add(group1,1,1,"About").setIcon(R.drawable.ic_launcher);
   menu.add(group2,2,2,"App Setting").setIcon(R.drawable.images);

   return super.onCreateOptionsMenu(menu);;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-11T17:14:15.373

```
 @Override
    public boolean onCreateOptionsMenu(Menu menu)
    {
        MenuInflater menuInflater = getMenuInflater();
        menuInflater.inflate(R.layout.menu, menu);
        return true;
    } 
```

看这个例子

[http://www.androidhive.info/2011/09/how-to-create-android-menus/](http://www.androidhive.info/2011/09/how-to-create-android-menus/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-07-31T01:27:59.793

我的原因是在styles.xml 中，父母的主题有误。确保它以 android 开头：试试这个：

```
<!-- Base application theme. -->
<style name="AppTheme" parent="android:Theme.DeviceDefault.Light.DarkActionBar">
    <!-- Customize your theme here. -->
</style> 
```

# android - Android 1.5 上的 Google In App Billing

> ID：14283102
> 
> 赞同：0
> 
> 时间：2013-01-11T17:06:01.940
> 
> 标签：android, in-app-billing, in-app-purchase

我们目前正在使用平台版本 1.5 开发 android 应用程序，并在下面实现 In App Billing，

PurchaseObserver.java 中的 IntentSender 有错误

有什么方法可以使用 Platform 1.5 版实现 Google In App Billing API？如果我们将平台版本更改为 1.6，则会出现另一个非常难以修复的屏幕尺寸问题。

谢谢

# c# - 创建过滤的 XmlNodeList

> ID：14283105
> 
> 赞同：0
> 
> 时间：2013-01-11T17:06:13.357
> 
> 标签：c#, xml

我有包含图像信息的 XML 数据。我的第一个目标是创建一个过滤器`XmlNodeList`（例如返回所有图像 where `color == yellow`）。最终目标是能够返回一个图像名称列表，其中`color == yellow`（返回一个完整的过滤`XmlNodeList`器很棒，但我真的只需要该过滤器列表中的一个元素，例如名称或 ID）。

就我而言，根节点称为`Images`，我希望能够在每个`Image`节点中进行搜索。我的 XML 数据没有 XML 属性，因此每一位数据都表示为一个元素（使颜色“黄色”成为图像的子节点，而不是图像的属性）。

XML

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Images xmlns="http://oec.api.opsource.net/schemas/server"
    xmlns:ns9="http://oec.api.opsource.net/schemas/multigeo"
    xmlns:ns5="http://oec.api.opsource.net/schemas/vip"
    xmlns:ns12="http://oec.api.opsource.net/schemas/storage"
    xmlns:ns6="http://oec.api.opsource.net/schemas/whitelabel"
    xmlns:ns13="http://oec.api.opsource.net/schemas/manualimport"
    xmlns:ns7="http://oec.api.opsource.net/schemas/datacenter"
    xmlns:ns10="http://oec.api.opsource.net/schemas/reset"
    xmlns:ns8="http://oec.api.opsource.net/schemas/general"
    xmlns:ns11="http://oec.api.opsource.net/schemas/support"
    xmlns:ns2="http://oec.api.opsource.net/schemas/directory"
    xmlns:ns4="http://oec.api.opsource.net/schemas/network"
    xmlns:ns3="http://oec.api.opsource.net/schemas/organization">
    <Image>
        <id>mcd93jf8dd</id>
        <name>cat</name>
        <color>yellow</color>
    </Image>
    <Image>
        <id>d4b8l23sas</id>
        <name>dog</name>
        <color>yellow</color>
    </Image>
</Images> 
```

我最初的 XML 数据源是一个流。我已经找到了使用 foreach 循环遍历我的 XML 层次结构的不同级别的方法，但是我一直遇到在子节点上没有我需要的所有方法可用的问题。其他地方的建议似乎建议使用`XPath`来实现我的过滤器，但我无法让它与我迄今为止所得到的一起工作：

C＃

```
//'stream' previously defined as a Stream
XmlReader reader = XmlReader.Create(stream);
XmlDocument xml = new XmlDocument();
xml.Load(reader);
XmlElement root = xml.DocumentElement;
XmlNodeList images = root.ChildNodes;

foreach (XmlNode image in images) {

    XmlNodeList attributes = image.ChildNodes;

    foreach (XmlNode attribute in attributes) {
        //do stuff
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:11:25.250

我在这里发布了一些代码：http: [//ideone.com/jRFoBW](http://ideone.com/jRFoBW)来演示以下技术。XML 是从流中加载还是直接从字符串中加载应该没有区别，但我已将其设置为从流中加载以尽可能接近地模拟您的条件。

由于您的 XML 使用命名空间，因此您需要创建命名空间管理器并将命名空间添加到其中：

```
XmlNamespaceManager nsm = new XmlNamespaceManager(xml.NameTable);
// The prefix can be anything as long as you use it consistently
nsm.AddNamespace("i", "http://oec.api.opsource.net/schemas/server"); 
```

然后您可以执行以下操作来获取黄色`id`s 和`name`s 的列表：

```
XmlNodeList ids = xml.SelectNodes("/i:Images/i:Image[i:color = 'yellow']/i:id", nsm);
XmlNodeList names = xml.SelectNodes("/i:Images/i:Image[i:color = 'yellow']/i:name", nsm); 
```

虽然如果你想要黄色图像`id`和`name`黄色图像，我建议你这样做：

```
foreach(XmlNode yellowImage in xml.SelectNodes("/i:Images/i:Image[i:color = 'yellow']", nsm))
{
   string id = yellowImage.SelectSingleNode("i:id", nsm).InnerText;
   string name = yellowImage.SelectSingleNode("i:name", nsm).InnerText;

   // use id and name
} 
```

# javascript - 初学者：从字符串到 UTC date.js 到 SharePoint 列表的 javascript 日期转换

> ID：14283106
> 
> 赞同：2
> 
> 时间：2013-01-11T17:06:18.223
> 
> 标签：javascript, date, sharepoint, datejs, spservices

我正在尝试从元素中获取字符串日期值，并将其转换为 js var，以便使用 SPServices 添加到 SP 2010 列表（日期字段）。

我找到了 date.js 资源，但我不确定如何正确使用它。我所做的所有操作日期的操作都会将其更改为字符串... .format() 什么的。

我想我需要以某种方式将值更改为： 2013-01-01T19:20:15 以便通过 SPServices 并更新如下列表：

```
function CreateNewItem(subject, message) {
    $().SPServices({
        operation: "UpdateListItems",
        async: false,
        batchCmd: "New",
        listName: "Example",
        valuepairs: [["Title", subject], ["Message", message], ["DateField", date]],
        completefunc: function(xData, Status) {
          alert("completed");
        }
    });} 
```

所以我尝试了 Date.parse 并且它不喜欢返回的值，但是我不确定如何在不将其设为字符串的情况下更改返回的值？

一如既往地感谢帮助。

编辑：更多说明......我正在使用 XSLT 从 XML 文件中获取值，并创建 html 页面以查看这些值。所以用xml

```
<div id="thisDateExample"><xsl:value of select="thisDateExampleDate"/></div> 
```

所以我一直在尝试一些事情，比如从 jquery 选择器中获取字符串值：

```
var thisDateThatIsDrivingMeCrazy = $('#thisDateExample').text(); 
```

再说一次，我只是在学习所有这些东西，但我认为这使它成为一个字符串，并且我找到了 date.js 以将其恢复为我猜的日期格式？

```
var thisDateConverted = new Date(Date.parse(thisDateThatIsDrivingMeCrazy)); 
```

然后尝试传递到 SPServices？这是我认为有道理的一种方法，但我一定在这里做错了什么？如果我提醒这是使用与我相信的不同的格式。但再次按照上述规定，我为格式化它所做的任何事情（或我可以在该主题上找到的尝试）似乎都会将其更改为字符串（我假设）并且不起作用。帮助总是很感激！太棒了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T13:51:26.923

想通了这一点，尽管我认为我最初的问题只是缺少一些内容。我需要将日期格式化为 ISO 8601 格式，以便 SharePoint 将其排除在外。所以我真正需要的是我在[这里](http://spservices.codeplex.com/discussions/349356)找到的东西：

```
function convertThisDate(thisDate){
  var myDate;
  if (thisDate!= null)  {
     myDate = thisDate;
  }
  else  {
     myDate = new Date();
  }
  var stringDate = "";
  stringDate  += thisDate.getYear() + "-";
  stringDate  += thisDate.getMonth() + 1 + "-";
  stringDate  += thisDate.getDate();
  stringDate  += "T" + thisDate.getHours() + ":";
  stringDate  += thisDate.getMinutes() + ":";
  stringDate += thisDate.getSeconds() + "Z";
  return stringDate;
} 
```

像上面这样简单的东西完美无缺，因为 SharePoint 似乎对日期非常挑剔。

# java - javax.script on Android

> ID：14283116
> 
> 赞同：1
> 
> 时间：2013-01-11T17:06:45.520
> 
> 标签：java, android

I would like to port my Java project to Android devices, the problem I am facing is, that I need javax.script library. So the question is: Is it possible to import *javax.script* to an Android project? And if so, how can I do that?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T17:16:54.923

If you are willing to port the entire javax.script package, and any other packages it depends on to Android and compile them as a library, then yes. Otherwise, no.

# jquery - 脚本不断覆盖数组

> ID：14283117
> 
> 赞同：1
> 
> 时间：2013-01-11T17:06:49.473
> 
> 标签：jquery, arrays, push

所以基本上我必须遵循脚本。当我单击它时，数据会被推送到一个数组中。但是每当我单击它时，数组大小保持不变并且没有添加元素，它只会保持一个元素长。我错过了什么？

```
$(document).on('click', '#favoriteadd', function() {
    var favorites = [];
    favorites.push($('h5').text());
    console.log(favorites);
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T17:08:12.977

每次运行该函数时，您都会创建一个新数组。使用全局变量或将数组传递给函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T17:08:58.707

`favorites`每次单击时，您都将变量初始化为空。

试试这个：

```
var favorites = [];
$(document).on('click', '#favoriteadd', function() {
  favorites.push($('h5').text());
  console.log(favorites);
}); 
```

# sql-server-2008 - 如何以不同格式转换Sql server Datetime

> ID：14283118
> 
> 赞同：0
> 
> 时间：2013-01-11T17:06:49.677
> 
> 标签：sql-server-2008

我有一列以 YYYY-MM-DD HH:MM:SS.MSS 格式存储日期和时间值。我有另一个表，它将日期和时间值存储为格式为“M/D/YYYY HH:MM:SS AM”的***字符串***。

现在如何将 YYYY-MM-DD HH:MM:SS.MSS 这种格式转换为 M/D/YYYY HH:MM:SS AM。转换后，我可以将转换日期与日期时间字符串进行比较。例如

A.Date_time = '2013-01-08 12:04:00.000' B.Date_time = convert (A.Date_time) -- 转换格式为 M/D/YYYY HH:MM:SS AM ...

if(B.Date_time = 'convert (A.Date_time)' - 我怎样才能将转换日期与日期时间字符串进行比较。...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:11:00.280

不要转换为字符串进行比较，转换为日期进行比较。

```
SELECT <cols>
  FROM A
  INNER JOIN B
  ON A.Date_time = CONVERT(DATETIME, B.Date_time, 101); 
```

您可能需要先清理数据 - 当您使用字符串存储日期时（出于各种原因，您永远不应该这样做），任何人都可以在其中塞入任何垃圾而无需验证。因此，不能保证您的所有值*都*可以成功转换为日期时间。

**对于更改的要求**，我们可以尝试以这种方式 sussing 可怕字符串的日期时间部分：

```
SELECT <cols>
  FROM A
  INNER JOIN B
  ON A.Date_time = CONVERT(DATETIME, 
   SUBSTRING(B.Date_time, CHARINDEX(' - ', B.Date_time) + 3, 255), 101); 
```

你甚至可以先把它拿出来，例如

```
;WITH x AS (SELECT B.Date_time, RealDateTime = CONVERT(DATETIME, 
   SUBSTRING(B.Date_time, CHARINDEX(' - ', B.Date_time) + 3, 255), 101)
   FROM B
)
SELECT x.Date_time, x.RealDateTime FROM x
-- add joins, comparisons, etc. 
```

恕我直言，您应该专注于修复数据类型，而不是解决差异。或者至少与设计这个烂摊子来清理它的人争论。

# javascript - Javascript 会话 cookie 未在 IE9 中写入

> ID：14283119
> 
> 赞同：0
> 
> 时间：2013-01-11T17:06:53.617
> 
> 标签：javascript, session-cookies

您好 Stack Overflow 用户。我创建了一个不错的小脚本，将 A/B 测试信息从他们的 API 附加到我们的一个会话 cookie 中，以存储在我们的数据库中。该脚本适用于除 IE 以外的所有浏览器（惊喜！）。这是代码：

```
<script>
function addTParam() {
  function getCookie(acqsource) {
    var i, x, y, ARRcookies = document.cookie.split(';');
    for (i = 0; i < ARRcookies.length; i++) {
      x = ARRcookies[i].substr(0, ARRcookies[i].indexOf('='));
      y = ARRcookies[i].substr(ARRcookies[i].indexOf('=') + 1);
      x = x.replace(/^\s+|\s+$/g, '');
      if (x == acqsource) {
        return unescape(y);
      }
    }
  }
  if (typeof (abtester) != 'undefined') {
    var experimentId = 0;
    var variationId = 0;
    var variationIdx = -1;
    var activeExpts = abtester.activeExperiments;
    var values;
    var newArray = [];
    for (var i = 0; i < activeExpts.length; i++) {
        experimentId = activeExpts[i];
        if (abtester.variationIdsMap.hasOwnProperty(experimentId)) {
          variationId = abtester.variationIdsMap[experimentId];
          newArray = newArray.concat(variationId);
        }
      }

    newArray = activeExpts.concat(newArray);
    values = newArray.join('-');

    var contents = getCookie('acqsource');
    if (values && values.length > 0 && (contents.indexOf(values) === -1)) {
      contents += "&tp=" + values;
      document.cookie = "acqsource=" + contents + "; domain=domain.com; path=/";
    }
  }
}
$(document).ready(function () {
  addTParam();
});
</script> 
```

为了解释一下，这个函数会在 acqsource cookie 中附加一个字符串“tp=123456-7890123”。但是，当它执行 getCookie 函数时，IE 要么：a) 找不到它，要么 b) 说它不存在（它应该在加载时创建该 cookie）。这一切都是在 DOM 完成后加载的，所以这不是问题。

我已经在谷歌上详尽地搜索了这个问题，甚至联系了我公司的其他几个开发人员，我们所有人都被难住了。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T18:35:50.327

所以，我已经想通了。我检查 cookie 的方法是检查是否有`=`. 这就是问题所在，因为 IE 设置会话 cookie 的方式，如果 cookie 为空，它会返回未定义，因为`=`该 cookie 中没有。所以一点代码魔法让我明白了：

```
var contents = getCookie('acqsource');
if (values && values.length > 0 && contents !== undefined && (contents.indexOf(values) === -1)) {
  contents += '&tp=' + values;
  document.cookie = 'acqsource=' + contents + '; domain=domain.com; path=/';
}
else if (values && values.length >0 && contents === undefined){
  document.cookie = 'acqsource=' + values + '; domain=domain.com; path=/';
} 
```

基本上，您需要检查 cookie 是否未定义，如果没有，则写入并附加。但是，如果 cookie 为空，您只需将其添加到其中即可。希望这可以帮助任何因会话 cookie 和 IE 而陷入困境的人。

# java - Java小程序不会呈现图像（png）

> ID：14283121
> 
> 赞同：0
> 
> 时间：2013-01-11T17:06:59.020
> 
> 标签：java, image, graphics, applet

当我运行游戏时，我只看到黑屏，没有图像。

我在kilobolt游戏开发指南的帮助下编写我的游戏：[http ://www.kilobolt.com/day-4-enter-the-robot.html](http://www.kilobolt.com/day-4-enter-the-robot.html)

我真的很想知道我做错了什么。

## 播放器.java

```
package HideAndSeek;

import java.awt.*;
import java.awt.image.ImageObserver;

public class Player
{
    private Image image;
    private double velocity;
    private int x;
    private int y;

    public Player(Image image,double velocity,int x,int y)
    {
        this.image = image;
        this.velocity = velocity;
        this.x = x;
        this.y = y;
    }

    public void update(Graphics g,ImageObserver io)
    {
        g.drawImage(image, 0, 0, io);
    }
} 
```

## 游戏.java

```
package HideAndSeek;

import java.applet.Applet;
import java.awt.Color;
import java.awt.Graphics;
import java.awt.Image;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;

public class Game extends Applet implements Runnable,KeyListener
{
    private Image background;
    private Graphics graphics;
    private java.net.URL base;
    private Player player;

    @Override
    public void init() 
    {
        background = createImage(this.getWidth(), this.getHeight());
        graphics = background.getGraphics();
        setSize(800, 480);
        setBackground(Color.BLACK);
        setFocusable(true);
        java.awt.Frame frame = (java.awt.Frame) this.getParent().getParent();
        frame.setTitle("Hide and Seek");
        base = getCodeBase();
        addKeyListener(this);
    }

    @Override
    public void start() 
    {
        player = new Player(getImage(base, "data/character.png"),1.0,0,0);
        Thread thread = new Thread(this);
        thread.start();
    }

    @Override
    public void stop() 
    {

    }

    @Override
    public void destroy() 
    {

    }

    public void update()
    {
        if (background == null) 
        {
            background = createImage(this.getWidth(), this.getHeight());
            graphics = background.getGraphics();
        }

        graphics.setColor(getBackground());
        graphics.fillRect(0, 0, getSize().width, getSize().height);
        graphics.setColor(getForeground());
        paint();
        graphics.drawImage(background, 0, 0, this);
    }

    public void paint()
    {
        player.update(graphics,this);
    }

    @Override
    public void run() 
    {
        while(true)
        {
            update();
            repaint();
            try
            {
                Thread.sleep(17);
            }
            catch(InterruptedException e)
            {
                e.printStackTrace();
            }
        }
    }

    @Override
    public void keyPressed(KeyEvent arg0)
    {
        switch (arg0.getKeyCode())
        {
           case KeyEvent.VK_UP:
               System.out.println("You pressed up arrow");
               break;

           case KeyEvent.VK_DOWN:
               System.out.println("You pressed down arrow");
               break;

           case KeyEvent.VK_LEFT:
               System.out.println("You pressed left arrow");
               break;

           case KeyEvent.VK_RIGHT:
               System.out.println("You pressed right arrow");
               break;

           case KeyEvent.VK_SPACE:
               System.out.println("You pressed the space key");
               break;
        }
    }

    @Override
    public void keyReleased(KeyEvent arg0)
    {
        // TODO Auto-generated method stub

    }

    @Override
    public void keyTyped(KeyEvent arg0)
    {
        // TODO Auto-generated method stub

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T17:15:55.110

你画错了 你用来在屏幕上绘画的图形对象每次`paint`被调用时都是不同的。除了您没有`paint`正确覆盖该方法之外，还缺少一个参数。只需将方法更改为此，它应该可以工作：

```
public void paint(Graphics g)
{
player.update(g, this);
} 
```

# javascript - navigator.onLine 并不总是有效

> ID：14283124
> 
> 赞同：32
> 
> 时间：2013-01-11T17:07:03.983
> 
> 标签：javascript

我对 navigator.onLine 属性有疑问。

我正在从在 WAMP 上运行的本地信息亭运行一个简单的网站。

在我的笔记本电脑上测试它时它可以工作。我关闭 WiFi 并出现警告框。在运行 WAMP 软件的信息亭上断开互联网连接不会产生错误状态。任何想法为什么？

```
var online = navigator.onLine;

if (online == false) {

    alert("Sorry, we currently do not have Internet access.");
    location.reload();

} 
```

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2013-01-11T17:11:00.660

MDN 关于[navigator.onLine](https://developer.mozilla.org/en-US/docs/DOM/window.navigator.onLine)：

> 在 Chrome 和 Safari 中，如果浏览器无法连接到局域网 (LAN) 或路由器，则它处于离线状态；所有其他条件都返回 true。因此，虽然您可以假设浏览器在返回 false 值时处于脱机状态，但您不能假设 true 值必然意味着浏览器可以访问互联网。

如上所述，此属性是不可信的，因此，在我看来，最好的解决方法是对服务器端页面进行 ajax 调用。如果浏览器离线，则连接将失败，因此`onerror`将调用该事件。否则，将`onload`调用该事件：

```
function isOnline(no,yes){
    var xhr = XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject('Microsoft.XMLHttp');
    xhr.onload = function(){
        if(yes instanceof Function){
            yes();
        }
    }
    xhr.onerror = function(){
        if(no instanceof Function){
            no();
        }
    }
    xhr.open("GET","anypage.php",true);
    xhr.send();
}

isOnline(
    function(){
        alert("Sorry, we currently do not have Internet access.");
    },
    function(){
        alert("Succesfully connected!");
    }
); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-05-04T09:37:11.017

如果您使用的是**axios**：

```
axios.request(options).catch(function(error) {
  if (!error.response) {
    // network error (server is down or no internet)
  } else {
    // http status code
    const code = error.response.status
    // data from server while error
    const response = error.response.data
  }
}); 
```

# javascript - 不可访问的 JavaScript 对象属性

> ID：14283128
> 
> 赞同：1
> 
> 时间：2013-01-11T17:07:32.663
> 
> 标签：javascript, console

奇怪的问题。

我正在调查控制台中的一个对象。其中一个属性无法通过 JavaScript 访问，但可以通过控制台访问。

是否可以通过 JavaScript 访问该属性？

这是 console.log(marker,marker.ie,marker.map) 的输出：

![console.log(marker,marker.ie,marker.map)](../Images/010d368d9501f759efd5f2db7509d12e.png)

这是在控制台中打开的 marker.ie 属性：

![marker.ie 属性在控制台中打开](../Images/112a541e0ff81166230708d39559360f.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T17:11:32.270

有可能，在 的时候 的`console.log`值`marker.ie`是`undefined`。它可能稍后会被定义，这解释了为什么如果您打印整个`marker`.

也许您应该等待某个事件完成？

# javascript - 当查询字符串不够长时，如何从 jQuery 调用（网络本地）第 3 方 Web 服务？

> ID：14283129
> 
> 赞同：1
> 
> 时间：2013-01-11T17:07:35.633
> 
> 标签：javascript, jquery, web-services, cross-domain, http-post

我们从胖客户端调用了第 3 方 Web 服务，它多年来一直运行没有任何问题。

我的任务是将 Fat 客户端转换为可在任何常见浏览器上运行的移动就绪站点。由于第 3 方服务需要跨域调用，我必须使用 JSONP，但是这使用 HTTP GET 并在查询字符串中传递数据。由于[查询字符串的限制，](https://stackoverflow.com/a/812962/198048)我们发送的一些对象相当大并且需要 POST ，但是使用 JSONP 这是不可能的。

[这个答案](https://stackoverflow.com/a/812964/198048)让我想知道是否有我错过的方法。有没有人有什么建议？

由于所有站点的防火墙/安全限制（有 1000 个站点，并且它们都具有此 3rd 方服务的实例并且不会更改其规则），因此无法编写代理处理程序/服务来为我调用）。因此，重要的是 jQuery 脚本可以从浏览器本身进行此调用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:12:25.383

唯一的选择是找到一种方法来压缩发送到服务器的内容并让服务器解压缩它。

其他选项是在远程服务器上[启用 CORS](https://developer.mozilla.org/en-US/docs/HTTP/Access_control_CORS)以允许跨域调用。

# ruby-on-rails - Rails 中一项 rake 任务的不同环境

> ID：14283132
> 
> 赞同：3
> 
> 时间：2013-01-11T17:07:46.683
> 
> 标签：ruby-on-rails, rake, production-environment

是否可以在不同的环境中调用 rake 任务？这意味着我有一个生产数据库，我想在其中读出一些数据并将其放入我的测试数据库。

我的测试数据库中的表在生产数据库中是未知的，反之亦然。

编辑：它们都不是我的标准环境，所以它们都不是本地的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:40:29.613

您可以检查一下`octopus`，它是一个允许您选择查询将调用的数据库的[gem](https://github.com/tchandy/octopus#syntax)，您可以使用它在您的 rake 中指定从何处读取和放置数据。

所以在你的耙子里，你可以做类似的事情（可能不是最好的方法）：

```
@user = User.where(:name => "Test").using(:production_one)
@duplicate_user = @user.dup
Octopus.using(:test_one) do
  @duplicate_user.save
end 
```

# javascript - 判断 jQuery DOM 元素是否可拖动

> ID：14283133
> 
> 赞同：0
> 
> 时间：2013-01-11T17:07:47.370
> 
> 标签：javascript, jquery, jquery-ui

jQuery UI 是否将任何属性存储到 jQuery dom ref 元素？

我特别感兴趣的是任何可以判断它是否可拖动的数据或属性或函数？

例子：

```
var jqnode = jQuery('selector');
jqnode.draggable({...});
var isDraggable = !!(jqnode.tellIsDraggableProperty); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T17:13:04.137

```
var isDraggable = !!jqnode.data("draggable") 
```

或者

```
var isDraggable = jqnode.is(":ui-draggable"); 
```

根据您想要做什么，您可以使用原始选择器：

```
jQuery('selector:ui-draggable').fn() 
```

`fn`如果它是可拖动的，这只会巧妙地调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T17:10:39.697

如果我理解正确，我认为这将满足您的要求。

```
var jqnode = jQuery('selector');
var isDraggable = (typeof jqnode.draggable === 'function'); 
```

另外，我认为 hasOwnProperty() 也可以：

```
var jqnode = jQuery('selector');
var isDraggable = jqnode.hasOwnProperty('draggable'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T17:11:05.030

当 jQueryUI 初始化 时，它会向元素`draggable`添加一个类：`ui-draggable`

```
var isDraggable = jqnode.hasClass('ui-draggable'); 
```

# c# - 遍历 JSON 文档 C#

> ID：14283134
> 
> 赞同：0
> 
> 时间：2013-01-11T17:07:47.787
> 
> 标签：c#, json, json.net

我正在尝试创建一个简单的应用程序，该应用程序从 Google Maps API 获取 JSON 文档并对其进行迭代，显示路线、持续时间和距离的每一段。

我已经让它显示第一条腿，但我不知道如何让盒子重复。也许是一个 foreach 循环？我是新来的，我真的不确定。

```
var from = origin.Text;
var to = destination.Text;
var requesturl = @"http://maps.googleapis.com/maps/api/directions/json?origin="
        + from + "&alternatives=false&units=imperial&destination="
        + to + "&sensor=false";
string content = file_get_contents(requesturl);
JObject o = JObject.Parse(content);
string distance = (string)o.SelectToken("routes[0].legs[0].distance.text");
string instructions =
        (string) o.SelectToken("routes[0].legs[0].steps[0].html_instructions");
txtDistance.Text = distance;
TextBox1.Text = instructions; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T18:43:00.943

[由于您有一个示例 json 文档，您可以使用http://json2csharp.com/](http://json2csharp.com/)创建相关合同。之后您可以使用带有类型属性的对象，并轻松地遍历相关字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T18:13:40.340

这个答案：[将 JSON 反序列化为 C# 动态对象？](https://stackoverflow.com/questions/3142495/deserialize-json-into-c-sharp-dynamic-object)有一些类的代码，可让您将 JSON 反序列化为动态 C# 对象。听起来它非常适合您的需求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T17:13:57.117

您可以反序列化整个 JSON 响应并使用对象来迭代结果。这将比硬编码或计算字符串路径更易于维护。

您可以查看[Google Directions C# 包装器](http://www.doogal.co.uk/GoogleDirections.php)了解详细信息

# java - 有没有办法将 MouseListener 添加到图像中？

> ID：14283135
> 
> 赞同：2
> 
> 时间：2013-01-11T17:07:49.857
> 
> 标签：java, image, swing, custom-component, mouselistener

我正在用 Java 开发纸牌游戏。我已经有一个知道如何绘制自己的 Card 类。当用户单击它时，我希望卡片将其等级和西装输出到控制台。不幸的是，我在实现此功能时遇到了问题。

这是我目前所拥有的精简版：

```
public class Card  extends Component {

  private Rank rank;
  private Suit suit;
  // Note: Rank and Suit are enums

  public String toString() {
    String rank = this.rank.name().toLowerCase();
    String suit = this.suit.name().toLowerCase();

    return (rank + " of " + suit);
  }

  // ...
}

public class MyPanel extends JPanel implements MouseListener {

  public static void main(String[] args) {
    JFrame frame = new JFrame();
    frame.setSize(410, 320);
    frame.setContentPane(new MyPanel());
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setVisible(true);
  }

  private Card card;

  public MyPanel() {
    card = new Card();

    card.setRank(Rank.ACE);
    card.setSuit(Suit.SPADE);
    card.addMouseListener(this);

    addMouseListener(this);
  }

  @Override
  public void mouseClicked(MouseEvent mouseEvent) {    
    Object source = mouseEvent.getSource();

    if(source instanceof Card) {
      Card card = (Card) source;
      System.out.println(card);
    }
    else {
      System.out.println("not a card : " + source);
    }
  }

  // ...
} 
```

我不想从 JLabel 扩展，因为 addMouseListener 是我真正需要的，而且它是从 Component 类继承的。

或者，我可以让 Card 类本身检查 MouseEvent 的位置是否在 Card 图像的边界内，而不是从 Component 扩展。我不喜欢这个主意，因为这意味着我必须对所有 52 张卡片进行边界检查。

# java - Grails文件中的普通java servlet上传空的FileItem列表

> ID：14283138
> 
> 赞同：3
> 
> 时间：2013-01-11T17:08:10.083
> 
> 标签：java, grails, servlets

我遇到了这样的问题

我已经`HttpServlet`用 apache `FileUpload`lib 用 Ja​​va 实现了。

当我将此代码作为简单的 Java Web 项目进行测试并将其部署在 Tomcat 中时，它可以工作。但是当我在 Grails 项目中将它部署为 servlet 时，`List<FileItem> items`它总是空的。

我很确定这是因为 Grails 中的某些内容在我执行之前正在消耗请求正文`Servlet`，但我不知道如何强制 Grails 在我之前不使用请求。

我需要将纯 Java servlet 添加到 grails 项目，因为我需要将一些已经编写的 Java 代码与 Grails 集成。

这是servlet代码：

```
protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    try {
        List<FileItem> items = new ServletFileUpload(
                new DiskFileItemFactory()).parseRequest(request);
        for (FileItem item : items) {
            if (item.isFormField()) {
                String fieldname = item.getFieldName();
                String fieldvalue = item.getString();
                System.out.println(fieldname + "=" + fieldvalue);
            } else {
                String fieldname = item.getFieldName();
                String filename = FilenameUtils.getName(item.getName());
                InputStream filecontent = item.getInputStream();
                String value = IOUtils.toString(filecontent);
                System.out.println(fieldname + "=" + value);
            }
        }
    } catch (FileUploadException e) {
        throw new ServletException("Cannot parse multipart request.", e);
    }
} 
```

它只是读取请求正文并打印到 sysout。

现在我有表格：

```
<html>
 <body>
   <form action="http://localhost:8080/Tst/photoServlet" method="post" enctype="multipart/form-data">
     <input type="text" name="fieldId" value="field_photo"/>
     <input type="file" name="Afile" />
     <input type="submit" />
   </form>
 </body>
</html> 
```

我还在`web.xml`Grails 中添加了这样的映射：

```
<servlet>
    <servlet-name>photoServlet</servlet-name>
    <servlet-class>com.tst.PhotoUploadServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>photoServlet</servlet-name>
    <url-pattern>/ws/photoUpload</url-pattern>
</servlet-mapping> 
```

# oracle - Oracle 模糊文本搜索

> ID：14283140
> 
> 赞同：0
> 
> 时间：2013-01-11T17:08:23.703
> 
> 标签：oracle, plsql, full-text-search, names

如何在 Oracle 中进行模糊名称搜索？

例如：

我们的数据系统具有以下首选邮件：

**Nicolas Jim Raleigh 先生**

但在 Facebook 或其他搜索字段中，传递给算法的名称是：

**尼克·吉姆·罗利**

该过程将对所有首选名称运行搜索名称，然后返回包含最匹配字符的结果：

[ **Nic** ]olas **Jim Raleigh先生**

[**尼克**]k**吉姆罗利**

我搜索的名称的 17 个字符中有 16 个出现在首选名称中，我们可以返回排名建议。

[编辑添加]

在最初的建议和阅读[Oracle 的文本查询选项](http://docs.oracle.com/cd/B28359_01/text.111/b28303/query.htm)之后，我在表上创建了一个索引

```
create index ADD_EX_INDX3 on address_extract(pref_mail_name) 
  indextype is ctxsys.context 
  parameters ('DATASTORE CTXSYS.DEFAULT_DATASTORE'); 
```

现在能够成功退休

```
select score(1), ae.pref_mail_name
from address_extract ae
 where contains(pref_mail_name,'fuzzy(raleigh,,,weight)',1) > 0
order by score(1) desck 
```

哪个返回

```
100 Mr. Raleigh H. Jameson
100 Mr. Nicolas Jim Raleigh
100 Ms. Susanne M. Raleigh
66  Mrs. LaReign Smith
66  Ms. Rahil Smith
62  Mr. Smith  Ragalie 
```

但是，我正在努力进行全名搜索。我将如何去做全名？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T23:50:32.733

名字匹配*很难*。Oracle 的文本索引支持模糊匹配和词干提取，这是一个开始，但请考虑以下名称：

*   尼古拉斯·罗利
*   尼古拉斯·罗利
*   尼科·罗利
*   尼克·罗利
*   尼基·罗利
*   尼克·罗利
*   尼古拉斯·罗利
*   尼古拉·罗利
*   尼基·罗利
*   尼古拉·罗利
*   尼古拉·罗利
*   尼古拉·罗利

试图通过抽象来匹配它们，无论是 Levenshtein Distance 还是 Double Metaphone，都会产生误报和漏报。这就是抽象的本质。获得集中且准确的结果集的最佳方法是使用同义词库（即使这并不完美）。不幸的是，组装一个全面的名称词典是一项艰巨的任务。要了解这项任务，请查看[NameX 网站上的统计数据](http://www.namethesaurus.com/)。

* * *

更新：Oracle 11gR2 包括针对名称搜索定制的 Oracle Text 扩展。这是非常整洁的，绝对是第一个开始的地方。 [了解更多](http://docs.oracle.com/cd/E11882_01/text.112/e24435/search.htm#CCAPP9534)。

# jquery - Foundation Accordion 展开/折叠所有按钮

> ID：14283141
> 
> 赞同：-1
> 
> 时间：2013-01-11T17:08:24.080
> 
> 标签：jquery, accordion, zurb-foundation

我正在使用 Foundation 3 Accordion [http://foundation.zurb.com/docs/elements.php](http://foundation.zurb.com/docs/elements.php)

我想在手风琴上方添加一个按钮，用于展开或折叠所有这些按钮。

我需要向按钮添加什么 javascript 才能使其工作？

这是链接： http: [//mheg.turnpostinteractive.com/about-mheg-2/staff/](http://mheg.turnpostinteractive.com/about-mheg-2/staff/)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T19:06:17.370

文档有点缺乏，但一次打开它们会是这样的：

```
$("#yourButton").click( function() {
    $(".accordion li").removeClass("active").addClass("active");
}); 
```

您首先删除课程的原因是如果您已经打开了一个课程，则不要向其中添加第二个“活动”课程。应该是这样的。显然“#yourButton 将被您添加的按钮的选择器替换以展开所有按钮。

要关闭它们，您可以使用以下命令：

```
$("accordion li").removeClass("active"); 
```

根据您希望按钮的行为方式，您可以使用切换（参见 jQuery 文档）或根据每个项目的当前状态编写自己的逻辑。您可以通过以下方式检查每个手风琴是打开还是关闭：

```
$(".accordion li:nth-child(n)").hasClass("active"); 
```

n 将是您正在检查的手风琴选项卡。

# python - 浮点布局和舍入

> ID：14283143
> 
> 赞同：2
> 
> 时间：2013-01-11T17:08:26.733
> 
> 标签：python, layout, rendering

我在渲染树中有一个节点，它根据它的子节点计算它的高度。位置和大小值允许为浮点值，在渲染时进行舍入。

```
 def compute_size(self):
        # Invokes compute_size() of child nodes.
        super(InlineBoxNode, self).compute_size()

        # Iterate over all children and compute the current nodes
        # height.
        self.h = 0
        for node in self.children:
            self.h += node.h 
```

我面临的问题如下：想象两个节点是上面代码节点的子节点。两个孩子的身高都是`10.5`. 子节点被布置在它们各自的前一个节点之下，即节点二将被放置在`y=10.5`。在渲染时`10.5`变为`11`. 第二个节点现在是 at`y=11`并且 has `h=11`，即它的底边是 at `22`，不是`21`。（见下图演示）

**我认为这个问题可以通过总是四舍五入来解决（即到较低的相邻整数值），但语义是否正确？**

![在此处输入图像描述](../Images/27182345b342077f194bd94ee9098f81.png)

* * *

## 编辑

我刚刚意识到，即使只有四舍五入也不能解决它。第二个节点的底边现在位于`20`，但`21`应该是正确的。

![在此处输入图像描述](../Images/9a977f1cb4cf52c426b18472dc453fb8.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T17:28:22.800

所以内部表示是浮动的，实际布局是像素。必须有某种四舍五入。然后在添加之前进行相同的舍入操作，例如

```
self.h += int(node.h) 
```

在你的情况下。

# batch-file - 批处理文件：如何在有许多子文件夹的目录中找到文件的最新版本？

> ID：14283144
> 
> 赞同：0
> 
> 时间：2013-01-11T17:08:26.560
> 
> 标签：batch-file, cmd

细节：

我想在目录“A”中搜索文件：“file.jar”但是，目录 A 没有直接的任何文件。相反，它由 100 多个子文件夹组成：“a1”、“a2”、“a3”、“a4”、“a5”等。

每个子文件夹都有某个版本的“file.jar”我如何搜索和复制最新版本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T17:26:06.533

这是一个起点：考虑使用`FOR /R`for 循环遍历目录中的所有文件。ss64 提供了简要[概述。](http://ss64.com/nt/for_r.html)另请参阅 Rob van der Woude 关于在 for 循环中[读取文件属性的页面。](http://www.robvanderwoude.com/battech_fileproperties.php)这两个站点都是出色的脚本资源。

例如，以下命令将列出目录中以“a”（不区分大小写）开头的所有文件`C:\A`以及每个文件的最后修改日期，

```
FOR /R C:\A %%G IN (a*) DO @ECHO %%G %%~tG 
```

但是，查找文件版本本身有点棘手。请参阅[如何在 Windows Vista 上从批处理文件中检索文件的版本？](https://stackoverflow.com/questions/1706892/how-do-i-retrieve-the-version-of-a-file-from-a-batch-file-on-windows-vista)

# json - Sqoop HDFS 到 Couchbase：json 文件格式

> ID：14283147
> 
> 赞同：0
> 
> 时间：2013-01-11T17:08:53.237
> 
> 标签：json, hadoop, hdfs, couchbase, sqoop

我正在尝试将数据从 HDFS 导出到 Couchbase，但我的文件格式有问题。

我的配置：

*   Couchbase 服务器 2.0
*   堆栈hadoop cdh4.1.2
*   sqoop 1.4.2（用hadoop2.0.0编译）
*   couchbase/hadoop 连接器（使用 hadoop2.0.0 编译）

当我运行导出命令时，我可以轻松地以这种格式导出文件：

```
id,"value" 
```

或者

```
id,42 
```

或者

```
id,{"key":"value"} 
```

但是当我想应用一个 Json 对象时它不起作用！

```
id,{"key1":"value1,"key2":"value2"} 
```

内容在第一个逗号处被 couchbase 截断并显示在 base64 中，因为现在内容不是正确的 JSON...

所以，我的问题是文件必须如何格式化才能存储为 json 文档？

我们只能导出一个键/值文件吗？

我想从 HDFS 中导出 json 文件，就像**cbdocloader**使用本地文件系统中的文件一样......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T16:57:35.030

I think your best bet is to convert the files to tab-delimited, if you're still working on this. If you look at the Sqoop documentation ([http://archive.cloudera.com/cdh/3/sqoop/SqoopUserGuide.html#_large_objects](http://archive.cloudera.com/cdh/3/sqoop/SqoopUserGuide.html#_large_objects)), there's an option --fields-terminated-by which allows you to specify which characters Sqoop splits fields on.

If you passed it --fields-terminated-by '\t', and a tab-delimited file, it would leave the commas in place in your JSON.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T08:30:47.400

恐怕这种预期行为是 Sqoop 将您的输入文件解析为 CSV，并以逗号作为分隔符。您可能需要调整文件格式以转义分隔符或包含整个 JSON 字符串。我建议在用户指南 [1] 中阅读 Sqoop 究竟是如何处理转义分隔符和封闭字符串的。

链接：

[http://sqoop.apache.org/docs/1.4.2/SqoopUserGuide.html#id387098](http://sqoop.apache.org/docs/1.4.2/SqoopUserGuide.html#id387098)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-18T00:10:49.957

@mpiffaretti 您可以发布您的 sqoop 导出命令吗？我认为每个 JSON 对象都应该有自己的键值。 `key1 {"dataOne":"ValueOne"}` `key2 {"dataTwo":"ValueTwo"}` [http://ajanacs.weebly.com/blog](http://ajanacs.weebly.com/blog) 在您的情况下，更改如下日期可能会帮助您解决问题。

```
id,{"key":"value"}
 id2,{"key2":"value2"} 
```

如果您对此还有其他问题，请告诉我。[json] [sqoopexport] [couchbase]

# jquery - 来自控制器的 MVC javascript

> ID：14283155
> 
> 赞同：0
> 
> 时间：2013-01-11T17:09:25.267
> 
> 标签：jquery, asp.net-mvc

我看过其他关于此的帖子，但我无法让它工作。我已经尝试了一百万种不同的方法。我想要做的就是触发一些基于输入文本框和使用默认移动模板单击按钮的控制器动态生成的 javascript。我确定我做错了。我能得到的最远的是让javascript显示在页面上但不执行。

控制器

```
 [HttpPost]
    public ActionResult Index(FormCollection Form)
    {
        string injectedJS = "";
        if (! String.IsNullOrEmpty(Form["searchstring"]))
        {
           //create js
            ViewBag.injectedJS = //<created js>
            return View();
        }
        else
        {
            return View();
        }
    } 
```

共享视图

```
@RenderSection("jsheader", required: false) 
```

看法

```
@section jsheader{
 <script type="text/javascript">
     $(document).bind("pageinit", function () {
         @ViewBag.injectedJS;  
     });      
 </script>
                 }

@using (Html.BeginForm("Index", "mycontroller", FormMethod.Post))
{
<ul data-role="listview" data-inset="true">
    <li data-role="list-divider"></li>
    <li>             
             <input type="text" name="searchstring" id="searchbox" />
    </li>
</ul>

<input type="submit" id="searchbutton" autofocus="autofocus" value="Submit"                
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T17:14:51.043

Razor 视图会自动对您输出的任何数据进行编码。

您需要调用`@Html.Raw(ViewBag.injectedJS)`以防止它对 Javascript 进行 HTML 编码。

# jquery - JQuery 签名面板插件

> ID：14283157
> 
> 赞同：0
> 
> 时间：2013-01-11T17:09:32.100
> 
> 标签：jquery, grails, groovy

我一直在尝试让签名面板在 grails 中工作。在客户端，一切看起来都正常，但我一直在努力研究如何将签名保存到数据库记录中。

我尝试了几个不同的版本，最后一个版本最接近描述如何使用 php、ruby 或 python 使用 ImageMagic 等。但是，尝试在 groovy 中执行此操作让我迷失了方向，因为我对如何编码还有些陌生。另外，当它将在云代工厂上运行时，我不确定是否使用 3rd 方实用程序。

名为 SignaturePanel 的插件，看起来真的和其他的一样... [jes-sherborne/jquery-signature-panel-plugin](https://github.com/jes-sherborne/jquery-signature-panel-plugin)

这是我文件中的代码。

首先，create.gsp 包含 Javascript 代码。

```
<title><g:message code="default.create.label" args="[entityName]" /></title>
        <!--  jQuery signature element code begins here -->
        <!--[if lt IE 9]><script type="text/javascript" src="${resource(dir: 'js', file: 'excanvas.compiled.js')}"></script><![endif]-->
    <script type="text/javascript" src="${resource(dir: 'js', file: 'jquery-1.4.4.min.js')}"></script>
    <script type="text/javascript" src="${resource(dir: 'js', file: 'jquery.signature-panel.js')}"></script>

    <link rel="stylesheet" href="${resource(dir: 'css', file: 'jquery.signature-panel.css')}" type="text/css"/>

    <script type="text/javascript">

        function signatureOK(signatureData) {
            // Send the signature to the server and generate an image file.
            $.ajax({
                url:"processSignature",
                type:"POST",
                data:JSON.stringify(signatureData),
                contentType:"application/json; charset=utf-8",
                dataType:"text",
                success: function(data, textStatus, jqXHR){
                    $("#latest-signature").attr("src", data);
                },
                error: function(jqXHR, textStatus, errorThrown) {
                    console.log(textStatus);
                    console.log(errorThrown);
                }
            });
            $("#sig-panel").signaturePanel("clear");
        }

        function signatureCancel() {
            alert("Cancelled.");
        }

        $(document).ready(function() {
            $("#sig-panel").signaturePanel({
                okCallback: signatureOK,
                cancelCallback: signatureCancel
            });
        });

    </script> 
```

_form.gsp

```
<!-- Signature Panel Begins Here -->

    <label for="sig"><g:message code="salesOrder.sig.label" default="Customer Signature" /></label>
    <div class="fieldcontain" ${hasErrors(bean: salesOrderInstance, field: 'sig','error')} id="sig-panel" style="width: 500px; height: 150px; border: 0px none"></div>
    <canvas id="latest-signature" style="width: 500px; height: 150px; border: 0px none"></canvas>

<!-- End of Signature Panel --> 
```

控制器

```
// Capture Customer Signature JSON Data, Processes to Image, and Stream to Database
    @Secured(['ROLE_ADMIN','ROLE_SALES'])
    def processSignature() {
        flash.message = message(code: 'default.created.message', args: [message(code: 'salesOrder.label', default: 'Signature'), ])
        // groovy code here 
        // We need to read the JSON POST data
         InputStream body = request.getInputStream();
         log.info(body) // nothing happens here
    } 
```

这是我试图弄清楚如何在 groovy 中执行的 Ruby 示例之一。*（或者如果有更好的方法......在客户端，只需右键单击并保存图像。不太清楚为什么这对我来说太难了）

```
### Generating image files on the server using Ruby

The Ruby library uses ImageMagick to generate a `Magick::Image` object, which you can use to write image files or stream the data in a variety of formats (PNG, JPEG, etc.). By default, the function will generate an image with the same pixel measurements as were originally captured on the client. You can also specify the size of the generated image, and SignaturePanel will scale the signature appropriately to fit within these bounds.

To generate the image, you will write code like this:

```ruby
require 'signature-panel.rb'
...

post '/process-signature' do
    image = SignaturePanel::GenerateImage(request.body.read)
    filename = 'latest-signature.png'

    image.write(filename)

    # If you want to stream your PNG directly to a database instead of saving a file,
    # you can get a binary stream like this:
    # image.to_blob {self.format = "PNG"}

    content_type :text

    # Send the name of the newly-generated file to the client
    body filename
end
``` 
```

所以我的问题再次是，如何使用 groovy 将签名与所有其他表单数据一起保存到数据库中？

我也应该从我的域类中提到

```
byte[] sig

sig nullable: true, maxSize: 1048567 
```

一旦我们解决了这个挑战，我们就可以让这只小狗睡觉了；)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T01:23:23.197

我一直只是将 JSON 数据保存到文本类型字段（如 Oracle 中的 CLOB）中，然后使用库函数将其显示在页面上：

```
$("#signature-display").signaturePanel("drawClickstreamToCanvas", signatureData); 
```

`signatureData`JSON 字符串在哪里。

因此，您可以更改域类以包含

```
String sig

sig nullable: true, maxSize: 1048567 
```

这也允许你做一些我认为很酷的事情，尽管它是否有用取决于你的应用程序。您可以重新创建签名的实际签名并为其设置动画：

```
$("#signature-replay").signaturePanel("animateClickstreamToCanvas", signatureData, callback); 
```

文档解释了可选`callback`功能。不过我从来没有用过。

如果您更改部分 ajax 调用，请删除该`contentType`行，因为您发送的是直接文本并设置隐藏字段

```
type:"POST",
data:{"signature": JSON.stringify(signatureData)},
//contentType:"application/json; charset=utf-8",
success: function(data, textStatus, jqXHR){
    //set the hidden field value
    $('#sig').val(JSON.stringify(signatureData));
    //show signature on same page as preview (optional)
    $("#latest-signature").signaturePanel("drawClickstreamToCanvas", signatureData);
},
.... 
```

然后将表单中的隐藏字段添加为

```
<g:hiddenField name="sig" /> 
```

因此，现在当他们输入签名并点击“确定”时，`processSignature`实际上不会做任何事情 - 只是充当占位符。AJAX 调用将设置页面上隐藏字段的值。然后，当他们提交整个表单（以及其他数据）时，普通`save()`方法将`sig`作为另一个参数获取，并自动将其保存到`sig`域类中的字段中。

`processSignature`您可以在方法中将数据作为普通字符串访问，就`params.signature`好像您需要：

```
def processSignature() {
    flash.message = message(code: 'default.created.message', args: [message(code: 'salesOrder.label', default: 'Signature'), ])
    def signature = params.signature
    log.info(signature)
    response.contentType = "application/json"
    render """{"ok":true}"""
} 
```

# ios - 使用 UISplitViewController 而不是仅创建具有 2 个子视图的单个 UIViewController 有什么好处

> ID：14283162
> 
> 赞同：1
> 
> 时间：2013-01-11T17:10:00.210
> 
> 标签：ios, ios5, ios6

对于 iPad 应用程序，我意识到拥有 UISplitViewController 允许您将 childViewControllers 嵌入到 parentViewController 中，并且 childViewControllers 能够控制左右子视图中的每一个。但是，我想知道这样做与仅使用充当左右子视图的 ViewController 的 UIViewController 相比是否有任何内在优势？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:43:29.577

编写自己的而不是使用 UISplitViewController 的主要优点是您可以根据需要自定义它。内置 UISplitViewController 不能用作子视图控制器，这可能是您的应用程序的要求。

请记住，如果您不需要任何特别的东西，您应该坚持使用 Apple 已经提供的内容。您必须维护的代码越少越好。话虽如此，实际上并不需要那么多代码来编写自己的代码。我的自定义实现大约有 250 行，并且具有所有相同的委托方法甚至演示手势（向右滑动以显示，向左滑动/点击细节以隐藏）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T17:18:39.623

最大的优势是依赖于已经编写好的框架，并且将来可能会得到改进。

拆分视图控制器在 iOS5 和 iOS6 之间经历了一次重大升级，在设备处于纵向时如何显示导航端，如果您使用他们的框架，它会自动升级。

话虽如此，如果您想要一些自定义外观或功能，那么值得编写自己的，尽管根据您所做的不同，打破常见行为可能会让用户感到困惑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T17:16:39.810

> 但是，我想知道这样做与仅使用充当左右子视图的 ViewController 的 UIViewController 相比是否有任何内在优势？

1.  您不必重写所有样板代码。

2.  与手动快速破解相比，它可能设计得更好并且错误更少。

# ruby - 在 windows7 中从 ruby 访问 MS Access

> ID：14283164
> 
> 赞同：-1
> 
> 时间：2013-01-11T17:10:09.787
> 
> 标签：ruby, ms-access

我想从我的 ruby​​ 访问 MS Access 数据库。我正在使用窗口平台。谁能帮我解决这个问题？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T18:25:19.633

您将需要使用 win32ole 库 该站点向您展示如何连接以访问 2003 数据库[http://rubyonwindows.blogspot.com/2007/06/using-ruby-ado-to-work-with-ms-access.html](http://rubyonwindows.blogspot.com/2007/06/using-ruby-ado-to-work-with-ms-access.html) , 如果您使用的是较新版本的 office，您可能需要更改一些内容

# ios - iOS Tumblr 撰写视图

> ID：14283165
> 
> 赞同：1
> 
> 时间：2013-01-11T17:10:10.083
> 
> 标签：ios, uitextview

我怎样才能实现以下外观，它们有一个标题，然后是分隔线和一个输入正文的区域。看起来好像几乎是一个 UITextView

![在此处输入图像描述](../Images/abbeb4d236a14a722c0796ebf9807b2d.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T17:13:25.200

很简单，他们使用两个字段。第一个是 UITextfield，允许您使用将在用户开始输入时删除的灰色占位符文本。然后添加一行简单的图像，最后添加一个 UITextView，让您拥有多行正文文本。

**编辑：**要从文本字段中删除圆角边框，在代码中使用：

```
[myTextField setBorderStyle:UITextBorderStyleNone]; 
```

或者在 Interface Builder 的属性检查器中：

![在此处输入图像描述](../Images/5870bd415da614d4cbedcef9004b5f7b.png)

这是一个更详细但基本的解释：

```
UITextField *myTextField = [[UITextField alloc] initWithFrame:CGRectMake(0.0f, 0.0f, self.view.bounds.size.width, 44.0f)];
[myTextField setBorderStyle:UITextBorderStyleNone];
[myTextField setPlaceholder:@"Title (optional)"];
[self.view addSubview:myTextField];

UIView *blackLineView = [[UIView alloc] initWithFrame:CGRectMake(0.0f, myTextField.frame.origin.y + myTextField.frame.size.height, self.view.bounds.size.width, 3.0f)];
[blackLineView setBackgroundColor:[UIColor colorWithWhite:0.0f alpha:0.4f]];
[self.view addSubview:blackLineView];

UITextView *myTextView = [[UITextView alloc] initWithFrame:CGRectMake(0.0f, blackLineView.frame.origin.y + blackLineView.frame.size.height, self.view.bounds.size.width, 200.0f)];
[self.view addSubview:myTextView]; 
```

# c++ - 在编译 c++ 控制台我的程序时，我在包含的矢量头文件中收到错误，这可能吗？

> ID：14283170
> 
> 赞同：0
> 
> 时间：2013-01-11T17:10:33.507
> 
> 标签：c++, compiler-construction, vector, warnings

这是完整的错误信息

```
> In file included from
> c:\mingw\bin\../lib/gcc/mingw32/4.7.2/include/c++/vector:63:0,
>                      from PlayerDatabase.h:4,
>                      from PlayerDatabase.cpp:6: 

c:\mingw\bin\../lib/gcc/mingw32/4.7.2/include/c++/bits/stl_construct.h:
> In function 'void std::_Construct(_T1*, const _T2&)':

> c:\mingw\bin\../lib/gcc/mingw32/4.7.2/include/c++/bits/stl_construct.h:85:13:
> error: expected type-specifier before 'static_cast'

> c:\mingw\bin\../lib/gcc/mingw32/4.7.2/include/c++/bits/stl_construct.h:85:13:
> error: expected ')' before 'static_cast'

> c:\mingw\bin\../lib/gcc/mingw32/4.7.2/include/c++/bits/stl_construct.h:85:13:
> error: expected ';' before 'static_cast' 
```

PlayerDatabase.h:4 中包含的文件是矢量头文件

我在我的 cpp 文件中使用了动态转换，在通过 push_baxk() 将它们插入向量之前将投手和击球手指针更改为基类棒球运动员指针，这是问题吗？

这是 playerdatabase.h 文件

```
#include <vector>
#include "BaseballPlayer.h"
#include "Hitter.h"
#include "Pitcher.h" 
```

// 这是玩家数据库类定义

```
class PlayerDatabase {

public:
    PlayerDatabase();
    PlayerDatabase(PlayerDatabase&);
    PlayerDatabase& operator= (PlayerDatabase&);
    ~PlayerDatabase();
    void print_team(std::ofstream&);
    void load_team(std::ifstream&);
    void create_good_team();
    void create_small_team();
    int get_team_count();

private:
    std::vector<BaseballPlayer*> team;
}; 
```

这是 playerdatabase.cpp

```
#include <iomanip>
#include "cppMemDbg.h"
#include "PlayerDatabase.h"

const char HITTER='H';
const char PITCHER='P';
const int REDUCE_BY=4; 
```

// 没有参数的默认构造函数

```
PlayerDatabase::PlayerDatabase(){ 
```

}

// 复制构造函数

```
PlayerDatabase::PlayerDatabase(PlayerDatabase& right){
std::vector<BaseballPlayer*>::iterator begin, end;
begin=right.team.begin();
end=right.team.end();

while (begin!=end){
    Pitcher* pPlayer= dynamic_cast<Pitcher*>(*begin);
    if (pPlayer){
        Pitcher* pitcher= new Pitcher(*pPlayer);
        team.push_back(dynamic_cast<BaseballPlayer*>(pitcher));
    }

    else{
        Hitter* hPlayer= dynamic_cast<Hitter*>(*begin);
        Hitter* hitter= new Hitter(*hPlayer);
        team.push_back(dynamic_cast<BaseballPlayer*>(hitter));
    }

    begin++;
} 
```

}

// 赋值运算符

```
PlayerDatabase& PlayerDatabase::operator= (PlayerDatabase& right){
if (team==right.team)
    return *this;

else {
    std::vector<BaseballPlayer*>::iterator begin, end;
    begin=right.team.begin();
    end=right.team.end();

    while (begin!=end){

        Pitcher* pPlayer= dynamic_cast<Pitcher*>(*begin);
        if (pPlayer){
            Pitcher* pitcher= new Pitcher(*pPlayer);
            BaseballPlayer* bplayer= dynamic_cast<BaseballPlayer*>(pitcher);
            team.push_back(bplayer);
        }

        else{
            Hitter* hPlayer= dynamic_cast<Hitter*>(*begin);
            Hitter* hitter= new Hitter(*hPlayer);
            BaseballPlayer* bplayer= dynamic_cast<BaseballPlayer*>(hitter);
            team.push_back(bplayer);
        }
        begin++;
    }
}
return *this; 
```

}

// 析构函数

```
PlayerDatabase::~PlayerDatabase(){
std::vector<BaseballPlayer*>::iterator iter;
for (iter=team.begin();iter!=team.end();iter++){
    if (*iter)
        delete *iter;
    *iter=nullptr;
}
team.clear(); 
```

}

// 将棒球运动员打印到标准输出并将它们写入给定文件的函数

```
void PlayerDatabase::print_team(std::ofstream& outputFile){
int totalHits=0, totalAtBats=0, totalEarnedRuns=0;
float totalInningsPitched=0.0;

std::vector<BaseballPlayer*>::iterator begin, end;
begin=team.begin();
end=team.end();
int member=1;

while (begin!=end){
    std::cout<<"Member "<<member<<std::endl;
    (*begin)->print_player(outputFile);

    Pitcher* pPlayer= dynamic_cast<Pitcher*>(*begin);
    if (pPlayer){
        totalEarnedRuns+=pPlayer->earnedRuns;
        totalInningsPitched+=pPlayer->inningsPitched;
        begin++;
        member++;
    }

    else{
        Hitter* hPlayer= dynamic_cast<Hitter*>(*begin);
        totalHits+=hPlayer->hits;
        totalAtBats+=hPlayer->atBats;
        begin++;
        member++;
    }

}

if(totalAtBats==0||totalInningsPitched==0.0){

    if(totalAtBats==0&&totalInningsPitched==0.0){
        std::cout<<"Team Batting Average: "<<"n/a"<<std::endl;
        std::cout<<"Team ERA: "<<"n/a"<<std::endl;
    }
    else if (totalAtBats==0){
        std::cout<<"Team Batting Average: "<<"n/a"<<std::endl;
        std::cout<<"Team ERA: "<<(totalEarnedRuns/totalInningsPitched*9)<<std::endl;
    }
    else {
        std::cout<<"Team Batting Average: "<<std::fixed<<std::setprecision(3)<<totalHits/(double)totalAtBats<<std::endl;
        std::cout<<"Team ERA: "<<"n/a"<<std::endl;
    }
}

else{
    std::cout<<"Team Batting Average: "<<std::fixed<<std::setprecision(3)<<totalHits/(double)totalAtBats<<std::endl;
    std::cout<<"Team ERA: "<<(totalEarnedRuns/totalInningsPitched*9)<<std::endl;
} 
```

}

// 从格式化的输入文件中加载棒球运动员

```
void PlayerDatabase::load_team(std::ifstream& input){
int counter=1;
while (!input.eof()){
    char playerType;
    input.get(playerType);

    if (playerType==HITTER){
        Hitter* hitter= new Hitter;
        hitter->load_player(input);
        std::cout<<"Loading member "<<counter<<std::endl;
        team.push_back(dynamic_cast<BaseballPlayer*>(hitter));
        counter++;
    }

    else if (playerType==PITCHER){
        Pitcher* pitcher= new Pitcher;
        pitcher->load_player(input);
        std::cout<<"Loading member "<<counter<<std::endl;
        team.push_back(dynamic_cast<BaseballPlayer*>(pitcher));
        counter++;
    }

} 
```

}

// 通过消除一些基于 goodHitter() 和 goodPitcher() 函数的函数来创建一个好的团队

```
void PlayerDatabase::create_good_team(){

std::vector<BaseballPlayer*> goodTeam;

std::vector<BaseballPlayer*>::iterator begin, end;
begin=team.begin();
end=team.end();

while (begin!=end){

    Pitcher* pPlayer= dynamic_cast<Pitcher*>(*begin);
    if (pPlayer){
        if(pPlayer->goodPitcher()){

            goodTeam.push_back(dynamic_cast<BaseballPlayer*>(pPlayer));
        }
        else {
            if (*begin)
                delete *begin;
            *begin=nullptr;
        }
        begin++;
    }

    else{
        Hitter* hPlayer= dynamic_cast<Hitter*>(*begin);
        if(hPlayer->goodHitter()){
            goodTeam.push_back(dynamic_cast<BaseballPlayer*>(hPlayer));
        }
        else {
            if (*begin)
                delete *begin;
            *begin=nullptr;
        }
        begin++;
    }
}
team.clear();
team=goodTeam; 
```

}

// 创建一个小团队，删除向量中的前四个玩家

```
void PlayerDatabase::create_small_team(){
if(get_team_count()>=REDUCE_BY){
    std::vector<BaseballPlayer*>::iterator first, fifth;
    first= team.begin();
    fifth=first+REDUCE_BY;

    while (first!=fifth){
        if (*first)
            delete *first;
        *first=nullptr;
        first++;
    }
    team.erase(team.begin(),fifth);
}

else {
    std::vector<BaseballPlayer*>::iterator first,last;
    first= team.begin();
    last=team.end();
    while(first!=last){
        if (*first)
            delete *first;
        *first=nullptr;
        first++;
    }
    team.clear();
} 
```

} // 团队成员的数量

```
int PlayerDatabase::get_team_count(){
return team.size(); 
```

}

这部分有什么问题吗？

```
 std::vector<BaseballPlayer*>::iterator begin, end;
 begin=right.team.begin();
 end=right.team.end(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T18:17:38.597

那是很多代码！但是有几件事可以说是错误的：

```
PlayerDatabase(PlayerDatabase&); // this is the one the error is complaining about 
```

这声明了一个*可变的复制构造函数*。如果你想要那很好，但你可能不想要。你想要这个：

```
PlayerDatabase(PlayerDatabase const&); 
```

您的*赋值运算符*也是如此，除非它需要修改源（并且您不想这样做），否则它应该是：

```
PlayerDatabase& operator= (PlayerDatabase const&); 
```

我在你的整个代码中没有看到一个`const`限定符，所以你可能不知道*const-correctness*。您应该对该主题进行一些研究，但它基本上说明了操作是否会修改给定的参数。

# caching - 如何在 x86 中使用 CPUID 指令接收 L1、L2 和 L3 缓存大小

> ID：14283171
> 
> 赞同：7
> 
> 时间：2013-01-11T17:10:32.873
> 
> 标签：caching, x86, intel, cpu-cache, cpuid

我在准备一个汇编程序 x86 项目时遇到了一个问题，该项目的主题是编写一个获取 L1 数据、L1 代码、L2 和 L3 缓存大小的程序。

我试图在英特尔文档和互联网上找到一些东西，但我失败了。

主要问题是：对于 AMD 处理器，只需将 EAX 寄存器设置为 80000005h 和 80000006h 值并从 ECX 和 EDX 寄存器中获取所需的数据，但对于英特尔，我只能为 L2 获取此信息。

我应该怎么做才能获得英特尔处理器的 L1 和 L3 缓存大小？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-07-11T14:37:27.320

Marat Dukhan 基本上给了你正确的答案。对于较新的英特尔处理器，即过去 5-6 年制造的处理器，最好的解决方案是枚举 cpuid 叶 4，这意味着您调用 cpuid 几次，首先使用 EAX=4 和 ECX=0，然后使用 EAX= 4和ECX = 1等等。这不仅会返回有关缓存大小和类型的信息，还会告诉您这些缓存如何连接到 CPU 内核和超线程/SMT 单元。算法和示例代码在[https://software.intel.com/en-us/articles/intel-64-architecture-processor-topology-enumeration/](https://software.intel.com/en-us/articles/intel-64-architecture-processor-topology-enumeration/)中给出，更具体地说，在标题为“缓存拓扑枚举”的部分中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-10-30T11:40:32.653

您可以使用 CPUID 指令获取 CPU L1、L2 和 L3 缓存大小。根据 Intel x86 Software Developer's Manual Volume 2 (Instruction Set Reference)。您可以通过 EAX 等于 2 或 4 的 CPUID insturciton 获取 CPU 缓存信息。EAX=2 是旧版本，似乎较新的 CPU 不使用它。所以我将介绍 EAX=4 的情况。

其输出格式为：

[![CPUID4_1](../Images/d8b5630b2e7ac5ed18390731c56230b8.png)](https://i.stack.imgur.com/HrQaO.png)

[![CPUID4_2](../Images/86a6775176669de70dc2587fdbb6a5c0.png)](https://i.stack.imgur.com/ZUXGw.png)

因此，您可以使用以下公式计算缓存大小：

缓存大小 = (Ways + 1) * (Partitions + 1) * (Line_Size + 1) * (Sets + 1) 或

缓存大小 = (EBX[31:22] + 1) * (EBX[21:12] + 1) * (EBX[11:0] + 1) * (ECX + 1)

例如，我在我的 ubuntu 系统中执行“cpuid -li”指令，得到以下输出：

```
 deterministic cache parameters (4):
  --- cache 0 ---
  cache type                           = data cache (1)
  cache level                          = 0x1 (1)
  self-initializing cache level        = true
  fully associative cache              = false
  extra threads sharing this cache     = 0x1 (1)
  extra processor cores on this die    = 0x7 (7)
  system coherency line size           = 0x3f (63)
  physical line partitions             = 0x0 (0)
  ways of associativity                = 0x7 (7)
  ways of associativity                = 0x0 (0)
  WBINVD/INVD behavior on lower caches = false
  inclusive to lower caches            = false
  complex cache indexing               = false
  number of sets - 1 (s)               = 63
  --- cache 1 ---
  cache type                           = instruction cache (2)
  cache level                          = 0x1 (1)
  self-initializing cache level        = true
  fully associative cache              = false
  extra threads sharing this cache     = 0x1 (1)
  extra processor cores on this die    = 0x7 (7)
  system coherency line size           = 0x3f (63)
  physical line partitions             = 0x0 (0)
  ways of associativity                = 0x7 (7)
  ways of associativity                = 0x0 (0)
  WBINVD/INVD behavior on lower caches = false
  inclusive to lower caches            = false
  complex cache indexing               = false
  number of sets - 1 (s)               = 63
  --- cache 2 ---
  cache type                           = unified cache (3)
  cache level                          = 0x2 (2)
  self-initializing cache level        = true
  fully associative cache              = false
  extra threads sharing this cache     = 0x1 (1)
  **extra processor cores on this die    = 0x7 (7)
  system coherency line size           = 0x3f (63)
  physical line partitions             = 0x0 (0)**
  ways of associativity                = 0x3 (3)
  ways of associativity                = 0x0 (0)
  WBINVD/INVD behavior on lower caches = false
  inclusive to lower caches            = false
  complex cache indexing               = false
  number of sets - 1 (s)               = 1023
  --- cache 3 ---
  cache type                           = unified cache (3)
  cache level                          = 0x3 (3)
  self-initializing cache level        = true
  fully associative cache              = false
  extra threads sharing this cache     = 0xf (15)
  extra processor cores on this die    = 0x7 (7)
  system coherency line size           = 0x3f (63)
  physical line partitions             = 0x0 (0)
  ways of associativity                = 0xb (11)
  ways of associativity                = 0x6 (6)
  WBINVD/INVD behavior on lower caches = false
  inclusive to lower caches            = true
  complex cache indexing               = true
  number of sets - 1 (s)               = 12287 
```

L1数据缓存大小为：(7+1) *(0+1)* (63+1)*(63+1)=32K

L3缓存大小为：(11+1) *(0+1)* (63+1)*(12287+1)=9M

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-10-30T14:15:39.370

对于英特尔 CPU：

*   对于较新的 CPU，您应该使用“CPUID, eax=0x00000004”（ECX 中的值不同）

*   对于较旧的 CPU（不支持第一个选项），您应该使用“CPUID，eax=0x00000002”。这涉及有一个表格来查找这些值的含义。在某些情况下，相同的值对不同的 CPU 意味着不同的东西，您需要额外的信息（例如 CPU 系列/型号/步进）。

对于威盛 CPU；使用与英特尔相同的方法（对于涉及“系列/型号/步进”的任何内容，使用不同的表格）。

对于 AMD CPU：

*   对于较新的 CPU，您应该使用“CPUID，eax=0x8000001D”（ECX 中的值不同）

*   对于较旧的 CPU（不支持第一个选项），您应该使用“CPUID, eax=0x80000006”（仅适用于 L2 和 L3），加上“CPUID, eax=0x80000005”（仅适用于 L1）。

对于所有其他情况（非常旧的 Intel/VIA/AMD CPU，其他制造商的 CPU）：

*   使用 CPU “vendor/family/model/stepping”（来自“CPUID，eax=0x0000001”）和一个表（或者每个供应商可能 1 个表），这样您就可以在表中搜索正确的 CPU 并获取以下信息方法。

*   如果`CPUID`不支持，则可以尝试缩小可能性并以合理的准确度确定 CPU 是什么；但大多数情况下你应该放弃。

此外; 对于所有 CPU，您应该浏览勘误表以查看 CPUID 是否提供了错误信息；并实施变通方法来纠正错误信息。

请注意（取决于您支持的 CPU 范围以及您希望您的代码有多棒）可能需要几个月的工作才能提取有关缓存的可靠信息。

# java - 视频读取器/写入器程序 xuggler 不工作

> ID：14283172
> 
> 赞同：4
> 
> 时间：2013-01-11T17:10:36.390
> 
> 标签：java, xuggler

我已经下载了 Xuggler 并将 Jar 文件添加到 Eclipse 库中，我为 java 编写了一些代码来获取 flv 文件并将其转换为 mov：

```
public class Main {

    public static void main(String[] args) {
        IMediaReader reader = ToolFactory.makeReader("res/input.flv");
        IMediaWriter writer = ToolFactory.makeWriter("res/output.mov", reader);
        reader.addListener(writer);
        while(reader.readPacket() == null);
}} 
```

我的 flv 文件也在 eclipse 中名为 res 的文件夹下。

当我运行此代码时，我收到以下错误：

```
 Exception in thread "main" java.lang.RuntimeException: could not open stream com.xuggle.xuggler.IStream@269225200[index:0;id:0;streamcoder:com.xuggle.xuggler.IStreamCoder@3536496[codec=com.xuggle.xuggler.ICodec@269351856[type=CODEC_TYPE_VIDEO;id=CODEC_ID_H264;name=libx264;];time base=1/15;frame rate=0/0;pixel type=YUV420P;width=235;height=217;];framerate:0/0;timebase:1/90000;direction:OUTBOUND;]: Operation not permitted
    at com.xuggle.mediatool.MediaWriter.openStream(MediaWriter.java:1192)
    at com.xuggle.mediatool.MediaWriter.getStream(MediaWriter.java:1052)
    at com.xuggle.mediatool.MediaWriter.encodeVideo(MediaWriter.java:742)
    at com.xuggle.mediatool.MediaWriter.encodeVideo(MediaWriter.java:783)
    at com.xuggle.mediatool.MediaWriter.onVideoPicture(MediaWriter.java:1434)
    at com.xuggle.mediatool.AMediaToolMixin.onVideoPicture(AMediaToolMixin.java:166)
    at com.xuggle.mediatool.MediaReader.dispatchVideoPicture(MediaReader.java:610)
    at com.xuggle.mediatool.MediaReader.decodeVideo(MediaReader.java:519)
    at com.xuggle.mediatool.MediaReader.readPacket(MediaReader.java:475)
    at Main.main(Main.java:12) 
```

这些错误是什么意思，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-02T11:21:49.840

我们碰巧在我们的实验室中使用了完全相同的代码，它总是像一个魅力一样工作。事实上，我将您的代码复制到了我的一个 Eclipse 项目中。我从网上下载了 FLV 文件，并使用您的代码成功地将它们转换为 MOV。

我的学生经常报告与 Xuggler 一起项目设置的问题。也许您愿意将您的项目重新配置为迄今为止从未让我们失望过的 Maven。在 Maven 依赖平台相关库会自动正确添加到 Eclipse 项目中。

在 Kepler 版本中，作为 Eclipse 的 Maven 管理的 M2 模块是主线的一部分。这样应该很容易创建一个 Maven 项目。之后只需将以下存储库和依赖项添加到您的 pom.xml 即可。

**存储库：**

 `````
<repositories>
    <repository>
        <id>xuggle repo</id>
        <url>http://xuggle.googlecode.com/svn/trunk/repo/share/java/</url>
    </repository>
</repositories> 
````  `**依赖项：**

 `````
<dependencies>
    <dependency>
        <groupId>xuggle</groupId>
        <artifactId>xuggle-xuggler</artifactId>
        <version>5.4</version>
    </dependency>
</dependencies> 
````  `如前所述，在这样的项目设置中，您的代码正在运行。供您参考，我们在 MacOS 10.9.4 和 Java 7 上进行了测试。````

# c# - 实体框架 System.InvalidOperationException

> ID：14283175
> 
> 赞同：0
> 
> 时间：2013-01-11T17:10:47.883
> 
> 标签：c#, entity-framework

我在 2 个不同的类中使用实体框架容器。

```
private static DataManager instance;
    private Model1Container databaseContainer;
    private DataManager()
    {
        databaseContainer = new Model1Container();
    }

    public static IDataManager Instance
    {
        get
        {
            if (instance == null)
            {
                instance = new DataManager();
            }
            return instance;
        }
    }

    public void OpenNewAccount(int amount)
    {

        Account account = new Account();

        Transaction transaction = new Transaction();
        transaction.Account = account;
        transaction.Amount = amount;
        transaction.Date = DateTime.Now;

        if (TransactionExecutor.Instance.ExecuteTransaction(transaction, account))
        {
            //EXCEPTION An unhandled exception of type                   'System.InvalidOperationException' occurred in System.Data.Entity.dll

            //Additional information: An entity object cannot be referenced by multiple instances of IEntityChangeTracker.
            databaseContainer.Transactions.AddObject(transaction);
            databaseContainer.Accounts.AddObject(account);
            databaseContainer.SaveChanges();
        }
    }

class AccountStateTransactionValidator : AbstractTransactionValidator
{
    override
    public bool HandleTransaction(Transaction transaction, Account account)
    {
        if (account.AccountState == null || (account.Amount < account.AccountState.LeftBound || account.Amount >= account.AccountState.RightBound))
        {
            Model1Container container = new Model1Container();
            AccountState properState = (from st in container.AccountStates
                              where st.LeftBound <= account.Amount &&
                              st.RightBound >= account.Amount
                              select st).FirstOrDefault();
            if (properState != null)
            {
               account.AccountState = properState;
            }
            else
            {
                return false;
            }
        }

        return base.nextTransaction(transaction, account);

    }
} 
```

我得到了这个例外：

```
 at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
   at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
   at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
   at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.ThreadHelper.ThreadStart()</ExceptionString></Exception></TraceRecord>
An unhandled exception of type 'System.InvalidOperationException' occurred in System.Data.Entity.dll` 
```

我不想修改我的类结构，在这种情况下我可以正确使用实体框架吗？如何？

感谢您的回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T17:16:55.720

您正在混合多个数据上下文：`account`附加到`databaseContainer`( `databaseContainer.Transactions.AddObject(transaction);`with`account`作为嵌套属性 from `transaction`) 但来自`Model1Container container = new Model1Container();`.

您不能同时在多个上下文中使用实体的实例。

* * *

我还看到了某种数据容器的单例模式，这通常是一个坏、坏、坏的主意......

# javascript - “裁剪”图像的脚本间歇性地运行。

> ID：14283177
> 
> 赞同：0
> 
> 时间：2013-01-11T17:10:55.690
> 
> 标签：javascript, css, wordpress

我正在使用一些 javascript 来使图像看起来被裁剪。我基本上找到高度超过 400 像素的图像，找出超过 400 像素的像素数，将其拆分，然后在顶部和底部设置负边距。然后我将图像包装在充当框架的 div 中，图像位于框架后面

出于某种原因，脚本偶尔会运行。有时，它会正确裁剪所有`.featured-image img`高度超过 400 像素的图像（主页上只有一张特色图像，并且需要裁剪）。其他时候，脚本不会检测到任何此类图像，因此不会进行裁剪。

我在调用中运行脚本`$(document).ready()`，所以我不确定是什么导致了似乎是竞争条件。

**链接**

站点： http: [//new.technoheads.org/](http://new.technoheads.org/)（刷新几次看我的意思）

脚本： http: [//new.technoheads.org/wp-content/themes/Technoheads-Theme/js/app.js](http://new.technoheads.org/wp-content/themes/Technoheads-Theme/js/app.js) （有问题的行是13-20）

不正确：[http ://technoheads.org/grabs/DK6.png](http://technoheads.org/grabs/DK6.png)

正确：[http ://technoheads.org/grabs/GQP.png](http://technoheads.org/grabs/GQP.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T17:13:46.947

您正在检查`height`图像的属性，这些属性不一定存在于文档就绪（文档就绪并不意味着图像已加载）。要么将该函数绑定在 内`$(window).load()`，要么绑定一个`$('img').load()`函数。

例子：

```
$(".featured-image img").load(function() {
    var $e = $(this);

    if ( $e.height < 400 ) return;

    var overflow = featuredHeight - $e.height();
    var top      = overflow / 2;
    var bottom   = overflow / 2;

    if ( overflow % 2 == 1 ) top++;

    $e.css({
        "margin-top": top + "px", 
        "margin-bottom": bottom + "px"
    });
}); 
```

# javascript - Javascript/JQ 特定时间后删除内容（计时器）

> ID：14283181
> 
> 赞同：0
> 
> 时间：2013-01-11T17:11:01.283
> 
> 标签：javascript, jquery, html

我只是想知道是否可以创建一个功能，其中您有一个计时器/时钟滴答作响，当没有时间时，文本/图像将被删除。还会有一条消息/文本显示通知用户。（JQuery 或 Java）

我已经使用 replace.child 尝试过，但没有任何有希望的结果。

我也四处寻找任何类似的物体，但没有找到。

-谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:32:46.817

干得好：

```
(function(){
  var secondsLeft = 10,
      $timerElm   = $('#timer');

  function updateTimer () {

    $timerElm.text(secondsLeft--);

    if (secondsLeft < 0) timesUp();
    else setTimeout(updateTimer, 1000);
  } 

  function timesUp () {
    $('#target').remove();

    $('<p>works like a charm!</p>').prependTo('body').hide().fadeIn()

  }

  updateTimer();
})() 
```

这里还有一个现场演示！ [http://jsbin.com/aguyuw/1/edit](http://jsbin.com/aguyuw/1/edit)

请享用！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T17:15:30.423

您可以使用 setTimeout 功能...

```
setTimeout(function() { $('#some_id').fadeOut('slow');}, 2000); 
```

这里 2000 是一个可选值...您可以根据需要进行更改...如果您想快速淡出，您可以使用“快”而不是“慢”...

对于 javascript，您可以使用类似这样的东西....

```
setTimeout(function(){you_function();},3000); 
```

# python - 在 Tkinter Canvas 上添加不可见的按钮/可点击区域

> ID：14283186
> 
> 赞同：1
> 
> 时间：2013-01-11T17:11:13.363
> 
> 标签：python, canvas, tkinter

我正在写一个游戏，它有应该是可点击的节点。我正在考虑使用标签绑定将这些实现为带有回调函数的椭圆。唯一的问题是画布上的隐藏对象似乎不响应事件。

有没有一种好方法来实现用户不可见的可点击屏幕区域（例如命中框）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T20:50:50.537

创建椭圆形 (canvas.create_oval) 时，传递参数

```
fill="" 
```

和

```
outline="" 
```

保持椭圆透明并删除轮廓的选项。椭圆现在有效隐藏。

# spring - weblogic上的@Webservice注释异常

> ID：14283188
> 
> 赞同：5
> 
> 时间：2013-01-11T17:11:16.997
> 
> 标签：spring, weblogic, jax-ws, jdeveloper

我正在尝试使用 JDK 1.6.0_31-b05 中的 JDeveloper 11g R2(11.1.2.3.0) 运行包含 JAX WS (2.1) Webservice 的应用程序。错误来自类上存在的 @WebService 注释。
当我运行应用程序时，出现以下错误，

> ```
> java.lang.IllegalArgumentException: Argument(s) "type" can't be null.
>   at com.sun.xml.bind.api.TypeReference.<init>(TypeReference.java:89)
>   at com.sun.xml.ws.model.RuntimeModeler.processDocWrappedMethod(RuntimeModeler.java:758)
>   at com.sun.xml.ws.model.RuntimeModeler.processMethod(RuntimeModeler.java:678)
>   at com.sun.xml.ws.model.RuntimeModeler.processClass(RuntimeModeler.java:428)
>   at com.sun.xml.ws.model.RuntimeModeler.buildRuntimeModel(RuntimeModeler.java:277)
>   at com.sun.xml.ws.server.EndpointFactory.createSEIModel(EndpointFactory.java:363)
>   at com.sun.xml.ws.server.EndpointFactory.createEndpoint(EndpointFactory.java:202)
>   at com.sun.xml.ws.api.server.WSEndpoint.create(WSEndpoint.java:496)
>   at com.sun.xml.ws.api.server.WSEndpoint.create(WSEndpoint.java:539)
>   at weblogic.wsee.jaxws.JAXWSDeployedServlet.getEndpoint(JAXWSDeployedServlet.java:183) 
> ```

嵌入式 Web Logic 似乎使用的是内部库，而不是 JDK 提供的库。JDK rt.jar 中存在的类`RuntimeModeler`或类以包 com.sun.xml.ws.internal 开头。`TypeReference`Weblogic 正在从 glassfish.jaxb_1.0.0.0_2-1-12.jar 和 glassfish.jaxws.rt_1.2.0.0_2-1-5.jar 中挑选这些类，但这些 jar 不是我的应用程序的一部分。

1.  我已经使用了带有以下标签的 weblogic.xml，

    ```
    <prefer-web-inf-classes>true</prefer-web-inf-classes> 
    ```

2.  我尝试在 DefaultDomain/lib 目录中添加 jaxws-api.jar 和 jws-api.jar，但这不起作用

任何线索如何解决此异常或如何强制 weblogic 使用 jdk 运行时类？相同的应用程序在独立的 weblogic 上正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-06-05T08:01:05.727

我有同样的问题，在这里找到了答案：http: [//www.intropro.com/resources/blog/66-argument-s-type-can-t-be-null](http://www.intropro.com/resources/blog/66-argument-s-type-can-t-be-null)

简而言之 - 出现问题是因为您的类路径中有 jaxb-impl，它覆盖了 WebLogics 自己的 jaxb，您可能没有从 pom.xml 中明确引用此依赖项，但您的其他一些依赖项确实如此。在我的情况下，我有 apache-cxf 作为 maven 依赖项，它有 jaxb 2.1.13 作为范围“编译”的子依赖项。我所要做的就是排除这个 apaches jaxb 并添加我自己的依赖项，其范围为“provided”以显式使用 WebLogics jaxb。

在 pom.xml 中它看起来像这样：

```
<dependency>
    <groupId>org.apache.cxf</groupId>
    <artifactId>cxf-rt-frontend-jaxws</artifactId>
    <version>2.7.2</version>
    <exclusions>
        <exclusion>
            <artifactId>jaxb-impl</artifactId>
            <groupId>com.sun.xml.bind</groupId>
        </exclusion>
    </exclusions>
</dependency>

<dependency>
    <groupId>com.sun.xml.bind</groupId>
    <artifactId>jaxb-impl</artifactId>
    <scope>provided</scope>
    <version>2.1.13</version>
</dependency> 
```

您可以在 pom.xml 视图中使用 Eclipse 的“Dependency Hierarchy”选项卡，或者简单地使用命令行“mvn dependency:tree”来了解 jaxb-impl 是如何进入您的类路径的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-16T21:18:22.397

就我而言，我在操作的参数中有一个错字，其中两个参数具有相同的 webParam 名称。修改并部署，问题得到解决。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T17:03:14.277

您是否尝试在清单 class-path: 属性中列出正确的 jar？您还可以将 jdk 类放在应用程序中，并尝试使用 FilteringClassLoader 来指定要从应用程序而不是系统类加载器使用的类。

[http://docs.oracle.com/cd/E15051_01/wls/docs103/programming/classloading.html#wp1097263](http://docs.oracle.com/cd/E15051_01/wls/docs103/programming/classloading.html#wp1097263)

# java - Java中JTable的两个单元格之间的乘法

> ID：14283192
> 
> 赞同：0
> 
> 时间：2013-01-11T17:11:31.533
> 
> 标签：java, swing, jtable

当我在“Units”和“Price”列的第一行的单元格中输入值时，“Amount”列；列单元格值应设置为 unit 和 amount 的乘积。我应该使用哪个监听器？请帮忙，因为我是 Java 新手。

**代码：**

```
 JTable jTable1;
 DefaultTableModel mod=new DefaultTableModel();
        mod.addColumn("No");
        mod.addColumn("Item ID");
        mod.addColumn("Units");
        mod.addColumn("Amount");
        mod.addColumn("UOM");
        mod.addColumn("Delivery Date");
        mod.addColumn("Total Amount");
        mod.addColumn("Notes");
        mod.addColumn("Received");
        mod.addRow(new Object [][] {
            {1, null, null, null, null, null, null, null, null}
        });
        jTable1.setModel(mod);
        jTable1.setColumnSelectionAllowed(true); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T18:02:12.803

这个想法是实现一个`TableModel`，以便它自动返回单位和数量乘积的结果。这是我的意思的一个小演示（要添加新行，只需在表格下方双击）：

```
import java.awt.BorderLayout;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.util.Vector;

import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.SwingUtilities;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;
import javax.swing.table.DefaultTableModel;

public class TestTable3 {

    protected void initUI() {
        final DefaultTableModel model = new DefaultTableModel() {

            @Override
            public Class<?> getColumnClass(int columnIndex) {
                switch (columnIndex) {
                case 0:
                    return Integer.class;
                case 1:
                case 2:
                    return Double.class;
                }
                return super.getColumnClass(columnIndex);
            }

            @Override
            public Object getValueAt(int row, int column) {
                if (column == 2) {
                    Integer i = (Integer) getValueAt(row, 0);
                    Double d = (Double) getValueAt(row, 1);
                    if (i != null && d != null) {
                        return i * d;
                    } else {
                        return 0.0;
                    }
                }
                return super.getValueAt(row, column);
            }

            @Override
            public boolean isCellEditable(int row, int column) {
                return column == 0 || column == 1;
            }

            @Override
            public void setValueAt(Object aValue, int row, int column) {
                super.setValueAt(aValue, row, column);
                fireTableCellUpdated(row, 2);
            }

            @Override
            public String getColumnName(int column) {
                switch (column) {
                case 0:
                    return "Quantity";
                case 1:
                    return "Price";
                case 2:
                    return "Total";
                }
                return super.getColumnName(column);
            }

            @Override
            public int getColumnCount() {
                return 3;
            }
        };
        final JTable table = new JTable(model);
        table.setFillsViewportHeight(true);
        table.addMouseListener(new MouseAdapter() {
            @Override
            public void mouseClicked(MouseEvent e) {
                if (e.getClickCount() == 2) {
                    if (table.rowAtPoint(e.getPoint()) < 0) {
                        model.addRow(new Vector());
                    }
                }
            }
        });
        model.addRow(new Vector());
        JFrame frame = new JFrame(TestTable3.class.getSimpleName());
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        JScrollPane scrollpane = new JScrollPane(table);
        frame.add(scrollpane, BorderLayout.CENTER);
        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String[] args) throws ClassNotFoundException, InstantiationException, IllegalAccessException,
            UnsupportedLookAndFeelException {
        UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                new TestTable3().initUI();
            }
        });
    }

} 
```

结果： ![结果](../Images/8f47ed716df255db25f4d03c454cc938.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T17:22:09.290

> 当我在“Units”和“Price”列的第一行的单元格中输入值时，“Amount”列；列单元格值应设置为单位和金额的乘积

*   看看[TableModelListener](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#modelchange)

*   必须阅读[Oracle JTable 教程](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html)

# android - 如何将 menuItem 添加到 actionbarsherlock 对话框？

> ID：14283194
> 
> 赞同：0
> 
> 时间：2013-01-11T17:11:36.960
> 
> 标签：android, actionbarsherlock

我正在使用主题来`Theme.Sherlock.Dialog`显示一个对话框。现在，如何在该对话框的右上角添加菜单项？我使用此代码，但我不能。

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    menu.add("Close")
    .setIcon(R.drawable.button_close)
    .setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS);
    return true;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T18:53:53.433

请检查您是否正确设置了全息主题，并确保您已在活动的 oncreate 中初始化操作栏。如果您正确执行了这些步骤，上面的代码可以正常工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T18:37:57.143

这是不可能的。对话框的操作栏没有普通操作栏的任何功能。

ActionBarSherlock 开发者在这个[问题](https://groups.google.com/forum/?fromgroups=#!topic/actionbarsherlock/cY0CyLmFUGs)中的话。

# ruby-on-rails - Active Record Hash，希望在 .each 循环期间“注入”更多数据

> ID：14283196
> 
> 赞同：2
> 
> 时间：2013-01-11T17:11:42.450
> 
> 标签：ruby-on-rails

我有一个类别表和一个帖子表。帖子属于一个类别。我想输出所有类别的列表以及该类别中的最新帖子。

我觉得有点傻，但我已经为此工作了几个小时。我在查询类别时尝试过`join`，`include`但我遇到了仅限于每个类别的最新帖子的问题。

然后我尝试创建自己的哈希或数组，但我一直遇到问题。所以在我浪费时间之前，我认为以下将是我能想象到的下一个最干净的工作方式。

对于如何实现这一目标，我将不胜感激。

以下是我的代码（精简到最低限度）。

**数据库/schema.rb**

```
ActiveRecord::Schema.define(:version => yyyymmddhhmmss) do

  create_table "categories", :force => true do |t|
    t.string   "name"
    t.datetime "created_at",    :null => false
    t.datetime "updated_at",    :null => false
  end

  create_table "posts", :force => true do |t|
    t.string   "title"
    t.integer  "category_id"
    t.datetime "created_at",   :null => false
    t.datetime "updated_at",   :null => false
  end

end 
```

**应用程序/模型/category.rb**

```
class Category < ActiveRecord::Base
  ...
  has_many :posts
  ...
end 
```

**应用程序/模型/post.rb**

```
class Post < ActiveRecord::Base
  ...
  belongs_to :category
  ...
end 
```

**应用程序/控制器/categories_controller.rb**

```
class CategoriesController < ApplicationController
  ...
  def index
    @categories = Category.all
    # The following loop is what my question is about
    @categories.each do |c|
      latest_post = Post.where(:category_id => c.id).order('published_at DESC').first
      # "Inject" post.id and post.title in to the current @categories hash
    end
  end
  ...
end 
```

**应用程序/视图/类别/index.html.erb**

```
<% @categories.each do |c| %>
  ...
  <h4><a href="<%= category_path(c) %>"><%= c.name %></a></h4>
  # The following line is how I envision the output to work
  <p><a href="<%= post_path(c.post_id) %>"><%= c.post_title %></a></p>
  ...
<% end %> 
```

`raise @categories.to_yaml` **前**

```
---
- !ruby/object:Category
  attributes:
    id: 1
    name: General
    created_at: 2013-01-10 22:08:57.291758000 Z
    updated_at: 2013-01-10 22:09:02.414022000 Z
... 
```

以下是假设性的。 `raise @categories.to_yaml` **后**

```
---
- !ruby/object:Category
  attributes:
    id: 1
    name: General
    created_at: 2013-01-10 22:08:57.291758000 Z
    updated_at: 2013-01-10 22:09:02.414022000 Z
    post_id: 80
    post_title: Lorem Ipsum
... 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T17:20:26.337

首先创建一个一对一的关联：

```
class Category
  has_one :latest_post, :order => "created_at DESC", class_name => "Post"
end 
```

然后急切加载：

```
@categories = Category.includes(:latest_post).all 
```

还有……瞧！

# ipython - easy_install、pip、py3 和官方 IPython 文档

> ID：14283197
> 
> 赞同：1
> 
> 时间：2013-01-11T17:11:45.983
> 
> 标签：ipython

今天我注意到[这个相当老的（并且投票率很高）的问题](https://stackoverflow.com/questions/3220404/why-use-pip-over-easy-install)，这让我想知道，如果在 Python 社区`pip`中普遍偏爱`easy_install`，为什么官方 ipython.org 文档会指导像我这样的新手使用[这里](http://ipython.org/ipython-doc/rel-0.13.1/install/install.html)`easy_install`显示的？

也许有一个隐含的假设，即读者正在使用 Python 2？尽管投票率很高的问题和几个答案似乎都表明这对于`pip`py2和 py3`easy_install`来说*都*更受欢迎，所以这似乎不是答案......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T17:37:27.130

命令：

```
easy_install ipython[zmq,qtconsole,notebook,test] 
```

将安装 IPython 和一些依赖项，包括已编译部分的 pyzmq。

`easy_install`处理二进制包，因此它可以安装 pyzmq 之类的预编译版本。`pip`相比之下，仅适用于源代码包。因此，对于具有已编译部分的包，它会下载源代码并尝试编译它。这样做有两个问题：

1.  用户需要安装 C 编译器，以及正在编译的代码所依赖的任何开发头文件。用户通常不会。
2.  它很慢，尤其是对于较大的包裹。

因此，使用大量编译包的科学 Python 世界并没有`pip`Web 开发人员使用那么多。其实我们也不太喜欢`easy_install`——我们有[各种更强大的安装方式](http://scipy.github.com/install.html)。

# jquery - JQuery窗口滚动事件？

> ID：14283205
> 
> 赞同：49
> 
> 时间：2013-01-11T17:12:00.393
> 
> 标签：jquery, scroll

我的标题中有一个广告，页面底部有一个固定的广告，它总是在那里。我希望仅当用户在标题广告下滚动时才会显示固定广告。我查看了 JQuery 文档，但我不确定我应该使用什么。

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2013-01-11T17:23:44.687

试试这个：http: [//jsbin.com/axaler/3/edit](http://jsbin.com/axaler/3/edit)

```
$(function(){
  $(window).scroll(function(){
    var aTop = $('.ad').height();
    if($(this).scrollTop()>=aTop){
        alert('header just passed.');
        // instead of alert you can use to show your ad
        // something like $('#footAd').slideup();
    }
  });
}); 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-01-11T17:16:22.840

请参阅[jQuery.scroll()](http://api.jquery.com/scroll/)。您可以将其绑定到窗口元素以获取所需的事件挂钩。

在滚动时，只需检查您的滚动位置：

```
$(window).scroll(function() {
  var scrollTop = $(window).scrollTop();
  if ( scrollTop > $(headerElem).offset().top ) { 
    // display add
  }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T17:19:29.770

检查用户是否滚动过页眉广告，然后显示页脚广告。

`if($(your header ad).position().top < 0) { $(your footer ad).show() }`

我对你要找的东西是正确的吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-10-30T17:37:59.653

作为[`scroll`](https://api.jquery.com/scroll/)提醒，在最新版本的 jQuery 中已弃用，而支持`.on('scroll', handler)`. 实际上，前者一直是后者的捷径。

建议从现在开始使用新表格：

```
$(window).on('scroll', () => {
  var scrollTop = $(window).scrollTop()
  if (scrollTop > $(headerElem).offset().top) { 
    // display add
  }
}) 
```

# mysql - select ... where (a=1 or b=min(b)) GROUP BY xy

> ID：14283207
> 
> 赞同：0
> 
> 时间：2013-01-11T17:12:12.573
> 
> 标签：mysql

我有表 gall_photos，其中包含许多画廊的照片

*   标识（整数）
*   gall_id (int)
*   文件名（varchar）
*   位置（整数）
*   预览 (tinyint 1)
*   date_add（日期时间）

现在我想获取照片列表（用于摘要预览），每个gal_id之一，但如果有预览1，那么这个，否则是位置​​编号最低的照片。最后按 date_add 排序

```
select * 
from gall_photos 
where (preview = 1 or position = min(position)) 
group by gall_id 
order by date_add 
```

此查询返回错误（如果使用“或 position = min(position)”）

请问，有什么想法吗？

编辑（12.1\. 18:50UTC）：可以在一个画廊（gall_id）中检查更多照片的预览，然后我需要其中一张，再次是最低位置

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:20:49.380

你可以这样做

```
select * 
from gall_photos x 
where (preview = 1 or (position = 
                             (SELECT min(x2.position)
                              FROM gall_photos x2 
                              WHERE x.gall_id = x2.gall_id
                              Group By x2.gall_id)
                      and not exists 
                              (select 1 
                               from gall_photos x2 
                               where x2.gall_id=x.gall_id 
                               and x2.preview=1)
                        )
       ); 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!2/14ed7/10)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T17:35:26.623

```
select id, gall_id, filename, position, preview, date_add
from gall_photos 
where position in (select min(position)from gall_photos) 
or
exists (select preview from gall_photos where preview = 1)
group by gall_id
order by date_add; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T17:46:33.973

rs 的解决方案非常接近，但是如果您有一条 preview=1 的记录，并且它没有 gall_id 的最低位置，他会给您 preview=1 和最低位置。所以我认为你想要的是：

```
select * 
from gall_photos g1
where preview = 1
  or not exists (select * from gall_photos g2 where g2.gall_id=g1.gall_id and g2.preview=1)
  and position = (select min(g3.position) from gall_photos g3
    where g3.gall_id=g1.gall_id)
order by date_add 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T17:52:06.273

像这样的东西怎么样...

```
SELECT a.gall_id
     , COALESCE(c.position,a.position) position
  FROM gall_photos a
  JOIN 
     ( SELECT gall_id,MIN(position) min_position FROM gall_photos GROUP BY gall_id) b 
    ON b.gall_id = a.gall_id 
   AND b.min_position = a.position
  LEFT
  JOIN gall_photos c
    ON c.gall_id = a.gall_id
   AND c.preview = 1; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-11T19:18:49.533

`WHERE CLAUSE`不允许与`GROUP BY`

使用`HAVING`：

```
select * 
from gall_photos 
group by gall_id 
having (preview = 1 or position = min(position)) 
order by date_add 
```

# entity-framework - 给定外键，以编程方式在 EF 中使用导航属性

> ID：14283215
> 
> 赞同：1
> 
> 时间：2013-01-11T17:12:30.900
> 
> 标签：entity-framework, reflection, navigation-properties

在我的项目中，我有`EF with ADO.NET`. 假设我有`Entity Framework`以下课程

```
class Product
{
   int Id { get; set;}
   string Name { get; set; }
   int TypeId { get; set; }
   int CategoryId { get; set; }
}

class Type
{
   int Id { get; set; }
   string Name { get; set; }
}

class Category
{
   int Id { get; set; }
   string Name { get; set; }
} 
```

然后我有`navigation properties`：

1.  **hasCategory：从 Category(Id) 到 Product(CategoryId)，从 ​​1 到 Many**
2.  **hasType：从 Type(Id) 到 Product(TypeId)，从 ​​1 到 Many**

因此，如果我想访问产品的特定类别名称或类型名称（给定上下文）：

```
int productId = 1;
var categoryName = context.Products.Single(p => p.Id == productId).hasCategory.Name;
var typeName = context.Products.Single(p => p.Id == productId).hasType.Name; 
```

现在，如果我有属性名称，我可以获得该属性：

```
string propertyName = "CategoryId";
var propertyValue = GetType(Product).GetProperty(propertyName) 
```

鉴于`propertyName`我想知道是否有任何方法可以获取匹配的导航属性（`hasCategory`或`hasType`）以获取名称。Oterhwise 我不知道我应该在这两个类中`Category`寻找`Type`哪一个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T08:16:11.207

也许尝试相反的方向？

附加对象动态接收“RelationshipManager”属性。它提供了一个有用的方法 GetAllRelatedEnds()，它返回“RelatedEnd”的集合，您可以在其中找到例如关系名称。

```
Object myObj;
var q = myObj.GetType().GetProperties().Where(p => p.PropertyType == typeof(RelationshipManager)).First();
RelationshipManager rm = q.GetValue(myObj, null) as RelationshipManager;
foreach (RelatedEnd re in rm.GetAllRelatedEnds())
{
    // Here you get the "other-side" objects
} 
```

尽管如此，导航属性的名称仍然是私有的:(希望这能接近某人的解决方案

# asp.net-mvc - ASP.NET MVC：使用没有 IClientValidatable 的属性实现客户端验证

> ID：14283216
> 
> 赞同：5
> 
> 时间：2013-01-11T17:12:30.910
> 
> 标签：asp.net-mvc, validation, jquery-plugins

如何在不实施的情况下创建具有客户端验证的自定义验证属性`IClientValidatable`？

`System.ComponentModel.DataAnnotations.RequiredAttribute`客户端如何验证？

这样做的原因是因为我在我的视图中使用来自另一个项目中的类的对象作为模型，并且我不想添加`System.Web.MVC`对该项目的引用。

**编辑以添加更多信息**：

*   我知道这`IClientValidatable`用于将自定义属性添加到 HTML 以供以后不显眼的验证使用。

*   我知道我需要添加 javascript 代码才能在客户端进行验证。

我不知道如何使用自定义验证属性中的信息将必要的属性添加到 HTML 以使不显眼的验证正常工作。

这是我的自定义验证属性：

```
public class RequiredGuidAttribute : ValidationAttribute
{
    public override bool IsValid(object value)
    {
        Guid? guidValue = value as Guid?;

        if (guidValue == null)
            return false;

        return guidValue != Guid.Empty;
    }
} 
```

这是我应用了属性的属性：

```
 [RequiredGuid(ErrorMessageResourceType = typeof(ClientOrderResources), ErrorMessageResourceName = "RequiredShippingMethod")]
    public Guid ShippingMethodId
    {
        get { return GetProperty(ShippingMethodIdProperty); }
        set { SetProperty(ShippingMethodIdProperty, value); }
    } 
```

最后，我在视图中使用`Html.HiddenFor`.

现在，如何从属性中获取错误消息以将其应用于 HTML？我应该自己使用反射还是有更好的方法？

然后我如何告诉`Html.HiddenFor`使用该信息向 HTML 添加必要的属性？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-05-23T18:28:01.960

我们遇到了类似的问题。我们有一个用于创建帐户的模型，该模型在其自定义属性上使用 IClientValidatable。但是，我们创建了一个批处理帐户创建过程，该过程位于我们无法引用 System.Web.Mvc 的网站之外。因此，当我们调用 Validator.TryValidateObject 时，任何从 IClientValidatable 继承的自定义验证器都只是简单的跳过。以下是我们正在处理的未能在我们的网站之外验证的内容：

```
public class AgeValidatorAttribute : ValidationAttribute, IClientValidatable
{
    public int AgeMin { get; set; }
    public int AgeMax { get; set; }

    public override bool IsValid(object value)
    {
        //run validation
    }
}

public IEnumerable<ModelClientValidationRule> GetClientValidationRules(ModelMetadata metadata, ControllerContext context)
    {
        var rule = new ModelClientValidationRule
        {
            ErrorMessage = ErrorMessageString,
            ValidationType = "agevalidator"
        };

        rule.ValidationParameters["agemin"] = AgeMin;
        rule.ValidationParameters["agemax"] = AgeMax;

        yield return rule;
    } 
```

删除 System.Web.Mvc 要求我们还删除 GetClientValidationRules 和 IClientValidatable 引用。为了做到这一点并且仍然有客户端验证，我们必须创建一个新类：

```
public class AgeValidatorClientValidator : DataAnnotationsModelValidator<AgeValidatorAttribute>
{
    private readonly string _errorMessage;
    private readonly string _validationType;

    public AgeValidatorClientValidator(ModelMetadata metadata, ControllerContext context, AgeValidatorAttribute attribute)
        : base(metadata, context, attribute)
    {
        this._errorMessage = attribute.FormatErrorMessage(metadata.DisplayName);
        this._validationType = "agevalidator";
    }

    public override IEnumerable<ModelClientValidationRule> GetClientValidationRules()
    {
        var rule = new ModelClientValidationRule
        {
            ErrorMessage = this._errorMessage,
            ValidationType = this._validationType
        };

        rule.ValidationParameters["agemin"] = base.Attribute.AgeMin;
        rule.ValidationParameters["agemax"] = base.Attribute.AgeMax;

        yield return rule;
    }
} 
```

如您所见，它的作用与以前基本相同，只是使用 DataAnnatotationsModelValidator 而不是 IClientValidatable 完成。我们还需要执行一个步骤才能将 DataAnnotationsModelValidator 实际附加到属性，这是在 Global.asax.cs Application_Start 方法中完成的

`DataAnnotationsModelValidatorProvider.RegisterAdapter( typeof(AgeValidatorAttribute), typeof(AgeValidatorClientValidator));`

现在您可以像使用普通属性一样使用它：

```
[AgeValidator(AgeMax = 110, AgeMin = 18, ErrorMessage = "The member must be between 18 and 110 years old")]
public string DateOfBirth { get; set; } 
```

我知道这个问题已经有一年了，但我昨天和今天花了一整天的时间试图解决这个问题。因此，如果 OP 还没有找到答案，我希望这可以帮助遇到同样问题的人。

请注意，我没有在这篇文章中包含任何 javascript，因为它不需要更改使用 jQuery.validate 的自定义验证规则的标准实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-18T13:14:50.907

有可能，我找到了这篇关于如何做到这一点的文章：http: [//xhalent.wordpress.com/2011/05/12/custom-unobstrusive-jquery-validation-in-asp-net-mvc-3-using-数据注释模型验证器提供者/](http://xhalent.wordpress.com/2011/05/12/custom-unobstrusive-jquery-validation-in-asp-net-mvc-3-using-dataannotationsmodelvalidatorprovider/)

基本上你必须在你的客户端上创建一个 DataAnnotationsModelValidator 并在 Application_Start() 中注册它。

并且不要忘记您仍然需要编写 Javascript 来进行客户端验证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T04:38:02.200

除非您实现 IClientValidatable，否则您不能在客户端上进行自定义验证。为此，您还需要添加客户端脚本。

[http://msdn.microsoft.com/en-us/vs2010trainingcourse_aspnetmvccustomvalidation_topic3.aspx](http://msdn.microsoft.com/en-us/vs2010trainingcourse_aspnetmvccustomvalidation_topic3.aspx)

# css - 将 CSS 样式表应用于除一个以外的所有元素

> ID：14283219
> 
> 赞同：2
> 
> 时间：2013-01-11T17:12:43.577
> 
> 标签：css

我有几个网格（剑道网格）。这与悬停效果有共同的风格。我想只为一个名为 mygrid 的网格防止这种悬停效果。

试过这个没有成功：

```
 .k-grid tr:hover :not(#mygrid)
 {
  color:White;
  background-color:#90B5DA;
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T17:16:48.480

的正确用法`not`附加到另一个选择器。例如：

```
.k-grid:not(#mygrid) 
```

将选择具有该类的所有元素，`k-grid`除非该元素的 id 为`mygrid`

所以你想要的是这样的：

```
.k-grid:not(#mygrid) tr:hover 
```

资料来源：[http ://www.w3.org/TR/selectors/#negation](http://www.w3.org/TR/selectors/#negation)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T17:26:46.093

已经建议的使用`:not()`是正确的。为了获得更广泛的支持，您可以考虑做这样的事情，其中​​ :hover 状态`#mygrid`与“关闭”状态相同：

```
.k-grid tr,
#mygrid tr:hover /* Add this rule to the "off" state */
{
  color:Grey;
  background-color:#333;
}

.k-grid tr:hover
{
  color:White;
  background-color:#90B5DA;
} 
```

# serial-port - 为什么我的代码只能在一个方向（芯片-> PC）上进行串行通信？

> ID：14283220
> 
> 赞同：0
> 
> 时间：2013-01-11T17:12:43.613
> 
> 标签：serial-port, arduino, atmega, usart

我正在用 C 语言为 Arduino Mega 2560 编写代码，我正在尝试通过串行端口进行双向通信。但是，只有将数据从 Arduino 发送到 PC 才有效——反之则不行。arduino 上的 RX LED 很快亮起，但我的代码没有接收到数据（连接到“pin 13”的 LED 没有亮起）。有谁知道如何解决这一问题？

这是在 arduino 上运行的代码：

```
#define USART_BAUDRATE 500000
#define BAUD_PRESCALE (((F_CPU / (USART_BAUDRATE * 16UL))) - 1)

static void serial_init(void) {
  // load upper 8 bits of the baud rate into the high byte of the UBRR register
  UBRR0H = (BAUD_PRESCALE >> 8);
  // load lower 8 bits of the baud rate into the low byte of the UBRR register
  UBRR0L = BAUD_PRESCALE;

  // 8data,1stopbit
  UCSR0C = (0 << UMSEL00) | (1 << UCSZ00) | (1 << UCSZ01);
  // turn on the transmission and reception circuitry
  UCSR0B = (1 << RXEN0) | (1 << TXEN0) | (0 << UCSZ02);
}

static void sendbyte(uint8_t b) {
  // do nothing until UDR is ready for more data to be written to it
  while ((UCSR0A & (1 << UDRE0)) == 0) {};
  // memory was cleared - write to it
  UDR0 = b;
}

static void digi_init() {
  // configure port B7 (arduino digital port 13) as output and set it low
  PORTB = (0<<PB7);
  DDRB = (1<<DDB7);
}

static void digi_set(int val) {
  PORTB = (val<<PB7);
}

int main(void) {
  serial_init();
  digi_init();

  while (1) {
    if ((UCSR0A & (1 << RXC0)) == 1) {
      // we got some data, light up the LED!
      digi_set(1);
    }

    _delay_ms(50);
    sendbyte('.');
  }
} 
```

这是在 PC 上运行的代码：

```
int main(int argc, char *argv[]) {
  char *serialdevicepath = "/dev/ttyACM0";

  fprintf(stderr, "Connecting to serial device ...\n");
  int serial_fd = open(serialdevicepath, O_RDWR | O_NOCTTY);
  struct termios config;
  if(tcgetattr(serial_fd, &config) < 0) exit(1);
  config.c_iflag &= ~(IGNBRK | BRKINT | ICRNL | INLCR | PARMRK | INPCK | ISTRIP | IXON);
  config.c_lflag &= ~(ECHO | ECHONL | ICANON | IEXTEN | ISIG);
  config.c_cflag &= ~(CSIZE | PARENB);
  config.c_cflag |= CS8;
  config.c_cc[VMIN]  = 1;
  config.c_cc[VTIME] = 0;
  if(cfsetispeed(&config, B500000) < 0 || cfsetospeed(&config, B500000) < 0) exit(1);
  if(tcsetattr(serial_fd, TCSAFLUSH, &config) < 0) exit(1);
  FILE *serial = fdopen(serial_fd, "r");

  setbuf(stdin, NULL);
  fcntl(0/*stdin*/, F_SETFL, O_NONBLOCK);
  setbuf(stdout, NULL);
  setbuf(stderr, NULL);
  setbuf(serial, NULL);

  while (1) {
    char c;
    while (read(0, &c, 1) == 1) {
      if (c != '+' && c != '-') continue;
      uint8_t val = (c == '+') ? 42 : 41;
      if (write(serial_fd, &val, 1) != 1) {
        assert(0);
      }
    }

    char b = fgetc(serial))&0xe0);
    fprintf(stderr, "read 0x%x\n", b);    
  }

  return 0;
} 
```

（是的，我在 PC 上键入 <+> 以便它发送数据。另外，我尝试直接从代码中打开 LED 并且它起作用了。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T18:47:59.733

```
if ((UCSR0A & (1 << RXC0)) == 1) 
```

该测试是错误的，它永远不会是 1。这里的 & 运算符将产生 0 或 (1 << RXC0)。改用这种方式：

```
if ((UCSR0A & (1 << RXC0)) != 0) 
```

或者在 C 中，您通常会这样写，因为任何非零值在逻辑上都是正确的：

```
if (UCSR0A & (1 << RXC0)) 
```

# moodle - 添加 Moodle 手动完成

> ID：14283223
> 
> 赞同：0
> 
> 时间：2013-01-11T17:12:51.283
> 
> 标签：moodle

我正在寻找任何 Moodle 开发人员/黑客/管理员来帮助我解决这个问题（更多的是猎巫）。

我有大约 300 门课程需要添加手动自我完成以及自我完成块。

我想我已经弄清楚了块代码：

```
insert into mdl2_block_instances (blockname, parentcontextid, showinsubcontexts, pagetypepattern, defaultregion, defaultweight) values ('selfcompletion', $contextid, 0, 'course-view-*', 'side-post', 5) 
```

我仍然不知道将手动自我完成更改为 true 的哪个表字段，而且我已经厌倦了盯着 Moodle 模式。有人会有答案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T11:19:44.603

要在课程中启用手动自我完成标准，请执行以下查询。

```
INSERT INTO  prefix_course_completion_criteria (course,criteriatype) VALUES(courseid,1); 
```

我想它会对你有所帮助。

谢谢

# boost - Boost.Wave 1.52 不在 Darwin 上使用 clang++ 构建

> ID：14283229
> 
> 赞同：1
> 
> 时间：2013-01-11T17:13:11.467
> 
> 标签：boost, clang, darwin, clang++

我已经应用[Compile boost C++11 clang mac 找不到 cstddef](https://stackoverflow.com/questions/13404500/compile-boost-1-52-c11-clang-mac-10-8-2-cannot-find-cstddef) 并调用 build 如下 `./b2 variant=debug,release --layout=versioned toolset=clang cxxflags="-fPIC -std=c++11 -stdlib=libc++ -arch i386 -arch x86_64" linkflags="-stdlib=libc++ -arch i386 -arch x86_64" threading=multi link=shared --stagedir=stage_darwin_intel_shared_mt stage`

一切都建立起来了，除了警告日志和 Boost.Wave 失败： [http ://pastebin.com/ZHkmTWaq](http://pastebin.com/ZHkmTWaq)

PS 静态风格的助推器可以很好地构建 Wave。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T14:06:46.577

正确编译

```
./b2 variant=debug,release --layout=versioned toolset=clang cxxflags="-fPIC -std=c++11 -stdlib=libc++ -arch i386 -arch x86_64" linkflags="-std=c++11 -stdlib=libc++ -arch i386 -arch x86_64" threading=multi link=shared --stagedir=stage_darwin_intel_shared_mt stage 
```

# symfony - 在 Jenkins 盒子上使用 capifony 进行教义迁移

> ID：14283232
> 
> 赞同：2
> 
> 时间：2013-01-11T17:13:18.810
> 
> 标签：symfony, doctrine-orm, capifony

我正在尝试从 Jenkins 框中部署 Symfony2 应用程序。我将 capifony 多级部署系统用于 2 个不同的环境：dev 和 uat。

当我把

```
before "symfony:cache:warmup", "symfony:doctrine:migrations:migrate" 
```

在我的 dev.rb 文件中，我收到来自 capifony 的错误

```
`symfony:doctrine:migrations:migrate' is only run for servers matching {:roles=>:app, :only=>{:primary=>true}, :except=>{:no_release=>true}}, but no servers matched 
```

如何使用 capifony 自动部署和执行迁移？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-14T11:07:25.700

固定的！

在你的 stage.rb 文件中添加：

```
role    :app,               domain, :primary => true 
```

# javascript - jquery数字时钟

> ID：14283234
> 
> 赞同：0
> 
> 时间：2013-01-11T17:13:19.877
> 
> 标签：javascript, clock

我正在尝试使用基于此处的示例：[http ://www.techtricky.com/jquery-code-to-show-time-in-different-countries/](http://www.techtricky.com/jquery-code-to-show-time-in-different-countries/)

但是我是 JS 新手，遇到了麻烦。我基本上是想让它在没有选择框的情况下显示时间。

然后我将尝试一次显示多个不同的时间。

例如

+------------------+ | 晚上 10 点 14 分 14 秒 | | 08:14:14 下午 | | 下午 06:14:14 | +------------------+

我意识到 var 选项允许我设置样式和时间偏移。但是功能有点让我困惑。我一直在尝试将#zones 设置为自动运行，但无需选择某些内容就无法启动。（理想情况下我根本不会在那里选择，我尝试为区域选择设置默认值，但这也不起作用）我认为这是因为该函数具有$（“#zones”）。**改变**所以只会在改变时运行。

蒂亚！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T19:44:21.190

你可能对这个感兴趣： [Raphael - Polar Clock](http://raphaeljs.com/polar-clock.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T17:24:31.253

你可以做一些丑陋的事情显然你可以在一个循环或其他东西中做到这一点，所以你不必像我在这里所做的那样编写你的代码 3 次

另外 - jclock 文档中的示例很少：[https ://sites.google.com/site/jqueryjclockjs/](https://sites.google.com/site/jqueryjclockjs/)

```
 <html>
      <head>
      <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
      <script type="text/javascript" src="http://techtricky.com/wp-content/jquery/jquery.jclock.js"></script>
      <script type="text/javascript">
        $(document).ready(
            function() {
           $('#time-cont1').append('<div class="time"></div>');
               var options = {
                format:'<span class=\"dt\">%A, %d %B %I:%M:%S %P</span>',
                timeNotation: '12h',
                am_pm: true,
                fontFamily: 'Verdana, Times New Roman',
                fontSize: '20px',
                foreground: 'black',
                background: 'yellow',
                utc:true,
                utc_offset: 8
              }

              $('#time-cont1 .time').jclock(options);
              $('#time-cont2').append('<div class="time"></div>');
               var options = {
                format:'<span class=\"dt\">%A, %d %B %I:%M:%S %P</span>',
                timeNotation: '12h',
                am_pm: true,
                fontFamily: 'Verdana, Times New Roman',
                fontSize: '20px',
                foreground: 'black',
                background: 'yellow',
                utc:true,
                utc_offset: 6
              }

              $('#time-cont2 .time').jclock(options);
              $('#time-cont3').append('<div class="time"></div>');
               var options = {
                format:'<span class=\"dt\">%A, %d %B %I:%M:%S %P</span>',
                timeNotation: '12h',
                am_pm: true,
                fontFamily: 'Verdana, Times New Roman',
                fontSize: '20px',
                foreground: 'black',
                background: 'yellow',
                utc:true,
                utc_offset: -5
              }

              $('#time-cont3 .time').jclock(options);
         });
        </script>

      </head>
      <body>
        Country1: <div id="time-cont1"></div>
        Country2:  <div id="time-cont2"></div>
        Country3: <div id="time-cont3"></div>
      </body>
    </html> 
```

# ios - 自动屏幕镜像是否在 iOS 6+ 中损坏或删除？

> ID：14283235
> 
> 赞同：0
> 
> 时间：2013-01-11T17:13:23.527
> 
> 标签：ios, ios6, mirroring

我想用我的应用程序和设备做到这一点：

1.  将 VGA、DVI 或 HDMI 显示器连接到适当的 30 针适配器电缆
2.  将适配器连接到 iPhone4/iPad2
3.  在显示器屏幕上镜像 iDevice 屏幕内容。

这一切都过去在 iOS 5 上“正常工作”。甚至在我们去年演示的 YouTube 视频中也证明了它的工作原理（参见[http://youtu.be/xjKk1EJ1yAI](http://youtu.be/xjKk1EJ1yAI)，跳到图像跳转到 1:40在视频中并点击播放）。我所做的只是插入iPad，*瞧*，它就在那里......

现在这似乎“只是行不通”。我是否必须编写一大堆代码才能使其适用于我构建的每个应用程序，或者 Info.plist 文件中是否有我应该设置的设置？即使设备运行 iOS 6+，我是否应该为 iOS 5.1 构建以使其再次工作？

如果必须，我***会***编写代码，但如果它再次工作，我会更开心。SO 上的“类似问题”功能有助于让我知道我可能不走运并指出一些解决方案，例如 Rob Terrell 的[TVOutManager](http://www.touchcentric.com/blog/archives/123)，但我无法在该列表中找到该特定问题的答案.

***编辑：**我只用运行 iOS 6.0.1 和 VGA 适配器的 iPhone 4 进行了尝试。我没有再次尝试使用 iPad（也使用 iOS 6.0.1），并且视频使用的是 HDMI 适配器。我会尝试这些并相应地更新（但可能要到星期一才能更新这些更新）。*

# java - 计算一个三角形晶体

> ID：14283240
> 
> 赞同：2
> 
> 时间：2013-01-11T17:13:44.727
> 
> 标签：java, math, geometry

可以将**规则三角形的二维晶体**设想为由微观规则三角形单元的堆叠构成，如下所示：

![在此处输入图像描述](../Images/f49be8abc77d256c361c1453d53d4a63.png)

在Java中计算这种4x4晶体的三角形总数的正确方法是什么？

```
var a; (even) 
var b; (odd) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T17:25:58.233

这是一种系统地找到问题解决方案的方法：

你得到了你在水晶的每一边找到的三角形的数量，比如说`n`。现在，让水晶像您向我们展示的图像一样放在一边，并在每行三角形上附加一个数字，您的第一行将有数字`1`，依此类推。

现在看看 row `2`，例如。它有 2 个向上的三角形和 1 个向下的三角形。

你能概括一下吗？一排有多少个向上的三角形`n`？有多少向下的？

如果您有该问题的答案，您可以将代码中各个行的数字相加 - 或者为总和提出一个很好的封闭公式。

* * *

好吧 - 我无法抗拒。下图提供了一种很好的思考问题的方式，它实际上可以自行解决。您看着它并意识到您的问题实际上简化为数平方（这当然很容易）。它与@femtoRgon 建议的解决方案在精神上相似，但您甚至不必考虑区域！

![在此处输入图像描述](../Images/4f54ca5915313723ae5e0a08644a96bf.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T17:23:28.377

对于小三角形，只有它的 n + 2((n-1) + (n-2) + ... + 1) 可以通过查看面向单向和面向相反方向的三角形图案来获得。

换一种方式看，你可以看到它的 count(n) = (2n-1) + count(n-1) for n>1 和 count(n) 1 for n=1 因为每个大三角形只是添加了另一层三角形沿一侧交错。

如果您需要 1x1x1 三角形和 2x2x2 三角形直到 nxnxn 三角形，它会更复杂但非常简单的代数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-11T17:28:48.197

我相信在 X x X 三角形中表示的三角形数量的正确计算是：

```
X*X 
```

我的推理：这样的三角形是对应X×X正方形面积的1/2，每个单位三角形是单位正方形面积的1/2。我们可以用（S为正方形的面积）确定较大正方形中的单位正方形的数量`S = X*X`，因此我们可以计算出三角形的数量： `T = S/2 = (X*X)/2`（T为三角形的面积），并且由于我们的两个单位三角形有面积等于 1 个单位正方形，面积的两倍是三角形的个数，或`num_triangles = (X*X)/2 * 2 = X*X`

# ios - 像 App Store 一样的水平滚动控件

> ID：14283244
> 
> 赞同：1
> 
> 时间：2013-01-11T17:13:55.117
> 
> 标签：ios, cocoa-touch, user-interface, uiscrollview, uipagecontrol

我需要像 App Store 这样的水平滚动控件：

![在此处输入图像描述](../Images/690946441fc0e1380f47502b902b519c.png)

我应该`UIScrollView`结合使用`UIPageControl`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:30:13.573

你考虑过`UICollectionView`吗？

# android - 在 TextView 中更改文本字距或间距？

> ID：14283246
> 
> 赞同：4
> 
> 时间：2013-01-11T17:13:58.767
> 
> 标签：android

我有一个要求，TextView 中的字母需要间隔更远一些。不幸的是，我发现的大多数资源似乎都说这无法做到——至少不容易做到。

到目前为止，明显的解决方案是：

1.  在字符串中的字符之间添加空格——“AB C”而不是“ABC”。当然，如果只需要一点点空间，那是行不通的。

2.  更改 textScale，但这会影响字母的大小，而不仅仅是字母之间的间距

3.  使用 Font 类，但在 Honeycomb 之前它不可用（我需要与 Gingerbread 兼容的东西）并且它在 JellyBean 中已被弃用，所以这不是一个好的选择。

4.  找到具有不同字距的字体，但如果客户想要使用相同的字体，那是不现实的。

5.  覆盖视图的 onDraw，一次将一个字符绘制到 Canvas，手动指定每个字符应该绘制的确切位置。

有什么我想念的吗？似乎应该有更好的方法。我看到了 TextAttribute.KERNING 和 TextAttribute.TRACKING ......似乎它们应该能够轻松使用，但我不知道如何使用。

更改 TextView 中字母间距的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-08T04:29:32.150

我找到的解决方案是混合您描述的解决方案 1 和 2。在字母之间添加空格，而不是仅更改空格的 TextScaleX，因此您可以保持其他字符相同。我构建了一个自定义类，它扩展`TextView`并允许您定义字母间距。其他一切都是自动的=）

我在另一个[答案上发布了课程](https://stackoverflow.com/a/16429758)

希望有帮助^^

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-22T10:46:36.477

此答案基于 Pedro 的答案，但经过编辑，因此在 text 属性已设置好时也可以使用：

```
package nl.raakict.android.spc.widget;
import android.content.Context;
import android.text.Spannable;
import android.text.SpannableString;
import android.text.style.ScaleXSpan;
import android.util.AttributeSet;
import android.widget.TextView;

public class LetterSpacingTextView extends TextView {
    private float letterSpacing = LetterSpacing.BIGGEST;
    private CharSequence originalText = "";

    public LetterSpacingTextView(Context context) {
        super(context);
    }

    public LetterSpacingTextView(Context context, AttributeSet attrs){
        super(context, attrs);
        originalText = super.getText();
        applyLetterSpacing();
        this.invalidate();
    }

    public LetterSpacingTextView(Context context, AttributeSet attrs, int defStyle){
        super(context, attrs, defStyle);
    }

    public float getLetterSpacing() {
        return letterSpacing;
    }

    public void setLetterSpacing(float letterSpacing) {
        this.letterSpacing = letterSpacing;
        applyLetterSpacing();
    }

    @Override
    public void setText(CharSequence text, BufferType type) {
        originalText = text;
        applyLetterSpacing();
    }

    @Override
    public CharSequence getText() {
        return originalText;
    }

    private void applyLetterSpacing() {
        StringBuilder builder = new StringBuilder();
        for(int i = 0; i < originalText.length(); i++) {
            String c = ""+ originalText.charAt(i);
            builder.append(c.toLowerCase());
            if(i+1 < originalText.length()) {
                builder.append("\u00A0");
            }
        }
        SpannableString finalText = new SpannableString(builder.toString());
        if(builder.toString().length() > 1) {
            for(int i = 1; i < builder.toString().length(); i+=2) {
                finalText.setSpan(new ScaleXSpan((letterSpacing+1)/10), i, i+1, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
            }
        }
        super.setText(finalText, BufferType.SPANNABLE);
    }

    public class LetterSpacing {
        public final static float NORMAL = 0;
        public final static float NORMALBIG = (float)0.025;
        public final static float BIG = (float)0.05;
        public final static float BIGGEST = (float)0.2;
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-08-06T18:36:56.277

As of API 21, you can use [setLetterSpacing()](http://developer.android.com/reference/android/widget/TextView.html#setLetterSpacing%28float%29) fot TextView (and Paint) objects.

# opencv - 如何在 Eclipse 中构建和调试 Open cv 项目？

> ID：14283249
> 
> 赞同：0
> 
> 时间：2013-01-11T17:14:05.053
> 
> 标签：opencv

我已经配置了在 eclipse 中以 c/c++ 模式运行 open cv 所需的所有库和路径，我已经编写了下面的代码，但我不知道如何构建和调试，我的代码是

```
 #include "cv.h"
 #include "highgui.h"
//using namespace cv;

int main(int argc, char *argv[])
{
 cvNamedWindow( "Example1", CV_WINDOW_AUTOSIZE );
IplImage* img = cvLoadImage("prado.jpg",1);
cvShowImage("Example1", img );//*/
cvWaitKey(0);
return 0; 
} 
```

# perl - -B 文件测试的可靠性如何？

> ID：14283254
> 
> 赞同：6
> 
> 时间：2013-01-11T17:14:34.463
> 
> 标签：perl, find, binaryfiles

当我打开 SQLite 数据库文件时，文件开头有很多可读文本 - 由于文件测试，SQLite 文件被错误过滤掉的可能性有多大`-B`？

```
#!/usr/bin/env perl
use warnings;
use strict;
use 5.10.1;
use File::Find;

my $dir = shift;
my $databases;

find( {
    wanted     => sub {
        my $file = $File::Find::name;
        return if not -B $file;
        return if not -s $file;
        return if not -r $file;
        say $file;
        open my $fh, '<', $file or die "$file: $!";
        my $firstline = readline( $fh ) // '';
        close $fh or die $!;
        push @$databases, $file if $firstline =~ /\ASQLite\sformat/;
    },
    no_chdir   => 1,
},
$dir );

say scalar @$databases; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-11T17:23:39.887

[perlfunc](http://perldoc.perl.org/perlfunc.html)手册页对 and 有以下`-T`说明`-B`：

```
The -T and -B switches work as follows. The first block or so of the file is
examined for odd characters such as strange control codes or characters with
the high bit set. If too many strange characters (>30%) are found, it's a -B
file; otherwise it's a -T file. Also, any file containing a zero byte in the
first block is considered a binary file. 
```

当然，您现在可以对许多 sqlite 文件进行统计分析，将它们的“第一个块左右”解析为“奇数字符”，计算它们出现的概率，这会让您了解它的可能性有多大`-B`sqlite 文件失败。

但是，您也可以走简单的路线。会失败吗？是的，这是一种启发式方法。这是一个糟糕的人。所以不要使用它。

Unix 上的文件类型识别通常通过评估文件的内容来完成。是的，有些人已经为您完成了所有工作：它被称为`libmagic`（产生`file`命令行工具的东西）。您可以在 Perl 中将它与例如[File::MMagic 一起](https://metacpan.org/module/File%3a%3aMMagic)使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T20:19:50.477

好吧，从技术上讲，所有文件都是字节的集合，因此是二进制的。除此之外，没有公认的二进制定义，因此不可能评估`-B`'s 的可靠性，除非您愿意提出一个评估它的定义。

# javascript - 在 IE 10 中使用复合键创建索引时出现 DataError

> ID：14283257
> 
> 赞同：7
> 
> 时间：2013-01-11T17:14:37.230
> 
> 标签：javascript, indexeddb

我正在使用 IE10 测试基于 indexedDB 的应用程序。我无法创建具有多个键的对象存储。例如，`var objectStore = theDb.createObjectStore("store1", { keyPath: ["key1","key2"] });`。

当我尝试将数据插入存储时，会引发异常消息：“DataError”这不是很有帮助！有没有人能够`objectStores`使用带有多个键的 IE10 创建？这在 Chrome 中可以很好地测试。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-12T01:09:21.203

我遇到了同样的问题。从他们的论坛帖子中， IE10[不支持](http://social.msdn.microsoft.com/Forums/en-US/winappswithhtml5/thread/dbf2fd2d-a8ca-4228-8a49-3948d44f7e26/)复杂的键路径或复合索引，抱怨未定义规范（不正确）。IE10 中还没有实现其他 IndexedDB API 功能。公平地说，IE10 IndexedDB 很快。

# django - 使用 ModelForm 中的自定义字段值修改模型对象

> ID：14283259
> 
> 赞同：0
> 
> 时间：2013-01-11T17:14:39.077
> 
> 标签：django, django-forms

我正在 Django 1.5 上构建一个使用 PostGIS 存储位置数据的应用程序。对于原型，创建新位置记录的表单要求用户输入纬度和经度坐标（我认为这是最容易编写代码的设置）。

我创建了一个`ModelForm`这样的：

```
class LocationForm(forms.ModelForm):
  # Custom fields to accept lat/long coords from user.
  latitude  = forms.FloatField(min_value=-90, max_value=90)
  longitude = forms.FloatField(min_value=-180, max_value=180)

  class Meta:
    model   = Location
    fields  = ("name", "latitude", "longitude", "comments",) 
```

到目前为止，一切都很好。但是，该`Location`模型没有也`latitude`没有`longitude`字段。相反，它使用 a`PointField`来存储位置的坐标：

```
from django.contrib.gis.db import models

class Location(models.Model):
  name = models.CharField(max_length=200)
  comments = models.TextField(null=True)

  # Store location coordinates
  coords = models.PointField(srid=4326)

  objects = models.GeoManager() 
```

我正在寻找的是在用户提交具有有效值的表单后，在哪里注入代码，该代码将为`latitude`和`longitude`输入获取值并将它们作为`Point`对象存储在`Location`'s字段中。`coords`

例如，我正在寻找与 Symfony 1.4 的`sfFormDoctrine::doUpdateObject()`方法等效的 Django。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T17:36:09.250

[在stummjr's answer 的](https://stackoverflow.com/a/14283493/212218)一些指导下`django.forms.BaseModelForm`，我相信我已经找到了解决方案：

```
class LocationForm(forms.ModelForm):
  ...

  def save(self, commit=True):
    self.instance.coords = Point(self.cleaned_data["longitude"], self.cleaned_data["latitude"])
    return super(LocationForm, self).save(commit) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T17:28:32.793

您可以[覆盖模型中的 save()](https://docs.djangoproject.com/en/dev/topics/db/models/#overriding-predefined-model-methods)方法`Location`。

```
class Location(models.Model):
    name = models.CharField(max_length=200)
    comments = models.TextField(null=True)

    # Store location coordinates
    coords = models.PointField(srid=4326)

    objects = models.GeoManager()

    def save(self, *args, **kwargs):
        self.coords =  ... # extract the coords here passed in through kwargs['latitude'] and kwargs['longitude']
        # don't forget to call the save method from superclass (models.Model)
        super(Location, self).save(*args, **kwargs) 
```

假设您有这个视图来处理表单：

```
 def some_view(request):
      lat = request.POST.get('latitude')
      longit = request.POST.get('longitude')
      ...
      model.save(latitude=lat, longitude=longit) 
```

另一种选择是[覆盖 ModelForm 中的保存方法](https://stackoverflow.com/a/817364/1084647)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-12T09:04:51.617

> 覆盖 Form clean 方法来设置坐标

```
 def clean(self):
        lat = self.data.get("Longitude")
        long = self.data.get("Latitude")
        p = Point(long,lat,srid=4326)
        self.cleaned_data["coords"] = p
        super(LocationForm, self).clean() 
```

# github - 使用 aptana 发送 git 提交会在 github.com 中显示“未知提交”

> ID：14283262
> 
> 赞同：1
> 
> 时间：2013-01-11T17:14:49.733
> 
> 标签：github, aptana, git-commit

一年多前，我使用 egit 在 Windows 7 下设置了 Aptana 3。

我将我的设置设置为：首选项 -> 团队 -> Git -> 配置：

```
user.name = My Name
user.email = myName@myCompany.com 
```

所以在 D:\web.metadata.plugins\com.aptana.portablegit.win32\etc\gitconfig

我可以找到这些行 [用户]

姓名 = 我的姓名 电子邮件 = myName@myCompany.com

和相同的： C:\Users\MY username.gitconfig

我在 git Bash 中通过这个命令做到了这一点：

```
$ git config --global user.name "My Name "
$ git config --global user.email "myName@myCompany.com" 
```

直到去年 10 月，这一切都完美无缺。

现在：当我对任何文件进行提交并在此之后进行 git 推送时，在 github 中我可以看到我的名字是您发送推送的人，但提交显示为“未知”（10 月之前的所有提交都是完美的）

在 12 月重新安装我的系统（因为从 w7/32 位切换到 w7/64 位而需要什么）并没有带来帮助。

在我在同一个存储库上的同事上，它仍然可以工作（但他在 mac 下使用 aptana，所以设置上存在差异..）

我今天更新到 egit 的最新版本：Eclipse EGit 2.2.0.201212191850-r org.eclipse.egit.feature.group 没有变化..

（对我来说，我从 9 月底安装的 2.1.0.201209190230 版本开始就得到了这个，但是由于 PUSH 总是显示我的名字，我没有注意到它在提交时丢失了..

所以：欢迎任何提示.. joerg

编辑：当我使用我安装的 Git GUI 并使用“签名”按钮时，我在提交中得到了额外的一行：

`Signed-off-by: myName <myName@myCompany.com>`

# algorithm - 如何确定我的 pi 计算是否准确？

> ID：14283270
> 
> 赞同：782
> 
> 时间：2013-01-11T17:15:32.447
> 
> 标签：algorithm, math, language-agnostic, pi

我正在尝试各种方法来实现一个按顺序给出 pi 数字的程序。我尝试了[泰勒级数](http://en.wikipedia.org/wiki/Taylor_series)方法，但事实证明它的收敛速度非常慢（当我在一段时间后将我的结果与在线值进行比较时）。无论如何，我正在尝试更好的算法。

所以，在编写程序时，我遇到了一个问题，就像所有算法一样：我怎么知道`n`我计算的数字是准确的？

* * *

## 回答 #1

> 赞同：1645
> 
> 时间：2013-01-11T17:28:04.953

由于我是目前 pi 位数最多的世界纪录保持者，我将加[两分钱](http://en.wiktionary.org/wiki/two_cents#Noun)：

除非您实际上是在设置新的世界纪录，否则通常的做法是根据已知值验证计算出的数字。所以这很简单。

事实上，我有一个网页列出了数字片段，以验证对它们的计算：[http ://www.numberworld.org/digits/Pi/](http://www.numberworld.org/digits/Pi/)

* * *

但是当你进入世界纪录领域时，没有什么可以比较的。

从历史上看，验证计算数字是否正确的标准方法是使用第二种算法重新计算数字。因此，如果任一计算出错，最后的数字将不匹配。

这通常是所需时间的两倍多（因为第二种算法通常较慢）。但这是验证计算数字的唯一方法，一旦您进入了从未计算过的数字和新的世界纪录的未知领域。

* * *

在超级计算机创造记录的时代，通常使用两种不同的[AGM 算法：](http://en.wikipedia.org/wiki/AGM_method)

*   [高斯-勒让德算法](http://en.wikipedia.org/wiki/Gauss%E2%80%93Legendre_algorithm)
*   [Borwein 算法](http://en.wikipedia.org/wiki/Borwein%27s_algorithm)

这两种`O(N log(N)^2)`算法都相当容易实现。

然而，如今，情况有些不同了。在最近的三项世界纪录中，我们没有进行两次计算，而是使用已知最快的公式（[楚德诺夫斯基公式](http://en.wikipedia.org/wiki/Chudnovsky_algorithm)）只进行了一次计算：

[![在此处输入图像描述](../Images/d7f763eb5dbe3b2915af7bcb3124ab5f.png)](https://i.stack.imgur.com/YO0MI.png)

这个算法实现起来要困难得多，但它比 AGM 算法快得多。

[然后我们使用BBP 数字提取公式](http://en.wikipedia.org/wiki/Bailey%E2%80%93Borwein%E2%80%93Plouffe_formula)验证二进制数字。

[![在此处输入图像描述](../Images/5cb7ee57e6b0a62140076c23d898c408.png)](https://i.stack.imgur.com/yC73N.png)

此公式允许您计算任意二进制数字*，而无需*计算它之前的所有数字。所以它用于验证最后几个计算的二进制数字。因此它比完整计算快得多***。***

这样做的好处是：

1.  只需要一次昂贵的计算。

缺点是：

1.  需要实现[Bailey-Borwein-Plouffe](http://en.wikipedia.org/wiki/Bailey%E2%80%93Borwein%E2%80%93Plouffe_formula) (BBP) 公式。
2.  需要一个额外的步骤来验证从二进制到十进制的基数转换。

[我已经掩盖了为什么验证最后几位数字意味着所有数字都是正确的一些细节。但很容易看出这一点，因为任何计算错误都会传播到最后一位。]

* * *

现在这最后一步（验证转换）实际上相当重要。之前的世界纪录保持者之一***实际上呼吁我们***这样做，因为最初，我没有充分描述它是如何工作的。

所以我从我的博客中提取了这个片段：

```
N = # of decimal digits desired
p = 64-bit prime number 
```

[![在此处输入图像描述](../Images/72c2e4851d9387f93635648378bcd8e1.png)](https://i.stack.imgur.com/eM9bu.png)

使用以 10 为底的算术计算 A，使用二进制算术计算 B。

[![在此处输入图像描述](../Images/33401b65dc61e802a3e1d9aadb462066.png)](https://i.stack.imgur.com/pyxWt.png)

如果`A = B`，则以“极高的概率”，转换是正确的。

* * *

如需进一步阅读，请参阅我的博文**[Pi - 5 Trillion Digits](http://www.numberworld.org/misc_runs/pi-5t/details.html)**。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2013-01-11T17:44:23.057

毫无疑问，为了您的目的（我假设这只是一个编程练习），最好的办法是对照网络上的任何 pi 数字列表检查您的结果。

我们怎么知道这些值是正确的？好吧，我可以说有计算机科学的方法来证明算法的实现是正确的。

更务实的是，如果不同的人使用不同的算法，并且他们都同意（选择一个数字）一千（百万，等等）小数位，那应该会给你一种温暖的模糊感觉，他们做对了。

从历史上看，William Shanks 在 1873 年将 pi 发布到小数点后 707 位。可怜的家伙，他从小数点后第 528 位开始犯了一个错误。

非常有趣的是，在 1995[年发布了一种算法](https://web.archive.org/web/20120310205303/http://www.math.hmc.edu/funfacts/ffiles/20010.5.shtml)，该算法具有直接计算 pi 的第 n 位（以 16 为底）*而无需计算所有前面的数字的*特性！

最后，我希望你的初始算法不是`pi/4 = 1 - 1/3 + 1/5 - 1/7 + ...`那可能是最简单的编程方法，但它也是最慢的方法之一。查看[Wikipedia 上的 pi 文章以](http://en.wikipedia.org/wiki/Pi)获得更快的方法。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-01-11T17:21:57.883

您可以使用多种方法，看看它们是否会收敛到相同的答案。或者从网上抢一些。Chudnovsky 算法通常用作计算 pi 的一种非常快速的方法。[http://www.craig-wood.com/nick/articles/pi-chudnovsky/](http://www.craig-wood.com/nick/articles/pi-chudnovsky/)

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2013-01-11T17:24:55.493

泰勒级数是近似 pi 的一种方法。如前所述，它收敛缓慢。

泰勒级数的部分和可以显示在下一项的某个乘数内，远离 pi 的真实值。

其他近似 pi 的方法有类似的方法来计算最大误差。

我们知道这一点，因为我们可以在数学上证明它。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-01-13T19:09:22.653

您可以尝试使用（相当）快速收敛的 sin 和 cos 幂级数来计算`sin(pi/2)`（或就此而言）。`cos(pi/2)`（更好的是：使用各种加倍公式来计算更接近`x=0`以更快地收敛。）

顺便说一句，比使用系列更好的`tan(x)`是，将计算说`cos(x)`成一个黑匣子（例如，您可以使用上面的泰勒级数）是通过牛顿进行根查找。当然有更好的算法，但是如果你不想验证大量的数字，这就足够了（而且实现起来并不那么棘手，你只需要一点微积分就可以理解它为什么起作用。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-03-20T12:41:13.767

有一种用于对 arctan 进行逐位评估的算法，只是为了回答这个问题，pi = 4 arctan 1 :)

# .net - 检查随机数的质量

> ID：14283272
> 
> 赞同：3
> 
> 时间：2013-01-11T17:15:39.090
> 
> 标签：.net, algorithm, random

我编写了一个代码，它根据一个私人密码学项目（出于教育目的）生成随机数。现在我想检查我的随机数生成器的质量如何。

我已经做过的测试：

*   一起计算所有数字并检查到零的距离（数字可以是负数和正数）
*   将随机数与`System.Random`类进行比较（重复的数字位于 .NET 随机生成器的一半）

我还能做些什么来检查算法的效果如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T23:57:49.240

卡方检验是随机性质量的标准统计检验。有关实现，请参见[http://en.wikibooks.org/wiki/Algorithm_Implementation/Pseudorandom_Numbers/Chi-Square_Test](http://en.wikibooks.org/wiki/Algorithm_Implementation/Pseudorandom_Numbers/Chi-Square_Test)。

如果您需要证明它在**密码学**上也很强大......嗯，这是一个更难的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-11T17:26:19.487

[TestU01](http://www.iro.umontreal.ca/~simardr/testu01/tu01.html)是一个软件库，以 ANSI C 语言实现，并为统一随机数生成器的经验统计测试提供了一组实用程序。

请参阅：P. L'Ecuyer 和 R. Simard，TestU01：用于对随机数生成器进行实证测试的 AC 库 ACM Transactions on Mathematical Software，Vol。33，第 22 条，2007 年。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-11T23:48:41.913

> 我还能做些什么来检查算法的效果如何？

最终的方法是给出一个正式的证明，证明*很难*将这个伪随机序列与真正的随机序列区分开来，例如，通过将这个区分问题简化为另一个被证明（或至少被强烈认为）很难的问题（例如取离散对数）。

密码学的这一部分称为可证明的*安全*性，它提供了一些很好的证明技术和概念（核心谓词、单向函数、区分攻击、混合分布……）。但是，只有当您的算法具有可以正式处理的数学基础时，才能应用它。

在这个领域，第一个质量检查是：如果你告诉世界其他地方你的算法的所有细节以及它的所有概念和想法，可以吗？如果不是，那么就有问题了，因为任何加密方案都不应该基于隐藏它的工作原理。*唯一*的秘密必须是个人密钥（分别是随机种子），而不是算法本身。例如，一旦知道了凯撒芯片的工作原理，它就很容易损坏。与此相反，AES 是一个开放标准，但仍被认为是安全的。

# jquery - 使用jquery对月份和日期进行字段验证

> ID：14283273
> 
> 赞同：0
> 
> 时间：2013-01-11T17:15:46.363
> 
> 标签：jquery, regex

我正在使用在[http://www.mathachew.com/sandbox/jquery-autotab/](http://www.mathachew.com/sandbox/jquery-autotab/)中找到的插件 （请查看它以了解我在说什么）。

在达到最大长度后从输入更改焦点..并验证输入，所以我在这里有这一行：

```
$("#day").autotab_filter({format:"custom", pattern:"0[1-9]|1[0-9]|2[0-1]|3[01]"});
$("#month").autotab_filter({format:"custom", pattern:"0[1-9]|1[012]"}); 
```

看来我的正则表达式模式是错误的或什么的！我已经尝试了所有可能的组合。请帮忙！

这是一个例子[http://jsfiddle.net/DAsRR/](http://jsfiddle.net/DAsRR/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T17:19:05.263

您的#day 模式：

```
0[1-9]|1[0-1]|2[0-1]|3[01] 
```

允许 01-09、10、11、20、21、30 和 31 的数字。我认为您正在寻找：

```
0[1-9]|1[0-9]|2[0-9]|3[01] 
```

不过，您的#month 模式对我来说看起来不错。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T15:39:02.853

我找到了答案，伙计们..如果将来有人需要它：我必须指定 01 到 31 之间数字的相反数，因为这是将被删除而不是保留的模式！所以要指定除 01 到 31 范围之外的所有数字，这是正确的模式：

```
[^0-9]|00|^[3][2-9]$|^[4-9] 
```

说明：`[^0-9]`不会除数字以外的任何字符！从 0 到 9
00，不是有效的天数！
并且`^[3][2-9]$`适用于所有以 3 开头并以 2 到 9 35 结尾的数字
，但它不是有效的天数！
并且`^[4-9]`适用于以 4 到 9 开头的数字。
关于该插件的任何其他问题，我很乐意回答

# c# - 如何拆分一行文本并将结果分配给多维数组？

> ID：14283274
> 
> 赞同：0
> 
> 时间：2013-01-11T17:15:46.293
> 
> 标签：c#, multidimensional-array, visual-studio-2012

我正在尝试读取一个由管道分隔的充满医疗记录的文本文件。大约有 20 列数据和数百万行。文本文件的大小约为 1GB。

第一步是读取数据。这是我的代码：

```
private void button1_Click(object sender, EventArgs e)
    {
        string strFilePath = @"abcrecords.txt";
        string[,] myArray;

        using (FileStream fs = new FileStream(strFilePath, FileMode.Open))
        using (StreamReader rdr = new StreamReader(fs))
        {
            while (!rdr.EndOfStream)
            {
                string[] strFileLine = rdr.ReadLine().Split('|');
                {
                    myArray = strFileLine;
                }
            }
        }
    } 
```

如何将分割线（有 20 个元素）的结果放入`myArray`. 然后将每个新的分割线添加到`myArray`？现在，我收到错误：

> 错误无法将类型“string[]”隐式转换为“string[ *,* ]”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:21:10.030

`List<string[]>`如果要修改它，请改用 a ，数组是不可变的。您还可以使用[`File.ReadLines`](http://msdn.microsoft.com/en-us/library/dd383503.aspx)更舒适的`StreamReader`（恕我直言）：

```
List<string[]> allLines = File.ReadLines(path)
    .Select(l => l.Split('|').ToArray())
    .ToList(); 
```

请注意，上面是一个 Linq 查询，需要添加`using System.Linq`.

关于我的方法的内存消耗的最后说明。`File.ReadLines`使用 a `StreamReader`under the hood 一次读取一行，这与一次`File.ReadAllLines`将所有内容读入内存不同，但您还可以进一步改进这种方法：

看看我自己的相关问题：[High memory consumption with Enumerable.Range?](https://stackoverflow.com/questions/10519275/high-memory-consumption-with-enumerable-range)

因此，您可以先读取行数以使用正确的大小初始化列表：

```
int count = File.ReadLines(path).Count();
var allLines = new List<string[]>(count);
var lines = File.ReadLines(path).Select(l => l.Split('|').ToArray());
allLines.AddRange(lines); 
```

否则，由于从`List.Add`.

但是你真的应该考虑改用数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T17:21:41.740

尝试这个：

```
 File.ReadAllLines("abcrecords.txt").Select(x => x.Split('|')).ToArray(); 
```

**更新**

因为文件很大，您可以使用：

```
 var result = new List<string[]>();
        using (FileStream fs = new FileStream(strFilePath, FileMode.Open))
        using (StreamReader rdr = new StreamReader(fs))
        {
            while (!rdr.EndOfStream)
            {
                result.Add(rdr.ReadLine().Split('|')))
            }
        } 
```

但是将这么大的对象存储在内存中会非常昂贵。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T17:49:36.773

借用了 Alexander Balte 的开头。

```
using (FileStream fs = new FileStream("", FileMode.Open))
{
  using (StreamReader rdr = new StreamReader(fs))
  {
    while (!rdr.EndOfStream)
    {
      DoSomethingWith(rdr.ReadLine().Split('|')));
    }
  }
}
void DoSomethingWith(String[] argColumns)
{
  // on y va
} 
```

# javascript - 如何在不替换文本的情况下在 div 上画一条线？

> ID：14283281
> 
> 赞同：11
> 
> 时间：2013-01-11T17:16:07.780
> 
> 标签：javascript, html, css

我有一系列带有文本的方形 div，我需要在这些 div 上画一条线，覆盖文本。Z-Index 不是一个选项。也不是`<strike>`，因为它需要扩展到整个 div，而不仅仅是文本。

我需要的是让它扩展到整个 div，但要在文本的顶部，就像在不同的层上一样，我正在尝试确定没有 Z-Index 是否有可能。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-11T17:21:22.060

`:after`在- [**DEMO**](http://jsfiddle.net/cX5L5/)的帮助下[](http://jsfiddle.net/cX5L5/)

 **```
div {
    position: relative;  
}

div:after {
  position: absolute;
  left: 0;
  top: 50%;
  height: 1px;
  background: #c00;
  content: "";
  width: 100%;
  display: block;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T17:27:42.500

[链接到小提琴](http://jsfiddle.net/vyUF7/)

```
.wrapper {
  position:relative;
  width:110px;
}
.square {
  width:20px;
  height:20px;
  border:2px solid #000;
  display:inline-block;
  text-align:center;
}
.strike {
  position:absolute;
  width:100%;
  height:2px;
  background:black;
  top:11px;
  left:0px;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T17:22:51.397

作为解决方案的背景图像怎么样？我的意思是一些CSS代码，例如：

```
.DIV.squarestroke {
 background: url(img_with-line.gif) repeat;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-11T17:58:08.703

如果您不能使用 text-decoration:line-through ，则很可能您的 div 上有填充或边距，这就是该行没有一直穿过的原因。此代码段将绘制一条 div 宽度的线，并通过保留您的填充或边距的文本。

```
<div style="border:solid 2px black; padding : 100px">
       <div class="strike-through" style="border-bottom : solid 1px red; margin-bottom : -12px;"></div>
       <div style="text-align : center; padding-left:50px; padding-right:50px; border : solid 1px green;">Lorem Ipsum Voluptatem</div>
  </div> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-11T17:21:20.500

一个好的老式人力资源可能会这样做：

```
 <hr style="position:absolute; width:50px; top:5px; left:5px;" /> 
```**

# javascript - 引用类的问题

> ID：14283298
> 
> 赞同：0
> 
> 时间：2013-01-11T17:17:12.910
> 
> 标签：javascript, ajax

我有一个名为 Clientes 的课程。我有一个在 AJAX 中发出请求的函数。见下文：

```
Clientes.prototype.listar_clientes = function(){

var url = "funcoes_ajax_clientes.php";
var params = "id_funcao=1";
var xmlhttp = chama_funcao_php_ajax( url, params );

xmlhttp.onreadystatechange=function(){
if (xmlhttp.readyState==4 && xmlhttp.status==200){
    var resposta_ajax = xmlhttp.responseText;
    var elementos_listbox_clientes = manipulacao_strings.separa_dados_string( resposta_ajax );
    var html_div_listbox_elementos = "<select name = \"listbox_elementos\" id = \"listbox_elementos\" multiple>";
    for( var contador = 0; contador < elementos_listbox_clientes.length; contador+=2 ){
        var indice_id = contador;
        var indice_nome = contador + 1;
        var indice_id_cliente = contador/2;
        this.ids_clientes.push( elementos_listbox_clientes[indice_id] );
        elemento_listbox_clientes = elementos_listbox_clientes[indice_nome];
        html_div_listbox_elementos+= "<option>";
        html_div_listbox_elementos+= elemento_listbox_clientes;
        html_div_listbox_elementos+= "</option>";
    }
    html_div_listbox_elementos+= "</select>";
    elementos_javascript.set_html_elemento( "div_listbox_elementos", html_div_listbox_elementos );
}
}

xmlhttp.send(params);    
} 
```

在

```
this.ids_clientes.push( elementos_listbox_clientes[indice_id] ); 
```

我想引用 Clientes 类，但正在引用 xmlhttp 类。在这种情况下如何引用 Clientes 类？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:18:46.317

在回调函数之外创建一个变量来保存范围。

```
var url = "funcoes_ajax_clientes.php";
var params = "id_funcao=1";
var xmlhttp = chama_funcao_php_ajax( url, params );
var that = this; //<-- create a variable to hold the scope
xmlhttp.onreadystatechange=function(){
if (xmlhttp.readyState==4 && xmlhttp.status==200){
    var resposta_ajax = xmlhttp.responseText;
    var elementos_listbox_clientes = manipulacao_strings.separa_dados_string( resposta_ajax );
    var html_div_listbox_elementos = "<select name = \"listbox_elementos\" id = \"listbox_elementos\" multiple>";
    for( var contador = 0; contador < elementos_listbox_clientes.length; contador+=2 ){
        var indice_id = contador;
        var indice_nome = contador + 1;
        var indice_id_cliente = contador/2;
        that.ids_clientes.push( elementos_listbox_clientes[indice_id] );
        elemento_listbox_clientes = elementos_listbox_clientes[indice_nome];
        html_div_listbox_elementos+= "<option>";
        html_div_listbox_elementos+= elemento_listbox_clientes;
        html_div_listbox_elementos+= "</option>";
    }
    html_div_listbox_elementos+= "</select>";
    elementos_javascript.set_html_elemento( "div_listbox_elementos", html_div_listbox_elementos );
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T20:22:46.977

为避免使用本地范围变量，您可以这样做：

```
var url = "funcoes_ajax_clientes.php";
var params = "id_funcao=1";
var xmlhttp = chama_funcao_php_ajax( url, params);
function changeCallback(){
  if (xmlhttp.readyState==4 && xmlhttp.status==200){
  var resposta_ajax = xmlhttp.responseText;
  var elementos_listbox_clientes = manipulacao_strings.separa_dados_string( resposta_ajax );
  var html_div_listbox_elementos = "<select name = \"listbox_elementos\" id = \"listbox_elementos\" multiple>";
for( var contador = 0; contador < elementos_listbox_clientes.length; contador+=2 ){
    var indice_id = contador;
    var indice_nome = contador + 1;
    var indice_id_cliente = contador/2;
    this.ids_clientes.push( elementos_listbox_clientes[indice_id] );
    elemento_listbox_clientes = elementos_listbox_clientes[indice_nome];
    html_div_listbox_elementos+= "<option>";
    html_div_listbox_elementos+= elemento_listbox_clientes;
    html_div_listbox_elementos+= "</option>";
}
html_div_listbox_elementos+= "</select>";
elementos_javascript.set_html_elemento( "div_listbox_elementos", html_div_listbox_elementos );
}
}
xmlhttp.onreadystatechange = changeCallback.bind(this); 
```

通常，当您想在特定范围内调用函数时，您会使用 bind 方法。

# delphi - Delphi：如何处理点击 PageControl 的空白区域？

> ID：14283304
> 
> 赞同：6
> 
> 时间：2013-01-11T17:17:38.577
> 
> 标签：delphi

我正在使用 Delphi 7。我想对 PageControl 空白区域的 click(left) 做出反应——在显示的最后一个选项卡右侧的区域。我怎样才能做到这一点？![带有页面控件的表单](../Images/877e6b4e9ccfeeb507d3a3aa267fb695.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-11T17:32:52.823

您可以在 PageControl 的父控件上处理单击。如果将 PageControl 放置在表单上，​​则将为该指定区域调用表单的“MouseDown”事件。原因是 PageControl 返回`HTTRANSPARENT`该区域的命中测试消息，因此鼠标消息被定向到它下面的控件。

如果这不行，您可以更改`WM_NCHITTEST`处理方式，例如通过子类化控件或在派生控件中：

```
type
  TMyPageControl = class(TPageControl)
  protected
    procedure WMNCHitTest(var Message: TWMNCHitTest); message WM_NCHITTEST;
  end;

procedure TMyPageControl.WMNCHitTest(var Message: TWMNCHitTest);
begin
  inherited;
  if Message.Result = HTTRANSPARENT then
    Message.Result := HTCLIENT;
end; 
```

然后，控件的`OnMouseDown`事件将被触发。当然你可以在修改消息的返回值之前测试区域，这个例子只是为了展示它是如何工作的。

# windows - 是否有推荐的方法从外部程序重复调用 matlab？

> ID：14283306
> 
> 赞同：4
> 
> 时间：2013-01-11T17:17:57.870
> 
> 标签：windows, matlab, batch-file, erlang

我反复`MyMatlabScript`从另一个程序（用 Erlang 编写）调用 matlab 脚本。我正在使用包含以下内容的批处理文件执行此操作：

```
matlab -nodesktop -nosplash -wait -r "addpath('C:/...'); MyMatlabScript; %quit;" 
```

这意味着每次我运行批处理文件脚本时都必须启动 Matlab。它可以工作，但速度很慢*。

为了提高性能，我希望能够一次启动 Matlab，然后以某种方式，使用 Erlang 或批处理脚本，使用那个 Matlab 实例重复启动我的 Matlab 脚本。

这可以做到吗？

注意，我在 Windows7 上使用 Matlab 7.8.0 (R2009a)。

*由于[此处](https://stackoverflow.com/questions/14233921/what-are-the-limitations-of-the-matlab-fileread-command-in-nodesktop-mode)概述的问题，速度特别慢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-11T17:52:16.663

这并不简单。但是您可以尝试在 MATLAB 中使用 COM 自动化服务器接口。您需要有用于与 COM 自动化服务器交互的 Erlang 库。使用此界面，您可以创建一个自动化服务器，然后继续向它发送命令。该文档可在[http://www.mathworks.com/help/matlab/call-matlab-com-automation-server.html](http://www.mathworks.com/help/matlab/call-matlab-com-automation-server.html)获得。在文档中有使用 Visual Basic 代码的示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-13T17:43:23.883

我不知道将消息传递到 Matlab 是否是一个可行的选择，但我想提出一个替代方案。Matlab 有一个“定时器”对象，它可以让你指定一个回调函数。Matlab 回调函数会定期检查一个文件，该文件由您的 Erlang 程序更改。更改的文件会触发所需的 Matlab 例程。好吧，就编程风格而言，它不是“高级美食”，但它应该可以胜任。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-20T02:37:35.873

我有这方面的经验。主要有以下三种选择：

1.  Erlang 命令行调用 Matlab 使用 os:cmd()

2.  编写一个要求两个应用程序分开并通过 tcpip 进行通信的协议。好处是现在 Erlang 是一个服务器，反之亦然，但是你编码它。挑战是 Matlab 中的协议代码，Erlang 是专门为它构建的。

3.  制作系统管道。如果您坚持使用 Windows (NamedSystemPipe)，那么您真的不应该在查找有关如何操作的文档时遇到问题。

对于仅本地通信，我更喜欢方法 3，而对于任何基于网络的东西，我更喜欢方法 2。使用 1 给您绝对最小的灵活性。还有更多，但既然你问，这是我推荐的。

最重要的是，不使用 1 就解决了“慢”问题。

# php - 将字符串保存到数组中

> ID：14283310
> 
> 赞同：1
> 
> 时间：2013-01-11T17:18:18.663
> 
> 标签：php, mysql, arrays

我有一个查询，可以在我的外借表中找到前 10 本书，但是我想将这十个值存储到一个数组中，以便我可以再次使用该数组。这是我到目前为止的代码......提前感谢您的帮助！

```
//select a database to work with
$selected = mysql_select_db("ds2",$dbhandle)
or die("Could not select examples");

//execute the SQL query and return records
 $result = mysql_query("SELECT book.title, book.book_id, count(book.book_id) AS     count_book_id, loan.book_id  FROM book
      INNER JOIN loan ON book.book_id = loan.book_id
      GROUP BY book.book_id ASC
      ORDER BY count(book.book_id) DESC");

 $titles = array();

while($row = mysql_fetch_array($result))
{
echo $row['title'];
echo "<br>";
}

echo "<br><br>";

for($index = 1; $index <= 10; $index++)
{
array_push($titles,$result[$row]);
print_r($titles);
echo "<br>";

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T17:21:51.430

而不是`echo $row['title']`您可以使用下面的代码将它们存储到数组中

```
$titles[] = $row['title']; 
```

稍后使用数组概念访问它们。

```
$titles[0]; // 1st item
$titles[1]; //2nd item 
```

您甚至可以使用 foreach 循环遍历所有项目。

```
foreach($titles[] as $title)
     echo $title; 
```

下面将允许您获得一个逗号分隔的字符串（如果您需要，仅供参考）

```
$comma_separated_titles = implode(",", $titles); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T17:21:57.480

尝试，

```
while($row = mysql_fetch_array($result))
  {
      echo $row['title']; 
      $arr[] = $row['title'];  //Store in an array          
      echo "<br>";
  }

  echo "<br><br>";

  //Since you need only 10 values, else this for loop is not required.
  for($index = 1; $index <= 10; $index++) 
      $titles[] = $arr[$index]['title'];  

  unset($arr); //unset the original array if you don't need it anymore.
  print_r($titles); //Print top 10 values
  echo "<br>"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T17:22:48.940

您应该在循环中填充数组，而不是在单独的循环中填充数组：

```
$count = 0;
while($row = mysql_fetch_array($result))
{
  echo $row['title'];
  echo "<br>";
  if ($count < 10)
  {
    array_push($titles, $row);
  }
  $count++;
} 
```

# asp.net-mvc - 将模型传递给控制器 并将结果发送到不使用表单提交的页面

> ID：14283311
> 
> 赞同：1
> 
> 时间：2013-01-11T17:18:20.257
> 
> 标签：asp.net-mvc, asp.net-mvc-3, model-view-controller

我正在写一个页面来向客户发送电子邮件。选择客户发送电子邮件的方法之一是选择他们拥有的产品。每个产品都有不同的详细信息，您还可以选择有关产品的详细信息以缩小您发送电子邮件的范围。

因为这会很复杂，所以我需要在控制器端进行处理以提供客户电子邮件列表，但尝试从控件中提取所有数据以手动发送给它将是一场噩梦。

我想在控制器端使用 AJAX 调用，将模型绑定到视图，查询数据库，然后发回电子邮件列表，这样我就可以在视图上为他们弹出带有电子邮件地址列表的 Outlook已经有人了。因为我需要用数据返回视图，所以我认为我不能通过表单发布来做到这一点，这是我通常将模型放入控制器的方式。

有人知道我怎么能做到这一点吗？

以下是我必须尝试帮助人们理解我的布局的一些课程

```
public class ProductType
{
    [HiddenInput(DisplayValue = false)]
    public int ID { get; set; }

    [Required(ErrorMessage = "Please enter a product type description")]
    public string Description { get; set; }

    public virtual ICollection<ProductTypeDetail> ProductDetails { get; set; }
}

public class ProductTypeDetail
{
    [HiddenInput(DisplayValue = false)]
    public int ID { get; set; }

    [HiddenInput(DisplayValue = false)]
    public int? ProductTypeID { get; set; }

    public ProductType ProductType { get; set; }

    [Required(ErrorMessage = "Please enter a description")]
    public string Description { get; set; }

    [Required(ErrorMessage = "Please enter a valid type")]
    public string Type { get; set; }

    public virtual ICollection<ProductTypeDetailValidValue> ValidValues { get; set; }
} 
```

以上 2 类是针对产品类型的，人们可以输入任何内容，并且可以输入任意数量。产品详细信息是您可能需要了解的有关产品的详细信息。例如，您可以拥有车辆登记系统的产品类型，并在其中放置一个产品详细信息项目，用于与您需要知道他们是否使用的产品相关的特定进口流程。

```
public Customer()
    {
        SiteVisits = new List<SiteVisit>();
        Payments = new List<Payment>();
        Contacts = new List<CustomerEmail>();
    }

    [HiddenInput(DisplayValue = false)]
    public int ID { get; set; }

    [Display(Name = "Name")] 
    [Required(ErrorMessage = "Please enter a customer name")]
    public string CustomerName { get; set; }

    [Display(Name = "Line 1")] 
    public string Address1 { get; set; }
    [Display(Name = "Line 2")] 
    public string Address2 { get; set; }
    [Display(Name = "Line 3")] 
    public string Address3 { get; set; }
    [Display(Name = "Line 4")] 
    public string Address4 { get; set; }

    public string City { get; set; }
    public string State { get; set; }
    public string Zip { get; set; }

    [HiddenInput(DisplayValue = false)]
    [Required(ErrorMessage = "Please enter a customer type")]
    public int CustomerTypeID { get; set; }

    [Display(Name = "Type")] 
    public virtual CustomerType CustomerType { get; set; }

    [HiddenInput(DisplayValue = false)]
    [Required(ErrorMessage = "Please enter a customer status")]
    public int CustomerStatusID { get; set; }

    [Display(Name = "Status")]
    public virtual CustomerStatus CustomerStatus { get; set; }

    [DataType(DataType.MultilineText)]
    public string Comments { get; set; }

    [Required(ErrorMessage = "Please enter an expiration year")]
    public long ExpirationYear { get; set; }
    [Required(ErrorMessage = "Please enter an expiration month")]
    public long ExpirationMonth { get; set; }

    [Required(ErrorMessage = "Please enter a control name")]
    public string ControlName { get; set; }

    public Boolean Networked { get; set; }
    public long Population { get; set; }

    [Display(Name = "First Fiscal Month")] 
    public long FirstMonth { get; set; }

    [Display(Name = "FTP User Name")]
    public string FTPUserName { get; set; }

    [Display(Name = "FTP Password")]
    public string FTPPassword { get; set; }

    [Display(Name = "Customer ID")]
    public string CustomerUpdateID { get; set; }

    [DataType(DataType.Date)]
    [Display(Name = "Customer Since")] 
    public DateTime? StartDate { get; set; }

    public virtual ICollection<CustomerPhoneNumber> PhoneNumbers { get; set; }
    public virtual ICollection<CustomerProduct> Products { get; set; }
    public virtual ICollection<CustomerEmail> Contacts { get; set; }
    public virtual ICollection<SiteVisit> SiteVisits { get; set; }
    public virtual ICollection<Payment> Payments { get; set; }
}

public class CustomerProduct
{
    [HiddenInput(DisplayValue = false)]
    public int ID { get; set; }

    [HiddenInput(DisplayValue = false)]
    public int? ProductTypeID { get; set; }

    public virtual ProductType ProductType { get; set; }

    [HiddenInput(DisplayValue = false)]
    public int CustomerID { get; set; }

    public virtual Customer Customer { get; set; }

    [HiddenInput(DisplayValue = false)]
    public int? VersionID { get; set; }

    public virtual ProductVersion Version { get; set; }

    [HiddenInput(DisplayValue = false)]
    public int? StatusID { get; set; }

    public virtual ProductStatus Status { get; set; }

    public virtual ICollection<CustomerProductDetail> ProductDetails { get; set; }

}

 public class CustomerProductDetail
{
    [HiddenInput(DisplayValue = false)]
    public int ID { get; set; }

    [HiddenInput(DisplayValue = false)]
    public int CustomerProductID { get; set; }

    public virtual CustomerProduct CustomerProduct { get; set; }

    [HiddenInput(DisplayValue = false)]
    public int ProductTypeDetailID { get; set; }

    public virtual ProductTypeDetail ProductTypeDetail { get; set; }

    //[Required(ErrorMessage = "Please enter a value")]
    public string Value { get; set; }

} 
```

所以上面我有客户类。可以为每个客户设置您设置的任意数量的产品类型，并且您可以为该特定客户的该产品类型的产品详细信息选择值。客户还包含联系人。那是具有电子邮件地址的类。

因此，我需要显示一个屏幕，显示您已设置的所有产品类型，并让您为所选产品的详细项目选择值，然后我需要查询并找到与此匹配的客户

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T13:50:10.560

我需要做的就是序列化表单并将其作为数据传递给我的 ajax 调用。如果在被调用的控制器端，我有一个与模型类型相同的参数，我的视图是强类型的模型绑定器足够聪明，可以自动填充我的对象

# mysql - 使用 MySQL GROUP BY 查找第三大价值

> ID：14283315
> 
> 赞同：3
> 
> 时间：2013-01-11T17:18:31.977
> 
> 标签：mysql, sql, select, sql-order-by

我有一个包含 3 列的表：

`Name` `department` `salary`

如何确定使用一个查询`salary`在每个查询中找到第三高`department`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-11T17:26:08.743

一种方法是`LIMIT`关联子查询，但它不是特别有效：

```
SELECT   department, (
  SELECT   salary
  FROM     my_table t2
  WHERE    t2.department = t1.department
  ORDER BY salary DESC
  LIMIT    2, 1
)
FROM     my_table t1
GROUP BY department 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-11T17:33:00.117

除了 eggyal 的出色回答之外，这里还有一个查询，它也会为您提供薪水等于第三（在每个部门）的人的姓名：

```
SELECT 
    t.name, t.department, t.salary AS third_salary
FROM
    ( SELECT DISTINCT department 
      FROM tableX
    ) AS d
  JOIN
    tableX AS t
      ON  t.department = d.department 
      AND t.salary = 
      ( SELECT tt.salary                         -- notice that this
        FROM tableX AS tt                        -- subquery is
        WHERE tt.department = d.department       -- exactly the same as
        ORDER BY tt.salary DESC                  -- the one in 
          LIMIT 1 OFFSET 2                       -- @eggyal's answer
      ) ; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-11T19:05:55.113

这个 RANK 问题类似于这个问题： [MySQL, Get users rank](https://stackoverflow.com/questions/1293817/mysql-get-users-rank)

我可以这样做：

```
SELECT  s.*,
        (
        SELECT  COUNT(*)
        FROM    salaries si
        WHERE   si.salary >= s.salary AND si.department = s.department
        ) AS rank
FROM    salaries s
WHERE s.rank = 3 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T17:35:00.413

试试这个：

```
SELECT name, department, salary
FROM (SELECT name, department, salary, IF(@dept=(@dept:=department), @auto:=@auto+1, @auto:=1) indx 
      FROM employee e, (SELECT @dept:=0, @auto:=1) A
      ORDER BY department, salary DESC ) AS A 
WHERE indx = 3; 
```

# .net - 使用 TFS 2010 运行异步任务单元测试

> ID：14283322
> 
> 赞同：3
> 
> 时间：2013-01-11T17:18:57.193
> 
> 标签：.net, unit-testing, tfs, async-await

我正在编写一个使用 Async 库以 .NET 4.0 为目标的 VS 2012 编写的应用程序。

我的自动构建在安装了 VS 2012 和 .NET 4.5 的 TFS 2010 构建代理上运行。

我到处读到，如果您的单元测试是异步的，它必须具有`async Task TestMethod()`签名（而不是`async void TestMethod()`）。

但是，当我这样做时，我的构建服务器给我这个方法的错误：

> 用 [TestMethod] 属性标记的测试方法必须是非静态的、公共的、不返回值且不应带任何参数。例如：public void Test.Class1.Test()。

我已阅读[此](http://social.msdn.microsoft.com/Forums/pl-PL/async/thread/6fb741ec-bec5-4bc4-82a8-04d025673c64)内容，[这](http://www.richard-banks.org/2012/03/how-to-unit-test-async-methods-with.html)表明如果您有 .testsetting 文件，则可能会导致此错误。但两者都表示它们适用于 TFS/VS 2012 的 beta 版本。

另外，我需要我的测试设置文件来打开代码覆盖率。

这是 TFS 2012 唯一的事情吗？TFS 2010 Build 代理不能使用 VS 2012 来正确运行这些吗？

**有没有办法在不升级到 TFS 2012 的情况下完成这项工作？**（我们距离升级还有几个月的时间）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-14T11:26:11.803

您可以使用类似于我[在博客](http://blog.stephencleary.com/2012/02/async-unit-tests-part-2-right-way.html)中描述的方法：只需将每个单元测试的代码包装在一个`AsyncContext.Run`（您可以`AsyncContext`从我的[AsyncEx NuGet 库](https://nitoasyncex.codeplex.com/wikipage?title=AsyncContext)中获取）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-14T09:03:57.023

I had the same problem, I solved it with a ugly workaround thats works on the build server (just until you upgrade to tfs 2012)

```
[TestMethod]
public void TestMethod()
{
  //TODO: fix this after upgrade to TFS2012 build server
  var task = TestMethodInnerMethod();
  task.Wait();
}

private async Task TestMethodInnerMethod()
{
  //Arrange

  //Act
  await Provider.StartAsync();

  //Assert
} 
```

Update: Even better solution, use [http://nuget.org/packages/Nito.AsyncEx/](http://nuget.org/packages/Nito.AsyncEx/) and wrap with AsyncContext.Run(...)

```
[TestMethod]
public void TestMethod()
{
  //TODO: fix this after upgrade to TFS2012 build server
  AsyncContext.Run(async () =>
  {
    //Arrange

    //Act
    await Provider.StartAsync();

    //Assert
  }
} 
```

# zend-framework2 - zend framework 2 - 翻译过程

> ID：14283325
> 
> 赞同：0
> 
> 时间：2013-01-11T17:19:12.007
> 
> 标签：zend-framework2

我正在使用 ZF2 开发网络应用程序。这是一个多语言网站。我想使用 ZF2 Translator 进行翻译。因为，管理员可以修改语言变量。所以，我打算使用语言文件夹文件。我将在管理员修改语言变量时更新语言文件。任何人都可以提出这个实现的想法吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:51:33.733

基于用户输入的翻译可能会有点混乱。现在没有简单的方法可以做到这一点，因为当前支持的格式都是文件格式：带有数组的 php 文件、gettext .po 文件或 Tmx/Xliff 文件。为了最简单的访问，您可能会将翻译存储在数据库中。

因此，您需要编写自己的加载器，从数据库加载翻译。另一种方法是您将翻译写入 php 数组并将其导出到文件中，但我不建议这样做。对于数据库加载器，您必须实现[`RemoteLoaderInterface`](https://github.com/zendframework/zf2/blob/master/library/Zend/I18n/Translator/Loader/RemoteLoaderInterface.php). 用非常简单的话来说：

```
use My\DbTable;
use Zend\I18n\Translator\Loader\RemoteLoaderInterface;
Zend\I18n\Translator\TextDoamin;

class DbLoader implements RemoteLoaderInterface
{
    protected $table;

    public function __construct(DbTable $table)
    {
        $this->table = $table;
   }

    public function load($locale, $textDomain)
    {
        $data = $this->table->loadFromLocale($locale);

        // process $data into $messages
        // $messages is array(key=>value) with key translation key

        $domain = new TextDomain($messages);
        return $domain;
    }
} 
```

db 表在您指定的语言环境中加载消息。如果您使用文本域，也请传递它。然后你需要配置你的`Translator`这样它也使用这个加载器来加载消息。那么其他一切都应该没问题。在您的视图中，您可以创建如下翻译：

```
<?php echo $this->translate('my original text'); ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T18:25:09.533

SkeletonApp 内置了翻译支持。然而，关于如何使用它的更多细节也可以在手册中找到 - > [http://zf2.readthedocs.org/en/latest/modules/zend.i18n.translating.html](http://zf2.readthedocs.org/en/latest/modules/zend.i18n.translating.html)

我个人将所有语言文件保存在一个名为 /language 的文件夹中

在您看来，您也可以简单地调用

```
$this->translate('text_you_want_to_translate'); 
```

# c# - 如何在 C# 中使用制表符分隔的文本文件填充数据表？

> ID：14283326
> 
> 赞同：1
> 
> 时间：2013-01-11T17:19:24.007
> 
> 标签：c#

我想用制表符分隔的文本文件填充 DataTable。文本文件包含如下数据：

```
Name   Id   Place
Sam    2001   USA
Raja    3455   India
Allan    90101   Canada 
```

当我使用`OleDBConnection`将文本文件导入 DataTable 时，我在 DataTable 中获取数据如下：

```
Name_Id_Place
Sam2001USA
Raja3455India
Allan90101Canada 
```

实际的文本文件有 3 列和 3 行，但在 DataTable 中，我将所有 3 列作为一个列`Name_Id_Place`。

谁能告诉我这个问题的解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T17:56:16.680

```
 static void Main()
    {
        //create a data table and add the column's
        DataTable table = new DataTable("table_name");
        table.Columns.Add("name", typeof (String));
        table.Columns.Add("id", typeof (Int32));
        table.Columns.Add("place", typeof (String));

        //start reading the textfile
        StreamReader reader = new StreamReader("file_to_read");
        string line;
        while ((line = reader.ReadLine()) != null)
        {
            string[] items = line.Split('\t');
            //make sure it has 3 items
            if (items.Length == 3)
            {
                DataRow row = table.NewRow();
                row["name"] = items[0];
                row["id"] = Int32.Parse(items[1]);
                row["place"] = items[2];
                table.Rows.Add(row);
            }
        }
        reader.Close();
        reader.Dispose();

        // make use of the table

        // when use is done dispose it
        table.Dispose();
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T15:48:55.210

在这里，我认为您以正确的方式从文本文件中读取数据，唯一的问题是我看到您使用的 Provider 无法理解列的结尾，那为什么将所有行读为一列

尝试使用 OleDBConnection 从文本文件中读取数据时，我得到了完全相同的结果。

在我作为提供者的连接字符串中，我使用了：

```
Provider=Microsoft.Jet.OLEDB.4.0; 
```

如果您使用相同，则只需在 Windows 注册表中更改此提供程序的“格式”选项：

```
HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Jet \ 4.0 \ Engines \ Text 
```

然后将“Format”键修改为value="TabDelimited"

或者如果您想使用其他分隔符（例如“;”）然后 Format = “Delimited(;)”

# regex - 通过咖啡脚本中的 sed 替换用引号括起来的两个相同字符串中的后者

> ID：14283328
> 
> 赞同：0
> 
> 时间：2013-01-11T17:19:31.173
> 
> 标签：regex, sed, coffeescript

这让我发疯了。我`sed`在 coffeescript 中使用来替换配置文件中的一行，如下所示：

```
'username' => 'username', 
```

我的代码如下所示：

`commands.push "sed -i '' '119 s/\(.\)username.,$/\1" + dbinfo.dbUser + "\1,/g' '" + tmpAppDir + "/drupal/sites/default/settings.php'"`

这应该完全有效，除了咖啡脚本将我的反向引用解释为八进制转义序列（在严格模式下不允许。

如果我能够转义单引号，我就不必使用反向引用，但在这种情况下这似乎不太可能。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T12:43:07.717

尝试用纯 javascript 包装你的代码```

```
`commands.push("sed -i '' '119 s/\(.\)username.,$/\1" + dbinfo.dbUser + "\1,/g' '" + tmpAppDir + "/drupal/sites/default/settings.php'");` 
```

这不是一个优雅的解决方案，但它可以轻松修复您的代码。

# clojure - Clojure 无限惰性序列，超出范围

> ID：14283330
> 
> 赞同：3
> 
> 时间：2013-01-11T17:19:36.617
> 
> 标签：clojure, sequence, lazy-evaluation

我最近才开始学习 Clojure，如果这有点初级，我深表歉意：

有人可以向我解释一下：

```
=> (def a (lazy-cat
            [0]
            (map inc a)
   ))

=> (take 5 a)
(0 1 2 3 4) 
```

和

```
=> (def b (lazy-cat
            [0]
            (map #(inc (nth b %)) (range))
   ))

=> (take 5 b)

IndexOutOfBoundsException   clojure.lang.RT.nthFrom (RT.java:773) 
```

我希望第二个示例以相同的方式运行，使用 b 的第一个元素来计算第二个，然后使用第二个来计算第三个。我的理解是，clojure 甚至不会尝试计算 b 的第三个元素，直到它已经为第二个元素分配了一个值并将其打印在屏幕上。

我很感激有人可以解释这里幕后实际发生的事情。

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T18:21:51.350

这种行为的原因是最简单情况下的`map`函数实现。`(map f colls)`看到不同：

```
user=> (def b (lazy-cat [0] (map (fn [i _] (inc (nth b i))) (range) (range))))
#'user/b
user=> (take 5 b)
(0 1 2 3 4) 
```

这有点令人困惑，但让我解释一下发生了什么。那么，为什么要`map`改变行为的第二个论点：

[https://github.com/clojure/clojure/blob/master/src/clj/clojure/core.clj#L2469](https://github.com/clojure/clojure/blob/master/src/clj/clojure/core.clj#L2469)

```
(defn map
  ...
  ([f coll]
   (lazy-seq
    (when-let [s (seq coll)]
      (if (chunked-seq? s)
        (let [c (chunk-first s)
              size (int (count c))
              b (chunk-buffer size)]
          (dotimes [i size]
              (chunk-append b (f (.nth c i))))
              (chunk-cons (chunk b) (map f (chunk-rest s))))
        (cons (f (first s)) (map f (rest s)))))))
  ([f c1 c2]
   (lazy-seq
    (let [s1 (seq c1) s2 (seq c2)]
      (when (and s1 s2)
        (cons (f (first s1) (first s2))
              (map f (rest s1) (rest s2)))))))
... 
```

答：优化的原因`chunked-seq`。

```
user=> (chunked-seq? (seq (range)))
true 
```

因此，值将被“预先计算”：

```
user=> (def b (lazy-cat [0] (map print (range))))
#'user/b
user=> (take 5 b)
(0123456789101112131415161718192021222324252627282930310 nil nil nil nil) 
```

当然，在你的情况下，这个“预先计算”失败了`IndexOutOfBoundsException`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T18:16:40.770

查看源代码`take`：

```
(defn take
  "Returns a lazy sequence of the first n items in coll, or all items if
  there are fewer than n."
  {:added "1.0"
   :static true}
  [n coll]
  (lazy-seq
   (when (pos? n) 
     (when-let [s (seq coll)]
      (cons (first s) (take (dec n) (rest s))))))) 
```

现在运行第一个案例。没有机会处理越界的数组。

对于您的第二个示例，您正在调用`nth`一个尚未扩展到 n 个元素的序列。b 将尝试将 0 与依赖于不存在的元素的序列连接起来。

# xaml - XAML TextBox：即使垂直对齐拉伸，如何保持高度固定？

> ID：14283332
> 
> 赞同：0
> 
> 时间：2013-01-11T17:19:36.823
> 
> 标签：xaml, textbox, height

我实现了一个自定义控件，它只包含一个标签和一个文本框来输入多行文本：

```
<DockPanel Name="MyStackPanel" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" LastChildFill="True" >
    <Label DockPanel.Dock="Top"  Content="{Binding MyTitle}" Style="{StaticResource PropertyNameLabelStyle}" />
    <TextBox DockPanel.Dock="Bottom" Text="{Binding Path=MyText, Mode=TwoWay}" IsReadOnly="{Binding MyIsReadOnly}" HorizontalAlignment="Stretch" AcceptsReturn="True" Margin="5,5,5,5" VerticalScrollBarVisibility="Visible" IsUndoEnabled="True"  />
</DockPanel> 
```

重要的是`TextBox`填充其父级必须提供的所有空间，但不能更多 - 这与上面的代码配合得很好。但是，如果用户键入的文本比显示的`TextBox`提供更多的文本会`TextBox`变得更大（更高），那么只需启用垂直`ScrollBar`，这就是我 - 我猜大多数其他程序员 - 想要的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-08T21:20:37.483

我对 XAML 很陌生，但我想你可能想试试这个：

我`VerticalAlignment`为 TextBox 本身设置了：

```
<TextBox Text="ABC" MinWidth="200" VerticalAlignment="Center">
</TextBox> 
```

它对我有用。

# android - 如果外部存储不可用怎么办？

> ID：14283334
> 
> 赞同：2
> 
> 时间：2013-01-11T17:19:39.430
> 
> 标签：android, android-sdcard

我的应用程序需要将数据写入文件（应该是用户可访问的）。现在我通常检查外部存储是否可用/可写。如果它可用且可写，应用程序将能够将数据保存到外部存储。根本没有外部存储可用，我的下一个选项应该是写入/存储用户可以轻松访问的数据。（将数据写入内部存储可能会让用户搜索感到沮丧）。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:21:24.740

如果外部存储不可用并且您希望数据可供用户访问，那么您应该显示一个对话框，通知用户他/她应该使外部存储可访问（放入 SD 卡或断开与计算机的连接，无论需要什么）。对于小文件，您可以尝试询问用户并将它们上传到他/她的保管箱或 Google Drive 或其他一些云存储帐户。

另外，请记住，正如 Budius 在评论中所说，所有设备都将有一个外部存储，即使它目前不可用。但这并不完全正确。所有已通过 Google 验证并具有 Google Play 的设备都将具有外部存储。运行自定义硬件和 Android 修改版本的设备可能不会。

# c++ - Waf - 找不到源：无

> ID：14283336
> 
> 赞同：1
> 
> 时间：2013-01-11T17:19:45.027
> 
> 标签：c++, c, compiler-errors, 64-bit, waf

我正在尝试使用 编译 64 位应用程序`Waf`，但`wscript`返回错误：

> `Source not found: None`.

我听说这可能是由于不正确的缩进或混合字符编码，而我`wscript`没有。

任何可能的解决方案/导致可能导致这种情况的原因是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T17:18:46.963

发现错误！以前，对于我使用的来源：

```
bld.path.find_resource(file_name) for file_name in 
```

文件路径之一不存在，因此资源变为无。由于我使用的是绝对文件路径，因此我通过更改为：

```
file_name for file_name in 
```

# python - 如何增加 networkx.spring_layout 的节点间距

> ID：14283341
> 
> 赞同：49
> 
> 时间：2013-01-11T17:19:50.120
> 
> 标签：python, graph, networkx, graph-drawing

绘制一个集团图

```
import networkx as nx
....
nx.draw(G, layout=nx.spring_layout(G)) 
```

生成以下图片：

![在此处输入图像描述](../Images/c247b61ccea716e23a55939e373e12ac.png)

显然，节点之间的间距（例如，边长）需要增加。我用谷歌搜索了这个并在这里找到[了这个建议](https://groups.google.com/forum/?fromgroups=&hl=en#!topic/networkx-discuss/HcxC3dxeaLk)：

> 对于某些布局算法，有一个`scale`参数可能会有所帮助。例如
> 
> ```
> import networkx as nx
> G = nx.path_graph(4)
> pos = nx.spring_layout(G)  # default to scale=1
> nx.draw(G, pos)
> pos = nx.spring_layout(G, scale=2)  # double distance between all nodes
> nx.draw(G, pos) 
> ```

但是，该`scale`参数似乎没有任何作用。

获得更好绘图的正确方法是什么？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2013-06-25T06:16:53.480

这个问题的解决方案在于 NetworkX 版本 1.8，它尚未发布，但可以通过 git hub 获得。

执行以下操作以增加节点之间的距离：

```
pos = nx.spring_layout(G, k=0.15, iterations=20)
# k controls the distance between the nodes and varies between 0 and 1
# iterations is the number of times simulated annealing is run
# default k=0.1 and iterations=50 
```

调整这些参数以查看其工作原理。但尽管如此，不能保证所有节点都不重叠

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2019-02-26T00:57:24.827

您的问题的*真正*答案是您的原始图不是一个单一的、[完全连接的组件](https://en.wikipedia.org/wiki/Connected_component_(graph_theory))。它是三个独立的图表。

正在发生的事情是这三个部分飞向无穷远，重新缩放后，每个组件看起来就像一个小斑点。

该算法指定了*所有*`spring_layout`节点之间的排斥力（反重力），以及*仅*连接节点之间的吸引力（“弹簧”）。

 **因此，如果图形没有连接，则各个部分将飞离排斥力，因为没有任何东西连接它们。有两个选项：更改力定律（编辑 networkx 代码），或单独绘制组件。

以下是如何添加将所有节点吸引到图表中心的力。将此代码段的最后一行添加到`def _fruchterman_reingold`layouts.py[中](https://github.com/networkx/networkx/blob/master/networkx/drawing/layout.py)：

```
# displacement "force"
displacement = np.einsum('ijk,ij->ik',
                         delta,
                         (k * k / distance**2 - A * distance / k))
# ADD THIS LINE - prevent things from flying off into infinity if not connected
displacement = displacement - pos / ( k * np.sqrt(nnodes)) 
```

这行代码允许您制作类似以下的图表： [![在此处输入图像描述](../Images/f028f1faf4b31c57973000204fce7e44.png)](https://i.stack.imgur.com/uSaoE.png) 而不是 [![在此处输入图像描述](../Images/91f4ef2d9b24204c6be91dedb7d2adb4.png)](https://i.stack.imgur.com/yUULV.png) 然而，处理此问题的“最佳”方法是分别绘制组件图表。

[您可以使用此处](https://networkx.github.io/documentation/stable/reference/algorithms/component.html)描述的功能迭代组件，将它们绘制在单独的图中。

有关更多讨论，请参阅[此 github 问题](https://github.com/networkx/networkx/issues/3325)。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2018-04-26T16:36:38.523

我使用了 Kamada Kawai 布局的最佳距离参数，并将非连接组件之间的距离设置为图中的最大距离。可能有更好的方法来修改字典，但这很容易：

```
df = pd.DataFrame(index=G.nodes(), columns=G.nodes())
for row, data in nx.shortest_path_length(G):
    for col, dist in data.items():
        df.loc[row,col] = dist

df = df.fillna(df.max().max())

layout = nx.kamada_kawai_layout(G, dist=df.to_dict()) 
```**

# jquery - 我想在 Ajax 调用后呈现部分视图

> ID：14283342
> 
> 赞同：2
> 
> 时间：2013-01-11T17:19:51.127
> 
> 标签：jquery, asp.net-mvc

我正在从 AJAX 调用返回部分视图，但它没有被渲染。看起来 showOtherTrade 函数没有被调用，见下面的代码；

我的观点是；

```
@model SCD.ViewModels.OtherTradesViewModel

@{
    ViewBag.Title = "Edit Other Trades";
}
<fieldset>
    <legend>Edit Other Trades for the subcontractor @Model.Subcontractor.CompanyName</legend>
    <p class="highlight">@ViewBag.Message</p>
    <p>The Primary Trade is set to @Model.PrimaryTradeName</p>

    <form method="get" action="@Url.Action("EditOtherTrades")" 
          data-scd-ajax="true" data-scd-target="#otherTradeList">
        <p>Select a trade: <input type="search" name="searchOtherTrade" id="searchOtherTrade" data-scd-autocomplete="@Url.Action("AutocompleteOtherTrade", "DataService")" style = "width: 300px;" class="submitSelection"/>
        </p>
    </form>  

    @Html.Partial("_OtherTrades", Model.OtherTrades.ToList())
</fieldset> 
```

我的 PartialView 是@model IList

```
<div id="otherTradeList">
    <table>
        @Html.DisplayForModel()
    </table>
</div> 
```

DisplayTemplate 是；

```
@model SubcontractorTrade
<tr>
    <td>@Model.Trade.TradeName </td>
    <td><input type="button" value="Remove"/>@Html.HiddenFor(model => model.TradeId)</td>
</tr> 
```

我正在使用自动完成连接到要添加到网格的数据项。

所以我的javascript看起来像；

```
var showOtherTrade = function (data) {
        var $form = $(this);
        var $target = $($form.attr("data-scd-target"));
        var $newHtml = $(data);
        $target.replaceWith($newHtml);
        $newHtml.effect("highlight");
    };

    var updateAutocompleteForm = function (event, ui) {
        var $input = $(this);

        if ($input.hasClass("submitSelection")) {
            $input.val("");
            var searchId = ui.item.id;
            url = AddOtherTradeUrl;
            dataService.addOtherTrade(searchId, showOtherTrade, url);
        } 
    };

    var createAutocomplete = function () {
        var $input = $(this);

        var options = {
            source: $input.attr("data-scd-autocomplete"),
            select: updateAutocompleteForm
        };

        $input.autocomplete(options);
    }; 
```

并且似乎未调用 showOtherTrade 函数。这可能是我需要解决的问题。

我的数据服务，如果你有兴趣，看起来像；

```
var dataService = new function () {
    $.ajaxSetup({
        cache: false
    });
    addOtherTrade = function(searchId, callback, url) {
        $.getJSON(url,
            { searchId: searchId },
            function(data) {
                callback(data);
            });
        };

        return {
            addOtherTrade: addOtherTrade
        };
} (); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T21:57:56.283

您可以在成功或失败 ajax 调用中调用此代码

```
$.get(action, null, function(data){
  $('#someDiv').html(data);
}, 'html'); 
```

你的控制器可能会返回：

```
return PartialView("SomePartial", Model) 
```

# hadoop - hbase shell 命令：如何使用 QualifierFilter

> ID：14283344
> 
> 赞同：2
> 
> 时间：2013-01-11T17:19:58.697
> 
> 标签：hadoop, hbase

在 hbase shell 中运行以下命令，尝试使**QualifierFilter**工作：

```
import org.apache.hadoop.hbase.filter.CompareFilter
import org.apache.hadoop.hbase.filter.SingleColumnValueFilter
import org.apache.hadoop.hbase.filter.SubstringComparator
import org.apache.hadoop.hbase.util.Bytes
import org.apache.hadoop.hbase.filter.QualifierFilter
import org.apache.hadoop.hbase.filter.BinaryComparator 
```

得到以下**错误**：

```
hbase(main):011:0>  scan 'test', { FILTER => QualifierFilter.new(CompareFilter.CompareOp.GREATER, 'dummy')}
NoMethodError: undefined method `CompareOp' for Java::OrgApacheHadoopHbaseFilter::CompareFilter:Class 
```

有人可以分享一个例子 hbase QualifierFilter 如何在 bhase shell 中工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-14T20:59:24.470

HBase 控制台是`JRuby-based`，您必须使用，`::`而不是`.`用于静态参考。

试试那个命令：

```
hbase(main):011:0>  scan 'test', { FILTER => QualifierFilter.new(CompareFilter::CompareOp::GREATER, 'dummy')} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-23T11:35:43.083

尝试

```
scan 'test', { FILTER => "QualifierFilter(>, 'regexstring:dummy*')" } 
```

查看[TestParseFilter.java](https://github.com/apache/hbase/blob/master/hbase-server/src/test/java/org/apache/hadoop/hbase/filter/TestParseFilter.java)以获得更多示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-07T19:20:39.660

如果您正在搜索确切的列名，您可以在 HBase shell 中发出这两个命令：

```
import org.apache.hadoop.hbase.filter.QualifierFilter
scan 'orgtable2', {FILTER => "QualifierFilter(=,'binary:lan')"} 
```

这将只显示包含该列的唯一记录的表列`lan`。`orgtable2`

更有可能的是，您可能希望显示存在`lan`（列族`cf1`）列的行的所有列。在这种情况下使用`DependantColumnFilter`：

```
import org.apache.hadoop.hbase.filter.DependentColumnFilter
scan 'orgtable2', {FILTER => "DependentColumnFilter('cf1','lan')"} 
```

如果您还想对与`lan`列关联的值应用条件，则使用 5 参数签名：

```
import org.apache.hadoop.hbase.filter.DependentColumnFilter
scan 'orgtable2', {FILTER => "DependentColumnFilter('cf1','lan',false,=,'binary:fre')"} 
```

因此，先前的扫描将返回存在“lan”列且其关联值等于 的行的所有列`fre`。第三个参数是`dropDependentColumn`并且如果设置为 true 将阻止`lan`列显示在结果中。更多细节[在这里](https://karthkk.wordpress.com/2014/04/12/using-columnfilters-in-hbase-shell/)。

# c# - ASP.NET MVC - Session["Layout"] 是某种预定义的词吗？

> ID：14283348
> 
> 赞同：0
> 
> 时间：2013-01-11T17:20:21.640
> 
> 标签：c#, asp.net-mvc

我`Session["Layout"]`用来确定用户有什么布局。但是一些奇怪的事情开始发生。有时在我的路线上：`forums/{action}/{variable}`它被放置在`action`空间中，有时它使我的控制器执行两次，第一轮使用正常的路线参数，第二轮`action`替换为`Session["Layout"]`！

当我停止使用`Session["Layout"]`，而是使用时，`Session["myLayout"]`一切又正常了。是`Session["Layout"]`某种预定义的关键字还是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:23:00.110

简而言之 - 不。

Asp.Net MVC 完全不依赖于 session（你可以完全禁用 Session 并且 MVC 可以正常工作）。因此，我建议您在引入会话时观察到的任何怪异都与您的代码单独相关。

当然 - 您使用的任何组件（nuget 包等）都可能需要会话；我不能代表那些。

# c# - 将两个不同类型的 List 匹配在一起

> ID：14283349
> 
> 赞同：5
> 
> 时间：2013-01-11T17:20:23.063
> 
> 标签：c#, linq, entity-framework

我有两张桌子，每张都有自己的型号...

```
 class FamilyMan
    { 
        public int family_ID {get; set;}

        public string name {get; set;}
        public string fav_color {get; set;}
    }

    class BusinessMan
    {
        public int work_ID {get; set;}

        public string name {get; set;}
        public string fav_color {get; set;}

        //unrelated data etc
        public string job_title {get; set;}
    } 
```

...并且我希望能够将所有 FamilyMans 与基于`name`和的匹配 BusinessMans 匹配`fav_color`。

我目前有类似的东西：

```
 //fill lists from database
    var family_list = dbContext.FamilyMen.ToList();
    var busy_list = dbContext.BusinessMen.ToList();
    //create empty dict for matching the two types
    var matches = new Dict<FamilyMan, BusinessMan>();

    foreach (FamilyMan fam_man in family_list) {
        foreach (BusinessMan busy_man in busy_list) {
            //if both names and colors match, consider them a matching
            //object and add them each to the dict
            if (fam_man.name == busy_man.name &&
                    fam_man.color == busy_man.color) {
                matches_MtO[fam_man] = busy_man;
            }
        }
    } 
```

但它需要相当长的时间才能完成。

我还研究过用 a 循环一个列表，`foreach`然后使用 LINQs FirstOrDefault 来匹配它们，但效率似乎差不多。

**有没有更好的方法来匹配`FamilyMan`s 和`BusinessMan`s ？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T17:39:22.157

像这样的 linq 查询会更快：

```
var matches = (
    from f in family_list
    join b in busy_list
    on f.color == b.color
    && f.name == b.name
    select new {f, b}
); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-11T17:41:55.330

您应该使用 LINQ 的连接语法。这将使后端数据库能够进行匹配，并且只返回结果。

为了在复合键上启用联接，请遵循[此处的 MSDN 指南。](http://msdn.microsoft.com/en-us/library/bb907099.aspx)

```
var query = from fm in dbContext.FamilyMen
            join bm in dbContext.BusinessMen on 
                new { bm.name, bm.color } equals new { fm.name, fm.color }
            select new {
               FamilyMan = fm,
               BusinessMan = bm
            };

var resultList = query.ToList(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-11T17:28:35.553

您正在遍历两个列表，即 O(N-squared)。

一旦一个项目被匹配，它就不必再次匹配。您可以从列表中删除匹配的项目，减少不必要的比较。

更好的是，由于您要匹配两个相同的属性，因此您可以使用表示组合属性的哈希作为键来构建字典。然后您可以遍历family_list_dictionary 的键并在busy_list_dictionary 中查找匹配的键。

# c# - 类似信息弹出的工具提示

> ID：14283353
> 
> 赞同：1
> 
> 时间：2013-01-11T17:20:33.410
> 
> 标签：c#, winforms, tooltip

我`treeview`在它们之间有两个和一个拖放功能。
当我将东西从一个控件拖到另一个控件时，我想要一个弹出窗口说：

```
3 item(s) added. 
```

A`tooltip`旨在将鼠标悬停在鼠标上以获取有关控件或其他内容的信息，但它具有有趣的属性，例如淡入淡出效果等。

我的另一个选择是使用 a`label`但我不想让它出现然后消失.. 也`label`似乎不是我正在寻找的控件。

这是常用的东西不是吗？这两者之间是否有适合我需要的控制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:45:08.640

您应该使用 System.Windows.Forms.Form 并使用以下值设置一些属性：

```
f.FormBorderStyle = None;
f.MaximizeBox = false; 
```

您也可以固定其大小。

这将为您提供基础。现在关于衰落。这可以使用`Opacity`时间范围内从 0% 到 100% 的属性来完成。这就是您开始所需的基本内容。

要显示此弹出窗口，只需使用如下常规代码：

```
PopupForm f = new PopupForm();
f.Show(); 
```

# python - Python子列表创建

> ID：14283354
> 
> 赞同：1
> 
> 时间：2013-01-11T17:20:37.797
> 
> 标签：python, sublist

我有一个被打乱的列表，然后我希望它被分解为 6 ​​个子列表，每个子列表有 6 个元素（原始列表中有 26 个元素）。我知道这需要通过范围（例如 0-5,6-11 等）创建子列表来完成，但不知道如何。它应该很简单！到目前为止，这是我的代码：

```
import random

characters = [0,1,2,3,4,5,6,7,8,9,"A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];

random.shuffle(characters) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:25:16.710

基于 itertools 石斑鱼配方

依赖于[itertools.izip_longest](http://docs.python.org/2/library/itertools.html#itertools.izip_longest)和自增量或迭代器

```
>>> list(izip_longest(*[iter(characters)] * 6))
[(0, 1, 2, 3, 4, 5), (6, 7, 8, 9, 'A', 'B'), ('C', 'D', 'E', 'F', 'G', 'H'), ('I', 'J', 'K', 'L', 'M', 'N'), ('O', 'P', 'Q', 'R', 'S', 'T'), ('U', 'V', 'W', 'X', 'Y', 'Z')] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T17:23:27.817

你可以使用这样的东西：

```
>>> import string
>>> import random
>>>
>>> chars = list(string.uppercase + string.digits)
>>> random.shuffle(chars)
>>>
>>> [chars[i:i + 6] for i in range(0, len(chars), 6)]
[['U', 'I', 'X', '6', 'Q', 'L'],
 ['Y', 'J', 'C', 'S', '8', '0'],
 ['A', 'R', '5', 'F', 'T', 'W'],
 ['N', 'B', 'E', '2', '1', 'V'],
 ['9', 'K', 'O', 'P', '7', '4'],
 ['G', 'M', 'Z', '3', 'D', 'H']] 
```

*   `chars[i:i + 6]``6`创建一个从 position 开始的长度子列表`i`。
*   `range(0, len(chars), 6)``0`在范围 from到 以`len(chars)`为增量循环`6`：

    ```
    >>> range(0, len(chars), 6)
    [0, 6, 12, 18, 24, 30] 
    ```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T17:23:29.493

使用`itertools.islice()`：

```
In [246]: characters = [0,1,2,3,4,5,6,7,8,9,"A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];

In [247]: it=iter(characters)

In [248]: [list(islice(it,6)) for _ in range(6)]
Out[248]: 
[[0, 1, 2, 3, 4, 5],
 [6, 7, 8, 9, 'A', 'B'],
 ['C', 'D', 'E', 'F', 'G', 'H'],
 ['I', 'J', 'K', 'L', 'M', 'N'],
 ['O', 'P', 'Q', 'R', 'S', 'T'],
 ['U', 'V', 'W', 'X', 'Y', 'Z']] 
```

`iter(characters)`: 创建`characters`列表的迭代器。

`islice(iterator,len)`:返回 的迭代器的切片`len=6`。Islice 对象本身就是一个迭代器，因此，您需要将`islice`对象传递给以`list()`获取它的内容。

`6`传递给`range`可以通过以下方式获得：

```
In [2]: int(len(characters)/6)
Out[2]: 6 
```

# c# - 在 MVC3 中正确编码/解码潜在危险的表单值

> ID：14283363
> 
> 赞同：0
> 
> 时间：2013-01-11T17:21:13.203
> 
> 标签：c#, asp.net-mvc-3, encoding

我在表单中有一个“描述”字段。我希望用户不被限制在此字段中使用特殊字符。

因此，我希望能够将以下数据从我的客户端发布到我的服务器，保存到数据库，并能够再次正确呈现：

> 测试说明 ( *&* &%$^&^() *^&&$&* 87566467679089765 ?<>?<>?<>?<>":";';';'][][][][{}{} {}

我对该主题进行了一些阅读，但似乎我的选择比我预期的要多。为了安全起见，我想确保我正确地执行此操作。

在我的模型中，我使用 AllowHtml 属性标记了我的 Description 属性：

```
[DisplayFormat(ConvertEmptyStringToNull = false), AllowHtml]
public string Description { get; set; } 
```

这允许将上述数据发布到我的控制器，但不能解决问题的核心。我现在相信我需要清理我的输入。我相信这意味着我需要利用 HttpUtility 库。

查看 HttpUtility，我看到了很多方法：

*   HtmlAttributeEncode
*   html编码
*   网址编码

根据[这篇文章](https://stackoverflow.com/questions/602642/server-urlencode-vs-httputility-urlencode)，HtmlEncode 和 UrlEncode 之间似乎没有太大区别。

我想知道几件事：

*   在这里使用 HttpUtility 是正确的选择吗？
*   在 POST 之前不对我的输入进行任何处理可以吗？（我可以在服务器端进行所有编码吗？）
*   我应该使用 Microsoft 反 xss 库而不是 HttpUtility 吗？

以及通常我可能不会被告知的任何其他陷阱。

**更新：**

这是我的模型：

```
<div class="detailsRow optional">
    <%= Html.LabelFor(model => model.Description, new { @class = "descriptionLabel" }, Model.DescriptionLabel)%>
    <%= Html.TextAreaFor(model=> model.Description) %>
</div> 
```

和我的控制器方法：

```
public ActionResult SaveNewOrderDetails(NewOrderDetailsModel orderDetailsModel)
{
    string description = orderDetailsModel.Description;
    //Successfully got description
    //Example code:
    Order order = new Order(description);
    order.Save();

    return Json(new { id = order.ID, name = order.Name });
} 
```

在我的代码通过“return Json”语句后，我遇到了另一个错误：

> 从客户端检测到潜在危险的 Request.Form 值 (Description="...>?<>?<>?<><?>":";';';'][][][][. ..”）。

我的理解是这不应该发生。我应该检查哪些地方？

**UPDATE2**：无法让 AllowHtml 工作。当我们升级到 MVC4 时，我将重新讨论这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T17:24:28.737

> 我现在相信我需要清理我的输入。

不，就接收用户输入并将其存储到数据库中而言，您很好（假设您使用了应该始终执行的参数化查询）。该`[AllowHtml]`属性将使您可以输入任何字符。如果您想清理用户可以输入的字符，只需使用正则表达式验证器（我可能不会为此烦恼）：

```
[DisplayFormat(ConvertEmptyStringToNull = false)]
[AllowHtml]
[RegularExpression("PUT YOUR REGEX HERE")]
public string Description { get; set; } 
```

当您将从数据库读取的值呈现回视图时，您应该小心。您应该确保始终对它进行 HTML 编码。例如，该`<%:`功能开箱即用。

因此，这是一种安全的显示方式：

```
<div>
    <%: Model.Description  %>
</div> 
```

小心**不**要这样做：

```
<div>
    <%= Model.Description  %>
</div> 
```

因为这**不会**对输出进行 HTML 编码，并且您的站点容易受到 XSS 的攻击。

这是使用`DisplayFor`助手的另一种安全方法：

```
<div>
    <%= Html.DisplayFor(x => x.Description) %>
</div> 
```

此外，如果您想在可编辑字段或文本区域中呈现它，只需使用相应的帮助器：

```
<div>
    <%= Html.TextAreaFor(x => x.Description) %>
</div> 
```

# javascript - jQuery.easing.js 兼容性问题

> ID：14283372
> 
> 赞同：-2
> 
> 时间：2013-01-11T17:21:33.323
> 
> 标签：javascript, jquery, jquery-plugins, jquery-easing

在[这个站点](http://open-pages.com/Alpinemadotcom/)，菜单和幻灯片横幅不能一起使用。

下面之前`</body>`每个菜单和横幅都有两个脚本，它们使用相同或不同的 jQuery 版本。

如果我使用*其中一个*或*两个*版本。菜单不能正常工作，或者横幅不能通过点击和淡入淡出或幻灯片（突然的图像变化）工作。

有什么问题？

**- - - - 更新 - - - -**

我发现，经过一番尝试和尝试，这`jquery.easing.js`会导致横幅出现问题，如果排除在外，菜单将不起作用。`jquery.easing.compatibility.js`也解决不了问题。我怀疑`jquery.min.js`（v1.3.2）也引起了问题。

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:38:00.067

有关文档，请参阅[http://gsgd.co.uk/sandbox/jquery/easing/](http://gsgd.co.uk/sandbox/jquery/easing/)。`jquery.easing.compatability.js`使用旧的缓动名称。如果菜单使用新名称 ( `jquery.easing.js`)，那就有问题了。菜单脚本应该允许您将转换名称更改为旧的等效名称，然后您只能使用`jquery.easing.js`.

`jQuery.min.js`不是问题。但是，由于 jQuery 1.3 比 1.8 明显旧，它可能包含滑块使用的已弃用属性。尝试只使用 v3.2，或者找一个新的滑块插件。

# c# - 为什么编译器即使对于非虚拟方法也会发出 callvirt ？

> ID：14283373
> 
> 赞同：2
> 
> 时间：2013-01-11T17:21:40.343
> 
> 标签：c#, virtual-functions

> **可能重复：**
> [为什么 C# 编译器会为 GetType() 方法调用发出 callvirt 指令？](https://stackoverflow.com/questions/845657/why-is-the-c-sharp-compiler-emitting-a-callvirt-instruction-for-a-gettype-meth)

我看到当我调用类的实例方法时，C# 编译器会发出 `callvirt`调用该方法的指令，为什么会这样？

这是否意味着所有实例方法都被编译器视为`virtual methods`，这是什么奥秘？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-11T18:35:14.953

它可以实现 C# 语言规范中的承诺。这说明通过空引用调用类的实例方法是不合法的。这听起来像是一个明显的特性，但实际上在 OOP 语言中并不常见。特别是 C++/CLI 编译器没有它。而 CLI 规范没有它。像 C++ 这样的非托管语言没有它。

有时，当实例方法不使用任何非静态类成员时，它甚至会达到一个好的结局。这种方法当然应该是静态的，但这不是必需的或强制的。

C# 要求非常好，它使`NullReferenceException`诊断更容易。由于它们是在调用站点而不是在实例方法内部生成的，因此它阐明了对象引用为空。找出方法中的*this*引用为 null 有点困难，尤其是因为您看不到它。由于地址实际上不是空的，因此更复杂的是，访问类的字段将生成一个从 0 偏移的地址。如果对象非常庞大，超过 64 KB，这反过来又是*不安全的。*访问如此大对象末尾的字段不一定会产生处理器异常，您只会读取随机垃圾。或者如果你写它会损坏内存。

因此，C# 团队寻找一种廉价的方法来实现空测试。并在`callvirt`IL 指令中找到了一个。与 不同的是`call`，*它确实*在 CLI 规范中承诺了一个例外。一个非常便宜的测试，它只需要一条机器代码指令。并且不需要分支，如果处理器的分支预测逻辑猜错了，那将非常昂贵。

您现在也知道为什么 String.Equals() 包含这段神秘代码：

```
public override bool Equals(Object obj) {
    if (this == null)
        throw new NullReferenceException();
    // etc...
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-01-11T19:47:11.937

汉斯和迈克的答案是正确的。只是添加一点额外的信息：

*   该`callvirt`指令在非虚拟方法上被明确记录为合法，以便您获得空检查行为。

*   在 C# 编译器证明非虚拟调用不可能有空接收器的极少数情况下，它会回退到`call`并节省执行空检查所需的纳秒时间。例如，如果你有`(new C()).InstanceMethod()`then 应该生成为`call`，而不是`callvirt`因为编译器知道接收表达式永远不会为空。（如果分配失败，则抛出异常，因此永远不会执行调用。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-11T17:23:55.713

**简短的回答：**这样更安全。

`callvirt`将首先检查对象是否为空，如果是则抛出异常。

您会注意到调用静态方法仍将使用`call`，因为对象不能为空。

[这里](http://blogs.msdn.com/b/ericgu/archive/2008/07/02/why-does-c-always-use-callvirt.aspx)有一点历史。

# android - 如何将布尔数组定义为 XML 中的资源？

> ID：14283378
> 
> 赞同：2
> 
> 时间：2013-01-11T17:21:51.230
> 
> 标签：android, arrays, boolean, android-xml, typed-arrays

使用 Android 的资源系统，你可以像这样定义一个字符串数组：

```
<string-array name="my_string_array">
    <item>One</item>
    <item>Two</item>
    <item>Three</item>
    <item>Four</item>
</string-array> 
```

还有一个像这样的整数数组：

```
<integer-array name="my_integer_array">
    <item>1</item>
    <item>2</item>
    <item>3</item>
    <item>4</item>
</integer-array> 
```

你如何定义一个布尔数组？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-11T17:29:37.113

我相信布尔数组没有内置类型。您可能可以使用类型化数组，请参阅[http://developer.android.com/guide/topics/resources/more-resources.html](http://developer.android.com/guide/topics/resources/more-resources.html)。如果没有，您可以通过 ints 实现一个良好的旧 C 方式 - 0 为假，非零为真。

# android - 空指针错误 RSS 提要

> ID：14283381
> 
> 赞同：0
> 
> 时间：2013-01-11T17:22:02.977
> 
> 标签：android, rss, android-asynctask, nullpointerexception

我正在尝试构建一个基本的 RSS 提要。我在代码中没有显示任何错误，但是当我运行应用程序时，它会因以下错误而崩溃：

**致命异常：AsyncTask #1 java.lang.RuntimeException：执行 doInBackground() 时发生错误**

这是我的 MainActivity.java 代码：

```
public class MainActivity extends ListActivity {

List<String> headlines;
List<String>links;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    //initialize variables
    headlines = new ArrayList<String>();
    links = new ArrayList<String>();

    new PostTask().execute();

    //binding data to list
    ArrayAdapter <String>adapter=  new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, headlines);
    setListAdapter(adapter);
}

private InputStream getInputStream(URL url) {
    try{
        return url.openConnection().getInputStream();
    }catch(IOException e){
        return null;
    }
}

@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
    Uri uri = Uri.parse(links.get(position));
    Intent intent = new Intent(Intent.ACTION_VIEW, uri);
    startActivity(intent);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

//ASYNCH CLASS
private class PostTask extends AsyncTask<String, Integer, String>{

    @Override
    protected String doInBackground(String... arg0) {
        try{
            //link to data source
            URL url = new URL("http://feeds.pcworld.com/pcworld/latestnews");

            //Set up parser
            XmlPullParserFactory factory = XmlPullParserFactory.newInstance();
            factory.setNamespaceAware(false);
            XmlPullParser xpp = factory.newPullParser();

            //get XML from input stream
            xpp.setInput(getInputStream(url), "UTF_8");

            //Keep track of which tag inside of XML
            boolean insideItem = false;

            //Loop through the XML file and extract data required
            int eventType = xpp.getEventType();
            while(eventType != XmlPullParser.END_DOCUMENT){
                if(xpp.getName().equalsIgnoreCase("item")){
                    insideItem = true;
                }else if(xpp.getName().equalsIgnoreCase("title")){
                    if(insideItem){
                        //Get title
                        headlines.add(xpp.nextText());
                    }
                }else if(xpp.getName().equalsIgnoreCase("link")){
                    if(insideItem){
                        //Get link
                        links.add(xpp.nextText());
                    }
                }else if(eventType==XmlPullParser.END_TAG && xpp.getName().equalsIgnoreCase("item")){
                insideItem = false;
            }
            eventType = xpp.next();//move to next element
        }
    }catch(MalformedURLException e){
        e.printStackTrace();
    }catch(XmlPullParserException e){
        e.printStackTrace();
    }catch(IOException e){
        e.printStackTrace();
    }
        return null;
    }

    public void onPostExecute(URL url) {

    }

} 
```

}

谁能指出我哪里出错了？非常感谢！

记录猫错误：

```
01-11 17:27:50.061: E/AndroidRuntime(7746): FATAL EXCEPTION: AsyncTask #1
01-11 17:27:50.061: E/AndroidRuntime(7746): java.lang.RuntimeException: An error occured while executing doInBackground()
01-11 17:27:50.061: E/AndroidRuntime(7746):     at android.os.AsyncTask$3.done(AsyncTask.java:299)
01-11 17:27:50.061: E/AndroidRuntime(7746):     at java.util.concurrent.FutureTask.finishCompletion(FutureTask.java:352)
01-11 17:27:50.061: E/AndroidRuntime(7746):     at java.util.concurrent.FutureTask.setException(FutureTask.java:219)
01-11 17:27:50.061: E/AndroidRuntime(7746):     at java.util.concurrent.FutureTask.run(FutureTask.java:239)
01-11 17:27:50.061: E/AndroidRuntime(7746):     at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:230)
01-11 17:27:50.061: E/AndroidRuntime(7746):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1080)
01-11 17:27:50.061: E/AndroidRuntime(7746):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
01-11 17:27:50.061: E/AndroidRuntime(7746):     at java.lang.Thread.run(Thread.java:856)
01-11 17:27:50.061: E/AndroidRuntime(7746): Caused by: java.lang.NullPointerException
01-11 17:27:50.061: E/AndroidRuntime(7746):     at com.example.simplerss.MainActivity$PostTask.doInBackground(MainActivity.java:89)
01-11 17:27:50.061: E/AndroidRuntime(7746):     at com.example.simplerss.MainActivity$PostTask.doInBackground(MainActivity.java:1)
01-11 17:27:50.061: E/AndroidRuntime(7746):     at android.os.AsyncTask$2.call(AsyncTask.java:287)
01-11 17:27:50.061: E/AndroidRuntime(7746):     at java.util.concurrent.FutureTask.run(FutureTask.java:234)
01-11 17:27:50.061: E/AndroidRuntime(7746):     ... 4 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T18:12:38.637

我猜想当引用一组标签内的文本`xpp.getClass()`时返回 null 。`xpp`如果您查看[XmlPullParser 文档](http://developer.android.com/reference/org/xmlpull/v1/XmlPullParser.html)中的示例：

```
 while (eventType != XmlPullParser.END_DOCUMENT) {
  if(eventType == XmlPullParser.START_DOCUMENT) {
      System.out.println("Start document");
  } else if(eventType == XmlPullParser.START_TAG) {
      System.out.println("Start tag "+xpp.getName());
  } else if(eventType == XmlPullParser.END_TAG) {
      System.out.println("End tag "+xpp.getName());
  } else if(eventType == XmlPullParser.TEXT) {
      System.out.println("Text "+xpp.getText());
  }
  eventType = xpp.next();
 } 
```

请注意，焦点在`eventType`. 如果您只想抓取`"title"`和 `"link"`标记，请在以下部分中添加这些检查`START_TAG`：

```
else if(eventType == XmlPullParser.START_TAG) {
    if(xpp.getName().equalsIgnoreCase("title")){
        //Get title
    }else if(xpp.getName().equalsIgnoreCase("link")){
        //Get link
    }
} 
```

# variables - 将值从一个子报表传递到另一个子报表

> ID：14283382
> 
> 赞同：1
> 
> 时间：2013-01-11T17:22:06.663
> 
> 标签：variables, jasper-reports, global

我有一份带有两个子报告的报告。第一个子报告有我需要用于第二个子报告的总数。子报表有没有办法设置父报表参数或变量或使用全局变量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T18:19:41.240

我正在使用 iReport 5.0。当我单击主报表中的子报表时，在“参数”下的“属性”框中，有一个“返回值”选项。尝试将此设置为您希望子报表传递回主报表的内容。

# silverlight - 如何在silverlight4中获取组合框的数据模板内部的控件

> ID：14283384
> 
> 赞同：0
> 
> 时间：2013-01-11T17:22:11.427
> 
> 标签：silverlight, silverlight-4.0, silverlight-3.0, silverlight-5.0

我在 silverlight4 的组合框的数据模板中有一个复选框。现在我想在它的 selectedindex 更改事件上获取组合框中的复选框。那么我该怎么做呢？

这是我的代码：

```
 <ComboBox Height="Auto" x:Name="CB_Categories" SelectionChanged="CB_Categories_SelectionChanged" Tag="">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                    <CheckBox IsChecked="False" Content="{Binding Name}" CommandParameter="{Binding ProductCategoryID}" Click="CheckBox_Click" />
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox> 
```

请帮帮我。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T12:45:41.340

虽然可以这样做，但最好将要调查或更改的复选框属性绑定到背景视图模型或控制器中的值。

例如，如果`IsChecked`您想将其更改为 true，请尝试以下操作：

```
<CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay}" Content="{Binding Description}" /> 
```

然后，您`ComboBox`使用其`ItemsSource`属性将 连接到项目列表：

```
<ComboBox ItemsSource="{Binding Options}">
    <ComboBox.ItemTemplate>
        <CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay}" Content="{Binding Description}" />
    </ComboBox.ItemTemplate>
</ComboBox> 
```

此外，您还必须设置`DataContext`容器控件的 或`ComboBox`以便控件可以访问具有这些属性的对象。

这样做，意味着您可以在控件或窗口的代码隐藏中使用更少的代码，这些代码只是在执行管道工作，例如更新控件。

如果您需要更多示例，请告诉我...

# jquery - 通过逗号分隔的值字符串获取所有唯一数据属性值以列出

> ID：14283386
> 
> 赞同：0
> 
> 时间：2013-01-11T17:22:18.563
> 
> 标签：jquery, drop-down-menu

我有这个动态 HTML

```
<select id='posto'>
  <select>
    <ul id="nazioni">
      <li data-dal="Europa, Mediterraneo">Italia</li>
      <li data-dal="Europa, Mediterraneo">Spania</li>
      <li data-dal="Asia">Cina</li>
      <li data-dal="Europa, Asia, Mediterraneo">Turchia</li>
      <li data-dal="Africa, Mediterraneo">Egitto</li>
      <li data-dal="Europa">Francia</li>
      <li data-dal="Europa">Svezia</li>
    </ul> 
```

我正在尝试使用带有“data-dal”值的标签填充选择，我试图通过逗号和空格将其拆分为单独的值。我是一个新的 jQuery 和 Javascript 新手，但我已经设法将我在 stackOverflow 和 jQuery 手册中找到的一些代码拼凑在一起，但无法将所有部分拼凑成我想要的代码。

```
var items = {};
$('#nazioni li').each(function () {
  items[$(this).data('dal').split(', ')] = true;
});

var result = new Array();
for (var i in items) {
  result.push('<option>' + i + '</option>');
}

$('#posto').show().empty().append(result.join());

$('#posto').change(function () {
  var selected = $(this).find('option:selected').text();
  $('li[data-dal=' + selected + ']').show();
  $('li[data-dal!=' + selected + ']').hide();
}); 
```

[http://jsfiddle.net/urnPG/](http://jsfiddle.net/urnPG/) 我把它弄乱了。我无法将 data-dal 值拆分为单独的值。我将不胜感激以更好的方式提供任何帮助或指示。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T18:55:35.790

我不确定我是否正确理解了您的问题。但是，让我尽我所能帮助你。首先这里更新了[JSFIDDLE。](http://jsfiddle.net/urnPG/2/)

我可以将`<li>`元素值拆分为一个唯一值数组并`<Select>`用这些值填充。

```
$('#nazioni li').each(function () {
   var arr = $(this).data('dal').split(", ");
   items = items.concat(arr);
 });
 var sorted = unique(items); 
```

此函数获取列表的唯一值。

```
function unique(list) {
   var result = [];
   $.each(list, function(i, e) {
     if ($.inArray(e, result) == -1) result.push(e);
       });
   return result;
} 
```

然后我尝试显示`<li>`与所选下拉值对应的所有元素。

# java - JSON反序列化失败？(servlet->applet 通信)

> ID：14283389
> 
> 赞同：1
> 
> 时间：2013-01-11T17:22:33.977
> 
> 标签：java, json, serialization, gson

我正在尝试使用 Json 格式和 Gson 库发送一些简单的字符串来测试我的 servlet 和 applet（servlet -> applet，而不是 applet -> servlet）之间的数据传输。小程序中的结果字符串应该与原始消息完全相同，但事实并非如此。我得到的是 9-character **< !DOCTYPE**字符串。

编辑：看起来servlet返回了HTML网页而不是JSON，不是吗？
edit2：在 NetBeans 中使用“运行文件”命令启动 servlet 时，该消息在浏览器中正确显示。

你能看看我的代码：

小服务程序：

```
//begin of the servlet code extract
protected void processRequest(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException
{
    PrintWriter out = response.getWriter();
    try
    {
        String action;
        action = request.getParameter("action");
        if ("Transfer".equals(action))
        {
            sendItToApplet(response);
        }
    }
    finally
    {
        out.close();
    }
}

public void sendItToApplet(HttpServletResponse response) throws IOException
{
    String messageToApplet = new String("my message from the servlet to the applet");
    String json = new Gson().toJson(messageToApplet);
    response.setContentType("application/json");
    response.setCharacterEncoding("UTF-8");

    Writer writer = null;
    writer = response.getWriter();
    writer.write(json);
    writer.close();
}
//end of the servlet code extract 
```

小程序：

```
//begin of the applet code extract
public void getItFromServlet() throws MalformedURLException, IOException, ClassNotFoundException
{
    URL urlServlet = new URL("http://localhost:8080/Srvlt?action=Transfer");
    URLConnection connection = urlServlet.openConnection();
    connection.setDoInput(true);
    connection.setDoOutput(true);
    connection.setUseCaches(false);
    connection.setRequestProperty("Content-Type", "application/json");

    InputStream inputStream = connection.getInputStream();
    BufferedReader br = new BufferedReader(new InputStreamReader(inputStream));
    JsonReader jr = new JsonReader(br);
    String retrievedString = new Gson().fromJson(jr, String.class);
    inputStream.close();
    jtextarea1.setText(retrievedString); //jtextarea is to display the received string from the servlet in the applet
}
//end of the applet code extract 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T20:55:23.300

问题是您没有从您的 servlet 发送 JSON，正如您从评论中发现的那样。这是因为 ...`Gson`对您要做什么感到非常困惑。

如果您`toJson()`在您的 servlet 中测试您的 JSON 序列化（来自 的输出），您会发现……它没有做任何事情，只是返回您的内容并`String`带有引号。JSON 基于对象的文本表示（类的字段到值），它当然不希望对`String`对象这样做；默认序列化是获取要放入结果 JSON的*内容。*`String`

**编辑添加：** Gson 的典型用途如下：

```
class MyClass {
    String message = "This is my message";
} 
```

...

```
String json = new Gson().toJson(new MyClass()); 
```

生成的 JSON 将是：

> {"message":"这是我的消息"}

# jquery - jQuery - 为鼠标事件动态替换图像源

> ID：14283391
> 
> 赞同：0
> 
> 时间：2013-01-11T17:22:41.980
> 
> 标签：jquery, replace, this, image, src

我有一个带有图像作为按钮的示例导航列表。当用户将鼠标悬停在按钮上和单击鼠标时，按钮有两种附加状态。每个按钮都有相同的命名约定，因此对于后退按钮将有“back.jpg”、“back_over.jpg”和“back_down.jpg”。由于页面上会有几个按钮，我的目标是获取所选图像源的路径，然后通过附加/删除路径的适当部分来修改它。

我有一个工作示例，但我觉得它可以更优雅。例如，我很确定可以将 3 个图像路径中的每一个存储为变量并以某种方式传递它们。但是当我尝试该方法时，img src 不会正确附加或删除。我也知道这可以通过 CSS 实现，我已经做到了。这主要是为了增加我对jQuery的理解。

```
 $(document).ready(function() {

        $('li > img').bind('mouseenter mousedown mouseup mouseleave click', function(event) {

            var overImgSrc = $(this).attr('src').match(/[^\.]+/) + '_over.jpg';
            var downImgSrc = $(this).attr('src').replace('_over.jpg', '_down.jpg');
            var upImgSrc = $(this).attr('src').replace('_down.jpg', '_over.jpg');
            var outImgSrc = $(this).attr('src').replace('_over.jpg', '.jpg');

            var evtType = event.type;

            switch (evtType) {
                case 'mouseenter':
                $(this).attr('src', overImgSrc);
                break;

                case 'mousedown':
                $(this).attr('src', downImgSrc);
                break;

                case 'mouseup':
                $(this).attr('src', upImgSrc);
                break;

                case 'mouseleave':
                    if ($(this).attr('src', downImgSrc)) {
                        var downOutImgSrc = $(this).attr('src').replace('_down.jpg', '.jpg');
                        $(this).attr('src', downOutImgSrc);
                    }
                    else {
                        $(this).attr('src', outImgSrc);
                    }
                break;

                case 'click':
                alert("Yowza!");
                break;

                default:
                break;
            }
        });
    }); 
```

**HTML**

```
<ul id="nav">
        <li><img src="images/Back.jpg"></li>
        <li><img src="images/Next.jpg"></li>
</ul> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T17:34:28.310

试试这个：

```
$(document).ready(function() {
    $('li > img').bind('mouseenter mousedown mouseup mouseleave click', function(event) {
        var images = {
            'mouseenter' : '_over.jpg',
            'mousedown'  : '_down.jpg',
            'mouseup'    : '_over.jpg',
            'mouseleave' : '.jpg',
        };

        //Store the original source without the extension.
        if (this.originalSource == undefined) {
            this.originalSource = this.src.substring(0, this.src.lastIndexOf('.'));
        }

        var evtType = event.type;

        //Append the affector.
        if (evtType in images) {
            this.src = this.originalSource + images[evtType];
        }

        //Handle your click event. (left the switch event in case you want to do something else with other events)
        switch (evtType) {
        case 'click':
            alert("Yowza!");
            break;
        default:
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T17:26:12.503

将图像存储为数组，并通过索引引用它们。

```
var $images = ['image1.jpg','image2.jpg'];

case 'mouseenter':
    $(this).attr('src', $images[0]);
    break; 
```

粗略的例子，但你明白了。

编辑：取出动态创建，因为应用程序不是很可行。

# java - 在 LWJGL 中组织代码

> ID：14283396
> 
> 赞同：1
> 
> 时间：2013-01-11T17:22:49.377
> 
> 标签：java, lwjgl

我正在制作一个简单的井字游戏作为 LWJGL 中的练习。

当我编写方法来绘制棋盘方格和棋子（例如 x 和 o 棋子）时，是否应该将它们放在一个 graphicsLib 类中，然后可以由棋盘等各种对象调用？还是让每个对象包含绘制自己元素的代码是否被认为是最佳实践？我希望使代码尽可能可扩展。

具体来说，我有一个 Board 类，它是 Square 类型的对象的集合，并且为正方形对象分配了一个枚举状态 CLEAR、X 或 O。然后我在状态上运行一个 switch 语句，它将调用适当的方法来绘制广场。我应该将每个方法放在自己的对象中，还是拥有一个大型图形对象（例如公共类 graphicsLib），然后提供绘制各种元素的方法？

组织这个的最佳方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:36:43.520

在可能的情况下，尽可能使用面向对象的方法。当我写这样的东西时，我通常会让我的每个对象至少提供两种方法：

```
public void update(int delta);
public void render(); 
```

这样我的对象和它们的许多实例都知道如何更新自己和渲染自己。`update`然后，您可以构建您的代码，以便您的 Board 类的更新和渲染方法将`render`在其子 Squares 上调用（参见下面的示例）。这提供了一些好处：

1.  对象的绘制/更新与该对象的表示紧密相关（关注点分离）。
2.  随着您的“模型”类变得复杂，您的渲染函数与该数据接近，因此您的 API 保持稳定。如果您有一个绘图类，您可以想象您必须将大量数据传递给绘图类，并且每个调用都必须随着模型的变化而定制和更改。
3.  你不会有一个巨大的类来提供一个用于绘制所有东西的 API。这将很快变得庞大而笨拙。
4.  [您具有画家算法](http://en.wikipedia.org/wiki/Painter%27s_algorithm)的内置结构，因为您具有基于父/子关系绘制事物的层次结构。您只需要按照每个父母的`render`方法正确管理您的兄弟姐妹。

这是层次结构渲染的示例。

```
public class Board {
    List<Square> squares;

    public render() {
        // Render your board first
        ...

        // Render child squares
        for (Square square : squares) {
            square.render();
        }
    }
} 
```

所以你可以想象，你的主游戏循环可以简单地告诉你的棋盘对象进行渲染，你就完成了。您不需要对董事会可能需要呈现的其他内容有任何深入的了解。

# foxpro - 在字段中查找特定字符并将其替换为短语

> ID：14283400
> 
> 赞同：0
> 
> 时间：2013-01-11T17:22:59.877
> 
> 标签：foxpro, visual-foxpro

我一直在互联网上搜索这个问题的答案几个小时，但我找不到任何东西。我对 FoxPro 的体验非常有限。这可能是两个问题合二为一。

第一个问题：我有一个项目列表，其中一些项目可能包含一个逗号，这在我将数据传输到的程序中是不允许的。

我基本上需要这样的声明：

```
REPLACE ALL Field1 with STRTRAN(field1, "," , "<break time='250ms' />" 
```

这样的事情会完成我需要的吗？

第二个问题：我有 5 个单独的字段，我需要将数据从这些字段移到一个新字段中。像这样的东西。

字段 1：10 月字段 2：21 字段 3：2013 字段 4：5:00 字段 5：下午

FinalField 感谢您的电子邮件，您的约会安排在 [Field1] [Field2] [Field3] 在 [Field4] [Field5]。

这将包含数千条记录，因此我想制定一个声明，将它们一次全部替换。

```
REPLACE ALL FinalField with STRTRAN( 
```

之后，我不确定括号内需要什么格式才能用我需要的内容正确替换该字段。提前谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T18:26:20.883

第一个问题：您所写的内容会将每次出现的逗号替换为“<break time='250ms' />”。不确定这就是你所追求的。要简单地删除所有逗号：

用 STRTRAN(field1, [,], []) 替换所有 field1

会做的。在处理逗号、引号等时，我喜欢使用 [ ] 字符作为字符串分隔符——为了清楚起见。

查看 TEXTMERGE() 函数来回答您的第二个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T21:41:02.343

对于您的第二个问题，您可以编写如下表达式：

```
REPLACE ALL FinalField WITH ;
  "Thank you for your email, your appointment is scheduled for " + ;
  ALLTIRIM(Field1) + " " + TRANSFORM(Field2) + ;
  TRANSFORM(Field3) + " at " + ;
  ALLTRIM(Field4) + ALLTRIM(Field5) + "." 
```

这假定 Field1、Field4 和 Field5 是字符，而 Field2 和 Field3 是数字。如果不是这样，您将不得不调整它们。

如果您要一次性导出到另一个应用程序，您可能会发现编写 SQL 查询以将所有数据放入您想要的格式然后导出查询生成的游标会更容易。

# java - removeAll() 后无法添加到 JFrame

> ID：14283403
> 
> 赞同：4
> 
> 时间：2013-01-11T17:23:26.587
> 
> 标签：java, swing, jframe, add, removeall

我有一个相对较小的类，叫做“LoadingWindow”，这个类有一个构造函数，它调用一个 Initialize 函数来设置框架。不是我在测试一些东西来试图解决为什么它不会更新。在测试时我添加了“this.removeAll();” 到初始化方法的头部。事实证明，在那之后我不能添加任何东西。我添加的任何内容都不会显示。

这是该类的略微精简的版本：

```
public class LoadingWindow extends JFrame{

public JPanel panel;

public JProgressBar bar;

private JLabel label;

public LoadingWindow()
{

    this.Initialize();

}

public void Initialize()
{
    this.removeAll();

    this.setSize(300, 150);

    panel = new JPanel(new BorderLayout());
    bar = new JProgressBar(0,100);
    label = new JLabel("Please remain calm, we're just loading...");

    panel.add(bar,BorderLayout.CENTER);
    panel.add(label,BorderLayout.SOUTH);

    this.add(panel);

    this.validate();
    this.repaint();
    this.setVisible(true);
}
} 
```

窗口本身确实会正确弹出，并带有标题。然而，窗口本身是完全空白的。

我静态实现了这个类，以便其他四个对象可以在 EditorPanel 类中访问它。其定义为：

```
public static LoadingWindow loadingWindow; 
```

并在构造函数中初始化：

```
loadingWindow = new LoadingWindow(); 
```

然后在使用它的函数中进行仔细检查，以显示它是否隐藏。

```
if(!EditorPanel.loadingWindow.isVisible()){EditorPanel.loadingWindow.Initialize();} 
```

总的来说，我对为什么没有显示内容感到有点困惑，我对提出的任何问题都非常感兴趣，并且愿意提供任何必要的信息。谷歌并没有提供很多，而且我发现的每个答案都已经实现了“例如重绘和验证”。

我期待着您的回音！

~特拉维斯

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-11T17:52:02.560

`removeAll()`正如@TomHawtintackline（给他+1）所说，不会转发到`JFrames` *contentPane*；喜欢`add()`，`remove()`或者`setLayout()`是。

因此，当您这样做时，它*会*`JFrame#removeAll()`删除. 请参阅[如何使用根窗格](http://docs.oracle.com/javase/tutorial/uiswing/components/rootpane.html)以进行有趣的阅读，并可能对未来的努力卓有成效。*`JFrame`*

 *你应该做：

> getContentPane().removeAll();// 将确保我们从 contentPane 中删除所有组件

*   也不要`JFrame`不必要地扩展（除非添加超出其当前能力的功能）而只是创建一个实例`JFrame`并使用它

*   不要调用`setSize`而是使用适当的`LayoutManager`和/或覆盖并返回适合图纸`getPreferredSize()`的`JPanel`尺寸，因此您可以`pack()`在`JFrame`将其设置为可见之前调用。

*   我认为没有必要，`validate()`只有`repaint()`在将组件添加到可见容器时才应该调用这些。甚至不是 do `revalidate()`which 将适用于添加和删除组件（它反过来调用`validate()`）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-11T17:50:37.503

我猜想`removeAll`删除根窗格。

`JFrame`是一个容器，包含许多组件，这些组件是我们所认为的框架的一部分。`JFrame`(and ) 中引入了一个 hack `JApplet`，因此某些方法作用于内容窗格而不是框架本身。当转发不生效时，使用不同的方法或特殊方法之一，它会搞砸的。

请参阅 API 文档`JFrame.remove`并注意`removeAll`没有被覆盖。

最安全的解决方案是忽略“有用的”转发，并操纵内容窗格本身（通过`getContentPane`，或者更好地创建您自己的`JPanel`并使用`setContentPane`）。（也不要不必要地扩展类，例如`JFrame`or ，并遵循标准编码约定。）`Thread`*

# c# - 为什么提供 String(char[]) 的隐式运算符不好？

> ID：14283408
> 
> 赞同：4
> 
> 时间：2013-01-11T17:23:29.730
> 
> 标签：c#, string, operator-overloading, chars

我们可以：

```
var t=new String(new[] { '繁', '體', '中', '文' }); 
```

或者

```
var encoding=Encoding.Unicode;
var bytes=encoding.GetBytes(new[] { 'E', 'n', 'g', 'l', 'i', 's', 'h' });
var t=encoding.GetString(bytes); 
```

没有类似的东西：

```
public static implicit operator String(char[] charArray) {
    return new String(charArray);
} 
```

我们不可以：

```
String t=new[] { 'р', 'у', 'с', 'с', 'к', 'и', 'й', '\x20', 'я', 'з', 'ы', 'к' }; 
```

我知道***字符数组与字符串不同***；但有时我只想直接将一个字符数组分配给一个字符串；没有**显式**转换、转换或`new X(new Y(new Z ...`.

而且我个人认为，未提供它的原因可能是：
C-Sharp 团队希望程序员，尤其是有 C++/C 经验的程序员记住，*C-Sharp**与**C++ 或 C*不同。

问题是**为什么**不呢？那不好吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T17:53:37.627

隐式转换是编译器功能。CLI 规范中没有任何内容允许它们，IL 中的所有转换都是显式的。即使是简单的，比如 int to long 和 float to double。因此，在您的情况下，由 C# 团队决定是否使该语法起作用。

C# 团队对此的思考方式已广为人知。每个可能的功能都从 -100 分开始，并且需要一些认真的动力才能达到 +100，以证明设计该功能、实现它、记录它和维护它所涉及的工作是合理的。我不能代表他们说话，但我严重怀疑这个是否超过 0。替代方案是显而易见且简单的，因此不值得。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T17:25:57.407

我不知道那里有任何特定文档说明它们为什么不包含此功能。

我的猜测是，他们可以在每个 .NET 版本中实现的功能数量有限，最终他们认为认为此功能有益的人数并不能证明花时间实现它是合理的（特别是考虑到有一个构造函数可以完全满足您的需求）。

我发现[了这个问题](https://stackoverflow.com/questions/6650699/string-type-net-vs-char-array)，虽然它没有直接回答您的问题，但它确实涉及 .NET 中 char 数组和字符串之间的一些重要区别。在 .NET 中，字符串与字符数组不同（在 C++ 中可能如此）。也许他们正试图将这个概念锤击回家。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T17:29:35.397

你总是可以有类似的东西：

```
char[] chars = { 'a','b','c','d' };
string s = new string(chars); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T17:30:33.327

字符数组与字符串不同，所以不能直接赋值。这对我来说似乎是一个很好的理由。

我会做这样的事情：

```
char[] arr = { 'a', 'b', 'c' };
string s = new String(arr); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-11T17:59:04.547

在基类库中，您将很难找到任何不主要涉及值类型的隐式（或显式）表示更改转换的示例（现在我只能想到`byte`, `short`, `int`, `long`,之间的数字转换`float`）`double`和有符号/无符号变体）。

至于为什么没有实施*这种转换......*

*   字符数组和字符串的行为非常不同；
*   可读性/可理解性的损失高于开发者便利性的收益；
    *   增加开发者的便利性：少输入 12 个字符；
    *   可读性下降：
        *   读者必须知道：
        *   转换存在；
        *   目标变量是 a`string`还是 a `char[]`；
        *   转换创建并分配一个新`string`对象；

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-11T18:00:36.927

编译器应该如何理解您使用的确切类型？

```
void DoIt(string data)
{
}

void DoIt(char[] data)
{
} 
```

应该调用哪些方法？

```
DoIt(new[] { 'р', 'у', 'с', 'с', 'к', 'и', 'й', ' ', 'я', 'з', 'ы', 'к' }) 
```

将此功能仅用于分配看起来像是设计不良的语法糖。

# java - 使用多个着色器

> ID：14283409
> 
> 赞同：0
> 
> 时间：2013-01-11T17:23:30.110
> 
> 标签：java, opengl, model, shader

我正在做我的学校项目，刚刚开始。提供了一个框架，我设法加载一个 SGF 模型并显示它，但是当我想使用另一个着色器从顶点创建一个简单的纹理地板时，它只显示模型（编译后地板在 0.5 秒内可见但后来消失了) 有什么建议吗？

```
 public void display(GLAutoDrawable drawable) {
    final GL3 gl = drawable.getGL().getGL3();
    loader.setUniformMatrix("projection", projection);

    gl.glClear(GL3.GL_COLOR_BUFFER_BIT | GL3.GL_DEPTH_BUFFER_BIT);

    myTexture.bind(gl, modeling, "my_texture");
    myTexture.bind(gl, modeling, "my_texture2");

    myTexture.bind(gl, program, "my_texture");
    myTexture.bind(gl, program, "my_texture2");

    Mat4 mv = MatrixMath.lookAt(this.eyeX,this.eyeY,this.eyeZ,this.at,this.up);
    program.setUniformMatrix("model_view", mv);
    program.use(gl);

    gl.glDrawArrays(GL3.GL_TRIANGLES, 0, numVertices);
    // 2nd part
   // modeling.setUniformMatrix("model_view", mv);
    modeling.setUniformMatrix("model_view", mv);
    modeling.use(gl);
        for (Map.Entry<String, VertexBufferObject> entry : vboHashMap.entrySet()) {
            String key = entry.getKey();
            entry.getValue().bind(gl);
            gl.glDrawArrays(GL3.GL_TRIANGLES, 0, SGFLoader.getNumVertices(key));
        }
} 
```

当我在第二部分（负责加载模型）之后删除线时，木板是可见的，否则它只会渲染模型。

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:35:46.080

看起来您没有在 display() 方法中绑定地板的顶点数组。我猜你在设置所有内容时绑定它一次，但忘记在每一帧再次绑定它，这可以解释为什么它会闪烁几分之一秒。

OpenGL 在底层不是面向对象的。当您调用`glDrawArrays`它时，它将绘制您最后绑定的任何数组。

# xsd - xsd 扩展类型以更改属性值

> ID：14283411
> 
> 赞同：2
> 
> 时间：2013-01-11T17:23:36.533
> 
> 标签：xsd, xsd-validation

我正在尝试扩展一个复杂类型以更改其 minOccurs 值，但我尝试了不同的方法均未成功，这是我的基本类型：

```
 <xs:complexType name="PhoneNumberType">
    <xs:sequence>
        <xs:element name="AreaCode">
            <xs:simpleType>
                <xs:restriction base="xs:string">
                    <xs:pattern value="[0-9]+" />
                    <xs:maxLength value="3" />
                </xs:restriction>
            </xs:simpleType>
        </xs:element>
        <xs:element name="LocalNumber">
            <xs:simpleType>
                <xs:restriction base="xs:string">
                    <xs:pattern value="[0-9]+" />
                    <xs:minLength value="7" />
                    <xs:maxLength value="17" />
                </xs:restriction>
            </xs:simpleType>
        </xs:element>
        <xs:element name="Extension" minOccurs="0">
            <xs:simpleType>
                <xs:restriction base="xs:string">
                    <xs:pattern value="[0-9]+" />
                    <xs:maxLength value="5" />
                </xs:restriction>
            </xs:simpleType>                
        </xs:element>
    </xs:sequence>
</xs:complexType> 
```

首先，我尝试使 AreaCode 在特定情况下成为可选：

```
 <xs:element name="PhoneNumberWithOptionalAreaCode">
            <xs:complexType>
            <xs:complexContent>
                <xs:extension base="PhoneNumberType">
                    <xs:sequence>
                        <xs:element name="AreaCode" type="xs:string" minOccurs="0" />
                    </xs:sequence>
                </xs:extension>
            </xs:complexContent>
            </xs:complexType>
        </xs:element> 
```

它给了我一个错误，说具有相同名称的元素应该具有相同的类型。

所以我尝试了这个：

```
 <xs:complexType name="PhoneNumberType">
    <xs:sequence>
        <xs:element name="AreaCode" type="AreaCodeType" />
        <xs:element name="LocalNumber">
            <xs:simpleType>
                <xs:restriction base="xs:string">
                    <xs:pattern value="[0-9]+" />
                    <xs:minLength value="7" />
                    <xs:maxLength value="17" />
                </xs:restriction>
            </xs:simpleType>
        </xs:element>
        <xs:element name="Extension" minOccurs="0">
            <xs:simpleType>
                <xs:restriction base="xs:string">
                    <xs:pattern value="[0-9]+" />
                    <xs:maxLength value="5" />
                </xs:restriction>
            </xs:simpleType>                
        </xs:element>
    </xs:sequence>
</xs:complexType>

<xs:simpleType name="AreaCodeType">
    <xs:restriction base="xs:string">
        <xs:pattern value="[0-9]+" />
        <xs:maxLength value="3" />
    </xs:restriction>
</xs:simpleType>

    <xs:element name="PhoneNumberWithOptionalAreaCode">
        <xs:complexType>
        <xs:complexContent>
            <xs:extension base="PhoneNumberType">
                <xs:sequence>
                    <xs:element name="AreaCode" type="AreaCodeType" minOccurs="0" />
                </xs:sequence>
            </xs:extension>
        </xs:complexContent>
        </xs:complexType>
    </xs:element> 
```

现在 xsd 是有效的，但是当我尝试验证以下 xml 时，它说 LocalNumber 不是预期的，预期的 AreaCode。

```
<PhoneNumberWithOptionalAreaCode>
    <LocalNumber>1234567</LocalNumber>
</PhoneNumberWithOptionalAreaCode> 
```

任何人都可以帮忙吗？

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T01:41:48.760

您不能使用任何扩展/限制来使强制元素在较低层次结构中成为可选元素。有关此内容的更多信息，请参阅 XML Schema 规范：[Restriction](http://www.w3.org/TR/xmlschema-0/#restrictsTable)

如果您有控制权，唯一可能的解决方案是反转层次结构。做为`PhoneNumberWithOptionalAreaCode`基础并`PhoneNumberType`扩展`PhoneNumberWithOptionalAreaCode`

# java - 查询 DBpedia 以获取图书的元数据

> ID：14283417
> 
> 赞同：4
> 
> 时间：2013-01-11T17:23:54.723
> 
> 标签：java, sparql, dbpedia, isbn

我有一堆 ISBN。我想查询`DBpedia`并获取书籍的元数据。

我无法理解`SPARQL`.

有人能告诉我如何从`DBpedia`Java 中获取一本书的元数据吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T20:48:13.310

SPARQL 既是一种查询语言，也是一种用于查询所谓*SPARQL 端点*的协议。

一个 SPARQL 查询向 DBpedia 询问具有 ISBN 0-553-05250-0 及其（或它们的）相关属性和值的一本书（或多本书）是这样的：

```
select distinct ?book ?prop ?obj 
where {
  ?book a dbo:Book .
  ?book ?prop ?obj .
  ?book dbp:isbn ?isbn .
  FILTER (regex(?isbn, "0-553-05250-0"))
} 
LIMIT 100 
```

在您的浏览器中查看查询[结果](http://dbpedia.org/sparql?default-graph-uri=http://dbpedia.org&query=select%20distinct%20?book%20?prop%20?obj%20%0D%0Awhere%20%7B%0D%0A%20%20?book%20a%20dbpedia-owl:Book%20.%0D%0A%20%20?book%20?prop%20?obj%20.%0D%0A%20%20?book%20dbpprop:isbn%20?isbn%20.%0D%0A%20%20FILTER%20%28regex%28?isbn,%20%220-553-05250-0%22%29%29%0D%0A%7D%20%0D%0ALIMIT%20100&format=text/html&timeout=0&debug=on)。

请注意，这`regex(?isbn, "0-553-05250-0")`需要一些时间来评估。它可能不适用于所有 ISBN，因为

*   维基百科可能永远不会有完整的 ISBN 列表，所以 DBpedia 也没有
*   没有破折号的相同 ISBN 不会匹配带有破折号的查询。

另外，我[注意到](http://dbpedia.org/sparql?default-graph-uri=http://dbpedia.org&query=select%20distinct%20?book%20?isbn%0D%0Awhere%20%7B%0D%0A%20%20?book%20a%20dbpedia-owl:Book%20.%0D%0A%20%20?book%20dbpedia-owl:isbn%20?isbn%20.%0D%0A%7D%20%0D%0ALIMIT%20100&format=text/html&timeout=0&debug=on)有些 ISBN 只是一串数字和破折号，其他的则带有“ISBN”或附加了“（平装）”。

[您可以通过Jena](http://jena.apache.org)（一个用于 RDF 和 SPARQL 的著名 Java 工具包）通过 web 表单（通过使用浏览器访问端点）将此查询发送到[DBpedia 端点。](http://dbpedia.org/sparql) 这是一些 Java 代码中的查询，它查询 DBpedia 的结果并将它们打印到命令行（基于另一个[Jena、SPARQL 和 DBpedia 相关的问题](https://stackoverflow.com/questions/2267333/using-jena-to-create-a-sparql-query-on-dbpedia)，其中有很多）：

```
String sparqlQueryString1= "select distinct ?book ?prop ?obj " +
       "where { " +
       "  ?book a dbpedia-owl:Book . " +
       "  ?book ?prop ?obj . " +
       "  ?book dbpprop:isbn ?isbn . " +
       "  FILTER (regex(?isbn, \"0-553-05250-0\")) " +
       "} " +
       "LIMIT 100";

Query query = QueryFactory.create(sparqlQueryString1);
QueryExecution qexec = QueryExecutionFactory.sparqlService("http://dbpedia.org/sparql", query);

ResultSet results = qexec.execSelect();
ResultSetFormatter.out(System.out, results, query);       

qexec.close() ; 
```

我最喜欢的 SPARQL 资源是[Lee Feigenbaum 的备忘单](http://www.slideshare.net/LeeFeigenbaum/sparql-cheat-sheet)，这是一个非常全面的参考资料。也许您想查看Jena 提供的[教程及其文档。](http://jena.apache.org/tutorials/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T18:51:52.700

据我所知，维基百科没有 ISBN 搜索。

维基百科有[这个页面](http://en.wikipedia.org/w/index.php?title=Special%3aBookSources)用于使用其他 ISBN 搜索引擎。

Amazon.com 在[这里](http://www.amazon.com/Advanced-Search-Books/b?ie=UTF8&node=241582011)有一个 ISBN 搜索。我在亚马逊上找不到自动化 ISBN 搜索的 API。

# jquery - 集中在 jquery 文件中的按钮单击事件

> ID：14283418
> 
> 赞同：-1
> 
> 时间：2013-01-11T17:23:56.707
> 
> 标签：jquery, asp.net-mvc-3

我有一个 jquery 文件`xyz.js`。

我有一个几乎在每个视图中都使用的锚标记单击事件。我如何在集中文件中调用该事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:31:58.247

如果您的锚点将在一个页面上出现多次，您将需要使用一个类。您可以将点击事件连接到您的锚点，如下所示：

html:

```
<a class="ClassNameHere">...</a> 
```

JavaScript：

```
$(function(){

  $('a.ClassNameHere').click(someFunctionToExecute);
}); 
```

# login - 为什么我无法登录 Symphony 2.3.1 管理面板？

> ID：14283419
> 
> 赞同：0
> 
> 时间：2013-01-11T17:24:00.047
> 
> 标签：login, symphony-cms

我从 Symphony 2.2.5 升级到 Symphony 2.3.1。我无法在以下任何浏览器上登录 Mac OS 10.8.3 上的项目：

*   苹果浏览器
*   铬合金
*   火狐
*   歌剧

我正在[Symphony Forum 的评论 #11 中研究 localhost 解决方案](http://getsymphony.com/discuss/thread/62821/#position-11)。

Per [Can't get to admin area](http://getsymphony.com/discuss/thread/24044/#position-20)，我可以确认我的 .htaccess 适用于 2.3.x。

/lib/core/class.session.php 文件与[此评论](http://getsymphony.com/discuss/thread/24044/2/#position-24)一样。

我还要补充一点，当我使用已知的错误密码登录时，我会收到正常的 Symphony 错误通知，“提供的登录详细信息不正确。” 但是，当我输入已知的正确密码时，表单会发布，没有提供任何反馈，也不会登录或重定向。

`password`此外，在输入已知的正确密码后，字段（表：）中的哈希值`sym_authors`会更改为`PBKDF2v1|10000|29846548654be8d15328|zCZ+`。我知道我们现在正在使用盐，但这看起来并不咸，尽管它是 SHA-1 长度（40 个字符）。

非常感谢您提供的任何帮助。

* * *

## 查阅的文章

*   [Symphony 论坛上评论 #11 中的 localhost 解决方案](http://getsymphony.com/discuss/thread/62821/#position-11)
*   [无法进入管理区](http://getsymphony.com/discuss/thread/24044/#position-20)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T22:47:38.730

这看起来像是一个错误，其中密码列在`tbl_authors`更新过程中未正确扩展为 150 个字符的长度。您可以在`tbl_authors`表格中手动编辑它。

这是一个已知的错误，将在下一个版本中修复！

# facebook-android-sdk - 在 Facebook 登录时按回的异常

> ID：14283421
> 
> 赞同：6
> 
> 时间：2013-01-11T17:24:04.333
> 
> 标签：facebook-android-sdk

我正在使用 FB-android-SDK 3.0。在 SSO 时，如果我在 facebook 登录页面（FB 应用程序）上按下后退按钮，则会生成异常。这是堆栈跟踪。

```
01-11 22:35:07.146: E/AndroidRuntime(13076): java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=64206, result=0, data=null} to activity {com.nitinbansal85.android.testfacebook1/com.facebook.LoginActivity}: java.lang.NullPointerException
01-11 22:35:07.146: E/AndroidRuntime(13076):    at android.app.ActivityThread.deliverResults(ActivityThread.java:3386)
01-11 22:35:07.146: E/AndroidRuntime(13076):    at android.app.ActivityThread.handleSendResult(ActivityThread.java:3428)
01-11 22:35:07.146: E/AndroidRuntime(13076):    at android.app.ActivityThread.access$2700(ActivityThread.java:125)
01-11 22:35:07.146: E/AndroidRuntime(13076):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1944)
01-11 22:35:07.146: E/AndroidRuntime(13076):    at android.os.Handler.dispatchMessage(Handler.java:99)
01-11 22:35:07.146: E/AndroidRuntime(13076):    at android.os.Looper.loop(Looper.java:123)
01-11 22:35:07.146: E/AndroidRuntime(13076):    at android.app.ActivityThread.main(ActivityThread.java:4420)
01-11 22:35:07.146: E/AndroidRuntime(13076):    at java.lang.reflect.Method.invokeNative(Native Method)
01-11 22:35:07.146: E/AndroidRuntime(13076):    at java.lang.reflect.Method.invoke(Method.java:521)
01-11 22:35:07.146: E/AndroidRuntime(13076):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:924)
01-11 22:35:07.146: E/AndroidRuntime(13076):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:682)
01-11 22:35:07.146: E/AndroidRuntime(13076):    at dalvik.system.NativeStart.main(Native Method)
01-11 22:35:07.146: E/AndroidRuntime(13076): Caused by: java.lang.NullPointerException
01-11 22:35:07.146: E/AndroidRuntime(13076):    at com.facebook.AuthorizationClient$KatanaProxyAuthHandler.onActivityResult(AuthorizationClient.java:645)
01-11 22:35:07.146: E/AndroidRuntime(13076):    at com.facebook.AuthorizationClient.onActivityResult(AuthorizationClient.java:142)
01-11 22:35:07.146: E/AndroidRuntime(13076):    at com.facebook.LoginActivity.onActivityResult(LoginActivity.java:134)
01-11 22:35:07.146: E/AndroidRuntime(13076):    at android.app.Activity.dispatchActivityResult(Activity.java:3828)
01-11 22:35:07.146: E/AndroidRuntime(13076):    at android.app.ActivityThread.deliverResults(ActivityThread.java:3382) 
```

我已经将执行 SSO 的代码包装在 中`FacebookOperationCanceledException`，但它没有被抛出。

我在这里错过了什么吗？

编辑：应用程序崩溃！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-16T10:18:07.140

这是一个报告的错误：[facebook 错误报告](https://developers.facebook.com/bugs/120539814778972?browse=search_50d8d7afe8a4c9905952987)

这是我的解决方法：

```
String errorMessage = "Login cancelled!";
            if(data != null && data.getStringExtra("error") != null)
            {
                errorMessage = data.getStringExtra("error");
            }

outcome = Result.createCancelResult(errorMessage ); 
```

您在第 645 行的 AuthorizationClient.java 中进行这些修改

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-13T07:41:09.533

此错误已在 facebook-android-sdk-3.0.1 中修复。最好下载并使用它。为我工作。

# powershell - 如何让 Powershell 读取文件的内容？

> ID：14283422
> 
> 赞同：1
> 
> 时间：2013-01-11T17:24:07.423
> 
> 标签：powershell, file-read

我正在调整这个脚本来计算文件中单个单词的实例。

```
$txtPath = "c:\users\xxxxxx\desktop\tx"
$srcfiles = Get-ChildItem $txtPath -filter "*.txt*"
#
function wordCount ($docs) {
    Write-Host "Processing Word Count: " $docs
$s = "I saw the cat. The cat was black."
",",".","!","?",">","<","&","*","=","`n","_" |% {$s = $s.replace($_,' ')}     # Remove Chars
$w = $s.Split() |? {$_.Length -gt 0 }                                     # Array of words, spaces removed
$w | select -Unique                                                       # Unique words
$w | group                                                                # Tally
$W | group | sort name | ft name,count -AutoSize              # Sort and format
#>
}
#
ForEach ($doc in $srcfiles) { 
    Write-Host "Calling: " $doc.FullName         
    wordCount -docs  $doc.FullName    
} 
```

`$s`目前，表示要计数的字符串的输入变量是硬编码的。我想获取`$srcFiles`路径中的每个文档并对每个文档进行计数。但是，`$s = $docs`计算标题中的单词，而不是文档内容。我怎么做？

此外，`$W | group | sort name | ft name,count -AutoSize`返回以下错误：

```
out-lineoutput : The object of type "Microsoft.PowerShell.Commands.Internal.Format.FormatStartData" is not valid or not
 in the correct sequence. This is likely caused by a user-specified "format-table" command which is conflicting with th
e default formatting.
    + CategoryInfo          : InvalidData: (:) [out-lineoutput], InvalidOperationException
    + FullyQualifiedErrorId : ConsoleLineOutputOutOfSequencePacket,Microsoft.PowerShell.Commands.OutLineOutputCommand 
```

我应该在哪里寻找格式问题？我无法在 TechNet 上发现任何类型的默认格式信息；并且该代码最初来自的[站点](http://thepowershellguy.com/blogs/posh/archive/2007/02/27/hey-powershell-guy-how-can-i-tally-up-all-the-words-found-in-a-text-file.aspx)没有提及它们是如何使其工作的，也没有提及它们覆盖了哪些默认格式。我怀疑我可能需要以不同的方式对其进行管道传输，但我需要更好地理解确切的错误，以便我知道从哪里开始寻找。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T17:28:21.037

您需要使用[Get-Content](http://technet.microsoft.com/en-us/library/ee176843.aspx)来读取文件的内容。您需要组合 Get-Content 返回的行以正确计算字符数。看到这个[帖子](http://powershell.com/cs/forums/t/789.aspx)。

# search - Propel 1.6 中的全文搜索

> ID：14283426
> 
> 赞同：0
> 
> 时间：2013-01-11T17:24:23.060
> 
> 标签：search, propel, full-text-search

请给我一个真实的例子，如何在纯 Propel 1.6 中进行全文搜索？我不使用 Symfony。

# java - AspectJ - 记录 HttpServletRequest

> ID：14283429
> 
> 赞同：4
> 
> 时间：2013-01-11T17:24:31.483
> 
> 标签：java, spring, aspectj, spring-aop

我想劫持一个 HTTPServletRequest 并使用 AspectJ 从中记录一些值。然而，最终在 JoinPoint 中的是一个“RequestFacade”对象。我似乎对这个对象无能为力。我的日志记录策略全错了吗？如何从 HttpServletRequest 中获取有用的信息？如果我必须在调用方法之前解包它，那将违背 AOP 在我的应用程序中的目的。

我正在使用 Glassfish 服务器，如果这有什么不同的话。

```
@Before("execution(* Service.testAuditRecord(..))")
public void logBefore(JoinPoint joinPoint) {
    System.out.println("logBefore  --->"  + joinPoint.getSignature().getName());
    System.out.println("logBefore--->Args : " + Arrays.toString(joinPoint.getArgs()));
} 
```

RequestFacade 记录

```
INFO: logBefore  --->testAuditRecord
INFO: logBefore--->Args : [org.apache.catalina.connector.RequestFacade@4dbfa7d0] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T17:47:31.160

[`HttpServletRequest`](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html)是一个接口。每个 servlet 容器都有自己的实现。`org.apache.catalina.connector.RequestFacade`是其中之一。

话虽如此，您可以自由使用 的任何方法`HttpServletRequest`，而不必担心实际的实现。

签名是`Service.testAuditRecord()`什么？是否`HttpServletRequest`作为论据？如果是这样，AspectJ 应该给你一个强类型的实例，而不会有太多麻烦。试试这个：

```
@Before("execution(* Service.testAuditRecord(..)) && args(request)")
public void logBefore(JoinPoint joinPoint, HttpServletRequest request) {
  //... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-05-11T07:49:03.360

使用`RequestContextHolder`喜欢

```
HttpServletRequest request = ((ServletRequestAttributes) 
RequestContextHolder.getRequestAttributes()).getRequest(); 
```

# c# - 在 ASP.NET Web API 响应中将属性呈现为 XMLAttributes

> ID：14283430
> 
> 赞同：0
> 
> 时间：2013-01-11T17:24:37.193
> 
> 标签：c#, xml-serialization, asp.net-web-api, xmlserializer

下面是一个代表 ASP.NET Web API 服务调用响应的类。

```
public class User
{
   public string FirstName {get;set;}

   public long FirstNameLastModified {get;set;}

   public string LastName {get;set;}

   public long LastNameLastModified {get;set;}

} 
```

由于与此问题无关的原因，我目前是 XmlSerializer 而不是默认的 DataContractSerializer。

此处呈现的响应是这种形式。

*最后修改的值是时间戳并且与字段相关。*

```
<User>
  <FirstName>Phill<FirstName>
  <FirstNameLastModified>12<FirstNameLastModified>
  <LastName>Haack<LastName>
  <LastNameLastModified>16<LastNameLastModified>
</User> 
```

我希望将 XML 呈现为

```
<User>
  <FirstName lastModified="12">Phill<FirstName>
  <LastName lastModified="16">Haack<LastName>
</User> 
```

我应该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T17:32:43.820

```
public class Foo<T>
{
    [XmlText]
    public T Value;
    [XmlAttribute]
    public int LastModified;
}

public class User
{
    public Foo<string> FirstName;
    public Foo<string> LastName;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T17:32:59.977

像这样的东西：

```
public class User
{
    [XmlElement("FirstName")]
    public Name FirstName { get; set; }

    [XmlElement("LastName")]
    public Name LastName { get; set; }

}

public class Name
{
    [XmlText]
    public string Name { get; set; }

    [XmlAttribute("lastModified")]
    public long Modified { get; set; }
} 
```

# html - CSS/HTML - Twitter Bootstrap - 响应式媒体网格悬停覆盖

> ID：14283432
> 
> 赞同：1
> 
> 时间：2013-01-11T17:24:41.417
> 
> 标签：html, css, twitter-bootstrap, positioning, css-position

所以我正在使用 Twitter Bootstrap 创建一个响应式缩略图网格。当缩略图悬停时，我希望出现图像标题和图标。
目前，此代码可以按预期工作：

**HTML**

```
<div class="container">
  <ul class="thumbnails">
    <!-- List start -->
    <li class="span3">
      <div class="thumbnail">
        <a href="#">
           <!-- Image -->
          <img src="http://www.placehold.it/300x200" />
          <p>
            <!-- Hover content -->
            <img src="http://i.computer-bild.de/imgs/4/3/2/6/8/2/2/Icon-Google-Drive-48x48-ddb8b51ac50e8859.png" /><br />
            <span>Mojo Babble</span>
          </p>
        </a>
      </div>
    </li>

  </ul>
</div> 
```

**CSS**

```
.thumbnails li {
    position: relative;
    overflow: hidden;
}

.thumbnail a p {
  position: absolute;
  top: 0;
  width: 100%;
  height: 100%;
  background: rgba(255,0,0,.4);
  text-align: center;
  opacity: 0;
}

.thumbnail a:hover p {
  opacity: 1;
} 
```

**小提琴：http:** [//jsfiddle.net/PgqGg/](http://jsfiddle.net/PgqGg/)

唯一的问题是定位。在考虑两件事时，我希望图标和文本在某种程度上垂直居中：

*   标题必须始终可见，至少在某种程度上是这样。我只是不想剪掉它，因为它有两行长。
*   网格必须响应，所以我认为必须使用百分比值。我确实知道，对于触摸设备，没有`:hover`, 将使用媒体查询来处理。

我已经尝试了几个小时来想出一个好的解决方案，但我并没有真正成功。在某些时候它总是变得混乱，这就是为什么我现在请求你的帮助。

您将如何处理这种情况？也许为图标使用图标字体，以便我像文本一样缩放？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T20:25:31.430

可以将图标作为背景图像，并适当地定位标题。

```
.thumbnail a:hover p {
  opacity: 1;
  background-image: url('http://i.computer-bild.de/imgs/4/3/2/6/8/2/2/Icon-Google-Drive-48x48-ddb8b51ac50e8859.png');
  background-position: center center;
  background-repeat: no-repeat;
}

.thumbnail a:hover p span 
{
  position: absolute;
  top: 60%;
  margin-left: -40px;
  margin-top: 10px;
} 
```

演示：http: [//jsfiddle.net/PgqGg/1/](http://jsfiddle.net/PgqGg/1/)

# android - Android-从javascript重定向到活动（Phonegap/Jquery Mobile）

> ID：14283433
> 
> 赞同：0
> 
> 时间：2013-01-11T17:24:43.433
> 
> 标签：android, cordova, jquery-mobile

我的 android 应用程序中有两个活动。MainActivity 和 SettingsActivity。

MainActivity 加载 index.html 并呈现一个 android 菜单。我可以从打开 SettingsActivity 的菜单中选择设置。SettingsActivity 加载具有保存按钮的 settings.html。现在我想要的是，在成功保存设置后，应用程序应重定向到 MainActivity，而 MainActivity 又将加载 index.html。

一切都完成了，我只是不知道如何从 javascript 重定向到 MainActivity。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T18:39:23.333

您可能希望利用 Android 已经为您提供的功能，而不是滚动您自己的设置活动。我创建了一个[应用程序首选项插件](https://github.com/macdonst/AppPreferences)来做到这一点。

# makefile - 我可以在 Makefile 中指定某些文件是源文件吗？

> ID：14283438
> 
> 赞同：0
> 
> 时间：2013-01-11T17:25:01.007
> 
> 标签：makefile, gnu-make

一个工具用于编译idl。编译 test.idl 后，我们得到 test.idl.h 和 test.idl.cc 我想在更新时重新编译 idl。但是现在我遇到了一个循环依赖：

```
 Test.idl.cc  => Test.idl             ( use tool to generate Test.idl.cc )
                Test.idl     => Test.idl.o           ( It's a implicit rule !!! )
                Test.idl.o   => Test.idl.cc 
```

然后，就会发生一些奇怪的事情。

我能做些什么来修复它？在实践中很难修改工具来更改输出文件名。

我可以指定 *.idl 为源文件吗？那么make会忽略隐含的规则吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T17:28:18.473

但这无济于事，对吧？问题不在于`Test.idl`仅生成，问题在于生成的文件和输入文件使用相同的名称。

没有解决方法，您需要更改源文件名或编译文件名。

一种好方法是摆脱`.idl`下游组件。

*更新：*

啊哈，好吧，您可以取消存在的用于从 .c 文件创建无扩展名链接文件的隐式规则。只需定义一个没有配方的模式规则，如[gmake 文档中所述。](http://www.gnu.org/software/make/manual/html_node/Canceling-Rules.html#Canceling-Rules)

# bash - 家庭作业：刽子手

> ID：14283457
> 
> 赞同：0
> 
> 时间：2013-01-11T17:26:14.513
> 
> 标签：bash

我正在做家庭作业，并且必须制作一个有效的刽子手应用程序。我得到了大部分工作，但我想做一些事情，但不知道该怎么做。

我想要做什么：有一个名为 的字符串`$string`，其中包含来自单词列表的随机单词。当我开始刽子手时，我想显示`"*"`随机单词中的每个字符。`"*"`其次，当玩家猜到它时，我想将它与真实的字符值连接起来。

因此，如果我想显示单词“Hello”`"*****"`并且当有人猜到一个字母时`"l"`，它将显示`"**ll*"`。

我试过的：

子串替换 - [http://tldp.org/LDP/abs/html/string-manipulation.html](http://tldp.org/LDP/abs/html/string-manipulation.html)

tr （在几种格式中，并没有真正理解如何正确使用它。我绑定`[CHAR*REPEAT]`但不断收到错误）并搜索了很多网站，但大多数点击是关于连接 1 个特定字符而不是所有字符细绳。

你能帮我理解吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T22:23:21.330

bash 的[参数扩展](http://www.gnu.org/software/bash/manual/bashref.html#Shell-Parameter-Expansion)和[模式匹配](http://www.gnu.org/software/bash/manual/bashref.html#Pattern-Matching)会：

```
$ string="hello world"
$ guess=""
$ echo "${string//[^[:space:]$guess]/*}"
***** *****

$ guess+="l"
$ echo "${string//[^[:space:]$guess]/*}"
**ll* ***l*

$ guess+="o"
$ echo "${string//[^[:space:]$guess]/*}"
**llo *o*l* 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T19:02:09.277

如果你有一个猜测的字符列表和你的字符串，你可以通过告诉`tr`用“*”替换除了猜测的字符、空格和换行符之外的所有内容来屏蔽它：

```
guessed="etaonris"
string="doing a homework assignment"
masked=$(tr -c "\n $guessed" "*" <<< "$string")
echo "$masked" 
```

这给你`*oin* a *o*e*or* assi*n*ent`。

# java - 使文本视图中的图像具有固定大小 - Android

> ID：14283462
> 
> 赞同：0
> 
> 时间：2013-01-11T17:26:30.710
> 
> 标签：java, android, image, textview

我正在尝试将图像分配给 TextView。我从 Google 提取了一个 .PNG，现在正尝试将 TextView 的宽度和高度分配给我想要的图像大小。我希望它是一个小正方形，但它变成了非常宽和短的矩形。

我对这一切都错了吗？下面是代码。

xml代码

```
 <TextView
        android:id="@+id/q1Image"
        android:layout_width="1dp"
        android:layout_height="10dp"
        android:layout_weight=".1"
        android:textSize="8sp"
        android:gravity="center_horizontal" /> 
```

爪哇代码

```
q1Image.setBackgroundResource(R.drawable.red_x); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:35:16.433

你想做什么 - 让文本在图像上居中？如果是这样，你需要做一些不同的事情

```
<RelativeLayout
  android:layout_width=wrap_content
  android:layout_height=wrap_content>
    <TextView 
        android:layout_width=fill_parent
        android:layout_height=fill_parent
        android:gravity:"center" />
    <ImageView
        android:layout_width=wrap_content
        android:layout_height=wrap_content
        android:scaleType="centerInside" />
</RelativeLayout> 
```

这会将图像视图和文本视图放置在同一位置，使相对布局的大小与图像相同，而文本视图的大小与布局相同。然后它通过重力使文本居中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T17:32:01.263

```
public Drawable getDrawable(String source) {

        Log.i(" get drawable mathod ", "");
        Bitmap B = BitmapFactory.decodeResource(getResources(),
                R.drawable.bone);
        BitmapDrawable BD = new BitmapDrawable(B);

        BD.setBounds(0, 0, B.getWidth(), B.getHeight());

        return BD;
    } 
```

您可以指定高度和宽度以根据您的要求进行调整

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T17:34:49.130

请查看[TextView](http://developer.android.com/reference/android/widget/TextView.html)的文档。

TextView 具有以下功能：

[setCompoundDrawablesWithIntrinsicBounds(int,int,int,int)](http://developer.android.com/reference/android/widget/TextView.html#setCompoundDrawablesWithIntrinsicBounds%28int,%20int,%20int,%20int%29) [setCompoundDrawablesRelativeWithIntrinsicBounds(int,int,int,int)](http://developer.android.com/reference/android/widget/TextView.html#setCompoundDrawablesRelativeWithIntrinsicBounds%28int,%20int,%20int,%20int%29)
和其他可能对您有帮助的函数。

# ruby-on-rails - 升级到 Rails 3.2.11 的问题：Static_pages#home 中的 ExecJS::RuntimeError

> ID：14283465
> 
> 赞同：4
> 
> 时间：2013-01-11T17:26:42.463
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我刚刚从 Rails 3.2.10 升级到 3.2.11，并且没有对我的应用程序进行其他更改。

突然之间，我的网站无法加载 - 并给了我错误消息：

```
ExecJS::RuntimeError in Static_pages#home 
```

有谁知道为什么 Rails 3.2.11 中的更改会导致这个问题？

```
ExecJS::RuntimeError in Static_pages#home

Showing C:/Sites/av_reports/app/views/layouts/application.html.erb where line #11 raised:

  (in C:/Sites/av_reports/app/assets/javascripts/password_resets.js.coffee)
Extracted source (around line #11):

8:  <meta name="author" content="">
9:  
10:     <%= stylesheet_link_tag    "application", :media => "all" %>
11:     <%= javascript_include_tag "application" %>
12:     <%= csrf_meta_tags %>
13:     <%= render 'layouts/shim' %>
14:   </head> 
```

我的 /app/assets/javascripts/password_resets.js.coffee 文件包含 3 行注释掉的文本，所以我猜这不是问题所在。

宝石依赖性或类似情况是否有变化 - 这可能导致问题？

**编辑**

我的 application.js 文件内容如下：

```
// This is a manifest file that'll be compiled into application.js, which will include all the files
// listed below.
//
// Any JavaScript/Coffee file within this directory, lib/assets/javascripts, vendor/assets/javascripts,
// or vendor/assets/javascripts of plugins, if any, can be referenced here using a relative path.
//
// It's not advisable to add code directly here, but if you do, it'll appear at the bottom of the
// the compiled file.
//
// WARNING: THE FIRST BLANK LINE MARKS THE END OF WHAT'S TO BE PROCESSED, ANY BLANK LINE SHOULD
// GO AFTER THE REQUIRES BELOW.
//
//= require jquery
//= require jquery_ujs
//= require bootstrap
//= require_tree . 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T19:55:52.063

所以......显然这根本不是 Rails 3.2.11 升级问题。根本问题是 ExecJS 在 Windows 中的工作方式。我目前在 Windows 8 上运行我的开发环境。

在升级到 Rails 3.2.11 之前，上面的错误消息会显示在服务器日志中，但它并没有停止服务器。在 Rails 3.2.11 中，页面将不再加载。

解决方案是编辑 Ruby1.9.3\lib\ruby\gems\1.9.1\gems\execjs-1.4.0\lib\execjs\runtimes.rb 文件：

（原始非工作代码）：

```
JScript = ExternalRuntime.new(
    :name        => "JScript",
    :command     => "cscript //E:jscript //Nologo //U",
    :runner_path => ExecJS.root + "/support/jscript_runner.js",
    :encoding    => 'UTF-16LE' # CScript with //U returns UTF-16LE
) 
```

（更新的工作代码）：

```
JScript = ExternalRuntime.new(
    :name        => "JScript",
    :command     => "cscript //E:jscript //Nologo",
    :runner_path => ExecJS.root + "/support/jscript_runner.js",
    :encoding    => 'UTF-8' # CScript with //U returns UTF-16LE
) 
```

感谢评论线程：[https ://github.com/sstephenson/execjs/issues/81#issuecomment-9892952](https://github.com/sstephenson/execjs/issues/81#issuecomment-9892952)

和讨论：[https](https://stackoverflow.com/a/14119187/1757424) ://stackoverflow.com/a/14119187/1757424以获得有关此问题的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-06T15:57:22.263

我有一些问题，但我使用的是 Ruby2.0.0

解决方案是编辑 Ruby2.0.0\lib\ruby\gems\2.0.0\gems\execjs-2.2.1\lib\execjs\runtimes.rb

# jquery - jQuery 从 Facebook 获取 JSON 提要

> ID：14283468
> 
> 赞同：0
> 
> 时间：2013-01-11T17:27:07.490
> 
> 标签：jquery, ajax, facebook, json, jsonp

我正在尝试从 facebook 页面获取一些 json 提要。这是我的代码：

```
var myurl = "https://www.facebook.com/feeds/page.php?id=111222778066&format=json";
$.ajax({
    url: myurl,
    type: 'GET',
    dataType: "jsonp",
    success: function(json){
      ...
    }
}); 
```

问题是我不断收到此错误：（在 page.php:2 中）

```
Uncaught SyntaxError: Unexpected token : 
```

任何帮助都非常感谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T17:48:04.733

这是尝试查询页面的 RSS 提要。RSS 提要已正式弃用。根据页面的创建日期，某些页面仍然保留它们，但您不能依赖它们存在，也无法检测它们是否存在。

这个页面似乎有一个提要 - 现在，因为 URL 返回数据。

您的错误是语法错误。看看你的控制台，看看这是来自哪条线。无法保证意外的冒号出现在您发布的代码片段中。

为了将来证明您的脚本，最好的办法是创建一个应用程序，并通过此 URL 的 Graph API 查询页面：

```
https://graph.facebook.com/111222778066/feed?access_token=YOUR_APP_ACCESS_TOKEN 
```

如果您作为应用程序进行身份验证，则可以获得永久访问令牌。使用 JavaScript SDK 将为您自动执行此过程。

这些文章应该可以帮助您入门：

*   [作为应用程序登录](https://developers.facebook.com/docs/howtos/login/login-as-app/)
*   [图形 API](https://developers.facebook.com/docs/reference/api)
*   [Facebook 的 JavaScript SDK](https://developers.facebook.com/docs/reference/javascript/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-06T09:35:00.587

这不是@cpilko 提到的 RSS 提要被弃用的问题。您的问题是 facebook 提要不支持[jsonp](/questions/tagged/jsonp "显示标记为“jsonp”的问题")，它依赖于将 data-url 作为包含回调的 javascript 加载，而不是它们只返回普通的[json](/questions/tagged/json "显示标记为“json”的问题")、[atom](/questions/tagged/atom "显示标记为“原子”的问题")或[rss2](/questions/tagged/rss2 "显示标记为“rss2”的问题")。相反，您需要通过您自己的后端或 googles 提要 api 等其他方式代理提要：

```
<script>
  function jsapi_loaded(){
    google.load("feeds", "1");

    function initialize() {
      var feed = new google.feeds.Feed(
        "https://www.facebook.com/feeds/page.php?format=rss20&id=111222778066"
      );
      feed.setNumEntries(10);
      feed.load(function(result) {
        if (!result.error) {
          console.log(result);
        }
      });
    }
    google.setOnLoadCallback(initialize);
  }
</script>
<script src="https://www.google.com/jsapi?callback=jsapi_loaded" async></script> 
```

# c# - XML 文档转换

> ID：14283469
> 
> 赞同：-1
> 
> 时间：2013-01-11T17:27:08.580
> 
> 标签：c#, xml

我是一名中级 c# 程序员，需要有关 XML 文档的帮助。

我需要执行以下操作：

1.  解析相当大的 XML 文档 A
2.  提取特定元素和值
3.  将这些值存储在新的 XML 文档 B 中（元素名称将不同）

XML 文档 B 元素将具有不同的名称，但从文档 A 中提取的值相同。

有人可以帮助实现这一目标的最佳设计吗？

我应该使用数据协定/序列化，我应该使用枚举来存储 XML 元素…………。

请概述实现上述目标的最佳方法或将我引导至示例

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T18:30:38.570

如果您要阅读 XML，然后基于它创建 XML，那么您可能需要考虑使用 XSLT。这是一种使用 XQuery 和 XPath 将 XML 文档转换为新 XML 文档的方法。如果您将来也打算用 XML 做这种类型的事情，那么它是值得学习的。

这是代码项目教程的链接：http: [//www.codeproject.com/Articles/460968/XSLT-2-0-programming-basics](http://www.codeproject.com/Articles/460968/XSLT-2-0-programming-basics)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T17:34:18.820

我会推荐[LINQ to XML](http://msdn.microsoft.com/en-us/library/bb387098.aspx)

如果您只是严格地将一个 XML 文档翻译成另一个，您可能还会考虑编写一个 XSLT 来进行翻译。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T17:34:52.937

我通常使用`XmlDocument`类和 XPath

[一些 xpath 示例在这里](http://www.w3schools.com/xpath/xpath_examples.asp)

这是一个使用 XML 文档的示例，从一个文档中获取值并将它们放入另一个文档中。

```
XmlDocument xDoc = new XmlDocument();
xDoc.Load("filename.xml");

string val = xDoc.SelectSingleNode("//ElementName").Attributes["attributeName"].Value;

XmlDocument xDoc2 = new XmlDocument();
XmlElement ele = xDoc2.CreateElement("ElementName2");
XmlAttribute att = xDoc2.CreateAttribute("attributeName2");
att.Value = val;
ele.Attributes.Append(att);
xDoc2.AppendChild(ele); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T17:40:38.413

一些伪代码和信息。由于您没有提供任何信息，因此我无法具体说明。

1 - 加载您`Xml A`使用的`XmlDocument`.

```
var aDoc = new XmlDocument();
aDoc.Load("someFile.xml"); 
```

2 - 既然你说你想要一个特定的节点，你可以使用[xPath](http://www.w3schools.com/xpath/default.asp)来提取该节点。（xPath 只是一个例子）

```
XmlNode extractedNode = aDoc.SelectSingleNode(/rootNode/parentNode); 
```

3 - 现在你已经提取了你的节点，是时候把它放在一个新的文档中了`bDoc`（完全像加载的那样`aDoc`）。

```
XmlNode rootNode = bDoc.DocumentElement;
rootNode.AppendChild(extractedNode); 
```

非常基本，一点也不具体，但我能提出你当前的问题。

# javascript - JavaScript - 为什么我的 parseInt 返回 NaN？

> ID：14283471
> 
> 赞同：1
> 
> 时间：2013-01-11T17:27:24.377
> 
> 标签：javascript, parseint

```
var bucketId = $.cookie('bucketId');
console.log(bucketId);

var bucketIdNumber = parseInt(bucketId, 10);
console.log("bucketIdNumber " + bucketIdNumber); 
```

在有关 bucketId 的代码中返回“17”。那么为什么当我 parseInt bucketId 得到 NaN 时？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T17:32:28.347

If I'm understanding this correctly, the code above is equivalent to:

```
var bucketId = '"17"';
console.log(bucketId);

var bucketIdNumber = parseInt(bucketId, 10);
console.log("bucketIdNumber " + bucketIdNumber); 
```

In which case, bucketIdNumber does return NaN. You will need to further parse this cookie, and remove any inner quotation marks.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T17:30:43.760

`bucketId` probably doesn't start with an integer.

> If the first character cannot be converted to a number, parseInt() returns NaN.

# linq - linq查询中的不同关键字

> ID：14283475
> 
> 赞同：0
> 
> 时间：2013-01-11T17:27:35.187
> 
> 标签：linq

我的 linq 查询返回如下所示的重复记录，我必须如何在此 linq 查询中使用 distinct 关键字。

```
var draft_recieved = from df in _DataContext.tblDrafts
                     from dfBody in _DataContext.DraftBodies
                     from sendUser in _DataContext.tblSends

                     where (df.DraftId == dfBody.DraftID) && (df.DraftId == sendUser.DraftId) &&
                     (sendUser.ToEmailId == (Guid)Membership.GetUser().ProviderUserKey)
                     select new

                     {
                         subject = dfBody.Subject,
                         draftid = df.DraftId
                     }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T17:40:55.510

`.Distinct()`必须作为扩展方法应用。

```
var draft_recieved = (from df in _DataContext.tblDrafts
                 from dfBody in _DataContext.DraftBodies
                 from sendUser in _DataContext.tblSends

                 where (df.DraftId == dfBody.DraftID) && (df.DraftId == sendUser.DraftId) &&
                 (sendUser.ToEmailId == (Guid)Membership.GetUser().ProviderUserKey)
                 select new

                 {
                     subject = dfBody.Subject,
                     draftid = df.DraftId
                 }).Distinct(); 
```

# c# - Windows服务启动然后停止，无法找出错误

> ID：14283478
> 
> 赞同：0
> 
> 时间：2013-01-11T17:27:47.410
> 
> 标签：c#, .net, xml, windows-services, webrequest

我试图以恒定的时间间隔读取文件，然后将查询的数据发送到特定的网络服务器。以下是我正在使用的代码，但是服务启动和停止没有做任何事情。我无法弄清楚错误。

```
public partial class IPTProjectService : ServiceBase
{
    private Thread checkingThread;
    private System.Timers.Timer timer;
    Boolean sendingTime;

    public IPTProjectService()
    {
        InitializeComponent();

        checkingThread = new Thread(update);
        timer = new System.Timers.Timer(Properties.Settings.Default.TIMEINTERVAL);
        timer.Elapsed += timer_Elapsed;
        sendingTime = true;
    }

    void timer_Elapsed(object sender, ElapsedEventArgs e)
    {
        setSendingTime();
        if (!File.Exists("Testfile.txt"))
        {
            File.Create("Testfile.txt");
            timer_Elapsed(sender, e);
        }
        else
        {
            File.WriteAllText("Testfile.txt", timer.ToString());
        }
    }

    private void setSendingTime()
    {
        sendingTime = true;
    }

    private void update()
    {
        while (true)
        {
            if (sendingTime)
            {
                CarpoolWebClient.sendData(Properties.Settings.Default.DATAFILE);
                sendingTime = false;
            }
        }
    }

    protected override void OnStart(string[] args)
    {
        try
        {
            timer.Start();
            checkingThread.Start();
        }
        catch (Exception ex)
        {
            Debug.Fail(ex.ToString());
        }

    }

    protected override void OnStop()
    {
        try
        {
            timer.Stop();
            checkingThread.Abort();
        }
        catch(Exception e)
        {
            StreamWriter writer = new StreamWriter("testfile.txt", true);
            writer.Write(e.ToString());
            writer.Close();
        }
    }
}

class CarpoolWebClient
{
    public static void sendData(String fileName)
    {
        WebRequest req = null;
        WebResponse rsp = null;

        try
        {
            //URL of message broker
            string uri = "http://localhost/IPTProject/receive_xml.php";
            req = WebRequest.Create(uri);
            req.Method = "POST";
            req.ContentType = "text/xml";

            // Wrap the request stream with a text-based writer
            StreamWriter writer = new StreamWriter(req.GetRequestStream());
            // Write the xml text into the stream
            writer.WriteLine(GetTextFromXMLFile(@fileName));
            writer.Close();
            rsp = req.GetResponse();

        }
        catch (WebException webEx)
        {
            //MessageBox.Show(webEx.Message);
            throw webEx;
        }
        catch (Exception ex)
        {
            //MessageBox.Show(ex.Message);
            throw ex;
        }
        finally
        {
            if (req != null) req.GetRequestStream().Close();
            if (rsp != null) rsp.GetResponseStream().Close();
        }
    }

    private static string GetTextFromXMLFile(string file)
    {
        StreamReader reader = new StreamReader(file);
        string ret = reader.ReadToEnd();
        reader.Close();
        return ret;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:34:29.787

如果可以，请调试服务。如果因为服务设置为自动启动而出现问题，那么您可以使用此“技巧”[自动附加调试器](http://msdn.microsoft.com/en-us/library/a329t4ed.aspx)并找出问题所在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T18:21:06.640

当我在自己的计算机（即 localhost）上请求网络服务器时，我没有注意到 wampserver 没有运行。我检查了显示 WebException 的事件日志。启动 wampserver 代码工作正常。谢谢大家。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T17:35:28.480

呼吁

```
File.Create("Testfile.txt");
timer_Elapsed(sender, e); 
```

将创建一个文件并将 a 返回`FileStream`到新创建的文件。该文件随后仍处于打开状态，然后`timer_Elapsed`被调用，这将导致应用程序失败，因为它无法再次打开该文件。请参阅有关该主题的[MSDN 文档](http://msdn.microsoft.com/en-us/library/d62kzs03.aspx)。

您的代码不需要 Create 调用，您可以将方法简化为下面的示例，它应该可以解决此问题。或者，关闭`FileStream`对象。

```
void timer_Elapsed(object sender, ElapsedEventArgs e)
{
    setSendingTime();
    File.WriteAllText("Testfile.txt", timer.ToString());
} 
```

`File.WriteAllText`如果文件不存在，将创建该文件，如果文件存在则覆盖该文件，有效地执行与您的检查相同的操作。

如果这不能解决问题，请检查事件日志是否有错误，或者在记录错误消息的方法中`timer_Elapsed`提供错误处理代码。`update`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-12T14:53:08.457

是的，我遇到过很多次类似的问题...

1.  记录所有未捕获的异常：

    ```
     // Somewhere at the start of the constructor:
        AppDomain.CurrentDomain.UnhandledException += new UnhandledExceptionEventHandler(CurrentDomain_UnhandledException);

    [...]

    void CurrentDomain_UnhandledException(object sender, UnhandledExceptionEventArgs e)
    {
        // Log exeption e.ExceptionObject.ToString to a file
    } 
    ```

2.  另外，我会在更新方法中使用 try-catch + log 来确保如果线程因任何未知原因退出，您会找出原因。

3.  如果这些东西不起作用，通常是因为缺少 DLL、DLL 版本不正确（64/32 位混合）或类似的东西。这可以在事件日志中找到。

应该这样做:-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-12T15:26:24.553

如果您在安装了 Visual Studio 的机器上运行它（例如，您的开发机器），请添加对

```
System.Diagnostics.Debugger.Launch(); 
```

在您的初创公司或任何适当的地方。这将启动 Visual Studio 调试器，因此您不必解决时间问题（在您可以手动附加调试器之前服务停止）

# mp3 - 如何在 Windows Phone 8 中将歌曲/mp3 保存到媒体库？

> ID：14283479
> 
> 赞同：0
> 
> 时间：2013-01-11T17:27:54.217
> 
> 标签：mp3, windows-phone-8, media-library

我正在解决简单的任务 - 在 Windows Phone 8 中，应该可以将从 Internet 下载的 mp3 文件保存到手机媒体库中，而不仅仅是保存到独立存储中。API 的提示在这里：
[Windows Phone SDK 8.0 中的新增功能](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj206940%28v=vs.105%29.aspx#BKMK_Media)
我发现的有关此问题的唯一线程：
[MediaLibrary SaveSong 方法](http://social.msdn.microsoft.com/Forums/en-US/wpdevelop/thread/f5fa73da-176b-4aaa-8960-8f704236bda5)

是否有任何简单的指南如何**将 mp3 歌曲保存到手机媒体库**或至少描述 MediaLibraryExtensions.SaveSong 的**MSDN 文章？**谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T18:04:44.883

这里你去[@API 在 Zune 中添加播放列表](https://stackoverflow.com/questions/4385834/api-to-add-playlists-in-zune/14117264#14117264)

如果您有任何其他问题，请发表评论。

# sql - 从表中的多个 XML 行中选择单个 XML

> ID：14283480
> 
> 赞同：2
> 
> 时间：2013-01-11T17:27:57.087
> 
> 标签：sql, xml

我在一个表中有一个 XML 列，其中表的每一行都是一个完整的 XML 节点。我试图简单地尝试选择这些行的一个子集并使用根节点从中生成一个 XML 文档。我认为我可以执行以下操作，但它会在每个节点周围添加一个额外的包装器，并带有 XML 列的名称。我可以做些什么来不得到这个包装器？

示例数据结构：

```
CREATE TABLE ActivityTable 
(
    XMLDATA AS XML
)

INSERT INTO [ActivityTable] VALUES ( '<Activity>This is activity one</Activity>' )
INSERT INTO [ActivityTable] VALUES ( '<Activity>This is activity two</Activity>' )
INSERT INTO [ActivityTable] VALUES ( '<Activity>This is activity three</Activity>' ) 
```

查询获取数据

```
SELECT 
    XMLdata FROM ActivityTable 
FOR XML PATH(''), ROOT('RootNode') 
```

我得到了什么：

```
<root>
  <XMLdata>
    <Activity>This is activity one</Activity>
  </XMLdata>
  <XMLdata>
    <Activity>This is activity two</Activity>
  </XMLdata>
  <XMLdata>
    <Activity>This is activity three</Activity>
  </XMLdata>
</root> 
```

我想要的是：

```
<root>
  <Activity>This is activity one</Activity>
  <Activity>This is activity two</Activity>
  <Activity>This is activity three</Activity>
</root> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T18:35:57.433

```
SELECT XMLdata AS '*' 
FROM ActivityTable 
FOR XML PATH(''), ROOT('RootNode') 
```

[名称指定为通配符的列](http://msdn.microsoft.com/en-us/library/bb500154.aspx)

> 如果指定的列名是通配符 (*)，则插入该列的内容，就好像没有指定列名一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T18:00:57.880

using`.query('/Node')`是查询某个节点的一种方式，并且您不会返回 XMLData 标记。希望能帮助到你！

```
SELECT XMLDATA.query('/Activity') FROM ActivityTable 
FOR XML PATH(''), ROOT('root') 
```

[SQL 小提琴示例](http://sqlfiddle.com/#!3/93efc/24)

# inno-setup - Inno如何添加 可选向导页面的按钮？

> ID：14283482
> 
> 赞同：1
> 
> 时间：2013-01-11T17:28:07.573
> 
> 标签：inno-setup

我有一个 TInputDirWizardPage 类型的可选向导页面。
如果未输入数据，如何添加不会验证数据并跳过的按钮？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T22:59:56.107

您是否检查过 inno 帮助，在这里您可以看到 TInputDirWizardPage 上的可用功能

```
TInputDirWizardPage = class(TWizardPage)
  function Add(const APrompt: String): Integer;
  property Buttons[Index: Integer]: TNewButton; read;
  property Edits[Index: Integer]: TEdit; read;
  property PromptLabels[Index: Integer]: TNewStaticText; read;
  property SubCaptionLabel: TNewStaticText; read;
  property Values[Index: Integer]: String; read write;
end; 
```

只有当我需要在页面上输入文本时，我才会使用这种方式。我建议您创建一个完整的自定义 WizardPage，这样您会更加灵活。您可以使用设计器来创建页面，我使用 InnoSetup 表单设计器创建了所有自定义页面。在这里你可以看到它在行动[http://www.cenadep.org/2012/02/09/innosetup-form-designer/](http://www.cenadep.org/2012/02/09/innosetup-form-designer/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T13:59:42.160

我找到了简单且有效的解决方案。而不是添加额外的按钮来避免验证空路径。我刚刚添加了默认目录创建。在 [目录] 部分。

```
[Dirs]
Name: {code:WrkGetWorkingDir}; Flags: uninsneveruninstall 
```

如果未指定，我的应用程序可以接受工作目录 cmdline arg 或创建默认值。所以。我总是在安装脚本中指定该 cmdline arg 并创建该默认目录（如果用户没有更改该路径）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-09T13:43:29.043

希望这会有所帮助

```
procedure OnClickMyButton(Sender: TObject);
begin
MsgBox('OnClickMyButton', mbInformation, MB_OK);
end;
procedure CurPageChanged(CurPageID: Integer);
begin

      if CurPageID = YourPageID.ID then
      begin
          MyButton := TButton.Create(YourPageID);
          MyButton.Parent := YourPageID.Buttons[0].Parent;
          MyButton.Top := YourPageID.Edits[0].Top + YourPageID.Edits[0].Height + 10;
          MyButton.Left := YourPageID.Edits[0].Left;
          MyButton.Width := 100;
          MyButton.Caption := 'My Custom Button';
          MyButton.OnClick  := @OnClickMyButton;           
      end; 
end; 
```

# jquery - jQuery解析器错误ajax调用

> ID：14283499
> 
> 赞同：0
> 
> 时间：2013-01-11T17:29:02.360
> 
> 标签：jquery, ajax, spring

我正在尝试 .ajax 访问返回对象列表的 URL，我在 spring 中使用 jacksonJsonView 以在浏览器中返回 json。但是当我尝试这段代码时，它永远不会成功，但错误警报显示 textstatus 为“parseerror”。警报如下所示：'status=parsererror,error=jQuery15109695890768120119_1357924928198 未被调用'

```
$(function() {  
$("#tags").autocomplete({
source: function( request, response ) {
    $.ajax({
        url: 'http://localhost:8181/jquery/api/states/regex?stateName='+request.term,
        method: 'GET',
        dataType: 'jsonp',
        success: function(json) {
        alert("test");

        },
        error: function(httpRequest, textStatus, errorThrown) { 
        alert("status=" + textStatus + ",error=" + errorThrown);
        }
    });
}
}) 
```

API 返回如下内容：

```
[

    {
        "id": 12,
        "stateName": "Vermont",
        "intPtLon": -72.673354,
        "intPtLat": 44.0605475,
        "stUsps": "VT"
    },
    {
        "id": 20,
        "stateName": "Virginia",
        "intPtLon": -78.6681938,
        "intPtLat": 37.5222512,
        "stUsps": "VA"
    }

] 
```

添加以下行解决了这个问题，它在 IE 中运行良好，在 firefox 中运行良好

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T17:36:21.237

你应该改变

```
dataType: 'jsonp', 
```

简单到

```
dataType: 'json', 
```

或者，如果你真的需要 JSONP 并且不能使用 JSON - 你应该从服务器端的请求中获取回调参数并像这样包装响应：

请求["回调"] + "(" + string_with_json_response + ")";

所以，在结果中你会得到类似的东西：

```
jQuery15109695890768120119_1357924928198('{"response":"val"}'); 
```

# performance - Oracle XMLType 插入速度比较

> ID：14283500
> 
> 赞同：2
> 
> 时间：2013-01-11T17:29:15.467
> 
> 标签：performance, oracle, insert, xmltype

我有一个问题要问 Oracle XML DB 专家：

我测量了几个大型 xml 文件的插入性能。理论上 XMLType CLOB 应该具有无与伦比的插入性能，因为插入的 XML 文档是直接写在字符大对象中的，不需要转换。但我的测量表明，XMLType BINARY 列中的插入要快得多，尽管它是一种预先解析的二进制格式。有人能告诉我这是怎么可能的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T18:11:58.510

实际上，如果文档很大，我希望 Binary 会更好，因为使用 Binary XML，您会发现存储的数据更小，因此您在写入所有数据时节省了磁盘 IO。我想总体比较将取决于在 IO 上节省的时间与在系统上转换为二进制文件时额外的 CPU 时间。

# node.js - 在 Mongoose Schema 中使用多个值的唯一文档

> ID：14283503
> 
> 赞同：28
> 
> 时间：2013-01-11T17:29:30.407
> 
> 标签：node.js, mongodb, mongoose

我有一个特殊情况，我们的集合需要根据电子邮件地址和sweepstakes_id 的组合来确保每个文档都是唯一的。我已经看遍了，但我找不到如何完成这种类型的验证。

架构定义：

```
var submissionSchema = new Schema({
    client_id: {
        type: Schema.Types.ObjectId,
        ref: 'Client',
        index: true
    },
    sweepstakes_id: {
        type: Schema.Types.ObjectId,
        ref: 'Sweepstakes',
        index: true
    },
    email: {
        type: String,
        index: true
   },
   data: {
        type: Schema.Types.Mixed,
        default: []
   }
}); 
```

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2013-01-11T18:13:37.787

您可以使用包含两个字段的唯一索引来强制执行此操作：

```
submissionSchema.index({ email: 1, sweepstakes_id: 1 }, { unique: true }); 
```

# mysql - mysql案例函数

> ID：14283504
> 
> 赞同：1
> 
> 时间：2013-01-11T17:29:34.260
> 
> 标签：mysql

我有以下查询，它正在更新缺少连字符的 MAC 地址，但对于其他拥有它们的人来说，它正在将它们更改为空。尝试更新一列中的值。

```
UPDATE mytable SET MAC =
CASE
 WHEN MAC NOT LIKE '%-%' 
  THEN UPPER(CONCAT(SUBSTR(MAC,1,2),'-', SUBSTR(MAC,3,2),'-', SUBSTR(MAC,5,2),'-', SUBSTR(MAC,7,2),'-', SUBSTR(MAC,9,2),'-', SUBSTR(MAC,11,2)))
 END; 
```

任何建议都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T17:31:59.190

Just add an `ELSE` case which sets the value to its current value:

```
UPDATE mytable SET MAC =
CASE
 WHEN MAC NOT LIKE '%-%' 
  THEN UPPER(CONCAT(SUBSTR(MAC,1,2),'-', SUBSTR(MAC,3,2),'-', SUBSTR(MAC,5,2),'-', SUBSTR(MAC,7,2),'-', SUBSTR(MAC,9,2),'-', SUBSTR(MAC,11,2)))
  /* Else case sets it to its current value to avoid NULL */
  ELSE MAC
 END; 
```

It's also possible to use a `WHERE` clause so rows that should not be updated are not matched in the first place. That is probably the more appropriate action to take in this instance, unless you have other conditions to apply in the `CASE`

```
UPDATE mytable 
SET MAC = UPPER(CONCAT(SUBSTR(MAC,1,2),'-', SUBSTR(MAC,3,2),'-', SUBSTR(MAC,5,2),'-', SUBSTR(MAC,7,2),'-', SUBSTR(MAC,9,2),'-', SUBSTR(MAC,11,2)))
WHERE MAC NOT LIKE '%-%' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T17:34:41.720

```
UPDATE mytable 

SET MAC = UPPER(CONCAT(SUBSTR(MAC,1,2),'-', SUBSTR(MAC,3,2),'-', SUBSTR(MAC,5,2),'-', SUBSTR(MAC,7,2),'-', SUBSTR(MAC,9,2),'-', SUBSTR(MAC,11,2)))

WHERE  MAC NOT LIKE '%-%' 
```

# php - .htaccess 为 Laravel 中的简单重定向返回 500

> ID：14283510
> 
> 赞同：0
> 
> 时间：2013-01-11T17:29:52.223
> 
> 标签：php, apache, .htaccess, laravel

我在 Laravel 中创建了一个应用程序。我最初的 .htaccess 是：

```
<IfModule mod_rewrite.c>
    Options +FollowSymLinks
    RewriteEngine On
</IfModule>
<IfModule mod_rewrite.c>
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php/$1 [L]
</IfModule> 
```

它适用于域 api.viglug.org。在我添加了 m.forum.viglug.org 域之后（与 api.viglug.org 的根目录相同）。此时调用 api.viglug.org 和 m.forum.viglug.org 完全一样。我想将 m.forum.viglug.org 用于 api.viglug.org/mobile 文件夹，所以我认为它可以与这个 .htaccess 一起使用：

```
<IfModule mod_rewrite.c>
    Options +FollowSymLinks
    RewriteEngine On
</IfModule>
<IfModule mod_rewrite.c>
    RewriteCond %{HTTP_HOST} m\. [NC] 
    RewriteRule ^(.*)$ index.php/mobile/$1 [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php/$1 [L]
</IfModule> 
```

我错了。如果我使用 m.forum.viglug.org，它会不断返回错误 500，而 api.viglug.org 会按预期工作。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T01:28:11.420

由于以下两个条件，原始重写仅在不作为真实文件或目录存在的文件上运行：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d 
```

您是否尝试在附加规则之上添加这两个条件？

```
# Mobile site
RewriteCond %{HTTP_HOST} m\. [NC] 
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/mobile/$1 [L]

# Normal site
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1 [L] 
```

# asp.net-mvc-4 - PostSharp方面和mvc4

> ID：14283513
> 
> 赞同：1
> 
> 时间：2013-01-11T17:30:14.790
> 
> 标签：asp.net-mvc-4, postsharp

我将 postsharp 方面添加到我的 mvc.net 应用程序中。并开始出现此错误：

**自定义属性“XXXXX.LogAspect”构造函数引发异常 InvalidOperationException：无法加载动态生成的序列化程序集。在某些托管环境中，程序集加载功能受到限制，请考虑使用预生成的序列化程序。请参阅内部异常以获取更多信息。**

有什么帮助吗？提前致谢？

# javascript - jQuery 周历 setDaysToShow 函数

> ID：14283514
> 
> 赞同：1
> 
> 时间：2013-01-11T17:30:17.130
> 
> 标签：javascript, jquery, function, plugins

你能告诉我如何调用`setDaysToShow`jQuery weekcalendar插件的功能吗？我不知道如何通过`days`。

这是来自[文档](https://github.com/themouette/jquery-week-calendar/wiki/Public-methods)：

```
$(“#calendar”).weekCalendar(“setDaysToShow”); // Changes how many days are shown (see the daysToShow option) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T19:22:25.280

```
$('#calendar').weekCalendar('setDaysToShow', value); 
```

或者您可以在初始化时通过将其作为选项传递来执行此操作

```
$('#calendar').weekCalendar({'setDaysToShow': value}); 
```

# ruby-on-rails - Heroku 上不兼容的编码正则表达式匹配（ASCII-8BIT 正则表达式与 UTF-8 字符串）

> ID：14283515
> 
> 赞同：9
> 
> 时间：2013-01-11T17:30:25.303
> 
> 标签：ruby-on-rails, ruby, unicode, heroku, utf-8

我有一个 Rails 应用程序，我在其中使用基于正则表达式的规则对事务进行分类。在我的`seeds.rb`中，我创建了一些类别和规则，然后从 CSV 文件（也是 utf8 编码）导入交易并允许对它们进行分类。这个过程在我的开发机器上运行良好，但是当我在 Heroku 上运行它时，我得到：

> 不兼容的编码正则表达式匹配（ASCII-8BIT 正则表达式与 UTF-8 字符串）

我正在运行 Cedar Stack，Rails 2.3.15。我放了

```
# encoding: utf-8 
```

在我所有源文件的顶部，我在我的应用程序配置中将编码设置为 utf-8，所以我不确定还有什么可能导致这个问题。我想知道是否与 Heroku 配置有关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-23T05:34:16.830

该问题可能是由本地操作系统忽略的不可见字符引起的，以确保进行正确的编码，而在 Heroku 上，字符弄乱了文件顶部的幻数声明，最终得到 ASCII-8BIT 和UTF-8。

由于有问题的文件包含正则表达式，因此它可能是您的模型类而不是 seed.rb。

有很多方法可以查看文件中的不可见字符。中`vi`，只需设置选项`:set list`

# sql-server - 如何首先在 EF 代码中创建持久计算列？

> ID：14283519
> 
> 赞同：9
> 
> 时间：2013-01-11T17:30:34.777
> 
> 标签：sql-server, entity-framework, code-first, entity-framework-migrations

如何使该列与数据库中的 PERSISTED COMPUTED 列相似？

**我当前的尝试（它加载所有 CompCol 行，种子中为 null）：**

```
 public class Call
    {
        public Call()
        {
        }

        [Key]
        public int Id { get; set; }

        [DatabaseGenerated(DatabaseGeneratedOption.Computed)]
        public string CompCol
        {
            get
            {
                return "ABC-" + Convert.ToString(Id).PadLeft(5, '0');
            }
            protected set {}
        }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-22T11:02:50.287

我找到的解决方案是：

1.  确保关闭自动迁移。这样 VS 会生成一个脚本（流利的 api 代码）供我们进一步定制，而不仅仅是运行它。所以在配置类中：

    ```
    public Configuration()
    {
        AutomaticMigrationsEnabled = false;
    } 
    ```

2.  将字段添加到类中并将其设置为计算字段，setter 是私有的，因为我们显然不能写入计算字段：

    ```
    [DatabaseGenerated(DatabaseGeneratedOption.Computed)]
    public string BreakdownNo { get; private set; } 
    ```

3.  然后`add-migration [xyz-name]`在包管理器控制台中生成迁移代码，该代码将出现在具有给定名称的迁移文件夹下。

4.  在迁移中注释掉代码`Up()`并添加自定义 SQL，如下所示：

    ```
    public override void Up()
    {
        //AddColumn("dbo.Calls", "BreakdownNo", c => c.String());
        Sql("ALTER TABLE dbo.Calls ADD BreakdownNo AS ('BD'+RIGHT('00000'+ CAST(Id AS VARCHAR), 6))");
    } 
    ```

5.  在 PM 中执行一次`update-database`，它应该正确添加计算列。

**进一步说明**`update-database -targetMigration: [name of migration to go back to]`：如果您弄错了公式，那么您将不得不通过执行然后再执行另一个并在那里修改您的公式来恢复迁移，`add-migration name`并以更新数据库结束。可能有更好的方法，但这是我发现和使用的。

但是，我还没有找到使该领域持续存在的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-08-04T08:39:05.893

为什么不这样调用sql：

```
public class demo
{
    void demoMethod()
    {
        Model1 model = new Model1();//Model1 : DbContext
        model.Database.ExecuteSqlCommand("alter table Results drop column Total; alter table Results add Total AS (Arabic + English + Math + Science)");
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-03T10:13:33.970

我使用接受的答案中提出的方法遇到了一些麻烦。我提供了一个对我有用的替代解决方案。

运行此查询时遇到错误：

```
oDb.LogEntries.SingleOrDefault(Function(LogEntry) LogEntry.LogTime = dDate) 
```

错误信息：

> 'LogEntry' 上的 'MinutesOffline' 属性无法设置为 'System.Int32' 值。您必须将此属性设置为“System.Single”类型的非空值。

正如我们所见，EF 6.2 正在尝试将值写入属性。这是否是由于 EF 在内部尝试写入`Private Set`，我不知道。它几乎看起来像。但最终结果才是最重要的：声明失败。

我没有将列设置为`DatabaseGeneratedOption.Computed`，而是完全忽略了它：`Builder.Entity(Of LogEntry).Ignore(Function(LogEntry) LogEntry.MinutesOffline)`.

这使我能够创建一个只读属性：

```
Public ReadOnly Property MinutesOffline As Single
  Get
    Return IIf(Me.Scale < 1, 5, 0)
  End Get
End Property 
```

它还有一个额外的好处，就是我们不必在生成的迁移中注释掉任何行。

我们仍然需要进行自定义`Sql()`调用`Up()`：

```
ALTER TABLE [LogEntries] ADD [MinutesOffline] AS (IIF([Scale] < 1, 5, 0)) PERSISTED 
```

...并且`PERSISTED`关键字确实在这里起作用。这将成为一个持久计算列。

YMMV

**- 编辑 -**

我发现了为什么会出现投射错误；它与迁移无关，与我的代码有关。我在创建时没有正确转换计算列：

```
ALTER TABLE [LogEntries] ADD [MinutesOffline] AS (IIF([Scale] < 1, 5, 0)) PERSISTED 
```

这样做的正确语法是这样的：

```
ALTER TABLE [LogEntries] ADD [MinutesOffline] AS (CAST((IIF([Scale] < 1, 5, 0)) AS REAL)) PERSISTED 
```

因此，我已恢复`Ignore()`调用并将所有内容切换回接受的答案中提出的方法。

向[JotaBe 致敬](https://stackoverflow.com/a/25551534/722393)以寻求帮助。

# java - 数字格式

> ID：14283520
> 
> 赞同：2
> 
> 时间：2013-01-11T17:30:38.560
> 
> 标签：java, number-formatting

> **可能重复：**
> [为什么不使用 Double 或 Float 来表示货币？](https://stackoverflow.com/questions/3730019/why-not-use-double-or-float-to-represent-currency)

我正在学习 Java，所以请耐心等待这样一个简单的问题。当给出计算利息时，我输入了以下代码：

```
 public double calculateTotal(double rate, int n)
 {
     amount = amount * Math.pow((1+rate), (n/12));
     return amount;
 } 
```

这将返回我正在寻找的答案，但会不断在末尾添加 0.000000000001。我将如何解决这个问题？一位朋友建议了一种称为数字格式的方法，但我找不到解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:34:21.997

这个问题与众所周知的浮点计算问题有关。

解决方案之一可以使用`import java.math.BigDecimal`

*   [最小化准确性问题的影响](http://en.wikipedia.org/wiki/Floating_point#Minimizing_the_effect_of_accuracy_problems)文章描述了该问题。
*   看看这个ticket [Calculation problem in Java](https://stackoverflow.com/questions/6222372/calculation-problem-in-java)

**编辑**

Java 不允许覆盖运算符，因此将`BigDecimal`s 加在一起的唯一方法是使用`add`方法 eg（假设您的数量是`BigDecimal`. 请记住 BigDecimal 是不可变的，因此从返回的任何内容都`calculateTotal`需要分配回`ammount`

```
// you assign result to amount outside calculateTotal
amount.add(new BigDecimal(Math.pow((1+rate), (n/12)))); 
```

或者

```
// you assign sum to amount inside calculateTotal
amount = amount.add(new BigDecimal(Math.pow((1+rate), (n/12)))); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-12T11:56:01.090

如前所述，`BigDecimal`如果您需要更好的双打精度，这是一个不错的选择。

用 s 进行舍入有很好的方法`BigDecimal`。基本上你必须指定`BigDecimal`实例的规模。看看这个示例代码：

```
BigDecimal decimalOne = new BigDecimal(0.1950);
BigDecimal decimalTwo = decimalOne.setScale(2, BigDecimal.ROUND_HALF_DOWN);
BigDecimal decimalThree = decimalOne.setScale(4, BigDecimal.ROUND_HALF_DOWN);

System.out.println("decimalOne: " + decimalOne);
System.out.println("decimalTwo: " + decimalTwo);
System.out.println("decimalThree: " + decimalThree); 
```

Java 7 会打印如下内容：

```
decimalOne: 0.195000000000000006661338147750939242541790008544921875
decimalTwo: 0.20
decimalThree: 0.1950 
```

请注意，`BigDecimal`实例是不可变的，这就是为什么您必须将结果分配`setScale`给新实例（`decimalOne`不会更改）。

* * *

在许多金融系统`double`中不用于存储货币信息；`long`使用具有特定精度的类型，例如精度为 2，值`100`将是`1.00`，`122`将是`1.22`等。这种方法简化并增加了计算，但它并不适用于所有系统。然而，为了这个问题的简单性，我不会深入探讨这个主题。

# vb.net - SQLHelper and DAL

> ID：14283525
> 
> 赞同：0
> 
> 时间：2013-01-11T17:30:52.507
> 
> 标签：vb.net

Do developers still use [SQLHelper.vb](https://appsimplicity.googlecode.com/svn-history/r217/MetaDataExtractor/SchemaDiscovery/AppSimplicity.SchemaDiscovery.Providers/SQLServer/DataAccess/SQLHelper.vb) to deal with their data access logic? Is there a similar class available for connections to an Oracle database? I have searched for this Oracle class online but I cannot find it. For example, I came accross [this post](http://forums.asp.net/t/272556.aspx/1).

I realise that there are alternative DAL solutions like NHibernate, but really what I am looking for is a place to encapsulate the data access logic.

# android - android get top visible window (not the activity)

> ID：14283526
> 
> 赞同：4
> 
> 时间：2013-01-11T17:30:58.717
> 
> 标签：android

I need to find out the activity name / package name for the top most visible window. I am aware of activity manager API to find out top most activity using get running tasks API, but that is not what I am looking for. It may give activity name which might have hidden or invisible dialog.

So in my case, the top most running task is some invisible dialog. But what is actually visible on the device and accepting input is the second running task.

When I use hierarchy viewer, it knows what is the top most visible window displayed having a focus and it highlights that in bold. So I need to find the same information.

Thanks in advance.

# algorithm - How can we optimise the creation of a trie if we know the input is in alphabetical order?

> ID：14283527
> 
> 赞同：1
> 
> 时间：2013-01-11T17:31:01.310
> 
> 标签：algorithm, data-structures, tree, trie, prefix-tree

I am implementing a prefix tree, with a standard insertion mechanism. If we know we will be given a list of words in alphabetical order, is there any way we can change the insertion to skip a few steps? I am coding in Java, although I'm not looking for code in any particular language. I have considered adding the Nodes for each word to a queue, then hopping backwards through it until we're at a prefix of the next word, but this may be circumventing the whole point of the prefix tree!

Any thoughts on something like this? I'm finding it hard to come up with an implementation that's of any use unless the input is many many very similar words `("aaaaaaaaaab", "aaaaaaaaaac", "aaaaaaaaaad", ...)` or something. But even then doing a string comparison on the prefixes is probably a similar cost to just using the prefix tree normally.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T00:40:52.110

您无法避免查看用于构建树的输入字符串中的所有字符。如果有办法做到这一点，那么我可以让你的算法不正确。特别是，假设有一个单词 w 并且您不看它的一个字符（例如，第 k 个字符）。然后，当您的算法运行并尝试将单词放在 trie 中的某个位置时，它必须能够在不知道所有字符的情况下放置它。因此，如果我将单词的第 k 个字符更改为其他字符，您的算法会将它放在与以前完全相同的位置，这是不正确的，因为单词中的一个字符将不正确。

由于构建 trie 的普通算法所花费的时间与输入中的字符数成正比，因此如果不做一些疯狂的技巧，例如并行化构造代码或将字符打包成机器词并命中它们，您将无法渐近地超越它用你的比特黑客之锤。

但是，您可能会获得恒定的因子加速。由于缓存性能，在链接结构中跟踪大量指针可能会很慢，因此您可以通过最小化必须遵循的指针数量来加速算法。您可以做的一件事是保持您插入的最后一个字符串的末尾的位置，以及一个跟踪路径回到根的节点列表（最好作为动态数组）。要插入新字符，您可以执行以下操作：

1.  查找与您插入的最后一个字符串匹配的字符串的最长前缀。
2.  跳转到数组中的指针，标记将带你去哪里。
3.  正常跟踪路径的其余部分，将跟踪的所有节点添加到数组并覆盖以前的指针。

这样，如果您插入大量具有合理长度的公共前缀的单词，您可以避免通过结构的共享部分进行一堆指针追踪。如果您有很多具有相同前缀的单词，这可能会给您带来性能提升。它并没有比以前更好（事实上，它使用了更多的内存），但是不遵循指针所节省的成本可以加起来。我没有对此进行测试，但似乎它可能会起作用。

希望这可以帮助！

# c# - Positioning an OpacityMask in WPF

> ID：14283528
> 
> 赞同：1
> 
> 时间：2013-01-11T17:31:03.527
> 
> 标签：c#, wpf

In a WPF User Control, I am trying to mask an Image control with a circle that can vary in position and size. The user left-drags to change the circle radius and right-drags to change the center point of the ellipse. I'm capturing all the needed values correctly and can properly set the radius of the mask. The problem is, that no matter what point I use for the center of the ellipse, it is drawn from the center of the Image control. Any ideas?

Below is the code that sets the mask:

```
private void SetMask(double _Radius)
{
        EllipseGeometry MaskGeometry = new EllipseGeometry(CenterPos, _Radius, _Radius);
        GeometryDrawing MaskDrawing = new GeometryDrawing(Brushes.Black, null, MaskGeometry);
        DrawingBrush MaskBrush = new DrawingBrush(MaskDrawing);
        MaskBrush.Stretch = Stretch.None;
        Img.OpacityMask = MaskBrush;  //Img is the Image control
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T18:36:06.480

您还必须设置[ViewboxUnits](http://msdn.microsoft.com/en-us/library/system.windows.media.tilebrush.viewboxunits.aspx)、[AlignmentX](http://msdn.microsoft.com/en-us/library/system.windows.media.tilebrush.alignmentx.aspx)和[AlignmentY](http://msdn.microsoft.com/en-us/library/system.windows.media.tilebrush.alignmenty.aspx)属性：

```
private void SetMask(double radius)
{
    var maskGeometry = new EllipseGeometry(CenterPos, radius, radius);
    var maskDrawing = new GeometryDrawing(Brushes.Black, null, maskGeometry);
    var maskBrush = new DrawingBrush
    {
        Drawing = maskDrawing,
        Stretch = Stretch.None,
        ViewboxUnits = BrushMappingMode.Absolute,
        AlignmentX = AlignmentX.Left,
        AlignmentY = AlignmentY.Top
    };

    Img.OpacityMask = maskBrush;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T18:43:09.617

您需要修改DrawingBrush 基础图块的[Viewport](http://msdn.microsoft.com/en-us/library/system.windows.media.tilebrush.viewport.aspx)和[ViewportUnits属性：](http://msdn.microsoft.com/en-us/library/system.windows.media.tilebrush.viewportunits.aspx)

```
private void button1_Click(object sender, RoutedEventArgs e)
    {
        EllipseGeometry MaskGeometry = new EllipseGeometry(CenterPos, _RadiusX, _RadiusY);
        GeometryDrawing MaskDrawing = new GeometryDrawing(Brushes.Black, null, MaskGeometry);
        DrawingBrush MaskBrush = new DrawingBrush(MaskDrawing);
        MaskBrush.Stretch = Stretch.None;
        MaskBrush.ViewportUnits = BrushMappingMode.Absolute;
        MaskBrush.Viewport = MaskGeometry.Bounds;
        Img.OpacityMask = MaskBrush;  //Img is the Image control

    } 
```

[这里](http://msdn.microsoft.com/en-us/library/system.windows.media.tilebrush.viewport.aspx)的MSDN 文档很好地解释了如何使用 TileBrush 绘制控件。

# php - How to merge Laravel objects in controller

> ID：14283532
> 
> 赞同：27
> 
> 时间：2013-01-11T17:31:13.100
> 
> 标签：php, laravel

I have a controller where I want to combine data from multiple tables with parallel structures. What I want to end up with in the end is one object I can return from the controller so I can parse it in Backbone.

I want to do something like this:

```
public function index()
{
    $mc = MainContact::where('verified', '=', '1')->get();
    $sm = SendMessage::where('verified', '=', '1')->get();

    $obj = (object) array_merge((array) $mc, (array) $sm);
    return $obj;
} 
```

I'm told by [another post on StackOverflow](https://stackoverflow.com/questions/455700/what-is-the-best-method-to-merge-two-php-objects) that this works in PHP 5.3+. However, this returns the following error in Laravel:

```
UnexpectedValueException: The Response content must be a string or object implementing
 __toString(), "object" given. 
```

How do I implement this method in Laravel? Both `$mc` and `sm` return valid objects in Laravel.

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2013-10-24T13:09:13.573

现在你可以使用

`$new_collection = $collection->merge($other_collection)`.

这在[Laravel 4](http://laravel.com/api/source-class-Illuminate.Support.Collection.html#299-319)中有效，并且似乎可以处理数组和集合。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2013-01-11T21:00:24.763

您可以在这里做的是合并两个查询结果的数组，然后使用带有 json 输出的响应，如下所示。

```
$array = array_merge($mc->toArray(), $sm->toArray());
return Response::json($array); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-10-17T06:39:29.407

我们可以使用如下集合

```
$admins = User::where('type', '=', 'admin')->get();

$authors = User::where('type', '=', 'author')->get();

$admin_author_collection = $admins->merge($authors); 
```

另外，请参考以下链接的各种收集方法

[http://laravel.com/api/4.2/Illuminate/Database/Eloquent/Collection.html](http://laravel.com/api/4.2/Illuminate/Database/Eloquent/Collection.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-02-02T17:59:37.417

```
Route::get('test', function(){
    $rank = Rank::get();
    $policy = Policy::get();
    $obj = (object)array_merge_recursive((array)$rank , (array)$policy);
    var_dump($obj);
}); 
```

这对我有用。代替 array_merge 使用 array_merge_recursive()。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2019-09-09T10:26:58.770

你可以简单地使用`array_merge(firstObject,secondObject)`函数。

```
$obj = array_merge($mc, $sm);
return $obj; 
```

# powershell - Script echo current command in PowerShell

> ID：14283535
> 
> 赞同：6
> 
> 时间：2013-01-11T17:31:22.833
> 
> 标签：powershell

Suppose I'm running a PowerShell script that takes several input parameters. The command looks like:

```
psScript.ps1 -arg1 "arg1value" -arg2 "arg2value" 
```

Is there a way to store this exact command in a variable within the script so that I can log it?

Specifically, I'd like to know what to assign to the variable $currentCommand:

```
$currentCommand = <something>
Write-Host "currently running script " $currentCommand 
```

Such that the Write-Host output would be the exact command line used to invoke the script. If the script command was the same as above, for example, then the output would be:

> currently running script psScript.ps1 -arg1 "arg1value" -arg2 "arg2value"

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-11T17:54:45.000

这可能适合您的需求：

```
Write-Host "currently running script " $myinvocation.Line 
```

[参考](http://blogs.msdn.com/b/powershell/archive/2007/05/31/getting-all-your-parameters.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-11T17:34:37.380

$MyInvocation 变量将包含信息。这是一篇关于它的好[博客文章](http://poshoholic.com/2008/03/18/powershell-deep-dive-using-myinvocation-and-invoke-expression-to-support-dot-sourcing-and-direct-invocation-in-shared-powershell-scripts/)。

# android - android: different textvies and edittexts depending on radiobuttons

> ID：14283537
> 
> 赞同：0
> 
> 时间：2013-01-11T17:31:25.353
> 
> 标签：android, textview, radio-button, textedit

I'm starting to learn a bit about android programming and watch plenty of guides/tutorials but there's one question none of the guides answer. I have a radio group of two buttons, simply like this(in the xml):

```
 <RadioButton
        android:id="@+id/radioButton1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:checked="true"
        android:text="button1" />

    <RadioButton
        android:id="@+id/radioButton2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="button2" />
</RadioGroup> 
```

The thing is that i want to show different textviews and different edittexts depending on what radio button is clicked, does anybody know where i can find a good example about this or might even wanna make an example yourself?

Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T17:42:24.487

您可以简单地将 type1 的 textview 与一些父视图（如 LinearLayout 等）包装起来，以用于其他 textview 的类型。
不仅仅是 onCheckedChanged(RadioGroup arg0, int checkedId) 显示和隐藏包装视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T17:42:59.333

最简单的方法是将所有内容添加到主视图中。然后，根据单击的内容，将您不想看到的所有项目的可见性设置为 View.GONE，将您不想看到的项目的可见性设置为 View.INVISIBLE。或者，如果您有更复杂的东西并且两个视图不共享很多变量，那么将它们实现为片段可能是有意义的。

# jquery - jQuery $.map() 返回一个新元素

> ID：14283539
> 
> 赞同：1
> 
> 时间：2013-01-11T17:31:47.037
> 
> 标签：jquery, map

我有以下代码：

```
$('#test')
    .append($.map(this.items, function (item, index) {
        return '<li><input type="checkbox" value="' + item.key + '">' item.title + '</li>'
    }).join('')); 
```

但我希望它看起来更像这样：

```
$('#test')
    .append($.map(this.items, function (item, index) {
        return $('<li/>').append('<input/>', {type: 'checkbox', value: item.key}).text(item.title)
    }); 
```

但这似乎有效。有人可以帮忙吗？

**编辑** ，因为似乎答案不适用于 RL 情况（我将代码简短解释）这是我的实际代码：

```
_RenderCheckbox: function () {
    $('<ul/>')
        .appendTo(this.element)
        .addClass('widget')
        .append($('<input>').attr({ type: 'text', class: 'field', 'data-map': this.element.attr("data-map") }))
        .append($.map(this.items, function (item, index) {
                return '<li><label><input type="checkbox" value="' + item.key + '">' + item.parent + item.title + '</label></li>'
        }).join(''));
}, 
```

这是我正在开发的 jquery ui 小部件的一部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:36:12.577

`.text()`替换你的内容`<li>`。你必须`append`/`prepend`你的元素：

```
return $('<li />', {
    text: item.title
}).append($('<input />', {
    type: 'checkbox',
    value: item.key
})); 
```

另外，不要使用`join()`. 只需将此代码放入`$.each`：

```
var $test = $('#test');

$.each(this.items, function(item, index) {
    var $li = $('<li />', {
        text: item.title
    }).appendTo($test);

    $('<input />', {
        type: 'checkbox',
        value: item.key
    }).appendTo($li);
}); 
```

如果你更喜欢巨大的单线：

```
var $test = $('#test');

$.each(this.items, function(item, index) {
    $('<li />', {
        text: item.title
    }).appendTo($test)
      .append($('<input />', {
        type: 'checkbox',
        value: item.key
    }));
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T17:37:26.450

您是否尝试过拼接东西以避免返回错误的对象？没有尝试过你的代码，这可能会起作用：

```
$('#test')
.append($.map(this.items, function (item, index) {
    var ret = $('<li/>');
    var input = ret.append('<input/>', {type: 'checkbox', value: item.key});
    input.text(item.title);
    return ret;
}); 
```

# java - 设置 Java 游戏片段

> ID：14283546
> 
> 赞同：-8
> 
> 时间：2013-01-11T17:32:07.177
> 
> 标签：java, eclipse, ide

我对这个完全不知所措。这是到目前为止的说明和代码：

```
import java.util.*;

abstract public class AbstractGamePiece
{

    // These two constants define the Outlaws and Posse teams
    static public final int PLAYER_OUTLAWS = 0;
    static public final int PLAYER_POSSE = 1;

    // These variables hold the piece's column and row index
    protected int myCol;
    protected int myRow;

    // This variable indicates which team the piece belongs to
    protected int myPlayerType;

    // These two strings contain the piece's full name and first letter abbreviation
    private String myAbbreviation;
    private String myName;

    // All derived classes will need to implement this method
    abstract public boolean hasEscaped();

    // Initialize the member variables with the provided data.
    public AbstractGamePiece(String name, String abbreviation, int playerType)
    {

    }

} 
```

我需要帮助的是完成公共 AbstractGamePiece(...) 部分下的代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T18:06:57.647

试图让你在不为你写下整个事情的情况下继续前进：

对于第 1 点，目标是根据传递给构造函数的参数初始化内部变量（已在类中定义）：

```
public AbstractGamePiece(String name, String abbreviation, int playerType) {
    myName = name;
    // and so on
} 
```

然后，“getter”类型函数返回当前对象中可用的值，如下所示

```
public int getPlayerType() {
    return myPlayerType;
} 
```

Setter 是相反的，它们根据传递的参数设置内部变量：

```
public void setPosition(int col, int row) {
    myRow = row;
    myCol = col;
} 
```

等等。

然后，根据说明，您必须使用这个抽象类作为几个具体类的基础：

```
public class Henchman extends AbstractGamePiece {

    // the constructor - not sure what exactly should be passed in here
    // but you get the idea - this constructor doesn't have to have the
    // same "signature" as super's
    public Henchman(String name) {
        super(name, "hm", PLAYER_OUTLAWS);
    }

    // an an implementation of abstract method hasEscaped
    @Override
    public boolean hasEscaped() {
        return false;  // as per the instructions
    }

} 
```

toString 方法将当前对象的特定描述作为（人类可读的）字符串返回，并且它可以例如用于打印当前片段的人类可读列表，以便在您开始开发游戏引擎后帮助分析/调试游戏. 正如说明所说，它的作用取决于你，让它返回所有有趣和识别信息。为了让您开始，对于 Henchman：

```
public toString() {
    String.format("Henchman name=%s team=%d escaped=%",myName,myTeam,hasEscaped());
} 
```

但是有 1000 种同样适用的变体。

这应该可以帮助您入门，如果您以后遇到困难，请不要犹豫创建一个新问题。祝你好运！

# codeigniter - How to show data in input field when select data at dropdown in Grocery Crud and Codeigniter

> ID：14283548
> 
> 赞同：2
> 
> 时间：2013-01-11T17:32:13.233
> 
> 标签：codeigniter, grocery-crud

In Grocery Crud and Codeigniter , Basically i want to show data from one table(such as a_tbl) when select data or id_no(id_no will get from a_tbl) in dropdown then Name and current posting data will take in input field from table(such as a_tbl) , Then Designation, Dept and Section will take in input field from three different table (such as desg_tbl, dept_tbl, sect_tbl).

![enter image description here](../Images/cc97679dec85091704b32e8edb9a7cc0.png)

How can i solve it , Please any help me

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T05:31:18.253

您可以使用 AJAX。如果您使用 jquery，您可以执行以下操作：

```
$("#field-ID_No").change(function(){
   $.ajax({
      'url':'your_controller/get_name_of_id/'+$("#field-ID_No").val(),
      'success':function(response){
         $("#field-Name").value(response);
      }
   });
}); 
```

基本上，当field-ID_No（选择/组合框）改变时，程序会向服务器发送一个请求（例如：get_name_of_id/1）。假设，您在控制器中有“get_name_of_id”函数，它根据给定的 id 回显名称，您将获得名称作为响应。（对不起，如果这听起来很复杂）。然后，应该使用该回显名称更改 field-Name 的值。

有关 AJAX 和 JQuery 的更多信息，您可以阅读[https://stackoverflow.com/a/5004276/755319](https://stackoverflow.com/a/5004276/755319)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T05:29:04.213

我已经完成了你想要的，它真的很简单，完整的教程在下面的链接 [http://www.grocerycrud.com/forums/topic/1087-updated-24112012-dependent-dropdown-library/](http://www.grocerycrud.com/forums/topic/1087-updated-24112012-dependent-dropdown-library/)

希望你会发现它有帮助

# javascript - Creating nested elements using prependTo()

> ID：14283549
> 
> 赞同：0
> 
> 时间：2013-01-11T17:32:15.930
> 
> 标签：javascript, jquery, dom

I have written the following code that aims to create a div and within it a nested span. Here is the code. Its results buffle me:

```
function(){
    $("<div>", {
    text: "<span>SomeText</span>",
    class: "queryTitle"
}).prependTo(container); 
```

When inspected in chrome this is the resulting html:

```
<div class="queryTitle"><span>1234</span></div> 
```

And while this is the exact html I am aiming for, this html is not rendered properly in the browser, as the span block displays "unrendered" in the browser, like below:

```
<span>1234</span> 
```

(I understand I can rewrite the code like below

```
function(){
  $("<div class = " + queryTitle + "><span>1234</span></div>").prependTo(container)
} 
```

which returns the desired result, yet I find this syntax a bit unreadable, plus I would really like to understand what I am doing wrong as an educational drill.

Thank you for reading.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-11T17:39:54.597

该`text`函数将创建一个 textNode，它不会将其内容视为 html（以明文形式显示 span 标签）。改用`html`：

```
function(){
    $("<div>", {
    html: "<span>SomeText</span>",
    'class': "queryTitle"
}).prependTo(container); 
```

**编辑**-为清楚起见，您的代码等效于：

```
$("<div>")
    .text("<span>SomeText</span>") // creates a textNode and appends it
    .addClass("queryTitle")
    .prependTo(container); 
```

你真正想要的地方：

```
$("<div>")
    .html("<span>SomeText</span>") // sets innerHTML
    .addClass("queryTitle")
    .prependTo(container); 
```

可以在此处找到（有点）描述第一种语法的文档：http: [//api.jquery.com/jQuery/#jQuery2](http://api.jquery.com/jQuery/#jQuery2)

**注意：**将 HTML 字符串放入 JavaScript 通常是个坏主意。您不应该这样做，因为随着项目的发展，它变得难以维护。

# xml - How to set OMITTAG YES in XML file

> ID：14283555
> 
> 赞同：0
> 
> 时间：2013-01-11T17:32:25.860
> 
> 标签：xml, omittag

I have hundreds of files which don't compile into Microsoft Help Format because there are several minor XML syntax issues: `<dd>` without `</dd>` for example.

That's why I want to allow ignoring missing tags in XML so the XML files will pass the test of that conversion program (mshcMigrate Utility). But the question is: how to set OMITTAG to YES?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T17:38:50.830

这不可能。设置`OMITTAG`为 YES 是 XML 中不可用的 SGML 功能。

参考：[http](http://www.w3.org/TR/NOTE-sgml-xml) ://www.w3.org/TR/NOTE-sgml-xml 。

BoltClock 的评论非常中肯。标签必须匹配；否则它不是 XML。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-12T02:03:21.390

`OMITTAG`是一个 SGML 特征。XML 没有它。

如果您的原件是 HTML 文件，并且其中的标记足够合理，可以通过[SGML 验证](http://validator.w3.org/)，那么您可以考虑使用[`osx`](http://openjade.sourceforge.net/doc/sx.htm)将它们转换为 XML（或“完全标记”）格式。

# php - sql注入mysql_real_escape_string

> ID：14283556
> 
> 赞同：0
> 
> 时间：2013-01-11T17:32:27.633
> 
> 标签：php, mysql, sql

我有一个难题，当有人使用或在我的评论字段上时，我应该如何`mysql_real_escape_string()`不将变量插入数据库，我尝试使用而不是，但似乎我不确切知道如何允许我想要的所有字符和符号。`\n, \r, \x00``" '``<br>``preg_replace``mysql_real_escape_string`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T17:34:59.337

`mysql_real_escape_string`仅转义值以便您的查询不会中断，如果使用正确，它还可以防止 SQL 注入。

如果您不想要某些字符，则需要在应用之前使用附加功能来去除*它们*`mysql_real_escape_string`。

[插入强制性的“使用准备好的陈述”评论]

前任：

```
$string = "My name is
John";

$filtered_string = str_replace("\n", " ", $string); // filter
$escaped = mysql_real_escape_string($filtered_string); // sql escape
mysql_query("INSERT INTO `messages` SET `message` = '" . $escaped . "'"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T17:41:14.783

您应该能够使用 str_replace 来帮助解决这个问题：

```
mysql_real_escape_string(str_replace(array("\n", "\r\n", "\x00", '"', '\''), '', $input)); 
```

话虽如此，数据库读/写切换到 mysqli 或 PDO 是个好主意。这两者都允许准备好的语句，从而降低了 SQL 注入的风险。

以下是 PDO 的示例：

```
$stmt = $PDOConnection->prepare('INSERT INTO example_table (input_field) VALUES (:input_field)');
$stmt->bindParam(':input_field', $input);
$stmt->execute(); 
```

# java - 扩展活动或列表活动？

> ID：14283559
> 
> 赞同：0
> 
> 时间：2013-01-11T17:32:38.157
> 
> 标签：java, android

好的，伙计们，作为一个 Android 新手，我正在努力解决各种问题。我的问题是我试图在“onListItemClick”中开始一个新的意图活动。我为此设置了方法，但是当我在单击列表中的项目时运行 AVD 时，没有任何反应，意图没有启动。

如果我将超类更改为“ListActivity”，我会收到一条崩溃消息“您的内容必须有一个 id 属性为“android.r.id.list”的列表视图”

谁能告诉我为什么意图不会从单击列表视图中的项目开始？这是我的列表视图类：

```
package com.example.sqliteexample;

import android.app.Activity;
import android.app.ListActivity;
import android.content.Intent;
import android.database.Cursor;
import android.os.Bundle;
import android.support.v4.widget.SimpleCursorAdapter;
import android.view.View;
import android.widget.ListView;
import android.widget.Toast;

public class SQLView extends ListActivity {

protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    HotOrNot H = new HotOrNot(this, null, null);

    setContentView(R.layout.layout);
    ListView listContent = (ListView)findViewById(R.id.contentList);

    HotOrNot Content = new HotOrNot(this, null, null);
    Content.open();
    Cursor cursor = Content.getData();

    startManagingCursor(cursor);

    @SuppressWarnings("static-access")
    String [] from = new String [] {H.KEY_NAME, H.KEY_HOTNESS};
    int [] to = new int [] {R.id.txtName, R.id.txtAge};

    @SuppressWarnings("deprecation")
    SimpleCursorAdapter cursorAdapter = new SimpleCursorAdapter(this, R.layout.entries, cursor, from, to);

    listContent.setAdapter(cursorAdapter);
 }

public void onListItemClick(ListView l, View v, int posistion, long id)
{

    Intent i = new Intent("com.example.sqliteexample.SQLiteExample");

    startActivity(i);
}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T17:37:40.447

如果你要使用 a`ListActivity`那么你不需要这一行：

```
ListView listContent = (ListView)findViewById(R.id.contentList); 
```

**但是**现在引用的那个特定`ListView`的（假设它在相应的xml布局中）必须将它的id更改为

```
<ListView
  android:id="@android:id/list"
..... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T17:34:54.353

> 我收到一条崩溃消息“您的内容必须有一个 id 属性为 'android.r.id.list' 的列表视图”

当您扩展`ListActivity`但 xml 中没有属性列表时会发生这种情况（在您的情况下为 layout.xml）。阅读[此示例以了解如何创建 ListActivity](http://www.learn-android.com/2009/12/05/lots-of-lists-1-simple/)。

> 扩展活动或列表活动？

这个问题的答案取决于您的要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T17:36:37.063

在您的 layout.xml 文件中，调整您的 ListView 元素，使其具有类似于以下内容：最重要的是`android:id`行

```
<ListView
        android:id="@android:id/list"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_alignParentTop="true"
        android:layout_centerHorizontal="true" >
    </ListView> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T17:43:08.413

```
listContent.setOnItemClickListener(new OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> arg0, View arg1,
                int position, long id) {

                Intent i = new Intent("com.example.sqliteexample.SQLiteExample");
                startActivity(i);
        }
    }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-23T16:33:19.220

活动 - 用于正常目的 ListActivity - 用于您更专注于显示列表的地方。

ListActivity 相对于 Activity 的优势：

1.  如果列表只有文本显示，则甚至不需要定义布局文件，因此无需`setContentView()`调用。
2.  如果我们需要在布局文件中显示除列表以外的其他内容（比如 TextView），只需使用 @android:id/xxx ，`android.R.layout.simple_list_item_1`适配器中的布局资源参数将对应于 xml 中定义的此列表。
3.  与其先定义列表然后调用`setAdapter()`它，不如`setListAdapter()`直接调用。
4.  无需`setOnClickListener()`在列表上实现 OnClickListener，然后使用`onItemClick()`. 只需使用`onListItemClick()`.

# c# - Multiple Datatemplates & Grid.IsSharedSizeScope - Not aligning to content width

> ID：14283561
> 
> 赞同：2
> 
> 时间：2013-01-11T17:32:41.497
> 
> 标签：c#, wpf, xaml

I have a listbox in which I render data using multiple datatemplates, and I use a datatemplate selector to route data to the appropriate template.

Each template has it's own layout using a grid. The first column of every grid inside the template is a textblock and I want them aligned to left. The next item is another textblock which should be aligned towards the maximum width of the first textblock (something similar to a data entry form). I'm using Grid.IsSharedSizeScope for this, but not able to achieve this. Below is my code:

```
<Page xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"    
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">      

<Page.Resources>

 <DataTemplate x:Key="DefaultTemplate">
            <Border BorderThickness="1" CornerRadius="3" BorderBrush="LightGray">
            <TextBlock Text="{Binding Name}"></TextBlock>
            </Border>
        </DataTemplate>
        <DataTemplate x:Key="ShortFieldTemplate">
            <Grid Grid.IsSharedSizeScope="True">

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" SharedSizeGroup="A"/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>  
                <TextBlock Text="Age:"  Grid.Column="0"></TextBlock>
                <TextBlock Text="{Binding Age}" Grid.Column="1"></TextBlock>
            </Grid>            
        </DataTemplate>
        <DataTemplate x:Key="LongFieldTemplate">
            <Grid Grid.IsSharedSizeScope="True">

                    <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" SharedSizeGroup="A"/>
                        <ColumnDefinition/>                        
                    </Grid.ColumnDefinitions>               
                <TextBlock Text="This should be the name:" Grid.Column="0"></TextBlock>
                <TextBlock Text="{Binding Name}" Grid.Column="1"></TextBlock>                
                </Grid>                      
        </DataTemplate>

        <GridSplitterTextTrim:MyFirstTemplateSelector x:Key="MyFirstTemplateSelector" 
                                                      DefaultDataTemplate="{StaticResource DefaultTemplate}"
                                                      ShortFieldDataTemplate="{StaticResource ShortFieldTemplate}"
                                                      LongFieldDataTemplate="{StaticResource LongFieldTemplate}"
                                                      />

</Page.Resources>

   <Grid x:Name="LayoutRoot" Grid.IsSharedSizeScope="True">

    <Grid Grid.Column="2" Background="Green" >

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition/>
                <ColumnDefinition/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition/>
                <RowDefinition/>
                <RowDefinition/>
            </Grid.RowDefinitions>
            <ListBox ItemsSource="{Binding Items}" Grid.Row="0" Grid.Column="0" x:Name="listbox" ItemTemplateSelector="{StaticResource MyFirstTemplateSelector}">  
            </ListBox>
        </Grid>   
   </Grid>  
</Page> 
```

..and my object model

```
 public class ShortField : INotifyPropertyChanged
    {
        private string _name;
        public string Age
        {
            get { return _name; }
            set
            {
                _name = value;
                InvokePropertyChanged(new PropertyChangedEventArgs("Age"));
            }
        }

        private string _currentValue;
        public string CurrentValue
        {
            get { return _currentValue; }
            set
            {
                _currentValue = value;
                InvokePropertyChanged(new PropertyChangedEventArgs("CurrentValue"));
            }
        }

        public event PropertyChangedEventHandler PropertyChanged;

        public void InvokePropertyChanged(PropertyChangedEventArgs e)
        {
            PropertyChangedEventHandler handler = PropertyChanged;
            if (handler != null) handler(this, e);
        }

        public static List<ShortField> GetShortFields()
        {
            return new List<ShortField>()
                       {
                           new ShortField() {Age = "10"},
                           new ShortField() {Age = "21"},
                       };
        }
    } 
```

How do I get this alignment right? I thought Grid.IsSharedScope should do the trick. Is that correct or is there any other way?

Thanks in advance, -Mike

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T17:40:31.130

尝试设置

```
<ListBox Grid.IsSharedSizeScope="True" 
```

# python - Python: Appending to an instance attribute from inside a function

> ID：14283563
> 
> 赞同：0
> 
> 时间：2013-01-11T17:32:42.450
> 
> 标签：python, class, instance

I am trying to write a basic card game for fun, but trying to make as much of it as possible applicable to future card games.Here is my code.

```
decks = [  ]
players = [  ]

class Player:
global players
def __init__( self, name ):
    self.hand = [  ]
    self.name = ''
    self.score = 0
    self.name = 'playerX'
    self.score = 0
    players.append( name )

class Deck:
    global decks
    global players

def __init__( self, name ):
    self.SUITS = [ 'C', 'D', 'H', 'S' ]
    self.RANKS = [ '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A' ]
    self.deck = [  ]
    for r in self.RANKS:
        for s in self.SUITS:
            self.deck.append( ( r, s ) )
    decks.append( name )

def shuffle( self ):
    shuffle( self.deck )

def display( self ):
    for e in range(0, len( self.deck ), 4):
        for i in self.deck[e:e+4]:
            print i,
        print

def dealXtoOne( number, deck, player ):
    ''' number of cards from a deck to named player'''
    if len( deck.deck ) >= number:
        for n in range( 0, number ):
            player.hand.append( deck.deck.pop(  ) )
            print 'Player1 hand: ', p1.hand
    else:
        return 'Insufficient cards in the deck.'

def dealXtoEach( number, deck ):
    ''' number of cards from a deck to each player'''
    global players
    print 'debug 0'
    if len( deck.deck ) >= number*len( players ):
        print 'debug 1'
        for cards in range( 0, number*len( players ) ):
            print 'debug 2'
            for player in players:
                print 'debug 3'
                print player
                print player.hand
                player.hand.append( deck.deck.pop(  ) )
                print player.hand
    else:
        return 'Insufficient cards in the deck.'

def value( card ):
    if card[ 0 ] == 'J': return 11
        elif card[ 0 ] == 'Q': return 12
        elif card[ 0 ] == 'K': return 13
        elif card[ 0 ] == 'A': return 14
        else: return card[ 0 ]

def topCard( deck ):
    return deck.deck[ -1 ]

def color( card ):
    if card[ 1 ] in [ 'Diamonds', 'Hearts' ]:
        return 'Red'
    else:
        return 'Black'

p1 = Player( 'p1' )
p2 = Player( 'p2' )
d = Deck( 'd' )

d.display(  )
print p1.hand
dealXtoOne( 3, d, p1 )
d.display(  )
print p1.hand
dealXtoEach( 3, d )
d.display(  ) 
```

I'm sure it's garbage, and it's clearly a work in progress, but I am teaching myself to program. Sorry if your eyes bleed!

So dealing X cards to one player works fine, but dealing X cards to N players each is not working. Here is my output:

```
('2', 'C') ('2', 'D') ('2', 'H') ('2', 'S')
('3', 'C') ('3', 'D') ('3', 'H') ('3', 'S')
...
('K', 'C') ('K', 'D') ('K', 'H') ('K', 'S')
('A', 'C') ('A', 'D') ('A', 'H') ('A', 'S')
[]
Player1 hand:  [('A', 'S')]
Player1 hand:  [('A', 'S'), ('A', 'H')]
Player1 hand:  [('A', 'S'), ('A', 'H'), ('A', 'D')]
('2', 'C') ('2', 'D') ('2', 'H') ('2', 'S')
...
('K', 'C') ('K', 'D') ('K', 'H') ('K', 'S')
('A', 'C')
[('A', 'S'), ('A', 'H'), ('A', 'D')]
debug 0
debug 1
debug 2
debug 3
p1

Traceback (most recent call last):
    File "C:\Users\11583\Desktop\Personal\cardgame.py", line 94, in <module>
        dealXtoEach( 3, d )
    File "C:\Users\11583\Desktop\Personal\cardgame.py", line 60, in dealXtoEach
        print player.hand
AttributeError: 'str' object has no attribute 'hand' 
```

I can tell that it doesn't like that I am trying to append a tuple to the reference inside the dealXtoEach function of the instance of Player represented by the string in the players global variable. Sheesh, I am confused just explaining it.

So how can I get around this?

Thanks

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T17:37:31.013

该错误与追加到元组无关（顺便说一句，`players`是列表而不是元组 - 不可能追加到元组）。

相反，请尝试替换该行：

```
players.append( name ) 
```

和

```
players.append( self ) 
```

这样，全局`players`列表将不包含字符串列表（您不能多次使用），它将包含`Player`对象列表（其中包括`hand`属性）。

* * *

额外说明：全局`players`列表并不是真正必要的（通常建议不要使用全局变量）-您可以传递`players`列表。其次，`dealXToOne`真正`dealOneToEach`应该是`Deck`类的方法。总之，这将使最后几行看起来像：

```
players = [p1, p2]
d.dealXToOne(3, p1)
d.dealXToEach(e, players) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T17:42:20.530

`player`由于这一行，列表中的每个`players`都是一个字符串，而不是一个`Player`对象：

```
players.append( name ) 
```

用。。。来代替：

```
players.append( self ) 
```

# r - R中的特定for循环太慢

> ID：14283566
> 
> 赞同：3
> 
> 时间：2013-01-11T17:32:50.953
> 
> 标签：r

我必须使用 2 个数据框 200 万条记录和另外 200 万条记录。我使用了一个 for 循环来相互获取数据，但它太慢了。我创建了一个示例来演示我需要做什么。

```
ratings = data.frame(id = c(1,2,2,3,3),
                     rating = c(1,2,3,4,5),
                     timestamp = c("2006-11-07 15:33:57","2007-04-22 09:09:16","2010-07-16 19:47:45","2010-07-16 19:47:45","2006-10-29 04:49:05"))
stats = data.frame(primeid = c(1,1,1,2),
                   period = c(1,2,3,4),
                   user = c(1,1,2,3), 
                   id = c(1,2,3,2), 
                   timestamp = c("2011-07-01 00:00:00","2011-07-01 00:00:00","2011-07-01 00:00:00","2011-07-01 00:00:00"))

ratings$timestamp = strptime(ratings$timestamp, "%Y-%m-%d %H:%M:%S")
stats$timestamp = strptime(stats$timestamp, "%Y-%m-%d %H:%M:%S")

for (i in(1:nrow(stats)))
{
   cat("Processing ",i," ...\r\n")
   temp = ratings[ratings$id == stats$id[i],]
   stats$idrating[i] = max(temp$rating[temp$timestamp < stats$timestamp[i]])
} 
```

有人可以为我提供替代方案吗？我知道 apply 可能有效，但我不知道如何翻译 for 函数。

更新：感谢您的帮助。我正在提供更多信息。

表 stats 具有 primeid、period、user、id 的独特组合。表 rating 有多个不同等级和时间戳的 id 记录。

我想做的是以下。对于在 stats 中找到的每个 id，查找评级表（id 列）中的所有记录，然后根据也从 stats 获得的特定时间戳获取最大评级。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-11T22:09:14.137

我喜欢`plyr`, 和 Hadley Wickham 创建的大多数工具，但我发现它可能会非常缓慢，尤其是当我试图在 ID 字段上进行拆分时。发生这种情况时，我转向`sqldf`. 我通常会得到 20 倍的加速。

首先我需要使用`lubridate`因为类型`sqldf`阻塞`POSIXlt`：

```
library(lubridate)
ratings$timestamp = ymd_hms(ratings$timestamp)
stats$timestamp = ymd_hms(stats$timestamp) 
```

像文森特一样合并数据框，并删除违反日期约束的数据框：

```
tmp <- merge(stats, ratings, by="id")
tmp <- subset(tmp, timestamp.y < timestamp.x ) 
```

最后，获取每个 ID 的最高评分：

```
library(sqldf)
sqldf("SELECT *, MAX(rating) AS rating FROM tmp GROUP BY id") 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-11T19:37:02.083

Depending on the ratio of `id`s to data points this may work better:

```
r = split(ratings, ratings$id)
stats$idrating = sapply(seq.int(nrow(stats)), function(i) {
  rd = r[[stats$id[i]]]
  if (length(rd))
    max(rd$rating[rd$timestamp < stats$timestamp[i]])
  else NA
}) 
```

If your IDs are *not* contiguous integers (you can check that with `all(names(r) == seq_along(r))`) you'll have to add `as.character()` when referencing `r[[` or use `match` once to create the mapping and it will cost you some speed.

Obviously, you can do the same without the split, but that's typically slower yet will use less memory:

```
stats$idrating = sapply(seq.int(nrow(stats)), function(i) {
  rd = ratings[ratings$id == stats$id[i],]
  if (nrow(rd))
    max(rd$rating[rd$timestamp < stats$timestamp[i]])
  else NA
}) 
```

You can also drop the `if` if you know there will be no mismatches.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-11T20:20:14.513

尽管我使用了另一种方法来获得相同的结果，但我对提供的答案进行了投票

在合并数据集中，我首先删除了早于条件日期的日期，然后运行：

```
aggregate (rating ~ id+primeid+period+user, data=new_stats, FUN = max) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-11T18:06:52.830

从数据结构的角度来看，您似乎想要合并两个表，然后执行 split-group-apply 方法。

您可以简单地合并两个表（很像 SQL 中的 JOIN 语句），然后执行“aaply”类型的方法，而不是使用 for 循环来检查哪一行属于哪一行。我建议您下载“plyr”库。

```
new_stats = merge(stats, ratings, by='id')

library(plyr) 
ddply(new_stats, 
      c('primeid', 'period', 'user'),  
      function(new_stats) 
      c( max(new_stats[as.Date(new_stats$timestamp.x) > as.Date(new_stats$timestamp.y)]$rating ))) 
```

如果 plyr 的使用让您感到困惑，请访问本教程：[http](http://www.creatapreneur.com/2013/01/split-group-apply/) ://www.creatapreneur.com/2013/01/split-group-apply/ 。

# ruby-on-rails - Heroku 和 ruby 中的后台上传

> ID：14283567
> 
> 赞同：2
> 
> 时间：2013-01-11T17:32:51.917
> 
> 标签：ruby-on-rails, heroku, backgroundworker, sidekiq

目前我有一个在后台（Sidekiq）任务中将图像上传到 S3 的应用程序。它工作得很好，但是我不得不“破解”一个解决方案，并且对任何知道更好的方法来做到这一点的人感到好奇。

问题：在 Heroku 上使用 Paperclip 和后台作业时，工作人员通常无法访问 tmp 文件，因为它是在不同的服务器上启动的。我试图让回形针使用 Heroku 上的 tmp 文件夹，并将其存储在那里，但是后台任务总是返回“找不到文件”。

临时解决方案：这导致必须将图像编码为 base64 字符串并将其传递给执行任务（恶心、糟糕、可怕、开销大）。

有没有更好的方法在 Heroku 上做到这一点？我不想将图像 blob 保存到数据库中，因为这也是一种不好的做法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T20:53:28.040

是否可以使用[Heroku S3 指南](https://devcenter.heroku.com/articles/s3)中的直接上传方法？如果需要，然后有一些后台工作来调整大小或处理？

# android - Android 覆盖在软件按钮之上

> ID：14283575
> 
> 赞同：4
> 
> 时间：2013-01-11T17:34:27.150
> 
> 标签：android, android-windowmanager

我正在尝试编写一个绘制自定义鼠标指针的应用程序。我目前有一个服务，它创建一个扩展 ViewGroup 的类，并使用 WindowManager 系统服务将其显示为带有 FLAG_LAYOUT_IN_SCREEN 集的 TYPE_SYSTEM_OVERLAY。

这几乎可以工作。在我的平板电脑（Samsung Galaxy Tab 7.7）和设置为平板电脑模式的模拟器中，它位于除底部状态栏（带有软主页、返回键和通知区域）之外的所有内容之上。在模拟器中，屏幕上没有软件按钮，但它位于通知栏的顶部。

我也尝试过以下解决方案：[ICS 中的 TYPE_SYSTEM_OVERLAY](https://stackoverflow.com/questions/9656185/type-system-overlay-in-ics/14149940#14149940)但我得到了相同的结果。

有没有办法真正在一切之上画画？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T15:18:07.900

我以前使用过系统覆盖来实现类似的效果，但很遗憾地告诉你这是不可能的。

您可以覆盖整个正常屏幕区域的顶部，如果通知栏没有与底部的系统栏合并（如某些平板电脑中的情况），则可以覆盖在通知栏上。除此之外，似乎不可能覆盖在系统栏软件按钮的顶部。

# django - Django - 如何在表单中自动生成 slug？

> ID：14283585
> 
> 赞同：0
> 
> 时间：2013-01-11T17:34:42.723
> 
> 标签：django, django-forms

*我通过CreateView*生成表单：

```
#urls.py
url(r'^add/$', ServerAdd.as_view(template_name="add.html")),

#views.py
from django.views.generic import CreateView
from servers.models import Server

class ServerAdd(CreateView):
model = Server
success_url = '/index/' 
```

[models.py 和 add.html](http://pastebin.com/9S8p3VaL)
一切正常，但在站点中我必须输入*slug*。现在的问题是：如何在管理面板中自动生成 slug？

我是新手，请提供分步说明

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-11-06T22:09:54.017

需要注意的是，上面的答案每次保存实例都会产生一个新的slug；这对于任何最终将被共享（例如作为 URI 的一部分）的东西都是不好的做法，因为任何带书签的 URI 都将失效。

更完整的答案是[如何在 Django 中创建 slug？](https://stackoverflow.com/questions/837828/how-do-i-create-a-slug-in-django).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T17:54:39.123

我喜欢使用这个[django 片段](http://djangosnippets.org/snippets/690/)为每个项目创建一个独特的 slug。这样，如果您有多个具有相同名称的项目，它将像`item-1`and一样递增`item-2`。将代码片段中的代码保存在名为`slug.py`. 在您的 models.py 中，导入 slug 文件。然后在定义模型类之后，使用以下方法覆盖该`save`方法`unique_slugify`：

```
from myapp.slug import unique_slugify

class Server(models.Model):
    name = models.Charfield(max_length=20)
    ....

    def save(self, **kwargs):
        slug = '%s' % (self.name)
        unique_slugify(self, slug)
        super(Server, self).save() 
```

`name`这将根据您的服务器模型的字段创建一个 slug 。要从不同的字段创建 slug，请将不同的值传递给`modulus (%)`操作员。

# perl - 使用 perl 命令搜索 bash 的循环语法

> ID：14283588
> 
> 赞同：0
> 
> 时间：2013-01-11T17:34:50.757
> 
> 标签：perl, bash, syntax

我有几个需要修改的 bash 脚本，我非常希望不手动进行...基本上，它们都包含该行

```
for ((i=${BEGIN} ; i < ${END} ; i++)) 
```

我需要将其更改为

```
for ((i=${BEGIN}-1 ; i < ${END} ; i++)) 
```

i=${BEGIN} 是唯一的，并且在每个文件中只出现一次，所以我想我可以使用简单的 perl 命令搜索和替换它。我想出的是

```
>  perl -w -i -p -e "s/i=\$\{BEGIN\}/i=\$\{BEGIN\}-1/" Script.sh 
```

这导致以下错误

```
syntax error at -e line 1, near "{BEGIN"
syntax error at -e line 1, near "}continue"
Execution of -e aborted due to compilation errors. 
```

这里的语法错误是什么？

谢谢！

萨基尔

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-11T17:38:13.560

使用撇号而不是双引号：

```
perl -w -i -p -e 's/i=\$\{BEGIN\}/i=\$\{BEGIN\}-1/' 
```

这样，shell 不会删除反斜杠，因此 perl 会看到它们并且它们会逃避应该逃避的内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-11T17:48:41.853

bash shell 在参数`"s/i=\$\{BEGIN\}/i=\$\{BEGIN\}-1/"`到达 Perl 之前对其执行插值。让我们看看它是如何工作的：

```
$ echo "s/i=\$\{BEGIN\}/i=\$\{BEGIN\}-1/"
s/i=$\{BEGIN\}/i=$\{BEGIN\}-1/ 
```

替换`s/i=$\{BEGIN\}/i=$\{BEGIN\}-1/`在 Perl 中将是一个问题，因为 Perl 会将序列`$\{`视为查找散列变量的开始`%\`，但它会编译失败，因为它找不到（未转义的）右大括号。所以你真正希望 Perl 看到的是

```
s/i=\$\{BEGIN\}/i=\$\{BEGIN\}-1/ 
```

至少有两种方法可以更改原始命令行来完成此操作：

1.  避开美元符号：

    `perl -wpi -e "s/i=\\\$\{BEGIN\}/i=\\\$\{BEGIN\}-1/"`

2.  首选单引号，它不会在 bash 中插入：

    `perl -wpi -e 's/i=\$\{BEGIN\}/i=\$\{BEGIN\}-1/'`

# mysql - 如何返回MYSQL中大于6个月的项目？

> ID：14283591
> 
> 赞同：5
> 
> 时间：2013-01-11T17:34:53.027
> 
> 标签：mysql, date, select

如何根据超过六个月的时间戳列返回MYSQL中的项目并删除它们？我希望能够删除表中大于六个月的项目，这样表就不会继续增长.. 确切的查询是什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-11T17:35:44.270

这是一个查询，用于根据时间戳列的值查找所有超过 6 个月的行：

```
select id
from your_table
where your_timestamp_column <= (now() - interval 6 month); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-11T17:46:08.847

试试这个：

使用**DATEDIFF**函数：

```
SELECT * FROM tableName  
WHERE DATEDIFF(CURDATE(), colName) > 180;

DELETE FROM tableName  
WHERE DATEDIFF(CURDATE(), colName) > 180; 
```

使用**DATE_SUB**函数：

```
SELECT * FROM tableName  
WHERE colName < DATE_SUB(CURDATE(), INTERVAL 6 MONTH);

DELETE FROM tableName  
WHERE colName < DATE_SUB(CURDATE(), INTERVAL 6 MONTH); 
```

# android - Fragment getActivity() 在 Activity JUnit 测试中返回 null

> ID：14283596
> 
> 赞同：5
> 
> 时间：2013-01-11T17:35:01.060
> 
> 标签：android, unit-testing, junit, android-fragments

我为实例化片段（实际上是选项卡）的 Activity 编写了 Android JUnit 测试。在测试期间，当我尝试对这些选项卡执行任何操作时，它们会崩溃，因为它们中的 getActivity() 方法返回 null。实际的应用程序（不是测试）永远不会显示这种行为，并且片段 getActivity() 总是在那里返回正确的父活动。我的测试用例如下所示：

```
public class SetupPanelTest extends ActivityUnitTestCase<MyAct> {

    FSetup s;   

    public SetupPanelTest() {
    super(MyAct.class);
    }

    protected void setUp() throws Exception {
        super.setUp();
        startActivity(new Intent(), null, null);
        final MyAct act = getActivity();

        AllTabs tabs = act.getTabs();
        String tabname = act.getResources().getString(R.string.configuration);

        // This method instantiates the activity as said below
        s = (FSetup) tabs.showTab(tabname);
        FragmentManager m = act.getFragmentManager();
        // m.beginTransaction().attach(s).commit(); 
        //     ... and even this does not help when commented out

        assertTrue(s instanceof FSetup);  // Ok     
        assertEquals(act, s.getActivity()); // Failure
    }

    public void testOnPause() {
        // this crashes because s.getActivity == null;
        s.onPause();
        }
 } 
```

AllTabs 以这种方式创建一个片段，然后是必需的：

```
 FragmentManager manager = getFragmentManager();
 Fragment fragment = manager.findFragmentByTag(tabname);
 if (fragment == null || fragment.getActivity() == null) {
      Log.v(TAG, "Instantiating ");
      fragment = new MyFragment();
      manager.beginTransaction().replace(R.id.setup_tab, fragment, tabname).commit();
 .... 
```

在这里，所有片段最初都是占位符，后来被实际片段替换：

```
<FrameLayout
  android:id="@+id/setup_tab"
  android:layout_width="fill_parent"
  android:layout_height="fill_parent" /> 
```

logcat 显示新片段已被实例化。在同一个布局中，还有前面提到的 AllTabs 片段似乎没有这个问题（否则它在哪里以及如何获取 FragmentManager）：

```
<TabWidget
     android:id="@android:id/alltabs"
... 
```

Most impressively, when I call attach directly on the fragment manager obtained on the right activity, this still has no effect. I tried to put five seconds delay (I have read that [transaction may be delayed](https://stackoverflow.com/questions/6215239/getactivity-returns-null-in-fragment-function)), I tried to call the rest of the test through runOnUiThread - nothing helps.

**The question** is that is need to do so to attach my fragments to the activity also during the test. I have fragment and I have activity, I cannot attach one to another.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-14T09:51:08.577

Even if you call `.commit()` on transaction, it is still not done, fragments are attached only lazily.

```
 FragmentManager m = activity.getFragmentManager();
    m.executePendingTransactions(); 
```

This finally attaches all fragments to the activity. Seems redundant when running the application itself but required in JUnit test case.

# javascript - javascript变量等于函数中的值

> ID：14283599
> 
> 赞同：0
> 
> 时间：2013-01-11T17:35:08.353
> 
> 标签：javascript, ajax

> **可能重复：**
> [如何返回 AJAX 响应文本？](https://stackoverflow.com/questions/1225667/how-to-return-ajax-response-text)
> [如何从函数的 AJAX 调用返回响应？](https://stackoverflow.com/questions/14220321/how-to-return-the-response-from-an-ajax-call-from-a-function)

所以我有一个 javascript 函数，我正在执行 AJAX 调用以查看用户是在线还是离线。它看起来像这样。

```
function onlineStatus(){

    $.ajax({
        url: "assets/ajax/online-offline.php",
        cache: false,
        success: function(html){
          return html;
        }
    }); 
} 
```

我想将此函数的值分配为我可以使用的变量。

像这样的东西。

```
var test = onlineStatus();

if (test == "true")
   alert("online");
else
   alert("offline"); 
```

这可能吗？我一定做错了什么，但不知道如何达到这个结果。谢谢

// 编辑：感谢大家的帮助，对不起，没有意识到这可能是一个重复的问题。我最初不确定要搜索什么，所以我没有看到任何相关内容。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-11T17:38:23.610

`$.ajax`是异步的，因此您无法从中返回任何内容`onlineStatus`，您需要向其传递一个回调函数，该回调函数可以在 ajax 调用完成时调用。

```
function onlineStatus(callback){

    $.ajax({
        url: "assets/ajax/online-offline.php",
        cache: false,
        success: callback
    }); 
}

onlineStatus(function(test) {
    if (test == "true")
       alert("online");
    else
       alert("offline");
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-11T17:38:34.193

由于调用是异步发生的，因此您必须将回调函数传递给`onlineStatus`. 就像是：

```
function onlineStatus(callback){

    $.ajax({
        url: "assets/ajax/online-offline.php",
        cache: false,
        success: function(html){
          callback(html);
        }
    }); 
} 
```

然后调用它：

```
onlineStatus(function (html)
   {
      // Do stuff with the status
   }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T17:37:48.863

AJAX 是*异步*的，这就是 A 的含义。你需要传递一个回调。

例如：

```
function onlineStatus(callback){

    $.ajax({
        url: "assets/ajax/online-offline.php",
        cache: false,
        success: callback
    }); 
}

onlineStatus(function(data) { 
    if (data == "true") { 
        alert "online"; 
    }
    else {
        alert "offline";
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-11T17:48:01.027

您可以简单地使用延迟对象。

```
function onlineStatus(){

    var request = $.ajax({
        url: "assets/ajax/online-offline.php",
        cache: false
    }); 

    return request;
}

var test = onlineStatus();
test.done(function(html) {
    if (html)
       alert("online");
    else
       alert("offline");
}); 
```

`$.ajax`返回 a `jqXHR`，因此您可以使用`.done`：

`jqXHR.done(function(data, textStatus, jqXHR) {});`

`An alternative construct to the success callback option, the .done() method replaces the deprecated`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-11T17:38:39.490

该`$.ajax`方法是异步的，因此您需要在回调中处理其返回值。

```
function onlineStatus(){

    $.ajax({
        url: "assets/ajax/online-offline.php",
        cache: false,
        success: function(html){
            if (html == "true")
                alert("online");
            else
                alert("offline");
        }
    }); 
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-11T17:39:30.757

你可以这样做......但这不是一个好方法，因为ajax的同步请求会使你的代码变慢......

```
function onlineStatus(){
var data;
    $.ajax({
        url: "assets/ajax/online-offline.php",
        cache: false,
        async:false,
        success: function(html){
           data = html;
        }
    }); 

return data;
} 
```

或者
，如果您只想显示警报框，那么...

```
function onlineStatus(){

    $.ajax({
        url: "assets/ajax/online-offline.php",
        cache: false,
        success: function(html){
           if (html== "true")
            alert("online");
            else
            alert("offline");
        }
    }); 

return data;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-11T17:47:48.267

jQuery ajax 调用是异步调用。您必须等待获得结果，然后才能使用它们显示警报。

```
 var isOnline = false;
    checkOnlineStatus();

    function checkOnlineStatus(){

        $.ajax({
            url: "assets/ajax/online-offline.php",
            cache: false,
            success: callback
            }
        }); 

    }
    function callback(html){
        isOnline = (html == "online");
        showAlert();
    }
    function showAlert(){
        if (isOnline == "true")
           alert("online");
        else
           alert("offline");
    } 
```

# c# - Resharper 7：在#Region 中按名称排序方法

> ID：14283600
> 
> 赞同：4
> 
> 时间：2013-01-11T17:35:15.497
> 
> 标签：c#, visual-studio, refactoring, resharper, region

我正在尝试按**名称对****#region**中的类中的方法进行**排序**，有没有办法？

 ****```
#Region ABCD
   public void XYZ(){}
   public void ABC(){}
#EndRegion 
```

变成：

```
#Region ABCD
   public void ABC(){}
   public void XYZ(){}
#EndRegion 
```

只有该区域中的那些（或者如果我必须，突出显示的文本）得到排序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T17:41:58.377

我不是 100% 确定，但有一个选项`ReSharper-->Tools-->Cleanup Code-->Reorder type members`

![在此处输入图像描述](../Images/5a65333f42ae217e3bea137063642bd9.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T17:39:25.847

尝试使用 CTRL-ALT-F 我认为，代码清理。它将为您提供 2 个默认配置文件，其中包括为您排序方法。您可以定义适合您需要的配置文件。****

# php - 注意：未定义变量：用户名、密码、dataAction

> ID：14283602
> 
> 赞同：-1
> 
> 时间：2013-01-11T17:35:25.097
> 
> 标签：php, indexing, undefined

我尝试了几种不同的方法，并查看了几个类似的问题，希望能正确处理我的页面。然而，我一直没有成功。我收到三个提示未定义变量的通知：

```
Notice: Undefined index: username
Notice: Undefined index: password
Notice: Undefined index: dataAction 
```

```
$usernameLabel = "Username:";
$usernameName = "username";
$usernameValue = $_POST[$usernameName];

$passwordLabel = "Password:";
$passwordName = "password";
$passwordValue = $_POST[$passwordName];

$submitName = "dataAction";
$submitValue = "Submit"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T17:40:18.677

您应该检查该值是否已设置

```
$usernameLabel = "Username:";
$usernameName = "username";

 //check if the $_POST array is populated and contain this key and there is a value associated to it
if(isset($_POST[$usernameName]))
{
   $usernameValue = $_POST[$usernameName];
} 
```

# python - 匹配变量时 Python re.findall 的问题

> ID：14283605
> 
> 赞同：-1
> 
> 时间：2013-01-11T17:35:26.347
> 
> 标签：python, regex, variables

我正在尝试匹配两个字符串变量，并希望捕获多个匹配项。re.findall 似乎是这项任务的明显选择，但它似乎并没有像我期望的那样工作。下面是一个例子：

```
a = 'a(pp)?le'
b = 'ale, apple, apol'
match = re.findall(a,b)
match
['','pp'] 
```

但是，当我将相同的变量应用于 re.search 时，它会识别字符串中嵌入的正则表达式，并选择第一个匹配项：

```
match = re.search(a,b)
match.group()
'ale' 
```

谁能解释为什么 re.findall 在这种情况下不起作用？我期望以下内容：

```
match = re.findall(a,b)
match
['ale','apple'] 
```

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-11T17:41:32.523

您正在使用捕获组，而您想要一个非捕获组：

```
a = 'a(?:pp)?le' 
```

如正则表达式中的[文档](http://docs.python.org/2/library/re.html#regular-expression-syntax) `(...)`所述，将创建一个“捕获组”，并且 re.findall 的结果将只是括号内的内容。

如果您只想对事物进行分组（例如，为了应用 a 的目的`?`），请使用`(?:...)`创建非捕获组。在这种情况下 re.findall 的结果将是整个正则表达式（或最大的捕获组）。

`re.findall`文档 的关键部分是：**如果模式中存在一个或多个组，则返回组列表，** 这解释了 re.findall 和 re.search 之间的结果差异。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T17:46:28.067

让我引用Python[文档](http://docs.python.org/2.7/library/re.html#re.findall)：`re.findall()`

> 返回字符串中模式的所有非重叠匹配，作为字符串列表。从左到右扫描字符串，并按找到的顺序返回匹配项。**如果模式中存在一个或多个组，则返回组列表；如果模式有多个组，这将是一个元组列表。空匹配包含在结果中，除非它们触及另一个匹配的开始。**

这就是你的表达`a(pp)?le`方式。它与您组中的内容相匹配，即`pp`. 您始终可以通过采用非捕获组来禁用组的这种特殊行为`(?:...)`。

# mongodb - 我在 mongodb 中缺少一个带有 morphia 的参考

> ID：14283606
> 
> 赞同：0
> 
> 时间：2013-01-11T17:35:27.970
> 
> 标签：mongodb, transactions, morphia

我有两个类，一个使用@Reference 引用另一个。插入时，我将首先插入引用的一个，然后插入带有引用字段的对象。当我在大部分时间取它们时，一切正常。但有时，我遇到了例外

> 严重：java.lang.RuntimeException：com.google.code.morphia.mapping.MappingException：无法为网络获取参考（{“$ref”：“UserContactLink”，“$id”：“50e92481cde5dadc12ff854b”}）。 shisoft.db.obj.UserContact.ucs

当我检查 id`UserContactLink`并且没有具有此 id 的此类文档时。我认为这是因为我上次终止了 mongod 的进度并且事务（在我看来）没有完成并且数据关系已损坏。似乎mongodb没有事务功能，我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T19:13:47.093

1.  没有交易。在许多情况下，您可以重组文档以避免出现问题（嵌入文档，...）

2.  您总是需要先插入引用的文档。插入后，MongoDB 服务器会创建实体的 ObjectId，然后在引用中使用该实体。您可能希望在引用之前检查 ID（简单检查 null）。

# sqlalchemy - 将 SqlAlchemy 连接查询结果作为数组（或类似的东西）

> ID：14283615
> 
> 赞同：0
> 
> 时间：2013-01-11T17:36:01.247
> 
> 标签：sqlalchemy

在我的查询中使用许多与左外连接相关的表，我想知道是否有任何方法可以轻松地将查询结果作为基本数组，例如在 phpmyadmin 中可以预期的类型（我不是指布局）。

给定 3 个表，所有表都被映射，我目前只将第一个表的结果作为对象，如果 table2 有任何结果，我必须逐行测试表 3 的结果，依此类推：

```
list_res_table1 = DBSession.query(table1).outerjoin(table2).outerjoin(table3).all()  
for res_table1 in list_res_table1:  
    if res_table1.relationship_to_table2:
        list_res_table2 = res_table1.relationship_to_table2
        for res_table2 in list_res_table2:  
            if res_table2.relationship_to_table3:
                etc. 
```

获得可直接访问的对象列表会很棒，例如：

```
((table1, table2, None)    #=> no result for table3  
(table1, None, None)      #=> no result for table2  
(table1, table2, table3))  #=> results for all tables 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-12T20:30:28.453

你可以（当然应该）直接这样查询：

```
list_res_table1 = DBSession.query(table1, table2, table3).outerjoin(table2).outerjoin(table3).all() 
```

加入将首先查看最左边的表格。如果您需要更多特异性，可以添加 select_from() 以及显式 ON 子句：

```
list_res_table1 = DBSession.query(table1, table2, table3).\
                      select_from(table1).\
                      outerjoin(table2, table2.c.id==table1.c.t2id).\
                      outerjoin(table3, table2.c.t3id==table3.c.id).all() 
```

# eclipse - 打开内部浏览器时抛出异常

> ID：14283618
> 
> 赞同：0
> 
> 时间：2013-01-11T17:36:16.610
> 
> 标签：eclipse, swt, jface

当我尝试使用打开内部网络浏览器时

```
IWorkbenchBrowserSupport browserSupport = PlatformUI.getWorkbench().getBrowserSupport(); 
```

我收到此错误：

```
Unable to instantiate browser supportStatus ERROR: 
org.eclipse.equinox.registry code=1 Plug-in "XXXXX" was unable to instantiate 
class "org.eclipse.ui.internal.browser.WorkbenchBrowserSupport". 
java.lang.IllegalAccessException: 
  Class org.eclipse.core.internal.registry.osgi.RegistryStrategyOSGI can not access a member of class org.eclipse.ui.internal.browser.WorkbenchBrowserSupport with modifiers "private" 
```

知道为什么我会收到此错误吗？搜索错误产生的提示很少。调试它表明，正如错误所说，私有方法是通过反射访问的。

# json - Serializing polymorphic collections with ServiceStack.Text

> ID：14283621
> 
> 赞同：4
> 
> 时间：2013-01-11T17:36:31.687
> 
> 标签：json, serialization, servicestack

We're in a process of switching from Json.NET to ServiceStack.Text and I came across an issue with serialization of polymorphic collections.

In JSON.NET I used to create a custom JsonCreationConverter and overriding the Create() method to select the type I want to create - as outlined here:

[http://dotnetbyexample.blogspot.co.uk/2012/02/json-deserialization-with-jsonnet-class.html](http://dotnetbyexample.blogspot.co.uk/2012/02/json-deserialization-with-jsonnet-class.html)

The collection in question is `List<ItemBase>` which can contain `FlightItem` or `CarHireItem` objects.

This is my version of the Create() method for JSON.NET:

```
protected override ItemBase Create(Type objectType, JObject jsonObject)
        {
            var itemType = jsonObject["Type"].ToString();
            switch (itemType)
            {
                case "flight":
                    return new FlightItem();
                case "carhire":
                    return new CarHireItem();
                default: 
                    return null;
            }
        } 
```

Is that possible with ServiceStack?

Serialization and deserialization in ServiceStack for polymorphic collections works, however, it appends the object type to the JSON output, e.g.

```
"__type" : "TestProject.Model.FlightItem, TestProject" 
```

This means that I need to supply the type when posting JSON and I'm not too keen on having the .NET type visible for anyone within the API calls.

Any suggestions? If it's possible to do this in a different way, can you point me to some examples?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-11T18:19:06.823

Firstly, [Interfaces or abstract types in DTOs are a bad idea](https://stackoverflow.com/a/10759250/85785).

You're now in the strange position where you're trying to support polymorphic types in DTOs, but don't want to provide JSON Serializer-specific info? The reason why you need bespoke code to support polymorphic DTO's is because it's impossible to tell what concrete type should be used based on the wire format, hence why ServiceStack emits the **__type** property for this purpose.

To avoid these hacks, and have it work equally well in all JSON Serializers, you're better off "flattening" your polymorphic types into a single "flat" DTO and send that across the wire instead. Once you're back in C# you can use code to project it into the ideal types.

ServiceStack does provide some `JsConfig<ItemBase>.RawDeserializeFn` that will let you do something similar, see the [CustomSerializerTests for an example](https://github.com/ServiceStack/ServiceStack.Text/blob/master/tests/ServiceStack.Text.Tests/JsonTests/CustomSerializerTests.cs#L83). There's also the `JsConfig<ItemBase>.OnDeserializedFn` hook that can potentially help, but it's dependent on whether `ItemBase` contains a complete property list of both concrete types.

# cuda - 哪个渲染引擎或游戏引擎用于模拟 CUDA 和 F# 后端

> ID：14283622
> 
> 赞同：3
> 
> 时间：2013-01-11T17:36:33.150
> 
> 标签：cuda, f#, gpu, game-engine, simulation

我正在组建一个模拟环境，以迎合多智能体/群机器人模拟。我将从头开始做的部分是数学库、物理引擎和 AI 引擎。这些将在 F#/CUDA 中实现。我正在寻找关于如何最好地实现其他一切的建议——即游戏引擎的所有其他部分。经过一开始的一些研究，OGRE 似乎是我最好的选择，但我仍然不确定。基本上，我想专注于物理/人工智能的东西，让一些游戏引擎为我做其他事情——渲染、场景图等。

我感到困惑的是我的 F#/CUDA 后端将如何与渲染引擎/游戏引擎交互。看起来流行的引擎已经设置好了，所以你可以很容易地用你自己的实现替换架构的一部分......哪一个最适合我使用？

由于我正在使用 CUDA 并将从 gpu 渲染结果，这将如何影响像 OGRE 这样的渲染引擎的实现？我知道我不能仅仅使用直接的 OpenGL 就被困住了......

目前，我正在研究 Ogre、Panda3D、jMonkey 和 Gazebo。从表面上看，Gazebo 似乎正是我想要的。

我也在考虑 Python 和 Lua，尽管我倾向于后者。

我希望这个“模拟环境”能够轻松转换为（或仅用作）真正的游戏引擎。我知道所有的元素几乎都已经存在了，我只是说以防万一它有助于给我建议。

另外，我*真的很*希望这个东西能够在本季度推出的支持 CUDA 的 Tegra 4s 上运行（最后我检查过）。这可能是也可能不是目前可以准确确定的东西，但是你们会比我更清楚......即如果我想要将来使用 tegra/android 的可能性，我应该在 jMonkey 中做所有事情吗？有关系吗？

...总的来说，我最感兴趣的是关于哪种架构配置可以与 F#/CUDA 物理和人工智能引擎一起工作的建议

# graph - 查找连接数大于平均数的节点

> ID：14283628
> 
> 赞同：1
> 
> 时间：2013-01-11T17:36:54.727
> 
> 标签：graph, neo4j, cypher

我试图在图中找到所有连接数高于平均水平的节点，例如：

```
START n=node(*) 
MATCH n-[r]-() 
WITH n, count(r) AS cnt
WITH n, cnt, avg(cnt) AS av 
WHERE cnt > av
RETURN n, cnt 
```

但这会返回 0 行 - 我相信这里的 'av' 等于 'cnt'。

我想知道从 cnt 创建一个集合以传递给 avg 是否会有所帮助，但这只会产生错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T05:53:41.577

只是插话。您也可以使用 WITH 在一个查询中执行此操作（即使使用 Werner 推荐的相同语法）。我还通过使用长度和模式来获取计数来作弊......有些人说这很丑陋，但它避免了需要使用聚合来简化这样的事情。

```
START n=node(*) 
WITH avg(length(n--())) as avgr 
START n=node(*) 
WHERE length(n--()) > avgr 
RETURN length(n--()) as rc, avgr, n; 
```

[http://console.neo4j.org/r/2sp1rt](http://console.neo4j.org/r/2sp1rt)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T20:25:53.543

您必须使用两个查询来执行此操作：

一个查询，获取平均连接数：

```
START n=node(*) 
MATCH n-[r]-() 
WITH n, count(r) as rc 
WITH avg(rc) as avg 
RETURN avg 
```

然后是一个查询，返回关系计数高于平均值的节点：

```
START n=node(*) 
MATCH n-[r]-() 
WITH n, count(r) as rc 
WITH avg(rc) as {avg_from_first_query} 
RETURN avg 
```

# java - 无法在java中获取服务器发送给客户端的数据

> ID：14283629
> 
> 赞同：0
> 
> 时间：2013-01-11T17:36:57.420
> 
> 标签：java, http, client, port

我用java编写了一个程序来检查浏览器发送到http服务器的内容。该程序注意到以下文本（命名它`TEXT_BROWSER`）

```
GET / HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:17.0) Gecko/20100101 Firefox/17.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive 
```

现在我制作了另一个程序，它将发送`"TEXT_BROWSER"`到任何网站（谷歌，我的路由器（192.168.1.1））但我没有得到响应（没有来自服务器的文本）我想知道我的程序中的错误是什么。

我的java程序

```
//1streqbybrowser.txt contains TEXT_BROWSER<br/>
import java.net.*;
import java.io.*;
class TCPClient 
{
 public static void main(String argv[]) throws Exception
 {
  String sentence;
  File f=new File("1streqbybrowser.txt");
  FileReader fr=new FileReader(f);
  BufferedReader br=new BufferedReader(fr);  
  Socket clientSocket = new Socket("192.168.1.1", 80);
  DataOutputStream outToServer = new DataOutputStream(clientSocket.getOutputStream());
  BufferedReader inFromServer = new BufferedReader(new InputStreamReader(clientSocket.getInputStream()));
  while((sentence = br.readLine())!=null)
   outToServer.writeBytes(sentence+"\n");
  System.out.println("Sending finished");
  while((sentence = inFromServer.readLine())!=null)
    System.out.println(sentence);
  clientSocket.close();
 }
} 
```

**编辑**

我将 TEXT_BROWSER 的第二行从`Host: localhost`to更改`Host: 192.168.1.10`为发送到我的路由器（192.168.1.1），仍然没有得到任何响应
**再次编辑**
我做了@andremoniy 提到的更改，但只有 TEXT_BROWSER 的 ast 行被发送到服务器并收到了一些东西，第二个循环没有结束

```
>GET / HTTP/1.1
< HTTP/1.1 400 Bad Request
< Content-Length: 0
< Server: RomPager/4.07 UPnP/1.0
< EXT:
< 
```

我注意到内部循环永远不会在这里结束。
现在可能是什么原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T18:07:55.930

在循环的一部分中修改您的程序，`while`如下所示：

```
 while ((sentence = br.readLine()) != null) {
        outToServer.writeBytes(sentence + "\r\n\r\n");
        outToServer.flush();
        System.out.println(">" + sentence);
        while ((sentence = inFromServer.readLine()) != null)
            System.out.println("< " + sentence);
    } 
```

你会看到结果。

你失败的主要原因是3件事：

1）你应该`\r\n`在每一行之后使用

2）我你必须`flush`在每一行之后写

3）在每行发送后读取服务器答案

# php - 如何查看 PHP 文件而无需将其上传到我的 ftp？

> ID：14283631
> 
> 赞同：0
> 
> 时间：2013-01-11T17:37:13.020
> 
> 标签：php

这可能是短视或完全错误的尴尬，但我已经制作了一个 header.php 和一个 footer.php 文件，然后是一个调用它们的 index.php 文件。有没有办法从我的桌面查看 index.php 文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T17:38:37.340

使用本地网络服务器堆栈，如[XAMPP](http://www.apachefriends.org/en/xampp.html)
这将允许您查看 PHP 页面，而无需将它们上传到您的服务器

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T17:38:44.640

在您的桌面上安装支持 PHP 的网络服务器。

阿帕奇是一个不错的选择。大多数操作系统都有可用的 Apache + PHP 捆绑包。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T17:39:39.823

您需要在桌面上安装 Web 服务器/PHP 堆栈。您可以查看 WAMP（适用于 Windows）或 MAMP（适用于 Mac）之类的东西来执行此操作。或者，如果您碰巧使用 Linux，只需在您的机器上直接安装 Apache 和 PHP。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-11T17:39:42.877

使用 Apache 服务器：

XAMPP - [http://www.apachefriends.org/en/xampp.html](http://www.apachefriends.org/en/xampp.html)

这将在您的计算机上安装 MySQL、PHPMYADMIN、Apache、PHP，因此您只需将文件上传到

> C:\xampp\htdocs\

并浏览到：

> 127.0.0.1 或本地主机

通过运行 Apache 服务的浏览器。

^ 假设您使用的是 Windows。

另一个假设，如果你在一个 linux 机器上（例如 Ubuntu）

[http://www.howtoforge.com/ubuntu_lamp_for_newbies](http://www.howtoforge.com/ubuntu_lamp_for_newbies)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-11T17:40:33.737

如果你在 windows 上使用[WAMP](http://www.wampserver.com/en/)如果你在 mac 上使用[MAMP](http://www.mamp.info/en/index.html)。对于 linux 使用[XAMPP](http://www.apachefriends.org/en/xampp.html) Plus 阅读此[Web 服务器的工作原理](http://www.howstuffworks.com/web-server.htm)

# css - CSS 下拉菜单在 FF 和 IE9 中很好，但在早期的 IE 版本中下降到右边

> ID：14283634
> 
> 赞同：0
> 
> 时间：2013-01-11T17:37:20.423
> 
> 标签：css, internet-explorer, drop-down-menu

之前似乎确实有人问过这个问题，有几个不同的答案，但似乎都不适合我。

我有一个在 FF、Chrome 和 IE9 中运行良好的 css 下拉菜单，但在早期版本的 IE 中，菜单显示在顶层的右侧，因此位于菜单的下一个项目下。请参见下图，左侧为 FF，右侧为 IE8。

显然我不允许发布图像，因此您必须对其进行图像处理。

CSS是：

```
#newmenu, #newmenu ul 
{ 
list-style: none; 
margin: 0; 
padding: 0 
}

#newmenu li 
{ 
float: left;
position: relative; 
white-space: nowrap 
}

#newmenu li a 
{ 
display: block; 
padding: 5px 20px; 
text-decoration: none; 
color: #13a 
}

#newmenu ul 
{ 
background: #fff; 
display: none; 
float: left;
position: absolute
}

#newmenu ul li 
{ 
background: #1c2659; 
float: none 
}

#newmenu ul ul 
{ 
top: -1px; 
left: 100%
}

#newmenu li.has_child 
{ 
background-image: url('img/down.gif'); 
background-position: right center; 
background-repeat: no-repeat; 
padding-right: 10px 
}

#newmenu li.hover  
{ 
background-color: #2b397b 
}} 
```

这里的 HTML：

```
 <ul id="newmenu" class="clear">

                <li><a href='index.html'><span class="menuText"><strong>Home</strong></span></a></li>
                <li><a href=''><span class="menuText"><strong>About Us &#9662;</strong></span></a>

                    <ul>

                        <li>&nbsp;</li>
                            <li><a href='profile.html'><span class="menuText">Profile</span></a></li>
                        <li><a href='people.html'><span class="menuText">People</span></a></li>
                            <li><a href='referencemap.html'><span class="menuText">Reference Map</span></a></li>
                            <li><a href='cpd.html'><span class="menuText">CPD</span></a></li>
                            <li><a href='inspiration.html'><span class="menuText">Inspiration Newsletter &#9656;</span></a>

                            <ul>

                                <li><a href='inspsubscribe.html'><span class="menuText">Subscribe</span></a></li>

                            </ul>

                        </li>                               
                        <li><a href='changingworld.html'><span class="menuText">Changing World Newsletter &#9656;</span></a>

                            <ul>

                                <li><a href='chansubscribe.html'><span class="menuText">Subscribe</span></a></li>

                            </ul>

                        </li>

                    </ul>

                </li>
                <li><a href=''><span class="menuText"><strong>Products &#9662;</strong></span></a>

                    <ul>

                            <li><a href='dalhem.html'><span class="menuText">Dalhem Panel </span></a></li>
                            <li><a href='geschwender.html'><span class="menuText">Geschwender &#9656;</span></a>

                            <ul>

                                <li><a href='locker.html'><span class="menuText">Lockers</span></a></li>
                                <li><a href='cubicle.html'><span class="menuText">Cubicles</span></a></li>
                                <li><a href='ductwall.html'><span class="menuText">Duct Walling</span></a></li>
                                <li><a href='vanity.html'><span class="menuText">Vanity Units</span></a></li>
                                <li><a href='accessories.html'><span class="menuText">Accessories</span></a></li>

                            </ul>

                        </li>
                            <li><a href='gustafs.html'><span class="menuText">Gustafs Panel System&#174;</span></a></li>
                            <li><a href=#><span class="menuText">Lighting &#9656;</span></a>

                            <ul>

                                <li><a href='architectural.html'><span class="menuText">Architectural</span></a></li>
                                <li><a href='event.html'><span class="menuText">Event</span></a></li>

                            </ul>

                        </li>
                            <li><a href='metra.html'><span class="menuText">Metra Electronic Locking</span></a></li>
                            <li><a href='nappychanger.html'><span class="menuText">Nappychanger </span></a></li>
                            <li><a href='oranit.html'><span class="menuText">Oranit</span></a></li>
                            <li><a href='texaa.html'><span class="menuText">Texaa Panels</span></a></li>
                        <li><a href='zsolnay.html'><span class="menuText">Zsolnay</span></a></li>

                    </ul>

                </li>
                <li><a href=''><span class="menuText"><strong>News &#9662;</strong></span></a>

                    <ul>

                        <li><a href='2012.html'><span class="menuText">2012</span></a></li>
                            <li><a href='2011.html'><span class="menuText">2011</span></a></li>
                            <li><a href='2010.html'><span class="menuText">2010</span></a></li>
                            <li><a href='2009.html'><span class="menuText">2009</span></a></li>

                    </ul>

                </li>
                <li><a href='contact.html'><span class="menuText"><strong>Contact Us</strong></span></a></li>

            </ul> 
```

任何想法都非常感激。谢谢莎拉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T17:50:19.713

```
#newmenu li.hover  
{ 
background-color: #2b397b 
}} 
```

在上面的行中，您有一个双右括号。我不确定这是否与它有关。

是`.hover`一个类还是你的意思是伪元素`:hover`？

# php - 使用 Eclipse PHP 手动功能使用 drupal .inc

> ID：14283652
> 
> 赞同：0
> 
> 时间：2013-01-11T17:38:34.983
> 
> 标签：php, eclipse, ide, eclipse-pdt

所以我注意到 Eclipse php 手动功能（shift + F2）仅在我正在处理的文件扩展名为 .php 时才有效

但后来我使用的是drupal，文件扩展名是.inc，即使它们仍然是PHP代码

有没有办法配置 eclipse 以使 PHP 手动功能也适用于 .inc？

当我进入手动设置页面时，扩展的唯一可能选择是 php、html 和 htm....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:46:46.880

您可以通过选择 Window -> Preferences 来编辑 eclipse 文件关联，然后在新对话框中导航到 General -> Content Types，在右侧展开“Text”内容类型并找到“PHP Content Type”。在那里，您可以添加“*.inc”文件关联，以便内置编辑器将`.inc`文件视为 PHP。

# javascript - 将 html 变量分配给 HTML 元素...不适合我

> ID：14283657
> 
> 赞同：1
> 
> 时间：2013-01-11T17:38:56.417
> 
> 标签：javascript

我有这个 javascript。我的表单中肯定有 2 个名为“附件”的输入标签：

```
<input name="attachments" type="hidden" value="test.doc">
<input name="attachments" type="hidden" value="test2.doc"> 
```

这是我的javascript。它说我的浏览器中未定义变量附件：

```
var attachments = document.getElementsByName('attachments');

var picCnt = 0;
var resumeCnt = 0;

if(document.getElementsByName('attachments').length >0){
    for(var i = 0; i <= attachments.length; i++){
        if(attachments[i].value.substring(attachments[i].value.length-4, attachments[i].value.length) == ".doc" ||
        attachments[i].value.substring(attachments[i].value.length-5, attachments[i].value.length) == ".docx" ||
        attachments[i].value.substring(attachments[i].value.length-4, attachments[i].value.length) == ".pdf" ){
            resumeCnt += 1;
        }
    }
} 
```

这是不正确的吗？蒂亚！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T17:49:57.883

以下行是`undefined`问题：

```
for(var i = 0; i <= attachments.length; i++){ 
```

它应该是：

```
for(var i = 0; i < attachments.length; i++){ 
```

最有可能的报告`attachments[attachments.length]`是`undefined`，因为它总是如此。

**只是一个建议**

我发现上面的内容很难阅读，使用单个变量比每次重复相同的数组访问要好得多。

```
var attachments = document.getElementsByName('attachments'),
    picCnt = 0;
    resumeCnt = 0;
    i, val
;

if(attachments.length >0){
    for(i = 0; i <= attachments.length; i++){
        val = attachments[i].value;
        if(val.substring(val.length-4, val.length) == ".doc" || 
           val.substring(val.length-5, val.length) == ".docx" ||
           val.substring(val.length-4, val.length) == ".pdf" ){
        resumeCnt += 1;
    }
} 
```

}

# python - 如何让 selenium 在 scraperwiki 上工作

> ID：14283661
> 
> 赞同：1
> 
> 时间：2013-01-11T17:39:05.620
> 
> 标签：python, parsing, selenium, urllib2, scraperwiki

我喜欢 selenium，也喜欢 scraperwiki，但不知怎的，我无法让它们一起正常工作。我尝试在 scraperwiki 上使用 selenium 以两种方式打开网站，这两种方法都是从教程中获得的：

```
import selenium
sel = selenium.selenium("localhost",4444,"*firefox", "http://www.google.com")   
sel.open("http://google.com") 
```

这不起作用。它给了我以下错误：

```
error: [Errno 111] Connection refused 
```

这也不是：

```
from selenium import webdriver 
browser = webdriver.Firefox() 
```

这给出了另一个错误：

```
/usr/lib/python2.7/subprocess.py:672 -- __init__((self=<subprocess.Popen object at 0x1d14410>, args=[None, '-silent'], bufsize=0, executable=None, stdin=None, stdout=-1, stderr=-1, preexec_fn=None, close_fds=False, shell=False, cwd=None, env=None, universal_newlines=False, startupinfo=None, creationflags=0))
AttributeError: 'NoneType' object has no attribute 'rfind' 
```

有人认为这是合乎逻辑的原因吗？

scraperwiki 上的文档表明，硒“只有在您有 Selenium 服务器指向时才在 ScraperWiki 中有用。” 我不知道他们对此的确切含义，但我认为这可能是问题的原因。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T14:56:12.973

Selenium 不仅仅是您正在使用的 Python 库，它还有一个单独的软件，即您问题中提到的 Selenium 服务器，它代表您的代码与浏览器交互。

这行代码

```
sel = selenium.selenium("localhost",4444,"*firefox", "http://www.google.com") 
```

正在尝试连接到 Selenium 服务器，以便它可以按照您的代码要求向浏览器 (Firefox) 发送命令。脚本上下文中的“localhost”是 ScraperWiki 的服务器之一，它没有运行 selenium 服务器。

您需要做的是下载[http://selenium.googlecode.com/files/selenium-server-standalone-2.28.0.jar](http://selenium.googlecode.com/files/selenium-server-standalone-2.28.0.jar)并将其安装在不同的服务器上，运行它

```
java -jar selenium-server-standalone-2.28.0.jar 
```

然后您可以更改您的代码以指向您正在运行它的服务器。它变得更加复杂，因为 ScraperWiki 限制了您可以连接到互联网的端口，因此您可能需要使用另一个端口（可能是端口 80）而不是使用端口 4444。

总而言之，我认为这可能不是一个可行的解决方案，你最好用 python、php 或 ruby​​ 编写你的爬虫。

# facebook-comments - 如何在 Facebook 评论审核中判断哪些页面正在被评论

> ID：14283663
> 
> 赞同：0
> 
> 时间：2013-01-11T17:39:13.963
> 
> 标签：facebook-comments, comments

我们已将 FB 评论整合到我们的网站中，可以在[http://developers.facebook.com/tools/comments的一个长列表中找到出现在各个页面上的完整评论列表](http://developers.facebook.com/tools/comments)

审核工作正常，但问题是评论并未表明他们发布在网站的哪个页面上。例如，有一个评论列表显示“很棒的文章”，但不清楚评论的是哪篇文章。是否可以在版主工具中查看每条评论所指的页面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T18:57:57.440

尝试在审核工具中单击帖子的日期/时间。它会将您带到发布评论的页面。

# mysql - 可以实现一个 has_and_belongs_to_many 关联

> ID：14283672
> 
> 赞同：0
> 
> 时间：2013-01-11T17:39:45.443
> 
> 标签：mysql, ruby-on-rails-3, has-and-belongs-to-many

我对 HABTM 与 rails 3.2.11 的关联有点困惑。

我有一个图像模型：

```
class Image < ActiveRecord::Base
  attr_accessible :description, :name, :image, :article_ids
  has_and_belongs_to_many :articles
end 
```

和文章模型：

```
class Article < ActiveRecord::Base
  has_and_belongs_to_many :images
  attr_accessible :content, :name, :image_ids
end 
```

我创建了一个迁移：

```
class CreateImagesArticlesTable < ActiveRecord::Migration
  def self.up
    create_table :images_articles, :id => false do |t|
        t.references :image
        t.references :article
    end
    add_index :images_articles, [:image_id, :article_id]
    add_index :images_articles, [:article_id, :image_id]
  end

  def self.down
    drop_table :images_articles
  end
end 
```

然后我做了 rake db:migrate

现在，当我更新图像时，我会显示复选框以连接文章和图像：

```
%div
  - @articles.each do |article|
    = check_box_tag "article_ids[]", article.id
    = article.name 
```

当我检查第一个复选框并更新它无法创建关联时，错误是：

图片控制器中的 ActiveRecord::StatementInvalid#update

Mysql2::Error: 表 'project_development.articles_images' 不存在：SELECT `articles`.* FROM `articles`INNER JOIN `articles_images`ON `articles`。`id`= `articles_images`。`article_id`在哪里`articles_images`。`image_id`= 78

参数是：

{"utf8"=>"✓", "_method"=>"put", "authenticity_token"=>"5qUu72d7asba09d7zbas7a9azsdas8a8dss", "image"=>{"name"=>"Test", "description"=>"Testdescription ", "article_ids"=>[]}, "article_ids"=>["1"], "commit"=>"更新图片", "id"=>"78-test"}

我在 MySQL Workbench 中看到了该表，但我无法查看它，因为它是：

错误：`project_development`。`images_articles`: 表数据不可编辑，因为没有为表定义主键

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T22:15:18.030

迁移是错误的，表名加入了两个模型名的复数，但是它们是按字母顺序排列的，即`articles_images`不是`images_articles`。

无论哪种方式，最好先有一个连接模型，然后再有一个`has_many`选项`:through`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T10:55:05.923

最后，我更改为将表迁移到articles_images 并将视图更正为：

```
- @articles.each do |article|
  = check_box_tag "image[article_ids][]", article.id, @image.articles.include?(article)
  = article.name 
```

这现在适用于 HABTM。

# python - Python：使用类输出错误

> ID：14283675
> 
> 赞同：-1
> 
> 时间：2013-01-11T17:39:50.473
> 
> 标签：python, class

我正在尝试用python制作一个非常简单的计算器。在只使用函数之前，我已经做了一个工作，但事实证明添加类很困难。

```
def askuser():
    global Question, x, y

    Question = input("""Enter a word: ("Add", "Subtract", "Multiply", "Divise")""")
    x = int(input("Enter first number: "))
    y = int(input("Enter second number: "))

class calculating:

    def __init__(self, x, y):
        self.x = x
        self.y = y

    def add(self):
        return self.x + self.y

    def subtract(self):
        return self.x - self.y

    def multiplication(self):
        return self.x * self.y

    def division(self):
        return self.x / self.y

math = calculating

def calc():

    if Question == "Add":
        t = math.add
        print(t)

    elif Question == "Subtract":
        t = math.subtract
        print(t)

    elif Question == "Multiply":
        t = math.multiplication
        print(t)

    elif Question == "Division":
        t = math.division
        print(t)

def final():
    input("Press any key to exit:" )

def main():

    askuser()
    calc()
    final()

main() 
```

代码运行良好，但它给了我一个“错误”而不是输出一个计算：

```
 Enter a word: ("Add", "Subtract", "Multiply", "Divise")Add

   Enter first number: 5

   Enter second number: 5

   function add at 0x02E4EC90

   Press any key to exit: 
```

为什么会这样？任何帮助都会很棒，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T17:41:30.993

您正在打印函数本身，而不是调用它的结果。尝试：

```
def calc():

if Question == "Add":
    t = math.add

elif Question == "Subtract":
    t = math.subtract

elif Question == "Multiply":
    t = math.multiplication

elif Question == "Division":
    t = math.division

print t() 
```

或者更干净但更高级：

```
class UserInputCalculator(object):

    operations = ["Add", "Subtract", "Multiply", "Divide"]

    def __init__(self):
        self.x = None
        self.y = None
        self.operation = None

    def run(self):
        self.prompt_for_operation()
        self.prompt_for_x()
        self.prompt_for_y()
        if self.operation == 'Add':
            return self.add()
        elif self.operation == 'Subtract':
            return self.subtract()
        elif self.operation == 'Multiply':
            return self.multiply()
        elif self.operation = 'Divide':
            return self.divide()
        else:
            raise ValueError('Unknown operation %s.' % operation)

    def prompt_for_operation(self):
        self.operation = input("Enter an operation: (%s)" % ', '.join(UserInputCalculator.operations))
        if self.operation not in UserInputCalculator.operations:
            raise ValueError('%s not a valid operation.' % self.operation)
        return self.operation

    def prompt_for_x(self):
        try:
            self.x = int(input("Enter first number: "))
        except:
            raise ValueError('Invalid value.')
        return self.x

    def prompt_for_y(self):
        try:
            self.y = int(input("Enter second number: "))
        except:
            raise ValueError('Invalid value.')
        return self.y

    def add(self):
        return self.x + self.y

    def subtract(self):
        return self.x - self.y

    def multiply(self):
        return self.x * self.y

    def divide(self):
        return self.x / self.y

calculator = UserInputCalculator()
print calculator.run()
input("Press any key to exit:" ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T17:43:00.257

该行：

```
t = math.multiplication 
```

将函数对象分配`math.multiplication`给 t，然后在下一行打印它。您需要添加`()`以使函数实际执行：

```
t = math.multiplication() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T18:13:38.957

其他两个答案是正确的，您实际上在这里所做的是打印函数本身，而不是调用它的结果。不过，我认为您应该重新考虑该程序的结构，并问自己为什么在这里使用类。一般来说，类应该是具有状态的东西，即与每个实例相关联的一个或多个变量。这需要实例化类；但是，您的代码不包含实例化（即使您定义了一个`__init__`函数）；该行`math = calculating`只是将变量`math`转换为对**类** 的**引用**`calculating`（**而不是****班上）。您使用的是全局变量而不是类变量，如果您以后想将此模块作为更大程序的一部分导入，这可能会出现问题（实际上，全局变量在大多数情况下通常不是一个好主意）。**

 **因此，我建议将函数视为接受一组特定变量并返回其他一组变量的东西，而不是这种结构。这**不是**考虑函数的唯一方法，但在这个简单的计算器示例中，它可能是最好的方法。

让我们从上往下看。您的`main`函数可能如下所示：

```
def main():
    (q,x,y) = askuser()
    ans = math[q](x,y)
    final(ans) 
```

请注意，我在这里所做的是将每个函数的结果传递给下一个函数。另请注意，我现在有不同的语法来使用`math`; 我将使用函数字典而不是函数类。

那么让我们看看如何实现`main`. 首先，`askuser`将与代码中的原始版本相同，但**不**包含`global`声明。

其次，`math`将是一个字典，定义如下：

```
def add(x,y):
    return x + y

def subtract(x,y):
    return x - y

def multiply(x,y):
    return x * y

def divide(x,y):
    return x / y

math = {"Add" : add,
        "Subtract" : subtract,
        "Multiply" : multiply,
        "Divide" : divide} 
```

最后，`final`应该实际打印答案：

```
def final(ans):
    print ans
    input("Press any key to exit:" ) 
```

这通常比您的解决方案干净得多。但是，如果您想学习如何很好地使用类，它对您没有多大帮助。所以想想你到底想要你的类的状态是什么，然后以这种方式实现你的代码。例如，您可以通过`calculator`这种方式添加一个类：

```
class calculator:
    def compute(x,y):
        print "No operation defined!"

    def __init__(self,operation):
        if operation in math:
            self.compute = math[operation]
        else:
            print "%s is not a valid operation!"%operation 
```

`main`然后看起来像这样：

```
def main():
    (q,x,y) = askuser()
    mycalc = calculator(q)
    ans = mycalc(x,y)
    final(ans) 
```**

# function - 创建 RPN 计算器

> ID：14283680
> 
> 赞同：2
> 
> 时间：2013-01-11T17:40:07.383
> 
> 标签：function, rpn

这是我的第二节编程课，所以请多多包涵。我有一个任务要求我创建一个带有函数的 RPN 计算器。这是我第一次学习函数，所以我仍然很困惑。

我的问题是：用户输入的运算符（+、-、*、/ 等）应该按照要求执行。但我正在考虑为每个运算符使用“If 语句”。我尝试了 "if (oper == '+') 但它不起作用。第二次，我尝试如下所示。失败！非法开始表达。令人沮丧！有人知道我如何开始吗？和更糟糕的是我不知道如何将运算符放入函数中。任何帮助将不胜感激！谢谢。

```
 String oper;
    double x, y;
    double sum;

    System.out.print("X: ");
    x = keyboard.nextDouble();

    System.out.print("Y: ");
    y = keyboard.nextDouble();

    System.out.print("Op: ");
    oper = keyboard.nextLine();

    if (oper.equals(+))
        System.out.print("add");
        System.out.println(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T21:47:41.347

`oper = keyboard.nextLine();`是不对的，因为`.nextLine`跳过下一行代码，所以你放 oper 的东西是空的。尝试：`oper = keyboard.next();`

对于 if 语句尝试：

```
if(oper.charAt(0)=='+'){
  //the functions and whatever else you need
}; 
```

# java - 对 hashmap 键进行空检查

> ID：14283684
> 
> 赞同：0
> 
> 时间：2013-01-11T17:40:20.787
> 
> 标签：java, nullpointerexception, hashmap

我有一个需要检查的场景`null`。我有一个名为`dT`：

```
String dT = (String) caseChk.get("dT"); 
```

这会抛出一个`NullPointerException`，因为该键本身不存在。如果我检查

```
if(caseChk.get("dT") != null) {
    // do something
} 
```

还有一个`NullPointerException`是因为`.get`. 如何测试`null`地图中的键何时不存在？我知道该`put`方法应该处理它，但这不在我的控制之下。]

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-11T17:41:32.340

> 即使现在我也得到了空指针，因为 .get 抛出异常

如果`caseChk.get("dT")`你只有一行并且确定它正在抛出异常，那么唯一的可能性`caseChk`可能是空的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T17:42:42.087

要确保密钥存在，您应该使用`HashMap#containsKey(key)`函数。一旦键存在，您就可以使用`HashMap#get(key)`它来获取值并将其与 null 进行比较。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T17:44:42.407

caseChk 可以为空试试这个

```
 String dT;
if(chaseChk!= null) 
dT= (String)caseChk.get("dT");` 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-17T15:35:53.293

尝试使用检查 null 的方法

public String checkNull_HashMap(Hashtable hashMap, String hashKey) {

```
 if (hashMap.get(hashKey) == null) {
        return "";
    } else {
        return hashMap.get(hashKey).toString();
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-12T05:44:15.680

最好的选择是在调用之前检查 null`toString()`

```
if ( hashMap.get(hashKey) != null ) { return hashMap.get(hashKey).toString(); } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-12T06:27:49.047

试试这个，这会奏效。

```
 if(!caseChk.isEmpty)
    {
      String dT = (caseChk.containsKey("dT")?(String)caseChk.get("dT"):" ")
    } 
```

# javascript - 将文本输入字符串中的日期转换为其他格式的javascript

> ID：14283691
> 
> 赞同：1
> 
> 时间：2013-01-11T17:40:35.717
> 
> 标签：javascript

我输入的日期是例如

```
var startDate = "January 16, 2013" 
```

从我试图深入研究的旧帖子中，我知道我可能需要使用[http://www.javascripttoolbox.com/lib/date/documentation.php中的 date.js](http://www.javascripttoolbox.com/lib/date/documentation.php)

所以我在我的 html 中有一个额外的行来启动它

```
<script src="http://prestigeswimming.com/wp-content/plugins/cred-frontend-editor/date.js" type="text/javascript"></script> 
<script type="text/javascript">
   var startDate = "January 16, 2013"
   alert(startDate.getMonthName());
</script> 
```

我应该这样做以获得一个提示框，上面写着“一月”吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T17:44:56.877

试试这个新版本的行：

```
var startDate = Date.parseString( "January 16, 2013"); 
```

为了使用该库，您必须使用 Date() 对象。

parseString 是该对象上的一个函数，它返回一个 Date 对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T19:32:26.470

如果您只处理美国语言环境日期并且需要将任意字符串输入解析为日期，您还可以查看[Sherlock.js](https://github.com/Tabule/Sherlock)以将字符串解析为 Date 对象。然后，要获取月份名称，只需在 Javascript 中操作：

```
var Sherlocked = Sherlock.parse('January 16');
var month = Sherlocked.startDate.getMonth();
var months = ["January","February","March","April","May","June","July","August","September","October","November","December"];
alert(months[month]); 
```

Sherlock.js 不会解析年份。如果您需要对此的支持，您可以使用 Sherlock 的预处理器系统自己解析这一年。

*披露：*我是 Sherlock.js 的创建者

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-11T17:50:04.700

无需使用库：

```
var startDate = "January 16, 2013";
var d = new Date(startDate);
var month = d.getMonth() + 1;
var day = d.getDate();
var year = d.getFullYear();

alert(month + "-" + day + "-" + year); 
```

[http://jsfiddle.net/mPBSf/](http://jsfiddle.net/mPBSf/)

以下会将您的日期格式转换为有效的 ECMAScript 日期格式：

```
var startDate = "ApRiL 16, 2013";
var noCommas = startDate.replace(/\,/g,'');
var withDashes = noCommas.replace(/ /g,"-");

function monthsToNumbers(date)
{
  var months = ["january","february","march","april","may","june","july","august","september","october","november","december"];
  var year;

  date = date.toLowerCase();

  for(var i = 0; i < months.length; i++)
  {
    if(date.indexOf(months[i]) != -1)
    {
      if(i+1 < 10)
        date = date.replace(months[i],"0" + (i+1));
      else
        date = date.replace(months[i],i+1);
    }
  }

  year = date.match(/\d{4}/);
  date = date.replace(year, "");
  date = year + "-" + date;
  date = date.substring(0,date.length-1);

  return date;
}

var d = new Date(monthsToNumbers(withDashes));
var month = d.getMonth() + 1;
var day = d.getDate();
var year = d.getFullYear();

alert(d); 
```

[http://jsfiddle.net/kWzSv/1/](http://jsfiddle.net/kWzSv/1/)

# c# - 如何在 12 个不同的按钮事件中使用相同的变量？

> ID：14283694
> 
> 赞同：0
> 
> 时间：2013-01-11T17:40:38.903
> 
> 标签：c#, visual-studio-2010

我正在尝试创建一个双变量“总计”以用于不同的按钮，但我不确定如何执行此操作。以下是我将在每个不同按钮中执行的操作：

```
private void btnItem2_Click(object sender, EventArgs e)
{
    lblItemPrice.Text = string.Format("£{0:0.00}", btnItem2.Tag);

    lstTill.Items.Add(btnItem2.Text + "\t" + (string.Format(btnItem2.Tag.ToString())));

    this.lstTill.TopIndex = this.lstTill.Items.Count - 1;

    total = total+ Convert.ToDouble(btnItem2.Tag);
    lblTotalPrice.Text = "£ " + Convert.ToString(lblItemPrice);
} 
```

我在哪里创建变量“total”以便它可以在不同的按钮中使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:41:58.817

在类级别而不是在事件级别创建总变量。

```
double total = 0; 

private void btnItem2_Click(object sender, EventArgs e)
    {

        lblItemPrice.Text = string.Format("£{0:0.00}", btnItem2.Tag);

        lstTill.Items.Add(btnItem2.Text + "\t" + (string.Format(btnItem2.Tag.ToString())));

        this.lstTill.TopIndex = this.lstTill.Items.Count - 1;

        total = total+ Convert.ToDouble(btnItem2.Tag);
        lblTotalPrice.Text = "£ " + Convert.ToString(lblItemPrice);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T17:42:14.207

你需要`total`成为一个[领域](http://msdn.microsoft.com/en-us/library/ms173118.aspx)。也就是说，在类内部声明，但在任何方法之外。

所以：

```
double total = 0.0; 
```

# templates - Laravel 刀片模板 - 标记顺序混乱

> ID：14283699
> 
> 赞同：1
> 
> 时间：2013-01-11T17:40:50.110
> 
> 标签：templates, laravel, blade

我目前正在开发一个项目的前端，现在我正在创建所有视图。我有一个模板，大致如下所示：

```
<!doctype html>
<html lang="en-GB">

<head>
  <!-- TITLE -->
 <title>@yield('title')</title>
 /*Fonts, meta, css and script references go here too*/
</head>

<body id=@yield('body-id')>

 <!-- HEADER -->
  @section('header')
    <header id="sticky-header">
      /*Logo and some other stuff*/
      @include('navigation')
    </header>
@yield_section

<!--CONTENT-->
<div id="content">
  @yield('content')
</div>

<!--FOOTER-->
<footer id="footer" role="contentinfo">
  @yield('footer')
  /*Copyright stuff*/
    </footer>
  </body>

</html> 
```

我的观点是这样的：

```
@layout('templates.main')

@section('title')
Graddle.se - Home
@endsection

@section('body-id')
"start-page"
@endsection

<header id="header">
 <div class="social-buttons-container">
  <ul class="social-buttons">
  <li>{{ HTML::image('img/facebook_logo.png', 'Facebook', array('class' => 'social-button')); }}</li>
  <li>{{ HTML::image('img/twitter_logo.png', 'Twitter', array('class' => 'social-button')); }}</li>
   </ul>
  </div>
  @include('navigation')
</header>

@section('content')
The website content goes here! 
@endsection

@section('footer')
Footer stuff!
@endsection 
```

请注意，我将在此页面上有两个标题。这是设计使然。所以我的问题是这样的：

我想插入一个来包裹整个身体来做一些 CSS 的东西。我将代码插入到模板中，它出现了，除了页脚之外，所有东西都被包装了。此外，当我在浏览器和 Chrome 检查器中检查源代码时，它会以奇怪的顺序显示：

如果我检查 chrome 检查器，标记的顺序如下：

```
<head>
</head>

<body id="start-page">
/*content from the <head> goes here*/

/*Webpage content goes here, sticky-header from the template etc*/

<footer>
Footer stuff
</footer>
</body>
</html> 
```

现在，如果我执行 ctrl-U 并检查源代码，标记显示如下：

```
<header id="header">
/*inserted by the view*/
</header>

<html>
<head>
/*Header stuff here, as it should be*/
</head>

<body id="start-page">

/*All the content*/

<footer>
Footer content
</footer>
</body>
</html> 
```

虽然页面看起来不错，但一切都在视觉上应该是。所以我的问题是：

*   如何插入 a 以将整个内容包装在正文中？就像我说的，我不能换页脚。

*   为什么标记的顺序如此混乱，并且在 chrome 检查器和源代码中显示不同？

我意识到这可能有点不清楚（我删除了中间的一些内容以使示例更清晰，以便更容易理解），请问我是不是！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T14:22:33.800

## 1.如何插入a以将整个内容包裹在body中？就像我说的，我不能换页脚。

我不太明白你说的页脚没有被包裹是什么意思。在您提供的代码中，`<footer>`标签位于`<body>`标签内。

## 2\. 为什么标记的顺序如此混乱？

这是因为在您的视图文件中，您没有将`<header>`标签包装在任何部分中。根据您的视觉需求，您应该将其包装在其中一个`header`或部分内：`content`

```
@section('header')
    @parent <!-- keep what's in the inherited layout file -->

    <header id="header">
        <div class="social-buttons-container">
            <!-- ... -->
        </div>
        @include('navigation')
    </header>
@endsection 
```

## 3\. 在 chrome 检查器和源代码中显示不同？

检查器正在精美地格式化和组织 HTML，因此开发人员可以减少对混乱源代码的担忧。根据[谷歌](https://developers.google.com/chrome-developer-tools/docs/elements)：

> 元素面板有时是“查看页面源代码”的更好方法。在 Elements 面板中，页面的 DOM 将被很好地格式化，轻松地向您展示 HTML 元素、它们的祖先和后代。很多时候，您访问的页面会缩小或只是丑陋的 HTML，这使得很难看到页面的结构。元素面板是您查看页面真实底层结构的解决方案。

# spring - Postgres v. HSQL ConstrainViolationException Wrapping in Spring

> ID：14283700
> 
> 赞同：4
> 
> 时间：2013-01-11T17:40:50.147
> 
> 标签：spring, hibernate, jpa, hsqldb

我想了解一个奇怪的行为差异。我在实体类中有 Bean Validation 注释。我还有一些代码可以捕获它们，并将它们格式化为 REST 接口的 JSON 格式——但我认为这不会影响任何事情。我正在使用 Spring 和 JPA Hibernate。

当我将 HSQL 设置为我的数据库驱动程序时，我可以在 EntityManager #persist 调用之后直接捕获 ConstrainViolationException。但是，当我将 JDBC 驱动程序切换到 Postgres 时，#persist 将引发由 RollbackException 引起的 TransactionSystemException，然后最终在 RollbackException 中我可以得到 ConstraintViolationException。代码相同，我只切换驱动程序。#persist 方法是@Transactional。

现在我想我可以通过为 TransactionSystemExeption 添加一个 catch 并获得两次原因来处理 ConstraintViolationException 来解决这个问题，但对我来说似乎很奇怪，我需要两个 catch 子句用于相同的代码，仅取决于驱动程序配置。有什么想法或解释吗？

设置很简单。在某些字段上具有 @NotNull bean 约束的任何 JPA 实体。然后将其保存在事务性方法中。使用 HSQL 你会得到这样的异常：

```
javax.validation.ConstraintViolationException: Validation failed for classes [MyEntity] during persist time for groups [javax.validation.groups.Default, ]
List of constraint violations:[
    ConstraintViolationImpl{interpolatedMessage='not a well-formed email address', propertyPath=emailAddress, rootBeanClass=class ..., messageTemplate='{org.hibernate.validator.constraints.Email.message}'}
    ConstraintViolationImpl{interpolatedMessage='may not be null', propertyPath=password, rootBeanClass=class ..., messageTemplate='{javax.validation.constraints.NotNull.message}'}
]
    at org.hibernate.cfg.beanvalidation.BeanValidationEventListener.validate(BeanValidationEventListener.java:161)
    at org.hibernate.cfg.beanvalidation.BeanValidationEventListener.onPreInsert(BeanValidationEventListener.java:94)
    at org.hibernate.action.EntityIdentityInsertAction.preInsert(EntityIdentityInsertAction.java:160)
    at org.hibernate.action.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:65)
    at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:273)
    at org.hibernate.event.def.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:320)
    at org.hibernate.event.def.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:203)
    at org.hibernate.event.def.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:129)
    at org.hibernate.ejb.event.EJB3PersistEventListener.saveWithGeneratedId(EJB3PersistEventListener.java:69)
    at org.hibernate.event.def.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:179)
    at org.hibernate.event.def.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:135)
    at org.hibernate.event.def.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:61)
    at org.hibernate.impl.SessionImpl.firePersist(SessionImpl.java:808)
    at org.hibernate.impl.SessionImpl.persist(SessionImpl.java:782)
    at org.hibernate.impl.SessionImpl.persist(SessionImpl.java:786)
    at org.hibernate.ejb.AbstractEntityManagerImpl.persist(AbstractEntityManagerImpl.java:837)
    at sun.reflect.GeneratedMethodAccessor21.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:240)
    at $Proxy49.persist(Unknown Source) 
```

在使用 PostgreSQL 时，你会得到这个异常。不要更改任何代码，只需将驱动程序和方言更改为 PostgreSQL 并捕获异常即可。

```
 org.springframework.transaction.TransactionSystemException: Could not commit JPA transaction; nested exception is javax.persistence.RollbackException: Error while committing the transaction
    at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:521)
    at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:754)
    at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:723)
    at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:393)
    at org.springframework.transaction.aspectj.AbstractTransactionAspect.ajc$afterReturning$org_springframework_transaction_aspectj_AbstractTransactionAspect$3$2a73e96c(AbstractTransactionAspect.aj:78)
    at EntityService.persist(EntityService.java:82)
    ...
Caused by: javax.persistence.RollbackException: Error while committing the transaction
    at org.hibernate.ejb.TransactionImpl.commit(TransactionImpl.java:93)
    at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:512)
    ... 47 more
Caused by: javax.validation.ConstraintViolationException: Validation failed for classes [MyEntity] during persist time for groups [javax.validation.groups.Default, ]
List of constraint violations:[
    ConstraintViolationImpl{interpolatedMessage='not a well-formed email address', propertyPath=emailAddress, rootBeanClass=class MyEntity, messageTemplate='{org.hibernate.validator.constraints.Email.message}'}
    ConstraintViolationImpl{interpolatedMessage='may not be null', propertyPath=password, rootBeanClass=class MyEntity, messageTemplate='{javax.validation.constraints.NotNull.message}'}
]
    at org.hibernate.cfg.beanvalidation.BeanValidationEventListener.validate(BeanValidationEventListener.java:161)
    at org.hibernate.cfg.beanvalidation.BeanValidationEventListener.onPreInsert(BeanValidationEventListener.java:94)
    at org.hibernate.action.EntityInsertAction.preInsert(EntityInsertAction.java:178)
    at org.hibernate.action.EntityInsertAction.execute(EntityInsertAction.java:72)
    at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:273)
    at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:265)
    at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:184)
    at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:321)
    at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:51)
    at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1216)
    at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:383)
    at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:133)
    at org.hibernate.ejb.TransactionImpl.commit(TransactionImpl.java:76)
    ... 48 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T04:08:00.103

不幸的是，hibernate 不以与驱动程序无关的方式处理验证。因此，您必须根据数据库以不同方式捕获这些异常。不要假设您可以以独立于数据库的方式编写实体异常和验证处理代码。

# apache - 设置不记录/存储 IP 地址的 LAMP 服务器？

> ID：14283701
> 
> 赞同：1
> 
> 时间：2013-01-11T17:40:50.880
> 
> 标签：apache, ubuntu, lamp, privacy

需要对基本的 Ubuntu LAMP 安装进行哪些配置以防止它记录访问者的 IP 地址？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T17:55:34.070

在 apache 配置中查找 CustomLog 指令：

```
fgrep -wir CustomLog /etc/apache2/ 
```

你会发现这样的东西：

```
CustomLog /var/log/apache2/access.log combined
CustomLog /var/log/apache2/other_vhosts_access.log vhost_combined 
```

寻找第三部分，`combined`是s`vhost_combined`的昵称`LogFormat`。它们在内部`/etc/apache2/apache2.conf`使用[LogFormat](http://httpd.apache.org/docs/2.2/mod/mod_log_config.html#logformat)指令定义，包含几个[Format Strings](http://httpd.apache.org/docs/2.2/mod/mod_log_config.html#formats)。

寻找

```
%a  Remote IP-address
%h  Remote host 
```

并将它们从您的`LogFormat`指令中删除。替换它们可能更聪明，`0.0.0.0`因此日志文件处理仍然可以进行。

前：

```
LogFormat "%h %l %u %t \"%r\" %>s %O \"%{Referer}i\" \"%{User-Agent}i\"" combined 
```

后：

```
LogFormat "0.0.0.0 %l %u %t \"%r\" %>s %O \"%{Referer}i\" \"%{User-Agent}i\"" combined 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T17:57:23.567

[http://httpd.apache.org/docs/2.2/mod/mod_log_config.html](http://httpd.apache.org/docs/2.2/mod/mod_log_config.html)

```
Syntax:     LogFormat format|nickname [nickname]
Default:    LogFormat "%h %l %u %t \"%r\" %>s %b" 
```

不要使用 %h 或 %a

# c++ - 什么时候最好使用 std::promise 而不是其他 std::thread 机制？

> ID：14283703
> 
> 赞同：24
> 
> 时间：2013-01-11T17:40:57.137
> 
> 标签：c++, c++11, stdthread

我正在尝试建立一些启发式方法来帮助我决定`std::thread`要使用的适当类。

据我了解，从最高级别（使用最简单，但最不灵活）到最低级别，我们有：

1.  std::async with/std::future (std::shared_future) （当你想在一次性的生产者线程异步上执行时）
2.  std::packaged_task （当您想分配生产者，但将调用推迟到线程时）
3.  std::promise (???)

我想我对**何时使用**前两个有一个不错的把握，但我仍然不清楚`std::promise`.

`std::future`与`std::async`调用一起，有效地将产生回调/仿函数/lambda 转换为异步调用（根据定义，它立即返回）。单个消费者可以调用`std::future::get()`阻塞调用来获取结果。

`std::shared_future`只是一个允许多个消费者的版本。

如果您想将`std::future`值与生产者回调绑定，**但希望将实际调用推迟到以后（当您将任务与生成线程相关联时）**，`std::packaged_task`这是正确的选择。但是现在，由于对应`std::future`的`std::package_task`可以，在一般情况下，可以被多线程访问，我们可能不得不小心使用 a `std::mutex`。请注意`std::async`，在第一种情况下，我们不必担心锁定。

阅读[了一些关于 promise 的有趣链接后](https://stackoverflow.com/a/12335206/975129)，我想我了解它的机制以及如何设置它们，但我的问题是，**你什么时候会选择使用 Promise 而不是其他三个？**

*我正在寻找更多应用程序级别的答案，例如经验法则（在上面的 3\. 中填写 ???），而不是链接中的答案（例如，使用 std::promise 来实现一些库机制），因此我可以更轻松地向`std::thread`.*

换句话说，如果有一个有用的例子来说明我可以用其他机制做不到的事情**，**`std::promise`那就太好了。

 ****回答**

A`std::future`是一个奇怪的野兽：一般来说，你不能直接修改它的值。

三个可以修改其值的生产者是：

1.  `std::async`通过异步回调，它将返回一个`std::future`实例。
2.  `std::packaged_task`，当传递给线程时，将调用其回调，从而更新`std::future`与该 关联的实例`std::packaged_task`。这种机制允许生产者的早期绑定，但稍后调用。
3.  `std::promise`，它允许一个人`std::future`通过它的`set_value()`调用来修改它的关联。通过这种对变异 a 的直接控制`std::future`，如果有多个生产者（根据需要使用），我们必须确保设计是线程安全的`std::mutex`。

我认为[塞思卡内基的回答是](https://stackoverflow.com/a/14283834/975129)：

> 一种简单的思考方式是，您可以通过返回值或使用承诺来设置未来。future 没有设置方法；该功能由 promise 提供。

有助于阐明何时使用 Promise。但是我们必须记住，a`std::mutex`可能是必要的，因为根据使用情况，promise 可能可以从不同的线程访问。

此外，[大卫的罗德里格斯的回答](https://stackoverflow.com/a/11004368/975129)也很出色：

> 通信通道的消费者端将使用 std::future 来使用来自共享状态的数据，而生产者线程将使用 std::promise 来写入共享状态。

但作为替代方案，为什么不简单地`std::mutex`在 stl 结果容器上使用 a ，并使用一个线程或生产者线程池对容器进行操作？除了一些额外的可读性与 stl 结果容器之外，使用`std::promise`，相反，给我买了什么？

版本中的控制似乎更好`std::promise`：

1.  wait() 将阻塞给定的未来，直到产生结果
2.  如果只有一个生产者线程，则不需要互斥锁

*以下 google-test 通过了 helgrind 和 drd，确认使用单个生产者并使用 wait()，不需要互斥锁。*

**测试**

```
static unsigned MapFunc( std::string const& str ) 
{ 
    if ( str=="one" ) return 1u; 
    if ( str=="two" ) return 2u; 
    return 0u;
}

TEST( Test_future, Try_promise )
{
    typedef std::map<std::string,std::promise<unsigned>>  MAP; 
    MAP          my_map;

    std::future<unsigned> f1 = my_map["one"].get_future();
    std::future<unsigned> f2 = my_map["two"].get_future();

    std::thread{ 
        [ ]( MAP& m )
        { 
            m["one"].set_value( MapFunc( "one" ));
            m["two"].set_value( MapFunc( "two" ));
        }, 
      std::ref( my_map ) 
    }.detach();

    f1.wait();
    f2.wait();

    EXPECT_EQ( 1u, f1.get() );
    EXPECT_EQ( 2u, f2.get() );
} 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-01-11T17:48:59.123

您不选择使用 a`promise` *代替*其他人，而是使用 a*与*`promise`其他人一起*完成*a 。[cppreference.com](http://en.cppreference.com/w/cpp/thread/future)上的代码示例给出了使用所有四个的示例：`future`

 *```
#include <iostream>
#include <future>
#include <thread>

int main()
{
    // future from a packaged_task
    std::packaged_task<int()> task([](){ return 7; }); // wrap the function
    std::future<int> f1 = task.get_future();  // get a future
    std::thread(std::move(task)).detach(); // launch on a thread

    // future from an async()
    std::future<int> f2 = std::async(std::launch::async, [](){ return 8; });

    // future from a promise
    std::promise<int> p;
    std::future<int> f3 = p.get_future();
    std::thread( [](std::promise<int>& p){ p.set_value(9); }, 
                 std::ref(p) ).detach();

    std::cout << "Waiting...";
    f1.wait();
    f2.wait();
    f3.wait();
    std::cout << "Done!\nResults are: "
              << f1.get() << ' ' << f2.get() << ' ' << f3.get() << '\n';
} 
```

印刷

> 等待...完成！
> 
> 结果是：7 8 9

Futures 与所有三个线程一起使用以获取它们的结果，并且 a`promise`与第三个线程一起使用以`future`通过返回值以外的方式实现 a。此外，单个线程可以通过 s 实现多个`future`具有不同值`promise`的 s，否则它无法做到。

一个简单的想法是，您可以`future`通过返回值或使用 a 来设置 a `promise`。`future`没有`set`方法；该功能由`promise`. 您根据情况允许选择所需的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T17:57:11.090

当您有两个级别的异步时，您需要使用 Promise。例如：

```
void fun()
{
std::promise<int> p;
std::future<int> f = p.get_future();
std::future<void> f2;
auto f3 = std::async([&]{
   // Do some other computation
   f2 = std::async([&]{ p.set_value(42);});
   // Do some other work
});
   // Do some other work
   // Now wait for the result of async work;
std::cout << f.get();
   // Do some other work again 
// Wait for async threads to complete
f3.wait();
f2.wait();
} 
```***

# mysql - Mysql：选择日期之间的范围并向范围添加额外的行（不是天）

> ID：14283706
> 
> 赞同：-1
> 
> 时间：2013-01-11T17:41:10.927
> 
> 标签：mysql

我有一个包含日期和价格的表格，我正在尝试选择两个日期之间的范围，但我还想在结束日期之后添加 n 个额外的行。

这是一个数据样本：

```
2013-01-09 29.67,
2013-01-08 29.51,
2013-01-07 28.69,
2013-01-04 28.01,
2013-01-03 27.88,
2013-01-02 27.44,
2012-12-31 26.20,

```

例如我在做：

```
SELECT * 
FROM $table_name 
WHERE date between '2013-01-09' AND '2013-01-04' 
ORDER BY date DESC 
```

我想要做的是额外添加 3 行（不是天，因为你可以看到它们不是连续的）所以像 2013-01-04 加上 3 行到 2012-12-31 结束。

我希望我很清楚，因为即使只是解释问题也很困难，想象一下尝试在网上找到解决方案！

* * *

按要求更新。

所以我会尝试改写和简化我遇到的问题。忘掉我到目前为止写的所有东西，从一个新的观点开始。我将把我遇到的问题分成两个步骤。此外，我将使用更简单的数字作为示例。新数据表：

```
2013-01-09 7
2013-01-08 1
2013-01-07 9
2013-01-04 1
2013-01-03 8
2013-01-02 5
2012-31-12 6

```

我想计算给定*日期范围内*这些值的平均值。因此，如果数据范围是 2013-01-09 到 2013-01-03 并且周期 2 的平均值，则数据将如下所示：

```
2013-01-09 7 4
2013-01-08 1 5
2013-01-07 9 5
2013-01-04 1 4.5
2013-01-03 8 6.5
2013-01-02 5 不适用

```

为此，我没有问题。问题就出现在这里。请注意，对于范围的第一个日期，我无法计算周期 2 的平均值，因为我之前没有数据选择。所以问题是，我如何在日期范围之后选择 1 个额外点（特别是 2012-31-12 的数据），以便我也可以计算 2013-01-02 的平均值？

谢谢你们的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T18:25:08.417

如果您在数据库端执行此操作，则可以创建一个日期表。然后，您将获取您想要的范围并在日期加入价格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T10:53:13.480

更新问题，因为从评论看来我真的一点都不清楚。

这不是 html 或任何奇怪的东西。我正在编写一个 php 脚本，对价格列进行一些数学计算。

对于这个计算，我需要得到 n 天并根据日期范围取平均值。

但是，问题是我需要在日期范围之外再选择几天。例如，如果我的范围是从 2013-01-04 到 2013-01-09，我还需要添加 3 个额外的数据点，在这种情况下将我带到 2013-12-31。

问题是，在 MySql 中，我如何选择日期范围加上超出该范围的 n 行数。不幸的是，我没有 ID 列。希望这更清楚。

# c# - 动态添加项目

> ID：14283708
> 
> 赞同：0
> 
> 时间：2013-01-11T17:41:26.993
> 
> 标签：c#, asp.net-mvc-4, textbox, listbox, postback

我正在尝试将只是字符串的项目动态添加`textbox`到`listbox`控件中。

这些字符串应该可以添加但也可以删除。所以这就是我想出`listbox`控制的原因。所以我需要一个`textbox`添加`button`和`listbox`控制。

按下提交按钮时，`listbox`应将其中的所有内容发布到控制器中的操作。

如何做到这一点`mvc 4`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T18:25:21.093

使用 jQuery 覆盖提交的默认处理并使用 .ajax 将列表框项发布到您的操作。

# c - 使用类型双关语和填充位检测字节顺序

> ID：14283716
> 
> 赞同：4
> 
> 时间：2013-01-11T17:41:41.897
> 
> 标签：c, padding, endianness

这是用于在运行时检测字节序的常用技巧，例如在[C FAQ](http://c-faq.com/misc/endiantest.html)中可以看到：

```
int x = 1;

if (*(char *)&x == 1)
{
  /* little-endian */
}
else
{
  /* big-endian */
} 
```

根据我对标准的阅读，它不会导致未定义的行为，因为它不会违反严格的别名规则。

无论如何，只要整数类型除了`unsigned char`可以包含填充位（例如`x`），`*(char *)x == 1`即使它是一个小端系统，条件也不会出错吗？

在这种情况下，工会的解决方案是否更适合这样做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T18:00:26.100

当你有填充位时，我不确定字节序是否真的有意义，但否则你是对的，条件可能是错误的。至少您没有调用未定义的行为，因为字符类型没有陷阱表示。

否则，您可以做的是使用精确宽度的整数类型（例如`uint32_t`等）。尽管这些类型是可选的，但它们保证没有填充位。

有关信息，请注意`signed char`也不能有填充位。

# sql - 在 memcacheD 中缓存 id+username 在集群上失败。网卡数据过多

> ID：14283720
> 
> 赞同：0
> 
> 时间：2013-01-11T17:41:58.813
> 
> 标签：sql, caching, memcached

我正在寻找更好的解决方案。

我有一个拥有 200.000 多个用户和大量 SQL 查询的社区。它们中的大多数在其结果中都包含一个用户 ID。在大多数情况下，我需要在输出中使用相关的用户名来解决。

[userId - username] 是一个单独的表。为了避免对这个表进行大量的连接，我决定将洞表作为一个数组缓存在 memcacheD 中。这在开始时工作得很好。SQL 服务器负载下降了很多。一切都比以前运行得更快。

但是，几周后，hole server-cluster (5 webserver) 出现了问题。缓存的用户 ID 用户名数据集变得巨大。以至于我在网络接口达到了内部 1000Mbit 数据限制，而 memcacheD 正在将记录发送到请求服务器。我试图序列化数据，但它并没有改变战利品。

我现在看到三种方法：

1) 强制 memcacheD 缓存每台服务器上的记录。所以集群不需要向其他服务器请求缓存。但是数据集的每一次更改都需要在每台服务器上同时完成。- 无论如何，我不知道这是否可能。

2) 切换回 JOINS 并使用 cacheexecute。

3）你有一个更好的解决方案！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T17:53:38.677

似乎您正在以不打算使用的方式使用缓存。Memcached 最适合用作键值存储，而不是存储单个大数据元素的地方。我真的会考虑您是否真的需要在每个单独的调用中使用整个数组，或者您是否重新构建数据访问模式以简单地检索满足您的请求所需的数据。换句话说，如果您有用户名（例如登录名）并且需要获取用户 ID，只需对该用户名进行密钥查找以仅获取所需的用户 ID。

然而，在这种情况下，我真的不明白你在 Memcached 中拥有用户 ID/用户名数据会获得什么。您是否遇到过重复命中相同用户 ID 的情况，从而真正最大限度地利用缓存中的数据？您是否不担心将这些数据存储在内存中而不是在某种数据持久层中存储在磁盘上的波动性？

我想我真的需要更多地了解您的用例以提供更具体的建议，但是尝试存储和检索整个数据数组似乎很奇怪。

# c# - 无法在 DataContext 之后索引列

> ID：14283723
> 
> 赞同：1
> 
> 时间：2013-01-11T17:42:12.350
> 
> 标签：c#, wpf, datagrid

将我的数据加载到`DataGrid`using后`WPF`：

```
 dataGrid1.DataContext = db.Select_Drawing_Numbers();
    dataGrid1.Columns[0].Width = 10; 
```

但我收到一个错误：

```
 Index is out of range. Please select a non-zero, non-negative integer. 
```

如何在调用之前确保数据已绑定`Columns[0]`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T18:03:45.787

尝试挂钩[`Loaded`](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.loaded.aspx)到`DataGrid`. 您遇到的问题是它`DataGrid`实际上没有加载任何值（因此没有列/行），直到它是`Loaded`.

# python - 正则表达式匹配直到给定文本？

> ID：14283729
> 
> 赞同：2
> 
> 时间：2013-01-11T17:42:23.633
> 
> 标签：python, regex

我正在编写一个匹配的正则表达式`fooSVM??!`。我想匹配`SVM`这个字符串，这意味着我需要从`foo`until meet`?`或`!`. 请注意，`SVM`可能是其他 Unicode 字符。

我试过`foo(.*)[?!]*`但似乎没有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T17:46:35.747

如果不能有换行符，则可以这样做：

```
foo([^?!]+)[?!] 
```

并检索第一组。

```
foo        # Find "f", then "o", then "o",
(          # begin capture
    [^?!]  # followed by any character which is not "!" or "?",
    +      # once or more
)          # end capture
[?!]       # followed by either a "!" or a "?" 
```

# c# - 大型项目的 DI 重构

> ID：14283731
> 
> 赞同：15
> 
> 时间：2013-01-11T17:42:34.393
> 
> 标签：c#, dependency-injection, refactoring, dependencies, code-injection

我从事一个大型平台项目，支持大约 10 种使用我们代码的产品。

到目前为止，所有产品都在使用我们平台的全部功能：
- 从数据库中检索配置数据
- 远程文件系统访问
- 安全授权
- 基本逻辑（我们付费提供的东西）

对于新产品，我们被要求支持较小的功能子集，而无需平台带来的基础设施。我们的架构很旧（从 2005 年左右开始编码）但相当可靠。

我们有信心在我们现有的课程中使用 DI 来做到这一点，但预计这样做的时间从 5 到 70 周不等，具体取决于您与谁交谈。

那里有很多文章告诉您如何进行 DI，但我找不到任何可以告诉您如何以最有效的方式为 DI 重构的文章？是否有工具可以做到这一点，而不必通过 30.000 行代码并且必须按 CTRL+R 来提取接口并将它们添加到构造函数中太多次？（如果有帮助，我们会重新整理）如果没有，您认为快速实现这一目标的理想工作流程是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-22T19:50:06.650

我假设您正在寻找使用诸如 StructureMap、Funq、Ninject 等 IoC 工具。

在这种情况下，重构工作真正从更新代码库中的入口点（或[Composition Roots](https://stackoverflow.com/questions/6277771/what-is-a-composition-root-in-the-context-of-dependency-injection)）开始。这可能会产生很大的影响，尤其是当您普遍使用静态和管理对象的生命周期（例如缓存、延迟加载）时。一旦你有了一个 IoC 工具并连接了对象图，你就可以开始扩展你对 DI 的使用并享受其中的好处。

我将首先关注类似设置的依赖项（应该是简单的值对象），然后开始使用您的 IoC 工具进行解析调用。接下来，创建工厂类并注入它们来管理对象的生命周期。感觉就像你在倒退（而且很慢），直到你到达你的大多数物体都在使用 DI 的顶部，并且必然是 SRP - 从那里它应该是下坡。一旦你有更好的关注点分离，你的代码库的灵活性和你可以做出改变的速度将大大增加。

提醒一句：不要自欺欺人地认为在任何地方都撒上“服务定位器”是你的灵丹妙药，它实际上是一种[DI 反模式](http://blog.ploeh.dk/2010/02/03/ServiceLocatorisanAnti-Pattern/)。我认为您**首先需要使用它，**但随后您应该使用构造函数或设置器注入完成 DI 工作并删除服务定位器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-06T04:47:32.063

感谢所有的答复。我们现在已经快一年了，我想我基本上可以回答我自己的问题。

正如 lasseeskildsen 所指出的，我们当然只转换了我们平台中要在新产品中重复使用的部分。由于这只是代码库的部分转换，我们采用 DIY 方法进行依赖注入。

我们的重点是在不带来不需要的依赖项的情况下使这些部分可用，而不是启用对它们的单元测试。这会影响您处理问题的方式。在这种情况下，没有真正的设计更改。

所涉及的工作是平凡的，因此问题是如何快速甚至自动完成。答案是它不能自动化，但是使用一些键盘快捷键和重新锐化可以很快完成。对我来说，这是最佳流程：

1.  我们跨多种解决方案工作。我们创建了一个临时“主”解决方案，其中包含所有解决方案文件中的所有项目。尽管重构工具并不总是足够聪明，无法识别二进制和项目引用之间的差异，但这至少会使它们在多个解决方案中部分工作。

2.  创建您需要删除的所有依赖项的列表。按功能分组。在大多数情况下，我们能够一次处理多个相关的依赖项。

3.  您将在许多文件中进行许多小的代码更改。此任务最好由一个或最多两个开发人员完成，以避免不断合并您的更改。

4.  首先摆脱单例：在将它们从这种模式中转换出来之后，提取一个接口（resharper -> 重构 -> 提取接口）删除单例访问器以获取构建错误列表。进入第 6 步。

5.  为了摆脱其他参考：提取界面如上。湾。注释掉原来的实现。这将为您提供构建错误列表。

6.  Resharper 现在成为一个很大的帮助：

    *   Alt + shift + pg down/up 快速导航损坏的引用。
    *   如果多个引用共享一个公共基类，则导航到其构造函数并点击 ctrl + r + s（“更改方法签名”）以将新接口添加到构造函数。Resharper 8 为您提供了“通过调用树解析”的选项，这意味着您可以使继承类的签名自动更改。这是一个非常简洁的功能（似乎是版本 8 中的新功能）。
    *   在构造函数主体中，将注入的接口分配给不存在的属性。按 alt + enter 选择“创建属性”，将其移动到需要的位置，就完成了。取消注释 5b 中的代码。
7.  测试！冲洗并重复。

为了在原始解决方案中使用这些类而不进行重大代码更改，我们创建了重载的构造函数，通过服务定位器检索它们的依赖关系，正如 Brett Veenstra 提到的那样。这可能是一种反模式，但适用于这种情况。在所有代码都支持 DI 之前，它不会被删除。

我们在大约 2-3 周（1.5 人）内将大约四分之一的代码转换为像这样的 DI。再过一年，我们现在将所有代码都切换到 DI。这是一种不同的情况，因为焦点转移到了单元可测试性上。我认为上述一般步骤仍然有效，但这需要一些实际的设计更改来强制执行 SOC。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-03T14:43:09.237

你问的是工具。一个可能有助于像这样的大型重构的工具是[nDepend](http://www.ndepend.com/)。我用它来帮助确定重构工作的目标位置。

我不愿提及它，因为我不想给人这样的印象，即像 nDepend 这样的工具是承担这个项目所必需的。但是，可视化代码库中的依赖关系会很有帮助。它附带 14 天的全功能试用版，可能足以满足您的需求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T10:34:54.453

不要认为有任何工具可以进行这种代码转换。

因为->

在现有代码库中使用 DI 将涉及，

*   使用接口/抽象类。再次在这里，应该采取正确的选择来简化转换，同时牢记 DI 原则和代码功能。

*   有效分离/统一多个/单个类中的现有类，以保持代码模块化或小的可重复单元。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-08T12:23:33.703

我处理转换的方法是查看系统中永久修改状态的任何部分；文件、数据库、外部内容。一旦改变并重新阅读，它是否已经改变了？这是要改变它的第一个地方。

所以你要做的第一件事就是找到一个修改源的地方，如下所示：

```
class MyXmlFileWriter
{
   public bool WriteData(string fileName, string xmlText)
   {   
      // TODO: Sort out exception handling
      try 
      {
         File.WriteAllText(fileName, xmlText);  
         return true; 
      } 
      catch(Exception ex) 
      { 
         return false; 
      }
   }
} 
```

其次，您编写单元测试以确保在重构​​时不会破坏代码。

```
[TestClass]
class MyXmlWriterTests
{
   [TestMethod]
   public void WriteData_WithValidFileAndContent_ExpectTrue()
   {
      var target = new MyXmlFileWriter();
      var filePath = Path.GetTempFile();

      target.WriteData(filePath, "<Xml/>");

      Assert.IsTrue(File.Exists(filePath));
   }

   // TODO: Check other cases
} 
```

接下来，从原始类中提取一个接口：

```
interface IFileWriter
{
   bool WriteData(string location, string content);
}

class MyXmlFileWriter : IFileWriter 
{ 
   /* As before */ 
} 
```

重新运行测试，希望一切顺利。保留原始测试，因为它正在检查您的旧实现是否有效。

接下来编写一个什么都不做的假实现。我们只想在这里实现一个非常基本的行为。

```
// Put this class in the test suite, not the main project
class FakeFileWriter : IFileWriter
{
   internal bool WriteDataCalled { get; private set; }

   public bool WriteData(string file, string content)
   {
       this.WriteDataCalled = true;
       return true;
   }
} 
```

然后进行单元测试...

```
class FakeFileWriterTests
{
   private IFileWriter writer;

   [TestInitialize()]
   public void Initialize()
   {
      writer = new FakeFileWriter();
   }

   [TestMethod]
   public void WriteData_WhenCalled_ExpectSuccess()
   {
      writer.WriteData(null,null);
      Assert.IsTrue(writer.WriteDataCalled);
   }
} 
```

现在它的单元测试和重构版本仍然有效，我们需要确保在注入时，调用类使用的是接口，而不是具体版本！

```
// Before
class FileRepository
{
   public FileRepository() { }

   public void Save( string content, string xml )
   {
      var writer = new MyXmlFileWriter();
      writer.WriteData(content,xml);
   }
}

// After
class FileRepository
{
   private IFileWriter writer = null;

   public FileRepository() : this( new MyXmlFileWriter() ){ }
   public FileRepository(IFileWriter writer) 
   {
      this.writer = writer;
   }

   public void Save( string path, string xml)
   {
      this.writer.WriteData(path, xml);
   }
} 
```

那么我们做了什么？

*   有一个使用普通类型的默认构造函数
*   有一个接受`IFileWriter`类型的构造函数
*   使用实例字段来保存引用的对象。

然后是为 编写单元测试`FileRepository`并检查该方法是否被调用的情况：

```
[TestClass]
class FileRepositoryTests
{
   private FileRepository repository = null;

   [TestInitialize()]
   public void Initialize()
   {
    this.repository = new FileRepository( new FakeFileWriter() );
   }

   [TestMethod]
   public void WriteData_WhenCalled_ExpectSuccess()
   {
       // Arrange
       var target = repository;

       // Act
       var actual = repository.Save(null,null);

       // Assert
       Assert.IsTrue(actual);
   }
} 
```

好的，但是在这里，我们真的在测试`FileRepository`还是`FakeFileWriter`？我们正在测试，`FileRepository`因为我们的其他测试正在`FakeFileWriter`单独测试。此类 -`FileRepositoryTests`对于测试传入参数的空值会更有用。

假货没有做任何聪明的事——没有参数验证，没有 I/O。它只是坐在那里，以便 FileRepository 可以保存任何工作的内容。它的目的有两个；显着加快单元测试并且不破坏系统状态。

如果这个 FileRepository 也必须读取文件，您也可以实现 IFileReader（这有点极端），或者只是将最后写入的 filePath/xml 存储到内存中的字符串并取而代之。

* * *

因此，随着基础知识的结束 - 你如何处理这个？

在需要大量重构的大型项目中，最好将单元测试合并到任何经历 DI 更改的类中。理论上，你的数据不应该被提交到数百个位置[在你的代码中]，而是通过几个关键位置推送。在代码中找到它们并为它们添加一个接口。我使用的一个技巧是将每个数据库或类似索引的源隐藏在这样的接口后面：

```
interface IReadOnlyRepository<TKey, TValue>
{
   TValue Retrieve(TKey key);
}

interface IRepository<TKey, TValue> : IReadOnlyRepository<TKey, TValue>
{
   void Create(TKey key, TValue value);
   void Update(TKey key, TValue);
   void Delete(TKey key);
} 
```

这使您可以以非常通用的方式从数据源中检索。您可以通过仅替换注入的位置来从`XmlRepository`to切换。`DbRepository`这对于从一个数据源迁移到另一个数据源而不影响系统内部的项目非常有用。将 XML 操作更改为使用对象可能很容易，但使用这种方法维护和实现新功能要容易得多。

我能给出的唯一其他建议是一次做 1 个数据源并坚持做。抵制一次做太多事情的诱惑。如果您真的不得不一键保存到文件、数据库和 Web 服务，请使用提取接口，伪造调用并且不返回任何内容。一口气做很多事情是一种真正的杂耍行为，但是与从第一原则开始相比，您可以更容易地将它们放回原处。

祝你好运！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-25T04:22:54.147

这本书可能会很有帮助：

有效地使用遗留代码 - Michael C. Feathers - [http://www.amazon.com/gp/product/0131177052](https://rads.stackoverflow.com/amzn/click/com/0131177052)

我建议从小改动开始。逐渐移动依赖项以通过构造函数注入。始终保持系统正常工作。从构造函数注入的依赖项中提取接口并开始使用单元测试进行包装。在有意义的时候带上工具。您不必立即开始使用依赖注入和模拟框架。您可以通过构造函数手动注入依赖项来进行很多改进。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-06-10T14:35:59.740

您所描述的是该过程的重要组成部分；遍历每个类，创建一个接口并注册它。如果您立即承诺重构到组合根，这是最成问题的，在 MVC 的情况下，这意味着假设您要注入控制器。

这可能需要大量工作，如果代码执行大量直接对象创建，那么尝试一次完成所有操作可能会非常复杂。在这些情况下，我认为使用服务定位器模式并手动调用解析是可以接受的。

首先用服务定位器解析调用替换一些对构造函数的直接调用。这将减少最初需要的重构量，并开始为您带来 DI 的好处。

随着时间的推移，您的调用将越来越接近组合根，然后您可以开始删除服务定位器的使用。

# linq - 将 LINQ 转换为列表 到 Python 2.7

> ID：14283735
> 
> 赞同：0
> 
> 时间：2013-01-11T17:42:41.703
> 
> 标签：linq, python-2.7

我正在尝试将以下语句转换为 python (2.7)：

```
List<int> data = Entities.MyData.Select(x => x.Id).ToList(); 
```

在 Python 中，我可以执行以下操作（使用 SQLAlchemy）

```
myData = MyData().query.all() 
data = []
for m in myData:
    data.append(m.Id) 
```

问题是，这似乎不是很干净。我知道 python 总是有更好的做事方式，但是由于我对 Python 不熟悉，我找不到解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:45:29.977

```
data = [d.Id for d in MyDate().query.all()] 
```

这些被称为[列表推导](http://docs.python.org/2/tutorial/datastructures.html#list-comprehensions)。

# r - 在 R 中使用 write.table 写入 csv 文件时出现不希望的对齐

> ID：14283736
> 
> 赞同：0
> 
> 时间：2013-01-11T17:42:49.760
> 
> 标签：r, csv, createfile

我正在尝试使用`R`. 首先，程序将写入标题，然后在 for 循环中附加生成的行。示例代码如下：

```
 writeLines(text=c('Mean','Sd','\n'),'file.csv',sep=',')
   for(i in 1:5)
    {x <- rnorm(10); dat1 <- cbind(mean(x),sd(x))
      write.table(dat1,'file.csv',append=TRUE,sep=',',col.names=FALSE)
    } 
```

但这会将我的第一行向右移动一个元素，在 csv 输出中给出以下内容。我怎样才能避免这种情况？还有另一种方法可以实现我在这里尝试做的事情吗？

**编辑** 另外，在这种情况下，我们如何删除*1*的列标签？`col.names=FALSE`似乎没有帮助。我`row.names=FALSE`按照@Roman Luštrik 的建议使用。*它解决了这个问题。*但第一行移位问题尚未解决。

![在此处输入图像描述](../Images/b7191f8aed71b0f550f464848b659451.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T17:59:25.677

我经常不得不以这种方式写入文件。我通常这样做。

如果文件已经存在，只需追加不带列名和行名。如果没有，请创建一个全新的。

```
x <- rnorm(10); dat1 <- data.frame(Mean = mean(x), Sd = sd(x))
if (file.exists("file.csv")) {
   write.table(dat1, file = "file.csv", append = TRUE, col.names = FALSE, row.names = FALSE, sep = ",")
} else {
   write.table(dat1, file = "file.csv", col.names = TRUE, row.names = FALSE, sep = ",")
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T18:07:34.563

为什么不使用`paste()`？

```
writeLines(text=paste(c('Mean','Sd'),collapse=','),'file.csv',sep="\n")
for(i in 1:5) {
  x <- rnorm(10); dat1 <- cbind(mean(x),sd(x))
  write.table(dat1, 'file.csv', append=TRUE, sep=',', row.names=FALSE, col.names=FALSE)
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T18:31:07.993

要了解 CSV 文件的外观，我建议您在文本编辑器中打开它，而不是在 Excel（它会转换它）中打开它。因为那时你可以看到你的 CSV 开始像：

```
Mean,Sd,
,"1",0.441737369447746,1.07695222886305
[...] 
```

...两个太多的逗号。

在您的`writeLines`陈述中，您的意思如下：

```
 writeLines(paste('Mean','Sd',sep=","),'file.csv') 
```

在您的情况下有什么问题是您替换了默认值`sep="\n"`with`writeLines`并且`sep=","`显然还在最后一项*之后*`writeLines`打印了一个分隔符，这与. （当打印行作为默认操作时，这更有意义，也用 . 关闭最后一行。）*`paste``\n`*

 *在`write.Table`，使用`row.names=FALSE`。*

# javascript - TypeScript 基于 Web 的 IDE

> ID：14283737
> 
> 赞同：19
> 
> 时间：2013-01-11T17:42:51.883
> 
> 标签：javascript, ide, typescript

鉴于 TypeScript 是开源的，[这个基于 Web 的 IDE](http://www.typescriptlang.org/Playground/)是否也可以作为可以在任何地方下载的工具提供？

我正在开发一个 Web 应用程序，客户端可以在其中编写一个用户定义的表达式（使用用户定义的变量和预定义的方法），该表达式在运行时使用 C# .Net 在服务器上进行评估、编译和使用。使用 TypeScript 及其出色的基于 Web 的编辑器的功能，如语法或错误突出显示、代码完成、方法签名建议等，为我在用户界面上省去了很多麻烦。

那么这个编辑器也是 TypeScript 的一部分吗？如果没有，是否还有其他具有类似功能的开源解决方案？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-11T18:37:45.623

2017 年更新：TypeScript Playground 中使用的[Monaco 编辑器](https://github.com/Microsoft/monaco-editor)已在 GitHub 上提供。

您还可以查看[Visual Studio Code](https://github.com/Microsoft/vscode)以获得更多的浏览器外体验。

还有一个[基于 ACE Editor 的 TypeScript 编辑器](https://github.com/hi104/typescript-playground-on-ace)，它也在 GitHub 上。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-22T21:58:09.033

有一些 Web IDE 支持 TypeScript，即：

*   [云9](https://c9.io/site/blog/2012/10/typescript-support-in-cloud9/)
*   [猫](http://jbaron.github.com/cats/)
*   [JSBin](http://jsbin.com/?javascript)（从下拉列表中选择 TypeScript）
*   [巴兹](https://github.com/nxn/baz)

如果您考虑制作一个新项目，您可以基于我的两个项目之一：[TypeScript Compile](https://github.com/niutech/typescript-compile)或[TypeScript Interpret](https://github.com/niutech/typescript-interpret) ;)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-09-19T13:48:49.520

在 Playground 上使用的编辑器被非正式地称为`Monaco`并在[Visual Studio Code](https://code.visualstudio.com/)中使用。

*更新 11.22.2015：* Visual Studio Code 现在是开源的，这意味着我们可以访问 Monaco Editor 的源代码。我认为这现在应该使我们能够在浏览器中使用 Monaco 编辑器，我正在[等待对](https://github.com/Microsoft/vscode/issues/446)VS Code repostiroy 中我的问题的答复。

> Visual Studio Code 的“编辑器”（使用语法高亮、行号等渲染代码的东西）部分是 Microsoft 的 Monaco 编辑器。它与用于 OneDrive、Windows Azure、TypeScript Playground 和 Visual Studio Online 的编辑器相同。我还没有从微软找到任何关于这个编辑器的真实文档，但是网上有一些关于它的文章。

[在此处](https://stackoverflow.com/a/29966094/1571103)阅读有关 Visual Studio Code的更多信息。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-11T20:47:12.613

它有一个开源的实现：

[https://github.com/jbaron/typescript-playground-on-ace](https://github.com/jbaron/typescript-playground-on-ace)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-10-30T09:36:21.540

有 goormIDE 这也是云 IDE 这是开源或服务版本

*   [http://goorm.io](http://goorm.io)

*   [http://github.com/xenoz0718/goorm](http://github.com/xenoz0718/goorm)

如果您使用 node.js，只需键入此命令

```
$ npm install goorm -g 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-10-25T13:59:18.830

我在 node.js 和浏览器中都使用过 TypeScript Compiler API。还与摩纳哥编辑：

*   Playground 和编译器 API 示例 100% 在浏览器中[https://cancerberosgx.github.io/typescript-in-the-browser/typescript-compiler/](https://cancerberosgx.github.io/typescript-in-the-browser/typescript-compiler/)
*   在服务器中评估的 TS 编译器示例和游乐场：[https ://typescript-api-playground.glitch.me](https://typescript-api-playground.glitch.me)
*   并且努力（WIP）在浏览器中使用 monaco-editor 和 typescript 100% 构建一个 TS 项目编辑器。
*   更多信息在这里：[https ://github.com/cancerberoSgx/typescript-in-the-browser](https://github.com/cancerberoSgx/typescript-in-the-browser)

是的，TypeScript 和 monaco 编辑器看起来不错，享受吧！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-01-14T13:33:54.153

对于非常简单的东西，您可以尝试 [https://chrome.google.com/webstore/detail/typescript-editey/liedfkjkedgcgpddoijfeeeeoikcbmaf](https://chrome.google.com/webstore/detail/typescript-editey/liedfkjkedgcgpddoijfeeeeoikcbmaf)

您的打字稿文件将即时转换为 js 文件，您的网站将免费托管在 Google Drive 上。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-04-17T23:09:31.780

我正在使用 CATS，我真的很喜欢它，因为有两件事：

*   IDE 还不错。它完成了它的工作，一旦你练习它，你会喜欢它的！
*   它是便携式的

最后一个是我最喜欢的功能，因为我不需要安装任何东西（至少在 Windows 下），而且您不需要 Visual Studio（大约 9 Gb 和两个小时的安装时间）。

TypeScript Playground 是一个不错的编辑器，但如果您需要测试小脚本，或者想尝试只能在一个文件中完成的事情！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-12-27T16:21:03.253

[Koding](https://koding.com/?c=ideh)提供带有 Root 的 VM，因此您可以安装所需的任何工具，在这种情况下，通过`npm install -g typescript`.

包括 VM 域和 Apache，因此在浏览器中预览您的工作也很容易 :)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-10-04T13:34:36.120

由于 TypeScript 的 Playground 源代码直到现在才可用，我已经发布了一个实现——同样基于[Monaco 编辑器](https://github.com/Microsoft/monaco-editor)——对编译器选项和代码执行进行了一些增强：

GitHub 存储库：[https](https://github.com/fabiandev/typescript-playground)
://github.com/fabiandev/typescript-playground 在线游乐场：[https ://fabiandev.github.io/typescript-playground/](https://fabiandev.github.io/typescript-playground/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-08-30T03:09:37.190

Typescript Playground 的编辑器名为 Monaco，可在 GH / npm / etc 上找到。

[http://github.com/Microsoft/monaco-editor](http://github.com/Microsoft/monaco-editor)

[https://www.npmjs.com/package/monaco-editor](https://www.npmjs.com/package/monaco-editor)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-03-19T09:56:02.933

以下云 IDE 具有不错的 TypeScript 支持：

*   [代码沙盒](https://codesandbox.io)
*   [StackBlitz](https://stackblitz.com/)

# c# - 如何找到使用的参考文件？

> ID：14283744
> 
> 赞同：3
> 
> 时间：2013-01-11T17:43:07.000
> 
> 标签：c#, visual-studio-2010, dll

我知道如何引用外部库。但是现在我正在尝试处理一个代码示例，并且想反过来知道这一点。所以使用了一些库，我不知道使用了哪些 dll。因此，我应该参考哪个 dll 以在我的代码中使用它们？

像这样;

```
// main program
using myhidden.api.net 
```

如何检测这里调用了哪个 dll 文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T17:45:42.317

你可以看到`Object Browser`;

*   添加对 DLL 文件的引用。
*   在列表中右键单击它。
*   点`View`进去`Object Browser`。

![在此处输入图像描述](../Images/5c620e5782b40dbd9f020b406d177fe1.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T17:49:01.503

能做什么取决于你的情况。

如果您只有一个代码文件，而根本没有关于使用的其他 DLL 的信息，那么您的选择非常有限。你所能做的就是在谷歌上搜索命名空间中的字符串，然后在你找到代码的任何网站上四处寻找，看看是否有任何关于使用什么 DLL 的信息。

如果您知道命名空间来自几个 DLL 之一并且您拥有这些 DLL，请按照 Gonul 先生在他的回答中建议的那样做。

# c# - .NET 可移植类库和 UDP 支持

> ID：14283746
> 
> 赞同：17
> 
> 时间：2013-01-11T17:43:19.450
> 
> 标签：c#, .net, networking, udp, philips-hue

我正在为 Philips Hue Lights 编写一个 C# 库。我正在尝试在 .NET 可移植集中编写基本 API 包装器，这样我就可以将该库重新用于各种平台，例如 Windows 8/RT/WP。API 本身是使用 REST 的 HTTP，因此`HttpWebRequest`可以满足我的大部分需求。

可以使用 SSDP over UDP 发现控制灯本身的网桥。但是，我无法在可移植类库 (PCL) 中找到使用 UDP 套接字的方法。

没有`System.Net.Sockets`可用的。命名空间中也没有任何`System.Net`允许它的东西。我在 Intellisense 中看到了一个`DatagramSocket`列表，`Windows.Networking.Sockets`但无法看到该命名空间。

有谁知道我如何在 .NET PCL 下获得 SSDP 的 UDP 功能？

我真的不想将发现功能与核心库分开。

现在我的目标是*`.NET 4.5 + SL 5 + WP 8 + .NET for Windows Store`*. 我的印象是套接字仍然可用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-14T14:40:13.780

WinRT 和 WPF 应用程序之间的套接字支持没有共同的交叉点，因此在以它们为目标的 PCL 项目中不可用。

我有一个针对 WPF 和 WinRT 的 PCL 库，它与 UDP 发现网络交互，我想出的最简洁的实现涉及在 PCL 库中创建一个 IUDPSocket 接口，该接口定义用于发送/接收数据和连接到多播组的成员。WPF 应用程序使用 System.Net.Sockets.Socket 实现我的 IUDPSocket，而 RT 应用程序使用 Windows.Networking.Sockets.DatagramSocket 实现它。

我的发现网络客户端类（在 PCL 项目中定义）的构造函数采用一个委托，该委托用于创建 IUDPSocket 的实例。我这样做而不是传入初始化的 IUDPSocket 实例，因此调用代码不必知道涉及哪些端口或地址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T02:41:36.793

正如这篇[MSDN 文章所述](http://msdn.microsoft.com/en-us/library/gg597391.aspx)，PCL 仅限于目标平台的通用程序集：

> 在可移植类库项目中，您指定要定位的平台，并且在您的项目中仅引用这些平台支持的程序集。如果您尝试引用目标平台不支持的程序集，Visual Studio 会警告您不兼容。所有平台都支持核心程序集（mscorlib.dll、System.dll、System.Core.dll 和 System.Xml.dll）。

如同一篇文章的摘要表中所述，除 Xbox 360 之外的每个平台都支持网络类库 (NCL)。进一步阅读会导致以下信息：

> 当您指定要在可移植类库项目中定位的平台时，这些平台支持的程序集会在您的项目中自动引用。您不必添加或删除程序集。如果您更改目标平台，引用的程序集会自动更新。

因此，您可能在项目创建期间选择了每个平台。禁用 XBox 360 应该会让您恢复对 NCL 和 UdpClient 的支持。但是，如果您还需要支持 Xbox 360，您有两个选择：选择不是 PCL 的项目类型或手动实现 UDP 支持。

# php - 用mysql查询邮件检索

> ID：14283749
> 
> 赞同：1
> 
> 时间：2013-01-11T17:43:34.067
> 
> 标签：php, mysql, select, union

我有一个邮件表，我需要在一个查询中检索所有当前用户的传入和传出邮件。当 php 循环遍历结果时，它会根据发送或接收的最新消息构建一个主视觉对象，然后需要构建与该最近消息相关的先前消息视觉对象（这将在页面下方的最新消息下看到） . 我的邮件表是这样设置的：

一世`d(auto_incr), from_user(user id number), to_user(user id number),
orig_mess(id number of the first message in conversation),
status(0 for unread, 1 for read)`

与任何邮件收件箱一样，我需要按如下顺序获取结果：1）发送给登录用户的未读消息（按 id 排序），然后是最新消息之后的每个对话中的任何先前消息

2）阅读发送给登录用户的消息或从登录用户发送的消息（全部按他们的ID排序），然后当然是最新消息之后与每个对话相关的任何先前消息

到目前为止，这是我所做的：

```
 $result = mysql_query("(SELECT id FROM Mail WHERE Mail.to_user='37' AND   
       Mail.status='0' ORDER BY Mail.id DESC) UNION (SELECT id FROM Mail WHERE   
(Mail.to_user='37' AND Mail.status='1') OR   
(Mail.from_user='37') ORDER BY Mail.id DESC)")or die(mysql_error()); 
```

我已经完成了我正在寻找的结果，使用查询来获取每个对话中的每条最新消息，然后为每个对话执行另一个查询。这样做的问题是，如果用户在其邮箱中有 20 个对话，则会发生 21 个查询以显示所有对话。任何有关如何完成此操作或是否有更好的方法来设置邮件系统的帮助将不胜感激。

我仍然没有想出任何可靠的方法来实现这一点。任何人都可以阐明一些光？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T18:23:06.283

我认为这样的事情应该有效。这将在同一个查询中同时提取已发送和已接收的消息，并首先按具有最新未读消息的对话排序，然后是最新已读消息。

```
SELECT   <any fields you want>

FROM     Mail as m

     JOIN

     (SELECT  orig_mess, id, status
      FROM    Mail 
      WHERE   Mail.from_user='37' OR Mail.to_user='37'
      ) as latest ON m.orig_mess = latest.orig_mess
      AND latest.id = (SELECT  id  
                       FROM    Mail  
                       WHERE   from_user='37' OR to_user='37' 
                               orig_mess = latest.orig_mess
                       ORDER BY status asc, id DESC  
                       LIMIT 1)

WHERE    m.from_user='37' OR m.to_user='37'   

ORDER BY latest.status, latest.id DESC, m.status, m.id DESC 
```

# java - 使用 Spring 注入的 InstantiationException

> ID：14283750
> 
> 赞同：0
> 
> 时间：2013-01-11T17:43:43.000
> 
> 标签：java, spring, tomcat, code-injection

我第一次尝试使用 Spring 注入。我肯定忘记了一些明显的东西，但我不知道它是什么。

在 src/main/java 下，我有一个包含 Hello、Animal、Cat 的包“示例”。

在 src/main/webapp/WEB-INF 下，我有 web.xml 和 springapp-servlet.xml。

当我使用 Tomcat 部署我的应用程序时，我得到：

```
javax.servlet.ServletException: Error instantiating servlet class example.Hello
    org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472) 
```

我缺少什么让注射起作用？

以下来源：

你好.java

```
package example;

import java.io.IOException;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

@Service
public class Hello extends HttpServlet {
  private final Animal animal;

  @Autowired
  public Hello(final  Animal animal) {
    this.animal = animal;
  }

  @Override
  protected void doGet(final HttpServletRequest req,
          final HttpServletResponse resp) throws ServletException, IOException {
    resp.getWriter().write(animal.sound());
  }
} 
```

猫.java

```
package example;

import org.springframework.stereotype.Service;

@Service
public class Cat implements Animal {
  public String sound() {
    return "Miaou";
  }
} 
```

动物.java

```
package example;

public interface Animal {
  public String sound() ;
} 
```

web.xml

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<web-app xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    version="2.5">

    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/springapp-servlet.xml</param-value>
    </context-param>

    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

    <servlet>
        <servlet-name>Hello</servlet-name>
        <servlet-class>example.Hello</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>Hello</servlet-name>
        <url-pattern>/hello</url-pattern>
    </servlet-mapping>

</web-app> 
```

springapp-servlet.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:mvc="http://www.springframework.org/schema/mvc"
  xmlns:context="http://www.springframework.org/schema/context"
  xsi:schemaLocation="
        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd">

  <context:component-scan base-package="example" />
    <mvc:annotation-driven />

</beans> 
```

我最初认为也许我的 springapp-servlet.xml 甚至没有被读取，但如果我在 web.xml 中的名称 springapp-servlet.xml 上打错字，我在部署时确实会收到错误，所以我显然有springapp-servlet.xml 的正确路径。它正在，但注射不起作用。

更新：

由于下面的答案，我在下面展示了对我有用的解决方案。除了 Hello 之外，所有代码都保持不变：

你好.java

```
public class Hello extends HttpServlet {

  @Inject
  private Animal animal;

  @Override
  public void init(final ServletConfig config) throws ServletException {
    super.init(config);
    SpringBeanAutowiringSupport.processInjectionBasedOnServletContext(this,
            config.getServletContext());
  }

  @Override
  protected void doGet(final HttpServletRequest req,
          final HttpServletResponse resp) throws ServletException, IOException {
    resp.getWriter().write(animal.sound());
  }    
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T17:51:03.500

这是错误的：

```
@Service
public class Hello extends HttpServlet { 
```

Servlet 的生命周期由 servlet 容器控制，而不是由 Spring 控制。因此，您不能将 Spring bean 直接自动装配到 servlet。Spring 根本不应该创建 servlet。基本上Spring对你的servlet一无所知，它试图实例化它，但它与servlet容器创建的用于处理请求的实例不同。

最后，您的 servlet 没有无参数构造函数。这样的构造函数是必需的，但它不会使您的示例通过。

解决方案是直接从注册的 Web 应用程序上下文中获取所需的 Spring bean：

```
WebApplicationContext context = WebApplicationContextUtils.getRequiredWebApplicationContext(getServletContext());
Animal animal = context.getBean(Animal.class); 
```

# 另见（其他解决方案）

*   [从 JBoss 中的 servlet 访问 Spring bean](https://stackoverflow.com/questions/467235)

# c++ - c++ linux ifstream读取csv文件

> ID：14283751
> 
> 赞同：0
> 
> 时间：2013-01-11T17:43:45.473
> 
> 标签：c++, linux, g++, ifstream

```
void Lexicon::buildMapFromFile(string filename )  //map
{
    ifstream file;
    file.open(filename.c_str() );
    string wow, mem, key;
    unsigned int x = 0;

    while(true) {
        getline(file, wow);
        if (file.fail()) break; //check for error
        while (x < wow.length() ) {
            if (wow[x] == ',') {
                key = mem;
                mem.clear();
                x++; //step over ','
            } else 
                mem += wow[x++];
        }

        list_map0.put(key, mem); //char to string
        list_map1.put(mem, key); //string to char
        mem.clear(); //reset memory
        x = 0;//reset index
    }
    file.close();
} 
```

此函数读取一个 2 列的 csv 文件并创建一个以 column1 为键的 column2 的映射。我用 g++ 编译并且文件位于大学文件共享中，当我使用 ./foo 运行程序时，csv 文件 [在与 foo 相同的目录文件夹中] 未被读取......为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T17:50:34.237

也许您没有该文件的读取权限。发出命令`ls -l <csv_file>` 看看你是否有权阅读。有关文件权限的更多信息，请参阅此链接[https://help.ubuntu.com/community/FilePermissions](https://help.ubuntu.com/community/FilePermissions)

试试下面的代码对我来说很完美

```
 #include <iostream>
#include <stdio.h>
#include <map>
#include <string>
#include <fstream>
using namespace std;

int main(void )  //map
{
   map<string, string> list_map0;

   map<string, string> list_map1;
    string filename = "csv";
    ifstream file;
    file.open(filename.c_str() );
    string wow, mem, key;
    unsigned int x = 0;

    while(true) {
        getline(file, wow);
        if (file.fail()) break; //check for error
        while (x < wow.length() ) {
            if (wow[x] == ',') {
                key = mem;
                mem.clear();
                x++; //step over ','
            } else
                mem += wow[x++];
        }

        list_map0[key] = mem; //char to string
        list_map1[mem] = key; //string to char
        mem.clear(); //reset memory
        x = 0;//reset index
    }
    printf("%d\n", list_map0.size());
    file.close();
} 
```

# android - 如何将应用程序的背景设置为动画（动态壁纸？）

> ID：14283756
> 
> 赞同：4
> 
> 时间：2013-01-11T17:43:53.630
> 
> 标签：android, background, live-wallpaper

我有一个简单的 Android 应用程序，想将背景设置为动画。我怎样才能做到这一点？

1.  我必须创建动态壁纸，将其安装在手机上，然后在我的应用程序中使用？如果是这样，我如何在我的应用程序中使用它？
2.  是否可以在我的项目中设置动态壁纸或任何其他类型的动画背景？也就是说，不需要单独的应用程序？如果是这样，我该怎么做？

简而言之，我希望我的应用程序的背景是动画的，无论它是如何完成的（动态壁纸、gif、视频等等......）

# grand-central-dispatch - 在不同的调度队列上异步调度时任务如何同步？（快门示例）

> ID：14283758
> 
> 赞同：1
> 
> 时间：2013-01-11T17:44:15.367
> 
> 标签：grand-central-dispatch, cs193p

在 Lecture 10, Fall 2011 中介绍的 Shutterbug 示例代码中，照片被下载，然后使用以下代码更新到表格视图控制器中：

```
 dispatch_queue_t downloadQueue = dispatch_queue_create("flickr downloader", NULL);
    dispatch_async(downloadQueue, ^{
       NSArray *photos = [FlickrFetcher recentGeoreferencedPhotos];
       dispatch_async(dispatch_get_main_queue(), ^{
          self.navigationItem.rightBarButtonItem = sender;
          self.photos = photos;
          });
     });
     dispatch_release(downloadQueue); 
```

照片获取活动在 flickr 下载器队列上异步分派，而表视图更新代码（UIKit 功能）在 main_queue 上异步分派，如课堂中所述。

我不明白的是确保 main_queue 上的表视图更新代码直到照片获取活动完成后才执行的机制。在代码块中，队列是串行调度的，但我不知道系统是如何知道的在照片下载完成之前不要在 main_queue 上执行任务。如果这没有发生，如果 main_queue 任务在照片下载完成之前运行，self.photos 将为 nil。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T17:54:33.460

嗯。我在这里的原始答案是完全错误的，我显然误读了代码片段。直到获取照片后视图更新代码才会运行的原因是 -recentGeoreferencedPhotos 不是异步的。dispatch_async 在程序到达它之前不会开始异步，因此 -recentGeoreferencedPhotos 到那时已经返回。

# html - IE 悬停兼容性问题

> ID：14283759
> 
> 赞同：0
> 
> 时间：2013-01-11T17:44:17.267
> 
> 标签：html, internet-explorer

我正在处理的项目中遇到 IE 兼容性问题。蓝色悬停文本显示在 FF 和 Chrome 上，但 IE 没有效果。

这是网站： http: [//fortiswebsystems.com/showmetheparts/demo.html](http://fortiswebsystems.com/showmetheparts/demo.html)

任何想法为什么 IE 不呈现蓝色背景悬停？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T17:46:50.707

如果您希望 IE9 使用当前规范，请放置正确的标题：

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge" /> 
```

# javascript - 制作一个 Bootstrap 弹出框模式？

> ID：14283760
> 
> 赞同：6
> 
> 时间：2013-01-11T17:44:21.717
> 
> 标签：javascript, twitter-bootstrap, modal-dialog, popover

我在 javascript 中手动显示了一个弹出框，但为了增加重点，我想让它成为模态的，即禁用背景功能并淡出。有没有一个选项可以做到这一点，或者我将如何手动进行？

我知道它混合了设计隐喻，但它会是有用的功能，而且我看不到重新设计模态以适应相对定位很容易。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-15T10:22:43.000

看看这个脚本，我认为这应该对你有帮助

[http://scruffles.github.io/BootstrapModalPopover/](http://scruffles.github.io/BootstrapModalPopover/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-24T13:57:38.067

添加

```
.popover, .tooltip {
    z-index: 1060 !important;
} 
```

适合你的风格

# php - 如何将用户重定向到另一个域 .htaccess

> ID：14283762
> 
> 赞同：4
> 
> 时间：2013-01-11T17:44:26.513
> 
> 标签：php, html, apache, .htaccess, mod-rewrite

服务器默认将输入 example.com/folder 的用户重定向到 example.com/folder/

有什么方法可以改变它（例如，当他们转到 example.com/folder 以重定向到 otherexample.com/folder/ 时）。但这必须影响所有文件夹，但不包括根目录。此外，当他们键入 example.com/folder/ 时，代码不应执行任何操作。

**编辑**

此外，代码不应影响图像和所有其他文件（或者更好地说，如果请求的文档具有文件扩展名），只影响文件夹。

例子：

```
should affect : example.com/folder
              : example.com/folder/folder

but should not : example.com
               : example.com/forum (but only forum, only this folder)
               : example.com/folder/
               : example.com/folder/.
               : example.com/folder/folder/
               : example.com/image.png
               : example.com/something.something
               : example.com/something.
               : example.com/.something 
```

**编辑**

还有另一个编辑：假设我们找到了 .htaccess 代码（下面的第一个答案）。我如何使它适用于我的所有域和网站（期望我的博客（example.com/blog）），我不想像整个网站一样进行重定向？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-18T00:09:16.423

> 服务器默认将输入 example.com/folder 的用户重定向到 example.com/folder/

[mod_dir](http://httpd.apache.org/docs/2.2/mod/mod_dir.html)这样做有几个很好的理由，所有这些都在[DirectorySlash](http://httpd.apache.org/docs/2.2/mod/mod_dir.html#directoryslash)文档中进行了解释。您可以使用`DirectorySlash Off`来关闭该行为，但这样做通常不是一个好主意，除非您有非常好的和正当的理由这样做。

但是，话虽如此，您在问题中描述的内容可以由[mod_rewrite](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)单独处理。首先，您需要检查请求的资源是否为目录。它必须是您的`DocumentRoot`.

```
RewriteCond   %{DOCUMENT_ROOT}%{REQUEST_URI}  -d 
```

apply 也非常重要`%{DOCUMENT_ROOT}`，否则目录检查将不起作用。

* * *

*   '-d'（是目录）

    将 TestString 视为路径名并测试它是否存在，并且是一个目录。

* * *

其次，您需要忽略对实际上有斜杠的目录的所有请求。

```
RewriteCond   %{REQUEST_URI}                  !/$ 
```

现在您已经过滤到您想要重定向到另一个域的资源：没有尾部斜杠的目录。其他所有内容（带有斜杠的目录、图像等）此时甚至都不在游戏中。实际重定向的时间。

```
RewriteRule   ^   http://other.com%{REQUEST_URI}/ [redirect=temp,last] 
```

您可能希望稍后改变您对重定向的想法，因此您应该使用临时重定向（又名[302 Found](http://httpstatus.es/302)）而不是永久重定向（又名[301 Moved Permanently](http://httpstatus.es/301)）。`last`告诉 mod_rewrite 停止所有进一步的处理。

这是最终产品：

```
RewriteEngine On

RewriteCond   %{DOCUMENT_ROOT}%{REQUEST_URI}  -d
RewriteCond   %{REQUEST_URI}                  !/$

RewriteRule   ^   http://other.com%{REQUEST_URI}/ [redirect=temp,last] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-11T17:50:15.870

关于什么

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_URI} !(.*)/$
RewriteRule ^(.*)$ http://otherexample.com/$1/ [L,R=301] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T17:50:40.897

```
# This allows you to redirect your entire website to any other domain
Redirect 301 / http://mt-example.com/

# This allows you to redirect your entire website to any other domain
Redirect 302 / http://mt-example.com/

# This allows you to redirect index.html to a specific subfolder
Redirect /index.html http://example.com/newdirectory/

# Redirect old file path to new file path
Redirect /olddirectory/oldfile.html http://example.com/newdirectory/newfile.html

# Provide Specific Index Page (Set the default handler)
DirectoryIndex index.html 
```

[在此处阅读更多有关 RewriteEngine 方法的信息](http://www.ksl-consulting.co.uk/301-redirect-examples.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-11T17:53:04.067

希望这是你需要的

```
Redirect 301 /directory http://www.newdomain.com 
```

只需使用您的文件夹名称更改目录

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-20T15:49:45.333

对于：www.newdomain.com

```
RewriteEngine On
RewriteBase /
RewriteCond %{HTTP_HOST} !newdomain.com$ [NC]
RewriteRule ^(.*)$ http://www.newdomain.com/$1 [L,R=301] 
```

对于：olddomain.com 到 newdomain.com

```
RewriteEngine On
RewriteBase /
RewriteCond %{HTTP_HOST} !newdomain.com$ [NC]
RewriteRule ^(.*)$ http://newdomain.com/$1 [L,R=301] 
```

# ruby-on-rails - 在rails的routes.rb中创建的“get”路由“rails generate controllers”有什么用？

> ID：14283763
> 
> 赞同：0
> 
> 时间：2013-01-11T17:44:30.307
> 
> 标签：ruby-on-rails, ruby-on-rails-3

当使用 command 在 rails 创建一个新的控制器帖子时，以`rails generate controllers post`开头的路由`get`将自动插入到 routes.rb 的顶部，如下所示：

```
 get "posts/index"

  get "posts/new"

  get "posts/create"

  get "posts/edit"

  get "posts/update"

  get "posts/show" 
```

我们注意到删除这些路由后，rails 路由的工作方式相同。我们刚刚发现其中一条路由导致 Rails 引擎路由出错，必须将其删除。我们还没有找到关于那些自动生成的路线的文档。这些路线的目的是什么，是否在 Rails 应用程序中使用它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:50:54.680

“get”是路由引擎支持的 HTTP 动词。可以将 GET 和 POST（以及其他）路由到不同的方法，即使它们访问相同的 URL。也可以只支持某些 URL 的某些动词（就像这里发生的那样）。

关于它们的必要性 - 我们必须查看您的其余 routes.rb 文件才能知道。如果您有默认匹配规则，则在删除这些规则后可能会生效。

# qt - 如何模拟标准键序列的发射？

> ID：14283764
> 
> 赞同：4
> 
> 时间：2013-01-11T17:44:36.950
> 
> 标签：qt, testing, keyboard-shortcuts

我想通过模拟 的发射来测试我的 Qt 小部件的“复制”功能`QKeySequence::Copy`，但[`QTest::keyClick`](http://doc.qt.digia.com/qt/qtest.html#keyClick)不接受`QKeySequence`（或`QKeySequence::StandardKey`）：

```
void QTest::keyClick ( QWidget * widget, Qt::Key key, Qt::KeyboardModifiers modifier = Qt::NoModifier, int delay = -1 ) [static]
void QTest::keyClick ( QWidget * widget, char key, Qt::KeyboardModifiers modifier = Qt::NoModifier, int delay = -1 ) [static] 
```

我可以将副本硬编码为`Ctrl`+ `C`：

```
QTest::keyClick(widget, Qt::Key_C, Qt::ControlModifier) 
```

但是，在其他环境中测试我的小部件时，这会相当脆弱并且可能会失败，所以如果可能的话，我更愿意使用`QKeySequence::Copy`。

我知道我可以[`QKeySequence::QKeySequence(StandardKey)`](http://qt-project.org/doc/qt-4.8/qkeysequence.html#QKeySequence-6)用来查找主绑定，但我看不到如何提取键和修饰符。或者，是否有其他方法可以获得相同的结果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T09:09:03.553

解决了：`operator[]`返回 a`Qt::Key`和`Qt::KeyboardModifiers`标志类型的按位组合（这似乎没有在任何地方记录）。所以提取键和修饰符的方法是用`Qt::KeyboardModifierMask`（也完全没有记录）：

```
QKeySequence binding(QKeySequence::Copy);
for (uint i = 0; i < binding.count(); ++i) {
    uint key = binding[i];
    QTest::keyClick(widget, Qt::Key(key & ~Qt::KeyboardModifierMask),
        Qt::KeyboardModifiers(key & Qt::KeyboardModifierMask));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-12T11:25:15.000

您可以使用该[`QKeySequence::keyBindings()`](http://qt-project.org/doc/qt-4.8/qkeysequence.html#keyBindings)方法获取给定的所有可用键序列，`SequenceKey`然后使用[此问题](https://stackoverflow.com/questions/14034209/convert-string-representation-of-keycode-to-qtkey-or-any-int-and-back)中的答案提取键。

或者，您可以`QKeySequence`使用该[`toString`](http://qt-project.org/doc/qt-4.8/qkeysequence.html#toString)函数将每个字符串转换为字符串，将字符串拆分为`QStringList`使用`+`作为分隔符的字符串，然后`Qt::Key`使用辅助函数将列表的每个部分转换为对应的部分。

```
QList<QKeySequence> bindings = QKeySequence::keyBindings(QKeySequence::Copy);
for (int i=0; i<bindings.count(); i++)
{
    QStringList keysList = bindings[i].toString().split("+");
    QVector<int> keys = getKeys(keysList);
}

QVector<int> getKeys(const QStringList& list)
{
    QVector<int> keys;
    for (int i=0; i<list.count(); i++)
    {
        if (list[i] == "Ctrl")
            keys << Qt::Key_Control;
        else if (list[i] == "F11")
            keys << Qt::Key_F11;
        else if (list[i] == "Ins")
            keys << Qt::Key_Insert;
        // add remaining modifiers
        // single letters
        else
            keys << list[i][0].toAscii();
    }
    return keys;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-21T12:08:26.023

我遇到了同样的问题并且接受的答案有效，但是我发现了另一种简单的方法（只是想在此处添加它以防其他人正在寻找解决方案）。

如果使用 Qt 5.10 或更高版本，您可以调用：

```
QTest::keySequence(widget, QKeySequence::Copy); 
```

[https://doc.qt.io/qt-5/qtest.html#keySequence-1](https://doc.qt.io/qt-5/qtest.html#keySequence-1)

# vb.net - 如何打开没有地址栏的 IE 弹出窗口？

> ID：14283769
> 
> 赞同：1
> 
> 时间：2013-01-11T17:44:47.220
> 
> 标签：vb.net, winforms

我想在我的应用程序中添加一个按钮来打开一个站点，我希望该站点以 POP UP 的方式打开（所以地址不能更改），如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:56:22.863

将对 Microsoft Internet 控件的 COM 引用添加到您的项目中。

```
Dim  ie As SHDocVw.InternetExplorer = new SHDocVw.InternetExplorer()
ie.Navigate("http://www.google.com")
ie.ToolBar = 0
ie.AddressBar = false
ie.Visible = true 
```

虽然这行得通，但您仍被 IE 通过其 COM 对象提供给您的东西所困扰。如果您需要更多控制，您可以随时使用 webbrowser 控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T17:54:25.503

一种解决方案是创建自己的表单，并在其中放置一个 WebBrowser 控件。

# android - 如何以编程方式调整 ImageView 的大小

> ID：14283773
> 
> 赞同：10
> 
> 时间：2013-01-11T17:44:58.813
> 
> 标签：android, android-imageview

当我触摸它时，我想调整 ImageView 的大小。当您在谷歌地图或移动浏览器中进行缩放时调整它的大小将是完美的，但如果只是触摸它，我可以调整它的大小就足够了。那可能吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-01-11T17:49:17.647

只需抓住触摸此 ImageView 的事件，而不仅仅是调整身高和体重：

```
touched_image_view.getLayoutParams().height += 20;
touched_image_view.getLayoutParams().width += 20; 
```

或者您可以创建并设置新的 LayoutParams ：

```
LinearLayout.LayoutParams layoutParams = new LinearLayout.LayoutParams(100, 100);
touched_image_view.setLayoutParams(layoutParams); 
```

希望能帮助到你。

# php - 再次非法偏移类型

> ID：14283776
> 
> 赞同：-4
> 
> 时间：2013-01-11T17:45:09.620
> 
> 标签：php, multidimensional-array, warnings

这里又是另一个非法偏移类型，但找不到答案！？

```
$GLOBALS['q']   = array();
$init_query[]   = array();

if (!empty($init_query)){
    foreach($init_query as $key => $bit){
        $GLOBALS['q'][$bit] = ($key !== (count($init_query)-1)) ? $init_query[$key + 1] : null;
    }
} 
```

它的;

```
$GLOBALS['q'][$bit] = ($key !== (count($init_query)-1)) ? $init_query[$key + 1] : null; 
```

有问题。$init_query 是一维数组。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T17:48:13.787

`$init_query[] = array();`结果`array(array());`You then loop over it and do: `$GLOBALS['q'][$bit]`这`$GLOBALS['q'][array()]`是一个非法的偏移量。偏移量只能是标量值，如数字和字符串。

> $init_query 是一维数组。

**不是**。_

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T17:50:56.413

利用

```
$init_query = array(); 
```

代替

```
$init_query[] = array(); 
```

# xml - targetNamespace 参数应与架构的 targetNamespace 的值相同

> ID：14283782
> 
> 赞同：0
> 
> 时间：2013-01-11T17:45:36.183
> 
> 标签：xml, xsd, xml-validation, xsd-validation

当我读取带有内联模式验证的 xml 文件时出现此错误。XML 文件如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<SysConfig xmlns="PM-NameSpace" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="SysConfig.xsd">
...
</SysConfig> 
```

XSD 文件与 XML 文件位于同一文件夹中，名为“SysConfig.xsd”，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="PM-NameSpace" targetNamespace="PM-NameSpace">
...
</xs:schema> 
```

我想在代码中进行内联模式验证，所以我的 C# 看起来像这样：

```
XmlReaderSettings xmlReaderSettings = new XmlReaderSettings();
xmlReaderSettings.ValidationType = ValidationType.Schema;
xmlReaderSettings.ValidationFlags |= XmlSchemaValidationFlags.ProcessInlineSchema;
xmlReaderSettings.ValidationFlags |= XmlSchemaValidationFlags.ProcessSchemaLocation;
xmlReaderSettings.ValidationFlags |= XmlSchemaValidationFlags.ReportValidationWarnings;
xmlReaderSettings.ValidationEventHandler += new ValidationEventHandler(handler);
XmlReader xmlReader = XmlReader.Create(sysConfigPath, xmlReaderSettings);
XmlDocument sysConfigXmlDocument = new XmlDocument();
sysConfigXmlDocument.Load(xmlReader); 
```

一旦调用 Load（最后一行），就会调用验证事件处理程序，实际消息是：

**无法加载命名空间“ ”的架构 - targetNamespace 参数“ ”应该与架构的 targetNamespace 'PM-NameSpace' 的值相同。**

这似乎表明某些东西正在使用默认 ('') 命名空间，但我已经非常仔细地指定了 xlmns 和目标命名空间。我不明白“targetNamespace 参数'' ...”的错误消息是什么意思 - 指定了 targetNamespace*属性*并且不是空白（''） - 我不知道xml 术语中的“*参数*”是什么- 或者它是指 C# 代码中（或缺失）的东西？任何人都可以解释一下吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T18:04:24.747

我没有遇到过这个问题，但我相信发生这种情况的原因`xsi:noNamespaceSchemaLocation`是为了实际指示**没有**命名空间的 XML 的 XSD 位置。您的 XML 实际上有一个命名空间，所以我相信您应该将该属性替换为：

```
xsi:schemaLocation="PM-NameSpace SysConfig.xsd" 
```

# delphi - 带位图的简单组合框

> ID：14283783
> 
> 赞同：2
> 
> 时间：2013-01-11T17:45:37.987
> 
> 标签：delphi, combobox, bitmap

如何将位图放在样式设置为简单的组合框中？例如，谷歌浏览器右边有星号，火狐浏览器右边有箭头。我试过这段代码：

```
procedure TForm2.ComboBox1DrawItem(Control: TWinControl; Index: Integer;
Rect: TRect; State: TOwnerDrawState);
var
ComboBox: TComboBox;
bitmap: TBitmap;
begin
ComboBox := (Control as TComboBox);
Bitmap := TBitmap.Create;
try
ImageList1.GetBitmap(0, Bitmap);
with ComboBox.Canvas do
begin
  FillRect(Rect);
  if Bitmap.Handle <> 0 then Draw(Rect.Left + 2, Rect.Top, Bitmap);
  Rect := Bounds(Rect.Left + ComboBox.ItemHeight + 2, Rect.Top, Rect.Right - Rect.Left, Rect.Bottom - Rect.Top);
  DrawText(handle, PChar(ComboBox.Items[0]), length(ComboBox.Items[0]), Rect, DT_VCENTER+DT_SINGLELINE);
end;
finally
Bitmap.Free;
  end;
end; 
```

有效，但仅适用于样式：csOwnerDrawFixed 和 csOwnerDrawVariable，位图也仅在项目上可见。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-11T21:33:39.690

> ...位图也仅在项目上可见。

要在所有者绘制组合框的编辑器中绘制位图，请检查`odComboBoxEdit`所有者绘制状态：

![在此处输入图像描述](../Images/3a86f3235af3edf4860aed4dc115be4b.png)

```
type
  TComboBox = class(StdCtrls.TComboBox)
  private
    FBmp: TBitmap;
    FBmpPos: TPoint;
  protected
    procedure DrawItem(Index: Integer; Rect: TRect;
      State: TOwnerDrawState); override;
  public
    constructor Create(AOwner: TComponent); override;
    destructor Destroy; override;
  end;

constructor TComboBox.Create(AOwner: TComponent);
begin
  inherited Create(AOwner);
  FBmp := TBitmap.Create;
  FBmp.Canvas.Brush.Color := clGreen;
  FBmp.Width := 16;
  FBmp.Height := 16;
end;

destructor TComboBox.Destroy;
begin
  FBmp.Free;
  inherited Destroy;
end;

procedure TComboBox.DrawItem(Index: Integer; Rect: TRect;
  State: TOwnerDrawState);
begin
  TControlCanvas(Canvas).UpdateTextFlags;
  if Assigned(OnDrawItem) then
    OnDrawItem(Self, Index, Rect, State)
  else
  begin
    Canvas.FillRect(Rect);
    if Index >= 0 then
      Canvas.TextOut(Rect.Left + 2, Rect.Top, Items[Index]);
    if odComboBoxEdit in State then
    begin
      Dec(Rect.Right, FBmp.Width + Rect.Left);
      FBmpPos.X := Rect.Right + Rect.Left;
      FBmpPos.Y := (Height - FBmp.Height) div 2;
      if ItemIndex > -1 then
        Canvas.TextOut(Rect.Left + 2, Rect.Top, Items[ItemIndex]);
      Canvas.Draw(FBmpPos.X, FBmpPos.Y, FBmp);
    end;
  end;
end; 
```

为了在非所有者绘制的组合框上绘制位图，您必须使用自定义`WM_NCPAINT`处理程序在组合框本身的窗口中进行绘制。

# android - android在一个简单的活动上内存不足

> ID：14283791
> 
> 赞同：0
> 
> 时间：2013-01-11T17:46:11.443
> 
> 标签：android

我有一个带有主要活动（MainMenu）的android应用程序。有时当我运行它时，我会收到以下错误。

这不会一直发生......这是一个简单的活动，在layput中有几张图片。

**错误**：

```
01-11 17:58:45.638: E/AndroidRuntime(13960): FATAL EXCEPTION: main
01-11 17:58:45.638: E/AndroidRuntime(13960): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.mycity.roshhaayn/com.city.base.MainMenu}: android.view.InflateException: Binary XML file line #85: Error inflating class <unknown>
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1967)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1992)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.app.ActivityThread.access$600(ActivityThread.java:127)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1158)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.os.Handler.dispatchMessage(Handler.java:99)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.os.Looper.loop(Looper.java:137)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.app.ActivityThread.main(ActivityThread.java:4511)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at java.lang.reflect.Method.invokeNative(Native Method)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at java.lang.reflect.Method.invoke(Method.java:511)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:980)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:747)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at dalvik.system.NativeStart.main(Native Method)
01-11 17:58:45.638: E/AndroidRuntime(13960): Caused by: android.view.InflateException: Binary XML file line #85: Error inflating class <unknown>
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.view.LayoutInflater.createView(LayoutInflater.java:606)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at com.android.internal.policy.impl.PhoneLayoutInflater.onCreateView(PhoneLayoutInflater.java:56)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.view.LayoutInflater.onCreateView(LayoutInflater.java:653)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:678)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.view.LayoutInflater.rInflate(LayoutInflater.java:739)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.view.LayoutInflater.rInflate(LayoutInflater.java:742)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.view.LayoutInflater.inflate(LayoutInflater.java:489)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.view.LayoutInflater.inflate(LayoutInflater.java:352)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:272)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.app.Activity.setContentView(Activity.java:1835)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at com.city.base.MainMenu.onCreate(MainMenu.java:72)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.app.Activity.performCreate(Activity.java:4470)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1052)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1931)
01-11 17:58:45.638: E/AndroidRuntime(13960):    ... 11 more
01-11 17:58:45.638: E/AndroidRuntime(13960): Caused by: java.lang.reflect.InvocationTargetException
01-11 17:58:45.638: E/AndroidRuntime(13960):    at java.lang.reflect.Constructor.constructNative(Native Method)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at java.lang.reflect.Constructor.newInstance(Constructor.java:417)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.view.LayoutInflater.createView(LayoutInflater.java:586)
01-11 17:58:45.638: E/AndroidRuntime(13960):    ... 25 more
01-11 17:58:45.638: E/AndroidRuntime(13960): Caused by: java.lang.OutOfMemoryError
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.graphics.Bitmap.nativeCreate(Native Method)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.graphics.Bitmap.createBitmap(Bitmap.java:605)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.graphics.Bitmap.createBitmap(Bitmap.java:551)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.graphics.Bitmap.createScaledBitmap(Bitmap.java:437)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.graphics.BitmapFactory.finishDecode(BitmapFactory.java:618)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:593)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:445)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.graphics.drawable.Drawable.createFromResourceStream(Drawable.java:773)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.content.res.Resources.loadDrawable(Resources.java:1968)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.content.res.Resources.getDrawable(Resources.java:677)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.graphics.drawable.StateListDrawable.inflate(StateListDrawable.java:173)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.graphics.drawable.Drawable.createFromXmlInner(Drawable.java:867)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.graphics.drawable.Drawable.createFromXml(Drawable.java:804)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.content.res.Resources.loadDrawable(Resources.java:1953)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.content.res.TypedArray.getDrawable(TypedArray.java:601)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.view.View.<init>(View.java:2841)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.view.View.<init>(View.java:2778)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.view.ViewGroup.<init>(ViewGroup.java:380)
01-11 17:58:45.638: E/AndroidRuntime(13960):    at android.widget.RelativeLayout.<init>(RelativeLayout.java:174)
01-11 17:58:45.638: E/AndroidRuntime(13960):    ... 28 more         ' 
```

**我的活动是：**

```
 public class MainMenu extends CityBase
    {

        RelativeLayout messenger;
        RelativeLayout contact_center;
        RelativeLayout settings;
        RelativeLayout facebook;
        RelativeLayout web;

        @Override
        protected void onCreate(Bundle savedInstanceState) 
        {
            super.onCreate(savedInstanceState);

            setContentView(R.layout.main_menu);

            //LayoutInflater inflater = (LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE); 
            //LinearLayout ll = (LinearLayout) inflater.inflate(R.layout.mm_btns, null);

            //LinearLayout bigLL = (LinearLayout) findViewById(R.id.big_lay);
            //bigLL.addView(ll);

            messenger = (RelativeLayout) findViewById(R.id.messenger);  
            messenger.setOnClickListener(new OnClickListener() {    
                @Override
                public void onClick(View v) {
                    Intent intent = new Intent(getApplicationContext(), Messenger.class);
                    startActivity(intent);

                }
            });

            contact_center = (RelativeLayout) findViewById(R.id.contact_center);    
            contact_center.setOnClickListener(new OnClickListener() {   
                @Override
                public void onClick(View v) {
                    Intent intent_c_m = new Intent(getApplicationContext(),ContactCenter.class);
                    startActivity(intent_c_m);

                }
            });

            Button web = (Button) findViewById(R.id.web_icon);
            //web.setBackgroundResource(R.drawable.arrow_green);
            web.setOnClickListener(new OnClickListener() {  
                @Override
                public void onClick(View v) {
                    Intent i = new Intent(Intent.ACTION_VIEW);
                    i.setData(Uri.parse(AppDelegate.WEBSITE_URL));
                    startActivity(i);

                }
            });

            Button facebookBtn = (Button) findViewById(R.id.facebook_icon);
            //facebookBtn.setBackgroundResource(R.drawable.arrow_green);
            facebookBtn.setOnClickListener(new OnClickListener() {  
                @Override
                public void onClick(View v) {
                    Intent intent = new Intent(Intent.ACTION_VIEW);
                    intent.setData(Uri.parse(AppDelegate.FACEBOOK_URL));
                    startActivity(intent);

                }
            });

            Button profile = (Button) findViewById(R.id.settings_icon); 
            //profile.setBackgroundResource(R.drawable.arrow_green);
            profile.setOnClickListener(new OnClickListener() {  
                @Override
                public void onClick(View v) {

                    SharedPreferences sp = getSharedPreferences("user_data",0);
                    Editor edit = sp.edit();
                    edit.putString("mode", "update");
                    edit.commit();

                    Intent intent = new Intent(getApplicationContext(), RegisterBase.class);
                    startActivity(intent);

                }
            });
            Button dialer = (Button) findViewById(R.id.dialer_icon);
            //dialer.setBackgroundResource(R.drawable.arrow_green);
            dialer.setOnClickListener(new OnClickListener() {   
                @Override
                public void onClick(View v) {
                    Intent intent = new Intent(getApplicationContext(), CityDialer.class);
                    startActivity(intent);
                }
            });

        }

         private void unbindDrawables(View view) {
                if (view.getBackground() != null) {
                view.getBackground().setCallback(null);
                }
                if (view instanceof ViewGroup) {
                    for (int i = 0; i < ((ViewGroup) view).getChildCount(); i++) {
                    unbindDrawables(((ViewGroup) view).getChildAt(i));
                    }
                ((ViewGroup) view).removeAllViews();
                }
            }

        @Override
        protected void onDestroy() {
            // TODO Auto-generated method stub
            super.onDestroy();
               unbindDrawables(findViewById(R.id.huge_lay));
               //unbindDrawables(findViewById(R.id.contact_center));
                System.gc();
                Runtime.getRuntime().gc();
        }  ' 
```

**我的 XML 是：**

```
 <?xml version="1.0" encoding="utf-8"?>
    <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/huge_lay"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:background="@drawable/back_texture"
        android:orientation="vertical" >

        <LinearLayout
            android:id="@+id/big_lay"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginLeft="15dp"
            android:layout_marginRight="15dp"
            android:orientation="vertical" >

            <ImageView
                android:layout_width="fill_parent"
                android:layout_height="150dp"
                android:layout_marginLeft="3dp"
                android:layout_marginRight="3dp"
                android:contentDescription="Logo for the city of Rosh-Ha&apos;ayin"
                android:src="@drawable/rosh_new_logo2" />

            <RelativeLayout
                android:id="@+id/messenger"
                android:layout_width="wrap_content"
                android:layout_height="76dp"
                android:background="@drawable/mm_messages" >

                <ImageView
                    android:id="@+id/messages_icon"
                    android:layout_width="68dp"
                    android:layout_height="68dp"
                    android:layout_alignParentRight="true"
                    android:layout_alignParentTop="true"
                    android:layout_marginLeft="8dp"
                    android:src="@drawable/icon_messages"
                    android:visibility="invisible" />

                <RelativeLayout
                    android:id="@+id/text_msgs"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_centerVertical="true"
                    android:layout_marginRight="5dp"
                    android:layout_toLeftOf="@+id/messages_icon" >

                    <TextView
                        android:id="@+id/messages_title"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_alignParentRight="true"
                        android:text="@string/your_messages"
                        android:textColor="@color/grey"
                        android:textSize="20dp"
                        android:textStyle="bold" />

                    <TextView
                        android:id="@+id/textView1"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_alignParentRight="true"
                        android:layout_below="@+id/messages_title"
                        android:text="@string/your_messages_desc"
                        android:textColor="@color/grey"
                        android:textSize="13sp" />

                    <TextView
                        android:id="@+id/textView2"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_alignParentRight="true"
                        android:layout_below="@+id/textView1"
                        android:text="@string/your_messages_desc2"
                        android:textColor="@color/grey"
                        android:textSize="13sp" />
                </RelativeLayout>

            </RelativeLayout>

            <RelativeLayout
                android:id="@+id/contact_center"
                android:layout_width="wrap_content"
                android:layout_height="76dp"
                android:background="@drawable/cc_messages" >

             <ImageView
                    android:id="@+id/messages_icon1"
                    android:layout_width="68dp"
                    android:layout_height="68dp"
                    android:layout_alignParentRight="true"
                    android:layout_alignParentTop="true"
                    android:layout_marginLeft="8dp"
                    android:src="@drawable/icon_messages"
                    android:visibility="invisible" />

                <RelativeLayout
                    android:id="@+id/text_msgs1"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_centerVertical="true"
                    android:layout_marginRight="5dp"
                    android:layout_toLeftOf="@+id/messages_icon1" >

                    <TextView
                        android:id="@+id/messages_title1"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_alignParentRight="true"
                        android:text="@string/contact_moked_menu"
                        android:textColor="@color/grey"
                        android:textSize="20dp"
                        android:textStyle="bold" />

                    <TextView
                        android:id="@+id/textView11"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_alignParentRight="true"

                        android:layout_below="@+id/messages_title1"
                        android:text="@string/contact_moked_desc_menu"
                        android:textColor="@color/grey"
                        android:textSize="13sp" />                
                </RelativeLayout>

            </RelativeLayout>

            <LinearLayout
                android:id="@+id/linearLayout1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="center_horizontal"
                android:layout_marginTop="12dp"
                android:orientation="horizontal" >

                <RelativeLayout
                    android:id="@+id/settings"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_marginRight="6dp" >

                    <Button
                        android:id="@+id/settings_icon"
                        android:layout_width="68dp"
                        android:layout_height="68dp"
                        android:background="@drawable/mm_profile"
                         />
    <!--  -->
                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_below="@+id/settings_icon"
                        android:layout_centerInParent="true"
                        android:gravity="center_vertical"
                        android:text="@string/profile"
                        android:textColor="@color/black" />
                </RelativeLayout>

                <RelativeLayout
                    android:id="@+id/web"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_marginRight="6dp" >

                    <Button
                        android:id="@+id/web_icon"
                        android:layout_width="68dp"
                        android:layout_height="68dp"
                        android:background="@drawable/mm_website"
                         />
    <!--  -->
                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_below="@+id/web_icon"
                        android:layout_centerInParent="true"
                        android:gravity="center"
                        android:text="@string/web"
                        android:textColor="@color/black" />
                </RelativeLayout>

                <RelativeLayout
                    android:id="@+id/facebook"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_marginRight="6dp" >

                    <Button
                        android:id="@+id/facebook_icon"
                        android:layout_width="68dp"
                        android:layout_height="68dp"
                        android:background="@drawable/mm_facebook"
                         />
                    <!--  -->

                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_below="@+id/facebook_icon"
                        android:layout_centerInParent="true"
                        android:gravity="center_vertical"
                        android:text="@string/facebook"
                        android:textColor="@color/black" />
                </RelativeLayout>

                <RelativeLayout
                    android:id="@+id/dialer"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content" >

                    <!--  -->

                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_centerInParent="true"
                        android:text="@string/dialer"
                        android:textColor="@color/black" />

                    <Button
                        android:id="@+id/dialer_icon"
                        android:layout_width="68dp"
                        android:layout_height="68dp"
                        android:layout_alignParentLeft="true"
                        android:layout_alignParentTop="true"
                        android:background="@drawable/mm_fast_dial" />
                </RelativeLayout>

            </LinearLayout>
        </LinearLayout>

        <RelativeLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_alignParentBottom="true"
            android:layout_marginBottom="10dp" >

            <ImageView
                android:id="@+id/bottom_logo"
                android:layout_width="200dp"
                android:layout_height="30dp"
                android:layout_marginBottom="5dp"
                android:layout_marginTop="5dp"
                android:src="@drawable/my_city_bottom_logo" />
        </RelativeLayout>

    </RelativeLayout> 
```

请帮忙，谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T19:35:59.587

Issue is with your images. Looks like you are loading heavy images.

# android - 将数据从 SQLite 保存到 Excel 并附加到电子邮件

> ID：14283793
> 
> 赞同：0
> 
> 时间：2013-01-11T17:46:12.133
> 
> 标签：android, excel, sqlite

我有一个将信息保存到 SQLite 的 android 应用程序，因此我希望我的应用程序能够从我的数据库中获取所有信息，并将其作为 Excel 附件通过电子邮件发送到我的客户电子邮件地址。

**例子。**

**Sqlite 数据库**

日期...姓名...姓氏

2011 年 12 月 10 日 ... Kgotso... 史密斯

2012 年 11 月 15 日...杰拉德...罗纳尔多

并且excel中的结果应该与标题相同。

抱歉，我没有提供任何有关发送电子邮件的代码，因为我不知道如何开始。到目前为止，我所做的唯一步骤是将信息保存到 sqlite 数据库中并能够检索它。

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T19:27:31.017

这实际上取决于您的数据有多大和多复杂。如果这是相对较小的内容，您可以关注@Siddharth Roth 评论并格式化您的数据和逗号分隔 (CSV) 文件。如果您坚持使用 Excel 格式，那么您可能需要查看[Apache POI](http://poi.apache.org/)或类似的端口。如果该库的大小令人望而却步或端口无法正常工作，您最后的办法是将您的信息打包成 JSON 并提交到可以运行完整 POI 并生成复杂的远程服务器（例如 Tomcat 之类的 servlet 引擎）文件。请记住不要在主线程上执行任何操作

# ios - addSubview 不会显示 UISegmentedControl

> ID：14283794
> 
> 赞同：0
> 
> 时间：2013-01-11T17:46:20.827
> 
> 标签：ios, uisegmentedcontrol

我正在阅读 Mark、Nutting 和 LaMarche（Apress 2011）撰写的“开始 iOS 5 开发”的第 15 章。在第 556 页上，我应该从代码中显示分段控件，而不是从库中将对象拖到 nib。代码片段是……

```
self.smileyView.image = self.smiley;

self.segmentedControl = [[UISegmentedControl alloc] initWithItems:[NSArray arrayWithObjects:@"One", @"Two", @"Three", @"Four", nil]];
self.segmentedControl.frame = CGRectMake(bounds.origin.x + 20, CGRectGetMaxY(bounds) - 50, bounds.size.width - 40, 30);

[self.view addSubview:self.segmentedControl];

[self.view addSubview:self.smileyView];
[self.view addSubview:self.label]; 
```

……

请注意，笑脸和标签按预期显示，但分段控件没有。顺便说一句，我已经在 .h 中正式声明了属性 segmentedControl 并在 .m 中合成了它。为什么我在 iOS 6 模拟器中没有看到这个 segmentedControl？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T19:32:12.667

应该多半是因为分段控件的框架不对。

在添加子视图行之后放置一个 NSLog，如下所示，以查看它在屏幕中的位置以及它的大小

```
 NSLog(@"frame %@", NSStringFromCGRect(self.segmentedControl.frame)) 
```

作为最后的努力，尝试将分段控制放在前面。

[self.view带来SubviewToFront：self.segmentedControl]

这应该让您知道出了什么问题

# javascript - 是否可以将 .length 应用于 Titlepane

> ID：14283795
> 
> 赞同：0
> 
> 时间：2013-01-11T17:46:24.773
> 
> 标签：javascript, dojo

我想知道是否可以将 .length 应用于 Titlepane。例如，如果我在对象数组中有一个名称列表，并且我希望为每个名称创建一个标题窗格：

```
 var html = '';
         for (var i = 0; i < data.length; i++)
         html += data[i].Name+'<br>';
         targetNode.innerHTML = html; 
```

目前，该循环将仅显示我在列表中的所有名称。因此，是否可以为每个名称创建一个标题窗格并将名称作为内容放置在其中？

如果有人对我将如何做这件事有任何示例或建议，那就太好了。

编辑 ：

```
 var xhrArgs = {
url: "http://131.41.28.41:3000/pages.json",
handleAs: 'json',
timeout : 2000,

load: function(data){

 for (var i = 0; i < data.length; i++) {
var titlePane = new TitlePane({
  title: 'Title Pane ' + i,
  content: '<div>' + data[i].Name + '</div>'
});
titlePane.placeAt(dom.byId('ok'));
}
  },
error: function(error){
  targetNode.innerHTML = "An unexpected error occurred: " + error;
  }
 };

 // Call the asynchronous xhrGet
 var deferred = dojo.xhr.get(xhrArgs);
 });

 }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T17:53:24.183

确实可以为数组中的每个对象创建一个新的标题窗格：

```
require(['dijit/TitlePane'],function(TitlePane){
  for(var i=0; i<data.length;i++){
    var titlePane = new TitlePane({
      title: 'Title Pane '+i,
      content:'<div>'+data[i].Name+'</div>'
    });
    titlePane.placeAt(/* dom node where all titlepanes should be placed */);
  }
}); 
```

有关 dijit TitlePane 的更多信息，请查看[参考指南](http://dojotoolkit.org/reference-guide/1.8/dijit/TitlePane.html)。

可以在[此处](http://jsfiddle.net/9SqgE/)找到该概念的工作 jsfiddle 。

# python - 如何在python中对两个不同的数组应用不同的运算符

> ID：14283796
> 
> 赞同：2
> 
> 时间：2013-01-11T17:46:26.843
> 
> 标签：python, arrays, python-3.x, operators, np

我有两个数组，每个数组都由一对两个整数（int1，int2）组成。我只想计算每个数组对的第一个值的总和，并且我想对第二个值应用乘法（例如）。显然，如果我写这段代码：

```
tab1=np.array([(1,2),(1,5),(0,6)])
tab2=np.array([(0,7),(1,4),(0,2)])
tab3=tab1+tab2
tab4=tab1*tb2 
```

tab3 的结果将是 tab3=array([[1, 9],[2, 9],[0, 8]])

这笔款项也适用于第二部分。但我想获得 (1+0),(1+1),(0+0)，因此：tab3=array([1,2,0])

是否可以在不对数组执行循环的情况下获得此结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T18:02:51.903

您可以索引以获取适当的元素：

```
>>> tab1 = np.array([(1,2),(1,5),(0,6)])
>>> tab2 = np.array([(0,7),(1,4),(0,2)])
>>> tab1
array([[1, 2],
       [1, 5],
       [0, 6]])
>>> tab1[:,0]
array([1, 1, 0])
>>> tab1[:,1]
array([2, 5, 6]) 
```

因此

```
>>> tab3 = tab1[:,0] + tab2[:,0]
>>> tab4 = tab1[:,1] * tab2[:,1]
>>> tab3
array([1, 2, 0])
>>> tab4
array([14, 20, 12]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T18:22:02.363

```
#Calculates the adding and the multiplication
t=map((lambda x,y:(x[0]+y[0],x[1]*y[1])) , tab1,tab2)
#Splits the result
tab3,tab4 = zip(*t) 
```

必须注意的是，当使用 map 时，循环是隐式的，但仍然作为内部魔法发生。

# google-prediction - 谷歌预测 api 中多特征 csvinstance 数组的正确格式

> ID：14283804
> 
> 赞同：2
> 
> 时间：2013-01-11T17:46:49.317
> 
> 标签：google-prediction

如果我以某种方式将 API Explorer 界面用于 Google 预测 API，我已经正确且成功地设置了训练数据，并且可以运行具有预期结果的预测。

我还可以根据 google 在 php 中给出的示例从 localhost 运行单个特征预测。

我的训练数据有 51 个我想要运行预测的特征。该模型是可靠的，并且返回了 92% 的准确率。我对基于 25000 个实例的训练模型没有任何问题。

在一个有点相关的问题中，Marc Cohen 在 php 中给出了以下示例来运行预测，该预测非常适用于语言演示文件或任何单个特征预测。

```
//------------------ 
```

我刚刚编写了一个测试程序来使用 PHP 进行预测，并且能够使其正常工作。这是魔术序列：

```
 $id = "your-model-id-goes-here";
   $predictionText = "This is a test";
   $predictionData = new InputInput();
   $predictionData->setCsvInstance(array($predictionText));
   // My model takes a single feature but if your model needs more than one 
   // feature, simply include more values in the csvInstance array, like this...
   // $predictionData->setCsvInstance(array($data1, $data2, ..., $dataN));
   $input = new Input();
   $input->setInput($predictionData);
   print_r($predictionService->trainedmodels->predict($id, $input)); 
```

这将显示来自预测请求的未格式化 JSON 响应，如下所示：

```
Array ( [kind] => prediction#output [id] => languages [selfLink] =>    
https://www.googleapis.com/prediction/v1.4/trainedmodels/languages/predict 
[outputLabel] => French [outputMulti] => Array ( [0] => Array ( [label] => 
English [score] => 0.333297 ) [1] => Array ( [label] => French [score] => 
0.339412 ) [2] => Array ( [label] => Spanish [score] => 0.327291 ) ) ) 
```

//--------------------

他对多特征所做的说明，即：//我的模型采用单个特征，但如果您的模型需要多个 // 特征，只需在 csvInstance 数组中包含更多值，如下所示... // $predictionData-> setCsvInstance(array($data1, $data2, ..., $dataN));

对我来说意味着只需将 $predictionText 变量作为“Feature_1”、“Feature_2”、“Feature_3”、.....“Feature_N”传递就可以了。

我使用的数据主要是数字。例如：69,13,10,9,101,69,94,96,96,96......9 我已经尝试过加引号和不加引号，但始终得到相同的预测。

如果我使用 API 资源管理器并在其中输入一个新的数组元素来预测所有数据，即：

```
"input": {
"csvInstance": [

"84",

"63",

"30",

"30",

........... 
```

它会预测正确的答案。

如果我使用资源管理器并按照 Marcs 示例输入数据。即：`"84","63","30","30","207","83","87","94","94","94","94","94","94","94","38","57","143","144","164","164","164","164","164".........` 相同的数据将给出完全不同的结果，而第二种方法总是返回相同的结果。

显然我在这里做错了什么。我已经尝试了所有 php json 编码选项以及我能想到的任何其他方法来正确格式化它以在我的 php 脚本或 API 资源管理器中工作，但无济于事。

谁能告诉我如何`$predictionText`正确格式化。

我的代码如下。（我试过带和不带引号和纯数字）

```
 $predictionText = '84,63,30,30,207,83,87,94,94,94,94,94,94,94,38,57,143,144,164,164,164,164,164,"New Moon",115,221,31,62,-14,-106,-43,-4,43,-174,-224,25,93,142,78,87,29,-65,44,33,34,19,16,14,13,12,11';

$predictionData = new Google_InputInput();
$predictionData->setCsvInstance(array($predictionText) ); 
$input = new Google_Input();    
$input->setInput($predictionData);   
$result = $predictionService->trainedmodels->predict($id, $input);
print("</div><br><br><h2>Prediction Result:</h2>");
print_r($result); 
```

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T15:09:50.223

解决了。

训练要求字符串用引号引起来。即“新月”。预测不需要引号。我已将预测字符串更改为在我拥有的单个字符串功能周围没有引号，并且一切正常。

# r - 值 < 或 > 是前一个数字还是后一个数字？

> ID：14283806
> 
> 赞同：0
> 
> 时间：2013-01-11T17:46:52.700
> 
> 标签：r

我想使用 R 根据每个项目与它之前和之后的连续项目的距离为数据表生成索引列 (i)：

1.  如果 x 与前一个值相比 >10，但与下一个值相比 <10，则将其分配为“开始”
2.  如果 x 与前一个值相比 >10，并且与下一个值相比 >10，则将其分配为“单独”
3.  如果 x 与前一个值相比 <10，但与下一个值相比 >10，则将其分配为“end”
4.  如果 x 与前一个值相比 <10，并且与下一个值相比 <10，则将其分配为“中间”

例如，如果名为“x”的列读取 - 1,3,14,25,26,27,31,46....

生成的索引列将显示：i = start,end,lone,start,middle,middle,end,start...

有谁知道将 > 或 < 10 的“距离参数”指向仅高于或低于自身的值的好方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T18:01:03.370

您可以使用`diff`（获取连续元素之间的距离）以及`head`和`tail`：

```
before = head(diff(x), -1)
after = tail(diff(x), -1)
result = ifelse(before < 10, ifelse(after < 10, "start", "end"), ifelse(after < 10, "middle", "lone")) 
```

# python - Python：从浏览器运行时 os.system() 不起作用

> ID：14283811
> 
> 赞同：-1
> 
> 时间：2013-01-11T17:47:25.243
> 
> 标签：python

我有一个执行一些 mySQL 备份的 shell 脚本。我希望能够从浏览器运行这些备份，所以我有一个 python 脚本，它使用`os.system()`. 该脚本在从命令行运行时有效，但在通过浏览器访问 URL 运行时，shell 脚本不会运行。

```
#!/usr/bin/python
import os

os.system("/srv/www/server_utils/mysql_backup.sh")

print "Content-Type: text/html\n"
print "mySQL Backups completed." 
```

（`print "Content-Type: text/html\n"`是否有防止显示 500 错误）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T18:31:58.660

备份脚本很可能需要特定权限才能运行（数据库的读取权限、备份目录的写入权限或两者兼有），而 Web 服务器没有这些权限。解决方案将取决于运行服务器的操作系统。

# android - Android 4.2.1 问题在 Google Maps MapView Overlay 上绘制多条路径

> ID：14283813
> 
> 赞同：1
> 
> 时间：2013-01-11T17:47:39.683
> 
> 标签：android, google-maps, overlay, android-mapview, android-4.2-jelly-bean

我正在制作一个应用程序，其中涉及使用 Google Maps MapView 上的 GPS 数据绘制一对多线。为了做到这一点，我使用了一个自定义的 Overlay 并构造了一个路径的 ArrayList。路径由从一组 GeoPoints 创建的点组成。在将 GeoPoints 转换为 Points 之后，创建 Paths 并将其添加到 ArrayList 中，并通过遍历所述 ArrayList 来绘制 Paths。所有这些都是在我的自定义 Overlay 的 draw() 方法中完成的。

*现在，除了*运行最新的 Android Jellybean 版本 4.2.1 的设备之外，所有这些在我测试过的每台设备上都运行良好。在这些设备上，仅绘制 ArrayList 中的最后一条路径。我已经用日志输出一遍又一遍地检查了这个过程，它几乎就像以前的路径根本不可见一样，因为数据仍然存在并且看起来好像它应该在绘制。我已经在多个 4.2.1 设备上对此进行了测试，并且在所有设备上的行为都相同。我有一些图片来说明这个问题，但我没有足够的声誉来发布图片。

我无法在互联网的其他地方找到任何有用的信息。有人对地球上的问题可能有任何见解吗？

# c++ - 如何为 gtkmm statusicon 对象添加标签？

> ID：14283815
> 
> 赞同：-1
> 
> 时间：2013-01-11T17:47:47.447
> 
> 标签：c++, gtkmm

我正在用 gtkmm 编写一个简单的应用程序，它在任务栏中显示一个状态图标。当鼠标悬停在图标上时，我希望出现一个标签小部件，但找不到示例。怎么会去做这样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:52:51.477

我假设您的意思是您使用`Gtk::StatusIcon`的是具有`set_tooltip_text()`. 请参阅：[Gtkmm StatusIcon](http://developer.gnome.org/gtkmm/stable/classGtk_1_1StatusIcon.html#ac55a8196e4a9626b96a8abb77ea5730a)了解更多详细信息。

# javascript - 当标签“显示：块”时，Javascript 失去对第一个无效字段（jQuery 验证）的关注

> ID：14283816
> 
> 赞同：0
> 
> 时间：2013-01-11T17:47:50.060
> 
> 标签：javascript, jquery, validation, focus

当错误消息（标签）“显示：块”时，Javascript 失去对“取消突出显示”事件（jQuery 验证）的第一个无效字段的关注。

我使用来自最新 jQuery Validation 的纯代码：jquerycom/Plugins/Validation

```
body {padding:20px;}
/*label.error {display:block;}*/
label.error {color:red;}
p {padding-bottom:15px;} 
```

代码：http: [//jsfiddle.net/352TH/3/](http://jsfiddle.net/352TH/3/)

1.  我的错误标签在 css 中是“内联”的。
2.  按下提交按钮 -> 显示两个错误，关注电子邮件字段。
3.  将有效的电子邮件写入电子邮件字段。
4.  按下提交按钮 -> 显示一个错误，**关注**评论字段。

现在只是`/*label.error { display:block; }*/`在 css 代码中未注释的行

```
body {padding:20px;}
label.error {display:block;}
label.error {color:red;}
p {padding-bottom:15px;} 
```

代码：http: [//jsfiddle.net/352TH/4/](http://jsfiddle.net/352TH/4/)

1.  我的错误标签是 CSS 中的“显示：块”。
2.  按下提交按钮 -> 显示两个错误，关注电子邮件字段。
3.  将有效的电子邮件写入电子邮件字段。
4.  按下提交按钮 -> 显示一个错误，**不关注**评论字段。

:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T21:06:53.727

尝试这个

你的代码

```
$(function(){
$("#commentForm").validate({
    errorLabelContainer: '.validationSummary'
}); 
```

});

为。。改变

```
$("#commentForm").validate(function(){
    errorLabelContainer: '.validationSummary'
}); 
```

并看到这个[例子](http://jsfiddle.net/352TH/6/)

问候。

# eclipse - 在eclipse中更新cordova 2.3？

> ID：14283819
> 
> 赞同：1
> 
> 时间：2013-01-11T17:47:58.087
> 
> 标签：eclipse, cordova

有人可以告诉我如何在 Eclipse 中更新科尔多瓦 2.3 吗？我从（帮助/安装新软件/添加）安装并输入以下地址（http://svn.codespot.com/a/eclipselabs.org/mobile-web-development-with-phonegap/tags/r1.2/下载/) 但现在 2.3 版可用，我不知道它是如何更新的。

有谁知道该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T22:46:49.423

我相信最新版本的 PhoneGap 没有作为 Eclipse 插件发布。

如果你有一个现有的项目并想升级它，你可以看看 PhoneGap 的[升级指南](http://docs.phonegap.com/en/2.3.0/guide_upgrading_index.md.html#Upgrading%20Guides)，里面有分步说明

# debugging - NetBeans 调试器附加配置

> ID：14283821
> 
> 赞同：1
> 
> 时间：2013-01-11T17:48:03.263
> 
> 标签：debugging, netbeans, remote-debugging

**如何删除最近调试器会话列表中的项目？** 当您单击“调试项目”按钮内的下拉箭头时，会显示此信息。NetBeans 在哪里存储这些信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T12:18:37.463

可能在 ~/.netbeans/nbversion/config/Preferences/ 的某个地方

# android - 从列表视图检查值（名称）到另一个活动

> ID：14283825
> 
> 赞同：0
> 
> 时间：2013-01-11T17:48:07.237
> 
> 标签：android, listview, checkbox

在我的应用程序中，列表视图中有一些名称（来自 mysql 数据库），有 100 个名称对应于复选框。一旦我单击 noe 或更多复选框，则相应的名称应显示在下一个活动列表视图中。这个怎么做？如果有人有代码，请提供给我。我会很感激你的帮助..提前谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T18:00:35.163

假设您已经使用如下简单的适配器创建了列表：

```
ListAdapter adapter = new SimpleAdapter(MyActivity.this,arraylist,R.layout.list_item,new String[]{"name"},new int[]{R.id.txtName});
            MyActivity.this.setListAdapter(adapter); 
```

要将“名称”传递给第二个活动，您可以这样做：

```
 final ListView lv = MyActivity.this.getListView();      
        lv.setOnItemClickListener(new OnItemClickListener() {
            public void onItemClick(AdapterView<?>parent, View view, int position, long id){
                HashMap<String, String>hm = (HashMap<String, String>)lv.getItemAtPosition(position);                    
                String message=hm.get("name").toString();
                Intent in = new Intent(getApplicationContext(), SecondActivity.class);
                in.putExtra("nameToSend", message);

                startActivity(in);

            }
        }); 
```

然后在第二个活动中，您可以像这样捕获名称：

```
protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.second_layout);
                Intent in = getIntent();
        String name = in.getStringExtra("nameToSend");
....

    } 
```

# mysql - 从 2 个表中按日期排序

> ID：14283828
> 
> 赞同：1
> 
> 时间：2013-01-11T17:48:26.860
> 
> 标签：mysql, select

我有两个要连接在一起的表，每个表都有一个添加项目的日期。我想做的是使用两个表中的日期列按上次活动对行进行排序，有点像论坛。有人问了一个问题，这个问题在板的顶部，当新的问题被问到时，它们就会被放在板的顶部。问题会向下移动，一旦有人发布了答案，它就会回到板的顶部。我怎样才能制定一个查询来做这样的事情？这是我到目前为止所拥有的：

```
select question, question_id, count(a.answer_id) total
from questions q
left join answers a using(question_id)
group by q.question_id order by question_id desc limit 10 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T17:51:17.913

如果我错了，请纠正我，但是当没有答案时，您只需要使用从问题到订购的日期。

在这种情况下：

```
order by COALESCE(a.date, q.date) desc 
```

[http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#function_coalesce](http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#function_coalesce)

再想一想，这会导致您的查询失败，因为 q.date 和 a.date 不在您的组中。将 q.date 添加到 group by 是可以的，但是将 a.date 添加到 group by 会使相同的问题出现的次数与有答案的次数一样多。

因此，您应该将您的加入更改为：

```
left join (select question_id, max(date) as date from answers group by question_id) a
 on a.question_id = q.question_id 
```

然后使用我建议的顺序

# iphone - 如何在 gropued tableview，IOS 中为每个部分仅添加一个复选标记

> ID：14283829
> 
> 赞同：1
> 
> 时间：2013-01-11T17:48:30.127
> 
> 标签：iphone, ios, objective-c, uitableview

我从 .plist 填充分组表视图。我只想为每个部分放置一个复选标记。我尝试使用 an`NSMutableArray`来保留选定的行并显示复选标记，但没有成功。

![在此处输入图像描述](../Images/abc77ad0a77c39d2c4067f4be87fa8c2.png)

填充类：

```
#import <Foundation/Foundation.h>

@interface ParsePlist : NSObject

@property (nonatomic,strong) NSDictionary * agendaDic;
- (void)passStringToAgendaDic:(NSString *)string;

//survey questions
-(NSArray*)getSurvey;
-(NSString*)getSurveyQuestion:(NSInteger ) section ;

//answers
-(NSArray*)getSurveyAnswers:(NSInteger) section;
-(NSString*)getQuestionAnswer:(NSInteger ) section Row:(NSInteger) row ; 
```

复选标记代码：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

        if (cell == nil)
    {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    cell.textLabel.text = [_parsePlist getQuestionAnswer:[indexPath section] Row:[indexPath row]]; // get string in survey

    if([_selectedIndexPathArray containsObject:[_parsePlist getQuestionAnswer:[indexPath section] Row:[indexPath row]]])
        cell.accessoryType = UITableViewCellAccessoryCheckmark;

    return cell;
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    // this for trying check mark
    UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];
    if (cell.accessoryType == UITableViewCellAccessoryCheckmark)
    {
        cell.accessoryType = UITableViewCellAccessoryNone;
        //remove index path
        [_selectedIndexPathArray removeObject:[_parsePlist getQuestionAnswer:[indexPath section] Row:[indexPath row]]];
    }
    else
    {
        cell.accessoryType = UITableViewCellAccessoryCheckmark;
        [_selectedIndexPathArray addObject:[_parsePlist getQuestionAnswer:[indexPath section] Row:[indexPath row]]];
    }

} 
```

在这种情况下，如何跟踪选定的行？我应该使用`NSDictionary`，还是有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-13T16:55:15.007

要仅选择一个（且仅一个）行，您有 2 个选项：

**跟踪行索引**

有一个私有控制器 int 变量（初始化为 -1），用于存储当前选定的行索引。然后`didSelectRowAtIndexPath`，如果 int 变量 > -1，则首先取消选择该索引处的行。

**蛮力**

在开始时`didSelectRowAtIndexPath`循环遍历所有行并取消选择它们。它非常快，即使是一百行也应该没问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-13T07:41:00.110

对的，这是可能的。您需要提取所有数据并准备一个 NSMutableArrays 并放置它。因此，您的问题放置在部分标题中，您的答案选项放置在每个部分的行中。

[在这里查看图片][1]

```
 #import "Question.h"

@interface Question ()
{
    NSMutableString *urlLString;
    NSDictionary *dataDic;
    NSArray *dataArray;
    NSMutableArray *nmA;
    NSString *question;
    NSArray *optionArray;
    NSMutableArray *pulledOptionArray;
    NSMutableArray *pulledOptionArray1;
    NSMutableArray *pulledOptionArray2;
    NSMutableArray *pulledOptionArray3;
    NSMutableArray *pulledOptionArray4;
    NSMutableArray *pulledOptionArray5;
    NSDictionary *optionDictionary;

    //split
    NSArray *secondsplit;
    int i,j;
}
@end

@implementation Question
@synthesize checkedIndexPath;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];nmA=[[NSMutableArray alloc] init];
    pulledOptionArray=[[NSMutableArray alloc] init]; pulledOptionArray1=[[NSMutableArray alloc] init];
    pulledOptionArray2=[[NSMutableArray alloc] init]; pulledOptionArray3=[[NSMutableArray alloc] init];
     pulledOptionArray4=[[NSMutableArray alloc] init]; pulledOptionArray5=[[NSMutableArray alloc] init];
    [scroll setScrollEnabled:YES];

    //[[[[[self tabBarController] viewControllers] objectAtIndex:1] tabBarItem] setEnabled:false];

    inObj=[inputData globalData];

    urlLString=[NSMutableString stringWithFormat:@"URl Goes Here"];
    //urlLString=[urlLString1 appendString:inObj.languageTestURL];

    if ([inObj.languageTestURL isEqualToString:@"C"])
    {
        [urlLString appendString:@"C"];
    }
    else if([inObj.languageTestURL isEqualToString:@"C++"])
    {
        [urlLString appendString:@"C++"];
    }
    else if([inObj.languageTestURL isEqualToString:@"java"])
    {
        [urlLString appendString:@"java"];
    }

    [page setCurrentPage:0];
    NSLog(@"First");
    [page setCurrentPageIndicatorTintColor:[UIColor blueColor]];

    NSError *erro;

    NSData *jsonData=[NSData dataWithContentsOfURL:[NSURL URLWithString:urlLString]];
    NSDictionary *jLdic=[NSJSONSerialization JSONObjectWithData:jsonData options:NSJSONReadingMutableContainers error:&erro];

    NSArray *pullFromDic=[jLdic objectForKey:@"Questions"];
    NSLog(@"%@",inObj.experience);

    if ([inObj.experience isEqualToString:@"0-6 months[Fresher]"])
    {
        for (int k=0; k<=4; k++)
        {
            dataDic=[pullFromDic objectAtIndex:k];
            question=[dataDic objectForKey:@"Question"];
            optionArray=[dataDic objectForKey:@"Options"];
            for (NSDictionary *nit in optionArray)
            {
                NSString *option=[nit objectForKey:@"option"];
              //  NSLog(@"%@",option);
                [pulledOptionArray addObject:option];
            }

            [nmA addObject:question];
        }
        NSLog(@"%lu",(unsigned long)nmA.count);
    }
    else   if ([inObj.experience isEqualToString:@"1-2 year[Experienced]"])
    {
        for (int k=5; k<=9; k++)
        {
            dataDic=[pullFromDic objectAtIndex:k];
            NSLog(@"%@",dataDic);
        }

        NSLog(@"%@",dataDic);
    }
    else   if ([inObj.experience isEqualToString:@"2+ [Well Experienced]"])
    {
        for (int k=10; k<=14; k++)
        {
            dataDic=[pullFromDic objectAtIndex:k];
            NSLog(@"%@",dataDic);
        }

        NSLog(@"%@",dataDic);
    }
  // [self pullOPtions];
    [self splitArray];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (IBAction)page:(UIPageControl *)sender
{

    if (sender.currentPage==0)
    {

    }
    if (sender.currentPage==1) {

        NSLog(@"Hello second");
    }
    if (sender.currentPage==2)
    {
        NSLog(@"Hello Third");
    }
}

#pragma tableView
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    // return DataFromSource.count;
    return (nmA.count-1);
   // return 20;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

    static NSString *cellID=@"cell";
    UITableViewCell *cell=[tableView dequeueReusableCellWithIdentifier:cellID];
    if (!cell)
    {
        cell=[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:cellID];
        cell.textLabel.lineBreakMode = UILineBreakModeWordWrap;
        cell.textLabel.numberOfLines = 0;
    }
    // cell.textLabel.text=[DataFromSource objectAtIndex:indexPath.row];
    if (indexPath.section==0)
    {
        cell.textLabel.text=[pulledOptionArray1 objectAtIndex:indexPath.row];
    }
    else if (indexPath.section==1)
    {
        cell.textLabel.text=[pulledOptionArray2 objectAtIndex:indexPath.row];
    }
    else if (indexPath.section==2)
    {
        cell.textLabel.text=[pulledOptionArray3 objectAtIndex:indexPath.row];
    }
    else if (indexPath.section==3)
    {
        cell.textLabel.text=[pulledOptionArray4 objectAtIndex:indexPath.row];
    }
    else if (indexPath.section==4)
    {
        cell.textLabel.text=[pulledOptionArray5 objectAtIndex:indexPath.row];
    }
    return cell;
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return [nmA count];
}
/*- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section
{
    return [nmA objectAtIndex:section];
}*/
- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section
{
    UIView* customView = [[UIView alloc] init];
    UILabel * headerLabel = [[UILabel alloc] initWithFrame:CGRectZero];
    headerLabel.backgroundColor = [UIColor clearColor];
    headerLabel.opaque = YES;
    headerLabel.textColor = [UIColor whiteColor];

    headerLabel.highlightedTextColor = [UIColor whiteColor];

    headerLabel.shadowColor = [UIColor colorWithRed:0.0f/255.0f green:0.0f/255.0f blue:0.0f/255.0f alpha:0.25f];
    headerLabel.shadowOffset = CGSizeMake(0.0f, -1.0f);

    headerLabel.font = [UIFont boldSystemFontOfSize:16];
    headerLabel.frame = CGRectMake(10.0, 0.0, 232.0,40.0);

    headerLabel.numberOfLines=2;
    headerLabel.text=[nmA objectAtIndex:section];

    [customView setBackgroundColor:[UIColor colorWithRed:111.0f/255.0f green:168.0f/255.0f blue:220.0f/255.0f alpha:1.0]];
    [customView addSubview:headerLabel];

    return  customView;
}
-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath{
    NSLog(@"%d",indexPath.section);
    UITableViewCell *cell;

    switch (indexPath.section)
    {
        case 0:
            if (cell.accessoryType==UITableViewCellAccessoryCheckmark) {
                cell.accessoryType=UITableViewCellAccessoryNone;

            }
            else{
                cell.accessoryType=UITableViewCellAccessoryCheckmark;
                NSLog(@"%@",[pulledOptionArray1 objectAtIndex:indexPath.row]);
            }
            break;
        case 1:
            NSLog(@"%@",[pulledOptionArray2 objectAtIndex:indexPath.row]);
            break;
        case 2:
            NSLog(@"%@",[pulledOptionArray3 objectAtIndex:indexPath.row]);
            break;
        case 3:
            NSLog(@"%@",[pulledOptionArray4 objectAtIndex:indexPath.row]);
            break;
        case 4:
            NSLog(@"%@",[pulledOptionArray5 objectAtIndex:indexPath.row]);
            break;

        default:
            break;
    }

}
- (NSIndexPath*)tableView:(UITableView *)tableView willSelectRowAtIndexPath:(NSIndexPath*)indexPath {
    for ( NSIndexPath* selectedIndexPath in taBle.indexPathsForSelectedRows ) {
        if ( selectedIndexPath.section == indexPath.section )
            [taBle deselectRowAtIndexPath:selectedIndexPath animated:NO] ;
    }
    return indexPath ;
}
/*-(void)tableView:(UITableView *)tableView didDeselectRowAtIndexPath:(NSIndexPath *)indexPath
{
    [taBle cellForRowAtIndexPath:indexPath].accessoryType = UITableViewCellAccessoryNone;
}*/

#pragma table Row metrics
-(CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section
{
    return 60;
}
-(CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    return 40;
}
- (CGFloat)tableView:(UITableView *)tableView heightForFooterInSection:(NSInteger)section
{
    return 0;
}
- (UIFont *)fontForCell
    {
        return [UIFont boldSystemFontOfSize:18.0];
    }

-(void)splitArray
{
   // NSLog(@"%@",pulledOptionArray);
    for (int m=0; m<4; m++)
    {
        NSString *nic=[pulledOptionArray objectAtIndex:m];
        [pulledOptionArray1 addObject:nic];
    }
    for (int p=4; p<8; p++)
    {
        NSString *nic=[pulledOptionArray objectAtIndex:p];
        [pulledOptionArray2 addObject:nic];
    }
    for (int p=8; p<12; p++)
    {
        NSString *nic=[pulledOptionArray objectAtIndex:p];
        [pulledOptionArray3 addObject:nic];
    }
    for (int p=12; p<16; p++)
    {
        NSString *nic=[pulledOptionArray objectAtIndex:p];
        [pulledOptionArray4 addObject:nic];
    }
    for (int p=16; p<20; p++)
    {
        NSString *nic=[pulledOptionArray objectAtIndex:p];
        [pulledOptionArray5 addObject:nic];
    }
}
@end

  [1]: http://i.stack.imgur.com/JU0hi.png 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T19:06:36.003

因为`UITableViewCell`s 可以重复使用，所以您应该在选择 check in 之前取消设置该附件`cellForRowAtIndexPath:`。

```
cell.accessoryType = UITableViewCellAccessoryNone;
if([_selectedIndexPathArray containsObject:[_parsePlist getQuestionAnswer:[indexPath section] Row:[indexPath row]]]) {
     cell.accessoryType = UITableViewCellAccessoryCheckmark;
} 
```

# php - ajax 和可能的谷歌地图问题

> ID：14283830
> 
> 赞同：0
> 
> 时间：2013-01-11T17:48:35.323
> 
> 标签：php, html, ajax

这段代码使用 ajax 有什么问题？我正在尝试用 php 文件中的回显字符串替换 div 的内容，但它不起作用。我在网站上也有谷歌地图，这可能是问题，因为我可以让测试用例在其他文件中工作。如果谷歌地图是问题，我将如何将 ajax 与谷歌地图一起使用？

```
function update(){
var xmlhttp;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && (httpRequest.status == 200) || (httpRequest.status == 0))
    {
        document.getElementById("form").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","update.php", true);
xmlhttp.send(); 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T17:52:07.940

`httpRequest`没有在任何地方定义。你可能想要：

```
if (xmlhttp.readyState==4 && (xmlhttp.status == 200) || (xmlhttp.status == 0)) 
```

（提示：Chrome 的 JS 控制台非常适合调试。使用 View -> Developer -> JavaScript Console 菜单项打开。）

# android - 获取视图的背景可绘制对象

> ID：14283833
> 
> 赞同：7
> 
> 时间：2013-01-11T17:48:50.570
> 
> 标签：android, android-view

`getBackgound()`回报_`BitmapDrawable`

```
Log.d(null,"drawable: " + v.getBackground()); 
```

如何将drawable作为R.drawable.xxx？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T18:59:49.630

```
view.getBackgroundDrawable(); 
```

使用它来获取背景 drawable 。这将返回可绘制

编辑

这适用于**果冻豆**以下的版本，当现在编写此答案时，此方法在最新版本中已弃用

**新编辑**

对于 jellybean 之后的版本，请尝试

```
 view.getBackground() 
```

如果有人想比较可绘制对象，请遵循此[答案](https://stackoverflow.com/questions/27730731/get-current-background/27730795#27730795)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T18:36:42.517

View 类没有提供该方法，可以使用：

`myView.setBackgroundResource(int resId);` **接收要设置的drawable的ID**

但是这种方法没有getter，只有：

`myView.getBackgroundDrawable();` **返回视图中设置的可绘制对象。**

您可以扩展 View 以制作自己的 View，并覆盖 setBackgroundResource，将 ID 保存在辅助 var 中，然后调用 super 方法。定义一个 getter 以返回辅助 var，您将获得所需的功能。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-11T18:01:30.103

任何时候设置背景，在 Drawable 成员类中设置 R.drawable.pic。

```
v.setBackgroundDrawable(R.drawable.pic);
int myDrawable = R.drawable.pic; 
```

# php - 使用 Ajax 在 MySQL 中进行多次插入

> ID：14283841
> 
> 赞同：0
> 
> 时间：2013-01-11T17:49:41.470
> 
> 标签：php, ajax, multiple-insert

嘿伙计们，我在使用 PHP 和 Ajax 将我的值插入 MySQL 时遇到了麻烦。我正在尝试使用具有多个输入的单个按钮插入 MySQL。

JS：

```
 $('#save_grade_button').click(function (){

              var B_grade = [];
              var G_grade = [];

               $.each($("input[id^='student_grde_B']"), function(i, item) {

                 var grade_B =  $(item).val();

                 var stud_id_B = $(item).attr('rel');

                 B_grade.push({"studnt_B_id":stud_id_B,"studnt_grade_B":grade_B});

                     });

                  $.each($("input[id^='student_grde_G']"), function(i, item) {

                       var grade_G =  $(item).val();

                       var stud_id_G = $(item).attr('rel');

                         G_grade.push({"studnt_G_id":stud_id_G,"studnt_grade_G":grade_G});
                     });

                     subjct_id =  $('#subjects-list').val();
                      year_grade_level  = $('#year_grade_lvl').val();
                      sbjct_handler_id = $('#assign-handler-id').val();

                      $.ajax({

                          type:'POST',
                          url:'grades.php',
                          dataType:'json',
                          data:{'swtch_numbr':'1','subject_id':subjct_id,'year_level':year_grade_level,'subject_handler_id':sbjct_handler_id,'student_grades_boy':B_grade,'student_grades_girl':G_grade},
                          success:function (data){

                          }
                      });

                }); 
```

PHP：

```
<?php
include_once('DBconnect.php'); 

$switch_num = $_POST['swtch_numbr'];

switch ($switch_num) {
    case 1:         
        save_grades();
        break;

}
function save_grades(){
    session_start();

    $school_id = $_SESSION['school_id'];
    $faculty_id = $_SESSION['user_id_fac'];
    $subject_id = $_POST['subject_id'];
    $year_grade_level = $_POST['year_level'];
    $subject_handeler_id = $_POST['subject_handler_id'];
    $student_grades_boy = $_POST['student_grades_boy'];
    $student_grades_girl = $_POST['student_grades_girl'];

    $save_grades_boy = "INSERT INTO registrar_grade_archive 
                                    (registrar_archive_id,
                                    school_id,
                                     subject_id,
                                     grade,
                                     advisory_faculty_id,
                                     subject_handler_id,
                                     year_level,
                                     student_id) VALUES";

                    $values_boy = array();
                    $values_girl = array();

                    foreach ($student_grades_boy as $key=>$data) {
                                $student_id_B= $data['studnt_B_id'];
                                $grade_B = $data['studnt_grade_B'];

    $values_boy[$key] = '(\''.$school_id.'\', \''.$subject_id.'\',\''.$grade_B.'\',\''.$faculty_id.'\',\''.$subject_handeler_id.'\',\''.$year_grade_level.'\',\''.$student_id_B.'\')';
                            }

        $values_boy = implode(', ', $values_boy);

    $ready_save_grades_boy .= $values_boy;

                    if(@!mysql_query($ready_save_grades_boy)){
                        die('error insert'.mysql_error());

                        }

} 
```

?>

但是当我检查萤火虫时出现错误说“您的 SQL 语法有错误；”

我找不到我做错了什么。请帮助，伙计们，因为我只是 Ajax 和 PHP 的新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:56:30.457

看起来您开始将 SQL 存储在变量 $save_grades_boy 中，然后尝试将这些值连接到 $ready_save_grades_boy 尚不存在，因此被视为空字符串。

代替

```
$ready_save_grades_boy .= $values_boy; 
```

和

```
$save_grades_boy .= $values_boy; 
```

或者

```
$ready_save_grades_boy = $save_grades_boy . $values_boy; 
```

# javascript - 通过 chrome 扩展在 facebook 上分享

> ID：14283842
> 
> 赞同：2
> 
> 时间：2013-01-11T17:49:44.390
> 
> 标签：javascript, facebook, facebook-graph-api, google-chrome-extension

我想通过 chrome 扩展在 facebook 墙上分享当前打开的标签 url。为此，我之前使用的是[https://facebook.com/share.php](https://facebook.com/share.php)，它首先给了我登录选项，然后是分享框。

由于 facebook 已弃用此方法，我如何通过 chrome 扩展在我的墙上发布/分享？FB.api 是另一种选择，但为此我可能必须先通过 facebook 进行身份验证。如何从 chrome 扩展中实现这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T18:27:48.780

您可以使用提要对话框，[在此处找到更多详细信息](http://developers.facebook.com/docs/reference/dialogs/feed/)

这是直接网址

```
https://www.facebook.com/dialog/feed?
  app_id=458358780877780&
  link=https://developers.facebook.com/docs/reference/dialogs/&
  picture=http://fbrell.com/f8.jpg&
  name=Facebook%20Dialogs&
  caption=Reference%20Documentation&
  description=Using%20Dialogs%20to%20interact%20with%20users.&
  redirect_uri=https://mighty-lowlands-6381.herokuapp.com/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-12-03T06:43:48.057

接受的答案对我不起作用。

## 找到另一种在 facebook ( [jsfiddle](https://jsfiddle.net/terales/tLLu5uaj/) ) 上分享的方式：

```
https://www.facebook.com/sharer/sharer.php?u={url} 
```

有一个生成分享对话框的工具：[https](https://apps.lazza.dk/facebook/) ://apps.lazza.dk/facebook/ （© [Has Facebook sharer.php 已更改为不再接受详细参数？](https://stackoverflow.com/questions/20956229/has-facebook-sharer-php-changed-to-no-longer-accept-detailed-parameters)），这是一个逆向工程示例：

```
https://www.facebook.com/sharer/sharer.php
?u=${url}
&picture=${pictureUrl}
&title=${title}
&caption=${caption}
&quote=${quote}
&description=${description} 
```

### 此链接生成这样的共享对话框：

[![与报价共享](../Images/fdd8629a84cf4c7670ac2602fd8a81d2.png)](https://i.stack.imgur.com/iEHLs.png)

### 为了更大的图景，我们应该省略引用：

[![大图分享](../Images/a40ed0e369b899f7b17103a5c96a5d75.png)](https://i.stack.imgur.com/srW5O.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-26T21:10:57.787

这是另一种方法：创建一个书签并将名称设置为“在 Facebook 上共享”，并将 URL 设置为：

```
javascript:var d=document,f='http://www.facebook.com/share',l=d.location,e=encodeURIComponent,p='.php?src=bm&v=4&i=1274665734&u='+e(l.href)+'&t='+e(d.title);1;try{if (!/^(.*\.)?facebook\.[^.]*$/.test(l.host))throw(0);share_internal_bookmarklet(p)}catch(z) {a=function() {if (!window.open(f+'r'+p,'sharer','toolbar=0,status=0,resizable=1,width=626,height=436'))l.href=f+p};if (/Firefox/.test(navigator.userAgent))setTimeout(a,0);else{a()}}void(0) 
```

注意：这种方法不是我发明的，也不记得从哪里得到的，但它对 Chrome 和 Firefox 都有效。（我没有在其他浏览器上尝试过。）

编辑：我找到了原始来源：[https](https://www.facebook.com/share_options.php) ://www.facebook.com/share_options.php 在此页面上，只需将“在 Facebook 上共享”图标拖到您的书签栏。

# asp.net-mvc-3 - 在 ASP.NET MVC 中编译视图是好习惯吗？

> ID：14283848
> 
> 赞同：2
> 
> 时间：2013-01-11T17:50:12.863
> 
> 标签：asp.net-mvc-3, razor, compilation

在 ASP.NET MVC 中，您可以通过将项目文件中的以下键设置为 true 来启用视图编译：

```
<MvcBuildViews>true</MvcBuildViews> 
```

然后，每当您编译解决方案时，您的视图也会被编译，这很棒，因为它允许您在编译时而不是运行时查找错误。这在重构时特别有用，因为可能会错过重命名的属性或视图中更改的命名空间。

我只能看到好处，所以为什么这个选项不仅默认设置，而且在 Visual Studio 2010 UI 中甚至不可用，并且通常需要对您的配置进行一些额外的更改，如此处所述：http: [//odetocode.com/blogs /scott/archive/2011/02/16/notes-on-building-razor-views.aspx](http://odetocode.com/blogs/scott/archive/2011/02/16/notes-on-building-razor-views.aspx)

编译 ASP.NET MVC 视图有什么合理的缺点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T21:39:35.460

我不会说这是“好做法”，也不是“坏做法”。它只是您工具箱中的另一个工具。

默认情况下未启用它的原因是，虽然小型项目还可以......它很快变得非常慢，中型到大型项目需要几分钟。

此外，它只捕获特定类型的错误。所以不要在所有事情上都依赖它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T21:13:45.383

假设这类似于在 Web 表单项目中预编译页面。是的，这样做会有很多好处，因为它会使应用程序性能更好，因为当用户访问视图时不必编译视图。

但是，这会使较小的更改变得更加困难；我遇到了您必须对代码进行小幅更改的情况。如果您必须重新部署，它可能会回收应用程序并迫使用户失去工作。老实说，我使用此类功能的大部分时间都是使用 Web 表单，但过程应该是相似的。

它也使部署变得更加困难，但我并不认为这是一个骗局，因为部署并不频繁。

# iphone - UIAlertView 带有文本的多个按钮

> ID：14283857
> 
> 赞同：5
> 
> 时间：2013-01-11T17:50:38.710
> 
> 标签：iphone, xcode, button, alertview

我有一个带有 3 个按钮和文本（标签而不是文本视图）的警报视图，如果我将它们全部塞在一起，那么这个微小的滚动文本会变得难看，所有按钮都占据了大部分空间。有谁知道如何解决这一问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-11T17:54:19.223

你为什么不尝试为此创建一个自定义视图。

您可以根据需要使用自定义、大小、颜色、背景等。

并将其显示为模态窗口/视图。

* * *

如果您仍想使用 alertView 那么您可以将间距设置为：

```
UIAlertView *alert=[[UIAlertView alloc]initWithTitle:@"Title" message:@"\n\n!\n\n\n\n" delegate:self cancelButtonTitle:@"Button 1" otherButtonTitles:@"Button 2",@"Button 3", nil];
[alert show]; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-11T18:04:42.997

向下移动文本视图的一种简单方法是添加一条消息

```
[alertViewObject setMessage:@"\n"]; 
```

你的框架没有生效的原因是 -show 在开始动画之前设置框架并创建视图层次结构。您还应该使文本视图成为第一响应者，以便弹出键盘。

使用以下代码自定义您的 AlertView。

```
// Customize Alert View
UIAlertView *alertView = [UIAlertView new];
alertView.title = @"Alert Title";

// Adding Your Buttons
[alertView addButtonWithTitle:@"Button1"];
[alertView addButtonWithTitle:@"Button2"];
[alertView addButtonWithTitle:@"Button3"];
[alertView addButtonWithTitle:@"Button4"];

// Add a Space for Text View
alertView.message = @"\n";

// View heirarchy, set its frame and begin bounce animation
[alertView show];

// Set the frame
CGRect frame = alertView.frame;
frame.origin.y -= 100.0f;
alertView.frame = frame;

// Adding TextField
UITextField* text = [[UITextField alloc] initWithFrame:CGRectMake(20.0, 45.0, 245.0, 25.0)];
text.borderStyle = UITextBorderStyleRoundedRect;
[alertView addSubview:text];
[text becomeFirstResponder]; 
```

我希望这能帮到您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T17:57:34.903

我建议你制作两个 uiaertviews 然后使用

```
 - (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex 
```

检查单击了哪个警报视图。如果您真的需要 uialertview，否则下面的答案也很棒。

详细的：

1.  将 uialertview 委托添加到您的视图控制器：

    ```
    @interface ViewController : UIViewController <UIAlertViewDelegate> 
    ```

2.  创建 2 个 alertView 时，它应该如下所示：

    ```
    UIAlertView *alert1 = [[UIAlertView alloc] initWithTitle:@"Message" message:@"the first UIAlertView" delegate: self cancelButtonTitle:@"Back" otherButtonTitle:@"More Options", nil]; 
    ```

第二个：

```
 UIAlertView *alert2 = [[UIAlertView alloc] initWithTitle:@"More Options" message:nil delegate:self cancelButtonTitle:@"Back" otherButtonTitle:@"Option 1", @"Option 2", @"Option 3", nil]; 
```

1.  在您的 ViewController.m 添加：

    ```
    - (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex

    if (alertView == alert1) {
      [alert2 show];
    }

    else if (alertView == alert2) {        

    NSString *string = [alertView buttonTitleAtIndex:buttonIndex];

    if ([string isEqualToString:@"Option 1"]) {

        //Do stuff

    }
    else if ([string isEqualToString:@"Option 2"]) {

        //Do something else
    }
    else if ([string isEqualToString:@"Option 3"]) {

        //Do something 3rd
    }
    } 
    ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-22T16:18:30.930

UIAlertView 在 iOS 9.0 中已被弃用。改用 UIAlertController 和 UIAlertControllerStyleAlert 的preferredStyle。

```
 let alertController = UIAlertController(title: nil, message: nil, preferredStyle: .actionSheet)

    alertController.addAction(UIAlertAction(title: "AlertAction 0", style: .default, handler: { (alertAction: UIAlertAction) in
        print("0")
    }))

    alertController.addAction(UIAlertAction(title: "AlertAction 1", style: .default, handler: { (alertAction: UIAlertAction) in
        print("1")
    }))

    alertController.addAction(UIAlertAction(title: "Cancel", style: .cancel, handler: { (alertAction: UIAlertAction) in
        print("cancel")
    })) 
```

# facebook - Facebook 电子邮件权限

> ID：14283865
> 
> 赞同：0
> 
> 时间：2013-01-11T17:51:04.387
> 
> 标签：facebook, email, permissions

我们正在为 facebook 做一个应用程序，我们被请求获取他的信息，

现在的问题是我们需要`user e-mail id`在我们的数据或控制台中显示。（向用户显示所有详细信息，如 First_name、last_name、gender、education、id 等。）

我们使用这个代码：

```
else
{
    NSArray* _permissions = [NSArray arrayWithObjects:@"email",@"user_birthday",@"publish_stream",nil];
    [appDelegate.Facebook  authorize:_permissions delegate:self appAuth:NO safariAuth:NO];
} 
```

现在还有其他方法可以显示电子邮件吗？我应该怎么办？

# sql - SQL 2008 blob 数据未使用空间无法释放

> ID：14283866
> 
> 赞同：2
> 
> 时间：2013-01-11T17:51:05.513
> 
> 标签：sql, sql-server, blob, space

环境：SQL Server 2008 spk1 企业版。

我有一个存储`varbinary`和`blob`数据的大表。如果我在 SSMS 中运行磁盘使用报告，我们会看到数据库中大约三分之一的空间（此应用程序有数百个）显示为“未使用空间”（我不是指未分配的空间。）

我在互联网上遇到了许多不起作用的解决方案。

*   `dbcc cleantable`
*   删除聚集索引并重建它
*   重建所有索引

如果我`select * into`是另一个表，它会重建表而没有所有额外的麻烦。

如果我运行：

```
SELECT alloc_unit_type_desc, avg_page_space_used_in_percent, record_count,
ghost_record_count FROM sys.dm_db_index_physical_stats
(DB_ID(N'Test_dbname'), OBJECT_ID(N'table_name'), NULL, NULL , 'DETAILED'); 
```

我收到：

```
alloc_unit_type_desc avg_page_space_used_in_percent record_count ghost_record_count
IN_ROW_DATA          66.7239065974796               12404285     0
IN_ROW_DATA          0.850741289844334              333460       0
IN_ROW_DATA          44.903076352854                80002        0
IN_ROW_DATA          78.5273041759328               374          0
LOB_DATA             64.0441438102298               62248788     0 
```

我相信这表明分配了大量空间。问题是为什么我不能减少这个空间？在数百个数据库的过程中，我们谈论的是 TB 的浪费空间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T18:03:51.497

把它想象成一个文件系统。选择到另一个表中，希望将使用的数据写入 mdb 中的连续块中。然后你在这里和那里更改一些 blob，DBMS 非常明智地希望保持每个 blob 连续......

所以即使有一个命令来整理桌子，它基本上会做你现在正在做的事情，其他任何事情都会要求它。

真正的答案是不要使用 RDBMS 来存储此类数据。

# php - CodeIgniter 分页未显示应显示的所有行

> ID：14283867
> 
> 赞同：0
> 
> 时间：2013-01-11T17:51:07.007
> 
> 标签：php, codeigniter, pagination

好的，过去一个小时我一直在做这件事，我一生都无法弄清楚这一点。它说的是 LIMIT 2, 25 .. 这当然是跳过了应该显示的两行...我还在第 1 页上，链接甚至都不显示！第一页，我认为需要为 0、25，因为它显示了应该在第一页上显示的所有行。

现在我到目前为止只有 5 行，但它只显示了其中的 3 行……在我添加 LIMIT 子句之前，不会显示查询最初生成的前两行。这是我在编程方面的明智之处：

```
 public function category($id, $page = NULL) {
    //grab topics
    parent::before();
    $data['forum_title'] = $this->forum->get_cat($id);
    $data['id'] = $id;

    $config = array();
    $config['base_url'] = base_url() . 'forum/category/';
    $config['total_rows'] = $this->forum->topic_count($id);
    $config['per_page'] = 25;
    $config['uri_segment'] = 4;

    $this->pagination->initialize($config);

    $page = ($this->uri->segment(3)) ? $this->uri->segment(3) : 0;
    $data['topics_array'] = $this->forum->get_topics($id, $config['per_page'], $page);

    $data['links'] = $this->pagination->create_links();
    $this->load->view('forum/category', $data);
    parent::after();
} 
```

我承认我不理解 URI_SEGMENT 的考验。我有点理解，但不是真的。我正在按照教程来生成它。但是我打印了我的 $limit 和 $start 变量，并且限制是 25 应该是这样，但是开始打印为 2.. 当我认为它应该在第一页上为 0 时。甚至不应该有第二页，因为还没有 25 个结果。

这是我生成这些的函数。count_all_results() 函数有效（返回总共 5 个结果）。但是，每当我添加 LIMIT 子句时，get_topics() 函数就无法正常工作。

```
//count the topics in a certain category id for pagination
public function topic_count($id) {
    $this->db->where('cat_id', $id);
    $this->db->from('forum_topic');

    return $this->db->count_all_results();

}
//get all topics in a certain category
public function get_topics($id, $limit, $start) {
    $this->db->distinct();
    $this->db->select('t.id, t.title, t.sticky, t.locked, u.username as author, COUNT(p.id) as postcount, (SELECT u.username
        FROM forum_post fp
        INNER JOIN user u ON fp.author_id = u.user_id
        WHERE fp.topic_id = t.id
        ORDER BY fp.date DESC
        LIMIT 1) as lposter, (SELECT fp.date
        FROM forum_post fp
        WHERE fp.topic_id = t.id
        ORDER BY fp.date DESC
        LIMIT 1) as lastdate');
    $this->db->from('forum_topic t');
    $this->db->join('user u', 'u.user_id = t.author_id', 'inner');
    $this->db->join('forum_post p', 'p.topic_id = t.id', 'inner');
    $this->db->where('t.cat_id', $id);
    $this->db->group_by('t.id, t.title, t.sticky, t.locked, author, lposter, lastdate');
    $this->db->order_by('t.sticky desc, p.date desc');
    $this->db->limit($limit, $start);
    return $this->db->get()->result();
} 
```

我现在的网址是 forum/category/2... 所以我假设页面会这样：第 1 页的 forum/category/2/1，第 2 页的 forum/category/2/2，等等对吗？？所以我把 4 作为 URI 段，因为它在第 4 个参数位置。

任何帮助将非常感激...

**编辑TTTTTTTT**

好的，有人帮我解决了这个问题。但是，当我单击第 2 页时（我现在将限制降低到 5，并且当前有 7 个结果，因此它生成了第 2 页......它将 ID 2（类别 ID 为 2）替换为 5.. 而不是去到第 2 页??....第 2 页应该是这样的：forum/category/2/2... 但它却是这样的：forum/category/5

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T17:59:46.527

您正在使用 2 个不同的 URI 段。您正在使用 4 初始化分页对象，然后将段 3 发送到`get_topics()`（因为`$this->uri->segment(3)`）。您可能应该对两者都使用 3，因为 URI 段从 0 而不是 1 开始。

无论哪种方式，无论您使用 3 还是 4，都应该在两个地方使用相同的一个。使用`$this->uri->segment($config['uri_segment'])`而不是`$this->uri->segment(3)`.

# visual-studio-2010 - 如何在 C# 中为 Excel2010 加载项中的功能区刷新图像显示？

> ID：14283868
> 
> 赞同：1
> 
> 时间：2013-01-11T17:51:08.210
> 
> 标签：visual-studio-2010, c#-4.0, add-in, ribbon, excel-2010

我有一个带有图像的下拉功能区控件。每次单击此下拉控件旁边的按钮（称为生成）时，我都想旋转图像。除了训练，没有真正的目标。

我目前正在使用此代码来执行此操作：

```
private void buttonGenerate_Click(object sender, RibbonControlEventArgs e)
{
    dropDown1.Image.RotateFlip(System.Drawing.RotateFlipType.Rotate90FlipNone);
    dropDown1.Visible = false;
    dropDown1.Visible = true;
} 
```

它有效，但我正在寻找一种“更清洁”的方式来刷新图像。将 Visible 设置为 false 然后设置为 true 似乎不是最好的方法。我一直在尝试一些属性，但到目前为止没有一个能够刷新图像显示。

我想我错过了正确的属性来做到这一点。

谢谢你的帮助，

科伦廷

# ajax - JSF 2 + Richfaces 4.2.3 - 如果 在里面

> ID：14283870
> 
> 赞同：1
> 
> 时间：2013-01-11T17:51:30.563
> 
> 标签：ajax, jsf, richfaces, seam2

我在使用 ah:form 中的 a4j:ajax 标记时遇到了问题，其中有rich:pickList 或rich:orderingList 以相同的形式存在。发生的情况是 ajax 请求未完成，并且我的支持 bean 中的侦听器方法未触发。引发了 onbegin 事件，但未引发 oncomplete。这真的很奇怪。

如果我将组件更改为 Rich:select 或其他类似组件，则 ajax 可以正常工作。

这是我的代码的一部分。

```
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <ui:composition xmlns="http://www.w3.org/1999/xhtml"
        xmlns:s="http://jboss.org/schema/seam/taglib"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:a="http://richfaces.org/a4j"
        xmlns:rich="http://richfaces.org/rich" 
        xmlns:a4j="http://richfaces.org/a4j" 
        template="layout/template.xhtml">
        <ui:define name="body">
            <h:form id="perfil" styleClass="edit">
                <rich:panel>

                        <a4j:outputPanel id="outputPanel">
                    <s:decorate id="nomeField" template="layout/edit.xhtml">
                        <ui:define name="label">Nome</ui:define>
                        <h:inputText id="nome" size="100" maxlength="100"
                            value="#{perfilHome.instance.nome}">
                            <a4j:ajax event="blur" onbegin="alert('begin');"
                                oncomplete="alert('complete');" bypassUpdates="true" render="outputPanel" 
                                listener="#{perfilHome.test()}" />
                        </h:inputText>
                    </s:decorate>
                </a4j:outputPanel>
                    <s:decorate id="descricaoField" template="layout/edit.xhtml">
                        <ui:define name="label">Descrição</ui:define>
                        <h:inputTextarea id="descricao" required="true" cols="100" rows="4" value="#{perfilHome.instance.descricao}" />
                    </s:decorate>
    <s:decorate id="permissoesField" template="layout/edit.xhtml">          
                     <rich:pickList required="true" styleClass="picklist" style="border: none; background: transparent;" 
                        collectionType="java.util.ArrayList" immediate="false" 
                        id="permissaoPickList" 
                        value="#{perfilHome.instance.permissoes}"
                        listWidth="165px" listHeight="100px" orderable="true">
                        <f:selectItems id="permissoesItens" value="#{perfilHome.listarPermissoes()}" var="permissao"
                            itemValue="#{permissao}" itemLabel="#{permissao.nome}" />
                        <s:convertEntity />
                    </rich:pickList>                                
                </s:decorate>                               </rich:panel>
                <div class="actionButtons">
                    <h:commandButton id="save" value="Salvar"
                        action="#{perfilHome.persist}" disabled="#{!perfilHome.wired}"
                        rendered="#{!perfilHome.managed}">
                        <s:conversationId />
                    </h:commandButton>
                    <h:commandButton id="update" value="Salvar"
                        action="#{perfilHome.update}" rendered="#{perfilHome.managed}">
                        <s:conversationId />
                    </h:commandButton>
                    <h:commandButton id="delete" value="Deletar"
                        action="#{perfilHome.remove}" immediate="true"
                        rendered="#{perfilHome.managed}" />                                 </div>
            </h:form>
<s:button id="cancelEdit" value="Cancelar" propagation="end"
                        view="/Perfil.xhtml" rendered="#{perfilHome.managed}" />
                    <s:button id="cancelAdd" value="Cancelar" propagation="end"
                        view="/#{empty perfilFrom ? 'PerfilList' : perfilFrom}.xhtml"
                        rendered="#{!perfilHome.managed}" />
        </ui:define>
    </ui:composition> 
```

正如我所说，我只使用pickList 和orderingList 观察到了这种行为。有没有人遇到过这样的问题？

我的第二个问题是，如果我将两个 s:buttons 都放在表单中，ajax 也不会被触发。对此有解释吗？

我正在使用 JSF 2.1.14 + RichFaces 4.2.3 + Seam 2.3.0

谢谢

2013 年 1 月 14 日更新。观察到我以前没有注意到的堆栈跟踪。我认为视图状态正在丢失。用许多组件再次测试，只注意到pickList和orderingList的问题。

```
Exception during request processing:
Caused by java.lang.NullPointerException with message: ""

com.sun.faces.context.PartialViewContextImpl.createPartialResponseWriter(PartialViewContextImpl.java:441)
com.sun.faces.context.PartialViewContextImpl.access$300(PartialViewContextImpl.java:71)
com.sun.faces.context.PartialViewContextImpl$DelayedInitPartialResponseWriter.getWrapped(PartialViewContextImpl.java:582)
javax.faces.context.PartialResponseWriter.startDocument(PartialResponseWriter.java:115)
com.sun.faces.context.AjaxExceptionHandlerImpl.handlePartialResponseError(AjaxExceptionHandlerImpl.java:199)
com.sun.faces.context.AjaxExceptionHandlerImpl.handle(AjaxExceptionHandlerImpl.java:123)
com.sun.faces.lifecycle.Phase.doPhase(Phase.java:119)
com.sun.faces.lifecycle.RestoreViewPhase.doPhase(RestoreViewPhase.java:116)
com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:329)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248)
org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:83)
org.jboss.seam.web.LoggingFilter.doFilter(LoggingFilter.java:60)
org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69)
org.jboss.seam.web.IdentityFilter.doFilter(IdentityFilter.java:40)
org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69)
org.jboss.seam.web.MultipartFilter.doFilter(MultipartFilter.java:90)
org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69)
org.jboss.seam.web.ExceptionFilter.doFilter(ExceptionFilter.java:64)
org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69)
org.jboss.seam.web.RedirectFilter.doFilter(RedirectFilter.java:45)
org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69)
org.jboss.seam.web.HotDeployFilter.doFilter(HotDeployFilter.java:53)
org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69)
org.jboss.seam.servlet.SeamFilter.doFilter(SeamFilter.java:158)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:280)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248)
org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:275)
org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:161)
org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:397)
org.jboss.as.jpa.interceptor.WebNonTxEmCloserValve.invoke(WebNonTxEmCloserValve.java:50)
org.jboss.as.web.security.SecurityContextAssociationValve.invoke(SecurityContextAssociationValve.java:153)
org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:155)
org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:368)
org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:877)
org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:671)
org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:930)
java.lang.Thread.run(Thread.java:722) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T19:26:12.697

很可能您`<rich:pickList/>`的转换失败，导致整个表单提交阻塞，原因很明显：您没有在列表中定义转换器并且您正在尝试将复杂类型更新为支持 bean。除非您的`value`绑定是常规 java 类型而不是 pojo，否则您必须在`<f:selectItems/>`. 尝试通过`<h:messages/>`在视图中放置一个以显示验证/转换错误来确认这一点

这也是为什么建议将 JSF 组件分割成更小的形式而不是你现在拥有的巨大形式的一个很好的理由；使用更小的表单更容易调试

# mysql - 如果存在则更新，否则插入，但具有非唯一列

> ID：14283872
> 
> 赞同：2
> 
> 时间：2013-01-11T17:51:40.660
> 
> 标签：mysql, sql-update, on-duplicate-key

我知道`ON DUPLICATE KEY UPDATE`当我想更新一行（如果存在）或插入时，我可以使用“”。但就我而言，我想根据非唯一键进行更新。

**例如：**我有一个包含 3 列的表：A、B 和 C。它们共同构成唯一键。
现在，如果 B 和 C 的值匹配，我想更新该行，否则插入一个新行。

这可以在没有多个查询的情况下在 MySQL 中完成。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T19:51:15.870

如果有唯一键，您可以使用 REPLACE INTO。如果您没有这些唯一值，则需要使用两个查询。查询 1 是更新的选择，查询 2 是更新（如果返回的行数 > 0）或插入（如果没有返回行）

# php - 使用多个条目 MySQL 和 PHP 选择一次值

> ID：14283875
> 
> 赞同：0
> 
> 时间：2013-01-11T17:51:52.750
> 
> 标签：php, mysql, select

用户可以创建允许其他用户注册的表单。因此，如果用户创建表单，他也可以在该表单上注册。

说我有以下表格

```
//Form 
id | title  | entry             | userid
1     test     entry for form        1

//form_register - Allows users to register for a particular form, form_id references form.id
form_id | userid
   1        1
   1        1
   1        2
   1        2 
```

现在，假设我想为用户创建并注册的表单生成一个列表。用户可以多次注册同一个表单，但我只想显示一次表单。我不想要用户每次注册的列表，只需要他们注册的表单列表，而不是实际注册。

**如果用户创建一个表单，然后注册同一个表单 2 次我只希望表单信息显示 1 次。我当前的查询显示表单信息 3 次（1 次用于创建，2 次用于注册）。**

```
 SELECT form.*, form_register.* FROM forms
    INNER JOIN form_register on form_regiseter.form_id = form.id
    WHERE form_register.userid = '$userid' 
```

当此查询为用户 1 运行时，它会生成以下内容

```
Title  
test
test
test 
```

我只希望它像这样显示一次表单

```
Title
test 
```

对于 userid2 这将是输出

```
Title
test
test 
```

我希望它是

```
Title
test 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:53:55.680

使用`DISTINCT`or`GROUP BY`获取唯一行。

或者，您也可以`form_register`通过应用`UNIQUE`-index 来禁止表中的重复条目。您可以将`INSERT`查询重写为`REPLACE`查询，并且您永远不会得到重复的行。

`REPLACE`如果它不存在则将`INSERT`一行，如果存在则替换它（基于`PRIMARY KEY`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T17:54:20.170

```
SELECT DISTINCT form.*, form_register.* FROM forms
    INNER JOIN form_register on form_regiseter.form_id = form.id
    WHERE form_register.userid = '$userid' 
```

可能是你要找的

# scalatest - 如何使用 ScalaMock 代理模拟？

> ID：14283879
> 
> 赞同：5
> 
> 时间：2013-01-11T17:52:03.280
> 
> 标签：scalatest

我有一个非常简单的测试，我正在尝试模拟一个特征。测试甚至没有运行，它失败并出现初始化错误：**java.lang.IllegalArgumentException：需求失败：你记得使用 withExpectations 吗？**

这是我非常简单的测试：

```
import org.scalatest._
import org.junit.runner.RunWith
import org.scalatest.junit.JUnitRunner
import org.scalatest.matchers.ShouldMatchers
import org.scalamock.ProxyMockFactory
import org.scalamock.scalatest.MockFactory

@RunWith(classOf[JUnitRunner])
class TurtleSpec extends FunSpec with MockFactory with ProxyMockFactory {
  trait Turtle {
    def turn(angle: Double)
  }

  val m = mock[Turtle]
  m expects 'turn withArgs (10.0)

  describe("A turtle-tester") {
    it("should test the turtle") {
      m.turn(10.0)
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-25T15:51:20.620

您需要在运行测试之前调用 resetMocks / resetExpectations，最好的方法是（ScalaTest 方式）：

```
class TurtleSpec extends FunSpec with MockFactory with ProxyMockFactory with BeforeAndAfter {

  before {
    resetMocks()
    resetExpectations()
  }

  ...
} 
```

# ios - krooshal.com + build.phonegap.com = 没有 Info.plist

> ID：14283892
> 
> 赞同：0
> 
> 时间：2013-01-11T17:53:00.260
> 
> 标签：ios, cordova, phonegap-plugins

当我尝试从 Adob​​e“ [build.phonegap.com ”将应用程序上传到](http://build.phonegap.com)[Krooshal](https://www.krooshal.com/)时，不是 Phonegap 应用程序，而是来自他们的构建服务的应用程序。在 Krooshal 中创建新应用时出现此错误：

`Unable to find Info.plist`

我假设 Adob​​e 构建服务不包含这个文件，因为我不是一个客观的 c 开发人员，我不确定这个文件是做什么的，或者是否有办法在我发送到构建之前手动将它包含在我的**WWW**文件夹中服务。

提前感谢您的帮助！

~红色

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T18:40:51.853

在 build.phonegap.com 生成的 plist 中，似乎没有填充 CFBundleShortVersionString，而 CFBundleVersion 是。[CFBundleShortVersionString 代表发布，而 CFBundleVersion 代表任何构建](https://stackoverflow.com/a/6881469/1480400)。[Krooshal](https://www.krooshal.com)现在支持这两个属性。

# android - 单击微调器菜单项不会显示微调器列表

> ID：14283894
> 
> 赞同：1
> 
> 时间：2013-01-11T17:53:05.473
> 
> 标签：android, menu, spinner, android-actionbar, menuitem

我有一个带有微调器布局的菜单项，它正确显示在我的操作栏菜单中。但是，当我单击微调器时，什么也没有发生。我在 onOptionsItemSelected 中有日志消息，但在 logcat 中没有看到任何消息。以下是我的代码片段：

菜单布局

```
<menu xmlns:android="http://schemas.android.com/apk/res/android" >
    <item android:id="@+id/menu_item_1"
          android:orderInCategory="100"
          android:showAsAction="always"
          android:actionLayout="@layout/spinner_layout"  />
</menu> 
```

微调器布局

```
<?xml version="1.0" encoding="utf-8"?>
<Spinner xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" 
    android:background="@drawable/spinner_drawable">
</Spinner> 
```

MainActivity.java

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    spinner = (Spinner) menu.findItem(R.id.menu_item_1).getActionView();

    MySpinnerAdapter spinnerAdapter = new MySpinnerAdapter(this);
    spinner.setAdapter(spinnerAdapter);
    spinner.setOnItemSelectedListener(spinnerAdapter);
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    log.error("ON OPTIONS ITEM SELECTED FOR ITEM: " + item.getItemId());

    switch (item.getItemId()) 
    {
        case R.id.menu_item_1:
            log.error("ON OPTIONS ITEM SELECTED - SPINNER MENU ITEM SELECTED");
            return true;
        default:
            return super.onOptionsItemSelected(item);
    }
} 
```

MySpinnerAdapter.java

@Singleton 公共类 MySpinnerAdapter 扩展 ArrayAdapter 实现 SpinnerAdapter，OnItemSelectedListener{

```
@Inject
public TopbarErrorSpinnerAdapter(Context context) {
    super(context, R.layout.my_spinner_item);
    this.values = Collections.synchronizedList(new ArrayList<MySpinnerRowEntry>());
    this.context = context;
    this.setDropDownViewResource(R.layout.my_spinner_item);
}

@Override
public int getCount() {
    return values.size();
}

@Override
public MySpinnerRowEntry getItem(int position) {
    return values.get(position);
}

@Override
public long getItemId(int position) {
    return position;
}

@Override
public View getView(int position, View view, ViewGroup viewGroup) {

    View row = View.inflate(context, R.layout.my_spinner_item, null);
    ImageView image = (ImageView) row.findViewById(R.id.my_spinner_item_icon);

    return image;
}

@Override
public View getDropDownView(int position, View convertView, ViewGroup parent) {

    final int rowPosition = position;

    View row = View.inflate(context, R.layout.my_spinner_item, null);

    TextView title = (TextView) row.findViewById(R.id.my_spinner_item_title);
    title.setText(values.get(position).getTitle());

    TextView message = (TextView) row.findViewById(R.id.my_spinner_item_message);
    message.setText(values.get(position).getMessage());

    row.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            mySpinnerAdapterlistener.mySpinnerItemSelected(values.get(rowPosition).getType());
        }
    });

    return row;
}

@Override
public void onItemSelected(AdapterView<?> parent, View view, int position, long id) {
    MainActivity activity = (MainActivity) context;
    (activity).onOptionsItemSelected((MenuItem) activity.findViewById(R.id.menu_item_1));
}

@Override
public void onNothingSelected(AdapterView<?> parent) {

} 
```

}

如果选择的菜单项是微调器，我也不确定如何触发微调器。我在以前的不包含 ActionBar 的活动中使用了相同的微调器。由于升级到 SDK 14 后我的应用程序发生了变化，我知道必须将微调器添加到 ActionBar 的菜单中。

提前感谢大家的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T19:34:58.353

我已经设法使用 ActionProvider 解决了我的问题。我必须在 xml 代码中为菜单项定义一个 ActionProvider，并实现提供程序。在 OnCreateActionView 中，这是我实例化微调器适配器并将其分配给微调器的地方。需要指出的一点是 OnCreateActionView() 方法已被弃用，而另一个实现 OnCreateActionView(MenuItem menuItem) 可用。但是，如果您希望您的代码在 API 14 和 API 16 上运行，则必须实现这两种方法（相同）。希望这对其他人有帮助...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T18:15:53.937

听起来微调器正在消耗触摸事件。在`MySpinnerAdapter#onItemSelected`中，您可能必须以编程方式选择菜单项。手动调用`myActivity.onOptionsItemSelected(R.id.menu_item_1)`。

# css - CSS是如何处理的？

> ID：14283902
> 
> 赞同：2
> 
> 时间：2013-01-11T17:53:39.007
> 
> 标签：css, dom, browser

我试图准确了解浏览器处理 CSS 的方式和顺序。我已经知道 CSS 是从右到左读取的，但更具体地说，我想知道：

1.  浏览器遍历 DOM 中的每个元素，并且对于每个元素，扫描 CSS 规则以查找匹配的样式？...或者如果：
2.  浏览器会遍历每个 CSS 规则，并为每个选择器扫描 DOM 以找到与该选择器匹配的 DOM 元素？

（或者这甚至可能因浏览器而异？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T17:56:47.697

据我所知，这不是由 CSS 标准定义的，它只指定结果，而不是达到它们的方法。由于两种“算法”都会为您提供相同的视觉输出，因此它们都应该是有效的实现，假设它们还考虑了网页的动态特性（即，元素几乎可以随时通过 Javascript 移动、添加、修改或删除这可能会改变它们匹配的 CSS 规则，甚至改变其他元素匹配）。

这应该取决于实现。不同的浏览器不必都以相同的方式进行。不过请放心，浏览器领域的竞争非常激烈，您不必担心设置 CSS 规则对性能的影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T20:11:28.967

关于 CSS 处理层次结构需要注意的一件事是链接到 CSS 文件时。

调用的样式表`link`将更快加载：

```
<link rel='stylesheet' type='text/css' href='foo.css'> 
```

比用以下方式调用的样式表`@import`：

```
<style>
@import url('foo.css');
</style> 
```

这是一个非常简单的例子，但你明白了。您可以在这里阅读更多内容：http: [//www.stevesouders.com/blog/2009/04/09/dont-use-import/](http://www.stevesouders.com/blog/2009/04/09/dont-use-import/)

# c# - 我应该并且可以避免通过方法将 UnitOfWork 实例传递给策略吗？

> ID：14283903
> 
> 赞同：1
> 
> 时间：2013-01-11T17:53:49.390
> 
> 标签：c#, .net, entity-framework, design-patterns, unit-of-work

想象一下，我有一种像下面这样的方法，它使用一些策略来创建新产品并将它们保存在 Db 中。

一切都是作为工作单元的一部分发生的。

**（我的担心和）问题：** 我担心将 UnitOfWork 实例作为参数传递给策略并提交根方法中的更改是否可以或可以预防？如何避免将 UnitOfWork 实例作为参数传递给策略，但仍使它们作为工作单元的一部分工作？

（我不喜欢有人可以错误地调用 .Commit 内部策略实现的事实 - 我不想要）

```
public void DoTheJob(CustomerRequest req)
{

 var materialsPikcerStrategyFactory = new PickerStrategyFactory();
 var productionStrategyFactory = new ProductionStrategyFactory();

 var materialsPickerStrategy = materialsPikcerStrategyFactory.GetStrategy(req); 
 var productionStrategy = productionStrategyFactory.GetStrategy(req);

 using (var uow = new UnitOfWorkFactory() )
 {
    var materials = materialsPickerStrategy.PickMaterials(req, uow);
    var products = productionStrategy.CreateProductsWith(materials, uow);
    uow.Commit();
 }

}

puplic abstract class MaterialsPickerStrategy 
{

 // Picks some material entities from Db and modifies some of its properties before usage
 public abstract ICollection<Material> PickMaterials(CustomerRequest req, IUnitOfWorkFactory uow);

}

public abstract class ProductionStrategy
{
 // Gets the materials and creates some new instances by ADD'ing them to the repository
 public abstract void CreateProductsWith (ICollection<Material> materials, IUnitOfWorkFactory uow);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T18:21:46.940

我将有一个 UnitOfWork 作为依赖项传递给执行提交所需的任何类，在你的情况下，如果我理解你不想成为你的策略。

UnitOfWork 应该知道如何提交更新，因为它会引用某种数据上下文。也许和实体框架模型、DBContext 等有关。

如果它们不应该提交，你的策略不应该知道 UnitOfWork。我猜也许您使用 UnitOfWork 将您的数据上下文暴露给您的策略。

您的策略和您的 UnitOfWork 都应该引用相同的数据上下文。然后你的策略与上下文和其他一些例程一起工作，它可能使用了许多策略，最后会引用 UnitOfWork 来提交它。

如果您使用的是 IOC 框架，这一切都非常简单，因为您会将数据上下文的生命周期范围指定为 PerRequest，并将其作为依赖项传递给您的两个类。当框架将该依赖项注入到您的类中时，它将使用相同的实例，因此您的策略将写入工作单元持有的相同实例。这样，您通过策略对数据所做的更改与工作单元将要提交的更改相同。如果您对 IOC 非常熟悉，您实际上可以注入给定类所需的上下文的各个部分，从而进一步隔离依赖关系。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T18:24:23.503

您的代码似乎只使用工作单元而不使用存储库。它们通常一起使用来解决您的问题。存储库负责从数据库中获取数据或注册当前工作单元中的更改，而工作单元负责提交已注册的更改。这将允许您将存储库传递给您的策略，并且策略将无法访问工作单元。

就 EF 而言，`ObjectContext`/`DbContext`可以被视为工作单元，`ObjectSet`/`DbSet`可以被视为存储库。如果您有自定义工作单元和自定义存储库，它们必须都共享单个 EF 上下文实例。

# excel - 我需要一个宏来搜索特定列中的单元格并将所有行复制到指定的工作簿

> ID：14283912
> 
> 赞同：0
> 
> 时间：2013-01-11T17:54:27.517
> 
> 标签：excel, vba

我正在使用一个包含数千行的电子表格，并且在这些行之外，我需要在 B 列中搜索以“E”开头的单元格并将所有行复制到不同的工作簿。我在搜索这个特定问题时没有运气，或者如果我发现了一些不完全是我需要它做的东西。电子表格每周更新一次，我需要一个宏来快速进行搜索、复制和粘贴，而无需我进行选择、复制和粘贴。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T01:45:49.093

如果您更改了格式并按照 stenci 的建议对数据进行了一些操作，是的，您可以避免使用 VBA。但是，如果您处于需要保持工作表格式相同并且无法按照建议操作数据的位置（例如，由于办公场所的官僚主义），那么这里有一个子程序应该做什么你在问。我确保添加大量注释来描述每一行的作用。我希望它有帮助，祝你好运。

```
Sub copyRows()

Dim i As Integer, j As Integer, k As Integer
Dim bReport As Workbook, bReport2 As Workbook
Dim Report As Worksheet, Report2 As Worksheet

Set Report = Excel.ActiveSheet 'This assumes your sheet with data is the active sheet.
Set bReport = Report.Parent
Set bReport2 = Excel.Workbooks.Add 'This opens a new workbook
Set Report2 = bReport2.Worksheets(1) 'This assigns the variable for the worksheet where we will be pasting our data.

Report2.Cells(1, 1).Value = "Copied Rows" 'This gives a title to the worksheet (helps to avoid having to identify _
                                            the initial iteration of our for...next loop

For i = 1 To Report.UsedRange.Rows.Count 'Loops once for each row in the worksheet.

    If InStr(1, Left(Report.Cells(i, 2).Value, 1), "e", vbTextCompare) = 1 Then 'This searches the first letter of the value. I used the instr function to make it case-insensitive.
                                                                                    'You could also disable the binary comparison for the subroutine to accomplish this, but why bother?
        Report.Cells(i, 1).EntireRow.Copy 'This copies the row
        j = Report2.UsedRange.Rows.Count + 1 'This finds the row below the last used row in the new worksheet/workbook.
        Report2.Cells(j, 1).EntireRow.Insert (xlDown) 'This pastes the copied rows.
    End If
Next i

End Sub 
```

注意：Siddharth Routh 可能会建议使用 .end 来查找最后使用的单元格，而不是使用 usedrange.rows.count，但我习惯了两者中的后者。一旦我对它更熟悉了，我可能会开始使用前一种方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T18:04:13.833

如果您可以更改不需要宏的行的顺序：
选择单元格 B1，单击排序 AZ 按钮，选择以 E 开头的行，然后使用复制和粘贴。

# php - nodejs 无法读取 phpsessid 并返回未定义的错误

> ID：14283913
> 
> 赞同：2
> 
> 时间：2013-01-11T17:54:31.097
> 
> 标签：php, node.js, session, memcached

我只是喜欢[这篇文章](http://simplapi.wordpress.com/2012/04/11/php-nodejs-session-share-memcache/)来读取nodejs中的会话并从memcached读取会话数据。但是我从phpsessid读取数据时遇到了一些问题。当我节点这个index.js脚本时

```
var app = require("http").createServer(handler),
    fs = require("fs"),
    memcache = require("memcache"),
    co = require("./cookie.js");

app.listen(7070);

//On client incomming, we send back index.html
function handler(req, res){
    fs.readFile(__dirname + "/index.html", function(err, data){
        if(err){
            res.writeHead(500);
            return res.end("Error loading index.html");
        }else{
            res.writeHead(200);
            res.end(data);
        }
    });

    //Using php session to retrieve important data from user
    var cookieManager = new co.cookie(req.headers.cookie);

    var client = new memcache.Client(11211, "localhost");
    client.connect();

    client.get("sessions/"+cookieManager.get("PHPSESSID"), function(error, result){
        console.log("error : "+error);
        if(typeof(error)==="undefined"){
            var session = JSON.parse(result);
        }
    });
} 
```

并访问此脚本控制台日志显示此错误：未定义的消息。我想访问会话数据并需要帮助。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T17:25:25.953

这基本上与您之前提出的问题相同，试试这个：

```
client.get("sessions/"+cookieManager.get("PHPSESSID"), function(error, result) {
  if (error) {
    console.log(error);
  } else {
    session_management(JSON.parse(result));
  }
});

function session_management(session) {
  console.log(session);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-12T19:12:37.227

如此简单的系统无需连接。顺便说一句，这个 cookie 管理器在许多公司都在生产，没有报告任何错误。所以问题不在于那部分。

尝试检查那些：

1) 检查 php.ini 文件以查找会话的 cookie 名称是什么（默认为 PHPSESSID，但可以更改）

2）检查内存缓存是否正在运行，一切正常（没有被防火墙或其他东西锁定）。为此，在 php 或 node.js 方面（选择一个）：将 var 放入 memcache 然后检索它并检查 var 内容是否正确...

3）检查 PHP 端的 memcacheSessionHandler 是否正确使用（在您需要运行它之前）

3）如果你仍然有问题，在cookie管理器上你会发现一个列表功能：打印它的内容以检查Node.JS接收到哪个cookie。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T19:26:56.077

最简单的方法是将`connect`模块与它的 cookie 解析器一起使用。

# magento - Magento 模型 vs 块 vs 控制器等

> ID：14283920
> 
> 赞同：9
> 
> 时间：2013-01-11T17:55:04.360
> 
> 标签：magento

我在谷歌上看了又看，但找不到一个网站来解释 6 个模块子文件夹中的每一个是什么。我通常很擅长在谷歌上找东西，但这个一直没有找到。

有人能解释一下 Magento 模块（块、控制器等、Helper、Model、sql）中每个子文件夹之间的区别吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-01-11T18:17:17.503

简而言之：

**Block**负责渲染内容（来自前端、后端、电子邮件等的所有内容）。如果内容正在某个地方显示，则很可能是一个块。

**控制器**负责处理通过 url 发出的所有请求。如果您点击 url [http://www.example.com/catalog/product/view/id/9/](http://www.example.com/catalog/product/view/id/9/)您点击了*controllers/ProductController.php中的**目录*模块以及*viewAction()*方法的内部。如果您在 Magento 中点击 URL，则请求会通过一个或多个控制器。

 ****etc**包含模块的任何配置 xml 文件。这些负责从 ACL（访问控制列表）到如何访问块/模型等到系统配置设置的所有内容。一些示例文件：

*   adminhtml.xml - 处理大部分管理方面。它处理 ACL 和菜单控制。该文件是可选的。
*   config.xml - 处理模块的所有基本配置。该文件定义了如何/在哪里找到帮助程序、块、模型、资源、默认模块设置、重写、观察者、前端布局文件和大量其他配置。该文件是模块运行所必需的。
*   System.xml - 包含插入到站点的系统 -> 配置部分的所有系统配置。
*   还有其他的，但它们比你所要求的更高级。

**助手**- 这些文件是“助手”。它们包含模块共有的功能或其他模块可以访问的功能。其中一项功能是提供翻译。此外，Data.php 是此处包含的默认帮助程序。如果您有系统配置，则需要 Data.php 才能正确显示系统配置。

**模型**- 这些是您的数据对象。例如，产品或类别是模型。它们提供数据管理功能。它们与模型文件夹中包含的 Resource 文件夹交互以访问数据库，并与 Collections 交互以获取对象集合。

**sql** - 这些是您的设置脚本。如果配置正确，则安装模块后，可能需要对数据库进行一些更改：向产品添加表、属性或自定义配置。

* * *

我建议看看[http://alanstorm.com/category/magento](http://alanstorm.com/category/magento)

他有许多示例、教程和其他好的技巧，是一个更完整的起点。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-11T18:19:56.033

了解每个功能的最佳方法是查看核心模块。

**Helpers** - Magento 的 Helper 类包含实用方法，允许您对对象和变量执行常见任务。例如：$helper = Mage::helper('catalog')

**Blocks** - 每个 Block 对象将呈现特定的 HTML 位。块对象通过 PHP 代码的组合实现这一点，包括 PHP .phtml 模板文件。Blocks 对象旨在与 Magento 系统交互以从模型中检索数据，而 phtml 模板文件将生成页面所需的 HTML

**控制器**- 在任何 PHP 系统中，主要的 PHP 入口点仍然是一个 PHP 文件。Magento 也不例外，该文件是 index.php。

**Magento 模型**- Magento 与当今的大多数框架一样，提供对象关系映射 (ORM) 系统。ORM 让您摆脱编写 SQL 的工作，并允许您纯粹通过 PHP 代码（和其他核心业务逻辑）来操作数据存储

**等**- 这是您放置配置文件（config.xml、system.xml 和/或 adminhtml.xml）的位置，以告诉 magento 您的模块可以访问什么以及有关您的自定义模块的其他配置（参见[示例](http://www.magentocommerce.com/wiki/5_-_modules_and_development/0_-_module_development_in_magento/customize_part_of_configuration#which_files_are_used_in_configuration)）

**sql** - 这是您放置设置脚本的位置（例如，将新表添加到您的 magento db）

看看@ [Magento for Developers：第 1 部分 - Magento 简介](http://www.magentocommerce.com/knowledge-base/entry/magento-for-dev-part-1-introduction-to-magento)**

# c# - C# 和 LINQPad 之间的 Linq 查询性能

> ID：14283925
> 
> 赞同：0
> 
> 时间：2013-01-11T17:55:57.020
> 
> 标签：c#, performance, linq, entity-framework, linqpad

在我的应用程序中使用这个 linq 查询：

```
var r = from uev in UtilisateurEpisodeVus
        group uev by uev.Episode.Saison.Serie into pgroup
        let count = pgroup.Count()
        orderby count descending
        select new SerieVu() { nombreDeVus = count, Serie = pgroup.Key };
return r.ToList(); 
```

在 LINQPad 中，使用与 Entity Framework 相同的连接使用大致相同的查询：

```
from uev in UtilisateurEpisodeVus
group uev by uev.Episode.Saison.Serie into pgroup
let count = pgroup.Count()
orderby count descending
select pgroup.Key 
```

在我的应用程序中：

```
resultat.ToList() 
```

大约需要 45 秒。

在 LINQPad 中需要 191 毫秒。

请问是什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T18:22:27.970

感谢您的帮助，我找到了使用 Entity Framework Profiler 试用的解决方案。事实上我正在这样做：

```
IEnumerable<UtilisateurEpisodeVu>   listUtilisateurEpisodeVu = Query(uev => uev.userepivu_date > dateIlYaSeptJours);

var resultat =
from uev in listUtilisateurEpisodeVu
group uev by uev.Episode.Saison.Serie into pgroup
let count = pgroup.Count()
orderby count descending
select new SerieVu() { nombreDeVus = count, Serie = pgroup.Key }; 
```

通过这样做：

```
var resultat =
from uev in Query(uev => uev.userepivu_date > dateIlYaSeptJours)
group uev by uev.Episode.Saison.Serie into pgroup
let count = pgroup.Count()
orderby count descending
select new SerieVu() { nombreDeVus = count, Serie = pgroup.Key }; 
```

直接在我的 linq 查询中使用 Query 性能很棒......我不明白为什么。如果有人有任何想法，我会很高兴知道答案。再次感谢

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T19:23:09.773

当你说

```
IEnumerable<UtilisateurEpisodeVu>   listUtilisateurEpisodeVu
from uev in listUtilisateurEpisodeVu
group uev 
```

您正在对一个 进行分组`IEnumerable<T>`，这会变成一个调用 on `System.Linq.Enumerable.GroupBy`，它会加载整个表并在本地执行。

* * *

当你说

```
from uev in Query(uev => uev.userepivu_date > dateIlYaSeptJours)
group uev 
```

您正在对一个 进行分组`IQueryable<T>`，这会变成一个调用 on `System.Linq.Queryable.GroupBy`，该调用被翻译成 sql 并发送到数据库。

您可以通过更改变量的类型来获得相同的结果：

```
IQueryable<UtilisateurEpisodeVu>   listUtilisateurEpisodeVu
from uev in listUtilisateurEpisodeVu
group uev 
```

# javascript - 将 AdSense 动态添加到 Wordpress 侧边栏

> ID：14283926
> 
> 赞同：0
> 
> 时间：2013-01-11T17:55:59.773
> 
> 标签：javascript, wordpress, adsense

我的 wordpress 网站上的一些页面/帖子变得很长，我认为侧边栏看起来很傻，只是坐在那里空无一人。另外，那个空旷的空间是一个失去的做广告的机会。所以，我想要做的是使用 javascript 来确定 #main 的高度，然后动态添加 Adsense 脚本，直到 #sidebar 的高度大致相等（这意味着另一组广告不适合）。

我已经确定了如何使用 offsetHeight 来拉两个 div 的高度（我知道这不会是完美的），并且我理解运行 do/while 直到单独 div 的高度相等的逻辑。

Adsense 代码分为两部分。第一部分只是设置一些变量，第二部分调用一些代码，我想使用第一部分中的变量。为了让 AdSense 展示广告，两者都是必需的。如果两者都出现不止一次，则广告将显示不止一次。我已经将第一部分代码转储到一个单独的 .js 文件中，所以现在我只需要弄清楚如何使用单独的 src 属性调用这两个脚本。

我找到了这段代码并根据我的情况对其进行了调整（我已将它放在我的标题中）但它不起作用（不显示任何内容）：

```
var sidebar= document.getElementById('sidebar')[0];
var script1 = document.createElement("script");
script1.type = "text/javascript";
script1.src = "link/to/javascript/file.js";

var script2 = document.createElement("script");
script2.type = "text/javascript";
script2.src = "http://pagead2.googlesyndication.com/pagead/show_ads.js";

sidebar.appendChild(script1);
sidebar.appendChild(script2); 
```

我已经尝试了上面的代码，`[0]`因为我认为我不需要它。这两个选项都不起作用。

关于如何按照我的方式解决这个问题的任何想法？有关执行代码的更好方法的任何想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-06T05:28:31.450

JohnnyO 在这里给出的解决方案[Dynamic Adsense Insertion With JavaScript](https://stackoverflow.com/questions/6197768/dynamic-adsense-insertion-with-javascript)

对我来说很好。问题在于 Google 脚本中的 document.write() 方法。write() 方法在页面加载后不起作用。

# jquery-mobile - 主干视图未在 pagecreate 事件上呈现

> ID：14283933
> 
> 赞同：0
> 
> 时间：2013-01-11T17:56:23.273
> 
> 标签：jquery-mobile, backbone.js

我正在使用 jquery mobile、backbone 和 require.js 构建一个移动 Web 应用程序以使其模块化。我有一个有这个的html页面；

```
<html>
 <head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-type" content="text/html; charset=utf-8">
  <title>DoIt</title>
  <link href="jqm/jquery.mobile-1.2.0.css" rel="stylesheet">

  <script  charset="utf-8" src="jqm/jquery-1.7.2.min.js"></script>
  <script  charset="utf-8" src="jqm/jquery.mobile-1.2.0.min.js"></script>
  <script  charset="utf-8" src="libs/require.js" data-main="app"></script>

</head> 
```

我的 app.js 文件看起来像这样

```
//Require.js configuration
require.config({
    paths: {
        'underscore': 'libs/underscore-min',
        'backbone': 'libs/backbone-min',
        'text': 'libs/text'
    },
    shim: {
        'backbone': {
            deps: ['underscore'],
            exports: 'Backbone'
        }
    }
});

require(['backbone', 'views/main'], function (Backbone, AppView) {
    'use strict';
     var view = new AppView();

     $(document).bind('pagecreate', function () {
        view.render(); 
     });
}); 
```

这是视图的模板

```
 <script type="text/html" id="app-view-tmpl">
    <div id="task-creator">
        <input type="text" id="task" placeholder="Enter a task">
        <button data-role="button" data-theme="b">
            Create task
        </button>
    </div>
      </script> 
```

我使用“pagecreate”事件来触发视图的呈现。视图不会呈现，但会记录我设置为在视图初始化时记录到控制台的其他详细信息。做错什么了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T18:06:15.997

我对backbone.js 知之甚少，但是您是否在构建小部件后“刷新”了它们？

[http://jquerymobile.com/demos/1.2.0/docs/lists/lists-methods.html](http://jquerymobile.com/demos/1.2.0/docs/lists/lists-methods.html)

`$("#myListView").listview("refresh");`

或者

`$("#myButton").button("refresh");`

这应该是您`pagecreate`逻辑的一部分。获取有关模板的其他详细信息会很有帮助。

# c# - 列 [X] 不属于表服务器错误 - 为什么？

> ID：14283937
> 
> 赞同：1
> 
> 时间：2013-01-11T17:56:34.897
> 
> 标签：c#, asp.net, mysql, sql-server, sql-server-2008

我一直在使用相同的一行代码将数据库中的特定字段保存到变量中。

```
variable = Convert.ToType(dt.Rows[0]["[Column Name]"]); 
```

问题是我得到这个烦人的列不存在服务器错误。使用像“Select * From Table”这样简单的 sql 查询的不同表和不同字段会发生这种情况。我已经检查了无数次列名是否正确，我尝试在列名中使用空格并且没有 - 似乎没有任何帮助。

知道是什么原因造成的以及如何解决吗？这是堆栈跟踪：

```
[ArgumentException: Column '[Long MSDS Update]' does not belong to table Table.]
System.Data.DataRow.GetDataColumn(String columnName) +5253191
System.Data.DataRow.get_Item(String columnName) +13
SiteMaster.msds_update() in
c:\Users\nravid\Desktop\School\Project\PhillipsSite\Site.master.cs:198
SiteMaster.master_Page_PreLoad(Object sender, EventArgs e) in c:\Users\nravid\Desktop\School\Project\PhillipsSite\Site.master.cs:92
System.EventHandler.Invoke(Object sender, EventArgs e) +0
System.Web.UI.Page.OnPreLoad(EventArgs e) +121
System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +699 
```

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T18:16:05.370

您收到此错误是因为您包含了括号 [ ]。删除方括号，它应该可以工作

采用

```
dt.Rows[0]["Column Name"] 
```

代替

```
dt.Rows[0]["[Column Name]"] 
```

在你的情况下

```
dt.Rows[0]["Long MSDS Update"] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T18:01:53.787

运行下面的代码并确保输出是预期的。

```
Debug.WriteLine(dt.TableName);
foreach(DataColumn column in dt.Columns)
{
    Debug.WriteLine("\t" + column.ColumnName);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T18:16:14.507

围绕它进行测试

```
if (dt.Columns.Contains("SomeColumnName"))
{
}
else
{
    // Danger Will Robinson!. Danger!
} 
```

# scala - 类型安全生成器：如何组合幻像类型

> ID：14283938
> 
> 赞同：2
> 
> 时间：2013-01-11T17:56:34.583
> 
> 标签：scala

我在类型安全的构建器模式中使用幻像类型来确保方法只被调用一次，如以下代码示例所示

```
 sealed trait TBoolean
  sealed trait TTrue extends TBoolean
  sealed trait TFalse extends TBoolean

  class Builder[MethodCalled <: TBoolean] private() {

    def foo()(implicit ev: MethodCalled =:= TFalse): Builder[TTrue] = {
      new Builder[TTrue]
    }
  }

  object Builder {
    def apply() = new Builder[TFalse]()
  } 
```

我真的很欣赏这种方法，因为可以使用`.`-operator 链接方法调用（与其他方法不同）但是，如果有很多方法来保护以类似的结尾，这将变得不方便

```
 class Builder[MethodCalled1 <: TBoolean, MethodCalled2 <: TBoolean, ... ,MethodCalledN <: TBoolean] 
```

有没有办法创建一个“类型结构”？类似于以下伪代码：

```
 type S {
      type MethodCalled1 <: TBoolean
      type MethodCalled2 <: TBoolean
      ...
      type MethodCalledN <: TBoolean
  }

  class Builder[S] private() {

    def foo()(implicit ev: S#MethodCalled1 =:= TFalse): Builder[S#MethodCalled1.TTrue] = {
      new Builder[S#MethodCalled1.TTrue]
    }
  } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T20:14:45.410

你在正确的轨道上，你只需要添加一点类型改进：

```
trait BuilderMethods {
  type FooCalled <: TBoolean
  type BarCalled <: TBoolean
}

class Builder[M <: BuilderMethods] private() {
  def foo()(implicit ev: M#FooCalled =:= TFalse): Builder[M {type FooCalled = TTrue}] = {
    new Builder[M {type FooCalled = TTrue}]
  }
  def bar()(implicit ev: M#BarCalled =:= TFalse): Builder[M {type BarCalled = TTrue}] = {
    new Builder[M {type BarCalled = TTrue}]
  }
}

object Builder {
  type UnusedBuilder = BuilderMethods {type FooCalled = TFalse; type BarCalled = TFalse;}
  def apply(): Builder[Builder.UnusedBuilder] = new Builder[UnusedBuilder]()
}

object TestPhantomStruct extends App {
  val newBuilder = Builder()
  val builderFooCalled = newBuilder.foo()
  val builderFooCalledTwice = builderFooCalled.foo() // will not compile
  val builderFooCalledBarCalled = builderFooCalled.bar()
  val builderFooCalledTwiceBarCalled = builderFooCalledBarCalled.foo() // will not compile

  val builderBarCalled = newBuilder.bar()
  val builderBarCalledTwice = builderBarCalled.bar() // will not compile
} 
```

# javascript - javascript在if子句中获取结果的长度

> ID：14283941
> 
> 赞同：-3
> 
> 时间：2013-01-11T17:56:41.420
> 
> 标签：javascript

我想在 if 子句中获取结果的长度，然后将其写入输入隐藏元素中。

代码：

```
<script type="text/javascript">
$(document).ready(function(){   
  var imgs = document.getElementById("images").getElementsByTagName("img");
  var imgSrcs = [];

  for (var i = 0; i < imgs.length; i++) {
         $('#loaderimg').html(imgSrcs += getImgSize(imgs[i].src));
  }

  function getImgSize(imgSrc){
      var newImg = new Image();
      newImg.src = imgSrc;
      var height = newImg.height;
      var width = newImg.width;
      p = $(newImg).ready(function(){
          return {width: newImg.width, height: newImg.height};
      });
      // return (p[0]['width']+" "+p[0]['height']);
      if(p[0]['width'] >= 100){
         return ('<img src="'+imgSrc+'" id="'+i+'" width="100" style="max-height:150px;">');
      }else{
        return ('');
      }
  } 
}); 
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T18:20:30.480

你可以试试这个版本。请注意，这可能不是完全有效的代码，您可以了解如何执行此操作。

所做的是，在火灾`img`时添加。`ready()`

```
<script type="text/javascript">
    var i;
    var total_images = 0;

    $(document).ready(function(){   
        var imgs = document.getElementById("images").getElementsByTagName("img");
        var imgSrcs = [];

        for (i = 0; i < imgs.length; i++) {
            getImgSize(imgs[i].src);
        }

        function getImgSize(imgSrc){
            var newImg = new Image();
            newImg.src = imgSrc;
            var height = newImg.height;
            var width = newImg.width;

            p = $(newImg).ready(function(){
                if(newImg.width >= 100){
                    $('#loaderimg').html($('#loaderimg').html() + '<img src="' + imgSrc + '" id="' + i + '" width="100" style="max-height:150px;">');
                    $('#total_images').val(total_images);
                    total_images++;
                }
            });
        } 
    }); 
</script> 
```

# sum - 将用户输入的一系列数字相加

> ID：14283945
> 
> 赞同：-1
> 
> 时间：2013-01-11T17:57:02.367
> 
> 标签：sum

我正在从一本书中学习，这是我的任务：

> 编写一个程序，对用户输入的一系列数字求和。该程序应首先提示用户要对多少数字求和。然后它应该输入每个数字并打印总和。

我几乎不知道如何开始。我的第一个问题是在用户定义了要对多少个数字求和之后，我不知道如何利用这些信息为精确数字构建下一个输入表达式。

如果我们之前知道用户将输入多少个数字，这将是显而易见的，但是......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-07-10T19:47:49.160

```
def main():
    n = eval(input("Enter how many numbers you want to enter: \n"))
    ssum = 0

    for i in range(n):
        k = eval(input("Enter a number: \n"))
        ssum = k + ssum

    print("Sum of the above numbers is: ", ssum)

main() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T23:57:14.257

感谢您迄今为止在评论中的帮助。

我想出了这个代码，它确实给出了正确的答案，但它提示用户`how_many`每次询问和打印`Enter exact numbers`短语时输入他的数字次数。希望以用户可以用逗号输入数字一次的方式修复它。有什么建议么？

```
def main():
    sum = 0
    how_many = input("How many numbers are to be entered? ")
    for i in range(how_many):
        numbers = input("Enter exact numbers: ")
        sum = numbers + sum

    print "The sum equals to", sum

main() 
```

# rabbitmq - 跨交换 RabbitMQ 的持久消息持久性

> ID：14283948
> 
> 赞同：1
> 
> 时间：2013-01-11T17:57:10.493
> 
> 标签：rabbitmq, messaging, message-queue

我对 RabbitMQ 如何处理以直接模式从交换机转发的持久消息感到有些困惑，这些消息位于已断开连接的队列中。

情况是这样的。

```
 -> Exclusive Queue -> Client 1
      /
Exch - 
      \
       -> Exclusive Queue -> Client 2 
```

持久消息被发送到交换器，交换器将它们分发到独占队列。客户端 1 死于破坏其排他队列。

我的问题是，如果该队列上有消息，它们会丢失吗？还是他们对交易所不满？

或者这是一个坏主意？让每个客户端连接到一个队列会更好吗？（这需要有持久的消息和高吞吐量，所以不确定这是一个选项......）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T13:01:02.893

持久消息仅在队列中持久。实际上仅在持久队列中。这意味着如果 RabbitMQ 本身出于某种原因而崩溃。如果持久队列中有未使用的持久消息，它们将在 RabbitMQ 重新启​​动时与队列一起恢复。

所以这对你的问题没有帮助。您要做的是确保将自动删除设置设置为 false。您甚至不需要持久消息来完成这项工作。当不再有连接的消费者时，自动删除会删除队列。如果您的客户端很好地终止并正确删除了连接，那么如果您将其设置为 true（我相信这是默认设置），它也会自动删除队列。

将 autodelete 设置为 false 将意味着队列始终存在并且在声明后始终接收消息。因此，如果您的客户端死亡并且队列中仍有消息，则当客户端重新启动时它们仍然存在。

# mysql - SQL 按 COUNT 排序

> ID：14283950
> 
> 赞同：0
> 
> 时间：2013-01-11T17:57:15.647
> 
> 标签：mysql, sql

我有下表和附加的列。

```
tags
 -t_id (PRIMARY)
 -pg
tag_refs
 -t_id
 -bp_id 
```

现在我尝试编写一个 MySQL 查询，它返回按受欢迎程度排序的标签总数 - 在这种情况下，这意味着唯一 t_id 在 tag_refs 表中表示的次数。

我假设这将是一个联合查询，它必须从标签表中返回一个列表，我可以在其中使用 pg 列仅输出每个标签的名称/标题一次，按使用最多的排序。

我尝试了以下查询，它只返回一行，但似乎是按我想要的顺序排列的。

```
SELECT *
FROM tags
JOIN tag_refs ON tags.t_id = tag_refs.t_id
ORDER BY COUNT(tag_refs.t_id) DESC 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T18:00:27.117

您应该像这样在 SELECT 中进行聚合：

```
SELECT tags.pg, COUNT(tag_refs.t_id) AS tag_count
FROM tags INNER JOIN tag_refs ON tags.t_id = tag_refs.t_id
GROUP BY tag.pg
ORDER BY tag_count DESC 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T17:59:39.157

你缺少`Group by`条款

```
SELECT 
tag_refs.t_id,  COUNT(tag_refs.t_id) 
FROM 
    tags 
JOIN 
    tag_refs 
ON 
    tags.t_id = tag_refs.t_id 
group by tag_refs.t_id
ORDER BY 
    COUNT(tag_refs.t_id) 
DESC 
```

[在此处](http://www.tutorialspoint.com/mysql/mysql-group-by-clause.htm)阅读有关此条款的一些信息

# css - 在链接和样式表中使用类？

> ID：14283956
> 
> 赞同：2
> 
> 时间：2013-01-11T17:57:51.527
> 
> 标签：css, class, html, hyperlink

嗨我正在尝试设计一个类对象

```
<a href="url here" class="gallery">View Photos</a> 
```

这是我的CSS

```
.gallery
{
width:60px;
background-color: #09a2e9;  
padding:5px;
-moz-border-radius: 3px;
border-radius: 3px;
font-family: Function Pro Light;
color:#fff;
font-weight:bold;
font-size:30px;
}

a.gallery:link {
font-family: Function Pro Light;
color:#fff;
font-weight:bold;
font-size:30px;
} 
```

我想要的是这样的

[http://i.stack.imgur.com/Ue6sM.jpg](http://i.stack.imgur.com/Ue6sM.jpg)

但我的 CSS 不工作。我该如何解决。

div 拉伸全宽，我根本不希望它拉伸，也不想设置宽度和高度。

另外我如何在不添加的情况下使其居中

```
<center> </center> 
```

标签

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T18:02:14.417

以下应该在现代浏览器中工作（即不是 IE7 或以下）

```
.gallery
{
  /* force the element to keep to it's content */
  display: inline-block;
  /* centering */
  margin-left: auto;
  margin-right: auto;
  /* */
  background-color: #09a2e9;  
  padding: 5px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  font-family: Function Pro Light;
  color: #fff;
  font-weight: bold;
  font-size: 30px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T18:05:14.090

```
a.gallery{
width:60px;
background-color: #09a2e9;  
padding:5px;
-moz-border-radius: 3px;
-webkit-border-radius: 3px;
border-radius: 3px;
font-family: Function Pro Light;
color:#fff;
font-size:30px;
margin: 0 auto;
}

a.gallery:link {
font-family: Function Pro Light;
color:#fff;
font-weight:bold;
font-size:30px;
text-decoration: none;
} 
```

如果需要，您还可以从[Google Web Fonts](http://www.google.com/webfonts)获取字体。

居中：`margin: 0 auto`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T18:13:13.770

其他一些答案很接近，但这应该可以。

对于居中，您不能`margin: 0 auto`为`inline`or`inline-block`元素做。只有`block`水平元素会以这种方式居中（如果它们具有设定的宽度）。您需要将按钮/链接元素放在块级元素（如 a`div`或 a `p`）内，然后`text-align: center`在该父元素上设置。

HTML：

```
<p><a href="#" class="gallery">My Button</a></p> 
```

CSS：

```
p {
  text-align: center;
}

.gallery {
  background-color: #09a2e9;  
  border-radius: 3px;
  color: #fff;
  display: inline-block;
  font-family: "Function Pro Light", Arial, Sans-Serif;
  font-size: 30px;
  font-weight: bold;
  padding: 5px;
  text-decoration: none;
} 
```

还有一个工作示例： http: [//jsfiddle.net/kzTnv/](http://jsfiddle.net/kzTnv/)
浏览器支持边界半径：[http ://caniuse.com/#search=border-radius](http://caniuse.com/#search=border-radius)

# javascript - FB 滑动操作失败

> ID：14283962
> 
> 赞同：0
> 
> 时间：2013-01-11T17:58:10.690
> 
> 标签：javascript, action, swipe

与 [包装函数括号](https://stackoverflow.com/questions/14133587/wrapper-function-bracketing) 问题有关

Rion 和 Jan 足以使该脚本工作，但它只能工作一段时间（并且与添加的行完全无关）所以看起来原始代码失败了，我假设这是我在做的，因为这个 FB 风格的东西似乎无处不在。当用户滚动到页面底部时，它会“破坏”代码。我猜内容区域的类别正在改变？我对这种东西很绿色。

如果它因为 jquery 而不能工作，没什么大不了的，Showmenu 点击工作，滑动效果非常棒，保留它会很好，因为该网站基于 1.6.4 我真的不想重新- 做这一切。

这是代码

```
$(document).bind("mobileinit", function () {
$.mobile.pushStateEnabled = true;
});

$(function () {
var menuStatus;

// Show menu
$("a.showMenu").click(function () {
    if (menuStatus != true) {
        $(".ui-page-active").animate({
            marginLeft: "165px",
        }, 300, function () {
            menuStatus = true
        });
        return false;
    } else {
        $(".ui-page-active").animate({
            marginLeft: "0px",
        }, 300, function () {
            menuStatus = false
        });
        return false;
    }
});

$('#menu, .pages').live("swipeleft", function () {
    if (menuStatus) {
        $(".ui-page-active").animate({
            marginLeft: "0px",
        }, 300, function () {
            menuStatus = false
        });
    }
});

$('.pages').live("swiperight", function () {
    if (!menuStatus) {
        $(".ui-page-active").animate({
            marginLeft: "165px",
        }, 300, function () {
            menuStatus = true
        });
        $("html, body").animate({ scrollTop: 0 }, "slow");
    }
});

and the HTML

<!DOCTYPE html> 
<html manifest="island.manifest">
<head> 
<title></title> 
<meta id="extViewportMeta" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black" />   
<link rel="stylesheet" href="css/jquery.mobile-1.0rc2.min.css" />
<link rel="stylesheet" href="css/main.css" />
<link rel="stylesheet" href="js/flexslider/flexslider.css" type="text/css" media="screen"/>
<!--webapp stay-->
<!--test-->
<link rel="apple-touch-icon" href="images/add-to-home/touch-icon-iphone.png"/>
<link rel="apple-touch-icon-precomposed" href="images/add-to-home/touch-icon-iphone.png"/>
</head> 
<body> 
<div id="menu">
<ul>
    <li><a target="_blank" href="" class="noeffect" style="height:50px;border-right:none;padding:15px;background:#075191;"><img src="images/YouIn.png" width="120"></a></li>
    <li><a href="index.html" class="contentLink" rel="external"  >Main </a></li>
    <li><a href="nav_2.html" class="contentLink" rel="external" >January 30, 2013</a></li>
    <li class="active"><a href="nav_3.html" class="contentLink" rel="external"  style="border-right:solid 0px #9a9999" >January 31, 2013 </a></li>
    <li><a href="nav_4.html" class="contentLink" rel="external" >February 1, 2013 </a></li>
    <li><a href="nav_5.html" class="contentLink" rel="external" >February 2, 2013</a></li>              
    <li><a href="nav_6.html" class="contentLink" rel="external" style="color:red;text-align:center">Game Day!!!</a></li>
    <li><a href="nav_7.html" class="contentLink" rel="external" >February 4, 2013 </a></li>
    <li><a href="nav_8.html" class="contentLink" rel="external" >Map </a></li>      
    <li><a href="nav_9.html" class="contentLink" rel="external" >Contact Staff </a></li>        
    <li><a target="_blank" href="" class="noeffect" style="min-height:300px;border-top:solid 1px #3c7db3;padding:250px 0 0 15px;background:#075191;"><img src="images/YouIn.png" width="120"></a></li>
</ul>
</div>
<div data-role="page" class="pages" id="home">
<div data-role="header" style="min-height: 80px; background:#075191; ">
<span><a href="#" class="showMenu" style="float:left;margin:10px 10px 10px 10px;"><img src="images/MenuPSD3C.png" height= "64"></a></span>
<span ><a href="index.html" style="float:right;margin:10px 10px 10px 10px;"><img src="images/add-to-home/touch-icon-iphone.png" height= "64" ></a></span>
</div><!-- /header -->
<div data-role="content" style="min-height:1400px;border-top:solid #b2b3b5 1px">
    content stuff
</div><!-- /content -->
</div><!-- /page -->
<script type="text/javascript" src="js/jquery-1.6.4.min.js"></script>
<script type="text/javascript" src="js/jquery.mobile-1.0rc2.min.js"></script>
<script type="text/javascript" src="js/app.js"></script>
<script type="text/javascript">
function fullscreen() {
    $('a').click(function() {
        if(!$(this).hasClass('noeffect')) {
            window.location = $(this).attr('href');
            return false;
        }
    });
}
fullscreen();
</script> 
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:19:31.893

在你的 jquery ref 之后插入

```
 <script type="text/javascript">
  (function (window) {
// This library re-implements setTimeout, setInterval, clearTimeout, clearInterval for iOS6.
// iOS6 suffers from a bug that kills timers that are created while a page is scrolling.
// This library fixes that problem by recreating timers after scrolling finishes (with interval correction).
// This code is free to use by anyone (MIT, blabla).
// Original Author: rkorving@wizcorp.jp
var timeouts = {};
var intervals = {};
var orgSetTimeout = window.setTimeout;
var orgSetInterval = window.setInterval;
var orgClearTimeout = window.clearTimeout;
var orgClearInterval = window.clearInterval;
// To prevent errors if loaded on older IE.
if (!window.addEventListener) return false;
function createTimer(set, map, args) {
    var id, cb = args[0],
        repeat = (set === orgSetInterval);

    function callback() {
        if (cb) {
            cb.apply(window, arguments);
            if (!repeat) {
                delete map[id];
                cb = null;
            }
        }
    }
    args[0] = callback;
    id = set.apply(window, args);
    map[id] = {
        args: args,
        created: Date.now(),
        cb: cb,
        id: id
    };
    return id;
}

function resetTimer(set, clear, map, virtualId, correctInterval) {
    var timer = map[virtualId];
    if (!timer) {
        return;
    }
    var repeat = (set === orgSetInterval);
    // cleanup
    clear(timer.id);
    // reduce the interval (arg 1 in the args array)
    if (!repeat) {
        var interval = timer.args[1];
        var reduction = Date.now() - timer.created;
        if (reduction < 0) {
            reduction = 0;
        }
        interval -= reduction;
        if (interval < 0) {
            interval = 0;
        }
        timer.args[1] = interval;
    }
    // recreate
    function callback() {
        if (timer.cb) {
            timer.cb.apply(window, arguments);
            if (!repeat) {
                delete map[virtualId];
                timer.cb = null;
            }
        }
    }
    timer.args[0] = callback;
    timer.created = Date.now();
    timer.id = set.apply(window, timer.args);
}
window.setTimeout = function () {
    return createTimer(orgSetTimeout, timeouts, arguments);
};
window.setInterval = function () {
    return createTimer(orgSetInterval, intervals, arguments);
};
window.clearTimeout = function (id) {
    var timer = timeouts[id];
    if (timer) {
        delete timeouts[id];
        orgClearTimeout(timer.id);
    }
};
window.clearInterval = function (id) {
    var timer = intervals[id];
    if (timer) {
        delete intervals[id];
        orgClearInterval(timer.id);
    }
};
//check and add listener on the top window if loaded on frameset/iframe
var win = window;
while (win.location != win.parent.location) {
    win = win.parent;
}
win.addEventListener('scroll', function () {
    // recreate the timers using adjusted intervals
    // we cannot know how long the scroll-freeze lasted, so we cannot take that into account
    var virtualId;
    for (virtualId in timeouts) {
        resetTimer(orgSetTimeout, orgClearTimeout, timeouts, virtualId);
    }
    for (virtualId in intervals) {
        resetTimer(orgSetInterval, orgClearInterval, intervals, virtualId);
    }
});
}(window));
</script> 
```

# javascript - Javascript Json：我如何重写这个数组以特定格式输出

> ID：14283963
> 
> 赞同：0
> 
> 时间：2013-01-11T17:58:12.877
> 
> 标签：javascript, php, arrays, json

我正在使用以下内容来收集我需要使用的字段数组：

```
 $reqFlds = array();
    $results = mysql_query("aid, fld_name from field
where aid = $acct_id2 and req_flag = 1");
        while($result = mysql_fetch_assoc($results))
            {
            $reqFlds[] = $result;
            }

    <script language="javascript">
        var reqFlds= <?php echo "new Array(". trim(json_encode($reqFlds), '[]').")"; ?>;
    </script> 
```

**我的“reqFlds”数组像这样吐出：**

```
<script language="javascript">
    var reqFlds = new Array(
    {"aid":"15","fld_name":"Job Issued"},
    {"aid":"18","fld_name":"Job Title"},
    {"aid":"20","fld_name":"Banner Details"},
    {"aid":"202","fld_name":"Flyer Details"},
    {"aid":"2134","fld_name":"Code Not above"},
    {"aid":"5862","fld_name":"Quantity"});

</script> 
```

我得到了一个需要这样的数组数据的函数：

```
var fldToUse = ['15||Job Issued', '18||Job Title', '20||Banner Details']; 
```

如何重写我的数组 [reqFlds] 使其以上述格式吐出：

# 先感谢您。

**最近的编辑 - 下面正是我放置代码和结果的方式**

```
<?php
$reqFlds  = array();
$results = mysql_query("select id, display_name from field where account_id = $acct_id2 and required_flag = 1");
    while($RequireResult = mysql_fetch_assoc($results))
        {
            $reqFlds[] = $RequireResult;
        }

foreach($reqFlds as $reqFlds)
    {
    $reqFlds = $reqFlds["id"] . "||" . $reqFlds["display_name"];
}
?>

<script language="javascript">
    var requiredFieldsPRS = <?php echo "new Array(". trim(json_encode($reqFlds), '[]').")"; ?>;
    var holdReqFlds = <?php echo json_encode($reqFlds); ?>;
</script> 
```

如果将这样的代码保留在循环外的 foreach 中，我只会在查看源代码时得到一个 - 这非常接近，因为它是按照我需要的方式布置的，但这只是数组中的第一个值

```
<script language="javascript">
    var requiredFieldsPRS = new Array("'5862||Quantity'");
    var holdReqFlds = "'5862||Quantity'";
</script> 
```

如果它放入数组中，整个东西都会死掉

我确定我只是累了，可能会想出其他借口，但简而言之，我只是不知道我做错了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T18:00:34.960

```
var newArray = [];

for(var i = 0; i != reqFlds.length; ++i)
{
  newArray.push(reqFlds[i].aid + "||" + reqFlds[i].fld_name);
} 
```

newArray 现在将采用您需要的格式。这是一个客户端解决方案。如果您需要在 PHP 端更改它，那么这是一个不同的解决方案：

```
$reqFlds = array();
    $results = mysql_query("aid, fld_name from field
where aid = $acct_id2 and req_flag = 1");
        while($result = mysql_fetch_assoc($results))
            {
            $reqFlds[] = $result['aid'] . '||' . $result['fld_name'];
            }

    <script language="javascript">
        var reqFlds= <?php echo "new Array(". trim(json_encode($reqFlds), '[]').")"; ?>;
    </script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T18:03:51.650

这应该可以解决问题。干净整洁。

```
<?php 
    $reqFlds = array();
    $results = mysql_query("aid, fld_name from field where aid = $acct_id2 and req_flag = 1");

    while ($result = mysql_fetch_assoc($results)) {
        $reqFlds[] = $result['aid'] . '||' . $result['fld_name'];
    }
?>

<script language="javascript">
    var reqFlds= <?php echo json_encode($reqFlds); ?>;
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T18:04:41.637

在客户端，您可以尝试：

```
 var reqFlds = new Array(
    {"aid":"15","fld_name":"Job Issued"},
    {"aid":"18","fld_name":"Job Title"},
    {"aid":"20","fld_name":"Banner Details"},
    {"aid":"202","fld_name":"Flyer Details"},
    {"aid":"2134","fld_name":"Code Not above"},
    {"aid":"5862","fld_name":"Quantity"});

var transformed = reqFlds.map(function(item) {
  return item["aid"] + "||" + item["fld_name"];
}); 
```

[小提琴](http://jsfiddle.net/sN25z/)

对于服务器端，Eli 的解决方案看起来是正确的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T18:10:04.270

这应该可以解决问题

```
var reqFldsFormatted = new Array();

for (var i=0; i<reqFlds.length; i++) {
    // Written for readability, not execution speed
    reqFldsFormatted[i] = reqFlds[i]["aid"] + "||" + reqFlds[i]["fld_name"];
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-11T18:10:37.547

您可以像这样在 PHP 代码中*转换数组：*

```
$reqFlds = array();
$results = mysql_query("select aid, fld_name from field where aid = $acct_id2 and req_flag = 1");
while ($result = mysql_fetch_assoc($results)) {
    $reqFlds[] = $result;
}
// at this point the array becomes something like this
//
// array(
//     array("aid" => "15","fld_name" => "Job Issued"),
//     array("aid" => "18","fld_name" => "Job Title"),
//     array("aid" => "20","fld_name" => "Banner Details"),
//     array("aid" => "202","fld_name" => "Flyer Details"),
//     array("aid" => "2134","fld_name" => "Code Not above"),
//     array("aid" => "5862","fld_name" => "Quantity")
// );
//
// here is how you transform array elements to desired format:
foreach($reqFlds as &$reqFld) {
    $reqFld = $reqFld["aid"] . "||" . $reqFld["fld_name"];
}
unset($reqFld); 
```

然后，您可以执行以下操作：

```
var reqFlds = <?php echo json_encode($reqFlds); ?>; 
```

输出：

```
<script>
var reqFlds = ["15||Job Issued","18||Job Title","20||Banner Details","202||Flyer Details","2134||Code Not above","5862||Quantity"];
</script> 
```

# visual-studio-2012 - Visual 2012 内置片段列表

> ID：14283967
> 
> 赞同：1
> 
> 时间：2013-01-11T17:58:28.733
> 
> 标签：visual-studio-2012, code-snippets

在哪里可以找到 Visual Studio 2012 的内置片段列表？

我想让自己更清楚。

就像输入 prop(tab)(tab) 时一样

我想要一个已经内置的列表，所以我不会尝试为已经内置的东西构建一个片段。

文件夹 /Documents/Visual Studio 2012/Code Snippets/

在我看来，这是放置您自己的代码片段的地方。

我想打印出所有这些的备忘单。所以就像PDF，网站等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-12-12T16:20:05.853

MSDN 包含 Visual Studio 版本的片段的 html 列表：http: [//msdn.microsoft.com/en-us/library/z41h7fat.aspx](http://msdn.microsoft.com/en-us/library/z41h7fat.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T18:01:04.070

内置片段位于文件夹
**%InstallRootLocation%\Microsoft Visual Studio 11.0\%lang%\Snippets\1033**

例如，
C# 代码片段 -> **%InstallRootLocation%\Microsoft Visual Studio 11.0\vc#\Snippets\1033**
C++ 代码片段 -> **%InstallRootLocation%\Microsoft Visual Studio 11.0\vc\Snippets\1033**

%%InstallLocation%% 通常`%Program Files%`在 32 位和 `%Program Files (x86)%`64 位系统上，但可以在 VS 安装过程中自定义。

自定义片段位于文件夹中

**%Documents%\Visual Studio 2012\代码片段**。

# php - 000webhost 服务网站数据库错误

> ID：14283970
> 
> 赞同：0
> 
> 时间：2013-01-11T17:58:45.263
> 
> 标签：php, mysql, database, logging, phpmyadmin

在我的 000webhost 网站上，我创建了这个 SQL 文件，名为`test.sql`

这是它的编码：

```
CREATE TABLE `members` (
`id` int(4) NOT NULL auto_increment,
`username` varchar(65) NOT NULL default '',
`password` varchar(65) NOT NULL default '',
PRIMARY KEY (`id`)
) TYPE=MyISAM AUTO_INCREMENT=2 ;
-- 
-- Dumping data for table `members`
--
INSERT INTO `members` VALUES (1, 'john', '1234'); 
```

之后我创建了另一个名为`main_login.php`

这是编码：

```
<table width="300" border="0" align="center" cellpadding="0" cellspacing="1" bgcolor="#CCCCCC">
<tr>
<form name="form1" method="post" action="checklogin.php">
<td>
<table width="100%" border="0" cellpadding="3" cellspacing="1" bgcolor="#FFFFFF">
<tr>
<td colspan="3"><strong>Member Login </strong></td>
</tr>
<tr>
<td width="78">Username</td>
<td width="6">:</td>
<td width="294"><input name="myusername" type="text" id="myusername"></td>
</tr>
<tr>
<td>Password</td>
<td>:</td>
<td><input name="mypassword" type="text" id="mypassword"></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><input type="submit" name="Submit" value="Login"></td>
</tr>
</table>
</td>
</form>
</tr>
</table> 
```

之后我准备了另一个名为`checklogin.php`

这是编码：

```
$host="I INSERTED MY LOCAL HOST HERE"; // Host name 
$username="I INSERTED MY USERNAME HERE"; // Mysql username 
$password="I TYPED MY PASSWORD HERE"; // Mysql password 
$db_name="[B]I AM CONFUSED THAT WHICH DATABASE SHOULD I NAME HERE[/B]  :eek: "; // Database name 
$tbl_name="members"; // Table name 

// Connect to server and select databse.
mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$db_name")or die("cannot select DB");

// username and password sent from form 
$myusername=$_POST['myusername']; 
$mypassword=$_POST['mypassword']; 

// To protect MySQL injection (more detail about MySQL injection)
$myusername = stripslashes($myusername);
$mypassword = stripslashes($mypassword);
$myusername = mysql_real_escape_string($myusername);
$mypassword = mysql_real_escape_string($mypassword);
$sql="SELECT * FROM $tbl_name WHERE username='$myusername' and password='$mypassword'";
$result=mysql_query($sql);

// Mysql_num_row is counting table row
$count=mysql_num_rows($result);

// If result matched $myusername and $mypassword, table row must be 1 row
if($count==1){

// Register $myusername, $mypassword and redirect to file "login_success.php"
session_register("myusername");
session_register("mypassword"); 
header("location:login_success.php");
}
else {
echo "Wrong Username or Password";
}
?> 
```

在第 4 行的 checklogin.php 中，我很困惑我应该提供哪个数据库名称。我尝试编写`test.sql`，因为我已经使用 SQL 文件创建了一个表，但是在登录时它显示错误并且登录表单无法获取 SQL 表数据。我已经在 000webhost.com 提供的服务中创建了一个 mySQL 文件并获取MySQL 用户名、MySQL 数据库和主机站点（让用户名`SQL_user`和站点），但目前不知道如何使用 MySQL。**那么我应该在`$db_name`上面**命名哪个文件？并且还想知道**如何在 000webhost.com 的 MySQL 中添加数据，以便登录表单可以获取登录信息**？

先感谢您...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T00:07:58.537

转到您的客户经理，选择正确的子域，然后单击 phpMyAdmin。使用此工具，您可以更改您的数据库。

使用 MySQL 管理器，您可以设置数据库的名称、用户名和密码：

```
MySQL database name: a2748273_my_dbname
MySQL user name: a2748273_my_username
Password for MySQL user: my_password 
```

这些凭据是您在连接到 Db 时必须在 PHP 脚本中指定的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T17:54:49.173

上面我问了2个问题：

**问题1.**那么我应该在`$db_name`上面命名哪个文件？

**Que 2.**如何在 000webhost.com 的 MySQL 中添加数据，以便登录表单可以获取登录信息？

以下是答案：

**Ans 1.**在**checklogin.php**中我必须这样写：

```
$host="INSERTED LOCAL HOST HERE"; // Host name 
$username="INSERTED USERNAME HERE"; // Mysql username 
$password="TYPED PASSWORD HERE"; // Mysql password 
$db_name="HERE WE HAVE TO INSERT MYSQL DATABASE NAME"; // Database name 
$tbl_name="members"; // Table name 
```

现在在上面`$db_name`我们将是您的**MySQL 数据库名称**，我将不得不在该数据库中创建另一个表。

**Ans 2.**在 000webhost 打开我的站点控制面板后，我必须**先打开 phpMyAdmin**并**创建一个数据库**，然后输入用户名、密码、本地主机等，**然后单击**右侧的“输入 phpMyAdmin” table 它将把我们带到另一个窗口，在那里我们必须创建数据库，这个数据库将是登录表单从中获取数据的地方。

# php - PHP脚本不在函数内部运行

> ID：14283971
> 
> 赞同：-2
> 
> 时间：2013-01-11T17:58:46.153
> 
> 标签：php, javascript, html

我的 PHP 脚本一直在工作，直到我将它移到 Javascript 函数中。不能这样做吗？

```
//Javascript
function displayPlace() 
{

//PHP
    <?php
    $place = mysql_query("select * from tblRestaurants order by RestName ASC");

    while ($nt= mysql_fetch_assoc($place))
    $arrData[] = $nt;
    if(isset($_GET["ajax"]))
     {
    echo json_encode($arrData);
    die();
     }
    ?>  

//Javascript
    $.getJSON("index.php?ajax=true", function(data) {
        $.each(data, function(index, objRecord) {
            var option=document.createElement("option");
            option.value=objRecord.RestID;
            option.text=objRecord.RestName;
            $("#Doggie").append('<option value="' + objRecord.RestID + '">' + objRecord.RestName     + '</option>'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T18:14:31.053

虽然该 PHP 片段可能与您放置它的 Javascript 函数相关，但因为您将它放置在代码的深处，它并没有返回正确的响应。

您的目标是，当您调用时`$.getJSON()`，PHP 将返回一个 JSON 编码的字符串......但是因为您将该 PHP 代码放置在您的页面中，所以不相关的文本字符（包括`function displayPlace(){`它之前的所有内容）将在 JSON 之前内联返回，这很令人困惑`$.getJSON()`

将该 PHP 片段放在代码的顶部以避免此问题。或者更好的是，创建一个单独的`json.php`页面来处理 JSON 请求。

* * *

**编辑澄清：**
不要把PHP放在那里。它不属于那里。

将 PHP 代码放在 Javascript 函数中*不会*导致该代码在调用 Javascript 函数时执行。当页面被请求时，PHP 在服务器上运行，一旦页面被提供，它就会停止*。
当您调用 JSON 函数时，您再次请求该页面，因此 PHP 将执行并返回*整个*页面，直到它到达该片段。您将得到一堆 HTML 和 Javascript，*然后*是一个 JSON 字符串，而不是返回一个有效的 JSON 字符串。此响应不可用。
无论您之前在哪里（当它工作时）有 PHP 代码片段都是合适的。一种更易于维护的做法是将所有与返回 JSON 相关的 PHP 代码移动到名为 的文件*中*`json.php`，然后请求*文件来自`$.getJSON()`而不是`index.php`*

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T18:05:58.990

我猜你正在点击`die()`整个脚本中的哪个退出。之后不会将任何 javascript 发送到浏览器，因为 php 表示“此页面已完成，不要输出任何其他内容”。脚本的其余部分将停止。删除它，它应该会有所帮助。*

# ruby-on-rails - 什么 ruby gem 提供从网页中提取内容的功能？

> ID：14283974
> 
> 赞同：3
> 
> 时间：2013-01-11T17:58:56.153
> 
> 标签：ruby-on-rails, gem, html-content-extraction

我正在为我的 ruby​​ on rails 项目寻找一个 ruby​​ gem，用于从网页中提取内容。我找到了[ruby​​-readability gem](https://github.com/iterationlabs/ruby-readability)，但它不支持文章的多页。你能推荐一个也支持多页文章提取的gem吗？

或者我如何编码识别文章上的多个站点的能力？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T18:11:06.380

[您可以将Pismo](https://github.com/peterc/pismo)之类的高级 gem与[Mechanize](http://railscasts.com/episodes/191-mechanize)结合使用，以迭代地遍历每个页面并连接文章的正文。为此，您需要知道哪个链接将您带到下一页。谷歌正在推动采用基于 rel 属性的约定

`<a href="blog-post?page=2" rel='next'>next</a>`

这是一个非常粗略的 ruby​​ 代码草稿：

```
agent = WWW::Mechanize.new
agent.get("http://www.awesomeblog.com/amazing-article")

scraper.text = MyScraper.new(:text => Pismo::Document.new(agent.url))

while agent.page.link_with("rel='next'").click do
  pismo_doc = Pismo::Document.new(agent.url)
  scraper.text << pismo_doc.lede
end

scraper.save! 
```

这是伪代码/疯狂的猜测（我不知道机械化的 API），但你明白了。

# net-snmp - linux平台下C语言SNMPv3源码

> ID：14283975
> 
> 赞同：0
> 
> 时间：2013-01-11T17:59:03.010
> 
> 标签：net-snmp

在哪里可以获得 Net SNMP 库和工具链接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T12:43:45.603

问题是什么？

这是[**Net-SNMP 的主页**](http://www.net-snmp.org/)。 [下载工具和源代码](http://www.net-snmp.org/download.html)及其在 GNU 许可下的开源代码的页面。您可以自己编译并安装。如果你愿意，你也可以修改代码。这[是图书馆文档](http://www.net-snmp.org/dev/agent/group__library.html)。SNMPv3的[详细信息在这里](http://www.ietf.org/rfc/rfc2571.txt)。

# perl - Windows Emacs shell/shell 无法执行 ack perl 脚本（语言环境错误）

> ID：14283977
> 
> 赞同：2
> 
> 时间：2013-01-11T17:59:07.293
> 
> 标签：perl, emacs, cygwin, locale, ack

在常规 cmd.exe 或 cygwin termal 上键入此命令会得到预期的结果：

```
$ ack hello 
```

（我有 ack.bat 在我的 PATH 中执行 ack.pl）

但是，当我从 Emacs 中的 shell 或 eshell 运行相同的命令时，它给了我这个错误：

```
c:\Users\Martin>"C:\cygwin\bin\perl" /cygdrive/c/Users/Martin/Desktop/ack.pl hello 
perl: warning: Setting locale failed.
perl: warning: Please check that your locale settings:
    LC_ALL = (unset),
    LANG = "ENU"
    are supported and installed on your system.
perl: warning: Falling back to the standard locale ("C"). 
```

我试图通过 SETENV 将这两个变量都修复为 en_US.UTF-8 但是当我再次运行它时，它没有给我任何结果，而是冻结了。

***更新***：我终于找到了解决这个问题的方法。我需要的只是添加`< NUL`到命令的末尾，因为它将 Linux 风格的 NULL DEVICE 解析为默认值。

现在，如果我输入：

```
ack hello < NUL 
```

它会给我预期的结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-06-27T00:55:12.290

这个问题与 ack 本身无关，而是珍珠，Ack 是用这种语言编写的。perl 报告的是，您运行 emacs 的环境没有设置语言环境设置。将以下行添加到您运行 emacs 的任何环境中：

```
export LC_CTYPE=en_US.UTF-8
export LC_ALL=en_US.UTF-8 
```

注意：运行`ack hello < NUL`只会掩盖问题，并不能解决问题。

# json - 对于 CakePHP 控制器，JSON 应该是什么样的？

> ID：14283978
> 
> 赞同：-1
> 
> 时间：2013-01-11T17:59:08.673
> 
> 标签：json, api, cakephp, cakephp-2.2

我正在创建一个存储用户旅程的 Web 应用程序，并且我在 CakePHP 2.2.5 中构建了这个应用程序。

我有一个 Journey 模型，该 Journey 模型有许多坐标对象，这些对象存储经纬度坐标。

我想向主体中包含 json 的旅程的 add 方法发送一个 API 调用，以创建一个新对象。

我试图找出如何格式化 JSON 以允许控制器使用它，但我似乎无法找到。我还想知道如何将子对象添加到 JSON。

我正在使用此 cURL 命令测试该方法

```
curl -i -H "ACCEPT: application/json" -X POST --data @/home/sam/data.json http://localhost/journeys/add.json 
```

运行此 CURL 命令会在数据库中创建一个空白条目。

CURL 中包含的 JSON 文件包含

```
{"description" : "Hello World", "user_id":3} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T18:15:09.180

最好将 json 转换为数组（带`json_decode`函数）然后操作你的数组，如果你想最后将它转换为 json（`json_encode`函数）。

[cakePHP 通过JsHelper::object](http://book.cakephp.org/2.0/en/core-libraries/helpers/js.html#JsHelper%3a%3aobject)处理此任务

编辑1：但我认为当php为你做这件事时，最好使用php纯函数而不是cakePHP函数。

编辑 2：我认为 cakePHP 不处理它，你应该自己处理它，将你的 json 转换为数组，根据需要更改你的数组，`foreach`然后将它传递给 saveAll 函数以在数据库中插入或更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T16:14:16.993

我做了更多的研究并找到了解决我的问题的方法：

CakePHP 将保存 JSON 数据，它还将保存嵌套模型信息。

```
$data = $this->request->input('json_decode'); 
```

这与@Arash 所说的类似，但它也会通过调用保存嵌套模型信息

```
$this->Journey->saveAssociated($data) 
```

我提供给控制器的 JSON 如下所示：

```
{"Journey":
{"description":"Not even an article from the map", "user_id":3}, 
"Coordinate":[
    {"lat":54.229149, "lng":-5.114115},
    {"lat":54.39153, "lng":-5.114113}
 ]
} 
```

坐标属于Journey。

# hive - 合并两个表的连接中的列

> ID：14283979
> 
> 赞同：1
> 
> 时间：2013-01-11T17:59:19.703
> 
> 标签：hive, hiveql

我在 Hive 数据库中有以下表：

```
table1:
id  t     X
1   1     a
1   4     a
2   5     a
3   10    a

table2:
id   t    Y
1    3    b
2    6    b
2    8    b
3    15   b 
```

我想将它们合并成一个像这样的表：

```
id   t    Z
1    1    a
1    3    b
1    4    a
2    5    a
2    6    b
2    8    b
3    10   a
3    15   b 
```

基本上我想做的是：

1.  列上的连接`id`（这部分很简单）

2.  将列合并`table1.t`到`table2.t`一个新列中`t`

3.  如果对应的来自，`Z`则具有等于的变量，如果它来自`table1.X``t``table1.t``table2.Y``table2.t`

4.  `id`按顺序排列桌子`t`（这不应该太难）

我不知道如何执行第 2 部分和第 3 部分。我尝试使用外连接 `table1.id = table2.id and table1.t = table2.t`，但它没有合并两列`t`。

任何指针将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T18:16:18.350

试试这个。它将在表 3 中插入​​其他 2 个表中的所有值

INSERT INTO table3 (t, Z) SELECT t, X FROM table1 UNION ALL SELECT t, Y FROM table2

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T02:09:53.683

```
CREATE TABLE table3 as SELECT * FROM (SELECT id,t,X as Z FROM t3_1 UNION ALL SELECT id,t,Y as Z FROM t3_2) u1 order by id,t; 
```

`u1.id`虽然并不总是需要，但使用联合查询的子查询有助于组织，此外，您可以在查询的其他部分引用联合中的字段（例如）。

您需要第三列的别名来使模式匹配。如果源表名称还不是一列，您可以执行以下操作：

```
select * from (select id,t,'a' from t3_1 UNION ALL select id,t,'b' from t3_2) u1; 
```

# c# - Windows Phone 8 Web 请求异步调用 XML

> ID：14283985
> 
> 赞同：0
> 
> 时间：2013-01-11T17:59:47.953
> 
> 标签：c#, windows-phone-8, webrequest

我有一个生成 XML 的 php 服务。如何在 C# 中解析 XML？我尝试使用这样的东西：

```
WebRequest request = WebRequest.Create("http://devstage.jokeroo.com/rest.php");
request.Method = "GET";
request.ContentType = "text/html";
IAsyncResult result = request.BeginGetResponse(RequestCallback, request);

private void RequestCallback(IAsyncResult ar)
    {
        var request = ar.AsyncState as WebRequest;
        Stream reader = request.EndGetResponse(ar).GetResponseStream();
        //use this reader to read the content
    } 
```

但它不断抛出这个异常：

`'System.Net.ProtocolViolationException'`发生类型异常`System.Windows.ni.dll`但未在用户代码中处理

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-12T02:17:53.977

摆脱这一行：

```
request.ContentType = "text/html"; 
```

您正在发出 GET 请求，因此没有请求正文；因此，设置内容类型（对于不存在且不受支持的 HTTP 请求正文）是导致错误的原因。

# ios - iOS 配件 SDK - 3.5mm 插孔控制

> ID：14283986
> 
> 赞同：0
> 
> 时间：2013-01-11T17:59:48.210
> 
> 标签：ios, sdk, external, accessory, jack

我想创建一个通过 3.5 毫米插孔与 iPhone/iPad 交互的项目。kickstarter.com 上有很多这样的配件。虽然，我找不到任何可以让我从插孔输入中获取数据的 SDK。

我看到 progical.com 上的一些人有一种可以管理这种连接的 SDK，但他们还没有回答我（几个月前我申请了他们的 SDK）。有什么替代方案吗？我想做这个项目是为了获得我的学位，这样 Apple MFI 就不会申请了。

该项目将包含一堆传感器，它们将使用 3.5 音频插孔将数据发送到我的应用程序。使用我的应用程序，我将处理收到的数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T18:29:24.800

3.5" Jack 连接器原本是用来发送和接收音频数据的。这意味着如果插入连接，操作系统会自动将所有音频信号重定向到它（有少数例外）。因此，您可以使用iOS 内置的音频处理 API，例如 CoreAudio 和音频队列。

例如，您可以生成和接收不同频率的信号，这些信号可用于控制和从外部设备获取信息（不过，您需要某种电气工程才能使其工作 - 过滤、分离控制频率等.)。

# java - 用于枚举的自定义 Xstream/JSON 转换器

> ID：14283987
> 
> 赞同：1
> 
> 时间：2013-01-11T17:59:59.330
> 
> 标签：java, json, enums, xstream, oxm

我有以下内容`Enum`：

```
public enum MyState {
    Open("opened"),
    Close("closed"),
    Indeterminate("unknown");

    private String desc;

    private MyState(String desc) {
        setDesc(desc);
    }

    public String getDesc() {
        return this.desc;
    }

    private void setDesc(String desc) {
        this.desc = desc;
    }
} 
```

我正在尝试编写一个 XStream [`Converter`](http://xstream.codehaus.org/converter-tutorial.html)，它知道将 JSON 元素“ `mystate`”映射回一个`MyState`实例。

```
"someJson": {
    "object1": {
        "mystate": closed
    }
} 
```

除了其他对象（`someJson`和`object1`）之外，这应该产生一个`MyState.Close`实例。我已经开始了`Converter`，但还没有走得很远：

```
public class MyStateEnumConverter implement Converter {
    @Override
    public boolean canConvert(Class clazz) {
        return clazz.equals(MyState.class);
    }

    @Override
    public void marshal(Object value, HierarchialStreamWriter writer, MarshallingContext context) {
        ??? - no clue here
    }

    @Override
    public Object unmarshal(HierarchialStreamReader reader, UnmarshallingContext context) {
        ??? - no clue here
    }
} 
```

然后，创建映射器并使用它：

```
XStream mapper = new XStream(new JettisonMappedXmlDriver());
mapper.registerConverter(new MyStateEnumConverter);

SomeJson jsonObj = mapper.fromXML(jsonString);

// Should print "closed"
System.out.println(jsonObject.getObject1().getMyState().getDesc()); 
```

如何实现`marshal`并`unmarshal`获得所需的映射？提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T16:44:34.543

您可以通过做 2 件事来完成此操作：

1.  添加一个查找方法以及一个`toString()`覆盖到你的枚举（`MyStateEnum`）；和
2.  扩展 XStream`AbstractSingleValueConverter`而不是实现`Converter`

`MyStateEnum`：

```
public enum MyStateEnum {
    // Everything you had is fine

    // But now, add:
    public static MyStateEnum getMyStateByDesc(String desc) {
        for(MyStateEnum myState : MyStateEnum.values())
            if(myState.getDesc().equals(desc))
                return myState;

        return null;
    }

    @Override
    public String toString() {
        return getDesc();
    }
} 
```

`MyStateEnumConverter`：

```
public class MyStateEnumConverter extends AbstractSingleValueConverter {
    @Override
    public boolean canConvert(Class clazz) {
        return clazz.equals(MyStateEnum.class);
    }

    @Override
    public Object fromString(String parsedText) {
        return MyStateEnum.getMyStateByDesc(parsedText);
    }
} 
```

通过添加到枚举中，您现在可以通过提供字符串`getMyStateByDesc(String)`来从外部查找所有各种枚举值。(which extends )`desc`在后台使用您的覆盖将实例与文本字符串相关联。`MyStateEnumConverter``AbstractSingleValueConverter``toString()``MyStateEnum`

因此，当 XStream 解析 JSON 时，它会看到一个 JSON 对象，比如“opened”，并且这个新转换器知道将“opened”传递给转换器的`fromString(String)`方法，该方法反过来用于`getMyStateByDesc(String)`查找适当的枚举实例。

不要忘记在您的`XStream`实例中注册您的转换器，正如您在原始问题中已经显示的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-21T14:31:07.837

您可以使用 EnumToStringConverter

[文档](http://x-stream.github.io/javadoc/com/thoughtworks/xstream/converters/enums/EnumToStringConverter.html)

例子

```
@XStreamConverter(EnumToStringConverter.class)
public enum MyStateEnum {
enter code here

... 
```

使用 xstream.autodetectAnnotations(true)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-11T18:42:16.873

为什么要使用 xstream 来支持 json？您有几个其他专门用于 json 的库，并且做得很好。不带引号也关闭是无效的 json。

尝试例如[Genson](http://code.google.com/p/genson/)，它会开箱即用。json 流中的值将是“关闭”、“不确定”等，并且在反序列化时会产生正确的枚举。

```
class SomeObject {
   private MyState state;
   ...
}

Genson genson = new Genson();
// json = {"state" : "Indeterminate"}
String json = genson.serialize(new SomeObject(MyState.Indeterminate));

// deserialize back
SomeObject someObject = genson.deserialize(json, SomeObject.class);

// will print unknown
System.out.println(someObject.getDesc()); 
```

# php - 将发布在 PHP 服务器上的图像发送到 Amazon S3

> ID：14283991
> 
> 赞同：0
> 
> 时间：2013-01-11T18:00:21.673
> 
> 标签：php, amazon-web-services, amazon-s3

我正在使用以下 PHP 代码来获取从移动设备上传的图像：

```
<?php
   $base=$_REQUEST['image'];
   $binary=base64_decode($base);
   header('Content-Type: bitmap; charset=utf-8');
   $file = fopen('uploaded_image.jpg', 'wb');
   fwrite($file, $binary);
   fclose($file);?> 
```

我想将这些图像直接发送到亚马逊的 S3 服务。我每次都必须在磁盘上写入 JPEG 吗？我不能将二进制文件发送到 Amazon S3 并让它生成 JPEG 吗？我担心本地写入会影响我的服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T18:06:26.273

您可能需要考虑使用 s3fs 将 S3 存储桶挂载为服务器上的本地驱动器。然后，您可以将文件直接写入该挂载位置。如果您希望您的应用程序能够读取这些文件，您还可以指定一个本地目录用作 s3fs 挂载的缓存以加快速度。

这是 s3fs Google 代码页面的链接：[http ://code.google.com/p/s3fs/](http://code.google.com/p/s3fs/)

# javascript - 链接可以滚动到页面顶部并在 iframe 中打开页面吗？

> ID：14283992
> 
> 赞同：0
> 
> 时间：2013-01-11T18:00:24.663
> 
> 标签：javascript, html

我试图弄清楚如何让我的所有链接滚动到页面顶部以及在我的 iframe 中打开所需的页面。这可能吗？我需要链接来执行两个不同的功能。

**报警标准**

```
 <script>
                    function myFunction() {
                    // Scroll to top
                                document.body.scrollTop = document.documentElement.scrollTop = 0;

                    // Open up a link in my iframe
                            <A HREF="DocDisplayCategory.cfm?CategoryID=47" TARGET="MainWindow">
                            </A>
                                  } 
                </li>
                </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T18:04:35.383

您可以只使用事件处理程序。

```
<a href="#" onClick="myFunction();" >Click Me</a>

<script>
    function myFunction() {
        // Scroll to top
        document.body.scrollTop = document.documentElement.scrollTop = 0;

        // Open up a link in my iframe

        document.getElementById('frame1').src="http://www.foo.com/" 
    }
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T18:06:05.813

对于滚动，请看这里；[使用 JavaScript/jQuery 滚动到页面顶部？](https://stackoverflow.com/questions/1144805/how-do-i-scroll-to-the-top-of-the-page-with-jquery)
要在 iframe 中打开链接，只需指定[`target`](http://webdesign.about.com/od/iframes/qt/target-links-iframes-and-frames.htm)

您也可以使用 jquery 自动创建目标。

# python - Python 列表比较和打印

> ID：14283996
> 
> 赞同：-3
> 
> 时间：2013-01-11T18:00:29.000
> 
> 标签：python, list

我有两个清单：

```
chars = ["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]; 
```

和

```
cipher = ["AA","AB","AC","AD","AE","AF","BA","BB","BC","BD","BE","BF","CA","CB","CC","CD","CE","CF","DA","DB","DC","DD","DE","DF","EA","EB","EC","ED","EE","EF","FA","FB","FC","FD","FE","FF"]; 
```

我想要这样，如果用户输入一行文本，它将字符中的文本与密码进行比较，例如，字符的第五个元素（“4”）对应于密码中的第五个元素（“AE” )，然后打印出来。如何做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-11T18:01:48.613

我想你想要一[本字典](http://docs.python.org/2/tutorial/datastructures.html#dictionaries)（另一个[链接](http://docs.python.org/2/library/stdtypes.html#typesmapping)）：

```
d = dict(zip(chars,cipher)) 
```

然后，要从角色中获取密码，您可以：

```
print d[whatever_char]  #prints the cipher associated with that character 
```

# c# - 保持控制台运行以等待响应

> ID：14283998
> 
> 赞同：1
> 
> 时间：2013-01-11T18:00:31.853
> 
> 标签：c#

我有一个控制台应用程序。我提示用户输入...我的代码完成了它的工作，最后尝试将输出打印回用户。

以下是我尝试将输出回发到同一个控制台窗口的方法，以便他们可以看到结果：

```
 Console.WriteLine( "Output: ");
    Console.WriteLine(resultMessage); 
```

问题是我的控制台在显示 resultMessage 之前关闭。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T18:02:26.953

您可以使用`Console.ReadKey(true);`它等待任何按键

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T18:02:36.957

当您在 VS 中时，您还可以按`Ctrl`和`f5`在调试器之外打开您的应用程序。

这样做的结果是当你的程序说完时你的窗口会停留在

`Press any key to continue`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T18:13:41.750

多一个`Console.Read...`

```
if (Debugger.IsAttached)
{
    Console.Write("Press Enter to exit: ");
    Console.ReadLine();
} 
```

我认为在使用输出重定向到文件的情况下会更好 `ConsoleApp.exe >results.txt`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T18:32:09.250

使用 Console.ReadKey(); 输出写入控制台后。