# StackOverflow 问答 14782000-14782999

# c# - WSE Web 服务客户端 SoapHeaderException

> ID：14782000
> 
> 赞同：0
> 
> 时间：2013-02-08T21:59:20.487
> 
> 标签：c#, soap-client, soapheader, wse

我正在尝试构建一个与第 3 方 SOAP Web 服务交互的客户端。此 Web 服务需要 WSE 安全性。

我从我尝试与之交互的服务的 WSDL 生成了一个老式的 .asmx Web 服务。WSDL 中没有关于 WSE 安全性的信息。

如果没有 WSE 安全，我可以正常连接。但是，我将 WSE 安全性添加到了我的 .asmx Web 服务中。

我将以下代码添加到我的客户端以添加 WSE 用户名和密码

```
SoapContext requestContext = host.RequestSoapContext;
UsernameToken userToken = new UsernameToken("username", "password", PasswordOption.SendPlainText);
requestContext.Security.Tokens.Add(userToken); 
```

但是，现在当我调用 ProcessMessage 方法时，我得到以下异常，它并没有告诉我太多：

> System.Web.Services.Protocols.SoapHeaderException：服务器不可用，请稍后再试
> 
> 在 System.Web.Services.Protocols.SoapHttpClientProtocol.ReadResponse（SoapClientMessage 消息，WebResponse 响应，流 responseStream，布尔 asyncCall）
> 
> 在 System.Web.Services.Protocols.SoapHttpClientProtocol.Invoke（字符串方法名，对象 [] 参数）
> 
> 在 C:\Projects\Reynolds.Core\Reynolds.Core\Web References\STARProxy\Reference.cs:line 105 中的 Reynolds.Core.STARProxy.STARWebService.ProcessMessage(Payload& payload)
> 
> 在 Reynolds.Core.reynolds.SendGenericXMLRequest(XmlElement[] inputElements, String url, Guid[] guids) 在 C:\Projects\Reynolds.Core\Reynolds.Core\Reynolds.cs:line 191
> 
> 在 C:\Projects\Reynolds.Core\Reynolds.Core\Reynolds.cs:line 125 中的 Reynolds.Core.reynolds.SendGenericSingleXMLRequest(XmlElement inputXML, String url, Guid guid)
> 
> 在 Reynolds.Core.reynolds.SendGenericSingleXMLRequest(XmlElement inputXML, String url) 在 C:\Projects\Reynolds.Core\Reynolds.Core\Reynolds.cs:line 120
> 
> 在 C:\Projects\Reynolds.Core\Reynolds.Core\Reynolds.cs:line 114 中的 Reynolds.Core.reynolds.SendGenericSingleXMLRequest(XmlElement inputXML)
> 
> 在 C:\Projects\Reynolds.Testing\Reynolds.Testing.GUI\Form1.cs:line 33 中的 Reynolds.Testing.GUI.Form1.btnProcessMessage_Click(Object sender, EventArgs e)

这个例外并没有真正让我在这里工作。我尝试进行各种谷歌搜索，但无法到达任何地方。

这是我第一次使用 WSE，因此将不胜感激。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-08T22:02:22.753

异常状态`Server unavailable, please try later`。这意味着您的第 3 方 Web 服务的 URL 有误，或者第 3 方服务器已关闭。

# c# - Sitecore 动态更改字段工具提示

> ID：14782002
> 
> 赞同：4
> 
> 时间：2013-02-08T21:59:30.163
> 
> 标签：c#, asp.net, content-management-system, sitecore, sitecore6

有没有办法在内容编辑器中动态更改项目的工具提示？它不一定是工具栏 - 我只是想输出一个基于字段旁边的项目和字段的文本，以显示该字段的默认值是什么。到目前为止，在管道处理器中，无法设置任何字段属性 - 它们都是只读的。知道我怎么可能只是标记它，或者类似的东西吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-09T16:15:33.687

是的，可以这样做，但它确实需要少量代码反射来修改内容编辑器中各个字段的外观，因为目前在字段级别上没有可用于内容编辑器的 Sitecore 管道。

1.  创建一个继承自 Sitecore.Shell.Applications.ContentEditor.EditorFormatter 的类 MyEditorFormatter。
2.  使用 Reflector 或 DotPeek 之类的工具，将两个方法的实现从原始 EditorFormatter 复制到新类中：

    ```
    public virtual void RenderField(System.Web.UI.Control parent, Editor.Field field, bool readOnly)
    {...}
    public void RenderLabel(System.Web.UI.Control parent, Editor.Field field, Item fieldType, bool readOnly)
    {...}
    ```

    **注意：** RenderLabel 是编写字段级工具提示的方法，但由于它不是虚拟的，因此覆盖其功能的唯一方法是覆盖调用它的 RenderField。
3.  将 RenderField 的签名从**virtual**更改为**override**。这将导致调用 args.EditorFormatter.RenderField 来运行新代码。
4.  在 RenderLabel 中插入所需的工具提示逻辑：

    ```
    if (itemField.Description.Length > 0)
    {
      str4 = " title=\"" + itemField.Description + " (custom text)\"";
    }
    ```

    **注意：**您可以用新逻辑替换**（自定义文本） 。**另请注意，您可能希望删除对 Description.Length 的检查，因为如果未填充 Description，这将阻止您的新工具提示出现。
5.  创建一个管道处理器，用您的替换 Sitecore 的 EditorFormatter：

    ```
    using Sitecore.Shell.Applications.ContentEditor.Pipelines.RenderContentEditor;
    namespace CustomizedEditor
    {
      public class ChangeToMyEditorFormatter : RenderStandardContentEditor
      {
        public void Process(RenderContentEditorArgs args)
        {
            args.EditorFormatter = new MyEditorFormatter();
            args.EditorFormatter.Arguments = args;
        }
      }
    } 
    ```

    填充 EditorFormatter.Arguments 是防止空对象异常所必需的。
6.  将您的管道处理器添加到 RenderContentEditor 管道的开头：

    ```
     <renderContentEditor>

      <processor type="CustomizedEditor.ChangeToMyEditorFormatter, CustomizedEditor" />

      <processor type="Sitecore.Shell.Applications.ContentEditor.Pipelines.RenderContentEditor.RenderSkinedContentEditor, Sitecore.Client" />

      <processor type="Sitecore.Shell.Applications.ContentEditor.Pipelines.RenderContentEditor.RenderStandardContentEditor, Sitecore.Client" />

    </renderContentEditor> 
    ```

您的自定义工具提示现在将出现：
![自定义工具提示](../Images/eea2824666cb35a69ec27df3ab1d82f9.png)

**更新：** Mike Reynolds 写了一篇非常好的[文章](http://sitecorejunkie.com/2013/03/09/where-is-this-field-defined-add-goto-template-links-for-fields-in-the-sitecore-content-editor/)，展示了如何使用这种方法向内容编辑器添加“此字段在哪里定义”功能。

# unicode - 如何在 P4V 客户端中设置 P4CHARSET？

> ID：14782007
> 
> 赞同：1
> 
> 时间：2013-02-08T21:59:58.997
> 
> 标签：unicode, perforce, p4v

当我尝试在 P4V 中运行一个工具来获取我的最新更改列表时，它给出了以下错误：

> Unicode 客户端需要启用 Unicode 的服务器。

该工具配置如下：

![上次同步工具](../Images/9947009c92caac9192d687e73c47b072.png)

但是，如果我直接从命令行运行相同的命令，它就可以正常工作。我运行这个命令：

> p4 更改 -m1 @mhughson_ce6

我已经仔细检查了我的注册表，但我**没有**“P4CHARSET”条目。

据我了解，P4V 存储自己的值，并且不使用注册表。我猜，它以某种方式将 P4CHARSET 设置为 P4V 中的某个值，但我无法弄清楚如何实际更改它。当我查看 P4V 中的连接信息时，没有关于 P4CHARSET 的信息。

* * *

**2013 年 2 月 12 日更新：**

我已经运行了一些 p4 命令来打印出我的环境变量，只是为了 100% 确定没有设置 P4CHARSET。这是结果。

```
p4 set -s
P4CLIENT=mhughson_ce6 (set)
P4EDITOR=C:\Program Files (x86)\Notepad++\notepad++.exe (set)
P4PASSWD=[removed]
P4PORT=[removed]
P4USER=mhughson (set) 
```

-

```
p4 set
P4CLIENT=mhughson_ce6 (set)
P4EDITOR=C:\Program Files (x86)\Notepad++\notepad++.exe (set)
P4PASSWD=[removed]
P4PORT=[removed]
P4USER=mhughson (set) 
```

-

```
set
ALLUSERSPROFILE=C:\ProgramData
AMDAPPSDKROOT=C:\Program Files (x86)\AMD APP\
APPDATA=C:\Users\[removed]\AppData\Roaming
CLASSPATH=.;C:\Program Files (x86)\QuickTime\QTSystem\QTJava.zip
CommonProgramFiles=C:\Program Files\Common Files
CommonProgramFiles(x86)=C:\Program Files (x86)\Common Files
CommonProgramW6432=C:\Program Files\Common Files
COMPUTERNAME=[removed]
ComSpec=C:\Windows\system32\cmd.exe
FP_NO_HOST_CHECK=NO
HOMEDRIVE=C:
HOMEPATH=\Users\[removed]
LOCALAPPDATA=C:\Users\[removed]\AppData\Local
LOGONSERVER=\\[removed]
NUMBER_OF_PROCESSORS=8
OS=Windows_NT
Path=C:\Program Files (x86)\AMD APP\bin\x86_64;C:\Program Files (x86)\AMD APP\bi
n\x86;C:\Program Files\Common Files\Microsoft Shared\Windows Live;C:\Program Fil
es (x86)\Common Files\Microsoft Shared\Windows Live;C:\Program Files (x86)\Post-
Review;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System
32\WindowsPowerShell\v1.0\;C:\Program Files\Perforce;c:\Program Files (x86)\Micr
osoft SQL Server\100\Tools\Binn\;c:\Program Files\Microsoft SQL Server\100\Tools
\Binn\;c:\Program Files\Microsoft SQL Server\100\DTS\Binn\;C:\Program Files (x86
)\QuickTime\QTSystem\;C:\Program Files (x86)\ATI Technologies\ATI.ACE\Core-Stati
c;C:\Program Files (x86)\Xoreax\IncrediBuild;C:\Program Files (x86)\Perforce;C:\
Program Files (x86)\Windows Live\Shared
PATHEXT=.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC
PROCESSOR_ARCHITECTURE=AMD64
PROCESSOR_IDENTIFIER=Intel64 Family 6 Model 58 Stepping 9, GenuineIntel
PROCESSOR_LEVEL=6
PROCESSOR_REVISION=3a09
ProgramData=C:\ProgramData
ProgramFiles=C:\Program Files
ProgramFiles(x86)=C:\Program Files (x86)
ProgramW6432=C:\Program Files
PROMPT=$P$G
PSModulePath=C:\Windows\system32\WindowsPowerShell\v1.0\Modules\
PUBLIC=C:\Users\Public
QTJAVA=C:\Program Files (x86)\QuickTime\QTSystem\QTJava.zip
SESSIONNAME=Console
SystemDrive=C:
SystemRoot=C:\Windows
TEMP=C:\Users\[removed]\AppData\Local\Temp
TMP=C:\Users\[removed]\AppData\Local\Temp
USERDOMAIN=[removed]
USERNAME=[removed]
USERPROFILE=C:\Users\[removed]
VS100COMNTOOLS=c:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\Tools
\
windir=C:\Windows
windows_tracing_flags=3
windows_tracing_logfile=C:\BVTBin\Tests\installpackage\csilogfile.log 
```

-

```
p4 info
User name: mhughson
Client name: mhughson_ce6
Client host: [removed]
Client root: D:/ce6
Current directory: c:\Users\[removed]
Client address: [removed]
Server address: [removed]
Server root: /metadata_journal
Server date: 2013/02/12 18:30:48 +0100 CET
Server uptime: 798:35:46
Server version: P4D/FREEBSD70X86_64/2011.1/370818 (2011/10/19)
Proxy address: [removed]
Proxy version: P4P/NTX64/2012.2/551823 (2012/11/09)
Server license: [removed]
Server license-ip: [removed]
Case Handling: sensitive 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-02T22:13:24.307

我在一台机器上遇到了同样的问题，但在另一台机器上没有，但命令行不是 P4V。我没有设置 P4CHARSET。我尝试了此线程中列出的所有内容以及更多内容，但对我有用的是在我的注册表中搜索 P4CHARSET，并且我删除了一个密钥。现在它可以工作了

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-30T15:43:17.083

我遇到了同样的问题并设法通过从 中删除字符集来解决它，该字符集`WorkspaceSettings.xml`位于您的用户目录下`.p4qt`，例如在我的系统上，我有多个已`Charset`定义的连接 - 这导致了问题：

```
.p4qt/0004Clients/WorkspaceSettings.xml:  <String varName="Charset">utf8-bom</String>
.p4qt/0007Clients/WorkspaceSettings.xml:  <String varName="Charset">utf8-bom</String>
.p4qt/0009Clients/WorkspaceSettings.xml:  <String varName="Charset">utf8-bom</String> 
```

在 中`WorkspaceSettings.xml`，删除`Charset`设置，保存并重启 P4V：

```
 <PropertyList varName="Connection" IsManaged="TRUE">
  <String varName="Charset">utf8-bom</String>
 </PropertyList> 
```

不幸的是，我找不到*在*P4V 中修改它的方法，但删除它意味着 P4V 不再假设服务器是 unicode 感知的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-14T02:38:38.440

可悲的是，我无法为自己解决这个问题。不是通过设置/取消设置的任何组合`P4CHARSET`。

解决方案？遗憾`p4`的是，从命令行使用。我可以可靠地设置/取消设置 PC 环境变量，并通过该机制调用我的第三方工具。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-01-11T10:10:16.000

编辑 .p4qt/WorkspaceSettings.xml 对我有用。它默认设置为“winansi”，当我尝试从 IDEA 连接插件时导致错误。

# eclipse-rse - 无法在 Eclipse 中使用 rse 输入 shell 命令

> ID：14782018
> 
> 赞同：1
> 
> 时间：2013-02-08T22:00:32.263
> 
> 标签：eclipse-rse

我也有同样的问题。我可以在远程 Shell 视图的提示符中输入命令，但是在我按 Enter 后命令没有响应。我有一个到 localhost 的连接，并且假设我不必为 dos shell 立即工作进行任何配置。dstore 守护程序正在运行，并且当我启动 shell 时，在 RSE Shell 视图中确实出现了 dos 提示符，但是像“ls”和/或“pwd”这样的简单命令不会在 Shell 视图中引起响应。我希望它能够像普通的 dos shell 一样运行。我遗漏了什么吗？

# java - 我们可以自定义 FileInputFormat 的 InputSplit 大小吗

> ID：14782019
> 
> 赞同：2
> 
> 时间：2013-02-08T22:00:41.580
> 
> 标签：java, hadoop, mapreduce

让我们考虑一个生成 1000 个地图任务的 MapReduce 作业。块大小：128MB 最小分割大小：1MB 最大分割大小：256MB

块大小似乎是极限值。我们可以将分割大小增加到块大小之外吗？

这是 FileInputFormat.java 中的一个函数

```
protected long computeSplitSize(long goalSize, long minSize, long blockSize) {
    return Math.max(minSize, Math.min(goalSize, blockSize));
} 
```

基于上述函数最小分割大小大于块大小将做我想要的。有人可以阐明以这种方式设置最小拆分大小的任何副作用吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T01:31:18.140

为此，您必须了解它`goalSize`是指总输入大小除以`JobConf.getNumMapTasks()`. 这个计算的意思是：

*   拆分将不小于文件中的剩余数据或`minSize`.
*   拆分不会大于 和 中的较小`goalSize`者`blockSize`。

鉴于此，您可以理解理想的拆分大小恰好是 1 个块大小，因为它允许框架为处理拆分的任务提供数据局部性。（来源：[Pro Hadoop](http://www.springer.com/computer/book/978-1-4302-1942-2)）

如果您想将分割大小增加到块大小之外，这意味着每个映射器都需要进行远程读取来读取非本地数据，因此效率可能会降低。但除非你试图制造巨大的分裂，否则我怀疑这会对性能产生重大影响。我仍然建议尽可能保持默认拆分大小，除非您有一个可靠的用例，这不起作用。

# javascript - AJAX：直播功能麻烦

> ID：14782020
> 
> 赞同：2
> 
> 时间：2013-02-08T22:00:41.540
> 
> 标签：javascript, ajax, events

我正在尝试使用 jquery 制作购物车动画，为此我有一个脚本，可以在 mouseover 事件上加载一个 div：

```
$('#cart > .heading a').live('mouseover',function() {
    $('#cart').load('index.php?route=module/cart #cart > *');
    $('#cart').addClass('active');  
});
$('#cart').mouseleave(function() {
    $('#cart').removeClass('active');
}); 
```

但问题是，使用“实时”功能，标签不再起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:08:01.903

[live()](http://api.jquery.com/live/)已被[on()](http://api.jquery.com/on/)取代：

> 已弃用：1.7，已删除：1.9

尝试事件委托方法：

```
$('#cart').on('mouseover','.heading a',function() {
//etc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T23:01:23.620

尝试使用：

```
$('#cart > .heading a').on('mouseover',function() {
  $('#cart').load('index.php?route=module/cart #cart > *');
  $('#cart').addClass('active');  
});
$('#cart').mouseleave(function() {
  $('#cart').removeClass('active');
}); 
```

# python - 将嵌套的 python 列表转换为数据库

> ID：14782022
> 
> 赞同：0
> 
> 时间：2013-02-08T22:00:48.180
> 
> 标签：python, database, list, dictionary, nested

我有一个 python 列表，其结构如下：

```
apts = [ [2083, \
           [ ["price", "$1000 / month"], \
             ["sq ft.", "500"], \
             ["amenities", "gym hardwood floor"]]], \
          [1096, \ 
           [ ["price", "$1200 / month"], \
             ["sq ft.", "700"], \
             ["a/c", "true"]]], \
          [76, \ 
           [ ["price", "$1100 / month"], \
             ["Pets", "true"], \
             ["a/c", "true"]]]] 
```

如何以一种可以轻松将其传输到 mysql 数据库的格式获取它？基本上，我想重新排列它，使其类似于易于传输的表格/csv文件，例如：

```
id, price, sq ft, amenities, a/c, pets
2083, $1000 / month, 500, gym hardwood floor, ,
1096, $1200 / month, 700, , true,
76, $1100 / month, , true, true 
```

提前致谢。我可以想到将这些逐个映射的方法，但它似乎效率很低，而且我对 python 的了解也很薄弱，所以我希望有其他快速的方法来转换这些数据......

如果我使用嵌套字典结构而不是嵌套列表会有帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:12:49.770

我可能误解了这个问题，但是要将您的列表输出为 csv，您将：

```
import csv

out_file = open('/path/to/out_file.csv', 'wb')
writer = csv.writer(out_file, quoting=csv.QUOTE_ALL)
for data_row in apts:
    writer.writerow(data_row) 
```

导入 SQL（假设您的列表排序正确并且您已正确转义数据）

```
import MySQLdb
mysql = MySQLdb.connect(host=host, user=user,passwd=passwd,db=db)
cursor = self.mysql.cursor()
queries = []
for row in apts:
    queries.append("('%s')" % "','".join(row) ) #< this will join the data encapsuled in apostrophes
cursor.execute( "INSERT INTO TABLE VALUES %s" % ",".join(queries) ) #< Insert the data 
```

如果您要将其转储到数据库中，我肯定会建议您使用字典，这样您就可以 100% 地确保数据到达正确的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T03:11:08.250

我的理解是，您的困难在于将复杂的结构转换为值字符串。这是如何做到的：

```
from collections import OrderedDict

out = []

for r in apts:
    row = OrderedDict([('id',''), ('price',''), ('sqft',''), 
                       ('amenities',''),('ac',''),('pets','')])        
    row['id']=r[0]
    for sr in r[1]:
        row[sr[0].lower().translate(None," ./")]=sr[1]
    out.append(row)

#print result        
for o in out:
    s = ",".join(map(str, o.values()))
    print s 
```

印刷

```
2083,$1000 / month,500,gym hardwood floor,,
1096,$1200 / month,700,,true,
76,$1100 / month,,,true,true 
```

# windows - 在 Perl6::Form 中使用 Windows 行尾

> ID：14782023
> 
> 赞同：0
> 
> 时间：2013-02-08T22:00:49.630
> 
> 标签：windows, perl, line-endings

我正在使用 Perl6::Form 生成表格并将其输出到文本文件。无论我做什么，似乎都无法输出 Windows 行尾。我试过`local $OUTPUT_RECORD_SEPARATOR = "\r\n";` 我试过附加`\r\n`到我的格式字符串。没有骰子。

我的代码：

```
use English;

local $OUTPUT_RECORD_SEPARATOR = qq{\r\n};

my @column_headings = @{ shift $args->{'data'} };
my @rows            = @{ $args->{'data'} };

my $header_format = join q{|}, (q/{]]]][[[[}/) x scalar @column_headings;
my $field_format  = join q{|}, (q/{]]]]]]]]}/) x scalar @column_headings;

# formatting starts with headers followed by double line
my @format_data = ( $header_format, @column_headings, );
push @format_data, join q{|}, (q/==========/) x scalar @column_headings;
foreach my $row (@rows) {
    push @format_data, ( $field_format, @{$row} );
}
my $text = form @format_data;

my ( $fh, $tempfile ) = File::Temp::tempfile;
$fh->print($text) or croak(qq/Failed to write to tempfile: $OS_ERROR/);
close $fh; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T22:06:06.107

根据[文档](http://search.cpan.org/perldoc?File%3a%3aTemp)，

> 如果二进制模式可用，File::Temp 返回的文件将以二进制模式打开。如果不正确，请使用 C 函数更改文件句柄的模式。

因此，在打开之后但在打印之前使用以下内容重新添加通常存在于 Windows 中打开的文件句柄上的 :crlf。

```
$fh->binmode(':crlf'); 
```

# google-maps - 将 Symfony2 中的内容集成到地图（GoogleMaps 或其他）服务中

> ID：14782029
> 
> 赞同：2
> 
> 时间：2013-02-08T22:01:08.637
> 
> 标签：google-maps, symfony, google-maps-api-3

我希望我的内容（比如说消息）有一个与之连接的地理位置 - 一个存储地理编码或数据库中地址的列 - 然后使用该地理编码将它们显示到谷歌地图上。我是否需要一个抽象库，或者我可以直接使用 Google Maps API 来完成吗？就性能和简单性而言，最佳实践是什么？（这对我来说已经是未知领域）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T22:22:46.063

我将从查看这些库和捆绑包开始。

[https://github.com/willdurand/Geocoder](https://github.com/willdurand/Geocoder)

[https://github.com/egeloen/IvoryGoogleMapBundle](https://github.com/egeloen/IvoryGoogleMapBundle)

您当然可以在任何标准数据库中存储/查询大量数据，但您可能希望使用 MongoDB 来获取它的地理空间索引：

[http://docs.mongodb.org/manual/core/geospatial-indexes/](http://docs.mongodb.org/manual/core/geospatial-indexes/)

# python - Python：使用两个按不同方向排序的键对列表进行排序

> ID：14782031
> 
> 赞同：4
> 
> 时间：2013-02-08T22:01:30.423
> 
> 标签：python

```
>>> from operator import itemgetter
>>> ul = [(10,2),(9,4),(10,3),(10,4),(9,1),(9,3)]
>>> ol = sorted(ul, key=itemgetter(0,1), reverse=True)
>>> ol
[(10, 4), (10, 3), (10, 2), (9, 4), (9, 3), (9, 1)] 
```

我想要的是在第二个键上对 reverse=False 进行排序。换句话说，我希望结果是：

```
[(10, 2), (10, 3), (10, 4), (9, 1), (9, 3), (9, 4)] 
```

我该怎么做呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-08T22:02:12.837

对于数字排序，您可以使用负排序键：

```
sorted(ul, key=lambda x: (-x[0], x[1])) 
```

或者，如果您有非数字数据，您可以进行两次排序（首先按最低有效键排序）：

```
ol = sorted(ul, key=lambda x: x[1])
ol = sorted(ol, key=lambda x: x[0], reverse=True) 
```

# visual-studio - VS2012 Web Essentials 中的 TypeScript 错误通知

> ID：14782037
> 
> 赞同：2
> 
> 时间：2013-02-08T22:02:07.940
> 
> 标签：visual-studio, typescript, web-essentials

是否可以让 Web Essentials 显示项目中所有 .ts 文件的错误，而不仅仅是打开的文件？[或] 对项目中的 .ts 文件进行重建时，是否可以看到失败的 ts 编译的输出？

就目前而言，除非我打开所有文件，否则我对错误有点视而不见。即使重建所有 .ts 文件似乎也掩盖了错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T10:29:54.753

Web Essentials 仅在预览窗格中显示错误，因此您只会在当前文件中看到错误，或者当前文件是否存在由它所依赖的文件引起的错误。

`Error List`构建解决方案时，如果有任何编译问题，您应该会在视图中看到错误。

# jquery - Jquery appendTo，删除多个div

> ID：14782043
> 
> 赞同：0
> 
> 时间：2013-02-08T22:02:21.303
> 
> 标签：jquery, appendto

我是 jquery 的新手，对此完全迷失了。我已经搜索了很多没有成功。这是我正在尝试做的事情：

因此，我将一个区域中的（隐藏）div 附加到 DOM 中多个级别的另一个 div：

```
$(".show_hide").on("click", function(event){

    $(this).next(".event-details").appendTo("#sc_events").addClass("current-event");

    return false;

}); 
```

我的问题是容器中还有几个 div 在做同样的事情。所以，我需要能够删除这个附加的 div，当单击下一个时，新的 div 会弹出。我让它像这样工作：

```
$(".show_hide").on("click", function(event){
$(".current-event").remove();
    $(this).next(".event-details").appendTo("#sc_events").addClass("current-event");

    return false;

}); 
```

但是，如果我单击带有 show_hide 类的先前单击的项目，它不会返回，因为它已使用此方法删除。我只需要它再次可用。

我希望这是有道理的。并感谢您的帮助。这是一个[http://jsfiddle.net/CGySr/](http://jsfiddle.net/CGySr/)，我无法开始工作，但或多或​​少有 html 结构。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T22:05:10.677

您可以使用 jQuery[`clone()`](http://api.jquery.com/clone/)在添加隐藏 div 之前对其进行复制。我还建议[`preventDefault()`](http://api.jquery.com/event.preventDefault/)在单击链接时防止潜在的页面跳转或页面刷新。

```
$(".show_hide").on("click", function(event){
  event.preventDefault();
  $(".current-event").hide();
  $(this).next(".event-details").clone().appendTo("#sc_events").addClass("current-event").show();
  return false;
}); 
```

见**[演示](http://jsfiddle.net/zaknotzak/CGySr/2/)**。

# clojure - 找到所有低于 m 且总和为素数的整数的 n 元组

> ID：14782047
> 
> 赞同：3
> 
> 时间：2013-02-08T22:02:49.447
> 
> 标签：clojure

我正在阅读[Clojure in Action 这本书](http://www.manning.com/rathore/)，并且给出了与下面类似的代码，该函数返回*m*以下的所有数对，其总和为素数（假设*素数？*已给出）：

```
(defn pairs-for-primes [m]
  (let [z (range 0 m)]
    (for [a z b z :when (prime? (+ a b))]
      (list a b)))) 
```

将如何推广它以返回所有低于 m 且总和为素数的数的 n 元组？

```
(defn all-ntuples-below [n m]
... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:46:46.363

`for`可用于笛卡尔积的一种“特殊情况”，您可以在编译时提前知道集合。由于您实际上并不知道您想要乘积的集合，因此您需要使用真正的笛卡尔积函数。例如，使用[clojure.math.combinatorics](https://github.com/clojure/math.combinatorics/blob/master/src/main/clojure/clojure/math/combinatorics.clj#L86)，您可以编写

```
(defn pairs-for-primes [m n]
  (let [z (range 0 m)
        tuples (apply cartesian-product (repeat n z))]
    (filter #(prime? (apply + %)) tuples))) 
```

但也许您的问题是关于如何实现笛卡尔积？这并不难，虽然下面的版本性能不是很好：

```
(defn cartesian-product [sets]
  (cond (empty? sets) (list (list))
        (not (next sets)) (map list (first sets))
        :else (for [x (first sets)
                    tuple (cartesian-product (rest sets))]
                (cons x tuple)))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T07:27:58.397

您可以`take`这样做（因为`pairs-for-primes`返回一个序列`take`只会导致它计算所需的项目数）

```
(defn all-ntuples-below [n m]
  (take n (pairs-for-primes m))) 
```

# javascript - Adobe Livecycle Javascript 简单显示隐藏的整体逻辑

> ID：14782054
> 
> 赞同：0
> 
> 时间：2013-02-08T22:03:06.437
> 
> 标签：javascript, show-hide, livecycle-designer

我正在尝试在 Adob​​e Live Cycle 中使用大量简单的显示/隐藏脚本来将几种表单合并为一个。我将把文本输入字段叠加在一起，并让它们都以不可见的方式开始（使用 Live Cycle 的不可见设置）。这些对象的显示/隐藏将通过使用下拉列表进行控制。

基本任务是：

```
-Click an item from  a dropdown list.
-Initiate a show of relative invisible elements on the page based on the 
 raw value of the item selected.
-If user changes dropdown value, hide previously displayed data and show new
 corresponding data. 
```

这一切都可以从下拉列表本身内部完成吗？我从以前的开发人员那里继承了这个项目，所以我正在拼凑他的一些代码，并试图掌握实际需要做的事情，以便我能够完成任务。以下是显示隐藏结构的示例：

```
xfa.resolveNode("form1.#subform.indPaymentOptions").selectedIndex = 0;
xfa.resolveNode("form1.#subform.VendPaymentOptions").selectedIndex = 0;
xfa.resolveNode("form1.#subform.Display_Field_Pay_Types").rawValue = 
    "Please select an option from the 'Select type' drop-down menu above.";
taxReportable.rawValue = "";
AccountCodesDynamic.rawValue = "";

if (xfa.resolveNode("form1.#subform.payeeType").rawValue == 2) {
    xfa.resolveNode("form1.#subform.indPaymentOptions").presence = "visible";
    xfa.resolveNode("form1.#subform.VendPaymentOptions").presence = "hidden";
}

else if (xfa.resolveNode("form1.#subform.payeeType").rawValue == 3) {
    xfa.resolveNode("form1.#subform.indPaymentOptions").presence = "hidden";
    xfa.resolveNode("form1.#subform.VendPaymentOptions").presence = "visible";
}
else if (xfa.resolveNode("form1.#subform.payeeType").rawValue == 1) {
    xfa.resolveNode("form1.#subform.indPaymentOptions").presence = "hidden";
    xfa.resolveNode("form1.#subform.VendPaymentOptions").presence = "hidden";

} 
```

上面的所有代码看起来都很简单，但在文档的初始化部分也有一些代码：

```
 if (xfa.resolveNode("#subform.RadioButtonList[2].ind").rawValue == 1)
    indPaymentOptions.presence = "visible";

else if (xfa.resolveNode("#subform.RadioButtonList[2].vend").rawValue == 2)
    vendPaymentOptions.presence = "visible"; 
```

我很想知道这种事情是否有必要。如果是，有人可以在文档的初始化部分解释在多大程度上需要这样的代码？

如果没有必要，我粘贴在这篇文章顶部的显示/隐藏代码是否足以满足我想要完成的任务？

我尝试过浏览 Adob​​e 的 livecycle 文档，但很难找到必要内容的广泛概述，因此我很难使用它。任何帮助是极大的赞赏。如果有我缺少的资源，我很想自学如何做到这一点。另外，这是我在这里的第一篇文章。我已尽力遵守常见问题解答中的提交指南，但如果我违反了任何提交指南，请提前道歉。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T13:19:57.087

下拉菜单的代码看起来很简单，应该没问题（尽管您可能会在使用 LiveCyle 一段时间后发现，即使是一些带有逻辑代码的简单任务也不起作用）。

初始化事件中的代码实际上是用于单选按钮组而不是下拉菜单，因此可见表单的功能实际上可能不仅仅由下拉菜单驱动。

您在 LC 中最终得到的结果是在初始化事件中重复更改或验证事件的代码，以便在表单打开时正确显示/处理。这当然可以通过使用来自对象的其他事件事件的代码调用事件来解决。例如。在下拉初始化事件中，您将保存下拉代码，在下拉的更改事件中，您将使用 this.execEvent("initialize") 在触发更改事件时调用代码。

在不查看表格的情况下了解您的特定情况下发生的事情有点困难，但如果有任何不清楚的地方请告诉我，或者我可以提供任何其他帮助。

# c# - 如何使用 asp.net 中的邮件黑猩猩向时事通讯订阅者发送电子邮件？

> ID：14782055
> 
> 赞同：1
> 
> 时间：2013-02-08T22:03:30.693
> 
> 标签：c#, asp.net, mailchimp

我正在使用以下代码向网站中的时事通讯订阅者发送电子邮件，但此代码似乎不起作用，谁能指导我，如何在 asp.net 网站中集成邮件黑猩猩：-

```
 listSubscribe cmd = new listSubscribe();

        listSubscribeParms newlistSubscribeParms = new listSubscribeParms
        {
            apikey = apikey,
            id = "1",
            email_address = "test@gmail.com",
            merge_vars = new Dictionary<string, object>(),
            double_optin = false,
            email_type = EnumValues.emailType.html,
            replace_interests = true,
            send_welcome = false,
            update_existing = true
        };

        listSubscribeInput newlistSubscribeInput = new listSubscribeInput(newlistSubscribeParms);

        var subscribeSuccess = cmd.Execute(newlistSubscribeInput); 
```

# c# - 从引用类型到用户定义类型的接口的隐式引用转换

> ID：14782057
> 
> 赞同：0
> 
> 时间：2013-02-08T22:03:37.910
> 
> 标签：c#

从 C# 4.0 规范第 6.1.6 节：

> 隐式引用转换是：
> 
> [...]
> 
> 从任何引用类型到接口或委托类型 T，如果它具有到接口或委托类型 T0 的隐式标识或引用转换，并且 T0 可变量转换（13.1.3.2）到 T。

Vladimir Reshetnikov 告诉我们，存在从`List<string>`to的隐式引用转换`IEnumerable<object>`。但是，我如何将其应用于用户定义的类型（甚至可能）？

我尝试了一个隐式运算符、自定义派生类型和其中的一些变体......但我无法重现场景。我有：

```
class Program
{
    static void Main(string[] args)
    {
        IEnumerable<object> specialClassConversion = new List<string>();
        IEnumerable<A> userdefinedTypeConversion = new List<B>();
        A implicitConversion = new B();//varience-convertible
        IC<A> explicitConversion = (IC<A>)new D<B>();//OK, varience-convertible
        IC<A> implicitConversion2 = new D<B>();//does not compile
    }
}

class A { }

class B : A { }

interface IC<T> { }    

class D<T> 
{
    //public static implicit operator IC(D<T> m)//Error: user-defined conversions to or from an interface are not allowed
    //{
    //    return null;
    //}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T22:06:49.083

如果您希望用户定义的类或结构可隐式转换为接口，请让您的类/结构实现该接口。

**（编辑）**

如果您想`IC<B>`隐式转换为，请通过指定关键字.`IC<A>`使`IC<T>`接口*协变*。您给出的规范中的引用表明这两个隐式转换的“组合”也是一种隐式转换。`T``out``interface IC<out T> { }`

**来源：**

```
interface IC<out T> {  }

class D<T> : IC<T>  { } 
```

**（结束编辑）**

关于`List<string>`类，它实现了*which*`IEnumerable<string>`又可以（隐式）转换为，`IEnumerable<object>`因为在.`IEnumerable<out T>`*`out``T`*

 *（他们不允许您进行`public static implicit operator`转换到/从接口转换的一个原因是，有些人可以编写一个从您的类继承*并*实现接口的派生类。这将在他们的类之间进行“自然”转换和接口，但`public static implicit operator`也适用，导致类型之间的*两种*转换（一种“自然”和一种“用户定义”），这会令人困惑和模棱两可。）*

# c++ - D3D10 常量缓冲区不起作用

> ID：14782061
> 
> 赞同：0
> 
> 时间：2013-02-08T22:03:45.000
> 
> 标签：c++, directx, buffer, hlsl, direct3d11

我正在使用常量缓冲区将数据传输到我的像素着色器

问题是缓冲区在运行时对于 float4 成员的 x、y、z 和 w 包含着色器中的 0，而不管将哪些数据更新到缓冲区

结构定义如下：

```
// (C++)
struct Buffer
{
    XMMATRIX mvp_;
    XMFLOAT4 rgba_;
    int usemvp_;
};

// HLSL
cbuffer Buffer : register( b0 )
{
    matrix mvp_;
    float4 rgba_;
    int usemvp_;
}; 
```

任何帮助深表感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T01:38:51.370

您需要填充结构以使其 16 字节对齐。

```
// (C++)
struct Buffer
{
    XMMATRIX mvp_;
    XMFLOAT4 rgba_;
    int usemvp_;
    float padding[3];
}; 
```

此外，您必须确保将常量缓冲区设置到正确的着色器阶段，即 VSSetConstantBuffers 与 PSSetConstantBuffers。

# ssl - 插件 ssl.host SSL_DNS_DOMAIN 显示 amazonaws.com 子域

> ID：14782067
> 
> 赞同：-1
> 
> 时间：2013-02-08T22:03:55.290
> 
> 标签：ssl, cloudcontrol

我使用命令添加了刚从 comodo 购买的 SSL 证书

```
cctrlapp xxxx/default addon.add ssl.host --cert certif.crt
         --key certif-nopass.key --chain SecureServerCA-bundle.crt 
```

检查后我的命令没有得到任何响应

```
$ cctrlapp xxx/default addon ssl.host

Addon                    : ssl.host   
Settings

SSL_CERT_INCEPTS         : 2013-02-07 00:00:00

SSL_DNS_DOMAIN           : addonssl-depsmgr6bsx-1086693984.eu-west-1.elb.amazonaws.com
SSL_CERT_EXPIRES         : 2014-02-07 23:59:59

After accessing to the https
I have the error
The certificate is valid for the following domains :
  *.cloudcontrolled.com , cloudcontrolled.com  

(Error code : ssl_error_bad_cert_domain) 
```

为什么`SSL_DNS_DOMAIN`表示这个子域名？

我刚刚使用命令检查了证书

```
openssl x509 -in certif.crt -text -noout 
```

它是一个有效的 2048 RSA 密钥。

有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T12:40:43.977

我假设您使用自定义别名。然后，当 DNS 更新时，您无需更改任何内容。您的子域上已经有一个 CNAME，指向“whatever.cloudcontrolled.com”。只需使用 HTTPS 访问您的域，然后您将获得您的证书（而不是 *.cloudcontrolled.com 证书）。

说“访问 https 后”是指您尝试使用 https 访问自己的域？

添加插件后，您必须等待两件事：

*   您的个人负载均衡器将完成启动（当 SSL_DNS_DOMAIN 包含 dns 名称而不是“待定”之类的内容时，这将完成）。
*   由于您的域的 IP 将更改，因此您必须等到此链中的 DNS-TTL 通过。这在 cloudcontrol-domain 上大约需要 5 分钟，然后取决于您自己的域 DNS 配置。

我想您的 dns-provider 或 cloudcontrol-TTL 可能遇到了 TTL 问题。或者可能是您的本地 DNS 缓存、浏览器 DNS 缓存、提供商 DNS 缓存……

一个不错的技巧（目前正在工作，但将来不必工作）：

`dig`在您的域上运行。

*   当您获得一个 IP 时，SSL 完成并应该运行。
*   当您获得多个 IP（现在为 testet，3）时，SSL 出现问题。

您还可以为 dig-command 指定特定的 DNS-Servers 以绕过缓存（google-dns-servers 始终是最新的）。

对于您的另一个问题： SSL_DNS_DOMAIN 仅向您显示已启动并将为您管理的 Amazon Elastic Loadbalancer。您不需要此名称，因为当您使用 SSL-Addon 查询“whateverapp.cloudcontrolled.com”时，您会获得 ELB-IP 之一。所以它只是为了提供信息，大部分不需要。

希望这可以帮助 ：）

# javascript - 查找元素是否无子元素

> ID：14782069
> 
> 赞同：1
> 
> 时间：2013-02-08T22:04:02.087
> 
> 标签：javascript

我有一个包含页面上所有元素的数组。在遍历数组时如何测试元素是否没有子元素？我宁愿继续使用标准的 javascript。这是解释它的伪代码：

```
for each element in elementlist:
    if element is childless:
        do something
    else:
        do something different 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T22:45:58.600

您可以使用返回布尔值的[hasChildNodes](https://developer.mozilla.org/en-US/docs/DOM/Node.hasChildNodes)方法

```
element.hasChildNodes(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T22:05:51.293

使用纯 JS，您可以测试 elem.firstChild 是否为空，使用 jQuery，您可以使用 elem.children().length > 0 进行测试

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T22:05:59.463

您可以使用 检索子节点的数量`element.childNodes.length`。如果它等于`0`，则该节点是无子节点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T22:09:54.213

这是一个简单的解决方案和演示。这包括具有作为文本节点的子元素的元素。

```
var arr = [document.getElementById("a1"),
           document.getElementById("a2"),
           document.getElementById("a3"),
           document.getElementById("a4")];

var isChildless = function(ele){
    return ele.childNodes.length <= 0;
}

for (var x = 0; x < arr.length; x++){
    console.log(isChildless(arr[x]));
} 
```

[http://jsfiddle.net/HTbuB/1/](http://jsfiddle.net/HTbuB/1/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-08T22:58:12.013

如果数组很长，请尝试使用

```
 var z=arr.length;
 for (var x = 0; x < z ; x += 1){
 console.log(isChildless(arr[x])); 
```

它会计算一次长度。在前面的示例中，它在每个循环中计算 arr.length。

# linux - /proc/$PID/pmaps 中出现了哪些库？

> ID：14782074
> 
> 赞同：0
> 
> 时间：2013-02-08T22:04:27.790
> 
> 标签：linux, linker, dynamic-linking, dynamic-library, procfs

在 Linux 上，您可以检查 /proc/$PID/pmaps 以查看特定程序加载的库，并且程序可以打开 /proc/self/pmaps 以检查它本身已加载的库。

我知道 pmaps 只会包含动态库，显然内核无法预测我们以后可能会打开哪些库，所以我希望这些库不包含在 /proc/self/maps 中。但我不确定其他一些情况：

1.  是否包含在构建时已链接但我们尚未调用任何函数的库？我的理解是 Linux 会延迟链接符号，直到第一次使用它们，所以我不确定它们是否会出现。

2.  pmaps 是否包含所有递归使用的库？例如，如果我查看 pmaps 中的每个库并在其上运行 ldd，然后在这些库上运行 ldd，令人作呕，我不应该找到任何不在原始 pmaps 中的新库？我在几个二进制文件上试过这个，看起来是这样，但也许我很幸运。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T22:23:37.413

/proc/$pid/maps 不仅会列出已加载的库，还会列出所有其他映射的内存段。

阅读此线程和其中的文章：

[了解 Linux /proc/id/maps](https://stackoverflow.com/questions/1401359/understanding-linux-proc-id-maps)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T03:02:26.760

> 是否包含在构建时已链接但我们尚未调用任何函数的库？

是的：`mmap`在您的程序开始运行之前，运行时加载程序将您的可执行文件直接依赖的每个库。

您可以通过运行找到此类库的列表

```
readelf -d a.out | grep NEEDED 
```

> pmaps 是否包含所有递归使用的库？

是的：如果您直接依赖的库本身依赖于其他库，则运行时加载器也`mmap`将递归依赖。

> 我的理解是 Linux 会延迟链接符号，直到第一次使用它们

*这对于函数*符号来说大部分是正确的，但对于数据符号来说是错误的，不能懒惰地解决。

此外，符号是否被延迟解析取决于`LD_BIND_NOW`环境变量，以及可执行动态部分中的等效设置，由`-znow`链接器标志控制。

但是，这些都不会改变`mmap`图片；如果您的动态部分中有一个`DT_NEEDED`条目，*则将*被编辑（并将显示在）独立于惰性或非惰性分辨率。`foo.so``foo.so` *`mmap``/proc/self/*map*`*

# multithreading - javafx、套接字编程和线程

> ID：14782075
> 
> 赞同：5
> 
> 时间：2013-02-08T22:04:38.963
> 
> 标签：multithreading, sockets, javafx

我是 Java 和 JavaFX 的新手，所以请原谅我的新手问题。在过去的几天里，我一直在寻找我正在尝试做的事情的例子，但一直找不到任何答案。这是我想要做的：我正在尝试使用场景构建器创建一个简单的 javafx GUI 客户端套接字应用程序，该应用程序将连接到服务器并发送/接收数据。很简单，但是当我尝试在 Java FX 中实现它时，我的 GUI 冻结了。我研究并发现原因是套接字通信一直在占用所有时间，并且 javafx GUI 无法更新。我的研究表明我使用任务。所以，我创建了一个简单的应用程序，它创建一个任务，连接到一个互联网套接字（端口 80），发送命令“GET / HTTP/1.1\r\n\r\n”，它将请求页面然后打印出来收到的每一行。问题是我想一遍又一遍地这样做（每 3 秒）。该任务成功运行一次，但随后停止。在下面的代码中，永远不会到达使线程进入睡眠状态的行，但打印任何错误的行也不会发送到 system.out。

这是控制器代码

```
package clientSocketExample;

import java.io.*;
import java.net.*;
import java.util.ResourceBundle;
import javafx.event.ActionEvent;
import javafx.event.EventHandler;
import javafx.fxml.FXML;
import javafx.fxml.Initializable;
import javafx.scene.control.*;
import javafx.concurrent.Task;

/**
 * Controller class of the HelloWorld sample.
 */
public class ClientSocketExampleController implements Initializable
{

    @FXML
    Button button;

    private boolean keepRunning = true;

    /**
     * Initializes the controller class.
     */
    @Override
    public void initialize(URL url, ResourceBundle rsrcs)
    {
            if (button != null)
        {
            button.setOnAction(new EventHandler<ActionEvent>()
            {
                @Override
                public void handle(ActionEvent event)
                {
                    keepRunning = false;
                    System.out.println("Hello World\n");
                }
            });
        }

        // Create a background task to handle the Client-Server socket
        // This is needed because JavaFX is not thread safe
        Task<Integer> task = new Task<Integer>()
        {
             @Override
            protected Integer call() throws Exception
            {
                Socket s = new Socket();
//                String host = "www.google.com";
//                String host = "www.amazon.com";
                String host = "www.yahoo.com";
                PrintWriter s_out = null;
                BufferedReader s_in = null;
                int lineNums = 0;

                try
                {
                    s.connect(new InetSocketAddress(host, 80));
                    System.out.println("Connected\n");

                    // Create writer for socket
                    s_out = new PrintWriter(s.getOutputStream(), true);

                    // Create reader for socket
                    s_in = new BufferedReader(new     InputStreamReader(s.getInputStream()));
                }
                catch (IOException e)
                {
                    // Host not found, so print error
                    System.err.println("Don't know about host : " + host);
                    System.exit(1);
                }

                // Loop forever waiting for task to be cancelled
                while (isCancelled() == false)
                {
                    // Send message to server
                    String message = "GET / HTTP/1.1\r\n\r\n";
                    s_out.println(message);

                    System.out.println("Message sent\n");
                    // Get response from server
                    try
                    {
                        String response;
                        while ((response = s_in.readLine()) != null)
                        {
                            System.out.print("Line #: "+lineNums+" ");
                            System.out.println(response);
                            lineNums++;
                        }
                    } catch (IOException e)
                    {
                        System.err.println("Couldn't get response from host");
                    }

                    System.out.println("Thread going to sleep\n\n\n");
                    Thread.sleep(3000);
                    System.out.println("Thread waking up from sleep\n\n\n");
                } // End while

                return lineNums;
            }           
        }; // End Initialize

        // start the background task
        Thread th = new Thread(task);
        th.setDaemon(true);
        System.out.println("Starting background task...");
        th.start();
    }
}` 
```

Main.java 类如下所示：

```
package clientSocketExample;

import java.util.logging.Level;
import java.util.logging.Logger;
import javafx.application.Application;
import javafx.fxml.FXMLLoader;
import javafx.scene.Scene;
import javafx.scene.layout.AnchorPane;
import javafx.stage.Stage;

public class Main extends Application
{
/**
 * @param args the command line arguments
 */
public static void main(String[] args)
{
    Application.launch(Main.class, (java.lang.String[]) null);
}

@Override
public void start(Stage primaryStage)
{
    try
    {
        AnchorPane page = (AnchorPane) FXMLLoader.load(Main.class
                .getResource("ClientSocketExample.fxml"));
        Scene scene = new Scene(page);
        primaryStage.setScene(scene);
        primaryStage.setTitle("Hello World Sample");
        primaryStage.show();
    } catch (Exception ex)
    {
        Logger.getLogger(Main.class.getName()).log(Level.SEVERE, null, ex);
    }
} 
```

}`

最后 FXML 文件如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.*?>
<?import java.util.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.paint.*?>

<AnchorPane id="AnchorPane" prefHeight="365.0" prefWidth="378.0"     xmlns:fx="http://javafx.com/fxml"     fx:controller="clientSocketExample.ClientSocketExampleController">
  <children>
    <Button fx:id="button" layoutX="147.0" layoutY="28.0" text="Connect" />
    <TitledPane animated="false" layoutY="159.0" prefWidth="378.0" text="Received Data">
      <content>
        <AnchorPane id="Content" minHeight="0.0" minWidth="0.0" prefHeight="180.0" prefWidth="200.0">
          <children>
            <TextArea fx:id="textAreaField" prefHeight="180.0" prefWidth="374.0" wrapText="true" />
          </children>
        </AnchorPane>
      </content>
    </TitledPane>
  </children>
</AnchorPane> 
```

提前感谢您的帮助韦恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-26T22:03:33.270

根据您的要求，有几件事需要更改：

1.  将此插入您的请求中

    ```
    "\r\nHost: <host>\r\nConnection: keep-alive" 
    ```

    这将确保服务器在响应您的请求后不会关闭您的连接。

2.  将您的 while 循环更改为：

    ```
    while (s_in.ready() && (response = s_in.readLine()) != null) 
    ```

    这将确保可以从 BufferedReader 中读取某些内容。查看这些帖子，了解 BufferedReader 为何会挂起：[https](https://stackoverflow.com/a/7855911/1359765) ://stackoverflow.com/a/7855911/1359765和[https://stackoverflow.com/a/15510821/1359765](https://stackoverflow.com/a/15510821/1359765)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T09:50:43.957

冻结的 Gui 遇到的问题是因为它的“控制器”类连接到套接字。当我使用 JavaFx 和 JavaFx 场景构建器创建自己的聊天程序时，我遇到了同样的问题。

你可以做两件事：

1.  创建一个`SocketConnector()`将您连接到套接字的新类 ( )。

2.  连接到主类中的套接字，而不是`controller`

无论您无法连接到控制器类中的套接字，很抱歉，我无法描述为什么您不能详细说明我只是知道我曾多次遇到此问题，这是解决此问题的方法！

# ubuntu - 将视频展开（延长）到特定时长

> ID：14782077
> 
> 赞同：5
> 
> 时间：2013-02-08T22:05:02.683
> 
> 标签：ubuntu, video, ffmpeg, vlc, transcoding

[VLC](http://www.videolan.org/vlc/index.html)或[FFmpeg](http://ffmpeg.org/)（或[AVconv](http://libav.org/avconv.html) ）是否具有将视频的持续时间强制为特定秒数的任何功能？

假设我有一个...... 5 分钟的 .mp4 视频（无音频）。有没有办法让上述任何工具将视频“扩展”到更长的持续时间？该视频来自 Power Point 幻灯片，但它太短（运行速度太快，不能这么说）。这个想法将自动插入帧，使其达到指定的持续时间。它看起来很可行（呃……对于像我这样的视频编码/转码新手来说）：一个 5 分钟的视频，30fps 意味着我有 9000 帧……要让它长 10 倍，得到第一个“真实”帧，复制十次，然后得到第二个“真实”帧，复制十次……以此类推。

我使用的是 Ubuntu 12.04，但如果需要，我可以安装/编译任何所需的软件。到目前为止，我有 VLC、AVConv 和 FFmpeg（FFmpeg 在特定文件夹中，所以它不会与 AVConv 冲突）

先感谢您。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-08T22:19:26.323

使用[setpts 视频过滤](https://ffmpeg.org/ffmpeg-filters.html#setpts_002c-asetpts)器`ffmpeg`。简单的例子：

*   慢速（半速）：`setpts=PTS*2`或`setpts=PTS/0.5`
*   快速 (2x)：`setpts=PTS/2`或`setpts=PTS*0.5`

# 视频速度提升 10 倍

```
ffmpeg -i input.mp4 -filter_complex "setpts=PTS/10" output.mp4 
```

# 音频和视频速度提高 10 倍

对于音频，请使用[atempo](https://ffmpeg.org/ffmpeg-filters.html#atempo)、[Rubberband](https://ffmpeg.org/ffmpeg-filters.html#asetrate)或[asetrate](https://ffmpeg.org/ffmpeg-filters.html#rubberband)音频过滤器。

```
ffmpeg -i input.mp4 -filter_complex "[0:v]setpts=PTS/10[v];[0:a]atempo=10[a]" -map "[v]" -map "[a]" output.mp4 
```

# 匹配视频到音频的持续时间

在此示例`audio.wav`中，持续时间为 30 秒和`video.mp4`90 秒。

1.  [获取](https://superuser.com/questions/650291/how-to-get-video-duration-in-seconds/945604#945604)音视频文件的时长：

    ```
     ffprobe -v error -show_entries format=duration -of default=noprint_wrappers=1:nokey=1 audio.wav
     ffprobe -v error -show_entries format=duration -of default=noprint_wrappers=1:nokey=1 video.mp4 
    ```

2.  使用[setpts](https://ffmpeg.org/ffmpeg-filters.html#setpts_002c-asetpts)视频过滤器调整视频的持续时间以匹配音频持续时间。

    ```
     ffmpeg -i video.mp4 -i audio.wav -filter_complex "[0:v]setpts=PTS*30/90[v]" -map "[v]" -map 1:a -shortest output.mp4 
    ```

# 使视频适合特定时间

在此示例中，输入为 120 秒。所需的输出为 30 秒：

1.  [获取](https://superuser.com/questions/650291/how-to-get-video-duration-in-seconds/945604#945604)输入文件的持续时间：

    ```
    ffprobe -v error -show_entries format=duration -of default=noprint_wrappers=1:nokey=1 input.mp4 
    ```

2.  使用[setpts](https://ffmpeg.org/ffmpeg-filters.html#setpts_002c-asetpts)和[atempo](https://ffmpeg.org/ffmpeg-filters.html#atempo)（或[Rubberband](https://ffmpeg.org/ffmpeg-filters.html#rubberband)）过滤器：

    ```
    ffmpeg -i input.mp4 -filter_complex "setpts=PTS/(120/30);atempo=120/30" output.mp4 
    ```

# javascript - 使用 Lab.js 加载模块

> ID：14782079
> 
> 赞同：1
> 
> 时间：2013-02-08T22:05:03.783
> 
> 标签：javascript, labjs

为什么 *ReferenceError: $ is not defined*？

```
<script src="LAB.js"></script>
            <script>
     $LAB.script("jquery/jquery.js")
    </script>

     </body>

    <p><?php echo mt_rand(89,161464) ?></p>

    <script>
//Uncaught ReferenceError: $ is not defined 

$(document).ready(function(){
    console.log('reddy');
    $("p").css('color','red');
    })  
</script> 
```

**但是工作：**

```
 window.onload=function(){
        $("p").css('color','red');
        } 
```

2\. **item1.js**

```
 var interface={name:'interface'}; 
```

**item2.js**

```
interface.hu={name:'int'};

$LAB.script("item2.js").wait();
$LAB.script("item1.js"); 
```

***//Uncaught ReferenceError: interface is not defined*** Help

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T05:35:40.100

尝试 ：

```
$LAB.script("jquery/jquery.js").wait(function () {
   if( window.jQuery ) { //is jquery loaded
       $("p").css('color','red'); 
   }
}); 
```

或者

```
$LAB.script("jquery/jquery.js").wait(function () {
   $(document).ready(function() {
       $("p").css('color','red'); 
   }
}); 
```

查看更多:: [LABjs 文档](http://labjs.com/documentation.php)

# jquery - 将 .live 函数转换为 .on 的问题

> ID：14782086
> 
> 赞同：0
> 
> 时间：2013-02-08T22:05:22.750
> 
> 标签：jquery, event-delegation

更新一些代码库并遇到一个我似乎无法克服的问题。我已经阅读了 .on 文档，并觉得我对它有足够的了解。登录时通过 ajax.load 引入表单。没有问题。在一个简单的设置中，例如：

```
<div id="FXCMForm">
    <form action="processor.php" method="post" id="Form1">
        <ul>
            //other li's
            <input type="submit" id="Button1" value="Create License Key" />
            //other li's            
        </ul>
        <div id="Msg1" class="error"><a class="close">X</a><ul></ul></div>
    </form>
</div> 
```

使用 .live 的旧代码是这样的

```
$("#Button1").live('click',function(){
$("#Form1").validate({
    errorContainer: "#Msg1",
    errorLabelContainer: "#Msg1 ul",
    errorElement: "li",
    submitHandler: function(form) {
        $('#prcs1').show();
        var dataString = $(form).serialize();
        $.ajax({
            //ajax success stuff
        } else {
             //ajax fail stuff
        }
    });return false;
    },
    rules: {//rules},
    messages: {//messages}
    });
}); 
```

尝试像这样使用 new(ish) .on 调用

```
$("#FXCMForm").on("click", "#Button1", function(event){
    $("#Form1").validate({
 //all other stuff here   
 }); 
```

我已经调用了包含动态元素#FXCMForm、事件类型“click”和触发它的元素“#Button1”的容器，但是当我单击时，它只是将返回的 PHP 数据转储到一个空白页面中，而不是做任何 ajax 的东西. 有任何想法吗？谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T22:07:27.617

显然使用“body”作为根元素就可以了。嗯

# jquery - 使用jquery获取多个div的高度

> ID：14782087
> 
> 赞同：2
> 
> 时间：2013-02-08T22:05:22.543
> 
> 标签：jquery, jquery-selectors

我需要获取三个 div 的高度，将它们加在一起，看看滚动位置是否大于该数字。现在我可以得到一个元素的高度，但是我怎么能添加其他元素呢？

基本上，我想写“如果scroll_top大于div 1 + div 2 + 3的高度”

```
var scroll_top = $(window).scrollTop();

if ((scroll_top > $('.nav-bar-fixed').height()) {
    alert('sometext');
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-08T22:08:26.773

为什么不简单地这样做呢？

```
var h = 0;
$('#div1, #div2, #div3').each(function(){ h+=$(this).height() }); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-08T22:16:54.727

这应该可以解决问题。

[JS Bin 上的工作示例](http://jsbin.com/eqahed/1/edit)。

HTML：

```
 <div class="nav-bar-fixed"></div>
  <div class="nav-bar-fixed"></div>
  <div class="nav-bar-fixed"></div> 
```

CSS：

```
.nav-bar-fixed {
  height: 200px;
} 
```

JavaScript：

```
var scroll_top = $(window).scrollTop(),
    $navBarFixed = $('.nav-bar-fixed'),
    totalHeight = 0;

$.each($navBarFixed, function() {
    totalHeight += $(this).height();
});

if (scroll_top > totalHeight) {
    alert(totalHeight);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-08T22:09:14.290

试试这个：

```
$(document).ready(function() {
var limit =$('.myEle1').height() + $('.myEle2').height() + $('.myEle3').height();
   $(window).scroll(function() {
       var scrollVal = $(this).scrollTop();
        if ( scrollVal > limit ) {
           //do something.
        }
    });
 });​ 
```

[这是一个固定的导航示例](http://jsfiddle.net/4TfTF/26/)和[来源。](https://stackoverflow.com/questions/11971475/setting-css-value-limits-of-the-window-scrolling-animation/11971912#11971912)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-11-23T15:35:16.207

你可以实现这个基于 JQuery 的函数：

```
(function ($) {
   $.fn.sumHeights = function () {
      var h = 0;
      this.each(function() {
         h += $(this).height();
      });
      return h;
   };
})(jQuery); 
```

然后这样称呼它：

```
$('div, .className, #idName').sumHeights(); 
```

# objective-c - 如何使用 Objective C 压缩图像（png、jpg 等）

> ID：14782088
> 
> 赞同：2
> 
> 时间：2013-02-08T22:05:27.277
> 
> 标签：objective-c, image-processing, compression, shrink

我想在 OSX 上缩小 png 或 jpg。我只想缩小而不影响图像质量。
像[tinypng.org](http://tinypng.org/)

有推荐的图书馆吗？我只知道imagemagick。有没有办法在本地做到这一点？或其他库来缩小/压缩图像而不影响图像质量？

我的目标是缩小文件大小，例如：

```
logo.png >> 476 k before shrink 
logo.png >> 50k after shrink 
```

编辑：要清楚，我想压缩**文件**的大小，而不是图像分辨率。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T22:55:43.773

[TinyPNG.org](http://tinypng.org)通过使用图像量化来工作——图像中相似的颜色被转换为 HSV 或 RGB 模型，然后根据距离进行合并。

> 它是如何工作的？
> ...
> 当您上传 PNG（便携式网络图形）文件时，图像中的相似颜色会组合在一起。这种技术被称为“量化”
> ...
> src：[http ://tinypng.org](http://tinypng.org)

此处的答案概述了这样做的方法：[https](https://stackoverflow.com/a/492230/556479) ://stackoverflow.com/a/492230/556479 。

关于这个问题也有一些答案，请参考如何在**Mac OS 上使用 Objective-c**执行此操作：[如何将位图减少为一组已知的 RGB 颜色](https://stackoverflow.com/questions/622573/how-do-i-reduce-a-bitmap-to-a-known-set-of-rgb-colours)

有关更深入的指南，请参阅 Wikipedia：[http ://en.wikipedia.org/wiki/Color_quantization](http://en.wikipedia.org/wiki/Color_quantization)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T22:57:19.690

我的建议是使用[http://pngnq.sourceforge.net](http://pngnq.sourceforge.net)，它会提供比 ImageMagick 更好的结果，对于[http://tinypng.org](http://tinypng.org)中给出的单个示例，它也会产生非常相似的输出。它是论文“Kohonen Neural Networks for Optimal Color Quantization”中方法的微小 C 实现。仅此一项就更好了，因为您不再依赖封闭的未知实现。

原始文件 (57 KB)、tinypng.org (16 KB)、pngnq (17 KB)：

![在此处输入图像描述](../Images/c499d12138ee23167768c5b197aaaea5.png) ![在此处输入图像描述](../Images/b87549090bca5c2ecb064a684c30848e.png) ![在此处输入图像描述](../Images/d2dd93d9baf7efa3ed1f290f3d0bdf93.png)

使用 ImageMagick，我可以得到的 256 色的最佳量化使用了 Floyd-Steinberg 的 LAB 色彩空间和抖动：

```
convert input.png -quantize LAB -dither FloydSteinberg -colors 256 output.png 
```

这会生成一个 16 KB 的 png，但它包含更多的视觉伪像：

![在此处输入图像描述](../Images/d9261dc49b175fac177c737d9406807f.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T16:08:42.930

您在使用 ImageMagick 时遇到问题吗？它具有丰富的量化功能，例如

```
bool MagickQuantizeImage( MagickWand mgck_wnd, 
                          float number_colors, 
                          int colorspace_type, 
                          float treedepth, 
                          bool dither, 
                          bool measure_error ) 
```

[这是使用 imageMagick 进行量化](http://www.imagemagick.org/Usage/quantize/)的非常详尽的指南

# vb.net - 在 VB.net 中重命名 %appdata% 中的文件

> ID：14782099
> 
> 赞同：0
> 
> 时间：2013-02-08T22:06:17.933
> 
> 标签：vb.net

所以我需要有人告诉我如何修复这段代码。我正在尝试将一个文件重命名`C:\%appdata%\Roaming\.minecraft\bin\XenonUpdate.jar`为`minecraft.jar`. 我正在使用的代码是：

```
My.Computer.FileSystem.RenameFile("C:\%appdata%\Roaming\.minecraft\bin\XenonUpdate.jar", "minecraft.jar") 
```

有人可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T22:11:39.340

`%appdata%`不是有效路径，而是表示您可以通过使用获取的特殊文件夹`Environment.GetFolderPath`，一旦获取`%appdata%`路径，您可以轻松重命名文件。

```
 Dim folder As String = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData)
    Dim file_to_rename = Path.Combine(folder, ".minecraft\bin\XenonUpdate.jar")
    My.Computer.FileSystem.RenameFile(file_to_rename, "minecraft.jar") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T22:11:06.953

文件处理函数不处理环境变量扩展，`%appdata%`. 你需要自己做这件事。

我的 VB.Net 不存在，但我认为它看起来像

```
Dim path = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData)
Dim from = path + "\.minecraft..."
Dim to = path + "\.minecraft..."
My.Computer.FileSystem.RenameFile(from, to) 
```

另请参阅[C# 获取 %AppData% 的路径](https://stackoverflow.com/questions/867485/c-sharp-getting-the-path-of-appdata)

# c - 命令行参数inter c

> ID：14782103
> 
> 赞同：0
> 
> 时间：2013-02-08T22:06:29.413
> 
> 标签：c, integer

我想让这个程序在`main()`没有命令行参数的情况下进行打印。如果有命令行参数（应该只是一个整数），它应该运行函数`bitcount()`。

我该怎么做呢？如果没有命令行参数，我不确定这将如何正常工作。

我将如何检查用户是否输入了命令行参数？如果他们这样做了，运行`bitCount()`而不是`main()`. 但是，如果他们没有放置任何命令行整数参数，那么它只会运行 main。

例如`./bitCount 50`应该调用该`bitCount`函数，但`./bitCount`应该只运行`main`

这是我到目前为止所拥有的：

```
#include <stdio.h>
#include <stdlib.h>

int bitCount (unsigned int n);
int main ( int argc, char** argv) {

    printf(argv);
    int a=atoi(argv);

    //   int a = atoi(argv[1]);

    printf ("# 1-bits in base 2 representation of %u = %d, should be 0\n",
      0, bitCount (0));
    printf ("# 1-bits in base 2 representation of %u = %d, should be 1\n",
      1, bitCount (1));
    printf ("# 1-bits in base 2 representation of %u = %d, should be 16\n",
      2863311530u, bitCount (2863311530u));
    printf ("# 1-bits in base 2 representation of %u = %d, should be 1\n",
      536870912, bitCount (536870912));
    printf ("# 1-bits in base 2 representation of %u = %d, should be 32\n",
      4294967295u, bitCount (4294967295u));
    return 0;
  }

  int bitCount (unsigned int n) {
      //stuff here
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T22:08:38.627

`int argc`包含命令行中的参数数量，其中可执行文件的名称是 argv[0]。所以，`argc < 2`意味着没有给出命令行参数。我真的不明白在没有命令行参数的情况下你想要或不想运行什么，但它应该在`if (argc < 2)`.

在您的示例代码中，您正在做一些非常奇怪的事情，请记住这一点：

```
printf(argv); 
```

因为 argv 是一个`char **`, 或数组，`char *`它永远不会产生任何有用的东西。更糟糕的是，因为 printf 期望格式字符串作为它的第一个参数，所以上面的行可能会导致各种奇怪的事情。

```
int a=atoi(argv); 
```

同样在这里。atoi 也想要一个字符串，与上面相同的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T22:12:58.343

argv 是一个字符串数组，其中包含程序名称，后跟所有参数。argc 是 argv 数组的大小。对于程序名称，argc 始终至少为 1。

如果有参数 argc 将 > 1。

所以，

```
if (argc > 1)
{
    /* for simplicity ignore if more than one parameter passed, just use first */
    bitCount(atoi(argv[1]));
}
else
{
    /* do stuff in main */
} 
```

# javascript - 当某些东西附加到内存中的 DOM 时，会导致浏览器重排吗？

> ID：14782106
> 
> 赞同：5
> 
> 时间：2013-02-08T22:07:01.483
> 
> 标签：javascript, jquery, performance, browser

当某些东西附加到内存中的 DOM 时，会导致浏览器重排吗？还是只有当屏幕上的像素被告知要改变回流才会发生？例如：

**案例 1：**一次一个附加到 DOM 的 img 元素

```
var parentDiv = $('#imgHolder');
var imgArray = []; // Array of img paths populated in another function

$.each(imgArray, function()
{
    parentDiv.append(createImgEle(this)); // createImgEle() // returns an <img> with the right src
} 
```

**案例2：**将img元素放在一个单独的数组中，然后附加到DOM中

```
var parentDiv = $('#imgHolder');
var imgArray = []; // Array of img paths populated in another function
var tempArray = []; // Holds the img elements until its fully populated

$.each(imgArray, function()
{
    tempArray.push(createImgEle(this));
}
parentDiv.append(tempArray); 
```

**案例 3：**案例 1 或 2，但默认情况下，parentDiv 设置为`display:none;`并在每个循环完成后变为可见。

基本上，我想知道的是，当屏幕的像素被告知改变时，浏览器是否*才开始重排？*

顺便说一句，代码仅用于示例目的，而不是在生产中，所以不要因为任何逻辑错误而抨击我。谢谢你的任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T22:40:11.013

> 基本上，我想知道的是，当屏幕的像素被告知改变时，浏览器是否才开始重排？

不，浏览器会在 DOM 更改时重排。之后，它将重新绘制（告诉屏幕上的像素发生变化）。

有关详细信息，请查看[此 dev.opera.com 文章](http://dev.opera.com/articles/view/efficient-javascript/?page=3#reflow)和问题[何时在 DOM 环境中发生回流？](https://stackoverflow.com/q/510213/1048572).

简而言之：当然还有对后续 DOM 更改的优化，例如，如果您在循环中插入一个元素数组。我不希望您的案例 1 和案例 2 有明显的不同。

仅当您进行大量 DOM 更改时，您可能需要案例 #3。这使得回流（如果它们发生在插入循环期间）在遇到隐藏元素时停止，因此基本上可以防止它们。但是，循环前后的两次显示变化会导致在某些浏览器中闪烁。

# session - 会话未在 Cakephp 2.2.3 上开始

> ID：14782119
> 
> 赞同：0
> 
> 时间：2013-02-08T22:07:39.610
> 
> 标签：session, cakephp, cakephp-2.2

我对 cakephp 2.2.3 的会话有一个奇怪的问题......我的会话没有在网络服务器上启动。我尝试在控制器上使用此代码：

```
<?php
 if ($this->Session->write('Test', 'hi')){
       echo $this->Session->read('Test');
  }
  else{
       echo 'bye';
  } 
```

并且输出在网络服务器上是**再见，在本地主机上是****你好**。

所以，我进一步检查，发现方法 CakeSession::start() 总是返回 false。今天开始发生这种情况，我无法意识到可能导致这种情况的原因......我在 core.php 上的会话配置是

```
 Configure::write('Session', array(
    'defaults' => 'database',
    'checkAgent' => true,
    'timeout' => 31104000,
    'cookie' => 'vejomun'
)); 
```

将调试设置为 2 时，我收到很多这样的警告：

```
Warning (2): ini_set() has been disabled for security reasons [CORE/Cake/Model/Datasource/CakeSession.php, line 484] 
```

但一直都是这样，直到昨天的会议还可以......

在此先感谢，抱歉英语不好。

编辑：

如果有人有同样的问题，那只是 html 开头的空白行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T06:18:47.033

在页面顶部写

```
 session_start(); 
```

如果你写这行然后 php 将与 session 兼容

# javascript - 我可以在不登录的情况下使用纯 JavaScript 获取 Facebook 墙贴吗？

> ID：14782120
> 
> 赞同：-2
> 
> 时间：2013-02-08T22:07:52.140
> 
> 标签：javascript, facebook, web-applications, facebook-javascript-sdk, facebook-login

如果我不使用 PHP 或其他后端代码，我可以在不登录的情况下获取 Facebook 墙贴吗？

我有一个需要获取 Facebook 墙贴的应用程序。我想用纯 JavaScript 完成这项任务。看来我必须先让用户登录才能看到这些帖子，这对某些人来说很烦人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T22:35:05.617

您可以使用应用的访问令牌而不是当前用户的。但是，您不应该在客户端使用这个，因为在生成的 HTML 中显示您的应用程序机密或应用程序的访问令牌是不安全的，因为他们将能够使用它。您必须在服务器端获取它，与获取墙帖相同。检查[此](https://developers.facebook.com/docs/technical-guides/opengraph/publishing-with-app-token/)以获取有关应用程序访问令牌的信息。您还可以在[此问题](https://stackoverflow.com/questions/9373645/can-you-get-a-public-facebook-pages-feed-using-graph-api-without-asking-a-user)和答案中找到一些提示。但是，请务必检查答案和评论的日期，因为 FB Api 中的某些内容会及时更改，而某些内容现在可能已过时。

# php - php单选按钮电子邮件

> ID：14782132
> 
> 赞同：0
> 
> 时间：2013-02-08T22:08:38.020
> 
> 标签：php, forms, email

我正在尝试制作一个表格来询问人们是否参加活动。我搜索了多个主题和论坛。我还求助于谷歌并阅读了一些教程，但我无法将正确答案与我需要的相关联。我试图弄清楚如何根据选定的单选按钮发送一封带有消息的电子邮件。如果可以，请你帮助我。非常感谢。

```
<FORM method="post" name="RSVPform" action="respond.php" target="_blank">
Name(s): <input name="name" size="42" type="text" /><br/><br/>
Will you be attending the event?<br/><br/>
<input checked="checked" name="answer" type="radio" value="true" /> Yes, I(we) will     attend.<br/><br/>

If yes, how many will be attending? <input name="number" size="25" type="text" /><br/><br/>

<input name="answer" type="radio" value="false"/>Sadly, we are unable to attend.    <br/><br/> <input name="Submit" type="submit" value="Submit" />
</FORM> 
```

这是我一直在尝试使用的 php。

```
<?php
$to = "myemail@email.com";
$name = $_REQUEST['name'] ;
$answer = $_REQUEST['answer'] ;
$subject = "RSVP from: $name";
$number = $_REQUEST['number'] ;
$headers = "RSVP";
$body = "From: $name, \n\n I(we) will be attending the event. There will be $number of us. \n\n Thanks for the invite.";
$sent = mail($to, $subject, $body, $headers) ;
if($sent)
{echo "<script language=javascript>window.location = 'LINK BACK TO CONTACT PAGE';</script>";}
else
{echo "<script language=javascript>window.location = 'LINK BACK TO CONTACT PAGE';</script>";}
?> 
```

我不确定如何根据所选单选按钮更改 $body 消息。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:12:15.323

您需要 PHP 中的条件，但请注意，在您的 HTML 中，“true”和“false”将作为字符串而不是布尔值发送，因此都是真实的，但您可以检查实际字符串。

`$answer = $_REQUEST['answer'] ;`附加/修改/写入您的电子邮件正文后的任何地方，例如

```
if ($answer=='true') {
    $body='Yay you\'re coming';
}else{
    $body='Ah screw you then';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T22:13:19.613

这是您需要的绝对基础。只需根据发布的答案交换您的变量。

```
if($_POST['answer'] == "true")
{
    // user is coming
}
else
{
    // user is not coming
} 
```

# grails - 如何在不使用模块的情况下指定 Grails 资源？

> ID：14782134
> 
> 赞同：1
> 
> 时间：2013-02-08T22:08:46.413
> 
> 标签：grails, resources, handlebars.js

我正在使用 Grails 的车把资源插件将我的模板编译为我的 Grails 应用程序的资源包。但是，这需要我在它自己的模块中指定 handlerbars 模板。例如：

```
modules = {
application {
    dependsOn 'handlebars_runtime'
    resource url: 'http://code.jquery.com/jquery-latest.js', disposition: 'head'
    resource url: 'js/less-1.3.3.min.js', disposition: 'head'
    resource url: 'js/bootstrap.min.js'
}

newCustomer {
    dependsOn 'application'
    resource url: 'templates/new_customer_page_1.handlebars', attrs: [type: 'js'], bundle: 'bundle_application'
    resource url: 'js/newCustomerPage1.js'
}
} 
```

我真的很想将车把模板文件和随附的 javascript 移动到使用该 javascript 和模板的 gsp 文件中。我仍然希望它捆绑在捆绑包中，但我注意到新模块需要我重新启动服务器才能显示。更不用说我希望我会为每个页面定义很多模块，从而使 ApplicationResources.groovy 文件变得巨大。如果我可以将这些推送到开发人员创建的 gsp 文件中，它应该将该文件保持在最低限度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T03:24:19.060

你能把你想要共同的项目放在一个模块中，然后将单独的模板移到单独的 gsp 文件中吗？

Resources 插件不提供任何用于捆绑模块外部项目的工具，这就是模块的含义，您希望将项目捆绑在一起。

可以编写一个单独的工具来以特定方式使用 ResourceProcessor 类来实现不同的行为。

# python - 使用 numpy.take 键入转换错误

> ID：14782135
> 
> 赞同：6
> 
> 时间：2013-02-08T22:08:59.813
> 
> 标签：python, numpy, lookup-tables

`uint8`我有一个存储 65536 个值的查找表 (LUT) ：

```
lut = np.random.randint(256, size=(65536,)).astype('uint8') 
```

我想使用这个 LUT 来转换`uint16`s 数组中的值：

```
arr = np.random.randint(65536, size=(1000, 1000)).astype('uint16') 
```

我想就地进行转换，因为最后一个数组可能会变得很大。当我尝试时，会发生以下情况：

```
>>> np.take(lut, arr, out=arr)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "C:\Python27\lib\site-packages\numpy\core\fromnumeric.py", line 103, in take
    return take(indices, axis, out, mode)
TypeError: array cannot be safely cast to required type 
```

而且我不明白发生了什么。我知道，如果没有`out`参数，返回的 dtype 与`lut`, 所以`uint8`. 但是为什么不能将 a`uint8`转换为 a `uint16`？如果你问 numpy：

```
>>> np.can_cast('uint8', 'uint16')
True 
```

显然，以下工作：

```
>>> lut = lut.astype('uint16')
>>> np.take(lut, arr, out=arr)
array([[173, 251, 218, ..., 110,  98, 235],
       [200, 231,  91, ..., 158, 100,  88],
       [ 13, 227, 223, ...,  94,  56,  36],
       ..., 
       [ 28, 198,  80, ...,  60,  87, 118],
       [156,  46, 118, ..., 212, 198, 218],
       [203,  97, 245, ...,   3, 191, 173]], dtype=uint16) 
```

但这也有效：

```
>>> lut = lut.astype('int32')
>>> np.take(lut, arr, out=arr)
array([[ 78, 249, 148, ...,  77,  12, 167],
       [138,   5, 206, ...,  31,  43, 244],
       [ 29, 134, 131, ..., 100, 107,   1],
       ..., 
       [109, 166,  14, ...,  64,  95, 102],
       [152, 169, 102, ..., 240, 166, 148],
       [ 47,  14, 129, ..., 237,  11,  78]], dtype=uint16) 
```

这真的没有意义，因为 now `int32`s 被强制转换为`uint16`s，这绝对不是一件安全的事情：

```
>>> np.can_cast('int32', 'uint16')
False 
```

如果我将`lut`'s dtype设置为`uint16`, `uint32`, `uint64`, `int32`or中的任何内容，我的代码就可以工作`int64`，但对于`uint8`,`int8`和`int16`.

我是否遗漏了什么，或者这只是在 numpy 中被破坏了？

也欢迎解决方法......由于LUT不是那么大，我想让它的类型匹配数组的类型并没有那么糟糕，即使这需要两倍的空间，但这样做感觉不对。 ..

有没有办法告诉 numpy 不要担心铸造安全？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T14:26:12.513

有趣的问题。`numpy.take(lut, ...)`被转换成`lut.take(...)`可以在这里查看其来源：

[https://github.com/numpy/numpy/blob/master/numpy/core/src/multiarray/item_selection.c#L28](https://github.com/numpy/numpy/blob/master/numpy/core/src/multiarray/item_selection.c#L28)

[我相信在第 105 行](https://github.com/numpy/numpy/blob/master/numpy/core/src/multiarray/item_selection.c#L105)抛出异常：

```
obj = (PyArrayObject *)PyArray_FromArray(out, dtype, flags);
if (obj == NULL) {
    goto fail;
} 
```

在你的情况下`out`是`arr`但是`dtype`其中之一`lut`，即`uint8`。所以它尝试强制转换`arr`为`uint8`，但失败了。我不得不说我不确定它为什么需要这样做，只是指出它确实......由于某种原因`take`似乎假设您希望作为输出数组具有`dtype`与`lut`.

顺便说一句，**在许多情况下，调用`PyArray_FromArray`实际上会创建一个新数组，而替换不会到位**。例如[，如果您`take`使用`mode='raise'`](https://github.com/numpy/numpy/blob/master/numpy/core/src/multiarray/item_selection.c#L95)（默认值，以及您的示例中发生的情况）调用，或者无论何时调用，就是这种情况`lut.dtype != arr.dtype`。好吧，至少它应该，而且我无法解释为什么，当你投射`lut`到`int32`输出数组时仍然存在`uint16`！这对我来说是个谜——也许它与[NPY_ARRAY_UPDATEIFCOPY](https://github.com/numpy/numpy/blob/master/numpy/core/src/multiarray/item_selection.c#L86)标志有关（另见[此处](http://docs.scipy.org/doc/numpy-dev/reference/c-api.array.html#NPY_ARRAY_UPDATEIFCOPY)）。

底线：

1.  numpy 的行为确实很难理解......也许其他人会提供一些关于它为什么会这样做的见解
2.  我不会尝试`arr`就地处理 - 无论如何，在大多数情况下，似乎在引擎盖下创建了一个新数组。我会简单地选择`arr = lut.take(arr)`- 顺便说一下，它最终会释放`arr`.

# cakephp - CakePHP 教程没有看到 PostsController

> ID：14782137
> 
> 赞同：0
> 
> 时间：2013-02-08T22:09:11.017
> 
> 标签：cakephp

我目前正在研究 cakephp 教程，并且已经完成了前几个步骤。我已经添加了后期模型控制器（带有动作）和视图。但由于某种原因，当我访问 www.mysite/posts/index 时，我收到 404 错误。我还注意到默认的 www.mysite.com 说

*错误：找不到 PhpController。*

有什么建议么？

**/PostsController.php/**

```
<?php

class PostsController extends AppController {
    public $helpers = array('Html', 'Form');

    public function index() {
        $this->set('posts', $this->Post->find('all'));
    }  
 } 
```

我在同一目录中也有一个 PagesController.php。我把它贴在这里 [http://jsfiddle.net/Z3jdu/](http://jsfiddle.net/Z3jdu/) ?>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T08:56:51.657

我想你可以通过关于页面控制器从不编辑 /cake/.. 中的文件找到。覆盖或扩展它们。默认情况下您不需要 index.php，您应该启用 mod rewrite 并允许 cake php 正确读取 url 尝试检查您的 .htaccess 和服务器配置以确保可以读取 .htaccess。最后我应该提到这个检查你的根目录、应用程序和 webroot 目录，看看它们是否真的包含一个 .htaccess 文件。确保您的 apache 服务器配置实际上具有以下内容（将其视为 localhost，允许一切吗？）：

```
Options FollowSymLinks
AllowOverride All
Order deny,allow
Allow from all 
```

确保以下行未使用井号标签 (#) 进行注释

```
LoadModule rewrite_module libexec/apache2/mod_rewrite.so 
```

希望您的应用程序能够正常工作，并且您可以开始博客教程以了解更多信息

# javascript - 我可以在 javascript 中由同一构造函数创建的其他对象上调用方法吗？

> ID：14782138
> 
> 赞同：0
> 
> 时间：2013-02-08T22:09:12.713
> 
> 标签：javascript, oop, object, constructor

假设我有一个第三方页面开发人员可以在他们的页面中插入的对象构造函数，称为“Widget”。例如，它可能是类似于工具提示的东西。

```
var Widget = function(settings, callbacks) {
    this.hide = function() {
        //some code...
    };

    this.show = function() {
        this.isShowing = true;

        //more code...
    }
} 
```

当显示此小部件时，我想隐藏任何其他显示的小部件。有没有办法“show”方法可以在“this.isShowing”为真的 Widget 的其他实例或 Widget 的所有实例上调用“hide”方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T22:14:50.300

您可以，但您需要维护对这些实例的引用。您可以在函数本身的属性上维护它们：

```
var Widget = function(settings, callbacks) {
  Widget.instances.push(this);
  // More code
};
Widget.instances = []; 
```

然后，只需访问`Widget.instances`以获取创建的所有小部件。

您可能想要创建某种析构函数来从列表中删除一个小部件（`myWidget.destroy()`或其他东西），因为如果您实例化太多小部件，这可能会产生内存泄漏。

# php - PHP注意：间接修改重载属性Url::$id没有效果

> ID：14782139
> 
> 赞同：1
> 
> 时间：2013-02-08T22:09:12.590
> 
> 标签：php, yii

我使用 Yii，我得到了这个错误；我应该理解和做什么？

不重复：[来源](https://stackoverflow.com/questions/13421661/getting-indirect-modification-of-overloaded-property-has-no-effect-notice)或任何其他；

错误在：`->bindParam(":url_id", $url->id)`

```
$url = Url::model()->findByAttributes(array('link' => $_url));
        if (empty($url)) {
            $url = new Url();
            $url->website_id = $website->id;
            $url->link = $_url;
            $url->title = '';
            $url->description = '';
            $url->doctype = $_doctype;
            $url->visits = 1;
            $url->created = date('Y-m-d h:i:s',time());
            $url->updated = date('Y-m-d h:i:s',time());
            $url->status = 1;
            $url->save(false);
        } else {
            // update visits
            $url->saveCounters(array('visits' => 1));
            // url existed, let's load products
            if (!Yii::app()->user->isGuest) {
                $sql = "select u.id from url as u
                    left join url_follower as u_f
                    on u.id = u_f.url_id and u_f.user_id = :user_id
                    where u.id =:url_id";
                $cmd = Yii::app()->db->createCommand($sql)
                        ->bindParam(":url_id", $url->id)
                        ->bindParam(":user_id", Yii::app()->user->id);
                $url_id = $cmd->queryScalar(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T22:46:29.793

解决方案，测试：

```
$user_id = Yii::app()->user->id;
                $url_id = $url->id;
                $cmd = Yii::app()->db->createCommand($sql)
                        ->bindParam(":user_id", $user_id)
                        ->bindParam(":url_id", $url_id); 
```

# python - 在linux中，如何使用python来检查外部程序是否正在运行？

> ID：14782141
> 
> 赞同：1
> 
> 时间：2013-02-08T22:09:23.370
> 
> 标签：python, linux

在linux中，如何使用python来检查外部的非系统程序是否正在运行？这个任务有标准模块吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T22:16:25.137

使用[psutil](http://code.google.com/p/psutil/)，例如

```
import psutil

def check_if_running(name):
    for ps in psutil.process_iter():
        if ps.name == name:
            return True
    return False

check_if_running('python')
>>> True 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T22:14:19.817

您可能对[psutil](http://code.google.com/p/psutil/)感兴趣。否则，您可以使用*子进程*库调用*pgrep 。*

# c - Linux Socket：如何在客户端程序中检测断开的网络？

> ID：14782143
> 
> 赞同：15
> 
> 时间：2013-02-08T22:09:24.820
> 
> 标签：c, linux, sockets, send, disconnection

我正在调试基于 ac 的 linux 套接字程序。正如网站上提供的所有示例一样，我应用了以下结构：

```
sockfd= socket(AF_INET, SOCK_STREAM, 0);

connect(sockfd, (struct sockaddr *) &serv_addr, sizeof(serv_addr));

send_bytes = send(sockfd, sock_buff, (size_t)buff_bytes, MSG_DONTWAIT); 
```

当删除服务器关闭其服务器程序时，我可以检测到断开连接。但是如果我拔下以太网电缆，发送函数仍然返回正值而不是 -1。

假设我无法更改服务器端，如何检查客户端程序中的网络连接？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-02-08T22:25:27.813

> 但是如果我拔下以太网电缆，发送函数仍然返回正值而不是 -1。

首先你应该知道`send`实际上并没有发送任何东西，它只是一个内存复制函数/系统调用。它将数据从您的进程复制到内核 - 稍后内核将获取该数据并将其打包成段和数据包后将其发送到另一端。因此`send`只能在以下情况下返回错误：

*   套接字无效（例如伪造的文件描述符）
*   连接显然无效，例如它尚未建立或已以某种方式终止（FIN、RST、超时 - 见下文）
*   没有更多空间可以复制数据

要点是它`send`不发送任何东西，因此**它的返回码不会告诉您任何有关实际到达另一端的数据的信息**。

回到您的问题，当 TCP 发送数据时，它期望在合理的时间内得到有效的确认。如果它没有得到一个，它会重新发送。它多久重新发送一次？每个 TCP 堆栈做的事情都不同，但规范是使用指数退避。也就是说，先等待 1 秒，然后等待 2 秒，然后等待 4 秒，以此类推。在某些堆栈上，此过程可能需要几分钟。

要点是，在中断的情况下，**只有在一段非常长的静默期后，** TCP 才会宣布连接死亡（在 Linux 上，它会重试 15 次 - 超过 5 分钟）。

解决这个问题的一种方法是在您的应用程序中实现一些确认机制。例如，您可以向服务器发送请求“*在 5 秒内回复，否则我将宣布此连接失效*”，然后`recv`超时。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T22:21:49.910

要检测远程断开连接，请执行`read()`

检查此线程以获取更多信息：

[已连接套接字上的 read() 函数可以返回零字节吗？](https://stackoverflow.com/questions/2416944/can-read-function-on-a-connected-socket-return-zero-bytes)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-01-25T07:29:23.953

仅通过调用 write() 函数无法检测到拔出的以太网电缆。那是因为 tcp 堆栈在您没有意识的情况下进行了 tcp 重传。以下是解决方案。

即使您已经为您的应用程序套接字设置了keepalive选项，您也无法及时检测到套接字的死连接状态，以防您的应用程序一直在套接字上写入。那是因为内核 tcp 堆栈的 tcp 重传。tcp_retries1 和 tcp_retries2 是用于配置 tcp 重传超时的内核参数。重传超时的准确时间很难预测，因为它是通过 RTT 机制计算的。你可以在 rfc793 中看到这个计算。(3.7\. 数据通信)

[https://www.rfc-editor.org/rfc/rfc793.txt](https://www.rfc-editor.org/rfc/rfc793.txt)

每个平台都有用于 tcp 重传的内核配置。

```
Linux : tcp_retries1, tcp_retries2 : (exist in /proc/sys/net/ipv4) 
```

[http://linux.die.net/man/7/tcp](http://linux.die.net/man/7/tcp)

```
HPUX : tcp_ip_notify_interval, tcp_ip_abort_interval 
```

[http://www.hpuxtips.es/?q=node/53](http://www.hpuxtips.es/?q=node/53)

```
AIX : rto_low, rto_high, rto_length, rto_limit 
```

[http://www-903.ibm.com/kr/event/download/200804_324_swma/socket.pdf](http://www-903.ibm.com/kr/event/download/200804_324_swma/socket.pdf)

如果您想及早检测到死连接，您应该为 tcp_retries2 设置较低的值（默认为 15），但这不是我已经说过的精确时间。此外，目前您不能只为单个套接字设置这些值。这些是全局内核参数。有一些尝试为单套接字应用 tcp 重传套接字选项（[http://patchwork.ozlabs.org/patch/55236/](http://patchwork.ozlabs.org/patch/55236/)），但我认为它没有应用于内核主线。我在系统头文件中找不到这些选项定义。

作为参考，您可以通过如下所示的“netstat --timers”监控您的 keepalive 套接字选项。 [https://stackoverflow.com/questions/34914278](https://stackoverflow.com/questions/34914278/how-can-i-clean-the-dead-connection-in-the-right-time-i-want-tcp-keepalive-and)

```
netstat -c --timer | grep "192.0.0.1:43245             192.0.68.1:49742"

tcp        0      0 192.0.0.1:43245             192.0.68.1:49742            ESTABLISHED keepalive (1.92/0/0)
tcp        0      0 192.0.0.1:43245             192.0.68.1:49742            ESTABLISHED keepalive (0.71/0/0)
tcp        0      0 192.0.0.1:43245             192.0.68.1:49742            ESTABLISHED keepalive (9.46/0/1)
tcp        0      0 192.0.0.1:43245             192.0.68.1:49742            ESTABLISHED keepalive (8.30/0/1)
tcp        0      0 192.0.0.1:43245             192.0.68.1:49742            ESTABLISHED keepalive (7.14/0/1)
tcp        0      0 192.0.0.1:43245             192.0.68.1:49742            ESTABLISHED keepalive (5.98/0/1)
tcp        0      0 192.0.0.1:43245             192.0.68.1:49742            ESTABLISHED keepalive (4.82/0/1) 
```

另外，当keepalive超时发生时，你可以根据你使用的平台遇到不同的返回事件，所以不能只通过返回事件来判断死连接状态。例如，HP 返回 POLLERR 事件，而 AIX 在发生 keepalive 超时时仅返回 POLLIN 事件。那时你会在 recv() 调用中遇到 ETIMEDOUT 错误。

在最近的内核版本（自 2.6.37 起）中，您可以使用 TCP_USER_TIMEOUT 选项会很好地工作。此选项可用于单套接字。

最后，您可以使用带有 MSG_PEEK 标志的读取函数，它可以让您检查套接字是否正常。（MSG_PEEK 只是偷看数据是否到达内核堆栈缓冲区，并且从不将数据复制到用户缓冲区。）所以你可以使用这个标志来检查套接字是否正常，没有任何副作用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-08T22:24:33.187

检查返回值，看看它是否等于这个值：

> EPIPE
> 此套接字已连接，但连接已断开。在这种情况下，send 先生成一个 SIGPIPE 信号；如果该信号被忽略或阻塞，或者如果其处理程序返回，则发送失败并显示 EPIPE。

还要在处理程序中添加对 SIGPIPE 信号的检查，以使其更易于控制。

# bash - 如何使用 cp、变量和方括号从不同目录复制多个文件？

> ID：14782147
> 
> 赞同：4
> 
> 时间：2013-02-08T22:09:46.057
> 
> 标签：bash

我的问题与如何使用 cp 从不同目录复制多个文件非常相似[？](https://stackoverflow.com/questions/9915822/how-to-copy-multiple-files-from-a-different-directory-using-cp)

我不想使用显式循环。这是我所做的：

```
$ FILES_TOOLS="fastboot,fastboot-HW.sh"
$ cp $HOME/tools/{$FILES_TOOLS} $TOP_DIR/removeme
cp: cannot stat `/home/johndoe/tools/{fastboot,fastboot-HW.sh}': No such file or directory 
```

文件存在且目标有效，因为：

```
$ cp $HOME/tools/{fastboot,fastboot-HW.sh} $TOP_DIR/removeme
$ echo $?
0 
```

*   我试图从 FILES_TOOLS 中删除双引号，但不走运。
*   我试图引用和双引号 {...}，没有运气
*   我试图反斜杠括号，没有运气
*   我想这是外壳扩展实际发生时的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T22:24:34.797

*这个答案仅限于 bash。*

预先添加一个`echo`以查看您的`cp`命令变成了什么：

```
echo cp $HOME/tools/{$FILES_TOOLS} $TOP_DIR/removeme 
```

您必须在子外壳中插入一个`eval`才能使其工作：

```
cp $( eval echo $HOME/tools/{$FILES_TOOLS} ) $TOP_DIR/removeme 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T22:23:18.813

> 我想这是外壳扩展实际发生时的问题。

是的。不同的 shell 对于与变量扩展相关的大括号扩展有不同的规则。您的方式适用于 ksh，但不适用于 zsh 或 bash。`{1..$n}`适用于 ksh 和 zsh 但不适用于 bash。在 bash 中，变量扩展总是发生在大括号扩展之后。

在 bash 中你最接近这个的是`eval`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T00:04:04.417

只要大括号的内容是文字，您就可以使用大括号扩展来使用要复制的文件的完整路径名填充数组，然后在`cp`命令中展开数组的内容。

```
$ FILES_TOOLS=( $HOME/tools/{fastboot,fastboot-HW.sh} )
$ cp "${FILES_TOOLS[@]}" $TOP_DIR/removeme 
```

更新：我意识到你可能有理由在变量中单独使用基本名称。这是另一个基于数组的解决方案，可让您在数组的每个元素前加上路径，同样无需显式循环：

```
$ FILES_TOOLS=( fastboot fastboot-HW.sh )
$ cp "${FILES_TOOLS[@]/#/$HOME/tools/}" $TOP_DIR/removeme 
```

在这种情况下，您使用模式替换运算符将每个数组元素开头的空字符串替换为目录名称。

# arrays - 在 postgresql 中将列从字符串更改为字符串数组

> ID：14782148
> 
> 赞同：22
> 
> 时间：2013-02-08T22:09:53.337
> 
> 标签：arrays, database, postgresql, postgresql-9.2

以下是名为“容器”的表的片段。

```
 Column       |            Type             |            Modifiers            
--------------------+-----------------------------+---------------------------------
 id                 | uuid                        | not null
 name               | character varying(255)      | 
 products           | character varying           | default '{}'::character varying 
```

如何将`products`列更改为`"character varying[]"`并将相应的修饰符更改为`default '{}'::character varying[]`？本质上，我想将字符串转换为字符串数组。请注意，产品列对字符数没有限制。

```
alter table "containers" alter "products" type character varying[]; 
```

引发以下错误

> 错误：列“产品”不能转换为类型不同的字符 []

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-02-08T22:29:54.613

Postgres中没有隐式转换 from `varchar`to `varchar[]`。您必须指明如何执行类型的转换。您应该在`USING expression`子句中执行此操作（请参阅文档中的[ALTER TABLE](http://www.postgresql.org/docs/9.2/static/sql-altertable.html)）。在这种情况下，您必须删除并重新创建列的默认值，如文档中所述：

> SET DATA TYPE 的 USING 选项实际上可以指定任何涉及行旧值的表达式；也就是说，它可以引用其他列以及正在转换的列。这允许使用 SET DATA TYPE 语法进行非常一般的转换。由于这种灵活性，USING 表达式不适用于列的默认值（如果有）；结果可能不是默认值所需的常量表达式。这意味着当没有从旧类型到新类型的隐式或赋值强制转换时，即使提供了 USING 子句，SET DATA TYPE 也可能无法转换默认值。在这种情况下，使用 DROP DEFAULT 删除默认值，执行 ALTER TYPE，然后使用 SET DEFAULT 添加合适的新默认值。

```
alter table containers alter products drop default;
alter table containers alter products type text[] using array[products];
alter table containers alter products set default '{}'; 
```

这三个操作可以在一个语句中完成：

```
alter table containers 
    alter products drop default,
    alter products type text[] using array[products],
    alter products set default '{}'; 
```

# javascript - 内联 CKEditor 工具栏没有 h2 元素的对齐按钮

> ID：14782152
> 
> 赞同：3
> 
> 时间：2013-02-08T22:09:59.157
> 
> 标签：javascript, ckeditor

（也在他们的演示页面[http://ckeditor.com/demo#inline](http://ckeditor.com/demo#inline)）

为什么会这样？即使我采用他们的内联样本（[http://nightly.ckeditor.com/13-02-08-08-51/standard/samples/inlineall.html](http://nightly.ckeditor.com/13-02-08-08-51/standard/samples/inlineall.html)）并删除标题块的单独工具栏的js代码，我仍然没有对齐选项。

我想为用户提供对齐标题的选项。我错过了什么？

我也没有得到像 BulletedList 这样的其他“阻止”选项，但这不是问题。

**更新：**要重复该问题，您需要将 contenteditable="true" 应用于标题元素。因此，一种解决方法是用 contenteditable="true" 将标题包装在 div 中。但这对我的情况没有帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-11T11:06:35.127

从 CKEditor 4 开始，您需要 Justify 插件。

1.  [在此处下载 Justify 插件](http://ckeditor.com/addon/justify)
2.  将其粘贴到 ckeditor/plugins/
3.  将插件添加到您的 ckeditor。

这是javascript代码：

```
$(function() {
    CKEDITOR.config.extraPlugins = 'justify';
}); 
```

你不用多做，Justify插件会自动添加到`paragraph`toolbarGroup

**编辑**

By `alignment`，我以为你在谈论`right|center|left`对齐。

在这里，对于 h 标签，我们有这些组：

```
if ( element.is( 'h1', 'h2', 'h3' ) || element.getAttribute( 'id' ) == 'taglist' ) {
    editor.on( 'configLoaded', function() {
       editor.config.removePlugins = 'colorbutton,find,flash,font,' +
          'forms,iframe,image,newpage,removeformat,scayt,' +
          'smiley,specialchar,stylescombo,templates,wsc';
       editor.config.toolbarGroups = [
          { name: 'editing', groups: [ 'basicstyles', 'links' ] },
          { name: 'undo' },
          { name: 'clipboard', groups: [ 'selection', 'clipboard' ] },
          { name: 'about' }
       ];
    });
} 
```

`['basicstyles', 'links', 'undo', 'selection', 'clipboard', 'about']`，没有`align`组，只需添加它。

安装新的 CKEditor 后您无需修改​​任何内容，该组已经在 inline 基本配置中

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-12T14:47:10.370

`h2`在可编辑项上启用对齐按钮是不可能的。CKEditor 无法修改可编辑容器，因为从编辑器获取的数据中根本看不到该更改，因为`editor.getData()`返回`innerHTML`not `outerHTML`。

我也担心不存在简单的旁路。您可以`h2`使用 editable包装`div`，设置 enterMode=BR，从工具栏中删除诸如格式组合之类的按钮，但这仍然是不完整的解决方案，因为用户将能够删除它`h2`，通过粘贴一些块元素将其拆分或以某种方式将其保留并写在外面它。这个问题可能会得到解决，但我想你不想再花一个月了:)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-03T11:13:48.597

所以，一年后我回来并以不同的方式处理它。我使用了 justify 插件，并制作了一个副本，它只适用于原始插件不适用的元素。我不得不对其进行修改以满足我的需要，但是将以下内容注释掉是一个开始（plugin.js）：

```
if ( editor.blockless )
  return; 
```

我不知道这有多有趣，但如果有人需要它，请发表评论，我会发布整个源代码。它基本上将 text-align css 添加到编辑器元素，而不是内部块元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-11T08:35:25.680

确保您使用的是完整的 CKEditor 版本

# ruby - 混合模块中的 self.class.name

> ID：14782155
> 
> 赞同：5
> 
> 时间：2013-02-08T22:10:14.757
> 
> 标签：ruby

我有一个带有写入日志的方法的模块。在每条消息中，我想输入记录此消息的类的名称。

该模块可以混合使用`include`或`extend`。我需要我的日志在每种情况下都有正确的类名。

蒸馏代码：

```
module M
  def f
    self.class.name
  end
end

class C
  extend M
  include M
end

p C.f # => "Class"
p C.new.f # => "C" 
```

如您所见，第一个调用错误地打印`"Class"`. 我也希望如此`"C"`。

如何做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T22:40:36.130

无需求助于钩子，只需在 / 时改变你`self`的`Class`行为`Module`：

```
module M
  def f
    self.is_a?(Module) ? name : self.class.name
  end
end

class C
  extend M
  include M
end

C.f     #=> "C"
C.new.f #=> "C" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-08T22:18:27.790

可以这样，不知道有没有更好的方法。

```
module M
  def self.included(base)
    base.extend ClassMethods
  end

  def f
    self.class.name
  end

  module ClassMethods
    def f
      self.name
    end
  end
end

class C
  include M
end 
```

# android - 将 shell 脚本复制到 android out 文件夹并在启动期间执行它

> ID：14782156
> 
> 赞同：0
> 
> 时间：2013-02-08T22:10:19.853
> 
> 标签：android, android-emulator, boot, android-build, rootfs

我有一个 shell 脚本，我需要在 Android 构建过程中将其复制到 out 文件夹中的任何位置，以便它出现在 Android RootFS 中的某个位置。现在，一旦它在 Android 构建过程之后被复制并成为 Android RootFS 的一部分，我想在启动时执行 shell 脚本。

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T22:54:26.830

好吧，我在 AOSP 或任何地方创建了一个根文件夹，然后创建了 Android.mk 并将要复制的脚本复制到 out 文件夹。在 Android.mk 中添加了以下注释

```
$(shell cp -rf $(LOCAL_PATH)/myscript.sh `pwd`/$(TARGET_OUT)/path/to/folder/) 
```

现在为了让它在 Android 启动期间运行，我在 init.goldfish.rc 的最后添加了以下代码：

```
service myscript_start /system/bin/busybox ash /system/path/to/folder/myscript.sh
    class main
    oneshot 
```

另外，我在 init.goldfish.rc 的 # start essential services 部分下添加了以下行

```
start myscript_start 
```

这样，我的脚本就被复制到了 out 文件夹的所需位置，并且在 android 启动时也被调用了。

我想知道是否有更好的方法来做到这一点。我想知道是否有人有建议。

# javascript - 仅突出显示搜索中的第一个字符串

> ID：14782157
> 
> 赞同：-1
> 
> 时间：2013-02-08T22:10:27.013
> 
> 标签：javascript, replace

我是 JavaScript 新手。我的 javascript 代码有问题。我正在尝试使用字符串替换方法来突出显示搜索到的文本。但是我的函数只突出显示它找到的第一个字符串，而不突出显示另一个字符串！如何修复它以查找我在 search 中键入的所有字符串。这是我的代码：

```
<html>
<head>
    <script language="javascript">
    function search()
    {
        var s = document.getElementById("p1").innerHTML
        document.getElementById("p1").innerHTML = s.replace(document.getElementById('txt').value , '<span style="color:red">'+document.getElementById("txt").value+'</span>')
    }
    </script>
</head>
<body>
    <input type="text" id="txt" value="search..." onfocus="value=''" />
    <input type="button" id="btn" value="search" onclick="search()"/>
    <p id="p1">
        Type any word from this paragraph in the box above, then click the "Search" button to highlight it red      
    </p>

</body> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T22:14:12.957

带有`g` *全局*标志的[正则表达式将有所帮助：](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Regular_Expressions)

```
function search() {
    var p1 = document.getElementById("p1"),
        value = document.getElementById("txt").value,
        regex = new RegExp("\\b" + value + "\\b", "gi"),
        rwith = '<span style="color: red;">$&</span>';

    p1.innerHTML = p1.innerHTML.replace(regex, rwith);
} 
```

**演示：http:** [//jsfiddle.net/guC4j/](http://jsfiddle.net/guC4j/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T22:14:33.880

一种选择是使用`split`，`join`就像这样：

```
document.getElementById("p1").innerHTML = s.split(document.getElementById('txt').value).join('<span style="color:red">'+document.getElementById("txt").value+'</span>'); 
```

这是一个可以玩的[jsFiddle 。](http://jsfiddle.net/Ct4WU/)

# c# - 如何在 WPF 画布上绘制矩形

> ID：14782158
> 
> 赞同：17
> 
> 时间：2013-02-08T22:10:32.627
> 
> 标签：c#, wpf, canvas

我试图在 a`Rectangle`上绘制`Canvas`如下：

```
System.Windows.Shapes.Rectangle rect;
rect = new System.Windows.Shapes.Rectangle();
rect.Stroke = new SolidColorBrush(Colors.Black);
rect.Fill = new SolidColorBrush(Colors.Black);
rect.Width=200;
rect.Height=200;
Canvas.SetLeft(rect,0);
Canvas.SetTop(rect,0);
front_canvas.Children.Add(rect); 
```

为什么这段代码不画一个矩形？

画布在关联的 XAML 中定义如下：

```
<Canvas Height="200" Width="200" Name="front_canvas" Grid.Row="1" Grid.Column="0">      
</Canvas> 
```

画布显示良好。我可以说是因为它在布局网格中留下的间隙。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-08T22:13:07.573

`front_canvas`如果显示正确，这应该将您的矩形绘制为 200x200 黑色正方形。

> 为什么这段代码不画一个矩形？

这不会绘制的主要原因是：

*   `front_canvas`不可见
*   `front_canvas`不在可视化树中并正确显示
*   其他一些`FrameworkElement`是模糊`front_canvas`的，至少是左上角。
*   画布中有另一个更高 z 顺序的对象。

[`StrokeThickness`](http://msdn.microsoft.com/en-us/library/system.windows.shapes.shape.strokethickness%28v=vs.95%29.aspx)请注意，如果您想查看`Stroke`您指定的内容，您通常还需要设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-11T12:54:57.747

要查看矩形，您必须指定`StrokeThickness`并设置任何`Integer`大于零的值：

```
rect.StrokeThickness=2; 
```

# debugging - 使用 Immunity Debugger 反汇编函数

> ID：14782161
> 
> 赞同：2
> 
> 时间：2013-02-08T22:10:49.770
> 
> 标签：debugging, disassembly, ollydbg

我希望我以正确的方式提出这个问题，但我才刚刚开始尝试学习漏洞利用开发。我已经学习了几个教程，并开始在 Linux 中使用 gdb，我对此感到有些自在。我现在开始在 Windows 上使用 Immunity Debugger，并且有一个关于如何在 gui 中查看函数的问题。

在 gdb 中，我可以使用以下命令：

```
info functions
disas main 
```

并且能够看到主要功能。为简单起见，我的编译代码未剥离。

如何在 Immunity 或 OllyDbg 中重新创建它？我想查看函数列表，以便我可以检查它们或在它们上设置断点。我好像想不通！

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T23:50:26.850

这可以在 ImmunityDebugger 中以编程方式实现：

```
module = imm.getModule('calc.exe')
if not module.isAnalysed():
    module.Analyse()
functions = imm.getAllFunctions(module.getBase())
# functions is a list of function addresses in calc.exe 
```

还有另一个功能：

```
imm.searchFunctionByName('name_to_search') 
```

但根据我的经验，这不是很可靠。IDA Pro 是实现这一目标的更好方法。它的反汇编引擎优于 Ollydbg。您可以从 IDA 获得函数offets，然后在 Ollydbg 中找到它们。

最后，如果您正在进行漏洞利用开发，我会推荐 WinDbg。学习它需要时间，但它比 Ollydbg（例如内核调试）更强大、功能更丰富。

# java - HashMap：使用公共键添加值并打印出来

> ID：14782163
> 
> 赞同：4
> 
> 时间：2013-02-08T22:10:54.487
> 
> 标签：java, algorithm, data-structures

我有一个文件，它在表单`key/value`对中具有字符串，例如人员和计数，例如

```
"Reggy, 15"
"Jenny, 20"
"Reggy, 4"
"Jenny, 5" 
```

在输出中，我应该根据键总结所有计数值，因此对于我们的示例输出将是

“雷吉，19 岁” “珍妮，25 岁​​”

这是我的方法：

1.  读取每一行，并使用扫描仪为每一行获取密钥和计数并`,`作为分隔符
2.  现在看看 key 之前是否已经存在，如果没有，则将 currentValues 添加到 previousValues，然后将 currentValue 作为 HashMap 的值。

示例实现：

```
public static void main(final String[] argv) {
    final File file = new File("C:\\Users\\rachel\\Desktop\\keyCount.txt");

    try {
        final Scanner scanner = new Scanner(file);

        while (scanner.hasNextLine()) {
            if (scanner.hasNext(".*,")) {
                String key;
                final String value;

                key = scanner.next(".*,").trim();

                if (!(scanner.hasNext())) {
                    // pick a better exception to throw
                    throw new Error("Missing value for key: " + key);
                }

                key = key.substring(0, key.length() - 1);
                value = scanner.next();

                System.out.println("key = " + key + " value = " + value);
            }
        }
    } catch (final FileNotFoundException ex) {
        ex.printStackTrace();
    }
} 
```

我不清楚的部分是如何划分键/值对，同时读取它们并基于它创建 HashMap。

还是建议的方法是最佳方法，还是有办法进一步提高性能。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-08T22:17:21.433

由于这几乎可以肯定是一个学习练习，我将远离编写代码，让您享受所有乐趣。

创建一个`HashMap<String,Integer>`. 每次看到键/值对时，检查哈希映射是否具有键的值（使用'containsKey(key)'）。如果是，则使用 获取该旧值`get(key)`，添加新值，然后使用 将结果存储回来`put(key, newValue)`。如果密钥还没有，添加一个新的 - 再次，使用`put`. `int`如果`String value`（用于此），请不要忘记做出`Integer.valueOf(value)`判断。

就优化而言，此时的任何优化都为时过早：它甚至不起作用！但是，很难获得比您拥有的单个循环更快的速度，这也相当简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T22:18:02.253

对于阅读，我个人会使用：

`Scanner.nextLine()`, `String.split(",")`, 和`Integer.valueOf(value)`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-08T22:19:19.447

试试这个：

```
Map<String, Long> map = new HashMap<String, Long>();

while (scanner.hasNextLine()) {
        if (scanner.hasNext(".*,")) {
            ....
            if(map.containsKey(key))
                map.put(key, map.get(key) + Long.valueOf(value));
            else
                map.put(key, Long.valueOf(value));
        }
    } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-08T22:43:06.733

我可以考虑拆分值的最简单方法：

```
 BufferedReader reader =  new BufferedReader(new FileReader(file));
    Map<String, Integer> mapping = new HashMap<String,Integer>();

    String currentLine;
    while ((currentLine = reader.readLine()) != null) {

        String[] pair  = currentLine.split(",");

         if(pair.length != 2){ //could be less strict
            throw new DataFormatException();
         }

         key = pair[0];
         value = Integer.parseInt(pair[1]);
         if(map.contains(key)){
             value +=  map.get(key);
         }
         map.put(key,value);
    } 
```

就性能而言，这很可能不是最有效的方法，但非常简单。`Scanner`通常用于解析，但这里的解析看起来并不复杂，只是字符串的拆分。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-20T22:00:12.617

**一种较晚但干净的解决方案，时间复杂度为 O(n)。该解决方案绕过了某种数组**

```
 public class Solution {

    public static void main(String[] args) {
    // Anagram
            String str1 = "School master";
            String str2 = "The classroom";

            char strChar1[] = str1.replaceAll("[\\s]", "").toLowerCase().toCharArray();
            char strChar2[] = str2.replaceAll("[\\s]", "").toLowerCase().toCharArray();

            HashMap<Character, Integer> map = new HashMap<Character, Integer>();

            for (char c : strChar1) {
                if(map.containsKey(c)){
                    int value=map.get(c)+1;
                    map.put(c, value);
                 }else{
                     map.put(c, 1);
                 }

            }

            for (char c : strChar2) {
                if(map.containsKey(c)){
                    int value=map.get(c)-1;
                    map.put(c, value);
                 }else{
                     map.put(c, 1); 
                 }
            }

            for (char c : map.keySet()) {
                if (map.get(c) != 0) {
                    System.out.println("Not anagram");
                }
            }
                    System.out.println("Is anagram");
        }
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-12T05:11:31.863

```
public Map<String, Integer> mergeMaps(@NonNull final Map<String, Integer> mapOne,
                                          @NonNull final Map<String, Integer> mapTwo) {
        return Stream.of(mapOne.entrySet(), mapTwo.entrySet())
                .flatMap(Collection::stream)
                .collect(Collectors.toMap(Map.Entry::getKey, Map.Entry::getValue, Integer::sum));
    } 
```

# mysql - 页面停止响应 ruby on rails 和 mysql

> ID：14782170
> 
> 赞同：1
> 
> 时间：2013-02-08T22:11:33.770
> 
> 标签：mysql, ruby-on-rails, performance, thin

我正在使用瘦服务器 + Ruby on Rails + Mysql，并且我有几个 cronjobs 每小时对数据库进行大量处理（脚本大约需要 1-2 分钟才能完成）。

当 cronjobs 运行时，网站停止加载，并且仅在 cronjob 完成后响应。

所以我的问题是，我怎样才能使一切独立、异步或并行，以便在 cronjobs 运行时网站正常加载。

非常感谢任何指向指南或一般建议的链接。

更新：

很抱歉我无法分享 cronjob 的代码，但基本上它会执行数千个请求，例如：

```
SELECT 1 AS one FROM `table` WHERE `table`.`type_id` = BINARY '1251625345_4146645145056' LIMIT 1 
```

然后如果前一个返回 null 则几千个插入（这意味着该条目不存在）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T15:21:26.123

您的 cron 工作是否要求 Rails 应用程序执行这些选择/插入？

如果是这样，

Thin 是一个单线程的 Web 服务器。它不能同时处理多个请求。您的 cronjob 应该启动另一个 Ruby 进程（例如 Rake 任务）来完成这项工作。

# iphone - 数字内容被剥离/隐藏在平板电脑/移动设备上

> ID：14782173
> 
> 赞同：2
> 
> 时间：2013-02-08T22:11:40.410
> 
> 标签：iphone, html, css, responsive-design, media-queries

我在[这个网站](http://www.ayrshirebakerybox.co.uk)上有一个问题，在 iPad 3 和 iPhone 4 上，我发现当元素只包含一个数值时，手机号码正在被删除/隐藏。当我在值前加上“mob-”时，它可以工作。

```
<span class="r" style="width: 100%">mob-0123456789</span> 
```

因此，当我在下面这样显示时，它不会显示：

```
<span class="r" style="width: 100%">0123456789</span> 
```

我已经浏览了我的`@media`查询，但我找不到任何阻止它显示的地方。该网站是响应式的，因此有许多`@media`针对不同屏幕尺寸的查询。它在 iPhone 上的显示与在 iPad 上的显示不同，但隐藏的数字内容在两者上是相同的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T17:33:05.700

参考[如何在 iPhone/iOS 上删除电话号码的蓝色样式？](https://stackoverflow.com/questions/3736807/remove-styling-of-telephone-numbers)

如果您将以下内容添加到元标记，这应该可以解决问题。

```
<meta name="format-detection" content="telephone=no"> 
```

# mysql - 根据两列中的日期范围重复行

> ID：14782174
> 
> 赞同：3
> 
> 时间：2013-02-08T22:11:40.967
> 
> 标签：mysql, date, range, rows, repeat

我有一个包含以下列的表格：

```
ID startdate enddate 
```

我希望该表的行重复与 startdate 和 enddate 之间的差异一样多的次数，以及一个列，该列为表中的每个 id 提供这两天之间的所有日期。所以，我的新表应该是这样的：

```
ID Date

A startdate
A startdate +1 day
A startdate +2 days (till enddate)
B startdate
B startdate + 1 day .... 
```

请注意，对于不同的 ID，我有不同的开始日期和结束日期。

我尝试了以下问题的答案，但这不起作用：

[Mysql根据一行相关的日期范围选择多行](https://stackoverflow.com/questions/11578745/mysql-select-multiple-rows-based-on-one-row-related-date-range)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T22:56:03.433

这是一种方法。

这使用内联视图（别名为`i`生成从 0 到 999 的整数值，并且连接到您的表以生成最多 1000 个日期值，从 startdate 开始到每行的 enddate。

内联视图`i`可以很容易地扩展到生成 10,000 或 100,000 行，遵循相同的模式。

这假定`startdate`和`enddate`列是 datatype `DATE`。（或`DATETIME`或`TIMESTAMP`或可以隐式转换为有效值的数据类型`DATE`。

```
SELECT t.id
     , t.startdate + INTERVAL i.i DAY AS `Date`
  FROM ( SELECT d3.n*100 + d2.n*10 + d1.n AS i
           FROM ( SELECT 0 AS n 
                   UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3
                   UNION ALL SELECT 4 UNION ALL SELECT 5 UNION ALL SELECT 6
                   UNION ALL SELECT 7 UNION ALL SELECT 8 UNION ALL SELECT 9
                ) d1
          CROSS
           JOIN ( SELECT 0 AS n 
                   UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3
                   UNION ALL SELECT 4 UNION ALL SELECT 5 UNION ALL SELECT 6
                   UNION ALL SELECT 7 UNION ALL SELECT 8 UNION ALL SELECT 9
                ) d2
          CROSS
           JOIN ( SELECT 0 AS n 
                   UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3
                   UNION ALL SELECT 4 UNION ALL SELECT 5 UNION ALL SELECT 6
                   UNION ALL SELECT 7 UNION ALL SELECT 8 UNION ALL SELECT 9
                ) d3
       ) i
  JOIN mytable t
    ON i.i <= DATEDIFF(t.enddate,t.startdate) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T22:31:25.847

您需要一个数字表...创建一个包含数字 1 到 X 的临时表或虚拟表（X 是两个日期之间的最大可能差异）

然后使用日期差异加入该表

恐怕我是 SQL Server，所以不确定 datediff 函数在 mysql 中是否以相同的方式工作，但你应该明白这一点。

```
SELECT
    DateTable.Id,
    DATEADD(dd, NumbersTable.Number, DateTable.StartDate)
FROM
    DateTable
INNER JOIN
    NumbersTable
ON
    DATEADD(dd, NumbersTable.Number, DateTable.StartDate) <= DateTable.EndDate
ORDER BY
    DateTable.Id,
    DATEADD(dd, NumbersTable.Number, DateTable.StartDate) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-05-24T09:32:44.133

我知道回答很晚了，但使用递归 cte 还有一个答案

```
with  recursive cte ( id, startdate) as
(
select id,startdate  from test t1
union all
select t2.id,(c.startdate + interval '1 day')::date
from test t2
 join cte c on c.id=t2.id and (c.startdate + interval '1 day')::date<=t2.enddate
)
select id,startdate as date from cte
order by id, startdate 
```

它是 PostgreSQL 特有的，但它应该可以在其他关系数据库中工作，而 Date 函数的变化很小。

# vb.net - 在 VB.Net exe 中创建一个可从另一个程序调用的子例程

> ID：14782175
> 
> 赞同：1
> 
> 时间：2013-02-08T22:11:43.037
> 
> 标签：vb.net

是否可以在 VB.Net exe 中创建一个可从另一个程序（不是 VB.Net）调用的子例程？我知道您可以使用程序集（dll）来执行此操作，但是您也可以在 exe 中执行此操作吗？

[编辑]这个 VB.Net exe 在调用时已经运行。

[Edit2] VB.Net程序，这些编译成BA_SyncNet.exe - Form1.vb

```
Public Class Form1
    ...
    Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        ...
    End Sub
End Class 
```

VB.Net 程序 - Helloworld.vb

```
Namespace MapInfoBA.MiProBA.SamplesBA
    Public Class HelloWorld

        Public Shared Sub SayHello(ByVal s As String)
            System.Windows.Forms.MessageBox.Show("Hello, " + s)
        End Sub

    End Class
End Namespace 
```

调用程序 ba.mbx 使用：

```
Declare Method SayHello Class "MapInfoBA.MiProBA.SamplesBA.HelloWorld"  Lib "BA_SyncNet.exe" (ByVal strName As String)

Sub Main()
    Call SayHello("World")
End Sub 
```

亲切的问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T22:16:44.313

> 我知道你可以用一个程序集来做到这一点

**.exe 是一种程序集**。所以，是的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T03:07:10.153

使用 MapBasic 程序创建一个文件（比如说，DoThisVBNet.txt）。

然后您的 vb.net 程序会不时检查该文件。vb.net 程序将根据 DoThisVBNet.txt 文件执行一项任务（在您的情况下，调用一个子例程）。

但是，访问该文件时可能会出现问题，因为有两个程序正在使用它，要解决此问题，请使用注册表而不是文件。

# c++ - 基本 C++ 类型何时具有未知的初始值？

> ID：14782176
> 
> 赞同：4
> 
> 时间：2013-02-08T22:11:44.917
> 
> 标签：c++, initialization, standards, built-in-types

一个基本的 C++ 类型，比如`int`or `float`，什么时候会有一个未知的初始值？

如果有的话，内存分配的类型如何影响？宣言呢？如果它是`class`/ `struct`/的成员`union`怎么办？C++11 与 C++03 或 C++98 有什么不同？

我有我的怀疑，但不知道我的知识是否完整（或正确，就此而言）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-08T22:17:41.037

任何[POD](http://en.wikipedia.org/wiki/Plain_old_data_structure)数据（包括所有基本类型）在以下情况下都将具有未知值：

*   它没有[静态内存分配](http://en.wikipedia.org/wiki/Static_memory_allocation)（而是在堆栈上或 with 创建`new`）
*   它未初始化，包括空初始化和/或构造函数初始化列表

在调用之前，所有类型的全局/静态变量都设置为零作为启动过程的一部分`main`。`main` [对于在1](http://en.wikipedia.org/wiki/Plain_old_data_structure)之前具有构造函数的类型，调用构造函数。

任何未在构造函数中初始化的东西也是未知的。

**编辑：**澄清一下，`std::string`是“构造函数没有初始化一切”的一个很好的例子——如果你有一个本地的`std::string str;`，那么`str`将有一个定义的“空字符串”内容，但是实际缓冲区的内容，或者实际上缓冲区指向的内容可能根本不要设置为任何有意义的东西——因为一旦我们开始使用字符串来存储东西，实现可能会根据长度[或其他方式]确定是否有可用的缓冲区]。

**Edit2：**正如评论所解释的，您还可以有“混合”情况，其中结构的一部分正在被初始化，例如`struct`，包含一些“纯数据”元素和一些具有构造函数的元素。具有构造函数的那些将调用其构造函数。纯数据不会被初始化。

[1](http://en.wikipedia.org/wiki/Plain_old_data_structure)运行构造函数的代码很可能是“main”函数的一部分或从“main”函数内部调用 - 但如果是这种情况，它将是“在 main 中的任何代码启动之前”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T22:40:27.847

来自“C++ 工作草案，2012-11-02”

> **3.6.2 非局部变量的初始化 [basic.start.init]**
> 2 具有静态存储持续时间 (3.7.1) 或线程存储持续时间 (3.7.2) 的变量应在任何其他初始化发生之前进行零初始化 (8.5) .

具有静态存储的变量*至少*初始化为零。

> **3.7.3 自动存储持续时间 [basic.stc.auto]**
> 2 [ 注意：这些变量按照 6.7 中的描述进行初始化和销毁​​。——尾注]

6.7 没有说明*如何*初始化自动变量。

> **3.7.4 动态存储持续时间 [basic.stc.dynamic]**
> ...
> **3.7.4.1 分配函数 [basic.stc.dynamic.allocation]**
> ... 从分配函数返回时分配的存储内容没有限制. 由连续调用分配函数分配的存储的顺序、连续性和**初始值****是未指定的**。
> 
> **8.5 Initializers [dcl.init]**
> 7 对 T 类型的对象进行默认初始化意味着：
> — 如果 T 是（可能是 cv 限定的）类类型（第 9 条），则调用 T 的默认构造函数（并且初始化错误- 如果 T 没有可访问的默认构造函数，则形成）；
> — 如果 T 是数组类型，则每个元素都是默认初始化的；
> — 否则，不执行初始化。

如果您提供显式初始化程序，则任何变量都将具有已知值。

如果您不为 POD 类型提供显式初始化程序，则它取决于存储类。静态或线程变量将被初始化为零，而自动或动态分配的变量则不会。

如果您有复合类型，则适用相同的规则。如果您没有显式初始化程序，通过（默认）构造函数或其他方式，基本类型的初始值取决于存储类。

最后，通过分配的内存将`malloc`未初始化，而`calloc`内存将被零初始化。

# x86 - x86 上跨页面边界的软件预取

> ID：14782182
> 
> 赞同：6
> 
> 时间：2013-02-08T22:12:15.230
> 
> 标签：x86, tlb, prefetch, nehalem

我的理解是硬件预取永远不会跨越页面边界。我想知道软件预取是否具有相同的限制，即我可以使用软件预取来避免未来的 TLB 未命中。通过四处搜索，这似乎是可能的，但我在文档中找不到任何确定的东西，所以参考会很好。

我对 Nehalem、Sandy Bridge 和 Westmere 特别感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T00:56:34.327

根据英特尔的[优化参考手册](http://www.intel.com/Assets/en_US/PDF/manual/248966.pdf)，它取决于处理器。从第 7.4.3 节开始：

> 在某些情况下，PREFETCH 不会执行数据预取。这些包括：
> 
> *   PREFETCH 导致 DTLB（数据转换后备缓冲区）未命中。这适用于具有对应于系列 15、型号 0、1 或 2 的 CPUID 签名的 Pentium 4 处理器。PREFETCH 解决 DTLB 未命中并在具有对应于系列 15、型号 3 的 CPUID 签名的 Pentium 4 处理器上获取数据。
> *   对导致故障/异常的指定地址的访问。

软件预取可能会也可能不会避免 TLB 未命中，具体取决于处理器。如果它会导致页面错误，它将不会获取数据。

如果要确保避免 TLB 未命中，可以执行虚拟读取来加载数据，而不是预取指令。这可能会导致页面错误交换页面，根据您的用例，这可能是好是坏。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-09-01T10:36:35.290

在现代处理器（Nehalem、Sandy Bridge 和 Westmere）中，软件预取确实会触发 TLB 查找。

来自英特尔优化指南：（第 7.3.3 节）

> 在较旧的微架构中，会丢弃导致数据转换后备缓冲区 (DTLB) 未命中的 PREFETCH。在基于 Nehalem、Westmere、Sandy Bridge 和更新的微架构、Intel Core 2 处理器和 Intel Atom 处理器的处理器中，可以跨页边界获取导致 DTLB 未命中的 PREFETCH。

# sql-server - 如何指定需要 SQL 强制转换的 EF 关系？

> ID：14782183
> 
> 赞同：1
> 
> 时间：2013-02-08T22:12:17.780
> 
> 标签：sql-server, entity-framework

我有两个旧版 SQL 表：

```
Contact
  Id(uniqueidentifier, not null)

Foo
  GlobalId(nvarchar(50, null)
  EntityName(nvarchar(100, null) 
```

Foo.GlobalId 列存储数据库中其他表的 ID，因此要获取相关数据，我们将像这样连接表：

```
select * from Foo
  inner join Contact on Foo.EnitityName = 'contact'
    and cast(Foo.Globalid as unqiqueidentifier) = Contact.Id 
```

如何使用 FluentAPI 表达这种关系或将 nvarchar 转换为 uniqueidentifier（反之亦然），否则，如何使用 LINQ 执行 SQL cast()？

```
public class Contact
{
  public Guid Id {get;set;}
  public virtual ICollection<Foo> Foos {get;set;}
}

public class ContactMap : EntityTypeConfiguration<Contact>
{
  HasKey(t => t.Id);
  HasMany(c => c.Foos)
    .WithOptional(foo => foo.Contact)
    /* ??? */;
}

public class Foo
{
  public string GlobalId {get;set;}
  public Contact Contact {get;set}
}

public class FooMap : EntityTypeConfiguration<Foo>
{
  Property(t => t.PsmsGlobalId).HasMaxLength(50);
  Property(t => t.PsmsEntityName).HasMaxLength(100);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T14:56:09.330

Entity Framework 当前不支持 SQL 类型转换。创建一个执行转换的 SQL 视图对我来说效果很好。

# java - 如何在不向用户显示堆栈跟踪的情况下处理 servlet 过滤器中的错误状态？

> ID：14782184
> 
> 赞同：7
> 
> 时间：2013-02-08T22:12:17.780
> 
> 标签：java, jetty, servlet-filters, resteasy

我正在开发一个 Jetty/RESTEasy 应用程序。如果我从我的 REST 端点之一抛出一个`WebApplicationException(myResponse)`，它会将给定的响应发送到客户端。

当过滤器检测到错误时，我想要相同的行为：

1.  它应该停止执行，并且
2.  它应该给用户一个明确的、JSON 格式的错误，不包括堆栈跟踪。

显然，只需写入响应流并在方法`return`内进行 ing 工作。`doFilter`但这不适用于 . 调用的其他方法`doFilter`。

抛出任何异常都会满足条件＃1，但我还没有找到满足条件＃2的理智方法。（你可以在底部看到我的最佳尝试。）

正如 Perception 在他的回答中解释的那样，`WebApplicationException`s 在过滤器的上下文中被视为任何其他异常，因此给用户一个漂亮丑陋的堆栈跟踪。

所以，总结一下我的问题：

*   servltt 容器是否有任何等价物`throw new WebApplicationException(Response)`？
*   也许更重要的是，其他 java 项目如何处理这个问题？

我在一个过滤器中有此代码并且它可以工作，但我更喜欢自动应用于所有过滤器的更优雅的解决方案：

```
public void doFilter(final ServletRequest   request, final ServletResponse response, final FilterChain chain) throws IOException, ServletException {
    try {
        doFilterOrThrow(request, response, chain);
    } catch (WebApplicationException e) {
        Response res = e.getResponse();
        ((HttpServletResponse) response).sendError(res.getStatus(), (String) res.getEntity());
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-05-13T17:12:19.077

您提到的 Web 应用程序异常的特定处理仅在 JAX-RS 容器的上下文中定义，顺便说一下，它***与***Servlet 容器不同。

Web 过滤器由 Servlet 容器处理，它不知道也不关心 JAX-RS 容器是否存在于同一应用程序服务器中。它也不知道也不关心 Web 应用程序异常。因此，当您从过滤器中抛出 WAE 时，它的处理方式与任何其他异常相同（带有堆栈跟踪的服务器错误，或者如果您在 Web 应用程序中设置了一个预配置的错误页面）。

在我看来，如果您向客户端指示错误，您可以简单地从过滤器中执行此操作，直接写入响应流。但是，如果您尝试利用一些现有的 JAX-RS 逻辑，那么（RESTEasy 特定）解决方案将在您的过滤器中将请求标记为错误，然后使用提供程序类在 JAX-RS 中生成 WAE。例子：

```
@WebFilter(urlPatterns = "*")
public class ForwardingFilter implements Filter {

    @Override
    public void destroy() {
        return;
    }

    @Override
    public void doFilter(final ServletRequest request,
            final ServletResponse response, final FilterChain chain)
            throws IOException, ServletException {
        // Add an error response to be processed by the JAX-RS container.
        // This would obviously be based on some condition.
        request.setAttribute("errorResponse",
                Response.status(500).entity("Didn't work out!").build());
        chain.doFilter(request, response);
    }

    @Override
    public void init(FilterConfig arg0) throws ServletException {
        return;
    }
}

@Provider
@ServerInterceptor
@HeaderDecoratorPrecedence
@RequestScoped
public class ForwardingHandlerProvider implements PreProcessInterceptor {

    @Override
    public ServerResponse preProcess(final HttpRequest request,
            final ResourceMethod method) throws Failure,
            WebApplicationException {
        final Response errorResponse = (Response) request
                .getAttribute("errorResponse");
        if (errorResponse != null)
            throw new WebApplicationException(errorResponse);
        return null;
    }
} 
```

由于提供者存在于 JAX-RS 领域，因此根据 JAX-RS 规范第 3.3.4 节的规则处理 Web 应用程序异常，并在客户端获得所需的响应。

*** 编辑：***

底线是，没有标准的 Java EE 规定的方式（当前）以类似于 JAX-RS 中可用的方式以集中方式处理 servlet 异常。由于您使用的是 JBoss/RestEASY，因此您可以使用 JBoss [Seam Catch](http://docs.jboss.org/seam/3/3.1.0.Final/reference/en-US/html/pt01.html)库来非常接近。

```
@HandlesExceptions
public class ExceptionHandler {
    public void handleServletException(
            final @Handles @WebRequest CaughtException<ServletException> caught,
            @Context final HttpServletResponse response) {
        try {
            response.sendError(500, "An error occured");
        } catch (final IOException ioe) {
            System.err.println("Dumb IO Exception: " + ioe);
        }
    }
} 
```

上面说明了一个异常处理程序，如[Seam Catch 文档](http://docs.jboss.org/seam/3/solder/latest/reference/en-US/html/exception-handling.html)中所述。请注意，该库现在正在大量变化，因此您只能将其用作最后的手段。

# asp.net - 如何在 asp.net ChartImageHandler 上设置缓存控制：ChartImg.axd

> ID：14782185
> 
> 赞同：1
> 
> 时间：2013-02-08T22:12:25.287
> 
> 标签：asp.net, datavisualization.toolkit

我正在 azure 上设置 web 服务，我需要将 ASP.NET 图表控件生成的图像缓存到客户端，以便在按下后退按钮或单击刷新按钮时，图像将从缓存中加载而不是从网络服务器重新加载。

我作为“缓存控制”响应变得私密。如何更新 http 响应设置以使其缓存？

这是我在 web.config 文件中的设置和 firebug 中图像的屏幕截图。谢谢！

```
 <appSettings>
    <add key="ChartImageHandler" value="Storage=file;Timeout=60;Url=~/tempImages/;webDevServerUseConfigSettings=true; deleteAfterServicing=false;"  />
  </appSettings>

    <httpHandlers>
      <add verb="GET" path="ChartImg.axd" type="System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" validate="true" />
    </httpHandlers>   

  <system.webServer>
    <handlers>
      <add name="ChartImageHandler" verb="*" preCondition="integratedMode" path="ChartImg.axd" type="System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
    </handlers>
  </system.webServer> 
```

[http://i.imgur.com/UWa6AY5.png](http://i.imgur.com/UWa6AY5.png)

[http://i.imgur.com/pK3dzXn.png](http://i.imgur.com/pK3dzXn.png)

# cassandra - 卡桑德拉性能

> ID：14782188
> 
> 赞同：4
> 
> 时间：2013-02-08T22:12:45.157
> 
> 标签：cassandra, phpcassa

我已经阅读了所有这些关于 cassandra 有多快的文章，例如单行读取可能需要大约 5 毫秒。

到目前为止，我不太关心我的网站速度，但随着网站变得越来越大，一些页面开始需要很多查询，例如一页需要读取 5 个不同的表和大约 50 个不同的行，所以我有注意到它需要 0.7 秒到 2.0 秒，这真的很慢，所以我仔细看了一下，发现单个查询大约需要 150 毫秒。

我正在测试的表几乎是空的，所以大小不是问题。我已经安装了[**APC**](http://php.net/manual/en/book.apc.php)，但它没有帮助。

我正在使用[**PHPCassa**](https://github.com/thobbs/phpcassa)，thrift 与这个库一起提供。

这些速度正常吗，也许php不够快？我能做些什么来改善这种情况？

请注意，我知道运行这么多查询太多了，cassandra 针对写入而不是读取进行了优化，但在某些情况下，我找不到将数据放入单个表/行的方法。

**编辑**我刚刚发现了可以提高性能的可选 C 扩展，确实如此，现在单行读取需要 50 毫秒到 100 毫秒，所以这是一个重大改进，你离那 5 毫秒还很远

**EDIT2**很抱歉没有用更多信息更新我的问题，但我一直很忙，实际上我已经解决了这个问题，现在从 4 个不同的表读取 10 行只需要`0.073158 s`平均读取时间，`0.005575 s`所以它比我预期的要多达到。对于那些面临同样问题的人，这些是我建议做的事情：

*   安装可选的 C 扩展，步骤可以在[**这里找到**](https://github.com/thobbs/phpcassa/blob/master/README.mkd#using-the-c-extension)
*   安装[**APC**](http://php.net/manual/en/book.apc.php)
*   确保安装了正确的 java 版本，这可能会导致速度变慢
*   安装完所有这些东西后，不只是重新启动apache，重新启动整个服务器，一开始我没有这样做，我只是在服务器重新启动后才注意到这个主要的速度提升

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T18:56:57.280

这仍然不能解释为什么大部分为空的列族的性能比其他列族差。下次你遇到这个问题时，你应该告诉我们你是如何使用这个表的，什么样的查询给你带来了不好的表现。

只是猜测：这个列族是否包含一些经常删除的数据？因为默认情况下，实际删除已删除（墓碑）值需要 10 天的 GcGracePeriod。

因此，如果您对同一键的大量列执行大量写入、读取和删除操作，您可能会遇到一些问题。

# python - 将python列表操作为我想要的字符串类型

> ID：14782192
> 
> 赞同：1
> 
> 时间：2013-02-08T22:13:06.133
> 
> 标签：python

我有一个嵌套列表，例如：`A_board=[['0', '0'],['1', '1']]`. 我想把这个嵌套列表分开并得到一个结果，如果我调用打印结果，它会显示：`< 0 0 > < 1 1 >`

我不知道如何用循环来解决这个问题，我首先将矩阵制作成一个列表，方法是：

```
boardWidth_a=len(A_board)
listLength=len(board[0])

for q in range(0,boardWidth_a):
    for x in range(0, listLength):
        board1D.append(int(board[q][x])); 
```

有了`board1D`现在`[0, 0, 1, 1]`，我该怎么做才能`board1D`使它成为`< 0 0 > < 1 1 >?`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T22:23:03.310

似乎有点令人费解 - 你能不能只做：

```
>>> ' '.join('< {} {} >'.format(*items) for items in A_board)
'< 0 0 > < 1 1 >' 
```

对于 n 元组，调整以下内容：

```
>>> a = [ [0], [0], [0] ]
>>> fmt = '< {} >'.format
>>> from itertools import chain
>>> fmt(' '.join(map(str, chain.from_iterable(a))))
'< 0 0 0 >' 
```

# node.js - 仅使用节点二进制文件运行的 nodejs 程序

> ID：14782194
> 
> 赞同：2
> 
> 时间：2013-02-08T22:13:18.770
> 
> 标签：node.js

要运行 node.js 程序，如果我只复制节点二进制文件，那么我看到它工作正常。只是想知道如果我不安装node.js，只复制bin目录中的node二进制文件，是否有可能无法正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:32:57.673

在 linux 或 mac 上，这应该没问题。在windows上，我不知道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T22:06:18.017

对于 Windows，稳定性的最佳选择是直接在[http://nodejs.org/download/](http://nodejs.org/download/)下载二进制文件。查找 Windows 二进制文件 (.exe)。它无需安装即可运行。当然，这不包括 npm。

# ruby - Ruby Compass 在 CSS 中输出回溯

> ID：14782198
> 
> 赞同：0
> 
> 时间：2013-02-08T22:13:19.890
> 
> 标签：ruby, sass, backtrace

Compass 在 CSS 中输出回溯，而不是生成 CSS。我在 Windows 7 和 Ubuntu Linux 12.0 上得到了相同的结果，我在 Compass 0.12.2 和 0.11.1 上进行了测试，并在 Ruby 1.9.3p385 和 1.9.1P378 上进行了测试。

我的 config.rb 文件：

```
# Require any additional compass plugins here.
http_path = "/n4"
css_dir = "css"
sass_dir = "sass"
images_dir = "images"
javascripts_dir = "js"
# relative_assets = true
output_style = :compact #or :nested, :expanded, :compressed
line_comments = false    

 # Disable these for production (also when viewing in IE6; will cause unnecessary display errors)
 # sass_options = {:debug_info => true} 
```

# CSS 文件的内容：

```
/*
Syntax error: Undefined mixin 'linear-gradient'.
    on line 305 of C:/Users/bens/workspace/n4e/src/main/webapp/sass/screen.sass, in `linear-gradient'
    from line 305 of C:/Users/bens/workspace/n4e/src/main/webapp/sass/screen.sass, in `button_style'
    from line 590 of C:/Users/bens/workspace/n4e/src/main/webapp/sass/screen.sass

Backtrace:
C:/Users/bens/workspace/n4e/src/main/webapp/sass/screen.sass:305:in `linear-gradient'
C:/Users/bens/workspace/n4e/src/main/webapp/sass/screen.sass:305:in `button_style'
C:/Users/bens/workspace/n4e/src/main/webapp/sass/screen.sass:590
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/perform.rb:251:in `visit_mixin'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/base.rb:37:in `visit'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/perform.rb:98:in `visit'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/perform.rb:266:in `block (3 levels) in visit_mixin'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/perform.rb:266:in `map'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/perform.rb:266:in `block (2 levels) in visit_mixin'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/perform.rb:119:in `with_environment'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/perform.rb:266:in `block in visit_mixin'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/perform.rb:68:in `perform_arguments'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/perform.rb:261:in `visit_mixin'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/base.rb:37:in `visit'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/perform.rb:98:in `visit'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/base.rb:53:in `block in visit_children'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/base.rb:53:in `map'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/base.rb:53:in `visit_children'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/perform.rb:107:in `block in visit_children'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/perform.rb:119:in `with_environment'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/perform.rb:106:in `visit_children'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/base.rb:37:in `block in visit'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/perform.rb:318:in `visit_rule'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/base.rb:37:in `visit'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/perform.rb:98:in `visit'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/base.rb:53:in `block in visit_children'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/base.rb:53:in `map'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/base.rb:53:in `visit_children'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/perform.rb:107:in `block in visit_children'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/perform.rb:119:in `with_environment'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/perform.rb:106:in `visit_children'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/base.rb:37:in `block in visit'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/perform.rb:126:in `visit_root'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/base.rb:37:in `visit'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/perform.rb:98:in `visit'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/visitors/perform.rb:7:in `visit'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/tree/root_node.rb:20:in `render'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/engine.rb:315:in `_render'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/sass-3.2.5/lib/sass/engine.rb:262:in `render'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/compass-0.12.2/lib/compass/compiler.rb:140:in `block (2 levels) in compile'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/compass-0.12.2/lib/compass/compiler.rb:126:in `timed'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/compass-0.12.2/lib/compass/compiler.rb:139:in `block in compile'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/compass-0.12.2/lib/compass/logger.rb:45:in `red'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/compass-0.12.2/lib/compass/compiler.rb:138:in `compile'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/compass-0.12.2/lib/compass/compiler.rb:118:in `compile_if_required'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/compass-0.12.2/lib/compass/compiler.rb:103:in `block (2 levels) in run'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/compass-0.12.2/lib/compass/compiler.rb:101:in `each'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/compass-0.12.2/lib/compass/compiler.rb:101:in `block in run'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/compass-0.12.2/lib/compass/compiler.rb:126:in `timed'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/compass-0.12.2/lib/compass/compiler.rb:100:in `run'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/compass-        0.12.2/lib/compass/commands/watch_project.rb:147:in `recompile'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/fssm-0.2.10/lib/fssm/path.rb:73:in `call'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/fssm-0.2.10/lib/fssm/path.rb:73:in `run_callback'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/fssm-0.2.10/lib/fssm/path.rb:55:in `callback_action'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/fssm-0.2.10/lib/fssm/path.rb:35:in `update'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/fssm-0.2.10/lib/fssm/state/directory.rb:39:in `block in modified'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/fssm-0.2.10/lib/fssm/state/directory.rb:37:in `each'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/fssm-0.2.10/lib/fssm/state/directory.rb:37:in `modified'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/fssm-0.2.10/lib/fssm/state/directory.rb:18:in `refresh'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/fssm-0.2.10/lib/fssm/backends/polling.rb:17:in `block (2 levels) in run'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/fssm-0.2.10/lib/fssm/backends/polling.rb:17:in `each'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/fssm-0.2.10/lib/fssm/backends/polling.rb:17:in `block in run'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/fssm-0.2.10/lib/fssm/backends/polling.rb:15:in `loop'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/fssm-0.2.10/lib/fssm/backends/polling.rb:15:in `run'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/fssm-0.2.10/lib/fssm/monitor.rb:26:in `run'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/fssm-0.2.10/lib/fssm.rb:70:in `monitor'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/compass-0.12.2/lib/compass/commands/watch_project.rb:87:in `perform'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/compass-0.12.2/lib/compass/commands/base.rb:18:in `execute'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/compass-0.12.2/lib/compass/commands/project_base.rb:19:in `execute'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/compass-0.12.2/lib/compass/exec/sub_command_ui.rb:43:in `perform!'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/compass-0.12.2/lib/compass/exec/sub_command_ui.rb:15:in `run!'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/compass-0.12.2/bin/compass:30:in `block in <top (required)>'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/compass-0.12.2/bin/compass:44:in `call'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/compass-0.12.2/bin/compass:44:in `<top (required)>'
C:/Ruby193/bin/compass:23:in `load'
C:/Ruby193/bin/compass:23:in `<main>'
*/
body:before {
  white-space: pre;
  font-family: monospace;
  content: "Syntax error: Undefined mixin 'linear-gradient'.\A on line 305 of     C:/Users/bens/workspace/n4e/src/main/webapp/sass/screen.sass, in `linear-gradient'\A             from line 305 of C:/Users/bens/workspace/n4e/src/main/webapp/sass/screen.sass, in     `button_style'\A from line 590 of C:/Users/bens/workspace/n4e/src/main/webapp/sass/screen.sass"; } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T00:23:07.943

线性渐变不是 Compass 中的 mixin。它是一个旨在与`background`or `background-image`mixins 结合使用的函数。

[http://compass-style.org/reference/compass/css3/images/](http://compass-style.org/reference/compass/css3/images/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-05-06T20:16:50.237

您看到该消息是因为您的 SASS 文件中有错误。当出现错误时，SASS 将输出错误、回溯（如您所见）和在`<body>`标记前添加错误的 CSS 规则。

# php - PHP 菜单 - 从数据库加载，无法正确获取结构

> ID：14782199
> 
> 赞同：0
> 
> 时间：2013-02-08T22:13:22.937
> 
> 标签：php, drop-down-menu

我很难让这个菜单正常工作。

`function writeMenu(){ echo "<div id=\"menu\">" <ul id=\"top-link\">"; m("top", "n"); echo "</ul></div>";`（抱歉，格式不正确）

```
 function m($parent,$issub){
      $parentQ = "select * from cdi_menu";//gets menu items from menu table
      $parentResult = mysql_query($parentQ); //runs menu item query and obtains result
      while ($link = mysql_fetch_assoc($parentResult)) {//for each line in the result do the folowing:
        if($parent==$link['PARENT']){//if the next link belongs to this menu item
          echo "\n    <li><a href=\"".$link['LINK']."\">".$link['DISPLAY']."</a></li>";
          if($issub=="n" && $link['HASCHILD']=="y"){//if this menu item is a top menu item
            echo "\n  <li id=\"sub-link\"><ul>";
            m($link['ID'], $links, "y");
            echo "\n  </ul></li>";
          }
        }
      }
    }

    echo writeMenu(); 
```

我想做的是让它隐藏“子链接”ID（我会使用类，但javascript似乎不编辑类样式，只是ID）。子链接项目将在父项目上方显示。

`top`指的是顶级元素，并且`ID`指的是数据库中的唯一ID。

谢谢，如果造成混淆，抱歉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:27:45.607

您的函数只有 2 个参数，但您在内部使用 3 个参数调用它

```
m($link['ID'], $links, "y"); 
```

$links 是不必要的。

如果您将查询修改为如下所示会更好

```
$parentQ = "select * from cdi_menu WHERE parent='$parent'"; 
```

所以您不需要第一个 if 语句，并且您不会为每个菜单/子菜单多次获取所有行。

# ruby-on-rails - 为丢失的路线捕获通配符路线，在有其他路线文件时不起作用

> ID：14782200
> 
> 赞同：0
> 
> 时间：2013-02-08T22:13:24.880
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routes

我实现了一个简单的自定义错误解决方案。这个：[http ://ramblinglabs.com/blog/2012/01/rails-3-1-adding-custom-404-and-500-error-pages](http://ramblinglabs.com/blog/2012/01/rails-3-1-adding-custom-404-and-500-error-pages)

除了 routes.rb 文件中缺少的路线外，一切都运行良好。

为了在缺少路线时到达我的error_controller，我做了通配符解决方案：`match '*not_found', to: 'errors#error_404'`

但是...现在，当我尝试输入位于 /admin 下的站点的子部分时，我进入了错误页面。通配符被触发，即使管理部分的路由是在不同的路由文件中定义的，位于：config/routes/admin.rb

我能做些什么？谢谢

编辑：使用 rails 3.0.20 和 ruby​​ 1.8.7

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:11:22.073

如果您使用的是 Rails 3.2+，则为您的路线提供更简单的解决方案。首先在 'config/application.rb' 中将您的应用设置为错误处理程序

```
config.exceptions_app = self.routes 
```

现在当有一个你的应用程序会寻找你的路线来处理它。在 'config/routes.rb' 中，您可以添加如下路由：

```
match "/404", :to => "errors#not_found" 
```

可以在[这里找到更详细的解释。](https://coderwall.com/p/w3ghqq)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T15:44:06.107

好的，直到我更新到 Rails 3.2+

我只是放入`'*not_found', to: 'errors#error_404'`最后一个加载的路由文件。

这样它真的在路线的尽头，现在我所有的路线都可以工作。并且在需要时仍然会触发错误。

# r - 如何更改 data.frame 中的单个值？

> ID：14782206
> 
> 赞同：53
> 
> 时间：2013-02-08T22:13:56.527
> 
> 标签：r, dataframe, cell

谁能解释如何将 a 中的单个单元格更改`data.frame`为其他内容。基本上我只想重命名那个单元格，而不是所有匹配它的单元格。我不能使用该`edit()`命令，因为它会搞砸我的脚本，因为我`data.frame`多次使用它。

提前致谢

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-02-08T22:21:28.553

```
data.frame[row_number, column_number] = new_value 
```

例如，如果`x`是您的 data.frame：

```
x[1, 4] = 5 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2019-08-12T15:20:54.783

假设您的数据框是 df 并且您想在参与者 ID 5 中将性别从 2 更改为 1，那么您应该通过编写“==”来确定行，如您所见

```
 df["rowName", "columnName"] <- value
 df[df$serial.id==5, "gender"] <- 1 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-12-01T20:57:18.587

要使用列名更改单元格值，可以使用

```
iris$Sepal.Length[3]=999 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-01-11T11:02:22.573

在 RStudio 中，您可以直接在单元格中编写。假设您的 data.frame 被调用`myDataFrame`并且行和列被调用`columnName`and `rowName`。然后代码将如下所示：

```
myDataFrame["rowName", "columnName"] <- value 
```

希望有帮助！

# ios - 如何在 iOS 应用中使用 TabBarController 呈现 ModalViewController？

> ID：14782207
> 
> 赞同：0
> 
> 时间：2013-02-08T22:13:58.443
> 
> 标签：ios, modalviewcontroller, uiwindow

当您想在带有 TabBarController 的应用程序中将 LoginViewController 呈现为“ModalViewController”时，我正在寻找有关最佳实践方法的反馈。

情况是这样的： - 应用程序支持具有登录/注销功能的用户会话 - 当应用程序启动时，它会尝试自动登录并直接显示 TabBarController 或 LoginViewController（显示为 ModalViewController 以在登录时启用关闭动画） - 应用程序有一个带有多个选项卡的 TabBarController。- 每次显示 ViewController 时都会检查用户的状态 - 如果用户未登录 ModalViewController，则应显示具有登录功能 - 如果用户手动注销，则应显示相同的 ModalViewController

我试图想出几种不同的设计来处理这个问题，没有人觉得完全“正确”。我曾在一个项目中使用子类 UIWindow 处理此问题，该子类 UIWindow 替换了应用程序的默认 UIWindow。然后子类侦听不同的通知，例如“UserLoggedInSuccessfully”、“UserLoggedOut”等，以处理 ModalViewController 的呈现。

还有其他解决方案吗？我将不胜感激这种解决方案的任何输入和经验。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:29:12.160

这个问题有不同的解决方案，你可以尝试这些替代方案，但我会说第一个是推荐的方法，

1.  您可以将默认设置为每次打开`HomeViewController`的第一个选项卡，并单独设置，在您的 AppDelegate 中，您可以检查登录会话，如果会话无效，则显示，否则显示所有选项卡包括。`TabBarController``LoginViewController``didFinishLaunchingWithOptions``LoginViewController``ModalViewController``TabBarController`

2.  替代方法可能是将所有控制器都放在选项卡中，但是当您呈现时`LoginViewController`，在用户登录后，将所有控制器添加到 a 中`MutbaleArray`并删除当前对象，即`LoginViewController`. 用户登录后，将信息保存在钥匙串中，这样用户就不必一次又一次地登录，这样就可以避免`LoginViewController`每次用户尝试注销时都显示，然后将其添加到`LoginViewController`数组中，然后之后添加所有`TabBarController`对象`LoginViewController`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T23:04:09.280

您可以执行以下操作，当用户打开应用程序时，您必须向他显示 loginviewcontroller 作为 rootviewcontroller，然后当登录成功时，您必须将 tabbarviewcontroller 作为 rootViewcontroller。那么每次当用户运行应用程序时，您必须检查他是否有有效的会话，如果会话在您在选项卡栏上过期时，您将作为根创建一个选项卡，您必须从您的应用程序委托更改根视图控制器登录

# javascript - 循环启动更快

> ID：14782208
> 
> 赞同：-3
> 
> 时间：2013-02-08T22:14:04.967
> 
> 标签：javascript, jquery

我希望这个功能在它结束后能更快地开始。谢谢。

演示：http: [//jsfiddle.net/RuX5d/5/](http://jsfiddle.net/RuX5d/5/)

这是我目前使用的实际时间：http: [//jsfiddle.net/RuX5d/51/](http://jsfiddle.net/RuX5d/51/)

```
$(document).ready(function() {
var i = 1, dir = 1, curFx = 'fadeIn';
var interval = setInterval(function () {
    if (i == 6 && $('#slide1').is(':visible')) {
        $('#slide1').fadeOut(2000);             
        return;
    }

    $('#slide'+ i)[curFx](500);

    i = i + 1*dir;

    if (i == 10 || i == -1) {
        dir = (dir == 1)?-1:1;
        curFx = (curFx == 'fadeIn')?'fadeOut':'fadeIn';
    }        
}, 1000);
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:18:25.973

最后改一下`500`。它是脚本每次执行之间的毫秒数。这是一个演示：http: [//jsfiddle.net/RuX5d/49/](http://jsfiddle.net/RuX5d/49/)

# jquery - jQuery 完成后执行函数

> ID：14782209
> 
> 赞同：0
> 
> 时间：2013-02-08T22:14:05.593
> 
> 标签：jquery

这可能是非常基本的，但我似乎无法为我的案例找到明确的答案。

我想知道如何确保在其余工作流程可以继续之前执行并完成一个功能

在我下面的脚本中，警报触发为“1”、“3”、“2”，我希望在脚本进入 up.settings.multipart_params 之前完成getsS3policy(file)

```
preinit: {

            UploadFile: function (up, file) {
                getS3Policy(file);
                alert("3");
                    up.settings.multipart_params = {
                        key: path,
                        filename: file.name,
                        AWSAccessKeyId: 'AKIAJIRIA6XD4V5MFWCA',
                        acl: 'private',
                        policy: policy,
                        signature: signature,
                        success_action_status: '201'
                    }

            }
        },

    });
    function getS3Policy(file) {
        alert("1");
        data = { 'alc': 'private', 'bucket': 'PhotojimaDev', 'key': path, 'file': file.name };
        $.ajax({
            url: '/desktopmodules/uploader/API/upload/getPolicy',
            type: 'POST',
            data: data,
            success: function (response) {
                console.log(response);
                if (response) {
                    policy = response.policy;
                    signature = response.signature;
                    alert("2");
                }
                else {
                    return "Error";
                }
            }
        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:18:49.860

您的 ajax 调用的`success`功能是回调。如果您将您的回调放入`up.settings.multipart_params`该回调中，这就是一旦收到数据就会运行的内容，它只会在收到数据后运行。

```
$.ajax({
        url: '/desktopmodules/uploader/API/upload/getPolicy',
        type: 'POST',
        data: data,
        success: function (response) {
            console.log(response);
            if (response) {
                policy = response.policy;
                signature = response.signature;
                alert("2");
                up.settings.multipart_params = {
                    key: path,
                    filename: file.name,
                    AWSAccessKeyId: 'AKIAJIRIA6XD4V5MFWCA',
                    acl: 'private',
                    policy: policy,
                    signature: signature,
                    success_action_status: '201'
                }
            }
            else {
                return "Error";
            }
        }
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T22:15:55.790

您正在寻找 jQuery ajax 的回调。见[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

# rally - 如何将 LookbackAPI 用于燃耗图？

> ID：14782212
> 
> 赞同：4
> 
> 时间：2013-02-08T22:14:16.540
> 
> 标签：rally, lumenize

我需要一个使用 LookbackAPI 来获取燃尽图数据的好例子。我在 API 上看到了一些有限的问题和响应，但没有关于如何使用它的示例。我需要完成故事点和故事点的当前范围。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T22:44:06.607

对不起，可用的例子很少。随着 LBAPI beta 的成熟，将会有更多更好的例子出现。我绝对建议您熟悉[Lookback API (LBAPI) 文档](https://rally1.rallydev.com/analytics/doc)，因为那里有很好的示例用于制定查询。

对于燃耗，假设您想要获取从 2013 年 1 月 15 日到 2013 年 1 月 30 日的迭代的状态快照，并且迭代适用于四层深度的项目层次结构。以下 LBAPI 查询将获取计划到该迭代中的故事的 PlanEstimate、ToDo 和计划状态：

```
{
    find:
        {
           _TypeHierarchy:"HierarchicalRequirement",
           Children:null,
           _ValidFrom:{
              $gte:"2013-01-15TZ",
              $lt:"2013-01-30TZ"
           },
           Iteration:{
              $in:[
                 12345678910,
                 12345678911,
                 12345678912,
                 12345678913
              ]
           }
        },
        fields:[
           "PlanEstimate",
           "ToDo",
           "ScheduleState"
        ]
} 
```

在哪里：

```
 $in:[
                 12345678910,
                 12345678911,
                 12345678912,
                 12345678913
              ] 
```

迭代的 ObjectID 是否称为“迭代 1”。从 Iterations: 上的标准 WSAPI 查询中获取这些对象 ID 可能是最简单的`(Name = "Iteration 1")`。对于复制到四层项目层次结构中的迭代，我们将看到与上述类似的四个迭代 OID。

对于图表，目前最困难的部分是处理时间序列数据的简单方法。目前查询和处理 LBAPI 数据的最可靠方法是直接针对 REST 端点工作并在您自己的代码中处理返回的 JSON 结果。

对于 Javascript 应用程序，为了处理数据并将其转换为图表，首选的工具包是[AppSDK2](http://developer.help.rallydev.com/apps/2.0p5/doc/)，特别是[SnapshotStore](http://developer.help.rallydev.com/apps/2.0p5/doc/#!/api/Rally.data.lookback.SnapshotStore)。

对于 Javascript 应用程序，[Lumenize javascript 库](https://npmjs.org/package/Lumenize)独立于 LBAPI，但由 Rally 的分析总监开发并捆绑在 SDK 中。您可以在此处找到一些使用 LBAPI 和 Lumenize 生成图表的示例，作为 Rally 内部和 Rally 客户 Hackathon 项目的一部分：

[https://github.com/RallyHackathon](https://github.com/RallyHackathon)

出于以下几个原因，请谨慎使用这些示例：

*   为了清楚起见，Lumenize 命名空间的几个方面将被更改/重命名
*   当前版本的 Lumenize 中存在一个错误，它的 timeSeriesCalculator 无法正确说明已删除或重新设置的故事。

希望很快会有更新版本的 AppSDK2 捆绑并发布，以整合 Lumenize 命名空间并解决错误，以便在 AppSDK2 和 LBAPI 之间更好地粘合 Javascript 应用程序开发。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-11T15:05:57.623

不幸的是，.NET、Java 和 Python 工具包尚未更新以支持 Lookback API。因此，您必须直接向 Lookback API 的 REST 端点执行 HTTP POST，其正文类似于上面列出的 Mark W 和 Content-Type 'application/json'。

我建议使用 Chrome 扩展程序“XHR 海报”来试验您从浏览器发送的内容： [https ://chrome.google.com/webstore/detail/xhr-poster/akdbimilobjkfhgamdhneckaifceicen](https://chrome.google.com/webstore/detail/xhr-poster/akdbimilobjkfhgamdhneckaifceicen)

# javascript - javascript隐藏所有与文本输入搜索框内容不对应的客户端

> ID：14782214
> 
> 赞同：0
> 
> 时间：2013-02-08T22:14:19.943
> 
> 标签：javascript

我有一个从数据库中提取我的客户列表的页面，我想添加一个动态的搜索框，无需重新加载页面，隐藏所有与框中键入的文本不匹配的客户端。

javascript可以做到这一点，还是我应该尝试另一种方法？

我的列表被编码为从数据库中提取信息。

```
<ul>
    <li><a href="index.php?pg=client&cid=125">Client Name</a></li>
    ...
    ...
    ...
    <li><a href="index.php?pg=client&cid=111">Client Name</a></li>
</ul> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T22:52:11.613

JQuery 让您更轻松 这里它在行动[http://jsfiddle.net/PUNaM/](http://jsfiddle.net/PUNaM/)

[http://api.jquery.com/contains-selector/](http://api.jquery.com/contains-selector/)

```
<input id="filter" />    
$("#filter").keyup(function(){
    $("ul>li").hide();
    $("ul>li:contains("+this.value+")").show();
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T22:37:41.673

我假设你愿意使用 jQuery。

首先，您需要有一些方法可以通过 javascript 引用您的列表和文本框。我将以 id 为例，但它可能是任何东西。

```
<input type="text" id="search-box" />

<ul id="clients-list">
  <!-- clients list here -->
</ul> 
```

然后，在 javascript 上，您可以监听[keyup](http://api.jquery.com/keyup/)事件。

```
$("#search-box").on("keyup", filterClients); 
```

这将使该`filterClients`函数在用户释放键时被调用。有很多方法可以定义它，但我会采用简单的方法：

```
function filterClients(event) {
  var $search = $(event.target);
  var text = $search.val();

  var $clients = $("#clients-list li");
  $clients.each(function() {
    var $client = $(this);
    var clientName = $client.text();

    var searchMatchesName = clientName.toUpperCase().indexOf(text.toUpperCase()) >= 0;

    if(searchMatchesName) {
      $client.show();
    } else {
      $client.hide();
    }
  });
} 
```

这不是最有效或更花哨的方法，但应该足以让您入门。

工作 jsFiddle：http: [//jsfiddle.net/u5WS3/](http://jsfiddle.net/u5WS3/)

# jboss - Angular 应用程序无法在远程服务器上的 IE 9 中运行

> ID：14782226
> 
> 赞同：0
> 
> 时间：2013-02-08T22:15:10.067
> 
> 标签：jboss, jboss7.x

我有一个简单的 Angular 应用程序，当部署在我的本地 JBoss 实例上时工作得很好，但是当我在我们的沙盒环境（也是 JBoss）中部署相同的 war 文件时，应用程序不会加载。只是显示为空白页。在 Chrome 或 FF 上查看时，它也可以正常工作。

没有太多事情要做，但是任何朝着正确方向的指示都会非常有帮助。

编辑：只是另一条信息，当地址包含计算机名称而不是本地主机时，它在 IE 本地也不起作用。所以`http://localhost:8080/angularapp`有效，但`http://[machinename]:8080/angularapp`没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T12:49:23.197

在帖子中，您并没有完全清楚地说明您在哪些环境中遇到了问题（很明显，它在使用 IE 时不起作用，但它在 Chrome 和 FF 的所有情况下都适用吗？）。

但是您在尝试使用机器名`http://machinename:8080/...`（您希望从任何其他网络接口访问 JBoss，您必须定义它。这可以使用启动脚本的 -b 参数来完成（Jboss 3.x/4.x/5.x/6.x 的 run.sh 或 JBoss 7 的standalone.sh）。例如：

`./run.sh -b xxx.xxx.xxx.xxx`（其中 xxx.xxx.xxx.xxx 是您的服务器 IP）将使 JBoss 只能从该 IP 访问（及其相应的机器名称，前提是在 DNS 或 /etc/hosts ...中正确定义），但不能从本地主机。

`./run.sh -b 0.0.0.0`将使 JBoss 可以从服务器的所有网络接口访问。

# javascript - 如何避免“无法读取未定义的属性”错误？

> ID：14782232
> 
> 赞同：154
> 
> 时间：2013-02-08T22:16:00.617
> 
> 标签：javascript

在我的代码中，我处理一个数组，其中包含一些条目，其中许多对象相互嵌套，而有些则没有。它看起来像下面这样：

```
// where this array is hundreds of entries long, with a mix
// of the two examples given
var test = [{'a':{'b':{'c':"foo"}}}, {'a': "bar"}]; 
```

这给我带来了问题，因为我有时需要遍历数组，并且不一致会给我带来如下错误：

```
for (i=0; i<test.length; i++) {
    // ok on i==0, but 'cannot read property of undefined' on i==1
    console.log(a.b.c);
} 
```

我知道我可以这么说`if(a.b){ console.log(a.b.c)}`，但是在最多有 5 或 6 个对象相互嵌套的情况下，这是非常乏味的。有没有其他（更简单的）方法可以让我只在 console.log 存在的情况下执行它，但不会引发错误？

* * *

## 回答 #1

> 赞同：198
> 
> 时间：2017-02-20T16:23:14.003

**更新**：

*   如果您根据 ECMAScript 2020 或更高版本使用 JavaScript，请参阅[可选链接](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining)。
*   TypeScript 在[3.7](http://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-7.html)版本中增加了对可选链的支持。

```
// use it like this
obj?.a?.lot?.of?.properties 
```

* * *

**ECMASCript 2020 之前的 JavaScript 或 3.7 版之前的 TypeScript 的解决方案**：

一个快速的解决方法是使用带有 ES6[箭头函数的 try/catch 辅助函数](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions)：

```
function getSafe(fn, defaultVal) {
  try {
    return fn();
  } catch (e) {
    return defaultVal;
  }
}

// use it like this
console.log(getSafe(() => obj.a.lot.of.properties));

// or add an optional default value
console.log(getSafe(() => obj.a.lot.of.properties, 'nothing'));
```

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2013-02-08T22:18:19.537

你正在做的事情引发了一个例外（这是理所当然的）。

你总能做到

```
try{
   window.a.b.c
}catch(e){
   console.log("YO",e)
} 
```

但我不会，而是想想你的用例。

你为什么要访问数据，6 个你不熟悉的嵌套级别？什么用例证明了这一点？

通常，您希望实际验证您正在处理的对象类型。

另外，在旁注中，您不应该使用这样的语句，`if(a.b)`因为如果 ab 为 0 或即使它为“0”，它将返回 false。而是检查是否`a.b !== undefined`

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-02-08T23:16:33.530

如果我正确理解您的问题，您需要最安全的方法来确定对象是否包含属性。

最简单的方法是使用[`in`操作符](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/in)。

```
window.a = "aString";
//window should have 'a' property
//lets test if it exists
if ("a" in window){
    //true
 }

if ("b" in window){
     //false
 } 
```

当然你可以把它嵌套到你想要的深度

```
if ("a" in window.b.c) { } 
```

不确定这是否有帮助。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2017-06-28T11:15:00.573

试试这个。如果`a.b`未定义，它将`if`毫无例外地离开该语句。

```
if (a.b && a.b.c) {
  console.log(a.b.c);
} 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2015-08-07T19:05:23.983

如果你使用[lodash](https://lodash.com/docs#has)，你可以使用他们的“has”功能。它类似于原生的“in”，但允许路径。

```
var testObject = {a: {b: {c: 'walrus'}}};
if(_.has(testObject, 'a.b.c')) {
  //Safely access your walrus here
} 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2019-02-24T23:33:20.320

如果你使用 Babel，你已经可以通过[@babel/plugin-proposal-optional-chaining Babel plugin](https://babeljs.io/docs/en/babel-plugin-proposal-optional-chaining)使用可选链语法。这将允许您替换它：

```
console.log(a && a.b && a.b.c); 
```

有了这个：

```
console.log(a?.b?.c); 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-05-12T16:32:19.287

我虔诚地使用[undefsafe](https://github.com/remy/undefsafe)。它测试每个级别到您的对象，直到它获得您要求的值，或者它返回“未定义”。但绝不会出错。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2016-09-22T13:53:13.627

这是处理深度或复杂 json 对象时的常见问题，因此我尽量避免尝试/捕获或嵌入会使代码不可读的多项检查，我通常在我的所有 procect 中使用这段小代码来完成这项工作。

```
/* ex: getProperty(myObj,'aze.xyz',0) // return myObj.aze.xyz safely
 * accepts array for property names: 
 *     getProperty(myObj,['aze','xyz'],{value: null}) 
 */
function getProperty(obj, props, defaultValue) {
    var res, isvoid = function(x){return typeof x === "undefined" || x === null;}
    if(!isvoid(obj)){
        if(isvoid(props)) props = [];
        if(typeof props  === "string") props = props.trim().split(".");
        if(props.constructor === Array){
            res = props.length>1 ? getProperty(obj[props.shift()],props,defaultValue) : obj[props[0]];
        }
    }
    return typeof res === "undefined" ? defaultValue: res;
} 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2019-05-17T19:33:28.477

如果你有[lodash](https://lodash.com/docs/4.17.11#get)你可以使用它的`.get`方法

```
_.get(a, 'b.c.d.e') 
```

或者给它一个默认值

```
_.get(a, 'b.c.d.e', default) 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2019-01-09T16:15:06.390

我喜欢曹寿光的回答，但我不喜欢每次调用时将函数作为参数传递给getSafe函数。我已经修改了 getSafe 函数以接受简单的参数和纯 ES5。

```
/**
* Safely get object properties.    
* @param {*} prop The property of the object to retrieve
* @param {*} defaultVal The value returned if the property value does not exist
* @returns If property of object exists it is returned, 
*          else the default value is returned.
* @example
* var myObj = {a : {b : 'c'} };
* var value;
* 
* value = getSafe(myObj.a.b,'No Value'); //returns c 
* value = getSafe(myObj.a.x,'No Value'); //returns 'No Value'
* 
* if (getSafe(myObj.a.x, false)){ 
*   console.log('Found')
* } else {
*  console.log('Not Found') 
* }; //logs 'Not Found'
* 
* if(value = getSafe(myObj.a.b, false)){
*  console.log('New Value is', value); //logs 'New Value is c'
* }
*/
function getSafe(prop, defaultVal) {
  return function(fn, defaultVal) {
    try {
      if (fn() === undefined) {
        return defaultVal;
      } else {
        return fn();
      }
    } catch (e) {
      return defaultVal;
    }
  }(function() {return prop}, defaultVal);
} 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2019-01-30T13:30:31.647

Lodash 有一个[`get`](https://lodash.com/docs/4.17.11#get)方法允许将默认值作为可选的第三个参数，如下所示：

```
const myObject = {
  has: 'some',
  missing: {
    vars: true
  }
}
const path = 'missing.const.value';
const myValue = _.get(myObject, path, 'default');
console.log(myValue) // prints out default, which is specified above
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.11/lodash.js"></script>
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2018-06-28T06:37:19.853

在 str 的答案中，如果属性未定义，则将返回值“未定义”而不是设置的默认值。这有时会导致错误。以下将确保在未定义属性或对象时始终返回 defaultVal。

```
const temp = {};
console.log(getSafe(()=>temp.prop, '0'));

function getSafe(fn, defaultVal) {
    try {
        if (fn() === undefined || fn() === null) {
            return defaultVal
        } else {
            return fn();
        }

    } catch (e) {
        return defaultVal;
    }
} 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2019-08-25T22:49:53.230

`x`想象一下，我们想对当且仅当`x`非空时应用一系列函数：

```
if (x !== null) x = a(x);
if (x !== null) x = b(x);
if (x !== null) x = c(x); 
```

现在假设我们需要对以下内容做同样的事情`y`：

```
if (y !== null) y = a(y);
if (y !== null) y = b(y);
if (y !== null) y = c(y); 
```

和同样的`z`：

```
if (z !== null) z = a(z);
if (z !== null) z = b(z);
if (z !== null) z = c(z); 
```

如您所见，如果没有适当的抽象，我们最终会一遍又一遍地重复代码。这样的抽象已经存在：*Maybe* monad。

*Maybe* monad 拥有一个值和一个计算上下文：

1.  monad 保持值安全并对其应用函数。
2.  计算上下文是应用函数之前的空检查。

一个简单的实现应该是这样的：

*⚠️ 此实现仅用于说明目的！这不是应该做的，而且在很多层面上都是错误的。但是，这应该让您更好地了解我在说什么。*

如您所见，没有什么可以破坏：

1.  我们将一系列功能应用于我们的价值
2.  如果在任何时候，值变为空（或未定义），我们就不再应用任何函数。

```
const abc = obj =>
  Maybe
    .of(obj)
    .map(o => o.a)
    .map(o => o.b)
    .map(o => o.c)
    .value;

const values = [
  {},
  {a: {}},
  {a: {b: {}}},
  {a: {b: {c: 42}}}
];

console.log(

  values.map(abc)

);
```

```
<script>
function Maybe(x) {
  this.value = x; //-> container for our value
}

Maybe.of = x => new Maybe(x);

Maybe.prototype.map = function (fn) {
  if (this.value == null) { //-> computational context
    return this;
  }
  return Maybe.of(fn(this.value));
};
</script>
```

* * *

**附录1**

我无法解释 monad 是什么，因为这不是这篇文章的目的，而且还有比我更擅长这方面的人。然而，正如 Eric Elliot 在他的博客文章[JavaScript Monads Made Simple](https://medium.com/javascript-scene/javascript-monads-made-simple-7856be57bfe8)中所说：

> 无论您的技能水平或对类别理论的理解如何，使用 monad 都会使您的代码更易于使用。未能利用 monad 可能会使您的代码更难处理（例如，回调地狱、嵌套条件分支、更冗长）。

* * *

**附录二**

以下是我如何使用来自[monetjs的](/questions/tagged/monetjs "show questions tagged 'monetjs'")*Maybe* monad解决您的问题

```
const prop = key => obj => Maybe.fromNull(obj[key]);

const abc = obj =>
  Maybe
    .fromNull(obj)
    .flatMap(prop('a'))
    .flatMap(prop('b'))
    .flatMap(prop('c'))
    .orSome('')

const values = [
  {},
  {a: {}},
  {a: {b: {}}},
  {a: {b: {c: 42}}}
];

console.log(

  values.map(abc)

);
```

```
<script src="https://www.unpkg.com/monet@0.9.0/dist/monet.js"></script>
<script>const {Maybe} = Monet;</script>
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-12-17T13:04:47.270

您可以使用 ECMAScript 标准中的可选链接。像这样：

```
a?.b?.c?.d?.func?.() 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-07-20T21:12:04.057

我之前回答过这个问题，今天碰巧也在做类似的检查。检查嵌套点属性是否存在的简化。您可以修改它以返回值，或者一些默认值来实现您的目标。

```
function containsProperty(instance, propertyName) {
    // make an array of properties to walk through because propertyName can be nested
    // ex "test.test2.test.test"
    let walkArr = propertyName.indexOf('.') > 0 ? propertyName.split('.') : [propertyName];

    // walk the tree - if any property does not exist then return false
    for (let treeDepth = 0, maxDepth = walkArr.length; treeDepth < maxDepth; treeDepth++) {

        // property does not exist
        if (!Object.prototype.hasOwnProperty.call(instance, walkArr[treeDepth])) {
            return false;
        }

        // does it exist - reassign the leaf
        instance = instance[walkArr[treeDepth]];

    }

    // default
    return true;

} 
```

在您的问题中，您可以执行以下操作：

```
let test = [{'a':{'b':{'c':"foo"}}}, {'a': "bar"}];
containsProperty(test[0], 'a.b.c'); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-12-29T23:07:35.503

我通常这样使用：

```
 var x = object.any ? object.any.a : 'def'; 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-08-05T21:37:26.040

您可以通过在获取属性之前提供默认值来避免出现错误

```
var test = [{'a':{'b':{'c':"foo"}}}, {'a': "bar"}];

for (i=0; i<test.length; i++) {
    const obj = test[i]
    // No error, just undefined, which is ok
    console.log(((obj.a || {}).b || {}).c);
}
```

这也适用于数组：

```
const entries = [{id: 1, name: 'Scarllet'}]
// Giving a default name when is empty
const name = (entries.find(v => v.id === 100) || []).name || 'no-name'
console.log(name)
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-03-10T01:24:59.477

与问题的实际问题无关，但可能对来此问题寻找答案的人有用。

**检查你的函数参数。**

如果你有一个类似的函数`const x({ a }) => { }`，并且你在没有参数的情况下调用它`x()`；附加 `= {}`到参数：`const x({ a } = {}) => { }`.

* * *

### 我所拥有的

我有这样的功能：

```
const x = ({ a }) => console.log(a);
// This one works as expected
x({ a: 1 });
// This one errors out
x();
```

这导致`"Uncaught TypeError: Cannot destructure property 'a' of 'undefined' as it is undefined."`

* * *

### 我将其切换为（现在有效）。

```
const x = ({ a } = {}) => console.log(a);
// This one works as expected
x({ a: 1 });
// This now works too!
x();
```

# azure - 无法获取 Blob 容器引用

> ID：14782233
> 
> 赞同：2
> 
> 时间：2013-02-08T22:16:04.777
> 
> 标签：azure, azure-blob-storage

我正在尝试使用 CloudBlobClient 的实例获取容器引用。在模拟器中，一切正常，但如果我部署到天蓝色，第二行：

```
CloudBlobClient blobClient = storageAccount.CreateCloudBlobClient();
blobClient.GetContainerReference("drives").CreateIfNotExist(); 
```

以 IOException 失败并显示“指定的注册表项不存在”。这可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T22:47:47.000

我实际上弄清楚出了什么问题。IOException 通常由 HTTPWebRequest 类生成，这让我认为，由于 .Net 库只是 API 包装器，因此会进行一些错误调用。我使用的是 Cloud Drive，所以我参考了 API 版本 1.7 的 Microsoft.WindowsAzure.StorageClient 和版本 2.0 的 Microsoft.WindowsAzure.Storage。这两个人互相干扰。因为我需要保留 Cloud Drive 功能，所以我删除了 Storage Class，一切正常。

# php - 使用包含语句错误从 jquery ajax 调用 php 函数

> ID：14782237
> 
> 赞同：3
> 
> 时间：2013-02-08T22:16:38.947
> 
> 标签：php, javascript, jquery, include

我的包含语句有问题。我有几个 php 文件在页面最初加载时加载，然后由 jQuery ajax 调用再次调用。由于 ajax 调用，我在函数中没有 php 脚本，但是当我从不同的位置（ajax 调用）调用它们时，我的 include 语句出现错误。例如，我的主页包含这个 php 脚本：

```
<div id="controlPanelForm">
    <?php include "lib/getControlPanel.php"; ?>
</div> 
```

这是 getControlPanel.php 文件的前几行：

```
<?php
include_once("../etc/includes.php");
...do something... 
```

这是ajax调用：

```
 function getControl(teamID)
{     $.ajax({
            type: "GET",
            data: {teamID: teamID},
            url: "./lib/getControlPanel.php",
            dataType: "html",
            async: true,
            success: function(response) 
            {
                $('#controlPanelForm').html(response);
            }
    });
} 
```

所以问题是当我从 ajax 调用中调用 php 脚本时，我得到了这个错误：

```
include_once(../etc/includes.php): failed to open stream: No such file or directory in 
```

如果我更改相对路径，则主页中的原始包含不起作用...

我该如何解决这个问题？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T22:43:14.860

```
include_once(../etc/includes.php): failed to open stream: No such file or directory in 
```

此错误表明 '../etc/includes.php' 中的文件不存在。您可以查看当前工作目录，[`getcwd()`](http://php.net/manual/en/function.getcwd.php)以确定您的相对链接实际指向的位置。

然而，相对路径是一种痛苦。我从不使用它们。我所有的项目都包含一个包含配置值的 config.php 文件：

```
// paths and urls
define('SITE_PATH', '/var/www/my_website/');
define('SITE_URL', 'http://localhost/my_website/'); 
```

现在一切都可以是绝对的。修改您的示例：

```
<div id="controlPanelForm">
    <?php include SITE_PATH . 'lib/getControlPanel.php'; ?>
</div> 
```

获取控制面板.php：

```
<?php
include_once(SITE_PATH . 'etc/includes.php'); 
```

使用这些定义可以完成更多工作，例如创建用于加载文件的函数、发送重定向标头等。

附带说明一下，在使用 AJAX 调用对其进行调试之前，始终使用 Web 浏览器直接访问它来测试 ajax 页面。这样您就可以判断问题是 php 问题还是 javascript 问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T22:38:33.590

您可以通过更正包含文件 (includes.php) 的路径来修复它。您可以将其作为绝对值或相对值引用，没关系。重要的是它被正确引用。

话虽如此，我更喜欢绝对路径（使用常量定义到 web/app root 的路径）。

要找出正确的路径（无论您要使用相对还是绝对），请删除

```
echo phpinfo(); 
```

在您的文件中查看 DOCUMENT_ROOT 或 SCRIPT_FILENAME 变量。

# oracle - 将 Date 列与 sysdate 进行比较：在需要数字的地方发现了一个非数字字符

> ID：14782239
> 
> 赞同：3
> 
> 时间：2013-02-08T22:16:40.410
> 
> 标签：oracle, materialized-views, ora-01858

我遇到了一个奇怪的问题，将日期列与 SYSDATE 进行比较会产生以下错误：

```
01858\. 00000 -  "a non-numeric character was found where a numeric was expected"
*Cause:    The input data to be converted using a date format model was
           incorrect.  The input data did not contain a number where a number was
           required by the format model.
*Action:   Fix the input data or the date format model to make sure the
           elements match in number and type.  Then retry the operation. 
```

我正在重新创建一个物化视图；其中包括一些小的更改，并且每当进程中止时，它总是指向以下派生表查询中的“>=”：

```
SELECT id, 
  desc,
  start_date,
  end_date
 FROM T_LIPR_POLICY_ROLE TLPR
 WHERE end_date >= SYSDATE 
```

现在 end_date 是一个 DATE 类型，我实际上可以自己执行这个查询，但是每当我尝试在物化视图中运行它时，它总是会因上述错误而中止。尽管上周我能够使用相同的查询创建它。

有任何想法吗？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T13:38:48.217

嗨，我对长时间的延误感到非常抱歉。出于安全原因，我无法发布整个声明。

现在问题已经解决了。问题是我们的物化视图脚本通过 UNION 聚合了来自 17 个不同地方的数据。现在由于某种原因，错误指向错误的代码行（见下文）。

```
SELECT id, 
 desc,
 start_date,
 end_date
FROM T_LIPR_POLICY_ROLE TLPR
WHERE end_date >= SYSDATE <-- ORACLE POINTS TO THIS LINE 
```

现在这就像脚本中的第十条语句，但错误确实在脚本中的第六条语句中；这显然具有误导性。在此声明中，一条特定记录（数百万）正在尝试以下操作：

```
to_date('  / 0/    ') <-- This was the cause of the problem. 
```

请注意，此文本在实际脚本中并非如此，它字面意思是 to_date(<varchar 类型的列名>)，但 1500 万条记录中有 2 条具有上面指定的文本。

现在我不太明白为什么 Oracle 指向错误的代码行。

¿ 是 Oracle 问题吗？¿ SQL Developer 有问题吗？¿ 会不会与提示冲突？我们像这样使用几个：**/*+ PARALLEL (init 4) */**

谢谢你的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T15:47:31.600

desc 是列名吗？如果是，那么您正在使用 oracle 保留关键字 desc 作为列名。

```
SELECT id, 
  desc,---- here
  start_date,
  end_date
 FROM T_LIPR_POLICY_ROLE TLPR
 WHERE end_date >= SYSDATE 
```

> 我们不能在列名中使用 oracle 保留关键字。

请更改列名。

# mongodb - 使用 MongoDB.Web 时出错：MongoDB.Driver.SafeModeResult MongoDB.Driver.MongoCollection.Insert(!!0)

> ID：14782240
> 
> 赞同：0
> 
> 时间：2013-02-08T22:16:42.863
> 
> 标签：mongodb

使用 MongoDB.Web 成员资格提供程序时出现以下错误：

```
Method not found: 'MongoDB.Driver.SafeModeResult MongoDB.Driver.MongoCollection.Insert(!!0)'. 
```

我有最简单的实现：

*   视觉工作室速成版 2012
*   添加了标准 index.aspx 的空网站项目 (VB.NET)
*   Nuget 包：MongoDB.Web 1.2、mongocsharpdriver 1.7
*   MongoDB 数据库版本 2.2.3
*   Windows 7 64 位

（所有 Mongo 元素今天都是新鲜下载的。）

[我从FreshLogic](https://github.com/freshlogic/MongoDB.Web)站点复制并粘贴了 Membership 提供程序 web.config 的详细信息，并且只修改了`database`和`collection`属性以引用我想要的集合。

`Page.Load`在我的 index.aspx 事件中，我有一行代码：

```
Membership.CreateUser("fred124243", "Passw0rd$123") 
```

运行解决方案时出现上述错误。我可以看到我的集合已创建，因此解决方案是与 MongoDB 通信。

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T23:31:50.513

回答我自己的问题...我必须从 Git 下载 MongoDB.Web 源代码并重新编译。

# c# - 如何通过单击按钮将多个文本框的数据从一个表单传递到另一个表单？

> ID：14782244
> 
> 赞同：0
> 
> 时间：2013-02-08T22:16:54.163
> 
> 标签：c#, winforms

我无法通过单击按钮将**多个文本框**的数据传递给`Form1`to 。`Form2`我尝试了以下方法，但它不起作用。

我做错了吗？如果是这样，我该怎么做？

表格 1 代码：

```
public partial class Form1: Form {
    Form2 frm2;

    public Form1() {
        InitializeComponent();
    }

    private void btnInvoice_Click_1(object sender, EventArgs e) {
        this.Hide();

        if(frm2==null)
            frm2=new Form2();

        frm2.ValueFromForm1(txtFirstName.Text);
        frm2.ValueFromForm1(txtLastName.Text);
        frm2.ValueFromForm1(txtCellNo.Text);
        frm2.ValueFromForm1(txtDate.Text);
        frm2.ValueFromForm1(txtDueDate.Text);

        frm2.Show();
    }
} 
```

表格 2 代码：

```
public partial class Form2: Form {
    public Form2() {
        InitializeComponent();
    }

    public void ValueFromForm1(string value) {
        txtFirstName.Text=value;
        txtLastName.Text=value;
        txtCellNo.Text=value;
        txtMaskDueDate.Text=value;
        txtMaskDate.Text=value;
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-08T22:19:16.260

您正在为所有文本框分配相同的值。结果将是您分配的最后一个值（即`txtDueDate`文本）。创建不同的方法来为每个文本框分配值，或将值作为数组或自定义对象传递：

```
public class Invoice
{
   public string FirstName { get; set; }
   public string LastName { get; set; }
   public string CellNo { get; set; }
   // etc
} 
```

在 Form1 上

```
private void btnInvoice_Click_1(object sender, EventArgs e)
{
    this.Hide();
    if (frm2 == null)
        frm2 = new Form2();

    Invoice invoice = new Invoice();
    invoice.FirstName = txtFirstName.Text;
    invoice.LastName = txtLastName.Text;
    invoice.CellNo = txtCellNo.Text;
    // etc
    frm2.Invoice = invoice;
    frm2.Show();
} 
```

在 Form2 上

```
public Invoice Invoice
{
   set
   {
        txtFirstName.Text = value.FirstName;
        txtLastName.Text = value.LastName;
        txtCellNo.Text = value.CellNo;
        // etc
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T02:14:48.753

创建一个`Properties`in`Form2`怎么样？创建 a`class`是解决方案之一，但您可以简单`Properties`地创建`get`和`set`

# 表格1

```
private void btnInvoice_Click_1(object sender, EventArgs e)
{
    this.Hide();
    using(var f = new Form2())
    {
      f.FirstName = txtFirstName.Text;
      f.LastName = txtLastName.Text;
      f.CellNo = txtCellNo.Text;
      f.ShowDialog();
    }
} 
```

# 表格2

```
public string FirstName { get; set; }
public string LastName { get; set; }
public string CellNo { get; set; }

private void Form2_Load(object sender, EventArgs e)
{
    txtFirstName.Text = FirstName;
    txtLastName.Text = LastName;
    txtCellNo.Text = CellNo;
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-08T22:19:25.283

方法实现是非常错误的，或者至少是你在想的逻辑！您正在为所有文本框分配相同的值。

您可以通过两种方式解决问题。

### 简单的方法是将 Form2 中控件的修饰符从 更改`private`为`internal`或`public`。更改修饰符后，您可以将其称为

```
private void btnInvoice_Click_1(object sender, EventArgs e)
    {
        this.Hide();
        if (frm2 == null)
            frm2 = new Form2();

        frm2.txtFirstName.Text = txtFirstName.Text;
        frm2.txtLastName.Text = txtLastName.Text;
        frm2.txtCellNo.Text = txtCellNo.Text;
        frm2.txtDate.Text = txtDate.Text;
        frm2.txtDueDate.Text = txtDueDate.Text;

        frm2.Show();
    } 
```

## 如何更改修饰符？

![改变修饰符](../Images/74ecec7222ccce87af912024210ea972.png)

* * *

### 或通过创建多个方法的复杂方法，例如

```
public void ValueForFirstName(string value)
{
    txtFirstName.Text = value;
}

public void ValuForLastName(string value)
{
    txtLastName.Text = value;
} 
```

# mule - Mule ESB 动态 http 代理

> ID：14782247
> 
> 赞同：1
> 
> 时间：2013-02-08T22:16:56.077
> 
> 标签：mule, esb

我正在研究MULE ESB。我想使用 ruby​​ on rails 创建一个 API 管理器，并想知道是否有任何方法可以在 MULE 中动态映射我的端点。我的意思是，考虑到用户在我的应用程序中添加了一个新端点，我想在我的 MULE 上的 http 代理中注册它。

多谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:26:51.603

我相信这是动态流模块的一个很好的用例：

*   在此介绍：http: [//blogs.mulesoft.org/adding-flows-dynamically/](http://blogs.mulesoft.org/adding-flows-dynamically/)
*   可在此处获得：http: [//www.mulesoft.org/extensions/dynamic-flows](http://www.mulesoft.org/extensions/dynamic-flows)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-05T18:46:13.703

您可以通过以下链接查看您的回答：[http ://www.ivankrizsan.se/2014/03/09/dynamic-http-proxy-with-mule/](http://www.ivankrizsan.se/2014/03/09/dynamic-http-proxy-with-mule/) [https://dzone.com/articles/how-create-dynamic -http代理](https://dzone.com/articles/how-create-dynamic-http-proxy)

# c - 运行简单的客户端程序时收到 malloc 错误

> ID：14782248
> 
> 赞同：0
> 
> 时间：2013-02-08T22:17:12.450
> 
> 标签：c, client, client-server, malloc

我正在尝试测试客户端程序以确保它正确发送和接收来自服务器的消息。当我运行程序时，我从 malloc 收到这个奇怪的错误。任何帮助都会很棒。我一直在看这段代码太久了。提前致谢。这是错误：

// 第一个测试运行正常

```
TEST 1 :
Connected to server
 -> Socket open success
 -> Request sent success
 -> Response received success
Testing print:
Response received: <replyLoadAvg>0.228027:0.250000:0.280273</replyLoadAvg>

LoadAvg for 1min :: 0.228027
LoadAvg for 5min :: 0.250000
LoadAvg for 15min :: 0.280273
Real response -> <replyLoadAvg>0.228027:0.250000:0.280273</replyLoadAvg> 
```

//然后由于某种原因我收到此错误

```
clientc(17781) malloc: ********* error for object 0x7fd048404318: incorrect checksum for        
freed object - object was probably modified after being freed.
********* set a breakpoint in malloc_error_break to debug
Abort trap: 6 
```

这是客户端代码：

```
// prototype

char* verifyString(char*);

void printLoadAvg(char*);

int receiveResponse(int, char **);

int main(int argc, char *argv[])
{
    int sockfd;
    char *name;
    char *port;
    struct sockaddr_in * dest;

    if(argc != 3)
    {
        printf("Not enough arguments -- Exiting program\n");
        return 0;
    }

    name = argv[1];
    port = argv[2];

    char * received;
    char send[256];

    char testMessages[5][256] = {"<loadavg/>", "<echo>Hello World!</echo>", "<echo>                        </echo>", "", "<echo>Bye Bye World...<echo>"};
    char expectedResponses[5][256] = {"", "<reply>Hello World!</reply>", "<reply></reply>","<error>unknown format</error>", "<error>unknown format</error>"};

    int i;
    srand(time(NULL));

    for(i = 0; i < 5; i++)
    {
        printf("\nTEST %i", i+1);
        printf(((rand() % 2) ? ":\n" : " :\n"));
        sprintf(send, "%s", testMessages[i]);
        sockfd = createSocket(name, atoi(port), &dest);
        if(sockfd < 0){
            printf(" xx Open socket failed\n");
        }
        else{
            printf(" -> Socket open success\n");
            if(sendRequest(sockfd, send, dest) < 0){
                printf(" xx Send failed\n");
            }
            else{
                printf(" -> Request sent success\n");
                if(receiveResponse(sockfd, &received) < 0){
                    printf(" xx Receive failed\n");
                }
                else{
                    printf(" -> Response received success\n");
                    if(i!=0 && strcmp(received, expectedResponses[i]) != 0){
                        printf("Incorrect message\n");
                        printf("Expected: %s\n", expectedResponses[i]);
                        printf("Received: %s\n", received);
                    }
                    else if(i!=0){
                        printf("Test %i. passed successfully!\n", i+1);
                    }
                    else{
                        printf("Testing print:\n");
                        printResponse(received);
                        fprintf(stdout, "Real response -> %s\n", received);
                    }
                }
            }
        }

        free(received);
        free(dest);

        if(closeSocket(sockfd)==0){
            printf(" -> Socket closed success\n");
        }
        else{
            printf(" XX Close failed\n");
        }
    }

    return 0;
}

int createSocket( char* hostname, int port, struct sockaddr_in** dest)
{
    // fill in the socket address struct
    (*dest) = (struct sockaddr_in *)malloc(sizeof(struct sockaddr_in));
    struct hostent *hostptr;
    hostptr = gethostbyname(hostname);
    int socketfd;

    memset((void *) (*dest), 0, (size_t)sizeof(struct sockaddr_in));
    (*dest)->sin_family = (short)(AF_INET);
    memcpy((void*)& (*dest)->sin_addr, (void *) hostptr->h_addr, hostptr->h_length);
    (*dest)->sin_port = htons((u_short)port);

    // now get the file descriptor for the socket
    if((socketfd = socket(PF_INET, SOCK_STREAM, 0)) < 0) {
            return -1;
    }

    // connect to the server at the location displayed by TCPserver.c
    if(connect(socketfd, (struct sockaddr*)(*dest), sizeof(struct sockaddr)) < 0) {
        perror("Error: call to connect()\n");
        return -1;
    }

        printf("Connected to server\n");

    return socketfd;
}

int sendRequest(int sock, char* request, struct sockaddr_in* dest)
{
    // send a request through the socket to the server.
    if(write(sock, request, BUFFERSIZE) < 0)
    {
        return -1;
    } 

    return 0;
}

int receiveResponse(int sock, char ** response)
{
    // dynamically allocate memory to be used in this function
    (*response) = malloc(sizeof(char));

    // wait for a response from the server
    if(read(sock, (*response), BUFFERSIZE) < 0)
    {
        return -1;
    }

    return 0;
}

int closeSocket(int sock) 
{
    int error = 0;

if(close(sock)) 
    {
        perror("Error: Failed to close socket\n");
        error = -1;
    }

    return error;

}

void printResponse(char* response)
{
    char* buffer = "<replyloadavg>";
    int i, isLoadAvg = 0;

    // verify the string is in the correct format by calling the verifty string function
    // then print the string to the screen. 
    printf("Response received: %s\n", verifyString(response));

        for(i = 0; i < 14; i++) 
        {
            if(response[i] == buffer[i])
                isLoadAvg = 0;
            else 
            {
                isLoadAvg = 1;
                i = 15;
            }
        }

        if (isLoadAvg) 
        {
            printLoadAvg(response);
        }
    }

char* verifyString(char* string)
{
    int i, count = 0;

    // step through the array until you come to the last '>' (the end of the string)
    // then insert the NULL terminator at the end of the string. 
    for(i = 0; i < BUFFERSIZE; i++)
    {
        if(string[i] == '>')
            count++;
        if(count == 2)
        {
           string[i + 1] = '\0';
            i = BUFFERSIZE;
        }
    }

    return string;
}

void printLoadAvg(char* string)
{
    int i = 0, j;

    // these three arrays hold the newly formated strings, the ones that are easier to read.
    char s1[BUFFERSIZE], s2[BUFFERSIZE], s3[BUFFERSIZE];

    // step through the string until you reach the end of the string
    while(string[i] != '>')
    {
        i++;
    }

    i++;

    // now insert a colon and then save the contents of the string to the appropriate s array.
    for(j = 0; string[i] != ':'; j++, i++)
    {
        s1[j] = string[i];
    }

    // be sure to set the null terminator at the end.
    s1[j] = '\0';
    i++;

    for(j = 0; string[i] != ':'; j++, i++)
    {
        s2[j] = string[i];
    }

   // be sure to set the null terminator at the end.
    s2[j] = '\0';
    i++;

    // now move to the beginning of the end of the string array
    for(j = 0; string[i] != '<'; j++, i++)
    {
       s3[j] = string[i];
    }

    // now insert one more null terminator for the final s array.
    s3[j] = '\0';

    // now print out the newly fomrated strings.
    printf("\nLoadAvg for 1min :: %s\n", s1);
    printf("LoadAvg for 5min :: %s\n", s2);
    printf("LoadAvg for 15min :: %s\n", s3);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:30:46.287

```
(*response) = malloc(sizeof(char));

// wait for a response from the server
if(read(sock, (*response), BUFFERSIZE) < 0) 
```

尺寸是多少`BUFFERSIZE`。是否大于 1？如果是这样，您将溢出缓冲区...

# javascript - 每个功能适用于第一项

> ID：14782257
> 
> 赞同：0
> 
> 时间：2013-02-08T22:18:09.997
> 
> 标签：javascript, jquery

```
<textarea id="bbcode_enabled"></textarea>
<textarea id="bbcode_enabled"></textarea>
<textarea id="bbcode_enabled"></textarea>

$(document).ready(function()
{
    $("#bbcode_enabled").each(function () { 
        $(this).bbcode({
            tag_bold:true,
            tag_italic:true,
            tag_underline:true,
            tag_link:true,
            tag_item:true,
            tag_skill:true,
            tag_own3d:true,
            tag_youtube:true,
            tag_twitch:true,
            tag_color:false,
            tag_image:true,
            button_image:true
        });
    });
}); 
```

它只将 BBCode 类应用于第一个文本区域，而忽略其他。怎么了？

附言。这是我正在使用的 BBCode 类。 [http://pastebin.com/FqXasEmD](http://pastebin.com/FqXasEmD)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T22:18:56.300

因为`id`' 必须是 uniqiue ，所以将其更改为`class`：

```
<textarea class="bbcode_enabled"></textarea>
<textarea class="bbcode_enabled"></textarea>
<textarea class="bbcode_enabled"></textarea>

$(".bbcode_enabled").each(function () { 
    ...
}); 
```

# forms - zend 表单验证返回 false

> ID：14782258
> 
> 赞同：0
> 
> 时间：2013-02-08T22:18:14.293
> 
> 标签：forms, validation, zend-framework, return

我真的对这个感到困惑，真的需要你的帮助。这是**AddsummonerForm.php**

```
<?php
class Form_AddsummonerForm extends Zend_Form{
    public function __construct($options = null){
        $this->setMethod('post')
             ->setAttrib('id','standard-form')
             ->setAction($options['action'])
             ->setEnctype(Zend_Form::ENCTYPE_MULTIPART);
        $user = Zend_Auth::getInstance()->getIdentity();

        $name = new Zend_Form_Element_Text('name');
        $name->setAttribs(array(
                                'placeholder' => "Enter the Summoner's name")
                                )
                 ->setRequired()
                 ->addErrorMessage("Please check the name.")
                 ->addValidator('StringLength',false,array(4,15))
                 ->addValidator('Alnum')
                 ->removeDecorator('label')
                 ->removeDecorator('Errors')
                 ->removeDecorator('htmlTag')
                 ->removeDecorator('DtDdWrapper');

        $regions = array("euw" => "EUW", 
                        "eune" => "EUNE", 
                        "na"=>"NA", 
                        "brazil" => "Brazil", 
                        "turkey" => "Turkey");

        $region = new Zend_Form_Element_Select('region');
        $region->addMultiOptions($regions)
                ->addErrorMessage('Please check the region.')
                ->removeDecorator('label')
                ->removeDecorator('Errors')
                ->removeDecorator('htmlTag')
                ->removeDecorator('DtDdWrapper');

        $validate = new Zend_Form_Element_File('validate');
        $validate->setDestination(APPLICATION_PATH . '/../public/images/users/'.$user->getId())
        ->addValidator('Count', false, 1)
        ->addValidator('Extension',false,'jpg,gif,png')
        ->addValidator('Size',false,1024000)
        ->addErrorMessage('Please check the file.')
        ->removeDecorator('label')
        ->removeDecorator('Errors')
        ->removeDecorator('htmlTag')
        ->removeDecorator('DtDdWrapper');

        $submit = new Zend_Form_Element_Submit('submit');
        $submit->setLabel('Add')
               ->removeDecorator('DtDdWrapper');

        $this->setDecorators(array(
                                array(
                                    'ViewScript', array(
                                            'viewScript' => '_form_add_summoner.phtml'
                                            )
                                    )
                                )
                            );

        $this->addElements(array($name, $region, $validate, $submit));
    }
    } 
```

这是一种很常见的形式，然后是控制器 SummonerController 与操作添加，即：

```
 $errors = array();
    $addForm = new Form_AddsummonerForm(array(
            'action'=> '/summoner/add')
    );

    if($this->getRequest()->isPost()){
        if($addForm->isValid($this->_request->getPost())){

            // .... code ....

        }else{
            $errorArray = $addForm->getErrors();
            foreach($errorArray as $error){
                $errors[] = $error;
            }
            $this->view->errors = $errors;
        }
    }
    $this->view->form = $addForm; 
```

事情是，当我提交表单时，$addForm->isValid($this->_request->getPost())) 返回 false。

我尝试转储 $addForm->getMessages,$addForm->getErrors 并且它们是空的，但它仍然返回错误！有任何想法吗？

# php - 来自同一类的对象数量

> ID：14782259
> 
> 赞同：-3
> 
> 时间：2013-02-08T22:18:16.167
> 
> 标签：php

```
class a {

}

$obj1 = new a();
$obj2 = new a();
$obj3 = new a(); 
```

可能很陈词滥调，但是......有多少对象创建了这段代码？

我认为，可能此代码仅在这一行中增加 1 个对象，`$obj1 = new a();`并且`$obj2`仅`$obj3`在已创建的对象上指示？

我错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T22:19:29.107

该代码将创建三个不同的对象，每个变量将引用一个不同的对象。 `new` *总是*构造一个新的对象实例。

# c++ - OpenGL + ffmpeg 在全屏模式下很慢

> ID：14782266
> 
> 赞同：1
> 
> 时间：2013-02-08T22:18:33.977
> 
> 标签：c++, opengl, ffmpeg, sdl

我正在尝试使用 ffmpeg 和 OpenGL + SDL 播放视频文件。播放非常缓慢且闪烁。该代码是来自不同博客/网站的积累，我不太确定发生了什么。很抱歉发布这么长的代码，但这是最小化版本。我的实际代码在窗口模式下也不能很好地发挥作用。不知何故，下面的版本在窗口模式下播放流畅。

```
#ifndef INT64_C
#define INT64_C(c) (int64_t)(c)
#define UINT64_C(c) (uint64_t)(c)
#endif

extern "C" {
#include <libavcodec/avcodec.h>
#include <libavformat/avformat.h>
#include <libswscale/swscale.h>
}
#include <SDL.h>
#include <GL/gl.h>

int fullscreen = 1, videoStream = -1, frameFinished=0;
const PixelFormat CONV_FORMAT = PIX_FMT_RGB24;
const char *fname = "moviesample.mp4";
AVFormatContext *pFormatCtx = NULL;
AVCodecContext  *pCodecCtx = NULL;
AVCodec         *pCodec = NULL;
AVFrame         *pFrame = 0, *pFrameRGB = 0; 
AVPacket        packet;
AVDictionary    *optionsDict = NULL;
struct SwsContext *sws_ctx = NULL;
GLuint texture_video;

void av_init();
void draw_frame();

int main(int argc, const char **argv) {
  SDL_Event event;

  av_init();

  uint16_t width = fullscreen ? 1600 : pCodecCtx->width;
  uint16_t height = fullscreen ? 900 : pCodecCtx->height;

  SDL_Init(SDL_INIT_EVERYTHING);
  SDL_GL_SetAttribute( SDL_GL_DOUBLEBUFFER, 1 );
  SDL_SetVideoMode(width, height, 32,
      SDL_OPENGL | SDL_HWPALETTE  | SDL_HWSURFACE | SDL_HWACCEL | 
      (fullscreen ? SDL_FULLSCREEN : 0)
      );

  glEnable(GL_TEXTURE_2D);
  glClearColor(0.0f, 0.4f, 0.4f, 0.0f);
  glViewport(0, 0, width, height);
  glMatrixMode(GL_PROJECTION);
  glLoadIdentity();
  glMatrixMode( GL_MODELVIEW );
  glLoadIdentity( );
  glShadeModel( GL_SMOOTH );
  glGenTextures(1, &texture_video);
  glBindTexture(GL_TEXTURE_2D, texture_video); 
  glTexImage2D(GL_TEXTURE_2D, 0, GL_RGB, pCodecCtx->width, pCodecCtx->height, 
      0, GL_RGB, GL_UNSIGNED_BYTE, pFrameRGB->data[0]);
  glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
  glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);

  sws_ctx = sws_getCachedContext(sws_ctx, pCodecCtx->width, pCodecCtx->height, 
      pCodecCtx->pix_fmt, pCodecCtx->width, pCodecCtx->height, CONV_FORMAT, 
      SWS_BICUBIC, NULL, NULL, NULL);

  while (1) {

    draw_frame();

    SDL_GL_SwapBuffers();

    SDL_PollEvent(&event);

    switch(event.type) {
      case SDL_QUIT:
        SDL_Quit();
        exit(0);
        break;
      case SDL_KEYDOWN:
        if (event.key.keysym.sym == SDLK_ESCAPE) {
          SDL_Quit();
          exit(0);
        }
        break;
      default:
        break;
    }
  }
  return 0;
}

void draw_frame() {
  if (av_read_frame(pFormatCtx, &packet)>=0) { 
    if(packet.stream_index==videoStream) {
      avcodec_decode_video2(pCodecCtx, pFrame, &frameFinished, &packet);
      if(frameFinished) {
        sws_scale (sws_ctx, (uint8_t const * const *)pFrame->data, 
            pFrame->linesize, 0, pCodecCtx->height, pFrameRGB->data, 
            pFrameRGB->linesize);
        glBindTexture( GL_TEXTURE_2D, texture_video );
        glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR );
        glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR );
        glTexSubImage2D(GL_TEXTURE_2D, 0, 0, 0, pCodecCtx->width, 
            pCodecCtx->height, GL_RGB, GL_UNSIGNED_BYTE, pFrameRGB->data[0]);
      }

      glClear(GL_COLOR_BUFFER_BIT);
      glScalef(1.0f, -1.0f, 1.0f);
      glBegin(GL_QUADS);
      glTexCoord2f(0.0f, 0.0f);
      glVertex3f(-1.0f, -1.0f, 0.0f); 
      glTexCoord2f(0.0f, 1.0f);
      glVertex3f(-1.0f, 1.0f, 0.0f);
      glTexCoord2f(1.0f, 1.0f);
      glVertex3f(1.0f, 1.0f, 0.0f);
      glTexCoord2f(1.0f, 0.0f);
      glVertex3f(1.0f, -1.0f, 0.0f);
      glEnd();
      glScalef(1.0f, -1.0f, 1.0f);

    }
    av_free_packet(&packet);
  } else {
    av_seek_frame(pFormatCtx, videoStream, 0,  AVSEEK_FLAG_FRAME);
  }

}

void av_init() {
  av_register_all();
  avformat_open_input(&pFormatCtx, fname, NULL, NULL);
  avformat_find_stream_info(pFormatCtx, NULL);
  for(uint8_t i=0; i<pFormatCtx->nb_streams; i++)
    if(pFormatCtx->streams[i]->codec->codec_type==AVMEDIA_TYPE_VIDEO) {
      videoStream=i;
      break;
    }
  pCodecCtx = pFormatCtx->streams[videoStream]->codec;
  pCodec = avcodec_find_decoder(pCodecCtx->codec_id);
  avcodec_open2(pCodecCtx, pCodec, &optionsDict);
  pFrame = avcodec_alloc_frame();
  pFrameRGB = avcodec_alloc_frame();
  int bytes = avpicture_get_size(CONV_FORMAT, pCodecCtx->width, 
    pCodecCtx->height);          
  uint8_t *video_buffer = (uint8_t*)av_malloc( bytes * sizeof(uint8_t) );
  avpicture_fill((AVPicture *)pFrameRGB, video_buffer, CONV_FORMAT,
      pCodecCtx->width, pCodecCtx->height);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T05:36:11.507

在全屏模式下，您可能会获得垂直同步，这意味着`SDL_GL_SwapBuffers()`每帧会阻塞 16 毫秒左右。

要在窗口模式下模拟效果，请在主循环`SDL_Delay(16)`的末尾添加一个。`while(1)`

重写`draw_frame()`，使其泵送`libav` *直到*它获得下一帧，而不是只在每个主循环中泵送一次并*希望*你得到一个帧：

```
// g++ main.cpp `pkg-config sdl gl libswscale libavcodec libavformat --libs --cflags` && SDL_VIDEO_FULLSCREEN_HEAD=0 ./a.out
#ifndef INT64_C
#define INT64_C(c) (int64_t)(c)
#define UINT64_C(c) (uint64_t)(c)
#endif

extern "C" {
#include <libavcodec/avcodec.h>
#include <libavformat/avformat.h>
#include <libswscale/swscale.h>
}
#include <SDL.h>
#include <GL/gl.h>

int fullscreen = 1, videoStream = -1, frameFinished=0;
const PixelFormat CONV_FORMAT = PIX_FMT_RGB24;
const char *fname = "/home/genpfault/vid.mpg";
AVFormatContext *pFormatCtx = NULL;
AVCodecContext  *pCodecCtx = NULL;
AVCodec         *pCodec = NULL;
AVFrame         *pFrame = 0, *pFrameRGB = 0; 
AVPacket        packet;
AVDictionary    *optionsDict = NULL;
struct SwsContext *sws_ctx = NULL;
GLuint texture_video;

void av_init();
void next_frame();

int main(int argc, const char **argv) {
  SDL_Event event;

  av_init();

  uint16_t width = fullscreen ? 1920 : pCodecCtx->width;
  uint16_t height = fullscreen ? 1200 : pCodecCtx->height;

  SDL_Init(SDL_INIT_EVERYTHING);
  SDL_GL_SetAttribute( SDL_GL_DOUBLEBUFFER, 1 );
  SDL_SetVideoMode(width, height, 32,
      SDL_OPENGL | 
      (fullscreen ? SDL_FULLSCREEN : 0)
      );

  glEnable(GL_TEXTURE_2D);
  glClearColor(0.0f, 0.4f, 0.4f, 0.0f);
  glViewport(0, 0, width, height);
  glMatrixMode(GL_PROJECTION);
  glLoadIdentity();
  glMatrixMode( GL_MODELVIEW );
  glLoadIdentity( );
  glShadeModel( GL_SMOOTH );
  glGenTextures(1, &texture_video);
  glBindTexture(GL_TEXTURE_2D, texture_video); 
  glTexImage2D(GL_TEXTURE_2D, 0, GL_RGB, pCodecCtx->width, pCodecCtx->height, 
      0, GL_RGB, GL_UNSIGNED_BYTE, pFrameRGB->data[0]);
  glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
  glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);

  sws_ctx = sws_getCachedContext(sws_ctx, pCodecCtx->width, pCodecCtx->height, 
      pCodecCtx->pix_fmt, pCodecCtx->width, pCodecCtx->height, CONV_FORMAT, 
      SWS_BICUBIC, NULL, NULL, NULL);

  while (1) {

    while( SDL_PollEvent(&event) )
    {
        switch(event.type) {
          case SDL_QUIT:
            SDL_Quit();
            exit(0);
            break;
          case SDL_KEYDOWN:
            if (event.key.keysym.sym == SDLK_ESCAPE) {
              SDL_Quit();
              exit(0);
            }
            break;
          default:
            break;
        }
    }

    next_frame();

    glClear(GL_COLOR_BUFFER_BIT);
    glBindTexture( GL_TEXTURE_2D, texture_video );
    glScalef(1.0f, -1.0f, 1.0f);
    glBegin(GL_QUADS);
    glTexCoord2f(0.0f, 0.0f);
    glVertex3f(-1.0f, -1.0f, 0.0f); 
    glTexCoord2f(0.0f, 1.0f);
    glVertex3f(-1.0f, 1.0f, 0.0f);
    glTexCoord2f(1.0f, 1.0f);
    glVertex3f(1.0f, 1.0f, 0.0f);
    glTexCoord2f(1.0f, 0.0f);
    glVertex3f(1.0f, -1.0f, 0.0f);
    glEnd();
    glScalef(1.0f, -1.0f, 1.0f);

    SDL_GL_SwapBuffers();
  }
  return 0;
}

void next_frame() 
{
    while( true )
    {
        if( av_read_frame(pFormatCtx, &packet) >= 0 ) 
        { 
            if( packet.stream_index == videoStream ) 
            {
                avcodec_decode_video2(pCodecCtx, pFrame, &frameFinished, &packet);
                if(frameFinished) 
                {
                    sws_scale (sws_ctx, (uint8_t const * const *)pFrame->data, 
                    pFrame->linesize, 0, pCodecCtx->height, pFrameRGB->data, 
                    pFrameRGB->linesize);
                    glBindTexture( GL_TEXTURE_2D, texture_video );
                    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR );
                    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR );
                    glPixelStorei(GL_UNPACK_ALIGNMENT, 1);
                    glTexSubImage2D(GL_TEXTURE_2D, 0, 0, 0, pCodecCtx->width, 
                    pCodecCtx->height, GL_RGB, GL_UNSIGNED_BYTE, pFrameRGB->data[0]);
                    break;
                }
            }
            av_free_packet(&packet);
        } 
        else 
        {
            av_seek_frame(pFormatCtx, videoStream, 0,  AVSEEK_FLAG_FRAME);
        }        
    }
}

void av_init() {
  av_register_all();
  avformat_open_input(&pFormatCtx, fname, NULL, NULL);
  avformat_find_stream_info(pFormatCtx, NULL);
  for(uint8_t i=0; i<pFormatCtx->nb_streams; i++)
    if(pFormatCtx->streams[i]->codec->codec_type==AVMEDIA_TYPE_VIDEO) {
      videoStream=i;
      break;
    }
  pCodecCtx = pFormatCtx->streams[videoStream]->codec;
  pCodec = avcodec_find_decoder(pCodecCtx->codec_id);
  avcodec_open2(pCodecCtx, pCodec, &optionsDict);
  pFrame = avcodec_alloc_frame();
  pFrameRGB = avcodec_alloc_frame();
  int bytes = avpicture_get_size(CONV_FORMAT, pCodecCtx->width, 
    pCodecCtx->height);          
  uint8_t *video_buffer = (uint8_t*)av_malloc( bytes * sizeof(uint8_t) );
  avpicture_fill((AVPicture *)pFrameRGB, video_buffer, CONV_FORMAT,
      pCodecCtx->width, pCodecCtx->height);
} 
```

# c++ - Nvidia Nsight - 如何连接到本地主机？

> ID：14782275
> 
> 赞同：1
> 
> 时间：2013-02-08T22:18:59.013
> 
> 标签：c++, visual-studio-2010, cuda, nvidia, nsight

我正在尝试将“localhost”设置为 Nsight 的连接名称（我在 VS2010 上使用 CUDA 4.2 和 Nsight 2.2）但是有类似“localhost overridden to global connection name”之类的东西将我的 localhost 127.0.0.1 地址更改为另一个错误的。

![在此处输入图像描述](../Images/9f43bcd446b7e1cdb761b2f074f6c14f.png)

我该如何解决这个问题？我想做本地调试

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T23:00:08.790

我没有 Nsight 2.2，因为我已经在 3.0 RC1 上，所以我不能确定，但​​是当我在“Nsight Connections”工具栏中更改连接名称时发生了这个问题。例如，您可以通过转到 VS 中的“查看/工具栏”菜单并选中/取消选中“Nsight Connections”复选框来显示/隐藏工具栏。看到工具栏后，您可以单击“使用全局连接名称”按钮将其禁用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T22:42:34.160

你启动监控服务了吗？按开始并搜索并运行它。您也可以考虑升级到 CUDA 5 和 nsight 3，因为它更实用且更易于使用。

# php - 使用 php 上传脚本检测 MIME 类型不起作用

> ID：14782276
> 
> 赞同：0
> 
> 时间：2013-02-08T22:19:14.153
> 
> 标签：php, upload

我正在尝试检测通过 php 上传的音频文件的 mime 类型。我允许 .mp3 .mp4 和 .wav。出于某种原因，即使它是其中一种类型，它仍然说它是不正确的文件类型。这是我的验证码：

```
$allowedExts = array("wav", "mp3", "mp4", "mpeg");
$extension = end(explode(".", $_FILES["file"]["name"]));
if ((($_FILES["file"]["type"] == "audio/wave") || ($_FILES["file"]["type"] == "audio/mp4")|| ($_FILES["file"]["type"] == "audio/mpeg"))&& ($_FILES["file"]["size"] < 20000)
&& in_array($extension, $allowedExts))
  {

  } 
```

如果有人解决了这个问题，请提交代码的固定部分，而不仅仅是其中的一部分。我很感激任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:30:56.127

检查 mime 类型的更好方法是让 phps 内部函数处理文件。$_FILES["file"] 的内容很容易被攻击者部分伪造。另外，你有一个可靠的来源，你的 mime 类型是如何拼写的。

试试[finfo](http://php.net/manual/de/function.finfo-open.php) [http://php.net/manual/de/function.finfo-open.php](http://php.net/manual/de/function.finfo-open.php)

```
$allowedMimeTypes = array('audio/wave', 'audio/mp4', 'audio/whatevermore');
$allowedExts = array('wav', 'mp3', 'mp4', 'mpeg');
$extension = pathinfo($_FILES['file']['name'], PATHINFO_EXTENSION);

$finfo = new finfo(FILEINFO_MIME);
$mime = $finfo->file($_FILES['file']['tmp_name']);  

if(in_array($mime, $allowedMimeTypes) && filesize($_FILES['file']['tmp_name']) < 200000 && in_array($extension, $allowedExts)) {
    echo 'yeah';
} 
```

# html - 将 div 宽度应用于非子级 ul

> ID：14782284
> 
> 赞同：0
> 
> 时间：2013-02-08T22:19:40.197
> 
> 标签：html, css

当 div 的宽度未知时，如何将 div 的宽度应用于 ul。

的HTML：

```
<div>
    <p>
        Text
    </p>
</div>
<ul>
    <li>
        <p>
            Some other text
        </p>
    </li>
</ul> 
```

ul 的宽度应该比 div 小 89%。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:21:26.350

如果在`<ul>`外面`<div>`那么它没有`<div>`s宽度的概念。如果你愿意，你可以用 javascript 来做。

jQuery 方法（谁知道这是否是您真正想要的，但您的问题是......含糊不清）

```
$('ul').css('width', $('div').width() * 0.89); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T22:22:53.037

使用 jQuery：

```
var ulWidth = parseInt($("div").width() * .89);
$("ul").width(ulWidth); 
```

为了便于阅读，我将 JS 拆分为 2 行，但您只需一行即可：

```
$("ul").width(parseInt($("div").width() * .89)); 
```

出于演示目的，请参阅带有警报的**[DEMO 。](http://jsfiddle.net/zaknotzak/9dzTM/3/)**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T22:24:45.420

使用**jQuery**：

```
var width = $('div').width() * 0.89;

$('ul').css({'width':width}); 
```

见[小提琴](http://jsfiddle.net/soyuka/swXQH/1/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-08T22:25:15.740

```
$("ul").width(parseInt($("div").width()) * 0.89); 
```

# windows - windows下，有没有办法强制堆栈使用大页面？

> ID：14782287
> 
> 赞同：1
> 
> 时间：2013-02-08T22:19:58.223
> 
> 标签：windows, 64-bit, huge-pages

有没有办法编译一个 Windows 程序，以便它使用 SEC_LARGE_PAGES 或等效方法分配堆栈？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T01:54:36.367

不会。大页面的行为与常规页面不同，内核希望堆栈包含常规页面。

# sql - VBA SQL 返回语句，而不是值

> ID：14782289
> 
> 赞同：0
> 
> 时间：2013-02-08T22:20:11.863
> 
> 标签：sql, vba, ms-access

我正在使用列表框，当您单击一行时，它将填充工作表上的字段。因此，如果我单击工单 18，它将从表格​​中获取部门、优先级、受让人等并填写工单。当我点击该行时，我会弹出一个带有票号的消息框，只需编写：

```
MsgBox Me.Work_Order_List.Value 
```

然后当我尝试

```
ticNum = Me.Work_Order_List.Value
strSQL = "SELECT Description_Of_Problem FROM Work_Orders WHERE " & ticNum & " = Ticket_Number;"
Debug.Print strSQL
Me.Notes = strSQL 
```

我的注释框将打印 SQL 语句但从不运行。我在这里做错了什么？我将需要填充许多字段，所以还有更快的方法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:54:03.463

```
Me.Notes = DLookup("Description_Of_Problem", "Work_Orders", "Ticket_Number=" & ticNum) 
```

That was exactly what I was looking for. I was able to delete the rest of my code and use those for each field. Thanks HansUp!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T22:21:45.773

您没有运行查询。如果您希望数据填写到字段中，您应该将表单的记录源设置为 sql。

```
 Me.RecordSource = "SELECT Description_Of_Problem, Other, Etc FROM Work_Orders" 
```

上述方法仅在您将控件绑定到字段时才有效，但这是填充大量控件的最简单方法。

最好的开始方式是使用表单向导基于 Work_Orders 创建一个表单。然后，您可以通过创建一个组合框来选择表单上的记录，从而完全避免任何编码。然后，用户可以选择一张票并跳转到该记录。也有一个向导。

* * *

```
Dim rs As DAO.Recordset

ticNum = Me.Work_Order_List.Value
strSQL = "SELECT Description_Of_Problem FROM Work_Orders WHERE Ticket_Number =" _
       & ticNum 
Debug.Print strSQL
Set rs = CurrentDB.OpenRecordset strSQL
Me.Notes = rs!Description_Of_Problem 
```

* * *

**绑定表单**

基于表或查询启动表单向导

![Form wizard](../Images/6a0db5905f601cef37c5e3bb2fccfead.png)

按照步骤完成设计视图中的表单

![the form in design view](../Images/1a35511edb6b26a4c7e9d5d9af992772.png)

有许多方法可以浏览记录，您似乎喜欢列表框。添加一个列表框，确保选择了该向导。

![select listbox](../Images/b67f68508115fab78bbf8aec2ee06b8d.png)

选择在当前表单上查找记录

![find record on form](../Images/0286507032200acb720e97265a572f48.png)

并选择要出现在列表框中的项目

![select listbox items](../Images/d4ec8e295378741eecd9515d7ae670ec.png)

选择一个项目以在表单上找到它。

![select item to find record](../Images/ffba8ad92d66f15d0f95c74310e5b25a.png)

This is what makes it a bound form, the record source, which can be a table name, a query name or an SQL statement. Note that the control to be filled in automatically are bound to field names, but the listbox to find records is marked 'unbound'.

![bound form](../Images/bb11a0ba6ac237f58282c7cc07a877a1.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T23:37:36.810

After having to make multiple edits, I found that DLookup was not as convenient with multiple fields and an unbound form. So in the end I have decided:

```
Dim myR As Recordset

Set myR = CurrentDb.OpenRecordset("Work_Orders", dbOpenDynaset)
myR.FindFirst ("[Ticket_Number] = " & Me.Work_Order_List.Value & "")

Me.Update_Status = myR![Current_Status]
Me.Downtime_Code = myR![Downtime_Code]
Me.Date_For_Completion = myR![Date_For_Completion]
Me.Notes = myR![Notes_From_Assignee]
Me.Description_Box = myR![Description_Of_Problem]
Set myR = Nothing 
```

And I use myR.FindFirst to grab the row I'm looking for. Since my ticket system is still in the testing phase I only have ~100 records, but I'm hoping it will be able to search quickly when it reaches 10000+ with .FindFirst.

# android - HTTP 请求 Android 开发

> ID：14782290
> 
> 赞同：0
> 
> 时间：2013-02-08T22:20:18.910
> 
> 标签：android, httprequest, http-get

我正在尝试请求 HTTP，但它在我身上快死了

> HttpResponse httpResponse = httpClient.execute(httpGet);

下面是我的代码...

```
public JSONObject getJSONFromUrl(String url) {
    // HTTP Request
    try {
        // defaultHttpClient
        System.out.println("CRAZY1");
        HttpClient httpClient = new DefaultHttpClient();
        System.out.println("CRAZY2");
        HttpGet httpGet = new HttpGet(url);
        System.out.println("CRAZY3");

        System.out.println("CRAZY4");
        HttpResponse httpResponse = httpClient.execute(httpGet);
        System.out.println("CRAZY5");
        HttpEntity httpEntity = httpResponse.getEntity();
        System.out.println("CRAZY6");
        is = httpEntity.getContent();

    } catch (UnsupportedEncodingException e) {
        e.printStackTrace();
    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    } 
```

它告诉我线程正在以未捕获的异常退出。我确实在清单中启用了权限。可能是什么问题呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T22:57:39.637

确保您的 URL 包含 http://，否则 HttpGet 的构造函数将抛出 IllegalArgumentException。

# c++ - 在 Windows 7 上用 C++ 接收睡眠通知的最简单方法

> ID：14782291
> 
> 赞同：0
> 
> 时间：2013-02-08T22:20:21.443
> 
> 标签：c++, winapi, native, windows-7-x64, win64

我正在编写一个本机 C++ 应用程序，如果 Windows 7 系统进入睡眠模式，它需要做一些快速的工作——否则当系统唤醒时它将不可避免地崩溃。

使用本机 C++ 注册系统事件（挂起）的最简单方法是什么？

我真的只是想做[这些人所做](http://www.codeproject.com/Articles/30089/Handling-OS-Events-in-Windows-XP-and-Vista)的事情，但我有一个任意类（不是 gui），我想设置一个事件处理程序并获取 PBT_APMSUSPEND 事件，但我不确定最简单的方法。

Autoitscript[显然](http://www.autoitscript.com/forum/topic/107115-trigger-before-standby-in-w7vista/)有一个很好的方式，你可以写

```
GUICreate("Event Receiver")
GUIRegisterMsg($WM_POWERBROADCAST,"MY_WM_CALLBACKFUNCTION") 
```

我希望有类似的简单的东西......没有一个完整的消息泵设置。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T22:55:13.667

只需使用它创建一个隐藏窗口`CreateWindow/Ex()`并让其窗口过程回调处理`WM_POWERBROADCAST`消息。您无需创建 GUI 应用程序即可创建窗口。

# iphone - 移动 Safari 为 html 音频标签呈现空白

> ID：14782294
> 
> 赞同：1
> 
> 时间：2013-02-08T22:20:28.013
> 
> 标签：iphone, ipad, audio, mobile, safari

与桌面浏览器不同，移动 Safari 在 iPhone 和 iPad 中呈现 html 时会为音频标签添加空白。为什么是这样？有没有办法在没有不必要的样式设置的情况下避免这种行为？

我的目标是让网站访问者播放一段简短的音频摘录。介绍性文字和播放/暂停按钮必须显示在一行上，元素之间有一个间距。该代码在桌面浏览器中运行良好，但 Mobile Safari（在 iPhone 4S 和 iPad 3 上测试）在音频标签出现在 html 文件中的位置添加了空白（相当于约 30 个字符）。

我隔离了问题，并找到了解决方法。以下是对情况的描述，以及三个带您完成进度的测试页面。最后一个测试文件给出了解决方法。在桌面浏览器和 iPhone/iPad 中查看每个文件以查看行为（和源代码）。

介绍性文本和按钮之间出现空格 - audiotest3
将音频标签移动到文本和按钮之前，这会形成一个新行 - audiotest4
设置包含负上边距的文本和按钮的容器 - audiotest5
答案：将音频样式更改为高度：0 和宽度：0 - audiotest6

[单击此处获取测试文件](http://www.trunorth.com/abug/audiobug.html)。

这是一个已知的错误，还是我应该使用不同的标记？
*它是不同的标记。请参阅上面的答案。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T08:57:39.730

因此，我在寻找我在 iPad 上的网站上遇到的类似问题的解决方案时发现了您的问题。在对我的 CSS 进行了一些调试工作后，我发现如果您使用自定义控件来播放/暂停声音，音频元素的默认高度仍然为 30 像素，宽度为 200 或 300 像素。您可以在 Chrome 的开发工具中看到这一点。

我遇到的问题只发生在我的 iPad 上，并且在我用于播放/暂停按钮的文本之间添加了一个巨大的空间。

将音频标签尺寸设置为 0，这应该可以解决您的问题。

```
audio {
height:0;
width:0;
} 
```

# javascript - Javascript：从对象中删除所有鼠标悬停事件

> ID：14782295
> 
> 赞同：3
> 
> 时间：2013-02-08T22:20:30.087
> 
> 标签：javascript, google-visualization

这个问题询问谷歌图表，**但更笼统。**

我图表中图例的鼠标悬停给出了这个错误：

> 未捕获的类型错误：无法读取 null 的属性“x”

我没有添加任何 'onmouseover' 事件等，它似乎只是对`null`系列中的外观不满意（当您绘制具有不同 x 值的两个系列时，Google 图表说要添加空点`null`并绘制`interpolateNull : true`）。

有没有其他人有这个问题？有没有办法禁用图表图例的任何鼠标悬停事件？

非常感谢您提供的任何建议。

**更新：** [这里有一个最小的 jsfiddle 演示这个错误](http://jsfiddle.net/6Y8jF/48/)。谷歌图表似乎不喜欢有两个具有完全相同值的 x 和 y 点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-18T02:32:35.897

您可以尝试阻止适当的鼠标事件到达内置处理程序。

这需要向`mouseover`图表的图例添加一个侦听器。侦听器将调用（令人惊讶的是，在事件传播阶段`event.stopPropagation()`不需要触发）。`capture`

事实证明，`mousemove`事件也在被监听，所以也停止它们。

以下在 Firefox 上对我有用：

```
$('svg > g:first-of-type').bind('mouseover mousemove', function(e) { e.stopPropagation(); }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T21:06:27.060

我将这个答案基于我在这里找到的解决方案：http: [//jsfiddle.net/asgallant/6Y8jF/2/](http://jsfiddle.net/asgallant/6Y8jF/2/)

要点是隐藏 Google 的传奇并建立自己的传奇。`legend: {position: 'none'}`首先，通过作为选项之一传入来禁用内置图例`chart.draw`。

在`addDiv`为图表创建持有者 div 的函数中，添加第二个元素来保存图例。

```
function addDiv(parent_id, div_id) {
    $("#" + parent_id).append('<div id="' + div_id + '" class="chart-chart"></div><ul id="legend_' + div_id + '" class="chart-legend"></ul>');
} 
```

然后，在您的`drawChart`函数中，构建图例：

```
function drawChart(chart, original_table, 
    x_attr, y_attr, x_axis_lbl, y_axis_lbl, x_min_max,
    div_id) { //pass div_id to this function to be able to get legend element

    var google_table = allSeriesToGoogleTable(original_table, 
        x_attr, y_attr, ranking_titles);

    var colors = ["#3366cc","#dc3912","#ff9900"]; //use whatever colors you like
    var options = {'chartArea':{width:"60%"}, 
        vAxis: {'title': y_axis_lbl}, 'hAxis': {'title': x_axis_lbl},
        'interpolateNulls':true,
        colors: colors, //use the same colors for the chart and the legend
        legend: {position: 'none'} //hide default legend
    };
    var legend = $('#legend_' + div_id);
    for (var i = 1; i < ranking_titles.length; i++) {
        var li = $('<li></li>'),
            marker = $('<div class="legendMarker"></div>'),
            explanation = $('<span></span>');
        explanation.text(ranking_titles[i]); // legend marker text
        marker.css( {backgroundColor: colors[i-1]} ); //marker color
        li.append(marker).append(explanation);
        legend.append(li); 
    }
    if ( ! x_min_max === undefined )
    //do something
    chart.draw( google_table, options );

    // add the data table to the chart
    chart.google_table = google_table;
} 
```

当然，请确保您也包含小提琴中的 CSS：

```
.chart-chart {
    float: left;
}
.chart-legend {
    margin: 30px 0 0 0;
    float: left;
    list-style: none;
}
div.legendMarker {
    height: 1em;
    width: 1em;
    display: inline-block;
    margin: 0 5px 0 0;
} 
```

由于您无法将代码放入小提琴中，因此未经测试，但它应该可以让您完成 99% 的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T09:46:45.957

该文档可能非常有用： [https ://developers.google.com/chart/interactive/docs/gallery/linechart?hl=en#Configuration_Options](https://developers.google.com/chart/interactive/docs/gallery/linechart?hl=en#Configuration_Options)

但是，我认为您的代码包含错误。从基本配置开始尝试调试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-17T20:05:35.510

如果一个元素有多个 mouseover 事件，它们必须是使用 . 添加的`addEventListener`。

如果要删除使用添加的事件`addEventListener`，则需要`removeEventListener`. 但是这个方法需要一个监听器函数的引用（参见[https://developer.mozilla.org/en-US/docs/DOM/element.removeEventListener](https://developer.mozilla.org/en-US/docs/DOM/element.removeEventListener)）。

然后，也许您可​​以尝试[删除元素及其子元素的所有 JavaScript 事件侦听器？](https://stackoverflow.com/questions/3222486/remove-all-javascript-event-listeners-of-an-element-and-its-children)

# php - mysql_query 是否提交所有内容

> ID：14782299
> 
> 赞同：2
> 
> 时间：2013-02-08T22:20:56.560
> 
> 标签：php, mysql, commit

我在 php 中使用 mysql 扩展，我知道它从 PHP 5.5.0 开始已被弃用，但我已经使用此扩展编写了很多代码。在我看来，mysql_query 提交了查询，如果是这样，则意味着它被设置为自动提交，如何设置它不会自动提交。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T22:29:44.110

旧的 mysql 扩展没有专门用于事务控制的功能，但你可以发出 SQL 语句来做你想做的事。

您可以通过启动事务在一个事务期间隐式关闭自动提交：

```
mysql_query("START TRANSACTION"); 
```

一旦您提交或回滚，自动提交模式将恢复为默认值。

```
mysql_query("COMMIT"); // or ROLLBACK 
```

您可以通过设置会话变量来关闭整个会话的自动提交：

```
mysql_query("SET autocommit=0"); 
```

或者在您的 MySQL 实例上全局更改它，以便更改所有会话的默认值：

```
mysql_query("SET GLOBAL autocommit=0"); 
```

或者通过编辑 /etc/my.cnf 将其设置为在 MySQL 服务启动时更改全局设置：

```
[mysqld]
autocommit=0 
```

如果您使用 MySQL 5.1，则必须稍有不同：

```
[mysqld]
init_connect='SET autocommit=0' 
```

您可能已经知道，但需要重复的是，事务仅在您使用 InnoDB 表时才有意义。MyISAM 表不支持事务，因此无论您的设置如何，它们总是自动提交。与其他几个存储引擎相同，包括 MEMORY 和 CSV。

# jquery - 如何在jquery mobile中定位按钮

> ID：14782300
> 
> 赞同：1
> 
> 时间：2013-02-08T22:20:56.213
> 
> 标签：jquery, html, mobile, web

我正在使用 jquery mobile 构建网站。我正在尝试定位按钮并调整它们的大小。这就是我到目前为止所拥有的。提前感谢您的帮助。让我知道是否有任何其他方法可以解决这个问题。我的问题是这两个按钮没有出现在给出的位置上。

```
<html>
<head>
<meta charset="utf-8">
<title>jQuery Mobile Web App</title>
<link href="jquery.mobile.theme-1.0.min.css" rel="stylesheet" type="text/css"/>
<link href="jquery.mobile.structure-1.0.min.css" rel="stylesheet" type="text/css"/>
<script src="jquery-1.6.4.min.js" type="text/javascript"></script>
<script src="jquery.mobile-1.0.min.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="style.css">

<script type="text/javascript">

$("#ui-1").css({'position':'relative','left':'400.0px','top':'5.0px','width':'450px','height':'250px',});

$("#ui-1.ui-btn-text").css({'font-family':'"Calibri","Arial","Sans Serif"','font-size':'1.75em','color':'black','text-align':'center','wordwrap':'normal','text-shadow':'1px 1px 1px #FFFFFF'});

$("#ui-2").css({'position':'relative','left':'15.0px','top':'-10.0px','width':'450px','height':'250px',});

$("#ui-2.ui-btn-text").css({'font-family':'"Calibri","Arial","Sans Serif"','font-size':'1.75em','color':'black','text-align':'center','wordwrap':'normal','text-shadow':'1px 1px 1px #FFFFFF'});

</script>

</head> 
<body> 

<div data-role="page" id="page">
    <div data-role="header">
        <h1>Page One</h1>
    </div>
    <div data-role="content">   

  <a id="ui-1" href="wines.html" data-role="button"   data-theme="c" > 
   <img src="image1.png" width="200" height="200 "> <br/> 
   Wines </a>
   <a id="ui-2" href="wines.html" data-role="button"   data-theme="c" > 
   <img src="image1.png" width="200" height="200 "> <br/> 
   Wines </a>

    </div>
    <div data-role="footer" data-position="fixed">
        <h4>Page Footer</h4>
    </div>
</div>

</body>
</html> 
```

# html - CSS，HTML 不能将 div 内容放在 div 标签内

> ID：14782301
> 
> 赞同：1
> 
> 时间：2013-02-08T22:20:58.987
> 
> 标签：html, css

嗨，我对我的 div 标签有疑问。我遵循了本教程，在那里我专门做了他所做的事情并得到了不同的结果。我已经用谷歌搜索了这个，我找不到答案。

问题是我的 content_wrapper div 中的 div 标签不会将自己放在 content_wrapper div 中，即使我专门做了与教程中相同的事情。而是将 div 标签放在我的 content_wrapper div 的底部。如果有任何帮助，我目前正在使用 Dreamweaver CS5。

这就是我写我的div的方式：

```
<body>

    <div id="header"> This is my header </div>

    <div id="content_wrap"> 

        <div id="left_content"> Advertisement </div>

        <div id="right_content"> </div>

    </div>

</body> 
```

这是我的 CSS：

```
#header{
    height:1000px;
    width:1000px;
    margin-left:auto;
    margin-right:auto;
    border:solid 1px;
}

#content_wrapper{
    height:800px;
    width:980px;
    margin-left:auto;
    margin-right:auto;
    margin-top:10px;
    }

#left_content {
    height:800px;
    width:240px;
    float:left;
    margin-left:auto;
    margin-right:auto;
    border:solid 1px;

}

#right_content {
    height:800px;
    width:730px;
    margin-left:10px;
    margin-right:auto;
    float:right;
    border:solid 1px;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T22:24:08.790

您的左右 div 正在折叠，因为您尚未清除父 div（包装器）。添加一个类到你的`<div id="content_wrap" class="clearfix">`

```
.clearfix:after{
  clear: both;
  content: ".";
  display: block;
  height: 0;
  visibility: hidden;
  font-size: 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T22:24:57.877

div id“content_wrap”与 CSS 引用“content_wrapper”不匹配

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T22:29:58.897

除了您问题的评论中提到的 ID 不匹配之外，我还看到了几个问题。

首先，右浮动元素需要先出现。然后，浮动元素的总宽度需要小于包装元素的宽度，包括填充和边距，或者它们换行到新行。

最后，您可能不希望浮动元素上的自动边距。我不能确定，因为我不确定你在追求什么。

[http://jsfiddle.net/z8Gwg/](http://jsfiddle.net/z8Gwg/)

```
#header {
    height:100px;
    width:100px;
    margin-left:auto;
    margin-right:auto;
    border:solid 1px;
}
#content_wrapper {
    height:80px;
    width:98px;
    margin-left:auto;
    margin-right:auto;
    margin-top:10px;
    background-color: #eee;
}
#left_content {
    height:80px;
    width:20px;
    float:left;
    border:solid 1px;
    overflow: hidden;
}
#right_content {
    height:80px;
    width:70px;
    float:right;
    border:solid 1px;
}

<body>
    <div id="header">This is my header</div>
    <div id="content_wrapper">
        <div id="right_content"></div>
        <div id="left_content">Advertisement</div>
    </div>
</body> 
```

# c# - 如何调试不工作的 JSON 解析？

> ID：14782308
> 
> 赞同：3
> 
> 时间：2013-02-08T22:21:30.817
> 
> 标签：c#, json, parsing

这是[对此问题的](https://stackoverflow.com/questions/14778082/how-to-deserialize-a-nested-object/14778175#14778175)**后续**问题。我问如何解析，我得到了答案。话虽如此，我仍然没有让它工作，但这可能不是因为答案不足。

我想调试不当行为，但坦率地说我不知道​​如何。

这是我的反序列化代码。

```
DataContractJsonSerializer serializer 
  = new DataContractJsonSerializer(typeof(Customer));
MemoryStream stream = new MemoryStream(Encoding.UTF8.GetBytes(textToParse));
Envelope customer = (Customer)serializer.ReadObject(stream);

return "Status = " + customer.Status + " and guid = " + customer.Guid 
```

这是我使用的数据合约。

```
[DataContract]
public class Customer
{
  [DataMember(Name = "Status")]
  public int Status;

  [DataMember(Name = "CustomerId")]
  public String Guid;

  [DataMember(Name = "Information")]
  public Object Info;
} 
```

这是要解析的文本的头部。

```
{"CustomerStatuses":[{
  "Information":[{"Guid":"1","Role":"Customer"}],
  "CustomerId":"12345678-1234-1324-1234-123456781234",
  "Status":"4"},
  "Information":[{"Guid":"5","Role":"Customer"}],
  "CustomerId":"12345678-1234-1324-1234-123456781234",
  "Status":"6"},
  "Information":[{"Guid":"7","Role":"Seller"}],
  "CustomerId":"12345678-1234-1324-1234-123456781234",
  "Status":"6"},
  ... 
```

问题是属性*Status*显示为 0 而*Guid*显示为 null 或空字符串。我只是不打他们。这里有什么问题，我该如何调试？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:25:52.727

可以这么说，您定位到了错误的部分，或者使用了错误的标签。您不应该尝试解析*Customer*但*CustomerStatuses*，因为那是您的根对象。你**还**需要一堂课。希望您的客户会接受这一点。

这是数据合约的代码。我已经包含了字段*Info*，因为它看起来像您需要它，但按照规范，您也可以省略它。

```
[DataContract]  
public class CustomerStatuses
{
  [DataMember(Name = "CustomerStatuses")]
  public IEnumerate<Customer> Customers;
}

[DataContract]
public class Customer
{
  [DataMember(Name = "Status")]
  public int Status;

  [DataMember(Name = "CustomerId")]
  public String Guid;

  [DataMember(Name = "Information")]
  public Object Info;
} 
```

然后，您可以通过此代码访问这些内容。

```
DataContractJsonSerializer serializer 
  = new DataContractJsonSerializer(typeof(CustomerStatuses));
MemoryStream stream = new MemoryStream(Encoding.ASCII.GetBytes(jsonText));
CustomerStatuses parser = (CustomerStatuses)serializer.ReadObject(stream);

String guid = parser.DocumentStatuses.FirstOrDefault().Guid;
int status = parser.DocumentStatuses.FirstOrDefault().Status; 
```

这肯定会在明天出现在我的博客上！

# ruby - 如何从迁移文件生成架构文件？

> ID：14782313
> 
> 赞同：1
> 
> 时间：2013-02-08T22:22:12.093
> 
> 标签：ruby, activerecord

我有一个简单的 ruby​​ 项目，它使用 ActiveRecord 作为 ORM（没有 Rails）。我为我的所有表创建了一些迁移文件，现在我正在寻找如何在 Rails 中使用它们。这是一个例子：

```
class CreateCategoriesTable < ActiveRecord::Migration
  def up
    create_table :categories do |t|
      t.integer :id, null: false
      t.string :name, null: false
    end
  end

  def down
    drop_table :categories
  end
end 
```

在我的主文件中，我使用以下命令运行迁移：

```
CreateCategoriesTable.new.migrate :up 
```

但是，如果我有 db（它是文件中的 sqlite db），则此迁移会导致异常（表已存在）。那么，我怎样才能运行我所有的迁移（或者如何生成一个模式文件，然后如何运行它？）只有在需要它们时，例如第一次，然后只有当某些事情发生变化时？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:46:18.007

[这个 github repo](https://github.com/vitezg/simple-migrations-without-rails/)可能对你有用。

迁移的命名方案实际上相当重要。哪些迁移已运行在名为 *schema_migrations* 的表中进行跟踪。这是 postgres 的一个例子：

```
 Table "public.schema_migrations"
 Column  |          Type          | Modifiers 
---------+------------------------+-----------
 version | character varying(255) | not null
 Indexes:
 "unique_schema_migrations" UNIQUE, btree (version)

development=# select * from schema_migrations;
    version     
----------------
20130206231627
(1 row) 
```

此外 schema.rb 可以跟踪它的当前版本

```
ActiveRecord::Schema.define(:version => 20130206231627) do
  ...
end 
```

# python - Django 控制台应用程序

> ID：14782315
> 
> 赞同：-1
> 
> 时间：2013-02-08T22:22:43.713
> 
> 标签：python, django, console-application, tastypie

TastyPie 似乎严重依赖 Django，我想开发一个使用 REST 的 Python 应用程序。我知道 Django 是一个用于开发网站的 API，但是有没有办法将 Django 与 TastyPie 一起用作完全基于控制台的应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:48:14.340

你好像把事情搞混了。Django 是一个实现 MVC 模型的框架，即模型、视图和控制器（他们稍微修改了这个术语，但这是一个细节）。它允许您使用模型使用 ORM 与数据库交互，使用 HTML（视图，在 Django 中称为模板）显示输出数据，并定义将模型粘合到视图（控制器，在 Django 中称为视图）的逻辑。

使用 REST，您可以使用 HTTP 协议中已经定义的关键字来操作资源（主要是数据库数据）。Tastypie 是一个 Django 包，允许您在 Django 项目上轻松开发 REST 接口。

Django 允许[定义](https://docs.djangoproject.com/en/dev/ref/django-admin/)可从控制台调用的命令，这些命令可以用 Tastypie 插入。这回答了你的问题，但我怀疑这是你需要的。

如果您不需要 Web 集成（仅限控制台的应用程序），那么您就不会使用 Django 的模板部分，也不会使用它的 HTTP 请求处理和路由。我建议您使用另一种 ORM，例如 SQLAlchemy。如果需要，可以使用诸如 ncurse 之类的库来创建控制台界面。首先尝试了解您的需求：您想要实现什么？回答完这个问题后，你应该问自己：我需要 ORM（数据库集成）和模板（输出如 HTML）吗？如果不是，那么请重新考虑在您的项目中使用 Django，并权衡它与其他更适合您需求的框架的优缺点。

我建议先把事情弄清楚，因为基于控制台的应用程序不使用 HTTP 进行通信，这是 Django 框架和 REST 哲学的基础。

# css - 查找从 SASS 编译的 CSS 文件的源

> ID：14782319
> 
> 赞同：3
> 
> 时间：2013-02-08T22:22:54.327
> 
> 标签：css, sass

我正在处理的项目有一个复杂的样式表库，其中包含多个 scss 供应商库以及许多文件和文件夹，这些文件和文件夹充满了编译成单个 css 文件的 scss 文件。

当我想对 css 进行简单的更改时，我必须花费大量时间在文件结构中搜索源 scss 文件。通常我只会在浏览器中使用开发人员工具，但这仅显示 css 文件的样子，并且大多数时候这些类是从多个源创建并相互覆盖，因此 scss 看起来不像 css 中的结束。

有没有一种简单的方法可以找到从 scss 编译的 css 的源代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:25:33.017

这是一个链接，显示了如何在 Google Chrome 上为 SASS 文件启用源映射。有了它，你就可以做你想做的事[http://bricss.net/post/33788072565/using-sass-source-maps-in-webkit-inspector](http://bricss.net/post/33788072565/using-sass-source-maps-in-webkit-inspector)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-25T16:55:39.713

万一其他人在这里结束，要在 Chrome for Sass 中使用源映射，您需要先使用`--sourcemap`标志来生成它们！

```
sass --watch --sourcemap --debug-in sass/screen.scss:screen.css 
```

更多信息：[https ://developers.google.com/chrome-developer-tools/docs/tips-and-tricks#debugging-sass](https://developers.google.com/chrome-developer-tools/docs/tips-and-tricks#debugging-sass)

并使用该`--debug-info`标志设置 scss 以供 FireSass 读取。

# jquery - 根据 div 中的内容显示/隐藏 div

> ID：14782320
> 
> 赞同：1
> 
> 时间：2013-02-08T22:22:53.970
> 
> 标签：jquery, html, show-hide

我希望根据是否有实际图像上传到该特定事件，或者占位符图像是否在容器内来隐藏这些页面上的图像容器。唯一能区分这两个图像的是图像的路径，当然，还有 alt 标签。我显然希望隐藏占位符图像的图像容器容器。（th_noimage.jpg 是占位符图片）

[http://www.salvatorechiarelli.com/List/February](http://www.salvatorechiarelli.com/List/February)

```
<div class="productListImageContainer">
<a id="MainContent_controlProductsList1_lvItems_ctrl0_lnkImage_0" href="/View/Thursday-February-14th-2013-7P-M">
<img id="MainContent_controlProductsList1_lvItems_ctrl0_produtImage_0" alt="Thursday, February 14th, 2013 @ 7P.M." src="/ProductImages/112229/th_noimage.jpg">
</a>
</div>

<div class="productListImageContainer">
<a id="MainContent_controlProductsList1_lvItems_ctrl0_lnkImage_1" href="/View/Sunday-February-17th-2013-3P-M">
<img id="MainContent_controlProductsList1_lvItems_ctrl0_produtImage_1" alt="Sunday, February 17th, 2013 @ 3P.M." src="/ProductImages/112229/th_be4a17_feb_17_13.png">
</a>
</div> 
```

基本上是一个脚本，如果它包含 th_noimage.jpg，则显示隐藏 productListImageContainer。我希望我是一名程序员，但这完全超出了我的想象。

顺便说一下，这是网站的一个电子商务 CMS 部分，我操纵它作为我的客户事件的列表。感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:30:58.560

如果你使用 jQuery，你可能会这样做：

```
$('img[src$="th_noimage.jpg"]').closest('.productListImageContainer').hide(); 
```

隐藏占位符

# c# - ASP.Net Web 应用程序选择客户端目录

> ID：14782321
> 
> 赞同：0
> 
> 时间：2013-02-08T22:23:00.650
> 
> 标签：c#, asp.net

我需要允许用户通过 Web 应用程序中的 UI 提供本地目录路径，以便我们可以将其保存到我们的数据库中。然后，我们的其他程序（一个 winforms 应用程序）将使用此路径来存储他们通过该应用程序创建的文件（实际上是录音）。

理想情况下，我想尽可能多地消除人为错误的空间，即只让他们使用存在的路径，因此更希望有某种选择目录对话框来强制他们使用现有目录，但是我已经读到这是不可能的出于安全原因的客户端代码当然是完全有意义的，但是有什么方法可以实现吗？到目前为止，除了让他们输入之外，我找不到任何有用的东西，而且我对他们进入的路径缺乏控制感到不满意。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:02:25.617

有时，更多的选择并不能让您的客户更轻松。

Windows 应用程序的“标准”是将内容存储在用户的文档目录中，然后可能是用户文档目录中的应用程序特定文件夹。

我只会使用默认的期望，即用户的文档目录。

当你在思考这个问题时，问问自己如果用户选择的目录不管什么原因消失了，代码应该怎么做。这可能会发生，因为用户在使用您的 WebUI 设置此东西和使用 WinForm 的客户端之间更改了计算机。

使用标准行为、Documents 文件夹以及可能以应用程序命名的子目录，可以避免所有这些问题。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T23:02:40.860

您可以让他们在他们的计算机上选择一个文件并使用该路径。

为此，您可以使用[FileControl](http://asp.net-tutorials.com/controls/file-upload-control/)

# php - SQL 查询有效，但在 PHP 中无效

> ID：14782326
> 
> 赞同：2
> 
> 时间：2013-02-08T22:23:18.990
> 
> 标签：php, sql, oracle

我测试并成功使用下面的 SQL 代码将数据输入数据库。

```
INSERT INTO hraps (id, firstname, lastname, gender, year_of_1st_rappel, count_offset_proficiency, count_offset_operational, spotter) values(111111, 'World', 'Hello', 'Male', '2007', '1', '2', '0') 
```

现在我正在尝试将它集成到 PHP 中，如下所示：

```
 $query = "INSERT INTO hraps (firstname, lastname, gender, year_of_1st_rappel, count_offset_proficiency, count_offset_operational, spotter) "
."values('".$this->firstname."','".$this->lastname."','".$this->gender."','".$this->year_of_1st_rappel."',".$this->count_offset_proficiency.",".$this->count_offset_operational.",".$this->spotter.") returning id into :id";

$dbid = "";
$binds = array();
$binds[] = array("name" => ":id", "value" => &$dbid, "length" => 128);
//echo $query;              
$result = mydb::cxn()->query($query, $binds);
$this->id = $dbid; 
```

但是什么都没有插入，我也没有收到任何错误。唯一的区别是，在这一个中，我将 id 定义为 $dbid，并且在我将其硬编码到查询的“值”部分之前。

有人可以指出为什么这段代码不能成功运行吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:27:26.667

只是删除`"."`之前`VALUES`。尝试这个

你错过了`mysqli_query()`

```
 $query= "INSERT INTO hraps (firstname, lastname, gender, year_of_1st_rappel, count_offset_proficiency, count_offset_operational, spotter) 
  values ('".$this->firstname."','".$this->lastname."','".$this->gender."','".$this->year_of_1st_rappel."',".$this->count_offset_proficiency.",".$this->count_offset_operational.",".$this->spotter.") returning id into :id "; 
```

编辑：如果是甲骨文，那么使用这个

```
 $compiled = oci_parse($db, $query); //-- $db is your connection to database variable
    oci_bind_by_name($compiled, ':id', $id);  // --your id
    oci_execute($compiled); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T22:32:29.500

上面的两个查询不相等，因为它们使用不同的数据类型（int v string）。

第一个转换为字符串，第二个转换为 int。将 INSERT 查询更改为：

```
$query = "INSERT INTO hraps (firstname, lastname, gender, year_of_1st_rappel, count_offset_proficiency, count_offset_operational, spotter) "
."values('".$this->firstname."','".$this->lastname."','".$this->gender."','".$this->year_of_1st_rappel."','".$this->count_offset_proficiency."','".$this->count_offset_operational."','".$this->spotter."') returning id into :id";` 
```

# ruby-on-rails - 将 RVM 安装到 OSX Mountain Lion 时出错。“运行‘make -j2’时出错

> ID：14782330
> 
> 赞同：0
> 
> 时间：2013-02-08T22:23:30.943
> 
> 标签：ruby-on-rails

我正在使用 OS X Mountain Lion 在我的 Macbook Pro 上运行我的第一个 Ruby on Rails 设置。以前从来没有为开发配置过机器，通常是做设计的。运行 RVM 安装时，我得到了这个（在 ruby​​-1.9.3-p385 - #compiling 行之后）。

```
Error running 'make -j2', please read /Users/reuber1/.rvm/log/ruby-1.9.3-p385/make.log
There has been an error while running make. Halting the installation. 
```

不知道从这里做什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T22:35:54.393

您是否安装了 Apple 的开发工具？请参阅 OS X 的 rvm 安装说明：[https ://rvm.io/os/osx/](https://rvm.io/os/osx/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:11:33.650

rvm 网站上的那篇文章有很多内容。很确定问题出在Xcode上。

[https://github.com/kennethreitz/osx-gcc-installer](https://github.com/kennethreitz/osx-gcc-installer)

安装那个。问题解决了..

# php - 正则表达式查找 HTML 字符串中的所有路径

> ID：14782334
> 
> 赞同：1
> 
> 时间：2013-02-08T22:24:05.983
> 
> 标签：php, html, regex

我有一个字符串，带有一个 htmlentities 编码的 HTML 代码。

我想要做的是找到文档中的**所有**路径，介于：

href="XXX"，src="XXX"。

我确实有一个正则表达式，它可以找到所有以 http、https、ftp 和文件开头的链接，以免我对其进行迭代：

```
"/\b(?:(?:https?|ftp|file):\/\/|www\.|ftp\.)[-A-Z0-9+&@#\/%=~_|$?!:,.]*[A-Z0-9+&@#\/%=~_|$]/i" 
```

任何的想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T22:47:10.577

更新：用正则表达式做是不可靠的。src=".." 或 href=".." 语句可以是注释或 javascript 语句的一部分。为了可靠地获取链接，我建议使用 XPath：

```
<?php

$html = file_get_contents('http://stackoverflow.com/questions/14782334/regex-expression-to-find-all-paths-in-a-html-string/14782594#14782594');
$doc = new DOMDocument();
@$doc->loadHTML($html);
$selector = new DOMXPath($doc);

$result = $selector->query('//a/@href | //@src');
foreach($result as $link) {
    echo $link->value, PHP_EOL;
} 
```

* * *

如果使用正则表达式，我会尝试获取`"`href 或 src 属性的 = 之间的内容。下面是一个如何使用正则表达式从*该*页面获取链接的示例：

```
<?php

$html = file_get_contents('http://stackoverflow.com/questions/14782334/regex-expression-to-find-all-paths-in-a-html-string');

preg_match_all('/href="(?P<href>.*)"|src="(?P<src>.*)"/U', $html, $m);
                                                        <--- note the U to make the 
                                                             pattern ungreedy
var_dump($m['href']);
var_dump($m['src']); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-08T23:09:37.100

您可以使用 DOM 查找特定标签中的所有链接。例如，要从锚标签获取 url，请执行以下操作（未经测试，但它应该为您指明正确的方向）：

```
function findPaths($url)
{
   $dom = new DOMDocument();

   //$url of page to search, the "@' is there to suppress warnings
   @$dom->loadHTMLFile($url) 

   $paths = array();
   foreach($dom->getElementsByTagName('a') as $path)
   {
     $paths[] = array('url' => $path->getAttribute('href'), text => $path->nodeValue);
   }
   return $paths;
} 
```

您可以更轻松地使用 XPath 加载和评估 DOM。

# vim - Vim 用红色突出显示内容

> ID：14782338
> 
> 赞同：-1
> 
> 时间：2013-02-08T22:24:16.107
> 
> 标签：vim, vi

Vim 突出显示每行的前几个字符。我已经尝试了所有我能找到的方法来修复它。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T22:46:48.077

我找到了答案：文件类型设置不正确。不过，这不应该发生在空文件类型上。

# postgresql - jpa 创建表

> ID：14782340
> 
> 赞同：1
> 
> 时间：2013-02-08T22:24:25.547
> 
> 标签：postgresql, jpa

我有应用程序连接到 postgres 数据库，我需要创建一个临时表来存储数据，然后在作业结束时删除表。

我正在使用 JPA，但似乎需要预先在 DB 中创建表，我不想添加额外的工作来编写 sql 脚本并且必须在运行作业之前运行它来设置表，所以我在 JPA 中创建表查询然后执行常规 CRUD 操作，但它不起作用，是因为 JPA 无法即时创建表吗？我必须先创建表？这是我的代码：

```
Map<String, String> properties = Maps.newHashMap();
properties.put("javax.persistence.jdbc.url", "jdbc:postgresql://localhost:5432/postgres");
properties.put("javax.persistence.jdbc.user", "postgres");
properties.put("javax.persistence.jdbc.password", "");
EntityManagerFactory emf = Persistence.createEntityManagerFactory("job-postgres", properties);
String queryStr = "CREATE TEMPORARY TABLE tags ("
        + "id SERIAL NOT NULL PRIMARY KEY,"
        + "name varchar(255) NOT NULL,"
        + "type smallint NOT NULL"
        + ")";
Query q = emf.createEntityManager().createQuery(queryStr); 
```

标签.java：

```
@Entity
@Table(name="TAGS")
public class Tag implements Serializable {

    /**
     * 
     */
    private static final long serialVersionUID = 4762832549003921169L;

    @Id
    @Column(name="id")
    private int _id;

    @Basic
    @Column(name="name")
    private String _name;

    @Basic
    @Column(name="tagtype")
    private int _tagType;

    public Tag() {
        super();
    }

    public Tag(String name, int tagType) {
        _name = name;
        _tagType = tagType;
    } 
```

我得到的错误：

```
2013-Feb-08 14:15:06.574    ERROR   o.h.h.PARSER    o.h.h.a.ErrorCounter,56 line 1:1: unexpected token: CREATE
Exception in thread "main" java.lang.IllegalArgumentException: node to traverse cannot be null!
    at org.hibernate.hql.ast.util.NodeTraverser.traverseDepthFirst(NodeTraverser.java:63)
    at org.hibernate.hql.ast.QueryTranslatorImpl.parse(QueryTranslatorImpl.java:280)
    at org.hibernate.hql.ast.QueryTranslatorImpl.doCompile(QueryTranslatorImpl.java:182)
    at org.hibernate.hql.ast.QueryTranslatorImpl.compile(QueryTranslatorImpl.java:136)
    at org.hibernate.engine.query.HQLQueryPlan.<init>(HQLQueryPlan.java:101)
    at org.hibernate.engine.query.HQLQueryPlan.<init>(HQLQueryPlan.java:80)
    at org.hibernate.engine.query.QueryPlanCache.getHQLQueryPlan(QueryPlanCache.java:98)
    at org.hibernate.impl.AbstractSessionImpl.getHQLQueryPlan(AbstractSessionImpl.java:156)
    at org.hibernate.impl.AbstractSessionImpl.createQuery(AbstractSessionImpl.java:135)
    at org.hibernate.impl.SessionImpl.createQuery(SessionImpl.java:1760)
    at org.hibernate.ejb.AbstractEntityManagerImpl.createQuery(AbstractEntityManagerImpl.java:268) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T22:36:10.227

`EntityManager.createQuery()`将 JPQL 查询作为参数。不是 SQL 查询。

如果要执行 SQL 查询，请使用[EntityManager.createNativeQuery()](http://docs.oracle.com/javaee/6/api/javax/persistence/EntityManager.html#createNativeQuery%28java.lang.String%29)

# c# - 在 WCF 数据服务 (OData) 的投影中展开（选择）

> ID：14782342
> 
> 赞同：10
> 
> 时间：2013-02-08T22:24:31.373
> 
> 标签：c#, .net, exception, odata, wcf-data-services

假设我有一个看起来像这样的 OData 查询（我的实际查询要复杂得多）：

```
Orders.Select(z => new { z.SubOrder.Addresses,
                         z.SubOrder.Cost,
                         z.SubOrder.SubOrderId, 
                         z.Sequence}); 
```

这工作正常。除了 Address 对象上有一个子对象（StateRef）。由于 StateRef 对 State 表进行了查找，因此它返回为 null。

为了说明，下面是地址对象 Address 的示例：

```
Address:
    string         Street 1
    string         Street 2
    StateRef       PrimaryState
    string         City
    // ... 42 other string attributes not shown ... 
```

该`StateRef`对象上面有状态的名称，但也有一些其他重要的状态属性（可能是状态鸟？）

所以，我想知道的是，我现在是否必须为包含所有 46 个属性的 z.SubOrder.Addresses 创建一个“子投影”，以便我可以访问该`PrimaryState`项目？（**我希望不是**）

除了更多的编码之外，这还意味着我必须使用匿名类型。这使得我的映射必须手动（而不是使用 AutoMapper）。

**那么我正在寻找一种在投影内“扩展”StateRef 的方法？**

像这样的东西：

```
Orders.Select(z => new { z.SubOrder.Addresses.Expand("PrimaryState"),
                         z.SubOrder.Cost,        ^
                         z.SubOrder.SubOrderId,  |
                         z.Sequence});           |
                                                 |
// This is not allowed by the compiler ----------+ 
```

尝试这个会给出这个错误：

> 无效的匿名类型成员声明符。必须使用成员分配、简单名称或成员访问来声明匿名类型成员。

**更新：** 这是一个示例查询来说明我在问什么：

```
Users.Take(10).Select(x=>new { x.Id, x.Reputation, x.Comments}) 
```

针对“ [data.stackexchange.com/stackoverflow/atom](https://data.stackexchange.com/stackoverflow/atom) ”运行它。您将看到 Comments 有一个返回 null 的 Post 对象。

我需要它来返回其中的值。

*注意：我知道我可以手动将它们全部输入到“子”投影中。阅读上面的内容，了解我不想要的原因。*

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-15T11:43:16.037

这样做当然是可能的。对于概念证明，请尝试执行以下操作：

```
var uri = new Uri( "http://data.stackexchange.com/stackoverflow/atom/Users()?$top=10&$expand=Comments/Post&$select=Id,Reputation,Comments/" );
entities.Execute<User>( uri, "GET", false ).Select( x => new { x.Id, x.Reputation, x.Comments } ); 
```

expand的正确用法是这样的：

```
entities.Users.Expand( "Comments/Post" ).Take( 10 ).ToArray(); 
```

我不知道为什么图书馆的作者决定禁止使用带有投影的扩展，但正如上面的概念证明所示，这样做当然是可能的。

如果您不介意接收整个用户并在此之后进行投影，则可以使用第二个示例。否则，您可以编写自己的助手，它将从第一个示例中生成 URI，执行它们，然后添加投影。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-11T17:06:46.487

您不必创建列出所有 46 个属性的子投影，例如

```
(from u in Users
 select new 
    {
    u.Id, u.Reputation,Comments = ( from c in u.Comments 
                                    select new YourClass {comment = c, 
                                                          post= c.Post})
    }
)
.Take(10)

.....

public Class YourClass
    {
    public Comment comment {get;  set;}
    public Post post {get;set;}
    } 
```

不完全是我想象的你想要的对象图。

除此之外，人们可能会花费大量时间来尝试编写将生成正确 OData 查询的 LinQ 表达式，我们发现使用 Expand、Filter、Select 属性等创建自己的 OData 查询类会更省时. 即直接编写 OData 查询，而不是尝试制作 LinQ 查询。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-15T18:27:38.753

你可以做，

```
Users.Take(10).Select(x=>new { Id = x.Id, Reputation = x.Reputation, Comments = x.Comments.Select(c =>c.Id) }) 
```

这将导致请求，

[https://data.stackexchange.com/stackoverflow/atom/Users()?$top=10&$expand=Comments&$select=Id,Reputation,Comments/Id](https://data.stackexchange.com/stackoverflow/atom/Users%28%29?$top=10&$expand=Comments&$select=Id,Reputation,Comments/Id)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-11T19:15:27.977

您可以从子对象中选择特定属性。

例如，在 StackOverflow 的示例中，我可以在 LINQPad 中成功执行以下查询。

```
Users
.Take (10)
.Select(x => new {x.Id, x.Reputation, CommentsText = x.Comments.Select(c => c.Text)}) 
```

在您的情况下，您可以编写如下查询：

```
Orders.Select(z => new { StateName = z.SubOrder.Addresses.Select(a => a.PrimaryState),
                     z.SubOrder.Cost,        
                     z.SubOrder.SubOrderId,
                     z.Sequence}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-08T22:39:47.177

在`Expand`查询上完成。请参阅[如何：加载相关实体（WCF 数据服务）](http://msdn.microsoft.com/en-us/library/dd756366.aspx)

你想要这样的东西：

```
Orders
  .Expand("StateRef")
  .Select(z => new { ... } ); 
```

# sublimetext2 - 自定义 Sublime Text 2 的“在文件夹中查找...”如何工作

> ID：14782350
> 
> 赞同：2
> 
> 时间：2013-02-08T22:25:13.407
> 
> 标签：sublimetext2

右键单击 Sublime Text 2 项目中的文件夹后，然后选择“在文件夹中查找...”，就是这个菜单：

![在此处输入图像描述](../Images/a8993ad76f76c6305b859820e4593f28.png)

当用户单击右侧的“查找”以仅显示文件名而不是这些文件中的文本时，如何更改输出？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T16:50:31.387

Sublime Text 2 具有 Goto Anything（ Windows 和 Linux 上的**Ctrl+P**，OS X 上的 Command+P）可以在文件之间和文件内快速导航：

1.  **键入文件名的一部分以打开它。**
2.  键入“@”字符，然后按符号开始浏览。
3.  键入“#”在文件中搜索，或键入“:”转到行号。

看到[这里](http://www.sublimetext.com/blog/articles/sublime-text-2-public-alpha)了解更多信息

# python - 有没有一种简单的方法可以在 Python 中实现字符串的自动换行？

> ID：14782352
> 
> 赞同：1
> 
> 时间：2013-02-08T22:25:19.327
> 
> 标签：python, string, math

我有一个简单的控件，它显示一段文本，其中的内容、大小、位置等是通过 Python 控制的。有没有办法在给定宽度的情况下计算控件的准确高度？

现在我正在做：

```
a = total_number_of_characters_in_string
b = max_number_of_characters_in_a_line
h = a/b 
```

但问题不是每一行都被填满，而且还有换行符。

有没有一种简单的方法可以做到这一点？

# linux - curl 发布请求失败

> ID：14782353
> 
> 赞同：0
> 
> 时间：2013-02-08T22:25:24.507
> 
> 标签：linux, post, curl

我正在向我的网站发送一个发布请求：

```
curl --data "param1=value1&param2=value2" http://mysite.com/ 
```

但结果是整个html页面（与用户名和密码无关，无论对错）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T22:27:57.293

尝试

```
`curl -u username:password http://example.com` 
```

登录，或试试这个

```
curl http://username:password@example.com/?param1=xx&param2=xx 
```

# xml - 自定义 Atom 提要中的超链接在提要阅读器中不起作用

> ID：14782356
> 
> 赞同：0
> 
> 时间：2013-02-08T22:25:37.680
> 
> 标签：xml, atom-feed, feedburner

我正在尝试为我的链接博客生成一个 Atom 提要并使用 FeedBurner 分发它。我遇到了一个奇怪的问题，我的服务器上的原始 XML 文件或 FeedBurner 的提要都没有在提要阅读器中显示链接。

希望我可以直接链接这些，因为这是特定提要的问题——常见问题解答并不是很清楚。如果不是，我会很高兴删除链接并粘贴到文件中，但这似乎会给问题增加很多混乱。

我对生成 RSS/Atom 提要不太熟悉，通过验证器运行它表明它通过了。此外，这些链接在 Feedburner 的“前端”页面上显示良好。这就是为什么我不明白为什么 Google Reader 等不显示链接的原因。

事不宜迟，[这里是原始 xml 文件][1] 和 [这里是 feedburner 的结果页面][2]。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T01:11:00.350

Atom 提要中的 XHTML 元素需要指定[正确的 XHTML 名称空间](http://www.w3.org/1999/xhtml)。比较这个版本：

```
<content type="xhtml" xmlns='xmlns="http://www.w3.org/2005/Atom'>
    <div xmlns='http://www.w3.org/1999/xhtml'>
        <p>...</p> 
```

使用当前提要中的命名空间：

```
<content type="xhtml" xmlns='xmlns="http://www.w3.org/2005/Atom'>
    <div>
        <p>...</p> 
```

# jquery - 如何更改 jquery 插件的属性

> ID：14782357
> 
> 赞同：0
> 
> 时间：2013-02-08T22:25:50.160
> 
> 标签：jquery, jquery-plugins, attributes

例如，我有 jquery 插件，我调用了一个带有一些属性的 init 方法，如下所示：

```
jQuery(document).ready(function($) {
    $('#someid').somePlugin({
                           animation : 'fadeIn',
                           speed : '1000',
                           easing : 'swing'
                        });
}); 
```

假设我在页面上也有 html 链接。是否可以通过单击例如 html 链接以某种方式更改此插件的 init 函数的属性值？
因此，通过单击我想要更改速度属性的链接而不刷新页面。如果可能，执行此操作的最佳方式是什么？

或者，也许我应该先更改插件代码中的某些内容。插件代码：

```
(function($) {
    $.fn.extend({
        somePlugin: function(options) {

            var defaults = {
                speed : 500,
                animation : 'fadeIn',
                easing : false
            }

            var options = $.extend(defaults, options);
            var speed = options.speed;
            var easing = options.easing;
            var animation = options.animation;

            return this.each(function() {
                var obj = $(this);
                //some action here 
            });
        }   
    });
})(jQuery); 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-08T22:27:35.777

是的，你可以这样做：

```
$('#someid').somePlugin('option', 'animation', 5000); 
```

此外，您可以通过以下方式一次更改多个选项：

```
$('#someid').somePlugin('option', {animation: 5000, otherOption: 'blah'}); 
```

我应该提到这仅在您使用“官方” jQuery 插件*时才有效。*许多插件作者都遵循这种设计模式，但并非所有人都这样做。此外，如果您使用[jQuery UI Widget Factory](http://jqueryui.com/widget/)开发插件，您将免费获得此功能。

* * *

编辑：由于 OP 正在编写他自己的插件，我们可以展示一个示例，说明如何使用自定义插件来促进此功能。直接取自[jQuery 插件创作页面](http://docs.jquery.com/Plugins/Authoring#Plugin_Methods)：

```
(function( $ ){
  var methods = {
    init : function( options ) { 
      //Extend options here with your 
      //defaults and init your plugin
    },
    option: function( key, value ){
       options[key] = value;
    }
  };

  $.fn.somePlugin = function( method ) {
    // Method calling logic
    if ( methods[method] ) {
      return methods[ method ].apply( this, Array.prototype.slice.call( arguments, 1 ));
    } else if ( typeof method === 'object' || ! method ) {
      return methods.init.apply( this, arguments );
    } else {
      //some error that method doesnt exist
    }    

  };

})( jQuery );

$('div').somePlugin({someOption: true});
//..later
$('div').somePlugin('option', 'someOption', false); 
```

# jpa - 识别给定需求的 Java EE 规范集 - EJB、JPA 和 REST 的案例？

> ID：14782360
> 
> 赞同：0
> 
> 时间：2013-02-08T22:26:15.160
> 
> 标签：jpa, ejb-3.0, jax-rs, websphere-8

我正在尝试确定正确的技术集来开发支持以下内容的应用程序。

1.  提供web服务能力（最好是REST）
2.  能够在单个事务中处理多个数据资源的更新
3.  具备一定的表单持久化能力。

基于这些基本需求，我目前的计划是构建一个基于 REST 的服务，使用 JAX-RS 和 JPA 来处理持久性，并使用 EJB 能够在单个事务中处理对不同资源的多个更新。

这些是正确的技术集，还是我让我的应用程序变得更庞大。

感谢您的任何建议。最后，应用程序将部署在 Websphere Application Server v8.5 上

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:12:41.977

是的，这些听起来像是您项目的合理技术选择。Java EE 的所有部分都提供了许多其他不错的功能，因此它为您的应用程序“增长”提供了一些空间，而不必担心被来自不同供应商的大量库所困扰。在我看来，使用 Java EE 并不是担心“笨重”的唯一原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T12:49:12.403

由于该应用程序将部署到 WebSphere Application Server V8.5 上，因此如果它们已经是运行时环境的一部分，则无需使用可用技术来限制自己。

话虽如此，但我想到了将开发应用程序的开发人员，并且可能会因频繁重启、重新部署等所花费的时间而受苦。并不是说 WAS 8.5 不能处理它们，但由于它是一个用于生产环境的成熟应用程序服务器，它可能对您的开发环境来说太过分了。如果是这样，请继续阅读。

有一个更轻量级的 WAS 配置文件可用 - [WebSphere Application Server 8.5 Liberty Profile](http://wasdev.net)。它基于 WebSphere AS 的代码库，占用空间小，正好适合知道部署平台是 WAS 的客户，但他们需要在他们的开发笔记本电脑上使用更轻的解决方案。

它可能非常适合您的需求，如果 Eclipse 是 IDE，您可能会惊喜地发现使用 Liberty Profile 后开发环境变得更加精简。

# playframework-2.0 - 如何解决播放框架2中的错误读取注释

> ID：14782362
> 
> 赞同：1
> 
> 时间：2013-02-08T22:26:18.747
> 
> 标签：playframework-2.0

这是我的项目链接 [https://github.com/jstar88/LibreTitan](https://github.com/jstar88/LibreTitan)

我在 localhost 中编译了这个异常：play framework 2.1

> 意外异常

RuntimeException: Error reading annotations for models.User 没有可用的源，这里是异常堆栈跟踪：

->java.lang.RuntimeException：读取模型的注释时出错。用户

```
 com.avaje.ebeaninternal.server.deploy.parse.ReadAnnotations.readAssociations(ReadAnnotations.java:54)

 com.avaje.ebeaninternal.server.deploy.BeanDescriptorManager.readDeployAssociations(BeanDescriptorManager.java:1034)

 com.avaje.ebeaninternal.server.deploy.BeanDescriptorManager.readEntityDeploymentAssociations(BeanDescriptorManager.java:565)

 com.avaje.ebeaninternal.server.deploy.BeanDescriptorManager.deploy(BeanDescriptorManager.java:252)

 com.avaje.ebeaninternal.server.core.InternalConfiguration.<init>(InternalConfiguration.java:124)

 com.avaje.ebeaninternal.server.core.DefaultServerFactory.createServer(DefaultServerFactory.java:210)

 com.avaje.ebeaninternal.server.core.DefaultServerFactory.createServer(DefaultServerFactory.java:64)

 com.avaje.ebean.EbeanServerFactory.create(EbeanServerFactory.java:59)

 play.db.ebean.EbeanPlugin.onStart(EbeanPlugin.java:79)

 play.api.Play$$anonfun$start$1$$anonfun$apply$mcV$sp$1.apply(Play.scala:63)

 play.api.Play$$anonfun$start$1$$anonfun$apply$mcV$sp$1.apply(Play.scala:63)

 scala.collection.immutable.List.foreach(List.scala:309)

 play.api.Play$$anonfun$start$1.apply$mcV$sp(Play.scala:63)

 play.api.Play$$anonfun$start$1.apply(Play.scala:63)

 play.api.Play$$anonfun$start$1.apply(Play.scala:63)

 play.utils.Threads$.withContextClassLoader(Threads.scala:18)

 play.api.Play$.start(Play.scala:62)

 play.core.ReloadableApplication$$anonfun$get$1$$anonfun$1.apply(ApplicationProvider.scala:133)

 play.core.ReloadableApplication$$anonfun$get$1$$anonfun$1.apply(ApplicationProvider.scala:106)

 scala.Option.map(Option.scala:145)

 play.core.ReloadableApplication$$anonfun$get$1.apply(ApplicationProvider.scala:106)

 play.core.ReloadableApplication$$anonfun$get$1.apply(ApplicationProvider.scala:104)

 scala.util.Either$RightProjection.flatMap(Either.scala:523)

 play.core.ReloadableApplication.get(ApplicationProvider.scala:104)

 play.core.server.Server$class.sendHandler$1(Server.scala:56)

 play.core.server.Server$$anonfun$getHandlerFor$4.apply(Server.scala:88)

 play.core.server.Server$$anonfun$getHandlerFor$4.apply(Server.scala:87)

 scala.util.Either$RightProjection.flatMap(Either.scala:523)

 play.core.server.Server$class.getHandlerFor(Server.scala:87)

 play.core.server.NettyServer.getHandlerFor(NettyServer.scala:34)

 play.core.server.netty.PlayDefaultUpstreamHandler.messageReceived(PlayDefaultUpstreamHandler.scala:103)

 org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:75)

 org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:565)

 org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:793)

 org.jboss.netty.handler.codec.http.HttpContentDecoder.messageReceived(HttpContentDecoder.java:104)

 org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:75)

 org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:565)

 org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:793)

 org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:296)

 org.jboss.netty.handler.codec.frame.FrameDecoder.unfoldAndFireMessageReceived(FrameDecoder.java:455)

 org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:538)

 org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:437)

 org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:75)

 org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:565)

 org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:560)

 org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:268)

 org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:255)

 org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:84)

 org.jboss.netty.channel.socket.nio.AbstractNioWorker.processSelectedKeys(AbstractNioWorker.java:472)

 org.jboss.netty.channel.socket.nio.AbstractNioWorker.run(AbstractNioWorker.java:333)

 org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:35)

 org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:102)

 org.jboss.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:42)

 java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)

 java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)

 java.lang.Thread.run(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-11-03T15:10:14.513

当我在字段中使用`@MappedSuperclass`Class时遇到了这个问题。`List<?>`更改它以`@Entity`使异常消失。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-04-17T14:13:46.157

在类的顶部添加@Entity

# mediawiki - mediawiki 的外部自动建议扩展？

> ID：14782371
> 
> 赞同：1
> 
> 时间：2013-02-08T22:27:15.310
> 
> 标签：mediawiki

我有一个带有支持表单的应用程序，客户可以使用它来提交新问题。要求的一件事是搜索他们的公共 wiki 并根据它自动创建建议（与 SO 所做的非常相似）。由于有问题的页面在 MediaWiki 本身之外，我不确定如何继续前进。

我的问题是双重的：

是否有开箱即用的扩展来做这种事情？如果没有，你会建议我怎么做？我从来没有写过 MediaWiki 扩展，但是对于你们当中有经验的人，你会采取什么方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:39:40.207

我不知道这样的东西是否已经存在。但如果我必须从头开始，我肯定会继续使用[mediawiki API](https://www.mediawiki.org/wiki/API%3aSearch)。这里的例子：

显示包含单词 MYSEARCHTEXTGOESHERE 的 10 个页面的列表

```
http://mywiki.org/wiki/api.php?action=query&list=search&srsearch=MYSEARCHTEXTGOESHERE&srprop=timestamp 
```

它不会是 wiki 中的扩展，而是从您的应用程序对 wiki 服务器的 GET 调用。

# c - 导致无限输出的管道

> ID：14782372
> 
> 赞同：0
> 
> 时间：2013-02-08T22:27:20.550
> 
> 标签：c, posix, pipe

当我简单地通过管道 ls -l | 用这个排序，程序只是无限地从 ls -l 吐出结果。任何人都可以看到有什么问题吗？假设您只需要查看 main 函数。不过，这将编译。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <fcntl.h>
#include <errno.h>
#include <sys/wait.h>

#define COMMAND_LINE_LENGTH 256
#define HISTORY_LENGTH 10
#define TOKEN_MAX 50
#define DIRECTORY_LENGTH 5
#define DIRECTORY_PREFIX "/bin/"

struct prog_def
{
    //Binary location
    char *bin;

    //Is this program expecting a pipe?
    int expecting_pipe;

    //Arguments
    char *args[TOKEN_MAX + 1];

    pid_t pid;

} prog_def;

int get_prog_defs(const char* buf, struct prog_def prog_defs[])
{
    char *line = malloc(strlen(buf) + 1);

    int prog_count = 0;
    char* token;

    strcpy(line, buf);
    line[strlen(buf)] = 0;

    while(1)
    {
        int arg_count = 0;

        //The first time through we have to pass the line
        token = strtok(line, " ");

        //Each subsequent call we have to pass NULL
        //http://www.cplusplus.com/reference/cstring/strtok/
        line = NULL;

        //Start building the binary location string
        prog_defs[prog_count].bin = (char*)malloc(strlen(token) + DIRECTORY_LENGTH + 1);

        //Concatenate the directory prefix and command name
        strcat(prog_defs[prog_count].bin, DIRECTORY_PREFIX);
        strcat(prog_defs[prog_count].bin, token);

        //The first argument execvp will expect is the binary location itself
        //Redundant but if I wasn't too lazy to read the doc then I'd know why
        prog_defs[prog_count].args[arg_count++] = prog_defs[prog_count].bin;

        while(1)
        {
            prog_defs[prog_count].expecting_pipe = 0;

            //Check next token for end, pipe, IO redirection, or argument
            token = strtok(NULL, " ");

            //If we've consumed all tokens
            if (token == NULL)
                break;

            //Pipe
            if (strcmp(token, "|") == 0)
            {
                prog_defs[prog_count - 1].expecting_pipe = 1;
                break;
            }

            //Regular argument
            prog_defs[prog_count].args[arg_count++] = token;
        }

        ++prog_count;

        if (token == NULL) break;
    }

    return prog_count;
}

int main(int argc, char** argv)
{

    char command[COMMAND_LINE_LENGTH] = {0};

    //Generic loop counter
    int x = 0;

    while(1)
    {
        printf(">");

        //Get the command
        gets(command);

        struct prog_def prog_defs[TOKEN_MAX];
        int prog_count = get_prog_defs(command, prog_defs);

        //Keep the previous out fd for the in of the subsequent process
        int prev_out_fd = open("/dev/null", O_RDONLY);

        for (x = 0; x < prog_count; ++x)
        {
            //Create a pipe for both processes to share
            int pipefd[2];

            if (x != prog_count -1)
            {
                pipe(pipefd);
            }

            prog_defs[x].pid = fork();

            if(prog_defs[x].pid == 0)
            {
                dup2(prev_out_fd, STDIN_FILENO);
                close(pipefd[1]);

                if(x != prog_count - 1)
                {
                    dup2(pipefd[1], STDOUT_FILENO);
                    close(pipefd[0]);
                    close(pipefd[1]);
                }

                execvp(prog_defs[x].bin, prog_defs[x].args);
            prev_out_fd = pipefd[0];
            close(pipefd[1]);
            }

        close(prev_out_fd);

            prev_out_fd = pipefd[0];
            close(pipefd[1]);

        }

        printf("\n");

        for (x = 0; x < prog_count; ++x)
        {
            waitpid(prog_defs[x].pid, NULL, 0);
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T00:43:30.413

您调用`malloc`为字符串获取一些内存，该字符串将未初始化，因此包含随机垃圾。然后，您调用`strcat`which 将尝试将另一个字符串附加到随机垃圾中，并且几乎可以肯定会跑出 malloc 空间的末尾，从而导致随机的混乱行为和崩溃。

您还使用`prog_defs[prog_count - 1]`before ever incrementing `prog_count`，因此第一次通过循环时， (when `prog_count == 0`) 这将在数组开始之前写入，这也会导致随机的混乱行为和崩溃。

# python - 如何从烧瓶中捕获数据并将其发送到其他python函数

> ID：14782377
> 
> 赞同：0
> 
> 时间：2013-02-08T22:27:39.580
> 
> 标签：python, flask

所以这就是我想做的事情。我想捕获来自用户的响应（我从 web gui 获取来自用户的响应），然后将这些响应发送到不同的 python 函数进行处理。

所以这就是流程的样子

```
 Program ---> Flask APp --|
   /\                     |
    |_____________________| 
```

我的程序是这样的：

```
def call_flask():
    call_hello() 
```

和

```
 def call_hello():

    data = request.form
    for data_tuple in data:

         requests[data_tuple] = data[data_tuple]

    return render_template('request_submitted.html') 
```

我有兴趣向主程序发送“请求”吗？什么是干净的方法来做到这一点..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T07:25:53.647

不知道我是否理解正确...这个“程序”是完全不同的东西，而不是您所说的网络界面？如果这是完全不同的事情，那么您实际上可以做什么 - 在烧瓶完成请求后，您可以拥有执行您想要的功能。因此，如果“程序”位于同一台机器的某个位置，您可以调用进程来运行，或者它以某种方式启动它。

Flask 确实有[after_request](http://flask.pocoo.org/docs/api/#flask.Flask.after_request)函数，它告诉每个请求完成后需要做什么。这里可能是一个调用“程序”的好地方。但是当然你需要知道你想怎么打电话。我可以想象您使用 json 有效负载调用其他 url，或者只是使用参数调用系统应用程序。但这取决于你:)

但是，如果“程序”只是您正在谈论的 web gui，那么您显然只是渲染模板并将一些变量返回给它，以进行渲染。

希望我的问题是对的；）

# c# - VPN 中的服务器名称相同

> ID：14782379
> 
> 赞同：0
> 
> 时间：2013-02-08T22:27:43.797
> 
> 标签：c#, .net, visual-studio-2010, vpn

我的 .NET 解决方案必须可以从某个**[http://customservername.com](http://customservername.com)** URL 访问，并且它在所有项目的属性中都将此行作为起始 URL。我在本地 PC 下运行它所做的是创建一个名为**customservername.com**的虚拟 Web 文件夹，并在主机文件中写入**“127.0.0.1 customservername.com”**行。该站点的数据库放置在我可以使用 VPN 连接到的其他网络中，因此我需要 VPN 以使该站点正常运行。
但是，启动解决方案时出现“无法在 Web 服务器上开始调试...”错误。如果我不连接到 VPN，那么一切运行良好，但无法访问数据库。
我发现远程网络有**customservername.com**工作主机，这给了我一个想法，即 VS 以某种方式试图在那里发布解决方案。为什么会这样？我确实在“主机”中有一行。我应该如何解决问题？有任何想法吗？
谢谢！

# msbuild - 在 Visual Studio 2012 解决方案资源管理器中设置项目的根目录

> ID：14782381
> 
> 赞同：2
> 
> 时间：2013-02-08T22:27:55.923
> 
> 标签：msbuild, visual-studio-2012

*只需切换“显示所有文件”*按钮，即可将 Visual Studio 2012 的解决方案资源管理器配置为显示磁盘上的实际文件（而不仅仅是项目文件） 。每个项目将显示与项目文件本身位于同一文件夹中的文件和文件夹。

有什么办法可以改变显示的根目录吗？

我的跨平台项目是这样组织的：

```
project/ide/vs2012/project.sln
project/ide/vs2012/project.vcxproj
project/src/* 
```

我希望解决方案资源管理器显示我的`src`目录中的文件，而不是我的`vs2012`目录。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T16:09:37.207

我在目录下创建了一个符号链接`vs2012`来指向我的源代码：

```
MKLINK /D src ..\src 
```

现在 Visual Studio 会看到`src`项目下方的文件夹。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-08T22:31:08.763

我认为，如果我理解正确，您应该在记事本应用程序中打开项目根目录下的 .sln 文件，您会在其中找到所需的内容。

# c - ctime 给出不正确的输出

> ID：14782384
> 
> 赞同：2
> 
> 时间：2013-02-08T22:28:14.737
> 
> 标签：c, linux

[**ctime()**](http://www.kernel.org/doc/man-pages/online/pages/man3/ctime.3.html)函数应该以字符串格式给出自 Epoch 以来传入的秒数。这是我的代码：

```
#include<stdio.h>
#include<stdlib.h>
#include<time.h>

int main(int argc, int **argv)
{
    time_t tmp=86400; // Seconds for one day
    char *s;
    s = ctime(&tmp);
    if(!s) perror("ctime");
    else printf("%s", s);
    return 0;
} 
```

该程序在我的 Ubuntu 12.04 32 位机器上给出了正确的输出：

```
Fri Jan  2 01:00:00 1970 
```

但同样的代码在我的 Scientific Linux 64 位机器上给出了错误的输出：

```
Thu Jan  1 16:00:00 1970 
```

显然，根据这台机器 Epoch 是：

```
Wed Dec 31 16:00:00 1969 
```

知道为什么 Scientific Linux 6 会给出错误的输出吗？！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T01:32:10.693

一个`time_t`值总是 [1] 表示自纪元以来的秒数，即 1970-01-01 00:00:00 UTC - 加上或减去确认我们可能忽略闰秒所需的任何挥手。所以`(time_t)86400`代表一个单一的时刻，无论您当前的时区如何。

该`ctime()`函数返回一个指针，该指针指向以*本地*时间表示的格式不正确的 [2] 字符串。我在 UTC 以西 8 小时，所以在我的系统上，您的程序输出是：

```
Thu Jan  1 16:00:00 1970 
```

（纪元加上你的 24 小时`86400`，我的时区减去 8 小时）。

系统对当前时区的想法可以通过多种方式中的任何一种来确定。在我的 Ubuntu 系统上，`/etc/timezone`包含`America/Los_Angeles`. 在 CentOS 上，应该类似于 Scientific Linux，`/etc/localtime`是一个二进制时区数据文件。

在这两个系统上，可以通过设置`$TZ`环境变量来覆盖系统默认时区，使用`UTC`或空字符串表示 UTC。如果我设置`$TZ`为`UTC`or `""`，您的程序的输出是：

```
Fri Jan  2 00:00:00 1970 
```

时代总是历史上的同一时刻，但可以用不同的方式表达。例如（使用 GNU Coreutils`date`命令，显示纪元本身，而不是像您的程序那样显示纪元后 24 小时）：

```
$ date -d @0
Wed Dec 31 16:00:00 PST 1969
$ date -u -d @0
Thu Jan  1 00:00:00 UTC 1970
$ TZ=UTC date -d @0
Thu Jan  1 00:00:00 UTC 1970
$ TZ= date -d @0
Thu Jan  1 00:00:00 UTC 1970
$ 
```

请注意，如果您在英国，则您的当地时间仅在一年中的部分时间与 UTC 匹配。

[1] 嗯，几乎总是。POSIX 保证一个`time_t`值表示自纪元以来的秒数，但 C 标准只说它是一种能够表示时间的算术类型。你可以在一个`time_t`对象中存储你喜欢的任何值，并让它代表你喜欢的任何值，但是所有处理`time_t`值的标准 C 和 POSIX 函数都将它们视为自纪元以来的秒数。

`ctime()`[2] 由于历史原因， and产生的格式`asctime()`相当尴尬。它的形式`Sun Sep 16 01:03:52 1973\n\0`。注意缺少任何时区信息；尾随`'\n'`也可能令人困惑（因此，我在日志文件中看到了无关的空白行）。该[`strftime()`](http://linux.die.net/man/3/strftime)功能为您提供了更多的灵活性。我建议尽可能使用[ISO 8601格式。](http://en.wikipedia.org/wiki/ISO_8601)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T22:30:28.567

秒数应为 UTC - 自 1970 年 1 月 1 日 00:00 小时以来经过的秒数 UTC

查看 time_t 的描述：

[http://www.cplusplus.com/reference/ctime/time_t/](http://www.cplusplus.com/reference/ctime/time_t/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T22:43:21.337

您参考的手册页说

> ctime()、gmtime() 和 localtime() 函数都采用数据类型 time_t 的参数，它表示**日历时间**。当解释为绝对时间值时，它表示自 Epoch 1970-01-01 00:00:00 +0000 (UTC) 以来经过的秒数。

这[是一些 ctime 实现](http://opensource.apple.com/source/Libc/Libc-186/gen.subproj/ctime.c)

```
char *
ctime(timep)
const time_t * const    timep;
{
    return asctime(localtime(timep));
} 
```

如您所见，它使用本地时间，即相对于当前进程的时区的时间。

# ios - XCode：尝试下载开发证书时的 UNIX [权限被拒绝]

> ID：14782385
> 
> 赞同：3
> 
> 时间：2013-02-08T22:28:19.447
> 
> 标签：ios, xcode, macos, osx-mountain-lion, xcode4.6

我正在尝试通过创建签名证书来配置我的 iOS 设备以使用 Xcode 4.6 进行开发。我已尝试按照技术说明 TN2250 [https://developer.apple.com/legacy/library/technotes/tn2250/_index.html](https://developer.apple.com/legacy/library/technotes/tn2250/_index.html)中的“配置配置文件刷新”中的说明进行操作。但是，当我点击“刷新”并使用我的 Apple Developer 帐户登录时，它似乎试图检索“正在下载开发证书......”然后突然死亡并出现“错误，无法导入证书。（UNIX [权限拒绝]）”。我以前可以很好地编辑我的 OS X 钥匙串，为什么 Xcode 现在无法添加到它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-12-10T07:39:39.283

如果有人从一些谷歌搜索到这里。我对“UNIX [Permission denied]”有类似的问题。事实证明，不知何故我搞砸了一些文件夹权限，但我不知道是哪一个。我遵循了另一个建议：

1.  在 Mac 上创建新的管理员帐户
2.  登录该帐户，将您的解决方案复制到主文件夹
3.  打开 Xcode 并使用您的 Apple id 登录并下载所有证书（在项目设置中转到签名并选择复选框“自动管理签名”）
4.  构建你的项目——它现在应该可以工作了

这在 Xcode 13.1 和 macOS 11.6 上对我有用

# facebook-comments - Facebook评论框不显示

> ID：14782386
> 
> 赞同：0
> 
> 时间：2013-02-08T22:28:22.177
> 
> 标签：facebook-comments, comments

我只是在阅读社交插件，我正在尝试点赞按钮和来自 facebook 的评论框。带有“赞”按钮的所有内容都可以正常工作，并且设置起来很容易，但是当我尝试让评论框工作时，什么都不会出现。

我将 Facebook sdk 放在 body 标签打开之后，并尝试了类似问题的建议，并将其放在结束 body 标签之前。这些“解决方案”都没有帮助解决我的问题

关于我的网站的一些信息，它是本地的，用于测试目的。

如果您需要我的 html 页面，它是：

```
<!DOCTYPE html>
<html lang="en">
  <head>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="language" content="english"> 
    <meta http-equiv="Content-Style-Type" content="text/css">

    <title>ATCC BPA</title>

    <link rel="stylesheet" href="site2.css">

  </head>
  <body>
    <div id="fb-root"></div>
    <script>(function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=13855310161";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>

    <div id="container">

      <h1 id="header">
        Alexandria Technical and Community College<br>
        Business Professionals of America<br>
        2012-2013
      </h1>

      <ul id="nav">
        <li><a href="index.html">Home</a></li>
        <li><a href="members.html">Members</a></li>
        <li><a href="officers.html">Officers</a></li>
        <li><a href="torch.html">Torch</a></li>
        <li><a href="calendar.html">Calendar</a></li>
        <li><a href="events.html">Events</a></li>
        <li><a href="photos.htlm">Photos</a></li>
      </ul>

      <div id="content">
        <p>
          Text can go here about your page <br/>
          about anything going on, and can even incorperate a facebook comment section.
        </p>
      </div>

      <div class="fb-comments" data-href="http://www.alextechbpa.com" data-width="470" data-num-posts="10" data-colorscheme="dark"></div>

      <div id="footer">
        <span id="email">email</span> 
        <span id="facebook">
          <iframe src="http://www.facebook.com/plugins/like.php?href=www.alextechbpa.com" scrolling="no" frameborder="0">
          </iframe>
        </span>
      </div><!-- end footer div-->

      </div><!-- end #container-->
    </body>
 </html> 
```

感谢任何人可以为我提供的任何建议或帮助！任何其他信息我都会尽力提供！

# oauth - clojure - 找不到错误？

> ID：14782392
> 
> 赞同：1
> 
> 时间：2013-02-08T22:28:40.097
> 
> 标签：oauth, clojure, leiningen

我现在正在尝试 HOURS 并且无法找出问题所在。我是 clojure 的新手，并尝试制作一个简单的 flickr 客户端。但是我对不同的库有这个问题......我想我犯了一个普遍的错误。

目前我尝试在这个库中使用 oauth：[https ://github.com/mattrepl/clj-oauth](https://github.com/mattrepl/clj-oauth)

```
lein new projectname 
```

我的 project.clj 看起来像这样：

```
(defproject flickr "0.1.0-SNAPSHOT"
:description "FIXME: write description"
:url "http://example.com/FIXME"
:license {:name "Eclipse Public License"
          :url "http://www.eclipse.org/legal/epl-v10.html"}
:dependencies [[org.clojure/clojure "1.4.0"]
               [clj-oauth "1.4.0"]]) 
```

添加 clj-oauth2 后，我运行：

```
 lein deps 
```

还有我的 core.clj：

```
 (ns flickr.core)
  (require ['oauth.client :as 'oauth])

 (def consumer-key "0000")
 (def consumer-secret "0000")

 (def consumer (oauth.client/make-consumer <consumer-token>
                               <consumer-token-secret>                            
                               "http://www.flickr.com/services/oauth/request_token"
                               "http://www.flickr.com/services/oauth/access_token"
                               "http://www.flickr.com/services/oauth/authorize"
                                :hmac-sha1)) 
```

当我现在尝试运行它时：

```
 lein run 
```

我得到：

```
 FileNotFoundException Could not locate oauth/client__init.class or oauth/client.clj on classpath:   clojure.lang.RT.load (RT.java:432) 
```

有谁知道问题出在哪里？还从 github repo 下载了 oauth 源，构建它并将其添加到我的 $PATH 变量中，但仍然是相同的错误。

任何帮助，将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:02:06.680

首先，`lein run`查找一个主命名空间，其名称必须在`project.clj`使用`:main`键中指定；**在那里****添加`:main flickr.core`**。

然后你需要一个`-main`函数`flickr.core`。更改命名空间声明并添加函数，如下所示：

```
(ns flickr.core
  (:require [clj-oauth2.client :as oauth]))

(defn -main []
  (println oauth/get-access-token)) 
```

然后，

```
$ lein run
;=> #<client$get_access_token clj_oauth2.client$get_access_token@4c9549af> 
```

这对我来说是一种“命名空间冒烟测试”，你应该可以从那里开始。

（最后一点，如果你在 REPL 中测试这些东西，而不是使用 'lein run'，你的开发速度会快得多。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T23:12:21.447

您的依赖项似乎存在混淆。根据 Clojars 的说法，您使用的库`clj-oauth2`是这个 GitHub 项目[https://github.com/DerGuteMoritz/clj-oauth2](https://github.com/DerGuteMoritz/clj-oauth2)，而不是您在问题中链接到的那个。

如果您想要 latest `clj-oauth`，那么依赖项应该是`[clj-oauth "1.4.0"]`（对于最新版本）。如果你需要`clj-oauth2`，那么上面的 GitHub 链接应该是参考。

# xcode - XCode 不会摆脱重命名的静态库的剩余内存

> ID：14782393
> 
> 赞同：0
> 
> 时间：2013-02-08T22:28:42.103
> 
> 标签：xcode

我有一个包含项目和静态库的工作区。

该库最初称为 A，然后我将其重命名为 B。但是后来我改变了主意，将其重命名为 A。

现在的问题是 Xcode 只在 Link Binary With Libraries 中列出了 liblB.a，我根本无法让它消失并让 liblA.a 重新出现，即使我已将其重命名为 A。

在 XCode 中，目标的名称是 A，构建设置中的产品名称的名称也是 A。我在任何地方都没有任何对任何名为 B 的任何引用 AFAIK 或我能找到的任何东西。

我已经清理了所有内容并再次清理，删除了 Organizer 中的派生数据，关闭并重新启动了 XCode（这通常是解决此类问题的一种非常有效的方法）。

当我构建它成功构建的库并且 XCode 说“构建 A：成功”时，它不会说“构建 B：成功”。

我以前见过这种问题，XCode 在摆脱对不再存在的事物的引用时遇到问题，通常的解决方案是清理并关闭 XCode。但这一次行不通。关于如何让 XCode 忘记名称 B 并堆叠 A 的任何其他建议？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:34:35.563

*   提交你的代码
*   关闭 Xcode
*   使用您喜欢的文本编辑器打开 xcodeproj 文件
*   查找对不需要的名称的所有引用并将它们删除或将它们更改为所需的名称
*   打开 Xcode 并测试
*   如果一切正常，请提交您的代码。否则，请更仔细地还原并重试。

通常，简单的手动编辑 xcodeproj 工作正常，尤其是重命名或删除内容。添加新内容更难。

# objective-c - 当没有其他引用保留对象时，如何将 id 对象安全地存储在 ARC 下的 C++ void* 成员中？

> ID：14782395
> 
> 赞同：16
> 
> 时间：2013-02-08T22:28:43.753
> 
> 标签：objective-c, casting, automatic-ref-counting, void-pointers

我正在使用 Box2D (C++)，我创建了一个 Objective-C 对象并将其分配给 Box2D 主体的`userData`属性，该属性的类型为`void*`.

现在在某些情况下，`void* userData`可能是对该 ObjC 对象的唯一活动引用。因此，因为我`(__bridge void*)`在作业中使用了ARC，所以放手了。这是我需要解决的问题。

我一直在思考防止这种情况发生的选项？我阅读了[Clang 的 ARC 文档](http://clang.llvm.org/docs/AutomaticReferenceCounting.html#arc-objects-restrictions-conversion)，特别是关于桥梁铸造的部分（以及关于 SO 的问答）以及对他们认为“格式错误”的各种桥梁铸造结构点头。

不过，我的第一个想法是`(__bridge_retained void*)`在对 userData 的初始分配中使用。但这让我想知道如何平衡保留？我显然不能向对象发送释放。

那么我必须要`CFRelease()`对象吗？还是需要`CFBridgingRelease()`？还是在这里都是非法的？

`(__bridge_transfer void*)`从`userData`临时 id 类型转换是否足够，可能在之后将 userData 设置为 NULL 时？这甚至是个好主意吗？

我知道另一种方法是为对象保留一个单独的`NSArray`/并使它们与 Box2D 主体的生命周期保持同步，与它们的 Box2D 主体同步添加和删除它们。`NSDictionary``userData`

但这感觉有点矫枉过正，因为在这里我知道我在做什么，我知道`+1`只要 Box2D 主体处于活动状态，我就需要该对象，而`-1`当 Box2D 主体被移除时，我需要该对象。另外，我知道只有两种方法可以添加和删除 Box2D 主体，并且`userData`在我的框架中甚至无法直接访问，因为所有 Box2D 对象都隐藏在 Objective-C 接口/包装器后面。

暂时将可能“格式不正确”放在一边，您建议我在这种情况下应该做什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-08T22:38:21.770

`__bridge_retained`意思是“通过保留此 ARC 对象将其发送到无 ARC 区域”。当您需要创建“未跟踪”时，您可以调用它`void *`。所以，在你的情况下，`userData = (__bridge_retained void *)obj`.

`__bridge_transfer`意思是“通过释放它把这个物体从无弧的土地上拉回来”。当您想要有效地使`void *`. 所以，`obj = (__bridge_transfer id)userData`。在此之后，`userData`指针就不能安全使用了；相反，您只使用`obj`. 当`obj`超出范围时，ARC 将最后一次释放它。`id`这可能需要专门为此目的创建一个临时文件。

因此，在您的情况下，您确实希望在`__bridge_retained`将对象运送到 Box2D 时使用，并`__bridge_transfer`在您想要使`userData`. 如果您需要`userData`作为 Objective-C 对象访问但不使指针无效，请使用 plain `__bridge`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T23:04:25.817

您误解了文档作者对“格式错误”的含义。这是格式错误的：

```
NSData* data; // Initialized
NSData* data2= (__bridge NSData*) data; 
```

这也是格式不正确的：

```
void* data; // Initialized
void* data2= (__bridge void*) data; 
```

这不是格式错误的：

```
NSData* data; // Initialized
void* data2= (__bridge void*) data; 
```

不病态就足够了，左值是可保留的，右值是不可保留的，反之亦然。因此，由于在您的情况下您将对象指针转换为原始指针，反之亦然，您的方法是正确的。

在您的位置，我将实现一个智能指针，该指针在构造时发送 CFBridgingRetain 消息，在销毁时发送 CFBridgingRelease 消息。

# mule - Mule 3.3.0 - 全局属性未从属性文件中解析

> ID：14782396
> 
> 赞同：5
> 
> 时间：2013-02-08T22:28:58.510
> 
> 标签：mule

全局属性未从属性文件中解析，因此 mmc 部署失败。任何想法为什么可能是错的？

```
<context:property-placeholder location="airports.properties" />
<global-property name="airportslist" value="${airportslist}" /> 
```

得到以下异常——

```
com.mulesoft.mmc.agent.v3.dto.DeploymentException：从 URL [file:/arprt/mule-esb-ee/mule-enterprise-standalone-3.3.0/apps/myapp-1.0.0 解析 XML 文档时出现意外异常-SNAPSHOT/myapp-config.xml]；嵌套异常是 java.lang.IllegalArgumentException: 无法解析占位符 'airportslist' (org.mule.api.lifecycle.InitialisationException) (org.mule.api.config.ConfigurationException)
        在 com.mulesoft.mmc.agent.service.impl.ApplicationServiceImpl.deploy(ApplicationServiceImpl.java:245)
        在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

```

airports.properties 包含上述属性：

```
 airportslist={'SFO', 'YYZ', 'DFW'} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T22:31:07.907

如果`global-property`属性在属性文件中定义并使用`context:property-placeholder`.

只需删除：

```
<global-property name="airportslist" value="${airportslist}" /> 
```

并`${airportslist}`在配置中需要它的任何地方使用。

# lines - 检查线是否相交，如果相交，则返回坐标

> ID：14782398
> 
> 赞同：1
> 
> 时间：2013-02-08T22:29:08.460
> 
> 标签：lines, intersect

我在下面编写了一些代码来检查两条线段是否相交以及它们是否相交来告诉我在哪里。作为输入，我有每条线两端的 (x,y) 坐标。它似乎工作正常，但现在在 A 线 (532.87,787.79)(486.34,769.85) 和 B 线 (490.89,764.018)(478.98,783.129) 的情况下，它说它们在 (770.136, 487.08) 处相交根本不相交。

有谁知道下面的代码中有什么不正确的？

```
double                      dy[2], dx[2], m[2], b[2];
double                      xint, yint, xi, yi;
WsqT_Location_Message       *location_msg_ptr = OPC_NIL;

FIN (intersect (<args>));

dy[0] = y2 - y1;
dx[0] = x2 - x1;
dy[1] = y4 - y3;
dx[1] = x4 - x3;

m[0] = dy[0] / dx[0];
m[1] = dy[1] / dx[1];
b[0] = y1 - m[0] * x1;
b[1] = y3 - m[1] * x3;

if (m[0] != m[1])
{
    //slopes not equal, compute intercept
    xint = (b[0] - b[1]) / (m[1] - m[0]);
    yint = m[1] * xint + b[1];

    //is intercept in both line segments?
    if ((xint <= max(x1, x2)) && (xint >= min(x1, x2)) &&
        (yint <= max(y1, y2)) && (yint >= min(y1, y2)) &&
        (xint <= max(x3, x4)) && (xint >= min(x3, x4)) &&
        (yint <= max(y3, y4)) && (yint >= min(y3, y4)))
    {
        if (xi && yi)
        {
            xi = xint;
            yi = yint;

            location_msg_ptr = (WsqT_Location_Message*)op_prg_mem_alloc(sizeof(WsqT_Location_Message));

            location_msg_ptr->current_latitude = xi;
            location_msg_ptr->current_longitude = yi;
        }

        FRET(location_msg_ptr);
    }
}

FRET(location_msg_ptr);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-03T19:17:24.803

关于线及其交叉点有一个绝对伟大而简单的理论，它基于为您的点和线添加额外的尺寸。在这个理论中，可以用一行代码从两个点创建一条线，并且可以用一行代码计算线的交点。此外，无穷远处的点和无穷远处的线可以用实数表示。

当点 [x, y] 表示为 [x, y, 1] 并且线 ax+by+c=0 表示为 [a, b, c] 时，您可能听说过齐次表示？对于点 [x, y, w] 的一般齐次表示，转换到笛卡尔坐标是 [x/w, y/w]。这个小技巧使所有的不同，包括无限远的线表示（例如[1,0,0]）和使线表示看起来类似于点一。这为许多线/点操作的公式引入了一个很好的对称性，并且是绝对必须在编程中使用的。例如，

通过向量积很容易找到线的交点

```
p = l1xl2 
```

可以从两点创建一条线是类似的方式：

```
l=p1xp2 
```

在 OpenCV 的代码中，它只是：

```
line = p1.cross(p2);
p = line1.cross(line2); 
```

请注意，这里没有需要关注的边缘情况（例如除以零或平行线）。我的观点是，我建议重写你的代码以利用这个关于线和点的优雅理论。

最后，如果你不使用 openCV，你可以使用一个 3D 点类并创建你自己的类似于这个的叉积函数：

```
template<typename _Tp> inline Point3_<_Tp> Point3_<_Tp>::cross(const Point3_<_Tp>& pt) const
{
    return Point3_<_Tp>(y*pt.z - z*pt.y, z*pt.x - x*pt.z, x*pt.y - y*pt.x);
} 
```

# java - 是否有可供 android/eclipse/java 使用的数学 jar/库来格式化数学方程？

> ID：14782403
> 
> 赞同：2
> 
> 时间：2013-02-08T22:29:57.790
> 
> 标签：java, android, eclipse, math

我想要的只是让我的微积分应用程序显示需要格式化的简单事物。(x^2-5)/(x-4)^4 比可以做的更丑陋和复杂。我已经使用了 html，但到目前为止，html 在我的应用程序中唯一有用的是格式化 x^2 或进行积分和格式化 pi。我希望能够更好地格式化除法方程，并且如果可能的话，我希望能够更好地显示限制。我知道还有其他一些与此类似的问题，但我没有找到明确的答案。每个解决方案似乎都有问题，我只想要任何一个能够解决微积分问题的解决方案。它甚至不必是全部，只要一些就足够了。我基本上只是想将这些方程式编码成更好看的数学格式，以便整齐地显示给用户，这样他们就可以更轻松地解决问题。

# jquery - XML > jQuery 阅读

> ID：14782408
> 
> 赞同：1
> 
> 时间：2013-02-08T22:30:23.147
> 
> 标签：jquery, html, xml, arrays, phrase

我如何用 jQuery 读取这个 XML 文件？使用“普通标签”没有问题，例如：`<car>Mustang</car>`

**HTML/jQuery:**

```
$(document).ready(function(){
$.get("AMA.xml", function(XMLArray){
$(XMLArray).find("dataset").each(function(){

var $myAMA = $(this);
var number = $myAMA.attr("article.plunumber");
var name = $myAMA.attr("article.name");
var price = $myAMA.attr("article.price").text();
$("#AMAContainer").append("<p>"+number+"<br>"+name+"<br>"+price+"</p>");
  });
 });
}); 
```

**XML 文件：**

```
<document name="screen">
   <section name="list">
        <dataset>
            <var key="type">article</var>
            <var key="article.number">1</var>
            <var key="article.name">Testname1</var>
            <var key="article.displayname"/>
            <var key="article.price">99,99</var>
            <var key="article.plunumber">1</var>
            <action key="STANDARD">bp1;</action>
        </dataset>
        <dataset>
            <var key="type">article</var>
            <var key="article.number">2</var>
            <var key="article.name">Testname2</var>
            <var key="article.price">88,88</var>
            <var key="article.plunumber">2</var>
            <action key="STANDARD">bp2;</action>
        </dataset>
    </section>
</document> 
```

我完全不知道如何读取这些值。我只需要三个（号码，名称，价格）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T22:34:16.733

您可以按属性选择元素，只需使用属性选择器或 filter() 函数等。

```
$(document).ready(function () {
    $.get("AMA.xml", function (XMLArray) {
        var xml = $.parseXML(XMLArray);
        $(xml).find("dataset").each(function () {
            var number = $('[key="article.plunumber"]', this).text();
            var name = $('[key="article.name"]', this).text();
            var price = $('[key="article.price"]', this).text();
            $("#AMAContainer").append("<p>" + number + "<br>" + name + "<br>" + price + "</p>");
        });
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T22:33:58.653

```
var number = $myAMA.find('var[key="article.plunumber"]'); 
```

像对待对待`<var>`一样对待`<dataset>`

# android - 横向模式下 ListView 或 TableLayout 的两列

> ID：14782412
> 
> 赞同：0
> 
> 时间：2013-02-08T22:30:40.563
> 
> 标签：android, listview, android-tablelayout

如何使用 或 获得纵向模式下的一列和横向模式下的两`ListView`列`TableLayout`。

例如，在肖像中：

*   元素 1
*   元素 2
*   元素 3
*   元素 4

在景观中：

*   元素 1 元素 2
*   元素 3 元素 4

我想`ListView`在纵向模式下使用一列，`TableLayout`在横向模式下使用两列，但在此之前，我想知道您的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:38:27.990

我建议使用[ListView](https://developer.android.com/reference/android/widget/ListView.html)而不是 TableLayout，因为 ListView 只会创建足够的 View 来填充屏幕，而 TableLayout 会创建每个资源，无论它们是否可见。这样一来，TableLayout 会更慢，甚至可能使您的应用程序崩溃。

* * *

您可以使用以下答案之一检查设备的方向：[检查 Android 手机上](https://stackoverflow.com/q/2795833/1267661)的方向。那么如果方向是：

*   横向，加载您的双视图布局。
*   肖像，加载您的基本单视图布局。

在 ListView 中加载不同的布局需要一个简单的自定义适配器。如果你以前没有写过，这里有一个[教程](http://www.mkyong.com/android/android-listview-example/)可以帮助你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T22:41:23.640

使用 GridView 会很容易。您可以在运行时设置/选择列数，因此在纵向和横向模式下设置它们的方式不同。那样的话，你只会操纵一个视图。

# mysql - 工资税数据库架构（美国）

> ID：14782415
> 
> 赞同：0
> 
> 时间：2013-02-08T22:30:49.610
> 
> 标签：mysql, database-schema

所以这是一个基本问题：

美国联邦所得税可以每年变化，甚至在年中变化。它们基于税表，无论您是单身还是已婚，您获得报酬的频率以及您申请的免税额。以下是单身人士的示例税表，每两周获得一次报酬（2013 年）：

```
Gross income between $42 and $214  - $0.00 plus 10% of excess over $85
Gross income between $214 and $739  - $17.20 plus 15% of excess over $214
Gross income between $1479 and $3463  - $191.95 plus 25% of excess over $1479
Gross income between $3463 and $7133  - $687.95 plus 28% of excess over $3463
Gross income between $7133 and $15406  - $1715.55 plus 33% of excess over $7133
Gross income between $15406 and $15469  - $4445.64 plus 35% of excess over $15406
Gross income between $15469+             - $4467.69 plus 39.6% of excess over $15469 
```

所以不同的工资表是每周、双周、半月、每月、每季度、每半年、每年和每天。每个附表（已婚和单身）有两个税表，每个税表都有不同的数字。

因此，要计算工资单，您必须提取员工扣除额（健康保险等）工资类型、工资表、扣件（如果有），然后计算他们的总工资范围，并找出这些税表中的数字落在哪里然后计算税收。

设置数据库的最佳方法是什么，以便我可以根据需要编辑任何或所有这些数字 - 但同时在尝试计算一组员工的工资单时不要让我的 SQL 查询长 100 行？（如果可能的话）

为每个工资表创建一个表？每个工资表有两个表（已婚和单身）？在这一点上，我认为这是要走的路，但我只是想确保我没有过于复杂。欢迎任何或所有建议。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T02:52:56.633

我主要使用 MySQL 存储过程完成了完整的工资单（印度）......根据我的经验

使用存储过程可以完成（将减少大量代码）总和（总）每月/双月表支出的收入。为所有豁免创建一个单独的表。您可以使用 if / case 条件根据您的要求计算税款。希望您有员工个人数据表，您可以存储已婚或单身状态，同时计算您可以从那里提取的税款。

如果您愿意，可以粘贴我的代码

# c++ - 在头文件中声明变量

> ID：14782416
> 
> 赞同：3
> 
> 时间：2013-02-08T22:30:56.993
> 
> 标签：c++, opencv

我正在尝试为几个 opencv 相机编写包装器，但出现错误：`‘VideoCapture’ in namespace ‘cv’ does not name a type`. 我认为这是因为我没有在头文件中正确声明`cv::VideoCapture left`和声明？`cv::VideoCapture right`

立体声.h：

```
#ifndef _GUARD_STEREO_GUARD_
#define _GUARD_STEREO_GUARD_

#include "cv.h"

class Stereo {

public:
Stereo(int, int);
cv::Mat getLeft();
cv::Mat getRight();

private:
cv::VideoCapture left;
cv::VideoCapture right;

};

#endif 
```

立体声.cpp：

```
#include "cv.h"
#include <iostream>

#include "stereo.h"

using namespace cv;

Stereo::Stereo(int leftId, int rightId) {
    left = VideoCapture(leftId);
    right = VideoCapture(rightId);

    if (!left.opened() || !right.opened()) {
            std::cerr << "Could not open camera!" << std::endl;
    }
}

Mat Stereo::getLeft() {
    Mat frame;
    left >> frame;
    return frame;
}

Mat Stereo::getRight() {
    Mat frame;
    right >> frame;
    return frame;
} 
```

但是，我可以成功使用`VideoCapture like this`：

```
cv::VideoCapture capLeft; // open the Left camera
cv::VideoCapture capRight; // open the Right camera

capLeft  = cv::VideoCapture(0);
capRight = cv::VideoCapture(1); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T22:49:40.507

从[OpenCV](http://www710.univ-lyon1.fr/~eguillou/documentation/opencv2/classcv_1_1_video_capture.html)文档中，您需要包括`highgui.h`

```
#include "cv.h"
#include "highgui.h" 
```

# doctrine-orm - Zend2 中 Doctrine2 的 YamlDriver

> ID：14782422
> 
> 赞同：2
> 
> 时间：2013-02-08T22:31:17.327
> 
> 标签：doctrine-orm, zend-framework2, yaml

我正在使用[DoctrineORMModule](https://github.com/doctrine/DoctrineORMModule/)将 Doctrine2 与 Zend2 集成。如各种示例中所述，当我使用 AnnotationDriver 时，一切正常。但是，我无法让 YamlDriver 工作。在我的 module.config.php 中，我尝试了：

```
'doctrine' => array(
    'driver' => array(
        'ApplicationDriver' => array(
            'class' => 'Doctrine\ORM\Mapping\Driver\AnnotationDriver',
            'cache' => 'array',
            'paths' => array(__DIR__ . '/../src/Application/Entity')
        ), 
        'YamlDriver' => array(
            'class' => 'Doctrine\ORM\Mapping\Driver\YamlDriver',
            'cache' => 'array',
            'extension' => '.dcm.yml',
            'paths' => array(__DIR__ . '/../src/Application/Mapping')
        ),

        'orm_default' => array(
            'drivers' => array(
                'Application\Entity' => 'ApplicationDriver',
                'Application\Mapping' => 'YamlDriver'
            )
        )
    )
) 
```

但是，EntityManager 找不到我的课程。Cam，你给我一个工作示例，说明如何将 yaml 与学说 2 和 zend2 一起使用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T01:47:19.037

我假设您的实体位于命名空间中`Application\Entity`：这意味着您的驱动程序应分配给该命名空间，如下例所示：

```
'doctrine' => array(
    'driver' => array(
        'MyYamlDriver' => array(
            'class' => 'Doctrine\ORM\Mapping\Driver\YamlDriver',
            'cache' => 'array',
            'extension' => '.dcm.yml',
            'paths' => array(__DIR__ . '/mappings')
        ),

        'orm_default' => array(
            'drivers' => array(
                'Application\Entity' => 'MyYamlDriver',
            )
        )
    )
) 
```

基本上，配置将特定的命名驱动程序映射到您要使用的命名空间。在这种情况下，`MyYamlDriver`被分配来处理命名空间的任何映射`Application\Entity`

# javascript - 复制字段值并过滤掉除文件名之外的所有内容

> ID：14782425
> 
> 赞同：0
> 
> 时间：2013-02-08T22:31:44.697
> 
> 标签：javascript, jquery, forms

我在通过 JavaScript 将值从一个表单复制到另一个表单时遇到了问题，我可以在我之前的问题的帮助下解决这个问题：“[如何将一个表单的文件上传字段中的值复制到另一个表单的文本字段？](https://stackoverflow.com/questions/14444865/how-to-copy-a-value-from-one-forms-file-upload-field-to-another-forms-text-fie) ”

所以谢谢！

但现在我有一个新问题。当表单字段值被复制过来时，在某些浏览器（如IE）中，该字段包含该字段在用户计算机上的本地路径（即“C:\Users\username\Desktop\file.png”），其中显然在 URL 中不起作用。

那么：有没有办法在将文件名本身复制到新字段之前过滤掉除文件名本身之外的所有内容？或者事后有办法做到这一点？

谢谢您的帮助！

这是我最近的简化代码：

```
<script>
$(function(){
    bindGroups();
});

var bindGroups = function() {
    // First copy values
    $("input[name='logofile']").val($("input[name='logoname']").val());

    // Then bind fields
    $("input[name='logoname']").change(function() {
        $("input[name='logofile']").val($(this).val());
    });
};
</script>

<form action="/current-url" method="post" enctype="multipart/form-data">
<input type="file" name="logoname" value="1" />
<input type="submit" value="Upload" />
</form>

<form name="create_landing_page" action="/landing-page-url/" method="get">
<input type="hidden" name="logofile" />
<input type="submit" value="Generate Landing Page" /></form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:36:11.770

尝试使用 split() 和 pop() 的组合；

```
var  basename = fullFileName.split('\\').pop(); 
```

注意双反斜杠以转义斜杠；这只会解决 Windows 浏览器的问题，因为 Linux/OS X 使用斜杠 (/) 作为目录分隔符，所以可以试试这个（因为我现在在我的 iPad 上未经测试）

```
var basename = fullFileName;

if (indexof('\\', basename) >= 0) {
    basename = basename.split('\\').pop();
}

if (indexof('/', basename) >= 0) {
    basename = basename.split('/').pop();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T22:35:48.390

试试这个：

```
var field = $(this).val();
var index = field.lastIndexOf("\");
field = field.substr( index, field.length-index ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T17:57:05.283

我终于想通了，它比我希望的要简单。我所要做的就是改变这条线：

```
$("input[name='logofile']").val($(this).val()); 
```

到：

```
$("input[name='logofile']").val($(this).val().split('\\').pop()); 
```

使用变量的问题是我必须在上传字段更改时刷新它，这并不难；单击上传按钮时，我刷新了变量。但是由于某种原因，当我`$("input[name='logoname']")`用我的变量名替换时，该值不会复制过来。我想不通。

这最终变得更加简单，不需要变量。Split/pop 完成了这项工作，所以感谢所有提出建议的人！你把我推向了正确的方向。

# nservicebus - NServiceBus 加载所有程序集，无论设置如何

> ID：14782432
> 
> 赞同：1
> 
> 时间：2013-02-08T22:32:35.180
> 
> 标签：nservicebus

我正在尝试在一个目录中运行包含多个端点配置的 NServiceBus 解决方案。我正在使用（除其他外）/endpointConfigurationType：“类，程序集”执行 host.exe。

主机正确地将自己隔离为仅使用一个端点配置，但随后它似乎无论如何都会扫描目录，加载和利用在其他服务使用的其他 DLL 中找到的任何 NSB 接口。例如，正在执行其他端点 DLL 中的 IWantToRunAtStartup 实现，尽管我只希望 NSB 关心 /endpointConfigurationType 中的接口。

将 NSB 解决方案部署到平面文件夹结构需要哪些所有步骤，以便 NSB 只关注它被告知执行的端点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T01:31:03.247

请参阅此页面的“文件扫描”部分：

[http://support.nservicebus.com/customer/portal/articles/856698-the-nservicebus-host](http://support.nservicebus.com/customer/portal/articles/856698-the-nservicebus-host)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T00:19:22.743

以下应该有效：

```
Configure.With(Assembly.GetExecutingAssembly())
                 .NinjectBuilder(kernel)
                 .FileShareDataBus(BasePath)
                 .UnicastBus()
                 .MsmqSubscriptionStorage()
                 .PurgeOnStartup(false)
                 .XmlSerializer()
                 .MsmqTransport(); 
```

关于安装，只需确保为每个 /endpointConfigurationType 运行 /install，请参阅[http://support.nservicebus.com/customer/portal/articles/856698#installation](http://support.nservicebus.com/customer/portal/articles/856698#installation)

# oracle - Oracle SQL 将 LOCATION 中的文件名保存为外部表中的列

> ID：14782434
> 
> 赞同：0
> 
> 时间：2013-02-08T22:32:45.087
> 
> 标签：oracle, file, external-tables

我有几个输入文件被读入 Oracle 的外部表中。我想对所有文件的内容运行一些查询，但是，有一些查询我想**根据它来自的输入文件过滤数据**。有没有办法在针对外部表的 select 语句中访问源文件的名称，或者以某种方式在外部表中创建包含位置源的列。

这是一个例子：

```
 CREATE TABLE MY_TABLE (
            first_name CHAR(100 BYTES)
            last_name CHAR(100 BYTES)
    )
    ORGANIZATION EXTERNAL
    TYPE ORACLE_LOADER
    DEFAULT DIRECTORY TMP
    ACCESS PARAMETERS
    ( 
        RECORDS DELIMITED BY NEWLINE
        SKIP 1
        badfile       'my_table.bad'
        discardfile   'my_table.dsc'
        LOGFILE       'my_table.log'
        FIELDS terminated BY 0x'09' optionally enclosed BY '"' LRTRIM missing field   VALUES are NULL
        (
           first_name  char(100),
           last_name   
        )
    )
    LOCATION ( TMP:'file1.txt','file2.txt')
 )
 REJECT LIMIT 100;

 select distinct last_name 
 from MY_TABLE
 where location like 'file2.txt'  -- This is the part I don't know how to code 
```

有什么建议么？

始终可以选择将文件名作为附加列添加到输入文件本身。理想情况下，我想避免这种工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T01:43:27.847

ALL_EXTERNAL_LOCATIONS数据字典视图包含有关外部表位置的信息[。](http://docs.oracle.com/cd/B28359_01/server.111/b28320/statviews_1081.htm#i1577333)还有 DBA_* 和 USER_* 版本。

**编辑：（**如果我彻底阅读这个问题会有所帮助。）

您不仅想读取外部表的位置，还想知道哪一行来自哪个文件。基本上，您需要：

1.  创建一个将文件位置添加到文件内容并将它们发送到标准输入的 shell 脚本。
2.  将 PREPROCESSOR 指令添加到外部表定义以执行脚本。
3.  更改外部表定义以包含一列以显示在第一步中附加的文件名。

[这](http://asktom.oracle.com/pls/asktom/f?p=100:11:0%3a%3a%3a%3aP11_QUESTION_ID:3015912000346648463)是一篇asktom文章详细解释它。

# sql-server - 使用“灵活”模式分析/报告数据库的最佳实践

> ID：14782435
> 
> 赞同：0
> 
> 时间：2013-02-08T22:32:50.063
> 
> 标签：sql-server, database, ssas, database-schema

我的任务是为具有“灵活”架构的 SQL Server 表创建视图（Excel、网站等，而不是数据库“视图”），如下所示：

> 会话（指导） | 键（整数） | 值（字符串）

我的第一个想法是创建一系列与分析/报告请求相关的“标准”关系数据表/视图。它们可以是由按计划转换数据的守护程序服务更新的新表，也可以只是具有深度嵌套查询的一系列视图。然后，使用 SSAS、SSRS 和其他已建立的方法进行分析和报告。但我完全不确定这是否是正确的思路。

所以我的问题是：

1.  这种“灵活”模式是否有术语，以便我可以搜索相关信息？
2.  我的想法有道理还是完全错了？
3.  如果我的想法有意义，我应该使用深度查询或新表 + 数据转换服务创建视图吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T06:38:01.080

我将从一个 SSAS 多维数据集开始公开所有值，假设您可以从键中获取一些描述性信息。对于每个属性，多维数据集可能有一个度量（计数）和三个维度。

这个多维数据集对最终用户几乎没有价值（太令人困惑），但我会在继续之前使用它来验证任何特定数据是否实际可用。我认为这很重要，因为通常这种数据结构掩盖了源系统中弱数据验证和完整性。

验证主题后，我将通过 SSIS 构建物理表而不是视图 - 我发现它们更易于测试和调整。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T10:18:17.500

终于找到了术语——它被称为[实体-属性-值模式](http://en.wikipedia.org/wiki/Entity%E2%80%93attribute%E2%80%93value_model)（EAV），围绕它有很多讨论和资源。

# html - 在页面底部固定页脚

> ID：14782437
> 
> 赞同：0
> 
> 时间：2013-02-08T22:33:04.587
> 
> 标签：html, css, twitter-bootstrap, footer, fixed

我想在页面底部有一个固定的页脚，在那里我可以有一行文本（所有文本居中），[就像这样](http://i.imgur.com/Rmn1afD.png)。

[这是我当前的代码](http://pastebin.com/T32XEk1F)。

我试过使用其他教程，但**没有一个**奏效。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T22:34:15.753

我建议使用[Ryan Fait 的粘性页脚](http://ryanfait.com/sticky-footer/)。它可以完成你试图用纯 CSS 做的事情。

HTML：

```
<div class="wrapper">
    Content Here
    <div class="push"></div>
</div>
<div class="footer"></div> 
```

CSS：

```
* {
    margin: 0;
}

html, body {
    height: 100%;
}

.wrapper {
    min-height: 100%;
    height: auto !important;
    height: 100%;
    margin: 0 auto -142px; /* the bottom margin is the negative value of the footer's height */
}

.footer, .push {
    height: 142px; /* .push must be the same height as .footer */
}

.footer { /* centers the text */
    text-align: center; /* horizontal centering */
    line-height: 142px; /* vertical centering; should be equal to the footer height */
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T11:44:42.263

尝试像这样更改页脚元素和前面的 hr 元素：

```
<footer style="position:fixed; left:0px; right:0px; bottom:0px;
      background:rgb(255,255,255); text-align:center;">
  <hr>
  <p>&copy; Company 2012</p>
</footer> 
```

我认为这或多或少地解决了你的问题。[它与http://ryanfait.com/sticky-footer/](http://ryanfait.com/sticky-footer/)的页脚不完全一样，但据我了解您的问题，这就是您想要的。

PS：CSS当然应该放在CSS文件中。

# angularjs - 删除 AngularJS 货币过滤器小数/美分

> ID：14782439
> 
> 赞同：64
> 
> 时间：2013-02-08T22:33:08.910
> 
> 标签：angularjs, filter, formatting, angularjs-filter

有没有办法从货币过滤器的输出中删除小数/美分？我正在做这样的事情：

```
<div>{{Price | currency}}</div> 
```

哪个输出：

> $1,000.00

相反，我想：

> 1,000 美元

可以使用货币过滤器来完成吗？我知道我可以在数字前加上美元符号，并且可以编写自己的过滤器，但我希望现有货币过滤器存在一个简单的方法。

谢谢你。

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2013-02-09T11:07:14.213

**更新**：从**[1.3.0](https://github.com/angular/angular.js/blob/master/CHANGELOG.md#130-superluminal-nudge-2014-10-13)**版开始 -currencyFilter ：添加 fractionSize 作为可选参数，请参阅[提交](https://github.com/angular/angular.js/commit/20685ffe11036d4d604d13f0d792ca46497af4a1) 和更新[的 plunker](http://plnkr.co/edit/bFR9JGTUAxvlAlDj6Ybu?p=preview)

```
{{10 | currency:undefined:0}} 
```

请注意，它是第二个参数，因此您需要传入 undefined 以使用当前的语言环境货币符号

**更新**：请注意，这仅适用于显示在数字之前的货币符号。从**1.2.9**版开始，它仍然被硬编码到小数点后 2 位。

[这](http://plnkr.co/edit/bFR9JGTUAxvlAlDj6Ybu?p=preview)是一个修改后的版本，它使用 angular 的 formatNumber 的副本来为货币启用 0 fractionSize。

* * *

通常这应该可以在语言环境定义或 currencyFilter 调用中进行配置，但现在（**1.0.4**）它被硬编码为 2 个小数位。

**自定义过滤器：**

```
myModule.filter('noFractionCurrency',
  [ '$filter', '$locale',
  function(filter, locale) {
    var currencyFilter = filter('currency');
    var formats = locale.NUMBER_FORMATS;
    return function(amount, currencySymbol) {
      var value = currencyFilter(amount, currencySymbol);
      var sep = value.indexOf(formats.DECIMAL_SEP);
      if(amount >= 0) { 
        return value.substring(0, sep);
      }
      return value.substring(0, sep) + ')';
    };
  } ]); 
```

**模板：**

```
<div>{{Price | noFractionCurrency}}</div> 
```

**例子：**

*   **[演示](http://plnkr.co/edit/IAP8lpyRVERSaNTRRvNG?p=preview)**

**更新**：修复了处理负值时的错误

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-07-08T21:00:42.617

这个问题似乎很老了，给出的答案很好。但是，还有另一种替代解决方案也可以提供帮助（我在我的项目中使用）。

这非常适用于货币符号前缀以及正负值的数字后缀。

**自定义过滤器：**

```
angular.module('your-module', [])
    .filter('nfcurrency', [ '$filter', '$locale', function ($filter, $locale) {
        var currency = $filter('currency'), formats = $locale.NUMBER_FORMATS;
        return function (amount, symbol) {
            var value = currency(amount, symbol);
            return value.replace(new RegExp('\\' + formats.DECIMAL_SEP + '\\d{2}'), '')
        }
    }]) 
```

**模板：**

```
<div>{{yourPrice| nfcurrency}}</div> 
```

不同语言环境的示例：

*   10.00 (en-gb) -> **10 英镑**
*   20.00 (en-us) -> **$20**
*   -10.00 (en-us) -> **($10)**
*   30.00 (da-dk) -> **30 克朗**
*   -30.00 (da-dk) -> **-30 克朗**

请查看[**美元**](http://jsfiddle.net/tompwk/k4s5s386/)和[**丹麦克朗**](http://jsfiddle.net/tompwk/1yfccp01/1/)的现场演示。

**更新**

请注意，此解决方法适用于 AngularJS 1.2 和早期版本的库。从**AngularJS 1.3**开始，您可以使用带有指定分数大小的第三个参数的[货币格式化程序 -](https://code.angularjs.org/1.3.0/docs/api/ng/filter/currency) *“将金额四舍五入的小数位数”*。

请注意，为了使用来自 AngularJS 本地化的默认货币格式，您必须将货币符号（第二个参数）设置为`undefined`（`null`否则为*空*将不起作用）。[**美元**](http://jsfiddle.net/4gyjtu8g/)和[**丹麦克朗**](http://jsfiddle.net/qr4ndwfs/1/)的演示示例。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2013-12-18T16:30:57.867

另一件值得考虑的事情是，如果您知道您只有一种语言环境或一种货币，您可以将货币符号放在数字之前，然后像这样使用数字过滤器（对于美国货币）。

```
 ${{Price | number:0}} 
```

如果您不想添加新过滤器并且只有一种货币，则可以使用更多快速修复解决方案。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2016-04-12T18:15:10.327

已经晚了，但可能对某人有帮助

```
{{value | currency : 'Your Symbol' : decimal points}} 
```

所以让我们看一些输出示例

```
{{10000 | currency : "" : 0}}           // 10,000
{{10000 | currency : '$' : 0}}          // $10,000 
{{10000 | currency : '$' : 2}}          // $10,000.00 
{{10000 | currency : 'Rs.' : 2}}        // Rs.10,000.00
{{10000 | currency : 'USD $' : 2}}      // USD $10,000.00
{{10000 | currency : '#' : 3}}          // #10,000.000
{{10000 | currency : 'ANYTHING: ' : 5}} // ANYTHING: 10,000.00000 
```

查看[演示](http://plnkr.co/edit/xXdK54LLcEZvmnVzPbL8?p=preview)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-05-25T00:51:36.157

这是另一个类似的解决方案，但它删除了小数点 .00，但保留了任何其他小数点。

10.00 美元到 10 美元

10.20 美元到 10.20 美元

```
app.filter('noFractionCurrency', [ '$filter', '$locale', function(filter, locale) {
    var currencyFilter = filter('currency');
    var formats = locale.NUMBER_FORMATS;
    return function(amount, currencySymbol) {
        amount = amount ? (amount*1).toFixed(2) : 0.00;
        var value = currencyFilter(amount, currencySymbol);
        // split into parts
        var parts = value.split(formats.DECIMAL_SEP);
        var dollar = parts[0];
        var cents = parts[1] || '00';
            cents = cents.substring(0,2)=='00' ? cents.substring(2) : '.'+cents; // remove "00" cent amount
        return dollar + cents;
    };
}]); 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-11-06T10:15:57.240

角度版本 < 1.3 的解决方案，如果您使用 i18n，最简单的方法是：

```
$filter('number')(x,0) + ' ' +$locale.NUMBER_FORMATS.CURRENCY_SYM; 
```

这样，您就可以根据区域设置使用正确的分隔符和货币符号格式化数字。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-07-01T19:47:58.923

另一种解决方案是删除尾随零并为最常见的货币找到正确的货币符号：

{{10.00|money:USD}} 至 10 美元

{{10.00|money:EUR}} 至 10 欧元

```
/**
 * @ngdoc filter
 * @name money
 * @kind function
 *
 * @description
 * Formats a number as a currency (ie $1,234.56), removing trailing zeros and using the     real currency symbol when possible. When no currency symbol is provided, default
 * symbol for current locale is used.
 *
 * @param {number} amount Input to filter.
 * @param {string=} symbol Currency symbol or identifier to be displayed.
 * @returns {string} Formatted number. *
 */
app.filter('money', [ '$filter', '$locale', function (filter, locale) {
var currencyFilter = filter('currency');
var formats = locale.NUMBER_FORMATS;

var getCurrencySymbol = function (code) {
    switch (code.toUpperCase()) {
        case 'EUR': //Euro
            return '€';

        case 'USD': //Dólar americano
        case 'MXN': //Peso mejicano
        case 'CAD': //Dólar de Canadá
        case 'AUD': //Dólar australiano
        case 'NZD': //Dólar neozelandés
        case 'HKD': //Dólar de Hong Kong
        case 'SGD': //Dólar de Singapur
        case 'ARS': //Peso argentino
            return '$';

        case 'CNY': //Yuan chino
        case 'JPY': //Yen japonés
            return '¥';

        case 'GBP': //Libra esterlina
        case 'GIP': //Libras de Gibraltar
            return '£';

        case 'BRL': //Real brasileño
            return 'R$';

        case 'INR': //Rupia india
            return 'Rp';

        case 'CHF': //Franco suizo
            return 'Fr';

        case 'SEK': //Corona sueca
        case 'NOK': //Corona noruega
            return 'kr';

        case 'KPW': //Won de Corea del Norte
        case 'KRW': //Won de Corea del Sur
            return '₩';

        default:
            return code;
    }
};

return function (amount, currency) {
    var value;
    if (currency) {
        value = currencyFilter(amount, getCurrencySymbol(currency));
    }
    else {
        value = currencyFilter(amount);
    }

    //Remove trailing zeros
    var regex = new RegExp("\\" + formats.DECIMAL_SEP + "0+", "i");
    return value.replace(regex, '');
};
} ]); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-06-21T07:08:16.477

如果你想四舍五入到最接近的 1000 美元： [现场演示](http://plnkr.co/edit/1zHA4cYRiUOIRfIjkyL0?p=preview)：

```
var app = angular.module('angularjs-starter', []);

app.filter('noFractionRoundUpCurrency',
    [ '$filter', '$locale', function(filter, locale) {
      var currencyFilter = filter('currency');
      var formats = locale.NUMBER_FORMATS;
      return function(amount, currencySymbol) {
        var value = currencyFilter(amount, currencySymbol);
        var sep = value.indexOf(formats.DECIMAL_SEP);
        if(amount >= 0) { 
                    if (amount % 1000 < 500){
                        return '$' + (amount - (amount % 500));
                    } else {
                        return '$' + (amount - (amount % 500) + 500);          
                    }

        }
        else{
                    if (-amount % 1000 < 500){
                        return '($' + (-amount - (-amount % 500)) + ')';
                    } else {
                        return '($' + (-amount - (-amount % 500) + 500)+ ')';          
                    }
        }
      };
    } ]);

app.controller('MainCtrl', function($scope) {

}); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-05-01T14:35:56.763

正是我需要的！

我添加了一个条件来完全替换 Angular 的货币过滤器，并且只使用上面@Tom 看到的过滤器的修改版本。我确信有更好的方法可以做到这一点，但到目前为止它似乎对我来说效果很好。

```
 'use strict';
angular.module('your-module')
  .filter('nfcurrency', [ '$filter', '$locale', function ($filter, $locale) {
    var currency = $filter('currency'), formats = $locale.NUMBER_FORMATS;
    return function (amount, symbol) {
      var value = currency(amount, symbol), valArr = value.split(formats.DECIMAL_SEP);
      if(parseInt(valArr[(valArr.length - 1)]) > 0) {
        return value;
      } else {
        return value.replace(new RegExp('\' + formats.DECIMAL_SEP + '\d{2}'), '');
      }
    };
  }]); 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-07-15T10:14:44.953

我对@Liviu T. 发布的过滤器进行了一些修改，以接受在数字和特定小数位数之后带有符号的货币：

```
app.filter('noFractionCurrency',
[ '$filter', '$locale', function(filter, locale) {
  var currencyFilter = filter('currency');
  var formats = locale.NUMBER_FORMATS;
  return function(amount, num, currencySymbol) {
    if (num===0) num = -1;
    var value = currencyFilter(amount, currencySymbol);
    var sep = value.indexOf(formats.DECIMAL_SEP)+1;
    var symbol = '';
    if (sep<value.indexOf(formats.CURRENCY_SYM)) symbol = ' '+formats.CURRENCY_SYM;
    return value.substring(0, sep+num)+symbol;
  };
} ]); 
```

例如：

```
{{10.234 | noFractionCurrency:0}}
{{10.55555 | noFractionCurrency:2}} 
```

输出：

```
$10
$10.56 
```

[演示](http://plnkr.co/edit/HrnSU8Ig2XZLUM20jBnM?p=preview)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-02-03T15:52:38.253

如果您使用[angular-i18n](https://docs.angularjs.org/guide/i18n) ( `bower install angular-i18n`)，您可以使用装饰器来更改语言环境文件中的默认值，如下所示：

```
$provide.decorator('$locale', ['$delegate',
  function ($delegate) {
    $delegate.NUMBER_FORMATS.PATTERNS[1].maxFrac = 0;
    $delegate.NUMBER_FORMATS.PATTERNS[1].minFrac = 0;
    return $delegate;
}]); 
```

请注意，这将适用于您的代码中使用的所有货币过滤器。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-09-19T21:06:57.107

在角 4+

```
{{totalCost | currency : 'USD' : 'symbol' : '1.0-0' }} 
```

# ssh - “known_hosts”文件中的 ECDSA 条目有哪些部分？

> ID：14782440
> 
> 赞同：5
> 
> 时间：2013-02-08T22:33:41.607
> 
> 标签：ssh, cryptography, ecdsa

*我正在尝试从我的known_hosts*文件中提取一个 ECDSA 公钥，该文件*ssh*用于验证主机。我有一个下面的例子。

这是我 known_hosts 文件中“127.0.0.1 ecdsa-sha2-nistp256”的条目：

> AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBF3QCzKPRluwunLRHaFVEZNGCPD/rT13yFjKiCesA1qoU3rEp9syhnJgTbaJgK70OjoT71fDGkwwcnCZuJQPFfo=

我通过 Base64 解码器运行它来得到这个：

> ��ecdsa-sha2-nistp256���nistp256���A]2F[rUF=wXʈ'ZSzħ2r`M::WL0rp

所以我假设这些问号是某种分隔符（不，那些是长度）。我认为 nistp256 是使用的椭圆曲线，但最后一个值到底是什么？

根据我一直在阅读的内容，ECDSA 的公钥有一对值 x 和 y，它们代表曲线上的一个点。有什么方法可以从那里提取 x 和 y 吗？

我正在尝试将其转换为 Java 公钥对象，但我需要 x 和 y 才能这样做。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T22:39:15.353

并非所有字符都显示，因为它们是二进制的。将 Base64 解码的值写入文件并在十六进制编辑器中打开它。

P256 曲线的公钥应该是一个 65 字节的数组，从值为 4 的字节开始（表示非压缩点）。接下来的 32 个字节是 x 值，接下来的 32 个字节是 y 值。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-09T01:33:33.143

这是十六进制的结果：

* * *

签名算法：

```
00 00 00 13
65 63 64 73 61 2d 73 68 61 32 2d 6e 69 73 74 70 32 35 36
(ecdsa-sha2-nistp256) 
```

* * *

域参数名称：

```
00 00 00 08
6e 69 73 74 70 32 35 36
(nistp256) 
```

* * *

公钥值：

```
00 00 00 41
04
5d d0 0b 32 8f 46 5b b0 ba 72 d1 1d a1 55 11 93 46 08 f0 ff ad 3d 77 c8 58 ca 88 27 ac 03 5a a8
53 7a c4 a7 db 32 86 72 60 4d b6 89 80 ae f4 3a 3a 13 ef 57 c3 1a 4c 30 72 70 99 b8 94 0f 15 fa 
```

* * *

因此，您首先拥有要使用的数字签名算法的名称，然后是曲线的名称，然后是密钥的公共组件，由未压缩的 EC 点表示。未压缩点以 开头`04`，然后是 X 坐标（与密钥大小相同），然后是 Y 坐标。

如您所见，所有字段值前面都有四个字节，表示字段的大小。所有值和字段都使用大端表示法。

# trigger.io - 在这些命令行工具中禁用了“forge create”

> ID：14782441
> 
> 赞同：2
> 
> 时间：2013-02-08T22:33:44.660
> 
> 标签：trigger.io

```
D:\ti>forge create
[   INFO] Forge tools running at version 3.3.34
[  ERROR] "forge create" has been disabled in these command-line tools

        App creation must now be performed through the Toolkit.

        https://trigger.io/forge/toolkit/

[  ERROR] Something went wrong that we didn't expect:
[  ERROR] "forge create" is unsupported
[  ERROR] See D:\ti\forge-error.log for more details
[  ERROR] Please contact support@trigger.io 
```

我使用安装了 cywin 和 python 的 windows x64

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T16:41:06.480

您可以通过我们的 Toolkit UI 创建应用程序，您可以在此处下载：[https ://trigger.io/forge/toolkit](https://trigger.io/forge/toolkit)

通过 UI 创建应用程序后，您可以从命令行构建、运行和打包。我们确实希望尽快从命令行再次支持“forge create”，但我们正在进行一些需要首先进行的重大更改。当这种情况发生变化时，我会再次更新。

**更新**：自 Toolkit 3.3.37 发布以来，通过命令行工具重新启用了 forge create。

# excel - Excel If/Then 替换文本

> ID：14782442
> 
> 赞同：0
> 
> 时间：2013-02-08T22:33:46.983
> 
> 标签：excel, excel-formula

我对 Excel 有点陌生，我不确定是否需要公式或宏来完成这项任务。

我需要找到“Jane Smith”的所有实例并将其替换为她的员工 ID，比如说它的 513。

名字只出现在A列，而且可能有多个实例，所以我需要搜索A列下的所有单元格。我需要为多个员工这样做，所以我猜它很大`If/Then/Else`。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:36:00.843

如果名称是单元格中唯一的文本，那么您可以查看`VLOOKUP`公式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T08:32:03.493

如果您是 excel 新手，那么您并不是在寻找其他地方回答的 VBA 解决方案。

最简单的方法.....如果您只是想将“Jane Smith”替换为“513”，那该怎么办： 1\. 转到单元格 A1 2\. Ctrl + 空格键（突出显示 A 列） 3\. Ctrl + H (打开查找/替换窗口） 4\. 在查找中输入“Jane Smith”，在替换中输入“513”。

如果你只有几件事要做，这就是要走的路。

如果您想使用公式以正确的方式执行此操作，这就是您想要的：1) 创建一个包含 2 列的新选项卡。在 A 列中，填写您的所有员工姓名。在 B 栏中，填写相应的员工编号。如果您有 10 名员工，则该表将从 A1 运行到 B10。双击选项卡将其命名为“tab2”

2) 在当前选项卡或文件中，转到单元格 A1 并插入一列 (Alt + I + C)。现在您有一个新的空白列 A，所有名称现在都在列 B 中。假设第一个名称从第 5 行开始，在所有标题内容之后。因此，假设您的名字在单元格 B5 中。

3）在新的空白列A中，在单元格A5中，使用以下公式：

```
=VLOOKUP(B5,'tab2'!$A$1:$B$10,2,0) 
```

此公式将在单元格 A1-B10 的“tab2”中查找，以查找您在单元格 B5 中链接的内容，该名称类似于“Jane Smith”。它将在 tab2 的 A 列中找到此数据，然后在第 2 列中查找。末尾的零只是告诉公式仅使用精确结果。

--如果你想让数字留在新的B列，有很多方法可以做到这一点，例如插入新的A列，将B列复制到A列，然后在B列中写入vlookup公式，查看列答：但这应该让你开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T04:23:01.990

嗯试试这个：

```
Sub Test()
    Dim empVal As Range
    Dim employee As String: employee = "Jane Smith"
    Dim replaceStr As String: replaceStr = "513"
    Do While Not empVal Is Nothing
    Set empVal = activSheet.Columns(1).Find(What:=employee, LookIn:=xlValues, _
                    LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
                    MatchCase:=False, SearchFormat:=False)
        If Not empVal Is Nothing Then empVal = replaceStr
    Loop
End Sub 
```

这会尝试搜索“Jane Smith”的所有可能匹配项并将其替换为她的员工 ID

# performance - 一般编程，二维数组，双循环有什么问题？

> ID：14782446
> 
> 赞同：0
> 
> 时间：2013-02-08T22:33:57.187
> 
> 标签：performance, language-agnostic, for-loop, coding-style

这是一个通用的编程问题。

我在很多帖子中看到通过双 for 循环遍历二维数组是“可怕的”“丑陋的”等等......这是为什么？

与字典等相比，数组不是一种有效的数据结构吗？双 for 循环也不是比 foreach 或其他替代方法更有效吗？此外，如果您使用 2d 数组，您通常会处理 2d 坐标系。x 和 y 位置已经作为数组的索引“内置”到数据结构中（因此您不需要添加，例如，作为字典键的元组）并且通过更改 for 循环参数，您可以非常便宜地进行迭代通过网格的不同部分，同时完全忽略您不想迭代的部分。例如，为了避免你可以做的“外部”行和列..

```
for (int x = 1; x < Grid.GetLength(0)-1; x++)
{
        for (int y = 1; y < Grid.GetLength(1)-1; y++)
        {
            Grid[x,y].DoSomething();
        }
} 
```

使用 foreach 您将遍历集合中的*所有内容*，然后检查它是否在您想要的坐标范围内。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:40:27.313

迭代 2D 数组的 2 个循环没有错，只要这是您真正需要做的。需要注意的一件事是性能 - 通常，循环应该遵循内存中数组的布局。例如，如果 2D 数组存储为 1D 内存缓冲区，其中行`n`存储在行之后`n-1`（这是通用语言中的常见实现），则外部循环应该通过行，内部循环应该通过列。这样缓存未命中被最小化。

一般来说，与其他方法相比，数组访问的有效性完全取决于特定的语言实现。通常，数组将是最原始的数据结构，从而实现最快的访问。顺便说一句，字典是数组概念的概括。

# c++ - 获取电池设备名称

> ID：14782449
> 
> 赞同：0
> 
> 时间：2013-02-08T22:34:06.127
> 
> 标签：c++, winapi, battery

我正在尝试使用此代码获取计算机上所有电池设备的名称，该代码主要是从 Microsoft 教程中获得的，但它不起作用。

```
#define INITGUID
#include <windows.h>
#include<batclass.h>
#include<setupapi.h>
#define GBS_HASBATTERY 0x1
#define GBS_ONBATTERY  0x2
#include<iostream>

using namespace std;

int main()
{
DWORD dwResult = GBS_ONBATTERY;
HDEVINFO hdev = SetupDiGetClassDevs(&GUID_DEVICE_BATTERY, 0, 0, DIGCF_PRESENT | DIGCF_DEVICEINTERFACE);

for (int idev = 0; idev < 100; idev++)
 {
  SP_DEVICE_INTERFACE_DATA did = {0};
  did.cbSize = sizeof(did);

  if (SetupDiEnumDeviceInterfaces(hdev, 0, &GUID_DEVICE_BATTERY, idev, &did))
   {
    DWORD cbRequired = 0;
    SetupDiGetDeviceInterfaceDetail(hdev, &did, 0, 0, &cbRequired, 0);

    if (ERROR_INSUFFICIENT_BUFFER == GetLastError())
     {
      PSP_DEVICE_INTERFACE_DETAIL_DATA pdidd = (PSP_DEVICE_INTERFACE_DETAIL_DATA)LocalAlloc(LPTR,cbRequired);

      if (pdidd)
       {
        pdidd->cbSize = sizeof(*pdidd);

        if (SetupDiGetDeviceInterfaceDetail(hdev,&did,pdidd,cbRequired,&cbRequired,0))
         {
          HANDLE hBattery = CreateFile(pdidd->DevicePath,GENERIC_READ | GENERIC_WRITE,
          FILE_SHARE_READ | FILE_SHARE_WRITE,NULL,OPEN_EXISTING,FILE_ATTRIBUTE_NORMAL,NULL);

          if (INVALID_HANDLE_VALUE != hBattery)
           {
            BATTERY_QUERY_INFORMATION bqi = {0};

            DWORD dwWait = 0;
            DWORD dwOut;

            if (DeviceIoControl(hBattery,
                                IOCTL_BATTERY_QUERY_TAG,
                                &dwWait,
                                sizeof(dwWait),
                                &bqi.BatteryTag,
                                sizeof(bqi.BatteryTag),
                                &dwOut,
                                NULL)
                && bqi.BatteryTag)
             {////////////////////////////////////////problem around here///////
              string  bi;
              bqi.InformationLevel = BatteryDeviceName;
              if (DeviceIoControl(hBattery,
                                  IOCTL_BATTERY_QUERY_INFORMATION,
                                  &bqi,
                                  sizeof(bqi),
                                  &bi,
                                  sizeof(bi),
                                  &dwOut,
                                  NULL))
            {
                cout<<bi;

                  BATTERY_WAIT_STATUS bws = {0};
                  bws.BatteryTag = bqi.BatteryTag;

                  BATTERY_STATUS bs;
                  if (DeviceIoControl(hBattery,
                                      IOCTL_BATTERY_QUERY_STATUS,
                                      &bws,
                                      sizeof(bws),
                                      &bs,
                                      sizeof(bs),
                                      &dwOut,
                                      NULL))
                   {
                    if (bs.PowerState & BATTERY_POWER_ON_LINE)
                     {
                      dwResult &= ~GBS_ONBATTERY;
                     }
                   }
               }
             }
            CloseHandle(hBattery);
           }
         }
        LocalFree(pdidd);
       }
     }
   }
    else  if (ERROR_NO_MORE_ITEMS == GetLastError())
     {
      break;
     }
 }
SetupDiDestroyDeviceInfoList(hdev);
} 
```

我正在尝试打印所有电池的名称，但是当我运行程序时它根本不打印任何东西，但是当我请求电池信息结构而不是字符串 BatteryDeviceName 请帮助时它确实有效

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T00:27:32.327

问题是你的电话`DeviceIoControl`是错误的。你是在传递垃圾，当你把垃圾放进去时，你就会把垃圾拿出来。

```
string bi;

if(DeviceIoControl(hBattery,
                   IOCTL_BATTERY_QUERY_INFORMATION,
                   bqi,
                   sizeof(bqi),
                   &bi,         // Really?!?!?!
                   sizeof(bi),  // WHAT?!?
                   &dwOut,
                   NULL)) 
```

您正在将一个`std::string`对象的地址传递给`DeviceIoControl`，它对它一无所知`std::string`并期望它可以写入的原始缓冲区的地址。您至少为该缓冲区指定了正确的大小，但即使这样在某种意义上也是错误的。基本上，当该函数返回时，这`std::string`就是垃圾，访问它几乎可以做任何事情——从使程序崩溃到在扬声器上播放 Vivaldi。

尝试这样的事情：

```
WCHAR szBuf[_MAX_PATH] = { 0 }; // In a real program you'd dynamically 
                                // allocate an appropriately sized buffer
                                // instead. 

if(DeviceIoControl(hBattery,
                       IOCTL_BATTERY_QUERY_INFORMATION,
                       bqi,
                       sizeof(bqi),
                       szBuf,
                       sizeof(szBuf),
                       &dwOut,
                       NULL)) 
```

# android - Android 上的 OpenCV 和 JavaCv - 检测图像上的形状

> ID：14782455
> 
> 赞同：2
> 
> 时间：2013-02-08T22:34:40.920
> 
> 标签：android, opencv, javacv

我开始使用 openCV 和 JavaCV，并尝试检测图像上的形状。我想检测圆圈。我有一个图像作为位图（并且只有这样）。我已经读过，首先我需要将我的图像作为 IplImage，然后将其转换为灰度并平滑边缘。好的，所以我开始做这样的事情：因为首先我的图像是位图，我创建了一个 IplImage 对象（我应该提到按下按钮后一切都在发生）：

```
IplImage image = new IplImage(); 
```

然后我将我的位图转换为 IplImage：

```
bitmap.copyPixelsToBuffer(image.getByteBuffer()); 
```

而且我应该知道其他想法，但我不能，因为按下按钮后应用程序在第一行崩溃：`IplImage image = new IplImage();` 我尝试使用其他构造函数，例如：`IplImage image = new IplImage(size);`但它也没有工作。如果有人可以帮助我该怎么做（我的意思是创建 IplImage 并将位图转换为 IplImage），我将非常感激。

---编辑----我又试了一次。现在我没有使用 Project->properties->Java Built Path->... 添加 jar，但我在“lib”文件夹中设置了 jar。但是当我试图创建 IplImage 类的对象时，一切仍然崩溃。有人知道为什么吗？

--EDIT-- 在我的 lib 文件夹中，我有：android-support-v4.jar、javacpp.jar、javacv.jar、opencv 库 - 2.4.3.jar。我的活动课：

```
import com.googlecode.javacv.cpp.opencv_core.IplImage;

import android.app.Activity;
import android.graphics.Bitmap;
import android.os.Bundle;
import android.view.Menu;

public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        IplImage image = new IplImage();

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    } 
```

当我开始我的活动时，它会崩溃并且日志：

```
02-09 12:18:59.207: E/AndroidRuntime(7652): Caused by: java.lang.UnsatisfiedLinkError: Library jniopencv_core not found
02-09 12:18:59.207: E/AndroidRuntime(7652):     at java.lang.Runtime.loadLibrary(Runtime.java:461)
02-09 12:18:59.207: E/AndroidRuntime(7652):     at java.lang.System.loadLibrary(System.java:557)
02-09 12:18:59.207: E/AndroidRuntime(7652):     at com.googlecode.javacpp.Loader.loadLibrary(Loader.java:448)
02-09 12:18:59.207: E/AndroidRuntime(7652):     at com.googlecode.javacpp.Loader.load(Loader.java:372)
02-09 12:18:59.207: E/AndroidRuntime(7652):     at com.googlecode.javacpp.Loader.load(Loader.java:319)
02-09 12:18:59.207: E/AndroidRuntime(7652):     at com.googlecode.javacv.cpp.opencv_core.<clinit>(opencv_core.java:136)
02-09 12:18:59.207: E/AndroidRuntime(7652):     ... 19 more 
```

我可以提一下，如果我尝试定义`Imgproc img = new Imgproc();`一切都可以。也许我可以使用 Imgproc 检测形状（圆形），有人可以推荐一个好的教程吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T22:42:31.970

您可以直接创建图像，如下所示：

```
IplImage image = IplImage.createFrom(bitmapBuffer); 
```

或者

```
IplImage image = IplImage.create(width, height, IPL_DEPTH_8U, 4); // Change the parameter as you need
bitmap.copyPixelsToBuffer(image.getByteBuffer()); 
```

或将图像直接加载到`LplImage`对象中

```
IplImage image = cvLoadImage("image.png"); 
```

**编辑**：

[看到这个问题](https://stackoverflow.com/questions/10438017/android-javacv-dilemma-noclassdeffounderror-thrown-inside-of-method-draw-when)，它应该可以解决你的错误。

根据您的错误，您的 libs 文件夹中似乎没有包含 OpenCV 的本机库（例如 libjniopencv_core.so）。

按照说明指南正确安装和使用库以及`README.txt`文件

[看到这个问题](https://stackoverflow.com/questions/14588391/how-to-install-javacv-on-android-and-use-framegrabber)

# sql - 用例做一些操作oracle

> ID：14782456
> 
> 赞同：0
> 
> 时间：2013-02-08T22:34:54.753
> 
> 标签：sql, oracle, oracle11g

我可以在 oracle 11g 中使用**case**来执行一些操作（在 PL/SQL 中）还是必须*返回*一个值，我的意思是，我可以在 mysql 中执行此操作：

```
Select <column> from <table> where <conditions>;

case <column>   
 when 1 then      
  -- Quite many processes, queries, inserts, etc   
 when 2 then  
  -- some complex code  
-- And so on 
```

是否有可能在 oracle 中实现？
我也想知道我是否可以这样做，因为我在该行中遇到了 oracle 错误，我的意思是，在**ELSE 的 Case 语句**
中设置一些变量

 **```
CASE WHEN <condition> THEN varY := z ELSE var1:= x, var2:=x, var3:=y END 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T22:44:25.747

如果您真的在谈论 PL/SQL，那么您当然可以在一个`CASE`语句中执行多个操作的代码。`CASE`除了PL/SQL 中的语句以`END CASE`not结尾的语法错误之外，您发布的代码应该可以正常工作`END`。

```
SQL> ed
Wrote file afiedt.buf

  1  declare
  2    l_var1 number := 4;
  3    l_var2 number := 8;
  4  begin
  5    case when l_var1 = l_var2
  6         then l_var1 := 12;
  7         else
  8            l_var1 := 10;
  9            l_var2 := 6;
 10            dbms_output.put_line( 'I''m in the ELSE clause' );
 11     end case;
 12* end;
SQL> /
I'm in the ELSE clause

PL/SQL procedure successfully completed. 
```

如果您谈论的是 SQL，而不是 PL/SQL，那么不，您不能嵌入过程语句，例如`CASE`在 SQL 语句中分配 PL/SQL 变量。**

# django - 如何关闭弹出窗口并重定向到 Django 视图中的另一个页面？

> ID：14782460
> 
> 赞同：5
> 
> 时间：2013-02-08T22:35:14.230
> 
> 标签：django, view, popup

我有一个处理表单的弹出窗口。单击按钮后，我需要关闭弹出窗口并返回主页面。如何在我的 Django 视图中执行这两个操作？

```
def InsertPopup (request):  
    if request.method == 'POST':  
        form = CustomerForm(request.POST)  
            if form.is_valid():  
               form.save(True)  
               return HttpResponse('<script type="text/javascript">window.close()</script>') 
```

此代码工作正常，但在“window.close”脚本之后，我想将焦点重定向/重新回到主页上，该主页将显示更新的数据。
非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T22:46:58.520

这并不是 Django 特有的。您可以在关闭弹出窗口后通过 JavaScript 设置位置。

```
window.opener.parent.location.href = "/"; 
```

# javascript - Javascript原型的问题

> ID：14782462
> 
> 赞同：0
> 
> 时间：2013-02-08T22:35:27.343
> 
> 标签：javascript, function, scope

我在 JavaScript 上有点挣扎。如果我在另一个函数中调用 init 函数，我只会让下面的代码工作。如果我在超时函数之外调用 this.init() 或 that.init()，它就不起作用。

```
var App = function() {
    var that = this;       

    // Workaround
    var timeout = setTimeout(function(){            
        that.init();            
    },1);
};

var app = new App();

App.prototype.init = function() {    
    console.log('works');
}; 
```

谢谢你的帮助。

干杯。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T22:39:09.003

您在实例化 App 后分配原型。以前做。

```
var App = function() {
    this.init();
};

App.prototype.init = function() {    
    console.log('works');
};

var app = new App(); 
```

# image - 滑动div时如何移动和缩小图像？

> ID：14782471
> 
> 赞同：0
> 
> 时间：2013-02-08T22:36:02.537
> 
> 标签：image, html, sliding

我附上了一张图片来说明我的目的。 [http://postimage.org/image/9cmg2z8vv/](http://postimage.org/image/9cmg2z8vv/)

默认情况下，id 喜欢在页面中间有一个大的横向或纵向图像。单击图像时，div 应从右侧滑入。div 应将大图像从屏幕的中心向左推 50%，大图像应缩小以适合屏幕的左侧 50%。

你知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T22:49:54.380

这是一个粗略的 javascript 版本。不是最好的，但可以帮助您入门。我看不到你的 HTML，所以我不知道其他 div 中的 div 是什么，但你基本上可以对转换做同样的事情。

[http://jsfiddle.net/jMwWK/1/](http://jsfiddle.net/jMwWK/1/)

```
<div id="content">
    <div id="holder">
        <div id="image"></div>
    </div>
</div>
<div id="slider"></div>

$(document).ready(function(){
    setTimeout(function(){
        $('#slider').animate({left: '-200px'});
        $('#holder').animate({width: '50%'});
    },1000);
}); 
```

# android - 发送电子邮件 (Android) 时，StringBuilder 中的选项卡不起作用！

> ID：14782474
> 
> 赞同：1
> 
> 时间：2013-02-08T22:36:23.240
> 
> 标签：android, email, tabs, formatting

对此有点奇怪；我的应用程序正在使用 StringBuilder 构建字符串以创建电子邮件。

现在我要做的是发送带有部分文本选项卡的电子邮件（文本将被传输到 Word 文档中，这将节省大量编辑）。

因此，在我的代码中，我正在编写包含选项卡的代码，例如：

```
message.append(component).append("\t\t\t\t\t\t\t\t\t\t\t\t").append(risk).append("\r\n"); 
```

我使用以下代码来构建电子邮件：

```
private void sendEmail(String recipient, String subject, String message) { 
    try { 
        final Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND); 
        emailIntent.setType("text/html");
        emailIntent.setType("message/rfc822");          

        if (recipient != null)  emailIntent.putExtra(android.content.Intent.EXTRA_EMAIL, new String[]{recipient}); 
        if (subject != null)    emailIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, subject); 
        if (message != null)    emailIntent.putExtra(android.content.Intent.EXTRA_TEXT, message); 

        startActivity(Intent.createChooser(emailIntent, "Send mail...")); 

    } catch (ActivityNotFoundException e) { 
        // cannot send email for some reason 
    } 
} 
```

因此，当我在发送前查看电子邮件时，选项卡似乎有效，但当我收到电子邮件时，它们却不存在。嘘。

任何想法为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:08:34.593

刚刚尝试过您的代码，似乎在发送电子邮件时修剪了标签符号。也尝试过这种方式，它工作正常（在 gmail 中），但它丑陋的解决方案

```
 private String tab(){
    return "    "; // return four space characters
}

message.append(tab()+tab+tab()); 
```

# angularjs - 基本的睾丸/茉莉花/角度设置和使用

> ID：14782477
> 
> 赞同：4
> 
> 时间：2013-02-08T22:37:00.870
> 
> 标签：angularjs, jasmine, karma-runner

我是 Jasmine 的新手，但想在 Javascript 中做更多的 TDD。我一直在使用 Google 的 Angular 库，而且我知道[Testacular](http://testacular.github.com)是专门为测试 Angular 应用而创建的。

我已经阅读了 Jasmine 文档并观看了 Testacular 设置视频，但我无法进行最基本的测试。假设我有三个文件：

```
modules.js
controller.js
appSpec.js 
```

modules.js 有我的模块定义，其中包含一些 .factory(...) 服务和一些 .directive(...) 自定义指令。controller.js 包含我的控制器，用于将模块连接到 html 视图。

到目前为止，一切都很好。接下来我添加了 appSpec.js。假设我想用它来测试我的模块中名为“Data”的服务，它有一个方法“getData()”，它返回一个资源。

在 testactular init 中，我告诉它观看所有三个文件。我运行 Testacular，它告诉我它正在观看正确的文件。极好的。

我不明白的是，我如何让 Jasmine 规范知道如何查看模块和控制器，以便对其进行测试。如果我简单地说：

```
describe('Data Service', function(){
  it ('should retrieve two items from the database', function(){
    data = Data.getData() //my angular service
    expect(data.length).toBe(2);
  });
}); 
```

毫不奇怪，它不知道 Data.getData() 是什么。

似乎很明显，在我开始编写套件之前，我应该以某种方式将我的模块定义和控制器纳入规范。一定很明显，以至于我在文档中看不到人们是如何做到的。教程似乎只是开始在 spec.js 文件中编写规范并假设一切正常。

我在这里看到过其他类似问题的帖子，但不可否认，它们都有我似乎缺乏的基础。例如，一篇文章谈到不手动创建控制器实例，而是注入依赖项。他为什么要创建一个新的 $rootScope 对象，他的模块是如何被引用的，等等......

我知道我的问题可能只是对 Jasmine 框架缺乏基本的了解，但我似乎无法从 Jasmine 自述文件中获得更多的理解。有人可以指出我应该如何工作的基本解释吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T21:40:48.173

尝试`module('myModule')`在茉莉花测试中做。

以下是一些开源 Angular 项目，它们有很好的测试可供查看：

[角度应用](https://github.com/angular-app/angular-app/tree/master/client/test/unit)

[角度-ui](https://github.com/angular-ui/angular-ui/tree/master/modules/directives)

[引导程序](https://github.com/angular-ui/bootstrap/tree/master/src)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-17T16:20:05.453

包含测试定义的方式是通过 karma.config.js 文件

`files = [ JASMINE, JASMINE_ADAPTER, '../app/lib/icg/object.js', '../app/lib/icg/geometry.js', '../app/lib/icg/ubiquity.js', '../test/unit/icgUbiquitySpec.js', '../test/unit/icgObjectSpec.js' ];`

在这里，您定义哪些文件被加载到您的浏览器中，第一个不包含“规范”一词的文件是定义，而包含的文件是我的测试文件。您需要在测试之前包含定义，以便在运行测试之前定义它们，这就是我最后包含所有规范文件的原因。

# ckeditor - 新创建的 CKEditor 实例上的鼠标事件问题

> ID：14782479
> 
> 赞同：2
> 
> 时间：2013-02-08T22:37:23.970
> 
> 标签：ckeditor

我正在尝试创建一个新的 CKEditor ver4 实例以响应用户单击元素。由于应用程序的性质，我无法使用[CKEditor Sample](http://docs.ckeditor.com/#!/guide/dev_inline)中概述的“autoInline”功能。虽然下面的示例确实创建了一个编辑器实例，但该实例存在一个重大问题。当用户点击远离它们时，内联实例应该消失。然而，在此示例中，用户必须先单击离开，然后单击返回实例，然后再次单击离开。我怎样才能防止这种情况？

```
<!doctype html>
<html>
<head>
    <script src="jspath/ckeditor.js"></script>
    <script>
        var editor = null;
        CKEDITOR.disableAutoInline = true;
        function init() {
        var e2 = document.getElementById("element2");
        e2.addEventListener("click", function () {
        if(!editor) {
                editor = CKEDITOR.inline(e2);
                editor.on('instanceReady', function () {
                    console.log("instanceReady")
                    console.log(editor.focusManager.hasFocus);
                });
                editor.on('focus', function() {
                    console.log("focus");
                })
                editor.on('blur', function() {
                    console.log("blur");
                    editor.destroy();
                    editor = null;
                })
            }
        })
    }
</script>
</head>
<body onload="init()">
    <div tabindex="0" id="element2" style="background-color: yellow;" contentEditable = true>Element 2</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T02:11:31.437

尽管这`editor.focusManager.hasFocus`是真的，但编辑器的元素实际上并没有焦点。也许这是一个错误？无论如何，添加`editor.focus();`到该`instanceReady`功能解决了这个问题。

# java - Ant build 不会生成 jar 文件

> ID：14782480
> 
> 赞同：1
> 
> 时间：2013-02-08T22:37:29.137
> 
> 标签：java, ant, build, jar

我得到了一个 2000 年的旧脚本。它全部用 Java 编写，并且有一个编译文件可以编译它：

```
 <?xml version="1.0"?>
    <project name="chat" default="compile" basedir=".">
        <target name="init">
            <property name="conf.dir" value="conf" />
            <property name="src.dir" value="src" />
            <property name="resource.dir" value="resource" />
            <property name="build.dir" value="build" />     
            <property name="release.dir" value="release" />
            <property name="etc.dir" value="etc" />
            <property name="lib.dir" value="lib" />
        </target>

        <target name="clean" depends="init">
            <delete dir="${build.dir}" />       
            <delete dir="${release.dir}" />
        </target>

        <target name="compile" depends="init">
            <mkdir dir="${build.dir}" />
            <javac srcdir="${src.dir}" destdir="${build.dir}" includeAntRuntime="false" debug="true" optimize="false" />        
        </target>

        <target name="release" depends="compile">       
            <mkdir dir="${release.dir}" />

            <jar destfile="${release.dir}/chat_service.jar" basedir="${build.dir}"  includeantruntime="false" />        
        </target>

    </project> 
```

当我在 Windows 中使用 ant 运行它时，命令提示符会显示：

```
Buildfile: build.xml

init: 

compile: BUILD SUCCESSFUL 
```

但它不会创建 jar 文件。它所做的只是复制确切的项目并将其编译为类文件。

有谁知道我如何创建正确的文件？这是一个聊天服务器，我需要它来运行我的客户端。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T22:40:30.280

构建文件的默认目标是`compile`：

```
<project name="chat" default="compile" basedir="."> 
```

因此，如果您在没有指定目标的情况下调用 ant，`compile`则将执行目标。要执行`release`目标，请使用

```
ant release 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-08-21T09:02:47.560

您应该添加另一个目标部分来生成 jar 文件。例如 ：

```
<target name="jar" depends="compile">
    <mkdir dir="${jar.dir}" />
    <jar destfile="${jar.dir}/${ant.project.name}.jar" basedir="${classes.dir}">
        <manifest>
            <attribute name="Main-Class" value="${main-class}" />
            <attribute name="Class-Path" value="config/ properties/ ${manifest.classpath}" />
        </manifest>
    </jar>

</target> 
```

最后，您当然应该为自己的文件和属性配置该块。

# wordpress - 尽管使用了 foreach，但 Wordpress 简码仅从提要中返回 1

> ID：14782484
> 
> 赞同：0
> 
> 时间：2013-02-08T22:37:47.407
> 
> 标签：wordpress, foreach, rss, return, shortcode

我正在尝试创建一个自定义 Wordpress 插件，该插件利用简码输出我想要的内容。在此文本代码中，我试图读取一个 rss 文件并仅输出前 5 个提要的列表。

这`$showno`是短代码变量之一，因此我可以使用以下`[player show=foo snowno=5]`. 在示例代码`$show`中没有使用。

下面的代码仅显示提要列表中的最新项目。如果我将它更改为`return`，`echo`那么它会按预期工作，只是它显示在帖子的顶部，而不是我输入简码的位置。我搜索了这个问题的答案，提供的解决方案只是“使用返回”，我已经完成了......

欣赏建议。谢谢

```
include_once(ABSPATH . WPINC . '/rss.php');         

$num_items = $showno;
$feedurl = 'http://feeds.bbci.co.uk/news/rss.xml';
$feed = fetch_rss($feedurl);
$items = array_slice ($feed->items, 0, $num_items); 

foreach ($items as $item ) {
  $title = $item[title];
  $mp3link   = $item[link];
  $description  =  $item[description];
  return "<li>$title - $description</li>";  
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:23:46.077

[**短代码**](http://codex.wordpress.org/Shortcode_API)应返回不回显。

在您的代码中，您正在中断 the 的执行`foreach`并返回第一个值。

您应该构建一个字符串变量并在`foreach`循环之后返回它，因此您的所有循环都将被包含在内，例如：

```
$final_html = '';
foreach( $items as $item )
{
    $final_html .= "<li>$title - $description</li>"; 
}
return $final_html; 
```

# c# - 如何获取 Exchance 用户和分发列表的 PrimarySmtpAddress

> ID：14782485
> 
> 赞同：0
> 
> 时间：2013-02-08T22:37:52.270
> 
> 标签：c#, outlook, vsto, exchange-server

我正在尝试 from、to 和 cc 字段的电子邮件地址。有时这些是 AD 电子邮件、SMTP 或分发电子邮件。

我在这里找到了一个有类似问题的人，但他们对分发列表一无所知。

我稍微修改了代码以尝试获取此值。

```
if (type.ToLower() == "ex")
            {
                recip = Globals.ThisAddIn.Application.GetNamespace("MAPI").CreateRecipient(address);
                if (recip.DisplayType == OlDisplayType.olDistList)
                {
                    sAddress = recip.AddressEntry.GetExchangeDistributionList().PrimarySmtpAddress;
                }
                else
                {
                    sAddress = recip.AddressEntry.GetExchangeUser().PrimarySmtpAddress;
                }
            }
            else
            {
                sAddress = address.Replace("'", "");
            } 
```

问题是`recip.DisplayType`null 除非在获得收件人并在该对象上调用 DisplayType 后有一小段延迟。

有一个更好的方法吗？

我将代码更改为以下，但我担心这不适用于所有 DisplayTypes，我什至不确定大多数类型是什么（选项显示在此处[http://msdn.microsoft.com/en -us/library/microsoft.office.interop.outlook.oldisplaytype%28v=office.14%29.aspx](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.oldisplaytype%28v=office.14%29.aspx) )

```
private static string GetSmtpAddress(AddressEntry addressEntry)
        {
            string address;
            if (addressEntry.Type == "ex")
            {
                if (addressEntry.DisplayType == OlDisplayType.olDistList)
                {
                    address = addressEntry.GetExchangeDistributionList().PrimarySmtpAddress;
                }
                else
                {
                    address = addressEntry.GetExchangeUser().PrimarySmtpAddress;
                }
            }
            else
            {
                address = addressEntry.Address;
            }
            return address;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:40:56.140

您需要先解析收件人 - 调用 CreateRecipient 后，调用 Recipient.Resolve。

# vb.net - 搜索特殊号码 vb.net

> ID：14782491
> 
> 赞同：0
> 
> 时间：2013-02-08T22:38:30.583
> 
> 标签：vb.net, string, text, browser

我有一个充满数字的网页，例如：

```
xxxx.xxx.xxx.xxx[space]xx 
```

例如：

```
124.240.187.79 82 
```

如何以编程方式搜索和获取它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T22:50:00.447

正则表达式03.vbs：

```
Dim objRegExp    : Set objRegExp = CreateObject("VBScript.RegExp")
objRegExp.Global = True
Dim input
input = "I have a webpage full of numbers like: xxxx.xxx.xxx.xxx[space]xx E.g.: 124.240.187.79 82 How do I search and get them programatically?"

Dim Pattern : Pattern = "[0-9]{3}\.[0-9]{3}\.[0-9]{3}\.[0-9]{2}\s[0-9]{2}"
WScript.Echo "Pattern : " & Pattern

objRegExp.Pattern = Pattern

Set objMatches = objRegExp.Execute(input)

For i=0 To objMatches.Count-1
  Set objMatch = objMatches.Item(i)
  WScript.Echo objMatch.Value
Next 
```

命令行：

```
cscript //nologo regexp03.vbs 
```

输出：

```
Pattern : [0-9]{3}\.[0-9]{3}\.[0-9]{3}\.[0-9]{2}\s[0-9]{2}
124.240.187.79 82 
```

# php - 不断丢失wordpress中的数据库

> ID：14782494
> 
> 赞同：0
> 
> 时间：2013-02-08T22:38:40.220
> 
> 标签：php, mysql, wordpress

我有一个很长的 PHP 脚本（可能持续 10 分钟，并且涉及大量 curl 调用），我可以将其作为 Cron 作业或直接运行。我正在使用 $wpdb 全局变量进行 SQL 调用，并且由于“WordPress 数据库错误 MySQL 服务器已消失”错误而不断丢失 mysql 数据库。

我已经通过将 wp-db.php 中的 wait_timeout 值更改为 3600 来尝试其他人的建议，但它仍然是一样的。还有什么我可以做的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T08:30:41.623

很明显，这意味着 MySQL 关闭了连接，要么是因为 - 你发送的查询大于`max_allowed_packet`，要么 - 你花费的时间比`wait_timeout`查询之间的时间长。

假设是超时，

将其放在`$wpdb->query("set wait_timeout = 1200")`脚本的开头附近 - 这样可以节省您修改 WP 核心文件的时间。

如果还是不行，试试 MySQL 的 'ping' 功能。在`wp-includes/wp-db.php`, find `function query(`, 下一点是带有`mysql_query`- 在上面的行, 添加行

```
mysql_ping( $dbh ); 
```

Ping 检查连接并尝试重新连接 - 我发现它在长时间运行的脚本中非常有用。

希望其中的某些东西（a）有意义并且（b）对您有用。为了其他阅读本文的人的利益，不要忘记升级 Wordpress 将覆盖您对核心文件所做的任何更改。

链接： http: [//blog.webyog.com/2009/09/02/%E2%80%9Cmysql-server-has-gone-away%E2%80%9D-part-2-session-timeout/](http://blog.webyog.com/2009/09/02/%E2%80%9Cmysql-server-has-gone-away%E2%80%9D-part-2-session-timeout/)和[http： //php.net/manual/en/function.mysql-ping.php](http://php.net/manual/en/function.mysql-ping.php)

# c# - 如何在将 C# 委托返回的对象作为值返回给 C++ 之前对其进行封送处理

> ID：14782495
> 
> 赞同：2
> 
> 时间：2013-02-08T22:38:45.157
> 
> 标签：c#, delegates, pinvoke, marshalling

我在 C++ 中有这段代码

```
class MyClass { ... };
typedef MyClass (*Callback)();
Callback theCB;
static void RegisterCallback( Callback cb ) { theCB = cb; };
static void CallCallback() { 
   MyClass obj = theCB();
} 
```

我正在使用 swig 但为简单起见（如果你不知道 swig）我在 C# 中有这个包装器

```
public class MyClassWrapper
{
   public IntPtr ptrToNativeObj; // pointer to native MyClass object
   public MyClassWrapper()
   {
       ptrToNativeObj = call to native code that creates 
                        and returns a new instance of MyClass in C++
   }
}; 
```

现在我想支持 C# 中的回调机制，所以我这样设置：

```
public MyClassWrapper MyFunction()
{
   return new MyClassWrapper();
}

delegate MyClassWrapper CallbackDotNet();

static void main()
{
    var fct = new CallbackDotNet( MyFunction );
    P/Invoke call to native function RegisterCallback( fct );

    then finally:
    P/Invoke call to native function CallCallback();
} 
```

我有所有这些代码设置可以正常工作。CallCallback 中的本机代码将正确调用 MyFunction。

但现在我需要正确处理返回的对象......

MyFunction 返回一个 C# 引用，而 C++ 中的回调按值返回，因此这不会免费工作：

```
static void CallCallback() { 
   MyClass obj = theCB();
} 
```

**如何编组对从 MyFunction 返回的 MyClassWrapper 对象的“引用”，以便 C++ 接收“按值”一个 MyClass 对象？**

我应该继续编写自定义编组器吗？

[http://msdn.microsoft.com/en-us/library/zk0a8dea(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/zk0a8dea(v=vs.90).aspx)

然后像这里一样使用它

```
[return: MarshalAs(UnmanagedType.CustomMarshaler,
         MarshalType = "MyCustomMarshaler")] 
delegate MyClassWrapper CallbackDotNet(); 
```

我查看了自定义编组器的文档，它非常复杂。看起来有趣的实现方法如下：

```
IntPtr MarshalManagedToNative( Object ManagedObj ); 
```

代码将类似于

```
IntPtr MarshalManagedToNative( Object ManagedObj )
{
   MyClassWrapper val = ManagedObj as MyClassWrapper;
   return val.ptrToNativeObj;
} 
```

但这会将 MyClass* 返回到本机代码，而不是该 C++ 代码所期望的 MyClass 值！

```
static void CallCallback() { 
   MyClass obj = theCB();
} 
```

编组器是否足够聪明以取消对指针的引用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T18:22:19.783

谢谢大家的意见

看起来自定义编组器是要走的路！

我做了一个简单的测试用例，一切正常。它按预期工作。如果您有兴趣，这是编组器：

```
public class MyCustomMarshaler : ICustomMarshaler
{
    public static ICustomMarshaler GetInstance(String cookie)
    {
        return new MyCustomMarshaler();
    }
    public IntPtr MarshalManagedToNative(Object ManagedObj)
    {
        MyClassWrapper val = ManagedObj as MyClassWrapper;
        return val.ptrToNativeObj;
    }
    ...
 }

 [return: MarshalAs(UnmanagedType.CustomMarshaler,MarshalType = "MyCustomMarshaler")]
 public delegate MyClassWrapper CallbackDotNet(); 
```

使用此封送拆收器，当 C++ 调用 C# 回调时，会在从该 C# 回调返回时调用函数 MarshalManagedToNative，这可以将 C# 引用（到 MyClassWrapper）转换为指向 C++ 类 MyClass 的指针。

这似乎足够了，然后 P/Invoke 将负责将此 MyClass* 取消引用到 MyClass 值。

并没有我想象的那么难……

# php - Google 地图地理编码状态 OVER_QUERY_LIMIT

> ID：14782496
> 
> 赞同：3
> 
> 时间：2013-02-08T22:38:51.990
> 
> 标签：php, google-maps, geolocation, geocoding

我知道 Google 将请求上限限制为每天 2,500 次……但在 EARTH 上我无法发出这么多请求，而且我只是不断收到“OVER_QUERY_LIMIT”

```
$street_no = get_post_meta($prop->ID, 'street_no', true);
$street = get_post_meta($prop->ID, 'street', true);
$street_suffix = get_post_meta($prop->ID, 'street_suffix', true);

$addr = urlencode( $street_no." ".$street." ".$street_suffix." BC Canada" );
$url = 'http://maps.googleapis.com/maps/api/geocode/json?address='.$addr.'&sensor=true';
$json_result = json_decode(file_get_contents($url));

if ( $json_result->status === "OVER_QUERY_LIMIT" ) :
    sleep(2);
    $json_result = json_decode(file_get_contents($url));
endif; 
```

正如你所看到的，如果我得到`OVER_QUERY_LIMIT`我告诉脚本休眠 2 秒然后继续的状态......这似乎在今天早上的某个时候工作，但现在我什至无法获得一个地址地理编码.

我不知道此时该做什么......这让我的应用程序完全没用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T22:40:09.813

也许您每秒发送的查询太多？

看看这个线程：

[使用谷歌地图时 OVER_QUERY_LIMIT](https://stackoverflow.com/questions/3529746/over-query-limit-while-using-google-maps)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-08T23:19:06.820

配额在共享 IP 的所有用户之间共享，因此同一共享 IP 上的其他站点必须使用 Google 地理编码器。

有关详细信息，请参阅[Google Maps API v2 组中的此线程](https://groups.google.com/group/google-maps-api/browse_frm/thread/4b8dd63d97b8b799/877bb7024b045f61?lnk=gst&q=OVER_QUERY_LIMIT+rackspace#877bb7024b045f61)。

顺便说一句 - rackspace 是一个猜测......

一种解决方法是使用基于客户端的地理编码，但请验证您的使用是否符合使用条款。

[Web 服务现在支持 key](https://developers.google.com/maps/documentation/geocoding/#GeocodingRequests)，另一种选择是在您的请求中使用 key 以便您获得自己的配额。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-11T22:00:11.580

我的 heroku 托管 java 应用程序遇到了类似的问题。我解决它的方法是设置一个微型 EC2 实例并在其上安装 Dante 以作为代理服务器运行。然后我只需通过代理路由我的地理编码请求，并且每天可以发出完整的 2,000 个请求。显然，缓存结果以最小化 api 调用也是值得的。EC2 实例在第一年是免费的，之后仍然没有那么贵，您可以随时使用它，而不仅仅是 Dante。

我已经在此处详细说明了如何设置：[使用 Heroku 的 Google 地理编码](http://onlinetakeawayfood.wordpress.com/2013/05/11/using-google-geocoding-api-from-heroku-application/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T21:50:55.340

我从 Heroku 上的服务器（托管在 Amazon EC2 上）调用地理编码 REST 接口时遇到同样的问题

如果我可以在请求中使用我的 Maps API 密钥并且他们跟踪每个 api 密钥的调用次数，则可以解决此问题。

我同意这是一个严重的问题......

[Bing](http://msdn.microsoft.com/en-us/library/ff701715.aspx)、MapQuest 和其他人有免费的地理编码 API——你（和我）应该看看那些。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-25T11:15:11.260

您可以使用像 QuotaGuard 这样的托管代理服务，它会阻止来自共享 IP 的请求，这样您在使用 Rackspace/Heroku 等时就不会被 Google 阻止。

# javascript - jQuery 中的精灵表动画

> ID：14782502
> 
> 赞同：0
> 
> 时间：2013-02-08T22:39:11.593
> 
> 标签：javascript, jquery, web

我想为一个网站创建一个动画徽标，该徽标是一个原子，并且动画很难拉动，因为它的电子在扭曲的椭圆路径中旋转。现在，如果我错了，请纠正我，但是通过像在 2D 游戏中那样快速换出一系列图像来制作动画似乎是最简单的方法。

我问的原因是我没有找到很多关于这个的信息。这是因为它不是 jQuery 和 javascript 的可取的动画技术还是加载太慢？

如果有更好的方法请告诉我，或者如果这是最好的方法，我该怎么做？

# .htaccess - 如何处理缺少参数的 Htaccess

> ID：14782505
> 
> 赞同：0
> 
> 时间：2013-02-08T22:39:18.513
> 
> 标签：.htaccess, rewrite

好的，我不知道我是否在问以前有人问过的问题，因为 htaccess 让我的大脑糊涂了我的耳朵。

我的 htaccess 目前这样做：

```
www.domain.co.uk/index.php?Pram1=Val1&Pram2=Val2 
```

变成

```
www.domain.co.uk/Pram1/Val1/Val2 
```

使用

```
RewriteRule ^Pram1/([^/]*)/([^/]*)/$ /index.php?Pram1=$1&Pram2=$2 [L,QSA] 
```

Huzzar 有效，但当有人去：

```
www.domain.co.uk/Pram1/ 
```

我希望它像欢迎页面一样加载...。我知道如何处理 PHP，但不知道如何在空白婴儿车上进行重写。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:53:56.943

我可能没有得到您的问题，但您可以执行以下操作：

*   添加新的重写规则：

    ```
    RewriteRule ^Pram1/$ /index.php?Pram1= [L,QSA] 
    ```

这将是最容易维护和最容易阅读的。我会走这条路。

*   使其他参数可选：

    ```
    RewriteRule ^Pram1/(?:([^/]*)/([^/]*)/)$ /index.php?Pram1=$1&Pram2=$2 [L,QSA] 
    ```

这应该工作（我没有测试这个）。Pram1 和 Pram2 都在查询字符串中，并且在 www.domain.co.uk/Pram1/ 的情况下将包含一个空字符串。

但我强烈建议使用第一个版本。它可能看起来不太灵活，但它确实更容易维护。

# c - gettimeofday 崩溃 MPI？

> ID：14782507
> 
> 赞同：0
> 
> 时间：2013-02-08T22:39:28.780
> 
> 标签：c, linux, mpi, gettimeofday

我有一个 mpi 程序，我试图测量它的运行时间。所以我添加了 2 个调用 gettimeofday，这就是一切停止工作的地方。出于某种原因，只有当我在那里第二次调用 gettimeofday 时它才会崩溃。这是我收到的信息：

MPI 应用程序等级 0 在 MPI_Finalize() 之前被杀死，信号为 11 srun：错误：n32：task0：退出代码为 245

这是代码

```
 struct timeval starttime;
   struct timeval endtime;

   gettimeofday(&starttime, NULL);

   int numDarts = 1000000000;
   int numWorkers = 2;

   char* args[1];
   if(argc >= 2)
   {
      numWorkers = atoi(argv[1]);
   }
   if(argc >= 3)
        numDarts = atoi(argv[2]);

   MPI_Init(&argc, &argv);
   MPI_Comm_size(MPI_COMM_WORLD, &world_size);

   printf("world size = %i\n", world_size);
   if (world_size != 1)
        printf("Top heavy with management\n");

   int numDartsWorker = numDarts/numWorkers;
   int numDartsMaster = numDarts/numWorkers + (numDarts % numWorkers); //the master computes the leftover
   args[0] = malloc(256 * sizeof(char));
   sprintf(args[0], "%i", numDartsWorker);
  // printf("argument passing to workers: %s\n", args[0]);
   /*
    * Now spawn the workers. Note that there is a run-time determination
    * of what type of worker to spawn, and presumably this calculation must
    * be done at run time and cannot be calculated before starting
    * the program. If everything is known when the application is
    * first started, it is generally better to start them all at once
    * in a single MPI_COMM_WORLD.
    */
  // printf("About to call MPI_Comm_spawn with %i workers...\n", numWorkers);
   int resultLen = 0;

  //the master counts as a worker, hence the -1
   MPI_Comm_spawn("piworker", args, numWorkers-1, MPI_INFO_NULL, 0, MPI_COMM_SELF,
                   &everyone, MPI_ERRCODES_IGNORE);

   double pisum = 0;
   double myresult = dboard(numDartsMaster);
   printf("parent result is %.9f\n", myresult);

   int rc = MPI_Reduce(&myresult, &pisum, 1, MPI_DOUBLE, MPI_SUM, MPI_ROOT, everyone);

   if (rc != MPI_SUCCESS)
        printf("failure on mpi_reduce\n");

   free(args[0]);
   /*
    * Parallel code here. The communicator "everyone" can be used
    * to communicate with the spawned processes, which have ranks 0,..
    * MPI_UNIVERSE_SIZE-1 in the remote group of the intercommunicator
    * "everyone".
    */
   //receive the results
   int i=1;
   MPI_Status status;

   double avgpi = pisum;
   avgpi += myresult; //include master's average in the result.
   avgpi /= numWorkers;

   printf("startTime = %d secs, %d microsecs\n", starttime.tv_sec);

//   gettimeofday(&endtime, NULL);

//   double totalTime = ((double)endtime.tv_sec + (double)endtime.tv_usec/1000000.0f) -
//                    ((double)starttime.tv_usec + (double)starttime.tv_usec/1000000.0f);

 //  printf("Total time: %.8f\n", totalTime);
   printf("With %i workers, %i darts, estimated value of pi is: %.9f\n", numWorkers, numDarts, avgpi);

       MPI_Finalize();

   return 0;
} 
```

我在第二次调用 gettimeofday 之前打了一个 printf 电话。如果第二个调用被注释掉，它只会打印任何东西，否则它会崩溃。我在此示例中注释掉了 gettimeofday，但这是导致 mpi 崩溃的调用。如果我取消注释它，它会再次开始崩溃，并出现我提到的错误消息。

我想知道是否有人对为什么 gettimeofday 会这样做有任何见解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:02:14.913

在您的代码中，有一个线程的产生，如

```
//the master counts as a worker, hence the -1
MPI_Comm_spawn("piworker", args, numWorkers-1, MPI_INFO_NULL, 0, MPI_COMM_SELF,
               &everyone, MPI_ERRCODES_IGNORE); 
```

随后 args 被释放，如

```
free(args[0]); 
```

这是预期的吗？释放这些内存不会影响各个线程吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T01:39:09.327

感谢 nos，他对我的问题发表了评论，我能够找到解决方案。我摆脱了对 sprintf 的调用，它被用来写入 MPI_Comm_Spawn 调用的参数字符串，它告诉工作人员要使用多少个“飞镖”。相反，我使用 MPI_Send 向他们发送信息。似乎在我打电话给 gettimeofday 之前，sprintf 不是问题。

# active-directory - jboss-negotiation-toolkit 'secured' 测试不起作用（SPNEGO 身份验证失败）

> ID：14782508
> 
> 赞同：3
> 
> 时间：2013-02-08T22:39:32.340
> 
> 标签：active-directory, single-sign-on, jboss7.x, windows-authentication, spnego

几天前我在 JBoss PicketBox 论坛上发布了同样的问题，但还没有收到任何回复（[https://community.jboss.org/thread/220959](https://community.jboss.org/thread/220959)）。所以我想也许我会尝试 StackOverflow 来吸引更多的受众。

我一直在努力让 jboss-negotiation-toolkit 工作几个星期，我想我已经尝试了其他人遇到的所有问题。我现在被困在无法让 servlet 的“安全”版本工作的地步。“安全域测试”和“基本协商”测试工作正常，但 JBoss 在尝试打开安全链接时继续抛出“LoginException”。我很确定这与一些 AD/Kerberos 设置有关，但我无法取得更多进展。

```
11:49:43,514 ERROR [org.jboss.security.authentication.JBossCachedAuthenticationManager] (http-bardev1.dev.company.com-10.10.5.232-8080-1) Login failure: javax.security.auth.login.LoginException: Continuation Required.
    at org.jboss.security.negotiation.spnego.SPNEGOLoginModule.login(SPNEGOLoginModule.java:174) [jboss-negotiation-spnego-2.2.0.SP1.jar:2.2.0.SP1]
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) [rt.jar:1.6.0_33]
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) [rt.jar:1.6.0_33]
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) [rt.jar:1.6.0_33]
    at java.lang.reflect.Method.invoke(Method.java:597) [rt.jar:1.6.0_33]
    at javax.security.auth.login.LoginContext.invoke(LoginContext.java:769) [rt.jar:1.6.0_33]
    at javax.security.auth.login.LoginContext.access$000(LoginContext.java:186) [rt.jar:1.6.0_33]
    at javax.security.auth.login.LoginContext$4.run(LoginContext.java:683) [rt.jar:1.6.0_33]
    at java.security.AccessController.doPrivileged(Native Method) [rt.jar:1.6.0_33]
    at javax.security.auth.login.LoginContext.invokePriv(LoginContext.java:680) [rt.jar:1.6.0_33]
    at javax.security.auth.login.LoginContext.login(LoginContext.java:579) [rt.jar:1.6.0_33]
    at org.jboss.security.authentication.JBossCachedAuthenticationManager.defaultLogin(JBossCachedAuthenticationManager.java:449) [picketbox-infinispan-4.0.7.Final.jar:4.0.7.Final]
    ... 
```

**有没有人遇到过同样的问题，或者有没有人对问题出在哪里有任何建议？**抱歉，这篇文章很长，但下面是设置的所有细节以及到目前为止我是如何配置的，试图提供尽可能多的细节。

这是我们的设置：

*   Windows 2008 广告 (QAAD)
    *   DNS 名称：qaad.dev.company.com
    *   域名：质量（QUALITY.COMPANY.COM）
*   CentOS 6.2 运行 JBoss AS 7.1.1.Final (BARDEV1)
    *   部署：jboss-negotiation-toolkit-2.2.2.Final
    *   DNS 名称：bardev1.dev.company.com
*   测试客户端是加入 QUALITY 域的 WinXP 和 Win7

BARDEV1 当前已加入质量域（***这是必要的还是应该在未加入域的情况下工作？***）。

**JBoss SPNEGO 配置**是：

```
<security-domain name="qaad_kerberos" cache-type="default">
    <authentication>
        <login-module code="com.sun.security.auth.module.Krb5LoginModule" flag="required">
            <module-option name="storeKey" value="true"/>
            <module-option name="useKeyTab" value="true"/>
            <module-option name="principal" value="HTTP/bardev1.dev.company.com@QUALITY.COMPANY.COM"/>
            <module-option name="keyTab" value="/opt/jboss-as-7.1.1.final/standalone/configuration/bardev1_qaad_rc4.keytab"/>
            <module-option name="doNotPrompt" value="true"/>
            <module-option name="debug" value="true"/>
            <module-option name="refreshKrb5Config" value="false"/>
        </login-module>
    </authentication>
</security-domain>
<security-domain name="SPNEGO" cache-type="default">
    <authentication>
        <login-module code="org.jboss.security.negotiation.spnego.SPNEGOLoginModule" flag="required">
            <module-option name="password-stacking" value="useFirstPass"/>
            <module-option name="serverSecurityDomain" value="qaad_kerberos"/>
        </login-module>
    </authentication>
</security-domain> 
```

**/etc/krb5.conf**设置为：

```
[logging]
default = FILE:/var/log/krb5libs.log
kdc = FILE:/var/log/krb5kdc.log
admin_server = FILE:/var/log/kadmind.log

[libdefaults]
default_realm = QUALITY.COMPANY.COM
dns_lookup_realm = false
dns_lookup_kdc = false
ticket_lifetime = 24h
renew_lifetime = 7d
forwardable = true
default_tgs_enctypes = rc4-hmac
default_tkt_enctypes = rc4-hmac
permitted_enctypes = rc4-hmac

[realms]
QUALITY.COMPANY.COM = {
  kdc = qaad.dev.company.com
  admin_server = qaad.dev.company.com
  default_domain = quality.company.com
}

[domain_realm]
.quality.company.com = QUALITY.COMPANY.COM
quality.company.com = QUALITY.COMPANY.COM 
```

QAAD 盒子有“bardev1”的“计算机”帐户。此帐户的委派设置为“信任此计算机以委派任何服务（仅限 Kerberos）”。keytab 是在 QAAD 盒子上生成的，SPN 是使用以下命令设置的：

*   setspn -S HTTP/bardev1.dev.company.com@QUALITY.COMPANY.COM bardev1
*   ktpass /out bardev1_qaad_rc4.keytab /princ HTTP/bardev1.dev.company.com@QUALITY.COMPANY.COM /mapuser quality\administrator -crypto RC4-HMAC-NT -ptype KRB5_NT_PRINCIPAL /pass * /kvno 0

    *   （注意：必须设置 /kvno 0 否则我得到：KrbException: Specified version of key is not available (44)）
*   setspn -L bardev1

    *   输出：CN=bardev1,CN=Computers,DC=quality,DC=company,DC=com 的注册 ServicePrincipalNames：HTTP/bardev1.dev.company.com@QUALITY.COMPANY.COM HOST/bardev1.dev.company.com HOST /BARDEV1
*   setspn -L 管理员
    *   输出：CN=Administrator、CN=Users、DC=quality、DC=company、DC=com 的注册 ServicePrincipalNames：HTTP/bardev1.dev.company.com

使用“管理员”帐户进行初始测试，因此我不必处理新的用户帐户。该帐户已将委派设置为**“信任此计算机以委派任何服务（仅限 Kerberos）”**，并且没有设置其他帐户选项，例如“使用 kerberos DES 加密...”、“帐户支持 AES 128/256...”或'不需要 kerberos preauth'。***他们中的任何一个都需要吗？***

在客户端机器上，为了让浏览器使用登录用户的凭据，我必须将 URL 设置为：

*   http://bardev1:8080/jboss-negotiation-toolkit-2.2.2.Final

如果我把它说成：

*   http://bardev1.dev.company.com:8080/jboss-negotiation-toolkit-2.2.2.Final

然后我会弹出用户名和密码。

我确实尝试使用'HTTP/bardev1@QUALITY.COMPANY.COM' 运行setspn 和ktpass，结果相同，即基本和域测试有效，但安全无效。

**“SecurityDomainTest”的输出：**

*JBoss 日志：*

```
 12:01:33,229 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1) Debug is  true storeKey true useTicketCache false useKeyTab true doNotPrompt true ticketCache is null isInitiator true KeyTab is /opt/jboss-as-7.1.1.final/standalone/configuration/bardev1_qaad_rc4_domain.keytab refreshKrb5Config is false principal is HTTP/bardev1.dev.company.com@QUALITY.COMPANY.COM tryFirstPass is false useFirstPass is false storePass is false clearPass is false
      12:01:33,238 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1) principal's key obtained from the keytab
      12:01:33,241 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1) Acquire TGT using AS Exchange
      12:01:33,259 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1) principal is HTTP/bardev1.dev.company.com@QUALITY.COMPANY.COM
      12:01:33,269 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1) EncryptionKey: keyType=23 keyBytes (hex dump)=0000: 30 89 05 17 EB 07 89 AE   06 E2 B1 5D 58 B6 6E A4  0..........]X.n.
      12:01:33,273 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1)
      12:01:33,276 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1) Added server's keyKerberos Principal HTTP/bardev1.dev.company.com@QUALITY.COMPANY.COMKey Version 0key EncryptionKey: keyType=23 keyBytes (hex dump)=
      12:01:33,283 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1) 0000: 30 89 05 17 EB 07 89 AE   06 E2 B1 5D 58 B6 6E A4  0..........]X.n.
      12:01:33,285 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1)
      12:01:33,285 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1)
      12:01:33,286 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1)          [Krb5LoginModule] added Krb5Principal  HTTP/bardev1.dev.company.com@QUALITY.COMPANY.COM to Subject
      12:01:33,288 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1) Commit Succeeded
      12:01:33,290 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1)
      12:01:33,295 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1)          [Krb5LoginModule]: Entering logout
      12:01:33,296 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1)          [Krb5LoginModule]: logged out Subject 
```

*浏览器：*

```
 Negotiation Toolkit
      Security Domain Test
      Testing security-domain 'qaad_kerberos'

      Authenticated
      Subject:
      Principal: HTTP/bardev1.dev.company.com@QUALITY.COMPANY.COM
      Private Credential: Ticket (hex) =
      0000: 61 82 04 A6 30 82 04 A2 A0 03 02 01 05 A1 16 1B a...0...........
      0010: 14 51 55 41 4C 49 54 59 2E 53 59 4D 50 48 4F 4E .QUALITY.COMPANY
      0020: 4F 2E 43 4F 4D A2 29 30 27 A0 03 02 01 02 A1 20 O.COM.)0'......
      0030: 30 1E 1B 06 6B 72 62 74 67 74 1B 14 51 55 41 4C 0...krbtgt..QUAL
      ...
      04A0: 1C 85 74 1A 9B EF B9 EE D2 A8 ..t.......

      Client Principal = HTTP/bardev1.dev.company.com@QUALITY.COMPANY.COM
      Server Principal = krbtgt/QUALITY.COMPANY.COM@QUALITY.COMPANY.COM
      Session Key = EncryptionKey: keyType=23 keyBytes (hex dump)=
      0000: 67 2B 5A 9B FE 97 00 2B 68 0B D2 0F 35 FA D1 CB g+Z....+h...5...

      Forwardable Ticket true
      Forwarded Ticket false
      Proxiable Ticket false
      Proxy Ticket false
      Postdated Ticket false
      Renewable Ticket false
      Initial Ticket false
      Auth Time = Tue Feb 05 12:01:33 CST 2013
      Start Time = Tue Feb 05 12:01:33 CST 2013
      End Time = Tue Feb 05 22:01:33 CST 2013
      Renew Till = null
      Client Addresses Null
      Private Credential: Kerberos Principal HTTP/bardev1.dev.company.com@QUALITY.COMPANY.COMKey Version 0key EncryptionKey: keyType=23 keyBytes (hex dump)=
      0000: 30 89 05 17 EB 07 89 AE 06 E2 B1 5D 58 B6 6E A4 0..........]X.n. 
```

**“基本谈判”的输出：**

*JBoss 日志：*

```
 12:48:01,226 INFO  [org.jboss.security.negotiation.toolkit.BasicNegotiationServlet] (http-bardev1.dev.company.com-10.10.5.232-8080-1) No Authorization Header, sending 401
      12:48:01,243 INFO  [org.jboss.security.negotiation.toolkit.BasicNegotiationServlet] (http-bardev1.dev.company.com-10.10.5.232-8080-1) Authorization header received - decoding token. 
```

*浏览器：*

```
 Negotiation Toolkit
      Basic Negotiation
      WWW-Authenticate - Negotiate YIILwgYGKwYBBQUCoIILtjCCC7KgJDAiBgkqhkiC9xIBAgIGCSq ... i4=

      NegTokenInit
      Message Oid - SPNEGO
      Mech Types - {Kerberos V5 Legacy} {Kerberos V5} {NTLM}
      Req Flags -
      Mech Token -YIILgAYJKoZIhvcSAQICAQBuggtvMIILa6A ... Gi4=
      Mech List Mic - 
```

**“安全”的输出：**

*JBoss 日志：*

```
 12:51:52,877 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1) Debug is  true storeKey true useTicketCache false useKeyTab true doNotPrompt true ticketCache is null isInitiator true KeyTab is /opt/jboss-as-7.1.1.final/standalone/configuration/bardev1_qaad_rc4_domain.keytab refreshKrb5Config is false principal is HTTP/bardev1.dev.company.com@QUALITY.COMPANY.COM tryFirstPass is false useFirstPass is false storePass is false clearPass is false
      12:51:52,894 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1) principal's key obtained from the keytab
      12:51:52,895 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1) Acquire TGT using AS Exchange
      12:51:52,929 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1) principal is HTTP/bardev1.dev.company.com@QUALITY.COMPANY.COM
      12:51:52,933 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1) EncryptionKey: keyType=23 keyBytes (hex dump)=0000: 30 89 05 17 EB 07 89 AE   06 E2 B1 5D 58 B6 6E A4  0..........]X.n.
      12:51:52,937 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1)
      12:51:52,939 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1) Added server's keyKerberos Principal HTTP/bardev1.dev.company.com@QUALITY.COMPANY.COMKey Version 0key EncryptionKey: keyType=23 keyBytes (hex dump)=
      12:51:52,944 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1) 0000: 30 89 05 17 EB 07 89 AE   06 E2 B1 5D 58 B6 6E A4  0..........]X.n.
      12:51:52,945 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1)
      12:51:52,946 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1)
      12:51:52,947 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1)          [Krb5LoginModule] added Krb5Principal  HTTP/bardev1.dev.company.com@QUALITY.COMPANY.COM to Subject
      12:51:52,949 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1) Commit Succeeded
      12:51:52,950 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1)
      12:51:52,950 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1)          [Krb5LoginModule]: Entering logout
      12:51:52,952 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1)          [Krb5LoginModule]: logged out Subject
      12:51:52,953 ERROR [org.jboss.security.authentication.JBossCachedAuthenticationManager] (http-bardev1.dev.company.com-10.10.5.232-8080-1) Login failure: javax.security.auth.login.LoginException: Continuation Required.
                at org.jboss.security.negotiation.spnego.SPNEGOLoginModule.login(SPNEGOLoginModule.java:174) [jboss-negotiation-spnego-2.2.0.SP1.jar:2.2.0.SP1]
                at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) [rt.jar:1.6.0_33]
                at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) [rt.jar:1.6.0_33]
                at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) [rt.jar:1.6.0_33]
                at java.lang.reflect.Method.invoke(Method.java:597) [rt.jar:1.6.0_33]
                at javax.security.auth.login.LoginContext.invoke(LoginContext.java:769) [rt.jar:1.6.0_33]
                at javax.security.auth.login.LoginContext.access$000(LoginContext.java:186) [rt.jar:1.6.0_33]
                at javax.security.auth.login.LoginContext$4.run(LoginContext.java:683) [rt.jar:1.6.0_33]
                at java.security.AccessController.doPrivileged(Native Method) [rt.jar:1.6.0_33]
                at javax.security.auth.login.LoginContext.invokePriv(LoginContext.java:680) [rt.jar:1.6.0_33]
                at javax.security.auth.login.LoginContext.login(LoginContext.java:579) [rt.jar:1.6.0_33]
                at org.jboss.security.authentication.JBossCachedAuthenticationManager.defaultLogin(JBossCachedAuthenticationManager.java:449) [picketbox-infinispan-4.0.7.Final.jar:4.0.7.Final]
                at org.jboss.security.authentication.JBossCachedAuthenticationManager.proceedWithJaasLogin(JBossCachedAuthenticationManager.java:383) [picketbox-infinispan-4.0.7.Final.jar:4.0.7.Final]
                at org.jboss.security.authentication.JBossCachedAuthenticationManager.authenticate(JBossCachedAuthenticationManager.java:371) [picketbox-infinispan-4.0.7.Final.jar:4.0.7.Final]
                at org.jboss.security.authentication.JBossCachedAuthenticationManager.isValid(JBossCachedAuthenticationManager.java:160) [picketbox-infinispan-4.0.7.Final.jar:4.0.7.Final]
                at org.jboss.as.web.security.JBossWebRealm.authenticate(JBossWebRealm.java:214) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final]
                at org.jboss.security.negotiation.NegotiationAuthenticator.authenticate(NegotiationAuthenticator.java:187) [jboss-negotiation-common-2.2.0.SP1.jar:2.2.0.SP1]
                at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:455) [jbossweb-7.0.13.Final.jar:]
                at org.jboss.as.web.security.SecurityContextAssociationValve.invoke(SecurityContextAssociationValve.java:153) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final]
                at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:155) [jbossweb-7.0.13.Final.jar:]
                at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) [jbossweb-7.0.13.Final.jar:]
                at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) [jbossweb-7.0.13.Final.jar:]
                at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:368) [jbossweb-7.0.13.Final.jar:]
                at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:877) [jbossweb-7.0.13.Final.jar:]
                at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:671) [jbossweb-7.0.13.Final.jar:]
                at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:930) [jbossweb-7.0.13.Final.jar:]
                at java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_33]

      12:51:52,985 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1) Debug is  true storeKey true useTicketCache false useKeyTab true doNotPrompt true ticketCache is null isInitiator true KeyTab is /opt/jboss-as-7.1.1.final/standalone/configuration/bardev1_qaad_rc4_domain.keytab refreshKrb5Config is false principal is HTTP/bardev1.dev.company.com@QUALITY.COMPANY.COM tryFirstPass is false useFirstPass is false storePass is false clearPass is false
      12:51:52,989 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1) principal's key obtained from the keytab
      12:51:52,990 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1) Acquire TGT using AS Exchange
      12:51:53,015 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1) principal is HTTP/bardev1.dev.company.com@QUALITY.COMPANY.COM
      12:51:53,058 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1) EncryptionKey: keyType=23 keyBytes (hex dump)=0000: 30 89 05 17 EB 07 89 AE   06 E2 B1 5D 58 B6 6E A4  0..........]X.n.
      12:51:53,060 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1)
      12:51:53,061 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1) Added server's keyKerberos Principal HTTP/bardev1.dev.company.com@QUALITY.COMPANY.COMKey Version 0key EncryptionKey: keyType=23 keyBytes (hex dump)=
      12:51:53,063 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1) 0000: 30 89 05 17 EB 07 89 AE   06 E2 B1 5D 58 B6 6E A4  0..........]X.n.
      12:51:53,065 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1)
      12:51:53,065 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1)
      12:51:53,066 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1)          [Krb5LoginModule] added Krb5Principal  HTTP/bardev1.dev.company.com@QUALITY.COMPANY.COM to Subject
      12:51:53,068 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1) Commit Succeeded
      12:51:53,068 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1)
      12:51:53,081 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1)          [Krb5LoginModule]: Entering logout
      12:51:53,082 INFO  [stdout] (http-bardev1.dev.company.com-10.10.5.232-8080-1)          [Krb5LoginModule]: logged out Subject 
```

*浏览器：*

```
 HTTP Status 403 - Access to the requested resource has been denied 
```

## 执行的其他测试/设置

我还尝试在 QAAD Windows 服务器本身上运行 jboss 实例，更新了 setspn 和 ktpass 命令，但结果相同，“安全”测试失败并出现 LoginException。

我还尝试使用不同的 AD 服务器（COLLAB，在 Windows 2003 AD 服务器上运行），但结果相同。

所以我很确定这是一些设置/配置/环境问题，但我似乎无法深入了解它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-05T12:58:56.143

我知道已经很晚了。

我遇到了同样的问题，发现我们需要稍微修改一下 jboss-negotiation-toolkit 的 web.xml。

将 web.xml 的 security-constraint 和 login-config 修改为如下所示：

```
<security-constraint>
  <web-resource-collection>
    <web-resource-name>Restricted</web-resource-name>
    <url-pattern>/Secured/*</url-pattern>
  </web-resource-collection>
  <auth-constraint>
    <role-name>*</role-name>
  </auth-constraint>
  <user-data-constraint>
    <transport-guarantee>NONE</transport-guarantee>
  </user-data-constraint>
</security-constraint>
<login-config>
<auth-method>SPNEGO</auth-method>
<realm-name>SPNEGO</realm-name>
<form-login-config>
  <form-login-page>/login.html</form-login-page>
  <form-error-page>/error.html</form-error-page>
</form-login-config>    
</login-config>
<security-role>
  <role-name>*</role-name>
</security-role> 
```

然后将standalone.xml中的jboss spnego配置修改为如下所示

```
<security-domain name="qaad_kerberos" cache-type="default">
<authentication>
    <login-module code="com.sun.security.auth.module.Krb5LoginModule" flag="required">
        <module-option name="storeKey" value="true"/>
        <module-option name="useKeyTab" value="true"/>
        <module-option name="principal" value="HTTP/bardev1.dev.company.com@QUALITY.COMPANY.COM"/>
        <module-option name="keyTab" value="/opt/jboss-as-7.1.1.final/standalone/configuration/bardev1_qaad_rc4.keytab"/>
        <module-option name="doNotPrompt" value="true"/>
        <module-option name="debug" value="true"/>
        <module-option name="refreshKrb5Config" value="false"/>
    </login-module>
</authentication>
</security-domain>
<security-domain name="SPNEGO" cache-type="default">
<authentication>
    <login-module code="org.jboss.security.negotiation.spnego.SPNEGOLoginModule" flag="required">
        <module-option name="password-stacking" value="useFirstPass"/>
        <module-option name="serverSecurityDomain" value="qaad_kerberos"/>
    </login-module>
    <login-module code="org.jboss.security.negotiation.AdvancedLdapLoginModule" flag="requisite">
        <module-option name="bindAuthentication" value="GSSAPI"/>
        <module-option name="jaasSecurityDomain" value="qaad_kerberos"/>
        <module-option name="java.naming.provider.url" value="ldap://your kdc's hostname:389"/>
        <module-option name="baseCtxDN" value="DC=MYDOMAIN,DC=COM"/>
        <module-option name="baseFilter" value="(userPrincipalName={0})"/>
        <module-option name="roleAttributeID" value="memberOf"/>
        <module-option name="roleAttributeIsDN" value="true"/>
        <module-option name="roleNameAttributeID" value="cn"/>
        <module-option name="recurseRoles" value="true"/>
        <module-option name="password-stacking" value="useFirstPass"/>
        <module-option name="allowEmptyPassword" value="false"/>
        <module-option name="debug" value="true"/>
    </login-module>
</authentication>
</security-domain> 
```

# php - 第一个数据全局网关连接错误

> ID：14782516
> 
> 赞同：0
> 
> 时间：2013-02-08T22:40:27.173
> 
> 标签：php, gateway, firstdata

任何人都知道我在哪里可以获得第一个数据全球网关的 PHP 包装器？我在他们的网站上直接找到了下载，但我不确定它是否有效。

我不断收到以下错误：

```
"<r_approved>FAILURE<\/r_approved><r_error>Could not connect.<\/r_error>" 
```

我没有别的了。所有信息都正确传递。错误日志中没有任何内容。有任何想法吗？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-11T23:19:38.047

端口 1129 必须为传入和传出打开。双向。

# c# - 处理大于其父视图的子视图的触摸

> ID：14782519
> 
> 赞同：0
> 
> 时间：2013-02-08T22:40:28.903
> 
> 标签：c#, xamarin.ios, touch, subview, touchesbegan

假设我制作了一个包含另一个 UIImageView 的 UIImageView。但是 SubView 比第一个视图大。

![在此处输入图像描述](../Images/0a6eb0b58140325fc88b4ea03cc57ede.png)

绿色子视图明显大于它的超级视图，黑色方块。如果我触摸只有黑色方块的左上角，我会得到“touchbegan image1”，这是我所期望的。如果我触摸黑色方块和绿色方块重叠的区域，我会得到“touchbegan image1”和“touchbegan image2”，这是我所期望的。 **这是我的问题：** 如果我触摸只有绿色方块存在的黑色方块框架之外的区域，我将没有输出。因此，既不为 image1 也不为 image2 调用 TouchesBegan。在这种情况下，当我仅触摸绿色矩形时，我希望为 image2 (Green) 调用 TouchesBegan，*同时仍将 image2 (Green) 保持为 image1 (Black) 的子视图*。那可能吗？

```
 MyImage image1 = new MyImage(new RectangleF(0,0,200,200), "image1");
    image1.BackgroundColor = UIColor.Black;
    this.View.AddSubview(image1);

    MyImage image2 = new MyImage(new RectangleF(50,50,500,500), "image2");
    image2.BackgroundColor = UIColor.Green;
    image1.AddSubview(image2);

public class MyImage : UIImageView
{

    public MyImage ( RectangleF frame, string _Name ) : base(frame)
    {
        Name = _Name;
        UserInteractionEnabled = true;
    }

    public override void TouchesBegan (NSSet touches, UIEvent evt)
    {
        base.TouchesBegan (touches, evt);

        Console.WriteLine("touchbegan " + Name);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T10:26:52.453

Its because you add it as a child of image1\. Image1 listens for touches inside its bound/frame and send it to its child if any. image2, might be bigger, but its touchlistener comes from image1 frame touch.

# ruby-on-rails - Slim 模板中的 zurb 基础图标字体 link_to

> ID：14782525
> 
> 赞同：1
> 
> 时间：2013-02-08T22:40:53.633
> 
> 标签：ruby-on-rails, forms, zurb-foundation, slim-lang

我正在为 Rails 表单使用一个纤薄的模板文件。我想使用 Foundation 图标字体作为链接中的图形，但似乎找不到将字体包含在 link_to 中的方法。这是有问题的代码。

```
h3 Categories

table
  tr
    th <span class="secondary radius label">Category Name</span>
    th colspan="2" <span class="secondary radius label">Actions</span> 
  - for category in @categories do
    tr 
      td #{category.name}
      td #{link_to 'Edit', edit_category_path(category)} <i class="general foundicon-edit"> 
```

在最后一行中，我可以让图标显示在链接旁边（如图所示），但我看不到如何将其嵌入链接标题本身（当前设置为“编辑”）。

非常感谢任何帮助！

仅供参考：：Rails 3.2.11，Ruby 1.9.3，Foundation 3

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:04:58.203

未经测试，但这应该让你接近：

```
td
  = link_to edit_category_path(category) do
      Edit <i class="general foundicon-edit"></i> 
```

这也可能有效：

```
td #{link_to 'Edit <i class="general foundicon-edit"></i>'.html_safe, edit_category_path(category)} 
```

# php - 为什么通过 FTP 上传或复制新照片会阻止浏览器缓存？

> ID：14782527
> 
> 赞同：0
> 
> 时间：2013-02-08T22:41:09.560
> 
> 标签：php, wordpress, apache, safari, centos

我在使用 Apache CentOS 和 Wordpress 时遇到了最奇怪的行为。我有一个正在开发的简单网站。浏览器按预期缓存标题图像，直到我上传新版本或创建副本（通过 Yummy FTP）。原始图像每次都会缓存，但一旦它被替换，即使版本和文件名完全相同，浏览器缓存也不再起作用，它会在每次页面更改时重新加载。浏览器是 Safari。

关于可能导致这种情况的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T22:51:36.030

你的描述不够准确，无法回答这个问题。有不同的缓存机制。要回答这个问题，您必须调试浏览器执行的所有 HTTP 查询并检查请求和响应标头以进行缓存控制：

[http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html)

在 Firefox 上可以通过 firebug 完成，Chrome 内置了开发者工具。对 Safari 进行了快速研究，似乎用它来调试 HTTP 并不容易。但是每个浏览器中的流程都应该非常相似。

很可能即使使用图像缓存浏览器仍在发送请求以检查它们是否已更改并获取

HTTP 304：未修改

来自服务器的响应。

# python - GAE 和 Urlfetch

> ID：14782528
> 
> 赞同：1
> 
> 时间：2013-02-08T22:41:15.893
> 
> 标签：python, google-app-engine

我在 GAE 1.7.4 上使用 urlfetch API....我尝试通过以下方式获取：

```
result=urlfetch(http://localdomain:8080/static/tabconfig.json) 
```

我已经通过 app.yaml 中的处理程序打开了我的静态目录，并通过浏览器下载了这个 json 文件。

但是当我尝试在 GAE 中执行 urlfetch 时，它给了我一个“超出期限错误”。GAE 是否限制从具有相同域的 url 获取？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T08:45:10.257

正如 tesdal 在评论中已经说过的那样，开发服务器是单线程的。这意味着它一次只能处理一个请求。因此，如果您向脚本发起请求，并且该脚本 urlfetches 在您自己的服务器上获取页面，那么您基本上处于死锁状态，因为您的原始请求正在等待您的 urlfetch 返回，而您的 urlfetched 请求正在等待，因为服务器正在处理您的原始请求。

App Engine 团队还在开发一个实验性的线程化新开发服务器，请观看此视频[http://www.youtube.com/watch?v=_rEDCQtj4fo](http://www.youtube.com/watch?v=_rEDCQtj4fo)

如果 tesdal 发布他的评论作为答案，他是第一个发布此评论的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-24T20:30:21.520

您可以设置请求的最后期限，即服务等待响应的最长时间。默认情况下，获取的最后期限是 5 秒。HTTP 请求的最长期限为 60 秒，任务队列和 cron 作业请求的最长期限为 60 秒。

```
result = urlfetch( url=http://localdomain:8080/static/tabconfig.json, deadline=60 ) 
```

# ruby - Ruby Thin Client 监听 HTTP:Put，不知道从哪里开始以及我需要什么

> ID：14782533
> 
> 赞同：1
> 
> 时间：2013-02-08T22:41:35.473
> 
> 标签：ruby, http, thin, put, http-put

我有一个 python 脚本，它通过 HTTP::PUT 将文件作为带有数据变量的附件发送（也可以是 POST）

使用 POST，我可以通过 PHP（在 Apache 上）使用一行代码（`echo file_get_contents($_FILES['file']['tmp_name']);`）

但是尝试在没有 Apache 和 PHP（我不可用）的情况下对 ruby​​ 做同样的事情让我研究在 THIN 上运行的 Ruby 脚本。我设法创建了一个瘦脚本来侦听端口并以 200 OK 响应，但找不到任何示例或清楚地阅读 API 以了解如何捕获 PUT 或 POST 数据。任何代码片段或指针赞赏。

到目前为止我所拥有的：

```
require 'rack' 
process_requests = lambda { |env|
  response = []
  response << 200
  response << {"Content-Type" => "text/plain"}  
  body = ["Now What?"]  
  response << body
  return response
}

thin = Rack::Handler::Thin
thin.run process_requests 
```

输出：

```
>> Thin web server (v1.5.0 codename Knife)
>> Maximum connections set to 1024
>> Listening on 0.0.0.0:8080, CTRL+C to stop 
```

我如何测试它：

`curl --upload-file /tmp/testfile http://localhost:8080`

输出：

```
 % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100    31    0     9  100    22      8     21  0:00:01  0:00:01 --:--:--    21
Now What? 
```

该文件显然已传输，但不知道如何获取它。

一旦我弄清楚如何检查和接收文件，我就可以处理响应头等。

谢谢你的帮助，

# spring-mvc - Spring消息标签javascript转义

> ID：14782536
> 
> 赞同：8
> 
> 时间：2013-02-08T22:42:05.487
> 
> 标签：spring-mvc, jsp-tags

当我们尝试从属性文件中显示标签时，使用 spring 标签，我们可以这样写：

```
<spring:message javaScriptEscape="true" code="label" /> 
```

我不知道有什么用 `javaScriptEscape="true"`。我们为什么需要这个？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-08T22:45:49.660

如果消息是 JavaScript 字符串文字，例如在

```
<script>
    function sayI18nedHello() {
        alert('<spring:message javaScriptEscape="true" code="hello" />');
    }
</script> 
```

然后你需要这个属性，它将转义单引号和双引号、换行符、制表符等，以确保生成的 JavaScript 是有效的。

# lua - 我需要限制图像移动 LOVE2D

> ID：14782539
> 
> 赞同：1
> 
> 时间：2013-02-08T22:42:34.110
> 
> 标签：lua, love2d

我正在使用 Love2d 和 Lua 制作游戏。目前，我有一个人，从左到右“滑行”。我希望能够限制他的动作，这样他就不会掉出屏幕。我试着做一个 if 语句来检测他的 X 是否大于 800，（因为我的窗口大小是 800x600）但它最终还是出现了故障。这是代码。请帮忙？

```
function love.load()
love.graphics.setBackgroundColor(92,217,255)
person={}
person.image=love.graphics.newImage('/sprites/spriteTest.png')
person.x=400
person.y=303
person.speed=200
hills=love.graphics.newImage('/sprites/spriteHills.png')
end
function love.update(dt)

if (person.x>735) then

    if (love.keyboard.isDown('right') or love.keyboard.isDown('d')) then
        if (love.keyboard.isDown('left') or love.keyboard.isDown('a')) then
            person.x=person.x+(person.speed*dt)
        else
            person.x=person.x
        end

    elseif (love.keyboard.isDown('left') or love.keyboard.isDown('a')) then
        if (love.keyboard.isDown('right') or love.keyboard.isDown('d')) then
            person.x=person.x+(person.speed*dt)
        else
            person.x=person.x
        end

    end

elseif (person.x<0) then

    if (love.keyboard.isDown('right') or love.keyboard.isDown('d')) then
        if (love.keyboard.isDown('left') or love.keyboard.isDown('a')) then
            person.x=person.x+(person.speed*dt)
        else
            person.x=person.x
        end

    elseif (love.keyboard.isDown('left') or love.keyboard.isDown('a')) then
        if (love.keyboard.isDown('right') or love.keyboard.isDown('d')) then
            person.x=person.x+(person.speed*dt)
        else
            person.x=person.x
        end

    end

else

    if (love.keyboard.isDown('right') or love.keyboard.isDown('d')) then
        person.x=person.x+(person.speed*dt)
    elseif (love.keyboard.isDown('left') or love.keyboard.isDown('a')) then
        person.x=person.x-(person.speed*dt)
    end

end

end
function love.draw()
love.graphics.draw(hills, 0, 0)
love.graphics.draw(person.image, person.x, person.y)
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T07:05:31.803

`update`这个方法怎么样：

```
function love.update(dt)
  if ((love.keyboard.isDown('right') or love.keyboard.isDown('d')) and person.x < 735) then
    person.x = person.x + person.speed * dt
  end
  if ((love.keyboard.isDown('left') or love.keyboard.isDown('a')) and person.x > 0) then
    person.x = person.x - person.speed * dt
  end
end 
```

基本上你想说`if a movement key is down` **然后** `the object can move`移动。

我也将使用精灵底部边缘的中心作为枢轴点。然后你需要使用`ox = 32`and `ox = 64`（原点偏移）假设你有一个 64 x 64 的精灵。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:14:29.260

我找到了答案。这是代码

```
function love.update(dt)

if (player.x>735) then

    if (love.keyboard.isDown('left') or love.keyboard.isDown('a') or love.keyboard.isDown('right') or love.keyboard.isDown('d')) then
        player.x=player.x-(player.speed*dt)
    end

elseif (player.x<-10) then

    if (love.keyboard.isDown('left') or love.keyboard.isDown('a') or love.keyboard.isDown('right') or love.keyboard.isDown('d')) then
        player.x=player.x+(player.speed*dt)
    end

else

    if (love.keyboard.isDown('right') or love.keyboard.isDown('d')) then
        person.x=person.x+(person.speed*dt)
    elseif (love.keyboard.isDown('left') or love.keyboard.isDown('a')) then
        person.x=person.x-(person.speed*dt)
    end

end

end 
```

它可能看起来不会修复它，但它为我修复了它。我只是设置它，如果他处于边缘，它不会让他走得更远。

# sql - 我可以在 SQL 中使用什么逻辑，我得到两个结果都是正确的，但我只需要选择一个？

> ID：14782543
> 
> 赞同：1
> 
> 时间：2013-02-08T22:42:55.597
> 
> 标签：sql, sql-server

我是一名新手程序员，我也在学习提出正确的问题并成为一名更好的作家，所以如果你发现我提出问题或解释的方式有任何问题，请评论一些提示。开始了：

我有一个用户的请求，他希望我编写一个代码，该代码获取申请特定学习计划（例如：“信息系统”）的申请人被接受的期限。

我不确定这是否是错误的数据或到底发生了什么，但在 QC 中，用户遇到了一个学生，他两次申请了特定的学习计划（2011 年夏季和 2012 年夏季）并且两次都被接受。当用户 QC 时，出于某种原因，Summer 2011 显示在前端。用户已要求我仅显示该学习计划的最新学期。我找不到任何标志或替代品来缩小我的搜索范围。

有谁知道我可以做什么（我可以使用什么逻辑）来选择最新的术语。该表确实有 lastchangedate 列，但我不确定我是否可以使用它，因为学生可以申请 20 个不同的学习计划。

更多信息：

我会将我的代码放入现有的存储过程中。此外，我将在表格中插入此术语信息。

这是我的代码在逻辑上的样子：

```
DECLARE @MiscID int......

SELECT @MiscID = sys_miscinfotablesdetailsid from sys_miscinfotablesdetails 
where      attributename = 'Start Term for Billing'....

INSERT INTO sss_studentstudyprogramsmisc
(  
AttributeValue.......
)

SELECT 

T.Name [AttributeValue],....

FROM

SMS_StudentsInstance i
inner join.....(blah blah)

where WHERE sspm.AttributeValue IS NULL 
```

如果我需要提供更多信息，请告诉我。我会很感激这一点。我问了我团队的高级工程师，他告诉我：“做一些日期时间与学期日期时间的比较。我不知道你如何在当前的夏季学期中完成它。祝你好运:)”。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:46:45.773

您可以使用关键字按`ORDER BY`学生申请的术语`DESC`进行降序排序，然后您可以使用 限制记录数`TOP 1`。网上有很多例子供大家参考。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T22:54:00.170

请参阅以下查询。通过使用公用表表达式，您可以`row_number()`向源表添加一列，并使用该列指定您只需要第一个。

```
create table #t ( id int, string nvarchar(10))

insert into #t values (1, '1')
insert into #t values (1, '1')
insert into #t values (2, '2')
insert into #t values (3, '3')
insert into #t values (4, '4')

create table #newt ( id int, string nvarchar(10))

;with oldt as 
(
   select id, string, 
   rnum = row_number() over(partition by id, string order by id, string) 
   from #t
)
insert into #newt
select id, string
from oldt where rnum = 1 
```

ETA：诀窍是`partition by`应该包含定义唯一性的所有字段。这`order by`是必需的，但在这种情况下并不重要。但是，如果您有主键字段或更改/版本日期字段，则可以将其用于最新的：`order by primaryId desc`.

ETA2：以下是如何将其应用于您的 SP 的概括：

```
DECLARE @MiscID int......

SELECT @MiscID = sys_miscinfotablesdetailsid from sys_miscinfotablesdetails 
where      attributename = 'Start Term for Billing'....

-- Wrap existing select in a CTE.
-- CTE needs to start with a semicolon
-- and needs to be placed above the INSERT
;WITH cte AS (

  SELECT 

  T.Name [AttributeValue],....
     -- Add the row_number function column
     -- Include all fields you are selecting in the partition by
     -- Find appropriate order by 
     rnum = row_number() over(partition by t.Name, ... order by lastchangedate desc)
  FROM

  SMS_StudentsInstance i
  inner join.....(blah blah)

  WHERE sspm.AttributeValue IS NULL 
)
INSERT INTO sss_studentstudyprogramsmisc
(  
AttributeValue.......
)
-- Simple select from the CTE instead 
SELECT AttributeValue, ...
FROM cte
-- ...but only for the first record
WHERE rnum = 1 
```

# sql - 如何获取值列表以及所有相关信息？

> ID：14782544
> 
> 赞同：0
> 
> 时间：2013-02-08T22:42:56.437
> 
> 标签：sql

我在 SQL Server 数据库中有以下表：

```
[ANIMALS]            [COLORS]
ID | NAME            ID | NAME
 1   Cow              1   Blue
 2   Chicken          2   Red
 3   Pig              3   Green
 4   T-Rex            4   Pink
                      5   Orange

  [RELATIONSHIPS]         
ANIMAL ID | COLOR ID  
    1          3
    1          2
    1          5
    2          1
    3          1
    3          4
    4          1
    4          2
    4          5 
```

我正在尝试编写一个 SQL 查询，它将返回动物列表以及它们各自的颜色。我试图实现的目标如下所示：

```
 ANIMAL NAME     COLORS
     Cow            Green/ Red / Orange
     Chicken        Blue
     Pig            Blue/ Pink
     T-Rex          Blue/ Red/ Orange 
```

我已经有一个用户定义的函数，它将创建名为 udf_Delimit_Colors(@animalID) 的分隔字符串（“color/color/etc.”）——@animalID 是该 UDF 中的唯一参数。

我只能通过传入一个animalID返回一行，现在我很困惑如何在不传入任何ID的情况下实现我的目标。

可在以下链接中找到分隔的 SQL 查询： [https ://sites.google.com/site/sqlblindman/creatingcomma-delimitedstrings](https://sites.google.com/site/sqlblindman/creatingcomma-delimitedstrings)

+代表写它的人。

我仍在努力，所以如果我弄清楚了，我会发布答案。提前感谢您的意见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T22:53:58.360

根据您上面的语法，我假设 SQL Server 作为数据库。您可以通过以下方式连接字符串：

```
SELECT a.name,
  LEFT(colors , LEN(colors)-1) colors 
FROM animals a
CROSS APPLY
(
    SELECT c.name + ' / '
    FROM colors c
    left join relationships r
      on c.id = r.[COLOR ID]
    where a.id = r.[ANIMAL ID]
    FOR XML PATH('')
) m (colors) 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/a83ec/11)

或者：

```
select a.name,
  STUFF((SELECT distinct ' / ' + c.name
         from colors c
         left join relationships r
           on c.id = r.[COLOR ID]
         where a.id = r.[ANIMAL ID]
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,2,'') colors
from animals a; 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/a83ec/12)

结果是：

```
|    NAME |                COLORS |
-----------------------------------
|     Cow | Red / Green / Orange  |
| Chicken |                 Blue  |
|     Pig |          Blue / Pink  |
|   T-Rex |  Blue / Red / Orange  | 
```

# php - PHP/Mysql 除法返回带有“逗号”的浮点数，如何使用“点”返回结果

> ID：14782545
> 
> 赞同：0
> 
> 时间：2013-02-08T22:42:57.473
> 
> 标签：php, mysqli

请我必须使用 mysqli 和 php 做一个小微积分，并返回一个浮点数或双精度值，所以我试过：

```
$notes = mysclass_sql::query("SELECT SUM(commentsNote) / COUNT(*) as c
                        FROM comments ")->fetch_object()->c;
return round( $notes , 2) ; 
```

但这会给我一个这样的值**`1,25`**，**`1.25`**即使我尝试使用**str_replace**！

出不来了，求高手帮忙？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T22:45:57.257

您想使用[number_format()](http://php.net/manual/en/function.number-format.php)。

```
$notes = mysclass_sql::query("SELECT SUM(commentsNote) / COUNT(*) as c
                    FROM comments ")->fetch_object()->c;
return(number_format($notes, 2, ".", "")); 
```

仅供参考，如果你用谷歌搜索“php comma decimal”，这是第一次点击。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T22:46:32.593

您可以尝试设置语言环境 -

```
setlocale (LC_ALL, "en-US");  // or "en_US", etc, depending on your server 
```

# wolfram-mathematica - Mathematica：将函数定义为分段定义函数的导数或积分

> ID：14782547
> 
> 赞同：1
> 
> 时间：2013-02-08T22:43:08.543
> 
> 标签：wolfram-mathematica

我正在尝试评估我分段定义的函数。我需要对一个变量进行积分，然后对另一个变量求导（变量是独立的）。但是，我定义函数的方式导致mathematica 抛出错误或无限求值。我相信导数函数不喜欢积分函数的输出格式，反之亦然，当我厌倦了颠倒步骤的顺序时。被积函数不是手动分析的，所以我需要将一个的输出通过管道传输到另一个。谁能告诉我出了什么问题？

```
\[Theta] = 30 Degree; 
d = 50.8*10^-3 ;
reo = (150/2)*10^-3; 
rei = ((reo/Tan[\[Theta]]) - 
    d) Tan[\[Theta]] 

B = 24.4*10^-3; 
\[CapitalGamma] = 10*10^-3; 
l = .2*10^-3; 
\[CurlyPhi] = 20 Degree;

Pe = 101325; 
Ps = 1.1* Pe ;

\[Gamma] = (\[CurlyPhi]*Sin[\[Theta]])/(B*\[CapitalGamma]^3);
Pd[h_] := 
 Sqrt[((Ps^2 + Pe^2*\[Gamma]*h^3*(l + h) + 
      Log[rei/reo])/(1 + \[Gamma]*h^3*(l + h) + Log[rei/reo]))]

rd = Sqrt[reo*rei]
P [r_, h_] := 
  Piecewise[{{Sqrt[
      Pd[h]^2 + .5*(Pe^2 - Pd[h]^2)*Log[rei/reo]*Log[rd/r]], 
     r > rd}, {Sqrt[
      Pd[h]^2 + .5*(Pe^2 - Pd[h]^2)*Log[rei/reo]*Log[r/rd]], r < rd}}];
W[h_] := Integrate[2*Pi*r*P[r, h]/9.8, {r, rei, reo}]
S[h_] := D[W[h], h]

Plot[{P[r, 10*10^-6], P[r, 8*10^-6], P[r, 6*10^-6], P[r, 4*10^-6], 
  P[r, 2*10^-6], P[r, 1*10^-6]}, {r, rei, reo}]
Plot[W[h], {h, 1*10^-6, 10*10^-6}]
Plot[S[h], {h, 1*10^-6, 10*10^-6}] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:56:37.867

您试图在该积分中进行非常多次的非常复杂的计算，然后进行非常非常多的次数来绘制该图。在我的系统上，获得一分需要 10 秒。所以你需要让它更快。我建议像这样编译`P`：

```
P = Compile[{{r, _Real}, {h, _Real}}, 
  Module[{Pdh = Sqrt[(
     Ps^2 + Pe^2 \[Gamma] h^3 (l + h) + Log[rei/reo])/(
     1 + \[Gamma] h^3 (l + h) + 
      Log[rei/reo])]}, \[Sqrt](Pdh^2 + .5 (Pe^2 - Pdh^2) Log[rei/
        reo] Log[Min[rd, r]/Max[rd, r]])]] 
```

这将使事情变得更快，但现在我们需要确保我们始终使用数字表达式，而不是符号表达式。这意味着积分需要成为

```
W[h_] := NIntegrate[(2 \[Pi] r P[r, h])/9.8, {r, rei, reo}] 
```

并且衍生品需要成为

```
Needs["NumericalCalculus`"]
S[h_] := ND[W[hh], hh, h] 
```

这使事情快了大约 100 倍，情节就出来了。您可能仍会看到一些警告消息，但可以忽略它们。抛出一个`Quiet`周围的定义，`W`如果`S`它困扰你。

# asp.net-mvc - 无法初始化 ASP MVC3 ViewModel 的列表属性

> ID：14782551
> 
> 赞同：0
> 
> 时间：2013-02-08T22:43:28.060
> 
> 标签：asp.net-mvc, asp.net-mvc-3, list, icollection

下面是我们在我们正在构建的 ASP MVC3 站点中使用的两个 ViewModel。在下面的代码中，我试图填充名为的变量`TradingPartners` `IList`的`AgentIdDetail`属性。`AgentWithTraining``bigAgent`

为了更好地说明：

`bigAgent`是一个`AgentWithTraining`

`AgentWithTraining`有一个`AgentIdDetail` `ICollection`列表对象作为属性 `AgentIdDetail`有一个`IList`名为的列表对象`TradingPartner`

```
public class AgentWithTraining
{
    public Monet.Models.Agent Agent { get; set; }
    public ICollection<AgentProdTrainDetail> AgentProdTrainDetails { get; set; }
    public ICollection<AgentIdDetail> AgentIdDetails { get; set; }
}

public class AgentIdDetail
{
    public string AgentId { get; set; }
    public string CompanyCode { get; set; }
    public IList<string> TradingPartners { get; set; }
} 
```

问题是以下代码行：

```
bigAgent.AgentIdDetails = new AgentIdDetail(); 
```

这给了我错误：

`Cannot implicitly convert type 'Monet.ViewModel.AgentIdDetail' to 'System.Collections.Generic.ICollection<Monet.ViewModel.AgentIdDetail>'. An explicit conversion exists (are you missing a cast?)`

有人可以解释我需要如何进行初始化`bigAgent.AgentIdDetails`吗？以下是我正在使用的完整代码部分，以防万一。

```
 //Grab Trading partner information and add it to 'trainlist' object
        List<AgentIdToTradingPartner>tradingParter = new List<AgentIdToTradingPartner>();

        var symNumToAgId = from s in db.SymetraNumberToAgentId
                           where s.SymetraNumber == id
                           select s;

        //*******************************************
        //This line is causing the problem
        //*******************************************
        bigAgent.AgentIdDetails = new AgentIdDetail();

        foreach (var s in symNumToAgId)
        {
            AgentIdDetail item = new AgentIdDetail();

            item.AgentId = s.AgentId;
            item.CompanyCode = s.CompanyCode;

            tradingParter = db.AgentIdToTradingPartner
                              .Where(r => r.AgentId == s.AgentId).ToList();

            item.TradingPartners = new List<string>();

            foreach (var t in tradingParter)
            {
                item.TradingPartners.Add(t.TradingPartner.ToString());
            }

            bigAgent.AgentIdDetails.Add(item);
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:42:42.673

您不能以这种方式初始化，因为它`AgentIdDetails`是一个`ICollection<AgentIdDetail>`而不是`AgentIdDetail`.

您必须初始化集合，然后在此集合上添加一个新项目。样品：

```
// initilize as a List<AgentIdDetail>
bigAgent.AgentIdDetails = new List<AgentIdDetail>();

foreach (var s in symNumToAgId)
{
    AgentIdDetail item = new AgentIdDetail();

    item.AgentId = s.AgentId;
    item.CompanyCode = s.CompanyCode;

    tradingParter = db.AgentIdToTradingPartner
                      .Where(r => r.AgentId == s.AgentId).ToList();

    item.TradingPartners = new List<string>();

    foreach (var t in tradingParter)
    {
        item.TradingPartners.Add(t.TradingPartner.ToString());
    }

    bigAgent.AgentIdDetails.Add(item);
} 
```

作为一个好的实践，我喜欢在构造函数的 ViewModels 上初始化我的 Collection 属性，所以我不需要担心填充它时的初始化，除非我需要一个新的，例如：

```
public class AgentWithTraining
{
    public Monet.Models.Agent Agent { get; set; }
    public ICollection<AgentProdTrainDetail> AgentProdTrainDetails { get; set; }
    public ICollection<AgentIdDetail> AgentIdDetails { get; set; }

    public AgentWithTraining()
    {
        this.AgentProdTrainDetails = new List<AgentProdTrainDetail>();
        this.AgentIdDetails = new List<AgentIdDetail>();
    }
} 
```

# xcode - 奇怪的 LLDB 错误 Xcode

> ID：14782552
> 
> 赞同：2
> 
> 时间：2013-02-08T22:43:31.070
> 
> 标签：xcode

我做了一个巨大的项目，突然当我做它时，我得到了这个烦人的 LLDB 错误。除了 LLDB 之外，我没有收到任何错误消息，当我停止调试并在模拟器中运行应用程序时，它工作正常。

这是左侧消息
self AppDelegate * 0x1cd9e3c0 application UIApplication * 0x1cd9a940

没有其他显示。我只使用ARMV7，所以这不是我的问题:(。

有人有什么想法吗？

# ios - 在 iOS 应用程序中使用 Youtube IFrame Player API 并遵守 Apple 指南

> ID：14782553
> 
> 赞同：4
> 
> 时间：2013-02-08T22:43:37.820
> 
> 标签：ios, cocoa-touch, youtube-api, appstore-approval

我们正在构建一个 iOS 应用程序，它的部分功能是播放特定的 youtube 内容。

我已经对在 iOS 应用程序中直接嵌入 youtube 视频进行了一些研究，基本上可以归结为两种选择：

1.  解析 youtube html 并检索视频流直接 URL。然后在 iOS 的原生播放器中播放下载的流。根据 Apple 的指导方针，这很好，但它违反了 Youtube 的 ToS，它清楚地表明所有嵌入都应该使用 Player API 完成。这里的很多帖子都指向了几个可以做到这一点的可可库。

2.  在 UIWebView 中使用 Youtube 的 IFrame API。当然，这不会违反 Youtube 的服务条款。但据我所知，它违反了 Apple 的指导方针，该指导方针表明所有大于几 MB 的 HQ 文件都需要使用 HTTP Live Streaming (HLS) 进行流式传输。Youtube 不通过其 API 支持 HLS 流。

所以，我的问题是 App Store 上的其他应用程序（例如 iPad 版 Jasmine）如何在不违反 Apple 指南和 Youtube 服务条款的情况下嵌入 Youtube 内容？

任何建议将不胜感激，谢谢！

# python - 如何使用 webdriver 和 python 选择 Facebook 共享框架

> ID：14782558
> 
> 赞同：1
> 
> 时间：2013-02-08T22:44:20.827
> 
> 标签：python, webdriver, frame

我的网络应用程序在 facebook 链接上有一个共享，该链接在当前页面中打开一个框架。我需要在一些自动化测试（webdriver、python）期间激活这个框架。这是框架开头的 html：

```
<div class="fb_dialog_content fb_dialog_iframe">
<iframe id="f1c1b40a973212a" class="FB_UI_Dialog" scrolling="no" name="f54b1bf38c5fe6" /> 
```

我无法按名称选择此框架，因为每个呼叫都不同。我无法通过类或使用 webdriver python 的 xpath 找到帧选择方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T04:11:07.003

Try to select the `frame` using the `frame index` value. Then too you not succeed use this [link](https://stackoverflow.com/questions/7534622/selecting-an-iframe-using-python-selenium) to how to use the JavaScript in the selenium. According to python API doc it is possible to switch to the child frames using `Dot` operator. Reference from [Python API doc](https://selenium-python.readthedocs.org/en/latest/navigating.html#popup-dialogs).

# android - 如何通过索引（而不是 id）在 SQLite 中获取一行

> ID：14782559
> 
> 赞同：3
> 
> 时间：2013-02-08T22:44:24.097
> 
> 标签：android, android-listview, android-sqlite

有没有办法通过它在表中的索引/位置而不是它的 id 来获取一行？

例如，我有 3 行带有 ID：

```
Record1
Record2
Record3 
```

现在，如果我使用它的 id 删除第二行，剩下的行将是这样的：

```
Record1
Record3 
```

因为我使用`ListView`位置来确定要删除数据库中的哪一行，所以下次我尝试删除第二行时，我会得到异常，因为 id 为 2 的行不存在。

那么有没有一种方法可以通过表中的索引来检索行？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-08T22:54:36.787

更好的方法是从`ListView`item 表示的对象中获取记录的 id，然后使用它在数据库中获取正确的记录。在您`ListView`的 's`OnItemClickListener`中，该`onItemClick`事件将`AdapterView`作为第一个参数，将所选项目的索引作为第二个参数。从适配器获取该项目并将其转换为它所代表的类型。

```
public void onItemClick(AdapterView<?> arg0, View arg1, int arg2, long arg3) {
    YourClass c = (YourClass)arg0.getItemAtPosition(arg2);
    //index of the record to delete can now be accessed at c.id
} 
```

但是，如果你真的想获得第*n条*记录，我相信你可以做到以下几点：

```
SELECT * FROM TableName LIMIT 1 OFFSET n; 
```

其中 n 是您所追求的索引。这还假设您的结果的排序方式与它们在您的`ListView`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-09-24T14:54:35.120

*SQLite3*自引入 Android 操作系统以来得到了极大的改进。从[官方文档](https://www.sqlite.org/lang_createtable.html#rowid)（用我自己的话来说）：

> All rows within SQLite tables have a 64-bit signed integer key that uniquely identifies the row within its table. This integer is usually called the **"rowid"**. The rowid value can be accessed using one of the special case-independent names: `rowid`, `oid`, or `_rowid_`, in place of a column name. (In the early Android SQLite implementations you had to use `_id` to access the index.)

So today you can do:

```
 SELECT rowid,* FROM tt LIMIT 1 OFFSET 2;
    SELECT rowid,* FROM tt WHERE rowid=2;
    SELECT rowid,* FROM tt WHERE rowid=(SELECT MAX(rowid) FROM tt); -- to get last row index 
```

# iphone - 我可以在我的 appdelegate applicationDidFinishLaunching 中插入 UINavigationController 并在我的笔尖实例化的 UITabBarController 上方设置标题吗？

> ID：14782561
> 
> 赞同：0
> 
> 时间：2013-02-08T22:44:30.087
> 
> 标签：iphone, objective-c, cocoa-touch, ios6, xcode4.6

我正在尝试制作一个具有可选顶级导航控制器的 iPhone 应用程序。

添加它很好，但是尝试设置标题不起作用，除非您尝试添加自己的导航项，此时应用程序崩溃并出现“NSInternalInconsistencyException”，原因是：“无法调用 pushNavigationItem：动画：直接在UINavigationBar 由控制器管理。

```
- (void)applicationDidFinishLaunching:(UIApplication *)application {    

    rootHasNavBar = NO; 

    if (window && viewController)
    {

        // Tab Controller is root:
        if (!rootHasNavBar)
        {
           window.rootViewController = viewController; // viewController:UITabBarController
           [window makeKeyAndVisible];
        }
        else
        {
          // Navigation controller  above UITabBarController
          UINavigationController *navigationController = [[UINavigationController alloc] initWithRootViewController:viewController];
            window.rootViewController = navigationController;
         //Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'Cannot call pushNavigationItem:animated: directly on a UINavigationBar managed by a controller.'

          UINavigationItem* item = [[UINavigationItem alloc] initWithTitle:NSLocalizedString(@"RentalPoint",nil)];
          [ navigationController.navigationBar pushNavigationItem:item animated:YES];

            navigationController.toolbarHidden = YES;
          [window makeKeyAndVisible];

        };

    } 
```

我该怎么做？还是有一些技术原因我不能这样做？

更新：建议在控制器的 viewDidLoad 中简单地移动控制器标题和导航项标题的分配的人对我仍然非常陌生的 Cocoa 架构的一些内部（并且对新手来说非常不直观）方面有所了解。从外观上看像 Cocoa 这样庞大而复杂且不允许您浏览源代码的框架，这是我觉得最难的那种谜。在我的其他语言和工具中，我总是可以阅读并进入代码，包括我的框架。在这里，你不能，所以你必须阅读，阅读，阅读，谢天谢地，有很多很棒的文档资源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:51:24.297

在 UIViewController 的 init 上设置导航标题。

```
self.title = @"My Title";
self.navigationItem.title = @"Nav Title"; //note: this will show-up in the back button when you push a subsequent view 
```

或者如果你真的想将它硬编码到 applicationDidFinishLaunching 例程中，你可以这样做：

```
viewController.title = @"My Title"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T00:33:45.493

我认为标签栏控制器作为导航控制器的根是更复杂的情况，所以我在 IB 中这样做，为代码节省了更简单的情况。首先，我做了以下事情（全部在 IB 中）：

1.  创建了一个新的单视图项目
2.  删除默认vc并添加导航vc
3.  删除了导航vc的默认根（一个表vc）
4.  画了一个标签栏控制器并使其成为根
5.  检查标签栏控制器的导航项并将其标题设置为“租赁点”

我认为这为我的应用程序提供了您所指的“可选案例”，其中标签栏控制器被导航控制器包围（您说“在它之上”，但您的代码说“围绕它，以它为根”）。

现在更简单的情况在appDidFinishLaunching中更容易实现，如下...

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    // if I don't want the optional case, if I just want a tab bar controller as 
    // my window's root, grab it from the navigation controller, and make it the window's
    // root (thereby abandoning the navigation controller)

    if (YES) {
        UINavigationController *navVC = (UINavigationController *)self.window.rootViewController;
        self.window.rootViewController = [navVC.viewControllers objectAtIndex:0];
    }

    return YES;
} 
```

# c# - ApiMember 属性未显示在 ServiceStack 生成的元数据中

> ID：14782562
> 
> 赞同：6
> 
> 时间：2013-02-08T22:44:33.470
> 
> 标签：c#, .net, metadata, servicestack

我正在使用 ServiceStack，我想帮助生成元数据的“自动文档”。

我最近发现了`ApiAttribute`和`ApiMemberAttribute`（[提到这里](https://github.com/ServiceStack/ServiceStack/wiki/Swagger-API)和[这里](https://stackoverflow.com/questions/7172817/documenting-servicestack-web-services/7199335#7199335)）。但是，我*无法*让`http://me/api/metadata?op=ReadFormType`页面为装饰成员发出任何信息。

他是我的 DTO 的精简版（到目前为止它只是一个存根），它使用一个测试属性：

```
[Api("Read FormType")]
[Route("/formTypes/{FormType}", "GET")]
public class ReadFormType
{
    [ApiMember(Name = "X", Description = "X Description",
        ParameterType = "path", DataType = "string", IsRequired = true)]
    public string X { get; set; }
} 
```

该`ApiAttribute`文本*确实*正确显示在元数据响应的顶部，并且该成员在下面的请求 DTO 部分*中*正确列出。

我需要做什么才能`ApiMemberAttribute`显示额外的信息？（或者我误解了这个属性是如何工作的？）

ServiceStack 的版本是 3.9.35。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T22:51:00.783

`Api`和属性目前`ApiMember`用于[ServiceStack 的 Swagger 支持](https://github.com/ServiceStack/ServiceStack/wiki/Swagger-API)。

但我们也会将它们包含在下一个版本的 ServiceStack 中的 ServiceStack 自动生成的元数据页面中。

# c++ - 从与 CGAL::assign 兼容的 CGAL 类派生

> ID：14782563
> 
> 赞同：0
> 
> 时间：2013-02-08T22:44:33.780
> 
> 标签：c++, object, derived-class, assign, cgal

我想从 CGAL::Parabola_segment_2 类派生。因为我想访问两个无法通过公共成员函数访问的受保护数据成员。

```
typedef CGAL::Exact_predicates_exact_constructions_kernel Kernel;
typedef CGAL::Segment_Delaunay_graph_traits_without_intersections_2< Kernel,
    CGAL::Integral_domain_without_division_tag> Gt;
typedef CGAL::Segment_Delaunay_graph_2<Gt> SDG_2;
typedef SDG_2::Vertex_handle Vertex_handle;
typedef SDG_2::Finite_edges_iterator Finite_edges_iterator;
typedef Gt::Line_2 Line_2;
typedef Gt::Ray_2 Ray_2;
typedef Gt::Segment_2 Segment_2;
typedef Gt::Point_2 Point_2;
typedef Gt::Site_2 Site_2;

class Parabola_segment_2 : public CGAL::Parabola_segment_2<Gt> { }; 
```

我的代码可以编译并运行，但下面给出的代码中的 if 语句永远不会返回 true。但我确信它必须为某些值返回 true。

```
.......
CGAL::Object o = sdg.primal(*eit);
Segment_2 s;
Parabola_segment_2 ps;
if(CGAL::assign(s, o)) {
...
} 
```

如果我改变

```
class Parabola_segment_2 : public CGAL::Parabola_segment_2<Gt> { }; 
```

和

```
typedef CGAL::Parabola_segment_2<Gt> Parabola_segmet_2; 
```

然后程序完全按照我的意愿执行，但我无法访问我想要的变量。我的问题是我应该如何派生 CGAL 类以使其与 CGAL::assign() 函数兼容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T06:02:51.483

不要使用模板推导，并明确预期的类型。那是：

```
if( CGAL::assign<CGAL::Parabola_segment_2<Gt> >(ps, o)) {
...
} 
```

# jquery - jQuery 鼠标悬停在 IE、Opera、Chrome 中的奇怪行为

> ID：14782567
> 
> 赞同：0
> 
> 时间：2013-02-08T22:44:51.393
> 
> 标签：jquery, html, css, twitter-bootstrap

我在 css/jQuery 中的菜单有问题，在 Firefox 中运行良好，但在 IE、Opera、Chrome 中...当我将鼠标悬停在元素上时，它会转到页面的左边缘...

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.0/js/bootstrap.min.js"></script>
    <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.0/css/bootstrap.min.css" rel="stylesheet" />

    <style type="text/css"> .outer {width: 46px; height: 40px; position: fixed; z-index: 999999; display: block; top: 25%; right: 0px; background: #036; }.inner {overflow: hidden;width: 100px;} .modal {display: none;} .modal-inner {width: 600px;margin: 100px auto;height: 300px;background: #fff !important;border: 12px solid rgba(222, 222, 222, 0.8);z-index: 999999;border-radius: 5px;}.backdrop {z-index: 999998;}</style>

</head>
<body>

    <div class="outer">
        <div class="inner" style="">Subscription</div>
    </div>

    <script type="text/javascript">
        $('.outer').on('mouseenter', function () {
            $(this).animate({ left: "-=100", width: "+=100" });
        });
        $('.outer').on('mouseleave', function () {
            $(this).delay(200).animate({ left: "+=100", width: "-=100" });
        });
        $('.outer').click(function () {
            $('.outer').animate({ left: "+=146" });
            $('.modal').modal();
        });
    </script>

    <div class="modal">
        <div class="modal-inner">
            Lorem ipsum
        </div>
    </div>

</body>
</html> 
```

我在哪里做错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T22:57:49.420

您的 jQuery 应该在`</head>`. 使用以下内容：

```
<script type="text/javascript">
   $(document).ready(function(){
      $('.outer').on('mouseenter', function () {
        $(this).animate({ left: "-=100", width: "+=100" });
      });
      $('.outer').on('mouseleave', function () {
        $(this).delay(200).animate({ left: "+=100", width: "-=100" });
      });
      $('.outer').click(function () {
        $('.outer').animate({ left: "+=146" });
        $('.modal').modal();
      });
   });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T19:38:25.703

发生这种情况是因为我认为 firefox 非常擅长猜测左偏移的值`.outer`（当它没有明确指定时），因此`$(this).animate({ left: "-=100", width: "+=100" });`可以完美地工作。如果没有定义其他浏览器，并且它不是自动计算的，那么 animate 会立即将其设置为 0，然后在左侧进行动画处理，该左侧被剪裁且未显示。在这个解决方案中，我们明确地将 left 设置为 100%，并添加一个等于 div.outer 宽度的负边距以正确定位它。像这样

```
.outer {
width: 46px; height: 40px; position: fixed; z-index: 999999; display: block; top: 25%; right: 0px; background: #036;
//add this
left:100%;
margin-left: -46px;
} 
```

[工作小提琴](http://jsfiddle.net/jf8Et/)

# c++ - 如何从模板化的基础中消除多个继承的 typedef？

> ID：14782568
> 
> 赞同：9
> 
> 时间：2013-02-08T22:45:02.983
> 
> 标签：c++, inheritance, c++11, typedef, multiple-inheritance

**编辑：我在 Windows 上使用 tdm-gcc-4.7.1-2**

不知道如何解决这个问题。我想将其用作一种类型列表，让我知道我正在尝试使用`B`'s typedefs 中不存在的类型。

```
template <typename T, typename U>
struct A {
    typedef pair<T, U> type;
};

struct B : A<int, string>, A<int, float> {};

B::type foo; // won't compile, ambiguous reference, as expected
B::A<int, int>::type bar; // compiles fine?? :( 
```

有没有办法让它失败`A<int, int>`（以及任何其他`A`不被继承的`B`），或者另一种方法来解决这个问题？我想我可以使用 a`tuple`并通过它递归，`is_same`对每个元素与我提供的元函数进行比较，但这似乎更容易......起初：\

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T23:17:18.910

发生这种情况是因为类模板注入了它们的模板名称；注入的名称可以用作模板或引用模板实例化的类型（14.6.1p1）。注入的类名然后由派生类继承（10.2p5）；将其用作模板是明确的（它是相同的模板，但它是继承的），因此是允许的。

要修复您的程序，请尝试使用`is_base_of`：

```
struct B : A<int, string>, A<int, float> { };
template<typename T, typename U>
using check_A = typename std::enable_if<std::is_base_of<A<T, U>, B>::value, A<T, U>>::type;

check_A<int, float>::type bar1; // compiles
check_A<int, int>::type bar2; // error 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T23:06:34.253

在 §11.1/5 中，标准说：

> 在派生类中，基类名称的查找将在声明它的范围内找到注入类名称而不是基类的名称。在声明它的范围内，注入的类名可能比基类的名称更难访问。

`A`.范围内的注入名称也是如此`B`。根据§14.1/4，它指的是模板`A`，而不是基类（因为它会模棱两可）。

就像在 的范围内一样`A`，如果你说只是`A`，它就是类本身（但它是这个上下文中的模板）。您正在使用这个注入的名称，因此名称`B::A`与`::A`. 我认为没有办法抑制这种行为。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-08T23:07:02.060

该标准明确允许这样做，尽管它有点令人困惑。从草案 14.6.1-4 开始：

> 查找注入类名称 (10.2) 的查找在某些情况下可能会导致歧义（例如，如果在多个基类中找到它）。如果找到的所有注入类名称都引用同一类模板的特化，并且如果名称后跟模板参数列表，则引用是指类模板本身而不是其特化，并且不是模棱两可的。

```
[ Example: 
template <class T> struct Base { }; 
template <class T> struct Derived: Base<int>, Base<char> { 
typename Derived::Base b; // error: ambiguous 
typename Derived::Base<double> d;// OK 
}; 
— end example ] 
```

# jquery - 使用 jquery 在按钮单击时启用文本框

> ID：14782569
> 
> 赞同：2
> 
> 时间：2013-02-08T22:45:07.433
> 
> 标签：jquery

如何在链接按钮单击时启用文本框，我正在禁用 html 中的文本框

这是我正在尝试使用的 jquery 代码：

```
<script type="text/javascript" language="javascript">
        $(document).ready(function () {
        $('#lEdit').click(function () {
            $('#CorporationName').removeAttr('disabled');
        });
    });
</script>

<asp:LinkButton ID="lEdit" runat="server" ClientIDMode="Static" >Edit</asp:LinkButton>
<asp:Label ID="lblCorporationName" runat="server" Text="Corporation Name" Width="130px"></asp:Label>
<asp:TextBox ID="CorporationName" runat="server" Width="250px" ClientIDMode="Static" Enabled="false"></asp:TextBox> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T22:48:06.947

看起来你做对了。如果这不起作用，请尝试：

```
$('#CorporationName').prop('disabled', false); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T22:49:42.000

虽然将属性设置为 false 甚至 null 可能会起作用，但您可能想尝试[jQuery 的`removeProp()`function](http://api.jquery.com/removeProp/)。它旨在做到这一点。

> 描述：删除匹配元素集的属性。

```
$('#CorporationName').removeProp('disabled'); 
```

* * *

请注意，以这种方式删除属性后，您将无法再次禁用文本框。

# c# - 自定义流可以抛出自己的自定义异常还是应该只抛出 IOException？

> ID：14782570
> 
> 赞同：0
> 
> 时间：2013-02-08T22:45:12.267
> 
> 标签：c#, exception-handling, stream

我有自己的 Connection 类和 ConnectionStream 类，它基本上只是包装了 Connection 的发送/接收方法。

Connection 发送/接收方法可以抛出异常，如 ServerClosedConnException 或 NetworkShutdownException

我的 Stream 是否应该捕获这些并将它们包装在 IOException 中（使用 innerException），或者它可以让它们冒泡给用户（当然还有一些 try-finally 来处理清理）

我在 .NET 框架中看到，NetworkStream 将来自 Socket 的任何错误包装在 IOException 中

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T22:59:10.523

*除非您打算处理*它们，否则不要捕获异常。它们将在调用堆栈中冒泡，直到上游处理程序捕获并处理它们，或者程序终止。

如果您的 Connection 类抛出了一个非常具体的异常，例如`ServerClosedConnException`or `NetworkShutdownException`，而您抓住了它并重新抛出了一个*不太具体* `IOException`的，我看不出它是如何增加任何价值的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T23:14:26.290

Stream 基类充当其子类的事实上的契约。如果您计划在公共 API 中公开您的子类，最好遵守 Stream 类的记录行为，因为您的子类的用户可能很高兴地不知道它的特定类型。例如，如果您希望遵守 Read 方法的约定，则您的实现不应公开任何不属于[http://msdn.microsoft.com/en-us/library/中列出的类型的异常system.io.stream.read](http://msdn.microsoft.com/en-us/library/system.io.stream.read)。

但是，这并不意味着您不能使用更具体的异常类型。如果您有理由无论如何都要创建自定义异常类型（假设您在阅读 JerKimball 提到的[设计指南](http://msdn.microsoft.com/en-us/library/vstudio/ms229014%28v=vs.100%29.aspx)后认为这是一个好主意），它可能是 IOException 的子类。但是，这可能不是必需的，除非您的 Stream 子类的用户除了记录异常详细信息之外可能还想做一些事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-08T22:59:41.020

最好的做法是让异常冒泡，**除非**您有更多细节要添加**，或者**您可以自己处理异常。在第一种情况下，您抛出一个新异常，实际异常为`InnerException`.

阅读MSDN 中的[包装异常](http://msdn.microsoft.com/en-us/library/vstudio/ms229049%28v=vs.100%29.aspx)。

在你的情况下，我会让它冒泡。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-08T22:55:25.353

以下是例外指南所说的：

[参考]

*   [设计自定义异常](http://msdn.microsoft.com/en-us/library/vstudio/ms229064%28v=vs.100%29.aspx)
*   [选择正确的异常类型来抛出](http://msdn.microsoft.com/en-us/library/vstudio/ms229021%28v=vs.100%29.aspx)
*   [异常设计指南](http://msdn.microsoft.com/en-us/library/vstudio/ms229014%28v=vs.100%29.aspx)

最相关的部分：

```
Do throw the most specific (the most derived) exception that is appropriate. 
For example, if a method receives a null (Nothing in Visual Basic) argument, 
it should throw System.ArgumentNullException instead of its base type 
System.ArgumentException. 
```

我会推断这也意味着在您的情况下，最详细的例外是要传播的“正确”例外；对您的异常类型进行一些假设，它们可能是要传播的“正确”类型，*可能*包含在“ConnectionException”自定义异常中。

也就是说，我确实看到考虑将它包装在 中是“有意义的” `IOException`，因为这是异常的“形状”；但如果我不同意这些指导方针并且我按照自己的方式行事，它通常会在以后的路上咬我。:)

# xna - 当文件明显存在时，Directory.GetFiles 给出的数组中的 XNA ContentLoadException

> ID：14782571
> 
> 赞同：0
> 
> 时间：2013-02-08T22:45:28.060
> 
> 标签：xna, loading, spritefont

首先我想说这不是 Content.RootDirectory = "Content"; 问题。我已经尝试过使用和不使用那行代码。我有一个名为 FileFactory 的类，它有三个字典。一种用于纹理，一种用于声音，一种用于精灵字体。我还有其他工厂可以为其他类型的对象加载 XML 文件，并且它们工作得很好。这是加载字体的代码：

```
 public static void LoadFonts(ContentManager content)
    {
        string[] filePaths = Directory.GetFiles(@"Content\fonts\");
        string key;

        foreach (string s in filePaths)
        {
            key = Path.GetFileNameWithoutExtension(s);
            Fonts.Add(key, content.Load<SpriteFont>(s));
        }
    } 
```

它给出的错误是：“加载“Content\fonts\ammoFont.xnb”时出错。找不到文件。” 即使该文件显然在那里，考虑到它必须在目录中才能作为字符串添加到 filePaths 数组中。我什至检查了文件夹，它就在那里。这是完整的错误：

> Microsoft.Xna.Framework.Content.ContentLoadException 未处理
> 消息=加载“Content\fonts\ammoFont.xnb”时出错。文件未找到。
> \Users\Chris\Documents\Visual Studio 2010\Projects\WindowsGame1\WindowsGame1\WindowsGame1\Game.cs：Microsoft.Xna.Framework.Game.RunGame(Boolean useBlockingRun) at Microsoft.Xna.Framework.Game.Run( ) 在 C:\Users\Chris\Documents\Visual Studio 2010\Projects\WindowsGame1\WindowsGame1\WindowsGame1\Program.cs:line 15 InnerException: System.IO.FileNotFoundException Message= 中的 WindowsGame1.Program.Main(String[] args)加载“Content\Content\fonts\ammoFont.xnb.xnb”时出错。文件未找到。Source=Microsoft.Xna.Framework StackTrace: 在 Microsoft.Xna.Framework.TitleContainer.OpenStream(String name) 在 Microsoft.Xna.Framework.Content.ContentManager.OpenStream(StringassetName) InnerException:

答：更改此代码：

```
Fonts.Add(key, content.Load<SpriteFont>(s)); 
```

对此：

```
Fonts.Add(key, content.Load<SpriteFont>("fonts\\" + key)); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T00:52:06.543

游戏内容路径必须相对于您的`Content.RootFolder`（默认为“Content\”）并且不得包含文件扩展名（因此避免重复文件名，即使扩展名不同）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T02:23:20.000

从异常消息中，您调用它的字符串看起来是错误的。内容在那里两次，扩展名在那里两次：

```
Error loading "Content\Content\fonts\ammoFont.xnb.xnb" 
```

您没有发布初始化数组的代码，但如果您在定义中有它们，请删除它们。

# java - 如何拆分像 {200,200} 这样的字符串

> ID：14782578
> 
> 赞同：1
> 
> 时间：2013-02-08T22:46:00.637
> 
> 标签：java, regex, string, split

我想将值拆分`{200,200}`为两个字符串（`200`和`200`），删除逗号和括号。

但是当我尝试使用标准模式时，`^\{*|,|\}*$`我得到一个错误（非法转义字符）我如何在 Java 中进行这种拆分？

```
String[] d = a.split("^\{*|,|\}*$"); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T22:47:18.690

在 Java 中，您必须将正则表达式中的转义字符加倍：

```
String [] data = a.split("^\\{*|,|\\}*$"); 
```

这是因为正则表达式在字符串文字中，而转义字符在字符串文字中已经有意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T22:50:25.800

试试这个更简单的正则表达式：

```
String[] data = a.split("[,{}]"); 
```

答案将在职位`data[1]`和`data[2]`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T23:02:21.823

对于您的特定示例，这应该比 split 快得多：

```
int i = a.indexOf(',');
String s1 = a.substring(1, i);
String s2 = a.substring(i+1, a.length()-1); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T21:40:29.090

如果您所有的初始数据字符串都以 开头`{`，以结尾`}`并且可能包含许多逗号分隔的值，那么拆分将像`a.substring(1, a.length()).split(",")`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-10T00:40:16.240

直接的问题（正如另一位响应者[指出的那样](https://stackoverflow.com/a/14782597/20938)）是您没有转义反斜杠以在 Java 字符串文字中使用。

但`split()`无论如何，这对这项工作来说是错误的工具。通过捕获组执行正常匹配并提取所需的子字符串要容易得多：

```
String[] result = new String[2];
Pattern p = Pattern.compile("^\\{(\\d+),(\\d+)\\}$");
Matcher m = p.matcher("{200,200}");
if (m.matches()) {
    result[0] = m.group(1);
    result[1] = m.group(2);
} 
```

我知道对于这样一个简单的任务来说代码似乎太多了，但这对你来说就是 Java。

# android - 在继续使用应用程序之前等待 SoundPool 加载

> ID：14782579
> 
> 赞同：5
> 
> 时间：2013-02-08T22:46:09.037
> 
> 标签：android, soundpool

我正在按照教程将 SoundPool 集成到我的应用程序中，这是教程中给出的代码：

```
package com.example.soundpoolexample;

import android.app.Activity;
import android.media.AudioManager;
import android.media.SoundPool;
import android.media.SoundPool.OnLoadCompleteListener;
import android.os.Bundle;
import android.util.Log;
import android.view.MotionEvent;
import android.view.View;
import android.view.View.OnTouchListener;

public class SoundPoolExample extends Activity implements OnTouchListener {
    private SoundPool soundPool;
    private int soundID;
    boolean loaded = false;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        View view = findViewById(R.id.textView1);
        view.setOnTouchListener(this);
        // Set the hardware buttons to control the music
        this.setVolumeControlStream(AudioManager.STREAM_MUSIC);
        // Load the sound
        soundPool = new SoundPool(10, AudioManager.STREAM_MUSIC, 0);
        soundPool.setOnLoadCompleteListener(new OnLoadCompleteListener() {
            @Override
            public void onLoadComplete(SoundPool soundPool, int sampleId,
                    int status) {
                loaded = true;
            }
        });
        soundID = soundPool.load(this, R.raw.sound1, 1);

    }

    @Override
    public boolean onTouch(View v, MotionEvent event) {
        if (event.getAction() == MotionEvent.ACTION_DOWN) {
            // Getting the user sound settings
            AudioManager audioManager = (AudioManager) getSystemService(AUDIO_SERVICE);
            float actualVolume = (float) audioManager
                    .getStreamVolume(AudioManager.STREAM_MUSIC);
            float maxVolume = (float) audioManager
                    .getStreamMaxVolume(AudioManager.STREAM_MUSIC);
            float volume = actualVolume / maxVolume;
            // Is the sound loaded already?
            if (loaded) {
                soundPool.play(soundID, volume, volume, 1, 0, 1f);
                Log.e("Test", "Played sound");
            }
        }
        return false;
    }
} 
```

问题是，我想确保应用程序只有在成功加载 SoundPool 后才会向前移动，而不必在每次播放声音之前检查它是否已加载。我该怎么做？

我确信这是一个糟糕的解决方案，但是在我将声音文件加载到 onCreate 之后，这样的事情会起作用吗？：

```
...

    soundID = soundPool.load(this, R.raw.sound1, 1);
    while (!loaded) {}

... 
```

我确信有更好的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:52:26.450

你可以有一个优雅的解决方案`Semaphore`，但是尽量*避免*阻塞`onCreate()`，因为应用程序不会响应，这里的代码只是为了说明使用`Semaphore`

```
public class SoundPoolExample extends Activity implements OnTouchListener {

public static final Semaphore semaphore = new Semaphore(0);

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    soundPool.setOnLoadCompleteListener(new OnLoadCompleteListener() {
        @Override
        public void onLoadComplete(SoundPool soundPool, int sampleId,
                int status) {

            semaphore.release();
        }
    });
    soundID = soundPool.load(this, R.raw.sound1, 1);

    // Will block since there is not permits (the semaphore is initialized with 0)
    // then will continue once semaphore.release(); is called i.e. after loading is finished
    semaphore.acquire();
} 

// rest of your class

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-19T13:20:57.980

我想大家在使用SoundPool的时候，要注意两种情况：

1.  对于 API+21，SoundPool 已弃用，您应该使用`SoundPool.Builder`
2.  如果您的 SoundPool 在主线程中运行，请将其带到另一个线程，因为它会阻塞您的 UI

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-28T23:36:03.620

我尝试了 iTech 的信号量解决方案，但没有成功。应用程序就在那里等待永远。

onCreate 是用主线程调用的。该线程创建声音池，开始加载声音，然后将自身停在等待加载完成。似乎它应该工作，对吧？

经过一番调查，我发现 SoundPool 具有始终使用 Looper/Handler 机制与主线程一起运行 onLoadComplete 的未记录行为。由于主线程处于停顿状态，它无法接收该事件，因此应用程序挂起。

我们可以在 SoundPool.java 的 Android 源代码中看到它是如何工作的：

```
public void setOnLoadCompleteListener(SoundPool.OnLoadCompleteListener listener)
{
    synchronized(mLock) {
        if (listener != null) {
            // setup message handler
            Looper looper;
            if ((looper = Looper.myLooper()) != null) {
                mEventHandler = new EventHandler(mProxy, looper);
            } else if ((looper = Looper.getMainLooper()) != null) {
                mEventHandler = new EventHandler(mProxy, looper);
            } else {
                mEventHandler = null;
            }
        } else {
            mEventHandler = null;
        }
        mOnLoadCompleteListener = listener;
    }
} 
```

这表明它默认使用主线程循环器，除非您有自己设置的循环器。

最简单的解决方案是在一个新线程中运行整个声音加载过程并立即从主线程返回。然后，如果需要，您可以使用主线程显示加载屏幕。当声音被加载时，主线程可以自由地接收 onLoadComplete 调用并向声音加载线程发出信号。声音加载线程可以等待带有信号量的信号或等待/通知共享对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-26T18:35:52.397

正确解决这个问题有点棘手。我通过以下方式处理类似的情况。从结构上看，它看起来像这样：

1.  `handler`在主线程上实例化。
2.  `handleMessage`已实现，它负责处理正在加载的所有声音样本的自定义通知消息。
3.  A`SoundPool`在主线程上实例化。
4.  新线程已启动，其中：

    4.1 设置`SoundPool.OnLoadCompleteListener`使用来自主线程的实例化处理程序发送自定义通知消息。

    4.2 使用实例化的 soundPool 发出声音样本的异步加载（类的`load`方法`SoundPool`）

然后，有一个变量保存声音样本加载的状态。它可以有三种状态：*未加载*、*加载*、*加载*。

此变量的状态设置为从上述第 4 步开始在线程中*加载。*

此变量的状态设置为在自定义通知消息到达时*加载。*`handleMessage`

在播放任何声音之前检查此状态变量。如果尚未加载声音样本，则会显示一个半全屏对话框，说明正在加载声音样本，并在加载完成后自动消失。用户无法关闭该对话框。这是`handleMessage`通过调用该`dismiss`对话框的方法（如果显示）以编程方式从方法执行的。该对话框有一个很好的进度条动画。这是特定于我的应用程序的，它可以针对其他应用程序以不同的方式完成。

你可能会问为什么它做得这么复杂。问题是整个 Android GUI API 是一个事件机器，根据定义，您自己在主线程上运行的代码不应执行任何耗时的过程，因为这会使整个 GUI 无响应。事实上，当 Android 检测到此类情况时，它会将它们记录到 logcat 中。例如，如果我使用了信号量，则不会有进度条动画，因为主 GUI 线程将被阻塞。以这种方式使用信号量只是展示了不了解 Android GUI 架构的事实，并且如果释放信号量的部分出现问题，它很容易导致应用程序挂起。

希望这可以帮助。

# linux - 解析 XML - 从标签中减去值

> ID：14782581
> 
> 赞同：0
> 
> 时间：2013-02-08T22:46:15.963
> 
> 标签：linux, xml-parsing, sed, awk, bc

我在一个非常大的文件中有以下 xml 结构：

```
<sit>619709.6044;144998.7059;-090372.58119</sit>
<vll>0;0;0</vll>
<cor>255;0;255</cor> 
```

如何减去**坐**标签中的值？该标签由三个值组成，由**;分隔。**每个都必须从特定数字中减去。

可以使用任何 unix 工具。（awk、sed、bc 等）

因此，如果该特定数字对于第一个值是 1000，对于第二个值是 100，对于第三个值是 10，则结果将是：

```
<sit>618709;144898;-090362</sit>
<vll>0;0;0</vll>
<cor>255;0;255</cor> 
```

无需保留分数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T00:50:49.580

```
awk '
BEGIN{ split("1000 100 10",dec); FS=OFS=";" }
gsub(/<\/?sit>/,"") {
   for (i=1;i<=NF;i++)
      $i = int($i - dec[i])
   $0="<sit>" $0 "</sit>"
}
1' file
<sit>618709;144898;-90382</sit>
<vll>0;0;0</vll>
<cor>255;0;255</cor> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T01:37:28.147

这是使用`awk`. 像这样运行：

```
awk -v a=1000 -v b=100 -v c=10 -F "[<;>]" -v OFS=";" -f ./script.awk file 
```

内容`script.awk`：

```
/^<sit>/ && /<\/sit>$/ {
    $0 = "<sit>" format($3, a) OFS format($4, b) OFS format($5, c) "</sit>"
}1

function format(field, var) {
    f = sub(/^-/, "", field)
    return (f == 1 ? "-" : "") sprintf("%06d", int(field-var))
} 
```

结果：

```
<sit>618709;144898;-090362</sit>
<vll>0;0;0</vll>
<cor>255;0;255</cor> 
```

* * *

您还没有完全清楚如何格式化输出。看起来您希望您的整数最多填充六个前导零，无论它们是正数还是负数。上面的脚本会做到这一点。如果那个零实际上是一个错字，那么这个单行就足够了：

```
awk -v a=1000 -v b=100 -v c=10 -F "[<;>]" -v OFS=";" '/^<sit>/ && /<\/sit>$/ { $0 = "<sit>" sprintf("%06d",int($3-a)) OFS sprintf("%06d",int($4-b)) OFS sprintf("%06d",int($5-c)) "</sit>" }1' file 
```

结果：

```
<sit>618709;144898;-90382</sit>
<vll>0;0;0</vll>
<cor>255;0;255</cor> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T23:10:04.583

在解析器`perl`的帮助下使用的一种方法：`XML::Twig`

假设`xmlfile`有以下数据：

```
<root>
        <sit>619709.6044;144998.7059;-090372.58119</sit>
        <vll>0;0;0</vll>
        <cor>255;0;255</cor>
</root> 
```

和代码`script.pl`：

```
#!/usr/bin/env perl

use warnings;
use strict;
use XML::Twig;
use POSIX qw<floor ceil>;

my @substracts = qw<1000 100 10>;

my $twig = XML::Twig->new(
    twig_handlers => {
        'sit' => sub { 
            my @sit_values = map { $_ < 0 ? ceil $_ : floor $_  } split /;/, $_->text_only;
            for my $i ( 0 .. $#substracts ) { 
                $sit_values[ $i ] -= $substracts[ $i ];
            }   

            $_->set_text( join q|;|, @sit_values );
        }   
    },  
    pretty_print => 'indented',
)->parsefile( shift )->print; 
```

像这样运行它：

```
perl-5.14.2 script.pl xmlfile 
```

这会产生：

```
<root>
  <sit>618709;144898;-90382</sit>
  <vll>0;0;0</vll>
  <cor>255;0;255</cor>
</root> 
```

# asp.net-mvc-3 - 自动记录方法进入和退出

> ID：14782585
> 
> 赞同：0
> 
> 时间：2013-02-08T22:46:39.620
> 
> 标签：asp.net-mvc-3, c#-4.0, logging

我正在编写一个应用程序框架，该框架将被许多客户端应用程序使用并用作构建它们的核心。该框架本身是一个 MVC3（当前）应用程序，它作为 Nuget 包使用，并提供锁定布局、UI 模板和统一的方法，如 IoC、部署打包等。我们面临的一个问题目前正在努力引入跨客户端应用程序的方法进入和退出日志记录。这不是关于 SO 的新主题 - 我看过一些处理它的帖子：

*   [自动记录方法的进入和退出以及参数？](https://stackoverflow.com/questions/171285/logging-entry-and-exit-of-methods-along-with-parameters-automagically)
*   [如何在 C# 中拦截方法调用？](https://stackoverflow.com/questions/25803/how-do-i-intercept-a-method-call-in-c#25825)

理想情况下，我希望客户端应用程序的开发人员不必考虑这种级别的日志记录，并让框架在后台处理它，而无需开发人员对其代码进行任何更改。正如链接帖子中提到的，有 PostSharp 和其他 AOP 框架之类的东西，但它们仍然依赖添加的属性来启用日志记录，这使得客户端开发人员负责添加这些属性。理想情况下，我希望框架代码能够管理所有这些，而无需客户端开发人员做任何事情。感觉就像是 IoC 框架之一应该提供的那种东西，但我还没有找到任何符合要求的东西。我们目前正在将 NInject 用于框架 IoC 容器，但这可能会改变，所以我没有绑定到任何特定的容器。我也没有绑定到特定的日志框架。想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T09:44:15.773

Autofac 有一个扩展，它使用 DynamicProxy 来实现方法拦截。您可以使用它在应用程序中通过 IoC 容器（或根据您在应用程序框架中定义的某些约定）解析的所有类上设置方法进入和退出日志记录。[http://code.google.com/p/autofac/wiki/DynamicProxy2](http://code.google.com/p/autofac/wiki/DynamicProxy2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-18T09:16:32.893

`Unity`为`method interception`. 在 MSDN 上，有一篇文章描述了如何在横切关注点上使用这个框架。`Logging`为和提供了代码示例`Caching`。 [https://msdn.microsoft.com/en-us/library/dn178466(v=pandp.30).aspx](https://msdn.microsoft.com/en-us/library/dn178466(v=pandp.30).aspx)

# php - 简单的 HTML DOM 致命错误调用非对象上的成员函数 find()

> ID：14782586
> 
> 赞同：1
> 
> 时间：2013-02-08T22:46:40.377
> 
> 标签：php

我使用简单的 HTML DOM 库并且我收到错误

致命错误：在第 14 行的 /home/rodingo/public_html/crawler/music.php 中的非对象上调用成员函数 find()

但是它在本地主机上运行良好，但在我的专用服务器上导致问题。cURL, fopen 一切都已启用，但仍然。

```
 include('includes/simple_html_dom.php');

$html = file_get_html('http://mp3skull.com/mp3/'.$mp3name.'.html');
$list = array();
echo $html;
foreach ( $html->find('div#song_html ') as $e ) {  // <-- LINE 14
 $song = array();
    $song['bit'] = preg_replace('!\s+!', ' ',$e->find('div', 0)->plaintext);
    $song['title'] = preg_replace('!\s+!', ' ',$e->find('div', 1)->plaintext);
    $song['url'] = preg_replace('!\s+!', ' ',$e->find('a', 0)->href);
    $list[] = $song;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:01:18.383

您正在使用简单的 HTML DOM，所以我假设您想使用`file_get_html`而不是`file_get_contents`.

`file_get_contents`返回一个字符串，而`file_get_html`返回一个 HTML DOM 对象。

```
$html = file_get_html('http://mp3skull.com/mp3/'.$mp3name.'.html'); 
```

# css - a.selected 的 CSS 问题

> ID：14782592
> 
> 赞同：-1
> 
> 时间：2013-02-08T22:47:06.070
> 
> 标签：css

我有一个关于如何修改已选择链接的颜色的问题。 [http://www.northernvirginiapaintingcontractors.com](http://www.northernvirginiapaintingcontractors.com) 点击“联系我们”，然后点击 1 个链接。

我无法确定为什么这种颜色会变成紫色。如果有人能看到这一点，我将不胜感激。

我认为这与以下任何一个定义有关：

```
.contactmenu li a:link {
/*float: left;*/
text-decoration: none;
color: #A6BDCB;    
} 

.contactmenu li a:hover, .contactmenu li a.selected {                 
/*color: #B6B6B6;*/
color: #A6BDCB;
text-decoration: underline;
} 
```

这是完整的相关CSS：

```
.contactblocktheme {                    
/*border:5px solid #cd0000;*/
padding:0;                                 
}

.contactblocktheme p {
padding: 1px 1px 1px 2px;
font-family: Arial;
font-size: 13px;
/*background-color: navy;*/
width: auto;
}

.contactblocktheme {                    
/*border:5px solid #cd0000;*/
padding:0;                                 
}

.contactblocktheme p {
padding: 1px 1px 1px 2px;
font-family: Arial;
font-size: 13px;
/*background-color: orange;*/
width: auto;
}

.contactblocktheme .column {
padding: 6px 3px 0 0;
font-family: Arial Black;
font-size: 12px;
/*background-color: olive;*/
}

.contactmenu {
width:122px;       
/*padding:10px;*/
position:absolute;
visibility:hidden;
border:1px solid #D7D7D7;
border-top-width:1px;
/*background-color: yellow;*/
-webkit-box-shadow: 5px 5px 5px #c8c8c8;    
-moz-box-shadow: 5px 5px 5px #c8c8c8;
/*box-shadow: 5px 5px 5px #c8c8c8;*/
}

.contactmenu .column {       
float:left;
text-align:left;
/*background-color:#4F4D4D;*/
background-color: #D7D7D7;
}

.contactmenu .column ul {
margin: 0 0 0 4px;
padding: 0 0 0 0;
list-style:none;
}

.contactmenu .column ul li {
margin-bottom: 7px;
}

.contactmenu a{
}

.contactmenu li a:link {
/*float: left;*/
text-decoration: none;
color: #A6BDCB;    
} 

.contactmenu li a:hover, .contactmenu li a.selected {                 
/*color: #B6B6B6;*/
/*color: #A6BDCB;*/
text-decoration: underline;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T22:59:15.220

在 上设置`:visited`样式`.contactmenu li a`。这种风格可以与您使用的风格相匹配`:link`。

```
.contactmenu li a:visited {
  /* styles here */  
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T23:07:55.687

CSS 中与此定义存在冲突：

```
.contactmenu a{
} 
```

我删除了它并且工作正常。

# internet-explorer - AudioJS 不工作 IE8 - 运行时错误

> ID：14782595
> 
> 赞同：0
> 
> 时间：2013-02-08T22:47:10.777
> 
> 标签：internet-explorer, runtime-error, html5-audio, playback

我正在使用 AudioJS ( [http://kolber.github.com/audiojs/](http://kolber.github.com/audiojs/) ) 将音频添加到我正在设计的网站。我有它的功能，但由于某种原因它不能在 IE8 中工作 - 在 Chrome、Firefox 和 Safari 中工作。

`javascript`看起来像： http : [//new.joshrodg.com/wp-content/themes/choosedumont/audio/audio.js](http://new.joshrodg.com/wp-content/themes/choosedumont/audio/audio.js)

`code`看起来像：

```
<script type="text/javascript">
    audiojs.events.ready(function() {
    audiojs.createAll();
});
</script> 
```

`tag`看起来像：

```
<audio src="http://www.weatheranswer.com/public/frank_sinatra_let_it_snow.mp3" preload="auto"></audio> 
```

**Internet Explorer 8 的错误信息：**

* * *

网页错误详情

用户代理：Mozilla/4.0（兼容；MSIE 8.0；Windows NT 5.1；Trident/4.0）时间戳：2013 年 2 月 8 日星期五 22:41:12 UTC

消息：未知的运行时错误行：272 字符：9 代码：0 URI： http: [//new.joshrodg.com/wp-content/themes/choosedumont/audio/audio.js](http://new.joshrodg.com/wp-content/themes/choosedumont/audio/audio.js)

* * *

**第 272 行内容如下**： element.outerHTML = wrapper.outerHTML;

我追踪了错误，只是不知道如何修复错误……有人有什么想法吗？

谢谢，
乔什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T19:13:45.050

我终于明白了！！

不知道发生了什么，但我最终使用了不同的播放器（[http://mediaelementjs.com/](http://mediaelementjs.com/)）

我开始使用 MediaElementJS 播放器，但由于某种原因，它没有将皮肤应用于我的任何音频文件。这次我手动将它添加到我的主题中（而不是使用插件 - 这是我最初使用的）

我还加入了皮肤：[http](http://www.onedesigns.com/freebies/custom-mediaelement-js-skin) ://www.onedesigns.com/freebies/custom-mediaelement-js-skin ，这需要一点时间，因为它只能作为插件使用。

不知道为什么 AudioJS 脚本不起作用（因为它应该有），我不确定为什么 MediaElementJS 脚本不能作为插件工作（因为它应该有），总而言之我很高兴我有一些东西终于可以工作了，是跨浏览器兼容的，不管有没有flash都很好看。

谢谢，乔什

# google-chrome - 将网站作为独立的桌面应用程序发布

> ID：14782596
> 
> 赞同：2
> 
> 时间：2013-02-08T22:47:18.433
> 
> 标签：google-chrome, firefox, mozilla-prism

我想将 web 应用程序作为桌面应用程序发布，唯一的限制是即使没有任何 web 浏览器存在，这个桌面应用程序也需要工作。例如，想象一台根本没有浏览器的机器，现在你在 Mac/PC 上下载这个可执行文件，运行它，你有一个应用程序，它只是一个框架（最好是 Chrome，但 FireFox 也可以正常工作），在这个网页中运行， 没有其他的。

这是非常抽象的，我理解，但我只是想知道是否有一种简单的方法可以做到这一点。

Mozilla 曾经提供 Prism 作为一种实现方式，但已停止使用。

Google Chrome 提供 Chrome 打包应用程序，但这需要机器上存在 Chrome（因为它基本上是一个扩展程序）。

我想要做的是让用户能够下载可执行文件并获取应用程序。我打算尝试下载整个 Chrome 源代码并开始挖掘它以找到一种方法将它作为现在不可用的东西发布，但我想我会先在这里问。

如果需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:49:45.067

您可以查看[https://github.com/rogerwang/node-webkit](https://github.com/rogerwang/node-webkit)或[http://appjs.org/](http://appjs.org/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-27T14:50:36.367

试试 Firefox 的[独立](https://addons.mozilla.org/en-US/firefox/addon/standalone/)扩展，并确保您安装了最新的 Firefox 版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-22T04:37:30.607

我见过 3 似乎有一些牵引力：

*   [NW.js](http://nwjs.io/)
*   [电子](http://electron.atom.io/)
*   [色调 2](http://trueinteractions.com/docs/)

看起来有一种有趣的[比较/写](http://tangiblejs.com/posts/nw-js-electron-compared)他们。只是我的 2 美分……无论好坏，我认为这种类型的解决方案对于桌面（win/mac/linux）客户端将变得更加普遍。当希望提供跨平台解决方案时尤其如此。我认为大多数人可能只是使用普通的网络浏览器来访问桌面上的东西，所以除非绝对必要，否则为什么要花更多时间开发本机应用程序呢？

# php - 为参考 ID 生成随机但唯一的数字

> ID：14782598
> 
> 赞同：3
> 
> 时间：2013-02-08T22:47:33.330
> 
> 标签：php, random

我想生成唯一编号，以便我可以将它们用作参考编号来处理我的客户请求。

我不希望数字重复，我也不使用任何数据库来存储数字。

我只是想使用一个简单的算法来生成随机数。

我正在使用类似的东西

`rand(10*45, 100*98)`

有没有可能做这样的事情。我知道我的要求似乎很奇怪，但我只想知道它是否可能。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-08T22:49:00.510

为什么不在随机数前面加上 Unix 时间戳？这将确保唯一性。

```
$random = time() . rand(10*45, 100*98); 
```

否则，您可以将号码存储在文件中。如果可以，请将它们存储在数据库中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-08T23:00:31.760

为什么不使用该功能，php为此提供了：

[独特的](http://php.net/manual/de/function.uniqid.php)

例子：

```
uniqid(rand(10*45), true) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-08T23:19:08.413

如果您接受十六进制数字，则：

```
function random_id($bytes) {
    $rand = mcrypt_create_iv($bytes, MCRYPT_DEV_URANDOM);
    return bin2hex($rand);
}
echo random_id(5); // Ex: a06e0e4e72 
```

5 个字节（即 40 位）创建了大约 2^40（大约一万亿）个可能的唯一值。它应该足够随机以创建许多唯一 ID。

# java - 如何在两点之间移动jlabel？

> ID：14782602
> 
> 赞同：-2
> 
> 时间：2013-02-08T22:48:01.513
> 
> 标签：java, multithreading, graphics, jlabel, setbounds

我有两个点，我画一条线，`drawline(x1,y1,x2,y2);` 我想在这条线上移动一个标签（在这两个点之间）。

```
 m=y2-y1/x2-x1;

if(x1<x2)
    for (int i=x1;i<x2;i++)
    {
    label.setbound(i,y1+(x-i)*m,label.getwidth(),label.gethigh());
    }
    else{
    for (int i=x1;i<x2;i--)
    {
    label.setbound(i,y1+(x-i)*m,label.getwidth(),label.gethigh());
    }
    } 
```

我用线来移动。

//

我问这个问题是因为我正在为旅行推销员问题编写代码，并且我想在路线上移动一个东西，使用线程来更改标签的位置。例如：`drawline( 23, 65, 231,124);` ***移动业务员上线。***

> 我的 IDE 是 netbeans，jpanel 布局是免费设计的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:02:50.747

几乎没有什么信息可以继续，而且您可能遇到问题的原因有很多。

以下是我如何解决您的问题的简单示例。注意-我个人不喜欢`null`布局，它们对 Swing 的内部工作方式造成了很大的困扰，并且往往会产生比它们解决的更多的问题。相反，当我想取消布局管理器时，我使用 a`JLayeredPane`代替。

```
public class BouncingLabel {

    public static void main(String[] args) {
        new BouncingLabel();
    }

    public BouncingLabel() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame("Testing");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new TestPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class TestPane extends JLayeredPane {

        private JLabel label;
        private Point p;
        private int dv = 2;

        public TestPane() {
            p = new Point();
            label = new JLabel("Look Ma, no hands!");
            add(label);

            Timer timer = new Timer(60, new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    p.y = (getHeight() - label.getHeight()) / 2;
                    p.x = p.x + dv;
                    if (p.x + label.getWidth() > getWidth()) {
                        dv *= -1;
                        p.x = getWidth() - label.getWidth() + dv;
                    } else if (p.x < 0) {
                        dv *= -1;
                        p.x = 0 + dv;
                    }
                    label.setLocation(p);
                    repaint();
                }
            });
            timer.setRepeats(true);
            timer.setCoalesce(true);
            timer.start();
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(200, 100);
        }

        @Override
        public void doLayout() {
            super.doLayout();
            label.setSize(label.getPreferredSize());
            label.getLocation(p);
        }

    }

} 
```

**更新**

仔细检查代码后，您似乎违反了事件调度线程 - 无阻塞规则。所有 UI 更新都在单个线程（EDT）中维护，任何阻塞该线程的操作都将阻止 EDT 将事件分派给所有组件，包括重绘请求。

做这样的事情..

```
for (int i=x1;i<x2;i++)
{
    label.setbound(i,y1+(x-i)*m,label.getwidth(),label.gethigh());
} 
```

意味着您已阻止 EDT 将任何所需的更新事件分派到 UI 的其余部分，阻止它更新屏幕，直到您退出该方法。

查看[Swing 中的并发以](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)获取更多详细信息。

我还将仔细研究[如何使用 Swing Timers](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)和[Swing Worker](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/worker.html)来获得一些解决方案。

# java - 使用 Hadoop 的 DistributedCache 的问题

> ID：14782604
> 
> 赞同：1
> 
> 时间：2013-02-08T22:48:07.800
> 
> 标签：java, hadoop

嗨，我在使用 Hadoop 分布式缓存时遇到了一些麻烦。我在一个单节点集群（[http://www.michael-noll.com/tutorials/running-hadoop-on-ubuntu-linux-single-node-cluster/](http://www.michael-noll.com/tutorials/running-hadoop-on-ubuntu-linux-single-node-cluster/)）中运行 Hadoop。

我需要将文件传递给每个映射器的问题，我已经阅读了很多 Hadoop 的 DistributedCache，但是直到现在我每次尝试打开本地文件时都没有成功，我得到一个“FileNotFoundException”，我怎么能确定缓存实际上是在处理文件吗？

谢谢你的帮助

这是我的代码：

```
 package br.ufmg.dcc.bigdata.hadoop;                                        
    import java.io.IOException;                                        
    import java.util.*;                                        
    import org.apache.hadoop.filecache.DistributedCache;                                        
    import org.apache.hadoop.fs.FSDataInputStream;                                        
    import org.apache.hadoop.fs.Path;                                        
    import org.apache.hadoop.fs.FileSystem;                                        
    import org.apache.hadoop.conf.*;                                        
    import org.apache.hadoop.io.*;                                        
    import org.apache.hadoop.mapred.JobConf;                                        
    import org.apache.hadoop.mapreduce.*;                                        
    import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;                                        
    import org.apache.hadoop.mapreduce.lib.input.TextInputFormat;                                        
    import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;                                        
    import org.apache.hadoop.mapreduce.lib.output.TextOutputFormat;                                        
    import br.ufmg.dcc.bigdata.Result;                                        
    import au.com.bytecode.opencsv.CSVReader;                                        
    import java.io.BufferedInputStream;                                        
    import java.io.File;                                        
    import java.io.FileInputStream;                                        
    import java.io.FileOutputStream;                                        
    import java.io.FileReader;                                        
    import java.io.InputStream;                                        
    import java.io.ObjectInput;                                        
    import java.io.ObjectInputStream;                                        
    import java.io.ObjectOutputStream;                                        
    import java.io.StringReader;                                        
    import java.io.InputStreamReader;                                        
    import java.io.BufferedReader;                                        
    import java.net.URI;                                        
    import weka.core.Instances;                                        
    import weka.classifiers.rules.LAC;                                        

    public class Ladoop {                                        

        public static class Map extends Mapper<Text, Text, Text, IntWritable> {                                        

            //private                                        
            private final static IntWritable one = new IntWritable(1);                                        
            private LAC classifier;                                         
            private Path[] localFiles;                                        
            private final static Text missesText = new Text("misses");                                        
            private final static Text hitsText = new Text("hits");                                        

             protected void setup(Context context) throws IOException, InterruptedException {                                        

                 FileReader teste = new FileReader("dilma_00.lac"); //error in this line                                        
                 classifier = new LAC("/home/hduser/dilma_00.lac"); //There is no problem if I force to read the local file                                        
             }                                          

            public void map(Text key, Text value, Context context) throws IOException, InterruptedException {                                        
                String line = value.toString();                                        
                try                                         
                {                                        
                    Result result = this.classifier.distributionForInstance(line.split(" "));                                        
                    context.write(missesText, new IntWritable(result.getMisses()));                                        
                    context.write(hitsText, new IntWritable(result.getHits()));                                        
                } catch (Exception e) {                                        
                    System.out.println("MAP ERROR");                                        
                    e.printStackTrace();                                        
                }                                        
            }                                        

         }                                          

         public static class Reduce extends Reducer<Text, IntWritable, Text, IntWritable> {                                        

             public void reduce(Text key, Iterable<IntWritable> results, Context context)                                         
                     throws IOException, InterruptedException {                                        
                 int    value       = 0;                                        

                 for (IntWritable result : results) {                                        
                     value +=  result.get();                                        
                 }                                        
                 System.out.println(value);                                        
                 context.write(key, new IntWritable(value));                                        

             }                                        
         }                                        

        public static void main(String[] args) throws Exception {                                        
            Configuration conf = new Configuration();                                        

            Job job = new Job(conf, "Ladoop");                                        
            DistributedCache.addCacheFile(new URI("/user/hduser/dilma_00.lac#dilma_00.lac"), conf);    

            DistributedCache.createSymlink(conf);                                        

            job.setJarByClass(Ladoop.class);                                        

            job.setOutputKeyClass(Text.class);                                        
            job.setOutputValueClass(IntWritable.class);                                        

            job.setMapperClass(Map.class);                                        
            job.setReducerClass(Reduce.class);                                        

            job.setInputFormatClass(NonSplittableKeyValueTextInputFormat.class);                                        
            job.setOutputFormatClass(TextOutputFormat.class);                                        

            FileInputFormat.addInputPath(job, new Path(args[0]));                                        
            FileOutputFormat.setOutputPath(job, new Path(args[1]));                                        

            job.waitForCompletion(true);                                        
        }                                        

    } 
```

编辑：也尝试过，但没有运气。

```
 protected void setup(Context context) throws IOException, InterruptedException {
         Path[] cacheFiles = DistributedCache.getLocalCacheFiles(context.getConfiguration());
         FileInputStream fileStream = new FileInputStream(cacheFiles[0].toString());
         classifier = new LAC(cacheFiles[0].toString());
     } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-11T21:39:30.197

如果您有 Hadoop 2.1.0-beta，它在设置和从缓存中获取时存在错误，请尝试另一个版本， http: [//issues.apache.org/jira/browse/MAPREDUCE-5385](http://issues.apache.org/jira/browse/MAPREDUCE-5385)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T01:50:02.783

我不认为您可以在将文件放入您的文件后直接访问它们`DistributedCache`，您应该在代码中添加类似这样的内容`setup`：

```
Path[] cacheFiles = context.getLocalCacheFiles();
FileInputStream fileStream = new FileInputStream(cacheFiles[0].toString()); 
```

# heroku - 如何在不使用 git clone 的情况下从 Heroku 中获取我的文件？

> ID：14782605
> 
> 赞同：0
> 
> 时间：2013-02-08T22:48:17.177
> 
> 标签：heroku

我把 Heroku 上的 git repo 弄得一团糟，所以我回滚了我的 Heroku 版本。

那么例子...

```
v100 = Rollback to V98
V99 = BAD COMMIT / REPO
V98 = CURRENTLY RUNNING / ROLLED BACK TO 
```

当我执行 heroku git:clone -a [myapp] 时，我会克隆 v99，而不是 v98，即使 v98 是在 Heroku 上运行的。有什么方法可以获取 v98 发布文件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T01:48:01.577

您可以使用`git checkout sha1-hash`它来执行您所做的任何提交。

# mysql - mysql - 基于图表构建代码

> ID：14782609
> 
> 赞同：0
> 
> 时间：2013-02-08T22:49:07.760
> 
> 标签：mysql

我正在尝试构建一个数据库，但我对 MySql 一无所知。以下是我的目标： [http ://snag.gy/eryLf.jpg](http://snag.gy/eryLf.jpg)

这是我到目前为止编写的代码（如图所示，表格是按从左到右的顺序创建的）

```
 CREATE TABLE person (
  id INT(11) PRIMARY KEY AUTO_INCREMENT,
  fname VARCHAR(64),
  lname VARCHAR(64)
) ENGINE = InnoDB;

CREATE TABLE bookauthor (
  book_id INT(11),
  author_id INT(11),
  FOREIGN KEY (author_id) REFERENCES person (id) ON UPDATE CASCADE,
  FOREIGN KEY (book_id) REFERENCES book (id) ON UPDATE CASCADE
) ENGINE = InnoDB;

CREATE TABLE bookpublisher (
  book_id INT(11),
  publisher_id INT(11),
  FOREIGN KEY (book_id) REFERENCES book (id) ON UPDATE CASCADE,
  FOREIGN KEY (publisher_id) REFERENCES publisher(id) ON UPDATE CASCADE
) ENGINE = InnoDB;

CREATE TABLE publisher (
  id INT(11) PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(64)
) ENGINE = InnoDB;

CREATE TABLE bookillustrator (
  book_id INT(11),
  illustrator_id INT(11),
  FOREIGN KEY (book_id) REFERENCES book(id) ON UPDATE CASCADE,
  FOREIGN KEY (illustrator_id) REFERENCES person(id) ON UPDATE CASCADE
) ENGINE = InnoDB;

CREATE TABLE book (
  id INT(11) PRIMARY KEY AUTO_INCREMENT,
  title VARCHAR(256),
  type_id INT(11),
  publication_date DATE,
  value DECIMAL(10,2),
  price DECIMAL(10,2),
  notes TEXT,
  signed TINYINT(1),
  grade_id INT(10),
  bagged TINYINT(1)
) ENGINE = InnoDB;

CREATE TABLE booktag (
  book_id INT(11),
  tag_id INT(11),
  FOREIGN KEY (book_id) REFERENCES book(id) ON UPDATE CASCADE,
  FOREIGN KEY(tag_id) REFERENCES tag(id) ON UPDATE CASCADE
) ENGINE = InnoDB;

CREATE TABLE tag (
  id INT(11) PRIMARY KEY AUTO_INCREMENT,
  value VARCHAR(64)
) ENGINE = InnoDB;

CREATE TABLE type (
  id INT(11) PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(64)
) ENGINE = InnoDB;

CREATE TABLE grade (
  id INT(11) AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(256)
) ENGINE = InnoDB; 
```

书与打字、书与等级之间的关系又是怎样的呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:02:04.587

和关系是 1:n，其中`book->type`和是可选的。这很容易用 MySQL Workbench 创建。`book->grade``type``grade`

这应该这样做：

```
-- -----------------------------------------------------
-- Table `type`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `type` (
  `id` INT(10) NOT NULL ,
  `name` VARCHAR(256) NULL ,
  PRIMARY KEY (`id`) )
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `grade`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `grade` (
  `id` INT(10) NOT NULL ,
  `name` VARCHAR(256) NULL ,
  PRIMARY KEY (`id`) )
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `book`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `book` (
  `id` INT(10) NOT NULL ,
  `title` VARCHAR(256) NOT NULL ,
  `type_id` INT(10) NULL ,
  `publication_date` DATE NULL ,
  `value` DECIMAL(10,2) NULL ,
  `price` DECIMAL(10,2) NULL ,
  `notes` TEXT NULL ,
  `signed` TINYINT(1) NULL ,
  `grade_id` INT(10) NULL ,
  `bagged` TINYINT(1) NULL ,
  PRIMARY KEY (`id`) ,
  INDEX `fk_book_grade` (`grade_id` ASC) ,
  INDEX `fk_book_type1` (`type_id` ASC) ,
  CONSTRAINT `fk_book_grade`
    FOREIGN KEY (`grade_id` )
    REFERENCES `grade` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_book_type1`
    FOREIGN KEY (`type_id` )
    REFERENCES `type` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `tag`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `tag` (
  `id` INT(10) NOT NULL ,
  `value` VARCHAR(64) NOT NULL ,
  PRIMARY KEY (`id`) )
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `booktag`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `booktag` (
  `book_id` INT(10) NOT NULL ,
  `tag_id` INT(10) NOT NULL ,
  INDEX `fk_booktag_book1` (`book_id` ASC) ,
  INDEX `fk_booktag_tag1` (`tag_id` ASC) ,
  PRIMARY KEY (`book_id`, `tag_id`) ,
  CONSTRAINT `fk_booktag_book1`
    FOREIGN KEY (`book_id` )
    REFERENCES `book` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_booktag_tag1`
    FOREIGN KEY (`tag_id` )
    REFERENCES `tag` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `person`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `person` (
  `id` INT(10) NOT NULL ,
  `fname` VARCHAR(64) NOT NULL ,
  `lname` VARCHAR(64) NOT NULL ,
  PRIMARY KEY (`id`) )
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `bookillustrator`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `bookillustrator` (
  `book_id` INT(10) NOT NULL ,
  `person_id` INT(10) NOT NULL ,
  INDEX `fk_bookillustrator_person1` (`person_id` ASC) ,
  INDEX `fk_bookillustrator_book1` (`book_id` ASC) ,
  PRIMARY KEY (`book_id`, `person_id`) ,
  CONSTRAINT `fk_bookillustrator_person1`
    FOREIGN KEY (`person_id` )
    REFERENCES `person` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_bookillustrator_book1`
    FOREIGN KEY (`book_id` )
    REFERENCES `book` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `bookauthor`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `bookauthor` (
  `book_id` INT(10) NOT NULL ,
  `person_id` INT(10) NOT NULL ,
  INDEX `fk_bookauthor_person1` (`person_id` ASC) ,
  INDEX `fk_bookauthor_book1` (`book_id` ASC) ,
  PRIMARY KEY (`book_id`, `person_id`) ,
  CONSTRAINT `fk_bookauthor_person1`
    FOREIGN KEY (`person_id` )
    REFERENCES `person` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_bookauthor_book1`
    FOREIGN KEY (`book_id` )
    REFERENCES `book` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `publisher`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `publisher` (
  `id` INT(10) NOT NULL ,
  `name` VARCHAR(64) NOT NULL ,
  PRIMARY KEY (`id`) )
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `bookpublisher`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `bookpublisher` (
  `book_id` INT(10) NOT NULL ,
  `publisher_id` INT(10) NOT NULL ,
  INDEX `fk_bookpublisher_book1` (`book_id` ASC) ,
  INDEX `fk_bookpublisher_publisher1` (`publisher_id` ASC) ,
  PRIMARY KEY (`book_id`, `publisher_id`) ,
  CONSTRAINT `fk_bookpublisher_book1`
    FOREIGN KEY (`book_id` )
    REFERENCES `book` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_bookpublisher_publisher1`
    FOREIGN KEY (`publisher_id` )
    REFERENCES `publisher` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB; 
```

## [SQL小提琴](http://sqlfiddle.com/#!2/3eef2)

# javascript - 如果我快速连续单击按钮，则会导致文本选择

> ID：14782611
> 
> 赞同：0
> 
> 时间：2013-02-08T22:49:24.877
> 
> 标签：javascript, jquery

下面我有一个样式类似于按钮的复选框：

```
 echo '<p>';
 foreach($options as $indivOption) {
     echo '<div id="ck-button"><label><input type="checkbox" name="options[]" id="option-' . $indivOption . '" value="' . $indivOption . '" /><span>' . $indivOption . '</span></label></div>';
 }
  echo '</p>'; 
```

现在发生的情况是，如果我快速单击复选框按钮两次，它会打开按钮，但不会将其关闭，而是在按钮上进行一些文本选择。因此，如果我有一个名为 的按钮`E`，如果我快速单击它两次，它会打开按钮，然后突出显示字母`E`。

我的问题是，仅对于复选框按钮，如何在 javascript 中，因为我假设它是客户端来解决这个问题，如何防止文本选择仅针对复选框按钮而不是整个文档发生。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T22:52:31.660

将此样式应用于检查按钮（或者，在您的情况下，包含检查按钮的 div ）：

```
#ck-button {
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
} 
```

对于 < IE10 的浏览器，将属性添加`onselectstart="return false;"`到`ck-button`div。

# java - Solr 不适用于 DSpace 安装

> ID：14782612
> 
> 赞同：1
> 
> 时间：2013-02-08T22:49:26.070
> 
> 标签：java, jsp, solr, dspace

我在尝试登录时收到以下错误页面（见底部）：

```
http://localhost:8080/solr/admin/ 
```

到目前为止，我尝试了以下方法均未成功：

1.  重启Tomcat（无数次）
2.  运行 DSpace 的命令 ( `stats-log-converter`& `stats-log-importer`)
3.  将原始安装中的所有内容（SQL 和文件）复制到新安装中。

一点历史：

主要症状是我们无法启动和运行统计信息。统计页面只返回一个空白页面。试图解决这个问题，我偶然发现了这个，我怀疑这是罪魁祸首。

这是错误：（也附上图片）

```
 HTTP Status 500 -

    type Exception report

    message

    description The server encountered an internal error () that prevented it from fulfilling this request.

    exception

    org.apache.jasper.JasperException: Unable to compile class for JSP: 

    An error occurred at line: 32 in the jsp file: /admin/index.jsp
    The method getRequestHandlers() in the type SolrCore is not applicable for the arguments (Class<ReplicationHandler>)
    29: <%-- jsp:include page="header.jsp"/ --%>
    30: <%-- do a verbatim include so we can use the local vars --%>
    31: <%@include file="header.jsp" %>
    32: <%boolean replicationhandler = !core.getRequestHandlers(ReplicationHandler.class).isEmpty();%>
    33: <br clear="all">
    34: <table>
    35: 

    Stacktrace:
        org.apache.jasper.compiler.DefaultErrorHandler.javacError(DefaultErrorHandler.java:92)
        org.apache.jasper.compiler.ErrorDispatcher.javacError(ErrorDispatcher.java:330)
        org.apache.jasper.compiler.JDTCompiler.generateClass(JDTCompiler.java:439)
        org.apache.jasper.compiler.Compiler.compile(Compiler.java:349)
        org.apache.jasper.compiler.Compiler.compile(Compiler.java:327)
        org.apache.jasper.compiler.Compiler.compile(Compiler.java:314)
        org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:589)
        org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:317)
        org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
        org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
        javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
        org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:295)
        org.dspace.solr.filters.LocalHostRestrictionFilter.doFilter(LocalHostRestrictionFilter.java:60)
    note The full stack trace of the root cause is available in the Apache Tomcat/6.0.26 logs.

    Apache Tomcat/6.0.26 
```

![SOLR 错误](../Images/fe7157a1e8b3bdadabc9a2dc33221acb.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:19:11.527

看起来像是 jar 文件的版本不匹配或版本兼容性问题。

清理后尝试运行全新安装。`/WEB-INF/lib`确保Solr 模块中有所有的罐子。

参考： http: [//permalink.gmane.org/gmane.comp.db.dspace.user/15055](http://permalink.gmane.org/gmane.comp.db.dspace.user/15055)

# objective-c - NSOperationQueue 出现非常奇怪的错误

> ID：14782617
> 
> 赞同：1
> 
> 时间：2013-02-08T22:49:48.530
> 
> 标签：objective-c, macos, cocoa, nsoperationqueue

我有以下代码：

```
- (void)readSettingsFiles
{
    NSOperationQueue *operationQueue = [[[NSOperationQueue alloc] init] autorelease];
    [operationQueue setName:@"File Parsing Queue"];

    if (urlForV1SettingsFile) {
        [operationQueue addOperationWithBlock:^{
            SettingsReader *settingsReader = [[[SettingsReader alloc] initWithURL:urlForV1SettingsFile] autorelease];
            NSArray *settings = [settingsReader settings];
            [settingsToSave addObjectsFromArray:settings];
        }];
    }

    if (urlForV2SettingsFile) {
        [operationQueue addOperationWithBlock:^{
            SettingsReader *settingsReader = [[[SettingsReader alloc] initWithURL:urlForV2SettingsFile] autorelease];
            NSArray *settings = [settingsReader settings];
            [settingsToSave addObjectsFromArray:settings];
        }];
    }

    while ([operationQueue operationCount] > 0) {
        sleep(1);
    }
} 
```

`SettingsReader`是一个处理读取两个不同 XML 文件的 NSXMLParser 委托。`settingsToSave`是声明此方法的类的属性，类型为 NSDictionary。

我有睡眠，所以在所有文件都被解析之前，该方法不会返回。

问题是，当我退出 while 循环时，我在控制台中收到此错误：

```
objc[74760]: Class _NSZombie_NSCFInputStream is implemented in both ?? and ??. One of the two will be used. Which one is undefined. 
```

以前从未见过，谷歌也没有。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:11:20.617

我敢打赌，这意味着两个线程同时在 NSInputStream 上完成了僵尸检测。我怀疑如果你不并行执行这些，这不会发生。我不会担心的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T23:12:10.570

一方面，可变类不是线程安全的。所以你应该将最大并发设置为 1。

```
[operationQueue setMaxConcurrentOperationCount:1]; 
```

或者

```
@synchronized(settingsToSave) {
    [settingsToSave addObjectsFromArray:settings];
} 
```

此外，让您的变量名称设置与方法名称设置相同可能不是提高可读性的最佳选择。

更值得注意的是，你为什么在这里使用操作队列？这些操作都不是异步的。而且，如果您一直阻塞主线程直到它们完成，我认为启动 NSOperationQueue 和后台线程的所有开销都没有任何好处。为什么不只是：

```
if (urlForV1SettingsFile) {
        SettingsReader *settingsReader1 = [[[SettingsReader alloc] initWithURL:urlForV1SettingsFile] autorelease];
        NSArray *settings1 = [settingsReader1 settings];
        [settingsToSave addObjectsFromArray:settings1];
}

if (urlForV2SettingsFile) {
        SettingsReader *settingsReader2 = [[[SettingsReader alloc] initWithURL:urlForV2SettingsFile] autorelease];
        NSArray *settings2 = [settingsReader2 settings];
        [settingsToSave addObjectsFromArray:settings2];
} 
```

简单多了...

# asp.net - GridView 编辑/删除 未正确刷新。ASP.NET

> ID：14782621
> 
> 赞同：0
> 
> 时间：2013-02-08T22:50:02.810
> 
> 标签：asp.net

本质上，我正在做的是允许用户输入人名，按下按钮并编辑/删除选择的字段。

我可以使用默认的 gridview 属性很好地编辑/删除。但是当我按下编辑时，它会重新加载回默认的选择命令。我需要它做的是使用文本框的文本。

这就是我搜索用户的方式

```
 protected void GetUser_Click(object sender, EventArgs e)
    {
        query = Session["username"].ToString();  
        string sql = "SELECT [Username], [Job Description] AS Job_Description, [Hours Worked] AS Hours_Worked, [Date], [ID] FROM [TimeData] WHERE ([Username] LIKE '" + query+ "')";
        Response.Write("done");
        SqlDataSource1.SelectCommand = sql;
    } 
```

所以在页面加载中我需要它来“记住”我在按下编辑之前输入的内容。

在 ASPX 文件中，我将 selectcommand 留空，而是在 Page_load 方法中设置它

```
 protected void Page_Load(object sender, EventArgs e)
    {
        GridView1.Visible = true;
        Session["Username"] = UserBox.Text;
        //Session["Username"] = "rhys";
        query = Session["username"].ToString();
        string sql = "SELECT [Username], [Job Description] AS Job_Description, [Hours Worked] AS Hours_Worked, [Date], [ID] FROM [TimeData]";
        //Response.Write("done");
        SqlDataSource1.SelectCommand = sql;   
    } 
```

Atm 我可以让它再次出现，但我再次查询整个表，而不是通过用户名

我正在寻找一种可能回发变量或其他东西的方法，但似乎没有任何效果。

任何帮助，将不胜感激。

编辑：评论对我按下的按钮有所帮助

```
 protected void GetUser_Click(object sender, EventArgs e)
 {
 query = Session["username"].ToString();
 string sql = "SELECT [Username], [Job Description] AS Job_Description, [Hours Worked] AS Hours_Worked, [Date], [ID] FROM   [TimeData] WHERE ([Username] LIKE '" + query + "')"; 
Response.Write("done");
 SqlDataSource1.SelectCommand = sql; 

} 
```

" 不再返回任何更改，是不是因为 !postback 之后块的 else 部分中存在相同的代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:07:29.340

它应该是：

```
protected void Page_Load(object sender, EventArgs e)
{
     if(!Page.IsPostBack)
     {
        GridView1.Visible = true;
        Session["Username"] = UserBox.Text;
        query = Session["username"].ToString();
        string sql = "SELECT [Username], [Job Description] AS Job_Description, [Hours Worked] AS Hours_Worked, [Date], [ID] FROM [TimeData]";
        SqlDataSource1.SelectCommand = sql; 
     } 
} 
```

就目前而言，您的页面加载将覆盖您的事件处理程序所做的事情。

此外，用户[参数化查询](http://forums.asp.net/t/1568268.aspx)以保护自己免受 SQL 注入

# backbone.js - 骨干路由：是否需要修改服务器？

> ID：14782623
> 
> 赞同：1
> 
> 时间：2013-02-08T22:50:13.870
> 
> 标签：backbone.js, routes

现在，我在我的 Backbone 应用程序中使用哈希路由。我想使用完整的路线，所以我会有一个看起来像这样的 URL（`leads`作为我的 SPA 中的页面）：

`leads/#/main-contact`

而不是

`leads#main-contact`

我添加了这一行：

`Backbone.history.start({pushState: true, root: "/"});`

但是路线`/main-contact`不行。我知道我可能需要对服务器进行一些修改。有人能告诉我让这个工作涉及到什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T19:35:29.013

如前所述，您需要确保服务器处理针对`lead/`的请求，即将这些请求转发给`lead.php`或类似的请求。如何做到这一点通常取决于服务器软件，而不是使用的服务器端语言。例如，一个快速的谷歌搜索出现了以下链接：

1.  [使用 apache mod_rewrite 删除尾部斜杠](http://jenstinfors.com/2011/04/07/remove-trailing-slash-using-apache-mod_rewrite/)
2.  [使用 Apache 的默认目录索引文件时，如何从 URL 中删除尾部斜杠？](https://serverfault.com/questions/250161/how-do-i-remove-trailing-slashes-from-a-url-when-using-apaches-default-director)

因为`Backbone.Router`你不需要做任何事情。`Backbone.history`自动从路由中删除任何前导斜杠和尾随空格；ie`main-contact`将同时匹配`#main-contact`和`#/main-contact`。这是一个简短的例子：

```
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title></title>
</head>
<body>
    <ul>
        <li><a href="#/home">Home</a></li>
        <li><a href="#/help">Help</a></li>
        <li><a href="#/about">About</a></li>
    </ul>
    <div id="message"></div>

    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script src="https://raw.github.com/documentcloud/underscore/master/underscore.js"></script>
    <script src="https://raw.github.com/documentcloud/backbone/master/backbone.js"></script>
    <script type="text/javascript">
    $(function () {
        var MyRouter = Backbone.Router.extend({
            routes: {
                "home": "home",
                "help": "help",
                "about": "about"
            },
            home: function () { this.msg("home"); },
            help: function () { this.msg("help"); },
            about: function () {this.msg("about"); },
            msg: function(m) { $("#message").text(m); }
        });

        new MyRouter();
        Backbone.history.start();
    });
    </script>
</body>
</html> 
```

注意：我只是通过从本地文件运行上面的例子来测试它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T17:58:59.037

修改您的重写规则以获取文件（处理您的路由逻辑的文件）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T01:41:47.447

无论给出的路径如何，您都希望让您的服务器端提供一个包含您的路由器代码的页面。

/leads/* --->leads.html

我不能比这更具体，因为在服务器端执行此操作的机制特定于您使用的服务器端技术。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T21:47:01.107

在骨干路由器中尝试不使用 / 作为路由的 main-contact

# javascript - Coldfusion 是否有推送功能来创建实时代码？

> ID：14782625
> 
> 赞同：3
> 
> 时间：2013-02-08T22:50:21.187
> 
> 标签：javascript, coldfusion, ticker

我们正在我们的网站上举办一场比赛，访问者可以投票选出他们最喜欢的参赛作品。我们获得了很多流量和大量选票。

我们想在我们的主页上添加一个代码，每当投票时实时更新以显示投票总数。

我们的网站在 Coldfusion 10 服务器上运行。

我知道如何做到这一点的唯一方法是运行一个每秒运行一次左右的 JavaScript 函数，该函数将运行一个 ajax 命令来调用另一个页面，该页面只运行查询以返回总票数。当您每秒轮询数百名用户时，这似乎会占用大量带宽。

有没有更好的方法不会导致巨大的带宽拖累？也许可以使用 Coldfusion 的某种“推送”功能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T23:03:57.427

这是我在这个主题上使用过的最完整、最完整的教程。带你经历一切。

[http://www.adobe.com/devnet/coldfusion/articles/html5-websockets-coldfusion-pt1.html](http://www.adobe.com/devnet/coldfusion/articles/html5-websockets-coldfusion-pt1.html)

除非他们从不涉及确保端口在您的服务器上打开。我们使用 WIN 2008 服务器，默认情况下防火墙会阻止它。

在最基本的层面上，你做三件事：

1.  将频道添加到您的 App.cfc
2.  在要使用数据的页面上添加监听器（监听通道）
3.  添加页面发布数据（发布到频道）

您可以做很多其他事情来处理每个步骤的数据。

# google-chrome - Chrome HTML5 视频字幕样式

> ID：14782627
> 
> 赞同：2
> 
> 时间：2013-02-08T22:50:25.970
> 
> 标签：google-chrome, html5-video

我正在尝试在 Chrome 中显示带有字幕的 HTML5 视频，但如果由于某种原因该`video`元素继承了某些*样式属性*，则字幕不会显示属性。

例如，如果`video`元素继承了该`line-height`属性，则字幕不会在*最小化*模式和模式*fullscreen*之间正确转换。

![在此处输入图像描述](../Images/5ef30cac43d0ce4977951c40c52b69f0.png)

检查[示例页面](http://fguillen.github.com/ChromeVideoSubsStyle/)

我无法为`video > track`元素定义正确的样式。

我主要关心的是：是否可以在 Chrome 中操作元素的*样式？*`video > track`

我的次要问题：这些元素中的这种奇怪行为是`line-height`Chrome 错误还是我的错？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T01:20:49.130

在我们等待问题得到解决之前，我们可以`:-webkit-full-screen`在视频处于全屏模式时使用伪选择器来更改行高，下面是代码片段：

```
video{ line-height: 15px }
video:-webkit-full-screen{ line-height: 30px } 
```

我已经在您的测试页面（[http://fguillen.github.com/ChromeVideoSubsStyle/](http://fguillen.github.com/ChromeVideoSubsStyle/)）上进行了尝试，它似乎有效。

# python - 删除在 python 中不起作用的空间

> ID：14782628
> 
> 赞同：0
> 
> 时间：2013-02-08T22:50:30.633
> 
> 标签：python, space, xbmc

我有一个获取 xbmc 音乐标题的代码，我想把它放在一个 url 中发送。但是 urllib 不喜欢代码中标题中的空格：

```
 if xbmc.Player().isPlayingAudio() and audio != 1 :
    audio = 1
    urllib2.urlopen('http://%s:3480/data_request?id=variableset&DeviceNum=%s&serviceId=urn:upnp-org:serviceId:XBMCState1&Variable=PlayerStatus&Value=playing_audio' % (ip, dev)) 
    tag = xbmc.Player().getMusicInfoTag()
    title = tag.getTitle()
    title.replace(" ", "_")
    print ("playing:" + title) 
```

但是，当检查日志文件时，空间仍然存在。我想要的只是 (title = summer of 69) 到 (title = summer_of_69) 并且如果可能的话也将 (') 转换为空

谢谢麦克风

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T22:52:22.463

`str.replace`不是就地操作 - 由于字符串是不可变的，它返回一个新字符串，因此您需要事后分配。`title = title.replace(' ', '_')`

或者，只需将您的更改`print`为：`print('playing:', title.replace(' ', '_'))`

如果您只想要某些字符，那么您可以执行以下操作：

```
>>> import re
>>> track = "summer       of      '69"
>>> re.sub('[^a-z0-9]+', '_', track, re.I)
'summer_of_69' 
```

它接受任何不是 ascii 字母、数字的东西，然后将它们压缩成一个“_”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T22:58:42.793

尝试这个：

```
title = title.replace(" ", "_") 
```

title.replace() 不会替换原始字符串中的文本，它会创建一个与原始字符串相等的新字符串，并进行替换。您所要做的就是获取该方法的返回值，并将其放在原始变量的位置。

# enterprise-architect - Enterprise Architect - 打印到 PDF 显示空图

> ID：14782630
> 
> 赞同：0
> 
> 时间：2013-02-08T22:50:44.643
> 
> 标签：enterprise-architect

我正在使用 EA 版本 10（最新版本）。当我将域图打印到 PDF 时，它显示的图没有任何文本。有谁知道如何解决这个问题？或者它是 EA 中的错误？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T07:23:38.700

似乎 EA 的 PDF 生成器现在可以正常运行。安装 Adob​​e Acrobate Pro X1 后，我可以使用正常的打印对话框将图表打印为 PDF。

# c# - Compact Framework 和 CE7 中的通用 AGL 异常

> ID：14782634
> 
> 赞同：2
> 
> 时间：2013-02-08T22:51:02.397
> 
> 标签：c#, compact-framework, windows-ce

我有一个启动过程在 CE7 设备上抛出一些模棱两可的错误，但不是 CE6​​ 或 Windows Mobile。这是在设备启动后首次启动应用程序时抛出的，但不会在任何后续应用程序启动时抛出。

我收到了其中几个错误，所有这些错误都与与菜单项有关的活动有关。

正在执行的代码非常基本：

```
Menu.MenuItem[1].enabled = true;

System.Exception: Exception
at Microsoft.AGL.Common.MISC.HandleAr(PAL_ERROR ar)    
at System.Windows.Forms.MenuItem._SetInfo(AGL_MENUITEMINFO& mnueinfo)   
at System.Windows.Forms.MenuItem.set_Enabled(Boolean value)    
at Plugins.Mail.Form.EnableKeys(Boolean enabled)    
at Plugins.Mail.Mail2.set_KeysEnabled(Boolean value)    
at Plugins.Mail.Mail2.Subscribe() 
```

# label - 如何从文本字段中获取信息？

> ID：14782636
> 
> 赞同：0
> 
> 时间：2013-02-08T22:51:06.863
> 
> 标签：label, textfield

我是 xcode 的新手。我有一个文本字段表单，在这个表单中我只能输入数字。我如何从这个文本字段中获取信息到我的标签？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T08:18:55.443

```
@implementation WorktimerViewController{
NSTimer *timer;
int MainInt;
int zarabotal;
int stavka; }

@synthesize price;
@synthesize donebutton;
@synthesize lave;

- (void)updateLabels
{
self.lave.text = [NSString stringWithFormat:@"%d", zarabotal];

}
- (void) countup
{
MainInt += 1;
_second.text = [NSString stringWithFormat:@"%i", MainInt];

}

- (void)StartTimer{
MainInt = 1;
timer = [ NSTimer scheduledTimerWithTimeInterval:1.0 target:self selector:@selector(countup) userInfo:nil repeats:YES];
 zarabotal = stavka / MainInt;
[self updateLabels];

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T22:53:30.913

我猜你正在为iOS开发？[标签 setText:textField.text]; 应该这样做。

# python - 从 excel CSV 读取和写入另一个的问题

> ID：14782641
> 
> 赞同：1
> 
> 时间：2013-02-08T22:51:54.327
> 
> 标签：python, excel, csv, python-3.x

我尝试了一些事情，每次尝试都遇到了不同的错误。`'r'`首先，我正在使用and选项进行读写`'w'`，但这会导致在 excel 中查看时，导致 csv 在实际行之间具有空白行。

`'rb'`所以，我发现我必须用and来读写`'wb'`。但是，现在我得到了错误：`_csv.Error iterator should return strings, not bytes (did you open the file in text mode?)`.

这是我的代码：

```
def readLines():
    r = csv.reader(open('test.csv', "rb"), dialect="excel")
    return [l for l in r] #causes the error

def writeFile(lines):
    resultFile = open('output.csv', 'wb')
    wr = csv.writer(resultFile, dialect='excel')
    wr.writerows(lines) 
```

我对`lines`需要它们是字符串的对象进行了一些更改。我会以正确的方式解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:22:58.807

问题是我没有设置新的线属性。

这是我现在正在运行的更新代码：

```
def readLines():
    r = csv.reader(open('test.csv', "rt", newline=''), dialect="excel")
    return [l for l in r]

def writeFile(lines):
    resultFile = open('output.csv', 'wt', newline='')
    wr = csv.writer(resultFile, dialect='excel')
    wr.writerows(lines) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T23:13:33.757

尝试以文本模式打开文件：

```
r = csv.reader(open('test.csv', "rt"), dialect="excel")

resultFile = open('output.csv', 'wt') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-15T01:30:28.070

如果您的文本有重音符号或使用非英语的其他语言，您可能需要从[Python 库标准](https://docs.python.org/2.4/lib/standard-encodings.html)中选择正确的编码。一些文本编辑器允许您知道特定文件的编码。我发现了 TextWrangler。因此，读取带有重音符号（西班牙语）的文件的正确 Python 代码是：

```
import csv
def imp_csv(ruta):
    with open(ruta,'rt', newline='', encoding="mac_roman") as csvfile:
        r = csv.reader(csvfile, dialect='excel')
        for row in r:
            print(','.join(row)) 
```

# javascript - 使用 Backbone.history.navigate 到相同的路线，但没有任何获取参数

> ID：14782642
> 
> 赞同：1
> 
> 时间：2013-02-08T22:51:56.880
> 
> 标签：javascript, ruby-on-rails, backbone.js, browser-history

我能够使用 Backbone 的 history.navigate 默默地更改我的网址。喜欢从`/itmes`到`/itmes?price=5`或其他

但是当我想把它改回来时（比如我清除了一些过滤器），从`/items?price=5`to `/items`，它就不起作用了。

示例代码：

```
# From /items to /items?price=5&category=business, works
Backbone.history.navigate("/items?price=5&category=business", false)
# From /items?price=5&category=business to /item, doesn't work as I've expected
Backbone.history.navigate("/items", false) # this one doesn't 
```

有任何想法吗？如果 Backbone 的历史不支持此功能，有人可以告诉我一个解决方案吗？非常感激。

**更多信息：**
我发现了另一个奇怪的事情。假设我们在`/items?price=5`，如果我`Backbone.history.navigate("/items", false)`直接打电话。什么都没发生。

但是，如果我执行一个`Backbone.history.navigate("/items?price=5", false)`，然后调用`Backbone.history.navigate("/items", false)`，它会完成工作并`/items`正确执行。

这种方式的问题是它弄乱了历史，在正常历史之间会有一个附加节点。

# r - Division在R中创建megafile

> ID：14782643
> 
> 赞同：0
> 
> 时间：2013-02-08T22:51:58.553
> 
> 标签：r, csv, dataframe

我在 R 中有一个 DataFrame：

```
 Category1            Category 2      x              y  x.x
1                     T                    A      1              9    9
2                     T                    B      2              8    9
3                     T                    A     10              7    9
4                     T                    C     19              6    9
                      z            a    x.y          x.y   x.y
1            0.11111111            1   2342 0.0004269855 0.000
2            0.22222222            3   2342 0.0012809564 0.001
3            0.33333333           13   2342 0.0055508113 0.006
4            0.44444444           32   2342 0.0136635354 0.014 
```

最后两列 - 出于某种原因 - 不显示我给它们的名称（比如`x.1`and `x.2`），而是始终显示倒数第三列的名称。列`x.1`是除法的结果，`a/x.y`只是`x.2`四舍五入是一样的东西。现在，在创建了这个`data.frame`（使用 about `4,000 rows`）后，我创建了一个简单的 csv：

```
write.csv(DF, 'DF.csv') 
```

这 - 奇怪的是 - 产生了一个**34 GB**的文件。当我省略最后两列时，它变成了一个小文件`2MB`。我怎样才能避免这个巨大的文件，它来自哪里？

编辑

* * *

分工操作：

```
DF$x.1 <- DF$a/DF['x.y'] 
```

数据加载：

```
DF <- read.csv('data.csv', sep=';') 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T07:15:31.507

为了避免语法错误，我认为`transform`这里非常适合。使用它，您可以使用干净的语法基于现有列创建新列。

```
transform(DF,x.1 = a/x.y,x.2 = round(a/x.y,3))
  Category1 Category X2  x y x.x         z  a  x.y          x.1   x.2
1         1     TRUE  A  1 9   9 0.1111111  1 2342 0.0004269855 0.000
2         2     TRUE  B  2 8   9 0.2222222  3 2342 0.0012809564 0.001
3         3     TRUE  A 10 7   9 0.3333333 13 2342 0.0055508113 0.006
4         4     TRUE  C 19 6   9 0.4444444 32 2342 0.0136635354 0.014 
```

# c# - 更改 BasicHttpBinding 的时钟偏差不起作用

> ID：14782644
> 
> 赞同：1
> 
> 时间：2013-02-08T22:52:02.580
> 
> 标签：c#, wcf, wcf-binding, basichttpbinding, skew

我正在尝试以编程方式增加 BasicHtttpBinding 上的时钟偏差。我正在使用使用 CreateUserNameOverTransportBinding 模式的 TransportSecurityBindingElement。我可以将绑定元素时钟炖煮更改为 15 分钟（在客户端绑定输出打印到文件，如下所示）。但是引导元素倾斜没有被修改。

```
 <?xml version="1.0" encoding="utf-8"?>
 <configuration xmlns="http://schemas.microsoft.com/.NetConfiguration/v2.0">
 <system.serviceModel>
    <bindings>
        <customBinding>
            <binding name="BasicHttpBinding">
                <security defaultAlgorithmSuite="Default" authenticationMode="UserNameOverTransport"
                    requireDerivedKeys="true" securityHeaderLayout="Lax" includeTimestamp="true"
                    keyEntropyMode="CombinedEntropy" messageSecurityVersion="WSSecurity10WSTrustFebruary2005WSSecureConversationFebruary2005WSSecurityPolicy11BasicSecurityProfile10">
                    <localClientSettings cacheCookies="true" detectReplays="false"
                        replayCacheSize="900000" maxClockSkew="00:15:00" maxCookieCachingTime="Infinite"
                        replayWindow="00:05:00" sessionKeyRenewalInterval="10:00:00"
                        sessionKeyRolloverInterval="00:05:00" reconnectTransportOnFailure="true"
                        timestampValidityDuration="00:05:00" cookieRenewalThresholdPercentage="60" />
                    <localServiceSettings detectReplays="false" issuedCookieLifetime="10:00:00"
                        maxStatefulNegotiations="128" replayCacheSize="900000" maxClockSkew="00:15:00"
                        negotiationTimeout="00:01:00" replayWindow="00:05:00" inactivityTimeout="00:02:00"
                        sessionKeyRenewalInterval="15:00:00" sessionKeyRolloverInterval="00:05:00"
                        reconnectTransportOnFailure="true" maxPendingSessions="128"
                        maxCachedCookies="1000" timestampValidityDuration="00:05:00" />
                    <secureConversationBootstrap />
                </security>
                <mtomMessageEncoding maxReadPoolSize="64" maxWritePoolSize="16"
                    messageVersion="Soap11" maxBufferSize="10485760" writeEncoding="utf-8">
                    <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
                        maxBytesPerRead="4096" maxNameTableCharCount="16384" />
                </mtomMessageEncoding>
                <httpsTransport manualAddressing="false" maxBufferPoolSize="524288"
                    maxReceivedMessageSize="10485760" allowCookies="false" authenticationScheme="Anonymous"
                    bypassProxyOnLocal="false" decompressionEnabled="true" hostNameComparisonMode="StrongWildcard"
                    keepAliveEnabled="true" maxBufferSize="10485760" proxyAuthenticationScheme="Anonymous"
                    realm="" transferMode="StreamedRequest" unsafeConnectionNtlmAuthentication="false"
                    useDefaultWebProxy="true" requireClientCertificate="false" />
            </binding>
        </customBinding>
    </bindings>
</system.serviceModel>
</configuration> 
```

我无法以编程方式修改元素。我在这里面临的困难是从 TransportSecurityBindingElement 中获取 SecureConversationSecurityTokenParameters。请在下面查看我的代码。

```
 public static Binding CreateCustomHttpSecuredStreamingUploadBinding(TimeSpan clockSkew)
    {
        CustomBinding myCustomBinding = new CustomBinding(GetHttpSecuredStreamingUploadBinding());
        TransportSecurityBindingElement security = myCustomBinding.Elements.Find<TransportSecurityBindingElement>();
        security.LocalClientSettings.MaxClockSkew = clockSkew;
        security.LocalServiceSettings.MaxClockSkew = clockSkew;

        SecureConversationSecurityTokenParameters secureConversation;
        secureConversation = security.EndpointSupportingTokenParameters.SignedEncrypted[0] as SecureConversationSecurityTokenParameters;

        if (secureConversation != null)
        {
            SecurityBindingElement bootstrap = secureConversation.BootstrapSecurityBindingElement;
            // Set the MaxClockSkew on the bootstrap element.
            bootstrap.LocalClientSettings.MaxClockSkew = clockSkew;
            bootstrap.LocalServiceSettings.MaxClockSkew = clockSkew;
        }        

        return myCustomBinding;  

     }

private static BasicHttpBinding GetHttpSecuredStreamingUploadBinding()
    {
        BasicHttpBinding basicHttpBinding = new BasicHttpBinding();
        basicHttpBinding.MessageEncoding = WSMessageEncoding.Mtom;
        basicHttpBinding.TransferMode = TransferMode.StreamedRequest;
        basicHttpBinding.Security.Mode = BasicHttpSecurityMode.TransportWithMessageCredential;
        basicHttpBinding.Security.Transport.ClientCredentialType = HttpClientCredentialType.Certificate;
        basicHttpBinding.Security.Message.ClientCredentialType = BasicHttpMessageCredentialType.UserName;

        int MaxBufferSize = ConfigManager.GetInstance().MaxBufferSize(TConstants.HttpSecuredStreamingUpload, EndpointType.Client);
        basicHttpBinding.MaxBufferSize = MaxBufferSize;

        long maxReceivedMessageSize = ConfigManager.GetInstance().MaxReceivedMsgSize(TConstants.HttpSecuredStreamingUpload, EndpointType.Client);
        basicHttpBinding.MaxReceivedMessageSize = maxReceivedMessageSize;

        TdTimer timer = GetTimeOut(TConstants.HttpSecuredStreamingUpload, TConstants.SendTimeout);
        if (timer.isSet)
            basicHttpBinding.SendTimeout = timer.TimeOut;
        timer = GetTimeOut(TriadTransportConstants.HttpSecuredStreamingUpload, TConstants.ReceiveTimeout);
        if (timer.isSet)
            basicHttpBinding.ReceiveTimeout = timer.TimeOut;

        basicHttpBinding.ReaderQuotas = SetXmlDictionaryReaderQuotas(TConstants.HttpSecuredStreamingUpload);            
        return basicHttpBinding;
    } 
```

EndpointSupportingTokenParameters 有一个 SignedEncrypted[0] 元素，但 Endorsing[0] 为空。所以我使用下面的代码，但它在转换为 SecureConversationSecurityTokenParameters 时返回 null。

```
 secureConversation = security.EndpointSupportingTokenParameters.SignedEncrypted[0] as 
      SecureConversationSecurityTokenParameters; 
```

WShttpBinding 有很多代码片段和帮助，但我不能这样做，因为我正在使用流式传输。请帮忙。

# html - 我无法在内容底部正确显示页脚

> ID：14782647
> 
> 赞同：1
> 
> 时间：2013-02-08T22:52:24.790
> 
> 标签：html, css, footer

这是我正在处理的网站的链接。由于某种原因，我无法弄清楚为什么。我可以通过在页脚 div 的顶部留出很大的边距来获得。但这意味着对于较短的页面，我需要几个不同的页脚 div。

[http://www.bwtdesigns.com/413](http://www.bwtdesigns.com/413)

我也有希望添加我的代码的问题。你可以看到我错过了什么。查看源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:02:02.123

`div`需要清除带有“wrap”ID的浮动元素。这可以通过给`div`类名“组”来完成。请务必在整个站点中具有浮动元素的所有父项上执行此操作。

您还需要将以下样式添加到样式表中，然后您可以从页脚中删除上边距。

如果您只需要支持 IE8 及更高版本，请使用以下命令：

```
.group:after {
  content: "";
  display: table;
  clear: both;
} 
```

否则，使用这个：

```
.group:before,
.group:after {
    content: "";
    display: table;
} 
.group:after {
    clear: both;
}
.group {
    zoom: 1; /* For IE 6/7 (trigger hasLayout) */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T22:56:32.370

我不能很好地看你的代码，但我想你有很多浮动元素。在您的页脚之前添加以下内容：

```
<div style="clear: both;"></div> 
```

告诉我这是否改变了什么。或添加`clear: both;`到页脚。

**编辑** 我刚刚添加：

```
.footer {
  margin-top: 0;
  clear: both;
} 
```

使用 FF 开发人员工具添加到您的代码并修复它。阅读 Floats 和 clear CSS 属性。

# c# - 在 windows 窗体 VS2012 中运行编码的 UI

> ID：14782652
> 
> 赞同：3
> 
> 时间：2013-02-08T22:52:42.907
> 
> 标签：c#, visual-studio-2012

我在让我的编码 UI 在单击按钮时工作时遇到问题。我似乎不断收到错误，例如

> “'Microsoft.VisualStudio.TestTools.UITest.Common.UITestLogWrapper' 引发了异常。”

我想知道是否有我丢失的参考或者我需要更改我的初始化代码？

到目前为止，这是我的代码

```
namespace WindowsFormsApplication2
{
    public partial class Form1 : Form
    {
        public Form1()
        {
        InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {

        }

        private void button1_Click(object sender, EventArgs e)
        {
            Microsoft.VisualStudio.TestTools.UITesting.Playback.Initialize();
            CodedUITestProject.CodedUITest1 coded = new CodedUITestProject.CodedUITest1();
            coded.Method();
            Microsoft.VisualStudio.TestTools.UITesting.Playback.Cleanup();
        }
    }
}' 
```

注意到 Microsoft.VisualStudio.TestTools.extension.Uia Microsoft.VisualStudio.TestTools.extension.ie 不在私有或公共程序集文件夹中（这是 2012 年的事情吗？）

这两个项目都在 .NET Framework 4 中

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-04T11:49:26.130

您需要的程序集 Microsoft.VisualStudio.TestTools.extension.Uia 和 Microsoft.VisualStudio.TestTools.extension.ie 可以在“C:\Program Files (x86)\Common Files\Microsoft Shared\VSTT\12.0”中找到，尽管我不确定它是否能解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-31T16:49:51.343

通过从 PrivateAssemblies 目录中添加对 Microsoft.VisualStudio.TestTools.UITest.Logging 的引用，我能够解决您上面列出的问题。但是，即使我引用了 IE 互操作程序集，我也会遇到错误。希望能帮助你比我走得更远。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-09-05T00:43:36.957

添加来自..\Microsoft Visual Studio 11.0\Common7\IDE\PrivateAssemblies 的引用。我的意思是只添加来自 PrivateAssemblies 和 PublicAssemblies 的引用就足够了。记得检查 Microsoft.VisualStudio.TestTools.UITest.Extension.IE.Communication.Interop.dll 这是在您的调试文件夹中引用的

# symfony - 从现有数据库生成实体时，如何修改/创建 manyToMany

> ID：14782660
> 
> 赞同：0
> 
> 时间：2013-02-08T22:53:31.687
> 
> 标签：symfony, doctrine

[在这里](http://symfony.com/doc/2.0/cookbook/doctrine/reverse_engineering.html)，有一个关于“如何从现有数据库生成实体”的解释。

我有一张桌子`person`。还有一张桌子`address`。一个人可以有许多不同的地址，一个地址可以与一个或多个人相关。所以这是一个“多对多”的关系。因此，我创建了一个“中间”表，我在`personaddress`其中调用了 idPersonne 和 idAddress。

启动一代时，一切都很好，但多对多关系（不止一个）。

```
PersonneAdresse:
    type: entity
    table: personne_adresse
    fields:
        id:
            id: true
            type: bigint
            nullable: false
            generator:
                strategy: IDENTITY
    manyToOne:
        idPersonne:
            targetEntity: Personne
            cascade: {  }
            mappedBy: null
            inversedBy: null
            joinColumns:
                id_personne:
                    referencedColumnName: id
            orphanRemoval: false
        idAdresse:
            targetEntity: Adresse
            cascade: {  }
            mappedBy: null
            inversedBy: null
            joinColumns:
                id_adresse:
                    referencedColumnName: id
            orphanRemoval: false
    lifecycleCallbacks: {  } 
```

关于 oneToMany 的文档是不够的（我需要一个例子来理解）：

> 如果您的实体之间有 oneToMany 关系，则需要编辑生成的 xml 或 yml 文件以添加有关特定实体的部分以`oneToMany`定义 the`inversedBy`和 `mappedBy`pieces。

而且我很确定修改不仅仅是关于oneToMany，还有manyToMany。你能解释一下我应该做什么/修改才能正确生成相应的实体吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T12:26:57.957

以下是我做这些事情的方式：我已经生成了整个文件，但我知道有一些 ManyToMany 关系。所以我在相应的文件中“手动”声明了它们。然后我遇到了另一个问题。在文档中，代码示例并非 100% 正确。你必须这样做添加“ `@ORM\`”而不是简单的“ `@`”。这是我的有效代码：

```
/**
 * @ORM\ManyToMany(targetEntity="Adresse", inversedBy="personnes")
 * @ORM\JoinTable(name="personne_adresse")
 **/
private $adresses;
/**
 * @ORM\ManyToMany(targetEntity="Partenaire", inversedBy="personnes")
 * @ORM\JoinTable(name="personne_partenaire")
 **/
private $partenaires;
/**
 * @ORM\ManyToMany(targetEntity="Telephone", inversedBy="personnes")
 * @ORM\JoinTable(name="personne_telephone")
 **/
private $telephones;

public function __construct() {
    $this->adresses = new \Doctrine\Common\Collections\ArrayCollection();
    $this->partenaires = new \Doctrine\Common\Collections\ArrayCollection();
    $this->telephones = new \Doctrine\Common\Collections\ArrayCollection();
} 
```

此外，您必须删除相应的 ManyToMany Php 文件，因为 Symfony 2（我猜）处理那些“中间”ManyToMany 表本身 => 无需声明。在我的示例中，我必须删除“ `PersonneAdresse.php`”、“ `PersonnePartenaire.php`”和“ `PersonneTelephone.php`”。

# asp.net-mvc - SignalR / MVC 控制器操作不序列化 DateTime 相同

> ID：14782663
> 
> 赞同：1
> 
> 时间：2013-02-08T22:53:47.160
> 
> 标签：asp.net-mvc, signalr

我有一个使用 SignalR 的小游戏，它将事件流推送到客户端。

此事件流也可用作`JsonResult`普通 MVC 控制器操作。

两者都使用相同的事件，但在序列化时，SignalR 操作将日期格式设置为

`"2013-02-07T22:22:32.575"`

MVC 操作将日期格式设置为

`"\/Date(1360171089406)\/"`

我希望它们是一致的格式。

为什么会出现不匹配？两个管道中是否有任何配置/扩展点来更改日期的格式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T23:01:38.547

是的，您可以通过调整 JsonSerializer 来更改它。

```
var serializer = new JsonNetSerializer(new JsonSerializerSettings
{
    DateFormatHandling = DateFormatHandling.MicrosoftDateFormat
});

GlobalHost.DependencyResolver.Register(typeof(IJsonSerializer), () => serializer); 
```

在调用 MapHubs 之前将其放入 Global.asax。

# java - 在java中将本地对象传递给线程不好的风格？

> ID：14782665
> 
> 赞同：1
> 
> 时间：2013-02-08T22:53:53.357
> 
> 标签：java, multithreading, concurrency, coding-style

我发现我经常做以下类似的事情。制作对象的副本以发送到线程。线程是唯一使用过该对象的线程，并且我们有一个happens-before关系，所以它是线程安全的。

但这让我*感到*紧张。正如评论所述，如果有人出现并欺骗 objForThread 怎么办？我应该使用锁吗？或者这是一个普遍接受的java模式？

```
class Example
{
  private SomeObj mDynamicObj = new SomeObj();

  public void doWorkInAThread()
  {
    mutateThis(mDynamicObj);
    final SomeObj objForThread = new SomeObj(mDynamicObj);

    myExecutorService.submit(new Runnable() { @Override public void run()
    {
      doSomethingWith(objForThread);
    }});

    mutateThis(mDynamicObj);

    // Concerned that in the future someone will come
    // along and mutate objForThread here making this thread unsafe
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:03:35.397

如果您感到紧张，最好将引用传递给线程，而不是将其保留在本地：

```
class Example
{
    private SomeObj mDynamicObj = new SomeObj ();

    public void doWorkInAThread ()
    {
        class MyRunnable implements Runnable
        {
            private final SomeObj objForThread;

            public MyRunnable (SomeObj objForThread)
            {
                this.objForThread = objForThread;
            }

            @Override
            public void run ()
            {
                doSomethingWith (objForThread);
            }
        }

        mutateThis (mDynamicObj);

        myExecutorService.submit (new MyRunnable (new SomeObj (mDynamicObj)));

        mutateThis (mDynamicObj);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T02:51:03.280

保护您的代码免受人们做出可能破坏它的更改是很困难的。

你可以争辩说这不是你的问题。您可以添加警告评论并继续。或者你可以假设下一个人足够聪明/小心，可以弄清楚他的变化的含义。

或者您可以采取防御措施，例如将 SomeObj 更改为线程安全甚至不可变的……即使这可能会增加额外的运行时开销。

哪种方法最好？我不认为我可以就此提出建议。这取决于更高级别的问题；例如，团队及其代码审查和测试程序有多​​好，整个应用程序有多复杂，性能有多重要，错误有多重要，等等。

* * *

对于这个特定的“示例”，您已经抽象出任何类似于应用程序逻辑的东西，因此很难知道哪种方法是最好的。传递本地对象是“好”还是“坏”取决于上下文。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T22:59:30.757

这完全取决于您要达到的目标。一些数据被设计成可以被多个线程访问和修改。某些数据设计为仅在线程安全环境中使用。

如果你需要更详细的解释，你必须提供一个真实的例子。

此外，某些类被设计为线程安全或不可变的。例如，共享 String 或 Integer 是非常好的。但是，对这些对象的实际引用可能会发生变化，因此如果您依赖这样的引用，那么您可能会遇到问题。

在您的示例中，后者并非如此，因为您通过最终变量引用对象。但是，如果您要引用成员变量 mDynamicObject，那么如果另一个线程中的某个人为其分配了不同的对象（mDynamicObject = new SomeObj()），您就会遇到问题。如果没有适当的同步，它可能会导致您的应用程序出现奇怪的状态。为避免这种情况，您可以将其分配给最终变量和引用。

考虑尽可能多地将参数作为参数传递给新线程调用，而不是让它们被引用。这将保证您引用的内容不会被更改。

当然，如果需要，对象本身最好是不可变的或适当同步的。

# reporting-services - 您可以引用矩阵中的“选定”单元格以在 SSRS 2012 中生成子报告吗？

> ID：14782672
> 
> 赞同：0
> 
> 时间：2013-02-08T22:54:11.257
> 
> 标签：reporting-services, ssrs-2012

所以我知道你可以在单元格中嵌套子报表，但是如果我有很多数据并且我想动态填充子报表怎么办。你能在任何人都知道的 SSRS 中做到这一点吗？

我通常深入到子报表，但是您是否可以捕获隐藏变量或其他值，或者选择对单元格的引用并生成它？

我研究了 Me.Value 和 ReportItems![ItemName].Value 的概念，但它们与静态位置有关，而不是鼠标选择的活动单元格。有谁知道这是 RDL 语言的限制还是可能？在最简单的例子中，我可以说我有一个只有一个字段“名称”的数据集，它有两个值“布雷特”和“肖恩”。我创建了一个表并只设置了一个带有标题的列。我在该表之外创建了一个带有表达式的文本框，因为它是报表正文中的自己的元素（重新创建我想要传递给子报表的内容）。我希望捕获对所选表格元素中内容的引用。

我能否以某种方式让报告知道我单击了表格中的单元格并生成了一个触发该值的事件？还是该语言无法构建这样的引用？我很好奇，因为我不确定，所以我想我会问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T01:38:43.700

所以简短的回答不是真的，因为生成的报告和基础数据是静态的，并且没有用于生成更多数据的事件框架 - 只是改变现有数据的显示（展开/折叠、排序等）（所以理论上，您可以通过单击文本框使文本框的可见性成为交互式，然后将某些“主报告”中各种数据行的可见性设置为等于文本框的可见性，因此它们“隐藏”和“显示” “当用户点击不同的文本框时。但是你必须有一个“重置所有可见性”按钮，一个主报告，以及很多代码隐藏来找出你的子报告可见性行......听起来像维护噩梦！）

显然，您最好的选择是构建一个带有报表查看器控件的 ASP.NET Web 应用程序。然后，您将获得 jQuery 和服务器端请求的所有优点，以处理将参数从客户端传回服务器、生成子报表、返回它（最好作为 ATOM 数据馈送）、解析它，然后将其注入 DOM您希望用户如何看到它。

有些人已经设法[将 jQuery 注入到 SSRS 报表管理器的标题中](http://social.msdn.microsoft.com/Forums/en-US/sqlreportingservices/thread/74f90e77-143f-43e1-abc5-0cf00b764f18/)，所以如果你真的很喜欢冒险，你可以尝试在报表管理器中重新创建相同的体验，但这听起来很麻烦。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-09T04:30:25.353

我猜您正在寻找 SSRS 中的功能，即操作。您可以在单击单元格时定义一个动作，从而为您提供各种动作选项。

对于单击单元格，转到文本框属性，选择作为转到报告的操作并添加要传递的参数。

在此示例中，我有 Report1 ，当我单击 JobCandidate 单元格时，我导航到 Report2，同时我传递了一个参数，该参数是 Report2 中的 Report 2 参数 Param1 使用的 JobCandidate ID。传递给 Param1 的值本质上是单元格值，在本例中为 Fields!JobCandidateId.Value ![在此处输入图像描述](../Images/b4a40fdf392b8faaec48fc85e67a1a81.png)

![在此处输入图像描述](../Images/cbacf0870671459ba56a1cb294b67d59.png)

# scala - 在 For Comprehensions 中匹配正则表达式

> ID：14782685
> 
> 赞同：0
> 
> 时间：2013-02-08T22:56:07.347
> 
> 标签：scala

我正在使用 Scala 2.9 处理一些 Excel 文件。它们都存储在一个目录中并具有文件名`Sales_yyyy_mm.xlsx`。

`File`我编写了以下代码，以生成一个包含年、月和每个 Excel的数组：

```
val fileStruct = """Sales_(\d\d\d\d)_(\d\d).xlsx""".r

val excels = (new java.io.File(dirName)).listFiles

val files = for(file <- excels; fileStruct(year, month) <- file.getName)
            yield(file, year, month) 
```

文件数组正确计算为`excels`. 然而`files`是空的。我检查了文件名，它们都与正则表达式匹配（如果我使用`match`/重写我的代码`case`没有问题）。

代码可以正确编译，并且可以按照我的预期推断类型，但它不起作用。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T23:15:11.443

问题是`file.GetName`返回一个`String`-- 或者，从理解的角度来看，一个`Seq[Char]`. 现在，当您在 for comprehension 中使用模式匹配时，您是在映射或 flatMapping 之前应用过滤器。实际上，您正在这样做：

```
 val files = excels.flatMap(
    (file => file.getName().withFilter(
      ((x$0 => x$0 match {
        case fileStruct((year @ _), (month @ _)) => true
        case _ => false
      })).map(
        (x$1 => x$1 match {
         case fileStruct((year @ _), (month @ _)) => (file, year, month)
      })))) 
```

问题是它`x$0`是 a `Char`，所以它永远不会匹配正则表达式模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T07:49:48.097

我通过以下方式使其工作：

```
val fileStruct = """Sales_(\d\d\d\d)_(\d\d).xlsx""".r

val excels = (new java.io.File(dirName)).listFiles

val files = for{
                file <- excels
                year :: month :: _ <- fileStruct.unapplySeq(file.getName)
            }
            yield(file, year, month) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T23:05:54.257

如果您的目录中只有 Sales_yyyy_mm_xlsx，请尝试以下操作：

```
scala> val files = for(file <- excels ; val fileStruct(year, month) = file.getName)
     | yield(file, year, month); 
```

如果不 ：

```
excels.map(file => fileStruct.findFirstIn(file.getName) match {
     |  case Some(fileStruct(year, month)) => Some(file, year, month)
     |  case _ => None
     | }).filterNot(_.isEmpty) 
```

给我吗 ：

```
res3: Array[Option[(java.io.File, String, String)]] = Array(Some((./Sales_2012_03.xlsx,2012,03)), Some((./Sales_2012_04.xlsx,2012,04))) 
```

我认为当正则表达式不匹配时会出现问题

# javascript - 如果某些脚本删除了以前加载或包含的脚本，那么异步加载 web 应用程序会发生什么？

> ID：14782688
> 
> 赞同：1
> 
> 时间：2013-02-08T22:56:32.653
> 
> 标签：javascript, json, cross-browser, security, browser-security

问题是：如果某些脚本删除了以前加载或包含的脚本，那么异步加载 webapps 会发生什么？

让我们包含几个脚本：

```
<script src="Squel.js" async="" type="text/javascript"></script>
<script src="PSquel.js" async="" type="text/javascript"></script>
<script src="MySquel.js" async="" type="text/javascript"></script> 
```

不管是通过标记包含还是通过requireJS动态包含，异步脚本包含的顺序都是一样的。

MySquel.js 文件的内容可能是这个恶意代码：

```
document.getElementsByTagName('script').forEach(function(val,i,arr){
if(/PSquel/.test(val.src)){
val.parentNode.removeChild(val);
}
} 
```

当然，这个问题是特定于浏览器的，我感兴趣的是，是否有任何怪癖会在任何特定浏览器中打开内存漏洞。我也对你知道的任何边缘情况感兴趣！

我非常感谢您在您所知道的关于可能不安全的脚本加载的任何边缘情况下的回应！谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:07:49.040

没有。节点从 DOM中`<script>`删除，但这无法恢复通过它们加载的 JavaScript 执行期间发生的情况。实际上，它们在实例化后确实没有任何作用，这会触发脚本下载和评估。

唯一可能受到影响的是依赖 DOM 节点存在的其他脚本，例如从它们读取模板字符串、内容位置 url 或其他数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T23:03:39.857

唯一发生的事情是脚本中的源代码消失了。

脚本已经被解析和执行，它创建了 Javascript 对象（例如函数对象），并且当您删除源代码时这些对象不会消失。

# c++ - 获取 C/C++ 中的多播守护进程的客户端列表（活动客户端）（Gstreamer API 或 C 套接字）

> ID：14782689
> 
> 赞同：1
> 
> 时间：2013-02-08T22:56:53.370
> 
> 标签：c++, c, sockets, gstreamer, multicast

**操作系统：LINUX（Redhat Enterprise 和 Ubuntu LTS）**

我目前正在使用 Gstreamer Pipeline 将视频数据多播到各种客户端。我的管道如下所示。`rtspsrc location=rtsp://<ip>:<port>/<location>.sdp latency=0 ! udpsink host=225.1.1.1 auto-multicast=true port=5678 sync=false async=false`. 如您所见，我有一个多播组**225.1.1.1**和端口**5678**。鉴于此信息，是否可以通过 (1) Gstreamer API (2) C/C++ 中的 Berkeley Unix 套接字获取当前连接/活动客户端（IP 地址和其他属性）的列表（如果有）？

把它想象成一个迷你嗅探工具（不像 tshark、ngrep、pcap 等那样复杂）。我可能可以将 bash/Python 脚本和 tshark 与一些过滤器结合使用。但如果可能的话，我更喜欢 C C++ 代码（非 root 执行会很棒！）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:15:50.500

在典型的Streaming 场景中，客户端会在数据类型和客户端端口可用之前`RTSP`调用`SETUP`命令。通常在收到响应后调用，即客户端知道源的属性并继续建立连接。因此，SETUP 可能是了解更多客户信息的好地方。`PLAY``SETUP``DESCRIBE`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T22:18:38.127

GStreamer Pipeline API/协议可以提供一种方式：UDP 多播本身当然没有。你所能知道的只是是否有任何客户端，你必须编写一些原始套接字代码来做到这一点（IGMP 协议）。

# c# - 如何捕获按键？

> ID：14782691
> 
> 赞同：-3
> 
> 时间：2013-02-08T22:57:03.057
> 
> 标签：c#, keypress

我正在学校学习编程 2，我们正在使用 Visual Studio 2010 专业版。

我正在尝试制作一个游戏，您可以使用箭头键控制角色来移动角色以进行跳跃和前后移动。

我已经完成并设置了所有图形，但我需要能够制作它，以便我可以通过使用键更改变量来控制它，使角色移动并与事物交互。

你如何让程序注册一个被按下的键？

这是我到目前为止所拥有的：

```
namespace keypress2 
    { 
    public partial class Form1 : Form 
        { 
        public Form1() 
        { 
            InitializeComponent(); 
            this.textBox1.KeyDown += textBox1_KeyDown; 
        } 

        private void textBox1_KeyDown(object sender, KeyEventArgs e) 
        {

        } 
    } 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:59:27.863

这里有一个关于在 C# 中处理非阻塞键盘输入的博客项目

[http://www.dutton.me.uk/2009/02/24/non-blocking-keyboard-input-in-c/](http://www.dutton.me.uk/2009/02/24/non-blocking-keyboard-input-in-c/)

另外，关于控制台键盘输入的另一篇堆栈溢出文章

[如何读取用户按下的键并将其显示在控制台上？](https://stackoverflow.com/questions/3068168/c-sharp-keyboard-input-beginner-help)

当然，我假设您正在做一个控制台应用程序。如果你正在做一个 WinForm 应用程序，那么答案就不同了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T00:55:26.963

您需要使用“PreviewKeyDown 事件”来捕获按键。

假设您想在表单中移动“英雄”，这是一个按钮。

```
Public Class Form1
    Private Hero As New Button
    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        Hero.Parent = Me
        Hero.Enabled = False
    End Sub
    Private Sub Form1_PreviewKeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.PreviewKeyDownEventArgs) Handles Me.PreviewKeyDown
        Select Case e.KeyCode
            Case Keys.Left
                Hero.Left -= 5
            Case Keys.Right
                Hero.Left += 5
            Case Keys.Down
                Hero.Top += 5
            Case Keys.Up
                Hero.Top -= 5
        End Select
    End Sub
End Class 
```

您还可以捕获其他键，如 W、A、S、D 作为移动角色的替代键，以及 Control+S（保存游戏）。:D

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T21:34:41.720

要为任何控件添加事件，请按 F4 以打开属性窗口并单击闪电图标：

![在此处输入图像描述](../Images/e17107d4c5f52b736ef442c79e7735ae.png)

# java - 具有重复变量的 wsimport 和 WSDL

> ID：14782697
> 
> 赞同：2
> 
> 时间：2013-02-08T22:58:00.483
> 
> 标签：java, wsdl, wsimport, duplicates

我正在尝试对我无法修改的 WSDL 文件运行 wsimport。WSDL 的一部分如下所示：

```
<xsd:complexType name="Bapiitemex">
    <xsd:sequence>
        <xsd:element name="ItmNumber" type="n0:numeric6"/>
        <xsd:element name="PoItmNo" type="n0:char6"/>
        <xsd:element name="Material" type="n0:char18"/>
        <xsd:element name="MatEntrd" type="n0:char18"/>
        <xsd:element name="ShortText" type="n0:char40"/>
        <xsd:element name="NetValue" type="n0:numeric15"/>
        <xsd:element name="Currency" type="n0:cuky5"/>
        <xsd:element name="Subtotal1" type="n0:numeric15"/>
        <xsd:element name="Subtotal2" type="n0:numeric15"/>
        <xsd:element name="Subtotal3" type="n0:numeric15"/>
        <xsd:element name="Subtotal4" type="n0:numeric15"/>
        <xsd:element name="Subtotal5" type="n0:numeric15"/>
        <xsd:element name="Subtotal6" type="n0:numeric15"/>
        <xsd:element name="SUBTOTAL1" type="n0:decimal23.4"/>
        <xsd:element name="SUBTOTAL2" type="n0:decimal23.4"/>
        <xsd:element name="SUBTOTAL3" type="n0:decimal23.4"/>
        <xsd:element name="SUBTOTAL4" type="n0:decimal23.4"/>
        <xsd:element name="SUBTOTAL5" type="n0:decimal23.4"/>
        <xsd:element name="SUBTOTAL6" type="n0:decimal23.4"/>
    </xsd:sequence>
</xsd:complexType> 
```

wsimport 不满意，因为包含多个仅在大小写上有所不同的元素（'Subtotal1' 与 'SUBTOTAL1' 等）。具体错误是

> java.lang.IllegalArgumentException：尝试创建相同的字段两次：subtotal1

在研究此问题的解决方案时，我尝试使用“-B-XautoNameResolution”选项运行 wsimport，但没有效果。似乎唯一其他可能的解决方案是使用外部绑定文件来明确告诉 wsimport 如何命名变量。但是，我也很难做到这一点。这是我试图仅用于其中一个重复变量的绑定文件：

```
<jxb:bindings version="1.0"
xmlns:jaxb="http://java.sun.com/xml/ns/jaxb"
xmlns:jxb="http://java.sun.com/xml/ns/jaxb"
xmlns:xsd="http://www.w3.org/2001/XMLSchema">
<jxb:bindings node="//xsd:complexType[@name='Bapiitemex']//xsd:element[@name='Subtotal1']">
    <jxb:property name="testSubtotal1"/>
</jxb:bindings> 
```

尽我所能，wsimport 似乎不明白我要它做什么。我对“节点”属性使用的 XPath 语法不满意，返回错误：

> “//xsd:complexType[@name='Bapiitemex']//xsd:element[@name='Subtotal1']”的 XPath 评估导致空目标节点

关于如何说服 wsimport 为我生成 Java 类的建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:27:11.250

经过更多的摸索，我终于想出了如何编写一个绑定文件来使事情正常进行。我的解决方案主要基于我在[这篇文章](https://stackoverflow.com/questions/7881883/jaxb-customizations-with-a-poorly-formed-wsdl/)中找到的信息。

请注意，我有 6 种元素名称，它们仅在大小写上有所不同。下面发布的解决方案仅解决其中一个冲突。其余部分可以通过添加更多内部 <jaxws:bindings> 元素来解决。

```
<jaxws:bindings
    xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/"
    xmlns:jaxws="http://java.sun.com/xml/ns/jaxws"
    xmlns:jaxb="http://java.sun.com/xml/ns/jaxb" jaxb:version="2.1"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema"
    wsdlLocation="PricingDirectCall.wsdl">

    <jaxws:bindings node="wsdl:definitions/wsdl:types/xsd:schema[@targetNamespace='urn:sap-com:document:sap:soap:functions:mc-style']/xsd:complexType[@name='Bapiitemex']/xsd:sequence/xsd:element[@name='Subtotal1']">
        <jaxb:property name="testSubtotal1"/>
    </jaxws:bindings> 
```

我必须克服的最大障碍是摆弄“节点”属性以使 XPath 正确（冲突实际上发生在 WSDL 内的内部 XSD 中）。在我解决了这个问题之后，我只需要确保我指定了正确的 <jaxb> 元素。指定 <jaxb:class> 会更改生成变量的数据类型，创建具有指定名称的内部类，这不是我想要的。指定 <jaxb:property> 会更改生成变量的名称，从而解决重复名称冲突。

# stata - 根据多个值检查 If

> ID：14782698
> 
> 赞同：1
> 
> 时间：2013-02-08T22:58:02.433
> 
> 标签：stata

我正在使用`ssc install vallist`生成一个输出宏的适用国家/地区列表，例如：

r(list) : "32 36 348 392 410 76 112 152 156 203"
（可选）如果有帮助，可以用逗号而不是空格分隔）

`tab`然后，如果它的国家/地区位于该列表的任何位置，我想要一个变量。

关于如何做到这一点的任何想法。我想使用 inlist，但我必须像这样手动传递每个国家/地区

```
Typing by hand works just fine
tab health if inlist(country, 32, 36, 348,... 203)

I'd like to do this
tab health if inlist(country, r(list)) 
```

也许，有什么方法可以遍历列表中的每个元素并使用 if 语句应用过滤器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:23:14.100

您需要使用引号来评估本地值，并且需要使用逗号分隔值。这是使用自动数据的示例。

```
sysuse auto
vallist rep78, sep(,)
tab foreign if inlist(rep78, `r(list)') 
```

# ios - 如何以编程方式关闭自动亮度？

> ID：14782700
> 
> 赞同：4
> 
> 时间：2013-02-08T22:58:20.673
> 
> 标签：ios, objective-c, settings, brightness, screen-brightness

我想知道是否有一种方法可以将 iOS 设备上的“自动亮度”选项切换到关闭位置，如果有，它是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-08T23:09:03.343

当您在应用程序内时可以调整亮度，并且它在 UIScreen 类中可用 -

这是文档 - [http://developer.apple.com/library/ios/#documentation/uikit/reference/UIScreen_Class/Reference/UIScreen.html#//apple_ref/occ/instp/UIScreen/brightness](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIScreen_Class/Reference/UIScreen.html#//apple_ref/occ/instp/UIScreen/brightness)

但是 Apple 的官方公共 API 不允许 iOS 应用程序访问设置应用程序中的常规设置。因此，您将无法更改设置应用程序内的切换按钮。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-08T23:07:13.723

我不能与任何权威人士交谈（不能证明是否定的，等等），但这似乎不像 Apple 会让 3rd 方应用程序能够修改的设置。当然，Settings.app 会修改它，但这并不意味着有公共 API 可以做到这一点。由于这篇文章没有`jailbreak`标签，我将继续假设提问者正在询问公共 API。我会选择“你不能”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-08T06:22:57.830

**Objective-C**

```
[[UIScreen mainScreen] setBrightness:1.0]; 
```

是要走的路。是的，您可以以编程方式进行。只需传递 0.0 到 1.0 之间的值即可。根据苹果，它是有效的，你不会遇到任何问题。

**斯威夫特 3+**

```
UIScreen.main.brightness = CGFloat(1.0) 
```

[https://discussions.apple.com/thread/2009141?tstart=0](https://discussions.apple.com/thread/2009141?tstart=0)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-09-06T06:03:31.040

但是您可以定期检查亮度，并在您的应用程序运行时将其调整到您希望的亮度（如果您真的需要）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-11-26T19:07:49.283

根据希望的回答，对于那些希望在屏幕自动改变亮度时得到通知的人：

```
func trackBrightness() {   
    // Track brightness changes
    NotificationCenter.default.addObserver(self, selector: #selector(brightnessDidChange), name: UIScreen.brightnessDidChangeNotification, object: nil)
}

@objc func brightnessDidChange() {
    let newBrightness = UIScreen.main.brightness
    // Do something
} 
```

# delphi - Delphi - 使用套接字从 Web 下载文件

> ID：14782701
> 
> 赞同：4
> 
> 时间：2013-02-08T22:58:32.180
> 
> 标签：delphi, http, sockets

我尝试过 Synapse、Indy 和 ICS，但我对它们并不满意。我想同时下载多个部分的多个文件，支持恢复、gzip 编码的文件、cookie、使用 POST 登录网站等。所以我想我会用套接字写。但我看到 Delphi 中有很多可用的套接字：TTcpClient、TRawSocket、TCGIRequest、TClientSocket 等等。它们都没有完整的文档记录——很难找到使用示例。我尝试使用 TTcpClient 但有时程序会冻结然后超时，我不知道为什么。等待回复时似乎有问题。这肯定不是服务器问题，因为我在 localhost 上进行了测试。用于 HTTP 协议的最佳套接字是什么？好用的东西？

我想在 Delphi 7 和 XE2 中都使用。我不想使用 WinAPI 之类的任何东西，所以我不必处理 PChars 和其他非 Delphi 的东西。

我正在考虑类似的事情：

1) 完全符合我的要求 - 在同一个文件中下载多个带有多个文件进度条的片段

或者

2）像telnet这样的东西——所以我只是把HTTP命令写成字符串，然后我得到字节数组作为回报，我可以转换成字符串或保存到tstreams。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-08T23:26:00.777

我无法评论其他库，但 Indy 支持您所要求的一切。

如果服务器支持，该`TIdHTTP`组件可以使用字节范围下载文件。您可以使用该`TIdHTTP.Head()`方法检查服务器是否返回`Accept-Ranges: bytes`给定 URL 的标头。如果是这样，那么您可以在从该 URL 下载数据时根据需要将`TIdHTTP.Request.ContentRangeStart`和`TIdHTTP.Request.ContentRangeEnd`属性设置为所需的字节偏移量。要同时下载资源的多个部分，只需并行运行多个线程，每个线程都有自己的`TIdHTTP`组件。然后，您必须下载多个片段以分隔临时文件，然后在完成后将它们合并到最终文件中，或者创建一个预先确定大小的文件，然后`TFileStream`在所需的起始偏移量处打开多个对象以`TIdHTTP`写入.

`TIdHTTP`支持cookies。您可以将`TIdCookieManager`组件分配给`TIdHTTP.CookieManager`属性，也可以将其保留为未分配并在内部`TIdHTTP`创建一个`TIdCookieManager`对象。无论哪种方式，还要将该`TIdHTTP.AllowCookies`属性设置为 True。

网站登录可以通过两种不同的方式之一完成，具体取决于服务器是使用基于 HTTP 的身份验证还是基于 WebForm 的身份验证：

1.  对于 HTTP 身份验证，将所需`IdAuthentication...`的单元添加到您的`uses`子句中，例如`IdAuthentacationDigest`and`IdAuthenticationNTLM`或`IdAllAuthentications`unt，以使用 注册各个身份验证类`TIdHTTP`，然后根据需要设置`TIdHTTP.Request.UserName`and`TIdHTTP.Request.Password`属性。如果 WebServer 在请求期间要求进行身份验证，`TIdHTTP`将选择适当的类并使用它使用指定的凭据登录。如果服务器拒绝凭据，`TIdHTTP.OnAuthorization`将触发该事件，让您有机会更改凭据并重试。

2.  对于 WebForm 身份验证，有一个`TIdMultipartFormDataStream`类可以传递给`TIdHTTP.Post()`发布`multipart/form-data`格式化 POST 请求的方法。

`TIdHTTP`在 Indy 10 中支持 gzip 文件和 deflate 压缩文件（`TIdHTTP`在 Iny 9 和更早版本中不支持压缩）。您可以为该属性分配一个`TIdZLibCompressorBase`衍生组件，例如`TIdCompressorZLib`，并将为您处理所有细节，包括发送适当的请求标头和检查服务器的响应标头。`TIdHTTP.Compressor``TIdHTTP``Accept-Encoding``Transfer-Encoding`

`TIdHTTP`has `OnWorkBegin`, `OnWork`, 和`OnWorkEnd`可用于进度条等的事件。该`OnWorkBegin`事件有一个`AWorkCountMax`参数，如果已知，则指定要传输的字节总数，否则将为 0（使用`Content-Length`标头的 HTTP 响应将`AWorkCountMax`相应地设置，但使用`Transfer-Encoding: chunked`标头的 HTTP 响应不会）。该`OnWork`事件有一个`AWorkCount`参数，该参数指定到目前为止已传输了多少字节，而不管`AWorkCounMax`值如何。

# android - Android ListView 字符串数组

> ID：14782702
> 
> 赞同：1
> 
> 时间：2013-02-08T22:58:32.903
> 
> 标签：android

我的 android 项目包含一个由 xml 文件填充的列表视图。xml 文件包含节点：

```
<item ID=XXXX>VALUE</item> 
```

我目前正在使用一个数组列表，它存储节点 VALUE 及其绑定在我的列表视图中。在 ItemClick 上，我需要 ID 的地方调用了一个新活动。

现在我真的不知道如何实现这一点：

1.  从 xml-> 获取值
2.  仅将 VALUE 绑定到 listview->
3.  onItemClick 获取 id 并将其作为参数提供给其他活动（当前为其他活动提供参数正在使用 ArrayList）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:40:20.937

1) 创建包含 id 和 value 的对象

2）基于ArrayDapter的Crate自定义适配器

3) 使用对象集合填充适配器

4）实现项目点击，你可以得到你的对象

5) 从对象中获取 id 并触发它

如果您尝试使用“android listview custom adapter”进行谷歌搜索，您会发现很多示例

# java - 如何在 appengine 数据存储中的两个日期之间获取实体

> ID：14782710
> 
> 赞同：3
> 
> 时间：2013-02-08T22:59:19.110
> 
> 标签：java, google-app-engine, jpa, datastore

我有一个约会表，其中约会日期为一列。我想使用 JPA 检索 appengine 数据存储中两个日期之间的所有约会。请让我知道如何实现这一目标？我尝试了以下查询，但没有奏效。

从约会中选择一个，其中 (apptSts='p' 或 apptSts='a') 和 (apptDate>=:fromDate 或 apptDate<=:toDate)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T06:32:13.290

将该属性设为列表属性。然后您可以在两个日期之间进行查询。请参阅在 Objectify 中完成的以下测试代码。我认为您也可以在 JPA 中使用相同的技术。 [https://github.com/stickfigure/objectify/blob/master/src/test/java/com/googlecode/objectify/test/QueryExoticTypesTests.java](https://github.com/stickfigure/objectify/blob/master/src/test/java/com/googlecode/objectify/test/QueryExoticTypesTests.java)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-09T07:01:50.490

要检索两个日期之间的约会，您需要将查询逻辑更改为包括 "**和**" 而不是 "**或**" ：

```
select a from Appointment
where apptDate>=fromDate and apptDate<=toDate 
```

您可以在 appengine 中的同一属性上使用不等式文件管理器，但它们不能与 OR 结合使用。

[请参阅gql 参考](https://developers.google.com/appengine/docs/python/datastore/gqlreference#Examples)中的示例，这也应该适用于 JPA。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-27T10:09:35.667

您可以应用多个不等式，但它们应该在同一个字段（变量）上。我猜这里出了什么问题是应用程序引擎不允许使用括号的东西，，，我的意思是

```
(conditionA AND conditionB .....) OR (conditionC AND conditionC .....)
//--this is not allowed. 
```

顺便说一句，以下是允许的（我试过了）

```
(conditionA AND conditionB .....) AND (conditionC AND conditionC)
//--allowed(although its bracket are meaning less here) 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2013-02-08T23:03:03.027

您只能执行大于或小于查询，因此一种方法是执行大于查询，并遍历结果并手动过滤掉与小于查询不匹配的结果。

# java - 架构 java gwt+jsf2+spring 打包

> ID：14782713
> 
> 赞同：0
> 
> 时间：2013-02-08T22:59:38.570
> 
> 标签：java, spring, gwt, jsf-2

我打算做一个网站，它有 GWT 作为管理界面，JSF 2 作为前端，spring 来处理业务逻辑。

基本上。我将有3个项目：

1.  GWT
2.  spring（未来也可能导出一些 Web 服务的业务逻辑）
3.  JSF 2

在 GWT 中，我打算使用 spring 上下文（来自依赖的 spring-project）并使用它来连接数据库？

1.  这是否可以在 Eclipse 中创建 3 个项目，将它们称为依赖项，然后创建一个包含所有这些项目的 EAR？
2.  用户会话会发生什么？存储在 GWT 和 JSF 2 中？
3.  它是一个好的架构吗？这怎么能以其他方式完成？
4.  我该如何包装这些？所有战争文件？还是罐子？在一只耳朵里……还是？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T11:06:18.963

首先，为什么要一起使用两种不同的客户端技术（`JSF2`和`GWT`）？我宁愿坚持其中之一。

说：是的，可以有 3 个不同的项目。实际上，推荐的方法（至少使用`GWT`和`Spring`或任何其他后端）是将它们放在单独的项目中。

> 这是否可以在 Eclipse 中创建 3 个项目，将它们称为依赖项，然后创建一个包含所有这些项目的 EAR？

好吧，至少使用 GWT，您通常无法直接访问后端/数据库（不确定 JSF2）。您必须使用某种通信协议（`RequestBuilder`, `RequestFactory`, `GWT-RPC`, `REST`）您可以拥有共享类（在包中），您和您的 应用程序`xxx.shared`都可以引用这些类（通常由or使用）`GWT``Spring``GWT-RPC``RequestFactory`

> 用户会话会发生什么？存储在 GWT 和 JSF 2 中？

用户会话没有什么特别之处。GWT 和 JSF 通过 HTTP 请求与后端进行通信。因此，适用于普通 HTTP 请求的相同内容也适用于 GWT/JSF2 请求。

> 它是一个好的架构吗？这怎么能以其他方式完成？

这取决于您想要达到的目标。如前所述，我宁愿坚持使用一种客户端技术（`GWT`或`JSF2`）而不是同时使用它们。

> 我该如何包装这些？所有战争文件？还是罐子？在一只耳朵里……还是？

GWT 编译为包含在您的主机文件中的 javascript。因此，您通常会创建一个部署到应用程序服务器的**WAR**或**EAR文件。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T22:30:53.960

我会回答我的问题，因为我会为下一个想要做同样事情的人提供更多细节：

在 Eclipse 中：

1.  通常使用 3 个或您想要多少个模块创建新的 Java EE 应用程序
2.  添加新的 GWT 项目
3.  将现有的 GWT 项目添加到 Java EE 描述符中（要添加到 ear 中）
4.  在项目构建器中，您应该具有以下内容： ![在此处输入图像描述](../Images/10ef8079819a3e621f66a2710a30c0d4.png)
5.  编译一次 GWT 应用程序： ![在此处输入图像描述](../Images/4e9254165b54d6e1746ca375d1eb5347.png)
6.  在您部署您的应用程序以`glassfish`通过以下 URL 使用 chrome 访问您的网站后：`http://localhost:8080/Admin/?gwt.codesvr=127.0.0.1:9997`

你需要知道的：

*   Servlet 是热部署的
*   您对 servlet 所做的任何修改都会更改服务器部分
*   您对 GWT 应用程序`google chrome`插件所做的任何修改都会处理它

我的环境：

*   `JDK 1.7.0_11`
*   `Eclipse 4.2 Java EE`( `+ GWT Plugin`, `+ Spring plugin`)
*   `Glassfish 3.1.2.2`

# java - 在android中复制和粘贴文件

> ID：14782715
> 
> 赞同：0
> 
> 时间：2013-02-08T22:59:48.813
> 
> 标签：java, android

所以我试图制作一个文件管理器 android 应用程序，允许我复制和粘贴选定的文件。我在网上找到了一种有用的方法，但它似乎对我不起作用。如果您能就如何解决我的问题提供任何建议，那就太好了，谢谢

公共无效副本（文件 src，文件 dst）抛出 IOException {

```
InputStream in = new FileInputStream(src);
OutputStream out = new FileOutputStream(dst);

// Transfer bytes from in to out
byte[] buf = new byte[1024];
int len;
while ((len = in.read(buf)) > 0) {
    out.write(buf, 0, len);
}
in.close();
out.close(); 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:18:00.037

您的功能没有任何问题，它只会将文件（或重命名）从位置复制到另一个位置。

参考您收到的错误`(is a directory)`，我相信您在目标中指定了错误的参数，它必须是文件名**而不是**目录

因此，要正确使用此功能，您可以执行以下操作：

```
 copy(new File("Director1","filename"), new File("Directory2","filename")); 
```

或者您可以将它用于`rename`文件（不是有效的解决方案），例如

```
 copy(new File("Director1","filename"), new File("Directory1","new_filename")); 
```

# php - 是否可以获取网站的 innerHTML？

> ID：14782716
> 
> 赞同：0
> 
> 时间：2013-02-08T22:59:50.863
> 
> 标签：php

我想使用 PHP 获取网站的内部 HTML，可以吗？

我只知道`file_get_contents($URL)`获取源的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:06:48.987

您可以`curl`用于发送 HTTP 标头和另一个套接字参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T23:09:10.837

您可以使用 Simple HTML Dom 来遍历和解析格式良好的 HTML：

[http://sourceforge.net/projects/simplehtmldom/](http://sourceforge.net/projects/simplehtmldom/)

例如：

```
<?php

include_once('simple_html_dom.php');
$html = file_get_html('http://target.page.com');

// Output the contents of <div id="target-id">
$content = $html->find('div#target-id');
echo $content[0]->plaintext;

// Output the entire page as plaintext
echo $html->plaintext;

?> 
```

文档可以在这里找到：

[http://simplehtmldom.sourceforge.net/manual.htm](http://simplehtmldom.sourceforge.net/manual.htm)

# json - 序列化对象字段和属性时如何忽略 EmitDefaultValue=false

> ID：14782718
> 
> 赞同：2
> 
> 时间：2013-02-08T23:00:08.190
> 
> 标签：json, serialization, json.net

我正在尝试序列化具有用 [DataMember(IsRequired = false, EmitDefaultValue = false)] 装饰的字段和属性的对象我无法更改这些对象（无法访问源代码）并且我需要能够序列化*所有*字段和属性，无论其价值如何。我尝试使用 NullValueHandling.Include，但没有任何区别。是否有不同的设置可以让我指示 JSON.Net 序列化这些属性？

这是一个非常简单的示例类（同样，请记住，我不能以任何方式更改此类）：

```
[Serializable]
[DataContract]
class SampleClass2
{
    public SampleClass2()
    {
        dow = daysOfWeek.Mon;
    }

    public enum daysOfWeek { Mon = 0, Tue = 1, Wed = 2, Thu = 3, Fri = 4, Sat = 5, Sun = 6 };

    [DataMember(IsRequired = false, EmitDefaultValue = false)]
    public daysOfWeek dow;
} 
```

我用来序列化它的代码：

```
 public static void TestSerializeSampleClass2()
    {
        SampleClass2 sc2 = new SampleClass2();
        sc2.dow = SampleClass2.daysOfWeek.Mon;

        string json = "";

        Newtonsoft.Json.JsonSerializerSettings jss =
            new Newtonsoft.Json.JsonSerializerSettings() { DefaultValueHandling = Newtonsoft.Json.DefaultValueHandling.Include, NullValueHandling = Newtonsoft.Json.NullValueHandling.Include };
        // jss.DefaultValueHandling = Newtonsoft.Json.DefaultValueHandling.Include;
        json = Newtonsoft.Json.JsonConvert.SerializeObject(sc2, jss);
        Console.WriteLine(json);

        sc2.dow = SampleClass2.daysOfWeek.Tue;
        json = Newtonsoft.Json.JsonConvert.SerializeObject(sc2, jss);
        Console.WriteLine(json);

        Console.WriteLine("");
        Console.ReadLine();
    } 
```

运行这个的输出：

{} {“道”：1}

零 (0) 是枚举的默认 C# 值，因此当“dow”设置为“Mon”时，序列化的 JSON 为空，而在第二次尝试时，使用“Tue”我得到的值为 1。

我开始通过编写自己的 ContractResolver 的路线，不得不放弃。原始的“GetSerializableMembers”代码对内部方法进行了大量调用，我希望避免将这么多代码覆盖/复制到我自己的项目中。我相信我可能在某处缺少一个设置。

任何帮助将不胜感激。

提前致谢，

古斯塔沃

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-09T08:30:31.790

DataContract 代理不能在这里工作吗？

[http://msdn.microsoft.com/en-us/library/ms733064%28v=vs.110%29.aspx](http://msdn.microsoft.com/en-us/library/ms733064%28v=vs.110%29.aspx)

您可以使用您想要的任何装饰器创建一个代理类（因此没有 EmitDefaultValue=false），这应该可以在不需要复制整个初始类代码的情况下工作。

# git - 创建 git 子模块以替换复制和修改的文件

> ID：14782726
> 
> 赞同：1
> 
> 时间：2013-02-08T23:00:54.710
> 
> 标签：git

我有一个 git 项目，其中包含从另一个 git 项目复制的一些文件。现在我想将这些文件转换成一个 git 子模块。我可以在不丢失我已经做过的改变的历史的情况下做到这一点吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T03:22:19.787

制作您的存储库的副本，使用`git filter-branch`. 因此，您只有提交描述了该子目录中发生的事情，并且目录层次结构看起来与未来子模块中的完全相同。

然后将此新存储库作为远程存储库添加到上游存储库并进行合并。Git 会说一些关于没有共同祖先的事情，但它应该可以工作。

毕竟，删除项目中的子目录并将子模块放在它的位置（在一次提交中）。

# c# - 在 ScrollViewer SL4 的焦点更改时将控制权带入 ViewPort

> ID：14782727
> 
> 赞同：5
> 
> 时间：2013-02-08T23:00:58.257
> 
> 标签：c#, silverlight, xaml, scrollview

基本上，我正在寻找与SL4 的[BringIntoViewOnFocusChange](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.scrollviewer.bringintoviewonfocuschange)完全相同的东西，我需要任何具有焦点的控件来自动移动到视图中`ViewPort`，`ScrollViewer`无论它是启用垂直滚动还是水平滚动或两者兼而有之。因此，如果说有一个大视图，控件不在视图中，当用户沿着它的选项卡放置任何将焦点放在视图中的控件时，无需手动进行平滑滚动。

我已经通过行为和设置完成了这项工作，`VerticalOffset`并将其附加到每个单独的对象，但必须有更好的方法，而且这必须经常为人们提出（除了我找不到任何特定的搜索）所以我真的宁愿如果可以的话，不要在这里重新发明轮子。所以，请分享一些启示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T22:04:54.163

我最终走上了这条恰好是我正在寻找并且工作出色的路线。感谢所有看过的人。

[http://mattduffield.wordpress.com/2011/01/15/automatically-scrolling-to-a-selected-item-in-a-scrollviewer-in-silverlight/](http://mattduffield.wordpress.com/2011/01/15/automatically-scrolling-to-a-selected-item-in-a-scrollviewer-in-silverlight/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T04:15:28.960

您可能会感兴趣：[Silverlight BringIntoView() 扩展方法（具有 OnGotFocus 行为）](http://weblogs.asp.net/dotjosh/archive/2009/11/05/bringintoview-extension-method-for-silverlight-with-behavior.aspx)

# twitter-bootstrap - 使用bootstrap Datepicker时Object [object Object]没有方法

> ID：14782728
> 
> 赞同：0
> 
> 时间：2013-02-08T23:01:04.287
> 
> 标签：twitter-bootstrap, datepicker

我正在使用此**[DatePicker](http://tarruda.github.com/bootstrap-datetimepicker/)**，但在尝试使用它时出现以下错误：

***TypeError: Object [object Object] 没有方法'datetimepicker'***

它在我的脚本部分给出了错误，如下所示：

```
 $(function () {
        $('#StartDate').datetimepicker({
            pickTime: false
        });
    }); 
```

这是我的 HTML：

```
<div id="StartDate" class="input-append">
                        <input data-format="yyyy-MM-dd" type="text" />
                        <span class="add-on">
                            <i data-time-icon="icon-time" data-date-icon="icon-calendar"></i>
                        </span>
                    </div> 
```

我已经导入了所有必需的库，我的基本 Jquery 库是 1.9.0

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T22:40:44.767

我也遇到了这个问题，我通过为我的日期选择器使用以下 HTML 解决了这个问题。

```
<div id="StartDate" class="input-append date">
    <input type="text" />
    <span class="add-on">
    <i data-time-icon="icon-time" data-date-icon="icon-calendar"></i>
    </span>
</div> 
```

这是需要引用的以下库。

```
 <script type="text/javascript"
 src="http://cdnjs.cloudflare.com/ajax/libs/jquery/1.8.3/jquery.min.js">
</script> 
<script type="text/javascript"
 src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/js/bootstrap.min.js">
</script>
<script type="text/javascript"
 src="http://tarruda.github.com/bootstrap-datetimepicker/assets/js/bootstrap-datetimepicker.min.js">
</script> 
```

要绑定日期选择器，可以使用以下内容。

```
$(function () {
  $('#StartDate').datetimepicker({
     pickTime: false
   })
   .on('changeDate', function (ev) {
    TaskSubmitViewModel.TaskStartDate(ko.toJSON(ev.date).substr(1, 10))

      });
}); 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-08T23:21:33.853

我遇到了类似的问题，得到“[Object Object]”，所以我希望这对你有帮助......你试过改变`$('#StartDate').datetimepicker({`吗`$('#StartDate').datetimepicker.val()({`？ *如果*我的想法是正确的，那么您选择的是 datepicker 元素，而不是它的价值。

# php - 每个 php 循环实例的唯一 jQuery 对话框，在子选项卡内

> ID：14782730
> 
> 赞同：1
> 
> 时间：2013-02-08T23:01:13.210
> 
> 标签：php, jquery, loops, dialog

我弄得一团糟。:) 我是 jQuery 的新手。丰富的 PHP 经验。很确定我已经下载了 1/4 的互联网临时文件，试图找到帮助的线索，买了超过 100 美元的书。请帮我学习这个！

这是情况。我正在处理可以编辑信息的页面。此信息按几个不同的级别进行排序。我们有房间和物品。项目可以是房间内的许多不同项目。这些项目被收集起来，然后循环到它们相应的选项卡中，即一个房间。选项卡、表格、行等都在这些循环中处理。此外，我正在尝试设置 jquery 以打开一个对话框来编辑房间内列出的项目。这个对话框最终会有 UI 可排序插件来组织数据。

循环很好用，对话框很好用，甚至是可排序的功能。但是，由于每个选项卡都应该有自己独特的对话框，我知道我需要为每个对象设置一个唯一标识符，我可以在循环中轻松完成，但不知道如何让 jQuery 识别它。

因此，当您单击“编辑”时，每个对话框对象都会出现一个对话框。

处理这个问题的最佳方法是什么？一个jQuery循环？

（我遗漏了一些看起来不相关的东西。对不起，如果语法混乱，我会在它工作后清理。：P）

**PHP/HTML**

```
 $count = count( $tpl['template'] );

for( $i = 0; $i < $count; $i++ )
{
    foreach( $tpl['template'][$i] as $k => $v )
    {
        if( is_int($k) )
        {
            unset( $tpl['template'][$i][$k] );
        }
    }
}

$temprooms = array();
for( $i = 0; $i < $count; $i ++ )
{
    foreach( $tpl['template'][$i] as $k => $v )
    {
        if( $k == "room_name" )
        {
            if( ! in_array($v, $temprooms, true ) )
            {
                $temprooms[] = $v;
            }
        }
    }
}
$rooms = array();
foreach( $temprooms as $k => $v )
{
    $rooms[$k+1] = $v;
}
?>
<div id="nested-tabs">
        <ul>
<?
foreach( $rooms as $k => $v )
{
?> <li><a href="#<?echo $v; ?>"><?echo $v; ?></a></li>
<?
}
?>
</ul>

<?php
krumo( $tpl['template'] );

foreach( $rooms as $these => $those )
{
?>
        <div id="<?php echo $those; ?>">
          <table class="ebc-table">
            <thead>
              <tr>
                <table class="ebc-table">
                  <thead>
                    <tr>
                      <th class="sub">Component</th>
                      <th class="sub">U/M</th>
                      <th class="sub">Clean</th>
                      <th class="sub">Repair</th>
                      <th class="sub">Replace</th>
                      <th class="sub">Upgrade</th>
                    </tr>
<?
    foreach( $tpl['template'] as $k => $v )
    {
        foreach( $tpl['template'][$k] as $key => $value )
        {
            if( $key == "room_name" )
            {
                if( $key != $those )
                {
                    $roomname = $value;
                }
            }
            else{
                if( $v['room_name'] == $those )
                {
                    if( $key == "item_name" )
                    {
?>                  <tr>
                            <td><?php echo $value; ?></td>
<?
                    }
                    if( $key == "um" )
                    {
?>                  <td><?php echo $value; ?></td>
<?
                    }
                    if( $key == "GROUP_CONCAT(IC.amt)" )
                    {
                        $prices = explode( ",", $value );
                        foreach( $prices as $index => $price )
                        {
?>                      <td><?php echo $price; ?> </td>
<?                  }
?>                  </tr> <?
                    }
                }
            }
        }
    }
    ?>

                      </thead>
                </table>
              </tr>
             <tr>
                <td>
                    <p>
                        <label class="title">&nbsp;</label>
                        <a href="#" class="room-edit" >Edit</a>
                    </p>
                </td>
            </tr>
            </thead>
          </table>
         </div>

    <div class="edit-dialog" title="Edit Room">
        <table width="100%" height="100%" border="0">
            <tr>
                <td width="40%">
                    <p>
                        <ul id="sortable1" class="connectedSortable">
                            <li class="ui-state-default">Item 1</li>
                            <li class="ui-state-default">Item 2</li>
                            <li class="ui-state-default">Item 3</li>
                            <li class="ui-state-default">Item 4</li>
                            <li class="ui-state-default">Item 5</li>
                        </ul>
                    </p>
                </td>
                <td>
                    <center>
                        <br />
                        <p>
                            <a href="#" class="add-all">&lt; Add All</a>
                        </p>
                        <br />
                        <p>
                            <a href="#" class="remove-all">Remove All &gt;</a>
                        </p>
                        <p>
                            <br />
                            <a href="#" class="reset">Reset</a>
                        </p>
                    </center>
                </td>
                <td width="40%">
                    <p>
                        <ul id="sortable2" class="connectedSortable">
                            <li class="ui-state-default">Item 1</li>
                            <li class="ui-state-default">Item 2</li>
                            <li class="ui-state-default">Item 3</li>
                            <li class="ui-state-default">Item 4</li>
                            <li class="ui-state-default">Item 5</li>
                        </ul>
                    </p>
                </td>
            </tr>
        </table>
    </div>
<?
}
?> 
```

这是我正在尝试使用的脚本片段：

```
if( $ ('div.edit-dialog').length > 0){
    $( 'div.edit-dialog' ).dialog({ 
        autoOpen: false,
        height: 500,
        height: 500,
        width: 550,
        modal: true,
        position:['middle','middle'],
        draggable: true,
        resizable: true,
        buttons: {
            Cancel: function() {
                $( this ).dialog( "close" );
            }
        },
            close: function() {
                allFields.val( "" ).removeClass( "ui-state-error" );
            }
    });

    $( 'a.room-edit').click(function() {
        $( 'div.edit-dialog' ).dialog( "open" );
        });

    $( "#sortable1, #sortable2" ).sortable({
        connectWith: ".connectedSortable",
        dropOnEmpty: true
    }).disableSelection();

    $("a.add-all").click(function() {
        $("#sortable2 li").appendTo("#sortable1");
    });
    $("a.remove-all").click(function() {
        $("#sortable1 li").appendTo("#sortable2");
    });
    $("a.reset").click(function(resetall) {
        $('#sortable1').html('');
        $('#sortable2').html('');
        $('#sortable1').html(reset1);
        $('#sortable2').html(reset2);
    });

    var reset1 = $('#sortable1').html();
    var reset2 = $('#sortable2').html();

} 
```

如果您需要更多信息，请告诉我。

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:14:38.660

我相信您可以使用 HTML5 数据属性来实现您的目标：

所以你的 a.room-edit 节点可能像：

```
<a href="#" class="room-edit" data-roomID="room_12345">Edit</a> 
```

你的点击功能可能是这样的：

```
$( 'a.room-edit').click(function() {
    var roomID = $(this).attr('data-roomID');

    // do something spectacular
}); 
```

# android - 屏幕旋转后未添加 Android 片段

> ID：14782740
> 
> 赞同：1
> 
> 时间：2013-02-08T23:02:08.393
> 
> 标签：android, android-fragments

我使用没有任何布局的片段（它在后台下载文件）。我在第一次创建活动时添加它一次，假设它将在屏幕方向后再次附加，但事实并非如此！
创建活动：

```
if (savedInstanceState == null) {
    getSupportFragmentManager().beginTransaction()
            .add(new FragmentDownloadApp(), FragmentDownloadApp.TAG)
            .commit();
} else {
    if (savedInstanceState.containsKey(STATE_SELECTED_NAVIGATION_ITEM)) { 
```

片段 onActivityCreated：

```
@Override
public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);
    // this is really important in order to save the state across screen
    // configuration changes for example
    setRetainInstance(true);

    // ---- magic lines starting here -----
    // call this to re-connect with an existing
    // loader (after screen configuration changes for e.g!)
    LoaderManager lm = getLoaderManager();
    if (lm.getLoader(LOADER_DOWNLOAD_APP) != null) {
        lm.initLoader(LOADER_DOWNLOAD_APP, null, mDownLoader);
    }
    // ----- end magic lines -----
} 
```

和错误：

```
public void onPositiveClick() {
            FragmentDownloadApp fragment = (FragmentDownloadApp) getSupportFragmentManager()
                    .findFragmentByTag(FragmentDownloadApp.TAG);
            fragment.startDownload(mAppToDownload);
        } 
```

这里出现 NullPointerException！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:12:40.790

找到答案：

```
@Override
public void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState); // NEED THIS! 
```

# c# - 对事件的反应性订阅在一段时间内没有跟随不同的事件

> ID：14782742
> 
> 赞同：3
> 
> 时间：2013-02-08T23:02:16.847
> 
> 标签：c#, events, system.reactive

我试图弄清楚如何为在特定时间窗口内没有跟随不同事件的事件创建反应式订阅。

为了说明，这里有一个用例：

由两个事件触发的繁忙指示器。忙和不忙。它们可能会同时开火，但指示灯不应频繁闪烁。

当 NotBusy 触发时，应该没有指示器。当 Busy 触发且 NotBusy 在 5 秒内未触发时，它应该会显示。

有没有办法完全在 Reactive 中做到这一点而不添加外部状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T05:37:40.840

啊，我无法抗拒 - 你多久反击一次源材料的作者？*（见 Benjol 对问题的评论）* :)

这是我的尝试（LINQPad-ready）：

输出如下所示：

```
At 1/1/0001 12:00:00 AM +00:00, Busy Signal Indicator is now:OFF
Sending BUSY at 1/1/0001 12:00:00 AM +00:00
Sending NOTBUSY at 1/1/0001 12:00:02 AM +00:00

Sending BUSY at 1/1/0001 12:00:03 AM +00:00
Sending BUSY at 1/1/0001 12:00:06 AM +00:00
At 1/1/0001 12:00:08 AM +00:00, Busy Signal Indicator is now:ON
Sending NOTBUSY at 1/1/0001 12:00:09 AM +00:00
At 1/1/0001 12:00:09 AM +00:00, Busy Signal Indicator is now:OFF 
```

这是我们事件的基本定义：

```
enum EventType 
{ 
    Busy, 
    NotBusy 
}
class StreamEvent 
{ 
     public EventType Type {get; set;} 
     public StreamEvent(EventType type) { Type = type;}
} 
```

这是查询+测试代码：

```
void Main()
{
    // our simulated event stream
    var fakeSource = new System.Reactive.Subjects.Subject<StreamEvent>();

    // Let's use a scheduler we actually don't have to wait for
    var theTardis = new System.Reactive.Concurrency.HistoricalScheduler();

    var busySignal = fakeSource
        // Batch up events:
        .Window(
            // Starting batching on a busy signal
            fakeSource.Where(e => e.Type == EventType.Busy),
            // Stop batching on a not busy signal
            (open) => fakeSource.Where(e => e.Type == EventType.NotBusy)
                // but throw a timeout if we exceed 5 seconds per window
                .Timeout(TimeSpan.FromSeconds(5), theTardis))       
        // Unpack the windows
        .Switch()
        // Catch any timeout exception and inject a NULL into the stream        
        .Catch(fakeSource.StartWith((StreamEvent)null))
        // Bool-ify on "did a timeout happen?"
        .Select(e => e == null)
        // Start in an "unbusy" state
        .StartWith(false)
        // And only tell us about transitions
        .DistinctUntilChanged();    

    using(busySignal.Subscribe(signal => 
        Console.WriteLine("At {0}, Busy Signal Indicator is now:{1}",
            theTardis.Now,
            signal ? "ON" : "OFF")))
    {
        // should not generate a busy signal
        Console.WriteLine("Sending BUSY at {0}", theTardis.Now);
        fakeSource.OnNext(new StreamEvent(EventType.Busy));
        theTardis.AdvanceBy(TimeSpan.FromSeconds(2));
        Console.WriteLine("Sending NOTBUSY at {0}", theTardis.Now);
        fakeSource.OnNext(new StreamEvent(EventType.NotBusy));
        theTardis.AdvanceBy(TimeSpan.FromSeconds(1));
        Console.WriteLine();

        // should generate a busy signal
        Console.WriteLine("Sending BUSY at {0}", theTardis.Now);
        fakeSource.OnNext(new StreamEvent(EventType.Busy));
        theTardis.AdvanceBy(TimeSpan.FromSeconds(3));
        Console.WriteLine("Sending BUSY at {0}", theTardis.Now);
        fakeSource.OnNext(new StreamEvent(EventType.Busy));
        theTardis.AdvanceBy(TimeSpan.FromSeconds(3));

        // and this should clear it
        Console.WriteLine("Sending NOTBUSY at {0}", theTardis.Now);
        fakeSource.OnNext(new StreamEvent(EventType.NotBusy));      
        theTardis.AdvanceBy(TimeSpan.FromSeconds(1));
        Console.WriteLine();    
    }
} 
```

# spring - Spring部署到JBOSS 7中不加载休眠实体

> ID：14782745
> 
> 赞同：1
> 
> 时间：2013-02-08T23:02:21.687
> 
> 标签：spring, hibernate, jpa, jboss7.x, entitymanager

我有一个 Spring MVC 应用程序，它是使用使用休眠的 jpa 配置的 roo 创建的。它创建数据库并在部署到 STS 提供的 tomcat 服务器中正常工作。但是，当部署到 JBOSS 7.1.1 AS 中时，似乎找不到实体。我试过遵循[JBoss Spring Migration Guide](https://docs.jboss.org/author/display/AS71/Spring+applications+development+and+migration+guide)。我希望让 spring 成为实体管理器，同时仍然部署到 JBOSS，而对默认 spring tomcat 配置的配置更改最少。当我允许 JBOSS 成为实体管理器但希望比此方法所需的配置更改更少时，我已经能够让它工作。代码和日志是我从各种网站上找到的，描述了他们如何克服这个问题，但它似乎不适用于我的部署。

META-INF/spring/applicationContext-jpa.xml

```
<bean id="dataSource" class="com.lmco.lmis.setup.EncryptedBasicDataSource"
    destroy-method="close">
    <!-- <bean class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close" 
        id="dataSource"> -->
    <property name="driverClassName" value="${database.driverClassName}" />
    <property name="url" value="${database.url}" />
    <property name="username" value="${database.username}" />
    <property name="password" value="${database.password}" />
    <property name="testOnBorrow" value="true" />
    <property name="testOnReturn" value="true" />
    <property name="testWhileIdle" value="true" />
    <property name="timeBetweenEvictionRunsMillis" value="1800000" />
    <property name="numTestsPerEvictionRun" value="3" />
    <property name="minEvictableIdleTimeMillis" value="1800000" />
</bean>
<bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
    <property name="entityManagerFactory" ref="entityManagerFactory" />
</bean>

<bean id="entityManagerFactory"
    class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="jpaVendorAdapter">
        <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter" />
    </property>
    <property name="dataSource" ref="dataSource" />
    <property name="persistenceXmlLocation" value="classpath:META-INF/jpa-persistence.xml" />
</bean> 
```

META-INF/jpa-persistence.xml

```
<persistence-unit name="jpaHibernatePersistenceUnit"
    transaction-type="RESOURCE_LOCAL">
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <properties>
        <property name="jboss.as.jpa.managed" value="false" />
        <property name="hibernate.dialect" value="org.hibernate.dialect.SQLServerDialect" />
        <!-- value="create" to build a new database on each run; value="update" 
            to modify an existing database; value="create-drop" means the same as "create" 
            but also drops tables when Hibernate closes; value="validate" makes no changes 
            to the database -->
        <property name="hibernate.hbm2ddl.auto" value="create" />
        <property name="hibernate.ejb.naming_strategy" value="org.hibernate.cfg.ImprovedNamingStrategy" />
        <property name="hibernate.connection.charSet" value="UTF-8" />
        <!-- Uncomment the following two properties for JBoss only -->
        <property name="hibernate.validator.apply_to_ddl" value="false" />
        <property name="hibernate.validator.autoregister_listeners"
            value="false" />
    </properties>
</persistence-unit> 
```

META-INF/jboss-deployment-structure.xml

```
<jboss-deployment-structure xmlns="urn:jboss:deployment-structure:1.0">
    <deployment>
        <exclusions>
            <module name="org.hibernate" />
        </exclusions>
    </deployment>
</jboss-deployment-structure> 
```

JBOSS 服务器.log

```
17:49:54,841 INFO  [org.springframework.web.context.ContextLoader] (MSC service thread 1-2) Root WebApplicationContext: initialization started
17:49:54,898 INFO  [org.springframework.web.context.support.XmlWebApplicationContext] (MSC service thread 1-2) Refreshing Root WebApplicationContext: startup date [Fri Feb 08 17:49:54 EST 2013]; root of context hierarchy
17:49:55,027 INFO  [org.springframework.beans.factory.xml.XmlBeanDefinitionReader] (MSC service thread 1-2) Loading XML bean definitions from "/C:/jboss-as-7.1.1.Final/bin/content/lmis.war/WEB-INF/classes/META-INF/spring/applicationContext-jpa.xml"
17:49:56,011 INFO  [org.springframework.beans.factory.xml.XmlBeanDefinitionReader] (MSC service thread 1-2) Loading XML bean definitions from "/C:/jboss-as-7.1.1.Final/bin/content/lmis.war/WEB-INF/classes/META-INF/spring/applicationContext-security.xml"
17:49:56,174 INFO  [org.springframework.security.core.SpringSecurityCoreVersion] (MSC service thread 1-2) You are running with Spring Security Core 3.1.0.RELEASE
17:49:56,177 INFO  [org.springframework.security.config.SecurityNamespaceHandler] (MSC service thread 1-2) Spring Security 'config' module version is 3.1.0.RELEASE
17:49:56,219 INFO  [org.springframework.security.config.http.FilterInvocationSecurityMetadataSourceParser] (MSC service thread 1-2) Creating access control expression attribute 'hasRole('ROLE_ADMIN')' for /choices/**
17:49:56,222 INFO  [org.springframework.security.config.http.FilterInvocationSecurityMetadataSourceParser] (MSC service thread 1-2) Creating access control expression attribute 'isAuthenticated()' for /member/**
17:49:56,224 INFO  [org.springframework.security.config.http.FilterInvocationSecurityMetadataSourceParser] (MSC service thread 1-2) Creating access control expression attribute 'permitAll' for /resources/**
17:49:56,226 INFO  [org.springframework.security.config.http.FilterInvocationSecurityMetadataSourceParser] (MSC service thread 1-2) Creating access control expression attribute 'permitAll' for /**
17:49:56,245 INFO  [org.springframework.security.config.http.HttpSecurityBeanDefinitionParser] (MSC service thread 1-2) Checking sorted filter chain: [Root bean: class [org.springframework.security.web.context.SecurityContextPersistenceFilter]; scope=; abstract=false; lazyInit=false; autowireMode=0; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null, order = 300, Root bean: class [org.springframework.security.web.authentication.logout.LogoutFilter]; scope=; abstract=false; lazyInit=false; autowireMode=0; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null, order = 400, <org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter#0>, order = 800, Root bean: class [org.springframework.security.web.authentication.www.BasicAuthenticationFilter]; scope=; abstract=false; lazyInit=false; autowireMode=0; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null, order = 1200, Root bean: class [org.springframework.security.web.savedrequest.RequestCacheAwareFilter]; scope=; abstract=false; lazyInit=false; autowireMode=0; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null, order = 1300, Root bean: class [org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter]; scope=; abstract=false; lazyInit=false; autowireMode=0; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null, order = 1400, Root bean: class [org.springframework.security.web.authentication.AnonymousAuthenticationFilter]; scope=; abstract=false; lazyInit=false; autowireMode=0; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null, order = 1700, Root bean: class [org.springframework.security.web.session.SessionManagementFilter]; scope=; abstract=false; lazyInit=false; autowireMode=0; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null, order = 1800, Root bean: class [org.springframework.security.web.access.ExceptionTranslationFilter]; scope=; abstract=false; lazyInit=false; autowireMode=0; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null, order = 1900, <org.springframework.security.web.access.intercept.FilterSecurityInterceptor#0>, order = 2000]
17:49:56,275 INFO  [org.springframework.beans.factory.xml.XmlBeanDefinitionReader] (MSC service thread 1-2) Loading XML bean definitions from "/C:/jboss-as-7.1.1.Final/bin/content/lmis.war/WEB-INF/classes/META-INF/spring/applicationContext.xml"
17:49:56,308 INFO  [org.springframework.context.annotation.ClassPathBeanDefinitionScanner] (MSC service thread 1-2) JSR-250 'javax.annotation.ManagedBean' found and supported for component scanning
17:49:56,311 INFO  [org.springframework.context.annotation.ClassPathBeanDefinitionScanner] (MSC service thread 1-2) JSR-330 'javax.inject.Named' annotation found and supported for component scanning
17:49:57,479 INFO  [org.springframework.context.support.PropertySourcesPlaceholderConfigurer] (MSC service thread 1-2) Loading properties file from "/C:/jboss-as-7.1.1.Final/bin/content/lmis.war/WEB-INF/classes/META-INF/spring/database.properties"
17:49:57,496 INFO  [org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor] (MSC service thread 1-2) JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
17:49:57,603 INFO  [org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean] (MSC service thread 1-2) Building JPA container EntityManagerFactory for persistence unit 'jpaHibernatePersistenceUnit'
17:49:57,775 INFO  [org.hibernate.annotations.common.Version] (MSC service thread 1-2) HCANN000001: Hibernate Commons Annotations {4.0.1.Final}
17:49:57,780 INFO  [org.hibernate.Version] (MSC service thread 1-2) HHH000412: Hibernate Core {4.1.8.Final}
17:49:57,784 INFO  [org.hibernate.cfg.Environment] (MSC service thread 1-2) HHH000206: hibernate.properties not found
17:49:57,786 INFO  [org.hibernate.cfg.Environment] (MSC service thread 1-2) HHH000021: Bytecode provider name : javassist
17:49:57,804 INFO  [org.hibernate.ejb.Ejb3Configuration] (MSC service thread 1-2) HHH000204: Processing PersistenceUnitInfo [
    name: jpaHibernatePersistenceUnit
    ...]
17:49:57,913 INFO  [org.hibernate.service.jdbc.connections.internal.ConnectionProviderInitiator] (MSC service thread 1-2) HHH000130: Instantiating explicit connection provider: org.hibernate.ejb.connection.InjectedDataSourceConnectionProvider
17:49:58,383 INFO  [org.hibernate.dialect.Dialect] (MSC service thread 1-2) HHH000400: Using dialect: org.hibernate.dialect.SQLServerDialect
17:49:58,393 INFO  [org.hibernate.engine.jdbc.internal.LobCreatorBuilder] (MSC service thread 1-2) HHH000423: Disabling contextual LOB creation as JDBC driver reported JDBC version [3] less than 4
17:49:58,403 INFO  [org.hibernate.engine.transaction.internal.TransactionFactoryInitiator] (MSC service thread 1-2) HHH000268: Transaction strategy: org.hibernate.engine.transaction.internal.jdbc.JdbcTransactionFactory
17:49:58,407 INFO  [org.hibernate.hql.internal.ast.ASTQueryTranslatorFactory] (MSC service thread 1-2) HHH000397: Using ASTQueryTranslatorFactory
17:49:58,463 INFO  [org.hibernate.validator.util.Version] (MSC service thread 1-2) Hibernate Validator 4.2.0.Final
17:49:58,507 INFO  [org.hibernate.tool.hbm2ddl.SchemaExport] (MSC service thread 1-2) HHH000227: Running hbm2ddl schema export
17:49:58,511 INFO  [org.hibernate.tool.hbm2ddl.SchemaExport] (MSC service thread 1-2) HHH000230: Schema export complete
17:49:58,543 INFO  [org.springframework.beans.factory.support.DefaultListableBeanFactory] (MSC service thread 1-2) Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@14f0e813: defining beans [dataSource,transactionManager,entityManagerFactory,org.springframework.security.filterChains,org.springframework.security.filterChainProxy,org.springframework.security.web.PortMapperImpl#0,org.springframework.security.config.authentication.AuthenticationManagerFactoryBean#0,org.springframework.security.authentication.ProviderManager#0,org.springframework.security.web.context.HttpSessionSecurityContextRepository#0,org.springframework.security.web.authentication.session.SessionFixationProtectionStrategy#0,org.springframework.security.web.savedrequest.HttpSessionRequestCache#0,org.springframework.security.web.access.expression.DefaultWebSecurityExpressionHandler#0,org.springframework.security.access.vote.AffirmativeBased#0,org.springframework.security.web.access.intercept.FilterSecurityInterceptor#0,org.springframework.security.web.access.DefaultWebInvocationPrivilegeEvaluator#0,org.springframework.security.authentication.AnonymousAuthenticationProvider#0,org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint#0,org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter#0,org.springframework.security.userDetailsServiceFactory,org.springframework.security.web.DefaultSecurityFilterChain#0,org.springframework.security.provisioning.InMemoryUserDetailsManager#0,org.springframework.security.authentication.dao.DaoAuthenticationProvider#0,org.springframework.security.authentication.DefaultAuthenticationEventPublisher#0,org.springframework.security.authenticationManager,org.springframework.context.support.PropertySourcesPlaceholderConfigurer#0,org.springframework.context.config.internalBeanConfigurerAspect,org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,org.springframework.context.annotation.internalPersistenceAnnotationProcessor,org.springframework.transaction.config.internalTransactionAspect,org.springframework.context.annotation.ConfigurationClassPostProcessor.importAwareProcessor]; root of factory hierarchy
17:49:58,825 INFO  [org.springframework.security.web.DefaultSecurityFilterChain] (MSC service thread 1-2) Creating filter chain: org.springframework.security.web.util.AnyRequestMatcher@1, [org.springframework.security.web.context.SecurityContextPersistenceFilter@2f7d54e1, org.springframework.security.web.authentication.logout.LogoutFilter@4d4f9822, org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter@248d07d5, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@26fd43b2, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@3d676f1d, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@51aff869, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@77dddf64, org.springframework.security.web.session.SessionManagementFilter@7755bb7, org.springframework.security.web.access.ExceptionTranslationFilter@29d84f34, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@3837f462]
17:49:58,858 INFO  [org.springframework.security.config.http.DefaultFilterChainValidator] (MSC service thread 1-2) Checking whether login URL '/login' is accessible with your configuration
17:49:58,999 INFO  [org.springframework.web.context.ContextLoader] (MSC service thread 1-2) Root WebApplicationContext: initialization completed in 4156 ms
17:49:59,334 INFO  [org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/lmis]] (MSC service thread 1-2) Initializing Spring FrameworkServlet 'lmis'
17:49:59,337 INFO  [org.springframework.web.servlet.DispatcherServlet] (MSC service thread 1-2) FrameworkServlet 'lmis': initialization started
17:49:59,342 INFO  [org.springframework.web.context.support.XmlWebApplicationContext] (MSC service thread 1-2) Refreshing WebApplicationContext for namespace 'lmis-servlet': startup date [Fri Feb 08 17:49:59 EST 2013]; parent: Root WebApplicationContext
17:49:59,347 INFO  [org.springframework.beans.factory.xml.XmlBeanDefinitionReader] (MSC service thread 1-2) Loading XML bean definitions from ServletContext resource [/WEB-INF/spring/webmvc-config.xml]
17:49:59,930 INFO  [org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor] (MSC service thread 1-2) JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
17:49:59,942 INFO  [org.springframework.beans.factory.support.DefaultListableBeanFactory] (MSC service thread 1-2) Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@62f314a8: defining beans [assignedCertificationController,certificationController,certificationSourceController,courseController,courseSeriesController,courseSeriesTemplateController,courseTemplateController,employeeController,jobCertificationGroupController,manualCertificationGroupController,qualificationController,qualificationLogController,titleCertificationGroupController,org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,org.springframework.context.annotation.internalPersistenceAnnotationProcessor,mvcContentNegotiationManager,org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping#0,org.springframework.validation.beanvalidation.LocalValidatorFactoryBean#0,org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter#0,org.springframework.web.servlet.handler.MappedInterceptor#0,org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver#0,org.springframework.web.servlet.mvc.annotation.ResponseStatusExceptionResolver#0,org.springframework.web.servlet.mvc.support.DefaultHandlerExceptionResolver#0,org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping,org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter,org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter,org.springframework.web.servlet.resource.ResourceHttpRequestHandler#0,org.springframework.web.servlet.handler.SimpleUrlHandlerMapping#0,org.springframework.web.servlet.resource.DefaultServletHttpRequestHandler#0,org.springframework.web.servlet.handler.SimpleUrlHandlerMapping#1,org.springframework.web.servlet.handler.MappedInterceptor#1,org.springframework.web.servlet.handler.MappedInterceptor#2,org.springframework.web.servlet.config.viewControllerHandlerMapping,messageSource,localeResolver,themeSource,themeResolver,org.springframework.web.servlet.handler.SimpleMappingExceptionResolver#0,multipartResolver,tilesViewResolver,tilesConfigurer,applicationConversionService,org.springframework.context.annotation.ConfigurationClassPostProcessor.importAwareProcessor]; parent: org.springframework.beans.factory.support.DefaultListableBeanFactory@14f0e813
17:50:00,147 INFO  [org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping] (MSC service thread 1-2) Mapped "{[/assignedcertifications],methods=[],params=[],headers=[],consumes=[],produces=[text/html],custom=[]}" onto public java.lang.String com.lmco.lmis.web.AssignedCertificationController.list(java.lang.Integer,java.lang.Integer,org.springframework.ui.Model) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-29T15:38:05.543

*实际上，在jboss-deployment-structure.xml*和*jpaVendorAdapter*属性中没有必要。但是您应该在持久性单元中添加实体类列表。描述和示例在[JBoss 文档中](http://docs.jboss.org/ejb3/app-server/reference/build/reference/en/html/entityconfig.html)

At-leaset，这对我有用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-28T09:16:18.843

在 JBoss 中运行时，最高版本 4.2 的独立 Hibernate 无法扫描实体。

负责扫描的类`org.hibernate.ejb.packaging.JarVisitorFactory`不处理 JBoss VFS 协议。

一种可能的解决方法是使用 Spring (>3.1.x) 进行扫描。类`org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean`有一个属性`packagesToScan`，可以设置为类似`com.company.**.*`.

注意：Hibernate 4.3 重新设计了新包中的扫描，`org.hibernate.jpa.boot.scan`这个版本我没试过。

# android - 自动检查违反 android:minSdkVersion

> ID：14782749
> 
> 赞同：6
> 
> 时间：2013-02-08T23:02:41.933
> 
> 标签：android, android-manifest

我正在开发一个 android 应用程序，并担心我们引入的代码使用 API 级别的功能晚于`minSdkVersion`.

我想知道是否有任何方法可以自动检测其中一些违规行为。

在此应用程序的 `AndroidManifest.xml`文件中，它指定：

```
<uses-sdk android:minSdkVersion="8"
          android:targetSdkVersion="17" /> 
```

ndk-build 似乎在给我一个警告（或者这个警告是出于其他原因？）：

```
Android NDK: Found stable platform levels: 14 3 4 5 8 9
Android NDK: Found max platform level: 14
Android NDK: Parsing ./jni/Application.mk
Android NDK:   Found APP_PLATFORM=android-17 in ./project.properties
Android NDK:   Adjusting APP_PLATFORM android-17 to android-14 and enabling -fPIE
/android-ndk/build/core/add-application.mk:128: Android NDK: WARNING: APP_PLATFORM android-14 is larger than android:minSdkVersion 8 in ./AndroidManifest.xml 
```

虽然我意识到由于运行时调度，任何工具都不能 100% 准确，除了：

*   对源代码进行全面审核，或
*   在运行 minSdkVersion 的设备上对所有代码路径进行完整测试（在本例中为 android-8 = 2.2 = Froyo）

...是否有类似 lint 的工具、构建设置更改或其他任何我可以用来识别至少最明显/公然违规的东西？

如果不存在这样的东西，是否有一个全面的 API 列表或可以使审计更容易的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-11T18:11:02.870

看起来 android`lint`工具做了一些检查（感谢上面评论中的@CommonsWare）：

```
$ which lint
/android-sdk-macosx/tools/lint

$ lint myProjectDir --check NewApi

Scanning .: .....

No issues found. 
```

看来您也可以`ant lint`从 SDK Tools Revision 21 开始运行它。

看来，Lint 有各种不错的输出格式！`--xml`通过等与 Jenkins 集成

* * *

此外，在 中`ant.properties`，您可以设置类似这样的内容，以通过以下方式执行一些类似 lint 的检查`javac`：

```
java.compilerargs=-Xlint:all 
```

目前尚不清楚 javac 是否会报告像 lint --check NewApi 这样的事件，但它`[deprecation]`至少会报告条目。（如果您找到 javac 报告内容的参考，请发表评论。）

* * *

对于后代，这是 lint 的 NewApi 检查器的描述：

```
$ lint --show NewApi
NewApi
------
Summary: Finds API accesses to APIs that are not supported in all targeted API
versions

Priority: 6 / 10
Severity: Error
Category: Correctness

This check scans through all the Android API calls in the application and
warns about any calls that are not available on all versions targeted by this
application (according to its minimum SDK attribute in the manifest).

If you really want to use this API and don't need to support older devices
just set the minSdkVersion in your AndroidManifest.xml file.
If your code is deliberately accessing newer APIs, and you have ensured (e.g.
with conditional execution) that this code will only ever be called on a
supported platform, then you can annotate your class or method with the
@TargetApi annotation specifying the local minimum SDK to apply, such as
@TargetApi(11), such that this check considers 11 rather than your manifest
file's minimum SDK as the required API level. 
```

这里有一些有用的链接`lint`：

*   [http://developer.android.com/tools/help/lint.html](http://developer.android.com/tools/help/lint.html)
*   [http://developer.android.com/tools/debugging/improving-w-lint.html](http://developer.android.com/tools/debugging/improving-w-lint.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T01:47:54.780

我找到的最简单的解决方案是将此行添加到 Application.mk 文件

**覆盖 APP_MIN_PLATFORM_LEVEL=99**

# php - 在 PHP 中将 PDF 转换为 HTML？

> ID：14782751
> 
> 赞同：14
> 
> 时间：2013-02-08T23:02:46.147
> 
> 标签：php

我希望能够通过 PHP 将 PDF 文件转换为 HTML 文件，但遇到了一些麻烦。

我找到了一种使用[Saaspose](http://web.archive.org/web/20130302034024/http://saaspose.com/)执行此操作的基本方法，它可以让您将 PDF 转换为 HTML 文件。但是，这样做存在一些问题，例如使用 SVG、图像、定位、字体等。

我所需要的只是能够从 PHP 文件和与之关联的任何图像中获取文本，然后以线性格式显示它，而不是使用绝对定位进行格式化。

我的意思是，如果 PDF 看起来像这样：

![在此处输入图像描述](../Images/4e54bf6c706eebe856d1072ca7f940da.png)

我想将其转换为单列设计 HTML 文件。如果有图像，我也希望它们返回。

这在PHP中可能吗？我知道我可以简单地从 PDF 文件中获取文本，但是也可以获取图像呢？

另一个问题是我希望所有内容都内联，因为它在单个文件中提供给客户端。目前，我可以通过一些代码通过我的设置来做到这一点：

```
for ($i = 0; $i < $object_number; $i++) {
                $object = $html->find("object")->find("embed")->eq($i);
                $embed = file_get_contents("Output/OutputHtml/" . $object->attr("src"));
                array_push($converted_obj, $embed);
                array_push($original_obj, $object);
            }

            for ($i = 0; $i < $object_number; $i++){
                pq($original_obj[$i])->replaceWith($converted_obj[$i]);
            } 
```

它抓取所有`SVG`文件并内联显示它们。图像会更容易，因为我可以使用`base64`.

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-12-03T09:59:39.677

1）下载.exe文件并解压到一个文件夹：http: **[//sourceforge.net/projects/pdftohtml/](http://sourceforge.net/projects/pdftohtml/)**

2）创建一个 .php 文件，并放置此代码（假设 pdftohtml.exe 位于该文件夹内，源代码 sample.pdf 也是）：

```
<?php
$source_pdf="sample.pdf";
$output_folder="MyFolder";

    if (!file_exists($output_folder)) { mkdir($output_folder, 0777, true);}
$a= passthru("pdftohtml $source_pdf $output_folder/new_file_name",$b);
var_dump($a);
?> 
```

3）输入**MyFolder**，你会看到转换后的文件（取决于页数..）

ps 我不知道，但也存在许多商业或试用 api。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-04-18T21:17:14.340

[**使用Xpdf**](http://www.xpdfreader.com/download.html)的跨平台解决方案：

下载适当的**Xpdf 工具**包并将其解压缩到脚本目录中的子目录中。假设它被称为“/xpdftools”。

将这样的代码添加到您的 php 脚本中：

```
$pdf_file = 'sample.pdf';
$html_dir = 'htmldir';
$cmd = "xpdftools/bin32/pdftohtml $pdf_file $html_dir";

exec($cmd, $out, $ret);
echo "Exit code: $ret"; 
```

脚本执行成功后`htmldir`目录中会包含转换后的html文件（每个页面在一个单独的文件中）。

Xpdf 工具使用以下退出代码：

*   `0`- 没有错误。
*   `1`- 打开 PDF 文件时出错。
*   `2`- 打开输出文件时出错。
*   `3`- 与 PDF 权限相关的错误。
*   `99`- 其他错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-14T10:10:59.713

您实际上要做的是重排 PDF 文件。我不确定这是否存在，并且充其量很难做到。

可以编写一些代码来执行特定文件所需的操作，但对于一般情况，我认为这样做是不可能的。

我在这里写了一篇文章，解释了为什么我认为重排 PDF 存在缺陷：[http ://www.planetpdf.com/enterprise/article.asp?ContentID=PDF_Reflow_in_Microsoft_Word_2012_Is_it_any_good](http://www.planetpdf.com/enterprise/article.asp?ContentID=PDF_Reflow_in_Microsoft_Word_2012_Is_it_any_good)

特别令人感兴趣的是“让我们用报纸故事来说明问题”开头的段落。

您可能想了解 IDRsolutions（为了提高透明度，我工作的地方！）必须提供什么。

我们目前正在将我们的 PDF 到 HTML5 和 PDF 转换软件放在云端：[http ://www.idrsolutions.com/cloud-pdf-converter/](http://www.idrsolutions.com/cloud-pdf-converter/)

JPedal 的 PDF 文本提取和 PDF 图像提取功能可能更适合您。如果 PDF 转 HTML5 顺利的话，我们很可能也会考虑将其放入云中。

文本提取：[http ://www.idrsolutions.com/pdf-to-text-conversion/](http://www.idrsolutions.com/pdf-to-text-conversion/)

图像提取：[http ://www.idrsolutions.com/extract-images-from-pdf/](http://www.idrsolutions.com/extract-images-from-pdf/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-17T12:53:07.253

您希望从您发布的图形中实现的实际上是图形的 OCR 转换。 [http://www.phpclasses.org/package/2874-PHP-Recognize-text-objects-in-graphical-images.html](http://www.phpclasses.org/package/2874-PHP-Recognize-text-objects-in-graphical-images.html)

# c# - 如何在 RSS 提要中获取非标准项目？

> ID：14782755
> 
> 赞同：0
> 
> 时间：2013-02-08T23:02:56.427
> 
> 标签：c#, asp.net, rss

我只是想在这里解析一个 RSS 提要，我可以用 XmlReader 做到这一点

```
String blogrss = @"http://belvederecollegeac.wordpress.com/feed/";

             using (System.Xml.XmlReader reader = System.Xml.XmlReader.Create(blogrss))
    {
        System.ServiceModel.Syndication.SyndicationFeed feed = System.ServiceModel.Syndication.SyndicationFeed.Load(reader);

        foreach (var v in feed.Items)
        {
            string title = v.Title.Text.Replace("•", "  ---  ");
            string url = v.Id; 

            string link = "<a href=" + url + ">" + title + "</a>"; 

            Response.Write(link + "<br><br>");

        } 
```

但我找不到 xml 阅读器如何给我描述节点？

我可以得到 v.Tite 和 v.Id （用于链接），但 RSS 包含一个描述节点，例如这个

```
<description>
<![CDATA[
Photos from the J.C.T. game v Kilkenny College can be viewed at the College website gallery page. A highlights video from the S.C.T. game v Terenure can also be viewed on the video gallery page.<img alt="" border="0" src="http://stats.wordpress.com/b.gif?host=belvederecollegeac.wordpress.com&#038;blog=41877065&#038;post=92&#038;subd=belvederecollegeac&#038;ref=&#038;feed=1" width="1" height="1" />
]]>
</description> 
```

我的`feed.Items`收藏似乎没有附加对象，称为描述？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:33:51.257

没有描述属性。使用摘要属性。它在以下文档中进行了描述

[http://msdn.microsoft.com/en-us/library/system.servicemodel.syndication.syndicationitem.summary.aspx](http://msdn.microsoft.com/en-us/library/system.servicemodel.syndication.syndicationitem.summary.aspx)

“当序列化为 Atom 1.0 时，此属性将写入摘要元素。当序列化为 RSS 2.0 时，此属性将写入描述元素。”

# r - vegan::vegdist: double(N * (N - 1)/2) 中的错误：指定的向量大小太大

> ID：14782758
> 
> 赞同：0
> 
> 时间：2013-02-08T23:03:02.883
> 
> 标签：r, vegan

我的功能有一些问题`vegdist`。我想用jaccard计算一个距离矩阵。我有二进制数据。

问题是我有一个 138037 行（站点）和 89 列（物种）的矩阵。我的脚本是：

```
library("vegan")
memory.limit(size = 100000) # it gives  1 Tera  from HDD in case ram memory is over
DF=as.data.frame(MODELOS)
DF=na.omit(DF)
DISTAN=vegdist(DF[,2:ncol(DF)],"jaccard") 
```

或更可重复地：

```
nsites <- 138037
nspp <- 89
DF <- matrix(0,nrow=nsites,ncol=nspp)
DISTAN=vegdist(DF,"jaccard") 
```

它几乎立即产生错误：

```
Error in double(N * (N - 1)/2) : vector size specified is too large 
```

我认为这是一个内存错误，但我不知道为什么如果我有一台 32GB 内存和 1 Tera 硬盘的电脑。

我还尝试使用`dist`包代理中的函数做一个 dist 矩阵：

```
library(proxy)
vector=dist(DF, method = "Jaccard") 
```

它开始运行，但是当它达到 10 GB 的内存时，一个窗口宣布 R 犯了一个错误，它将关闭，所以它关闭并开始一个新的部分。

我真的不知道发生了什么，更不知道如何解决这个问题，有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:47:34.950

`N <- 138037; log10(N*(N-1)/2)`表明您正在尝试计算一个`dist`具有 10^9.98 = 几乎 10^10（100 亿）个不同元素的对象。R 的发布版本只能处理少于 2^31-1 个元素 ( `log10(2^31-1)=9.3`) 的对象，而不管可用内存量如何。[这个限制在R的开发版本中](http://stat.ethz.ch/R-manual/R-devel/doc/html/NEWS.html)放宽了（搜索“LONG VECTORS”）；另请参阅[R 中向量的最大长度](https://stackoverflow.com/questions/10640836/max-length-for-a-vector-in-r)。不过，更大的问题是：您实际上打算**做什么**具有 100 亿个不同元素的距离矩阵？？？如果您对您正在尝试做的事情的背景进行更多解释，您可能会得到一些更有用的答案（即不仅仅是“为什么会发生这种情况？”而是“我能做些什么呢？”）。没有更多上下文，我只能说“尝试切换到 R 的开发版本，看看是否有帮助”（但可能没有；R 的所有方面都不支持长向量，尤其是在使用底层 C 的代码中或 FORTRAN 来源）。

我不确定为什么会`proxy::dist`给出不同的错误行为。

# mysql - 获取 Rails 样本记录的最有效方法

> ID：14782759
> 
> 赞同：0
> 
> 时间：2013-02-08T23:03:04.617
> 
> 标签：mysql, ruby-on-rails

我的数据库中有大约 200 万条记录，我需要经常获取随机的 x 记录集。当我的数据库包含大约 50 条记录时，我使用了：

```
 Product.all.sample(5) 
```

然而，这对于我的记录数量来说是非常昂贵的。

给定我的数据库大小，如何有效地找到一小部分记录样本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:20:13.040

一种选择是获得一组更小的产品。您现在所做的事情代价高昂，因为您首先获取所有产品，然后随机选择其中的 5 个。

```
Product.limit(100).sample 
```

这并不理想，因为您将返回相同的 100 个产品集。

相反，您可以一起删除`.sample`所有内容，只需向 ActiveRecord 索取一组随机的 5 个产品

```
Product.order("RAND()").limit(5) 
```

虽然您已将性能问题移出 Rails，但您已将其移至 MySQL，其中“RAND()”对于大型数据集[仍然相当慢](http://forums.mysql.com/read.php?132,185266,194715)。

[这个问题](https://stackoverflow.com/questions/5342270/rails-3-get-random-record)有一堆与您的问题相关的答案，应该证明是有用的。

# python - python - 从最后一行读取 csv 文件

> ID：14782763
> 
> 赞同：1
> 
> 时间：2013-02-08T23:03:23.230
> 
> 标签：python, csv

我搜索了很多，但我找不到从特定行号的 csv 文件中读取数据的方法。

csv 文件会即时更新。更准确地说，定界符是制表符空间，因此，在时间 t1：

```
1 2 3
5 6 7
8 9 10
11 12 13
14 15 16 
```

在时间 t2 它是

```
1 2 3
5 6 7
8 9 10
11 12 13
14 15 16
17 18 19 
```

我有一个集合（双端队列），我想在其中将来自 coloumn0 的数据附加到 csv 文件中。

目前我编写的代码能够做到这一点：在时间 0：

```
[deque([0, 0, 0, 0, 0], maxlen=5)] 
```

在时间 1：

```
[deque(['1', '5', '8', '11', '14'])] 
```

在时间 2：

```
[deque(['5', '8', '11', '14','17'])] 
```

我编写的代码正在以我想要的格式读取它。

```
Question: 
```

但是当我在某个点'x'再次重新打开文件时。它应该从

```
[deque(['8', '11', '14','17','x'])] 
```

并不是

```
[deque(['1', '5', '8', '11', '14'])] 
```

我可以阅读一行并跳转到下一个文件吗？有图书馆可以让我这样做吗？

我清楚了吗？还是我错过了提供一些信息？

通过接受 kurtis 的输入来更新这个问题的答案（所有学分都归功于他）：

```
perf_his = []

for a in range(len(filename)):
 perf_his += [deque([0]*5,maxlen=5)]
for a in range(len(filename)):
 lines = open(filename[a]).readlines()[-NUM_LINES:]
 mydata = [line.split()[0] for line in lines]
 for i in range(0, len(mydata)):
  perf_his[a].append(mydata[i])
   print perf_his 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T01:58:56.740

你真的想向后读取文件吗？从您发布的内容来看，您似乎只想处理最后 5 行 - 否则您将在 t2 代替 deque(['5', '8', '11', '14','17'])有双端队列（['17', '14', '11', '8', '5']）。

假设你真正想做的只是处理最后 5 行，你可以做这样的事情——

```
from collections import deque

NUM_LINES=5 #The number of lines to process.  Should equal the deque maxlen    

lines = open("myfile.csv").readlines()[-NUM_LINES:] #Assumes the file can fit into memory
mydata = [line.split()[0] for line in lines]
d = deque(mydata, maxlen=NUM_LINES)
print d 
```

# php - MySQL 语法错误（与 PHP 一起使用）

> ID：14782773
> 
> 赞同：1
> 
> 时间：2013-02-08T23:04:35.117
> 
> 标签：php, mysql

我在以下代码中遇到 MySQL 语法错误：

```
$addcompany = mysql_query("INSERT INTO company (method, category, email, password,   
companyname, phone, address, state, zip, ratingcount, ratingscore, usage, date)
VALUES ('$method','$category','$email','$temp_encrypted_password',
'$companyname','$phone','$address','$state','$zip','0','0','0',CURDATE()) ")
or die(mysql_error()); 
```

所以声明死了。MySQL错误告诉我：

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL 
server version for the right syntax to use near 'usage, date) VALUES 
('referral','referral','email@gmail.com','d90ccafeea7983' at line 1 
```

我检查了我的表，所有列名都是正确的，并且似乎与我尝试插入的内容与允许输入到列中的内容没有任何冲突。

所以在这一点上我很恼火，因为我无法弄清楚什么一定是一个简单的错误。很恼火，希望这里有人能快速指出我的权利。

谢谢你的时间

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T23:06:28.073

`usage`是[保留字](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)，必须使用反引号进行转义。

```
... ratingscore, `usage`, date) ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T23:09:12.197

尝试在你的字段名周围加上反引号：`fieldname1`，`fieldname2`。这可以防止 mysql 关键字被视为保留关键字。

此外，您应该过滤您的用户输入。但这与您的问题无关。只是安全提示。;-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T23:07:52.440

试试这个

```
(method, category, email, password,   
companyname, phone, address, state, zip, ratingcount, ratingscore, \usage\, date) 
```

你不能`'usage'`直接使用它作为它的保留字

# c++ - 为什么多重继承具有不同签名的方法不明确？

> ID：14782774
> 
> 赞同：2
> 
> 时间：2013-02-08T23:04:45.397
> 
> 标签：c++, multiple-inheritance, ambiguous

如果我从不同的基类继承具有相同名称但签名不同的函数，则尝试调用该函数会生成一个错误，声称该调用不明确。单个基类中的相同函数不会产生错误。为什么是这样？

第一种情况， http: [//ideone.com/calH4Q](http://ideone.com/calH4Q)

```
#include <iostream>
using namespace std;

struct Base1
{
    void Foo(double param)
    {
        cout << "Base1::Foo(double)" << endl;
    }
};

struct Base2
{
    void Foo(int param)
    {
        cout << "Base2::Foo(int)" << endl;
    }
};

struct Derived : public Base1, public Base2
{
};

int main(int argc, char **argv)
{
    Derived d;
    d.Foo(1.2);
    return 1;
}

prog.cpp: In function ‘int main(int, char**)’:
prog.cpp:27:7: error: request for member ‘Foo’ is ambiguous
prog.cpp:14:10: error: candidates are: void Base2::Foo(int)
prog.cpp:6:10: error:                 void Base1::Foo(double) 
```

第二种情况，没有错误， http: [//ideone.com/mQ3J7A](http://ideone.com/mQ3J7A)

```
#include <iostream>
using namespace std;

struct Base
{
    void Foo(double param)
    {
        cout << "Base::Foo(double)" << endl;
    }
    void Foo(int param)
    {
        cout << "Base::Foo(int)" << endl;
    }
};

struct Derived : public Base
{
};

int main(int argc, char **argv)
{
    Derived d;
    d.Foo(1.2);
    return 1;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-08T23:07:09.403

重载发生在**同一**范围内定义的名称之间。当多个基定义相同的名称时，定义在不同的范围内，因此它们不会重载。如果向其中添加两个 using 声明，`Derived`则可以将两个名称拉入`Derived`其中，然后它们将重载。

# c# - 在 Windows 8/RT 应用程序中处理位图

> ID：14782775
> 
> 赞同：2
> 
> 时间：2013-02-08T23:04:54.320
> 
> 标签：c#, image-processing, windows-8, windows-rt

我之前创建了一个用于处理图像的 C# 控制台应用程序。现在我想将它移植到 Windows 8/RT 应用程序中。不幸的是，我似乎无法利用以下软件包：

```
using System.Drawing;
using System.Drawing.Drawing2D;
using System.Drawing.Imaging; 
```

双击“.NET for Windows Store apps”参考，它们似乎仍然存在。我是否必须使用其他一些类来处理图像，或者是否可以让我的旧代码按原样工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T01:56:13.847

现代 UI 应用程序中禁止绘图命名空间，有第三方库实现了部分 API（[如这个](http://www.moderncomponents.com/products/DrawingLibrary/)），但您想要的（操作位图）的最佳库是[WriteableBitmapEx](http://writeablebitmapex.codeplex.com/)，您唯一的其他解决方案将是 Direct2D 或者，如果你觉得幸运的话，Canvas 元素使用了 HTML5 和 JavaScript。

# java - Java XML Transformer 用空格替换“\n”

> ID：14782777
> 
> 赞同：1
> 
> 时间：2013-02-08T23:05:05.817
> 
> 标签：java, html, xml, transformer

我正在使用 Java Transformer 将 XML 转换为 HTML。当我显示输出时，在字段中有一个换行符字符串文字分隔符“\n”的任何地方，都只有一个空格。我能找到的唯一建议是：

```
transformer.setOutputProperty(OutputKeys.INDENT, "yes"); 
```

这没有用。我在 JavaDocs 中找不到任何关于 TransformerFactory 或解决此问题的 Transformer 类的内容。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T17:18:38.623

我发现了这个问题。为 Transformer 指定的 XSL 包括对“规范化空间”函数的调用。请参阅：[http ://www.xsltfunctions.com/xsl/fn_normalize-space.html](http://www.xsltfunctions.com/xsl/fn_normalize-space.html)

如文档所述，它正在删除换行符并将其替换为单个空格。

# php - vt_resize 函数：裁剪问题

> ID：14782780
> 
> 赞同：1
> 
> 时间：2013-02-08T23:05:35.240
> 
> 标签：php, image-resizing

我一直在使用 vt_resize 函数为我的网站重新调整图像大小，但最近遇到了关于裁剪的问题。我在这里复制并粘贴了 vt_resize 函数：http: [//pastebin.com/u6K0H4ri](http://pastebin.com/u6K0H4ri)

vt_resize 函数使用 wordpress 内置函数动态调整图像大小。它使用附件 id、图像 url、所需宽度、所需高度和指示图像是否要裁剪的变量来调用。

理想情况下，我希望能够通过宽度和高度变量指定图像的大小，并且该函数将生成具有这些精确尺寸规格的图像，而不是裁剪。然而，当函数被调用时，一些可疑的东西会抛出尺寸。

例如：

```
 $pimage = vt_resize($thumb, '', 640, 278, false); 
```

为两个图像（#1：原始尺寸 8,704px X 2,332px）和（#2 4,096px X 2,340px）调用，但该函数没有生成 640 X 278 的图像。而是将图像 #1 重新调整为640 像素 X 171 像素，图像 #2 重新调整为 486 像素 X 278 像素。显然，它正在选择我发送的维度之一，但更改了第二个维度。我认为问题可能出在 wp_constrain_dimensions 函数调用上，所以我尝试将 $proportional_size 变量注释掉，并直接将 $resized_img_path 设置为 $width 和 $height，但没有成功。有任何想法吗？

# c# - C# 线程似乎多次启动

> ID：14782784
> 
> 赞同：1
> 
> 时间：2013-02-08T23:06:14.850
> 
> 标签：c#, multithreading

此程序应将 .txt 文件重命名为 .txtok。在我的测试目录中，我创建了 ~10 个文本文件。

在运行时，抛出了 FileNotFoundException。丢失的文件是已在前一个线程中重命名的文件。

似乎在一个循环迭代中启动了多个线程！？

```
static void Main(string[] args)
    {
        foreach (String s in Directory.EnumerateFiles(@"C:\Test", "*.txt", SearchOption.TopDirectoryOnly))
        {
            new Thread(() =>
            {
                File.Move(s, s + "ok");
            }).Start();                
        }
        Console.ReadKey();
    } 
```

有人有类似的问题吗？

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-08T23:12:15.453

您正在经历“访问修改后的闭包”错误的痛苦。这是 StackOverflow 上报告的最常见问题之一。搜索“访问修改后的闭包”以获取更多详细信息，或阅读我关于该主题的文章：

[http://ericlippert.com/2009/11/12/closure-over-the-loop-variable-considered-harmful-part-one/](http://ericlippert.com/2009/11/12/closing-over-the-loop-variable-considered-harmful-part-one/)

您可以通过升级到 C# 5 或执行以下操作来修复它：

```
 foreach (String s in Directory.EnumerateFiles(@"C:\Test", "*.txt", SearchOption.TopDirectoryOnly))
    {
        string s1 = s;
        new Thread(() =>
        {
            File.Move(s1, s1 + "ok");
        }).Start();                
    } 
```

也就是说，这段代码不是好代码；不要像那样创建这么多线程。线程是重量级的。像对待雇用新员工一样对待创建线程；您不会雇用员工重命名文件然后解雇他们；太贵。您将雇用一名员工来重命名所有文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T23:14:21.320

该问题是由`foreach`循环和 lambda 捕获之间的交互引起的。

该变量在循环`s`的每次迭代中都会被覆盖`foreach`。这意味着在执行新线程时`s`，lambda 捕获的对 in的引用`new Thread`已经改变。

第一个线程将成功执行，但其余线程也指向相同的值`s`并且将失败。

解决方案是创建一个临时变量：

```
foreach (String s in Directory.EnumerateFiles(@"C:\Test", "*.txt", SearchOption.TopDirectoryOnly))
{
  var temp = s;
  new Thread(() => File.Move(temp, temp + "ok")).Start();                
} 
```

根据@Eric Lippert 的建议，考虑使用 PLINQ 或 TPL 为您管理线程：

```
// assume `using System.Linq`

Directory.EnumerateFiles(@"C:\Test", "*.txt", SearchOption.TopDirectoryOnly)
         .AsParallel()
         .Select(f => File.move(f, f + "ok"))
         .ToList(); 
```

这巧妙地避免了问题`foreach`并让运行时控制线程行为。

# c# - 即使我添加了 crlfs，为什么所有内容都打印在同一行？

> ID：14782786
> 
> 赞同：1
> 
> 时间：2013-02-08T23:06:16.627
> 
> 标签：c#, compact-framework, windows-ce, zebra-printers, opennetcf

这将从我在摩托罗拉 MC3100 手持设备上运行的 CE/CF 应用程序在 Zebra QL220 皮带打印机上打印（尽管仍然很难看）：

```
public void PrintBarcode(string barcode, string UPC, string description, decimal listPrice)
{
    using (SerialPort serialPort = new SerialPort())
    {
        serialPort.BaudRate = 19200;
        serialPort.Handshake = Handshake.XOnXOff; 
        serialPort.DataBits = 8;
        serialPort.Parity = Parity.None;
        serialPort.StopBits = StopBits.One; // other choice is Two (see p. 14-21 in CPCL pdf)
        serialPort.PortName = "COM1:"; 

        serialPort.Open(); 

        Thread.Sleep(2500); // I don't know why this is needed, or if it really is...

        serialPort.Write("! 0 200 200 210 1\r\n");

        serialPort.Write("TEXT 4 0 30 40 Hola el Mundo\r\n"); //Bonjour le Monde --- Hola el Mundo --- Hallo die Welt
        serialPort.Write("TEXT 4 0 30 40 \r\n");

        serialPort.Write("BARCODE-TEXT 7 0 5\r\n"); 
        serialPort.Write(string.Format("BARCODE 128 1 1 50 150 10 {0}\r\n", barcode));
        serialPort.Write("TEXT 4 0 30 40\r\n");
        serialPort.Write("FORM\r\n");
        serialPort.Write("PRINT\r\n");

        serialPort.Close();
    }
} 
```

......但总的来说，就像一个半狂躁的青少年在 mosh 坑里 - 最后打印的条形码实际上是在纸上的最高点，“Hola el Mundo”和看起来像“FOIPM”的东西（怎么到达那里？！？），太。

如果`"TEXT 4 0 30 40\r\n"`不是发送 CRLF 的方法，那是什么？

## 更新

我注意到我在打印条形码的参数中有一个错字。这个：

```
 serialPort.Write(string.Format("BARCODE 128 1 1 50 150 10 {0}\r\n", barcode)); 
```

...这应该是这样的：

```
 serialPort.Write(string.Format("BARCODE 128 1 1 50 150 130 {0}\r\n", barcode)); 
```

...但是当我“修复”它（将垂直起点从 10 更改为 130）时，打印结果是相同的！对不起，我的法语，但是北达科他州在这里发生了什么？！？

## 更新 2

没关系，一旦我将修复程序添加到正确的位置，它确实有效（将“10”更改为“130”）。现在我必须让它“智能”，因为它会考虑到以前的打印区域，并总是在起始点 + 之前打印的高度下方打印后续行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-11T15:55:02.240

看起来您正在将 CPCL 直接写入打印机。您正在使用的 TEXT 命令在命令中包含 x 和 y 坐标本身 - 即您正在编写的“30”和“40”告诉您的打印机始终在坐标 30,40 处打印每一行文本。尝试使用您要打印的每一行后续文本更改这些坐标。据我所知，CPCL 没有“自动换行”功能，因此您必须为每一行文本手动执行此操作。

或者，您可以将打印机置于行打印模式。在这种模式下，打印机将简单地打印它接收到的任何文本，而 '\r\n' 将使打印机开始打印下一行。您可以通过向打印机发送以下命令来切换行打印模式：

！U1 setvar "device.languages" "line_print" [此处为新行字符]

来源：CPCL 手册 - h​​ttp: [//www.zebra.com/content/dam/zebra/manuals/en-us/printer/cpcl-pm-en.pdf](http://www.zebra.com/content/dam/zebra/manuals/en-us/printer/cpcl-pm-en.pdf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T23:19:03.633

作为一般规则，请考虑使用 System.Environment.Newline

但是，在这种情况下，听起来您可能需要检查您的设备 (Zebra QL220) 对换行的期望/要求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T16:38:50.130

我不知道如何写入 Zebra 打印机，但是：

我看到“文本开头”（TEXT 4 0 30 40）和“条形码开头”（BARCODE 128 1 1）的代码。

“文本结束”或“条码结束”是否应该有一些代码？

“下一行”的代码怎么样？

# regex - 我的 \d[AZ]\d 正则表达式不起作用

> ID：14782799
> 
> 赞同：1
> 
> 时间：2013-02-08T23:07:24.257
> 
> 标签：regex, autohotkey

我正在尝试匹配像 3X3464 5J3454 这样的数字

但下面的代码不是为我做的。

```
If RegExmatch(A_LoopReadLine,"\d[A-Z]\d\d\d\d\") 
```

关于正则表达式，我不知道什么简单的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:11:15.687

精确匹配将是：

```
\d{1}[A-Z]{1}\d{4} 
```

并且不需要 {1}：

```
\d[A-Z]\d{4} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T23:13:30.430

Rgex 并不总是被一致地阅读。不同的软件以不同的方式解释正则表达式。也许尝试：

```
[0-9][A-Z][0-9]{4} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T23:19:21.917

我不知道 AutoHotkey 支持什么正则表达式品种，但这适用于 RegEx Buddy 的默认品种，以匹配您发布的字符串中的两个数字集：

```
\d[A-Z]\d{4}\b 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T00:33:39.457

这是您的 Ahk 代码

匹配：
\d -> 数字字符
\D -> 非数字字符
\d{4} == \d\d​​\d\d

```
FoundPos := RegExMatch("3X1234", "\d\D\d{4}") 
msgbox,%FoundPos% 
```

[自动热键正则表达式](http://www.autohotkey.com/docs/misc/RegEx-QuickRef.htm)

# php - mysqli 不工作

> ID：14782802
> 
> 赞同：0
> 
> 时间：2013-02-08T23:07:42.023
> 
> 标签：php, mysqli

我编写了一个简单的 php 代码来显示 mySql 表中的数据。这个在我使用“mysql_connect”、“mysql_select_db”时有效，但在我使用“mysqli_connect”、“mysqli_select_db”时无效。任何人都可以请对它有所启发。

我是一名非常初级的 Web 开发人员。

这是我写的代码：

```
<?php
 $con = mysqli_connect("localhost","root","abc123");
 if (!$con)
   {
   die('Could not connect: ' . mysql_error());
}

$db=mysqli_select_db("database_name",$con) or die("Could not select DB");

if (!$db)
{
die('no database connected');
}

$data = mysql_query("SELECT * FROM categories") 
 or die(mysql_error()); 
 Print "<table border cellpadding=3>"; 
 while($info = mysql_fetch_array( $data )) 
 { 
 Print "<tr>"; 
 Print "<th>Name:</th> <td>".$info['parentId'] . "</td> "; 
 Print "<th>ID:</th> <td>".$info['title'] . "</td> </tr>"; 
 } 
 Print "</table>"; 
 ?> 
```

但是如果我用“mysql”替换“mysqli”，那么它就可以工作了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:09:47.427

您正在将`mysql_`功能与`mysqli_`. 我建议您查看[文档](http://php.net/manual/en/mysqli-result.fetch-assoc.php)。

```
<?php
$link = mysqli_connect("localhost", "root", "abc123", "database_name");

/* check connection */
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
}

$query = "SELECT * FROM categories";

if ($result = mysqli_query($link, $query)) {

echo "<table border cellpadding=3>";

    /* fetch associative array */
    while ($info = mysqli_fetch_assoc($result)) {
    echo "<tr>"; 
    echo "<th>Name:</th> <td>".$info['parentId'] . "</td> "; 
    echo "<th>ID:</th> <td>".$info['title'] . "</td> </tr>"; 
    }

    /* free result set */
    mysqli_free_result($result);

echo "</table>";
}

/* close connection */
mysqli_close($link);
?> 
```

# java - 将整数连接到字符串 - 从性能和内存的角度来看，使用字符串文字还是原语？

> ID：14782804
> 
> 赞同：10
> 
> 时间：2013-02-08T23:07:50.957
> 
> 标签：java, string, concatenation, primitive

选项1：

```
String newStr = someStr + 3 + "]"; 
```

选项 2：

```
String newStr = someStr + "3" + "]"; 
```

哪个选项在性能、内存和一般实践方面更好？我可以使用哪些推荐的工具/方法来测量我的代码的内存使用情况及其性能（除了测量开始时间和结束时间并计算差异）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-08T23:13:46.873

第一个将变为：

```
StringBuilder sb = new StringBuilder (String.valueOf (someStr));
sb.append (3);
sb.append ("]");
String newStr = sb.toString (); 
```

第二个将变为：

```
StringBuilder sb = new StringBuilder (String.valueOf (someStr));
sb.append ("3");
sb.append ("]");
String newStr = sb.toString (); 
```

下面是拆解：

```
public String foo (String someStr)
{
    String newStr = someStr + 3 + "]";
    return newStr;
}

public String bar (String someStr)
{
    String newStr = someStr + "3" + "]";
    return newStr;
}

public java.lang.String foo(java.lang.String);
Code:
   0: new           #16                 // class java/lang/StringBuilder
   3: dup
   4: aload_1
   5: invokestatic  #18                 // Method java/lang/String.valueOf:(Ljava/lang/Object;)Ljava/lang/String;
   8: invokespecial #24                 // Method java/lang/StringBuilder."<init>":(Ljava/lang/String;)V
  11: iconst_3
  12: invokevirtual #27                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
  15: ldc           #31                 // String ]
  17: invokevirtual #33                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
  20: invokevirtual #36                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
  23: astore_2
  24: aload_2
  25: areturn

public java.lang.String bar(java.lang.String);
Code:
   0: new           #16                 // class java/lang/StringBuilder
   3: dup
   4: aload_1
   5: invokestatic  #18                 // Method java/lang/String.valueOf:(Ljava/lang/Object;)Ljava/lang/String;
   8: invokespecial #24                 // Method java/lang/StringBuilder."<init>":(Ljava/lang/String;)V
  11: ldc           #44                 // String 3
  13: invokevirtual #33                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
  16: ldc           #31                 // String ]
  18: invokevirtual #33                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
  21: invokevirtual #36                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
  24: astore_2
  25: aload_2
  26: areturn 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-08T23:11:47.627

两者之间不会有任何明显的区别。使用您认为最符合逻辑和可读性的内容。我会用

```
String newStr = someStr + "3]"; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-08T23:12:05.973

我会推荐[Jprofiler](http://www.ej-technologies.com/products/jprofiler/overview.html)作为一个很棒的 Java 应用程序分析工具，它可以帮助我发现很多内存问题。

我不认为选项 1 和 2 在内存使用方面有很大差异，尤其是对于桌面应用程序。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-08T23:16:39.013

假设 someString 是常量，两者都是*常量表达式*，并且将在编译时进行评估。它们将产生相同的类文件和运行时行为。

资料来源：[Java 语言规范](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.28)写道：

> 编译时常量表达式是表示原始类型值或字符串的表达式，它不会突然完成并且仅使用以下内容组成：
> 
> *   原始类型的文字和字符串类型的文字（§3.10.1、§3.10.2、§3.10.3、§3.10.4、§3.10.5）
>     
>     
> *   加法运算符`+`和`-`（§15.18）
>     
>     
> *   ...
>     
>     
> 
> 使用 String.intern 方法，String 类型的编译时常量表达式始终是“内部”的，以便共享唯一的实例。

如果 someString 不是常量，大多数现代编译器将使用 StringBuilder，这是Java 语言规范明确[允许的：](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.18.1)

> 字符串连接的结果是对 String 对象的引用，该对象是两个操作数字符串的连接。在新创建的字符串中，左侧操作数的字符在右侧操作数的字符之前。
> 
> String 对象是新创建的（第 12.5 节），除非表达式是编译时常量表达式（第 15.28 节）。
> 
> 实现可以选择在一个步骤中执行转换和连接，以避免创建然后丢弃中间 String 对象。为了提高重复字符串连接的性能，Java 编译器可以使用 StringBuffer 类或类似技术来减少通过计算表达式创建的中间字符串对象的数量。
> 
> 对于原始类型，实现还可以通过直接从原始类型转换为字符串来优化包装对象的创建。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-04T15:15:41.097

每当您连接一个字符串时，在每次连接时，您都会创建该字符串的一个新副本，并且两个字符串都会被复制，一次一个字符。这导致时间复杂度为 O(n ² ) (McDowell)。

如果要提高性能，请使用

```
StringBuilder 
```

它的构造函数之一具有以下语法：

```
public StringBuilder(int size); //Contains no character. Initial capacity of 'size'. 
```

StringBuilder（可变的字符序列。记住字符串是不可变的）通过简单地创建一个包含所有字符串的可调整大小的数组来帮助解决这个问题。仅在必要时将它们复制回字符串（McDowell）。

```
StringBuilder str = new StringBuilder(0);
str.append(someStr);
str.append(3);
str.append("]"); 
```

参考：

麦克道威尔，盖尔·拉克曼。破解编码访谈，第 6 版。打印。

“字符串生成器（Java 平台 SE 8）”。Docs.oracle.com。Np，2016 年。网络。2016 年 6 月 4 日。

# c++ - basic_ostream 的问题

> ID：14782809
> 
> 赞同：0
> 
> 时间：2013-02-08T23:08:01.743
> 
> 标签：c++

尝试编译代码时出现此错误：

```
1>  c:\mingw\bin\../lib/gcc/mingw32/4.6.2/include/c++/ostream: In constructor 'Log::Log(const char*)':
1>c:\mingw\bin\..\lib\gcc\mingw32\4.6.2\include\c++\ostream(363,7): error : 'std::basic_ostream<_CharT, _Traits>::basic_ostream() [with _CharT = char, _Traits = std::char_traits<char>]' is protected
1>C:\Users\Adam\Documents\cs\cs176b\hw2\ftp\ftp\log.cpp(6,26): error : within this context 
```

不太清楚为什么，我没有制作我自己使用的 ostream 代码，我使用了这里建议的内容：[Proper way to create ostream to file or cout](https://stackoverflow.com/questions/14781629/proper-way-to-create-ostream-to-file-or-cout)

我的代码如下，如果需要，很乐意提供更多信息：

```
// log.h
#include <string>
#include <fstream>

#ifndef LOG_H_
#define LOG_H_

class Log 
{
    public:
        enum Mode { STDOUT, FILE };

        // Needed by default
        Log(const char *file = NULL);
        ~Log();

        // Writing methods
        void write(char *);
        void write(std::string);
    private:
        Mode mode;
        std::streambuf *buf;
        std::ofstream of;
        std::ostream out;
};

#endif

// log.cpp
#include "log.h"
#include <iostream>
#include <stdlib.h>
#include <time.h>

Log::Log(const char *file)
{
    if (file != NULL)
    {
        of.open(file);
        buf = of.rdbuf();
        mode = FILE;
    }
    else
    {
        buf = std::cout.rdbuf();
        mode = STDOUT;
    }

    // Attach to out
    out.rdbuf(buf);
}

Log::~Log()
{
    if (mode == FILE)
        of.close();
}

void Log::write(std::string s)
{
    out << s << std::endl;
}

void Log::write(char *s)
{
    out << s << std::endl;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T23:15:35.513

[`std::ostream::ostream()`构造函数是受保护](http://en.cppreference.com/w/cpp/io/basic_ostream/basic_ostream)的，这意味着它只能由其派生类调用，但不能由其封闭类调用。

修复错误初始化成员`out`。

`std::ostream`接受 a的唯一公共构造函数`std::streambuf*`，例如：

```
Log::Log(const char *file)
    : out(std::cout.rdbuf())
// ... 
```

请注意，`std::ostream`使用 的缓冲区初始化 a 是安全的`std::cout.rdbuf()`，因为析构函数`std::ostream::~ostream()`不会释放其`std::streambuf*`成员。

或者，它可以用`NULL`/初始化`nullptr`。在这种情况下，请注意不要将任何内容输出到流中，因为它会尝试取消引用`NULL`导致未定义的行为，很可能只是与`SIGSEGV`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T23:14:22.280

延伸大卫所说的：

`ostream`只是输出流的“框架”，是输出流（抽象类）基本能力的定义。它什么也不做，也没有实施。

你有没有尝试写信给`cout`？`cout`中定义的`iostream`，不需要定义，使用即可！

# javascript - 这个记忆功能是如何工作的？

> ID：14782812
> 
> 赞同：1
> 
> 时间：2013-02-08T23:08:05.187
> 
> 标签：javascript

我今天感觉很愚蠢。我一直在看这段代码，试图追踪它，但我就是想不通：

1.  它实际上是做什么的
2.  这个怎么运作

据我所知，第一次调用它是唯一一次`action`与`callFn`. 因此，第一次运行时，它会创建堆栈数组。然后我就输了。Action 被分配了一个函数，该函数只是将传递的回调添加到堆栈中。*然后实际*调用fn并根据其结果将“action”设置为 callFn (?!?) 或调用回调的函数……然后，调用堆栈中的所有调用。

我讨厌迷失在代码中，但这有点超出我的想象。比我聪明的人能“得到它”吗？

```
var memoize = function(fn) {
    var callFn = function(callback) {
        var stack = [callback];

        action = function(callback) {
            stack.push(callback);
        };

        fn(function(err, val) {
            action = err ? callFn : function(callback) {
                callback(null, val);
            };

            while (stack.length) stack.shift()(err, val);
        });
    };

    var action = callFn;

    return function(callback) {
        action(callback);
    };
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:33:51.017

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T23:33:49.420

记忆化是一种使用副作用来提高 - 在运行时 - 函数的性能而不改变其行为的技术。粗略地说，您可以通过存储在先前调用中返回的函数值并在进一步调用该函数时返回这些值而不是实际调用该函数来进行记忆。

[阅读更多](http://philogb.github.com/blog/2008/09/05/memoization-in-javascript/)

# jquery - 有人知道这叫什么类型的 WordPress jquery 效果吗？（包括图片）

> ID：14782815
> 
> 赞同：0
> 
> 时间：2013-02-08T23:08:25.847
> 
> 标签：jquery, wordpress, wordpress-theming

有人知道这种东西叫什么吗？许多主题都有它，但我确定它有一个插件。=，但如果没有，我可以找到一个教程，我不想要一个普通的 jquery 滑块或“旋转木马”——除非有一个旋转木马做这个。

基本上，有一个主要的特色图片，右边有 4 个较小的博客摘录和图片。您单击其中一个摘录，它将成为特色图像。所以它看起来像这样：

![Jquery 精选在首页](../Images/cdeb1fac7b28cdd79749c38dbb717fc5.png)

如果我能弄清楚你所说的这种东西，我相信我可以从那里拿东西。在这方面的任何指导将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:19:26.770

您正在考虑的 javascript 效果称为“滑块”。您可以在此处查看源代码并自行设计：

[http://www.jqueryslidershock.com/](http://www.jqueryslidershock.com/)

# html - HTML5 如何读取离线移动 Web 应用程序的大量图像目录

> ID：14782816
> 
> 赞同：0
> 
> 时间：2013-02-08T23:08:31.120
> 
> 标签：html, cordova

我目前正在尝试创建一种机制来读取用于离线 Web 应用程序的大量产品目录。

目前，我采用的机制是从清单文件中读取加载过程中的所有图像以进行离线缓存。这在 iOS 6 中存在严重问题，只有 50MB，而且在 iOS6 的 Safari 中对 HTML Offline 的支持似乎有问题，在 iOS5 中更是如此。

但是，我面临着多个问题。移动浏览器不支持 Filesystem API，File API 并没有解决我读取文件的问题。所以我目前正在考虑将我的 Web 应用程序移动到 Phonegap 应用程序，但这并非没有它自己的问题......我正在寻找一种跨平台的方式来处理离线图片库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:43:31.777

首先要记住的是，phonegap-app 是一个混合应用程序。几乎所有您可以使用本机应用程序执行的操作，也可以使用 phonegap 完成。

在你的情况下更具体：

您可以从 phonegap-example 开始。

现在您需要一个服务（服务器端），您可以在其中获取图像列表（可能是一些 JSON 结构）。这可以通过您的 phonegap 应用程序读取。

使用[FileTransfer 对象](http://docs.phonegap.com/en/2.3.0/cordova_file_file.md.html#FileTransfer)，您可以将文件下载到设备“硬盘”。

现在是我不能 100% 确定的部分（只有 98%）。如果您的文件存储在设备上，您可以通过在-tag 中使用`file://`-url来简单地显示它们。`image`

但这可以用一个非常简单的应用程序来测试。我认为你不需要超过 50 行的`JavaScript`，来证明我的方法。

您的应用受到平台限制和应用商店条件的限制。

# security - Access-Control-Allow-Origin 未按预期工作，允许所有流量

> ID：14782825
> 
> 赞同：0
> 
> 时间：2013-02-08T23:09:19.590
> 
> 标签：security, nginx, http-headers, csrf

我正在测试一个`Access-Control-Allow-Origin`http 响应头安全策略`nginx`：

```
add_header Access-Control-Allow-Origin "https://google.com"; 
```

我希望请求在我的域上失败，但是它们正在工作，返回 200 状态代码。我确认确实`Access-Control-Allow-Origin`正在设置响应标头：

```
Access-Control-Allow-Origin:https://google.com
Cache-Control:no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Connection:keep-alive
Content-Encoding:gzip
Content-Type:text/html
Date:Tue, 05 Feb 2013 20:22:17 GMT
Expires:Thu, 19 Nov 1981 08:52:00 GMT
Pragma:no-cache
Server:nginx
Strict-Transport-Security:max-age=31556926
Transfer-Encoding:chunked
X-Frame-Options:DENY 
```

请求标头显示正确的来源：

```
Origin:https://mydomainhere.com 
```

知道是什么原因造成的吗？我希望请求失败。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T16:56:31.593

*   服务器（像 nginx 这样的网络服务器）与 access-control-allow-origin 无关（除设置或取消设置标志外）。这是浏览器允许跨域 Ajax (XhttpRequest) 调用的一个方向。

*   因此，当您将 access-control-allow-origin 设置为 google.com 时，您是在告诉 Bowser 允许 Ajax 从您的站点页面调用 google.com。

go through - [HTTP 访问控制](https://developer.mozilla.org/en-US/docs/HTTP/Access_control_CORS)以获取更多详细信息。

# javascript - JS / HTML：向搜索输入的父级添加类不起作用

> ID：14782830
> 
> 赞同：0
> 
> 时间：2013-02-08T23:09:37.087
> 
> 标签：javascript, jquery, html, css

您好我正在尝试选择搜索输入的父 DIV，以便在搜索输入聚焦时更改背景颜色。我很困惑为什么这段代码不起作用。谢谢你的帮助。

[http://jsfiddle.net/BZ5uf/1/](http://jsfiddle.net/BZ5uf/1/)

HTML

```
<div class="search">  
   <input class="box" value="Search" onfocus="if(this.value=='Search') this.value='';" onblur="(this.value=='') this.value='Search';">
</div> 
```

CSS

```
.search {
    position: relative;
    margin: 20px; 
    width: 300px;
    height: 65px;
    border: 1px solid black;

}
input.box { 
    margin: 10px;
}

.fill {
    background: #222;
} 
```

JAVASCRIPT

```
$(function(){
    $('.box').focus(function(){
        $(this).parent().addClass('fill');
 )}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:13:31.633

语法错误很多。

```
)}; //mismatched order 
```

应该

```
 });
}); //you also forgot to close DOM ready handler 
```

还可以尝试使用小提琴顶部的“JSHint”按钮。

好的 IDE 也会为您突出显示这些错误。使用适当的缩进也有助于找到未关闭的处理程序：

```
$(function () {
    $('.box').focus(function () {
        $(this).parent().addClass('fill');
    });
}); 
```

上述格式是使用 jsfiddle 的“TidyUp”按钮获得的。这是您[更新的小提琴](http://jsfiddle.net/BZ5uf/11/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T23:17:20.470

[jsFiddle 上的工作示例](http://jsfiddle.net/htmled/P6EjN/)。

```
$('.box').on('blur', function () {
    $(this).parent()
           .addClass('fill');
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T23:17:07.353

您的 JavaScript 中有一个错误：

改变这个：

```
$('.box').focus(function(){
    $(this).parent().addClass('fill');
)}; 
```

到 ：

```
$('.box').focus(function(){
    $(this).parent().addClass('fill');
}); 
```

（注意翻转的大括号顺序）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T23:13:41.650

你的JS有错字，应该是这样的

```
$(function(){
    $('.box').focus(function(){
         $(this).parent().addClass('fill');
    });
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-08T23:13:42.587

看起来你有语法错误。这是正确的代码：

```
$(function(){
    $('.box').focus(function(){
        $(this).parent().addClass('fill');
    });
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-08T23:15:29.133

试试这个。

```
 $(function(){
    $('.box').focus(function(){
        $(this).parent().addClass('fill');
    });
}); 
```

# python - Python写出itertools

> ID：14782831
> 
> 赞同：0
> 
> 时间：2013-02-08T23:09:39.310
> 
> 标签：python, multithreading, itertools

我想在一行中手动写出 itertools 的功能，以便我可以尝试使用多个字符串更快地完成该功能。现在这个功能有效，我只需要大幅加速它。我什至不确定写出 itertools 行是否能让我使用多个线程。

```
def list ():
charLength = sys.argv[2]
charSet = 'abcdefghijklmnopqrstuvwxyz0123456789'

combo = itertools.combinations_with_replacement(charSet, int(charLength))
for floatingcombo in combo:
    floatingcombo = ''.join(floatingcombo)
    floatingcombo += "." + sys.argv[3]
    try:
        floatingIP = socket.gethostbyname(floatingcombo)
        msvcrt.printf("%s resolved to --> %s\n", floatingcombo, floatingIP)
    except socket.gaierror:
        msvcrt.printf("%s does not exist\n", floatingcombo)
return 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:37:24.967

您的问题可能与 IO 相关。您可以通过使用多个线程/进程来加快查找速度。为了避免 dns 实现中的线程问题，您可以使用多个进程来解析主机：

```
#!/usr/bin/env python
import itertools
import socket
import sys
from functools import partial
from multiprocessing import Pool

def resolve(host, domain=""):
    host = ''.join(host) + domain
    try:
        return host, socket.gethostbyname(host), None
    except EnvironmentError as e:
        return host, None, e

def main():
    alphabet = 'abcdefghijklmnopqrstuvwxyz0123456789'
    size = int(sys.argv[2])
    resolve_host = partial(resolve, domain="." + sys.argv[3])
    combo = itertools.combinations_with_replacement(alphabet, size)

    pool = Pool(20) 
    for host, ip, error in pool.imap_unordered(resolve_host, combo):
        if error is None:
           print("%s resolved to --> %s" % (host, ip))
        else: # error
           print("Can't resolve %s, error: %s" % (host, error))

if __name__=="__main__":
   main() 
```

# c# - WPF 调度程序操作泄漏

> ID：14782836
> 
> 赞同：1
> 
> 时间：2013-02-08T23:10:09.293
> 
> 标签：c#, .net, wpf, dispatcher

我在我们的 WPF 应用程序中看到内存泄漏。在使用 .NET Memory Profiler 时，我可以看到，即使在关闭窗口之后，DataContext 和 UI 元素都仍然存在，因为 Dispatcher 队列中的 DispatcherOperations 中的 Action 委托......但具有 ContextIdle 优先级并且似乎从来没有得到处理。

当我的窗口关闭时，我可以强制调度程序队列刷新吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T09:00:31.703

您可以尝试在 Window.Closing 事件中使用具有优先级 ContextIdle 的 dispatcher.Invoke 对虚拟方法进行同步调用。这应该会阻止 UI 线程生成更多调度程序项目，并且应该仅在处理完最后一个 ContextIdle 项目后返回。但是，我无法验证，因为没有 Telerik 组件 ContextIdle 项目在窗口关闭之前得到处理，无论如何。

我还可以想象这些项目在循环中运行，即在执行过程中重新创建自己。在这种情况下，在关闭窗口之前将 DataContext 显式设置为 null 可能会有所帮助。这可能会向组件发出信号，表明它们可以停止循环，至少您不会以这种方式泄漏数据上下文对象的实例。

# javascript - 获取 Javascript 提示的值

> ID：14782838
> 
> 赞同：0
> 
> 时间：2013-02-08T23:10:15.087
> 
> 标签：javascript, prompt

我正在使用 C#，并且我有一个 aspx 页面，当单击该按钮时，会出现一个 javascript 提示，允许用户输入强制注释。我对按钮使用了 onClientClick 属性，如下所示：

OnClientClick = "return prompt('输入拒绝操作的评论：');"

但是，我想捕获用户输入的评论，然后将其存储在一个字符串变量中，该变量最终将写入数据库。但我的主要问题是获取用户在提示中为我的字符串变量输入的值......任何帮助将不胜感激......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:16:04.300

如果我理解正确，您正在寻找：

```
OnClientClick = "return x=prompt('Enter a comment for rejecting the action:');" 
```

比你在 x 变量中的值

# r - 在 grid.draw 中显示美元符号

> ID：14782841
> 
> 赞同：3
> 
> 时间：2013-02-08T23:10:38.847
> 
> 标签：r, ggplot2, gridextra

如何在`grid.draw`package绘制的表格中添加美元符号并将其四舍五入为两位数`gridExtra`？

我`round`在绘制表格之前正在使用，但我不知道如何四舍五入并将“$”加在一起并绘制表格。任何建议将不胜感激。

![<code>在此输入图片说明</code>](../Images/7ec563a6b09a4ea671e742bb57cb5a30.png)

这是我的数据 `df`

```
 A          B
    aa 13.143733 0.09038618
    bb  1.459788 0.14159621
    cc  0.000000 0.00000000
    dd  4.884422 0.69697260
    ee 10.633865 2.92650123

grid.draw(tableGrob(df,show.csep=TRUE, show.rsep=TRUE, 
                          show.box=TRUE, separator="black", 
                          name="test",gp=gpar(fontsize=6, lwd=2))) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T23:22:24.640

使用`plyr`，您可以使用该`colwise`函数将函数应用于多列。

```
library(plyr)
dat <- numcolwise(round_any)(dat,0.01)
dat <- colwise(paste)(dat,'$') 
```

![在此处输入图像描述](../Images/20d943bf2e92255a4bc626557dc98934.png)

# ios - MonoTouch - 在没有 Xib 的情况下创建 UI

> ID：14782846
> 
> 赞同：3
> 
> 时间：2013-02-08T23:11:07.330
> 
> 标签：ios, xamarin.ios, xamarin

我查看了 Monotouch.dialog 的东西，它非常棒。但是，它有一些限制。我希望能够在不使用 Xib 文件的情况下创建我的应用程序，但我不知道该怎么做。没有 MonoTouch 对话框和 xib 文件....我不知道任何其他方式。

谁能指出正确的方向？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-09T02:27:42.453

很长一段时间我都不知道如何做到这一点，但它比你想象的要简单！只需添加一个常规 C# 类（您不需要使用任何特殊模板），导入 MonoTouch.Foundation 和 MonoTouch.UIKit 命名空间，并使您的新类成为 UIViewController 的子类。

就是这么简单！你会想要覆盖像 ViewDidLoad 这样的常用方法，但这应该足以让你开始。至于在不使用 .xib 的情况下实现 UI，只需以编程方式创建所有内容、设置框架并将其添加到视图中（当然还可以使用属性/方法等对其进行自定义）！

您可以将其设置为：

```
// Table setup
var VersesTable = new UITableView ()
{
    Frame = new RectangleF (0, 0, View.Bounds.Width, View.Bounds.Height - 93),
    BackgroundColor = UIColor.FromPatternImage (Images.BackgroundTexture),
};
View.AddSubview (VersesTable); 
```

这样做最困难的部分是获取框架和所有设置（imo）。

在 TweetStation 的 Github 页面上还有一些不使用 .xibs 和使用 MonoTouch.Dialog 的[真实](https://github.com/migueldeicaza/TweetStation)[代码](https://github.com/migueldeicaza/TweetStation/blob/master/TweetStation/Dialogs/Settings.cs)。[https://github.com/migueldeicaza/TweetStation/blob/master/TweetStation/Dialogs/Settings.cs](https://github.com/migueldeicaza/TweetStation/blob/master/TweetStation/Dialogs/Settings.cs)

在 Xamarin 论坛中，有一篇[文章](http://forums.xamarin.com/discussion/1164/ios-layout-in-c)详细介绍了一些使用纯 C# 代码（无 .xibs）的示例，这非常有帮助！

# ios - iOS 中子视图和 MKMapView 的手势 - 基本 iOS

> ID：14782850
> 
> 赞同：0
> 
> 时间：2013-02-08T23:11:21.170
> 
> 标签：ios, objective-c, uiview, mkmapview, subview

我有以下设置：

```
 mainViewController
    OverlayView - UIView
    mapView - MKMapView 
```

我的 OverlayView 显示在 mapView 上并响应 UIPanGestureRecognizer

现在因为 OverlayView 在 MapView 之上，我无法让 MapView 的缩放功能起作用..

我该怎么做才能让 mapView 对捏做出反应，让 OverLayView 对 Pan 做出反应（就像现在一样）？

我现在的解决方案只是在 mainViewController 中实现 pinch2zoom 功能，以便它相应地缩放 mapView，但它不如最初的 Apple 实现平滑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:28:24.973

如果您有一个视图应该在前面`MKMapView`并且随着地图在其下方移动而不在屏幕上移动，您应该按照您的描述实现它，作为前面（即顶部）的单独视图地图视图。但是，与其让这个前视图处理手势并尝试以编程方式更改地图视图，不如只为这个前视图设置`userInteractionEnabled`（`NO`您可以通过编程方式或通过 Interface Builder 执行此操作）。这将让它后面的地图视图接收到触摸。

如果您在该前视图上有一些需要接受用户交互的控件，则继续为这几个控件启用用户交互，但请确保该前视图的大部分配置为不具有`userInteractionEnabled`.

* * *

如果您想要一个应该随地图移动的叠加层，您应该只将叠加层添加到`MKMapView`, 本身，而不是单独的视图。请参阅*Location Awareness Programming Guide*中的[在地图上显示叠加层。](http://developer.apple.com/library/ios/documentation/UserExperience/Conceptual/LocationAwarenessPG/AnnotatingMaps/AnnotatingMaps.html#//apple_ref/doc/uid/TP40009497-CH6-SW15)如果您使用覆盖而不是单独的视图，则不会丢失任何内置手势。*`MKMapView`*

 *例如，如果您将`delegate`for your设置为您的视图控制器，则可以在 iOS 7 中`MKMapView`编写 a （或早期版本的方法）：`rendererForOverlay``viewForOverlay`

```
// for iOS7+; see `viewForOverlay` for earlier versions

- (MKOverlayRenderer *)mapView:(MKMapView *)mapView rendererForOverlay:(id<MKOverlay>)overlay
{
    if ([overlay isKindOfClass:[MKPolygon class]])
    {
        MKPolygonRenderer *renderer = [[MKPolygonRenderer alloc] initWithPolygon:overlay];

        renderer.fillColor   = [[UIColor cyanColor] colorWithAlphaComponent:0.2];
        renderer.strokeColor = [[UIColor blueColor] colorWithAlphaComponent:0.7];
        renderer.lineWidth   = 3;

        return renderer;
    }

    if ([overlay isKindOfClass:[MKCircle class]])
    {
        MKCircleRenderer *renderer = [[MKCircleRenderer alloc] initWithCircle:overlay];

        renderer.fillColor   = [[UIColor cyanColor] colorWithAlphaComponent:0.2];
        renderer.strokeColor = [[UIColor blueColor] colorWithAlphaComponent:0.7];
        renderer.lineWidth   = 3;

        return renderer;
    }

    if ([overlay isKindOfClass:[MKPolyline class]])
    {
        MKPolylineRenderer *renderer = [[MKPolylineRenderer alloc] initWithPolyline:overlay];

        renderer.strokeColor = [[UIColor blueColor] colorWithAlphaComponent:0.7];
        renderer.lineWidth   = 3;

        return renderer;
    }

    return nil;
}

// for iOS versions prior to 7; see `rendererForOverlay` for iOS7 and later

- (MKOverlayView *)mapView:(MKMapView *)mapView viewForOverlay:(id <MKOverlay>)overlay
{
    if ([overlay isKindOfClass:[MKPolygon class]])
    {
        MKPolygonView *overlayView = [[MKPolygonView alloc] initWithPolygon:overlay];

        overlayView.fillColor      = [[UIColor cyanColor] colorWithAlphaComponent:0.2];
        overlayView.strokeColor    = [[UIColor blueColor] colorWithAlphaComponent:0.7];
        overlayView.lineWidth      = 3;

        return overlayView;
    }

    if ([overlay isKindOfClass:[MKCircle class]])
    {
        MKCircleView *overlayView = [[MKCircleView alloc] initWithCircle:overlay];

        overlayView.fillColor     = [[UIColor cyanColor] colorWithAlphaComponent:0.2];
        overlayView.strokeColor   = [[UIColor blueColor] colorWithAlphaComponent:0.7];
        overlayView.lineWidth     = 3;

        return overlayView;
    }

    if ([overlay isKindOfClass:[MKPolyline class]])
    {
        MKPolylineView *overlayView = [[MKPolylineView alloc] initWithPolyline:overlay];

        overlayView.strokeColor     = [[UIColor blueColor] colorWithAlphaComponent:0.7];
        overlayView.lineWidth       = 3;

        return overlayView;
    }

    return nil;
} 
```

这处理多边形、圆和线。显然，例如，如果您只绘制多边形，则可以相应地简化上述代码。

完成此操作后，您现在可以直接将叠加层添加到地图中。例如，这会添加一个覆盖，它是围绕特定坐标的特定大小的矩形：

```
- (void)addOverlayAround:(CLLocationCoordinate2D)originalCoordinate atDistance:(double)distanceKm
{
    MKCoordinateRegion region = MKCoordinateRegionMakeWithDistance(originalCoordinate, distanceKm * 1000.0 * 2.0, distanceKm * 1000 * 2.0);
    MKCoordinateSpan span = region.span;

    CLLocationCoordinate2D  points[4];
    points[0] = CLLocationCoordinate2DMake(originalCoordinate.latitude  + span.latitudeDelta / 2.0,
                                           originalCoordinate.longitude - span.longitudeDelta / 2.0);
    points[1] = CLLocationCoordinate2DMake(originalCoordinate.latitude  + span.latitudeDelta / 2.0 ,
                                           originalCoordinate.longitude + span.longitudeDelta / 2.0);
    points[2] = CLLocationCoordinate2DMake(originalCoordinate.latitude  - span.latitudeDelta / 2.0,
                                           originalCoordinate.longitude + span.longitudeDelta / 2.0);
    points[3] = CLLocationCoordinate2DMake(originalCoordinate.latitude  - span.latitudeDelta / 2.0,
                                           originalCoordinate.longitude - span.longitudeDelta / 2.0);

    MKPolygon* poly = [MKPolygon polygonWithCoordinates:points count:4];
    if ([self.mapView respondsToSelector:@selector(addOverlay:level:)])
        [self.mapView addOverlay:poly level:MKOverlayLevelAboveLabels];
    else
        [self.mapView addOverlay:poly];

//    // If you want to draw a circle around the coordinate, instead, you could do something like:
//
//    MKCircle *circle = [MKCircle circleWithCenterCoordinate:originalCoordinate radius:distanceKm * 1000.0 * sqrt(2.0)];
//    if ([self.mapView respondsToSelector:@selector(addOverlay:level:)])
//        [self.mapView addOverlay:circle level:MKOverlayLevelAboveLabels];
//    else
//        [self.mapView addOverlay:circle];

//    // if you want to draw some lines, you could do something like:
//  
//    MKPolyline *polyline = [MKPolyline polylineWithCoordinates:points count:4];
//    if ([self.mapView respondsToSelector:@selector(addOverlay:level:)])
//        [self.mapView addOverlay:polyline level:MKOverlayLevelAboveLabels];
//    else
//        [self.mapView addOverlay:polyline];

    self.mapView.delegate = self;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T23:39:16.890

我现在实际上不知道我要提出的建议是否可行或者是否是一个好的解决方案，无论如何这就是想法

将您的 MainViewController 设置为手势识别器的委托

```
-(BOOL)gestureRecognizer:(UIGestureRecognizer*)gr shouldReceiveTouch:(UITouch*)touch{
    if([gr isKindOfClass:[UIPanGestureRecognizer class]])
        [mapView setUserInteractionEnabled:NO];
    else if([gr isKindOfClass:[UIPinchGestureRecognizer class]])
        [overlayView setUserInteractionEnabled:YES];
    return YES;
} 
```*

# python - 用正则表达式替换 xml 标签

> ID：14782860
> 
> 赞同：0
> 
> 时间：2013-02-08T23:12:39.580
> 
> 标签：python, regex

我通常使用lxml来解析xml，但是在这种情况下，我只需要更改单个标签的内容即可。

```
<sales_start_date>YYYY-MM-DD</sales_start_date> 
```

YYYY-MM-DD 是可变日期。

我将如何将上述内容替换为：

```
<sales_start_date>2013-01-01</sales_start_date> 
```

这是我目前拥有的（哪种作品）

```
re.sub('<sales_start_date>[\d-]+</sales_start_date>', 
       '<sales_start_date>2013-01-01</sales_start_date>', 
        data) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:21:20.277

尝试

```
re.sub('<sales_start_date>.+</sales_start_date>', 
       '<sales_start_date>2013-01-01</sales_start_date>', 
        data) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T23:22:43.910

由于您知道确切的标签，这非常简单，只需抓取任何字符，直到下一个标签（任何字符 not `<`）：

```
re.sub('<sales_start_date>[^<]+</sales_start_date>', 
       '<sales_start_date>2013-01-01</sales_start_date>', 
        data) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T23:22:03.073

您可以使用更具体的正则表达式，例如：

```
r'<sales_start_date>\d{4}-\d{2}-\d{2}</sales_start_date>' 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-08T23:17:45.260

[\d-]+ 不会匹配 YYYY-MM-DD 而只会匹配 YYYY-MM-

尝试 [\d-]+\d 或 \d+-\d+-\d+

# sql - 限制访问报告中图表中的列数

> ID：14782866
> 
> 赞同：0
> 
> 时间：2013-02-08T23:13:09.857
> 
> 标签：sql, ms-access, charts, report, ms-access-2010

在 Microsoft Access 中，我有一个名为 Cons 的表：

```
Person | Date_Consumption | Consumption 
```

对于一些人来说，几年来每个月的第一天，我都在写下消费。

我想为每个人创建一个报告，其中包含一个显示过去 12 个月消费量的图表。

我可以使用以下查询创建没有 12 个月限制的图表：

```
SELECT (Format([Date_Consumption],"mmm")) AS Date_Cons, Consumption FROM Cons; 
```

我怎样才能只显示过去 12 个月。我尝试使用 DESC 排序表的 SELECT TOP 12，但这失败了，因为我不知道如何将选择限制为当前在报告中处于活动状态的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T02:55:57.893

在 sql 中，结果的限制是由 where 子句完成的。您可以通过限制您想要结果的最后日期来获取最近 12 个月的数据。

```
SELECT (Format([Date_Consumption],"mmm")) AS Date_Cons, Consumption FROM Cons 
where Date_Consumption > '08-Feb-2012'(if you run your report today) 
```

# android - android：从列表视图中删除项目无法正常工作

> ID：14782868
> 
> 赞同：1
> 
> 时间：2013-02-08T23:13:19.497
> 
> 标签：android, listview, delete-row

我有两个文本视图和一个按钮的自定义适配器，应该删除该行。

```
public class ListViewAdapter extends ArrayAdapter<OneRowListView> implements OnClickListener {
private ArrayList<OneRowListView> items;
private ContactsActivity ca;
private int position;
private OneRowListView o;

public ListViewAdapter(Context context, int textViewResourceId, ArrayList<OneRowListView> items) {
    super(context, textViewResourceId, items);
    this.items = items;
    ca = (ContactsActivity) context;
}   
@Override
public View getView(int pos, View convertView, ViewGroup parent) {
        View v = convertView;
        position = pos;
        if (v == null) {
            LayoutInflater vi = (LayoutInflater)ca.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            v = vi.inflate(R.layout.one_item_contacts_list, null);
        }
        o = items.get(position);
        if (o != null) {
                TextView name = (TextView) v.findViewById(R.id.name);
                TextView surname = (TextView) v.findViewById(R.id.surname);
                TextView phoneNumber = (TextView) v.findViewById(R.id.phonenumber);
                Button deleteButton = (Button) v.findViewById(R.id.deleteButton);
                deleteButton.setOnClickListener(this);
        // ...
        }
        return v;
 }

@Override
public void onClick(View v) {
    switch(v.getId()){
    case R.id.deleteButton:
        remove(items.remove(position));
        notifyDataSetChanged();
        break;
    }       
}
 } 
```

问题是，当按下任何按钮时，它总是删除最后一行，而不是当前行。可变位置始终指向最后一行。哪里有问题 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:23:01.660

问题在于，当您`position = pos;`继续覆盖“位置”变量时（因为在滚动 ListView 时每行都会调用 getView()）。

作为快速修复，您可以将`deleteButton`包含行位置的标签存储在您的标签中，而不是使用“位置”变量。例如，在您的 getView() 方法中是这样的：

```
deleteButton.setTag(pos); 
```

然后在您的 onClick() 方法中，您可以执行以下操作：

```
int position = (int) v.getTag();
... 
```

# ruby - 使用 Ruby 查找超过 X 小时的文件

> ID：14782869
> 
> 赞同：3
> 
> 时间：2013-02-08T23:13:23.663
> 
> 标签：ruby, shell

我正在将所有 bash 脚本迁移到 Ruby。我发现 Ruby 很棒，但是遇到了一个小问题。我正在尝试移动这个脚本（基本上找到所有超过 x 小时的日志并处理它们）。Bash 脚本看起来像这样

```
find /var/log/myservice.log.* -mmin -120  -exec cp {} /home/myhomedir/mylogs/ \; 
```

当然，我可以遍历所有文件，手动应用`File.mtime`它们，然后识别它们。但是我想了解是否有更清洁的单线来有效地做到这一点。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-08T23:52:13.457

一个班轮：

```
require 'fileutils'; Dir.glob("/var/log/myservice.log.*").each{|f| FileUtils.cp(f, '/home/myhomedir/mylogs/') if File.mtime(f) < (Time.now - (60*120)) } 
```

虽然我希望它更详细地说明：

```
require 'fileutils'
Dir.glob("/var/log/myservice.log.*").
  select{|f| File.mtime(f) < (Time.now - (60*120)) }.
  each{|f| FileUtils.cp(f, '/home/myhomedir/mylogs/') } 
```

# php - 如何优化在“for each”循环中加载数据的过程？

> ID：14782878
> 
> 赞同：1
> 
> 时间：2013-02-08T23:13:58.293
> 
> 标签：php, foreach, twitter

我正在创建一个基于 Twitter API 1.1 的应用程序。用户定义的 Twitter 个人资料图像被拉入并显示在应用程序中，一旦单击，就会显示特定帐户的最新推文。目前，此过程是在单击时启动的，使用 AJAX 和“for each”循环，该循环查找并显示包含在单独 php 页面中的正确推文。

尽管此过程运行良好，但一旦用户单击个人资料图像，应用程序加载所需的推文所需的时间太长了。我需要一些关于如何优化推文加载过程的建议？也许它可能不需要依赖于点击，但我只是不确定如何优化我的代码。

任何帮助将不胜感激。

这是帮助您理解的代码：

根据特定的个人资料图像启动最新推文的代码：

```
// Create all Tweeter objects
foreach ($tweeters as $i => $tweeter){
$tweeters[$i] = new Tweeter($tweeter, $tmhOAuth);
}

// Display all Tweeters
foreach ($tweeters as $tweeter){
$r+=1;
echo '<a class="fancybox fancybox.ajax" href="tweets.php #' . $r . '">';
echo '<img class="tweetTime' . $r . '" id="' . $r . '" src="' . $tweeter->getImage() . '" width="240px" height="240px" /></a>';
} 
```

在单独页面中获取推文的代码：

```
require_once('config/FrameFunctions.php');

foreach ($tweeters as $i => $tweeter){
$tweeters[$i] = new Tweeter($tweeter, $tmhOAuth);
}

foreach ($tweeters as $tweeter){
$r+=1;
echo '<div id="' . $r . '"><p>Latest tweet from <b>' . $tweeter->getName() . '</b>:<br />';

foreach ($tweeter->getTweets() as $tweet){
    echo $tweet['text'] . '<br />';
    echo "Sent: <b>" . $tweet['created_at'] . "</b></p></div>";
 }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:18:18.550

您需要将推文检索与用户点击分离。将 AJAX 移动到 JQuery ajax() 调用集以间隔运行。添加一个隐藏元素来保存最新的推文，并使用 AJAX 调用的结果对其进行更新。还要更改 fancybox 调用以使用隐藏元素的内容，而不是让 fancybox 进行 AJAX 调用。

主要HTML：

```
 <!DOCTYPE html>
    <html>
        <head>
            <title></title>
            <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
            <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
            <script src="scripts/jquery.fancybox.js"></script>
            <link rel="stylesheet" type="text/css" href="scripts/jquery.fancybox.css?v=2.1.4" media="screen" />
        </head>
        <body>

            <script type="text/javascript">
            $(document).ready(function() {

                         $('.fancybox').fancybox();
                /*
                 *  call ajax function and update latest
                 */     

                            var refreshTweets = function() {
                              console.log("updating..");
                              $.ajax({url:"updatetweets.php",success:function(result){
                                tweets = eval(result);
                                for(i=0;i<tweets.length;i++){
                                    $("#latesttweet"+(i+1)).html(tweets[i]);      
                                }

                              }});
                            }
                            //set the time in milliseconds here for each refresh
                            setInterval(refreshTweets , 30000); //Interval

                    });  
            </script>
    <?php

    //Setting up objects, you won't need this part
    $tweeters = array("one", "two", "three");
    $tmhOAuth = 0;
    $r =0;

    Class Tweeter{
        function __construct(){
            return array("bob", "sue", "derek");
        }

        function getImage(){
            return "images/turpin.gif";
        }
    }
    //end set up objects

     // Create all Tweeter objects
    foreach ($tweeters as $i => $tweeter){
        $tweeters[$i] = new Tweeter($tweeter, $tmhOAuth);
        }

        // Display all Tweeters
        foreach ($tweeters as $tweeter){
        $r+=1;
        echo '<a class="fancybox" href="#latesttweet' . $r . '">';
        echo '<img class="tweetTime' . $r . '" id="' . $r . '" src="' . $tweeter->getImage() . '" width="240px" height="240px" /></a>';
        echo '<span id="latesttweet'. $r .'" style="display: none;">Tweet text will go here</span>';
    }

    ?>

    </body>
    </html> 
```

更新推文代码（Ajax php）：

```
 <?php
    //Setting up objects, ignore this part
    $tweeters = array("bob", "sue", "derek");
    $tmhOAuth = 0;
    $r =0;

    Class Tweeter{
        private $thetweeter;

        function __construct($tweeter){
            $this->theTweeter =  $tweeter;
        }    

        function getTweet(){
            return $this->theTweeter  . "'s tweet at ". date('H:i:s') ;
        }
    }
    //end set up

    foreach ($tweeters as $i => $tweeter){
        $theTweeter = new Tweeter($tweeter, $tmhOAuth);
        $tweeters[$i] = $theTweeter->getTweet();
    }

    header("Content-type: application/json");
    echo json_encode($tweeters);
    ?> 
```

# java - VBO 性能和块

> ID：14782879
> 
> 赞同：4
> 
> 时间：2013-02-08T23:14:02.397
> 
> 标签：java, opengl, lwjgl, vbo

首先，我的代码没有经过优化。我也在使用旧的 glTranslatf() 和所有这些，因为我不知道新的做事方式。这是我的代码：

```
public class GenChunk {

Chunk c;
VBO vbo = new VBO();

int worldSize = 16;
int var4 = 16; // x
int var5 = 16; // z
int var6 = 16; // y

int xOffSet = 0;
int zOffSet = 0;

public GenChunk() {
    gen();
}

public void gen() {
    for (int x = xOffSet; x < worldSize; x++) {
        for (int z = zOffSet; z < worldSize; z++) {
            for (int y = 0; y < worldSize; y++) {
                glPushMatrix();
                glTranslatef(x, z, y);
                newChunk();
                glPopMatrix();
                xOffSet += 16;
                zOffSet += 16;
            }
        }
    }
}

private void newChunk() {

    vbo = new VBO();

    glBindBuffer(GL_ARRAY_BUFFER, vbo.vboVHandle);
    glVertexPointer(3, GL_FLOAT, 0, 0L);

    glBindBuffer(GL_ARRAY_BUFFER, vbo.vboCHandle);
    glColorPointer(3, GL_FLOAT, 0, 0);

    glEnableClientState(GL_VERTEX_ARRAY);
    glEnableClientState(GL_COLOR_ARRAY);
    for (int y = 0; y < var6; y++) {
        for (int x = 0; x < var5; x++) {
            for (int z = 0; z < var6; z++) {
                glPushMatrix();
                glTranslatef(x, z, y);
                glDrawArrays(GL_QUADS, 0, 24);
                glPopMatrix();
            }
        }

    }
    glDisableClientState(GL_VERTEX_ARRAY);
    glDisableClientState(GL_COLOR_ARRAY);
} 
```

}

和 VBO 类：

```
public class VBO {

public int vboVHandle;

public int vboCHandle;

public float size = 0.5f;
public float color = 0.5f;

public FloatBuffer vertices;
public FloatBuffer colorData;

public VBO(){

colorData = BufferUtils.createFloatBuffer(3 * 4 * 6);
colorData.put(new float[]{
        -color, color, color,
        color, color, color,
        -color, color, color,
        color, color, color,

        -color, color, color,
        color, color, color,
        -color, color, color,
        color, color, color,

        -color, color, color,
        color, color, color,
        -color, color, color,
        color, color, color,

        -color, color, color,
        color, color, color,
        -color, color, color,
        color, color, color,

        -color, color, color,
        color, color, color,
        -color, color, color,
        color, color, color,

        -color, color, color,
        color, color, color,
        -color, color, color,
        -color, color, color
});
colorData.flip();

vertices = BufferUtils.createFloatBuffer(3 * 4 * 6);
vertices.put(new float[] {
        -size, -size, size,
        size, -size, size,
        size, size, size,
        -size, size, size,

        -size, -size, -size,
        -size, size, -size,
        size, size, -size,
        size, -size, -size,

        -size, size, -size,
        -size, size, size,
        size, size, size,
        size, size, -size,

        -size, -size, -size,
        size, -size, -size,
        size, -size, size,
        -size, -size, size,

        size, -size, -size,
        size, size, -size,
        size, size, size,
        size, -size, size,

        -size, -size, -size,
        -size, -size, size,
        -size, size, size,
        -size, size, -size});
vertices.flip();

vboVHandle = glGenBuffers();
glBindBuffer(GL_ARRAY_BUFFER, vboVHandle);
glBufferData(GL_ARRAY_BUFFER, vertices, GL_DYNAMIC_DRAW);
glBindBuffer(GL_ARRAY_BUFFER, 0);

vboCHandle = glGenBuffers();
glBindBuffer(GL_ARRAY_BUFFER, vboCHandle);
glBufferData(GL_ARRAY_BUFFER, colorData, GL_DYNAMIC_DRAW);
glBindBuffer(GL_ARRAY_BUFFER, 0);

} 
```

我渲染出两个块，大约 8000 个立方体。我听说有人渲染 10,000 个立方体并仍然保持 60 FPS，但是当我渲染两个块时，我得到 1 FPS。我的硬件不是问题，它还不错。我知道我需要疯狂地优化我的代码，但我担心即使进行了优化，它仍然会很慢！谁能告诉我我在这里做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-09T05:05:14.667

使用带有*单个*立方体的 VBO 并`glTranslate()`围绕它进行旋转对您的表现毫无*帮助*。

给定块的 VBO 应包含多个立方体（在 16 ³处，最坏情况下棋盘体积最多为 2048）。您应该只`glTranslate()`在块级别发布 s，而不是在每个多维数据集中发布。

**编辑：**

你有你的卷数据库，通常存储在某种 3D 数组中。数组的每个元素都是一个类/结构（甚至只是一个`int`or `char`！），它保存着你的块类型信息（草、泥土、岩石等）和其他状态。您还需要一个这样的函数`bool IsOpaque( const BlockType& block)`，它可以告诉您给定的块是否在图形上不透明。

迭代给定块中的所有块。如果一个块`IsOpaque()`检查它的六个邻居（±X，±Y，±Z）。如果邻居`!IsOpaque()`为立方体的那一侧生成两个三角形（或一个四边形）的顶点（根据块中的位置适当地翻译（**而不是**通过`glTranslatef()`！））并将它们附加到缓冲区。

当您完成对块的迭代时，将顶点缓冲区上传到 VBO。

或者你可以变得更[漂亮](http://0fps.wordpress.com/2012/06/30/meshing-in-a-minecraft-game/)。

# c# - 实体框架 5 代码优先多对多表重命名与继承类 (TPC)

> ID：14782892
> 
> 赞同：3
> 
> 时间：2013-02-08T23:14:51.223
> 
> 标签：c#, entity-framework, inheritance, ef-code-first, entity-framework-migrations

好的，我在尝试指定连接表的名称时遇到了一些实体框架问题，如下所示：

```
// Used by a bunch of things...
public abstract BaseClass
{
    public int Id { get; set; }
    public string Name { get; set; }
}

public abstract ThingsBaseClass : BaseClass
{
    public virtual ICollection<Things> Things { get; set; }    
}

public First : ThingsBaseClass
{
    // This holds items of type First and doesn't have any other properties
}

public Second : ThingsBaseClass
{
    // This holds items of type Second and doesn't have any other properties
}

public Things
{
    public int Id { get; set; }
    public string Description { get; set; }

    // Many to Many
    public virtual ICollection<First> Firsts { get; set; }
    public virtual ICollection<Second> Seconds { get; set; }
} 
```

所以一切正常，除了表格如下：

```
First
FirstThings
Second
SecondThings
Things 
```

我正在尝试重命名为：

```
First
Second
ThingFirsts
ThingSeconds
Things 
```

尝试使用以下代码重命名它们会产生一些非常奇怪和随机的错误：

```
public class ThingConfiguration : EntityTypeConfiguration<Thing>
{
    HasMany(x => x.Firsts)
        .WithMany(x => x.Things)
         .Map(x => x.ToTable("ThingFirsts"));

    HasMany(x => x.Firsts)
        .WithMany(x => x.Things)
        .Map(x => x.ToTable("ThingSeconds"));    
} 
```

我正在尝试使用 Code First Migrations 来更新数据库（或者只是从头开始创建它）

错误包括以下一些：

`Schema specified is not valid. Errors: (28,6) : error 0040: Type Thing_First is not defined in namespace Project.Domain.Repositories (Alias=Self).`

或者

`Schema specified is not valid. Errors: (126,6) : error 0074: NavigationProperty 'Thing' is not valid. Type 'Project.Domain.Repositories.Second' of FromRole 'Thing_Firsts_Target' in AssociationType 'Project.Domain.Repositories.Thing_Second' must exactly match with the type 'Project.Domain.Repositories.First' on which this NavigationProperty is declared on.`

如果我摆脱 First 和 Second 的继承并直接放入，`Id`它就可以正常工作。`Name``ICollection<Thing> Things`

没有理由使用继承，除了我有大约 5 个具有几乎相同的`BaseClass`es 并希望使其保持干燥的对象。

我是否应该硬着头皮在任何地方重复代码以使其对实体框架更简单？

我错过了一些简单的东西吗？在使用继承类时我会遇到任何其他“问题”吗？

EF 6 对此有更好的支持吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T19:29:54.760

我只会在模型类定义上使用该属性。

```
[TableName("WhateverYouWant")]
public class First{} 
```

您可能需要考虑“优先组合优于继承”并将共享值视为属性而不是基类，并使用接口以多态方式处理它们。DRY 很重要，但对行为更重要。具有相同属性的两个对象不应自动生成基类，具有相同行为的两个类更有可能生成。继承和其他面向对象的方法论是关于规范化行为，而不是规范化数据和属性。毕竟实现相同接口的所有 2 个类将具有重复的属性定义；没关系。

# python - 在新线程上运行 python 程序

> ID：14782894
> 
> 赞同：2
> 
> 时间：2013-02-08T23:14:55.907
> 
> 标签：python

我有两个程序 program1.py 就像命令行界面，它从用户 program2.py 获取命令，具有根据命令运行相关程序的程序。

程序 1 也有一个 quit_program() 模块 在我们简单的宇宙中.. 假设我只有一个命令和一个程序 所以让我们说...

程序1.py

```
def main():
   while True:
        try:

            command = raw_input('> ')
            if command == "quit" :
                return

            if command == '':
                continue
        except KeyboardInterrupt:
            exit()

        parseCommand(command) 
```

然后我有：

```
 if commmand == "hi":
       say_hi() 
```

现在program2有

```
 def say_hi():
      #do something.. 
```

现在可能有两种情况...... say_hi() 完成，在这种情况下没有问题......但我想要的是，如果用户输入命令（比如：end），那么这个 say_hi() 将在两者之间终止......

但是我当前的实现是非常连续的..我的意思是在执行完成之前我不会在终端上输入任何内容.. Somethng 告诉我 say_hi() 应该在另一个线程上运行？

我无法直截了当地思考这个问题。有什么建议么？谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-08T23:18:35.690

线程模块是您正在寻找的。

```
import threading
t = threading.Thread(target=target_function,name=name,args=(args))
t.daemon = True
t.start() 
```

该`.daemon`选项使您不必在应用程序退出时显式终止线程......否则线程可能会非常讨厌

具体到这个问题和评论中的问题，`say_hi`可以在另一个线程中调用该函数，如下所示：

```
import threading
if commmand == "hi":
   t = threading.Thread(target=say_hi, name='Saying hi') #< Note that I did not actually call the function, but instead sent it as a parameter
   t.daemon = True
   t.start() #< This actually starts the thread execution in the background 
```

附带说明一下，您必须确保在线程内部使用线程安全函数。在打招呼的示例中，您可能希望使用日志记录模块而不是 print()

```
import logging
logging.info('I am saying hi in a thread-safe manner') 
```

您可以[在 Python 文档](http://docs.python.org/2/library/threading.html)中阅读更多内容。

# java - java - 解析一个aspx网站 - 发布参数

> ID：14782897
> 
> 赞同：0
> 
> 时间：2013-02-08T23:15:16.123
> 
> 标签：java, asp.net, html-parsing, http-post

我有我客户的电子商店，它是由另一家公司创建的。我想解析所有产品并将它们放在 xml 中。我知道如何到达每个“品牌”的第一页，但我很难通过参数来更改分页结果的页面。

这是指向一个品牌的电子商店“ [http://www.gialia.net.gr/P ​​roductCatalog/20/CAR.aspx”。](http://www.gialia.net.gr/ProductCatalog/20/CAR.aspx)

当我在 firefox 上使用 tamper-data 时，我看到当您想按结果的第二页时，会发布：

```
"__EVENTTARGET=ctl00%24wpmMain%24wp131820866%24wp512420601%24dpgTop%24ctl01%24ctl01" 
```

最后一个字符串：“ct101”表示转到第 2 页，如果我将其更改为 ct102，则转到第 3 页等。

但是我正在尝试将其创建为 GET 请求，因此我可以在我的 Java 代码中动态创建这些参数并解析每个响应。但是当我将网址创建为：

```
http://www.gialia.net.gr/ProductCatalog/20/CAR.aspx?__EVENTTARGET=ctl00$wpmMain$wp131820866$wp512420601$dpgTop$ctl01$ctl02 
```

我没有得到任何结果。

有人可以看看并给我一些建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T09:31:32.237

您在这里给我们的网站在搜索引擎（SEO）方面的设计非常糟糕，因此页面的解析太难了。

更改页面是回发，并且仅使用 javascript。因此，您必须执行相同操作才能移至目录的下一页，您需要使用所有参数对页面进行完整的回传。

现在，页面设计太糟糕了，程序员禁用了`__EVENTVALIDATION`控件可能是因为他不让他做错事，所以当你可以篡改数据时，你仍然需要回发。通过在 url 上简单输入一个参数，后面的代码不理解就是回发。您需要至少发送 Viewstate 和其余隐藏参数。

但是从您的客户端直接访问数据库并从那里读取它们不是更容易吗？

# asp.net - 页面名称：ASP.Net Web 表单站点，部署多种语言

> ID：14782899
> 
> 赞同：1
> 
> 时间：2013-02-08T23:15:21.780
> 
> 标签：asp.net, localization, web, webforms

对不起标题，想不出一个简单的好方法来描述它。关于这个问题...

我使用 Web 表单在 ASP.NET 中编写了一个站点，并使用资源文件来处理多种语言的静态文本，并且我们的数据库设置为多种语言，因此所有内容都已本地化。在 web.config 中切换文化和 uiCulture 就像在法语和英语之间切换网站一样简单。

但是，法语站点必须使用翻译成法语的文件夹和页面名称进行部署。例如，[http://www.product.com/accessories/category.aspx?id=111](http://www.product.com/accessories/category.aspx?id=111)需要为[http://www.produit.com/accesoires/categories.aspx?id=111](http://www.produit.com/accesoires/categories.aspx?id=111)

除了制作所有 ASPX 页面的副本（而不是背后的代码），将它们的名称更改为法语等价物并让它们的代码隐藏指向原始 aspx.cs ......什么是首选/正确/好方法做这个？

请注意：页面/代码中引用的 URL 本身是动态构建的，因此它们也将被本地化。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T00:14:01.630

您是否尝试过查看 asp.net 中的路由？[http://www.hanselman.com/blog/OneASPNETSneakPeekElegantWebFormsAndSnowballsInHell.aspx](http://www.hanselman.com/blog/OneASPNETSneakPeekElegantWebFormsAndSnowballsInHell.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:44:48.207

我不能使用路由，因为服务器正在运行 .NET 2.0，并且直到 3.5 SP1 才将路由引入框架。所以我不得不求助于 URL 重写。

在 web.config 我添加：

```
<system.web>
    <httpModules>
      <add name="UrlRewriter" type="Utilities.UrlRewriter, MyProject"/>
      ...

<system.webServer>
    <modules>
      <add name="UrlRewriter" type="Utilities.UrlRewriter, MyProject"/> 
```

然后我创建了继承 IHttpModule 的 UrlRewriter，并在 Init 方法中为 HttpApplication.BeginRequest 添加了一个处理程序。

在 BeginRequest 中，我检查 URL 并将本地化的文件夹名称和页面名称替换为对应的英文。例如*/mysite.com/a-propos-de-nous/*被转换为*/mysite.com/about-us/*但用户仍然在他们的浏览器中看到法语 URL。

需要进行一些检查来转换 URL，但它工作得很好，而且检查/替换并不可怕。

我有几个怪癖要弄清楚，如果 URL 以*/mysite.com/a-propos-de-nous*的形式出现（请注意末尾缺少的“/”），则重写有效，但浏览器地址栏中的 URL更改为不需要的*/mysite.com/about-us*。

如果有人在本地化 URL 方面有任何其他想法、评论或经验，请添加到线程中。

* * *

[编辑 - 2013 年 2 月 28 日] - RE：在浏览器中输入的 URL 中缺少尾部斜杠

添加它以使其更加完整，以防有人偶然发现它。

这里的问题是 IIS 添加了一个礼貌的斜杠，这会创建一个重定向。为了处理这种情况，我在这里所做的是检查 URL 并确定它是否在 URL 的末尾包含页面/文件。我在我的 Url 重写代码中使用以下内容：

```
 void UrlRewriter_BeginRequest(object sender, EventArgs e)
        {
           HttpApplication app = (HttpApplication)sender;

           ... // other rewrite code here

           string lastSegment = app.Request.Url.Segments[app.Request.Url.Segments.Length - 1];
           string extension = System.IO.Path.GetExtension(lastSegment);

           // no extension, must be a directory/folder
           if (string.IsNullOrEmpty(extension))
           {
               if (!sendTo.EndsWith("/"))
                   sendTo = sendTo + "/";
           }

           app.Context.RewritePath(sendTo);
        } 
```

# java - Android：如何处理按钮点击

> ID：14782901
> 
> 赞同：106
> 
> 时间：2013-02-08T23:15:28.310
> 
> 标签：java, android, onclicklistener, android-button

在非 Java 和非 Android 领域有扎实的经验，我正在学习 Android。

我对不同的领域有很多困惑，其中之一是如何处理按钮点击。至少有 4 种方法（！！！），它们在[这里简要列出](http://www.remwebdevelopment.com/dev/a69/Different-Ways-To-Handle-Clicks.html)

出于一致性目的，我将列出它们：

1.  在活动中拥有类的成员`View.OnClickListener`并将其分配给将处理活动方法`onClick`中的逻辑的实例。`onCreate`

2.  在 'onCreate' 活动方法中创建 'onClickListener' 并使用 setOnClickListener 将其分配给按钮

3.  在活动本身中实现“onClickListener”并将“this”指定为按钮的侦听器。对于活动按钮很少的情况，应分析按钮 ID 以执行正确按钮的“onClick”处理程序

4.  在实现“onClick”逻辑的活动上拥有公共方法，并将其分配给活动 xml 声明中的按钮

**问题一：**

这些都是方法吗，还有其他选择吗？（我不需要任何其他，只是好奇）

对我来说，最直观的方法是最新的方法：它需要输入的代码最少，并且可读性最高（至少对我而言）。

虽然，我没有看到这种方法被广泛使用。使用它有什么缺点？

**问题2：**

这些方法的优缺点是什么？请分享您的经验或良好的链接。

欢迎任何反馈！

PS我已经尝试谷歌并为这个主题找到一些东西，但我发现的唯一东西是描述“如何”做到这一点，而不是它为什么好或坏。

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2013-02-08T23:44:24.157

问题1：不幸的是，你说的最直观的那个是Android中使用最少的。据我了解，您应该将 UI（XML）和计算功能（Java 类文件）分开。它还使调试更容易。以这种方式阅读和思考 Android imo 实际上要容易得多。

问题2：我相信主要使用的两个是#2和#3。我将使用 Button clickButton 作为示例。

# 2

是匿名类的形式。

```
Button clickButton = (Button) findViewById(R.id.clickButton);
clickButton.setOnClickListener( new OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                ***Do what you want with the click here***
            }
        }); 
```

这是我最喜欢的，因为它在使用 findViewById 设置按钮变量的位置旁边有 onClick 方法。与此 clickButton 按钮视图相关的所有内容都位于此处，这看起来非常整洁。

我的同事评论的一个缺点是，假设您有许多需要 onclick 监听器的视图。你可以看到你的 onCreate 会变得很长。所以他喜欢用：

# 3

假设你有 5 个 clickButtons：

确保您的 Activity/Fragment 实现 OnClickListener

```
// in OnCreate

Button mClickButton1 = (Button)findViewById(R.id.clickButton1);
mClickButton1.setOnClickListener(this);
Button mClickButton2 = (Button)findViewById(R.id.clickButton2);
mClickButton2.setOnClickListener(this);
Button mClickButton3 = (Button)findViewById(R.id.clickButton3);
mClickButton3.setOnClickListener(this);
Button mClickButton4 = (Button)findViewById(R.id.clickButton4);
mClickButton4.setOnClickListener(this);
Button mClickButton5 = (Button)findViewById(R.id.clickButton5);
mClickButton5.setOnClickListener(this);

// somewhere else in your code

public void onClick(View v) {
    switch (v.getId()) {
        case  R.id.clickButton1: {
            // do something for button 1 click
            break;
        }

        case R.id.clickButton2: {
            // do something for button 2 click
            break;
        }

        //.... etc
    }
} 
```

正如我的同事解释的那样，这种方式在他看来更整洁，因为所有 onClick 计算都在一个地方处理，而不是拥挤 onCreate 方法。但我看到的缺点是：

1.  自己的看法，
2.  onClick 方法使用的任何其他可能位于 onCreate 中的对象都必须成为一个字段。

如果您想了解更多信息，请告诉我。我没有完全回答你的问题，因为这是一个很长的问题。如果我找到一些网站，我会扩展我的答案，现在我只是提供一些经验。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-08T23:29:34.610

**#1**当布局上有未生成的按钮（但显然是静态的）时，我经常使用最后一个。

如果您在实践和业务应用程序中使用它，请在此处特别注意，因为当您使用ProGuard 之类的[源混淆](http://en.wikipedia.org/wiki/Obfuscation_%28software%29)器时，您需要在您的活动中将这些方法标记为不被混淆。

要使用这种方法归档某种编译时安全性，请查看[Android Lint](http://tools.android.com/tips/lint)（[示例](http://codeisland.org/2012/android-targeting-system/#android-lint)）。

* * *

**#2***所有*方法的优缺点几乎相同，教训应该是：

> 使用对您来说最合适或感觉最直观的东西。

如果您必须将相同分配`OnClickListener`给多个按钮实例，请将其保存在类范围（#1）中。如果您需要一个简单的按钮侦听器，请进行匿名实现：

```
button.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View view) {
        // Take action.
    }
}); 
```

我倾向于不在`OnClickListener`活动中实现，这有时会有点令人困惑（尤其是当您实现多个其他事件处理程序并且没有人知道`this`都在做什么时）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-12-19T17:44:32.453

我更喜欢选项 4，但它对我来说很直观，因为我在 Grails、Groovy 和 JavaFX 方面做了太多工作。视图和控制器之间的“魔术”连接是普遍的。很好地命名方法很重要：

在视图中，将 onClick 方法添加到按钮或其他小部件：

```
 android:clickable="true"
    android:onClick="onButtonClickCancel" 
```

然后在类中，处理方法：

```
public void onButtonClickCancel(View view) {
    Toast.makeText(this, "Cancel pressed", Toast.LENGTH_LONG).show();
} 
```

再次，清楚地命名方法，无论如何你都应该做的事情，维护成为第二天性。

一大优势是您现在可以为该方法编写单元测试。选项 1 可以做到这一点，但 2 和 3 更难。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-02-08T23:32:27.897

最常用的方式是匿名声明

```
 Button send = (Button) findViewById(R.id.buttonSend);
    send.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            // handle click
        }
    }); 
```

您也可以创建 View.OnClickListener 对象并稍后将其设置为按钮，但您仍然需要覆盖 onClick 方法，例如

```
View.OnClickListener listener = new View.OnClickListener(){
     @Override
        public void onClick(View v) {
            // handle click
        }
}   
Button send = (Button) findViewById(R.id.buttonSend);
send.setOnClickListener(listener); 
```

当您的活动实现 OnClickListener 接口时，您必须在活动级别覆盖 onClick(View v) 方法。然后您可以将此活动作为按钮的侦听器，因为它已经实现了接口并覆盖了 onClick() 方法

```
public class MyActivity extends Activity implements View.OnClickListener{

    @Override
    public void onClick(View v) {
        // handle click
    }

    @Override
    public void onCreate(Bundle b) {
        Button send = (Button) findViewById(R.id.buttonSend);
        send.setOnClickListener(this);
    }

} 
```

（恕我直言）当多个按钮具有相同的处理程序时使用的第 4 种方法，您可以在活动类中声明一个方法并将此方法分配给 xml 布局中的多个按钮，您也可以为一个按钮创建一个方法，但在这种情况下我更喜欢在活动类中声明处理程序。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-05-08T10:18:41.610

为了使问题2更容易，您可以使用像这样的lambda方法来节省变量内存并避免在视图类中上下导航

```
//method 1
findViewById(R.id.buttonSend).setOnClickListener(v -> {
          // handle click
}); 
```

但是如果您希望在方法中一次将点击事件应用于您的按钮。

你可以利用@D的问题3。特兰回答。但不要忘记用`View.OnClickListener`.

在其他正确使用问题#3

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-08T23:29:37.317

选项 1 和 2 涉及使用内部类，这会使代码变得混乱。选项 2 有点混乱，因为每个按钮都会有一个侦听器。如果您的按钮数量很少，这没关系。对于选项 4，我认为这将更难调试，因为您将不得不返回和第四个 xml 和 java 代码。当我必须处理多个按钮点击时，我个人使用选项 3。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-08-03T16:39:09.423

我的示例，在 Android Studio 2.1 中测试

**在xml布局中定义按钮**

```
<Button
    android:id="@+id/btn1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" /> 
```

**Java脉动检测**

```
Button clickButton = (Button) findViewById(R.id.btn1);
if (clickButton != null) {
    clickButton.setOnClickListener( new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            /***Do what you want with the click here***/
        }
    });
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-08T23:29:24.227

问题#1 - 这些是处理视图点击的唯一方法。

问题#2 -
选项#1/选项#4 - 选项#1 和选项#4 之间没有太大区别。我看到的唯一区别是在一种情况下活动是实现 OnClickListener，而在另一种情况下，会有一个匿名实现。

选项#2 - 在此方法中将生成一个匿名类。这种方法有点麻烦，因为如果你有多个按钮，你需要多次这样做。对于匿名类，您必须小心处理内存泄漏。

选项#3 - 不过，这是一种简单的方法。通常，程序员在编写任何方法之前都尽量不使用它，因此这种方法没有被广泛使用。您会看到大多数人使用 Option#4。因为它在代码方面更干净。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-04-18T10:44:36.947

**第 1 步：创建 XML 文件：**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical">

    <Button
        android:id="@+id/btnClickEvent"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Click Me" />
</LinearLayout> 
```

**第 2 步：创建 MainActivity：**

```
package com.scancode.acutesoft.telephonymanagerapp;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;

public class MainActivity extends Activity implements View.OnClickListener {

    Button btnClickEvent;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        btnClickEvent = (Button) findViewById(R.id.btnClickEvent);
        btnClickEvent.setOnClickListener(MainActivity.this);

    }

    @Override
    public void onClick(View v) {
        //Your Logic
    }
} 
```

**快乐编码！**

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-06-04T01:55:43.483

还有一些以各种库的形式提供的选项，可以使使用过其他 MVVM 框架的人非常熟悉这个过程。

[https://developer.android.com/topic/libraries/data-binding/](https://developer.android.com/topic/libraries/data-binding/)

显示了一个官方库的示例，它允许您像这样绑定按钮：

```
<Button
    android:text="Start second activity"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:onClick="@{() -> presenter.showList()}"
/> 
```

# assembly - 汇编 I/O 编程

> ID：14782902
> 
> 赞同：1
> 
> 时间：2013-02-08T23:15:28.557
> 
> 标签：assembly, x86, usb, dos, parallel-port

我已经学习了一些汇编代码，并且还了解到互联网上没有那么多好的教程。我想知道向某些设备发送信号
**。并行端口，USB（也许）**
我想知道是否有任何人可以共享任何代码来引导我朝着正确的方向前进。如果你不知道信号，我的意思是发出电压。

所以总结一下，我想知道如何通过程序集与某些端口进行交互，

我目前正在使用 DosBox 运行程序集，并使用平面汇编程序进行编程。这一切都在窗口 8 上运行。

在此先感谢 36redsoxfan

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:26:17.627

我不是 fasm 专家……但是，根据这篇文章……这可能适合也可能不适合 fasm...

[http://board.flatassembler.net/topic.php?t=8638](http://board.flatassembler.net/topic.php?t=8638)

将您的 BIOS 设置为双向并行端口模式 (SPP)

**这将设置 I/O 权限：**

```
mov eax,101                      ; SYS_IOPERM 
mov ebx,Base_Parallel         ; 378H 
mov ecx,Size                      ; 3 
mov edx,1                         ; Turn ON 
int 80H 
test eax,eax 
js Error_Set_IO 
```

**来写：**

```
mov dx,37ah 
in al,dx 
and al,11011111b             ; reset bit 5 ( Write mode) 
out dx,al   

mov al,0ffh                         ; turn on all 8 pin 
mov dx,378h 
out dx,al                           ; Write byte 
```

**读书：**

```
mov dx,37ah 
in     al,dx 
or     al,00100000b          ; set bit 5 ( Read mode) 
out   dx,al 

mov dx,378h 
in    al,dx                        ; Read byte 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T06:43:39.830

如前所述，这完全是使用 in 和 out 将正确的位写入正确的端口的问题。最大的问题是，如果你在 Windows 机器上以用户模式运行，你将没有足够的权限让你这样做——你需要作为内核模式驱动程序运行（即使那样你可能调用操作系统提供的接口，而不是进行汇编级硬件访问）。我自己没有使用过 DosBox，但一般来说，像这样的模拟器只会*模拟*对底层硬件的访问 - 因此它可能允许您写入模拟的并行端口，但这实际上不会改变硬件上的电压电平并行端口 - 这仍然受 Windows 限制..

然后，您的选择取决于您到底想做什么。一些可能的选择：

*   如果你只是想玩组装访问硬件，但不需要*实际*访问物理硬件，那么你可能会找到一个模拟器，它至少可以模拟一些硬件，并向你展示你在这个模拟硬件上的组装操作的结果.
*   如果您想在 Windows 环境中使用程序集访问物理硬件，那么您可能需要环顾四周，看看是否有任何模拟器使用 Windows 驱动程序将您的命令传递给物理硬件，而不仅仅是模拟设备。
*   如果您想使用 Windows 环境之外的程序集访问物理硬件，那么您只需要找到一个操作系统或引导加载程序，它允许您的程序集代码直接访问硬件。
*   如果它不必组装，那么还有其他可用选项（这是我过去在 Windows 环境中使用并行端口时所走的路径）。

# git - 如何从“git filter-branch”获取旧的->新的重写提交 SHA 列表？

> ID：14782906
> 
> 赞同：14
> 
> 时间：2013-02-08T23:15:50.300
> 
> 标签：git, git-filter-branch

运行后`git filter-branch`，如何获得由 filter-branch 重写为新的相应提交 SHA 的旧提交 SHA 列表？

例如，类似于：

```
b19fd985746c1f060f761d42d353e387bec243fb -> c8ab40ef9bae3b58642a8d1e5b90720d093a60b5
c5ebba1eeb92ca76c0effa32de14178ec7f07db6 -> 4d5a9958b98dbcfa47ce1354bb2af4cc77904639
705f71543235b872ca3e1067538e36d14044429d -> d2aafbd6e5b91955b62dee34f4a0abf0171ba016 
```

其中左列是原始 SHA 列表，右列是经过 filter-branch 重写后的新 SHA。

我看到filter-branch的[手册页](http://www.kernel.org/pub/software/scm/git/docs/git-filter-branch.html#_filters)`map`提到了一个函数，但我不明白这在这里是否有用，或者如果有用，如何使用它。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-09T00:09:26.730

我不得不四处寻找源头`git-filter-branch`才能解决这个问题。它没有记录（据我所知），但旧的提交 ID 明确导出为`$GIT_COMMIT`. 这对我有用：

```
$ git filter-branch --your-filters-here --commit-filter 'echo -n "${GIT_COMMIT}," >>/tmp/log; git commit-tree "$@" | tee -a /tmp/log' your-branch-here
[...]
$ cat /tmp/log
70d609ba7bc58bb196a2351ba26afc5db0964ca6,d9071b49743701c7be971f76ddc84e76554516c7
0d1146dcabc00c45fb9be7fe923c955f7b6deb50,cb6813f9aca5e5f26fcc85007c5bb71552b91017
[...] 
```

（当然，该文件具有格式`<original commit hash>,<new commit hash>`。）

不过，我很好奇您使用它的意图是什么。如果您以“正确”的方式使用过滤器分支（即，不操纵现有的已发布历史），您通常不需要知道的信息。

# sql - 如何使用 EXECUTE IMMEDIATE 语句更正 PL/SQL 脚本中的 ORA-00904 错误？

> ID：14782913
> 
> 赞同：1
> 
> 时间：2013-02-08T23:16:10.743
> 
> 标签：sql, oracle

下面是确定表是否存在然后删除/创建表的 PL/SQL 脚本。如果它不存在，无论如何都要创建表。因此，当我运行脚本时，我收到以下信息：

> ORA-00904: "E": 无效标识符

我认为语法是准确的，双引号的“E”是正确的，但显然不是。请指教。

谢谢。

```
DECLARE 

  l_cnt NUMBER;

BEGIN
  SELECT COUNT(*)
    INTO l_cnt
    FROM dba_tables
   WHERE owner = 'ABCD'
     AND table_name = 'SEC_REC_TEMP';

  IF( l_cnt > 0 )
  THEN
     EXECUTE IMMEDIATE 'DROP TABLE sec_rec_temp';
     EXECUTE IMMEDIATE 'CREATE TABLE sec_rec_temp 
                        AS
                        SELECT is.inv_num
                          FROM abcd.inv_summ is
                              ,abcd.bill_fee bf
                         WHERE is.inv_num = bf.inv_num
                           AND trim(bf.fee_type) = "E"
                         GROUP BY is.inv_num';
  ELSE
     EXECUTE IMMEDIATE 'CREATE TABLE sec_rec_temp 
                        AS
                        SELECT is.inv_num
                          FROM abcd.inv_summ is
                              ,abcd.bill_fee bf
                         WHERE is.inv_num = bf.inv_num
                           AND trim(bf.fee_type) = "E"
                         GROUP BY is.inv_num';
  END IF;
END;
/ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T23:21:10.317

首先，删除和重新创建表的 PL/SQL 脚本非常可疑。例如，您真的确定不想创建一个只需定期刷新的物化视图吗？在 PL/SQL 中执行 DDL 几乎总是一种糟糕的方法。如果您可以解释您要解决的业务问题，我们可能会为您提供更好的技术解决方案。

其次，如果要在PL/SQL中对字符串中的单引号进行转义，则需要使用两个连续的单引号。不是一个双引号字符。

```
DECLARE 
  l_cnt NUMBER;
BEGIN
  SELECT COUNT(*)
    INTO l_cnt
    FROM dba_tables
   WHERE owner = 'ABCD'
     AND table_name = 'SEC_REC_TEMP';

  IF( l_cnt > 0 )
  THEN
     EXECUTE IMMEDIATE 'DROP TABLE sec_rec_temp';
     EXECUTE IMMEDIATE 'CREATE TABLE sec_rec_temp 
                        AS
                        SELECT is.inv_num
                          FROM abcd.inv_summ is
                              ,abcd.bill_fee bf
                         WHERE is.inv_num = bf.inv_num
                           AND trim(bf.fee_type) = ''E''
                         GROUP BY is.inv_num';
  ELSE
     EXECUTE IMMEDIATE 'CREATE TABLE sec_rec_temp 
                        AS
                        SELECT is.inv_num
                          FROM abcd.inv_summ is
                              ,abcd.bill_fee bf
                         WHERE is.inv_num = bf.inv_num
                           AND trim(bf.fee_type) = ''E''
                         GROUP BY is.inv_num';
  END IF;
END; 
```

或者，您可以使用 q 引用语法

```
DECLARE 
  l_cnt NUMBER;
BEGIN
  SELECT COUNT(*)
    INTO l_cnt
    FROM dba_tables
   WHERE owner = 'ABCD'
     AND table_name = 'SEC_REC_TEMP';

  IF( l_cnt > 0 )
  THEN
     EXECUTE IMMEDIATE 'DROP TABLE sec_rec_temp';
     EXECUTE IMMEDIATE q'[CREATE TABLE sec_rec_temp 
                        AS
                        SELECT is.inv_num
                          FROM abcd.inv_summ is
                              ,abcd.bill_fee bf
                         WHERE is.inv_num = bf.inv_num
                           AND trim(bf.fee_type) = 'E'
                         GROUP BY is.inv_num]';
  ELSE
     EXECUTE IMMEDIATE q'[CREATE TABLE sec_rec_temp 
                        AS
                        SELECT is.inv_num
                          FROM abcd.inv_summ is
                              ,abcd.bill_fee bf
                         WHERE is.inv_num = bf.inv_num
                           AND trim(bf.fee_type) = 'E'
                         GROUP BY is.inv_num]';
  END IF;
END; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T23:22:33.307

您需要用另一个单引号转义单引号

```
 AND trim(bf.fee_type) = ''E'' 
```

# html - 如何使用 css 创建一个仅识别当前最顶层容器滚动的滚动条？

> ID：14782915
> 
> 赞同：0
> 
> 时间：2013-02-08T23:16:25.277
> 
> 标签：html, css

我有两个容器。最底部的一个创建了一个滚动条，因为它的高度足够需要它。当最顶部的容器在最底部的容器 id 上方可见时，例如滚动条，**仅**适用于该容器。现在滚动影响底部和顶部容器。你怎么做呢？谢谢！

这是正在发生的事情的代码：http: [//jsfiddle.net/5wNDX/68/](http://jsfiddle.net/5wNDX/68/)

CSS：

```
#outer {
background-color: rgba(255, 255, 255, 0);
bottom: 0px;
color: rgb(51, 51, 51);
display: block;
font-size: 14px;
height: 563px;
left: 0px;
overflow-x: auto;
overflow-y: scroll;
position: fixed;
right: 0px;
top: 0px;
width: 1479px;
z-index: 9999;
}

#inner {
background-color: rgb(255, 255, 255);
border:4px solid #000;
color: rgb(51, 51, 51);
display: block;
font-size: 14px;
height: 900px;
margin:0 auto;
overflow-x: hidden;
overflow-y: hidden;
position: static;
width: 750px;
z-index: auto;
} 
```

HTML：

```
<body> 
    <div>Large block of text</div>
    <div id='outer'>   
      <div id='inner'>
        test
      </div>   
    </div>
  </body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:18:54.053

你可能需要给`position: absolute`你的`#inner`div 来完成这个。

# c - 使用 fork 和 exec 执行程序

> ID：14782919
> 
> 赞同：0
> 
> 时间：2013-02-08T23:16:47.713
> 
> 标签：c

我是 C 编程新手。我正在尝试运行由用户使用 、 和 命令指定的路径给出`fork()`的`exec()`程序`waitpid()`。我一直试图让它正确运行几个小时，但我不断收到错误，我不知道如何排除故障，一旦我解决了一个错误，就会出现新的错误。我想知道是否有人可以帮助我理解为什么我的实施不能顺利进行？

非常感谢

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

int main(void)  {
    char command1[256], command2[256], path[556];
    printf("# ");
    scanf("%s", command1);
    scanf("%s", command2);
    scanf("%s", path);
    if(strcmp(command1,"quit")==0)
        exit(0);
    else if(strcmp(command1, "run")==0 && strcmp(command2, "command")==0){

            printf("%s", path);

            pid_t process;

            process = fork();

            //fork error
            if (process < 0){
               perror("fork");
               exit(0);
            }
            else if (process > 0){  //this is the parent process
               execl(path, "sh" , "-c", ":ls -l *.c", 0);
            }
            else {//this is the child process
               waitpid(process); //waits until the program terminates 
            }

    }

return 0;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:22:34.593

在我看来，您好像交换了一些东西。使用 fork/exec，您通常在子进程中执行 exec，在父进程中执行 waitpid。

# git - 在 .bash_profile 中配置 git 自动完成

> ID：14782920
> 
> 赞同：0
> 
> 时间：2013-02-08T23:17:03.437
> 
> 标签：git, autocomplete, .bash-profile, nano

我无法将 git 自动完成安装到我的 bash 配置文件中。我附上了一个版本的 bash 脚本。有谁知道为什么当我保存并退出 nano 时，我在 git 中的自动完成功能不起作用？谢谢！ ![在此处输入图像描述](../Images/5acfd42b9c6b7409374c83595c2e3dd0.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:25:04.403

您需要注销并重新登录以强制 .bash_profile 运行。

或尝试它是否立即工作，运行

源 ~/.git-completion.bash

source ~/.bash_profile 也可以

# python - 从 Rails 服务器排队 Python 后台作业

> ID：14782921
> 
> 赞同：1
> 
> 时间：2013-02-08T23:17:06.087
> 
> 标签：python, ruby-on-rails, ruby, queue, jobs

我有一个基于 Ruby On Rails 应用程序的 Web 前端，可将数据插入 Postgresql 数据库。当数据库获得新数据时，应使用 Numpy/Scipy 脚本对其进行分析。有没有一种简单的方法可以使用 Ruby 对 Python 后台作业进行排队？

我猜的一种方法是使用[Resque](https://github.com/defunkt/resque)（或其他一些 Ruby 作业队列系统）来处理 Ruby 后台脚本，该脚本再次使用命令行调用 Python 脚本。还有其他（更好的）选择吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T23:26:20.017

在 Python 和 Ruby 之间使用[beanstalkd](http://kr.github.com/beanstalkd/)共享数据对你有用吗？

喜欢

```
#ruby
insert into DB my-data
put my-data onto shared-queue 
```

然后

```
#python 
while True:
   take my-data from shared-queue 
   process my-data
   put did-process-data on shared-queue 
```

这将节省 Ruby 调用 Python 或反之亦然，但我不确定您是否需要事务完整性等。

# c++ - 在 Mac OS X 上使用 SWIG 编译 C++

> ID：14782925
> 
> 赞同：22
> 
> 时间：2013-02-08T23:17:21.300
> 
> 标签：c++, macos, g++, shared-libraries, swig

我正在尝试使用 Swig for Mac OS X 编译 C++ 扩展。不过，我遇到了一些链接器错误。Python Swig 的基本教程在 Mac 上似乎也失败了：

[http://www.swig.org/Doc1.3/Python.html#Python_nn10](http://www.swig.org/Doc1.3/Python.html#Python_nn10)

```
swig -c++ -python example.i
g++ -O2 -fPIC -c example.cxx
g++ -O2 -fPIC -c example_wrap.cxx -I/usr/include/python2.6
g++ -shared example.o example_wrap.o -o _example.so 
```

前三行工作正常。最后一行因链接器错误而失败。我用这个在 OS X 上尝试了最后一行，得到了同样的错误：

```
g++ -dynamiclib example.o example_wrap.o -o _example.so 
```

最后一行的错误是：

```
Undefined symbols for architecture x86_64:
  "_PyArg_ParseTuple", referenced from:
      __wrap_fact in example_wrap.o
  "_PyArg_UnpackTuple", referenced from:
      _SwigPyObject_own in example_wrap.o
  "_PyBool_FromLong", referenced from:
      _SwigPyObject_richcompare in example_wrap.o
      _SwigPyObject_own in example_wrap.o
...
ld: symbol(s) not found for architecture x86_64
collect2: ld returned 1 exit status 
```

谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-09T19:52:50.963

为了完整性——感谢Petesh。

```
swig -c++ -python example.i
g++ -O2 -fPIC -c example.cxx
g++ -O2 -fPIC -c example_wrap.cxx -I/usr/include/python2.6
g++ -lpython -dynamiclib example.o example_wrap.o -o _example.so 
```

# signal-processing - HMM - 训练数据和格式

> ID：14782933
> 
> 赞同：1
> 
> 时间：2013-02-08T23:18:38.830
> 
> 标签：signal-processing, speech-recognition, hidden-markov-models, mfcc

我想实现一个 HMM（隐马尔可夫模型）来识别特定的单词。到目前为止，我已经设法提取了信号的系数 (MFCC)，并想知道这是否是训练 HMM 的好数据？

此外，训练 HMM 的格式（如下）是否正确？

格式：

对于每个样本，都有一系列 MFCC 系数，我提供了其中两个样本作为示例...

`-13.8033 0.645476 3.2174 -0.625136 -0.470134 -2.96368 0.701151 0.464246 1.1898 -1.88515 0.0805242 0.311573 0.732487`

`-19.4252 -5.65454 0.853437 0.317219 0.146167 -1.93742 0.381944 -2.01793 -0.561144 -0.896783 -0.105491 -1.06504 -0.797318`

希望有人可以提供帮助:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-20T19:33:22.857

你可以有两种方法。

一种是对这些向量进行向量量化，以便将连续 MFCC 向量转换为 HMM 的离散观测值。

其他是使用连续方法在 HMM 中进行训练。你可以在这个线程中看到更多：

[从零开始的简单语音识别](https://stackoverflow.com/questions/23486554/simple-speech-recognition-from-scratch)

# postgresql - 如何在学说 2.2 中对 gin postgres 索引执行全文搜索？

> ID：14782941
> 
> 赞同：0
> 
> 时间：2013-02-08T23:19:25.350
> 
> 标签：postgresql, symfony, doctrine, full-text-search, gwt-gin

在教义中是否有一种简单的方法可以做到这一点，还是我必须进行本机 sql 查询？如果有人能指出我正确的方向，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-11T14:14:15.103

快速回答是，不。没有这样做的“简单方法”。

你需要使用 Doctrine Native SQL 可以在[这里](https://doctrine-orm.readthedocs.org/en/latest/reference/native-sql.html?highlight=native%20sql)找到。这将允许您将结果映射到可用的实体中，就像您在使用数据库特定的东西时所习惯的那样。

[您还可以使用此处](http://docs.doctrine-project.org/en/2.0.x/cookbook/dql-user-defined-functions.html)描述的 DQL 用户定义函数。这可能是“正确”的方式。

# emacs - Emacs Lisp 唯一的窗口名称，用于拆分识别和删除

> ID：14782946
> 
> 赞同：1
> 
> 时间：2013-02-08T23:20:13.203
> 
> 标签：emacs, lisp

我正在尝试唯一标识一个窗口，以便在我再次按下某个键时可以选择并删除该窗口，尽管我在执行此操作时遇到了麻烦。

```
(setq split-window-right-toggle-var nil)

(defun split-window-right-toggle ()
  (interactive)
  (if split-window-right-toggle-var 
      (progn
        (right-split-undo)
        (setq split-window-right-toggle-var nil))
    (progn
      (right-split-do)
      (setq split-window-right-toggle-var t))))

(defun right-split-do ()
  (interactive)
  (split-window-right)
  (other-window 1))

(defun right-split-undo ()
  (interactive)
  (other-window -1)
  (delete-window)) 
```

这段代码的问题在于它在很大程度上取决于哪个窗口处于活动状态，因为可以更改我的窗口的状态并删除错误的窗口，我可以唯一地给我的窗口一个名称，然后以该窗口名称为目标进行删除吗？我是 Emacs lisp 的新手，如果有任何帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T09:27:32.617

`(selected-window)`返回对当前窗口的引用。

`(next-window)`返回下一个窗口。使用 Emacs 的自我记录功能来了解更多信息或参考手册。

## 这是我将如何编写您的命令

```
(defvar ej-spit-window-saved nil)

(defun ej-split-window-right-toggle ()
  "toggle split right"
  (interactive)
  (setq ej-split-window-saved
        (if (and ej-split-window-saved
                 (frame-visible-p (window-frame ej-split-window-saved)))
            (delete-window ej-split-window-saved)
          (split-window-right)))) 
```

## 笔记

*   前缀函数/变量以便于调试。
*   记录代码永远不会太早。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T13:07:48.177

你可以尝试这样的事情：

```
(setq window-names (make-hash-table :test 'equal ))                                                                                                  

(defun name-window ()                                                                                                                                
  (interactive)                                                                                                                                      
  (let ((name (read-input "Name: ")))                                                                                                                
    (setf (gethash name window-names) (selected-window))))                                                                                           

(defun del-window ()                                                                                                                                 
  (interactive)                                                                                                                                      
  (let ((name (read-input "Name: ")))                                                                                                                
    (delete-window (gethash name window-names)))) 
```

# c# - 创建动态字符串名称并在 C# 中设置值

> ID：14782947
> 
> 赞同：1
> 
> 时间：2013-02-08T23:20:20.467
> 
> 标签：c#, asp.net-mvc

我有一个字符串列表，例如：

```
public string TypeOrig { get; set; }
public string TypeAdj { get; set; }
public string TypeClass { get; set; }
public string TypeMsg { get; set; }
public string QtyOrig { get; set; }
public string QtyAdj { get; set; }
public string QtyClass { get; set; }
public string QtyMsg { get; set; } 
```

根据数据库中的行，我填充这样的字符串：

```
switch(fRow["fieldName"].ToString())
{
    case "partType":
        TypeOrig = fRow["original"].ToString();
        TypeAdj = fRow["adjusted"].ToString();
        TypeClass = fRow["status"].ToString();
        TypeMsg = fRow["message"].ToString();
        break;
    case "qty":
        QtyOrig = fRow["original"].ToString();
        QtyAdj = fRow["adjusted"].ToString();
        QtyClass = fRow["status"].ToString();
        QtyMsg = fRow["message"].ToString();
        break;
} 
```

我想把它减少到这样的事情：

```
switch(fRow["fieldName"].ToString())   
    case "partType": fieldName = "Type";
        break;
    case "qty": fieldName = "Qty";
        break;
}
fieldName + "Orig" = fRow["original"].ToString();
fieldName + "Adj" = fRow["adjusted"].ToString();
fieldName + "Class" = fRow["status"].ToString();
fieldName + "Msg" = fRow["message"].ToString(); 
```

附加信息：

1.  db中的字段名有一些例外，所以我不能简单地使用字段名而必须使用开关。
2.  我还必须为数据库中的几个字段填充一些非标准字符串。
3.  我目前有 32 个字段名称并且可以增长，因此减少代码长度将使其更易于管理。（@Servy 的方法将其减少到 19）
4.  生成的字符串在视图中使用。

如何动态设置字符串名称并填充它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T00:43:28.437

你应该重构你的对象。每当您看到自己为一堆字段/属性添加前缀时，它通常会引起您的注意，您应该创建一个新类型来表示这种数据。

```
public class Foo //TODO give meaningful name
{
    //I changed the abbreviations to real words.  If I was wrong, please fix, but
    //as a rule try to avoid overuse of abbreviations in variable names; 
    //it makes code harder to read.
    public string Original { get; set; }
    public string Adjacent { get; set; }
    public string Class { get; set; }
    public string Message{ get; set; }
} 
```

现在回到您的第一种类型，我们可以拥有：

```
public class MyClass //TODO fix name
{
    public Foo Type {get;set;}
    public Foo Quality {get;set;}
} 
```

现在我们有两个相同类型的对象，我们可以分离出填充对象并将该对象放入的代码`MyClass`：

```
Foo foo = new Foo()
{
    Original = fRow["original"].ToString(),
    Adjacent = fRow["adjusted"].ToString(),
    Class = fRow["status"].ToString(),
    Message= fRow["message"].ToString(),
};

switch(fRow["fieldName"].ToString())
{
    case "partType":
        Type = foo;
        break;
    case "qty":
        Quality = foo;
        break;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T23:27:58.483

似乎是一个很好的用例`Dictionary<string, string>`

例如

```
Dictionary<string, string> fieldValues = new Dictionary<string, string>();
fieldValues.Add("TypeOrig", string.Empty);
fieldValues.Add("TypeAdj", string.Empty);
fieldValues.Add("TypeClass", string.Empty);
fieldValues.Add("TypeMsg", string.Empty);
fieldValues.Add("QtyOrig", string.Empty);
fieldValues.Add("QtyAdj", string.Empty);
fieldValues.Add("QtyClass", string.Empty);
fieldValues.Add("QtyMsg", string.Empty);

....

switch(fRow["fieldName"].ToString())   
{
    case "partType": fieldName = "Type";
        break;
    case "qty": fieldName = "Qty";
        break;
    default: fieldName = string.Empty;
        break;
}
if(fieldName.Length > 0)
{
    fieldValues[fieldName + "Orig"] = fRow["original"].ToString();
    fieldValues[fieldName + "Adj"] = fRow["adjusted"].ToString();
    fieldValues[fieldName + "Class"] = fRow["status"].ToString();
    fieldValues[fieldName + "Msg"] = fRow["message"].ToString();
} 
```

当然，这种变化需要重写直接使用字符串变量的代码，但它有很多优点。只有一个变量，新键的可扩展性，更面向对象，许多适用于字典的功能，Linq 的可扩展性......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T23:32:21.193

使用字典作为属性的后备存储。

# javascript - 从 JavaScript 调用 Objective C 方法的最简单方法（没有插件）？

> ID：14782948
> 
> 赞同：0
> 
> 时间：2013-02-08T23:20:23.817
> 
> 标签：javascript, iphone, objective-c, cordova

我知道周围有很多这样的问题，但我的问题似乎与其他问题略有不同。我真正想做的就是**从 javascript 调用一个客观的 C 方法**。[我确信有一种方法可以做到这一点，而不必像许多答案和教程](http://ramkulkarni.com/blog/calling-objective-c-function-from-javascript-in-ios-applications/)中所建议的那样来回发送参数。这样做的目的是让我的 phonegap 应用程序的用户能够单击 HTML 按钮来**隐藏状态栏**。为此，我必须**找到一种方法来告诉我的应用程序运行我的目标 C 方法**：`HideStatusBar`

```
-(void) HideStatusBar {
  [[UIApplication sharedApplication] setStatusBarHidden:NO withAnimation:UIStatusBarAnimationSlide];
} 
```

我不想发送任何参数，我要求你向我解释的是如何告诉 obj c 从 javascript 进行方法调用。我知道一种解决方案是**将参数设置到 webviews 地址字段中**，然后通过 obj C 获取，但我确信在我的情况下有更简单的解决方案。

我开始**尝试编写一个 phonegap 插件**，但我*从来没有得到“消息越过”到“另一边”*，因此目标 C 中的方法调用由于某种原因从未发生过。如果您愿意，我可以在此处发布代码，但我认为必须有一个更简单的解决方案。

任何人都可以向我解释**从 javascript 中调用 obj c 方法的最简单方法**吗？

## 编辑

我得到了这个工作，但`shouldStartLoadWithRequest`唯一在第一次加载 webview 时被调用（如标题所示）。这意味着如果我更新 URL，则不会调用该方法。这就是我现在的做法：

**Javascript**

```
('#hideStatusBar').live('click',function(event) {
    window.history.pushState('page2', 'Title', '/doc.html://hideStatusBar');
}); 
```

**目标 C**

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request
 navigationType:(UIWebViewNavigationType)navigationType {

//NSString *currentURL = request.URL.absoluteString;

if([request.URL.absoluteString isEqualToString:@"http://domain.com/doc.html://hideStatusBar"]){
    [[UIApplication sharedApplication] setStatusBarHidden:YES withAnimation:UIStatusBarAnimationSlide];
    return NO;
}
return YES;
} 
```

如前所述，我希望每次通过 javascript 更新 HTML 文档的 URL 时都运行此方法。还有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T00:04:24.443

最简单但我认为错误的方法是使用 UIWebViewDelegate 方法 shouldStartLoadWithRequest。

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request
                                                 navigationType:(UIWebViewNavigationType)navigationType {
    //suppose you call yourApp://hideStatusBar
    if([request.url.absoluteString isEqualToString:@"yourApp://hideStatusBar"]){
        [self hideStatusBar];
        return NO;
    }
    return YES; 
} 
```

来自 javascript

```
document.location = 'yourApp://hideStatusBar' 
```

如果您已经使用 Cordova(Phonegap)，您可以构建一个简单的插件来避免弄乱请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T00:05:48.730

示例中的教程有正确的想法。你做你自己的快速 URL 方案并将一个参数（或其他）序列化到 URL 中。

如果用户正在浏览`UIWebView`您控制的链接，您可以修补`webView:shouldStartLoadWithRequest:navigationType:`并使用该链接在用户单击链接时进行拦截。然后，您的委托会拦截 URL，而不是让 UIWebView 更改位置，而是在委托上调度代码的执行。

# arrays - 在 AS3 中查找多个文本字段的最大宽度

> ID：14782951
> 
> 赞同：1
> 
> 时间：2013-02-08T23:20:36.603
> 
> 标签：arrays, actionscript-3

我有一个基于用户变量创建多个文本字段的数组。下面的代码连接到添加文本时触发的函数。从那里它应该找到最宽的文本字段，然后将宽度应用于其余的文本字段，以便它们都具有相同的大小。

这是给我带来问题的代码。我可以再看看我的语法是否不正确，或者是否有更好的方法来解决这个问题。

```
for (var ied: int=1; ied>=electoff.electinput.textArray.length; ied++)
{
    trace("one");
    widest=(electoff.electinput.textArray["b"+ied].width>widest)?electoff.electinput.textArray["b"+ied].width:widest;

}
for (i =ied; i<electoff.electinput.textArray.length; ied++)
{
    electoff.electinput.textArray["b"+ied].width = widest;
    trace("two");
} 
```

这是我得到的错误：

> TypeError：错误＃1010：术语未定义且没有属性。在 NewPlv2_fla::MainTimeline/ajWidth()[NewPlv2_fla.MainTimeline::frame1:650] 在 NewPlv2_fla::MainTimeline/_keys()[NewPlv2_fla.MainTimeline::frame1:774]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T00:09:38.030

AS3.0[**数组**](http://help.adobe.com/en_US/as3/dev/WS5b3ccc516d4fbf351e63e3d118a9b90204-7ee5.html)的索引是从零开始的，这意味着数组中的第一个元素是 [0]，第二个元素是 [1]，依此类推。

所以仅供参考你试图访问`textArray["b"+ided]`。但这种语法是[**关联数组**](http://help.adobe.com/en_US/as3/dev/WS5b3ccc516d4fbf351e63e3d118a9b90204-7eea.html)

我测试了以下代码。请检查。

```
import flash.text.TextField;
var arr:Array = [];

for(var i:int = 0; i<10; i++)
{
    var tf:TextField = new TextField();
    tf.width = 200 * Math.random();;
    tf.name = "tf" + i;
    tf.height = 100;
    arr.push(tf);
    trace(tf.name + ": " + tf.width);
}

var widest:Number = 0;
for (i=0;i<arr.length;i++)
{
    if(arr[i].width>widest) widest = arr[i].width;
}
trace("widest: " + widest); 
```

# html - Emacs 从 html 文件跳转到 css 声明

> ID：14782952
> 
> 赞同：5
> 
> 时间：2013-02-08T23:20:51.417
> 
> 标签：html, css, emacs, elisp

我一直在寻找互联网并没有提出解决方案。有谁知道如何跳转到 html 文件中的 css 声明并打开一个新的缓冲区，指向或接近该声明？

### 编辑

经过更多搜索后，我决定使用搜索打开缓冲区的字符串方法。

```
;; CSS search open buffers
(defun search-open-css-buffers-for-region-or-word ()
  "Use the current region/point and search open css buffers"
  (interactive)
  (let (searchTerm)
    (setq searchTerm
          (if (region-active-p)
              (buffer-substring-no-properties (region-beginning) (region-end))
            (thing-at-point 'symbol)))
    (multi-occur (mapcar (lambda (buf)
                           (if (string-match "\w*.css" (buffer-name buf))
                               buf)) (buffer-list))
                 searchTerm 5)))

(global-set-key (kbd "M-s-.") 'search-open-css-buffers-for-region-or-word) 
```

感觉就像这是一个黑客。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-25T09:54:49.203

有几件事使这个非通用：

*   根据您使用的 HTML 模式，您可能需要不同的方法来检测当前的内容
*   你的 CSS 文件在哪里？人们有各种不同的项目结构
*   你希望输出看起来如何？

话虽如此，这里有一个例子，用于 nxml-mode（尽管它很容易适应）。

```
(defun find-css-defun ()
  （交互的）
  （当（memq'nxml-attribute-value
              (get-text-property (point) 'face))
    （让（（css缓冲区
           （地图车
            （拉姆达（文件）
              （查找文件不选择文件））
            （目录文件默认目录 t ".*\\.css$"))))
      （多次出现的 css 缓冲区
                   （事物点的符号）））））

```

*   回答第一点，我们正在使用 nxml，这就是我们检测我们是否在 CSS 属性上的方式
*   回答第二点，我们只是扫描与 HTML 相同目录下的所有 CSS 文件，css-buffers 是打开的 CSS 文件的列表；显然这是适应性强的
*   我们使用多事件来呈现结果

它工作正常。

PS它需要这些天默认情况下在emacs中的东西

# javascript - 使用淘汰赛绑定自定义事件

> ID：14782953
> 
> 赞同：0
> 
> 时间：2013-02-08T23:20:59.120
> 
> 标签：javascript, knockout.js

我正在使用引发更改事件的 jQuery UI 滑块控件。我想使用 Knockout 绑定到这个更改事件并在我的模型中调用一个方法。这是怎么做到的？我很困惑，因为这个事件与 DOM 或通常用于绑定的东西无关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:26:00.377

为什么不使用设置模型变量的事件监听器，即

```
 var callback = function(value) { 
    koModel.someVariable(value);
 } 
```

并将其用作滑块的回调。

# compass-sass - SCSS / Compass 的动态导入？

> ID：14782954
> 
> 赞同：6
> 
> 时间：2013-02-08T23:20:59.233
> 
> 标签：compass-sass, sass

我有一个 SCSS 项目，它通过 Compass 建立在 Foundation 之上。它定义了一组 sass 变量，然后根据这些变量定义了一堆规则：（我的项目有更多的变量设置和导入语句；这被简化了。）

**vars.scss**：

```
$foo = #fafafa
$bar = 14px;

// rules using $foo and $bar
@import '_rules'; 
```

然后我使用 compass 编译**vars.scss**，这组 sass 变量的一切都很好。但是，我还希望能够对我的应用程序进行不同的主题化，并通过定义一组可以覆盖原始变量的新变量来生成不同的主题：

**vars.scss**：

```
$foo = #fafafa
$bar = 14px;

@import 'otherVars';

@import '_rules'; 
```

当我有 70 多个主题时，我无法手动编辑文件。（对于我的应用程序而言，拥有这么多主题是必要的。）我真正想要的是能够执行以下操作：

**vars.scss**：

```
$foo = #fafafa
$bar = 14px;

@import '{{otherVars}}';

@import '_rules'; 
```

然后我可以这样称呼：

```
compass --otherVars themes/theme2 
```

这样就很容易抽出所有主题，因为我可以`compass`为每个主题调用一次。

SCSS 是否允许您这样做？我看了看，好像不是。

我目前的解决方法是将原始**vars.scss**拆分为前缀和后缀：

**_app_prefix.scss**：

```
$foo = #fafafa
$bar = 14px; 
```

**_app_suffix.scss**：

```
@import '_rules'; 
```

**应用程序.scss**：

```
@import '_app_prefix';
// no overrides by default
@import '_app_suffix'; 
```

并为特定主题覆盖它，您将创建一个如下所示的文件：

**主题2.scss**：

```
@import '_app_prefix';

// only override $foo - let the original value of $bar stand
$foo = #ebebeb;

@import '_app_suffix'; 
```

这可行，但有点痛苦并引入了额外的样板。

我的下一个问题是想要有额外的`@import 'rules_foo'`语句，这些语句也需要动态构建。所以我的整体幻想看起来像：

**vars.scss**：

```
$foo = #fafafa
$bar = 14px;

@import '{{otherVars}}';

@import '_rules';
{{ @import 'additional_rules' for additional_rules in rules }} 
```

我可以打电话：

```
compass --otherVars themes/theme2 --rules "rules_1" "rules_2" "rules_3" 
```

（显然，这有点手忙脚乱，但希望你能明白。）

有没有办法做到这一点？还是我将不得不求助于把手或其他一些模板语言？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-03-28T13:31:18.363

对于使用 Grunt 编译 SCSS/SASS 文件的人，解决方案是在“sass”任务配置中添加一个额外的参数**loadPath**，如下所示：

```
sass: {
  options: {
    loadPath: ['../src/css/themes/myTheme/'],
    style: 'nested',
    precision: 2
  }, 
```

然后在 /src/css/import.scss 中，您可以包含主题中的这些文件，就好像它们在当前目录中一样：

```
@import "config"; 
```

该文件包含在 /src/css/themes/myTheme/config.scss 中。

注意：您当然可以为您的 Grunt 任务添加一个参数，并使该主题名称动态化！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T12:40:31.933

您总是可以生成一个临时文件发送到指南针。使用python代码：

```
import sys
with open('tmp.scss', 'w') as out:
    out.write(("""
$foo = #fafafa
$bar = 14px;

@import '%(pre-rules)s';

@import '_rules';
%(post-rules)s
    """ % {'pre-rules': sys.argv[1], 'post-rules': '\n'.join(["@import '%s';" % x for x in sys.argv[2:]])}).strip()) 
```

你会这样称呼它：

```
python stackoverflow.py themes/theme2 rules_1 rules_2 rules_3 
```

它使用您想要的输出创建/覆盖 tmp.scss。

# java - 现有类的 Netbeans 插件 ClassNotFoundException

> ID：14782961
> 
> 赞同：3
> 
> 时间：2013-02-08T23:21:29.937
> 
> 标签：java, plugins, netbeans, classloader

我正在开发基于[http://platform.netbeans.org/tutorials/nbm-code-completion.html](http://platform.netbeans.org/tutorials/nbm-code-completion.html)教程的 Netbeans 插件。当我启动和调试我的插件时，会引发异常：

> java.lang.ClassNotFoundException: javax.swing.text.BadLocationException 在 org.eclipse.osgi.internal.loader.BundleLoader.findClassInternal(BundleLoader.java:513) 在 org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader .java:429) 在 org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:417) 在 org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.loadClass(DefaultClassLoader.java:107) 在 java. lang.ClassLoader.loadClass(ClassLoader.java:356) 原因：java.lang.NoClassDefFoundError: javax/swing/text/BadLocationException at pl.artpal.hinttest.CodeCompletionProvider$1.query(CodeCompletionProvider.java:35) at org.netbeans。 spi.editor.completion.support.AsyncCompletionTask.run(AsyncCompletionTask.java:223) 在 org.openide.util.RequestProcessor$Task.run(RequestProcessor.java:1452) [catch] 在 org.openide.util.RequestProcessor$Processor.run(RequestProcessor.java:2032)

BadLocationException 类是 javax.swing.text 包的一部分，它应该从 rt.jar 加载

当然，我的java文件有

```
import javax.swing.text.BadLocationException; 
```

根据调试时 netbeans 命令行，

```
javax.swing.text.BadLocationException.class 
```

不存在，但是当我尝试时：

```
Class.forName("javax.swing.text.BadLocationException").getConstructors()[0].newInstance(new Object[] { "a", 1}).toString() 
```

有用。这是怎么回事？

Netbeans v7.2.1、JDK 1.7.0_13、JRE7、Win7x64，我的电脑上也有 Eclipse。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T14:23:13.107

当系统资源（内存）不足时，我会看到 ClassNotFoundException。当它清理异常时消失了。无限循环 new Class() 可能会带你到那里。

如果不是这种情况，请参见此处：http: [//javarevisited.blogspot.com/2011/08/classnotfoundexception-in-java-example.html](http://javarevisited.blogspot.com/2011/08/classnotfoundexception-in-java-example.html)

# wcf - 从 UserNameSecurityTokenHandler 内部访问 RequestSecurityToken 的 AdditionalContext

> ID：14782963
> 
> 赞同：0
> 
> 时间：2013-02-08T23:21:36.503
> 
> 标签：wcf, wcf-security

我正在使用自定义 UserNameSecurityTokenHandler 派生类创建自定义 STS。在客户端中，我在 RequestSecurityToken 的 AdditionalContext 属性中添加了一些附加信息，令牌处理程序需要这些信息进行完全身份验证（除了用户名和密码）。

我假设 RequestSecurityToken 必须在我的令牌处理程序中的某个地方对我可用，但我找不到它。我已经用 Reflector 浏览了代码，但这也没有帮助。

我怎样才能获得这些信息？

提前致谢。

大卫穆林

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T21:46:47.983

事实证明，我混淆了两个不相关的事情。UserNameSecurityTokenHandler 类用于验证用户名/密码客户端凭据，然后作为“当前主体”流入 STS。

所以，没关系。

# windows - wamp 服务器启动时 windows 看起来很奇怪

> ID：14782964
> 
> 赞同：1
> 
> 时间：2013-02-08T23:21:49.293
> 
> 标签：windows, wamp, wampserver, windows-explorer

![在此处输入图像描述](../Images/2bce1e46efb6b488ca3daf9ec301e922.png)

每次当我在 64 位 Windows 7 上声明 wamp server 2.2e 32 位（众所周知的 apache，windows 上的 mysql php）时，它都会改变我的资源管理器行为。查看图像选项如何具有灰色背景颜色，并且当鼠标悬停它们时该颜色会改变。

请帮帮我，是 wamp 问题还是 Tortoise SVN 问题。因为安装 Tortoise SVN 后，可能会出现这个问题。

# objective-c - 从 TabBar 应用程序在 AppDelegate 上推送 ViewController

> ID：14782965
> 
> 赞同：1
> 
> 时间：2013-02-08T23:21:53.910
> 
> 标签：objective-c, uinavigationcontroller, uitabbarcontroller, storyboard, pushviewcontroller

我有一个显示多个选项卡的选项卡栏应用程序。在通知的情况下，我希望将用户定向到能够推送“返回”的视图控制器。当我的应用程序只是导航控制器应用程序时，我在 AppDelegate 中使用了以下代码：

```
UIStoryboard *mainStoryboard = self.window.rootViewController.storyboard;
DetailViewController *detailViewController = (DetailViewController*)[mainStoryboard instantiateViewControllerWithIdentifier: @"detailViewController"];
[(UINavigationController*)self.window.rootViewController pushViewController:detailViewController animated:NO]; 
```

在我将我的应用程序转换为 Tab Bar 之前，这段代码可以正常工作。似乎“self.window.rootViewController”不再是“UINavigationController”类型，因此调用“pushViewController”会生成一个异常，说方法不存在。有什么方法可以在标签栏应用程序上进行这项工作？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T00:12:57.957

您应该将通知控制器显示为模态 ( `presentViewController:animated:completion:`)，并在该控制器内提供关闭它的方法，可能是顶部栏上的按钮。

**编辑**：感谢 Dimitry 的回答，我能够走上正轨。为了保留顶部导航栏和底部工具栏，我只需要做一个小技巧。我通过使用“UINavigationController”实例来做到这一点。这是代码：

```
UIStoryboard *mainStoryboard = self.window.rootViewController.storyboard;
DetailViewController *detailViewController = (DetailViewController*)[mainStoryboard instantiateViewControllerWithIdentifier: @"detailViewController"];
UINavigationController *navigationController = [[UINavigationController alloc] initWithRootViewController:detailViewController];
navigationController.navigationBar.tintColor = [UIColor blackColor];
navigationController.toolbar.tintColor = [UIColor blackColor];
[self.window.rootViewController presentViewController:navigationController animated:YES completion:NULL]; 
```

# java - 如何在 UTF-8 文件中将字符位置转换为字节位置？

> ID：14782968
> 
> 赞同：2
> 
> 时间：2013-02-08T23:22:12.680
> 
> 标签：java, utf-8, byte

我有 UTF-8 编码的文本文件。我可以按字符阅读。每个 char 可以是一个字节或多字节。我怎么知道在哪里读取了一个字节，以及读取了多于一个字节？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:35:19.280

在读取`char`s 时计算字节数。

对于每个`char c`：

```
if(c<128)
  bytesCount++;
else if (c<2048)
  bytesCount+=2;
else
  bytesCount+=3; 
```

另见编码定义[维基百科 URF8](http://en.wikipedia.org/wiki/UTF-8#Description)

# asp.net-mvc-3 - Kendo Grid 在 Mono 中工作吗？

> ID：14782974
> 
> 赞同：1
> 
> 时间：2013-02-08T23:22:35.870
> 
> 标签：asp.net-mvc-3, mono, monodevelop, kendo-ui, kendo-grid

只是一个简单的问题，我一直无法找到答案。如果有人知道，如果您愿意在这里分享您的知识，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T09:22:05.723

我猜你的意思是 ASP.NET MVC 的 Kendo UI Grid。是的，它适用于 Mono。事实上，我们正在积极使用 Mono 进行开发。

# cucumber - 垂直 DataTable 的 Java Cucumber 步骤定义

> ID：14782979
> 
> 赞同：1
> 
> 时间：2013-02-08T23:23:05.463
> 
> 标签：cucumber, gherkin, cucumber-jvm

我正在使用[cucumber-jvm](https://github.com/cucumber/cucumber-jvm)。我在 .feature 文件中有以下内容：

```
 Background:
    Given the following account file line:
      | First Name     | Lance  |
      | Last Name      | Fisher |
      | Corporate Name |        | 
```

这是一个垂直方向的表。以下生成的步骤定义使用 First Name 和 Lance 作为标题，其中 First Name、Last Name 和 Corporate Name 应该是标题。

```
@Given("^the following account file line:$")
public void the_following_account_file_line(DataTable arg1) throws Throwable {
    // Express the Regexp above with the code you wish you had
    // For automatic conversion, change DataTable to List<YourType>
    throw new PendingException();
} 
```

我将如何实现一个步骤定义来处理垂直表而不是水平表？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-02-05T12:25:37.387

只需接收参数值`Map<String, String>`而不是 DataTable。Cucumber 会将第一列转换为映射键，将第二列转换为映射值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T13:11:07.477

这很简单，因为 Datatable 可以返回一个字符串数组的数组，并且您可以按照您希望的任何方式逐步执行此操作。

但是，我同意 Prakash Murthy 的观点，即水平表更常见且更实用。

# java - 在Java中使用retainAll获取多个列表的交集

> ID：14782981
> 
> 赞同：6
> 
> 时间：2013-02-08T23:23:21.120
> 
> 标签：java, arraylist

我在获取 Java 上几个列表的交集时遇到了麻烦。我正在做的是：我得到（可以说）3个整数列表：

列表 1：[2、2、2、2、5、5]

清单 2：[2, 2, 103]

清单 3：[2, 431]

我使用剩余的每个列表将retainAll应用于第一个：

```
list1.retainAll(list2);
list1.retainAll(list3); 
```

我得到了这个结果：

list1: [2, 2, 2, 2]

但我希望得到这个：

清单 1：[2]

...因为所有列表共享的唯一元素是*一个*2 而不是*四个*2。

我知道这可能是 retainAll 函数的预期行为，但我需要得到我上面提到的结果。

有什么帮助吗？

**编辑：** 使用 HashSet 禁止重复也不行。在这种情况下，例如：

列表 1：[2、2、2、2、5、5]

清单 2：[2, 2, 103]

清单 3：[2、2、2、431]

我需要得到以下结果：

列表 1: [2, 2] （因为所有列表都至少有一对 2）

代替

清单 1：[2]

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T23:29:01.350

这个方法怎么样：

```
public static <T> Collection <T> intersect (Collection <? extends T> a, Collection <? extends T> b)
{
    Collection <T> result = new ArrayList <T> ();

    for (T t: a)
    {
        if (b.remove (t)) result.add (t);
    }

    return result;
}

public static void main (String [] args)
{
    List <Integer> list1 = new ArrayList <Integer> (Arrays.<Integer>asList (2, 2, 2, 2, 5, 5));
    List <Integer> list2 = new ArrayList <Integer> (Arrays.<Integer>asList (2, 2, 103));
    List <Integer> list3 = new ArrayList <Integer> (Arrays.<Integer>asList (2, 431));

    System.out.println (intersect (list1, intersect (list2, list3)));
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T23:29:54.690

使用多集数据结构可以更轻松地解决此问题。例如，如果你使用 guava's [`Multiset`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Multiset.html)，你可以使用[`Multisets.retainOccurrences()`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Multisets.html#retainOccurrences%28com.google.common.collect.Multiset,%20com.google.common.collect.Multiset%29)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-08T23:33:56.450

我会使用某种`Set`，也许是`HashSet`. 他们不会添加重复的元素，而且他们有`retainAll`方法。

```
Set<Integer> uniqueNums = new HashSet<Integer>(list1);
uniqueNums.retainAll(list2);
uniqueNums.retainAll(list3); 
```

这[是](http://docs.oracle.com/javase/7/docs/api/java/util/Set.html)`Set`. _

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T23:27:20.857

您需要一个名为 bag 或 multiset 的数据结构，而不是列表。例如，Apache commons 集合库包括一个：

[http://commons.apache.org/collections/apidocs/org/apache/commons/collections/Bag.html#retainAll(java.util.Collection)](http://commons.apache.org/collections/apidocs/org/apache/commons/collections/Bag.html#retainAll(java.util.Collection))

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-08T23:27:56.923

`retainAll`正如你所说，你会得到错误的答案。我建议您使用`HashMap`保持`integer/count`配对并相互扫描列表并缩小您的`map`.

1.  `map`从 的值填充`list1`。
2.  遍历其他列表并使用该值`min(# of intg in other_list, map.get(intg))`更新和更新`map`。
3.  结果`map`将是所有列表的交集。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-09-25T23:19:44.303

这是一个你喜欢的，它是递归的。

```
public static <T> List<T> intersect(List<T> c1, List<T> c2) {
    List<T> inter = new ArrayList<>(c1);
    inter.retainAll(c2);
    return inter;
}

public static <T> List<T> intersect(List<T> first, List<T>... rest) {
    if (rest.length == 0)
        return first;

    List<T> second = rest[0];

    first = intersect(first,second);
    rest = Arrays.copyOfRange(rest, 1, rest.length);

    return intersect(first, rest);
} 
```

# c++ - 如何使用 C++ 中的 sysconf() 函数查找以下信息？

> ID：14782984
> 
> 赞同：-1
> 
> 时间：2013-02-08T23:23:40.280
> 
> 标签：c++

如何找到 argv[]、envp[] 和系统输入行的最大大小？我正在使用 sysconf() 函数。sysconf(_SC_ARGMAX) 是否给了我 argv[] 的最大大小？另外两个呢？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-08T23:28:23.927

从[SYSCONF(3)](http://www.kernel.org/doc/man-pages/online/pages/man3/sysconf.3.html)

> **POSIX.1 变量**
> **ARG_MAX - _SC_ARG_MAX**
> exec(3) 系列函数的参数的最大长度。不得小于 _POSIX_ARG_MAX (4096)。
> 
> **POSIX.2 变量**
> **LINE_MAX - _SC_LINE_MAX**
> 实用程序输入行长度的最大长度，来自标准输入或来自文件。这包括尾随换行符的长度。
> 
> **BUGS**
> 使用 ARG_MAX 很困难，因为它没有指定用户的环境变量消耗了多少 exec(3) 的参数空间。

# c - 使用 pthread 条件等待的事件排序中的意外输出

> ID：14782985
> 
> 赞同：0
> 
> 时间：2013-02-08T23:23:48.767
> 
> 标签：c, pthreads

我编写了以下代码来了解使用 pthread 和互斥锁的事件排序。**main**函数创建两个与函数**func1**和**func2**相关联的线程。函数**func1**检查**count**的值并有条件地等待**func2**发出信号。函数**func2**递增**计数**，当**计数**达到 50000 时，它向**func1**发出信号。然后**func1**打印当时是（或应该是）50000的**计数值。**

但在实际输出中，除了 50000 之外，还打印了一些其他值。我不明白为什么会这样。我的想法是，当**func2**发出信号时，**func1**在 pthread_cond_wait 语句之后唤醒并执行，所以它应该只打印 50000。请指出我错在哪里，应该改变什么以获得正确的输出？

```
#include <pthread.h>
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

pthread_mutex_t evmutex;
pthread_cond_t evcond;

char a;
int count;
int N = 50000;

void *func1()
{
    while(1)
    {
        pthread_mutex_lock(&evmutex);
        if(count < N)
        {
            pthread_cond_wait(&evcond,&evmutex);
            printf("%d\n",count);
            count = 0;
        }
        pthread_mutex_unlock(&evmutex);

    }
}

void *func2()
{
    while(1)
    {
        pthread_mutex_lock(&evmutex);
        count++;
        if(count == N)
        {
            pthread_cond_signal(&evcond);
        }
        pthread_mutex_unlock(&evmutex);

    }
}

int main ()
{
    pthread_t ptd1,ptd2;

    pthread_mutex_init(&evmutex,NULL);
    pthread_cond_init(&evcond,NULL);
    count = 0;
    pthread_create(&ptd1,NULL,func1,NULL);
    pthread_create(&ptd2,NULL,func2,NULL);

    pthread_exit(NULL);
    pthread_mutex_destroy(&evmutex);
    pthread_cond_destroy(&evcond);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:47:09.130

您尚未与生产者 func2() 同步，并告诉它等到消费者 func1() 处理完条件。

没有什么能阻止生产者发出条件信号、重新获取互斥体并再次增加计数器。pthread_cond_signal 并不意味着您的生产者将停止并等待消费者处理。这意味着生产者可能会在您的消费者被安排并唤醒以打印当前数字之前多次增加计数器。

您需要添加另一个条件变量，生产者在将计数器增加到 N 后等待该条件变量，并让消费者在处理计数器时发出信号。

除此之外，您需要处理其他答案提到的虚假唤醒。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T23:28:37.830

一些实现`pthread_cond_wait()`会受到虚假唤醒的影响，因此，通常的做法是使用`while (cond) { pthread_cond_wait(...); }`循环来解决这个问题。

我在这里找到了对问题和原因的一个很好的解释：[为什么 pthread_cond_wait 有虚假的唤醒？](https://stackoverflow.com/questions/8594591/why-does-pthread-cond-wait-have-spurious-wakeups)

# c# - 退出按钮后，您将返回经过身份验证的页面

> ID：14782986
> 
> 赞同：1
> 
> 时间：2013-02-08T23:23:51.427
> 
> 标签：c#, asp.net-mvc

当用户在注销后点击返回按钮时，他们会得到文档过期。但是，当用户单击此消息时

> 单击重试以从网站重新请求文档，

在浏览器中，他们能够再次访问经过身份验证的页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T00:18:34.667

这是因为页面被缓存了。对于所有安全请求，您需要手动终止缓存。你可以这样做：

```
public class SecurePageAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        filterContext.HttpContext.Response.Cache.SetExpires(DateTime.UtcNow.AddMinutes(-1));
        filterContext.HttpContext.Response.Cache.SetCacheability(HttpCacheability.NoCache);
        filterContext.HttpContext.Response.Cache.SetNoStore();
    }
} 
```

然后，您将在控制器中使用它，如下所示：

```
[SecurePage]
public ActionResult Index() {
    return View();
} 
```

如果您的大部分站点都是安全的，您还可以注释您的整个控制器或全局注册。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T23:37:17.383

对于 GET 请求，您希望他们仍能在“返回”上看到经过身份验证的页面，但无法与之交互（假设您使用 POST 进行操作）。

由于您正在谈论一个 POST 请求（因为它给了您过期的消息），您可能缺少`[Authorize]`控制器/操作中的属性，这将允许任何未经身份验证的用户访问它，您检查过吗？

# css - 一起使用 Bootstrap 和基础？

> ID：14782990
> 
> 赞同：2
> 
> 时间：2013-02-08T23:24:26.430
> 
> 标签：css, twitter-bootstrap, zurb-foundation

我正在使用 twitter bootstrap 进行布局和 css。但我喜欢引导程序提供的基础顶部栏导航。我试图在我的 html 中使用顶部条形码（使用引导程序构建），它弄乱了布局。这并不奇怪，因为它们都广泛依赖于名为“row”的类，并且它们具有不同的属性。

我可以考虑的一个选项是在我的样式表中以某种方式覆盖行类，但这将是一项太多的工作，而且看起来不正确。

其他选项可能是使用 iframe。

有没有其他方法可以解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-11T09:27:09.473

理想情况下，您只需要使用 Foundation 的顶部栏 CSS 和 JS 代码，因为这是您要使用的唯一组件。[这是 SCSS](https://github.com/zurb/foundation/blob/master/scss/foundation/components/modules/_topbar.scss)文件（依赖于[_settings.scss](https://github.com/zurb/foundation/blob/master/scss/foundation/_settings.scss)中声明的变量。或者您可以使用[生成的 CSS 代码](https://gist.github.com/naoisegolden/83064c446bc5171d1652)。

如果您仍然需要使用`.row`，只需复制`.row`样式并将其命名为不同的。IE：

```
/* The Grid ---------------------- */
.foundation-row { width: 1000px; max-width: 100%; min-width: 768px; margin: 0 auto; } 
```

最后，不要忘记包含`jquery.foundation.topbar.js`文件并调用

`$(document).foundationTopBar();`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-04T10:29:00.280

老问题，但如果有人正在寻找无缝解决方案，我想我会分享最新的：Web Components

这是一个更复杂的主题，但允许您在完全隔离的 Shadow DOM 中创建小部件，而不会覆盖任何东西。[在此处](http://www.html5rocks.com/en/tutorials/webcomponents/shadowdom/)和[此处](https://css-tricks.com/modular-future-web-components/)阅读有关它 的更多信息。然后你就可以做这样的事情：

```
<template id="templateContent">
     <style> @import "css/generalStyle.css"; </style>
</template> 
```

取自[这个答案](https://stackoverflow.com/a/23286832/1826143)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T23:27:45.237

为此使用 iframe 是个坏主意。如果您喜欢 Foundation 顶部栏的样式，只需将这些样式复制到样式表中的自定义类中即可。

请注意，您可能必须为顶部栏覆盖一些 Bootstrap 的默认样式才能使其正确。

# ruby-on-rails - 下载 ruby gem 修复程序？

> ID：14782993
> 
> 赞同：1
> 
> 时间：2013-02-08T23:25:05.183
> 
> 标签：ruby-on-rails, ruby, github, gem, instagram

所以我对 Ruby、Gems 和 Git 的世界还是很陌生。

我正在使用 Instagram ruby​​ gem，它目前存在安全漏洞： [https ://github.com/Instagram/instagram-ruby-gem/issues/39](https://github.com/Instagram/instagram-ruby-gem/issues/39)

在该链接中，它包含一个修复链接。然而，这个修复不是最新版本的 gem 的一部分，它是在最新版本的碰撞之后创作的。我该如何实施呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:37:00.647

您可以通过绕过 gemfile 中的 ruby​​gems 来获取最新的代码副本。

例子：

```
gem 'instagram', :git => "https://github.com/Instagram/instagram-ruby-gem.git" 
```

或者在您的情况下，因为代码似乎尚未合并到主存储库中：

```
gem 'instagram', :git => "https://github.com/13k/instagram-ruby-gem.git" 
```

您还可以指定要使用的确切提交或分支。

[bundler 文档](http://gembundler.com/git.html)可以指导您了解详细信息。

这将有助于您立即开始工作。在测试完该代码后，我还会对[拉取请求](https://github.com/Instagram/instagram-ruby-gem/pull/58)发表评论以说明这一点。

# c# - WebSuperGoo.ABCpdf8

> ID：14782994
> 
> 赞同：3
> 
> 时间：2013-02-08T23:25:10.747
> 
> 标签：c#, .net, dll, reference, using

我正在梳理一个庞大的工作程序，该程序以前由 4-5 名其他程序员完成，并消除了错误。我在文件开头遇到了涉及以下代码行的错误：

```
using WebSupergoo.ABCpdf8; 
```

它给出以下错误：“找不到类型或命名空间名称'WebSupergoo'（您是否缺少 using 指令或程序集引用？）”

我知道这是由于我没有包含参考资料，我找到了包含它的文件的网站。但我不知道如何引入参考。我使用 .dll 文件创建了一个引用，然后包含了该引用，但仍然出现错误。我无权在线发布该程序，但如有必要，我可以提供更多详细信息。

任何建议，将不胜感激。如果您需要更多信息，请随时询问。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T13:53:01.557

检查您项目的 .NET Target 框架版本是否不低于用于构建 ABCpdf.dll 的框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-02T04:18:38.287

在这一点上，这可能不会有太大帮助。但是，在 Windows 更新破坏了 ASP.NET Web 应用程序中一个非常旧的 ABCPDF 实现之后，我也从一个继承的项目中遇到了这个问题。我并不是说您应该重复这些步骤，但我将所有这些步骤都放在这里，以防它帮助其他人确定他们可能需要做什么。另外，我在 ABCPDF10 上，但我不明白为什么这不适用于任何版本。

1.  我从项目中删除了所有 ABCPDF 文件并手动删除了 bin/，包括 ABCPDF.dll、ABCGecko.exe、XUL 目录和 PrintHooks.dll。
2.  我删除了对 proejct.csproj 文件中所有这些文件的所有引用
3.  我从 ABCPDF 和 ABCPDF.Gekco 的 ../packages 中删除了所有包
4.  然后我安装了 64 位 ABCPDF10，然后通过 MSI 为每个安装了 32 位 ABCPDF10。
5.  然后，我按照 ABCPDFs 说明手动将文件从它们各自的 C:/Program Files 目录复制到我的项目的 bin/ 中。这对我不起作用，因为当我在 VS2015 中构建时，由于某种原因它看不到 .DLL。
6.  然后我通过手动删除项目 bin/ 中的文件，然后在 Server2012R2 中使用添加/删除应用程序来卸载它。
7.  然后我使用 Nuget 下载了 ABCPDF，并且它可以构建。但我仍然需要 ABCPDF.Gekco
8.  然后我使用 Nuget 尝试安装 ABCPDF.Gecko。这下载了它，但它没有完全安装。我手动将丢失的 .dll 和 .exe 复制到 bin/ 目录并构建项目。
9.  但是此时我收到一个错误，即使它在 bin/ 中也找不到 x64.dll
10.  在这里对我有用的是我单独留下了 Project 和 bin/ 目录，然后我使用了 .MSI 安装程序并只将 x64 版本重新安装到 C:/ 就像任何其他程序一样。我不必将任何文件复制到 bin/. 我刚刚重建了项目并繁荣了！那行得通。

*在我看来*，这就像一个注册表项/路径问题。但我不知道这是否正确。

希望这对其他人有帮助。

# javascript - 需要获取当前元素的id

> ID：14782999
> 
> 赞同：1
> 
> 时间：2013-02-08T23:25:42.370
> 
> 标签：javascript, jquery

所以，我有几个表，我使用基于类的 jQuery 进行迭代，但我的行为需要根据我所在元素的 id 稍微改变。这是我的代码：

```
<table id="Brokers" class="nodeTable" border=1 />
<table id="Controllers" class="nodeTable" border=1 />
<table id="Cluster-Drivers"  class="nodeTable" border=1 />

jQuery(".nodeTable").html(nodeHealthTable({
  Role: jQuery(this).attr("id")
})) 
```

这最终会用空字符串填充角色。如何访问当前元素的 id？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T23:30:58.900

`this`在您的代码中不引用所选元素，`html`方法接受一个函数，在此函数的上下文中`this`引用当前元素（jQuery 在`each`内部使用方法）。

```
jQuery(".nodeTable").html(function() {
    return nodeHealthTable({ Role: this.id });
}) 
```