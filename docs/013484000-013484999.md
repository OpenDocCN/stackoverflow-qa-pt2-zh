# StackOverflow 问答 13484000-13484999

# java - 无法访问 JAR 文件

> ID：13484002
> 
> 赞同：0
> 
> 时间：2012-11-20T23:29:03.200
> 
> 标签：java, file, batch-file, jar

我使用 Eclipse 将 Java 代码导出到 JAR 文件，然后尝试使用以下批处理文件运行 JAR 文件：

```
java -jar Readability.jar
pause 
```

我的 JAR 文件位于同一目录中。我尝试以管理员身份运行并更改目录命令。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:50:47.610

确保批处理中 JAR 文件的名称与您尝试运行的 JAR 文件的实际名称相匹配。这通常就是该错误的含义。喜欢 `Readibility.jar`，但您的 JAR 的实际名称是`Readability.jar`.

# ios - 团队代理如何从供应门户访问证书部分？

> ID：13484003
> 
> 赞同：0
> 
> 时间：2012-11-20T23:29:02.770
> 
> 标签：ios, provisioning

我是一名 iOS 开发人员（和团队管理员），正在设置一台构建机器。而不是使用我的配置文件设置构建机器并将我的证书放入密钥链中，我认为我会使用团队代理的配置文件和证书来设置它（因为构建机器不属于我，仅供我个人构建使用）。

我刚刚以代理身份登录 Apple 开发人员站点（我有他的 un/pw），但是当我以我自己的身份登录站点时，并没有出现配置门户菜单。这似乎是因为该代理实际上并未在 iOS 开发程序中注册（这似乎很奇怪，他们是如何设法成为 iOS 开发团队的代理并在没有这样的情况下生成证书的？）。

无论如何，当我以我自己的身份登录到开发人员站点时，如果我查看团队配置文件或苹果推送配置文件，我可以看到这些包含代理的证书。但是由于开发人员站点在以代理身份登录时不提供门户页面，所以代理的证书首先是如何创建的，我现在如何访问诸如关联密钥之类的 sutff 以下载并安装在构建机器的钥匙串中，或者作为代理批准构建机器的 CSR？

谢谢

# ruby - 红宝石接球和效率

> ID：13484004
> 
> 赞同：6
> 
> 时间：2012-11-20T23:29:09.607
> 
> 标签：ruby, performance, try-catch, throw, control-structure

`catch`在 Ruby 中是为了跳出深度嵌套的代码。例如，在 Java 中，可以使用 Java 处理异常来实现相同的`try-catch`目的，但是它被认为是糟糕的解决方案，而且效率也很低。在 Ruby 中处理我们有的异常`begin-raise-rescue`，我认为将它用于其他任务也很昂贵。

那么Ruby`catch-throw`真的是一个更有效的解决方案，`begin-raise-rescue`还是有任何其他理由使用它来打破嵌套块而不是`begin-raise-rescue`?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-06-26T05:53:35.713

[乔希的回答](https://stackoverflow.com/a/13484425/541862)是正确的。我想添加更多关于`catch-throw`和的信息`raise-rescue`。

`catch-throw`用于流量控制，而`raise-rescue`用于异常/错误处理。不同的是：`backtrace`不需要`catch-throw`（流量控制）。[相信我，在Josh 的主旨](https://gist.github.com/4122195)`raise-rescue`中导致运行速度慢于`catch-throw`10 倍的主要原因是创建对象需要花费大量时间。`raise-rescue``backtrace`

如果您想`raise`不使用回溯，请使用语法：

```
raise <type>, <message>, <backtrace> 
```

检查[我的要点](https://gist.github.com/jacobdam/5864997)。`raise without backtrace`比 快得多`raise with backtrace`。

**2016 年 4 月更新：**

我已经更新[了我的要点](https://gist.github.com/jacobdam/5864997)：

*   修复了“中断”测试
*   为较新的 ruby​​ 版本 2.1.8、2.2.4、2.3.0 添加了基准测试结果

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-21T00:16:40.630

除了是摆脱控制结构的“正确”方式之外，它的`catch-throw`速度也明显更快（在我的测试中是 10 倍）。查看[此要点](https://gist.github.com/4122195)以获取我的代码和结果。

# layout - symfony2 - Twig：从孩子配置父模板？

> ID：13484008
> 
> 赞同：3
> 
> 时间：2012-11-20T23:29:22.197
> 
> 标签：layout, symfony, twig

我是 sf2/twig 的新手，我想我在某处遗漏了一点：

我有一个带有页眉、两列中间部分和页脚的布局。中间部分左侧为主要内容区域，右侧为 33% 侧边栏。我使用 twig 的模板继承将我的内容放入主要区域和其他需要的地方。

现在，我们页面的某些部分的内容区域必须占据整个宽度，因此这些部分不会显示右侧的侧边栏。为了实现这一点，我必须将不同的 CSS 类应用于主要内容区域，并且显然不要渲染侧边栏的内容。

如果我可以在主模板中使用一个变量，比如`{% if single_column_layout %}`，默认值为`false`，我可以在需要时在子模板中覆盖它，那将是很酷的。但感觉就像我正朝着错误的方向前进......

以更一般的方式，在由一堆构建块组成的页面上，如何最好地控制每页显示哪些块，哪些不显示？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T13:17:01.447

您可以为此使用树枝块继承：

```
{# layout.html.twig #}
<div id="main" class="{% block column_layout 'single-column' %}">
    {% block content %}{% endblock %}
</div> 
```

然后在您的其他模板中，如果您想更改 div#main 的类，只需重新实现该块

```
{% extends "layout.html.twig" %}
{% block column_layout 'two-column' %}
{% block content %}
     content here
{% endblock %} 
```

PD：`{% block name content %}`是内容少的块的[快捷语法](http://twig.sensiolabs.org/doc/tags/extends.html#block-shortcuts)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T00:17:15.010

我认为不可能做到这一点。但是您也许可以使用具有默认值的树枝块来执行此操作。

我解释。在主树枝中，你把这个：

```
{% block parent %}
With your value to display by default
{% endblock %} 
```

在孩子中，如果您不想显示内容，请执行以下操作：

```
{% block parent %}{% endblock %} 
```

但我不确定这种方式能解决你的问题。

# java - JaNeLA 的 JNLP 错误

> ID：13484009
> 
> 赞同：4
> 
> 时间：2012-11-20T23:29:26.560
> 
> 标签：java, jakarta-ee, jnlp, java-web-start

我从这里下载了一个 jnlp 文件，我从[这里](http://pscode.org/janela/)[下载](http://docs.oracle.com/javase/6/docs/technotes/guides/javaws/developersguide/syntax.html)了 JaNeLA 当我分析文件时，我遇到了以下错误。

这是文字报道

```
JaNeLA Report - version 11.05.17

    Report for file:/C:/Documents%20and%20Settings/Administrator/Desktop/sample.jnlp

    Content type application/xml does not equal expected type of application/x-java-jnlp-file
    The element type "homepage" must be terminated by the matching end-tag "</homepage>". 
```

我知道错误是直截了当的，但我无法解决它们，并相信我已经尽力了。任何人都可以帮忙吗？

这是我的 JNLP 文件。

```
 <?xml version="1.0" encoding="utf-8"?>
<!-- JNLP File for SwingSet2 Demo Application -->
<jnlp   spec="6.0+"   codebase="http://my_company.com/jaws/apps"   href="swingset2.jnlp" >
  <information>
    <title>SwingSet2 Demo Application</title>
    <vendor>Sun Microsystems, Inc.</vendor>
    <homepage href="docs/help.html" />
    <description>SwingSet2 Demo Application</description>
    <description kind="short">A demo of the capabilities 
    of the Swing Graphical User Interface.</description>
    <icon href="images/swingset2.jpg"/>
    <icon kind="splash" href="images/splash.gif"/>
    <offline-allowed/> 
    <association mime-type="application-x/swingset2-file"  extensions="swingset2"/> 
    <shortcut online="false">
      <desktop/>
      <menu submenu="My Corporation Apps"/>
    </shortcut>
  </information>

  <information os="linux">   
    <title> SwingSet2 Demo on Linux </title>
    <homepage href="docs/linuxhelp.html">
  </information>

  <security>
      <all-permissions/>
  </security>
  <resources>
    <j2se version="1.6+" java-vm-args="-esa -Xnoclassgc"/>
    <jar href="lib/SwingSet2.jar"/>
  </resources>
  <application-desc main-class="SwingSet2"/>
</jnlp> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:10:04.543

> 我很想知道如何解决第一个问题

```
Content type application/xml does not equal expected type of application/x-java-jnlp-file 
```

JaNeLA[帮助](http://pscode.org/janela/help.html)建议：

> 应用程序的内容类型或 MIME 类型不是预期的类型。
> 
> *   如果从真实的实时服务器返回此错误，它会导致客户端浏览器在浏览器中简单地将 JNLP 文件的内容显示为 XML！联系服务器管理员添加内容类型。
> *   从**本地文件系统**检查的 JNLP 文件的类型通常不正确。

该 JNLP 的来源是：

```
file:/C:/Documents%20and%20Settings/Administrator/Desktop/sample.jnlp 
```

..所以您可以放心地忽略该警告。

## 其他问题

正如评论所提到的。

```
 <information os="linux">   
    <title> SwingSet2 Demo on Linux </title>
    <homepage href="docs/linuxhelp.html">
  </information> 
```

**该** `homepage`元素应以 a 结尾`/`，如下所示：

```
 <information os="linux">   
    <title> SwingSet2 Demo on Linux </title>
    <homepage href="docs/linuxhelp.html"/>
  </information> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T00:12:16.610

另外，您没有关闭`homepage`标签。尝试这个：

```
<homepage href="docs/linuxhelp.html"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-23T17:14:31.423

第一个问题可以忽略。这是因为 jnlp 是从文件系统而不是 Web 服务器中检索的。

JaNeLA[帮助页面](http://pscode.org/janela/help.html)这样说：

> 警告 内容类型 application/xml 不等于 application/x-java-jnlp-file 的预期类型 应用程序的内容类型或 MIME 类型不是预期的类型。

```
If this error is being returned from a real live server, it causes the client browser to simply display the content of the JNLP files as XML in the browser! Contact the server administraters to add the content-type.
It is typical for JNLP files checked from the local file system to be of incorrect type. 
```

# javascript - 地理位置回调从不执行，即使是错误回调

> ID：13484013
> 
> 赞同：1
> 
> 时间：2012-11-20T23:29:48.730
> 
> 标签：javascript, jquery, asp.net, html, geolocation

代码在这部分停止，没有其他任何事情发生它通过条件然后停止它不会触发任何回调被卡在这里&我的应用程序无法交付。

```
src = "//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js";
src = "//maps.google.com/maps?file=api&amp;v=2.x&amp;key=AIzaSyD4iE2xVSpkLLOXoyqT-RuPwURN3ddScAI";

function getLocation() {
    if (navigator && navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(success);
    }
}

function success(position) {
    //Trials.GetLocationService.setLocation("F"); just testing something i commented it out so it's not the proplem
    printAddress(position.coords.latitude, position.coords.longitude);
}

function printAddress(latitude, longitude) {
    // set up the Geocoder object
    var geocoder = new google.maps.Geocoder();

    // turn coordinates into an object
    var yourLocation = new google.maps.LatLng(latitude, longitude);

    // find out info about our location
    geocoder.geocode({ 'latLng': yourLocation }, function (results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
            if (results[0]) {
                $('body').append('<p>Your Address:<br />' +
                    results[0].formatted_address + '</p>');
            } else {
                error('Google did not return any results.');
            }
        } else {
            error("Reverse Geocoding failed due to: " + status);
        }
    });
} 
```

# linux - 设置 Linux 中可用总物理内存的限制

> ID：13484016
> 
> 赞同：18
> 
> 时间：2012-11-20T23:30:48.400
> 
> 标签：linux, memory, kernel, memory-address

我知道我应该设置`mem=MEMORY_LIMIT`. 但是我不知道去哪里，在运行时，或者在启动时，为了对操作系统控制的总物理内存设置一个限制。

我正在运行 I/O 基准测试，我想限制可用的整体物理内存量。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-11-20T23:43:47.760

我找到了我正在寻找的答案。基本上，设置总可用物理内存的参数是“mem=MEMORY_LIMIT”。这是一个内核引导参数。您需要在内核启动参数中添加“mem=1G”，以获得最大 1GB 的可用物理内存。有关如何添加内核启动参数的更多信息，请查看[https://wiki.ubuntu.com/Kernel/KernelBootParameters](https://wiki.ubuntu.com/Kernel/KernelBootParameters)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-20T23:42:23.583

`lilo.conf`在、`grub.conf`、`grub.cfg`或中编辑内核引导参数`menu.lst`（哪个取决于您的特定发行版和引导加载程序；查看发行版的文档以获取更多详细信息）以`mem=512M`在指定内核参数的行中包含参数（或您想要模拟的任何大小）。

例如，在 Grub 中，应该有一行写着`kernel /boot/vmlinuz param1=val1 param2=val2`. 将 添加`mem=512M`到该参数列表中。您可以通过复制这些完整的定义、重命名它们并为每个定义配置不同的内存量来为启动菜单创建单独的条目，这样您就可以使用不同的设置快速启动。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-07-23T20:16:10.233

要添加到 Brian Campbell 的列表，对于 BeagleBone / Black 设备上的 uBoot 引导加载程序，编辑`/boot/uboot/uEnv.txt`
添加中的内核参数或修改行`mmcargs=setenv bootargs mem=512M`[使用 Debian 测试]

使用`> free`前后[reboot]确认修改

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-08T10:31:06.250

A1：是的，您必须重新启动。

A2：内核对于拼写错误是相当宽容的。没有错误消息。那会是你的问题吗？示例：“mem=512M”和“mem=2G”。不要忘记前一个参数后面的空格，mem是小写，K、M或G是大写。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-01T10:34:55.210

I've followed the instructions in [this page](https://wiki.ubuntu.com/Kernel/KernelBootParameters) that KZcoding mentioned (part: Permanently Add a Kernel Boot Parameter)

My Linux is (vm in virtualbox):

```
Linux ubuntu 4.4.0-21-generic #37-Ubuntu SMP Mon Apr 18 18:33:37 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux 
```

Before setting:

```
yavuz@ubuntu:~$ free -m
          total        used        free      shared  buff/cache   available
Mem:           3630         305        3010           6         314        3264
Swap:          3767           0        3767 
```

Just changed this line in `/etc/default/grub`

```
GRUB_CMDLINE_LINUX_DEFAULT="" 
```

to

```
GRUB_CMDLINE_LINUX_DEFAULT="mem=2G" 
```

then restart the server. After restart:

```
yavuz@ubuntu:~$ free -m
              total        used        free      shared  buff/cache   available
Mem:           2000         298        1385           4         315        1651
Swap:          3767           0        3767 
```

# delphi - 如何在没有触摸屏的情况下启用虚拟键盘？(win7)

> ID：13484022
> 
> 赞同：1
> 
> 时间：2012-11-20T23:32:16.710
> 
> 标签：delphi, touch, delphi-xe3

这听起来像是一个愚蠢的问题，但是当我的开发计算机没有触摸屏时，如何在 delphi 应用程序中启用虚拟键盘？我想调试一些自动触摸屏（XE3）是如何自动出现的。

我想让应用程序认为有一个触摸屏，这样它就可以像在触摸屏计算机上一样工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T03:30:23.660

好吧，正如我在[另一个回复](https://stackoverflow.com/questions/12741527/gesture-events-are-not-emulate-by-chrome/12852184#12852184)中提到的那样，我推荐[Multitouch Vista](http://multitouchvista.codeplex.com)，它可以设置忽略视觉工作室和 Silverlight 特定位，就像在这个[更易于使用的指南](http://michaelsync.net/2010/04/06/step-by-step-tutorial-installing-multi-touch-simulator-for-silverlight-phone-7)中一样，或者使用他们网站上的 youtube 视频。MTVista 将安装一个虚拟触摸设备（具有 255 次触摸），当运行和正确使用时，它将生成本机触摸消息，这是您可以做的最接近测试的本机触摸消息，根据您的评论使其认为它有触摸，没有触摸屏在另一个答复中。

# java - ArrayAdapter 不使用动态数据更新

> ID：13484029
> 
> 赞同：1
> 
> 时间：2012-11-20T23:32:53.843
> 
> 标签：java, android

我是 Android 新手，我找不到有效的答案。

我有以下适配器：

```
public class DailyDataAdapter extends ArrayAdapter<DailyData> {
    private LayoutInflater layoutInflater;
    private ArrayList<DailyData> dailyDatas;
    private boolean isUserSavedSectionDefined = false;
    private boolean isAutoSavedSectionDefined = false;
    private int resourceId;

    public DailyDataAdapter(Context context, int textViewResourceId,
            ArrayList<DailyData> dailyDatas) {
        super(context, textViewResourceId, dailyDatas);
        this.layoutInflater = (LayoutInflater) context
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        this.dailyDatas = dailyDatas;
        this.resourceId = textViewResourceId;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View dailyDataRow = convertView;

        DailyData dailyData = dailyDatas.get(position);

        if (dailyDataRow == null) {
            dailyDataRow = layoutInflater.inflate(resourceId, null);

            if (!isUserSavedSectionDefined && dailyData.isUserSaved()) {
                TextView section = (TextView) dailyDataRow
                        .findViewById(R.id.section);
                section.setText(R.string.user_saved_path);
                section.setVisibility(View.VISIBLE);
                isUserSavedSectionDefined = true;
            } else if (!isAutoSavedSectionDefined && !dailyData.isUserSaved()) {
                TextView section = (TextView) dailyDataRow
                        .findViewById(R.id.section);
                section.setText(R.string.auto_saved_path);
                section.setVisibility(View.VISIBLE);
                isAutoSavedSectionDefined = true;
            }

            TextView description = (TextView) dailyDataRow
                    .findViewById(R.id.description);
            description.setText(dailyData.getDate());
        }
        return dailyDataRow;
    }

    @Override
    public void add(DailyData newDailyData) {
        dailyDatas.add(newDailyData);
    }

    @Override
    public void addAll(Collection<? extends DailyData> newDailyDatas) {
        dailyDatas.addAll(newDailyDatas);
    }

    @Override
    public void insert(DailyData newDailyData, int index) {
        dailyDatas.add(index, newDailyData);
    }

    @Override
    public void remove(DailyData newDailyData) {
        dailyDatas.remove(newDailyData);
    }

    @Override
    public void clear() {
        dailyDatas.clear();
    }
} 
```

这会膨胀以下布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<TextView
    android:id="@+id/section"
    android:layout_width="fill_parent"
    android:layout_height="20dp"
    android:layout_marginLeft="50dp"
    android:background="@drawable/listitem_section"
    android:gravity="center"
    android:textColor="@color/white"
    android:visibility="gone"
    android:textStyle="bold" />

<TextView
    android:id="@+id/description"
    android:layout_width="fill_parent"
    android:layout_height="40dp"
    android:layout_marginLeft="50dp"
    android:background="@drawable/listitem_selector"
    android:gravity="center"
    android:singleLine="true"
    android:textColor="@color/black"
    android:textSize="@dimen/normal_text" />

<LinearLayout
    android:layout_width="fill_parent"
    android:layout_marginLeft="50dp"
    android:layout_height="1dp"
    android:background="@color/orange" >
</LinearLayout> 
```

现在，问题是，如果我在将它与我假装显示信息的 listView 关联之前设置与适配器关联的列表的内容，它工作得很好，如下所示：

```
//Step #1
ArrayList<Data> ald = new ArrayList<Data>();
Location l = new Location("test");
Data d = new Data(l);
ald.add(d);

DailyData dd = new DailyData(false);
DailyData dd2 = new DailyData(false);
dd.setDataList(ald);
dd2.setDataList(ald);
dailyDataList.add(dd);
dailyDataList.add(dd2);

//Step #2
arrayAdapter = new DailyDataAdapter(this, R.layout.dailydata_item, dailyDataList); 
```

但是，如果我在设置列表内容（这是我正在开发的应用程序的假装行为）之前将适配器与 listView 相关联，则不会显示任何内容。（切换步骤 1 和 2）。我添加的所有数据都是在之后调用方法**notifyDataSetChanged**进行的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:05:40.243

> 但是，如果我在设置列表的内容（这是我正在开发的应用程序的假装行为）之前将适配器与 listView 相关联，则不会显示任何内容。（切换步骤 1 和 2）。我添加的所有数据都是在之后调用方法 notifyDataSetChanged 进行的。

您的自定义 ArrayAdapter 不会*自动*知道数据已添加到`dailyDataList`. 您需要通知它列表已更改。您也应该在自定义适配器中执行此操作，这就是`ArrayAdapter`：

```
@Override
public void add(DailyData newDailyData) {
    dailyDatas.add(newDailyData);
    notifyDataSetChanged();
}

@Override
public void addAll(Collection<? extends DailyData> newDailyDatas) {
    dailyDatas.addAll(newDailyDatas);
    notifyDataSetChanged();
}

@Override
public void insert(DailyData newDailyData, int index) {
    dailyDatas.add(index, newDailyData);
    notifyDataSetChanged();
}

@Override
public void remove(DailyData newDailyData) {
    dailyDatas.remove(newDailyData);
    notifyDataSetChanged();
}

@Override
public void clear() {
    dailyDatas.clear();
    notifyDataSetChanged();
} 
```

现在你可以打电话`arrayAdapter.add(dd);`了，它*会*自动为你更新 ListView。

最后，由于您已经覆盖了 ArrayAdapter 的大部分并且不调用超级方法，因此您应该简单地扩展 BaseAdapter 并覆盖最后几个方法。

# r - 在 AWS EC2 上使用 doRedis 和 doMC 在 R 中进行多核/并行模拟

> ID：13484032
> 
> 赞同：3
> 
> 时间：2012-11-20T23:33:00.937
> 
> 标签：r, parallel-processing, amazon-ec2, amazon-web-services, redis

我有一个非常适用于并行处理的模拟功能。我设法让它运行多核（EC2 cc2.8xlarge 上最多 32 个核心）。

现在我想知道我是否也可以使用 Redis 让它在多个实例中并行运行多个内核。

我的模拟功能的核心本质上是

```
library(doMC)
registerDoMC(cores=32)
simresults<-foreach (i=1:nrow(input.data), .combine=c) %dopar% {
    simulation function (input.data$1[i],input.data$2[i],input.data$3[i])
} 
```

simresults 然后是我收集的结果的向量。模拟运行了几次 10^7 次。

这是否可以使用`doRedis`或任何其他工具（`segue`？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T01:40:52.240

是的，并且有几个例子浮动 - 例如参见[rredis](http://cran.r-project.org/package=rredis)包的[rredis Manual vignette 。](http://cran.r-project.org/web/packages/rredis/vignettes/rredis.pdf)

除了redis和多核之外，当然还有其他的选择。

# java - 使用 Android 上传文件时如何重命名文件？

> ID：13484045
> 
> 赞同：1
> 
> 时间：2012-11-20T23:34:34.033
> 
> 标签：java, android

我有以下代码工作：

```
 MultipartEntity entity = new MultipartEntity(HttpMultipartMode.BROWSER_COMPATIBLE);
      entity.addPart("userfile", new FileBody(f));
      httppost.setEntity(entity);
      HttpResponse response = httpclient.execute(httppost); 
```

问题是它的名称`File f`是“abc-temp.jpg”，我希望它在上传时是“xyz.jpg”。我不想重命名设备上的文件，**只是**为了上传。

这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-13T10:24:06.597

这当然是可能的，事实上我已经做到了。

```
 FileBody mFileBody = new FileBody(f);
                    String mUploadFileName = "xyz.jpg";

                FormBodyPart mFormBodyPart = new FormBodyPart("userfile", mFileBody)
                {
                    @Override
                    protected void generateContentDisp(ContentBody body) {
                        StringBuilder buffer = new StringBuilder();
                        buffer.append("form-data; name=\"");
                        buffer.append("userfile");
                        buffer.append("\"");
                        buffer.append("; filename=\""+mUploadFileName+"\"");
                        addField(MIME.CONTENT_DISPOSITION, buffer.toString());
                    }
                };
                multipartContent.addPart(mFormBodyPart); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:40:45.570

我不确定它是否会起作用，但您可以创建一个继承自 FileBody 并覆盖 getFilename() 方法的类。

我认为它应该可以解决问题。

# kendo-ui - 点击事件不适用于剑道图表中的列系列

> ID：13484049
> 
> 赞同：1
> 
> 时间：2012-11-20T23:35:01.867
> 
> 标签：kendo-ui

我有一个带有 2 个列系列和 1 个线系列的剑道图表。单击事件仅适用于线条系列。如何为列系列启用它？请看下面的代码。

谢谢！

> 具有 2 个列系列和 1 个线系列的剑道图表

```
<html>
<head id="Head1" runat="server">
    <title>Test</title>
</head>
<body>

<form id="form1" runat="server">
    <telerik:RadScriptManager runat="server" ID="rsm">
     <Scripts>
        <telerik:RadScriptReference Path="js/jquery.min.js" ScriptMode="Release" Combine="true" />
        <telerik:RadScriptReference Path="js/kendo.web.min.js" ScriptMode="Release" Combine="true" />
        <telerik:RadScriptReference Path="js/kendo.dataviz.min.js" ScriptMode="Release" Combine="true" />
        <telerik:RadScriptReference Path="js/kendo.grid.min.js" ScriptMode="Release" Combine="true" />
        <telerik:RadScriptReference Path="js/kendo.pager.min.js" ScriptMode="Release" Combine="true" />
     </Scripts>
    </telerik:RadScriptManager>

    <div class="k-chart-wrapper" id="DetailChart" style="height:410px"></div>

<script language="javascript" type="text/javascript">
    var chartData = [];
    chartData.push(
        { Date: 1, OverallProfit: 25, OverallCost :75, OverallRevenue : 100 },
        { Date: 2, OverallProfit: 27.5, OverallCost :82.5, OverallRevenue : 110 },
        { Date: 3, OverallProfit: 37.5, OverallCost :112.5, OverallRevenue : 150 },
        { Date: 4, OverallProfit: 42.5, OverallCost :127.5, OverallRevenue : 170 },
        { Date: 5, OverallProfit: 23, OverallCost :69, OverallRevenue : 92 },
        { Date: 6, OverallProfit: 26.5, OverallCost :79.5, OverallRevenue : 106 },
        { Date: 7, OverallProfit: 29, OverallCost :87, OverallRevenue : 116 },
        { Date: 8, OverallProfit: 30, OverallCost :90, OverallRevenue : 120 },
        { Date: 9, OverallProfit: 31.5, OverallCost :94.5, OverallRevenue : 126 },
        { Date: 10, OverallProfit: 19.5, OverallCost :58.5, OverallRevenue : 78 },
        { Date: 11, OverallProfit: 22, OverallCost :66, OverallRevenue : 88 },
        { Date: 12, OverallProfit: 24, OverallCost :72, OverallRevenue : 96 },
        { Date: 13, OverallProfit: 26, OverallCost :78, OverallRevenue : 104 },
        { Date: 14, OverallProfit: 35, OverallCost :105, OverallRevenue : 140 },
        { Date: 15, OverallProfit: 40, OverallCost :120, OverallRevenue : 160 },
        { Date: 16, OverallProfit: 33, OverallCost :99, OverallRevenue : 132 },
        { Date: 17, OverallProfit: 32.5, OverallCost :97.5, OverallRevenue : 130 },
        { Date: 18, OverallProfit: 30, OverallCost :90, OverallRevenue : 120 },
        { Date: 19, OverallProfit: 27.5, OverallCost :82.5, OverallRevenue : 110 },
        { Date: 20, OverallProfit: 25, OverallCost :75, OverallRevenue : 100 },
        { Date: 21, OverallProfit: 26.5, OverallCost :79.5, OverallRevenue : 106 },
        { Date: 22, OverallProfit: 29, OverallCost :87, OverallRevenue : 116 },
        { Date: 23, OverallProfit: 31.5, OverallCost :94.5, OverallRevenue : 126 },
        { Date: 24, OverallProfit: 32.5, OverallCost :97.5, OverallRevenue : 130 },
        { Date: 25, OverallProfit: 34, OverallCost :102, OverallRevenue : 136 },
        { Date: 26, OverallProfit: 34.5, OverallCost :103.5, OverallRevenue : 138 },
        { Date: 27, OverallProfit: 35, OverallCost :105, OverallRevenue : 140 },
        { Date: 28, OverallProfit: 37.5, OverallCost :112.5, OverallRevenue : 150 },
        { Date: 29, OverallProfit: 4, OverallCost :12, OverallRevenue : 16 },
        { Date: 30, OverallProfit: 42.5, OverallCost :127.5, OverallRevenue : 170 }
    );

    function createChart() {

        var categoryAxis = []; var valueAxis = [];
        var series = [];

        series.push({ field: "OverallRevenue", name: "Revenue", type: "line", width: 4, missingValues: "interpolate", markers: { visible: true }, stack: false, tooltip: { visible: true }, seriesClick: DetailChart_Click });
        series.push({ field: "OverallCost", name: "Cost", type: "column", markers: { visible: false }, spacing: 0, tooltip: { visible: true }, stack: true, seriesClick: DetailChart_Click });
        series.push({ field: "OverallProfit", name: "Profit", type: "column", markers: { visible: false }, spacing: 0, tooltip: { visible: true }, stack: true, seriesClick: DetailChart_Click });

        categoryAxis.push({
            field: "Date",
            labels: {
                template: "#= value #"
            },
            majorGridLines: {
                visible: false
            },
            minorGridLines: {
                visible: false
            }
        });

        valueAxis.push({
            labels: {
                template: "$#= value #"
            },
            majorGridLines: {
                visible: true
            },
            minorGridLines: {
                visible: false
            }
        });

        $("#DetailChart").kendoChart({
            dataSource: chartData,
            legend: {
                position: "bottom",
                visible: true
            },
            title: {
                text: "Test Chart"
            },
            transitions: true,
            series: series,
            categoryAxis: categoryAxis,
            tooltip: {
                visible: false
            },
            valueAxis: valueAxis,
            seriesClick: DetailChart_Click
        });
    }

    function DetailChart_Click(e) {
        alert("clicked");
    }

    createChart();
</script>

</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T18:51:43.740

你用什么版本？它似乎与最新版本一起工作正常。[这](http://jsbin.com/edamuj/87/edit)是我尝试过的。

# c - RAM变量中ROM变量的指针？

> ID：13484050
> 
> 赞同：3
> 
> 时间：2012-11-20T23:35:06.443
> 
> 标签：c, c18

我正在使用 Microchip C18 编译器做一个项目。我有一个称为块的结构，它指向其他块（东北西南）。这些块将使我成为一张地图。然后我有一个指针，我用它来评估一切。

仅使用 RAM，它看起来像：

```
struct block{
        struct block *north;
        struct block *east;
        struct block *south;
        struct block *west;
};

struct block map[5] =
{ // just a simple line.
        { NULL, &map[1], NULL, NULL },
        { NULL, &map[2], NULL, &map[0]},
        { NULL, &map[3], NULL, &map[2]},
        { NULL, &map[4], NULL, &map[3]},
        { NULL, NULL, NULL, &map[4]}
};

struct block* position = &map[0]; 
```

这让我可以做类似的事情：

```
void goWest()
{
if(position -> west != NULL) position = position -> west;
} 
```

问题是我的项目中的 RAM 用完了，需要使用 ROM 我目前拥有的是：

```
struct block{
        rom struct block *north;
        rom struct block *east;
        rom struct block *south;
        rom struct block *west;
};
rom struct block map[5] =
{ // just a simple line.
        { NULL, &map[1], NULL, NULL },
        { NULL, &map[2], NULL, &map[0]},
        { NULL, &map[3], NULL, &map[2]},
        { NULL, &map[4], NULL, &map[3]},
        { NULL, NULL, NULL, &map[4]}
}; 
```

我已经做了一些调试，可以告诉上面的部分工作，但试图使位置指针让我很伤心。所以我想我的问题是：

如何将 ROM 变量地址保存在可以编辑其值的指针中？

当我尝试：

```
struct block *position = &map[0]; 
```

我收到“警告 [2066] 分配中的类型限定符不匹配”

我意识到 ROM 变量和 RAM 变量是两个不同的东西，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T23:56:36.800

`rom`宏的定义是什么？我猜它会扩展为`const`（可能是特定于编译器的`__attribute__`或类似的），因为编译器抱怨“类型限定符不匹配”，它指的是 a`const`或`volatile`不匹配。

这意味着您正在尝试将指向常量数据的指针隐式转换为指向非常量数据的指针。此代码应使用您的编译器生成相同的警告：

```
const int x = 0;
int *y = &x;  // &x is "pointer to const" but y is "pointer to non-const" 
```

要修复它，您需要声明您的`position`指针是指向常量数据的指针（根据`rom`宏的定义，应该使用`rom`or 或`const`限定符来完成）：

```
// Declare a non-constant pointer to constant data
const struct block *position = &map[0]; 
```

在每个指针级别，您可以有一个`const`限定符或缺少限定符，对于基本非指针对象也是如此。因此，单级指针可以有 4 种不同的变体：

```
int *x;  // Non-constant pointer to non-constant data
int *const x;  // Constant pointer to non-constant data
const int *x;  // Non-constant pointer to constant data
int const *x;  // Same as above
const int *const x;  // Constant pointer to constant data
int const *const x;  // Same as above 
```

请注意`int const`和`const int`是等价的，但除此之外的位置`const` *确实*很重要。

# grails - 从 Grails 1.3.6 升级到 2.1.1，插件变得疯狂

> ID：13484060
> 
> 赞同：1
> 
> 时间：2012-11-20T23:36:35.793
> 
> 标签：grails, plugins, groovy, sts-springsourcetoolsuite

我使用的是 Grails 1.3.6，并且在部署战争时遇到了上下文加载器的问题。与 run-app 一起工作得很好，但不是 run-war 或 war。

在没有想法之后，我想也许将 Grails 更新到 2.1.1 会有所帮助，但我只是为自己挖了一个更深的洞。

插件似乎来来往往是随机的。每次我退出 STS 并重新启动时，我都会得到一组不同的插件。安装它们不会安装它们，卸载它们也不会卸载它们，无论是通过管理器还是命令行。比如我已经多次升级jquery到1.8.3，但是项目在plugins下还是显示jquery 1.8.0。卸载一个插件后，它仍然会显示在插件下，但是当我再次卸载它时，它说它无法卸载它，因为它没有安装。

主要问题在于灵活。无论我做什么，我的应用程序都无法解析 grails.plugins.nimble.core.ProfileBase 或任何其他属于 nimble 插件的类。

所以使用 nimble 作为测试用例：

在我的项目资源管理器中：插件文件夹包括“nimble 0.4-SNAPSHOT”。

在 application.properties 中，有一行“plugins.nimble=0.4-SNAPSHOT”。

在 ~/.grails/2.1.1/projects/MyProject/plugins 中，有一个带有源代码的 nimble-0.4-SNAPSHOT 文件夹。

在 .../myProject/lib 中同时存在“nimble-0.4-SNAPSHOT.jar”和“nimble-0.4-SNAPSHOT.zip”，因为在不同的点它正在寻找 jar 或 zip。我只是将扩展名从 .zip 更改为 .jar。

在 Grails 插件管理器中，nimble 有一个绿色复选标记，表明它已安装。

我的 BuildConfig.groovy 文件保持不变（虽然我尝试了很多不同的东西，但我已将其设置回原始文件），但为了好玩而将其包含在此处：

```
grails.servlet.version = "2.5" // Change depending on target container compliance (2.5 or 3.0)
grails.project.class.dir = "target/classes"
grails.project.test.class.dir = "target/test-classes"
grails.project.test.reports.dir = "target/test-reports"
grails.project.target.level = 1.6
grails.project.source.level = 1.6
//grails.project.war.file = "target/${appName}-${appVersion}.war"

grails.project.dependency.resolution = {
// inherit Grails' default dependencies
inherits("global") {
    // specify dependency exclusions here; for example, uncomment this to disable ehcache:
    // excludes 'ehcache'
}
log "warn" // log level of Ivy resolver, either 'error', 'warn', 'info', 'debug' or 'verbose'
checksums true // Whether to verify checksums on resolve

repositories {
    inherits true // Whether to inherit repository definitions from plugins

    grailsPlugins()
    grailsHome()
    grailsCentral()

    mavenLocal()
    mavenCentral()

    // uncomment these (or add new ones) to enable remote dependency resolution from public Maven repositories
    //mavenRepo "http://snapshots.repository.codehaus.org"
  // mavenRepo "http://repository.codehaus.org"
   // mavenRepo "http://download.java.net/maven/2/"
   // mavenRepo "http://repository.jboss.com/maven2/"
}
dependencies {
    // specify dependencies here under either 'build', 'compile', 'runtime', 'test' or 'provided' scopes eg.

    // runtime 'mysql:mysql-connector-java:5.1.20'
}

plugins {
    runtime ":hibernate:$grailsVersion"
    runtime ":jquery:1.8.0"
    runtime ":resources:1.1.6"
    //build ":nimble:0.4-SNAPSHOT"

    // Uncomment these (or add new ones) to enable additional resources capabilities
    //runtime ":zipped-resources:1.0"
    //runtime ":cached-resources:1.0"
    //runtime ":yui-minify-resources:0.1.4"

    build ":tomcat:$grailsVersion"

    runtime ":database-migration:1.1"

    compile ':cache:1.0.0'
}

} 
```

那么为什么我的应用程序不知道灵活？我尝试了'clean'、'refresh-dependencies'、'compile'，并以各种可能的组合重新启动，但无济于事。

我认为这一定与没有完全或正确地从 Grails 1.3.6 升级到 2.1.1 有关，但是什么？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T02:29:22.770

从 1.3.6 更改为 2.1.1 是一大步。我在列表中读到并且现在可以想到的是：

*   如果您的应用程序没有很多代码，最好创建一个新项目并复制您的源代码。
*   BuildConfig.groovy 是现在声明依赖的方式，使用它而不是 install-plugin （可能因为这个你的项目会发疯）

如果创建新项目和复制文件不是一个选项，请尝试小步骤（转到 grails 1.3.7，然后是 2.0.4，然后是 2.1.1）

# python - 单元测试时如何获取实际的 Pyramid 请求

> ID：13484061
> 
> 赞同：5
> 
> 时间：2012-11-20T23:36:35.357
> 
> 标签：python, unit-testing, pyramid

我有一个 Pyramid 应用程序，我仍在努力学习。我应该为它编写单元测试，但我不知道如何构建请求。

我看到 Pyramid 有一个带有 a 的测试模块，`DummyRequest`但这是空白的，显然如果我将它传递到视图中，它将失败，因为它没有填充请求在运行时将具有的属性。

所以问题是，如何在测试时传递一个看起来像运行时请求的请求？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-21T06:27:21.220

每当您进行单元测试（与功能测试不同）时要意识到的是，您正在测试一个小“单元”。该单元（在这种情况下是您的视图）不需要“真正的”请求，也不需要完整的工作系统。该视图对自称为“请求”的对象可能具有的某些期望，但仅此而已，它当然不需要真实请求中可用的所有内容。这就是模拟或虚拟对象发挥作用的地方。你想测试你的视图，所以你可以将一些东西传递到你的视图中，它需要检查它是否在做这项工作。假设您有以下配置：

```
def main():
    config = Configurator()
    config.add_route('user', '/users/{uid}')
    return config.make_wsgi_app()

@view_config(route_name='user', renderer='user_template.mako')
def user_view(request):
    uid = request.matchdict['uid']
    user = find_user(request, uid)
    if user is None:
        raise HTTPNotFound
    return {'user': user}

def find_user(request, uid):
    return request.db.query(User).filter_by(id=uid).first() 
```

太好了，所以这是一个真实的视图，您会注意到它只要求请求具有 2 个属性，`matchdict`并且`db`. 好吧，我们可以这样做：

```
class Test_user_view(unittest.TestCase):
    def test_it(self):
        req = DummyRequest()
        req.db = DummyDB()
        req.matchdict = {'uid': '3'}
        result = user_view(req)
        self.assertEqual(result['user'].id, 3) 
```

现在我们在这里没有解决的一件事是实现，`DummyDB`但更好的方法可能是模拟`find_user`返回一个虚拟值。这使测试保持简单并专注于视图本身，而不会陷入与数据库的对话。那是一个单独的测试。

这里的其他答案更彻底地涵盖了功能测试，您应该确定使用 WebTest 来帮助确保您的整个应用程序按预期工作，但这不是单元测试的领域。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T02:57:34.803

如果您还没有这样做，请查看[Pyramid 单元与集成与功能测试](http://pyramid.readthedocs.org/en/latest/narr/testing.html)和[Pyramid 测试指南。](http://docs.pylonsproject.org/en/latest/community/testing.html)恕我直言，从功能测试开始，而不是使用 DummyRequest 进行单元测试，在许多情况下往往会给出更好的结果（即更容易实现和维护）。我建议使用[Webtest（金字塔文档中的示例）](http://pyramid.readthedocs.org/en/latest/narr/testing.html#creating-functional-tests)或[Selenium](http://selenium-python.readthedocs.org/en/latest/installation.html#introduction)库（或两者的组合）。使用 webtest 将允许您测试基本功能，并且测试通常会比 Selenium 运行得更快。Selenium 实际上可以启动浏览器并允许更精细的控制。因为它会启动浏览器，所以 selenium 测试往往需要更长的时间才能运行。我认为一个好的经验法则是，如果您只需要基本测试（例如，查看特定页面是否加载），那么坚持使用 Webtest。如果您的测试需要对浏览器进行更多控制（例如调试 javascript），请尝试 Selenium。查看上面链接的文档，了解如何使用这些库进行测试的示例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T07:12:35.180

您可以在 setUp 函数中构建这样的“假”请求：

```
request = testing.DummyRequest()
request.errors = errors.Errors([])
request.validated = {} 
```

然后在你的一个测试中设置你想要测试的参数。像这样：

```
request.GET['app_id'] = 'xxxxxxxxx'
valid_register(request)
self.assertTrue('app_id' in request.validated) 
```

希望这可以帮助

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T03:59:42.440

我认为布赖恩的回答很好，但会补充说“尽可能多地编写易于测试的代码”是一个有用的口头禅。在某种程度上，您可以使功能模块化并编写易于使用您熟悉的非请求依赖方式进行单元测试的可移植库，您会很高兴。

功能测试比单元测试更难、更慢、更差一个数量级；正如 Brian 提到的，Webtest 是 Pyramid 的所在。硒是另一个数量级的更难、更混乱、更慢。当心; 如果您的测试依赖于实际数据，那么随着数据的变化，它们会随着时间的推移而中断。模拟和良好的虚拟数据可以帮助解决这个问题。在必要时使用更高级别、更困难的测试形式，但不仅仅是为了好玩——您可以在某种程度上使用您的架构来减少对它的需求。

要回答实际的“你好吗”问题：如果你有类似 Webtest 的东西，你只需做一些设置，然后做类似的事情

```
response = app.get('/form.html') 
```

然后你有一个方便的响应对象，其中包含你想要的所有信息，然后你写你的断言。文档中的[教程](http://webtest.pythonpaste.org/en/latest/#testapp)将比我解释得更好。

# ios - 在 SplitView 中设置两个 View 以保持对彼此的引用是不是很糟糕？

> ID：13484062
> 
> 赞同：0
> 
> 时间：2012-11-20T23:36:39.657
> 
> 标签：ios, memory-management, uisplitviewcontroller, retain-cycle, strong-references

我目前正在编写一个 RSS 程序，其中我的 splitViewController 的视图必须相互通信。它们目前都持有彼此的属性实例，如下所述，在 App Delegate 中声明。我想知道这是否是不好的编程习惯，如果是，我应该怎么做才能避免它？

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];

    // Override point for customization after application launch.
    FCListViewController *lvc = [[FCListViewController alloc]initWithStyle:UITableViewStylePlain];
    UINavigationController *masterNav = [[UINavigationController alloc] initWithRootViewController:lvc];

    FCContentViewController *cvc = [[FCContentViewController alloc] init];

/*----------------------------------------- */ //<---------My question lies here

    [lvc setContentViewController:cvc];
    [cvc setListViewController:lvc]; 
```

/ *-----------------------------------------* /

```
 //[lvc setWebViewController:wvc];

    //[[lvc navigationItem]setTitle:@"Falcon RSS Feed"];

   // [[self window] setRootViewController:masterNav];

    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPad) {
        UINavigationController *detailNav = [[UINavigationController alloc] initWithRootViewController:cvc];
        NSArray *vcs = [NSArray arrayWithObjects:masterNav, detailNav, nil];
        UISplitViewController *svc = [[UISplitViewController alloc] init];

        [svc setDelegate:cvc];
        [svc setViewControllers:vcs];

        [[self window]setRootViewController:svc];
          [[svc view] setBackgroundColor:[UIColor clearColor]]; //eliminates annoying black background for the listViewController when rotated

    }
    else{
        [[self window] setRootViewController:masterNav];
    }

    UIColor *blueHue = [UIColor colorWithRed:.2 green:.3 blue:.5 alpha:.7];
    self.window.backgroundColor = blueHue; //Sets upper most background.. noticed when rotating
    [self.window makeKeyAndVisible];
    return YES;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:58:28.637

如果我正确理解您的问题，您可以这样做，但如果它是一个真正的循环引用并且两个属性都是“强”的，那么您可能会遇到永远不会释放它们的情况。因此，如果你有一个对象的反向引用，那么你想使用“弱”，这样它就不会增加保留计数并在它应该被销毁时保留它。

# sql-server - 将3张表合并为一张表

> ID：13484064
> 
> 赞同：0
> 
> 时间：2012-11-20T23:36:58.910
> 
> 标签：sql-server, sql-server-2008

我有三个具有完全相同列的表，唯一的区别是这些列中的数据。我想知道是否（以及如何）将这些列合并到一个表中。我知道如果合并两个表，数据可以通过布尔值来区分，但是三个表也可以这样做吗？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T23:42:37.343

如果列和数据类型相同，则可以使用`UNION ALL`查询。

```
select col1, col2, 'table1' as src
from table1
union all
select col1, col2, 'table2' as src
from table2
union all
select col1, col2, 'table3' as src
from table3 
```

此版本将包含任何重复记录，如果您不想要重复记录，则可以使用`UNION`它将删除任何重复记录。

如果数据类型不同，则需要将数据转换为相同类型。

# c# - 如何将实体添加到 Db 上下文并重新设置网格的数据源

> ID：13484065
> 
> 赞同：1
> 
> 时间：2012-11-20T23:37:02.843
> 
> 标签：c#, database, linq, entity-framework, dbcontext

我正在使用实体框架并将我的数据拉到网格中。我有一个弹出表单，可以让我添加一个新项目，如果我单击“确定”，它将把它添加到数据库上下文中。像这样：

```
private void tsb_AddGroup_Click(object sender, EventArgs e)
    {
        var group = new PeriodicReportGroup();

        frmGroups frm = new frmGroups(group);
        if (DialogResult.OK == frm.ShowDialog())
        {
            Database.PeriodicReportGroups.Add(group);
        }
        InitGrid();
    } 
```

然后，在对话框关闭后，我希望我的网格刷新并拥有我刚刚添加的新项目。但是，由于我添加到上下文中的项目已由*我实例化*，而不是读取数据库，所以当我调试我的代码时，我可以看到虽然我的数据库上下文确实包含它，但它的类型与所有其他项目不同：我添加的是类型

```
{ReportData.PeriodicReportGroup} 
```

而其他的是类型

```
{System.Data.Entity.DynamicProxies.PeriodicReportGroup_3FCAD12B682C11C86AC1CF299E0617B21F74CC5F468C3577CE33B51A8CF38372} 
```

因此，当我将我的 Db 上下文实体设置为网格的数据源时，新的实体会丢失，并且不会显示在网格中。

我找到了一种解决此问题的方法，即使用该`Local`属性：

```
gridGroups.DataSource = Database.PeriodicReportGroups.Local.ToList().Cast<IPeriodicReportGroup>().OrderBy(g => g.Name).ToList( ); 
```

只要之前引用了 Db 上下文实体，这将起作用。这使得在我们第一次加载网格时需要一些垃圾代码才能使其工作，如下所示：

```
if (Database.PeriodicReportGroups.Local.Count == 0)
        {
            var data = Database.PeriodicReportGroups.ToList();
        } 
```

我不敢相信没有更好的方法来做到这一点。任何人都可以提供一些想法？谢谢！

# java - 在 Android 中下载文件

> ID：13484066
> 
> 赞同：0
> 
> 时间：2012-11-20T23:37:04.323
> 
> 标签：java, android

> **可能重复：**
> [Android下载二进制文件问题](https://stackoverflow.com/questions/576513/android-download-binary-file-problems)

我尝试从 Internet 下载文件失败。服务启动时，下载文件的大小冻结在 325 B。我已获得 Internet 连接以及访问 Internet 和写入外部存储的权限。

```
public class DownloadService extends IntentService {

    public DownloadService() {
        super(null);
    }

        @Override
    protected void onHandleIntent(Intent arg0) {
        Log.d("service", "onHandleIntent()");
        try {
            URL fileUrl = new URL("http://goo.gl/Mfyya");

                HttpURLConnection urlConnection = (HttpURLConnection)fileUrl.openConnection();
                urlConnection.setRequestMethod("GET");
            //  urlConnection.setDoOutput(true);
                urlConnection.connect();

                File sdcard = new File (Environment.getExternalStorageDirectory()+"/my");
                File file = new File (sdcard, "filename.mp4");

                FileOutputStream fileoutput = new FileOutputStream (file);
                InputStream inputstream = urlConnection.getInputStream();

            //  int totalSize = urlConnection.getContentLength();
                int downloadedSize = 0;
                byte[] buffer = new byte[1024];
                int bufferlength =0;

                while ((bufferlength = inputstream.read(buffer)) >= 0)
                {   
                    fileoutput.write(buffer, 0, bufferlength);
                    downloadedSize += bufferlength;
                    //updateProgress(downloadedSize, totalSize);
                }
                fileoutput.close();
            } catch (IOException e) {
                //Log.d("service", "error");
                e.printStackTrace();
            }
    }
} 
```

出了什么问题？

# objective-c - 为什么我的图像交换不起作用？

> ID：13484068
> 
> 赞同：0
> 
> 时间：2012-11-20T23:37:12.923
> 
> 标签：objective-c, ios

这似乎很容易，我很尴尬。每次我触发它时，它都停留在“开启”状态。它永远不会通过条件关闭。

```
-(void) lightbulbSwapImages
{
    NSImage *bulbOn = [NSImage imageNamed: @"sidebar_lightbulb_on.png"];
    NSImage *bulbOff = [NSImage imageNamed: @"sidebar_lightbulb_off.png"];
    if (lightbulb.image = bulbOff)
    [self.lightbulb setImage: bulbOn];
    else
    [self.lightbulb setImage: bulbOff];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:44:04.217

更改`=`为`==`。

```
- (void)lightbulbSwapImages
{
    NSImage *bulbOn = [NSImage imageNamed: @"sidebar_lightbulb_on.png"];
    NSImage *bulbOff = [NSImage imageNamed: @"sidebar_lightbulb_off.png"];
    if (self.lightbulb.image == bulbOff)
       [self.lightbulb setImage: bulbOn];
    else
       [self.lightbulb setImage: bulbOff];
} 
```

**您的问题背后的原因：** 您正在做的是，尝试分配`bulbOff`和您正在检查的结果作为一个条件，如果不为零`lightbulb.image`，则该条件将始终返回。因此，它永远不会执行您的 else 部分。`true``lightbulb.image`

相当于，

```
lightbulb.image = bulbOff;

if (lightbulb.image) { 
```

附带说明一下，如果您使用`@property`for `lightbulb`，请在包括 if 条件在内的所有地方使用相同的内容，使其保持一致。在我的回答中，我已从 更改`lightbulb.image`为`self.lightbulb.image`。

# html - 在另一个 DIV 中更改特定 DIV 的样式

> ID：13484071
> 
> 赞同：1
> 
> 时间：2012-11-20T23:37:32.467
> 
> 标签：html, css, css-selectors

> **可能重复：**
> [带有类的第一个元素的 CSS 选择器](https://stackoverflow.com/questions/2717480/css-selector-for-first-element-with-class)

目前我有一个看起来像这样的代码：

```
<div class="content">
   <div style="...">...</div>
   <div class="post">...</div>
   <div class="post">...</div>
   <div class="post">...</div>
   <div class="post">...</div>
   <div class="post">...</div>
</div> 
```

在这个例子中，我如何定位第一个“post”类？换句话说，我必须使用什么 CSS 选择器？

```
<div class="content">
   <div style="...">...</div>
   <div class="post">...</div> <--- I need a selector to edit the styles for this.
   <div class="post">...</div>
   <div class="post">...</div>
   <div class="post">...</div>
   <div class="post">...</div>
</div> 
```

任何帮助将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T23:40:55.890

您需要第 n 个子选择器

```
.post:nth-child(2)
{
//css
} 
```

[小提琴](http://jsfiddle.net/gXtG9/)

# java - 如何在上传之前在我的 Android 设备上调整 .jpg 图像文件的大小？

> ID：13484072
> 
> 赞同：0
> 
> 时间：2012-11-20T23:37:38.400
> 
> 标签：java, android, android-image, android-file

> **可能重复：**
> [从文件调整图像大小](https://stackoverflow.com/questions/8420802/resize-image-from-file)

我有`File f`一个.jpg。我想在将其上传到我的 PHP Web 服务之前将其调整为 640x480。我希望它保持正确的比例（没有拉伸/歪斜）。

最快和最简单的方法是什么？

# objective-c - 如何创建一个 4 字节大的 NSData？

> ID：13484083
> 
> 赞同：1
> 
> 时间：2012-11-20T23:38:15.847
> 
> 标签：objective-c, ios, nsdata

我想通过每 10 秒安排的重复 ping 来保持 GKSession 的活动。有人说 NSData 对象应该是 4 个字节长。

如何创建这样一个 4 字节的 ping NSData 对象？像这样？

```
int number = 1234;
NSData *pingData = [NSData dataWithBytes:&number length:4]; 
```

还是有更简单/更准确的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T23:48:51.590

如果“四个字节”是代码含义的核心，则最好将变量键入为`uint32_t`. 该类型被明确定义为 4 个字节宽，而`int`通常假定为 4 个字节，但并不能真正保证如此。

但是无论哪种方式，您创建数据对象的代码都是正确的。

# iphone - EXC_CRASH (SIGABRT) 无法追踪 - 请参阅附加的崩溃日志 - GADObjectPrivate.m

> ID：13484084
> 
> 赞同：0
> 
> 时间：2012-11-20T23:38:19.797
> 
> 标签：iphone, xcode, ipad, crash, sigabrt

我的一个应用程序有问题，苹果拒绝了它，因为它在启动时崩溃了——但是我无法复制它。我什至为另一台设备提供了一个临时构建来测试，它工作正常。无论如何，他们发送了崩溃日志，我在 Organizer 中打开它以象征性。

异常类型：EXC_CRASH (SIGABRT) 异常代码：0x0000000000000000, 0x0000000000000000 线程崩溃：0

```
Last Exception Backtrace:
0   CoreFoundation                  0x3311d29e __exceptionPreprocess + 158
1   libobjc.A.dylib                 0x39dff97a objc_exception_throw + 26
2   CoreFoundation                  0x33120e02 -[NSObject(NSObject) doesNotRecognizeSelector:] + 166
3   CoreFoundation                  0x3311f52c ___forwarding___ + 388
4   CoreFoundation                  0x33076f64 _CF_forwarding_prep_0 + 20
5   diamondlite                 0x00065aec -[GADObjectPrivate loadPrivateRequest:autoRefresh:] (GADObjectPrivate.m:402)
6   diamondlite                 0x00067540 -[GADObjectPrivate loadRequest:] (GADObjectPrivate.m:827)
7   diamondlite                 0x0006501c -[GADBannerView loadRequest:] (GADBannerView.m:271)
8   diamondlite                 0x00012f40 -[GalleryViewControllerViewController viewWillAppear:] (GalleryViewControllerViewController.m:94)
9   UIKit                           0x38e94314 -[UIViewController _setViewAppearState:isAnimating:] + 132
10  UIKit                           0x38ea08bc -[UINavigationController _startTransition:fromViewController:toViewController:] + 828
11  UIKit                           0x38ea04a4 -[UINavigationController _startDeferredTransitionIfNeeded:] + 320
12  UIKit                           0x38e714dc -[UILayoutContainerView layoutSubviews] + 176
13  UIKit                           0x38e307fe -[UIView(CALayerDelegate) layoutSublayersOfLayer:] + 254
14  QuartzCore                      0x3ab04d5e -[CALayer layoutSublayers] + 210
15  QuartzCore                      0x3ab048fc CA::Layer::layout_if_needed(CA::Transaction*) + 456
16  QuartzCore                      0x3ab337a2 -[CALayer layoutIfNeeded] + 138
17  UIKit                           0x38eda0c4 -[UIViewController window:setupWithInterfaceOrientation:] + 204
18  UIKit                           0x38ed92b0 -[UIWindow _setRotatableClient:toOrientation:updateStatusBar:duration:force:isRotating:] + 3616
19  UIKit                           0x38ed8482 -[UIWindow _setRotatableClient:toOrientation:updateStatusBar:duration:force:] + 42
20  UIKit                           0x38ed840c -[UIWindow _setRotatableViewOrientation:duration:force:] + 64
21  UIKit                           0x3900e17c __57-[UIWindow _updateToInterfaceOrientation:duration:force:]_block_invoke_0 + 100
22  UIKit                           0x38e96674 -[UIWindow _updateToInterfaceOrientation:duration:force:] + 212
23  UIKit                           0x38e963b8 -[UIWindow setAutorotates:forceUpdateInterfaceOrientation:] + 688
24  UIKit                           0x38e95d26 -[UIViewController _tryBecomeRootViewControllerInWindow:] + 154
25  UIKit                           0x38e8ce9e -[UIWindow addRootViewControllerViewIfPossible] + 366
26  UIKit                           0x38e88ae0 -[UIWindow _setHidden:forced:] + 360
27  UIKit                           0x38eca1c4 -[UIWindow makeKeyAndVisible] + 56
28  diamondlite                 0x000112fc -[AppDelegate application:didFinishLaunchingWithOptions:] (AppDelegate.m:96)
29  UIKit                           0x38e8dacc -[UIApplication _handleDelegateCallbacksWithOptions:isSuspended:restoreState:] + 248
30  UIKit                           0x38e8d656 -[UIApplication _callInitializationDelegatesForURL:payload:suspended:] + 1186
31  UIKit                           0x38e8583e -[UIApplication _runWithURL:payload:launchOrientation:statusBarStyle:statusBarHidden:] + 694
32  UIKit                           0x38e2dc34 -[UIApplication handleEvent:withNewEvent:] + 1000
33  UIKit                           0x38e2d6c8 -[UIApplication sendEvent:] + 68
34  UIKit                           0x38e2d116 _UIApplicationHandleEvent + 6150
35  GraphicsServices                0x365a959e _PurpleEventCallback + 586
36  GraphicsServices                0x365a91ce PurpleEventCallback + 30
37  CoreFoundation                  0x330f216e __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__ + 30
38  CoreFoundation                  0x330f2112 __CFRunLoopDoSource1 + 134
39  CoreFoundation                  0x330f0f94 __CFRunLoopRun + 1380
40  CoreFoundation                  0x33063eb8 0x3305b000 + 36536
41  CoreFoundation                  0x33063d44 0x3305b000 + 36164
42  UIKit                           0x38e84478 0x38e2a000 + 369784
43  UIKit                           0x38e812f4 UIApplicationMain + 1116
44  diamondlite                 0x00010dc2 main (main.m:16)
45  diamondlite                 0x00010d5c start + 36

Thread 0 name:  Dispatch queue: com.apple.main-thread
Thread 0 Crashed:
0   libsystem_kernel.dylib          0x32047350 __pthread_kill + 8
1   libsystem_c.dylib               0x39d9e11e pthread_kill + 54
2   libsystem_c.dylib               0x39dda96e abort + 90
3   libc++abi.dylib                 0x37fa7d4a abort_message + 70
4   libc++abi.dylib                 0x37fa4ff4 default_terminate() + 20
5   libobjc.A.dylib                 0x39dffa74 _objc_terminate() + 144
6   libc++abi.dylib                 0x37fa5078 safe_handler_caller(void (*)()) + 76
7   libc++abi.dylib                 0x37fa5110 std::terminate() + 16
8   libc++abi.dylib                 0x37fa6594 __cxa_rethrow + 84
9   libobjc.A.dylib                 0x39dff9cc objc_exception_rethrow + 8
10  CoreFoundation                  0x33063f1c CFRunLoopRunSpecific + 452
11  CoreFoundation                  0x33063d44 CFRunLoopRunInMode + 100
12  UIKit                           0x38e84478 -[UIApplication _run] + 664
13  UIKit                           0x38e812f4 UIApplicationMain + 1116
14  diamondlite                 0x00010dc2 main (main.m:16)
15  diamondlite                 0x00010d5c start + 36 
```

最后它还说；

```
Thread 0 crashed with ARM Thread State (32-bit):
    r0: 0x00000000    r1: 0x00000000      r2: 0x00000000      r3: 0x3cbef534
    r4: 0x00000006    r5: 0x3cbefb88      r6: 0x1dd82414      r7: 0x2fdf2a14
    r8: 0x1dd823f0    r9: 0x00000300     r10: 0x00000000     r11: 0x000b55de
    ip: 0x00000148    sp: 0x2fdf2a08      lr: 0x39d9e123      pc: 0x32047350
  cpsr: 0x00000010 
```

我只是不知道是什么导致了问题？因为我无法在我的设备上复制它，这使得它变得更加困难 - 我希望有人能提供帮助吗？

谢谢，

克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T18:14:14.020

答案是将 Admob 横幅请求移动到 ViewDidAppear 部分，奇怪的是这似乎解决了它:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-12T08:41:47.517

我遇到了完全相同的问题，但导致它的原因略有不同。每当我从 XCode 运行应用程序时，它都运行良好，但 Appstore 继续拒绝它。

不幸的是，他们在正确的地方，并且应用程序在启动时确实崩溃了**EXC_CRASH (SIGABRT) 异常代码： 0x0000000000000000, 0x0000000000000000**。

只有在我最终意识到存档构建使用与调试构建不同的构建设置之后，我才能够重现它。

我的错误是我重命名了我的故事板，开发人员仍然选择了它的一个版本，但存档构建没有。

从中吸取的教训：

*   始终创建一个存档构建，您使用组织者中的临时分发分发它（不要使用您的分发签名实体对其进行签名。）
*   将它创建的 IPA 文件拖到您的 iTunes 中
*   从您的设备中删除应用程序
*   将 IPA 创建的新应用程序部署到您的设备。

您现在正在运行将发送到 Appstore 的实际构建，并且应该能够重现其中一些令人讨厌的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-04T07:25:48.233

此问题与缺少 -ObjC 链接器标志有关。

因此，添加链接器标志 -objC 调试和发布（用于存档的配置文件）

您还可以使用临时配置文件测试您的发布二进制文件。

# php - 如何在一个脚本中多次使用 SELECT (500 000) 次？

> ID：13484085
> 
> 赞同：0
> 
> 时间：2012-11-20T23:38:30.330
> 
> 标签：php, mysql, import

我正在尝试解决更新问题或将新产品从文件（csv）插入数据库。

问题是 CSV 文件中只有产品的编号和供应商。所以我需要为每个产品寻找这个供应商和编号的 ID。如果没有找到产品，我需要插入新的，否则我只会更新存储信息和价格。

该 csv 有 500 000 个产品 (34MB)。

现在我正在用这样的代码解决这个问题（但由于没有内存空间（使用 2GB），脚本在 50 000 个文件行后停止：

```
 while (!feof($file_handle)) 
    {   
        $data = fgetcsv($file_handle,5096,$i->column_separator);

        if($row >= ($i->firstrow-1) && !empty($data[$i->column_product_code-1]) && !empty($data[$i->column_product_name-1]) && !empty($data[$i->column_price-1]) && $data[$i->column_price-1] > 0)
        {                            
            @$code = str_replace(array(' ','.','-','/'),'',$data[$i->column_product_code-1]);
            @$supplier = iconv('WINDOWS-1250','UTF-8', $data[$i->column_producer_name-1]);
            @$name = iconv('WINDOWS-1250','UTF-8', $data[$i->column_product_name-1]);

            $article = $articleModel->searchImport($code,$supplier,isset($data[$i->column_producer_code-1]) ? $data[$i->column_producer_code-1]:NULL);

            if($article !== FALSE)
            {
                $importqueueModel->update()
            }
            else
            { 
                $importqueueModel->insert()
            } 
```

我无法弄清楚如何从文件中匹配产品代码和供应商以从数据库中获取 ID，以便我可以更新或将新产品插入数据库中。

请帮助，任何提示将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T00:12:34.343

作为一般经验法则，如果您认为需要在脚本中运行数百个查询，那么您做错了。数千？非常错误。

不要将 CSV 中的数据直接加载到已经包含实时数据的目标表中 - 将其加载到临时表中 - 然后单个 insert....select 将填充相关记录：

```
INSERT INTO suppliers (name, status)
SELECT c.supplier, 'new'
FROM csv_imported c
LEFT JOIN suppliers s
ON c.supplier=s.name
WHERE s.name is NULL
AND c.supplier IS NOT NULL; 
```

并且使用 mysqlimport / load data infile 也消除了对大量代码的需要。

> 因为没有内存空间（使用了2GB）

即使以错误的方式进行操作也不会导致此问题 - 您的代码中存在错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T00:02:36.007

您可以添加一个新方法`$importQueueModel`来支持 MySQL 扩展的 INSERT 语法`ON DUPLICATE UPDATE`。这不是便携式的，但可以解决您当前的问题。

另一个（更好的）解决方案是编写一个 MySQL 脚本来处理更新。您可以修改您的 PHP 脚本以输出 SQL，然后单独运行它。

[插入](http://dev.mysql.com/doc/refman/4.1/en/insert.html)参考手册。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T23:57:19.983

在您的代码中的某处，您正在存储有关从 CSV 文件读取的每一行的数据。这似乎不包含在您发布的不完整片段中，除非它是`$articleModel->searchImport()`方法调用的一部分。

如果幸运的话，您在帖子中省略的错误/异常消息可能会直接指向有问题的行。

# emacs - 如何在搜索/替换中预览正则表达式？

> ID：13484090
> 
> 赞同：4
> 
> 时间：2012-11-20T23:38:55.120
> 
> 标签：emacs, elisp, replace

是否有一个包（或自由浮动的 elisp）可以动态预览 Emacs 中正则表达式搜索/替换的匹配和效果？我相信一些专门的模式可以提供类似的东西，但我一直无法找到通用的解决方案。

我应该注意，我熟悉 regexp-builder，但它只预览匹配项并要求我在缓冲区之间复制字符串——这不是一个完美的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-06-29T21:36:29.510

[visual-regexp](https://github.com/benma/visual-regexp.el)允许内联预览替换：

[![在此处输入图像描述](../Images/8f16aca59a64ae51f649118dc88043f7.png)](https://i.stack.imgur.com/I1k3E.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T02:13:52.927

“预览匹配”的一种方法是通过`isearch-forward-regexp`( `C-M-s`) 输入正则表达式，它会在您编写正则表达式时以交互方式突出显示匹配项，然后调用`isearch-query-replace-regexp`with `C-M-%`（即正常`query-replace-regexp`绑定）。

要查看整个缓冲区的匹配项（而不仅仅是可见部分），您可以`M-s``o`在输入 isearch 正则表达式以运行时键入`isearch-occur`。minibuffer 保持选中状态，因此您可以继续编辑正则表达式。

我不确定“预览”替代品。我怀疑大多数人只是简单地进行替换，如果是错误的再次撤消它？（我不确定这与预览功能之间是否有很大不同）。

**编辑：** ~~我猜`occur`缓冲区确实有助于各种“替换预览”选项。它仅限于发生缓冲区，但也许这已经足够了。~~

Emacs 24 有一个相当有用的功能`occur-edit-mode`：`e`输入发生缓冲区，您可以将匹配项编辑为文本（因此您可以在该缓冲区中执行搜索和替换）。编辑发生缓冲区后，键入`C-c``C-c`将更改写回原始缓冲区；但*在*您这样做之前，更改仅存在于发生缓冲区本身中，作为您确认它们时会发生什么的预览。

~~按原样，这并没有像你想要的那样顺利地与这个答案的原始部分结合起来，但它似乎确实值得一提。~~

**编辑2：**哦，好吧，我之前的编辑是个谎言。或者至少对于我所写的内容不够一致。我认为发生编辑模式不会立即对原始缓冲区进行更改，*有时*确实如此，但大多数情况下它会与发生缓冲区同时更新原始缓冲区。我不确定为什么它不一致，但显然你不能像我建议的那样将它视为预览。

# json - JQuery，对理解 JSON 的这个函数有什么帮助

> ID：13484091
> 
> 赞同：0
> 
> 时间：2012-11-20T23:38:57.053
> 
> 标签：json, jquery, http-headers

我正在研究使用 JQuery 的 Spring MVC Showcase，但我对 JQuery 世界还是很陌生

我对研究这个例子的 JQuery 函数的行为有些怀疑。

所以，我有以下链接生成一个指向“/mapping/produces”文件夹的 HTTP 请求

```
 <li>
            <a id="byProducesAcceptJson" class="writeJsonLink" href="<c:url value="/mapping/produces" />">By produces via Accept=application/json</a>
        </li> 
```

如您所见，此链接具有名为“writeJsonLink”的类，并且对于该类，定义了单击链接时触发的以下 JQuery 函数：

```
$("a.writeJsonLink").click(function() {
    var link = $(this); // Variable that contain the referer to the clicked link 

    // Execute ajax call
    $.ajax({ url: this.href,    

        // Before send the request to the server execute the following function
        beforeSend: function(req) {
            if (!this.url.match(/\.json$/)) {
                req.setRequestHeader("Accept", "application/json");
            }
        },
        success: function(json) {
            MvcUtil.showSuccessResponse(JSON.stringify(json), link);
        },
        error: function(xhr) {
            MvcUtil.showErrorResponse(xhr.responseText, link);
        }});
    return false;
}); 
```

我的问题是我在理解 if 条件的含义时遇到了一些问题，这部分代码是什么意思？

```
 if (!this.url.match(/\.json$/)) {
                req.setRequestHeader("Accept", "application/json");
            } 
```

看到在我看来只向 HTTP 请求添加了一个标头......但我认为实际上用 JSON 做一些事情......我也有一些问题来理解 if 逻辑条件的含义......

非常感谢安德里亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:46:09.477

简而言之，代码检查端点 URL 是否以 结尾`.json`，如果是，则添加`Accept: application/json`标头。

```
 if (!this.url.match(/\.json$/)) {
            req.setRequestHeader("Accept", "application/json");
        } 
```

### 这个.url

从当前 xHR 对象中获取 URL

### [匹配](http://www.w3schools.com/jsref/jsref_match.asp)

match() 方法在字符串中搜索与正则表达式的匹配项，并将匹配项作为 Array 对象返回。

### /.json$/

是一个简单的正则表达式，用于检查 URL 是否以`.json`

### req.setRequestHeader("接受", "应用程序/json");

Req 再次是扩展的 xHR 对象，而 [setRequestHeader()](https://developer.mozilla.org/en/docs/Setting_HTTP_request_headers)用于设置请求的标头。在请求的 Accept 标头中设置 accplication/json。就像是`Accept: application/json`

# java - addActionListener 和 "this"

> ID：13484094
> 
> 赞同：1
> 
> 时间：2012-11-20T23:39:24.967
> 
> 标签：java, inheritance, listener, this, actionlistener

情况如下：

我的理解是，当为方法提供参数时（在这种情况下，它将是来自“AbstractButton”类的“addActionListener”方法），提供的对象需要是所需的类型之一（即：“ActionListener”对于“addActionListener”）或实现所需类型的类的类（即：实现“ActionListener”接口的类）。

另外，根据我的理解，“this”是指当前正在调用其方法的类实例，否则是指包含类。

现在这里有一些简单的代码：

```
public class Window extends JFrame implements ActionListener {
    public Window () {
        ...
        private JRadioButton  btn = new JRadioButton("Option");
        btn.addActionListener(this);
    }

    public actionPerformed ( ActionEvent e ) {
        ...
        ...
    }
} 
```

所以这是我的问题：这段代码可以正常工作：“this”关键字指的是正在调用其方法的对象的实例（“btn”），按钮充当它自己的侦听器（这就是) ，并且在单击按钮时按预期调用 actionPerformed 方法。但是，我不明白为什么会这样，因为以下原因：

1.  addActionListener 请求一个 ActionListener 作为参数
2.  “btn”是 JRadioButton 类型
3.  JRadioButton 不是 ActionListener 类型
4.  JRadioButton 没有实现 ActionListener（父类也没有）

有人可以澄清 addActionListener 接受这个对我来说似乎是错误类型的论点吗？

注意：我了解此示例中的 Window 类确实实现了 ActionListener，但我看不出它如何与 btn 变量的类型和 addActionListener 请求的类型进行交互。

谢谢你的时间，杰伊

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T22:03:14.033

> “this”关键字指的是被调用方法的对象的实例（“btn”）

这里的`this`实例是指您的类的实例，`Window`而*不是*`JRadioButton`.

由于类`Window`实现了`ActionListener`，所以它的实现`actionPerformed`可以作为`JRadioButton`提供两个类之间交互的组件的具体实现。

# java - 可绘制路径数组返回 null

> ID：13484100
> 
> 赞同：0
> 
> 时间：2012-11-20T23:39:54.743
> 
> 标签：java, android, arrays, nullpointerexception, drawable

我创建了一个 int 值数组。这些 int 值是可绘制图像的路径 ID，如下所示：

```
int[] picItems = {R.drawable.pic_one, R.drawable.pic_two, R.drawable.pic_three}; 
```

但是，picItem 数组为空。我希望能够从索引中获取值并将其用作背景，如下所示：

```
relative.setBackgroundResource(picItems[index]); 
```

现在，如果我使用上面的代码并将参数字段设置为 R.drawable.pic_one，例如，它可以工作。但是，每当我声明和实例化 int 数组 picItems 时，我都会得到一个空指针异常。我一定是在看一些东西并犯了一个简单的错误，但如果我是，请随时指出。我很感激任何帮助，谢谢！

**编辑：**我尝试了许多不同的方法来声明和实例化数组。即使在实例化它之后数组也是空的，但是在尝试使用它时遇到错误（我使用 if 语句来捕获它）。这里还有一点代码：

```
 public class Snow extends Activity{
        int[] picItems;
        RelativeLayout relative;
        SharedPreferences sp;
        int checkedItem = 0;

        @Override
        public void onCreate(Bundle savedInstanceState){
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

            picItems = new int[]{R.drawable.pic_one, R.drawable.pic_two, R.drawable.pic_three};
            sp = getPreferences(MODE_PRIVATE);
            checkedItem = sp.getInt("picture", 0);
            if (!(picItems == null) || !(picItems.equals(null))){
            Toast.makeText(getApplicationContext(), "Array is null for some reason", Toast.LENGTH_SHORT).show();
        }else{
             relative.setBackgroundResource(picItems[checkedItem]);
        }//end of if
            ...} ...} 
```

这是 Logcat 输出：

```
 11-20 19:00:27.363: E/AndroidRuntime(18311): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.app.Snow/com.app.snow.Snow}: java.lang.NullPointerException
    11-20 19:00:27.363: E/AndroidRuntime(18311):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1821)
    11-20 19:00:27.363: E/AndroidRuntime(18311):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1842)
    11-20 19:00:27.363: E/AndroidRuntime(18311):    at android.app.ActivityThread.access$1500(ActivityThread.java:132)
    11-20 19:00:27.363: E/AndroidRuntime(18311):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1038)
    11-20 19:00:27.363: E/AndroidRuntime(18311):    at android.os.Handler.dispatchMessage(Handler.java:99)
    11-20 19:00:27.363: E/AndroidRuntime(18311):    at android.os.Looper.loop(Looper.java:150)
    11-20 19:00:27.363: E/AndroidRuntime(18311):    at android.app.ActivityThread.main(ActivityThread.java:4263)
    11-20 19:00:27.363: E/AndroidRuntime(18311):    at java.lang.reflect.Method.invokeNative(Native Method)
    11-20 19:00:27.363: E/AndroidRuntime(18311):    at java.lang.reflect.Method.invoke(Method.java:507)
    11-20 19:00:27.363: E/AndroidRuntime(18311):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
    11-20 19:00:27.363: E/AndroidRuntime(18311):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
    11-20 19:00:27.363: E/AndroidRuntime(18311):    at dalvik.system.NativeStart.main(Native Method)
    11-20 19:00:27.363: E/AndroidRuntime(18311): Caused by: java.lang.NullPointerException
    11-20 19:00:27.363: E/AndroidRuntime(18311):    at com.app.snow.Snow.onCreate(Snow.java:54)
    11-20 19:00:27.363: E/AndroidRuntime(18311):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1072)
    11-20 19:00:27.363: E/AndroidRuntime(18311):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1785) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:52:55.043

尝试：

```
final int[] picItems = {R.drawable.pic_one, R.drawable.pic_two, R.drawable.pic_three}; 
```

这样，它一定会被实例化，而且您将突出显示您可能正在更改数组引用的地方，然后您不可能从访问中获得 NPE `picItems`，如果您仍然获得 NPE，那么它就是另一回事了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T00:13:07.900

> 但是，picItem 数组为空。

你让我上当了一会儿。`picItems`很好。`relative`为空，将其初始化为`onCreate()`：

```
relative = (RelativeLayout) findViewById(R.id.layout); 
                            // Where "layout" is the RelativeLayout's id 
```

# nginx - 如何处理更新 AWS EC2 实例 AMI？

> ID：13484102
> 
> 赞同：0
> 
> 时间：2012-11-20T23:40:13.373
> 
> 标签：nginx, amazon-ec2, amazon-web-services, amazon-ami

在我的 aws 设置中，我有指向多个应用程序服务器的负载平衡，这些应用程序服务器都使用一个通用 API。应用服务器都有相同的 NGINX 配置（nginx.conf），由于各种原因，我现在需要更新。

有什么办法来处理这个？我是否更新 AMI 并重新启动应用服务器？我必须重新启动服务器吗？有没有办法更新 AMI 并使服务器保持运行？

我正在拼命寻找有关如何处理这种情况的教程/最佳实践。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T07:34:39.973

可能[Chef](http://www.opscode.com/chef/)或[Puppet](http://puppetlabs.com/)会完成这项工作。或者您可以通过一个简单的 shell 脚本和`rsync`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-11T05:57:55.250

虽然厨师和木偶是正确的做法，但如果您不想涉足这类事情，只需几个步骤即可完成。

1.  在制作 AMI 时为您的负载平衡实例之一制作 AMI（请勿选择重新启动）。
2.  从该 AMI 创建一个实例，在其中进行更改，然后测试该实例，从该实例创建 AMI。

现在的诀窍是让你的实例变坏，让负载均衡器觉得它变坏了并创建一台新机器来替换坏实例；但是为什么要维护一个新实例，除非您向负载均衡器指定它至少应该有多少个实例，否则它不会，现在没有配置可以这样做，因为它不是负载均衡器配置文件的一部分，它的扩展策略。

因此，使自动缩放策略（使用新的 AMI）偏离路线并进行新的启动配置（使用新的 ami 偏离路线），将最小实例数设置为您想要的任何数量，比如说 2（总是尝试保持一对，并且每当扩大/缩小规模时，请保留几个实例）。

现在继续减少 LB 的健康检查，SSH 进入您的一个实例（停止 nginx），LB 会认为它已经坏了并启动配置以保持最小。将启动多个实例，并使用新的 AMI 引入一个新实例。

# linux - 新的嵌入式项目；哪个 ARM CPU 具有最好的 Linux 支持？

> ID：13484103
> 
> 赞同：3
> 
> 时间：2012-11-20T23:40:16.087
> 
> 标签：linux, linux-kernel, embedded, embedded-linux

我们正在计划一个新的嵌入式板，它必须运行我们开发的定制 Linux 软件。我们当前的平台使用 2.6.32 内核，在 x86 上使用 Debian Lenny。我们没有任何定制硬件，目前所有接口都是通过串行端口。我一直在寻找 TI AM355x 芯片，但看起来他们的 Linux SDK 还没有准备好。还有 BeagleBone，但似乎没有任何官方的 TI 支持，最早的内核是 3.0，它们运行的​​是 Debian Wheezy。

谁能推荐一个支持良好的 ARM CPU，它可以运行 Debian Lenny 的 2.6.32 内核？通过良好的支持，我希望得到主线内核支持的东西，由一家有良好承诺和 Linux 支持历史的公司提供支持，并有付费支持选项。

我知道这有点笼统，但希望有人可以回应供应商来查看和供应商绝对避免？

泰，弗雷德

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T09:58:19.527

我认为你在这里本末倒置。我建议先选择平台，然后再担心操作系统。请注意，即使使用来自相同供应商的相同内核和用户空间版本，x86 和 ARM 系统之间也存在显着差异——尤其是在电源管理和驱动程序方面。

内核版本 2.6.32 也相当老了 - 实际上在快速发展的 ARM SoC 世界中是古老的。新功能往往不会被向后移植。

就*最受支持*的ARM SoC 而言，至少有以下因素：

*   一个特定的内核树（几乎从不是主线）支持 ARM SoC 的所有功能
*   [付费] SoC 提供商业或供应商支持
*   使用 SoC 可提供多种 COTS 系统选择。
*   操作系统发行版中的完整系统支持
*   由开发者/爱好者社区支持

以[Pandaboard](http://www.pandaboard.org)作为案例研究，因为它已被其他几张海报提及：

*   最近的主线发行版支持大多数设备功能
*   广泛的社区支持——尽管很少有文档是权威的或维护的，而且很难找到答案。如果你被卡住了，你将独自一人。
*   您不能购买 Pandaboard 用于生产用途，它作为评估板出售，几乎没有供应商支持。
*   你不能大量购买 Pandaboard。
*   TI 不提供对 OMAP4 的支持，除非您是 1 级 OEM，尽管大部分数据表（7k 页，44MiB）都是公开的。NDA 下的其他部分。

从您的描述中可以清楚地看出，这不符合您的需求。因此，我建议查看 COTS 系统。

我在使用[PhyTec](http://www.phytec.eu/europe)的产品方面有很好的经验，他们制作了许多不同的基于 ARM SoC 的系统（在某些情况下，在可互换的模块上）。他们发布了符合[Pengutronix 的](http://www.pengutronix.de/index_de.html)Linux 发行版的系统，尽管没有什么可以阻止您使用他们的内核和其他人的用户空间（我使用 Angstrom）。PhyTec 的内核补丁被贡献给[linux-omap](http://git.kernel.org/?p=linux/kernel/git/tmlind/linux-omap.git;a=summary)树。[5]

还有很多其他类似 COTS 系统的供应商。

不用说，这些 COTS 板不直接由主线发行版支持，尽管在实践中相当接近。

[5]：对于 ARM SoC，Linux 主线值得避免。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T13:50:35.313

试试[cubieboard](http://cubieboard.org)，它是另一个更高端的树莓派。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T05:31:35.183

试试[arm9board.net的](http://www.arm9board.net)[OK6410](http://www.arm9board.net/sel/prddetail.aspx?id=348&pid=200)，我一直在使用它并在其上运行 Linux 2.6.36、3.0.1、Ubuntu 和 Debian，这是一个非常漂亮且功能强大的板，具有丰富的教程和有用的资源。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T01:27:51.117

我相信 Rasberry Pi 和 PandaBoard 会非常适合您。

第一个有 Debian Wheezy (http://www.raspberrypi.org/downloads)，第二个 - Ubuntu (http://omappedia.org/wiki/PandaBoard_Ubuntu_How-tos)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-26T09:57:06.607

到目前为止，Wandboard 对我来说是排名第一的竞争者-> [LINK](http://www.wandboard.org/index.php/details)

GPIO……单核、双核或四核……千兆网……你的名字！

# python - 如何在 python 中使用 [] 作为命名函数参数的默认值？

> ID：13484107
> 
> 赞同：3
> 
> 时间：2012-11-20T23:40:29.960
> 
> 标签：python, constructor, named-parameters

> **可能的重复：**
> [Python 中的“Least Astonishment”：可变默认参数](https://stackoverflow.com/questions/1132941/least-astonishment-in-python-the-mutable-default-argument)

我有这个代码

```
class Test(object):
  def __init__(self, var1=[]):
    self._var1 = var1

t1 = Test()
t2 = Test()

t1._var1.append([1])

print t2._var1 
```

结果我得到“[[1]]”。很明显 t1._var1 和 t2._var1 正在处理同一个列表。如果我把

```
t3 = Test()
print t3._var1 
```

然后我也得到“[[1]]”。所以 var1=[] 似乎将 var1 永久绑定到某些列表。我尝试复制列表，

```
def __init__(self, var1=copy([])): 
```

但得到了相同的结果，因此命名参数的表达式似乎在调用 init 之前被评估，它只是给 var1 一个空列表的副本，然后在实例之间共享。

那么如何使用 [] 作为命名参数的默认值呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T23:42:07.443

`[]`如果您希望每个对象都有一个空列表，则不能直接使用。我倾向于使用解决方法：

```
def __init__(self, var1=None):
    if var1 is None:
        var1 = []
    .... 
```

`var1`如果可以的话，这自然是行不通`None`的，你需要使用不同的对象。

# matlab - 使用matlab求解方程组

> ID：13484109
> 
> 赞同：3
> 
> 时间：2012-11-20T23:40:45.750
> 
> 标签：matlab, system, equations

所以我有以下方程组

```
 x1 - x2 =  20
 x2 - x3 =  30
 x3 - x4 =  75
 x4 - x5 = -49
-x1 + x5 = -20 
```

我将如何使用 Matlab 解决系统问题？我有点卡住了。

很有可能没有解决方案，但如果有人能让我知道该怎么做，那就太好了！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-20T23:47:46.500

首先，将此方程转换为矩阵表示法：

```
A = [ 1 -1  0  0  0
      0  1 -1  0  0
      0  0  1 -1  0
      0  0  0  1 -1
     -1  0  0  0  1];

b = [ 20
      30
      75
     -49
     -20]; 
```

你正在努力寻找`x`给予`Ax = b`。你不能取反，`A`因为它是单数的。要查看此检查其排名；`rank(A) == 4`. `A`如果是非奇异的，它将是 5 。

因此，当从左乘以时，您应该会找到最佳`x`近似值。这是一个优化问题：您希望最小化 和 之间的误差。通常，人们使用最小二乘法。也就是说，您可以最小化残差的平方和。这可以通过[伪逆](http://en.wikipedia.org/wiki/Moore%E2%80%93Penrose_pseudoinverse#Linear_least-squares)来完成，如下所示：`b``A``Ax``b`

```
x = pinv(A) * b 
```

给

```
x =

   31.8000
   23.0000
    4.2000
  -59.6000
    0.6000 
```

最佳近似值由下式找到

```
b2 = A*x

b2 =

    8.8000
   18.8000
   63.8000
  -60.2000
  -31.2000 
```

发现最小二乘误差为

```
e = norm(b-b2)

e =

   25.0440 
```

如果你想尝试其他替代最小二乘的方法来最小化`Ax-b`，你可以google l1-minimization，sparse encoding等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T00:43:53.807

看看它，然后在心里把方程式加起来。LHS 为零，右手边是正数，所以没有解！

# java - 如何在一种方法中从数组中获取值列表并将这些值从我的主要方法中放入一个新数组中

> ID：13484110
> 
> 赞同：1
> 
> 时间：2012-11-20T23:40:48.153
> 
> 标签：java, arrays, methods

```
import java.util.Scanner;

public class PayAndGoParking
{

    public static void main(String Args[])
    {
       int choice=0;
       int numCars=0;
       String Plates[]=new String[50];
       String ccNumbers[]=new String[50];
       Scanner b = new Scanner(System.in);

        choice = printMenu();
        if(choice==1) {
            numCars=addCars(Plates,ccNumbers,numCars,b);
        }

    }

    public static int printMenu()
    {
        Scanner s = new Scanner(System.in);
        int choice;

        System.out.println("Welcome to Park and Go Parking");
        System.out.println("Park from 6 - Midnight for a flat fee of $4.00");

        System.out.println("1\. Register your vehicle");
        System.out.println("2\. Verify vehicle registration");

        System.out.print("Hello enter a Selection: ");
        choice = s.nextInt();

        if(choice==1) {
            System.out.println("Register your vehicle");
        }
        else {
            System.out.println("Verify your registration");
        }

        return choice;
    }

   public static int addCars (String [] plates,String [ ] ccNumbers, int numCars, Scanner keyboard)
   {
        Scanner s = new Scanner(System.in);

        System.out.println("Enter your plate number: ");
        plates[numCars]=s.nextLine();

        System.out.println("Enter your Credit Card Number ($4.00 charge): ");
        ccNumbers[numCars]=s.nextLine();

        System.out.println("Thank you, your plate " +plates[numCars]+ " has been added to the lot");

        numCars++;

        return numCars;

    } 
```

所以几乎我想要发生的事情是，我希望用户在 addCars 方法中输入的任何车牌号和 ccNumber 都存储在 main 方法中的车牌和 ccNumber 数组中。对不起，如果我听起来好像我不知道我在说什么，我对编程是全新的并且正在学习。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T23:59:37.970

GanGnaMStYleOverFlowErroR 谈到了您提出的直接问题，但解决您的问题的更好方法是稍微修改您的代码。您可以将它们设置为对象 PayAndGoParking 的属性，而不是将所有内容作为参数传递给您的方法。这使您可以通过将其范围更改为整个类来直接访问它们，而不仅仅是单个方法。

通常，您希望避免只是将“静态”放在所有内容上以使其正常工作。它是一个特殊的关键字是有原因的（不是因为它只是让一切正常工作:)。在下面查看我的示例代码，看看我会怎么做。随意问任何问题。

```
import java.util.Scanner;
public class PayAndGoParking {
    private String Plates[];
    private String ccNumbers[];
    private int numCars;

    public static void main(String Args[])
    {
        PayAndGoParking park = new PayAndGoParking();
        //set the defaults
        park.Plates = new String[50];
        park.ccNumbers =new String[50];
        park.numCars=0;

        int choice = park.printMenu();

        if(choice==1)
            park.addCars();

        //since arrays start at 0, this will print out the first license and cc number added
        System.out.println(park.Plates[0]);
        System.out.println(park.ccNumbers[0]);
    }

    public int printMenu()
    {
        Scanner s = new Scanner(System.in);
        int choice;

        System.out.println("Welcome to Park and Go Parking");
        System.out.println("Park from 6 - Midnight for a flat fee of $4.00");

        System.out.println("1\. Register your vehicle");
        System.out.println("2\. Verify vehicle registration");

        System.out.print("Hello enter a Selection: ");
        choice = s.nextInt();

        if(choice==1)
            System.out.println("Register your vehicle");
        else
            System.out.println("Verify your registration");

        return choice;
    }

    public void addCars() {
        Scanner s = new Scanner(System.in);

        System.out.println("Enter your plate number: ");
        Plates[numCars]= s.nextLine();

        System.out.println("Enter your Credit Card Number ($4.00 charge): ");
        ccNumbers[numCars]= s.nextLine();

        System.out.println("Thank you, your plate " +Plates[numCars]+ " has been added to the lot");

        numCars++;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T23:44:48.440

```
String Plates[]=new String[50];
   String ccNumbers[]=new String[50]; 
```

您的 Plates 和 ccNumber 数组是仅限于**方法范围的****局部变量（方法变量）** ，即您不能在**主**方法之外访问它们。使它们成为您的**静态实例变量**，以便在类中的任何位置访问它们。

 ******```
public class PayAndGoParking {
 static String Plates[]=new String[50];
 static  String ccNumbers[]=new String[50];
public static void main(String Args[]) {
 // code in your main
}
public static int addCars (String [] plates,String [ ] ccNumbers, int numCars, Scanner keyboard) { 
// you  can now access ccNumber and Plates array here.
} 
```

## 变量范围：

1.  静态变量 - 与类本身一样存在。
2.  实例变量 - 与类的实例一样存在
3.  局部变量或方法变量 - 存在于方法中。
4.  块变量 - 只存在于块中******

# tfs - 如何将域用户添加到 TFS 2012 服务器？

> ID：13484112
> 
> 赞同：2
> 
> 时间：2012-11-20T23:40:52.400
> 
> 标签：tfs, tfs-2012

我目前正在尝试将用户添加到 tfs 2012 服务器的安全/用户部分中的“管理您的服务器”页面。我要添加的用户与 tfs 服务器在同一个域中。如何添加此用户，因为它没有显示在用户搜索部分？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T01:12:31.567

如果您想授予此用户对特定团队项目/集合的访问权限，您可以通过团队资源管理器或 Web 访问中的组成员身份来执行此操作。

对于完整的管理员权限（所有集合和项目），请使用以下屏幕截图。

![将用户添加到 TFS 管理员](../Images/cbf4ef2ad607c441eac48714336d3281.png)

或者，如果您想授予 TFS 组级别，请使用 TFS 管理员控制台找到以下屏幕截图：

![在此处输入图像描述](../Images/476e1a0c90a645aeb359d0d377297801.png)

# c++ - 指向结构或类的指针与指向第一个字段的指针

> ID：13484113
> 
> 赞同：6
> 
> 时间：2012-11-20T23:40:53.677
> 
> 标签：c++, oop, pointers, struct, field

我最近尝试通过将几个指针的值打印到控制台来调试一个小程序。第一个是结构的内存地址，其他是其字段的内存地址。代码的精简版本如下：

```
#include <iostream>

struct testingPointers
{
    int i;
    float f;
    double d;
} test;

int main()
{
   std::cout << &test << '\n' << &(test.i) << '\n' << 
            &(test.f) << '\n' << &(test.d);
} 
```

输出是：

```
0x681110
0x681110
0x681114
0x681118 
```

（显然，不同运行的确切值不同，但它们之间的相对位置始终相同）。

我很困惑，因为第一个指针的值——内存位置——与第二个指针的值`test`（的第一个字段`test`）相同。这是否意味着对象没有真正唯一的内存地址，并且指向结构或类的指针只是指向其第一个字段？如果是这样，语句如何

```
a.b
a->b
a.b() 
```

`a`如果实际上只是它的第一个字段，因此没有任何字段或方法，是否有意义？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T23:58:13.367

对象的地址应始终是该对象中第一个非静态成员的地址。引用标准（C++11-9.2-20）：

> **指向标准布局结构对象的指针，使用 reinterpret_cast 适当转换，指向其初始成员（或者如果该成员是位字段，则指向它所在的单元），反之亦然。**[注意：因此，标准布局结构对象中可能存在未命名的填充，但不是在其开头，这是实现适当对齐所必需的。

此处提到了*标准布局*的要求： [StandardLayoutType](http://en.cppreference.com/w/cpp/concept/StandardLayoutType)。

这当然可以通过嵌套来应用。*除*位域外，该标准对第一个成员的*类型*没有任何例外。IE：

 *```
class X
{
public:
    int x;
};

class Y
{
public:
    X x;
    int y;
};

Y yobj; 
```

按照标准，`&yobj == &yobj.x == &yobj.x.x`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-20T23:47:54.127

一个类或结构只是描述了一个字段的集合，这些字段应该一起保存在内存中，并且在它们之间具有某种语义关系以及对它们进行操作的一些操作。在简单的情况下，内存中类类型对象的内容只不过是由它组成的成员（和一些填充）。当您`testingPointers`在内存中有一个对象时，它实际上只是一个`int`、 a`float`和 a `double`。类的概念仅用于生成正确的可执行代码——它在运行时不存在（至少不用于此目的）。

标准中关于对象是否可以共享内存地址的重要部分是§1.8/6：

> 除非对象是位域或大小为零的基类子对象，否则该对象的地址就是它占用的第一个字节的地址。如果一个对象是另一个的子对象，或者如果至少一个是大小为零的基类子对象并且它们属于不同类型，则两个不是位域的对象可能具有相同的地址；否则，它们应具有不同的地址。

我们可以由此推断，因为 member`test.i`是 的子对象`test`，所以它们很可能具有相同的地址。

一旦您尽可能深入地查看程序的所有对象，您真正拥有的是大量标量值和相邻位域。这些在标准中被称为*内存位置*。这些是真正占用空间的东西。您的其余对象都以某种方式由这些组成。

> *内存位置*要么是标量类型的对象，要么是所有具有非零宽度的相邻位域的最大序列。[*注意：*语言的各种特性，例如引用和虚函数，可能涉及程序无法访问但由实现管理的额外内存位置。——*尾注*]

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-21T00:38:57.090

只是为了澄清你的困惑：

**1).第一个指针的值——test 的内存位置——与第二个指针的值（test 的第一个字段）相同。**
Struct 的地址和它的第一个字段必须相同，因为 struct 不是其字段的连续集合。

![在此处输入图像描述](../Images/9cf216a09aeeaa5bf055709cfd50c1e0.png)

您还可以考虑数组的情况以进一步简化理解，其中数组的地址显然等于数组的第一个元素（字段）。

**2).这是否意味着对象没有真正的唯一内存地址，并且指向结构或类的指针只是指向其第一个字段？**
我认为您将它与 JAVA 混淆了，其中对象总是在堆上分配。在 C++ 中，结构/类总是在堆栈上分配，除非它是动态内存分配（使用“new”运算符），其中对象在堆中分配，并且指针变量（在堆栈中）将指向堆中的该对象。因此，在前一种情况下，结构变量将始终具有与其第一个元素（字段）相同的地址。

希望有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T23:48:41.013

内存中的结构仅由串在一起的字段组成。根据对齐需要，结构之前和/或字段之间可能有填充，但在第一个字段之前通常没有任何额外的“东西”。所以第一个字段和结构本身具有相同的地址。

请记住，在 C 中，类型仅在编译时存在。*

# javascript - 使用 iframe 时如何包含 javascript 函数？

> ID：13484114
> 
> 赞同：0
> 
> 时间：2012-11-20T23:40:54.040
> 
> 标签：javascript, html, iframe, timer

我对使用 HTML5/JavaScript 进行前端开发比较陌生。

我想我应该以前研究过这个。我需要创建一个包含 javascript 倒数计时器和 javascript 文本效果的 iframe。

iframe 渲染正常，但计时器没有实时显示倒计时，文本效果也没有渲染。

我希望它是可嵌入的，类似于您嵌入 Flash 视频或其他东西的方式......

请指出我正确的方向。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:45:20.147

假设您有一个 iFrame，例如：

```
<iframe src="someSource" id="frameID"></iframe> 
```

并且您的脚本位于外部*myScripts.js*文件中，您可能希望将新脚本附加到 iFrame 的...类似于：

```
$("#frameID").contents().find("head").append("<script type='text/javascript' src='resources/script/script.js'>"); 
```

编辑：如果你有一个函数*functionToCall()*你想在 iframe 中调用（而不是嵌入一个外部文件），你可以这样做：

```
 document.getElementById('frameID').contentWindow.functionToCall(); 
```

# java - 为 JSF 应用程序指定外部错误页面

> ID：13484115
> 
> 赞同：1
> 
> 时间：2012-11-20T23:40:55.490
> 
> 标签：java, jsf, external, custom-error-pages

我目前正在维护一个遗留的 ICEFaces 1.8.2 web 应用程序，我想知道是否可以`web.xml`在应用程序生成错误时在其文件中定义外部 URL。

主要原因当然是没有向客户显示默认的 Tomcat 6 错误页面。此外，我无法将内容包含在我的应用程序`.war`文件中，因为我公司的另一个部门正在管理这些页面的内容。

特别是，我对显示错误 404、500 和 503 的自定义页面很感兴趣。

`web.xml`我尝试对应用程序的文件进行此修改：

```
<error-page>
    <error-code>500</error-code>
    <location>http://myproduction-site.com/error/HTTP_INTERNAL_SERVER_ERROR.html</location>
</error-page>
<error-page>
    <error-code>404</error-code>
    <location>http://myproduction-site.com/error/HTTP_NOT_FOUND.html</location>
</error-page> 
```

但是，我认为在`web.xml`文件中指定这些值是非法的。

如果有帮助，我的 Tomcat 6 服务器前面有几个 Apache 服务器，它们通过粘性会话进行负载平衡。是否可以在 Tomcat 服务器内部发生错误时指示 Apache 服务器重定向到这些页面？

还有其他我可能不会考虑的选择吗？

我感谢您的时间和帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T02:15:35.787

这是不可能的`web.xml`。

错误页面位置必须准确引用资源路径，当作为参数传递给[`RequestDispatcher#forward()`](http://docs.oracle.com/javaee/6/api/javax/servlet/RequestDispatcher.html#forward%28javax.servlet.ServletRequest,%20javax.servlet.ServletResponse%29). 该方法不接受外部 URL。它只接受 webapp 自己的资源。

您最好的选择是在本地创建错误页面，然后导入外部错误页面。其中一种方法是使用 HTML `<iframe>`，如下所示：

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <title>HTTP Internal Server Error</title>
        <style>
            html, body, iframe {
                margin: 0;
                padding: 0;
                width: 100%;
                height: 100%;
            }
            html, body {
                overflow: hidden;
            }
        </style>
    </head>
    <body>
        <iframe src="http://myproduction-site.com/error/HTTP_INTERNAL_SERVER_ERROR.html"></iframe>
    </body>
</html> 
```

另一种方法是使用带有 JSTL 的旧版 JSP 页面，[`<c:import>`](http://docs.oracle.com/javaee/5/jstl/1.1/docs/tlddocs/c/import.html)该页面实际上将目标 URL 的整个 HTML 响应嵌入到当前响应中，而不需要 iframe（是的，真的是 JSP；[Facelets](http://docs.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/)`<c:import>`中不支持）。

```
<%@taglib prefic="c" uri="http://java.sun.com/jsp/jstl/core"%>
<c:import url="http://myproduction-site.com/error/HTTP_INTERNAL_SERVER_ERROR.html" /> 
```

请注意，如果此错误页面又包含对 CSS/JS/图像文件和表单的*相对*URL 引用`<script src="some.js">`，那么它们都会失败。如果不能将它们固定为绝对 URL，那么 iframe 确实是您唯一的选择，前提是错误页面本身不包含一些破坏框架的 JavaScript（大多数现代网站都有这样的内容以防止网络钓鱼攻击）。

# c# - .NET 中的 SQL 注入预防

> ID：13484118
> 
> 赞同：6
> 
> 时间：2012-11-20T23:40:59.260
> 
> 标签：c#, .net, sql, ado.net

我通常在 .NET 中编写我的 SQL

```
sql.Append("SELECT id, code, email FROM mytable WHERE variable = @variable "); 
```

然后做这样的事情：

```
using (SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings[ConfigurationManager.AppSettings["defaultConnection"]].ConnectionString))
{
    using (SqlCommand myCommand = new SqlCommand(sql.ToString(), conn))
    {
        myCommand.Parameters.AddWithValue("@variable", myVariableName");
        ... 
```

但是当我得到的数据直接来自数据库时，我也应该这样做 addParameter 吗？

```
likesql.Append(string.Format("SELECT group_id, like_text FROM likeTerms ORDER BY group_id ASC "));

DataTable dtLike = SqlHelper.GetDataTable(likesql.ToString());

foreach (DataRow dr in dtLike)
{
    buildsql.Append(".... varId = " + dr["group_id"].ToString() + "...");

    ... 
```

这可以接受吗？什么是最佳实践？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-20T23:46:07.193

### 您应该始终使用参数：

*   数据库中的值来自哪里？
*   你能相信，在你的例子中，'group_id' 没有被修改为你不期望的东西吗？

### 不相信任何人

具有有限数据库访问权限的人可以直接注入其他地方使用的字段吗？

### 表现

此外，它有助于性能。缓存的执行计划将忽略参数的值，这意味着您可以避免服务器在每次参数更改时重新编译查询。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-20T23:45:20.483

当您使用带参数的 DbCommands 时，参数永远不会“内联”到查询中。相反，查询和参数数据被传递到一个特殊的系统存储过程 sp_executesql。以这种方式完成时，您拥有的任何参数数据都将被视为完全一样，并且不会从查询字符串中解析出来；因此，可能已经通过验证的注入命令永远不会执行。

使用参数是基于 ADO.NET 的数据访问层的最佳实践，无论数据来自何处，并且是 IMO 应该在此级别完成的唯一方法（如果您不使用 ORM）。你永远不应该将从 web 或 windows 窗体中检索到的值连接到 SQL 语句中，如果你遵循该规则，为什么你会因为你有信心甚至确定信息不是直接的而以不同的方式实现它来自用户？遵循相同的模式，如果并且当您公开该方法以保留用户指定的数据时，您将不会被烧毁。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-20T23:44:55.910

这是可以接受的（从某种意义上说，如果您知道有时可能会正常工作的限制）。

使用数据库中的值并使用字符串连接构建 SQL 查询是一种好习惯 - 否。

即在您的示例中，如果“group_id”是`"'--"`什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T23:51:34.533

我建议使用存储过程，但这是可以接受的 我还建议您在将参数分配给查询之前对其进行清理

# ruby-on-rails - 如何在 Sinatra 中使用 ActiveRecord::Observer？

> ID：13484122
> 
> 赞同：2
> 
> 时间：2012-11-20T23:41:27.147
> 
> 标签：ruby-on-rails, activerecord, sinatra

我在 Sinatra 1.3.3 应用程序中成功使用了 ActiveRecord 3.2.9。我希望能够使用 ActiveRecord::Observer 类，但我不确定如何激活它们。

ActiveRecord::Observer[文档](http://api.rubyonrails.org/classes/ActiveRecord/Observer.html "这里")是特定于 Rails 关于这个特定位的：

> 要激活观察者，请将其列在 config/application.rb 文件的 config.active_record.observers 配置设置中。

当然，我没有设置此设置的“配置”对象。有任何想法吗？

**编辑**

我尝试像这样激活观察者：

```
ActiveRecord::Base.observers = [ :thermometer_reading_observer ] 
```

这会做一些事情，因为它们被正确设置，但它们仍然不做任何事情：

```
[4] pry(main)> ActiveRecord::Base.observers
=> [:thermometer_reading_observer] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T20:32:56.173

[通过仔细阅读此处](https://github.com/rails/rails/blob/3-2-stable/activerecord/lib/active_record/observer.rb "这里")的 ActiveRecord 源代码得到了它：

要在 Rails 之外激活观察者，请执行以下操作（以我的观察者为例）：

```
ActiveRecord::Base.add_observer ThermometerReadingObserver.instance 
```

希望这可以帮助某人！

# ruby-on-rails - 在 Ruby On Rails 中解析包含来自 SOAP 响应的数组的字符串

> ID：13484123
> 
> 赞同：0
> 
> 时间：2012-11-20T23:41:28.107
> 
> 标签：ruby-on-rails, ruby, arrays, parsing, soap

我正在使用 Ruby on Rails 中的 Savon 向 SOAP 接口发送请求。

我遇到的问题是结果作为包含数组的字符串返回：

> 阵列 ( [0] => ACCESS [1] => ALLEY [2] => ANCHORAGE [3] => 公寓 [4] => ARCADE [5] => AVENUE [6] => BANK [7] => BAY [8] => 海滩 [9] => 腰带 [10] => BEND [11] => BOARDWALK [12] => 林荫大道 [13] => 林荫大道）

我尝试使用 Savon 函数**.to_hash**解析结果，但这部分仍然是一个字符串。我也尝试过在字符串上使用**Nori.parse**，但这会返回一个空哈希。

有没有人在使用 SOAP 接口时遇到过类似的问题？将其解析为 Ruby 数组的最佳方法是什么？

我想在开始使用正则表达式编写 hacky 代码以将其转换为正确的格式，然后在其上调用**eval()**之前，我会提出这个问题。

非常感谢任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T02:44:14.250

如果您的结果看起来与示例完全相同，这就是我将采用以下方式之一的值的方式：

```
string = 'Array ( [0] => ACCESS [1] => ALLEY [2] => ANCHORAGE [3] => APARTMENTS [4] => ARCADE [5] => AVENUE [6] => BANK [7] => BAY [8] => BEACH [9] => BELT [10] => BEND [11] => BOARDWALK [12] => BOULEVARD [13] => BOULEVARDE)'
string.scan(/=> ([A-Z]+)/i).flatten
=> ["ACCESS", "ALLEY", "ANCHORAGE", "APARTMENTS", "ARCADE", "AVENUE", "BANK", "BAY", "BEACH", "BELT", "BEND", "BOARDWALK", "BOULEVARD", "BOULEVARDE"] 
```

或者：

```
string.scan(/\b[A-Z]+\b/) 
```

它返回相同的结果，只允许大写单词。如果你得到混合大小写，这将失败，并且由于前导“数组”而使其不区分大小写将失败。

# android - Android-OpenCV Warp ROI

> ID：13484124
> 
> 赞同：1
> 
> 时间：2012-11-20T23:41:35.770
> 
> 标签：android, opencv, zooming, roi, warp

如何扭曲提取的矩形 ROI 以填充整个预览并保持比例？我从相机源图像（Opencv Mat）中提取了一个矩形并将其保存到另一个 Mat 中。现在我想变形/缩放/放大/我不知道……这样它就可以填充整个预览，保持比例！显然，要填充预览，它可能需要变得大于预览大小.. 不在乎！

谢谢！

# javascript - 比较javascript中的两个多维数组

> ID：13484126
> 
> 赞同：1
> 
> 时间：2012-11-20T23:41:50.397
> 
> 标签：javascript, jquery, arrays

我有两个数组：

```
var array_old = [{id:"5436", title:"I Like you boy"}, {id:"5437", title:"Hello how are you"}];
var array_new = [{id:"5436", title:"I Like you boy"}, {id:"1132", title:"I'm fine"}];

$.each(array_old, function(id, array)
{
    if(!$.inArray(array['id'], array_new, 1)>-1){
        alert(array['id'] + " does not exist in array_new");
    }
}); 
```

我想检查 array_old 的 ID 是否存在于 array_new 中，所以我希望代码在此示例中输出“5437 在 array_new 中不存在”。

我找不到任何可以让我这样做的功能，那我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:57:15.003

[http://jsfiddle.net/tppiotrowski/VHb3Q/2/](http://jsfiddle.net/tppiotrowski/VHb3Q/1/)

```
var array_old = [{
    id: "5436",
    title: "I Like you boy"},
{
    id: "5437",
    title: "Hello how are you"}];
var array_new = [{
    id: "5436",
    title: "I Like you boy"},
{
    id: "1132",
    title: "I'm fine"}];

$.each(array_old, function(old_index, old_obj) {
    var old_id = old_obj['id'];
    var found = false;
    $.each(array_new, function(new_index, new_obj) {
        if (new_obj['id'] == old_id) {
            found = true;
        }
    });
    if (!found) {
        alert(old_id + " does not exist in array_new");
    }
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T23:57:27.097

我自己找到了一种方法，但我不知道这是否是最好的方法：

```
var array_old = [{id: "5436",title: "I Like you boy"},{id: "5437",title: "Hello how are you"},{id: "5438",title: "Hello how are you2"}];
var array_new = [{id: "5436",title: "I Like you boy"},{id: "1132",title: "I'm fine"}];

$.each(array_old, function(id, array){

    found = 0;

    $.each(array_new, function(id2, array2) {

        if(array['id']==array2['id'])
        {
            found++;
        }

    });

    if(found==0)
    {
        alert(array['id']+' does not exist in array_new');
    }

}); 
```

[http://jsfiddle.net/FAb3k/2/](http://jsfiddle.net/FAb3k/2/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T00:15:44.610

取决于您的阵列有多大 - 您可能想要使用性能更高的解决方案。

*   最简单的解决方案（您和@Tebb 都找到了）有`Θ(n*m)`
*   如果您对此进行一些优化（如果您没有 [not] 找到该元素，则中断 - 请参阅@gonchuki），您仍然处于`O(n*m)`
*   您可以假设两个数组的顺序相同，并且只运行一个循环：`O(min(n,m))`. 如果你需要在此之前对它们进行排序，你会得到`O(n*log n+m*log m)`.
*   最好使用哈希表进行`O(1)`查找，结果是`O(n+m)`. 您可以轻松地为此使用 JS 对象：

```
var counts = {};
for (var i=0; i<array_new.length; i++)
    counts[array_new[i].id] = (counts[array_new[i].id] || 0) + 1;

return array_old.every(function(item) {
    return item.id in counts && counts[item.id]--;
}); 
```

（[演示](http://jsfiddle.net/t3Ary/4/)）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T00:21:05.263

仅仅因为它有效并且最终更易于阅读而抛出一个狂野的替代方案（不知道性能，但让我们跳过它，因为我这样做是为了展示另一种方法）

```
var ids_old = $.map(array_old, function(item) { return item.id; });
var ids_new = $.map(array_new, function(item) { return item.id; });

var duplicates = $.grep(ids_old, function(i, id) { 
    return $.inArray(id, ids_new) !== -1;
}); 
```

请注意，最终结果是您自己获得了重复 ID 的列表，这个另一种方法可以让您收集项目本身：

```
var ids_new = $.map(array_new, function(item) { return item.id; });

var duplicates = $.grep(array_old, function(i, item) { 
    return $.inArray(item.id, ids_new) !== -1;
}); 
```

*加分点：*即使他的示例是纯 jQuery，请注意在兼容 ECMAScript5 的浏览器上，您可以使用本地数组对应物来实现相同的结果。

# python - 保存 html 文件时出现 Unicode 错误

> ID：13484127
> 
> 赞同：0
> 
> 时间：2012-11-20T23:42:05.623
> 
> 标签：python, character-encoding

我正在使用 Python2.6，并且请求模块和字符编码存在大量问题。

归结为最简单的形式，这是我的代码和产生的错误（包括导致我的问题的实际站点）：

```
import requests

sites = ['www.ddelectricmotors.com', 'www.stearnswood.com']
for domain in site:
 r = requests.get( 'http://' + domain )
 f = open( domain, 'w' )
 f.write( r.text )
 f.close() 
```

DDElectric Motors 的页面加载并保存良好，但 Stearnswood 尝试产生以下错误：

```
UnicodeEncodeError: 'ascii' codec can't encode character u'\u2019' in position 13186: ordinal not in range(128) 
```

理想情况下，我宁愿只强制编码为 ascii，因为我将它加载到 scikit-learn 中，这似乎更喜欢 ascii。我只需删除未知字符就可以了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T23:47:03.320

Unix 文件包含字节，并且您的`r`对象的`text`属性似乎是一个代码点字符串，因此如果您在 Unix 上，您可以改为`f.write(r.text.encode('UTF-8'))`.

更大的问题是将通过不安全渠道获得的来自互联网的未经净化的数据写入自动化过程中的文件中。要非常小心如何使用该文件。如果您信任该站点，请至少考虑使用 HTTPS。

# ffmpeg - FFMPEG - 在录制时转换文件

> ID：13484129
> 
> 赞同：2
> 
> 时间：2012-11-20T23:42:16.283
> 
> 标签：ffmpeg, streaming, live, flv

我目前正在尝试流式传输实时视频。我配备了闭路电视摄像机和通用麦克风。我正在使用最新的 FFMPEG 1.0（从源代码编译）。不幸的是，我的相机只提供视频流，所以我必须手动加入音频。这是我的代码：

```
#!/bin/bash

# record mic input to wav file
arecord -f dat -D hw:0,0 mic.wav &

# record camera stream to avi file
cvlc rtsp://192.168.0.11:554/VideoInput/1/h264/1 --sout "#standard{access=file,mux=avi,dst=camera.avi}" &

# wait few seconds for both sources to stabilize
sleep 5

# join avi and wav to one flv file, then stram it to tcp socket (which is received by crtmpserver and transmitted forward to the website)
ffmpeg -i camera.avi -vcodec flv -i mic.wav -acodec mp3 -s 1280x720 -ar 44100 -ab 192k -vb 3000k -f flv - | ffmpeg -re -i - -codec copy -metadata streamName=streamhd tcp://127.0.0.1:6666 & 
```

此代码有效，并且接收流的时间不到 5 秒。如果我增加睡眠时间，播放时间会更长。FFMPEG 似乎只转换一开始接收到的数据。

**如何强制进一步转换？**

我试过命名管道。FFMPEG 无法识别输入格式。

# date - Powershell - 获取文件名短日期的更简单方法

> ID：13484133
> 
> 赞同：3
> 
> 时间：2012-11-20T23:42:33.887
> 
> 标签：date, powershell, replace

更多是出于好奇，因为它对我来说工作正常（我刚开始使用 Powershell），但我在下面使用来获取用于文件名的短日期：

```
$shortdate = (get-date).toshortdatestring().replace("/",".") 
```

是否有内置功能，或者这是实现此目的的正确方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T23:54:57.260

您可以使用以下`-Format`参数`get-date`：

```
get-date -format "MM.dd.yyyy"
11.20.2012 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T23:54:07.223

这可以非常类似于在[C#](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)中完成。

```
$shortdate = (Get-Date).ToString("yyyy.MM.dd") 
```

您的方法在某种程度上取决于本地化 - 如果您在日期格式不用`/`作分隔符的系统上运行相同的代码，它就会中断。

# javascript - 谷歌地图 api V3 圆角

> ID：13484135
> 
> 赞同：0
> 
> 时间：2012-11-20T23:42:43.337
> 
> 标签：javascript, css, google-maps

我正在使用 google maps api v3 for javascript。我正在尝试使地图显示为圆角。我能找到的唯一方法是几年前的黑客攻击，涉及将信息窗口更改为信息框。

现在有没有更好的方法来使用 css 做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T09:12:34.123

创建一个包含 google map javascrip、google map3 和最新 jquery 的 html。
不要忘记添加即将起作用的 infobubble js。
将以下jquery代码添加到html文件

```
 $('#homepage_map').gmap3
            (
                {
                    action:'init',
                    options:
                    {
                        center:[response.locations.latitude, response.locations.longitude],
                        zoom: 8,
                        mapTypeId: google.maps.MapTypeId.ROADMAP,
                        mapTypeControl: true,
                        navigationControl: true,
                        scrollwheel: true,
                        mapTypeControlOptions:
                        {
                            mapTypeIds: ['Map']
                        },
                        streetViewControl: true
                    }
                },
                {
                    action:'clear'
                },
                {
                    action: 'addMarkers',
                    markers:MarkerOBJ,
                    marker:
                    {
                        options:
                        {
                            draggable: false,
                            icon: HOST+'img/icons/google_marker.png',
                            animation: google.maps.Animation.DROP
                        },
                        events:
                        {
                            click: function(marker, event, data)
                            {
                                var map = $(this).gmap3('get');
                                infoBubble = new InfoBubble({
                                    maxWidth: 395,
                                    shadowStyle: 1,
                                    padding: 5,
                                    borderRadius: 10,
                                    arrowSize: 20,
                                    borderWidth: 5,
                                    borderColor: '#CCC',
                                    disableAutoPan: true,
                                    hideCloseButton: false,
                                    arrowPosition: 50,
                                    arrowStyle: 0
                                });
                                infoBubble.close();
                                infoBubble.setContent(data);
                                infoBubble.open(map, marker);
                            }
                        }
                    }
                }
            ); 

```

现在您需要做的就是添加样式表，因为您希望信息气泡显示。 **infoBubble.setContent(数据);** 其中 data 将是您需要根据需要设置的 infobubble 的 html。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T00:52:34.737

这个例子怎么样？ [http://google-maps-utility-library-v3.googlecode.com/svn/trunk/infobubble/examples/example.html](http://google-maps-utility-library-v3.googlecode.com/svn/trunk/infobubble/examples/example.html)

实际上，如果您想创建自己的 InfoWindow 设计，您可以轻松做到。参考：[自定义信息窗口](https://stackoverflow.com/questions/11549359/customizing-an-infowindow)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T03:50:12.947

我也尝试制作圆角，并找到了这个解决方案 - 也许它会对你有所帮助？ [http://search.missouristate.edu/map/mobile/examples/corners.htm](http://search.missouristate.edu/map/mobile/examples/corners.htm)

# racket - DrRacket 编程

> ID：13484136
> 
> 赞同：1
> 
> 时间：2012-11-20T23:42:48.017
> 
> 标签：racket

我在作业中得到了这个：

```
; subst: [Listof Value] [Listof Name] SExp -> SExp
; substitute the corresponding value for each listed variable name in s
; leave all other names in s unmodified

(define (subst vals vars s) ...)

(define s1 '(foo a 29 (bar "z" b)))
(check-expect (subst '(3 "x") '(a b) s1) '(foo 3 29 (bar "z" "x"))) 
```

我知道我需要重复这两个列表，但不确定如何去做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T20:07:18.703

这将起作用：

```
(define (subst vals vars s)
  (let ((mapping (map vars vals)))
    (let subbing ((s s))
      (if (null? s)`
          '()
           (let ((s1 (car s)))
             (cons (cond ((and (symbol? s1) (assoc s1 mapping)) => cdr)
                         ((list? s1) (subbing s1))
                         (else s1))
                   (subbing (cdr s)))))))) 
```

# delphi - 有没有办法改善这个默认的delphi XE3触摸屏行为？

> ID：13484139
> 
> 赞同：1
> 
> 时间：2012-11-20T23:42:58.323
> 
> 标签：delphi, touch

有没有办法改善这个默认的delphi XE3触摸屏行为？

假设我们的 delphi 应用程序带有几个在触摸屏计算机上运行的编辑框。我遇到了一些非常奇怪的行为。

我将描述制作应用程序：

1.  启动一个新的delphi XE3应用程序“New VCL Metropolis UI Application”，“Blank Metropolis UI Application”。
2.  在表单上放置几个编辑框（我们称它们为 Edit1 和 Edit2）。
3.  在触屏电脑上编译部署到触屏电脑：
4.  运行我们的新应用
5.  在 Edit1 中触摸（虚拟键盘看起来不错）
6.  再次触摸Edit1（虚拟键盘消失......好的？？？）
7.  触摸Edit1（虚拟键盘出现然后很快消失）
8.  触摸Edit1（虚拟键盘出现然后很快消失）
9.  触摸Edit1（虚拟键盘出现然后很快消失）

伙计，这“糟透了”……您可以恢复键盘的唯一方法是触摸 Edit2，然后返回 Edit1。

我怎样才能使它正常工作？我不可能指望我的用户使用这个......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T18:57:25.580

决定不使用VCL/windows提供的虚拟键盘。现在决定使用delphi自带的TTouchKeyboard和CM_FOCUS消息。

# mp4 - 如何使用 mp4 atom 设置 mp4 的持续时间？

> ID：13484142
> 
> 赞同：0
> 
> 时间：2012-11-20T23:43:02.973
> 
> 标签：mp4

我想使用 mp4 原子设置 mp4 文件的持续时间。我已经更新了 mvhd、mdhd、tkhd 的持续时间属性，但没有运气。我想要做的是将长度从 3 分钟设置为 30 秒，比方说。我知道时间=持续时间/时间尺度。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T09:17:21.830

字段中的持续时间只是一种摘要。您需要延长每张图片的显示时间。通过操作此处找到的框来做到这一点：

```
/moov/trak/mdia/minf/stbl/stts 
```

是时候对 atom/box 进行采样了。如果您手头没有 ISO/EIC 14496-12，您可以安全地使用 Quicktime 文件格式规范来了解这个 atom/box 的内容和结构。

要提高或降低视频的速度，您可以将每个样本持续时间（大多数情况下只有一个）乘以一个因子。

注意：H264 视频在某些情况下也有 ctts 框（如果使用 B 帧）。您还需要修改那里的时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-09T07:38:33.397

编辑 mp4 文件并不简单，因为修改一个框会影响其大小以及所有祖先的大小。计时值也紧密相关：DTS、cts、轨道持续时间、编辑列表、电影持续时间......一些操作可以简单地完成，例如延长轨道最后一个样本的持续时间并反映标题中的变化. 在您的情况下，减少持续时间意味着忽略一些样本。您可以编辑示例表，但这非常困难，并且几乎会更改所有框。您可以使用编辑列表，但这也很难。使用 MP4Box 制作新文件更容易：

```
MP4Box -add input.mp4:dur=30 output.mp4 
```

# css - 悬停/活动菜单上的 CSS 背景图像缩小

> ID：13484146
> 
> 赞同：0
> 
> 时间：2012-11-20T23:43:37.343
> 
> 标签：css, menu, background, hover

我有一个这样的菜单：

```
<div id="header">
 <div id="nav">
  <ul>
   <li><a href="/home/"><img src="/images/icons/home.png" alt="Home" /></a></li>
  <li><a href="/tool/"><img src="/images/icons/tool.png" alt="Tool" /></a></li>
  <li><a href="/lists/"><img src="/images/icons/tags.png" alt="Lists" /></a></li>
 </ul>
</div>
</div> 
```

我想要一个**悬停/活动状态的矩形图像**。问题是无论我的图像有多大，它们总是缩小。

**我的图标是 30px x 30px。我的背景图片是 69 像素 x 34 像素**（它们几乎是 30x30）。

这些是我的 CSS：

```
#header {
    color      : #cccccc;
    font-size  : 1.0em;
    padding    : 0;
    min-height : 37px;
    background : #2d2d2d;
    vertical-align: middle;
}

#nav {
    font-size      : 1.1em;
    display        : inline;
}

#nav ul {
    padding        : 0;
    margin-left    : 270px;
    margin-bottom  : auto;
    margin-top     : auto;
    float          : left;
    vertical-align : middle;
    list-style     : none;
    position       : relative;
    display        : inline-table;
    height         : 37px;
    line-height    : 37px;
}

#nav li {
    float           : left;
    list-style      : none;
    padding         : 0px 35px 3px 0px;
    display         : inline;
    vertical-align  : middle;
}

 #nav li img {
    top: 100%;
    vertical-align  : middle;
}

#nav a:hover {
    background: url('../images/icons/overtop.png') no-repeat;
    border: 0;
    background-size: 100%;
    background-size: 69px 34px;
    width:69px;
    height:34px;
}

#nav a.active {
    background: url('../images/icons/backtop.png') no-repeat;
    border: 0;
    background-size: 100%; 
    background-size: 69px 34px;
    width:69px;
    height:34px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:18:53.690

乍一看，我确实注意到了一些事情：

您应该尝试使用 background-image:url('link/to/your/image.png')。

您也可以尝试省略 background-size: 100% 因为它是多余的。

只是为了澄清（由于我的声誉很低，我无法发表评论），您试图通过视觉线索（例如图标上方的黑条）向用户指示他们当前正在/即将点击的页面，对吗？

***编辑***

尝试在悬停时引用列表项而不是锚标记，例如：

```
li:hover {
    background: url('http://216.119.77.64/test/icons/overtop.png')  no-repeat;
    border: 0;
    background-size: 69px 34px;
} 
```

它修复了大小问题，但图像不在背景中居中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T00:19:36.050

像这样试一试：

```
#nav a {
    border: 0;
    width:69px;
    height:34px;
}

#nav a:hover {
    background: url('../images/icons/overtop.png') no-repeat;
}

#nav a:active {
    background: url('../images/icons/backtop.png') no-repeat;
} 
```

# linux - 在 Bourne Shell 中调用函数

> ID：13484160
> 
> 赞同：3
> 
> 时间：2012-11-20T23:44:42.110
> 
> 标签：linux, bash, shell, unix, sh

是否可以从 Unix 控制台调用函数（在 shell 脚本中定义）？我有一个像

```
add ()
{
 a=$1
 b=$2
 c=`expr $a + $b`
} 
```

这是在脚本中定义的`"my_script.sh"`。如何从命令提示符调用此函数？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T00:02:41.720

要使用参数，您不应用重定向运算符`<`，它将在 之后给出的文件重定向`<`到程序的标准输入。您需要在脚本中调用您的函数才能使用 args `$...`，或者您可以简单地将函数加载到 shell 中并使用它。

在这两种情况下，您的函数的调用都是这样执行的：

```
add arg1 arg2 
```

如果通过命令行，你必须加载`.sh`文件的内容——你的函数定义——以便你可以从你的 shell 中调用它们。在这种情况下，您的文件应如下所示：

```
#! /bin/bash
add () {    
    a=$1
    b=$2
    c=$(expr $a + $b)
    echo $c
} 
```

并通过执行以下操作在您的 shell 中使用该函数：

```
source script.sh
add 100 1000 
```

如果在您的 script.sh 文件中，您使用：

```
./script.sh arg1 arg2 
```

脚本文件的内容是：

```
#! /bin/bash
add () {

    a=$1
    b=$2
    c=$(expr $a + $b)
    echo $c

}
add $1 $2 
```

**Obs**：您的语法在函数定义中无效：您必须包含一个表达式才能分配它的评估结果；评估表达式的语法可以是`cmd`或者 $(cmd)，不同之处在于第一种方法不允许嵌套调用。

如果您定义了多个函数，您可以为每个函数调用设置参数，或者简单地定义您的函数，然后使用“source script.sh”将它们加载到您的 shell。

由于您已经加载了函数，因此您需要调用它们以及它们是否已被一一定义。函数内部的 args 对应于 C 中经典的“argv[]”参数，它们是函数调用所独有的。

例如，如果您想定义一个 add 和一个 sub 函数，您将拥有：

```
#! /bin/bash
add () {
    a=$1
    b=$2
    c=$(expr $a + $b)
    echo $c
}
add $1 $2

sub() {
    a=$1
    b=$2
    c=$(expr $a - $b)
    echo $c
}
sub $3 $4 
```

或者任何参数编号可能适合您的应用程序。

但是请注意，您可能会忘记 var 的“语义”：这可能是由 bash 脚本的动态范围引起的，它会在每次执行调用时隐藏您的变量定义。

一个简单的例子是 for 循环。考虑如下定义的 add 函数：

```
add () {
    let i=$1 + $2
} 
```

并且 for 循环被执行为：

```
for (( i = 0; i < 10; i++ )); do
    echo $i
    add i 5
    echo $i
done 
```

输出是：

```
0
5
6
11 
```

由于变量“i”已被修改，在 for 循环期间，不仅被“i++”修改，还被函数“add”修改，该函数在其范围内使用了“i”。

# python - 使用Qt状态机和pyside进入状态时调用方法

> ID：13484163
> 
> 赞同：1
> 
> 时间：2012-11-20T23:44:52.060
> 
> 标签：python, qt, methods, state, pyside

当使用 Qt 的状态机框架进入状态时，我试图在 python 中调用一个方法。我能够设置状态机和编辑 GUI 属性，但不能调用我编写的方法。有没有办法做到这一点？

请记住，我是 Qt 和 Python 的新手，因此非常感谢您提供示例或详细说明！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T01:45:32.273

使用 Qt 工具包的最佳理由之一是其出色的文档。尽管它主要是为 C++ 语言编写的，但您几乎不需要了解 C++ 即可使用它。

因此，我建议您从查看[状态机框架](http://qt-project.org/doc/qt-4.8/statemachine-api.html)概述开始。

对于 PySide 示例代码（从 Qt 的 C++ 示例中移植），请查看[pyside-examples 存储库](https://qt.gitorious.org/pyside/pyside-examples/trees/master/examples)。`animation`和目录`hyper-ui`都`state-machine`包含几个使用状态机框架的演示应用程序。

# ios - IOS 6通讯录

> ID：13484167
> 
> 赞同：0
> 
> 时间：2012-11-20T23:45:02.000
> 
> 标签：ios, xcode, ios6

尝试在我的 viewdidload 中使用以下代码，但我似乎无法将测试联系人加载到我的测试 iphone（运行 IOS 6）上。关于为什么这不起作用的任何建议？

```
CFErrorRef* error;
// create address book record
ABAddressBookRef addressBook = ABAddressBookCreateWithOptions(nil,error);
// create a person
ABRecordRef person = ABPersonCreate();
// first name of the new person
ABRecordSetValue(person, kABPersonFirstNameProperty, @"FirstName" , nil);
// his last name
ABRecordSetValue(person, kABPersonLastNameProperty, @"LastName", nil);
//add the new person to the record
ABAddressBookAddRecord(addressBook, person, nil);

ABRecordRef group = ABGroupCreate(); //create a group
ABRecordSetValue(group, kABGroupNameProperty,@"My Group", error); // set group's name
ABGroupAddMember(group, person, error); // add the person to the group
ABAddressBookAddRecord(addressBook, group, error); // add the group

//save the record
ABAddressBookSave(addressBook, nil);

// relase the ABRecordRef  variable
CFRelease(person); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T06:14:29.910

```
 NSMutableArray*   contactList=[[NSMutableArray alloc]initWithCapacity:0];
        ABAddressBookRef m_addressbook = ABAddressBookCreate();
        if (!m_addressbook) {
            NSLog(@"opening address book");
        }
        CFArrayRef allPeople = ABAddressBookCopyArrayOfAllPeople(m_addressbook);
        CFIndex nPeople = ABAddressBookGetPersonCount(m_addressbook);
        for ( int i=0;i < nPeople;i++) {
            NSMutableDictionary *dOfPerson=[NSMutableDictionary dictionary];
            ABRecordRef ref = CFArrayGetValueAtIndex(allPeople,i);
            CFStringRef firstName;
            NSString* lastName;
            firstName = ABRecordCopyValue(ref, kABPersonFirstNameProperty);
            lastName  = (NSString*)ABRecordCopyValue(ref, kABPersonLastNameProperty);
            if(!lastName){
                lastName=@"";
            }
            [dOfPerson setObject:[NSString stringWithFormat:@"%@ %@", firstName,lastName] forKey:@"name"];
            //For Email ids
            ABMutableMultiValueRef eMail  = ABRecordCopyValue(ref, kABPersonEmailProperty);
            if(ABMultiValueGetCount(eMail) > 0) {
                [dOfPerson setObject:(NSString *)ABMultiValueCopyValueAtIndex(eMail, 0) forKey:@"email"];
            }
            //Birthday
            CFStringRef birthday  = ABRecordCopyValue(ref, kABPersonBirthdayProperty);
            if(birthday){
                [dOfPerson setObject: (NSDate*)birthday forKey:@"birthday"];
            }
            ABRecordRef record = CFArrayGetValueAtIndex(allPeople,i);
            //******* RecordID
            NSNumber *recordId = [NSNumber numberWithInteger:ABRecordGetRecordID(record)];
            NSString *recordStr=[NSString stringWithFormat:@"%@",recordId];
            [dOfPerson setObject:recordStr forKey:@"recordId"];
            //********
            ABMultiValueRef phones = ABRecordCopyValue(record, kABPersonPhoneProperty);
            //For Phone number
            NSString* mobileLabel;
            for(CFIndex j = 0; j < ABMultiValueGetCount(phones); j++)
            {
                mobileLabel = (NSString*)ABMultiValueCopyLabelAtIndex(phones, j);
                if([mobileLabel isEqualToString:(NSString *)kABPersonPhoneMobileLabel])
                {
                    [dOfPerson setObject:(NSString*)ABMultiValueCopyValueAtIndex(phones, j) forKey:@"Phone"];
                }
                else if ([mobileLabel isEqualToString:(NSString*)kABPersonPhoneIPhoneLabel])
                {
                    [dOfPerson setObject:(NSString*)ABMultiValueCopyValueAtIndex(phones, j) forKey:@"Phone"];
                    break ;
                }
            }
            ABMultiValueRef anniversaries = ABRecordCopyValue(record, kABPersonDateProperty);
            NSString *anniversaryLabel;
            for (CFIndex j=0; j < ABMultiValueGetCount(anniversaries); j++) {
                anniversaryLabel = (NSString*)ABMultiValueCopyLabelAtIndex(anniversaries, j);
                if([anniversaryLabel isEqualToString:(NSString *)kABPersonAnniversaryLabel])
                {
                    NSDate *anniversaryDate=(NSDate *)ABMultiValueCopyValueAtIndex(anniversaries, j);
                    NSLog(@"%@",anniversaryDate);
                    [dOfPerson setObject:anniversaryDate forKey:@"anniversaryDate"];
                }
            }
            [contactList addObject:dOfPerson];
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:50:28.753

看看我的问题：

它适用于 OSX，但我认为它也适用于 iOS：

[如何更新：（COCOA/OSX）ABPerson / ABMultiValue（电话号码）？](https://stackoverflow.com/questions/4663122/how-to-update-cocoa-osx-abperson-abmultivalue-phonenumbers)

# objective-c - CLLocationManager locationServicesEnabled ios6

> ID：13484168
> 
> 赞同：1
> 
> 时间：2012-11-20T23:45:02.250
> 
> 标签：objective-c, core-location, ios6

我对 Objective-C 相当陌生，我试图找到用户的位置。以下是我所拥有的，但存在解析问题`(![cLLocationManager locationServicesEnabled])`。

我认为它已被 iOS6 弃用，但我找不到改用什么。

```
- (void)updateLabels {
    if (location != nil) {
        self.latitudeLabel.text = [NSString stringWithFormat:@"%.8f",location.coordinate.latitude];
        self.longitudeLabel.text = [NSString stringWithFormat:@"%.8f",location.coordinate.longitude];
    } else {
        self.longitudeLabel.text = @"";
        self.latitudeLabel.text = @"";

        NSString *statusMessage;
        if ([lastLocationError.domain isEqualToString:kCLErrorDomain] && lastLocationError.code == kCLErrorDenied) {
            statusMessage = @"Location Services Disabled";
        } else {
            statusMessage = @"Error Getting Location";
        } else if (![CLLocationManager locationServicesEnabled]) { //Problem lies here
            statusMessage = @"Location Services Disabled";
        } else if (updatingLocation) {
            statusMessage = @"Searching...";
        } else {
            statusMessage = @"Press the Button to start";
        }

        self.messageLabel.text = statusMessage;         
    }
} 
```

任何帮助都感激不尽。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T00:32:41.140

你有一个额外的'['在问题所在的行并且方法是错误的。你有：

```
if (![[CLLocationManager locationServiceEnabled]) 
```

它应该是：

```
// Remove extra [ and spell method name correctly
if (![CLLocationManager locationServicesEnabled]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:35:06.823

该类方法`+ (BOOL)locationServicesEnabled`尚未被弃用，因此应该可以正常工作。

您是否已将相关导入添加到您的课程中？

```
#import <CoreLocation/CoreLocation.h> 
```

# excel - 如何以编程方式选择多个不同的单元格复制到剪贴板，然后手动粘贴到另一个工作表

> ID：13484171
> 
> 赞同：1
> 
> 时间：2012-11-20T23:45:14.630
> 
> 标签：excel, vba

举个简单的例子，我必须选择一列中的每 22 个单元格，直到找到一个空单元格。我需要能够将所有这些单元格复制到剪贴板以粘贴到另一个电子表格中。我可以正确选择每个单元格，但不知道如何将它们收集到一个要复制的对象中。

盯着看的评论需要代码。

子 SelectAllValidCells()

```
 ' select first cell

  [J15].Select

  ' Test contents of active cell; if active cell is empty, exit loop.

  Do Until IsEmpty(ActiveCell)

     ' ***** need to figure out how to gather the valid cells 
     ' here to later copy to clipboard when we reach empty cell 

     ' Step down 22 rows to the next cell.
     ActiveCell.Offset(22, 0).Select

    ' Return to top of loop.
  Loop
  '***** copy gathered cells to clipboard 
```

结束子

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:53:28.053

```
Sub Tester()

Dim rng As Range, c As Range

    Set c = Range("J15")

    Do
        If rng Is Nothing Then
            Set rng = c
        Else
            Set rng = Application.Union(rng, c)
        End If

        Set c = c.Offset(22, 0)
    Loop While Len(c.Value) > 0

    If Not rng Is Nothing Then
        rng.Copy Range("K1")
    End If

End Sub 
```

# c++ - 头文件和源文件之间的“类类型重新定义”错误

> ID：13484178
> 
> 赞同：7
> 
> 时间：2012-11-20T23:45:25.573
> 
> 标签：c++, visual-studio-2010, visual-studio

所以我遇到了一个问题，我确信有一个非常明显的解决方案，但我似乎无法弄清楚。基本上，当我尝试在头文件中定义类并在源文件中实现时，我收到一条错误消息，提示我正在重新定义我的类。使用 Visual C++ 2010 Express。

确切错误：“错误 C2011：‘节点’：‘类’类型重新定义”

示例代码如下：

节点.h：

```
#ifndef NODE_H
#define NODE_H
#include <string>

class Node{
public:
    Node();
    Node* getLC();
    Node* getRC();
private:
    Node* leftChild;
    Node* rightChild;
};

#endif 
```

节点.cpp：

```
#include "Node.h"
#include <string>

using namespace std;

class Node{
    Node::Node(){
        leftChild = NULL;
        rightChild = NULL;
    }

    Node* Node::getLC(){
        return leftChild;
    }

    Node* Node::getRC(){
        return rightChild;
    }

} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-20T23:48:46.530

```
class Node{
    Node::Node(){
        leftChild = NULL;
        rightChild = NULL;
    }

    Node* Node::getLC(){
        return leftChild;
    }

    Node* Node::getRC(){
        return rightChild;
    }

} 
```

您在代码中两次声明该类，第二次是在您的 .cpp 文件中。为了为您的班级编写函数，您将执行以下操作

```
Node::Node()
{
    //...
}

void Node::FunctionName(Type Params)
{
    //...
} 
```

不需要上课

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T23:50:38.047

正如它所说，您正在重新定义 Node 类。.cpp 文件仅用于实现功能。

```
//node.cpp
#include <string>

using namespace std;

Node::Node() {
  //defined here
}

Node* Node::getLC() {
  //defined here
}

.... 
```

# python - Python 嵌套函数作用域

> ID：13484182
> 
> 赞同：1
> 
> 时间：2012-11-20T23:46:13.070
> 
> 标签：python

我有一个 python 哈希，其中包含函数名称到函数的映射。我想修改每个散列条目以调用关联的函数但然后也调用最终的自定义函数。它的作用有点像退出钩子。

```
def original():
    print "original work" 
```

变成

```
def replacement():
    original()
    print "notify somebody..." 
```

我的问题是我认为我的范围界定等是错误的，因为以下代码的输出与预期不符。也许如果我可以问有没有更好的方法来做到这一点？我想坚持修改原始 cb，因为它是第三方代码，我改变的地方越少越好。

```
#!/usr/bin/python 

def a():
    print "a"

def b():
    print "b"

def c():
    print "c"

orig_fxn_cb = dict()

" basic name to function callback hash "
orig_fxn_cb['a'] = a
orig_fxn_cb['b'] = b
orig_fxn_cb['c'] = c

" for each call back routine in the hash append a final action to it "
def appendFxn(fxn_cb):
    appended_fxn_cb_new = dict()
    for i in orig_fxn_cb.keys():
        cb = fxn_cb[i]
        def fxn_tail():
            cb()
            print cb.__name__, "tail" 

        appended_fxn_cb_new[i] = fxn_tail
        appended_fxn_cb_new[i]()
    return appended_fxn_cb_new

" make up a modified callback hash "
xxx = appendFxn(orig_fxn_cb)
print xxx

for i in xxx:
    print xxx[i]() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T23:53:24.250

您是否追求：

```
from functools import wraps

def notifier(f):
    @wraps(f)
    def wrapped(*args, **kwargs)
        res = f(*args, **kwargs)
        print "notify somebody..."
        return res
    return wrapped

@notifier
def original():
    print "original work"

# or: original = notifier(original)

original() 
```

```
original work
notify somebody... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T00:02:18.973

您遇到的问题与`cb`您在`appendFxn`函数中使用的变量有关。您的内部函数定义通过名称访问此值，因此它们最终都引用了相同的内部回调函数（以迭代中最后出现的那个为准）。

您可以使用包装函数中的默认参数来解决此问题：

```
def appendFxn(fxn_cb):
    appended_fxn_cb_new = dict()
    for i in orig_fxn_cb.keys():
        cb = fxn_cb[i]
        def fxn_tail(cb = cb):           # fix is here!
            cb()
            print cb.__name__, "tail" 

        appended_fxn_cb_new[i] = fxn_tail
        appended_fxn_cb_new[i]()
    return appended_fxn_cb_new 
```

使用默认参数将 的*当前值*绑定到内部函数中`cb`的名称。`cb`这样，即使原始`cb`变量设置为新值，现有函数也会保留旧值。（如果需要，您也可以创建函数参数`cb = fxn_cb[i]`并删除外部`cb`变量。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T23:54:11.227

我不知道预期的输出是什么，它似乎在这里工作正常。它将字典中的所有函数替换为调用原始函数的副本，然后打印原始名称和“尾巴”。当它替换函数时，它也执行它们。最后，您遍历生成的字典并再次执行它们。

如果您多次调用 appendFxn 可能会给您带来意想不到的行为`for i in orig_fxn_cb.keys():`。它引用全局`orig_fxn_cb`而不是`fxn_cb`传递的参数，因此进一步调用不会更改映射中的函数。

# c++ - C++ - 如何分块文件以进行同时/异步处理？

> ID：13484184
> 
> 赞同：3
> 
> 时间：2012-11-20T23:46:45.097
> 
> 标签：c++, multithreading, asynchronous, pthreads

如何按行数读取和拆分/分块文件？

我想将文件划分为单独的缓冲区，同时确保一行不会在两个或多个缓冲区之间分割。我计划将这些缓冲区传递到它们自己的 pthread 中，以便它们可以执行某种类型的同时/异步处理。

我已经阅读了下面的答案[，在 Linux 上使用 c 分块读写，](https://stackoverflow.com/questions/10527187/reading-and-writing-in-chunks-on-linux-using-c)但我认为它并不能完全回答有关确保一行不分成两个或多个缓冲区的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T23:55:58.203

文件是如何编码的？如果每个字节代表一个字符，我会执行以下操作：

1.  内存映射文件使用`mmap()`.
2.  通过基于适当的块大小计算它来告诉作业它们的大致开始和结束。
3.  让每项工作通过查找下一项来找到其实际的开始和结束`'\n'`。
4.  同时处理各个块。
5.  请注意，第一个块需要特殊处理，因为它的开始不是近似的而是精确的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T23:56:14.153

我会选择一个以字节为单位的块大小。然后我会寻找文件中的适当位置并一次读取一些少量字节，直到我得到一个换行符。

第一个块的最后一个字符是换行符。第二个块的第一个字符是换行符之后的字符。

始终寻找 pagesize() 边界并一次读取 pagesize() 字节以搜索换行符。这将倾向于确保您只从磁盘中提取所需的最小值以找到您的边界。您可以尝试一次读取 128 个字节或其他内容。但是你会冒着进行更多系统调用的风险。

我写了一个示例程序来计算字母频率。当然，这在很大程度上没有意义，因为它几乎肯定是 IO 绑定的。而且换行符的位置也无关紧要，因为它不是面向行的。但是，这只是一个例子。此外，它在很大程度上依赖于您拥有相当完整的 C++11 实现。

*   [lisp.paste.org 上的 threaded_file_split.cpp](http://paste.lisp.org/+2VAD/1)

他们的关键功能是这样的：

```
// Find the offset of the next newline given a particular desired offset.
off_t next_linestart(int fd, off_t start)
{
   using ::std::size_t;
   using ::ssize_t;
   using ::pread;

   const size_t bufsize = 4096;
   char buf[bufsize];

   for (bool found = false; !found;) {
      const ssize_t result = pread(fd, buf, bufsize, start);
      if (result < 0) {
         throw ::std::system_error(errno, ::std::system_category(),
                                   "Read failure trying to find newline.");
      } else if (result == 0) {
         // End of file
         found = true;
      } else {
         const char * const nl_loc = ::std::find(buf, buf + result, '\n');
         if (nl_loc != (buf + result)) {
            start += ((nl_loc - buf) + 1);
            found = true;
         } else {
            start += result;
         }
      }
   }
   return start;
} 
```

Also notice that I use `pread`. This is absolutely essential when you have multiple threads reading from different parts of the file.

The file descriptor is a shared resource between your threads. When one thread reads from the file using ordinary functions it alters a detail about this shared resource, the file pointer. The file pointer is the position in the file at which the next read will occur.

Simply using `lseek` before you read each time does not help this because it introduces a race condition between the `lseek` and the `read`.

The `pread` function allows you to read a bunch of bytes from a specific location within the file. It also doesn't alter the file pointer at all. Apart from the fact that it doesn't alter the file pointer, it's otherwise like combining an `lseek` and a `read` in the same call.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T10:07:00.423

Define a class for the buffers. Give each one a large buffer space that is some multiple of page size and a start/end index, a method that reads the buffer from a passed-in stream and a 'lineParse' method that takes another *buffer instance as a parameter.

Make some *buffers and store them on a producer-consumer pool queue. Open the file, get a buffer from the pool and read into the buffer space from start to end, (return a boolean for error/EOF). Get another *buffer from the pool and pass it into the lineparse() of earlier one. In there, search backwards from the end of the data, looking for newLine. When found, reload the end index and memcpy the fragment of the last line, (if there is one - you might occasionally be lucky:), into the new, passed *buffer and set its start index. The first buffer now has whole lines and can be queued off to the thread/s that will process the lines. The second buffer has the fragment of line copied from the first and more data can be read from disk into its buffer space at its start index.

The line-processing thread/s can recycle the 'used' *buffers back to the pool.

Keep going until EOF, (or error:).

If you can, add a method to the buffer class that does the processing of the buffer.

Using large buffer classes and parsing back from the end will be mure efficient than continually reading small bits, looking for newlines from the start. Inter-thread comms is slow and the larger the buffers you can pass, the better.

Using a pool of buffers eliminates continual new/delete and provides flow-control - if the disk read thread is faster than the processing, the pool will empty and the disk read thread will block on it until some used buffers are recycled. This prevents memory runaway.

Note that if you use more than one processing thread, the buffers may get processed 'out-of-order' - this may, or may not, matter.

You can only gain in this scenario by ensuring that the advantage of lines being processed in parallel with disk-read latencies is greater than the overhead of inter-thread comms - communicating small buffers between threads is very likely to be counter-productive.

The biggest speedup would be experienced with networked disks that are fast overall, but have large latencies.

# .net - 如何从使用 .Net 实体查询创建的 IQueryable 对象中获取可用的连接字符串

> ID：13484186
> 
> 赞同：1
> 
> 时间：2012-11-20T23:46:53.173
> 
> 标签：.net, entity-framework-4, ado.net, connection-string, iqueryable

在**可用**下，我的意思是我可以用来连接到数据库`SqlConection`并使用`ExecuteReader`.

我从中得到的字符串`IQueryable.Context.Connection.ConnectionString`contains `"name=MyConnectionAlias"`。

我需要的是在文件部分中`provider connection string`定义的属性值。`MyConnectionAlias``connectionStrings``config`

该值通常包含`Data Source=MyDbServer;Initial Catalog=MyDb;Intergrated Security=True;MultipleActiveResultSets=True"`.

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-20T23:54:29.710

```
((System.Data.EntityClient.EntityConnection)((ObjectQuery)IQueryable).Context.Connection).StoreConnection.ConnectionString 
```

# c# - 使用特殊字符解析 XML

> ID：13484187
> 
> 赞同：2
> 
> 时间：2012-11-20T23:46:55.107
> 
> 标签：c#, xml, xml-parsing

有上面提到的问题，我正在尝试解析一个上面有 xml 的字符串。我正在使用类 XDocument 和 XElement 将 XML 上的信息解析为字典。代码看起来像这样：

```
XDocument xDoc = XDocument.Parse(xmlString); 
Dictionary<string, string> dic = new Dictionary<string,string>();
foreach(XElement x in xDoc.Root.Descendants())
{
    temp.Add(x.Name.ToString(),x.Value.ToString());
} 
```

**xmlString 是具有 xml 内容的字符串

这通常可以正常工作，除非 xmlString 在标记上有某种特殊字符（'>'、'<'、'&'）。例如，当出现这样的情况时：

```
<Content> #include <stdio.h> </Content> 
```

我假设我实现的代码在这种情况下不起作用，因为 C# 会查看他认为应该看到的 XML 标记具有纯文本。基本上，我的问题是我怎样才能设法解析这种包含特殊字符的 XML 有我之前所说的那种？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T23:53:05.783

如果我理解正确，您正在尝试解析无效的 xml。

如果可以，我建议您修复生成此 xml 的代码并使其有效。

如果你不能，你需要编写/使用一个函数，它将这些特殊字符转换为它们的编码变体。

# jquery-mobile - 在动态创建的可折叠集中刷新可折叠列表

> ID：13484193
> 
> 赞同：3
> 
> 时间：2012-11-20T23:47:18.200
> 
> 标签：jquery-mobile

jsFiddle 上的示例代码：http: [//jsfiddle.net/MqDFt/6/](http://jsfiddle.net/MqDFt/6/)

在此背景下，它是一个出现的对话窗口，当用户开始输入搜索查询时，它会显示一些找到的结果。以下是 PHP 通过 AJAX 返回的结果示例：

```
<div data-role='collapsible' data-mini='true'>
    <h3>appcent.com<span style='float: right;margin-top: -16px;padding-right: 10px;'>(1)</span></h3>
    <ul data-role='listview'>
        <li><a href='adv_dns_displayResults.php?lid=87e2a2ef68c71c220d6a519ab6d668b2'><span style='float: left;'>appcent.com</span><span style='float: right;'>2012-01-30 19:02:46</span></a></li>
    </ul>
</div>
<div data-role='collapsible' data-mini='true'>
    <h3>apallen.net<span style='float: right;margin-top: -16px;padding-right: 10px;'>(2)</span></h3>
    <ul data-role='listview'>
        <li><a href='adv_dns_displayResults.php?lid=8df9e81f2245f9cae41f1e95899598b3'><span style='float: left;'>apallen.net</span><span style='float: right;'>2010-07-30 15:37:32</span></a></li>
        <li><a href='adv_dns_displayResults.php?lid=a9387b995e88c7573141451546839e96'><span style='float: left;'>apallen.net</span><span style='float: right;'>2010-07-30 15:37:32</span></a></li>
    </ul>
</div>
<div data-role='collapsible' data-mini='true'>
    <h3>aptfire.com<span style='float: right;margin-top: -16px;padding-right: 10px;'>(2)</span></h3>
    <ul data-role='listview'>
        <li><a href='adv_dns_displayResults.php?lid=7de36861bcc8a2064ce7f428cc384c8c'><span style='float: left;'>aptfire.com</span><span style='float: right;'>2011-10-13 10:29:16</span></a></li>
        <li><a href='adv_dns_displayResults.php?lid=bf8c93976d5bba46b7313b9bb990ef3c'><span style='float: left;'>aptfire.com</span><span style='float: right;'>2011-10-13 10:29:18</span></a></li>
    </ul>
</div> 
```

Collapsible-Set 正确刷新，但 listview 没有。我尝试刷新列表视图、触发器创建以及其他内容的组合。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T08:06:36.320

这是正确的代码：

```
$("#pastSearchResults ul").each(function(i) {
    $(this).listview(); 
}); 
```

笔记：

1.  使用简化的选择器，它返回 div "#pastSearchResults" 下的所有 "ul" 标签
2.  选择器返回一个列表，而不仅仅是一个项目，因此对其进行迭代
3.  调用 listview() 不带参数“刷新”，因为这是第一个创建列表（不是旧的和刷新的）

# django - Django标签在块标签中返回一个数组

> ID：13484196
> 
> 赞同：2
> 
> 时间：2012-11-20T23:47:38.087
> 
> 标签：django, django-templates

我有一个字符串项数组，我想在 HTML 表格中显示，看起来模板中最简单的方法是“消息”表单。我称它们为“活动”：

```
{% if activities %}
  <table class="activities">
    <tr>
     {% for activity in activities %}
       <td>{{ activity }}</td>
     {% endfor %}
    </tr>
  </table>
{% endif %} 
```

我认为活动可能是一个返回数组的简单标记，但我从其他 stackoverflow 答案（链接如下）中看到，这是用于返回要放入模板中的字符串，而不是用于返回值。

我不需要这个数组的上下文或任何参数，但它可能以不同的格式出现在不同的页面上，所以我不希望标签返回表格的“innerHTML”。

我怎么做？我在一个附加文件中尝试了以下内容（为了验证它是否被调用，我故意将语法错误放入其中，果然当我转到此页面时它们触发了它们，所以我删除了它们）：

```
from django import template

register = template.Library()

@register.simple_tag
def activities():
  return ("A", "B")
activities = register.simple_tag(activities) 
```

我还尝试了只使用装饰器，只调用“注册”（有和没有返回值的设置），但没有一个工作。桌子总是空的。

关于 stackoverflow 有很多相关的问题，但每个问题似乎都是针对略有不同的情况量身定制的，而使用包含标签的[最接近](https://stackoverflow.com/questions/9860717/problems-with-simple-tag-array-values-in-django-template)的问题似乎对这个简单的情况进行了过度设计。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:35:03.287

如果您使用的是 Django >= 1.4，则有一种创建[分配标签](https://docs.djangoproject.com/en/dev/howto/custom-template-tags/#assignment-tags)的简单方法。这些将它们的返回值存储在`as`关键字之后指定的模板变量中。在你的情况下，那将是：

```
{% get_activities as activities %}
{% if activities %}
  <table class="activities">
    <tr>
     {% for activity in activities %}
       <td>{{ activity }}</td>
     {% endfor %}
    </tr>
  </table>
{% endif %} 
```

这个标签后面的代码非常简单。真正重要的是`assignment_tag`装饰器。

```
from django import template

register = template.Library()

@register.assignment_tag
def get_activities():
    return ("A", "B") 
```

对于早于 1.4 的 Django 版本，这仍然是可行的，但需要更多样板代码来创建编译函数和节点类。事实上，Django 文档在之前就[描述了这种方法](https://docs.djangoproject.com/en/dev/howto/custom-template-tags/#setting-a-variable-in-the-context)`assignment_tag`。

# java - 如何更有效地使用@Nullable 和@Nonnull 注解？

> ID：13484202
> 
> 赞同：163
> 
> 时间：2012-11-20T23:48:03.413
> 
> 标签：java, annotations, nullpointerexception, nullable, code-standards

我可以看到，`@Nullable`注释`@Nonnull`可能*有助于*防止`NullPointerException`s 但它们不会传播很远。

*   这些注释的有效性在一级间接后完全下降，所以如果你只添加一些，它们不会传播很远。
*   由于这些注释没有得到很好的执行，因此存在假设标记为 的值`@Nonnull`不是 null 并因此不执行 null 检查的危险。

下面的代码导致标记为的参数`@Nonnull`没有`null`引起任何投诉。它在运行时抛出一个`NullPointerException`。

```
public class Clazz {
    public static void main(String[] args){
        Clazz clazz = new Clazz();

        // this line raises a complaint with the IDE (IntelliJ 11)
        clazz.directPathToA(null);

        // this line does not
        clazz.indirectPathToA(null); 
    }

    public void indirectPathToA(Integer y){
        directPathToA(y);
    }

    public void directPathToA(@Nonnull Integer x){
        x.toString(); // do stuff to x        
    }
} 
```

有没有办法让这些注释更严格地执行和/或进一步传播？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-11-21T01:34:42.220

简短的回答：我猜这些注释仅对您的 IDE 有用，以警告您潜在的空指针错误。

正如“清洁代码”一书中所说，您应该检查公共方法的参数，并避免检查不变量。

另一个好技巧是永远不要返回空值，而是使用[空对象模式](http://en.wikipedia.org/wiki/Null_Object_pattern)。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-11-21T08:57:28.723

除了当您传递`null`给期望参数不为 null 的方法时，您的 IDE 会给您提示之外，还有其他优点：

*   静态代码分析工具可以像你的 IDE 一样测试（例如 FindBugs）
*   您可以使用[面向方面的编程 (AOP)](https://en.wikipedia.org/wiki/Aspect-oriented_programming)来检查这些断言

这可以帮助您的代码更易于维护（因为您不需要`null`检查）并且不易出错。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2016-06-22T16:37:58.530

我认为这个原始问题间接指向了一个一般建议，即仍然需要运行时空指针检查，即使使用了@NonNull。请参考以下链接：

[Java 8 的新类型注解](https://blogs.oracle.com/java/post/java-8s-new-type-annotations "Java 8 的新类型注解")

在上面的博客中，建议：

> **可选类型注释不能替代运行时验证** 在类型注释之前，描述可空性或范围等内容的主要位置是在 javadoc 中。使用类型注释，这种通信以编译时验证的方式进入字节码。您的代码仍应执行运行时验证。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2015-09-18T22:06:11.820

在 Eclipse 中以合规性 1.8 编译原始示例并启用基于注释的 null 分析，我们收到以下警告：

```
 directPathToA(y);
                  ^
Null type safety (type annotations): The expression of type 'Integer' needs unchecked conversion to conform to '@NonNull Integer' 
```

此警告的措辞类似于您在使用原始类型（“未经检查的转换”）将通用代码与遗留代码混合时收到的警告。我们在这里有完全相同的情况：方法`indirectPathToA()`有一个“遗留”签名，因为它没有指定任何空合约。工具可以轻松地报告这一点，因此它们会在需要传播但尚未传播空注释的所有小巷中追逐你。

而当使用聪明时，`@NonNullByDefault`我们甚至不必每次都这么说。

换句话说：空注释是否“传播得很远”可能取决于您使用的工具，以及您对工具发出的所有警告的关注程度。使用[TYPE_USE 空注释](http://help.eclipse.org/mars/topic/org.eclipse.jdt.doc.user/tasks/task-using_null_type_annotations.htm?cp=1_3_9_1)，您最终可以选择让工具警告您程序中**每个**可能的 NPE，因为空性已成为类型系统的固有属性。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2017-01-16T15:25:45.083

我在我的项目中所做的是在“常量条件和异常”代码检查中激活以下选项：
*为可能返回 null 并报告传递给非注释参数的可空值的方法建议 @Nullable 注释* [![检查](../Images/42e2436a8a00bed3d8bb18536b625439.png)](https://i.stack.imgur.com/bfG9h.png)

激活后，所有未注释的参数都将被视为非空，因此您还会在间接调用中看到警告：

```
clazz.indirectPathToA(null); 
```

对于更强大的检查，Checker Framework 可能是一个不错的选择（请参阅这个不错的[教程](https://github.com/glts/safer-spring-petclinic/wiki)。
**注意**：我还没有使用过，Jack 编译器可能存在问题：请参阅[此错误报告](https://github.com/karlicoss/checker-fenum-android-demo/issues/8)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-09-01T06:33:24.563

我同意注释“不会传播得很远”。但是，我看到了程序员方面的错误。

我将`Nonnull`注释理解为文档。以下方法表示需要（作为前提条件）非空参数`x`。

```
 public void directPathToA(@Nonnull Integer x){
        x.toString(); // do stuff to x        
    } 
```

然后以下代码片段包含一个错误。方法调用`directPathToA()`而不强制`y`非空（即，它不保证被调用方法的前提条件）。一种可能性是将`Nonnull`注释也添加到`indirectPathToA()`（传播前提条件）。可能性二是检查`y`in是否为空，`indirectPathToA()`避免调用`directPathToA()`when`y`为空。

```
 public void indirectPathToA(Integer y){
        directPathToA(y);
    } 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2017-09-19T01:52:01.440

如果您使用 Kotlin，它会在其编译器中支持这些可空性注释，并将阻止您将空值传递给需要非空参数的 java 方法。事件虽然这个问题最初是针对 Java 的，但我提到了这个 Kotlin 特性，因为它专门**针对这些 Java 注释**，问题是*“有没有办法让**这些注释**更严格地执行和/或进一步传播？”* 而这个特性确实**让这些注解得到了更严格的执行**。

`@NotNull`使用注解的 Java 类

```
public class MyJavaClazz {
    public void foo(@NotNull String myString) {
        // will result in an NPE if myString is null
        myString.hashCode();
    }
} 
```

Kotlin 类调用 Java 类并为使用 @NotNull 注释的参数传递 null

```
class MyKotlinClazz {
    fun foo() {
        MyJavaClazz().foo(null)
    }
} 
```

强制`@NotNull`注释的 Kotlin 编译器错误。

```
Error:(5, 27) Kotlin: Null can not be a value of a non-null type String 
```

见： http: [//kotlinlang.org/docs/reference/java-interop.html#nullability-annotations](http://kotlinlang.org/docs/reference/java-interop.html#nullability-annotations)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-11-21T01:38:08.170

在 Java 中，我会使用[Guava 的 Optional type](http://code.google.com/p/guava-libraries/wiki/UsingAndAvoidingNullExplained)。作为一种实际类型，您可以获得编译器对其使用的保证。绕过它并获得 a 很容易`NullPointerException`，但至少该方法的签名清楚地传达了它期望作为参数的内容或可能返回的内容。

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2019-12-20T17:59:15.250

**由于 Java 8 的新特性[Optional](https://docs.oracle.com/javase/8/docs/api/java/util/Optional.html)你不应该在你自己的代码中使用 @Nullable 或 @Notnull 了**。举个例子：

```
public void printValue(@Nullable myValue) {
    if (myValue != null) {
        System.out.print(myValue);
    } else {
        System.out.print("I dont have a value");
} 
```

它可以重写为：

```
public void printValue(Optional<String> myValue) {
    if (myValue.ifPresent) {
        System.out.print(myValue.get());
    } else {
        System.out.print("I dont have a value");
} 
```

使用可选项**强制您检查空值**。在上面的代码中，您只能通过调用`get`方法来访问值。

另一个优点是**代码变得更具可读性**。随着 Java 9 [ifPresentOrElse](https://docs.oracle.com/javase/9/docs/api/java/util/Optional.html#ifPresentOrElse-java.util.function.Consumer-java.lang.Runnable-)的加入，该函数甚至可以写成：

```
public void printValue(Optional<String> myValue) {
    myValue.ifPresentOrElse(
        v -> System.out.print(v),
        () -> System.out.print("I dont have a value"),
    )
} 
```

# php - 更新语句不起作用mysql

> ID：13484203
> 
> 赞同：0
> 
> 时间：2012-11-20T23:48:09.487
> 
> 标签：php

我有一个不友好的系统，它可以工作。单击取消好友按钮时，表格会更新以删除您已更新的好友。唯一的问题是它会删除你所有的朋友，而不是数组中的 1 个。

该数组类似于这个friend1，friend2，friend3，如果你想删除friend2，friend1和3也会无缘无故地被删除。

帮助 ：（

```
 if (@$_POST['removefriend']) {
    //Friend array for logged in user
     $add_friend_check = mysql_query("SELECT friend_array FROM users WHERE username='{$_SESSION['user_login']}'");
     $get_friend_row = mysql_fetch_assoc($add_friend_check);
      $friend_array = $get_friend_row['friend_array'];
      $friend_array_explode = explode(",",$friend_array);
      $friend_array_count = count($friend_array_explode);

      //Friend array for user who owns profile
      $add_friend_check_username = mysql_query("SELECT friend_array FROM users WHERE username='{$_SESSION['user_login']}'");
      $get_friend_row_username = mysql_fetch_assoc($add_friend_check_username);
        $friend_array_username = $get_friend_row_username['friend_array'];
        $friend_array_explode_username = explode(",",$friend_array_username);
        $friend_array_count_username = count($friend_array_explode_username);

        $usernameComma = ",".$username;
        $usernameComma2 = $username.",";

        $userComma = ",".$user;
        $userComma2 = $user.",";

        if (strstr($friend_array,$usernameComma)) {
        $friend1 = str_replace("$usernameComma","",$friend_array);
        }
        else
        if (strstr($friend_array,$usernameComma2)) {
        $friend1 = str_replace("$usernameComma2","",$friend_array);
         }
         else
         if (strstr($friend_array,$username)) {
          $friend1 = str_replace("$username","",$friend_array);
          }
         //Remove logged in user from other persons array
         if (strstr($friend_array,$userComma)) {
         $friend2 = str_replace("$userComma","",$friend_array);
           }
         else
         if (strstr($friend_array,$userComma2)) {
         $friend2 = str_replace("$userComma2","",$friend_array);
         }
         else
         if (strstr($friend_array,$user)) {
         $friend2 = str_replace("$user","",$friend_array);
         }

         $friend2 = "";

        $removeFriendQuery = mysql_query("UPDATE users SET friend_array='$friend1' WHERE username='{$_SESSION['user_login']}'");
        $removeFriendQuery_username = mysql_query("UPDATE users SET friend_array='$friend2' WHERE username='{$_SESSION['user_login']}'");
        echo "Friend Removed ...";
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T02:27:33.007

首先，我建议遵循什么`@MarkBaker`并`@nichar`建议和规范您的数据库结构。您可以查看[stackoverflow.com/questions/5135889/how-to-normalize-a-sql-database](https://stackoverflow.com/questions/5135889/how-to-normalize-a-sql-database)以及搜索 stackoverflow - [stackoverflow.com/search?q=How+to+normalize+a+SQL+Database](https://stackoverflow.com/search?q=How+to+normalize+a+SQL+Database)。

考虑到这一点，您的代码存在一些问题-

(1) 您在两个查询中得到相同的朋友数组。

```
//Friend array for logged in user
$add_friend_check = mysql_query("SELECT friend_array FROM users WHERE username='{$_SESSION['user_login']}'");
//Friend array for user who owns profile
$add_friend_check_username = mysql_query("SELECT friend_array FROM users WHERE username='{$_SESSION['user_login']}'"); 
```

您的第二个查询应该是从他们正在删除的朋友那里获取朋友数组。

```
$add_friend_check_username = mysql_query("SELECT friend_array FROM users WHERE username='$username'"); 
```

（2）当从他们的朋友数组中删除用户时，您使用他们自己的朋友数组

```
//Remove logged in user from other persons array
if (strstr($friend_array,$userComma)) {
$friend2 = str_replace("$userComma","",$friend_array);
}
else
if (strstr($friend_array,$userComma2)) {
$friend2 = str_replace("$userComma2","",$friend_array);
}
else
if (strstr($friend_array,$user)) {
$friend2 = str_replace("$user","",$friend_array);
} 
```

您应该将它们从朋友数组中删除

```
//Remove logged in user from other persons array
if (strstr($friend_array_username,$userComma)) {
$friend2 = str_replace("$userComma","",$friend_array_username);
}
else
if (strstr($friend_array_username,$userComma2)) {
$friend2 = str_replace("$userComma2","",$friend_array_username);
}
else
if (strstr($friend_array_username,$user)) {
$friend2 = str_replace("$user","",$friend_array_username);
} 
```

(3) 在完成将他们从好友数组中删除的所有工作之后，您现在将好友数组设为空

```
$friend2 = ""; 
```

这应该被删除。

(4) 最后，您更新 users 朋友数组两次，而不是朋友数组，当您进行第二次更新时，您将根据问题 #4 将其设为空

```
$removeFriendQuery = mysql_query("UPDATE users SET friend_array='$friend1' WHERE username='{$_SESSION['user_login']}'");
$removeFriendQuery_username = mysql_query("UPDATE users SET friend_array='$friend2' WHERE username='{$_SESSION['user_login']}'"); 
```

将您的第二个查询更改为 -

```
$removeFriendQuery_username = mysql_query("UPDATE users SET friend_array='$friend2' WHERE username='$username'"); 
```

现在，我假设

```
$username == the friend that you are deleting 
$user == logged-in user || $_SESSION['user_login'] 
```

因为这些已使用，但未在您的代码中定义。

另外，请注意，您不应该使用`mysql_*`函数编写新代码。不鼓励使用此扩展程序。相反，应该使用[MySQLi](http://us3.php.net/manual/en/book.mysqli.php)或[PDO_MySQL扩展。](http://us3.php.net/manual/en/ref.pdo-mysql.php)另请参阅[MySQL：选择 API](http://us3.php.net/manual/en/mysqlinfo.api.choosing.php)指南和相关的[常见问题解答](http://us3.php.net/manual/en/faq.databases.php#faq.databases.mysql.deprecated)以获取更多信息。

# cherrypy - cherrypy - URL 调度程序

> ID：13484206
> 
> 赞同：2
> 
> 时间：2012-11-20T23:48:44.890
> 
> 标签：cherrypy

> **可能重复：**
> [在 CherryPy 中使用映射](https://stackoverflow.com/questions/11142625/using-mappings-in-cherrypy)

如何将 /data/[AZ].txt 之类的 url regEx 映射到cherrypy 中的资源？某处有一个简单的例子吗？我这里没有文档。

[http://tools.cherrypy.org/wiki/RestfulDispatch](http://tools.cherrypy.org/wiki/RestfulDispatch)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T01:43:41.467

您可以使用[RoutesDispatcher](https://github.com/cherrypy/cherrypy/blob/master/cherrypy/test/test_routes.py)

```
import cherrypy

class City:
    def __init__(self, name):
        self.name = name
        self.population = 10000

    @cherrypy.expose
    def index(self, **kwargs):
        return "Welcome to %s, pop. %s" % (self.name, self.population)

    @cherrypy.expose
    def update(self, **kwargs):
        self.population = kwargs['pop']
        return "OK"

d = cherrypy.dispatch.RoutesDispatcher()
d.connect(action='index', name='hounslow', route='/hounslow', controller=City('Hounslow'))
d.connect(action='index', name='surbiton', route='/surbiton', controller=City('Surbiton'),
          conditions=dict(method=['GET']))
d.mapper.connect('/surbiton', controller='surbiton',
                 action='update', conditions=dict(method=['POST']))

conf = {'/': {'request.dispatch': d}}
cherrypy.config.update({'server.socket_port': 5000})
cherrypy.tree.mount(root=None, config=conf)
cherrypy.engine.start() 
```

[您可以在http://127.0.0.1:5000/surbiton](http://127.0.0.1:5000/surbiton)上使用浏览器对此进行测试。 您可以使用 curl 测试 POST 命令：

```
curl -i -X GET http://127.0.0.1:5000/surbiton
curl -i -d "pop=100" -X POST http://127.0.0.1:5000/surbiton
curl -i -X GET http://127.0.0.1:5000/surbiton 
```

有来自[Routes 项目](http://routes.readthedocs.org/en/latest/)的文档。

或者来自[appmecha](http://appmecha.wordpress.com/2008/10/27/cherrypy-gae-routing-2/)的这个例子。

# applescript - 通过 Applescript 从 HTML 解析多个标签

> ID：13484211
> 
> 赞同：1
> 
> 时间：2012-11-20T23:49:01.953
> 
> 标签：applescript

如果我想提取所有演员的名字，我试过这个，但它只提取一个名字。是否有重复循环或其他任何我可以做的事情来让它拉出所有说的标签`<span itemprop="name">`？

```
set astid to AppleScript's text item delimiters

set startHere to "<span itemprop=\"name\">"
set stopHere to "</span>"
set mysource_html to do shell script "curl https://play.google.com/store/movies/details?id=H9EKG4-JHSw"
set AppleScript's text item delimiters to startHere
set blurb1 to text item 2 of mysource_html
set AppleScript's text item delimiters to stopHere
set blurb2 to text item 1 of blurb1

set AppleScript's text item delimiters to astid 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T00:21:24.533

尝试：

```
set {TID, text item delimiters} to {text item delimiters, {"<td class=\"credit-label\">Actors</td>", "<td class=\"credit-label\">Producers</td>"}}
set mysource_html to text item 2 of (do shell script "curl https://play.google.com/store/movies/details?id=H9EKG4-JHSw")
set text item delimiters to TID

set mysource_html to every paragraph of (do shell script "echo " & quoted form of mysource_html & " | grep -Eo '<span itemprop=\"name\">[^<]*' | sed 's/.*>//g'") 
```

# php - mysql全文第一个/最后一个昵称搜索很慢

> ID：13484212
> 
> 赞同：0
> 
> 时间：2012-11-20T23:49:11.533
> 
> 标签：php, mysql, performance, full-text-search

我正在对 30-40 个工厂记录数据库使用全文搜索。其中 80% 在一张桌子上。我正在以全文形式搜索名字和姓氏，因为全名可以以多种方式存储“比尔盖茨”“盖茨，比尔”“比尔和梅琳达盖茨”等。我们还有一个昵称数据库所以它将搜索“bill”、“will”、“william”等。查找昵称完全不需要时间，但是一旦我实现了包含昵称的查询，它现在需要更长的时间。

```
SELECT * FROM db1 
WHERE MATCH (Name) AGAINST (' +bill +gates 'IN BOOLEAN MODE) UNION ALL 
... (then the other 8 dbs the same) limit 500 
```

相比：

```
SELECT * FROM db1 
WHERE MATCH (Name) AGAINST (' +("bill" "will" "william") +gates 'IN BOOLEAN MODE) UNION ALL 
... (then the other 8 dbs the same) limit 500 
```

有没有办法加快这个速度？与 3-5 秒相比，搜索需要 40 多秒。像比尔盖茨这样的名字应该很容易达到 500 大关似乎需要更长的时间，即使它有更多的机会达到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T16:11:35.607

使用搜索引擎而不是 MySql 会节省您的时间。看看 Solr 或 Sphinx。

Sphinx 有 mysql 插件。

# windows - 访问 Intranet 站点后尝试关闭 IE 时出现 VBA 错误

> ID：13484216
> 
> 赞同：1
> 
> 时间：2012-11-20T23:49:52.567
> 
> 标签：windows, excel, vba

如果使用诸如谷歌之类的互联网站点，则下面的代码可以正常工作。但是，我需要访问一个工作 Intranet 站点。当我这样做时，出现以下错误，运行时错误“-2147023179 (800706b5)”：自动化错误接口未知。

```
Dim ie As Object

Set ie = CreateObject("InternetExplorer.Application")
ie.Visible = True
ie.Navigate "INTRANET SITE"

Do While ie.Busy
    DoEvents
Loop

ie.Quit
Set ie = Nothing 
```

请帮忙。谢谢。

注意：如果 excel 以管理员身份运行，那么这工作正常；但是，我认为 Excel 不可能仅作为这一个工作簿的管理员运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:10:08.100

取消选中保护模式解决了这个问题。

也可以使用以下代码

```
Set ie = New InternetExplorerMedium 
```

# facebook - Facebook 推荐按钮自动关闭

> ID：13484219
> 
> 赞同：1
> 
> 时间：2012-11-20T23:50:23.023
> 
> 标签：facebook, facebook-like, facebook-recommendations

当我单击推荐按钮时，会弹出另一个 div，您可以在其中将其发布到墙上，但它会自动关闭并返回到以前的状态。有谁知道热修复它？太感谢了！

# css - 水平居中 li - 多行

> ID：13484226
> 
> 赞同：0
> 
> 时间：2012-11-20T23:50:52.960
> 
> 标签：css, centering

我正在尝试创建一个水平居中的固定宽度、固定高度项目的无序列表。如果只有 1 个项目，它将位于中间。随着更多项目的添加，它将从中间向外增长。当达到容器宽度时，它将换行到下一行，如图所示。

是否有可能实现这一点并使其在 ie7、ie8 和所有其他主要浏览器中工作？非常感激任何的帮助。

非常感谢。

![我想要达到的目标](../Images/fcb4cb3aa040ed970c8ee022ec334222.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T23:54:32.190

您可以使用`inline-block`在 IE7 和其他浏览器上运行良好的 CSS3 属性。

该`inline-block`元素具有内联项的属性，但可以具有固定的宽度或 / 和高度。

If `li`is `display: inline-block`and ul is`text-align: center`我认为这行得通。

:)

# xcode - 我可以在 XCode 中使用 pkg-config 命令吗？

> ID：13484232
> 
> 赞同：3
> 
> 时间：2012-11-20T23:51:37.923
> 
> 标签：xcode, linker, pkg-config

我曾经有一个这样的编译行：

```
g++ opencv_test.cpp `pkg-config --cflags opencv` `pkg-config --libs opencv` 
```

但是在 XCode 中，我必须设置包含路径、库路径和我想要链接的具体 .dylib。如果我更改库版本，我必须手动重新填充所有 .dylib。一旦我可以使用`pkg-config`.

那么您知道任何方式`pkg-config`（或一些适当的替代方案）可以与 XCode 项目一起使用吗？

# mysql - 获取mysql行版本号？

> ID：13484233
> 
> 赞同：0
> 
> 时间：2012-11-20T23:51:49.323
> 
> 标签：mysql, sql, versioning, database-versioning

我有一个数据库，其中所有内容都使用`start_date`和`end_date`

我想要做的是动态获取一行的版本号。

因此，获取按 start_date 排序的具有特定 item_id 的所有行，然后给出 a`start_date`并将`end_date`其隔离为一行。我想要的是找出那一排的位置。

例如数据

```
id | item_id | start_date
1  | 1       | 01-31-2012
2  | 1       | 02-31-2012
3  | 2       | 02-31-2012
4  | 1       | 03-31-2012
5  | 2       | 05-31-2012
6  | 1       | 04-31-2012 
```

如果使用`select id from items where item_id = 2 and start_date = 05-31-2012`

会返回`5`，所以我想要的版本是`2`

如果使用`select id from items where item_id = 1 and start_date = 03-31-2012`

会返回`4`，所以我想要的版本是`3`

我能想到的唯一方法是选择所有带有 item_id 的行，然后遍历每个项目检查 start_date，如果它不是我想要的，将 version_number 增加 1。

有没有办法只用mysql？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T23:54:03.533

```
SELECT COUNT(*) version
FROM items
WHERE item_id = 2 AND start_date <= '2012-05-31' 
```

或`id <= 5`代替日期比较（假设`id`是唯一的并且单调增长）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T01:10:03.973

这个在 oracle 中工作..在内部选择查询中使用分析函数 row_number() 如下

```
select version from (select row_number() over ( partition by item_id  order by start_date ) version,item.* from item) where start_date ='05-31-2012' 
```

# ruby-on-rails-3 - Rails ActiveRecord，检查零

> ID：13484234
> 
> 赞同：0
> 
> 时间：2012-11-20T23:52:01.760
> 
> 标签：ruby-on-rails-3, activerecord

让`c`任何东西，（或零）是：

```
if !c.nil?
  true
else
  false
end 
```

一样

```
if c
  true
else
  false
end 
```

也是：

```
Model.where(:name => params[:foo]) 
```

与以下相同：

```
Model.where('name = ?', params[:foo]) 
```

来自 Java 背景，传递给 #where() 的哈希方法是否提供转义？使用其中一个有优势吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T02:01:17.963

在这两种情况下，是的，它们是相同的。另外，是的，哈希格式确实提供转义。它实际上会做更多的事情，这取决于是否`params[:foo]`是一个列表，它会在一个`=`和一个之间变化`in`（可能还有更多的事情）。

`to_sql`以后使用该方法，您可以轻松查看 AREL 语句生成的 SQL 。

`Model.where(:name => params[:foo]).to_sql`

通常，约定是在足够的情况下使用散列语法。它通常更容易阅读，尤其是当您有涉及多个模型的查询时。例如：

`Model.joins(:other_model).where(:name => params[:foo], :other_model => {:attr => params[:bar]})`

# knockout.js - sammyjs / knockoutjs 路由 - 获取 id

> ID：13484235
> 
> 赞同：0
> 
> 时间：2012-11-20T23:52:09.980
> 
> 标签：knockout.js, sammy.js

如果我使用这样的路由系统

```
this.get('#home', function() {
          self.goHome(); 

    });

this.get('#products', function() {
        self.goProducts();
    });
    this.get('#products/list/:productID', function() {

      self.goProductsList(productID);

    }); 
```

如何从 sammy 的 url 中获取产品 ID 以用于淘汰赛？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:58:28.727

好的，解决了

代码是

```
self.goProductsList(this.params.productID); 
```

# ember.js - ember.js 在视图或控制器的 transitionTo 中苦苦挣扎

> ID：13484238
> 
> 赞同：1
> 
> 时间：2012-11-20T23:52:34.563
> 
> 标签：ember.js

从控制器或视图调用路由的正确方法是什么。例如，我有一个有很多行的表。每行视图都有一个点击方法，应该调用路由器。它不起作用 我无法从控制器或视图导航应用程序。

这是一个例子：http: [//jsfiddle.net/arenoir/Cs938/](http://jsfiddle.net/arenoir/Cs938/)

```
App.TableView = Ember.CollectionView.extend({
  tagName: 'table',
  contentBinding: 'controller.rows',
  itemViewClass: Ember.View.extend({
    tagName: 'tr',
    template: Ember.Handlebars.compile("<td>{{view.content.name}}"),
    click: function(){
      var router, tab;
      router = this.get('controller.target.router');
      tab = this.get('content.id');
      router.goTab(tab);
    }
  })
}); 
```

以下帖子很有帮助。[EmberJS：如何从控制器的动作过渡到路由器](https://stackoverflow.com/questions/11552417/emberjs-how-to-transition-to-a-router-from-a-controllers-action)。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T09:12:51.530

在您看来，这就是转换逻辑的当前实现：

```
 click: function(){
          var router, tab;
          router = this.get('controller.target.router');
          tab = this.get('content.id');
          router.goTab(tab);
      } 
```

将其更改为此实现：

```
 click: function(){
      var router, tab;
      router = this.get('controller.target.router');
      tab = this.get('content.id');
      router.transitionTo(tab);
  } 
```

这修复了小提琴。但是从您的示例中不清楚，为什么要在视图中触发转换。状态管理应该始终发生在路由器中。另一个尴尬的事情是您从 ApplicationController 获取行。为什么不使用 ArrayController。所以从我的角度来看，似乎有些东西放错了地方。

# jquery - Jquery 下拉选择框

> ID：13484243
> 
> 赞同：1
> 
> 时间：2012-11-20T23:53:17.463
> 
> 标签：jquery, html

我有一个非常简单的问题，如果我有相同下拉框的集合（行），我如何使用 Jquery 选择单个值？

[http://jsfiddle.net/Bw4cr/2/](http://jsfiddle.net/Bw4cr/2/)

正如我想返回（风筝）或（22）取决于我点击了哪个下拉菜单。

**> 查询**

```
$(document).on('change', 'select[name=options]', function() {
   var selectVal= $(this).siblings('select').val();
    alert(selectVal);
}); 
```

> **HTML**

```
<table>
<thead>
<th>Tie</th> <th>Pie</th><th>Lie</th>
</thead>

<tr>
<td><select class="Member" name="options">
    <option value="1">kite</option>
    <option value="2">flag</option>
    <option value="3">ball</option>
    <option value="4">road</option></td>
    <td>
    <select class="Member" name="options" price="200">
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option></td>

    <td>
    <select class="Member" name="options" price="200">
    <option value="1">11</option>
    <option value="2">22</option>
    <option value="3">33</option>
    <option value="4">44</option></td>

    </tr>

    </table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:59:36.400

如果您要获取**Text 内容**，请使用

```
$(this).find('option:selected').text(); 
```

如果要获取**当前值**

```
$(this).val(); 
```

**代码**

```
$(document).on('change', 'select[name=options]', function() {
    var selectVal= $(this).find('option:selected').text();
    alert(selectVal);
});​ 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/Bw4cr/7/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T23:59:48.383

只是改变 ：

```
var selectVal= $(this).siblings('select').val(); 
```

到

```
var selectVal= $(this).val(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T23:58:59.270

如果你想展示`value`房产，那么

```
$(document).on('change', 'select[name=options]', function() {
   var selectVal = $(this).val();
    alert(selectVal);
});​ 
```

如果您想在下拉列表中显示文本，那么 Sushants 的答案是合适的

小提琴 - [http://jsfiddle.net/Bw4cr/5/](http://jsfiddle.net/Bw4cr/5/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T00:03:11.420

您可以使用[map() 方法](http://api.jquery.com/map/)`<select>`从所有标签中获取一系列值，如下所示：

```
$(document).on('change', 'select[name=options]', function() {
    var selectVal= $(this).parent().siblings().andSelf().find('select').map(function() {
        return $(this).val();
    }).get();
    alert(selectVal);
    // alerts something like "2,1,1"
});​ 
```

[在这里](http://jsfiddle.net/greglockwood/EW3pT/)更新了 jsFiddle 。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-21T00:09:38.510

其他选择不是`siblings`更改后的选择，因为它们都在`td`标签内，所以使用：

```
$(document).on('change', 'select[name=options]', function() {
    var selectVal=$(this).parent().siblings('td').find('select').map(function() {
       return $(this).val();
    });
 //delete junk
    delete(selectVal.context);
    delete(selectVal.prevObject);
    console.log(selectVal);
});​ 
```

但这只会返回其他两个（不仅仅是更改的值），这可能不是您想要的，所以接下来的代码：

```
$(document).on('change', 'select[name=options]', function() {
//this will return array
    var selectVal=$(this).parents('tr').find('td > select').map(function() {
       //use here alert or whatever you want
       return $(this).val();
    });
    //delete junk
    delete(selectVal.context);
    delete(selectVal.prevObject);
    console.log(selectVal);
});​ 
```

我没有使用`andSelf()`，因为它会改变数组中值的顺序。

# php - Preg Grep 和反斜杠

> ID：13484247
> 
> 赞同：1
> 
> 时间：2012-11-20T23:53:44.293
> 
> 标签：php, regex, wordpress

我有两个数组：

```
$array_plugins  = array(
            array( 'captcha\/captcha.php', 'Captcha', 'http://wordpress.org/extend/plugins/captcha/', 'http://bestwebsoft.com/plugin/captcha-plugin/', '/wp-admin/plugin-install.php?tab=search&type=term&s=Captcha+bestwebsoft&plugin-search-input=Search+Plugins', 'admin.php?page=captcha.php' ), 
            array( 'contact-form-plugin\/contact_form.php', 'Contact Form', 'http://wordpress.org/extend/plugins/contact-form-plugin/', 'http://bestwebsoft.com/plugin/contact-form/', '/wp-admin/plugin-install.php?tab=search&type=term&s=Contact+Form+bestwebsoft&plugin-search-input=Search+Plugins', 'admin.php?page=contact_form.php' ), 
            array( 'facebook-button-plugin\/facebook-button-plugin.php', 'Facebook Like Button Plugin', 'http://wordpress.org/extend/plugins/facebook-button-plugin/', 'http://bestwebsoft.com/plugin/facebook-like-button-plugin/', '/wp-admin/plugin-install.php?tab=search&type=term&s=Facebook+Like+Button+Plugin+bestwebsoft&plugin-search-input=Search+Plugins', 'admin.php?page=facebook-button-plugin.php' ), 
            array( 'twitter-plugin\/twitter.php', 'Twitter Plugin', 'http://wordpress.org/extend/plugins/twitter-plugin/', 'http://bestwebsoft.com/plugin/twitter-plugin/', '/wp-admin/plugin-install.php?tab=search&type=term&s=Twitter+Plugin+bestwebsoft&plugin-search-input=Search+Plugins', 'admin.php?page=twitter.php' ), 
            array( 'portfolio\/portfolio.php', 'Portfolio', 'http://wordpress.org/extend/plugins/portfolio/', 'http://bestwebsoft.com/plugin/portfolio-plugin/', '/wp-admin/plugin-install.php?tab=search&type=term&s=Portfolio+bestwebsoft&plugin-search-input=Search+Plugins', '' ),
            array( 'gallery-plugin\/gallery-plugin.php', 'Gallery', 'http://wordpress.org/extend/plugins/gallery-plugin/', 'http://bestwebsoft.com/plugin/gallery-plugin/', '/wp-admin/plugin-install.php?tab=search&type=term&s=Gallery+Plugin+bestwebsoft&plugin-search-input=Search+Plugins', '' ),
            array( 'adsense-plugin\/adsense-plugin.php', 'Google AdSense Plugin', 'http://wordpress.org/extend/plugins/adsense-plugin/', 'http://bestwebsoft.com/plugin/google-adsense-plugin/', '/wp-admin/plugin-install.php?tab=search&type=term&s=Adsense+Plugin+bestwebsoft&plugin-search-input=Search+Plugins', 'admin.php?page=adsense-plugin.php' ),
            array( 'custom-search-plugin\/custom-search-plugin.php', 'Custom Search Plugin', 'http://wordpress.org/extend/plugins/custom-search-plugin/', 'http://bestwebsoft.com/plugin/custom-search-plugin/', '/wp-admin/plugin-install.php?tab=search&type=term&s=Custom+Search+plugin+bestwebsoft&plugin-search-input=Search+Plugins', 'admin.php?page=custom_search.php' ),
            array( 'quotes_and_tips\/quotes-and-tips.php', 'Quotes and Tips', 'http://wordpress.org/extend/plugins/quotes-and-tips/', 'http://bestwebsoft.com/plugin/quotes-and-tips/', '/wp-admin/plugin-install.php?tab=search&type=term&s=Quotes+and+Tips+bestwebsoft&plugin-search-input=Search+Plugins', 'admin.php?page=quotes-and-tips.php' )
        ); 
```

和

```
Array ( [0] => advanced-code-editor/advanced-code-editor.php [1] => bigarray.php [2] => jamie-social-icons/jamie-social_icons.php [3] => nowwhat.php [4] => twitter-plugin/twitter.php ) 
```

当我使用代码时...

```
foreach($array_plugins as $plugins) {
          if( 0 < count( preg_grep( "/".$plugins[0]."/", $active_plugins ) ) ) {
                echo "hit"; 
```

结果我得到了一个“打击”。为什么 preg_grep 认为`"twitter-plugin/twitter.php"`和`"twitter-plugin\/twitter.php"`是同一个字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T00:02:09.590

这是因为`\`具有特殊含义并用于转义元字符（请参阅[有关转义的 wiki 文章](http://en.wikipedia.org/wiki/Escape_character)）。例如，如果你想匹配`[`字面意思，你需要像这样转义它`\[`（如果你想匹配，`\`那么你也需要转义它 => `\\`）。对于非元字符，转义不会执行`\a`equals`a`和`\/`equals `\/`。

要在您的代码中解决此问题，只需替换

```
preg_grep( "/".$plugins[0]."/", $active_plugins ) 
```

和

```
preg_grep( "/". str_replace('\\', '\\\\', $pattern[0]) ."/", $active_plugins ) 
```

（这里的双倍`\\`也是由于逃避）。

# c++ - 多项式 ADT 类

> ID：13484248
> 
> 赞同：0
> 
> 时间：2012-11-20T23:53:50.413
> 
> 标签：c++

我无法理解在多项式类中使用高级 ADT。我得到的是

```
typedef struct term{
  double coef; 
  unsigned deg; 
  struct term * next;
}term_t;
typedef struct term * Term;
typedef struct term * Poly; 
```

所以说这是低级ADT，但我必须使用高级ADT，这意味着我必须上课。我开始做的是

```
class Polynomial{
private:
    typedef struct term{
        double coef;
        unsigned deg;
        struct term * next;
    }term_t;
    typedef struct term *Term;
    typedef struct term *Poly;
public:
    Polynomial(); //Constructor
    ~Polynomial(); //Destructor     
} 
```

我的问题是低估了从低级别到 ADT 到高级别 ADT 的变化。该函数是否应该是私有的，然后通过公共函数访问？这基本上像多项式链表多项式类吗？我的开始好吗？那么 term 和 poly 将是指向 coef 和 deg 的指针吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T00:14:28.020

ADT 是数据以及您可以对该数据执行的操作的集合。低级或“C”ADT 会将其实现为一组函数，这些函数接收某种数据**句柄**以及其他所需参数，并执行它们所代表的操作。

然而，在 C++ 中，事情变得更加简单，因为那些表示操作的函数可以通过类定义绑定到数据本身。

现在，在您的示例中，让我们考虑可以对多项式执行的那种运算；让我们尝试添加：

在 C 中，您将定义如下函数：

```
Poly poly_add (Poly p1, Polyp2)
{
/*addition code be here*/
} 
```

我们将如何在 C++ 中做到这一点？！好吧，我们希望方法绑定到对象，所以我们做这样的事情：

```
class Polynomial
{
  ....
public:
  Polynomial add(Polynomial& p2)
  {
    // addition code be here
  }
}; 
```

这将被称为这样`p3 = p1.add(p2)`。

因此，要回答您的问题，属于该类的全局方法可以直接在“低级”结构上运行，这就是您要放置该代码的位置。

您还应该注意`Poly`and`Term`不是指针，而是类型。它们都是指向结构的指针类型`term_t`。

自然有很大的改进空间（即我们可以使二元运算成为友元函数，甚至更好的重载运算符）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T00:07:20.203

考虑抽象数据类型的方法是，数据是由它的作用（它的签名）定义的，而不是由它组成的。所以真的，你的实现不会因为你使用了一个类而自动成为高级或低级；如果出现以下情况，则为高电平或低电平：

1.  用户无需费力地进行低级操作即可使用它。
2.  用户仅根据其接口（黑盒）使用该类。

在设计你的类时，你应该设身处地为一个不知道或想知道任何有关实现的用户着想。对于用户来说，类只是他们调用方法的东西，它可以完成工作。它是如何完成的是个谜。

让它成为你的指导原则。那么实现细节就是你用来实现它们的东西，因为它们不暴露给用户，所以它们与 ADT 没有任何关系。ADT 在界面中。

您可以应用的更具体的测试是尝试自己使用它，看看它的水平有多高。编写一个单独的程序来使用多项式，实例化类，使用它，然后问自己它是否足够高级。根据需要进行修改，直到获得正确的界面。

# java - if 语句多久执行一次？

> ID：13484251
> 
> 赞同：0
> 
> 时间：2012-11-20T23:54:09.810
> 
> 标签：java, if-statement, nested-loops

> **可能重复：**
> [根据 n 确定增加变量计数的语句执行的频率](https://stackoverflow.com/questions/13483512/determining-as-a-function-of-n-how-often-the-statement-incrementing-the-variable)

好的，所以我对分析算法还是陌生的，并且希望能在这方面分享任何帮助。我试图确定 if 语句作为 n 的函数执行的频率。我相信外循环是n，也认为内循环是n，但是if语句有问题。任何提示表示赞赏，谢谢。这是循环：

```
for (int k = 0; k < n.length;  k++) {

     for (int j = k; j > 0; j--) {

          if (n[j] < n[j-1]) {

            int x = n[j];
            n[j] = n[j-1];
            n[j-1] = x; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T23:57:10.383

如果我正在做这个家庭作业问题，我会从 n 的几个小数组开始（所以 n.length 很小），比如 3 或 4，然后手动完成它。你很快就会看到这种模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T08:20:48.887

这个例子可能会帮助你

```
int[] n = new int[] { 1, 2, 3, 4 };
int count =  0;
for (int k = 0; k < n.length; k++) {
    for (int j = k; j > 0; j--) {
        count++; // if program reaches here, the below 'if' condition will be executed
        if (n[j] < n[j - 1]) {
            int x = n[j];
            n[j] = n[j - 1];
            n[j - 1] = x;
        }
    }
}
System.out.println("If condition executed - "+count+" times."); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T08:33:32.357

上面两个答案都有点！

要获得明确的调用次数，请插入一个计数器并执行一些 println/printf-Debugging（或使用记录器）。

为了加深对这些循环的理解并计算复杂性，最好使用低 n 值进行手动迭代。

您应该按照上面的两个答案来全面了解您的作业！

# java - 调用表单基类引用时，扩展类中的 CDI 拦截器不起作用

> ID：13484258
> 
> 赞同：4
> 
> 时间：2012-11-20T23:54:47.380
> 
> 标签：java, jakarta-ee, cdi, interceptor, extends

我对 CDI 拦截器有疑问。在我的 EJB 模块中，我创建了拦截器注释及其实现，我还在 beans.xml 中添加了实现类。我有一个名为 AbstractFacade 的抽象类和一些从它派生的类。在一个类中，我重写了 create 方法并将我的拦截器注释添加到它。现在在 web 模块中，我有一个带有拦截器注释的 ejb bean 实例，但是对它的引用具有 AbstractFacade 类型。当我在这个引用上调用 create 方法时，会调用 ejb 模块中的适当方法（这个带有注释）但我的拦截器没有被调用，但是如果我将此引用转换为其真实类型并调用 create 拦截器将正常工作。我不确定我是否能很好地描述它，所以这里是代码：

FooInter.java

```
package foo;

import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;
import javax.interceptor.InterceptorBinding;

@InterceptorBinding
@Retention(RetentionPolicy.RUNTIME)
@Target({ElementType.TYPE, ElementType.METHOD})
public @interface FooInter{} 
```

FooInterImpl.java

```
package foo;

import javax.interceptor.AroundInvoke;
import javax.interceptor.Interceptor;
import javax.interceptor.InvocationContext;

@Interceptor
@FooInter
public class FooInterImpl {
    @AroundInvoke
    public Object fuckCall(InvocationContext context) throws Exception {
        System.out.println("Interceptor: it works");

        return context.proceed();
    }
} 
```

豆类.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://java.sun.com/xml/ns/javaee"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/beans_1_0.xsd">
    <interceptors>
        <class>foo.FooInterImpl</class>
    </interceptors>
</beans> 
```

AbstractFacade.java

```
public abstract class AbstractFacade<T> {

    //...

    public void create(T entity) {
        //...
    }
} 
```

FooFacade.java

```
@Stateless
public class FooFacade extends AbstractFacade<Foo> {

    //...

    @Override
    @FooInter
    public void create(Foo entity) {
        super.create(entity);
    }
} 
```

好的，这是在战争中：

编辑助手.java

```
public abstract class EditHelper<T> {
    protected T entity;

    //...

    protected abstract AbstractFacade<T> getFacade();

    public void save() {
        //...
        //if T is foo and getFacade returns FooFacade, interceptor won't be called here!
        getFacade().create(entity);
    }
} 
```

FooEditHelper.java

```
public class FooEditHelper extends EditHelper<Foo> {
    @EJB
    private FooFacade fooFacade;

    //...

    protected AbstractFacade<T> getFacade() {
        return fooFacade;
    }

    @Override
    public void save() {
        getFacade().create(entity); //interceptor won't works !!!!!!!!!!!
        ((FooFacade)getFacade()).create(entity); //but here interceptor will work
    }
} 
```

我不知道为什么 getFacade().create(entity); 不会发射拦截器。我会很高兴得到任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T07:53:10.223

我的回答可能有点离题，但我正在从 JSF 托管 bean 迁移到 CDI 托管 bean，我刚刚确认我能够在后代 CDI bean 中成功使用[super](http://docs.oracle.com/javase/tutorial/java/IandI/super.html) （使用“自定义”@后代限定符）“扩展”祖先 CDI bean（使用 @Default 限定符）。

带有 @Default 限定符的 CDI bean 祖先：

```
@Default
@Named("pf_pointOfContactController")
@SessionScoped
public class pf_PointOfContactController implements Serializable { 
```

祖先 bean 具有以下特性：

```
@PostConstruct
protected void init() { 
```

带有 @Descendant 限定符的 CDI bean 后代：

```
@Descendant
@Named("pf_orderCustomerPointOfContactController")
@SessionScoped
public class pf_OrderCustomerPointOfContactController extends pf_PointOfContactController { 
```

后代bean具有以下内容：

```
@PostConstruct
public void init(){
    super.init(); 
```

我必须添加/使用 super.init()，因为祖先 CDI bean 中的方法引发 NullPointerException，因为祖先 bean 的 @PostConstruct 没有在 CDI @Descendant bean 中执行。

我已经看到/听到/读到建议在使用 CDI 时使用 @PostConstruct 而不是 Constructor 方法，因此祖先 bean 的构造函数具有“初始化”逻辑，并且在使用 JSF 托管 bean 时会自动调用/执行祖先 bean 的构造函数。

# excel - excel vba msoShapeType 枚举项 - msoIgxGraphic - '未定义'

> ID：13484260
> 
> 赞同：2
> 
> 时间：2012-11-20T23:54:51.967
> 
> 标签：excel, ms-office, vba

以下子代码枚举了活动工作表的形状集合的有趣属性，但在包含时不会编译`Case msoIgxGraphic`。 *虽然我发誓它今天早些时候确实编译了。* 我正在使用 Excel 2007。[为 Office 2007 定义的 msoShapeType 枚举](http://msdn.microsoft.com/en-us/library/office/aa432678%28v=office.12%29.aspx)清楚地包含该值。

我检查并再次检查拼写错误 - 找不到。

我只将一个子添加到新创建的，否则为空的工作簿中的模块中。仍然不会编译。错误信息是：

```
'Compile Error: Variable not Defined' 
```

并`msoIgxGraphic`突出显示。从 select 语句中注释掉该节，它会编译并运行，没问题。我错过了什么？

```
 Option Explicit

    Sub GetShapeProperties()

        Dim sShapes As Shape, lLoop As Long
        Dim wsStart As Worksheet, WsNew As Worksheet
        Dim obj As OLEObject
        Dim obType As String

        ''''''''''''''''''''''''''''''''''''''''''''''''
        ''''''''''LIST PROPERTIES OF SHAPES'''''''''''''
        ''''''''''Dave Hawley www.ozgrid.com''''''''''''
        ''''''''''''''''''''''''''''''''''''''''''''''''

        Set wsStart = ActiveSheet
        Set WsNew = Sheets.Add

        If Len("Shapes Info") <> 0 Then
           Application.DisplayAlerts = False
           On Error Resume Next
           Worksheets("Shapes Info").Delete
           On Error GoTo 0
           Application.DisplayAlerts = True
           WsNew.Name = "Shapes Info"
        End If

        'Add headings for our lists. Expand as needed

        WsNew.Range("A1:X1") = _
         Array("Shape Name", ".OLEFormat.Object.Name", "Height", "Width", "Left", "Top" _
    , "AlternativeText" _
    , "Id" _
    , "Type" _
    , "Shape Type" _
    , "OLEFormat.Object.index" _
    , "OLEFormat.Object.Left" _
    , "OLEFormat.Object.Width" _
    , "OLEFormat.Object.Top" _
    , "OLEFormat.Object.Height" _
    , "OLEFormat.Object.TopLeftCell.Address" _
    , "OLEFormat.Object.BottomRightCell.Address" _
    , "OLEFormat.Object.ZOrder" _
    , "OLEFormat.Object.Locked" _
    , "OLEFormat.Object.Visible" _
    , "OnAction" _
    , "VerticalFlip" _
    , "ZOrderPosition")

        'Loop through all shapes on active sheet

        For Each sShapes In wsStart.Shapes

      'Increment Variable lLoop for row numbers

      lLoop = lLoop + 1

      With sShapes

          'Add shape properties

          WsNew.Cells(lLoop + 1, 1) = .Name
          WsNew.Cells(lLoop + 1, 2) = .OLEFormat.Object.Name
          WsNew.Cells(lLoop + 1, 3) = .Height
          WsNew.Cells(lLoop + 1, 4) = .Width
          WsNew.Cells(lLoop + 1, 5) = .Left
          WsNew.Cells(lLoop + 1, 6) = .Top
          'Follow the same pattern for more
          WsNew.Cells(lLoop + 1, 7) = .AlternativeText
          WsNew.Cells(lLoop + 1, 8) = .ID
          WsNew.Cells(lLoop + 1, 9) = .Type
          Select Case .Type
           Case msoAutoShape
            obType = "AutoShape"
           Case msoCallout
            obType = "Callout"
           Case msoCanvas
            obType = "Canvas"
           Case msoChart
            obType = "Chart"
           Case msoComment
            obType = "Comment"
           Case msoDiagram
            obType = "Diagram"
           Case msoEmbeddedOLEObject
            obType = "EmbeddedOLEObject"
           Case msoFormControl
             Select Case .FormsControlType
                Case xlButtonControl
                    obType = "FormsControlType Button"
                Case xlCheckBox
                    obType = "FormsControlType CheckBox"
                Case xlDropDown
                    obType = "FormsControlType DropDown"
                Case xlEditBox
                    obType = "FormsControlType EditBox"
                Case xlGroupBox
                    obType = "FormsControlType GroupBox"
                Case xlLabel
                    obType = "FormsControlType Label"
                Case xlListBox
                    obType = "FormsControlType ListBox"
                Case xlOptionButton
                    obType = "FormsControlType OptionButton"
                Case xlScrollBar
                    obType = "FormsControlType ScrollBar"
                Case xlSpinner
                    obType = "FormsControlType Spinner"
                Case Else
                    obType = "Unknown MsoFormsControlType"
              End Select
           Case msoFreeform
            obType = "Freeform"
           Case msoGroup
            obType = "Group"
           Case msoIgxGraphic
            obType = "IgxGraphic"
           Case msoInk
            obType = "Ink"
           Case msoInkComment
            obType = "InkComment"
           Case msoLine
            obType = "Line"
           Case msoLinkedOLEObject
            obType = "LinkedOLEObject"
           Case msoLinkedPicture
            obType = "LinkedPicture"
           Case msoMedia
            obType = "Media"
           Case msoOLEControlObject
            Set obj = .OLEFormat.Object
            obType = "OLEControlObject " + "(" + obj.Application.Name + "): " + TypeName(obj.Object)
           Case msoPicture
            obType = "Picture"
           Case msoPlaceholder
            obType = "Placeholder"
           Case msoScriptAnchor
            obType = "ScriptAnchor"
           Case msoShapeTypeMixed
            obType = "ShapeTypeMixed"
           Case msoTable
            obType = "Table"
           Case msoTextBox
            obType = "TextBox"
           Case msoTextEffect
            obType = "TextEffect"
           Case Else
            obType = "Unknown MsoShapeType"
        End Select
        WsNew.Cells(lLoop + 1, 10) = obType

        WsNew.Cells(lLoop + 1, 12) = .OLEFormat.Object.Index
          WsNew.Cells(lLoop + 1, 13) = .OLEFormat.Object.Left
          WsNew.Cells(lLoop + 1, 14) = .OLEFormat.Object.Width
          WsNew.Cells(lLoop + 1, 15) = .OLEFormat.Object.Top
          WsNew.Cells(lLoop + 1, 16) = .OLEFormat.Object.Height
          WsNew.Cells(lLoop + 1, 17) = .OLEFormat.Object.TopLeftCell.Address
          WsNew.Cells(lLoop + 1, 18) = .OLEFormat.Object.BottomRightCell.Address
          WsNew.Cells(lLoop + 1, 19) = .OLEFormat.Object.ZOrder
          WsNew.Cells(lLoop + 1, 20) = .OLEFormat.Object.Locked
          WsNew.Cells(lLoop + 1, 21) = .OLEFormat.Object.Visible
          WsNew.Cells(lLoop + 1, 22) = .OnAction
          WsNew.Cells(lLoop + 1, 24) = .VerticalFlip
          WsNew.Cells(lLoop + 1, 25) = .ZOrderPosition

      End With

      Next sShapes
      WsNew.Columns.AutoFit

    End Sub 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T01:23:31.700

当我使用对象浏览器查看`MsoShapeType`枚举时，它看起来像是`msoIgxGraphic`被替换为`msoSmartArt`.

我最好的猜测是这种变化是作为 Windows\Office 更新的一部分发生的。您知道在工作和失败之间是否应用了任何更新？

# jquery - 有没有更好的方法在fancybox2 中编写ajax 调用？

> ID：13484261
> 
> 赞同：1
> 
> 时间：2012-11-20T23:54:53.287
> 
> 标签：jquery, fancybox, fancybox-2

如果您查看我使用 2 个 fancybox 调用的代码。我这样做的原因是因为我只想要使用 ajax 获得的页面的一部分。该部分在 ajaxEventContent 类中。

如果可能的话，我想在一个电话中做到这一点。谢谢你。

```
$("#events .popUp").live('click' ,function(e){

    e.preventDefault();

    var link = $(this).attr('href');

    $.fancybox({

        'content' : '<div style="text-align:center"><img src="loading.gif" /></div>',
        'width'     : 680,
        'minWidth' : 680,
        'height'    : 'auto',
        'autoHeight' : true,
        'beforeLoad' : function(){

            $.ajax({
                url: link,
                success: function( data ) {
                    //get content with ajax
                    content = $(data).find('.ajaxEventContent');
                    $.fancybox({

                        'content': content,
                        'width': 680,
                        'height': 'auto'

                    });

                }
            });
         }
    });

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:46:04.623

实际上这似乎有效。除了你没有得到很好的 loading.gif 部分

```
$("#events .modal").on('click' ,function(e){

    e.preventDefault();

    var link = $(this).attr('href');

    $.ajax({
        url: link,
        success: function( data ) {
            //get content with ajax
            content = $(data).find('.ajaxEventContent');
            $.fancybox({

                content : content,
                width       : 680,
                helpers:  {
                    overlay : {
                        locked : false
                    }
                }

            });
        }
    });

}); 
```

# c# - 将 ICO 文件写入具有图标句柄的磁盘

> ID：13484263
> 
> 赞同：0
> 
> 时间：2012-11-20T23:55:25.403
> 
> 标签：c#, bitmap, png, imaging, ico

我们只是说在 C# 中有一个图标图像的句柄。有没有办法将内容保存为磁盘上的有效 ICO 文件？我已经尝试了一切，但没有运气。

我认为的第一个解决方案是基于图标句柄创建一个 Bitmap 对象，然后将此 Bitmap 保存为 ico 文件。问题是 .net 的实现不起作用，只输出纯 PNG 数据。

然后我尝试自己实现编码器。基于 ICO 容器的标头描述，我实现了这一点，并且工作起来就像一个魅力，但前提是我使用 png 数据作为有效负载。

如果我使用位图数据（这是想要的），输出文件不会被操作系统识别为有效的 .ico 文件。

我 99% 确定问题出在我将位图数据写入 ICO 容器的方式上。

根据一篇文章，我发现当 ico 文件中的格式为 PNG 图像时，它必须与 PNG 标头一起写入。如果它是位图图像，则必须只写入位图的原始数据而没有位图标题。

好吧，我尝试的是使用 Bitmap 对象的 Lockbits() 函数获取位图数据（作为字节数组）并写入 ico 标头之后的那些，然后保存文件。我确信我已经正确地编写了标题。但我认为我错过了一些东西，否则

将位图数据写入 ico 文件的正确方法是什么？另外，我想知道是否有另一种解决方案可以将 HICON（C# 中的 INtPtr）句柄的内容写入 ico 文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T00:17:14.653

`.ico`文件不是位图文件（一些程序将它们视为相同，但它们掩盖了用户的差异）。

`.ico`图标文件包含 ICO 标头，但也包含包含图标每个子图像的条目的“目录” 。然后每个子图像都是一个位图对象（带有 Win32 位图标头，*但没有 Win32 位图**文件标头***，是的，这很令人困惑）。

这里有一些开源代码演示`ico`了对 CodePlex 的处理：http: [//anolis.codeplex.com/SourceControl/changeset/view/69709#930335](http://anolis.codeplex.com/SourceControl/changeset/view/69709#930335)（查看`Save`方法）。

# c# - Visual Studio (2008) 调试停止向我显示 C# 异常发生的位置

> ID：13484266
> 
> 赞同：1
> 
> 时间：2012-11-20T23:55:40.747
> 
> 标签：c#, debugging, visual-studio-2008

我曾经得到异常，应用程序会停止，调试器会显示异常发生的位置。我已经添加了“使用 System.Diagnostics”和一些调试行。现在，我只是在“输出”窗口中收到一条消息“RethinkFilesystem.dll 中出现‘System.Exception’类型的第一次机会异常”或类似的东西，我的应用程序有点中断。我做了什么来改变这种行为？我怎么能回去？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:31:07.333

在调试器中打开抛出异常时停止。那是在 Visual Studio 中，转到 Debug->Exceptions 然后勾选 clr exceptions 旁边的框。

[Visual Studio：如何中断处理的异常？](https://stackoverflow.com/questions/116896/visual-studio-how-to-break-on-handled-exceptions)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T00:30:59.897

Debug > Exceptions... 下有一个选项，可让您控制已处理的未处理异常的行为。当任何列出的 .Net 异常被抛出时，检查公共语言运行时异常旁边的“抛出”将中断调试器，无论它是否被处理。

# ruby-on-rails-3 - 使用设备时如何取消授权用户操作？

> ID：13484267
> 
> 赞同：0
> 
> 时间：2012-11-20T23:55:51.230
> 
> 标签：ruby-on-rails-3, devise, cancan

我在 Rails 3.1 应用程序上使用 Devise 和 Cancan gem。

我向用户添加了几个额外的列。

我设法定义了这些能力并且它们工作正常，我可以看到它工作但我还没有弄清楚如何取消授权操作（例如：更新），因为我无权访问设计或用户控制器？

那是怎么工作的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T01:00:12.650

向用户添加一个字段，比如说`:approved`并使其只有管理员可以访问。

在您的 中编写一个过滤器`ApplicationsController`，因为您将所有内容都保持干燥，一旦您开始使用授权，您将大量使用它。

```
def verify_approval
  unless current_user.approved
    flash[:error] = I18n.t("not_approved")
    redirect_to(root_path)
  end 
end 
```

然后在用户需要权限的地方使用该过滤器：

```
class RandomsController
  before_filter :verify_approval, only: [:update] 
```

巴姆，完成。没有编辑设备或`UsersController`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T01:21:07.153

或者，尝试在能力.rb 中使用以下内容

```
 if user.role? :admin
  can [:create, :read], [Model1, Model2]
 end

 if user.role? :user
  can [:read], Model1, :id => user.id
 end 
```

这将允许管理员创建或阅读但不能更新。并允许用户读取属于他们的 Model1。如果您创建自定义操作，例如“copy_model”，您可以将其添加到 ability.rb

```
 ...
 can [:copy_model, :read], Model1, :id => user.id
 ... 
```

# iphone - 如何在自定义大小的 MonoTouch 对话框中修复使用 EntryElement 的滚动？

> ID：13484280
> 
> 赞同：3
> 
> 时间：2012-11-20T23:57:33.320
> 
> 标签：iphone, uitableview, uiviewcontroller, xamarin.ios, monotouch.dialog

我做了与[这个](https://stackoverflow.com/questions/10644260/how-can-i-add-a-dialog-view-controller-as-a-subview-to-a-uiview-or-vice-versa)问题非常相似的事情。我创建了一个 MonoTouch DialogViewController，其中有一堆 EntryElements，用于捕获用户注册的信息。然后我将此 DialogViewController 添加到另一个 UIViewController 中：

```
 registerDialog = new RegisterDialog (); // the dvc
            registerDialog.View.Frame = new RectangleF (0, 60, 320, View.Frame.Height - 60);
            registerDialog.TableView.BackgroundView = null; // make the background transparent
            Add (registerDialog.View); 
```

当用户单击 EntryElement 时，问题就出现了。键盘出现了，前几个 EntryElements 一切都很好，因为键盘没有隐藏任何东西。当您通过 EntryElements 时，DialogViewController 不再滚动键盘上方的元素。基本上 DialogViewController 的滚动中断。

这是由于将 DialogViewController 的视图添加到另一个视图中造成的。当将 DialogViewController 正常推送到 UINavigationController 时，它可以完美运行：

```
NavigationController.PushViewController (new LoginScreen (), true); 
```

这是一个错误还是我可以覆盖某些东西来修复滚动？

## 编辑

屏幕截图 1：带有一些 EntryElements 的 DialogViewController。我已经向下滚动到底部 - 姓氏上方有更多的 EntryElements。

![在此处输入图像描述](../Images/1950025681814852ed2500890927b810.png)

屏幕截图 2：当我点击 Email EntryElement 时会发生什么。您可以非常清楚地看到 DVC 没有向上滚动表格视图，而它通常会这样做。

![在此处输入图像描述](../Images/3e48b94daed624fd2cac623264723b09.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-15T16:18:40.860

您可以尝试继承 DialogViewController 类，而不是将 DialogViewController 视图添加到另一个视图中。如果你这样做，问题就会消失。我不知道这是否是一种好方法，但我在生产中成功使用它。这是我通常的做法，注意 RootElement 在基本构造函数中最初是空的，但我们在 ViewDidLoad 中添加了内容。

```
public class MyController : DialogViewController
{
    public MyController() : base(new RootElement(""), true)
    {
    }

    public override void ViewDidLoad() 
    {
        var section1 = new Section("Credentials") 
        {
            new EntryElement("Username", null, null),
            new EntryElement("Password", null, null)
        };

        Root.Add(section1);
       // additional initialization here
    }
} 
```

此外，如果您想在表单上方或下方添加内容，可以将页眉和页脚添加到部分 - Section 类的 HeaderView 和 FooterView 属性。

# c# - 换行符不计为字符串长度的 2 个字符

> ID：13484282
> 
> 赞同：5
> 
> 时间：2012-11-20T23:57:59.583
> 
> 标签：c#

我想知道为什么在 C# 中确定字符串的长度时 \n 不计为 2 个字符

EX: 这是一条测试评论\n示例文本 test 123456\nadssssssssss\n\nasdasdasda\nasdadadadad\nasadad\nasada\n\n\n最后一段\n12345\nTest

上面的字符串包含 136 个字符，但是 String 对象的 Length 属性我将字符串存储在 counts\n 中作为 1 个字符，并将字符串报告为 124 个字符长。

我想根据预先计算的开始和长度标记提取子字符串。创建标记时将 \n 计为两个字符。我怎么能在 C# 中执行以下操作

```
select SUBSTRING('This is a test comment\nSample text test 123456\nadssssssssss\n\nasdasdasda\nasdadadadad\nasadad\nasada\n\n\nLast paragraph\n12345\nTest',1,136); 
```

我不能使用子字符串，因为我的长度偏移量 136 超出了字符串的 c# 表示形式的边界。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-21T00:02:03.700

`String.Length` *确实*包括换行符：

```
string test = "1234\n6789\n\nC";

Console.WriteLine(test);
Console.WriteLine("Length: {0}", test.Length); 
```

输出：

```
1234
6789

C    
Length: 12 
```

您可能缺少的`'\n'`是一个字符。它表示换行符 ( `LF`)。字符串文字中的反斜杠表示它是[**Escape Sequence**](http://msdn.microsoft.com/en-us/library/h21280bw.aspx)。

因此，即使*您*计算 136 个字符，`\n`它在编译时也会被单个换行符替换。

* * *

请注意，根据使用此字符串的位置，您可能需要考虑使用[`Environment.NewLine`](http://msdn.microsoft.com/en-us/library/system.environment.newline.aspx)而不是`\n`. Windows上*真正*的换行符是`"\r\n"`, 或`CR LF`. 虽然许多控件等会处理`\n`罚款，但文件和其他事情可能会发生`\r\n`。

```
string test = "Welcome to" + Environment.NewLine + "StackOverflow!"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T00:27:10.810

你不计算`'\'`它在那里告诉系统右边的字符是*“特殊”*的东西。在您的情况下，它恰好是换行符`\n`。它也可能是一个 tab `\t`，回车`\r`......所以数学是正确的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T00:01:38.800

它不减去 \n 字符，它只是将一个换行符 \n 计为一个字符，这是正确的。

# c# - 保持 SignalR 连接处于活动状态的正确设置

> ID：13484284
> 
> 赞同：1
> 
> 时间：2012-11-20T23:58:02.543
> 
> 标签：c#, asp.net, signalr

我有一个使用 signalR 的页面，它也使用了 flash/html5。一段时间后，用户似乎“空闲”并断开连接，或者连接不再活跃，因为我无法接收消息。如果我想在浏览器打开的情况下保持连接，那么正确的配置是什么。我现在保持它活着的配置如下：

```
GlobalHost.Configuration.KeepAlive = TimeSpan.FromSeconds(60); 
```

使用 SignalR 0.5.3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:56:38.783

如果您更新到 1.0Alpha，这将在 99% 的时间内为您处理好。（通过[https://github.com/SignalR/SignalR/issues/469](https://github.com/SignalR/SignalR/issues/469)）。

# c# - 在 ASP.NET Membership 中设置 cookie

> ID：13484287
> 
> 赞同：0
> 
> 时间：2012-11-20T23:58:19.490
> 
> 标签：c#, asp.net, cookies

我在站点的任何地方都使用 ASP.NET 成员资格，例如日志记录、创建帐户等。如何设置它以使用 cookie。例如，一旦用户登录，用户就会使用 cookie 保持登录状态 2 小时。现在它似乎没有使用cookies。我是否在网页的 web.config 中设置了一些东西。我还如何指定 cookie 过期的时间？顺便说一下，asp.net 成员是否支持/集成 cookie？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:10:04.250

您是否使用表单身份验证？[http://msdn.microsoft.com/en-us/library/system.web.security.formsauthentication.setauthcookie(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/system.web.security.formsauthentication.setauthcookie(v=vs.90).aspx)

您使用的任何身份验证提供程序都负责设置 cookie（如果有）并确定登录会话何时到期。

对于 web.config 中的 asp.net Forms 身份验证：

```
<authentication mode="Forms">
  <forms loginUrl="~/Account/Login" timeout="2880" />
</authentication> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T00:18:59.053

如果您使用标准的 asp.net 登录控件，则将该`DisplayRememberMe`属性设置为 true：

```
<asp:Login DisplayRememberMe="True|False" /> 
```

[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.login.displayrememberme(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.login.displayrememberme(v=vs.100).aspx)

如果您使用的是自定义登录页面，那么您在验证用户身份后我认为您可以调用

```
SetAuthCookie(
    string userName,
    bool createPersistentCookie) 
```

[http://msdn.microsoft.com/en-us/library/twk5762b(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/twk5762b(v=vs.90).aspx)

要设置超时，您可以使用 web.config 文件：

```
 <authentication mode="Forms">
     <forms cookieless="UseCookies" timeout="525600" />
 </authentication> 
```

# html - 如何使用 CSS3 限制输入文本长度？

> ID：13484291
> 
> 赞同：8
> 
> 时间：2012-11-20T23:58:32.987
> 
> 标签：html, css, input

> **可能重复：**
> [我可以在 css 中指定 maxlength 吗？](https://stackoverflow.com/questions/1363030/can-i-specify-maxlength-in-css)

在我的 CSS 中，我使用此代码为我网站中的所有输入标签制作圆形边框。我想知道是否可以以相同的方式限制输入的长度（例如 50 个字符）

```
input  
{ 
border-radius: 10px;
-moz-border-radius: 10px;
-khtml-border-radius: 10px;
-webkit-border-radius: 10px;
} 
```

我想像（这不起作用）：

```
input
{
max-lenght: 50;
} 
```

有什么建议吗？非常感谢你！

编辑：这个问题是关于用户可以在字段中写入多少个字符，而不是输入的可见大小

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-21T05:51:23.653

您不能使用 CSS 来限制输入字符的数量。那将是一个功能限制，而 CSS 处理表示。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-11-21T00:01:17.917

我会处理 html 输入字段中的字符限制。例如

```
<input type="text" id="textbox" name="textbox" maxlength="50" /> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T00:39:32.757

更新：

您只能使用 Jquery。

```
$(document).ready(function () {
    $("input").attr('maxlength', '5');    
}); 
```

* * *

如果你真的想要一个自动方法，你可以使用 css 和 javascript 的组合。

Javascript/JQuery

```
$(document).ready(function () {
    // Get all the elements with class inputMaxLength and add maxlength attribute to them
    $(".inputMaxLength").attr('maxlength', '5');    
}); 
```

CSS

```
.inputMaxLength
{

} 
```

HTML

```
<input type="text" id="textbox" class="inputMaxLength" name="textbox" /> 
```

有点hack，但有效。据我所知，没有唯一的 CSS 解决方案。

# c++ - ffmpeg内存增加

> ID：13484296
> 
> 赞同：-1
> 
> 时间：2012-11-20T23:59:03.730
> 
> 标签：c++, qt, memory, ffmpeg, ram

好吧，我正在使用 ffmpeg，当我执行它时，它会运行一个视频示例，嗯，内存开始增加，一个简单的小视频需要 800MB 的 RAM，而 Windows Media Player 只需要 50MB 来运行该文件，我不知道发生了什么，这是循环，问题来自这里（我认为......）

```
while(av_read_frame(formatContext,&framepacket)>= 0){
    pausecontrol.lock();

    if(framepacket.stream_index==gotVideoCodec){
        int framereaded;

        avcodec_decode_video2(videoCodecContext,videoFrame,&framereaded,&framepacket);

        if(framereaded){

            struct SwsContext *ctx = sws_getContext(videoCodecContext->width, videoCodecContext->height, videoCodecContext->pix_fmt, showinWidget->width(),
            showinWidget->height(), PIX_FMT_RGB24, SWS_BICUBIC, NULL, NULL, NULL);
            sws_scale(ctx,videoFrame->data,videoFrame->linesize,0,videoCodecContext->height,videoFrame->data,videoFrame->linesize);
            memset(&framecapsule,0,sizeof(QImage));
            framecapsule=QImage(showinWidget->width(),showinWidget->height(),QImage::Format_RGB888);
            for(int y=0;y<showinWidget->height();y++){
                memcpy(framecapsule.scanLine(y),videoFrame->data[0]+y*videoFrame->linesize[0],showinWidget->width()*3);
            }
            emit newFrameReady();
        }
    }
    if(framepacket.stream_index==gotAudioCodec){
        // Audio? Ok
    }
    pausecontrol.unlock();
    av_free_packet(&framepacket);
} 
```

哦，我也在使用 QT，但是 AVFrame-QImage 之间的转换不是问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T09:30:43.230

您必须创建`SwsContext`一次，而不是循环创建它。最后，您必须通过调用释放上下文`sws_freeContext`

```
struct SwsContext *ctx = sws_getContext(videoCodecContext->width, videoCodecContext->height, videoCodecContext->pix_fmt, showinWidget->width(),
 showinWidget->height(), PIX_FMT_RGB24, SWS_BICUBIC, NULL, NULL, NULL);

 while(av_read_frame(formatContext,&framepacket)>= 0)
 {
   /// .....
 }

sws_freeContext(ctx); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T19:42:39.973

谢谢，我已经解决了（感谢Satuon）....

问题是，我在变量“framecapsule”变量中创建新图像，memset 不起作用，所以最后创建的图像在内存中，失去了对它的所有控制......

A memory leak! Thanks you very much!

# c# - OleDB 连接到 Microsoft Access 数据文件的间歇性“超出系统资源”异常

> ID：13484298
> 
> 赞同：4
> 
> 时间：2012-11-20T23:59:34.593
> 
> 标签：c#, ms-access, oledb

运行我的代码时，我遇到了看似随机的“超出系统资源”异常。我的程序背后的想法是第三方软件不断将数据写入 Microsoft Access 数据库文件 (.res) -我的代码*大约每 30 秒*从该文件读取数据，对其进行一些操作，然后写入结果到我们的数据库。不幸的是，我无法更改第三方软件将数据写入文件的方式，我被 Access 数据文件所困扰。

此错误发生在运行通过 Click-Once 发布安装的 WinForms 程序的生产系统以及我的开发系统上的控制台测试程序中。即使运行返回单个整数的查询并且没有其他程序或线程接触位于我的本地磁盘上的文件，我也会遇到异常。

异常信息：

```
System.Data.OleDb.OleDbException (0x80004005): System resource exceeded.
   at System.Data.OleDb.OleDbCommand.ExecuteCommandTextErrorHandling(OleDbHResult hr)
   at System.Data.OleDb.OleDbCommand.ExecuteCommandTextForSingleResult(tagDBPARAMS dbParams, Object& executeResult)
   at System.Data.OleDb.OleDbCommand.ExecuteCommandText(Object& executeResult)
   at System.Data.OleDb.OleDbCommand.ExecuteCommand(CommandBehavior behavior, Object& executeResult)
   at System.Data.OleDb.OleDbCommand.ExecuteReaderInternal(CommandBehavior behavior, String method)
   at System.Data.OleDb.OleDbCommand.ExecuteScalar()
... 
```

重现问题的示例代码：

```
string connectionString = @"Provider = Microsoft.ACE.OLEDB.12.0; Data Source = C:\datafile.res";
string commandText = "SELECT MIN(Data_Point) FROM Channel_Normal_Table WHERE Test_ID = 1";

int connectionCounter = 0;            
object result;

while (true)
{                
    using (OleDbConnection connection = new OleDbConnection(connectionString))
    {
        connection.Open();
        connectionCounter++;

        using (OleDbCommand command = new OleDbCommand(commandText, connection))
        {
            result = command.ExecuteScalar();
        }

        connection.Close();
    }
} 
```

不幸的是，异常不是确定性的——我已经看到它发生在从第 4 次命令执行到第 6149 次在同一文件中使用相同代码的任何地方。它总是出现在 command.ExecuteScalar() 行上。如果此代码中存在资源泄漏，请帮我查找。

我已尝试安装[http://support.microsoft.com/kb/2760394](http://support.microsoft.com/kb/2760394)上的修补程序（并进行了所需的注册表更改），但它并没有解决问题。任何建议都将受到赞赏并积极追求。

这是在 Windows 7、C# 4.0（控制台和 WinForms）、4 GB RAM 上运行的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T01:46:34.170

在您的情况下，我会尝试几件事：

1.  由于数据库的用户只是应用程序，我会以独占模式打开数据库，这将有助于驱动程序摆脱管理锁定文件的开销（并且也应该加快对数据库的访问）。

```
// Share Mode=12 - exclusive mode (16 for multi-user)
string constr = @"Provider=Microsoft.ACE.OLEDB.12.0;" +
                 "Mode=12;Data Source = C:\datafile.res;user id=;password=;"; 
```

1.  在程序启动时打开到 Access 数据库的连接，并保持打开状态直到应用程序关闭。
    在紧密的循环中，锁文件问题会蔓延并导致各种难以调试的奇怪问题。
    只需在 Access 数据库中有一个包含一条记录的虚拟表，然后打开该表以读取记录，但保留对该连接的永久引用：

```
private OleDbCommand PermanentCommand;

void KeepLinkOpen() {
   if (PermanentCommand == null || 
       PermanentCommand.Connection == null || 
       PermanentCommand.Connection.State == System.Data.ConnectionState.Closed) {

     OleDbConnection conn = new OleDbConnection(connectionString);
     conn.Open();
     PermanentCommand = new OleDbCommand("SELECT * FROM DummyTable", conn);
     PermanentCommand.ExecuteReader(System.Data.CommandBehavior.Default);
  }    
}

void Disconnect() {
  if (PermanentCommand != null) {
      if (PermanentCommand.Connection != null) {
          PermanentCommand.Connection.Close();
      }
      PermanentCommand.Dispose();
      PermanentCommand = null;
  }
} 
```

# database - Grails 中的 Liquibase：“空结果集，预期为一行”

> ID：13484305
> 
> 赞同：4
> 
> 时间：2012-11-20T23:59:58.747
> 
> 标签：database, grails, migration, database-migration, liquibase

我对 Grails 域类进行了更改并运行

`grails db-gorm-diff 2012-11-20-domain-class-change.groovy --add`（显然那里有另一个名字）

并从 Liquibase 收到“更改锁定”错误：

`Error executing bootstraps: liquibase.exception.LockException: Could not acquire change log lock. Currently locked by computer-name.local […]`

因此（似乎很愚蠢）按照[处理 Autobase 插件类似问题的老化线程](http://grails.1312388.n4.nabble.com/How-migrate-with-Autobase-tp2231222p2231522.html)中的建议，我删除了更改日志锁定表中的行：

`mysql> delete from DATABASECHANGELOGLOCK;`

现在得到这个漂亮的 Liquibase 错误：

`Error executing bootstraps: liquibase.exception.DatabaseException: Empty result set, expected one row`

这清楚地告诉我，改变这一点为时已晚，我不应该从表中删除该行。

我现在能做些什么呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T00:16:05.940

插件中有一个脚本 - 使用[http://grails-plugins.github.com/grails-database-migration/docs/manual/ref/Maintenance%20Scripts/dbm-release-locks.html](http://grails-plugins.github.com/grails-database-migration/docs/manual/ref/Maintenance%20Scripts/dbm-release-locks.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T00:11:51.380

我在与 Liquibase 相关的一般地方挖掘了更多内容，现在了解到我可以简单地完全[删除表格](http://forum.liquibase.org/topic/message-regarding-an-empty-result-set-for-databasechangeloglock)并在启动时重新创建它。这似乎奏效了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-18T18:20:13.953

查看[http://forum.liquibase.org/topic/message-regarding-an-empty-result-set-for-databasechangeloglock](http://forum.liquibase.org/topic/message-regarding-an-empty-result-set-for-databasechangeloglock)。您只需将 'locked' 行设置为 1 或完全删除 databasechangelock 表（然后将重新创建）

# php - 修改我的调度员

> ID：13484306
> 
> 赞同：0
> 
> 时间：2012-11-21T00:00:04.150
> 
> 标签：php, routes, dispatcher

我正在修改我的调度程序以利用命名空间。

我的自动加载器非常标准，看起来像这样：

```
$paths = array(
get_include_path(),
ROOT . DS . 'library'  . DS . 'intranet'  . DS  . 'classes',
ROOT . DS . 'application',
);

set_include_path(join(PATH_SEPARATOR, $paths));
spl_autoload_register(); 
```

我的路由器有点乱，但到目前为止，

```
$url = explode('/', trim($_SERVER['REQUEST_URI'], '/'));

    $controller = !empty($url[0])  ? 'controller\\'.$url[0]  : 'controller\\home';
    $method = !empty($url[1]) ? $url[1] : 'index';
    $params = !empty($url[2]) ? $url[2] : $_POST;

    if (class_exists($controller)){

        $dispatchedController = "new $controller()";

        if (! method_exists($controller, $method)){
            trigger_error("{$controller}::{$method}() Method does not exist!");
            $error = new ErrorHandler();
            $error->invalidDispatch(debug_backtrace(),$controller, $method);
            return;
        }

        return $dispatchedController::$method;

    } else{
        trigger_error("{$controller}::{$method}({$params}) Method does not exist!");
        $error = new ErrorHandler();
        $error->invalidDispatch(debug_backtrace(), $controller, $method);
        return;
    }
} 
```

但是，它一直失败`return $dispatchedController::$method;`

让我们以类文件为例`home`：

命名空间控制器；

```
class home
{
    public function index(){

    echo "cool!";
    }
} 
```

我遇到了错误：`Fatal error: Class 'new controller\home()' not found in /public/library/intranet/classes/router.php on line 30`

如何修改调度程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T00:03:06.023

您需要通过将代码更改为来创建控制器对象

```
$dispatchedController = new $controller; 
```

然后您可以将该方法作为可调用返回，也许与

```
return array($dispatchedController, $method); 
```

然后可以调用

```
call_user_func($returnedValue); // and also with call_user_func_array 
```

# ruby-on-rails - 我在前端使用 JS 在 Ruby on Rails 中制作注册表单。我收到以下错误

> ID：13484307
> 
> 赞同：0
> 
> 时间：2012-11-21T00:00:18.003
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2

我不是在寻找 Rails 使用 form_for 或类似的东西处理表单提交的解决方案。

***这是我的错误：***

```
Started POST "/users" for 127.0.0.1 at 2012-11-20 17:55:31 -0600
Processing by UsersController#create as JSON
  Parameters: {"name"=>"Name", "email"=>"name@email.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}
   (0.1ms)  begin transaction
  User Exists (0.2ms)  SELECT 1 AS one FROM "users" WHERE "users"."email" IS NULL LIMIT 1
   (0.1ms)  rollback transaction
  Rendered users/_signup_js.html.erb (0.0ms)
  Rendered users/new.html.erb within layouts/application (1.3ms)
Completed 200 OK in 147ms (Views: 15.9ms | ActiveRecord: 37.5ms) 
```

***这是我的 _signup_js 部分：***

```
<script type="text/javascript">
$(document).ready(function(){
  $("#signup-button").click(function(){
    var name = $("#name").val(),
        email = $("#email").val(),
        password = $("#password").val(),
        password_confirmation = $("#password-confirmation").val();

    $.ajax({
        type: 'POST',
        url: '/users',
        data: {
            name: name,
            email: email,
            password: password,
            password_confirmation: password_confirmation
        },
        dataType: 'json'
    });
  });
});
</script> 
```

***这是我的用户控制器：***

```
class UsersController < ApplicationController
  def new
  end
  def create
    @user = User.new(params[:user])
    print @user
    if @user.save
      redirect_to @user
      puts "========="
      print @user 
      puts "========="
    else
      puts "not working"
      render 'new'
    end
  end

  def show
    @user = User.find(params[:id])
  end
  def index
    @users = User.all
  end
end 
```

***这是我的用户模型：***

```
# == Schema Information
#
# Table name: users
#
#  id              :integer          not null, primary key
#  name            :string(255)
#  email           :string(255)
#  created_at      :datetime         not null
#  updated_at      :datetime         not null
#  password_digest :string(255)
#

class User < ActiveRecord::Base
  attr_accessible :email, :name, :password, :password_confirmation
  has_secure_password

  VALID_EMAIL_REGEX = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i

  validates :name, presence: true, length: {maximum: 25}
  validates :email, presence: true,format: {with: VALID_EMAIL_REGEX}, uniqueness: {case_sensitive: false}
  validates :password, presence: true, length: {minimum: 6}
  validates :password_confirmation, presence: true
end 
```

***这些是我在 config/routes.rb 中的路线：***

```
 resources :users

  root to: 'static_pages#home'

  match '/home',    to: 'static_pages#home'
  match '/about',   to: 'static_pages#about'
  match '/contact', to: 'static_pages#contact'

  match '/signup', to: 'users#new' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T02:36:49.660

听起来您的`@user`记录无效-查看`@user.errors`条件的 else 中的内容。

# c++ - 解析分配给默认参数值的重载函数时考虑了哪些函数集？

> ID：13484308
> 
> 赞同：13
> 
> 时间：2012-11-21T00:00:26.500
> 
> 标签：c++, overloading

考虑下面的函数`bar`，其参数具有从调用重载初始化的默认值`foo`：

```
#include <iostream>

int foo(int x)
{
  std::cout << "foo(int)" << std::endl;
  return 0;
}

template<typename T>
void bar(T a, int x = foo(T(0))) {}

double foo(double x)
{
  std::cout << "foo(double)" << std::endl;
  return 0;
}

int main()
{
  bar<int>(1);
  bar<double>(1);
  return 0;
} 
```

我希望这个程序能够输出

```
foo(int)
foo(double) 
```

对应于'实例化`foo`时可见的 ' 的两个重载。`bar`

相反，当用 编译时`g++-4.6`，输出是

```
$ g++-4.6 -std=c++0x test.cpp; ./a.out 
foo(int)
foo(int) 
```

在实现与正常重载解决方案不同的默认参数值时是否考虑了重载集？ISO C++ 标准中是否描述了这种情况？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T00:57:05.097

该程序建议考虑的函数集遵循正常的重载解决规则：

```
#include <iostream>

struct type1 {};
struct type2 {};

int foo(type1 x)
{
  std::cout << "foo(type1)" << std::endl;
  return 0;
}

template<typename T>
void bar(int x = foo(T())) {}

int foo(type2 x)
{
  std::cout << "foo(type2)" << std::endl;
  return 0;
}

int main()
{
  bar<type1>();
  bar<type2>();
  return 0;
} 
```

使用 编译时`g++-4.6`，此程序输出：

```
$ g++ test_2.cpp ; ./a.out 
foo(type1)
foo(type2) 
```

换句话说，在实例化`foo`时通过 ADL 解析。`bar`

来自 OP 的代码的行为似乎是 ADL 不适用于诸如`int`and之类的原语`double`，因此唯一考虑的重载是在`foo`调用之前声明的重载。奇怪的 MSVC 行为似乎是非标准的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T00:45:23.807

以下是标准对此的说明。首先，在 8.3.6 [dcl.fct.default] 第 5 段中：

> ...默认参数中的名称已绑定，并且在默认参数出现的位置检查语义约束。函数模板和类模板的成员函数中的默认参数的名称查找和语义约束检查按照 14.7.1 中的描述执行。...

进一步在 14.7.1 [temp.inst] 第 12 段：

> 如果以需要使用默认参数的方式调用函数模板 f，则查找从属名称，检查语义约束，并且默认参数中使用的任何模板的实例化都与默认参数一样完成是函数模板特化中使用的初始值设定项，具有与当时使用的函数模板 f 相同的范围、相同的模板参数和相同的访问权限。这种分析称为默认参数实例化。然后将实例化的默认参数用作 f 的参数。

我不太确定这到底是什么意思。我可以在本文中看到这两种解释。万一这很重要，我认为 EDG 同意 gcc 和 clang。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T00:48:40.217

可能是因为你在模板后面声明&定义了重载函数“foo(double)”，所以它不知道它的存在。->结构化编程。我建议：

```
#include <iostream>

int foo(int x)
{
std::cout << "foo(int)" << std::endl;
  return 0;
}

double foo(double x)
{
std::cout << "foo(double)" << std::endl;
return 0;
}

template<typename T>
void bar(T a, int x = foo(T(0))) {}

int main()
{
bar<int>(1);
bar<double>(1);
return 0; 
} 
```

# ruby-on-rails - 如何使用带有嵌套模型的 simple_form 显示错误

> ID：13484314
> 
> 赞同：1
> 
> 时间：2012-11-21T00:01:29.617
> 
> 标签：ruby-on-rails, simple-form

我有...

**/config/routes.rb：**

```
Testivate::Application.routes.draw do
  resources :areas do
    resources :heuristics    
  end
end 
```

**/app/models/heuristic.rb：**

```
class Heuristic < ActiveRecord::Base
  attr_accessible :area_id, :blueprint_url
  belongs_to :area
  validates :blueprint_url, :presence => {:message => "Please type the blueprint's internet address"}
end 
```

**/app/models/area.rb：**

```
class Area < ActiveRecord::Base
  has_many :heuristics
end 
```

**/app/controllers/heuristics_controller.rb：**

```
class HeuristicsController < ApplicationController
  def edit
    @area = Area.find(params[:area_id])
    @heuristic = Heuristic.find(params[:id])
  end
 def update
  @heuristic = Heuristic.find(params[:id])
  @area = Area.find(params[:area_id])
  respond_to do |format|
    if @heuristic.update_attributes(params[:heuristic])
      format.html { redirect_to areas_path, notice: 'Heuristic was successfully updated.' }
      format.json { head :no_content }
    else
      format.html { redirect_to edit_area_heuristic_path(@area, @heuristic) }
      format.json { render json: @heuristic.errors, status: :unprocessable_entity }
    end
  end
 end
end 
```

**/app/views/heuristics/new.html.haml：**

```
%h1 New heuristic
= render 'form'
= link_to 'Back', area_heuristics_path(@area) 
```

**/app/views/heuristics/_form.html.haml：**

```
= simple_form_for [@area, @heuristic] do |f|
  = f.error_notification
  = f.input :blueprint_url
  = f.button :submit 
```

正如预期的那样，该应用程序不会让我使用空的 :blueprint_url 保存更新。

但是，没有出现错误通知，我认为这是因为 simple_form 不知道是否为 @area 或 @heuristic 或其他内容显示错误。

如何让它显示我的错误？

rdoc 说您可以将选项传递给 error_notifications，但它没有说明在这种情况下要传递什么选项。

[http://rubydoc.info/github/plataformatec/simple_form/master/SimpleForm/FormBuilder:error_notification](http://rubydoc.info/github/plataformatec/simple_form/master/SimpleForm/FormBuilder%3aerror_notification)

谢谢，

史蒂文。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T01:56:49.480

显示错误的方式是在更新失败时呈现模板，而不是重定向。当您重定向时，您将丢失所有错误状态。

```
def update
  @heuristic = Heuristic.find(params[:id])
  @area = Area.find(params[:area_id])
  respond_to do |format|
    if @heuristic.update_attributes(params[:heuristic])
      format.html { redirect_to areas_path, notice: 'Heuristic was successfully updated.' }
      format.json { head :no_content }
    else
      format.html { render "edit" } # This is the thing that will get your error state
      format.json { render json: @heuristic.errors, status: :unprocessable_entity }
    end
  end
end 
```

# inputstream - 如何以最小的延迟扫描慢速 InputStream？

> ID：13484315
> 
> 赞同：0
> 
> 时间：2012-11-21T00:01:35.657
> 
> 标签：inputstream, java.util.scanner, java-io

这是一个模拟`InputStream`慢流的模拟：

```
class SlowInputStream extends InputStream{
    private String internal = "5 6\nNext Line\n";
    private int position = 0;

    @Override
    public int available(){
        if(position==internal.length()) return 0;
        else return 1;
    }

    @Override
    public int read() throws IOException {
        try {
            Thread.sleep(1000);
        } catch (InterruptedException e) {
            throw new IOException("Sleep Interrupted");
        }
        if(position==internal.length()) return -1;
        return internal.charAt(position++);

    }

} 
```

这是测试代码：

```
 Scanner s = new Scanner(new SlowInputStream());

    int i=s.nextInt();
    System.out.println("i="+i);
    int j=s.nextInt();
    System.out.println("j="+j);
    s.nextLine();
    String line = s.nextLine();
    System.out.println("line="+line);

    s.close(); 
```

上述代码的行为是它会停止一段时间并打印三行。什么代码可以输出相同的东西，但在两行之间分割等待时间？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T08:46:18.300

您还需要覆盖 read(byte[], int, int) 。你最好扩展FilterInoutStream：这就是它的用途。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-29T01:54:53.203

如果 a`Scanner`是从 中创建的`InputStream`，它将尝试每次读取特定数量的数据，以提高性能。在我的机器中，数量是 4096 字节。这就是为什么在这个例子中它总是一直等到同时打印所有结果。

要绕过此缓存机制`Readable`，应使用接口而不是原始流。因为没有已知的实现可以这样做，所以必须实现自己的。（如果有人知道这样的事情，请告诉我）所以下面的代码可以完成这项工作：

```
Scanner s = new Scanner(new Readable(){

    private InputStream is = new SlowInputStream();

    public int read(CharBuffer arg0) throws IOException {
        int i = is.read();
        if(i>=0){
            arg0.append((char)i);
            return 1;
        } else return -1;
    }

});

int i=s.nextInt();
System.out.println("i="+i);
int j=s.nextInt();
System.out.println("j="+j);
s.nextLine();
String line = s.nextLine();
System.out.println("line="+line);

s.close(); 
```

编辑：上述解决方案有一些缺点。首先，它不会关闭内部输入流，因此存在泄漏。其次，它取决于字符集是单字节的。它不适用于多字节字符集（即 UTF-8）。为了解决这些问题，我们可以使用 a`ReadableByteChannel`代替：

```
Scanner s = new Scanner(new ReadableByteChannel(){

    private InputStream is = new SlowInputStream();
    boolean isopen = true;

    public int read(ByteBuffer arg0) throws IOException {
        int i = is.read();
        if(i>=0){
            arg0.put((byte)i);
            return 1;
        } else return -1;
    }

    public void close() throws IOException {
        isopen=false;
        is.close();
    }

    public boolean isOpen() {
        return isopen;
    }

}); 
```

编辑：感谢您的评论，我已经修复了文本中的错误，并对这个问题给出了更好的解释。

# javascript - 在for循环中从数组中获取随机项，然后从数组中删除

> ID：13484322
> 
> 赞同：0
> 
> 时间：2012-11-21T00:02:16.713
> 
> 标签：javascript, jquery, arrays, random, array-splice

我正在编写一个脚本，onload 会将一个类添加到 12 个 DIV 中的随机 4 个，然后从数组中删除 DIV 的 ID。

我有一个包含所有 12 个 DIV ID 的数组设置。

**有时当我重新加载页面时，4 个 DIV 具有该类，而其他时候只有 3 个 DIV 具有该类。**

有点坚持为什么会这样。**我注释掉了从数组代码中删除**，看看这是否是问题，但仍然是同样的问题。

这是我的代码：

```
//Randomize Which Shoes Are Positive And Negative
function randomizeShoes(){
    allGroundShoes = new Array('ground_black_1','ground_black_2','ground_brown_1','ground_brown_2','ground_clown_1','ground_clown_2','ground_disco_1','ground_disco_2','ground_moccasins_1','ground_moccasins_2','ground_red_1','ground_red_2');
    for(var i=0; i < 4; i++){
        randomAllGroundShoes = allGroundShoes[Math.floor(Math.random() * allGroundShoes.length)];
        $('#'+randomAllGroundShoes+'').addClass('shoeNegitive');
        //randomShoeID = allGroundShoes.indexOf('randomAllGroundShoes');
        //if(randomShoeID != -1){ allGroundShoes.splice(randomShoeID, 1); }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:36:45.833

当您删除找到的元素时，您传递的是字符串文字而不是变量名：

```
allGroundShoes.indexOf('randomAllGroundShoes'); 
```

由于没有 element `'randomAllGroundShoes'`，因此永远不会找到该元素，也不会从数组中删除任何元素。

它应该是：

```
allGroundShoes.indexOf(randomAllGroundShoes); 
```

但是，你不止一次地做同样的事情。你根本不需要检查`allGroundShoes.indexOf()`。您可以将随机数存储在变量中并再次引用它。但是，即使这也超出了您的需要。只需致电`splice()`以获取您的价值：

```
randomAllGroundShoes = allGroundShoes.splice(
    Math.floor(Math.random() * allGroundShoes.length), 1)[0];
$('#'+randomAllGroundShoes).addClass('shoeNegitive'); 
```

这样，您只需一步即可检索您的值并将其从数组中删除 - 无需额外查找。

[jsfiddle.net/kRNTg](http://jsfiddle.net/kRNTg/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T00:05:10.050

可能，相同的数字可能会生成两次。

在这种情况下，您必须有一个检查机制是否已使用该号码。

您可以做的是生成一个由 4 个唯一随机数组成的数组，并对其进行迭代以设置类。

```
var unqiue_arr = []
while(arr.length < 8){
  var randomnumber=Math.floor(Math.random()*12)
  var found=false;
  for(var i=0;i<3;i++){
    if(unqiue_arr[i]==randomnumber){found=true;break}
  }
  if(!found)unqiue_arr[unqiue_arr.length]=randomnumber;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T00:07:41.113

我相信您的删除代码是问题所在。尝试将最后两行注释掉的行更改为：

```
randomShoeID = allGroundShoes.indexOf(randomAllGroundShoes);
if(randomShoeID != -1){ allGroundShoes = allGroundShoes.splice(randomShoeID, 1); } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T00:35:36.700

带有注释行的代码存在以下问题，即当未删除项目时，它们可能会被随机选择两次或多次选中。

您注释掉的行有同样的问题。您确实搜索`allGroundShoes.indexOf('randomAllGroundShoes');`了数组中从未包含的（作为字符串而不是变量）。

请改用此代码：

```
function randomizeShoes(){
    allGroundShoes = ['ground_black_1','ground_black_2','ground_brown_1','ground_brown_2','ground_clown_1','ground_clown_2','ground_disco_1','ground_disco_2','ground_moccasins_1','ground_moccasins_2','ground_red_1','ground_red_2'];
    for (var i=0; i<4; i++){
        var randomShoeID = Math.floor(Math.random() * allGroundShoes.length);
        var randomAllGroundShoes = allGroundShoes[randomShoeID];
        $('#'+randomAllGroundShoes+'').addClass('shoeNegitive');
        allGroundShoes.splice(randomShoeID, 1);
    }
} 
```

无需搜索您已经知道的项目的索引，也无需检查，`-1`因为您知道该项目包含在您刚刚从中取出它的数组中。

# java - 返回给定参数类型的列表 - java

> ID：13484334
> 
> 赞同：5
> 
> 时间：2012-11-21T00:03:52.487
> 
> 标签：java, generics

我有以下方法

```
static <T> List<T> foo(List<T> arg) { 
```

我想创建一个相同类型的 List ，称之为`outcome`arg ，我最终会返回。例如，如果

```
ArrayList<Integer> arg = new ArrayList<Integer>(); 
```

我希望 foo 也返回一个`ArrayList<Integer>`。如果

```
LinkedList<Integer> arg = new LinkedList<Integer>(); 
```

然后我想让 foo 返回一个`LinkedList<Integer>`

我知道`List<T> outcome = new List<T>();`List 是抽象的，所以我知道这行不通，所以我想写什么来做我想做的事？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T00:18:14.243

你可以使用反射

```
List<T> list = (List<T>)arg.getClass().newInstance(); // throws 
```

您可以进一步限制您的方法签名

```
static<L extends List<?>> L foo(L arg) { ... }

LinkedList<Integer> x = foo( new ArrayList<Integer>() ); // doesn't compile 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T00:05:52.630

当你有一个特定的返回类型时，*你可以返回那个返回类型的任何子类*，所以你可以返回一个`ArrayList<T>`.

* * *

***编辑（1）***：如果您想返回`List`与您的参数相同类型的 a ，您可以使用`instanceof`：

```
static <T> List<T> foo(List<T> arg) {
    List<T> outcome = null;

    if (arg instanceof ArrayList)
        outcome = new ArrayList<T>();

    if (arg instanceof LinkedList)
        outcome = new LinkedList<T>();

    ...

    return outcome;
} 
```

`List` [您可以在此处](http://docs.oracle.com/javase/6/docs/api/java/util/List.html)找到实现的类的完整列表。

* * *

***编辑（2）***：这是另一个想法：

```
static <T, U extends List<T>> U foo(U arg) {
    U outcome = arg;    
    ... 
    return outcome;
} 
```

但是，您可能会破坏作为 传递的列表`arg`，但您应该能够传递副本。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-21T00:14:29.373

您可以尝试优秀的 Google guava 库。我认为 Lists 类有你需要的东西： [http ://docs.guava-libraries.googlecode.com/git-history/v13.0.1/javadoc/index.html](http://docs.guava-libraries.googlecode.com/git-history/v13.0.1/javadoc/index.html)

# arrays - Perl对数组中值的滑动窗口求和

> ID：13484336
> 
> 赞同：2
> 
> 时间：2012-11-21T00:04:00.833
> 
> 标签：arrays, perl, sum

我想从由第四列组织的制表符分隔的数据数组创建一个移动的总和窗口。为简单起见，我用 X 替换了不相关的字段，并添加了第一行中的标题：

```
ID-Counts    X      X     Start    X      X     Locations      XXXX
 X-5000     [X]    [X]     0      [X]    [X]      1           [X...]
 X-26       [X]    [X]     1      [X]    [X]      1           [X...]
 X-34       [X]    [X]     1      [X]    [X]      0           [X...]
 X-3        [X]    [X]     20     [X]    [X]      9           [X...]
 X-200      [X]    [X]     30     [X]    [X]      0           [X...]
 X-1        [X]    [X]     40     [X]    [X]      5           [X...] 
```

第一列包含一个数字 ID 并计算由连字符连接的该 ID。第四列包含我想用来对数据进行分组的所有起始站点。第七列包含我需要标准化计数的位置数。

我想为每一行求和的总价值是通过从 ID 中拆分计数并将它们除以位置数 + 1 来确定的（例如，第一行的值为 2500，第 2 行为 13，第 3 行34）。然后我想将这些计数/（位置 + 1）相加，对于在彼此相距 20 个单位内的第四列中具有值的每一行，从值 0-19 开始，然后是 1-20、2-21 等。例如，窗口 0（范围为 0-19 的四列值）将对第 1-3 行求和，窗口 1 将对第 2-4 行求和，窗口 2 将仅对第 4 行求和，依此类推。

我的理想输出将是两列：第一列有 20unit-window 的开头（0,1,2,...），第二列有每个窗口的总和（在上面的数据 2547、47.3 等）。

我制作了一个 perl 脚本，将数据过滤和组织成这种格式，并希望添加代码以跨 20 个单元窗口求和。作为 perl 新手，我将不胜感激任何帮助和解释。我熟悉跨列的拆分和算术函数，但我完全不知道如何跨数组中的移动窗口执行这些操作。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T00:30:30.163

看看下面的代码，看看它是否符合您的要求。可能会进行一些优化，但我基本上对当前开始上方 20 单位窗口内的所有开始进行了蛮力搜索。
肯

输出：

```
0-19:  2547.000000
1-20:  47.300000
20-39:  200.300000
30-49:  200.166667
40-59:  0.166667 
```

代码

```
use strict;
use warnings;

#  Hash indexed by Start
#  Each value contains the sum of all ( Counts/Locations+1 ) for
#     this Start value
my %sum;

while (<DATA>)
{
    #  ignore comments
    next if /^\s*#/;
    my ( $id_count,undef,undef,$start,undef,undef,$numLocations ) = 
       split ' ';
    my ($id,$count) = split '-',$id_count;
    $sum{$start} += $count / ( $numLocations + 1 );
}  

foreach my $start ( sort keys %sum )
{
   my $totalSum = 0;
   #  Could probably be optimized.
   foreach my $start2 ( $start .. $start+19 )
   {
      $totalSum += $sum{$start2} if defined($sum{$start2});      
   }
   printf "%d-%d:  %f\n", $start, $start+19, $totalSum;
}

__DATA__
#ID-Counts    X      X     Start    X      X     Locations      XXXX
 X-5000     [X]    [X]     0      [X]    [X]      1           [X...]
 X-26       [X]    [X]     1      [X]    [X]      1           [X...]
 X-34       [X]    [X]     1      [X]    [X]      0           [X...]
 X-3        [X]    [X]     20     [X]    [X]      9           [X...]
 X-200      [X]    [X]     30     [X]    [X]      0           [X...]
 X-1        [X]    [X]     40     [X]    [X]      5           [X...] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T02:45:54.260

我希望我能很好地理解你的问题。您如何看待这些实现？

解决方案 1：每次到达单元窗口 (20) 时写入输出文件。

```
#Assuming that you have an array of sums (@sums) and name of file ($filename)
my $window_no  = 20;
my $window_sum = 0;
my @window_nos = ();

for (my $i = 1; $i <= $#sums; $i++) {
    push (@window_nos, $i);
    if ( i % window_no == 0 ) {
        write_file($filename, join(',', @window_nos) . "\t" . $window_sum . "\n");
        $window_sum = 0;
        @window_nos = ();
    }
}

if (scalar @window_nos > 1) {
    write_file($filename, join(',', @window_nos) . "\t" . $window_sum) . "\n");
} 
```

解决方案 2：将值附加到标量变量并使用它向输出文件写入一次。

```
#Assuming that you have an array of sums (@sums) and name of file ($filename)
my $window_no     = 20;
my $window_sum    = 0;
my @window_nos    = ();
my $file_contents = '';

for (my $i = 1; $i <= $#sums; $i++) {
    push (@window_nos, $i);
    if (i % window_no == 0) {            
        $file_contents .= join(',', @window_nos) . "\t" . $window_sum . "\n";
        $window_sum = 0;
        @window_nos = ();
    }
}

if (scalar @window_nos > 1) {
    $file_contents .= join(',', @window_nos) . "\t" . $window_sum . "\n";
}

write_file($filename, $file_contents); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T16:25:27.850

这个怎么样？

```
#!/usr/bin/perl -Tw

use strict;
use warnings;
use Data::Dumper;

my %sum_for;

while ( my $line = <DATA> ) {

    if ( $line !~ m{\A [#] }xms ) {

        $line =~ s{\A \s* ( [^-]+ ) - }{$1 }xms;    # separate the ID

        my @columns = split /\s+/, $line;    # assumes no space in values

        my $count = $columns[1];
        my $start = $columns[4];
        my $locat = $columns[7] + 1;

        $sum_for{$start} += $count / $locat;
    }
}

print Dumper( \%sum_for );

my @start_ranges;
{
    my ($max_start) = sort { $b <=> $a } keys %sum_for;

    # max => range count
    #  10 => 1
    #  20 => 2
    #  30 => 2
    #  40 => 3
    #  50 => 3
    #  ...
    my $range_count = $max_start / 20;

    push @start_ranges, [ 0, 19 ];

    for ( 1 .. $range_count ) {

        push @start_ranges, [ map { $_ + 20 } @{ $start_ranges[-1] } ];
    }
}

my %total_for;

for my $range_ra (@start_ranges) {

    my $range_key = sprintf '%d-%d', @{$range_ra};

    for my $start ( $range_ra->[0] .. $range_ra->[1] ) {

        if ( exists $sum_for{$start} ) {

            $total_for{$range_key} += $sum_for{$start};
        }
    }
}

print Dumper( \%total_for );

__DATA__
#ID-Counts    X      X     Start    X      X     Locations      XXXX
 X-5000     [X]    [X]     0      [X]    [X]      1           [X...]
 X-26       [X]    [X]     1      [X]    [X]      1           [X...]
 X-34       [X]    [X]     1      [X]    [X]      0           [X...]
 X-3        [X]    [X]     20     [X]    [X]      9           [X...]
 X-200      [X]    [X]     30     [X]    [X]      0           [X...]
 X-1        [X]    [X]     40     [X]    [X]      5           [X...] 
```

输出如下：

```
$VAR1 = {
          '1' => 47,
          '40' => '0.166666666666667',
          '0' => 2500,
          '30' => 200,
          '20' => '0.3'
        };
$VAR1 = {
          '40-59' => '0.166666666666667',
          '20-39' => '200.3',
          '0-19' => 2547
        }; 
```

关于计算起始范围的部分需要一些思考。感谢您提出有趣的问题。

# c++ - 在头文件c ++中初始化引用

> ID：13484337
> 
> 赞同：0
> 
> 时间：2012-11-21T00:04:38.900
> 
> 标签：c++, reference, header

我试图让我的构造函数接收对对象的引用并将其存储在私有变量中。我无法让启动列表工作。这是头文件：

```
private:
  Game &game;

public:     
  Player(Game & g): game(g); 
```

使用启动列表是最好的方法吗？我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T00:09:08.877

构造函数初始化列表不仅仅是“最好”的方法。这是*唯一*的方法。

构造函数初始化列表是构造函数*定义*的一部分。这意味着一旦你开始指定初始化列表，你必须为你的构造函数提供完整的定义，包括主体

```
public:     
  Player(Game &g): game(g)
    {} 
```

如果您的构造函数没有其他事情可做，则主体将为空（如上例所示）。但是无论如何你都必须指定正文。

# java - 如何在后台线程中使用 HttpPost 执行 MultipartEntity？

> ID：13484342
> 
> 赞同：0
> 
> 时间：2012-11-21T00:05:10.213
> 
> 标签：java, android

如何执行此代码以使其在后台线程中发送？

```
// TODO: Send image in background
            HttpClient httpclient = new DefaultHttpClient();
            HttpPost httppost = new HttpPost(urlString);

            try {
              MultipartEntity entity = new MultipartEntity(HttpMultipartMode.BROWSER_COMPATIBLE);
              entity.addPart("userfile", new FileBody(f));
              httppost.setEntity(entity);
              HttpResponse response = httpclient.execute(httppost);
              BufferedReader reader = new BufferedReader(new InputStreamReader(response.getEntity().getContent(), "UTF-8"));
              String sResponse;
              StringBuilder s = new StringBuilder();

              while ((sResponse = reader.readLine()) != null) {
                  s = s.append(sResponse); 
              }
              Log.d("Response", "Response: " + s);
            } 
            catch (ClientProtocolException e) {
            } 
            catch (IOException e) {
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T02:21:03.767

与您在后台线程中执行任何操作的方式相同——启动一个线程来执行此操作。在 Android 上，您可以使用`AsyncTask`在后台执行内容并在完成后更新 UI。

[http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

# php - 检查用户名是否被占用

> ID：13484343
> 
> 赞同：0
> 
> 时间：2012-11-21T00:05:20.700
> 
> 标签：php, mysql

我需要检查用户名是否被使用，如果是，它不会允许用户注册，它会将他们重定向到注册页面我应该在哪里添加脚本来检查用户名是否已经被使用？或者我在哪里可以得到一个脚本继承我的脚本我到目前为止。

```
 <?php

// Check if he wants to register:
if (!empty($_POST[username]))
{
// Check if passwords match.
if ($_POST[password] != $_POST[password2])
    exit("Error - Passwords don't match. Please go back and try again.");

// Assign some variables.
$date = time (" d - m - Y ");
$ip = $_SERVER[REMOTE_ADDR];

require_once("connect.php");

// Register him.
$query = mysql_query("INSERT INTO members 
(username, fname, email, password, date, ip)
VALUES      ('$_POST[username]','$_POST[fname]','$_POST[email]','$_POST[password]','$date','$ip')")
or die ("Error - Couldn't register user.");

echo "Welcome $_POST[username]! You've been successfully reigstered!<br />
    You Will Be Redirected To Our Home Page Where U Can Login ";
exit();
}

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T00:08:48.253

您需要先检查您的用户名是否存在：

```
SELECT count(1) FROM members WHERE username = '$_POST[username]' 
```

然后如果结果是 > 0 你会抛出一个`User already exists`错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T01:14:12.760

我对您的代码进行了一些更改，以使其正常工作并清理它。

```
<?php
// Check if he wants to register
// - Make sure that param exists
// - Check length 
if (isset($_POST['username']) && strlen($_POST['username']) > 0) {

    // Check if passwords match.
    // - Make sure that params exist
    // - Check length 
    // - Check matching
    if (!isset($_POST['password']) || 
        !isset($_POST['password2']) ||
        strlen($_POST['password']) === 0 || 
        $_POST['password'] !== $_POST['password2']) {
           die("Error - Passwords don't match. Please go back and try again.");
    }

    require_once("connect.php");

    // Set array of params
    $fields = array(
        'username' => $_POST['username'],
        'fname' => isset($_POST['fname']) ? $_POST['fname'] : '',
        'email' => isset($_POST['email']) ? $_POST['email'] : '',
        'password' => $_POST['password'],
        'date' => date("d-m-Y"),
        'ip' => $_SERVER[REMOTE_ADDR]
    );

    // Escape fields agains sql injection
    $fields = array_map('mysql_real_escape_string', $fields);

    // Check if member exists
    $exists = mysql_num_rows(mysql_query("SELECT * FROM members WHERE username='" . $fields['username'] . "'"));
    if ($exists === 0) {

        // Insert member in DB
        if (mysql_query("INSERT INTO `members` (`" . implode('`,`', array_keys($fields)) . "`) VALUES ('" . implode("','", array_values($fields)) . "')") !== false) {
            echo "Welcome" . $_POST['username'] . "! You've been successfully reigstered!<br />
            You Will Be Redirected To Our Home Page Where U Can Login ";
            exit();
        } else {
            die("Error - Couldn't register user.");
        }
    } else {
        die("Error - Member exists!");
    }
}
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T00:11:54.427

我更新了您的代码，我可能会检查是否使用了用户名。就像其他人所说的那样，阅读 sql 注入攻击并保护自己。

```
<?php

// Check if he wants to register:
if (!empty($_POST[username])) {
// Check if passwords match.
    if ($_POST[password] != $_POST[password2])
        exit("Error - Passwords don't match. Please go back and try again.");

// Assign some variables.
    $date = time(" d - m - Y ");
    $ip = $_SERVER[REMOTE_ADDR];

    require_once("connect.php");

    // CHEK IF USERNAME IS VALID
    if (someFunctionThatChecksIfUsernameIsTaken($_POST['username'])) {
        // Register him.
        $query = mysql_query("INSERT INTO members 
        (username, fname, email, password, date, ip)
        VALUES      ('$_POST[username]','$_POST[fname]','$_POST[email]','$_POST[password]','$date','$ip')")
                or die("Error - Couldn't register user.");

        echo "Welcome $_POST[username]! You've been successfully reigstered!<br />
        You Will Be Redirected To Our Home Page Where U Can Login ";
        exit();
    } else {
        // redirect him back to the page and tell the user that the username is taken
    }
}
?> 
```

# vb.net - 表格透明度

> ID：13484345
> 
> 赞同：2
> 
> 时间：2012-11-21T00:05:34.660
> 
> 标签：vb.net, winforms, transparency

我正在使用 Visual Basic 中的第一个应用程序，我正在使用 Visual Basic Studio...我创建了一个带有按钮的表单 - 表单有一个带圆角的背景图像，我无法将其颜色设置为“透明”，因为发生以下错误：

`Control does not support transparent background colors.`

现在我不知道该怎么办。我已经读到我可以通过添加以下行来设置代码的透明度：

```
SetStyle(ControlStyles.SupportsTransparentBackColor, True)
Me.BackColor = Color.Transparent 
```

但它似乎不起作用......那我还能做什么？

整个代码：

```
Public Class Form1

  Private Sub Button1_Click(ByVal sender As Object, ByVal e As EventArgs) Handles Button1.Click
    MsgBox("Test", 32, "Button Click")
  End Sub

  Private Sub Button2_Click(ByVal sender As Object, ByVal e As EventArgs) Handles Button2.Click
    Close()
  End Sub

  Private Sub Form1_Load(ByVal sender As Object, ByVal e As EventArgs) Handles MyBase.Load
    SetStyle(ControlStyles.SupportsTransparentBackColor, True)
    Me.BackColor = Color.Transparent
  End Sub

End Class 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T00:08:56.187

对于表格，试试这个：

```
Me.TransparencyKey = Me.BackColor 
```

由于您有背景图像，因此请确保选择图像中未找到的背景颜色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T05:23:15.053

只需更改表单的 Opacity 属性。

# python - 有没有一种简单的方法可以在 Deform 中将表单转换为模型，就像在带有 bind(model) 的 pyramid_simpleform 中一样？

> ID：13484349
> 
> 赞同：1
> 
> 时间：2012-11-21T00:06:06.697
> 
> 标签：python, pyramid, deform

pyramid_simpleform[说您可以使用 bind(model)](http://packages.python.org/pyramid_simpleform/)轻松地将表单的值转换为模型的值：

（以下来自[pyramid_simpleform](http://packages.python.org/pyramid_simpleform/)文档）

```
def add(self):
  form = Form(request,
              defaults={"name" : "..."},
              schema=MyModelSchema)

  if form.validate():
    obj = form.bind(MyModel())
    # persist model somewhere...
    return HTTPFound(location="/")

  return dict(renderer=FormRenderer(form)) 
```

[我在变形文档](http://docs.pylonsproject.org/projects/deform/en/latest/)中的任何地方都找不到等效的方法......或者有没有办法用变形来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T08:31:16.330

Deform 不支持直接将模式绑定到模型，但如果您使用 sqlalchemy [ColanderAlchemy](https://github.com/stefanofontanelli/ColanderAlchemy)就可以做到这一点。它从 sqlalchemy 模型生成滤锅模式（由变形使用）并将表单绑定到模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-04T17:58:42.670

这是我的 150 行答案，包括仅查看和编辑表单。对于最简单的用例来说，这可能是不必要的复杂，但需要一些时间才能让它为我工作。

```
class FormView:
    """A base class for views which utilize ColanderAlchemy to view/edit SQLAlchemy model instances."""

    #: If the child class is not overriding the rendering loop, point this to a template which provides the page frame and ``crud_content`` block.
    base_template = None

    #: List of SQLAlchemy and JSONProperty field names automatically mapped to a form
    includes = ["id",]

    def __init__(self, context, request):
        self.context = context
        self.request = request

    def create_form(self, buttons=()):
        """Automatically create a read-only collander schema + deform form based on the underlying SQLALchemy model.

        :param buttons: Passed to Deform as form buttons
        """
        obj = self.get_object()
        includes = self.includes
        schema = PropertyAwareSQLAlchemySchemaNode(obj.__class__, includes=includes)
        self.customize_schema(schema)
        schema = self.bind_schema(schema)
        form = deform.Form(schema, buttons=buttons)
        return form

    def bind_schema(self, schema):
        """Initialize Colander field dynamic default values. By default, don't do anything."""
        return schema

    def get_crud(self):
        """Get CRUD manager object for this view."""
        return self.context.__parent__

    def get_object(self):
        """Get underlying SQLAlchemy model instance from current Pyramid traversing context."""
        return self.context.get_object()

    def get_title(self):
        """Get human-readable title for for template page title."""
        return "#{}".format(self.get_object().id)

    def customize_schema(self, schema):
        """After Colander schema is automatically generated from the SQLAlchemy model, edit it in-place for fine-tuning.

        Override this in your view subclass for schema customizations.
        """
        return

class Show(FormView):
    """Read-only view to SQLAlchemy model instance using Deform form generated by ColanderAlchemy.
    """

    def get_title(self):
        return "#{}".format(self.get_object().id)

    @view_config(context=sqlalchemy.Resource, name="show", renderer="crud/show.html", permission='view')
    def show(self):
        """View for showing an individual object."""

        obj = self.context.get_object()
        base_template = self.base_template

        form = self.create_form()
        appstruct = form.schema.dictify(obj)
        rendered_form = form.render(appstruct, readonly=True)

        crud = self.get_crud()

        resource_buttons = dict(edit=self.request.resource_url(self.context, "edit"), delete=False)

        title = current_view_name = self.get_title()

        return dict(form=rendered_form, context=self.context, obj=obj, title=title, crud=crud, base_template=base_template, resource_buttons=resource_buttons)

class Edit(FormView):
    """Edit SQLAlchemy model instance using Deform form generated by ColanderAlchemy.
    """

    # We display id field on the edit form and it needs special handling, because it is read-only
    # See http://deformdemo.repoze.org/readonly_value_nonvalidation/
    includes = [
        colander.SchemaNode(colander.String(),
            name="id",
            missing=lambda node, kw: kw["obj"].id,
            widget=deform.widget.TextInputWidget(readonly=True),
        )
    ]

    def get_title(self):
        return "Editing #{}".format(self.get_object().id)

    def create_form(self):
        return super(Edit, self).create_form(buttons=("save", "cancel",))

    def bind_schema(self, schema):
        return schema.bind(obj=self.context.get_object())

    @view_config(context=sqlalchemy.Resource, name="edit", renderer="crud/edit.html", permission='edit')
    def edit(self):
        """View for showing an individual object."""

        # SQLAlchemy model instance
        obj = self.context.get_object()
        base_template = self.base_template

        # Create form, convert instance to Colander structure for Deform
        form = self.create_form()

        crud = self.get_crud()

        resource_buttons = dict(show=self.request.resource_url(self.context, "show"), delete=False)

        title = current_view_name = self.get_title()

        if "save" in self.request.POST:

            controls = self.request.POST.items()

            try:
                appstruct = form.validate(controls)

                # Cannot update id, as it is read-only
                del appstruct["id"]

                form.schema.objectify(appstruct, obj)

                # We do not need to explicitly call save() or commit() as we are using Zope transaction manager

                messages.add(self.request, kind="success", msg="Changes saved.")

                # Redirect back to view page after edit page has succeeded
                return HTTPFound(self.request.resource_url(self.context, "show"))

            except deform.ValidationFailure as e:
                # Whoops, bad things happened, render form with validation errors
                rendered_form = e.render()

        elif "cancel" in self.request.POST:
            # User pressed cancel
            return HTTPFound(self.request.resource_url(self.context, "show"))
        else:
            # Render initial form view with populated values
            appstruct = form.schema.dictify(obj)
            rendered_form = form.render(appstruct)

        return dict(form=rendered_form, context=self.context, obj=obj, title=title, crud=crud, base_template=base_template, resource_buttons=resource_buttons) 
```

# java - 在我的应用程序中查找所有 Jersey 资源方法的列表？

> ID：13484350
> 
> 赞同：9
> 
> 时间：2012-11-21T00:06:21.893
> 
> 标签：java, rest, reflection, jersey, jax-rs

Jersey 是否提供任何方法来列出它公开的所有资源？也就是说，给定资源类：

```
package com.zoo.resource

@Path("/animals")
public class AnimalResource {

    @GET
    @Produces(MediaType.APPLICATION_JSON)
    @Path("dog")
    public Dog getDog(){
    ...
    }

    @GET
    @Produces(MediaType.APPLICATION_JSON)
    @Path("cat")
    public Cat getCat(){
    ...
    }
} 
```

泽西岛是否为我提供了任何获取信息的方式：

*   `GET`在路径`/animals/dog`返回类型`Dog`
*   `GET`在路径`/animals/cat`返回类型`Cat`

（此外，它是否让我知道 AnimalResource 是一种资源？）

我想在单元测试中为我提供这些信息，以便我可以检查我公开的每个资源是否符合外部系统的期望。我知道有暴露[application.wadl](https://wikis.oracle.com/display/Jersey/WADL)的 automagic ，但我没有看到它显示返回类型，我不知道如何从我的测试中访问它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-21T00:43:09.943

[更新 - 示例是相同的，但我已经改写了我的警告]

可以办到。尝试以下操作：

```
import com.sun.jersey.api.model.AbstractResource;
import com.sun.jersey.api.model.AbstractSubResourceMethod;
import com.sun.jersey.server.impl.modelapi.annotation.IntrospectionModeller;

import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;

public class AnimalsTest
{
   public static void main(String [] args)
   {
      AbstractResource resource = IntrospectionModeller.createResource(AnimalResource.class);
      System.out.println("Path is " + resource.getPath().getValue());

      String uriPrefix = resource.getPath().getValue();
      for (AbstractSubResourceMethod srm :resource.getSubResourceMethods())
      {
         String uri = uriPrefix + "/" + srm.getPath().getValue();
         System.out.println(srm.getHttpMethod() + " at the path " + uri + " return " + srm.getReturnType().getName());
      }
   }
} 
```

```
class Dog {} 
```

```
class Cat {} 
```

```
@Path("/animals")
class AnimalResource {
    @GET
    @Produces(MediaType.APPLICATION_JSON)
    @Path("dog")
    public Dog getDog(){
      return null;
    }

    @GET
    @Produces(MediaType.APPLICATION_JSON)
    @Path("cat")
    public Cat getCat(){
       return null;
    }
} 
```

这些自省类在 jersey-server 中。

请注意，上面的示例使用了一些在包名称中包含“impl”的 Jersey 类，这表明这些 Jersey 类不适合公共消费，并且将来很可能会发生重大变化。我只是在这里猜测-我不是泽西岛的提交者。只是一个随机用户。

通过仔细阅读源代码，我发现了上面的所有内容。我从未见过任何关于内省 JAX-RS 注释类的批准方式的文档。我同意一个官方支持的 API 来做这种事情会非常有帮助。

# javascript - 如何让 Flot 在 x 轴上绘制多个点？

> ID：13484351
> 
> 赞同：0
> 
> 时间：2012-11-21T00:06:29.980
> 
> 标签：javascript, flot

我试图用 Flot 绘制 84 个 x 轴点，但我的数据没有绘制出来。我一直在搞砸，`tickSize`但这并没有产生任何结果。这是一团糟，我还希望能够将 xaxis 图例调整为清晰易读，但我主要担心的是为什么我的数据没有出现。

有人可以帮我辨别为什么没有出现线条和点吗？

[jsfiddle](http://jsfiddle.net/JJBKp/2/)链接到我的 javascript。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:17:08.740

只需在 data 属性周围添加方括号，因为它是一个数据系列数组，而不仅仅是单个数据数组。在您的示例中，它将是：

```
$.plot($("#placeholder"), [data], options); 
```

JSFiddle：http: [//jsfiddle.net/JJBKp/3/](http://jsfiddle.net/JJBKp/3/)

有关更多信息，请参阅[https://github.com/flot/flot/blob/master/README.md#basic-usage](https://github.com/flot/flot/blob/master/README.md#basic-usage)。

如果您旋转标签，您可以使 Flot 图更具可读性。AFAIK，目前还不可能开箱即用[http://code.google.com/p/flot/issues/detail?id=85](http://code.google.com/p/flot/issues/detail?id=85)，但是有插件和叉子可以修复它：

*   [http://jsfiddle.net/manishsp2008/vNSD8/](http://jsfiddle.net/manishsp2008/vNSD8/)
*   [https://github.com/markrcote/flot-tickrotor](https://github.com/markrcote/flot-tickrotor)

# php - 从 PHP 文件中的 MYSQL 中提取特定数据

> ID：13484352
> 
> 赞同：0
> 
> 时间：2012-11-21T00:06:33.917
> 
> 标签：php, mysql

我有 sql 数据库它包含一些客户端数据
它包含两个表都包含不同类型的客户端
这是我用来从表中提取数据的代码

```
 <?php
require_once("includes/connection.php");
    require_once("includes/functions.php");

$query  = "SELECT name, id, comit FROM co_form";
$result = mysql_query($query);

while($row = mysql_fetch_array($result, MYSQL_ASSOC))
{
echo "Name :{$row['name']} <br>" .
     "id : {$row['id']} <br>" .
     "comit : {$row['comit']} <br><br>";

} 
    mysql_close($connection); 

?> 
```

字段comit将客户端划分为上面代码从1到5的类
显示所有客户端

我只需要显示一个类
我的意思是只显示comit = 1的客户端
我知道这很容易但我不能这样做而且我php中的新功能

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T00:08:20.920

```
$query  = "SELECT name, id, comit FROM co_form WHERE comit = 1"; 
```

# python - MySQL/Python 抢占式缓存

> ID：13484360
> 
> 赞同：3
> 
> 时间：2012-11-21T00:07:47.120
> 
> 标签：python, mysql, orm, memcached

我运行一个用 python 编写的 Web 应用程序，并使用 mysql 作为我们的主要数据存储。我们在 amazon RDS 上有一个包含数千万行的大表，预计它会大 10 倍。我们运行许多查询，根据主键选择几百个随机行（例如“select * from table where id IN (ids)”，其中 id 是主键）。它有时很慢，需要 30 多秒。最终我们将不得不对表进行分片，但我们一直在考虑尝试保留缓存在 memcache 中的行的副本。在运行选择查询之前，我们会发送一个 multi_get 到内存缓存。鉴于我们的工作流程（我们运行大量更新），如果我们也抢先将行的更改写入 memcache 版本，我们只会获得显着的性能提升。

我想知道是否有人使用过这样的设置，以及是否有 ORM 可以很好地处理这个或其他有用的工具（比如可能从 mysql 二进制日志中提取更改并将它们发送到 memcache）。最危险的部分是如果有人忘记更新或至少使他们在 mysql 上更新的 memcache 中的行无效。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T18:11:18.597

这是 Django 中“透明”缓存的示例：[https](https://github.com/mmalone/django-caching) ://github.com/mmalone/django-caching 。但是，我应该警告您，这种方式的缓存会变得非常复杂，非常快。

如果您有数千万行并且您的访问模式通常是按行 ID，那么您可能需要考虑使用 NoSQL 解决方案。由于您已经在 AWS 上，请考虑使用[DynamoDB](http://aws.amazon.com/dynamodb)或[SimpleDB](http://aws.amazon.com/simpledb)。两者都提供快速且可扩展的键值访问。

# wso2 - WSO2 治理注册表 - 如何从一台服务器移动到另一台服务器？

> ID：13484366
> 
> 赞同：3
> 
> 时间：2012-11-21T00:08:51.693
> 
> 标签：wso2, migrate

如果我想将治理注册表（包括为服务、关联/依赖项/评论/评级/等输入的数据）从一台服务器移动到另一台服务器，我该怎么做？

我看到签入客户端可用于将文件和目录结构从一台服务器迁移到另一台服务器？如何迁移关联/依赖等服务的关联数据

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T19:23:38.560

如果您使用的是 WSO2 Developer Studio，那么在 Developer Studio 中也可以使用相同的功能。

如果您使用的是 Registry Check-In 客户端，则必须通过控制台运行它。但是使用 Developer Studio，您可以简单地从 Eclipse 中选择一个注册表中的集合或资源，并指示将所选资源或集合移动或复制到 Eclipse 中的另一个注册表。

有关更多信息，请遵循[此](http://dist.wso2.org/products/developer-studio/2.1.0/docs/greg_user_guide.html#import)

/哈莎娜

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T08:38:21.057

是的，您可以为此使用签到客户端。它用于进行注册表转储并还原到另一个注册表。您能详细说明为什么要这样做吗？我对您的确切要求不清楚。请在[此处](http://wso2.org/project/registry/4.1.0/docs/user_guide/checkin_client.html)找到有关值机客户的更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T09:46:40.180

当您使用签入客户端执行迁移时，关联和依赖关系将包括在内。目前它使用转储恢复风格恢复。

# php - 对表单元素集的多个 AJAX 请求

> ID：13484375
> 
> 赞同：2
> 
> 时间：2012-11-21T00:09:54.023
> 
> 标签：php, javascript, jquery, html

我是一个非常新手的程序员，他正在尝试制作一个心跳脚本，该脚本从当前页面获取一个 id 并将其发送到 heartbeat.php，其中会发生以下情况：

1) 我在**日程表**中查找与我刚刚发送过来的 id 对应的**currentlocation**字段。

2) 然后我将在**当前**位置字段中找到的值编码为 JSON

以下是 heartbeat.php 的代码：

```
<?php
/*** mysql hostname ***/
$hostname = 'localhost';

/*** mysql username ***/
$username = '********';

/*** mysql password ***/
$password = '*********';

$db = new PDO("mysql:host=$hostname;dbname=sv", $username, $password);
$statement = $db->prepare("SELECT currentlocation FROM schedule WHERE apptid = :apptid");
$statement->execute(array(':apptid' => $apptid));
$row = $statement->fetch();
echo json_encode($row['currentlocation']);

?> 
```

在 html 方面，我使用 php 循环从数据库中提取患者信息，因此 ID-NUMBER-1 和 ID-NUMBER-2 将是数据库中的相应 ID。

这是html：

```
<!--  FIRST SET: the id is ID-NUMBER-1  -->

<div class='jcontainer'>
      <div style='display:none; class='jcontainerid'>ID-NUMBER-1</div>
      <button class='checkIn' data-param='button_ID-NUMBER-1'>Check In</button>
      <form method='post' class='myForm' action=''>
           <select name='locationSelect' class='locationSelect' data-param='location_ID-NUMBER-1'>
                <option value='1'>Exam Room</option>
                <option value='2'>Exam Room 2</option>
                <option value='3'>X-Ray Room</option>
                <option value='1000'>Check Out</option>
           </select>
      </form>
      <div class='finished' style='color:#ff0000;'>Checked Out</div>
</div>

<!--  SECOND SET: the id is ID-NUMBER-2  -->

<div class='jcontainer'>
      <div style='display:none; class='jcontainerid'>ID-NUMBER-2</div>
      <button class='checkIn' data-param='button_ID-NUMBER-2'>Check In</button>
      <form method='post' class='myForm' action=''>
           <select name='locationSelect' class='locationSelect' data-param='location_ID-NUMBER-2'>
                <option value='1'>Exam Room</option>
                <option value='2'>Exam Room 2</option>
                <option value='3'>X-Ray Room</option>
                <option value='1000'>Check Out</option>
           </select>
      </form>
      <div class='finished' style='color:#ff0000;'>Checked Out</div>
</div> 
```

所以，问题是，如何在 JQuery 中执行以下操作：

1）对于每个jcontainer（或我在我的html中标记的每组表单元素），获取id，它是具有jcontainerid类的div内的文本

2）然后使用jquery心跳，每5秒发送到php页面的每个jcontainer的id和以JSON格式发回的**currentlocation的值。**

非常感谢您提供的所有帮助。如果您需要更多详细信息，请尽管询问，我很乐意为您提供帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:57:52.180

您可以使用 .each() 迭代每个 jcontainer，在此处查看更多信息：

[http://api.jquery.com/each/](http://api.jquery.com/each/)

这是您可以执行的操作的示例：

```
function dataToHeartbeat(){
  $(".jcontainer").each(function(){
    // grab the id
    var apptid = $(this + " > .jcontainerid").text();
    // Submit to heartbeat.php with JSON expected in return
    $.getJSON('heartbeat.php?apptid='+apptid, function(data){
      // Do something with resulting data
    });
  });
} 
```

然后，您可以使用 setTimeout() 调用该函数。根据您的需要，您可以在函数中添加 setTimeout 以导致连续循环。

# java - Java JSpinner 画两次

> ID：13484376
> 
> 赞同：0
> 
> 时间：2012-11-21T00:09:55.537
> 
> 标签：java, swing, paint, jcomponent, jspinner

[快速图片显示正在发生的事情](http://i.stack.imgur.com/S7zij.png)

如上图所示，JSpinner 出现了两次。在点 (0,0) 的第一次出现不应该出现在没有微调按钮的情况下是不可选择、不可编辑或不可使用的。

奇怪的是，其他所有组件都没有问题。只有jspinner。我正在使用 Java 7 并在 Netbeans（不是 gui 开发人员工具包）中进行开发。这是java 7的错误吗？如果不是，我可以尝试让我的 JSpinner 在我指定的区域仅绘制 1 次？

说明问题的代码：

我将它添加到 JPanel 的子类中，如下所示：

```
public class MyCustomGUI extends JPanel {
private JSpinner entrySpinner;
public MyCustomGUI () {
 super(null);
 this.setDoubleBuffered(true);

 entrySpinner = new JSpinner(new SpinnerNumberModel(0, 0, Integer.MAX_VALUE, 1));
 add(entrySpinner);
.... 
```

我有一种方法可以给它一个位置：

```
public void resize() {
     entrySpinner.setBounds((int) (this.getWidth() * .2), (int) (this.getHeight() * 0.38), (int) (this.getWidth() * 0.3), (int) (this.getHeight() * 0.1));
} 
```

我在这里覆盖了paint方法：

```
public void paint(Graphics g) {
    super.paint(g);
    Graphics2D g2d = (Graphics2D) g;
    g2d.setRenderingHint(
            RenderingHints.KEY_TEXT_ANTIALIASING,
            RenderingHints.VALUE_TEXT_ANTIALIAS_ON);
    .. draw shapes..
    super.paintComponents(g);
    super.validate();
    Toolkit.getDefaultToolkit.sync();
    g.dispose();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:18:25.093

1.  你打`paintComponent`了两次电话，一次是你打电话的时候`super.paint`，一次是手动的
2.  您`validate`从一个`paint`方法中调用，该方法只会导致组件开始重新绘制，一遍又一遍……与你的 CPU 说再见……
3.  你正在处理你没有创建的图形上下文，这就像关闭一个你没有打开的文件。如果您没有创建它，则不应关闭它。
4.  我不相信你需要打电话`Toolkit.getDefaultToolkit.sync();`，但我有理由相信你不应该在`paint`方法中这样做
5.  除非您有充分的理由这样做，否则您不应该覆盖该`paint`方法。执行自定义绘画的推荐方法是`paintComponent`方法（由 调用`paint`）

您可能想通读

*   [执行自定义绘画](http://docs.oracle.com/javase/tutorial/uiswing/painting/)
*   [在 AWT 和 Swing 中绘画](http://www.oracle.com/technetwork/java/painting-140037.html)

**更新示例**

为我修好了...

![在此处输入图像描述](../Images/e725a4a66260d66a84109d926e755541.png)![在此处输入图像描述](../Images/1025b95b3c9d8abb1db5b01684db8270.png)

*左边是你的代码，右边是我的*

```
public class TestPaintSpinner {

    public static void main(String[] args) {
        new TestPaintSpinner();
    }

    public TestPaintSpinner() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new TestPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class TestPane extends JPanel {

        public TestPane() {
            setDoubleBuffered(true);
            setLayout(new GridBagLayout());
            add(new JSpinner(new SpinnerNumberModel(0, 0, Integer.MAX_VALUE, 1)));

            JPanel panel = new JPanel();
            panel.add(new JLabel("Subpanel"));
            add(panel);
        }

//        public void paint(Graphics g) {
//            super.paint(g);
//
//            Graphics2D g2d = (Graphics2D) g;
//            Point2D sPoint = new Point2D.Float(0, 0);
//            Point2D ePoint = new Point2D.Float(this.getWidth(), this.getHeight());
//
//            g2d.setRenderingHint(
//                    RenderingHints.KEY_TEXT_ANTIALIASING,
//                    RenderingHints.VALUE_TEXT_ANTIALIAS_ON);
//            super.paintComponents(g);
//            super.validate();
//            Toolkit.getDefaultToolkit().sync();
//            g.dispose();
//        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g); //To change body of generated methods, choose Tools | Templates.

            Graphics2D g2d = (Graphics2D) g;
            Point2D sPoint = new Point2D.Float(0, 0);
            Point2D ePoint = new Point2D.Float(this.getWidth(), this.getHeight());

            // Note, this will effect every component painted after this one!!
            g2d.setRenderingHint(
                    RenderingHints.KEY_TEXT_ANTIALIASING,
                    RenderingHints.VALUE_TEXT_ANTIALIAS_ON);
        }
    }
} 
```

# ruby-on-rails-3 - 如何使用 Rails 的资产管道在 HTML 页面中嵌入 JavaScript/CSS？

> ID：13484380
> 
> 赞同：6
> 
> 时间：2012-11-21T00:10:06.307
> 
> 标签：ruby-on-rails-3, asset-pipeline

我正在开发一个网页，其内容完全由客户端 JavaScript 生成。index.html 的唯一目的是引用 JavaScript 和 CSS 文档，它们是由 Rails 的资产管道生成的。为了避免额外的请求，我想在生产中内联那些 JavaScript 和 CSS。

如何内联使用资产管道生成的 JavaScript 和 CSS 内容？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-12-10T12:25:10.850

您可以使用`Rails.application.assets`预编译后获取资产的内容。将此添加到您的`index.html.erb`：

```
<style type="text/css">
  <%= raw Rails.application.assets['application.css'].to_s %>
</style>
<script type="text/javascript">
  <%= raw Rails.application.assets['application.js'].to_s %>
</script> 
```

不要忘记`raw`, 否则`"`会变成`&quot;`etc.

请注意，这不是压缩的；对于生产，您可能需要内联压缩代码。为此，请添加`gem 'uglifier'`到您的 Gemfile，运行 bundle，然后使用：

```
<%= raw Uglifier.new(:copyright => false).compile Rails.application.assets['application.js'].to_s %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-05-23T09:50:42.987

您还可以使用：`Rails.application.assets.find_asset('api.css').to_s`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T01:51:26.793

您可能**不想**内联这些资产以提高生产性能。通过像 CloudFront 这样的 CDN 为它们提供服务并一路缓存它们，你可能会做得更好。

这应该比减少很少发出的 2 个 HTTP 请求提供更好的性能提升。

# java - 免费添加 JTextFields 硬代码

> ID：13484384
> 
> 赞同：2
> 
> 时间：2012-11-21T00:10:30.517
> 
> 标签：java, swing, jtextfield

我正在尝试为一个程序编写代码，该程序将为用户提供从上到下的硬编码数量的 JTextField，并可以选择添加额外的 JTextField。之后我必须从每个 JTextField 中检索用户导入的数据。我该怎么做呢？所有 JTextField 都添加到 JPanel。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T11:51:40.227

做这样的事情：

```
 ArrayList<JTextField> list = new ArrayList<JTextField>();
    //add all the hardcoded JTextFields to this list
    //b is a button which the user clicks to add extra TextFields
    b.addActionListener(new ActionListener() {

        @Override
        public void actionPerformed(ActionEvent e) {
            // TODO Auto-generated method stub
            JTextField a = new JTextField();
            panel.add(a);//panel is the existing panel
            list.add(a);
        }
    });
} 
```

因此，在“列表”的帮助下，您以后可以检索所有文本字段

# php - 用于从变量 MySQL 表中获取数据的 PHP PDO 函数

> ID：13484385
> 
> 赞同：0
> 
> 时间：2012-11-21T00:10:31.727
> 
> 标签：php, mysql, database, pdo, crud

我正在尝试制作一个可以在多个页面上使用的功能，以节省使用的代码量。函数参数之一应该告诉函数从哪个 mysql 表中获取所有数据，但由于某种原因，该函数不起作用。这是我所拥有的：

```
function get_data($conn, $type) {
    $stmt = $conn->prepare("SELECT * FROM :type");
    $stmt->bindParam(':type', $type);
    $stmt->execute();
    $results = $stmt->fetchAll();
    return $results ? $results : false;
} 
```

因此，当我在我的一个页面上调用该函数时，我使用：

```
$conn = connect();
$results = get_data($conn, 'links'); 
```

为什么功能不起作用？有人知道吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T00:16:35.683

据我所知，您不能将表格作为参数传递。因此，您必须使用字符串连接构建查询。在这种情况下，SQL 注入的风险应该为零，因为您不应该接受来自外部来源的表名。

**例子**

```
function get_data($conn, $table_name) {
    // The backticks are used in case table name contains spaces, or it matches a keyword
    $stmt = $conn->prepare('SELECT * FROM `' . $table_name . '`');
    $stmt->bindParam(':type', $type);
    $stmt->execute();
    $results = $stmt->fetchAll();
    return $results ? $results : false;
} 
```

**进一步说明**
虽然我可以理解您想要实现的目标，但这种访问数据的方法效率很低。首先，您使用星号，这通常是运行查询时的一大禁忌。其次，使用这种方法，您不能添加子句，例如 WHERE、JOIN 等。总是不加选择地从表中获取所有数据可能会导致主要的性能问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T00:19:36.170

@Diego 是正确的，您不能将 SQL 参数用于表名、列名、SQL 关键字、值列表（如在 IN() 谓词中）或任何其他表达式。

```
SELECT :column FROM table   -- NO, unless you want to select a constant string

SELECT * FROM :table    -- NO

SELECT * FROM table WHERE column IN (:list)  -- NO

SELECT * FROM table ORDER BY :column -- NO

SELECT * FROM TABLE ORDER BY column :asc_or_desc  -- NO 
```

基本上，请记住这条规则：如果您可以用一个*常量值*（例如，带引号的字符串、日期或整数）代替 SQL 参数，那么这是对参数的合法使用。否则，没有。

```
SELECT :string FROM table -- OK, but returns value of :string for every row

SELECT * FROM table WHERE column = :string  -- OK

SELECT * FROM table WHERE column IN (:x, :y, :z) -- OK, one parameter per value 
```

`prepare()`此外，在编程 PDO 时，您应该始终检查和的返回值`execute()`。它们将返回`false`错误，您应该编写代码来检测并做出适当的响应（即记录错误、显示错误页面、给用户另一个机会等）

```
$stmt = $conn->prepare("SELECT * FROM :type"); // illegal use of parameter
if ($stmt === false) {
  // check $pdo->errorInfo(), see documentation
}
$stmt->bindParam(':type', $type);
$status = $stmt->execute();
if ($status === false) {
  // check $stmt->errorInfo(), see documentation
} 
```

您甚至可能想要检查其他 PDO 函数的返回值。请参阅文档，其中许多返回`false`错误。

# c++ - 为什么我们不能在一个类中声明一个命名空间？

> ID：13484387
> 
> 赞同：66
> 
> 时间：2012-11-21T00:10:57.217
> 
> 标签：c++, class, namespaces

在类中声明类是有效的。（嵌套类）

在类中声明命名空间是无效的。

问题是：有什么好的理由（除了 c++ 语法/语法问题）禁止在类中声明命名空间吗？

* * *

至于我为什么要这样做，这里有一个例子：

让我们有一个二叉树容器的基本说明

```
template<typename Data>
class binary_tree
{
 public:
  ... stuff ....     

 private:
  ... iterators class declaration ...

 public:
  typedef left_depth_iterator_impl     left_depth_iterator;
  typedef right_depth_iterator_impl    right_depth_iterator;
  typedef left_breadth_iterator_impl   left_breadth_iterator;
  typedef right_breadth_iterator_impl  right_breadth_iterator;

  ... stuff ....     

 private:
  Data         data;
  binary_tree* left;
  binary_tree* right;
}; 
```

现在我注意到我的类中有很多迭代器，所以我想在同一个命名空间中重新组合它们，如下所示：

```
template<typename Data>
class binary_tree
{
 public:
  ... stuff ....     

 private:
  ... iterators class declaration ...

 public:
  namespace iterator
  {
    typedef left_depth_iterator_impl     left_depth;
    typedef right_depth_iterator_impl    right_depth;
    typedef left_breadth_iterator_impl   left_breadth;
    typedef right_breadth_iterator_impl  right_breadth;
  }

  ... stuff ....     

 private:
  Data         data;
  binary_tree* left;
  binary_tree* right;
}; 
```

这将允许一个简单的用法：

```
void  function()
{
  binary_tree::iterator::left_depth   it;

  ...stuff...
} 
```

如果我使用一个类而不是命名空间，这会起作用，但是我被迫声明一个永远不会被实例化的类，它是一个相当命名空间。

为什么允许嵌套类并禁止在类中嵌套命名空间？这是遗留负担吗？

* * *

具有语义原因的答案不仅引用标准的一部分（尤其是语法部分）将被欣赏:)

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-11-21T00:35:16.157

既然您询问了标准授权命名空间位置的哪些部分，我们首先提出了这个问题：

> **C++11 7.3-p4：**每个命名空间定义应出现在全局范围或命名空间范围 (3.3.6) 中。

关于类定义和在其中声明命名空间的提议，我带你去......

> **C++11 9.2-p2：**类在类说明符的结束 } 处被视为完全定义的对象类型（3.9）（或完整类型）。在类成员规范中，类在函数体、默认参数、异常规范和非静态数据成员（包括嵌套类中的此类内容）的大括号或等式初始化器中被认为是完整的。否则，它在其自己的类成员规范内被视为不完整。

因此，一旦达到结束卷曲，类定义是有限的。它不能被打开备份和扩展（派生是不同的，但它不是扩展*刚刚定义的类*）。

但是潜伏在命名空间标准定义的最开始的是扩展它的能力。由于缺乏更好的术语而对其进行扩展：

> **C++ 7.3-p1：**命名空间是一个可选命名的声明区域。命名空间的名称可用于访问在该命名空间中声明的实体；即命名空间的成员。**与其他声明性区域不同，命名空间的定义可以拆分为一个或多个翻译单元的几个部分。**（强调补充）。

因此，类中的命名空间将违反 7.3-p4 中的定义。假设不存在，则可以在*任何*地方声明命名空间，包括在类中，但由于类的定义一旦关闭就正式化，如果您维护，您将只能执行以下操作符合 7.3-p1：

```
class Foo
{
   namespace bar
   {
       ..stuff..
   }

   .. more stuff ..

   namespace bar
   {
       ..still more stuff..
   }
}; 
```

在建立 7.3-p4 来解决它之前，这个*功能*的实用性可能已经争论了大约 3 秒。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2017-07-13T17:38:47.497

我在这里不同意其他人的意见。我不会说没有真正的优势。有时我只想在没有额外含义的情况下隔离代码。例如，我在一个多线程 ringbuffer 模块中工作，并希望将状态成员（其中一些是原子的和/或内存对齐的）拆分为生产者和消费者的命名空间。

通过仅使用`producer`或`consumer`前缀命名所有内容（这是我当前令人讨厌的实现），我正在添加污染，使代码更难阅读。例如，当生产者拥有的所有内容都以 开头时`producer`，您的大脑在读取它时会更容易意外地自动更正`producerProducerTimer`（生产者计时器的生产者副本）为`producerConsumerTimer`（消费者计时器的生产者影子）或`consumerProducerTimer`（生产者计时器的消费者影子）。由于代码不再可浏览，因此调试所需的时间比需要的时间长。

通过创建嵌套类/结构：

*   我可能会给下一个维护此代码的开发人员一个想法，即在上下文中可以/应该实例化、复制和分配多个这些代码中的一个以上，所以现在不仅担心命名，我还必须处理`= delete`这些事情.
*   我可以使用结构对齐填充将内存占用添加到上下文中，否则这可能是不必要的。
*   将所有成员设为静态不是一种选择，因为可以实例化多个需要其自己的生产者/消费者状态变量的上下文。
*   这种结构的函数不再可以访问其他成员数据或函数，例如双方共享的常量或函数，而是必须将这些东西作为参数。

理想情况下，我希望能够改变这样的事情：

```
rbptr producerPosition;
rbptr consumerPosition; 
```

对此：

```
namespace producer
{
    rbptr position;
}
namespace consumer
{
    rbptr position;
} 
```

然后，应该只接触消费者成员的函数可以使用消费者命名空间，只应该接触生产者成员的函数可以使用生产者命名空间，而需要接触两者的函数必须明确限定它们。在仅使用生产者命名空间的函数中，无法意外触及消费者变量。

在这种情况下，希望纯粹是为了减少事物的生产者和消费者副本之间的命名冲突，而减少命名冲突是命名空间存在的目的。出于这个原因，我支持能够在类中声明命名空间的提议。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-11-21T00:20:10.773

将这样的功能添加到语言中并没有真正的优势。除非有需求，否则通常不会添加功能。

类中的命名空间会给你带来什么？你真的宁愿说`binary_tree::iterator::left_depth`而不是简单地说`binary_tree::left_depth`吗？也许如果你有多个命名空间，你可以用它们来区分 say`binary_tree::depth_iterator::left`和`binary_tree::breadth_iterator::right`.

在任何情况下，您都可以使用内部类作为差劲程序员的命名空间来获得所需的结果，这也是为什么类内部不需要真正的命名空间的更多原因。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-11-21T00:15:24.727

这不是命名空间的重点。命名空间旨在更接近代码的顶层存在，以便两个不同的公司（或代码库）可以相互混合代码。在更微观的层面上，我使用用于电子邮件访问的 IMAP 和用于发送电子邮件的 SMTP 进行编码，并且（可以，我正在大大简化）在任何一个模块`Email`中都有完全不同的类，但我可以有一个应用程序，比如邮件客户端，希望同时使用同一类中的两者，例如，它可能会将邮件从一个帐户转发到另一个帐户。命名空间/包名称/等允许这样做。

您所提出的根本不是名称空间的用途-在一个文件中，您可以给事物起不同的名称，因为作者对该文件具有全局知识，尽管当两家公司想要共享代码或两个应用程序时，情况并非如此那不知道他们会在任何时候发生碰撞。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-08-16T19:11:39.133

只是一个我觉得值得一提的小想法。在类中使用命名空间的一种方式是在功能上等同于模板命名空间。

```
template<class...types>
struct Namespace {
    namespace Implementation {
        ...
    }
};

// somewhere else

using namespace Namespace<types...>::Implementation;

// use templated stuff. 
```

就个人而言，我会喜欢这个功能，但似乎需求还不够高，无法实现。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-03-05T19:31:49.957

我可能会为此讨厌

```
template<typename Data>
class binary_tree
{
 public:
  ... stuff ....     

 private:
  ... iterators class declaration ...

 public:
  class iterator
  {
    iterator() = delete;
  public:
    typedef left_depth_iterator_impl     left_depth;
    typedef right_depth_iterator_impl    right_depth;
    typedef left_breadth_iterator_impl   left_breadth;
    typedef right_breadth_iterator_impl  right_breadth;
  }

  ... stuff ....     

 private:
  Data         data;
  binary_tree* left;
  binary_tree* right;
}; 
```

这基本上是一个无法实例化的静态类，因此您必须使用它访问其中的 typedef，`iterator::type` 以便您现在可以将其用作常规命名空间

```
void  function()
{
  binary_tree::iterator::left_depth   it;

  ...stuff...
} 
```

# sql - 使用变量更新时的奇怪更新行为

> ID：13484388
> 
> 赞同：0
> 
> 时间：2012-11-21T00:10:59.867
> 
> 标签：sql, sql-server, sql-server-2008-r2, sql-update

[这是对我的问题Reference a column 并在同一语句中更新它](https://stackoverflow.com/questions/13458395/reference-a-column-and-update-it-in-the-same-statement)的一种跟进。我现在正在尝试使用局部变量并在同一个更新语句中对其进行更新。

```
declare @tmp table (ID int primary key, UNPAID money)

insert into @tmp select 1, 31.63
insert into @tmp select 2, 49.20
insert into @tmp select 3, 99.00
insert into @tmp select 4, 41.00

declare @paymentAmmount money
select @paymentAmmount = SUM(UNPAID) from @tmp

declare cur_oustandingAR cursor local static for select ID  from @tmp order by ID
open cur_oustandingAR

declare @currentID int

fetch next from cur_oustandingAR into @currentID
while (@@fetch_status = 0 and @paymentAmmount > 0)
begin
    begin
        update @tmp
            set UNPAID = case when @paymentAmmount > UNPAID then 0 else UNPAID - @paymentAmmount end,
                @paymentAmmount = case when @paymentAmmount > UNPAID then @paymentAmmount - UNPAID else 0 end
            where ID = @currentID
    end
    fetch next from cur_oustandingAR into @currentID
end

select * from @tmp
select @paymentAmmount as LeftoverPayment 
```

[您可以在此处](https://data.stackexchange.com/stackoverflow/query/86502/query-for-se-question#resultSets)运行查询，这是它给出的结果

```
身份证未付
------------ ---------
1 0.00
2 0.00
3 58.00
4 41.00

剩余付款
---------------
0               

```

所有的值都应该是 0，`@paymentAmmount`最后也应该是 0。出了什么问题导致无法正确应用这些值？

* * *

PS 我知道如何[修复它](https://data.stackexchange.com/stackoverflow/query/86499/query-for-se-question-working-version)，只需将一个查询分解为以下 3 个查询，但我想将其作为单个查询进行，因此我不需要针对真实表进行尽可能多的查找

```
select @oldUnpaid = UNPAID from @tmp where ID = @currentID
update @tmp 
    set UNPAID = case when @paymentAmmount > UNPAID then 0 else UNPAID - @paymentAmmount end
    where ID = @currentID
select @paymentAmmount = case when @paymentAmmount > @oldUnpaid then @paymentAmmount - @oldUnpaid else 0 end 
```

我只是想知道为什么我目前正在做的事情不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T00:46:21.383

```
declare @tmp table (ID int primary key, UNPAID money)

insert into @tmp select 1, 31.63
insert into @tmp select 2, 49.20
insert into @tmp select 3, 99.00
insert into @tmp select 4, 41.00

declare @paymentAmmount money
declare @paymentAmmountbuf money
select @paymentAmmount = SUM(UNPAID) from @tmp
declare cur_oustandingAR cursor local static for select ID  from @tmp order by ID
open cur_oustandingAR

declare @currentID int

fetch next from cur_oustandingAR into @currentID
while (@@fetch_status = 0 and @paymentAmmount > 0)
begin
    begin
        select @paymentAmmountbuf=@paymentAmmount

        update @tmp
            set UNPAID = case when @paymentAmmountbuf > UNPAID then 0 else UNPAID - @paymentAmmountbuf end,
                @paymentAmmount = case when @paymentAmmount > UNPAID then @paymentAmmount - UNPAID else 0 end
            where ID = @currentID
    end
    fetch next from cur_oustandingAR into @currentID
end

select * from @tmp
select @paymentAmmount as LeftoverPayment 
```

# excel - Excel 平均垃圾箱

> ID：13484389
> 
> 赞同：0
> 
> 时间：2012-11-21T00:11:08.857
> 
> 标签：excel, excel-formula, excel-2010

我正在寻找与目标薪酬差异的 bin 频率计数相对应的平均薪酬。我使用频率公式来获得分布，但我无法获得进入垃圾箱的平均值。我怎样才能做到这一点？首选公式，VBA 可以接受。我的一些公式似乎正确地得到了我想要的东西，但这是非常手动的并且似乎包含错误（参见 -100% bin with 5 freq count and a error for avg pay）。**请注意，用于平均值的第二个 SUMIFS 是计算其他计算中使用的 1 列，因此它类似于 COUNTIF。

```
 % Variance to Target    
   Chart 
   Freq   Avg Pay   Bins
    0     #DIV/0!   -150%
    0     #DIV/0!   -140%
    0     #DIV/0!   -130%
    0     #DIV/0!   -120%
    1     3.0375    -110%
    5     #DIV/0!   -100%
    4     17.85     -90%
    0     #DIV/0!   -80%
    3     200.2875  -70%
    11    1761.68   -60% 
```

我正在使用以下方法来尝试计算平均工资。

```
 =SUMIFS(Model!DG:DG,Model!DI:DI,"<-1.1",Model!DI:DI,">-1.2")
     /
     SUMIFS(Model!DQ:DQ,Model!DI:DI,"<-1.1",Model!DI:DI,">-1.2") 
```

我真正想要的是一个比手动输入测试的每个范围更自动/动态的公式 - 双引号中的单元格引用只会插入文本而不是我的 bin 值。例如 SUMIFS（型号！DQ：DQ，型号！DI：DI，“EH2064”）。

# php - php传递函数参数值来选择其他字符串并给它一个值

> ID：13484390
> 
> 赞同：0
> 
> 时间：2012-11-21T00:11:13.670
> 
> 标签：php, function, arguments

我一直在绞尽脑汁想办法解决这个问题。我有一个头文件，在我网站上的每个文档中都会调用它，我需要从每个文档中动态选择哪个锚点被赋予了一个设定值。如下：

```
function headur($page) {echo'...
    <ul>
      <li><a'.$h.' href="/">Home</a>
      <li><a'.$s.' href="/services">Services</a>
      <li><a'.$p.' href="/portfolio">Portfolio</a>
      <li><a'.$a.' href="/about">About</a>
      <li><a'.$c.' href="/contact">Contact</a>
    </ul>...
  ;} 
```

然后在我的文档中，我调用`headur($a);`并从该参数值中调用 - `$a`- 使用它作为选择器为匹配的内部字符串提供特定值 - `class="selected"`即这个特定的函数调用将像这样输出 html：

```
 <ul>
      <li><a href="/">Home</a>
      <li><a href="/services">Services</a>
      <li><a href="/portfolio">Portfolio</a>
      <li><a class="selected" href="/about">About</a>
      <li><a href="/contact">Contact</a>
    </ul> 
```

关键是它是从调用该函数的文档中动态选择的，而我不必手动创建一个大的旧 if 语句来匹配所有内容。即`if ($page == $a) {$a = ' class="selected"';}`对于每一个，这是我一直在做的。`.addClass();`我想这是在外部文件上做的 php 等价物。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T00:23:33.290

只需将您的类定义存储在一个数组中并通过索引搜索它。对数组使用数字键是最简单的，但在回读代码时描述性不是很强。要使用数字键，只需执行以下操作：

```
$pages = array("", "services", "portfolio", "about", "contact");
$where = array_search($a, $pages); // $a is the param passed to the function
$pages[$where] .= "\" class=\"selected\""; 
```

我按顺序处理了您的页面，因此 $h 将被 $pages[0] 替换，$s 将被 $pages[1] 替换，依此类推。如果您希望我为您编写一些代码，以便您可以使用数组中的文本键使其更容易，我也可以这样做，但我个人认为这在没有额外代码的情况下可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T00:26:41.633

一个解决方案可能是将您的模板加载到 DOMDocument 中并将链接设置为与当前 URL 匹配的活动：

```
$dom = new DOMDocument();
$dom->loadXML('<ul><li><a href="/yourLink">Your Link</a></li></ul>');

$xpath = new DOMXPath($dom);
$url = $_SERVER['REQUEST_URI'];

foreach ($xpath->query(sprintf('//a[@href="%s"]', $uri)) as $current) {
    $current->setAttribute('class', 'selected');
} 

echo $dom->saveXML(); 
```

代码未经测试！但它应该给你一个想法......这样你就可以编写你的模板文件而不需要任何 PHP 代码......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T00:20:54.313

那么你可以做这样的事情：

```
<ul>
    <li><a class="<?php echo $_SERVER['PHP_SELF'] == '/' ? 'selected' : '' ?>" href="/">Home</a>
    <li><a class="<?php echo $_SERVER['PHP_SELF'] == '/services' ? 'selected' : '' ?>" href="/services">Services</a>
    <li><a class="<?php echo $_SERVER['PHP_SELF'] == '/portfolio' ? 'selected' : '' ?>" href="/portfolio">Portfolio</a>
    <li><a class="<?php echo $_SERVER['PHP_SELF'] == '/about' ? 'selected' : '' ?>"href="/about">About</a>
    <li><a class="<?php echo $_SERVER['PHP_SELF'] == '/contact' ? 'selected' : '' ?>" href="/contact">Contact</a>
</ul> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T00:26:07.693

创建一个数组并遍历数组是非常典型的：

```
$linkMenu = array(
    '/' => 'Home',
    '/services' => 'Services',
    '/portfolio' => 'Portfolio',
    '/about' => 'About',
    '/contact' => 'Contact',
);

function linkList($links, $page=null) {
    echo '<ul>';
    foreach($links as $url=>$name) {
        $selected = ($url == $page) ? " class='selected' " : '';
        echo "<li><a $selected href='$url'>$name</a></li>\n";
    }
    echo '</ul>';
} 
```

现在，您可以使用以下命令为主页创建链接菜单：

```
linkList($linkMenu, '/'); 
```

# php - 如何使用其列数据的总和对多维数组的每个值执行数学运算？

> ID：13484398
> 
> 赞同：0
> 
> 时间：2012-11-21T00:12:09.797
> 
> 标签：php, arrays, math, multidimensional-array

我有一个从数据库中提取的“答案”（多维数组）集合。我需要对每个值进行计算，以便可以在图表上显示结果。

这是一些示例输入：

```
$array = [
    'A1' => [1 => 1, 2 => 0, 3 => 0, 4 => 0, 5 => 0, 6 => 0, 7 => 0, 8 => 0, 9 => 0, 10 => 0],
    'A2' => [1 => 1, 2 => 1, 3 => 0, 4 => 0, 5 => 0, 6 => 0, 7 => 0, 8 => 0, 9 => 0, 10 => 0],
    'A3' => [1 => 0, 2 => 0, 3 => 0, 4 => 0, 5 => 0, 6 => 0, 7 => 0, 8 => 0, 9 => 0, 10 => 0]
]; 
```

我想使用这种逻辑从多维数组中计算百分比值：

```
[A1] => Array( ([1]*100/sum([1]+[1]+[1]), [2]*100/sum([2]+[2]+[2]),..... )
[A2] => Array( ([1]*100/sum([1]+[1]+[1]), [2]*100/sum([2]+[2]+[2]),..... )
[A3] => Array( ([3]*100/sum([1]+[1]+[1]), [2]*100/sum([2]+[2]+[2]),..... ) 
```

我怎样才能做到这一点？

我想要的输出：

```
[
  'A1' => [1 => 50, 2 => 0,   3 => 0, 4 => 0, 5 => 0, 6 => 0, 7 => 0, 8 => 0, 9 => 0, 10 => 0],
  'A2' => [1 => 50, 2 => 100, 3 => 0, 4 => 0, 5 => 0, 6 => 0, 7 => 0, 8 => 0, 9 => 0, 10 => 0],
  'A3' => [1 => 0,  2 => 0,   3 => 0, 4 => 0, 5 => 0, 6 => 0, 7 => 0, 8 => 0, 9 => 0, 10 => 0]
] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:44:38.750

啊，我明白你现在要做什么了。

试试这个

```
$totals = array();

// First get our totals.
foreach ($mainArray as $subKey => $subArray) {
    foreach ($subArray as $k => $v) {
        // Add the column to our total.
        $totals[$k] = isset($totals[$k]) ? $totals[$k] + $v : $v;
    }
}

$answers = array();
// Then build our answers.
foreach ($mainArray as $subKey => $subArray) {
    $answers[$subKey] = array();
    foreach ($subArray as $k => $v) {
        $answers[$subKey][$k] = ($v * 100) / $totals[$k];
    }
}

print_r($answers); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-08-25T22:00:06.963

达斯汀的答案是产生了很多*除零*警告，所以我想我会花时间写下自己的答案。

由于示例输入数组具有相等长度的子数组，因此我不会费心，`isset()`只需相信`array_column()`从第一行调用将访问所有可用值。

首先，`foreach()` `$v`声明但未使用，因为`array_column()`它与其他垂直数据一起收集。 `$column_totals`是和的一维数组。

因为必须对多维输入数组的每个元素进行单独的计算，所以使用了两个循环。

在执行计算之前，检查“当前值”和“列和值”是否为零值可以快速返回`0`（并避免警告）；否则使用 OP 的公式。

*对于那些不熟悉[运算顺序的人](https://www.mathsisfun.com/operation-order-bodmas.html)，公式中不需要括号，因为从左到右阅读表达式将保持与`*`and的逻辑`/`。

代码：（演示）

```
$array = [
    'A1' => [1 => 1, 2 => 0, 3 => 0, 4 => 0, 5 => 0, 6 => 0, 7 => 0, 8 => 0, 9 => 0, 10 => 0],
    'A2' => [1 => 1, 2 => 1, 3 => 0, 4 => 0, 5 => 0, 6 => 0, 7 => 0, 8 => 0, 9 => 0, 10 => 0],
    'A3' => [1 => 0, 2 => 0, 3 => 0, 4 => 0, 5 => 0, 6 => 0, 7 => 0, 8 => 0, 9 => 0, 10 => 0]
];

foreach (current($array) as $k => $v) {
    $column_totals[$k] = array_sum(array_column($array, $k));
}

foreach ($array as $key => $row) {
    foreach ($row as $k => $v) {
        $result[$key][$k] = (!$v || !$column_totals[$k]) ? 0 : $v * 100 / $column_totals[$k];
    }
}
var_export($result); 
```

输出：

```
array (
  'A1' => 
  array (
    1 => 50,
    2 => 0,
    3 => 0,
    4 => 0,
    5 => 0,
    6 => 0,
    7 => 0,
    8 => 0,
    9 => 0,
    10 => 0,
  ),
  'A2' => 
  array (
    1 => 50,
    2 => 100,
    3 => 0,
    4 => 0,
    5 => 0,
    6 => 0,
    7 => 0,
    8 => 0,
    9 => 0,
    10 => 0,
  ),
  'A3' => 
  array (
    1 => 0,
    2 => 0,
    3 => 0,
    4 => 0,
    5 => 0,
    6 => 0,
    7 => 0,
    8 => 0,
    9 => 0,
    10 => 0,
  ),
) 
```

# ruby-on-rails - 如何为rails编写黄瓜（最佳实践）。功能和步骤

> ID：13484399
> 
> 赞同：8
> 
> 时间：2012-11-21T00:12:11.067
> 
> 标签：ruby-on-rails, ruby, rspec, cucumber, capybara

我目前正在尝试学习黄瓜以及如何正确利用它。在搜索最佳实践时，大多数旧方法都被描述了，我还没有真正找到一个好的指南。我读到了新的方法，但我对最佳实践有一些问题。

以下是我一直在研究的一些基本黄瓜场景。

```
Scenario: Unsuccessful login
    Given a user has an account
    When the user tries to log in with invalid information
    Then the user should see an log in error message

Scenario: Successful login
   Given a user has an account
   When the user logs in
   Then the user should see an log in success message
   And the user should see a sign out link

Scenario: Successful logout
   Given a signed in user
   Then the user logs out
   And the user should see an log out success message 
```

我想知道这样可以吗？如果我应该写成“我访问”或“用户访问”或“他访问”，我有问题 基本上首选什么？

其次，我想知道我应该如何制定以下内容：

```
Scenario: Visit profile of user
  Given a user
  And a second user
  When the user visit the user profile
  Then the user should see the name of the user

Scenario: Visit profile of another user
  Given a user
  And a second user
  When the user visit the second users profile
  Then the user should see the name of the second user 
```

这只是我放在一起的东西，但我觉得这不是最好的方法。我在步骤定义文件中遇到问题。您将如何定义处理场景的步骤？我想写一些更笼统的东西，但也许真的不可能？我应该有一个@second_user 属性还是你有什么建议？

```
def user
  @user ||= FactoryGirl.create :user
end

Given /^a signed in user$/ do
  user
  sign_in(@user.email, @user.password)
end

Given /^a user has an account$/ do
  user
end

When /^the user logs in$/ do
  sign_in(@user.email, @user.password)
end

When /^the user logs out$/ do
  click_link ('Sign out')
end

When /^the user tries to log in with invalid information$/ do
  sign_in("incorrect-email", "incorrect-password")
end

Then /^the user should see a sign out link$/ do
  page.should have_link('Sign out')
end

Then /^the user should see an log in success message$/ do
  should have_success_message('Signed in successfully.')
end

When /^the user should see an log out success message$/ do
  should have_success_message('Signed out successfully.')
end

Then /^the user should see an log in error message$/ do
  should have_error_message('Invalid email or password.')
end 
```

谢谢你的协助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T22:26:37.357

> 如果我应该写成“我访问”或“用户访问”或“他访问”，我有问题 基本上首选什么？

我认为使用“当用户访问时”之类的内容会更通用并且更具可读性，因为您不必一直思考“谁是'他'？” 如果您正在阅读测试，真正重要的是您在所有文件中都遵守一些约定，这样您就不会感到困惑。

关于您是否创建@second_user 的第二个问题，我认为您不应该，因为该用户不完全是您的场景的一部分，因为它是数据设置，我认为处理数据设置的最佳方法是使用[pickle with cucumber](https://github.com/ianwhite/pickle)，它基本上允许你在你的 cucumber 中创建模型，而不必将它们作为变量保留，[RailsCast 上有一个很好的演员](http://railscasts.com/episodes/186-pickle-with-cucumber)可以解释很多。

所以我会用泡菜来做这个

```
Scenario: Visit profile of another user
  Given a user exists with name: "Mike", username: "mike"
  And a signed in user
  When the user visits the profile of "mike"
  Then the user should see 'Mike' 
```

那么你可以定义

```
When /^the user visits the profile of (.+)$/ do |username|
  visit("/#{username}") # I am assuming here usernames are unique and the profile url is "/:username"
end 
```

# android - 视图从片段中神秘消失

> ID：13484401
> 
> 赞同：1
> 
> 时间：2012-11-21T00:12:22.587
> 
> 标签：android, android-fragments

在我的 android 应用程序中，每个屏幕都扩展了一个**Fragment**，我使用 MVC 架构在它们之间导航。

实施拖放后，我有 2 个片段给我带来问题。我的 Fragment 由一个 ListView 和另一个位于顶部的较小的 View 组成。我已经做到了，所以如果您单击较小的列表视图，您可以上下拖动 Y 轴。如果它被拖过某个点，它将通过**Controller**类转换到另一个屏幕/片段。如果您释放并且它没有超过“过渡阈值”，那么它将返回到其原始状态。

**问题**

我可以一遍又一遍地上下拖动它，它会继续完美地重置到其原始位置，然后随机地 - 当我重置位置时，我拖动的视图消失了。列表视图在那里，但较小的视图不在那里。

帮助调试这个。一旦神秘消失发生，我打印出顶视图控制器的坐标、可见性等。坐标与他们应该的完全一样。一切正常，除了在屏幕上，它应该在的地方有一个大的黑色空隙。

当我到达阈值的另一侧并开始在片段之间来回交易时，这个问题就会扩大，这个问题也开始发生。但我认为这是同样的问题。

**问题**

1.  在android中是否有一种强制重绘/绘制视图的可靠方法？我尝试了各种这些都没有运气。我错过了什么吗？

2.  这很常见吗？我错过了一些简单的东西吗？

任何帮助都会很棒。如果您需要更多信息，请告诉我:)

~ 丹

# mysql - MySQL 导入 - 保留 ID 号

> ID：13484403
> 
> 赞同：0
> 
> 时间：2012-11-21T00:12:48.523
> 
> 标签：mysql, ruby-on-rails-3

我有一个 Rails 应用程序，它创建发票并从名为 adusers 的表中填充 invoice.approver_id。

我们有一个每晚运行的批处理脚本，用于从 AD csv 转储文件填充 adusers 表。

在自动 MySQL 导入期间，如何保留 adusers ID，以便我的发票记录保留正确的approver_id (aduser.id)？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T00:15:30.663

如果您将一个块传递给您的 create 方法，您可以在那里强制设置主 ID。例如：

```
Product.create!(:name => row[:name]) {|p| p.id = row[:id]}) 
```

# prolog - 序言否定 \+

> ID：13484407
> 
> 赞同：0
> 
> 时间：2012-11-21T00:14:09.583
> 
> 标签：prolog, negation

有四个篮子，每个篮子都有独特的颜色。我编写了一个序言程序来根据一些事实和规则来告诉颜色顺序。这是 .pl 文件：

```
iright(L, R, [L | [R | _]]).
iright(L, R, [_ | Rest]) :- iright(L, R, Rest).
nextto(L, R, List) :- iright(L, R, List).
nextto(L, R, List) :- iright(R, L, List).

myprogram(Data) :-     =(Data, [_,red,_,_]), 
\+nextto(red,blue,Data), % blue is not next to red
iright(red,green,Data), %green is right to red
member(red,Data),
member(blue,Data),
member(green,Data),
member(yellow,Data). 
```

iright 和 nextto 谓词是正确的。我的查询是`myprogram(Data)`，我希望结果应该是

```
Data = [yellow,red, green, blue]?
yes 
```

但实际上提示表明

```
| ?- myprogram(Data).

no 
```

我知道问题在于否定，但不知道如何以及为什么。请帮忙。

当我使用`trace.`

```
 1    1  Call: myprogram(_16) ? 
      2    2  Call: \+nextto(red,blue,[_46,red,_50,_52]) ? 
      3    3  Call: nextto(red,blue,[_46,red,_50,_52]) ? 
      4    4  Call: iright(red,blue,[_46,red,_50,_52]) ? 
      5    5  Call: iright(red,blue,[red,_50,_52]) ? 
      5    5  Exit: iright(red,blue,[red,blue,_52]) ? 
      4    4  Exit: iright(red,blue,[_46,red,blue,_52]) ? 
      3    3  Exit: nextto(red,blue,[_46,red,blue,_52]) ? 
      2    2  Fail: \+nextto(red,blue,[_46,red,_50,_52]) ? 
      1    1  Fail: myprogram(_16) ? 

(2 ms) no 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T00:43:48.070

如果将 移到`\+nextto(red, blue, Data)`的最后一行`myprogram`，它会起作用。

这有点不直观，但您需要考虑一下 Prolog 如何评估表达式以及否定的真正含义。否定的意思是“这不可能是真的”，而不是“对于一组特定的值不可能是真的”。如果您将程序简化为：

```
 myprogram(Data) :-
    =(Data, [_,red,_,_]),
    \+nextto(red,blue,Data). 
```

你仍然会得到一个`No.`. 这是因为，根据您的声明，Data**可以** `[_, red, blue, _]`- 您会在`Exit: iright(red,blue,[red,blue,_52])`. Prolog 尝试回溯，但它没有其他可以尝试的方法 - 您尚未将任何 _s 限制为具有特定值。

如果，OTOH，您将所有 nextto、member 和 iright 语句放在否定语句之前，那么当它到达否定表达式时，有多种可能的解决方案（嗯，两个）可以尝试：`Data = [blue,red,green,yellow]`和`Data = [yellow,red,green,blue]`。此时，当它看到否定时，它会“丢弃”红色与蓝色相邻的“分支”，但它能够回溯并具有使否定为真的可能的世界状态。也就是说：

```
myprogram(Data) :-
    =(Data, [_,red,_,_]),
    iright(red,green,Data),
    member(red,Data),
    member(blue,Data),
    member(green,Data),
    member(yellow,Data),
    \+nextto(red,blue,Data). 
```

...给你想要的结果。

*TL;DR* - Prolog 中的否定（和削减，当你遇到它们时）比你最初想象的要强大得多。在使用它们之前，请确保您首先弄清楚了其他所有内容。

# c# - 这个显示逻辑应该存在于 ViewModel 中还是映射层中？

> ID：13484408
> 
> 赞同：3
> 
> 时间：2012-11-21T00:14:20.460
> 
> 标签：c#, asp.net, .net, asp.net-mvc

我最近开始了一个 MVC 项目，现在似乎每 5 分钟我就面临着关于如何使用这个东西的重大关键设计决策。总是这样，对吧？

我决定将我的领域模型类完全排除在视图之外；它会导致大量看起来相似的 ViewModel，但使用 AutoMapper 我认为这不会是一个问题，而且我认为这是一个很好的干净方法。

然而，我最近的辩论围绕着显示逻辑。假设我有一个`MyData`具有 type 属性的模型`Status`。这是一个像下面这样的枚举：

```
public enum Status {
   Ok,
   NotTooGreat,
   CouldBeBetter,
   Awful
} 
```

在一个视图中，当我渲染这个模型时，我想输出状态并根据情况的严重程度另外为输出着色。例如，如果是`Ok`，我将显示绿色，如果是`NotTooGreat`或`CouldBeBetter`不是黄色，否则显示红色`Awful`。

这个逻辑应该在哪里？最终，颜色选择本身将在视图中（例如，确定要输出的 css 类，该类控制颜色），但确定状态是什么是我认为不应该出现在视图中的决定。可能的选项是：

1.  在自定义 ViewModel 类中使用 DataAnnotations，例如

    ```
    public class MyDataViewModel {
        /* Amongst other MyData properties required... */
        public StatusViewModel Status; 
    }

    public enum StatusViewModel {
        [StatusDisplay(DisplayState.Ok)]
        Ok,
        [StatusDisplay(DisplayState.Warning)]
        NotTooGreat,
        [StatusDisplay(DisplayState.Warning)]
        CouldBeBetter,
        [StatusDisplay(DisplayState.Error)]
        Awful
    } 
    ```

    这意味着我的映射相当愚蠢，只能按值映射枚举。然后，视图将依赖 HtmlHelper 根据 DataAnnotation 更改输出。这看起来相当简单，但是这是否在 ViewModel 中放置了太多的“业务”逻辑？也就是说，这不只是一个 UI 问题，因此 ViewModel 定义显示状态是完全有效的吗？我可能会以这种方式最终获得大量自定义 DataAnnotations 吗？如果我还需要说明用户可以根据当前状态执行哪些操作，这些是否会变得臃肿？

2.  保持 ViewModel 简单，并依靠 Mapping 代码来容纳逻辑：

    ```
    public class MyDataViewModel {
         /* Amongst other MyData properties required... */
         public string StatusText; 
         public DisplayState Status;
    } 
    ```

    这意味着 ViewModel 不知道什么状态与什么 DisplayState 相关联，它只知道可能存在哪些不同的 DisplayState（即 Ok、Warning 或 Error）。然而，这需要将逻辑放在映射代码中，这对我来说并不像是“映射”——直到现在，模型 + 视图模型之间的映射一直是控制器非常直接的调用——但也许这是一种不必要的恐惧？

3.  这*应该*在视图中，ViewModel 应该与 Model 保持相同，然后 View 或 HtmlHelper 中的一些代码将根据是什么来决定输出什么类`Status`。

我认为我倾向于数字 1，但我会欣赏其他人的观点。想到的一件事是，这是一个非常简单的示例，但是如果视图要复杂得多怎么办？比如说，如果`MyData`状态为`Ok`，我们想从模型中向用户显示更多属性`MyData`，或者也从其他模型类中提取数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T06:59:08.267

对于这种特殊情况，我认为 3\. 更容易 -`Status`在视图模型上保留一个枚举属性并有一个自定义帮助器来格式化它。我不喜欢 1\. 因为您正在复制相同的枚举，并且最终可能会得到大量数据注释。似乎没有必要。

顺便说一句 2\. 似乎也是一个不错的选择。您不应该担心将转换放入映射逻辑中。

# ruby-on-rails - 如何使用 pik 在 Windows 中创建 gemsets？

> ID：13484414
> 
> 赞同：1
> 
> 时间：2012-11-21T00:14:47.223
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, pik

我正在使用 Windows 机器并想安装 pik（类似于 RVM）来管理不同版本的 ruby​​ 和 rails。但是据我所知，pik 目前没有像我们使用 RVM 那样创建 gemset 的工具。在这种情况下，如何在 Windows 中创建 gemsets 来捆绑我的 gems。如果 pik 支持这样的功能，那么请指导我完成它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T01:06:02.670

有一些解决方法可以使用 pik 处理 gemsets。这可能会帮助您：

[https://github.com/vertiginous/pik/issues/16#issuecomment-3515658](https://github.com/vertiginous/pik/issues/16#issuecomment-3515658)

# actionscript-3 - AS3，基本的 OOP，我猜？

> ID：13484420
> 
> 赞同：1
> 
> 时间：2012-11-21T00:15:54.843
> 
> 标签：actionscript-3, oop

好的，我有一些关于我猜是基本 OOP 的问题。例如，假设我有许多具有不同类的不同对象。比方说，一个名为汽车 (Car.as) 的对象，然后我有一辆卡车 (truck.as) 和一辆轻便摩托车 (moped.as)。现在不是在所有这些中编写一个简单的函数，我不能有一个类，然后将这个函数附加到这些对象的每个人上吗？

例如，我希望它们能够淡出。然后我有一个名为“AlphaThings”的类，在这个类中我编写了一个简单的淡出函数。

我不能以某种方式将此功能附加到另一个对象吗？喜欢

```
AlphaThings.fadeout(car);
AlphaThings.fadeout(truck);
AlphaThings.fadein(moped); 
```

谢谢，如果有一些拼写错误的单词，请见谅。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T00:39:32.727

您正在尝试完成继承，这是一个类从另一个类继承属性和方法的地方。

继承是通过`extends`在定义类时使用关键字来完成的。

您的三个对象`Car`，`Truck`并且`Moped`可以像这样继承（扩展）`AlphaThings`：

```
class Car extends AlphaThings
{
    //
} 
```

您`Car`现在将包含在 中定义的所有属性和方法，`AlphaThings`例如您提到的。`.fadein()``.fadeout()`

**奖金信息**：

当您扩展另一个类时，您可以更改基类中现有的方法在从它继承的类中的工作方式。这是使用`override`关键字完成的。

例如，您可能希望您`Car`在使用它时做一些稍微不同或额外`.fadein()`的事情，因此您可以像这样覆盖该方法：

```
override public function fadein():void
{
    // Some additional logic.
    // ...

    super.fadein();
} 
```

该行`super.fadein()`用于调用原始`.fadein()`函数。如果您忽略它，您可以完全重写该函数并忽略先前定义的操作。

**关于这个特定场景**：

*这个答案当然切中要害，通过解释如何实现继承*来直接回答问题。话虽如此，您可以使用少数其他路线之一更干净地完成您想要实现的目标。

例如，考虑[Greensock 的 Tweening Library](https://www.greensock.com/tweenlite/)。该库可以以不同的方式处理任何对象上的任何值（包括 alpha）的转换。以下是一些示例，说明为什么这与使用继承相比更好：

1.  该库与您的实际对象完全分开。
2.  该库可以随心所欲地变得强大，而不会使所有其他游戏对象变得比它们需要的更重。例如，您会注意到可以使用多种类型的过渡样式（例如缓出、缓入等）——想象一下，如果所有这些都是您的基础对象的一部分。
3.  您可以使用该库定位任何内容，这意味着您无需`AlphaThings`从示例扩展即可使用它。
4.  如果您决定不再需要它或者您找到了更好的东西，那么与另一个库分离或交换是相对容易的。
5.  您可以在项目中轻松地重复使用该库，而不必从新项目中提取代码片段`AlphaThings`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T00:18:24.960

您将在父类中声明您想要的行为，然后从中派生 Car、Truck 和 Moped。然后他们会得到方法。

以下链接更详细地解释了它：http: [//help.adobe.com/en_US/ActionScript/3.0_ProgrammingAS3/WS5b3ccc516d4fbf351e63e3d118a9b90204-7fcd.html](http://help.adobe.com/en_US/ActionScript/3.0_ProgrammingAS3/WS5b3ccc516d4fbf351e63e3d118a9b90204-7fcd.html)

# c# - 如何在 WPF 中绘制一个可点击的矩形

> ID：13484423
> 
> 赞同：3
> 
> 时间：2012-11-21T00:16:23.457
> 
> 标签：c#, wpf, events, xaml

我是 WPF 应用程序的绝对初学者，需要一些帮助。我要做的就是从 A 点到 B 点绘制一个矩形，**并且**能够检测何时单击该矩形。因此，当它被点击时，它变成黄色，再次点击时，它变成红色。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T00:48:45.447

有多种方法可以做到这一点。

1.  向矩形添加一个单击处理程序，并从后面的代码中切换其颜色
2.  将矩形的颜色绑定到视图模型属性，并使用委托命令在单击时设置该属性。

如果您刚开始使用 XAML，第一个是最简单的（尽管如果您想坚持 MVVM，建议使用 #2）。

```
 <Rectangle x:Name="rect" 
    Width="100" Height="100" Fill="Aquamarine" 
    MouseLeftButtonDown="Rectangle_MouseLeftButtonDown" /> 
```

和代码隐藏处理程序：

```
 bool toggle = false;

 private void Rectangle_MouseLeftButtonDown(object sender, MouseButtonEventArgs e)
 {
     rect.Fill = new SolidColorBrush(toggle ? Colors.Aquamarine : Colors.DarkRed);
     toggle = !toggle;
 } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-21T00:49:05.157

使用`Rectangle`控件。

```
<Rectangle
    Height="100"
    Width="100"
    MouseLeftButtonUp="Rectangle_MouseLeftButtonUp_1" 
```

where`Rectangle_MouseLeftButtonUp_1`是包含类的事件处理程序。

请注意，除非 Rectangle 有背景，否则您必须单击边框。背景可以是白色的，但如果它是可点击的，它确实需要指定。

# c# - SQL 注入攻击可以通过 SqlCommand 以外的任何方式执行吗？

> ID：13484426
> 
> 赞同：20
> 
> 时间：2012-11-21T00:16:41.160
> 
> 标签：c#, asp.net, .net, sql-server, security

如果我有一个具有 SQL Server 数据库的 ASP.NET Web 应用程序，是否可以安全地假设如果要进行 SQL 注入攻击，它将通过`SqlCommand`该类的实例？

背景：

我的情况是，我继承了一个相当大的 Web 应用程序，该应用程序具有一些 SQL 注入漏洞。通过查看其他问题的代码，我发现了几个，但我想知道找到所有 SQL 注入漏洞的安全方法是否是搜索所有文件的实例，`SqlCommand`然后检查它们是否是参数化查询。这是一个可靠的计划吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-21T00:25:22.407

我不会专门寻找SqlCommand - 代码**可以**使用 DBCommand 或 IDbCommand。它可以封装在 EF、L2S 或 NHibernate 等 ORM 中（都提供某种级别的原始访问）。它可以使用“dapper”或 simple.data 之类的东西。或数据表/数据适配器。您可能有使用旧版 OLEDB 或 ADODB 访问的代码。哎呀，据我们所知，您可以编写自己的低级 TDS API。

所以：它归结为检查数据访问代码，这可能有多种形式。如果您的部门方法是“直接使用 SqlCommand”，那么情况就会改变。

此外：SQL 注入不限于 .NET - 例如，**即使**您参数化，您也可以在原始命令文本或存储过程中创建 SQL 注入风险，如果 TSQL 执行任何类型的连接以生成动态 SQL，则通过 EXEC 调用。请注意， sp_executesql 可以提供帮助。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-21T00:24:19.423

根据您的数据库架构，您可能还需要检查存储过程中的攻击（假设您使用的是存储过程）。我见过人们在他们的代码中使用参数化存储过程，但在 proc 中他们只使用 EXEC 来查询：

```
CREATE PROC Dummy
(
   @Str VARCHAR(50)
)
AS
EXEC ('SELECT * FROM Table Where Column = ''' + @Str + '''') 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-11-21T00:19:10.407

您还需要寻找*使用*或*包含*`SqlCommand`. 其中包括`SqlDataAdapter`，等等。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-11-21T00:20:13.927

仅仅因为您使用的是参数化查询库并不意味着它使用得当。在审核代码时，我看到了使用参数化查询的情况，但查询的某些部分仍然使用字符串连接构建。更具体地说，查询的表名和限制/顺序部分是常见错误。

如果您完全专注于静态分析，最好的办法是对应用程序中的所有查询进行 grep，然后确保每个查询都正确构建。是的，这将需要很长时间，而且可能会让人麻木。休息一下，做笔记，然后继续。当您发现 sql 注入时，它将获得回报！

# android - 具有编辑模式的 EditText

> ID：13484435
> 
> 赞同：2
> 
> 时间：2012-11-21T00:17:34.557
> 
> 标签：android, android-edittext

我需要一个可编辑的文本区域，其功能与 Android 上的 Google Drive 应用程序中的文本区域非常相似。有谁知道如何执行 Google Drive 文本区域正在执行的操作？

特征：

*   不调出键盘但显示光标的查看模式
*   当您移动光标时，光标会显示编辑操作
*   编辑模式也可以通过 ActionBar 中的编辑动作触发
*   编辑模式会显示完成/丢弃模式之类的内容，其中包含格式化操作列表
*   按“完成”退出编辑模式

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-23T05:01:09.660

好吧，我目前正在研究与此类似的东西。

为编辑选项定义一个 xml 布局，即。完成、撤消、重做、缩进和格式化。然后使用片段类扩充此视图。我实现了一个内部接口，以允许我的主要活动监听来自片段的点击事件。

```
package com.aesop.systems.top_bar;

import com.aesop.systems.cerulean.R;
import com.aesop.systems.utils.Frag;

import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.ViewGroup;
import android.widget.LinearLayout;
import android.widget.ImageView;

public class TopBarEditor extends Frag implements OnClickListener {

private LinearLayout save;
private ImageView undo, redo, indent, outdent, code_in;

private EditorTopBarListener listen;

@Override
public View onCreateView(LayoutInflater inf, ViewGroup con, Bundle bundy) {
    root = inf.inflate(R.layout.top_bar_editor, con, false);
    loadContent();
    return root;
}

@Override
public void loadContent() {
    save = (LinearLayout) findViewById(R.id.save);
    save.setOnClickListener(this);

    undo = (ImageView) findViewById(R.id.undo);
    undo.setOnClickListener(this);
    redo = (ImageView) findViewById(R.id.redo);
    redo.setOnClickListener(this);
    indent = (ImageView) findViewById(R.id.indent);
    indent.setOnClickListener(this);
    outdent = (ImageView) findViewById(R.id.outdent);
    outdent.setOnClickListener(this);
    code_in = (ImageView) findViewById(R.id.code_in);
    code_in.setOnClickListener(this);
}

@Override
public void onClick(View cl) {
    if(listen != null)
    {
        if(save == cl)
        {
            listen.onSave();
        }
        else if(undo == cl)
        {
            listen.onUndo();
        }
        else if(redo == cl)
        {
            listen.onRedo();
        }
        else if(outdent == cl)
        {
            listen.onOutdent();
        }
        else if(indent == cl)
        {
            listen.onIndent();
        }
        else if(code_in == cl)
        {
            listen.onCodeIn();
        }
    }
}

public interface EditorTopBarListener
{
    public void onSave();
    public void onUndo();
    public void onRedo();
    public void onIndent();
    public void onOutdent();
    public void onCodeIn();
}

public void addEditorTopBarListener(EditorTopBarListener list) { listen = list; } 
```

}

上述类是从 Frag 扩展而来的；我为模仿普通自定义视图而制作的类。它的代码如下。需要查看根目录才能轻松找到视图并受到保护，以便扩展类仍然可以引用它。出于这个原因，必须在片段膨胀时定义它。即 root = inf.inflate(R.layout.top_bar_editor, con, false);

```
public abstract class Frag extends Fragment {

    protected View root;

    public View findViewById(int id)
    {
        return root.findViewById(id);
    }

    public abstract void loadContent();

} 
```

在您的主要活动中，将 OnFocusChangedListener 添加到 EditText。

```
editText1.setOnFocusChangeListener(new OnFocusChangeListener() {
        @Override
        public void onFocusChange(View v, boolean hasFocus) {
            if(hasFocus) toggleEditorBar();
            else toggleDefaultBar();
        }
    }); 
```

然后通过切换编辑器特定片段来处理 EditText 焦点变为编辑模式时的操作。如果它失去焦点返回默认栏。在我的例子中，片段的“持有者”是一个带有 id R.id.topbar 的 LinearLayout。要切换使用方便的方法，例如。

```
public void toggleDefaultBar()
{
    getFragmentManager().beginTransaction().replace(R.id.top_bar, default_bar).commit();
}

public void toggleEditorBar()
{
    getFragmentManager().beginTransaction().replace(R.id.top_bar, editor_bar).commit();
} 
```

切换和 onFocusChangedListener 应该在您的主要活动中实现，并且如果您选择制作一个，还应该实现自定义界面。如果不这样做，那么在从片段返回根视图时，您必须手动为主 Activity 类中的每个添加 onClickListeners。我还没有尝试过的一个小例子可以这样做。. .

```
 TopBarEditor edit = new TopBarEditor(Activity.this);

   ImageView undo = (ImageView) edit.findViewById(R.id.undo);
   undo.setOnClickListener(this);   // if the activity implements a listener 
```

这样做会进一步导致可读性问题，而且更容易，我发现实现一个自定义接口，以便您明确知道从实现的接口方法调用了什么。

希望我有所帮助，我为篇幅道歉，但这不会是一个快速实施的过程，我认为这种类型的问题越多越好。

-克里斯

# php - 在 PHP 中比较两个图像

> ID：13484436
> 
> 赞同：0
> 
> 时间：2012-11-21T00:17:50.963
> 
> 标签：php

我想在 PHP 中比较两个图像。如果它们的相似度为 95% 或以上，那么结果应该只是显示文本 Yes。如果它们不相似，则结果应该为否。所以

```
if ( ) 
{
echo "Yes";
}
else
{
echo "No";
} 
```

无论如何，这是我到目前为止所发现的。[http://pastebin.com/wgeu2DqE](http://pastebin.com/wgeu2DqE) 我想告诉你我在哪里找到它，但你必须注册。

现在我有这个功能来加载图像

```
function LoadPNG($imgname)
{
    /* Attempt to open */
    $im = @imagecreatefrompng($imgname);

    /* See if it failed */
    if(!$im)
    {
        /* Create a blank image */
        $im  = imagecreatetruecolor(150, 30);
        $bgc = imagecolorallocate($im, 255, 255, 255);
        $tc  = imagecolorallocate($im, 0, 0, 0);

        imagefilledrectangle($im, 0, 0, 150, 30, $bgc);

        /* Output an error message */
        imagestring($im, 1, 5, 5, 'Error loading ' . $imgname, $tc);
    }

    return $im;
} 
```

我一直在尝试在我的记事本++ 和 phpdesigner 上想出一些东西，但我得到了错误。我不是 php 开发人员，所以我向你们寻求帮助。我只需要比较两个图像和是或否。所以这很容易。我也看到了这一点，但无法理解。

[在php中比较2张图片](https://stackoverflow.com/questions/3270929/compare-2-images-in-php)

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T00:37:37.437

您可以通过多种方式进行比较，具体取决于您想要的比较类型和用例。“相似”是一个非常模糊的术语。

有图像比较库，或者您可以使用 ImageMagick 函数。[OpenCV](https://github.com/mgdm/OpenCV-for-PHP)甚至还有一个与 PHP 一起使用的绑定。

当然，方法越复杂，结果就越灵活，效果也越好。

如果您要比较两个应该相等但不相等的图像（例如，两个监控摄像头框架），您可以使用下面给出的 DIY 方法。

如果色调和亮度出现失真（例如噪点），那么 DIY 方法将不起作用，但 ImageMagick 会产生良好的效果。

最后，如果您尝试映射同一对象的两个视图，例如从将一只脚向左平移的相机，或者您正在寻找另一个“内部”的图像等，那么 OpenCV 是唯一可行的替代方案他们三个。

**对于最简单的情况**，自己动手做的方法可能是首先检查两个图像的纵横比，然后将两者缩小到相同的大小（您可以进一步缩小它们（例如，比例 1:4）以过滤消除小的差异和/或减少前面的工作）。

此时，您可以使用逐像素比较两个图像`getColorAt`（也可以选择转换为灰度以忽略色调差异）。两个像素之间的距离也可以通过多种方式计算（例如使用[CIE 感知函数](http://en.wikipedia.org/wiki/Color_difference)），或者您可以使用欧几里得距离 - SQRT((r1-r2)* *2 + (g1-g2)* *2 + (b1-b2 )**2)。

距离范围可以从 0 到 W*H*255*SQRT(3)；您可以将这些值线性映射到 0-100% 的范围内。

这可以很容易地告诉您图像与在其上绘制了一些线条的同一图像之间的区别。如果您扭曲图像（例如使用“捏合”滤镜）或稍微旋转它，生成的图像将出现 95%，甚至 99% 相同，但该算法很可能会报告非常低的匹配（对于照片质量的图片, 连续的音调，匹配还是不错的。对于卡通，它会很差）。

# php - 在用户输入日期和时间时修改 mysql DB

> ID：13484449
> 
> 赞同：0
> 
> 时间：2012-11-21T00:19:00.187
> 
> 标签：php, mysql

我正在使用 php 和 mysql 开发一个测验 Web 应用程序，我有一个用户表和测验表，管理员可以访问一个带有测验名称的表和一个复选框，除了每个测验...

假设有 10 个测验，编号从 1 到 10，每个测验对应于 mysql 中的一个测验，

当您单击测验旁边的复选框并点击发送时，特定用户可以使用该特定测验（在我已经选择的前一页上）但是在同一页面上我想输入带有时间和日期的输入字段，并且该测验仅在当前时间到输入日期和时间之间可用....

用户表对于每个名为 is_available 的测验都有一个列，默认为零，我希望在选择该用户和测验时将该值更改为 1，并在日期过去后更改回零。

我一直在考虑如何做到这一点，但我不知道去哪里或如何开始这样做的任何想法或指导？我需要heeeelp！呵呵

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T00:24:21.740

好吧，您将从一个包含所有字段的表单开始，以及一个指向与您的数据库通信的另一个 PHP 脚本的操作。然后，另一个 PHP 脚本将读取表单数据（通过 $_POST 或 $_GET）并与数据库通信。然后它将基于此输出标记，形成输出页面。

那是一般的骨架。如果你想要具体的细节，我建议你尽可能多地实现，即使它是一个框架，然后发布它，这会给其他人更多的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T03:32:37.717

您可以使用`MySQL`、`PHP`和[`CRON`](http://en.wikipedia.org/wiki/Cron)

首先，创建一个关系表 -

```
CREATE TABLE `test_expiry` (
    `userid` int(2) unsigned NOT NULL,  // user that is taking the test
    `testid` int(2) unsigned NOT NULL,  // test number
    `expires` datetime NOT NULL);  // date/time test will expire
       //change names/types as needed / to match your db structure 
```

其次，当设置`is_available`= 1时，将该测试添加到`test_expiry`表中

```
INSERT INTO `test_expiry` (`userid`,`testid`,`expires`) VALUES (:userid,:testid,:expires) 
```

`is_available`第三，如果日期/时间已经过去，则创建一个将更新 = 0 的 php 页面。

```
SELECT `userid`, `testid` FROM `test_expiry` WHERE `expires` < NOW()
foreach row above ...
UPDATE `tests` SET `is_available` = 0 WHERE `userid` = :userid AND `testid` = :testid 
```

最后，设置一个 cron 作业-

```
* * * * *  [/path/to/php/]php /path/to/your/script/update.php 
```

# php - 将逗号分隔的喜欢字符串拆分为较小的部分

> ID：13484453
> 
> 赞同：0
> 
> 时间：2012-11-21T00:19:47.003
> 
> 标签：php, facebook, string, loops

将逗号分隔的 50++ 数字（FB 页面 ID）列表拆分成更小的块并一次处理它们的最佳方法是*什么*？该列表将如下所示：

```
$likeslist="266037406871517,81337462601,34782298000891,56859608486,8797601255,48126111909968,8807449704,3634204295,6840064056,16627954050,7581229254,282681243370,356780606553962,207549746039055,13708123117519,204852972922619,407056596017784,584207664985882,11141618921610,66707529019,271953746236343,9576298621,40575497158,29252725868524,210237443769975,469586875072133,32693104762450,262744428996,506144412803606,52385706779438"; 
```

因为 $likeslist 中的总数会有所不同（可能是数百个），所以使用 explode 或 substr_count 获得我们正在处理的总数是否更快？（**问题1**）

```
$likesarray = explode(",", $likeslist);
$result = count($likeslist); 
```

或者

```
$listtotal = substr_count($likeslist, ",") +1; 
```

那么，如何将 $likeslist 分成更小的组（例如 5 个）并遍历每个组中的每个 ID？（**问题2**）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T00:43:09.977

使用多维数组。

```
$likes = explode(",", $likesList);
$l5 = array(); // multi-dimensional array containing arrays of only 5 likes
$i = 0; // counter for how many items we have per sub-array
$c = 0; // counter for what index of $l5 we are on
foreach($likes as $l) {
    if ( $i >= 5 ) {
        $c++; // increment array index
        $i = 0; // reset counter for the next 5 entries
    }
    $l5[$c][] = $l;
    $i++;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T00:53:25.323

继续做一个大阵列。它必须非常大才能耗尽所有内存（并且您可以在配置中更改内存限制）。

要处理列表的各个部分，只需使用循环和`array_slice()`函数：

```
$likeslist = explode(',', $likeslist);    
$listLen = count($likeslist);
$chunkSize = 5;

for($offset=0; $offset<$listLen; $offset+=$chunkSize) {
    $subList = array_slice($likeslist, $offset, $chunkSize);
    // do whatever to your sublist 
    print_r($subList);
} 
```

# ruby-on-rails-3 - 在 Rails 3 中创建时重定向到父记录？

> ID：13484454
> 
> 赞同：1
> 
> 时间：2012-11-21T00:20:02.430
> 
> 标签：ruby-on-rails-3, routes, action

在我的简单 Rails 3 应用程序中，两个模型之间存在 has_one、has_many 关系。我在创建时将“所有者”的 ID 传递给孩子：

**动物模型**

```
has_many :claims, :foreign_key => 'animal_id'
has_many :conditions, :foreign_key => 'animal_id' 
```

**索赔模型**

```
has_one :animal, :foreign_key => 'PVID'
has_many :payments, :dependent => :destroy 
```

**支付模式**

```
belongs_to :claim 
```

我分别使用隐藏表单将 animal_id 和 claim_id 传递给索赔和支付模型。

我想做的是在创建时将用户重定向到父模型。因此，例如：

如果用户正在创建新的索赔，索赔表单将自动插入 animal_id。重定向回动物记录的正确方法是什么？

```
format.html { redirect_to claim_animal_path, notice: 'Claim was successfully created.' } 
```

任何指针将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T01:35:08.603

根据您的路线文件，`animal_path`助手将接受动物的 id。就像是

```
format.html { redirect_to animal_path @claim.animal.id, notice: 'Claim was successfully created.' } 
```

可能会工作。

# php - Google Drive SDK：从云端硬盘返回的空文件数组

> ID：13484462
> 
> 赞同：1
> 
> 时间：2012-11-21T00:20:44.660
> 
> 标签：php, drupal, google-drive-api

我在使用 Drive SDK 时遇到了一些问题。我正在尝试将我的 Google Drive 帐户中的所有文件导入我的应用程序。我觉得我正在做 Drive SDK 文档告诉我做的所有事情，但是每次我去抓取文件时，我都会返回一个空数组......并且没有错误。我使用 SDK 作为服务帐户，所以设置有点不同。顺便说一句，我的网站正在运行 drupal。这是我的代码：

1）首先，我构建服务（这是一个名为的函数的主体`buildService()`：

```
$key = PATH_TO_KEY_FILE;
if (file_exists($key)) {

    try {
        $auth = new Google_AssertionCredentials(
                        SERVICE_ACCOUNT_EMAIL,
                        array(DRIVE_SCOPE),
                        $key);

        $client = new Google_Client();
        $client->setUseObjects(true);
        $client->setAssertionCredentials($auth);

    } catch (Exception $e) {
        print "An error occurred: " . $e->getMessage();
    }

    return new Google_DriveService($client);

}
else{
   return "can't find key file';
} 
```

这个块完全没问题，我从 Google_DriveService 得到一个对象

2）另一边，我抓住服务对象，并尝试列出驱动器文件：

```
$parameters = array();
$service = buildService();  //my function from step 1
$files = retrieveAllFiles($service, $parameters); 
```

3）这是`retrieveAllFiles`函数（直接来自SDK文档）：

```
function retrieveAllFiles($service, $parameters) {

    $result = array();
    $pageToken = NULL;

    do {
        try { 
            if ($pageToken) {
                $parameters['pageToken'] = $pageToken;
            }
            $files = $service->files->listFiles($parameters); 
            $result = array_merge($result, $files->getItems()); 
            $pageToken = $files->getNextPageToken();

        } catch (Exception $e) {
            print "An error occurred: " . $e->getMessage();
            $pageToken = NULL;
        }
     } while ($pageToken);

     return $result;

} 
```

正如我所说，我得到了一个空结果，没有错误，什么都没有。

关于为什么我的结果为空的任何想法？

非常感谢任何帮助或建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T01:12:42.037

在您提供的代码中，您访问的是服务帐户本身的 Google Drive，而不是您域中特定用户的 Google Drive。服务帐户的 Google Drive 很可能是空的，因此得到一个空的文件数组是预期的结果。

如果您尝试访问您域中特定用户的 Google 云端硬盘并按照[说明如何设置 Google Apps 域范围内的授权委托](https://developers.google.com/drive/delegation)的文档进行操作，则您缺少一行：

```
$auth->prn = $userEmail; 
```

这是您为您尝试模拟的域的用户设置电子邮件的地方。然后，您将访问该用户的 Google Drive 数据。

# objective-c - 在 cellForRowAtIndexPath 中获取 cell.contentView 高度以创建渐变背景

> ID：13484463
> 
> 赞同：0
> 
> 时间：2012-11-21T00:20:53.287
> 
> 标签：objective-c, ios, uitableview

我有表格视图，其中每个单元格都有渐变背景，并且当单元格大小相同时它可以工作。我对另一个数据集和可变单元格大小使用相同的表格视图。如果我将渐变代码放在自定义单元格的 initwithcoder 中，那么它会为原始单元格的大小创建一个渐变。我尝试了不同的东西，但无法获得合适的尺寸。唯一的答案是在 cellForRowAtIndexPath 内部创建一个临时框架，其中单元格的高度来自基于文本计算它的方法。我试图弄清楚为什么 cellForRowAtIndexPath 内的单元格高度不正确。这是使其更清晰的代码。

```
 - (UITableViewCell *)tableView:(UITableView *)tableView
             cellForRowAtIndexPath:(NSIndexPath *)indexPath
                            object:(PFObject *)object 
    { 
        static NSString *CellIdentifier = @"feedCell";
        FeedTableViewCell *cell = (FeedTableViewCell *) [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
        if (cell == nil) {
            cell = [[FeedTableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
        }
        [[cell.contentView viewWithTag:999]removeFromSuperview];
        // Configure the cell...
        UIFont *cellFont = [UIFont fontWithName:@"Helvetica" size:16.0];
        cell.signText.font = cellFont;
        CGRect lblFrame = cell.signText.frame;
        lblFrame.size.height = [self labelHeightForText:[object objectForKey:@"text"]];
        cell.signText.frame = lblFrame;
        cell.signText.lineBreakMode = NSLineBreakByWordWrapping;
        cell.signText.text = [object objectForKey:@"text"];
        UIColor *grayLightOp = [UIColor colorWithRed:0.863 green:0.841 blue:0.812 alpha:1.000];
        CAGradientLayer *gradient = [CAGradientLayer layer];
//here is the tempFrame that i am talking about i can't just set tempFrame = cell.contentView.frame
        CGRect tempFrame = CGRectMake(cell.contentView.frame.origin.x, cell.contentView.frame.origin.y, cell.contentView.frame.size.width, [self labelHeightForText:[object objectForKey:@"text"]]);
        gradient.frame = tempFrame;
        gradient.colors = [NSArray arrayWithObjects:(id)[UIColor whiteColor].CGColor, (id)grayLightOp.CGColor, nil];
        UIView *backgroundView = [[UIView alloc]initWithFrame:gradient.frame];
        backgroundView.tag = 999;
        [backgroundView.layer insertSublayer:gradient above:0];
        [cell.contentView insertSubview:backgroundView atIndex:0];
        [cell.backgroundView setNeedsDisplay];
        return cell;
    }

    -(CGFloat)labelHeightForText:(NSString *)text
    {
        UIFont *cellFont = [UIFont fontWithName:@"Helvetica" size:16.0];
        CGSize constraintSize = CGSizeMake(280.0f, MAXFLOAT);
        CGSize labelSize = [text sizeWithFont:cellFont constrainedToSize:constraintSize lineBreakMode:NSLineBreakByWordWrapping];
        return labelSize.height + 20;
    }

    - (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
    {
        PFObject *feedObject = [self objectAtIndexPath:indexPath];
        NSString *cellText = [feedObject objectForKey:@"text"];
        return [self labelHeightForText:cellText];
    } 
```

======更新我在 cellForRowAtIndexPath 中注释掉了渐变的创建，这是来自自定义单元格的代码。我想我必须调整渐变本身而不是背景视图的大小。当我这样做时，渐变大小是正确的，但是当我滚动时，我会看到当单元格出现时正在绘制渐变的快速动画。我能做点什么吗？

```
@interface FeedTableViewCell()

@property (nonatomic, strong)CAGradientLayer *cellGradient;

@end

@implementation FeedTableViewCell

@synthesize signText = _signText;
@synthesize personName = _personName;
@synthesize personImageView = _personImageView;
@synthesize cellGradient = _cellGradient;

- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier
{
    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
    if (self) {
        // Initialization code
    }
    return self;
}
-(id)initWithCoder:(NSCoder *)aDecoder
{
    self = [super initWithCoder:aDecoder];

    if (self) {
        UIColor *grayLightOp = [UIColor colorWithRed:0.863 green:0.841 blue:0.812 alpha:1.000];
        self.cellGradient = [CAGradientLayer layer];

        self.cellGradient.frame = self.contentView.frame;
        self.cellGradient.colors = [NSArray arrayWithObjects:(id)[UIColor whiteColor].CGColor, (id)grayLightOp.CGColor, nil];
        UIView *backgroundView = [[UIView alloc]initWithFrame:self.cellGradient.frame];
        backgroundView.tag = 998;
        [backgroundView.layer insertSublayer:self.cellGradient above:0];
        self.backgroundView = backgroundView;
        //[self.layer insertSublayer:gradient atIndex:0];

    }
    return self;
}

-(void)layoutSubviews
{
    [super layoutSubviews];

    [CATransaction begin];
    [CATransaction setDisableActions:YES];
    self.cellGradient.frame = self.contentView.frame;
    [CATransaction commit];
} 
```

// 用没有背景视图的新代码更新

```
-(id)initWithCoder:(NSCoder *)aDecoder
{
    self = [super initWithCoder:aDecoder];

    if (self) {
        UIColor *grayLightOp = [UIColor colorWithRed:0.863 green:0.841 blue:0.812 alpha:1.000];
        CAGradientLayer *gradient = [CAGradientLayer layer];
        gradient.frame = self.frame;
        gradient.colors = [NSArray arrayWithObjects:(id)[UIColor whiteColor].CGColor, (id)grayLightOp.CGColor, nil];
        /*UIView *backgroundView = [[UIView alloc]initWithFrame:gradient.frame];
        [backgroundView.layer insertSublayer:gradient above:0];
        self.backgroundView = backgroundView;
        [backgroundView.layer insertSublayer:gradient atIndex:0];*/
        [self.layer insertSublayer:gradient atIndex:0];
    }
    return self;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T04:27:42.660

这里发生了很多事情，但在这种情况下，您的框架原点是错误的。您将渐变的位置设置为 contentView 位置，但该位置是相对于 contentView 的父级的，而您真正想要的是在 contentView*内部*从 0,0 开始。您可以将`contentView.bounds`其用作框架，因为它只为您提供大小，位置为 0。

我要检查的另一件事是在渐变视图上自动调整掩码大小，以防在 tableview 将新框架应用于单元格时它没有调整大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T07:42:47.120

最好在单元格的 init 方法中创建一次渐变层。在单元格的方法中调整它的大小`layoutSubviews`（首先调用`super`）。

您现在这样做的方式会导致滚动性能不佳，因为您每次都在重新创建渐变层。

您更新的问题中的代码几乎可以，但是您可以看到渐变调整大小的动画。这是因为您正在更改 CALayer 的动画属性 - 这些更改默认情况下是动画的。您可以通过将更改包装在 CATransaction 中并禁用隐式动画来防止这种情况：

```
-(void)layoutSubviews
{
    [super layoutSubviews];
    NSArray *layers = [self.backgroundView.layer sublayers];
    CAGradientLayer *gradient = [layers objectAtIndex:0];

    [CATransaction begin];
    [CATransaction setDisableActions:YES];
    gradient.frame = self.contentView.frame;
    [CATransaction commit];

} 
```

# c# - AutoFixture/AutoMoq 忽略注入的实例/冻结模拟

> ID：13484471
> 
> 赞同：12
> 
> 时间：2012-11-21T00:21:41.003
> 
> 标签：c#, unit-testing, autofixture, automocking

**找到解决方案后的简短内容：**

AutoFixture 返回冻结的模拟就好了；我的 sut 也是由 AutoFixture 生成的，它只有一个公共属性，该属性具有对测试很重要的本地默认值，并且 AutoFixture 设置为新值。从马克的回答中可以学到很多东西。

**原始问题：**

我昨天开始为我的 xUnit.net 测试开始尝试 AutoFixture，这些测试中都有 Moq。我希望替换一些 Moq 的东西或使它更易于阅读，我对在 SUT Factory 容量中使用 AutoFixture 特别感兴趣。

我用 Mark Seemann 的一些关于 AutoMocking 的博客文章武装自己，并尝试从那里开始工作，但我并没有走得太远。

这是我的测试在没有 AutoFixture 的情况下的样子：

```
[Fact]
public void GetXml_ReturnsCorrectXElement()
{
    // Arrange
    string xmlString = @"
        <mappings>
            <mapping source='gcnm_loan_amount_min' target='gcnm_loan_amount_min_usd' />
            <mapping source='gcnm_loan_amount_max' target='gcnm_loan_amount_max_usd' />
        </mappings>";

    string settingKey = "gcCreditApplicationUsdFieldMappings";

    Mock<ISettings> settingsMock = new Mock<ISettings>();
    settingsMock.Setup(s => s.Get(settingKey)).Returns(xmlString);
    ISettings settings = settingsMock.Object;

    ITracingService tracing = new Mock<ITracingService>().Object;

    XElement expectedXml = XElement.Parse(xmlString);

    IMappingXml sut = new SettingMappingXml(settings, tracing);

    // Act
    XElement actualXml = sut.GetXml();

    // Assert
    Assert.True(XNode.DeepEquals(expectedXml, actualXml));
} 
```

这里的故事很简单 - 确保使用正确的键（硬编码/属性注入）`SettingMappingXml`查询`ISettings`依赖项并将结果作为`XElement`. 仅当`ITracingService`出现错误时才相关。

我试图做的是摆脱显式创建`ITracingService`对象然后手动注入依赖项的需要（不是因为这个测试太复杂，而是因为它足够简单，可以尝试并理解它们）。

输入 AutoFixture - 第一次尝试：

```
[Fact]
public void GetXml_ReturnsCorrectXElement()
{
    // Arrange
    IFixture fixture = new Fixture();
    fixture.Customize(new AutoMoqCustomization());

    string xmlString = @"
        <mappings>
            <mapping source='gcnm_loan_amount_min' target='gcnm_loan_amount_min_usd' />
            <mapping source='gcnm_loan_amount_max' target='gcnm_loan_amount_max_usd' />
        </mappings>";

    string settingKey = "gcCreditApplicationUsdFieldMappings";

    Mock<ISettings> settingsMock = new Mock<ISettings>();
    settingsMock.Setup(s => s.Get(settingKey)).Returns(xmlString);
    ISettings settings = settingsMock.Object;
    fixture.Inject(settings);

    XElement expectedXml = XElement.Parse(xmlString);

    IMappingXml sut = fixture.CreateAnonymous<SettingMappingXml>();

    // Act
    XElement actualXml = sut.GetXml();

    // Assert
    Assert.True(XNode.DeepEquals(expectedXml, actualXml));
} 
```

我希望`CreateAnonymous<SettingMappingXml>()`，在检测到`ISettings`构造函数参数后，会注意到已经为该接口注册了一个具体实例并注入了它——但是，它并没有这样做，而是创建了一个新的匿名实现。

这尤其令人困惑，因为`fixture.CreateAnonymous<ISettings>()`确实返回了我的实例-

```
IMappingXml sut = new SettingMappingXml(fixture.CreateAnonymous<ISettings>(), fixture.CreateAnonymous<ITracingService>()); 
```

使测试完全绿色，这条线正是我期望 AutoFixture 在实例化`SettingMappingXml`.

然后是冻结组件的概念，所以我只是将模拟冻结在夹具中，而不是获取模拟对象：

```
fixture.Freeze<Mock<ISettings>>(f => f.Do(m => m.Setup(s => s.Get(settingKey)).Returns(xmlString))); 
```

果然这工作得很好——只要我明确地调用`SettingMappingXml`构造函数并且不依赖`CreateAnonymous()`.

简而言之，我不明白为什么它会以明显的方式工作，因为它违背了我能想到的任何逻辑。通常我会怀疑库中存在错误，但这是一个非常基本的东西，我相信其他人会遇到这个问题，而且它早就被发现并修复了。更重要的是，知道 Mark 对测试和 DI 的孜孜不倦的态度，这不可能是无意的。

这反过来意味着我必须错过一些相当基本的东西。如何让 AutoFixture 创建我的 SUT，并将预配置的模拟对象作为依赖项？我现在唯一确定的是我需要 .`AutoMoqCustomization`所以我不必为`ITracingService`.

AutoFixture/AutoMoq 包是 2.14.1，Moq 是 3.1.416.3，都来自 NuGet。.NET 版本为 4.5（与 VS2012 一起安装），在 VS2012 和 2010 中的行为相同。

在写这篇文章时，我发现有些人在使用 Moq 4.0 和程序集绑定重定向时遇到问题，所以我仔细清除了我的解决方案中的任何 Moq 4 实例，并通过将 AutoFixture.AutoMoq 安装到“干净”项目中来安装 Moq 3.1。但是，我的测试行为保持不变。

感谢您的任何指示和解释。

**更新：**这是 Mark 要求的构造函数代码：

```
public SettingMappingXml(ISettings settingSource, ITracingService tracing)
{
    this._settingSource = settingSource;
    this._tracing = tracing;

    this.SettingKey = "gcCreditApplicationUsdFieldMappings";
} 
```

为了完整起见，该`GetXml()`方法如下所示：

```
public XElement GetXml()
{
    int errorCode = 10600;

    try
    {
        string mappingSetting = this._settingSource.Get(this.SettingKey);
        errorCode++;

        XElement mappingXml = XElement.Parse(mappingSetting);
        errorCode++;

        return mappingXml;
    }
    catch (Exception e)
    {
        this._tracing.Trace(errorCode, e.Message);
        throw;
    }
} 
```

`SettingKey`只是一个自动属性。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-22T09:22:22.133

假设该`SettingKey`属性定义如下，我现在可以重现该问题：

```
public string SettingKey { get; set; } 
```

发生的情况是注入到 SettingMappingXml 实例中的[测试](http://xunitpatterns.com/Test%20Double.html)`SettingKey`替身非常好，但是因为它是可写的，所以 AutoFixture 的自动属性功能会启动并修改值。

考虑这段代码：

```
var fixture = new Fixture().Customize(new AutoMoqCustomization());
var sut = fixture.CreateAnonymous<SettingMappingXml>();
Console.WriteLine(sut.SettingKey); 
```

这会打印出这样的内容：

> 设置Key83b75965-2886-4308-bcc4-eb0f8e63de09

即使正确注入了所有测试替身，`Setup`也没有满足方法中的期望。

有很多方法可以解决这个问题。

**保护不变量**

解决此问题的正确方法是使用单元测试和 AutoFixture 作为反馈机制。这是[GOOS](http://amzn.to/SM8Yv0)的关键点之一：单元测试的问题通常是设计缺陷的症状，而不是单元测试（或 AutoFixture）本身的错误。

在这种情况下，它向我表明[该设计不够万无一失](http://blog.ploeh.dk/2011/05/26/CodeSmellAutomaticProperty.aspx)。客户可以随意操纵它真的合适`SettingKey`吗？

作为最低限度，我会推荐这样的替代实现：

```
public string SettingKey { get; private set; } 
```

随着这种变化，我的复制通过了。

**省略设置键**

如果您不能（或不会）更改您的设计，您可以指示 AutoFixture 跳过设置`SettingKey`属性：

```
IMappingXml sut = fixture
    .Build<SettingMappingXml>()
    .Without(s => s.SettingKey)
    .CreateAnonymous(); 
```

就个人而言，我发现`Build`每次需要特定类的实例时都必须编写表达式会适得其反。您可以将`SettingMappingXml`实例的创建方式与实际实例化解耦：

```
fixture.Customize<SettingMappingXml>(
    c => c.Without(s => s.SettingKey));
IMappingXml sut = fixture.CreateAnonymous<SettingMappingXml>(); 
```

为了更进一步，您可以将该`Customize`方法调用封装在[Customization](http://blog.ploeh.dk/2011/03/18/EncapsulatingAutoFixtureCustomizations.aspx)中。

```
public class SettingMappingXmlCustomization : ICustomization
{
    public void Customize(IFixture fixture)
    {
        fixture.Customize<SettingMappingXml>(
            c => c.Without(s => s.SettingKey));
    }
} 
```

这需要您`Fixture`使用该自定义创建实例：

```
IFixture fixture = new Fixture()
    .Customize(new SettingMappingXmlCustomization())
    .Customize(new AutoMoqCustomization()); 
```

一旦你获得了两个或三个以上的自定义链，你可能会厌倦一直编写那个方法链。是时候将这些自定义封装到您的特定库的一组约定中了：

```
public class TestConventions : CompositeCustomization
{
    public TestConventions()
        : base(
            new SettingMappingXmlCustomization(),
            new AutoMoqCustomization())
    {
    }
} 
```

这使您能够始终`Fixture`像这样创建实例：

```
IFixture fixture = new Fixture().Customize(new TestConventions()); 
```

这`TestConventions`为您提供了一个中心位置，您可以在需要时偶尔修改测试套件的约定。它减少了单元测试的可维护性税，并有助于保持生产代码的设计更加一致。

最后，由于您使用的是 xUnit.net，因此您可以使用[AutoFixture 的 xUnit.net 集成](http://blog.ploeh.dk/2010/10/08/AutoDataTheoriesWithAutoFixture.aspx)，但在此之前，您需要使用一种不那么强制性的方式来操作`Fixture`. 事实证明，创建、配置和注入`ISettings`Test Double 的代码非常地道，以至于它有一个名为[Freeze](http://blog.ploeh.dk/2010/03/17/AutoFixtureFreeze.aspx)的快捷方式：

```
fixture.Freeze<Mock<ISettings>>()
    .Setup(s => s.Get(settingKey)).Returns(xmlString); 
```

有了这些，下一步就是定义一个自定义的 AutoDataAttribute：

```
public class AutoConventionDataAttribute : AutoDataAttribute
{
    public AutoConventionDataAttribute()
        : base(new Fixture().Customize(new TestConventions()))
    {
    }
} 
```

您现在可以将测试简化为基本要素，摆脱所有噪音，使测试能够简洁地表达仅重要的内容：

```
[Theory, AutoConventionData]
public void ReducedTheory(
    [Frozen]Mock<ISettings> settingsStub,
    SettingMappingXml sut)
{
    string xmlString = @"
        <mappings>
            <mapping source='gcnm_loan_amount_min' target='gcnm_loan_amount_min_usd' />
            <mapping source='gcnm_loan_amount_max' target='gcnm_loan_amount_max_usd' />
        </mappings>";
    string settingKey = "gcCreditApplicationUsdFieldMappings";
    settingsStub.Setup(s => s.Get(settingKey)).Returns(xmlString);

    XElement actualXml = sut.GetXml();

    XElement expectedXml = XElement.Parse(xmlString);
    Assert.True(XNode.DeepEquals(expectedXml, actualXml));
} 
```

**其他选项**

要使原始测试通过，您也可以完全关闭 Auto-properties：

```
fixture.OmitAutoProperties = true; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T02:50:43.433

在第一个测试中，您可以`Fixture`使用以下应用创建类的实例`AutoMoqCustomization`：

```
var fixture = new Fixture()
    .Customize(new AutoMoqCustomization()); 
```

然后，唯一的变化是：

**步骤1**

```
// The following line:
Mock<ISettings> settingsMock = new Mock<ISettings>();
// Becomes:
Mock<ISettings> settingsMock = fixture.Freeze<Mock<ISettings>>(); 
```

**第2步**

```
// The following line:
ITracingService tracing = new Mock<ITracingService>().Object;
// Becomes:
ITracingService tracing = fixture.Freeze<Mock<ITracingService>>().Object; 
```

**第 3 步**

```
// The following line:
IMappingXml sut = new SettingMappingXml(settings, tracing);
// Becomes:
IMappingXml sut = fixture.CreateAnonymous<SettingMappingXml>(); 
```

而已！

* * *

下面是它的工作原理：

在内部，`Freeze`创建一个请求类型的实例（例如`Mock<ITracingService>`），然后*注入*它，这样当您再次请求它时它总是会返回该实例。

> 这就是我们在`Step 1`和中所做的`Step 2`。

在我们请求一个依赖于and`Step 3`的类型的实例。由于我们使用 Auto Mocking，该类将为这些接口提供模拟。但是，我们之前已经*注入*了它们，因此现在会自动提供已经创建的模拟。`SettingMappingXml``ISettings``ITracingService``Fixture`*`Freeze`*

# java - 明星算法，异常行为

> ID：13484473
> 
> 赞同：0
> 
> 时间：2012-11-21T00:21:53.873
> 
> 标签：java, algorithm, a-star

我正在为大学的计算机游戏项目编写明星算法。老实说，我担心一旦我提到大学，我就会有任何响应者向西走，我也承认我用来处理的二维节点数组的大小非常大，宽度 = 800 &高度 = 800 我已经设法让它得到最好的工作。但是我遇到了一个有趣的错误

```
if (!diagonalMovementAllowed) {
                            if ((x != 0) && (y != 0)) {
                                continue;
                            }
                        } 
```

如果没有下面的代码，我可以从任何坐标找到目标，只要它在二维数组的范围内，但是如果我使用上面的代码，算法似乎无法达到目标，如果开始或目标距离相当大，例如

如果目标 x = 700 & y = 700 并且如果开始 x = 0 & y = 700，没问题

但是，如果目标 x = 700 & 目标 y = 700 并且如果 start x = 690 & y = 720 似乎找不到路径

我的问题是 arrayList (open 或 closedList) 是否可以达到一个点，它根本找不到目标并且已经达到了一个非常高的大小以至于它只是退出并且有没有办法识别导致这种情况的原因，而无需遍历每个 x和 y 使用调试器进行协调？

我确实觉得这是一个相当模糊的问题，但我希望我能得到一个一般性的答案，因为我觉得很多人不会太倾向于引导我完成整个解释，特别是因为我确实提到了它的一个项目我的讲师似乎什么都知道。我希望我能得到一些建议和答案，并提前致谢。

编辑：回答以下2个问题（感谢您的快速回复）

```
for(int x = -1; x < 2; x++){
     for(int y = -1; y < 2; y++){

    if (!diagonalMovementAllowed) {
          if ((x != 0) && (y != 0)) {
              continue;
          }
        }
int neighborX = x + current.x;
int neighborY = y + current.y;
      }
    } 
```

上面的代码是其中的一部分，我显然不想全部发布，因为我的讲师可能会因为获得太多帮助而对我开枪（或失败），但要解释上面的内容

当 openList 不为空时，循环遍历 x 和 yx = x -1 或 x = x +1 y = y -1 或 y = y +1 的邻居

0,0 0,1 0,2 1,0 1,1 1,2 2,0 2,1 2,2 如果你在 1,1（开始）并且你不想要对角线运动，那么以下应该被允许 (0,0) (2,0) (2,2) 或 (0,2) 这是通过阻止 x 和 y 不等于 0 来实现的

```
neighborX = x + current.x
  1       = 0 + 1
 neighborY = y + current.y
   2         1 + 1
(1,2)

neighborX = x + current.x
  1       = 0 + 1
 neighborY = y + current.y
  0        -1 + 1
(1,0)

neighborX = x + current.x
  2       = 1 + 1
 neighborY = y + current.y
  0        -1 + 1
(2,0)

neighborX = x + current.x
  0       = -1 + 1
 neighborY = y + current.y
  0        -1 + 1
(0,0) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T00:54:00.190

我假设您的代码片段是后继生成逻辑的一部分。不幸的是，我认为逻辑不正确：

```
if (!diagonalMovementAllowed) {
    if ((x != 0) && (y != 0)) {
        continue;
    }
} 
```

当不允许对角线移动时，这将防止从内部位置（不在 x==0 列或 y==0 行中的位置）生成任何后继。

如果我对您的代码的假设是正确的，这就是为什么当起始位置类似于 x = 690 & y = 720 时找不到解决方案 - 起始位置没有后继！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T00:28:48.547

我相信达到大小限制会导致错误并停止程序，所以我认为这不是问题。我不太了解您的代码段：您能否包含更多上下文（x，y 与是否允许对角线移动有什么关系？）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T00:29:18.610

800 的大小本身并不“大”，它对你来说只是大。800万时回来：P。

只要您有足够的内存来处理它， ArrayList 的大小应该不是问题。我建议你的算法有问题。如果您可以发布更多代码，我相信有人会有想法。

# opencv - OpenCV中像素值的上下限和类型是什么？

> ID：13484475
> 
> 赞同：6
> 
> 时间：2012-11-21T00:22:34.167
> 
> 标签：opencv

OpenCV中像素值的上限和下限是多少，如何获取它们？

我能弄清楚的唯一限制是`CV_8U`Mat类型，通道中像素值的下限是0，上限是255。其他Mat的这些值是多少？

说CV_32F，CV_32S？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-21T09:30:52.980

OpenCV 等效 C/C++ 数据类型：

`CV_8U`-> `unsigned char`（最小值 = 0，最大值 = 255）

`CV_8S`-> `char`（最小值 = -128，最大值 = 127）

`CV_16U`-> `unsigned short`（最小值 = 0，最大值 = 65535）

`CV_16S`-> `short`（最小值 = -32768，最大值 = 32767）

`CV_32S`-> `int`（最小值 = -2147483648，最大值 = 2147483647）

`CV_32F`->`float`

`CV_64F`->`double`

查看[本教程](http://www.cplusplus.com/doc/tutorial/variables/)了解数据类型范围。

需要考虑的一件事是，在显示类型为`CV_32F`or`CV_64F`的图像`imshow`时`cvShowImage`，OpenCV 期望值在 0.0 和 1.0 之间进行归一化。否则，它会使像素值饱和。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T00:52:23.257

CV_32F 表示 32 位浮点数。CV_32S 表示 32 位有符号整数。我相信你可以猜到 CV_64F 代表什么。[互联网上有很多关于不同数据类型可以采用的](http://answers.yahoo.com/question/index?qid=20080503144541AAqrW0D)范围的参考资料，例如 32S。

# curl - curl：多部分 POST 的每个文件内容类型（YouTube API）

> ID：13484478
> 
> 赞同：28
> 
> 时间：2012-11-21T00:22:50.037
> 
> 标签：curl, youtube-api

我正在尝试使用 curl 批量上传到 YouTube，遵循[此处](https://developers.google.com/youtube/2.0/developers_guide_protocol_direct_uploading#Sending_a_Direct_Upload_API_Request)的 API 规范；简而言之，它需要一个多部分的 POST 请求，其中包含 XML 格式的元数据和 Content-Type `application/atom+xml; charset=UTF-8`，然后是视频数据本身。

我当前的命令行（从 upl.xml 获取元数据和从 upl.mkv 获取视频）看起来像这样：

```
curl -s -F "file=@upl.xml" -F "file=@upl.mkv" -H 'GData-Version: 2' -H 'Authorization: GoogleLogin auth=<AUTH>' -H 'Slug: upl.mkv' -H 'X-GData-Key: key=<KEY>' http://uploads.gdata.youtube.com/feeds/api/users/default/uploads 
```

当我检查发送的实际请求时`--trace`，看起来两个文件都以正确的顺序发送，但元数据的 Content-Type 设置为`application/octet-stream`; 上传按预期完成，但 YouTube 拒绝处理视频。

如果我尝试使用 , 等提交 upl.xml `--data`。`--data-ascii`我`--form-string`只会得到各种各样的其他错误，这让我相信它归结为不正确的 Content-Type。如果我忽略元数据而只发送视频文件，它可以正常工作，但不幸的是，这并不能解决我的问题。

我是否在这里遗漏了什么，如果没有，是否可以在不破坏 libcurl 的情况下做到这一点？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-11-21T10:55:04.167

首先，您可以通过添加“;type=magic/string”为您上传的部分指定内容类型。例如在您的视频案例中：

> curl -F "file=@upl.mpeg4;type=video/mpeg4" [URL]

（使用 --trace 或 --trace-ascii 来验证 curl 是否准确发送了您想要的内容）

...但是这就是说，我猜接收服务器实际上不太可能关心客户端声称的内容类型是什么。这意味着我认为您的问题的根源实际上根本不是内容类型。

# python - Python re.sub 追加字符串而不是替换它

> ID：13484481
> 
> 赞同：0
> 
> 时间：2012-11-21T00:23:25.793
> 
> 标签：python, regex

我是 Python 的新手，并且坚持使用正则表达式替换。我正在解析一个设置文件，其中包含以下语句：

```
set fmri(convolve7) 3 
```

设置文件用作模板。该脚本解析模板并使用更新的设置写入一个新的设置文件。

我的程序的主要结构是

```
for line in infile:
 if condition = true
  for each in listofelements
    if re.search(each, line):
     print(re.sub(r"\d+", "0", line), file=outfile, end='') # double output
 if re.search(somethingelse, line):
  print(re.sub(templatesubid, i, line), file=outfile, end='')# normal substitution 
```

等等

for 循环中的替换会导致双重输出，而在 for 循环之外则不会。for 循环似乎使用正确的替换字符串插入换行符，即

```
set fmri(convolve7) 0
set fmri(convolve7) 3 
```

其他替换按预期工作，但它是相同的代码。会不会是 for 循环导致了这种双重输出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T00:44:12.867

看起来相关代码在底部：

```
 for line in infile:
        if len(subparamlist) > 0:
            for j in subparamlist:
                query = j.replace(")", "\)").replace("(", "\(")
                if re.search(query, line):
                    print(re.sub(r"\d+", "0", line), file=outfile, end='') #trouble!
        if re.search(templatesubid, line) and re.search('feat_files\(', line) or re.search('\(custom', line) : # correct the subjectID
            print(re.sub(templatesubid, i, line), file=outfile, end='')
        elif re.search(str(nptslist[2]), line): # correct the number of timepoints
            print(re.sub(str(nptslist[2]), str(nvols[0]), line), file = outfile, end='')
        else: 
            print(line, file=outfile, end='') # if nothing to do, just copy the line to the new text file. 
```

我认为问题在于您在顶部`if`语句（替换`0`到该行）中打印，然后在其下`if/elif/else`方块的一个分支中再次打印。这个结果是一些（或所有）行被加倍。

我实际上并没有很好地理解代码以制定适当的修复程序，但一个可能的开始可能是将`if`您评论的“更正主题 ID”更改为`elif`.

# python - “不允许用户交互”在 python 中运行 AppleScript 时

> ID：13484482
> 
> 赞同：5
> 
> 时间：2012-11-21T00:23:27.057
> 
> 标签：python, applescript

我有一个applescript，它将显示菜单列表并允许用户选择菜单项等。它本身运行良好。现在我尝试在 python 中运行它。我得到不允许用户交互。(-1713) 错误。

我在网上看了。我尝试了以下方法：

1.  在同一个applescript中添加运行功能，所以我所做的只是将主要添加到运行中

    在运行时告诉应用程序“AppleScript Runner” main() end tell end run

2.  我试图在 python import os def main(): os.system ('osascript -e "tell application "ApplesScript Runner" do script /Users/eee/applescript/iTune.scpt end tell"')

    if **name** == ' **main** ': main() 两种方法都行不通。谁能告诉我如何正确地做到这一点？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-21T00:32:17.323

这是一个常见的错误。当您从 shell 使用 OSAScript 运行脚本时，您必须告诉应用程序显示任何“显示对话框”或“选择列表对话框”或任何需要用户交互的内容。OSAScript 无法显示它们，因此请告诉 Finder 之类的应用程序显示它们。使用这样的代码...

```
tell application "Finder"
    activate
    display dialog "Now it works!"
end tell 
```

或者从命令行通知这不起作用......

```
osascript -e 'display dialog "Now it will not work."' 
```

但这会起作用，因为我们告诉 Finder 这样做......

```
osascript -e 'tell application "Finder"' -e 'activate' -e 'display dialog "Now it works!"' -e 'end tell' 
```

所以底线是在你的 iTune.scpt 某处你正在显示一个对话框。在该脚本中，只需告诉 iTunes 或 Finder 显示它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-09T00:16:29.740

我的问题是一个应用程序`LSBackgroundOnly = YES`尝试运行显示 UI 的 AppleScript，例如`display dialog ...`

> 错误域 = NSPOSIXErrorDomain 代码 = 2“没有这样的文件或目录”
> 
> AppleScript.scpt：执行错误：不允许用户交互。(-1713)

使用`tell application "Finder" ...`or 等​​工作，如另一个答案所示。

或者，在`LSBackgroundOnly`不告诉其他应用程序的情况下删除启用 UI AppleScripts 的密钥。

`LSUIElement`呈现类似的模式 - 没有停靠图标，没有菜单栏等 - 但确实允许启动 UI AppleScripts。

# java - 在 Eclipse 和浏览器中运行时，Applet 组件在屏幕上的位置发生变化

> ID：13484485
> 
> 赞同：0
> 
> 时间：2012-11-21T00:23:38.970
> 
> 标签：java, swing, applet, components, layout-manager

我正在四处移动组件，并将它们的位置设置为其他组件的位置，但这并不准确。所以我所做的是将组件向左移动一点，然后向上移动一点来解决这个问题，但是当我在浏览器中运行它时，它关闭得更多。我该怎么办？为什么位置不准确？

编辑：通过计算组件位置的差异来修复它

# perl - 在 Perl 中“返回警告”是一种好习惯吗？

> ID：13484486
> 
> 赞同：5
> 
> 时间：2012-11-21T00:23:41.633
> 
> 标签：perl

我想检查一个条件，打印一个警告，然后用一行代码从一个子程序返回。这有效（我认为警告返回 1）：

```
return warn "can't find file" if not -f $input_file; 
```

我可以安全地做到这一点吗？或者有更好的方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-21T00:38:23.330

这是非常安全的，但它需要查看[源](http://perl5.git.perl.org/perl.git/blob/89550e55e963f08f03d979563451d5234f74be10:/pp_sys.c#l423)以确定返回的值（true），并且它没有留下可读的选项来控制返回的值。这非常重要，因为在这种情况下您通常不希望返回任何内容/undef/false，但您当前正在返回 true。

以下所有选项都允许您指定返回的值：

```
warn("can't find file"), return if !-f $input_file;

(warn "can't find file"), return if !-f $input_file;

if (!-f $input_file) { warn "can't find file"; return }

-f $input_file or warn("can't find file"), return;

-f $input_file or (warn "can't find file"), return; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-09T10:24:02.690

```
return 0 * warn "can't find file" if not -f $input_file; 
```

将返回 0，因此任何调用子程序的程序都会知道它失败了。

这将是我的懒惰版本

```
if (!-f $input_file) { warn "can't find file"; return 0; } 
```

# python - Sqlite executemany 和 DELETE

> ID：13484487
> 
> 赞同：4
> 
> 时间：2012-11-21T00:23:42.453
> 
> 标签：python, sqlite, ipython, executemany

执行许多删除似乎很慢（插入很好），我想知道是否有人知道为什么花了这么长时间

考虑下面的代码

```
import sqlite3

db = sqlite3.connect("mydb")
c = db.cursor()
c.execute("DROP TABLE IF EXISTS testing ")
c.execute("CREATE TABLE testing (val INTEGER);")
my_vals2 = [[x] for x in range(1,10000)]

def insertmany(vals):
    c.executemany("INSERT INTO testing (val) VALUES (?)",vals)
    db.commit()

def deletemany1(vals):
    c.executemany("DELETE FROM testing WHERE val=?",vals)
    db.commit()

def deletemany2(vals): #this is fastest even though im looping over to convert to strings and again to join ...
    vals = ["'%s'"%v[0] for v in vals] 
    c.execute("DELETE FROM testing WHERE val IN (%s)"%",".join(vals))
    #DELETE FROM TABLE WHERE x in (1,2,3...) 
```

以及来自 ipython 的以下时间结果（timeit 给出了有趣的数据：/）

```
%time insertmany(my_vals2) 
#CPU times: user 0.60 s, sys: 0.00 s, total: 0.60 s Wall time: 0.60 s

%time deletemany1(my_vals2)
#CPU times: user 3.58 s, sys: 0.00 s, total: 3.58 s Wall time: 3.58 s

%time deletemany2(my_vals2)
#CPU times: user 0.02 s, sys: 0.00 s, total: 0.02 s Wall time: 0.02 s 
```

为了完整起见，这里是 timeit 结果（但我认为 timeit 在第二次测试中被打破（或者 ms 是一个不同的单位，然后是第一次测试））

```
%timeit insertmany(my_vals2) 
#1 loops, best of 3: 358 ms per loop

%timeit deletemany1(my_vals2)
#1 loops, best of 3: 8.34 ms per loop  <- this is not faster than the above!!!! (timeit lies?)

%timeit deletemany2(my_vals2)
#100 loops, best of 3: 2.3 ms per loop 
```

那么，为什么 deletes 的 executemany 这么慢呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T08:16:18.400

SQLites 将表记录存储在 B+ 树中，按`rowid`.

当您使用自动生成的 插入时`rowid`，所有记录都只是附加在表的末尾。但是，删除时，SQLite 必须先搜索记录。如果`id`列没有被索引，这会很慢；要么创建一个显式索引（如 John 所提议的那样），要么将列声明为[`INTEGER PRIMARY KEY`](http://www.sqlite.org/autoinc.html)使其成为 rowid。

如果不使用索引，即仅在批量插入后创建索引，则使用索引插入会变得更快。

您的最后一个删除命令一次删除所有记录。如果您知道要删除表中的所有记录，则可以使用 just 进一步加快速度`DELETE FROM testing`，根本不需要查看任何记录。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T00:52:12.040

我只是赌一把：因为它必须彻底搜索要删除的那些。尝试使用索引并报告回来。

```
CREATE INDEX foo ON testing (val) 
```

[http://sqlite.org/lang_createindex.html](http://sqlite.org/lang_createindex.html)

# extjs - extjs 4 loadRecord() 非常慢

> ID：13484489
> 
> 赞同：3
> 
> 时间：2012-11-21T00:23:58.427
> 
> 标签：extjs

我有一个数据网格，双击网格中的任何记录，我正在导航到 formPanel，其中包含大约 100 多个显示字段。我的问题是，loadRecord 需要很长时间，接近 20 秒才能加载所有这些 100 多个显示字段。有没有更快的方法来做到这一点？非常感谢任何帮助或想法。

```
Ext.Ajax.request({

    url: someurl
    method: 'POST',
    params: {
        params: params
    },

    success: function(response) {
        var responseData = response.responseText;
        var doc = new DOMParser().parseFromString(responseData, "text/xml");
        store.loadRawData(doc);
        var formPanel = Ext.getCmp('FormPanel');
        var formPanelData = store.getAt(0);
        console.log("Its fast upto here!!");
        formPanel.getForm().loadRecord(formPanelData);
       console.log("Takes upto 20 secs to get here!!");
        var vp = Ext.getCmp('viewport');
        vp.getLayout().setActiveItem('formPanel');

    }
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T00:44:37.077

在加载期间暂停布局：

```
Ext.suspendLayouts();
form.loadRecord(foo);
Ext.resumeLayouts(true); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-17T08:15:05.737

即使在 EXTJs 4.1.3 中过滤掉 Tree Panel 中的数据

暂停布局大大提高了您的搜索速度。见下文 ：

```
applyFilterFn: function(filterCmp) {

        Ext.suspendLayouts();  // Adding by Lokesh to speed up

            var me = this;

            var root = this.getTreeStore().getRootNode();

            me.registerFilter(filterCmp);
            me.filtered = true;

            if(typeof filterCmp.beforeFilter === 'function'){
                    filterCmp.beforeFilter();
            }
            root.cascadeBy(function(node){
                    if(node.isRoot() && !me.rootVisible){ return; }//skip invisible root

                    var nid = (me.useDataIds===true)? node.data.id:node.id;

                    if(typeof me.filterNodeHash[nid]==='undefined'){
                            me.filterNodeHash[nid] = [];

                    }
                    if(filterCmp.filterFn.call(filterCmp,node)){
                            me.filterNodeHash[nid][filterCmp.id] = true;
                          "+me.filterNodeHash[nid][filterCmp.id]);

                    }else{
                            me.filterNodeHash[nid][filterCmp.id] = false;

                            //console.log("value of "+node.data.task+", "+me.filterNodeHash[nid][filterCmp.id]);
                    }
            },me);

            root.eachChild(function(childNode){
                Ext.fly(me.getNodeByRecord(childNode)).setDisplayed(true);
            });                
            root.eachChild(function(childNode){
                me.applyFilters(childNode,0); ////////added changed code
            });               
      //   console.log("root node id "+this.getTreeStore().getRootNode().getId().data.task);
            Ext.resumeLayouts(true); // put it to resume your css layouts

            if(typeof filterCmp.afterFilter === 'function'){
                    filterCmp.afterFilter();
            }

    },// applyFilterFn you may call from a differnt javascript file 
```

# javascript - 如何让元素的 innerHTML 立即更新？

> ID：13484496
> 
> 赞同：2
> 
> 时间：2012-11-21T00:24:59.080
> 
> 标签：javascript, buffer

我有一个带有文本框的网页。当在`.js`框中输入文件名并单击“执行”按钮时，给定的文件将通过 AJAX 和`eval()`'d.

此页面上还有一个空`<div>`的用作输出。如果加载的文件需要在屏幕上打印一些内容，它会将其添加到`div`.`innerHTML`

向其添加文本时，`innerHTML,`它通常不会在 Javascript 完成之前呈现在屏幕上，这很好，但有时 Javascript 文件会执行繁重的计算，可能需要一分钟才能完成，而且能够在执行时看到输出会很有用。

有没有办法“刷新”文档？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T00:30:44.783

我会尝试使用`setTimeout`.

```
function performInitialHtmlRender() {
    /// This sets the innerHtml that you want the user to see
    /// While you are performing the calculations
}

function performExpensiveCalculationsAndRender() {
    // This is the really expensive function that
    // you want to run once the browser has rendered 
    // the initial HTML
}

performInitialHtmlRender();
setTimeout(performExpensiveCalculationsAndRender(), 0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T00:26:34.250

您可以使用 setTimeout：

```
div.innerHTML = html;
setTimeout( function(){
   doHeavyCalculations();
}, 35); 
```

[http://jsfiddle.net/YKEKK/](http://jsfiddle.net/YKEKK/)

# php - php postgreSQL错误

> ID：13484498
> 
> 赞同：-3
> 
> 时间：2012-11-21T00:25:08.610
> 
> 标签：php, sql, linux, apache, postgresql

我收到错误

**警告：pg_connect() [function.pg-connect]：无法连接到 PostgreSQL 服务器：致命：主机“::1”、用户“user_bch”、数据库“test_bchOrder”没有 pg_hba.conf 条目，/home 中的 SSL 关闭/www2.mysite/connect.php 在第 8 行**

在 postgreSQL php 连接页面上。我想知道是不是因为域是 www2，所以我的主机不是'localhost'。也许是别的东西。[这](https://www.chihost.com/dedicatedservers.php)是服务器。感谢您的帮助！

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T00:38:56.943

我的评论作为答案：

您在服务器上使用 IPV6 吗？如果您不使用它，请编辑您的 /etc/hosts 并从列表中删除 ::1。否则，请确保正确配置 pg_hba.conf 以使用 IPv6

# php - 从 USB 驱动器运行 PHP/MySQL 网站

> ID：13484500
> 
> 赞同：1
> 
> 时间：2012-11-21T00:25:16.240
> 
> 标签：php, mysql, webserver, xampp, usb-drive

问题：

我有一个客户需要从 Windows 和 Mac 上的 USB 拇指驱动器运行他们的网站（使用 PHP/MySQL/Apache），如果可能的话，甚至是 Linux。因此，他们可以将 USB 拇指插入 Windows 机器并加载站点索引，或者将拇指插入 Mac 或 Linux 机器并加载站点索引。

为了进一步澄清，我的客户基本上想将这些 USB 拇指驱动器分发给他自己的客户，以便他们可以浏览一组独特的产品样本。这意味着从 USB 拇指驱动器启动网站需要尽可能简单，因为不能对客户的技术知识做出任何假设！如果不能选择自动加载，则双击即走型解决方案将是理想的选择。使用下面评论中建议的虚拟机解决方案可以实现这一点吗？或者是否需要首先在客户端计算机上安装一些软件（例如 VMware Player）才能启动 USB 上的虚拟机？

发现：

我已经设法通过 Windows 7 从 USB 拇指安装并运行 XAMPP Portable Lite，但是当将 USB 连接到 Mac / Linux 系统时，我显然无法启动 XAMPP Portable Lite。我也尝试从 USB 安装和运行 XAMPP for Mac，但它似乎无法在 Mac 的 /Applications 目录之外运行。

如果有人可以阐明一种可能的方式来实现我的客户使用 XAMPP 或其他任何东西想要的东西，或者是否有可能，我将不胜感激！

PS：我注意到有一个解决方案可以实现我的客户想要的，由一家名为 Stunnix 的公司提供，但是他们收取相当高的费用，所以我推迟了，希望在某处存在针对我的客户问题的免费软件解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:30:58.080

一般来说 - 不，您无法获得多合一的解决方案。有太大的差异，包括。这些平台上的安全方法。它在 Windows 上更简单，而在 Linux 上由于安全模型而面临更多问题（例如保护绑定到端口 <1024）。一般来说，如果这足以满足您的需求，您可能需要以虚拟化结束。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T00:27:41.053

幸运的是，PHP、MySQL 和 Apache 在所有三个平台上都运行良好。只需为两个平台包含静态编译的 x86 副本，就可以了。

现在，就自动运行问题而言，您无能为力。如今，几乎没有系统会在插入可移动媒体后自动运行可执行文件。

# c++ - 如何在 C++ 中获取 Windows 资源管理器的完整路径

> ID：13484506
> 
> 赞同：1
> 
> 时间：2012-11-21T00:26:32.377
> 
> 标签：c++, winapi, windows-explorer

我可以安全地假设 Windows 资源管理器总是从 Windows 系统目录启动吗？另外，它的进程是否总是命名为“explorer.exe”？

如果没有，如何获取其完整文件路径？

**编辑：**忘了提——我需要这个稍后找出在给定用户会话中运行的 Windows 资源管理器的进程 ID。因此我寻找它的完整路径。

**编辑2：**感谢所有做出贡献的人，尤其是sehe！在他的帖子之后，我发现[这个页面](http://msdn.microsoft.com/en-us/library/ms838576%28v=winembedded.5%29.aspx)解释了如何设置你自己的 shell。我通过用我自己的进程完全替换 explorer.exe 进行了疯狂测试，结果如下： 如果您重新调整大小，![在此处输入图像描述](../Images/dc8ed4f61a50f45280d19bc6e315c360.png) 这是[完整大小的链接。](http://i150.photobucket.com/albums/s99/dc2000_bucket/fake_windows_explorer.jpg)

正如你所看到的，我可以用我可能想出的任何进程在技术上替换 explorer.exe。正如您在我的屏幕截图中看到的那样，Windows 让我可以完全控制*Shell*（屏幕截图是我的整个窗口。）

因此，最重要的是，获取“explorer.exe”文件路径（或使用的任何 Shell 进程）的唯一方法是使用我上面引用的链接中的那些注册表项 - 非常接近 sehe 建议的内容，只需一个还有一些检查要做，但这是一个非常简单的事情。

至于 Sean Cline 的建议，只有当我们运行带有具有特定类名的托盘窗口的“普通”Windows Explorer 时，这将是一个非常优雅的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T00:40:03.867

假设 explorer.exe 始终位于 %windir% 或 %SystemRoot% 中可能是安全的，因为它已经多年没有移动了。但是，如果您尝试通过 Explorer 调用某些东西，您可能希望使用[ShellExecute](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762153%28v=vs.85%29.aspx) () 函数。

如果您确实需要该路径，获取它的最简单方法可能是使用 FOLDERID_Windows 作为第一个参数调用[SHGetKnownFolderPath ()。](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762188%28v=vs.85%29.aspx)

**编辑：** 这是我知道您正在寻找 shell 进程的 PID 的一些代码：

```
DWORD trayPID;
HWND trayWnd = FindWindow("Shell_TrayWnd", NULL);
GetWindowThreadProcessId(trayWnd, &trayPID); 
```

它查找任务栏的 hWnd 并找到拥有的 PID。您可能需要为资源管理器未运行且该窗口不存在的情况添加一些错误处理 - 不太可能，但可能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T00:46:05.997

不，您不能安全地假设这与 C++ 无关。

此外，您没有显示任何代码。开始：

用于此的注册表项是`Software\Microsoft\Windows NT\CurrentVersion\WinLogon\Shell`（请参见[此处](http://msdn.microsoft.com/en-us/library/ms838576%28v=winembedded.5%29.aspx)）。

```
#include <windows.h>
#include <malloc.h>
#include <stdio.h>
#include <string>

LONG GetStringRegKey(HKEY hKey, const std::wstring &strValueName, std::wstring &strValue, const std::wstring &strDefaultValue)
{
    strValue = strDefaultValue;
    WCHAR szBuffer[512];
    DWORD dwBufferSize = sizeof(szBuffer);
    ULONG nError;
    nError = RegQueryValueExW(hKey, strValueName.c_str(), 0, NULL, (LPBYTE)szBuffer, &dwBufferSize);
    if (ERROR_SUCCESS == nError)
    {
        strValue = szBuffer;
    }
    return nError;
}

int main()
{
    HKEY hKey;
    LONG lRes = RegOpenKeyExW(HKEY_LOCAL_MACHINE, L"Software\\Microsoft\\Windows NT\\CurrentVersion\\WinLogon", 0, KEY_READ, &hKey);
    bool bExistsAndSuccess (lRes == ERROR_SUCCESS);
    bool bDoesNotExistsSpecifically (lRes == ERROR_FILE_NOT_FOUND);
    std::wstring shell;
    GetStringRegKey(hKey, L"Shell", shell, L"");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T00:37:31.063

两者都是。Windows 资源管理器始终位于`%WINDIR%\Explorer.exe`.

# objective-c - 处理推送通知

> ID：13484510
> 
> 赞同：1
> 
> 时间：2012-11-21T00:26:45.210
> 
> 标签：objective-c, ios, notifications, push

我试图弄清楚如何导航到一堆视图

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions 
```

在收到推送通知后调用。我的视图是这样排列的，因此我有一个带有 tabcontroller 的导航控制器。选项卡控制器中的每个选项卡都是导航控制器。我正在尝试将 UIViewController 推送到 tabcontroller 内的导航控制器上。我可以设置正确的选项卡，但我似乎无法推动。有什么想法吗？

# mysql - 设计和存储货币汇率交叉表

> ID：13484511
> 
> 赞同：6
> 
> 时间：2012-11-21T00:27:01.280
> 
> 标签：mysql, sql, database, rdbms, currency

在我的例子中，我需要使用 RDBMS存储货币汇率交叉表（例如[http://www.exchangerates.org.uk/currency/currency-exchange-rates-table.html ）的值。](http://www.exchangerates.org.uk/currency/currency-exchange-rates-table.html)

用户将每天更新数据，系统将存储不同的版本。

我想知道您将如何设计表格，或者您是否想要模型。

当然，最简单的方法是使用包含 from、to 和 values 列的表

```
from: char(3)
to: char(3)
value: decimal(6,4)
inverse_value: decimal(6,4) 
```

但我很想知道是否还有其他（更好的）解决方案。

非常感谢。

**编辑**

如果不清楚，我很抱歉，但我对性能和可扩展性特别感兴趣。

保留 value/inverse_value 结构并给定 90 种货币，货币兑换交叉表每天需要 4,050 条记录。

如果每天创建一个新版本，一年内将有 1,478,250 条记录，查询*可能会*开始受到影响。

我已经实现了这个表，它工作得很好，渲染交叉表非常快，我对它很满意。

我只是想知道是否有更好的方法来实现这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T00:36:46.970

这看起来是一个好的开始，我还将添加一个日期字段（如果您每天只更新这些值，则不要添加日期时间字段）。所以也许是这样的：

```
currency_code_from: char(3)
currency_code_to: char(3)
conversion_value: decimal(6,4)
inverse_conversion_value: decimal(6,4)
effective_date: date() 
```

我不确定您计划查询表的各种方式是什么，因为这将决定您的索引要求，但我可能会在 、 和 字段中使用复合主键`currency_code_from`，`currency_code_to`然后`effective_date`根据您的特定需要添加任何索引查询。

然后，如果需要显示，您可能希望有一个与该表相关的附加表，该表存储货币名称和货币符号（如果您想使用它，也可能链接到国家标志图像）

```
currency_code: char(3)
currency_name: varchar(50)
currency_symbol: char(3)
currency_image: varchar(100) 
```

此表上的主键是currency_code。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T00:41:39.540

Marco，您可能还需要一个日期字段或一个布尔值 isCurrent，以便您可以选择最新的 ccy 转换。

你想有买卖数字吗？通常，您要确保在 ccy 的买卖之间有一点领先，以确保组织不会亏损。这被一些人称为明智的商业方法，而另一些人则称之为欺诈。

如果这些数字是手动输入的，请确保查看之前的货币数字，如果差异 > 3%，则警告用户。

唯一的另一个问题是当日汇率波动很大时。您想在宣战前只进行一次转换吗？

看来你是在正确的轨道上。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T01:03:53.947

我个人不会使用“自然”键。相反，有一个国家/货币实体表：

```
country
-------
country_id : integer not null auto_increment
name : varchar(255)
abbrev : varchar(255)
motto : varchar(255)
. . . 
```

然后使用交叉表中的 ID：

```
currency_exchange
-----------------
currency_exchange_id : integer not null auto_increment
from_country_id : integer
to_country_id : integer 
value : decimal(10,4)
inverse_value : decimal(10,4) 
```

这让我可以将国家名称更改为符号、全名等，而无需更改交叉表的定义。查询转换值时连接两个表。

另外，我选择了十进制（10,4），我建议查找可能的最大值。限制大小并稍后发现您选择的大小太小，这不值得编程更新头痛。它不会占用足够的空间来处理这些错误。与您用于名称的 varchar 相同。Varchars 被有效地存储。

另外，不是`value`总是1.00吗？（也就是说，您不总是将 1 转换为另一种货币的倒数吗？）如果是这样，您可以`value`从表中删除该列。

我个人喜欢在所有表上生成 ID 值，所以我在交叉表上放了一个，但有些人可能认为这是不必要的。后来我经常发现，当我选择省略它时，我希望我已经添加了它。

我可以看到货币名称有另一个表：

```
currency
--------
currency_id : integer not null auto_increment
country_id : integer
name : varchar(255)
symbol : varchar(255) 
```

# matlab - 带有函数的matlab脚本

> ID：13484512
> 
> 赞同：4
> 
> 时间：2012-11-21T00:27:10.043
> 
> 标签：matlab

是否可以制作一个带有函数的 Matlab 脚本，或者我应该使用 Matlab 脚本来调用我的函数？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T05:21:39.880

你应该让你的 matlab 脚本调用你的函数。它更整洁，不会再费力了。如果您打算制作大量功能，请确保您组织好文件。

# ios - iOS 检测屏幕截图？

> ID：13484516
> 
> 赞同：147
> 
> 时间：2012-11-21T00:27:27.067
> 
> 标签：ios, screenshot

App Store 上的应用程序[Snapchat](https://itunes.apple.com/us/app/snapchat/id447188370?mt=8)是一个应用程序，可让您共享带有自毁功能的图片。您只能查看图片 X 秒。如果您尝试在图片显示时使用家庭电源键组合截屏，它会告诉发件人您尝试截屏。

SDK 的哪一部分可以让您检测到用户正在截屏？我不知道这是可能的。

* * *

## 回答 #1

> 赞同：365
> 
> 时间：2013-08-10T03:55:00.540

从 iOS 7 开始，其他答案不再正确。苹果已经做到了，所以`touchesCancelled:withEvent:`当用户截屏时不再调用它。

这将有效地彻底破坏 Snapchat，因此在新解决方案中添加了几个测试版。现在，解决方案就像使用 NSNotificationCenter 向[UIApplicationUserDidTakeScreenshotNotification](https://developer.apple.com/library/ios/documentation/uikit/reference/UIApplication_Class/Reference/Reference.html)添加观察者一样简单。

这是一个例子：

## 目标 C

```
NSOperationQueue *mainQueue = [NSOperationQueue mainQueue];
[[NSNotificationCenter defaultCenter] addObserverForName:UIApplicationUserDidTakeScreenshotNotification
                                                  object:nil
                                                   queue:mainQueue
                                              usingBlock:^(NSNotification *note) {
                                                 // executes after screenshot
                                              }]; 
```

## 迅速

```
NotificationCenter.default.addObserver(
    forName: UIApplication.userDidTakeScreenshotNotification,
    object: nil,
    queue: .main) { notification in
        //executes after screenshot
} 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-01-02T10:37:59.577

我找到了答案！！截屏会中断屏幕上的任何触摸。这就是为什么 snapchat 需要按住才能看到图片。参考：[http ://tumblr.jeremyjohnstone.com/post/38503925370/how-to-detect-screenshots-on-ios-like-snapchat](http://tumblr.jeremyjohnstone.com/post/38503925370/how-to-detect-screenshots-on-ios-like-snapchat)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2015-11-27T02:43:21.563

下面是如何在 Swift 中使用闭包：

```
func detectScreenShot(action: () -> ()) {
    let mainQueue = NSOperationQueue.mainQueue()
    NSNotificationCenter.defaultCenter().addObserverForName(UIApplicationUserDidTakeScreenshotNotification, object: nil, queue: mainQueue) { notification in
        // executes after screenshot
        action()
    }
}

detectScreenShot { () -> () in
    print("User took a screen shot")
} 
```

**斯威夫特 4.2**

```
func detectScreenShot(action: @escaping () -> ()) {
    let mainQueue = OperationQueue.main
    NotificationCenter.default.addObserver(forName: UIApplication.userDidTakeScreenshotNotification, object: nil, queue: mainQueue) { notification in
        // executes after screenshot
        action()
    }
} 
```

这作为标准功能包含在：

[https://github.com/goktugyil/EZSwiftExtensions](https://github.com/goktugyil/EZSwiftExtensions)

免责声明：它是我的回购

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-09-22T08:42:30.890

**斯威夫特 4+**

```
NotificationCenter.default.addObserver(forName: UIApplication.userDidTakeScreenshotNotification, object: nil, queue: OperationQueue.main) { notification in
           //you can do anything you want here. 
        } 
```

通过使用此观察者，您可以了解用户何时截屏，但您无法阻止他。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-07-02T07:03:21.303

最新**的 SWIFT 3**：

```
func detectScreenShot(action: @escaping () -> ()) {
        let mainQueue = OperationQueue.main
        NotificationCenter.default.addObserver(forName: .UIApplicationUserDidTakeScreenshot, object: nil, queue: mainQueue) { notification in
            // executes after screenshot
            action()
        }
    } 
```

在**viewDidLoad**中，调用这个函数

```
detectScreenShot { () -> () in
 print("User took a screen shot")
} 
```

然而，

```
NotificationCenter.default.addObserver(self, selector: #selector(test), name: .UIApplicationUserDidTakeScreenshot, object: nil)

    func test() {
    //do stuff here
    } 
```

工作得很好。我没有看到 mainQueue 的任何点...

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-21T00:49:48.473

~~看起来没有直接的方法可以检测用户是否点击了`home + power button`. 根据[this](https://stackoverflow.com/a/8711894/1730272)，之前可以使用 darwin 通知，但它不再起作用。由于 snapchat 已经这样做了，我的猜测是他们正在检查 iPhone 相册以检测在这 10 秒之间是否添加了新图片，并且在某种程度上他们正在与显示的当前图像进行比较。可能会为此比较进行一些图像处理。只是一个想法，也许你可以尝试扩展它以使其工作。检查[此以获取更多详细信息](http://www.cocos2d-iphone.org/forum/topic/30730)。~~

**编辑：**

看起来他们可能正在检测 UITouch 取消事件（屏幕捕获取消触摸）并根据此博客向用户显示此错误消息：[如何在 iOS 上检测屏幕截图（如 SnapChat）](http://tumblr.jeremyjohnstone.com/post/38503925370/how-to-detect-screenshots-on-ios-like-snapchat)

在这种情况下，您可以使用`– touchesCancelled:withEvent:`方法来感知 UITouch 取消以检测到这一点。您可以在此委托方法中删除图像并向用户显示适当的警报。

```
- (void)touchesCancelled:(NSSet *)touches withEvent:(UIEvent *)event
{
    [super touchesCancelled:touches withEvent:event];

    NSLog(@"Touches cancelled");

    [self.imageView removeFromSuperView]; //and show an alert to the user
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-08-09T16:48:04.677

**斯威夫特 4 个例子**

Example #1 使用闭包

```
NotificationCenter.default.addObserver(forName: .UIApplicationUserDidTakeScreenshot, 
                                       object: nil, 
                                       queue: OperationQueue.main) { notification in
    print("\(notification) that a screenshot was taken!")
} 
```

Example #2 带选择器

```
NotificationCenter.default.addObserver(self, 
                                       selector: #selector(screenshotTaken), 
                                       name: .UIApplicationUserDidTakeScreenshot, 
                                       object: nil)

@objc func screenshotTaken() {
    print("Screenshot taken!")
} 
```

# .net - 使用wpf画布获取原始图像区域像素坐标

> ID：13484518
> 
> 赞同：1
> 
> 时间：2012-11-21T00:28:02.727
> 
> 标签：.net, wpf, canvas

我使用 WPF 图像控件进行了应用程序，并且在 Canvas 中有图像控件。我还借助“使用矩形在图像上创建搜索区域”博客在画布上绘制了矩形。

现在我有了与画布元素相关的矩形大小。

现在我需要的是如何计算上述矩形大小的图像区域坐标

# mysql - MySQL 中的转换（多对多连接）表；允许重复条目将 1 列链接到不同表中的多个其他列

> ID：13484519
> 
> 赞同：4
> 
> 时间：2012-11-21T00:28:03.863
> 
> 标签：mysql, many-to-many

好的，所以我将尝试尽可能具体，但我的 MySQL 技能相当薄弱。所以情况如下：

我有 2 张桌子：捐赠者和学生。一个捐赠者可以与他们想要的尽可能多的学生联系起来，并且每个学生可以与捐赠者想要“认领”他们的尽可能多的捐赠者联系起来。因此，如果我有学生 Sally，她可以让捐赠者 Jim 和捐赠者 Jeff 与她联系。因此，我将所有学生放在一张桌子上，将所有捐赠者放在另一张桌子上。我需要把它们放在一起，显示学生的姓名、身份证和学生所链接的所有捐赠者的身份证。

目前我的表是：DonorID、FirstName、LastName、DonorType、StreetAddress 等的捐赠者。然后是 StudentID、FirstName、LastName 和 DonorID 的学生。然而，这只允许我将一名学生与一名捐赠者联系起来。所以，我在想我需要制作一个转换表，允许我显示 StudentID、FirstName(of student)、LastName(of student) 和 DonorID，它“声称”那个学生并允许我复制 StudentID 和在同一学生的第 2、3、4 等条目中放置不同的 DonorID。

所以，我想我的问题是转换表在 MySQL 中是如何工作的？我相信我将需要使用 JOIN 函数并将两个表连接在一起，但在 tizag.com 上阅读了相关内容后，我更加困惑。我使用过 Access，当您创建转换表时，您可以从每个表中提取 PK 并使用其他表中的两个键创建复合键，但我不太确定如何在 MySQL 中执行此操作；它的工作原理是否基本相同，我应该从每个表中提取 PK 并在第三个转换表中将它们链接在一起？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T02:37:33.373

马文是对的。

您需要三张桌子才能完成此任务。

捐赠者

```
DonorID
FirstName
LastName
DonorType
StreetAddress
etc. 
```

学生

```
 StudentID
 FirstName
 LastName
 etc. 
```

然后你需要 Student_Donor。这通常称为连接表，并实现多对多关系。

```
StudentID   (PK)  (FK to Student)
DonorID     (PK)  (FK to Donor)
DonorOrdinal 
```

如果 StudentID = 5 有四个 ID = 6、7、11、15 的捐赠者，那么您将拥有这些行

```
StudentId   DonorId   DonorOrdinal
    5         6          1
    5         7          2
    5        11          3
    5        15          4 
```

DonorOrdinal 列允许您指定学生的主要捐赠者和次要捐赠者。我无法从您的问题中看出这有多重要，但能够订购这些东西会很有帮助。请记住这一点：正式地说，SQL SELECT 查询以不可预知的顺序返回行，除非您还指定了 ORDER BY。

如果你想显示你的学生和他们的捐赠者，你需要这个查询：

```
 SELECT s.StudentID, s.FirstName, s.LastName, 
             sd.DonorOrdinal, 
             d.DonorType, d.DonorID, d.FirstName, d.LastName
        FROM student s
   LEFT JOIN student_donor sd ON s.StudentID = sd.StudentID
   LEFT JOIN donor d ON sd.DonorID = d.DonorID
    ORDER BY s.StudentID, sd.DonorOrdinal, d.DonorID 
```

这将按 ID 顺序显示所有学生（无论是否有捐赠者），然后按 DonorOrdinal 顺序显示他们的捐赠者。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T00:42:39.067

是的，差不多。您所说的是多对多关系。您的捐助者表不应包含对学生表的引用（反之亦然）。您将需要一个包含 DonorId 和 StudentId 的新表（您称之为转换表）。这可以包含您的主键，或者您可以使用另一列作为主键，即 auto_increment。

# java - 您如何动态更新您的 Android 应用程序？

> ID：13484520
> 
> 赞同：0
> 
> 时间：2012-11-21T00:28:06.897
> 
> 标签：java, android

我是 android 开发的新手，但我想知道 ESPN Scorecenter 之类的 android 应用程序或新闻应用程序如何动态更新，而无需用户手动执行此操作。更改/更新 apk 文件会自动更改用户的 android 应用程序还是他们必须更新版本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T00:35:00.943

Android 使用 SynchAdapter 框架，但这有点棘手。SDK 有这方面的示例。

您可以通过使用由 AlarmManager 触发的 AsyncTask 或 IntentService 来简化事情，这是一组有据可查的类

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T00:41:53.220

使用线程在确定的时间内执行下载，当下载新内容时，您可以使用 notifydatasetchanged() 刷新视图。

# port - 在 Geronimo 中绑定 RMI 时，端口 1099 和其他端口有什么区别？

> ID：13484521
> 
> 赞同：1
> 
> 时间：2012-11-21T00:28:19.390
> 
> 标签：port, bind, rmi, geronimo

我正在尝试在 Geronimo 中启动 RMI 服务器。当我将 RMI 对象绑定到默认 1099 端口时，如果没有安全/策略选项，则会出现安全错误，或者如果使用 System.setSecurityManager(new RMISecurityManager()); 则会出现 AccessControl 错误错误；没有安全策略，就会出现访问控制异常。但是当我将它绑定到其他端口时，例如 9090，它会在没有安全/策略的情况下成功。

有人可以教我端口的区别是什么吗？

# java - 如何检索当前线程的向量元素？聊天室服务器

> ID：13484522
> 
> 赞同：0
> 
> 时间：2012-11-21T00:28:26.613
> 
> 标签：java, multithreading, vector, chatroom

我使用多线程和向量创建了一个聊天室服务器。每个新用户都会给出他们的昵称，我将昵称存储在向量中。但我不知道如何检索当前线程的向量元素。下面的这个方法在线程中

```
userName = input.nextLine(); // the user enters their name

usersList.add(userName);     //add it to the vector of users

String word = usersList.elementAt(????);  //how do i retrieve this current username? 

output.println( word + " has joined the conversation."); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T03:21:01.513

Vector的内部同步不足以完成您的任务，我建议以下

```
Vector<String> userList = new Vector<String>();

synchronized void addUser(String userName) {
    userList.add(userName);
    String word = userList.elementAt(userList.size() - 1); 
    System.out.println( word + " has joined the conversation.");    
} 
```

现在您可以将 Vector 替换为 ArrayList。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T07:19:32.533

如果您决定同步整个方法，您可能会以这种方式遇到死锁： 对于 methodA1 的方法调用，A 类获取其对象上的锁，然后决定在 B 类对象上调用 methodB2() 并尝试获取 ClassB 上的锁. 但是，如果 ClassB 的对象中有一个方法调用 methodB1() 正在进行中，ClassA 获取 B 的锁的努力以及 ClassB 获取 ClassA 的锁的努力将不成功，这将导致死锁。

```
 class ClassA {
    public synchronized void methodA1(ClassB classB) {
        classB.methodB2();
    }
    public synchronized void methodA2() {   }
}   

class ClassB {
    public synchronized void methodB1(ClassA classA) {
        classA.methodA2();
    }
    public synchronized void methodB2() {   }
} 
```

我建议你使用一个私有的 final Lock 对象，它可以避免你遇到合作对象之间的死锁。

```
private final Object lock = new Object();
void addUser(String userName) {
     synchronized(lock){
        // method body. Add user to list
    } // lock is released. now any cooperating object can use 'lock'. 

   // addUser can obtain a lock on any cooperating object.
} 
```

# forms - 如何在 Symfony 2 表单字段中将 FOSUserBundle 中经过身份验证的用户名设置为默认值

> ID：13484525
> 
> 赞同：1
> 
> 时间：2012-11-21T00:28:54.047
> 
> 标签：forms, symfony, fosuserbundle

我发现这个片段确实有用，可以在创建表单时在我的表单中添加默认值

```
 $builder
 ->add('myfield', 'text', array(
     'label' => 'Field',
     'data' => 'Default value'))
 ; 
```

如果我想用 FOSUser 捆绑包中的经过身份验证的人替换“默认值”怎么办？（返回 true 到 is_granted("IS_AUTHENTICATED_REMEMBERED")）

我可以在树枝文件上检索该名称

```
 {{ app.user.username }} 
```

我也用控制器方法完成了它

```
 $username=$this->container->get('security.context')->getToken()->getUser()->getUsername() 
```

但我无法让它以我的形式工作！

我不确定我是否理解容器的东西......如何在类和控制器之间传输变量......这可能是什么？

```
 ->add('myfield', 'text', array(
     'label' => 'Field',
     'data' => FOS\UserBundle\Model::$this->getUsername())) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T13:23:31.747

您可以将变量从控制器传递到表单：

在您的控制器中：

```
$username=$this->container->get('security.context')->getToken()->getUser()->getUsername()
$form = $this->createForm(new MyFormType($username), $entity); 
```

以您的形式：

```
protected $username;

public function __construct (array $username = null)
{
        $this->username = $username ;
}

public function buildForm(FormBuilder $builder, array $options)
{
   $builder  
     ->add('myfield', 'text', array(
      'label' => 'Field',
      'data' => $this->username))
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T21:46:01.840

将默认值设置到表单中的另一种方法是在表单的底层数据对象上设置它们，如 Symfony 构建表单的文档中的这个示例：

```
public function newAction()
{
    // create a task and give it some dummy data for this example
    $task = new Task();
    $task->setTask('Write a blog post');
    $task->setDueDate(new \DateTime('tomorrow'));

    $form = $this->createFormBuilder($task)
        ->add('task', 'text')
        ->add('dueDate', 'date')
        ->getForm();

    return $this->render('AcmeTaskBundle:Default:new.html.twig', array(
        'form' => $form->createView(),
    ));
} 
```

在此示例中，表单的基础数据对象是一个任务，并且在任务上设置的值是要在表单中显示的默认值。任务对象不是持久的。这种方法同样适用于表单类，并假设您的表单的底层对象是 User 看起来像这样：

> ```
> $username = $this->container->get('security.context')->getToken()->getUser()->getUsername();
> 
> $user = new User();
> $user->setUsername($username);
> // could set any other default values on user here
> 
> $form = $this->createForm(new MyFormClass(), $user); 
> ```

这种方法的缺点是，如果在许多需要相同默认值的地方使用表单，则代码将被重复。到目前为止，这不是我遇到的情况 - 我的用户表单被重新用于创建/编辑，但编辑不需要默认值。

# c# - 自定义控件的子控件未正确呈现

> ID：13484526
> 
> 赞同：0
> 
> 时间：2012-11-21T00:29:08.087
> 
> 标签：c#, asp.net, controls, render

我正在添加几个控件作为我开发的另一个自定义控件的子控件。这是我添加子控件（自定义标签和通用跨度控件）的位置：

```
 public static void AddLabel(this IExtendedControl control, string inheritableCssClass = "")
    {
        TestCLabel contentLabel = new TestCLabel();
        contentLabel.Text = control.LabelText;
        control.Controls.Add(contentLabel);
        if (control.Required)
        {
            HtmlGenericControl requiredFieldIndicator = new HtmlGenericControl("span");
            requiredFieldIndicator.Attributes["class"] = "requiredFieldIndicator";
            requiredFieldIndicator.InnerText = " *";
            control.Controls.Add(requiredFieldIndicator);
        } 
```

然后我在父控件的渲染方法中执行以下操作：

```
 protected override void Render(HtmlTextWriter w)
    {
        base.Render(w);

        foreach (Control c in this.Controls)
        {
            c.RenderControl(w);
        }

        if (Required)
        {
            rfv.RenderControl(w);
        }
    } 
```

但我收到错误“已存在具有相同密钥的条目”。这是由尝试手动呈现子控件引起的。我认为我不需要进行手动渲染，但在我在控件中编码之前没有出现（HTML 标记中没有出现任何内容）。有什么想法吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-21T01:36:55.153

看起来子控件的手动渲染不是问题。我重新编写了代码，因为我最初将子控件分配给父控件的属性，但更改了它以将子控件添加到父控件的控件集合中（以便子控件现在经历正确的生命周期）。当子控件是父控件的属性并且仍在执行此操作时，我以前一直在手动渲染子控件。手动渲染所有子项时，控件被第二次添加。还是没有回答：

*   为什么需要手动添加，因为这应该是自动的？

# javascript - 为一个表单提交操作设置 target _blank

> ID：13484528
> 
> 赞同：10
> 
> 时间：2012-11-21T00:29:23.390
> 
> 标签：javascript, jquery, html, ruby-on-rails-3, simple-form

我正在向我的 rails 应用程序提交一个表单，其中包含两个提交按钮。他们都去同一个控制器操作，并使用相同的表单，但在一个提交操作上，我想制作表单`target=_blank`，以便表单提交结果在新窗口中打开。

是否有捷径可寻？

这样做适用于两种操作：

```
<%= simple_form_for @thingy, :target => '_blank' do |f| %> 
```

我一直在使用 jQuery 在表单上设置目标`onclick`，但没有运气。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-21T00:38:56.233

在其中一个按钮上，添加一个类 say `popup`。然后像这样添加一些jQuery：

```
$('.popup').click(function(e) {
    e.preventDefault(); //prevents the default submit action
    $(this).closest('form').attr('target', '_blank').submit();
}); 
```

演示：http: [//jsfiddle.net/HxrzD/](http://jsfiddle.net/HxrzD/)

请注意，还有其他方法可以提交您可能需要考虑的表单，例如`enter`密钥。您可能还需要重置表单的目标属性，以防用户返回父窗口并使用另一个按钮再次提交。在这种情况下，您可以在最后清除目标：

```
$(this).closest('form').attr('target', '_blank').submit().removeAttr('target'); 
```

或者保存之前的状态：

```
var $form = $(this).closest('form'),
    target = $form.attr('target');
$form.attr('target', '_blank').submit().attr('target', target); 
```

[http://jsfiddle.net/HxrzD/2/](http://jsfiddle.net/HxrzD/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T00:47:50.787

您可以拦截单击按钮，在提交前读取其数据并更改表单：

所以，HTML：

```
<form id='double' method="GET" action="http://google.com/search">
   <input name="q" type="text">
   <button class="Submit" data-target=""> Submmit here</button>
   <button class="Submit" data-target="_blank"> Open new</button>
</form>​ 
```

JS

```
$('button.Submit').click( function() {
    var t=$(this);
    var form=t.parents('form');
    form.attr('target',t.data('target'));
    form.submit();
    return false;
}); 
```

通过这种方式，您可以控制 html 标记中的目标选项。

[http://jsfiddle.net/oceog/gArdk/](http://jsfiddle.net/oceog/gArdk/)

如果您不清除`target`表格，您将获得以下情况：

*   用户点击弹出按钮，
*   提交表格，
*   封闭的窗户，
*   点击非弹出

**这也会让他从目标中弹出。**

所以在我的snipplet中，如果data-target =''，我会清除目标

如果您只想将一个元素标记为弹出窗口，则需要克隆您的表单：http: [//jsfiddle.net/oceog/gArdk/2/](http://jsfiddle.net/oceog/gArdk/2/)

JS：

```
$('button.Submit.popup').click( function() {
    var t=$(this);
    var form=t.parents('form').clone(true).attr('target','_blank');

    form.submit();
    return false;
}); 
```

HTML：

```
<form id='double' method="GET" action="http://google.com/search">
   <input name="q" type="text">
   <button class="Submit"> Submmit here</button>
   <button class="Submit popup"> Open new</button>
</form>​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T00:47:59.173

为了处理所有`submit`情况（不仅仅是点击），我会执行以下操作：

```
$("form").submit(function(e) {
  if($(e.srcElement).is(".popup")){
    $(this).attr("target", "_blank");
  }
}); 
```

# php - 在 Amazon Ec2 上设置图片缩略图服务 - 最低 PHP

> ID：13484529
> 
> 赞同：0
> 
> 时间：2012-11-21T00:29:27.403
> 
> 标签：php, amazon-s3, amazon-ec2

我正在寻找一种在 Amazon EC2 免费层 +S3 上设置缩略图服务的好策略，并且只包含必需品。

在 Micro 实例上尝试了一些 Lamp 配置后，610~ MEGS，我通常会留下大约 50-200 megs 的内存用于实际的图像处理。必须有更好的方法，占用空间更小。

一个想法是安装 Debian Squeeze + Php 5，这就是我所需要的吗？只是Shell命令？没有 apache、nginx、lighthttpd 等？

我没有尝试过这里文档中的教程：http: [//aws.amazon.com/articles/1602](http://aws.amazon.com/articles/1602)

因为它似乎是不必要的复杂和昂贵的移动部件太多。

任何想法、tuts 链接或重复帖子都将是一个很好的起点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T00:45:13.130

忘掉这个！

在与我的伙伴 Jaisen 协商后，他经营着 theopenphotoproject.org，他建议在上传之前使用 imagemagick 来调整一组缩略图的大小。

*上传*前。*呵呵。*

 *为什么要把事情复杂化？有时最简单的方法仍然是最好的方法。*

# java - TicTacToe Java 游戏没有结束

> ID：13484530
> 
> 赞同：0
> 
> 时间：2012-11-21T00:29:36.737
> 
> 标签：java, arrays, tic-tac-toe

运行此代码时，游戏永远不会宣布获胜或平局，它会不断要求下一个玩家移动......

示例输出：

```
Choose a position to play
1 | 2 | 3
---------
4 | 5 | 6
---------
7 | 8 | 9
Player X (Enter a position or -1 to resign): 1

Choose a position to play.
1 | 2 | 3
---------
4 | 5 | 6
---------
7 | 8 | 9
Player O (Enter a position or -1 to resign): 1 
```

它不会改变角色的空格数，甚至不会记住它来宣布获胜者。

这是我的代码的 runStandardGame() 部分，我认为问题出在哪里？

```
//***RUN STANDARD GAME******************************************************

static void runStandardGame() {

    int position = QUIT;
    char playerChar = 'X';
    boolean isGameOver = false;

    fillPosition();

    System.out.println("Choose a position to play.\n");

    displayGrid();

    do {
        System.out.print("Player " + playerChar +
                         " (Enter a position or " + QUIT + " to resign): ");
        position = keyboard.nextInt();

        System.out.println("Choose a position to play.\n");

        displayGrid();

        if(isWin()) {
            System.out.print("\nPlayer " + playerChar + " WINS!!!\n");
            isGameOver = true;
        }
        else if (isTie()) {
            System.out.print("\nTIE.\n");
            isGameOver = true;
        }
        else {
            //switch players because one of the players has just played
            //and not won;, so, it is the other player's turn
            if (playerChar == 'X') {
                playerChar = 'O';
            }
            else{
                playerChar = 'X';
            }
        }
    }while(!isGameOver && position != QUIT);

}//end of runStandardGame 
```

甚至可能只是游戏部分，因为那是分配给数组的地方......

```
//***PLAY*******************************************************************    

static void play(int cell, char playerChar) {
    //the player has entered a number 1 through 9 for the position they want
    //to play, so, figure out which row and which column of the array this is
    //For example, if the player wants to play 'X' in position 7, this means
    //the 'X' must go into row 2, column 0 of the array
    int row = 0;
    int column = 0;

    if (cell > 0 && cell <= (STANDARD_GRID_ROWS * STANDARD_GRID_COLUMNS)){
        row = (cell - 1) / STANDARD_GRID_ROWS;
        column = (cell - 1) % STANDARD_GRID_COLUMNS;
        grid[row][column] = playerChar;
    }
} 
```

任何帮助表示赞赏。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T00:33:38.173

在我看来，在

```
position = keyboard.nextInt(); 
```

在显示和继续之前，需要对位置进行一些处理（将其写到板上）？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T00:39:59.073

我看到您正在获取用户输入

```
position = keyboard.nextInt(); 
```

但我没有看到你实际使用它来调用

```
play(position, playerChar); 
```

# cuda - 实际扭曲执行顺序还是并行？

> ID：13484533
> 
> 赞同：2
> 
> 时间：2012-11-21T00:29:47.373
> 
> 标签：cuda

如果我们为一个 SM 配置了 256 个线程/块，那么总共将是 3 个块/SM（考虑最大 768 个线程/SM）。现在总经线/块将是 256/32 = 8，因此 8*3 = 24 经线/SM。那么，这 8 个块中的扭曲将按顺序执行还是并行执行，而 SM 中的 24 个扭曲将按顺序执行还是并行执行？正如已经明确的那样，SM（并行）可以随时执行 3 个块。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T08:51:26.987

@robot，我将讨论移至答案以获得更好的可读性。如果你愿意，你也可以接受。

不同的块可以映射到不同的 SM，因此可以并行执行。但是，在内部，块由warp 组成，这些warp 被安排在一个SM 上一次执行一个（在1.x 设备上）。但是，图形硬件可以以 0 开销（由于静态寄存器分配）在不同的扭曲之间切换。因此，通常来自不同扭曲（可能来自不同块）的指令存在于 SM 的流水线中的不同阶段。

活动扭曲是那些准备好执行的扭曲，即不等待屏障、内存访问并且没有寄存器依赖关系（如写入后读取）。我不确定硬件如何选择下一个要执行的扭曲。可能扭曲按“年龄”（等待时间）和其他因素优先考虑，以防止饥饿。

关于您的问题：

1.  在 1.x 设备上，每个 SM 最多可以有 768 个线程，即 24 个 warp/SM。在 2.x 及更高版本上，每个 SM 最多有 1536 个线程/48 个扭曲（取决于寄存器使用情况）
2.  如果每个 GPU 有 10 个 SM，并且您有足够的寄存器/共享内存来每个 SM 运行 24 个扭曲，那么每个 GPU 最多可以有 24*10 个活动扭曲。但是，很少有所有 warp 同时处于活动状态的情况，因为它们中的大多数将等待内存访问/寄存器依赖项或障碍，具体取决于您的程序逻辑。请注意，一条指令的实际执行（不是调度！）在 1.x 设备上最多可能需要 22 个周期，因此在指令完成之前，warp 将处于非活动状态。

# php - 我无法将此 if 语句转换为 if/elseif 语句。它行不通。我究竟做错了什么？

> ID：13484535
> 
> 赞同：0
> 
> 时间：2012-11-21T00:29:57.090
> 
> 标签：php, drupal, if-statement

我正在试验 if/elseif，但不明白为什么它在 Drupal 6 模板中不起作用。

此代码有效：

```
<?php
    if ((arg(0) == 'node') && (arg(1) == 'add') || (arg(1) == 'edit')){
    $node = node_load(array('nid' => arg(1)));
    print '<h2>' .  $title . '</h2>';   }
?> 
```

如果我在 node/add/whatever 或 node/nid/edit 中，它会显示包装到 h2 中的标题变量。现在，我想在节点/添加和节点/编辑的情况下展示一些稍微不同的东西。所以，我试过这个：

```
<?php
if ((arg(0) == 'node') && (arg(1) == 'edit')) {
    $node = node_load(array('nid' => arg(1)));
    print '<h3>' .  $title . '</h3>';
} elseif ((arg(0) == 'node') && (arg(1) == 'add')) {
    $node = node_load(array('nid' => arg(1)));
    print '<h2>' .  $title . '</h2>';   }
} else {
    echo ""; //it shows nothing
}
?> 
```

而且它不起作用（不会显示任何东西）。所以，我试过这个：

```
<?php
    if ((arg(0) == 'node') && (arg(1) == 'add')){
    $node = node_load(array('nid' => arg(1)));
    print '<h2>' .  $title . '</h2>';   }
?>
<?php
    if ((arg(0) == 'node') && (arg(1) == 'edit')){
    $node = node_load(array('nid' => arg(1)));
    print '<h3>' .  $title . '</h3>';
    }
?> 
```

在这种情况下，它只适用于节点/添加，但完全忽略节点/编辑。

我究竟做错了什么？谢谢你的建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T00:35:02.897

节点编辑页面的路径是`node/[nid]/edit`...您需要`arg(2)`改用：

```
if ((arg(0) == 'node') && is_numeric(arg(1)) && (arg(2) == 'edit')){ 
```

# c++ - Picking Ray 不准确

> ID：13484536
> 
> 赞同：0
> 
> 时间：2012-11-21T00:30:18.517
> 
> 标签：c++, windows, opengl, picking, ray-picking

我正在尝试通过[本网站](http://schabby.de/picking-opengl-ray-tracing/)的说明来实现拾取射线。

现在我基本上只希望能够点击地面，命令我的小人向这个点走。由于我的地平面是平的、不旋转的和不平移的，所以当 y 达到 0 时，我必须找到我的拾取射线的 x 和 z 坐标。

到目前为止一切顺利，这就是我想出的：

```
//some constants
float HEIGHT = 768.f;
float LENGTH = 1024.f;
float fovy = 45.f;
float nearClip = 0.1f;

//mouse position on screen
float x = MouseX;
float y = HEIGHT - MouseY;

//GetView() returns the viewing direction, not the lookAt point.
glm::vec3 view = cam->GetView();
glm::normalize(view);

glm::vec3 h = glm::cross(view, glm::vec3(0,1,0) ); //cameraUp
glm::normalize(h);

glm::vec3 v = glm::cross(h, view);
glm::normalize(v);

// convert fovy to radians 
float rad = fovy * 3.14 / 180.f; 
float vLength = tan(rad/2) * nearClip; //nearClippingPlaneDistance
float hLength = vLength * (LENGTH/HEIGHT);

v *= vLength;
h *= hLength;

// translate mouse coordinates so that the origin lies in the center
// of the view port
x -= LENGTH / 2.f;
y -= HEIGHT / 2.f;

// scale mouse coordinates so that half the view port width and height
// becomes 1
x /= (LENGTH/2.f);
y /= (HEIGHT/2.f);

glm::vec3 cameraPos = cam->GetPosition();

// linear combination to compute intersection of picking ray with
// view port plane
glm::vec3 pos = cameraPos + (view*nearClip) + (h*x) + (v*y);

// compute direction of picking ray by subtracting intersection point
// with camera position
glm::vec3 dir = pos - cameraPos;

//Get intersection between ray and the ground plane
pos -= (dir * (pos.y/dir.y)); 
```

在这一点上，我希望`pos`成为我的拾取射线击中我的地平面的点。然而，当我尝试它时，我得到了这样 ![错误](../Images/2c34c79333a4adb6f0fc84704a3f2dba.png) 的结果：（鼠标光标没有被记录下来）因为地面没有纹理，所以很难看到，但是相机是倾斜的，就像在大多数 RTS 游戏中一样。根据我的计算，我可怜地尝试在 Blender 中模拟一个看起来很远的人，这标志着交叉点发生。

所以看起来和之间的`view`转换`dir`某处之间的转换搞砸了，我的光线最终指向了错误的方向。计算位置和实际位置之间的差距会随着鼠标远离屏幕中心的距离而增加。

我发现：

*   高度和长度不是准确的。由于 Windows 为边框切掉了几个像素，因此使用 1006,728 作为窗口分辨率会更准确。我想这可能会造成小的差异。
*   如果我将 fovy 从 45 增加到大约 78，我会得到相当准确的光线。所以也许我用作fovy的东西有问题。我明确地调用`glm::perspective(45.f, 1.38f, 0.1f, 500.f)`（分别为fovy、纵横比、fNear、fFar）。

所以这就是我迷路的地方。为了获得准确的光线，我必须做什么？

PS：我知道有一些函数和库已经实现了这个，但为了学习目的，我尽量远离这些东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T13:25:35.253

这是使用深度缓冲区信息将光标转换为 3D 的工作代码：

```
 glGetIntegerv(GL_VIEWPORT, @fViewport);
  glGetDoublev(GL_PROJECTION_MATRIX, @fProjection);
  glGetDoublev(GL_MODELVIEW_MATRIX, @fModelview);

  //fViewport already contains viewport offsets
  PosX := X;
  PosY := ScreenY - Y; //In OpenGL Y axis is inverted and starts from bottom

  glReadPixels(PosX, PosY, 1, 1, GL_DEPTH_COMPONENT, GL_FLOAT, @vz);

  gluUnProject(PosX, PosY, vz, fModelview, fProjection, fViewport, @wx, @wy, @wz);
  XYZ.X := wx;
  XYZ.Y := wy;
  XYZ.Z := wz; 
```

如果您只测试光线/平面相交，这是没有 DepthBuffer 的第二部分：

```
 gluUnProject(PosX, PosY, 0, fModelview, fProjection, fViewport, @x1, @y1, @z1); //Near
  gluUnProject(PosX, PosY, 1, fModelview, fProjection, fViewport, @x2, @y2, @z2); //Far

  //No intersection
  Result := False;
  XYZ.X := 0;
  XYZ.Y := 0;
  XYZ.Z := aZ;

  if z2 < z1 then
    SwapFloat(z1, z2);

  if (z1 <> z2) and InRange(aZ, z1, z2) then
  begin
    D := 1 - (aZ - z1) / (z2 - z1);
    XYZ.X := Lerp(x1, x2, D);
    XYZ.Y := Lerp(y1, y2, D);
    Result := True;
  end; 
```

我发现它与您正在做的事情有很大不同，但也许这会更有意义。

# c# - 如何在 Newtonsoft JSON 中解析 TimeSpan 值

> ID：13484540
> 
> 赞同：4
> 
> 时间：2012-11-21T00:30:53.020
> 
> 标签：c#, .net, json, json.net, timespan

我想解析 JSON 字符串并使用该`token.Type`属性来检测 type 的值`JTokenType.TimeSpan`。

我不知道如何在我的输入字符串中表达 TimeSpan，一切似乎都被解释为 JTokenType.String。

```
var timeSpanString = TimeSpan.FromHours(1).ToString();
testString = string.Format(@"{{""Value"": ""{0}"" }}", timeSpanString);
var statObject = JObject.Parse(testString);
JToken token = statObject["Value"];
var tokenValue = token.ToString();
var tokenType = token.Type; // JTokenType.String 
```

我什至尝试过：

```
JValue jValue = new JValue("test");
jValue.Value = TimeSpan.FromHours(1);
bool isTimeSpan = jValue.Type == JTokenType.TimeSpan; // true!
testString = string.Format(@"{{""Value"": ""{0}"" }}", jValue.Value);
var statObject = JObject.Parse(testString);
JToken token = statObject["Value"];
var tokenValue = token.ToString();
var tokenType = token.Type; // JTokenType.String 
```

这至少会产生一个**tokenType JTokenType.TimeSpan**的 JValue对象，但在我解析它时仍然显示为 JTokenType.String。

这非常适用于 DateTime 对象。如何表达输入字符串，使得解析的值类型为`JTokenType.TimeSpan`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-22T04:29:59.487

根据我在一段时间内使用 JSON.NET 时所看到的情况，您将永远不会使用默认设置解析字符串并检索具有类型的令牌`JTokenType.TimeSpan`（对于某些其他类型也是如此，例如 Guid 或 Uri） . 我对为什么会出现这种情况有一个很好的猜测（根据我几年前在`DataContractJsonSerializer`.

基本上，这是解析器可以从输入中检索到多少信息的问题。JSON 是一种非常简单的语法，它只知道*数字*、*布尔值*和*字符串*（除了数组和对象）。许多 CLR 类型没有原生 JSON 类型（Uri、DateTime、DateTimeOffset、TimeSpan 等），因此当任何 JSON 解析器读取数据时，它都会尝试使用最佳匹配。

如果您要将 JSON 字符串反序列化为 CLR 数据类型，则序列化程序有一些附加信息可用于消除 JSON 字符串映射到的歧义 - 值被反序列化到的字段/属性的类型。但是，当您将 JSON 数据反序列化为`JToken`对象图时，没有其他信息，并且 JSON.NET 必须选择一种类型。反序列化 JSON 字符串最自然的类型是 CLR 字符串。

但是为什么日期被正确反序列化为`JTokenType.Date`？IIRC，JSON.NET 阅读器有一个特殊的日期代码（由`DateParseHandling`枚举控制），它尝试将解析的字符串与一些预定义的格式（ISO 8601 或旧的 Microsoft ASP.NET AJAX 格式）匹配，如果找到匹配它的字符串，它将读取它作为`DateTime`（或`DateTimeOffset`）而不是字符串。我不知道是否可以将该行为扩展到也支持`TimeSpan`或其他类型，但我不会感到惊讶，因为 JSON.NET 中的可扩展性非常好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-05-20T21:59:56.200

如果您尝试解析 TimeSpan 它需要用引号括起来：'"12:00:00"'

如果您序列化 TimeSpan 并查看字符串结果，它看起来像："\"12:00:00\""

至少这对我使用 NewtonSoft.JsonConvert 有效。我的数据库“12:00:00”中的字符串（包括引号）。

并且使用 JsonConvert.DeserializeObject(dbString) 返回正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-03T08:20:23.310

刚刚遇到了同样的问题，并且能够这样做：

```
string json = "{ \"span\": \"00:00:15\"}";

JToken token = JToken.Parse(json);

TimeSpan span = token["span"].ToObject<TimeSpan>(); 
```

# c++ - 计算两个数组C ++中匹配元素的数量

> ID：13484545
> 
> 赞同：3
> 
> 时间：2012-11-21T00:31:00.223
> 
> 标签：c++, arrays, function

我正在为 Comp Sci I 做家庭作业，我已经尝试了我在互联网和教科书中能找到的所有东西，试图计算两个 C++ 数组中匹配元素的数量。我根本找不到一种方法来让我的代码计算两个相同大小（相同值，相同位置）数组中匹配元素的数量。例如，如果 array1 有 5、4、3、2、1，而 array2 有 1、2、3、4、5，则有一个匹配元素，即 3。如何让我的代码执行这个看似简单的任务?

在任何地方都找不到答案。我的教科书只展示了如何在不计算匹配数的情况下查看数组是否完全匹配，而且我无法找到其他人对 C++ 有这个确切的问题。

到目前为止，这是我的功能：

```
int matchCounter(int lottery[5], int user[5], int matches, int SIZE)
{
    int count = 0;

    for (count < SIZE; count++;)
    {
        if (lottery[count] == user[count])
        {
            matches++;
        }
}

    return matches;
} // end matchCounter 
```

顺便说一下，SIZE 是一个等于 5 的常数。看起来这应该可以工作，但是每次我运行程序时，它都会显示 0 个匹配项，即使有一些匹配项也是如此。如果有人可以帮助我，我将永远欠你的债。说真的，一定有一些我没有看到的非常简单的事情。感谢您提前提供帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T00:34:54.587

你的`for`说法是乱码。尝试这个：

```
int matchCounter(int lottery[5], int user[5], int matches, int SIZE)
{
    for (int count = 0; count < SIZE; count++)
    {
... 
```

因为你的程序总是失败的原因：`count++`被放在`for`循环中条件的位置，所以每次`for`执行这个循环时，`count`都会被评估并认为是条件，然后`count`加1。但是，每次都`count`从0（如`int count = 0;`），所以`for`循环实际上永远不会被执行，并且`matches`保持为零。

**编辑：**

从您的源代码中，您没有使用您的返回值，这也是@jimhark 所建议的。将函数签名更改为：

```
int matchCounter(int lottery[5], int user[5], int SIZE) 
```

并致电：

```
matches = matchCounter(lottery, user, 5); 
```

否则，您的函数返回值将`matchCounter`被忽略，而`int matches`仅在函数中起局部变量的作用。

阅读有关为什么`matches`不起作用的原因：[http](http://www.cs.utsa.edu/~wagner/CS2213/swap/swap.html) ://www.cs.utsa.edu/~wagner/CS2213/swap/swap.html （在类似的设置中）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T00:37:10.410

您可能没有使用您的返回值。将 sig 更改为：

```
int matchCounter(int lottery[5], int user[5], int SIZE)
{
    matches = 0; 
```

并确保你打电话给：

```
matches = matchCounter(lottery, user, 5); 
```

如果您需要运行总和，请使用：

```
matches += matchCounter(lottery, user, 5); 
```

在任何情况下 matchCounter 都不关心运行总数是多少，那么为什么要传递它呢？

此外，您可能需要先对列表进行排序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T00:39:02.283

由于这是一个家庭作业，我将尝试指出错误而不给出解决方案。

for循环的形式是：

```
for (INIT; COND; STEP) {
    BODY;
} 
```

这相当于：

```
INIT;
while (COND) {
    BODY;
    STEP;
} 
```

你做的方式，你的 INIT 是`count < SIZE`，它什么都不做。您的 "COND" 是`count++`，它在第一次迭代时返回 0。您可能知道，在布尔值的上下文中，0 是假的。因此，您的 for 循环体根本没有被执行。

此外，您不应将`matches`其作为参数传递。它应该是一个用 0 初始化的局部变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-26T21:41:10.687

也许这可以帮助：

```
int matches=0;

for(int i=0;i<ARRAY.SIZE;i++) {
   for(int j=0;j<ARRAY.SIZE;j++) {
       if(arr1[i]==arr2[j]) {
          matches++;
          arr2[j]=NULL;
       }
   }
} 
```

# objective-c - NSCompoundPredicate 子谓词顺序

> ID：13484547
> 
> 赞同：2
> 
> 时间：2012-11-21T00:31:12.127
> 
> 标签：objective-c, core-data

用于初始化 NSCompoundPredicate 的数组中子谓词的顺序会影响效率吗？

例子：

```
NSString * str = [self getAStr];
NSManagedObject * mo = [self getAMo];
NSString * fmt = @"(stringAttribute ==[cd] %@) AND (relationships CONTAINS %@)";
NSString * fmt2 = @"relationships.@count != 0";
NSPredicate * p1 = [NSPredicate predicateWithFormat:fmt,str,mo];//expensive predicate
NSPredicate * p2 = [NSPredicate predicateWithFormat:fmt2,nil];//less expensive predicate
NSCompoundPredicate * cp = [NSCompoundPredicate andPredicateWithSubpredicates:@[p1,p2];
[self fetchSomethingWithPredicate:cp]; 
```

在上面的例子中，p1 和 p2 的顺序会改变复合谓词的计算方式吗？显然，首先评估 p2 会更有效，假设如果 p2 评估为 false，则 p1 将被忽略。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T01:26:27.043

是的，评估的顺序很重要。总是把最有效和限制性的谓词放在左边——尽可能快地取消资格（尽管记住一些谓词真的很昂贵）。

如果您中断调试器并打印出“cp”谓词，请确保它从左到右尽可能高效。

# java - 在java中存储本地数据？

> ID：13484549
> 
> 赞同：-2
> 
> 时间：2012-11-21T00:31:41.113
> 
> 标签：java, text, storage

我正在使用 Java 进行简单的文本冒险。我希望能够定义每个任务的进度，并将其存储在用户的应用数据中，以便下次他们玩游戏时读取。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T00:56:14.770

如果您只想在内部存储数据（即，跨会话保存，但不是作为用户可读文件），我会使用[Preferences API](http://docs.oracle.com/javase/7/docs/technotes/guides/preferences/overview.html)。

例如：假设您有一个名为`MissionInfo`which implements的类`java.io.Serializable`。您可以执行以下操作：

```
// Precondition: missionInfoToSave is an variable of type MissionInfo

// The key used to store the data.
final String key = "SAVE_DATA";

// Get the preferences database for this package.
Preferences prefs = Preferences.userNodeForPackage(MissionInfo.class);

// To save, write the object to a byte array.
ByteArrayOutputStream baos = new ByteArrayOutputStream();
try {
    ObjectOutputStream oos = new ObjectOutputStream(baos);
    oos.writeObject(missionInfoToSave); // write it to the stream
    prefs.putByteArray(key, baos.toByteArray());
} catch (IOException ie) {
    System.err.println("Failed to save to file");
}

// To load, read it back.
// The second argument is the default if the key isn't found.
byte[] stored = prefs.getByteArray(key, null);
if (stored == null) {
    // There's no stored data.
    return;
}
ByteArrayInputStream bais = new ByteArrayInputStream();
try {
    ObjectInputStream ois = new ObjectInputStream(bais);
    Object o = ois.readObject();
    if (o instanceof MissionData) { 
        // Good: it's a saved data file.
        updateMissionProgress((MissionData) o); // assuming this is defined
    }
} catch (IOException ie) {
    System.err.println("Couldn't load from prefs");
} catch (ClassNotFoundException cnfe) {
    System.err.println("Class couldn't be found");
} 
```

Preferences API 将跨会话存储数据。您可以在包装中找到它[`java.util.prefs`](http://docs.oracle.com/javase/7/docs/api/java/util/prefs/package-summary.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T00:35:21.383

您可以使用[`java.util.Properties`](http://docs.oracle.com/javase/7/docs/api/java/util/Properties.html)，这是一个方便的实用程序，用于创建键和值的映射、将其存储在文件中以及`Properties`从该文件加载相关对象。`Properties`可以在[此处](http://www.mkyong.com/java/java-properties-file-examples/)找到有关使用 Java 处理文件的一个很好的教程。

要获取 AppData 目录文件路径（在 Windows 中），您可以使用`System.getenv("APPDATA")`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T00:36:06.673

使用简单数据库：sqlite 或 Berkeley DB [http://docs.oracle.com/cd/E17277_02/html/index.html](http://docs.oracle.com/cd/E17277_02/html/index.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T00:39:03.070

我建议您在用户主目录中创建一个特定于应用程序的文件夹，您可以使用以下代码获取该文件夹：

```
String userHome=System.getProperty("user.home"); 
```

这将为您提供一个类似于 c:\Documents and Settings\user1 的字符串，然后您可以先将您的应用程序名称附加到该字符串，例如“adventureapp”，并先使用正斜杠。然后从那。你可以这样做 ：

```
File file = new File(mypathtomyappfolder); 
```

然后你测试 .isDirectory() 如果不是，这是用户第一次运行 app do file.newDir() 所以你有你的冒险应用目录。然后从那里使用 File 并将文件名附加到您的字符串中，例如 user.properties，您可以根据他们在游戏中的进展对其进行读写。希望有帮助。- 邓肯

# binary-tree - 遍历溢出的二叉树

> ID：13484554
> 
> 赞同：0
> 
> 时间：2012-11-21T00:32:48.067
> 
> 标签：binary-tree

给定一个非常大的二叉树（即具有数百万个节点），如何确定树中的节点数？换句话说，给定这棵树的根节点给一个函数，该函数应该返回树中的节点数。

或者让我们说如果二叉树有非常多的节点，你如何检查二叉树是否是 BST？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:47:34.970

遍历所有节点并检查您需要的任何条件/指标。如果没有关于树的额外知识，您将无能为力。

您可以在创建树时强制执行特定条件（即必须平衡/排序/无论如何）或在创建时收集有关树的信息（即存储并不断更新子节点的数量）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-18T18:48:12.777

要检查它是否是有效的 bst，您必须首先访问每个节点深度并确保每个节点都小于前一个节点。

如果您想评估平衡 BST 需要多长时间，您可以通过计算一条腿的长度来快速估算尺寸，我相信总尺寸将在 2^(n-1) 和 2^n 之间-1 包括在内

# ruby-on-rails - Rails如何获取关联的模型属性

> ID：13484555
> 
> 赞同：1
> 
> 时间：2012-11-21T00:33:00.757
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有下面的方法将数据保存到 users 表以及 user_details 表。

当我将 @newUser 变量传递给 EmailMailer 时，我无法访问 user_details 属性。如何在 @newUser 对象中传递 user_details 而无需重新查询数据库？

楷模

```
class User < ActiveRecord::Base
  has_one :user_details, :dependent => :destroy
  accepts_nested_attributes_for :user_details
  attr_accessible :email, :password, :password_confirmation, :remember_me, :username, :login, :home_phone, :cell_phone, :work_phone, :birthday, :home_address, :work_address, :position, :company, :user_details_attributes
end

class UserDetails < ActiveRecord::Base
  belongs_to :user
  attr_accessible :first_name, :last_name, :home_phone, :cell_phone, :work_phone, :birthday, :home_address, :work_address, :position, :company
end 
```

控制器

```
# POST /users
def create
        @newUser = User.new(params[:user], :include =>:user_details)

        # create password
        require 'securerandom'
    password = SecureRandom.urlsafe_base64(8)

        @newUser.password = password

        respond_to do |format|
            if @newUser.save

                @newUser.build_user_details
                # Tell the UserMailer to send a welcome Email after save
                EmailMailer.welcome_email(@newUser).deliver
                # To be used in dev only. Just tests if the email was queued for sending.
                #assert ActionMailer::Base.deliveries.empty?
                format.html {
                    flash[:success] = "User created successfully"
                    redirect_to(contacts_path)
                }
            else 
                format.html {
                    flash[:error] = flash[:error].to_a.concat resource.errors.full_messages
                    redirect_to(contacts_path)
                }
            end
        end
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T01:34:26.320

这样的事情可能会做你所追求的。

```
class User < ActiveRecord::Base
  has_one :user_details
  accepts_nested_attributes_for :user_details
  after_initialize :build_user_details
  ...
end

# In controller
def create
  @new_user = User.new
  @new_user.attributes = params[:user]
  if @new_user.save
    # do mail thing
  else
    # other thing
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T00:43:48.337

您需要在保存 @newUser 之前建立 UserDetails 关联

```
@newUser.build_user_details
if @newUser.save
  #send mailer
else
  #do something else
end 
```

或者，您可以在保存 @newuser 后使用 create 操作

```
if @newUser.save
   @newUser.create_user_details
   #send mailer
else
   #do something else
end 
```

顺便说一句，Ruby/Rails 约定是使用snake_case 作为变量。所以@newUser 应该是@new_user。

# visual-studio - Visual Studio 设置项目设置先决条件 .Net 2.0？

> ID：13484557
> 
> 赞同：0
> 
> 时间：2012-11-21T00:33:33.353
> 
> 标签：visual-studio, deployment, installation, setup-project

我有一个 Visual Studio 安装设置项目，我想在其中指定先决条件是 .Net 2.0 当我单击属性-> 先决条件时

![在此处输入图像描述](../Images/a4ef49e09b0bb4bccf2670dd0217a48d.png) 它仅显示 .Net framework 3.5/client profile 和 .Net framework 4.0/client profile 和其他组件，但不显示 .Net 2.0

第二部分是如果不满足先决条件或自动安装它们，安装程序会失败吗？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T01:02:48.050

如果您查看解决方案的属性，您可以选择您使用的 .NET 框架的版本。请注意，这仅适用于非 Express 版本。

[http://msdn.microsoft.com/en-us/library/bb398202.aspx](http://msdn.microsoft.com/en-us/library/bb398202.aspx)

此外，微软通过仅使 VS 向后兼容而不是向前兼容未来的 .NEzt 版本来维持自己的业务。

要创建安装程序，您需要 mtomcreatemamDeployment 项目并指定依赖项。

[http://support.microsoft.com/kb/324733](http://support.microsoft.com/kb/324733)

# android - ACRA 崩溃了

> ID：13484559
> 
> 赞同：0
> 
> 时间：2012-11-21T00:33:46.067
> 
> 标签：android, acra

我正在使用 ACRA 进行崩溃报告，但突然之间它给我带来了一些问题。我的应用程序无法启动，我收到一个崩溃报告通知，但点击它什么也没做。打开 logcat，我可以看到以下条目：

```
 11-20 19:25:53.093: E/ACRA(16233): ACRA caught a RuntimeException exception for com.skipmorrow.phca. Building report.
 11-20 19:25:53.763: D/ApplicationPolicy(716): isStatusBarNotificationAllowed: packageName = com.skipmorrow.phca
 11-20 19:25:53.763: E/ACRA(16233): com.skipmorrow.phca fatal error : Unable to create application com.skipmorrow.phca.ACRA: java.lang.ClassCastException: java.lang.String cannot be cast to java.lang.Integer
 11-20 19:25:53.763: E/ACRA(16233): java.lang.RuntimeException: Unable to create application com.skipmorrow.phca.ACRA: java.lang.ClassCastException: java.lang.String cannot be cast to java.lang.Integer
 11-20 19:25:53.763: E/ACRA(16233):     at com.skipmorrow.phca.ACRA.onCreate(ACRA.java:89) 
```

没什么可继续的，但看起来 ACRA 本身就有问题。

这是我的 ACRA 实现类：

```
 package com.skipmorrow.phca;

 import org.acra.annotation.*;
 import org.acra.ReportingInteractionMode;

 import android.app.Application;

 @ReportsCrashes(
 formKey = "dFdSMXh...E6MQ",
 mode = ReportingInteractionMode.NOTIFICATION,
 resNotifTickerText = R.string.crash_notif_ticker_text,
 resNotifTitle = R.string.crash_notif_title,
 resNotifText = R.string.crash_notif_text,
 resNotifIcon = android.R.drawable.stat_notify_error, // optional. default is a warning sign
 resDialogText = R.string.crash_dialog_text,
 resDialogIcon = android.R.drawable.ic_dialog_info, //optional. default is a warning sign
 resDialogTitle = R.string.crash_dialog_title, // optional. default is your application name
 resDialogCommentPrompt = R.string.crash_dialog_comment_prompt, // optional. when defined, adds a user text field input with this text resource as a label
 resDialogOkToast = R.string.crash_dialog_ok_toast, // optional. displays a Toast message when the user accepts to send a report.
 logcatArguments = {
        "-t"
        ,"2000"
        ,"-v"
        ,"time"
        ,"PHCA_ActionCommand:D"
        ,"ActionParameterEditTextActivity:D"
        ,"ActionParameterSeekbarActivity:D"
        ,"PHCA_C2DMReceiver:D"
        ,"PHCA_CommonActivity:D"
        ,"PHCA_ConfigurationActionCommandChooser:D"
        ,"PHCA_ConfigurationAddNewAction:D"
        ,"PHCA_ConfigurationAddNewPage:D"
        ,"PHCA_ConfigurationAddNewPagelink:D"
        ,"PHCA_ConfigurationAddNewPageStatus:D"
        ,"PHCA_ConfigurationEditActionCommand:D"
        ,"PHCA_ConfigurationEditPageRefreshUpdateActivity:D"
        ,"PHCA_ConfigurationEditVariable:D"
        ,"PHCA_ConfigurationEditVariableValueSetting:D"
        ,"PHCA_ConfigurationLandingPage:D"
        ,"PHCA_ConfigurationPageChooserActivity:D"
        ,"PHCA_ConfigurationPageObjectChooserActivity:D"
        ,"PHCA_ConfigurationRefreshUpdateChooserActivity:D"
        ,"PHCA_DBAdapter:D"
        ,"PHCA_DragListener:D"
        ,"PHCA_DragNDropAdapter:D"
        ,"PHCA_DragNDropListView:D"
        ,"PHCA_DropListener:D"
        ,"PHCA_EditC2dmSettingsActivity:D"
        ,"PHCA_EditGlobalPrefsActivity:D"
        ,"PHCA_EnterFilenameForBackup:D"
        ,"PHCA_EnterPinActivity:D"
        ,"PHCA_EnterPinDialog:D"
        ,"PHCA_HttpNetworking:D"
        ,"PHCA_ListLabels:D"
        ,"PHCA_MyListArrayAdapter:D"
        ,"PHCA_Page:D"
        ,"PHCA_PageAction:D"
        ,"PHCA_PageChooserDialog:D"
        ,"PHCA_PageImageActivity:D"
        ,"PHCA_PageLink:D"
        ,"PHCA_PageListActivity:D"
        ,"PHCA_PageRefreshUpdate:D"
        ,"PHCA_PageStatus:D"
        ,"PHCA_PhcaActivity:D"
        ,"PHCA_PhcaAppWidgetConfigurator:D"
        ,"PHCA_PhcaAppWidgetProvider:D"
        ,"PHCA_PhcaMenu:D"
        ,"PHCA_PhcaPrefs:D"
        ,"PHCA_PhcaUtils:D"
        ,"PHCA_RemoveListener:D"
        ,"PHCA_SocketServerNetworking:D"
        ,"PHCA_Variable:D"
        ,"PHCA_VariableChooser:D"
        ,"PHCA_VariableSetting:D"
        ,"PHCA_VariableValueSettingChooser:D"
        ,"PHCA_VisiblePhcaPageObject:D"
        ,"PHCA_WidgetDialogResponseActivity:D"
        ,"PHCA_XmlFileChooser:D"
        ,"PHCA_XmlNodeCounter:D"
        ,"PHCA_XmlParser:D"
        ,"*:S"
        }
 )

 public class ACRA extends Application {
    @Override
     public void onCreate() {
         // The following line triggers the initialization of ACRA
        org.acra.ACRA.init(this); // <<<<====== LINE 89
         super.onCreate();
     }  
 } 
```

另一个线索（我认为）是在我的 ACRA 课程中，在 onCreate 中，我必须使用完全合格的方法调用 init

```
org.acra.ACRA.init(this) 
```

**编辑**我不敢相信我第一次忽略了这个。这是 com.skipmorrow.phca.ACRA 中的第 89 行

在我使用过 ACRA 的其他项目中，我不必这样做（事实上，指令调用 init() 时只使用 ACRA.init(this)。这可能与它有关吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T02:05:27.090

坠机不在 ACRA 内。

它位于此类 com.skipmorrow.phca.ACRA.onCreate(ACRA.java:89) 的第 89 行

这不是 ACRA 课程。所有 ACRA 类都在包 org.acra 中。不确定 com.skipmorrow.phca.ACRA 来自哪里，但你需要看看那里。

# javascript - 按时间表重新加载多个元素

> ID：13484560
> 
> 赞同：1
> 
> 时间：2012-11-21T00:33:54.967
> 
> 标签：javascript, function, refresh, onload

我有一个我正在尝试使用的活动桌面网站，它使用多个 javascript onload 调用函数。这些功能需要：

1.  日历日期和时钟。
2.  时间块功能（例如，如果时间是下午 12:00:00，它*应该*说“午餐时间”）。
3.  新闻提要滚动条。

我的问题有两个：首先，如果加载新闻滚动条，则缺少日期和时间，但时间块功能仍然存在。其次，很可能对于不同的线程，日期和时间不会刷新时间块功能，即使它必须每秒刷新一次。是否有我应该使用的功能将时间块功能自动刷新到一天中的什么时间？它们都在同一个表格单元格中，但没有使用任何框架。是因为他们没有共享同一个div吗？还是我必须将其重新格式化为框架？

任何帮助将不胜感激，任何进一步的信息我将非常乐意详细说明。

我现在的代码：

```
function start() { 
  oncontextmenu="return false;";
  feedreader.run(); 
  date_time('date_time');
} 
window.onload = start; 
```

干杯，MJ

# c++ - 将指向基对象的指针转换为派生类的指针

> ID：13484561
> 
> 赞同：1
> 
> 时间：2012-11-21T00:34:11.667
> 
> 标签：c++, pointers, inheritance

我对将指向基类对象的指针转换为派生类的指针感到困惑。请检查以下代码：

```
derivate_class *d1 = (derivate_class*)cb;
d1->print();
d1->print1(); 
```

结果是：

*   我是基地的一个虚拟功能。*   我是派生类中的一个函数。

谁能帮我解释为什么要`d1->print()`打印“我是基地的虚拟功能。”？

```
#include <iostream>
using namespace std;

class base
{
public:
    virtual void print()
    {
        cout << "I'm a virtual function in base." << endl;
    }
};

class derivate_class : public  base
{
public:
    void print()
    {
        cout << "I rewrite the virtual function in base." << endl;
    }

    void print1()
    {   
        cout << "I'm a function in derivate class." << endl;
    }
};

int main()
{
    base* b = new base();
    derivate_class *d = new derivate_class();
    b->print();
    d->print1();
    base* cb = b;
    b = d;
    b->print();
    cout << "*********************" << endl;

    derivate_class *d1 = (derivate_class*)cb;
    d1->print();
    d1->print1();

    system("pause");
    return 0; 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T00:35:47.777

这是UB，所以任何事情都可能发生。

但这里有一个解释：`d1`实际上并不指向 a `derivate_class`，而是指向 a `base`。

```
base* b = new base();
//...
base* cb = b;
derivate_class *d1 = (derivate_class*)cb;
d1->print();
d1->print1(); 
```

调用是动态解析的，因为它是通过指针并且方法是`virtual`.

`print1`不是`virtual`这样的呼叫是静态解决的。`print`然而是`virtual`，所以调用了最派生类型的实现。但派生最多的类型实际上是`base`在这种情况下。

在后台，该方法`print`在 vfptr in`cb`指向的虚函数表中查找。由于`cv`是 a `base`，表将是 的`base`，其中包含`print`具有`base::print`实现的函数。这就是为什么调用该函数的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T00:43:45.783

d1 是一个 derivate_class 指针，但它实际指向的数据 (cb) 是 base 类型。由于 print() 是虚拟的，因此调用是动态解析的，因此它将在虚拟函数表中找到 base 的实现，而不是 derivate_class 的。

# java - 超类和子类错误

> ID：13484562
> 
> 赞同：3
> 
> 时间：2012-11-21T00:34:22.540
> 
> 标签：java, subclass, superclass

我需要创建一个超类和子类，然后在子类中使用超类的面积和周长，但我不知道该怎么做。我对 java 和编程很陌生，所以我很抱歉可能看起来像个白痴。

从我的超级班：

```
public double getArea() {
    return width * height;
}

public double getPerimeter(){
    return 2 * (width + height);
} 
```

从我的子班（我的教授给我们使用的方程式）：

```
public double getArea(){
    return 2 * super.area() + length * super.perimeter();
} 
```

我收到以下错误：

```
Rectangle1.java:82: error: cannot find symbol
    return super.area() + length * super.perimeter(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T00:35:56.747

你的**超类**似乎没有**area()**和**perimeter()**方法。

```
 return 2 * super.area() + length * super.perimeter(); 
```

应该

```
 return 2 * super.getArea() + length * super.getPerimeter(); 
```

阅读有关[Super 在 Java 中的工作原理](http://www.google.co.uk/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CCIQFjAA&url=http://docs.oracle.com/javase/tutorial/java/IandI/super.html&ei=pSKsUK_wD87J0AXx8oD4Bw&usg=AFQjCNG0LHEAZjfZEfzU1ptAlorqeq26aw&sig2=Bbahi8H6nP-KKbdjyTJebA)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T00:37:38.593

尝试

```
return 2 * super.getArea() + length * super.getPerimeter(); 
```

# java - 帖子数据中的Spring Resttemplate意外字段“会话”

> ID：13484564
> 
> 赞同：0
> 
> 时间：2012-11-21T00:34:31.820
> 
> 标签：java, spring, resttemplate

```
{
    “平台”：“iOS”，
    “设备”： {
        "os_name": "iPhone 操作系统",
        “制造商”：“苹果”，
        “类型”：“iPhone3”，
        “版本”：“1”，
        “os_version”：“5.1.1”
    },
    "app_version": "1.0",
    “设备ID”： ””，
    "app_key": "1234567890",
    "developer_key": "",
    “app_name”：“测试”，
        "session": { // 这里
        “平台”：“iOS”，
        “设备”： {
            "os_name": "iPhone 操作系统",
            “制造商”：“苹果”，
            “类型”：“iPhone3”，
            “版本”：“1”，
            “os_version”：“5.1.1”
        },
        "app_version": "1.0",
        “设备ID”： ””，
        "app_key": "1234567890",
        "developer_key": "",
        “app_name”：“测试”
    }
}

```

这是 MappingJacksonConverter 生成的数据，但我不知道如何禁用包含整个递归数据的“会话”字段。

```
HttpEntity<OlSession> sessionEntity = new HttpEntity<OlSession>(new OlSession());

ResponseEntity<String> response = restTemplate.postForEntity("http://localhost:3000/test/abcd", sessionEntity, String.class); 
```

这是发布上述数据的代码。我需要添加任何部分来禁用“会话”字段吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T05:55:30.600

有两个简单的解决方案。

1）使用杰克逊注释忽略该属性。

但是这样一来，OlSession 属性中的 session 就不会到处序列化了。

```
@JsonIgnore
对象 getSession() {
  返回会话
}

```

看看这个文档[JacksonAnnotation](http://wiki.fasterxml.com/JacksonAnnotations)

2) 发送前只需设置 null 即可。

# iphone - 两个 CSS 问题 - 一个只发生在移动设备上，一个发生在 chrome 上

> ID：13484568
> 
> 赞同：0
> 
> 时间：2012-11-21T00:34:57.563
> 
> 标签：iphone, css, mobile, html

[链接已删除] 在 iPhone 上，顶部横幅不会一直伸展。解决方案？

这是截图：！[在此处输入图像描述][1]

这是应用于 div 的 CSS ive：

```
#banner {
    background-color: #F7F7F7;
    background-size: cover;
    box-shadow: 0 0 30px 2px #DCCFBF inset;
    display: inline-block;
    height: 200px;
    width: 100%; 
```

问题 2\. 在 chrome 中，当我调整浏览器窗口的大小时，底部的两个导航图标会移动（图形设计和社交媒体）。我将它们放在一个容器中以尝试将它们固定在适当的位置，但它仍然会发生……仅在 chrome 上。我意识到整个网站都发生了变化，但是导航中的其他图标会在一段时间后停止，底部的图标与它们重叠，看起来很糟糕。有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T00:43:39.990

横幅不会一直伸展，因为您的内容比移动 Safari 视为全宽的内容更宽。然后它会缩小整个页面以适应内容并稍微将标题拉开。

看到[这个类似问题的答案](https://stackoverflow.com/a/6697166/131226)

它通常通过添加来修复

```
<meta name="viewport" content="width=device-width, initial-scale=1.0" /> 
```

到`<head>`

至于图标，Chrome 似乎尊重`width: 100%`on `#home`（main.css 的第 528 行）的 @media 查询值，因为您缩小了浏览器窗口，而 Firefox 没有，并保留第一个值`width: 1020px`（l. 91）

# python - 通过 Python 计算 BMI：Take 2

> ID：13484573
> 
> 赞同：3
> 
> 时间：2012-11-21T00:35:13.380
> 
> 标签：python

对不起我之前的问题。我必须回答的问题是：

对于大多数人来说，体重指数 (BMI) 是衡量体脂率的良好指标。BMI 的公式是体重/身高2，其中体重以千克为单位，身高以米为单位。编写一个程序，提示以磅为单位的体重和以英寸为单位的身高，将值转换为公制，然后计算并显示 BMI 值。

我到目前为止是这样的：

```
"""
BMI Calculator

1\. Obtain weight in pounds and height in inches
2\. Convert weight to kilograms and height to meters
3\. Calculate BMI with the formula weight/height^2
"""

#prompt user for input from keyboard
weight= input ("How much do you weigh (in pounds)?")
#this get's the person's weight in pounds

weight_in_kg= weight/2.2
#this converts weight to kilograms

height= input ("What is your height (in inches)?")
#this gets the person's height in inches

height_in_meter=height*2.54
#this converts height to meters

bmi=weight_in_kg/(height_in_meters*2)
#this calculates BMI

print (BMI) 
```

我的第一步有效，但这是容易的部分。我知道在 Python 中等号分配了一些东西，所以我不确定这是否是问题所在，但我真的不知道该怎么做。真的对不起。当我运行程序时，它说：

TypeError : 不支持的操作数类型 /: 'str' 和 'float'

如果有人能给我任何关于我做错了什么的提示，我将不胜感激。如果没有，感谢您抽出宝贵时间。再次感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T00:39:06.310

**对于 Python 3.x（如指定）：**

问题是键盘输入`input()`是类型`str`（字符串），它不是数字类型（即使用户输入数字）。但是，这很容易通过更改输入行来解决，如下所示：

```
weight = float(input("How much do you weigh (in pounds)?")) 
```

和

```
height = float(input("What is your height (in inches)?")) 
```

从而将字符串输出`input()`转换为数字`float`类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T23:14:40.313

首先，有一个错字：`height_in_meter(S)`. 对于 Python 2，前面`float(...`不是必需的，尽管我确信这是一个很好的做法。

```
"""
BMI Calculator

1\. Obtain weight in pounds and height in inches
2\. Convert weight to kilograms and height to meters
3\. Calculate BMI with the formula weight/height^2
"""

#prompt user for input from keyboard
weight= input ("How much do you weigh (in pounds)?")
#this get's the person's weight in pounds

weight_in_kg= weight/2.2
#this converts weight to kilograms

height= input ("What is your height (in inches)?")
#this gets the person's height in inches

height_in_meter=height*2.54/100
#this converts height to centimeters

bmi=weight_in_kg/(height_in_meter**2)
#this calculates BMI

print (bmi) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-03T11:45:33.173

```
# height and weight are available as a regular lists

# Import numpy
import numpy as np

# Create array from height with correct units: np_height_m
np_height_m = np.array(height) * 0.0254

# Create array from weight with correct units: np_weight_kg 
np_weight_kg = np.array(weight) * 0.453592

# Calculate the BMI: bmi
bmi =  np_weight_kg / (np_height_m **2)

# Print out bmi
print(bmi) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-26T12:12:05.140

```
weight= float(input("How much do you weigh (in kg)?"))
weight_in_kg= float(input("Enter weight in kg?"))

#height= float(input("What is your height (in meters)?"))
height_in_meter= float(input("Enter height in metres?"))

bmi=weight_in_kg/(height_in_meter**2)

print (bmi) 
```

我发现这是使其工作的最简单方法，希望这会有所帮助

# iphone - GKSession 调用是否阻塞了主线程？

> ID：13484580
> 
> 赞同：0
> 
> 时间：2012-11-21T00:35:51.583
> 
> 标签：iphone, ios, ipad, gksession

我在技术说明[TN2277](http://developer.apple.com/library/ios/#technotes/tn2277/_index.html)中读到，当应用程序进入后台时，关闭各种网络套接字非常重要。这很可能还包括 GKSession。

他们说进入后台时需要一个过期处理程序，并且如果网络代码必须与其他对等点说“再见”，则必须异步调用它是很重要的。

那么 GKSession sendData 方法是异步的还是阻塞的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T13:38:33.673

在 iOS 6 中的某些情况下，GKSession 阻塞主线程肯定存在问题。目前，我们无法将 iPad 池移动到 iOS 6，因为我们的企业 GKSession 网络应用程序遇到了这些阻塞问题（但在 iOS 5 中没有或更早）。例如，从服务器 iPad 同时向超过 4 个 iPad 发送文件会导致阻止行为。在 iOS 5 中，我们可以毫无问题地将文件同时发送到多达 15 个连接的客户端。

此外，我们的初步测试表明，混合使用 iOS 5 和 6 设备如果 iOS 6 设备在 iOS 5 设备之后连接，那么 iOS 6 设备将遇到主线程锁定。

我已向 iOS 开发中心发布了一份事件报告，但没有收到任何回复...

11 月 30 日更新：我现在收到了 Apple 的回复，他们将其视为 iOS 6 中 GameKit 中的一个错误并正在调查。如果您在 iOS 6（但不是 iOS 5 或更早版本）中也遇到 GKSession 阻塞问题，那么您应该将其报告为错误。

# delphi - 删除运行时创建的 TLabel

> ID：13484584
> 
> 赞同：4
> 
> 时间：2012-11-21T00:35:58.687
> 
> 标签：delphi, runtime, vcl

如何删除创建的标签。我试过`FindComponent`但失败了，我该怎么办？我应该将父级设置为其他组件，如 TPanel 还是什么？

```
procedure TForm1.Button1Click(Sender: TObject);
var
  lblLink: TLabel;
begin
   for i := 0 to stringtList.Count-1 do
   begin 
     lblLink := TLabel.create(self);

     with lblLink do
     begin
       name:='lblLink'+inttostr(i);
       caption:inttostr(i);
       Parent := self;
       font.style := [fsUnderline];
       cursor := crHandPoint;
       color := clBlue;
       font.Color := clBlue;
     end;
   end;
end; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-21T00:46:28.870

您可以遍历 Components 属性，然后检查组件的名称并最终释放组件。

```
Var
  LIndex : Integer;
  LComponent : TComponent;
begin
  for LIndex := ComponentCount-1 downto 0 do
    if StartsText('lblLink',Components[LIndex].Name) then
    begin
     LComponent:=Components[LIndex];
     FreeAndNil(LComponent);
    end;
end; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T00:47:01.147

你不必释放它。你把释放它的责任交给了带有`lblLink := TLabel.create(self);`. 当表单被释放时，表单将释放标签。

但是，话虽如此，您可以通过循环遍历表单的`Components`数组来释放它：

```
procedure TForm1.DeleteLabel(const LabelName: string);
var
  i: Integer;
begin
  for i := ComponentCount - 1 downto 0 do
  begin
    if Components[i] is TLabel then
      if Components[i].Name = LabelName then
      begin
        Components[i].Free;
        Break;
      end;
  end;
end; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-21T01:58:26.163

您将 an`Owner`和 a分配`Parent`给 each `TLabel`，因此从技术上讲，您根本不需要释放它们。业主和家长都会为您处理。但是，如果您想更早地释放它们，您可以遍历所有者`Components`列表或父`Controls`列表，手动寻找标签。更好的选择是保留您自己创建的标签列表，然后您可以在需要时遍历该列表，例如：

```
type
  TForm1 = class(TForm)
    procedure FormCreate(Sender: TObject);
    procedure FormDestroy(Sender: TObject);
  ...
  private
    Labels: TList;
    procedure FreeLabels;
  ...
  end;

procedure TForm1.FormCreate(Sender: TObject);
begin
  Labels := TList.Create;
end;

procedure TForm1.FormDestroy(Sender: TObject);
begin
  Labels.Free;
end;

procedure TForm1.FreeLabels;
var
  I: Integer;
begin
  for I := 0 to Labels.Count-1 do
    TLabel(Labels[I]).Free;
  Labels.Clear;
end;

procedure TForm1.Button1Click(Sender: TObject);
var
  lblLink : TLabel;
  ...
begin 
  ...
  for I := 0 to StringList.Count-1 do
  begin 
    lblLink := TLabel.Create(Self);
    try
      with lblLink do
      begin
        Name := 'lblLink' + IntToStr(i);
        Parent := Self;
        Caption := IntToStr(i);
        Font.Style := [fsUnderline];
        Cursor := crHandPoint;
        Color := clBlue;
        Font.Color := clBlue;
      end;
      Labels.Add(lblLink);
    except
      lblLink.Free;
      raise;
    end;
  end;
end; 
```

# c# - 合并两个有序的 IObservable

> ID：13484587
> 
> 赞同：4
> 
> 时间：2012-11-21T00:36:09.143
> 
> 标签：c#, .net, sorting, system.reactive

我有两个 ordered`IObservable<double>`并想将它们合并为一个 ordered `IObservable<double>`。下面给出一个例子：

```
A    2  3  4  -  -       5  -
B    -  -  -  1  5       -  6
Out  -  -  -  1  2 3 4   5  - 
```

这个想法是`Out`只有在确定最终顺序时才会产生值。我确信这应该很容易做到，但我无法提供一个好的解决方案（在这种情况下，好的意味着尽可能多地由 rx 运算符组成）；

编辑：我希望以下程序产生以下输出

```
static void Main(string[] args)
{
    var a = new Subject<int>();
    var b = new Subject<int>();

    a.MergeSort(b).Subscribe(Console.WriteLine);

    a.OnNext(2);
    Console.WriteLine("tick");
    a.OnNext(4);
    Console.WriteLine("tick");
    a.OnNext(6);
    Console.WriteLine("tick");
    b.OnNext(0);
    Console.WriteLine("tick");
    b.OnNext(1);
    Console.WriteLine("tick");
    b.OnNext(5);
    Console.WriteLine("tick");
    b.OnNext(7);
    Console.WriteLine("tick");
}

Output:
tick
tick
tick
0
tick
1
tick
2
4
5
tick
6
tick 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T07:16:18.550

这是作为 RX 扩展运算符执行的

```
public static class MergeMixins
{
    public static IObservable<int> MergeSort(this IObservable<int> This, IObservable<int> other)
    {
        return Observable.Create<int>((observer) =>
            {
                Queue<int> BufferA = new Queue<int>();
                Queue<int> BufferB = new Queue<int>();

                Action<Queue<int>, int> update = (Queue<int> pushBuffer, int value)=>{

                    pushBuffer.Enqueue(value);

                    while (BufferA.Count() != 0 && BufferB.Count() != 0)
                    {
                        if (BufferA.Peek() < BufferB.Peek())
                            observer.OnNext(BufferA.Dequeue());
                        else
                            observer.OnNext(BufferB.Dequeue());
                    }
                };

                return new CompositeDisposable(
                    This.Subscribe(v => update(BufferA, v)),
                    other.Subscribe(v => update(BufferB, v)));

            });

    }

} 
```

广告我的测试输出正在使用您的测试

```
Result StandardOutput:  
tick
tick
tick
0
tick
1
tick
2
4
5
tick
6
tick 
```

# xml - 有没有办法使用 XPath 或 XQuery 在 SoapUI 中测试无序 XML 标记中的值？

> ID：13484590
> 
> 赞同：1
> 
> 时间：2012-11-21T00:36:33.030
> 
> 标签：xml, xpath, xquery, soapui

我已经编写了一个 REST 服务来访问 MySQL 数据库。该服务将很快移植到使用 MongoDB 数据库的较新系统。稍后，它可能会被移植到另一个使用 Oracle 的系统。

为什么我们要移植这么多并不重要。

生成的 XML 中有几个同名的嵌套标签，常见情况：

样本：

```
<root>
    <level1>
        <name>Karl</name>
    </level1>
    <level1>
        <name>Anton</name>
    </level1>
    <level1>
        <name>Friedrich</name>
    </level1>
    <level1>
        <name>Anton</name>
    </level1>

</root> 
```

我一直在使用 SoapUI 来测试系统之间的结果，以确保查询等仍然正常工作。集成测试等等。

所以问题是，在 XPath 或 XQuery 中是否有办法测试“Karl”在结果中出现一次，“Anton”出现两次，“Friedrich”出现一次？我通常只会测试 //root/level1[1]/name == "Karl" 等，但我不能依赖系统之间的一致排序。有没有办法测试无序的结果？或者也许有办法验证正确数量的 level1 元素是否具有相同的 name 值？我知道有一个`count`功能，但我不确定它的使用程度如何。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T01:41:56.247

> 所以问题是，在 XPath 或 XQuery 中是否有办法测试“Karl”在结果中出现一次，“Anton”出现两次，“Friedrich”出现一次？

**使用**：

```
count(/*/level1/name[.='Karl']) = 1

count(/*/level1/name[.='Anton']) = 2

count(/*/level1/name[.='Friedrich']) = 1 
```

这是三个独立的 XPath 表达式，每个表达式的计算结果都必须为`true()`.

**或者，您可以将它们组合成一个 XPath 表达式，该表达式只能计算一次：**

```
 count(/*/level1/name[.='Karl']) = 1
and
    count(/*/level1/name[.='Anton']) = 2
and
    count(/*/level1/name[.='Friedrich']) = 1 
```

# django - django动态表单生成

> ID：13484598
> 
> 赞同：0
> 
> 时间：2012-11-21T00:37:20.237
> 
> 标签：django, django-forms

说我有这样的模型：

```
 class ComponentLength(models.Model):
    component_name = models.CharField(max_length=155)
    length1 = models.IntegerField()
    length2 = models.IntegerField()
    length3 = models.IntegerField()
    length4 = models.IntegerField() 
```

现在我有一个表单供用户选择一个组件，在下一页上，我想为各种长度选项显示 4 个复选框，这些选项对于不同的组件是不同的。

在 Django 中，根据用户已经选择的组件名称（可在会话数据中访问）生成带有这些复选框的表单的最佳方法是什么。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T01:07:07.480

**您可以在init**方法中使用普通的 django 表单并在实例化时更改其字段。像这样的东西：

```
class SecondForm(forms.Form):
    def __init__(self, *args, **kwargs):
        super(SecondForm, self).__init__(*args, **kwargs)
        try:
            #get the object, something like this:
            obj_ = ComponentLength.objects.get(component_name = session.get('component_name_or_whatever_you_stored'))
        except:
            #handle the error case, e.g:
            return

            self.fields['length1'] = forms.CheckboxInput(attrs={'value' : obj_.length1 })
            self.fields['length2'] = forms.CheckboxInput(attrs={'value' : obj_.length2 })
            self.fields['length3'] = forms.CheckboxInput(attrs={'value' : obj_.length3 })
            self.fields['length4'] = forms.CheckboxInput(attrs={'value' : obj_.length4 })
            #Consider using a hidden input instead of polluting the session variables
            #with form data
            self.fields['component_length'] = forms.HiddenInput(attrs={'value' : obj_.pk}) 
```

上面的代码未经测试，但我希望它应该可以工作。请让我知道情况如何。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-06T00:33:59.757

表单向导正是您所需要的。

[https://docs.djangoproject.com/en/1.7/ref/contrib/formtools/form-wizard/](https://docs.djangoproject.com/en/1.7/ref/contrib/formtools/form-wizard/)

请参阅此处显示的示例[https://docs.djangoproject.com/en/1.7/ref/contrib/formtools/form-wizard/#usage-of-namedurlwizardview](https://docs.djangoproject.com/en/1.7/ref/contrib/formtools/form-wizard/#usage-of-namedurlwizardview)

以及此处如何定义表单[https://docs.djangoproject.com/en/1.7/ref/contrib/formtools/form-wizard/#conditionally-view-skip-specific-steps](https://docs.djangoproject.com/en/1.7/ref/contrib/formtools/form-wizard/#conditionally-view-skip-specific-steps)

我还没有测试过下面的代码，但它应该类似于以下内容：

## 我的应用程序/forms.py

```
from django.forms import ModelForm

from myapp.models import ComponentLength

class ComponentLengthNameForm(ModelForm):

    class Meta:
        model = ComponentLength
        fields = ['component_name',]

class ComponentLengthChoicesForm(ModelForm):

    class Meta:
        model = ComponentLength
        fields = ['length1', 'length2', 'length3', 'length4',] 
```

## 我的应用程序/views.py

```
from django.contrib.formtools.wizard.views import SessionWizardView
from django.shortcuts import render_to_response

class ComponentWizard(SessionWizardView):

    def done(self, form_list, **kwargs):
        return render_to_response('done.html', {
            'form_data': [form.cleaned_data for form in form_list],
        }) 
```

## 我的应用程序/urls.py

```
from django.conf.urls import url, patterns

from myapp.forms import ComponentLengthNameForm, ComponentLengthChoicesForm
from myapp.views import ContactWizard

named_contact_forms = (
    ('name', ComponentLengthNameForm),
    ('length-choices', ComponentLengthChoicesForm),
)

component_wizard = ComponentWizard.as_view(named_contact_forms,
    url_name='component-wizard-form-step', done_step_name='finished')

urlpatterns = patterns('',
    url(r'^my-form/(?P<step>.+)/$', component_wizard, name='component-wizard-form-step'),
    url(r'^my-form/$', component_wizard, name='component-wizard-form'),
) 
```

# actionscript-3 - 未定义属性 keyUpHandler 的访问

> ID：13484599
> 
> 赞同：0
> 
> 时间：2012-11-21T00:37:24.060
> 
> 标签：actionscript-3, flash, event-handling

```
Scene 1, Layer 'script', Frame 1, Line 39

1120: Access of undefined property keyUpHandler. 
```

好的，所以我正在关注本教程[http://as3gametuts.com/2012/04/05/platformer-8/](http://as3gametuts.com/2012/04/05/platformer-8/) ^ 只是为了有一个来源而不是自己声明这项工作

我创造了

```
stage.addEventListener(KeyboardEvent.KEY_UP, keyUpHandler); 
```

后来在我的代码中：

```
function keyUpHandler(e:KeyboardEvent):void{
    if(e.keyCode == Keyboard.LEFT){
        leftPressed = false;

    } else if(e.keyCode == Keyboard.RIGHT){
        rightPressed = false;

    } else if(e.keyCode == Keyboard.UP){
        upPressed = false;

    } else if(e.keyCode == Keyboard.DOWN){
        downPressed = false;
    }   
} 
```

我的错误信息在顶部，有什么想法为什么我得到这个？感谢阅读：P

我的整个代码：

```
var leftPressed:Boolean = false;
var rightPressed:Boolean = false;
var upPressed:Boolean = false;
var downPressed:Boolean = false;

var leftBumping:Boolean = false;
var rightBumping:Boolean = false;
var upBumping:Boolean = false;
var downBumping:Boolean = false;

var leftBumpPoint:Point = new Point(-30, -55);
var rightBumpPoint:Point = new Point(30, -55);
var upBumpPoint:Point = new Point(0, -120);
var downBumpPoint:Point = new Point(0, 0);

var scrollX:Number = 0;
var scrollY:Number = 500;

var xSpeed:Number = 0;
var ySpeed:Number = 0;

var speedConstant:Number = 4;
var frictionConstant:Number = 0.9;
var gravityConstant:Number = 1.8;
var jumpConstant:Number = -35;
var maxSpeedConstant:Number = 18;

var doubleJumpReady:Boolean = false;
var upReleasedInAir:Boolean = false;

var carrotCollected:Boolean = false;
//var carrotGathered.visible = false; //HER
var snowmanHappy:Boolean = false;
var openDoor:Boolean = false;

stage.addEventListener(KeyboardEvent.KEY_DOWN, keyDownHandler);
stage.addEventListener(KeyboardEvent.KEY_UP, keyUpHandler);

stage.addEventListener(Event.ENTER_FRAME, loop);

function loop(e:Event):void{
    if(back.collisions.hitTestPoint(player.x + leftBumpPoint.x, player.y + leftBumpPoint.y, true)){
        //trace("leftBumping");
        leftBumping = true;
    } else {
        leftBumping = false;
    }

    if(back.collisions.hitTestPoint(player.x + rightBumpPoint.x, player.y + rightBumpPoint.y, true)){
        //trace("rightBumping");
        rightBumping = true;
    } else {
        rightBumping = false;
    }

    if(back.collisions.hitTestPoint(player.x + upBumpPoint.x, player.y + upBumpPoint.y, true)){
        //trace("upBumping");
        upBumping = true;
    } else {
        upBumping = false;
    }

    if(back.collisions.hitTestPoint(player.x + downBumpPoint.x, player.y + downBumpPoint.y, true)){
        //trace("downBumping");
        downBumping = true;
    } else {
        downBumping = false;
    }   

    if(leftPressed){
        xSpeed -= speedConstant;
        player.scaleX = -1;

    } else if(rightPressed){
        xSpeed += speedConstant;
        player.scaleX = 1;
    }

    /*if(upPressed){
        ySpeed -= speedConstant;

    } else if(downPressed){
        ySpeed += speedConstant;

    }*/

    if(leftBumping){
        if(xSpeed < 0){
            xSpeed *= -0.5;
        }
    }

    if(rightBumping){
        if(xSpeed > 0){
            xSpeed *= -0.5;
        }
    }

    if(upBumping){
        if(ySpeed < 0){
            ySpeed *= -0.5;
        }
    }

    if(downBumping){
        if(ySpeed > 0){ 
            ySpeed = 0; 
        }
        if(upPressed){ 
            ySpeed = jumpConstant; 
        }

        //DOBBELTHOPP..
        if(upReleasedInAir == true){
            upReleasedInAir = false;
        }
        if(doubleJumpReady == false){
            doubleJumpReady = true;
        }
    } else { 

        ySpeed += gravityConstant; 

        //DOBBELTHOPP
        if(upPressed == false && upReleasedInAir == false){
            upReleasedInAir = true;

        }
        if(doubleJumpReady && upReleasedInAir){
            if(upPressed){ 
                doubleJumpReady = false;
                ySpeed = jumpConstant; //set the y speed to the jump constant
            }
        }

    }

    if(xSpeed > maxSpeedConstant){ //moving right
        xSpeed = maxSpeedConstant;
    } else if(xSpeed < (maxSpeedConstant * -1)){ //moving left
        xSpeed = (maxSpeedConstant * -1);
    }

    xSpeed *= frictionConstant;
    ySpeed *= frictionConstant;

    if(Math.abs(xSpeed) < 0.5){
        xSpeed = 0;
    }

    scrollX -= xSpeed;
    scrollY -= ySpeed;

    back.x = scrollX;
    back.y = scrollY;

    sky.x = scrollX * 0.2;
    sky.y = scrollY * 0.2;

    if(carrotCollected == false){
        if(player.hitTestObject(back.carrot)){ 

            back.carrot.visible = false;
            carrotGathered.visible = true; // HER
            carrotCollected = true;
        }
    }

    if(snowmanHappy == false){
        if(carrotCollected == true){
            if(player.hitTestObject(back.snowMan)){

                carrotGathered.visible = false; // HER
                back.snowMan.gotoAndPlay(2);
                snowmanHappy = true;
            }
        }
    }

    if(openDoor == false){
        if(snowmanHappy == true){
            if(player.hitTestObject(back.snowMan)){

                back.lockedDoor.gotoAndStop(2);
                openDoor = true;
            }
        }
    }

}

function keyDownHandler(e:KeyboardEvent):void{
    if(e.keyCode == Keyboard.LEFT){
        leftPressed = true;

    } else if(e.keyCode == Keyboard.RIGHT){
        rightPressed = true;

    } else if(e.keyCode == Keyboard.UP){
        upPressed = true;

    } else if(e.keyCode == Keyboard.DOWN){
     downPressed = true;
     /*if(openDoor && player.hitTestObject(back.other.lockedDoor)){

          gotoAndStop(2);
     }*/
}

function keyUpHandler(e:KeyboardEvent):void{
    if(e.keyCode == Keyboard.LEFT){
        leftPressed = false;

    } else if(e.keyCode == Keyboard.RIGHT){
        rightPressed = false;

    } else if(e.keyCode == Keyboard.UP){
        upPressed = false;

    } else if(e.keyCode == Keyboard.DOWN){
        downPressed = false;
    }   
 }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T01:16:10.063

你的 keyuphandler 被 KeyDownHandler 吞没了。检查您的`{`和，`}`因为您已将其注释掉。

# ruby-on-rails-3 - ajax 调用后没有重定向到任何地方

> ID：13484605
> 
> 赞同：0
> 
> 时间：2012-11-21T00:38:12.533
> 
> 标签：ruby-on-rails-3, jquery

我使用 jQuery fileupload 插件上传多张图片。我将插件设置为：

```
$(function(){
    $('#fileupload').fileupload({
      url: "/polls",
      dataType: "html"
    });
  }) 
```

PollsController（简而言之）：

```
def new
    authenticate
    @poll = Poll.new
    respond_to do |format|
      format.html
    end
  end

def create
    @poll.nil? ? @poll = Poll.create(params[:poll]) : @poll.update_attributes(params[:poll])
    if @poll.errors.full_messages.empty?
      respond_to do |format|
        format.html{ redirect_to @poll }
      end   
    else
      flash[:"alert-error"] = @poll.errors.full_messages
      respond_to do |format|
        format.html{ redirect_to '/polls/new' }
      end  
    end
end 
```

我正在测试验证，所以我在提交表单后得到：

```
 ...
    (0.3ms)  BEGIN
   (0.3ms)  ROLLBACK
Redirected to http://localhost:3000/polls/new
Completed 302 Found in 644ms (ActiveRecord: 1.1ms)

Started GET "/polls/new" for 127.0.0.1 at 2012-11-20 16:27:31 -0800
Processing by PollsController#new as HTML
  User Load (0.6ms)  SELECT "users".* FROM "users" WHERE "users"."id" = 18 LIMIT 1
  Rendered polls/_template.haml (0.1ms)
  Rendered polls/_jQuery_fileupload_plugin.haml (5.9ms)
  Rendered polls/new.haml within layouts/application (14.3ms)
  Rendered sessions/_signin.haml (3.9ms)
  Rendered layouts/_header.haml (5.3ms)
  Rendered layouts/_footer.haml (0.6ms)
Completed 200 OK in 42ms (Views: 38.0ms | ActiveRecord: 0.6ms) 
```

但是页面实际上并没有重新加载。为什么会这样？

谢谢

# ant - Ant 中是否存在与 erroronmissingdir 等效的缺失文件？

> ID：13484606
> 
> 赞同：1
> 
> 时间：2012-11-21T00:38:13.003
> 
> 标签：ant, fileset

我们在 Ant 构建中设置了一个文件，如下所示：

```
<fileset dir="somewhere/lib" includesfile="third-party-jars.txt"/> 
```

然后在文本文件中完整拼写每个 jar。（我们将它放在单独的文本文件中的原因实际上与构建文件的简洁性无关，而是为了更容易从我们拥有的集成测试中检查列表，该测试检查所有第三方 jar 文件许可证是否已记录。 )

有人提交了阻止文件进入构建的提交。Ant 根本没有拾取丢失的文件——构建继续进行。即使文件名被完整拼写，也没有检测到丢失的文件，这似乎很糟糕......所以我现在正试图解决这个问题。

有一个属性`erroronmissingdir`，但添加它并没有帮助（`dir`没有丢失。）有没有办法在文件集中丢失文件时出错？理想情况下是一种紧凑的方式……因为我们拥有多个这些文件集，并且复制代码听起来并不吸引人。

其他人已经询问了他们想要检查单个文件的更简单的变体。要检查单个文件，请使用`available`任务。似乎`available`只支持一种资源。

我尝试限制资源收集以尝试查找可用资源和不可用资源。

```
<restrict id="temp.available"><resources refid="@{ref-name}"/></restrict>
<difference id="temp.unavailable">
  <resources refid="@{ref-name}"/>
  <resources refid="temp.available"/>
</difference>
<fail message="Missing stuff">
  <condition>
    <resourcecount refid="temp.unavailable" when="greater" count="0"/>
  </condition>
</fail> 
```

这不起作用，似乎是因为资源集合已经缺少不存在的项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T02:55:28.377

您所要求的内容无法通过本机`fileset`支持获得。`fileset`用作扫描器：它基于特定目录，并根据您提供的包含/排除模式包含所有文件。直到 Ant 1.7 左右， Even`erroronmissingdir`才成为其中的一部分。`fileset`

最好的办法是围绕`available`任务编写一个宏，将资源集合传递给宏并使用`for`循环（来自 Ant-Contrib）来测试每个文件的可用性。

# xaml - WinRT / Win8 中 XAML 解析的效率如何？

> ID：13484621
> 
> 赞同：4
> 
> 时间：2012-11-21T00:39:44.973
> 
> 标签：xaml, windows-8, windows-runtime

创建 UserControls 时，看起来每次初始化控件时都会解析 XAML。

例如，当我创建一个 UserControl 时，会自动生成代码来初始化如下所示的组件：

```
public void InitializeComponent()
{
    if (_contentLoaded)
        return;

    _contentLoaded = true;
    global::Windows.UI.Xaml.Application.LoadComponent(this, new global::System.Uri("ms-appx:///Views/MyView.xaml"), global::Windows.UI.Xaml.Controls.Primitives.ComponentResourceLocation.Application);

} 
```

这也存在于 Silverlight 中。

创建一次或两次控件并不是什么大问题，但是如果我在每个带有 Visual-States 和绑定的 UserControl 中都有一个大型可视化树，并且我在每个应用程序生命周期中创建了很多次，那么构建可视化将是有意义的使用 C# 控制以提高性能。

**所以，我的问题是：**

解析器/框架是否“记住” XAML 文件并避免在后续调用中再次重新解析它？也就是说，它是否创建了 XAML 的二进制表示，因此它不必重新读取文本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-08T22:25:20.273

Windows 8.1 xaml 终于添加了 XAML 二进制格式 :)

XAML 二进制格式：最终签名的 appx 将不再包含基于文本的标记，因为它将被转换为二进制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T01:10:55.830

据我了解，XAML 被编译成二进制形式作为应用程序中的资源。运行时不必解析 .xaml 文件的文本，就像它不必解析您的 .cs 代码文件一样。

实例化使用 XAML 声明的类的性能应该与在代码中创建它的性能相当。

# vim - clang_complete - cc_args.py 不会生成 .clang_complete 文件

> ID：13484622
> 
> 赞同：2
> 
> 时间：2012-11-21T00:39:48.507
> 
> 标签：vim, clang, clang-complete

我已经设置了一个简单的项目来测试 VIM 作为 C++ 编译器的可行性以及教程中的简单 makefile，但我似乎无法从 cc_args.py 脚本生成 .clang_complete 文件。

自述文件说我应该运行：

```
make CC='~/.vim/bin/cc_args.py gcc' CXX='~/.vim/bin/cc_args.py g++' -B 
```

但它不会从 makefile 生成 .clang_complete 文件。

这是我的简单项目。

```
//hello.cpp
#include "hello.h"

int main(void)
{
    hello();
    return 0;
}

//hello_fn.cpp
#include <iostream>
#include "hello.h"

void hello()
{
    std::cout << "Hello world!";
}

//hello.h
#ifndef HELLO_H
#define HELLO_H
void hello();
#endif 
```

生成文件：

```
CC=g++
CFLAGS=-Ihead
DEPS = hello.h
OBJ = hello.cpp hello_fn.cpp

%.o: %.cpp $(DEPS)
    $(CC) -c -o $@ $< $(CFLAGS)

hello: $(OBJ)
    g++ -o $@ $^ $(CFLAGS) 
```

hello.h 在名为 head 的目录中。

跑步：

```
make CC='.vim/bundle/clang_complete/bin/cc_args.py gcc' CXX='.vim/bundle/clang_complete/bin/cc_args.py g++' -B 
```

或者：

```
make CXX='.vim/bundle/clang_complete/bin/cc_args.py g++' -B 
```

不会产生 .clang_complete 文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T04:44:52.940

您的 Makefile 忽略`CC`和`CXX`环境变量，直接使用`g++`。将 hello 规则更改为

```
hello: $(OBJ)
    $(CXX) -o $@ $^ $(CFLAGS) 
```

然后`make CXX='.vim/bundle/clang_complete/bin/cc_args.py g++' -B`应该工作。

该`%.o: %.cpp $(DEPS)`规则确实使用`CC`，但从未使用此规则，因为您的`OBJS`变量都是变量`.cpp`而不是`.o`变量。

# delphi - 根据鼠标在 Delphi TListView 控件中的哪一列显示不同的弹出菜单？

> ID：13484628
> 
> 赞同：0
> 
> 时间：2012-11-21T00:40:24.657
> 
> 标签：delphi, listview, popupmenu

我有一个具有 TJvListView 控件的 Delphi 6 应用程序。我有一个通过控件的 PopupMenu 属性绑定到该控件的弹出菜单。我想做的是根据用户在右键单击时将鼠标悬停在哪个列上显示不同的弹出菜单，如果当前列不需要，则附加选项根本不显示弹出菜单。我怎样才能做到这一点？

感谢 Remy Lebeau 在[TListView 中进行就地编辑的](https://stackoverflow.com/questions/10835355/in-place-editing-of-a-subitem-in-a-tlistview)详细示例，我知道鼠标在哪一行和哪一列上，除了一个皱纹。我确定当前行和列的鼠标按下事件在弹出菜单退出*后发生。*

我现在需要知道两件事。首先，如何在鼠标右键单击后弹出菜单显示*之前*触发一些事件，以便我可以记录当前列表视图的行和列并在需要时抑制弹出菜单，其次，如何显示不同的基于当前列的弹出窗口。我希望避免编写一堆迷你表单，而不是使用 TListView PopupMenu 属性和支持代码。有没有一个简单的解决方案，也许我应该在 TJvListView 周围创建一个子类中的一些花哨的步法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T00:52:27.480

您可以在 mousemove 而不是 mousedown/Click 中执行检测，并根据情况更改弹出菜单。您还可以删除任何弹出菜单并根据需要在 mousedown 中通过 p.pupup 调用希望的菜单。

# c - 从顺序文件中选择性地打印行

> ID：13484632
> 
> 赞同：2
> 
> 时间：2012-11-21T00:41:02.457
> 
> 标签：c, file, text-files

我可以让我的程序打印出我的文本文件，但我怎样才能让它打印出特定的行呢？就像在几行中有相同的东西并且我希望在运行程序时打印它们？

```
#include <stdio.h>

int main ( void ){
    static const char filNavn[] = "test.txt";
    FILE *fil = fopen( filNavn, "r" );
    if ( fil != NULL ){
        char line [ 256 ];
        while( fgets( line, sizeof( line ), fil ) != NULL ){
            fputs( line, stdout );
        }
        fclose( fil );
    }
    else{
        perror( filNavn );
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T02:04:55.300

基本上你需要做的是：

1.  在变量中存储一个插槽`line`（您所说的 44 个字符）。
2.  使用lib 中的`strstr`函数查找字符串存在的位置，如果不存在，则返回一个指针。`string.h``line``"2 - 0"``NULL`
3.  如果指针不是`NULL`，那么您可以打印该行。
4.  这个循环将一直持续到`fil`指针到达`end of the file`.

    ```
    if ( fil != NULL ){

        /* 44 characters because you said that the data is stored in strings of 44\. */
        /* And I will think that you inputed the data correctly. */
        char line [ 44 ];

        /* While you don't reach the end of the file. */
        while( !feof( fil ) ){

            /* Scans the "slot" of 44 characters (You gave it that format)*/
            /* starting at the position of the pointer fil and stores it in fil*/
            fscanf( fil, %44s, line );

            /* If the result of the internal string search (strstr) isn't null. */
            /* Print the line.*/
            if( strstr( line, "2 - 0" ) != NULL ){
                printf( "%s\n", line )
            }

            /* Else keep the loop....*/
        }

        fclose( fil );
    } 
    ```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-21T01:02:07.800

只需将您的条件放入读取/打印循环中：

# 包括

```
int main ( void )
{
    static const char filNavn[] = "test.txt";
    FILE *fil = fopen( filNavn, "r" );
    if ( fil != NULL )
    {
        char line [ 256 ];
        while( fgets( line, sizeof line, fil ) != NULL )
        {
            // if this line is interesting (eg, has something "the same")
               fputs( line, stdout );
        }
        fclose( fil );
    }
    else
    {
        perror( filNavn );
    }
    return 0;
} 
```

# sql - STContains on Geography 列

> ID：13484636
> 
> 赞同：0
> 
> 时间：2012-11-21T00:41:52.433
> 
> 标签：sql, sql-server-2008, tsql, sql-server-2008-r2, spatial

我在纬度/经度（地理）有一个公共汽车站。我想检查我的巴士点（纬度/经度）在某个地区的位置。我的区域是一组纬度/经度点。我有地理形式的一个地区的纬度/经度（构成一个地区的纬度/经度的轮廓）。现在我有一个纬度/经度点，我想确定该点是否位于我的区域内。我怎样才能做到这一点？4000个点构成一个区域的轮廓，一个点是检查该区域是否存在。我将如何检查？

我想我可以使用`STContains`or`STintersect`但我不知道确切的语法。

```
SELECT
    Region.BlockID, Bus_Route.geography
FROM
    Bus_Route, Region
WHERE
    Region.points.STContains(Bus_Route.geography) = 1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:08:21.463

我使用我为您编写的代码（[*从 ShapeFile 存储“点”列*](https://stackoverflow.com/questions/12809201/storing-point-column-from-shapefile/12809687#12809687)）作为获取点表的起点。从那里：

```
select geography::STPolyFromText(
'POLYGON((' + 
    stuff((
        select ',' + cast(g.STPointN(t.i).Long as varchar(10)) + ' ' + cast(g.STPointN(t.i).Lat as varchar(10))
        from [a]
        cross join tally as [t]
        where t.i <= g.STNumPoints()
        order by i
        for xml path('')

    ), 1, 1, '') + '))'
    , 4326) 
```

这段代码假设了几件事。第一：你的点是按照你在区域边界周围的顺序排列的。这很重要。想想一个连接点的谜题。为了获得正确的图片，您必须以正确的顺序进行操作。其次，与第一个相关，它们必须处于正确的方向。多边形遵循左手规则。也就是说，如果您按顺序遍历这些点，则您正在定义左侧的区域。因此，如果您以相反的顺序指定点，您将获得除您所在地区之外的所有内容！您将立即知道这一点，因为在 SQL 2012 之前，您仅限于拥有完全包含在半球中的区域。

但现在我不得不问：鉴于您之前提出的问题（我在上面链接到），您是否收到带有多边形的 shapefile？如果是这样，请将其存储起来，免去重建它的麻烦。

# c# - 如何根据MultiView中的活动视图存储多个滚动位置以滚动div元素（asp.net webform

> ID：13484638
> 
> 赞同：0
> 
> 时间：2012-11-21T00:41:56.277
> 
> 标签：c#, asp.net, asp.net-ajax

令人困惑的标题，但我可以说的最好的方式。

基本上我目前正在使用一个带有溢出的 div：auto 包含不同的 GridViews。GridViews 通过使用 MultiView 交换，每个单独的视图包含一个 GridView。

我希望能够存储每个视图的滚动位置，以便我可以根据要切换到的视图设置 div 的滚动位置。

这是我的页面的设置方式。

```
<div id="scrollingDiv" style="height:100%; overflow:auto;">
  <div id="gridWrap">

  <asp:UpdatePanel ID="UpdatePanel1" runat="server" RenderMode="Inline">
  <ContentTemplate>
    <asp:MultiView ID="MultiView1" runat="server">
      <asp:View ID="view1" runat="server">
        <asp:GridView ID="gridView1" runat="server">
        </asp:GridView>
      </asp:View>

      <asp:View ID="view2" runat="server">
        <asp:GridView ID="gridView2" runat="server">
        </asp:GridView>
      </asp:View>
    </asp:Multiview>
  </ContentTemplate>
  </asp:UpdatePanel>

  </div>
</div> 
```

所以 scrollingDiv 将包含所有的 View 并且会为每一个 GridView 滚动。

要在视图之间切换，我有一个连接到

```
protected void DropDownList_SelectedIndexChanged(object sender, EventArgs e)
{
    switch (DownList.SelectedItem.Value)
    {

        case "view1":
            MultiView1.SetActiveView(view1);
            break;
        case "view2":
            MultiView1.SetActiveView(view2);
            break;
    }
} 
```

我一直在环顾四周，找不到特定于我的情况的东西。我希望能够只使用一个溢出 div，但会理解是否必须为每个视图制作一个单独的溢出 div。

任何帮助都会很棒，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T04:50:45.943

jQuery 和一些隐藏字段可以提供帮助。尝试这个...

```
 <asp:Hiddenfield ID="hdnCurrentView" runat="server"/>
    <asp:Hiddenfield ID="hdnMultiView1Top" runat="server"/>
    <asp:Hiddenfield ID="hdnMultiView2Top" runat="server"/> 
```

在后端，即在您的 CS 文件中，在隐藏字段中设置当前视图...

```
 protected void DropDownList_SelectedIndexChanged(object sender, EventArgs e)
    {
        switch (DownList.SelectedItem.Value)
        {
            case "view1":
                MultiView1.SetActiveView(view1);
                hdnCurrentView.Value = "View1";
                break;
            case "view2":
                MultiView1.SetActiveView(view2);
                hdnCurrentView.Value = "View2";
                break;
        }
    } 
```

然后在你的 jQuery 就绪函数中，

```
 $().ready(function() {

        //for storing scroll position of each view in respective hiddenfields
        $(window).scroll(function () {
          if ($("#hdnCurrentView").val() == "View1") {
             $("#hdnMultiView1Top").val($(window).scrollTop());
          }
          else if ($("#hdnCurrentView").val() == "View2") {
             $("#hdnMultiView2Top").val($(window).scrollTop());
          }
        });

        //for restoring scroll position on page load i.e., ready function in jQuery 
        if ($("#hdnCurrentView").val() == "View1") {
           $(window).scrollTop($("#hdnMultiView1Top").val());
        }
        else if ($("#hdnCurrentView").val() == "View2") {
           $(window).scrollTop($("#hdnMultiView2Top").val());
        }

    }); 
```

这将保持每个多视图的垂直滚动位置。如果您也想保持水平滚动位置，请为每个视图设置隐藏字段并使用下面给出的 jQuery 函数。留给你作为练习...

```
 $(window).scrollLeft(value); 
```

快乐编码……；）

# python - 从 Python 3.x 中的二维列表中获取单个列表？

> ID：13484642
> 
> 赞同：0
> 
> 时间：2012-11-21T00:42:21.673
> 
> 标签：python, list, python-3.x

这里有一些困难。我的目标是从游戏板的列中读取数字并将这些数字打印为特定列表。我对列表没有太多经验，也没有正确掌握这个概念，所以我很难让它们起作用。到目前为止，我能想到的只有这样：

```
def getColumn ():
    for i in range (0, 9):
        row = datalist[i]
        column = row[x]
        column.append[i] 
```

好像不能正常工作，谁能指出原因？我真的很感激！

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T00:45:52.770

尝试做这样的事情来使用内置

```
rows = [[1,2,3],[4,5,6],[7,8,9]]

cols = zip(*rows)

print cols[0]  #column 0 .... 
```

或者更好地使用 numpy

```
import numpy as np

my_board = [[1,2,3],[4,5,6],[7,8,9]]
np_ar   = np.array(my_board)

print np_ar[:,2]  #print column 2 .. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T00:52:51.520

这行得通吗？

```
col = 1
column1 = [row[col] for row in datalist] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T00:55:57.880

这是一个调整原始代码的版本：

```
datalist = [
    [1, 2, 3],
    [4, 5, 6],
    [7, 8, 9]
]

def getColumn(col_num, data):
    column = []
    for i in range (0, len(data)):
        row = data[i]
        column.append(row[col_num])
    return column 
```

这使：

```
getColumn(1, datalist)
Out[9]: [2, 5, 8] 
```

您的原始代码存在一些问题：

*   你没有办法告诉`getColumn`你想要哪一列——你需要把它作为你的函数的参数
*   `getColumn`依赖于有一个名为`datalist`. 将数据作为参数传递更安全。
*   `datalist`必须恰好有九行，否则您会收到错误或无法返回完整的列。

# css - Bourbon 没有找到 font-face mixin (Rails 3.2.2)

> ID：13484644
> 
> 赞同：0
> 
> 时间：2012-11-21T00:42:38.590
> 
> 标签：css, ruby-on-rails, sass, bourbon

根据[Ryan Bates 在 Bourbon 上的截屏视频](http://railscasts.com/episodes/330-better-sass-with-bourbon?view=comments)，我的`application.css.scss`文件如下：

```
@import "bourbon";
@import "main";
@import "events";
..etc. 
```

在我的`main.css.scss`样式表中一切正常，我可以`@include transition()`完美地使用 mixin，但是当我尝试使用时`@include font-face`，我的`Undefined mixin 'font-face'.`Rails 应用程序中出现错误。

确切的代码行是

```
@include font-face(HN, '/helveticaneue', normal, $asset-pipeline: true); 
```

我试过没有`normal`and just `'helveticaneue'`（没有斜线）。该文件存在并且没有损坏，因为使用 CSS`@font-face`有效。

根据[这个波旁威士忌问题](https://github.com/thoughtbot/bourbon/issues/130)，我有

```
gem 'bourbon', :git => 'git://github.com/thoughtbot/bourbon.git', :ref => 'f93cf9e' 
```

在我的 Gemfile 中。

为什么 Bourbon 不选择 mixin？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T15:17:20.283

我已经为我解决了这个问题。如果您包含波旁威士忌，则所有 css 文件都必须是 .scss 或 .sass 文件，否则您将收到此不相关的错误。如果你有一些不是 scss 或 sass 的 css 文件，你必须在 scss（或 sass）中重命名它们。

# php - 访问 Atlassian Jira REST API 以在过滤器上运行超级简单的报告

> ID：13484647
> 
> 赞同：5
> 
> 时间：2012-11-21T00:42:57.107
> 
> 标签：php, rest, jira, jira-rest-api

我想要的基本上就是登录，显示来自一个简单过滤器的信息，就像里程碑中所有打开的错误一样。一旦我病得那么远，就可以处理文档

我希望使用简单的 PHP，那是因为我是 PHP 新手，所以编码越复杂，我就越难弄清楚。

这个脚本是我最接近成功的：

```
 <?php

define('JIRA_URL', 'https://mysite.atlassian.net');
define('USERNAME', 'me@gmail.com');
define('PASSWORD', '11111');

function post_to($resource, $data) {
        $jdata = json_encode($data);
        $ch = curl_init();
        curl_setopt_array($ch, array(
                CURLOPT_POST => 1,
                CURLOPT_URL => JIRA_URL . '/rest/api/2/' . $resource,
                CURLOPT_USERPWD => USERNAME . ':' . PASSWORD,
                CURLOPT_POSTFIELDS => $jdata,
                CURLOPT_HTTPHEADER => array('Content-type: application/json'),
                CURLOPT_RETURNTRANSFER => true
        ));
        $result = curl_exec($ch);
        curl_close($ch);
        return json_decode($result);
}

function create_issue($issue) {
        return post_to('issue', $issue);
}

$new_issue = array(
        'fields' => array(
                'project' => array('key' => 'FOO'),
                'summary' => 'Test via REST',
                'description' => 'Description of issue goes here.',
                'issuetype' => array('name' => 'Story')
        )
);

$result = create_issue($new_issue);
if (property_exists($result, 'errors')) {
        echo "Error(s) creating issue:\n";
        var_dump($result);
} else {
        echo "New issue created at " . JIRA_URL ."/browse/{$result->key}\n";
        var_dump($result);
}
?> 
```

它返回在[http://mysite.atlassian.net/browse/创建的新问题](http://mysite.atlassian.net/browse/)

但是，当我将 var_dump ($result) 放在那里时，它只返回 null，所以我不知道 jira URL 是否错误或我的密码是否错误，或者它是否为新的 rest API 提供了过时的代码。

如果我可以对 API 进行 1 次简单查询并在我的 PHP 页面上看到返回的任何内容，我将是一个快乐的露营者。上面的示例创建了一个新问题，这只是我正在使用的示例，但我可以只返回任何类型的数据，所以我的主要问题是获取有效连接并返回一些信息，所以我知道它正在工作并且无法启动然后尝试一些不同的东西。

我有管理员访问权限，但我不清楚是否需要在管理员端启用某些东西。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-22T03:12:26.073

我想出了我需要做什么，网上有很多例子，但我找不到这样简单的例子，所以希望它可以帮助别人

```
$username = 'xxx';
$password = 'xxx';

$url = 'https://xxx.atlassian.net/rest/api/2/Issue/Bug-5555';

$curl = curl_init();
curl_setopt($curl, CURLOPT_USERPWD, "$username:$password");
curl_setopt($curl, CURLOPT_URL, $url);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($curl, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, 0);
curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, 0);

$issue_list = (curl_exec($curl));
echo $issue_list; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-03-18T15:44:30.557

跟随本页...

[https://developer.atlassian.com/jiradev/api-reference/jira-rest-apis/jira-rest-api-tutorials/jira-rest-api-example-basic-authentication](https://developer.atlassian.com/jiradev/api-reference/jira-rest-apis/jira-rest-api-tutorials/jira-rest-api-example-basic-authentication)

这些天我们需要使用标头身份验证，它看起来 - 修改此步骤中的示例 - 如：

```
$username = 'user';
$password = 'pass';

$url = 'https://www.jiradomain.com/rest/api/2/issue/PROJECT-321/worklog';

$curl = curl_init();

curl_setopt($curl, CURLOPT_HTTPHEADER, array('Authorization: Basic ' . base64_encode("$username:$password")) );**
curl_setopt($curl, CURLOPT_URL, $url);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($curl, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, 0);
curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, 0);
curl_setopt($curl, CURLOPT_VERBOSE, true);

$verbose = fopen('php://temp', 'rw+');
curl_setopt($curl, CURLOPT_STDERR, $verbose);

$issue_list = (curl_exec($curl));
echo $issue_list;

$result = curl_exec($curl);
if ($result === FALSE) {
    printf("cUrl error (#%d): %s<br>\n", curl_errno($curlHandle),
           htmlspecialchars(curl_error($curlHandle)));
}

rewind($verbose);
$verboseLog = stream_get_contents($verbose);

echo "Verbose information:\n<pre>", htmlspecialchars($verboseLog), "</pre>\n"; 
```

# visual-studio-2012 - VS2012添加引用后改变装配位置

> ID：13484650
> 
> 赞同：1
> 
> 时间：2012-11-21T00:43:25.323
> 
> 标签：visual-studio-2012

我有一个 VS2010 的 TFS 策略，我也想在 VS2012 中使用它，所以我创建了一个新项目（一个针对 Framework 4.5 的库）并开始迁移，问题是 VS2012 坚持更改我的引用路径，例如：

```
C:\Program Files (x86)\Common Files\Microsoft Shared\MSEnv\PublicAssemblies\envdte.dll
C:\Program Files (x86)\Microsoft Visual Studio 11.0\VSSDK\VisualStudioIntegration\Common\Assemblies\v2.0\Microsoft.VisualStudio.Shell.Interop.dll 
```

VS2012 将其更改为：

```
C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\PublicAssemblies\envdte.dll
C:\Program Files (x86)\Microsoft Visual Studio 2010 SDK SP1\VisualStudioIntegration\Common\Assemblies\v2.0\Microsoft.VisualStudio.Shell.Interop.dll 
```

有没有办法避免这种情况？，我在 .proj 文件中添加了一个带有完整路径的 HintPath，但如果找不到完全相同的路径，恐怕它不会在服务器上编译。

# google-maps - 谷歌地图在隐藏的 div 中显示为灰色

> ID：13484651
> 
> 赞同：2
> 
> 时间：2012-11-21T00:43:33.330
> 
> 标签：google-maps, google-maps-api-3

我已经阅读了堆栈上有关此问题的许多线程，但没有什么能解决我的问题。我在页面加载时最初隐藏的选项卡上有谷歌地图，希望得到一些帮助。这是完整的代码：

```
<script type="text/javascript"> 
  function loadsinglemap(){
  var mymap = new MeOnTheMap({
  container: "map_sidebar2",
  html: "<?php echo str_replace('"',"",$post->post_title); ?>",
  address: "<?php echo str_replace('"','',get_post_meta($post->ID, "map_location", true)); ?>",
  zoomLevel: 15,

  });                        
  } 

 jQuery(document).ready(function() {   loadsinglemap();  })

 </script>

This is on the page where the map is displayed:

<script type="text/javascript">
$(document).ready(function(){
$('a.contact').click(function(){
google.maps.event.trigger(mymap, 'resize');
});
});
</script> 
```

我只是无法让它工作。如果有人看到有帮助的东西，请回复。谢谢

**编辑：**将元素选择器更改为一个类，并将我的链接更改为一个类而不是一个 ID，现在它至少可以选择它。我在萤火虫中收到“未定义 mymap”的错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-10-01T09:40:46.473

取消隐藏 div 后再次调用 initilize() 函数。我做到了，它奏效了。 [`JSFiddle`](https://jsfiddle.net/wvbdnb8o/187/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T00:47:56.153

我发现不是隐藏 div 而是将它的高度/宽度设置为 0px；并将其溢出设置为隐藏。

帮助我希望它可以帮助你:)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2014-01-22T16:39:56.857

在此处查看 Roosko 的答案[https://groups.google.com/forum/#!topic/google-maps-js-api-v3/aUrVnx-i7LI](https://groups.google.com/forum/#!topic/google-maps-js-api-v3/aUrVnx-i7LI)，它对我有用！

由于地图在模态框获得定义的大小之前加载，因此它将大小呈现为零。

```
<a href="#?w=500" rel="popup2" class="poplight" onClick="initialize()">
    <img src='images/location1.png' title='Location' alt='images/location2.png' />
</a> 
```

`initilize()`单击弹出窗口时，我调用了该函数。

# javascript - 又一个 document.referrer.pathname 东西

> ID：13484662
> 
> 赞同：0
> 
> 时间：2012-11-21T00:44:23.180
> 
> 标签：javascript, regex, referrer

我正在寻找“document.referrer.pathname”的等价物。我知道在 SO 上还有其他与此类似的问题，但它们都没有处理所有用例。例如：

[http://example.com/RESULT](http://example.com/RESULT)

[http://example.com/RESULT/](http://example.com/RESULT/)

[http://example.com/RESULT?query=string](http://example.com/RESULT?query=string)

所有示例都应返回：

```
RESULT 
```

或者

[https://example.com/EXTENDED/RESULT/](https://example.com/EXTENDED/RESULT/)

```
EXTENDED/RESULT 
```

有些人可能想要包含斜杠，但我不想要，因为我正在匹配推荐人列表。

我开始了：

```
document.referrer.match(/:\/\/.*\/(.*)/)[1] 
```

并且正在努力添加查询字符串解析。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T00:51:47.610

如果您将 URL 作为字符串，您可以创建空锚并将 URL 作为 href 提供给它们以访问路径名：

```
var url = 'http://example.com/RESULT?query=string', // or document.referrer
    a = document.createElement('a');
a.href = url;
var result = a.pathname.replace(/(^\/|\/$)/g,''); 
```

我在这里为您设置了一个测试示例：http: [//jsfiddle.net/eWydy/](http://jsfiddle.net/eWydy/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T01:46:09.873

试试这个正则表达式：

```
.match(/\/\/.*?\/(.*?)\/?(\?.*)?$/)[1] 
```

[**演示**](http://jsfiddle.net/Myfnr/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T00:58:11.027

如果您不想为其创建新元素或依赖`a.pathname`，我建议使用`indexOf`and `slice`。

```
function getPath(s) {
    var i = s.indexOf('://') + 3, j;
    i = s.indexOf('/',i) + 1;  // find first / (ie. after .com) and start at the next char
    if( i === 0 ) return '';
    j = s.indexOf('?',i); // find first ? after first / (as before doesn't matter anyway)
    if( j == -1 ) j = s.length; // if no ?, use until end of string
    while( s[j-1] === '/' ) j = j - 1; // get rid of ending /s
    return s.slice(i, j); // return what we've ended up at
}
getPath(document.referrer); 
```

* * *

如果你想要正则表达式，也许这个

```
document.referrer.match(/:\/\/[^\/]+[\/]+([^\?]*)[\/]*(?:\?.*)?$/)[1] 
```

它确实“找到第一个`://`，继续直到下一个`/`，然后获取不是`?`直到 a`?`或字符串的最后一个`/`或结尾的所有内容并捕获它”，这与我上面所做的功能基本相同。

# c - 为什么在某些 Unix 发行版中存在 isnumber() 函数，而在其他发行版中不存在？

> ID：13484663
> 
> 赞同：6
> 
> 时间：2012-11-21T00:44:33.117
> 
> 标签：c, linux, macos, unix, compiler-construction

我正在编写一个小型 C 程序，在其中调用该`isnumber()`函数。

```
#include <ctype.h>

char c
if(isnumber(c)) 
    { foo } 
```

这在我的 Mac (OS X 10.8) 上编译没有问题。但是，当我将它上传到 CentOS 6.x 服务器时，它不会编译。此外，[OS X`man`页面`isdigit()`](http://developer.apple.com/library/Mac/#documentation/Darwin/Reference/ManPages/man3/isdigit.3.html)描述`isnumber()`，但 CentOS`man`页面没有。就好像它根本不存在于 Linux 机器上一样。[OS X`man`页面`isdigit()`](http://developer.apple.com/library/Mac/#documentation/Darwin/Reference/ManPages/man3/isdigit.3.html)和[通用 Unix`man`页面](http://www.unix.com/man-page/all/3/isnumber/)都`isdigit()`被`isnumber()`列为 C 标准库的一部分`libc, -lc`。当我`-lc`在 Linux 上添加编译标志时，它仍然无法编译。

为什么这个函数包含在 Unix 的某些形式中而不包含在其他形式中？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-21T00:49:40.240

`isnumber()`是一个*BSDism*，如链接手册页的 HISTORY 部分所示：

> isnumber() 函数出现在 4.4BSD 中。

OS X 在那里展示了它的传统......

还有一个 STANDARDS 部分谈论`isdigit`但对`isnumber`.

无论如何，Linux、BSD 或 OS X 手册页不应该被认为是关于 C 语言的权威，甚至关于 POSIX 标准。对于 C，请阅读 C 标准规范（很容易找到），对于 POSIX，您可以阅读[OpenGroup 网站](http://pubs.opengroup.org/onlinepubs/9699919799/)。

# objective-c - 自定义 NSMenu 设计

> ID：13484666
> 
> 赞同：2
> 
> 时间：2012-11-21T00:44:56.420
> 
> 标签：objective-c, xcode, macos, user-interface, nsmenuitem

棘手的问题。我正在寻找创建自定义 NSMenuItem 设计的示例。我想实现类似[http://anvilformac.com/](http://anvilformac.com/)的东西。有没有什么例子可以让我朝着正确的方向前进？或者至少一个教程？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T01:16:54.473

Apple 有专门[的菜单编程指南一节，](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MenuList/Articles/ViewsInMenuItems.html)[相关的示例代码](https://developer.apple.com/library/mac/#samplecode/MenuItemView/Introduction/Intro.html#//apple_ref/doc/uid/DTS10004136)提供了自定义菜单视图的完整工作实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-27T13:06:55.950

将自定义视图拖到您的 xib 中。右键单击第一个菜单项并从视图属性拖动到自定义视图。

# mysql - 从命令行下载 MySQL 转储

> ID：13484667
> 
> 赞同：350
> 
> 时间：2012-11-21T00:45:15.197
> 
> 标签：mysql, command-line, command-line-arguments, linode

我要离开 Linode 是因为我没有必要的 Linux 系统管理员技能；在完成向更适合新手的服务的过渡之前，我需要下载 MySQL 数据库的内容。有没有办法可以从命令行执行此操作？

* * *

## 回答 #1

> 赞同：747
> 
> 时间：2012-11-21T00:52:11.150

您可以使用[mysqldump](http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html)命令行函数完成此操作。

例如：

如果它是一个完整的数据库，那么：

```
 $ mysqldump -u [uname] -p db_name > db_backup.sql 
```

如果都是数据库，那么：

```
 $ mysqldump -u [uname] -p --all-databases > all_db_backup.sql 
```

如果它是数据库中的特定表，则：

```
 $ mysqldump -u [uname] -p db_name table1 table2 > table_backup.sql 
```

您甚至可以使用 gzip 自动压缩输出（如果您的数据库非常大）：

```
 $ mysqldump -u [uname] -p db_name | gzip > db_backup.sql.gz 
```

如果您想**远程**执行此操作并且您可以访问相关服务器，那么以下操作将起作用（假设 MySQL 服务器位于端口 3306 上）：

```
 $ mysqldump -P 3306 -h [ip_address] -u [uname] -p db_name > db_backup.sql 
```

它应该将`.sql`文件放在您运行命令行的文件夹中。

**编辑：**更新以避免在 CLI 命令中包含密码，请使用`-p`不带密码的选项。它会提示您而不是记录它。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2016-10-01T09:28:55.770

在最新版本的 mysql 中，至少在我的版本中，您不能直接将 pass 放入命令中。

你必须运行：

`mysqldump -u [uname] -p db_name > db_backup.sql`

然后它会要求输入密码。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2016-09-21T18:32:03.403

如果从远程服务器下载，这里是一个简单的例子：

```
mysqldump -h my.address.amazonaws.com -u my_username -p db_name > /home/username/db_backup_name.sql 
```

-p 表示您将输入密码，它与 db_name 无关。输入命令后，系统会提示您输入密码。输入它并按回车键。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-01-26T07:55:21.310

在 Windows 上，您需要指定 mysqldump.exe 所在的 mysql bin。

```
cd C:\xampp\mysql\bin

mysqldump -u[username] -p[password] --all-databases > C:\localhost.sql 
```

将其保存到文本文件中，例如 backup.cmd

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-03-27T06:42:02.383

只需键入`mysqldump`或`mysqldump --help`在您的 cmd 中将显示`how to use`

这是我的***cmd 结果***

```
C:\Program Files\MySQL\MySQL Server 5.0\bin>mysqldump
Usage: mysqldump [OPTIONS] database [tables]
OR     mysqldump [OPTIONS] --databases [OPTIONS] DB1 [DB2 DB3...]
OR     mysqldump [OPTIONS] --all-databases [OPTIONS]
For more options, use mysqldump --help 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-07-21T04:31:26.823

不要进去`mysql`，只需打开*命令提示符*并直接输入：

```
mysqldump -u [uname] -p[pass] db_name > db_backup.sql 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-07-27T13:09:17.837

转到 MySQL 安装目录并从那里打开 cmd。然后执行以下命令以获取数据库的备份。

```
mysqldump -u root -p --add-drop-database --databases db> C:\db-dontdelete\db.sql 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-07-25T09:39:44.027

如果您正在运行默认端口以外的 MySQL：

```
mysqldump.exe -u username -p -P PORT_NO database > backup.sql 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-01-27T06:27:08.547

对于那些想在命令行中输入密码的人。可以，但建议在引号内传递它，这样特殊字符就不会引起任何问题。

```
mysqldump -h'my.address.amazonaws.com' -u'my_username' -p'password' db_name > /path/backupname.sql 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-05-16T14:17:16.673

如果您有名为 的数据库`archiedb`，请使用以下命令：

```
mysql -p <password for the database> --databases archiedb > /home/database_backup.sql 
```

假设这是 Linux，请选择备份文件的保存位置。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-08-21T16:48:12.223

对于 Windows 用户，您可以转到 mysql 文件夹运行命令

例如

```
cd c:\wamp64\bin\mysql\mysql5.7.26\bin
mysqldump -u root -p databasename > dbname_dump.sql 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-06-09T12:24:19.347

注意：此步骤仅在转储 MySQL 文件之后进行（上面的大多数答案都已解决）。

它假定您在远程服务器中有上述转储文件，现在您想将其下载到本地计算机。

要将转储`.sql`文件从远程服务器下载到本地计算机，请执行

```
scp -i YOUR_SSH_KEY your_username@IP:name_of_file.sql ./my_local_project_dir 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-03-13T19:59:11.253

对于某些版本的 MySQL 试试。

```
sudo mysqldump [database name] > db_backup.sql 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-03-14T10:08:54.010

**mysqldump** 是 MySQL 目录中的另一个程序（.exe 文件）

> 程序文件\MySQL\MySQL 服务器 8.0\bin

**第 1 步**：首先，您必须转到路径并从文件夹中打开 CMD。

**第2步**：然后输入`mysqldump`CMD

* * *

**它应该显示如下**

```
Usage: mysqldump [OPTIONS] database [tables]
OR     mysqldump [OPTIONS] --databases [OPTIONS] DB1 [DB2 DB3...]
OR     mysqldump [OPTIONS] --all-databases [OPTIONS]
For more options, use mysqldump --help 
```

**第 3 步**：然后输入此命令

```
mysqldump -u [user_name] -p [database_name] > D:\db_dump.sql 
```

*注意：* *您应该为输出文件提供绝对路径。* *这里我提供* `D:\`

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2020-08-24T13:50:12.500

```
@echo off
for /f "tokens=2 delims==" %%a in ('wmic OS Get localdatetime /value') do set "dt=%%a"
set "YY=%dt:~2,2%" & set "YYYY=%dt:~0,4%" & set "MM=%dt:~4,2%" & set "DD=%dt:~6,2%"
set "HH=%dt:~8,2%" & set "Min=%dt:~10,2%" & set "Sec=%dt:~12,2%"
set "datestamp=%YYYY%.%MM%.%DD%.%HH%.%Min%.%Sec%"
set drive=your backup folder
set databaseName=your databasename
set user="your database user"
set password="your database password"
subst Z: "C:\Program Files\7-Zip" 
subst M: "D:\AppServ\MySQL\bin"
set zipFile="%drive%\%databaseName%-%datestamp%.zip"
set sqlFile="%drive%\%databaseName%-%datestamp%.sql"
M:\mysqldump.exe --user=%user% --password=%password% --result-file="%sqlFile%" --databases %databaseName%
@echo Mysql Backup Created
Z:\7z.exe a -tzip "%zipFile%" "%sqlFile%"
@echo File Compress End
del %sqlFile%
@echo Delete mysql file
pause; 
```

# c# - 完成后在 Web 服务中分离线程

> ID：13484673
> 
> 赞同：2
> 
> 时间：2012-11-21T00:45:51.210
> 
> 标签：c#, multithreading, web-services, .net-2.0, asmx

如果在我道歉之前有人问过这个问题，这是 .NET 2.0 ASMX Web 服务，我再次道歉 =D

仅公开 Web 服务的 .NET 应用程序。每天大约 1000 万条消息在多个 IIS 服务器之间进行负载平衡。每个传入消息都是 XML，而传出消息是 XML。(XMLElement)（我们有强大的服务器运行在类固醇上）。

我有一个 SLA，所有消息都在 X 秒内处理。

一个函数，链接方法，在这个过程中现在需要 10-20 秒，每个事务都需要它，但是在 Web 服务返回结果之前发生并不重要。正因为如此，我建议把它放到另一个线程上，但现在意识到我的话和他们背后热切的开发人员可能还没有完全考虑到这一点。

下面的示例在左侧显示了当前流程。在右侧正在尝试的内容

实际上，我正在寻找的是让 Web 服务产生一个长时间运行（10-20 秒）的线程，即使在 Web 服务完成后也会执行该线程。

![我正在寻找的示例](../Images/9ea18eb158680ba8b496e87b86f14b03.png)

这实际上是正在发生的事情：

```
 Thread linkThread= new Thread(delegate()
        {
            Linkmembers(GetContext(), ID1, ID2, SomeOtherThing, XMLOrSomething);
        });
        linkThread.Start(); 
```

使用它，我们将开发盒上的时间从 19 秒减少到 2.1 秒，这是相当可观的。

我担心随着我们获得的流量，如果供应商/外部方决定限制我们，IIS 可能会决定在它们完成处理之前回收/杀死这些线程。我同意我们的解决方案可能不是“最好的”，但是我们没有时间构建队列系统或其他 Windows 服务来处理这个问题。

有一个更好的方法吗？应考虑的任何警告？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T03:04:42.170

除了你描述的问题，我想不出任何问题。话虽如此，有一些方法可以解决问题，而无需从头开始构建自己的解决方案。

将[MSMQ 与 WCF 一起使用：使用](http://msdn.microsoft.com/en-us/library/ms789032.aspx)[IIS 托管](http://msdn.microsoft.com/en-us/library/ms752246.aspx)的 MSMQ 端点创建 WCF 服务（只要启用了 WAS，就无需使用 Windows 服务），并从您的 ASMX 服务中调用该服务。您无需自己构建即可获得可靠队列的所有好处。

另外，如果您的 MSMQ 服务失败或抛出异常，它会自动重新处理。如果您使用 DTC 并访问数据库，您甚至可以让 MSMQ 事务流​​到数据库。

# java - 在 Eclipse 中导出 SWT 项目（通过 SWT Designer 设置项目）

> ID：13484680
> 
> 赞同：0
> 
> 时间：2012-11-21T00:46:37.107
> 
> 标签：java, eclipse, jar, swt

我在 Eclipse 中使用 SWT 为我的 GUI 制作了一个小型应用程序。我通过安装 SWT Designer 来设置项目，这与仅用于 SWT 的 Swing Designer 非常相似。我通过转到 File >> New >> Other >> Window Builder >> SWT Designer >> SWT/JFace Java Project 创建了该项目。这为我设置了整个项目，因此我可以开始使用 SWT。当我使用 Eclipse 运行它时，我的程序成功运行。

不过，我希望能够在没有 Eclipse 的情况下运行它。我尝试通过文件 >> 导出 >> Java >> JAR 文件将其导出为 .jar。我选择了我的项目，点击下一步>>下一步，然后我设置我的主类并点击完成。没有错误。

打开 .jar 给了我：

> 线程“主”java.lang.NoClassDefFoundError 中的异常：org/eclipse/swt/widgets/Layout

很明显，SWT 不在它应该在的位置，所以我打开了 .jar，只找到了我的文件、META-INF 等。没有任何 SWT。没有 jar，没有 org 文件夹，nada。

在我的 Eclipse 项目中，在 Project Explorer 下，它列出了设置 SWT 内容的“Referenced Libraries”。在查看它的属性时，它列出了一堆 org.eclipse... 的东西。我认为这就是 Eclipse 知道要运行什么的方式，但它似乎没有导出它。

**所以我的问题是：**我如何让项目与与它一起打包的 SWT 一起导出，以便能够单独由 .jar 运行？如果您能解释手动方式（即编辑 META-INF 和拖放所需的 SWT 文件）以及解释 Eclipse 导出方式（这样我就不必一直手动方式），那就太好了)，如果有办法在 Eclipse 中做到这一点。

**编辑：**如果你在下面看到我的回答，我解释了我是如何让这个工作的，但是，它会将价值约 16MB 的代码转储到我的 .jar 中，这对于最初小于 1MB 的项目来说相当大。如果您对如何使其仅添加使用过的文件有任何想法，仍然感谢您的回答。;)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T02:24:31.683

听起来你不是在使用 OSGI，我的建议是转到你的 eclipse 插件目录，将 swt jar 复制到你的插件中，然后通过清单编辑器、运行时选项卡并选择 jar 将其添加到类路径中。如果您正在运行 osgi 应用程序，请确保您的 .product 文件具有正确的依赖项，方法是转到 .product 编辑器依赖项选项卡并选择添加所需的插件。如果您在不同的上下文评论中运行它，我会回答。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T03:03:02.810

我成功完成这项工作的方法是将其导出为*可运行*的JAR。

我让它工作的步骤：

运行主类。（我专门使用了 CTRL+F11，默认在类上运行，让 Eclipse 猜测它应该如何运行。）

转到文件 >> 导出 >> 可*运行 JAR*。

选择我的启动配置。（当我点击 Juno 顶部栏上运行按钮旁边的箭头时，它就会列出。）

点击完成键并等待！

# list - Sage 上超过 2 个元素的欧几里得算法

> ID：13484681
> 
> 赞同：0
> 
> 时间：2012-11-21T00:46:41.987
> 
> 标签：list, greatest-common-divisor, sage

我正在尝试做一个获取数字列表的练习，并显示如下元素列表：如果 A=[a0,a1,a2] 那么有 U=[u0,u1,u2]，知道 a0 *u0 + a1*u1 + a2*u2 = d 并且 d 是 A 的 gcd。

对于 2 个元素是一件非常简单的事情，因为 Sage 具有从 a0 和 a1 中检索 u0 和 u1 的功能：

```
A=[15,21]
(d,u0,u1)=xgcd(a[0],a[1]) 
```

我只是不明白我怎么能用 n 个元素的列表来做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:59:08.757

注意 gcd(a, b, c) = gcd((gcd(a, b), c)。这意味着你可以重复使用内置函数来计算你想要的系数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T01:33:44.947

你帮了我很多，来到这个：

```
x1=[1256,5468,5552,1465]
n=-1
for i in x1:
    n=n+1
(d,w,x)=xgcd(x1[n-1],x1[n])
u1=[w,x]
n=n-2
while n>=0:
    div=d
    (d,u,v)=xgcd(x1[n],div)
    position=0
    for j in u1:
        a=j*v
        u1[position]=a
        position=position+1
    u1=[u]+u1
    n=n-1
u1 
```

它有效；）

# ruby-on-rails - Rails 支持 HTML 多选

> ID：13484684
> 
> 赞同：1
> 
> 时间：2012-11-21T00:47:17.340
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, html-select, form-helpers

我有 2 个模型：

```
class Game < ActiveRecord::Base
  attr_accessible :name
  has_and_belongs_to_many :categories
end

class Category < ActiveRecord::Base
  attr_accessible :name
  has_and_belongs_to_many :games
end 
```

我想要一个 HTML 多选`_form.html.erb`，生成如下内容：

```
<select id="game_category_id" name="game[category_id]" multiple="multiple">
  <option value="1">First Person Shooter</option>
  <option value="2">Role Playing Game</option>
</select> 
```

提交表单以创建新`game`或编辑 a`game`时，应相应保存所选类别。我通常使用 Rails 的字段`collection_select`方法。`select`我也可以将它用于多项选择吗？

```
<%= f.collection_select(:category_id, Category.order('name'), :id, :name, {include_blank: true}) %> 
```

一个问题是，当然，我在模型中没有`category_id`字段。`game`这是一个集合`categories`。我正在使用最新的稳定 Rails（目前为 3.2.9）。

# c++ - C++ Win32-响应按键

> ID：13484686
> 
> 赞同：0
> 
> 时间：2012-11-21T00:47:45.757
> 
> 标签：c++, win32-process

我正在尝试制作我模拟的win32应用程序，我按下`C`钢琴上的键，键盘No 60，并使用以下调用：`midiOutShortMsg (hMidiOut, DWORD (0x090 | 0 | (60 << 8) | (64 << 16)));`

并在释放 60 号键时执行以下调用：`midiOutShortMsg (hMidiOut, DWORD (0x080 | 0 | (60 << 8) | (0 << 16)));`

问题是当我按下按钮时，我只听到一次声音。当我运行程序时，只有一个案例有效。

我怎样才能做到只要我按，声音就会重复。以及如何才能使长旋律播放。

```
case WM_KEYDOWN:
{
    switch (wParam) {

    case VK_LEFT:
        midiOutOpen(&hMidiOut, -1, 0, 0, 0);
        // Set instrument to 0 = Acoustic Grand Piano
        midiOutShortMsg(hMidiOut, DWORD(0x0C0 | 0 | (0 << 8) | (0 << 16)));
        midiOutShortMsg (hMidiOut, DWORD(0x090 | 0 | (65<<8 ) | (64 << 16)));
        break;

    case 'S':
        midiOutShortMsg (hMidiOut, DWORD(0x090 | 0 | (62<<8 ) | (64 << 16)));   
        break;

    case 'D':
        midiOutShortMsg (hMidiOut, DWORD(0x090 | 0 | (64<<8 ) | (64 << 16)));
        break;

    case 'F':
        midiOutShortMsg (hMidiOut, DWORD(0x090 | 0 | (65<<8 ) | (64 << 16)));
        break;

    case 'G':
        midiOutShortMsg (hMidiOut, DWORD(0x090 | 0 | (67<<8 ) | (64 << 16)));
        break;

    case 'H':
        midiOutShortMsg (hMidiOut, DWORD(0x090 | 0 | (69<<8 ) | (64 << 16)));
        break;

    case 'J':
        midiOutShortMsg (hMidiOut, DWORD(0x090 | 0 | (71<<8 ) | (64 << 16)));
        break;

    case 'K':
        midiOutShortMsg (hMidiOut, DWORD(0x090 | 0 | (72<<8 ) | (64 << 16)));
        break; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T01:09:04.467

我想您可以存储键状态（也许使用 bool 数组）并在消息处理循环中进行播放。

# sql-server-2008 - 在 SQL Server 中选择 count datediff

> ID：13484691
> 
> 赞同：0
> 
> 时间：2012-11-21T00:48:04.980
> 
> 标签：sql-server-2008, select, count, datediff

我在从我的数据库中获取所需结果时遇到问题。和列`join_service_date`有`dropped_service_date`日期。`r`如果拒绝，则拒绝在列中有一个。

我希望能够计算代理商的销售、拒绝、销售下降以及这些销售中有多少在 0-30 天、31-60 天或 61-90 天内放弃了我们的服务。我通过几个小查询得到了我需要的结果，但我想学习或知道如何在 1 个或尽可能少的查询中收集信息。

另外，我将如何为特定月份（如 3 月或 4 月）指定此内容。

```
select agentid, 
       count(join_service_date), 
       count(dropped_service_date),
       count(rejects), 
       datediff(day, join_service_date, dropped_service_date)
from dbtable
group by agentid 
```

# firefox - CSS3 动画仅适用于 webkit？

> ID：13484693
> 
> 赞同：3
> 
> 时间：2012-11-21T00:48:18.393
> 
> 标签：firefox, google-chrome, css, animation, webkit

我正在我的网站上制作带有拼图的 CSS3 动画。我正在使用的代码如下。出于某种原因，动画仅适用于 Safari 和 Chrome。如何让动画与 Firefox 和 Opera 一起使用？谢谢您的反馈！

```
img#animation
{
length:150px;
width:150px;
position:relative;
animation:puzzle 4s
-moz-animation:puzzle 4s;
-webkit-animation:puzzle 4s;
-o-animation:puzzle 4s;
}
@keyframes puzzle
{
from {left:-400px; top:0px;}
to {left:41px; top:0px;}
}
@-moz-keyframes puzzle
{
from {left:-400px; top:0px;}
to {left:41px; top:0px;}
}
@-webkit-keyframes puzzle
{
from {left:-400px; top:0px;}
to {left:40.5px; top:0px;}
}
@-o-keyframes puzzle
{
from {left:-400px; top:0px;}
to {left:41px; top:0px;}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T00:53:56.607

您在这一行中缺少一个分号

```
animation:puzzle 4s;
                ---^ 
```

添加它，它会工作 -[**演示**](http://jsfiddle.net/2rwLq/2/)

# c# - 为什么这个 DataTrigger 不起作用？

> ID：13484697
> 
> 赞同：2
> 
> 时间：2012-11-21T00:48:28.227
> 
> 标签：c#, .net, wpf

是的，数据触发器在样式中。现在这个问题已经过去了，我很想知道为什么下面的代码不起作用。我应该看到数据网格的蓝色背景，但样式被忽略。我究竟做错了什么？注意我已将 Window 元素命名为“root”。

```
<Window x:Class="DataGridTriggerTest.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525" x:Name="root">
<Grid>
    <DataGrid ItemsSource="{Binding SomeData}" >
        <DataGrid.Style>
            <Style TargetType="DataGrid">
                <Style.Triggers>
                    <DataTrigger Binding="{Binding ElementName=root, Path=SomeCondition}" Value="true">
                        <Setter Property="Background" Value="Red"></Setter>
                        <Setter Property="RowBackground" Value="Red"></Setter>
                    </DataTrigger>
                    <DataTrigger Binding="{Binding ElementName=root, Path=SomeCondtion}" Value="false">
                        <Setter Property="Background" Value="Blue"></Setter>
                        <Setter Property="RowBackground" Value="Blue"></Setter>
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </DataGrid.Style>
        <DataGrid.Columns>
            <DataGridTextColumn Binding="{Binding}" Header="Data"></DataGridTextColumn>
        </DataGrid.Columns>
    </DataGrid>
</Grid>
</Window> 
```

这是代码：

```
public partial class MainWindow : Window
{
    public bool SomeCondition { get; set; }
    public List<string> SomeData { get; set; }

    public MainWindow()
    {
        InitializeComponent();
        DataContext = this;
        SomeData = new List<string> { "hello", "world" };
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T01:09:21.523

XAML 布尔值不区分大小写，但是，我相信在 Value 属性中使用它时需要使用“False”和“True”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T04:37:24.490

你有几个问题。第一个是您需要实现 INotifyPropertyChanged 接口并在 SomeCondition 设置器属性上引发 PropertyChanged 事件，或者使 SomeCondition 成为 DependencyProperty。如果不这样做，您的 UI 将永远不会知道属性值已更改。

第二个是我相信如果该值与默认值相同，则不会发生数据触发器。因此，永远不会发生错误触发，因为布尔默认值为 false。我认为您应该设置默认样式值以匹配属性的默认值。在这种情况下为 false ......就像这样：

```
 <Style TargetType="DataGrid">
            <Setter Property="Background" Value="Blue" />
            <Setter Property="RowBackground" Value="Blue" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding ElementName=root, Path=SomeCondition}" Value="true">
                    <Setter Property="Background" Value="Red"></Setter>
                    <Setter Property="RowBackground" Value="Red"></Setter>
                </DataTrigger>
            </Style.Triggers>
        </Style> 
```

属性为 false 时默认为蓝色，属性为 true 时更改。

最后，对于 SomeData，您应该使用 ObservableCollection 而不是 List。

# iphone - NSDictionary 上是否有一个开源类别可以快速将其从/到 NSData 转换？

> ID：13484700
> 
> 赞同：0
> 
> 时间：2012-11-21T00:48:46.883
> 
> 标签：iphone, ios, ipad, nsdictionary, nsdata

我找不到它，所以我要写一个，但在我重新发明轮子之前……是否有一个类别可以添加此功能？

当然，NSDictionary 中的所有内容都应该符合 NSCoding，但这很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T01:08:34.887

如果一切都符合 NSCoding，那么它听起来像是`NSKeyedArchiver`/的主要候选者`NSKeyedUnarchiver`。如果你只支持 iOS 5+，你也可以考虑`NSJSONSerialization`是否需要它是人类可读的。在这种情况下，您只能使用 JSON 支持的对象（数组、字典、字符串、数字、null）。

# expressionengine - ExpressionEngine Zoo Visitor 字段与 Channel Images 为每个输出四个图像

> ID：13484703
> 
> 赞同：1
> 
> 时间：2012-11-21T00:49:06.400
> 
> 标签：expressionengine

我有一个名为“member_gallery”的动物园访客字段，它是一个频道图像字段。每当我显示图像时，它都会为每个图像创建 4 个图像。但是我不想为每个输出 4 个图像。我想为每个输出一张图像。这是我写的代码：

```
{visitor:member_gallery}
   {exp:channel_images:images entry_id="{entry_id}"}                        
       <img src="{image:url:large}" alt="{image:title}" />
   {/exp:channel_images:images}
{/visitor:member_gallery} 
```

这是它吐出的标记

```
<img src="http://staging.eventplanner.verityinteractive.com/images/19/images_(1)__large.jpeg" alt="Images (1)" />                                           
<img src="http://staging.eventplanner.verityinteractive.com/images/19/images_(1)__large.jpeg" alt="Images (1)" />                                           
<img src="http://staging.eventplanner.verityinteractive.com/images/19/images_(1)__large.jpeg" alt="Images (1)" />                                           
<img src="http://staging.eventplanner.verityinteractive.com/images/19/images_(1)__large.jpeg" alt="Images (1)" />

<img src="http://staging.eventplanner.verityinteractive.com/images/19/images_(2)__large.jpeg" alt="Images (2)" />                                           
<img src="http://staging.eventplanner.verityinteractive.com/images/19/images_(2)__large.jpeg" alt="Images (2)" />                                           
<img src="http://staging.eventplanner.verityinteractive.com/images/19/images_(2)__large.jpeg" alt="Images (2)" />                       
<img src="http://staging.eventplanner.verityinteractive.com/images/19/images_(2)__large.jpeg" alt="Images (2)" />

<img src="http://staging.eventplanner.verityinteractive.com/images/19/images_(3)__large.jpeg" alt="Images (3)" />                                           
<img src="http://staging.eventplanner.verityinteractive.com/images/19/images_(3)__large.jpeg" alt="Images (3)" />                                           
<img src="http://staging.eventplanner.verityinteractive.com/images/19/images_(3)__large.jpeg" alt="Images (3)" />                                                   
<img src="http://staging.eventplanner.verityinteractive.com/images/19/images_(3)__large.jpeg" alt="Images (3)" /> 
```

需要明确的是，我不想为每张图片显示 4 张图片。如果你想不通。非常清楚，这是我的问题；我该如何写这个，所以我每上传一张图片，而不是 4 张？谢谢你。对于任何混淆，我深表歉意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:27:11.277

您不需要在 Zoo Visitor 中使用频道条目标签...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T08:49:14.907

看起来好像您在循环中有一个循环，因此是重复的。您是否尝试过删除频道条目标签？

# ruby-on-rails - FactoryGirl 使用嵌套关联构建策略

> ID：13484704
> 
> 赞同：6
> 
> 时间：2012-11-21T00:49:09.177
> 
> 标签：ruby-on-rails, factory-bot

当我有一个模型的工厂时，是否可以保留构建策略，该模型与第二个模型关联，而第二个模型本身与第三个模型关联？

在下面的示例中，帖子与用户相关联，用户与城市相关联。即使当`:strategy => :build`用于所有关联，`post.user`并`post.user.city`最终保存到数据库中。为了快速测试套件的利益，我可以防止这些数据库写入发生吗？

```
Factory.define do 
  factory :user do
    name "A User"
    association :city, :strategy => :build
  end

  factory :city do
    name "A City"
  end

  factory :post do
    title "A Post"
    body  "Some text here"
    association :user, :strategy => :build
  end
end

post = FactoryGirl.build(:post)

post.new_record?           # True
post.user.new_record?      # False
post.user.city.new_record? # False 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T01:44:31.490

您是否尝试过替代块语法？

```
Factory.define do 
  factory :user do
    name "A User"
    city { |city| city.association :city, :strategy => :build }
  end

  factory :city do
    name "A City"
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-01-22T14:23:23.953

看起来 FactoryBot（以前`FactoryGirl`）`use_parent_strategy`作为配置选项添加到 v4.8.0 中。默认情况下它是关闭的，要打开它，请将以下内容添加到您的`spec/rails_helper`：

```
FactoryGirl.use_parent_strategy = true 
```

`factory_bot`repo上的相关拉取请求： [https ://github.com/thoughtbot/factory_bot/pull/961](https://github.com/thoughtbot/factory_bot/pull/961)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-26T16:31:01.060

正如@messanjah 所说，但是对于旧版本（< v4.8.0），您可以执行以下操作：

```
association :user, :strategy => @build_strategy.class 
```

# javascript - 通过 JavaScript 更新文本字段强制光标到末尾

> ID：13484706
> 
> 赞同：1
> 
> 时间：2012-11-21T00:49:17.710
> 
> 标签：javascript, jquery

我正在使用 JavaScript ( `jQuery`) 函数在文本字段中强制大写。问题是，如果用户键入，然后尝试使用箭头键，或者单击字段的开头并再次键入，它会强制光标回到文本字段的末尾。

请参阅以下 jsFiddle：http: [//jsfiddle.net/Msh7P/1/](http://jsfiddle.net/Msh7P/1/)

键入任何内容，然后尝试使用左箭头键，或单击文本字段的开头并键入。

我怎样才能解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:54:38.017

你可以只用 CSS 做到这一点：

```
#username { text-transform: uppercase; } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T01:04:42.490

建议的CSS，或者您可以这样做：

```
$(document).ready(function() {
    $("#username").bind("input paste", function() {
        $(this).val($(this).val().toUpperCase());
    })
        .bind("keydown", function(e) {
            e.shiftKey = true;
        });
});​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T01:01:19.613

发生这种情况的原因是因为您要从 DOM 中删除光标所在的内容，然后用新内容替换它们。您将需要跟踪光标引用，然后在新内容中手动设置其位置。

# javascript - Webbrowser Control - 处理使用 javascript 的弹出窗口

> ID：13484708
> 
> 赞同：1
> 
> 时间：2012-11-21T00:49:35.347
> 
> 标签：javascript, vb.net, winforms, .net-3.0

经过大量研究，我一直试图找到一个代码，它不仅可以捕获网络浏览器中的弹出链接以供导航，而且还可以处理打开新窗口或弹出窗口的 javascript 代码。我尝试使用带有以下代码的 webbrowser1_newwindow 事件（效果很好）

```
 ' prevent opening a new window
    e.Cancel = True
    WBAccountVirgin.Navigate(e.Url.ToString) 
```

但它不适用于使用 javascript 代码：javascript:newPopup

我设法将javascript代码作为字符串删除，然后导航到该代码，并且也可以工作，但并非每次都可以。所以这里的问题是：我可以使用哪些代码来处理各种新窗口事件或弹出窗口，而我不需要事先提供该弹出窗口的 url？这也适用于 javascript 弹出代码。我已经看到大多数地方人们提供使用 NewWindow2 和 NewWindow3 事件的解决方案，但这甚至不是我正在使用的预加载 Webbrowser 控件的一部分。我不想使用必须导入的 Microsoft Webbrowser。我想使用已经加载的 WebBrowser 控件。

# ios - 带有phonegap的iOS相机胶卷视频？

> ID：13484711
> 
> 赞同：1
> 
> 时间：2012-11-21T00:49:48.360
> 
> 标签：ios, api, cordova, video, camera

现在 iOS 6 上的 Mobile Safari 支持使用 HTML5 输入元素对照片和视频进行捕获*和*媒体库选择，是否可以使用 PhoneGap 的 camera.getPicture 方法选择视频？

`<input type="file" accept="image/*, video/*" capture="camera" />`

如果没有，一个允许任一媒体类型的新 camera.getMedia 方法会很棒。

iOS6 Mobile Safari 上的照片和视频的 HTML5 文件输入 iOS6 Mobile Safari
![html5文件输入](../Images/617847d79cb3ad67f69059fbf950c281.png)

上的 HTML5 文件输入多媒体操作
![用于多媒体的 htm5 文件输入操作](../Images/54e03c8a61447598305b8e8cdaa8c770.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T02:53:29.837

您可以使用[navigator.camera.getPicture](https://cordova.apache.org/docs/en/latest/reference/cordova-plugin-camera/#cameragetpicturesuccesscallback-errorcallback-options)并在[options 参数](https://cordova.apache.org/docs/en/latest/reference/cordova-plugin-camera/#cameramediatype--enum)中将 MediaType 设置为 VIDEO 。

# google-apps-script - 在站点页面中使用 HTML 服务实现 UI 服务

> ID：13484713
> 
> 赞同：0
> 
> 时间：2012-11-21T00:50:10.930
> 
> 标签：google-apps-script

我正试图围绕一些概念展开思考，并尝试在此过程中扩展帮助台练习。我想要完成的是以下内容：

在站点内，创建一个“可重用”页面并在导航中创建多个链接，例如：

*   [https://sites.google.com/a/mydomain.org/helpdesk/tickets?status=new](https://sites.google.com/a/mydomain.org/helpdesk/tickets?status=new)
*   [https://sites.google.com/a/mydomain.org/helpdesk/tickets?status=open](https://sites.google.com/a/mydomain.org/helpdesk/tickets?status=open)

此页面包含一个 HTML 服务，该服务读取查询字符串参数并继续查询电子表格以查找具有指定状态并分配给当前用户的所有工单，然后以表格格式显示它们。

然后在桌子上，每一行都会有一个按钮，上面写着“添加解决方案或评论”，这将打开一个 UI 服务，允许用户输入一些文本并在必要时更改状态。

所以我的问题是：这听起来可行吗？我可以从 HTML 模板服务调用 UI 服务吗？HTML 服务可以读取查询字符串参数吗？这有什么例子吗？

感谢您的反馈意见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T10:53:38.320

您**不能**将 UI 服务与 HTML 服务混合使用。一旦你使用了一个，你必须坚持下去。

但是你所描述的可以很容易地使用任何一个来完成。即显示一个包含一些信息的表格和每行一个按钮，这将显示一个文本框。所以，是的，这是完全可行的。

读取 url 参数可以在“服务器端”轻松完成，也就是说，如果您使用 Html 或 Ui 服务，它是独立的。

读取参数的示例？这里是：

```
function doGet(e) {
  var status = e.parameter.status;
  if( status == 'new' ) {
    //do your thing

  } else if( status == 'open' ) {
    //just examples

  } else
    ;//bad status

  return appOrHtml;
} 
```

# hadoop - Pig Latin 中的汇总信息和预测

> ID：13484718
> 
> 赞同：0
> 
> 时间：2012-11-21T00:51:04.117
> 
> 标签：hadoop, apache-pig

我正在尝试通过对某些字段进行分组和投影来将最大聚合函数应用于表。我可以在聚合投影中引用原始表中的其他非分组字段吗？

例如，我有一个带有模式（user_id：long，order_id：long，product_id：long，gender：chararray，size：int）的表，其中 user_id、order_id 和 product_id 创建一个复合键，但可以有多个用户 id 和订单 ID。为了获得我使用的每个订单的最大尺寸

```
result_table = foreach (group blah by (user_id, order_id)) generate
   FLATTEN(group) as (user_id, order_id),
   MAX(blah.size) as max_size; 
```

有什么方法可以将 product_id 添加到 result_table 的创建中，这样我就有一个包含 user_id、order_id、product_id 和 max_size 的表（max_size 将在不同的 product_ids 上重复）？

如果我可以引用特定于每个分组的 user_id 和 order_id 的 product_id，我可以通过不加入原始表来访问该字段来节省自己的 mapreduce 工作。多谢你们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T10:29:11.600

Pig 非常适合这样的事情，它有包，这使它能够做在 SQL 中需要额外连接的事情。

如果您执行以下操作：

```
grp = group blah by (user_id, order_id);
describe grp; 
```

你会看到有一个包的模式与“blah”的模式相同（类似于 group:(user_id:long, order_id: long), blah: {(user_id: long, order_id: long, product_id: long ，性别：chararray，大小：int)})。这是一个非常强大的东西，因为它允许我们创建一个输出，其中包含所有原始行以及每行中的组摘要，而无需使用内部连接：

```
grp = group blah by (user_id, order_id);
result_table = foreach grp generate 
   FLATTEN(blah.(user_id, order_id, product_id)), -- flatten the bag created by original group
   MAX(blah.size) as max_size; 
```

如果相同的 product_id 在 user_id、order_id 组中出现多次，则会出现重复，为避免这种情况，我们可以使用嵌套在 FOREACH 中的 DISTINCT：

```
grp = group blah by (user_id, order_id);
result_table = foreach grp {
    dist = distinct blah.(user_id, order_id, product_id); -- remove duplicates
    generate flatten(dist), MAX(blah.size) as max_size;
} 
```

它将在单个 MapReduce 作业中完成。

# php - 检查是否使用 POST 检查单选按钮

> ID：13484719
> 
> 赞同：2
> 
> 时间：2012-11-21T00:51:21.090
> 
> 标签：php, html, forms, radio-button

我正在尝试根据他们检查的单选按钮将用户重定向到另一个网页。

以下是相关代码：

```
 <form action="sample.php" method="post">
          <input name="survey" type="radio" value="Yes" /> Yes
          </br>
          <input name="survey" type="radio" value="No"  /> No
  </form>

  <? 
    if ($_POST['survey'] == "Yes")
    {
        header('Location: http://localhost/survey.php');
    }
    else if ($_POST['survey'] == "No")
    {
        header('Location: http://localhost/survey.php');
    }

  ?> 
```

出于某种原因，我的 if 语句中出现错误。那不承认“调查”是一个有效的索引。我如何未能将我的表单链接到 php 代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:58:02.300

您的警告是由于当您使用`GET`（正常请求）加载页面时`$_POST['survey']`未设置。

`isset($_POST['survey'] ) &&`您可以通过在每次使用它之前添加一个来更改您的条件，或者您可以将整个代码放在一个块中，以检查是否发布了如下帖子：

```
if ($_SERVER['REQUEST_METHOD'] === 'POST')
{
    if ($_POST['survey'] == "Yes")
    {
        header('Location: http://localhost/survey.php');
    }
    else if ($_POST['survey'] == "No")
    {
        header('Location: http://localhost/survey.php');
    }
}
else
{
  // output html
} 
```

`header`无论哪种方式，您都必须将其放在您的 html 前面，因为如果标头已经发送（内容已经输出到浏览器），您将无法使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T00:58:14.380

想想表单是如何工作的：

第一次访问页面时，**未**提交表单。然而，你`if/else`的表现就好像它是一样的。这就是导致错误的原因 -`$_POST['survey']`第一次不存在。

正确编写脚本 -在呈现 HTML 之前进行*所有潜在的表单处理：*

```
<?php
if (isset($_POST['submit'])) {
    // handle the form
}
?>

<!doctype html>
<html>
    <head>
        <title>Blah</title>
    </head>

    <body>
        <!-- code -->
    </body>
</html> 
```

这将允许您检查您是否已将表单提交给自己，并可能使用 a`header()`来重定向用户，而不会遇到那些讨厌的“标头已发送”错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T00:58:18.507

尝试一个简单的 print_r() 语句来查看 $_POST 是否有任何内容。把它放在页面顶部：

```
print_r($_POST); 
```

此外，请确保您正在通过表单加载结果页面。如果您只是键入页面的 URL，它将不会发送任何 POST 数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T00:58:35.607

第一次加载文件 sample.php 时没有 POST 数据，因此没有索引“调查”。

您需要将其嵌套在另一个 if 语句中或对其进行如下修改：

```
 <form action="sample.php" method="post">
          <input name="survey" type="radio" value="Yes" /> Yes
          </br>
          <input name="survey" type="radio" value="No"  /> No
  </form>

  <? 
    if (isset($_POST) && $_POST['survey'] == "Yes")
    {
        header('Location: http://localhost/survey.php');
    }
    else if (isset($_POST) && $_POST['survey'] == "No")
    {
        header('Location: http://localhost/survey.php');
    }

  ?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-02-13T07:48:04.887

我正在使用不同的 php 文件进行检查。

```
<html>
<body>
<form action="another.php" method="POST">
  <label>You are: </label> Male <input type="radio" name="male">  Female     <input type="radio" name="female"><br/><br/>
    <input type="submit" name="submit" value="GO">
</body>
</html> 
```

*****另一个.php******

```
<?php
if (isset($_POST['submit'])) 
{
    if(empty($_POST['male']) && empty($_POST['female'])) 
    {echo "select gender";}
    elseif (empty($_POST['female'])) //means Male is checked
     {
        $gend="Male";
          echo $gend;
    }
    elseif(empty($_POST['male'])) //Means Female is checked
    { 
       $gend="Female";
          echo $gend; 
    }
    elseif(empty($_POST['male']) || empty($_POST['female'])== false) //Not required if you can disable one when another is checked
        {echo"please select only one";}
}
?> 
```

# java - JApplet 不显示绘制或绘制方法

> ID：13484720
> 
> 赞同：0
> 
> 时间：2012-11-21T00:51:22.383
> 
> 标签：java, user-interface, animation, paint, japplet

我有一个动画类，它只绘制两个圆和一条线（没有主方法），在另一个类中我有一个主方法，它作为一个对象传递给动画类，应该显示我绘制的两个圆，但它没有t 显示，它只显示窗口，没有我做过的圆圈或线条，如果我要将 main 方法放在我的动画类中，它将完美地工作，这是一个用户错误，但我不确定是什么或者为什么。

单独类中的动画方法。

```
import javax.swing.*;
import java.awt.geom.*;
import java.awt.*;
import java.awt.Graphics.*;
import javax.swing.JApplet;

public class Animation extends JApplet{

    public void init(){

}
public static void createAndShowGUI(JApplet j)
{
    JFrame frame = new JFrame();
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    frame.pack();
    frame.setVisible(true);
    frame.setSize(500,500);

    frame.getContentPane().add("Center", j);
}

public void paint(Graphics g){
    Graphics2D g2 = (Graphics2D) g;
    int x=50;
    int y=10;
    g2.setPaint(Color.black);

    g2.draw(new Line2D.Double(x,y,50,400));

    drawT(g2);
    drawH(g2);  
        //create a method that translates
    }

public void drawH(Graphics2D g2)
{
    int y=25;
    g2.setColor(Color.blue);
    drawCircle(y,g2);
}

public void drawT(Graphics2D g2){
    int y=100;
    g2.setColor(Color.green);
    drawCircle(y,g2);
}/*
public void raceLoop(){
    long startingTime = System.currentTimeMillis();
    long cumTime=startingTime;
    while(mve.hposition<70){
        long timePassed = System.currentTimeMillis()-cumTime;   
        cumTime += timePassed;
        //mve.update(timePassed);   
    }
}*/

public void drawCircle(int y, Graphics2D g2)
{
g2.fillOval(50,y,50,50);
}
} 
```

主要方法

```
import javax.swing.*;
import java.awt.geom.*;
import java.awt.*;
import java.awt.Graphics.*;
import javax.swing.JApplet;

public class Race {

public static void main(String[] args) {
    JApplet applet = new JApplet();
    Animation animie = new Animation();
    animie.createAndShowGUI(applet);

}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T00:57:09.030

1.  如果您只想`JApplet`使用`JFrame`. 你更擅长（在任何情况下），从`JPanel`（因为这可以添加到 a `JApplet`or `JFrame`）
2.  您没有向 中添加任何内容`JFrame`，因此，实际上，您的程序正在按照您的指示进行操作。
3.  您应该很少需要覆盖`paint`顶级容器的方法（如`JApplet`or `JFrame`），而是使用`JPanel`并覆盖它的`paintComponent`方法。
4.  您应该始终调用`super.paintXxx`, 绘制方法链来绘制应用程序的各个方面，如果您打破这条链，它将以眼泪告终。

您可能想通读

*   [使用 JFC/Swing 创建 GUI](http://docs.oracle.com/javase/tutorial/uiswing/)
*   [执行自定义绘画](http://docs.oracle.com/javase/tutorial/uiswing/painting/)
*   [在 AWT 和 Swing 中绘画](http://www.oracle.com/technetwork/java/painting-140037.html)

了解更多背景信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T00:59:04.070

看起来您传递了对 createAndShowGui(..) 方法的错误引用。

在你的 Race 课上试试这个：

```
import javax.swing.*;
import java.awt.geom.*;
import java.awt.*;
import java.awt.Graphics.*;
import javax.swing.JApplet;

public class Race {

    public static void main(String[] args) {
        Animation animie = new Animation();
        animie.createAndShowGUI(animie);
    }
} 
```

# asp.net-mvc - 在 ASP.NET MVC 中的同一控制器上的不同操作中自动保留“id”参数

> ID：13484723
> 
> 赞同：-1
> 
> 时间：2012-11-21T00:51:41.307
> 
> 标签：asp.net-mvc, asp.net-mvc-4, asp.net-routing

我的目标是让我的 CompanyController 的所有方法共享相同的“id”参数，而不必通过 RouteValueDictionary 显式传递它，因为这很混乱且容易出错。

因此，例如，如果我在页面[http://FooBar.com/Company/Index/4782](http://FooBar.com/Company/Index/4782)上并且我想生成指向同一控制器的“配置文件”方法的链接，我会写 @Html.ActionLink("Go to profile”，“Profile”），它会产生[http://FooBar.com/Company/Profile/4782](http://FooBar.com/Company/Profile/4782)并且每次我需要这样的链接时我都不必指定新的 {id=id} 。

有推荐的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T00:54:07.603

更改默认路由中的参数顺序，如果你能接受的话，会产生预期的结果。

因此，如果您拥有的唯一路线是这样（请注意没有默认值）：

```
 routes.MapRoute(
            name: "NoDefault",
            url: "{controller}/{action}/{id}/"
        ); 
```

然后从页面[http://foobar.com/Company/Index/4782](http://foobar.com/Company/Index/4782)你打电话

```
@Html.ActionLink("Manage Products", "ManageProducts", "Company", null, null) 
```

你得到这个错误的链接（似乎是当前页面）：[http](http://foobar.com/Company/Index/4782/) ://foobar.com/Company/Index/4782/所以这不起作用。但是，如果您像这样颠倒路由中参数的顺序：

```
 routes.MapRoute(
            name: "NoDefault",
            url: "{controller}/{id}/{action}"
        ); 
```

并从同一页面[http://foobar.com/Company/4782/Index/](http://foobar.com/Company/4782/Index/)开始，然后相同的 ActionLink() 调用就可以正常工作并 **生成正确的链接**：[http ://foobar.com/Company/4782/ManageProducts](http://foobar.com/Company/4782/ManageProducts)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:28:13.393

里面的 Actionlink 实现`System.Web.Mvc.Html.LinkExtensions (System.Web.Mvc, Version=4.0.0.0)`如下...

```
public static MvcHtmlString ActionLink(this HtmlHelper htmlHelper, string linkText, string actionName, string controllerName, RouteValueDictionary routeValues, IDictionary<string, object> htmlAttributes)
{
  if (string.IsNullOrEmpty(linkText))
    throw new ArgumentException(MvcResources.Common_NullOrEmpty, "linkText");
  else
    return MvcHtmlString.Create(HtmlHelper.GenerateLink(htmlHelper.ViewContext.RequestContext, htmlHelper.RouteCollection, linkText, (string) null, actionName, controllerName, routeValues, htmlAttributes));
} 
```

有许多具有不同参数组合的实用程序重载。

所以你应该能够添加一个扩展方法来轻松生成你的链接（未经测试）......

```
public static MvcHtmlString InternalActionLink(this HtmlHelper htmlHelper, string linkText, string actionName, string controllerName, RouteValueDictionary routeValues, IDictionary<string, object> htmlAttributes)
{
  if (string.IsNullOrEmpty(linkText))
    throw new ArgumentException(MvcResources.Common_NullOrEmpty, "linkText");
  else
    RouteValueDictionary.Values.Add("id", htmlHelper.ViewContext.RequestContext.RouteData)
    return MvcHtmlString.Create(HtmlHelper.GenerateLink(htmlHelper.ViewContext.RequestContext, htmlHelper.RouteCollection, linkText, (string) null, actionName, controllerName, routeValues, htmlAttributes));
}

public static MvcHtmlString InternalActionLink(this HtmlHelper htmlHelper, string linkText, string actionName)
{
  return this.InternalActionLink(htmlHelper, linkText, actionName, (string) null, new RouteValueDictionary(), (IDictionary<string, object>) new RouteValueDictionary());
} 
```

显然，您需要添加一些简单的包装器重载来提供您想要的确切功能。

然后使用`html.InternalActionLink("Title", "Action")`它，它会在生成 Url 时自动将正确的 Id 注入到路由字典中。

顺便说一句，框架提供了以下`ActionLink()`重载——你实现的越多，你就越灵活……

```
public static MvcHtmlString ActionLink(this HtmlHelper htmlHelper, string linkText, string actionName, string controllerName, object routeValues, object htmlAttributes)
public static MvcHtmlString ActionLink(this HtmlHelper htmlHelper, string linkText, string actionName, string controllerName, RouteValueDictionary routeValues, IDictionary<string, object> htmlAttributes)
public static MvcHtmlString ActionLink(this HtmlHelper htmlHelper, string linkText, string actionName, string controllerName, object routeValues, object htmlAttributes)
public static MvcHtmlString ActionLink(this HtmlHelper htmlHelper, string linkText, string actionName, string controllerName)
public static MvcHtmlString ActionLink(this HtmlHelper htmlHelper, string linkText, string actionName, RouteValueDictionary routeValues, IDictionary<string, object> htmlAttributes)
public static MvcHtmlString ActionLink(this HtmlHelper htmlHelper, string linkText, string actionName, RouteValueDictionary routeValues)
public static MvcHtmlString ActionLink(this HtmlHelper htmlHelper, string linkText, string actionName, object routeValues, object htmlAttributes)
public static MvcHtmlString ActionLink(this HtmlHelper htmlHelper, string linkText, string actionName, object routeValues)
public static MvcHtmlString ActionLink(this HtmlHelper htmlHelper, string linkText, string actionName) 
```

# asp.net-mvc - 当我 foreach ViewBag 对象时，对象引用未设置为对象的实例

> ID：13484725
> 
> 赞同：2
> 
> 时间：2012-11-21T00:52:02.167
> 
> 标签：asp.net-mvc, asp.net-mvc-4, exception

我试图理解为什么当我尝试从包含我的应用程序角色的字符串数组中获取元素时会出现异常。

> 错误：对象引用未设置为对象的实例。(ViewBag.roles)

这是我获得角色的方式：

```
 public ActionResult AdminRolesAndAccessRules()
   {
        String[] rolesArray;
        rolesArray = Roles.GetAllRoles();

        ViewBag.roles = rolesArray;

        return PartialView();
    } 
```

以下是我使用这些信息的方式：

```
<div class="scroller">
    <table>
        @foreach (MembershipUserCollection muc in ViewBag.roles)
    {                                        
        if(column == 1) {
            classe = "whiteRow";
            column = 0;
        }
        else {
            classe = "grayRow";
            column = 1;
        }
    <tr class="@classe"> 
        <td class="adminSetFormRowUsuario">role</td> 
        <td class="adminSetFormRowGrupo"></td> 
        <td class="formAction centerAlign">
            <img src="~/Images/editar.gif" alt="Editar"/>
            <span style="margin-left:5px"></span>
            <a href='javascript:AjaxRemoveUser("/Account/DeleteUser?role=@muc", "POST", "DinamicContent", "AdminSettingsTabsStructure")'><img src="~/Images/excluir.gif" alt="Excluir"/></a>
        </td> 
    </tr>

    }     
    </table> 
```

调试我可以看到 2 个值，`ViewBag.roles`但系统仍然抱怨 Null 或未实例化对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T01:00:21.683

```
// string array being assigned here
String[] rolesArray = Roles.GetAllRoles();
ViewBag.roles = rolesArray; 
```

> 调试我可以在 ViewBag.rules 中看到 2 个值，但系统仍然抱怨 Null 或未实例化对象。

这两个值大概是您分配的角色。

```
// This looks wrong...you are treating each string in the array as MembershipUserCollection
@foreach (MembershipUserCollection muc in ViewBag.roles)
{
}

// instead, this should give you the role names
@foreach( string role in ViewBag.roles )
{
    <div>@role</div>
} 
```

# python - 足够安全的 8 字符短唯一随机字符串

> ID：13484726
> 
> 赞同：54
> 
> 时间：2012-11-21T00:52:03.333
> 
> 标签：python, hash, random, cryptography

我正在尝试为数千个没有可能发生名称冲突的文件计算 8 个字符的短唯一随机文件名。这种方法足够安全吗？

```
base64.urlsafe_b64encode(hashlib.md5(os.urandom(128)).digest())[:8] 
```

## 编辑

为了更清楚起见，我正在尝试对上传到存储的文件名进行最简单的混淆。

我发现 8 个字符的字符串，足够随机，如果实施得当，将是存储数万个文件而不会发生冲突的非常有效和简单的方法。我不需要保证唯一性，只需要足够高的名称冲突可能性（仅谈论数千个名称）。

文件存储在并发环境中，因此增加共享计数器是可以实现的，但很复杂。在数据库中存储计数器效率低下。

我还面临这样一个事实，即 random() 在某些情况下会在*不同*的进程中返回*相同*的伪随机序列。

 ** * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-11-21T00:55:28.210

您当前的方法应该足够安全，但您也可以查看该[`uuid`](http://docs.python.org/2/library/uuid.html)模块。例如

```
import uuid

print str(uuid.uuid4())[:8] 
```

输出：

```
ef21b9ad 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2019-05-31T16:34:19.897

# 哪种方法碰撞更少、更快、更容易阅读？

### TLDR

这`random_choice`是**最快**的，**碰撞较少**，但 IMO 略**难阅读**。

最**易读**的是`shortuuid_random`外部依赖，速度稍慢，碰撞次数是 6 倍。

### 方法

```
 alphabet = string.ascii_lowercase + string.digits
su = shortuuid.ShortUUID(alphabet=alphabet)

def random_choice():
    return ''.join(random.choices(alphabet, k=8))

def truncated_uuid4():
    return str(uuid.uuid4())[:8]

def shortuuid_random():
    return su.random(length=8)

def secrets_random_choice():
    return ''.join(secrets.choice(alphabet) for _ in range(8)) 
```

### 结果

`abcdefghijklmnopqrstuvwxyz0123456789`所有方法都从字母表中生成 8 个字符的 UUID 。碰撞是从单次运行中计算的，有 1000 万次平局。时间以秒为单位报告为平均函数执行 ± 标准偏差，均计算 1,000 次绘制的 100 次运行。总时间是碰撞测试的总执行时间。

```
random_choice: collisions 22 - time (s) 0.00229 ± 0.00016 - total (s) 29.70518
truncated_uuid4: collisions 11711 - time (s) 0.00439 ± 0.00021 - total (s) 54.03649
shortuuid_random: collisions 124 - time (s) 0.00482 ± 0.00029 - total (s) 51.19624
secrets_random_choice: collisions 15 - time (s) 0.02113 ± 0.00072 - total (s) 228.23106 
```

### 笔记

*   默认`shortuuid`字母表具有大写字符，因此产生的冲突更少。为了进行公平比较，我们需要选择与其他方法相同的字母表。
*   这些`secrets`方法虽然可能更快`token_hex`，`token_urlsafe`但具有不同的字母表，因此不符合比较条件。
*   和`alphabet`基于类的`shortuuid`方法被分解为模块变量，从而加快了方法的执行速度。这不应影响 TLDR。

### 完整的测试细节

```
import random
import secrets
from statistics import mean
from statistics import stdev
import string
import time
import timeit
import uuid

import shortuuid

alphabet = string.ascii_lowercase + string.digits
su = shortuuid.ShortUUID(alphabet=alphabet)

def random_choice():
    return ''.join(random.choices(alphabet, k=8))

def truncated_uuid4():
    return str(uuid.uuid4())[:8]

def shortuuid_random():
    return su.random(length=8)

def secrets_random_choice():
    return ''.join(secrets.choice(alphabet) for _ in range(8))

def test_collisions(fun):
    out = set()
    count = 0
    for _ in range(10_000_000):
        new = fun()
        if new in out:
            count += 1
        else:
            out.add(new)
    return count

def run_and_print_results(fun):
    round_digits = 5
    now = time.time()
    collisions = test_collisions(fun)
    total_time = round(time.time() - now, round_digits)

    trials = 1_000
    runs = 100
    func_time = timeit.repeat(fun, repeat=runs, number=trials)
    avg = round(mean(func_time), round_digits)
    std = round(stdev(func_time), round_digits)

    print(f'{fun.__name__}: collisions {collisions} - '
          f'time (s) {avg} ± {std} - '
          f'total (s) {total_time}')

if __name__ == '__main__':
    run_and_print_results(random_choice)
    run_and_print_results(truncated_uuid4)
    run_and_print_results(shortuuid_random)
    run_and_print_results(secrets_random_choice) 
```

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2012-11-21T01:14:53.637

您是否有理由不能`tempfile`用来生成名称？

`mkstemp`像和这样的函数`NamedTemporaryFile`绝对保证给你唯一的名字；基于随机字节的任何东西都不会给你。

如果由于某种原因您实际上还不想创建文件（例如，您正在生成要在某个远程服务器或其他东西上使用的文件名），那么您就不能完全安全，但`mktemp`仍然比随机名称更安全。

或者只是将一个 48 位计数器存储在某个“足够全局”的位置，这样您就可以保证在发生冲突之前经历完整的名称循环，并且您还可以保证知道何时会发生冲突。

它们都比阅读`urandom`和做`md5`.

如果你真的想生成随机名称，`''.join(random.choice(my_charset) for _ in range(8))`也将比你正在做的更简单，更高效。Even`urlsafe_b64encode(os.urandom(6))`和 MD5 哈希一样随机，而且更简单、更高效。

密码随机性和/或密码散列函数的唯一好处是避免可预测性。如果这对您来说不是问题，为什么要为此付费？如果你确实需要避免可预测性，你几乎肯定需要避免比赛和其他更简单的攻击，所以避免`mkstemp`or`NamedTemporaryFile`是一个非常糟糕的主意。

更不用说，正如 Root 在评论中指出的那样，如果您需要安全性，MD5 实际上并没有提供它。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2019-04-28T11:59:45.100

你可以试试[shortuuid](https://github.com/skorokithakis/shortuuid)库。

安装：`pip install shortuuid`

然后它很简单：

```
> import shortuuid
> shortuuid.uuid()
'vytxeTZskVKR7C7WgdSP3d' 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2020-09-28T12:10:52.597

从 Python 3.6 开始，您可能应该使用该`secrets`模块。`secrets.token_urlsafe()`似乎很适合您的情况，并且保证使用加密安全的随机源。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-10-24T19:58:56.587

我正在使用[hashids](https://github.com/davidaurelio/hashids-python)将时间戳转换为唯一 ID。（如果需要，您甚至可以将其转换回时间戳）。

这样做的缺点是如果你创建 id 太快，你会得到一个副本。但是，如果您在中间生成它们，那么这是一个选项。

这是一个例子：

```
from hashids import Hashids
from datetime import datetime
hashids = Hashids(salt = "lorem ipsum dolor sit amet", alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890")
print(hashids.encode(int(datetime.today().timestamp()))) #'QJW60PJ1' when I ran it 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-06-17T12:55:08.937

你可以试试这个

```
import random
uid_chars = ('a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u',
             'v', 'w', 'x', 'y', 'z','1','2','3','4','5','6','7','8','9','0')
uid_length=8
def short_uid():
    count=len(uid_chars)-1
    c=''
    for i in range(0,uid_length):
        c+=uid_chars[random.randint(0,count)]
    return c 
```

例如：

```
print short_uid()
nogbomcv 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-11-20T12:29:12.017

### 最快的确定性方法

```
import random
import binascii
e = random.Random(seed)
binascii.b2a_base64(random.getrandbits(48).to_bytes(6, 'little'), newline=False) 
```

### 最快的系统随机方法

```
import os
import binascii
binascii.b2a_base64(os.urandom(6), newline=False) 
```

### 网址安全方法

利用`os.urandom`

```
import os
import base64
base64.urlsafe_b64encode(os.urandom(6)).decode() 
```

使用`random.Random.choices`（缓慢，但灵活）

```
import random
import string
alphabet = string.ascii_letters + string.digits + '-_'
''.join(random.choices(alphabet, k=8)) 
```

使用`random.Random.getrandbits`（快于`random.Random.randbytes`）

```
import random
import base64
base64.urlsafe_b64encode(random.getrandbits(48).to_bytes(6, 'little')).decode() 
```

使用`random.Random.randbytes`(python >= 3.9)

```
import random
import base64
base64.urlsafe_b64encode(random.randbytes(6)).decode() 
```

使用`random.SystemRandom.randbytes`(python >= 3.9)

```
import random
import base64
e = random.SystemRandom()
base64.urlsafe_b64encode(e.randbytes(6)).decode() 
```

`random.SystemRandom.getrandbits`如果 python >= 3.9，则不建议使用，因为它需要 2.5 倍的时间，`random.SystemRandom.randbytes`并且更复杂。

使用`secrets.token_bytes`(python >= 3.6)

```
import secrets
import base64
base64.urlsafe_b64encode(secrets.token_bytes(6)).decode() 
```

使用`secrets.token_urlsafe`(python >= 3.6)

```
import secrets
secrets.token_urlsafe(6) # 6 byte base64 has 8 char 
```

### 进一步讨论

python3.9中的secrets.token_urlsafe实现

```
tok = token_bytes(nbytes)
base64.urlsafe_b64encode(tok).rstrip(b'=').decode('ascii') 
```

由于 ASCII 字节`.decode()`比 快`.decode('ascii')`，并且`.rstrip(b'=')`在`nbytes % 6 == 0`.

`base64.urlsafe_b64encode(secrets.token_bytes(nbytes)).decode()`更快（~20%）。

在 Windows10 上，基于字节的方法在 nbytes=6(8 char) 时快 2 倍，在 nbytes=24(32 char) 时快 5 倍。

在 Windows 10（我的笔记本电脑）上，`secrets.token_bytes`花费类似的时间`random.Random.randbytes`，并且`base64.urlsafe_b64encode`比随机字节生成花费更多的时间。

在 Ubuntu 20.04（我的云服务器，可能缺少熵）上，`secrets.token_bytes`花费的时间比 多 15 倍`random.Random.randbytes`，但花费的时间类似`random.SystemRandom.randbytes`

由于`secrets.token_bytes`使用`random.SystemRandom.randbytes`use `os.urandom`（因此它们完全相同），如果性能至关重要，您可以替换`secrets.token_bytes`为。`os.urandom`

在 Python3.9 中，`base64.urlsafe_b64encode`是 和 的组合`base64.b64encode`，`bytes.translate`因此要多花约 30% 的时间。

`random.Random.randbytes(n)`由 实现`random.Random.getrandbits(n * 8).to_bytes(n, 'little')`，因此慢 3 倍。（但是，`random.SystemRandom.getrandbits`用 实现`random.SystemRandom.randbytes`）

`base64.b32encode`速度要慢得多（6 字节为 5 倍，480 字节为 17 倍），`base64.b64encode`因为其中有很多 python 代码`base64.b32encode`，但`base64.b64encode`只需调用`binascii.b2a_base64`（C 实现）。

不过里面有个python分支语句，`if altchars is not None:`在`base64.b64encode`处理小数据时会引入不可忽略的开销，`binascii.b2a_base64(data, newline=False)`可能会更好。*

# struts2 - Struts 2 s:iterator: 如何避免名称冲突？

> ID：13484729
> 
> 赞同：2
> 
> 时间：2012-11-21T00:52:10.767
> 
> 标签：struts2

据我所知`s:iterator`，即使我使用该`var`属性，也总是将当前项目推入 OGNL 值堆栈。这意味着当前项目的所有成员都成为循环内的顶级 OGNL 变量，可能隐藏了 Action 的属性：

```
<s:property value="owner" /> <%-- From the Action --%>
<s:iterator value="projects" var="project">
    <s:property value="#project.owner" /> <%-- From the project, obviously --%>
    <s:property value="owner" /> <%-- Ops, also from the project! --%>
</s:iterator>
<%-- (Fun(?) fact: #project.owner is still accessible here) --%> 
```

我们迭代的对象（通常具有多个嵌套级别）具有许多属性，并且它们的数量可以在以后增加。意外隐藏属性的危险是非常真实的，更糟糕​​的是，向 JavaBeans 添加属性可能会破坏曾经工作的页面。

我在这里错过了什么吗？如何使用 Struts 2 + JSP 遍历复杂对象？

# c - 使用 strcpy 崩溃到数据结构的偏移量

> ID：13484734
> 
> 赞同：3
> 
> 时间：2012-11-21T00:52:24.473
> 
> 标签：c

我在 C 程序中使用了一个特定的数据结构，我用它来将类型信息附加到值。一个简单的示例如下所示：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

struct teststruct
{
    char type;
    union {
        char s;
        int i;
        float f;
    } value;
};

int main()
{
    struct teststruct *t = malloc(sizeof(struct teststruct)+10);
    t->type = 'i';
    t->value.i = 42;
    free(t);

    t = malloc(sizeof(struct teststruct)+10);
    t->type = 's';
    strcpy(&t->value.s, "test");

    free(t);

    printf("Finished without errors.\n");
} 
```

如您所见，我的意图是使用`type`字段来识别值的类型，并使用`value`字段来包含可能值的联合。当数据是字符串时，想法是分配更多的内存`sizeof(struct teststruct)`，然后使用`&t->value.s`.

虽然这可行，但对于优化器来说显然是有问题的。使用`gcc`4.7.2 版，我在非优化条件下得到以下结果：

```
$ gcc -O0 -o test test.c
$ ./test 
Finished without errors. 
```

没问题。但是，在优化器下，它给了我一个警告：

```
$ gcc -O2 -o test test.c
In file included from /usr/include/string.h:642:0,
                 from test.c:4:
In function ‘strcpy’,
    inlined from ‘main’ at test.c:25:15:
/usr/include/i386-linux-gnu/bits/string3.h:105:3: warning: call to __builtin___memcpy_chk will always overflow destination buffer [enabled by default] 
```

确实，

```
$ ./test 
*** buffer overflow detected ***: ./test terminated 
```

但是，如果我替换`strcpy`为`memcpy`，这可以正常工作，如果我替换`strcpy`为`for`-loop 也可以很好地工作。但是，`strncpy`崩溃就像`strcpy`. 我绝对不会在`malloc`'ed 内存之外被覆盖，所以我不知道为什么会崩溃。

我意识到复制到数据结构的奇怪偏移量并不常见，所以问题是，我是否违反了 的某些语义契约`strcpy`，或者这是编译器中的错误？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:55:53.567

您的代码在此处无效：

```
strcpy(&t->value.s, "test");
// value.s is a single char, not a string that you can store
// an arbitrary number of characters into.
// 
```

你要么需要给`s`一些空间

```
struct teststruct
{
    char type;
    union {
        char s[10]; // length depends on your specific needs
        int i;
        float f;
    } value;
}; 
```

或制作 sa 指针并根据需要动态分配

```
struct teststruct
{
    char type;
    union {
        char *s;
        int i;
        float f;
    } value;
};
// instead of strcpy(&t->value.s, "test"); use t->value.s = strdup("test")
// don't forget to free the space when you are done. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-09T19:47:17.933

我自己不是 gcc 专家，但在阅读 [1] 之后，我相信 gcc -O2 正在使用 memcpy 实现 strcpy() 调用，并使用 __builtin___memcpy_chk 检查溢出。

根据 [1] 中的示例， __builtin___memcpy_chk 的原因显然是为了检查目标对象的长度，并允许在运行时捕获缓冲区溢出。

而且根据 [1]，如果 gcc 在编译时知道 __builtin___memcpy_chk*本身*会溢出，您将收到编译时警告。

如果您仍然希望保留模糊的 char 数组分配，我会说您至少应该使用安全的 strcpy：

```
strncpy(&t->value.s, "test", 9); 
```

请注意，我无法在我的机器上触发此行为，因此我无法反汇编代码来查看实际情况。

[1] [https://gcc.gnu.org/onlinedocs/gcc/Object-Size-Checking.html](https://gcc.gnu.org/onlinedocs/gcc/Object-Size-Checking.html)

# python - Python中有哪些异常？

> ID：13484740
> 
> 赞同：2
> 
> 时间：2012-11-21T00:53:07.677
> 
> 标签：python

我已经阅读了三本 Python 入门级书籍，但是我仍然不了解异常。

有人能给我一个高层次的解释吗？

我想我理解异常是导致代码停止工作的代码或过程中的错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T01:05:55.353

在过去，当人们用汇编语言或 C 语言编写时，每次调用可能失败的函数时，都必须检查它是否成功。所以你会有这样的代码：

```
def countlines(path):
    f = open(path, 'r')
    if not f:
        print("Couldn't open", path)
        return None
    total = 0
    for line in f:
        value, success = int(line)
        if not success:
            print(line, "is not an integer")
            f.close()
            return None
        total += value
    f.close()
    return total 
```

异常背后的想法是您不必担心那些异常情况，您只需编写以下代码：

```
def countlines(path):
    total = 0
    with open(path, 'r') as f:
        for line in f:
            total += int(line)
    return total 
```

如果 Python 无法打开文件，或者将行转换为整数，它会引发异常，这会自动关闭文件，退出你的函数，并退出你的整个程序，打印出有用的调试信息。

在某些情况下，您希望处理异常而不是让它退出您的程序。例如，也许您想打印错误消息，然后向用户询问不同的文件名：

```
while True:
    path = input("Give me a path")
    try:
        print(countlines(path))
        break
    except Exception as e:
        print("That one didn't work:", e) 
```

一旦你了解了异常试图完成的基本思想，[本教程](http://docs.python.org/3/tutorial/errors.html)就会提供很多有用的信息。

如果您想了解更多背景知识，[维基百科](http://en.wikipedia.org/wiki/Exception_handling)可以提供帮助（尽管在您了解基本思想之前，这篇文章并不是很有用）。

如果您仍然不明白，请提出更具体的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T01:08:34.287

Python 的文档：[http ://docs.python.org/2/tutorial/errors.html](http://docs.python.org/2/tutorial/errors.html)

对于高级解释，假设我们要划分`varA / varB`. 我们知道`varB`不能等于 0，但我们可能不想在每次进行除法时都执行检查：

```
if varB != 0:
  varA / varB 
```

我们可以使用异常来尝试块而不先执行条件，然后根据`try`块中是否出现问题来处理程序的行为。在以下代码中，如果`varB == 0`，则 'oops' 将打印到控制台：

```
try:
  varA / varB
except ZeroDivisionError:
  print 'oops' 
```

以下是可以使用的异常列表：http: [//docs.python.org/2/library/exceptions.html#exceptions.BaseException](http://docs.python.org/2/library/exceptions.html#exceptions.BaseException)

但是，如果您知道它是如何失败的，您可以打开一个 python 控制台并查看引发了什么异常：

```
>>> 1 / 0
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ZeroDivisionError: integer division or modulo by zero 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T00:59:41.007

最好的起点是 Python 的[内置异常列表](http://docs.python.org/2/library/exceptions.html)，因为您会看到大多数都源自于此。

请记住，任何人都可以在任何事情上抛出他们想要的任何错误，然后捕捉它并消除它。这是一个使用异常进行处理而不是 if/else 的快速片段，如果`__get_site_file()`在任何路径列表中都找不到文件，则会引发异常。尽管有这个特殊的例外，代码仍然可以工作。但是，如果文件存在但权限不允许读取，代码会抛出未捕获的错误，该错误会停止执行。

```
def __setup_site_conf(self):                                                
    # Look for a site.conf in the site folder                              
    try:                                                                    
        path = self.__get_site_file('site.conf')                            
        self.__site_conf = open(path).read()                                
    except EnvironmentError:                                                
        self.__site_conf = self.__get_site_conf_from_template() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-30T08:22:07.273

异常是程序执行过程中发生的意外事件。异常可能由 a`logical error`或a 引起`unanticipated situation`。

在 Python 中，异常（也称为错误）是由遇到意外情况的代码引发（或抛出）的对象。

Python 解释器也可以在遇到意外情况时引发异常，例如内存不足。引发的错误可能会被以适当方式“处理”异常的周围上下文捕获。

如果未被捕获，异常会导致解释器停止执行程序并向控制台报告适当的消息。

```
def sqrt(x):

   if not isinstance(x, (int, float)):
       raise TypeError( x must be numeric )
   elif x < 0:
       raise ValueError( x cannot be negative ) 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-11-21T01:02:36.990

异常不一定是错误。它们是当代码遇到它不（立即）知道如何处理的事情时引发的事情。这可能是完全可以接受的，具体取决于您如何编写代码。例如，假设您要求用户输入一个数字。然后，您尝试获取该文本（字符串）并将其转换为数字（int）。但是，如果用户输入“cat”，这将引发异常。但是，您可以让您的代码处理该异常，而不是中断，只需给用户一条小消息，要求他再试一次，并请使用一个数字。查看此链接以了解我在说什么：[http](http://www.tutorialspoint.com/python/python_exceptions.htm) ://www.tutorialspoint.com/python/python_exceptions.htm 此外，您通常使用 try, except（或 catch）块来处理异常。例子：

```
try:
    integer = int(raw_input("Please enter an integer: "))
except Exception, exc:
    print "An error has occured."
    print str(exc) 
```

希望能帮助到你！

# mysql - SQL - 如何从一个表中获取数据，并将其插入到另一个表中

> ID：13484741
> 
> 赞同：1
> 
> 时间：2012-11-21T00:53:13.190
> 
> 标签：mysql, sql

我正在尝试浏览我的用户表，如果排名列是某个值，那么我想在消息表中插入一行，其中一列“to”是用户表中的用户名列，并且插入行中的其余列需要是预定义的值。我无法完成这项工作 - 有什么帮助吗？

MySQL配置：（需要的那些）

用户表：

```
id|username|rank 
```

消息表：

```
id|to|from|body|subject 
```

(`to`需要来自`users`表，, `from`,`body`并且`subject`需要是预定义的字符串

我试图弄清楚这样的事情，但这不仅仅是我需要它做的全部。我得到了这段代码，并从另一个与此类似的 Stack Overflow 问题中对其进行了修改。

```
INSERT INTO `messages` (`from`,`to`,`subject`,`body`)  
SELECT `id`,`rank`
  FROM `users`
 WHERE `rank`='Super' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T00:56:55.797

您可以使用单引号括起来的字符串文字作为列值。将它们与语句`SELECT`部分返回的行中的实际列值混合是安全的。`INSERT INTO...SELECT`

```
INSERT INTO `messages` (`from`, `to`, `subject`, `body)
  SELECT 
   /* single-quote string literals to use them in the INSERT INTO...SELECT */
   'Predefined string From',
   /* Intermixed with column values from the rows returned by the SELECT */
   `username`,
   'Predefined string subject',
   'Predefined string body'
  FROM `users`
  WHERE `rank`='Super' 
```

# android - 如何检测某些手势？

> ID：13484743
> 
> 赞同：1
> 
> 时间：2012-11-21T00:53:27.710
> 
> 标签：android

所以我正在构建一个游戏，我希望能够允许用户根据屏幕上的手势执行某些操作。

例如，用户用手指在屏幕上画了一个圆圈，然后就会发生一些事情。

或者用户制作了一个三角形然后发生了一些事情..

有没有办法检测这种类型的手势？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T00:57:07.097

这个人写了一篇关于这个主题的很棒的帖子，来源包括： [http ://www.androiddevblog.net/android/gesture-detection-in-android-part-2-of-2](http://www.androiddevblog.net/android/gesture-detection-in-android-part-2-of-2)

# powershell - Import-AzurePublishSettingsFile 给出错误 Value can not be null for Parameter name s

> ID：13484745
> 
> 赞同：0
> 
> 时间：2012-11-21T00:53:29.240
> 
> 标签：powershell, azure

下载发布设置 Get-AzurePublishSettingsFile 后，我正在使用 Import-AzurePublishSettingsFile，但出现以下错误：

```
Import-AzurePublishSettingsFile : Value can not be null.
Parameter name: s
At line:1 char:1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T01:39:00.233

当 Import-AzurePublishSettingsFile PowerShell 命令运行时，它会在本地计算机中创建特定于配置的设置文件，如下所示：

```
C:\Users\<Windows_Login_User_Name>\AppData\Roaming\Windows Azure Powershell 
```

*   配置文件
*   默认订阅数据.xml
*   发布设置.xml

在某些情况下，上述文件由于任何原因而损坏，可能会出现上述问题。如果是这种情况，请继续删除上述位置的所有文件，然后重试相同的命令。这将再次重新生成配置文件，发布设置将被导入。

# apache - htaccess 重定向而不在域标签 (.com) 之后定向内容

> ID：13484746
> 
> 赞同：1
> 
> 时间：2012-11-21T00:53:43.657
> 
> 标签：apache, .htaccess

我的问题很简单，我需要完成以下工作：

**here.domain.com** -> **domain.com/这里**

但是，*我不希望包含出现在域标签*(.com)之后的任何内容

如果访问者请求**here.domain.com/something**，它将保持为 here.domain.com/something

希望这是有道理的，我试过这个：但它没有条件逻辑来测试域顶级之后的内容：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^here\.domain\.com
RewriteRule ^(.*)$ /here/$1 [L] 
```

有足够知识的人来帮助这个预告片吗？

# jsf - 是否可以绑定 HTML5 的值到 JSF 托管 bean 属性？

> ID：13484747
> 
> 赞同：14
> 
> 时间：2012-11-21T00:53:48.023
> 
> 标签：jsf, html5-input-date

我想使用新的 HTML5`<input type="date">`并将其值绑定到托管 bean：

```
<input type="date" value="#{bean.date}"/> 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-21T01:34:28.083

这只有在 JSF 2.2 之后才有可能。此功能称为[“直通元素”](https://docs.oracle.com/javaee/7/tutorial/jsf-facelets009.htm#sthref391)。

```
<html xmlns:jsf="http://xmlns.jcp.org/jsf">
...
<input type="date" jsf:value="#{bean.date}" /> 
```

或者，使用[“直通属性”](https://docs.oracle.com/javaee/7/tutorial/jsf-facelets009.htm#sthref393)。

```
<html xmlns:a="http://xmlns.jcp.org/jsf/passthrough">
...
<h:inputText a:type="date" value="#{bean.date}" /> 
```

在较旧的 JSF 版本中，使用自定义组件和/或渲染器。[您可以在JSF 不呈现自定义 HTML 标记属性中](https://stackoverflow.com/questions/16666472/custom-html-tag-attributes-are-not-rendered-by-jsf)找到指向示例的链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-07-15T14:22:48.527

另一种方法（仅适用于 JSF 2.2）是使用`f:passThroughAttribute`您的 inputText 内部：

```
<h:inputText id="yourNumberField" value="#{mainController.myBeautifulNumber}">
    <f:passThroughAttribute name="type" value="number"/>
    <f:passThroughAttribute name="step" value="0.02"/>
</h:inputText> 
```

`f:`命名空间是默认的`xmlns:f="http://xmlns.jcp.org/jsf/core"`。

# c# - 通过 DotRas 设置“为单链路连接协商多链路”

> ID：13484750
> 
> 赞同：0
> 
> 时间：2012-11-21T00:53:56.633
> 
> 标签：c#, ras

我正在使用 DotRas 在 ras 电话簿中创建一个拨号条目。

一切正常，只是我不知道如何设置该选项。

当我在 Windows 中手动创建连接并在 PPP 设置中检查该选项时，一切正常。

如果未选中，则无法访问 Internet。

使用 RasEntry 定义条目。打开 RasPhoneBook (user) 所以用户权限没有问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T13:14:22.157

这发生在 win2k 库上。简单的解决方案是使用 WinXP 库，并设置 DoNotNegotiateMultilink 标志。

这样做设置了winXP 的最低要求。

# content-management-system - 更好的内容管理系统的设计原则

> ID：13484753
> 
> 赞同：1
> 
> 时间：2012-11-21T00:54:24.670
> 
> 标签：content-management-system, design-principles

可能问题对你来说太简单了。但很多时候我觉得这很复杂。每个人都会以自定义 cms 开始他们的网站，然后转移到 Wordpress、Drupal、Joomla 或类似的东西。

我曾经寻找更好的书籍或博客文章，其中包含为 cms 做出的设计决策，以使其可以扩展。一些我觉得很有趣的书是

1.  [PHP 5 CMS 框架开发](http://www.packtpub.com/php-5-cms-framework-development-2nd-edition/book)
2.  [Pro Zend 框架 CMS](http://www.apress.com/9781430218791)

很高兴看到您是否遇到过此类书籍，或者您是否推荐过任何其他书籍。我不只是在寻找 PHP，而且我有兴趣阅读任何类型的书籍，这将帮助我建立下一个博主。

让我感兴趣的事情是

1.  [博主](http://blogger.com)
2.  [德鲁帕花园](http://www.drupalgardens.com/)
3.  [棒棒哒](https://www.tumblr.com/)

和类似的东西。

谢谢

# html - 详细说明“显示：无；” 和内容加载

> ID：13484755
> 
> 赞同：2
> 
> 时间：2012-11-21T00:54:50.690
> 
> 标签：html, css

我似乎无法找到关于“显示：无”效果的可靠答案；和内容加载。

我一直认为某些浏览器不会在具有“显示：无”样式的内容中加载外部资源，这仍然会跨平台变化吗？

此外，这是否因移动平台而异？

通常，我混合使用不透明度、过滤器 (IE)、高度/宽度和绝对定位来确保我的内容将被加载但不可见。这还有必要吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T16:59:45.733

也许 Tim Kadlec 的这个网站（归功于 Cloud Four 团队）可以进一步帮助您：http: [//timkadlec.com/2012/04/media-query-asset-downloading-results/](http://timkadlec.com/2012/04/media-query-asset-downloading-results/)

问候，冈瑟

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-21T01:23:23.713

在大多数现代浏览器中，只需使用 display:none 就足够了。在极少数情况下，您可能需要进行更多研究，但在大多数情况下，您应该会看到完整的功能。在相当长的一段时间内，我不必使用 abs 定位技巧（将内容移出可视区域），因为 display:none 似乎可以解决问题。

就跨平台而言，浏览器在一致地呈现 CSS 方面做得越来越好。根据我的经验， display:none 似乎在大多数现代浏览器中都能完美运行。较旧的浏览器仍可能有问题需要解决。

我在移动方面没有太多经验，所以我不会提供任何意见或猜测。

使用过滤器、h/w、abs pos 不再是必要的邪恶，因为“display:none”将允许您仅将容器隐藏在它自然定位的位置，而不是在此处移动/隐藏，然后在加载时重新定位。

# unit-testing - 伪造串行端口通信

> ID：13484756
> 
> 赞同：0
> 
> 时间：2012-11-21T00:54:53.177
> 
> 标签：unit-testing, automation, serial-port, travis-ci

我正在寻找模拟串行端口，以便测试通信和操作系统刷新。

我希望从模拟串口中得到的东西。（按项目重要性排序）

*   通行证[_](http://www.thinkage.ca/english/gcos/expl/c/lib/istty.html)
*   能够与自动化测试套件一起使用（无 gui）
*   语言不可知论者
*   能够在 TravisCI 上运行
*   跨平台

我不知道是否所有这些选项都是可能的。但这样做会很好。我知道 Unix 将所有内容都视为文件，所以如果我可以创建一个通过[istty](http://www.thinkage.ca/english/gcos/expl/c/lib/istty.html)的文件，那将是一个很好的解决方案，但可能与 Windows 不兼容。

无论如何，测试 SerialPort 通信的任何想法都会令人惊叹。

感谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T01:13:24.250

我相信如果您使用 CMock，您可以传递一个 .h 文件并生成一个模拟。

如果做不到这一点，我会手写一个。没什么特别的，只是存根和一些基本的已知返回值。一旦模拟（以及您的测试/被测单元）得到充分开发，我就会切换到使用真实套接字 API 的集成测试

# css - 在 CSS 属性中设置总和

> ID：13484758
> 
> 赞同：0
> 
> 时间：2012-11-21T00:54:58.567
> 
> 标签：css

我有几个具有确定 css 类的 div。

我想手动将像素添加到顶部属性：

> .class { 顶部：100px; }
> 
> div class="class" style="top:+=50px"

有可能做这样的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:59:25.157

不，无论如何都不可靠。

有一个名为 calc() 的 CSS3 属性可以做到这一点，但它不会在任何地方工作，但最新的浏览器和支持可能是不稳定的。

更多关于它的信息。 [http://robertnyman.com/css3/calc/calc.html](http://robertnyman.com/css3/calc/calc.html)

根据您想要执行此操作的原因，您可能需要考虑使用 CSS 预处理器，例如 LESS 或 SASS。

你想这样做的原因是什么？从提出的问题来看，可能有一个不是立即显而易见的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T01:03:30.437

不是直接的 CSS。使用像[LESS](http://lesscss.org/)或[SASS](http://sass-lang.com/)这样的预处理器可以在服务器端完成。

你可以用 jQuery/JavaScript 完成同样的事情。

```
var class = $('.class');
var top = class.css('top').substr(0,class.css('top').length - 2);
top += //your value here
class.css('top',top + 'px'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T01:11:15.947

CSS3 转换在这里可能很有用。像：

```
.class { top: 100px; }

div class="class" style="transform:translate(0,50px)" 
```

但是，您必须添加所有供应商前缀，例如：

```
style="transform:translate(0,50px);-webkit-transform:translate(0,50px);-o-transform:translate(0,50px);-ms-transform:translate(0,50px);-moz-transform:translate(0,50px)" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T01:03:20.663

不，不仅仅是 CSS。

您可以使用一些服务器端代码或浏览器中的 JavaScript 来完成。

另一种方法可能是使用支持变量和简单计算的[LESS](http://lesscss.org/)或[SAAS 。](http://sass-lang.com/)

# android - Upload Information to Rails and update Android application

> ID：13484768
> 
> 赞同：0
> 
> 时间：2012-11-21T00:56:03.590
> 
> 标签：android, ruby-on-rails

So I have an Android application that visualizes points of interest with relevant information. I also plan to have a Ruby on Rails application, that allows users to upload new points of interests with the appropriate attributes (i.e. information). What would be the best way to update my Android application's SQLite database to reflect the new information?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T01:46:33.067

When you updating your RoR application, you want to reflect the changes on your android application as well?? hmm, if in case, you can use GCM which will give u real time push msg [http://developer.android.com/guide/google/gcm/index.html](http://developer.android.com/guide/google/gcm/index.html)

here is a post about it also. [Gem for push notifications for Android and iOS](https://stackoverflow.com/questions/8107583/gem-for-push-notifications-for-android-and-ios)

correct me if im missunderstanding your question

# python - OperationalError：无法使用 Flask IDE 插件在 PyCharm 中打开数据库文件

> ID：13484771
> 
> 赞同：1
> 
> 时间：2012-11-21T00:56:25.380
> 
> 标签：python, sqlite, initialization, database-connection, flask

在一天的大部分时间里，我一直在为此苦苦挣扎。我绝对无法在 PyCharm 中连接到我的数据库。我什至在从 github 下载教程源时完全按照视频教程进行操作。请帮忙！

[http://www.youtube.com/watch?v=jaFEODzG7B8](http://www.youtube.com/watch?v=jaFEODzG7B8) https://github.com/mitsuhiko/flask/tree/master/examples/flaskr/

```
# all the imports
from __future__ import with_statement
from contextlib import closing
import sqlite3
from flask import Flask, request, session, g, redirect, url_for,\
abort, render_template, flash

# configuration
DATABASE = "flaskr.db"
DEBUG = True
SECRET_KEY = 'development key'
USERNAME = 'admin'
PASSWORD = 'default'

# create our little application :)
app = Flask(__name__)
app.config.from_object(__name__)

def connect_db():
return sqlite3.connect(app.config['DATABASE'])

def init_db():
    with closing(connect_db()) as db:
    with app.open_resource('schema.sql') as f:
        db.cursor().executescript(f.read())
    db.commit()

if __name__ == '__main__':
app.run() 
```

尝试初始化数据库时出现以下错误：

```
>>> init_db()
Traceback (most recent call last):
  File "<console>", line 1, in <module>
  File "C:\Users\Intern2\PycharmProjects\flaskr\flaskr.py", line 23, in init_db
    with closing(connect_db()) as db:
  File "C:\Users\Intern2\PycharmProjects\flaskr\flaskr.py", line 20, in connect_db
return sqlite3.connect(app.config['DATABASE'])
OperationalError: unable to open database file 
```

从字面上看，任何理论都将不胜感激！

**更新：**我创建了数据库文件，但现在我无法找到它。我尝试了多个版本的路径。

```
DATABASE = '/Users/snuffles753/PycharmProjects/flaskr/flaskr.db'
DATABASE = 'flaskr.db 
```

等等...该文件与我的 .py 文件位于完全相同的位置

另外，我正在使用 Mac OS

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T19:47:46.977

问题是您需要先创建“flaskr.db”文件，然后才能连接到它。它不是自己创建的。因此，请执行以下操作：

1.  转到您的 flask.py 代码所在的目录。运行以下命令：

    触摸flaskr.db

2.  确保允许此文件的权限：

    chmod 777 flaskr.db

# java - 从 actionPerformed() 打破程序风格

> ID：13484773
> 
> 赞同：1
> 
> 时间：2012-11-21T00:56:35.397
> 
> 标签：java, multithreading, awt, actionlistener, procedural

我有一个小应用程序，它在单击按钮时打开一个 fileChooser，并在选择一个文件后使用它的内容。所以，假设我们有这个伪代码：

```
 File file = new File();
    JFileChooser fileChooser = new JFileChooser();

    [...]

    actionPerformed() {
      file = fileChooser.getSelectedFile();
      doStuffWithFile(file);
    } 
```

在这一点上，代码似乎采用了程序化风格，因为*文件*发生的所有事情现在实际上都发生在 actionPerformed() 方法中。我不确定这是否可以。

这是好的编码风格吗？直观地说，我想结束 actionPerformed() 并拥有处理从其他地方调用的*文件的方法。*但我该怎么做呢？

一个想法是在 actionPerformed()中设置*文件的新值。*然后我可以用吸气剂得到那个值。但怎么会呢？这应该是接下来发生的事情。

我在 stackoverflow 上看到了一个 propertyChangeListener，但我不确定这是否也是正确的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T01:12:39.973

一种选择是多线程。它仍然会做所有事情，但不是在事件线程中。例如：

```
actionPerformed(){
    new Thread(){
        public void run(){
            file = fileChooser.getSelectedFile();
            doStuffWithFile(file);
        }
     }.start()
} 
```

# php - Kaltura KalturaMetadataListResponse print_r 结果

> ID：13484781
> 
> 赞同：0
> 
> 时间：2012-11-21T00:57:17.347
> 
> 标签：php, object, kaltura

我从函数`print_r`返回的变量中得到以下返回结果。`$metadataPlugin->metadata->listAction($filter, $pager)`我试图呼应这`[xml]`件作品，但不知道该怎么做。

```
KalturaMetadataListResponse Object ( [objects] => Array ( [0] => KalturaMetadata Object ( [id] => 1 [partnerId] => 8 [metadataProfileId] => 2 [metadataProfileVersion] => 1 [metadataObjectType] => 1 [objectId] => 0 [version] => 1 [createdAt] => 1353093894 [updatedAt] => 1353093894 [status] => 1 [xml] => 1353049200 ) ) [totalCount] => 1 ) 
```

我试过了

```
echo $result['objects'][0]->xml; 
```

和

```
echo $result[0]->xml; 
```

没有成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T00:59:24.447

看起来应该是

```
$result->objects[0]->xml 
```

请记住，在查看`print_r`或`var_dump`结果时，任何时候您`Object (...)`都需要使用`->`来访问为该对象列出的属性。

因此，在这种情况下，您将基本 Object 设置为`$result`，然后您需要从中获取`objects`属性。该属性包含一个数组。在数组的索引 0 处，是另一个对象，它是您的`xml`属性所在的对象。

# android - monodroid 从资产播放视频

> ID：13484784
> 
> 赞同：2
> 
> 时间：2012-11-21T00:57:50.273
> 
> 标签：android, xamarin.android, android-video-player

我正在使用 monoandroid，我想使用它：

```
var uri = Android.Net.Uri.Parse ("Content/video.m4v");
            video.SetVideoURI (uri);
            video.Start(); 
```

为了播放视频，但我找不到正确的路径，该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T05:13:42.880

另一种播放声音的方法是将文件添加到 Resources/Raw 目录中，然后使用以下内容：

```
var player = global::Android.Media.MediaPlayer.Create(this, Resource.Raw.YourSound);
player.Start();
player.Completion += (m_sender, m_e) =>
{
player.Release();
player = null;
}; 
```

# python - 跨浏览器选项卡的 Python 会话范围

> ID：13484786
> 
> 赞同：0
> 
> 时间：2012-11-21T00:57:53.303
> 
> 标签：python, session, web.py

我正在使用 python web.py 创建一个快速原型来测试一些东西。我注意到会话变量的范围是同一浏览器（例如 Chrome）上的 2 个选项卡共享会话。

有没有办法避免这种情况？这将使我能够更有效地调试和测试。

为了提供一些上下文，我正在使用`DiskStore`会话：

```
session = web.session.Session(app, web.session.DiskStore('sessions')) 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T00:59:54.120

所有现代浏览器都以这种方式运行。它与将 cookie 发送到先前已设置 cookie 的站点有关。否则，弹出窗口和其他窗口将无法正常运行。

为了解决这个问题，我经常在 Chrome 中使用隐身和普通浏览。那里有一个分隔，可以防止一个人看到另一个人的 cookie。

此外，您可以使用单独的浏览器来完成此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T01:07:37.170

我有同样的问题。看到这个问题：[https ://stackoverflow.com/questions/13187649/how-to-solve-webapp2-session-cookie-conflicts-between-browser-tabs](https://stackoverflow.com/questions/13187649/how-to-solve-webapp2-session-cookie-conflicts-between-browser-tabs)

我通过创建自己的会话 ID（包括 CSRF）并将此会话 ID 保存在表单中而不是 cookie 中来解决它。session-id 指向我的数据库会话存储。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T16:10:56.380

**非常酷的选择：**

您还可以使用 --user-data-dir= 选项运行多个不同的 Chrome 副本。

——丹·D。

# xml-parsing - Sweble 维基百科解析器

> ID：13484793
> 
> 赞同：2
> 
> 时间：2012-11-21T00:58:15.577
> 
> 标签：xml-parsing, wikipedia, wikipedia-api

我目前正在开展一个项目，该项目涉及解析整个维基百科的 wikiText。有人知道 Sweble 维基百科解析器吗？我在 [1] 上找到了这个解析器：[http](http://sweble.org) : //sweble.org 如果你以前使用过这个解析器或者建议其他解析器，你们能否评论一下这个解析器？

提前致谢。

# android-ndk - 如何为编译android NDK项目设置标准c99

> ID：13484795
> 
> 赞同：5
> 
> 时间：2012-11-21T00:58:19.153
> 
> 标签：android-ndk

我想为 Android 构建用 C99 编写的小型库，但编译器给出的日志为

```
note: use option -std=c99 or -std=gnu99 to compile your code 
```

我可以在哪里设置？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-21T07:49:10.270

在你的 Android.mk 添加

```
LOCAL_CFLAGS += -std=c99 
```

例如：

```
LOCAL_PATH := $(call my-dir)
include $(CLEAR_VARS)
LOCAL_CFLAGS += -std=c99
LOCAL_SRC_FILES := com_example_ndktest_TestLib.c
LOCAL_MODULE := com_example_ndktest_TestLib
include $(BUILD_SHARED_LIBRARY) 
```

确保在添加 'include $(CLEAR_VARS)' 后添加 'LOCAL_CFLAGS'

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-20T21:27:13.727

auselen 回答的附录：

根据 NDK 文档 ( [kandroid.org mirror](http://www.kandroid.org/ndk/docs/APPLICATION-MK.html) )，LOCAL_CFLAGS 将仅适用于每个模块 - 如果您希望在整个项目中使用此行为，请在 Application.mk 中设置 APP_CFLAGS。此外，CFLAGS 将涵盖 C 和 C++ 源代码，CPPFLAGS 仅涵盖 C++。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-10-02T18:09:20.480

由于人们可能来到这里寻找“为编译 android NDK 项目设置标准 c99”，我认为这需要更新。

对于带有 Gradle 2.5 的 Android Studio 1.4，可以在 build.gradle 中设置 c99

请注意，BUILD.GRADLE 中的区分大小写的语法已从 cFlags 更改为 CFlags（许多在线示例使用旧语法）。

这是从示例 hello-jni 项目修改的 build.gradle，添加了 C99 支持。

```
apply plugin: 'com.android.model.application'

model {
    android {
        compileSdkVersion = 23
        buildToolsVersion = "23.0.0"

        defaultConfig.with {
            applicationId = "com.example.hellojni"
            minSdkVersion.apiLevel = 4
            targetSdkVersion.apiLevel = 23
        }
    }

    compileOptions.with {
        sourceCompatibility=JavaVersion.VERSION_1_7
        targetCompatibility=JavaVersion.VERSION_1_7
    }

    /*
     * native build settings
     */
    android.ndk {
        moduleName = "hello-jni"
            CFlags += "-std=c99"
    }
    android.buildTypes {
        release {
            minifyEnabled = false
            proguardFiles  += file('proguard-rules.txt')
        }
    }
    android.productFlavors {
        // for detailed abiFilter descriptions, refer to "Supported ABIs" @
        // https://developer.android.com/ndk/guides/abis.html#sa
        create("arm") {
            ndk.abiFilters += "armeabi"
        }
        create("arm7") {
            ndk.abiFilters += "armeabi-v7a"
        }
        create("arm8") {
            ndk.abiFilters += "arm64-v8a"
        }
        create("x86") {
            ndk.abiFilters += "x86"
        }
        create("x86-64") {
            ndk.abiFilters += "x86_64"
        }
        create("mips") {
            ndk.abiFilters += "mips"
        }
        create("mips-64") {
            ndk.abiFilters += "mips64"
        }
        // To include all cpu architectures, leaves abiFilters empty
        create("all")
    }
} 
```

# android-contacts - 通过我面向 Android 2.1+ 的 Android 应用将新联系人添加到通讯录

> ID：13484796
> 
> 赞同：0
> 
> 时间：2012-11-21T00:58:22.093
> 
> 标签：android-contacts, android-2.1-eclair

当我的应用想要将新联系人添加到设备的通讯录中时，我希望弹出一个对话框，询问用户该应用是否可以将“某些联系人”添加到他们的通讯录中，我想要整个过程由操作系统提供便利。也就是说，我不想`permission`在`WRITE_CONTACTS`. 如何请求 Android 尝试将联系人添加到通讯录，而无需将该权限添加到我的清单？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T01:06:27.207

你不能。如果您不添加 WRITE_CONTACTS 权限，您的应用将无法写入联系人。

# perl - 如何将某些匹配字符串之间的所有行打印到perl中的不同文件

> ID：13484802
> 
> 赞同：2
> 
> 时间：2012-11-21T00:59:04.857
> 
> 标签：perl

我对 perl 脚本相当陌生，需要一些帮助。以下是我的查询：

我有一个文件，其内容如下：

```
AA ABC 0 0 
line1
line2
...
AA XYZ 1 1
line..
line..
AA GHI 2 2
line..
line... 
```

现在我想获取那些具有起始字符串/模式的行之间的所有行`"AA"`并将它们写入文件`ABC.txt`，，，，`XYZ.txt`分别`GHI.txt`包括行`AA*`，例如`ABC.txt`应该看起来像

```
AA ABC 0 0
line1
line2... 
```

应该`XYZ.txt`看起来像

```
AA XYZ 1 1
line..
line.. 
```

希望在这个问题上很清楚，对此的任何帮助都非常感谢。

谢谢，桑迪

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T01:08:25.910

我想你是在要求一个算法，因为你没有指定你需要什么帮助。

1.  声明用于输出的文件句柄。
2.  虽然您还没有到达输入文件的末尾，
    1.  读一行。
    2.  如果是标题行，
        1.  解析它。
        2.  确定文件名。
        3.  （重新）打开输出文件。
    3.  将该行打印到输出文件句柄。

* * *

以免您想使用自我发布上述内容以来发布的不良解决方案之一，这是代码：

```
my $fh;
while (<>) {
   if (my ($fn) = /^AA\s+(\S+)/) {
      $fn .= '.txt';
      open($fh, '>', $fn)
         or die("Can't create file \"$fn\": $!\n");
   }

   print $fh $_;
} 
```

可能的改进，所有这些都很容易添加：

*   检查重复的标题。（`if -e $fn`是一种方式）
*   检查第一个标题之前的数据。（`if !$fh`是一种方式）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T01:13:45.763

您只需要一次打开一个文件...当一行匹配`XYZ`时，您打开`XYZ.txt`文件并输出该行。您保持该文件打开（假设它是句柄`CURRENT_FILE`）并将每个连续的行输出到它，直到您匹配一个新的标题行。然后关闭当前文件并打开另一个文件。

我的 Perl 非常生疏，所以我认为我无法提供可编译的代码，但本质上它与此接近。

```
my $current_name = "";

foreach my $line (<INPUT>)
{
    my($name) = $line =~ /^AA (\w+)/;
    if( $name ne $current_name ) {
        close(CURRENT_FILE) if $current_name ne "";
        open(CURRENT_FILE, ">>", "$name.txt") || die "Argh\n";
        $current_name = $name;
    }
    next if $current_name eq "";
    print CURRENT_FILE $line;
}

close(CURRENT_FILE) if $current_name ne ""; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T01:25:34.037

你觉得这个怎么样？

1：从文件中获取内容（可能使用 File::Slurp 的 read_file）并保存到标量。

```
use File::Slurp qw(read_file write_file);
my $contents = read_file($filename); 
```

2：有一个与此类似的正则表达式模式匹配：

```
my @file_rows = ($contents ~= /(AA\s[A-Z]{3}\s+\d+\s+\w*)/); 
```

3：如果第 2 列的值在整个文件中始终是唯一的：

```
foreach my $file_row (@file_rows) {
    my @values = split(' ', $file_row, 3);
    write_file($values[1] . ".txt", $file_row);
} 
```

3：否则：拆分行值。使用第二列作为键将它们存储到散列中。使用哈希将数据写入输出文件。

```
my %hash;
foreach my $file_row (@file_rows) {
    my @values = split(' ', $file_row, 3);
    if (defined $hash{$value[1]}) {
        $hash{$values[1]} .= $file_row;
    } else {
        $hash{$values[1]} = $file_row;
    }
}

foreach my $key (keys %hash) {
    write_file($key .'txt', $hash{$key});
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T01:44:33.480

这是一个查找与每条记录的开头匹配的模式的选项。找到后，它会遍历数据文件的行并构建一条记录，直到再次找到相同的模式或 eof，然后将该记录写入文件。它不会在写入文件之前检查文件是否已经存在，因此如果 ABC.txt 已经存在，它将替换它：

```
use strict;
use warnings;

my $dataFile    = 'data.txt';
my $nextLine    = '';
my $recordRegex = qr/^AA\s+(\S+)\s+\d+\s+\d+/;

open my $inFH, '<', $dataFile or die $!;

RECORD: while ( my $line = <$inFH> ) {
    my $record = $nextLine . $line;

    if ( $record =~ $recordRegex ) {
        my $fileName = $1 . '.txt';

        while ( $nextLine = <$inFH> ) {
            if ( $nextLine =~ $recordRegex or eof $inFH ) {
                $record .= $nextLine if eof $inFH;

                open my $outFH, '>', $fileName or die $!;
                print $outFH $record;
                close $outFH;

                next RECORD;
            }

            $record .= $nextLine;
        }
    }
}

close $inFH; 
```

希望这可以帮助！

**编辑**：此代码替换有问题的原始代码。感谢[amon](https://stackoverflow.com/users/1521179/amon)审查原始代码。

# ruby-on-rails - save_and_open_page 不适用于水豚 2.0？

> ID：13484808
> 
> 赞同：19
> 
> 时间：2012-11-21T00:59:48.937
> 
> 标签：ruby-on-rails, ruby-on-rails-3, capybara

我刚刚将我的水豚更新到 2.0，我所有的 save_and_open_page 调用都返回一个没有样式的 html 页面。它在页面顶部有正确的样式表链接。当我恢复到 capybara 1.3 时，样式再次起作用。任何人都知道如何解决这个问题，和/或问题是什么？

谢谢，戴夫

* * *

更新 1。

黑客：

按照 simonmorley 推荐的链接，我找到了一种解决问题的合理方法：Capybara [Webkit 问题](https://stackoverflow.com/questions/7802614/capybara-webkit-automatically-save-a-screenshot-on-an-rspec-test-failure?rq=1) ，它指向：[capybara-screenshot](https://github.com/mattheworiordan/capybara-screenshot)

它涉及使用 capybara-screenshot gem 来获取页面外观的屏幕截图。当您将它与生成 html 的 save_and_open_page 结合使用时，您可以看到它的样子，并看到 HTML。

```
 save_and_open_page
    Capybara::Screenshot.screenshot_and_open_image 
```

如果我可以开始`Capybara::Screenshot.screenshot_and_save_page`工作，那么我认为我可能有一个解决方案（如果名称暗示了我认为的行动）。但是，当我尝试时，我得到`cannot load such file -- capybara/util/save_and_open_page`

* * *

更新 2。

！！等等，screenshot_and_open_image 现在不工作（没有创建或显示 png 图像）。！！

* * *

更新 3。

**测试应用：**

我创建了一个测试应用程序，并将其发布[在 Github 上的 test_capybara_screenshot 上](https://github.com/tayloredwebsites/test_capybara_screenshot)。

当我在开发中运行这个测试应用程序时，页面会显示出耀眼的红色背景样式。当我运行测试时，唯一对我有用的是 save_and_open_page，除了没有样式。

请注意，当我运行任何测试时，我会收到以下警告：

> 警告：Nokogiri 是针对 LibXML 版本 2.7.8 构建的，但已动态加载 2.7.3

**rspec 测试的详细信息：**

*   save_and_open_page 带有一个无聊的白色背景（没有样式）。
*   screenshot_and_open_image 返回错误：

> Rack::Test capybara 驱动没有输出屏幕截图的能力。跳过。
> 
> 使用选项 {} 打开 /~/Documents/experiments/test_capybara_screenshot/tmp/capybara/screenshot-2012-11-26-07-48-29.png 失败：未找到处理 '/~/Documents/experiments/test_capybara_screenshot 的应用程序/tmp/capybara/screenshot-2012-11-26-07-48-29.png'

*   screenshot_and_save_page 返回：

> 在后挂钩中发生错误
> 
> LoadError: 无法加载此类文件 -- capybara/util/save_and_open_page 发生在 ~/.rvm/gems/ruby-1.9.3-p125@global/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:251:在“要求”中

* * *

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-11-21T01:27:36.713

尝试将以下内容添加到您的 gem 文件中

```
group :test do
  gem "capybara"
  gem "launchy"
end 
```

没有这个我不相信 save_and_open_page 将无法工作。

- 更新 -

我已经为你测试过了，当我使用保存和打开方法时，我得到了同样的错误。在我的设置中，这是因为我的页面正在引用：

```
<link href="/assets/application.css" media="screen" rel="stylesheet" type="text/css" /> 
```

这发生在 Firefox、Chrome 和 Safari 中。据检查员称，没有找到任何文件。

我没有对此进行过详细的研究，也没有答案为什么它不起作用。然而，也有很多人在为此苦苦挣扎：

[https://github.com/jnicklas/capybara/issues/485](https://github.com/jnicklas/capybara/issues/485)

并且，关于 capybara 和资产预编译的更多信息：

[https://github.com/jnicklas/capybara/pull/609](https://github.com/jnicklas/capybara/pull/609)

这里可能有什么解决方法：

[https://groups.google.com/forum/#!msg/ruby-capybara/SBCor8UUj7w/hv97EgUQ1P4J](https://groups.google.com/forum/#!msg/ruby-capybara/SBCor8UUj7w/hv97EgUQ1P4J)

但是，如果您只想查看您的页面，您可以尝试以下操作：删除 scrap save_and_open_page 并将您的测试更改为使用 javascript。这样，我的页面可以正常打开。

```
 require 'spec_helper'

 describe "Foo" do
   it "should fail if Bar is lactose intolerant", :js => true do
     # .....
   end
 end 
```

试试看，如果有帮助，请告诉我。

* * *

响应（来自 Taylored 网站）：

我看到页面几秒钟，然后它就消失了。有没有办法让浏览器窗口不关闭？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-27T23:23:05.743

经过一些博客浏览和挖掘后，我能够解决 save_and_open_page 的问题。我已经从我的项目中删除了 capybara_screenshot gem。[你可以在我的github test_capybara_screenshot repository](https://github.com/tayloredwebsites/test_capybara_screenshot)上看到我的工作代码。我想出的解决方案使用了我在[capybara github 站点](https://github.com/jnicklas/capybara/pull/500)上找到的一些指针。

假设：

*   您正在使用 rspec 进行测试。
*   您的应用已配置为使用资产管道。

我要做的第一件事是设置它，以便将资产预编译到测试目录中。我通过将以下代码添加到循环`spec/spec_helper.rb`内的文件中来做到这一点：`RSpec.configure`

```
config.before (scope = :suite) do
  %x[bundle exec rake assets:precompile]
end 
```

我指定了资产在文件中的预编译位置`config/environments/test.rb`：

```
config.assets.prefix = "assets_test"    # place test assets in public/assets_test directory
config.action_controller.asset_host = "file://#{::Rails.root}/public" 
```

这使得测试资产独立于开发资产，并且仅在测试套件运行期间生成。

如果你这样做，你可能想让 git 忽略`/public/assets*`目录。

# java - 为什么我的代码只输出字符串是平衡的

> ID：13484810
> 
> 赞同：0
> 
> 时间：2012-11-21T01:00:06.397
> 
> 标签：java

我需要下面的代码来拥有一个 BalancedString 的默认构造函数，它将 str 初始化为空字符串并将计数器重置为 0 该类的一个争论构造函数将字符串 s 传递给 str 并将计数器重置为零。BalancedString 类还提供了一个布尔方法，它是 boolean balance()，如果字符串包含平衡数量的括号，则返回 true

```
import java.util.*;
public class BalancedString {
    private static String str;

    public BalancedString()
    {
        str = "";

    }

    public BalancedString(String s)
    {
        s = "";
        str = s;

}

public boolean balanced(){

    return true;

}
public static void main(String[] args) {
    int n = 0;
    CounterFancy.setCounter(n);
    Scanner input = new Scanner(System.in);
    System.out.println("Enter a string that has any number of Left and right Parenthesis");
    String s = input.next();

        if (s.indexOf('(') != -1)

            CounterFancy.incCounter();

        if (s.indexOf(')') != -1)

            CounterFancy.decCounter();

    int counterValue = CounterFancy.getCounter();
    if (counterValue == 0)
        System.out.println("The string is Balanced");
    else 
        System.out.println("The string is NOT Balanced");
    input.close();
}

public String getStr()
{
    return str;
}
public String setStr(String s)
{
    str = s;
    return str;
} 
```

}

以下是我从中获得 CounterFancy 类的另一个项目，但问题在上面^^ 为什么这只是输出它是平衡的

```
//Joe D'Angelo
//CSC 131-03
//Chapter 10 Programming Assignment 5a.
//Takes the user's input of whether they want the counter to be negative or positive and outputs
//10 values of the user's selected input, then restarts the counter at 0
import java.util.*;
public class CounterFancy { //I messed up the first time and had to change FancyCounter to CounterFancy that is why this is changed

    private static int counter;

    public CounterFancy()
    {
        counter = 0;        
    }

    public  CounterFancy(int n){
        counter = n;
    }

    public static int incCounter() //inc stands for increment
    {
            counter++;
        return counter;
    }
    public static int decCounter() //dec stands for decrement
    {
        counter--;
        return counter;
    }

    public static void main(String[] args){
        Scanner input = new Scanner(System.in);
        System.out.println("Press 1 for Possitive or Press 2 for Negative");
        int reply = input.nextInt();

        if (reply == 1)
        {
        for (int i = 1; i <=10; i ++)
        System.out.println("counter: " + CounterFancy.incCounter());
        CounterFancy.setCounter(5);
        System.out.println("Counter: " + CounterFancy.getCounter());

        }

        if (reply == 2)
        {
            for (int i = 1; i <=10; i ++)
                System.out.println("counter: " + CounterFancy.decCounter());
            CounterFancy.setCounter(5);
            System.out.println("Counter: " + CounterFancy.getCounter());

        }
        input.close();
        }

    public static int getCounter()
    {
        return counter;
    }

    public static void setCounter(int n)
    {
        counter = 0;
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T01:03:32.727

这段代码存在逻辑问题：

```
String s = input.next();

if (s.indexOf('(') != -1)
    CounterFancy.incCounter();

if (s.indexOf(')') != -1)
    CounterFancy.decCounter();

int counterValue = CounterFancy.getCounter();
if (counterValue == 0)
    System.out.println("The string is Balanced");
else 
    System.out.println("The string is NOT Balanced"); 
```

您只搜索字符串一次 a`(`和一次 a `)`。如果字符串以任意顺序同时包含 a`(`和 a `)`，则计数器将始终计数 1，然后计数 0，并认为括号是平衡的。

您需要将计数放入循环中以检查括号是否平衡。您应该遍历每个字符并检查每个步骤的计数。如果每一步的计数都是非负数并且以 0 结束，则括号是平衡的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T01:05:40.027

您在`BalancedString`类定义中犯了几个错误。首先，该`str`字段不应该是`static`. 通过制作它`static`，所有实例共享相同的`str`字段。

其次，也许更关键的是，你没有`BalancedString`正确构建你的。您每次都将参数设置回空字符串！

```
public BalancedString(String s) {
        s = ""; // THIS LINE SHOULD NOT BE HERE!
        str = s;
} 
```

最后，无论字符串如何，您的`balanced()`方法都会简单地返回。`true`你需要在这里实现一些逻辑。

关于主程序：您需要遍历所有字符，每个字符递增，*每个**字符* `'('`递减。而不是这个： *`')'`*

 *```
if (s.indexOf('(') != -1)

        CounterFancy.incCounter();

if (s.indexOf(')') != -1)

    CounterFancy.decCounter(); 
```

你应该有一个这样的循环：

```
for (int i = 0; i < s.length(); ++i) {
    char c = s.charAt(i);
    if (c == '(')
        CounterFancy.incCounter();
    else if (c == ')')
        CounterFancy.decCounter();
} 
```*

# python - Python元组超出范围

> ID：13484814
> 
> 赞同：1
> 
> 时间：2012-11-21T01:00:21.543
> 
> 标签：python, tuples

我不断收到错误 IndexError: tuple out of range 我希望你们能帮助我完成我的程序

```
MIN_ROW = 0
MAX_ROW = 3
MIN_COLUMN = 0
MAX_COLUMN = 19 
```

问题似乎在第 7 行仍然存在

```
def display(theMap):
r = 0
c = 0
print("PLAYER MAP")
for r in range (0, (MAX_ROW + 1), 1):
    for c in range (0, (MAX_COLUMN + 1), 1):
        print(theMap[r][c])   #this line
    print()
print()

def loadMap():
theMap = []
for r in range(0,(MAX_ROW+1), 1):
    theMap.append([])
    for c in range(0,(MAX_COLUMN+1), 1):
        theMap[r].append(" ")
#           0    1    2    3    4    5    6    7    8    9   10   11    12   13   14   15   16    17   18   19 
map  [0] =   "0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "A", "B", "C", "D", "E", "F", "G", "H", "I", "J"
map  [1] =   "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-"
map  [2] =   "|r|","| |", "| |", "| |", "| |", "| |", "| |", "| |", "| |", "| |", "|" 
map  [3] =   "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-"
return theMap 
```

所以我不确定我的元组是如何超出范围的，但希望你们能指出并帮助我

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T01:33:09.050

使用显式循环编写内容通常会导致难以调试的问题。这就是为什么 Python 不强迫你这样做，实际上鼓励你不要：

```
def display(theMap):
    print("PLAYER MAP")
    for row in theMap:
        for col in row:
            print(col)
        print()
    print() 
```

这仍然不是您真正想要的，因为会`print(col)`打印一个换行符。您不希望每个单元格单独一行，您希望单元格之间有空格，并且每一行单独一行。要做到这一点，你必须`print(col, end=' ')`改为。

或者，更简单地说：

```
def display(theMap):
    print("PLAYER MAP")
    for row in theMap:
        print(' '.join(row))
    print() 
```

或者，更简洁——但可能不那么简单：

```
def display(theMap):
    print("PLAYER MAP")
    print('\n'.join(' '.join(row) for row in theMap))
    print() 
```

您可以类似地改进 theMap，只需一次创建 theMap，而不是创建空行，然后替换它们。例如：

```
def loadMap():
    return [
        ("0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "A", "B", "C", "D", "E", "F", "G", "H", "I", "J"),
        ("-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-"),
        ("|r|","| |", "| |", "| |", "| |", "| |", "| |", "| |", "| |", "| |", "|"),
        ("-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-")] 
```

一般来说，每当你发现自己`for i in range(something)`在用 Python 编写代码时，你都在做一些不必要的事情，最终你只是要调试。

现在，您可以争辩说这种风格不会“捕捉错误”。但是使用显式循环执行的操作只能捕获少数错误，并且以一种很难调试的方式捕获它们。如果你知道你的先决条件，你通常可以更简单、更清楚地写出来：

```
theMap = loadMap()
assert(all(len(row) == len(theMap[0]) for row in theMap)) 
```

此外，如果您知道测试用例的输出应该是什么，您可以编写单元测试来验证输出。

无论如何，即使解决了所有这些问题，您仍然会遇到一些问题。例如，除了第 2 行比其他行短几列之外，该行中的各个列是其他行中的列的 3 倍，因此它根本不会对齐。但是一旦你让它运行起来，调试可视化的东西应该会更容易。

退后一步，您显然将通过第 2 行推进“r”。事实上，您可能需要表示地图的只是宽度和当前位置：

```
def display(mapWidth, playerPosition):
    print('PLAYER MAP')
    # Display the first line. This is the header, with a label for each of the
    # mapWidth columsn, with a space between each label, and an extra space at
    # the start, like ' 0 1 2 3 4'. The ' '.join(s) creates a new string by 
    # putting a space between each element of s. The '012...XYZ'[:mapWidth] 
    # just takes the first mapWidth characters of the longer string. 
    print(' ' + ' '.join('0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'[:mapWidth]))

    # Display the second line. This is just a '-' for each column, with a space
    # between each, and an extra space at the start, like ' - - - - -'. The join
    # works the same as above; the '-' * mapWidth creates a string with mapWidth
    # copies of '-'.
    print(' ' + ' '.join('-' * mapWidth))

    # Display the third line. This is the trickiest. This is cell for each column,
    # where the first playerPosition cells are '| |', the playerPositionth is 
    # '|r|', and the rest are again '| |', with no space between them. It seemed
    # simpler to treat this as a group of playerPosition+1 '|' characters with 
    # spaces between, an 'r' character, and a group of mapWidth-playerPosition
    # '|' characters with spaces between again, but there are various different 
    # ways of printing something equivalent. The only new thing here is the 
    # end='' keyword argument--without that, each print ends with a newline.
    print(' '.join('|' * (playerPosition + 1)), end='')
    print('r', end='')
    print(' '.join('|' * (mapWidth - playerPosition)))

    # Fourth line, same as the second.
    print(' ' + ' '.join('-' * mapWidth))
    print() 
```

您可能会发现这更容易阅读，具体取决于您对`join`方法、`print`函数等的熟悉程度：

```
def display(mapWidth, playerPosition):
    print('PLAYER MAP')
    print(' ' + ' '.join('0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'[:mapWidth]))
    print(' -' * mapWidth)
    print(' '.join('|' * (playerPosition + 1)) +
          'r' +
          ' '.join('|' * (mapWidth - playerPosition)))
    print(' -' * mapWidth)
    print() 
```

值得思考为什么，例如，`' ' + ' '.join('-' * 8)`与`' -' * 8`.

完成棘手的第三行的另一种方法是：

```
 # Print mapWidth '|' characters, each followed by a ' ', except for the one
   # at the player position, which is followed by an 'r'. Then we still need one
   # more '|' at the end.
   print(''.join('|' + (' ' if i != playerPosition else 'r') 
                 for i in range(mapWidth) + '|') 
```

我认为这是用英语解释的最简单的方法，但是将其翻译成 Python 需要生成器表达式和三元 if 表达式，这两者你可能还不想学习——最终结果甚至是 Python 的经验开发人员可能不想阅读。

当然，如果有疑问，您可以随时将内容提取到单独的行，甚至单独的函数中，以使它们更具可读性：

```
 cellsBeforePlayer = '| ' * playerPosition
    cellsWithPlayer = cellsBeforePlayer + '|r|'
    cellsToEnd = cellsWithPlayer + '| ' * (mapWidth - playerPosition)
    print(cellsToEnd) 
```

无论如何，这些都做同样的事情：

```
>>> display(MAX_COLUMN - MIN_COLUMN + 1, 3)
PLAYER MAP
 0 1 2 3 4 5 6 7 8 9 A B C D E F G H I J
 - - - - - - - - - - - - - - - - - - - -
| | | |r| | | | | | | | | | | | | | | | |
 - - - - - - - - - - - - - - - - - - - - 
```

除非这些`MIN_COLUMN`和`MAX_COLUMN`值是要求的一部分，否则我会使用单个`COLUMNS=20`变量来代替 - 再次，它避免了另一个常见的一对一错误（`+ 1`在函数调用中，在需要时很容易忘记包含，或者不需要时添加不正确）。

或者，如果地图宽度是固定的，那就更简单了：

```
def display(playerPosition):
    print('PLAYER MAP')
    print(' ' + ' '.join('0123456789ABCDEFGHIJ'))
    print(' -' * 20)
    print(' '.join('|' * (playerPosition + 1)) +
          'r' +
          ' '.join('|' * (20 - playerPosition)))
    print(' -' * 20)
    print() 
```

无论如何，这样做的好处不仅仅是简单`display`而且根本不需要`loadMap`移动玩家，而不是这样：

```
theMap[2][playerPosition] = '| |'
playerPosition += stepsMoved
theMap[2][playerPosition] = '|r|'
display(theMap) 
```

你只需这样做：

```
playerPosition += stepsMoved
display(playerPosition) 
```

你的整个游戏状态从一个复杂的列表列表减少到一个整数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T01:03:53.813

`map[2]`似乎与其他行的格式不同。这意味着它没有 20 个元素可以迭代。这将导致您看到的错误。

此外，`map()`它是一个内置函数，因此您可能需要选择不同的名称以避免混淆。

在这种情况下，您应该避免使用索引迭代地图，并且无论如何都要迭代元组

```
def display(the_map):
    print("PLAYER MAP")
    for row in the_map:
        for cell in row:
            print(cell)
        print()
    print() 
```

也许

```
def display(the_map):
    print("PLAYER MAP")
    for row in the_map:
        print(''.join(row))
    print() 
```

编辑：现在有更多信息，这是实现地图的更简单非常明确的方法

```
def display(the_map):
    print(the_map[0].replace("", " "))
    print(the_map[1].replace("", " "))
    print(the_map[2].replace("", "|"))
    print(the_map[3].replace("", " "))

the_map = ["0123456789ABCDEFGHIJ",
           "--------------------",
           "r                   ",
           "--------------------"]
display(the_map) 
```

# css - 为什么直接使用样式表 @fontface 不能正确呈现 Google Web 字体？

> ID：13484815
> 
> 赞同：5
> 
> 时间：2012-11-21T01:00:23.913
> 
> 标签：css, fonts, font-face, google-webfonts

我最近一直在努力实现流畅的 Google Web 字体，主要是在 Windows Google Chrome 上。

我之前一直在使用直接样式表代码，从 Google Web Fonts 提供的 URL 中提取，例如，Google 提供：

```
<link href='http://fonts.googleapis.com/css?family=Titillium+Web:200' rel='stylesheet' type='text/css'> 
```

所以我转到 URL 并使用以下代码

```
@font-face {
   font-family: 'Titillium Web';
   font-style: normal;
   font-weight: 200;
   src: local('Titillium WebThin'), local('TitilliumWeb-Thin'), url(http://themes.googleusercontent.com/static/fonts/titilliumweb/v1/anMUvcNT0H1YN4FII8wpr-K9kSItTeDn2USN0q77Oh4.woff) format('woff');
} 
```

我认为这是一种节省更多速度的厚颜无耻的方法，而不是向 Google 发出请求，然后 Google 似乎又发出了另一个请求来获取字体。

我最近发现这是呈现问题的原因（请参阅以下示例，了解 Windows Chrome 浏览器如何在 Web 字体页面上呈现，与我使用该过程创建的测试页面相比：http: [//imgur.com/OV2U1 ,ema2B](https://imgur.com/OV2U1,ema2B) )

我的问题是，当 <link /> 版本使用我的速记方法采购相同的字体时，为什么它会使字体平滑？而且，我有什么理由应该使用这种方法，我认为这会缩短请求时间？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-06T18:18:03.060

有几个问题可以回答你的问题。主要的一个是链接的 URL 实际上为不同的浏览器显示不同的 CSS。因此，如果您在 Chrome 中打开它并复制该 CSS，那么它可能无法在 Internet Explorer 中运行（尤其是 9 之前的版本）。

此外，您使用的字体粗细为 200，这是一个“轻”粗细。常规文本的默认值为 400。因此，除非您指定字体粗细为 200，否则某些浏览器根本不显示字体的可能性很小。这样的事情应该会有所帮助：

```
body {
    font-family: "Titillium Web", sans-serif;
    font-weight: 200;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T17:44:15.753

将此添加到您的 CSS 文件中：

```
@import url('http://fonts.googleapis.com/css?family=Titillium+Web:200'); 
```

# php - 而是通过 URL 或 POST 变量传递值？

> ID：13484816
> 
> 赞同：0
> 
> 时间：2012-11-21T01:00:50.410
> 
> 标签：php, session, post

我正在实现一个消息系统（私人消息，如果你愿意的话），我希望能够通过文本链接显示用户拥有的消息列表，所以我不需要按钮来打开它。message_id（数据库中的唯一值）将通过 URL 传递。（类似于 www.example.com/message/view/16）。假设我检查以确保用户 ID 的会话与发送消息的用户 ID 匹配，这样可以吗？为了更安全，我可以附加一个随机数并将其设置为会话，然后在查看时检查它。

我应该忘记这个想法并坚持使用提交按钮来查看消息吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T01:02:43.493

POST 请求不会比 GET 请求提供更多安全性：任何半体面的 Web 调试工具都可以伪造 POST 请求。你永远不应该相信用户输入的数据。始终仔细检查授权以确保安全！

也就是说，[`GET`请求语义与您在此处尝试执行的操作相匹配](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)。

HTTP 标准说`GET`请求应该是可重复的，没有任何不重要的后果。例如，使用 GET 请求*查看*数据就足够了（并且可能做一些小事情，比如增加一个计数器，因为这些都是非常微不足道的后果）。事实上，`GET`和`HEAD`是被认为是“安全”的两种请求方法。

另一方面，`POST`请求预计会产生重要的后果，例如发送消息或下订单。您不想意外执行两次的东西。如今，大多数浏览器也尊重这一点，在重新加载页面时警告用户会导致`POST`再次执行请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T01:04:12.420

使用 GET 值查看消息是更好的主意，因为假设用户保持登录状态，这将允许他们为消息添加书签等。

# php - 如何从 php 中具有重复节点名称的 xml 字符串中获取值并显示它？

> ID：13484817
> 
> 赞同：0
> 
> 时间：2012-11-21T01:00:52.213
> 
> 标签：php, xml, arrays

我有一个看起来像这样的 xml 字符串，

```
 <xml>
   <type>name</type>
     <name>
        <namedata>abc</namedata>
        <namedata>efg</namedata>
        <namedata>ijk</namedata>
     </name>
 <xml> 
```

*要求：* 我需要将 xml 解析为 php 并将其显示在一个表格中，这样它就会像这样显示

```
 type   namedata   namedata   namedata
   name      abc        efg        ijk 
```

我尝试使用 foreach 执行此操作，但只能获得 namedata 的第一个值。这是我到目前为止所做的：

```
 $xml = simplexml_load_string($response);
  echo '<table>';
  echo '<tr><td>type'</td></tr>'.$xml->type.'</td><tr>';
  foreach($xml->name as $row){
     echo'<td>'.$row->namedata.'</td>';
    }
   echo'</tr></table>'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T01:08:56.913

因为有多个 namdata 节点，您可以将它们作为数组加载，如下所示：

```
foreach($xml->name->namedata as $row){
    echo'<td>'.$row.'</td>';
} 
```

至于这个“要求”。我发现的最简单的方法是：

```
$xml = simplexml_load_string($response);
echo '<table border="1">';
echo '<tr><td>type</td>';
for($x=0;$x<count($xml->name->namedata);$x++){
    echo '<td>namedata</td>';
}
echo '</tr><tr><td>'.$xml->type.'</td>';
foreach($xml->name->namedata as $row){
    echo'<td>'.$row.'</td>';
}
echo'</tr></table>'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T01:17:50.303

尝试使用这个：

```
$xml = simplexml_load_file($response);
echo '<table>';
echo '<tr><td>type</td></tr>'.$xml->type.'</td></tr>';
  foreach($xml->name->namedata as $row){
     echo '<td>'.$row.'</td>';
  }
  echo '</tr></table>'; 
```

# windows - windows 7复制快捷方式指向的文件

> ID：13484822
> 
> 赞同：1
> 
> 时间：2012-11-21T01:01:24.683
> 
> 标签：windows, powershell

我有一堆文件的快捷方式，这些文件位于硬盘驱动器的各个位置。物理文件需要备份。关于如何编写脚本的任何想法？

谢谢，斯科特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T07:08:15.603

```
$files = gci ~\Desktop\*.lnk | %{$sh = New-Object -COM WScript.Shell}{$sh.CreateShortcut($_.fullname).Targetpath} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T01:05:50.400

我唯一能想到的就是在备份目录时读取目录中的文件类型。如果它是一个“.lnk”，你就知道它是一个快捷方式。此时使用类似于本文的内容：

[http://social.technet.microsoft.com/Forums/nl/winserverpowershell/thread/0293e186-2a21-4677-b1a5-f4e501570a98](http://social.technet.microsoft.com/Forums/nl/winserverpowershell/thread/0293e186-2a21-4677-b1a5-f4e501570a98)

将目标路径返回给变量，然后将该变量作为文件处理并复制实际文件。

我希望这是有道理的。我有使用 PowerShell 的经验，但不是这种情况。但是，这是我将采取的方法。

# javascript - 上传的文件位于（保存）在 node js 中的 jquery file-upload-plugin 中的位置

> ID：13484823
> 
> 赞同：1
> 
> 时间：2012-11-21T01:01:28.687
> 
> 标签：javascript

上传的文件位于（保存）在 node js 中的 jquery file-upload-plugin 中的什么位置？您还可以使用 jquery file-upload-plugin 上传和保存视频文件吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T01:09:11.233

**访问上传​​的文件**

如果您使用的是 Node 和 Express 的最新版本，那么文件上传就是小菜一碟。我会支持这一说法，但在我们进一步讨论之前，请确保您熟悉 Express 中的路由、请求和响应。

好的，现在让我们证明“小菜一碟”的说法。在我们的文件上传路由中， req 参数有 req.files 可用。这是 req.files 将包含的内容的示例：

```
{
  displayImage: {
    size: 11885,
    path: '/tmp/1574bb60b4f7e0211fd9ab48f932f3ab',
    name: 'avatar.png',
    type: 'image/png',
    lastModifiedDate: Sun, 05 Feb 2012 05:31:09 GMT,
    _writeStream: {
      path: '/tmp/1574bb60b4f7e0211fd9ab48f932f3ab',
      fd: 14,
      writable: false,
      flags: 'w',
      encoding: 'binary',
      mode: 438,
      bytesWritten: 11885,
      busy: false,
      _queue: [],
      drainable: true
    },
    length: [Getter],
    filename: [Getter],
    mime: [Getter]
  }
} 
```

在上面的 req.files 对象中，属性 displayImage 是 HTML 表单中文件字段的名称，并且 req.files 将为每个有效的 HTML 文件表单字段包含一个属性。

文件对象包含服务器端验证的类型、大小和名称属性。

**保存上传的文件**

假设文件是​​有效的，您可以使用 path 属性进行下一步。该路径通常包含 tmp 文件夹中的位置。您的应用程序逻辑可能要求您访问文件的内容，或者只是将上传的文件移动到另一个位置。

```
fs.readFile(req.files.displayImage.path, function (err, data) {
  // ...
  var newPath = __dirname + "/uploads/uploadedFileName";
  fs.writeFile(newPath, data, function (err) {
    res.redirect("back");
  });
}); 
```

在 fs.readFile 回调中，我们有 data 参数，通过它我们可以访问文件的内容。上面的示例取自需要修改文件并将其保存在新位置的应用程序。因此 fs.writeFile 用于将数据写入 newPath。

如果您的应用程序需要简单地移动上传的文件而不修改内容 fs.rename 可以用作更简单的选项。

# shell - 查找并删除主文件夹中的所有符号链接，使其无法正常工作

> ID：13484825
> 
> 赞同：4
> 
> 时间：2012-11-21T01:01:56.953
> 
> 标签：shell, zsh

我有以下内容：

```
read -p 'Delete old symlinks? y/n: ' prompt

if [ $prompt == [yY] ]
then    
    current_dir=$(pwd)
    script_dir=$(dirname $0)

    if [ $script_dir = '.' ]
    then
        script_dir="$current_dir"
    fi

    for sym in {find $PATH -type l -xtype d -lname "~"}
    do
        rm $sym
        echo "Removed: $sym"
    done
fi 
```

我想要达到的目标如下：

*   如果提示等于 y（是）然后：找到`~`（主目录）中的所有符号链接并对它们执行 for 循环，这将删除它们并输出它删除的那个。

虽然现在它不执行删除部分，但其余部分工作正常。我没有包括有效的部分，它只是一堆`ln -s`.

我在 Mac OS X Mountain Lion (10.8.2) 中，使用 Zsh 作为 shell，这在一个`.sh`文件中。

我遇到的问题是什么都没有发生，所以它只是说：

```
ln: /Users/eduan/.vim/vim: File exists
ln: /Users/eduan/.vimrc: File exists
ln: /Users/eduan/.gvimrc: File exists
Done... 
```

等等

非常感谢您提供的任何帮助！

**编辑：**
我现在有以下内容：

```
read -p 'Delete old symlinks? y/n: ' prompt

if [ $prompt == [yY] ]
then    
   find ~ -type l | while read line
   do
      rm -v "$line"
   done
fi 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-21T01:07:58.040

```
find /path -type l | xargs rm 
```

第一部分列出了符号链接。`Xargs`说对于每个返回的值发出一个`rm`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T01:10:27.373

这个怎么样？

```
find ~ -type l | while read line
do
   rm -v "$line"
done 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-25T03:31:19.647

我能够解决问题，结果是 if 条件不起作用。无论如何，感谢您的帮助！:)

# asp.net-web-api - 在运行时禁用 ApiController

> ID：13484826
> 
> 赞同：9
> 
> 时间：2012-11-21T01:02:00.640
> 
> 标签：asp.net-web-api

我有一个 ASP.NET Web API (.NET 4) 应用程序，它有几个控制器。我们将在 IIS 上运行几个 Web API 应用程序实例，但有一点不同。在某些 IIS 实例下，只有某些控制器可用。我在想的是在实例启动时禁用/卸载不适用于实例的控制器。

任何人都可以获得一些可以指导我正确方向的信息吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T10:25:07.820

您可以通过装饰 DefaultHttpControllerActivator 来放入您自己的自定义`IHttpControllerActivator`。在里面只检查一个设置，如果允许，只创建控制器。

当您从 Create 方法返回 null 时，用户将收到 404 Not Found 消息。

我的示例显示了正在检查应用程序设置（App.Config 或 Web.Config）中的值，但显然这可能是任何其他环境感知条件。

```
public class YourCustomControllerActivator : IHttpControllerActivator
{
    private readonly IHttpControllerActivator _default = new DefaultHttpControllerActivator();

    public YourCustomControllerActivator()
    {

    }

    public IHttpController Create(HttpRequestMessage request, HttpControllerDescriptor controllerDescriptor,
                                  Type controllerType)
    {
        if (ConfigurationManager.AppSettings["MySetting"] == "Off")
        {
            //Or get clever and look for attributes on the controller in controllerDescriptor.GetCustomAttributes<>(); 
            //Or use the contoller name controllerDescriptor.ControllerName
            //This example uses the type
            if (controllerType == typeof (MyController) ||
                controllerType == typeof (EtcController))
            {
                return null;
            }
        }
        return _default.Create(request, controllerDescriptor, controllerType);

    }
} 
```

您可以像这样切换激活器：

```
GlobalConfiguration.Configuration.Services.Replace(typeof(IHttpControllerActivator), new YourCustomControllerActivator()); 
```

**更新**

自从我查看这个问题以来已经有一段时间了，但是如果我今天要解决它，我会稍微改变方法并使用 custom [`IHttpControllerSelector`](http://msdn.microsoft.com/en-us/library/system.web.http.dispatcher.ihttpcontrollerselector%28v=vs.108%29.aspx)。这在激活器之前调用，并为启用和禁用控制器提供了一个更有效的位置......（尽管其他方法确实有效）。您应该能够装饰或继承自`DefaultHttpControllerSelector`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T01:19:48.490

我认为我不会卸载控制器，而是创建一个自定义 Authorize 属性，该属性在决定授予授权时查看实例信息。

您可以将以下内容添加到类级别的每个控制器中，或者您也可以将其添加到各个控制器操作中：

```
[ControllerAuthorize (AuthorizedUserSources = new[] { "IISInstance1","IISInstance2","..." })] 
```

这是属性的代码：

```
public class ControllerAuthorize : AuthorizeAttribute
{
    public ControllerAuthorize()
    {
        UnauthorizedAccessMessage = "You do not have the required access to view this content.";
    }

    //Property to allow array instead of single string.
    private string[] _authorizedSources;

    public string UnauthorizedAccessMessage { get; set; }

    public string[] AuthorizedSources
    {
        get { return _authorizedSources ?? new string[0]; }
        set { _authorizedSources = value; }
    }

    // return true if the IIS instance ID matches any of the AllowedSources.
    protected override bool AuthorizeCore(HttpContextBase httpContext)
    {
        if (httpContext == null)
            throw new ArgumentNullException("httpContext");

        //If no sources are supplied then return true, assuming none means any.
        if (!AuthorizedSources.Any())
            return true;

        return AuthorizedSources.Any(ut => ut == httpContext.ApplicationInstance.Request.ServerVariables["INSTANCE_ID"]);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-11T08:50:15.640

如果您想打开/关闭控制器并具有默认的捕获所有路由控制器，则该`IHttpControllerActivator`实现不会禁用使用属性 routing 定义的路由。关闭 using`IHttpControllerActivator`会禁用控制器，但是当请求路由时，它不会命中所有路由控制器 - 它只是尝试命中已删除的控制器并返回未注册的控制器。

# ajax - nvd3.js 图表 ajax 数据重绘 - 缺少悬停效果 + 以前的 yAxis 比例

> ID：13484832
> 
> 赞同：8
> 
> 时间：2012-11-21T01:02:48.750
> 
> 标签：ajax, hover, d3.js, redraw, nvd3.js

我正在使用 nvd3 绘制一个简单的折线图，其中数据通过 ajax 请求接收。它与第一个绘图请求完美配合，但不适用于重绘。图表通过调用相同的绘图函数但使用不同的数据 + 不同的最大/最小值来重绘。

使用新数据重新绘制图表时，不会出现“悬停圆圈”，而工具提示会出现。此外，当单击图表的图例并通过再次出现悬停来强制重绘时，但 yAxis 的值将更改为第一个绘制的图表的值。

到目前为止，我假设重绘图表时仍然保留旧的最大/最小值 - 但仅涉及“悬停”效果。到目前为止，一般图表在重绘时看起来也很好 - 问题只是面临悬停，就是这样。

听起来很混乱，但希望你能明白这一点。

一些代码：

```
 d3.json(queryurl, function(data2){
  nv.addGraph(function(jsonData) {
    if(chart){
       chart.remove();
    }
    chart = nv.models.lineChart()
                .x(function(d) { return d[0] })
                .y(function(d) { return d[1] })
                .color(d3.scale.category10().range());

    chart.xAxis
        .tickFormat(function(d) {
            return d3.time.format('%x')(new Date(d)) 
        });

    chart.yAxis
        .scale()
        .tickFormat(d3.format(''));

    chart.lines.yDomain([maxmin.max,maxmin.min]);

    d3.select('#chart1 #chartsvg')
      .datum(data2)
      .transition().duration(600)
      .call(chart);

    nv.utils.windowResize(chart.update);

});

});
  return chart;} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-26T20:59:04.370

在重绘之前尝试`.empty()`在 svg 元素上使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-26T22:32:21.823

我自己才刚刚开始使用 NVD3 和 D3，但是我正在做类似的事情。对我有用的是将数据更新功能与图表创建功能分开。请注意下面的警告...

我有以下创建图表：

```
initGraph = function(url) {
  d3.json(url, function(data) {
    nv.addGraph(function() {
      chart = nv.models.multiBarChart();

      d3.select('#chart svg').datum(data).transition().duration(500).call(chart);
      nv.utils.windowResize(chart.update);

      return chart;
    });
  });
}; 
```

以及更新它的以下功能：

```
redrawGraph = function(url) {
  d3.json(url, function(data) {

    d3.select('#chart svg').datum(data).transition().duration(500).call(chart);
    nv.utils.windowResize(chart.update);
  });
}; 
```

我不知道这是否是推荐的解决方案，因为我仍处于“破解直到它起作用”阶段。有了这个，图表的所有功能在调用`redrawGraph()`（包括轴重绘和工具提示）后工作。

**警告**：这似乎偶尔会导致重新计算时错误计算的刻度：![假蜱](../Images/d670c446f23e020f2e4c3db70918529a.png)

# android - 从 com.example 更改 Eclipse Android 项目的默认包

> ID：13484833
> 
> 赞同：14
> 
> 时间：2012-11-21T01:02:48.883
> 
> 标签：android, eclipse, package, default

我正在使用带有 Android SDK 的 Eclipse 4.2。

我想知道是否可以`com.example`在键入应用程序名称时更改“新 Android 应用程序”向导中显示的默认包 ID？

我希望它默认为我自己的包 ID，这样我就不需要每次都更正包名称字段。

这可能吗？请解释如何。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-05T21:43:17.307

不，您不能更改默认值；它在插件源中被硬编码。

（出于好奇，它位于 ADT 代码库中的 com.android.ide.eclipse.adt.internal.wizards.templates.NewProjectPage#SAMPLE_PACKAGE_PREFIX 中）。我们应该考虑保留最近设置的包前缀，并在下次插入父包。随意在[http://b.android.com](http://b.android.com)类别组件工具中提出问题。

-- 托尔

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-02-09T00:15:24.737

在 Android Studio 未运行的情况下，编辑文件：C:\Users\MyAccount\.AndroidStudio\config\options\options.xml（将 C: 替换为安装驱动器，将 MyAccount 替换为您的帐户名）。

在 xml 文件中查找“property name="SAVED_COMPANY_DOMAIN" value=" 并将值更改为您想要的值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-10-24T17:56:01.977

我不确定为什么这么多人对错误的文件位置有正确的答案...

我已经使用所有默认设置安装了 android studio 2020.3，并且文件`others.xml`在文件夹中

```
C:\Users\MYUSER\AppData\Roaming\Google\AndroidStudio2020.3\options 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-03-29T20:40:57.277

按照 user2232952 的指导，为新版本的 Android Studio 更改以下值：

```
<property name = "SAVED_ANDROID_PACKAGE" value = "com.example" /> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-12-03T17:06:23.577

对于 2020 年来到这里的任何人，您要查找的文件是 other.xml 它可以在您的 AndroidStudio 库中的 config/options/other.xml 下找到（对于 mac，这可能是 ~/Library/Application Support/Google/AndroidStudio4\. 1/选项）

然后您可以按照@Murillo Comino 的说明进行操作

`<property name = "SAVED_ANDROID_PACKAGE" value = "com.example" />`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-21T01:53:50.400

如果您已经创建了项目，则可以转到 AndroidManifest.xml 文件并更新 Manifest (root) 标记中的属性

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="your.package.name"
    android:versionCode="1"
    android:versionName="1.0" > 
```

只需确保您的其余代码也反映了此更改。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-06-01T19:21:26.687

单击包名称并按 Alt+Shift+R 并重命名，它将更新所有内容！

# sql - 在 postgres 中选择时间戳记录

> ID：13484835
> 
> 赞同：0
> 
> 时间：2012-11-21T01:03:04.550
> 
> 标签：sql, postgresql, timezone, timestamp

如何在 Postgres 中选择小时值大于 00:00:00 的记录？字段类型是带时区的时间戳。

示例记录：

“2012-07-30 07:00:00-07”

我需要大于 00:00:00 的所有内容

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T01:16:22.757

使用`extract(hour from ...)`. 请参阅[用户手册中的 PostgreSQL 日期/时间函数](http://www.postgresql.org/docs/current/static/functions-datetime.html)。

```
CREATE TABLE test AS SELECT TIMESTAMP WITH TIME ZONE '2012-07-30 07:00:00-07' AS tstamp;

SELECT tstamp FROM test WHERE extract(hour from tstamp) > 0; 
```

# sql - SQL 使用变量引用外键

> ID：13484841
> 
> 赞同：1
> 
> 时间：2012-11-21T01:03:39.190
> 
> 标签：sql, sql-server, variables

我必须在循环中检查几个外键，并且需要用变量（例如@fk​​_field）替换外键字段的名称。

我的查询如下所示：

```
 SELECT 
        ad.id 
        , ad.@fk_field
        , a1.@jnktn_field
    FROM @tblname tbl LEFT JOIN @jnktn_tbl jnktn ON tbl.@fk_field=jnktn.@jnktn_field
    WHERE ad.FK1 <> isnull(a1.ID,0) 
```

显然不可能像我一样在某个点之后直接使用变量，但我需要这样做才能引用正确的表格。那么，如何使用变量来插入在 SQL 查询之前设置的字段名呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T01:15:39.933

根据您使用该查询的位置和方式，您可以使用

**SQLCMD 变量**

```
:setvar FKFIELD field_name

SELECT 
    ad.id 
    , ad.@fk_field
    , a1.@jnktn_field
FROM @tblname tbl LEFT JOIN @jnktn_tbl jnktn ON tbl.$(FKFIELD)=jnktn.field
WHERE ad.FK1 <> isnull(a1.ID,0) 
```

**执行语句**

```
EXEC('SELECT 
    ad.id 
    , ad.@fk_field
    , a1.@jnktn_field
FROM @tblname tbl LEFT JOIN @jnktn_tbl jnktn ON tbl.' + @fk_field +'=jnktn.field
WHERE ad.FK1 <> isnull(a1.ID,0)') 
```

**多个 JOIN 子句**

```
SELECT 
    ad.id 
    , ad.field
    , a1.field
FROM @tblname tbl 
LEFT JOIN @jnktn_tbl jnktn ON tbl.Field1=jnktn.field and @fk_field = 'fieldName1'
LEFT JOIN @jnktn_tbl jnktn ON tbl.Field2=jnktn.field and @fk_field = 'fieldName2'
LEFT JOIN @jnktn_tbl jnktn ON tbl.Field3=jnktn.field and @fk_field = 'fieldName3'
WHERE ad.FK1 <> isnull(a1.ID,0) 
```

更新：最后一个示例需要一些努力才能正确查询，并且根据您的确切要求可能根本不起作用。这个想法是连接到所有引用的表，并将这些表中的所有字段设置为`NULL`除了在变量中指定键的表。

# android - 带有Progressdialog的android AsyncTask错误

> ID：13484842
> 
> 赞同：0
> 
> 时间：2012-11-21T01:03:51.983
> 
> 标签：android, android-asynctask, progressdialog

我的进度对话框有问题，我找不到我做错了什么。当我按下 Localize 按钮时，我的代码会启动新的 AsyncTask 和 progressDialog，但最终它会自行停止并显示错误。我认为问题在于它必须做的事情太长了。错误是这样的：

执行 doInBackground() 时发生错误

我认为问题出在 publishProgress() 但我不知道如何以及在哪里使用它。

这是我的代码：

```
public class GPSLocation extends AsyncTask<Void, Void, Void>
{  
    boolean running =true;
    @Override
    protected void onPreExecute()
    {  
        super.onPreExecute(); 
        pd = new ProgressDialog(Configuracion.this);
        pd.setOnCancelListener(new DialogInterface.OnCancelListener(){
            public void onCancel(DialogInterface dialog) {
                pd.cancel();  
            }
        });
        longitude=0;
        latitude =0;
        getLonLat();
        pd.setCancelable(true);
        pd.setMessage("Getting GPS Location...");
        pd.setProgressStyle(ProgressDialog.STYLE_SPINNER);
        pd.show();
    } 

    @Override 
    protected void onProgressUpdate(Void... values) {
        super.onProgressUpdate(values);
        pd.setProgress(1);
        // Things to be done while execution of long running operation is in progress. For example updating ProgessDialog
    }

    @Override 
    protected void onPostExecute(Void result)
    {  
        pd.dismiss(); 
    }

    @Override
    protected Void doInBackground(Void... params) {  
        boolean isDataSubmitted = false;
        while(!isDataSubmitted)
        {  
            if(longitude !=0 && latitude!=0)
            { 
                isDataSubmitted = true;
                Log.d("LONGITUD", ""+longitude);
                Log.d("LATITUDE", ""+latitude);
                longitud.setText(String.valueOf(longitude));
                latitud.setText(String.valueOf(latitude));
            }  
        } 

        return null;    
    } 
} 
```

这是在 GPSLocation 类之外，从 Localize.setOnclicklistener(this) 调用；

```
 @Override
    public void onClick(View v){

        if (v.getId() == R.id.localiza){

            new GPSLocation().execute();
             }
         } 
```

这个方法在这里：

```
 public void getLonLat(){

        LocationManager milocManager = (LocationManager)getSystemService(Context.LOCATION_SERVICE);
        LocationListener milocListener = new MiLocationListener();
        if (milocManager.isProviderEnabled(LocationManager.GPS_PROVIDER)) {
            milocManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0,milocListener);

        }else if (milocManager.isProviderEnabled(LocationManager.NETWORK_PROVIDER)) {
            milocManager.requestLocationUpdates(
            LocationManager.NETWORK_PROVIDER, 0, 0, milocListener);
        }

    } 
```

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T02:55:25.673

不要`.setText()`在 doInBackground() 中使用该方法。这将导致错误。相反，您可以在 settext`onPostExecute()`

将您的代码更改为

```
@Override 
protected void onPostExecute(Void result)
{  
    pd.dismiss(); 
    longitud.setText(String.valueOf(longitude));
    latitud.setText(String.valueOf(latitude));
}

@Override
protected Void doInBackground(Void... params) {  
    boolean isDataSubmitted = false;
    while(!isDataSubmitted)
    {  
        if(longitude !=0 && latitude!=0)
        { 
            isDataSubmitted = true;
            Log.d("LONGITUD", ""+longitude);
            Log.d("LATITUDE", ""+latitude);
        }  
    } 
    return null;    
} 
```

# amazon-sqs - 使用 Amazon SQS 实现“仅一次交付”行为的最佳实践是什么？

> ID：13484845
> 
> 赞同：25
> 
> 时间：2012-11-21T01:04:01.607
> 
> 标签：amazon-sqs

根据[文档](http://aws.amazon.com/sqs/faqs/#How_does_Amazon_SQS_allow_multiple_readers_to_access_the_same_message_queue_without_losing_messages_or_processing_them_many_times)：

> 问：每条消息我会收到多少次？
> 
> Amazon SQS 旨在提供其队列中所有消息的**“至少一次”传输**。尽管大多数情况下每条消息将只传递给您的应用程序一次，但您应该设计您的系统，以便多次处理消息不会产生任何错误或不一致。

有没有什么好的做法可以实现一次性交付？

我正在考虑使用 DynamoDB [“条件写入”</a> 作为分布式锁定机制，但是......有更好的主意吗？](http://docs.amazonwebservices.com/amazondynamodb/latest/developerguide/WorkingWithDDItems.html)

 [* * *

对此主题的一些参考：](http://docs.amazonwebservices.com/amazondynamodb/latest/developerguide/WorkingWithDDItems.html) 

[](http://docs.amazonwebservices.com/amazondynamodb/latest/developerguide/WorkingWithDDItems.html)
*   [至少一次交付（服务行为）](http://cloudcomputingpatterns.org/?page_id=204)
*   [一次性交付（服务行为）](http://cloudcomputingpatterns.org/?page_id=199)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2016-12-16T02:20:33.003

FIFO 队列现在可用并提供有序的，开箱即用。

[https://aws.amazon.com/sqs/faqs/#fifo-queues](https://aws.amazon.com/sqs/faqs/#fifo-queues)

检查您所在地区的可用性。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-21T09:25:50.950

最佳解决方案实际上取决于您不多次执行消息中建议的操作的重要性。对于某些操作，例如删除文件或调整图像大小，它是否发生两次并不重要，所以什么都不做也没关系。当第二次不做这项工作更为关键时，我为每条消息（由发送者生成）使用一个标识符，接收者通过标记在 memchachd 中看到的 id 来跟踪 dups。对很多事情都很好，但如果生活或金钱依赖于它，可能就不行了，尤其是在有多个消费者的情况下。

条件写入听起来像是一个聪明的解决方案，但它让我想知道如果您需要一个防弹的完全一次性解决方案，AWS 是否不是解决您的问题的一个很好的解决方案。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-08-15T00:02:59.610

分布式锁定的另一个替代方案是 Redis 集群，它也可以使用 AWS ElasticCache 进行预置。Redis 支持保证并发调用按顺序执行的[事务。](http://redis.io/topics/transactions)

使用缓存的优点之一是您可以设置过期超时，因此如果您的消息处理失败，锁将得到定时释放。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-09-24T18:46:41.897

在这篇博文中，还建议使用像 Amazon DynamoDB 这样的低延迟控制数据库： [https ://aws.amazon.com/blogs/compute/new-for-aws-lambda-sqs-fifo-as-an-事件源/](https://aws.amazon.com/blogs/compute/new-for-aws-lambda-sqs-fifo-as-an-event-source/)

> Amazon SQS FIFO 队列确保处理顺序遵循消息组内的消息顺序。但是，它不保证在用作 Lambda 触发器时只交付一次。如果只有一次交付在您的无服务器应用程序中很重要，则建议使您的函数具有幂等性。您可以通过使用可扩展的低延迟控制数据库（如 Amazon DynamoDB）跟踪消息的独特属性来实现这一点。

简而言之 - 我们可以使用条件表达式*属性*_not_exists （用于放置）或*if_not_exists （用于更新）**将*项目或*更新*项目放入*dynamodb*表中，请在此处查看示例 [https://stackoverflow.com/a/55110463/9783262](https://stackoverflow.com/a/55110463/9783262)

 ***如果我们在put/update*操作期间遇到异常，我们必须从 lambda 返回而不进行进一步处理，如果没有得到它，则处理消息（[https://aws.amazon.com/premiumsupport/knowledge-center/lambda-function -幂等/](https://aws.amazon.com/premiumsupport/knowledge-center/lambda-function-idempotent/) )

以下资源对我也有帮助：

[https://ably.com/blog/sqs-fifo-queues-message-ordering-and-exactly-once-processing-guaranteed](https://ably.com/blog/sqs-fifo-queues-message-ordering-and-exactly-once-processing-guaranteed)

[https://aws.amazon.com/blogs/aws/introducing-amazon-sns-fifo-first-in-first-out-pub-sub-messaging/](https://aws.amazon.com/blogs/aws/introducing-amazon-sns-fifo-first-in-first-out-pub-sub-messaging/)

[https://youtu.be/8zysQqxgj0I](https://youtu.be/8zysQqxgj0I)**

# c# - 是否可以从 List 访问结构的引用 做出改变？

> ID：13484849
> 
> 赞同：1
> 
> 时间：2012-11-21T01:04:32.650
> 
> 标签：c#, list, struct, immutability, mutable

我有一个放入 a 的结构`List<T>`，我想在该结构中的特定位置编辑一些值。如果不复制结构、编辑副本和替换列表中的条目，这是否可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T01:08:25.140

不，要做到这一点，您需要引用`List`/未提供的内部数组元素`IList`。

如果必须，您可以使用不安全的代码和数组来做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T01:20:46.907

来自 J.Richter 的“CLR via C#”，第 3 版：

> 值类型应该是不可变的：也就是说，它们不应该定义任何修改任何类型的实例字段的成员。事实上，我建议将值类型的字段标记为只读，以便在您不小心编写尝试修改字段的方法时编译器会发出错误。

...

> 请记住，值类型和引用类型具有非常不同的行为，具体取决于它们的使用方式。

* * *

考虑这段代码：

```
public interface IChangeStruct
{
    int Value { get; }
    void Change(int value);
}

public struct MyStruct : IChangeStruct
{
    int value;

    public MyStruct(int _value)
    {
        value = _value;
    }

    public int Value
    {
        get
        {
            return value;
        }
    }

    public void Change(int value)
    {
        this.value = value;
    }
} 
```

它的用法：

```
static void Main(string[] args)
{
    MyStruct[] l = new MyStruct[]
        {
            new MyStruct(0)
        };
    Console.WriteLine(l[0].Value);
    l[0].Change(10);
    Console.WriteLine(l[0].Value);

    Console.ReadLine();
} 
```

输出是：

> 0 10

所以它可以满足您的需求。

但是，这同样不适用于`List<T>`. 我猜是Alexei Levenkov提到的原因。因此，我强烈建议您更改`struct`为`class`如果所讨论的类型不是每个实例不可变的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T18:40:12.157

您最好的选择可能是让您的结构直接公开其字段，然后使用如下代码：

```
  var temp = myList[3];
  温度.X += 4;
  我的列表 [3] = 温度；

```

我认为 .net 未能提供任何更新列表项的方法是 .net 的一个重大弱点，但在希望表示不应“附加”到任何其他此类组的一小组正交值（例如点中的坐标，矩形的原点和大小等）。结构应该是“不可变”的概念已被重复为咒语很长一段时间，但这并不意味着它是好的建议。这样的概念主要源于两件事：

1.  在其构造函数之外的任何成员中修改 `this` 的结构是古怪的。这种怪癖过去（并且在某种程度上仍然如此）适用于属性设置器，但不适用于直接公开其字段的结构。因为微软将所有结构字段都包装在属性中，这意味着虽然可变结构如果暴露了字段就可以具有合理的语义，但它们最终会产生古怪的语义。微软随后将古怪的语义归咎于结构是可变的这一事实，而不是不必要地用属性包装字段。
2.  有些人喜欢将 .net 建模为只有一种对象，而不是将值类型和引用类型作为不同类型的实体。所谓的“不可变”值类型的行为与引用类型的行为非常接近，以至于它们可以假装它们是同一事物，而易于可变的值类型的行为则大不相同。实际上，理解暴露字段值类型的行为比理解所谓的“不可变”值类型与引用类型行为不同的所有极端情况更容易，如果不理解前者，就不可能理解后者。请注意，虽然值类型可能假装是不可变的，但实际上不存在不可变值类型这样的东西。

实际上，如果一个类型应该代表一小组正交值，那么暴露字段结构是完美的选择。即使必须使用上面显示的笨重代码来更新 a 中项目的字段`List<structType>`，它也比使用类类型或所谓的“不可变”结构的任何替代方法要好。知道这`myList`是一个带有暴露字段的结构`X`就足以完全理解上面的代码。如果使用类或“不可变”结构，唯一的远程选择是`myList[3] = myList[3].WithX(myList[3].X + 4);`，但这需要相关类型提供`WithX`方法（并且可能是`WithWhatever()`每个字段的方法）。这样的方法将增加许多倍的代码量，人们必须阅读以确定一个方法实际上会做什么（人们可能*期望*这`WithX`将返回一个与旧实例相同的新实例，除了 的值`X`，但是在阅读所有涉及的代码之前，人们不会知道；相比之下，知道这`X`是结构类型的公开字段就足以*知道*上面的代码会做什么。

# css - 我如何在 css 定位和浮动方面变得更好？

> ID：13484851
> 
> 赞同：-6
> 
> 时间：2012-11-21T01:05:18.850
> 
> 标签：css

我知道这个问题很笼统，但我正试图在布局和浮动方面变得更好，这是 css 的定位部分。有没有我应该看的好资源或你们推荐的方法让我变得更好？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T01:07:40.707

*   w3schools.com
*   [http://www.barelyfitz.com/screencast/html-training/css/positioning/](http://www.barelyfitz.com/screencast/html-training/css/positioning/)
*   [http://css-tricks.com/all-about-floats/](http://css-tricks.com/all-about-floats/)
*   [http://spyrestudios.com/css-in-depth-floats-positions/](http://spyrestudios.com/css-in-depth-floats-positions/)
*   [http://kilianvalkhof.com/2008/css-xhtml/absolute-positioning-vs-floats/](http://kilianvalkhof.com/2008/css-xhtml/absolute-positioning-vs-floats/)

真的，只是练习，乱来，最终你会得到它。

或者，如果您有更具体的问题，我很乐意看看能否回答。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T01:09:41.443

Code Academy在他们的 HTML/CSS 课程中有一个[专门讨论这个的部分。](http://www.codecademy.com/courses/web-beginner-en-6merh)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T01:09:47.170

[http://www.jsfiddle.net](http://www.jsfiddle.net)

尝试随机的东西，看看有什么用。

这就是我们大多数人的学习方式。

# php - Magento“静态块”包装器

> ID：13484857
> 
> 赞同：0
> 
> 时间：2012-11-21T01:05:55.240
> 
> 标签：php, magento

我发誓我已经看了几十个问题......也许我只是失去了它。

我想修改静态块“包装器”-phtml 文件中 Magento 中具有“块”类的 div。是否有某种静态块控制器，或者它们都是完全独立构建的？如果是这样，我在哪里可以找到一个例子？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T01:32:27.860

类似`block block-list block-compare`或`block block-cart`都将成为单独的 PHTML 文件的项目。由于我看不到您的确切安装，因此启用模板路径提示的那些块将使您获得所需的 phtml 文件。如果您在启用路径提示方面需要帮助，请查看此处[启用路径提示](http://www.redlightblinking.com/blog/magento-tutorials/magento-debugging-how-to-debug-template-paths-logging-and-display-errors)，这将使您入门，然后您将在正确的“区域”中进行所需的更改。

# java - EntityManager 删除同步期间发现的对象后

> ID：13484859
> 
> 赞同：2
> 
> 时间：2012-11-21T01:05:58.530
> 
> 标签：java, jpa, cascade, entitymanager, toplink

我正在尝试使用应用程序管理的 EntityManager 删除与另一个实体具有一对多关系的实体。该对象似乎被删除得很好，但是当另一个事务被打开然后提交时，我得到以下错误。

```
Exception in thread "AWT-EventQueue-0" javax.persistence.RollbackException: java.lang.IllegalStateException: During synchronization a new object was found through a relationship that was not marked cascade PERSIST: RemovedParentObject[id=1]. 
```

我的实体具有以下关系注释。

在父类中

```
@OneToMany(cascade = CascadeType.ALL, mappedBy = "parentId")
private List<Child> childCollection; 
```

在儿童班

```
@JoinColumn(name = "PARENT_ID", referencedColumnName = "ID", nullable = false)
@ManyToOne(optional = false)
private Parents parentId; 
```

我的删除代码是，

```
 // start database transaction window
 EntityManager.getTransaction().begin();

    // remove all children
    for (Child child: parent.getChildCollection())
    {
        EntityManager.remove(child);
    }

    parent.getChildCollection().clear();

    // remove parent
    EntityManager.remove(parent);

// commit chages to the database
EntityManager.getTransaction().commit(); 
```

我尝试在一个事务中仅删除子级，提交它，打开另一个事务并删除父级，然后提交。没有变化，出现错误。

我也试过不删除孩子，只删除父母，因为它有一个 cascade.ALL 注释。没有变化，出现错误。

我试过在移除后让所有的父母和孩子都焕然一新。刷新的列表没有显示删除的父级，但是当我下次调用 commit 时会发生错误。

调用此代码时管理父级和每个子级。我假设删除过程不正确，这就是为什么在执行未来提交时会找到删除的对象。

我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:58:54.987

确保没有其他现有对象引用您删除的对象。确保您没有合并引用已删除对象的对象。您确定错误是在抱怨已删除的对象吗？

您是创建一个新的 EntityManager 还是使用现有的？如果你创建一个新的，它会起作用吗？如果您只是开始并提交下一个事务而不做任何事情，它会起作用吗？

您可以尝试禁用共享缓存，看看是否会影响它。

还要检查提交是否成功，并且不会引发错误。

也尝试使用最新版本。

# c++ - 分割后如何创建掩码来选择分割的类？

> ID：13484864
> 
> 赞同：1
> 
> 时间：2012-11-21T01:06:18.637
> 
> 标签：c++, opencv

我有一个 CV_32SC1 型垫子，我们称之为`segm`. `segm`调用分水岭函数后存储类信息。假设它的可能值为 -1（类边界）、1、2。

现在，如何为标有“2”的像素制作蒙版？那就是我需要一个垫子，如果`segm`是 2，则为 1，否则为 0。

我可以通过编写一个循环来做这个掩码，但我认为必须有一些 OpenCV 库函数可以做到这一点，我只是找不到它。有人知道这里的正确方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T01:48:45.370

最后，我找到了它：

```
class_label = 2;
inRange(segm, class_label, class_label, mask_single); 
```

# java - 是否可以将文件传递给 Android 中的 AsyncTask？

> ID：13484865
> 
> 赞同：1
> 
> 时间：2012-11-21T01:06:24.540
> 
> 标签：java, android, android-asynctask

是否可以将文件传递给 AsyncTask？像这样？

```
public class UploadImagesTask extends AsyncTask<String, String, File> {
    @Override
    protected File doInBackground(String... params) { 
```

我会通过这样做访问该文件吗？

```
params[2] 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T01:12:08.253

不是那样的，不。

如果你想传入 a`String`和 a `File`，你需要做这样的事情，并相信自己不会搞砸争论。

```
public class DoThing extends AsyncTask<Object, String, File> {
    @Override
    protected File doInBackground(Object... params) {
        String stringy = (String) params[0];
        File file = (File) params[1];
        // do hard work
        return file;
    }
} 
```

由于你所有的参数都 extend `Object`，当你调用这个东西时，它看起来像这样：

```
String aString = stringGettingMethod();
File aFile = fileGettingMethod();
new DoThing().execute(aString, aFile); 
```

或者，您可以通过构造函数参数传递您想要的任何内容。

# java - AppEngine 中的 crossdomain.xml

> ID：13484867
> 
> 赞同：0
> 
> 时间：2012-11-21T01:06:30.180
> 
> 标签：java, google-app-engine

我`/crossdomain.xml`在 appengine 的管理控制台的仪表板上收到了 URI 错误通知。

*   如何修复错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T15:57:36.943

来自[Adob​​e 的网站](http://www.adobe.com/devnet/articles/crossdomain_policy_file_spec.html)：

> 跨域策略文件是一种 XML 文档，它授予 Web 客户端（例如 Adob​​e Flash Player、Adobe Reader 等）跨多个域处理数据的权限。当客户端托管来自特定源域的内容并且该内容向其自身以外的域发出请求时，远程域将需要托管一个跨域策略文件，该文件授予对源域的访问权限，从而允许客户端继续与交易。策略文件授予对数据的读取访问权限，允许客户端在跨域请求中包含自定义标头，并且还与套接字一起使用以授予基于套接字的连接的权限。

`crossdomain.xml`是此类跨域策略文件的示例。

在您的网站上下文中，有人（可能是您，也可能是其他人）试图从 Adob​​e 应用程序中访问您网站的内容。该应用程序试图成为一个好公民，在执行操作之前检查是否存在跨域策略文件。由于您尚未提供，因此您`404`的日志中会出现一个。

最简单的解决方法是编写一个`crossdomain.xml`文件，然后从您的 App Engine 应用程序中提供它。正在寻找它的 Adob​​e 应用程序现在将获得一个文件而不是一个文件，`404`并且该错误将不再出现在您的日志中。

或者，您可以忽略该错误。与丢失`robots.txt`文件一样，这些`404`错误不会对您的网站造成损害，它们只是偶尔会在您的日志中填充您不关心的错误。

# java - 为什么我的程序没有打开我的 .dat 文件？

> ID：13484875
> 
> 赞同：0
> 
> 时间：2012-11-21T01:07:45.587
> 
> 标签：java, io, binary

嗨，我的 java 程序应该读入并显示用户在提示时输入的 .txt 文件，将文件中的整数转换为输出 .dat 文件，然后读入该 .dat 文件并再次显示数字。当我运行我的程序时，它会显示文件的内容，并创建 .dat 文件，但不会再次读取它。我的代码如下。我需要做什么？

```
public class InputFile
{
    public static void main(String [] args)
    {
        BufferedReader inputStream = null;

            System.out.print("Enter file name (with .txt extension): ");
            Scanner keys = new Scanner(System.in);
            String inFileName = keys.next();

            try
            {
                inputStream = new BufferedReader (new FileReader(inFileName));
                System.out.println("The file " + inFileName + " contains the following lines:");
                String inFileString = inputStream.readLine();
                while(inFileString != null)
                {
                    System.out.println(inFileString);
                    inFileString = inputStream.readLine();
                }
                inputStream.close();
            }
            catch(FileNotFoundException e)
            {
                System.out.println(inFileName + " not found! Try Again.");
            }
            catch(IOException e)
            {
                System.out.println(e.getMessage());
            }

            String fileName = "numbers.dat";
            try
            {
                ObjectOutputStream outputStream = new ObjectOutputStream(new FileOutputStream(fileName));
                int anInt = 0;
                while(anInt >=0);
                {
                    anInt = Integer.parseInt(inputStream.readLine());
                    outputStream.writeInt(anInt);
                }
                outputStream.close();
            }
            catch(FileNotFoundException e)
            {
                System.out.println("Problem opening file.");
            }
            catch(IOException e)
            {
                System.out.println("Problem with output to the file.");
            }

            try
            {
                ObjectInputStream inputStream2 = new ObjectInputStream(new FileInputStream(fileName));
                System.out.println("The file being read yields:");
                int anInteger = inputStream2.readInt();
                while(anInteger >= 0)
                    {
                        System.out.println(anInteger);
                        anInteger = inputStream2.readInt();
                    }
                inputStream2.close();
            }
            catch(FileNotFoundException e)
            {
                System.out.println("Problem with opening the file.");
            }
            catch(EOFException e)
            {
                System.out.println("Problem reading the file.");
            }
            catch(IOException e)
            {
                System.out.println("There was a problem reading the file.");
            }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T01:24:10.733

有一个错误类型（或者至少我认为这是一个错误类型）很难发现，这使得你的第二个循环无限。

```
 (...)
 try
        {
            ObjectOutputStream outputStream = new ObjectOutputStream(new FileOutputStream(fileName));
            int anInt = 0;
            while(anInt >=0);  <=====
            {
                anInt = Integer.parseInt(inputStream.readLine());
                outputStream.writeInt(anInt);
            }
            outputStream.close();
        } 
```

删除这个';' 过了一会儿，我想它会正常运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T01:21:40.123

您没有写入输出流，因为到那时 inputStream 已用尽并关闭。

创建一个集合来存储第一个文件中的元素。

```
String inFileName = keys.next();
Collection<String> lines = new ArrayList<String>();
...
System.out.println(inFileString);
lines.add(inFileString);

...
for(String line : lines){
...
    outputStream.write(Integer.parseInt(line));
...
} 
```

# c# - 以 C# 形式动态添加 WindowsMediaPlayer

> ID：13484884
> 
> 赞同：1
> 
> 时间：2012-11-21T01:09:02.193
> 
> 标签：c#, media, windows-media-player

我正在从事一个项目，该项目致力于以表格形式检索/显示不同类型的媒体。基本上，用户使用 OpenFileDialog 选择图像、视频、音频或 txt 文件，然后程序会将它们存储在 List 中。（我为每种类型的媒体创建了自定义类，它们都从一个接口实现。）

表单需要保存这些文件的“预览”，这些文件可以通过下一步/后退按钮进行分页。但是，由于表单不知道它将是什么类型的媒体，所以我在表单上放置了一个面板，然后将该面板的引用发送给我的 IMedia.DisplayMedia 方法，每个类负责绘制自己的面板中的代表。（例如 PictureBox 或 RichTextField。）

对于文本和图像，我在代码中创建了控件，然后使用以下方法添加它们：

```
 myPanel.Controls.Add(myControl); 
```

但是，我不能对 Windows 执行此操作，因为 WMPLib.WindowsMediaPlayer 不会从控件继承。

任何想法如何实现这一目标？我没有嫁给 WMP，我只需要能够播放大多数标准视频/音频格式的东西。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T01:27:57.300

您实际上可以将 WindowMediaPlayer 作为控件添加到表单中：

[以编程方式创建 Windows Media Player 控件](http://msdn.microsoft.com/en-us/library/windows/desktop/dd562692%28v=vs.85%29.aspx)

简而言之，有一个围绕它的 ActiveX 控件，以便能够将其添加到表单中。

# javascript - 如何防止 iframe 捕获页面的背景颜色？

> ID：13484888
> 
> 赞同：1
> 
> 时间：2012-11-21T01:09:19.610
> 
> 标签：javascript, html, iframe, embed

我在这里的方法可能错了，但我创建了一个 HTML5/Javascript 容器，它使用 javascript 来发光文本并使用倒计时。然而，我能够实现我在​​遇到很大困难后寻求的 iframe 结果，但唯一的是，如果你愿意的话，我拥有小部件的页面的背景颜色是红色的，所以现在无论 iframe 被嵌入到哪里，它都会移动围绕小部件并显示背景颜色。

我想将颜色更改为白色，但定位仍然存在问题，所以我想知道页面上是否需要修复某些内容，或者如何确保仅嵌入页面中我想要的部分？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T01:50:44.397

没有更多信息，这是一个很长的镜头，但尝试放一个`background-color:transparent`; 在有问题的小部件上，或者根本不使用背景颜色，这样就不会溢出您想要的空间。

# javascript - 是否有任何理由在构造函数中手动“返回”？

> ID：13484895
> 
> 赞同：3
> 
> 时间：2012-11-21T01:10:17.520
> 
> 标签：javascript, oop, compiler-construction, return, new-operator

通常，在构造函数中，绑定到函数内的对象在使用前缀`this`调用时由它返回。`new`但我想也有可能（我想我什至在 crockford 的书中读过这个）手动返回你自己的值。有没有这样的做法有用的地方？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T01:13:28.557

如果你想实现一个单例模式，这可以被使用，通过确保在第一次构造对象之后你永远不会构造另一个对象 - 而是返回第一个构造的对象。

IE

```
if(!TheClass.singleton) TheClass.singleton = this;
return TheClass.singleton 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T01:28:06.773

如果您从构造函数返回值类型，您将获得不同的行为，具体取决于是否`new`使用。就是这样`String`工作的。在你的 JavaScript 控制台中查看这个对象：

```
{
    s: String("abc"),
    S: new String("abc")
} 
```

Little`s`包含一个字符串值，但 big`S`包含一个字符串 Object。一个微妙的区别，也许。

您可以超越这一点，将相同的功能用于不同的目的：

```
function Foo() {
    return "abc";
}
Foo.prototype.DoSomething = function () {
    // something completely unrelated to "abc"
};
var a = Foo();      // The string "abc".  Does not have a DoSomething() method.
var b = new Foo();  // An Object with a DoSomething() method.  Doesn't know about "abc". 
```

根据是否`new`使用过，你会得到完全不同的东西。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-21T01:27:42.623

构造函数（即用 调用的函数`new`）总是返回一个对象，这是`this`默认值。`new`在某些情况下，您可能会在不使用 say的情况下防止调用：

```
function Foo(arg) {
  if ( !(this instanceof Foo) ) {
    return new Foo(arg);
  }
  this.blah = arg;
} 
```

因此，您向函数返回了一个不同的对象`this`，但它仍然返回自身的一个实例。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-21T01:20:37.930

是的，这样想。

```
item = function(id){
  if(alreadytaken(id)){
    return cache[id];
  }else{
    cache[id] = this;
  }
}

var newitem = new item(1);
var newitem2 = new item(1); 
```

此示例检查 ID 以查看它是否已存在。如果是这样，那么它将强制返回已经存在的对象，这是我过去实际使用过的东西。

# arrays - 使用 schema.CreateTable 生成 SQL 字符串失败并出现 postgresql ARRAY

> ID：13484900
> 
> 赞同：1
> 
> 时间：2012-11-21T01:10:57.363
> 
> 标签：arrays, postgresql, sqlalchemy, postgis

我想从包含 postgresql ARRAY 的 sqlalchemy 类生成逐字 CREATE TABLE .sql 字符串。

在没有 ARRAY 列的情况下，以下工作正常：

```
from sqlalchemy.dialects.postgresql import ARRAY
from sqlalchemy import *
from geoalchemy import *
from sqlalchemy.ext.declarative import declarative_base

metadata=MetaData(schema='refineries')

Base=declarative_base(metadata)

class woodUsers (Base):
    __tablename__='gquery_wood'
    id=Column('id', Integer, primary_key=True)
    name=Column('name', String)
    addr=Column('address', String)
    jsn=Column('json', String)
    geom=GeometryColumn('geom', Point(2)) 
```

这个炒锅就像我想要的那样：

```
In [1]: from sqlalchemy.schema import CreateTable
In [3]: tab=woodUsers()

In [4]: str(CreateTable(tab.metadata.tables['gquery_wood']))
Out[4]: '\nCREATE TABLE gquery_wood (\n\tid INTEGER NOT NULL, \n\tname VARCHAR,      \n\taddress VARCHAR, \n\tjson VARCHAR, \n\tgeom POINT, \n\tPRIMARY KEY (id)\n)\n\n' 
```

但是，当我在其中添加一个 postgresql ARRAY 列时失败：

```
class woodUsers (Base):
    __tablename__='gquery_wood'
    id=Column('id', Integer, primary_key=True)
    name=Column('name', String)
    addr=Column('address', String)
    types=Column('type', ARRAY(String))
    jsn=Column('json', String)
    geom=GeometryColumn('geom', Point(2)) 
```

与上述相同的命令会产生一个以以下结尾的长回溯字符串：

```
/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/visitors.pyc in _compiler_dispatch(self, visitor, **kw)
     70             getter = operator.attrgetter("visit_%s" % visit_name)
     71             def _compiler_dispatch(self, visitor, **kw):
---> 72                 return getter(visitor)(self, **kw)
     73         else:
     74             # The optimization opportunity is lost for this case because the

AttributeError: 'GenericTypeCompiler' object has no attribute 'visit_ARRAY' 
```

如果完整的回溯有用，请告诉我，我会发布。

我认为这与为编译器（？）指定方言有关，但我不确定。我真的很希望能够生成 sql 而无需创建引擎。不过，我不确定这是否可能，在此先感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T13:43:23.483

可能有一个复杂的解决方案涉及挖掘 sqlalchemy.dialects。不过，您应该首先尝试使用引擎。填写一个虚假的连接 url，不要调用 connect()。

# c# - 如何清除 IQueryable 结果集上的默认选择子句

> ID：13484901
> 
> 赞同：2
> 
> 时间：2012-11-21T01:11:01.100
> 
> 标签：c#, linq

如果我有一个返回 IQueryable 结果集的页面类，例如：

```
protected virtual IQueryable<EntityResult> GetEntities(ETBDataContext pContext)
    {
        return from e in pContext.Entities
               where e.SectionId == SectionId && e.StatusCode == "Published"
               orderby e.PublishDate descending
               select new EntityResult
               {
                   EntityId = e.Id,
                   Excerpt = e.Excerpt,
                   Name = e.Name,
                   PublishDate = e.PublishDate,
                   ShortDescription = e.ShortDescription
               };
    } 
```

如果我在继承的类中调用此方法，如何清除选择并获取 ShortDescription？

```
public void IQueryable<EntityResult> GetResult(ETBDataContext pContext)
{
    IQueryable<EntityResult> pQuery = base.GetEntities(pContext);

    //right here: how can I just return the ShortDescription Only?

    return pQuery;
} 
```

我正在使用默认的 GetEntities() 来执行默认查询的标准选择操作，但在某些调用中，我只想获取我需要的特定数据。

这可能吗？还有其他方法吗？提前致谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T01:12:18.853

你可以试试

```
pQuery = pQuery.Select(e => new EntityResult { 
    ShortDescription = e.ShortDescription 
}); 
```

我很确定这不会选择其他列。

# image-processing - 前端帖子表单设置缩略图或给我 ID，我都需要

> ID：13484903
> 
> 赞同：1
> 
> 时间：2012-11-21T01:11:26.233
> 
> 标签：image-processing, wordpress, frontend, attachment

我有一个为我的网站制作的 WP 前端发布表单，我的想法是让艺术家可以发布他们自己的混音带提交！

到目前为止，我已经设法让表单使用上传的图片作为特色图片，或者给我图片 ID，这样我就可以把它放在帖子内容中，问题是我两者都需要！我需要将图像自动设置为帖子的缩略图，并且我需要 ID，以便我可以将表单设置为自动将图像放在帖子中我想要的位置！

到目前为止，我已经将问题定位为这段代码：

```
 if ($_FILES) {
foreach ($_FILES as $file => $array) {
$newupload = insert_attachment($file,$pid);
// $newupload returns the attachment id
}
} 
```

我这样说，这段代码的位置决定了我是否成功获取附件的 ID 或图像是否设置为缩略图。

整个代码如下：

```
 function insert_attachment($file_handler,$post_id,$setthumb='false') {
// check to make sure its a successful upload
if ($_FILES[$file_handler]['error'] !== UPLOAD_ERR_OK) __return_false();

require_once(ABSPATH . "wp-admin" . '/includes/image.php');
require_once(ABSPATH . "wp-admin" . '/includes/file.php');
require_once(ABSPATH . "wp-admin" . '/includes/media.php');

$attach_id = media_handle_upload( $file_handler, $post_id );

if ($setthumb) update_post_meta($post_id,'_thumbnail_id',$attach_id);
return $attach_id;
    }

    function mixtape_fep($content = null) {

global $post;

// We're outputing a lot of html and the easiest way 
// to do it is with output buffering from php.
ob_start(); ?> <?php

    if( 'POST' == $_SERVER['REQUEST_METHOD'] && !empty( $_POST['action'] ) &&      $_POST['action'] == "new_post") {

    // Do some minor form validation to make sure there is content
if (isset ($_POST['title'])) {
    $title =  $_POST['title'];
} else {
    echo 'Please enter the wine name';
}
if (isset ($_POST['description'])) {
    $description = $_POST['description'];
} else {
    echo 'Please enter some notes';
}       
    $cover_id = get_post_meta($post->ID, 'thumb', true);

    $cover = wp_get_attachment_link($cover_id);

    $content = $cover.'<br /><br />'.$description;

    $tags = $_POST['post_tags'];

// ADD THE FORM INPUT TO $new_post ARRAY
$new_post = array(
'post_title'    =>  $title,
'post_content'  =>  $content,
'post_category' =>  array($_POST['cat']),  // Usable for custom taxonomies too
'tags_input'    =>  array($tags),
'post_status'   =>  'publish',  // Choose: publish, preview, future, draft, etc.
'post_type' =>  'post'  //'post',page' or use a custom post type if you want to
);

//SAVE THE POST
$pid = wp_insert_post($new_post);

    if ($_FILES) {
foreach ($_FILES as $file => $array) {
$newupload = insert_attachment($file,$pid);
// $newupload returns the attachment id of the file that
// was just uploaded. Do whatever you want with that now.
}
    }

         //SET OUR TAGS UP PROPERLY
wp_set_post_tags($pid, $_POST['post_tags']);

//REDIRECT TO THE NEW POST ON SAVE
$link = get_permalink( $pid );
wp_redirect( $link );

    } // END THE IF STATEMENT THAT STARTED THE WHOLE FORM

    //POST THE POST YO
    do_action('wp_insert_post', 'wp_insert_post'); ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-02T19:56:38.467

通过将其添加到代码中来解决分配缩略图和插入图像的问题：

```
if ( $_FILES ) {
    $files = $_FILES['cover'];
    foreach ($files['name'] as $key => $value) {
        if ($files['name'][$key]) {
            $file = array(
                'name' => $files['name'][$key],
                'type' => $files['type'][$key],
                'tmp_name' => $files['tmp_name'][$key],
                'error' => $files['error'][$key],
                'size' => $files['size'][$key]
            );

            $_FILES = array("cover" => $file);

            foreach ($_FILES as $file => $array) {
                $newupload = insert_attachment($file,$post->ID);
            }
        }
    }
} 
```

接着

```
set_post_thumbnail( $pid, $newupload ); 
```

在插入帖子功能下方。

# php - PHP + MySQL事务+语法错误

> ID：13484915
> 
> 赞同：0
> 
> 时间：2012-11-21T01:13:00.440
> 
> 标签：php, mysql

首先，我是 Web 开发的新手，很抱歉，如果这是一个愚蠢的问题，我有一个数组，数组的键是需要在数据库中更新的记录的 id，我提供了下面的代码创建查询并使用 mysql 事务来运行查询（因为应该一起更新几条记录）。当我使用命令行运行生成的查询时，它工作正常，但使用 php 代码不！

生成查询的代码：

```
$insert="";

if($run==true){

foreach($result as $key=>$x){

    $insert = $insert ."update project set type='".$x."' "."where "."id=".$key.";";

    }

//echo $insert;
$insert=$insert ."COMMIT;";
$insert= "START TRANSACTION;". $insert; 
```

代码结果：

```
START TRANSACTION;update project set type='project1' where id=1;update project set type='project2' where id=2;COMMIT; 
```

它给我的错误：

```
Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'update project set type='project1' where id=1;update project set type='project2'' at line 1 
```

我没有包括 sql 连接，并且......因为我相信它们很好，但如果有必要，我也可以包括它们。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T01:20:04.177

使用 MySQL 函数不支持[多个查询。](http://php.net/manual/en/function.mysql-query.php)您需要分解交易：

```
$sql1 = UPDATE `project` SET `type`='project1' WHERE `id`=1;
$sql2 = UPDATE `project` SET `type`='project2' WHERE `id`=2; 
```

但是，您可以使用[mysqli_mutli_query或在另一个答案](http://php.net/manual/en/mysqli.multi-query.php)[PDO](http://php.net/manual/en/book.pdo.php)中提到

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T01:20:05.717

您可能希望切换到具有直接事务接口的 PDO。

```
$db = new PDO($dsn, $user, $pass);

$stmt = $db->prepare("update project set type= ? where id= ?");
$db->beginTransaction();

try {
  foreach ($result as $key => $x) {
    $db->execute(array($x, $key));
  }

  $db->commit();
} catch (PDOException $e) {
  $db->rollBack();
  throw $e;
} 
```

# asp.net-mvc-4 - 在自定义对象上过滤剑道网格

> ID：13484916
> 
> 赞同：1
> 
> 时间：2012-11-21T01:13:02.797
> 
> 标签：asp.net-mvc-4, grouping, kendo-ui

我有一个带有使用自定义对象的显示模板的 Kendo Grid。我已经实现了 IComparable 以允许分组和排序，但我不确定我需要做什么才能使过滤工作。实际上，当我单击该列的“过滤器”按钮时，它有一个空白下拉列表，而不是通常的“包含、开头、等于”和通常会显示的此类选项。我正在使用**ToDataSourceResult**来操作结果。

该模型：

```
public class LEAProgramMap
{
    public string entity_program { get; set; }
    [UIHint("ProgramEditor")]
    public ProgramDDL program_desc { get; set; }
} 
```

下拉列表：

```
public class ProgramDDL : IComparable
{
    public short program_id { get; set; }
    public string entity_program { get; set; }
    public string program_desc { get; set; }
    public int CompareTo(object obj)
    {
        if (obj is ProgramDDL)
        {
            ProgramDDL rev2 = (ProgramDDL)obj;
            return program_desc.CompareTo(rev2.program_desc);
        }
        else
            throw new ArgumentException("Object is not a ProgramDDL");
    }
} 
```

和观点：

```
@model IEnumerable<Datamart.Models.ViewModels.LEAProgramMap>

@{
    ViewBag.Title = "CreateProgramMap";
    var snapshot = Session["snapshot_id"] ?? Request.Params["snapshot_id"];
}

<h2>CreateProgramMap</h2>
@(Html.Kendo().Grid(Model)
.Name("Programs")
.Columns(cols =>
    {
        cols.Bound(p => p.entity_program).ClientTemplate("#=entity_program#");
        cols.Bound(p => p.program_desc).ClientTemplate("#=program_desc.program_desc#");
    })
.ToolBar(commands =>
    {
        commands.Save();
    })
.Editable(edit => edit.Enabled(true).Mode(GridEditMode.InCell))
.DataSource(ds => ds
            .Ajax()
            .Model(model =>
                {
                    model.Id(p => p.entity_program);
                    model.Field(p => p.entity_program).Editable(false);

                })
    // Configure RU -->
                .Read(read => read.Action("Program_Read", "Draft").Data("additionalData"))
                .Update(update => update.Action("Program_Update", "Draft").Data("additionalData"))
    //.ServerOperation(false)
                .Batch(true)
                .Events(events => events
                    //.Change("onChange")
                    .Error("onError")
                    )
                )
        // <-- Configure RU
        .Pageable(page => page.PageSizes(new int[] { 10, 25, 50, 100 }).Enabled(true))
        .Groupable(group => group.Enabled(true))
        .Filterable(filter => filter.Enabled(true).Extra(true))
        .Sortable(sort => sort.Enabled(true).SortMode(GridSortMode.SingleColumn).AllowUnsort(true))
        .Navigatable(nav => nav.Enabled(true))
        .Resizable(resizing => resizing.Columns(true))
        .Reorderable(reorder => reorder.Columns(true))
            )

<script>
function additionalData() {
    return {
        snapshot_id: "@snapshot"
    };
}

function onError(e, status) {
    if (e.errors) {
        var message = "The following errors have occurred:\n";

        $.each(e.errors, function (key, value) {
            if (value.errors) {
                message += value.errors.join("\n");
            }
        });

        alert(message);
    }
}

function onChange() {
    var grid = $("#Programs").data("kendoGrid");

    grid.dataSource.read();
}
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:29:36.280

不幸的是，Kendo UI 不支持包含复杂对象的类组合/视图模型，您的视图模型需要完全平坦以避免意外行为。所以你的班级应该是这样的。

```
public class LEAProgramMap
{
    public string entity_program { get; set; }
    public short program_id { get; set; }
    public string entity_program { get; set; }
    public string program_desc { get; set; }
} 
```

# c# - 用一个类监控其他类

> ID：13484925
> 
> 赞同：0
> 
> 时间：2012-11-21T01:14:21.983
> 
> 标签：c#, oop, design-patterns

我有一个名为 DataClass 的类。这个类负责将信息保存在数据库中，在这个类中有一些保存和读取数据库的方法，除了这个类，我还有其他类，称为 HTMLEditor、QueryBuilder、EmailSending、InforDetails。我需要通过我的数据类收听其他类，只要他们的信息发生更改，我的数据类就会被通知保存这些信息。我知道有一种设计模式称为观察者设计模式，使用这种设计模式，其他类（观察者）正在监听一个类（主题），只要主题的状态发生变化，就会通知其他观察者。

这个问题我该怎么办？这种情况有什么设计模式吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T01:21:15.020

我认为您寻求的界面 if `INotifyPropertyChanged`。

[Microsoft 文档：INotifyPropertyChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)

实现非常简单。

在您所做的每一处房产`set`中：

```
public bool MyProperty
{
    get { return myField; }

    set
    {
        if (myField != value)
        {
            myField= value;
            NotifyPropertyChanged();
        }
    }
} 
```

以及方法和事件：

```
public event PropertyChangedEventHandler PropertyChanged;

private void NotifyPropertyChanged([CallerMemberName] String propertyName = "")
{
    if (PropertyChanged != null)
    {
        PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
    }
} 
```

每个观察者只需要注册到那个事件，当一个属性发生变化以及哪个发生了变化时，他们就会得到一个反馈。

另外，当您向它们提供实现该接口的对象时，像 PropertyGrid 这样的控件会自动注册它们自己。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T01:18:50.867

该`INotifyPropertyChanged`界面可能是您所追求的：

请参阅此处：http: [//msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)

您基本上订阅了其他类中的事件，并且这些类在属性更改时引发事件。

此外，这个 SO 问题的答案非常酷：[Automatically INotifyPropertyChanged](https://stackoverflow.com/questions/527602/automatically-inotifypropertychanged)

# php - 如何将json日期视为日期而不是字符串？

> ID：13484928
> 
> 赞同：0
> 
> 时间：2012-11-21T01:15:09.487
> 
> 标签：php, json

我正在创建一个带有日期的 json 数组。

```
$result[] = array('startDate' => date("D M j G:i:s T Y"),
                            'endDate' => date("D M j G:i:s T Y"),
                            'title' => $event->title,
                            'description'=>$event->summary,
                            'priority'=>2); 
```

我得到的结果是：

```
 {
startDate: "Wed Nov 21 0:55:44 UTC 2012",
endDate: "Wed Nov 21 0:55:44 UTC 2012",
title: "title",
description: "desc",
priority: 2
} 
```

但我不希望日期被引用为字符串，我需要的是：

```
 {
startDate: Wed Nov 21 0:55:44 UTC 2012,
endDate: Wed Nov 21 0:55:44 UTC 2012,
title: "title",
description: "desc",
priority: 2
} 
```

那么有没有办法不将日期视为字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T01:31:10.203

JSON 中没有 DATE 值。JSON 中唯一允许的“值”结构是：

*   对象
*   数组
*   双引号字符串
*   数字（整数或浮点数）
*   布尔值（`true`或`false`不带引号）
*   `null`

所以你要求的不是 JSON 格式。您需要构建自己的类似 JSON 的序列化程序，或者在`json_encode`执行后修改字符串以删除双引号。

或者，您可以保留 JSON 原样，并使用 javascript 将字符串解析为 javascript`Date`对象，这似乎是该库的预期输入。

请参阅这篇文章，了解如何在 javascript 中将字符串解析为 Date 对象。

[Date(dateString) 和 new Date(dateString) 之间的区别](https://stackoverflow.com/questions/3505693/difference-between-datedatestring-and-new-datedatestring)

注意：您可能需要更改日期格式，因为您所拥有的不是通常接受的 javascript`dateString`格式之一。

# asp.net-mvc-4 - 让 MVC4 主站点对 Web 应用程序/虚拟目录进行身份验证

> ID：13484930
> 
> 赞同：0
> 
> 时间：2012-11-21T01:15:34.710
> 
> 标签：asp.net-mvc-4, forms-authentication, webforms

我有一个 MVC4（使用剃刀）主站点，然后是一个 asp.net webforms 存储，它在虚拟目录中作为 Web 应用程序运行。我可以在我的 MVC4 主站点中有一个表单身份验证页面，对用户进行身份验证，然后在身份验证后将他们发送到商店，如果他们尝试直接浏览到虚拟目录而尚未经过身份验证，是否将其重定向回 MVC4 表单身份验证页？

例如：他们访问 www.mysite.com/account/login，其中显示了我在 MVC4 和主站点的一部分上运行的漂亮登录页面。在他们成功登录后，它会将他们带到 www.mysite.com/store/（一个 Web 应用程序/虚拟目录），并且由于他们已经成功验证，它会显示商店。然后在翻转站点上，如果他们还没有通过身份验证并尝试直接转到 www.mysite.com/store/（Web 应用程序/虚拟目录），它会将它们重定向回主站点的表单身份验证页面：www .mysite.com/account/login

我在我的 MVC4 表单身份验证页面上对用户进行了很好的身份验证（我已经对此进行了测试并验证了它是否有效），问题是当我将它们重定向到商店时，商店看不到它们已登录并且要求他们使用商店包含的表单身份验证页面（已内置在 Web 部件中）登录。我想在我的 MVC4 网站上使用表单登录页面（因为它看起来很漂亮并且更容易控制/更新/编码等）。

这是会话问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T18:34:16.280

是的，我之前在研究这篇文章时读过它，这是一篇很棒的文章，里面有丰富的知识……但它把我带向了一个不同的方向。

我终于在 StackOverflow上找到了我的问题[的确切解决方案。](https://stackoverflow.com/a/19316/1620286)

并且还在 CodeProject 的另一篇文章中找到了一些很好的[信息](http://www.codeproject.com/Articles/6586/Single-sign-on-across-multiple-applications-in-ASP)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T03:00:05.623

如果我理解正确，您正在尝试跨应用程序使用表单身份验证。

SO post [How to do Forms Authentication Across Applications in asp.net mvc](https://stackoverflow.com/questions/9944676/how-to-do-forms-authentication-across-applications-in-asp-net-mvc)应该会有所帮助。

# java - 将 EditText 格式化为带有整数的货币

> ID：13484933
> 
> 赞同：3
> 
> 时间：2012-11-21T01:16:08.247
> 
> 标签：java, android, formatting, android-edittext

所有-我有一个`TextWatcher`格式化`EditText`为货币格式的：

```
private String current = "";
public void onTextChanged(CharSequence s, int start, int before, int count) {
    if(!s.toString().equals(current)){
        editText$.removeTextChangedListener(this);

       String cleanString = s.toString().replaceAll("[$,.]", "");

       double parsed = Double.parseDouble(cleanString);           
       String formated = NumberFormat.getCurrencyInstance().format((parsed/100));          

       current = formated;
       editText$.setText(formated);
       editText$.setSelection(formated.length());

       editText$.addTextChangedListener(this);
    }
} 
```

这很好用，问题是我`EditText`只需要整数，所以我不需要用户输入美分。所以不是 0.01 比 0.12 比 1.23 比 12.34，我想要 1 比 12 比 123 比 1,234。**我怎样才能摆脱小数点但保留逗号？**谢谢你。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-21T01:23:19.213

如果您不介意删除句点和尾随零，您可以这样做：

```
 mEditText.addTextChangedListener(new TextWatcher() {
        private String current = "";

        @Override
        public void onTextChanged(CharSequence s, int start, int before, int count) {
            if (!s.toString().equals(current)) {
                annualIncomeEntry.removeTextChangedListener(this);

                String cleanString = s.toString().replaceAll("[$,]", "");

                if (cleanString.length() > 0) {
                    double parsed = Double.parseDouble(cleanString);
                    NumberFormat formatter = NumberFormat.getCurrencyInstance();
                    formatter.setMaximumFractionDigits(0);
                    current = formatter.format(parsed);
                } else {
                    current = cleanString;
                }

                annualIncomeEntry.setText(current);
                annualIncomeEntry.setSelection(current.length());
                annualIncomeEntry.addTextChangedListener(this);
            }
        }

        @Override
        public void afterTextChanged(Editable s) {
        }

        @Override
        public void beforeTextChanged(CharSequence s, int start, int count, int after) {
        }
    }); 
```

这会将数字格式化程序的最大小数位数设置为零，删除所有尾随零和句点。我还删除了除以 100，以便所有输入的数字都是整数。

还要确保您的 EditText 的 inputType 是“数字”，否则如果用户尝试输入非数字字符，这将崩溃。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-12-31T21:18:55.207

Hexar 的答案很有用，但是当用户删除所有数字或移动光标时，它缺乏错误检测。我以他的回答和[此处](https://stackoverflow.com/a/17820934/1817121)的回答为基础，形成了一个完整的解决方案。由于在 onTextChanged() 方法中设置了 EditText，这可能不是最佳实践，但它可以工作。

```
 /* don't allow user to move cursor while entering price */
    mEditText.setMovementMethod(null);
    mEditText.addTextChangedListener(new TextWatcher() {
        private String current = "";
        NumberFormat formatter = NumberFormat.getCurrencyInstance();
        private double parsed;

        @Override
        public void onTextChanged(CharSequence s, int start, int before, int count) {
            if (!s.toString().equals(current)) {
                /* remove listener to prevent stack overflow from infinite loop */
                mEditText.removeTextChangedListener(this);
                String cleanString = s.toString().replaceAll("[$,]", "");

                try {
                    parsed = Double.parseDouble(cleanString);
                }
                catch(java.lang.NumberFormatException e) {
                    parsed = 0;
                }

                formatter.setMaximumFractionDigits(0);
                String formatted = formatter.format(parsed);

                current = formatted;
                mEditText.setText(formatted);

                /* add listener back */
                mEditText.addTextChangedListener(this);
                /* print a toast when limit is reached... see xml below. 
                 * this is for 6 chars */
                if (start == 7) {
                    Toast toast = Toast.makeText(getApplicationContext(), 
                        "Maximum Limit Reached", Toast.LENGTH_LONG);
                    toast.setGravity(Gravity.CENTER, 0, 0);
                    toast.show();
                }
            }
        } 
```

确保用户不输入无效信息的一种快速方法是编辑 xml。对于我的程序，设置了 6 个数字字符的限制。

```
 <!-- it says maxLength 8 but it's really 6 digits and a '$' and a ',' -->
        <EditText
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:inputType="number|textVisiblePassword"
            android:maxLength="8"
            android:digits="0123456789"
            android:id="@+id/mEditText"
            android:hint="Price"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T01:30:49.757

为什么不使用**currencyFormat**格式化金额，然后从字符串中取出**.00 。**

```
private static final ThreadLocal<NumberFormat> currencyFormat = new ThreadLocal<NumberFormat>() {
        @Override
        protected NumberFormat initialValue() {
            return NumberFormat.getCurrencyInstance();
        }
    }; 
```

> currencyFormat.get().format(< your_amount_here > )

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-04T07:12:40.457

etProductCost.addTextChangedListener(new TextWatcher() { @Override public void beforeTextChanged(CharSequence s, int start, int count, int after) {}

```
 @Override
        public void onTextChanged(CharSequence s, int start, int before, int count) {
            if (s.toString().length() == 1){
                //first number inserted.
                if (s.toString().equals(getString(R.string.currency_symbol))){
                    //if it is a currecy symbol
                    etProductCost.setText("");
                }else {
                    etProductCost.setText(getString(R.string.currency_symbol) + s.toString());
                    etProductCost.setSelection(s.toString().length());
                }
                return;
            }
            //set cursor position to last in edittext
            etProductCost.setSelection(s.toString().length());
        }

        @Override
        public void afterTextChanged(Editable s) {}
    }); 
```

# linux - 没有 chroot 的 LXC

> ID：13484937
> 
> 赞同：10
> 
> 时间：2012-11-21T01:16:25.567
> 
> 标签：linux, lxc, cgroups

有没有办法使用 LXC 进行资源管理，使用进程组而不创建容器？我正在开发一个在沙箱中运行任意代码的服务，对此我只对硬件资源管理感兴趣。我不想要任何 chrooting；我只希望这些进程组能够访问主文件系统。

有人告诉我 lxc 是轻量级的，但是我看到的所有示例都为每个 lxc 进程创建了一个新容器（即具有完整操作系统的目录）。我真的不明白这比任何其他 VM 解决方案要轻得多。

那么有没有什么方法可以使用 LXC 来控制和管理多个进程组，而无需为每个进程组创建单独的容器？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-21T03:30:17.153

LXC 不是一个单一的系统。它是一个内核特性的集合，可用于以各种不同的方式隔离进程，并且是一个用户空间工具，可以将所有这些特性一起使用来创建成熟的容器。但是没有 LXC，个别功能仍然可以单独使用。此外，LXC 不需要 chroot，即使你给它一个 chroot，你也可以将主机系统中的目录绑定到容器中，在主机和容器之间共享那些特定的目录树。

例如，LXC 使用 cgroups 来设置容器的资源限制。但它们可用于在不使用 LXC 工具的情况下设置进程组的资源限制。您可以操纵`/sys/fd/cgroup/memory`或`/sys/fs/cgroup/cpuacct`直接将进程放入 cgroup 中，以限制它们被允许使用的内存或 CPU 数量。或者，如果您在使用 的系统上，您可以使用给定服务的文件中的等`systemd`来控制一组进程的内存限制。`MemoryLimit=200M``.service`

如果您想使用 LXC 进行轻量级资源管理，您可以使用或不使用 chroot。启动 LXC 容器时，可以选择要隔离哪些资源；所以你可以创建一个只有虚拟化网络的容器，别无其他；或者只有内存限制但与主机共享其他所有内容的容器。唯一需要隔离的是在容器配置文件中指定的内容。例如，`lxc`附带几个仅隔离网络的示例容器定义；他们与主机共享一个根分区以及几乎所有其他内容。以下是如何运行与主机系统相同的容器，但它没有网络接口：

```
 sudo lxc-execute -n foo -f /usr/share/doc/lxc/examples/lxc-no-netns.conf /bin/bash 
```

如果您希望某些文件与主机共享，而不是其他文件，您有两种选择；您可以使用共享根目录，并挂载您希望在容器中有所不同的文件；或者您可以使用 chroot，但将您想要在容器中共享的文件挂载。

例如，这是一个与主机共享所有内容的容器的配置，除了`/home`; `/home/me/fake-home`它改为在`/home`容器内绑定挂载：

```
lxc.mount.entry = /home/me/fake-home /home none rw,bind 0 0 
```

或者如果你想拥有一个完全不同的根目录，但仍然共享一些目录，例如`/usr`，你可以将几个目录绑定到一个目录中，并将其用作文件系统的根目录。

因此，您有很多选择，可以选择仅隔离一个组件、多个组件或 LXC 支持的多个组件，具体取决于您的需要。

# nhibernate - 流畅的休眠多态性。如何检查类的类型

> ID：13484939
> 
> 赞同：0
> 
> 时间：2012-11-21T01:16:37.483
> 
> 标签：nhibernate, fluent-nhibernate, fluent-nhibernate-mapping

我有一个具有内容（一对一）关系的图标。

```
public class Icon
{
   public virtual Content Content {get; set;}
} 
```

默认情况下，它是延迟加载的，这正是我想要的。但是，在代码中的某个时刻，我需要检查 Content 是什么类型，Content 是多态的，比如

```
if(icon.Content is TextContent)
{
 ...
} 
```

图标是另一个关联的一部分，它是由 NHibernate 自动获取的，我不是手动获取的。

在这种情况下检查实际类型的推荐方法是什么？

我可以有一个像 ContentType 这样的特定属性，它将是一个枚举，以便识别实际的内容类型，但我想知道是否有不同的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T17:01:34.517

感谢您的建议，但同时我找到了一个有趣的解决方案，我认为更好。

使用访问者模式，我可以定义一个 IconContent 访问者并将要执行的操作传递给它。例如，假设有一个 TextContent 和一个 ImageContent，它将是这样的：

```
IconContentVisitor.Func(()=> {  Console.WriteLine("this is TextContent"; }, ()=> { Console.WriteLine("this is ImageContent")); 
```

想法来自这里： http: [//mookid.dk/oncode/archives/991](http://mookid.dk/oncode/archives/991)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T15:51:42.890

[这与最近](https://stackoverflow.com/questions/13491749/inheritance-and-lazy-loading-in-nhibernate)的另一个问题非常相似。

要添加到 csanchez 的列表中，第四种方法是向`Self`Content 基类添加一个属性，该属性返回未代理的类型：

```
public virtual void Self
{
   get { return this; }
} 
```

第五个方法是在映射中使用 'lazy="no-proxy"`，[如 Ayende 的博客中所述](http://ayende.com/blog/4378/nhibernate-new-feature-no-proxy-associations)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T13:19:13.020

如果您想进行这种检查，您必须从属性中删除代理。有几种方法可以做到：

1.  如果您有权访问会话呼叫：

    ```
    session.PersistenceContext.Unproxy(icon.Content); 
    ```

2.  实现一个虚拟方法（如果可能，在基类中），通过返回具有正确类型的实例来强制删除代理。

    ```
    public virtual U As<U>() where U : YourType {
        return this as U;
    } 
    ```

3.  禁用属性的延迟初始化。

# c++ - 检测窗口何时停止移动？

> ID：13484941
> 
> 赞同：6
> 
> 时间：2012-11-21T01:16:54.980
> 
> 标签：c++, winapi, visual-c++

有谁知道如何检测 Win32(c++) 窗口是否停止移动？

WM_MOVE 检测窗口何时移动，但如何检测它何时*停止*移动？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-21T01:25:56.810

您要处理的 windows 消息是`WM_EXITSIZEMOVE`.

[WM_EXITSIZEMOVE 消息 (Windows) @ MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/ms632623.aspx)

根据您希望完成的任务，还可能通过对 做出反应来为您提供更好的服务，`WM_NCLBUTTONUP`当鼠标按钮在窗口的非客户区域中释放时发送，例如任何窗口的标题栏标题、边框镶边等。

[WM_NCLBUTTONUP 消息 (Windows) @ MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645621.aspx)

# internet-explorer - NavigateComplete2 事件和重定向

> ID：13484942
> 
> 赞同：0
> 
> 时间：2012-11-21T01:17:13.687
> 
> 标签：internet-explorer, bho

我正在 IE 中编写 BHO（浏览器助手对象），我需要跟踪重定向。

最初我认为 BeforeNavigate2 事件将是我需要的事件，但我了解到它实际上主要用于帧。接下来我发现 WebBrowserEvents2 的 NavigateComplete2 事件似乎在重定向时被触发了两次。但我不知道我的观察是否正确，也不知道如何判断一系列 NavigateComplete2 事件是由于重定向还是用户点击造成的。请指教！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-08T20:43:41.510

在与您的情况类似的情况下，NavigateComplete2 被浏览器对象中的单独框架触发，我发现**DocumentComplete**起到了作用，等待所有帧在触发之前加载。也许这对您的情况有帮助？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T05:32:46.153

我在大量的试验和错误中发现，如果您比较从 BeforeNavigate2 传递的浏览器界面指针与您在创建 BHO 时获得的指针，您可以找出真正的起始 url 是什么。当它们相同时，传递给 BeforeNavigate2 的 url 就是您需要的。您需要将其与您从 NavigateComplete2 获得的进行比较。如果它们不同，则表示重定向。一个问题是打开一个新窗口时。在这种情况下，您还需要关注 NewWindow 事件并进行一些特殊处理（当打开新窗口时，BeforeNavigate2 URL 也将传递给 NavigateComplete2，因此您需要设置一个标志并进行相应的处理）。

# c++ - 以漂亮的方式打印二叉树

> ID：13484943
> 
> 赞同：24
> 
> 时间：2012-11-21T01:17:15.030
> 
> 标签：c++

只是想知道我是否可以获得一些关于以以下形式打印漂亮二叉树的提示：

```
5
     10
          11
          7
               6
     3
          4
          2 
```

现在它打印的是：

```
 2
    4
    3 
    6
    7
    11
    10
    5 
```

我知道我的示例与我当前正在打印的内容是颠倒的，如果我从当前打印的根目录向下打印，这并不重要。任何提示都非常感谢我的完整问题：

如何修改我的打印以使树看起来像一棵树？

```
 //Binary Search Tree Program

#include <iostream>
#include <cstdlib>
#include <queue>
using namespace std;

int i = 0;

class BinarySearchTree
{
   private:
   struct tree_node
   {
      tree_node* left;
      tree_node* right;
      int data;
   };
   tree_node* root;

   public:
   BinarySearchTree()
   {
      root = NULL;
   }

   bool isEmpty() const { return root==NULL; }
   void print_inorder();
   void inorder(tree_node*);
   void print_preorder();
   void preorder(tree_node*);
   void print_postorder();
   void postorder(tree_node*);
   void insert(int);
   void remove(int);
};

// Smaller elements go left
// larger elements go right
void BinarySearchTree::insert(int d)
{
   tree_node* t = new tree_node;
   tree_node* parent;
   t->data = d;
   t->left = NULL;
   t->right = NULL;
   parent = NULL;

   // is this a new tree?
   if(isEmpty()) root = t;
   else
   {
      //Note: ALL insertions are as leaf nodes
      tree_node* curr;
      curr = root;
      // Find the Node's parent
      while(curr)
      {
         parent = curr;
         if(t->data > curr->data) curr = curr->right;
         else curr = curr->left;
      }

      if(t->data < parent->data)
      {
         parent->left = t;
      }
      else
      {
      parent->right = t;
      }
    }
}

void BinarySearchTree::remove(int d)
{
   //Locate the element
   bool found = false;
   if(isEmpty())
   {
      cout<<" This Tree is empty! "<<endl;
      return;
   }

   tree_node* curr;
   tree_node* parent;
   curr = root;

   while(curr != NULL)
   {
      if(curr->data == d)
      {
         found = true;
         break;
      }
      else
      {
         parent = curr;
         if(d>curr->data) curr = curr->right;
         else curr = curr->left;
      }
    }
    if(!found)
    {
      cout<<" Data not found! "<<endl;
      return;
    }

    // 3 cases :
    // 1\. We're removing a leaf node
    // 2\. We're removing a node with a single child
    // 3\. we're removing a node with 2 children

    // Node with single child
    if((curr->left == NULL && curr->right != NULL) || (curr->left != NULL && curr->right == NULL))
    {
      if(curr->left == NULL && curr->right != NULL)
      {
         if(parent->left == curr)
         {
            parent->left = curr->right;
            delete curr;
         }
         else
         {
            parent->right = curr->left;
            delete curr;
         }
       }
       return;
    }

    //We're looking at a leaf node
    if( curr->left == NULL && curr->right == NULL)
    {
      if(parent->left == curr)
      {
         parent->left = NULL;
      }
      else
      {
         parent->right = NULL;
      }
      delete curr;
      return;
    }

    //Node with 2 children
    // replace node with smallest value in right subtree
    if (curr->left != NULL && curr->right != NULL)
    {
       tree_node* chkr;
       chkr = curr->right;
       if((chkr->left == NULL) && (chkr->right == NULL))
       {
         curr = chkr;
         delete chkr;
         curr->right = NULL;
       }
       else // right child has children
       {
         //if the node's right child has a left child
         // Move all the way down left to locate smallest element

         if((curr->right)->left != NULL)
         {
            tree_node* lcurr;
            tree_node* lcurrp;
            lcurrp = curr->right;
            lcurr = (curr->right)->left;
            while(lcurr->left != NULL)
            {
               lcurrp = lcurr;
               lcurr = lcurr->left;
            }
            curr->data = lcurr->data;
            delete lcurr;
            lcurrp->left = NULL;
         }
         else
         {
            tree_node* tmp;
            tmp = curr->right;
            curr->data = tmp->data;
            curr->right = tmp->right;
            delete tmp;
         }

      }
      return;
   }

}
void BinarySearchTree::print_postorder()
{
   postorder(root);
}

void BinarySearchTree::postorder(tree_node* p)
{
   if(p != NULL)
   {
      if(p->left) postorder(p->left);
      if(p->right) postorder(p->right);
      cout<<"     "<<p->data<<"\n ";
   }
   else return;
}

int main()
{
    BinarySearchTree b;
    int ch,tmp,tmp1;
    while(1)
    {
       cout<<endl<<endl;
       cout<<" Binary Search Tree Operations "<<endl;
       cout<<" ----------------------------- "<<endl;
       cout<<" 1\. Insertion/Creation "<<endl;
       cout<<" 2\. Printing "<<endl;
       cout<<" 3\. Removal "<<endl;
       cout<<" 4\. Exit "<<endl;
       cout<<" Enter your choice : ";
       cin>>ch;
       switch(ch)
       {
           case 1 : cout<<" Enter Number to be inserted : ";
                    cin>>tmp;
                    b.insert(tmp);
                    i++;
                    break;
           case 2 : cout<<endl;
                    cout<<" Printing "<<endl;
                    cout<<" --------------------"<<endl;
                    b.print_postorder();
                    break;
           case 3 : cout<<" Enter data to be deleted : ";
                    cin>>tmp1;
                    b.remove(tmp1);
                    break;
           case 4:
                    return 0;

       }
    }
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-21T01:24:15.940

为了递归地漂亮打印一棵树，您需要将两个参数传递给您的打印函数：

*   要打印的树节点，以及
*   缩进级别

例如，您可以这样做：

```
void BinarySearchTree::postorder(tree_node* p, int indent=0)
{
    if(p != NULL) {
        if(p->left) postorder(p->left, indent+4);
        if(p->right) postorder(p->right, indent+4);
        if (indent) {
            std::cout << std::setw(indent) << ' ';
        }
        cout<< p->data << "\n ";
    }
} 
```

最初的电话应该是`postorder(root);`

如果您想打印根在顶部的树，请`cout`移至`if`.

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-11-02T13:49:06.500

```
void btree::postorder(node* p, int indent)
{
    if(p != NULL) {
        if(p->right) {
            postorder(p->right, indent+4);
        }
        if (indent) {
            std::cout << std::setw(indent) << ' ';
        }
        if (p->right) std::cout<<" /\n" << std::setw(indent) << ' ';
        std::cout<< p->key_value << "\n ";
        if(p->left) {
            std::cout << std::setw(indent) << ' ' <<" \\\n";
            postorder(p->left, indent+4);
        }
    }
} 
```

有了这棵树：

```
btree *mytree = new btree();
mytree->insert(2);
mytree->insert(1);
mytree->insert(3);
mytree->insert(7);
mytree->insert(10);
mytree->insert(2);
mytree->insert(5);
mytree->insert(8);
mytree->insert(6);
mytree->insert(4);
mytree->postorder(mytree->root); 
```

会导致这样的结果：

![在此处输入图像描述](../Images/ba22e21e48ad59f66fc8fb5f73dd8445.png)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-06-15T03:47:26.023

它永远不会足够漂亮，除非你做一些回溯来重新校准显示输出。但是可以使用启发式有效地发出足够多的二叉树：给定一棵树的高度，可以猜测不同深度的节点的预期宽度和集合是多少。有几部分需要做到这一点，所以让我们首先从更高级别的函数开始提供上下文。

漂亮的打印功能：

```
 // create a pretty vertical tree
   void postorder(Node *p)
   {
      int height = getHeight(p) * 2;
      for (int i = 0 ; i < height; i ++) {
         printRow(p, height, i);
      }
   } 
```

上面的代码很简单。主要逻辑在 printRow 函数中。让我们深入研究一下。

```
void printRow(const Node *p, const int height, int depth)
{
        vector<int> vec;
        getLine(p, depth, vec);
        cout << setw((height - depth)*2); // scale setw with depth
        bool toggle = true; // start with left
        if (vec.size() > 1) {
                for (int v : vec) {
                        if (v != placeholder) {
                                if (toggle)
                                        cout << "/" << "   ";
                                else
                                        cout << "\\" << "   ";
                        }
                        toggle = !toggle;
                }
                cout << endl;
                cout << setw((height - depth)*2);
        }
        for (int v : vec) {
                if (v != placeholder)
                        cout << v << "   ";
        }
        cout << endl;
} 
```

getLine() 符合您的预期：它将具有给定相等深度的所有节点存储到 vec 中。这是代码：

```
void getLine(const Node *root, int depth, vector<int>& vals)
{
        if (depth <= 0 && root != nullptr) {
                vals.push_back(root->val);
                return;
        }
        if (root->left != nullptr)
                getLine(root->left, depth-1, vals);
        else if (depth-1 <= 0)
                vals.push_back(placeholder);
        if (root->right != nullptr)
                getLine(root->right, depth-1, vals);
        else if (depth-1 <= 0)
                vals.push_back(placeholder);
} 
```

现在回到 printRow()。对于每一行，我们根据我们在二叉树中的深度来设置流宽度。这种格式会很好，因为通常情况下，你走得越深，需要的宽度就越大。我说通常是因为在退化的树中，这看起来不那么漂亮。只要树大致平衡且较小（< 20 个项目），结果应该很好。需要一个占位符来正确对齐“/”和“\”字符。因此，当通过 getLine() 获得一行时，如果在指定深度处不存在任何节点，我们将插入占位符。占位符可以设置为类似`(1<<31)`例如。显然，这并不可靠，因为占位符可能是有效的节点值。如果编码员有胆量并且只处理小数，则可以修改代码以通过 getLine() 发出十进制转换的字符串并使用“_”之类的占位符。（不幸的是，我不是这样的编码员：P）

以下项目按顺序插入的结果：8、12、4、2、5、15 是

```
 8   
     /   \   
     4   12   
   /   \   \   
   2   5   15 
```

getHeight() 留给读者作为练习。:) 甚至可以通过根据较深节点中的项目数追溯更新浅节点的集合来获得更漂亮的结果。这也留给读者作为练习。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-07-29T21:09:14.323

```
 //Binary tree (pretty print):
    //                        ________________________50______________________                        
    //            ____________30                                  ____________70__________            
    //      ______20____                                          60                ______90          
    //      10          15                                                          80                

    // prettyPrint
    public static void prettyPrint(BTNode node) {
        // get height first
        int height = heightRecursive(node);

        // perform  level order traversal
        Queue<BTNode> queue = new LinkedList<BTNode>();

        int level = 0;
        final int SPACE = 6;
        int nodePrintLocation = 0;

        // special node for pushing when a node has no left or right child (assumption, say this node is a node with value Integer.MIN_VALUE)
        BTNode special = new BTNode(Integer.MIN_VALUE);

        queue.add(node);
        queue.add(null);    // end of level 0
        while(! queue.isEmpty()) {
            node = queue.remove();

            if (node == null) {
                if (!queue.isEmpty()) {
                    queue.add(null);
                }

                // start of new level
                System.out.println();
                level++;
            } else {
                nodePrintLocation = ((int) Math.pow(2, height - level)) * SPACE;

                System.out.print(getPrintLine(node, nodePrintLocation));

                if (level < height) {
                    // only go till last level
                    queue.add((node.left != null) ? node.left : special);
                    queue.add((node.right != null) ? node.right : special);
                }
            }
        }       
    }
    public void prettyPrint() {
        System.out.println("\nBinary tree (pretty print):");
        prettyPrint(root);
    }
    private static String getPrintLine(BTNode node, int spaces) {
        StringBuilder sb = new StringBuilder();

        if (node.data == Integer.MIN_VALUE) {
            // for child nodes, print spaces
            for (int i = 0; i < 2 * spaces; i++) {
                sb.append(" ");
            }

            return sb.toString();
        }

        int i = 0;
        int to = spaces/2;

        for (; i < to; i++) {
            sb.append(' ');
        }
        to += spaces/2;
        char ch = ' ';
        if (node.left != null) {
            ch = '_';
        }
        for (; i < to; i++) {
            sb.append(ch);
        }

        String value = Integer.toString(node.data);
        sb.append(value);

        to += spaces/2;
        ch = ' ';
        if (node.right != null) {
            ch = '_';
        }
        for (i += value.length(); i < to; i++) {
            sb.append(ch);
        }

        to += spaces/2;
        for (; i < to; i++) {
            sb.append(' ');
        }

        return sb.toString();
    }

    private static int heightRecursive(BTNode  node) {
        if (node == null) {
            // empty tree
            return -1;
        }

        if (node.left == null && node.right == null) {
            // leaf node
            return 0;
        }

        return 1 + Math.max(heightRecursive(node.left), heightRecursive(node.right));
    } 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-11-20T20:33:42.237

```
#include <stdio.h>
#include <stdlib.h>

struct Node
{
    struct Node *left,*right;
    int val;
} *root=NULL;

int rec[1000006];
void addNode(int,struct Node*);
void printTree(struct Node* curr,int depth)
{
    int i;
    if(curr==NULL)return;
    printf("\t");
    for(i=0;i<depth;i++)
        if(i==depth-1)
            printf("%s\u2014\u2014\u2014",rec[depth-1]?"\u0371":"\u221F");
        else
            printf("%s   ",rec[i]?"\u23B8":"  ");
    printf("%d\n",curr->val);
    rec[depth]=1;
    printTree(curr->left,depth+1);
    rec[depth]=0;
    printTree(curr->right,depth+1);
}
int main()
{
    root=(struct Node*)malloc(sizeof(struct Node));
    root->val=50;
    //addNode(50,root);
    addNode(75,root);    addNode(25,root);
    addNode(15,root);    addNode(30,root);
    addNode(100,root);    addNode(60,root);
    addNode(27,root);    addNode(31,root);
    addNode(101,root);    addNode(99,root);
    addNode(5,root);    addNode(61,root);
    addNode(55,root);    addNode(20,root);
    addNode(0,root);    addNode(21,root);
    //deleteNode(5,root);

    printTree(root,0);
    return 0;
}

void addNode(int v,struct Node* traveller)
{
    struct Node *newEle=(struct Node*)malloc(sizeof(struct Node));
    newEle->val=v;
    for(;;)
    {
        if(v<traveller->val)
        {
            if(traveller->left==NULL){traveller->left=newEle;return;}
            traveller=traveller->left;
        }
        else if(v>traveller->val)
        {
            if(traveller->right==NULL){traveller->right=newEle;return;}
            traveller=traveller->right;
        }
        else
        {
            printf("%d Input Value is already present in the Tree !!!\n",v);
            return;
        }
    }
} 
```

希望，你觉得它很漂亮...

输出：

```
50
ͱ———25
⎸   ͱ———15
⎸   ⎸   ͱ———5
⎸   ⎸   ⎸   ͱ———0
⎸   ⎸   ∟———20
⎸   ⎸        ∟———21
⎸   ∟———30
⎸        ͱ———27
⎸        ∟———31
∟———75
     ͱ———60
     ⎸   ͱ———55
     ⎸   ∟———61
     ∟———100
          ͱ———99
          ∟———101 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-11-21T01:20:33.657

如果您只需要可视化您的树，更好的方法是将其输出为点格式并使用 grapviz 进行绘制。

您可以查看[点指南](http://www.graphviz.org/pdf/dotguide.pdf)以获取更多信息 abt 语法等

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-08-17T08:46:57.537

这是一个以树形式打印基于数组的堆的小示例。对于更大的数字，它需要对算法进行一些调整。我只是在纸上做了一个网格，并计算出每个节点看起来不错的空间索引，然后注意到每个节点需要多少空间，基于其父节点的空间数量和递归级别以及如何树很高。该解决方案超越了仅按水平顺序打印并满足“美观”要求。

```
#include <iostream>
#include <vector>

static const int g_TerminationNodeValue = -999;

class HeapJ
{
public:
HeapJ(int* pHeapArray, int numElements)
{
    m_pHeapPointer = pHeapArray;
    m_numElements = numElements;

    m_treeHeight = GetTreeHeight(1);
}

void Print()
{
    m_printVec.clear();

    int initialIndex = 0;
    for(int i=1; i<m_treeHeight; ++i)
    {
        int powerOfTwo = 1;
        for(int j=0; j<i; ++j)
        {
            powerOfTwo *= 2;
        }

        initialIndex += powerOfTwo - (i-1);
    }

    DoPrintHeap(1,0,initialIndex);

    for(size_t i=0; i<m_printVec.size(); ++i)
    {
        std::cout << m_printVec[i] << '\n' << '\n';
    }
}

private:
int* m_pHeapPointer;
int m_numElements;
int m_treeHeight;
std::vector<std::string> m_printVec;

int GetTreeHeight(int index)
{
    const int value = m_pHeapPointer[index-1];

    if(value == g_TerminationNodeValue)
    {
        return -1;
    }

    const int childIndexLeft = 2*index;
    const int childIndexRight = childIndexLeft+1;

    int valLeft = 0;
    int valRight = 0;

    if(childIndexLeft <= m_numElements)
    {
        valLeft = GetTreeHeight(childIndexLeft);
    }

    if(childIndexRight <= m_numElements)
    {
        valRight = GetTreeHeight(childIndexRight);
    }

    return std::max(valLeft,valRight)+1;
}

void DoPrintHeap(int index, size_t recursionLevel, int numIndents)
{
    const int value = m_pHeapPointer[index-1];

    if(value == g_TerminationNodeValue)
    {
        return;
    }

    if(m_printVec.size() == recursionLevel)
    {
        m_printVec.push_back(std::string(""));
    }

    const int numLoops = numIndents - (int)m_printVec[recursionLevel].size();
    for(int i=0; i<numLoops; ++i)
    {
        m_printVec[recursionLevel].append(" ");
    }

    m_printVec[recursionLevel].append(std::to_string(value));

    const int childIndexLeft = 2*index;
    const int childIndexRight = childIndexLeft+1;

    const int exponent = m_treeHeight-(recursionLevel+1);
    int twoToPower = 1;
    for(int i=0; i<exponent; ++i)
    {
        twoToPower *= 2;
    }
    const int recursionAdjust = twoToPower-(exponent-1);

    if(childIndexLeft <= m_numElements)
    {
        DoPrintHeap(childIndexLeft, recursionLevel+1, numIndents-recursionAdjust);
    }

    if(childIndexRight <= m_numElements)
    {
        DoPrintHeap(childIndexRight, recursionLevel+1, numIndents+recursionAdjust);
    }
}
};

const int g_heapArraySample_Size = 14;
int g_heapArraySample[g_heapArraySample_Size] = {16,14,10,8,7,9,3,2,4,1,g_TerminationNodeValue,g_TerminationNodeValue,g_TerminationNodeValue,0};

int main()
{
    HeapJ myHeap(g_heapArraySample,g_heapArraySample_Size);
    myHeap.Print();

    return 0;
}

/* output looks like this:

           16

     14          10

  8     7     9     3

2   4 1           0

*/ 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-06-01T20:59:36.090

这是另一个 C++98 实现，具有[`tree`](https://linux.die.net/man/1/tree)类似的输出。

样本输出：

```
PHP
└── is
    ├── minor
    │   └── perpetrated
    │       └── whereas
    │           └── skilled
    │               └── perverted
    │                   └── professionals.
    └── a
        ├── evil
        │   ├── incompetent
        │   │   ├── insidious
        │   │   └── great
        │   └── and
        │       ├── created
        │       │   └── by
        │       │       └── but
        │       └── amateurs
        └── Perl 
```

编码：

```
void printTree(Node* root)
{
        if (root == NULL)
        {
                return;
        }

        cout << root->val << endl;
        printSubtree(root, "");
        cout << endl;
}

void printSubtree(Node* root, const string& prefix)
{
        if (root == NULL)
        {
                return;
        }

        bool hasLeft = (root->left != NULL);
        bool hasRight = (root->right != NULL);

        if (!hasLeft && !hasRight)
        {
                return;
        }

        cout << prefix;
        cout << ((hasLeft  && hasRight) ? "├── " : "");
        cout << ((!hasLeft && hasRight) ? "└── " : "");

        if (hasRight)
        {
                bool printStrand = (hasLeft && hasRight && (root->right->right != NULL || root->right->left != NULL));
                string newPrefix = prefix + (printStrand ? "│   " : "    ");
                cout << root->right->val << endl;
                printSubtree(root->right, newPrefix);
        }

        if (hasLeft)
        {
                cout << (hasRight ? prefix : "") << "└── " << root->left->val << endl;
                printSubtree(root->left, prefix + "    ");
        }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-10-08T12:55:43.403

# 前言

迟到的答案及其在Java中，但我想将我的添加到记录中，因为我发现了如何相对容易地做到这一点，而且我做到这一点的方式更重要。诀窍是要认识到您真正想要的是不要将任何子树直接打印在您的根/子根节点下（在同一列中）。为什么你可能会问？因为它**保证**了没有间距问题，没有重叠，左子树和右子树没有碰撞的可能性，即使是超长数字。它会自动调整到节点数据的大小。基本思想是将左子树完全打印到根的左侧，而右子树完全打印到根的右侧。

# 我如何看待这个问题的类比

一个很好的思考方式是用雨伞，首先想象你在外面拿着一把大伞，你代表**根**和你的伞，它下面的一切都是整**棵树**。把你的**左子树**想象成一个矮个子（反正比你矮），拿着一把小伞，在你的大伞下在你的左边。您的**右子树**由一个相似的人表示，在您的右侧有一把同样较小的雨伞。想象一下，如果矮个子男人的雨伞碰过，他们会生气并互相撞击（糟糕的重叠）。你是**根**，你身边的人是你的**子树**. 您必须正好在他们的雨伞（子树）中间，才能将两人分开，并确保他们永远不会撞到雨伞。诀窍是递归地想象这一点，其中两个人每个人都有自己的两个较小的人在他们的伞下（子节点），他们需要在他们的伞下分开更小的伞（子子树等）伞（子树），它们充当**子根**。从根本上说，这就是在打印二叉树、子树重叠时“解决”一般问题所需要的。为此，您只需要考虑如何“打印”或“代表”我的模拟中的男性。

# 我的实现，它的局限性和潜力

首先，我的代码实现接受的参数多于需要的参数（要打印的 currentNode 和节点级别）的唯一原因是因为在打印时我不能轻易地在控制台中移动一行，所以我必须先映射我的行并打印他们反过来。为此，我制作了一个 lineLevelMap，将树的每一行映射到它的输出（这可能对未来有用，作为一种轻松收集树的每一行并同时打印出来的方法）。

```
//finds the height of the tree beforehand recursively, left to reader as exercise
int height = TreeHeight(root);
//the map that uses the height of the tree to detemrine how many entries it needs
//each entry maps a line number to the String of the actual line
HashMap<Integer,String> lineLevelMap = new HashMap<>();
//initialize lineLevelMap to have the proper number of lines for our tree 
//printout by starting each line as the empty string
for (int i = 0; i < height + 1; i++) {
    lineLevelMap.put(i,"");
} 
```

如果我可以让 ANSI 转义码在 java 控制台（windows ugh）中工作，我可以简单地向上打印一行，我会将参数计数减少 2，因为我不需要预先映射行或知道树的深度。无论如何，这是我的代码在树的有序遍历中递归：

```
public int InOrderPrint(CalcTreeNode currentNode, HashMap<Integer,String> 
    lineLevelMap, int level, int currentIndent){
        //traverse left case
        if(currentNode.getLeftChild() != null){
            //go down one line
            level--;
            currentIndent = 
           InOrderPrint(currentNode.getLeftChild(),lineLevelMap,level,currentIndent);
            //go up one line
            level++;

    }
    //find the string length that already exists for this line
    int previousIndent = lineLevelMap.get(level).length();
    //create currentIndent - previousIndent spaces here
    char[] indent = new char[currentIndent-previousIndent];
    Arrays.fill(indent,' ');
    //actually append the nodeData and the proper indent to add on to the line 
    //correctly
    lineLevelMap.put(level,lineLevelMap.get(level).concat(new String(indent) + 
    currentNode.getData()));
    //update the currentIndent for all lines
    currentIndent += currentNode.getData().length();

    //traverse right case
    if (currentNode.getRightChild() != null){
        //go down one line
        level--;
        currentIndent = 
        InOrderPrint(currentNode.getRightChild(),lineLevelMap,level,currentIndent);
        //go up one line
        level++;
    }
    return currentIndent;
} 
```

要在 Java 中实际将此 Tree 打印到控制台，只需使用我们生成的 LineMap。这样我们就可以将线条正面朝上打印

```
for (int i = height; i > -1; i--) {
    System.out.println(lineLevelMap.get(i));
} 
```

# 这一切是如何运作的

InorderPrint 子函数完成所有“工作”，并且可以递归地打印出任何节点及其子树。更好的是，它将它们均匀地隔开，您可以轻松地对其进行修改以均匀地隔开所有节点（只需使 Nodedata 相等或让算法认为它是）。它工作得这么好的原因是因为它使用节点的数据长度来确定下一个缩进应该在哪里。这确保了左子树总是在根和右子树之前打印，因此如果您以递归方式确保这一点，则不会在其根下打印左节点，也不会在其根根下打印，依此类推，对于任何右节点都是如此。相反，根和所有子根直接位于其子树的中间，不会浪费空间。

输入为 3 + 2 的示例输出在控制台中如下所示：

[![Java 控制台中 3 + 2 的示例](../Images/0252124344e4d53281e16464735c910f.png)](https://i.stack.imgur.com/0zhio.png)

3 + 4 * 5 + 6 的示例是：

[![3 + 4 * 5 + 6 的示例](../Images/c3b6a3b949c7d8a110b1615997d6d975.png)](https://i.stack.imgur.com/WjD75.png)

最后是 ( 3 + 4 ) * ( 5 + 6 ) 的例子，注意括号是：

[![( 3 + 4 ) * ( 5 + 6 ) 示例](../Images/bf7c94785220d8a53b69ed97de05070f.png)](https://i.stack.imgur.com/wnL5T.png)

# 好的，但为什么是有序的？

中序遍历之所以如此有效，是因为它**总是**先打印最左边的东西，然后是根，然后是最右边的东西。正是我们希望子树的样子：根左侧的所有内容都打印到根的左侧，右侧的所有内容都打印到右侧。中序遍历自然允许这种关系，并且由于我们基于 nodeData 打印行并进行缩进，因此我们无需担心数据的长度。该节点可能有 20 个字符长，并且不会影响算法（尽管您可能会开始用完实际屏幕空间）。该算法不会在节点之间创建任何间距，但可以轻松实现，重要的是它们不会重叠。

只是为了证明给你看（不要相信我的话）这里是一个带有一些很长字符的例子

[![在此处输入图像描述](../Images/c1ba4d49dd6c69cd65fa8aff8cad0dc0.png)](https://i.stack.imgur.com/2VQU9.png)

如您所见，它只是根据数据的大小进行调整，没有重叠！只要你的屏幕够大。如果有人想出一种在 java 控制台中打印一条线的简单方法（我全神贯注）这将变得更加简单，对于几乎任何具有树基本知识的人来说都足够容易理解和使用，并且最好的部分是否没有严重重叠错误的风险。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-09-10T17:58:49.953

对于一个数组，我发现这更简洁。只需传入数组即可。可以改进以处理非常大的数字（长数字长度）。复制和粘贴 C++ :)

```
#include <math.h>
using namespace std;   
void printSpace(int count){
    for (int x = 0; x<count; x++) {
        cout<<"-";
    }
}
void printHeap(int heap[], int size){
    cout<<endl;
    int height = ceil(log(size)+1); //+1 handle the last leaves
    int width = pow(2, height)*height;
    int index = 0;
    for (int x = 0; x <= height; x++) { //for each level of the tree
        for (int z = 0; z < pow(2, x); z++) { // for each node on that tree level
            int digitWidth = 1;
            if(heap[index] != 0) digitWidth = floor(log10(abs(heap[index]))) + 1;
            printSpace(width/(pow(2,x))-digitWidth);
            if(index<size)cout<<heap[index++];
            else cout<<"-";
            printSpace(width/(pow(2,x)));
        }
        cout<<endl;
    }
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-11-21T01:23:55.470

进行有序遍历，在移动到兄弟姐妹之前下降到孩子。在每个级别，即当您下降到一个孩子时，增加缩进。在输出每个节点后，打印一个换行符。

一些伪代码。`Print`用你的树根打电话。

```
void PrintNode(int indent, Node* node)
{
    while (--indent >= 0)
        std::cout << " ";
    std::cout << node->value() << "\n";
}

void PrintNodeChildren(int indent, Node* node)
{
    for (int child = 0; child < node->ChildCount(); ++child)
    {
        Node* childNode = node->GetChild(child);
        PrintNode(indent, childNode);
        PrintNodeChildren(indent + 1, childNode);
    }
}

void Print(Node* root)
{
   int indent = 0;
   PrintNode(indent, root);
   PrintNodeChildren(indent + 1, root);  
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-03-01T18:38:54.303

这是以紧凑方式打印一般树形图的预购例程：

```
 void preOrder(Node* nd, bool newLine=false,int indent=0)
        {
                if(nd != NULL) {    
                        if (newLine && indent) {
                                std::cout << "\n" << std::setw(indent) << ' '
                        }  else if(newLine)
                                std::cout << "\n";
                        cout<< nd->_c;
                        vector<Node *> &edges=nd->getEdges();
                        int eSize=edges.size();
                        bool nwLine=false;
                        for(int i=0; i<eSize; i++) {
                                preOrder(edges[i],nwLine,indent+1);
                                nwLine=true;
                        }
                }
        }

int printGraph()
{
     preOrder(root,true);
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-11-21T01:39:52.397

从你的根源开始，数一数你剩下的孩子的数量。从左孩子的总数中，继续打印带有左孩子数量缩进的根。移动到树的下一层，左孩子的缩进数量减少，然后是右孩子的初始两个缩进。根据其级别和其父级减少左子级的缩进，其右兄弟级具有双缩进。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-07-31T22:34:12.560

这是我的代码。它打印得很好，可能不是完全对称。小说明：

*   第一个功能 - 逐级打印（根 lv -> 离开 lv）
*   第二个功能 - 距新行开头的距离
*   第三个功能 - 打印节点并计算两次打印之间的距离；

* * *

```
void Tree::TREEPRINT()
{
    int i = 0;
    while (i <= treeHeight(getroot())){
        printlv(i);
        i++;
        cout << endl;
    }
}

void Tree::printlv(int n){
    Node* temp = getroot();
    int val = pow(2, treeHeight(root) -n+2);
    cout << setw(val) << "";
    prinlv(temp, n, val);
}

void Tree::dispLV(Node*p, int lv, int d)
{
    int disp = 2 * d;
    if (lv == 0){
        if (p == NULL){

            cout << " x ";
            cout << setw(disp -3) << "";
            return;
        }
        else{
            int result = ((p->key <= 1) ? 1 : log10(p->key) + 1);
            cout << " " << p->key << " ";
            cout << setw(disp - result-2) << "";
        }
    }
    else
    {
        if (p == NULL&& lv >= 1){
            dispLV(NULL, lv - 1, d);
            dispLV(NULL, lv - 1, d);
        }
        else{
            dispLV(p->left, lv - 1, d);
            dispLV(p->right, lv - 1, d);
        }
    }
} 
```

输入：

```
50-28-19-30-29-17-42-200-160-170-180-240-44-26-27 
```

输出：[https ://i.stack.imgur.com/TtPXY.png](https://i.stack.imgur.com/TtPXY.png)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-03-29T02:13:04.197

我有一个更简单的代码............考虑一棵由结构节点组成的树

```
 struct treeNode{
  treeNode *lc;
  element data;
  short int bf;
  treeNode *rc;
}; 
```

树的深度可以使用

```
int depth(treeNode *p){
    if(p==NULL) return 0;
    int l=depth(p->lc);
    int r=depth(p->rc);
    if(l>=r)
        return l+1;
    else
        return r+1;
} 
```

下面的 gotoxy 函数将您的光标移动到所需的位置

```
void gotoxy(int x,int y)
{
printf("%c[%d;%df",0x1B,y,x);
} 
```

然后打印一棵树可以这样完成：

```
void displayTreeUpDown(treeNode * root,int x,int y,int px=0){
if(root==NULL) return;
gotoxy(x,y);
int a=abs(px-x)/2;
cout<<root->data.key;
displayTreeUpDown(root->lc,x-a,y+1,x);
displayTreeUpDown(root->rc,x+a,y+1,x);
} 
```

可以使用以下方法调用：

```
display(t,pow(2,depth(t)),1,1); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-06-08T23:28:59.247

此代码是用 C 编写的。它基本上会“逐层”打印树。

输出示例：[![三棵不同树的输出示例](../Images/abbd5e8a21601e2819928e0b2b552627.png)](https://i.stack.imgur.com/YjmBU.png)

函数 rb_tree_putchar_fd() 可以替换为在屏幕上打印的基本函数，例如`std::cout << ... ;`

SIZE_LEAF_DEBUG 应替换为 int，并且应为偶数。使用 6 方便。

函数 display() 有一个作用：总是在屏幕上打印 SIZE_LEAF_DEBUG 字符。我在示例中使用了 '[' + 4 个字符 + ']'。例如，这四个字符可以是 int 的字符串表示形式。

```
//#include "rb_tree.h"
#define SIZE_LEAF_DEBUG 6
int             rb_tree_depth(t_rb_node *root);

/*
** note:    This debugging function will display the red/black tree in a tree
**          fashion.
**          RED nodes are displayed in red.
**
** note:    The custom display func takes care of displaying the item of a node
**          represented as a string of SIZE_LEAF_DEBUG characters maximum,
**          padded with whitespaces if necessary. If item is null: the leaf is
**          represented as "[null]"...
**
** note:    the define SIZE_LEAF_DEBUG should be used by the display func.
**          SIZE_LEAF_DEBUG should be an even number.
**
** note:    Every node is represented by:
**          - either whitespaces if NULL
**          - or between squarred brackets a string representing the item.
*/

/*
**  int max;        //max depth of the rb_tree
**  int current;    //current depth while recursing
**  int bottom;     //current is trying to reach bottom while doing a bfs.
*/

typedef struct  s_depth
{
    int         max;
    int         current;
    int         bottom;
}               t_depth;

static  void    rb_tree_deb2(t_rb_node *node, t_depth depth, void (*display)())
{
    int size_line;
    int i;

    i = 0;
    size_line = (1 << (depth.max - ++depth.current)) * SIZE_LEAF_DEBUG;
    if (!node)
    {
        while (i++ < size_line)
            rb_tree_putchar_fd(' ', 1);
        return ;
    }
    if (depth.current == depth.bottom)
    {
        while (i++ < (size_line - SIZE_LEAF_DEBUG) / 2)
            rb_tree_putchar_fd(' ', 1);
        if (node->color == RB_RED)
            rb_tree_putstr_fd("\033[31m", 1);
        display(node->item);
        rb_tree_putstr_fd("\033[0m", 1);
        while (i++ <= (size_line - SIZE_LEAF_DEBUG))
            rb_tree_putchar_fd(' ', 1);
        return ;
    }
    rb_tree_deb2(node->left, depth, display);
    rb_tree_deb2(node->right, depth, display);
}

void    rb_tree_debug(t_rb_node *root, void (*display)())
{
    t_depth depths;

    rb_tree_putstr_fd("\n===================================================="\
            "===========================\n====================== BTREE DEBUG "\
            "START ======================================\n", 1);
    if (root && display)
    {
        depths.max = rb_tree_depth((t_rb_node*)root);
        depths.current = 0;
        depths.bottom = 0;
        while (++depths.bottom <= depths.max)
        {
            rb_tree_deb2(root, depths, display);
            rb_tree_putchar_fd('\n', 1);
        }
    }
    else
        rb_tree_putstr_fd("NULL ROOT, or NULL display func\n", 1);
    rb_tree_putstr_fd("\n============================== DEBUG END ==========="\
            "===========================\n==================================="\
            "============================================\n\n\n", 1);
} 
```

# html - 缓存控制：为什么通用的元标记不影响我的缓存控制？

> ID：13484948
> 
> 赞同：0
> 
> 时间：2012-11-21T01:17:40.573
> 
> 标签：html, caching, meta-tags, image-gallery, cache-control

我目前正在开发一个**在线画廊**，允许客户查看他们拍摄的图像并订购每种产品的不同产品（例如印刷品、画布、杯子等）。我的问题是，要浏览每张图片，他们必须从页面顶部的图片列表中进行选择，这会将他们重定向到他们的图片。但这只是一个**本地重定向**（例如 index.php?image=8、index.php?image=14 等），因此它会**缓存图像，导致重新加载的每个页面都具有相同的图像**，但会拉伸到新图像的方面。

我认为这是一个**缓存问题**，所以我使用 stackoverflow 寻找解决方案，并遇到了使用此元标记的建议，其中包括：

```
<meta http-equiv="Cache-control" content="no-cache"> 
```

不幸的是，它似乎仍在缓存我的图像（在歌剧、互联网浏览器中，但不是 chrome）

为什么我的浏览器不会选择这个标签？或者它没有做我期望它做的事情。谢谢大家的时间！

# javascript - 使用评论循环选项时敲除重置值

> ID：13484954
> 
> 赞同：0
> 
> 时间：2012-11-21T01:18:52.093
> 
> 标签：javascript, html, knockout.js, frontend

示例问题：http: [//jsfiddle.net/whxD3/12/](http://jsfiddle.net/whxD3/12/)

在淘汰赛中，我有一个选择框，我想在其中使用 optgroups。这个选择框可以根据您当前所在的“部分”进行反弹。我发现由于敲击执行其绑定顺序的方式，会出现以下问题：

**HTML：**

```
 <div>
        <a href="#" data-bind="click: page1">Section 1</a>
        <a href="#" data-bind="click: page2">Section 2</a>
    </div>
    <hr/>
    <div data-bind="with: activepage">
        <select data-bind="value: selectedItem">
            <optgroup label="Items">
                <!-- ko foreach: items()  -->
                <option data-bind="value: $data, text: $data"></option>
                <!-- /ko -->
            </optgroup>
            <optgroup label="Constants">
                <option value="foo">foo</option>
            </optgroup>
        </select>
        <br/><br/>
        Selected Item:&nbsp;<span data-bind="text: selectedItem"></span>
    </div> 
```

**JavaScript：**

```
 function SubPageViewModel(name) {
            this.name = name;
            this.items = ko.observableArray(["one", "two", "three"]);
            this.selectedItem = ko.observable();
        }

        function PageViewModel() {
            this.pages = [new SubPageViewModel("page1"), new SubPageViewModel("page2")];
            this.activepage = ko.observable(this.pages[0]);

            this.page1 = function() { this.activepage(this.pages[0]); }
            this.page2 = function() { this.activepage(this.pages[1]); }
        }

        ko.applyBindings(new PageViewModel()); 
```

*   因为我使用注释 foreach 来填充选择框，所以即使选择了一个项目，下拉的数据绑定选定值最初也是 null

*   当您离开当前部分并返回时，所选值将重置为 null。

我相信这种情况正在发生，因为在 foreach 注释填充所选框之前，knout 绑定了所选值，因此其值设置为 null。然后，一旦选择框被填充，就不会触发更新以更新所选值。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T01:57:32.113

您对导致问题的绑定顺序是正确的。不过，有一种方法可以强制后代绑定首先发生。您可以通过创建仅绑定后代的自定义绑定并在绑定之前添加该绑定来做到这一点`value`。

这是自定义绑定：

```
ko.bindingHandlers.bindContents = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        ko.applyBindingsToDescendants(bindingContext, element);
        return { controlsDescendantBindings: true };
    }
}; 
```

以下是您将如何使用它：

```
<select data-bind="bindContents: true, value: selectedItem"> 
```

这是您使用此（以及其他清理）的示例：http: [//jsfiddle.net/mbest/whxD3/14/](http://jsfiddle.net/mbest/whxD3/14/)

# java - “在处理名称序列时发现意外注释”

> ID：13484955
> 
> 赞同：4
> 
> 时间：2012-11-21T01:19:22.427
> 
> 标签：java, opennlp

我想对 OpenNLP 中的命名实体识别功能进行培训。我根据 [http://opennlp.apache.org/documentation/1.5.2-incubating/manual/opennlp.html#tools.namefind写了一段代码](http://opennlp.apache.org/documentation/1.5.2-incubating/manual/opennlp.html#tools.namefind)

我从一个尝试训练“数字”的简单示例开始，并在训练文件中标记了所有 \d+，如下所示：

```
In <START:number> 1941 <END>, Paramount Pictures produced a movie version of the play. 
```

代码是：

```
static String markedFile    = "C:/MyStuff/eclipse_workspace/OpenNlpTest/src/NameFinderTraining/en-ner-number-marked.train";
    static String modelFile     = "C:/MyStuff/eclipse_workspace/OpenNlpTest/src/NameFinderTraining/en-ner-number-marked.bin";

    @SuppressWarnings("deprecation")
    public static void main(String[] args) throws Exception 
    {
        Charset charset = Charset.forName("UTF-8");
        ObjectStream<String> lineStream =
                new PlainTextByLineStream(new FileInputStream( markedFile), charset);
        ObjectStream<NameSample> sampleStream = new NameSampleDataStream(lineStream);

        TokenNameFinderModel model;

        try 
        {
            model = NameFinderME.train("en", "person", sampleStream,
                    Collections.<String, Object>emptyMap(), 100, 5);
        }
        finally 
        {
            sampleStream.close();
        }

        BufferedOutputStream modelOut = null;
        try 
        {
            modelOut = new BufferedOutputStream(new FileOutputStream(modelFile));
            model.serialize(modelOut);
        } 
        finally 
        {
            if (modelOut != null) 
                    modelOut.close();      
        }   
    } 
```

我得到以下异常：

```
Computing event counts...  java.io.IOException: Found unexpected annotation while handling a name sequence: until the ###<START:number>### 1950 <END>s 
```

我的猜测是“数字”不在默认注释列表中。我应该怎么办？如果我需要“自定义注释”，有人可以给我一个例子。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-10-01T03:34:46.130

当标签没有被正确识别时，OpenNLP 会抛出这种异常。

尝试在标签之后/之前删除任何特殊字符。

```
<END>. is invalid.
<END> . is valid. 
```

# c++ - 为什么我不能在 Mac 上使用 C++ 为 x86_64 编译 SDL？

> ID：13484958
> 
> 赞同：2
> 
> 时间：2012-11-21T01:19:49.893
> 
> 标签：c++, xcode, sdl, codeblocks

我在 Mac Mini 上运行，2012 年末（最新），64 位，英特尔酷睿 i7 2.3 gHz 超线程 x86_64，或者说我的电脑。我暂时也在使用 Code::blocks，因为 Xcode 中的帮助（我更喜欢）更加稀疏，因为我使用的是 C++。也就是说，选择的编程语言是 C++，并且最终会扩展到 Objective-C++，但那是另一天的事了。

问题是这样的：我正在尝试编译一个程序，我不太确定它会做什么（它是一个模板，我们现在只是说它是一个游戏。）使用我从源代码编译的 SDL 1.2.15在我的 Mac 上。（我确实尝试过使用 SDLmain.m 和 SDL.h，但里面全是 Objective-C 代码，而且我在互联网上找不到关于是否可以用 C++ 编写这些代码的好信息，所以我放弃了。）我编译的源代码似乎工作得很好，Code::Blocks 可以编译它的教程就好了，它运行正常。但是，我似乎无法让我的游戏模板正常工作。它编译得很好，没有错误或警告，但链接器不这样做。现在，我真的不确定是什么`ld`确实，我只知道它将代码链接在一起。（有人想详细说明吗？）当 Code::Blocks 到达它的链接步骤时，它会失败并显示以下消息：

```
-------------- Clean: Debug in PyroLauncher ---------------

Cleaned "PyroLauncher - Debug"

-------------- Build: Debug in PyroLauncher ---------------

Compiling: App.cpp
Compiling: OnCleanup.cpp
Compiling: OnEvent.cpp
Compiling: OnInit.cpp
Compiling: OnLoop.cpp
Compiling: OnRender.cpp
Linking console executable: bin/Debug/PyroLauncher
Undefined symbols for architecture x86_64:
  "_SDL_GetError", referenced from:
      App::OnInit()     in OnInit.o
  "_SDL_Init", referenced from:
      App::OnInit()     in OnInit.o
  "_SDL_PollEvent", referenced from:
      App::OnExecute()     in App.o
  "_SDL_Quit", referenced from:
      App::OnCleanup()     in OnCleanup.o
  "_SDL_SetVideoMode", referenced from:
      App::OnInit()     in OnInit.o
  "_main", referenced from:
      start in crt1.10.6.o
     (maybe you meant: _SDL_main)
ld: symbol(s) not found for architecture x86_64
collect2: ld returned 1 exit status
Process terminated with status 1 (0 minutes, 0 seconds)
0 errors, 0 warnings 
```

这让我很困惑。我只知道 ld 找不到我的原生架构 x86_64。如果有人可以帮助我，将不胜感激。我认为解决方案可能是：（但是，我不知道该怎么做。） SDL 不是针对 64 位编译的，因此无法使用 64 位代码进行编译。SDL 是为 Objective-C 编译的，因此不能与 C++ 中的代码一起使用。我的代码是 32 位的，SDL 是 64 位的，它们不兼容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T01:36:37.073

你明白这里发生了什么吗？您的代码正在调用链接器 (ld) 找不到的函数。

两个主要的可能性是您需要在项目中包含更多文件，或者您需要定义一些宏。

在项目中搜索`SDL_GetError()`（和其他）的定义。如果你没有找到它，那么你需要找到声明它的文件并包含它。

如果你确实找到了它，那么它可能会被包围`#ifdef XXXX`，你必须`xxxx`在你的项目选项中定义（而不是在你的代码中）。`ifdef`大多数优秀的 IDE（我使用 NetBeans，使用 Cygwin 进行 C+ 开发）如果未定义an 的 then 内容，则会将其显示为灰色，因此您可以立即查看是否是这种情况。

顺便说一句，请查看 SDL 网站以获取安装说明。或者，您的下载文件可能有一个名为“Install”或“Ins​​tall.txt”的文件，也可能有一个 Makefile。如果是这样，那么在您的 IDE 中从现有的 makefile 中查找选项 Project/New ...。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T20:07:00.610

您需要将文件 SDLMain.m 和 SDLMain.h 添加到您的项目中。SDLMain 文件包含胶水代码，因此 SDL 代码可以在 Mac OS X 上运行。您还需要将 Cocoa 框架链接到您的项目。SDL 的 Mac 版本是用 Cocoa 编写的，因此您需要链接到 Cocoa。链接 Cocoa 框架并不强制您使用 Objective-C。您可以使用 C++ 编写游戏。

如果您正在寻找有关使用 Xcode 4 设置 SDL 的信息，请阅读以下文章：

[在 Xcode 4 中使用 SDL](http://meandmark.com/blog/2012/01/using-sdl-with-xcode-4/)

# eclipse - 你如何让新的编辑器在另一个屏幕上打开？

> ID：13484962
> 
> 赞同：3
> 
> 时间：2012-11-21T01:20:09.577
> 
> 标签：eclipse, multiple-monitors

我在工作中使用双显示器，我更喜欢将编辑器放在主屏幕上，而将 Eclipse 的其余部分放在笔记本电脑显示器上。

但是，当我打开一个新文件时，就是这样。我用 Cmd-Shift-R 打开一个文件，文件是在我的笔记本电脑显示器中打开的，而不是我拖到主屏幕的编辑器。

我觉得这有点烦人。有任何想法吗？

![图片显示了我的笔记本电脑显示器上一个新打开的窗口，它位于右侧](../Images/4a8525643a251e5ee7292a00e0907ea3.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T02:10:28.150

正在使用***Window -> New Window***功能吗？在这种情况下，这取决于您按下**Ctrl+Shift+R**时正在处理的窗口。

但是，如果您在两台显示器上仅拉伸一个 Eclipse 窗口，则“*打开资源*”对话框将在您的“显示器编号 1”中打开（这取决于您的图形配置：笔记本电脑 + 主机或主机 + 笔记本电脑）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-01T10:13:59.033

我发现更容易避免新的窗口菜单，只是将这些视图拖出 Eclipse。这将创建一个辅助窗口，但项目资源管理器链接到旧窗口，因此双击将在主窗口中打开文件。

我建议将所有内容保存为我通常称之为“Java 2 Windows”的新视角。这样，当我没有辅助屏幕时，我可以改变视角。

PS只是避免在离开eclipse时关闭辅助窗口。

# python - 已编译的 exe 中的 ImportError，但不在脚本中

> ID：13484963
> 
> 赞同：2
> 
> 时间：2012-11-21T01:20:11.317
> 
> 标签：python, python-2.7, pyodbc

我写了一个与数据库交互的小python脚本。我想创建脚本文件的 exe，然后将其发送给最终用户，而不是发送脚本文件本身。我正在使用 pytoexe 创建 exe 文件。

这就是我的 setup.py 文件现在的样子

```
from distutils.core import setup
import py2exe
setup(
    console=["Test.py"],
    zipfile = None,
    data_files=[("",
                 ["config.xml"]),
                ],
    name='Test',
    version='1.0.0',
    url='',
    license='',
    author='test user',
    author_email='',
    description='',
    #package_dir = {'': 'Lib'},
    py_modules =['pyodbc']
    #packages = ['pyodbc']
) 
```

我使用以下命令行运行脚本

> python setup.py py2exe --bundle 2

创建 exe 时，py2exe 显示此消息

> 以下模块似乎缺少 ['ElementC14N', 'pyodbc']

但是会生成exe。现在，每当我运行这个 exe 时，我都会收到这条消息

> Traceback（最近一次调用最后）：文件“Test.py”，第 4 行，在 ImportError：没有名为 pyodbc 的模块

如果我执行脚本，我的脚本运行良好。只是当我创建 exe 时，exe 不起作用并给我这个消息。

任何帮助，将不胜感激 。

注意：我在脚本文件中有以下导入

1.  将 xml.etree.ElementTree 导入为 ET
2.  导入pyodbc

py2exe 生成时出现的另一个错误 ["ElementC14N"] 是 exe，我相信是由于我正在从中读取设置的 xml 文件。解决该问题的任何帮助也值得称赞。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T03:11:54.300

谢谢你们 ....

这就是我所做的，它开始为我工作

```
options = {"py2exe":{"packages":"encodings",
                     "includes":["pyodbc",
                                 "datetime", "decimal"],
                     "bundle_files":2,
                     "optimize":2},}, 
```

# python - 为什么 mechanize 无法识别这些单选按钮？

> ID：13484964
> 
> 赞同：0
> 
> 时间：2012-11-21T01:20:15.827
> 
> 标签：python, python-2.7, mechanize, mechanize-python

我正在尝试在网站 (http://www.proxy-listen.de/Proxy/Proxyliste.html) 上获取表单的控件信息。（其实我是想填表，提交，得到代理服务器列表）。我正在使用此代码来读取表单元素：

```
 for control in br.form.controls:
     if not control.name:
         print " - (type) =", (control.type)
         continue  
     print " - (name, type, value) =", (control.name, control.type, br[control.name]) 
```

出于某种原因，mechanize 没有列出单选按钮（即“type”和“liststyle”，我通过源代码发现的），因此当我提交表单时，我神秘地回到了主页（http://www.代理-listen.de)。这是我的完整代码：

```
 #!/usr/bin/env python
 #-*- coding: utf-8 -*-

 import mechanize

 br = mechanize.Browser()
 br.addheaders = [("Content-type", "text/html, charset=utf-8")]
 br.addheaders = [('User-agent', 'Mozilla/5.0 (Windows NT 5.2; WOW64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.47 Safari/536.11')]
 br.set_handle_robots(False)

 url = 'http://www.proxy-listen.de/Proxy/Proxyliste.html'
 br.open(url)
 response1 = br.response()
 print response1

 ## Show me the forms of the website!
 for form in br.forms():
     print form

 ## Select form Nr 0, as this is the one and only form I am looking for
 br.select_form(nr=0)
 br.form.set_all_readonly(False)

 ## Fill the form
 br.form['filter_country'] = ['DE']
 br.form['filter_http_anon'] = ['3']
 br.form['filter_http_gateway'] = ['']
 br.form['filter_port'] = ['']
 br.form['filter_response_time_http'] = ['1']
 br.form['filter_timeouts1'] = ['10']
 br.form['proxies'] = ['300']

 ## I already tried adding two radio buttons manually, but even this doesnt help!
 '''
 br.form.new_control('radio','liststyle',{'value': ['info', 'leech']})
 br.form.new_control('radio','type',{'value':['http', 'https', 'socks4', 'socks5']})
 br.form.fixup()
 br.form['liststyle'] = ['leech']
 br.form['type'] = ['http']
 '''

 ## just to double-check the values, loop through controls!
 for control in br.form.controls:
     if not control.name:
         print " - (type) =", (control.type)
         continue  
     print " - (name, type, value) =", (control.name, control.type, br[control.name])

 resp2 = br.submit()
 page = resp2.read()
 print page 
```

我已经用萤火虫检查了与 POST 请求一起发送的变量，单选按钮并不奇怪地是 POST 请求的一部分。

任何指针都非常感谢！非常感谢。

# python - Beautifulsoup 在 while 循环中调用时返回相同的结果

> ID：13484974
> 
> 赞同：2
> 
> 时间：2012-11-21T01:22:07.817
> 
> 标签：python, beautifulsoup

我是 python 新手，正在尝试编写一个**爬虫**来获取页面上的所有链接，并带有多个分页。我在 while 循环中调用以下代码。

```
page = urllib2.urlopen(givenurl,"",10000)

soup = BeautifulSoup(page, "lxml")

linktags = soup.findAll('span',attrs={'class':'paginationLink pageNum'}) 

page.close()

BeautifulSoup.clear(soup)

return linktags 
```

它总是返回我传递的第一个 url 的结果。难道我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T01:38:13.997

@uncollected 可能在评论中为您提供了正确的答案，但我想对此进行扩展。

如果您调用的是精确代码，但嵌套在一个`while`块中，它将立即返回第一个结果。你可以在这里做两件事。

*我不确定你是如何`while`在你自己的上下文中使用的，所以我在`for`这里使用了一个循环。*

扩展结果列表，并返回整个列表

```
def getLinks(urls):
    """ processes all urls, and then returns all links """
    links = []
    for givenurl in urls:
        page = urllib2.urlopen(givenurl,"",10000)
        soup = BeautifulSoup(page, "lxml")
        linktags = soup.findAll('span',attrs={'class':'paginationLink pageNum'}) 
        page.close()
        BeautifulSoup.clear(soup)
        links.extend(linktags)
        # dont return here or the loop is over

    return links 
```

或者，您可以[使用`yield`关键字](http://docs.python.org/2/reference/simple_stmts.html#the-yield-statement)将其设为生成器，而不是返回。生成器将返回每个结果并暂停直到下一个循环：

```
def getLinks(urls):
    """ generator yields links from one url at a time """
    for givenurl in urls:
        page = urllib2.urlopen(givenurl,"",10000)
        soup = BeautifulSoup(page, "lxml")
        linktags = soup.findAll('span',attrs={'class':'paginationLink pageNum'}) 
        page.close()
        BeautifulSoup.clear(soup)
        # this will return the current results,
        # and pause the state, until the the next
        # iteration is requested    
        yield linktags 
```

# jquery - jQuery Moonwalk 缓动

> ID：13484976
> 
> 赞同：0
> 
> 时间：2012-11-21T01:22:10.437
> 
> 标签：jquery, animation, jquery-animate, easing

我正在尝试实现与此类似的缓动：

![图形](../Images/bdb8030173d71e1c8cda72b85bddfb98.png)

我正在尝试制作一个“月球漫步”的 HTML5 动画，我注意到月球漫步如何有速度增加的时期和速度减慢的时期。

我试图在没有正确结果的情况下使用 Sin 和 Cos 方程进行缓动。

为了将其实现为 jQuery 缓动，我需要什么等式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T01:35:46.453

`y = sin(x) + x`看起来像那个图表。[阴谋](http://www.wolframalpha.com/input/?i=graph+y+%3D+sin%28x%29+%2B+x)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-15T19:38:02.790

```
y = a * sin(f * 2*PI * x) + x 
```

`a = 0.05`当和时，此等式与您的草图相匹配`f = 3`。

*   `a`控制波的幅度。
*   `f`是频率，即 和 之间的周期`0`数`1`。

我制作了一个 Desmos 图表，您可以在其中使用`a`和`c`使用滑块：

[https://www.desmos.com/calculator/hpn1oxtwvt](https://www.desmos.com/calculator/hpn1oxtwvt)

# jquery - 垂直 div 交换良好，但相应 div 的内容重叠或留下空白

> ID：13484980
> 
> 赞同：0
> 
> 时间：2012-11-21T01:22:51.300
> 
> 标签：jquery

在父容器 div 中垂直对齐的 div 之间交换工作正常；但是只有在之前已经存在的div有足够的空间时，才在新位置交换移动的div之后；否则它会与下一个 div 重叠。同样，如果新交换的 div 获得了一个新位置，该位置之前的 div 占用的空间更多，则剩下一个空白。

交换后如何避免重叠和白色间距？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T03:40:00.980

我猜你正在为 div 使用绝对定位。是这样吗？如果是，请更改为相对定位，它应该可以工作

# html - HTML 在 textarea 中显示换行符

> ID：13484985
> 
> 赞同：29
> 
> 时间：2012-11-21T01:23:14.243
> 
> 标签：html, textarea, line-breaks

我现在已经通过几种方式问过这个问题，但仍然没有得到答案。

当您在包含换行符的文本区域中捕获 asci 文本时，当您按回车时，它似乎会以换行符的形式插入不可见字符。换行符的格式似乎是 \r 用于返回或 \n 用于换行。这些字符在文本中不可见，但在某处。

但是，当我将此代码放在 textarea 中时，我无法让它显示换行符。事实上，我找不到任何放置在 textarea 标签之间的代码显示换行符。

有人可以展示一种在文本区域中显示换行符的方法，即。

```
<textarea>first line <some code> second line </textarea> 
```

我真的尝试了你能想象到的一切。例如，如果我尝试`<textarea> first line "\r\n" second line</textarea>`它只会显示

```
`firstline "\r\n"` second line 
```

注意：任何涉及的内容`<br>`都不会解决这个问题，因为这不是关于 html，而是在 textarea 框中显示的纯文本。

感谢您提供在 textarea 中显示换行符的建议代码。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-11-21T01:35:22.927

好吧，如果您通过纯 HTML 执行此操作，那么您可以通过以下两种方式之一执行此操作。只需按回车键或使用 ASCII 字符添加行`&#013; &#010;`

[jsFiddle](http://jsfiddle.net/dhRHq/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-05-25T10:24:37.157

如果您使用的是**javascript**，则可以使用 textarea 元素[值 Property](https://www.w3schools.com/jsref/prop_text_value.asp)。

```
var tb = document.getElementById("tb");

var newLine = "\r\n";

var text = "Output: " + newLine + "-------------------" + 
                        newLine + "line 1:	" + 
                        newLine + "line 2:	";

tb.value = text;
//console.log(text);
```

```
<textarea id="tb" rows=5>
Output: &#13;&#10;-------------
</textarea>
```

[**在 JSFiddle 上运行它**](http://jsfiddle.net/dhRHq/209/)

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-11-21T01:35:14.677

我不确定能理解你的问题。

如果你想在你的`<textarea/>`

```
first line
second line 
```

你应该这样写：

```
<html>
    <head>
        <title></title>
    </head>
    <body>
        <textarea rows="4" cols="40">
first line
second line
        </textarea>
    </body>
</html> 
```

在 PHP 中你应该这样写

```
<html>
    <head>
        <title></title>
    </head>
    <body>
        <textarea rows="4" cols="40"><?php echo "first line\r\nsecond line" ?></textarea>
    </body>
</html> 
```

*确保字符串在“而不是”之间*

# android - Android：流式传输相机数据并将其写入服务器

> ID：13484990
> 
> 赞同：7
> 
> 时间：2012-11-21T01:23:36.877
> 
> 标签：android, node.js, video, tcp, mpeg-4

我将网络摄像头数据流式传输到我的客户端。

我可以通过监听（'data'）看到数据正在到达。但是，当我创建它时，我无法查看它，它可能是垃圾数据或缺少一些标题。VLC 无法播放。

我的下一步是让它实时流式传输到浏览器。

我究竟做错了什么？

```
net = require('net');
fs = require('fs');

// Start a TCP Server
net.createServer(function (socket) {    
    console.log("client connected");
    var file = fs.createWriteStream("temp.mp4");
    socket.pipe(file, {end: false});

    socket.on('end', function(){
        console.log("ended");
    });
}).listen(5000); 
```

我测试了它是否真的捕获了视频输出：

```
$ mediainfo temp.mp4 

General
Complete name                            : temp.mp4
Format                                   : H.263
Format version                           : H.263
File size                                : 126 KiB

Video
Format                                   : H.263
Width                                    :  pixel0
Height                                   :  pixel0
Color space                              : YUV
Chroma subsampling                       : 4:2:0
Bit depth                                : 8 bits
Compression mode                         : Lossy 
```

这是以下用于设置的Android代码`mediaRecorder`（假设套接字已连接，没问题）

```
 mediaRecorder.setAudioSource(MediaRecorder.AudioSource.CAMCORDER);
    mediaRecorder.setVideoSource(MediaRecorder.VideoSource.CAMERA);
    mediaRecorder.setOutputFormat(MediaRecorder.OutputFormat.DEFAULT);
    mediaRecorder.setVideoSize(320, 240);
    mediaRecorder.setVideoEncoder(MediaRecorder.VideoEncoder.DEFAULT);
    mediaRecorder.setAudioEncoder(MediaRecorder.AudioEncoder.DEFAULT);

    ParcelFileDescriptor pfd = ParcelFileDescriptor.fromSocket(socket);     
    mediaRecorder.setOutputFile(pfd.getFileDescriptor());

    mediaRecorder.setMaxDuration(5000);
    mediaRecorder.setMaxFileSize(5000000); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T04:39:23.007

有一些开源项目可以解决这个问题，例如[Spydroid](http://code.google.com/p/spydroid-ipcamera/)（浏览器/VLC 流式传输）和[Android IP Camera](http://code.google.com/p/ipcamera-for-android/)（浏览器流式传输）。您的实现似乎类似于 Spydroid，所以也许您可以调整它的一些代码。

核心问题是`MediaRecorder`将原始视频帧写入套接字。它需要等到视频完成才能写入标题，但它们需要出现在文件的开头。由于套接字不可查找，因此无法将标头写入正确的位置。上面链接的项目通过将流打包成 RTSP（Spydroid）或将一系列静止图像“流式传输”到浏览器（Android IP 摄像机）来解决这个问题。

# xcode - 如何为外部构建项目启用 Xcode 重构选项？

> ID：13484996
> 
> 赞同：3
> 
> 时间：2012-11-21T01:24:10.747
> 
> 标签：xcode, macos, embedded, xcode4.5

我想使用 XCode 作为开发 AVR 代码的 IDE。我做了以下

1）创建新项目

2）选择外部构建系统

3）表示我希望它被制作，并告诉它不要“在环境中传递构建设置”

*4) 将我的.c/* .h/Makefile复制到我创建项目的同一目录中

5) 将*.c/* .h 文件添加到项目/目标中

6) 验证我可以从命令行和 Xcode 构建（制作）

但我不能使用任何重构菜单选项，或跳转到/显示选项。似乎没有符号信息。除了使用外部构建系统的简单 C 编辑器之外，没有其他方法可以使用 Xcode 吗？？？？

如果不是，那么嵌入式开发就是失败。请告诉我我错了:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T07:12:36.837

我找到了解决方法/解决方案。创建第二个名为“Dummy”或类似名称的目标，它基于 C 类型的命令行工具模板。选择所有 .c 文件并在左侧栏的“Targets”窗格中，检查新的 Dummy 项目（或者，如果选项发生变化，就像它们似乎经常发生的那样，做任何必要的手势来制作 Dummy 取决于您的 C 文件）。

它将创建一个 Dummy 目录和几个其他 Dummy 文件，您可以根据需要将其删除。您永远不会费心构建“虚拟”，事实上，如果它是一个具有单独工具链的嵌入式项目，那么它几乎 100% 都不会编译为 OSX 的命令行工具。:)

显然 XCode 需要这种间接提示来知道您的 .c 文件确实是真正的 C 文件，并且可以这样解析/自省。

当您添加外部构建系统可能会自动看到的新 .c 文件时，请确保将它们作为 Dummy 目标的依赖项包含在内。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-07-08T03:17:08.267

我能够使用 XCode 6.1 让它工作。就我而言，我使用的是 C++，但它也应该与 C 一起使用，因为我的一些 C++ 文件会调用 C 函数。这是我所做的：

1.  使用以下命令创建一个虚拟目标：File->New->Target
2.  对于模板选择：OS X->Application->Command Line Tool
3.  点击下一步
4.  填写产品名称等
5.  为语言字段选择 C++。
6.  单击完成。

返回 Project Navigator 窗格：

1.  右键单击新的“虚拟”目标
2.  选择：将文件添加到“您的项目名称”
3.  浏览以选择要添加的目录/文件。

Once the files were added to the Dummy target, I could then open a file under my normal target, right click on a method and Refactor, Jump To Definition, etc.