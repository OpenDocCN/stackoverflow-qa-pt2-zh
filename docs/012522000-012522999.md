# StackOverflow 问答 12522000-12522999

# c# - 可选择根据其运行时值序列化属性

> ID：12522000
> 
> 赞同：17
> 
> 时间：2012-09-20T22:44:37.583
> 
> 标签：c#, .net, json, serialization, json.net

从根本上说，我想根据序列化时的值从生成的 Json 中包含或省略一个属性。

更具体地说，我有一个类型，它知道是否已为其分配了一个值，并且我只想序列化该类型的属性，如果*已为其*分配了某些东西（因此我需要在运行时检查该值）。我试图让我的 API 更容易检测“具有默认值”和“根本没有指定”之间的区别。

自定义 JsonConverter 似乎还不够；我试过了，我相信在调用转换器之前属性名称已经序列化。就我而言，我什至想省略属性名称。

我看过扩展 DefaultContractResolver 但 CreateProperty 和 CreateProperties （返回 JsonProperty 序列化元数据）只采用被序列化的类型，所以我无法检查实例本身。一般来说，我在 DefaultContractResolver 上看不到任何允许我控制实例是否被序列化的*东西；*也许我错过了。

我还想也许我需要为我的类型创建一个返回自定义 JsonObjectContract 的 ContractResolver。但是，我在 JsonObjectContract 上没有看到任何基于实例做出决策的东西。

有没有实现我的目标的好方法？我只是缺少一些简单的东西吗？非常感谢您提供的任何帮助。由于 Json.NET 是如此可扩展，我认为这不会太难。但我开始认为我在这里杂草丛生。:)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-22T01:31:39.460

好的，在 Json.NET 源代码中挖掘了一段时间后，我终于得到了这个工作，它甚至会尊重 Json.NET 支持的 ShouldSerialize* 和 *Specified 成员。请注意：这肯定会变成杂草。

所以我意识到 DefaultContractResolver.CreateProperty 返回的 JsonProperty 类具有 ShouldSerialize 和 Converter 属性，这允许我指定*属性*实例是否应该实际序列化，如果是，*如何*执行。

不过，反序列化需要一些不同的东西。DefaultContractResolver.ResolveContract 默认情况下，对于自定义类型，将返回一个带有 null Converter 属性的 JsonObjectContract。为了正确反序列化我的类型，当合同适用于我的类型时，我需要设置 Converter 属性。

这是代码（删除了错误处理/等以使事情尽可能小）。

一、需要特殊处理的类型：

```
public struct Optional<T>
{
    public readonly bool ValueProvided;
    public readonly T Value;

    private Optional( T value )
    {
        this.ValueProvided = true;
        this.Value = value;
    }

    public static implicit operator Optional<T>( T value )
    {
        return new Optional<T>( value );
    }
} 
```

*在我们知道它应该被序列化之后*，有一个转换器会正确地序列化它：

```
public class OptionalJsonConverter<T> : JsonConverter
{
    public static OptionalJsonConverter<T> Instance = new OptionalJsonConverter<T>();

    public override void WriteJson( JsonWriter writer, object value, JsonSerializer serializer )
    {
        var optional = (Optional<T>)value; // Cast so we can access the Optional<T> members
        serializer.Serialize( writer, optional.Value );
    }

    public override object ReadJson( JsonReader reader, Type objectType, object existingValue, JsonSerializer serializer )
    {
        var valueType = objectType.GetGenericArguments()[ 0 ];
        var innerValue = (T)serializer.Deserialize( reader, valueType );
        return (Optional<T>)innerValue; // Explicitly invoke the conversion from T to Optional<T>
    }

    public override bool CanConvert( Type objectType )
    {
        return objectType == typeof( Optional<T> );
    }
} 
```

最后，也是最冗长的，这里是插入钩子的 ContractResolver：

```
public class CustomContractResolver : DefaultContractResolver
{
    // For deserialization. Detect when the type is being deserialized and set the converter for it.
    public override JsonContract ResolveContract( Type type )
    {
        var contract = base.ResolveContract( type );
        if( contract.Converter == null && type.IsGenericType && type.GetGenericTypeDefinition() == typeof( Optional<> ) )
        {
            // This may look fancy but it's just calling GetOptionalJsonConverter<T> with the correct T
            var optionalValueType = type.GetGenericArguments()[ 0 ];
            var genericMethod = this.GetAndMakeGenericMethod( "GetOptionalJsonConverter", optionalValueType );
            var converter = (JsonConverter)genericMethod.Invoke( null, null );
            // Set the converter for the type
            contract.Converter = converter;
        }
        return contract;
    }

    public static OptionalJsonConverter<T> GetOptionalJsonConverter<T>()
    {
        return OptionalJsonConverter<T>.Instance;
    }

    // For serialization. Detect when we're creating a JsonProperty for an Optional<T> member and modify it accordingly.
    protected override JsonProperty CreateProperty( MemberInfo member, MemberSerialization memberSerialization )
    {
        var jsonProperty = base.CreateProperty( member, memberSerialization );
        var type = jsonProperty.PropertyType;
        if( type.IsGenericType && type.GetGenericTypeDefinition() == typeof( Optional<> ) )
        {
            // This may look fancy but it's just calling SetJsonPropertyValuesForOptionalMember<T> with the correct T
            var optionalValueType = type.GetGenericArguments()[ 0 ];
            var genericMethod = this.GetAndMakeGenericMethod( "SetJsonPropertyValuesForOptionalMember", optionalValueType );
            genericMethod.Invoke( null, new object[]{ member.Name, jsonProperty } );
        }
        return jsonProperty;
    }

    public static void SetJsonPropertyValuesForOptionalMember<T>( string memberName, JsonProperty jsonProperty )
    {
        if( jsonProperty.ShouldSerialize == null ) // Honor ShouldSerialize*
        {
            jsonProperty.ShouldSerialize =
                ( declaringObject ) =>
                {
                    if( jsonProperty.GetIsSpecified != null && jsonProperty.GetIsSpecified( declaringObject ) ) // Honor *Specified
                    {
                        return true;
                    }                    
                    object optionalValue;
                    if( !TryGetPropertyValue( declaringObject, memberName, out optionalValue ) &&
                        !TryGetFieldValue( declaringObject, memberName, out optionalValue ) )
                    {
                        throw new InvalidOperationException( "Better error message here" );
                    }
                    return ( (Optional<T>)optionalValue ).ValueProvided;
                };
        }
        if( jsonProperty.Converter == null )
        {
            jsonProperty.Converter = CustomContractResolver.GetOptionalJsonConverter<T>();
        }
    }

    // Utility methods used in this class
    private MethodInfo GetAndMakeGenericMethod( string methodName, params Type[] typeArguments )
    {
        var method = this.GetType().GetMethod( methodName, BindingFlags.NonPublic | BindingFlags.Public | BindingFlags.Static );
        return method.MakeGenericMethod( typeArguments );
    }

    private static bool TryGetPropertyValue( object declaringObject, string propertyName, out object value )
    {
        var propertyInfo = declaringObject.GetType().GetProperty( propertyName, BindingFlags.NonPublic | BindingFlags.Public | BindingFlags.Instance );
        if( propertyInfo == null )
        {
            value = null;
            return false;
        }
        value = propertyInfo.GetValue( declaringObject, BindingFlags.GetProperty, null, null, null );
        return true;
    }

    private static bool TryGetFieldValue( object declaringObject, string fieldName, out object value )
    {
        var fieldInfo = declaringObject.GetType().GetField( fieldName, BindingFlags.NonPublic | BindingFlags.Public | BindingFlags.Instance );
        if( fieldInfo == null )
        {
            value = null;
            return false;
        }
        value = fieldInfo.GetValue( declaringObject );
        return true;
    }
} 
```

我希望这对其他人有所帮助。如果有任何不清楚的地方或者看起来我错过了什么，请随时提出问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-21T01:59:56.617

因为您要求根据属性的值执行此操作，所以您可以将数据放入字典中。您可以排除将值添加到字典中。下面是一个如何从对象中获取数据的简单示例。

```
public class Class1
{
    public string Name { get; set; }
}

[TestFixture]
public class Tests
{
    [Test]
    public void ConvertTest()
    {
        var dictionary = new Dictionary<string, object>();
        var @class = new Class1 { Name = "Joe" };

        var propertyInfos = typeof (Class1).GetProperties();

        foreach (PropertyInfo propertyInfo in propertyInfos)
        {
            dictionary.Add(propertyInfo.Name, propertyInfo.GetValue(@class, BindingFlags.GetProperty, null, null, null));
        }

        var serializeObject = JsonConvert.SerializeObject(dictionary);
        var o = JsonConvert.SerializeObject(@class);

        Console.WriteLine(serializeObject);
        Console.WriteLine(o);

        var class1 = JsonConvert.DeserializeObject<Class1>(serializeObject);
        Console.WriteLine(class1.Name);
    }
} 
```

# javascript - 重复使用 HTML5 Audio 对象重复播放相同的 mp3 音效

> ID：12522001
> 
> 赞同：5
> 
> 时间：2012-09-20T22:44:37.897
> 
> 标签：javascript, html, google-chrome, audio, html5-audio

在一个简单的 HTML5/WebGL 应用程序中，我想偶尔播放声音效果。

目前我在一个构造函数中：

```
this.audio = new Audio('audio/zeep.mp3'); 
```

然后，我想播放文件：

```
this.audio.play(); 
```

它第一次有效，但第二次播放失败。我已经尝试将其重置`currentTime`为零，也尝试重置为 0.1。既不工作：

```
this.audio.currentTime = 0;
this.audio.play(); 
```

如果我`Audio`每次想要播放它时都重新创建对象，Chrome 的网络选项卡会显示它正在通过网络重新获取文件，而不是从缓存中提供它。

请注意，我不需要相同的音效同时播放多次。这种声音将不常见。

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-11T17:33:31.123

# 音频元素 无法再次播放。

音频文件的 http 标头需要具有**Content-Range**，例如：

`Content-Range:bytes 0-5151/5152`

它是为寻求而设计的。

如果需要并发，一个音频元素不能同时播放。使用：

`var copy = audio.cloneNode(); copy.play();`

# ruby-on-rails - Nokogiri::XML 和 Nokogiri.parse 之间的区别？

> ID：12522003
> 
> 赞同：0
> 
> 时间：2012-09-20T22:44:59.053
> 
> 标签：ruby-on-rails, ruby, nokogiri

两者都`puts Nokogiri::XML(xml)`返回`puts Nokogiri.parse(xml)`相同的 XML。
是的，它们都返回 XML：

```
 > Nokogiri::XML(xml).class
 => Nokogiri::XML::Document  
 > Nokogiri.parse(xml).class
 => Nokogiri::XML::Document 
```

然而，在比较返回值时，我得到：

```
 > Nokogiri.parse(xml) === Nokogiri::XML(xml)
 => false 
 > Nokogiri.parse(xml) == Nokogiri::XML(xml)
 => false 
```

`Nokogiri::XML`和有什么区别`Nokogiri.parse`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T22:50:03.330

`Nokogiri.parse`只是尝试检测传递给它的字符串是否是 HTML，然后使用预设的 ParseOption创建/返回一个`Nokogiri::XML`或实例：`Nokogiri::HTML`

```
def parse string, url = nil, encoding = nil, options = nil
  doc =
    if string.respond_to?(:read) ||
      string =~ /^\s*<[^Hh>]*html/i # Probably html
      Nokogiri.HTML(
        string,
        url,
        encoding, options || XML::ParseOptions::DEFAULT_HTML
      )
    else
      Nokogiri.XML(string, url, encoding,
                    options || XML::ParseOptions::DEFAULT_XML)
    end
  yield doc if block_given?
  doc
end 
```

[https://github.com/sparklemotion/nokogiri/blob/master/lib/nokogiri.rb#L66](https://github.com/sparklemotion/nokogiri/blob/master/lib/nokogiri.rb#L66)

比较返回 false 因为 == 不比较对象的内容，只是它们是不同的实例：

```
>> Nokogiri.parse(xml) == Nokogiri.parse(xml)
=> false 
```

# core-location - iOS 6 和定位服务不工作

> ID：12522004
> 
> 赞同：7
> 
> 时间：2012-09-20T22:45:15.463
> 
> 标签：core-location, cllocationmanager, ios6

我已将我的更新`iOS SDK`到版本 6。之后我编译了我的应用程序（在 中运行良好`iOS 4 & iOS 5`），但现在位置服务不起作用。我`delegate`没有收到任何更新，上方的位置箭头也没有出现......我正在像往常一样启动服务：

```
[locationManager startUpdatingLocation]; 
```

我的项目是非 ARC。

怎么了？这真让我抓狂...

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-08T12:20:51.360

只需将`pausesLocationUpdatesAutomatically`Location Manager 的属性设置为`NO`。这是 IOS 6 的一项新功能，可在应用程序在后台运行时禁用位置更新。此属性的默认值为`YES`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-26T15:25:37.490

确保项目的 .plist 文件中有 CFBundleDisplayName。添加该密钥为我修复了它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-20T23:38:21.880

这是iOS6中的一个变化：

您需要实现[locationManager:didUpdateLocations:](https://developer.apple.com/library/ios/#documentation/CoreLocation/Reference/CLLocationManagerDelegate_Protocol/CLLocationManagerDelegate/CLLocationManagerDelegate.html#//apple_ref/occ/intfm/CLLocationManagerDelegate/locationManager%3adidUpdateLocations%3aAlso)而不是 locationManager:didUpdateToLocation:fromLocation 以便在位置更新时得到通知。

您还应该阅读有关[startUpdatingLocation](https://developer.apple.com/library/ios/#documentation/CoreLocation/Reference/CLLocationManager_Class/CLLocationManager/CLLocationManager.html#//apple_ref/occ/instm/CLLocationManager/startUpdatingLocation)的文档。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-21T01:23:18.693

就我而言，我的位置管理器属于不同的类，我从主控制器调用这个类。这不起作用，并且没有调用 didUpdateLocations。

```
//
//  LocationServices.h
// 

#import <Foundation/Foundation.h>
#import <CoreLocation/CoreLocation.h>

@interface LocationServices : NSObject <CLLocationManagerDelegate> {
    CLLocationManager *locationManager;

}

@property (nonatomic, retain) CLLocationManager *locationManager;

- (void)startLocationServices;

@end

//  LocationServices.m
#import "LocationServices.h"

@implementation LocationServices 
@synthesize locationManager, currentLocation;

- (void)startLocationServices {
    locationManager = [[CLLocationManager alloc] init];
    locationManager.delegate = self;
    locationManager.pausesLocationUpdatesAutomatically = NO;
    locationManager.desiredAccuracy = kCLLocationAccuracyNearestTenMeters;

    if ([CLLocationManager locationServicesEnabled]) {
        [locationManager startUpdatingLocation];

    } else {
        NSLog(@"Location services is not enabled");
    }
}

////////////////////////////////////////////////
- (void)locationManager:(CLLocationManager *)manager
     didUpdateLocations:(NSArray *)locations {
    CLLocation* location = [locations lastObject];
    NSLog(@"Updated: latitude %+.6f, longitude %+.6f\n",
          location.coordinate.latitude,
          location.coordinate.longitude);
}
@end

// Main controller
- (void)viewDidLoad {   
    [super viewDidLoad];

.....

LocationServices *locationSerices = [[LocationServices alloc]init];
[locationSerices startLocationServices];
......
} 
```

上面的代码不起作用。为什么？我不知道……当你花这么多时间试图做一件本应简单的事情时，你很容易失去兴趣。iOS 是一个非常复杂且不友好的编程环境。做一件事有很多方法，只有一种有效，你不能混合搭配而不引入问题。您必须按照书本做所有事情，否则您将一无所获。甚至没有暗示你做错了什么......令人沮丧......

相反，当我在主控制器中实现 locationManager:(CLLocationManager *)manager didUpdateLocations: 时一切正常

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-16T19:19:09.143

该问题似乎在 IOS 6.1 Beta2 中得到解决 - [http://www.youtube.com/watch?v=aFZR0eMUV74](http://www.youtube.com/watch?v=aFZR0eMUV74)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-27T02:29:24.533

设置 CFBundleDisplayName 为我解决了这个问题。从未调用过相同的位置更新，只需设置 info.plist 参数即可开始工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-28T12:09:54.137

我已经尝试了 plist 文件中的所有内容、清理、重建、新目标、配置等，等等。没有任何效果。但最后我已经修好了。我必须从头开始创建一个新的 Xcode 4.5 项目，重新配置它，逐个文件和逐个框架地手动添加框架。似乎我的旧 XCode 项目在内部与上一个 XCode 不兼容。我在这里写这个是因为也许它可以节省某人接下来 10 个小时的工作。

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2012-09-22T18:12:14.830

我在这里是不是太简单了？在隐私下，位置看起来和以前的问题一样。有什么大惊小怪的？

# java - Java Swing Frame 在打开时崩溃？

> ID：12522006
> 
> 赞同：2
> 
> 时间：2012-09-20T22:45:26.133
> 
> 标签：java, swing, crash

我正在用java编写一个国际象棋游戏，目前我正在构建一个基本界面。它只是一个 8x8 的按钮阵列，将显示在一个窗口中。我已经为这些按钮编写了代码，并且已经让电路板正确显示。但是，当我将它与游戏的其余部分连接时，游戏窗口在运行时崩溃，我必须强制退出 Java 应用程序。这是我的代码：

```
package Chess_Game; 
import javax.swing.SwingUtilities;
import Chess_Interface.Iboard;

public class Game_Tester 
{
    public static void main(String[] args)
    {
        SwingUtilities.invokeLater(new Runnable() 
        {
            public void run() 
            {
                    Game G = new Game();
                    Iboard I = new Iboard(G.getBoard().getArray(), G.getSides());
                    I.setVisible(true);
                    while(!(G.isGameOver()))
                    {
                        boolean redo = true;
                        while(redo)
                        {
                            int row = 0; 
                            int col = 0; 
                            int nRow = 0; 
                            int nCol = 0;
                            System.out.println("Click the piece you want to move.");
                            while(!(I.getBool())){}
                            if(I.getBool())
                            {
                                row = I.getRow();
                                col = I.getCol();
                                I.setBool(false);
                            }
                            System.out.println("Click the place you want to move to.");
                            while(!(I.getBool())){}
                            if(I.getBool())
                            {
                                nRow = I.getRow();
                                nCol = I.getCol();
                                I.setBool(false);
                            }
                            if(G.canMove(row, col, nRow, nCol))
                            {
                                G.move(row, col, nRow, nCol, I);
                                redo = false;
                            }
                            else
                            {
                                System.out.println("You cant move there! Try again!");
                            }
                        }
                        I.updateBoard(G.getBoard().getArray(), G.getSides());
                    }
            }
        });
    }
} 
```

当我注释掉主 while 循环（以及其中的所有内容）时，板子会正确显示，我认为问题出在里面的某个地方，但我一直找不到它。我也在网上寻找类似的游戏循环问题，但所有这些问题都是针对涉及帧速率和跨 java 摆动框架的移动的游戏，这在我的代码中不存在。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-20T22:52:05.847

您有几个循环，例如

```
while(!(I.getBool())){} 
```

`I`如果没有按预期响应，它可能会永远运行。您可以首先在这些循环中打印一些内容，然后在以下块`if(I.getBool()){...}`中查看您的应用程序在什么时候卡住了。

像这样在循环中检查用户界面不是好的做法。最好使用[监听器](http://docs.oracle.com/javase/tutorial/uiswing/events/index.html)来响应用户界面。

使用 也不会在 Swing 线程上运行主应用程序`SwingUtilities.invokeLater(new Runnable()`，即使它避免了从另一个线程更新 GUI 的潜在问题。

事实上，这可能是您的根本问题，因为像这样在 Swing 线程（用于运行 GUI 的线程）上运行主应用程序循环可能会阻止 GUI 正确响应。您正在将一个任务（整个游戏）放到 GUI 的队列中，但该任务永远不会完成`while(!(G.isGameOver()))`。

# javascript - 尝试在 Javascript 中正确显示 Web 图像

> ID：12522007
> 
> 赞同：0
> 
> 时间：2012-09-20T22:45:41.740
> 
> 标签：javascript, web

这是我的网页的屏幕截图，在提供图像下，有显示网络图像的图像。

[http://imageshack.us/a/img684/9584/screenshot20120920at335.png](http://imageshack.us/a/img684/9584/screenshot20120920at335.png)

但是，实际的网络图像是

[http://imageshack.us/a/img717/5240/1348180361.png](http://imageshack.us/a/img717/5240/1348180361.png)

该容器的代码是

```
 $('#image_upload_form input').change(function() {

            success: function ( data ) { 
                 var jsonData=data;
                if(jsonData.status==1)
                 {
                 var imagePath="http://www.test.com/play2win_offerimages/" + jsonData.image_name;

                    $('#offer_detail input[name=image]').val(imagePath);
                    myImage = new Image();
                    myImage.src = imagePath;
                                            myImage.width=100;
                                            myImage.height=100;
                    $(myImage).load(function() {
                        $('#offer_image').updateimgto(myImage.src);
                        });

                }  //status=1

            }   //success

        });      //submit 
```

我将图像 myImage 设置为 100x100。然而，正如您从网页中看到的那样，只显示了图像的一部分。

现在，我在页面上显示的网页图像被裁剪了。如何解决这个问题？

我不想裁剪，只需要重新缩放以适合容器。

image_upload_form 的 html

```
 <form id="image_upload_form" enctype="multipart/form-data" action="http://www.test.com/play2win_api/offers/upload_image" method="POST">

   <input type="hidden" name="MAX_FILE_SIZE" value="8192000" /> 

  <input name="offer_image" type="file" id="imagefile"/></form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T22:51:53.830

我建议删除这两行

```
myImage.width=100;
myImage.height=100; 
```

而是尝试在 中设置输入样式`#image_upload_form`并将以下代码添加到您的样式中：

```
width:100px;height:100px; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T22:52:04.793

不要设置图像的高度、删除或注释掉以下行：

```
myImage.height=100; 
```

只需指定宽度，浏览器将根据该宽度重新缩放图像。

# asp.net-mvc-3 - mvc3 使用 windows 身份验证 - 必须重新启动 IIS

> ID：12522009
> 
> 赞同：0
> 
> 时间：2012-09-20T22:45:56.653
> 
> 标签：asp.net-mvc-3, iis

我刚刚使用 Windows 身份验证完成了一个 MVC3 项目。在我的本地机器上一切正常，但是一旦我部署到 IIS7，它就不会接收任何用户。但是在重新启动 IIS 后，现在一切似乎都正常了。有人知道这是为什么吗？还是我做错了什么？谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T22:55:03.150

有时你只需要重新启动。您可能只需回收工作进程就可以逃脱。

至于原因，可能是因为您在其中创建了没有现有 web.config 的 iis 应用程序实例，然后在部署站点时，IIS 未配置为监视更改（因为该文件以前不存在），所以它不知道更新。

# .net - 基于小数的复杂结构；一个好主意？

> ID：12522017
> 
> 赞同：0
> 
> 时间：2012-09-20T22:46:47.593
> 
> 标签：.net, floating-point-precision

今晚我很想回家，使用 Mandelbrot/Julia 分形发生器。这是我之前在 C++ 中进行的一个项目，但这次我将在 C# 中试一试，这样我就可以更轻松地将其制作为 WinForms 应用程序，使用多线程生成图像等。

然而，我考虑使用但看起来可能最终会成为拐杖的一件事是内置的 Complex 结构。乍一看，看起来很棒；我需要的所有操作都内置到一个结构中。但是，仔细观察会发现该结构使用双精度数。双打只有 15-16 sig figs；他们的力量是他们的范围。我只对复平面上 (-2,-2) 到 (2,2) 的范围感兴趣，所以我对范围不感兴趣；精度。小数有 28 位有效数字。

因此问题；去这里的路是什么？

1.  使用内置的 Complex 类型；毕竟这只是一个附带项目。
2.  使用小数而不是双精度数滚动我自己的 DecimalComplex 类型。似乎是一条不错的“中间道路”；我需要的数学并不难（乘法和加法），它几乎可以使可用精度翻倍。
3.  孤注一掷; 实现一个 BigDecimal，利用 BigInteger 并自己跟踪小数位，并将其用于 UberComplex 结构。IIRC 上次我搞砸这个时，我使用了类似的想法，但使用了无符号的 64 位长，这让我达到了一个缩放级别，如果整个集合以 360dpi 绘制，它需要一个大致区域的表面的太阳系。我可能会做得比这更好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T23:12:02.083

如果这是您第一次编写 Mandelbrot 生成器，我建议您使用该`Complex`类型。过早的优化是万恶之源；而且，Mandelbrot 的一半酷之处在于您可以在几行代码中生成令人惊叹的图像。花两个小时来实现你自己的`BigDecimal`那种失败的目的。

*但是，我认为您没有提到另一种选择：使用定点*数学代替 IEEE 浮点数。定点运算对于 Mandelbrot 生成确实很方便，因为加法完全一样，乘法几乎一样：`(x * y)`变成`(x * y) >> MANTISSABITS`.

剧透警告！这是我几年前写的一个定点 Mandelbrot 生成器。它使用小数点后的 28 位。如果您的工具链支持`int128_t`，或者您不介意进入汇编程序，或者您不介意长时间进行乘法运算，则可以轻松替换`int32_t`为`int64_t`并获得 60 位分辨率。

```
#include <stdio.h>
#include <stdint.h>
#include "ImageFmtc.h"

/* Represent each component of the complex number
 * as a fixed-point value between -4 and +4\. There
 * are 4 bits before the binary point and 28 bits after. */
typedef int32_t REALFIXED;
typedef int32_t IMAGFIXED;

#define MandelWidth   300
#define MandelHeight  300

unsigned char Image[MandelWidth][MandelHeight];

void mandelbrot(REALFIXED centerx, IMAGFIXED centery, REALFIXED windowsize)
{
    int x, y;
    unsigned char *image_ptr = &Image[0][0];

    for (y = 0; y < MandelHeight; ++y) {

    const IMAGFIXED z_imag = (1LL * windowsize * y / MandelHeight) + centery;

    for (x = 0; x < MandelWidth; ++x) {

        const REALFIXED z_real = (1LL * windowsize * x / MandelWidth) + centerx;

        REALFIXED t_real = z_real;
        IMAGFIXED t_imag = z_imag;

        int iter;

        for (iter=0; iter < 255; ++iter) {
        long long r2 = (1uLL * t_real * t_real) >> 28;
        long long i2 = (1uLL * t_imag * t_imag) >> 28;
        long long two_ri = (1uLL * t_real * t_imag) >> 27;
        if (r2 + i2 > (4LL << 28))
            break;
        t_real = (r2 - i2) + z_real;
        t_imag = (two_ri) + z_imag;
        }

        *image_ptr++ = iter & 0xFF;
    }
    }
    return;
}

REALFIXED double2fixed(double x)
{
    return (REALFIXED)(x * (1uLL << 28));
}

int main(int argc, char **argv)
{
    double cx, cy, scale;
    sscanf(argv[1], "%lf", &cx);
    sscanf(argv[2], "%lf", &cy);
    sscanf(argv[3], "%lf", &scale);
    mandelbrot(double2fixed(cx-scale/2), double2fixed(cy-scale/2), double2fixed(scale));
    WritePGM5("mandel.pgm", (unsigned char *)Image, MandelWidth, MandelHeight);
    return 0;
} 
```

关于太阳系的大小：即使您的*数字*可能具有 60 位的分辨率，但这并不意味着您实际上可以计算出以 60 位分辨率*设置的 Mandelbrot 像素精确渲染。*乘法上的舍入误差意味着当你放大时，你的图像会变得比你预期的要快得多。我确定有人做过数学计算，但我不知道它是不是在我的脑海中。关键字“错误传播”。

# cocoa - Binding an NSArrayController to NSDictionary allValues

> ID：12522018
> 
> 赞同：1
> 
> 时间：2012-09-20T22:46:52.423
> 
> 标签：cocoa, binding, nsdictionary, cocoa-bindings, nsarraycontroller

I've encountered a few scenarios where I'd like to show some entries in an NSDictionary in an NSTableView. (My instincts to user an NSDictionaryController are always foiled by the need to make every object implement copyWithZone, which I find to be an absurd requirement that is fatal to usability...)

Instead, I'm trying to bind an NSArrayController to the allValues property of an NSDictionary, with the intent of binding respective columns of the table various properties of the objects in the array. However, I can't find a correct way to specify this binding within Cocoa, via the Controller Key and Model Key Path properties of the array controller.

When I attempt to bind the array directly to allValues, the array controller's arrangedObjects property is constantly empty - even when objects are added to the dictionary, when the addition is enclosed by [dictionary willChangeValueForKey: @"allValues"] and [dictionary didChangeValueForKey: @"allValues"] calls, even after calling setContent: on the array controller after adding the object.

Of course, I found this Stack Overflow thread:

[Binding to an NSDictionary's "allValues" array](https://stackoverflow.com/questions/2285844/binding-to-an-nsdictionarys-allvalues-array)

...and tried various versions of @"@allValues" in the Model Key Path field, but none produced the desired results.

So here's my question: If I have ArrayControllerOne bound to an object, and I'd like to bind ArrayControllerTwo to the allValues property of an NSDictionary property (called "instances") within ArrayControllerOne.selection, what should I enter in the Controller Key and Model Key Path fields?

Thanks in advance...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T04:57:37.610

您一定漏掉了一个，因为我发现您可以使用 dict.@allValues（不带引号）将数组控制器的内容数组绑定到字典的 allValues，其中 dict 是字典的属性名称。为什么会这样，我不知道——我找不到任何文档。

顺便说一句，如果我在字典中添加一个新的键值对，我使用 self.dict = _dict; 让表视图更新。

# python - 在Python中删除满足逻辑条件的列表元素

> ID：12522019
> 
> 赞同：1
> 
> 时间：2012-09-20T22:47:05.313
> 
> 标签：python, list, grep

我在“内部”中从 arcpy（arcmap）中列出了如下文件名。

```
inner = [u'aet1941jan.asc', u'aet2004jun.asc', u'aet1981nov.asc', u'aet1985feb.asc', u'aet1974sep.asc', u'aet1900sep.asc', u'aet1994apr.asc', u'aet1970nov.asc'] 
```

我正在寻找一种仅提取 1990 年后栅格的方法。如何构建一个逻辑表达式，从列表中删除所有旧栅格的所有元素？

这样输出将是一个列表：

```
out = [u'aet2004jun.asc', u'aet1994apr.asc'] 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-20T22:50:14.190

列表理解是最简单的：

```
out = [v for v in inputlist if int(v[3:7]) >= 1990] 
```

请注意，您不能命名变量`in`；我`inputlist`改用了。

以上假设字符 3 到 6 始终是您的值中的年份。

# sql - Insert multiple values and Insert value in parallel

> ID：12522020
> 
> 赞同：1
> 
> 时间：2012-09-20T22:47:08.120
> 
> 标签：sql

I have a question about SQL in parallel queries. For example, suppose that I have this query:

```
INSERT INTO tblExample (num) VALUES (1), (2) 
```

And this query:

```
INSERT INTO tblExample (num) VALUES (3) 
```

The final table should looked like this:

```
num
---
1
2
3 
```

But I wonder if there is an option that those two queries will run in parallel and the final table will be looked like this:

```
num
---
1
3
2 
```

Someone know the answer?

Thanks in advance!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T22:51:43.410

您的表格“看起来”如何取决于您要求它的方式（在`SELECT`声明中）。如果没有[`ORDER BY`子句](https://en.wikipedia.org/wiki/Order_by)，表的顺序是未定义的：

> ORDER BY 是对结果集中的行进行排序的唯一方法。如果没有此子句，关系数据库系统可能会以任何顺序返回行。如果需要排序，则必须在应用程序发送的 SELECT 语句中提供 ORDER BY。

例如：

```
SELECT num FROM tblExample ORDER BY num ASC 
```

> 1
> 
> 2
> 
> 3

```
SELECT num FROM tblExample ORDER BY num DESC 
```

> 3
> 
> 2
> 
> 1

如果要手动对列进行排序，可以添加一个新列并对其进行排序：

```
+-----+-------+
| num | order |
+-----+-------+
| 1   | 1     |
| 2   | 3     |
| 3   | 2     |
+-----+-------+

SELECT num FROM tblExample ORDER BY order ASC 
```

> 1
> 
> 3
> 
> 2

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-20T22:53:22.677

sql中没有顺序。您可以通过添加`ORDER BY`子句对查询进行排序

```
SELECT * FROM tblExample ORDER BY num 
```

或者您可以在表中添加一个时间戳列并按此排序。

# c# - How do I edit a .PDF file while its a resource?

> ID：12522021
> 
> 赞同：0
> 
> 时间：2012-09-20T22:47:11.677
> 
> 标签：c#, visual-studio-2008, itextsharp

I've been looking around on the web for an answer to a perplexing problem. I'm trying to code a program in C# and I'm looking for a snippet of code that'll take any information a user would input, i.e using a textbox or a check box, and transfer said information onto a .PDF file that I've added as a resource.

Right now I'm using Visual Studio 2008 for my coding, any help would be appreciated.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T22:52:56.607

您可以使用库动态创建 PDF：

*   [ITextSharp](http://sourceforge.net/projects/itextsharp/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-20T22:54:13.607

PDF 是专有格式。PDF4Net 是一个非常好的库，可以通过 XDF 将信息合并到 PDF 中，但是如果您尝试自己进行此操作，将会遇到很多麻烦。

# javascript - 动态 Javascript 树结构

> ID：12522022
> 
> 赞同：2
> 
> 时间：2012-09-20T22:47:16.483
> 
> 标签：javascript, loops, dynamic-data, javascript-objects, tree-structure

我想动态构建层次结构，每个节点都创建为层次结构中的层/级别，具有自己的节点数组。这应该形成一个树结构。应该有一个根节点，以及未定义数量的节点和级别来构成层次结构大小。除了根节点之外，什么都不应该被修复。我不需要阅读或搜索层次结构，我需要构建它。数组应该从 {"name" : "A", "children" : []} 开始，并且每个新节点都将被创建为级别 {"name" : "A", "children" : [HERE-{"name" : “A”，“儿童”：[]}]}。在子数组中，越来越深。基本上，数组在调用之前应该没有值，除了根节点。函数调用后，该数组应包含一个数字的所需节点，根据数据库查询的结果，每次调用可能会有所不同。每个子数组将包含一个或多个节点值。至少应该有 2 个节点级别，包括根。它最初应该是一个空白画布，即没有预定义的数组值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-21T00:04:56.387

```
 function Tree(name,child){
        this.name = name;
        this.children = child || [];
        this.addNode = function (parent){
            this.children = parent;
        }
        this.addChild = function (parentName){
            this.children.push(new Tree(parentName));
        }
    }

    var tree = new Tree("A"); // create a tree (or a portion of a tree) with root "A" and empty children
    tree.addChild("B1");   // A -> B1
    tree.addChild("B2");   // A -> B2
    var subTree1 = new Tree("C1"); // create a sub tree
    subTree1.addChild("D1");   // C1 -> D1
    subTree1.addChild("D2");   // C1 -> D2
    tree.children[0].addNode(subTree1);   // add this sub tree under A->B1
    // Tree now is:  A--> B1
    //                      C1
    //                        D1
    //                        D2
    //                    B2
    tree.children[1].addChild("C2");
    // Tree now is:  A--> B1
    //                      C1
    //                        D1
    //                        D2
    //                    B2
    //                      C2
    //tree.children[0].addChild("C4");
    // Tree now is:  A--> B1
    //                      C1
    //                        D1
    //                        D2
    //                      C4
    //                    B2
    //                      C2    
    console.log(JSON.stringify(tree)); 
```

输出

```
{
  "name": "A",
  "children": [
    {
      "name": "B1",
      "children": {
        "name": "C1",
        "children": [
          {
            "name": "D1",
            "children": []
          },
          {
            "name": "D2",
            "children": []
          }
        ]
      }
    },
    {
      "name": "B2",
      "children": [
        {
          "name": "C2",
          "children": []
        }
      ]
    }
  ]
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-20T23:14:09.773

所以你的节点有一个`name:`属性和一个`children:`数组属性。

数据库通常将树存储在表中

```
node-id, parent-id, value1, ..., valueN 
```

（如果您存储深度优先访问订单和深度优先退货订单，您可以获得一定的优势；如果您需要详细信息，请在评论中询问）。

如果您进行单个查询并将此数据转换为 JSON，您将拥有类似的东西（为了您的说明），

```
[{id: "0", parent: "-1", name: "A2"}, {id: "1", parent: "0", name: "A3"}, 
 {id: "2", parent: "1", name: "A31"}, {id: "3", parent: "2", name: "A311"}, 
 {id: "4", parent: "2", name: "A312"}] 
```

您可以`{name: children:}`使用以下代码将其转换为格式：

```
 // data is an array in the above format
function toTree(data) {
   var childrenById = {}; // of the form id: [child-ids]
   var nodes = {};        // of the form id: {name: children: }
   var i, row;
   // first pass: build child arrays and initial node array
   for (i=0; i<data.length; i++) {
       row = data[i];
       nodes[row.id] = {name: row.name, children: []};
       if (row.parent == -1) { // assume -1 is used to mark the root's "parent"
          root = row.id; 
       } else if (childrenById[row.parent] === undefined) {
          childrenById[row.parent] = [row.id];
       } else {
          childrenById[row.parent].push(row.id);
       }
   }
   // second pass: build tree, using the awesome power of recursion!
   function expand(id) {
       if (childrenById[id] !== undefined) {
           for (var i=0; i < childrenById[id].length; i ++) {
               var childId = childrenById[id][i];
               nodes[id].children.push(expand(childId));
           }
       }
       return nodes[id];
   }
   return expand(root);
} 
```

有关工作示例，请参阅[http://jsfiddle.net/z6GPB/ 。](http://jsfiddle.net/z6GPB/)

# java - Tomcat7 how to serve static files with Expires HTTP header

> ID：12522026
> 
> 赞同：1
> 
> 时间：2012-09-20T22:47:53.377
> 
> 标签：java, caching, tomcat, tomcat7

I have a group of static files (mainly the static files, including css and images, that make up the [ExtJS](http://www.sencha.com/products/extjs) JavaScript framework). This group of static files *rarely changes* and therefore I decided *NOT* to include them within the items in the web application's war file. (I.e. I didn't follow the approach recommended by [this answer](https://stackoverflow.com/questions/2523262/how-to-serve-static-content-from-tomcat).)

Right now I serve all these static files under `/extjs` by having the following [Context container](http://tomcat.apache.org/tomcat-7.0-doc/config/context.html) defined in `server.xml`:

```
<Context docBase="/path/to/extjs-4.1.1" path="/extjs" /> 
```

That "works" so far; still if anyone is able to suggest a better approach please do.

**However I can't find a way to add `expires` HTTP headers to files served by this context.**

Any idea how to configure Tomcat7 in this respect?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T23:40:37.390

Tomcat 的默认 servlet ( `org.apache.catalina.servlets.DefaultServlet`) 似乎没有办法做到这一点。

最简单的做法是创建一个 servlet 过滤器，它只是将您需要的 HTTP 标头添加到每个请求中。由于`<context>`定义了一个 webapp，你可以添加一个`WEB-INF/web.xml`文件`/extjs`并在那里加载你的过滤器。由于 /extjs 是一个单独的上下文，因此您的“真实”应用程序不会受到影响。

# symfony - 如何从 Twig 模板中的相关对象输出数据？

> ID：12522028
> 
> 赞同：3
> 
> 时间：2012-09-20T22:47:55.873
> 
> 标签：symfony, twig

我对 Symfony2 还是很陌生，所以请放轻松。我正在尝试遍历一个航班表（用于机票预订系统），其中包含几个相关字段，例如航空公司和机场。我在自定义存储库中使用以下方法：

```
public function getAllFlights($limit = 100)
{
    $dql = 'SELECT f FROM Flightcase\BookingBundle\Entity\Flight f';

    $query = $this->getEntityManager()->createQuery($dql);
    $query->setMaxResults($limit);

    return $query->getResult();
} 
```

并且 getAllFlights() 被传递给我的 Twig 模板，如下所示：

```
$flights = $em->getRepository('FlightcaseBookingBundle:Flight')->getAllFlights();   

return $this->render('FlightcaseBookingBundle:Flight:list.html.twig', array('flights' => $flights)); 
```

Twig 模板只是简单地遍历 $flights 集合中的项目，如下所示：

```
{% for flight in flights %}
<tr>
<td>{{ flight.airline }}</td>
<td>{{ flight.origin }}</td>
<td>{{ flight.destination }}</td>
<td>{{ flight.dateFrom }}</td>
<td>{{ flight.timeFrom }}</td>
<td>{{ flight.dateTo }}</td>
<td>{{ flight.timeTo }}</td>
</tr>
{% endfor %} 
```

但我得到一个丑陋、神秘的异常，告诉我*“Proxies\FlightcaseBookingBundleEntityAirlineProxy 类的对象无法转换为字符串”*，这让我相信我需要获取 Airline 对象中的特定属性，例如 IATA 代码以输出为字符串。但是如何访问 Twig 模板中的 $airline->getIataCode() 呢？或者我的存储库中有没有办法将相关对象转换为字符串？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-20T23:15:28.807

我假设 Airline 是一个单独的实体，它与 Doctrine 中的 Flight 实体有关联。就像是：

```
class Airline
{
    private $id;
    private $name;
    private $flights;
    ...
} 
```

那是对的吗？如果是这样，那么这就是您看到该特定错误的原因。你给了 Twig 一个对象，并告诉它打印出来……但这到底是什么意思？

让我们假设您的类看起来像上面那样，并且您只是想打印出航空公司的名称。

你可以做以下两件事之一：

首先，你可以给你的对象一个 toString() 方法：

```
class Airline
    {
        public function toString()
        {
            return $this->getName();
        }
    } 
```

或者，你可以给 Twig 一些标量来使用：替换`{{ flight.airline }}`为`{{ flight.airline.name }}`.

*编辑：*

刚刚看到您的 Airline 对象有一个名为 $IataCode 的属性。在这种情况下，您将在 Twig 中使用`{{ flight.airline.IataCode }}`.

# python - 如何扩展现有的 python 实例

> ID：12522030
> 
> 赞同：1
> 
> 时间：2012-09-20T22:48:05.920
> 
> 标签：python

我正试图在这里思考一些事情......假设我有一个简单的类继承设置：

```
class SuperClass(object):
    def __init__(self):
        self.var = 1

class SubClass(SuperClass):
    def getVar(self):
        return self.var 
```

如果我有一个现有的实例`SuperClass`，有没有办法可以将它“转换”为`SubClass`，而无需创建新实例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T22:53:52.583

在 Python 中，您没有`cast`运算符 - 您可以通过将类型分配给实例的`__class__`属性来解决此问题：

```
>>> super_instance = SuperClass()
>>> super_instance.__class__ = SubClass
>>> print super_instance.getVar()
1 
```

但是，这比许多其他语言更容易出错，因为编译器未验证`cast`“”的有效性和安全性。`cast`

例如，如果`SubClass`有一个方法访问了一个不可用的属性，`SuperClass`那么尝试调用该方法`super_instance`会在运行时导致错误，即使它*看起来*是`SubClass`.

# css - 菜单不随网站缩放，在较小的显示器上，视频/照片偏向右侧

> ID：12522032
> 
> 赞同：0
> 
> 时间：2012-09-20T22:48:17.373
> 
> 标签：css, html, scale

我早些时候寻求帮助，这太棒了，我很感激，但我需要你们的专家帮助。

[http://www.mrandmrsmagic.com](http://www.mrandmrsmagic.com)是我正在开发的站点，在简化代码并且没有绝对定位之后，由于某些奇怪的原因，菜单栏没有随站点缩放。推荐标签也被切断了，我猜这是因为宽度不够长？

此外，在较小的显示器（15 英寸以上）上，他们说视频库和照片库在右侧 3 英寸处，有没有办法我可以添加填充或边距以使它们像他们一样粘在中间有更大的屏幕？任何和所有的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T23:08:39.650

行...

您的画廊位于`div`指定位置。

例如

```
#gallery {
    position: relative;
    left: 950px; /* This needs to be removed */
    top: -560px; /* This needs to be removed */
} 
```

这将始终迫使`div`关闭到一边。

如果我错了，我*认为您想要并纠正我的是两列。*

这实际上很容易做到，我在这里设置了一个例子[来](http://jsfiddle.net/um8qb/)帮助你。

在我的示例中，两列左右浮动以在中间为它们提供空间，而`divs`具有类的两列`.placeholder`提供高度和宽度。

如果您创建类似的内容，分别`.placeholder`用您的图像和图库替换每个内容，那么您应该能够将视频保留在主要内容中。

希望这会有所帮助。

## 编辑

我会尽力正确解释一切。

我链接的示例中的内容 div 只是用来环绕该示例中的浮动列。您不需要复制它。

列左右浮动以分隔内容并将其并排放置。添加一个浮点数仅仅意味着它们将在其父容器内尽可能沿给定方向定位自己。

浮动内容会破坏页面的流动，因此父级需要`.clearfix`添加类以防止列下方的任何内容被破坏。它还允许父母有高度。

对于不同的显示器宽度，以不同的方式定位图库仅适用于能够理解 css 中的媒体块的浏览器，而 ie7 和 ie8 则不能。使用两列布局会好得多。

# javascript - Google Maps API v3 - 动态广告尺寸

> ID：12522038
> 
> 赞同：0
> 
> 时间：2012-09-20T22:49:02.317
> 
> 标签：javascript, google-maps, adsense

我正在使用[此处](https://developers.google.com/maps/documentation/javascript/reference)所述的 Google Maps API ，并将 Adsense 广告添加到[此处](https://developers.google.com/maps/documentation/javascript/advertising)定义的页面中。我想根据设备的屏幕尺寸显示不同的广告尺寸。目前我显示一种尺寸，对于桌面浏览器来说太小了，对于移动浏览器来说太大了。

有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T23:15:44.813

尝试检查 javascript 属性 screen.width 和 screen.height。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-20T23:32:04.803

将它们放在容器中并将容器设置为 % 宽度，然后将 iframe 设置为相同。因此，根据屏幕大小，您添加的内容将扩大以固定百分比。您可能需要触发调整大小事件来满足用户最小化屏幕的需求。例子：

你的 CSS：

```
.ad-holder{ width: 33%;height: 200px;} //width can be anything you declare 
```

您的 HTML：

```
<div class="ad-holder">
<iframe src="the map or ad" width="100%" height="200px" frameborder="0" id="map_options_styling_iframe">
  </iframe>
</div> 
```

# postgresql - 使用 Pl/pgSQL 将参数传递给循环中的查询

> ID：12522039
> 
> 赞同：0
> 
> 时间：2012-09-20T22:49:03.273
> 
> 标签：postgresql, plpgsql

我正在尝试创建一个参数查询，该查询将使用 plpgsql 在循环中执行。

2 个参数将是传入查询的起始纬度/经度点。纬度和经度点将从数组中检索 - 因此它将是对数组的类似 foreach 的迭代，并将两个纬度/经度值传递给每次执行的查询。

我该怎么做这样的事情？

我的查询和我认为的实现方式如下：（X、Z 值是将传递的参数纬度/经度值，Y 和 T 将通过执行我将处理的特定计算获得）。为清楚起见，我的查询返回多行和多列结果（时间戳和计数），因为它计算并返回属于小时间隔的请求数（时间戳）

```
for each latitude-longitude pair X,Z in array

find Y and T from X and Z

WITH cal AS (
    SELECT generate_series('2011-02-02 00:00:00'::timestamp ,
                           '2012-04-01 05:00:00'::timestamp , 
                           '1 hour'::interval) AS stamp
),
qqq AS (
  SELECT date_trunc('hour', calltime) AS stamp, count(*) AS zcount
  FROM mytable
  WHERE calltime >= '2011-02-13 22:55:11' 
    AND calltime <= '2012-02-13 01:02:21'
    AND (calltime::time >= '22:55:11' 
    OR calltime::time <= '01:02:21')
    AND lat >= X 
    AND lat <= Y
    AND lon >= Z
    AND lon <= T
 GROUP BY date_trunc('hour', calltime)
)
SELECT cal.stamp, COALESCE (qqq.zcount, 0) AS zcount
FROM cal
LEFT JOIN qqq ON cal.stamp = qqq.stamp
WHERE cal.stamp >= '2011-02-13 22:00:00' 
  AND cal.stamp <= '2012-02-13 01:02:21' 
  AND (
    extract ('hour' from cal.stamp) >= extract ('hour' from '2011-02-13 22:00:00'::timestamp) or
    extract ('hour' from cal.stamp) <= extract ('hour' from '2012-02-13 01:02:21'::timestamp) 
  )
ORDER BY stamp ASC; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T23:14:47.363

*   将数组传递给函数并`FOR r IN SELECT * FROM unnest(the_array) LOOP`覆盖数组中的元素，其中`r`是函数子句中的变量`record`；`DECLARE`或者

*   循环传递给函数的 refcursor。请参阅[PL/PgSQL 游标](http://www.postgresql.org/docs/9.1/static/plpgsql-cursors.html)。

更好的是，避免`LOOP`并将其集成`SELECT unnest(thearray)`到您的 CTE 中。PL/PgSQL 中的循环比 SQL CTE 中的循环慢得多。

见[`unnest`](http://www.postgresql.org/docs/9.2/static/functions-array.html)，[`LOOP`](http://www.postgresql.org/docs/current/static/plpgsql-control-structures.html)。

# c++ - 每个用户安装带有 Visual C++ Redistributable 的 WiX 安装程序

> ID：12522042
> 
> 赞同：2
> 
> 时间：2012-09-20T22:49:16.453
> 
> 标签：c++, installation, wix, redistributable

我正在使用 Wix 为项目生成 msi 安装程序文件。我正在使用 wix 来安装 Visual C++ Redistributable 文件（遵循本指南：[http](http://wix.sourceforge.net/manual-wix3/install_vcredist.htm) ://wix.sourceforge.net/manual-wix3/install_vcredist.htm ）

尽管我指定了 InstallScope="perUser"，但我的安装程序仍在尝试为所有用户安装。直到我添加了可再发行文件，这才发生。

我还添加了

```
<Property Id="ALLUSERS" Secure="yes"/> 
```

没有运气。

似乎 VCRedist 的合并导致需要提升权限。

有没有办法生成一个安装程序，每个用户安装 Visual C++ Redistributable（即不是所有用户）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-21T03:02:30.503

不，Visual C++ 运行时 DLL 安装在 Windows 目录下，因此需要管理员权限才能安装它们。您可以在本地安装 DLL，不需要管理员权限；例如，请参阅[http://msdn.microsoft.com/en-us/library/dd293565.aspx](http://msdn.microsoft.com/en-us/library/dd293565.aspx)。

# objective-c - 什么是非脆弱 ABI？

> ID：12522053
> 
> 赞同：7
> 
> 时间：2012-09-20T22:50:31.553
> 
> 标签：objective-c, xcode, cocoa, compiler-construction, 64-bit

似乎暗示*每个人都*知道“非易碎 ABI”是什么——考虑到它在 Xcode 中被引用的频率和事实性质。例如...

> 下标需要接口节点的大小，在非易碎 ABI 中不是恒定的

或者

> 选择要使用的 Objective-C ABI 版本。可用版本为 1（旧版“脆弱”ABI）、2（非脆弱 ABI 1）和 3（非脆弱 ABI 2）。

也就是说……**什么是非脆弱 ABI？**（为什么不把它称为不那么抽象/解释得更清楚的东西？）

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-20T22:59:39.510

non-fragile ABI 是指在一个类中添加实例变量而不需要重新编译所有子类的能力。

即在 v1 中（实际上没有真正的 ObjC 版本），如果 Apple 要向 NSView（在 Cocoa 上，32 位）添加一个实例变量，那么 NSView 的每个子类（或子类的子类）都必须重新编译，否则它们会爆炸。v2 和 v3 解决了这个问题。

[在这篇博客文章](http://www.sealiesoftware.com/blog/archive/2009/01/27/objc_explain_Non-fragile_ivars.html)中有详细解释。

您所指的文档位于 llvm/clang 手册页中。大多数时候，对于大多数开发人员来说，这是非常难得的地方；除非您正在编写直接驱动编译器的 Makefile，否则没有太多理由阅读该页面（除非进行探索——当然，这很有教育意义）。

它是按照 Unix 手册页的风格编写的，毫不奇怪，它有点……迟钝。对于几乎所有任务，最好坚持使用更高级别的文档。即，Xcode 构建设置文档一般不那么迟钝。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T14:12:18.360

经过一番摸索，关于该主题的最佳总结/建议之一如下……</p>

> 非脆弱 ABI 允许在不破坏已经编译的子类的情况下更改超类的 ivars（除其他外）。但它仅在 Mac 上的 64 位上受支持，因为向后兼容性问题不允许他们在现有的 32 位架构上支持它。

[它继续说，基本上](https://groups.google.com/forum/?fromgroups=#!topic/xcodephoenix/yiqqLdLTxaA).. 如果 Xcode，它通常被配置为构建“仅活动架构”，也就是仅 64 位..在切换到“发布”方案时*可能会*遇到问题，即通常设置为为两种（63 位/32 位）架构构建，又名“通用”..

> 您可能想在 Mac 上使用 ARC，我很确定您必须放弃 32 位支持才能这样做。您可以在 Xcode 中为您的目标在构建设置中更改目标架构。

以我自己的经验，我*相信*非脆弱的 ABI 让我们受益的是一种缩写的语法，以及诸如……的模式。</p>

```
//  source.h  - readonly public properties.  
@interface SuperClassy : NSObject
@property (readonly) NSArray *cantTouchThis;
@end
// source.m  set readonly properties, internally.  
@implementation SuperClassy
// look, no @synthesize… just use _ivarName.
 -(void) touchIt:(NSArray*)a { _cantTouchThis = a; }    
@end
int main(int argc, const char * argv[]) {
    SuperClassy *it = [SuperClassy new];
    // you cannot set it.cantTouchThis = @[anArray].
    [it touchIt:@[@"cats"]];  
    // but you can via a method, etc.
    NSLog(@"%@", it.cantTouchThis);
} 
```

`NSLOG ➜ ( cats )`

# internet-explorer-8 - 使用 text-align 时的有趣行为：在 Internet Explorer 中以文本区域为中心

> ID：12522055
> 
> 赞同：1
> 
> 时间：2012-09-20T22:50:50.557
> 
> 标签：internet-explorer-8, internet-explorer-9, textarea, center, text-align

我创建了一个 textarea 元素，并应用了 text-align: center; 样式。给它。现在，每当我输入一些内容然后按回车键进入新行时，上一行的文本就会稍微向左移动。为什么会这样？我已经在 Firefox 中对此进行了测试，但问题不存在。它存在于 Internet Explorer 8 和 9 中。有什么想法吗？

已解决：我发现添加 css 样式的 white-space: pre; 到文本区域解决了这个问题。

# xml - 带有 XML 的 SVG：如何旋转由自定义路径创建的形状？

> ID：12522056
> 
> 赞同：1
> 
> 时间：2012-09-20T22:51:06.587
> 
> 标签：xml, path, svg, rotation

我正在尝试围绕原点 (16, 16) 旋转一个形状，但以下内容使形状保持不变。

```
<g>
    <g>
        <path
            style="fill:#666666;fill-opacity:0.5;stroke:none"
            d="M 16 0 L 14.5 6 L 16 12 L 17.5 6 L 16 0 z M 4.6875 4.71875 L 7.875 10.03125 L 13.1875 13.1875 L 10 7.90625 L 4.6875 4.71875 z M 27.28125 4.71875 L 21.96875 7.90625 L 18.8125 13.1875 L 24.09375 10.03125 L 27.28125 4.71875 z M 6 14.5 L 0 16 L 6 17.5 L 12 16 L 6 14.5 z M 26 14.5 L 20 16 L 26 17.5 L 32 16 L 26 14.5 z M 13.1875 18.8125 L 7.875 22 L 4.6875 27.3125 L 10 24.125 L 13.1875 18.8125 z M 18.8125 18.8125 L 21.96875 24.125 L 27.28125 27.3125 L 24.09375 22 L 18.8125 18.8125 z M 16 20 L 14.5 26 L 16 32 L 17.5 26 L 16 20 z ">
        </path>
    </g>
    <animateTransform attributeName="transform" attributeType="XML" from="0 16 16" to="360 16 16" dur="2s" repeatCount="indefinite" type="rotate" fill="freeze"/>
</g> 
```

# ruby-on-rails - 如何解决 DeviseInvitable 的“邀请令牌不能为空”

> ID：12522069
> 
> 赞同：0
> 
> 时间：2012-09-20T22:52:33.097
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise

我在我的 rails 应用程序中使用 strong_parameters 和 devise_invitable。如果我将其保留为“禁止属性”运行时错误，我会得到。所以我做了以下事情：

1.  使用创建了一个新控制器`rails g controller users/invitations`
2.  添加`:invitations => "users/invitations"`到 devise_for
3.  填充用户/invitations.rb 像这样：

    ```
    class Users::InvitationsController < Devise::InvitationsController
       def update
        self.resource = resource_class.accept_invitation!(allowed_params)

        if resource.errors.empty?
          set_flash_message :notice, :updated
          sign_in(resource_name, resource)
          respond_with resource, :location => after_accept_path_for(resource)
        else
          respond_with_navigational(resource){ render :edit }
        end
    end

     private

      def allowed_params
         params.permit(:utf8,:authenticity_token,:invitation_token, :_method,
         {user: [:invitation_token,:password,:password_confirmation]}, :commit, 
         :action,:controller)
      end
    end 
    ```

但是，当我这样做时，我收到错误“邀请令牌不能为空”。我已经检查了 allowed_pa​​rams 的值，使用`puts`它似乎在那里。然而，我仍然得到错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:53:24.863

我发现了我的问题并在[wiki](https://github.com/scambra/devise_invitable/wiki/Devise-Invitable-With-Strong-Parameters-Gem)上回答了它。

# algorithm - 高效查询包含多维数据的 B+ 树

> ID：12522070
> 
> 赞同：5
> 
> 时间：2012-09-20T22:52:43.950
> 
> 标签：algorithm, data-structures, multidimensional-array, b-tree

我有一组`(x,y)`64 位整数的元组组成我的数据集。比如说，我有数万亿个这样的元组；将数据集保存在地球上任何机器的内存中是不可行的。但是，将它们存储在磁盘上是相当合理的。

我有一个磁盘存储（一个 B+-tree），它允许在一个维度中快速、并发地查询数据。但是，我的一些查询依赖于这两个维度。

查询示例：

*   查找`x`大于或等于某个给定值的元组
*   找到`x`尽可能小的 st 它`y`大于或等于某个给定值的元组
*   找到`x`尽可能小的 st 它`y`小于或等于某个给定值的元组
*   执行维护操作（插入一些元组，删除一些元组）

我发现最好的选择是 Z 阶曲线，但我似乎无法弄清楚如何在给定我的二维数据集的情况下进行查询。

不可接受的解决方案包括数据的顺序扫描，这可能太慢了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T08:17:46.983

我认为，最适合您要求的数据结构是[R-tree](http://en.wikipedia.org/wiki/R-tree)及其变体（R*-tree、R+-tree、Hilbert R-tree）。R-tree 类似于 B+-tree，但也允许多维查询。

其他相关的数据结构是优先搜索树。它适用于您的示例 1 .. 3 之类的查询，但如果您需要频繁更新或磁盘存储，则效率不高。有关详细信息，请参阅[本文](http://wwwisg.cs.uni-magdeburg.de/ag/lehre/SS2009/GDS/slides/S10.pdf)或本书：[“数据结构和应用手册”](https://rads.stackoverflow.com/amzn/click/com/1584884355)（第 18.5 章）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-16T04:16:57.073

[http://fallabs.com/tokyocabinet/](http://fallabs.com/tokyocabinet/)

> Tokyo Cabinet 是用于管理数据库的例程库。数据库是一个包含记录的简单数据文件，每个记录是一对键和一个值。每个键和值都是可变长度的串行字节。二进制数据和字符串都可以用作键和值。既没有数据表的概念，也没有数据类型的概念。记录以散列表、B+ 树或定长数组的形式组织。
> 
> Tokyo Cabinet 是用 C 语言编写的，并作为 C、Perl、Ruby、Java 和 Lua 的 API 提供。Tokyo Cabinet 在具有符合 C99 和 POSIX 的 API 的平台上可用。Tokyo Cabinet 是根据 GNU Lesser General Public License 授权的免费软件。

你可以轻松嵌入吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-28T03:21:51.533

我目前正在设计一个数据结构，它本质上是一个用于多维数据的“堆叠”B+ 树（或*d* + 树，其中*d*是维数）。我相信它会完美地适合您的数据，并且是专门为您的用例设计的。

基本思想是这样的：

每个维度都是一个 B+ 树，并链接到下一个维度的 B+ 树。通常搜索第一个维度，一旦到达叶子，它就会包含一个指向下一个 B+ 树的根的指针，该树属于下一个维度。第二个 B+ 树中的所有内容都属于同一个`x`值。

最初的计划是只存储每个维度的唯一值及其计数。这采用了一种非常简单的压缩算法（如果您甚至可以这样称呼它），同时仍然允许表示整个数据集。这种“链接”维度方案可以允许稍后添加额外维度，因为它们只是添加到 B+ 树的堆栈中。

2 个维度的总插入/搜索/删除时间将与此类似：

```
log b(card(x)) + log b(card(y)) 
```

其中*b*是每个 B+ 树的基数，而*card(x)*将是*x*维度的基数。

我希望这是有道理的。我仍在致力于实现，但可以随意使用甚至增强这个想法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-20T23:09:23.803

你是说你不知道如何查询 z 阶曲线？维基[百科页面](http://en.wikipedia.org/wiki/Z-order_curve)描述了您如何进行范围搜索。

z 曲线将您的空间划分为嵌套的矩形，其中键中的每个附加位将空间分成两半。要搜索一个点：

```
Start with the largest rectangle that might contain your point.

    Recursively:

        Create a result set of rectangles    

    For each rectangle in your set        
        If the rectangle is a single point, you are done, it is what you are looking for.
        Otherwise, divide the rectangle in two (specify one additional bit of the z-curve)
            If both halves contain a point
                If one half is better 
                    Add that rectangle to your result set of rectangles
                Otherwise
                    Add both rectangles to your result set of rectangles
            Otherwise, only one half contains a point
                    Add that rectangle to your result set of rectangles

    Search your result set of rectangles 
```

当然，最坏情况下的性能很差。您可以通过更改构建 z 顺序索引的方式来调整它。

# php - 用户选中复选框时更改 php 数组

> ID：12522074
> 
> 赞同：1
> 
> 时间：2012-09-20T22:53:15.790
> 
> 标签：php, javascript, button, checkbox, hyperlink

我有一列有一个按钮，当按下该按钮时，链接到 PHP 中设置的 URL。我想在该按钮旁边添加一个复选框，以便如果在用户按下按钮时选中它，它将把它们带到备用网址。设置 url 的 PHP 代码：

```
<?php
    $link =  'http://www.example.com'; 
?> 
```

我意识到代码需要在javascript中，我不知道。我只知道一点点的php，所以任何帮助都会得到帮助。

澄清一下：（当然我知道这段代码永远不会工作）

我想做的是：

```
<?php

    If (checkbox is checked) {
        $link =  'http://www.google.com';
    } else {
        $link =  'http://www.example.com';
    }
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T23:00:06.163

包括来自 Google 的 jQuery：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js" type="text/javascript"></script> 
```

然后编写单击按钮后调用的重定向功能；

```
<script>
function foo() {
  if ($('#checkbox').is(':checked')) {
      //redirect to google.com
      window.location = "http://www.google.com/";
  } else {
      window.location = "http://www.example.com/"
  } 
}
</script> 
```

最后，您的按钮应如下所示：

```
<button onclick="foo();" >Your button</button> 
```

此代码假定您的复选框有一个 ID“复选框”。

另外，我不认为您尝试做的事情应该用 PHP 来完成 - 所以您应该立即学习 Javascript/jQuery，而不是按照不应该编写的方式编写代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T23:00:36.943

可能还有另一种方法可以实现您想要实现的目标。复选框的值应与表单字段的其余值一起发送到服务器上的单个 php 脚本。然后您可以在 php 中使用复选框的值（布尔值）并相应地执行您需要执行的操作，可能需要外部脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-20T23:01:05.800

如果未选中复选框值，则不会通过表单提交将其发送到服务器。所以，你可以使用这样的东西：

```
<?php
    if (isset($_POST['checkbox_name'])) {
        $link =  'http://www.google.com';
    }else{
        $link =  'http://www.example.com';
    }
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-20T23:08:41.537

示例：http: [//jsfiddle.net/5bdae/](http://jsfiddle.net/5bdae/)

使用 jQuery 这相当简单。您将一个函数绑定到链接，该函数确定复选框是否被选中，如果它链接到一个地方，否则它链接到另一个地方。

对于这样的 HTML 结构：

```
<input id='myCheckbox' type="checkbox" name="box" value="box" />
<a href='#' id='myLink'>My Link</a> 
```

jQuery 将是：

```
$('#myLink').click(function(event){
    event.preventDefault();
    if ($('#myCheckbox').is(':checked')){
        window.location.href='http://www.example.com';
    } else {
        window.location.href='http://www.ask.com';   
    }
}); 
```

这可能会超出 PHP 标记，您需要在代码中[包含 jQuery](http://encosia.com/3-reasons-why-you-should-let-google-host-jquery-for-you/)。

# python - 找出哪个模块正在设置根记录器

> ID：12522080
> 
> 赞同：4
> 
> 时间：2012-09-20T22:53:43.910
> 
> 标签：python, logging

我如何能够找到哪个模块覆盖了 Python 根记录器？

我的 Django 项目从很多外部包中导入，并且我尝试搜索所有 logging.basicConfig 和 logging.root 设置实例，但是它们中的大多数都在测试中，除非特别调用，否则不应覆盖它。

Django 的日志记录配置没有指定根记录器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-21T14:00:50.150

好吧，解决方案是对 Python 日志记录模块进行一些猴子修补。我只是在打印堆栈的 logging.root.addHandler 函数周围包裹了一个装饰器，瞧，我找到了调用 logging.getLogger() 的罪魁祸首。如果您不带任何参数调用 getLogger，您将获得根记录器。

```
import logging
import sys
import traceback
def tracer(func):
    def new_func(*args, **kwargs):
        try:
            traceback.print_stack(sys.stderr)
        except:
            traceback.print_exc(sys.stderr)
        return func(*args, **kwargs)
    return new_func
old_addHandler = logging.root.addHandler
logging.root.addHandler = tracer(old_addHandler)

# run your code 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T02:38:25.540

我假设您的意思是`import logging`导入不同的日志记录模块？在这种情况下，模块/包的许多特殊属性可以提供帮助，例如`__path__`. 打印`logging.__path__`应该告诉你 python 从哪里导入它。

# javascript - 将 CSS 类分配给单个现有的 div 类，而不是所有这些类

> ID：12522081
> 
> 赞同：2
> 
> 时间：2012-09-20T22:53:46.367
> 
> 标签：javascript, jquery, class, css-selectors, addclass

我不确定我是否以正确的方式进行此操作，但我会尽力解释我正在尝试做的事情。

我有一个包含菜单的 HTML 页面。在该菜单中有许多使用特定 CSS 类的实例。当页面发生变化时，会通过 URL 传递一个值，该值随后用于突出显示所选项目并展开子菜单。

我遇到的问题是，当我尝试使用此值在正确的位置展开列表时，我实际上无法选择并添加新的 CSS 类或执行其他操作。我将在下面发布一些代码，以便您可以更好地理解我在说什么，然后可能会给出一个示例场景。

```
if (param != null) {
    $('.menuButton')[paramvalue].addClass('on');
    $('.menuButton')[paramvalue].slideDown('normal');
} 
```

那就是给出问题的javascript部分。在上述情况下，参数值可以替换为 0 或 1 等。这部分正在达到我想要更改的特定类。我通过向 HTML 添加一个 id 并使用以下方法检索它来检查这一点：

```
 alert($('.menuButton')[paramvalue].id); 
```

这返回了正确的 ID 值。

HTML如下：

```
<div class="menuButton" id="2">Button 1</div>
<div class="subMenu">
    <ul>
    <li><a href="#">Item 1.1</a></li>
    <li><a href="#">Item 1.2</a></li>
    <li><a href="#">Item 1.3</a></li>
 </ul>
</div>
<div class="menuButton" id="3">Button 2</div>
<div class="subMenu">
<ul>
    <li><a href="#">Item 2.1</a></li>
    <li><a href="#">Item 2.2</a></li>
    </ul>
</div> 
```

没有与 id 一起使用的 CSS，它们主要是为了测试而添加的。如有必要，我可以发布相关的 CSS，但我认为这不是问题的一部分。

我应该提一下，使用以下作品

```
$('.menuButton').addClass('on'); 
```

所以也许这会缩小问题的范围。

如果您需要任何其他信息。问一下。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-20T22:57:30.813

通过使用`$(selector)[index]`您将 jQuery 对象转换为没有`addClass`方法的 DOM Element 对象，您可以使用`eq()`方法代替：

```
$('.menuButton').eq(paramvalue).addClass('on');
$('.menuButton').eq(paramvalue).slideDown('normal'); 
```

您还可以链接您的方法：

```
$('.menuButton').eq(paramvalue).addClass('on').slideDown('normal'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-20T22:58:16.163

尝试：

```
$('.menuButton').eq(paramvalue).addClass('on'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-20T23:00:29.900

你也可以这样做：

```
$('.menuButton:eq('+paramvalue+')').addClass('on'); 
```

这将比选择所有元素然后将它们减少到只选择一个元素来提高性能。

# iphone - 调用 textfieldshouldreturn 会导致调用异常

> ID：12522082
> 
> 赞同：0
> 
> 时间：2012-09-20T22:53:49.627
> 
> 标签：iphone, ios, xcode, uitextfield, uitextfielddelegate

抛出的异常是：2012-09-21 00:46:56.885 Colors[3032:c07] -[UITextField value]: unrecognized selector sent to instance 0x718cce0 2012-09-21 00:46:56.887 Colors[3032:c07] ***

实例 0x718cce0 是文本字段对象：

```
-(BOOL)textFieldShouldReturn:(UITextField *)textField
{
    [textField resignFirstResponder];
    return YES;
} 
```

当我们返回 YES 时抛出异常，即使我们返回 NO。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T02:49:11.233

您向 textField 询问了它的值 - 它没有这样的方法或属性。询问它的“文本”属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T03:38:57.973

我相信有些东西会在运行时破坏你的记忆。您可以尝试检查一些可能导致此类异常的事情。确保您的 UITextField 与 UITextFieldDelegate 确认。右键单击 UITextField 以查看它是否附加了其上下文中不存在的任何 IBAction。在 viewDidLoad 中设置 UITextField 的委托。

我希望它对您有所帮助.. 如果仍然没有，请尝试更多地简要介绍您的问题。快乐编码。干杯！！

# c# - c#、c++ 和 C 的混合

> ID：12522086
> 
> 赞同：-1
> 
> 时间：2012-09-20T22:54:30.430
> 
> 标签：c#, c++, c, visual-studio-2008, wrapper

我混合了代码`C#`和在.`C++``main()``C#`

现在我需要使用第三方`C`代码`C++`来调试问题。我在 Visual Studio 的项目中添加了几个`C`文件，并使用. 文件中的函数很少有 Windows 开发 API ，例如等，它们似乎不起作用。`C++``C``extern C``C++``C``GetEnvironmentVariable()``FindFirstFile()`

他们总是失败。此外，当`Abort()`在`C`函数中调用时，执行控制似乎没有返回给`C++`. `C++`代码被挂起。有什么我想念的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T02:05:29.270

Win32 API 的东西在 C++ 和 C 中的工作方式相同，所以如果它们失败了，那一定是第三方 C 代码中的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T00:04:48.940

您可能想看看**[SWIG](http://www.swig.org/)**，因为它会解释您的**C++/C**代码并为其创建**C#**包装器。

# mysql - 电子商务网站理想的 MySQL 事务隔离模式是什么？

> ID：12522087
> 
> 赞同：-1
> 
> 时间：2012-09-20T22:54:49.690
> 
> 标签：mysql, transactions, e-commerce, relational-database

对于必须执行典型的数据库操作以减少库存的电子商务站点，最好的事务隔离模式是什么？我应该`READ COMMITTED`用来防止读取交易中的数据吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-22T11:47:48.880

您希望数据准确还是不准确？您希望它准确到什么程度*？*您希望系统能在多大程度上保证您的数据确实是准确的？

在从零到 100% 的范围内，100% 表示您应该使用 SERIALIZABLE，而零表示您可以负担（/您的用户可以接受）未提交的阅读。

编辑（遵循评论中的建议）

但当然，关于数据完整性的更强有力的保证是有代价的。至少，“更强”的隔离级别（SERIALIZABLE、REPEATABLE READ）总是会减少更新事务并发运行的机会。他们还**可能**负责减少更新者和读者之间的并发性。没有硬性和快速的通用规则，取决于引擎使用的内部机制。

# objective-c - iOS PopOver - 仅来自条形按钮项目或圆形矩形？

> ID：12522094
> 
> 赞同：0
> 
> 时间：2012-09-20T22:56:10.757
> 
> 标签：objective-c, ios, xcode, uiview, popover

我正在构建一个 iPad 应用程序，它在 UIview 中嵌入了一个表格视图（奇怪，我知道）。在 UITableview 中有通过 PLIST 加载的数据。我想允许用户“选择”一行，它会显示一个“弹出框”（uiview），其中包含一个允许他们编辑该字段的文本字段。

但是，通过查看代码，我发现只有两种方法可以触发该函数：

*   presentPopoverFromBarButtonItem
*   presentPopoverFromRect

这是真的吗，您只能从圆形矩形或条形按钮项目中触发该功能吗？我有一种感觉，我可以做到，但是搜索并没有找到任何答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T23:07:07.800

是的，您只能从条形按钮项或视图中的矩形呈现弹出框。

来自[官方文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIPopoverController_class/Reference/Reference.html)：

```
Presenting and Dismissing the Popover
– presentPopoverFromRect:inView:permittedArrowDirections:animated:
– presentPopoverFromBarButtonItem:permittedArrowDirections:animated:
– dismissPopoverAnimated: 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T23:07:24.487

这些是呈现 UIPopoverController 子类的仅有的两种方式。您的问题不清楚为什么“presentPopoverFromRect”不起作用。

我知道“presentPopoverFromBarButtonItem”有点限制，但“presentPopoverFromRect”可以让你做任何你想做的事情。它允许您相对于视图定位弹出框，其中“rect”提供了一种相对于视图框架偏移弹出框的方法。

尝试：

```
CGRect popoverRectFromCell = CGRectMake(tappedCell.frame.size.width / 2, tappedCell.frame.size.height / 2, 1, 1);

[cellPopover presentPopoverFromRect:popoverRectFromCell 
                             inView:tappedCell 
           permittedArrowDirections:UIPopoverArrowDirectionUp 
                           animated:YES]; 
```

当然，您可以调整“popoverRectFromCell”以获得所需的结果。

但是，我不确定这是否真的是 UIPopoverController 的用例。当用户点击一个单元格时，制作一个自定义视图并将其用于文本输入可能会更容易。

# if-statement - 根据 Google 表格中列中的最后一个非空单元格添加到单元格值

> ID：12522095
> 
> 赞同：1
> 
> 时间：2012-09-20T22:56:13.550
> 
> 标签：if-statement, google-sheets, google-sheets-formula

在具有周期性值的列中（例如，A1 = “1.1”，A2 = “”，A3 = “1.2”），我找不到自动化的解决方案。

也就是说，如果 A1 = "1.1"，我希望该列中的下一个单元格是一个序号。换句话说，如果我将这篇文章中的任何公式粘贴到 A5 中，其中 A1 = 1.1，A2 到 A4 = 空白，那么 A5 应该 = A1+0.1。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T21:43:01.793

如果我理解正确的话，这个公式可以在 A5 中输入：

```
=MAX(A$1:A4)+0.1 
```

然后可以将该单元格复制并粘贴到该列的其他单元格中，并且范围引用应根据需要更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T01:03:21.320

任何非 VBA 的简单解决方案都是使用 B2 中的此公式运行 2 个单独的列：

```
=if(A2="",B1,B1+0.1) 
```

如果您想清除该列表中的一些值，请运行 C2 中的另一个公式：

```
=if(B2=B1,"",B2) 
```

然后将此列复制并粘贴为值。

# c++ - 在 C++ 中，对于默认行为与显式代码是否存在共识？

> ID：12522099
> 
> 赞同：10
> 
> 时间：2012-09-20T22:56:30.720
> 
> 标签：c++

我想知道是否有任何理由明确编写与 C++ 的默认行为相同的代码。

这是一些代码：

```
class BaseClass
{
public:
    virtual ~BaseClass() {}

    virtual void f() { /* do something */ }
};

class ExplicitClass
    : public BaseClass
{
public:
    ExplicitClass()
        : BaseClass()   // <-- explicit call of base class constructor
    {
        // empty function
    }

    virtual ~ExplicitClass() {}  // <-- explicit empty virtual destructor

    virtual void f() { BaseClass::f(); }  // <-- function just calls base
};

class ImplicitClass
    : public BaseClass
{    
}; 
```

我主要对重构和不断变化的代码库感到好奇。我不认为许多编码人员打算编写这样的代码，但是当代码随着时间的推移发生变化时，它最终会看起来像这样。

将代码保留在 中是否有任何意义`ExplicitClass`？我可以看到它向您展示正在发生的事情的好处，但它给人的印象是容易掉毛且有风险。

就我个人而言，我更喜欢删除任何默认行为代码（如`ImplicitClass`）的代码。

是否有任何赞成一种方式的共识？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T00:22:14.633

这个问题有两种方法：

1.  定义一切，即使编译器生成相同，
2.  没有定义任何编译会做得更好的东西。

(1) 的信徒正在使用如下规则：“始终定义默认 c-tor、复制 C-tor、赋值运算符和 d-tor”。

(1) 信徒认为拥有比错过更安全。不幸的是（1）特别受到我们的经理们的喜爱——他们相信拥有总比没有好。Sp 这样的规则“总是定义四大”进入“编码标准”，必须遵守。

我相信（2）。对于存在此类编码标准的公司，我总是发表评论“不要定义复制 c-tor，因为编译器做得更好”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T01:10:47.227

无论哪种方式都可以，只要您了解那里真正发生了什么，以及不自己编写函数可能出现的问题。

**例外安全**：

编译器将生成隐式添加必要`throw`条件的函数。对于隐式创建的构造函数，这将是基类和成员的每个抛出条件。

**格式错误的代码**

在一些棘手的情况下，**一些自动生成的成员函数格式不正确。**这是一个例子：

```
class Derived;

class Base
{
public:
  virtual Base& /* or Derived& */
  operator=( const Derived& ) throw( B1 );

  virtual ~Base() throw( B2 );
};

class Member
{
public:
  Member& operator=( const Member& ) throw( M1 );
  ~Member() throw( M2 );
};

class Derived : public Base
{
  Member m_;
  //   Derived& Derived::operator=( const Derived& )
  //            throw( B1, M1 ); // error, ill-formed
  //   Derived::~Derived()
  //            throw( B2, M2 ); // error, ill-formed
}; 
```

格式`operator=`错误是因为它的 throw 指令至少应该像它的基类一样具有限制性，这意味着它应该抛出 B1，或者根本不抛出任何东西。这是有道理的，因为 Derived 对象也可以被视为 Base 对象。

请注意，只要您从不调用它，拥有一个格式错误的函数是完全合法的。

我基本上是在这里重写 GotW #69，所以如果你想了解更多细节，[你可以在这里找到它们](http://www.gotw.ca/gotw/069.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-21T01:55:59.630

这取决于您喜欢如何构建和阅读程序。当然，各有偏好和理由。

```
class ExplicitClass
    : public BaseClass
{
public: 
```

初始化非常重要。不初始化基础或成员可能会产生警告，这是正确的，或者在某些情况下会捕获错误。因此，如果启用了该警告集合，这真的开始有意义，您将警告级别保持在较高水平，并且警告会倒计时。它还有助于表明意图：

```
 ExplicitClass()
        : BaseClass()   // <-- explicit call of base class constructor
    {
        // empty function
    } 
```

在 IME 中，一个空的虚拟析构函数在统计上是导出 a 的最佳位置`virtual`（当然，如果对多个翻译可见，该定义将在其他地方）。您希望将其导出，因为有大量 rtti 和 vtable 信息可能最终导致二进制文件中不必要的膨胀。由于这个原因，我实际上非常定期地定义空析构函数：

```
 virtual ~ExplicitClass() {}  // <-- explicit empty virtual destructor 
```

也许这是您团队中的约定，或者它记录了这正是实现的目的。这在大型代码库或复杂层次结构中也可能有帮助（主观），因为它还可以帮助提醒您该类型预期采用的动态接口。有些人更喜欢子类中的所有声明，因为他们可以在一个地方看到所有类的动态实现。因此，如果类层次结构/接口大于程序员的心理堆栈，则局部性可以帮助他们。像析构函数一样，这个 virtual 也可能是导出 typeinfo 的好地方：

```
 virtual void f() { BaseClass::f(); }  // <-- function just calls base
}; 
```

当然，如果您仅定义合格，则很难遵循程序或基本原理。因此，如果您只遵守约定，最终会得到一些更容易遵循的代码库，因为它比记录为什么每次都导出空析构函数更清楚。

最后一个原因（双向）是显式默认定义可以增加和减少构建和链接时间。

幸运的是，现在指定默认和删除的方法和构造函数更容易且明确。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-20T23:03:25.860

由于问题是关于共识，我无法回答，但我发现 ildjarn 的评论很有趣且正确。

根据您的问题，是否有理由这样写，因为显式和隐式类的行为并不相同。人们有时出于“维护”的原因这样做，例如，如果派生`f`以不同的方式实现以记住调用基类。我个人觉得这没什么用。

# grails - grails将多个子级添加到父域

> ID：12522100
> 
> 赞同：0
> 
> 时间：2012-09-20T22:56:31.553
> 
> 标签：grails, grails-orm, grails-domain-class

我在向父母添加子域时遇到了一些困难。这是课程：

```
 class parent{
String firstName
String lastName
String dobYear
String dobMonth
String dobDay
Date dateCreated
Date lastUpdated
long version

static hasMany = [
    chidlren: Children

]

static mapping = {
    cache true
    id generator: 'assigned'

    columns {
        firstName           type:'text'
        lastName            type:'text'
        dobYear             type:'text'
        dobMonth            type:'text'
        dobDay              type:'text'
    }

}
static constraints = {
    firstName           (nullable:true)
    lastName            (nullable:true)     
    dobYear             (nullable:true)
    dobMonth            (nullable:true)
    dobDay              (nullable:true)     
    id              (nullable:false)

} 
```

}

孩子们：

```
 class Children{

String skillId
String skillName    
String skillProficiency
String skillYears       
Date dateCreated
Date lastUpdated
long version

static belongsTo = [parent:Parent]
static mapping = {
    cache true
    columns {       
        skillId      type:'text'
        skillName    type:'text'
        skillProficiency type:'text'            
        skillYears   type:'text'
    }
}
static constraints = {

     skillId                    (nullable:true)
     skillName                  (nullable:true)
     skillProficiency           (nullable:true) 
     skillYears                 (nullable:true) 
} 
```

}

然后我像这样实例化父类： //my xml def feed= new XmlSlurper().parseText(linkedinResponse);

```
 def newParent= new Parent(
        firstName:"${feed.'first-name'}",
        lastName:"${feed.'last-name'}",
        dobYear :"${feed.'date-of-birth'.'year'}",
        dobMonth:"${feed.'date-of-birth'.'month'}",
        dobDay  :"${feed.'date-of-birth'.'day'}"        

       )
      .id="${feed.id}".toString() 
```

在我的 xml 提要中，我有多个子节点，所以我想创建多个域节点并将它们添加到父节点。xml 的东西工作正常：

```
 feed.skills.skill.each{ mySkill ->
def newChild = new Children(
              skillId:  mySkill.'id',
              skillName:    mySkill.'name',
              skillProficiency: mySkill.'proficiency',
              skillYears    :   mySkill.'years'
              )
          newParent.addToChildren(newChild )
      } 
```

当我尝试添加孩子时，出现错误（方法签名：com.myapp.Children.call() 适用于参数类型：() 值：[]）

除了额外的字段，这与我在 grails 网站上找到的示例有何不同，如下所示：

```
 def parent = new Parent(name:'Dad')
 parent.addToChildren(new Child(name:'son'))
 parent.addToChildren([name:'daughter']) 
```

谢谢你的帮助

杰森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T03:07:34.223

也许是一个错字。在您的示例中，您可以阅读：

```
static hasMany = [
    chidlren: Children
] 
```

应该：

```
static hasMany = [
    children: Children
] 
```

# iphone - CGContextShowTextAtPoint 中的文本换行 NSString

> ID：12522104
> 
> 赞同：0
> 
> 时间：2012-09-20T22:56:51.457
> 
> 标签：iphone, xcode, nsstring, uiimage, drawing

我试图将传递给 CGContextShowTextAtPoint 的 NSString 包装起来，这样它就不会从图像中扩展出来。这是我的代码：

```
int w = img.size.width;
int h = img.size.height;
CGFloat fMid = 14;

CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
CGContextRef context = CGBitmapContextCreate(NULL, w, h, 8, 4 * w, colorSpace, kCGImageAlphaPremultipliedFirst);

CGContextDrawImage(context, CGRectMake(0, 0, w, h), img.CGImage);
CGContextSetRGBFillColor(context, 0.0, 0.0, 1.0, 1);

char* text  = (char *)[text1 cStringUsingEncoding:NSASCIIStringEncoding];

CGContextSelectFont(context, "Arial", fMid, kCGEncodingMacRoman);
CGContextSetTextDrawingMode(context, kCGTextFill);
CGContextSetRGBFillColor(context, 255, 255, 255, 1);
CGContextShowTextAtPoint(context, 0, fMid, text, strlen(text));

CGImageRef imageMasked = CGBitmapContextCreateImage(context);
CGContextRelease(context);
CGColorSpaceRelease(colorSpace);

return [UIImage imageWithCGImage:imageMasked] 
```

# ruby-on-rails-3 - 一个模型与另一个模型的属性之间的关联

> ID：12522110
> 
> 赞同：0
> 
> 时间：2012-09-20T22:57:49.563
> 
> 标签：ruby-on-rails-3, activerecord, associations, models

我正在尝试在一个模型 Cuts 和另一个模型 Animal 的“animal_type”属性之间为 beta 肉类销售应用程序创建关联，这样我就可以列出与特定 animal_type 相关联（或与具有该类型作为属性的动物）。

换句话说，如果 animal_type 是“cow”，我应该能够调用与奶牛相关的所有切割（肋眼、里脊肉等）的列表。我是 Rails 的新手，这完全超出了我的想象。

我的想法是在 Cuts and Animals 中创建一个 animal_type 列，将每个剪辑与一种动物相关联，这样我就可以按照以下方式做一些事情

```
@cuts = Cut.where(:animal_type => Animal::animal_type[:Cow]) 
```

不过，不知道这是否可行，以及我还需要做什么才能使这种关联成为可能。任何人都可以帮我指出一种思考方式吗？或者有没有人有任何好的资源可以帮助我解决这个特定问题？我一直在浏览 Rails Guides，它们很有帮助，但它们并没有真正给我一个回答这个问题的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T09:13:30.753

你可以有一个 Cuts 模型和一个 Animal 模型。Cuts 可以有一个名为“name”的字符串属性，该属性将存储切割类型，例如肋眼、里脊肉等。Animal 可以有一个名为 animal_type 的字符串属性。然后，您可以在 Animals 和 Cuts 之间设置 has_many 关联。像这样的东西：

```
class Animal < ActiveRecord::Base
  attr_accessible :animal_type
  has_many :cuts
end

class Cuts < ActiveRecord::Base
  attr_accessible :name
  belongs_to :animals
end 
```

这应该是一个好的开始

# spring - 用于使输入字段增长的 Spring CSS

> ID：12522111
> 
> 赞同：0
> 
> 时间：2012-09-20T22:57:53.253
> 
> 标签：spring, spring-mvc, spring-webflow

几周前，我发现了一个带有 spring 样式表的很好的 spring 示例，但我现在找不到它们。此示例将使用 spring lib 使输入字段随着用户单击而增长。

它看起来就像这个，但我所要做的就是添加一个标签..

[http://tumblr.gesteves.com/post/475773360/css-glow-effects-with-box-shadow](http://tumblr.gesteves.com/post/475773360/css-glow-effects-with-box-shadow)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T07:04:59.047

不确定 Spring CSS，但我使用 jQuery.Check this **[fiddle](http://jsfiddle.net/Ajinkya_Parakh/nyG8T/embedded/result/)**做到了。
它将动态增加输入宽度以适应用户输入。

# objective-c - 如何为 NSOutlineView 中的每一行绘制不同的自定义数据单元格？

> ID：12522112
> 
> 赞同：1
> 
> 时间：2012-09-20T22:57:56.983
> 
> 标签：objective-c, cocoa

我只为 1 列设置了一个大纲视图，其中大纲视图单元格具有基于单元格的架构。我以两种方式配置单元格：

*   在 Nib 文件中，通过将单元格的类类型设置为 MyCustom Cell。
*   通过代码，通过使用方法在委托类中设置单元格： - (NSCell *)outlineView:(NSOutlineView *)outlineView dataCellForTableColumn:(NSTableColumn *)tableColumn item:(id)item

我在每个单元格上都设置了通知，当我从某个地方发布通知时，我希望单元格对通知采取相应的行动。在设置代码时，一切对我来说都是正确的，但是当我运行代码时，通知只会添加一行。应该为每一行添加它，因为我的大纲视图中有很多行。

这就是我在`NSCell`子类中设置通知观察的方式：

```
- (id)init {
   if ((self = [super init])) {
      [[NSNotificationCenter defaultCenter] removeObserver:self
                  name:MyNotification object:nil];
      [[NSNotificationCenter defaultCenter] addObserver:self
    selector:@selector(textDidChange:) name:MyNotification object:nil];
   } 
   return self;
}

 - (void)textDidChange:(NSNotification*)aNotification {
     NSDictionary *userInfo = [aNotification userInfo];
     NSString *searchString = [userInfo objectForKey:@"searchText"];
     if (searchString) {
      // Do something here 
     }
 } 
```

我在其他班级发帖`MyNotification`。

有人可以帮我解决我的实施中有什么问题吗？

在此先感谢 RKS

# java - 玩2.0如何定义一个多键取景器

> ID：12522113
> 
> 赞同：0
> 
> 时间：2012-09-20T22:57:57.287
> 
> 标签：java, playframework, playframework-2.0, ebean

假设有一个具有唯一约束的 Model bean，它结合了两列（作为复合主键），如下所示：

```
@Entity
@Table(uniqueConstraints = {  @UniqueConstraint(columnNames = { "key1", "key2" }) })
public class Rating extends Model {

    @ManyToOne
    @JoinColumn(name="key1", nullable=false)
    public Post key1;

    @ManyToOne
    @JoinColumn(name="key2", nullable=false)
    public User key2;
    ...
} 
```

如何找到具有以下签名的方法的查找器：

```
public static Rating get(Post key1, User key2) { ... } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T12:46:23.477

AFAIK，您没有定义复合键，而只是两个属性之间的唯一约束。要定义复合键，您必须使用`@EmbeddedId`[ [1](http://docs.oracle.com/javaee/5/api/javax/persistence/IdClass.html) ] 或`@IdClass`[ [2](http://docs.oracle.com/javaee/5/api/javax/persistence/IdClass.html) ] 注释。

我会去`@EmbeddedId`，你可以在这里看到一个使用示例：[http ://weblogs.java.net/blog/bleonard/archive/2006/11/using_composite.html](http://weblogs.java.net/blog/bleonard/archive/2006/11/using_composite.html)

# javascript - 如何在客户端将javascript动画转换为视频输出

> ID：12522114
> 
> 赞同：0
> 
> 时间：2012-09-20T22:58:00.827
> 
> 标签：javascript, linux, video, ubuntu, video-capture

有没有什么简单的方法可以创建js动画的视频输出而不需要编辑js。如果这是绝对可能的，我该如何编辑 js 来创建动画的图像或视频。这必须非常非常快，因为我想对动画进行一些实时处理。

我在桌面上使用 Ubuntu。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T23:11:13.067

您可以使用 VLC ( [http://www.videolan.org/vlc/](http://www.videolan.org/vlc/) ) 将您的桌面捕获到电影文件中。

VLC 允许您应用过滤器，或者您可以将视频流式传输到后处理软件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T23:04:09.920

*真的很快*和 Javascript.... 并不能很好地结合在一起。根据您想要的动画质量，从*慢*到“Egads，我们需要一千台机器来渲染这个 5 分钟的场景”

你必须渲染一个想象，保存图像，然后渲染下一个。

你最好*使用*适合这项工作的系统、平台和软件。

# .htaccess - 为什么这个 RewriteRule 对 301 重定向有效，但没有别的？

> ID：12522117
> 
> 赞同：2
> 
> 时间：2012-09-20T22:58:32.623
> 
> 标签：.htaccess, url-rewriting

我有以下重写规则：

```
RewriteRule ^(.*)/white/(.*)/$ /$1/$2/?tags=white [R=301,L] 
```

它可以工作并更改以下内容：

```
http://bag-saver.com/uk/shop/white/clutch-bags/ 
```

进入：

```
http://bag-saver.com/uk/shop/clutch-bags/?tags=white 
```

但是，我不想要 301。我想简单地重写 URL。我尝试了以下方法：

```
RewriteRule ^(.*)/white/(.*)/$ /$1/$2/?tags=white [QSA,L] 
```

但是一旦我删除了 R=301，我就会得到 page not found 错误。

为什么是这样？

编辑 - 以下是其他规则：

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteRule ^(.*)-[0-9]{9}[0-9]+/$ /$1/ [R=301,L]
RewriteRule ^(.*)/white/(.*)/$ /$1/$2/?tags=white [R=301,L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T23:30:56.980

使用[[P] 标志](http://httpd.apache.org/docs/current/rewrite/flags.html)

```
RewriteRule ^(.*)/white/(.*)/$ /$1/$2/?tags=white [P] 
```

**更新**
其他选项只是删除`R=301`以避免强制重定向

```
RewriteRule ^(.*)/white/(.*)/$ /$1/$2/?tags=white [L] 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-23T05:10:16.203

要修复**页面未找到**错误，您可以尝试`index.php`在 Apache 中设置为默认页面，如果缺少，请打开 apache 配置文件`httpd.conf`：

```
vi httpd.conf 
```

找出如下所示的行：

```
DirectoryIndex 
```

现在根据您的要求进行设置：

```
DirectoryIndex index.html index.htm index.php 
```

保存并关闭文件。重新启动 Apache Web 服务器：

```
/etc/init.d/httpd restart 
```

请注意，如果您无权访问 Apache 配置文件。添加`DirectoryIndex`到您的`.htaccess`文件中。

# android - ViewPager 是否有任何已知问题？

> ID：12522118
> 
> 赞同：0
> 
> 时间：2012-09-20T22:58:39.580
> 
> 标签：android, android-layout

我正在使用没有片段的 ViewPager，并且需要支持 2.1+，所以我正在使用支持库。有谁知道是否有任何崩溃问题需要注意？或者任何不能与 ViewPager 配合使用的设备？我将发布这个有成千上万的下载，所以我需要知道是否有人知道任何问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T23:02:47.143

`ViewPager`在 Google 自己的应用程序中广泛使用，所以我认为可以肯定地说它已经过审查。是的，这些应用程序在 Android 2.1 上运行。

# html - div 后面的隐藏按钮仅显示提示

> ID：12522125
> 
> 赞同：2
> 
> 时间：2012-09-20T23:00:02.890
> 
> 标签：html, css, stylesheet

在一个网站上，我有一个项目列表。这些项目中的每一个都有一张图片或一个名称，我将其添加到这样的`<article>`标签中：

```
<article class="client-card">
    <p><img width="211" height="106" src="./img/ftm1.png" class="post-image" alt="ftm" title="ftm" /></p>
</article> 
```

这是一个测试的小提琴链接。可能图像不起作用：http: [//jsfiddle.net/9wQg3/](http://jsfiddle.net/9wQg3/)

在这些图片中的每一张旁边，我想添加一个带有放大镜的按钮，这将是一个按钮。此按钮还将包含文本：“有关此项目的更多信息”，但我只想让放大镜可见，而按钮的其余部分仍隐藏在`<article>`标签后面。这些项目按行放置，每行有三个项目，我将在每页中显示六个项目。每行都以 a 结尾，`<div class="clear"></div>`因为每篇文章都是向左浮动的。这是代码：

```
<article class="client-card">
    <p><img width="211" height="106" src="./img/ftm1.png" class="post-image" alt="ftm" title="ftm" /></p>
</article><div class="more-info"><a href="#">More information</a></div>
<article class="client-card">
    <p><img width="211" height="106" src="./img/fluid.png" class="post-image" alt="ftm" title="ftm" /></p>
</article><div class="more-info"><a href="#">More information</a></div>
<article class="client-card">
    <p><img width="211" height="106" src="./img/chemical.png" class="post-image" alt="ftm" title="ftm" /></p>
</article><div class="more-info"><a href="#">More information</a></div>
<div class="clear"></div>
<article class="client-card">
    <p><img width="211" height="106" src="./img/alcmelgar.png" class="post-image" alt="ftm" title="ftm" /></p>
</article><div class="more-info"><a href="#">More information</a></div>
<article class="client-card">
    <p>COLOMBIAN PRESERVED FLOWERS</p>
</article><div class="more-info"><a href="#">More information</a></div>
<article class="client-card">
    <p><img width="211" height="106" src="./img/fit.png" class="post-image" alt="ftm" title="ftm" /></p>
<div class="clear"></div> 
```

这是我的样式表：

```
div.client-list article.client-card{
    width: 288px;
    height: 130px;
    background: transparent url(images/bg-client-card.png) no-repeat scroll center;
    float: left;
    margin-left: 24px;
    margin: 20px 0px 0px 24px;
/*  position: relative; */
}
div.client-list article.client-card p{
    line-height: 110px;
    margin-top: 10px;
    width: 100%;
    text-align: center;
    vertical-align: middle;
    color: #030303;
    font: normal 14px/110px "FuturaLtBTLight", Arial;
}
div.client-list div.more-info{
    width: 290px;
    height: 24px;
    line-height: 24px;
    background: #ea1571;
    float: left;
    margin: 20px 0px 0px 0px;
    position: relative;
    top: 0px;
    left: -290px;
/*  display: none; */
} 
```

好的，当我使用该代码时，我得到以下结果： ![在此处输入图像描述](../Images/399554211257ab7300ac4c39041a2765.png)

如您所见，这些行看起来有问题，其中只有 4 个显示“更多信息”链接。我留下了一些用于测试的代码。

我尝试了不同的css替代方案以及插入标签内部，但没有任何效果，你能指出我做错了什么以及如何纠正它吗？（我忘了指出包含 div 的最大宽度是 1000px）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T09:43:11.790

1.  放置：

    ```
    <div class="more-info"><a href="#">More information</a></div>
    <a href="#" class="more-info-control">magnyfying glass</a> 
    ```

    在文章标签内

2.  在css中修改：

    ```
    div.client-list article.client-card{
        position: relative;
    }

    div.client-list div.more-info{
        width: 290px;
        height: 24px;
        line-height: 24px;
        background: #ea1571;
        position: absolute;
        top: 0px;
        left: -1px;
        display: none;
    } 
    ```

    重要的是 article.client-card 是**position: relative;**
    div.more-info**在**文章内并且是**position: absolute;**

    这样，div.more-info 的 0,0 参考点不是浏览器窗口的左上角，而是最近的父相关元素的左上角（在本例中是 article.client-card）左值可以定位更多信息 div。

3.  然后，使用 jquery，您可以控制何时显示“更多信息”div（仅示例代码）

    ```
    $jq("more-info-control").click(function(event) {
         $jq("div.more-info", $jq(this).parent()).show();
    }); 
    ```

# sql - Oracle SQL - 在一个查询中生成一行答案的最简单方法，所以我不必多次运行查询？

> ID：12522127
> 
> 赞同：1
> 
> 时间：2012-09-20T23:00:05.907
> 
> 标签：sql, oracle

我有这个简单的查询：

```
Select 
To_Date('2012-sep-03','yyyy-mon-dd')as Date_Of_Concern,
Count(Player_Id) as Retained
From Player
Where
(To_Date('2012-sep-03','yyyy-mon-dd')-Trunc(Init_Dtime))<=7 
```

结果：

```
Date_Of_Concern         Retained
 03-Sep-12               81319 
```

此查询计算我的数据库中在特定日期后 7 天内登录(init_dtime) 的所有玩家。

就目前而言，对于我希望了解的每个“关注日”，我将不得不多次运行此查询。有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T23:02:27.833

只需使用`GROUP BY`按天计算：

```
Select 
To_Date(Init_Dtime,'yyyy-mon-dd') as Date_Of_Concern,
Count(Player_Id) as Retained
From Player
Where
(To_Date('2012-sep-03','yyyy-mon-dd') - Trunc(Init_Dtime)) <= 7
GROUP BY To_Date(Init_Dtime,'yyyy-mon-dd')
ORDER BY To_Date(Init_Dtime,'yyyy-mon-dd') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T10:04:06.723

如果您需要针对多个日期运行此查询，则需要一些平均值来保存多个值。我建议你使用一个[`NESTED TABLE`](http://docs.oracle.com/cd/E11882_01/server.112/e26088/sql_elements001.htm#i46449)对象：

```
CREATE TYPE my_dates AS TABLE OF DATE;
/

SELECT d.column_value AS Date_Of_Concern, count(Player_Id) AS Retained
  FROM Player
  JOIN TABLE (my_dates(to_date('2012-sep-03', 'yyyy-mon-dd'),
                       to_date('2012-sep-04', 'yyyy-mon-dd'),
                       to_date('2012-sep-05', 'yyyy-mon-dd'))) d
          ON d.column_value - trunc(Init_Dtime) BETWEEN 0 AND 7
 GROUP BY d.column_value 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-20T23:20:51.900

> 在特定日期的 7 天内

为了能够做你想做的事，你必须通过公式或日期范围知道你所说的“特定日期”。任何随机日期显然都需要用户输入该日期或修改查询以针对该日期运行（您提到的方式）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-21T04:20:33.053

不确定我是否理解正确，但这可能是您想要的。虽然可能有次优的性能。

```
12:32:22 HR@vm_xe> l                                                                        
  1   with player(id, dt) as (                                                              
  2     select 1, date '2012-01-01' from dual union all                                     
  3     select 2, date '2012-01-01' from dual union all                                     
  4     select 3, date '2012-01-02' from dual union all                                     
  5     select 4, date '2012-01-03' from dual union all                                     
  6     select 5, date '2012-01-04' from dual union all                                     
  7     select 6, date '2012-01-05' from dual union all                                     
  8     select 7, date '2012-01-06' from dual union all                                     
  9     select 8, date '2012-01-07' from dual union all                                     
 10     select 9, date '2012-01-08' from dual union all                                     
 11     select 10, date '2012-01-09' from dual union all                                    
 12     select 11, date '2012-01-10' from dual                                              
 13   )                                                                                     
 14     select distinct                                                                     
 15            to_char(dt, 'dd-mm-yyyy') dt                                                 
 16            ,count(*) over (order by trunc(dt) range interval '7' day preceding) week_cnt
 17       from player                                                                       
 18*     order by 1, 2                                                                      
12:32:22 HR@vm_xe> /                                                                        

DT           WEEK_CNT                                                                       
---------- ----------                                                                       
01-01-2012          2                                                                       
02-01-2012          3                                                                       
03-01-2012          4                                                                       
04-01-2012          5                                                                       
05-01-2012          6                                                                       
06-01-2012          7                                                                       
07-01-2012          8                                                                       
08-01-2012          9                                                                       
09-01-2012          8                                                                       
10-01-2012          8                                                                       

10 rows selected.                                                                           

Elapsed: 00:00:00.01 
```

ps不要像这样编码

```
(To_Date('2012-sep-03','yyyy-mon-dd')-Trunc(Init_Dtime))<=7 
```

像这样的代码

```
init_time between to_date('2012-SEP-03', 'yyyy-mon-dd') and to_date('2012-SEP-03', 'yyyy-mon-dd') + 7 
```

除非你不关心索引，当然:)

# wordpress - 错误：脚本头过早结束

> ID：12522128
> 
> 赞同：0
> 
> 时间：2012-09-20T23:00:06.137
> 
> 标签：wordpress, .htaccess

我在 Wordpress 上遇到了超过 500 个内部服务器错误。我和 123reg 在一起，他们似乎以糟糕的客户支持而闻名，所以我一直在努力解决自己的问题。

一点背景 - 作为 123reg 安装在 /wp/ 子目录上的 Wordpress 不允许在 root 上自动安装。保存帖子和偶尔浏览网站时出现 500 错误。一周内>10次。

收到以下错误消息；

```
2012-09-20T13:11:55+01:00 linweb9 httpd[13273]: [error] [client 95.151.187.161] Premature end of script headers: post.php, referer: http://www.asprayni.com/wp/wp-admin/post.php?post=6769&action=edit
2012-09-20T13:15:15+01:00 linweb9 httpd[14309]: [error] [client 95.151.187.161] Premature end of script headers: post.php, referer: http://www.asprayni.com/wp/wp-admin/post.php?post=6769&action=edit
2012-09-20T13:20:16+01:00 linweb9 httpd[15261]: [error] [client 95.151.187.161] Premature end of script headers: admin-ajax.php, referer: http://www.asprayni.com/wp/wp-admin/post.php?post=6769&action=edit 
```

如果有人能提供任何见解或建议，我将不胜感激。我的 .htaccess 看起来像这样；

```
RewriteEngine On

RewriteCond %{HTTP_HOST} ^****.com$ [NC,OR]
RewriteCond %{HTTP_HOST} ^www.****.com$ [NC]
RewriteCond %{REQUEST_URI} !^/wp/
RewriteRule ^(.*)$ /wp/ [L] 
```

提前感谢任何可以提供帮助的人！另外，我不能定义超过 64mb，`php.ini`因为我认为这是 123reg 共享托管站点的限制。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T23:10:21.637

这通常发生在您的 php 进程被杀死时。看到这似乎在共享主机上，服务器可能负载很重，并且由于资源使用而导致进程被杀死。

至于你能做些什么，除了 123reg 客户支持，没什么。您可以尝试优化您的 php，但由于您使用的是 wordpress，我怀疑您可以做很多事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T03:50:30.860

500 错误是服务器错误；httpd 错误意味着该 apache 进程已被杀死。除了更改主机之外，我不知道您将如何解决它。不要把头撞到墙上，找一个更好的主人。

除此之外，您的 .htaccess WP 重写块不是标准的。一，强制www或不强制www并在两者之间重定向，只需在仪表板>>设置>>常规中添加或删除www。

二，WP 重写块的其余部分应如下所示：

```
RewriteEngine On

RewriteBase /wp/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /wp/index.php [L] 
```

# python - 我需要什么才能在我的浏览器中成功运行一个执行 Python 脚本的网站？

> ID：12522136
> 
> 赞同：0
> 
> 时间：2012-09-20T23:00:46.170
> 
> 标签：python, mysql, web

我目前在我的 Mac 上只有一个本地网站。我可以查看网页的 HTMl 和 CSS 并在我的计算机上的浏览器中运行 javascript 函数，但我想要采取的下一步是合并 python 脚本来访问 MySQL 数据库并返回结果。

我显然对此很陌生，并且希望得到一些指导。现在，在我的电脑上，我已经安装了 MySQL，我可以在终端上运行它就好了。就数据库和服务器设备而言，我还需要什么——如果有的话——让一些动态网站在本地运行？我目前（尽管非常有限）的理解是，我的机器上存储了一个 MySQL 数据库，可以通过 Python 脚本（也在我的机器上）以及 HTML 文件中指向该脚本的链接进行访问。这是否正确，或者您是否推荐某些教程来填补空白或从头开始教我？

对不起，我问了很多；我发现的几个教程似乎涵盖了我希望做的事情。提前谢谢了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T23:41:26.013

干得好。[https://docs.djangoproject.com/en/1.4/intro/install/](https://docs.djangoproject.com/en/1.4/intro/install/)
只需按照安装指南，您将立即启动并运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-21T00:04:02.900

如果您的机器上安装了 MySQL 和 Python，请获取适用于 Python 的 MySQLDb 库版本并享受其中的乐趣。此外，您几乎可以使用这些组合进行任何数据操作。如果您希望您的网站上线（并且不希望通过 Web 框架），只需寻找一个托管计划，该计划可为您提供安装 Python 的服务器访问权限。

# .net - 对于 OData 查询，是否保证 $filter 在 $skip 之前执行？

> ID：12522138
> 
> 赞同：1
> 
> 时间：2012-09-20T23:00:50.867
> 
> 标签：.net, asp.net-web-api, expression, odata

如果始终在操作之前应用操作，我在[OData 协议文档](http://www.odata.org/media/30002/OData.html)中找不到提及。显然，在实现一致的页面检索算法时这样做是有意义的。`$filter``$skip`

我担心的是表达式树不会施加这样的约束。例如，以下两个查询通常会产生不同的结果。

```
IQueryable<string> query = (new[] { "aaa", "eee", "bbbb", "cccc", "dddd" }).AsQueryable();

query.Where(arg => arg.Length > 3).Skip(1);
query.Skip(1).Where(arg => arg.Length > 3); 
```

我已经对 OData 的 ASP.NET Web API RC 实现进行了一些简单的测试，它确实适用于`$filter`before `$skip`，无论运算符出现在查询字符串中的什么位置。但总的来说这是真的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T16:44:55.920

MS-ODATA（OData 的 OSP 规范）[声明](http://msdn.microsoft.com/en-us/library/dd541392%28v=PROT.10%29.aspx)：必须评估存在多个查询选项的数据服务 URI，就好像查询选项应用于 URI 的资源路径部分标识的资源一样，在以下顺序：$format、$inlinecount、$filter、$orderby、$skiptoken、$skip、$top、$expand。

我认为规范中实际上有一两个错误（应该在下一个规范更新中解决） - 我添加了这条评论：$inlinecount 如何在 $filter 之前生效，以及 $filter/$orderby 如何在 $ 之前生效扩张？

无论如何，您可以假设规范确实对系统查询选项进行了排序，并且它目前在规范中是必须的，因此任何声称支持 OData 的服务器都应该在 $skip 或 $top 之前始终评估 $filter。

# jquery - 尾声滑块 2 中的自动高度问题

> ID：12522142
> 
> 赞同：0
> 
> 时间：2012-09-20T23:01:08.700
> 
> 标签：jquery, coda-slider

我正在使用 coda slider 2 来包装一些内容

[http://gidzior.net/coda/#3](http://gidzior.net/coda/#3)

单击蓝色区域后，我正在尝试自动调整 coda 面板高度

我在下面使用 jQuery 代码（'p.legend'）是一个蓝色区域：

```
$('p.legend').click(function(){
    $(this).next().slideToggle('fast');
    $(this).toggleClass('down');
    // click in current coda tab for auto height
    $('#coda-nav-1 a.current').click();
}); 
```

尾声滑块 -`$('#project-slider').codaSlider();`

但是正如您在我的示例中看到的那样，发生了一些奇怪的事情，出了什么问题？

# cocos2d-iphone - 不适合iPhone 5屏幕的cocos2D游戏苹果会拒绝吗？

> ID：12522143
> 
> 赞同：5
> 
> 时间：2012-09-20T23:01:21.907
> 
> 标签：cocos2d-iphone, iphone-5

过两天我会把iPhone版的Cocos2D游戏上传到itunesconnect进行审核。现在这款游戏不支持 iPhone 5 分辨率，但同时支持 iPhone 4S 和 iPhone 3GS。Apple 是否会因为不兼容 iPhone 5 或（也许，我现在不知道）cocos2d 精灵的不正确行为而拒绝此应用程序？我会在第一个补丁中纠正这个问题，但现在我需要立即发布游戏，因为游戏不属于我，客户希望它尽快发布。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T07:41:00.600

不会。同样，Apple 不会拒绝不支持 iPad 分辨率的 iPhone 应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-20T23:11:26.000

在 iOS 6 上运行的较旧的 iOS 应用程序将自动进行信箱处理（屏幕顶部和底部有黑色空格），因此您不必担心屏幕布局。然而，iOS 6 中还有很多其他的东西可能会破坏旧的应用程序，因此您肯定希望至少在 iOS 6 4 英寸屏幕模拟器上运行该应用程序（并且 sim 不会捕获所有潜在问题）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-27T18:38:59.810

是的。

从 2013 年 5 月 1 日起，如果 iPhone 5 不受支持，Apple 将拒绝所有应用程序。iPhone HD 是必须的，但不是 iPad HD。您需要做的只是在屏幕截图中上传 iPad 高清图像。

# gdb - 使用 gdb 调试 myprog.f90：break line errs "No line in file"

> ID：12522144
> 
> 赞同：0
> 
> 时间：2012-09-20T23:01:27.917
> 
> 标签：gdb, break, fortran90

我正在使用 gdb 调试一个 fortran90 程序 myprog.f90，它使用了一些模块，比如 mod1 和 mod2。

我启动 gdb... $ gdb ./program

并尝试设置换行符... (gdb) break 80

但我收到错误“文件'mod1.f90'中没有第80行”。因此，虽然我试图在 myprog.f90 中设置换行符，但它试图在程序 mod1 的第一个模块中设置换行符。

如何换行并单步执行 myprog.f90？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T03:00:25.743

做这个：

```
(gdb) break myprog.f90:80 
```

另请参阅有关设置断点和[位置](http://sourceware.org/gdb/onlinedocs/gdb/Specify-Location.html)规范的[文档。](http://sourceware.org/gdb/onlinedocs/gdb/Set-Breaks.html)

# xamarin.ios - 直接更新 UIButton 或 SetNeedsDisplay

> ID：12522148
> 
> 赞同：1
> 
> 时间：2012-09-20T23:01:43.527
> 
> 标签：xamarin.ios

我有一个自定义 UITableViewCell 类，其中包含一个用于收藏单元格的 UIButton。当用户点击按钮时，它会切换“收藏”状态。以下代码是执行此操作的正确方法还是应该覆盖 UIButton 的 Draw 方法并调用 SetNeedsDisplay 来触发重绘？

```
internal class HappyCell : UITableViewCell
{
    private bool _favorite;
    private UIButton _button;

    public bool Favorite {
        get { return _favorite; }
        private set {
            _favorite = value;
            if (_button != null) {
                _button.SetImage (_favorite ? FavImage : FavedImage, UIControlState.Normal);
            }
        }
    } 
```

# core-data - 具有多个文本字段的多个单元格到核心数据属性

> ID：12522159
> 
> 赞同：1
> 
> 时间：2012-09-20T23:03:15.933
> 
> 标签：core-data, uitableview

我有一个包含 9 个单元格的表格视图，在每个单元格中我至少有 2 个文本字段。每个单元格都有一个标签，每个单元格中的 textfields.placeholder 都是相同的：（下面的示例照片）

![在此处输入图像描述](../Images/cecc61151ca439a15a4de4269acaa077.png)

我已经在核心数据中创建了实体（它们是标签）和每个实体的属性（它们是 textfields.placeholder）：

![在此处输入图像描述](../Images/29bdf4ff2fb713c8c26230da64a4fb41.png)

我的问题是，如何将 textfield.text 设置为每个实体中的每个属性？如何区分文本字段？....我不认为 IF 语句是最好的方法（它会很多！！），另一个问题是单元格是动态的（所以用户可以添加更多种类例如裤子）...

任何想法都将不胜感激......我真的被卡住了！

提前致谢。

我读了一点，但我很难理解一些东西：当你说“你可以为每个单元格设置一个对象”时，你指的是核心数据为每个实体自动创建的类（当你点击子类 NSmanageobject按钮），然后我应该将每个单元格中的 texfields 绑定到每个实体类的对象？？。我已经有了引用每个单元格的类，然后我想我应该这样做： Trousers *trouse = [ NSEntityDescription insertNewObjectForEntityForName:@"Trousers" inManagedObjectContext:self.managedObjectContext]; trouse.nameProduct =Textfield.text.and 这是我没有最好的方法的部分，因为我在每个单元格中有多个文本字段（并且我不会让它们成为我的视图的属性）并且像这将是一项巨大的工作！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T10:57:43.920

如果您将 CoreData 与表格视图一起使用，您应该使用 NSFetchedResultsController 将模型对象连接到[UI](http://developer.apple.com/library/ios/#DOCUMENTATION/CoreData/Reference/NSFetchedResultsController_Class/Reference/Reference.html)

查看文档和示例。它旨在使这种事情不那么痛苦。

# python - 如何从应用引擎中的数据存储中获取基于时间的实体

> ID：12522160
> 
> 赞同：1
> 
> 时间：2012-09-20T23:03:18.343
> 
> 标签：python, google-app-engine, app-engine-ndb

我在应用引擎上有一个应用程序，这个应用程序有一个名为 Appointment 的实体。约会有一个 start_time 和一个 end_time。我想根据时间获取约会，例如，我想获取给定日期的所有约会。

由于应用引擎不支持基于两个字段的不等式查询，我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T23:07:28.673

您可以为日期添加另一个字段。ComputedProperty 可能对此有意义。或者，您可以从一天的开始分批提取，并在一天结束时停止提取。我想你可以根据一天内通常有多少约会来制定一个合理的默认设置，以保持这种合理的效率。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T17:54:29.083

最大的问题是“日期”意味着根据用户的时区不同的开始和结束“时间”。而且您不能强迫所有用户一生都坚持一个时区，更不用说每年两次 DST 更改。因此，您不能像建议的那样简单地在实体中创建一个新属性来存储“日期”对象。（这就是 GAE 没有“日期”类型属性的原因。）

我构建了一个调度应用程序。当用户为事件指定所需的范围（可以是一天、一周或一个月）时，我会检索结束时间大于请求范围的开始时间的所有事件，然后循环遍历它们，直到我找到开始时间小于范围结束时间的最后一个事件。

您可以根据请求的范围（一个月多于一天）指定要在一个请求中获取多少个实体。例如，如果给定日历每天可能有 5-10 个事件，则获取前 10 个实体就足够了（如果不满足条件，您总是可以获取更多）。例如，您可以将一个月的批量大小设置为 100。然而，这是一个微优化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-20T23:09:23.227

```
"SELECT * FROM appointments WHERE start_time < {0} AND end_time > {0}".format(time_lookup) 
```

或者如果 appengine 不允许你这样做

```
Things.all().filter("end_time >", foo).filter("start_time <", foo) 
```

[http://nick.zoic.org/art/python/multiple_inequalities/](http://nick.zoic.org/art/python/multiple_inequalities/)

还[比较谷歌应用引擎数据存储中的许多日期范围（多对多，Python）](https://stackoverflow.com/questions/11161238/compare-many-date-ranges-in-google-app-engine-datastore-many-to-many-python)可能会有所帮助

# ruby-on-rails - “无法建立连接，因为目标机器主动拒绝它”与 Rails 3.2

> ID：12522165
> 
> 赞同：0
> 
> 时间：2012-09-20T23:03:41.010
> 
> 标签：ruby-on-rails, ruby, actionmailer, mailer

我正在使用 Rails 3.2，当我尝试使用`UserMailer`发送电子邮件时，它给了我错误：

```
"Errno::ECONNREFUSED (No connection could be made because the target machine actively refused it. - connect(2))" 
```

在这条线上：

```
UserMailer.welcome_email(@user).deliver 
```

这是`create`电子邮件应该传递的功能：

```
def create
  @user = User.new(params[:user])

  respond_to do |format|
    if @user.save
      UserMailer.welcome_email(@user).deliver
      format.html { redirect_to @user, notice: 'User was successfully created.' }
      format.json { render json: @user, status: :created, location: @user }
    else
      format.html { render action: "new" }
      format.json { render json: @user.errors, status: :unprocessable_entity }
    end
  end
end 
```

有谁知道如何解决这个问题？我很确定我以前可以很好地发送电子邮件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T10:52:38.117

发现问题了，好像忘记在config/initializers下添加setup_mail.rb了。

# asp.net-mvc-3 - MVC 中的复杂数据库查询

> ID：12522168
> 
> 赞同：1
> 
> 时间：2012-09-20T23:04:51.357
> 
> 标签：asp.net-mvc-3, sql-server-2008

我正在尝试对数据库进行奇怪的查询，但我似乎不知道该怎么做。

我为这个问题制作了一个示例数据库，如下所示，因为它的专有性质，我无法显示真实的数据库。

[http://i.stack.imgur.com/DGDaQ.png](http://i.stack.imgur.com/DGDaQ.png)

我的目标是能够在同一页面上添加订单和订购商品，同时显示产品列表，如下所示。

[http://i.stack.imgur.com/QLMrB.jpg](http://i.stack.imgur.com/QLMrB.jpg)

并非每个订单都包含所有产品，但我仍然需要能够列出所有产品并能够输入数量（如果有的话）。我将如何使用 MVC 进行布局？目前，我在为订单创建视图中使用 ViewModel 来显示 ProductName 列表。我似乎无法弄清楚如何获取允许我为每个产品名称添加 OrderItems 信息的框。

# xml - XML 元素的子元素的通用处理

> ID：12522169
> 
> 赞同：1
> 
> 时间：2012-09-20T23:04:52.123
> 
> 标签：xml, xslt

假设我们有以下 XML...

```
<FruitBasket>
    <Basket>
        <Apple>1</Apple>
        <Banana>2</Banana>
        <Orange>3</Orange>
    </Basket>
    <Basket>
        <Avocado>1</Avocado>
        <Lemon>2</Lemon>
    </Basket>
</FruitBasket> 
```

使用 XSLT 我将如何生成以下转换？

```
<BasketContents>
    <Content>
        <FruitName>Apple</FruitName>
        <FruitAmount>1</FruitAmount>
        <FruitName>Banana</FruitName>
        <FruitAmount>2</FruitAmount>
        <FruitName>Orange</FruitName>
        <FruitAmount>3</FruitAmount>
    </Content>
    <Content>
        <FruitName>Avocado</FruitName>
        <FruitAmount>1</FruitAmount>
        <FruitName>Lemon</FruitName>
        <FruitAmount>2</FruitAmount>
    </Content>
</BasketContents> 
```

我通常需要这样做，而不知道篮子里有什么类型的水果 xslt 必须处理“篮子”的任何子元素。例如，我不知道篮子里装的是苹果还是鳄梨，也不知道篮子里有多少种水果。

基本上，这分解为需要知道如何调用子元素的名称，所以从 XML 的`<Basket>`元素中，我可能会应用一个模板来获取它的未知子元素的名称。

对不起，如果这个类比比有用更令人困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T23:22:50.583

如果水果名称不重复（或者如果重复的水果名称会产生两个`FruitName`,`FruitAmount`对），那么这样的事情应该可以满足您的需要：

```
<xsl:template match="/FruitBasket">
  <BasketContents>
    <xsl:apply-templates/>
  </BasketContents>
</xsl:template>

<xsl:template match="Basket">
  <Content>
    <xsl:apply-templates/>
  </Content>
</xsl:template>

<xsl:template match="Basket/*">
  <FruitName>
    <xsl:value-of select="name()"/>
  </FruitName>
  <FruitAmount>
    <xsl:value-of select="."/>
  </FruitAmount>
</xsl:template> 
```

如果您需要检测给定水果的多次出现并将它们的内容相加，那么您将需要阅读 XSLT 上一个很好的参考源中的分组。在 XSLT 1.0 中，要在索引中查找的关键字是“Muenchian grouping”。在 XSLT 2.0 中，分组更简单（有 group-by 结构）。

# c# - 获取 C# 应用程序的先前版本设置

> ID：12522170
> 
> 赞同：0
> 
> 时间：2012-09-20T23:05:01.780
> 
> 标签：c#

我有一个存储用户设置的旧 Winforms 应用程序。我已经在 WPF 中完全重写了应用程序，并希望迁移设置。我无法使用 Upgrade() 方法，因为我更改了大多数用户设置的名称。我找到了 GetPreviousVersion() 方法，但它失败了，因为旧设置不再存在于新应用程序中。此外，应用程序位于不同的命名空间中，我听说这会导致一些问题。任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T00:25:19.910

为什么不打开原始应用程序并运行 Upgrade() 只是为了查看它产生的结果？然后，您也可以尝试 GetPreviousVersion()。

# ruby - 修复“custom_require.rb:36:in `require': no such file to load”错误

> ID：12522176
> 
> 赞同：0
> 
> 时间：2012-09-20T23:05:43.957
> 
> 标签：ruby

我知道在 Ruby 1.9.2 之后，'.' 出于安全原因，不再出现在您的路径中。使用某些 gem 时这似乎是一个问题（我想那些没有更新到 1.9 的？），一个引发错误的问题

`$HOME/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in 'require': cannot load such file -- rubylog (LoadError)`

我已经看到并解决了这个问题一次，通过（也许天真地）将一些需求更改为 require_relatives：[https ://github.com/mathpunk/MongoDB_Koans/commit/e2f7898347d328450ec121d22f701508f389cc53](https://github.com/mathpunk/MongoDB_Koans/commit/e2f7898347d328450ec121d22f701508f389cc53)

现在我想使用 ruby​​log，我得到了 custom_require 错误，所以我尝试了同样的技巧： [https ://github.com/mathpunk/rubylog/commit/995e13dccc6a197d280d0783f3fb7fe50deabd02](https://github.com/mathpunk/rubylog/commit/995e13dccc6a197d280d0783f3fb7fe50deabd02)

但这一次，我遇到了同样的错误。我还能尝试什么？

**ETA：**一直以来，我一直在使用`sudo gem install blah`安装 gems，出于某种原因，对于 ruby​​log，它就是`gem install rubylog`这样做的。（与 RVM 有关？）所以现在一切正常。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T23:41:04.767

您的代码失败`require 'rubylog'`- 所以它无法找到 ruby​​log.rb 本身。所以只需添加包含 ruby​​log.rb 的目录来加载路径 - 类似的东西`$: << 'rubylog'`可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T23:15:24.703

只需将库目录添加到您的 LOAD_PATH：

```
$LOAD_PATH.unshift(File.dirname(__FILE__)) 
```

请参阅[了解 Ruby 的加载路径](https://stackoverflow.com/questions/6671318/understanding-rubys-load-paths)\

编辑：我假设您在`rubylog`运行脚本的任何地方都有一个目录。如果您的脚本找不到`rubylog`，那么您需要将该位置添加到您的加载路径：

```
$LOAD_PATH.unshift('/path/to/rubylog') 
```

你确定你有 ruby​​log 库吗？`gem install rubylog`

# c++ - C++ 为什么我的数组没有弹出到我的堆栈中？

> ID：12522179
> 
> 赞同：0
> 
> 时间：2012-09-20T23:06:35.710
> 
> 标签：c++, arrays, stack

我为学生记录创建了一个数组，并且应该将它弹出到我的堆栈中。除了我的 stack.pops 和 MAIN 中的 stack.pushes 之外，一切正常...我非常接近完成这个程序，我想知道是否有人知道解决方案？

```
#include <iostream>
#include <list>
#include <cstdlib>
#include <cstring>
#include <iomanip>
#include <string>

using namespace std;

class Studentrecords
{
private:
    struct student
    {
        string name;
        string address;
        int ID;
        double gpa;
    };

    student *stackArray;
    int stackSize;
    int top;

public:
    Studentrecords();
    Studentrecords(int size);
    ~Studentrecords();
    void push(string name, string address, int id, double gpa);
    void pop();
    bool isFull() const;
    bool isEmpty() const;
    void display();
};

Studentrecords::Studentrecords(int size)
{
    stackArray = new student[size];
    top = -1;
}

Studentrecords::Studentrecords()
{
    stackSize = 20;
    stackArray = new student[stackSize];
    top = -1;
}

Studentrecords::~Studentrecords()
{
    delete [] stackArray;
}

void Studentrecords::push (string name, string address, int id, double gpa)
{
    if (isFull())
    {
        cout << "The stack is full!" << endl;
    }
    else
    {
        student newStudent;
        newStudent.name = name;
        newStudent.address= address;
        newStudent.ID = id;
        newStudent.gpa = gpa;
        stackArray[top] = newStudent;
        top++;
    }
}

void Studentrecords::pop ()
{
    if (isEmpty())
    {
        cout << "The stack is empty!" << endl;
    }
    else
    {
        cout << stackArray[top-1].name << endl;
        cout << stackArray[top-1].address << endl;
        cout << stackArray[top-1].ID << endl;
        cout << stackArray[top-1].gpa << endl;
        top--;
    }
}

bool Studentrecords::isFull() const
{
    bool status;
    if (top == stackSize - 1)
        status = true;
    else
        status = false;
    return status;
}

bool Studentrecords::isEmpty() const
{
    bool status;
    if (top == -1)
        status = true;
    else
        status = false;
    return status;
}

void Studentrecords::display()
{
    for (int i = 0; i< top; i++)
    {
        cout << stackArray[i].name << endl;
        cout << stackArray[i].address << endl;
        cout << stackArray[i].ID << endl;
        cout << stackArray[i].gpa << endl << endl;
    }
}

int main()
{
    int catchVar;

    Studentrecords stack();

    cout << "Pushing 1st";
    stack.push("Jonny", "123 ave", 2343, 3.2);

    cout << "pushing 2nd";
    stack.push("Robby", "123 ave", 2343, 3.2);

    cout << "Popping ";
    stack.pop(catchVar);
    cout << catchVar << endl;

    cout << "Popping ";
    stack.pop(catchVar);
    cout << catchVar << endl;

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-20T23:08:09.560

```
Studentrecords stack(); 
```

不声明一个`Studentrecords`命名的`stack`，它声明一个`stack`返回一个命名的函数`Studentrecords`。将其更改为

```
Studentrecords stack; 
```

此外，您的类至少需要一个复制构造函数和赋值运算符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T23:11:23.753

你能发布编译器的错误吗？还是产生的输出与预期的输出？没有那个，我不得不说你的 pop 函数不接受参数并且你正在传递它 catchVar ......这将是一个编译器错误。

# python - Beautifulsoup python如何遍历表格中的单元格并找到链接

> ID：12522186
> 
> 赞同：1
> 
> 时间：2012-09-20T23:07:21.090
> 
> 标签：python, beautifulsoup

```
soup = BeautifulSoup(''.join(html))
table = soup.find("table")
firstRow = table.contents[0]

for tr in firstRow:
  if 'Total' in tr:
    text = ''.join(tr.find(text=True))
    print(text) 
```

有时表格元素包含文本链接而不是纯文本。在这种情况下，上面的 for 循环遍历所有单元格并且没有找到文本“Total”，因为它在里面 `<a title="err">Total</a>` 。如果有链接，如何修改循环以在链接中查找文本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T23:41:38.013

调用您的迭代变量`tr`具有误导性。您正在遍历*表格*行；单个项目是`td`或`th`元素，或只是单元格。不是表格行。

查看 Beautiful Soup 文档，看起来您想要该`string`属性：

> 如果标签只有一个子标签，并且该子标签是 NavigableString，则该子标签可用作 .string ...**如果标签的唯一子标签是另一个标签，并且该标签具有 .string，则认为父标签具有与它的孩子相同的 .string 。**

所以：

```
for cell in firstRow:
    if "Total" in cell.string:
        # ... 
```

如果这对您不起作用（即，除了字符串中的文本之外，单元格中还有您想要的内容）那么您想要做的是在测试“Total”*之前获取表格单元格中的所有文本：*

```
for cell in firstRow:
    text = "".join(cell.find_all(text=True))
    if "Total" in text:
        print(text) 
```

# java - Java 编程 - 允许扫描仪出现空行

> ID：12522190
> 
> 赞同：1
> 
> 时间：2012-09-20T23:07:34.663
> 
> 标签：java, text, input, scramble

我试图让我的 Java 程序接受空白文本行作为输入，并在最终输出中显示它们。

基本上我已经制作了一个单词加扰程序，它应该从扫描仪中接收未指定数量的文本，单独加扰每个单词，除了每个单词的第一个和最后一个字母。我已经成功地让加扰和解析工作，所以不用担心。我正在研究的最后一个规范是，用户可以点击“返回”按钮输入空白行文本。

因此，例如，如果有人进入： 比萨是我最喜欢吃的东西

输出类似于：Pziza is my fovaitre tnhig to eat

这在一行上完美运行，但如果有人要输入：

我

喜欢

动物

只有最后一行被打印和打乱：aimnlas

我尝试了一些我通过研究发现的不同建议，但大多数都是关于文件阅读和其他对我没有奏效的建议。这就是我现在正在做的：...

```
Scanner input = new Scanner(System.in);
    String text = "";
    System.out.println("Enter text to scramble: ");
    while(input.hasNextLine()){
        text = input.next();
    }
    System.out.println(scramble(text)); 
```

任何帮助将不胜感激。谢谢大家 =)

**编辑：** 好的，我在想我在争夺方法中所做的事情可能是阻止我允许空行的原因。我已经看过了，似乎无法确定它，所以如果有人可以请看一下，让我知道你认为我会感激它=）

```
private static String scramble(String txt) {
    StringTokenizer st = new StringTokenizer(txt, " ,.!?()-+/*=%@#$&:;\"'", true);
    String[] tokens = new String[st.countTokens()];
    String scrambled = "";
    int letter = 0;
    int wordlength = 0;
    char[] temp;

    while(st.hasMoreTokens()) {
        tokens[letter] = st.nextToken();
        letter++;
    }

    for(int i = 0; i < tokens.length; i++) {
        if(tokens[i].length() <= 3) {
            scrambled += tokens[i];
            continue;
        }   
        wordlength = tokens[i].length() - 1;
        temp = new char[wordlength + 1];
        temp[0] = tokens[i].charAt(0);
        temp[wordlength] = tokens[i].charAt(wordlength);
        ArrayList<Character> c = new ArrayList<Character>();
        for(int j = 1; j < wordlength; j++) {
          c.add(tokens[i].charAt(j));
        }
        Collections.shuffle(c);
        String z = new String();
        for(Character x:c){
          z += x.toString();
        }
        String output = new String(temp[0] + z + temp[wordlength]);
        scrambled += output;
    }
    return scrambled;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T23:42:24.163

从`System.in`读取时，默认情况下，您正在从键盘读取，这是一个无限的输入流，因此`Scanner.hasNextLine()`将始终返回 true。

一种解决方案是一次读取一行，然后使用以下命令将每一行拆分为单词`String.split()`：

```
Scanner input = new Scanner(System.in);
String text = "";
System.out.println("Enter text to scramble: ");
boolean done = false;
while (!done) {
   text = input.nextLine();

   if (text.equals("")) {
      done = true;
   } else {
      performScramble(text);
   }
}
...

void performScramble(String line) {
    String[] words = line.split("\\s+");
    for (String word: words) {
        System.out.println(scramble(word));
    }    
} 
```

# c# - 没有初始化向量的 C# TripleDES 提供程序？

> ID：12522191
> 
> 赞同：8
> 
> 时间：2012-09-20T23:07:51.247
> 
> 标签：c#, tripledes

我有一组来自远程系统的用 TripleDES 编码的加密文档。我需要在 C# 中解码数据，我无法控制密钥或编码算法。我所拥有的只是密钥和模式（CBC）以及位于文件中的数据。

TripleDESCryptoServiceProvider 很容易使用，但我不知道如何在没有初始化向量的情况下使用 Decryptor。

我们有一个 24 字节（192 位）的密钥来解密，但没有别的。

```
 string key = "1468697320656E6372797174696F6E206973737265206933";            
   byte[] keyData = ParseHex(key);  //  key is OK at 24 bytes                     

   TripleDESCryptoServiceProvider des = new TripleDESCryptoServiceProvider();
   des.Mode = CipherMode.CBC;            
   des.GenerateIV();

   var decryptor = des.CreateDecryptor(keyData,null);  // des.IV

   var encoded = File.ReadAllBytes(@"..\..\..\..\test.tdes");
   byte[] output = decryptor.TransformFinalBlock(encoded, 0, encoded.Length); 
```

这会因错误数据而彻底失败。如果我切换到 TransformBlock 代码至少会运行但只会产生乱码：

```
 byte[] output = new byte[10000];
   var count = decryptor.TransformBlock(encoded, 0, encoded.Length, output, 0); 
```

所以问题是：

*   如果我只有一个密钥，是否需要 InitializationVector？
*   如果不是 null 是正确的传递吗？
*   除了键和模式之外，我还需要设置什么？
*   为什么 TransformBlock 至少可以工作而 TransformFinalBlock 只是失败了？

### 更新 - 发现问题

事实证明，解码问题不是由缺少初始化向量引起的，而是由加密数据提供者提供的不正确信息引起的。更新后的工作代码如下所示：

```
 // Read the test data
        byte[] encoded = File.ReadAllBytes(@"..\..\..\..\test.tdes");            

        // Get the key into a byte array
        string key = "1468697320656E6372797174696F6E206973737265206933";           
        byte[] keyData = ParseHex(key);                        

        TripleDESCryptoServiceProvider des = new TripleDESCryptoServiceProvider();
        des.Mode = CipherMode.ECB;      // Make sure this is correct!!!
        des.Padding = PaddingMode.Zeros;   // Make sure this is correct!!!
        des.Key = keyData;

        var decryptor = des.CreateDecryptor();  
        byte[] output = decryptor.TransformFinalBlock(encoded, 0, encoded.Length);

        string dataString = Encoding.Default.GetString(encoded);
        Console.WriteLine(dataString);

        Console.WriteLine("\r\n\r\nDecoded:");
        string result = Encoding.Default.GetString(output);
        Console.WriteLine(result);

        Console.Read(); 
```

在我们的案例中，关键是使用正确的 CipherMode 和 Padding。修复填充使 TransformFinalBlock() 工作没有*坏数据*错误。修复 CipherMode 可以正确解密数据。

故事的寓意：在 CipherMode.ECB 模式下，至少有一个初始化向量，您不需要提供初始化向量。如果没有提供 IV，提供商将自动生成一个，但解密仍然有效（至少使用 ECB）。

最后，确保您拥有来自加密数据的提供商的*所有信息至关重要。*

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-20T23:27:58.477

试图回答每一点：

*   在 CBC 模式下需要初始化向量。它不需要是秘密（与密钥不同），因此它应该从远程系统发送。
*   由于您需要 IV，因此 null 不是正确的传递方式。
*   填充模式。您需要知道使用了哪种填充模式。
*   TransformFinalBlock 可能会失败，因为 Padding 模式错误。

**编辑**

ECB（电子密码本）和 CBC（密码块链接）之间的区别如下所示：

![欧洲央行模式](../Images/608db291cd4dffc68351617ec0b1807c.png)

![CBC模式](../Images/7300861bce34c6db366c396ea695dd2c.png)

如您所见，在 ECB 模式下没有使用 IV。因此，即使您提供一个，它也会被忽略。

# javascript - 从 ASP 网站中的单独文件中获取控制值？

> ID：12522193
> 
> 赞同：0
> 
> 时间：2012-09-20T23:07:58.610
> 
> 标签：javascript, asp.net, vb.net

我有两个单独的 .aspx 文件，它们在一个网页中使用。一个用于标题，另一个用于正文。在正文文件的 javascript 中，我将如何从标题中获取 asp:label 控件的值？它的名字是“lblName”，所以我简单地尝试了 document.getElementById("lblName").value 并且我收到了错误：

```
Microsoft JScript runtime error: Object required 
```

这个网站是用 Visual Basic 编写的，所以我想知道是否有人也知道如何从后面的代码中做到这一点。

如果我在浏览器 (IE) 中按 F12，这是我看到的层次结构：

```
<head>
<frameset rows="147,*" frameBorder="no" frameSpacing="0">
   <frame name="frHeader" id="frHeader" src="DistHeader.aspx?statProducer=0707090003" noResize="noresize" scrolling="auto">
   DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
   <html>
     <head>
     <body topMargin="1" rightMargin="0" bottomMargin="0">
       <div class="clsNoPrint">
          <div class="clsNoPrint">
          <table width="100%">
             <tbody>
                <tr class="clsNameBar" width="100%">
                  <td width="*" align="left"> 
                     <span class="clsNameBar" id="lblName" style="width: 100%;"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T23:21:39.207

如果您`runat="server"`的标签上有，那么它在浏览器中的 id 将与您在服务器上看到的不同。您必须以某种方式将其 ClinetID 传递给 JS。例如，`Page.RegisterStartupScript`如果你的 JS 是 aspx 文件的一部分，你可以这样做： `document.getElementById('<%=lblName.ClientID %>')`

另一个问题：我猜 lblName 是`<asp:Lable />`转换为没有的 span `.value`，但你可以使用这样的东西：

`document.getElementById('<%=lblName.ClientID %>').innerHTML`

当您使用框架时 - 根据您的代码所在的位置，您需要首先访问框架：

```
//Chrome, FF
document.getElementById("frHeader").contentDocument.getElementById("lblName") 

//IE (it does not support contentDocument and have document instead)
document.getElementById("frHeader").document.getElementById("lblName") 
```

假设您的代码在外部文档中，其中包含实际上包含一个框架。但如果它在另一个框架中 - 你应该在`window.parent.`之前添加`document.getElementById`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T22:13:02.480

由于这是一个几乎十年前创建的网站，我们必须在框架集中爬上梯子才能获得我们正在寻找的价值。下面的代码是使用的方法

```
var el =  parent.parent.frames("frHeader").document.getElementById("lblName").innerText; 
```

# sql - 我可以在子查询中使用多个列吗？

> ID：12522194
> 
> 赞同：3
> 
> 时间：2012-09-20T23:08:00.133
> 
> 标签：sql, sql-subselect

我想显示`EMPLOYEES`表中从事三个以上项目的所有员工的姓名`PROJECT`。

`PROJECTS.PersonID`是一个外键引用`EMPLOYEES.ID`：

```
SELECT NAME, ID 
FROM EMPLOYEES
WHERE ID IN
    ( 
    SELECT PersonID, COUNT(*)
    FROM PROJECTS
    GROUP BY PersonID
    HAVING COUNT(*) > 3
    ) 
```

我可以在那个子查询中同时拥有`PersonID`,`COUNT(*)`还是必须只有一列？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-20T23:10:43.260

不在`IN`子句中（或者至少不是您尝试使用它的方式。一些 RDBMS 允许在子句中包含多个列的元组，`IN`但在这里对您的情况没有帮助）

您只需`COUNT(*)`要从`SELECT`列表中删除 即可达到您想要的结果。

```
SELECT NAME, ID 
FROM EMPLOYEES
WHERE ID IN
    ( 
    SELECT PersonID
    FROM PROJECTS
    GROUP BY PersonID
    HAVING COUNT(*) > 3
    ) 
```

如果您还想返回计数，您可以连接到具有多个列的派生表或公用表表达式。

```
SELECT E.NAME,
       E.ID,
       P.Cnt
FROM   EMPLOYEES E
       JOIN (SELECT PersonID,
                    Count(*) AS Cnt
             FROM   PROJECTS
             GROUP  BY PersonID
             HAVING Count(*) > 3) P
         ON E.ID = P.PersonID 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-20T23:20:29.630

要回答您的问题，IN 子查询只能有 1 列。您可以使用以下查询获得结果：

```
SELECT e.ID
      ,e.Name 
FROM dbo.Projects p
LEFT OUTER JOIN dbo.Employees e
    ON p.PersonID = e.ID
GROUP BY e.ID
        ,e.Name 
HAVING COUNT(*) > 3 
```

# php - 带有类声明的 PSR2 在 PHP Code Sniffer 中扩展了带有命名空间的类

> ID：12522196
> 
> 赞同：5
> 
> 时间：2012-09-20T23:08:24.710
> 
> 标签：php, codesniffer

我遇到了使用 PSR2 标准的 PHPCS 问题。高低搜索，但令我惊讶的是，我找不到任何人报告同样的问题。

假设我有一个类声明如下：

```
<?php

class MyChildClass extends \SomeNameSpace\MyParentClass
{
} 
```

然后我通过 PHPCS 运行它：

```
bash-3.2$ phpcs -s  --standard=PSR2 test.php 

FILE: test.php
--------------------------------------------------------------------------------
FOUND 2 ERROR(S) AFFECTING 1 LINE(S)
--------------------------------------------------------------------------------
 3 | ERROR | Expected 0 spaces between "SomeNameSpace" and comma; $1 found
   |       | (PSR2.Classes.ClassDeclaration.SpaceBeforeComma)
 3 | ERROR | Expected 1 space before "MyParentClass"; 13 found
   |       | (PSR2.Classes.ClassDeclaration.SpaceBeforeName)
--------------------------------------------------------------------------------

Time: 0 seconds, Memory: 4.00Mb 
```

还：

```
Bash-3.2$ phpcs --version
PHP_CodeSniffer version 1.3.6 (stable) by Squiz Pty Ltd. (http://www.squiz.net) 
```

有没有人遇到过这个？难道我做错了什么？否则我将首先进入嗅探器代码 - 这感觉不对。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-21T03:39:30.357

当前版本的 PHP_CodeSniffer 中的 PSR-1 和 PSR-2 标准并不完整。我从未在发行说明中提及它们，因此人们显然要么刚刚找到它们，要么他们正在谈论当前的开发版本，它们已完成。

如果你想在 PHP_CodeSniffer 中试用 PSR-2 的完整版本，你需要克隆 git repo 并直接使用它：

```
git clone git://github.com/squizlabs/PHP_CodeSniffer.git
cd PHP_CodeSniffer
php scripts/phpcs --standard=PSR2 /path/to/code 
```

或者你可以等待官方发布，假设没有报告重大问题，我计划在下周的某个时间发布。

如果你在你提供的代码上运行最新的开发版本，你会得到这个：

```
2:PHP_CodeSniffer gsherwood$ php scripts/phpcs --standard=psr2 temp.php

FILE: /Users/gsherwood/Sites/Projects/PHP_CodeSniffer/temp.php
--------------------------------------------------------------------------------
FOUND 2 ERROR(S) AFFECTING 2 LINE(S)
--------------------------------------------------------------------------------
 3 | ERROR | Each class must be in a namespace of at least one level (a
   |       | top-level vendor name)
 5 | ERROR | Expected 1 blank line at end of file; 0 found
--------------------------------------------------------------------------------

Time: 0 seconds, Memory: 4.25Mb 
```

希望有帮助。

# php - 如何在键以数字开头的情况下输出此 JSON 值？

> ID：12522199
> 
> 赞同：1
> 
> 时间：2012-09-20T23:08:30.543
> 
> 标签：php, json

采取这个 json 响应：

```
 {
   "self":"http://macpro.local:2990/jira/rest/api/2/issue/CSS-4/votes",
   "votes":2,
   "hasVoted":true,
   "voters":[
      {
         "self":"http://macpro.local:2990/jira/rest/api/2/user?username=admin",
         "name":"admin",
         "avatarUrls":{
            "16x16":"http://macpro.local:2990/jira/secure/useravatar?size=small&avatarId=10062",
            "48x48":"http://macpro.local:2990/jira/secure/useravatar?avatarId=10062"
         },
         "displayName":"admin",
         "active":true
      },
      {
         "self":"http://macpro.local:2990/jira/rest/api/2/user?username=timn_1",
         "name":"timn_1",
         "avatarUrls":{
            "16x16":"http://macpro.local:2990/jira/secure/useravatar?size=small&avatarId=10062",
            "48x48":"http://macpro.local:2990/jira/secure/useravatar?avatarId=10062"
         },
         "displayName":"User Two",
         "active":true
      }
   ]
} 
```

我不知道如何从上面获取 avatarUrls->16x16。我已经很容易使用以下命令获得其他所有内容：

```
$decoded = json_decode($result);
$decoded->votes; //returns # of votes
$decoded->voters->name; //returns the name 
```

但是如何获得 16x16 的值？如果我尝试这个，我会得到一个错误：

```
$decoded->voters->avatarUrls->16x16; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-20T23:11:50.680

一直如此。

```
$decoded->voters->avatarUrls->{'16x16'} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-20T23:14:02.240

你也可以做

```
$decoded = json_decode($result, true);
$decoded['voters']['avatarUrls']['16x16']; 
```

如果您更喜欢 Array 样式。

# objective-c - 使用计时器设置变量，并在公式中使用时间

> ID：12522200
> 
> 赞同：0
> 
> 时间：2012-09-20T23:08:31.417
> 
> 标签：objective-c

因此，当 (IBAction)calculate: (id)sender 被触发时，我试图在我的方程中自动输入一个以分钟为单位的时间。现在我有时间作为 UITextField (IBOutlet UITextField *amountOfInt) 进入，我希望在按下计算时自动替换它。当按钮被按下时，我不想要时间差，我需要得到总时间，因为它被初始化进入方程并在每次按下时输出到 IBOutlet UILabel *bOOK 中。

我的.h 是：

```
 IBOutlet UITextField *weight;
    IBOutlet UITextField *amountOfInt;
    IBOutlet UILabel *bOOK;
    IBOutlet UILabel *numberOfDrops;    
}

-(IBAction)calculate:(id)sender; 
```

我的 .m 是：

```
-(IBAction)calculate: (id)sender {

    static int myInt = 0;
    myInt++;

    float floatbAC = (((myInt * .6) / ([weight.text floatValue] * .57)) -  (.5678 * [amountOfTime.text floatValue]); 

    NSString *stringbOOK = [[NSString alloc] initWithFormat:@"%1.2f",floatbOOK ];

    NSString *string = [NSString stringWithFormat:@"%d", myInt];

    [numberOfDrops setText:string];

    bOOK.text = stringbOOK;

    [stringbOOK release]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T23:50:46.670

当你说它被初始化时不确定你指的是什么，但是你可以在你的“它”被初始化时创建一个 NSDate 对象，比如

```
initialiseDate = [[NSDate alloc] init]; 
```

然后当你按下按钮时使用 timeIntervalSinceDate 方法

```
NSTimeInterval differenceInSeconds = [[NSDate date] timeIntervalSinceDate:initialiseDate]; 
```

这可能会给你一个否定的结果，不记得从哪个减去哪个，你只需要否定结果或交换日期

# javascript - Javascript正则表达式捕获

> ID：12522202
> 
> 赞同：1
> 
> 时间：2012-09-20T23:08:32.957
> 
> 标签：javascript, regex

我确信堆栈溢出可能有一些类似的东西，但我找不到任何东西，并且对应该非常简单的东西感到非常沮丧。

我需要使用 javascript 捕获部分 url（类似于 url 重写引擎）。

**网址结构：**

```
http://example.com/constant/CAPTURETHIS

http://example.com/constant/CAPTURETHIS/

http://example.com/constant/CAPTURETHIS#noise

http://example.com/constant/CAPTURETHIS/#noise 
```

我只需要返回所有 3 个 senerios 的 CAPTURETHIS 文本

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-20T23:11:53.830

JavaScript 支持通过使用[字符串对象的`match`方法](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/match)或[正则表达式对象的`exec`方法](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/RegExp/exec)来检索正则表达式捕获组：

```
var captureThis = url.match(/^http:[/][/]example[.]com[/]constant[/]([^/]+)/)[1];
var captureThis = /^http:[/][/]example[.]com[/]constant[/]([^/]+)/.exec(url)[1]; 
```

但是对于您的示例，我几乎想知道使用[字符串对象的`split`方法](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/split)是否更简单：

```
var captureThis = url.split(/[/]/)[4]; 
```

# jquery - 在同位素上单击淡出时在 Chrome 中闪烁

> ID：12522210
> 
> 赞同：0
> 
> 时间：2012-09-20T23:09:26.597
> 
> 标签：jquery, google-chrome, fadeout, jquery-isotope

我正在[http://www.gablabelle.com](http://www.gablabelle.com)上建立一个网站，当您单击图像缩略图时，它会在淡出之前闪烁……但这仅适用于 Google Chrome，而不适用于 Firefox 和 Safari。

什么可能导致这种情况，我有办法解决这个问题吗？

```
 <div id="streamwrapper">
            <div id="sidebar">  
            </div>
            <div id="stream">
                <article id="509">
                    <a class="ajaxed" href="#"><img src="#" alt="" /></a>
                </article>
           </div> 
      </div> 
```

...

```
$("a.ajaxed").on("click",function(event) {
        event.preventDefault();
        postid = $(this).parent().attr("id");
        $("#streamwrapper").fadeOut(1000, function(){
            $.ajax({
                type: "POST",
                dataType: "JSON",
                url: ajax_object.ajaxurl,
                data: ({
                    action : "get_all_images",
                    post_id: postid
                    }),
                success:function(data){
                    $("#post-container").append(data);
                },
                error:function(data){
                    console.log(data);
                }
            });
        });
        return false;
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T01:44:29.090

将 Google Chrome 从 18.0.1025.165 升级到版本 21.0.1180.89 解决了这个问题。:-| ;-)

# cron - 詹金斯 cron 工作时间表

> ID：12522212
> 
> 赞同：0
> 
> 时间：2012-09-20T23:09:47.670
> 
> 标签：cron, jenkins, job-scheduling

我不确定如何安排从晚上 10 点到早上 7 点（第二天）运行的作业。我在想如果像下面这样的东西会起作用

```
0 22-8 * * * 
```

谢谢

# xmpp - 使用 XMPP (ejabberd) 跟踪 MUC 房间列表

> ID：12522216
> 
> 赞同：0
> 
> 时间：2012-09-20T23:10:17.173
> 
> 标签：xmpp, ejabberd, strophe, multiuserchat

我想让客户跟踪 ejabberd 提供的多用户聊天服务上的房间列表。这将需要接收服务器上所有房间的房间创建/销毁和存在事件的通知。

有没有办法订阅接收有关此类事件的通知，而无需发送出席事件，从而加入所有房间的名单？

FWIW，我发现了如何发送房间列表请求（http://xmpp.org/extensions/xep-0045.html#disco-rooms），我一直在尝试理解 pubsub 系统（http://xmpp.org/extensions/xep-0060.html#glossary）希望我能在那里找到解决方案，但似乎没有什么明显的。

在 XMPP 领域中执行此操作的正确（TM）方法是什么？

Ubuntu 10.04 + ejabberd 2.1.5-3+squeeze1 + Strophe.js & BOSH & jQuery

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T20:38:17.873

您需要为此开发自定义代码，尤其是在您感兴趣的事件上触发数据包发送。

# c - “预期的声明说明符”错误消息

> ID：12522219
> 
> 赞同：1
> 
> 时间：2012-09-20T23:10:29.090
> 
> 标签：c, file-io

我目前正在大学学习 C 语言，所以这是一个家庭作业，但我有一个小问题。我猜我只是误判了语法或遗漏了一些非常明显的东西。我的编译器告诉我有：

> 常量前的预期声明说明符或“...”

并指向`O_RDWR`.

我在 Stack Exchange 上进行了谷歌搜索和搜索，但似乎没有任何特定的内容。遵循 C 参考中的语法就可以了。我环顾四周，它说我没有预定义 typedef，但我试过没有用。

我已经根据编译器为导致问题的部分加注了星标`**`

```
#include <stdio.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <stdlib.h>

int main (int argc, char *argv[])
{
    int count;

    printf ("This program was called  \"%s\".\n",argv[0]);

    if (argc > 1)
    {
        for (count = 1; count < argc; count++)
        {
            printf("argv[%d] = %s\n", count, argv[count]);
        }
    }
    else
    {
        printf("The command had no arguments.\n");
    }

    if  (argc == 4)
    {
        printf("There are the correct number of arguments(4)");
    }
    else
    {
        printf("Not enough arguments! please try again");
    }

    **int open(const char *argv[1], O_RDWR);

    return 0;**
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T23:12:46.450

尝试`open(argv[1], O_RDWR);`- 您不需要指定 arg 的类型或返回值。

...而且我假设**只是为了突出问题区域-如果不是，它们也应该去...编辑：刚刚注意到您在问题中这么说！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-20T23:17:36.460

```
int open(const char *argv[1], O_RDWR); 
```

你想通过这个声明做什么？编译器将此视为**函数声明**，而不是函数调用。它失败了，因为 O_RDWR 不是类型名称。如果你需要调用[`open()`](http://pubs.opengroup.org/onlinepubs/000095399/functions/open.html)，语法应该是这样的：

```
int fd = open(argv[1], O_RDWR);
if(fd != -1)
{
   // File opened OK. Proceed with file operations.
}
else
{
   // File failed to open. Handle error occured
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-21T06:11:11.360

**open**调用将 HANDLE 返回到**int****类型**的指定文件。因此，您只需声明一个**int**类型**HANDLE**即可从**open**收集。所以，

```
int FileDesc ;
FileDesc = open( argv[1], O_RDWRD ) ;
// Check for Errors here 
```

# node.js - 创建使用 Number 的模式时出现 Mongoose TypeError

> ID：12522223
> 
> 赞同：4
> 
> 时间：2012-09-20T23:10:51.227
> 
> 标签：node.js, mongodb, mongoose

我有一个使用数字的模式，如下所示。

```
var mongoose = require('mongoose')
    , Schema = mongoose.Schema
    , ObjectId = Schema.Types.ObjectId
    , Mixed = Schema.Types.Mixed
    , Number = Schema.Types.Number
    , Date = Schema.Types.Date

var ItemSchema = new Schema({
    quantity:{type:Number, required:true, min:1},
    category:{type:String, required:true, enum:categoryList},
    description:{type:String, required:true},
    cost:{type:Number, required:true, min:0, default:0},
    appraisedValue:{type:Number, min:0, default:0},
    appraisedOn:Date,
    purchasedOn:Date,
    purchasedFrom:String,
    brand:String,
    dynamicFieldList:[DynamicFieldSchema]
})
exports.ItemSchema = ItemSchema
exports.Item = mongoose.model('Item', ItemSchema) 
```

但是当我尝试运行我的应用程序时，我收到一个 TypeError: Undefined type at 'quantity'。如果数量值被注释掉，这也会以“成本”发生。

堆栈跟踪是：

```
C:\Users\a\Documents\Git\has-inventory.js\node_modules\mongoose\lib\schema.js:325
throw new TypeError('Undefined type at `' + path +

TypeError: Undefined type at `quantity`
  Did you try nesting Schemas? You can only nest using refs or arrays.
at Function.Schema.interpretAsType (C:\Users\a\Documents\Git\has-inventory.js\node_modules\mongoose\lib\schema.js:325:11)
at Schema.path (C:\Users\a\Documents\Git\has-inventory.js\node_modules\mongoose\lib\schema.js:268:29)
at Schema.add (C:\Users\a\Documents\Git\has-inventory.js\node_modules\mongoose\lib\schema.js:200:12)
at new Schema (C:\Users\a\Documents\Git\has-inventory.js\node_modules\mongoose\lib\schema.js:69:10)
at Object.<anonymous> (C:\Users\a\Documents\Git\has-inventory.js\domain\inventory.js:34:18)
at Module._compile (module.js:449:26)
at Object.Module._extensions..js (module.js:467:10)
at Module.load (module.js:356:32)
at Function.Module._load (module.js:312:12)
at Module.require (module.js:362:17) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-21T00:43:31.447

删除这两行：

```
, Number = Schema.Types.Number
, Date = Schema.Types.Date 
```

应该在模式定义中使用内置的 JavaScript`Number`和类型。`Date`

# objective-c - 通过目标 C 中的应用程序重新启动来保留变量

> ID：12522224
> 
> 赞同：0
> 
> 时间：2012-09-20T23:10:52.620
> 
> 标签：objective-c

我认为这是一个非常基本的问题，但由于措辞，我发现很难搜索信息。

基本上，我正在开发一个跟踪我的学生的应用程序。我想为每个学生分配一个唯一的 ID 号。如何创建这个变量，以便在我想添加新学生时可以引用和增加它？显然，我需要关闭并重新启动应用程序，并且仍然跟踪给出的最后一个 ID 号。

谢谢。对不起，愚蠢的问题。]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T23:12:56.513

将其存储在您存储学生数据的相同位置。如今，数据库是常见的地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-20T23:39:13.727

您还应该研究 CoreData，这是持久存储的一个很好的抽象，对于 Objective-C 对象，它可以由数据库、XML、二进制数据、iCloud 支持。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-21T04:30:10.577

如果您只想存储您的 ID 高值，那么 Core Data 将是多余的，您可能需要考虑使用 NSUserDefaults。不了解更多的用例会让人很难知道这有多合适，但我提到它以防万一你有一个非常轻量级的需求。

# android - Android spinner 检索到的值显示为 toast 但不能进一步使用？

> ID：12522225
> 
> 赞同：1
> 
> 时间：2012-09-20T23:10:54.830
> 
> 标签：android, xml, spinner

首先要说我到处寻找，我找不到解决方案，但如果我重复一些事情，我很抱歉。所以这是一种情况，我有一个 android 应用程序从一些 xml url 解析数据并将其显示在 listview 中。还有一个装满了一些项目的微调器，所以我想过滤从 xml 中检索到的数据，其中的变量是从微调器中选择的，然后添加到列表视图中。我创建了 setOnItemSelectedListener ，当我从微调器中选择一些东西时，我会收到该值的 toast 消息，但我以后不能使用它。这是代码：

```
public class profesorActivity extends ListActivity {
    // All static variables
    static final String URL = "http://cvele.net78.net/obavestenja1.xml";
    // XML node keys
    static final String KEY_OBAV = "obavestenja"; // parent node
    static final String KEY_PROF = "profesor";
    static final String KEY_PRE = "predmet";
    static final String KEY_TXT = "tekst";
    static final String KEY_VRE = "vreme";
    Spinner spin;
    ArrayAdapter<String> aa;
    String[] items = { "item1","item2", "item3", "item4", "item5", "item6","item7"};

    ArrayList<HashMap<String, String>> menuItems = new ArrayList<HashMap<String, String>>();

    XMLParser parser = new XMLParser();
    String xml = parser.getXmlFromUrl(URL); // getting XML
    Document doc = parser.getDomElement(xml); // getting DOM element
    Object string1;

    NodeList nl = doc.getElementsByTagName(KEY_OBAV);

    public void onCreate(Bundle savedInstanceState) {
        getWindow().requestFeature(Window.FEATURE_NO_TITLE);
        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
        super.onCreate(savedInstanceState);
        setContentView(R.layout.profesor);

        spin=(Spinner)findViewById(R.id.spinner);
        aa = new ArrayAdapter<String>(this,android.R.layout.simple_spinner_item,items);
        aa.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        spin.setAdapter(aa);
        spin.setOnItemSelectedListener(new OnItemSelectedListener(){
            public void onItemSelected(AdapterView<?> parent, View view, int position, long id){
                string1=spin.getSelectedItem().toString();
                Toast.makeText(getBaseContext(), "Selected:" + string1.toString(),Toast.LENGTH_LONG ).show();
            }
            public void onNothingSelected(AdapterView<?> parent) {
                Toast.makeText(getBaseContext(), "Spinner1: unselected",Toast.LENGTH_LONG ).show();
            }
        });

        NodeList nl = doc.getElementsByTagName(KEY_OBAV);
        // looping through all item nodes <item>
        for (int i = 0; i < nl.getLength(); i++) {
            // creating new HashMap
            HashMap<String, String> map = new HashMap<String, String>();

            Element e = (Element) nl.item(i);

            // adding each child node to HashMap key => value
            map.put(KEY_PROF, parser.getValue(e,KEY_PROF));
            map.put(KEY_PRE, parser.getValue(e, KEY_PRE));
            map.put(KEY_TXT, parser.getValue(e, KEY_TXT));
            map.put(KEY_VRE, parser.getValue(e, KEY_VRE));

            if((parser.getValue(e, KEY_PROF)).equals(string1.toString()))
                menuItems.add(map);
            else
                Toast.makeText(getBaseContext(), "nothing", Toast.LENGTH_LONG).show();

        }
        // Adding menuItems to ListView
        ListAdapter adapter = new SimpleAdapter(this, menuItems,R.layout.list_item, new String[] { KEY_PROF, KEY_PRE, KEY_TXT, KEY_VRE }, new int[] {R.id.profesor,R.id.predmet, R.id.tekst, R.id.vreme});
        setListAdapter(adapter); 
```

更准确地说，当我从微调器中选择一些东西时，我希望在变量 string1 中显示它，正如我之前伤心的那样，`Toast.makeText(getBaseContext(), "Selected:" + string1.toString(),Toast.LENGTH_LONG ).show();`每次我从微调器中选择一些东西时，它都会显示为 toast()，但在 for 循环 string1 中没用，我不能用它来与那个变量进行比较`if((parser.getValue(e, KEY_PROF)).equals(string1.toString()))`，但是当我比较它时，例如，`if((parser.getValue(e, KEY_PROF)).equals("test"))` 它可以工作，并且它也可以使用微调器中的第一个默认值。因此，更改所选值不会更改侦听器之外的变量 string1 的状态。我尝试了许多其他方法将微调器选定的项目保存为字符串，但没有运气。我做错了什么，我希望我描述得很好，如果我不是请问，我打破了思考和搜索网络的头脑。提前谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T23:32:25.583

当 onCreate() 方法运行时，它会执行所有代码。这意味着尚未设置类成员“Object string1”，因为尚未触发微调器事件。您可能希望查看 Android Activity 生命周期，以便在适当的时间初始化和调用方法。

关键是，一旦处理了微调器事件“onItemSelected”，您不仅可以更新

```
string1=spin.getSelectedItem().toString(); 
```

还要更新列表并调用通知进行更改。

# svn - 在一行中使用 xargs 两次来修复颠覆 «！» 地位

> ID：12522228
> 
> 赞同：0
> 
> 时间：2012-09-20T23:11:04.847
> 
> 标签：svn, shell, status, xargs

我在这里找到了解决我的问题的最佳方法：[Howto fix subversion «！» 地位](https://stackoverflow.com/questions/3389620/howto-fix-subversion-status)

但现在，我只想写一个小脚本来做到这一点。

像这样：

```
svn status | grep '\!' | awk '{print $2}' | xargs svn revert

svn status | grep '\!' | awk '{print $2}' | xargs svn delete 
```

但在一条线上。

因为，在 svn revert 之后，"svn status | grep '!'" 没有返回任何结果。合理的。

我认为我找到了一个解决方案：[将两次传递给 xargs 的数据放在一行中](https://stackoverflow.com/questions/1375905/putting-the-data-passed-to-xargs-twice-in-one-line)，但我的英语有点生疏，命令行不是我的强项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-22T12:19:14.073

```
svn status | grep '\!' | awk '{print $2}' | tee list.$$ | xargs svn revert
xargs svn delete < list.$$
rm list.$$ 
```

该`tee`命令就像一个 T 形管件；输出的一个副本到每个命名文件，另一个到标准输出。在这里，我只命名了一个文件。这会强制所有的还原发生在任何删除之前。这个名称`list.$$`是一种保护脚本不践踏其他进程文件的简单方法；有些程序`mktemp`可以用来创建更安全、更难预测的名称。OTOH，如果您没有在恶劣的环境中运行，那么这不太重要。如果您非常小心，您将创建一个`trap`以确保清理文件：

```
tmp=${TMPDIR:-/tmp}/list.$$
trap "rm -f $tmp; exit 1" 0 1 2 3 13 15

svn status | grep '\!' | awk '{print $2}' | tee $tmp | xargs svn revert
xargs svn delete < $tmp

rm $tmp
trap 0 
```

还有其他技巧可以尝试，但至少其中一些不能保证顺序操作。例如，进程替换`bash`：

```
svn status | grep '\!' | awk '{print $2}' | tee >(xargs svn revert) | xargs svn delete 
```

每个文件都将被还原和删除，但顺序是不可预测的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-22T15:09:16.417

这两个命令在一行中。请注意 xargs 的完全丢失。并不是说 xargs 不好，只是这里不需要它。

```
x="$(svn status | grep '\!' | awk '{print $2}')"; svn revert "$x" && svn delete "$x" || 回声“没有svn删除$？”
```

请注意，如果**svn revert**失败， **svn delete**将不会运行。“no svn delete”表示其中一个 svn 命令失败。

# c - 无法理解 glOrtho

> ID：12522232
> 
> 赞同：1
> 
> 时间：2012-09-20T23:11:31.633
> 
> 标签：c, opengl, graphics, 2d

我是 openGL 的新手，我无法理解 glOrtho 的概念。例如我有：

```
void display(void)
{
/* clear all pixels  */
glClear (GL_COLOR_BUFFER_BIT);
/* draw black polygon (rectangle) with corners at * (0.25, 0.25, 0.0) and (0.75, 0.75, 0.0)
*/
glColor3f (0.0, 0.0, 0.0);
glBegin(GL_POLYGON);
  glVertex3f (-.25,0,0.0);
  glVertex3f (.25, 0, 0.0);
  glVertex3f (.25, .25, 0.0);
  glVertex3f (-.25, .25, 0.0);
glEnd();
/* don’t wait!
* start processing buffered OpenGL routines */
glFlush (); } 
```

这会产生一个矩形，然后这个“变形”矩形：

```
void init (void)
/* this function sets the initial state */ {
/* select clearing (background) color to white */
glClearColor (1.0, 1.0, 1.0, 0.0);
/* initialize viewing values */ 
glMatrixMode(GL_PROJECTION); 
glLoadIdentity();
glOrtho(0, 1, 1, 0.0, -1.0,1.0);
} 
```

这几乎使它成为一个正方形并放在左上角。我不确定它是如何做到的。矩形中的点是否已转换？

编辑：想通了。这很有帮助。[http://elvenware.sourceforge.net/OpenGLNotes.html#Ortho](http://elvenware.sourceforge.net/OpenGLNotes.html#Ortho)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-20T23:24:18.450

`glOrtho`用于定义正交投影体积：

签名是`glOrtho(GLdouble left, GLdouble right, GLdouble bottom, GLdouble top, GLdouble near, GLdouble far);` left和right指定x坐标剪裁平面，bottom和top指定y坐标剪裁平面，near和far指定到z坐标剪裁平面的距离。这些坐标一起提供了一个盒子形状的查看体积。

您定义投影体积的方式不是以点 3d (0, 0, 0) 为中心，而是 (.5, -5, 0) 您应该以这种方式定义 glOrtho：`glOrtho(-.5, .5, -.5, .5, -1.0, 1.0);`因为您的多边形围绕点 3d (0, 0, 0)。（您还可以更改多边形的坐标以匹配投影体积的中心）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-20T23:26:54.670

您的`glOrtho`调用将视口设置为左上角为 (0,0)，右下角为 (1,1)，有效 Z 范围为 (-1,1)。

现在，您绘制了一个左上角为 (-0.25,-0.25) 到 (0.25,0.25) 的正方形。

这些`glVertex`调用与它们上方的评论不匹配。将顶点更改为您声明的值，或更改`glOrtho`调用：

```
glOrtho(-0.5, 0.5, 0.5, -0.5, -1.0, 1.0 ); 
```

# smlnj - 返回整数列表的简单函数

> ID：12522233
> 
> 赞同：0
> 
> 时间：2012-09-20T23:11:40.243
> 
> 标签：smlnj

如果我正在尝试编写一个简单的函数，该列表包含一对整数 - 表示一个图并返回一个整数列表：图中的所有节点，例如如果输入为 [(1,2) (3,4) (5,6 ) (1,5)] o/p 应该是 [1,2,3,4,5,6,1,5] 该函数只是简单地返回节点列表，在返回列表中的值可能会像上面一样重复。我写了以下函数

fun listofnodes ((x:int,y:int)::xs) = if xs=nil then [x::y] else [[x::y]@listofnodes(xs)]

标准输入：15.12-15.18 错误：运算符和操作数不一致 [tycon 不匹配运算符域：int * int 列表操作数：int * int 表达式：x :: y。

我无法弄清楚出了什么问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T12:22:23.017

首先，您应该知道每个运算符的作用： :: 将单个元素放入现有列表中，以便： 1::2::3::[] = [1,2,3] @ 将两个列表放在一起，以便： [1,2] @ [3,4] = [1,2,3,4]

您也可以使用 :: 将列表放在一起，但它会变成一个列表列表，例如： [1,2] :: [3,4] = [[1,2],[3,4]]

所以通过写 [x::y] 你是说 x 和 y 应该成为列表中的列表。

并且您不应该使用 if 语句来检查列表的结尾，而是可以使用模式来执行此操作：

```
fun listofnodes [] = []
  | listofnodes ((x,y)::xs) = x :: y :: listofnodes(xs); 
```

第一个模式确保当我们到达列表的末尾时，当您提取最终的元组时，您的 xs 绑定到一个它调用自身的空列表，它会留下一个空列表来放入所有元素，因此 [( 1,2) (3,4) (5,6) (1,5)] 会这样计算：

1 :: 2 :: 3 :: 4 :: 5 :: 6 :: 1 :: 5 :: [] = [1,2,3,4,5,6,1,5]。

你也可以这样：

```
fun listofnodes [] = []
  | listofnodes ((x,y)::xs) = [x,y] @ listofnodes(xs); 
```

这样你就可以从每个元组中创建一个小的 2 元素列表，然后将所有这些小列表合并到一个大列表中。你真的不需要最后的空列表，但它是确保递归在列表末尾停止的唯一方法，你必须在等号的另一边放一些东西。它的评估如下：

[1,2] @ [3,4] @ [5,6] @ [1,5] @ [] = [1,2,3,4,5,6,1,5]。

您也将 x 和 y 转换为整数，但您不必这样做。如果你不这样做，它会得到类型“ ('a * 'a) list -> 'a list ”，这意味着它适用于所有输入类型，包括整数（只要元组不包含冲突类型，如 char 和一个整数）。我猜你知道这一点，但万一你不知道：你所说的对（1,2）被称为元组。

# windows-7 - LispCabinet 读行冻结

> ID：12522236
> 
> 赞同：0
> 
> 时间：2012-09-20T23:11:58.293
> 
> 标签：windows-7, lisp, freeze

我一直在玩 LispCabinet 一段时间，在业余时间学习。在我家里的 PC 上工作的东西，以及在我以前工作的工作 PC 上的东西，似乎在我的新工作中冻结了 Emacs 或 SLIME。

我正在通过 Practical Common Lisp 进行复习，这个功能：

```
(defun prompt-read (prompt)
  (format *query-io* "~a: " prompt)
  (force-output *query-io*)
  (read-line *query-io*)) 
```

在家里完美工作。但是，在工作中运行它会在输入几个字符后冻结，直到我杀死解释器。我已经缩小到

```
(read-line *query-io*) 
```

因为单独运行它会导致冻结。以下也失败：

```
(read *query-io*)
(read-line *standard-input*)
(read *standard-input*) 
```

我完全不知道是什么原因造成的。有任何想法吗？

我在 Windows 7 Pro SP1 上运行 LispCabinet 0.3.3。

LispBox 工作正常，但即使恢复到早期版本的 LispCabinet，我仍然遇到同样的失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T20:43:59.150

批处理文件仅用于从 Emacs 命令 shell 或从“（（”菜单启动的外部 cmd shell 执行（所有环境变量在 Emacs 初始化期间设置）。我只是尝试执行您在 stackoverflow 中发布的代码SBCL SLIME REPL（它也可以从“（（”菜单）启动，它在我的安装中运行良好。问题仍然存在于 shell 中，我想这是一个 SBCL unicode I/O 问题（LispCabinet使用非官方版本的 SBCL). 你可以尝试将官方版本安装到 '/bin/sbcl/' 或使用 ClozureCL 代替，如果你想使用命令 shell 而不是 SLIME REPL (但 SLIME 更方便)。

# mysql - 多对多和多对多交叉口

> ID：12522238
> 
> 赞同：7
> 
> 时间：2012-09-20T23:12:05.283
> 
> 标签：mysql, sql

假设我有一个数据库，其中包含人员、杂货店和您可以在商店中购买的物品，如下所示：

```
Stores               People                Foods
-----------------    ------------------    ------------------
| id |   name   |    | id |   name    |    | id |   name    |
-----------------    ------------------    ------------------
| 1  |  Giant   |    | 1  | Jon Skeet |    | 1  | Tomatoes  |
| 2  |  Vons    |    | 2  | KLee1     |    | 2  | Apples    |
| 3  | Safeway  |    ------------------    | 3  | Potatoes  |
-----------------                          ------------------ 
```

我有一个额外的表来跟踪哪些商店卖什么：

```
Inventory
--------------------
| store_id| food_id|
--------------------
| 1       | 1      |
| 1       | 2      |
| 2       | 1      |
| 3       | 1      |
| 3       | 2      |
| 3       | 3      |
-------------------- 
```

我还有另一张桌子，上面有购物清单

```
Lists
---------------------
| person_id| food_id|
---------------------
| 1        | 1      |
| 1        | 2      |
| 1        | 3      |
| 2        | 1      |
| 2        | 3      |
--------------------- 
```

我的问题是，给定一个人或他们的 ID，找出他们可以去哪些商店的最佳方法是什么，以便他们将所有东西都列在他们的清单上。MySQL中这些类型的计算是否有模式？

我的尝试（非常丑陋和混乱）是这样的：

```
-- Given that _pid is the person_id we want to get the list of stores for.

SELECT stores.name, store_id, num, COUNT(*) AS counter
FROM lists
    INNER JOIN inventory 
        ON (lists.food_id=inventory.food_id)
    INNER JOIN (SELECT COUNT(*) AS num
            FROM lists WHERE person_id=_pid 
            GROUP BY person_id) AS T
    INNER JOIN stores ON (stores.id=store_id)
WHERE person_id=_pid 
GROUP BY store_id
HAVING counter >= num; 
```

谢谢你的时间！

用数据编辑[SQL 小提琴](http://sqlfiddle.com/#!2/83667/6)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-21T00:29:42.003

如果我要解决这个问题，我会将这四个表与它们的链接列（*特别是外键*）连接起来，然后在子句上创建一个子查询`HAVING`来计算每个人的列表中的项目数。试试这个，

```
SET @personID := 1;

SELECT  c.name
FROM    Inventory a
        INNER JOIN Foods b
            ON a.food_id = b.id
        INNER JOIN Stores c
            ON a.store_id = c.id
        INNER JOIN Lists d
            ON d.food_id = b.id
WHERE   d.person_id = @personID
GROUP BY c.name
HAVING   COUNT(DISTINCT d.food_id) =
     (
        SELECT COUNT(*)
        FROM Lists
        WHERE person_ID = @personID
     ) 
```

# [SQLFiddle 演示](http://sqlfiddle.com/#!2/83667/32)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T00:49:23.333

@JohnWoo：为什么不同？

另一个...

```
SET @pid=2;

SELECT store_id, name
FROM inventory 
  JOIN lists ON inventory.food_id=lists.food_id
  JOIN stores ON store_id=stores.id
WHERE person_id=@pid
GROUP BY store_id
HAVING COUNT(*)=(
  SELECT COUNT(*)
  FROM lists 
  WHERE person_id=@pid
); 
```

# parallel-processing - MPI_Scatter 冗余参数？

> ID：12522240
> 
> 赞同：3
> 
> 时间：2012-09-20T23:12:27.067
> 
> 标签：parallel-processing, mpi

我的问题很简单，MPI_Scatter 函数定义是：

```
#include <mpi.h>
void MPI::Comm::Scatter(const void* sendbuf, int sendcount,
const MPI::Datatype& sendtype, void* recvbuf,
int recvcount, const MPI::Datatype& recvtype,
int root) const 
```

'sendcount' 和 'sendtype' 是多余的吗？在这种情况下会发生：sendcount!=recvcount?

编辑：也许需要对这个问题进行一些澄清。我知道原因可能是，对于根来说，数据是一些“结构 X”，而对于接收者来说，数据是一些“结构 Y”，这在某种程度上也是有意义的（这一切都符合“好的”）。

如果是这样的话......我不明白为什么需要再次说要接收的预期数据的总大小与发送的数据大小相同。如果只是投射数据视图的问题，我只会进行投射。实际上，缓冲区是一个（void *）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-21T13:07:21.170

MPI 允许发送端和接收端的数据类型不同，只要它们是由相同的基本数据类型构成的。在许多情况下，这很方便，例如将矩阵的行从根进程分散到其他进程的列中。在 C 和 C++ 中发送和接收行很简单，因为矩阵的内存布局是行优先的。发送和接收列要求首先构造一个特殊的跨步向量类型。通常这种类型是为指定数量的行和列构造的，然后必须`1`在接收数据时提供计数。

还有许多其他情况可能`sendcount`会`recvcount`有所不同。还请注意，`recvcount` **它没有**指定要接收的消息的大小，而是指定**接收缓冲区的容量，**并且该容量可能比消息的大小大得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T11:04:20.783

**MPI_scatter()**用于将消息分成相等的片段，并在子节点和您自己的节点中处理每个消息。知道这一点：

> 'sendcount' 和 'sendtype' 是多余的吗？

- 这怎么会发生？如果 sendCount 是发送的元素数，而 sendType 是这些元素的类型。两者都包含不同的信息。

对于最后一个问题：

> 在这种情况下可能会发生：sendcount!=recvcount?。

- 当你想对一个数字序列进行排序时，你将大小为 N 和 type=int 的块发送到你的节点。您想要相同但已排序。

# tomcat - 使用 Tuckey 将 url 重写映射存储在单独的文件中？

> ID：12522243
> 
> 赞同：2
> 
> 时间：2012-09-20T23:12:44.160
> 
> 标签：tomcat, url-rewriting, tuckey-urlrewrite-filter

我正在尝试将 URL 重写映射存储在单独的文件中。

我找到了一些使用 .Net 或 Apache 的答案，但没有运气如何在 Tomcat 中使用 Tuckey 来做到这一点。

有谁知道 Tuckey 是否支持这个功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T08:56:24.783

可以在过滤器配置中修改urlrewrite.xml**路径。**

可以在**WEB-INF/web.xml**文件中通过更改**confPath**参数值来完成：

```
<filter>
    <filter-name>UrlRewriteFilter</filter-name>
    <filter-class>org.tuckey.web.filters.urlrewrite.UrlRewriteFilter</filter-class>
    <!-- if you need to the conf file path can be changed
         it is specified as a path relative to the root of your context
         (default /WEB-INF/urlrewrite.xml) -->
    <init-param>
        <param-name>confPath</param-name>
        <param-value>/WEB-INF/urlrewrite.xml</param-value>
    </init-param>
</filter> 
```

此处的文档：http: [//urlrewritefilter.googlecode.com/svn/trunk/src/doc/manual/4.0/index.html#filterparams](http://urlrewritefilter.googlecode.com/svn/trunk/src/doc/manual/4.0/index.html#filterparams)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T11:21:40.903

我看起来像**Tuckey**支持单独的**urlrewrite.xml**。

请参阅[配置文件 WEB-INF/urlrewrite.xml](http://urlrewritefilter.googlecode.com/svn/trunk/src/doc/manual/4.0/index.html#configuration)

# magento - Magento 产品配置和色板

> ID：12522249
> 
> 赞同：0
> 
> 时间：2012-09-20T23:13:02.347
> 
> 标签：magento, configuration, admin, product, color-picker

我正在建立一个泳装目录，我希望有人能给我一些正确设置产品的指导。

这基本上就是我想要做的：http: [//www.nafnaf.com/fr/robe.html/](http://www.nafnaf.com/fr/robe.html/)

我找到了这个扩展，它做的事情几乎一样： [http ://cjmcreativedesigns.com/pre-select-colors-plus-swatches.html](http://cjmcreativedesigns.com/pre-select-colors-plus-swatches.html)

我喜欢这个插件，因为它会在列表和详细信息页面以及 Magento 的分层导航中显示色板。这个插件的过程是设置一个可配置的产品（泳装 A）和每个对应颜色的简单产品（泳装 A - 红色，泳装 A - B 等）。查看可配置产品（泳装 A）并单击样本时，它将加载简单产品中的所有图像并填充预览和缩略图。

有谁知道我可以以某种方式自动执行此操作的方法，或者知道我可以在不设置大量简单产品的情况下使色板工作的更好方法？我唯一想到的是使用这个插件：

自动配置 [http://www.magentocommerce.com/magento-connect/automatic-configurables.html](http://www.magentocommerce.com/magento-connect/automatic-configurables.html)

这将自动为可配置的产品创建简单的产品。

如果有人有任何反馈，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-21T02:05:50.837

可配置产品的想法是有一个属性组合来匹配一个特定的简单产品。以这种方式：

*   您拥有真实的产品，代表客户可以配置的选项组合。因此，系统可以跟踪所有这些产品的单独库存。并将搜索列表中的产品显示为单独的产品。
*   产品链接在一起，构成产品系列。因此，系统可以让客户更改一个家庭中的一种产品的某些选项，以便从同一个家庭购买类似的产品。

因此，如果您想在列表中有不同的产品，能够在详细信息页面配置产品，那么您需要在目录中有物理上不同的产品。没有办法避免它。

使该过程更容易的可能方法是：

1.  使用自动配置。似乎它解决了你的问题。那么为什么不直接使用呢？:)

2.  使用 Import/Export Magento 的功能来导入预先组合的可配置项。然后，您可以尝试自动化任务，而不是在 Magento 创建产品时，而是在生成这些列表时。

3.  聘请 Magento 开发人员，让他根据您的需要创建生成器。这并不难。

4.  使用自定义选项从可配置产品切换到简单产品。这样，您无需为每个选项配置创建简单产品。但是你失去了库存跟踪，在搜索列表中单独的产品。而且您失去了精细的组合管理。即，当产品具有 S/M 尺寸和红/蓝颜色时，Configurable 可能让您设置为仅具有“Blue S”、“Red S”、“Red M”组合（这意味着，您没有“Blue M” “ 产品）。虽然带有自定义选项的简单将始终让系统让用户从全套选项组合中进行选择：“蓝色 S”、“蓝色 M”、“红色 S”、“红色 M”。您无法告诉系统您的库存中没有具有特定选项组合的产品。

希望能帮助到你。

# android - 从 SOAP 到 REST

> ID：12522251
> 
> 赞同：0
> 
> 时间：2012-09-20T23:13:08.197
> 
> 标签：android, asp.net, wcf, rest, asp.net-web-api

我有一堆为我的 WP7 应用程序提供服务的 WCF SOAP 服务。现在我正在编写这些 WP7 应用程序的 Android 版本，但 Android 中几乎不存在 SOAP 支持，因此我必须对这些 Android 应用程序使用 REST。

所以，我的计划是在 ASP.NET Web API 中复制我的 WCF SOAP 服务。我是 RESTful 服务的新手。

现在我正在深入了解细节，我想我对 SOAP 有了更多的了解。

例如，我的 SOAP 方法之一采用“TripLocker_s”对象以及其他参数。（粘贴在下面的 SOAP 定义）。如您所见，TripLocker_s 对象是一个数组 TripLegModel_s 对象。我的各种服务方法将各种复杂对象作为参数传递。

当我查看任何与使用 HTTP 服务有关的 Android 教程时，没有什么比字符串更复杂的了，也许整数被作为参数讨论过。我找不到有关传递复杂对象的任何信息。

如何使用 Web api 将复杂对象作为参数传递？例如，有没有办法获取 TripLocker_s 对象并将其序列化为 http 参数（然后再次返回服务器上？）

谢谢，加里

```
 [DataContract]
public class TripLegModel_s
{
    [DataMember]
    public string ourDirection;  //SE, SW, SSW, etc.
    [DataMember]
    public double longitude;
    [DataMember]
    public double latitude;
    [DataMember]
    public double altitude;
    [DataMember]
    public DateTimeOffset TimeStamp;
    [DataMember]
    public double speed;
}

[DataContract]
public class TripLocker_s
{
    [DataMember]
    public ObservableCollection<TripLegModel_s> BreadCrums = new ObservableCollection<TripLegModel_s>(); 
```

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T23:26:56.683

没有理由您不能通过 RESTful (http) 动词（get、post、put 等）在 RESTful API 中将复杂对象作为 JSON 或 XML 传递。JSON 对 web (javascript) 更友好，并且通常为 web 应用程序选择 RESTful/超媒体 API。由于它对网络非常友好，如果您选择它用于移动 android 消费，API 也更适用于网络、iOS、win 手机等...... Javascript（因此 JSON）正在成为网络的首选语言。

如果您正在创建，则将序列化对象发布到正文中。
有关完整示例，请参阅此帖子： [restful-like CRUD operation url pattern for nested model](https://stackoverflow.com/questions/12208117/restful-like-crud-operation-url-pattern-for-nested-model/12208187#12208187)

如果您使用 WCF，请考虑使用 webapi，请参阅[http://www.asp.net/web-api](http://www.asp.net/web-api)

具体来说，结帐：[http ://www.asp.net/web-api/overview/creating-web-apis/creating-a-web-api-that-supports-crud-operations](http://www.asp.net/web-api/overview/creating-web-apis/creating-a-web-api-that-supports-crud-operations)

例如，在 webapi CRUD 示例中，它使用 products 对象：

```
namespace ProductStore.Models
{
    public class Product
    {
        public int Id { get; set; }
        public string Name { get; set; }
        public string Category { get; set; }
        public decimal Price { get; set; }
    }
} 
```

最后，查看这篇关于思考更多 RESTful（而不是 RPC 或 SOAP）的文章 [http://blog.steveklabnik.com/posts/2011-07-03-nobody-understands-rest-or-http](http://blog.steveklabnik.com/posts/2011-07-03-nobody-understands-rest-or-http)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T00:54:34.410

RE：“我的计划是在 ASP.NET Web API 中复制我的 WCF SOAP 服务。”

建议：*别想*了！没有必要……您应该能够很好地创建基于 REST 的 Web 服务。这就是世界的发展方向……微软也随之而来。这应该不是问题。

请不要沉迷于“一切都必须是对象”。它*没有*。特别是，如果简单的 JSON 消息也能正常工作，为什么要使用（可以说是不必要的）GSON 库来阻止您的 Android 应用程序呢？

此外，如果您目前还不是“Java 专家”，您可能需要考虑在更高级别的框架（如 PhoneGap）中编写 Android 代码：

*   [http://www.phonegap.com](http://www.phonegap.com)

只是一个建议！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-20T23:20:40.723

1)如果你愿意，为什么*不能使用 SOAP？*你有什么具体问题？

2）如果有人可以使用 REST，为什么还要*使用*SOAP？

3) 你熟悉[JSON](http://www.vogella.com/articles/AndroidJSON/article.html)吗？

你的安卓是一个网络服务客户端，对吗？Web 服务本身是什么/在哪里，它使用的是 SOAP、JSON 还是“其他东西”？

请查看这个关于 REST 的指导性教程：

*   [http://www.ibm.com/developerworks/webservices/library/ws-restful/](http://www.ibm.com/developerworks/webservices/library/ws-restful/)

这些其他链接可能有用：

*   [JSON 教程](http://www.w3schools.com/json/default.asp)

*   [为 Android 客户端创建 REST Web 服务](http://ericosgood.com/prog/rest-webservice-android/)

*   [JSON 入门](http://www.webmonkey.com/2010/02/get_started_with_json/)

# backbone.js - 人们如何使用 Yeoman？

> ID：12522252
> 
> 赞同：10
> 
> 时间：2012-09-20T23:13:12.957
> 
> 标签：backbone.js, ember.js, yeoman

我一直在和[Yeoman](http://yeoman.io/)一起玩，它非常棒。我想知道人们如何将生成的前端应用程序与后端集成？

您是否将它们保留为可能在不同服务器上运行的独立代码库？您是否将整个目录填充在 rails 公用文件夹中并将根路由指向 index.html 埋在那里？

到目前为止，我只使用过有用的 gem 将骨干网或 ember 集成到 Rails 资产管道中。我当然可以将各种文件移动到 rails 应用程序的 assets 目录中，但这有点违背 Yeoman 的目的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-20T23:31:35.617

到目前为止，我只使用它来制作和维护前端应用程序，使用 ajax 从部署为另一个项目（Web 服务）的后端获取所需的所有信息。

# c - 为什么这里不会发生从非常量到常量的隐式转换？

> ID：12522254
> 
> 赞同：2
> 
> 时间：2012-09-20T23:13:33.393
> 
> 标签：c, pointers, constants, implicit-conversion

> **可能重复：**
> [为什么将（指向非 const 的指针）转换为（指向 const 的指针）](https://stackoverflow.com/questions/2220916/why-isnt-it-legal-to-convert-pointer-to-pointer-to-non-const-to-a-pointer-to)
> [在 C 中的双指针 const 正确性警告是不合法的](https://stackoverflow.com/questions/5055655/double-pointer-const-correctness-warnings-in-c)

我将 a 传递`gchar**`给一个[g_key_file_set_string_list](http://developer.gnome.org/glib/stable/glib-Key-value-file-parser.html#g-key-file-get-string-list)，它需要一个`const gchar * const identifier []`

```
/* this function is part of the GLib library */
void g_key_file_set_string_list(GKeyFile *key_file,
                                const gchar *group_name,
                                const gchar *key,
                                const gchar * const list[],
                                gsize length);

const gchar **terms = malloc(sizeof(gchar*) * count);
...
...
g_key_file_set_string_list(<something>, <something>, <something>,
                           terms, count); 
```

和带有选项的 GCC 4.7.1`-std=c99 -pedantic`给了我这个

> 警告：从不兼容的指针类型传递“g_key_file_set_string_list”的参数 4
> 
> 注意：预期为 'const gchar * const*' 但参数的类型为 'gchar **'

AFAIK，在 C 和 C++ 中，从非 const 转换为 const 是隐式的，这就是我们看到标准函数喜欢`strcpy`采用 const args 的原因。那么这里不就发生了吗？

# php - 密码加密 Codeigniter

> ID：12522255
> 
> 赞同：1
> 
> 时间：2012-09-20T23:13:43.283
> 
> 标签：php

嗨，我正在尝试使我的登录表单正常工作，但到目前为止还没有运气。我需要使用加密类以便稍后在我的编辑表单中检索密码。我已经测试了编码和解码似乎工作正常，但我无法登录。当我用 md5 功能测试它时，我可以正确登录，所以问题一定出在模型的某个地方。请问有什么想法吗？

```
function validate(){
$this->db->from('users')->where('username', $this->input->post('username'));
$query = $this->db->get();
$rows = $query->row();
$password = $this->input->post('password');
 if($query->num_rows == 1){
if ($this->encrypt->decode($rows->password) === $password ) {
return true;
}}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-20T06:56:20.813

你应该做这个：

```
$password = md5($this->input->post('password')); // for encrypting the password 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T06:32:09.543

更改`if ($this->encrypt->decode($rows->password) === $password )` 为`if ($this->encrypt->decode($rows->password) == $password ) {` `===`检查对象是否属于同一类型，即数组，null。

# optimization - 让搜索引擎随着时间的推移区分网站的时间更新（如在论坛中）

> ID：12522262
> 
> 赞同：1
> 
> 时间：2012-09-20T23:14:22.287
> 
> 标签：optimization, time, search-engine

我看到搜索引擎非常有能力按时间顺序为论坛网站等查找页面，提供显示过去 24 小时、上周、上个月、去年等结果的选项。

我知道这些网站需要不断地被抓取以提供这些更新，但我对什么结构、标签或我需要做什么来为我的网站实现它有技术上的疑问。

我看到在客户端（也是搜索引擎所在的端）内容基本上显示为静态数据，已经由服务器处理，所以问题是：

**如果我有一个网站，我不断更新并将内容添加到索引页面以使其易于查看，并且我什至添加链接、时间和日期作为新页面的文本，为什么这些更新根本不显示在搜索引擎中？**

**我需要添加 XML/RSS 提要，还是其他什么？**

**具有大量更新并带有时间标记的论坛和网站如何实现允许搜索引擎列出按小时、天等分隔的结果的能力？**

**我需要为此功能添加哪些特定的标签集和整体结构？**

我还看到搜索引擎，主要是 Googlebot，通常需要至少 3 天的时间来抓取这些新页面，但是，它们在搜索结果中并没有按时间顺序排列（或根本没有）。

我没有使用任何论坛、博客或其他类型的网络发布软件，仅使用手写的原始 HTML 和 PHP，以及我上面提到的最低限度，即从网站的索引页面指向新文档以及描述。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-22T18:14:54.770

> 我需要添加 XML/RSS 提要，还是其他什么？

是的。[Atom](http://en.wikipedia.org/wiki/Atom_%28standard%29)或其中一种[RSS](http://en.wikipedia.org/wiki/RSS)格式（或同时提供多种格式，因此您可以提供 Atom*和*RSS）。

搜索引擎会知道新的博客帖子、微博帖子、论坛主题、论坛主题答案等，因为他们订阅了提要。所以有时你会注意到一个页面在发布几分钟后就被搜索引擎索引了。但是对于较小的站点，搜索引擎可能不会每隔几分钟检查一次更新，而是可能需要几天时间才能将新页面编入索引。

[站点地图](http://en.wikipedia.org/wiki/Site_map)也可能有所帮助。

# ios - iOS 在单元格之间创建一个不可见的空间

> ID：12522264
> 
> 赞同：0
> 
> 时间：2012-09-20T23:14:41.503
> 
> 标签：ios, objective-c, uitableview, ios6

我在这里有一个标准的表格视图，我希望能够在每个显示背景的不可见/隐藏单元格之间添加一个空格。正确的做法是什么？

**这是我正在使用的代码：**

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

static NSString *CellIdentifier = @"Cell";
JointCAD *currentCall = [[xmlParser calls] objectAtIndex:indexPath.row];

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil)
{
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier];

    // Format each frame that holds each piece of content in each row

    CGRect countyImageFrame = CGRectMake(275, 6, 18, 18);
    UIImageView *countyImageLabel = [[UIImageView alloc] initWithFrame:countyImageFrame];
    countyImageLabel.tag = 0016;
    countyImageLabel.backgroundColor = BG_COLOR
    [cell.contentView addSubview:countyImageLabel];

    CGRect callTypeImageFrame = CGRectMake(275, 30, 18, 18);
    UIImageView *callTypeImageLabel = [[UIImageView alloc] initWithFrame:callTypeImageFrame];
    callTypeImageLabel.tag = 0017;
    callTypeImageLabel.backgroundColor = BG_COLOR
    [cell.contentView addSubview:callTypeImageLabel];

    CGRect callTypeFrame = CGRectMake(5, 2, 175, 15);
    UILabel *callTypeLabel = [[UILabel alloc] initWithFrame:callTypeFrame];
    callTypeLabel.tag = 0011;
    callTypeLabel.backgroundColor = BG_COLOR
    callTypeLabel.numberOfLines = 2;
    callTypeLabel.font = [UIFont boldSystemFontOfSize:12];
    [cell.contentView addSubview:callTypeLabel];

    CGRect locationFrame = CGRectMake(5, 21, 175, 10);
    UILabel *locationLabel = [[UILabel alloc] initWithFrame:locationFrame];
    locationLabel.tag = 0014;
    locationLabel.backgroundColor = BG_COLOR
    locationLabel.numberOfLines = 2;
    locationLabel.font = [UIFont systemFontOfSize:10];
    [cell.contentView addSubview:locationLabel];

    CGRect unitsFrame = CGRectMake(3, 40, 175, 10);
    UILabel *unitsLabel = [[UILabel alloc] initWithFrame:unitsFrame];
    unitsLabel.tag = 0012;
    unitsLabel.backgroundColor = BG_COLOR
    unitsLabel.textColor = [UIColor blackColor];
    unitsLabel.font = [UIFont italicSystemFontOfSize:10];
    [cell.contentView addSubview:unitsLabel];

    CGRect stationFrame = CGRectMake(185 , 28, 85, 20);
    UILabel *stationLabel = [[UILabel alloc] initWithFrame:stationFrame];
    stationLabel.tag = 0013;
    stationLabel.backgroundColor = BG_COLOR
    stationLabel.font = [UIFont boldSystemFontOfSize:12];
    [cell.contentView addSubview:stationLabel];

    CGRect callnumberFrame = CGRectMake(185 , 5, 80, 20);
    UILabel *callnumberLabel = [[UILabel alloc] initWithFrame:callnumberFrame];
    callnumberLabel.tag = 0015;
    callnumberLabel.backgroundColor = BG_COLOR
    callnumberLabel.font = [UIFont boldSystemFontOfSize:12];
    [cell.contentView addSubview:callnumberLabel];

}

// Display content in each cell

if ([currentCall.county isEqualToString:@"W"]) {
    UIImage  *countyImage = [UIImage imageNamed:@"blue.png"];
    UIImageView *countyImageLabel = (UIImageView *)[cell.contentView viewWithTag:0016];
    countyImageLabel.image = countyImage;
}
else {
    UIImage  *countyImage = [UIImage imageNamed:@"green.png"];
    UIImageView *countyImageLabel = (UIImageView *)[cell.contentView viewWithTag:0016];
    countyImageLabel.image = countyImage;
}

if ([currentCall.callType isEqualToString:@"F"]) {
    UIImage  *callTypeImage = [UIImage imageNamed:@"red.png"];
    UIImageView *callTypeImageLabel = (UIImageView *)[cell.contentView viewWithTag:0017];
    callTypeImageLabel.image = callTypeImage;
}
else {
    UIImage  *callTypeImage = [UIImage imageNamed:@"yellow.png"];
    UIImageView *callTypeImageLabel = (UIImageView *)[cell.contentView viewWithTag:0017];
    callTypeImageLabel.image = callTypeImage;
}

UILabel *callTypeLabel = (UILabel *)[cell.contentView viewWithTag:0011];
callTypeLabel.text =  [currentCall currentCallType];

UILabel *locationLabel = (UILabel *)[cell.contentView viewWithTag:0014];
locationLabel.text = [currentCall location];

UILabel *unitsLabel = (UILabel *)[cell.contentView viewWithTag:0012];
unitsLabel.text = [currentCall units];

NSString *station = [@"Station: " stringByAppendingString:currentCall.station];

UILabel *stationLabel = (UILabel *)[cell.contentView viewWithTag:0013];
stationLabel.text = station;

NSString *callnumber = [@"Call No: " stringByAppendingString:currentCall.callnumber];

UILabel *callnumberLabel = (UILabel *)[cell.contentView viewWithTag:0015];
callnumberLabel.text = callnumber;

cell.backgroundColor = BG_COLOR

return cell;
}

// Set how tall each cell is

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
return 55;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T06:47:49.493

只需使用技巧在每个单元格之间留出空格..

```
 static NSString *CELL_ID2 = @"SOME_STUPID_ID2";
    // even rows will be invisible
    if (indexPath.row % 2 == 1)
    {
        UITableViewCell * cell2 = [tableView dequeueReusableCellWithIdentifier:CELL_ID2];

        if (cell2 == nil)
        {
            cell2 = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault
                                           reuseIdentifier:CELL_ID2];
            [cell2.contentView setAlpha:0];
            [cell2 setUserInteractionEnabled:NO]; // prevent selection and other stuff
        }

        return cell2;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-05T03:15:24.453

我只是在单元格之间使用不同的高度和交替的颜色。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    tableView.separatorStyle = UITableViewCellSeparatorStyleNone;

    if (indexPath.row % 2 == 1)
    {
        static NSString *CellIdentifier = @"cellID1";
        UITableViewCell *cell = (UITableViewCell *)[tableView dequeueReusableCellWithIdentifier:CellIdentifier];
        if (cell == nil) {
            cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault
                                            reuseIdentifier:CellIdentifier];
        }

        cell.backgroundColor = [UIColor colorWhite];

        return cell;

    } else {

        static NSString *CellIdentifier2 = @"cellID2";
        UITableViewCell *cell2 = (UITableViewCell *)[tableView dequeueReusableCellWithIdentifier:CellIdentifier2];
        if (cell2 == nil) {
            cell2 = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault
                                            reuseIdentifier:CellIdentifier2];
        }
        cell2.backgroundColor = [UIColor clearColor];

        return cell2;
    }

}

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (indexPath.row % 2 == 1) {
        return 40.0;
    } else {
        return 2.0;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-21T02:47:20.250

首先让我说我没有阅读您的所有代码。这就是说我已经做到了这一点。第一种方法是在 heightForCell 中为上面应该有间隙的单元格声明一个更大的值。cell.contentView 可能需要设置其 clipToBounds。我相信在这种情况下，应该通过设置 cell.frame.size （原点为 0,0）来设置单元格大小，并且 contentView 和 backgroundview 的大小也正确。

第二种方法是插入空单元格 - 具有不同重用标识符的单元格，它们只是空单元格，所有内容都设置为具有清晰的颜色。

# plugins - 编写屏幕共享插件/驱动程序

> ID：12522267
> 
> 赞同：5
> 
> 时间：2012-09-20T23:15:21.240
> 
> 标签：plugins, virtual, webcam, screensharing, tokbox

我一直在使用[OpenTok](http://www.tokbox.com/)开发一个可以向多达 2500 个订阅者广播流的 web 应用程序。OpenTok 为您处理大部分工作，但它不允许屏幕共享——这对我的 web 应用程序至关重要。为了启用屏幕共享，我正在寻找可以让广播公司下载和安装的开源插件/驱动程序，该插件应该捕获屏幕并将其作为虚拟网络摄像头共享，以便像 OpenTok 这样的服务可以广播/存档/存储它.

你如何着手编写这样的驱动程序？你知道任何可以作为一个好的起点的开源项目吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-18T23:49:15.407

我不知道用于屏幕共享的开源项目，但[screenleap](http://www.screenleap.com/api/quick-start)提供了用于屏幕共享的 api，您可以将其与 OpenTok 一起使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-18T05:54:27.303

您是否使用以下链接的 Opentok：

```
https://meet.tokbox.com/ 
```

并在github上提供源代码

```
https://github.com/aullman/opentok-meet/tree/master/opentok-meet-cordova 
```

我希望这能帮到您..

# file - 如何在目录及其子目录中找到最大的文件？

> ID：12522269
> 
> 赞同：112
> 
> 时间：2012-09-20T23:15:25.833
> 
> 标签：file, bash, directory, find, large-files

我们刚刚开始上 UNIX 课程，并且正在学习各种 Bash 命令。我们的任务涉及在一个目录下执行各种命令，该目录下也有许多文件夹。

我知道如何使用以下方法列出和计算根文件夹中的所有常规文件：

```
find . -type l | wc -l 
```

但我想知道从那里去哪里才能找到整个目录中最大的文件。我见过一些关于`du`命令的东西，但我们还没有学到这一点，所以在我们学到的所有东西中，我假设我们需要以某种方式将它连接到`ls -t`命令。

如果我的“术语”不正确，请原谅我，我还在习惯它！

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2012-09-20T23:21:11.683

[从此](http://unstableme.blogspot.com/2009/01/find-largest-files-in-linux.html)链接引用-

> 如果要查找并打印特定目录及其子目录中的前 10 个最大文件名（不是目录）
> 
> `$ find . -type f -printf '%s %p\n'|sort -nr|head`
> 
> 要将搜索限制在当前目录，请使用“-maxdepth 1”和 find。
> 
> `$ find . -maxdepth 1 -printf '%s %p\n'|sort -nr|head`
> 
> 并打印前 10 个最大的“文件和目录”：
> 
> `$ du -a . | sort -nr | head`
> 
> ** 使用“head -n X”而不是上面唯一的“head”来打印前 X 个最大的文件（在上述所有示例中）

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2014-05-29T03:42:29.970

在当前目录及其子目录中查找前 25 个文件：

`find . -type f -exec ls -al {} \; | sort -nr -k5 | head -n 25`

这将通过“sort -nr -k5”管道命令根据文件大小排序输出前 25 个文件。

相同但具有人类可读的文件大小：

`find . -type f -exec ls -alh {} \; | sort -hr -k5 | head -n 25`

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-09-21T03:45:03.397

```
find . -type f | xargs ls -lS | head -n 1 
```

输出

```
-rw-r--r--  1 nneonneo  staff  9274991 Apr 11 02:29 ./devel/misc/test.out 
```

如果你只想要文件名：

```
find . -type f | xargs ls -1S | head -n 1 
```

这避免了使用`awk`并允许您使用任何您想要的标志`ls`。

*警告*。因为`xargs`试图避免构建过长的命令行，所以如果您在包含大量文件的目录上运行它可能会失败，因为`ls`最终会执行多次。这不是一个不可克服的问题（您可以收集`head -n 1`每次`ls`调用的输出，然后`ls -S`再次运行，循环直到您有一个文件），但它确实在某种程度上破坏了这种方法。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-05-26T09:34:26.173

没有简单的命令可用于找出 Linux/UNIX/BSD 文件系统上最大的文件/目录。但是，结合以下三个命令（使用管道），您可以轻松找到最大文件的列表：

```
# du -a /var | sort -n -r | head -n 10 
```

如果您想要更多人类可读的输出，请尝试：

```
$ cd /path/to/some/var
$ du -hsx * | sort -rh | head -10 
```

在哪里，

*   **var**是您要搜索的目录
*   **du 命令 -h 选项：**以人类可读的格式显示大小（例如，1K、234M、2G）。
*   **du 命令 -s 选项：**仅显示每个参数的总数（摘要）。
*   **du 命令 -x 选项：**跳过不同文件系统上的目录。
*   **排序命令 -r 选项：**反转比较结果。
*   **排序命令 -h 选项：**比较人类可读的数字。这只是 GNU 排序特定的选项。
*   **head 命令 -10 或 -n 10 选项：**显示前 10 行。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2012-09-20T23:20:50.657

如果文件是普通文件，这将递归列出文件，按第 7 个字段排序（这是我的`find`输出中的大小；检查你的），并只显示第一个文件。

```
find . -type f -ls | sort +7 | head -1 
```

第一个选项`find`是递归搜索的开始路径。A 类`f`搜索普通文件。请注意，如果您尝试将其解析为文件名，则如果文件名包含空格、换行符或其他特殊字符，您可能会失败。选项`sort`也因操作系统而异。我正在使用 FreeBSD。

一个“更好”但更复杂和更重`find`的解决方案是遍历目录，但可能用于`stat`获取有关文件的详细信息，然后可能用于`awk`查找最大大小。请注意， 的输出`stat`还取决于您的操作系统。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-09-20T23:21:01.660

这将在您当前的工作目录中找到最大的文件或文件夹：

```
ls -S /path/to/folder | head -1 
```

要在所有子目录中查找最大的文件：

```
find /path/to/folder -type f -exec ls -s {} \; | sort -nr | awk 'NR==1 { $1=""; sub(/^ /, ""); print }' 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-10-13T22:33:18.040

在 Solaris 上，我使用：

```
find . -type f -ls|sort -nr -k7|awk 'NR==1{print $7,$11}' #formatted 
```

或者

```
find . -type f -ls | sort -nrk7 | head -1 #unformatted 
```

因为这里发布的任何其他内容都不起作用。这将在`$PWD`和子目录中找到最大的文件。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-09-21T03:23:36.600

尝试以下命令：

```
find /your/path -printf "%k %p\n" | sort -g -k 1,1 | awk '{if($1 > 500000) print $1/1024 "MB" " " $2 }' |tail -n 1 
```

这将打印最大的文件名和大小并且超过500M。您可以移动`if($1 > 500000)`，它将打印目录中最大的文件。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-03-05T12:34:35.823

尝试以下单行（显示前 20 个最大的文件）：

```
ls -1Rs | sed -e "s/^ *//" | grep "^[0-9]" | sort -nr | head -n20 
```

或（人类可读尺寸）：

```
ls -1Rhs | sed -e "s/^ *//" | grep "^[0-9]" | sort -hr | head -n20 
```

> 与其他答案相比，在 Linux/BSD/OSX 下工作正常，因为 find 的`-printf`选项在 OSX/BSD 上不存在，并且`stat`根据操作系统具有不同的参数。但是，要在 OSX/BSD 上正常工作的第二个命令（因为`sort`没有`-h`），`sort`从安装`coreutils`或删除`-h`并改为`ls`使用`sort -nr`。

所以这些别名在你的*rc*文件中很有用：

```
alias big='du -ah . | sort -rh | head -20'
alias big-files='ls -1Rhs | sed -e "s/^ *//" | grep "^[0-9]" | sort -hr | head -n20' 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-09-20T23:33:06.723

`du -aS /PATH/TO/folder | sort -rn | head -2 | tail -1`

或者

`du -aS /PATH/TO/folder | sort -rn | awk 'NR==2'`

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-03-08T01:14:45.957

列出文件夹中较大的文件

```
ls -sh /pathFolder | sort -rh | head -n 1 
```

的输出`ls -sh`是文件大小数字的大小`s`和人类`h`可以理解的视图。

你可以使用`ls -shS /pathFolder | head -n 1`. 较大`S`的从`ls`已经将列表从较大的文件排序到较小的文件，但第一个结果是该文件夹中所有文件的总和。因此，如果您只想列出更大的文件，一个文件，您需要`head -n 2`检查“第二行结果”或将第一个示例与`ls sort head`.

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-07-26T19:07:15.210

这个命令对我有用，

> `find /path/to/dir -type f -exec du -h '{}' + | sort -hr | head -10`

以人类可读模式列出按大小排序的前 10 个文件。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-01-22T07:41:24.897

此脚本简化了查找最大文件以供进一步操作。我将它保存在我的 ~/bin 目录中，并将 ~/bin 放在我的 $PATH 中。

```
#!/usr/bin/env bash
# scriptname: above
# author: Jonathan D. Lettvin, 201401220235

# This finds files of size >= $1 (format ${count}[K|M|G|T], default 10G)
# using a reliable version-independent bash hash to relax find's -size syntax.
# Specifying size using 'T' for Terabytes is supported.
# Output size has units (K|M|G|T) in the left hand output column.

# Example:
#   ubuntu12.04$ above 1T
#   128T /proc/core

# http://stackoverflow.com/questions/1494178/how-to-define-hash-tables-in-bash
# Inspiration for hasch: thanks Adam Katz, Oct 18 2012 00:39
function hasch() { local hasch=`echo "$1" | cksum`; echo "${hasch//[!0-9]}"; }
function usage() { echo "Usage: $0 [{count}{k|K|m|M|g|G|t|T}"; exit 1; }
function arg1() {
    # Translate single arg (if present) into format usable by find.
    count=10; units=G;  # Default find -size argument to 10G.
    size=${count}${units}
    if [ -n "$1" ]; then
        for P in TT tT GG gG MM mM Kk kk; do xlat[`hasch ${P:0:1}`]="${P:1:1}"; done
        units=${xlat[`hasch ${1:(-1)}`]}; count=${1:0:(-1)}
        test -n "$units" || usage
        test -x $(echo "$count" | sed s/[0-9]//g) || usage
        if [ "$units" == "T" ]; then units="G"; let count=$count*1024; fi
        size=${count}${units}
    fi
}
function main() {
    sudo \
        find / -type f -size +$size -exec ls -lh {} \; 2>/dev/null | \
        awk '{ N=$5; fn=$9; for(i=10;i<=NF;i++){fn=fn" "$i};print N " " fn }'
}

arg1 $1
main $size 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-03-14T07:40:40.450

这是非常简单的方法：

```
ls -l | tr -s " " " " | cut -d " " -f 5,9 | sort -n -r | head -n 1*** 
```

你会得到这个：`8445 examples.desktop`

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-03-03T21:05:14.683

**Linux 解决方案：**例如，您想根据文件/文件夹大小（**降序**）查看主（/）目录的所有文件/文件夹列表。

须藤杜-xm / | 排序-rn | 更多的

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-01-11T16:34:22.470

```
ls -alR|awk '{ if ($5 > max) {max=$5;ff=$9}} END {print max "\t" ff;}' 
```

# assembly - 用于在内存中存储多个寄存器的 ARM 指令

> ID：12522273
> 
> 赞同：0
> 
> 时间：2012-09-20T23:15:49.983
> 
> 标签：assembly, arm

以下 ARM 指令在一条指令中将多个浮点寄存器存储在内存中（当然，在每个寄存器存储之后递增基地址）：

```
VSTMIA R0! {S1-S4} 
```

现在的问题是寄存器列表必须是连续的，即如果你想在 R0 中传输寄存器，例如 R0 中的 S1，R0 + 4 中的 S3，你不能在不调用单个存储的情况下做到这一点。我有几个寄存器想一次性存储在内存中，但问题是它们需要以不同的顺序存储。我真的不想交换寄存器（我有大约 7 个寄存器）。那么有没有更聪明的方法呢？还想知道是否有人知道使用 VSTM 进行单次多次传输是否比使用单个 VSTR 指令进行多次传输更快？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T00:15:54.163

您忘记提及您正在使用的 CPU 架构。如果您为 NEON 编写代码，请查看 ARM 博客中的此页面：[为 NEON 编码 - 第 5 部分：重新排列向量](http://blogs.arm.com/software-enablement/684-coding-for-neon-part-5-rearranging-vectors/)。

编辑：
*使用 VSTM 进行单次多次传输是否比使用单个 VSTR 指令进行多次传输更快？*

可能，但不要相信任何人的话。您最好的选择是分析您的代码并查看您的核心的[技术参考手册](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.set.cortexa/index.html)。

# java - 删除重复节点

> ID：12522276
> 
> 赞同：1
> 
> 时间：2012-09-20T23:16:18.527
> 
> 标签：java, duplicates, nodes

我迷路了，真的希望有人能在这里帮助我，我应该创建一个函数来查找重复的数字节点并删除重复项。每当我运行整个代码时，我都会陷入内部的无限循环`while(current.next != null)`。

我的主要问题是，我知道我的问题存在于`if (tester.data == current.data)`. 我不明白为什么他们从不测试或比较（他们的整数）。如果这是一个模糊的问题，我很抱歉，我已经困惑地盯着屏幕看了好几个小时。

```
public void removeDuplicate()
{
    // removes all duplicate nodes from the list

    Node tester = head;
    Node previous = head;
    Node current = head.next;

    while (tester.next != null){
        int i = 0;
        while(current.next != null){
            System.out.println("Stuck here3");
            if (tester.data == current.data){
            Node tempNode = current.next;
                previous.next = tempNode;
                current = tempNode;
                size--;
                System.out.println("Stuck here2");
                break;
                }

            else{   
                previous = current;
                current = current.next;
            }

        }
        System.out.println("Stuck here1");
        tester = tester.next;
        current = tester.next;
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T02:28:07.223

> 我的主要问题是，我知道我的问题在于 if (tester.data == current.data)。我不明白为什么他们从不测试或比较（他们的整数）。如果这是一个模糊的问题，我很抱歉，我已经困惑地盯着屏幕看了好几个小时。

不，那不是你的问题。他们实际上进行了测试和比较，并且在发生这种情况时删除节点是有效的。

但是，您的代码中还有其他问题。

由于`break`在内部循环中，您只需为每个值删除一个重复项。

如果你删除`break`它变得更近，但在循环结束时，你有

```
 tester = tester.next;
    current = tester.next; 
```

并且您没有设置`previous`适当的新值。

它应该是

```
 tester = tester.next;
    previous = tester;
    current = tester.next; 
```

进行这两项更改后，您的代码将删除所有重复项，除非有一个出现在列表的最后。

我怀疑我也可以解决这个问题，但我更倾向于完全重写。如果我这样做，我可能会发布它。

# windows-xp - windows下使用SAS和mkdir创建目录结构

> ID：12522279
> 
> 赞同：5
> 
> 时间：2012-09-20T23:16:27.710
> 
> 标签：windows-xp, cmd, sas, mkdir

我想在 SAS 中在 Windows 中创建一个目录结构。最好使用允许我指定 UNC 命名约定的方法，例如：

```
\\computername\downloads\x\y\z 
```

我在网上看到了很多使用 DOS`mkdir`命令的 SAS 示例 via`%sysexec()`或`x`command。mkdir 命令的好处是，如果它们也不存在，它将创建任何中间文件夹。我从提示符成功测试了以下命令，它的行为符合预期（引用似乎无关紧要，因为我的路径名中没有空格）：

```
mkdir \\computername\downloads\x\y\z
mkdir d:\y
mkdir d:\y\y
mkdir "d:\z"
mkdir "d:\z\z"
mkdir \\computername\downloads\z\z\z
mkdir "\\computername\downloads\z\z\z" 
```

以下从 SAS 运行良好：

```
x mkdir d:\x;
x 'mkdir d:\y';
x 'mkdir "d:\z"';
x mkdir \\computername\downloads\x;
x 'mkdir \\computername\downloads\y'; 
```

但是这些在从 SAS 运行时不起作用，例如：

```
x mkdir d:\x\x;
x 'mkdir d:\y\y';
x 'mkdir "d:\z\z"';
x mkdir \\computername\downloads\x\y\z ;
x 'mkdir "\\computername\downloads\z"';

** OR **;

%sysexec mkdir "\\computername\downloads\x\y\z ";

** OR **;

filename mkdir pipe "mkdir \\computername\downloads\x\y\z";
data _null_;
  input mkdir;
  put infile;
run; 
```

这没用。不仅如此，即使我已`options xwait`指定，窗口也会立即关闭，因此没有机会看到任何错误消息。我已经尝试了所有使用 UNC 路径和驱动器号路径的方法，即。`D:\downloads\x\y\z`.

如果我查看操作系统返回的错误消息：

```
%put %sysfunc(sysrc()) %sysfunc(sysmsg()); 
```

我得到以下信息：

```
-20006 WARNING: Physical file does not exist, d:\downloads\x\x\x. 
```

查看`mkdir`命令的文档，它似乎只支持在启用“命令扩展”时创建中间文件夹。这可以通过添加`/E:ON`to来实现`cmd.exe`。我尝试更改我的代码以使用：

```
cmd.exe /c /E:ON mkdir "\\computername\downloads\x\y\z" 
```

仍然没有运气！

谁能告诉我为什么除了我之外，互联网上的其他人似乎都能够从 SAS 内部完成这项工作？同样，它在 DOS 提示符下工作正常——只是在 SAS 中不行。

我更喜欢一个专门解决这个问题的答案（我知道还有其他使用多个步骤或的解决方案`dcreate()`）。

我正在运行 WinXP 32Bit、SAS 9.3 TS1M2。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2018-09-14T20:28:56.873

这是使用 LIBNAME 语句创建目录的技巧

`options dlcreatedir; libname newdir "/u/sascrh/brand_new_folder";`

我相信这比 X 语句更可靠。

资料来源：[SAS 技巧：获取 LIBNAME 语句为您创建文件夹](https://blogs.sas.com/content/sasdummy/2013/07/02/use-dlcreatedir-to-create-folders/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-21T00:25:09.060

我也在 WinXP 上，使用 SAS 9.3 TS1M1。以下为我宣传的工作：

```
122  options noxwait;
123  data _null_;
124    rc = system('mkdir \\W98052442n3m1\public\x\y\z');
125    put rc=;
126  run;

rc=0
NOTE: DATA statement used (Total process time):
      real time           1.68 seconds
      cpu time            0.03 seconds 
```

那是我的实际日志文件；“public”是该网络 PC 上的 Windows 共享文件夹，并且已创建整个路径。也许使用该`SYSTEM`功能可以解决问题。我自己从来没有使用过 X 命令。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-21T08:29:54.807

您需要引用您的 x 命令，例如

```
x 'mkdir "c:\this\that\something else"' ; 
```

另外，我在使用 UNC 路径时从来没有遇到过问题，例如

```
x "\\server.domain\share\runthis.exe" ; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-07-30T16:46:15.650

您需要使用将创建所有子文件夹的`mkdir`选项`-p`

IE

```
x mkdir -p "c:\newdirectory\level 1\level 2"; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-21T00:34:34.603

这似乎在dos窗口保持打开状态下工作得很好。您可能需要 XSYNC 选项。我在 MAC 上的 VMWARE 下使用 9.3 TS1M1 64 位：

```
options xwait xsync;
x mkdir c:\newdirectory; 
```

# objective-c - 多点触控 Cocos2d TouchesBegan 个人与多点触控

> ID：12522283
> 
> 赞同：1
> 
> 时间：2012-09-20T23:16:52.440
> 
> 标签：objective-c, ios, cocos2d-iphone, multi-touch, touchesbegan

我正在设计一个应用程序，我们在多点触控点击和稍微延迟的多点触控点击方面遇到了一些问题（这导致了对 TouchesBegan 的 2 次单独调用）。

我们遇到的问题是当玩家同时用两根手指点击时：

有时它可以注册为一个 NSSet，touches.count = 2

或者

有时，如果玩家在第二次触摸时稍微晚了一点，它会注册两次对 CCTouchesBegan 的调用，每次调用 touches.count = 1。

使用 touches.count = 2 注册两个 TouchesBegan 调用以及当玩家在第二次触摸时稍晚（两次调用 TouchesBegan）使用相同的回调时，最简单的方法是什么？

我最初的想法是获取[事件时间戳]并将其与之前的时间戳进行比较，然后检查它是否在某个时间间隔内......

最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T07:16:51.823

您不需要时间戳比较。您可以使用**事件**来检索触摸，而不是使用**触摸NSSet 对象。**

 **```
- (void) ccTouchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    if( [[event allTouches] count] == 2 )
    {
        // Do your thing here
    }
} 
```

注意：如果您用两根手指轻按，会稍有延迟，ccTouchesBegan 将被调用两次，但在第二次调用**事件**对象中会有两次触摸。**

# iphone - 为什么 url 在 iOS 6 上的行为不同

> ID：12522284
> 
> 赞同：0
> 
> 时间：2012-09-20T23:17:12.253
> 
> 标签：iphone, xcode, sdk, app-store, ios6

我正在尝试使用适用于 iOS 5 的相同代码从我的应用程序在应用程序商店中启动我的页面。Apple 是否改变了它在 iOS 6 中的工作方式？应用商店正在启动并显示“无法连接到 iTunes Store”

```
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"itms-apps://itunes.com/apps/myname"]]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T00:11:04.883

我认为，要解决这个问题，请稍等。苹果服务器似乎有问题。

有关更多信息，请单击[此处](http://support.apple.com/kb/TS1368)

对于您的问题同事，请单击[此处](https://www.google.com/search?q=Cannot%20connect%20to%20iTunes%20Store,%20ios%206&sugexp=chrome,mod=6&sourceid=chrome&ie=UTF-8)

**编辑**：

如果不是服务器问题，请尝试：

```
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"http://itunes.apple.com/ru/app/facebook/id284882215?mt=8"]]; 
```

Safari 会打开一个 iTunes

# xcode - 无法在 XCode 4.5 上安装 iPhone 5.x 模拟器

> ID：12522288
> 
> 赞同：0
> 
> 时间：2012-09-20T23:17:31.440
> 
> 标签：xcode

尝试安装上述内容并收到错误消息：“失败并出现 HTTP 状态 499-客户端错误”。我正在使用下拉菜单“安装其他模拟器...”（在 XC 中的方案旁边）。

这是我重新启动机器后得到的： ![在此处输入图像描述](../Images/ee63d6b441f6532dd5773b230feb3fb0.png)

我死在水里了……有人能帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T07:01:12.083

Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/Sdk's/iPhoneSimulator5.1.sdk

只需复制并粘贴到您需要这些模拟器的其他 xcode 上，您需要再次下载

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T16:42:40.070

最终删除了 XC 4.4.1 和以前的版本......重新安装了 XC 4.5 并且能够安装模拟器。

# javascript - 在 JavaScript 中暂停 YouTube iFrame API

> ID：12522291
> 
> 赞同：13
> 
> 时间：2012-09-20T23:17:41.873
> 
> 标签：javascript, jquery, youtube, youtube-api

`img`我在幻灯片中嵌入了一个 Youtube 视频，当用户单击缩略图时我想暂停该视频：

```
<li><iframe width="430" height="241" src="http://www.youtube.com/watch?v=XjUz8IT0CYg?enablejsapi=1&theme=light&showinfo=0" frameborder="0" allowfullscreen id="my-video"></iframe></li> 
```

我一直在使用 Youtube API，但我很困惑如何开始。

`?enablejsapi`当我附加到 YouTube 的末尾时，API JS 会自动加载`video id`吗？

这是我的 JS：

```
var player1 = document.getElementById('my-video');

$('img').click(function () {
  player1.pauseVideo();
}) 
```

**编辑：**

对于任何想知道的人，这是我根据马特下面的回答所做的：

```
<li><iframe width="430" height="241" src="http://www.youtube.com/embed/XjUz8IT0CYg?enablejsapi=1&theme=light&showinfo=0" frameborder="0" allowfullscreen id="player-1"></iframe></li>

<li><iframe width="430" height="241" src="http://www.youtube.com/embed/HVhSasnVjMQ?enablejsapi=1&theme=light&showinfo=0" frameborder="0" allowfullscreen id="player-2"></iframe></li> 
```

然后我的JS：

```
var tag = document.createElement('script');
tag.src = "//www.youtube.com/iframe_api";
var firstScriptTag = document.getElementsByTagName('script')[0];
firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

// Create YouTube player(s) after the API code downloads.
var player1;
var player2;

function onYouTubeIframeAPIReady() {
    player1 = new YT.Player('player-1');
    player2 = new YT.Player('player-2');
} 
```

然后在`document.ready`：

```
$(document).ready(function () {
    $(".slideshow-1 img").click(function () {
        player1.stopVideo();
    });

    $(".slideshow-2 img").click(function () {
        player2.stopVideo();
    });
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-15T23:27:46.067

如果要将 JS 保存在外部文件中，请使用：

**HTML**

```
<iframe id="player1" class="ytplayer" width="430" height="241" src="http://www.youtube.com/embed/HVhSasnVjMQ?enablejsapi=1&theme=light&showinfo=0" frameborder="0" allowfullscreen></iframe>
<iframe id="player2" class="ytplayer" width="430" height="241" src="http://www.youtube.com/embed/HVhSasnVjMQ?enablejsapi=1&theme=light&showinfo=0" frameborder="0" allowfullscreen></iframe> 
```

**JS**

```
var yt_int, yt_players={},
    initYT = function() {
        $(".ytplayer").each(function() {
            yt_players[this.id] = new YT.Player(this.id);
        });
    };
$.getScript("//www.youtube.com/player_api", function() {
    yt_int = setInterval(function(){
        if(typeof YT === "object"){
            initYT();
            clearInterval(yt_int);
        }
    },500);
}); 
```

**控制视频**

```
yt_players['player_id'].playVideo(); 
```

我这样做的原因是因为我通过 CMS 动态加载了视频，并且它们在叠加层中打开。我将关闭/打开覆盖功能设置为播放/暂停视频。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-09-20T23:45:38.620

在嵌入字符串中追加`?enablejsapi`不会自动包含 API 代码。它只使用 API 注册特定的嵌入。

您想在这里阅读第一个示例：[https ://developers.google.com/youtube/iframe_api_reference](https://developers.google.com/youtube/iframe_api_reference)

1.  异步代码段下载并执行 YT iframe API
2.  `onYouTubeIframeAPIReady()`当 API 准备好时触发
3.  创建一个新`YT.Player`对象
4.  您的代码现在可以调用`pauseVideo()`您的播放器对象

您很可能希望禁用 img 上的任何事件，直到`onYouTubeIframeAPIReady()`被触发。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-03-15T06:49:19.577

我有另一个解决方案：

```
<iframe id="player1" class="ytplayer" width="430" height="241" src="http://www.youtube.com/embed/HVhSasnVjMQ?enablejsapi=1&theme=light&showinfo=0" frameborder="0" allowfullscreen></iframe>
<iframe id="player2" class="ytplayer" width="430" height="241" src="http://www.youtube.com/embed/HVhSasnVjMQ?enablejsapi=1&theme=light&showinfo=0" frameborder="0" allowfullscreen></iframe> 
```

和

```
$('.ytplayer').each(function(){
    //this.contentWindow.postMessage('{"event":"command","func":"' + 'stopVideo' + '","args":""}', '*');
    this.contentWindow.postMessage('{"event":"command","func":"' + 'pauseVideo' + '","args":""}', '*')
}); 
```

# internet-explorer - 如何注册 CAB 文件

> ID：12522292
> 
> 赞同：1
> 
> 时间：2012-09-20T23:17:41.920
> 
> 标签：internet-explorer, registry, activex, cab

我在 Visual Studio 的解决方案中使用`ActiveX`打包文件，该文件包含 2 个文件 a和 a .`CAB``CAB``abc.inf``abcInstaller.msi`

我已经调整了设置，`IE`以便`ActiveX`安装。通过在其中运行应用程序`IE`要求允许`ActiveX`按预期安装它，`ActiveX`安装正确但未注册，因此我尝试通过运行`regMyActiveX.reg`包含以下内容的文件手动执行此操作：

```
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Salihane.Group]
@="SLGP.SalihaneGroup"

[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Salihane.Group\CLSID]
@="{121C3E0E-DC6E-45DC-952B-A6617F0FAA32}" 
```

据我所知，如果 ActiveX 已安装并注册，那么它应该可以完成它的工作，但它不起作用。我想我在错误的地方或方式上注册了它。我的 reg 文件是错误的还是其他原因？

任何帮助，将不胜感激

# javascript - 使用 jQuery 从 HTML 中删除数据属性

> ID：12522293
> 
> 赞同：10
> 
> 时间：2012-09-20T23:17:44.093
> 
> 标签：javascript, jquery

似乎无法让这个工作......

我有一个隐藏某些链接的页面。加载 DOM 后，我使用 jQuery 来切换其中的一些元素。这是通过使用如下数据属性驱动的：

```
<div class="d_btn" data-usr='48'>
  <div class="hidden_button"> 
```

然后，我有代码：

```
 $.each($(".d_btn"), function() {
     var btn = $(this).data('usr');
   if ( btn == '48' ){      
     $(this).children('.hidden_button').toggle();
   } 
```

以上所有工作按计划进行。问题是，一旦评估了 if 语句，我就试图从 .d_btn 类中删除 data-usr 。我尝试了以下方法，但没有任何效果（即，加载页面后，源仍然显示 data-usr 属性：

```
$(this).removeAttr("data-usr");

$(this).removeData("usr"); 
```

我已经为此工作了几个小时，但......什么都没有！非常感谢您的帮助！

**更新**

我已经尝试了将数据属性设置为空字符串的好建议，但我仍然没有得到想要的结果。

为了进一步解释，我试图删除该属性的原因是，当 ajax 响应向页面添加另一个项目时，先前添加的项目已经显示或隐藏了按钮。根据 AJAX 响应，一旦加载了 DOM，我将调用相同的函数。

目前，当通过 AJAX 添加某些内容时，它会切换所有按钮（显示隐藏的按钮，反之亦然。）呃......

我也完全愿意尝试替代我的方法。谢谢！

***更新***

好吧，灯泡刚刚闪烁，我可以通过使用 .show() 而不是 .toggle() 来做我想做的事

无论如何，我仍然想找到这个问题的答案，因为每当添加某些内容时，该页面可能会检查数百个项目 - 这似乎非常低效（即使对于计算机，哈哈哈。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-20T23:20:11.720

如果 removeAttr 不起作用，为什么不将值设置为随机值或空变量。

```
$(this).attr("data-usr" , '');

$(this).prop("data-usr" , ''); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-20T23:20:13.487

更改 DOM 不会影响源。它会影响 DOM，您可以使用 Inspector/Developer Tools 查看。右键单击 => 查看源代码将为您提供页面的原始源代码，而不是 JavaScript 修改的实际当前源代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-20T23:20:13.547

将其设置为空白字符串：

```
$(this).attr("data-usr", ""); 
```

我赞同 Kolink 所说的：检查 DOM，而不是源。（铬：Ctrl + Shift + i）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-20T23:46:53.017

正如其他人所说。检查来源只会显示网页的原始未经编辑的来源。您需要做的是使用开发人员工具检查 DOM。

我刚刚在 jsfiddle 上检查了 Chrome 的检查器中的所有内容，[并且](http://jsfiddle.net/rXGZa/)该属性和数据肯定都被删除了。

# c# - 为什么读取方法之间图像的像素值不同？

> ID：12522298
> 
> 赞同：1
> 
> 时间：2012-09-20T23:18:35.650
> 
> 标签：c#, image, matlab, image-processing

这让我困惑了过去两个小时。读取图像文件会导致 Matlab 中的 imread 和 C# 中的 Image.FromFile 之间的像素值不同？

```
aa=imread('myfile.tif')

max(aa(:)) = 248 in matlab 
```

在 C# 中

```
var image2Array = imageToByteArray((Bitmap) Image.FromFile("myfile.tif"));
byte maxx = 0;
foreach(var a in image2Array)
{
     maxx = Math.Max(maxx, a);
}
//maxx = 255 
```

此外，在 Matlab 中，

```
aa(1,1) = 13, 
aa(1,2) = 13 
```

但在 C#

```
image2Array[0]=17,  
image2Array[1]=0 
```

他们应该是一样的。

顺便说一句，在这种情况下，像素类型是 uint8。所以没有尺寸差异。

如果你问我是如何从 Image 中得到字节数组的，我使用[MSDN 文档](http://msdn.microsoft.com/en-us/library/5ey6h79d%28v=vs.80%29.aspx)来制作这个方法。

```
 public byte[] imageToByteArray(Bitmap bmp)
    {
        // Lock the bitmap's bits.  
        Rectangle rect = new Rectangle(0, 0, bmp.Width, bmp.Height);
        BitmapData bmpData = bmp.LockBits(
            rect,
            ImageLockMode.ReadWrite,
            bmp.PixelFormat);

        // Get the address of the first line.
        IntPtr ptr = bmpData.Scan0;

        // Declare an array to hold the bytes of the bitmap. 
        int bytes = Math.Abs(bmpData.Stride)*bmp.Height;
        byte[] rgbValues = new byte[bytes];

        // Copy the RGB values into the array.
        System.Runtime.InteropServices.Marshal.Copy(ptr, rgbValues, 0, bytes);
        // Unlock the bits.
        bmp.UnlockBits(bmpData);
        return rgbValues;
    } 
```

我在这里做错了什么？我怀疑他们使用不同的阅读算法，因为两个结果图像看起来相同。

**更新：**

我不认为我所做的有什么问题。我得出的结论是，将 tif 作为位图读取是问题的原因。为了证实这一理论，

1.  我显示了这两个图像，它们看起来完全一样。所以我认为我没有错误。

2.  我尝试用 opencv 读取相同的文件，它的像素值与 matlab 中的完全相同。这让我很意外。从现在开始，我会非常谨慎地在 C# 中使用 Bitmap。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-20T23:26:30.290

您的`imageToByteArray`方法*确实*返回一个字节数组，但您不能假设每个字节都是一个像素。确定`PixelFormat`像素数据如何存储在字节数组中。

我见过的最好的记录这个的网站是[Bob Powell 的 lockbits 页面](https://web.archive.org/web/20141229164101/http://bobpowell.net/lockingbits.aspx)。

如果 PixelFormat 是`Format8bppIndexed`，那么这个（未经测试的）代码应该为您提供每个像素的颜色值。

```
var bmp = (Bitmap)Bitmap.FromFile("myfile.tif");

// ******* Begin copying your imageToByteArray method
// Lock the bitmap's bits.  
Rectangle rect = new Rectangle(0, 0, bmp.Width, bmp.Height);
BitmapData bmpData = bmp.LockBits(
    rect,
    ImageLockMode.ReadWrite,
    bmp.PixelFormat);

// Get the address of the first line.
IntPtr ptr = bmpData.Scan0;

// Declare an array to hold the bytes of the bitmap. 
int bytes = Math.Abs(bmpData.Stride) * bmp.Height;
byte[] imageData = new byte[bytes];

// Copy the RGB values into the array.
System.Runtime.InteropServices.Marshal.Copy(ptr, imageData, 0, bytes);
// Unlock the bits.
bmp.UnlockBits(bmpData);
// ******* End copying your imageToByteArray method

// Now loop through each pixel...  The byte array contains extra bytes
// used for padding so we can't just loop through every byte in the array.
// This is done by using the Stride property on bmpData.
for (int y = 0; y < bmpData.Height; y++)
{
    for (int x = 0; x < bmpData.Width; x++)
    {
        var offset = (y * bmpData.Stride) + x;

        // The byte in the image array gives the offset into the palette
        var paletteIndex = imageData[offset];

        // Given the offset, find the matching color in the palette
        var color = bmp.Palette.Entries[offset];

        // Look at the color value here...
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-21T14:37:34.503

TIFF 有多种格式，您正试图将其作为位图读取。

我建议使用专有的 TIFF 阅读器来阅读它：[Good Tiff library for .NET](https://stackoverflow.com/questions/294391/good-tiff-library-for-net)

# java - isAssignableFrom 不为子类返回 true

> ID：12522299
> 
> 赞同：8
> 
> 时间：2012-09-20T23:18:38.727
> 
> 标签：java, inheritance, subclass

所以我想检查一个类是否可以分配给一个包含许多子类的超类，就像这样

```
public class A { 
    public A(){ }
}

public class B extends A { 
    public B(){ }
}

public class C extends B {
    public C(){ }
}

public static void main() {
    A a = new C();
    boolean whyAmIFalse = a.getClass().isAssignableFrom(B.class);
} 
```

为什么这会返回假？显然它可以分配给B类

```
B b = (B)a 
```

不返回错误，那么为什么返回false。它不是它所描述的功能吗？是否有一个功能可以完成我想要的功能（即我是那个类或它的子类）？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-20T23:33:37.073

如果你想要做的是测试`a`'s 的实际类型是`B`还是子类型，你已经把它倒过来了：它是

```
 B.class.isAssignableFrom(a.getClass()); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-20T23:21:59.880

这是因为`getClass()`返回实际类，而不是变量的声明类——`a.getClass()`将返回类`C`（C.class），这是分配给变量的对象的实际类，`A a`您确实不能将 a 分配`B`给一个`C`

[http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html#getClass()](http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html#getClass%28%29)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-20T23:23:11.857

因为 B 类不扩展/实现 C 类，这是 isAssignableFrom() 测试的。根据您的示例，B 类的实例可能是 C 类的实例。要对此进行测试，请使用“instanceof”。

# android - 如何向 ViewPager 元素添加布局？

> ID：12522301
> 
> 赞同：0
> 
> 时间：2012-09-20T23:18:44.360
> 
> 标签：android, android-layout, android-viewpager

我有几个滑动样式页面，我想设置页面的布局。我怎么做？
我试图跳过添加布局并以语法方式添加视图，在此之前我只是厌倦了直接在可视化应用程序 GUI 编辑器中添加布局和视图。

# python - Python正则表达式匹配多次

> ID：12522305
> 
> 赞同：3
> 
> 时间：2012-09-20T23:19:46.777
> 
> 标签：python, regex

我想作为一个基本的 Python 正则表达式问题。我有一个数据集

```
line = "(1,2) (2,3)" 
```

那可以重复很多次所以线也可以

```
line = "(1,2) (3,4) (6,5)" 
```

我有一个正则表达式

```
rx = "(\(\s*\d+\s*,\s*\d+\s*\)\s*){2,}$" 
```

我想

```
a = re.match(rx,line).groups(); 
```

匹配

```
('(1,2)','(3,4)'...) 
```

但我只能匹配最后一个（6,5）。我需要最后一个 $ 因为我不知道我可以有多少括号输入，否则输入不正确，例如

```
(1,2),(3,4),(5,6 
```

将通过正则表达式。

有小费吗？

编辑：添加了数据未完全格式化为详细的事实。反而

```
line= 'blah(1,2) (2,3)blah' 
```

所以确实需要正则表达式

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-20T23:22:27.900

看哪，**没有**正则表达式的魔力：

```
>>> "(1,2) (3,4) (6,5)".split()
['(1,2)', '(3,4)', '(6,5)'] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-20T23:26:09.037

如果您真的想使用正则表达式（我不是正则表达式专家，但它适用于给定的数据）：

```
r = "[\(\d+,\d+\)]{1,}"
c = re.findall(r,line) 
```

否则请按照nightcracker的出色建议。大多数情况下，最简单的答案是更好的答案。

**编辑**：感谢 Joran Beasley 的建议。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-20T23:22:55.603

尝试使用`re.findall(rx, line)`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-21T07:20:16.003

请注意，Borgleader 的回答导致：

```
>>> re.findall(r'[\(\d+,\d+\)]{1,}', '(1, 2),(2,3)')
['(1,', '2),(2,3)'] 
```

Joran Beasley 对上述案例的回答如下：

```
re.findall(r"(\([^)]*\))", '(1, 2),(2,3)')
['(1, 2)', '(2,3)'] 
```

但是太包容了：

```
>>> re.findall(r"(\([^)]*\))", '(1, blah2),(2,3)')
['(1, blah2)', '(2,3)'] 
```

如果您希望仅包含数字，则：

```
>>> re.findall(r'\(\s*\d+\s*,\s*\d+\s*\)', '(1, 2),(2,3)')
['(1, 2)', '(2,3)']
>>> re.findall(r'\(\s*\d+\s*,\s*\d+\s*\)', '(1, blah2),(2,3)')
['(2,3)']
>>> re.findall(r'\(\s*\d+\s*,\s*\d+\s*\)', '(1, 2),(2,3) (6, 5')
['(1, 2)', '(2,3)'] 
```

如果要删除最终结果中的任何空格：

```
>>> [x.replace(' ', '') for x in re.findall(r'\(\s*\d+\s*,\s*\d+\s*\)', '(1, 2),(2,3) (6, 5')]
['(1,2)', '(2,3)'] 
```

或者如果有标签等：

```
>>> sp = re.compile('\s')
>>> [sp.sub('', x) for x in re.findall(r'\(\s*\d+\s*,\s*\d+\s*\)', '(1, 2),( 2, 3 ) (6, 5')]
['(1,2)', '(2,3)'] 
```

当然，对你的数据集越简单越好。

# php - 用 PHP 编写 Switch 的更好方法？

> ID：12522318
> 
> 赞同：0
> 
> 时间：2012-09-20T23:20:58.787
> 
> 标签：php, switch-statement

我使用下面的这个例子来询问如何将数组传递给 Switch，而不是像这样将它们全部列出？

也许如果我从数据库中为所有“页面”获取一个数组作为页面。

我认为这种方法不是最优雅的方法。

```
switch($_GET['page'])
{
case 'home':
    include('home.php');
    break;
case 'oem-customers':
    include('oem-customers.php');
    break;
case 'job-shop': 
    include('job-shop.php');        
    break;
case 'anodized-magnet-coils':
    include('anodized-magnet-coils.php');
    break;
case 'design':
    include('design.php');
    break;
case 'services':
    include('services.php');
    break;
case 'black-foil':
    include('black-foil.php');
    break;  
case 'contact':
    include('contact.php');
    break;
case 'order';
    include('order.php');
    break;
default: 
    include('home.php');
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-20T23:25:26.030

怎么样

```
switch($_GET['page'])
{
case 'home':
case 'oem-customers':
case 'job-shop': 
case 'anodized-magnet-coils':
case 'design':
case 'services':
case 'black-foil':
case 'contact':
case 'order';
    include("$_GET[page].php");
    break;
default: 
    include('home.php');
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-20T23:25:34.547

带有数组的示例：

```
$pages = array(
    'oem-customers',
    'job-shop',
    'anodized-magnet-coils',
    'design',
    'services',
    'black-foil',
    'contact',
    'order' 
);

if(in_array($_GET['page'], $pages)){
    include($_GET['page'].'.php');
}else{
    include('home.php');
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-20T23:25:59.680

您可以创建映射：

```
$mapping = array(
   'home' => 'home',
   'oem-customers' => 'oem-customers',
   #....
);

$page = $_GET['page'];
$file = isset($mapping[$page]) ? $mapping[$page] : 'home';
include($file.'.php'); 
```

或者首先查找文件，检查文件是否存在，如果需要，可能使用额外的映射。注意：清理输入，用户可以发送`../../etc/whatever`请求。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-20T23:25:26.510

您可以执行以下操作：

```
switch($_GET['page']){
  case 'home':case 'oem-customers':case 'job-shop':case 'anodized-magnet-coils':
  case 'black-foil':case 'services':case 'design':case 'contact':case 'order':
    include($_GET['page'].'.php');
    break;
  default: 
    include('home.php');
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-20T23:27:42.870

好吧，您似乎在 和 页面的文件名之间有一个很好的匹配`$_GET['page']`；一个简单的事情是：

```
 $toInclude = "{$_GET['page']}.php";
   include($toInclude); 
```

当然，你要小心；有人可以通过传入一些不好的东西来欺骗你`page`，比如'../../some_other_project/delete_all_data.php'。所以可以保留您允许的所有页面的验证列表：

```
 $validPages = array('order.php', 'home.php');
   if (!in_array($toInclude, $validPages))
       $toInclude = 'home.php'; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-09-20T23:36:57.387

如果是我，我会将您可以请求的脚本移动到`requests/`文件夹中并执行以下操作：

```
$script = basename( $_GET['page'] );
$dir = 'requests/';
$file = $dir . $script . '.php';
if ( !file_exists( $file ) ) {
  $file = $dir . 'home.php';
}
include( $file ); 
```

1.  比其他任何东西都紧凑得多。
2.  每当您添加新页面时都会自动更新。
3.  在包含之前内置检查文件是否存在。
4.  由于包含`requests/`文件夹和`basename()`.

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-09-20T23:37:53.437

我会建议一种完全不同的方式：

```
$base_path = '/path/to/dir/';
$req = basename($_GET['page'] . '.php');
$page = $base_path . $req;
$file = file_exists($page) ? $page : $base_path . 'home.php'; 
include($file); 
```

# php - 通过联系人 DOB 更新“年龄组 ID” - MySQL + PHP

> ID：12522319
> 
> 赞同：1
> 
> 时间：2012-09-20T23:20:59.990
> 
> 标签：php, mysql, cakephp

我想知道如何解决以下问题的最佳方法：

我有一个名为“联系人”的表，在这个表中我有 2 个字段，contacts.age_group_id 和 contacts.DOB。DOB 字段会定期填写，但 age_group_id 不是，而且它会随着联系人年龄的增长而改变，具体取决于当前日期和他们的 DOB。

age_group 表如下：

age_group.id - int age_group.name - varchar（例如 65-70 岁 - 退休数据库）

样本：

身份证：1-姓名：65-70岁身份证：2-姓名：71-75岁身份证：3-姓名：76-80岁

ETC

如果需要，我可以轻松地将更多字段放入 age_group 表中，但我确实需要不断更新 contact.age_group_id 字段，以便它是导出报告的最新字段。

有什么建议我可以在某种功能中做到这一点吗？

我正在使用 cakephp，但它更像是一个一般的 PHP / MySQL 问题。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T23:34:48.190

我最初的想法是将 min_age 和 max_age 放在 age_group 表中，但这需要您计算用户的年龄，然后将其加入到 age_group 表中。每一行的计算都不是很好（并且不能被索引）。

所以，这里有两个想法：

1.  将每个范围的开始日期和结束日期存储在 agr_group 表中，因此 65 年前（今天）将是 1947 年 9 月 20 日。将其与用户的 DOB 进行比较。好消息是它会很快，但你必须每天重新生成日期。
2.  计算和存储用户的年龄。同样，速度很快，但您每天都必须重新生成更多数据。

哦，第三个想法是等待更好的想法:)

# javascript - 如何修复旧的 javascript 以使用 jQuery Validate 验证国际电话号码？

> ID：12522321
> 
> 赞同：0
> 
> 时间：2012-09-20T23:21:02.410
> 
> 标签：javascript, jquery, regex, jquery-validate

我发现[了一篇博客文章](http://www.24hourapps.com/2009/02/jquery-international-phone-number.html)，其中展示了一种为国际电话号码创建验证的方法。提供的代码是：

```
jQuery.validator.addMethod('intlphone', function(value) { return (value.match(/^((\+)?[1-9]{1,2})?([-\s\.])?((\(\d{1,4}\))|\d{1,4})(([-\s\.])?[0-9]{1,12}){1,2}(\s*(ext|x)\s*\.?:?\s*([0-9]+))?$/)); }, 'Please enter a valid phone number'); 
```

我相信它曾经对我有用，但发生了一些变化——可能是更新版本的 jQuery——我收到了这个错误：

```
Uncaught SyntaxError: Invalid regular expression: /^((+)?[1-9]{1,2})?([-s.])?(((d{1,4}))|d{1,4})(([-s.])?[0-9]{1,12}){1,2}(s*(ext|x)s*.?:?s*([0-9]+))?$/: Nothing to repeat 
```

我用我正在使用的项目创建了一个 JSBin，但我没有任何运气摆脱错误。

如何修复旧的 javascript 以使用 jQuery Validate 验证国际电话号码？

ps：我相信我已经尝试使用以前版本的 jQuery 运行它，但我仍然收到错误消息。我不确定发生了什么变化。

最终使用了这个：

```
jQuery.validator.addMethod('intlphone', function(value) { return (value.match(/^((\+)?[1-9]{1,2})?([\-\s\.])?((\(\d{1,4}\))|\d{1,4})(([\-\s\.])?[0-9]{1,12}){1,2}(\s*(ext|x)\s*\.?:?\s*([0-9]+))?$/)); }, 'Please enter a valid phone number'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T00:22:23.310

如此处所述[用于电话号码验证的全面正则表达式](https://stackoverflow.com/questions/123559/a-comprehensive-regex-for-phone-number-validation)

剥离非数字字符并创建正则表达式以仅匹配数字和扩展名会容易得多。

将此添加到函数的开头以删除除 x 之外的所有非数字： `value.replace("[^\d+x]", "").match`....

# translation - 翻译开放图介词

> ID：12522328
> 
> 赞同：3
> 
> 时间：2012-09-20T23:21:51.453
> 
> 标签：translation, facebook-opengraph

我正在使用 Open Graph 开发一个动作（这仍然是一个初学者）。我来自巴西，所以我的动作和对象都是葡萄牙语。一切正常，但我无法在 facebook 上翻译消息的介词。所以当我点击我网站上的按钮时，facebook上的消息是：

[用户]**在Rockin'Chair****上**观看节目（这意味着用户关注了我网站上的节目）。

 **我需要做的是将介词**a**和**on**更改为葡萄牙语的等价词，但我不知道该怎么做。

谢谢，费利佩**

# django - 如何访问美味派自定义身份验证中的 POST 数据

> ID：12522332
> 
> 赞同：11
> 
> 时间：2012-09-20T23:22:23.153
> 
> 标签：django, tastypie

我正在尝试在美味派中编写自定义身份验证。基本上，我想使用 post 参数进行身份验证，我根本不想使用 django 身份验证，所以我的代码看起来像：

```
class MyAuthentication(Authentication):
   def is_authenticated(self, request, **kwargs):
       if request.method == 'POST':
           token = request.POST['token']
           key = request.POST['key']
           return is_key_valid(token,key) 
```

这或多或少是一个想法。问题是我不断收到以下错误：

```
"error_message": "You cannot access body after reading from request's data stream" 
```

我知道这与我正在访问 POST 的事实有关，但我不知道是否有办法解决它。有任何想法吗？谢谢。

**编辑：**也许我忘了提到最重要的事情。我正在使用在 github 中找到的技巧处理表单数据。我的资源来自多部分资源

```
class MultipartResource(object):
    def deserialize(self, request, data, format=None):
        if not format:
            format = request.META.get('CONTENT_TYPE', 'application/json')

        if format == 'application/x-www-form-urlencoded':
            return request.POST

        if format.startswith('multipart'):
            data = request.POST.copy()
            data.update(request.FILES)
            return data
        return super(MultipartResource, self).deserialize(request, data, format) 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-25T04:54:18.923

问题是`Content-Type`您的请求标头中的设置不正确。[[**参考**](https://github.com/toastdriven/django-tastypie/issues/598)]

Tastypie 仅识别`xml`、`json`和。因此，在发送 POST 请求时，您需要将请求标头设置为其中之一（例如，）。`yaml``bplist``Content-Type``application/json`

**编辑**：

您似乎正在尝试通过 Tastypie 发送包含文件的多部分表单。

Issac Kelly 为路线图 1.0 最终版（尚未发布）提供 Tastypie 文件上传支持的一点背景：

> 1.  实现一个 Base64FileField，它接受用于 PUT/POST 的 base64 编码文件（如问题 #42 中的文件），并为 GET 请求提供 URL。这将是主要的 sweetpie repo 的一部分。
> 2.  我们希望鼓励其他实现作为独立项目来实现。有几种方法可以做到这一点，其中大多数都有些挑剔，并且它们都有不同的缺点，我们希望有其他选择，并记录每种方法的优缺点

这意味着至少目前，Tastypie 还没有正式支持分段文件上传。但是，野外有一些叉子*据说*运行良好，[这](https://github.com/toastdriven/django-tastypie/pull/606)就是其中之一。不过我还没有测试过。

* * *

现在让我尝试解释您遇到该错误的原因。

在 Tastypie[`resource.py`中，第 452 行](https://github.com/toastdriven/django-tastypie/blob/master/tastypie/resources.py#L452)：

```
def dispatch(self, request_type, request, **kwargs):
    """
    Handles the common operations (allowed HTTP method, authentication,
    throttling, method lookup) surrounding most CRUD interactions.
    """
    allowed_methods = getattr(self._meta, "%s_allowed_methods" % request_type, None)

    if 'HTTP_X_HTTP_METHOD_OVERRIDE' in request.META:
        request.method = request.META['HTTP_X_HTTP_METHOD_OVERRIDE']

    request_method = self.method_check(request, allowed=allowed_methods)
    method = getattr(self, "%s_%s" % (request_method, request_type), None)

    if method is None:
        raise ImmediateHttpResponse(response=http.HttpNotImplemented())

    self.is_authenticated(request)
    self.is_authorized(request)
    self.throttle_check(request)

    # All clear. Process the request.
    request = convert_post_to_put(request)
    response = method(request, **kwargs)

    # Add the throttled request.
    self.log_throttled_access(request)

    # If what comes back isn't a ``HttpResponse``, assume that the
    # request was accepted and that some action occurred. This also
    # prevents Django from freaking out.
    if not isinstance(response, HttpResponse):
        return http.HttpNoContent()

    return response 
```

`convert_post_to_put(request)`从这里调用。这[是代码 `convert_post_to_put`](https://github.com/toastdriven/django-tastypie/blob/master/tastypie/resources.py#L2171)：

```
# Based off of ``piston.utils.coerce_put_post``. Similarly BSD-licensed.
# And no, the irony is not lost on me.
def convert_post_to_VERB(request, verb):
    """
    Force Django to process the VERB.
    """
    if request.method == verb:
        if hasattr(request, '_post'):
            del(request._post)
            del(request._files)

        try:
            request.method = "POST"
            request._load_post_and_files()
            request.method = verb
        except AttributeError:
            request.META['REQUEST_METHOD'] = 'POST'
            request._load_post_and_files()
            request.META['REQUEST_METHOD'] = verb
        setattr(request, verb, request.POST)

    return request

def convert_post_to_put(request):
    return convert_post_to_VERB(request, verb='PUT') 
```

而且此方法并不是真正打算处理多部分，因为它具有阻止任何进一步访问的副作用，`request.body`因为 `_load_post_and_files()`方法会将`_read_started`标志设置为`True`：

姜戈[`request.body`](https://github.com/django/django/blob/master/django/http/__init__.py#L290)和[`_load_post_and_files()`](https://github.com/django/django/blob/master/django/http/__init__.py#L312)：

```
@property
def body(self):
    if not hasattr(self, '_body'):
        if self._read_started:
            raise Exception("You cannot access body after reading from request's data stream")
        try:
            self._body = self.read()
        except IOError as e:
            six.reraise(UnreadablePostError, UnreadablePostError(*e.args), sys.exc_info()[2])
        self._stream = BytesIO(self._body)
    return self._body

def read(self, *args, **kwargs):
    self._read_started = True
    return self._stream.read(*args, **kwargs)

def _load_post_and_files(self):
    # Populates self._post and self._files
    if self.method != 'POST':
        self._post, self._files = QueryDict('', encoding=self._encoding), MultiValueDict()
        return
    if self._read_started and not hasattr(self, '_body'):
        self._mark_post_parse_error()
        return

    if self.META.get('CONTENT_TYPE', '').startswith('multipart'):
        if hasattr(self, '_body'):
            # Use already read data
            data = BytesIO(self._body)
        else:
            data = self
        try:
            self._post, self._files = self.parse_file_upload(self.META, data)
        except:
            # An error occured while parsing POST data. Since when
            # formatting the error the request handler might access
            # self.POST, set self._post and self._file to prevent
            # attempts to parse POST data again.
            # Mark that an error occured. This allows self.__repr__ to
            # be explicit about it instead of simply representing an
            # empty POST
            self._mark_post_parse_error()
            raise
    else:
        self._post, self._files = QueryDict(self.body, encoding=self._encoding), MultiValueDict() 
```

因此，您可以（尽管可能不应该） 通过调用 `convert_post_to_VERB()`设置猴子补丁 Tastypie 的方法，然后立即设置，以便 读取并且不会设置 ：`request._body``request.body``_read_started=False``_load_post_and_files()``_body``_read_started=True`

```
def convert_post_to_VERB(request, verb):
    """
    Force Django to process the VERB.
    """
    if request.method == verb:
        if hasattr(request, '_post'):
            del(request._post)
            del(request._files)

        request.body  # now request._body is set
        request._read_started = False  # so it won't cause side effects

        try:
            request.method = "POST"
            request._load_post_and_files()
            request.method = verb
        except AttributeError:
            request.META['REQUEST_METHOD'] = 'POST'
            request._load_post_and_files()
            request.META['REQUEST_METHOD'] = verb
        setattr(request, verb, request.POST)

    return request 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T18:47:41.620

您说您需要自定义身份验证，这很好，但请考虑使用`Authorization`标头。通过使用`POST`强制 Django 解析整个有效负载，假设数据是 urlencoded 或 multipart form 编码的。这实际上使得无法使用 JSON 或 YAML 等非格式有效负载。

```
class MyAuthentication(Authentication):
    def is_authenticated(self, request, **kwargs):
        auth_info = request.META.get('HTTP_AUTHORIZATION')
        # ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T20:22:46.180

当您第二次访问 request.body（或 request.raw_post_data，如果您仍在 Django 1.3 上），或者我相信，如果您在访问 POST、GET、META 或 COOKIES 属性后访问它，则会发生此错误。

Tastypie 在处理 PUT 或 PATCH 请求时会访问 request.body (raw_post_data) 属性。

考虑到这一点，在不知道更多细节的情况下，我会：

*   检查这是否仅发生在 POST/PUT 上。如果是这样，那么您将不得不对一些美味的方法进行一些覆盖，或者放弃您的身份验证方法。
*   在代码中查找访问 request.body (raw_post_data) 的位置
*   查找对可能尝试访问 body/raw_post_data 的第 3 方模块（可能是中间件）的调用

希望这可以帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-12T15:02:29.063

我创建了一个对我很有效的实用方法。虽然我不确定这会如何影响 Django 的底层部分，但它确实有效：

```
import io

def copy_body(request):
    data = getattr(request, '_body', request.body)
    request._body = data
    request._stream = io.BytesIO(data)
    request._files = None
    return data 
```

我在中间件中使用它来添加一个`JSON`属性`request`：[https ://gist.github.com/antonagestam/9add2d69783287025907](https://gist.github.com/antonagestam/9add2d69783287025907)

# php - PHP 联系表单有效，但无法正确配置 AJAX

> ID：12522338
> 
> 赞同：0
> 
> 时间：2012-09-20T23:23:09.720
> 
> 标签：php, ajax, jquery, contact-form

我一直使用此代码将电子邮件从网站的联系方式发送到指定的电子邮件地址：

```
<?php
$contact_name = $_POST['name'];
$contact_email = $_POST['email'];
$contact_subject = $_POST['subject'];
$contact_message = $_POST['message'];

if( $contact_name == true )
{
    $sender = $contact_email;
    $receiver = "siteadminaddress@myaddress.com";
    $client_ip = $_SERVER['REMOTE_ADDR'];
    $email_body = "Nome: $contact_name \nEmail: $sender \n\nOggetto: $contact_subject \n\nMessaggio: \n\n$contact_message \n\nIP: $client_ip \n\n Contact Form Of Website MyWebsite";       
    $extra = "From: $sender\r\n" . "Reply-To: $sender \r\n" . "X-Mailer: PHP/" . phpversion();

    if( mail( $receiver, "My Site Name - $contact_subject", $email_body, $extra ) ) 
    {
        echo "success=yes";
    }
    else
    {
        echo "success=no";
    }
}
?> 
```

现在我必须使用一个使用文件`jquery.jigowatt.js`来处理联系表单消息的模板，并且我必须以与 php 相同的方式配置它，但我不知道那种方式。

文件`jquery.jigowatt.js`：

```
jQuery(document).ready(function(){

    $('#contactform').submit(function(){

        var action = $(this).attr('action');

        $('#submit').attr('disabled','disabled').after('<img src="contact-form/assets/ajax-loader.gif" class="loader" />');

        $("#message").slideUp(750,function() {
        $('#message').hide();

        $.post(action, {
            name: $('#name').val(),
            email: $('#email').val(),
            phone: $('#phone').val(),
            comments: $('#comments').val(),
            verify: $('#verify').val()
        },
            function(data){
                document.getElementById('message').innerHTML = data;
                $('#message').slideDown('slow');
                $('#contactform img.loader').fadeOut('fast',function(){$(this).remove()});
                $('#submit').removeAttr('disabled');
                if(data.match('success') != null) $('#contactform').slideUp('slow');

                // 2 functions added by Themes
                if(data.match('success') != null) $("html,body").animate({
                    scrollTop: $("#message").offset().top
                    }, 1000, function(){
                        //scroll complete function
                    });
                if(data.match('success') == null) $("html,body").animate({
                    scrollTop: $("#message").offset().top
                    }, 1000, function(){
                        //scroll complete function
                    });

            }
        );

        });

        return false;

    });

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T23:43:15.250

您可以保留您的 php 文件并通过 jquery.jigowatt.js 中的 Ajax 将数据发送给它。我没有对此进行测试，但它应该给你这个想法。您只需要在 url: 部分的 AJAX 提交中添加 php 文件的路径。

```
jQuery(document).ready(function(){
    $('#contactform').submit(function(){
    var action = $(this).attr('action');
    $('#submit').attr('disabled','disabled').after('<img src="contact-form/assets/ajax-loader.gif" class="loader" />');
    $("#message").slideUp(750,function() {
    $('#message').hide();      
    $.ajax({
        type:"POST",
        url: "yourPhpFileURL.php",   //put the url of your php file here
        data: $('#contactform').serialize(),
        success: function(data){
            document.getElementById('message').innerHTML = data;
            $('#message').slideDown('slow');
            $('#contactform img.loader').fadeOut('fast',function(){$(this).remove()});
            $('#submit').removeAttr('disabled');
            if(data.match('success') != null) $('#contactform').slideUp('slow');

            // 2 functions added by TrueThemes
            if(data.match('success') != null) $("html,body").animate({
                scrollTop: $("#message").offset().top
                }, 1000, function(){
                    //scroll complete function
                });
            if(data.match('success') == null) $("html,body").animate({
                scrollTop: $("#message").offset().top
                }, 1000, function(){
                    //scroll complete function
                });                     
        }
        });

    });

    return false;

});

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T23:43:42.787

您可以改用 jQuery Ajax 表单插件：

[http://www.malsup.com/jquery/form/](http://www.malsup.com/jquery/form/)

```
$('#myForm').ajaxForm(function() { 
    alert("Thank you for your comment!"); 
}); 
```

它应该可以为您节省大量工作。

# regex - 查找仅匹配同一字符的两个实例的单词

> ID：12522342
> 
> 赞同：0
> 
> 时间：2012-09-20T23:23:44.650
> 
> 标签：regex, linux, unix

寻找一个匹配仅包含 2 个相同字符实例的单词的正则表达式。

因此，假设您正在寻找只有 2 个字符 's' 实例的单词。

> 测试测试 Sam 助手通过 lessclose 会话

所以从上面它应该只选择“测试”和“通过”，因为它是唯一有两个“s”实例的词

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T23:41:25.550

```
#!/bin/bash
regex='^[^sS]*[sS][^sS]*[sS][^sS]*$'
for word in Test Tests Sam assistant pass
do
  if [[ $word =~ $regex ]]; then
    echo $word
  fi
done; 
```

这会查找由零个或多个不是“s”或“S”的字符分隔的 2 个“s”或“S”字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T01:06:25.860

**一种使用方式`GNU awk`：**

如果您只搜索两个小写的 's' 字符：

```
awk '{ for (i=1; i<=NF; i++) if (gsub(/s/,"s",$i) == 2) print $i }' file.txt 
```

如果您想忽略大小写的“s”字符（即匹配“s”或“S”），请尝试：

```
awk '{ for (i=1; i<=NF; i++) { s_count = gsub(/s/,"s",$i); S_count = gsub(/S/,"S",$i); if (s_count + S_count == 2) print $i } }' file.txt 
```

结果：

```
Tests
pass 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-21T07:15:16.280

将要求视为不区分大小写

采用：

```
echo "Test Tests Sams assistant pass lessclose session" | tr " " "\n" | awk '{FS="[sS]"} {if (NF==3) {print}}' 
```

输出：

```
Tests
Sams
pass 
```

否则使用：

```
echo "Test Tests Sams assistant pass lessclose session" | tr " " "\n" | awk '{FS="[s]"} {if (NF==3) {print}}' 
```

输出：

```
Tests
pass 
```

# database - 如何将数据存储在数据库中以用于多种用途

> ID：12522344
> 
> 赞同：0
> 
> 时间：2012-09-20T23:24:11.597
> 
> 标签：database, web

我试图获得一些将文本存储在数据库中的想法。此数据将在网页上使用，但也将用于与网页外的其他用户共享。在某些情况下，我想为网页使用斜体或粗体文本、分成段落等。我还将允许其他人访问数据库以将这些信息提取到他们自己的应用程序中，可能是网页、另一个数据库、vb 应用程序等。最好的方法是什么，并且没有可能的格式不受客户程序支持？我读了一些帖子，他们建议将数据存储为 XML，然后如果我不需要它，我可以将其删除。我不是那么先进，所以似乎很难。我欢迎所有的建议......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T23:29:30.130

避免将渲染数据存储在数据库中 - 仅以最原始的形式存储数据。让数据的用户决定如何格式化。也许，如果格式化是数据的*一部分*（即您正在存储“文档”），您可以将其存储为标记/降价（@pst 的好点）。

另一种看待它的方法是存储数据*而不假设它的用途*。这样，它最容易维护和用于您的初始用途，以及将来的更多用途。

# php - 从列中选择有限的数据

> ID：12522346
> 
> 赞同：0
> 
> 时间：2012-09-20T23:24:20.363
> 
> 标签：php, mysql

我需要从一列中选择有限数量的字符。我试过了 ：

```
SELECT substring_index(COLUMN_NAME, 250); 
```

但是列名将被识别为普通文本字符串。

示例：我有“描述”列，我想检索描述的前 250 个字符以放入 php 变量中。

它在使用子字符串而不是 substring_index 时有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T00:32:11.870

随着海报的更多澄清，将答案放在这里，以防他/她选择接受它。

```
substring(description,1,250) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T01:28:41.583

您是否只需要在子字符串函数调用之后添加“AS 描述”，以便在您的 PHP 结果数组中将该列重命名为仅描述？

# java - 如何使 Android ListView 中的单元格在被触 摸时垂直扩展和收缩？

> ID：12522348
> 
> 赞同：15
> 
> 时间：2012-09-20T23:24:41.907
> 
> 标签：java, android, eclipse, android-listview

我在 ListView 中有一个单元格，其中包含一堆文本。我显示前两行文本，如果超出，则以“...”结尾。我希望用户能够触摸单元格并让它在视图中动态扩展，显示所有数据。然后当他们再次接触细胞时，它会收缩回正常大小。

我见过一个 iOS 应用程序这样做，它非常酷。有没有办法用Android做到这一点？如何？

![关闭](../Images/aef87ed300f7e85f232eda7955cdeef7.png)

![打开](../Images/eb969a48130fd5397c508ed13d11e3df.png)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-03-04T00:59:34.690

我已经实现了一个适用于所有 Android sdk 版本的简单代码。

请参阅下面的工作和代码。

Github 代码：[https ://github.com/LeonardoCardoso/Animated-Expanding-ListView](https://github.com/LeonardoCardoso/Animated-Expanding-ListView)

有关我网站的信息：[http ://android.leocardz.com/animated-expanding-listview/](http://android.leocardz.com/animated-expanding-listview/)

![普通的](../Images/2b140bad1752654bd487eb15ba4dea90.png) ![手风琴](../Images/b16fcdebb567d2b46b20e79f14aab86e.png)

基本上，您必须创建一个自定义 TranslateAnimation 和一个自定义列表适配器，并且在动画时，您必须更新列表视图项的当前高度并通知适配器此更改。

让我们看一下代码。

1.  列表项布局

    ```
    <?xml version="1.0" encoding="utf-8"?>
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
           android:id="@+id/text_wrap"
           android:layout_width="match_parent"
           android:layout_height="wrap_content"
           android:orientation="horizontal"
           android:paddingBottom="@dimen/activity_vertical_margin"
           android:paddingLeft="@dimen/activity_horizontal_margin"
           android:paddingRight="@dimen/activity_horizontal_margin"
           android:paddingTop="@dimen/activity_vertical_margin" >

           <TextView
               android:id="@+id/text"
               android:layout_width="match_parent"
               android:layout_height="wrap_content"
               android:textSize="18sp" >
           </TextView>

    </LinearLayout> 
    ```

2.  活动布局

    ```
     <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
              xmlns:tools="http://schemas.android.com/tools"
              android:layout_width="match_parent"
              android:layout_height="match_parent"
              tools:context=".MainActivity" >

              <ListView
                  android:id="@+id/list"
                  android:layout_width="match_parent"
                  android:layout_height="wrap_content"
                  android:divider="@android:color/black"
                  android:dividerHeight="3dp" >
              </ListView>

          </RelativeLayout> 
    ```

3.  列表项类

    ```
    public class ListItem {

    private String text;
    private int collapsedHeight, currentHeight, expandedHeight;
    private boolean isOpen;
    private ListViewHolder holder;
    private int drawable;

    public ListItem(String text, int collapsedHeight, int currentHeight,
            int expandedHeight) {
        super();
        this.text = text;
        this.collapsedHeight = collapsedHeight;
        this.currentHeight = currentHeight;
        this.expandedHeight = expandedHeight;
        this.isOpen = false;
        this.drawable = R.drawable.down;
    }

    public String getText() {
        return text;
    }

    public void setText(String text) {
        this.text = text;
    }

    public int getCollapsedHeight() {
        return collapsedHeight;
    }

    public void setCollapsedHeight(int collapsedHeight) {
        this.collapsedHeight = collapsedHeight;
    }

    public int getCurrentHeight() {
        return currentHeight;
    }

    public void setCurrentHeight(int currentHeight) {
        this.currentHeight = currentHeight;
    }

    public int getExpandedHeight() {
        return expandedHeight;
    }

    public void setExpandedHeight(int expandedHeight) {
        this.expandedHeight = expandedHeight;
    }

    public boolean isOpen() {
        return isOpen;
    }

    public void setOpen(boolean isOpen) {
        this.isOpen = isOpen;
    }

    public ListViewHolder getHolder() {
        return holder;
    }

    public void setHolder(ListViewHolder holder) {
        this.holder = holder;
    }

    public int getDrawable() {
        return drawable;
    }

    public void setDrawable(int drawable) {
        this.drawable = drawable;
    }
    } 
    ```

4.  查看持有人类

    ```
    public class ListViewHolder {
     private LinearLayout textViewWrap;
     private TextView textView;

     public ListViewHolder(LinearLayout textViewWrap, TextView textView) {
        super();
        this.textViewWrap = textViewWrap;
        this.textView = textView;
     }

     public TextView getTextView() {
            return textView;
     }

     public void setTextView(TextView textView) {
        this.textView = textView;
     }

     public LinearLayout getTextViewWrap() {
        return textViewWrap;
     }

     public void setTextViewWrap(LinearLayout textViewWrap) {
        this.textViewWrap = textViewWrap;
     }
    } 
    ```

5.  自定义动画类

    ```
     public class ResizeAnimation extends Animation {
        private View mView;
        private float mToHeight;
        private float mFromHeight;

        private float mToWidth;
        private float mFromWidth;

        private ListAdapter mListAdapter;
        private ListItem mListItem;

        public ResizeAnimation(ListAdapter listAdapter, ListItem listItem,
                float fromWidth, float fromHeight, float toWidth, float toHeight) {
            mToHeight = toHeight;
            mToWidth = toWidth;
            mFromHeight = fromHeight;
            mFromWidth = fromWidth;
            mView = listItem.getHolder().getTextViewWrap();
            mListAdapter = listAdapter;
            mListItem = listItem;
            setDuration(200);
        }

        @Override
        protected void applyTransformation(float interpolatedTime, Transformation t) {
            float height = (mToHeight - mFromHeight) * interpolatedTime
                    + mFromHeight;
            float width = (mToWidth - mFromWidth) * interpolatedTime + mFromWidth;
            LayoutParams p = (LayoutParams) mView.getLayoutParams();
            p.height = (int) height;
            p.width = (int) width;
            mListItem.setCurrentHeight(p.height);
            mListAdapter.notifyDataSetChanged();
        }
      } 
    ```

6.  自定义列表适配器类

    ```
    public class ListAdapter extends ArrayAdapter<ListItem> {
    private ArrayList<ListItem> listItems;
    private Context context;

    public ListAdapter(Context context, int textViewResourceId,
        ArrayList<ListItem> listItems) {
    super(context, textViewResourceId, listItems);
    this.listItems = listItems;
    this.context = context;
    }

    @Override
    @SuppressWarnings("deprecation")
    public View getView(int position, View convertView, ViewGroup parent) {
    ListViewHolder holder = null;
    ListItem listItem = listItems.get(position);

    if (convertView == null) {
        LayoutInflater vi = (LayoutInflater) context
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        convertView = vi.inflate(R.layout.list_item, null);

        LinearLayout textViewWrap = (LinearLayout) convertView
                .findViewById(R.id.text_wrap);
        TextView text = (TextView) convertView.findViewById(R.id.text);

        holder = new ListViewHolder(textViewWrap, text);
    } else
        holder = (ListViewHolder) convertView.getTag();

    holder.getTextView().setText(listItem.getText());

    LayoutParams layoutParams = new LayoutParams(LayoutParams.FILL_PARENT,
            listItem.getCurrentHeight());
    holder.getTextViewWrap().setLayoutParams(layoutParams);

    holder.getTextView().setCompoundDrawablesWithIntrinsicBounds(
            listItem.getDrawable(), 0, 0, 0);

    convertView.setTag(holder);

    listItem.setHolder(holder);

    return convertView;
    }

    } 
    ```

7.  主要活动

    ```
    public class MainActivity extends Activity {

    private ListView listView;
    private ArrayList<ListItem> listItems;
    private ListAdapter adapter;

    private final int COLLAPSED_HEIGHT_1 = 150, COLLAPSED_HEIGHT_2 = 200,
        COLLAPSED_HEIGHT_3 = 250;

    private final int EXPANDED_HEIGHT_1 = 250, EXPANDED_HEIGHT_2 = 300,
        EXPANDED_HEIGHT_3 = 350, EXPANDED_HEIGHT_4 = 400;

    private boolean accordion = true;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    listView = (ListView) findViewById(R.id.list);

    listItems = new ArrayList<ListItem>();
    mockItems();

    adapter = new ListAdapter(this, R.layout.list_item, listItems);

    listView.setAdapter(adapter);

    listView.setOnItemClickListener(new OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {
            toggle(view, position);
        }
    });
    }

    private void toggle(View view, final int position) {
    ListItem listItem = listItems.get(position);
    listItem.getHolder().setTextViewWrap((LinearLayout) view);

    int fromHeight = 0;
    int toHeight = 0;

    if (listItem.isOpen()) {
        fromHeight = listItem.getExpandedHeight();
        toHeight = listItem.getCollapsedHeight();
    } else {
        fromHeight = listItem.getCollapsedHeight();
        toHeight = listItem.getExpandedHeight();

        // This closes all item before the selected one opens
        if (accordion) {
            closeAll();
        }
    }

    toggleAnimation(listItem, position, fromHeight, toHeight, true);
    }

    private void closeAll() {
    int i = 0;
    for (ListItem listItem : listItems) {
        if (listItem.isOpen()) {
            toggleAnimation(listItem, i, listItem.getExpandedHeight(),
                    listItem.getCollapsedHeight(), false);
        }
        i++;
    }
    }

    private void toggleAnimation(final ListItem listItem, final int position,
        final int fromHeight, final int toHeight, final boolean goToItem) {

    ResizeAnimation resizeAnimation = new ResizeAnimation(adapter,
            listItem, 0, fromHeight, 0, toHeight);
    resizeAnimation.setAnimationListener(new AnimationListener() {

        @Override
        public void onAnimationStart(Animation animation) {
        }

        @Override
        public void onAnimationRepeat(Animation animation) {
        }

        @Override
        public void onAnimationEnd(Animation animation) {
            listItem.setOpen(!listItem.isOpen());
            listItem.setDrawable(listItem.isOpen() ? R.drawable.up
                    : R.drawable.down);
            listItem.setCurrentHeight(toHeight);
            adapter.notifyDataSetChanged();

            if (goToItem)
                goToItem(position);
        }
    });

    listItem.getHolder().getTextViewWrap().startAnimation(resizeAnimation);
    }

    private void goToItem(final int position) {
    listView.post(new Runnable() {
        @Override
        public void run() {
            try {
                listView.smoothScrollToPosition(position);
            } catch (Exception e) {
                listView.setSelection(position);
            }
        }
    });
    }

    private void mockItems() {
    listItems
            .add(new ListItem(
                    "Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.",
                    COLLAPSED_HEIGHT_1, COLLAPSED_HEIGHT_1,
                    EXPANDED_HEIGHT_1));

    listItems
            .add(new ListItem(
                    "Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.",
                    COLLAPSED_HEIGHT_2, COLLAPSED_HEIGHT_2,
                    EXPANDED_HEIGHT_2));

    listItems
            .add(new ListItem(
                    "Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",
                    COLLAPSED_HEIGHT_3, COLLAPSED_HEIGHT_3,
                    EXPANDED_HEIGHT_3));

    listItems
            .add(new ListItem(
                    "Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo.",
                    COLLAPSED_HEIGHT_2, COLLAPSED_HEIGHT_2,
                    EXPANDED_HEIGHT_4));

    listItems
            .add(new ListItem(
                    "At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis praesentium voluptatum deleniti atque corrupti quos dolores et quas molestias excepturi sint occaecati cupiditate non provident, similique sunt in culpa qui officia deserunt mollitia animi, id est laborum et dolorum fuga.",
                    COLLAPSED_HEIGHT_1, COLLAPSED_HEIGHT_1,
                    EXPANDED_HEIGHT_4));

    listItems
            .add(new ListItem(
                    "Et harum quidem rerum facilis est et expedita distinctio. Nam libero tempore, cum soluta nobis est eligendi optio cumque nihil impedit quo minus id quod maxime placeat facere possimus, omnis voluptas assumenda est, omnis dolor repellendus.",
                    COLLAPSED_HEIGHT_2, COLLAPSED_HEIGHT_2,
                    EXPANDED_HEIGHT_4));

    listItems
            .add(new ListItem(
                    "Temporibus autem quibusdam et aut officiis debitis aut rerum necessitatibus saepe eveniet ut et voluptates repudiandae sint et molestiae non recusandae.",
                    COLLAPSED_HEIGHT_3, COLLAPSED_HEIGHT_3,
                    EXPANDED_HEIGHT_3));

    listItems
            .add(new ListItem(
                    "Itaque earum rerum hic tenetur a sapiente delectus, ut aut reiciendis voluptatibus maiores alias consequatur aut perferendis doloribus asperiores repellat.",
                    COLLAPSED_HEIGHT_1, COLLAPSED_HEIGHT_1,
                    EXPANDED_HEIGHT_4));

        }

    } 
    ```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-22T02:03:13.130

这是乌迪尼奇的例子。它的 listview 项目通过动画展开，并且只需要 API 级别 4+

[展开动画示例](https://github.com/Udinic/SmallExamples/tree/master/ExpandAnimationExample)

在 onItemClick 事件中使用 ExpandAnimation

```
/**
* This animation class is animating the expanding and reducing the size of a view.
* The animation toggles between the Expand and Reduce, depending on the current state of the view
* @author Udinic
*
*/
public class ExpandAnimation extends Animation {
    private View mAnimatedView;
    private LayoutParams mViewLayoutParams;
    private int mMarginStart, mMarginEnd;
    private boolean mIsVisibleAfter = false;
    private boolean mWasEndedAlready = false;

    /**
* Initialize the animation
* @param view The layout we want to animate
* @param duration The duration of the animation, in ms
*/
    public ExpandAnimation(View view, int duration) {

        setDuration(duration);
        mAnimatedView = view;
        mViewLayoutParams = (LayoutParams) view.getLayoutParams();

        // decide to show or hide the view
        mIsVisibleAfter = (view.getVisibility() == View.VISIBLE);

        mMarginStart = mViewLayoutParams.bottomMargin;
        mMarginEnd = (mMarginStart == 0 ? (0- view.getHeight()) : 0);

        view.setVisibility(View.VISIBLE);
    }

    @Override
    protected void applyTransformation(float interpolatedTime, Transformation t) {
        super.applyTransformation(interpolatedTime, t);

        if (interpolatedTime < 1.0f) {

            // Calculating the new bottom margin, and setting it
            mViewLayoutParams.bottomMargin = mMarginStart
                    + (int) ((mMarginEnd - mMarginStart) * interpolatedTime);

            // Invalidating the layout, making us seeing the changes we made
            mAnimatedView.requestLayout();

        // Making sure we didn't run the ending before (it happens!)
        } else if (!mWasEndedAlready) {
            mViewLayoutParams.bottomMargin = mMarginEnd;
            mAnimatedView.requestLayout();

            if (mIsVisibleAfter) {
                mAnimatedView.setVisibility(View.GONE);
            }
            mWasEndedAlready = true;
        }
    }
} 
```

详细用法在项目中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-20T23:35:00.420

SDK中有一个示例，它可以帮助您。

显然，它被称为`ExpandableList`. 位于 API Demos (/docs/resources/samples/ApiDemos/src/com/example/android/apis/view)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-20T23:36:15.537

这是我会做的一个选项：

向您的 ListView 的 BaseAdapter 添加一条 if 语句，该语句将在您的 ListView 中查询当前选定的项目。如果您正在绘制的当前项目（在您的 BaseAdapter 中）是选定项目的位置，则改为创建扩展视图。然后恢复正常的视图创建。

编辑：

假设您希望一次扩展一 (1) 个项目，而不是整个列表，我将其作为一个选项。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-20T23:48:05.580

我从未使用过 ExpandableListViews，但我认为“手动”实现它非常简单。扩展一个 ArrayAdapter，我们可以根据需要操作行布局。因此，创建您的扩展适配器和两个 onClickListener，一个用于扩展，一个用于收缩。我把整个班级都贴在这里了。

如果您不希望某些项目可扩展，只需根据您的需要调整侦听器。如果你想让它看起来更好，你可以添加一些滑动动画，但是从这里你应该有足够的时间来做你需要的任何事情！

```
public class ExtendedAdapter extends BaseAdapter {

public static final String TAG = "TodoAdapter";

private Context mContext;
private int layoutResource; 
private List<String> items; 

private OnClickListener expand;
private OnClickListener contract;
public ExtendedAdapter(Context context, int textViewResourceId,
        List<String> items) {
    this.items = items;
    this.mContext = context;
    this.layoutResource = textViewResourceId;

    expand = new OnClickListener() {

        @Override
        public void onClick(View v) {
            TextView tv = (TextView) v;
            String[] textSplited = tv.getText().toString().split(" "); // somehow split your text
            tv.setMaxLines(textSplited.length);
            StringBuilder sb = new StringBuilder();
            for (String word : textSplited)
                sb.append(word + "\n");
            tv.setText(sb.toString());
            tv.setOnClickListener(contract);
        }
    };

    contract = new OnClickListener() {

        @Override
        public void onClick(View v) {
            TextView tv = (TextView) v;
            tv.setMaxLines(1);
            String[] textSplitted = tv.getText().toString().split("\n");
            StringBuilder sb = new StringBuilder();
                for (String word : textSplitted)
                    sb.append(word + " ");
            tv.setText(sb.toString());
            tv.setOnClickListener(expand);
        }
    };

}

public int getCount() {
    return items.size();
}

public Object getItem(int position) {
    return position;
}

public long getItemId(int position) {
    return position;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    View v = convertView;
    if (v == null) {
        LayoutInflater vi = (LayoutInflater) mContext
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        v = vi.inflate(layoutResource, null);
    }           
    TextView text = (TextView) v.findViewById(R.id.extended_text);
    text.setText(items.get(position));
    text.setOnClickListener(expand);
    return v;
}
} 
```

和 row_layout.xml

```
<?xml version="1.0" encoding="utf-8"?>

<LinearLayout
     xmlns:android="http://schemas.android.com/apk/res/android"
     android:paddingTop="4dip"
     android:paddingBottom="6dip"
     android:layout_width="fill_parent"
     android:layout_height="wrap_content"
     android:orientation="horizontal"
     android:textSize="13sp">

     <TextView android:id="@+id/extended_text"
         android:layout_width="275dip"
         android:layout_height="wrap_content"
         android:maxLines="1"
         android:ellipsize="end"/>

</LinearLayout> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-21T00:17:03.403

您想要做的是有一个标志，知道该行是否扩展。如果是，则运行一个缩小它的[动画](http://developer.android.com/guide/topics/graphics/view-animation.html)，反之亦然。

```
public void onListItemClicked(int position)
{
    View v = listView.getView(position);
    if(expanded[position])
      v.startAnimation(shrinkAnimation);
    else
      v.startAnimation(growAnimation);  
    expanded[position] = !expanded[position];
} 
```

简单的。

*但是*，如果您正在执行的操作与您实现的屏幕截图类似，我建议您不要使用 ListView 执行此操作。这些视图各不相同，足以保证只需手动使用`LinearLayouts`. 仅当行数未知或非常大时才使用 ListView。

# mongodb - mongodb - 副本集中的所有节点都是主节点

> ID：12522349
> 
> 赞同：1
> 
> 时间：2012-09-20T23:24:44.713
> 
> 标签：mongodb

我正在尝试配置具有两个节点的副本集，但是当我执行时`rs.add("node2")`，`rs.status()`两个节点都设置为 PRIMARY。此外，当我`rs.status()`在另一个节点上运行时，唯一出现的节点是本地节点。

编辑1： `rs.status()`输出：

```
 {
        "set" : "rs0",
        "date" : ISODate("2012-09-22T01:01:12Z"),
        "myState" : 1,
        "members" : [
                {
                        "_id" : 0,
                        "name" : "node1:27017",
                        "health" : 1,
                        "state" : 1,
                        "stateStr" : "PRIMARY",
                        "uptime" : 70968,
                        "optime" : Timestamp(1348207012000, 1),
                        "optimeDate" : ISODate("2012-09-21T05:56:52Z"),
                        "self" : true
                },
                {
                        "_id" : 1,
                        "name" : "node2:27017",
                        "health" : 1,
                        "state" : 1,
                        "stateStr" : "PRIMARY",
                        "uptime" : 68660,
                        "optime" : Timestamp(1348205568000, 1),
                        "optimeDate" : ISODate("2012-09-21T05:32:48Z"),
                        "lastHeartbeat" : ISODate("2012-09-22T01:01:11Z"),
                        "pingMs" : 0
                }
        ],
        "ok" : 1
} 
```

Edit2：我尝试用 3 个不同的节点做同样的事情，我得到了相同的结果（`rs.status()`说我有一个包含三个主节点的副本集）。这个问题可能是由网络的某些特定配置引起的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-11T19:51:38.050

上面的答案没有回答如何解决它。我通过反复试验完成了它。

我已经清理了数据目录（如 中`rm -rf *`）并重新启动了这些 PRIMARY 节点，除了一个。我把它们加回来了。它似乎工作。

**Edit1**
下面的小技巧似乎对我不起作用，

* * *

所以，我使用登录`mongod`控制台`mongo <hostname>:27018`

这是外壳的样子：

```
rs2:PRIMARY> rs.conf()
{
    "_id" : "rs2",
    "version" : 1,
    "members" : [
        {
            "_id" : 0,
            "host" : "ip-10-159-42-911:27018"
        }
    ]
} 
```

我决定把它改成次要的。所以，

```
rs2:PRIMARY> var c = {
...   "_id" : "rs2",
...   "version" : 1,
...   "members" : [
...     {
...       "_id" : 1,
...       "host" : "ip-10-159-42-911:27018",
...       "priority": 0.5
...     }
...   ]
... }

rs2:PRIMARY> rs.reconfig(c, { "force": true})
Mon Nov 11 19:46:39.244 DBClientCursor::init call() failed
Mon Nov 11 19:46:39.245 trying reconnect to ip-10-159-42-911:27018
Mon Nov 11 19:46:39.245 reconnect ip-10-159-42-911:27018 ok
reconnected to server after rs command (which is normal)

rs2:SECONDARY> 
```

现在是次要的。不知道有没有更好的办法。但这似乎有效。

高温高压

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T03:20:56.680

如果您`rs.initiate()`之前从副本集的两个成员发出，`rs.add()`那么两者都将成为主要成员。

您应该只`rs.initiate()`在副本集的一个成员上使用，即您最初打算成为主要成员的那个。然后您可以`rs.add()`将其他成员添加到副本集。

# php - 通过表单重定向而不给出错误

> ID：12522353
> 
> 赞同：1
> 
> 时间：2012-09-20T23:24:49.080
> 
> 标签：php, javascript, ajax

我正在尝试将访问者发送到[http://www.facebook.com/plugins/comments.php?href=http://google.com?c](http://www.facebook.com/plugins/comments.php?href=http://google.com?c)

一直报错评论插件需要一个href参数。

```
<script>
function go(){
    var uri = 'http://www.facebook.com/plugins/comments.php?href=' 
        + encodeURIComponent('http://google.com?c');

    window.frames[0].document.body.innerHTML = 
        '<form target="_parent" action="' 
        + uri 
        + '"></form>';
    window.frames[0].document.forms[0].submit();
}    
</script>
<iframe onload="window.setTimeout('go()', 99)" src="about:blank" style="visibility:hidden"></iframe> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T23:39:06.130

这里的问题是默认情况下，`form`元素使用 提交`GET`，因此您在`action`属性中的任何参数都将被删除。

修复很简单：`method="post"`

```
'<form target="_parent" method="post" action="' + uri + '"></form>' 
```

工作演示：http: *[//jsfiddle.net/MkBAP/](http://jsfiddle.net/MkBAP/)*

# java - 检测窗口事件

> ID：12522354
> 
> 赞同：0
> 
> 时间：2012-09-20T23:24:49.530
> 
> 标签：java

有人能告诉我下面的代码有什么问题吗，我在第一行遇到语法错误。

```
 WindowEvent winClosingEvent = new WindowEvent(this,WindowEvent.WINDOW_CLOSING);
    Toolkit.getDefaultToolkit().getSystemEventQueue().postEvent(winClosingEvent); 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-20T23:30:16.510

这里发生了两个可能的问题之一。

1）您尚未导入`java.awt.event.WindowEvent`，因此编译器无法找到该类。

2）您的`this`引用不指向`java.awt.Window`.

# java - 如何在java中读取xml标签

> ID：12522355
> 
> 赞同：0
> 
> 时间：2012-09-20T23:24:58.303
> 
> 标签：java, xml

嗨，我有一个如下所示的 xml

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<A>
    <B>
        <X1>
            <Name>ZZZsaqw</Name>
        </X1>
        <X1>
            <Name>ZZZsdasda</Name>
        </X1>
        <X1>
            <Name>ZZZsdsd</Name>
        </X1>
        <S>17000</S>
        <U>18000</U>
        <V>17000</V>
    <B>
    <C>
        <X1>
            <Name>ZZZasqw</Name>
        </X1>
        <X1>
            <Name>ZZZsdsd</Name>
        </X1>
        <X1>
            <Name>ZZ</Name>
        </X1>
        <S>17000</S>
        <U>18000</U>
        <V>17000</V>
    <C>
    <D>
        <X1>
            <Name>ZZZx</Name>
        </X1>
        <X1>
            <Name>ZZZzz</Name>
        </X1>
        <X1>
            <Name>ZZZsaa</Name>
        </X1>
        <S>17000</S>
        <U>18000</U>
        <V>17000</V>
    </D>
<A> 
```

我对 X1 标签感兴趣。我需要阅读它们各自的父标签，它们可以是 B、C 或 D。所以有时我只对属于 B 有时属于 C 的 X1 标签感兴趣。如何做到这一点？我使用了下面显示的 DOM 解析器，但是当我计算它们时，它显示计数为 9，而应该是 3。请帮助我怎么做。

```
 NodeList plist = doc.getElementsByTagName("A");
        System.out.println("The length of A is pList is:"+plist.getLength());
        //get the contents of the A
        for (int temp = 0; temp < plist.getLength(); temp++)
        {
            Node nNode = plist.item(temp);
            if (nNode.getNodeType() == Node.ELEMENT_NODE)
            {
                //Element eElement = (Element) nNode;

                NodeList typicalCriticalPath = doc.getElementsByTagName("B");
                System.out.println("The length of B is:"+typicalCriticalPath.getLength());

                //get the contents of the typical critical path
                for(int temp1 = 0; temp1<typicalCriticalPath.getLength();temp1++)
                {
                    Node typCriticalPathNode = typicalCriticalPath.item(temp);
                    if (typCriticalPathNode.getNodeType() == Node.ELEMENT_NODE)
                    {
                        Element ele = (Element) typCriticalPathNode;
                        NodeList planItemSection = doc.getElementsByTagName("X1");
                        System.out.println("The length of X1 is:"+planItemSection.getLength());
                    }

                }

            }
        }
 //The output for this is like this-
 //The length of A is pList is:1
 //The length of B is:1
 //The length of X1 is:9 
```

有人可以指出我哪里出错了吗？要做什么才能让我只能获得父标签的标签。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-20T23:28:27.723

> NodeList planItemSection = doc.getElementsByTagName("X1");

这将是文档中的所有 X1。

我想你想要

> NodeList planItemSection = ele.getElementsByTagName("X1");

,`ele`父元素在哪里。

您可能还想查看 XPath 以获取此类查询。

# php - 加载 Zend 2 身份验证适配器

> ID：12522356
> 
> 赞同：1
> 
> 时间：2012-09-20T23:25:11.003
> 
> 标签：php, zend-framework2

我正在 Zend Framework 2 中编写自定义身份验证适配器。

模块/Application/src/Application/Auth/Adapter/Auth_Adapter.php -

```
namespace Application\Auth;

use Zend\Authentication\Adapter\AdapterInterface;
use Zend\Authentication\Result;

class Auth_Adapter implements AdapterInterface {
... 
```

不知道我做错了什么，但似乎没有类可以找到我的新适配器。我已经尝试将它移动到自动加载的路径（应用程序/控制器目录）中，但也没有运气。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T23:53:47.307

我假设您的命名空间无效。给定路径“module/Application/src/Application/Auth/Adapter/Auth_Adapter.php”

尝试：

```
namespace Application\Auth\Adapter; 
```

# java - 如何在java中使用grow方法

> ID：12522365
> 
> 赞同：0
> 
> 时间：2012-09-20T23:26:00.987
> 
> 标签：java, methods

使用该`grow()`方法将矩形修改为两倍大。

我不确定这是否正确，所以如果有误，请解释并随时纠正我。

```
Kim.grow(5,8);
System.out.println(Kim); 
```

这是否意味着如果我这样编码，我的矩形现在将是原来的两倍大还是我遗漏了什么？

grow(int 8, int v)....v 会是什么？..我猜 h 是高度

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-20T23:30:56.153

根据 Javadocs，该[`grow(int h, int v)`](http://docs.oracle.com/javase/7/docs/api/java/awt/Rectangle.html#grow%28int,%20int%29)方法会重新调整矩形的大小，以便：

> ..它的左侧和右侧都大 h 个单位，顶部和底部都大 v 个单位。
> 
> 新矩形的左上角为 (x - h, y - v)，宽度为 (width + 2h)，高度为 (height + 2v)。
> 
> 如果为 h 和 v 提供负值，则 Rectangle 的大小会相应减小。grow 方法将检查整数上溢和下溢，但不检查宽度和高度的结果值是从负数增长到非负数，还是从非负数缩小到负数。

我假设*Kim*是尺寸为 (x, y) 的 java.awt.Rectangle 的一个实例

# .net - 找不到任何带有 Prism 的 Caliburn Micro 样品

> ID：12522366
> 
> 赞同：2
> 
> 时间：2012-09-20T23:26:07.490
> 
> 标签：.net, wpf, mvvm, prism, caliburn.micro

我找不到任何显示 Caliburn Micro 与 Prism 结合的样本。Prism 更像是一个模块化框架，而 Caliburn 更像是一个 MVVM 框架，我知道两者都有重叠的特性，但是当它们结合起来时，从两个框架中获取最好的特性会很棒。有人有样品吗？例如，引导程序是不同的，你如何让它与两个框架一起工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T17:25:47.437

什么都找不到的主要原因是因为CM就够了。使用 CM 时不需要 Prism。但是你可以看看[这里](http://caliburnmicro.codeplex.com/discussions/225686)它真的很旧但仍然。可能没有人会建议将 CM 与 Prism 集成。根本没有理由这样做。

# mysql - MySQL 多命令集

> ID：12522373
> 
> 赞同：3
> 
> 时间：2012-09-20T23:26:34.200
> 
> 标签：mysql

我有一个订单查询

```
ORDER BY FIND_IN_SET(status, '1,5,3,4,2'), end_date ASC 
```

但我想要的是任何状态为 1 的记录按 end_date ASC 排序，任何状态 2 由 end_date DESC 排序，其他记录由 end_date ASC 排序。

这可以做到吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T14:05:15.690

试试这个查询 -

```
SELECT * FROM table_name
  ORDER BY
    IF(status < 2, status, 3),
    IF(status = 2, TO_DAYS(end_date) * -1, TO_DAYS(end_date)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T18:21:09.850

完善德瓦特的答案...

```
SELECT * FROM table_name
  ORDER BY find_in_set(status, '1,5,3,4,2')
  CASE
    WHEN (status = 2) then TO_DAYS(end_date) * -1
    ELSE TO_DAYS(end_date)
  END 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T03:35:54.990

使用 2 个查询来获取不同的排序，然后获取查询的 UNION。

```
SELECT * FROM (
(SELECT * FROM table WHERE status!=2 
 ORDER BY FIND_IN_SET(status, '1,5,3,4'), end_date ASC)
UNION
(SELECT * FROM table WHERE status=2 ORDER BY end_date DESC)
) AS table_sort ORDER BY FIND_IN_SET(status, '1,5,3,4,2') 
```

由于您希望状态 2 记录最后，因此从技术上讲，您不需要在 UNION 上选择并对其进行排序，但我补充说，以防您想要不同的排序顺序。

# iphone - ViewController 不旋转

> ID：12522377
> 
> 赞同：0
> 
> 时间：2012-09-20T23:26:59.683
> 
> 标签：iphone, xcode, ipad, uiviewcontroller, autorotate

我一直在使用应用程序时遇到问题，并且要旋转某些视图。

我已经知道标签栏控制器中的任何视图都不能旋转，除非允许所有视图旋转。我也知道导航控制器中的任何视图都不能旋转，除非最上面的视图被允许旋转。

我主要使用 IB 来设置我的应用程序。

在`MainWindow.xib`我有`AppDelegate Object`, `Window`, `TabBarController`, 然后是一个单独的`UIViewController`.

在选项卡栏的其中一个选项卡中，我有一个 IBAction 链接到 UIButton，代码如下：

```
-(IBAction)stuff {
[self presentViewController:buletinss animated:YES completion:nil];
} 
```

视图控制器在头文件中声明为`IBOutlet`，并从该选项卡类链接到`UIViewControlle`r。然后在 IB 中，我将该视图控制器的`UIViewController`类设置为我设置的类，然后返回`YES`以允许它旋转。

但是，它仍然不会旋转。

我认为由于它不是标签栏的一部分，也不是从导航控制器推动的，所以它可以旋转，但我没有运气。请问有什么帮助吗？

## 这是完整的代码：

首先，具有按钮的视图的 .h 和 .m ：

```
#import <UIKit/UIKit.h>

@interface BulletinViewController : UIViewController {
IBOutlet UIWebView *worship;
IBOutlet UIActivityIndicatorView *activity;
NSTimer *timer;
IBOutlet UIViewController *buletinss;

}
-(IBAction)stuff;
@property (nonatomic, retain) UIActivityIndicatorView *activity;

@end 
```

还有他们

```
#import "BulletinViewController.h"

@implementation BulletinViewController

-(IBAction)stuff {

[self presentViewController:buletinss animated:YES completion:nil];
} 
```

现在它呈现的视图的 .h 和 .m

```
#import <UIKit/UIKit.h>

@interface TestBulletinViewController : UIViewController

@end 
```

还有他们

```
#import "TestBulletinViewController.h"

@implementation TestBulletinViewController

-(BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation         {
return YES;
}
- (void)viewDidLoad
{
[super viewDidLoad];
// Do any additional setup after loading the view.
}

- (void)didReceiveMemoryWarning
{
[super didReceiveMemoryWarning];
// Dispose of any resources that can be recreated.
}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T02:58:00.343

尝试更改此代码

```
[self presentViewController:buletinss animated:YES completion:nil]; 
```

至

```
[self presentModalViewController:buletinss animated:YES]; 
```

**UPD：** 在 iOS 6 中，您必须：

**1)**

代替

```
[window addSubview:buletinss.view]; 
```

和

```
window.rootViewController = buletinss; 
```

**2)**

添加此代码行

```
- (BOOL)shouldAutorotate
{
    return YES;
}

- (NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskLandscape;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T00:54:41.520

如果没有看到您的项目，很难知道发生了什么。您正在做一件非常奇怪的事情：为什么要从 nib 加载视图控制器？你是说：

```
IBOutlet UIViewController *buletinss; 
```

为什么？为什么不显式实例化 BulletinViewController 并将 ivar 设置为该值？

我敢打赌，问题在于在笔尖中，这个对象*不是*BulletinViewController。它可能只是一个通用的 UIViewController。因此，您的 BulletinViewController 代码无关紧要；它从来没有运行过。相反，你有一个通用的 UIViewController 只能旋转到纵向。但这只是一个猜测。

# visual-studio-2008 - 在 Windows Mobile 6.5 中加载软输入面板 DLL 的命令是什么？

> ID：12522378
> 
> 赞同：0
> 
> 时间：2012-09-20T23:27:04.603
> 
> 标签：visual-studio-2008, dll, windows-mobile, soft-input-panel

我正在尝试测试并稍后为 Windows Mobile 6.5 上的自定义软输入面板 DLL 构建一些现有的非常旧的代码。

当我在 Visual Studio 2008（支持旧 eVC 项目文件的最后一个版本）中编译代码以进行测试时，我收到一条消息，指出仅生成了一个 DLL，因此无法直接执行它。但是，IDE 建议我可以指定一个命令来加载 DLL。我应该使用什么命令来加载软输入面板 DLL？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T11:56:59.943

Windows CE 中的输入面板不是由任何特定程序加载的，它们是由操作系统本身加载的（可能由 GWES 加载，但您必须通过 CE 源来验证您是否真的、真的想知道） . 最终结果是您无法在调试器中设置任何“命令行”来让它加载您的 SIP。缺点是你不能使用调试器（如果它是通用的 Windows CE 并且你有一个 BSP，你可以使用 Platform Builder 调试器）。

要“注册”您的 InputPanel，您只需创建适当的注册表项（[记录在 MSDN 中](http://msdn.microsoft.com/en-us/library/aa452746.aspx)）

```
HKEY_CURRENT_USER\CLSID\{your object CLSID}
    InprocServer32=reg_sz:"\\Windows\\mysiplib.dll"
    IsSIPInputMethod=reg_sz:"1" ;note this is a string, not a dword
    DefaultIcon=regsz:"\\Windows\\mysiplib.dll,0" 
```

要让它“出现”，你可能必须进入控制面板，在设置->个人->输入下。

加载后，如果不删除注册表项然后进行软重置，则无法卸载 SIP。

# c# - 如何设计同时使用异步/同步通信的软件

> ID：12522380
> 
> 赞同：1
> 
> 时间：2012-09-20T23:27:12.437
> 
> 标签：c#, oop, design-patterns, network-programming

我希望使用 .NET 进行同步通信（通过串行）`SerialPort`，也希望使用 .NET 进行异步通信（通过以太网）`Socket`。

当前的实现有一个 Connection 类，它声明了 a`SerialPort`和`Socket`，并且根据用户在 GUI 中定义的设备连接类型（COM 或以太网），Connection 类将初始化适当的串行或套接字端口。

我有一个包含所有连接的 ConnectionManager。因此，如果用户使用相同的连接信息创建设备，它不会创建新的连接；相反，它只是分配了在 ConnectionManager 中找到的连接。

这是一个问题，因为我需要进行同步通信和异步通信。发生的情况是有一个循环`Task`在我连接到设备时创建 s 并且每个`Task`人都在尝试执行`Send`and `Receive`，并且由于设备完成任务需要更长的时间，而不是软件创建任务所需的时间，所以是很多并发问题（阻塞线程）。由于我需要进行同步通信，因此我`Mutex`在发送之前锁定了一个`Send`互斥锁，并在我的 -- 之后释放了互斥锁，`Receive`以确保每次发送我都会收到一个接收。这不好，因为当我尝试进行异步通信时，它将由于互斥锁而受到限制。

所以我的问题是，当尝试同时处理异步和同步通信时，最好的设计是什么？是否应该有两个不同的连接类（AConnection、BConnection）继承具有 Send、Receive、Open、Close 方法的 Connection 接口？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-20T23:58:37.203

通常，您应该始终更喜欢对象组合而不是类继承。这意味着，与其创建一个`WorkClass`具有您需要的大部分功能的超类（例如 ），然后创建两个从它继承的具体子类（例如`AWorkClass : WorkClass`和`BWorkClass : WorkClass`）并使用/覆盖这些功能，您应该创建两个具体的没有继承（`AClass`和`BClass`）的类“有”`WorkClass`作为成员变量。

更进一步，最后试图回答你的问题，听起来你想实现[策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)，它允许你非常轻松地切换“策略”（比如在同步和异步通信之间），并允许你添加新的“策略”无需太多努力（或对现有策略进行修改而不必担心连锁反应）。

这是用 C# 实现的示例策略：

```
namespace Your.App
{
//correct implementation of the Strategy Pattern
    interface ICommunication
    {
        void Send();
    }
    class SyncCommunication : ICommunication
    {
        public void Send() { /*your sync code*/ }
    }
    class AsyncCommunication : ICommunication
    {
        public void Send() { /*your async code*/ }
    }
    public class WorkClass
    {
        ICommunication Strategy { get; set; }
        public WorkClass()
        {
            UseAsync = false;
        }
        bool _useAsync;
        public bool UseAsync 
        {
            get { return _useAsync; }
            set
            {
                _useAsync = value;
                if(_useAsync)
                    Strategy = new AsyncCommunication();
                else
                    Strategy = new SyncCommunication ();
            }
        }
        public void Send()
        {
            Strategy.Send();
        }
    }
} 
```

要将其与第一段联系起来，然后像这样使用 WorkClass：

```
namespace Your.App
{
//correct implementation of the Strategy Pattern
    public class MyWorkContext
    {
        WorkClass Worker {get; set;}
        public MyWorkContext()
        {
            Worker = new WorkClass();
        }

        public void SendMyData()
        {
            if(someConditionIsMet)
                Worker.UseAsync = true;
            else
                Worker.UseAsync = false;
            Worker.Send();
        }
    }
} 
```

您可以看到您的用户`WorkClass`（`MyWorkContext`在这种情况下）对您的策略一无所知，也不应该知道。它只是告诉工人足以让其知道*该做什么*，然后工人知道它需要使用哪种策略来完成它。策略本身是唯一知道工作实际如何完成的策略*，*这对于测试和维护非常有用。

# javascript - 将元素从一个删除到另一个/直到另一个

> ID：12522383
> 
> 赞同：0
> 
> 时间：2012-09-20T23:27:48.177
> 
> 标签：javascript

让我们举个例子：

```
<table>
    <tr class="need"></tr>
    <tr class="no-need"></tr> // This is ourElement, needs to be removed
    <tr></tr>                 // This element needs to be removed
    <tr class="no-need"></tr> // This element needs to be removed
    <tr class="no-need"></tr> // This element needs to be removed
    <tr class="need"></tr>    // Elements removed until this
</table> 
```

我想一次删除这四个元素。

这就是我所做的：

```
function remove(ourElement) {
    var body = ourElement.parentNode,
        bodyRows = body.getElementsByTagName('tr');

    for (var i = 0; i < bodyRows.length; i++) {
        if (bodyRows[i] == ourElement) {
            if (!bodyRows[i+1].className) {
                body.removeChild(bodyRows[i+1]);
            }
        }
        if (bodyRows[i] > ourElement) {
            if (bodyRows[i].className == 'no-need') {
                body.removeChild(bodyRows[i]);
            }
            if (bodyRows[i].className == 'need') {
                break;
            }
        }
    }
    body.removeChild(ourElement);
} 
```

该函数仅删除之后的第一个 empy 行`ourElement`及其`ourElement`本身。

正如我上面所写的，我需要在我们函数的第一次运行时删除这四个元素。

需要纯 Javascript。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-21T00:37:54.993

我刚刚意识到您可能正在寻找一个删除边界内项目的函数让我们说：类“需要”和类“需要”之间的项目并删除其中的所有项目。如果那是你的问题，答案如下：

```
function remove( tagElement, boundClass ) {

    var tr = document.getElementsByTagName(tagElement), 
        re = new RegExp("(^|\\s)"+ boundClass +"(\\s|$)"),
        bound = false,
        r = [];

    for( var i=0, len=tr.length; i<len; i++ )  {

        if(  re.test(tr[i].className) ) { 
            bound = ( bound === true ) ? false : true;            
            if(bound) continue;
        }

        if( bound ) r.push( tr[i] );
    }

    while( r.length )
        r[ r.length - 1 ].parentNode.removeChild( r.pop() ); 

}

remove( "tr", "need" ); // use it like this 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-20T23:47:27.637

你需要这样的东西：

```
function remove(ourElement) {
    var body = ourElement.parentNode;
    var childRows = body.childNodes;

    var found = false;
    for (var i = 0; i < childRows.length; i++) {
        var row = childRows[i];

        if(found) {
            if(!row.className || row.className == "no-need") {
                body.removeChild(row);
                i--; // as the number of element is changed
            } else if(row.className == "need") {
                break;
            }
        }

        if(row == ourElement) {
            body.removeChild(ourElement);
            found = true;
            i--; // as the number of element is changed
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-20T23:40:44.537

不能将`<`or`>`运算符用于 DOM 元素。

```
function remove(ourElement) {
    var body = ourElement.parentNode,
        bodyRows = body.getElementsByTagName('tr'),
        lb = false;

    for (var i = 0; i < bodyRows.length; i++) {
        lb = (lb)?(bodyRows[i] == ourElement):lb;
        if(lb){
          if (!bodyRows[i].className) {
              body.removeChild(bodyRows[i]);
          }else if (bodyRows[i].className == 'no-need') {
              body.removeChild(bodyRows[i]);
          }else if (bodyRows[i].className == 'need') {
              break;
          }
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-21T00:04:34.220

试试这个，每次移除一个孩子时，它都会减少 i 来补偿：

```
function remove(ourElement) {
    var body = ourElement.parentNode,
        bodyRows = body.getElementsByTagName('tr'),
        lb = false;

    for (var i = 0; i < bodyRows.length; i++) {
        if (!lb && bodyRows[i] != ourElement) {
            continue;
        } else if(bodyRows[i] == ourElement){
            lb = true;
        }
            if (bodyRows[i].className == 'no-need' || !bodyRows[i].className) {
                body.removeChild(bodyRows[i]);
                i--;
            }
    }
} 
```

# java - 简单的 GUI Java 布局问题

> ID：12522384
> 
> 赞同：0
> 
> 时间：2012-09-20T23:27:51.280
> 
> 标签：java, swing, jframe, jpanel, layout-manager

我正在尝试执行以下操作，但不确定要使用哪种类型的 Java 布局。

我想要一个`JFrame`单面板`totalPanel`。`totalPanel`应该包含两个面板，它们是我编写的自定义类，`PanelA`以及 PanelB。`PanelA`从高度 200`PanelB`开始，从高度 400 开始。当用户扩展窗口或调整窗口大小时，只`PanelB`应增加高度，但两个面板都可以增加宽度。

我该如何设置？我尝试使用 BorderLayout 但“North”的高度总是太小。我曾尝试使用 BoxLayout，但两者`PanelA`的`PanelB`高度始终相同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-20T23:30:08.207

考虑让 totalPanel 使用 BorderLayout。将 PanelA 添加到 BorderLayout.PAGE_START 位置，将 PanelB 添加到 BorderLayout.CENTER 位置。

有关布局管理器的更多信息，请查看教程：[课程：在容器中布局组件](http://docs.oracle.com/javase/tutorial/uiswing/layout/index.html)

编辑：我看到您使用了 BorderLayout，它“不起作用”但您没有显示代码。要更详细地了解它为什么不起作用，请考虑向我们展示代码。

为了让它工作考虑给你的 PanelX 类`getPreferredSize()`覆盖，这将有助于设置 JPanel 的初始大小。

例如：

```
import java.awt.BorderLayout;
import java.awt.Dimension;

import javax.swing.*;

public class SimpleGuiLayout {

   private static void createAndShowGui() {
      JPanel totalPanel = new JPanel(new BorderLayout());

      totalPanel.add(new PanelX(800, 200, "Panel A"), BorderLayout.PAGE_START);
      totalPanel.add(new PanelX(800, 400, "Panel B"), BorderLayout.CENTER);
      JFrame frame = new JFrame("Simple Gui Layout");
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.getContentPane().add(totalPanel);
      frame.pack();
      frame.setLocationByPlatform(true);
      frame.setVisible(true);
   }

   public static void main(String[] args) {
      SwingUtilities.invokeLater(new Runnable() {
         public void run() {
            createAndShowGui();
         }
      });
   }
}

class PanelX extends JPanel {
   private int prefW;
   private int prefH;

   public PanelX(int prefW, int prefH, String title) {
      this.prefW = prefW;
      this.prefH = prefH;
      setBorder(BorderFactory.createTitledBorder(title));
   }

   @Override
   public Dimension getPreferredSize() {
      return new Dimension(prefW, prefH);
   }
} 
```

如果运行，它看起来像这样：
![在此处输入图像描述](../Images/23bec5b4e1750fe0b36eb48fb76e5636.png)

并且会适当调整大小。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-20T23:32:30.310

一种方法（可能不是最简单的）是 GridBagLayout。

使用 weightx 和 weighty 约束来控制哪些成员可以调整大小。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-20T23:33:23.477

我推荐一个 GridBagLayout。使用起来很复杂，但它可以解决您的问题。假设 panelA 位于 panelB 之上，您将有以下约束：

*   panelA 和 panelB 的 gridx 将为 0
*   panelA 将是 ad gridy 0，而 panelB 在 gridy 1
*   对于两者，您将设置 fill = BOTH
*   但是只有 panelB 的高度增加，您可以将 panelB 的 weighty 设置为 1.0，将 panelA 的设置为 0

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-22T13:37:52.917

您最初使用 BorderLayout 的解决方案已经可以使用，您只需要设置 panelA 的首选高度：

```
 panelA.setPreferredSize(new Dimension(0, 200)); 
```

宽度无关紧要，因为 BorderLayout 将忽略添加到 NORTH 或 SOUTH 的组件的首选宽度。

# sed - sed/awk : 匹配一个模式并返回模式末尾和分号之间的所有内容

> ID：12522388
> 
> 赞同：1
> 
> 时间：2012-09-20T23:28:35.853
> 
> 标签：sed, awk, gawk

我有一条线：

`<random junk>TYPE=snp;<more random junk>`

我需要返回结尾`TYPE=`和之间的所有内容`;`（在这种情况下`snp`，但它可以是许多文本字符串中的任何一个。

我尝试了各种 sed / awk 解决方案，但似乎无法正常工作。我觉得这是一个简单的问题，所以很抱歉。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-20T23:31:53.390

这似乎有效：

```
sed 's/.*TYPE=\(.*\);.*/\1/' 
```

**编辑：**

啊，所以随机垃圾中可以有分号。试试这个：

```
sed 's/.*TYPE=\([^;]*\);.*/\1/' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-21T00:05:10.520

需要 GNU grep：

```
grep -Po '(?<=TYPE=)[^;]+' 
```

含义：以“TYPE=”开头，查找一些非分号字符

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-20T23:30:54.513

一种使用方式`GNU sed`：

```
sed -r 's/.*TYPE=([^;]+).*/\1/' file.txt 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-22T12:14:32.480

由于您还标记了此**awk**：

```
$ text='<random junk>TYPE=snp;<more random junk>'
$ echo "$text" | awk -FTYPE= '{sub(/;.*/,"",$2); print $2}'
snp
$ text='foo=bar;baz=fnu;TYPE=snp;XAI=0;XAM=0'
$ echo "$text" | awk -FTYPE= '{sub(/;.*/,"",$2); print $2}'
snp 
```

（仅使用变量来防止换行。）

或者，将其解析为一组`variable=value`对，而不仅仅是一串文本：

```
$ echo "$text" | awk -vRS=";" -F= '$1=="TYPE" {print $2}'
snp 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-22T12:40:38.697

如果需要，您也可以在纯 bash 中执行此操作：

```
$ t="red=blue;TYPE=snp;XAI=0.0037843;XAM=0.0170293;XAS=0.013245;XRI=0;XRM=0"
$ t=${t#*TYPE=}
$ t=${t%%;*}
$ echo $t
snp 
```

# scala - 在 Play 2.0 中如何确定我的请求是通过 HTTP 还是 HTTPS 发出的？

> ID：12522390
> 
> 赞同：0
> 
> 时间：2012-09-20T23:29:40.270
> 
> 标签：scala, https, playframework-2.0

在 Play 2.0 中如何确定我的请求是通过 HTTP 还是 HTTPS 发出的？

有没有办法从请求中找出来？

```
def myControllerMethod = Action { request =>
  // this is where I would like to know
} 
```

Play 1.X 有一个解决方案，它是 request.secure。如果您知道，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-20T23:39:56.620

玩！Framework 2.0 目前不支持 HTTPS（master 分支似乎支持，但可能会被纳入 Play 2.1）。部署 Play 的好方法！（通常，也支持 HTTPS）是使用前端代理 Web 服务器，如 nginx 或 lighttpd。

[这是设置前端 Web 服务器的指南](https://github.com/playframework/Play20/wiki/HTTPServer)。然后，您可以为 HTTPS 请求添加一个特殊的标头。此外，您将能够部署多个 Play! 应用程序，并使用前端 Web 服务器进行负载平衡和自动故障转移。

# mysql - 我应该将多个 id 存储为 varchar 并使用 FIND_IN_SET 吗？

> ID：12522391
> 
> 赞同：1
> 
> 时间：2012-09-20T23:30:04.717
> 
> 标签：mysql, sql, performance

我看到使用这个的平台：

```
- properties table -
id | name | ID_CATEGORY (INT)

- categories table -
id | name

- property_categories -
id_category | id_property 
```

并按类别检索属性

```
SELECT * FROM properties, categories, property_categories
WHERE 1
   AND categories.name = "Some category name here" # match this category name
   AND categories.id = property_categories.id_category # match category
   AND properties.id = property_categories.id_property # and match property 
```

但我最近在一个应用程序中看到了这个（有 2 个表而不是 3 个）：

```
- properties table -
id | name | ID_CATEGORY (VARCHAR(255))

- categories table -
id | name 
```

并使用此查询按类别检索属性：

```
SELECT * FROM properties, categories
WHERE 1
   AND categories.name = "Some category name here" # match this category name
   AND FIND_IN_SET(categories.id, properties.ID_CATEGORY) 
```

有任何性能优势吗？是否应该使用第二种方法来支持第一种方法？如果我保持不变可以吗？

有时有许多字段组合在一起（包括 ID_TYPE、ID_STATUS 等），并且有一个很大的 JOIN 将所有数据粘合在一起以用于过滤器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T23:40:20.527

`FIND_IN_SET`用于逗号分隔的字符串，例如

```
SELECT FIND_IN_SET('b','a,b,c,d'); 
```

这将是存储一堆值的糟糕方式 - 例如，您不能使用索引来查找“b”。

使用多行。

# java - 如何覆盖@JoinColumn 中默认生成的 SQL 名称以进行单列连接

> ID：12522394
> 
> 赞同：1
> 
> 时间：2012-09-20T23:30:14.463
> 
> 标签：java, jpa

我的实体中有一个单向的 onetomany 对象

```
@OneToMany(mappedBy="pub", cascade = CascadeType.ALL, orphanRemoval=true)
@JoinColumn(name="reference") 
```

该实体和子实体的 FK 和 PK 列都是“参考”

当为这个连接生成 SQL 时，它使用默认的 objectname + _ + PK "pub_reference" 并忽略我传入的名称。

我可以将 name= 更改为任何内容，但它总是被忽略。

即使它是单列连接，如何覆盖 name 的默认行为？

父实体

```
@OneToMany(mappedBy="pub", cascade = CascadeType.ALL, orphanRemoval=true)
@JoinColumn(name="bob")
private Collection<PubDisplayText> pubDisplayText; 
```

子实体

```
private Pub pub;

@Id
@XmlTransient
    public Pub getPub() {
    return pub;
}

public void setPub(Pub pub) {
    this.pub = pub;
} 
```

参考[http://docs.oracle.com/javaee/6/api/javax/persistence/JoinColumn.html#name%28%29](http://docs.oracle.com/javaee/6/api/javax/persistence/JoinColumn.html#name%28%29)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T22:43:58.690

单向一对多映射必须使用连接表。您通过指定 @OneToMany.mappedBy 元素来暗示双向一对多。结果，映射从“拥有”映射（由“mappedBy”指定的映射）中获取连接列名称。由于此处未指定任何内容，因此使用默认连接列。

# java - TCP\IP 客户端 - EHOSTUNREACH（没有到主机的路由）

> ID：12522396
> 
> 赞同：18
> 
> 时间：2012-09-20T23:30:33.910
> 
> 标签：java, android, tcpclient

我正在尝试开发客户端服务器 TCP/IP 应用程序。我有一台服务器在我的 PC 上运行，客户端应用程序在移动设备上运行。它们都在同一个 Wi-Fi 网络中，但我无法在它们之间建立连接。在调试客户端 Android 应用程序时显示以下错误：

```
09-21 01:08:40.422: W/System.err(8536): java.net.ConnectException: failed to connect to /192.168.15.115 (port 4449): connect failed: EHOSTUNREACH (No route to host)
09-21 01:08:40.453: W/System.err(8536):     at libcore.io.IoBridge.connect(IoBridge.java:114)
09-21 01:08:40.453: W/System.err(8536):     at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:192)
09-21 01:08:40.453: W/System.err(8536):     at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:172)
09-21 01:08:40.453: W/System.err(8536):     at java.net.Socket.startupSocket(Socket.java:566)
09-21 01:08:40.453: W/System.err(8536):     at java.net.Socket.tryAllAddresses(Socket.java:127)
09-21 01:08:40.453: W/System.err(8536):     at java.net.Socket.<init>(Socket.java:177)
09-21 01:08:40.453: W/System.err(8536):     at java.net.Socket.<init>(Socket.java:149)
09-21 01:08:40.453: W/System.err(8536):     at sabarish.example.client_mobile.MainActivity$1.onClick(MainActivity.java:61)
09-21 01:08:40.453: W/System.err(8536):     at android.view.View.performClick(View.java:3511)
09-21 01:08:40.453: W/System.err(8536):     at android.view.View$PerformClick.run(View.java:14105)
09-21 01:08:40.453: W/System.err(8536):     at android.os.Handler.handleCallback(Handler.java:605)
09-21 01:08:40.453: W/System.err(8536):     at android.os.Handler.dispatchMessage(Handler.java:92)
09-21 01:08:40.453: W/System.err(8536):     at android.os.Looper.loop(Looper.java:137)
09-21 01:08:40.453: W/System.err(8536):     at android.app.ActivityThread.main(ActivityThread.java:4424)
09-21 01:08:40.453: W/System.err(8536):     at java.lang.reflect.Method.invokeNative(Native Method)
09-21 01:08:40.453: W/System.err(8536):     at java.lang.reflect.Method.invoke(Method.java:511)
09-21 01:08:40.453: W/System.err(8536):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
09-21 01:08:40.453: W/System.err(8536):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
09-21 01:08:40.453: W/System.err(8536):     at dalvik.system.NativeStart.main(Native Method)
09-21 01:08:40.457: W/System.err(8536): Caused by: libcore.io.ErrnoException: connect failed: EHOSTUNREACH (No route to host)
09-21 01:08:40.457: W/System.err(8536):     at libcore.io.Posix.connect(Native Method)
09-21 01:08:40.457: W/System.err(8536):     at libcore.io.BlockGuardOs.connect(BlockGuardOs.java:85)
09-21 01:08:40.457: W/System.err(8536):     at libcore.io.IoBridge.connectErrno(IoBridge.java:127)
09-21 01:08:40.457: W/System.err(8536):     at libcore.io.IoBridge.connect(IoBridge.java:112)
09-21 01:08:40.457: W/System.err(8536):     ... 18 more 
```

我正在使用的代码：

```
public class MainActivity extends Activity {
    private Socket client;
    private PrintWriter printwriter;
    private EditText textField;
    private Button button;
    private String messsage;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        textField = (EditText) findViewById(R.id.editText1); //reference to the text field
        button = (Button) findViewById(R.id.button1); //reference to the send button

        button.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                messsage = textField.getText().toString(); //get the text message on the text field
                textField.setText("");      //Reset the text field to blank

                try {
                    client = new Socket("192.168.15.115", 4449);  //connect to server
                    printwriter = new PrintWriter(client.getOutputStream(),true);
                    printwriter.write(messsage);  //write the message to output stream

                    printwriter.flush();
                    printwriter.close();
                    client.close();   //closing the connection

                } catch (UnknownHostException e) {
                    e.printStackTrace();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        }); 
    }
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-20T23:41:32.603

no route 错误表示在尝试 TCP 连接时，连接失败是因为底层协议软件找不到到指定目标节点的网络节点到网络节点的路由。

该修复在某种程度上取决于操作系统，但它主要要求您设置路由表，以便您尝试连接的设备能够弄清楚如何到达您要连接的设备。

通常，您指定一个网关，当您尝试连接时，连接请求会从网关发出，由其他信息技术设备（如路由器等）解析。

这看起来是一个 Android 设备，所以第一件事是确保你有连接，无论是 WiFi 还是手机。另一种方法是确保 WiFi 或手机已打开并正常运行。

您指定的 IP 地址通常位于专用子网中。所以要检查的是您尝试连接的设备是否与您的设备在同一个子网上。

这是[关于子网和路由的文档](http://support.microsoft.com/kb/164015)。

**引用用户 detenson 对 Android 的评论**

用户 detenson 在 2017 年 5 月 13 日发表的评论添加了此特定于 Android 的附加信息以及帖子中提供的错误消息。

> 由于这是 android，您首先需要查看的是权限。**09-21 01:08:40.457: W/System.err(8536): at libcore.io.BlockGuardOs.connect(BlockGuardOs.java:85)**表示连接被设备上的策略拒绝。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-20T23:40:27.213

这看起来像是网络问题而不是 Java 问题。任何一个：

*   客户端上的网络要么不知道如何将数据包路由到服务器，
*   客户端在端口 4449 上的连接尝试被防火墙或数据包过滤器阻止，或者
*   您使用了错误的 IP 地址。

（“没有到主机的路由”消息表明这是第一个问题，但防火墙有时被配置为对不需要的流量做出误导性的响应。）

无论如何，您最好寻找有关如何配置和/或网络和路由的站点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-23T23:20:06.270

您好，我在我的 mac 中遇到了同样的问题，并在 android 设备上运行该应用程序。我必须做以下两件事才能使它工作：

1.  在mac中关闭防火墙
2.  启用红外接收器（系统偏好 > 安全 > 防火墙 > 高级）

它奏效了！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-03-23T22:59:10.930

当我开发一个与java桌面服务器通信的android应用程序时，我遇到了同样的问题，要解决这个问题，只需断开连接android手机和PC的usb电缆即可。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-02-14T10:59:01.043

**关闭移动WiFi，然后再打开**

```
WifiManager mWifiManager = (WifiManager) mContext.getApplicationContext().getSystemService(Context.WIFI_SERVICE);

mWifiManager.setWifiEnabled(false);
mWifiManager.setWifiEnabled(true); 
```

并再次尝试创建套接字连接

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-02-04T23:01:18.740

在您的手机上下载一个 ping 应用程序并尝试 ping 服务器 ip，如果可以的话……如果使用 apache，请将本地机器 IP 放入 httpd.conf 配置文件中。

```
# Change this to Listen on specific IP addresses as shown below to 
# prevent Apache from glomming onto all bound IP addresses.
#
#Listen 12.34.56.78:80
Listen 127.0.0.1:80
Listen 192.168.1.30:80  (your IP) 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-10-19T02:11:41.947

是的..

主机不可访问，就这样。但是，如果一切正常（配置良好的节点/网络，良好的 wifi 信号，..）您可以使用`ping serverIP`（来自手机）或`ping smartphone`（来自服务器）强制该过程。

ping（ICMP 数据包）将强制路由器加速新路由（到达主机的方式）...发送大量 ping（-n 选项）例如：`ping google.com -n 1000`（1000 个连续 ping）

# php - 不删除第二个表中的行

> ID：12522402
> 
> 赞同：1
> 
> 时间：2012-09-20T23:31:09.507
> 
> 标签：php, mysql, mysqli

我想根据图像的文件名从数据库中删除一行。假设我在下面有 2 个表：

```
Image Table:

ImageId  ImageFile

01       cat.png
02       dog.png
03       dog_2.png

Image_Question Table:

ImageId   SessionId   QuestionId
01        AAA              4
02        ABD              1
03        RTD              11 
```

假设在我的应用程序中我删除了文件图像 dog_2.png，然后我希望它删除图像表中声明 dog_2.png 的行（这工作正常），并能够从 Image_Question 表中删除该行行包含与图像表中的 ImageId 和 ImageFile 名称关联的相同 ImageId（这不起作用）。

因此，对于上面的示例，删除后 2 个表现在应该如下所示：

```
Image Table:

ImageId  ImageFile

01       cat.png
02       dog.png

Image_Question Table:

ImageId   SessionId   QuestionId
01        AAA              4
02        ABD              1 
```

但它不会从 Image_Question 表中删除该行，我怎样才能删除该行？

下面是从图像表中删除行的完整代码，它包含大部分已设置但在从 Image_Question 表中删除行时尚未完全完成的代码：

```
$image_file_name = $_GET["imagefilename"];
$img = "ImageFiles/$image_file_name";

echo "$image_file_name was Deleted";
unlink("ImageFiles/$image_file_name");

$imagedeletesql = "DELETE FROM Image WHERE ImageFile = ?";

if (!$delete = $mysqli->prepare($imagedeletesql)) {
    // Handle errors with prepare operation here
}

//Don't pass data directly to bind_param; store it in a variable
$delete->bind_param("s",$img);

$delete->execute();

if ($delete->errno) {
    // Handle query error here
}

$delete->close();

$imagequestiondeletesql = "DELETE FROM Image_Question WHERE ImageId = ?";

if (!$deleteimagequestion = $mysqli->prepare($imagequestiondeletesql)) {
    // Handle errors with prepare operation here
}

// Don't pass data directly to bind_param; store it in a variable
$deleteimagequestion->bind_param("s",....);

$deleteimagequestion->execute();

if ($deleteimagequestion->errno) {
    // Handle query error here
}

$deleteimagequestion->close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T00:56:14.857

您可以使用`JOIN`查询在单个查询中从多个表中删除。我认为这种陈述对你有用：

```
$sql = "
DELETE img, img_q
FROM Image AS img
LEFT JOIN Image_Question AS img_q
    ON img_q.ImageId = img.ImageId
WHERE img.ImageFile = ?"; 
```

# c# - 在哪里可以找到 EntityList 在silverlight ria 服务中？

> ID：12522410
> 
> 赞同：0
> 
> 时间：2012-09-20T23:32:27.270
> 
> 标签：c#, entity-framework, wcf-ria-services, silverlight-5.0

我找不到任何包含`EntityList<T>`类的程序集。

我在旧帖子中读到我需要一个工具包。但我找不到它，因为程序集名称已更改。我目前正在使用 SL5.0。

我正在寻找那个对象，因为我需要一个`ObservableCollection<T>`支持`EntitySet<T>`. 事实上，一开始我开始使用`ObservableCollection<T>`但我意识到它无法更新我的项目。

我读过，`EntityList<T>`是解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T06:00:29.847

您可以`EntityList<T>`在*Microsoft.Windows.Data.DomainServices*程序集中找到它，它是*WCF RIA 服务工具包*的一部分，可以从[此处](http://www.microsoft.com/en-us/download/details.aspx?id=26939)下载。

# hadoop - Hadoop / Yarn (v0.23.3) 伪分布式模式设置 :: 无作业节点

> ID：12522412
> 
> 赞同：1
> 
> 时间：2012-09-20T23:32:49.770
> 
> 标签：hadoop, mapreduce, hadoop-yarn, mrv2

我只是在伪分布式模式下设置了 Hadoop/Yarn 2.x（特别是 v0.23.3）。

我遵循了一些博客和网站的说明，它们或多或少地提供了相同的设置方法。我还关注了 O'reilly 的 Hadoop 书籍的第 3 版（具有讽刺意味的是，它的帮助最小）。

问题：

```
After running "start-dfs.sh" and then "start-yarn.sh", while all of the daemons
do start (as indicated by jps(1)), the Resource Manager web portal
(Here: http://localhost:8088/cluster/nodes) indicates 0 (zero) job-nodes in the
cluster. So while submitting the example/test Hadoop job indeed does get
scheduled, it pends forever because, I assume, the configuration doesn't see a
node to run it on.

Below are the steps I performed, including resultant configuration files.
Hopefully the community help me out... (And thank you in advance). 
```

配置：

在 my 和 hadoop 的 UNIX 帐户配置文件中都设置了以下环境变量：~/.profile：

```
export HADOOP_HOME=/home/myself/APPS.d/APACHE_HADOOP.d/latest
  # Note: /home/myself/APPS.d/APACHE_HADOOP.d/latest -> hadoop-0.23.3

export HADOOP_COMMON_HOME=${HADOOP_HOME}
export HADOOP_INSTALL=${HADOOP_HOME}
export HADOOP_CLASSPATH=${HADOOP_HOME}/lib
export HADOOP_CONF_DIR=${HADOOP_HOME}/etc/hadoop/conf
export HADOOP_MAPRED_HOME=${HADOOP_HOME}
export YARN_HOME=${HADOOP_HOME}
export YARN_CONF_DIR=${HADOOP_HOME}/etc/hadoop/conf
export JAVA_HOME=/usr/lib/jvm/jre 
```

hadoop$ java -版本

```
java version "1.7.0_06-icedtea<br>
OpenJDK Runtime Environment (fedora-2.3.1.fc17.2-x86_64)<br>
OpenJDK 64-Bit Server VM (build 23.2-b09, mixed mode)<br>

# Although the above shows OpenJDK, the same problem happens with Sun's JRE/JDK. 
```

NAMENODE & DATANODE 目录，也在 etc/hadoop/conf/hdfs-site.xml 中指定：

```
/home/myself/APPS.d/APACHE_HADOOP.d/latest/YARN_DATA.d/HDFS.d/DATANODE.d/
/home/myself/APPS.d/APACHE_HADOOP.d/latest/YARN_DATA.d/HDFS.d/NAMENODE.d/ 
```

接下来是各种 XML 配置文件（这里还是 YARN/MRv2/v0.23.3）：

```
hadoop$ pwd; ls -l
/home/myself/APPS.d/APACHE_HADOOP.d/latest/etc/hadoop/conf
lrwxrwxrwx 1 hadoop hadoop   16 Sep 20 13:14 core-site.xml -> ../core-site.xml
lrwxrwxrwx 1 hadoop hadoop   16 Sep 20 13:14 hdfs-site.xml -> ../hdfs-site.xml
lrwxrwxrwx 1 hadoop hadoop   18 Sep 20 13:14 httpfs-site.xml -> ../httpfs-site.xml
lrwxrwxrwx 1 hadoop hadoop   18 Sep 20 13:14 mapred-site.xml -> ../mapred-site.xml
-rw-rw-r-- 1 hadoop hadoop   10 Sep 20 15:36 slaves
lrwxrwxrwx 1 hadoop hadoop   16 Sep 20 13:14 yarn-site.xml -> ../yarn-site.xml 
```

核心站点.xml

```
<?xml version="1.0"?>
<!-- core-site.xml -->
<configuration>
  <property>
    <name>fs.default.name</name>
    <value>hdfs://localhost/</value>
  </property>
</configuration> 
```

mapred-site.xml

```
<?xml version="1.0"?>
<!-- mapred-site.xml -->
<configuration>

  <!-- Same problem whether this (legacy) stanza is included or not.  -->
  <property>
    <name>mapred.job.tracker</name>
    <value>localhost:8021</value>
  </property>

  <property>
    <name>mapreduce.framework.name</name>
    <value>yarn</value>
  </property>
</configuration> 
```

hdfs-site.xml

```
<!-- hdfs-site.xml -->
<configuration>
  <property>
    <name>dfs.replication</name>
    <value>1</value>
  </property>
  <property>
    <name>dfs.namenode.name.dir</name>
    <value>file:/home/myself/APPS.d/APACHE_HADOOP.d/YARN_DATA.d/HDFS.d/NAMENODE.d</value>
  </property>
  <property>
    <name>dfs.datanode.data.dir</name>
    <value>file:/home/myself/APPS.d/APACHE_HADOOP.d/YARN_DATA.d/HDFS.d/DATANODE.d</value>
  </property>
</configuration> 
```

纱线站点.xml

```
<?xml version="1.0"?>
<!-- yarn-site.xml -->
<configuration>
  <property>
    <name>yarn.resourcemanager.address</name>
    <value>localhost:8032</value>
  </property>
  <property>
    <name>yarn.nodemanager.aux-services</name>
    <value>mapreduce.shuffle</value>
  </property>
  <property>
    <name>yarn.nodemanager.aux-services.mapreduce.shuffle.class</name>
    <value>org.apache.hadoop.mapred.ShuffleHandler</value>
  </property>
  <property>
    <name>yarn.nodemanager.resource.memory-mb</name>
    <value>4096</value>
  </property>
  <property>
    <name>yarn.nodemanager.local-dirs</name>
    <value>/home/myself/APPS.d/APACHE_HADOOP.d/YARN_DATA.d/TEMP.d</value>
  </property>
</configuration> 
```

等/hadoop/conf/保存

```
localhost
   # Community/friends, is this entry correct/needed for my psuedo-dist mode? 
```

其他总结说明：

```
(1) As you may have gleaned from above, all files/directories are owned
    by the 'hadoop' UNIX user. There is a hadoop:hadoop, UNIX User and
    Group, respectively.

(2) The following command was run after the NAMENODE & DATANODE directories
    (listed above) were created (and whose paths were entered into
    hdfs-site.xml):

    hadoop$ hadoop namenode -format

(3) Next, I ran "start-dfs.sh", then "start-yarn.sh".
    Here is jps(1) output:

hadoop@e6510$ jps
    21979 DataNode
    22253 ResourceManager
    22384 NodeManager
    22156 SecondaryNameNode
    21829 NameNode
    22742 Jps 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T01:06:18.510

在这个问题上费了很多功夫，但没有成功（相信我，我都试过了），我使用不同的解决方案建立了 hadoop。上面我从一个下载镜像下载了一个 gzip/tar 包的 hadoop 分发包（同样是 v0.23.3），这次我使用了 RPM 包的 Caldera CDH 分发包，我通过他们的 YUM 存储库安装了它。希望这会对某人有所帮助，这里是详细的步骤。

步骤1：

对于 Hadoop 0.20.x（MapReduce 版本 1）：

```
 # rpm -Uvh http://archive.cloudera.com/redhat/6/x86_64/cdh/cdh3-repository-1.0-1.noarch.rpm
  # rpm --import http://archive.cloudera.com/redhat/6/x86_64/cdh/RPM-GPG-KEY-cloudera
  # yum install hadoop-0.20-conf-pseudo 
```

-或者-

对于 Hadoop 0.23.x（MapReduce 版本 2）：

```
 # rpm -Uvh http://archive.cloudera.com/cdh4/one-click-install/redhat/6/x86_64/cloudera-cdh-4-0.noarch.rpm
  # rpm --import http://archive.cloudera.com/cdh4/redhat/6/x86_64/cdh/RPM-GPG-KEY-cloudera
  # yum install hadoop-conf-pseudo 
```

在上述两种情况下，安装“伪”包（代表“伪分布式 Hadoop”模式）将单独方便地触发您需要的所有其他必要包的安装（通过依赖关系解析）。

第2步：

安装 Sun/Oracle 的 Java JRE（如果您还没有这样做的话）。您可以通过他们提供的 RPM 或 gzip/tar 球便携式版本来安装它。只要您适当地设置和导出“JAVA_HOME”环境，并确保 ${JAVA_HOME}/bin/java 在您的路径中，这并不重要。

```
 # echo $JAVA_HOME; which java
  /home/myself/APPS.d/JAVA-JRE.d/jdk1.7.0_07
  /home/myself/APPS.d/JAVA-JRE.d/jdk1.7.0_07/bin/java 
```

注意：我实际上创建了一个名为“latest”的符号链接，并在我更新 JAVA 时将其指向/重新指向 JAVA 版本特定目录。为了读者的理解，我在上面说得很清楚。

第 3 步：将 hdfs 格式化为“hdfs”Unix 用户（在上面的“yum install”期间创建）。

```
 # sudo su hdfs -c "hadoop namenode -format" 
```

第4步：

手动启动 hadoop 守护进程。

```
 for file in `ls /etc/init.d/hadoop*`
  do
  {
     ${file} start
  }
  done 
```

第五步：

检查是否一切正常。以下是针对 MapReduce v1 的（在这个肤浅的层面上与 MapReduce v2 并没有太大的不同）。

```
 root# jps
   23104 DataNode
   23469 TaskTracker
   23361 SecondaryNameNode
   23187 JobTracker
   23267 NameNode
   24754 Jps

   # Do the next commands as yourself (not as "root").
   myself$ hadoop fs -mkdir /foo
   myself$ hadoop fs -rmr /foo
   myself$ hadoop jar /usr/lib/hadoop-0.20/hadoop-0.20.2-cdh3u5-examples.jar pi 2 100000 
```

我希望这有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T00:34:01.153

Noel,

I followed this other day the steps in this tutorial [http://www.thecloudavenue.com/search?q=0.23](http://www.thecloudavenue.com/search?q=0.23) and I managed to set up a small cluster of 3 centos 6.3 machines

# mysql - 在 MySQL 中，root@'my.host' 和 root@'127.0.0.1' 的目的是什么？

> ID：12522421
> 
> 赞同：0
> 
> 时间：2012-09-20T23:34:17.307
> 
> 标签：mysql

Centos6（和其他发行版 iirc）上的 Mysql 初始化多个 root 用户（其中​​ host.domain 是我的主机名）：

```
select User,Host,Password from mysql.user where User = 'root';

+------+-------------+-------------------------------------------+
| User | Host        | Password                                  |
+------+-------------+-------------------------------------------+
| root | localhost   | *2470C0C06DEE42FD1618BB99005ADCA2EC9D1E19 |
| root | host.domain | *2470C0C06DEE42FD1618BB99005ADCA2EC9D1E19 |
| root | 127.0.0.1   | *2470C0C06DEE42FD1618BB99005ADCA2EC9D1E19 |
+------+-------------+-------------------------------------------+ 
```

我不明白 root@'host.domain' 和 root@'127.0.0.1' 条目的用途。在什么情况下，本地主机连接的主机*不是*“本地主机”？我认为所有本地连接都被解释为来自'localhost'。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T02:29:42.353

您使用 root@localhost 与 root@remoteipaddress。它们用于远程主机访问，因此其他服务器可以连接到您的数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T23:47:22.083

好吧，如果您愿意，可以编辑 etc/hosts 并将 localhost 设置为 127.0.0.1 以外的其他内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-21T00:30:48.297

如果您运行一个虚拟主机，您的 apache 服务器可能会在同一台服务器上托管多个域。在这种情况下，127.0.0.1 指向多个域。例如，/etc/hosts 可能看起来像这样。

```
127.0.0.1    localhost    www.gregsblog.com    www.dannisrecipes.org    www.schoolofsql.edu 
```

现在当 php 尝试访问 MySQL 时，如果它是运行 php 的 apache 系统，他的请求将是**root@localhost**。这很好！现在，如果格雷格试图达到它怎么办？他的请求是**root@www.gregsblog.com**。这也很好，因为我们不希望可疑的 Greg 进入我们的数据库。

**如果您移动主机， host.domain**只会使 IMO 变得更容易。所以**root@host.domain**即使您最终分成两个不同的应用程序和数据服务器。

# c - 按位操作：在一系列连续位之后，将最左边的不同位传播到右侧

> ID：12522435
> 
> 赞同：-1
> 
> 时间：2012-09-20T23:36:20.677
> 
> 标签：c, bit-manipulation, bitwise-operators, propagation

我在一个练习中遇到了一些麻烦，我们必须只使用位运算符（在 C 中）、一元运算符 ~ 和 ! 以及有符号整数变量来实现函数。我们不允许使用任何条件、循环或任意数字——见鬼，我们甚至不允许使用减号（-），但有一个非常简单的解决方法。

基本上，任务是从最高有效位开始计算设置位的数量，直到找到未设置的位。我以为我已经把这一切都弄清楚了，除了我无法找到和传播第一个未设置的位。我的想法是反转并将（现在）最左边的 1 位向右传播，以便能够将其隔离，然后向右移动 3（因为隔离会将其向上移动），结果应该成为这样做在右边设置 1 位。

我在这方面最大的障碍是找到最左边的位（无论是设置还是未设置）并传播它......任何想法，提示或线索？

我的理论算法会做什么的一个例子：

```
1110 0101 1011 1100    // our target
0001 1010 0100 0011    // invert it
0001 1111 1111 1111    // propagate
0001 0000 0000 0000    // magic happens -- isolate the leftmost 1 bit
0000 0100 0000 0000    // shift by >>2
// it's at this point I realize I have no idea what I'm doing anymore
// this looks like 2^10 which is a bit too big... 
```

所以基本上，我什么都没有。有人可以给我一个关于我应该读什么的提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T02:05:10.683

通过逐位测试8位整数的“蛮力”解决方案：

```
int countLeadingBits(int8 x)
{
    int isSetFirst1 = (!!(x & 0x80));               /* 1 if bit pattern is 1xxxxxxx */
    int isSetFirst2 = (!!(x & 0x40)) & isSetFirst1; /* 1 if bit pattern is 11xxxxxx */
    int isSetFirst3 = (!!(x & 0x20)) & isSetFirst2; /* 1 if bit pattern is 111xxxxx */
    int isSetFirst4 = (!!(x & 0x10)) & isSetFirst3; /* etc */
    int isSetFirst5 = (!!(x & 0x08)) & isSetFirst4;
    int isSetFirst6 = (!!(x & 0x04)) & isSetFirst5;
    int isSetFirst7 = (!!(x & 0x02)) & isSetFirst6;
    int isSetFirst8 = (!!(x & 0x01)) & isSetFirst7;

    return isSetFirst1 +
           isSetFirst2 +
           isSetFirst3 +
           isSetFirst4 +
           isSetFirst5 +
           isSetFirst6 +
           isSetFirst7 +
           isSetFirst8;
} 
```

这个想法是隔离一个位 like `x & 0x40`，然后使用双重否定将其转换为 0 或 1 `!!`，然后我们可以`&`像布尔运算符一样使用我们知道必须是 0 或 1 的数字。一旦我们测试了所有位，我们可以通过添加它们来简单地计算设置了多少。

我将把它留给你，将它扩展到你需要的尽可能多的位。

# iphone - NSNumberFormatter 没有符号的货币？

> ID：12522436
> 
> 赞同：21
> 
> 时间：2012-09-20T23:36:20.870
> 
> 标签：iphone, objective-c, ipad, currency, nsnumberformatter

我正在使用 NSNumberFormatter 从字符串中获取货币值，并且效果很好。

我使用此代码这样做：

```
NSNumberFormatter *nf = [[NSNumberFormatter alloc] init];
    [nf setNumberStyle:NSNumberFormatterCurrencyStyle];
    NSString *price = [nf stringFromNumber:[NSNumber numberWithFloat:[textField.text floatValue]]]; 
```

但是，它总是在字符串的开头给我一个货币符号。而不是手动形成我给定的字符串，我可以不让格式化程序不给字符串任何货币符号吗？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2012-09-20T23:47:40.867

是的，设置样式后，您可以调整特定方面：

```
NSNumberFormatter *nf = [[NSNumberFormatter alloc] init];
[nf setNumberStyle:NSNumberFormatterCurrencyStyle];
[nf setCurrencySymbol:@""]; // <-- this
NSDecimalNumber* number = [NSDecimalNumber decimalNumberWithString:[textField text]];
NSString *price = [nf stringFromNumber:number]; 
```

就像一些建议一样，您可能应该使用数字格式化程序来读取字符串值，尤其是当用户正在输入它时（如您的代码所建议的那样）。在这种情况下，如果用户输入特定于区域设置的格式文本，通用`-floatValue`和`-doubleValue`类型方法不会给您截断数字。此外，您可能应该使用`-doubleValue`从用户输入的货币文本转换为浮点数。有关国际化的 WWDC'12 开发者会议视频中有更多信息。

*编辑：`NSDecimalNumber`在示例代码中使用 an 来表示用户输入的数字。它仍然没有进行正确的验证，但比原始代码更好。谢谢[@马克](https://stackoverflow.com/users/151019/mark)！*

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-03-29T16:21:09.987

在 Swift 5 中，`NumberFormatter`有一个名为[`currencySymbol`](https://developer.apple.com/documentation/foundation/numberformatter/1414668-currencysymbol). `currencySymbol`有以下声明：

```
var currencySymbol: String! { get set } 
```

> 接收方用作本地货币符号的字符串。

因此，如果您的格式样式需要，您可以将此属性设置为空`String`。

* * *

以下 Playground 示例代码显示了如何使用空符号设置货币格式样式：

```
import Foundation

let amount = 12000

let formatter = NumberFormatter()
formatter.numberStyle = NumberFormatter.Style.currency
formatter.currencySymbol = ""
formatter.locale = Locale(identifier: "en_US") // set only if necessary

let result = formatter.string(for: amount)
print(String(describing: result)) // prints: Optional("12,000.00") 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-04-16T23:05:17.083

至于 Swift 语言

```
let mymoney = 12000

let formatter = NSNumberFormatter()
formatter.numberStyle = .CurrencyStyle
formatter.currencySymbol = ""
formatter.locale = NSLocale.currentLocale()

let resultString = formatter.stringFromNumber(mymoney)! 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-10-07T19:14:36.143

对@Imanou Petit 答案稍作调整。

```
let myDouble = 9999.99
let currencyFormatter = NumberFormatter()
currencyFormatter.usesGroupingSeparator = true
currencyFormatter.numberStyle = .currency
currencyFormatter.currencySymbol = ""
// localize to your grouping and decimal separator
currencyFormatter.locale = Locale.current

// We'll force unwrap with the !, if you've got defined data you may need more error checking

let priceString = currencyFormatter.string(from: NSNumber(value: myDouble))!
print(priceString) // Displays 9,999.99 without the currency & not as Optional 
```

# xcode - Georss提要xcode

> ID：12522437
> 
> 赞同：1
> 
> 时间：2012-09-20T23:36:32.523
> 
> 标签：xcode, rss, feed, georss

首先，我来自西班牙，所以对我的英语感到抱歉；）我正在尝试做一个 georss 提要，我的第一个问题从提要的 url 开始，用我的代码我可以解析很多 url，比如[http:/ /feeds.feedburner.com/applesfera](http://feeds.feedburner.com/applesfera)但我无法加载这个：

[http://www.zaragoza.es/georref/rdf/hilo/ver_Incidencias?tipo=3&srsname=wgs84](http://www.zaragoza.es/georref/rdf/hilo/ver_Incidencias?tipo=3&srsname=wgs84)

我的代码是：（错误代码 5）

```
- (void)viewDidAppear:(BOOL)animated {
[super viewDidAppear:animated];

if ([stories count] == 0) 
{

    NSString * path = @"http://www.zaragoza.es/georref/rdf/hilo/ver_Incidencias?tipo=3&srsname=wgs84";
    [self parseXMLFileAtURL:path];
    }
}

- (void)parseXMLFileAtURL:(NSString *)URL{  
stories = [[NSMutableArray alloc]init];
NSURL *xmlURL = [NSURL URLWithString:URL];
rssParser = [[NSXMLParser alloc]initWithContentsOfURL:xmlURL];
[rssParser setDelegate:self];
[rssParser setShouldProcessNamespaces:NO];
[rssParser setShouldReportNamespacePrefixes:NO];
[rssParser setShouldResolveExternalEntities:NO];
[rssParser parse];      } 
```

任何建议为什么会这样？

谢谢;）

# php - 在 php/javascript 中将数据从一个网站填充到另一个网站

> ID：12522438
> 
> 赞同：0
> 
> 时间：2012-09-20T23:36:43.007
> 
> 标签：php, javascript

我尝试将一些数据从一个网站填充到另一个网站，这两个网站不在同一个服务器上，我无权访问另一个网站的后端。

例如：我创建了一个网站，它会从用户-姓名-电话号码-地址中收集以下数据

然后我必须将这些数据（自动填写，以便我不必手动输入相同的数据）传递到另一个独立的网站以进行用户信息检查（t0确保地址，电话和地址是有效数据） .

有谁知道我怎么能在 php/javascript 中做到这一点？任何示例或教程可以显示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T00:31:51.010

我会使用 JSONP 在不同域之间移动数据，并使用 JQuery 的 getJSON 方法调用服务器。PHP 文件应该以正确的格式返回数据，并且客户端应该能够使用 JQuery 读取它。

这是一个示例： **服务器端 PHP 代码**

```
 <?php
header("content-type: application/json"); 

// Create a generic object.
// Assign it the property 'message' - the feedback message we want the user to see.
 $rtnjsonobj->message = "You got an AJAX response via JSONP from another site!";

// Wrap and write a JSON-formatted object with a function call, using the supplied value of parm 'callback' in the URL:
echo $_GET['callback']. '('. json_encode($rtnjsonobj) . ')';    

?> 
```

**从客户端获取数据**

```
$(document).ready(function() {
 $("#jsonpbtn").click(function() {
    var surl =  "http://www.otherdomain.com/abovepage.php?callback=?";
    $.getJSON(surl,  function(rtndata) {
        alert(rtndata.message);
    });
 });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T00:00:54.310

您要问的正是跨站点脚本（XSS）。所有现代浏览器都会阻止您在任何不在原始域中的 url 上执行任何前端 (JS) 脚本。

您可以尝试将 GET 值传递到页面中，如果开发人员为此在他们的 PHP 中构建了句柄，您也许可以填充这些字段。我非常怀疑这会起作用，因为它会暴露出巨大的安全漏洞。

我不知道你在一天结束时想要做什么，但要**非常小心**。XSS 是一种利用，你很有可能会因此而陷入困境。

# windows - WdfRequestIsCanceled 与 WdfRequestMarkCancelable

> ID：12522441
> 
> 赞同：0
> 
> 时间：2012-09-20T23:36:56.857
> 
> 标签：windows, kernel, wdf, kmdf, irp

谁能列出在 wdf 中使用以下两种方法取消 IO 的优缺点？1) 使用 WdfRequestMarkCancelable() 将请求标记为可取消。提供取消例程并同步完成路径。2) 在处理 IRP 时继续使用 WdfRequestIsCanceled() 进行轮询。根据返回值完成。

我知道 WdfRequestIsCanceled() 是一种轮询方法，而 WdfRequestMarkCancelable () 是异步的。但是 WdfRequestMarkCancelable() 是否值得为同步完成/取消路径付出额外的努力？

感谢您的投入。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T06:25:00.020

WdfRequestIsCanceled() 仅在您碰巧正在处理请求时才有用。而且，在 Windows 驱动程序中，您往往需要非常异步地构建事物，因此您通常不会“碰巧”处理请求。

您实际上应该问自己一个不同的问题：我是要使用 WdfRequestMarkCancelable 还是要在您进行相关工作时将请求放回“手动”队列中。将其放入手动队列将使其可取消。如果你需要在它被取消时做任何事情，你可以在手动队列本身上放置一个取消回调。

每种方法都有优点和缺点。我个人更喜欢使用 WdfRequestMarkCancelable 直接处理取消。大多数其他人更喜欢将请求放入手动队列中。

# java - 每次加密使用随机盐时，我可以避免每次加密/解密调用的密码重新初始化吗？

> ID：12522443
> 
> 赞同：8
> 
> 时间：2012-09-20T23:37:05.810
> 
> 标签：java, performance, cryptography, aes, salt

# 编辑

实际上重新初始化密码并没有那么慢。由于迭代次数，创建密钥本身很慢。

此外，迭代计数被忽略并且从未在加密本身中使用，仅在密钥生成时使用。根据所选择的算法，JCE api 会产生误导

# 原帖

由于 Java 中的密码学相当……密码学，我正在努力做一些优化。在功能方面，这个类工作得很好，我希望它可以作为 AES 加密使用的一个例子

使用 BouncyCastle 的 AES 实现加密和解密数据时出现性能问题（我没有比较，这是我测试的唯一一种实现）。实际上，这个问题对于我决定使用的任何密码都是通用的。

主要问题是：我可以避免每个加密/解密调用的两个密码整个重新初始化吗？它们太贵了

为了简单起见，请记住以下代码已删除其异常处理，并进行了大量简化以保持对问题的关注。同步块是为了保证线程安全

顺便说一句，欢迎对代码的任何部分进行反馈

谢谢

```
import java.nio.charset.Charset;
import java.security.SecureRandom;
import java.security.Security;
import java.util.Arrays;

import javax.crypto.Cipher;
import javax.crypto.SecretKey;
import javax.crypto.SecretKeyFactory;
import javax.crypto.spec.PBEKeySpec;
import javax.crypto.spec.PBEParameterSpec;

import org.bouncycastle.jce.provider.BouncyCastleProvider;

public class AES {

    private static final int ITERATIONS = 120000;
    private static final int SALT_SIZE_IN_BYTES = 8;
    private static final String algorithm = "PBEWithSHA256And128BitAES-CBC-BC";
    private static final byte[] KEY_SALT = "a fixed key salt".getBytes(Charset.forName("UTF-8"));

    private Cipher encryptCipher;
    private Cipher decryptCipher;
    private SecretKey key;
    private RandomGenerator randomGenerator = new RandomGenerator();

    static {
        if (Security.getProvider(BouncyCastleProvider.PROVIDER_NAME) == null)
            Security.addProvider(new BouncyCastleProvider());
    }

    public AES(String passphrase) throws Exception {
        encryptCipher = Cipher.getInstance(algorithm);
        decryptCipher = Cipher.getInstance(algorithm);
        PBEKeySpec keySpec = new PBEKeySpec(passphrase.toCharArray(), KEY_SALT, ITERATIONS);
        SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(algorithm);
        key = keyFactory.generateSecret(keySpec);
    }

    public byte[] encrypt(byte[] data) throws Exception {
        byte[] salt = randomGenerator.generateRandom(SALT_SIZE_IN_BYTES);
        PBEParameterSpec parameterSpec = new PBEParameterSpec(salt, ITERATIONS);
        data = DataUtil.append(data, salt);

        byte[] encrypted;
        synchronized (encryptCipher) {
            // as a security constrain, it is necessary to use different salts per encryption
            // core issue: want to avoid this reinitialization to change the salt that will be used. Its quite time consuming
            encryptCipher.init(javax.crypto.Cipher.ENCRYPT_MODE, key, parameterSpec);
            encrypted = encryptCipher.doFinal(data);
        }
        return DataUtil.append(encrypted, salt);
    }

    public byte[] decrypt(byte[] data) throws Exception {
        byte[] salt = extractSaltPart(data);
        data = extractDataPart(data);

        PBEParameterSpec parameterSpec = new PBEParameterSpec(salt, ITERATIONS);

        byte[] decrypted;

        synchronized (decryptCipher) {
            // as a security constrain, it is necessary to use different salts per encryption
            // core issue: want to avoid this reinitialization to change the salt that will be used. Its quite time consuming
            decryptCipher.init(javax.crypto.Cipher.DECRYPT_MODE, key, parameterSpec); 
            decrypted = decryptCipher.doFinal(data);
        }

        byte[] decryptedSalt = extractSaltPart(decrypted);

        if (Arrays.equals(salt, decryptedSalt))
            return extractDataPart(decrypted);
        else
            throw new IllegalArgumentException("Encrypted data is corrupted: Bad Salt");
    }

    protected byte[] extractDataPart(byte[] bytes) {
        return DataUtil.extract(bytes, 0, bytes.length - SALT_SIZE_IN_BYTES);
    }

    protected byte[] extractSaltPart(byte[] bytes) {
        return DataUtil.extract(bytes, bytes.length - SALT_SIZE_IN_BYTES, SALT_SIZE_IN_BYTES);
    }

    // main method to basic check the code execution
    public static void main(String[] args) throws Exception {
        String plainText = "some plain text, have fun!";
        String passphrase = "this is a secret";

        byte[] data = plainText.getBytes(Charset.forName("UTF-8"));

        AES cipher = new AES(passphrase);
        byte[] encrypted = cipher.encrypt(data);
        byte[] decrypted = cipher.decrypt(encrypted);

        System.out.println("expected: true, actual: " + Arrays.equals(data, decrypted));
    }
}

// Utility class
class RandomGenerator {

    private SecureRandom random = new SecureRandom();

    public RandomGenerator() {
        random = new SecureRandom();
        random.nextBoolean();
    }

    public synchronized byte[] generateRandom(int length) {
        byte[] data = new byte[length];
        random.nextBytes(data);
        return data;
    }
}

// Utility class
class DataUtil {

    public static byte[] append(byte[] data, byte[] append) {
        byte[] merged = new byte[data.length + append.length];
        System.arraycopy(data, 0, merged, 0, data.length);
        System.arraycopy(append, 0, merged, data.length, append.length);
        return merged;
    }

    public static byte[] extract(byte[] data, int start, int length) {
        if (start + length > data.length)
            throw new IllegalArgumentException("Cannot extract " + length + " bytes starting from index " + start + " from data with length " + data.length);

        byte[] extracted = new byte[length];
        System.arraycopy(data, start, extracted, 0, length);
        return extracted;
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-21T00:14:27.573

你运气不好。`init`如果您每次都选择新的盐，这意味着您每次都使用新的密钥进行加密/解密，这意味着您每次都需要调用。

如果您想要更快的速度，只需添加您的信息：

```
byte[] salt = randomGenerator.generateRandom(SALT_SIZE_IN_BYTES);
encryptCipher.update(salt);
encrypted = encryptCipher.doFinal(data); 
```

这样，您每次都使用相同的密钥，因此您无需重新初始化它。（不要使用 PBE，只需使用 128 位 AES/CBC）。如果不知道您打算如何在现实世界中应用这种加密，就很难知道这是否足以满足您的需求。

ps 迭代次数 == 120000？怪不得这么慢。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-25T14:30:00.130

实际上重新初始化密码并没有那么慢。由于迭代次数，创建密钥本身很慢。

此外，迭代计数被忽略并且从未在加密本身中使用，仅在密钥生成时使用。根据所选择的算法，JCE API 会产生误导

关于盐：在普通消息中添加盐是完全没有必要的。我真正应该用来在每次加密中实现随机性的是使用随机初始化向量，它可以像盐一样在加密后附加或附加到密文中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-21T02:13:12.187

1.  如果您只是在传输数据并需要在飞行中对其进行加密，请使用 TLS/SSL。它的方式更快，不会中断。

2.  确保您对密文使用了一些身份验证。在 GCM 或 CCM 模式下使用 MAC 或更好地使用 AES。否则你的加密是不安全的。

至于你的问题：是的，它是可以解决的。只需生成一次密钥并重用它/ 。AES 可以安全地使用相同的密钥发送多条消息。所以只需派生一次密钥/密码并继续使用它。

只需确保为每条消息使用新的 IV。

# xcode - xcode4.5 是否支持 ios4.3 模拟器或更早版本？

> ID：12522449
> 
> 赞同：2
> 
> 时间：2012-09-20T23:38:01.193
> 
> 标签：xcode

我已经从 4.4 升级到 xcode4.5，但我在其中找不到 ios 模拟器 4 或之前的版本。我打开 Xcode 菜单、首选项、下载，我只能看到模拟器 5 和 5.1。我不确定 xcode4.5 是否支持 ios 模拟器 4 以及使用 ios4.3 和之前的调试。我知道几乎 iphone 和 ipad 的人已经将他们的 ios 升级到 5。但是我们有一些项目在 ios 4.3 中运行。有人知道如何在 xcode 4.5 中安装模拟器 4 吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T12:52:27.253

看起来它已从 Mountain Lion 上的 xcode 4.5 中删除： [xcode 4.5 运行 ios 4.0 模拟器（不）](https://stackoverflow.com/questions/12511191/xcode-4-5-runs-ios-4-0-simulator-not)

根据 Apple 的说法，您仍然可以为 4.3 设置部署目标： [https ://discussions.apple.com/docs/DOC-3461](https://discussions.apple.com/docs/DOC-3461)

> Xcode 4.5 或更高版本支持的最低部署目标是 iOS 4.3。

# css - css选择器中的重复，SCSS

> ID：12522450
> 
> 赞同：0
> 
> 时间：2012-09-20T23:38:07.167
> 
> 标签：css, css-selectors, compass-sass, sass

假设我有这样的样式定义：

```
.a.b   { ... }
.a.b.c { ... } 
```

有没有办法`.a.b`使用 SASS/SCSS 避免部分重复？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-20T23:38:43.647

`.a.b.c`将规则嵌套在其中并用[组合](http://sass-lang.com/docs/yardoc/file.SASS_REFERENCE.html#referencing_parent_selectors_)`.a.b`器替换第一部分：[`&`](http://sass-lang.com/docs/yardoc/file.SASS_REFERENCE.html#referencing_parent_selectors_)

```
.a.b {
    ...
    &.c { ... }
} 
```

# facebook - Facebook oauth 服务器端/ref=m_notif 时无代码交换

> ID：12522452
> 
> 赞同：1
> 
> 时间：2012-09-20T23:38:18.713
> 
> 标签：facebook, mobile, server-side, facebook-oauth

我在画布上有一个运行良好的 facebook 应用程序。我启用了推荐身份验证。我最近启用了我的移动网络应用程序链接，所以现在我可以从 facebook 应用程序或 [http://m.facebook.com/apps/MY_APP访问我的应用程序](http://m.facebook.com/apps/MY_APP)

我对 ?code= 参数的必要服务器端处理进行了编码以生成 access_token ，因此它可以正常工作。（我使用一个redirect_uri请求access_token，这是我当前的url，直到“＆code =”）

我的问题是当我尝试从应用程序请求（在我的手机上）打开我的移动网络应用程序时，access_token 请求失败（肯定是因为 redirect_uri 参数）。

经过大量调查，我发现唯一的问题是**ref=m_notif**参数。

基本上，如果我尝试使用它访问我的应用程序，`m.facebook.com/apps/MY_APP/*almost any string or parameter I want*`但如果我尝试使用`m.facebook.com/apps/MY_APP/?ref=m_notif` 它访问我的应用程序失败。任何其他`ref=*string*`都可以。

你知道我应该在这里做什么吗？

非常感谢

# html - 居中的文本两边都有类似 hr 的线条，不使用表格

> ID：12522455
> 
> 赞同：8
> 
> 时间：2012-09-20T23:38:24.720
> 
> 标签：html, css, html-table

我需要在标题文本的两侧创建一个等长线的标题，并在行和文本之间创建一个固定大小的填充。文本会有所不同，因此不得设置宽度。这些行应该占据标题容器中所有剩余的宽度。标题文字不能设置背景，因为它背后的背景会有所不同。像这样的东西：

-------------------------------------------------- -------- 一些文字 ----------------------------------------- ----------------

我使用表格解决了它：

```
<table width="100%">
  <td><hr /></td>
  <td style="width:1px; padding: 0 10px; white-space: nowrap;">Some text</td>
  <td><hr /></td>
</table>​ 
```

你可以在这里试试：http: [//jsfiddle.net/md2dF/3/](http://jsfiddle.net/md2dF/3/)

从语义上讲，这是一个非常糟糕的解决方案，标题与表格数据无关。如果没有桌子，你会怎么做？

总结一下（因为建议的解决方案都忽略了一个或多个要求）：

*   标题不能有固定宽度
*   标题文字不得有背景
*   标题文字不得有固定宽度
*   文本两侧的线条必须占据所有剩余宽度
*   行和文本之间的填充必须具有固定宽度
*   如果有疑问，请查看[http://jsfiddle.net/md2dF/3/](http://jsfiddle.net/md2dF/3/)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-21T13:50:26.373

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-03-24T07:34:12.133

在不知道宽度和背景颜色的情况下解决此问题的方法如下：

结构

```
<div class="strike">
   <span>Kringle</span>
</div> 
```

CSS

```
.strike {
    display: block;
    text-align: center;
    overflow: hidden;
    white-space: nowrap; 
}

.strike > span {
    position: relative;
    display: inline-block;
}

.strike > span:before,
.strike > span:after {
    content: "";
    position: absolute;
    top: 50%;
    width: 9999px;
    height: 1px;
    background: red;
}

.strike > span:before {
    right: 100%;
}

.strike > span:after {
    left: 100%;
} 
```

示例：http: [//jsfiddle.net/z8Hnz/](http://jsfiddle.net/z8Hnz/)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-09-20T23:52:48.477

# 编辑：

没有任何背景颜色或图像：

```
<div>
    <div><hr></div>
    <span>Some text</span>
    <div><hr></div>
</div>​ 
```

CSS：

```
div {
    width:300px;
    text-align:center;
    display:table;
}
div > div {
    display:table-cell;
    vertical-align:middle;
}
div > span {
    white-space:nowrap;
}​ 
```

适用于 IE8+

**[现场演示](http://jsfiddle.net/gionaf/5pMDK/)**

* * *

# 原答案：

没有任何图像：

```
<div>
<span>Some text</span>
</div>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

CSS：

```
​div {
    border-bottom:1px solid #000;
    line-height:16px;
    text-align:center;
}
span {
    background:#FFF;
    position:relative;
    bottom:-8px; /* half of line-height */
    padding:0 15px;
} 
```

**[现场演示](http://jsfiddle.net/gionaf/4guXD/)**

你可以使用任何你想要的**块**`h1`元素 ( , `h2`, `whatever`) 而不是`div`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-20T23:50:13.640

您可以这样做（对于背景，您可以制作一个 1px 的颜色选择图像）：

```
<h1><span>Some Text</span></h1>

h1 { width: 100%; text-align: center; background: url(pixel.jpg) repeat-x left center; }
h1 span { padding: 0 3px; background-color: #ffffff; } 
```

编辑：没有背景颜色：

```
.hr { width: 100%; height: 40px; line-height: 40px; }
.hr span { width: 10%; text-align: center; float: left; margin: 0; display: inline-block; }
.hr .line { width: 45%; height: 100%; background: url(pixel.jpg) repeat-x left center; float: left; }
.hr .line.right { float: right;}

<div class="hr">
<div class="line left"></div>
<span>Some Text</span>
<div class="line right"></div>
</div> 
```

您需要调整百分比等等，但它通常有效。

# mime-types - Gtk3：获取 mime 类型的图标文件名

> ID：12522456
> 
> 赞同：0
> 
> 时间：2012-09-20T23:38:28.827
> 
> 标签：mime-types, gtk3, gio, command-line-tool

我正在编写一个命令行程序来获取与 mime 类型关联的 Gtk3 图标文件名......这个想法是能够做到这一点：

```
$ ./gtk-mimetype-icon text/html
Mime type: text/html
Icon file: /usr/share/icons/gnome/48x48/mimetypes/text-html.png 
```

不幸的是，这种情况正在发生：

```
$ ./gtk-mimetype-icon text/html

(process:30041): Gtk-CRITICAL **: gtk_icon_theme_get_for_screen: assertion `GDK_IS_SCREEN (screen)' failed

(process:30041): Gtk-CRITICAL **: gtk_icon_theme_lookup_by_gicon: assertion `GTK_IS_ICON_THEME (icon_theme)' failed    
Unable to load icon info, bailing! 
```

在搜索文档和谷歌搜索解决方案后，我对如何继续感到困惑。我在 X 终端中运行它，并正确导出了 DISPLAY：

```
$ env |grep DISPLAY
DISPLAY=:0.0 
```

该程序的来源如下；我正在反对 glib2-2.30.3 和 gtk3-3.2.4。任何见解都值得赞赏！

```
#include <gio/gio.h>
#include <gtk/gtk.h>
#include <stdio.h>
// save as gtk-mimetype.c and build w/:
//   cc -o gtk-mimetype-icon `pkg-config --cflags --libs glib-2.0 gtk+-3.0` gtk-mimetype.c
// cf. http://unix.stackexchange.com/questions/11152/how-to-get-the-icon-for-a-mime-type
int
main (int argc, char **argv)
{
    g_type_init ();
    if (argc < 2) {
        fprintf (stderr, "Usage: %s <mimetype\n", argv[0]);
        return -1;
    }

    GIcon *icon = g_content_type_get_icon (argv[1]);

    GtkIconInfo *icon_info = gtk_icon_theme_lookup_by_gicon (
         gtk_icon_theme_get_default (),
         icon,
         48,
         GTK_ICON_LOOKUP_GENERIC_FALLBACK);

    const char *filename;
    if (icon_info != NULL)
        filename = gtk_icon_info_get_filename (icon_info);
    else {
        fprintf (stderr, "Unable to load icon info, bailing!\n");
        return -1;
    }

    printf ("Mime type: %s\nIcon file: %s\n",
            argv[1],
            filename);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T23:14:46.337

您需要初始化 gtk 框架，替换`g_type_init ();`为`gtk_init(&argc, &argv);`

# php - php xpath用类获取div的内容

> ID：12522465
> 
> 赞同：6
> 
> 时间：2012-09-20T23:40:05.840
> 
> 标签：php, xpath, domdocument

使用 xpath 获取具有某个类的所有 div 的内容的正确语法是什么？我似乎正在获取 div，但我不知道如何获取它们的 innerHTML。

```
 $url = "http://www.vanityfair.com/politics/2012/10/michael-lewis-profile-barack-obama";

    $ctx     = stream_context_create(array('http'=> array('timeout' => 10)));

    libxml_use_internal_errors(TRUE);
    $num = 0;

    if($html = @file_get_contents($url,false,$ctx)){

        $doc   = DOMDocument::loadHTML($html);
        $xpath = new DOMXPath($doc);

        foreach($xpath->query('//div[@class="page-display"]') as $div){
            $num++;
            echo "$num. ";

            //????

            echo "<br/>";
        }

        echo "<br/>FINISHED";

    }else{
        echo "FAIL";
    } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-21T01:58:56.073

class="page-display" div 中没有 HTML - 所以你根本不会得到任何东西。

你的意思是get class="parbase cn_text"吗？

```
 foreach($xpath->query('//div[@class="parbase cn_text"]') as $div){
        $num++;
        echo "$num. ";

        //????
        echo $div->textContent;

        echo "<br/>";
    } 
```

# android - 如何从多个 TextView 中获取“全选”文本？

> ID：12522471
> 
> 赞同：5
> 
> 时间：2012-09-20T23:40:34.747
> 
> 标签：android

TextViews 有`android:TextIsSelectable="true"`. 但是，长按时，用户只能选择与一个 TextView 关联的文本。我该怎么做才能拥有“全选”功能？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T00:16:50.587

Android 没有默认行为允许用户从 Textview 列表中选择文本。

如果你想要这个功能，你需要创建一个监听器来监听你选择的事件，比如长按你的一个文本视图，然后你需要从你的文本视图中获取所有文本并做任何事情你想处理文本。

获得所有文本后，您可以将其全部存储在剪贴板中（[http://developer.android.com/guide/topics/text/copy-paste.html](http://developer.android.com/guide/topics/text/copy-paste.html)）

或者您可以通过对每个文本视图执行以下操作来突出显示每个文本视图中的文本（显然根据需要进行调整）：

```
TextView TV = (TextView)findViewById(R.id.text);
TV.setText("Italic, highlighted, bold.", TextView.BufferType.SPANNABLE);

Spannable WordtoSpan = (Spannable) TV.getText();

WordtoSpan.setSpan(new BackgroundColorSpan(0xFFFFFF00), 8, 19, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);

TV.setText(WordtoSpan); 
```

此外，如果您想为您的用户提供一个自定义选项来完成所有这些操作，那么您可以尝试这个问题中给出的解决方案：[在 TextView 中长按链接时显示上下文菜单](https://stackoverflow.com/questions/2662992/show-context-menu-when-link-is-long-pressed-in-textview)

一旦你这样做了，你可以添加你自己的菜单，然后在选择它时做一些事情。

# css - 为什么 font-family 在此按钮中没有正确级联？

> ID：12522473
> 
> 赞同：6
> 
> 时间：2012-09-20T23:40:43.753
> 
> 标签：css, fonts

链接在这里：

[http://jsfiddle.net/LDEt6/](http://jsfiddle.net/LDEt6/)

第一个 CSS 规则将字体系列`'Helvetica Neue', Helvetica, Arial, sans-serif;`设置为以下 CSS 中的所有其他字体设置，只需声明“继承”。在 Chrome 21 中，我得到“Times”作为计算的字体系列，而在 Firefox 中，我得到了“serif” '。我错过了什么？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-20T23:53:57.600

首先我们有：

```
body {
     font-family : 'Helvetica Neue', Helvetica, Arial, sans-serif;
} 
```

酷，没关系。但是我们有：

```
html, body, input, button, <snipped...> {
     font: inherit;
} 
```

所以`font`被这条规则覆盖，这条规则也适用于身体，现在是`inherit`.

那么继承有什么作用呢？它说“使用分配给我的父元素的样式属性”。在这种情况下，元素的父`<body>`元素是`<html>`没有父元素的。所以根本没有指定的字体系列，所以什么都不能继承。

`inherit`不做的是使用先前为该元素定义的*值*。它继承自父母，而不是以前应用的样式。`inherit`是关于 HTML 结构，而不是 CSS 结构。

最后，您将整个 Universe 设置为从其父代（包括所有父代）继承字体。因此，您永远不会真正找到具有真正设置字体的父级。取而代之的是浏览器应用它的默认字体，这样它就可以渲染*一些东西*。

如果您将`body`字体规则移到那里的巨型重置规则之后，它应该开始工作。然后字体将一直继承到 body 标签，它现在有一个真正的字体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T23:47:02.413

这里：http: [//jsfiddle.net/LDEt6/6/](http://jsfiddle.net/LDEt6/6/)

在一大堆选择器中，您重新声明`body`as `font: inherit`。

# ios - iOS：带有购买进度指示器 UIActivityIndi catorView 的应用内购买

> ID：12522481
> 
> 赞同：2
> 
> 时间：2012-09-20T23:41:49.773
> 
> 标签：ios, in-app-purchase

我在这个板上尝试了几种解决方案，但从未成功。我想要的是当用户单击时`Buy Button`，出现一个`UIAlertView`with`UIActivityIndicatorView`等待应用程序访问应用程序商店。`UIAlertView`但是一旦购买完成，我不知道在哪里可以忽略它。我知道要解雇 a `UIAlertView`，我们使用：`[alert dismissWithClickedButtonIndex:-1 animated:YES];`

所以请你帮我回答两个问题：

1）我的代码是否可以或其他更好的代码来实现它？

2）我应该在哪里解雇`UIAlertView`所有案件：

*   用户接受购买
*   用户取消购买
*   购买不成功

以下是我的代码：

```
-(void)paymentQueue:(SKPaymentQueue *)queue updatedTransactions:(NSArray *)transactions{
    UIAlertView *alert;
    for(SKPaymentTransaction *transaction in transactions){
        switch (transaction.transactionState) {
            case SKPaymentTransactionStatePurchasing:                   
                 alert = [[UIAlertView alloc]initWithTitle: @"In App Purchase" message: @"Processing your purchase..." delegate: nil cancelButtonTitle: nil otherButtonTitles: nil];
                UIActivityIndicatorView *ind = [[UIActivityIndicatorView alloc]initWithActivityIndicatorStyle: UIActivityIndicatorViewStyleWhiteLarge];
                [ind startAnimating];    
                [alert addSubview: ind];
                [alert show];
                [ind release];
                [alert release];
                break;
            case SKPaymentTransactionStatePurchased:
                [[SKPaymentQueue defaultQueue]finishTransaction:transaction];
                UIAlertView *tmp = [[UIAlertView alloc]
                                    initWithTitle:@"Complete"  
                                    message:@"You have bought the full version!"  
                                    delegate:self  
                                    cancelButtonTitle:nil  
                                    otherButtonTitles:@"Ok", nil];  
                [tmp show];  
                [tmp release];
                break;
            case SKPaymentTransactionStateRestored:
                [[SKPaymentQueue defaultQueue]finishTransaction:transaction];
                break;
            case SKPaymentTransactionStateFailed:
                if (transaction.error.code !=SKErrorPaymentCancelled) {
                    [[SKPaymentQueue defaultQueue]finishTransaction:transaction];
                    UIAlertView *tmp = [[UIAlertView alloc]
                                        initWithTitle:@"Error"  
                                        message:@"Purchase not successful!"  
                                        delegate:self  
                                        cancelButtonTitle:nil  
                                        otherButtonTitles:@"Ok", nil];  
                    [tmp show];  
                    [tmp release];              
                }
                [[SKPaymentQueue defaultQueue]finishTransaction:transaction];
                break;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T00:03:29.813

尝试添加

```
case SKPaymentTransactionStatePurchased:
[alert dismissWithClickedButtonIndex:-1 animated:YES]; 
```

和

```
case SKPaymentTransactionStateFailed:
[alert dismissWithClickedButtonIndex:-1 animated:YES]; 
```

# jsp - 如何仅使用 JSP 获取当前时间

> ID：12522484
> 
> 赞同：2
> 
> 时间：2012-09-20T23:42:09.573
> 
> 标签：jsp, jstl

如何仅使用 JSP 获取当前时间？我无法控制 bean，但我想使用当前时间（特别是 24 小时格式的小时数）进行比较。

我有一颗有时间的豆子

```
 ${Qlist.beginTime} <---- e.g. 1440 ( 14:40 ) 
```

我想检查当前时间是否大于该时间。

像这样的东西，除了我需要当前时间：

```
 <c:set var="currentTimein24Format" value="1441"/>
  <c:if test="${Qlist.beginTime<currentTimein24Format}">
      Currently running!
  </c:if> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-21T01:35:02.760

您应该必须使用`<fmt:formatDate>`.

```
<jsp:useBean id="date" class="java.util.Date"/>

<fmt:formatDate var="time"  
                value="${date}"
                pattern="HHmm"/>
<br/>${time} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T07:50:34.777

我不会在 JSP 中做那种逻辑。最好在您的 bean 中执行此操作：

```
public boolean isRunning(){
  return this.beginTimeInt < currentTimeInt;
} 
```

所以你可以在 JSP 中这样使用它：

```
<c:if test="${myBean.running}">
  It's running!
</c:if> 
```

为什么这样更好？假设您需要更多要求才能使 bean 运行，例如它需要被批准并且它有一个结束时间。然后，您需要在 JSP 中检查 bean 是否正在运行的任何地方添加条件，而如果您的 bean 中有逻辑，这将意味着只是一个简单的更改。因此，您的灵活性较差，您的 JSP 将变得不那么可读。

# ruby-on-rails - RSpec 控制器规范中的类型错误

> ID：12522488
> 
> 赞同：0
> 
> 时间：2012-09-20T23:42:36.443
> 
> 标签：ruby-on-rails, rspec2, rspec-rails

我在进行 RSPec 测试时遇到问题。测试对请求中的一些对象执行 PUT。接收 PUT 的控制器似乎没有得到正确的值

例如，'put :update, :id => @channel.id, :channel => @channel, :tags => @tag' 然后，在控制器中，当我尝试使用 params[:tags] 时，会有一个该位置的整数。带有规范和控制器方法的要点位于[https://gist.github.com/3715021](https://gist.github.com/3715021)

当我从 Rails 3.0.13 升级到 3.1.8 时，这种情况开始发生

知道这里可能会发生什么以及如何解决吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T14:02:27.573

我假设这`@tag`是您的 Tags 模型中的一个对象。当你给 Rails 一个像

```
`get :action, :foo => foo` 
```

或在 url 助手中（例如，`foo_path(foo)`），

Rails 将通过该方法将您的对象转换为适合在 url 中使用的参数`#to_param`。你可能得到一个整数，因为`Tag#to_param`返回你的数据库中标签的 id。

相比之下，您的更新操作看起来像是`params[:tags]`一个散列，大概是从一个包含诸如`tags[:name]`.

如果不了解更多相关代码，我将无能为力。但我猜你想要做的是改变你的测试阅读

```
put :update, :id => @channel.id, :channel => @channel, :tags => { :name => 'tag' } 
```

或类似的东西，通过实际提交 PUT 到更新操作的表单来模仿您获得的参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T01:36:19.733

这很难为您提供帮助，因为我们不知道您要做什么。例如，如果您显示更多的测试（例如，您设置为变量的值）和测试的具体结果，将会很有帮助。

无论如何，@tags 变量是 arel 对象吗？如果是这样，您是否希望将 ID 作为要传递的值？如果没有，那么您可能想要指定@tags 中引用的属性。例如，@tags.name... 或者，@tags 本身是否引用哈希？

# collections - 为什么 Meteor 抱怨集合的插入方法已经定义？

> ID：12522490
> 
> 赞同：7
> 
> 时间：2012-09-20T23:43:02.200
> 
> 标签：collections, coffeescript, meteor

谁能告诉我为什么下面的代码会引发以下错误？：

```
Error: A method named '/players/insert' is already defined 
```

我是 Meteor 和 coffeescript 的新手，所以我可能会忽略一些简单的东西。

这是我将排行榜示例移植到咖啡脚本的端口：

```
###
Set up a collection to contain player information. On the server,
it is backed by a MongoDB collection named "players."
###
Players = new Meteor.Collection("players")

if Meteor.is_client
  Template.leaderboard.players = ->
    Players.find({}, {sort: {score: -1, name: 1}})

  Template.leaderboard.selected_name = ->
    player = Players.findOne(Session.get "selected_player")
    player and player.name

  Template.player.selected = -> if Session.equals("selected_player", this._id) then "selected" else ''

  Template.leaderboard.events = {
    'click input.inc': ->
      Players.update(Session.get("selected_player"), {$inc: {score: 5}})
  }

  Template.player.events = {
    'click': ->
      Session.set("selected_player", this._id)
  }

# On server startup, create some players if the database is empty.
if Meteor.is_server
  Meteor.startup ->
    if Players.find().count() is 0
      names = [
                "Ada Lovelace"
                "Grace Hopper"
                "Marie Curie"
                "Carl Friedrich Gauss"
                "Nikola Tesla"
                "Claude Shannon"
              ]
      Players.insert({name: name, score: Math.floor(Math.random()*10)*5}) for name in names 
```

完整的堆栈跟踪如下：

```
[[[[[ ~/dev/meteor/leaderboard ]]]]]

Running on: http://localhost:3000/

node.js:201
        throw e; // process.nextTick error, or 'error' event on first tick
              ^
Error: A method named '/players/insert' is already defined
    at app/packages/livedata/livedata_server.js:744:15
    at Function.<anonymous> (app/packages/underscore/underscore.js:84:24)
    at [object Object].methods (app/packages/livedata/livedata_server.js:742:7)
    at new <anonymous> (app/packages/mongo-livedata/collection.js:111:13)
    at app/leaderboard.js:4:11
    at /Users/alex/dev/meteor/leaderboard/.meteor/local/build/server/server.js:109:21
    at Array.forEach (native)
    at Function.<anonymous> (/Users/alex/dev/meteor/leaderboard/.meteor/local/build/server/underscore.js:76:11)
    at /Users/alex/dev/meteor/leaderboard/.meteor/local/build/server/server.js:95:7
Exited with code: 1 
```

我正在运行 Meteor 版本 0.4.0 (8f4045c1b9)

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-23T16:43:42.140

如果您复制文件，无论使用咖啡脚本还是纯 javascript，您也会收到此错误。例如，将源文件复制到名为 Backup 的子目录会产生此错误，因为 Meteor 会合并子目录中的文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T14:45:49.000

这似乎是 coffeelint 的配置问题（使用 npm 全局安装）。

我最初安装了 coffeelint 来检查我的咖啡脚本代码是否正确并且没有错误。

我按照说明安装了 coffeelint：

`sudo npm install -g coffeelint`

对 .coffee 文件单独运行时，coffeelint 运行良好。

但是，当运行任何添加了 coffeescript 包的 Meteor 项目时，我得到了上述错误。

一时兴起，我认为该错误可能是由于与我现有的节点安装冲突。

我决定先卸载 coffeelint：

`sudo npm uninstall -g coffeelint`

然后删除了之前meteor生成的leaderboard.js文件。

重新启动流星后，上面的咖啡脚本示例按预期工作，没有错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-20T16:10:11.310

尝试移动（即复制和删除原件）

`Players = new Meteor.Collection("players")`

下一次 `if Meteor.is_client` ，下一次`if Meteor.is_server`

我不知道确切原因，因为我也是 Meteor 的新手，但这对我有用，我认为服务器端需要它自己的引用以及客户端，尽管在范围之外声明应该做同样的事情（也许是一个错误，请记住它们仍处于 0.5.0 预览版，这让我认为您可能想要升级并尝试一些新版本的新智能包，看起来您使用的是 0.4），但是当文件在我的服务器中无法识别任何东西我定义了流星的根目录（它将这些文件推送到客户端和服务器），我定义了服务器自己的引用，我得到了同样的错误，直到我移动了“公共”声明参考给服务器和客户端各自的副本，没有任何效果。

希望这会有所帮助...

# orientation - 在 iOS 6.0 下呈现 UIImagePickerController 时崩溃

> ID：12522491
> 
> 赞同：41
> 
> 时间：2012-09-20T23:43:09.757
> 
> 标签：orientation, landscape, ios6

`supportedInterfaceOrientation`我的应用程序仅通过属性支持横向。

使用 iOS 6 之前的 iOS，我的应用程序可以成功加载`UIImagePickerController`via的实例，`presentViewController:animated:completion:`即使它`UIImagePickerController`本身只支持纵向。

图像选择器只是向用户展示自己。用户旋转手机，选择他们的图像，然后旋转回横向。

在 iOS 6.0 下，`presentViewController:animated:completion:`使用`UIImagePickerController`实例调用会使应用程序崩溃。我可以通过向我的`supportedInterfaceOrientation`属性添加肖像选项来防止崩溃。

但是，纵向操作对我的应用程序来说确实没有意义。我原以为我可以`shouldAutorotateToInterfaceOrientation`用来让应用程序“支持纵向”，但只能在这个视图中旋转到纵向。但现在该方法已被弃用，我不能使用与 shouldAutorotate 相同的技术。

有谁知道如何在 iOS 6.0 下解决这个问题？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2012-09-25T01:24:18.220

## iOS 6.1 - 已修复

从 iOS 6.1 开始，**这不再发生**，遵循我的提示以避免在 iOS 6.0.x 下崩溃非常重要，以下仍然适用。

* * *

## iOS 6.0.x 解决方法

这实际上是 iOS 6.0 中的一个错误，应该在未来的 iOS 版本中修复。

Apple 的工程师在此处解释了此错误和解决方法：[https ://devforums.apple.com/message/731764](https://devforums.apple.com/message/731764)

发生这种情况是因为应用程序只需要横向，但一些 Cocoa 触摸视图控制器要求严格的纵向方向，这是错误的 - 不是他们应该需要更多的纵向，而是他们对应用程序要求的解释。

这方面的一个例子如下：

> 支持横向的 iPad 应用程序仅通过 UIPopoverController 显示 UIImagePickerController。UIImagePickerController 需要纵向，但应用程序仅强制横向。错误和...崩溃

其他被报告为有问题的框架包括 Game Center 登录视图控制器。

解决方法非常简单但并不理想......您保留在 info.plist/project 信息窗格中声明的正确方向，但在 Application Delegate 类中您声明您允许所有方向。

现在，您添加到窗口的每个 View Controller 都必须指定它自己只能是 Landscape。请检查链接以获取更多详细信息。

* * *

我不能强调你不应该将多少子类`UIImagePickerController`化，因为公认的解决方案坚持你这样做。

![在此处输入图像描述](../Images/cb37c993d504dceebc9dcbbfe5f20030.png)

这里重要的是“**此类旨在按原样使用，不支持子类化**。”

* * *

在我的情况下，我将此添加到我的应用程序的委托（我有一个仅限横向的应用程序），这告诉图像选择器它可以显示，因为支持纵向：

```
- (NSUInteger)application:(UIApplication *)application supportedInterfaceOrientationsForWindow:(UIWindow *)window{
    return UIInterfaceOrientationMaskAll;
} 
```

然后在我碰巧是的视图控制器中`UINavigationController`，我包含了一个包含以下内容的类别：

```
- (NSUInteger)supportedInterfaceOrientations{
    return UIInterfaceOrientationMaskLandscape;
} 
```

现在我的应用程序没有旋转，图像选择器询问代理它是否可以显示为纵向，它被告知没关系。所以一切都很好。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2012-09-21T03:39:33.030

我有一个类似的问题，但在 iPad 横向应用程序中。我在弹出窗口中展示了图像选择器。它在 iOS 6 下崩溃。错误表明选择器想要纵向，但该应用程序只提供横向视图，并且......重要的是......选择器的 shouldRotate 返回 YES。

我将此添加到创建选择器的 ViewControllerClass.m

```
@interface NonRotatingUIImagePickerController : UIImagePickerController

@end

@implementation NonRotatingUIImagePickerController

- (BOOL)shouldAutorotate
{
    return NO;
}

@end 
```

然后改用那个类

```
UIImagePickerController *imagePicker = [[NonRotatingUIImagePickerController alloc] init];
[myPopoverController setContentViewController:imagePicker animated:YES]; 
```

这为我解决了问题。你的情况有点不同，但听起来基本上是相同的错误。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2012-09-24T18:12:12.540

虽然继承 UIImagePickerController 有效，但类别是更好的解决方案：

```
 @implementation UIImagePickerController (NonRotating)

    - (BOOL)shouldAutorotate
    {
        return NO;
    }

    -(UIInterfaceOrientation)preferredInterfaceOrientationForPresentation
    {
        return UIInterfaceOrientationPortrait;
    }

    @end 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-20T09:44:15.367

来自 iOS 7.1 的报告：

除了上述答案指定的内容之外，您似乎必须在 info.plist 中绝对启用纵向模式。

如果没有这个，上述代码/修复都没有对我有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-07-01T11:26:25.067

```
-(NSUInteger)supportedInterfaceOrientations
{
   return UIInterfaceOrientationMaskLandscape;
} 
```

将解决此问题，但来自 iOS7

# css - 在现代非 IE-quirksmode 浏览器中覆盖 font-size 关键字的含义

> ID：12522493
> 
> 赞同：1
> 
> 时间：2012-09-20T23:43:24.907
> 
> 标签：css, internet-explorer, font-size, quirks-mode

我正在重写一个允许用户通过所见即所得编辑器提交 html 片段的网络应用程序。该网络应用程序从一开始就被设计为仅限 IE 和仅限 quirksmode。因此，用户提交的 html 在设计时就考虑到了这一点。

例如，一个数据项包括以下 html：

```
<span style="font-size:small">Element name here</span> 
```

`font-size:medium`它在 quirksmode （用户设计的方式）中错误地呈现，但`font-size:small`在所有其他浏览器中正确呈现，包括标准模式下的 IE。

我正在强制 IE 进入标准模式，但我仍然希望应用程序对现有用户看起来相同，因此我正在寻找一种方法来覆盖现代浏览器中的字体大小关键字，以表示它们在 quirksmode 中所做的事情。换句话说，我希望现代浏览器错误地将文本呈现为`font-size:medium`. 我将所有当前用户提交的 html 包含在具有“旧用户内容”类或类似内容的容器中。

现在我愿意诉诸严厉的黑客来完成这件事。有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-09T01:54:21.423

使用媒体查询来做到这一点：

```
@media { 
       .old-user-content { font-size: medium } 
       } 
```

# cab - windows mobile 6.5 的 cab 安装不成功。日志中没有错误详细信息

> ID：12522494
> 
> 赞同：1
> 
> 时间：2012-09-20T23:43:38.567
> 
> 标签：cab, windows-mobile-6.5

我有一个配置文件 setup.xml，我想将它安装在 windows mobile 6.5 手机上。我创建了一个 cab 文件，签名并复制到手机，然后运行 ​​cab 文件。但是我得到：'安装 foo.cab 不成功'</p>

我转到 Application Data\Volatile\setup.log 该日志仅包含 setup.xml 文件，但没有错误详细信息或消息。如何知道失败的原因？

# api - force.com 流媒体 API

> ID：12522498
> 
> 赞同：1
> 
> 时间：2012-09-20T23:45:17.697
> 
> 标签：api, streaming, force.com

我正在尝试[Force.com Streaming API 演示](http://www.salesforce.com/us/developer/docs/api_streaming/api_streaming.pdf)，但出现以下错误：

```
<?xml version="1.0" encoding="UTF-8"?>
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:sf="urn:fault.partner.soap.sforce.com" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <soapenv:Body><soapenv:Fault>
        <faultcode>UNKNOWN_EXCEPTION</faultcode>
        <faultstring>UNKNOWN_EXCEPTION: Element type &quot;soapenv:Envelope&quot; must be followed by either attribute specifications, &quot;&gt;&quot; or &quot;/&gt;&quot;.   </faultstring>
        <detail>
            <sf:UnexpectedErrorFault xsi:type="sf:UnexpectedErrorFault">   
                <sf:exceptionCode>UNKNOWN_EXCEPTION</sf:exceptionCode>
                <sf:exceptionMessage>Element type &quot;soapenv:Envelope&quot; must be followed by either attribute specifications, &quot;&gt;&quot; or &quot;/&gt;&quot;.</sf:exceptionMessage>
            </sf:UnexpectedErrorFault>  
        </detail> 
    </soapenv:Fault></soapenv:Body>
</soapenv:Envelope> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-16T04:48:35.793

第 22 行有一个错位的[双引号](http://www.salesforce.com/us/developer/docs/api_streaming/api_streaming.pdf)，您的编译器没有捕捉到它。

替换此代码：

```
private static final String ENV_START =
"
"<soapenv:Envelope xmlns:soapenv='http://schemas.xmlsoap.org/soap/envelope/'
         + "xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' " +
         "xmlns:urn='urn:partner.soap.sforce.com'><soapenv:Body>"; 
```

使用此代码：

```
private static final String ENV_START =
    "<soapenv:Envelope xmlns:soapenv='http://schemas.xmlsoap.org/soap/envelope/'"
    + "xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' " +
         "xmlns:urn='urn:partner.soap.sforce.com'><soapenv:Body>"; 
```

# android - 在 Android API < 11 上使用 listView.MultiSelectChoiceModeListener

> ID：12522502
> 
> 赞同：1
> 
> 时间：2012-09-20T23:46:04.267
> 
> 标签：android, listview, multi-select

有没有办法在低于 11 的 Android API 级别的 ListView 中启用批量上下文操作？上下文 ActionBar 与 ActionBarSherlock 配合得很好。

还是我需要做一个自定义实现？（我是 IT 人，我想要最简单的方法）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-06T16:41:49.757

如果没有自定义实现，它就无法工作。

# c++ - 尝试将 time_t 数据类型转换为 (dd/mm/yyyy) 格式 C++

> ID：12522503
> 
> 赞同：0
> 
> 时间：2012-09-20T23:46:12.230
> 
> 标签：c++, time

我的问题几乎在标题中。我有一个带有类型参数的函数调用`time_t`，我需要将一个变量初始化为今天的日期、月份和年份，并通过参数发送它。例如，

```
void WebCall(time_t TodaysDate) 
```

包含斜杠`TodaysDate`的格式的填充变量在哪里。`DD/MM/YYYY`这可能吗？我无法将数据类型从`time_t`to`SYSTEMTIME`或其他任何东西更改。这是用 C++ 编码的。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T15:37:21.863

`time_t`是“unix 时间”，是[从 UTC 时间 1970 年 1 月 1 日 00:00 开始经过的秒数](http://www.cplusplus.com/reference/clibrary/ctime/time_t/)。正如 MSN 回答的那样，您可以使用 将其转换为日期`gmtime`，[对于最常见的目的，UTC 是 GMT 的同义词](http://en.wikipedia.org/wiki/Coordinated_Universal_Time)。您没有在问题中指定，但如果您需要本地日期使用`localtime`而不是`gmtime`. 这是一个可以为您执行此操作并返回 std::string 的函数：

```
#include <time.h>
#include <string>

std::string time_to_local_date( time_t utc )
{
    struct tm *now = localtime(&utc);
    char buffer[80];
    strftime(buffer, 80, "%d/%m/%Y", now);
    return std::string(buffer);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-20T23:59:42.763

如果你的意思是`time_t`，你可以使用`gmtime`和格式化它`strftime`：

```
time_t TodaysDate= ...;
struct tm * ptm= gmtime(&time);
char buffer[80];
strftime(buffer, 80, "%d/%m/%Y", ptm); 
```

# c - 在C中按下特定键时单击鼠标

> ID：12522504
> 
> 赞同：0
> 
> 时间：2012-09-20T23:46:15.053
> 
> 标签：c, windows, click, mouse

我最近开始在 Digipen 上大学，并且已经从所有的写作/编码/等方面开发了腕管......但对我来说幸运的是，我正在学习成为一名程序员，并且已经制作了一些程序来协助诸如打开命令提示符/bat 文件更快/无需单击等。

由于单击鼠标对我来说比打字困难得多，因此我想制作一个仅在后台运行的简单程序，并在我按下键盘上的特定键时为我单击鼠标。不过，我真的不知道从哪里开始，到目前为止，除了标准 c 之外，我从未使用过任何东西。此外，能够通过按键移动鼠标有时也很方便。

谢谢您的帮助。:)

哦，我可能应该提到我将在 windows vista 和 7 上使用它，当然我将是唯一使用它的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T00:12:35.037

首先，您必须使用**GetCursorPos(&p) 找到鼠标光标位置（在屏幕坐标中）**。**然后您可以使用WindowFromPoint(...)**找到鼠标光标下的窗口。然后您可以使用**SendMessage(...)**将“鼠标按下”和“鼠标按下”消息发送到该窗口......这是一篇关于在 Windows 中挂钩键盘事件的好[文章。](http://www.codeproject.com/Articles/1264/KeyBoard-Hooks)

# php - SQL 查询不区分大小写

> ID：12522505
> 
> 赞同：1
> 
> 时间：2012-09-20T23:46:16.530
> 
> 标签：php, mysql

我正在尝试创建一个系统来验证用户的用户名和密码。我目前在检查用户名时遇到问题...如果某人的用户名是 Burrito，当我通过查询查看它是否在数据库中时，它不会检查字母的大小写是否正确。示例：用户名是 Michael 他们可以输入 michael 或 MiChAeL，它仍然会认为它是相同的用户名。

这是我用来检查用户名的内容：

```
$isValid = mysql_query("SELECT username FROM " . getSQL_Info(3) . " WHERE username = '" . $user . "'"); 
```

感谢您的时间和帮助。另外，如果您发现我的代码有任何问题，如果有更好的地方，请告诉我 :)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-20T23:49:48.073

您需要检查您的 MySQL 编码类型。如果是`utf8_general_ci`or `latin1_swedish_ci`（或任何以 结尾的`_ci`），则不区分大小写。

您可以通过更改表编码或使用以下方法来解决此问题：

```
SELECT username FROM table WHERE BINARY username = :username 
```

我会推荐形式。

相关：[如何在 MySQL 上进行 SQL 区分大小写的字符串比较？](https://stackoverflow.com/questions/5629111/mysql-case-sensitive-string-comparison)

> 另外，如果您发现我的代码有任何问题，如果有更好的地方，请告诉我 :)

*   您正在使用已弃用的`mysql_*`功能
    *   [http://php.net/manual/en/book.pdo.php](http://php.net/manual/en/book.pdo.php)
    *   [http://php.net/manual/en/book.mysqli.php](http://php.net/manual/en/book.mysqli.php)
*   我在您的代码中看不到任何转义

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-20T23:53:07.603

*   您正在使用已弃用的 mysql 函数
*   注意安全
*   你的问题的解决方案是

    SELECT * FROM foo WHERE (BINARY username="someNaMe")

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-21T06:25:23.307

使用 Collat​​e 比较区分大小写的字符串。这是[MySQL手册的链接](http://dev.mysql.com/doc/refman/5.0/en/case-sensitivity.html)

# c# - 该进程无法访问文件“...”，因为它正被另一个进程使用

> ID：12522507
> 
> 赞同：0
> 
> 时间：2012-09-20T23:46:27.623
> 
> 标签：c#, io, stream, streamreader, streamwriter

> **可能重复：**
> [打开流读取器时出错，因为文件被另一个进程使用](https://stackoverflow.com/questions/2730565/error-opening-streamreader-because-file-is-used-by-another-process)

在 C# 中，我正在尝试构建一个程序，该程序将文本文件中列出的一定数量的文件或目录从一台计算机复制到同一网络上的另一台计算机（例如，从“\PC_OF_MARK”到“\PC_OF_SARAH”）但是，在打开和关闭 StreamReader 之后，我似乎被困在使用流写入器打开流。

在我能够复制任何东西之前，我需要能够用我的程序编辑“files.txt”的内容。

在我的表单上，我有 4 个按钮：添加、删除、关闭和复制。我还有一个 ListBox lbItems，其中包含“files.txt”中的行。

该程序位于 Delete 函数中：要从“files.txt”中删除一行，我读取 lbItems 的内容并将它们存储在 List 中。接下来，我删除列表中与 lbItems 中的选定项具有相同索引的字符串。最后，我想通过打开 StreamWriter（这是发生错误的地方）并用新列表覆盖“files.txt”来更新“files.txt”。

“files.txt”包含这两行：

"%UserProfile%\Documents\files.txt" & "%UserProfile%\Downloads\RubiksCube"

```
public partial class Form1 : Form
{

    List<string> envKeys = new List<string>();
    List<string> envValues = new List<string>();

    public Form1()
    {
        InitializeComponent();
    }

    private void btnClose_Click(object sender, EventArgs e)
    {
        this.Close();
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        IDictionary ev = Environment.GetEnvironmentVariables();
        foreach (DictionaryEntry de in ev)
        {
            envKeys.Add("%" + de.Key.ToString() + "%");
            envValues.Add(de.Value.ToString());
        }
        syncList();
    }

    private void syncList()
    {
        StreamReader r = new StreamReader(@"C:\Users\Eigenaar\Documents\files.txt");
        string line = r.ReadLine();
        while (line != "")
        {
            lbItems.Items.Add(line);
            line = r.ReadLine();
        }
        r.Close();
    }

    private void btnRemove_Click(object sender, EventArgs e)
    {

        if (lbItems.SelectedIndex != -1)
        {
            if (MessageBox.Show("Ben je zeker dat je " + lbItems.Items[lbItems.SelectedIndex] + " uit de lijst wil verwijderen?", "Warning", MessageBoxButtons.YesNo, MessageBoxIcon.None) == DialogResult.Yes)
            {
                List<string> array = new List<string>();
                using (StreamReader r = new StreamReader(@"C:\Users\Eigenaar\Documents\files.txt"))
                {
                    string line = r.ReadLine();
                    while (line != null)
                    {
                        array.Add(line);
                        line = r.ReadLine();
                    }
                    string t = r.ReadToEnd();
                }

                array.RemoveAt(lbItems.SelectedIndex);

                //Error occurs here:
                using (StreamWriter w = new StreamWriter(@"C:\Users\Eigenaar\Documents\files.txt", false))
                //The process cannot access the file 'C:\Users\Eigenaar\Documents\files.txt' because it is being used by another process.
                {
                    foreach (string str in array)
                    {
                        w.WriteLine(str);
                    }
                }
                lbItems.Items.RemoveAt(lbItems.SelectedIndex);
            }
        }
    } 
} 
```

如果有人知道我在说什么，请帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T23:59:26.133

我认为你的问题是第一个

```
using(StreamReader r = new StreamReader(@"C:\Users\Eigenaar\D... 
```

`using`应该导致流被处理，但这可能没有足够快地关闭流，我会尝试在第一个块`r.Close()`的末尾添加。`using`这可能会确保手柄已释放，以便您可以再次打开它。

如果这不起作用，您可以尝试将文件作为读取共享打开，这样它就不会被锁定。

# android - ExpandableListView Android + 过滤EditText

> ID：12522509
> 
> 赞同：3
> 
> 时间：2012-09-20T23:46:41.380
> 
> 标签：android, filter, android-edittext, expandablelistview

我想`ExpandableListView`在 android 中使用过滤数据`EditText`，验证`adapter`应该实现但由于缺乏过滤数据知识`Filtering`而不知道**如何完成此实现。**我的适配器的结构是：

```
 public class ExpandableListAdapter extends
        BaseExpandableListAdapter /*implements Filterable*/ {

    private final Context myContext;

    private String[] arrayTopics;
    private String[][] arraySubTopics;

    public PrimeirosSOSExpandableListAdapter(Context context) {
        this.myContext = context;
    }

    public ExpandableListAdapter(Context context,
            String[] arrayTopics, String[][] arraySubTopics) {
        this.myContext = context;
        this.arrayTopics = arrayTopics;
        this.arraySubTopics = arraySubTopics;

    }

    public Object getChild(int groupPosition, int childPosition) {
        return null;
    }

    public long getChildId(int groupPosition, int childPosition) {
        return 0;
    }

    public View getChildView(int groupPosition, int childPosition,
            boolean isLastChild, View convertView, ViewGroup parent) {

        if (convertView == null) {
            LayoutInflater inflater = (LayoutInflater) myContext
                    .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            convertView = inflater.inflate(R.layout.child_layout,
                    null);
        }

        TextView tv = (TextView) convertView.findViewById(R.id.tvChild);
        tv.setText(arraySubTopics[groupPosition][childPosition]);

        return convertView;
    }

    public int getChildrenCount(int groupPosition) {
        return arraySubTopics[groupPosition].length;
    }

    public Object getGroup(int groupPosition) {
        return null;
    }

    public int getGroupCount() {
        return arrayTopics.length;
    }

    public long getGroupId(int groupPosition) {
        return 0;
    }

    public View getGroupView(int groupPosition, boolean isExpanded,
            View convertView, ViewGroup parent) {

        if (convertView == null) {
            LayoutInflater inflater = (LayoutInflater) myContext
                    .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            convertView = inflater.inflate(R.layout.group_layout,
                    null);
        }

        TextView tv = (TextView) convertView.findViewById(R.id.tvGroup);
        tv.setText(arrayTopics[groupPosition]);

        return convertView;
    }

    public boolean hasStableIds() {
        return false;
    }

    public boolean isChildSelectable(int groupPosition, int childPosition) {
        return true;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-16T00:09:43.840

我自己对 Android 的这一部分不太了解，因为我很新，但我确实在我的研究中看到了关于 CursorTreeAdapter 的另一个问题。它内置了一些用于过滤的方法。这是有关它的Android API信息。CursorTreeAdapter 可以与 ExpandableListView 一起使用。

[http://developer.android.com/reference/android/widget/CursorTreeAdapter.html](http://developer.android.com/reference/android/widget/CursorTreeAdapter.html)

# jquery - jQuery中的滑动事件

> ID：12522513
> 
> 赞同：0
> 
> 时间：2012-09-20T23:47:08.340
> 
> 标签：jquery, mobile

我正在使用 jQuery 的 mousewheel 插件在鼠标滚动上运行一些动画，并且我正在寻找最简单/最干净的方法来简单地将滑动手势添加到现有代码以在平板电脑上使用。

什么是推荐的插件/库来完成这个？我不认为我只想为这一节加载整个 jquery 移动库，所以我正在寻找一个类似于 mousewheel 插件的小插件（如果存在的话）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T23:50:35.797

刷卡不是一个事件，而是以下的组合：

```
1) touchstart
2) touchmove
3) touchend 
```

你可以建立你的算法来决定是否有“滑动”以及在哪个方向。

阅读此内容：http: [//developer.apple.com/library/ios/#documentation/AppleApplications/Reference/SafariWebContent/HandlingEvents/HandlingEvents.html](http://developer.apple.com/library/ios/#documentation/AppleApplications/Reference/SafariWebContent/HandlingEvents/HandlingEvents.html)了解更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T23:50:57.263

您不需要整个 jquery mobile，他们有一个非常酷的[**自定义下载构建器**](http://jquerymobile.com/download-builder/)，您可以在其中选择您想要的组件。

# magento - Magento getProductUrl() 总是返回 HTTP

> ID：12522529
> 
> 赞同：5
> 
> 时间：2012-09-20T23:50:19.897
> 
> 标签：magento

即使我使用 HTTPS，Magento 的 getProductUrl() 似乎总是返回一个 HTTP URL。有什么方法可以自动切换到 HTTPS？（或让它返回相对协议 url）。

我会说这是一个相当“标准”的配置。

基本 URL 是[http://example.com/](http://example.com/)

安全 URL 是[https://example.com/](https://example.com/)

在前端使用安全 URL 是否

基本链接 URL 是 {{unsecure_base_url}}

我知道我可以将上面的内容更改为 {{secure_base_url}} 但是我不想强制从 HTTP 更改为 HTTPS，我只需要它保持相对。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-24T09:29:34.123

Magento 的主要好处是你可以用它做任何你想做的事情:) 所以，是的，你可以输出 HTTPS 产品 url 或相关的。但是，在选择解决方案之前，让我们考虑一下 Magento 作者的愿景。

前端的 HTTPS 仅适用于特定领域，如客户帐户、支付方式、结帐等。产品没有什么私密性，因此也需要通过 HTTPS 进行查看。

默认情况下，Magento 甚至对上面提到的页面也不使用 HTTPS。为了打开 HTTPS，“在前端使用安全 URL”选项必须设置为“是”。如前所述，它将仅在包含一些私人数据的有限页面集中使用 HTTPS。

因此，最适合您的解决方案取决于您正在开发的商店的具体情况。

1) 如果您想为前端的所有页面启用 HTTPS - 那么最好的解决方案是将“https://...”放入“不安全”网络 URL 配置的“基本 URL”选项中。

2) 如果您只想为产品链接和有限数量的页面打开 HTTPS，那么您可以覆盖该页面的模板以放置相对 url。实际的代码可以用任何你喜欢的方式实现，即使是最简单的已经提出的方式也可以：

```
echo trim($_product->getProductUrl(),'http:') 
```

3）如果你想在前端为所有产品链接使用 HTTPS - 那么最好的方法是覆盖`Mage_Catalog_Module_Product_Url`模型和更改方法`getUrl()`- 你需要放在那里

```
$routeParams['_secure'] = true; 
```

这将生成所有使用 HTTPS 协议的产品 URL。

4）如果你需要只在HTTP页面显示HTTP产品链接，而HTTPS产品链接只在HTTPS页面显示，那么你可以使用方法3），逻辑更复杂：在设置'_secure'参数之前检查当前页面的协议。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T00:22:23.223

我只是用原始的方式来做，有时效果最好：

```
echo trim($_product->getProductUrl(),'http:') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-29T09:55:33.203

反而

```
$product->getProductUrl() 
```

尝试

```
$product->getUrlModel()->getUrl($product, array('_secure'=>(bool)Mage::app()->getStore()->isCurrentlySecure())) 
```

这会根据您当前的协议为您提供一个安全/不安全的产品 URL。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2014-12-23T12:14:16.200

在 System | 中有一个低调但重要的选项。配置 | Web ~ 你必须说“在前端使用安全 url”——如果你将它设置为 yes，那么 https 加载的页面将使用 https 链接，

大多数情况下无需编写代码或提供额外配置

# ruby - 使用 EventMachine 进行 OAuth 的 Ruby gem？

> ID：12522530
> 
> 赞同：1
> 
> 时间：2012-09-20T23:50:24.877
> 
> 标签：ruby, oauth

我正在尝试将 em-http-request 与 OAuth 一起使用。似乎[em-http-oauth-request](https://github.com/draconis/em-http-oauth-request)已经过时了。

有谁知道执行异步 OAuth 请求的简单方法？

# html - html5 标签

> ID：12522535
> 
> 赞同：4
> 
> 时间：2012-09-20T23:51:25.480
> 
> 标签：html

在 HTML 5 中使用`<aside>`标签时，我们需要为其添加`float:right`（或`left`）属性吗？因为大多数时候，它被用作侧边栏，我想。

这是基本问题，但我只想找出正确的使用方法。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-20T23:55:42.363

你不需要添加任何东西。HTML 是一种定义文档结构的语言。您应该根据它们的语义含义来选择 HTML 标签，而不是它们的显示方式，这就是 CSS 的用途。

您将使用一个`<aside>`标签，其中包含的内容是页面主要内容的辅助。

为了进一步阐述我的解释，`<div>`, `<header>`, `<footer>`, `<main>`, `<article>`, `<nav>`, `<aside>`, 和`<section>`都呈现相同的，但它们的语义却大不相同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-20T23:55:32.907

该`aside`元素之所以没有被调用，是因为它的定位是为了包含次要内容而得名。它可以以任何您喜欢的方式设置样式，但应该根据其内容在语义上放置在您的 DOM 中。

[阅读](http://html5doctor.com/aside-revisited/)关于 Html5Doctor的优秀文章以获得进一步的解释。

# javascript - Github gist 编辑而不更改 URL

> ID：12522539
> 
> 赞同：36
> 
> 时间：2012-09-20T23:52:49.087
> 
> 标签：javascript, url, github, edit

我在标签中有一些 javascript 代码的要点`script`，如下所示：

```
<script src="https://raw.github.com/gist/b25dff23c2c4b4bd425a/f157aa95163311c4b58febb06b49ffd16419f642/images.js"></script> 
```

我需要继续编辑 github 上的 JS 文件。但是，当您编辑要点时，它会更改要点的 URL。如何保持相同的 URL？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-09-16T19:05:19.523

Gist 更改了此文件模式的路径：

```
https://gist.github.com/<USER_NAME>/<GIST_ID>/raw/<GIST_REVISION_ID>/<GIST_FILE_NAME> 
```

您会注意到，现在热门答案的链接是 404 的。

只需应用这个新模式，瞧！

```
https://gist.github.com/<USER_NAME>/<GIST_ID>/raw/<GIST_FILE_NAME> 
```

例如：

[https://gist.githubusercontent.com/wesbos/cd16b8b1815825f111a2/raw/lol.js](https://gist.githubusercontent.com/wesbos/cd16b8b1815825f111a2/raw/lol.js)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-01-25T20:17:16.580

在 gist 的情况下，
`https://raw.github.com/gist/[gist_id]`OR
`https://gist.github.com/[user_name]/[gist_id]/raw`（更可能是唯一的 URI。）
从 gist 返回第一个文件。

对于具有多个文件的要点，https://raw.github.com/gist/[gist_id]/[file_name]

即使您更改文件名，该 url 仍然有效。

例如[https://raw.github.com/gist/4636655](https://raw.github.com/gist/4636655) [https://raw.github.com/gist/4636655/imdb-getglue.js](https://raw.github.com/gist/4636655/imdb-getglue.js)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-06-23T16:59:18.400

只需添加`/raw`到您的 gist 网址的末尾即可。

```
https://gist.github.com/--user--/--id--/raw 
```

这链接到该文件的最新版本。

更新 gist 文件后，更改会在一两分钟后反映出来。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-09-20T23:53:44.200

您不能在不提交（保存）的情况下更改内容，这会为您提供一个新的 URL。

如果您想要一个指向您将不断更改且 URL 始终相同的内容的链接，请将其放入 repo 并通过提交来保存更改。

你最终会得到类似的东西：

> [https://raw.github.com/UserName/Repository/master/script.js](https://raw.github.com/UserName/Repository/master/script.js)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-07-31T11:51:12.327

其他方法不起作用，所以我正在使用[`rawgit.com`](https://rawgit.com)：

```
https://rawgit.com/<user>/<id>/raw/<file> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-01-30T11:58:06.993

如果您愿意，也可以从 url 中删除您的用户名。

从上面接受的答案中获取网址：

```
https://gist.github.com/<USER_NAME>/<GIST_ID>/raw/<GIST_FILE_NAME> 
```

删除`<USER_NAME>`并移到用户名所在的`raw`前面：`<GIST_ID>`

```
https://gist.github.com/raw/<GIST_ID>/<GIST_FILE_NAME> 
```

但它不适用于 RawGit。

# multithreading - NUnit TestCaseSource 修改

> ID：12522547
> 
> 赞同：1
> 
> 时间：2012-09-20T23:54:16.120
> 
> 标签：multithreading, static, nunit, resharper, nspec

我有一些看起来像这样的代码

```
[Test, TestCaseSource("NspecRunner")]
public void TextContext (example thing)
  {
     //does testing like things using thing
     while( othread.threadState == running && currentTestCount == StaticList.count)
          Thread.Sleep(1000)
  }

public List<example> NspecRunner
{
    ClassName x = new ClassName
    Thread othread = new Thread(new ThreadStart(() => x.function_that_adds_to_StaticList()));
    return ClassName.StaticList;
} 
```

然而，Nunit 不会查看在初始查看后返回的 StaticList。您是否知道使 TestCaseScenario 重新评估的任何方法，以便在另一个线程向该静态类添加新内容时创建一个新测试。我对其他框架完全开放。或者，如果您知道在 Nunit 项目中的哪个位置，我可以找到一种方法来修改 TestCaseSource 的工作方式，那就太好了。

编辑：我正在尝试为 ClassName.StaticList 中的每个项目创建一个测试。我不知道列表中会有多少，但我希望每个测试在另一个线程将项目添加到 StaticList 后立即开始。那可能吗？

# php - 无法使用 Paypal PDT 数据执行 mySQL 查询

> ID：12522548
> 
> 赞同：2
> 
> 时间：2012-09-20T23:54:21.743
> 
> 标签：php, sql, paypal, integer, eclipse-pdt

所以这是问题所在，我正在尝试做一个 PDT 并获取基本信息并发布到 sql，更重要的是还有一个自定义变量。它是一个整数，称为“lvel”，也称为“apv”到“user_level”和“approved”下的用户，但如果我手动将其设置为“1,2,3..etc”，但如果我使用 $ apv 或 $lvel .. 它不会插入它.. 有什么想法吗？会很棒的。警告.. 试验非常混乱..

```
 <?php
session_start();
$sid = session_id();
include 'dbc.php';
?>
<?php

$pp_hostname = "www.sandbox.paypal.com"; // Change to www.sandbox.paypal.com to test against sandbox

// read the post from PayPal system and add 'cmd'
$req = 'cmd=_notify-synch';

$tx_token = $_GET['tx'];
$auth_token = "_nothing to see here_";
$req .= "&tx=$tx_token&at=$auth_token";

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, "https://$pp_hostname/cgi-bin/webscr");
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $req);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 1);
//set cacert.pem verisign certificate path in curl using 'CURLOPT_CAINFO' field here,
//if your server does not bundled with default verisign certificates.
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 2);
curl_setopt($ch, CURLOPT_HTTPHEADER, array("Host: $pp_hostname"));
$res = curl_exec($ch);
curl_close($ch);

if(!$res){
    //HTTP ERROR
}else{
     // parse the data
    $lines = explode("\n", $res);
    $keyarray = array();
    if (strcmp ($lines[0], "SUCCESS") == 0) {
        for ($i=1; $i<count($lines);$i++){
        list($key,$val) = explode("=", $lines[$i]);
        $keyarray[urldecode($key)] = urldecode($val);
    }
    // check the payment_status is Completed
    // check that txn_id has not been previously processed
    // check that receiver_email is your Primary PayPal email
    // check that payment_amount/payment_currency are correct
    // process payment
    $firstname = $keyarray['first_name'];
    $lastname = $keyarray['last_name'];
    $itemname = $keyarray['item_name'];
    $amount = $keyarray['payment_gross'];

    echo ("<p><h3>Thank you for your purchase!</h3></p>");

    echo ("<b>Payment Details</b><br>\n");
    echo ("<li>Name: $firstname $lastname</li>\n");
    echo ("<li>Item: $itemname</li>\n");
    echo ("<li>Amount: $amount</li>\n");
    //echo ('$sid');
    }
}echo("$amount");
    $apv = '1';
    if($amount == "4.00"){
        $level = '1';
        $sub =1;
    }
    if($amount == "6.00"){
        $lvel = '2';
        $sub =1;
    }
    if($amount == "10.00"){
        $lvel = '3';
        $sub =1;
    }
    if($amount == "14.00"){
        $lvel = '4';
        $sub =1;
    }
    if($amount == "20.00"){
        $lvel = '5';
        $sub =1;
    }
    if($amount == "25.00"){
        $lvel = '6';
        $sub =1;
    }
    if($amount == "30.00"){
        $lvel = '7';
        $sub =1;
    }
    if($amount == "40.00"){
        $lvel = '8';
        $sub =1;
    }
    if($amount == "12.00"){
        $level = '1';
        $sub =2;
    }
    if($amount == "22.00"){
        $lvel = '2';
        $sub =2;
    }
    if($amount == "32.00"){
        $lvel = '3';
        $sub =2;
    }
    if($amount == "42.00"){
        $lvel = '4';
        $sub =2;
    }
    if($amount == "66.00"){
        $lvel = '5';
        $sub =2;
    }
    if($amount == "80.00"){
        $lvel = '6';
        $sub =2;
    }
    if($amount == "95.00"){
        $lvel = '7';
        $sub =2;
    }
    if($amount == "125.00"){
        $lvel = '8';
        $sub =2;
    }

mysql_query("update users set approved='$apv' where sid='$sid'");
mysql_query("update users set user_level='$lvel' where sid='$sid'");

    //else if (strcmp ($lines[0], "FAIL") == 0) {
        // log for manual investigation
   // }

?>
<?php 
$apv1 = '1';
mysql_query("update users set approved='$apv1' where sid='$sid'");
?>
Your transaction has been completed, and a receipt for your purchase has been emailed to you.<br> You may log into your account at <a href='https://www.paypal.com'>www.paypal.com</a> to view details of this transaction.<br> 
```

# string - 基于XSLT中的属性将字符串添加在一起以获取img路径

> ID：12522551
> 
> 赞同：0
> 
> 时间：2012-09-20T23:55:04.997
> 
> 标签：string, xslt-1.0

有没有办法使用由多个值构建的字符串来显示图像？IE。我想显示一个路径包含属性值的图像。我的代码示例（不起作用）：

```
<img src="{'subdirectory/' + @title + '150p.png'}" /> 
```

如果当前节点的“title”属性 =“main”，这会尝试显示路径为“subdirectory/main150p.png”的图像，但失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T23:57:38.350

看起来您可能正在考虑使用 Javascript 而不是 XPath。尝试`<img src="{concat('subdirectory/', @title, '150p.png')}" />`

# mysql - 需要在一个表中创建多少列来保存附件的url路径？

> ID：12522552
> 
> 赞同：0
> 
> 时间：2012-09-20T23:55:14.640
> 
> 标签：mysql, database, database-design

我正在创建一个博客或类似电子邮件的东西，用户可以在其中附加文件。从技术上讲，他可以添加多少个文件没有限制（暂时忘记这种可能性）。如果用户添加了 10 个附件，我应该如何管理我的表来存储这些附件的 url 路径。我应该在表中创建 20 列来保存附件的 url 路径吗？如果用户想要附加超过 20 个文件怎么办？我正在使用mysql数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T23:59:48.483

为附件创建一个表格 - 每个附件 1 行。列应该很明显。

从此表中有一个外键返回到您的“博客”表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T10:15:07.343

This is a classic "one to many" relationship. Represent the "many" portion by a separate table, which will be a child endpoint of a foreign key whose parent endpoint is your "main" table.

Something like this:

```
CREATE TABLE EMAIL (
    EMAIL_ID INT PRIMARY KEY
    -- Other fields...
);

CREATE TABLE ATTACHMENT (
    ATTACHMENT_ID INT PRIMARY KEY,
    EMAIL_ID INT NOT NULL,
    -- ATTACHMENT_URL and other fields... 
    FOREIGN KEY (EMAIL_ID) REFERENCES EMAIL (EMAIL_ID)
); 
```

You can now easily insert several rows into ATTACHMENT that all reference the same row from EMAIL.

The foreign key ensures that you can't insert an attachment for a non-existent e-mail, nor you can delete the e-mail and leave its attachments "hanging in the air".

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-21T03:55:10.553

您可以将表格设计为>>

表 1--->>> tlbUser

用户 ID(PK) | 用户名 | 密码

表2---->>>tlbUserLinks

LinkId(Pk) | UserId(FK) [来自 tlbUser 的 ID] | 链接网址

这样就不会限制用户添加链接（计数）

您还可以通过此表结构获取哪个用户发布了哪个链接...

# javascript - 某事=某事=某事...什么？

> ID：12522553
> 
> 赞同：4
> 
> 时间：2012-09-20T23:55:22.990
> 
> 标签：javascript

我正在阅读一些代码，并且看到了这样的比较：

`a = b = c`

看到搜索关于相等或比较的 Javascript 如何产生补救结果，有人愿意解释发生了什么吗？

编辑：这些都是我们在这里讨论的对象或对象属性，应该指定。

双重编辑：这是在 Object.defineProperties() 块内。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-20T23:57:10.300

`=`是一个运算符。它有两个参数：一个变量引用和一个表达式。它将表达式的值分配给变量，并返回分配的值。

因此，您可以将它们链接起来，这相当于：

```
a = (b = c) 
```

换句话说，分配`b`给 的值`c`，然后将该值分配给`a`也。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-20T23:57:53.937

`a = b = c`只是以下的简写：

```
b = c;
a = b; 
```

`if(a = b)`将始终返回`true`，因为它正在分配，而不是比较。为了比较，该语句应为：`if(a == b)`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-20T23:56:47.150

那不是比较。它是`c`对`b`和`a`变量的赋值。

赋值从右到左工作，所以它是`c`to `b`first 的赋值。然后将该操作的返回值分配给`a`。

赋值操作的返回值是被赋值的值，所以`a`会得到相同的赋值给`b`.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-20T23:58:01.483

`=`运算符从右到左关联并计算分配的值。

所以这：

```
a = b = c; 
```

意思是*：

```
b = c;
a = c; 
```

* * *

[^*除非您正在处理属性。]

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-20T23:56:50.393

它等同于此；

```
b = c; a = b; 
```

# javascript - KOGrid 没有出现

> ID：12522558
> 
> 赞同：0
> 
> 时间：2012-09-20T23:55:42.717
> 
> 标签：javascript, jquery, knockout.js

我正在尝试让 KO Grid 工作。我在 Ko 2.1 环境中，我正在尝试在 MVC 视图中使用 Ko 网格。奇怪的是，当我加载我的页面时，我根本看不到任何东西。我有一个小提琴文件，它使朋友完全没问题：http://jsfiddle.net/jearles/sf4p3/14/

我的代码非常相似：但这根本无法呈现。

我的 HTML 如下：

```
<div id="KoGridContainer">
    <div data-bind="koGrid: { data: Prizefillfilmentstatuses }"></div>

    <button id="Get" data-bind="click:GetAll">Get</button>
    <p><span data-bind='text: Prizefillfilmentstatuses().length'>&nbsp;</span> row(s)</p>

</div> 
```

我的 Js 代码如下所示：

```
 function ($, ui, ko, komapping, servicesConfig, constants, koGrid) {
        $("#body").fadeIn();
        var self = {};

        self.ViewModel = {

            GetAll: function () {
                self.getAll();
            },

            Prizefillfilmentstatuses: ko.observableArray([
                { id: 1, firstName: 'John', lastName: 'Doe', createdOn: '1/1/2012', birthday: '1/1/1977', salary: 40000 },
                { id: 1, firstName: 'Jane', lastName: 'Harper', createdOn: '1/2/2012', birthday: '2/1/1976', salary: 45000 },
                { id: 1, firstName: 'Jim', lastName: 'Carrey', createdOn: '1/3/2012', birthday: '3/1/1985', salary: 60000 },
                { id: 1, firstName: 'Joe', lastName: 'DiMaggio', createdOn: '1/4/2012', birthday: '4/1/1991', salary: 70000 },
                { id: 1, firstName: 'Jeff', lastName: 'Saturday', createdOn: '1/5/2012', birthday: '5/1/1998', salary: 65000 },
                { id: 1, firstName: 'Marg', lastName: 'Simpson', createdOn: '1/6/2012', birthday: '6/1/1921', salary: 20000 },
                { id: 1, firstName: 'Tim', lastName: 'Allen', createdOn: '1/7/2012', birthday: '7/1/1977', salary: 35000 },
                { id: 1, firstName: 'Kevin', lastName: 'Bacon', createdOn: '1/8/2012', birthday: '8/1/1977', salary: 30000 },
                { id: 1, firstName: 'Jack', lastName: 'Murphy', createdOn: '1/9/2012', birthday: '9/1/1999', salary: 55000 },
                { id: 1, firstName: 'Jessica', lastName: 'Smith', createdOn: '1/10/2012', birthday: '10/1/1979', salary: 45000 }
            ])
        };

//        if ($("#KoGridContainer").length == 1) {
//            $.consolelog("found Ko-Grid");
//            ko.applyBindings(self.ViewModel, $("#KoGridContainer").get(0));
//        }

       ko.applyBindings(self.ViewModel); 
```

当然，它不是整个文件。我刚刚把我的视图模型和绑定放在那里。现在，最有趣的事实是控制台根本没有错误，最重要的是它还向我显示了 3-4 次网格。我很难过地说“随机”。我严重无法追踪它过去出现的情况，但它显示了我 1% 的时间。其他 99% 根本没有网格。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T00:18:04.390

如果您完全从 fiddle 复制代码，那么我只能想到一个问题.. 即；***文件引用错误*** ..您的脚本标签看起来如何.. ??

还可以在浏览器中按 F12 按钮并检查您看到的错误。

# c++ - 实现 D3.JS 到 C++11 的功能端口的 Lambda 函数

> ID：12522559
> 
> 赞同：1
> 
> 时间：2012-09-20T23:56:06.240
> 
> 标签：c++, lambda, c++11, functional-programming, d3.js

如果尝试部分移植到 C++，C++11 的 lambda 函数是否能够处理 D3.JS 的功能方面？

我最有可能发现难以从 JS 转移到 C++11 的函数式编程和松散类型的特性是什么？

# c# - 为什么不能通过 C# 中的索引访问单个 System.Array 元素？

> ID：12522560
> 
> 赞同：1
> 
> 时间：2012-09-20T23:56:27.820
> 
> 标签：c#, oop

举个例子：

```
class MyArray {
    private Array _array;

    public MyArray(Array array) {
        _array = array;
    }

    public object this[int index] {
        get { return _array[index]; }
        set { _array[index]=value; }
    }
 } 
```

这将返回编译错误“无法在此处访问私有索引器 'this'”

但是，如果 _array 被声明为 object[]，则此功能正常。

这是否与值数组和引用数组之间的差异有关？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-21T00:03:40.850

你不应该使用`Array`：

> Array 类是支持数组的语言实现的基类。但是，只有系统和编译器可以显式地从 Array 类派生。用户应该使用该语言提供的数组结构。

[http://msdn.microsoft.com/en-us/library/system.array.aspx](http://msdn.microsoft.com/en-us/library/system.array.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T00:14:10.640

如您所见，类 Array 的描述：

> 提供用于创建、操作、搜索和排序数组的方法，从而充当公共语言运行时中所有数组的基类。

该类没有索引器。如果您正在处理数组，则可以使用 object[] 代替或使用 List<>

# microsoft-metro - 什么是“标准 C++ 类型”和“C++/CX 构造”？

> ID：12522561
> 
> 赞同：1
> 
> 时间：2012-09-20T23:56:29.867
> 
> 标签：microsoft-metro, windows-runtime, c++-cx

如果这是一个愚蠢的问题，请耐心等待，因为我最近开始学习 C++/CX。我正在阅读有关[值类](http://msdn.microsoft.com/en-us/library/windows/apps/hh699861.aspx)和[引用类](http://msdn.microsoft.com/en-us/library/windows/apps/hh699870.aspx)的 MSDN 文档，并且遇到了以下例外情况：

> 因为值类或值结构的所有成员都是公共的并且被发送到元数据中，所以不允许使用标准 C++ 类型。

和

> [A ref class] 可以包含 C++/CX 构造或标量类型作为成员，例如 enum 类、ref 类、float64 等。它还可能包含标准 C++ 类型。C++/CX 构造可能具有公共、受保护、内部、私有或受保护私有的可访问性。公共或受保护的成员被发送到元数据。标准 C++ 类型必须具有私有、内部或受保护的私有可访问性，以防止它们被发送到元数据。

我的问题是：“C++/CX 构造”和“标准 C++ 类型”的定义是什么？

如果我的猜测是正确的，C++/CX 构造包括 ref 类和结构以及枚举类和结构，标准 C++ 类型包括 int、bool、float、double 等。是吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-21T00:14:05.937

当文档说“C++/CX 构造”时，它表示 Windows 运行时类型。使用 C++/CX 编程时，有两类类型：

1.  **C++ 类型**：C++ 类型集包括您可以在普通 C++ 代码中使用的所有类型：基本类型（如`int`or `double`）、枚举、指针、引用、类类型等。

2.  **Windows 运行时类型**：这些类型可以跨 Windows 运行时 ABI 边界使用。其中包括引用类型 ( `ref class`)、Windows 运行时值类型（`value class`、数字类型、Windows 运行时枚举等）和委托。

请注意，这些类别之间有一些重叠：数字类型都在。

您可以在代码中的任何位置使用 C++ 类型，但您编写的任何公共组件的公共表面*除外*。只有 Windows 运行时类型可以跨 Windows 运行时 ABI 边界使用。例如：

```
public ref class C sealed 
{
public:

    // Ok:  int is a fundamental WinRT type
    void F(int x) { } 

    // Not ok:  std::string is not a WinRT type
    void G(std::string s) { } 

private:

    // Ok:  _s is private; private members are implementation details, so you
    // may use ordinary C++ types for private members.
    std::string _s; 
}; 
```

这两类类型并不是在 C++ 中构建 Windows 运行时组件所独有的：如果您在 .NET 中构建组件，则可以使用 .NET 特定类型（例如，具体泛型类型）和 .NET 特定构造（例如，泛型方法） )，它们不是有效的 Windows 运行时类型。

# php - SQL 查询在第一次迭代后返回 null

> ID：12522562
> 
> 赞同：0
> 
> 时间：2012-09-20T23:56:32.407
> 
> 标签：php, javascript, mysql

*请不要介意语法错误，这只是整个代码的要点*

我得到了这个网页，上面有下面的 JS 代码：

```
setInterval(function(){
  $.ajax({
    url: my_page.php,
    dataType: 'json',
    success: function(data){
      console.log(data.key);
    }
  });
}, 1000); 
```

my_page.php 看起来像这样：

```
include database.php
$data = mysql_fetch_array(mysql_query("valid SELECT query"), MYSQL_ASSOC);
echo json_encode($data); 
```

(Chrome) 控制台显示：

```
correct_result
null
null
... 
```

谁能解释为什么？我已经测试了查询并且是 100% 正确的，它在第一次迭代时回显了正确的结果。

谢谢！

# objective-c - 弄清楚如何在 nsmutablearray 中加载 1000 个对象

> ID：12522563
> 
> 赞同：0
> 
> 时间：2012-09-20T23:56:35.163
> 
> 标签：objective-c, uitableview, nsmutablearray

我有一个通过远程查询数据库部分加载的提要（UITableView）。数据库包含我必须检索的 1000 行。我在每个查询中检索 10 行。结果主要包含文本，但我也为每一行存储图像。所以我首先检索前十行，当用户在第 10 行末尾向下滚动 UITableView 时，我进行另一个查询以获取接下来的十行。到目前为止，我的 nsmutablearray 中总共存储了 20 行。这个过程一直持续到我得到 170 行。然后我在 Xcode 中遇到内存问题，应用程序崩溃。所以我想弄清楚如何在 UITableView 中加载所有 1000 行而不会使应用程序崩溃。

我正在考虑每次执行新查询时都删除前 10 行，因此 nsmutablearray 将始终有 10 个对象。我想对了吗？我是第一次这样做。

任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T00:35:31.153

如果你正在加载一个表格视图，那不是你这样做的。您按需加载行`cellForRowAtIndexPath`并让 iOS 删除不在视图中的行。当您创建一个新单元格时，您使用`dequeueReusableCellWithIdentifier`并且仅在该调用返回 nil 时创建一个新单元格。

元素将根据需要从您的数据库中检索，因此您在主内存中的现有单元中一次永远不会超过 15-20 个。

在某些情况下，您可能有关于要保存在主内存中的单个单元格的数据，但通常每行应该只有几个小对象——将这么多的对象放入 1000 个元素的 NSArray 中不是问题。

您不会保留您创建的所有单元格的数组 - iOS 会这样做，然后它将释放那些滑出屏幕的单元格，以保留存储空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T00:28:44.597

您是否想过将核心数据与 NSFetchResultsController 一起使用？将它们一起使用将帮助您在大多数情况下避免任何内存问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-21T02:21:20.833

我会在数组中保留 3 页的行。您想要前一页和前一页。这将加速您的界面。您不想冒险让异步接口等待同步数据库调用。如果没有超级关闭的原因，我也不会将图像存储在数据库中。

# php - Ajax 成功函数返回 [object, object]

> ID：12522564
> 
> 赞同：1
> 
> 时间：2012-09-20T23:56:40.780
> 
> 标签：php, jquery, ajax

我对 AJAX 调用非常陌生 - 在网上浏览了一些教程，但仍然没有取得成功。

输入字段的分配 ID 为“idkey”。脚本如下：

```
$(document).on("keyup.autocomplete", "#idkey", function(){ 
    var query = "q=" + $(this).val();
    $.ajax({
        url: 'api.php',
        type: 'GET',
        data: query,
        dataType: 'json',
        success: function(data) {
            alert(data);
            for (var i=0;i<data.length;i++) {
                content = data[i].IDKey;
                content += "<br>";
                $(content).appendTo("#output");
                // updateListing(data[x]);
            }
        }
    });
}); 
```

在服务器端，api.php 的输出为：

```
[{"IDKey":"30000001"},{"IDKey":"30000002"},{"IDKey":"30000004"}] 
```

我不确定为什么`alert(data)`会返回`[object Object], [object Object], [object Object]`。任何线索为什么会发生这种情况？

p/s: php 文件的标头设置为`Content-Type: application/json`.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-21T00:01:08.163

类型警报（JSON.stringify（数据））；

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-21T00:00:52.590

警报返回`[object Object], [object Object], [object Object]`是因为您有 3 个 javascript 对象的数组，并且对象不能仅作为字符串警报，您可以使用`console.log`来查看对象的内容，只需使用`console.log`而不是`alert`检查浏览器的控制台

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-21T00:15:43.370

您的 json 响应是一个包含 3 个对象的数组。这就是您将警报视为对象的原因。

试试`alert(data[0].IDKey)`..它应该给你 30000001

要查看数据，请尝试 console.log 或将警报放在 for 循环中

```
for (var i=0;i<data.length;i++) {
    alert(data[i].IDKey);
 }

$.each(data, function(i, value) {
   console.log('Value of '+ i +' is : ' + value);
}) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-21T00:02:11.187

正在返回三个对象，**因为**这`alert(data)`就是**JSON。Java** **s** cript Object **Notation**。

 **它返回一个数组对象，这就是它的全部返回，这就是它显示它的方式的原因。

如果您想查看这样一个数组的结果..每个对象包含什么，那么您需要使用`console.log()`：

```
console.log(data) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-09T19:23:58.687

苏珊斯上面说的

```
 for (var i=0;i<data.length;i++) {
        alert(data[i].IDKey);
    } 
```

如果您使用的是 IE，请记住删除或注释掉 console.log() 方法。IE 不太喜欢它们。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-09T19:32:35.117

您的输出是 [object, object] 因为您实际上返回了一个对象数组。为了检索这些对象的内容，您必须遍历每个数组并访问包含的每个单独的对象。**

# git - 如何将两个提交合并为一个提交？

> ID：12522565
> 
> 赞同：122
> 
> 时间：2012-09-20T23:56:41.363
> 
> 标签：git, merge, branch, git-svn, rebase

我有一个包含 2 个提交的分支“firstproject”。我想摆脱这些提交并使它们显示为单个提交。

该命令`git merge --squash`听起来很有希望，但是当我运行`git merge --squash`我的终端时，只会显示该命令的选项。什么是正确的命令？

```
Commit 1:
Added 'homepage.html'
Added 'contacts.html'

Commit 2:
Added 'homepage.php'
Added 'homepage.php'
Deleted 'homepage.html'
Deleted 'contacts.html' 
```

* * *

## 回答 #1

> 赞同：179
> 
> 时间：2012-09-21T02:19:24.433

您想要`git rebase -i`执行[交互式变基](http://git-scm.com/book/en/Git-Tools-Rewriting-History#Changing-Multiple-Commit-Messages)。

如果你当前*在*你的“commit 1”，并且你想要合并的提交，“commit 2”，是之前的提交，你可以运行`git rebase -i HEAD~2`，它会生成一个编辑器，列出所有 rebase 将遍历的提交。您应该看到以“pick”开头的两行。要继续挤压，将第二行的第一个单词从“pick”更改为“squash”。然后保存文件，然后退出。Git 会将您的第一次提交压缩到您的倒数第二次提交中。

请注意，此过程会重写您的分支的历史记录。如果您将代码推送到某个地方，您将不得不这样做，`git push -f`并且任何共享您的代码的人都必须跳过一些障碍来拉动您的更改。

请注意，如果有问题的两个提交*不是*分支上的最后两个提交，则过程将略有不同。

* * *

## 回答 #2

> 赞同：90
> 
> 时间：2017-03-16T20:24:16.253

像我这样健忘的懒惰的简单版本：

`git rebase -i HEAD~3` 或者但是很多提交而不是 3。

转这个

```
pick YourCommitMessageWhatever
pick YouGetThePoint
pick IdkManItsACommitMessage 
```

进入这个

```
pick YourCommitMessageWhatever
s YouGetThePoint
s IdkManItsACommitMessage 
```

并在您点击的地方执行一些操作`esc`以`enter`保存更改。[1]

当下一个屏幕出现时，摆脱那些垃圾 # 行 [2] 并创建一个新的提交消息或其他东西，并执行相同的`escape` `enter`操作。[1]

Wowee，你有更少的提交。或者你只是破坏了一切。

* * *

[1] - 或者任何适用于你的 git 配置的东西。考虑到我的设置，这只是一个有效的序列。

[2] - 你会看到一些类似`# this is your n'th commit`的东西，你的原始提交就在这些消息的正下方。您想要删除这些行，并创建一个提交消息以反映您合并为 1 的 n 个提交的意图。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2015-08-03T09:45:23.347

1.  签出您的分支并计算所有提交的数量。
2.  打开 git bash 并写入：（`git rebase -i HEAD~<quantity of your commits>`即`git rebase -i HEAD~5`）
3.  在打开的`txt`文件中，将所有提交的`pick`关键字更改`squash`为除第一次提交（位于顶部）之外。对于最重要的一项，将其更改为`reword`（这意味着您将在下一步中为此提交提供新评论），然后单击保存！如果在 vim 中，请按`esc`然后输入保存，然后`wq!`按 enter。
4.  提供评论。
5.  打开 Git 并进行“获取所有”以查看新更改。

完毕

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-18T20:13:58.210

这就是我所做的。（对我来说）比进行交互式变基更容易：

```
git reset HEAD~2\.  // go back 2 commits.
git commit -am “My squashed single commit”
git push --force 
```

# ios - Xcode：未找到架构 armv7 的符号

> ID：12522571
> 
> 赞同：2
> 
> 时间：2012-09-20T23:57:07.367
> 
> 标签：ios, xcode

我收到了来自 Xcode 的这条消息

```
Ld /Users/myUsername/Library/Developer/Xcode/DerivedData/myApp-gqsubryokdmrjmczxeqypzcgpths/Build/Intermediates/myApp.build/Debug-iphoneos/myApp.build/Objects-normal/armv7/myApp normal armv7
    cd /Users/myUsername/Documents/_IPAD/myApp
    setenv IPHONEOS_DEPLOYMENT_TARGET 4.3
    setenv PATH "/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin:/Applications/Xcode.app/Contents/Developer/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin"

/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang -arch armv7 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS6.0.sdk -L/Users/myUsername/Library/Developer/Xcode/DerivedData/myApp-gqsubryokdmrjmczxeqypzcgpths/Build/Products/Debug-iphoneos -F/Users/myUsername/Library/Developer/Xcode/DerivedData/myApp-gqsubryokdmrjmczxeqypzcgpths/Build/Products/Debug-iphoneos -filelist /Users/myUsername/Library/Developer/Xcode/DerivedData/myApp-gqsubryokdmrjmczxeqypzcgpths/Build/Intermediates/myApp.build/Debug-iphoneos/myApp.build/Objects-normal/armv7/myApp.LinkFileList -dead_strip -fobjc-arc -fobjc-link-runtime -miphoneos-version-min=4.3 -framework AudioToolbox -framework SystemConfiguration -framework QuartzCore -framework OpenAL -framework CoreGraphics -framework CFNetwork -framework MessageUI -framework CoreData -framework AVFoundation -framework StoreKit -framework UIKit -framework Foundation -o /Users/myUsername/Library/Developer/Xcode/DerivedData/myApp-gqsubryokdmrjmczxeqypzcgpths/Build/Intermediates/myApp.build/Debug-iphoneos/myApp.build/Objects-normal/armv7/myApp

Undefined symbols for architecture armv7:
  "_OBJC_CLASS_$_ViewController", referenced from:
      objc-class-ref in AppDelegate.o
ld: symbol(s) not found for architecture armv7
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

究竟是什么没有找到？如果它说没有找到东西，在哪里寻找这个没有找到的东西？或者换句话说，如果 xcode 正在搜索它在某处搜索的东西，在哪里搜索什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-21T00:01:31.173

`ViewController`未找到该对象，它在 中被引用`AppDelegate`。您没有将 ViewController 链接到您的应用程序中。检查您的项目中的`Compile Sources`部分是否`Build Phases`显示`ViewController.m`.

![在此处输入图像描述](../Images/56f43632d0f60dcf1ed8b23befe2e4be.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-06T01:01:30.530

我刚碰到这个。原来我没有将新源添加到所有需要它的目标中。也许这会对将来的某人有所帮助.. :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-19T12:43:19.393

将 xCode 6beta 更新到 xCode 6.0.1 后，我遇到了同样的错误。在花了很多时间后，我通过从**Window -> Organizer -> Projects -> #Select project#中删除“** **Derived Data** ”来修复它，然后在“Derived Data”中按 Delete。

# xslt - XSL：从一个模式的多个实例中调用特定元素

> ID：12522573
> 
> 赞同：0
> 
> 时间：2012-09-20T23:57:19.160
> 
> 标签：xslt, xpath, xsd

我创建了一个名为“BusLocationLinks”的组件，它存储了企业名称以及我创建的地图的坐标。

我有近 50 个具有相同架构 (BusLocationsLinks) 的业务位置，并且只想列出该名称的所有组件组件的元素“业务名称”。我已经尝试了一切，但无法让它们全部显示。有什么建议吗？

这是我当前的代码：

```
 <xsl:template name="BusLocationLinks">
      <xsl:for-each select="BusLocationLinks/BusinessName">
    <li class="active">
      <xsl:value-of select="BusinessName" />
    </li>
      </xsl:for-each>
 </xsl:template> 
```

我的 xml 代码看起来类似于：

```
<BusLocationLinks>
    <BusinessName>Star Property</BusinessName>
</BusLocationLinks> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T01:25:20.877

如果没有看到您的 XML，就很难诊断问题。但是，您可能具有以下结构：

```
<BusLocationLinks>
    <BusinessName>name1</BusinessName>
    <BusinessName>name2</BusinessName>
    <BusinessName>name3</BusinessName>
</BusLocationLinks> 
```

如果是这种情况，那么您应该像这样调整您的 XSLT：

```
<xsl:template name="BusLocationLinks">
  <xsl:for-each select="BusinessName">
    <li class="active">
      <xsl:value-of select="." />
    </li>
  </xsl:for-each>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T00:05:51.037

指令的主体`xsl:for-each`将上下文节点重置为所选节点集中的节点之一（每次评估 for-each 的主体时都不同）。

在您的示例中，这意味着在 for-each 的主体中，当前节点是`BusLocationLinks/BusinessName`您选择的元素之一。您的循环为它们中的每一个创建一个 list-item 元素（检查您的输出，我希望您会在那里看到它们）包含`BusinessName`上下文节点的子节点的值。上下文节点与表达式匹配`BusLocationLinks/BusinessName`，因此您正在寻找匹配的节点的值`BusLocationLinks / BusinessName / BusinessName`。如果您没有任何与表达式匹配的节点`BusLocationLinks / BusinessName / BusinessName`，您将获得空`li`元素。

试试`<xsl:value-of select="."/>`。

# ios - 切换隐私设置将杀死应用程序

> ID：12522574
> 
> 赞同：45
> 
> 时间：2012-09-20T23:57:21.843
> 
> 标签：ios, objective-c, addressbook, abaddressbook, ios-privacy-settings

我有一个使用 iPhone 联系人的应用程序。在 iOS 6 中，第一次尝试时会提示用户进行联系人访问。此时，用户可以点击“允许”或“不允许”。问题是当用户将应用程序设置为后台时，然后导航到设置->隐私->联系人以切换我的应用程序的联系人隐私设置。切换后，我可以在控制台上看到我的应用程序：

> 应用程序 'UIKitApplication:com.myApp' 异常退出，信号 9：已终止：9

我在 Apple 的文档中找不到这方面的任何信息。有谁知道防止这种情况的方法？这是设计好的吗？或者这是苹果的错误？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-10-01T06:00:50.573

操作系统发送一个不是崩溃的 SIGKILL - Apple 关于 iOS6 隐私的会话说：

*   如果权限更改，应用程序将退出。
*   如果已注册，则调用后台任务到期处理程序
*   然后 iOS 会终止该应用程序。

[WWDC 2012 会议视频：iOS 和 OS X 中的隐私支持](http://developer.apple.com/devcenter/download.action?path=/wwdc_2012/wwdc_2012_session_pdfs/session_710__privacy_support_in_ios_and_os_x.pdf)

过期处理程序：[beginBackgroundTaskWithExpirationHandler](https://stackoverflow.com/questions/3871149/beginbackgroundtaskwithexpirationhandler)

我看不出有什么办法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-09-02T16:26:06.760

在测试 beginBackgroundTaskWithExpirationHandler 之后，我可以说在更改权限设置后不会调用过期处理程序块，如 Apple 演示文稿中所述。

# java - 需要使用拦截器将自定义 HTTP 请求标头添加到 JAX-RS 客户端

> ID：12522589
> 
> 赞同：1
> 
> 时间：2012-09-20T23:59:07.587
> 
> 标签：java, cxf, jax-rs

我正在使用 JAX-RS 1.0。服务器在处理请求之前验证是否存在自定义 HTTP 标头。

我想为 JAX-RS 客户端创建某种类似于 AOP 的行为，它会自动将 HTTP 标头添加到每个请求中。

JAX-RS 1.0 是否支持出站客户端拦截器？我在文档中找不到任何提及。另一种方法是我编写一个特定于 CXF 的出站拦截器......谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T19:55:39.620

使用 JAX-RS 1.0 没有很好的方法来做到这一点。我使用了 CXF 拦截器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-01T08:50:34.980

你可以写一个@PreMatching 拦截器

```
import javax.ws.rs.container.ContainerRequestContext;
import javax.ws.rs.container.ContainerRequestFilter;
import javax.ws.rs.container.PreMatching;
import java.io.IOException;

@PreMatching
public class ContentTypeFilter implements ContainerRequestFilter {

    @Override
    public void filter(ContainerRequestContext requestContext)
            throws IOException {

        requestContext.getHeaders().putSingle("Content-Type", "application/json");
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T11:16:26.793

嗯，JAX-RS 是一个 API，所以应该能够为它提供你自己的实现。如何实现[javax.ws.rs.client.ClientFactory](http://jax-rs-spec.java.net/nonav/2.0-SNAPSHOT/apidocs/javax/ws/rs/client/ClientFactory.html)并`javax.ws.rs.client.Client`从`getClient()`. 只要您的类与您正在使用的 JAX-RS 实现不冲突，就应该可以正常工作。

# html - 我可以在纯 CSS 中创建没有列的布局吗？

> ID：12522590
> 
> 赞同：3
> 
> 时间：2012-09-20T23:59:10.843
> 
> 标签：html, css

我正在研究我的博客，当查看时`> 1020px wide`看起来像这样，使用三列从左到右加载帖子（即将帖子 1 放在左栏中，帖子 2 放在中间，三个放在右边，然后开始再次从左列）：

![在此处输入图像描述](../Images/73d12a91c525840d133f05a0c3e103e5.png)

这很好用，但是当浏览器缩小到布局下方时`1020`，布局将转换为单列。这在视觉上很容易通过将列放在彼此下方来实现（看起来不错），**但这会导致帖子乱序**- 如果总共有 9 个帖子，前三个帖子实际上是帖子 1、4 和 7。

*我想保持纯 CSS 托管布局的清洁度，所以我想知道在单个容器*（而不是三列）中使用浮动元素的上述三列布局是否有技巧。

我已经玩了一点，只是在每三个瓷砖后向左浮动并清除，但当然最终只是将每三个瓷砖放在上面“行”中最高瓷砖下方的“行”中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-21T00:01:44.230

我知道你说过你想要纯 CSS，但 jQuery 库 Masonry 是专门为这类东西设计的。

[http://masonry.desandro.com/](http://masonry.desandro.com/)

否则，我还没有找到使用纯跨浏览器兼容 CSS 实现这一目标的好方法。

# php - 多维数组插入和更新到数据库

> ID：12522594
> 
> 赞同：0
> 
> 时间：2012-09-20T23:59:45.223
> 
> 标签：php, mysql, arrays

我有一个多选下拉框，它为我生成一个这样的数组：

```
 array(3) { [0]=> string(1) "1" [1]=> string(1) "6" [2]=> string(1) "7" } 
```

我无法解决的是如何让多重选择下拉框插入更新并从数据库中选择或进入数据库。我似乎只得到一个值

我目前的代码情况是这样的-> 以上`var_dump`是什么：

```
SELECT * FROM {table} WHERE canid=? AND categoryid=?", array($emailCheck['id'], $fields['Occupation'][0])); 
```

**更新声明：**我怎么能内爆这个？

```
UPDATE {table} SET canid=?, categoryid=? WHERE canid=? AND categoryid=?", array($emailCheck['id'], implode(',', $fields['Occupation'])); 
```

我的数据库结构是：

![在此处输入图像描述](../Images/5a4da43ac904031dc068bf6b87e3a27b.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T00:06:14.867

如果我理解正确并`$fields['Occupation']`包含下拉列表中的多个选定值，则使用`AND categoryid IN (?)`并使用[implode](http://php.net/manual/en/function.implode.php)将数组合并为字符串，如下所示：`implode(',', $fields['Occupation'])`

完整的代码将如下所示：

```
myFunction("SELECT * FROM {table} WHERE canid=? AND categoryid IN (?)", array($emailCheck['id'], implode(',', $fields['Occupation']))); 
```

**更新**

我认为在这种情况下，当您需要单独更改每一行的这些列时，最好在 PHP 中循环数组并进行单独的查询：

```
for($i=0; $i<count($fields['Occupation']); $i++) {
    $id = $fields['Occupation'][$i];
    // here make query like before
    myFunction("UPDATE {table} SET canid=?, categoryid=? WHERE canid=? AND categoryid=?", array($emailCheck['id'], $id));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T17:46:04.597

您必须为每个值动态生成参数占位符

```
$params = array_merge(array($emailCheck['id']), $fields['Occupation']);
$catPlaceholders = '?'.str_repeat(',?',count($fields['Occupation'])-1);

myFunction("SELECT * FROM {table} WHERE canid=? AND categoryid IN ("
        .$catPlaceholders.")", $params); 
```

# visual-studio-2012 - Entity Framework 5.0 的函数导入列表为空

> ID：12522596
> 
> 赞同：7
> 
> 时间：2012-09-20T23:59:52.327
> 
> 标签：visual-studio-2012, entity-framework-5

我已经开始开发一个在 VS 2012 中使用 Entity Framework 5.0 和 MVC 4 的应用程序。该应用程序连接到现有数据库，因此这是一个数据库第一个站点。到目前为止，一切都很好。但是我有一个我正在编写的方法，它需要使用在数据库端定义的函数。让我们称它为 DoesItHaveAThingy(Guid id, string type)，它返回一个布尔值。该功能工作正常，已经在这个数据库上工作了几年。

所以我打开 edmx 设计器并右键单击然后选择从数据库更新模型。我选择我的功能并完成。它在 Model.Store 中添加了功能，您可以在模型浏览器中看到它。似乎一切都很好。然而没有生成代码。

我在网上查了一下，人们说一旦你完成了这一步，你就需要进行函数导入。好的，所以我右键单击设计器并点击添加 -> 功能导入。它会弹出一个对话框，您可以在其中添加您的函数名称。该对话框还有一个功能下拉列表，您需要选择一个。这就是问题所在，下拉列表是空的。所以我无法导入我需要的功能。

我猜我做错了什么。我认为也许 emdx 文件添加了该功能但出现错误。我曾经有过一个视图，检查了文件，并在视图附近有一条注释说明该视图的错误（它没有主键，然后又是什么视图）。但是我没有看到该功能的任何错误消息，它似乎被添加了。

只是那个功能吗？不，尝试了另一个函数，相同的参数但返回一个 int。同样的问题。

谢谢你。

# algorithm - 改进冒泡排序的运行时间分析

> ID：12522600
> 
> 赞同：0
> 
> 时间：2012-09-21T00:00:32.747
> 
> 标签：algorithm, analysis, bubble-sort

我正在做一项家庭作业，其中要求我找到修改后的冒泡排序对大小为**n**的数据集进行的比较次数。要考虑的数据集是一个排序列表，其中第一个和最后一个元素被交换，例如：52341。下面是算法的伪代码：

```
i <- n-1; new_i <- i
while i > 0 do 
    for j=1 to i do
        if A[j] > A[j+1] do
            A[j] <=> A[j+1]
            new_i <- j
        endif
    endfor
    i <- new_i - 1; new_i <- i
endwhile 
```

A 是数据集，<=> 是交换。

我试图找到一种方法来表示该算法，并将求和简化为对给定类型数据集的比较量的表达式。

没有给出答案，有人能把我推向正确的方向吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T11:18:06.847

在您的 Bubblesort 实现中，比较次数完全由输入的大小单独决定，即输入列表中元素的顺序无关紧要。

如果你能证明这一点（这不是很难），计算一个大小为 N 的输入列表的比较次数就足够了。由于我们已经证明顺序无关紧要，这又相当容易：

我们有两个循环，外`while`循环和内循环`for`循环。外部循环从 n 到 1（或 n-1 到 0，但肯定不是从 n-1 到 1，正如您的代码所建议的那样），即我们有 N 次迭代。内循环从 1 到 i。

因此，我们在外循环的第一次迭代中进行了 N 次比较，第二次进行了 N-1 次比较，第三次进行了 N-2 次比较，...，第 NN 次进行了 0 次比较。

我想你是一个人走到这一步的。否则，无论如何，你都被搞砸了。

您的老师现在想看到的是您知道以下公式，即所谓的“Gaußsche Summenformel”，也称为“Gauss Sum”：

N + (N-1) + (N-2) + ... + (N-N+1) + (NN) = N^2/2 + N/2

所以你应该在这里做的是：

*   表明比较次数*仅*取决于输入的大小
*   表明比较次数等于 N + (N-1) + (N-2) + ... + (N-N+1) + (NN)
*   提到这和N^2/2 + N/2一样，指的是Mr. Gauß。

;-)

# objective-c - 我需要检查图像的 CGPoint 的 X 和 Y 点，然后显示警报

> ID：12522602
> 
> 赞同：-2
> 
> 时间：2012-09-21T00:00:37.117
> 
> 标签：objective-c, ios, xcode, cgpoint

我正在制作一个图像从屏幕顶部掉落的游戏，我需要检测它们何时达到/超过某个 x & y 值。我试着做：

```
if (asteroid.center.y == 296 && asteroid.center.x == 50) {
    // etc...displayed alert
} 
```

但由于某种原因，它不起作用。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T00:09:27.830

这取决于“小行星”是什么类型的物体。如果是 UIView 的实例，应该可以从 UIView 的 frame 属性中获取位置：

```
if (asteroid.frame.origin.y >= 296 && asteroid.frame.origin.x >= 50) {
    // etc...displayed alert
} 
```

frame 是一个 CGRect 引用。您可以在这里了解更多信息：http: [//developer.apple.com/library/ios/#documentation/GraphicsImaging/Reference/CGGeometry/Reference/reference.html#//apple_ref/doc/c_ref/CGRect](http://developer.apple.com/library/ios/#documentation/GraphicsImaging/Reference/CGGeometry/Reference/reference.html#//apple_ref/doc/c_ref/CGRect)

编辑：

如果你想检查小行星的中心与顶部/左侧相反，它看起来像这样：

```
if (asteroid.frame.origin.y + asteroid.frame.size.height / 2 >= 296 && asteroid.frame.origin.x + asteroid.frame.size.width / 2 >= 50) {
        // etc...displayed alert
} 
```

# linux - linux cp中的通配符

> ID：12522608
> 
> 赞同：1
> 
> 时间：2012-09-21T00:00:55.940
> 
> 标签：linux, shell, glob

当我在 cp 中使用 * 时，我认为它遵循与正则表达式相同的规则。所以`"cp temp/* test/"`应该复制所有内容，但是，当临时文件夹为空时，它会抛出异常，说它找不到文件或目录，这表明 * 不能匹配“无”。

然后我在 temp 下创建一个文件 test.txt 并执行以下操作：

```
cp temp/test.txt* test/ 
```

它有效，这表明 * 确实匹配“无”。

我对这种行为感到困惑。谁能解释一下？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-21T00:14:18.570

发生的事情是`*`扩展是由您的外壳完成的（`bash`可能）。该模式`temp/testfile.txt*`确实匹配`temp/testfile.txt`（`*`匹配零个或多个字符），因此 bash 将其传递给`cp`.

但是，`bash`默认情况下，如果通配符不匹配任何内容，则默认将通配符传递给应用程序（有一个选项`nullglob`可以关闭这种不直观的行为）。所以它从`temp/*`字面上传递给cp，它抱怨它不存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T00:12:39.513

外壳进行扩展，因此并不`cp`具体。

如果未找到匹配项，则不进行替换，`temp/*`保留原始字符串 ( ) 并传递给应用程序。当然`cp`找不到该名称的文件。

```
# echo nosuchfile*
nosuchfile* 
```

对“无”的一些澄清：

`temp/*`表示目录中的条目（文件/目录/...）`temp`，但没有任何文件，因此失败。

`temp/test.txt*``test.txt`表示以`temp`目录开头的条目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-21T00:14:46.780

通配符`globbing`与正则表达式不一样，有自己的完整规则。

不同的 shell 有不同的规则……你想看看[Wikipdia](http://en.wikipedia.org/wiki/Glob_%28programming%29)以获得一个概述。

# loops - 大型 3D 游戏是否有多个游戏循环？

> ID：12522609
> 
> 赞同：-1
> 
> 时间：2012-09-21T00:01:05.537
> 
> 标签：loops, 3d

他们有一个循环更新所有内容吗？他们是否有多个循环来更新游戏的某些部分？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T00:06:49.017

许多引擎使用许多不同的技术。

有些会运行 1 个主循环，有些会使用线程池，有些会运行模拟循环和不同步的渲染循环。

想要更具体的答案？问一个更具体的问题。

# git - git commit - 如何查看提交时所做的更改

> ID：12522612
> 
> 赞同：2
> 
> 时间：2012-09-20T15:20:01.220
> 
> 标签：git, diff, commit

我可以设置 git 在进行交互式提交时向我显示差异吗（即没有 -m“msg”）

这会让我看到我正在提交哪些更改。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-20T16:14:03.280

尝试`git commit -v`

正如它在 git-commit 手册页中所说：

```
 -v , --verbose
          Show unified diff between the HEAD commit and what would be
          committed at the bottom of the commit message template. Note
          that this diff output doesn’t have its lines prefixed with #. 
```

# .net - .Net 4.5 和 Azure

> ID：12522615
> 
> 赞同：2
> 
> 时间：2012-09-21T00:01:27.333
> 
> 标签：.net, azure

有谁知道 Azure 何时会支持 .NET 4.5 Framework 进行站点托管和数据库迁移？

我搜索了一天，并意识到有解决方法：

*   通过网络工作者角色

有谁知道微软何时会在 Azure 上的所有服务上提供 .Net 4.5？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-21T21:57:51.990

正如[Scott 提到](http://weblogs.asp.net/scottgu/archive/2012/09/17/announcing-great-improvements-to-windows-azure-web-sites.aspx)的，Windows Azure 中对 .net 4.5 的支持计划在下个月进行，这就是您将获得的全部内容。

事实上，产品发布日期不会在论坛或 Q/A 上讨论，因为产品发布对任何团队都很重要。此类信息主要在产品特定网站或与该产品博客相关联的人上可用。一旦确定了发布日期，他们将发布有关其发布的公告，或者您只看到产品发布和公告一起发布。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-21T20:24:41.623

我与一位 MS 布道者交谈，他说他们正在进行 90 天的测试。目前还没有正式的硬性日期。我也希望在我的生产部署之前得到它，但它没有发生，所以现在我降级到 4.0。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-21T00:15:13.683

> 我们将在未来几周内推出更多新功能和增强功能——包括对最近的 Windows Server 2012 和 .NET 4.5 版本的支持（我们将在下个月为 Windows Server 2012 和 .NET 4.5 启用新的 Web 和辅助角色映像） . 随着这些新功能的推出，请密切关注我的博客以获取详细信息。

[http://weblogs.asp.net/scottgu/archive/2012/09/17/announcing-great-improvements-to-windows-azure-web-sites.aspx](http://weblogs.asp.net/scottgu/archive/2012/09/17/announcing-great-improvements-to-windows-azure-web-sites.aspx)

2012 年 10 月 8 日更新：

> 我们将在本月晚些时候推出更多新功能和增强功能——包括对最近的 Windows Server 2012 和 .NET 4.5 版本的支持（我们将在 Windows Server 2012 和 .NET 4.5 中启用新的 Web 和辅助角色映像，并支持 . NET 4.5 和网站）。

[http://weblogs.asp.net/scottgu/archive/2012/10/07/announcing-improvements-to-the-windows-azure-portal.aspx](http://weblogs.asp.net/scottgu/archive/2012/10/07/announcing-improvements-to-the-windows-azure-portal.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-21T09:08:42.450

在此处为 Windows Azure 中的 .net 4.5/IIS8 投票 [http://www.mygreatwindowsazureidea.com/forums/34192-windows-azure-feature-voting/suggestions/2598170-iis8-and-asp-net-4-5-support -在天蓝色平台](http://www.mygreatwindowsazureidea.com/forums/34192-windows-azure-feature-voting/suggestions/2598170-iis8-and-asp-net-4-5-support-in-azure-platform)

票数越多，微软就会越关注和发展

**编辑** 我收到了一封来自微软的电子邮件，说他们很快就会支持基于 .net 4.5 和 Visual Studio 2012 在云上构建的应用程序。

# javascript - 如何在 Javascript 中恢复被覆盖函数的原始状态

> ID：12522618
> 
> 赞同：5
> 
> 时间：2012-09-21T00:01:47.477
> 
> 标签：javascript

假设您有一个脚本需要在覆盖 javascript 的 JSON 的页面上运行。stringify，你将如何确保你的代码使用原始的 stringify 而不是被覆盖的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-21T00:24:38.523

虽然我会选择*其他*答案之一，但以下是针对以下情况的解决方案：

1.  页面*无法*更改，因此；
2.  代码*不能*在覆盖 JSON.stringify 的代码之前运行，因此；
3.  代码*无法*保存原始函数对象（以恢复它或稍后显式使用它）。

这是一个黑客：

1.  创建一个 IFRAME 元素。
2.  访问`contentWindow`IFRAME 元素的属性；这应该包含原始的（或“一个新的未触及的”）JSON 对象，因此应该包含原始的 JSON.stringify 函数。

[这是jsfiddle](http://jsfiddle.net/ZSypG/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-21T00:05:13.933

如果您正在创建一个库，请使其成为`JSON.stringify`符合标准行为的要求。

对您的代码提出严格的要求并没有错，这实际上是一个好主意。您只需要确定记录要求。

显然，如果原始文件被永久覆盖，您将无法使用它。将负担放在最终用户身上是一个更好的解决方案。

如果这不是为了一个库，而是为了一个个人项目，你应该简单地拒绝加载任何像用不符合的方法替换符合的方法一样愚蠢的第三方代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-21T00:06:09.297

`JSON.stringify`在被覆盖之前进行备份。如果您无法对其进行备份，请使用[shiv](https://github.com/douglascrockford/JSON-js)。

# ruby - Ruby 指针或创建自分配方法

> ID：12522620
> 
> 赞同：2
> 
> 时间：2012-09-21T00:02:12.713
> 
> 标签：ruby

我想向 Ruby 的 Object 添加一个方法来重新分配与之关联的值。

例如，如果我有两个字符串，我可以在其中一个上调用我的方法，这样指向底层的指针`char[]`就会指向另一个的底层`char[]`。

```
a = object_a
b = object_b
a == object_b #=> false
a.my_method(object_b)
a == object_b #=> true 
```

任何人都可以看到实现这一目标的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-21T00:43:41.970

你不能改变`self`，它总是指向当前对象。但是，您可以围绕对象创建代理。`SimpleDelegator`这在标准库中使用 ruby​​ 非常简单：

```
require 'delegate'

a = SimpleDelegator.new 'foo'
b = 'bar'
a == b # false
a.__setobj__(b)
a == b # true 
```

`__setobj__`您可以使用更好的别名，例如：

```
require 'delegate'

class AwesomeDelegator < SimpleDelegator
  alias_method :become, :__setobj__
end 

a = AwesomeDelegator.new 'foo'
...
a.become('bar') 
```

# javascript - 如何确定一个 Javascript 对象是否只有一个特定的键值对？

> ID：12522621
> 
> 赞同：15
> 
> 时间：2012-09-21T00:02:14.583
> 
> 标签：javascript

确定 Javascript 对象是否只有一个特定的键值对的最简单方法是什么？

例如，我需要确保存储在变量中的对象`text`只包含键值对`'id' : 'message'`

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-21T00:16:44.407

```
var keys = Object.keys(text);
var key = keys[0];

if (keys.length !== 1 || key !== "id" || text[key] !== "message")
    alert("Wrong object"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-21T02:10:55.853

如果您正在谈论所有可枚举的属性（即对象及其`[[Prototype]]`链上的属性），您可以这样做：

```
for (var prop in obj) {

  if (!(prop == 'id' && obj[prop] == 'message')) {
    // do what?
  }
} 
```

如果您只想测试对象本身的可枚举属性，那么：

```
for (var prop in obj) {

  if (obj.hasOwnProperty(prop) && !(prop == 'id' && obj[prop] == 'message')) {
    // do what?
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-21T00:10:14.290

```
var moreThanOneProp = false;
for (var i in text) {
   if (i != 'id' || text[i] != 'message') {
      moreThanOneProp = true;
      break;
   }
}

if (!moreThanOneProp)
   alert('text has only one property'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-21T00:17:14.173

如果您知道您想要的属性，那么只制作对象的浅表副本会不会更快，不需要修剪所有内容？

```
var text = {
    id : "message",
    badProperty : "ugougo"
}

text = { id : text.id } 
```

假设我已经正确理解了你的问题......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-21T00:20:21.833

您可以对其进行字符串化并尝试将其与正则表达式匹配。例子：

```
if (JSON.stringify(test).match(/\"id":\"message\"/)) {
  console.log("bingo");
}
else  console.log("not found"); 
```

# c++ - 在 C++ 中继承友元运算符

> ID：12522624
> 
> 赞同：0
> 
> 时间：2012-09-21T00:03:07.723
> 
> 标签：c++, inheritance, operators

所以我有 A 类和 B 类，其中 B 类扩展了 A 类。我必须在两个类中重载 << 和 >>。我希望在 B 类的运算符的函数定义中，我可以从 A 类调用重载的运算符，但我在这样做时遇到了麻烦。

```
#include <iostream>
#include <string>
using namespace std;

class A {
friend ostream& operator<<(ostream& out, A a);
protected:
    int i;
    string st;
public:
    A(){
        i=50;
        st = "boop1";
    }
};

ostream& operator<<(ostream &out, A a) {
out << a.i << a.st;
return out;
}

class B : public A {
friend ostream& operator<<(ostream& out, B b);
private:
    int r;
public:
    B() : A() {
        r=12;
    }
};

ostream& operator<<(ostream &out, B b) {
out = A::operator<<(out, b);    //operator<< is not a member of A
out << "boop2" << b.r;
return out;
}

int main () {
B b;
cout << b;
} 
```

我尝试在 B 的 operator<< 中调用 A 的 operator<<，但当然它实际上并不属于 A，因此无法编译。我应该如何实现这一目标？

另外，请注意，实际上 A 和 B 有自己的头文件和正文文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-21T00:06:34.467

您可以使您的`B`对象看起来像一个`A`对象：

```
std::ostream& operator<< (std::ostream& out, B const& b) {
    out << static_cast<A const&>(b);
    out << "boop2" << b.r;
    return out;
} 
```

请注意，您几乎肯定不想传递要按值打印的对象。我已将签名更改为使用 a `const&`：这表明对象不会被更改，也不会被复制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-21T00:06:17.160

`A`'s`operator<<`确实*不是*的成员`A`，而是在命名空间范围内。这里正确的方法是使用类型强制来让重载解析做正确的事情。改变：

```
out = A::operator<<(out, b); 
```

至：

```
out << static_cast<A>(b); 
```

此外，您应该更改您的运算符以采用第二个参数 by `const&`，在这种情况下，它应该如下所示以避免额外的副本：

```
out << static_cast<A const&>(b); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-21T00:06:28.173

它们是全局函数，不要使用范围解析运算符限定它们：

```
operator<<(out, static_cast<const A&>(b)) << "boop2" << b.r; 
```

你必须强制转换它，这样你就不会调用你所在的函数并获得无限递归。另外，不要将结果分配`operator<<`给`out`; 它不起作用，也不是你想做的。

此外，您的函数应该接受`const A&`'s 和`const B&`'s（也就是说，您应该通过`const`引用而不是值来接受参数）以防止不必要的复制。

# jquery - 简单的手风琴在 IE7 中不起作用

> ID：12522637
> 
> 赞同：0
> 
> 时间：2012-09-21T00:04:34.617
> 
> 标签：jquery, internet-explorer-7, accordion

我有一个从 CSS 技巧中获得的简单手风琴（并进行了一点操作），除了 IE7（在 IE9 中，使用开发工具显示 IE7 模式）之外，它在任何地方都很好用，但是当我从 CSS 技巧中测试未操作的版本时它可以工作在IE7中很好。

这是来自 CCS Tricks 的 jsfiddle：http: [//jsfiddle.net/drpKm/](http://jsfiddle.net/drpKm/)

这是我创建的：http: [//jsfiddle.net/y6m2N/3/](http://jsfiddle.net/y6m2N/3/)

关于如何让它在 IE 中工作的任何想法？我已经尝试了我能想到的一切。我对 CSS 技巧版本所做的唯一更改是将锚标记放在 dt 标记之外。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T00:18:23.920

好的..我在[这里为你工作](http://jsfiddle.net/y6m2N/3/)

一些笔记。

1.  您不需要该`noConflict()`方法，因为您已经将 jQuery 作为参数传递。
2.  我将 # 添加到 href 因为如果没有属性中的某些内容，Safari 将无法正常工作。
3.  您链接的小提琴没有加载 jQuery。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T21:15:29.290

所以这几乎解决了问题...... [http://jsfiddle.net/y6m2N/21/](http://jsfiddle.net/y6m2N/21/)

IE 不喜欢 dt 标记周围的锚标记，它在其他任何地方都可以正常工作，但与往常一样，IE7 是个例外。:)

# git - 两个有共同代码的项目

> ID：12522640
> 
> 赞同：1
> 
> 时间：2012-09-21T00:05:04.100
> 
> 标签：git, git-merge, git-cherry-pick

我被分配到两个项目，这两个项目都来自一个共同的父级，并且目标是大约在同一时间合并回父级。为简单起见，我们称它们为 master、projA 和 projB。

假设源代码的文件夹结构是：
/src/main/UI
/src/main/backend

假设有一个文件，我们想在其中添加一个新的通用错误处理程序。
此功能应在 projA 和 projB 之间共享。
/src/main/backend/common/errorhandler.cpp

分支如下（均从 master 分支并最终合并回 master。aN/bN 是项目特定的更改。AN/BN 是更改 errorhandler.cpp

```
 -- projA--a1-a2--A1--
      /                     \
------                       master
      \                     /
       -- projB--b1-b2--B1-- 
```

所以在某些时候，projB 中可能需要对 projA 进行更改，所以提交看起来像这样（比如在将 A1 挑选到 projB 之后）。

```
 -- projA--a1-a2--A1--a3---
      /                          \
------                            master -- projA' -- projB'
      \                          /
       -- projB--b1-b2--B1--A1'-- 
```

根据我的阅读，我不能只将 A1 合并到 projB 中。它将合并 a1、a2 和 A1。

我可以使用cherry-pick，这将是projB中的A1'，但代价是当projA和projB都合并回master时，A1`和A1被视为单独的更改。

我希望有人可能有一个更好的计划，我仍然可以使用合并，这样我就不会得到“重复”的更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T10:05:43.197

编辑：

首先（只是为了确保），您`/src/main/backend/common/`应该在主分支中实现（并且可能在任何分支中进行编辑）。

然后你创建你的分支`projA`并`projB`从`master`. 您在 UI 上的 projA 分支上工作，同时在 projB 分支的后端工作。到目前为止没有问题。

您现在在各自的分支中有 A1、B1 提交。

```
 ---projA -- a1 -- a2 -- A1 
     /                          
----------------------------- master
     \                          
      ---projB -- b1 -- b2 -- B1 
```

你想要的只是 A1，B1 而不是 a1，a2，b1，b2。事实上，我推荐樱桃采摘。樱桃采摘的一件坏事（除其他外）是之后的历史并不好。但在你的情况下，我看不到很多（甚至是任何）其他可能性。

当您在主分支上（切换：）时`git checkout master`，您运行`git cherry-pick A1`（A1 是提交 SHA），它将 UI 提交“A1”合并到主分支：

```
 ---projA -- a1 -- a2 -- A1    
     /                             
------------------------- master ---- A1'
     \                          
      ---projB -- b1 -- b2 -- B1 
```

然后，仍然在 master 分支上，您通过运行合并后端提交“B1” `git merge projB`。结果是：

```
 ---projA -- a1 -- a2 -- A1    
     /                             
------------------------- master ---- A1' ---- B1'
     \                          
      ---projB -- b1 -- b2 -- B1 
```

应该就是这样，您在 master 分支上的项目现在具有您想要的形式。我会考虑更多，看看是否有其他可能。

# gwt - GWT 和动画 gif：如何显示单个帧？

> ID：12522641
> 
> 赞同：0
> 
> 时间：2012-09-21T00:05:03.387
> 
> 标签：gwt

使用 GWT，是否可以使用动画 gif 并仅显示其中的特定帧？例如，显示第 4 帧，然后显示第 5 帧。我们是否可以控制 GWT 中动画 gif 的各个帧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T00:33:30.343

不，这在 GWT 中是不可能的，在 JavaScript 中也是不可能的。

正如 Cory 建议的那样，您可以在服务器端将 GIF 拆分为单独的帧，然后根据浏览器事件提供单独的图像。

# python - CPython 不能与 Windows 上生成的 tty 终端很好地交互

> ID：12522649
> 
> 赞同：0
> 
> 时间：2012-09-21T00:06:09.443
> 
> 标签：python, terminal, expect, tty, pexpect

每次我尝试使用 winpexpect 来生成终端（例如：openssh，`ssh`）。如果我这样做`winpexpect.winspawn('ssh ...')`，我会遇到“不会分配伪终端，因为标准输入不是终端。”。如果我强制使用终端，`winpexpect.winspawn('ssh -t -t ...')`那么即使 ssh 客户端真的连接到服务器，我的读取缓冲区也不会得到任何信息。其他交互式终端也是如此，它们只是挂起，读取缓冲区中没有任何显示。但是对于终端的命令，例如`ping`winpexpect 有效。

我发现真正起作用的是使用 putty 的 plink.exe `winpexpect.winspawn('plink ...'`，. 这与 putty.exe 相同，但它不进行终端仿真，我只获取原始 telnet/解密的 ssh 数据。然而，这并不是真正理想的解决方案。

我真的很困惑如何让一个 spawner/expect 库与 Windows 上的终端一起工作！我什至尝试过使用expectJ，只是纯Java，这也有同样的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T07:31:49.840

winpexpect/plink 有什么问题？您可以尝试分叉的[winpexpect](https://bitbucket.org/weyou/winpexpect)，它修复了 winpexpect-1.5 上的许多问题

# javascript - 带有 mootools 的响应式顶栏导航

> ID：12522657
> 
> 赞同：0
> 
> 时间：2012-09-21T00:07:23.293
> 
> 标签：javascript, jquery, navigation, mootools, responsive-design

我正在使用 mootools ，并以基础作为我的 CSS“框架”。我正在使用 Foundation 的导航顶部栏，它很棒。然而响应式设计被破坏了。

因为我没有使用 jquery ....

[http://jsfiddle.net/idanhen/3LXQb/](http://jsfiddle.net/idanhen/3LXQb/) <--这是基础代码。 [http://foundation.zurb.com/docs/navigation.php](http://foundation.zurb.com/docs/navigation.php) <- 导航文档

我无法理解他们为转换它所做的 jquery 脚本。有人知道 mootools 响应式导航栏吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T06:24:47.853

自己做的，想如果有人需要的话我会分享的。

原始文件是：“jquery.foundation.topbar.js” 新文件是：“mootools.foundation.topbar.js”

1.  只需添加foundation.css
2.  mootools-core-1.4.5 , mootools-more-1.4.0.1 （我都有这两个原因，这是一个巨大的项目，但我想你只能使用核心......）
3.  mootools.foundation.topbar.js

当然运行以下命令：

`<script type="text/javascript">
window.addEvent('domready', function() { window.foundationTopBar();
}); </script>`

“mootools.foundation.topbar.js”：

` /** * mootools.foundation.topbar * * 取自foundation.topbar.js * [http://foundation.zurb.com](http://foundation.zurb.com) * * 由Idan Hen 撰写：idandush@gmail.com */

```
;(function ($, window, undefined) {
  'use strict';

    /* just create settings object */
    var settings = {
        index : 0,
        breakPoint : 940, // Set to to 9999 to force it into responsive always
        initialized : false
      };
    var  methods = {        
        init : function (options) {
          return function () {            
            settings = Object.merge(settings, options); //settings = $.extend(settings, options);
            settings.window = window;
            settings.topbar = $$('nav.top-bar');
            settings.titlebar = settings.topbar.getChildren('ul')[0]; // getElement() just return #

            if (!settings.initialized) {
              methods.assemble();
              settings.initialized = true;
            }

            if (!settings.height) {
              methods.largestUL();
            }
            $$('.top-bar .toggle-topbar').getParent().addEvent('click.fndtn:relay(.top-bar .toggle-topbar)', function (e) { //live switched to addEvent
              e.preventDefault();
              if (methods.breakpoint()) {
                settings.topbar.toggleClass('expanded');
                settings.topbar.setStyle('min-height', ''); //css
              }
            });

            // Show the Dropdown Levels on Click            
            $$('.top-bar .has-dropdown>a').getParent().addEvent('click.fndtn:relay(.top-bar .has-dropdown>a)', function (e) {
              e.preventDefault();
              if (methods.breakpoint()) {
                var anchor = $(this),
                    selectedLi = anchor.getParent('li'), // closest -> getParent
                    section = anchor.getParents('section')[0],// closest -> getParents
                    largestUl;

                settings.index += 1;
                selectedLi.addClass('moved');
                section.setStyle('left', -(100 * settings.index) + '%');
                section.getElements('>.name').setStyle('left', 100 * settings.index + '%');

                //outerHeight
                anchor.getSiblings('ul').setStyle('height', (settings.height + settings.titlebar.getSize().y));
                settings.topbar.setStyle('min-height', settings.height + settings.titlebar.getSize().y * 2) //outerHeight
              }
            });

            // Go up a level on Click
            $$('.top-bar .has-dropdown .back').getParent().addEvent('click.fndtn:relay(.top-bar .has-dropdown .back)', function (e) {
              e.preventDefault();

              var anchor = $(this),
                movedLi = anchor.getParent('li.moved'),
                section = anchor.getParents('section')[0],
                previousLevelUl = movedLi.getParent();

              settings.index -= 1;
              section.setStyle('left', -(100 * settings.index) + '%'); //css
              section.getElements('>.name').setStyle('left', 100 * settings.index + '%'); // find

              if (settings.index === 0) {
                settings.topbar.setStyle('min-height', 0); // changed topbar from $topbar
              }

              setTimeout(function () {
                movedLi.removeClass('moved');
              }, 300);
            });
          }.call(window.document.HTMLDocument);
        },
        breakpoint : function () {
          return settings.window.getSize().x < settings.breakPoint; //width()
        },
        assemble : function assemble() {
          var section = settings.topbar.getElements('section')[0];

          // Pull element out of the DOM for manipulation          
          section = section.dispose(); //detach

          //console.log('section.getElements.n>a : ', section.getElements('.has-dropdown>a'));
          section.getElements('.has-dropdown>a').each(function(e){
            e.each(function (e) {                
                //console.log('section' , section);
                var link = $(e),
                    dropdown = link.getSiblings('.dropdown'), //siblings                    
                    //<li class="title back js-generated"><h5><a href="#"></a></h5></li>
                    a = new Element('a', {
                        href: '#'
                    }),
                    h5 = new Element('h5', {}),
                    titleLi = new Element('li', {
                        'class': 'title back js-generated'
                    });//section.getChildren('ul li');// back js-generated');

//                    console.log('dropdown: ', dropdown);
                    h5.grab(a);
                    titleLi.grab(h5);
                    // Copy link to subnav
                    titleLi.getElements('h5>a').set('html', (link.get('html') ) ); // find -> getElements
                    dropdown.grab(titleLi, 'top');
                });
            });
          // Put element back in the DOM
            settings.topbar[0].grab(section[0]); // section.appendTo(settings.topbar); 
        },
        largestUL : function () {
          var uls = settings.topbar[0].getElements('section ul ul'), // find -> getElements
              largest = uls.getFirst(),
              total = 0;
          uls.each(function(ul){
            if (ul.getChildren('li').length > largest.getChildren('li').length) { //length -> getSize().x
              largest = ul;
            }
          });

          largest.getChildren('li').each(function (li) { total += li.getComputedSize().height; }); //outerHeight(true); -> getSize().y          
          settings.height = total;
        }
  };

  /**
   * this function is added to the window -> need to add it myself
   * apply is call ...
   */
  window.foundationTopBar = function (method) 
  {
    if (methods[method]) {
      return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
    } else if (typeof method === 'object' || !method) {
      return  methods.init.apply(this, arguments);
    } else {
      $.error('Method ' +  method + ' does not exist on jQuery.foundationTopBar');
    }
  };
}($, this)); 
```

`

# knockout.js - knockout.js 在运行时加载模板

> ID：12522658
> 
> 赞同：8
> 
> 时间：2012-09-21T00:07:58.733
> 
> 标签：knockout.js, requirejs, template-engine

我正在使用带有内置模板系统的 knockout.js。我这样定义模板：

```
<script type="text/html" id="subjectItemView">
   <span class="name" data-bind="text: subjectName" />
</script> 
```

然后我使用模板的 id，因此将其作为脚本的一部分是必要的。

我的单页应用程序中有相当多的这些模板，并且最近开始使用 require.js 来加载仅在需要时才需要的脚本。我想对模板做同样的事情，最好使用 require.js 以便我的模块可以将模板列为依赖项。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-21T01:53:33.677

I use the require.js text plugin: [http://requirejs.org/docs/api.html#text](http://requirejs.org/docs/api.html#text). Once you have the template text, you can then append it to the page in a new script tag (with a type that is `text/html` or something other than javascript).

I have been actually using a modified template engine that handles strings directly, so that I don't need to append extra script tags to the page.

My code looks something like:

```
 this.activate = function() {
        //load view model from the server
        if (!this.loaded) {
            require(["modules/" + name, "text!../templates/" + self.template + ".html"], function(Module, template) {
                ko.templates[self.template] = template;
                self.data(typeof Module === "function" ? new Module() : Module);
                self.loaded = true;
            });
        }
    }; 
```

The stringTemplateEngine that I use looks like: [https://github.com/rniemeyer/SamplePresentation/blob/master/js/stringTemplateEngine.js](https://github.com/rniemeyer/SamplePresentation/blob/master/js/stringTemplateEngine.js)

# django - 如何覆盖在list_filter中提供过滤器的查询集？

> ID：12522661
> 
> 赞同：26
> 
> 时间：2012-09-21T00:08:36.783
> 
> 标签：django, admin

给定以下模型

```
class AnotherModel(models.Model):
    n = models.IntegerField()

class MyModel(models.Model):
    somefield = models.ForeignKey(AnotherModel) 
```

和管理员

```
class MyModelAdmin(admin.ModelAdmin):        
    list_filter = ('somefield',) 
```

如何过滤实例`AnotherModel`以仅在我的管理过滤器中显示具有给定`n`值的实例？

我需要类似的东西：

筛选

由某个领域

全部

[给定 n 的 AnotherModel 实例列表]

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-09-21T00:14:35.770

请参阅[ModelAdmin.queryset](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.queryset)和[ModelAdmin.formfield_for_foreignkey](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.formfield_for_foreignkey)。从文档：

> ModelAdmin 上的 queryset 方法返回可以由管理站点编辑的所有模型实例的 QuerySet。覆盖此方法的一个用例是显示登录用户拥有的对象：

```
class MyModelAdmin(admin.ModelAdmin):
    def queryset(self, request):
        qs = super(MyModelAdmin, self).queryset(request)
        if request.user.is_superuser:
            return qs
        return qs.filter(author=request.user) 
```

> ModelAdmin 上的 formfield_for_foreignkey 方法允许您覆盖外键字段的默认表单字段。例如，要根据用户返回此外键字段的对象子集：

```
class MyModelAdmin(admin.ModelAdmin):
    def formfield_for_foreignkey(self, db_field, request, **kwargs):
        if db_field.name == "car":
            kwargs["queryset"] = Car.objects.filter(owner=request.user)
        return super(MyModelAdmin, self).formfield_for_foreignkey(db_field, request, **kwargs) 
```

> 这使用 HttpRequest 实例过滤 Car 外键字段以仅显示 User 实例拥有的汽车。

[更新]

抱歉，我没有阅读“过滤器”部分。在 Django >= 1.4 中，您可以 `django.contrib.admin.SimpleListFilter`在[list_filter 参数列表](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.list_filter)中传递 的子类，您可以使用它来覆盖查找和查询集方法。

```
from datetime import date

from django.contrib import admin
from django.utils.translation import ugettext_lazy as _

class DecadeBornListFilter(admin.SimpleListFilter):
    # Human-readable title which will be displayed in the
    # right admin sidebar just above the filter options.
    title = _('decade born')

    # Parameter for the filter that will be used in the URL query.
    parameter_name = 'decade'

    def lookups(self, request, model_admin):
        """
        Returns a list of tuples. The first element in each
        tuple is the coded value for the option that will
        appear in the URL query. The second element is the
        human-readable name for the option that will appear
        in the right sidebar.
        """
        return (
            ('80s', _('in the eighties')),
            ('90s', _('in the nineties')),
        )

    def queryset(self, request, queryset):
        """
        Returns the filtered queryset based on the value
        provided in the query string and retrievable via
        `self.value()`.
        """
        # Compare the requested value (either '80s' or '90s')
        # to decide how to filter the queryset.
        if self.value() == '80s':
            return queryset.filter(birthday__gte=date(1980, 1, 1),
                                birthday__lte=date(1989, 12, 31))
        if self.value() == '90s':
            return queryset.filter(birthday__gte=date(1990, 1, 1),
                                birthday__lte=date(1999, 12, 31))

class PersonAdmin(admin.ModelAdmin):
    list_filter = (DecadeBornListFilter,) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-18T15:58:47.317

## 编辑-已指出此方法存在问题，请参见下文

你可以这样做：

假设您有一个名为 Animal 的模型，它具有一个名为 Species 的模型的 ForeignKey 字段。在特定的管理列表中，您希望仅允许在动物过滤器选项中显示某些物种。

首先，在 Animal 的 ModelAdmin 中指定一个名为 SpeciesFilter 的自定义 ListFilter：

```
class AnimalAdmin(ModelAdmin):
    list_filter = (('species', SpeciesFilter),) 
```

然后定义 SpeciesFilter：

```
from django.contrib.admin.filters import RelatedFieldListFilter

class SpeciesFilter(RelatedFieldListFilter):
    def __init__(self, field, request, *args, **kwargs):
        """Get the species you want to limit it to.
        This could be determined by the request,
        But in this example we'll just specify an
        arbitrary species"""
        species = Species.objects.get(name='Tarantula')

        #Limit the choices on the field
        field.rel.limit_choices_to = {'species': species}

        #Let the RelatedFieldListFilter do its magic 
        super(SpeciesFilter, self).__init__(field, request, *args, **kwargs) 
```

那应该这样做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-07-15T09:58:23.863

我找到了另一种类似于@seddonym 的方法，但不会弄乱缓存。它基于[这个 Django 代码](https://github.com/django/django/blob/master/django/contrib/admin/filters.py#L419)，但使用了未记录的方法`field_choices`，在未来的 Django 版本中可能会发生变化。@seddonym 案例的代码是：

```
from django.contrib.admin.filters import RelatedFieldListFilter

class SpeciesFilter(RelatedFieldListFilter):
    def field_choices(self, field, request, model_admin):
        return field.get_choices(include_blank=False, limit_choices_to={'name': 'Tarantula'}) 
```

或者在我的情况下，工作代码是：

```
from django.contrib.admin.filters import RelatedFieldListFilter

class UnitFilter(RelatedFieldListFilter):
    def field_choices(self, field, request, model_admin):
        return field.get_choices(include_blank=False, limit_choices_to={'pk__in': request.user.administrated_units.all()}) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-05-31T13:29:03.380

我必须从 db 表创建我的查找字段。我创建了如下自定义过滤器类，并仅显示登录用户的相关值并相应地过滤：

```
class ShiftFilter_Org(admin.SimpleListFilter):
title = 'Organisation'
parameter_name = 'org'

def lookups(self, request, model_admin):
"""Get the organisations you want to limit"""
    qs_org = Organisation.objects.filter(users=request.user)
    list_org = []
    for og in qs_org:
        list_org.append(
            (og.id, og.name)
        )
    return (
        sorted(list_org, key=lambda tp:tp[1])
    )

def queryset(self, request, queryset):
    if self.value():
        return queryset.filter(org=self.value()) 
```

有关更多信息，请访问[充分利用 Django Admin 过滤器](https://medium.com/elements/getting-the-most-out-of-django-admin-filters-2aecbb539c9a)

# scala - 路由远程参与者：对等体未通过身份验证

> ID：12522662
> 
> 赞同：0
> 
> 时间：2012-09-21T00:09:05.400
> 
> 标签：scala, networking, deployment, routing, akka

我正在尝试按照以下示例路由远程演员：

[http://doc.akka.io/docs/akka/snapshot/scala/routing.html#Remotely_Deploying_Routees](http://doc.akka.io/docs/akka/snapshot/scala/routing.html#Remotely_Deploying_Routees)

这是代码：

```
val system = ActorSystem("RemoteSystem", ConfigFactory.load.getConfig("remotecreation"))

val addresses = Seq(AddressFromURIString("akka://ActorApplication@172.17.100.224:2552"),
            AddressFromURIString("akka://ActorApplication@172.17.100.232:2552"))

val worker = system.actorOf(Props[authNetActor.AuthNetActorMain].withRouter(RemoteRouterConfig(RoundRobinRouter(5), addresses))) 
```

但是，我收到一条错误消息，指出其中一个服务器 IP 地址未经过身份验证。

这是错误（来自：172.17.100.224:2552）：

```
[ERROR] [09/20/2012 18:13:02.192] [ActorApplication-akka.actor.default-dispatcher-11 [akka://ActorApplication/remote/RemoteSystem@172.17.100.231:2554/user/$a/c1] peer not authenticated
javax.net.ssl.SSLPeerUnverifiedException: peer not authenticated
    at sun.security.ssl.SSLSessionImpl.getPeerCertificates(SSLSessionImpl.java:371)
    at org.apache.http.conn.ssl.AbstractVerifier.verify(AbstractVerifier.java:128)
    at org.apache.http.conn.ssl.SSLSocketFactory.connectSocket(SSLSocketFactory.java:390)
    at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:148)
    at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:149)
    at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:121)
    at org.apache.http.impl.client.DefaultRequestDirector.tryConnect(DefaultRequestDirector.java:562)
    at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:415)
    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:820)
    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:776)
    at dispatch.BlockingHttp$class.dispatch$BlockingHttp$$execute(Http.scala:45)
    at dispatch.BlockingHttp$$anonfun$execute$1$$anonfun$apply$3.apply(Http.scala:58)
    at dispatch.BlockingHttp$$anonfun$execute$1$$anonfun$apply$3.apply(Http.scala:58)
    at scala.Option.getOrElse(Option.scala:108)
    at dispatch.BlockingHttp$$anonfun$execute$1.apply(Http.scala:58)
at dispatch.Http.pack(Http.scala:25)
    at dispatch.BlockingHttp$class.execute(Http.scala:53)
    at dispatch.Http.execute(Http.scala:21)
    at dispatch.HttpExecutor$class.x(executor.scala:36)
    at dispatch.Http.x(Http.scala:21)
    at dispatch.HttpExecutor$class.when(executor.scala:50)
    at dispatch.Http.when(Http.scala:21)
    at dispatch.HttpExecutor$class.apply(executor.scala:60)
    at dispatch.Http.apply(Http.scala:21)
    at models.AuthorizeNet$.AuthorizeNetDPM(main.scala:187)
    at authNetActor.AuthNetActorMain$$anonfun$receive$1.apply(AuthNetActor.scala:68)
    at authNetActor.AuthNetActorMain$$anonfun$receive$1.apply(AuthNetActor.scala:12)
    at akka.actor.Actor$class.apply(Actor.scala:318)
    at authNetActor.AuthNetActorMain.apply(AuthNetActor.scala:9)
    at akka.actor.ActorCell.invoke(ActorCell.scala:626)
    at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:197)
    at akka.dispatch.Mailbox.run(Mailbox.scala:179)
    at akka.dispatch.ForkJoinExecutorConfigurator$MailboxExecutionTask.exec(AbstractDispatcher.scala:516)
    at akka.jsr166y.ForkJoinTask.doExec(ForkJoinTask.java:259)
    at akka.jsr166y.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:975)
    at akka.jsr166y.ForkJoinPool.runWorker(ForkJoinPool.java:1479)
    at akka.jsr166y.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:104) 
```

该错误仅发生在此服务器上，它们之间的区别在于代码路径不同，并且它们在自己的本地 IP 地址上创建参与者系统。否则，这两个参与者系统的代码是相同的。

我不确定如何修复此错误或为什么仅针对一台服务器抛出此错误。

任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T08:15:24.507

这似乎是一个 SSL 握手异常。

可能涉及的服务器没有有效的 SSL 证书，或者您没有在客户端密钥库中注册不受信任的证书。

# c - 打印期间出现意外的字符串行为

> ID：12522669
> 
> 赞同：0
> 
> 时间：2012-09-21T00:10:39.650
> 
> 标签：c

在字符串的情况下，我遇到了一些不可预测的行为。这里是：

```
 int main()
        {

          char *str = charfun();

          printf("%s",str);  // This is printing garbage values

          printf("%c%c%c%c",str[0],str[1],str[2],str[3]); /* if I am printing  
          like this it is printing the result "Helo" why is it so ?
          and str[4] is '\0' (checked its ASCII value)*/
          return 0;
        }

        char* charfun()
        {
          char a[10]="Helo";
          return a;
        } 
```

编辑 -

我关心的不是我要返回的本地地址。我知道它会给我带来麻烦。但我想了解两个 printf 遵循的打印方法并给出不同的结果。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-21T00:12:27.890

这是因为`a`in`charfun()`是一个本地数组。`charfun()`返回时，的`a`地址被分配给`str`，但它指向的数组已经失效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-21T00:15:15.297

这里的问题是，当您创建局部变量时，它被分配在堆栈上，因此一旦函数完成执行就无法使用。最好的方法是使用 malloc() 来保留非本地内存。该字符串`a`是函数的本地字符串，您不能返回指向它的指针，`Undefined Behavior`因此必须使用 malloc 在堆而不是堆栈上分配它：

```
char *charfun(){
    char *a = malloc(sizeof(char)*10);
    strcpy(a,"Helo");
    return a;
} 
```

# apache-pig - 在单独的关系中确定 int 的成员资格

> ID：12522674
> 
> 赞同：2
> 
> 时间：2012-09-21T00:11:08.770
> 
> 标签：apache-pig

这与确定一个关系中元组中的 int 值是否是 Pig Latin 中另一个关系中的列的成员值有关。我是 Pig Latin 的新手，我发现很难将我的思想包裹在框架上。

目前我有两个表，一个包含针对具有小值域的标签的 id 列表，另一个包含包含 id 和引用另一个表的标签 id 的元组。

这是orders.csv：

> 标识，标签
> 
> 第1597章
> 
> 999，是的
> 
> 787，一个
> 
> 第812章

和tags.csv：

> id, tag_id
> 
> 11, 55
> 
> 99, 812
> 
> 22, 787

我需要一种方法来确定订单表中所有元组的 tag_id 是否是标记表的 id 子集的成员。

> id, has_x
> 
> 111, 0
> 
> 99, 1
> 
> 22, 0

这是我到目前为止所拥有的：

> 使用 jython 作为任务注册 's3://bucket/jython_task.py'；
> 
> tags = load 's3://bucket/tags.csv' USING PigStorage(',') AS (i​​d: long, tag: chararray);
> 
> orders = load 's3://bucket/orders.csv' USING PigStorage(',') AS (i​​d: long, tag_id: long);
> 
> tags = 按标签过滤标签 == 'x';
> 
> x_cases = foreach 标签生成标签；
> 
> tagged_orders = foreach 订单生成 id, tag_id, tasks.check_membership(tag_id, x_cases.tag) as is_x:int;

和 udf：

```
def check_membership(instance, value_list):
if instance != None:
    for value in value_list:
        if instance == value[0]:
            return 1
return 0 
```

我得到错误：

> 2012-09-20 23:53:45,377 [main] 错误 org.apache.pig.tools.pigstats.SimplePigStats - 错误 2997：无法从支持的错误重新创建异常：org.apache.pig.backend.executionengine.ExecException：错误0：标量在输出中多于一行。第一名：（7995），第二名：（8028）

我究竟做错了什么？有没有更好的方法来做我想做的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T11:02:55.637

我最终找到了解决我自己问题的方法，它涉及针对这两个关系的左外连接，并且可能有一个更优雅的解决方案，我愿意接受任何更好的解决方案。

> tags = load 's3://bucket/tags.csv' USING PigStorage(',') AS (i​​d: long, tag: chararray);
> 
> orders = load 's3://bucket/orders.csv' USING PigStorage(',') AS (i​​d: long, tag_id: long);
> 
> tags = 按标签过滤标签 == 'x';
> 
> tag_cases = foreach标签生成id，1为found_tag:int；
> 
> tag_cases = 不同的 tag_cases;
> 
> 示例 = 按 o_id 加入订单，按 id 离开外部 tag_cases；
> 
> example = foreach 示例生成 orders::o_id 作为 id, (tag_cases is null ? 0 : 1) as has_tag;

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T10:52:52.233

我不知道 UDF 有什么问题，但你可以用纯 PIG 得到结果。使用**COGROUP**和**IsEmpty**内置函数。

```
x_cases = cogroup orders by (tag_id), tags by (id);
tagged_orders = foreach x_cases generate flatten(orders), IsEmpty(tags); 
```

或者

```
tagged_orders = filter x_cases by not IsEmpty(tags); 
```

它可能不是运行速度最快的实现，因为它使用 Reduce 侧连接，但这完全取决于卷。

一种更快的方法可能是使用**复制连接**，它将标签表加载到 RAM 中，并使用更快的 Map 侧连接。坏事是您将丢失未标记的记录。

```
tagged_orders = join orders by (tag_id), tags by (id) using 'replicated'; 
```

# maven - 使用 gradle 构建时读取 maven settings.xml？

> ID：12522676
> 
> 赞同：26
> 
> 时间：2012-09-21T00:11:42.823
> 
> 标签：maven, gradle

我有一个 Maven settings.xml 位于：

```
 /home/u123/.m2/settings.xml 
```

我在其中指定一个远程 Maven 存储库：

```
<?xml version="1.0" encoding="UTF-8"?>
<settings>
  <profiles>
    <profile>
      <id>default</id>
      <repositories>
          <repository>
              <id>my.repo</id>
               <url>http://myrepo/ </url>
          </repository>
      </repositories>
    </profile>
  </profiles>
  <activeProfiles>
    <activeProfile>default</activeProfile>
  </activeProfiles>
</settings> 
```

在这个 repo 中，我部署了一个工件 - 实际上它是一个 gradle 插件。

现在我尝试使用以下 build.gradle 文件构建另一个需要使用此插件/工件的项目：

```
apply plugin: 'java'
apply plugin: 'maven'

buildscript {
    dependencies {
        classpath 'com.test:my-gradle-plugin:1.0.0-SNAPSHOT'
    }
} 
```

但构建失败：

```
...
> Could not find group:com.test, module:my-gradle-plugin, version:1.0.0-SNAPSHOT.
... 
```

即使我有上面的 settings.xml 文件指向远程 maven 存储库，Gradle 也找不到 my-gradle-plugin。

如果我改为*在*我的 build.gradle 文件中指定存储库，它可以工作：

```
buildscript {
    repositories {
        maven {
            url "http://myrepo/"
        }
    }
    dependencies {
        classpath 'com.test:my-gradle-plugin:1.0.0-SNAPSHOT'
    }
} 
```

基于这篇文章：

[http://forums.gradle.org/gradle/topics/have_mavenlocal_check_m2_home_conf_settings_xml](http://forums.gradle.org/gradle/topics/have_mavenlocal_check_m2_home_conf_settings_xml)

似乎 gradle 考虑了 settings.xml 文件，所以出了什么问题？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-03-14T07:17:32.290

有一张与此相关的公开票有望被实施：

[http://issues.gradle.org/browse/GRADLE-2365](http://issues.gradle.org/browse/GRADLE-2365)

但作为一种解决方法，您可以在 build.gradle 中使用一些 groovy 脚本来实现这一点。在我的情况下，我需要来自 settings.xml 的身份验证信息。但这可以很容易地适应获取存储库信息。

例子：

```
def getMavenSettingsCredentials = {
    String userHome = System.getProperty( "user.home" );
    File mavenSettings = new File(userHome, ".m2/settings.xml")
    def xmlSlurper = new XmlSlurper()
    def output = xmlSlurper.parse(mavenSettings)
    return output."servers"."server"
}

def getCredentials = {
    def entries = getMavenSettingsCredentials()
    for (entry in entries) {
        if ( entry."id".text() == "my-server" ) {
            return [username: entry.username.text(), password: entry.password.text()]
    }
  }
}
uploadArchives {
def creds = getCredentials()
repositories.mavenDeployer {
    configuration = configurations.deployerJars
    repository(url: "http://my-release-repository/releases/") {
        authentication(userName: creds["username"], password: creds["password"])
    }
    snapshotRepository(url: "http://my-snapshot-repository/snapshots/") {
        authentication(userName: creds["username"], password: creds["password"])
    }

  }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2018-05-26T19:26:27.370

[gradle-maven-settings-plugin](https://github.com/mark-vieira/gradle-maven-settings-plugin)对我有用（至少在我的 Windows 环境中）

一个应该添加

```
buildscript {
    repositories {
        maven {
            url "https://plugins.gradle.org/m2/"
        }
    }
}

plugins {
    id 'net.linguica.maven-settings' version '0.5'
} 
```

`build.gradle`然后可以像这样添加存储库：

```
repositories {
    maven {
        name = 'myRepo' // should match <id>myRepo</id> of appropriate <server> in Maven's settings.xml
        url = 'https://intranet.foo.org/repo'
    }
} 
```

它将使用`myRepo`来自 Maven 的凭据`settings.xml`来访问[https://intranet.foo.org/repo](https://intranet.foo.org/repo)存储库

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-09-21T00:20:48.270

您必须在 Gradle 构建脚本中声明所有存储库。`settings.xml`仅用于查找本地 Maven 存储库的位置，例如在解析`repositories { mavenLocal() }`.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-02-10T18:39:22.967

我使用 maven-publish、maven-publish-auth 插件来完成此操作，而无需手动解析设置

[Gradle 如何使用来自 Maven 的 Settings.xml 的存储库设置来发布工件](http://forums.gradle.org/gradle/topics/how_can_gradle_use_repository_settings_from_mavens_settings_xml_to_publish_artifacts_to_a_repository?rfm=1)

希望它是有用的。

彼得

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-12-28T07:40:37.587

见：[https ://github.com/ci-and-cd/maven-settings-decoder](https://github.com/ci-and-cd/maven-settings-decoder)

我在 gradle 构建脚本中使用它来避免在 build.gradle 或环境变量中暴露 nexus 密码。

```
buildscript {
  repositories {
    ...
    mavenCentral()
  }
  dependencies {
    ...
    classpath 'cn.home1.tools:maven-settings-decoder:1.0.5.OSS'
  }
}
...
ext.mavenSettings = new cn.home1.tools.maven.SettingsDecoder();
ext.nexusSnapshotsUser = mavenSettings.getText("//server[id='${nexus}-snapshots']/username/text()")
ext.nexusSnapshotsPass = mavenSettings.getText("//server[id='${nexus}-snapshots']/password/text()")
println "${nexus}-snapshots username: " + mavenSettings.getText("//server[id='${nexus}-snapshots']/username/text()")
println "${nexus}-snapshots password: " + mavenSettings.getText("//server[id='${nexus}-snapshots']/password/text()")
... 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-11-08T22:12:37.123

请在 build.gradle 文件的存储库部分中使用 mavenLocal()。这应该读取您主目录中的 ~/.m2/settings.xml 文件。

```
repositories {
    mavenCentral()
    mavenLocal()
} 
```

# python - 如何在 Python 中做 GOTO 可以做的事情 - 重新加载然后重新启动外循环

> ID：12522678
> 
> 赞同：0
> 
> 时间：2012-09-21T00:11:58.217
> 
> 标签：python, structure, goto

这是我用作示例的程序的简化版本。

我知道使用 GOTO 是不好的做法，因为它会导致代码草率和混乱，但是它非常适合解决我遇到的这个问题（问题在帖子底部详细说明）。

```
def prompt():
    while True:
        user_input = raw_input:
        if input == '?':
            print help_o
        elif not user_input.isalpha():
            print "You entered bad characters"
        elif user_input == 'r': ##Restart
            ???????????
        else:
            return user_input

load_word_list() ##Load words into list

for word in wordList: ##Loop that needs to restart
    for i in range(5):
        to_speak = "Spell, %s" %word
        subprocess.Popen(['espeak', to_speak])
        answer = prompt()
        if answer != word:
            print "You got it wrong"

#Print results 
```

在提示符处，我想重新加载 wordList 列表并重新启动外部 for 循环。

使用 GOTO，我可以代替 ????... GOTO load_word_list()。

但既然这是 Python（而且 Python 是关于好代码的），那么解决这个问题的 Python 方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-21T00:17:07.537

您可以从以下位置返回一个元组`prompt()`：

```
 elif user_input == 'r': #Restart
        return True, None
    else:
        return False, user_input 
```

和

```
 restart, answer = prompt()
    if restart:
        break
    if answer != word:
        print "You got it wrong" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T02:27:12.123

另一种 jsbuenos 解决方案。这实际上**会**重新运行外部 for 循环。

```
def prompt():
    while True:
        user_input = raw_input()
        if input == '?':
            print help_o
        elif not user_input.isalpha():
            print "You entered bad characters"
        elif user_input == 'r': #Restart
            raise RestartException
        else:
            return user_input

class RestartException(Exception):
    pass

while True:
    load_word_list() ##Load words into list
    try:
        for word in wordList: ##Loop that needs to restart
            for i in range(5):
                to_speak = "Spell, %s" %word
                subprocess.Popen(['espeak', to_speak])
                answer = prompt()
                if answer != word:
                    print "You got it wrong"
    except RestartException:
        # catch the exception and return to while loop
        pass
    else:
        # exit while loop
        break 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-21T00:19:16.933

```
class RestartException(Exception):
    pass

def prompt():
    while True:
        user_input = raw_input:
        if input == '?':
            print help_o
        elif not user_input.isalpha():
            print "You entered bad characters"
        elif user_input == 'r': #Restart
            raise RestartException
        else:
            return user_input

load_word_list() ##Load words into list

for word in wordList: ##Loop that needs to restart
    try:
        for i in range(5):
            to_speak = "Spell, %s" %word
            subprocess.Popen(['espeak', to_speak])
            answer = prompt()
            if answer != word:
                print "You got it wrong"
     except RestartException:
        pass 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-21T01:14:53.693

```
def prompt():
    while True:
        user_input = raw_input("enter words")
        if input == '?':
            print help_o
        elif not user_input.isalpha():
            print "You entered bad characters"
        elif user_input == 'r': #Restart
            return False
        else:
            return user_input

answer = True

while answer == True:
    load_word_list() ##Load words into list

    for word in wordList: ##Loop that needs to restart
        for i in range(5):
            to_speak = "Spell, %s" %word
            subprocess.Popen(['espeak', to_speak])
            answer = prompt()
            if answer == False:
                answer = True # reset for the while loop
                break # break to while loop
            elif answer != word:
                print "You got it wrong"

print results 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-21T00:16:55.100

我不太了解您想要做什么，但是您可以删除特殊情况并直接在 for 循环中`prompt`处理特殊情况`'r'`

# java - 从 java 导出到 pdf 文件时，已经为此响应调用了 getOutputStream()

> ID：12522680
> 
> 赞同：0
> 
> 时间：2012-09-21T00:12:19.170
> 
> 标签：java, export-to-pdf

我的 java 类中有以下代码部分。

```
if(exportTo.equals("pdf"))
        {
        response.setHeader("Content-disposition", "attachment; filename=\"" + reportName + ".pdf\"");
        response.setContentType("application/pdf");
        PdfWriter.getInstance(document,response.getOutputStream());

        try {
            document.open();
            addTitlePage(document, reportName);

            Image image = Image.getInstance(path+"/"+"images/abi.png");
            image.setAbsolutePosition(40f, 770f);
            image.scaleAbsolute(70f, 50f);
            document.add(image);
            response.flushBuffer();

            //float[] colsWidth = {1.5f,3f,4f,4f,2f};

            List<Float> colsWidth = new ArrayList<Float>();
            int iterator = 1;
           while (iterator <= headerMap.size()) {
               if(iterator==1){
                   colsWidth.add(1.5f); 
               }else{
                colsWidth.add(3f); 
               }
                iterator++;
            }
           float[] floatArray = ArrayUtils.toPrimitive(colsWidth.toArray(new Float[0]), 0.0F);

           PdfPTable table = new PdfPTable(floatArray);
            table.setWidthPercentage(98);
            table.setHorizontalAlignment(Element.ALIGN_CENTER);

            PdfPCell c1 = new PdfPCell();
            for (Iterator it = headerMap.keySet().iterator(); it.hasNext();) {
                String headerName = (String) headerMap.get(it.next());
                c1 = new PdfPCell(new Phrase(headerName, headerFont));
                c1.setBackgroundColor(BaseColor.LIGHT_GRAY);
                table.addCell(c1);
            }
            table.setHeaderRows(1);
            table = custDAO.creadPDFTable(query, table);
            document.add(table);
            document.addAuthor(userViewModel.getUsername());
            document.addCreationDate();
            document.addCreator("POC");
            document.close();
            response.flushBuffer();
        } catch (Exception ex) {
            ex.printStackTrace();
        }
        } 
```

当我从代码中删除以下行时，我没有得到任何异常，但是当我包含这些行时，我得到`java.lang.IllegalStateException: getOutputStream() has already been called for this response`异常。

```
 Image image = Image.getInstance(path+"/"+"images/abi.png");
                image.setAbsolutePosition(40f, 770f);
                image.scaleAbsolute(70f, 50f);
                document.add(image);
                response.flushBuffer(); 
```

我使用上面的代码将图像添加到 pdf 文件（`itextpdflibrary`）

这可能是什么解决方案，请告诉我，因为我已经面对这个问题很长时间了。

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T01:22:36.897

也许解决方案将是：

尝试将所有文​​档内容放在尝试结束时：

```
try{
// create all object here, but don't add it to document yet.

// add all to document:
PdfWriter.getInstance(document,response.getOutputStream()); 
document.open();
addTitlePage(document, reportName);
document.add(image);
document.add(table);
document.addAuthor(userViewModel.getUsername());
document.addCreationDate();
document.addCreator("POC");
document.close();
response.flushBuffer();

} catch (Exception ex) {
  ex.printStackTrace();
} 
```

没有其他想法如何摆脱异常

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-22T06:14:53.867

我有一个单独的方法可以将图像添加到文档中并调用它来解决我的问题。

感谢你的帮助。

```
Image image = Image.getInstance(path+"/"+"images/abi.png");
                image.setAbsolutePosition(40f, 770f);
                image.scaleAbsolute(70f, 50f);
                document.add(image);
                response.flushBuffer(); 
```

# vb.net - 如何在 VB.NET 中集成像 CPLEX 这样的线性规划求解器？

> ID：12522681
> 
> 赞同：1
> 
> 时间：2012-09-21T00:12:25.723
> 
> 标签：vb.net, solver, linear-programming, cplex

我想解决一个通过 VB.NET 构建的线性编程模型。在这种情况下，我有以下问题，

a) 如何通过 VB.NET 调用 CPLEX 或任何此类求解器（Coin-OR）？（这样做时我不希望打开 CPLEX 窗口。即它应该在后台解决它。）

b) 如何将 LP 模型转移到 CPLEX？（再次，我想远离打开一个新窗口，然后将模型写入 CPLEX）

VB.NET 理解：中级

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-21T05:50:29.030

[Microsoft Solver Foundation](http://msdn.microsoft.com/en-us/library/ff524509%28v=vs.93%29.aspx)为 CPLEX 提供了一个插件，并且有一些[示例](http://msdn.microsoft.com/en-us/library/ff524501%28v=vs.93%29.aspx)显示了如何调用 CPLEX 插件以及如何从*VB.NET调用**MSF*。您可以从[这里下载标准的](http://msdn.microsoft.com/en-us/devlabs/hh145003.aspx)*MSF*库。

 *** * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-21T19:58:28.973

CPLEX 可以通过[CPLEX/Concert .NET API 在 VB.NET 中使用，CPLEX/Concert .NET API](http://pic.dhe.ibm.com/infocenter/cosinfoc/v12r2/topic/ilog.odms.cplex.help/html/refdotnetcplex/html/R_Project.htm)是随求解器提供的标准 API，使用起来非常简单。有一个很好的文档可用，包括[这个例子](http://pic.dhe.ibm.com/infocenter/cosinfoc/v12r2/index.jsp?topic=/ilog.odms.cplex.help/Content/Optimization/Documentation/CPLEX/_pubskel/CPLEX30.html)和[这个教程](http://pic.dhe.ibm.com/infocenter/cosinfoc/v12r2/index.jsp?topic=/ilog.odms.cplex.help/Content/Optimization/Documentation/CPLEX/_pubskel/CPLEX135.html)。示例在 C# 中，但应该让您了解如何在任何 .NET 语言中使用 API。

您也可以使用 MS Solver Foundation，但它会产生额外费用并且该产品已[停产](https://stackoverflow.com/a/11337594/471164)。**

# java - eclipselink jpa 实体未在 db 中显示为表

> ID：12522689
> 
> 赞同：0
> 
> 时间：2012-09-21T00:13:27.863
> 
> 标签：java, jpa, eclipselink

我正在尝试使用 eclipselink jpa 使测试项目工作，但是每次尝试将 Poll 对象持久保存在数据库中时，我都会遇到一个尴尬的问题。例如，它适用于 User 类对象。我想，这可能是我对 ManyToMany 注释有问题。所以，我有四个实体类：

投票类

```
@Entity
@Table(name = "Polls")
public class Poll implements Serializable {

private static final long serialVersionUID = 1L;
@Id
@GeneratedValue(strategy = GenerationType.AUTO)
private Long id;
private String title;
@Temporal(TemporalType.TIMESTAMP)
private Date expirationDate;
private String description;
private boolean expired;
private boolean show = false;
@OneToMany(cascade = CascadeType.ALL, mappedBy = "poll")
private List<Option> options;
@ManyToMany(cascade = CascadeType.ALL, mappedBy = "polls")
@JoinTable(name = "POLL_USER")
private List<User> users;

public Poll() {
}

public Poll(String title, Date expirationDate, String description,
        boolean expired, boolean show) {
    super();
    this.title = title;
    this.expirationDate = expirationDate;
    this.description = description;
    this.expired = expired;
    this.show = show;
}

public Poll(String title, Date expirationDate, String description,
        boolean expired, boolean show, List<Option> options,
        List<User> users) {
    super();
    this.title = title;
    this.expirationDate = expirationDate;
    this.description = description;
    this.expired = expired;
    this.show = show;
    this.options = options;
    this.users = users;
} 
```

选项类

```
@Entity
@Table(name = "Options")
public class Option implements Serializable {

    /**
     * 
     */
    private static final long serialVersionUID = 1L;
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;
    private String text;
    private int voteCount = 0;
    @ManyToOne
    @JoinColumn(name = "POLL_ID", referencedColumnName = "id", nullable = false)
    private Poll poll;
    @OneToMany(cascade = CascadeType.ALL, mappedBy = "option")
    private List<Vote> votes;

    public Option() {
    }

    public Option(String text, int voteCount) {
        super();
        this.text = text;
        this.voteCount = voteCount;
    }

    public Option(String text, int voteCount, Poll poll, List<Vote> votes) {
        super();
        this.text = text;
        this.voteCount = voteCount;
        this.poll = poll;
        this.votes = votes;
    } 
```

投票类

```
@Entity
@Table(name = "Votes")
public class Vote implements Serializable {

    /**
     * 
     */
    private static final long serialVersionUID = 1L;
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long vid;
    private String comment;
    @ManyToOne
    @JoinColumn(name = "USER_ID", referencedColumnName = "id", nullable = false)
    private User user;
    @ManyToOne
    @JoinColumn(name = "OPTION_ID", referencedColumnName = "id", nullable = false)
    private Option option;

    public Vote() {
    }

    public Vote(String comment) {
        super();
        this.comment = comment;
    }

    public Vote(String comment, User user, Option option) {
        super();
        this.comment = comment;
        this.user = user;
        this.option = option;
    } 
```

用户类

```
@Entity
@Table(name = "Users")
public class User implements Serializable {

    /**
     * 
     */
    private static final long serialVersionUID = 1L;
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;
    private String login;
    private Long groupId;
    private String email;
    @ManyToMany
    private List<Poll> polls;
    @OneToMany(cascade = CascadeType.ALL, mappedBy = "user")
    private List<Vote> votes;

    public User() {
        super();
    }

    public User(String login, Long groupId, String email) {
        super();
        this.login = login;
        this.groupId = groupId;
        this.email = email;
    }

    public User(String login, Long groupId, String email, List<Poll> polls,
            List<Vote> votes) {
        super();
        this.login = login;
        this.groupId = groupId;
        this.email = email;
        this.polls = polls;
        this.votes = votes;
    } 
```

我收到一个错误：

```
Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.4.0.v20120608-r11652): org.eclipse.persistence.exceptions.DatabaseException
Internal Exception: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SHOW, TITLE) VALUES (351, 'Just testing', '2012-09-21 01:49:42', 1, 1, 'My first' at line 1
Error Code: 1064
Call: INSERT INTO Polls (ID, DESCRIPTION, EXPIRATIONDATE, EXPIRED, SHOW, TITLE) VALUES (?, ?, ?, ?, ?, ?)
    bind => [6 parameters bound]
Query: InsertObjectQuery(Poll [id=351, title=My first poll, expirationDate=Fri Sep 21 01:49:42 CEST 2012, description=Just testing, expired=true, show=true]) 
```

这是我的 persistence.xml 文件：

```
<persistence-unit name="company" transaction-type="RESOURCE_LOCAL">
        <class>logic.Poll</class>
        <class>logic.Option</class>
        <class>logic.Vote</class>
        <class>logic.User</class>
        <properties>
            <property name="javax.persistence.jdbc.driver" value="com.mysql.jdbc.Driver" />
            <property name="javax.persistence.jdbc.url"
                value="jdbc:mysql://localhost:3306/eclipselink_example" />
            <property name="javax.persistence.jdbc.user" value="" />
            <property name="javax.persistence.jdbc.password" value="" />

            <property name="eclipselink.logging.level" value="FINEST" />
            <property name="eclipselink.logging.file" value="output.log" />
            <property name="eclipselink.logging.logger" value="JavaLogger" />
            <!-- EclipseLink should create the database schema automatically -->

            <property name="eclipselink.ddl-generation" value="create-and-drop-tables" />
            <property name="eclipselink.ddl-generation.output-mode"
                value="database" />
        </properties>
    </persistence-unit> 
```

编译后，我在 db 中有五个表：Options、SEQUENCE、Users、Users_Polls 和 Votes。我不明白，投票表在哪里。抱歉写了这么多信，希望你能帮到我。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T00:23:49.350

**在Poll.java 中**试试这个

 **```
@ManyToMany
@JoinTable(name = "poll_user", joinColumns =
@JoinColumn(name = "poll_id", referencedColumnName = "id"), inverseJoinColumns =
@JoinColumn(name = "user_id", referencedColumnName = "id"))
private List<User> users; 
```

在你的**User.java里面**

```
@ManyToMany(mappedBy = "users")
private List<Poll> polls; 
```

也不要忘记**为你的变量设置 getter 和 setter**

**修订**

首先我会改变所有的：

`@GeneratedValue(strategy = GenerationType.SEQUENCE)`

至：

`@GeneratedValue(strategy = GenerationType.IDENTITY)`

我会检查你在 Mysql 中没有保留字的变量。

例如：

在**Poll.java**里面你有：

`private boolean show;`但**SHOW**是 MySQL 中的保留字

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T04:27:45.420

我认为，[EclipseLink JPA](http://wiki.eclipse.org/EclipseLink/Examples/JPA/PrimaryKey)将对您的`ID Generation`问题有所帮助。如果你使用`@GeneratedValue(strategy = GenerationType.AUTO)`它取决于数据库。祝你好运！尽可能多的，`GenerationType.TABLE`独立的数据库**

# php - 正则表达式匹配 - 无法解决

> ID：12522700
> 
> 赞同：0
> 
> 时间：2012-09-21T00:15:32.180
> 
> 标签：php, regex, preg-match, pcre

我有一个字符串，我需要将其解析为 PHP 中的数组。字符串看起来像这样：

```
(Key: ALL_HTTP)(Value:HTTP_HOST:10.1.1.1 )(Key: ALL_RAW)(Value:Host: 10.1.1.1:80 )(Key: APPL_MD_PATH)(Value:/ROOT)(Key: AUTH_TYPE)(Value:)(Key: AUTH_USER)(Value:)(Key: AUTH_PASSWORD)(Value:)(Key: LOGON_USER)(Value:)(Key: REMOTE_USER)(Value:) 
```

“键/值”对的数量可以是无限的，但通常每个字符串大约 30-40 个。

我一直在玩 preg_match 和 PHP.net 的一个例子的变体——像这样：

```
preg_match('/(\S+): (\S+)/', $string, $result); 
```

这让我把第一个键作为 $result[0] 找回，但对其余的没有帮助。

如果有人能用正确的表达方式帮助我，那就太好了。我也很感激任何用 PCRE 分割字符串的好的阅读资源。

谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T01:07:12.387

尝试一些类似的东西

```
preg_match_all('/\(([^:)]+):\s*([^)]*)\)/',
        "(Key: ALL_HTTP)(Value:HTTP_HOST:10.1.1.1 )(Key: ALL_RAW)(Value:Host: 10.1.1.1:80 )(Key: APPL_MD_PATH)(Value:/ROOT)(Key: AUTH_TYPE)(Value:)(Key: AUTH_USER)(Value:)(Key: AUTH_PASSWORD)(Value:)(Key: LOGON_USER)(Value:)(Key: REMOTE_USER)(Value:)",
        $out, PREG_SET_ORDER);

foreach ($out as $pair) {
    echo "ALL: ".$pair[0]."\n";
    echo "KEY: ".$pair[1]."\n";
    echo "VAL: ".$pair[2]."\n";
} 
```

您可能不需要所有行。

根据您的示例字符串，您可能更喜欢这个正则表达式：

```
'/\(Key: ([^)]+)\)\(Value:([^)]*)\)/' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T01:29:01.763

正则表达式`/\(Key:\s*(.*?)\)\(Value:\s*(.*?)\)/`将匹配字符串中的所有键/值对

`$data`该程序使用元素中相关的每个键/值对构建一个数组

```
$str = '(Key: ALL_HTTP)(Value:HTTP_HOST:10.1.1.1 )(Key: ALL_RAW)(Value:Host: 10.1.1.1:80 )(Key: APPL_MD_PATH)(Value:/ROOT)(Key: AUTH_TYPE)(Value:)(Key: AUTH_USER)(Value:)(Key: AUTH_PASSWORD)(Value:)(Key: LOGON_USER)(Value:)(Key: REMOTE_USER)(Value:)';

$list = preg_match_all('/\(Key:\s*(.*?)\)\(Value:\s*(.*?)\)/', $str, $data);
$data = array_combine($data[1], $data[2]);

var_dump($data); 
```

**输出**

```
array(8) {
  ["ALL_HTTP"]=>
  string(19) "HTTP_HOST:10.1.1.1 "
  ["ALL_RAW"]=>
  string(18) "Host: 10.1.1.1:80 "
  ["APPL_MD_PATH"]=>
  string(5) "/ROOT"
  ["AUTH_TYPE"]=>
  string(0) ""
  ["AUTH_USER"]=>
  string(0) ""
  ["AUTH_PASSWORD"]=>
  string(0) ""
  ["LOGON_USER"]=>
  string(0) ""
  ["REMOTE_USER"]=>
  string(0) ""
} 
```

# twitter-bootstrap - 将 Bootstrap 网格自定义为 840px

> ID：12522701
> 
> 赞同：-1
> 
> 时间：2012-09-21T00:15:41.660
> 
> 标签：twitter-bootstrap

我从这里下载了自定义版本的 Bootstrap：http: [//twitter.github.com/bootstrap/customize.html](http://twitter.github.com/bootstrap/customize.html)

我更改的唯一设置是 @gridColumnWidth 从 60px 到 50px 给我一个 840px 的网格系统，而不是标准的 960px。

但是，我在屏幕宽度为 768px 时遇到了问题，例如顶部固定的导航栏被破坏：

![图片](../Images/139475c56a60f4fc060c60d8fd6cd810.png)

使用默认设置，导航栏保持固定：

![图片](../Images/1d747b53a8d75d9875fdeb0ab1dfe555.png)

任何人都可以告知为什么会发生这种情况以及应该调整哪些其他设置？我选择了 840px，因为我需要一个由 3 个等宽列组成的相当窄的设计。在这种情况下，280px 包括排水沟。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T23:30:37.800

您可以使用固定容器和流体行制作任意宽度的固定网格。

演示：http: [//jsfiddle.net/sonic1980/chKWm/](http://jsfiddle.net/sonic1980/chKWm/)

**HTML：**

```
<div id=container class=container>
    <div class=row-fluid>
        <div class=span4>4</div>
        <div class=span4>4</div>
        <div class=span4>4</div>
    </div>
... 
```

**CSS：**

```
#container {
    width: 500px;   <-- put here your desired width. 
                        You can also play with max-width and min-width
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-21T15:06:37.650

哼！我没有在页面宽度上找到任何明确的选项（这是我已经遇到的问题），

在此定制中提供的缺点是 - 在响应段落中 - 在 3 种尺寸之间进行选择：

*   大（> 1200 像素）

*   平板电脑到桌面 (767-979px)，以及

*   窄平板及以下 (<767px)。..

# android - startActivity 从同一应用程序中的另一个活动重新启动 HomeActivity 在 Gingerbread 中不起作用

> ID：12522713
> 
> 赞同：1
> 
> 时间：2012-09-21T00:17:23.653
> 
> 标签：android, android-2.3-gingerbread, start-activity

在我的应用程序中，我使用了 iosched 2012 应用程序中的一些代码。具体来说，启动工作流程如下：

1.用户按下应用程序的启动器图标

2.HomeActivity 检查用户是否通过身份验证。如果他/她不是，它将启动身份验证活动，将其意图传递给它并自行完成

3.登录过程成功后，authenction Activity 启动一个Activity 以启动HomeActivity 并自行结束

4.HomeActivity 再次检查用户是否通过身份验证并显示应用程序的主屏幕。

下面的代码在 API Level > 11 中就像一个魅力。今天，我在 Gingerbread 中尝试了该应用程序，但它失败了。第 3 步有效，但尽管 HomeActivity 启动它并没有被带到前面。您必须使用最近列表并选择应用程序才能查看 homeactivity 及其现在显示的内容。

这是代码并从 oncCreate 方法中的 HomeActivity 检查

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    if(!AccountUtils.isSystemAuthenticated(this)) {
        AccountUtils.startSystemAuthentication(this, getIntent());
        finish();
    } else if(!AccountUtils.isAppAuthenticated(this)) {
        AccountUtils.startAppAuthentication(this, getIntent());
        finish();
    } 

    if(isFinishing()) {
        return;
    }

    setContentView(R.layout.activity_main);
            ...
    }
 } 
```

登录过程完成后在 Authentication 活动中调用的方法

```
protected void handleLoginSuccess(LoginServiceResponse response, String username, String password) {
if(....) {
        if(mFinishIntent != null) {
            mFinishIntent.addCategory(Intent.CATEGORY_LAUNCHER);
            mFinishIntent.setAction(Intent.ACTION_MAIN);
            mFinishIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK
                        | Intent.FLAG_ACTIVITY_CLEAR_TASK);
                startActivity(mFinishIntent);
        }

        finish();
        } else {
            super.handleLoginSuccess(response, username, password);
        }
    } 
```

其中 mFinishIntent 成员变量是从 HomeActivity 传递的意图（使用 getIntent()）

正如我所提到的，在 API Level > 11 中，这运行良好，并且 HomeActivity 的 onCreted 方法中的断点被命中两次，而在 Gingerbread 手机中，仅被命中一次（仅在应用程序启动时）。

我是否必须使用另一个标志或者您对发生的事情有任何其他想法？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T00:39:12.963

可能发生的情况是该活动仅在应用程序启动时创建，然后当您从身份验证活动返回到它时，它只是恢复。尝试将身份验证检查代码放在 onResume() 方法中的 HomeActivity 中。

这是更多信息：http: [//developer.android.com/reference/android/app/Activity.html#ProcessLifecycle](http://developer.android.com/reference/android/app/Activity.html#ProcessLifecycle)

# c# - 与 EventHandler 的线程同步

> ID：12522714
> 
> 赞同：0
> 
> 时间：2012-09-21T00:17:29.877
> 
> 标签：c#, synchronization

我坚持选择同步原语。

情况就是这样：我有线程池，处于不定式循环中，并等待某个事件。还有另一个应该调用这个事件的线程。当事件触发时，所有等待线程都应该进行一次迭代并再次回退等待事件。

我应该为此使用 manualResetEvent 吗？我不明白，是否有任何保证，如果我在控制线程中写了这样的东西

```
event.Set();
event.Reset(); 
```

所有等待的线程都进行迭代，所有等待的线程只进行一次迭代，而不是两次或三次迭代。

或者我应该为我的案例使用另一个原语？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T00:20:35.300

`Monitor.Wait(someObject)`在循环线程和`Monitor.PulseAll(someObject)`事件引发线程中使用。

# ios - 需要追踪 1.5 版 Google Analytics for iOS 的副本

> ID：12522715
> 
> 赞同：1
> 
> 时间：2012-09-21T00:17:35.713
> 
> 标签：ios, google-analytics

我正在将 Google Analytics 添加到我的 armv6/armv7 项目中，但在尝试为 armv6 设备构建时出现链接器错误：

```
libGoogleAnalytics.a, file is universal but does not contain a(n) armv6 slice for architecture armv6 
```

事实证明，我使用的 Google Analytics 版本（1.5.1）放弃了对 armv6 的支持。任何人都可以指导我获得 1.5 版的副本，我认为它可以在我的项目中使用吗？

谷歌似乎没有保留存档版本，我也无法在网上找到一份副本。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-21T01:20:44.917

我通过猜测网址得到了它。

[http://dl.google.com/gaformobileapps/GoogleAnalyticsiOS_1.5.tar.gz](http://dl.google.com/gaformobileapps/GoogleAnalyticsiOS_1.5.tar.gz)

# java - 在 crawler4j 上确定参数

> ID：12522716
> 
> 赞同：0
> 
> 时间：2012-09-21T00:17:40.377
> 
> 标签：java, html, parsing, web-crawler, crawler4j

我正在尝试使用 crawler4j，就像在[此](http://code.google.com/p/crawler4j/source/browse/src/test/java/edu/uci/ics/crawler4j/examples/basic/BasicCrawlController.java)示例中使用的那样，无论我如何定义爬虫的数量或更改根文件夹，我都会继续从代码中收到此错误：

“需要的参数：rootFolder（它将包含中间爬取数据）numberOfCralwers（并发线程数）”主要代码如下：

```
public class Controller {

    public static void main(String[] args) throws Exception {

            if (args.length != 2) {
                    System.out.println("Needed parameters: ");
                    System.out.println("\t rootFolder (it will contain intermediate crawl data)");
                    System.out.println("\t numberOfCralwers (number of concurrent threads)");
                    return;
            }

            /*
             * crawlStorageFolder is a folder where intermediate crawl data is
             * stored.
             */
            String crawlStorageFolder = args[0];

            /*
             * numberOfCrawlers shows the number of concurrent threads that should
             * be initiated for crawling.
             */
            int numberOfCrawlers = Integer.parseInt(args[1]); 
```

有一个类似的问题问我到底想知道什么[，](https://stackoverflow.com/questions/10001233/implementation-of-crawler4j)但我不太明白解决方案，比如我在哪里输入**java BasicCrawler Controller "arg1" "arg2"**。我在 Eclipse 上运行这段代码，但我对编程世界还是很陌生。如果有人帮助我理解这个问题，我将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T14:16:19.173

要在您的项目中使用 crawler4j，您必须创建两个类。其中一个是CrawlController（根据参数启动爬虫），另一个是Crawler。

只需运行Controller类中的main方法，即可查看爬取的页面

这是 Controller.java 文件：

```
import edu.uci.ics.crawler4j.crawler.CrawlConfig;
import edu.uci.ics.crawler4j.crawler.CrawlController;
import edu.uci.ics.crawler4j.fetcher.PageFetcher;
import edu.uci.ics.crawler4j.robotstxt.RobotstxtConfig;
import edu.uci.ics.crawler4j.robotstxt.RobotstxtServer;

public class Controller {
public static void main(String[] args) throws Exception {

    RobotstxtConfig robotstxtConfig2 = new RobotstxtConfig();

    System.out.println(robotstxtConfig2.getCacheSize());
    System.out.println(robotstxtConfig2.getUserAgentName());

    String crawlStorageFolder = "/crawler/testdata";
    int numberOfCrawlers = 4;
    CrawlConfig config = new CrawlConfig();
    config.setCrawlStorageFolder(crawlStorageFolder);

    PageFetcher pageFetcher = new PageFetcher(config);
    RobotstxtConfig robotstxtConfig = new RobotstxtConfig();

    System.out.println(robotstxtConfig.getCacheSize());
    System.out.println(robotstxtConfig.getUserAgentName());

    RobotstxtServer robotstxtServer = new RobotstxtServer(robotstxtConfig, pageFetcher);
    CrawlController controller = new CrawlController(config, 
                 pageFetcher, robotstxtServer);

    controller.addSeed("http://cyesilkaya.wordpress.com/");
    controller.start(Crawler.class, numberOfCrawlers);
  }
   } 
```

这是 Crawler.java 文件：

```
 import java.io.IOException;
   import edu.uci.ics.crawler4j.crawler.Page;
   import edu.uci.ics.crawler4j.crawler.WebCrawler;
   import edu.uci.ics.crawler4j.url.WebURL;

   public class Crawler extends WebCrawler {

    @Override
    public boolean shouldVisit(WebURL url) {
         // you can write your own filter to decide crawl the incoming URL or not.
        return true;
    }

    @Override
    public void visit(Page page) {          
        String url = page.getWebURL().getURL();
        try {
        String url = page.getWebURL().getURL();
                System.out.println("URL: " + url);   
    }
    catch (IOException e) {
    }
      }
   } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T09:34:30.587

如果您在运行文件时没有提供任何参数，您将收到该错误。将以下内容作为注释放入您的代码中或将其删除。

```
if (args.length != 2) {
                System.out.println("Needed parameters: ");
                System.out.println("\t rootFolder (it will contain intermediate crawl data)");
                System.out.println("\t numberOfCralwers (number of concurrent threads)");
                return;
        } 
```

然后将根文件夹设置为要存储元数据的文件夹。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-02T22:36:38.080

在 Eclipse 中：->单击运行->单击运行配置...

在弹出窗口中：

首先，左栏：确保在子目录 Java Application 中选择了您的应用程序，否则创建一个新的（单击新建）。

然后在中央窗口中，继续“参数”

在“程序参数”下写下你的参数一旦你写了你的第一个参数，按回车键输入第二个参数，依此类推......（=换行，因为 args 是 []）

然后点击应用

然后单击运行。

# c# - 如何防止替换 XML 文件中的先前数据

> ID：12522721
> 
> 赞同：1
> 
> 时间：2012-09-21T00:18:23.360
> 
> 标签：c#, .net, xml

我正在 Windows 窗体应用程序中创建示例登录表单，并且尝试将登录用户名或密码保存在 XML 文件中，但是当我提交用户名或密码时，它会替换以前的条目。

我想要的是，当我提交用户名或密码时，它应该附加到同一个 XML 文件中，但不要替换任何以前的条目。

喜欢：

```
<Table>
  <Entry>
    <User>first_user1@gmail.com</User> 
    <Password>*********</Password> 
  </Entry>
</Table>

<Table>
  <Entry>
    <User>second_user2@gmail.com</User> 
    <Password>*********</Password> 
  </Entry>
</Table> 
```

但是它每次都替换第一个实体并且没有为第二个条目提供空间

请给我解决方案

这是我的代码：

```
private void button1_Click(object sender, EventArgs e)
{
XmlTextWriter writer = new XmlTextWriter("entry.xml", System.Text.Encoding.UTF8);
        writer.WriteStartDocument(true);
        writer.Formatting = Formatting.Indented;
        writer.Indentation = 2;
        writer.WriteStartElement("Table");
        createNode(textBox1.Text, textBox2.Text, writer);
        writer.WriteEndElement();
        writer.WriteEndDocument();
        writer.Close();
        MessageBox.Show("XML File created ! "); 
```

}

```
private void createNode(string pName, string pPass, XmlTextWriter writer)
{
    writer.WriteStartElement("Entry");
    writer.WriteStartElement("User");
    writer.WriteString(pName);
    writer.WriteEndElement();
    writer.WriteStartElement("Password");
    writer.WriteString(pPass);
    writer.WriteEndElement();
    writer.WriteEndElement();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T00:47:12.833

使用 LINQ To XML。它更加灵活：

```
private void AddEntry(XElement xml, string user, string password)
{
    xml.Add(new XElement("Entry",
                         new XElement("User", user),
                         new XElement("Password", password)));
} 
```

接着

```
XElement x = XElement.Load("In.xml");
AddEntry(x, "newuser", "newpassword");
x.Save("In.xml"); 
```

因此，如果您的文件是：

```
<Table>
  <Entry>
    <User>first_user1@gmail.com</User>
    <Password>*********</Password>
  </Entry>
</Table> 
```

你得到一个输出：

```
<?xml version="1.0" encoding="utf-8"?>
<Table>
  <Entry>
    <User>first_user1@gmail.com</User>
    <Password>*********</Password>
  </Entry>
  <Entry>
    <User>newuser</User>
    <Password>newpassword</Password>
  </Entry>
</Table> 
```

# javascript - 按 ID 切换元素的类

> ID：12522723
> 
> 赞同：2
> 
> 时间：2012-09-21T00:18:37.947
> 
> 标签：javascript, jquery, html, css, toggle

我试图将一个元素的类从一个值 A 单击时更改为值 B，然后在第二次单击时从值 B 更改回值 A。我在这里找到了一些代码，可以让我更改一次，但不能更改第二次。（见原文[在这里](https://stackoverflow.com/questions/195951/change-an-elements-css-class-with-javascript "这里")）。

这是原始代码：

```
<script type="text/javascript">
  function changeClass() {
    document.getElementById("MyElement").className += " MyClass";
    document.getElementById("MyElement").className = document.getElementById("MyElement").className.replace(/(?:^|\s)MyClass(?!\S)/g, '')
  }
</script> 
```

这是我的代码：

```
<script type="text/javascript">
  function changeClass() {
    if (document.getElementByID("arrow").className == "arrowdown") {
      document.getElementById("arrow").className.replace(/(?:^|\s)arrowdown(?!\S)/g, 'arrowup')
    }
    elseif(document.getElementByID("arrow").className == "arrowup") {
      document.getElementById("arrow").className.replace(/(?:^|\s)arrowup(?!\S)/g, 'arrowdown')
    }
  }
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-21T00:21:54.540

```
$('#arrow').toggleClass('arrowup arrowdown'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T00:24:19.960

为什么不简单地使用 jQuery [toggleClass](http://api.jquery.com/toggleClass/)和[id 选择器](http://api.jquery.com/id-selector/)？

```
 $('#arrow').toggleClass('arrowup');
   $('#arrow').toggleClass('arrowdown'); 
```

省去调试和几行代码！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-21T00:25:08.460

检查这个[小提琴](http://jsfiddle.net/pkDnV/1/)

使用 JQuery 更容易..

```
$(function() {
    var i = 0;
    $('div').on('click', function() {
       i++;
        if( i % 2 == 0){
            $(this).addClass('arrowup').removeClass('arrowdown');
        }
        else{
            $(this).addClass('arrowdown').removeClass('arrowup');
        }
    });
});​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-21T00:31:09.273

只需使用 jquery addClass() 和 removeClass() 甚至更好地使用 click 事件中的 toggleClass

```
<div id="elemID" class="class1">
</div>

function changeClass()
{
    $("#elemID").toggleClass("class1");
    $("#elemID").toggleClass("class2");  
} 
```

REF的

[http://api.jquery.com/addClass/](http://api.jquery.com/addClass/)

[http://api.jquery.com/removeClass/](http://api.jquery.com/removeClass/)

[http://api.jquery.com/toggleClass/](http://api.jquery.com/toggleClass/)

干杯

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-12-12T16:23:47.070

我今天遇到了类似的事情。在我的每个功能的代码中，用户会通过按下大拇指或大拇指来表达他的意见。选定的拇指图标将具有更亮的颜色，因此当用户单击拇指向上图标时，拇指向上图标将变为绿色，而拇指向下图标（如果是绿色）将变为黑色。

我使用jQuery解决了它：

```
$(document).ready(function () {
            $('#vote-yes-@(Model.ProductReviewId)').click(function () {
                setProductReviewHelpfulness@(Model.ProductReviewId)('true');

                $('#1vote-yes-@(Model.ProductReviewId)').toggleClass('green');
                $('#1vote-no-@(Model.ProductReviewId)').removeClass('green').addClass('black');

            });
            $('#vote-no-@(Model.ProductReviewId)').click(function () {
                setProductReviewHelpfulness@(Model.ProductReviewId)('false');

                $('#1vote-no-@(Model.ProductReviewId)').toggleClass('green');
                $('#1vote-yes-@(Model.ProductReviewId)').removeClass('green').addClass('black');

            });
        }); 
```

# algorithm - 查找 BST 中每个级别的最大元素

> ID：12522725
> 
> 赞同：-1
> 
> 时间：2012-09-21T00:19:31.673
> 
> 标签：algorithm, binary-search-tree

在 BST 中找到每个级别的最大元素。？

```
[1] In O(n) time and O(1) space
[2] In O(logn) time and O(n) space 
```

编辑：@Imposter 发布的解决方案适用于 [1] 这是 [1] 的解决方案

```
private int level = 0;
private int VisitedLevels = -1;

public void findLargestByLevel(AvlNode root)
{
    if(root == null) return;

    else
    {
        if(level > VisitedLevels)
        {
            System.out.println(root.data + " @ Level = " + level);
            VisitedLevels++;
        }
        level++;

        findLargestByLevel(root.right);
        findLargestByLevel(root.left);

        level--;
    }
} 
```

但我仍然无法为 [2] 找到解决方案

我想到的方法：如果我们对树进行预处理并将其展平，就像树的序列化一样，

```
 100
             50         200
         20      75

#L0, 100, #L1, 50, 200, #L2, 20, 75, #L3 
```

其中#L 是级别的标记：

那么我们可以在 O(1) 时间内轻松回答最高和最低级别的查询，此外，如果树被修改，我们可以在 LogN 时间内从序列化数据中执行插入和删除。请为 [2] 推荐某人，虽然在我看来 zit 看起来不可能实现 [2] 但我想听听其他人的建议

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-21T06:45:38.267

如果 BST 是 Full BST，那么它可以在 log(N) 时间内完成，因为您需要做的就是一直向右遍历（因为右侧的元素总是比左侧大。）如果它不是完整的 BST然后我们必须遍历所有元素，因为我们不确定右子树的高度总是大于左子树。

示例：如果右子树有两层而左子树有三层，那么使用上述方法我们可以打印最大值直到两层，但我们错过了右子树中不存在的第三层。

因此，如果不是 Full BST，时间复杂度将是最小的 O(n)，如果没有给出额外的空间，则可能会更高。

如果你做 BFS，它只需要 O(n) 时间复杂度和 O(n) 空间复杂度。如果你想要它使用 DFS 那么下面的算法将帮助你 O(n) 时间复杂度和 O(h) 其中 h 是树的高度。

取全局变量**计数器**，它指示到目前为止遍历时的最大级别数。

当你递归调用左子树增量**L**时，取两个变量**L**和**R**

 **同样，当您对右子树增量**R**进行递归调用时。

找到每个节点的**L**和**R**的最大值，它给出了 level number 。

当节点的 max( **L,R** )有增量时，如果**计数器**小于 max( **L,R )，则使用****计数器**检查它，然后分配内存并初始化为零并递增**计数器**。（这意味着我们实际上是在创建树中每个级别的变量）。

 ******在遍历时，我们将每次检查高度或级别变量，并将其与正在考虑的当前节点进行比较，如果当前节点大于级别变量，则使用正在考虑的节点更新级别变量。

遍历后打印高度或水平变量。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-21T05:29:26.443

[1] 这可以通过遍历每个级别并记录最大值来迭代地完成。这可以通过一个简单的 BFS 来完成（假设您不计算存储中的递归级别变量）。例如。用简单队列替换的递归将花费超过 O(1) 的存储空间，在这种情况下，这对我来说似乎是不可能的，除非节点是按级别排序的。

[2] 二叉树具有右孩子大于左孩子的属性，因此如果您每次只遍历最右边的孩子（除非它不存在，则取左孩子），您可以获得 log(n) 时间的最大值。我不确定它是否需要 O(n) 存储。********

# c# - Linq to Entity 的内联委托

> ID：12522728
> 
> 赞同：1
> 
> 时间：2012-09-21T00:19:56.013
> 
> 标签：c#, linq-to-entities, expression-trees

我有一种感觉，我已经知道这个问题的答案了。

我有一个常见但复杂的表达式，我想在多个位置重用代码。我想使用一个返回带有一些代码的 Func 的函数：

```
public static Func<MyClass, bool> GetCheck()
{
    return (x) => x.Value > 10;
} 
```

似乎很容易。我遇到的问题是当我将它应用于 LINQ To Entities 中使用的 LINQ 表达式时。我收到一条错误消息，指出不支持调用。我明白*为什么*。我不知道是否有办法解决这个问题。我想说...

```
var check = GetCheck();
IQueryable<MyClass> results = MyClasses.Where(y => check(y)); 
```

...并让表达式树检查器意识到 Func 中发生的所有事情在 LINQ To Entities 和 DB 中都是完全合法的。看起来它应该是内联的。

我能做些什么来实现这一点吗？允许这样做的代表的任何形式的声明？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T00:23:53.617

由于您正在查询 an`IQueryable<>`然后您应该尝试以下操作：

```
public static Expression<Func<MyClass, bool>> GetCheck()
{
    return (x) => x.Value > 10;
} 
```

# forms - 谷歌地图干扰 Safari 中的按钮事件

> ID：12522729
> 
> 赞同：0
> 
> 时间：2012-09-21T00:20:06.857
> 
> 标签：forms, google-maps, submit, safari

如果您在下面的测试代码中按“上传您的文件”，按钮文本应更改为“上传...”，尽管在 Safari 中不会。选择一个足够大的文件应该让您有时间观察按钮。注释掉地图 div，一切正常。

这是孤立的测试代码，花了半天时间才发现可能是地图原因，但我需要更深入地挖掘。有趣的是，当将相同的代码复制到 JSfiddle 时，它​​不会重现错误，因此您需要创建自己的 html 文件。

```
<!DOCTYPE html>
<html>
<head>
<title>Google Map interfering with button event in Safari</title>
<meta charset="utf-8">
<script src="https://maps.googleapis.com/maps/api/js?sensor=false"></script>
<script>
var map;
function init() {
  var options = {
    zoom: 8,
    center: new google.maps.LatLng(0, 0),
    mapTypeId: google.maps.MapTypeId.ROADMAP
  };
  map = new google.maps.Map(document.getElementById('map'), options);
}

google.maps.event.addDomListener(window, 'load', init);
</script>
</head>
<body>
<form action="http://localhost" method="POST" enctype="multipart/form-data">
    <!--comment map to see correct button behaviour in Safari-->
    <div id="map" style="width:300px;height:300px"></div>

    <p><small>Very large file please:</small> <input type="file" name="big"></p>
    <button onclick="this.innerHTML='Uploading...'">Upload your file</button>
</form>
</body>
</html> 
```

之前在SO上有类似的问题，但没有解决方案。

# c - fscanf 和 seg 的问题。故障

> ID：12522730
> 
> 赞同：0
> 
> 时间：2012-09-21T00:20:20.367
> 
> 标签：c

```
char temp[100];
char event[1000];
int i = 0;

do {
    while (true) {
        **fscanf(fin, "%s", &temp);**
        if (temp != "BEGIN:VEVENT" || temp != "BEGIN:VCALENDAR") {
            strcat(event, temp);
        }

        if (temp == "END:VEVENT") {
            Events[i][0] = *event;
            i++; 
            break;
        } else if (temp == "END:VCALENDAR") {
            //temp = EOF;
            break;
        }
    }
    fprintf(stdout, "%s\n", Events[i - 1]);
} while (*temp != EOF); 
```

我用星号括起来的那条线导致了 seg。故障。对于我的一生，我无法弄清楚发生了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T00:26:12.103

如果该行超过 100 个字符，您可能会遇到缓冲区溢出。如果您只想获得一行输入，请`fgets`改用：

```
if(fgets(temp, sizeof(temp), fin) == NULL) {
    perror("fgets");
    /* return a failure code */
} 
```

您也不能使用`==`and比较字符串`!=`；改为使用`strcmp`。

我相信您的代码崩溃是因为`temp != "BEGIN:VEVENT"`始终为真（`temp`缓冲区的地址永远不会等于常量字符串的地址），因此您将继续这样做，`strcat`直到缓冲区空间不足，导致程序缓冲区溢出`event`并崩溃。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T00:35:05.153

你确定是那条线？如果是这样，您可能有缓冲区溢出。另外，你不应该传递`&temp`给`fscanf`. 如果你使用没有索引的数组，你可以把它想象成一个指针（尽管从技术上讲它不是）。所以你应该这样做：

```
fscanf(fin, "%s", temp); 
```

另外，你这样做：

```
strcat(event, temp); 
```

但未`event`初始化。您至少需要终止`event`字符串，否则`strcat`可能最终会搜索整个数组（取决于其中的未初始化值）以查找字符串的结尾，并且可能会溢出：

```
char event[1000];
event[0] = 0; 
```

# gif - 如何将表情从 Skype 复制到 HipChat？

> ID：12522736
> 
> 赞同：0
> 
> 时间：2012-09-21T00:20:50.953
> 
> 标签：gif, skype

Skype 有一个可爱的心飞扬的表情，由 :] 制作。Hipchat 允许您上传自己的表情符号。现在我需要从 Skype 中提取动画 GIF，它是在您键入 :] 时生成的。但是，复制和粘贴仅返回原始文本。如何取回实际的动画 GIF？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T00:31:59.070

如果您的 GIF 在[这里找到？](http://factoryjoe.com/projects/emoticons/)

我想你可以从浏览器中保存它

我不知道这是否是你正在寻找的[心。](http://factoryjoe.s3.amazonaws.com/emoticons/emoticon-0152-heart.gif)

# c - tcp校验和的c库函数

> ID：12522737
> 
> 赞同：0
> 
> 时间：2012-09-21T00:21:02.153
> 
> 标签：c, tcp, checksum

是否有用于计算或验证 TCP 校验和的 C 库函数？我看到了一些手工编码的函数，但认为某处必须有一个 lib 函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T15:57:56.500

不，没有标准库函数。每个人都只是[`in_cksum`](http://code.google.com/codesearch#search/&q=in_cksum&type=cs)在需要时复制和粘贴相同的功能。傻了吧？

# php - PHP json_encode() 结果显示 JSONLint 错误

> ID：12522738
> 
> 赞同：2
> 
> 时间：2012-09-21T00:21:13.093
> 
> 标签：php, json, jsonlint

我在验证`json_encode()`函数的输出时遇到问题。

我正在使用 cURL 提取 XML 提要，将其转换为数组，然后将该数组转换为带有`json_endode()`. 我会为你省去 cURL 的东西：

```
 foreach ($xmlObjects->articleResult as $articleResult) {
    $article = array(
      "articleResult" =>
      array(
        'articleId' => (string)$articleResult->articleId,
        'title' => (string)$articleResult->title,
        'subhead' => (string)$articleResult->subhead,
        'tweet' => (string)$articleResult->tweet,
        'publishedDate' => (string)$articleResult->publishedDate,
        'image' => (string)$articleResult->image
      ),
    );
    $json = str_replace('\/','/',json_encode($article));
    echo $json;
  } 
```

这给了我一个 JSON 读数：

```
{
    "articleResult": {
        "articleId": "0001",
        "title": "Some title",
        "subhead": "Some engaging subhead",
        "tweet": "Check out this tweet",
        "publishedDate": "January 1st, 1970",
        "image": "http://www.domain.com/some_image.jpg"
    }
}
{
    "articleResult": {
        "articleId": "0002",
        "title": "Some title",
        "subhead": "Some engaging subhead",
        "tweet": "Check out this tweet",
        "publishedDate": "January 1st, 1970",
        "image": "http://www.domain.com/some_image.jpg"
    }
} 
```

这会给我一个 JSONLint 错误说：

```
Parse error on line 10:
..._120x80.jpg"    }}{    "articleResult
---------------------^
Expecting 'EOF', '}', ',', ']' 
```

所以很自然地我会添加逗号，这给了我一个文件结束的期望：

```
Parse error on line 10:
..._120x80.jpg"    }},{    "articleResu
---------------------^
Expecting 'EOF' 
```

我是 JSON 新手，但我已经检查了网站和一些资源以了解正确的 JSON 格式和结构，从我可以看到我的读数遵循指南。任何指针？

我检查过的资源：

[JSON.org](http://json.org)自然

[维基百科](http://en.wikipedia.org/wiki/JSON)有据可查的页面

[W3Resource](http://www.w3resource.com/JSON/structures.php)对结构有很好的解释。

[JSONLint](http://www.jsonlint.org/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T00:27:09.383

您将 2+ 个对象编码为 json 字符串，您需要`[` `]`将它们包装起来

正确的语法是

```
[ 
   { /* first object */ }
 , { /* second object */ }
 , { /* third object */ }
] 
```

你需要注意的是

*   `[ ]`裹
*   用逗号分隔对象

**解决方案**

```
$json = array();
foreach ($xmlObjects->articleResult as $articleResult) {
  $article = array(
    "articleResult" =>
    array(
      'articleId' => (string)$articleResult->articleId,
      'title' => (string)$articleResult->title,
      'subhead' => (string)$articleResult->subhead,
      'tweet' => (string)$articleResult->tweet,
      'publishedDate' => (string)$articleResult->publishedDate,
      'image' => (string)$articleResult->image
    ),
  );
  $json[] = $article;
}
echo json_encode($json); 
```

# ruby-on-rails - Rails - “heroku db：push”命令失败

> ID：12522742
> 
> 赞同：2
> 
> 时间：2012-09-21T00:21:59.420
> 
> 标签：ruby-on-rails, ruby, sqlite, heroku

我正在尝试将我的应用程序从我的开发环境推送到 heroku 上的生产环境。我已经转移了我所有的代码使用

```
git push heroku master 
```

现在我需要推送我的数据库并尝试这个

```
heroku db:push 
```

但它失败了，我在控制台收到了这条消息。

```
ruby-1.9.3-p194@app0907api @~/Documents/myapp06     
>heroku db:push
/Users/hj/.rvm/gems/ruby-1.9.3-p194@app0907api/gems/sqlite3-1.3.6/lib/sqlite3/sqlite3_native.bundle: [BUG] Segmentation fault
ruby 1.8.7 (2012-02-08 patchlevel 358) [universal-darwin12.0] 
```

这有点奇怪，因为我的应用程序使用 postgres 进行开发、生产和测试，我根本没有使用 sqlite，也没有为 sqlite3 安装任何 gem

可能出了什么问题？

* * *

```
 source 'https://rubygems.org/'

 gem 'rails', '3.2.8'

 gem 'rails-api'

 gem 'pg'

 gem 'taps'

 gem 'thin'

 gem 'foreman'

 gem 'rabl'

 gem 'paperclip', '~>3.2.0'
 gem 'aws-sdk', '~>1.3.4'

 group :development do

 gem 'annotate', ">=2.5.0"
 gem 'debugger'
 end 
```

* * *

找到的解决方案：

在我的终端控制台上输入以下行：

```
 gem install heroku
 sudo gem install taps 
```

这允许我运行命令：

```
heroku db:push 
```

...但是现在，在发送数据库时，我收到了这个错误：

```
 Saving session to push_201209202159.dat..
 !!! Caught Server Exception
 HTTP CODE: 500
 Taps Server Error: PGError: ERROR: time zone displacement out of range: "2012-09-18 12:00:00.000000+5894853600"
 LINE 1: ...ated_at") VALUES (45, '37.785834', '-122.406417', '2012-09-1... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-22T18:23:35.257

**更新：导入/导出 PG 数据的功能现在是 CLI 的一部分，作为[heroku pg:push 和 heroku pg:pull](https://devcenter.heroku.com/articles/heroku-postgresql#pg-push-and-pg-pull)**

我强烈推荐对 Heroku CLI 使用[pg:transfer](https://github.com/ddollar/heroku-pg-transfer)插件。您可以使用该插件做很多事情，包括[将数据从本地环境传输到 Heroku 环境](http://www.ryandaigle.com/a/pgtransfer-is-the-new-taps)。

`db:push`并且`db:pull`对于仅在两个 postgres 数据库之间传输非常脆弱。要从本地传输到远程，请执行以下操作以安装插件并传输数据：

```
$ heroku plugins:install https://github.com/ddollar/heroku-pg-transfer
$ heroku pg:transfer --from $DATABASE_URL --to HEROKU_POSTGRESQL_JADE_URL 
```

该`--from $DATABASE_URL`标志表示从 env 变量`DATABASE_URL`中提取本地数据库位置并推送到您的 Heroku 应用程序的`HEROKU_POSTGRESQL_JADE_URL`数据库。您可以使用以下命令找到您的 Heroku 数据库名称`heroku config`：

```
$ heroku config | grep POSTGRES
HEROKU_POSTGRESQL_JADE_URL: postgres://ads8a8d9asd:al82kdau78kja@ec2-23-23-237-0.compute-1.amazonaws.com:5432/resource123 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-21T02:13:00.953

您可能错过了一些步骤。

1.  `bundle install`

2.  `git add .`

3.  `git commit -m 'your commit message goes here'`

4.  `git push heroku`

5.  `heroku run rake db:migrate`

还：

1.  `sudo gem install heroku`

2.  `sudo gem install taps`

编辑：

解决休息：

`$ rvm install ruby-1.9.2-p318` `$ rvm use ruby-1.9.2-p318` `$ heroku db:push`

# ruby - Ruby Matrix::特征值分解错误

> ID：12522747
> 
> 赞同：0
> 
> 时间：2012-09-21T00:22:29.987
> 
> 标签：ruby, hessian-matrix, matrix-decomposition

我查看了给定矩阵的特征向量矩阵，但是当我尝试对其求逆时，我在`eigenvector_matrix_inv()`.

```
require 'matrix'

m = Matrix[ [0.5703125, 1.8369140625, 0.0, 0.0], 
            [-0.6875, -0.4609375, 0.0, 0.0], 
            [0.0, 0.0, -2.1796875, 8.7119140625], 
            [0.0, 0.0, -0.6875, 2.2890625] ]

meigen = m.eigen.eigenvector_matrix
meiveni = m.eigen.eigenvector_matrix_inv
# .../matrix.rb:930:in `block in inverse_from': Not Regular Matrix (ExceptionForMatrix::ErrNotRegular) 
```

它不应该是单数，如检查`Mathematica`：

```
mruby = {{0.5703125, 1.8369140625, 0.0, 0.0}, {-0.6875, -0.4609375, 
0.0, 0.0}, {0.0, 0.0, -2.1796875, 8.7119140625}, {0.0, 
0.0, -0.6875, 2.2890625}};
Inverse[Eigenvectors[mruby]] 
```

给予

```
{{0.586146 - 0.302685 I, 0.586146 + 0.302685 I, 0\. + 0\. I, 
0\. + 0\. I}, {0\. - 1.07831 I, 0\. + 1.07831 I, 0\. + 0\. I, 
0\. + 0\. I}, {0\. + 0\. I, 0\. + 0\. I, 0.519354 + 1.16217 I, 
0.519354 - 1.16217 I}, {0\. + 0\. I, 0\. + 0\. I, 0\. - 4.53135 I, 
0\. + 4.53135 I}} 
```

我究竟做错了什么 ？

我应该特别注意 Ruby 中的一些特殊内容吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T00:39:33.113

当你做特征值问题时，你不会反转矩阵。有很多算法，但反演不是其中之一。

你的矩阵有点奇怪：你有两个正对角元素和两个负对角元素。我认为具有复杂条目的特征向量表明这不是您通常拥有的：具有真实特征向量的真实特征值。

您的矩阵不正确，或者您选择了错误的算法。查看 Hessian 矩阵是否是您所拥有的，并查看适当的算法。

# windows - 单击重叠的子窗口

> ID：12522749
> 
> 赞同：0
> 
> 时间：2012-09-21T00:22:42.327
> 
> 标签：windows, click, overlap, childwindow

我有一个不寻常的问题，我无法通过搜索找到解决方案。我有一个由文本、复选框、按钮等组成的表单类型的屏幕。我需要临时弹出一个虚拟键盘进行输入（触摸屏）。这很好用，除了总是，如果“键”*下方*有一个可选项目，则按下“键”实际上会在底层元素上生成一个单击事件。这对我来说似乎违反直觉。有人可以解释我做错了什么吗？谢谢！

# c# - Windows 7，笔记本背光开启和关闭

> ID：12522753
> 
> 赞同：3
> 
> 时间：2012-09-21T00:23:45.517
> 
> 标签：c#, c++, windows, lcd, backlight

我看过关于改变笔记本屏幕亮度的话题，但现在真正需要的是打开和关闭背光本身。

我的意思是，如果背光关闭，那么您可以使用明亮的光源（如手电筒）指向屏幕，在笔记本电脑的屏幕上看到图像。

有些笔记本电脑有切换背光的特殊按钮，但有些则没有。一个月以来，我找不到一种以编程方式切换背光的方法。

你们有谁知道，如果可能的话，即使使用供应商特定的 API，在最坏的情况下如何做到这一点？

# r - 是否可以暂停正在运行的 R 脚本？

> ID：12522759
> 
> 赞同：5
> 
> 时间：2012-09-21T00:24:42.053
> 
> 标签：r

我正在 R 中进行一些分析，至少需要 24 小时才能完成。是否可以中途暂停该功能，以便我可以带着我的电脑上班和回来？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-21T00:37:00.780

这是不可能的 AFAIK，但我相信您可以暂停您的计算机，并且自动暂停进程。

如果您使用的是 Linux，您还可以使用`killall -STOP R`和`killall -CONT R`命令手动停止和继续进程。看看[这篇文章](http://tombuntu.com/index.php/2007/11/23/how-to-pause-a-linux-process/)和那里的评论部分，其中包含有关此的有用信息。

在 Windows 上，您可以使用任务管理器或安装能够执行此操作的特殊软件。但我真的不知道，因为我不经常使用 Windows。

编辑：即使您使用`kill`或`killall`暂停该过程，但关闭计算机，您也会丢失数据。

# python - 在 Python 中处理基本数组的首选方法是什么？

> ID：12522766
> 
> 赞同：1
> 
> 时间：2012-09-21T00:26:05.987
> 
> 标签：python, matlab

在使用 Matlab 多年后，我正在学习 python。我遇到了障碍，在我的谷歌搜索中没有找到太多帮助。

我想知道处理基本数组的最佳方法。我应该使用 numpy、scipy、array、numarray 还是其他东西？

例如，以下面的 Matlab 代码为例。

```
a = rand(10,1)
b = rand(10,1)

c = b > 0.5
d = a .* b
e = a + b
f = mean(a)
g = sum(b) 
```

将其转换为 python 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-21T00:36:14.120

如果您要使用数字数组进行数学运算，那么您绝对应该使用 NumPy；甚至还有针对 MATLAB 用户的[迁移指南。](http://www.scipy.org/NumPy_for_Matlab_Users)

NumPy 做了很多与 MATLAB 相同的数组广播，所以使用起来应该很自然。你的代码可以写成：

```
import numpy as np
a = np.random.rand(10,1)
b = np.random.rand(10,1)
c = b > 0.5
d = a * b # Note that * in NumPy is always elementwise (use .dot for matrix multiplication)
e = a + b
f = a.mean() # Can also use np.mean(a)
g = b.sum() # Can also use np.sum(b) 
```

# javascript - 使用选择框的索引值更新隐藏文本框的 onchange 事件语法

> ID：12522768
> 
> 赞同：3
> 
> 时间：2012-09-21T00:26:13.920
> 
> 标签：javascript, html, forms, select, hidden

我的意思是，我觉得自己完全是个白痴，但即使搜索了近两个小时，我似乎也无法做到这一点。

此选择后跟一个隐藏的文本字段：

```
<select name="location_id" class="select green-gradient" single>
  <option value="2">New York</option>
  <option value="3">London</option>
  <option value="4">Singapore</option>
  <option value="5">San Francisco</option>
  <option value="6">Milan</option>
</select>
<input type='text'  name="selected_location_id" class="hidden" value=""> 
```

// 我通常将此代码用于复选框。它切换隐藏文本框的内容。我知道检查选择的值是不同的。但我似乎无法正确处理。

```
$(document).ready(function(){
    $('.switch').change(function( ){
        if($(this).next().val() == 1){
            $(this).next().val(0);
        } else {
            $(this).next().val(1);
        }
    });
}) 
```

// 我试过这个：但它没有用，因为我需要对页面上的所有选择执行此操作。而且它仍然没有更新隐藏的文本框。

```
$(document).ready(function(){
   $('.select').change(function( ){
     var selectedValue = $(this "option:selected").val();
     $(this).next().val(selectedValue);
   });
}) 
```

// 也许我只是累了。但现在是寻求帮助的时候了。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T00:35:53.490

我认为应该是

```
$('select').change ///(without the dot) 
```

不是

```
$('.switch').change 
```

两者都不

```
$('.select').change 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T02:04:07.693

在侦听器中，`this`引用元素。您还可以从选择元素的名称中获取隐藏元素的名称，因此如果它们在表单中：

```
this.form['selected_' + this.name].value = this.value; 
```

并且你没有一个函数调用就完成了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-21T00:36:13.400

```
var selectedValue = $("option:selected").val(); 
```

通过取出“this”在 jsfiddle 中工作。

# performance - QLabel 与 QGraphicsView 性能对比

> ID：12522775
> 
> 赞同：12
> 
> 时间：2012-09-21T00:27:14.060
> 
> 标签：performance, qt, qgraphicsview, qlabel

我正在学习 QT，我对平移时 QLabel 和 QGraphics 视图的性能差异感到困惑。

我将一个巨大的 36Mpixels (D800) jpeg 文件读入 QLabel 或 QGraphics 对象，并尝试使用 QLabel/Graphics 拖动全尺寸图像。令人惊讶的是，QLabel 提供了非常平滑的移动，而 QGRaphicsView 平移是生涩的。

简化的 QGraphicsView 代码是：

```
QApplication::setGraphicsSystem("raster");    
...
QGraphicsView  view();
view.setDragMode(QGraphicsView::ScrollHandDrag);
view.setHorizontalScrollBarPolicy(Qt::ScrollBarAlwaysOff);
view.setVerticalScrollBarPolicy(Qt::ScrollBarAlwaysOff);
view.setFrameStyle(QFrame::NoFrame);
view.showFullScreen();

QGraphicsPixmapItem *pmItem = new QGraphicsPixmapItem(pixMap);
scene.addItem(pmItem); // only one item in the scene
//view.setRenderHints(QPainter::Antialiasing | QPainter::SmoothPixmapTransform); // no difference
view.show(); 
```

简化的基于 QLabel 的代码是：

```
void MyQLabel::mouseMoveEvent(QMouseEvent *event){
    if(_leftButtonPressed) {
            // calculate new {_x, _y} position
            repaint();
        }
    } else super::mouseMoveEvent(event);
}
void MyQLabel::paintEvent(QPaintEvent *aEvent){
    QPainter paint(this);
    paint.drawPixmap(_x, _y, pixMap);
}

... // Somewhere in the code:
MyQLabel _myLabel(NULL);
_myLabel.showFullScreen();
_myLabel.show(); 
```

感觉就像 QGraphicsView 跳过了一些位置（快速拖动），而 QLabel 在所有中间图像上绘制。

我想念什么？

谢谢亚历克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2021-08-29T09:19:54.950

`update()`很可能，当检测到滚动更改时会调用 QGraphicsView 。当您的标签调用`repaint()`.

不同之处在于`update()`调度呼叫`repaint()`和多个快速呼叫`update()`可能会呼叫`repaint()`一次。

快速拖动时，您可能会在短时间内注册多个鼠标事件。QGraphicsView 将处理所有这些，并为它们中的每一个调用`update()`，并且只有在它们全部处理完毕后`repaint()`才会真正调用它们。`repaint()`您的标签将为每个鼠标事件强制执行一个。

您的标签可能比图形视图更平滑，但它会消耗更多资源，并且在有限的硬件上，标签将落后于鼠标光标，因为硬件正在尝试处理所有重绘。

# android - 相对布局危机

> ID：12522776
> 
> 赞同：0
> 
> 时间：2012-09-21T00:27:28.170
> 
> 标签：android, android-linearlayout, android-relativelayout

所以我想要一个在屏幕顶部有 2 个按钮的 linearLayout，在底部有一个 linearLayout，它也有两个按钮，在中间有一个 listView。我遇到的问题是，如果 listView 太大，底部的 linearLayout 会被覆盖。我告诉 listView wrap_content 因为它是 layout_height 因为我想这样做......但我几乎肯定这就是底部 linearLayout 没有显示的原因。这是代码：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/topLayout"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal" >

        <Button
            android:id="@+id/importClasses"
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            >
        </Button>

        <TextView
            android:id="@+id/title"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:text="@string/Title"
            android:layout_weight="1"
            android:gravity="center_horizontal|center_vertical|center"
             >
        </TextView>

        <Button
            android:id="@+id/addClasses"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
             />
      </LinearLayout>

    <ListView
        android:id="@+id/classList"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_below="@id/topLayout" >

    </ListView>

    <LinearLayout
        android:id="@+id/bottomLayout"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_below="@id/classList"
         >

        <Button
            android:id="@+id/Assignments"
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            >
        </Button>

        <Button
            android:id="@+id/flashCards"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
             />
    </LinearLayout>

</RelativeLayout> 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T01:36:37.627

设置`classList`为高于`bottomLayout`和低于`topLayout`。

也设置`bottomLayout`为`layout_alignParentBottom="true"`, 和`topLayout layout_alignParentTop="true"`

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent" >

<LinearLayout
    android:id="@+id/topLayout"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal" android:layout_alignParentTop="true">

    <Button
        android:id="@+id/importClasses"
        android:layout_width="wrap_content"
        android:layout_height="fill_parent"
        >
    </Button>

    <TextView
        android:id="@+id/title"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:text="@string/Title"
        android:layout_weight="1"
        android:gravity="center_horizontal|center_vertical|center"
         >
    </TextView>

    <Button
        android:id="@+id/addClasses"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
         />
  </LinearLayout>

<ListView
    android:id="@+id/classList"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_above="@+id/bottomLayout"
    android:layout_below="@+id/topLayout" >

</ListView>

<LinearLayout
    android:id="@+id/bottomLayout"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true">

    <Button
        android:id="@+id/Assignments"
        android:layout_width="wrap_content"
        android:layout_height="fill_parent"
        >
    </Button>

    <Button
        android:id="@+id/flashCards"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
         />
</LinearLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T01:37:58.553

这应该可行，但您可能需要将您的更改`RelativeLayout`为`LinearLayout`.

`layout_height`并将您的更改`ListView`为`0dp`并添加`layout_weight="1"`到它。

# formatting - 在 Textarea 中格式化单行

> ID：12522779
> 
> 赞同：1
> 
> 时间：2012-09-21T00:27:31.830
> 
> 标签：formatting, textarea

我有一个`<textarea>`我正在使用 JS 动态附加的内容。

我想对其进行格式化，以便附加的标题行是粗体：

```
some previous content...

NEW HEADER ROW TO BE MADE BOLD

New additional content...

... 
```

所以标题行基本上会被包裹在一个`<strong>`标签中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T00:44:42.117

没有标点符号和使用 jQuery，这对我有用：

```
$('#textbox').change(function(){
    $('#example').html($('#textbox').text().replace(/([A-Z\s]+)\n/g, "<strong>$1</strong>"))
}) 
```

在这个片段中，'textbox' 是 textarea 的 id，'example' 是预览 div。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T00:57:47.760

css第一行？[http://www.w3schools.com/cssref/sel_firstline.asp](http://www.w3schools.com/cssref/sel_firstline.asp)

# javascript - 基本 jquery 滑块 TypeError: $ is not a function on Wordpress

> ID：12522780
> 
> 赞同：1
> 
> 时间：2012-09-21T00:27:40.450
> 
> 标签：javascript, jquery, html, wordpress

我收到此错误：“TypeError: $ is not a function $('#slider').list({"

```
 <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
        <script type="text/javascript" src="http://plumbsimple.com/wp-content/themes/bootstrapwp-87/js/basic-jquery-slider.min.js"></script>

         <script type="text/javascript">
              window.$ = jQuery;

              $(document).ready(function() {

                $('#slider').list({
                  'animation' : 'slide',
                  'width' : 700,
                  'height' : 300
                });

              });
        </script> 
```

标题中的数据：

```
 <div id="slider"><ul class="list">
        <li><img src="<?php bloginfo( 'template_url' );?>/img/beach.jpg"></li>
        <li><img src="<?php bloginfo( 'template_url' );?>/img/hp-computers.jpg"></li>
        </ul>
        </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T06:09:08.073

很有可能用“jQuery”编写替换第一个“$”并将“$”传递给函数将使该错误消失。下面的例子。

```
 `jQuery(document).ready(function($) {

            $('#slider').list({
              'animation' : 'slide',
              'width' : 700,
              'height' : 300
            });

          });` 
```

如果您查看 wordpress codex，它们会提供正在发生的事情的解决方案。
[http://codex.wordpress.org/Function_Reference/wp_enqueue_script](http://codex.wordpress.org/Function_Reference/wp_enqueue_script)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T00:38:47.780

有 2 种变体：

1.  您还没有加载 jQuery 库。
2.  `$`由于或某些原因，它不能按功能`prototype.js`使用，然后尝试使用`jQuery`function 而不是`$`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-21T00:48:13.853

默认情况下，WP 将 jQuery 置于[`noConflict`](http://api.jquery.com/jQuery.noConflict/)模式：( [source](http://codex.wordpress.org/Function_Reference/wp_enqueue_script) )

> **注意：** WordPress 附带的 jQuery 库以[“无冲突”模式](http://api.jquery.com/jQuery.noConflict/)加载。这是为了防止与 WordPress 可以加载的其他 javascript 库的兼容性问题。

可以在控制台上轻松测试：

![在此处输入图像描述](../Images/eeed1e407c6eac40b876f9f699781806.png)

因此，如果您不使用任何其他可能与 jQuery 冲突的库`$`，您可以将 jQuery 重新别名为`$`：

```
window.$ = jQuery; 
```

将该行放在 jQuery 库之后的第一个脚本的最开头，它会正常工作。

此外，您可以将所有`$`引用替换为`jQuery`或使用不同的别名，以防与原型或其他库发生冲突。

**编辑：**实际上也有一些东西覆盖了你的全局`$`。您可以将代码包装在 IIFE 中以创建可以安全使用`$`别名的范围：

```
(function($) {
    $(document).ready(function() {

        $('#slider').list({
            'animation': 'slide',
            'width': 700,
            'height': 300
        });

    });
})(jQuery);​ 
```

# c - 如何动态生成C类型？

> ID：12522785
> 
> 赞同：1
> 
> 时间：2012-09-21T00:28:10.477
> 
> 标签：c, macros, structure

我必须编写一个函数`update(char* name, void* data);`来接收消息的名称和 void* 到该消息的数据。数据的类型始终固定为“xxx_name”，具体取决于名称。

我的功能应该执行以下操作：-

1.  在函数中生成 xxx_name 类型的新结构。
2.  将数据从指针数据中复制，大小为 xxx_name 到一个新位置，因为数据很快就会被外部接口释放。

就我而言，xxx_name 类型的可能结构列表非常庞大且分布广泛，因此编写 if/else 或 switch 条件是没有问题的。

有没有办法通过一些宏/字符串化运算符等在 C 中做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T00:55:48.940

此解决方案使用以 NULL 结尾的查找表 (LUT) 来查找合适的大小。然后分配该大小的内存。然后将输入数据复制到新对象。如果对象类型的数量足够大，则可以对 LUT 进行预排序，然后执行二进制搜索而不是线性搜索。

```
#include<stdlib.h>
#include<string.h>

struct nameToSize_s {
    const char *name;
    size_t size;
};

struct foo1_name_s {
};

struct foo2_name_s {
};

const struct nameToSize_s nameToSizeLUT[] = {
    { "foo1_name",  sizeof(struct foo1_name_s) },
    { "foo2_name",  sizeof(struct foo2_name_s) },
    // NULL terminator
    { NULL, 0}
};

void * update(char* name, void *data) {
    const struct nameToSize_s *entry = nameToSizeLUT;

    while(entry->name) {
        if( strcmp(entry->name, name) == 0) break;
        entry++;
    }

    if( entry->name == NULL) abort();

    void *newObj = malloc(entry->size);
    if( newObj == NULL) abort();

    return memcpy( newObj, data, entry->size);
} 
```

# asp.net-mvc-3 - “一个实体对象不能被 C# 中的多个 IEntityChangeTracker 实例引用”

> ID：12522789
> 
> 赞同：0
> 
> 时间：2012-09-21T00:29:40.817
> 
> 标签：asp.net-mvc-3

需要这方面的帮助。我需要在控制器操作中将会话中的一些数据保存到数据库。但是我在 answer.Add(answer); 上得到“一个实体对象不能被 C# 中 IEntityChangeTracker 的多个实例引用”错误

有人可以帮我吗？

```
Questionare questionare = unitOfWork.QuestionareRepository.GetByID(id);

            SADEntitiesContext db = new SADEntitiesContext();

            foreach (Question question in questionare.Questions)
            {
                //check if there are data in Session and save it
                _question = "question"+question.QuestionID.ToString();

                if (Session[_question] != null)
                {

                    var answer = new Answers();
                    if (TryUpdateModel(answer))
                    {

                    questionanswer = (QuestionAnswerData)Session[_question];
                    int qID = Int16.Parse(questionanswer.QuestionID);
                    var answertoupdate = answer.GetAnswer(qID, questionanswer.UserID, questionanswer.EmployeID);

                    //db.Answers.Remove(answertoupdate);

                    answer.UserName = questionanswer.UserID;
                    answer.Answer = db.AnswerChoices.Find(Int16.Parse(questionanswer.AnswerID));
                    answer.AnsweredAt = DateTime.Now;
                    answer.locked = false;
                    answer.Question = question;
                    answer.Questionare = questionare;
                    if (questionanswer.EmployeID != null)
                    {
                        answer.AnswerAboutUser = questionanswer.EmployeID;
                    }
                    if (answertoupdate != null)
                    {
                        answertoupdate = answer;

                        ok = (answertoupdate.Save() > 0);
                    }

                    else
                    {
                        answer.Add(answer);

                        ok = (answer.Save() > 0);
                    }
                    }
                } 
```

答案类公共类答案{

```
 SADEntitiesContext db = new SADEntitiesContext();

    public int AnswersId { get; set; }

    //[Display(Name = "DataResposta", ResourceType = typeof(Resources))]
    public DateTime AnsweredAt { get; set; }

    //[Display(Name = "bloqueado", ResourceType = typeof(Resources))]
    public bool locked { get; set; }

   // [Display(Name = "UserName", ResourceType = typeof(Resources))]
    public string UserName { get; set; }

    //[Display(Name = "AnswersAboutUser", ResourceType = typeof(Resources))]
    public string AnswerAboutUser { get; set; } 

    //[Display(Name = "Resposta", ResourceType = typeof(Resources))]
    public virtual AnswerChoices Answer { get; set; } 

    //[Display(Name = "Questionare", ResourceType = typeof(Resources))]
    public virtual Questionare Questionare { get; set; }

    //[Display(Name = "QuestionID", ResourceType = typeof(Resources))]
    public virtual Question Question { get; set; }

    //
    // Persistence 

    public int Save()
    {
        return db.SaveChanges();
    }

    public Answers GetAnswer(int questionID, string employeID, string userID)
    {
        return db.Answers 
            .Where(e => e.UserName == userID
                                             && e.Question.QuestionID == questionID
                                             && e.AnswerAboutUser == employeID)

                                         .FirstOrDefault();

    }

    public Answers GetAnswer(int id)
    {
        return db.Answers.SingleOrDefault(d => d.AnswersId == id);
    }

    //
    // Insert/Delete Methods

    public void Add(Answers _answer)
    {
        db.Answers.Add(_answer);
        db.SaveChanges();
    }
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T00:38:12.680

您的问题是您正在从一个上下文中调用答案：

```
answer.Answer = db.AnswerChoices.Find(Int16.Parse(questionanswer.AnswerID)); 
```

然后尝试在您的 Answer 类中使用不同的方法保存它：

```
 SADEntitiesContext db = new SADEntitiesContext(); 
```

解决问题的最快方法是能够在您的 Answer 类中设置上下文，这样您就不会跳转上下文，或者您可以在第一次从数据库中提取答案后分离答案，然后在保存中重新附加它.

但是，我认为你有一个更根本的问题。您确定让一个类能够创建自己的上下文并保存自己是个好主意吗？你到处都会遇到这样的问题。

# java - 机器在 Windows 7 中从睡眠或休眠状态唤醒后，多播套接字不起作用

> ID：12522792
> 
> 赞同：1
> 
> 时间：2012-09-21T00:30:24.403
> 
> 标签：java, windows-7, multicastsocket

这个问题与[多播套接字类似 - 当计算机从睡眠中唤醒时将不起作用](https://stackoverflow.com/questions/11944486/multicast-socket-will-not-work-when-computer-wakes-up-from-sleep)。但是这个问题已经结束了，它的解决方案不是我想要的。

我有一个关于多播套接字接收的代码。它可以在 Windows XP、7 和 Mac 上运行。但是现在我发现了一个问题，“当我在windows 7中运行它时，休眠或睡眠PC，然后唤醒PC，套接字无法再接收”。它只发生在 Windows 7 中。在 XP 和 MAC 中没有问题。”

代码是这样的：

```
final InetAddress group = InetAddress.getByName("234.255.255.255");
final MulticastSocket socket = new MulticastSocket(5555);

socket.setReuseAddress(true);
socket.setTimeToLive(10);
socket.joinGroup(group);

final int length = 4 * 1024;
final byte[] bytes = new byte[length];
final DatagramPacket packet = new DatagramPacket(bytes, length);

while(true) 
{
    socket.receive(packet);
    ...
}
... 
```

有人对此有任何想法吗？

我已经尝试了很多方法来探索它。我曾经使用 WireShark 来监控网络适配器，我可以看到接收到 PC 的多播数据包。但是，java套接字不能一路接收。

# css - css - 在菜单中换行

> ID：12522795
> 
> 赞同：0
> 
> 时间：2012-09-21T00:30:49.913
> 
> 标签：css

我继承了这个网站，有些 CSS 很乱。具体来说，这个新页面

[http://www.businesseventssydney.com.au/](http://www.businesseventssydney.com.au/)

有一个蓝色的水平菜单栏。起初，一些菜单项的文本很长并且没有包含在菜单中。然而，经过一些工作和额外的 css，我设法让文本换行，例如，将鼠标悬停在“为什么选择悉尼”上，然后悬停在“悉尼为未来而成长”上。

CSS如下：

```
.second-level{
    white-space: -moz-pre-wrap !important;  /* Mozilla, since 1999 */
    white-space: -pre-wrap;      /* Opera 4-6 */
    white-space: -o-pre-wrap;    /* Opera 7 */
    white-space: pre-wrap;       /* css-3 */
    /*word-wrap: break-word;*/       /* Internet Explorer 5.5+ */
    /*word-break: break-all;*/
    white-space: normal;
    -ms-word-break: break-all;
    -webkit-hyphens: auto;
       -moz-hyphens: auto;
    hyphens: auto;
} 
```

菜单文本在 FF 和 Chrome 中的换行很好，即单词不会被拆分，整个单词会换行到下一行。但是，在 IE 中，单词在换行之前会被拆分。

奇怪的是，在另一个页面上有这个菜单的相同版本，它在所有浏览器中都能完美运行，不需要对它做任何事情。请参阅以下页面：

[http://www.businesseventssydney.com.au/about-us/](http://www.businesseventssydney.com.au/about-us/)

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T03:42:38.237

而不是添加一大堆CSS，也许你可以删除：

```
#topnav {
white-space: nowrap;
} 
```

# javascript - HTML5视频非常奇怪的错误

> ID：12522796
> 
> 赞同：0
> 
> 时间：2012-09-21T00:30:51.713
> 
> 标签：javascript, html, google-chrome, video

我在chrome下做这个，我做的如下

```
var somevideo= document.querySelector('#video-tag'); 
```

然后我用它来添加一个源，虽然 appendChild 将它附加到

```
somevideo.parentNode.parentNode 
```

没有我在脚本中定义父节点。我尝试播放或暂停的任何事情都说它是一个 HTML 元素，但如果我尝试控制它显示的一些视频。

```
<video id="somevideo"></video> 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T00:35:25.663

一直问直到我弄清楚了，在一个单独的函数中，我需要以父级为目标，它已从其中非常删除，所以我从未想过要查看，但它使所有其他方法之后都以该父级为目标。

# r - R：对 2 个数据帧的行进行 t 测试

> ID：12522797
> 
> 赞同：4
> 
> 时间：2012-09-21T00:31:01.723
> 
> 标签：r, dataframe, statistics, t-test

我有两个数据框，我想对行进行独立的 2 组 t 检验（即 dataframe1 中的行在哪里，并且与 dataframe2 中的行`t.test(y1, y2)`匹配）`y1``y2`

实现这一目标的最佳方法是什么？

编辑：我刚刚找到了格式：dataframe1[i,] dataframe2[i,]。这将循环工作。这是最好的解决方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-21T00:48:35.050

您概述的方法是合理的，只需确保预先分配您的存储向量。我会仔细检查您是否真的想比较行而不是列。我使用的大多数数据集都将每一行作为一个观察单位，并且这些列代表不同的响应/感兴趣的列无论如何，这是您的数据 - 所以如果这是您需要做的，这里有一种方法：

```
#Fake data
df1 <- data.frame(matrix(runif(100),10))
df2 <- data.frame(matrix(runif(100),10))

#Preallocate results
testresults <- vector("list", nrow(df1))
#For loop
for (j in seq(nrow(df1))){
  testresults[[j]] <- t.test(df1[j,], df2[j,])
} 
```

您现在有一个列表，只要您在`df1`. 然后，我建议使用`lapply`并`sapply`轻松地从列表对象中提取内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-21T00:52:40.477

将数据存储为列会更有意义。

您可以通过以下方式转置 data.frame

```
df1_t <- as.data.frame(t(df1))
df2_t <- as.data.frame(t(df2)) 
```

然后您可以使用一次`mapply`循环通过两个`data.frames`列

```
t.test_results <- mapply(t.test, x= df1_t, y = df2_t, SIMPLIFY = F) 
```

或者您可以使用它是with `Map`的简单包装器（从而节省击键！）`mapply``SIMPLIFY = F`

```
t.test_results <- Map(t.test, x = df1_t, y = df2_t) 
```

# sharepoint - EventReceiver 创建文件夹 sharepoint 2010

> ID：12522802
> 
> 赞同：2
> 
> 时间：2012-09-21T00:31:42.453
> 
> 标签：sharepoint, sharepoint-2010

我有这个事件接收器 c# 类，我试图在 Sharepoint 站点上实现它。那没起效。在构建好之后，我已经从 Visual Studio 2010 部署了它。有谁看到是什么问题？代码正常吗？还是SP上的问题？谢谢你。- 这是新代码

```
 using System;
using System.Security.Permissions;
using Microsoft.SharePoint;
using Microsoft.SharePoint.Security;
using Microsoft.SharePoint.Utilities;
using Microsoft.SharePoint.Workflow;

namespace EventReceiverCFolder.EventReceiver1
{
    /// <summary>
    /// List Item Events
    /// </summary>
    public class EventReceiver1 : SPItemEventReceiver
    {
        /// <summary>
        /// An item is being added.
        /// </summary>
        public override void ItemAdded(SPItemEventProperties properties)
        {

            try
            {
                if (properties.ListTitle == "CF") // list where the item was added 
                { // if item was added to this list then create a folder on -  Dlib - list
                    UpdateFolder(properties);
                }
            }
            catch (Exception ex)
            {
                properties.Status = SPEventReceiverStatus.CancelWithError;
                properties.ErrorMessage = ex.Message;
                properties.Cancel = true;
            }
        }

        private void UpdateFolder(SPItemEventProperties properties)
        {
            string foldername = properties.ListItem["Title"].ToString();

            try
            {
                SPSecurity.RunWithElevatedPrivileges(delegate()
                {
                    //inside RunWithElevatedPriviliges I need to open a new site (an elevated site) 
                    using (SPSite site = new SPSite(properties.Web.Site.ID))
                    {
                        using (SPWeb web = site.OpenWeb())
                        {
                            web.AllowUnsafeUpdates = true;
                            SPList list = web.Lists.TryGetList("DLib"); // this is doc Library where the new folder will be created
                            //note that we are creating a list item, not a folder - a folder IS a list item 
                            SPListItem createdFolder = list.Items.Add(list.RootFolder.ServerRelativeUrl, SPFileSystemObjectType.Folder, null);
                            if (createdFolder != null)
                            {
                            createdFolder["Name"] = foldername;
                                createdFolder.Update();
                            }
                            list.Update();
                        }
                    }
                });
            }
            finally { }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T09:55:45.477

不要这样做：`SPUser privilegedAccount = properties.Web.AllUsers[@"SHAREPOINT\SYSTEM"];` 阅读使用`SPSecurity.RunWithElevatedPrivileges`. 请参阅[此处的 MSDN 文档](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spsecurity.runwithelevatedprivileges.aspx)。

也不要使用 using (SPSite... 并且在 using 块内您尝试通过该网络获取网络`SPContext.Current`- 该网络将不再被提升。

正确的方法是沿着这些思路（我没有尝试这个，所以它只是为了让你知道你要去哪里）：

```
private void UpdateFolder(SPItemEventProperties properties)
{
    string foldername = properties.ListItem["Title"].ToString();

    SPSecurity.RunWithElevatedPrivileges(delegate()
    {
            //inside RunWithElevatedPriviliges I need to open a new site (an elevated site)
        using (SPSite site = new SPSite(properties.Web.Site.ID))
        {
            using (SPWeb web = site.OpenWeb())
            {
                web.AllowUnsafeUpdates = true;
                SPList list = web.Lists.TryGetList("ListTitle"); //is that really the list title?
                //note that we are creating a list item, not a folder - a folder IS a list item
                SSPListItem createdFolder = list.Items.Add(list.RootFolder.ServerRelativeUrl, SPFileSystemObjectType.Folder, null);
                if (newFolder != null)
                {
                    createdFolder["Name"] = foldername;
                    createdFolder.Update();
                }
                list.Update();
            }
        }
    });
} 
```

也尝试调试你的代码，设置断点等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T20:40:07.110

我必须得到这样的文件夹名称：

```
string foldername = Convert.ToString(properties.AfterProperties["Title"]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-21T01:14:13.757

您是否尝试调试它？尝试调试并告诉我们您遇到了什么错误。但是在您调试之前首先使用[共享点管理器](http://spm.codeplex.com/releases/view/35932)来查看您的事件接收器是否正确连接。

如果您不知道如何调试共享点事件接收器，请[参阅此](http://msdn.microsoft.com/en-us/library/ff650703.aspx)

# list - 如何在 SML 的列表中找到最大的数字

> ID：12522803
> 
> 赞同：3
> 
> 时间：2012-09-21T00:31:49.200
> 
> 标签：list, sml, smlnj

> 我们想在给定的非空整数列表中找到最大值。然后我们必须比较列表中的元素。由于数据值是作为序列给出的，我们可以从列表的开头或结尾进行比较。以两种方式定义。a) 从头比较 b) 从尾比较（当数据值在列表中时，我们如何做到这一点？）

我所做的是从一开始就通过比较找到最大的数字。

我怎么能从头到尾做到这一点？我应该应用什么逻辑？

这是我从一开始就进行比较的代码。

```
- fun largest[x] = x
= | largest(x::y::xs) =
= if x>y then largest(x::xs) else largest(y::xs)
= | largest[] = 0;
val largest = fn : int list -> int

output

- largest [1,4,2,3,6,5,4,6,7];
val it = 7 : int 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-21T06:20:07.937

在您的函数中，比较列表的前两个元素，并将较大的值与其余元素进行比较。我认为从末尾进行比较意味着您首先尝试找到列表尾部的最大数量，然后将其与头部元素进行比较。

```
fun largest [] = raise Empty 
 | largest [x] = x
 | largest (x::xs) =
      let 
        val y = largest xs
      in
        if x > y then x else y
      end 
```

虽然不是必需的，但为了完整性，您应该处理空列表的情况。如果使用函数，你可以缩短`max`函数。

```
fun largest [] = raise Empty 
 | largest [x] = x
 | largest (x::xs) = max(x, largest xs) 
```

老实说，我更喜欢你的尾递归版本（它不会在大列表中破坏堆栈）。正如其他答案所示，我的函数可以重写为尾递归，但它肯定比你的函数更复杂。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-21T20:08:56.227

正如@pad 用他的代码演示的那样，应该应用的逻辑是进行递归调用，在解决函数当前范围的问题*之前递归地解决子问题。*

在 的情况下`largest`，向后解决它实际上没有任何意义，因为它只是使用更多的堆栈空间，这在“手动”执行代码时变得很明显。然而，设计模式在其他情况下很有用。想象一个名为的函数`zip`：

```
(* zip ([1,2,3,4], [a,b,c]) = [(1,a),(2,b),(3,c)] *)
fun zip (x::xs, y::ys) = (x,y) :: zip (xs, ys)
  | zip _ = [] 
```

此函数将两个列表的元组转换为许多元组的列表，丢弃剩余值。它在某些情况下可能很有用，并且定义它也不是那么糟糕。然而，制作它的对应物 ，`unzip`有点棘手：

```
(* unzip ([(1,a),(2,b),(3,c)] = ([1,2,3],[a,b,c]) *)
fun unzip [] = ([], [])
  | unzip ((x,y)::xys) =
    let
      val (xs, ys) = unzip xys
    in
      (x::xs, y::ys)
    end 
```

手动运行常规“从头开始” - 最大可能如下所示：

```
 largest [1,4,2,3,6,5,4,6,7]
~> largest [4,2,3,6,5,4,6,7]
~> largest [4,3,6,5,4,6,7]
~> largest [4,6,5,4,6,7]
~> largest [6,5,4,6,7]
~> largest [6,4,6,7]
~> largest [6,6,7]
~> largest [6,7]
~> largest [7]
~> 7 
```

手动运行“从头开始” - 最大，想象每个缩进级别都需要将函数调用的当前上下文保存在[堆栈内存中](http://en.wikipedia.org/wiki/Call_stack)，调用新函数并在`~>`箭头之后返回结果，可能如下所示：

```
largest [1,4,2,3,6,5,4,6,7] ~> 7
 \_
   largest [4,2,3,6,5,4,6,7] ~> 7
    \_
      largest [2,3,6,5,4,6,7] ~> 7
       \_
         largest [3,6,5,4,6,7] ~> 7
          \_
            largest [6,5,4,6,7] ~> 7
             \_
               largest [5,4,6,7] ~> 7
                \_
                  largest [4,6,7] ~> 7
                   \_ 
                     largest [6,7] ~> 7
                      \_
                        largest [7] ~> 7 
```

那么，如果这些[非尾递归函数](http://en.wikipedia.org/wiki/Tail_call)只是使用更多内存，为什么它们会使早期递归调用有用呢？好吧，如果我们回过头来`unzip`想在没有这种烦人的“反向思考”的情况下解决它，那么在构建新结果（元组）时就会遇到问题，因为我们没有任何地方可以放置 x 和 y：

```
(* Attempt 1 to solve unzip without abusing the call stack *)
fun unzip [] = ([], [])
  | unzip ((x,y)::xys) = ...something with x, y and unzip xys... 
```

制作这样一个地方的一个想法是创建一个辅助函数（辅助函数），它有一些额外的函数参数来构建`xs`和`ys`。当到达 xys 列表的末尾时，将返回这些值：

```
(* Attempt 2 to solve unzip without abusing the call stack *)
local
  fun unzipAux ([], xs, ys) = (xs, ys)
    | unzipAux ((x,y)::xys, xs, ys) = unzipAux (xys, x::xs, y::ys)
in
  fun unzip xys = unzipAux (xys, [], [])
end 
```

但是您可能已经意识到，`(xs, ys)`结果最终会逆转。解决此问题的一种快速方法是`rev`仅在它们上使用一次，这最好在基本情况下实现：

```
(* Attempt 3 to solve unzip without abusing the call stack *)
local
  fun unzipAux ([], xs, ys) = (rev xs, rev ys)
    | unzipAux ((x,y)::xys, xs, ys) = unzipAux (xys, x::xs, y::ys)
in
  fun unzip xys = unzipAux (xys, [], [])
end 
```

这就引出了一个有趣的问题：*如何`rev`实现？*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-31T23:37:53.807

```
(*Find the max between two comparable items*)
fun max(a,b) = if a>b then a else b;
(*Find the max item in list which calls the maxL function recursively*)
fun maxL(L) = if L=[] then 0 else max(hd(L), maxL(tl(L))); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-22T04:22:18.637

我建议使用尾递归助手，它将当前最大值作为累加器传递。

```
local
    fun helper max [] = max
      | helper max (n::ns) = helper (if n > max then n else max) ns
in
    fun largest ns = helper 0 ns
end; 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-05-13T07:38:56.697

我知道现在回答您的问题为时已晚，但希望这会有所帮助：

```
fun insert (x, []) = [x]
| insert (x, y::ys) = if x<=y then x::y::ys else y::insert(x,ys);

fun insertion_sort [] = []
| insertion_sort (x::xs) = insert(x, insertion_sort xs);

fun get_last_element [] = 0
| get_last_element [x] = x
| get_last_element (x::xs) = if(xs=nil)
                                then x
                             else
                                get_last_element(xs);

fun get_min L = if(insertion_sort(L)=[]) 
                    then 0 
                else
                    hd(insertion_sort(L));
fun get_max L = get_last_element(insertion_sort(L)); 
```

您还可以调整代码，例如在插入函数中传递匿名函数...

# javascript - 滚动事件监听器 javascript

> ID：12522807
> 
> 赞同：57
> 
> 时间：2012-09-21T00:32:31.847
> 
> 标签：javascript

当用户在某个可以使用的文本框中滚动时，是否有一个 js 监听器？有点像 onclick 除了滚动。我看到了[用于数字输入滚动的 HTML5 事件侦听器 - 仅限 Chrome](https://stackoverflow.com/questions/5669207/html5-event-listener-for-number-input-scroll-chrome-only)，但这似乎只适用于 chrome。我正在寻找跨浏览器的东西。

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2013-08-30T21:38:11.603

对于那些发现这个问题并希望找到不涉及 jQuery 的答案的人，您可以`window`使用普通的事件监听来挂钩“滚动”事件。假设我们要添加滚动监听许多 CSS-selector-able 元素：

```
// what should we do when scrolling occurs
function runOnScroll(element) {
  // not the most exciting thing, but a thing nonetheless
  console.log(element);
};

// grab elements as array, rather than as NodeList
const elements = document.querySelectorAll(`...`);

// and then make each element do something on scroll
elements.forEach(element => {
  window.addEventListener(
    "scroll",
    () => runOnScroll(element),
    { passive: true }
  );
}); 
```

或者，使用`evt => runOnScroll(evt)`as 处理程序绑定单个滚动侦听器，然后找出如何处理函数`elements`内部的所有内容`runOnScroll`。

请注意，我们使用[被动](https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener#Parameters)属性告诉浏览器此事件不会干扰滚动本身。如果我们想要平滑的滚动行为，这一点很重要（也意味着我们不应该在滚动期间执行触发回流的 DOM 更新）。

对于奖励积分，您可以为滚动处理程序提供一个锁定机制，以便在我们已经滚动时它不会运行：

```
// global lock, so put this code in a closure of some sort so you're not polluting.
let locked = false;
let lastCall = false;

function runOnScroll(element) {
  if(locked) return;

  if (lastCall) clearTimeout(lastCall);
  lastCall = setTimeout(() => {
    runOnScroll(element);
    // you do this because you want to handle the last
    // scroll event, even if it occurred while another
    // event was being processed.
  }, 200);

  // ...your code goes here...

  locked = false;
}; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-05-06T07:24:51.303

我一直在寻找使用老式 JS（没有 JQuery）的 sticy menue 的解决方案。所以我建立了一个小测试来玩它。我认为这对那些在 js 中寻找解决方案的人会有所帮助。它需要改进使菜单背面不粘，并使其更光滑。我还找到了一个使用 JQuery 的不错的解决方案，它克隆原始 div 而不是固定位置，它更好，因为修复后不需要替换页面元素的其余部分。任何人都知道如何使用 JS 吗？请备注、指正、改进。

```
<!DOCTYPE html>
<html>

<head>
<script>

// addEvent function by John Resig:
// http://ejohn.org/projects/flexible-javascript-events/

function addEvent( obj, type, fn ) {

    if ( obj.attachEvent ) {

        obj['e'+type+fn] = fn;
        obj[type+fn] = function(){obj['e'+type+fn]( window.event );};
        obj.attachEvent( 'on'+type, obj[type+fn] );
    } else {
        obj.addEventListener( type, fn, false );
    }
}
function getScrollY() {
    var  scrOfY = 0;
    if( typeof( window.pageYOffset ) == 'number' ) {
        //Netscape compliant
        scrOfY = window.pageYOffset;

    } else if( document.body && document.body.scrollTop )  {
        //DOM compliant
        scrOfY = document.body.scrollTop;
    } 
    return scrOfY;
}
</script>
<style>
#mydiv {
    height:100px;
    width:100%;
}
#fdiv {
    height:100px;
    width:100%;
}
</style>
</head>

<body>

<!-- HTML for example event goes here -->

<div id="fdiv" style="background-color:red;position:fix">
</div>
<div id="mydiv" style="background-color:yellow">
</div>
<div id="fdiv" style="background-color:green">
</div>

<script>

// Script for example event goes here

addEvent(window, 'scroll', function(event) {

    var x = document.getElementById("mydiv");

    var y = getScrollY();      
    if (y >= 100) {
        x.style.position = "fixed"; 
        x.style.top= "0";
    } 
});

</script>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-10-22T10:13:41.007

下面的基本方法不能满足您的要求吗？

具有 div 的 HTML 代码

```
<div id="mydiv" onscroll='myMethod();'> 
```

JS 将有以下代码

```
function myMethod(){ alert(1); } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-27T13:46:09.813

> 当用户在某个可以使用的文本框中滚动时，是否有一个 js 监听器？

DOM L3 [UI 事件](https://www.w3.org/TR/uievents/)规范给出了初始定义，但[被认为](https://devdocs.io/dom/globaleventhandlers/onscroll)已过时。

要添加单个处理程序，您可以执行以下操作：

```
 let isTicking;
  const debounce = (callback, evt) => {
    if (isTicking) return;
    requestAnimationFrame(() => {
      callback(evt);
      isTicking = false;
    });
    isTicking = true;
  };
  const handleScroll = evt => console.log(evt, window.scrollX, window.scrollY);
  document.defaultView.onscroll = evt => debounce(handleScroll, evt); 
```

对于多个处理程序，或者如果出于样式原因更可取，您可以使用[`addEventListener`](https://devdocs.io/dom/eventtarget/addeventlistener)而不是分配您的处理程序，`onscroll`如上所示。

如果使用[`_.debounce`](https://lodash.com/docs/4.17.5#debounce)来自 lodash 之类的东西，您可能会逃脱：

```
const handleScroll = evt => console.log(evt, window.scrollX, window.scrollY);
document.defaultView.onscroll = evt => _.debounce(() => handleScroll(evt)); 
```

检查[浏览器兼容性](https://devdocs.io/dom_events/scroll#Browser_compatibility)，并确保在完成之前在一些实际设备上进行测试。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2021-07-06T23:05:50.863

```
let lastKnownScrollPosition = 0;
let ticking = false;

function doSomething(scrollPos) {
  // Do something with the scroll position
}

document.addEventListener('scroll', function(e) {
  lastKnownScrollPosition = window.scrollY;

  if (!ticking) {
    window.requestAnimationFrame(function() {
      doSomething(lastKnownScrollPosition);
      ticking = false;
    });

    ticking = true;
  }
}); 
```

# vb.net - vb.net 查找公共父目录

> ID：12522816
> 
> 赞同：1
> 
> 时间：2012-09-21T00:34:03.657
> 
> 标签：vb.net, search, directory

对于文件列表，我正在尝试确定公共父目录。这些文件不会在同一个目录中（测试了那部分）......我正在尝试

```
Dim myParentDirectory As String = Path.GetDirectoryName(list.Item(0))
Dim myCurrentDirectory As String
For Each file in list
  myCurrentDirectory = Path.GetDirectoryName(file)
  While myCurrentDirectory <> myParentDirectory And...  And myParentDirectory <> Nothing '(or <> to a top level directory like "c:")
   myParentDirectory = Directory.GetParent(myParentDirectory.ToString())
  End While
Next 
```

... 代表“myCurrentDirectory 不是 myParentDirectory 的子目录”，但我没有找到任何可以测试的东西——只有列出目录内容的方法。

如何获得两个文件（或目录）的公共目录父级？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T00:52:46.157

我有一个可行的解决方案。

首先定义一个递归函数，为您获取给定文件夹的所有祖先文件夹的列表：

```
Dim recurse As Func(Of DirectoryInfo, IEnumerable(Of string)) = Nothing
recurse = _
    Function (di)
        If di Is Nothing Then
            Return Enumerable.Empty(Of String)()
        Else
            Return Enumerable.Repeat(di.FullName, 1).Concat(recurse(di.Parent))
        End If
    End Function 
```

然后只需要获取两组这样的路径的交集并返回最长的路径即可。

像这样：

```
Dim di1 As new DirectoryInfo("E:\James\Media\Podcasts\TEDTalks (video)")
Dim di2 As new DirectoryInfo("E:\James\Media\Music\A Clash of Kings")

Dim result =
    recurse(di1) _
        .Intersect(recurse(di2)) _
        .OrderByDescending(Function (x) x.Length) _
        .First()

Console.WriteLine(result) 
```

结果是“E:\James\Media”。

可能有更漂亮的版本，但它有效。

# jquery - 是否可以像在 selenium 中一样模拟 casperjs 和 phantomjs 中的拖放？

> ID：12522827
> 
> 赞同：6
> 
> 时间：2012-09-21T00:36:22.453
> 
> 标签：jquery, selenium, tdd, phantomjs, casperjs

我正在尝试模拟在我的站点中使用 JQuery 完成的拖放事件。用我自己的JQuery“工作”手动执行“拖放”，但是在提交拖放事件所在的表单后，什么都不会发生，因为鼠标拖放事件附加了事件侦听器，并且这些听众不会被我的“手动”动作触发。我正在寻找类似于[Testing jQuery Drag & Drop and Droppable with Selenium](https://stackoverflow.com/q/7813700/467453)的东西。

这是一个仅在视觉上起作用但不会触发拖放事件处理程序的代码示例：

```
// "Simulate" drag&drop
casper.evaluate(function() {
  det = jQuery("table#draggableview_secondary_touts_block_order_1 tbody tr").last().detach();
  jQuery("table#draggableview_secondary_touts_block_order_1 tbody").prepend(det);
  jQuery("form#draggableviews-view-draggabletable-form-secondary-touts-block-order-homepage").submit();
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-10-12T15:41:52.370

您可以直接触发事件，如下所示：[https ://ghostinspector.com/blog/simulate-drag-and-drop-javascript-casperjs/](https://ghostinspector.com/blog/simulate-drag-and-drop-javascript-casperjs/)

这是否符合您的目的，或者您是否需要在更高级别触发的事件？

# c# - C#.NET WPF 中的基本线程锁定

> ID：12522833
> 
> 赞同：0
> 
> 时间：2012-09-21T00:37:05.583
> 
> 标签：c#, wpf, multithreading, thread-safety

这似乎是一个基本问题，但谷歌并没有帮助我......如何在 C#.NET WPF 中进行基本线程锁定？在我相当简单的用户应用程序中，我有多个线程执行耗时的操作，将它们的结果保存到一个通用数据结构中或从这个通用数据结构中读取。我希望能够围绕访问此数据结构进行 lock() 和 unlock() 以维护线程安全。但是，我的代码中有很多不同的地方可以访问这个数据结构，而不仅仅是一个。哪些 .NET 对象用于实现这种锁定？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T02:33:18.247

有多种方法可以实现同步。请查看我创建的屏幕截图 ![在此处输入图像描述](../Images/72458cdb8823a732c3687605de8b934e.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-21T00:41:31.507

尝试这个：

```
public static class LockHolder
{
    public static object Lock = new object();
} 
```

然后，在您的代码中，使用：

```
lock(LockHolder.Lock)
{
    //your safe code
} 
```

[http://msdn.microsoft.com/en-us/library/c5kehkcz(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/c5kehkcz(v=vs.71).aspx)

我想更多信息可能会有所帮助。IIRC，`lock(object o)`基本上是一个宏，将由编译器扩展，然后限制对您的*安全代码*的访问，这是您所期望的。不一定显而易见的是，**任何**对象`o`都可以是锁，并且`o`每个安全锁都需要每个对象。如果我有

```
object a = new object();
object b = new object(); 
```

并执行 a `lock(a)`then**不会**阻止访问`lock(b)`周围有 a 的东西。大多数代码示例都显示了`lock(this)`将锁定到特定类的*当前实例*，如果您需要全局锁定并且该类的多个实例在周围运行，这不是您想要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-21T03:27:47.703

查看 Sacha Barber 在 CodeProject 上的这篇精彩文章。

[http://www.codeproject.com/Articles/27366/Beginner-s-Guide-to-Threading-in-NET-Part-3-of-n](http://www.codeproject.com/Articles/27366/Beginner-s-Guide-to-Threading-in-NET-Part-3-of-n)

它解释了一些同步机制..

干杯

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-21T00:54:50.217

使用诸如[System.Collections.Concurrent命名空间中的](http://msdn.microsoft.com/en-us/library/system.collections.concurrent.aspx)[线程安全数据结构](http://msdn.microsoft.com/en-us/library/dd997305.aspx)可能更容易。他们为您完成所有工作。

# javascript - 有什么好的免费 Metro css/js 控件包吗？

> ID：12522834
> 
> 赞同：0
> 
> 时间：2012-09-21T00:37:29.843
> 
> 标签：javascript, .net, css, microsoft-metro

> **可能重复：**
> [网站的 Metro 主题](https://stackoverflow.com/questions/5330426/metro-theme-for-website)

我希望能够创建一个与普通 Metro 应用程序完全相同的网页。我还希望它具有点击时的倾斜和效果。有没有一个javascript库可以做到这一点？或者我可以直接从微软的样式中获得 css/js 动画吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T07:54:05.053

你可以试试[Wijmo](http://wijmo.com/)。Wijmo 有一个开放（免费）和一个完整（付费）版本。他们有两个不同的地铁主题，可以在[这里](http://wijmo.com/demo/explore/?showall=true)查看。

[您可以在这里](http://jquit.com/build-jquery-ui-themes-with-jquit-builder/)为自己创建一个 Metro jQuery UI 主题。

# php - PHP 后端/前端安全

> ID：12522836
> 
> 赞同：-1
> 
> 时间：2012-09-21T00:37:39.293
> 
> 标签：php, web-services, web-applications, security

**大家好，**

在洗澡的时候，我想到了一些有趣的事情。在 PHP 中，您如何判断用户提交的表单是否有效而不是欺诈（即其他站点上的其他表单，action="http://mysite.com/sendData.php"）？因为真的，任何人都可以创建一个表单来尝试在真实后端发送和匹配 $_POST 变量。我如何确保***该***脚本是合法的（来自我的站点并且仅来自我的站点），所以我没有发生某种克隆站点数据窃取的事情？

我有一些想法，但不知道从哪里开始

*   生成一次性密钥并存储在隐藏的输入字段中
*   尝试（尽可能）获取表单所在的 url（可能不可能）
*   使用一些非常复杂的 PHP 好东西来确定数据的发送位置（可能）

有任何想法吗？谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T01:52:32.850

curl 将使用这些来自黑客的大多数尝试。使用 curl 可以轻松更改引用代理。您甚至可以使用 curl 设置 cookie。但是使用私有盐来欺骗 md5 散列密钥并将其存储在会话数据中将阻止大多数普通黑客和机器人。将密钥存储在数据库中将添加身份验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T00:41:09.920

有几种简单的方法，例如：

*   检查`$_SERVER['HTTP_REFERER']`以确保您的主机是引用脚本
*   在表单中添加散列键并使用存储的服务器会话变量检查它们。

但是以上所有内容都可以以某种方式被操纵和欺骗。因此，您可以使用**CSRF Validations**。这是一篇非常好的[文章](http://shiflett.org/articles/cross-site-request-forgeries)。

我遇到的其他附加技术是：

*   为表单添加时间限制并确保在该时间内提交。
*   在与表单的每次交互中，发送 AJAX 请求以验证和响应表单的时间限制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-26T04:23:24.700

HTML5 提供了一种新的输入类型。该元素的目的是提供一种对用户进行身份验证的安全方式。标签指定表单中的密钥对生成器字段。

提交表单时，会生成两个密钥，一个是私有的，一个是公共的。

私钥存储在本地，公钥发送到服务器。公钥可用于生成客户端证书以在将来对用户进行身份验证。

[HTML5 中的注册机标签](https://stackoverflow.com/questions/4501196/keygen-tag-in-html5)

[RFC](http://www.w3.org/html/wg/drafts/html/master/Overview.html#the-keygen-element)

# macos - DYLD_INSERT_LIBRARIES 不适用于在 Mountain Lion 上使用权利签名的应用

> ID：12522837
> 
> 赞同：6
> 
> 时间：2012-09-21T00:37:49.300
> 
> 标签：macos, dyld

我注意到，`DYLD_INSERT_LIBRARIES`如果应用程序使用权利进行代码签名，则不再适用于 Mountion Lion。例如：

```
DYLD_INSERT_LIBRARIES=./mylib.dylib /Applications/Safari.app/Contents/MacOS/Safari
  dyld: DYLD_ environment variables being ignored because main executeable is code signed with entitlements. 
```

我知道这可能是 Mountion Lion 中添加的一项新安全功能。任何人都知道是否有另一种方法可以在山狮上做类似的事情？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T08:01:52.087

没有办法`DYLD_INSERT_LIBRARIES`处理这种性质的应用程序。

`dyld`剥离`DYLD_`它认为受限制的应用程序上的所有环境变量，其中包括 setuid/setgid 二进制文件和使用特定权利签名的那些。您可以通过查看[`dyld`源代码](http://www.opensource.apple.com/source/dyld/dyld-210.2.3/src/dyld.cpp)来了解它是如何工作的。特别是，`processRestricted`负责确定是否应应用限制`pruneEnvironmentVariables`并对环境变量进行特殊处理。

# python-3.x - 更改 tempfile.NamedTemporaryFile 的字符集

> ID：12522844
> 
> 赞同：3
> 
> 时间：2012-09-21T00:38:48.580
> 
> 标签：python-3.x

我正在编写一个 python3 程序，该程序生成一个文本文件，该文件使用 asciidoc 进行后处理，用于 html 和 pdf 的最终报告。

python 程序生成数千个带有图形的文件，以包含在最终报告中。文件的文件名是使用 tempfile.NamedTemporaryFile 生成的

tempfile使用的字符集定义为：

字符=“abcdefghijklmnopqrstuvwxyz0123456789_”

然后我以一些名称为“_6456_”的文件结束，asciidoc 将“_”解释为格式并插入一些破坏报告的 html。

我需要找到一种方法来“转义” asciidoc 中的文件名或控制临时文件中的字符。

我当前的解决方案是在关闭临时文件后重命名临时文件，以将“_”替换为其他字符（不在 tempfile 用于避免冲突的字符列表中），但我觉得有更好的方法做。

我会欣赏任何想法。我对 python 还不是很精通，我认为在 tempfile 中重载 _RandomNameSequence 会起作用，但我不知道该怎么做。

问候。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-21T00:56:57.893

黑客方式，基于操纵`tempfile`内部：

```
class MyRandomSequence(tempfile._RandomNameSequence):
    characters = "xyz123"

tempfile._name_sequence = MyRandomSequence()
# make your temporary file 
```

例子：

```
>>> tempfile.NamedTemporaryFile()
<open file '<fdopen>', mode 'w+b' at 0x1013b5540>
>>> k=_
>>> k.name
'/var/folders/Su/SuMQtmxiE941sUwe8d91lE+++TU/-Tmp-/tmp33x22z' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T00:46:02.243

也许您可以使用`tempfile.tempdir`手动创建一个临时目录并生成文件名，例如`file1, file2, ..., filen`. 这样您就可以轻松避免使用“_”字符，并且您可以在完成后删除临时目录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-21T10:41:01.993

为什么不自己创建一个生成器？

例子：

```
import string
from random import choice

def generate():
    size = 9
    return ''.join([choice(string.letters + string.digits) for i in range(size)]) 
```

[来源](http://snipplr.com/view/3677/)

# javascript - 如何在 JQuery 中使用 getJSON 解析和执行 JavaScript

> ID：12522847
> 
> 赞同：0
> 
> 时间：2012-09-21T00:39:04.603
> 
> 标签：javascript, jquery

在以下代码中：

```
 function main() { 
        jQuery(document).ready(function($) { 
            /******* Load HTML *******/
             var jsonp_url = "http://184.72.244.64/test.fwx?callback=?";         
            $.getJSON(jsonp_url, function(data) {
              $('#DivTagToInsertTheHTML').html(data.html);
            });
        });
    } 
```

我想使用此功能将大量 JavaScript 传递到客户端浏览器。我需要使用它的原因是我需要从破坏“同源策略”的外部服务器中检索它。

那么当我在 JSON 中获取 JavaScript 时，我该如何解析并执行它呢？有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T01:57:59.663

您使用 javascript eval 函数。请记住，这是一个安全风险。跨域安全是有原因的。为什么需要实时运行 javascript？

[http://www.w3schools.com/jsref/jsref_eval.ASP](http://www.w3schools.com/jsref/jsref_eval.ASP)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T01:00:14.723

好的，

尝试这个：

使用带有 crossDomain 的 jquery ajax 调用：true

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

或使用 xDomainRequest（针对 IE）和 XMLHttpRequest（针对跨域请求的特定对象）

如果可以的话，您应该在处理请求时了解带有 CORS 的服务器：

```
header('Access-Control-Allow-Origin: http://www.example.com');
header('Access-Control-Allow-Credentials: true');
if ($this->getRequestMethod() == 'OPTIONS')
{
    header('Access-Control-Allow-Methods: GET, POST, PUT, DELETE, OPTIONS');
    header('Access-Control-Max-Age: 604800');
    header('Access-Control-Allow-Headers: x-requested-with');
    exit(0);
} 
```

这是一个好帖子：

[http://tpeczek.blogspot.pt/2010/09/httphandler-with-cross-origin-resource.html](http://tpeczek.blogspot.pt/2010/09/httphandler-with-cross-origin-resource.html)

# c# - ReadAsMultipartAsync 的异步优势是什么？

> ID：12522849
> 
> 赞同：2
> 
> 时间：2012-09-21T00:39:26.623
> 
> 标签：c#, asp.net-mvc, asynchronous, asp.net-web-api

一位同事向我展示了一些他们在 ASP.NET Web Api 中处理上传文件的代码。是这样的：

```
 Task<IEnumerable<HttpContent>> task = Request.Content.ReadAsMultipartAsync(provider);

    return task.ContinueWith<HttpResponseMessage>(contents =>
    {
        //Do stuff...
    } 
```

异步读取文件有什么好处？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-21T20:49:40.960

从网络套接字读取文件是一个 I/O 绑定操作。异步执行此操作可确保您在读取期间不会危及服务器上的工作线程，但您正在利用 I/O 完成端口。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-21T15:13:32.840

这完全是关于使用异步释放处理请求的线程。一旦你这样做了，线程将能够服务另一个请求。

也最好不要使用`ContinueWith`，我在解释[为](http://byterot.blogspot.co.uk/2012/08/tpl-async-parallel-task-library-server-lesson-hard-way.html)​​什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-21T00:46:25.600

同步 IO 需要时间并挂起您的代码，即使它不在磁盘上（与网络相反）。切换到异步 IO 通过让框架处理您的 IO 请求而不阻塞您的客户端代码来缓解这种情况。

# objective-c - 带有亚秒和时区的 NSDateFormatter 字符串

> ID：12522854
> 
> 赞同：1
> 
> 时间：2012-09-21T00:39:42.167
> 
> 标签：objective-c

我已经把头撞了太久了！我有一个字符串：2012-09-27T18:00:00.000-04:00 我有一个格式：[dateFormatter setDateFormat:@"yyyy-MM-dd'T'HH:mm:ss'Z'"]; 我得到一个空结果转换字符串。有人可以帮助正确的日期格式吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-21T00:55:41.257

根据 NSDateFormatter 的文档：

> 格式字符串使用 Unicode 技术标准 #35 中的格式模式。标准的版本随操作系统的发布而变化：
> 
> OS X v10.8 和 iOS 6.0 中的格式化程序使用 [版本 tr35-25]。

按照该链接：

> s 1..2 12 秒。使用一个或两个进行零填充。

换句话说，`s`for seconds 只意味着不可分割的部分。

但就在其下方，有：

> S 1..n 3456 小数秒 - 截断（与其他时间字段一样）到字母数。（示例显示使用模式 SSSS 显示秒值 12.34567）

然后，您不匹配时区的原因是您引用了`Z`，因此它匹配文字`Z`而不是时区格式。

为了匹配您看到的 ISO8601 时区格式，相同的文档说您需要 ZZZZZ。

所以，看起来，至少对于 10.8/iOS 6，你想要：

```
[dateFormatter setDateFormat:@"yyyy-MM-dd'T'HH:mm:ss'.'SSSZZZZZ"] 
```

对于早期版本，您已经获得了文档的链接；你现在应该可以弄清楚了。

对此进行测试（在 Python 中，以节省几行代码）：

```
>>> import Cocoa
>>> df = Cocoa.NSDateFormatter.alloc().init()
>>> df.setDateFormat_("yyyy-MM-dd'T'HH:mm:ss'.'SSSZZZZZ")
>>> print df.dateFromString_(2012-09-27T18:00:00.000-04:00')
2012-09-27 22:00:00 +0000 
```

# javascript - Dreamweaver 在 JS 文件中显示奇怪的语法错误

> ID：12522856
> 
> 赞同：0
> 
> 时间：2012-09-21T00:40:38.080
> 
> 标签：javascript, ajax, jquery, dreamweaver

Dreamweaver 在文件中显示错误

jquery.jig.js

文件是这个

```
jQuery(document).ready(function(){
    $('#contactform').submit(function(){
    var action = $(this).attr('action');
    $('#submit').attr('disabled','disabled').after('<img src="contact-form/assets/ajax-loader.gif" class="loader" />');
    $("#message").slideUp(750,function() {
    $('#message').hide();      
    $.ajax({
        type:"POST",
        url: "yourPhpFileURL.php",   //put the url of your php file here
        data: $('#contactform').serialize(),
        success: function(data){
            document.getElementById('message').innerHTML = data;
            $('#message').slideDown('slow');
            $('#contactform img.loader').fadeOut('fast',function(){$(this).remove()});
            $('#submit').removeAttr('disabled');
            if(data.match('success') != null) $('#contactform').slideUp('slow');

            if(data.match('success') != null) $("html,body").animate({
                scrollTop: $("#message").offset().top
                }, 1000, function(){

                });
            if(data.match('success') == null) $("html,body").animate({
                scrollTop: $("#message").offset().top
                }, 1000, function(){
                    //scroll complete function
                });                     
        }
        });

    });

    return false;

});

}); 
```

错误显示在最后一行，但我无法理解原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T02:05:51.863

我通过[jsfiddle](http://jsfiddle.net/)的 JSLint 语法分析器运行了您的代码，并修复了一些错误等。到目前为止，以下验证正常。请在您的最后检查它：

```
jQuery(document).ready(function() {
    $('#contactform').submit(function() {
        var action = $(this).attr('action');
        $('#submit').attr('disabled', 'disabled').after('<img src="contact-form/assets/ajax-loader.gif" class="loader" />');
        $("#message").slideUp(750, function() {
            $('#message').hide();
            $.ajax({
                type: "POST",
                url: "yourPhpFileURL.php",
                //put the url of your php file here
                data: $('#contactform').serialize(),
                success: function(data) {
                    document.getElementById('message').innerHTML = data;
                    $('#message').slideDown('slow');
                    $('#contactform img.loader').fadeOut('fast', function() {
                        $(this).remove();
                    });
                    $('#submit').removeAttr('disabled');
                    if (data.match('success') !== null) {
                        $('#contactform').slideUp('slow');
                    }
                    var msg_offset = $("#message").offset().top;
                    if (data.match('success') !== null) {
                        $("html,body").animate({
                            scrollTop: msg_offset
                        }, 1000, function() {

                        });
                    }
                    if (data.match('success') === null) {
                        $("html,body").animate({
                            scrollTop: msg_offset
                        }, 1000, function() {
                            //scroll complete function
                        });
                    }
                }
            });

        });

        return false;

    });

}); 
```

# maven - 如何阻止 Maven 扩展 env。变量 w/Jenkins？

> ID：12522857
> 
> 赞同：3
> 
> 时间：2012-09-21T00:40:46.840
> 
> 标签：maven, jenkins, environment-variables

我对 Jenkins 很熟悉，但对 Maven 很陌生，我正试图弄清楚如何阻止我们在 Jenkins 中的 Maven 作业在`ApplicationContext.xml`文件中扩展环境变量。

在我们的`ApplicationContext.xml`文件中，我们引用了`${DeployMode}`Tomcat 在加载/运行时扩展的环境变量（我们创建的）：

```
<!-- SPRING CONTEXT static accessor -->
<beans:bean id="contextApplicationContextProvider"
            class="com.dartneuroscience.compserv.rest.appcontext.AppContextProvider">
  <beans:constructor-arg>
    <beans:value>${DeployMode}</beans:value>
  </beans:constructor-arg>
</beans:bean>

<beans:bean id="placeholderConfig"
            class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
  <beans:property name="location"
                  value="/WEB-INF/App_${DeployMode}.properties" />
</beans:bean> 
```

问题是，在 Jenkins 运行的 Maven 构建中，`WEB-INF/ApplicationContext.xml`如果在构建机器上设置了环境变量，则构建看起来像这样（在本例中假设为“Prod”）：

```
<!-- SPRING CONTEXT static accessor -->
<beans:bean id="contextApplicationContextProvider"
            class="com.dartneuroscience.compserv.rest.appcontext.AppContextProvider">
  <beans:constructor-arg>
    <beans:value>Prod</beans:value> <!-- Expanded env. var -->
  </beans:constructor-arg>
</beans:bean>

<beans:bean id="placeholderConfig"
            class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
  <beans:property name="location"
                  value="/WEB-INF/App_Prod.properties" /> <!-- Expanded env. var -->
</beans:bean> 
```

因此，该值现在被“硬编码”到 WAR 中，即使目标 Web 服务器将其`DeployMode`环境变量设置为其他值，例如“Staging”，它也始终表现得像“Prod”。

当我在同一个构建服务器上手动运行 Maven 时不会发生这种情况——它只会在 Jenkins 构建作业时发生。

有没有我可以传递给 Jenkins 来阻止这种行为的设置？

在运行作业时，我已经查看了所有环境变量的 EnvInject 插件等选项`UNSET`，但我真的对这种行为感到困惑，并想深入了解它。

谢谢你。

# 更新 1

我在顶级 POM 中找到了以下资源过滤块，并添加了该`<excludes/>`块以跳过我们的`AppContext.xml`文件：

```
 <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-war-plugin</artifactId>
        <version>2.1.1</version>
        <configuration>
          <webResources>
            <webResource>
              <directory>${basedir}/src/main/webapp/WEB-INF</directory>
              <includes>
                <include>*.xml</include>
              </includes>
              <excludes>
                <exclude>*AppContext.xml</exclude>
              </excludes>
              <targetPath>WEB-INF</targetPath>
              <filtering>true</filtering>
            </webResource>
          </webResources> 
```

但这仍然没有回答为什么在 Jenkins 运行时环境变量被添加到属性列表中，而在从命令行运行时被忽略；虽然几年前我确实发现了这个哈德逊问题：[从哈德逊运行时资源过滤失败](https://issues.jenkins-ci.org/browse/JENKINS-3715)

此外，EnvInjectPlugin 执行它所宣传的内容，但在至少删除 PATH 变量时，构建中断，因为 maven 找不到该`ls`命令。

# 更新 2

将 Jenkins 中的工作从“Maven 2/3 项目”更改为“自由式软件项目”并使用`Invoke top-level Maven targets`构建步骤产生所需的结果，而无需修改 POM。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T14:30:41.500

Jenkins 可能会以某种方式启用资源过滤。您有很多配置过滤的选择。您可以完全禁用它，将过滤限制为具有某些扩展名的文件，告诉它不要在过滤器中包含构建属性，或者选择不同的分隔符来完全过滤。请参阅[资源：资源文档](http://maven.apache.org/plugins/maven-resources-plugin/resources-mojo.html)或[资源过滤概念的描述](https://books.sonatype.com/mvnref-book/reference/resource-filtering.html)。

# qt - 使用多个键实现类似 QHash 的查找

> ID：12522858
> 
> 赞同：4
> 
> 时间：2012-09-21T00:40:50.607
> 
> 标签：qt, key, lookup, lookup-tables, qhash

我试图找到实现使用多个键返回一个值的类似 QHash 的查找表的最佳方法。我读过 Boost 库具有类似的功能，但如果可能的话，我想避免这种情况。

我想做的一个例子如下（显然下面的伪代码是不可能的）：

```
//First key (int) - Engine cylinders
//Second key (int) - Car weight
//Value (int) - Top speed
MyLookup<int, int, int> m_Lookup
m_Lookup.insert(6, 1000, 210);
m_Lookup.insert(6, 1500, 190);
m_Lookup.value(6, 1000); //Returns 210 
```

我的第一个（也是非常慢的）想法是创建一个结构，然后遍历一个列表，直到找到一个符合条件的项目。

```
Struct Vehicle {
   int cyl;
   int weight;
   int speed'
}

QList<Vehicle> carList; //Assume this is populated
for(i = 0; i < carList.length; ++i) { 
if(carList[i].cyl == 6 && carList[i].weight == 1000) {
return carList[i].speed; } } 
```

我的另一个想法是将两个键连接成一个键，并在需要时实现几个函数来组合和分离两个键。虽然这会起作用，并且可能比完整迭代快得多，但它似乎有点被破解了。

```
QHash<QString, int> m_Lookup;
m_Lookup.insert("6|1000", 210); 
```

有谁知道尝试实现这一目标的更好方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-21T02:24:09.067

## 选项1

使用 a`QPair`作为您的密钥：

```
QHash<QPair<int, int>, int> m_Lookup;

m_Lookup.insert(QPair<int, int>(6, 1000), 210);
m_Lookup.insert(QPair<int, int>(6, 1500), 190);

qDebug("Value is %d", m_Lookup.value(QPair<int, int>(6, 1000))); 
```

## 选项 2

创建一个类来表示您想要的车辆特性（完成等式/不等式运算符）并`qHash`为您的类创建一个实现：

```
class Vehicle
{
public:
   Vehicle(short cylinders, short weight) 
      : m_Cylinders(cylinders), m_Weight(weight) { }

   short cylinders() const { return m_Cylinders; }
   short weight() const { return m_Weight; }

   bool operator==(const Vehicle& other) const 
      { return (m_Cylinders == other.m_Cylinders && m_Weight == other.m_Weight); }
   bool operator!=(const Vehicle& other) const 
      { return !operator==(other); }

private:
   short m_Cylinders;
   short m_Weight;
};

inline uint qHash(const Vehicle& key)
{
   uint k = static_cast<uint>(key.cylinders()) << 16 | static_cast<uint>(key.weight());
   return k;
}

int main(int argc, char** argv)
{
   QHash<Vehicle, int> m_Lookup;

   m_Lookup.insert(Vehicle(6, 1000), 210);
   m_Lookup.insert(Vehicle(6, 1500), 190);

   qDebug("Value is %d", m_Lookup.value(Vehicle(6, 1000)));

   return 0;
} 
```

# android - 在相对布局内移动 VideoView

> ID：12522868
> 
> 赞同：1
> 
> 时间：2012-09-21T00:42:01.133
> 
> 标签：android, android-videoview

我有带 VideoView 的 RelativeLayout，需要通过手势移动和缩放 videoView。

```
mAnimationLayout = new RelativeLayout(mContext);
mAnimationLayout.setOnTouchListener(new AnimationListener());
RelativeLayout.LayoutParams lpFill = new RelativeLayout.LayoutParams(
    RelativeLayout.LayoutParams.MATCH_PARENT, 
    RelativeLayout.LayoutParams.MATCH_PARENT
);
mVideoView = new VideoView(mContext);
mVideoView.setVideoURI(mProduct.mAnimationVideos.get(0));
mVideoView.start();
mAnimationLayout.addView(mVideoView, lpFill); 
```

然后我试图做到这一点：

```
private void moveVideo(float x, float y){

    int left = mVideoView.getLeft() + (int)x;
    int top = mVideoView.getTop() + (int)y;

    //mVideoView.layout(left, top, right, bottom);
    RelativeLayout.LayoutParams lp = (LayoutParams) mVideoView.getLayoutParams();
    lp.setMargins(left, top, 0,0);
    mVideoView.setLayoutParams(lp);
    //mVideoView.invalidate();

}
private void scaleVideo(float scale){

    RelativeLayout.LayoutParams lp = (LayoutParams) mVideoView.getLayoutParams();
    lp.width =(int) (mVideoView.getWidth() * scale);
    lp.height = (int) (mVideoView.getHeight() * scale);
    mVideoView.setLayoutParams(lp);
    //mVideoView.invalidate();

} 
```

有时它会移动和缩放视频，但有时 - 只有视频背景，将视频本身留在原处。而且它的工作速度非常慢。

# c# - 在 foreach 条件中捕获异常

> ID：12522870
> 
> 赞同：8
> 
> 时间：2012-09-21T00:42:44.997
> 
> 标签：c#, exception, foreach, try-catch

我有一个`foreach`循环在 foreach 本身的条件下在循环期间中断。有没有办法`try catch`抛出异常然后继续循环的项目？

这将运行几次，直到异常发生然后结束。

```
try {
  foreach(b in bees) { //exception is in this line
     string += b;
  }
} catch {
   //error
} 
```

这根本不会运行，因为异常是在 foreach 的条件下

```
foreach(b in bees) { //exception is in this line
   try {
      string += b;
   } catch {
     //error
   }
} 
```

我知道你们中的一些人会问这是怎么发生的，所以这里是这样的：`PrincipalOperationException`抛出异常，因为在(bees)`Principal`中找不到 a (在我的示例中为 b )。`GroupPrincipal`

**编辑：**我添加了下面的代码。我还发现一个组成员指向一个不再存在的域。我通过删除成员轻松解决了这个问题，但我的问题仍然存在。你如何处理在 foreach 条件下抛出的异常？

```
PrincipalContext ctx = new PrincipalContext(ContextType.domain);
GroupPrincipal gp1 = GroupPrincipal.FindByIdentity(ctx, "gp1");
GroupPrincipal gp2 = GroupPrincipal.FindByIdentity(ctx, "gp2");

var principals = gp1.Members.Union(gp2.Members);

foreach(Principal principal in principals) { //error is here
   //do stuff
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-21T13:48:06.327

与@Guillaume 的答案几乎相同，但“我更喜欢我的”：

```
public static class Extensions
{
    public static IEnumerable<T> TryForEach<T>(this IEnumerable<T> sequence, Action<Exception> handler)
    {
        if (sequence == null)
        {
            throw new ArgumentNullException("sequence");
        }

        if (handler == null)
        {
            throw new ArgumentNullException("handler");
        }

        var mover = sequence.GetEnumerator();
        bool more;
        try
        {
            more = mover.MoveNext();
        }
        catch (Exception e)
        {
            handler(e);
            yield break;
        }

        while (more)
        {
            yield return mover.Current;
            try
            {
                more = mover.MoveNext();
            }
            catch (Exception e)
            {
                handler(e);
                yield break;
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-21T03:54:35.493

也许您可以尝试创建这样的方法：

```
 public IEnumerable<T> TryForEach<T>(IEnumerable<T> list, Action executeCatch)
    {
        if (list == null) { executeCatch(); }
        IEnumerator<T> enumerator = list.GetEnumerator();
        bool success = false;

        do
        {
            try
            {
                success = enumerator.MoveNext();
            }
            catch
            {
                executeCatch();
                success = false;
            }

            if (success)
            {
                T item = enumerator.Current;
                yield return item;
            }
        } while (success);
    } 
```

你可以这样使用它：

```
 foreach (var bee in TryForEach(bees.GetMembers(), () => { Console.WriteLine("Error!"); }))
        {
        } 
```

# php - 了解 sql 错误和自动增量值中的 pdo rollback()

> ID：12522873
> 
> 赞同：3
> 
> 时间：2012-09-21T00:43:07.320
> 
> 标签：php, mysql, pdo

我有个问题...

我使用 pdo 和 beginTransaction() 但我不明白一些事情。

我的 SQL 表有 3 列：id（自动增量）、用户名（唯一）和密码

在我的代码中，我有这个：

```
$pdo->beginTransaction();
$prepared = $pdo->prepare("INSERT INTO (username,password) VALUES(?,?)");
$prepared->$pdo->bindParam(1,"stefan");
$prepared->bindParam(2,"111111");
$prepared->execute();
$count= $prepared->rowCount();

if($count === FALSE):
    $pdo->rollback();
    var_dump($prepared->errorInfo());
else:
    $pdo->commit();
    echo "row count: {$count}";
endif; 
```

当我执行此代码时，一切正常，生成 id=1、username="stefan" 和 password="111111"。

现在，我故意生成一个错误来测试 rollback() 函数。我尝试连续 4 次插入相同的数据，但在 $prepared->errorInfo() 中出现了唯一错误。也可以正常工作。

问题是，当我在这 4 个错误（例如，用户名 =“luv”，密码 =“222222”）之后插入一条新记录时，这条新记录已被插入，但 ID = 6 而不是 ID = 2。

那没问题？rollback() 不应该将自动增量留在最后一个正确的值？我想念什么？

感谢帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T02:13:05.463

当您进行回滚时，自动 inc 值会“烧毁”。这是正常的，也是意料之中的。

参考[这个 stackoverflow 条目](https://stackoverflow.com/a/449360/608781)

# php - 使用 Javascript 消除带有 PHP 功能的“进入”按钮？

> ID：12522876
> 
> 赞同：-4
> 
> 时间：2012-09-21T00:43:37.000
> 
> 标签：php, javascript, onclick

> **可能重复：**
> [JavaScript 字符串换行符？](https://stackoverflow.com/questions/1155678/javascript-string-newline-character)

我对 PHP 和 JS 有点菜鸟，有一个简单的问题。我希望在做出选择后立即显示表格并完全删除输入按钮。

[http://projectrepresentme.com/testpage/](http://projectrepresentme.com/testpage/)

我有一个使用 if 循环生成表的 PHP 脚本。

如何消除 Enter 按钮？

提前致谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T00:55:48.247

HTML

```
<script src="http://code.jquery.com/jquery-latest.min.js"></script>
<script>
$(document).ready(function() {
  $('select').change(function(){
    $('form').submit();
  });
});
<script> 
```

但是更改真实身份或类别的选择器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T00:50:23.113

给按钮一个样式`visibility: hidden`并给表单一个 ID（我将`myForm`在我的示例中用作 ID），然后使用这个 Javascript（假设是 jQuery）：

```
$('#myForm select').change(function(){
    $('#myForm input').css('visibility','visible');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-21T00:56:51.200

我建议使用像[jQuery](http://jquery.com/)这样的 java 脚本库来提供帮助。一旦 jQuery 成为您页面的一部分，您可以添加：

```
$('#formID input').hide(); //hides the "enter" button
$('#formID select').change(function(){ 
  //submits the form when a selection is made
  $('#formID').submit();
}); 
```

# ruby-on-rails - 当数据库在不同的服务器上时安装 postgres gem

> ID：12522878
> 
> 赞同：6
> 
> 时间：2012-09-21T00:43:43.697
> 
> 标签：ruby-on-rails, postgresql, gem, centos, pg

我的数据库与应用程序位于不同的服务器上。当我运行“捆绑”时，出现以下错误：

> 没有 pg_config... 无论如何都在尝试。如果构建失败，请使用 --with-pg-config=/path/to/pg_config 重试

如果应用程序服务器上没有实际安装 pg，如何设置 pg 配置路径？我也试过：

> 捆绑配置 build.pg --without-pg_config

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-21T01:31:32.873

Ruby PostgreSQL 接口（又名 pg gem）只是 PostgreSQL 客户端 C 库的一个瘦包装器。您需要安装 PostgreSQL 客户端库和头文件，否则无法安装 pg gem。你不需要在你的应用服务器上安装完整的 PostgreSQL，只需要客户端开发库，这个包可能被称为“libpg-dev”或“libpq-dev”。

# android - ViewFlipper 不工作

> ID：12522882
> 
> 赞同：0
> 
> 时间：2012-09-21T00:44:06.393
> 
> 标签：android, viewflipper

嗨，我是新的 android 开发人员。我想在 viewFlipper 中显示图像。但它不起作用。这里是 LogCat 文本：

```
09-21 13:27:37.950: W/dalvikvm(5746): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
09-21 13:27:37.970: E/AndroidRuntime(5746): FATAL EXCEPTION: main
09-21 13:27:37.970: E/AndroidRuntime(5746): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.android.iplayer/com.android.iplayer.play}: java.lang.NullPointerException
09-21 13:27:37.970: E/AndroidRuntime(5746):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
09-21 13:27:37.970: E/AndroidRuntime(5746):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
09-21 13:27:37.970: E/AndroidRuntime(5746):     at android.app.ActivityThread.access$2300(ActivityThread.java:125)
09-21 13:27:37.970: E/AndroidRuntime(5746):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
09-21 13:27:37.970: E/AndroidRuntime(5746):     at android.os.Handler.dispatchMessage(Handler.java:99)
09-21 13:27:37.970: E/AndroidRuntime(5746):     at android.os.Looper.loop(Looper.java:123)
09-21 13:27:37.970: E/AndroidRuntime(5746):     at android.app.ActivityThread.main(ActivityThread.java:4627)
09-21 13:27:37.970: E/AndroidRuntime(5746):     at java.lang.reflect.Method.invokeNative(Native Method)
09-21 13:27:37.970: E/AndroidRuntime(5746):     at java.lang.reflect.Method.invoke(Method.java:521)
09-21 13:27:37.970: E/AndroidRuntime(5746):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
09-21 13:27:37.970: E/AndroidRuntime(5746):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
09-21 13:27:37.970: E/AndroidRuntime(5746):     at dalvik.system.NativeStart.main(Native Method)
09-21 13:27:37.970: E/AndroidRuntime(5746): Caused by: java.lang.NullPointerException
09-21 13:27:37.970: E/AndroidRuntime(5746):     at com.android.iplayer.play.matchStringMethod(play.java:92)
09-21 13:27:37.970: E/AndroidRuntime(5746):     at com.android.iplayer.play.onCreate(play.java:43)
09-21 13:27:37.970: E/AndroidRuntime(5746):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
09-21 13:27:37.970: E/AndroidRuntime(5746):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
09-21 13:27:37.970: E/AndroidRuntime(5746):     ... 11 more
09-21 13:27:37.980: W/ActivityManager(59):   Force finishing activity 
```

这是我的代码：

```
flipper.setVisibility(View.VISIBLE);
Bitmap bmp = BitmapFactory.decodeResource(getResources(),R.drawable.sample );
imageView = new ImageView(this);
imageView.setImageBitmap(bmp);
flipper.addView(imageView);
Thread timer = new Thread(){
    public void run(){
        try{
            sleep(3000);
        }catch(InterruptedException e){
            e.printStackTrace();
        }finally{
            currentSequenceIndex++;
            if(sequenceList.size() > currentSequenceIndex){
                matchStringMethod();
            }
        }
    }; timer.start();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T02:15:06.477

```
13:27:37.970: E/AndroidRuntime(5746): Caused by: java.lang.NullPointerException 09-21 13:27:37.970: E/AndroidRuntime(5746): at com.android.iplayer.play.matchStringMethod(play.java:92) 09-21 
```

`matchStringMethod()`在第 92 行，您的方法中有一个空指针异常

# php - PHP 中需要/包含和未定义的变量

> ID：12522884
> 
> 赞同：3
> 
> 时间：2012-09-21T00:44:47.303
> 
> 标签：php, variables, include, require

已解决：该错误与 require 或 include 无关。这与问题完全无关。对于那个很抱歉。:(

到目前为止，我以为我对 require/include 有所了解。我有一个名为的文件`file_one`，它具有类似的内容，`$user_data = return_user_data_as_array()`. 我的第二个文件`file_two`，电话`$user_data`。现在，当我在调用函数和变量后`include 'file_two.php'`进入`file_one`页面时，页面返回`undefined variable user_data`. 我认为如果您在 php 代码中包含/需要一个文件，它会获取原始文件中写入的任何变量？我将如何解决这个问题？

编辑：我还想提一下，虽然我的屏幕上弹出了未定义的变量错误，但“未定义”变量已正确回显。

文件一

```
//this require_once holds the function user_data()

require_once 'core/init.php';

$user_id = 1;

$profile_data = user_data($mysqli, $user_id); 

//this calls file two
require_once 'file_two.php'; 
```

文件二或 file_two.php

```
echo $profile_data['full_name']; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T23:24:21.157

答案与问题中的问题无关。问题中的代码是正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T01:12:39.557

我认为您在页面的其他地方一定有错误。如果您在函数或类之外定义变量，并且在定义后包含使用它的文件，它应该可以正常工作：

**file_one.php**

```
<?php
function return_user_data_as_array(){
    return array('name'=>'BenD');
}

$user_data = return_user_data_as_array();

include('file_two.php');
?> 
```

**file_two.php**

```
<?php
print_r( $user_data );
?> 
```

**结果：**

```
Array
(
    [name] => BenD
) 
```

这应该一切正常。您的错误可能出现在其他地方（例如，您可能在`$user_data`没有指定的情况下从函数内部调用`global $user_data`，或者您不`$user_data`小心调用了 file_one.php 中的某处？）

## 编辑

现在您已经展示了一些代码，我想问题在于`user_data()`没有返回包含`full_name`密钥的数组。试着`print_r($profile_data)`看看数组是什么样子的。我猜问题在于返回的`user_data()`内容（如果有的话！确保它`return $x`在其中包含一个子句！我花了很多时间试图找出一个逻辑错误，而唯一的问题是我的函数没有'不返回任何东西）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-21T00:52:04.707

这里的关键是在函数调用之前而不是之后包含你的内容。也只需包含该函数，然后在文件二中调用它。

# java - 从一个 AJAX 接收多个响应（在不同的时间段）

> ID：12522885
> 
> 赞同：0
> 
> 时间：2012-09-21T00:44:55.143
> 
> 标签：java, javascript, jquery, html, servlets

我正在寻找创建严格基于静态 html 和 AJAX 的接口（这意味着所有服务器端处理都发生在 servlet 内，而不是在初始请求时间或表单中）。

很棒，我喜欢它，但我发现我想让界面更及时地向用户提供有关其请求状态的信息。具体来说，我想让一个请求出去，服务器连续执行多个任务，并在每个任务完成后返回一个响应。

在你问之前，这些连续的任务是相互依赖的。它们都应该按顺序发生。这不是将不同功能的响应浓缩到一个请求中的问题，而是向用户提供实时反馈的问题。整个过程可能需要一分钟，我更愿意在此过程中向用户提供反馈。

我也知道我可以制作一些巨大的解决方案，将进度数据保存到外部源（如 SQL 或文件），并有一个单独的 getProgress() servlet 简单地查询并返回它，但它是如此庞大和不必要，并添加了这么多依赖于一些用户反馈。

是否有任何已知的、优雅的方式来接收单个 AJAX 请求的多个响应？

编辑：澄清措辞

# arrays - arrayfun 可能比 matlab 中的显式循环慢得多。为什么？

> ID：12522888
> 
> 赞同：106
> 
> 时间：2012-09-21T00:45:14.910
> 
> 标签：arrays, performance, matlab

考虑以下简单的速度测试`arrayfun`：

```
T = 4000;
N = 500;
x = randn(T, N);
Func1 = @(a) (3*a^2 + 2*a - 1);

tic
Soln1 = ones(T, N);
for t = 1:T
    for n = 1:N
        Soln1(t, n) = Func1(x(t, n));
    end
end
toc

tic
Soln2 = arrayfun(Func1, x);
toc 
```

在我的机器上（Linux Mint 12 上的 Matlab 2011b），这个测试的输出是：

```
Elapsed time is 1.020689 seconds.
Elapsed time is 9.248388 seconds. 
```

什么？！？`arrayfun`，虽然公认的解决方案看起来更干净，但速度要慢一个数量级。这里发生了什么？

此外，我做了类似的测试`cellfun`，发现它比显式循环慢 3 倍。同样，这个结果与我的预期相反。

**我的问题是：**`arrayfun`为什么这么`cellfun`慢？鉴于此，是否有充分的理由使用它们（除了让代码看起来不错）？

**注意：**我说的是`arrayfun`这里的标准版本，而不是并行处理工具箱中的 GPU 版本。

**编辑：**为了清楚起见，我知道`Func1`上面可以矢量化，正如 Oli 所指出的那样。我之所以选择它，是因为它为实际问题提供了一个简单的速度测试。

**编辑：**按照 grunetta 的建议，我重新做了测试`feature accel off`。结果是：

```
Elapsed time is 28.183422 seconds.
Elapsed time is 23.525251 seconds. 
```

换句话说，似乎很大一部分差异在于 JIT 加速器在加速显式`for`循环方面做得比它做得更好`arrayfun`。这对我来说似乎很奇怪，因为`arrayfun`实际上提供了更多信息，即它的使用表明调用的顺序`Func1`无关紧要。另外，我注意到无论 JIT 加速器是打开还是关闭，我的系统都只使用一个 CPU...

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2012-09-21T08:33:59.010

您可以通过运行其他版本的代码来获得这个想法。考虑明确写出计算，而不是在循环中使用函数

```
tic
Soln3 = ones(T, N);
for t = 1:T
    for n = 1:N
        Soln3(t, n) = 3*x(t, n)^2 + 2*x(t, n) - 1;
    end
end
toc 
```

在我的电脑上计算的时间：

```
Soln1  1.158446 seconds.
Soln2  10.392475 seconds.
Soln3  0.239023 seconds.
Oli    0.010672 seconds. 
```

现在，虽然完全“矢量化”的解决方案显然是最快的，但您可以看到为每个 x 条目定义一个要调用的函数是一个**巨大**的开销。只是明确地写出计算让我们加速了 5 倍。我猜这表明 MATLABs JIT 编译器[不支持内联函数](https://stackoverflow.com/questions/5275140/is-there-a-way-to-perform-function-inlining-in-matlab)。根据那里的gnovice的回答，实际上最好写一个普通函数而不是匿名函数。试试看。

下一步 - 删除（矢量化）内部循环：

```
tic
Soln4 = ones(T, N);
for t = 1:T
    Soln4(t, :) = 3*x(t, :).^2 + 2*x(t, :) - 1;
end
toc

Soln4  0.053926 seconds. 
```

另一个因素 5 加速：这些语句中有一些东西说你应该避免在 MATLAB 中出现循环......或者真的有吗？那就看看这个

```
tic
Soln5 = ones(T, N);
for n = 1:N
    Soln5(:, n) = 3*x(:, n).^2 + 2*x(:, n) - 1;
end
toc

Soln5   0.013875 seconds. 
```

更接近“完全”矢量化版本。Matlab 按列存储矩阵。您应该始终（如果可能）将您的计算构造为“按列”矢量化。

我们现在可以回到Soln3。那里的循环顺序是“逐行”的。让我们改变它

```
tic
Soln6 = ones(T, N);
for n = 1:N
    for t = 1:T
        Soln6(t, n) = 3*x(t, n)^2 + 2*x(t, n) - 1;
    end
end
toc

Soln6  0.201661 seconds. 
```

更好，但仍然非常糟糕。单循环 - 好。双循环 - 不好。我猜 MATLAB 在提高循环性能方面做了一些不错的工作，但循环开销仍然存在。如果你在里面有一些更重的工作，你不会注意到的。但由于此计算受内存带宽限制，您确实会看到循环开销。你**会**更清楚地看到在那里调用 Func1 的开销。

那么arrayfun怎么了？那里也没有内联函数，所以开销很大。但是为什么比双嵌套循环差那么多呢？实际上，使用 cellfun/arrayfun 的话题已经被广泛讨论过很多次（例如[这里](http://www.mathworks.com/matlabcentral/newsreader/view_thread/304894)、[这里](http://www.mathworks.com/matlabcentral/newsreader/view_thread/253815)、[这里](http://www.mathworks.com/matlabcentral/newsreader/view_thread/253596)和[这里](http://www.mathworks.com/matlabcentral/newsreader/view_thread/251700)）。这些函数很慢，您不能将它们用于如此细粒度的计算。您可以使用它们来简化代码以及在单元格和数组之间进行花哨的转换。但是函数需要比你写的更重：

```
tic
Soln7 = arrayfun(@(a)(3*x(:,a).^2 + 2*x(:,a) - 1), 1:N, 'UniformOutput', false);
toc

Soln7  0.016786 seconds. 
```

请注意，Soln7 现在是一个单元格.. 有时这很有用。代码性能现在已经相当不错了，如果你需要单元格作为输出，在你使用完全向量化的解决方案之后，你不需要转换你的矩阵。

那么为什么 arrayfun 比简单的循环结构慢呢？不幸的是，我们不可能肯定地说，因为没有可用的源代码。你只能猜测，由于arrayfun是一个通用的函数，它处理各种不同的数据结构和参数，在简单的情况下不一定很快，你可以直接表示为循环嵌套。我们无法知道开销从何而来。是否可以通过更好的实现来避免开销？也许不吧。但不幸的是，我们唯一能做的就是研究性能以确定哪些情况下效果很好，哪些情况下效果不好。

**更新**由于此测试的执行时间很短，为了获得可靠的结果，我现在添加了一个围绕测试的循环：

```
for i=1:1000
   % compute
end 
```

下面给出了一些时间：

```
Soln5   8.192912 seconds.
Soln7  13.419675 seconds.
Oli     8.089113 seconds. 
```

您会看到 arrayfun 仍然很糟糕，但至少不比矢量化解决方案差三个数量级。另一方面，具有按列计算的单个循环与完全矢量化版本一样快……这一切都是在单个 CPU 上完成的。如果我切换到 2 个内核，Soln5 和 Soln7 的结果不会改变 - 在 Soln5 中，我必须使用 parfor 来使其并行化。忘记加速... Soln7 不并行运行，因为 arrayfun 不并行运行。另一方面，Olis 矢量化版本：

```
Oli  5.508085 seconds. 
```

* * *

## 回答 #2

> 赞同：-8
> 
> 时间：2014-08-12T10:39:41.030

那是因为！！！！

```
x = randn(T, N); 
```

不是`gpuarray`类型；

你需要做的就是

```
x = randn(T, N,'gpuArray'); 
```

# nservicebus - IFindSagas 具有 Raven saga 持久性和 NServiceBus 中的多个属性

> ID：12522889
> 
> 赞同：1
> 
> 时间：2012-09-21T00:45:19.060
> 
> 标签：nservicebus, saga

我正在使用 Raven 来持久`IFindSagas`化 saga 并且我想实现，我需要根据 2 个属性找到 saga，`SiteId`因此`EmailAddress`无法`ConfigureMapping`正常工作。该`ISagaPersister`界面仅允许您通过单个属性查找单个 saga。

我已经实现了这样的传奇查找器

```
public class MySagaFinder : IFindSagas<MySagaData>.Using<ISomeMessage>
{
    public ISagaPersister Persister { get; set; }

    public MySagaData FindBy(ISomeMessage message)
    {
        var lookup = string.Format("{0}__{1}", message.SiteId, message.EmailAddress);
        return Persister.Get<MySagaData>("SagaLookup", lookup);
    }
} 
```

所以基本上我在 call 上添加了一个属性，`MySagaData`它`SagaLookup`是`SiteId`and的串联`EmailAddress`。然后我可以通过这个查找它。这感觉就像一个黑客。有什么方法可以使用 saga 持久化器，我可以通过多个属性获取一个 saga，或者根据一个属性获取一个 saga 列表，然后我可以通过另一个属性进行过滤？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T02:32:34.877

IMO 最好通过单个“键”属性进行查找，因为这样您就不需要实现自定义持久性。连接站点 ID 和电子邮件地址可能看起来像一个 hack，但如果你认为这是定义特定 saga 的 ID，那么它是有道理的。传奇数据不是您的领域模型的一部分，它是具有特定要求的基础设施的一部分。但是，您应该考虑这个 saga ID 的定义是否足够唯一。例如，同一站点 ID 中的同一用户的两个 saga 是否有可能同时执行？

# javascript - 如何将 Flash 嵌入转换为 html5？

> ID：12522893
> 
> 赞同：2
> 
> 时间：2012-09-21T00:46:10.730
> 
> 标签：javascript, html, cordova, jquery-mobile, jwplayer

`Link`下面的 RTMP 直播流在哪里`Embed`，我如何测试链接并查看它是否正常工作

![在此处输入图像描述](../Images/9725ffe7dc51dda145590706542eccb3.png)

我以为可能是这样，但不确定

```
 rtmp://sc-lb1.streamcyclone.com/rakoty_live 
```

因为我正在播放这个流`jwplayer`，它一直在告诉我

```
stream not found :rtmp://-------------------- 
```

到目前为止，这是我的代码和[现场演示](http://jsfiddle.net/minagabriel/u92Az/1/)

```
 <div id="container2">Loading the player...</div>
       <script type="text/javascript">
             jwplayer("container2").setup({
             flashplayer: "http://player.longtailvideo.com/player.swf",
             height: 270,
             width: 480,
             image: "http://www.2heartsnetwork.org/SacredHeartJesus3.jpg",
             levels: [
{ bitrate: 300, file: "rtmp://sc-lb1.streamcyclone.com/rakoty_live", width: 320 },
{ bitrate: 600, file: "rtmp://sc-lb1.streamcyclone.com/rakoty_live", width: 480 },
{ bitrate: 900, file: "rtmp://sc-lb1.streamcyclone.com/rakoty_live", width: 720 }
                 ],
             provider: "rtmp",
         streamer: "rtmp://sc-lb1.streamcyclone.com/rakoty_live"
      });
       </script> 
```

有问题希望大家能帮帮我谢谢

**回答**

如果没有第三方对您的流进行转码，就无法做到这一点

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T08:05:50.360

如前所述[，](https://serverfault.com/questions/270634/how-can-i-verify-that-an-rtmp-stream-url-is-working)您可以使用[rtmpdump](http://rtmpdump.mplayerhq.hu/)来测试 rtmp 连接。

* * *

摆弄你分享的内容，我可以通过设置获得你的直播：

```
file : "rakoty" 
```

[这](http://jsfiddle.net/u92Az/3/)是正在运行的小提琴。

* * *

我还想建议不要编辑您的帖子并在回答时删除原始问题，而是发布一个新问题。也许早期的问题可能对将来的某人有所帮助......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T07:42:15.437

你有流媒体：rtmp://sc-lb1.streamcyclone.com/rakoty_live 文件：rakoty

rtmpdump -o a.flv -r rtmp://sc-lb1.streamcyclone.com/rakoty_live/rakoty

# c# - 如何替换字符串中的单词

> ID：12522896
> 
> 赞同：2
> 
> 时间：2012-09-21T00:46:41.743
> 
> 标签：c#, string, replace

这是一个非常基本的问题，但我不确定为什么它不起作用。我有代码，其中“和”可以用“和”、“和”等任何方式编写，我想用“，”替换它

我试过这个：

```
and.Replace("and".ToUpper(),","); 
```

但这不起作用，还有其他方法可以做到这一点或使它起作用吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-21T00:50:34.300

你应该看看 Regex 类

[http://msdn.microsoft.com/en-us/library/xwewhkd1.aspx](http://msdn.microsoft.com/en-us/library/xwewhkd1.aspx)

```
using System.Text.RegularExpressions;

Regex re = new Regex("\band\b", RegexOptions.IgnoreCase);

string and = "This is my input string with and string in between.";

re.Replace(and, ","); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-21T01:14:51.490

我想你应该小心一些词是否包含`and`，说`"this is sand and sea"`。“沙子”这个词一定不能受到替换的影响。

```
string and = "this is sand and sea";

//here you should probably add those delimiters that may occur near your "and"
//this substitution is not universal and will omit smth like this " and, " 
string[] delimiters = new string[] { " " }; 

//it result in: "this is sand , sea"
and = string.Join(" ", 
                  and.Split(delimiters,  
                            StringSplitOptions.RemoveEmptyEntries)
                     .Select(s => s.Length == 3 && s.ToUpper().Equals("AND") 
                                     ? "," 
                                     : s)); 
```

我也会像这样添加：

```
and = and.Replace(" , ", ", "); 
```

所以，输出：

```
this is sand, sea 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-21T00:51:47.357

```
words = words.Replace("AND", ",")
             .Replace("and", ","); 
```

或者使用正则表达式。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-21T00:54:47.757

该`Replace`方法返回一个替换可见的字符串。它不会**修改**原始字符串。你应该尝试一些类似的东西

```
and = and.Replace("and",","); 
```

您可以为您可能遇到的所有“和”变体执行此操作，或者正如其他答案所建议的那样，您可以使用正则表达式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-21T00:56:19.017

尝试这种方式使用静态`Regex.Replace()`方法：

```
and = System.Text.RegularExpressions.Regex.Replace(and,"(?i)and",","); 
```

"(?i)" 导致以下文本搜索不区分大小写。

[http://msdn.microsoft.com/en-us/library/yd1hzczs.aspx](http://msdn.microsoft.com/en-us/library/yd1hzczs.aspx)

[http://msdn.microsoft.com/en-us/library/xwewhkd1(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/xwewhkd1(v=vs.100).aspx)

# common-lisp - 为什么局部变量没有被释放？

> ID：12522897
> 
> 赞同：1
> 
> 时间：2012-09-21T00:46:50.730
> 
> 标签：common-lisp, ecl

测试功能如下：

```
(defun fab (n) 
    (let ((res '(1 1)))
        (loop for i from 2 to n do
            (nconc res (list (+ (nth (- i 2) res) (nth (- i 1) res)))))
        res)) 
```

$ecl

... EECL（嵌入式 Common-Lisp）12.7.1（git：未知）

...

```
>(fab 10)
(1 1 2 3 5 8 13 21 34 55 89)
>(fab 20)
(1 1 2 3 5 8 13 21 34 55 89 2 3 5 8 13 21 34 55 89 144 91 5 8 13 21 34 55 89 144 
```

然后我重新启动 ECL

```
>(fab 20)
(1 1 2 3 5 8 13 21 34 55 89 144 233 377 610 987 1597 2584 4181 6765 10946) 
```

似乎在 (fac 10) 之后没有释放“res”？

真挚地！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-21T01:21:24.470

您应该使用`(list 1 1)`而不是`'(1 1)`在`let`表单中。在 Common Lisp 中，没有定义修改文字对象的效果。

```
(defun fib (n)
  (let ((res (list 1 1))) ; (list 1 1) instead of '(1 1)
    (loop for i from 2 to n
          do (nconc res (list (+ (nth (- i 2) res) (nth (- i 1) res)))))
    res)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T14:19:43.217

'(1 1) 等常量仅由编译器/解释器分配一次。您的代码在此列表中使用 NCONC，进行修改后，后续调用不再看到常量列表 '(1 1)，而是看到修改后的列表。在 Common Lisp 中，未指定当对常量表达式进行破坏性修改时会发生什么，并且一些实现甚至保护它们免受更改以避免此类意外。如果您需要一个全新的常量，请按照人们所说的使用（列表 1 1）或完全避免使用 NCONC。

# objective-c - 如何使用 drawAtPoint() 覆盖 UIImage？

> ID：12522899
> 
> 赞同：0
> 
> 时间：2012-09-21T00:47:04.240
> 
> 标签：objective-c, uiimage

以下代码在图像上绘制一些文本：

```
UIGraphicsBeginImageContext(image.size);
[image drawAtPoint:CGPointZero];

NSString *stamp = @"Internal Use Only";
[stamp drawAtPoint:CGPointMake(10, 10) withFont:[UIFont systemFontOfSize:32]];

UIImage *stampedImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

如果使用不同的字符串再次执行代码，则两个字符串会合并且不清晰。我怎样才能使这个 drawAtPoint() 覆盖以前的字符串？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T02:18:39.430

我能够通过渲染 UITextView 来完成这项工作。这些知道如何通过他们的 layer 属性来绘制自己，并且可以显示多条线（额外的好处！）：

```
CGContextRef context = UIGraphicsGetCurrentContext();
NSString *stamp = @"Internal Use Only";
CGRect frame = CGRectMake(0, 0, 120, 80);
textview.frame = frame;
textview.text = stamp;
textview.font = [UIFont systemFontOfSize:32];
[textview.layer renderInContext:context]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T00:53:13.207

每次要在其上绘制文本时，都必须复制原始图像。换句话说，您必须保留图像的原始版本。

# objective-c - ios 6 中的 UITabBarController 旋转问题

> ID：12522903
> 
> 赞同：16
> 
> 时间：2012-09-21T00:47:32.200
> 
> 标签：objective-c, rotation, uitabbarcontroller, ios6

确认！我终于在 iOS 5 中解决了我的标签栏旋转问题，但 iOS 6 和 xcode 似乎有问题......这就是我所拥有的：

目标应用摘要包括：支持的界面方向 - 纵向、左侧横向、右侧横向

App 中的每个 Single View 都有以下方法：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
    return ((interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown) &&
            (interfaceOrientation != UIInterfaceOrientationLandscapeLeft) &&
            (interfaceOrientation != UIInterfaceOrientationLandscapeRight));
} else {
    return YES;
}
}

- (BOOL)shouldAutorotate
{
NSLog(@"am I called1?");
return NO;
}

-(NSUInteger)supportedInterfaceOrientations{
   NSLog(@"am I called?");
   return UIInterfaceOrientationMaskPortrait;
} 
```

在不属于选项卡栏的视图中，旋转被阻止。在标签栏的所有视图（有 5 个）中，应用程序从不调用 ShouldAutorotate 并因此旋转。似乎supportedInterfaceOrientations 在视图加载时被调用一次，但在我在视图之间切换时不会出现，因为我得到了NSLog，但它似乎忽略了MaskPortrait 设置。

我必须在目标中启用景观，因为我有一个需要旋转的视频播放器视图（它这样做，很好）

这是 iOS 6 中的标签栏错误吗？我是否需要以不同的方式禁用视图的旋转？shouldautorotatetointerfaceorientation 在 ios 5 中效果很好

我已经有一段时间了

谢谢，扎克

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-09-21T07:37:52.623

扎克，我遇到了同样的问题。这是因为您将 viewController 嵌入到 TabBar 控制器或 UINavigationController 中，并且对这些方法的调用发生在这些方法中，而不是您的普通视图（在 iOS6 中更改）。

我遇到了这个问题，因为我在所有具有导航到不同视图（注册过程、登录等）的模态视图上都展示了一个嵌入 UINavigationController 的 viewController。

我的简单解决方法是为包含这两种方法的 UINavigationController 创建一个 CATEGORY。我有 shouldAutorotate 无论如何都返回 NO，因为我不希望我的模态视图旋转。你的修复可能就是这么简单，试一试。希望能帮助到你。

我创建了一个类别并将其命名为 autoRotate 并选择了 UINavigationController 选项。M+H 文件如下。

```
#import "UINavigationController+autoRotate.h"

@implementation UINavigationController (autoRotate)

-(BOOL)shouldAutorotate {
    return NO;
}

- (NSUInteger)supportedInterfaceOrientations {
    return UIInterfaceOrientationMaskPortrait;
}

@end 
```

...和类别.h：

```
#import <UIKit/UIKit.h>

@interface UINavigationController (autoRotate)

-(BOOL)shouldAutorotate;
- (NSUInteger)supportedInterfaceOrientations;

@end 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-31T22:05:43.670

如果您像我一样有一个标签栏，您唯一需要做的就是将以下内容添加到您的委托 .m 文件中，

```
#import "AppDelegate.h"

//UITabBarController category to set the view rotations for ios 6
@implementation UITabBarController (Background)

-(BOOL)shouldAutorotate
{
    //I don't want to support auto rotate, but you can return any value you want here
    return NO;
}

- (NSUInteger)supportedInterfaceOrientations {
    //I want to only support portrait mode
    return UIInterfaceOrientationMaskPortrait;
}

@end

/////here starts the implementation of the app delegate which is gonna be whatever you currently have on your .m delegate

@implementation AppDelegate

// delegate methods and other stuff

@end 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-09-25T21:33:54.130

我还有一个问题，我需要一些视图来旋转，而另一些视图不需要几个导航控制器。我通过告诉 NavigationController 查看视图控制器来做到这一点。这就是我所做的。

我创建了一个名为 RootNavigationController 的 UINavigationController 类，并将该类指定为故事板中导航控制器的自定义类。在 RootNavigationController.m 我添加了以下方法；

```
- (BOOL)shouldAutorotate {

    return [self.visibleViewController shouldAutorotate];
}

- (NSUInteger)supportedInterfaceOrientations {
    return [self.visibleViewController supportedInterfaceOrientations];    
} 
```

在每个视图控制器 .m 文件中，我还添加了以下方法。

```
- (BOOL)shouldAutorotate {
    //return yes or no
}

- (NSUInteger)supportedInterfaceOrientations{
    //return supported orientation masks
} 
```

这样做可以让我在其视图控制器中为每个视图设置方向。

无论如何都为我工作......</p>

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-06-18T06:22:16.020

**我的情况是：**

*   UITabBarController 有 2 项： 2 导航控制器
*   UINavigationController1 withRootView: ViewController1
*   UINavigationController2 withRootView：ViewController2。
*   现在我想要 ViewController1 设置 shouldAutorotate:NO/maskPortrait 和 ViewController2 设置 shouldAutorotate/MaskAll。

**所以我的实现：**创建 UITabBarController 类别和 UINavigationCntroller 类别，如

**UITabBarController+autoRotate.h**

```
@interface UITabBarController (autoRotate)

-(BOOL)shouldAutorotate;
- (NSUInteger)supportedInterfaceOrientations;

@end 
```

**UITabBarController+autoRotate.m**

```
#import "UITabBarController+autoRotate.h"

@implementation UITabBarController (autoRotate)

- (BOOL)shouldAutorotate {
    return [self.selectedViewController shouldAutorotate];
}
- (NSUInteger)supportedInterfaceOrientations {
    return [self.selectedViewController supportedInterfaceOrientations];
}

@end 
```

**UINavigationController+autoRotate.h**

```
@interface UINavigationController (autoRotate)

-(BOOL)shouldAutorotate;
- (NSUInteger)supportedInterfaceOrientations;

@end 
```

**UINavigationController+autoRotate.m**

```
@implementation UINavigationController (autoRotate)

- (BOOL)shouldAutorotate {
    return [self.visibleViewController shouldAutorotate];
}

- (NSUInteger)supportedInterfaceOrientations {
    return [self.visibleViewController supportedInterfaceOrientations];
}

@end 
```

**UIViewController1.m**

```
- (BOOL)shouldAutorotate {
    return NO;
}
- (NSUInteger)supportedInterfaceOrientations {
   return UIInterfaceOrientationMaskPortrait;;
} 
```

**UIViewController2.m**

```
- (BOOL)shouldAutorotate {
   return YES;
}
- (NSUInteger)supportedInterfaceOrientations {
   return UIInterfaceOrientationMaskAll;
} 
```

它就像一个魅力！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-13T21:52:58.527

在我的例子中，我有一个嵌入在 UITabBarController 中的导航控制器，并且有效的是创建了一个类似于 Kunani 定义的类别，但扩展了 UITabBarController 而不是 UINavigationController。它就像一个魅力:)

```
#import "UINavigationController+autoRotate.h"

@implementation UINavigationController (autoRotate)

-(BOOL)shouldAutorotate {
    return NO;
}

- (NSUInteger)supportedInterfaceOrientations {
    return UIInterfaceOrientationMaskPortrait;
}

@end 
```

和 .h 文件：

```
#import <UIKit/UIKit.h>

@interface UINavigationController (autoRotate)

-(BOOL)shouldAutorotate;
- (NSUInteger)supportedInterfaceOrientations;

@end 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-12-11T11:48:02.830

这将在 Swift 中完成

```
extension UITabBarController {
    public override func shouldAutorotate() -> Bool {
        if let selected = self.selectedViewController {
            return selected.shouldAutorotate()
        } else {
            return false
        }
    }

    public override func supportedInterfaceOrientations() -> Int {
        if let selected = self.selectedViewController {
            return selected.supportedInterfaceOrientations()
        } else {
            return Int(UIInterfaceOrientationMask.Portrait.rawValue)
        }
    }
}

extension UINavigationController {
    public override func shouldAutorotate() -> Bool {
        return self.visibleViewController.shouldAutorotate()
    }

    public override func supportedInterfaceOrientations() -> Int {
        return self.visibleViewController.supportedInterfaceOrientations()
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-06-03T23:28:12.250

[https://stackoverflow.com/a/30632505/2298002](https://stackoverflow.com/a/30632505/2298002)

处理这种情况时会出现很多模棱两可或无法预料的结果，尤其是在仅维护特定视图控制器的方向而不影响应用程序的其余部分时。这个算法似乎为我提供了一切

[https://stackoverflow.com/a/30632505/2298002](https://stackoverflow.com/a/30632505/2298002)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-06-18T07:36:41.423

您应该在 中添加这个东西`UIViewController1.m`以确保重建以前的方向状态：

```
 (void)viewDidAppear:(BOOL)animated 
{

    [[UIDevice currentDevice] performSelector:NSSelectorFromString(@"setOrientation:") 
    withObject:(id)UIInterfaceOrientationPortrait];
} 
```

完美的！

# zsh - zsh完成函数参数描述中的方括号，可能吗？

> ID：12522905
> 
> 赞同：2
> 
> 时间：2012-09-21T00:48:05.483
> 
> 标签：zsh, zsh-completion

基本上，我想知道是否可以这样做：

```
#compdef foo
_arguments \
    '--arg=[Description of --arg [With square brackets in the string!]]' \ 
```

没有得到`invalid option error`由于嵌套的方括号？

我尝试了各种转义字符。单引号和双引号没有区别。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T07:40:42.763

尝试像这样逃避它们：

```
'--arg=\\[Description of --arg \\[With square brackets in the string!\\]\\]' 
```

# regex - Perl 正则表达式搜索和替换为 $variable->function("args")

> ID：12522906
> 
> 赞同：0
> 
> 时间：2012-09-21T00:48:08.743
> 
> 标签：regex, string, perl

基本上我试图用从对象的函数调用返回的任何内容替换。但我需要正则表达式搜索的返回值作为参数。这有点棘手，但代码应该不言自明：

```
while ( $token =~ s/\$P\(([a-z0-9A-Z_]+)\)/$db->getValue("params", qw($1))/e ) { } 
```

我得到的错误是 $1 没有被评估为任何东西（参数实际上变成了“$1”），所以它搞砸了我的 getValue() 方法。

干杯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-21T00:58:57.003

函数引用“`qw()`单词”。即它在所有空白字符处拆分一个字符串并返回该列表。它*不*插值。

您可以“按原样”使用变量：

```
s/\$P\(([a-z0-9A-Z_]+)\)/$db->getValue("params", $1)/e 
```

`qw()`功能很不一样

*   `q(abc)` (<=> `'abc'`),
*   `qq(abc)`(<=> `"abc"`), 和
*   `qx(abc)`(<=> ``abc``) 或
*   `qr(abc)`(<=> `m/abc/`):

`qw(a b c)`<=>`('a', 'b', 'c')`

# data-binding - 使 JFace 数据绑定重新验证

> ID：12522910
> 
> 赞同：1
> 
> 时间：2012-09-21T00:48:24.430
> 
> 标签：data-binding, swt, eclipse-rcp, jface

我有一个用于在远程系统上输入多个路径的对话框。我使用数据绑定将这些路径存储在我的模型中。我的数据记录附加了具有共同特征的验证器 - 当没有连接到远程系统时跳过验证。我在同一个对话框上有一个按钮来连接到远程系统，并且我有跟踪连接状态的 IObservableValue。

当连接状态发生变化时，如何使相关绑定重新验证？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T20:02:08.377

在跟踪连接状态的 IObservableValue 上添加 valuechangeListener。一旦连接状态发生变化，调用下面的方法来验证路径绑定。这可能有助于找到您正在寻找的东西

```
Binding class
public abstract void validateTargetToModel();
public abstract void validateModelToTarget(); 
```

# php - Paypal 的令牌 ID 是唯一的吗？

> ID：12522912
> 
> 赞同：8
> 
> 时间：2012-09-21T00:48:40.403
> 
> 标签：php, paypal

`Token ID`它返回的贝宝（即：）`EC-XXXXXXXXXXXXXXXXX`总是唯一的吗？我怀疑会是这样吗？但我正在做的是我将它插入到我的事务表中以验证该事务是否已被处理。

我知道 Transaction ID 也可以工作，但问题是在使用 PayPal API 方法（例如`GetExpressCheckoutDetails`or ）之前首先返回 Token ID `DoExpressCheckout`。

请根据您自己的经验告诉我您认为最好的方法。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-21T01:23:28.667

Token 是唯一的，但它只代表会话，这就是它首先返回的原因。它根本不表示一个完整的交易，你不应该为此目的存储它。无论如何，我不建议将其存储以备将来使用，因为 PayPal 不使用它来识别退款交易等（我至少见过）。

我建议您只使用 Token 来管理来自 的实际结帐流程`SetExpressCheckout -> GetExpressCheckoutDetails -> DoExpressCheckoutPayment`，然后将返回的 TransactionID 存储`DoExpressCheckoutPayment`为您的“交易完成”指标。您可能也应该检查`PaymentStatus`退货，因为电子支票不会立即将钱存入您的帐户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T00:52:44.097

交易 ID 对于交易是唯一的。令牌 ID 是为检查交易 ID 是否正确而创建的数字。

# self-signed - 自签名代码签名证书会摆脱“未知发布者”警告吗？

> ID：12522917
> 
> 赞同：3
> 
> 时间：2012-09-21T00:49:30.760
> 
> 标签：self-signed, code-signing-certificate, security-warning

自签名代码签名证书会摆脱“未知发布者”警告吗？

使用自签名证书对警告有什么影响？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T01:45:02.423

使用自签名证书时，您仍然会收到诸如不受信任的签名机构之类的警告。您通常只需在自己的服务器上进行自签名以测试 SSL。您不想在生产服务器上自签名 SSL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T20:18:54.150

不，自签名对此不起作用。您必须从真正的 Ca 获得代码签名证书，请参阅[http://codesigning.ksoftware.net](http://codesigning.ksoftware.net)或[http://www.verisign.com](http://www.verisign.com)（还有更多）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-10-14T09:22:28.700

这对我有用。对于本地测试，是的，这是可能的。

1.  右键单击安装程序并转到*Properties*。
2.  单击“*数字签名”*选项卡。
3.  在*签名列表*下选择签名者并单击*详细信息*
4.  点击*查看证书*
5.  单击*Install Certificate...*，然后单击*Next >*
6.  选择*将所有证书放入以下存储*单选按钮
7.  单击*浏览*并选择*受信任的根证书颁发机构*
8.  单击确定并单击*下一步 >*，然后单击*完成*。
9.  将出现一个安全警告，通知您这样做需要您自担风险。

如果要删除此证书，可以转到 certmgr.msc 并删除位于受**信任的根证书颁发机构下的证书**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-13T11:11:04.743

如果您将自签名证书安装到根证书颁发机构存储中，您将不会收到“未知发布者”警告。

# c# - 使用 C# 和 RESTSharp 在盒子上创建文件夹

> ID：12522918
> 
> 赞同：0
> 
> 时间：2012-09-21T00:49:40.527
> 
> 标签：c#, box-api, restsharp

我正在尝试使用`RESTSharp`在 Box 上创建一个简单的文件夹，但我遇到了困难。我不断收到此错误：

> {"type":"error","status":400,"code":"bad_request","help_url":"http://developers.box.com/docs/#errors","message":"可以不解析 JSON","re​​quest_id":"1474540366505ba7a11bdcd"}

这是我的代码：

```
static string box(string resourceURL, string APIKey, string authToken)
        {
            RestClient client = new RestClient();
            client.BaseUrl = "https://api.box.com/2.0";
            var request = new RestRequest(Method.POST);
            request.Resource = resourceURL;
            string Headers = string.Format("Authorization: BoxAuth api_key={0}&auth_token={1}", APIKey, authToken);
            request.AddHeader("Authorization", Headers);
            request.AddParameter("name", "TestFolder");

            // request.RequestFormat = DataFormat.Json;
            var response = client.Execute(request);
            return response.Content;
        } 
```

我错过了什么？在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T02:47:12.270

您可能还想查看最近创建的 github 存储库，其中一些人正在协作开发 C# Box SDK。 [https://github.com/jhoerr/box-csharp-sdk-v2](https://github.com/jhoerr/box-csharp-sdk-v2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T02:43:13.010

我看到两个问题：

*   URL需要指向/folder/{folder_id}（0是根文件夹的id）
*   文件夹名称需要在请求的json正文中，而不是查询参数

我对 C# 或 RESTSharp 不太熟悉，但我相信这段代码应该可以解决这两个问题。

```
static string box(string APIKey, string authToken)
            {
                RestClient client = new RestClient();
                client.BaseUrl = "https://api.box.com/2.0";
                var request = new RestRequest(Method.POST);
                request.Resource = "/folders/0";
                string Headers = string.Format("BoxAuth api_key={0}&auth_token={1}", APIKey, authToken);
                request.AddHeader("Authorization", Headers);
                request.AddParameter("text/json", "{\"name\" : \"TestFolderName\"}", ParameterType.RequestBody);

                //request.RequestFormat = DataFormat.Json;
                var response = client.Execute(request);
                return response.Content;
            } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-21T18:17:48.950

感谢您的帮助，这是最终起作用的确切代码。

```
static string box(string APIKey, string authToken)
            {
                RestClient client = new RestClient();
                client.BaseUrl = "https://api.box.com/2.0";
                var request = new RestRequest(Method.POST);
                request.Resource = "/folders/0";
                string Headers = string.Format("BoxAuth api_key={0}&auth_token={1}", APIKey, authToken);
                request.AddHeader("Authorization", Headers);
                request.AddParameter("text/json", "{\"name\" : \"TestFolderName\"}", ParameterType.RequestBody);

                //request.RequestFormat = DataFormat.Json;
                var response = client.Execute(request);
                return response.Content;
            } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-25T12:56:39.093

静态字符串文件夹创建（字符串 APIKey，字符串 authToken）{

```
 RestClient client = new RestClient();
    client.BaseUrl = "https://api.box.com/2.0/folders";
    var request = new RestRequest(Method.POST);
    string Headers = string.Format("Bearer {0}", authToken);
    request.AddHeader("Authorization", Headers);
    request.AddParameter("application/json", "{\"name\":\"Youka\",\"parent\":{\"id\":\"0\"}}", ParameterType.RequestBody);
    var response = client.Execute(request);
    return response.Content;

} 
```

# c++ - MS VisC++ 2010 express：突然项目不再看到头文件

> ID：12522921
> 
> 赞同：2
> 
> 时间：2012-09-21T00:49:58.853
> 
> 标签：c++, visual-studio-2010, visual-c++

这可能很难解释。我已经在 MS VisC++ 2010 express 中开发了一个程序大约一个月了。我没有遇到任何奇怪的问题，并且准备第 100 次构建我的项目时，突然间，许多`.cpp`文件似乎与`.h`文件失去了联系。例如，在 main 函数中，我几周前创建和使用的对象突然出现在它们下面的红线和语法错误“ `theClass is undefined`”。这适用于`iostream`，所以突然`cout`是未定义的。我不知道发生了什么。所有的外部头文件和库一秒一秒地突然消失在 IDE 眼中。在`.cpp`文件中，当我声明`class constructor`

```
//initializes a poker game
aPokerGame::aPokerGame(void)
{
    stopPlaying = 'n';          
} 
```

我得到类名下的行`aPokerGame`，这个错误是“ `must be a class or a namespace name`”。`.h`如果文件消失，这不是会发生什么吗？事实上，并不是所有`.cpp`的文件都有这个问题，只有一些。其他人在其中有非常奇怪的错误，例如“类不存在默认构造函数`std::basic_ostream<wchar...`”。所有这些错误同时出现。

头文件看起来不错。虽然其中一个在私人成员`Error: expected a declaration`的“”标题下有“ ”。`Private:`

请帮忙！

以下是编译错误的示例：

> 1>----- 构建开始：项目：firstProj，配置：Debug Win32 ------ 1> userPlayer.cpp 1>c:\users\bn\dropbox\myprojects\mysoftware\c++\firstproj\firstproj \userplayer.h(9): error C2504: 'Player': base class undefined 1>c:\program files (x86)\microsoft visual studio 10.0\vc\include\iostream(10): error C2059: 语法错误: '命名空间'1>c:\program files (x86)\microsoft visual studio 10.0\vc\include\iostream(10): error C2334: unexpected token(s) before '{'; 跳过明显的函数体 1>c:\users\bn\dropbox\myprojects\mysoftware\c++\firstproj\firstproj\userplayer.cpp(8): error C3254: 'Player' : class contains explicit override '{ctor}' 但确实不是从包含函数声明 1>c 的接口派生的：
> c:\users\bn\dropbox\myprojects\mysoftware\c++\firstproj\firstproj\player.h(18) : 参见 'Player::Player' 1>c:\users\bn\dropbox\myprojects\mysoftware\ 的声明c++\firstproj\firstproj\userplayer.cpp(13): 错误 C3254: 'Player' : 类包含显式覆盖 '{dtor}' 但不是从包含函数声明 1>c:\users\bn\ 的接口派生dropbox\myprojects\mysoftware\c++\firstproj\firstproj\userplayer.cpp(13): 错误 C2838: '{dtor}' : 成员声明中的非法限定名 1>c:\users\bn\dropbox\myprojects\mysoftware\c++ \firstproj\firstproj\userplayer.cpp(13): 错误 C2535: 'Player::~Player(void)' : 成员函数已定义或声明 1>
> cpp 1>c:\users\bn\dropbox\myprojects\mysoftware\c++\firstproj\firstproj\npcplayer.h(9): error C2504: 'Player' : base class undefined 1>c:\users\bn\dropbox\ myprojects\mysoftware\c++\firstproj\firstproj\userplayer.h(9): error C2504: 'Player': base class undefined 1>c:\program files (x86)\microsoft visual studio 10.0\vc\include\iostream(10 ): 错误 C2059: 语法错误: 'namespace' 1>c:\program files (x86)\microsoft visual studio 10.0\vc\include\iostream(10): error C2334: '{'前面的意外令牌；跳过明显的函数体 1>c:\program files (x86)\microsoft visual studio 10.0\vc\include\time.h(35): error C2059: syntax error: 'string' 1>c:\program files (x86) \microsoft visual studio 10.0\vc\include\time.h(35)：错误 C2334：'{' 之前的意外标记；跳过明显的函数体 1>c:\users\bn\dropbox\myprojects\mysoftware\c++\firstproj\firstproj\pokerround.cpp(16): error C2059: syntax error: 'namespace'

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-21T01:12:52.233

可能您在类定义之后缺少分号或头文件中的类似内容，您将其`#include`放入一些标准头文件上方的一堆其他文件中，这会使一切变得混乱，编译器将事情报告为错误，这些错误只是错误，因为您忘记了一件小事。

仔细检查每个头文件的语法，寻找不匹配的括号或大括号，并确保在需要它们的地方有分号。

# cocos2d-iphone - 如何在 cocos2d 中获取 CCLabelTTF 的实际大小？

> ID：12522927
> 
> 赞同：3
> 
> 时间：2012-09-21T00:50:47.000
> 
> 标签：cocos2d-iphone

我有一个带有动态文本的 CCLabelTTF。假设它的最大尺寸为 200,200。我创建它：

```
CCLabelTTF * label = [CCLabelTTF labelWithString:@"Hello!" dimensions:CGSizeMake(200,200) alignment:UITextAlignmentLeft lineBreakMode:UILineBreakModeWordWrap fontName:@"Helvetica" fontSize:15]; 
```

这很好用。

但是我必须在下面放一些东西，因此我需要知道文字的高度。我试过 label.texture.contentSize、label.contentSize。他们都是200,200。

我可以在这里做什么？我正在使用 cocos2d 1.x

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-21T02:02:09.883

你可以使用 NSString 的 sizeWithFont 方法。

```
NSString *hello = @"Hello!"
UIFont *font = ...
CGSize *textSize = [hello sizeWithFont:font constrainedToSize:CGSizeMake(200, 200) lineBreakMode:UILineBreakModeWordWrap]; 
```

这应该告诉您文本的确切大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-22T22:08:09.303

```
UIFont * font = [UIFont fontWithName:@"HelveticaNeue" size:15];
CGSize realSize = [message sizeWithFont:font constrainedToSize:CGSizeMake(210, 200) lineBreakMode:UILineBreakModeWordWrap];    
label = [CCLabelTTF labelWithString:message dimensions:realSize alignment:UITextAlignmentCenter lineBreakMode:UILineBreakModeWordWrap fontName:@"HelveticaNeue" fontSize:15]; 
```

这就是我根据@Ben 回答最终做的事情。它完美地工作！

# c++ - std::promise 和 std::future 的非显而易见的生命周期问题

> ID：12522928
> 
> 赞同：12
> 
> 时间：2012-09-21T00:51:19.777
> 
> 标签：c++, c++11, promise, stdthread

这个问题与这里的前一个问题非常相似：[pthread_once() 中的竞争条件？](https://stackoverflow.com/questions/10843304/race-condition-in-pthread-once)

它本质上是相同的问题 -`std::promise`调用期间结束 的生命周期`promise::set_value`（即：在关联的未来被标记之后，但在`pthread_once`执行之前）

所以我知道我的用法有这个问题，因此我不能以这种方式使用它。但是，我认为这不是显而易见的。（用 Scott Meyer 的话来说：*使接口易于正确使用和难以正确使用*）

我在下面提供一个示例：

*   我有一个线程 ( `dispatcher`)，它在队列上旋转，弹出一个“作业”(a `std::function`) 并执行它。
*   我有一个名为的实用程序类`synchronous_job`，它会阻塞调用线程，直到在调度程序线程上执行了“作业”
*   `std::promise`and是的`std::future`成员`synchronous_job`- 一旦`future`设置了，被阻塞的调用线程继续，这导致`synchronous_job`从堆栈中弹出并被破坏。
*   不幸的是，此时在*里面*`dispatcher`是上下文切换的；已标记，但调用尚未执行，并且 pthread 堆栈以某种方式损坏，这意味着下一次：**死锁** *`promise::set_value``future``pthread_once`*

 ***我希望调用`promise::set_value`是原子的；以这种方式使用这些类时，它需要在标记后做更多工作的事实`future`将不可避免地导致此类问题。

`std::promise`所以我的问题是：如何使用and来实现这种同步，并`std::future`保持它们的生命周期与提供这种同步机制的类相关联？

@Jonathan Wakely，您是否可以在内部使用一些 RAII 样式的类，`condition_variable`在标记`future`? 这意味着即使`promise`在调用 的过程中破坏了`set_value`，设置条件变量的额外工作也将正确完成。只是一个想法，不知道你是否可以使用它......

下面是一个完整的工作示例，以及死锁应用程序的堆栈跟踪：

```
#include <iostream>
#include <thread>
#include <future>
#include <queue>

struct dispatcher
{
    dispatcher()
    {
        _thread = std::move(std::thread(&dispatcher::loop, this));
    }
    void post(std::function<void()> job)
    {
        std::unique_lock<std::mutex> l(_mtx);
        _jobs.push(job);
        _cnd.notify_one();
    }
private:
    void loop()
    {
        for (;;)
        {
            std::function<void()> job;
            {
                std::unique_lock<std::mutex> l(_mtx);
                while (_jobs.empty())
                    _cnd.wait(l);
                job.swap(_jobs.front());
                _jobs.pop();
            }
            job();
        }
    }
    std::thread                       _thread;
    std::mutex                        _mtx;
    std::condition_variable           _cnd;
    std::queue<std::function<void()>> _jobs;
};
//-------------------------------------------------------------

struct synchronous_job
{
    synchronous_job(std::function<void()> job, dispatcher& d)
        : _job(job)
        , _d(d)
        , _f(_p.get_future())
    {
    }
    void run()
    {
        _d.post(std::bind(&synchronous_job::cb, this));
        _f.wait();
    }
private:
    void cb()
    {
        _job();
        _p.set_value();
    }
    std::function<void()> _job;
    dispatcher&           _d;
    std::promise<void>    _p;
    std::future<void>     _f;
};
//-------------------------------------------------------------

struct test
{
    test()
        : _count(0)
    {
    }
    void run()
    {
        synchronous_job job(std::bind(&test::cb, this), _d);
        job.run();
    }
private:
    void cb()
    {
        std::cout << ++_count << std::endl;
    }
    int _count;
    dispatcher _d;
};
//-------------------------------------------------------------

int main()
{
    test t;
    for (;;)
    {
        t.run();
    }
} 
```

死锁应用的堆栈跟踪：

**线程 1（主线程）**

```
#0  0x00007fa112ed750c in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
#1  0x00007fa112a308ec in __gthread_cond_wait (__mutex=<optimized out>, __cond=<optimized out>) at /hostname/tmp/syddev/Build/gcc-4.6.2/gcc-build/x86_64-unknown-linux-gnu/libstdc++-v3/include/x86_64-unknown-linux-gnu/bits/gthr-default.h:846
#2  std::condition_variable::wait (this=<optimized out>, __lock=...) at ../../../../libstdc++-v3/src/condition_variable.cc:56
#3  0x00000000004291d9 in std::condition_variable::wait<std::__future_base::_State_base::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, std::__future_base::_State_base::wait()::{lambda()#1}) (this=0x78e050, __lock=..., __p=...) at /hostname/sdk/gcc470/suse11/x86_64/include/c++/4.7.0/condition_variable:93
#4  0x00000000004281a8 in std::__future_base::_State_base::wait (this=0x78e018) at /hostname/sdk/gcc470/suse11/x86_64/include/c++/4.7.0/future:331
#5  0x000000000042a2d6 in std::__basic_future<void>::wait (this=0x7fff0ae515c0) at /hostname/sdk/gcc470/suse11/x86_64/include/c++/4.7.0/future:576
#6  0x0000000000428dd8 in synchronous_job::run (this=0x7fff0ae51580) at /home/lorimer/p4/Main/Source/Trading/Confucius/Test/Scratch/Test1/main.cpp:60
#7  0x0000000000428f97 in test::run (this=0x7fff0ae51660) at /home/lorimer/p4/Main/Source/Trading/Confucius/Test/Scratch/Test1/main.cpp:83
#8  0x0000000000427ad6 in main () at /home/lorimer/p4/Main/Source/Trading/Confucius/Test/Scratch/Test1/main.cpp:99 
```

**线程 2（调度程序线程）**

```
#0  0x00007fa112ed8b5b in pthread_once () from /lib64/libpthread.so.0
#1  0x0000000000427946 in __gthread_once (__once=0x78e084, __func=0x4272d0 <__once_proxy@plt>) at /hostname/sdk/gcc470/suse11/x86_64/bin/../lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/x86_64-unknown-linux-gnu/bits/gthr-default.h:718
#2  0x000000000042948b in std::call_once<void (std::__future_base::_State_base::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>&, bool&), std::__future_base::_State_base* const, std::reference_wrapper<std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()> >, std::reference_wrapper<bool> >(std::once_flag&, void (std::__future_base::_State_base::*&&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>&, bool&), std::__future_base::_State_base* const&&, std::reference_wrapper<std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()> >&&, std::reference_wrapper<bool>&&) (__once=..., __f=
    @0x7fa111ff6be0: (void (std::__future_base::_State_base::*)(std::__future_base::_State_base * const, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>()> &, bool &)) 0x42848a <std::__future_base::_State_base::_M_do_set(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>&, bool&)>) at /hostname/sdk/gcc470/suse11/x86_64/include/c++/4.7.0/mutex:819
#3  0x000000000042827d in std::__future_base::_State_base::_M_set_result(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>, bool) (this=0x78e018, __res=..., __ignore_failure=false) at /hostname/sdk/gcc470/suse11/x86_64/include/c++/4.7.0/future:362
#4  0x00000000004288d5 in std::promise<void>::set_value (this=0x7fff0ae515a8) at /hostname/sdk/gcc470/suse11/x86_64/include/c++/4.7.0/future:1206
#5  0x0000000000428e2a in synchronous_job::cb (this=0x7fff0ae51580) at /home/lorimer/p4/Main/Source/Trading/Confucius/Test/Scratch/Test1/main.cpp:66
#6  0x000000000042df53 in std::_Mem_fn<void (synchronous_job::*)()>::operator() (this=0x78c6e0, __object=0x7fff0ae51580) at /hostname/sdk/gcc470/suse11/x86_64/include/c++/4.7.0/functional:554
#7  0x000000000042d77c in std::_Bind<std::_Mem_fn<void (synchronous_job::*)()> (synchronous_job*)>::__call<void, , 0ul>(std::tuple<>&&, std::_Index_tuple<0ul>) (this=0x78c6e0, __args=...) at /hostname/sdk/gcc470/suse11/x86_64/include/c++/4.7.0/functional:1156
#8  0x000000000042cb28 in std::_Bind<std::_Mem_fn<void (synchronous_job::*)()> (synchronous_job*)>::operator()<, void>() (this=0x78c6e0) at /hostname/sdk/gcc470/suse11/x86_64/include/c++/4.7.0/functional:1215
#9  0x000000000042b772 in std::_Function_handler<void (), std::_Bind<std::_Mem_fn<void (synchronous_job::*)()> (synchronous_job*)> >::_M_invoke(std::_Any_data const&) (__functor=...) at /hostname/sdk/gcc470/suse11/x86_64/include/c++/4.7.0/functional:1926
#10 0x0000000000429f2c in std::function<void ()>::operator()() const (this=0x7fa111ff6da0) at /hostname/sdk/gcc470/suse11/x86_64/include/c++/4.7.0/functional:2311
#11 0x0000000000428c3c in dispatcher::loop (this=0x7fff0ae51668) at /home/lorimer/p4/Main/Source/Trading/Confucius/Test/Scratch/Test1/main.cpp:39 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-21T09:33:18.860

`std::promise`就像任何其他对象一样：一次只能从一个线程访问它。在这种情况下，您在`set_value()`没有足够同步的情况下从单独的线程调用和销毁对象：规范中没有任何地方说在准备好后`set_value`不会接触`promise`对象。`future`

然而，由于这个 future 用于一次性同步，所以无论如何你都不需要这样做：在 中创建 promise/future 对`run()`，并将 promise 传递给线程：

```
struct synchronous_job
{
    synchronous_job(std::function<void()> job, dispatcher& d)
        : _job(job)
        , _d(d)
    {
    }
    void run(){
        std::promise<void> p;
        std::future<void> f=p.get_future();

        _d.post(
            [&]{
                cb(std::move(p));
            });

        f.wait();
    }
private:
    void cb(std::promise<void> p)
    {
        _job();
        p.set_value();
    }
    std::function<void()> _job;
    dispatcher&           _d;
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-21T01:30:02.200

在直接回答您的问题时，正确的答案是给`std::promise`线程。这样，只要线程需要它就可以保证存在。

在引擎盖下，`std::future`和`std::promise`有一个共享状态，它们都指向并保证在双方都被销毁之前保持可用。从概念上讲，这类似于 promise 和 future 都将 shared_ptr 的单独副本复制到同一个对象。该对象包含传递状态、块和其他操作所需的底层机制。

至于试图发出破坏信号，问题是这个条件变量会存在哪里？一旦所有相关的期货和承诺都被销毁，共享区域就会被销毁。发生死锁是因为该区域仍在使用时被破坏（因为编译器不知道另一个线程仍在访问承诺，因为它正在被破坏）。向任何共享状态添加额外的条件变量无济于事，因为它们也会被破坏。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-22T02:47:50.540

规范的答案是永远不要将 std::bind 绑定到*这个*，而是绑定到 std::weak_ptr。当你得到回调时，lock() 它并在调用回调之前检查 NULL。

或者，重申一下，永远不要从不包含对象的 shared_ptr 的范围内调用成员函数（从外部）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-21T01:29:12.227

回答我自己的问题，提供一个可行的解决方案。它不使用`std::promise`or `std::future`，但它实现了我正在寻找的同步。

更新`synchronous_job`以使用`std::condition_variable`and`std::mutex`代替：

**编辑：**更新为包含*Dave S建议的布尔标志*

```
struct synchronous_job
{
    synchronous_job(std::function<void()> job, dispatcher& d)
        : _job(job)
        , _d(d)
        , _done(false)
    {
    }
    void run()
    {
        _d.post(std::bind(&synchronous_job::cb, this));
        std::unique_lock<std::mutex> l(_mtx);
        if (!_done)
            _cnd.wait(l);
    }
private:
    void cb()
    {
        _job();
        std::unique_lock<std::mutex> l(_mtx);
        _done = true;
        _cnd.notify_all();
    }
    std::function<void()>   _job;
    dispatcher&             _d;
    std::condition_variable _cnd;
    std::mutex              _mtx;
    bool                    _done;
}; 
```***

# git - 从超级项目跟踪子模块的变化

> ID：12522930
> 
> 赞同：0
> 
> 时间：2012-09-21T00:51:38.993
> 
> 标签：git, git-submodules

我们有一个超级项目，它有几个子模块，运行良好。

但是现在我们已经到了需要为这个特定项目修改其中一个子模块的地步，但如果可能的话，仍然希望能够从原始子模块中提取更改。

我们显然希望超级项目能够跟踪这些更改，而不是在我们进行更改时推送到原始子模块。

我们该如何管理呢？

我想我们可以在这个特定项目的子模块中创建一个分支，但是对于使用相同子模块的 100 多个项目来说，这可能会变得混乱。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T09:20:50.570

我不知道你的项目/子项目的细节，所以我只会给出模糊和一般的意见。

您的问题似乎与 git 无关，而是与管理项目/子项目依赖项有关。

首先警告一句：根据您的描述，您想调整 100 多个项目使用的子模块的行为，仅用于其中一个项目。如果您真的最终修改了子模块（例如：修改*其他项目*也使用的代码），那么您正在进入一个新的测试圈。看看你的子模块是如何工作的，并确定你是否真的应该改变你的子模块，或者只为一个项目调整它。

如果您需要的修改只针对一个项目，请尝试将这些修改限制在项目中 - 而不是修改子模块。

一种可能的方法是将其调用包装在特定项目中，例如替换调用：

```
submodule::do_stuff() 
```

和

```
function adjust_behaviour(){
    result = submodule::do_stuff();
    tweak_for_my_project(result);
    return result;
} 
```

如果您的子模块的行为真的应该根据参数而改变，您应该在它提供的界面中显示它以使用它。

例如：如果您的子模块包含一个函数`computeThis()`，并且计算实际上取决于参数`weather`，您应该考虑更改该函数以使其相应地起作用：`computeThis(weather)`。

或者您的 sumodule 可以加载配置文件，并且每个项目都应该提供自己的配置文件。

# java - Eclipse 间歇性地无法创建 Java 虚拟机

> ID：12522935
> 
> 赞同：1
> 
> 时间：2012-09-21T00:52:41.540
> 
> 标签：java, eclipse, windows-7, jvm, heap-memory

我正在使用 Windows 7 32 位操作系统。我正在使用 Eclipse 3.7 (Indigo) 32 位。我安装了 jdk1.7.0_07 32 位。有时当我以管理员身份运行 Eclipse 时，会收到以下错误消息，

![在此处输入图像描述](../Images/fbc778dd3e2abba7d7d49eea27f64674.png)

当我点击“确定”时，我收到以下错误消息，

![在此处输入图像描述](../Images/2f5ee28de501b5a9eb25890b25a6a9ec.png)

有时我会收到[此](https://stackoverflow.com/questions/7302604/eclipse-error-failed-to-create-the-java-virtual-machine)错误消息。在其他时候，Eclipse 会启动，但是当 Gradle 在尝试启动其守护进程时初始化其 VM 时会失败。

发生了什么？我意识到这是一个内存问题，但为什么我能够偶尔启动 Eclipse 并运行一切正常？而在其他时候，为什么我能够启动 Eclipse 但无法运行任何东西，或者根本无法启动 Eclipse？

作为开发人员，这种行为是令人讨厌的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T03:40:34.960

试试`-Xmx900m`。问题可能出在 eclipse.ini 文件上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T03:38:08.427

我在JDK7中遇到过这个问题。我发现如果 Eclipse 在 Java 6 下运行，我会做得更好，然后将 JDK7 添加为项目的运行时环境。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T20:46:41.740

确保您的 Eclipse 按位匹配您的 jre/jdk。如果你使用的是 32 位的 eclipse，则必须使用 32 位的 jdk。

您的 -vm 参数错误。arg 必须从下一行开始，如下所示：

-vm
c:\Program Files\java... 等

当 JVM（Sun 的 JVM）启动时，它会将堆分配为单个 malloc，即单个连续的内存块。如果出于某种原因，那么多连续内存不可用，那么 JVM 将不会启动。如果不调试您的机器，就很难知道是什么阻止了一个大的 malloc。请注意，最近一些病毒一直在 jvm 内躲避。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-25T12:01:46.913

你说你的操作系统是 32 位操作系统，你的 Eclipse 是 32 位兼容的还是 64 位的，如果它是 64 位的话，删除 Eclipse 中的 java 相关文件夹，并用 64 位 java sdk 替换它，这样就可以了，我遇到了这个问题，我以这种方式解决了它。

# ruby - 我如何摆脱这个 if 和 each 语句？

> ID：12522938
> 
> 赞同：0
> 
> 时间：2012-09-21T00:52:48.573
> 
> 标签：ruby

我有以下要输出前六个用户的地方，如果超过六个，只需返回'...'。

我该怎么做？

```
<% users.each_with_index do |x, key| %>
   <% if key <= 5 %> 
    <%=x.name %>
    <% else %>
      ... <% next %>
    <% end %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-21T00:55:40.697

最后的下一个是什么？Next 将进入下一个迭代。如果你想跳出循环，你需要使用break。

```
<%
  users.each_with_index do |user, key|
    if key > 5
      concat('...')
      break
    end
    concat(user.name)
  end
%> 
```

你也可以

```
<%= users.take(6).map(&:name).join %>
<%= '...' if users.size > 6 %> 
```

# html - 带有菜单 div 的 CSS 内容 div

> ID：12522943
> 
> 赞同：0
> 
> 时间：2012-09-21T00:54:17.900
> 
> 标签：html, css, position

好的，我在 CSS 上遇到了这个小问题。我有一个高度为 100% 的菜单 div，需要使用以下内容才能使其工作

```
#menu {
  background:#222;
  width:120px !important;
  float:left;
  position: absolute;
  top: 30px;
  bottom: 0px;
} 
```

在我的内容区我有这个`CSS`

```
#content {
  float:left;
  display:block;
  height:300px !important;
  background:#333;
  width:100%;
} 
```

在这里演示[：jsFiddle - P3Adk](http://jsfiddle.net/P3Adk/)

正如您将看到的内容在我不想要的菜单下。我希望它位于向左冲洗的菜单旁边。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T07:11:08.243

您是否尝试过类似以下的方法：

```
#content{
    display:block; 
    height:300px !important; 
    background:#333; 
    width:100%;
    margin:30px 0 0 120px;
}
#menu{
    background:#222;
    width:120px !important;
    float:left;
    position: absolute; 
    top: 30px; 
    bottom: 0px;
}​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T00:58:17.740

像[这样](http://jsfiddle.net/P3Adk/1/)？

只需从菜单 div 中删除 position:absolute，给内容 div 一个百分比宽度，给菜单 div 一个百分比宽度（或固定像素宽度）和一个高度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-21T06:43:59.423

试试这个：

```
#content {  
    height:300px; 
    width:100%; 
    background:#333; 
}
.content-inner {
    position:relative; 
    margin-left: 130px; 
    border:1px solid #F00; 
}
#menu { 
    float: left; 
    z-index: 1; 
    position: absolute; 
    left:0; 
    top:30px; 
    bottom:0; 
    width:120px; 
    background:#222; 
} 
```

[http://jsfiddle.net/kpjqz/](http://jsfiddle.net/kpjqz/)

# html - HTML + CSS 文本容器调整

> ID：12522951
> 
> 赞同：0
> 
> 时间：2012-09-21T00:55:11.593
> 
> 标签：html, css, jquery-plugins, textbox

我正在尝试模拟[这个](http://www.class.pm/files/jquery/uscrollbar/demo/)文本框容器。但问题是我正在尝试调整标题的高度，这部分： ![容器](../Images/4358f5406f6839bdfa6afdf7ab1922d9.png)

[他们在此处](http://www.class.pm/files/jquery/uscrollbar/)提供该页面的所有文件（html、css、js）

我一直在搜索documentation.css文件一段时间，以确定它在哪里我可以调整那个盒子的高度，但到目前为止我一直没有成功。这是我的样子： ![我的容器](../Images/18a0cca1f3604e05757b635ef2aff6d0.png)

正如你所看到的，我的看起来几乎完全一样，只是那个盒子的高度太大了。我对网络编程相当陌生，所以我可能不会在正确的地方寻找正确的东西，所以我希望一些更有经验的眼睛能弄清楚。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T01:17:38.180

css 被缩小了，是什么让它对初学者来说有点复杂......

`.main-content>header`但是，如果您在文件中搜索，`documentation.css`您会注意到它正在设置填充。

您发布的链接中的演示具有：

```
padding:15px 30px; 
```

在您的代码中，第一个数字可能高于 15，设置更高的顶部/底部填充。随意调整它。

# sql - ActiveRecord 子查询比较作为范围

> ID：12522956
> 
> 赞同：1
> 
> 时间：2012-09-21T00:56:09.607
> 
> 标签：sql, ruby-on-rails, sql-server, activerecord

我正在将手动 SQL 查询重写为 ActiveRecord 查询，以便在 Rails 应用程序中使用。

它的作用是从同一张表中收集两组用户：一组在上周有合格事件（44 或 48），一组用户在一个月前有相同的合格事件。

这是当前查询。我不知道如何把它变成一个 ActiveRecord 范围：

```
select top 500 active_users_last_week.email 
    from (
      select distinct(email) from user_event_tracking
      where event_id in (44,48)
      and sitedb_created_date between getdate()-8 and getdate()-1
      and sitedb_name = 'XYZ'
      and email not like '%@company.com'
      and email not like '%@other_company.com'
    ) active_users_last_week, 
    (
      select distinct(email) from user_event_tracking
      where event_id in (44,48)
      and sitedb_created_date between getdate()-60 and getdate()-30
      and sitedb_name = 'XYZ'
      and email not like '%@company.com'
      and email not like '%@other_company.com
    ) active_users_last_month
where active_users_last_week.email = active_users_last_month.email; 
```

关于如何将其变成 ActiveRecord 范围的任何建议？我已经将这些设置为范围：

```
scope :active_events, lambda {
    where("event_id in (44,48)")
}

scope :for_property, lambda { |property| 
    where('sitedb_name = ?', property)
}

scope :last_week, lambda {
    where("sitedb_created_date between GETDATE()-8 and GETDATE()-1")
}

scope :last_month, lambda {
    where("sitedb_created_date between GETDATE()-60 and GETDATE()-30")
}

scope :no_test_users, lambda {
    where("email not like '%@company.com' and email not like '%@other_company.com'")
} 
```

这些范围都单独（和彼此）工作。问题是如何以有效的方式`Event.active_events.last_week`获取电子邮件。`Event.active_events.last_month`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T01:48:30.933

试试这个：

```
Event.select(:email).where(:event_id => [44,48], sitedb_created_date => (8.days.ago..1.day.ago), :sitedb_name => 'XYZ', :email => Event.select(:email).where(:event_id => [44,48], sitedb_created_date => (60.days.ago..30.days.ago), :sitedb_name => 'XYZ').where(Event.arel_table[:email].does_not_match_all(["%company.com","%other_company.com"]))) 
```

您可能需要修改天数以将它们调整到您的日期范围，我不能 100% 确定它们是否包含在内。您可能需要将 8.days.ago 更改为 7.days.ago 等。

您还应该能够使用您的范围执行此操作：

```
Event.active_events.last_week.where(:email => Event.active_events.last_month.select(:email)) 
```

# java - 我不确定应该从导入的 IO 类中使用哪个输入

> ID：12522960
> 
> 赞同：1
> 
> 时间：2012-09-21T00:56:41.860
> 
> 标签：java, input, io

我注意到在命令行程序中创建用户输入的方法不止几种。

我简直不知道该选哪个。

首先，我正在考虑使用输入扫描仪，但随后我只是遵循程序的伪代码，其中包括`import java.io.*;`标签，仅此而已。

我应该使用哪种输入法`import java.io.*;`，让我不仅可以阅读`String`，而且可以`double`轻松读取`char`值？

我在谷歌上搜索输入方法，但每个站点使用不同的方法，你会推荐哪种方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T01:01:35.147

我通常会推荐使用`[Scanner](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Scanner.html)`just 因为它让一切变得如此简单。如果你想使用来自 的东西`java.io`，你可以将 a与 a`[BufferedReader](http://docs.oracle.com/javase/1.5.0/docs/api/java/io/BufferedReader.html)`结合使用`[InputStreamReader](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/InputStreamReader.html)`。像这样的东西：

```
BufferedReader in = new BufferedReader(new InputStreamReader(System.in));
System.out.print("Enter anything: ");
String s = in.readLine();
System.out.println("You entered: " + s);
in.close(); 
```

好吧，你明白了。您可能需要进行一些解析才能从用户的输入中获取整数/双精度数（使用`Integer.parseInt(someString)`/ ）。`Double.parseDouble(someString)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T01:06:08.527

如果您想要将命令行参数传递给应用程序的最简单方法，您可以尝试[Apache commons-cli](http://commons.apache.org/cli/)。如果您正在寻找将参数/参数传递到命令行的方法，它使命令行输入变得非常容易。

# python - python pandas的转换器

> ID：12522963
> 
> 赞同：2
> 
> 时间：2012-09-21T00:56:50.983
> 
> 标签：python, pandas

我有一个 .txt 数据，其中第 6 列和第 7 列是 GPS 位置，格式如下：

```
50;18.5701400N,4;07.7693770E 
```

当我通过 read_csv 阅读它时，我尝试使用转换器将其转换为笛卡尔坐标。我为转换器编写了函数

```
convertFunc = lambda x : float((x[0:5]+x[6:12]).replace(';','.'))
convert = {6:convertFunc,7:convertFunc} 
```

当我在单个值上使用它时，它会按照我的意愿工作：

```
convertFunc(myData.Lat[1])
Out [159]:  55.187110250000003 
```

当我尝试在 read_csv 中使用它时它不起作用

```
myData = DataFrame(read_csv('~/data.txt', sep=',' names=['A', 'B', 'C', 'D', 'E', 'Lat', 'Long'],converters=convert)) 
```

我有一个错误：

```
...
convertFunc = lambda x : float((x[0:5] + x[6:12]).replace(';', '.'))
ValueError: invalid literal for float(): DGPS ongitu 
```

我不知道哪里做错了，或者我对转换器有什么误解？或者也许有人知道以这种形式处理 GPS 数据的好方法（包）？

（我认为`lambda`当我想将我的函数应用于列时可能会出现问题`TypeError: only length-1 arrays can be converted to Python scalars`：）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-21T01:12:35.790

那个转换器有点老套；我可以推荐像这样更强大的东西吗？

```
def convert_dmds(s):
    deg, min = s[:-1].split(';')
    sign = 1 if s[-1] in 'NE' else -1
    return sign * (float(deg) + float(min) / 60.0)

def convert_gps(s):
    lat, lon = s.split(',')
    return (convert_dmds(lat), convert_dmds(lon)) 
```

此外，该错误表明您正在尝试转换显然不是 GPS 字符串的内容——也许是标题行？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T07:06:06.503

你的转换器不行。

```
In [67]: convertFunc = lambda x : float((x[0:5]+x[6:12]).replace(';','.'))

In [68]: convertFunc('4;07.7693770E')
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
...
ValueError: invalid literal for float(): 4.07.693770 
```

在一个狡猾的转换器之上，我认为你将转换器应用于错误的列（看看你得到的异常）。

# python - Django ORM & hstore：计算键的唯一值

> ID：12522966
> 
> 赞同：5
> 
> 时间：2012-09-21T00:57:13.030
> 
> 标签：python, django, postgresql, orm, hstore

具有以下模型：

```
from django_hstore import hstore
from django.db import models

class Item(VoteModel):
    data = hstore.DictionaryField(db_index=True)
    objects = hstore.HStoreManager() 
```

就像是：

```
Item.objects.extra(select={"key": "content_item.data -> 'key'"}).aggregate(Count('key')) 
```

不起作用，请参见。[在 Django 查询中使用 .extra(select={...}) 引入的值上使用 .aggregate()？](https://stackoverflow.com/q/4567543/343834)和[https://code.djangoproject.com/ticket/11671](https://code.djangoproject.com/ticket/11671)。

有效的原始 SQL 如下：

```
SELECT content_item.data -> 'key' AS key, count(*)  FROM content_item GROUP BY key;                                                                               
   key     | count 
-----------+-------
 value1    |   223
 value2    |    28
 value3    |    31
(3 rows) 
```

如何通过 Django 的 ORM 获得相同的结果？

供参考：

```
Item.objects.extra(select={"key": "content_item.data -> 'key'"}) 
```

翻译为：

```
SELECT (content_item.data -> 'key') AS "key", "content_item"."id", "content_item"."data" FROM "content_item" 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-21T01:17:24.850

您是否尝试过使用 values 和 order_by？

```
Item.objects.extra(
    select=dict(key = "content_item.data -> 'key'")
).values('key').order_by('key').annotate(total=Count('key')) 
```

像这样的东西在 PostgreSQL 和 Django 1.4 中对我有用。

# asp.net-mvc-3 - 业务逻辑应该去哪里？

> ID：12522967
> 
> 赞同：0
> 
> 时间：2012-09-21T00:57:32.000
> 
> 标签：asp.net-mvc-3, architecture, saas

我正在开发一个将使用 ASP.NET MVC 4 和 SQL Server 的 Saas 应用程序。我计划有一个数据层（使用 EF5）、一个服务层（可能只有 RESTful 服务）、一个 DTO 层和 Web UI 层。稍后，我计划将此应用程序扩展到移动平台，适用于 Android 和 iPhone ......也许是 windows 平板电脑。

通常，人们会为包含业务规则的域对象创建一个单独的层。但是，就我而言，如果我这样做了，那么我将不得不再次为 android 复制规则……再为 iphone 复制规则。所以，我在考虑在服务层本身内拥有业务规则。但是，无论出于何种原因，感觉都不对。

对此有何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T07:19:58.807

表示层必须是它是什么......只是一个表示层。您的业​​务规则不应该在那里。我了解您的 DTO 将是为您的客户提供服务的对象（android、iphone、web 等），因此无需将您的业务对象传输到 UI。将您的业务层隔离在服务器端，让您的客户使用它只是为了获取他们需要显示的数据。

我的建议是让表示层与业务规则无关。使用这种方法将使您的解决方案可扩展且易于扩展。是应用关注点分离的好方法。

这么说..您可能会担心如何在不同平台上共享您的 DTO。我认为最好的方法是不要使用 .NET 对象来提供表示层，因为您计划在表示层中使用不同的编程语言和技术。**JSON**和 REST 可以很好地解决您的问题。我建议使用 Asp.net Web Api 来处理 json 对象。Objective-c、Java 和 Javascript（用于您的 Web UI）可以使用这种对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T10:11:33.370

你说你有一个服务层。业务逻辑应该在它后面。

```
Business layer -> (shared business objects) -> service layer -> (shared DTOs) -> presentation layers 
```

表示层是 MVC4、Android、iPhone 等。它们都可以共享相同的 DTO，但序列化方式不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-22T18:25:37.230

从性能的角度来看，为每个平台复制规则是可行的方法（因为它将不同设备之间的处理分开），但是从维护、一致性等角度来看，您应该将业务规则放在内部/并行的工作流中到服务层。

[http://msdn.microsoft.com/en-us/library/ee658103.aspx](http://msdn.microsoft.com/en-us/library/ee658103.aspx)

# java - 如何同时执行这些多个方法调用？

> ID：12522973
> 
> 赞同：0
> 
> 时间：2012-09-21T00:58:49.573
> 
> 标签：java

我目前正在编写游戏，而我目前正在尝试做的是通过使用循环替换游戏中的多个“对象”。

当我说“对象”时，我指的不是 OOP 中的对象，而是游戏中绘制在缓冲区上的简单实体（例如：岩石或树）。

现在，如果只有几个对象，这种替换对象的方法就可以正常工作，但如果我尝试替换多达 25 个以上的对象，它看起来有点奇怪。

我的意思是你可以看到每个对象一次被替换一个，而不是一次全部替换。（我知道这是因为任务是循环执行的）

这几乎总结了我正在做的事情，以编程方式：

```
for(int i = 0; i < tilesToReplace; i++) //Looping through the total amount of tiles that will be replaced
//Spawning an object in the desired tile
spawnObject(objectPatch.objectId, //irrelevant, (new object ID)
        objectPatch.coords[0][i], //irrelevant, X Coordinate of the current index
        objectPatch.coords[1][i]); //irrelevant, Y Coordinate of the current index 
```

我已经考虑过做一些事情，比如暂停实体渲染，直到我想要替换的所有对象都被初始化，但我想知道是否有更简单的方法来做这件事，比如我处理循环的方法不知道。（我并不是真的想通过我的对象/渲染处理等进行更改。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T01:14:23.820

我试过这个[例子](https://stackoverflow.com/a/3078354/230513)；`N = 10`替换 100 个标签仍然同时出现。问题出在您程序的其他地方，您将不得不[分析](https://stackoverflow.com/q/2064427/230513)代码以查看哪里。作为一般原则，尽量使[事件调度线程](http://download.oracle.com/javase/tutorial/uiswing/concurrency/initial.html)上的活动尽可能短；[例如](https://stackoverflow.com/a/3256941/230513)，一个[sscce](http://sscce.org/)可能是一个有用的练习。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T01:38:59.827

如果您使用 C++ 进行开发，有一种方法可以设置屏幕缓冲。您在下一个屏幕缓冲区（未显示的那个）上处理更改。然后在处理完成后切换屏幕以显示该缓冲区。

您使用的是 C 还是 C++。这是为什么游戏在 C 上效果更好的一个例子。

# c# - Automapper 实例化目标对象而不是递归映射

> ID：12522980
> 
> 赞同：1
> 
> 时间：2012-09-21T01:01:01.097
> 
> 标签：c#, automapper

我正在尝试将我的 DTO 对象映射到我的工厂类中的实体对象。DTO 具有所有字段值，而实体具有由名称和值组成的字段。

经过一番调试，我发现 Automapper 实例化了每个实体字段，而不是使用现有的。结果，最后一次测试失败。

```
[TestFixture]
class RecursiveMappingTest
{
    public class SourceInfo
    {
        public string Info1 = "info1";
        public string Info2 = "info1";
    }

    public class StringField
    {
        public string Name;
        public string Value;
    }

    public class DestinationInfo
    {
        public StringField Info1 = new StringField() { Name = "field name 1" };
        public StringField Info2 = new StringField() { Name = "field name 2" };
    }

    [Test]
    public void MapField()
    {
        Mapper.CreateMap<string, StringField>()
            .ForMember(dest => dest.Value, opt => opt.MapFrom(src => src));

        Mapper.CreateMap<SourceInfo, DestinationInfo>();

        SourceInfo sourceInfo = new SourceInfo();
        DestinationInfo destinationInfo = new DestinationInfo();

        Mapper.Map(sourceInfo, destinationInfo);

        // these pass
        Assert.That(destinationInfo.Info1.Value, Is.EqualTo("info1"));
        Assert.That(destinationInfo.Info2.Value, Is.EqualTo("info1"));

        // this fails since automapper instantiated brand new StringField()
        // which has Name == "".
        Assert.That(destinationInfo.Info1.Name, Is.EqualTo("field name 1"));
    }
} 
```

这是预期的行为吗？我怎样才能达到我想要的？实体类中有大量字段，因此[此解决方法对我不起作用](https://stackoverflow.com/questions/11346571/how-not-to-lose-properties-that-are-present-in-my-destination-object-but-are-not)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T02:00:41.283

尝试将您的第二张地图更改为：

```
Mapper.CreateMap<SourceInfo, DestinationInfo>()
.ForAllMembers(x => x.UseDestinationValue()); 
```

这应该对所有未映射的属性使用目标值。

# java - Android - 在应用程序关闭时保存 ListView 的检查项目

> ID：12522982
> 
> 赞同：0
> 
> 时间：2012-09-21T01:01:14.517
> 
> 标签：java, android, eclipse, list, arraylist

我正在 Eclipse 中为 Android 平台制作一个应用程序，我需要一些帮助。:) 我想要做的是从另一个 ListView 中检查的项目创建一个数组列表。我想出了如何做到这一点，这是代码：

```
public class MusicList extends Activity {
    private ListView lvCheckBox;
    private String[] arr = { "Depeche Mode", "The Prodigy", "Rammstein",
            "Manilla Road", "Led Zeppelin", "AC/DC", "Massive Attack",
            "Skrillex", "Deadmau5" };
    ArrayList<String> arrList;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.musiclist);
        lvCheckBox = (ListView) findViewById(R.id.lvCheckBox);
        lvCheckBox.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE);
        lvCheckBox.setAdapter(new ArrayAdapter<String>(this,
                android.R.layout.simple_list_item_checked, arr));
        arrList = new ArrayList<String>();
        lvCheckBox.setOnItemClickListener(new OnItemClickListener(){
            public void onItemClick(AdapterView<?> arg0, View arg1, int arg2,
                        long arg3) {
                    // TODO Auto-generated method stub
                     if(arrList.contains(lvCheckBox.getItemAtPosition(arg2).toString()))
                    {
                        arrList.remove(lvCheckBox.getItemAtPosition(arg2).toString());
                    }
                    else
                    {
                        arrList.add(lvCheckBox.getItemAtPosition(arg2).toString());
                    }

                    Collections.sort(arrList);
                    String strText = "";

                    for(int i=0 ; i<arrList.size(); i++)                   
                           strText += arrList.get(i) + ",";

                    Toast.makeText(MusicList.this, "Item Clicked: "+ strText,     Toast.LENGTH_SHORT).show();                
                }
        });
    }
} 
```

但！现在我需要保存该数组列表（比如一些“用户设置”（实际上是用户喜欢的音乐）），即使应用程序完全关闭并且当我回到列表屏幕时，以前检查过的项目也需要再次检查（忍耐）请注意，我将在起始名单中添加更多的音乐家！！）。那么，有人知道该怎么做吗？:)

就是这样，提前谢谢，而且我是新来的，如果我搞砸了，很抱歉:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T01:25:21.173

Android 有一个 SharedPreferences 类，它允许您将信息保存到应用程序的“缓存”。

因此，您将能够保存和检索列表信息。

[http://developer.android.com/reference/android/content/SharedPreferences.html](http://developer.android.com/reference/android/content/SharedPreferences.html)

# javascript - 如何让测试用例出现在 Rally 纸板上？

> ID：12522983
> 
> 赞同：2
> 
> 时间：2012-09-21T01:01:15.560
> 
> 标签：javascript, rally, testcase

我正在尝试使用 Rally App SDK 在纸板上显示测试用例。这是我正在使用的代码。出现的纸板有测试用例方法的列，但没有内容，尽管有符合条件的记录。如果，作为唯一的更改，我注释掉测试用例类型和属性并取消注释那些任务，我会在纸板中得到指定所有者的任务就好了。这向我表明 var 定义是正确的。我需要什么额外的魔法才能让测试用例出现？我的最终目标是同时展示一个包含来自多个用户故事的测试用例的纸板（或其他容器）。

```
 var testCaseCardBoardConfig = {
        xtype: 'rallycardboard',
        types: ['Test Case'],
        attribute: 'Method',
        //types: ['Task'],
        //attribute: 'State',
        storeConfig: {
            filters: [
                {
                    property: 'Owner',
                    operator: 'contains',
                    value:    'Anders'
                }
            ]
        }
    }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T02:34:34.953

这实际上是我将归档的纸板中的一个错误。如果您检查浏览器中的网络选项卡，您将看到对 TestCase.js 的请求返回此错误：

无法使用未知属性排名排序

CardBoard 的默认排序是按等级排序，目前不检查以确保显示的类型具有该字段。任务、故事、缺陷等都有它，这就是为什么它对你有用的原因。

您可以向 storeConfig 添加不同的排序器来解决此问题：

```
var testCaseCardBoardConfig = {
    xtype: 'rallycardboard',
    types: ['Test Case'],
    attribute: 'Method',
    storeConfig: {

        //override default Rank sorters
        sorters: [{property: 'ObjectID'}],

        //A cleaner way to specify that they belong to you
        filters: [
            {
                property: 'Owner',
                operator: '=',
                value:    '/user/' + this.getContext().getUser().ObjectID
            }
        ],

        //Specify current project and scoping
        context: this.getContext().getDataContext()
    } 
```

我还稍微清理了你的过滤器。此外，始终包含当前上下文是一种很好的做法，这样您的董事会就可以正确地适应您当前的项目和上/下。

# php - 正则表达式用链接替换 url 并添加特定的 rel

> ID：12522984
> 
> 赞同：0
> 
> 时间：2012-09-21T01:01:18.170
> 
> 标签：php, regex

下面的代码从字符串中检查任何 URL 的文本并将它们转换为可点击的链接。

我正在尝试获取它，以便如果有指向图像的链接，它会在 < a> 标记中添加 rel="image" 。如果有 youtube 视频，它会将 rel="youtube" 添加到 < a> 标签。

如果字符串中只有一个链接，它工作正常。当有多个链接时，所有链接都会获得最后一个链接的 rel。

```
$text = "http://site.com a site www.anothersite.com/ http://imgur.com/image.png http://youtu.be/UyxqmghxS6M here is another site";

$linkstring = preg_replace('/(http|ftp)?+(s)?:?(\/\/)?+(www.)?((\w|\.)+)+\.(com|org|net|mil|edu|COM|ORG|NET|MIL|EDU|be|info|co)+(\/)?(\S+)?/i', '<a rel="iframe" href="\0">\0</a>', $text ); 
if(preg_match('/((http:\/\/)?(?:youtu\.be\/|(?:[a-z]{2,3}\.)?youtube\.com\/v\/)([\w-]{11}).*|http:\/\/(?:youtu\.be\/|(?:[a-z]{2,3}\.)?youtube\.com\/watch(?:\?|#\!)v=)([\w-]{11}).*)/i', $linkstring, $vresult)) {
    $pattern = "/(http|ftp)?+(s)?:?(\/\/)?+(www.)?((\w|\.)+)+\.(com|org|net|mil|edu|COM|ORG|NET|MIL|EDU|be|info|co)+(\/)?(\S+)?/i";
    $replacement = '<a rel="youtube" href="\0">\0</a>';
    $text2 = preg_replace($pattern, $replacement, $text);
    $type= 'youtube';
} elseif(preg_match('/(http(s?):)?|([\/|.|\w|\s])*\.(?:jpg|gif|png|jpeg|bmp)/i', $linkstring, $vresult)) {
    $pattern = "/(http|ftp)?+(s)?:?(\/\/)?+(www.)?((\w|\.)+)+\.(com|org|net|mil|edu|COM|ORG|NET|MIL|EDU|be|info|co)+(\/)?(\S+)?/i";
    $replacement = '<a rel="image" href="\0">\0</a>';
    $text2 = preg_replace($pattern, $replacement, $text);
    $type= 'image';
} else {
    $type = 'none';
}
echo $text, "<br />";
echo $text2, "<br />";
echo $linkstring, "<br />";
echo $type, "<br />"; 
```

我尝试更改 $pattern 以使其匹配与 youtube 或图像链接相同的正则表达式，但最终会在 URL 之后为整个文本创建一个链接。

例子：

```
$text = "http://site.com a site www.anothersite.com/ http://imgur.com/image.png http://youtu.be/UyxqmghxS6M here is another site";

$linkstring = preg_replace('/(http|ftp)?+(s)?:?(\/\/)?+(www.)?((\w|\.)+)+\.(com|org|net|mil|edu|COM|ORG|NET|MIL|EDU|be|info|co)+(\/)?(\S+)?/i', '<a rel="iframe" href="\0">\0</a>', $text ); 
if(preg_match('/((http:\/\/)?(?:youtu\.be\/|(?:[a-z]{2,3}\.)?youtube\.com\/v\/)([\w-]{11}).*|http:\/\/(?:youtu\.be\/|(?:[a-z]{2,3}\.)?youtube\.com\/watch(?:\?|#\!)v=)([\w-]{11}).*)/i', $linkstring, $vresult)) {
    $pattern = "/((http:\/\/)?(?:youtu\.be\/|(?:[a-z]{2,3}\.)?youtube\.com\/v\/)([\w-]{11}).*|http:\/\/(?:youtu\.be\/|(?:[a-z]{2,3}\.)?youtube\.com\/watch(?:\?|#\!)v=)([\w-]{11}).*)/i";
    $replacement = '<a rel="youtube" href="\0">\0</a>';
    $text2 = preg_replace($pattern, $replacement, $text);
    $type= 'youtube';
} else {
    $type = 'none';
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T06:54:53.887

不幸的是，我无法让您的正则表达式工作，以准确查看您的输出是什么样子（如果您发布结果字符串而不是仅仅描述它们可能会有所帮助）。

但是，您要做的是以下内容。在 if 语句的第一个片段中，您检查字符串是否包含 youtube 链接或图像链接。但是您根本不使用这些信息，而只是再次对整个初始字符串使用 preg_replace 。这当然会替换所有链接，而不仅仅是您之前使用 preg_match 找到的链接（因为该调用完全不相关）。

所以你的第二种方法实际上更好。虽然，我认为在这种情况下你根本不需要 if 子句，因为只有匹配相同模式的字符串部分才会被替换。在链接之后获得完整字符串的原因是 RegExes 中的贪婪。它发生是因为您以 . 结尾两种可能的 youtube 模式`.*`。这可能只是匹配 URL 的其余部分，但它总是会尽可能多地接收。因为`.`匹配任何字符，那是字符串的其余部分。所以首先，你需要告诉正则表达式在哪里停止考虑字符。例如，您可以说 URL 以空格或引号结尾。所以而不是

```
(youtubepattern1).*|(youtubepattern2).* 
```

你可以试试

```
((youtubepattern1|youtubepattern2).*)["\s] 
```

但是现在贪婪仍然是一个问题，如果 URL 后面有多个引号或字符串后面的空格（因为它会包含直到最后一个空格或引号之前的所有内容）。（在 PHP 的正则表达式方法中）告诉解释器不贪婪地对待 .*，添加一个问号：

```
((youtubepattern1|youtubepattern2).*?)["\s] 
```

此外，您可能需要将替换从 using 更改`\0`为 using `\1`now（因为 \0 将包含结束 URL 的空格或引号）。

# ruby-on-rails - 在 Rails 3 中使用来自控制器操作的 REST 请求

> ID：12522986
> 
> 赞同：0
> 
> 时间：2012-09-21T01:01:23.493
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, rest, amazon-web-services

我需要在控制器的更新操作中使用 REST 请求。这是亚马逊支付市场 API。以下是他们的例子。我将如何在控制器中调用它并处理响应？下面也是回复。非常感谢任何帮助。

```
Sample REST Request

https://fps.sandbox.amazonaws.com?
Action=Settle
&AWSAccessKeyId=AKIAIOSFODNN7EXAMPLE
&ReserveTransactionId=14GKD9GE66FAA63E6O6B2JDPZKN53LZ7F22
&SignatureMethod=HmacSHA256
&SignatureVersion=2
&Signature=SJJLsIBghi7VIycBjX7c3hnfgZ%2FBvZbzqLtAZXDL8ys%3D
&Timestamp=2009-10-06T07%3A53%3A11.750Z
&TransactionAmount.CurrencyCode=USD
&TransactionAmount.Value=1
&Version=2008-09-17 
```

对 REST 请求的响应示例

```
<SettleResponse xmlns="http://fps.amazonaws.com/doc/2008-09-17/">
  <SettleResult>
    <TransactionId>14GKD9GE66FAA63E6O6B2JDPZKN53LZ7F22</TransactionId>
    <TransactionStatus>Pending</TransactionStatus>
  </SettleResult>
  <ResponseMetadata>
    <RequestId>9ed2008b-b230-4ed0-9210-095f77fc2359:0</RequestId>
  </ResponseMetadata>
</SettleResponse> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T01:44:58.197

您可以直接使用[`Net::HTTP`](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/net/http/rdoc/Net/HTTP.html)与 ruby​​ 捆绑在一起的 来执行此操作：

```
require "net/http"
require "open-uri"

uri = URI.parse("http://www.google.com")
response = Net::HTTP.get_response(uri)
=> #<Net::HTTPOK 200 OK readbody=true> 
```

然后获取响应的正文：

```
body = response.body
#=> "<!doctype html><html itemscope=\"itemscope\" ... 
```

如果您想做更复杂的事情，我建议您使用[HTTP 客户端 gem](https://www.ruby-toolbox.com/categories/http_clients)，例如[HTTParty](https://github.com/jnunemaker/httparty)或[faraday](https://www.ruby-toolbox.com/projects/faraday)。有很多[使用 HTTParty](https://github.com/jnunemaker/httparty/tree/master/examples)的示例，其中包括使用 aaws 的[示例](https://github.com/jnunemaker/httparty/blob/master/examples/aaws.rb)。

如果繁重的工作只是在响应解析方面，您可以使用[nokogiri](http://nokogiri.org/)：

```
require 'nokogiri'

doc = Nokogiri::HTTP(body)
doc.search('h1').text
#=> "Google" 
```

# android - 每次设置 ImageView 位图时避免 onMeasure 和 onLayout

> ID：12522990
> 
> 赞同：6
> 
> 时间：2012-09-21T01:01:41.200
> 
> 标签：android, android-layout, listview, view, imageview

这是我的设置。我有一个`ListView`带有一些花哨标题的自定义，它位于`ViewPager`. 我正在维护一个已下载并存储在本地的图像的内存缓存，就像任何有自尊的开发人员一样。

我遇到的问题是，每次我使用缓存中的位图调用我的方法`setImageBitmap(Bitmap bm)`时，都会导致我的所有视图都变为. 我查看了Android源代码，发现了这个：`ImageView``ListView``getView()``onMeasure()``ImageView`

```
public void setImageDrawable(Drawable drawable) {
    if (mDrawable != drawable) {
        mResource = 0;
        mUri = null;

        int oldWidth = mDrawableWidth;
        int oldHeight = mDrawableHeight;

        updateDrawable(drawable);

        if (oldWidth != mDrawableWidth || oldHeight != mDrawableHeight) {
            requestLayout();
        }
        invalidate();
    }
} 
```

所以我可以看到`setImageDrawable`（由 调用）只要具有与以前不同的尺寸，`setImageBitmap`就会请求其布局。问题是我的静态设置为 60dp x 60dp，因此无论其图像大小如何，它的大小都不会改变。`drawable``Drawable``ImageView`

有没有办法让我在滚动时绕过不断重新测量的布局？和调用正在向上传播`onMeasure`，因此我的和也在列表滚动的中间进行测量，这显然会导致严重的性能问题（大约 100 毫秒的 UI 跳转）。`onLayout``View``ListView``ViewPager`

性能很糟糕，我需要纠正它。任何人有任何解决方案？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T23:12:44.800

已经有一段时间了，但我最近遇到了类似的问题，我的列表视图高度中的一行变化太大，导致调用了 listview.onmeasure。

如果您是针对 API-14 及更高版本构建的，您可以在 SDK 源代码中设置断点。这应该有助于弄清楚为什么高度会改变。

# javascript - Jquery mobile不是选择菜单对象

> ID：12522991
> 
> 赞同：3
> 
> 时间：2012-09-21T01:02:27.983
> 
> 标签：javascript, jquery-mobile

我正在使用 jquery mobile 并在我的 html 标记中有一个选择菜单，如下所示：

```
<select id="theid">
    <option>foo</option>
    ...
</select> 
```

我实际上想在 ajax 调用之后添加更多选项，所以我执行以下操作：

```
$('#theid').append(
    $('<option val="42">').text('bar')
)

$('#theid').selectmenu('refresh'); 
```

但有时我会收到一个错误，指出该对象没有方法“selectmenu”。为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T01:09:23.407

尝试以下操作：

```
$('#theid').selectmenu('refresh', true); 
```

[http://forum.jquery.com/topic/how-to-add-items-and-refresh-the-select-menu-in-jquery-mobile](http://forum.jquery.com/topic/how-to-add-items-and-refresh-the-select-menu-in-jquery-mobile)

# mysql - 从 varchar 字段中获取最大值

> ID：12522993
> 
> 赞同：3
> 
> 时间：2012-09-21T01:03:10.210
> 
> 标签：mysql, sql, max, varchar

我有一个 varchar 字段作为我的员工 ID，它的格式如下：

格式：YYYY-DateHired-Number 示例：2012-1203-0001

但是我很难插入新记录，因为要插入新的递增 ID，我需要在递增之前获取该字段中的最新值。

如何获得最近一年中具有最新/最高 (MAX) 编号的行？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T01:05:08.730

假设你`EmployeeID`的格式是`YYYY-MMdd-XXXX`. 试试这个，

```
SELECT MAX(EmployeeID)
FROM tableName
WHERE EmployeeID LIKE CONCAT(SUBSTRING(EmployeeID, 1, 4),'%') 
```

# [**SQLFiddle 演示**](http://sqlfiddle.com/#!2/4c120/1)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-21T01:18:40.740

希望这也有帮助：

```
SELECT * FROM tableName
WHERE EmployeeID IN (SELECT MAX(EmployeeID) FROM tableName) 
```

[http://sqlfiddle.com/#!2/2d100/14](http://sqlfiddle.com/#!2/2d100/14)

# jboss - SequenceGenerator 错误：不是有效的函数或过程名称

> ID：12522995
> 
> 赞同：0
> 
> 时间：2012-09-21T01:03:23.597
> 
> 标签：jboss, ejb, hql, ejb-3.0

我有一个带有 JBoss AS 7.1.1 的 EJB 3.0 客户端和服务器。我正在尝试将实体列表持久保存到我连接到的数据库中，但我不断收到此错误：

```
java.sql.SQLException: ORA-06576: not a valid function or procedure name 
```

我`SEQ_ID`在我的 Oracle 数据库中调用了一个序列生成器。我按照本教程进行了设置： http: [//www.developerscrappad.com/408/java/java-ee/ejb3-jpa-3-ways-of-generating-primary-key-through-generatedvalue/](http://www.developerscrappad.com/408/java/java-ee/ejb3-jpa-3-ways-of-generating-primary-key-through-generatedvalue/)

这是我在主键上使用上述教程中的注释的实体 bean：http: [//pastebin.com/QJ6W5VLG](http://pastebin.com/QJ6W5VLG)

这是我保留实体列表的函数：

```
public void persistSchemas(List schemasList){
    String strDelete = " DELETE FROM Schemas s ";
    Query query = em.createQuery(strDelete);
    query.executeUpdate();

    for(Schemas schema : (List<Schemas>)schemasList){
        em.persist(schema);
    }
} 
```

这是服务器上错误的完整堆栈跟踪：http: [//pastebin.com/rmURYdRD](http://pastebin.com/rmURYdRD)

该错误仅在我尝试持久化实体并且它们具有@SequenceGenerator 和@GeneratedValue 两个注释时才出现。所以这肯定是序列发生的事情。这里有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T19:20:52.103

事实证明，HQL 方言是错误的。我需要将其更改为：

```
<property name="hibernate.dialect" value="org.hibernate.dialect.Oracle8iDialect"/> 
```

在我服务器的 META-INF 文件夹中的 persistence.xml 中。

# mod-rewrite - 将 Apache 配置为代理服务器

> ID：12522996
> 
> 赞同：0
> 
> 时间：2012-09-21T01:03:25.137
> 
> 标签：mod-rewrite, proxy, virtual, host

Okie...正在与一个对连锁餐厅进行安全审查的人讨论这个问题。咖啡馆有家用 wifi 路由器，其密码和路由器设置不受保护。

是否有可能有人将所有 Web 请求（80 和 81）重定向到 Web 服务器，该服务器将特定站点的请求重定向到本地托管的网络钓鱼页面（假设黑客进入咖啡馆，连接到无线路由器并拥有 Web 服务器在他的笔记本上运行）。

可能需要注意的是，Web 服务器没有直接连接到 Internet。它使用相同的路由器连接。通过更改路由器配置，可以将所有 Web 请求重定向到使用 MOD 重写的破解者本地 apache 服务器，将尝试访问特定站点的用户转发到本地托管的网络钓鱼页面，从而不与任何可追踪的 ip / Web Hoting 帐户绑定

如果是。如何将流量定向到本地 apache 服务器...使用端口转发或静态路由？[很明显我很讨厌路由器配置]

如果端口 80/81 请求被转发到本地 IP，外部 URI 是否会自动路由到不同端口上的 WAN（如果这是“如果提交成功，CPE 的 WAN HTTP 端口将更改为 8080”的意思 - 明白了当我将路由器上的所有端口 80 连接转发到本地 IP 时发出通知）。

所有网络请求都必须通过破解者的机器，该机器应该充当代理。这可以通过单独更改 WIFI 路由器配置（例如通过创建虚拟主机或通过配置静态路由）来实现吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T01:26:19.203

是的。您可以告诉 Firefox 等浏览器将流量引导到 Squid 等代理服务器并拦截流量。但是，如果您经营网吧，则需要运行一些安全软件。软件将重置所有默认值

# java - 在Java中按值对自定义对象数组进行排序

> ID：12522997
> 
> 赞同：4
> 
> 时间：2012-09-21T01:04:02.543
> 
> 标签：java, sorting

我正在处理 CS-101 任务，并且只允许使用单个数组。我有一个如下所示的数组：

```
[Song, Song, Album, Fiction, Movie, Nonfiction, Song] 
```

这是背景的层次结构（我的作业要求）：

> “在顶层，您将有一个名为 Library 的类。Library 将有三个子类：Music、Book 和 Movie。Music 将有两个子类：Song 和 Album。Book 将有两个子类：Fiction 和 Nonfiction。Movie、Fiction、 Nonfiction、Song 和 Album 不会有任何子类。”

我目前正在尝试编写一种方法，按图书的 ISBN 号对图书进行排序。所以小说和非小说是我的书类的子类，它是图书馆的子类。

我把一切都藏在里面`Library myLibrary[] = new Library[100];`

我不确定如何仅从书籍中检索 ISBN 并对它们进行排序，因为我只允许使用一个数组；否则我很想制作一系列书籍，然后分别对它们进行排序。

我可以利用哪些提示/算法来完成此任务？

*更新*

如果需要，我可以发布更多代码。但是这个问题目前更多地集中在方法上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-21T01:16:18.297

这里的关键是正确设置继承而不是实现 Comparable 接口。例如，请参见此处：[Java Comaprable](https://stackoverflow.com/questions/3718383/java-class-implements-comparable)并在您的父类型数组上调用 .sort（在您的情况下，这将是 myLibrary.sort();） 以下是排序如何对原始类型起作用的示例：[原始类型数组排序](http://www.exampledepot.com/egs/java.util/coll_SortArray.html)

所以

1.  在您的子类型上实现 Comaparable
2.  创建父类型的数组并填充它
3.  在你的数组上调用排序。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T01:26:29.783

检查这是否有效。（目前在选项卡上，所以无法运行代码）

[我认为排序后你的书会在数组的一侧饱和。请告诉我结果]

```
/* book sorting is in decreasing order of ISBN, followed by non book items
The books will be at the beginning of array, other items towards the end */
Arrays.sort(myLibrary, new Comparator<Library>()
    {
        int compare(Library l1, Library l2){
            //if both are books then compare ISBN and return appropriate
            if((l1 instanceof Book) && (l2 instanceof Book)){
                Book b1=(Book)l1; Book b2=(Book)l2;
                if(b1.getISBN()<b2.getISBN) {
                    return -1;
                } else if(b1.getISBN()>b2.getISBN()) {
                    return 1;
                } else {
                    return 0;
                }
            }
            else {//if either one, or none are Book

                //if only l1 is Book, l2 is not
                if(l1 instanceof Book){
                    return 1;
                }

                //if only l2 is Book, l1 is not
                if(l2 instanceof Book){
                    return -1;
                }

                //none are Book
                return 0;
            }
        }
    }
); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-21T02:02:20.237

干得好...

正如[我之前的回答](https://stackoverflow.com/questions/12489128/custom-methods-for-an-array-of-custom-objects-in-java/12489176#12489176)中提到的，写一个新的`Comparator`并使用它来比较`Library`对象。

*注意：我没有检查 null 但你应该这样做......*

```
class LibraryComparator implements Comparator<Library> {
    public int compare(Library l1, Library l2){
         // If Both are Book instance do the comparison
         if(l1 instanceof Book && l2 instanceof Book){
              // Assuming ISBN is a String or Long field in your class Book
              return ((Book)l1).getISBN().compareTo(((Book)l2).getISBN());
         } else {
         // Otherwise no change in ordering
              return 0;
              // You could specify sorting logic for Movie and Music here as well
         }
    }
} 
```

然后你可以像这样对数组进行排序：

```
Arrays.sort(myLibrary, new LibraryComparator()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-21T01:09:25.883

在不尝试给出算法的实际实现的情况下，您应该进行就地排序，其中优先级可以通过以下方式完成：

**1.**书籍比音乐和电影更重要

**2.**如果两个对象是书籍，则优先级基于 ISBN

# performance - Mongo：寻找收集数百万个实例的最快查询

> ID：12522998
> 
> 赞同：0
> 
> 时间：2012-09-21T01:04:25.750
> 
> 标签：performance, mongodb

我收集了这个简单对象的数百万个实例：

```
{
 Org: string,
 Value: string
} 
```

按字段有一个二级索引`[Org]`，大约有数千个不同的`[Org]`值。此集合不应更新，因为它一次填写一次。

现在我有一个任务：以自然顺序（它们插入数据库的顺序，即）请求`[Value]`特定的值，并受特定数量的限制，具有最高性能。我的问题是：`[Org]``$orderby: _id`

*   `orderby`像,`query`和`limit`等运算符的顺序是否会`sort`影响案例中的性能和执行计划？

*   是否将在查询中使用两个索引（辅助 by`[Org]`和默认主 by `_id`）？

*   MongoDb 是否有任何工具可以跟踪索引使用情况，例如 SQL Server 的查询分析器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T01:16:25.180

您正在寻找`explain()`查看您的查询如何使用索引。您可以通过返回的“光标”查看您正在使用的索引，并且一些关键统计数据是`nscanned`、`n`、`scanAndOrder`和`millis`。

需要注意的关键一件事是，mongodb 每个查询只能使用一个索引。

是的，排序会影响性能。为了在查询中使用排序，您应该有一个索引，其中包含要排序的字段的索引中的最后一个字段。因此，您可以在 上创建索引`{org:1, _id:1}`，以优化查询和排序。你会注意到`scanAndOrder`在那之后这将是错误的。

更新：忘了提`limit`。`limit`通常会提高你的性能，因为你给了 mongo 一个缩短搜索时间的机会。如果您`limit`在对索引字段进行排序时，它会有所帮助，否则它必须在返回您正在寻找的结果之前扫描所有结果。

# objective-c - UICollectionViewCell 上的手势；结果怎么办？

> ID：12522999
> 
> 赞同：7
> 
> 时间：2012-09-21T01:04:31.703
> 
> 标签：objective-c, ios6, uicollectionview

我目前正在开发一个 iPad 应用程序的项目。主屏幕是一个`UICollectionView`with`AlbumCell`的子类`UICollectionViewCell`。现在我想添加一个`UILongPressGestureRecognizer`来弹出一个`UIActionSheet`.

首先我在 中尝试过`UICollectionViewController`，但我认为那不是添加这些的正确位置。所以我最好的猜测是在课堂上添加手势`AlbumCell`？然后可能将自己添加为委托，因此它可以捕捉到自己的手势。

到目前为止，这是一个好方法吗？

捕捉到手势后，我应该显示`UIActionSheet`. 现在我在`UICollectionViewController`用户在编辑模式下选择一个单元格时打开它。但是我应该像现在一样调用一个方法`UICollectionViewController`来打开它吗？还是细胞应该自己处理`UIActionSheet`？

最终我得`UICollectionViewController`让他做什么，可能是让他打开`UIActionSheet`，或者根据结果进行处理。应该如何`AlbumCell`“沟通”呢？

这是我一直在努力解决的问题，不仅仅是在这个用例中。方法是否接近，还是我应该完全不同地处理这些行为？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-21T11:31:53.017

您可以采用相同的方法[使用`UILongPressGestureRecognizer`on`UITableView`](https://stackoverflow.com/questions/3924446/long-press-on-uitableview)。

基本上，设置*一个*识别器。在选择器中，使用`indexPathForItemAtPoint:`找出用户正在按下的索引路径。最后，如果用户正在按下单元格（而不是按下单元格之间的空间），`UIActionSheet`则呈现您喜欢的任何内容。