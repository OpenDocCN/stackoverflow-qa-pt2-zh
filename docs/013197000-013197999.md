# StackOverflow 问答 13197000-13197999

# asp.net-web-api-routing - VS2012 WebAPI：找不到与名为“CpbOutcome”的控制器匹配的类型

> ID：13197002
> 
> 赞同：1
> 
> 时间：2012-11-02T14:17:59.727
> 
> 标签：asp.net-web-api-routing

有人可以帮忙吗？我有这个控制器：

```
public class CbpOutcomeController : ApiController
{
    // POST /api/CbpOutcome/1/ 
    public HttpResponseMessage PostCreateCbpOutcome(CbpOutcome co)
    {
        ... snip ...
        return resp_msg;
    }
} 
```

而这条路线：

```
public class RouteConfig
{
    public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapRoute(
            "HubProfilePostRoute", // Route name
            "hub/{controller}/{action}", // URL with parameters
            new { controller = "Home", action = "Index" } // Parameter defaults
        );

        routes.MapHttpRoute(
            name: "ProfileByRegionApi",
            routeTemplate: "api/{controller}/Region/{region_name}"
        );

        routes.MapHttpRoute(
            name: "ProfileByGlobalPriorityApi",
            routeTemplate: "api/{controller}/GlobalPriority/{priority_name}"
        );

        routes.MapHttpRoute(
            name: "ApiRoute",
            routeTemplate: "api/{controller}/{id}",
            defaults: new { id = RouteParameter.Optional }
        );
    }
} 
```

当我使用这个 JSON 结构进行`POST`to时：`http://localhost:2515/api/CpbOutcome`

```
{ "Id":0, "Description":"This is a description", "DisplayOrder": 3, 
  "ModifiedBy":"Somebody's name here", "Cbp": { "Id": 163 }} 
```

我收到这条消息：

```
No type was found that matches the controller named 'CpbOutcome'. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-02T14:19:55.723

---**编辑**---

查看 API 类的拼写。

```
public class CbpOutcomeController : ApiController 
```

然后查看您的 URL 的拼写：

```
http://localhost:2515/api/CpbOutcome 
```

注意 Cbp 和 Cpb

---**结束编辑**---

API 控制器 URL 应位于`WebApiConfig.cs`文件中。

不在`RouteConfig.cs`文件内

分析 VS2012 为 Web API 项目提供的默认模板，您将看到它。

# c++ - 虚拟基类的虚拟继承和转换

> ID：13197004
> 
> 赞同：0
> 
> 时间：2012-11-02T14:18:05.357
> 
> 标签：c++, inheritance, virtual

我遇到了一个关于虚拟继承的具体问题。下面的代码解释了结构。

```
// Header

struct ITarget
{
    virtual void SetValue() = 0;
};

struct ISource
{
    virtual void GetValue() const = 0;
};

struct IBase
{
    virtual void Stuff() = 0;
};

struct IInput :
    virtual public IBase, public ITarget
{
    // Publicly acts only as Target
};

struct IOutput :
    virtual public IBase, public ISource
{
    // Publicly acts only as Source
};

// Implementation

struct SBase :
    virtual public IBase, virtual public ISource, virtual public ITarget
{
    // IBase
    virtual void Stuff();

    // ISource
    virtual void GetValue() const;

    // ITarget
    virtual void SetValue( );
};

struct SInput :
    public IInput, public SBase
{
    // Defines ITarget and ISource per SBase
};

struct SOutput :
    public IOutput, public SBase
{
    // Defines ITarget and ISource per SBase
};

int main()
{
  // To demonstrate the behavior
  ISource* input = new SInput();
  ((SInput*)input)->GetValue();
  return 0;
} 
```

现在，如果我想将*ISource* * 转换为*SInput* *，我会收到错误 C2635：

> “无法将 'ISource*' 转换为 'SInput*'；隐含从虚拟基类的转换”

我究竟该如何设置继承才能使这成为可能？

# cross-platform - Windows 8 Phone 模拟器是否模拟 ARM 或 x86？

> ID：13197010
> 
> 赞同：1
> 
> 时间：2012-11-02T14:18:33.837
> 
> 标签：cross-platform, cpu-architecture, emulation, windows-phone-8, windows-phone-8-emulator

有谁知道 Windows 8 Phone 模拟器的 CPU 架构是使用 ARM 还是 x86？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-02T15:25:22.477

它确实是 x86 虚拟化。ARM 仅适用于设备。如果您想在模拟器上进行测试，则需要为这两种架构构建内部或第 3 方原生组件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-02T15:02:25.807

模拟器是 x86，设备是 ARM。

# sql - SQL 查询和 VBA 错误

> ID：13197011
> 
> 赞同：0
> 
> 时间：2012-11-02T14:18:34.870
> 
> 标签：sql, vba

我不断收到此错误：

```
BOF or EOF set tu True, or the current record has been deleted. The requested
operation requires a current record. 
```

我的代码：

```
 MyQuery = "Select Destinataire, SUM(" & Entete & ") AS NombreTotal FROM [Feuil1$] " _
         & "WHERE [DateMad] Between #" _
         & Format(date_deb, "yyyy/mm/dd") _
         & "# And #" & Format(date_fin, "yyyy/mm/dd") & "#" & Query3 & " Group By Destinataire"

         objRecordSet.Open MyQuery, objConnection, adOpenStatic, adLockOptimistic

         Feuil3.Cells(1, Col) = Entete
         Feuil3.Cells(strLine, 2) = Entete2
         Feuil3.Cells(2, Col).Value = objRecordSet.Fields("NombreTotal").Value 
```

我在最后一行得到错误

```
 Feuil3.Cells(2, Col).Value = objRecordSet.Fields("NombreTotal").Value 
```

为什么它问我 BOF 或 EOF，因为我问的是 SUM？还有如何让这个查询工作？我无法呼吸这个调试

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T15:21:19.403

如果您正在过滤特定数据 ( `Destinataire = 'REL12'`)，并且您在查询中包含该字段以及总和，如果没有记录，而不是获得一条总和为 0 的记录，您将不会获得任何数据。

如果您要获得特定的总和`Destinataire`，则无需将该字段包含在您的选择或分组依据中。您已经只过滤了一个`Destinataire`.

```
MyQuery = "Select SUM(" & Entete & ") AS NombreTotal FROM [Feuil1$] " _
     & "WHERE [DateMad] Between #" _
     & Format(date_deb, "yyyy/mm/dd") _
     & "# And #" & Format(date_fin, "yyyy/mm/dd") & "#" & Query3 
```

# jquery - Struts 1 和 i18n：如何放置 在 img 标题中添加标签？

> ID：13197012
> 
> 赞同：0
> 
> 时间：2012-11-02T14:18:57.283
> 
> 标签：jquery, struts-1, tooltip

我正在使用 jquery 工具提示。

我的字符串在 MessageResources.properties 文件中。

我需要拿其中一个并将其用于 img 工具提示。此代码不起作用：

```
<html:img src="myimg.gif" title="<bean:message key='msg1'/>"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T15:30:39.830

直接来自[文档](http://struts.apache.org/1.3.10/struts-taglib/tagreference.html#html%3aimg)：

> 标题键
> 
> 此元素的咨询标题的消息资源键。

# regex - 查找不是字母、数字或下划线的字符

> ID：13197014
> 
> 赞同：-4
> 
> 时间：2012-11-02T14:19:00.140
> 
> 标签：regex

有没有办法使用正则表达式来隔离不是字母、数字或下划线的字符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T14:20:38.857

你可以试试这样的代码：`/\W/`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T14:20:36.297

是的。大多数正则表达式实现都支持这种结构：**[^abc]** 其中 ^ 字符之后的所有内容都不匹配。在某些实现中，这将起作用：

```
[^[:alnum:]_] 
```

**alnum 类比**使用范围更安全，因为范围对字符集的词法顺序进行了假设。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T14:20:28.047

是的。[请阅读一些正则表达式基础知识。](http://www.regular-expressions.info/tutorial.html)

我真的不知道您所说的“隔离”是什么意思，但这将匹配任何不是字母、数字或下划线的字符：

```
\W 
```

这将匹配这些字符的任何连续字符串：

```
\W+ 
```

# jsf - JSTL c:forEach 不会遍历集合

> ID：13197016
> 
> 赞同：3
> 
> 时间：2012-11-02T14:19:01.560
> 
> 标签：jsf, jstl

有谁知道，为什么这段代码会起作用：

```
<h:outputText value="#{allocations[0].policyNumber}" /> 
```

这段代码可以工作：

```
<c:forEach var="i" begin="1" end="5">
    <h:outputText value="aaa"/>
</c:forEach> 
```

但是这段代码不起作用（GUI中什么都没有出现）：

```
<c:forEach var="allocation" items="#{allocations}" >
    <h:outputText value="aaa"/>
</c:forEach> 
```

我正在使用命名空间“http://java.sun.com/jstl/core”。allocations 是 java 中的一个集合。我已经尝试了我能想到的一切，但不知道下一步该尝试什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-02T14:25:12.687

该`#{}`符号来自统一的 EL。这仅在 JSTL 1.2 中受支持。您的 JSTL 名称空间 URI 与您正在使用 JSF 的事实相结合，表明您实际上正在使用 JSTL 1.1。

您有 2 个选项：

1.  请改用`${}`符号。您应该只保证 bean 已经存在于作用域中。表示法`${}`不会自动创建托管 bean（这样`#{}`做）。

2.  升级到 JSTL 1.2。下载链接和详细信息可以在[我们的 JSTL wiki 页面](https://stackoverflow.com/tags/jstl/info)中找到。不要忘记将 XML 命名空间 URI 更改为`http://java.sun.com/jsp/jstl/core`.

不用说，选项 2 是首选。您应该禁止`${}`您的 JSF 页面。

### 也可以看看：

*   [JSP EL、JSF EL 和 Unified EL 的区别](https://stackoverflow.com/questions/4812755/difference-between-jsp-el-jsf-el-and-unified-el)

* * *

作为一个完全不同的选择，您也可以只使用 Facelets 自己的`<ui:repeat>`而不是`<c:forEach>`. 但是，您应该了解 Facelets 在视图渲染期间运行和 JSTL 在视图构建期间运行的主要区别。另请参阅[JSF2 Facelets 中的 JSTL... 有意义吗？](https://stackoverflow.com/questions/3342984/jstl-in-jsf2-facelets-makes-sense)

# android - 如何通过蓝牙在 Android 上使用 rSAP（远程 SIM 访问配置文件）？

> ID：13197017
> 
> 赞同：2
> 
> 时间：2012-11-02T14:19:01.113
> 
> 标签：android, bluetooth

我需要开发一个可以通过蓝牙读取另一台设备的电话簿的应用程序。通常应该开发服务器和客户端部分，但我认为在我的情况下可以跳过服务器端。在我的汽车中，当我将 MultimediaCar 系统与我的手机配对时，所有电话簿都会传输到汽车内存中，所以我想我的应用程序也可以这样做。

有人知道我该怎么做吗？

# silverlight - Silverlight - 上下文菜单选择了多个项目

> ID：13197021
> 
> 赞同：0
> 
> 时间：2012-11-02T14:19:06.223
> 
> 标签：silverlight

使用 SL5 和 Silverlight 工具包

我在 ListBox 上单击鼠标右键，效果很好：

```
private void Person_Click(object sender, RoutedEventArgs e)
        {
            Account account = ((MenuItem)sender).DataContext as Account;
            UpdateText.Text = string.Format("Person selected on account: <{0}>", account.Username);
        } 
```

如果我选择了多个 ListBox 项目（SelectionMode="Extended"），我只能引用 Person_Click 中的 1 个项目

问题：如何从上下文菜单中引用多个项目？

回答（给未来的人！）

```
 private void Person_Click(object sender, RoutedEventArgs e)
        {
            Account account = ((MenuItem)sender).DataContext as Account;
            UpdateText.Text = string.Format("Person selected on account: <{0}>", account.Username);

            //if multiple items are selected on right click this is how to reference them
            List<int> selectedItemIndexes = new List<int>();
            foreach (object o in AccountItemsT32.SelectedItems)
            {
                //selectedItemIndexes.Add(listBox.Items.IndexOf(o));
                var x = o;
            }
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T14:20:21.480

```
private void Person_Click(object sender, RoutedEventArgs e)
        {
            Account account = ((MenuItem)sender).DataContext as Account;
            UpdateText.Text = string.Format("Person selected on account: <{0}>", account.Username);

            //if multiple items are selected on right click this is how to reference them
            List<int> selectedItemIndexes = new List<int>();
            foreach (object o in AccountItemsT32.SelectedItems)
            {
                //selectedItemIndexes.Add(listBox.Items.IndexOf(o));
                var x = o;
            }
        } 
```

# ruby - 如何使对象在 Ruby 中持久存在？

> ID：13197022
> 
> 赞同：0
> 
> 时间：2012-11-02T14:19:05.537
> 
> 标签：ruby, macos

运行 ruby​​ 脚本时，是否可以让对象在多次调用后保留在内存中？

```
ruby run.rb 
```

在 OSX 中工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T15:30:59.540

# 编组

查看[Marshal](http://www.ruby-doc.org/core-1.9.3/Marshal.html)图书馆。

`Marshal.dump`允许您序列化对象中的数据并将其保存到文件中。

下次您的程序启动时，您可以检查该文件是否存在并用于`Marshal.load`获取该数据并重新创建您的对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T14:34:00.883

您可以为此使用缓存，例如 memcached 与[dalli](https://github.com/mperham/dalli)或 redis 与各种[redis 客户端](https://www.ruby-toolbox.com/categories/Redis)。

# facebook - 如何让 ExtendedMembershipProvider 与 ASP.NET MVC 4 和自定义成员资格提供程序一起使用？

> ID：13197023
> 
> 赞同：2
> 
> 时间：2012-11-02T14:19:09.423
> 
> 标签：facebook, asp.net-mvc-4, asp.net-membership, membership-provider, custom-membershipprovider

我有一个自定义会员提供程序可以与 ASP.NET MVC 4 一起使用，但是当我想使用 Facebook 等 OAuth 登录时，我遇到了一个错误：

```
To call this method, the "Membership.Provider" property must be an instance of "ExtendedMembershipProvider". 
```

在 ExternalLoginCallback actionresult 中调用函数 OAuthWebSecurity.Login 时会发生这种情况。

我想要让一切正常工作，我需要一个自定义的“ExtendedMembershipProvider”，但我找不到任何关于它的信息，有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T13:51:36.330

`WebMatrix.WebData.ExtendedMembershipProvider`班级

从它继承您的自定义成员资格提供程序并实现您需要的所有成员。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T23:02:30.977

这是使用 ExtendedMembershipProvider 的示例 [https://github.com/mazhekin/MVC4CustomMembershipSolution](https://github.com/mazhekin/MVC4CustomMembershipSolution "https://github.com/mazhekin/MVC4CustomMembershipSolution")

# java - 从java程序访问Eclipse的最简单方法？

> ID：13197024
> 
> 赞同：0
> 
> 时间：2012-11-02T14:19:10.717
> 
> 标签：java, eclipse, eclipse-plugin, eclipse-rcp

假设某个 java 程序在 Eclipse 调试器下运行。

它可以从 Eclipse 访问某些东西吗？例如，Project Explorer 中当前选择的节点？

我需要以最简单的方式访问任何东西。最好来自无关项目（项目，与 Eclipse 插件开发或其他东西无关）中的单个 main() 类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T15:26:56.847

创建一个插件并使用 Manifest Editor 中的“Launch an Eclipse application”启动它（请参阅“测试”部分）。在您的插件中，您可以将 SelectionListener 添加到 ISelectionService。我猜这应该可以解决问题。

参见： http: [//www.eclipse.org/articles/Article-WorkbenchSelections/article.html](http://www.eclipse.org/articles/Article-WorkbenchSelections/article.html)

# facebook-like - Facebook 喜欢页面上的特定照片

> ID：13197028
> 
> 赞同：1
> 
> 时间：2012-11-02T14:19:38.127
> 
> 标签：facebook-like, facebook-opengraph

**语境：**

我有一个摄影驱动网站： http: [//www.camphuwni.com/about-us/activities](http://www.camphuawni.com/about-us/activities)，每张照片都有“照片工具”。您可以使用 AddThis 小部件对每张照片进行置顶、推文、赞或 +1。为每张图片生成的链接是当前 URL+照片的锚点（因此您可以从字面上链接到特定照片）这是一个示例[http://www.camphuwni.com/about-us/typical-day- at-camp#activities-for-kids-what-makes-huawni-unique](http://www.camphuawni.com/about-us/typical-day-at-camp#activities-for-kids-what-makes-huawni-unique)。

**问题：**

我希望能够“喜欢”页面上的特定照片并强制该照片显示为缩略图，以及该特定图像的标题和说明。几乎就像每张照片都有 OpenGraph 标签一样。

我想链接到特定位置的页面，并告诉 Facebook 显示图像标题、标题和缩略图（而不是整个页面的相应数据）。

我应该使用什么样的编程结构或工具来提供类似的按钮来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T14:29:59.137

您需要为每个图像创建一个页面，其中包含该图像的相应打开图形数据，并在“赞”按钮中使用该 URL。

如果您希望访问者在点击后显示在图库页面上，请添加一个 javascript 重定向并为任何可能关闭了 javascript 的浏览器添加一个链接。

# java - Java Prefuse 图将节点复制到另一个图

> ID：13197030
> 
> 赞同：0
> 
> 时间：2012-11-02T14:19:40.083
> 
> 标签：java, graph, prefuse

我在 JPanel 中有一个 2x2 的图形网格。在左上角的图中，我有很多节点，当我单击一个节点时，我希望将该节点复制到下一个图中，以便它出现在那里。首先我正在制作图表然后我将数据添加到左上角的图表然后我通过创建可视化将这些图表附加到面板上，以及基于该可视化的显示。我在显示中添加了一个 ControlListener 来处理单击节点 - 我传递了我希望将节点复制到的图形然后在 itemClicked 方法中，我正在执行 Node node = graph.addNode()。我没有收到任何错误，但我也没有看到该节点。任何想法为什么 - 我必须刷新图表或什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T09:48:35.683

通过在添加节点的可视化效果上运行操作列表来刷新图表。

# sql - 加入查询应该返回一行

> ID：13197033
> 
> 赞同：1
> 
> 时间：2012-11-02T14:19:46.720
> 
> 标签：sql, oracle

我需要编写一个查询来检索我的 ownerid 和 creatorid 的全名（全名可用）。由于两者都引用同一张表，因此它正在检索我两个 rwo。但我需要在一行中同时拥有 ownerid 和 creatorid 全名的全名。这个怎么做？owner id 和 creator id 是 userdetail 表中的参考名称。

创建表页(page_key,page_number,ownerid,creatorid)

创建表 userdetail(id,fullname,phonenumber)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T14:22:03.297

你需要加入表`userdetail`两次，因为你想`fullname`在你的表中获得两个 id`page`

```
SELECT  a.*, 
        b.fullName as OwnerName,
        c.Fullname as CreatorName
FROM    page a
        INNER JOIN userdetail b
            ON a.ownerid = b.id
        INNER JOIN userdetail c
            ON a.creatorID = c.id 
```

还有一件事，如果`ownerid`and`creatorID`可以为 null，请使用`LEFT JOIN`代替`INNER JOIN`.

# jquery - 同步 Jquery ajax 请求不更新元素

> ID：13197040
> 
> 赞同：1
> 
> 时间：2012-11-02T14:19:57.993
> 
> 标签：jquery, html, post

我想遍历我的表中的行，并对每一行具有“警告”类的行发出一个 ajax 请求。到目前为止，这是有效的。

```
rows.each(function (i) {
    $.ajax({
        type: 'POST',
        url: 'ajax/Update/' + $(this).attr('rel'),
        success: function(c) {
            $('.table > tbody > tr.r[rel="' + c.Id +'"]').removeClass('warning').addClass('error');
        },
        dataType: "json",
        async:false
    });
});​ 
```

类警告的删除和类错误的添加只会在主函数结束时显示。有没有办法在`.each`我设置类的那一刻更新循环中的页面内容？我也想更新一个进度条，但是当函数完成时它只是跳到 100%，而不是像每行的 20%。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T17:42:52.240

对不起另一个帐户。我在工作中使用的另一个是因为我在那里没有我的帐户详细信息。

我在 jsFiddle 上做了一个简单的例子。

[http://jsfiddle.net/m94Ay/3/](http://jsfiddle.net/m94Ay/3/)

```
$('#Save').click(function () {
    var persons = $('.table > tbody.persons > tr.warning');
    if (persons.length == 0) {
        alert("Choose some persons please.");
        return;
    }
    var step = 100 / persons.length;
    var i;
    persons.each(function (i) {
        $(this).removeClass('warning').addClass('error');
        sleep(1000);
    });
}); 
```

检查表中的三个或四个人，然后按保存。似乎不是每秒都删除和添加类，而是在 4 秒后将所有类设置在一起。

我只是用 sleep 模拟了 ajax 帖子，因为效果保持不变。

# reporting-services - SSRS 本身的本地化（不是报告）

> ID：13197041
> 
> 赞同：2
> 
> 时间：2012-11-02T14:19:59.997
> 
> 标签：reporting-services, localization

我想本地化 SSRS*本身*（不是报告），但看起来以前没有人做过或要求过类似的事情。

我想翻译 SSRS 页面上的所有主要文本，通过这样的 URL 访问：

```
http://yourssrs.com/reports 
```

在这样的页面上，您可以看到“主页”、“数据视图”、“搜索”、“帮助”、“新建文件夹”、“报表生成器”“我的订阅”等链接和按钮。

我想全部翻译。是否有用于此的语言文件或类似的东西来翻译 SSRS？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T09:12:23.407

您正在寻找此 MSDN 页面：[多语言或全球部署的解决方案设计注意事项 (Reporting Services)](http://msdn.microsoft.com/en-us/library/ms156493%28v=sql.100%29.aspx)。您提到的功能主要是报告管理器项目（我认为），根据提到的文章，这些项目是基于客户端浏览器语言本地化的：

> 客户端浏览器中的语言和区域设置确定用于以下用途的语言资源：
> - 报表管理器
> - 报表查看器工具栏
> - 我的报表文件夹名称
> - 报表服务器文件夹层次结构和报表服务器内容类型的本地化元素，当访问报表服务器 Web 服务时通过浏览器窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-13T09:11:25.493

死灵术。
即使用户使用另一种语言，您也可以这样做。

秘诀是将所需语言的参数传递给 ssrs 页面。
然后，您可以创建一个 http 模块，从 URL/referrer 获取语言（注意：HTTP 错误拼写 referrer as referer）

示例代码：

[https://github.com/ststeiger/SSRS-Localizer/blob/master/libRequestLanguageChanger/RequestLanguageChanger.cs](https://github.com/ststeiger/SSRS-Localizer/blob/master/libRequestLanguageChanger/RequestLanguageChanger.cs)

（此代码还设置 P3P 标头，因为如果页面是从不同域上的页面构建的，则这对于 IE 中的 SSRS-cookies 是必需的）

如果浏览器语言与用户语言不对应，这会将 SSRS 设置为正确的本地化模式。

如果需要，除此之外，您还可以更改 ReportViewer，通常位于

```
C:\Program Files\Microsoft SQL Server\MSRS<whatever>\Reporting Services\ReportServer\Pages\ReportViewer.aspx 
```

并使用 JavaScript 翻译报告的参数标签。

注意：如果您只更改 ReportViewer.aspx 方法中的文化

```
protected override void InitializeCulture() 
```

那么日期选择器将不起作用。
因此，您需要将其作为 http-module 运行（如果它加载资源，例如 jquery-ui，则需要从 refer[r]er 获取语言）。

# css - 如何防止 FireFox 16 将旋转和缩放变换转换为矩阵变换？

> ID：13197042
> 
> 赞同：2
> 
> 时间：2012-11-02T14:20:02.777
> 
> 标签：css, animation, matrix, transform, firefox-16

如果 Mozilla 不打算对 FireFox 16 的渲染引擎进行向后兼容的新更改，我如何防止浏览器将 CSS3 非矩阵转换转换为矩阵？

下面是一个例子，说明它如何影响基于 JavaScript 的动画，以及它为什么对我很重要。

从我的 support.mozilla.org[问题中粘贴](http://support.mozilla.org/en-US/questions/941008)

转到[pilatch.com/cards](http://pilatch.com/cards)并单击弧中的任何卡片。现在在 Chrome、Safari 或 IE 9 中执行相同的操作。我已经对我所有的 JavaScript 进行了清理，因此您可以更轻松地看到发生了什么。

FireFox 16 版中的 CSS3 转换正在转换为矩阵转换。它几乎让我的旋转和缩放动画感到厌烦。例如，如果您将元素的样式属性设置为 style="transform:scale(0.75)"，FireFox 会立即将该元素的变换属性（例如 .style.transform）转换为“matrix(...)” .

我知道如何进行线性代数，通过 jQuery cssHooks 将旋转和缩放转换为矩阵转换，我什至编写了代码来检测浏览器的这个“功能”（它强制转换为矩阵），并返回一个过去两天在我的开发站点上编写矩阵变换而不是旋转变换或缩放的不同钩子。

然而，事实证明，让这个新特性与 jQuery 的动画兼容变得越来越具有挑战性。更进一步，我可能不得不破解 jQuery 以使其适用于 FireFox，或者完全放弃对 FireFox 动画的支持，除非某些 FireFox 开发人员使他们的新实现向后兼容。

我知道转换通常会在渲染引擎的幕后转换为矩阵。把你的矩阵放在那里。不要覆盖用户为转换输入的内容！

我也知道我应该使用 CSS3 动画，但是，dangit，我在这些动画得到广泛支持之前就开始了这个项目。我不能重写我所有的动画，因为我想支持 FireFox。这不是一个真正的选择。我会将我的用户引导至 Chrome。我在开发中还有更多使用这些类型的动画的功能，而且我已经陷入了太深而无法回头的境地。

# c++ - 从列表中查找到一个参考列表的最近点

> ID：13197045
> 
> 赞同：1
> 
> 时间：2012-11-02T14:20:05.667
> 
> 标签：c++, algorithm, stl

我有成对的 int 坐标列表，例如

```
list<pair<int,int> > coordinates; 
```

我需要找到离一个点原点最近的点，

```
class Point{
public:
float x;
float y;
}; 
```

我可以找到自定义比较器对象和排序，但我想知道 min 是否有更快的方法？我试过了

```
class DistanceComparator{
public:
    DistanceComparator(const Point& p){origin=p;}
    inline bool operator<(std::pair<int,int> & lhs,std::pair<int,int > & rhs)
    {
        float deltaX1=lhs.first-origin.x;
        float deltaY1=lhs.second-origin.y;
        float deltaX2=rhs.first-origin.x;
        float deltaY2=rhs.second-origin.y;
        return (deltaX1*deltaX1+deltaY1*deltaY1)<(deltaX2*deltaX2+deltaY2*deltaY2);
    }
private:
    Pointorigin;
}; 
```

但是 < 只需要一个参数。这个怎么做 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-02T14:24:10.390

您的解决方案是次优的，因为它需要对整个列表进行排序，而这是不需要的。你只需要最小的元素，其余的不需要排序。我是否建议您查看`std::partial_sort`或只是去突击队并遍历它（`O(n)`而不是`O(n*log(n))`排序）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T15:08:16.257

正如 Luchian Grigore 已经说过的，您不应该对点列表进行排序。但是，我想在这里解决您的语法问题。

您不能将比较运算符作为比较*其他*两个对象的类*成员。*您只有两种可能来定义比较运算符：

 *1.  作为左侧操作数`bool T::operator<(const U& rhs) const`的成员函数。`this`（我认为 const-reference 是可选的，但当然强烈推荐。）请注意，`T == U`这不一定是真的。

2.  非成员函数`bool operator<(const T& lhs, const U& lhs) const`又`T == U`不一定是真的。

所以你**不能**有一个比较运算符来访问你想要的三个对象：两个操作数，有点像一个可以**参数化**比较的“上下文”。

为了解决这个问题，我知道以下两种解决方案（可能不止这些）：

1.  开始使用比较运算符时，将附加参数设置为**全局变量。**当然，这很脏（全局变量在 OOP 中总是脏的）并且使排序不可重入。由于它太脏了，我永远不会推荐它（但它仍然是一个*可能的*解决方案），因此我不会在这里给出示例代码。

2.  使用**谓词**而不是`operator <`. 有多种方法可以做到这一点。这里有两个：

    *如果您有可用的 c++0x / c++11：*使用*lambda 函数*，该函数可以从客户端上下文（您运行的位置`std::sort`）捕获附加参数：

    ```
    Point origin = ...;
    std::sort(..., [origin](const Point & a, const Point & b){
        return distance(a, origin) < distance(b, origin);
    }); 
    ```

    *如果您没有可用的 c++0x / c++11：*您仍然可以定义自定义谓词以自定义方式比较两个对象，而无需 lambda 函数。您必须定义一个比较器助手类：

    ```
    // Helper class:
    struct PointDistanceComparator {
        PointDistanceComparator(Point origin) : origin(origin) {}
        bool operator() (const Point & a, const Point & b) const {
            return distance(a, origin) < distance(b, origin);
        }
    private:
        Point origin;
    };

    // Client code:
    Point origin = ...;
    std::sort(..., PointDistanceComparator(origin)); 
    ```

    当然，您可以（像您一样）优化代码以不使用平方根来计算距离。示例代码应该只让您了解如何对一般比较进行参数化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T03:12:06.253

如果您需要多次查询坐标列表，您可能需要考虑使用**Kd-tree**进行最近邻搜索。这将具有**O(log n)**时间复杂度。构建和查询 Kd 树大约需要 15-20 行（可读）C++ 代码。看看[Kd-tree wikipedia article](http://en.wikipedia.org/wiki/K-d_tree) 也看看`std::nth_element`，你可以使用它来有效地构建你的 Kd-tree （选择支点和分区容器（左右子项，请参阅 wikipedia 文章中的 python 代码） .

**更新**：我使用 K-最近邻搜索创建了一个[C++ N 维 Kd 树实现。](https://github.com/gvd/kdtree)它包括一些单元测试，向您展示如何使用它。*

# facebook - Facebook 应用程序 $data["user_id"] 在移动设备上为空

> ID：13197048
> 
> 赞同：2
> 
> 时间：2012-11-02T14:20:14.690
> 
> 标签：facebook

我创建了一个运行良好的应用程序 - 但不能在移动设备上运行。用户登录我的应用程序后，我陷入了一个循环， $data["user_id"] 似乎是空的。这是我正在使用的代码片段：

```
 $canvas_page = 'https://m.facebook.com/apps/'.$app_id;

 $auth_url = "https://www.facebook.com/dialog/oauth?client_id=" 
   . $app_id . "&redirect_uri=" . urlencode($canvas_page)
   . "&scope=user_birthday";

    $signed_request = $_REQUEST["signed_request"];

    list($encoded_sig, $payload) = explode('.', $signed_request, 2); 

    $data = json_decode(base64_decode(strtr($payload, '-_', '+/')), 
    true);

  if (empty($data["user_id"])) {
    echo("<script> top.location.href='" . $auth_url . "'</script>");
    } 
```

有人知道为什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T17:39:12.780

我不完全确定它`signed_request`是否已发布到移动应用程序，它未列在接收它的应用程序类型中：
[https](https://developers.facebook.com/docs/howtos/login/signed-request/)
://developers.facebook.com/docs/howtos/login/signed-request/ 但是，如根据该文档，您的 if 语句可能应该寻找`$_REQUEST`自身的存在，而不是专门寻找`user_id`.

# gdata - 在 C# 中使用 Google.GData 更新 POP3 设置

> ID：13197054
> 
> 赞同：0
> 
> 时间：2012-11-02T14:20:20.593
> 
> 标签：gdata, google-email-settings-api

我正在使用 C# 创建一个桌面应用程序。我已经下载了`Google.GData.Application`开始使用 API。从[这个链接](https://developers.google.com/google-apps/email-settings/#manage_pop_settings)我找到了这段代码：

```
 var service = new GoogleMailSettingsService("my domain", "API KEY");
            service.setUserCredentials("my username", "my pass");

            var res = service.UpdatePop("my username", "true", "ALL_MAIL", "KEEP"); 
```

我创建了一个简单的控制台应用程序并运行了这段代码（它是唯一运行的代码）。`403`但是，每当我运行它时，我都会收到状态码异常。我的问题是：

1.  我做错了什么吗？我的意思是，我需要采取任何其他步骤吗？我从[这里](https://accounts.google.com/ManageDomain)`my domain`得到了和`API key`零件。我注册了一个域并添加了代码和信息以获取代码。

2.  有什么办法不使用我的域名？这个应用程序不适合我，也不是特定域上的网络应用程序。它是一个桌面应用程序，预计可以在任何安装了 .Net 的机器上运行。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T20:56:42.827

确保与您进行身份验证的用户是 Google Apps 域的管理员。

使用 ClientLogin 时不需要 API 密钥（即使用用户名/密码进行身份验证），GoogleMailSettingsService 构造函数的第二个参数只是一个标识您的应用程序的字符串。

# php - 如何在 PHP 中的插入查询中使用 where 语句来表示 NOT NULL VALUE

> ID：13197056
> 
> 赞同：0
> 
> 时间：2012-11-02T14:20:23.730
> 
> 标签：php, mysql, phpmyadmin

这是我在 PHP 中的查询，如果 RATE 字段为 NULL，我想做什么，那么记录可能不会插入到我的 MYSQL 表中。我的查询在这里不起作用。它说在 WHERE 附近检查语法。它工作正常没有 where.I 有 PHPMYADMIN。

```
$sql = "INSERT INTO `order`(`po_number`, `vendor_name`, `market`, `start_date`, `end_date`, `qty`, `rate`, `comment`, `media_type`, `sub_vendor`) VALUES ('$po_number1[$i]','$master_vendor1[$i]','$market1[$i]','$start_date1[$i]','$end_date1[$i]','$qty1[$i]','$rate1[$i]','$comment1[$i]','$media_type1[$i]','$sub_vendor1[$i]') WHERE `rate` IS NOT NULL"; 
```

任何帮助将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T14:23:27.413

`INSERT`语句不包含`WHERE`. 您应该使用`UPDATE`或使用 PHP 更改插入

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T14:24:21.760

你不能在这样的查询`WHERE`上有一个子句。`INSERT INTO`在执行插入查询之前，您必须执行任何条件逻辑。插入查询会添加一个新行，因此根据定义，将没有行来评估`WHERE`子句。你要`UPDATE`查询吗？

```
$errors = array(); // declare this before your loop

if($rate1[$i] == 0 || $rate1[$i] == null)
{
    // rate is 0 or null, add error
    $errors[] = 'Rate is invalid';
}
else
{
    $sql = "INSERT INTO `order`(`po_number`, `vendor_name`, `market`, `start_date`, `end_date`, `qty`, `rate`, `comment`, `media_type`, `sub_vendor`) VALUES ('$po_number1[$i]','$master_vendor1[$i]','$market1[$i]','$start_date1[$i]','$end_date1[$i]','$qty1[$i]','$rate1[$i]','$comment1[$i]','$media_type1[$i]','$sub_vendor1[$i]')";
    // execute $sql
} 
```

完成循环后，您可以显示任何错误：

```
<ul>
    <?php foreach($errors as $e): ?>
    <li><?php echo $e; ?></li>
    <?php endforeach; ?>
</ul> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T14:24:07.393

没有条件插入之类的东西。您需要确保插入的内容是正确的。因此，遍历您的集合并仅插入符合您条件的行

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-02T14:25:35.863

在遇到创建连接和发出查询的开销之前，您可能会在 PHP 中检查这一点：

```
if (isset($rate1[$i])) {
    // prepare and execute the insert
} else {
    echo 'Rate cannot be null';
} 
```

# django - Visual Studio 2012 中的 Django

> ID：13197058
> 
> 赞同：1
> 
> 时间：2012-11-02T14:20:33.687
> 
> 标签：django, visual-studio-2010, azure, visual-studio-2012

我的机器中有 Visual Studio 2012。我刚刚下载了[此页面上提供的 Windows 安装程序](http://www.windowsazure.com/en-us/develop/python/)。当我运行它时，它显示它可以为 Visual Studio 2010 安装 Python 工具和其他一些东西（除了 Azure SDK）。

**问：**这个安装程序和这些工具是否也可以在 Visual Studio 2012 上运行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T15:54:16.927

不，

但是，当您从上述链接打开 Web 平台安装程序 (PI) 时，您将能够看到 Visual Studio 2012 的相同工具/sdk 的选项。明确命名为“for VS 2010”的内容不会在 VS 2012 上运行.

# eclipse - 将 Eclipse RCP 3 应用程序移植到 e4，哪些包不能重用？

> ID：13197063
> 
> 赞同：2
> 
> 时间：2012-11-02T14:20:40.437
> 
> 标签：eclipse, eclipse-rcp

我正在将基于 Eclipse RCP 3 构建的现有应用程序移植到 RCP e4。目标是创建一个纯 e4 应用程序。

我一直无法找到一个连贯的列表，其中列出了哪些 RCP 相关包不应该在纯 e4 应用程序中使用。有没有人有什么不使用的清单或知道在哪里可以找到这样的清单。在我的搜索中，我发现了一些不使用的东西，但没有任何东西看起来是完整的。由于我刚刚开始在端口上工作，我宁愿现在而不是以后处理仅删除 RCP 3 的包。

谢谢你的帮助。

保罗

# c# - c#中javascript代码的全局替换

> ID：13197066
> 
> 赞同：0
> 
> 时间：2012-11-02T14:20:44.327
> 
> 标签：c#, javascript

我想在 c# 中为下面的 java 脚本代码执行全局替换等效代码

```
text=text.replace(/-/g, ''); 
```

我怎样才能做到这一点？

javascript中的全局替换实际上意味着这个

```
var str="Mr Blue has a blue house and a blue car";
var n=str.replace(/blue/g,"red");

Mr Blue has a red house and a red car 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T14:24:06.977

```
text = text.Replace( "-", "" ); 
```

是否进行全局替换，如此处的示例所示：http: [//msdn.microsoft.com/en-us/library/fk49wtc1.aspx](http://msdn.microsoft.com/en-us/library/fk49wtc1.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T14:23:54.103

将`output`包含更新的字符串。

`string output = Regex.Replace(text, "-", "");`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-02T14:24:17.647

尝试这个：

```
text = text.Replace("-", ""); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-02T14:25:15.063

```
string s = s.Replace("scary", "not scary"); 
```

# python - 将控制台输出写入python中的文件

> ID：13197068
> 
> 赞同：1
> 
> 时间：2012-11-02T14:20:53.037
> 
> 标签：python, regex, formatting, output

**对不起这个问题，我知道这是一个反复出现的话题，但我无法解决我的问题，事实上，这很容易描述：我想将执行的输出原样**写入文件。我的意思是，我有这样的输出（对不起，混乱）：

```
.251.242.133|:80... connected.\r\nHTTP request sent, awaiting response... 200 OK\r\nLength: 2371567 (2.3M) [application/x-gzip]\r\nSaving to: `110907_ERP000591.tar.gz\'\r\n\r\n\r 0% [                                       ] 0           --.-K/s              \r 0% [                                       ] 23,003       104K/s              \r 3% [>                                      ] 82,863       184K/s              \r 8% [==>                                    ] 192,363      282K/s              \r15% [=====>                                 ] 371,943      411K/s              \r26% [=========>                             ] 634,175      563K/s              \r39% [==============>                        ] 925,283      680K/s              \r52% [===================>                   ] 1,250,295    790K/s              \r63% [=======================>               ] 1,497,035    830K/s              \r73% [===========================>           ] 1,732,663    861K/s              \r81% [==============================>        ] 1,937,063    867K/s              \r88% [=================================>     ] 2,099,123    855K/s              \r95% [====================================>  ] 2,268,483    847K/s              \r100%[======================================>] 2,371,567    849K/s   in 2.7s    \r\n\r\n2012-11-01 15:34:10 (849 KB/s) - `110907_ERP000591.tar.gz\' saved [2371567/2371567]\r\n\r\n110907_ERP000591/\r\n110907_ERP000591/1_110907_ERP000591_2_fastq.txt\r\n110907_ERP000591/1_110907_ERP000591_1_fastq.txt\r\n/home/travis/opt/bcbb/nextgen/tests/data/automated/../100326_FC6107FAAXX\r\n--2012-11-01 15:34:10--  http://chapmanb.s3.amazonaws.com/100326_FC6107FAAXX.tar.gz\r\nResolving chapmanb.s3.amazonaws.com (chapmanb.s3.amazonaws.com)... 205.251.242.133\r\nConnecting to chapmanb.s3.amazonaws.com (chapmanb.s3.amazonaws.com)|205.251.242.133|:80... connected.\r\nHTTP request sent, awaiting response... 200 OK\r\nLength: 7014592 (6.7M) [application/x-gzip]\r\nSaving to: `100326_FC6107FAAXX.tar.gz\'\r\n\r\n\r 0% [                                       ] 0           --.-K/s              \r 0% [                                       ] 17,163      77.9K/s              \r 0% [                                       ] 64,775       147K/s              \r 2% [                                       ] 174,843      263K/s              \r 5% [=>                                     ] 399,683      456K/s              \r12% [===>                                   ] 866,883      790K/s              \r25% [========>                              ] 1,798,363   1.33M/s              \r45% [================>                      ] 3,178,955   1.90M/s              \r65% [========================>              ] 4,592,803   2.41M/s              \r65% [========================>              ] 4,629,303   2.17M/s              \r67% [=========================>             ] 4,761,595   2.02M/s              \r74% [============================>          ] 5,245,423   2.03M/s              \r83% [===============================>       ] 5,862,435   2.08M/s              \r100%[======================================>] 7,014,592   2.46M/s   in 2.7s    \r\n\r\n2012-11-01 15:34:13 (2.46 MB/s) - 
```

因此，如您所见，我有一个格式奇怪的输出，在终端中显示如下：

```
 /home/travis/opt/bcbb/nextgen/tests/data/automated/../100326_FC6107FAAXX
--2012-11-01 15:34:10--  http://chapmanb.s3.amazonaws.com/100326_FC6107FAAXX.tar.gz
Resolving chapmanb.s3.amazonaws.com (chapmanb.s3.amazonaws.com)... 205.251.242.133
Connecting to chapmanb.s3.amazonaws.com (chapmanb.s3.amazonaws.com)|205.251.242.133|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 7014592 (6.7M) [application/x-gzip]
Saving to: `100326_FC6107FAAXX.tar.gz'

100%[======================================>] 7,014,592   2.46M/s   in 2.7s    

2012-11-01 15:34:13 (2.46 MB/s) - `100326_FC6107FAAXX.tar.gz' saved [7014592/7014592] 
```

好多了...我想用这种形式将输出写入文件，所以我不能只去掉 \r\n 或类似的东西，因为这种方式会在下载过程中的每一步出现一行。我只想写一个带有最终输出的文件。

有什么帮助吗？

**编辑：**

抱歉，我应该更清楚一点：这不是命令的结果，而是如下所述的解析 json 文件的结果。您可以重现输出：

```
 import urllib
import json

string_to_write = json.loads(urllib.urlopen('https://travis-ci.org/jobs/3019024.json').read())['log'] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T14:41:35.180

这应该有效：

```
re.sub(r"(?m)^.*\r(?!$)", "", text) 
```

该`(?m)`标志表明这是一个多行正则表达式，以便匹配每行的开头`^`和`$`结尾，而不是整个文本。

因此，我们匹配`.*`从行`^`首到包括回车在内的所有内容`\r`，除非该回车紧跟在行尾`(?!$)`- 就像您的文本包含 CRLF 换行符一样。并且，用空字符串替换匹配项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T14:32:35.873

看起来您使用的是 *NIX 系统。如果此输出是通过在命令行上运行`progn`（实际上可能是`python myscript.py`）生成的，您可以轻松地执行以下操作：

```
progn > logfile 
```

这样， 的输出`progn`被保存到`logfile`不剥离任何字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T16:05:48.953

如果您只想删除终端上隐藏的内容，那么您可以试试这个->

```
# t is your text
''.join([i for i in t.split('\r') if i.startswith('\n') or i.startswith('100%')]) 
```

解决方案很棘手（！）但我认为它可能对你有用。

# c# - 如何使用 .NET 和 C# 导入 XML 数据

> ID：13197071
> 
> 赞同：0
> 
> 时间：2012-11-02T14:20:57.783
> 
> 标签：c#, .net, xml, visual-studio-2010, xsd

我有一组 xsd 文件和 xml 数据文件。我需要将数据从 xml 文件导入数据库。我有 .NET 4.0 和 Visual Studio 2010。

我可以使用哪些工具？理想情况下，它应该是一些东西，它可以帮助我将数据作为由 xml 结构组成的实体来读取。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T14:23:56.343

我会考虑使用`xsd.exe`来生成符合 xsd 中指定格式的 c# 类。从那里您可以使用 .Net 中的 XmlSerialization 对象来水合从 .Net 生成的类的一些对象`xsd.exe`。然后，您可以从那里在您的 c# 代码中解析您的对象。

这是一个可能有帮助的链接：http: [//blogs.msdn.com/b/yojoshi/archive/2011/05/14/xml-serialization-and-deserialization-entity-classes-with-xsd-exe.aspx](http://blogs.msdn.com/b/yojoshi/archive/2011/05/14/xml-serialization-and-deserialization-entity-classes-with-xsd-exe.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-12T08:50:06.083

使用最新的 VS 版本，不再需要使用 xsd.exe。

看题目： [XML 2 CS](https://stackoverflow.com/questions/364253/how-to-deserialize-xml-document) 在评论中使用方法2

# java - Datanucleus jdoql 组通过具有 avg()

> ID：13197072
> 
> 赞同：2
> 
> 时间：2012-11-02T14:21:14.787
> 
> 标签：java, group-by, datanucleus, jdoql

我正在尝试编写一个查询，返回员工平均工资在指定范围内的所有部门。

我有这样的事情：

```
Query query = pm.newQuery(Employee.class);
query.setResult("department, avg(salary)");
query.setGrouping("department HAVING avg(salary) >= :x && avg(salary) <= :y");
query.setOrdering("2 desc"); 
```

问题是，在 HAVING 中再次计算了 avg(salary)，所以如果 avg(salary) 在范围内，我会得到所有部门，否则我会得到空的结果列表。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T20:25:51.550

实际上它自 3.2.0-m4 版本以来已修复看这里：[http ://www.datanucleus.org/servlet/jira/browse/NUCRDBMS-623](http://www.datanucleus.org/servlet/jira/browse/NUCRDBMS-623)

# wpf - 在 Caliburn.micro 中切换 Viewmodels/Views 的简单方法

> ID：13197076
> 
> 赞同：1
> 
> 时间：2012-11-02T14:21:24.203
> 
> 标签：wpf, mvvm, caliburn.micro

几天前我问[了这个问题](https://stackoverflow.com/questions/13088358/mvvm-use-new-windows-or-views)，但答案让我更加困惑。所以我会问一个更简单的问题：

（我正在使用 Caliburn.Micro，这是一个 WPF 应用程序）。假设您有一个 MainView/MainViewModel，它具有子 AView/AViewModel 和 BView/BViewModel。您的 MainView 是一个网格，并且是您要使用 AView 或 BView 填充的单元格之一，具体取决于用户选择。如果我只想显示 AView，我会执行以下操作：

在主视图中：

```
<StackPanel Name="SP_Controls" VerticalAlignment="Bottom" Grid.Row="1" Grid.Column="0">
    <ContentControl Name="ViewModelToShow" Margin="10" />
</StackPanel> 
```

在 MainViewModel 中：

```
public AViewModel ViewModelToShow{get; set;} 
```

我现在天真的想法是做这样的事情：

```
private AViewModel _AVM;
private BViewModel _BVM;

public ... ViewModelToShow{ get; set;} 
```

然后在代码中，例如，将视图模型设置为显示：

```
ViewModelToShow = _BVM; 
```

我唯一的问题是“...”，因为每个 ViewModel 都属于不同的类。有没有办法用泛型来做到这一点，或者我应该为我的 ViewModel 定义一个基类，然后将它们投射到其中？但如果我这样做，它们仍然会正确显示吗？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-02T21:31:17.533

您的视图模型应该继承自`PropertyChangedBase`, 或`Screen`. `Screen`继承自`PropertyChangedBase`，也实现`IScreen`. `Screen`添加生命周期（即`OnActivate`等）。

然后，您可以使用您的方法，即拥有一个名为 eg 的公共属性`CurrentViewModel`，其类型为`IScreen`。然后，您可以在需要时将其设置为适当的视图模型。请注意，如果您希望 UI 正确更新，则该`CurrentViewModel`属性应在引用更改时在 setter 中调用。`NotifyOfPropertyChange`

或者，您可以将父视图模型视为两个子视图模型的导体，并使用内置的 Caliburn.Micro`Conductor`类型。例如，派生自`Conductor<IScreen>.Collection.OneActive`.

然后，您可以将 2 个子视图模型添加到父`Items`集合中，并调用该`ActivateItem`方法来设置当前视图模型。然后更新您的视图`ContentControl`以具有`x:Name`of `ActiveItem`。

请参阅[此处](https://caliburnmicro.com/documentation/composition)了解更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T10:42:52.387

以上所有答案都是正确的。就视图位置的工作方式而言，属性类型无关紧要。只有实例的运行时类型很重要。因此，您甚至可以将属性定义为 object 类型，它仍然可以工作。只需确保您的财产发出变更通知即可。在导体的情况下，ActiveItem 会为您处理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T10:49:17.700

我通常从 ViewModelBase 类继承。它是一个包含所有属性更改的类。但由于视图上的 DataContext 属性只是一个对象，因此类型并不重要。

# javascript - 使用 javascript 的 Windows 8 Metro 应用程序中的 Webview

> ID：13197078
> 
> 赞同：2
> 
> 时间：2012-11-02T14:21:23.490
> 
> 标签：javascript, html, webview, microsoft-metro

我目前正在开发一个 Windows 8 Metro 应用程序（javascript、HTML5），它应该在单独的 web 视图中显示特定网站。不幸的是，我没有找到任何关于如何向应用程序添加 Web 视图的描述。请你帮帮我好吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T14:24:01.807

Webviews 不适用于 WinJS。但是，您可以将`iframe`其用作替代方案。但是，并不是所有的网站都可以嵌入到`iframe`s 中。

```
<iframe src=""></iframe> 
```

# c++ - 在 C++ 中交换多维数组

> ID：13197081
> 
> 赞同：2
> 
> 时间：2012-11-02T14:21:45.360
> 
> 标签：c++, c, pointers, multidimensional-array

（注意：我目前正在学习 C++，所以如果有更好的方法来做我正在做的事情，解释会很有帮助。）

我正在用 C/C++ 制作康威的生命游戏，并有以下代码：

```
bool ** previous;
bool ** current;

void init() {
    previous = new bool*[width];
    current = new bool*[width];
    for (int i =0; i < width; i++) {
        previous[i] = new bool[height];
        current[i] = new bool[height];
    }
} 
```

动态数组的原因是宽度和高度由用户在运行时给出。如果我有一维数组，我可以执行以下操作：

```
bool * previous;
bool * current;

void () {
    bool * temp = current;
    current = previous;
    previous = temp;
} 
```

但是，这种方法在二维数组中并不如所希望的那样工作。由于它在技术上是一个数组数组，我是否必须单独交换每个子数组指针？有没有更好的方法来定义多维数组并交换它们？

编辑：我还没有真正使用任何 C++ 特定的功能，所以如果我可以在纯 C 中做到这一点，我更喜欢那个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T14:30:48.517

这里没有真正的理由打扰数组数组。正确维护和销毁需要大量的工作，尤其是当您避免使用标准库容器来为您处理大量内存管理时。

通常更容易`width * height`在单个数组中分配单元格并引用它们，就像你的列`cell[x + width * y]`在哪里，你的行在哪里。`x``y`

请记住，在此问题的特定情况下，您想要的是位数组而不是布尔数组。C++ 确实有一个值得使用的位集的[特殊情况容器](https://stackoverflow.com/questions/6781985/is-the-use-of-stdvectorbool-objects-in-c-acceptable-or-should-i-use-an-al)`std::vector<bool>`： .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T17:22:15.377

这有效：

```
int arr1[10][10],arr2[10][10]

//Swap 2nd row between arrays
std::swap(arr1[2], arr2[2]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T00:02:24.140

虽然早期的答案在技术上是正确的，但它们似乎并没有回答你原来的问题。您说“这种方法对二维数组不起作用”，但为什么以下方法不起作用？

```
void () {
    bool ** temp = current;
    current = previous;
    previous = temp;
} 
```

如果您不介意使用 c++ 功能，那么 std::swap 函数会派上用场：

```
std::swap(current, previous); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-02T14:28:30.873

如果它是 C++ 使用`std::vector`'s 并忘记堆分配、纯数组、memcpy 和复制/赋值运算符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-02T14:30:31.530

为什么不使用数组的数组，而不是使用 size 的一维数组`width*height`？

只需通过 访问您的元素`y*width + x`。

像往常一样使用 分配数组`malloc(width*height*sizeof(bool))`。这应该足以解决您的问题

# java - 原始类型类的用途/目的是什么？

> ID：13197084
> 
> 赞同：12
> 
> 时间：2012-11-02T14:21:49.523
> 
> 标签：java, class, primitive

我最近了解到JVM 中有基本类型的[类](http://docs.oracle.com/javase/6/docs/api/java/lang/Class.html)表示。例如，`int.class`，`double.class`，甚至是`void.class`。

我不明白*为什么会有*这些。它们似乎没有任何功能性作用。使用反射，我搜索了类，它们没有构造函数、方法和字段。出于所有意图和目的，它们似乎是空的和无用的。原始类型变量甚至不是它们各自类的实例，如以下返回 false 所示：

```
int a = 3;
int.class.isInstance(a); 
```

那么它们为什么存在呢？它们必须服务于某种目的，也许是为了编译器或其他东西，但无论它是什么，都完全超出了我的范围。`int.class`在[Integer API](http://docs.oracle.com/javase/6/docs/api/java/lang/Integer.html#TYPE)中甚至有一个明确的引用（对于每个原始类型及其各自的包装对象也是如此）。我在 JLS 中找不到任何关于它们存在的参考，更不用说它们的使用了。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-02T14:24:30.893

> 我不明白为什么会有这些。

考虑以下：

```
public int foo() {
    return 0;
}

...

Method method = someClass.getDeclaredMethod("foo");
Class<?> clazz = method.getReturnType(); 
```

如果没有 的`Class`表示`int`，上面会返回什么？它不应该返回`Integer.class`，因为它们*不是*同一件事。（想象一下，试图区分被重载的方法，一个带有一个参数`int`，一个带有一个`Integer`参数。）

我以前使用这些类在通过反射调用它们时为参数提供默认值。根据参数类型，我使用`null`了任何引用类型，以及每个原始类型的一些（显然是装箱的）原始值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T15:14:51.200

这是一个廉价的解决方案，结果很糟糕。

在 1.5 之前，Java 类型可以分类为

```
java type
    primitive type
    reference type
        class type (including interface)
        array type 
```

那么理想情况下，java 反射应该提供 5 个概念来反映这 5 种类型。但是他们用一个单一`Class`的来表示它们，包括原始类型和数组类型。所以 a`Class`并不一定意味着一个类。

那还是可控的。但是在 1.5 之后，Java 类型变得更加复杂，所以`Type`引入了一个新的。不幸的是，他们决定创建`Class`一个`Type`;的子类型，而不是直接反映语言规范的新的和干净的层次结构。不仅旧的混乱被带入，它还产生了一些新的混乱，整个`Type`层次结构令人费解。

# javascript - 如何避免 iPhone 上的页脚出现奇怪的图案？

> ID：13197087
> 
> 赞同：1
> 
> 时间：2012-11-02T14:21:52.790
> 
> 标签：javascript, iphone, css

我的网站[http://www.domda.se](http://www.domda.se)有问题，该网站仅存在于 iphone 上，而不存在于桌面上。我认为这与页脚中的某些脚本有关，这些脚本已应用 display:none。我是对的还是完全错的？感谢您在这个神秘问题上的帮助。（试图附加截图，但不幸的是我还不能发布图片。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T14:34:52.037

您看到的图案是您在左下角的桌面版本上也注意到的小笑脸。

笑脸在媒体查询中听取您的响应式 CSS：

```
body img {
  width: 100%;
} 
```

并拉伸到 100%，创建图案。添加类似的东西

```
#wpstats {
  width: auto;
} 
```

覆盖笑脸的 100% 拉伸。

# eclipse - 在eclipse中创建新的GWT项目时，如何解决“项目路径必须只有一个段”错误？

> ID：13197092
> 
> 赞同：1
> 
> 时间：2012-11-02T14:22:09.403
> 
> 标签：eclipse, gwt, google-plugin-eclipse

我在 Windows 7 上使用带有 GWT SDK 2.3 的 Eclipse Helios。我有几个 GWT 项目使用相同的 GWT SDK。这些项目是几年前创建的。我正在尝试创建一个新的“Web 应用程序项目”（又名 GWT 或 GAE 项目），当我这样做时，出现以下错误：

> 创建元素失败。
> 
> 项目路径必须只有一个段。

我输入了项目名称和包并取消选中 GAE 框。我怀疑问题出在 GWT 路径中的空格上，因为在“使用默认 SDK”单选按钮之后它有“（gwt-2.3.0 - 2.3.0）”。如果我单击 GWT 部分中的“配置 SDK”，则 GWT SDK 对话框内的网格包含名称、版本和位置列，看起来它正在创建它（gwt-2.3.0 - 2.3\. 0) 来自名称和版本。

我已将 Google 插件更新到最新版本。我已经下载了 GWT SDK 2.5 并尝试使用该 SDK 创建一个项目。我尝试了一个未选中 GWT 并选中 GAE 的新“Web 应用程序项目”。所有都会导致相同的问题。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-03-29T08:02:35.263

我遇到了同样的问题，在我的 pom.xml 文件中我没有指定工件，见下文：

```
<groupId>com.example</groupId>
<artifactId></artifactId>
<version>0.0.1-SNAPSHOT</version>
<packaging>jar</packaging> 
```

在这种情况下，eclipse 将项目读取为：

> com.example：：0.0.1-SNAPSHOT

但是，如果您指定如下的工件

```
<groupId>com.example</groupId>
<artifactId>abc</artifactId>
<version>0.0.1-SNAPSHOT</version>
<packaging>jar</packaging> 
```

Eclipce 将其导入为

> com.example:org:0.0.1-SNAPSHOT

# python - Python 中的 R 预测包

> ID：13197097
> 
> 赞同：1
> 
> 时间：2012-11-02T14:22:33.520
> 
> 标签：python, time-series, forecasting

我发现 R 的预测包是时间序列分析和预测的最佳解决方案。

我想在 Python 中使用它。我可以使用 rpy 并在 Python 中使用预测包吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-02T15:44:27.967

是的，您可以使用 [不再开发或扩展，但维护的] 包 RPy，或者您可以使用正在积极开发的更新的包 RPy2。

还有其他选项，例如到 Rserve 的无头网络连接。

# django - 在 Django 中通过 OpenID 身份验证获取 Google 联系人

> ID：13197098
> 
> 赞同：0
> 
> 时间：2012-11-02T14:22:35.723
> 
> 标签：django, google-api, google-openid, django-openid-auth, google-oauth

我正在使用 Django 包[django_openid_auth](https://launchpad.net/django-openid-auth)和这段[代码](http://djangosnippets.org/snippets/2183/)通过他的 OpenID 对 Django 中的用户进行身份验证。

这完美地工作。用户被重定向到 Google Accounts 页面以获取权限，然后被重定向回来。

但是，这只是服务器获取用户的电子邮件/姓名/姓氏。如果我想获取用户的联系人列表，甚至是出生日期或头像等敏感信息，它是如何工作的？

我假设，因为我通过 OpenID AX 扩展获取电子邮件/姓名，我可以类似地使用 Ext2 扩展获取 OAuth 信息？

我知道 Google Contacts API 需要 OAuth 身份验证。由于我使用 OpenID 登录，是否包含此 OAuth 身份验证，还是必须在新的单独流程中进行？简而言之，这个 OpenID 身份验证是否包括获取联系人/帐户信息的身份验证过程，还是我必须进行身份验证并使用单独的过程？

使用的 OpenID 机制的内部机制在[django_openid_auth](https://launchpad.net/django-openid-auth)模块中。

有人可以指出我正确的方向吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T22:36:26.807

我认为您应该考虑使用 OAuth2 而不是 OpenID2 和 OAuth 1 的混合。可以使用后者，但使用 OAuth2 更容易。我不了解 Django 的特定 OAuth2 库，但 Google 编写的 Python OAuth2 库是“最先进的”。它甚至有关于在 Django 中使用它的信息

[https://developers.google.com/api-client-library/python/guide/aaa_oauth](https://developers.google.com/api-client-library/python/guide/aaa_oauth)

该库将允许您询问联系人范围以及您感兴趣的 userinfo.profile 范围。

希望这可以帮助。

达韦普

# php - PHP - 使用修改/删除的引荐来源网址重定向？

> ID：13197100
> 
> 赞同：0
> 
> 时间：2012-11-02T14:22:42.000
> 
> 标签：php, header, refresh, referrer

我假设这是不可能的，但我还是要问，因为这里有很多人比我聪明得多！

我想做一个标头重定向并欺骗引荐来源网址。

这就是为什么，我使用点击跟踪系统来衡量我的流量和营销支出/投资回报率，我不想将原始推荐人传递到我的目的地，因为我不希望其他人看到我的主要流量来源和关键字......我也不想通过一个空白的推荐人（这就是我现在所做的）来传递流量，因为这看起来像是我在偷偷摸摸或想欺骗某人，但事实并非如此。

我想要做的是将引荐来源值欺骗到我的域，但对通过我的跟踪系统的所有访问执行此操作。基本上，我想表明流量正在通过我的私人跟踪系统，但不放弃任何详细信息！

可能的？

我知道推荐人信息是由浏览器传递的，除了元刷新之外，我真的想不出任何其他方法！

# sql - SQL 连接字符串代理

> ID：13197105
> 
> 赞同：1
> 
> 时间：2012-11-02T14:22:52.480
> 
> 标签：sql, architecture, connection-string

我的公司有很多 SQL 实例，每个实例上有很多数据库。这些实例被许多不同 Web 和应用程序服务器中的许多自定义代码引用。任何给定服务器上的技术堆栈都可以处于生命周期的不同阶段。这是维护的噩梦。我正在迁移一个 SQL 2000 实例，其中包含数千个无组织的表和一组未知的应用程序访问这些表。

我意识到我的问题是架构和实施不佳的基础架构，但我现在对此无能为力。我正在考虑设置某种类型的中央连接字符串代理来提供连接字符串。应用程序将调用代理以获取适当的连接字符串。

我想我的第一个问题是——这样的事情存在吗？我宁愿放弃现有的解决方案，也不愿推出自己的解决方案。如果不是，那么创建处理此问题的最简单、最透明的方法是什么？

我首先想到的解决方案是在负载平衡的 Web 服务器上运行的 REST Web 服务，该服务器将底层连接存储在某种类型的配置文件中。

我将不胜感激任何想法或可能使用的工具。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T15:14:03.113

你说什么语言？在 Java 中，我们使用 org.apache.commons.jbcp.BasicDataSource 从属性/配置文件中保存由 String 加载的连接字符串。这是相当可维护的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T06:14:54.563

看看分布式哈希表的实现。它们基本上提供了一个分散的地方来放置你的键和值对，连接字符串在你的案例中。

仅举几例，[memcached](http://memcached.org/)、[redis](http://redis.io/) 和[hazelcast](http://www.hazelcast.com/)都可以满足您的需求。

# php - 无法在 IE 中查看悬停的列表项，适用于 Mozilla/chrome

> ID：13197108
> 
> 赞同：2
> 
> 时间：2012-11-02T14:22:57.367
> 
> 标签：php, html

我不明白如何使它在 IE 中工作，此代码适用于 mozzila 和 chrome，当我将鼠标悬停在寄存器上时，我无法看到 A 寄存器和 B 寄存器列表项，任何帮助将不胜感激。这是 php 代码

```
<?php
$list.="<li ><a href=\"\">Register</a>
                <ul><li><a href=\"a.php\">A Register</a></li>
                <li><a href=\"b.php\">B Register</a></li></ul>
                </li>";
                ?> 
```

这是CSS

```
 /* Lists */
    ul, ol {
        margin: 10px 20px;
        padding: 0 20px;
    }
    ul { list-style: disc; }
    ol { list-style: decimal; }
    /* Header */
    #header {
        position: relative;
        margin: 0 auto;
        height: 245px;      
    }
    /*  navigation  */
    #header #nav {
        position: absolute;
        left: 0px;  bottom: 20px;       
        margin: 0; padding: 0 0 0 20px;     
        width: 900px;       
        border-bottom: 1px solid #F2F2F2;   
        /* z-index: 99999; */
    }
    #header #nav ul {
        float: left;    
        list-style: none;   
        margin: 0;
        padding: 0;                 
    }
    #header #nav ul li {

        float: left;
        margin: 0; padding: 0;
        list-style: none;
        position: relative;
        display: inline;
    }
    #header #nav ul li a:link,
    #header #nav ul li a:visited {
        float: left;
        margin: 0;
        padding: 5px 15px 10px 15px;
        color: #666666;
        font: bold 14px 'Trebuchet MS', Arial, Sans-Serif;
        text-transform: uppercase;      
        border-right: 1px solid #EEE;   
    }
#header #nav ul li a:hover{background-color: #D14836;
color: #FFFFFF; 
} 
#header #nav ul li a:active {
    diasplay:block;
    border: none;
    color: #000;    
    border-right: 1px solid #EEE;
}
#header #nav ul li#current a {  
    background: transparent url(../images/current.gif) repeat-x left bottom;    
    color: #222;    
}

#header #nav ul li.first a:link, 
#header #nav ul li.first a:visited {
    border-left: 1px solid #F1F1F1; 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T16:07:59.483

这可能与您使用的是一个非常旧的浏览器（IE6）有关，它无法识别 :hover 伪选择器在您的 css 中，在 IE6 中它只会识别 :hover 锚标记。

如果出于某种原因您确实需要支持 IE6，请查看以下解决方案：

[悬停任何东西](http://peterned.home.xs4all.nl/csshover.html)

# vba - 使用 Outlook 模板回复时显示图像

> ID：13197115
> 
> 赞同：3
> 
> 时间：2012-11-02T14:23:26.993
> 
> 标签：vba, outlook

我有一个 Outlook 模板，我在回复邮件时使用它。我可以让它自己成功显示，但是当我添加要在模板下显示的原始消息时，图像会损坏。

![在此处输入图像描述](../Images/09bbebf98987fd2da379fd74d4409ae0.png) ![在此处输入图像描述](../Images/89ed75b526c102e37d399b919f836912.png)

在第二张图片中，原始消息很好，甚至可以正确显示图像。

```
Sub Reply()

Dim Original As Outlook.MailItem
Dim Reply As Outlook.MailItem
Set Original = Application.ActiveExplorer.Selection(1).Reply
Set Reply = Application.CreateItemFromTemplate("C:\Mail.oft")

Original.HTMLBody = Reply.HTMLBody & Original.HTMLBody
Original.Display
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-03-08T20:42:02.357

尝试使用回复不是原始的。其他人必须提供解释。

```
Sub Reply()

Dim Original As mailItem
Dim Reply As mailItem

Set Original = ActiveExplorer.Selection(1).Reply
Set Reply = CreateItemFromTemplate("C:\Mail.oft")

Reply.HTMLBody = Reply.HTMLBody & Original.HTMLBody
Reply.Display

End Sub 
```

# axapta - AX 中的 StrReplace 函数

> ID：13197116
> 
> 赞同：2
> 
> 时间：2012-11-02T14:23:30.090
> 
> 标签：axapta

如何删除 X++ 中容器的最后一个元素上读取的回车符？

当我为长度创建另一个变量时，字符串是 9，而不是 8，因为它包含 CRLF。

我试过使用`strreplace([container element], '\n', '')`since `'\n'`is the file `inRecordDelimiter`，但这似乎有效。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T16:03:42.313

有回车符（'\r'）和换行符（'\n'）。有时使用一种或两种。使用`strReplace(...)`，它将用另一个字符模式替换一个字符模式。所以最好分别替换每个 '\n' 和 '\r' 因为 '\r\n' 与 '\n\r' 不同。

```
strReplace("?!?!?", "?!?", "*")
//returns the text string "*!?". 
```

下面的这项工作有 2 行实际完成工作，其他循环只是向您显示字符串的 ascii 字符值。您应该这样做以分析您的字符串并查看剩余的内容。

```
static void Job69(Args _args)
{
    container con = ['string1', 'str2', 'John Smith' + '\r\n' + '123 south st' + '\r\n' + 'Chicago, IL 60652'];
    int i;
    ;

    for (i=1; i<=strlen(conpeek(con, conlen(con))); i++)
    {
        // This just lets you see ascii codes
        info(strfmt("%1 - %2", char2num(conpeek(con, conlen(con)), i), substr(conpeek(con, conlen(con)), i, 1)));
    }

    // This code does the work
    con = conpoke(con, conlen(con), strReplace(conpeek(con, conlen(con)), '\r', ''));
    con = conpoke(con, conlen(con), strReplace(conpeek(con, conlen(con)), '\n', ''));

    for (i=1; i<=strlen(conpeek(con, conlen(con))); i++)
    {
        // This just lets you see ascii codes
        info(strfmt("%1 - %2", char2num(conpeek(con, conlen(con)), i), substr(conpeek(con, conlen(con)), i, 1)));
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T14:30:21.597

看来您正在读取文件输入。为什么不首先避免冒犯性的角色？

如果使用`AsciiIo`或`TextIo`您可以使用[inRecordDelimiter](http://msdn.microsoft.com/en-us/library/aa629089%28v=ax.50%29.aspx)来接受文件的正确行尾分隔符。

另请参阅相反的问题：[如何读取作为二进制传输的文本文件](https://stackoverflow.com/questions/4008711/how-to-read-text-files-transfered-as-binary)

# c# - 用于数据库存储的 C# 日期/时间格式

> ID：13197119
> 
> 赞同：-1
> 
> 时间：2012-11-02T14:23:43.277
> 
> 标签：c#, asp.net, datetime-format

谁能建议格式化以下日期字符串格式的最佳方法...

**周六，9 月 22 日**

到我可以作为日期/时间存储在 SQL Server 中的东西......

使用**YYYY/MM/DD等格式**

我可以在代码中做到这一点，但我正在阅读数百个 xml 摘录，不确定如何最好地解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T14:25:47.443

您可以使用`DateTime.Parse()` See [here](http://msdn.microsoft.com/en-us/library/1k1skd40.aspx)获取信息。虽然，你必须在某个地方呆一年。

```
DateTime convertedDate = DateTime.Parse("Sat, Sep 22 2012"); 
```

编辑：

由于我们不确定你是否知道你正在处理哪一年，我建议你可以使用这样的东西：

```
Int32 thisYear = DateTime.Now.Year;
string aDate = "Sat, Sep 22";
DateTime outDate;
while (!DateTime.TryParse(aDate + " " + thisYear.ToString(), out outDate))        
    thisYear--; 
```

这将获得符合描述的最近一年的 DateTime。如果您尝试使用`aDate`“Fri, Sep 22”，那么您的结果将是“9/22/2006”。

或者，如果您只想使用“今年”，您可以使用：

```
String[] myDate = ("Fri, Sep 22").Split(',');
DateTime convertedDate = DateTime.Parse(myDate[1].ToString()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T14:30:30.607

```
DateTime result;
DateTime.TryParse("Sat, Sep 22", out result);
Response.Write(result.ToString("yyyy/M/dd")); 
```

这将在没有年份的情况下解析。在这种情况下，输出为“2012/9/22”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-02T14:51:06.713

SQL Server 支持某些特定的日期格式。您可以使用`yyyy-MM-dd`格式。请检查以下代码：

```
string dt = DateTime.Now.ToString("yyyy-MM-dd"); 
```

您不必担心日期的存储方式。您可以以任何您想要的格式显示日期，并且可以在 SQL Server 和 .Net 中完成。

[见参考](http://www.dotnetspider.com/forum/316312-How-add-date-time-sql-databae-using-c.aspx)

# php - 不同的 URL 地址结尾将用户引导到同一页面但具有动态内容

> ID：13197125
> 
> 赞同：0
> 
> 时间：2012-11-02T14:23:56.563
> 
> 标签：php, javascript, jquery, wordpress

我有一个基于 WordPress 的网站，它具有我使用 php 和 jQuery 编写的自定义社交网络功能。

现在，当我的用户注册帐户时，WordPress 会自动为他们创建一个页面，地址为 www.mysite.com/members/username，其中“用户名”是他们唯一的 URL 地址。这样，每个成员都有自己的页面，他们可以使用其唯一的 URL 地址访问该页面。

问题是，随着我的会员群不断增长，我意识到我将为每个用户创建数千个个人资料页面，这可能会变得一团糟。

所以我想简化这个过程，而不是为每个用户创建一个 WordPress 页面，而是拥有一个配置文件 WordPress 页面，该页面根据 URL 地址中的“用户名”结尾动态加载其内容。

这可能吗？如果是这样，我该如何开始？

感谢您提前提供的所有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T14:35:07.083

```
# .htaccess
RewriteRule ^members/([0-9a-z]+)/?$ ?members&username=$1 [NC,L]

// members.php
$username = $_GET['username'];
$result = mysql_query("SELECT age, location FROM members WHERE username = '$username'");
$data = mysql_fetch_assoc($result);

echo "age: ".$data['age'];
echo "location: ".$data['location']; 
```

嗯，类似的东西。并且所有用户都使用相同的页面（文件）members.php。您只需将数据加载到其中，然后打印出详细信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T15:57:38.760

使用 WordPress：

为 /members/username 创建新的重写规则

```
function members_rewrite_rules()
{
  add_rewrite_rule('members/(.+)/?$', 'index.php?pagename=members&username=$matches[1]', 'top');
}
add_action( 'init', 'members_rewrite_rules' ); 
```

将用户名变量添加到 $wp_query。

```
function members_query_vars($query_vars)
{
  $query_vars[] = 'username';
  return $query_vars;
}
add_filter('query_vars', 'members_query_vars'); 
```

然后在您的“会员”模板页面中，您可以获取查询变量并使用它来加载会员资料：

```
<?php
get_header();
$username = get_query_var('username');
// load the user details using $username
get_footer();
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T14:25:22.400

你想看看[URL rewriting](http://www.cyberdesignz.com/blog/website-design/url-rewriting-top-5-ways-of-php-url-rewriting/)。

# sql - VARCHAR 与 TEXT 或 LONGTEXT

> ID：13197127
> 
> 赞同：3
> 
> 时间：2012-11-02T14:24:03.847
> 
> 标签：sql, varchar, longtext

如果一篇博`varchar(6500)`文有 200 个字符长，只会占用`varchar(200)`?

这会比使用 TEXT 或 LONGTEXT 更有效吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T14:30:54.040

TEXT 存储在它仅引用它的表之外。

尽管

VARCHAR 与表内联存储，通常使用较小的大小。您可以将其最大使用 65535，但实际上在性能方面非常糟糕。

这样您就可以优化表和查询，性能可能与 DBMS 非常接近。如果您有可变但较大的字符串，我建议您使用 TEXT

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T14:29:34.463

长度为 n 字节的可变长度非 Unicode 字符数据。n 必须是 1 到 8,000 之间的值。存储大小是输入数据的实际长度（以字节为单位），而不是 n 字节。输入的数据长度可以是 0 个字符。varchar 的 SQL-92 同义词是 char 变化或字符变化。

[http://msdn.microsoft.com/en-us/library/aa258242%28v=sql.80%29.aspx](http://msdn.microsoft.com/en-us/library/aa258242%28v=sql.80%29.aspx)

# c# - 用于获取“$$”之间的字符串值的正则表达式

> ID：13197133
> 
> 赞同：0
> 
> 时间：2012-11-02T14:24:13.853
> 
> 标签：c#, asp.net, regex, string

以下是`string`我处理文档文件后得到的......

```
$$JHFIRMPHONE-91$$
$$SYSDATE-4$$
Dear  $$RCSALUTATION-5$$,
$$PAPTRANSMITTHANKS-34$$$$IPOWERPACKAGE-56$$$$CASHCARDLOADED-57$$$$CASHCARDTYPE-58$$$$ACTIVATE-59$$$$REFUNDBALANCEDUE-63$$$$FLEXPAY-68$$$$FLEXPAYCONT-67$$
$$REFBALDU$$$$EEXT-73$$
$$RALCASHCARD-64$$
$$ACRCASHCARD-65$$
$$CHECKMONEYCREDITCARD-61$$
$$NOPAYFULL-62$$
$$RAFMEMO-38$$$$RAFMEMOPT2-44$$
$$AMENDED-24$$
$$FORMSSCHEDULES-11$$
$$FORMS_LIST$$
$$FDHANDWRITTENATTACHMENTS-35$$
$$FDATTACHMENTS-26$$
$$FURNISHEDCOPIESKEEP-69$$
$$ESORDEATH-36$$
$$GOLDGUARANTEE-20$$
$$BASICGUARANTEE1-76$$$$BASICGUARANTEE2-77$$$$BASICGUARANTEE3-78$$
$$STONLYOPC-37$$
$$STATE-14$$
$$ST_DATA$$
$$STHANDWRITTENATTACHMENTS-29$$
$$STATTACHMENTS-27$$
$$TAXCOURSE-72$$
$$REWARDTYPE-82$$$$REWARDTYPE2-83$$$$REWARDTYPE3-84$$$$HEALTHBENEFITS-92$$$$HEALTHBENEFITS2-93$$$$HEALTHBENEFITS3-94$$$$HEALTHBENEFITS4-95$$$$HEALTHBENEFITS5-96$$
$$SINCERELY-40$$
$$CLOSING-16$$
$$JHTAXSERVICE-17$$
$$RAFSTARMEMO-45$$
$$RAFSTARMEMO2-97$$ 
```

我想要的是，我需要`text values`介于两者之间`$$`。`$$`我不知道如何以有效的方式做到这一点......我想要一些`Regular Expression`解决方案来解决这个问题。我对此知之甚少`Regular Expression`，所以请大家帮忙我在这...除了正则表达式之外的任何有效解决方案也可以...提前谢谢...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-02T14:28:23.407

[这里有一些正则表达式基础知识，值得一读。](http://www.regular-expressions.info/tutorial.html)

就您的具体问题而言：

```
foreach(Match match in Regex.Matches(input, @"\$\$(.*?)\$\$"))
{
    string textValue = match.Groups[1].Value;
    // process the text value
} 
```

正则表达式匹配，两个字面值`$`，然后是任意多个非换行符（仅在必要时）以获得另外两个`$`. 由于匹配不能重叠，因此从结尾`$$`到开头没有额外匹配的危险`$$`。

一个更有效且通常推荐的正则表达式是：

```
@"\$\$((?!\$\$).)*\$\$" 
```

它基本上做同样的事情，只是正则表达式内部有点不同（看看“前瞻”）。

事实上，如果你能保证文本值总是只包含字母、数字、下划线和连字符，你可以使用：

```
@"\$\$([\w-]+)\$\$" 
```

并不是说对于所有这三种情况，有些人更喜欢用 替换`\$\$`，`\${2}`但我个人觉得两次重复有点不必要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T14:28:27.537

我认为`\$\$([A-Z0-9\_\-]+?)\$\$`应该覆盖负载。

您可能想要检查它允许多行解析的额外参数。

查看[此链接](http://www.regular-expressions.info/reference.html)以获取有关正则表达式的更多详细信息

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-02T14:37:26.047

实际上不需要正则表达式。您的文本很容易被`String.Split`.

```
var parts = str.Split(new string[] {"$$"}, StringSplitOptions.RemoveEmptyEntries); 
```

# visual-studio-2010 - 将程序集附加到 Word 2010 文档

> ID：13197138
> 
> 赞同：0
> 
> 时间：2012-11-02T14:24:21.763
> 
> 标签：visual-studio-2010, vsto, word-2010

我找到了一个解决方案，可以将 VSTO 2010 创建的托管代码（又名“程序集”）附加到来自此[链接的 Word 2010 文档](http://msdn.microsoft.com/en-us/library/ms268877.aspx)

`.application`我已按照所有步骤操作，但在项目调试文件夹中没有找到该文件。我以为是`.vsto`文件。但是，当我按照上述链接中的说明添加属性并关闭并重新打开文档时，我收到一条错误消息，提示无法找到程序集或无法加载它。

以前有没有人遇到过这个？我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T12:00:53.140

我找到了解决方案。[我已在此链接](http://msdn.microsoft.com/en-us/library/ms268877.aspx)建议的文档中的自定义属性中添加了 _AssemblyLocation 和 _AssemblyName ， 现在它工作正常...

# facebook - Facebook 社交插件评论通知

> ID：13197139
> 
> 赞同：0
> 
> 时间：2012-11-02T14:24:27.797
> 
> 标签：facebook, notifications, comments

我在我的网站上添加了 Facebook 社交插件评论。当我在我的网站上收到有关新 facebook 评论的通知时，我如何知道评论是在哪个页面上发表的。我的网站上有数百个带有 facebook 评论的页面。

[http://i.stack.imgur.com/i1LDO.jpg](http://i.stack.imgur.com/i1LDO.jpg)

就像上面这张图片一样。它只显示评论，但我不知道该评论是在哪个文章/页面上发布的。有什么办法可以查出来吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T17:26:30.713

点击评论的时间戳。

# c# - 如何将日期格式从 yyyy-MM-dd 更改为 ddmmyyyy

> ID：13197143
> 
> 赞同：0
> 
> 时间：2012-11-02T14:24:36.083
> 
> 标签：c#

我需要自动生成预订 ID，例如： 02112012/1 ，如果它的第一个是 02/11/2012 并且因此“/”之后的数字增加，所以我需要将日期格式从 yyyy-MM-dd 更改为 ddmmyyyy 所以有什么办法可以做到这一点。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-02T14:30:01.380

```
Console.WriteLine(DateTime.Now.ToString("ddMMyyyy")); 
```

产量`02112012`

如果您需要进一步的客户日期格式，此[链接](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)应该会有所帮助 =)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T14:31:40.233

像这样：

```
// parse the original string value into DateTime.
DateTime dt = DateTime.ParseExact("2012-11-02", "yyyy-MM-dd", 
    CultureInfo.CurrentCulture);

// emit to your desired format.
string bookingIdFormattedDate = dt.ToString("ddMMyyyy");

// bookingIdFormattedDate should be "02112012" 
```

干杯。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T14:34:04.933

```
string dateString = "2012-10-01";
DateTime date = DateTime.ParseExact(dateString, "yyyy-MM-dd", new DateTimeFormatInfo());
string result=date.ToString("ddmmyyyy"); 
```

# .net - 当这些任务中的任何一个引发异常时，如何取消一堆任务？

> ID：13197144
> 
> 赞同：0
> 
> 时间：2012-11-02T14:24:41.820
> 
> 标签：.net, multithreading, task-parallel-library

我创建并启动了许多任务。其中一项任务可能会引发异常。如果发生这种情况，我需要停止所有任务。

现在我只看到这样做的唯一方法是将 CancellationTokenSource 传递给每个任务并在 catch 块中调用 Cancel() 。

TPL 是否以更通用的方式支持所需的功能？

就像是：

```
Action<Task> onExceptionAction = t => cancellationTokenSource.Cancel();
var task = Task.WhenAnyThrows<MyException>(tasks, onExceptionAction); 
```

如果没有抛出异常，则认为任务已完成（或取消）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T18:30:31.463

如果我理解正确的话，你想要的是[`ContinueWith()`](http://msdn.microsoft.com/en-us/library/dd991174.aspx)with [`TaskContinuationOptions.OnlyOnFaulted`](http://msdn.microsoft.com/en-us/library/system.threading.tasks.taskcontinuationoptions.aspx)。

因此，您的方法可能如下所示：

```
void CancelWhenAnyFaults(IEnumerable<Task> tasks, CancellationTokenSource cts)
{
    foreach (var task in tasks)
        task.ContinueWith(
            _ => cts.Cancel(), cts.Token, TaskContinuationOptions.OnlyOnFaulted,
            TaskScheduler.Current);
} 
```

我也传递了`CancellationToken`to `ContinueWith()`，这样当一个任务失败时，其他的延续就不会被执行。

# c# - 降低打开进程的权限

> ID：13197149
> 
> 赞同：0
> 
> 时间：2012-11-02T14:25:01.620
> 
> 标签：c#, .net

想知道如何降低进程权限？我已经看到了如何使用令牌提升我自己的流程，但没有看到如何降低其他一些流程（不是我自己开始的流程），例如记事本。

谢谢

# java - 在 Java 中使用三元运算符应用增量

> ID：13197150
> 
> 赞同：6
> 
> 时间：2012-11-02T14:25:05.630
> 
> 标签：java

是否可以在 Java 中使用三元运算符来应用增量？

例如，我想在没有“if”语句的情况下进行此操作，而不是因为它更具可读性或更短，只是我想知道。

```
if(recordExists(recordId)){
   numberofRecords++;
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-02T14:28:45.150

> 是否可以在 Java 中使用三元运算符来应用增量？

您可以改用加法。

```
numberOfRecords += recordExists(recordId) ? 1 : 0; 
```

恕我直言，这没有副作用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-02T14:26:22.170

> 是否可以在 Java 中使用三元运算符来应用增量？

那么你*可以*写：

```
// Ick, ick, ick.
int ignored = recordExists() ? numberOfRecords++ : 0; 
```

或者进行无操作方法调用：

```
// Ick, ick, ick.
Math.abs(recordExists() ? numberOfRecords++ : 0); 
```

不过，我*强烈*建议您不要这样做。这是对条件运算符的滥用。只需使用一个`if`语句。

条件运算符的目的是创建一个其值取决于条件的*表达式。*

语句的目的`if`是根据条件执行某些*语句*。

引用[Eric Lippert 与 C# 相关的博客文章](http://blogs.msdn.com/b/ericlippert/archive/2009/05/18/foreach-vs-foreach.aspx)：

> 表达式的目的是计算一个值，而不是产生副作用。声明的目的是产生副作用。

编辑：鉴于对这个答案的有效性产生了怀疑：

```
public class Test {
    public static void main(String[] args) {
        boolean condition = true;
        int count = 0;
        int ignored = condition ? count++ : 0;
        System.out.println("After first check: " + count);
        Math.abs(condition ? count++ : 0);
        System.out.println("After second check: " + count);
    }
} 
```

输出：

```
After first check: 1
After second check: 2 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-18T17:32:04.553

请记住，如果您尝试在其中使用增量，三元运算符可能会做一些奇怪的事情。我相信这个术语是“短路”，结果非常违反直觉。

最好避免！

例如，请注意以下事项：

```
public class Strange {
    public static void main(String[] args) {
        int x = 1;
        x = x > 0 ? x++ : x--;
        System.out.println("x= " + x); // x is 1, both the increment and decrement never happen.

        int y = 5;
        y = y < 0 ? y++ : y--;
        System.out.println("y= " + y); // y is 5, both the increment and the decrement never happens.

        // Yet, in this case:

        int a = 1;
        int b = 2;

        a = a > 0 ? b++ : a--;
        System.out.println("a= " + a + " b= " +b); // a = 2, b = 3;
        // in this case a takes on the value of b, and then b IS incremented, but a is never decremented.

        int c = 5;
        int d = 1;
        int e = 0;

        c = c < 10 ? d++ : e--;
        System.out.println("c= " + c + " d= " + d + " e= " + e); // c = 1, but d = 2, and e = 0\. 
        // c is assigned to d, then d in INCREMENTED, then the expression stops before evaluating the decrement of e!

        c = c > 10 ? d++ : e--;
        System.out.println("c= " + c + " d= " + d + " e= " + e);
        // c = 0, d = 1, e = -1

    }
} 
```

# javascript - 允许具有多种数据类型的 Javascript 参数：好的做法与否？

> ID：13197152
> 
> 赞同：6
> 
> 时间：2012-11-02T14:25:10.950
> 
> 标签：javascript, jquery, function, types, arguments

很多次我看到——尤其是在 jQuery 中——一个函数可以有多种有效的数据类型，比如说字符串或函数。此外，在我自己的代码中，有时我的函数可以采用一个*或*多个值。所以我可以调用这个函数：

```
myFunc("arg"); or myFunc(["arg1", "arg2", ...]); 
```

这看起来更灵活，打字也更方便，但这真的是一件好事吗？

因为另一方面，它没有明确说明函数是什么类型，并且 AFAIK 然后 JIT 编译器不能有效地工作。并且通常必须有某种类型的类型强制，这可能会带来额外的性能损失。

*那么，总是*写：`myFunc(["arg"])`即使数组中只有一个对象会更好吗？你对此有何看法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T14:36:53.297

JavaScript 是松散类型的。如果您不小心，这可能会咬您一口，但它也提供了极大的灵活性，可以精确地执行此类操作。我经常利用这种行为；在函数中，您通常希望具有这样的结构：

```
var func = function(someArg) {
    var data;

    switch (typeof someArg) {
        case 'string':
            // transform someArg into data
            // example: pass it as a jquery selector to get a jquery object
            break;
        case 'object':
            // transform someArg into data
            break;
        ...
        default:
            throw new Error('Invalid argument type passed to func!');
    }

    // rest of function that expects data to be a certain type
}; 
```

您的函数将变得更加灵活和易于使用，但代价是变得更加复杂。用复杂性换取灵活性是否值得，因情况而异（以及因人而异）。

编辑：小心`Array`: `typeof someArray`will give `"object"`，你需要改用这个：http: `someArray instanceof Array` [//jsfiddle.net/8ycFb/](http://jsfiddle.net/8ycFb/)

# ios - 使用 Fetch ResultsController 对 CoreData 中的单元格重新排序

> ID：13197159
> 
> 赞同：1
> 
> 时间：2012-11-02T14:25:23.543
> 
> 标签：ios, ios5, core-data, nsfetchedresultscontroller

我正在研究如何使用 FRC 对 CoreData 中的单元格进行重新排序，我遇到了许多建议使用 order 属性并相应地更新它的帖子，下面是一个这样的代码

在插入新对象时，我必须设置显示顺序并根据

这是它的代码

```
- (void)insertNewObject
{ 
    Test *test = [NSEntityDescription insertNewObjectForEntityForName:@"Test" inManagedObjectContext:self.managedObjectContext];

 NSManagedObject *lastObject = [self.controller.fetchedObjects lastObject];

float lastObjectDisplayOrder = [[lastObject valueForKey:@"displayOrder"] floatValue];

[test setValue:[NSNumber numberWithDouble:lastObjectDisplayOrder + 1.0] forKey:@"displayOrder"];

}

- (void)tableView:(UITableView *)tableView 
moveRowAtIndexPath:(NSIndexPath *)sourceIndexPath 
      toIndexPath:(NSIndexPath *)destinationIndexPath;
{  
  NSMutableArray *things = [[fetchedResultsController fetchedObjects] mutableCopy];

  // Grab the item we're moving.
  NSManagedObject *thing = [[self fetchedResultsController] objectAtIndexPath:sourceIndexPath];

  // Remove the object we're moving from the array.
  [things removeObject:thing];
  // Now re-insert it at the destination.
  [things insertObject:thing atIndex:[destinationIndexPath row]];

  // All of the objects are now in their correct order. Update each
  // object's displayOrder field by iterating through the array.
  int i = 0;
  for (NSManagedObject *mo in things)
  {
    [mo setValue:[NSNumber numberWithInt:i++] forKey:@"displayOrder"];
  }

  [things release], things = nil;

 // [managedObjectContext save:nil];
     NSError *error = nil;

    if (![managedObjectContext save:&error]) 
    {
        NSString *msg = @"An error occurred when attempting to save your user profile changes.\nThe application needs to quit.";
        NSString *details = [NSString stringWithFormat:@"%@ %s: %@", [self class], _cmd, [error userInfo]];
        NSLog(@"%@\n\nDetails: %@", msg, details);
    }

    // re-do the fetch so that the underlying cache of objects will be sorted
    // correctly

    if (![fetchedResultsController performFetch:&error])
    {
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
        abort();
    }
} 
```

**但是假设我有 100 个项目，我从中间删除任何一个项目，然后我必须重新计算 displayOrder，我认为这是不可行的。有没有其他方法可以执行此过程**

问候兰吉特

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-05T11:45:18.003

为什么你认为你需要重新计算索引号？

这些项目根据您应用的排序顺序排列。

如果您提供升序排序，并提供一个数字，那么您将获得正确的排序。您不需要的是用于订购商品的数字与数组中商品的索引之间的直接对应关系。例如：如果您的订货号是

```
1 2 3 4 
```

然后，当您获取它们并对其进行排序时，它们将按此顺序显示。但是如果订购号不同，它们仍然会以相同的顺序出现。

```
1 3 5 7 
```

缺少数字并不重要，因为它们仅用于排序，而不是记录位置。

现在，让我们假设您有 4 个根据索引排序的项目。

```
1 2 3 4 
```

现在删除第二项

```
1 3 4 
```

您少了 1 件商品，但它们的顺序仍然相同。假设您在末尾添加一个项目：

```
1 3 4 5 
```

现在假设您想将最后的项目移动到第三个位置。这是你问自己另一个问题的地方：为什么排序索引必须是整数？如果你使用浮点数，你可以看到很容易计算一个新的索引作为前数和后数之间的中点。因此，将最后的项目移动到第三个位置后，排序索引将如下所示：

```
1.0 3.0 3.5 4.0 
```

在第二个位置添加一个数字怎么样。在这种情况下，中点很容易计算：

```
1.0 2.0 3.0 3.5 4.0 
```

所以。使用排序索引没有任何问题。它不需要是整数，因此当您删除一个项目时，您不必重新计算所有索引。

Now, it is likely that these floats will grow ungainly, but you can run periodic renumberings in your app's downtime, or during updates when users expect a bit of set up to happen.

# excel - excel中的csv和数字不正确

> ID：13197163
> 
> 赞同：0
> 
> 时间：2012-11-02T14:25:30.700
> 
> 标签：excel, csv, numbers

我有一个 3 列的列表。为了上传到我的邮件列表，我需要在 cdv 中进行转换。没有问题 - 但是一旦转换，所有内容都在一列中，仅用逗号分隔。

在过去的三天里已经浏览了所有论坛。这可以是我电脑上设置的语言吗？因为它适用于其他计算机。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T17:17:37.837

我遇到了这个确切的问题，发现文本编码很重要。如果我的 CSV 文件是 UTF-8 编码的，Excel 只会将其识别为有效的 CSV 文件。之后，文本按预期出现在漂亮的列中。

我正在以编程方式创建 CSV 文件，因此我可以控制生成的 CSV 的编码，希望你也一样幸运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T14:44:33.837

CSV 表示“逗号分隔值”，实际上将三列合并为一行，仅用逗号分隔。该文本对于电子表格应用程序将是完全可读的，但对于人类而言，理解可能会更加困难。

如果要获取格式化文本，请将其复制粘贴到记事本并保存文本文件。文件另存为文本也是可能的，但直接复制更快恕我直言，因为可以更快地检测到可能的故障。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T15:53:00.083

列表分隔符在您计算机的区域设置中定义（Windows 中的区域和语言\格式\附加设置）。对于美国计算机，它通常是逗号，对于欧洲计算机，它通常是半列。大多数欧洲计算机将使用半列保存和打开 csv。同样，大多数美国计算机会用逗号保存和打开 csv。如果您尝试切换，Excel 将无法自动识别分隔符。

您可以使用 Data \ Text to columns 强制转换，或者您可以更改计算机的区域设置，您应该不会再遇到这个问题了。

# objective-c - 我应该如何重定向用户以重定向 uri 而不会出现 404error？（OAuth 2.0/谷歌）

> ID：13197171
> 
> 赞同：2
> 
> 时间：2012-11-02T14:25:43.997
> 
> 标签：objective-c, oauth, google-reader

我尝试使用 OAuth 2.0 登录谷歌。我了解到，当我的应用程序将用户重定向到授权页面时，我必须发布“客户端密码”“范围”和“重定向 uri，以便在用户授权我的应用程序后使用。

但是......当我在登录现有的谷歌帐户后单击授权按钮时，会出现“com.google.HTTPStatus error 404”之类的错误。

我用了.....

● Client ID：我从 Google APIs Console 收到的那个。

● Client Secret：我从 Google APIs Console 收到的那个。

● 范围：@"http://www.google.com/reader/api/"

● 重定向 url:urn:ietf:wg:oauth:2.0:oob

● AuthURL：@"https://accounts.google.com/o/oauth2/auth"

● tokenURL:@"https://accounts.google.com/reader/api/

※我的代码是这样的：http://stackoverflow.com/questions/13173406/what-redirect-uri-should-i-use-oauth-2-0

有什么样的可能性？（除非我使用了错误的 URL）还是我使用了错误的 URL？请给我一个建议。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T15:07:08.657

在我们尝试查明问题之前 - 您是否尝试过查看[Google 的 oAuth 2.0 Playground](http://googlecodesamples.com/oauth_playground/)？这可能会有所帮助。在那里，您会发现他们强烈建议使用他们的库来实现客户端。我猜你使用 C# (.Net)，所以他们有一个[可能与](https://code.google.com/p/google-api-dotnet-client/wiki/OAuth2)你相关的链接......

无论如何，使用令牌交换身份验证码的请求如下所示：

**POST /o/oauth2/token** HTTP/1.1
主机：accounts.google.com
code= & redirect_uri= & client_id=<> & scope= & client_secret= ***** ** ***** & grant_type=authorization_code

我相信这对你有用。

链接：[他们的文档](https://developers.google.com/accounts/docs/OAuth2)

# java - 我可以使用哪些方法来手动混淆我的 Android 应用程序？

> ID：13197174
> 
> 赞同：0
> 
> 时间：2012-11-02T14:25:48.760
> 
> 标签：java, android, obfuscation, manual

我不会让我的 android 应用程序几乎不可能进行逆向工程。我曾尝试使用 ProGuard，但由于它根本不加密我的字符串，因此对我来说不是很有用。

我见过这个伟大的混淆器，叫做 Zelix KlassMaster，但我现在买不起。

我可以使用哪些方法来手动混淆我的应用程序，或者是否有任何类可以帮助我，例如 Mono.Cecil for .NET？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T14:32:46.217

看看[DexGuard](http://www.saikoa.com/dexguard)。[它来自制作ProGuard](http://www.saikoa.com/proguard)的同一个人。不过要花钱。

# javascript - 函数外的 Javascript 导致未捕获的引用异常

> ID：13197184
> 
> 赞同：1
> 
> 时间：2012-11-02T14:26:17.053
> 
> 标签：javascript, asp.net-mvc-4

我正在尝试在我的 MVC 4 网页上实现一些基于位置的服务功能。我对使用 Javascript 和 MVC 完全陌生，所以请多多包涵。

这是我当前的网页：

```
@{
    ViewBag.Title = "OnlineUsers";
}

<html>
<head>
    <title>Online Users</title>
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.4/leaflet.css" />
    <script src="http://cdn.leafletjs.com/leaflet-0.4/leaflet.js"></script>

</head>
<body>
    <button onclick="showMap()">Show Map</button>
    <button onclick="goToLocation()">My Location</button>
    <div id="locationDetails"></div>
    <div id="map" style="height: 500px; width: 800px"></div>

    <script type="text/javascript">
        **var map = L.map('map');**
        function showMap() {

            var map = L.map('map');
            L.tileLayer('http://{s}.tile.cloudmade.com/BC9A493B41014CAABB98F0471D759707/997/256/{z}/{x}/{y}.png', {
                maxZoom: 18,
                attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://cloudmade.com">CloudMade</a>'
            }).addTo(map);

            map.locate({ setView: true, maxZoom: 16 });
        }

    </script>
</body>
</html> 
```

脚本部分的顶部是以下代码：`var map = L.map('map');`. 如果我在函数中包含此代码，则页面加载并调用该函数会创建地图。但是，如果我将此代码（或任何其他 JS 代码）放在函数之外，则页面根本不会加载。

我使用了 Chrome 的调试器，控制台显示以下错误：

```
Uncaught ReferenceError: L is not defined 
```

我没有看到在任何地方定义了“L”，但是为什么从函数内部调用它会起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T14:36:07.570

它在您的函数中起作用，因为 L 是[leaflet](http://cdn.leafletjs.com/leaflet-0.4/leaflet.js)的一部分，在调用函数时未加载，但在页面加载时未加载。L 是其他东西的缩小表示。

通常要等到文档准备好，因此您可以确定您引用的 js 已加载，例如，如果您有 jQuery，则以下内容

```
$(document).ready(function () {
    var map = L.map('map');
} 
```

更新：加载此 js 可能会很慢，因此您可以先检查它是否存在，例如

```
window.setTimeout(initMap, 100); 

function initMap(){
         //this should check if your leaflet is available or wait if not. 
         if(typeof L=== "undefined"){
                window.setTimeout(initMap, 100);
                return;
         }
         var map = L.map('map');
}; 
```

# content-management-system - 在 Orchard 中管理/订购内容的替代方法

> ID：13197186
> 
> 赞同：0
> 
> 时间：2012-11-02T14:26:20.743
> 
> 标签：content-management-system, orchardcms

在大多数 CMS 产品中，有一种方法可以对文件夹结构中的内容进行排序和管理。同样的文件夹结构也用于站点导航和站点地图。

在果园也有办法做到这一点吗？因为我看到 Orchard 以不同的方式运作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T16:13:22.823

是的：您可以使用可包含部分和容器部分在层次结构中组织您的内容，但推荐的（并且更灵活）的方法是分类法。

# javascript - Ajax 请求仅在 IE 中失败

> ID：13197187
> 
> 赞同：1
> 
> 时间：2012-11-02T14:26:21.790
> 
> 标签：javascript, jquery, ajax, internet-explorer

以下 Ajax 调用仅在 IE 中失败。我已经尝试将缓存设置为 false 并设置 contentType。该调用总是导致 IE 中的错误函数。

```
 $.ajax({
        type:"GET",
        cache: false,
        url: 'http://where.yahooapis.com/geocode?location='+address+'&flags=J&appid=dj0yJmk9Y1VON011hMQ',
        dataType:'jsonp',
        success: function(data) {
         var quality = parseInt(data.ResultSet.Quality);
         if(quality > 50){                   
             var result = data.ResultSet.Results[0];
             if(result.line1 == streetString && result.city == cityString && result.statecode == stateString && result.uzip == zipString)
                 form.submit();
             else if(result.line1 == ""){
                 $(errorElement).html("Could not find street");
                 $(form).find("input[type='submit']").removeAttr("disabled"); 
             }                  
             else{      
                    var foundAddress = "....Found Address Text...."                                     
                    addressDialog.dialog({
                        modal: true,
                        width:400,
                        resizable:false,
                        title: "Confirm Address",
                        buttons:[
                             {
                                 text:"Confirm",
                                 click:function(){
                                    street.val(result.line1);
                                    city.val(result.city);
                                    state.val(result.statecode);
                                    zip.val(result.uzip);
                                    form.submit();
                                 }
                             },
                             {
                                 text:"Cancel",
                                 click:function(){
                                     addressDialog.dialog("close");
                                 }
                             }
                        ],
                        close:function(event,ui){
                            $(form).find("input[type='submit']").removeAttr("disabled"); 
                        }                       
                    });
                    addressDialog.dialog("open");
             }       
         }else{
             $(form).find("input[type='submit']").removeAttr("disabled");
             $(errorElement).html("Invalid Address");
         }
        },
        error:function(){
            alert(jqXHR.status);
            alert(textStatus);
            alert(errorThrown);
        }
      }); 
```

errorElement 只是一个跨度，我也将错误打印出来。

当我将 dataType 指定为“json”时，警报显示为

0，错误，无传输

当我将其更改为“jsonp”时，警报显示

200，parseerror，错误：jquery1720949182345742317_1351868503283没有被调用

# bash - 用shell脚本中另一个文本文件中的值替换特定行？

> ID：13197192
> 
> 赞同：1
> 
> 时间：2012-11-02T14:26:42.623
> 
> 标签：bash, shell, text

我有一个包含 8 行单个星号的文件。我有 4 个文本文件，每个文件有两行数字。我想为每个文本文件创建一个新文件，其中行号 i+2 和 i+3 被文本文件的内容替换。例如：

File1 将是：

```
1 5 7 8  
2 4 5 6 
```

我想将其转换为：

```
1 5 7 8  
2 4 5 6  
*  
*  
*  
*  
*  
* 
```

File2 将从：

```
6 5 6 7  
8 9 0 9 
```

至：

```
*  
*  
6 5 6 7  
8 9 0 9  
*  
*  
*  
* 
```

有没有办法遍历目录中的文本文件，像上面那样转换每个文本文件？

谢谢！

更新：也许这会更好地解释它：

基本上我有 n 个文本文件，每个文件只有两行数字。我想循环浏览文本文件，将每个文本文件转换为另一个文本文件，其中有 nx 2 行，第一个文本文件的值占用第 1 行和第 2 行，其余行是 *. 第二个文本文件将有 nx 2 行，但第 3 和第 4 行是文件值，其余的是 *. 第三个文件有 nx 2 行，第 6 行和第 7 行填充其值，其余为 *，依此类推。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T14:57:10.200

不知道如何在 shell 中轻松地做到这一点，但 GNU awk 具有一些使其非常简单的特性。

**解析.awk**

```
BEGINFILE { 
  outfile = ARGV[ARGIND] ".new"
  for(i=1; i<ARGIND; i++)
    print "*\n*" > outfile
} 

{ print > outfile }

ENDFILE { 
  for(i=1; i<ARGC-ARGIND; i++) 
    print "*\n*" > outfile
  close(outfile)
} 
```

像这样运行它：

```
gawk -f parse.awk File* 
```

### 解释

ARGV 是一个数组，包含输入文件的名称。ARGIND 是当前正在处理的文件的 ARGV 索引，ARGC 是 ARGV 的长度，即给定参数的数量。

BEGINFILE 和 ENDFILE 块在开始/完成文件处理时执行，因此在您的情况下它们是方便的挂钩。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T15:30:39.597

`bash`解决方案：

```
n=8
i=0
for file in * ; do 
    { 
        for ((a=0 ; a<n ; a++)) ; do
            ((a==i)) && cat "$file"
            echo $'*\n*'
        done
    } > "$file".out
    let i++
done 
```

# html - HTML5 应用缓存，重复存储？

> ID：13197195
> 
> 赞同：0
> 
> 时间：2012-11-02T14:26:52.787
> 
> 标签：html, caching

如果我指定一个应用程序缓存清单，上面写着“缓存 foo.js”并使用相同的清单，`http://example.com/foo.html`然后`http://example.com/bar.html`将`foo.js`被缓存两次，或者它是否足够聪明，可以将其识别为相同的资源？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T14:34:05.697

它会识别已经缓存的文件。所以在你的例子中，它只会被缓存一次。

# android - 在 Java 中更改 XML 的布局样式/向 XML 添加变量

> ID：13197196
> 
> 赞同：0
> 
> 时间：2012-11-02T14:26:53.423
> 
> 标签：android

我目前在市场上有一个应用程序，一些用户询问他们是否可以更改布局背景颜色。EG 目前我有黑色背景和白色文本，他们希望它是白色背景和黑色文本。

我想将其添加为应用程序设置，以便用户自行决定。有没有办法在 XML 中添加一个变量，以便在调用布局时检查要使用的颜色？

谢谢你的时间

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T15:14:37.443

请参考以下[链接](http://www.androidengineer.com/2010/06/using-themes-in-android-applications.html)

您可以通过将主题应用到您的应用程序来实现某某。

# html - 如何创建带角度的div

> ID：13197201
> 
> 赞同：0
> 
> 时间：2012-11-02T14:27:34.770
> 
> 标签：html, css

我想像这张图片一样创建 div：

![在此处输入图像描述](../Images/06ed47071981c5d63bf345b0bb7080f1.png)

到目前为止，我创建了这个：

```
<div style="width: 300px; height: 200px; left:20px; top: 40px;">
<div style="width: 300px; height: 20px; top: 0px; background-color: #76b900; border-radius: 3px; "/>

</div> 
```

我怎样才能像图片一样添加颜色渐变。还有我怎么能像图片一样添加45度角？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T14:30:04.280

我认为您需要 2 个 div 来仅使用 css 来完成此操作。

一个作为带有文本的块，在右侧，您应该浮动一个 div 并对其应用类似的样式：

[CSS 三角形是如何工作的？](https://stackoverflow.com/questions/7073484/how-does-this-css-triangle-shape-work)

我个人会考虑图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T14:36:09.650

您可以使用 2 `div`s，也可以使用`:after`仅带有箭头图像的伪元素。

编辑：想想看，使用 2 个倾斜的 div 还需要您使用`:before`带有箭头图像的伪元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-02T14:45:16.520

这个想法是使用与主元素具有相同渐变的伪元素，但对角线穿过，然后将其旋转 45 度：

```
h1 {
    background: linear-gradient(#5FA309, #3B8018);
    position: relative;
    line-height: 30px;
}

​h1:after {
    content: '';
    background: linear-gradient(top left, #5FA309, #3B8018);
    transform: rotate(45deg);
    position: absolute;
    top: 4px; right: -11px;
    width: 21px;
    height: 21px;
}​ 
```

这是一个演示：[http ://codepen.io/JosephSilber/pen/bFfqn](http://codepen.io/JosephSilber/pen/bFfqn)

**PS**不要忘记生产中的供应商前缀......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-02T14:50:39.210

干得好：

```
<div class-"container">
 <div class="arrow-body"></div>
 <div class="arrow-right"></div>
</div>

.container {
 width:300px;
 overflow:auto;
}

.arrow-body {
 width:270px;
 height:60px;
 background:green;
 float:left;
}

.arrow-right {
 width: 0; 
 height: 0; 
 border-top: 30px solid transparent;
 border-bottom: 30px solid transparent;
 border-left: 30px solid green;
 float:left;
} 
```

# bash - 如何使函数只读

> ID：13197204
> 
> 赞同：4
> 
> 时间：2012-11-02T14:27:41.613
> 
> 标签：bash, function, readonly

具有示例功能

```
function functionName ()
{
    echo "Hello World"
} 
```

如何避免它被具有相同名称的以下函数覆盖？

```
function functionName ()
{
    echo "this is another function"
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-02T14:27:41.613

您需要使用 -f 选项将相应的函数设为只读，语法为：

```
readonly -f functionName 
```

在此之后，如果您尝试更新函数，则会触发错误：

```
bash: functionName: readonly function 
```

# bash - 在此处文档中使用函数

> ID：13197207
> 
> 赞同：0
> 
> 时间：2012-11-02T14:27:51.973
> 
> 标签：bash, shell, unix

我有一个脚本，其中包含一些主体用来执行的功能。现在，我想在 3 台远程 unix 机器上运行这个脚本。哪种方法最简洁？最重要的是，我不会为远程连接编写第二个脚本。一切都应该在这个脚本中。

我已经用 ssh 尝试了 heredoc，由于功能强大，它无法正常工作！

**代码 -**

```
#!/bin/bash

# Year Month Day Related functions
# FUNCTIONS
# Find no. of days in a year
yeardays()
{
# argument check
if [ X$1 = X ]
then
        read year
else
        year=$1
fi
# Check for leap years
if [ `expr $year % 400` = 0 ]
then
        echo 366
        exit
fi

if [ `expr $year % 100` = 0 ]
then
        echo 365
        exit
fi

if [ `expr $year % 4` = 0 ]
then
        echo 366
        exit
fi

echo 365
}

# Find no. of days in a Month
monthdays()
{
# argument check
if  [ X$1 = X ]
then
     read ymd   # year in yyyymmdd format
elif [ X$2 = X ]
then
      ymd=$1
else
      ymd=`expr \( $1 \* 10000 \) + \( $2 \* 100 \) + 1`
fi

year=`expr $ymd / 10000` ;
month=`expr \( $ymd % 10000 \) / 100` ;

case $month in
      1|3|5|7|8|10|12) echo 31 ; exit ;;
      4|6|9|11) echo 30 ; exit ;;
      *) ;;
esac

# except for month 2, which depends on whether the year is a leap year
# Use yeardays to get the number of days in the year and return a value
# accordingly.
daysInYear=`yeardays $year`

case $daysInYear in
   365) echo 28 ; exit ;;
   366) echo 29 ; exit ;;
esac
}

ymd2yd()    # convert from YYYYMMDD(gregorian) to YYYYDDD(julian)
{
# argument check
if [ X$1 = X ]
then
        read date
else
        date=$1
fi

year=`expr $date / 10000`
month=`expr \( $date % 10000 \) / 100`
days=`expr $date % 100`

count=1
while [ `expr $count \< $month` = 1 ]
do
        daysInMonth=`monthdays $year $count`
        days=`expr $days + $daysInMonth`
        count=`expr $count + 1`
done

julian=`expr \( $year \* 1000 \) + $days`
echo $julian
}

yd2ymd()    # convert from YYYYDDD(julian) to YYYYMMDD(gregorian)
{
# argument check
if [ X$1 = X ]
then
        read date
else
        date=$1
fi

year=`expr $date / 1000`
days=`expr $date % 1000`

month=1
while [ `expr $days \> 0` = 1 ]
do
        daysInMonth=`monthdays $year $month`
        days=`expr $days - $daysInMonth`
        month=`expr $month + 1`
done

days=`expr $days \+ $daysInMonth`
month=`expr $month \- 1`

gregorian=`expr \( $year \* 10000 \) + \( $month \* 100 \) + $days`
echo $gregorian
}

ydadd()     # Add/Subtract days to YYYYDDD format
{
# argument check
if [ X$2 = X ]
then
        difference=$1
        read yd     # Read the YYYYDDD format date
else
        yd=$1
        difference=$2
fi

days=`expr $yd % 1000`
year=`expr $yd / 1000`

days=`expr $days + $difference`
daysInYear=`yeardays $year`

while [ `expr $days \> $daysInYear` = 1 ]
do
        days=`expr $days - $daysInYear`
        year=`expr $year + 1`
        daysInYear=`yeardays $year`
done

while [ `expr $days \< 1` = 1 ]
do
        year=`expr $year - 1`
        daysInYear=`yeardays $year`
        days=`expr $days + $daysInYear`
done

yd=`expr \( $year \* 1000 \) + $days`       # Final date in YYYYDDD format
echo $yd
}

ymdadd()    # Add/Subtract days to YYYYMMDD format
{
if [ X$2 = X ]
then
        difference=$1
        read ymd    # Read YYYYMMDD format date
else
        ymd=$1
        difference=$2
fi

echo $ymd | ymd2yd | ydadd $difference | yd2ymd # Convert YYYYMMDD to YYYYDDD, perform date arithmetic, then revert to YYYYMMDD format
}

daysLeft()  # Calculate days between two dates in YYYYMMDD format
{
# argument check
if [ X$1 = X ]
then
        read ymd1   # First date in YYYYMMDD format
        read ymd2   # Second date in YYYYMMDD format
elif [ X$2 = X ]
then
        ymd1=$1
        read ymd2
else
        ymd1=$1
        ymd2=$2
fi

year1=`expr $ymd1 / 10000`
month1=`expr \( $ymd1 % 10000 \) / 100`
day1=`expr $ymd1 % 100`

year2=`expr $ymd2 / 10000`
month2=`expr \( $ymd2 % 10000 \) / 100`
day2=`expr $ymd2 % 100`

daysm1=`monthdays $year1 $month1`
days=`expr $daysm1 - $day1`
month1=`expr $month1 + 1`

while [ `expr $month1 \<= 12` = 1 ]
do
        daysm1=`monthdays $year1 $month1`
        days=`expr $days + $daysm1`
        month1=`expr $month1 + 1`
done

x=1
while [ `expr $x \< $month2` = 1 ]
do
        daysm2=`monthdays $year2 $x`
        days=`expr $days + $daysm2`
        x=`expr $x + 1`
done

days=`expr $days + $day2`
echo $days
}

# MAIN BODY
# Connect to different Servers
declare -a SERVER=('server1' 'server2' 'server3')
remoteUser=abc
serverNumbers=${#SERVER[@]}
count=0
while [ `expr $count \< $serverNumbers` = 1 ]
do
    # Connect to  server
    ssh -T -q $remoteUser@${SERVER[count]} <<-"END_TEXT"
    VALUE=`cat /home/cognos/cognos/c8/configuration/cogstartup.xml | grep -i xsd:long | head -1 | cut -d">" -f2 | sed 's/[:/<|crn:value]*//g'`
    VALUE_BACKUP=$VALUE
    let 'VALUE -= 30'       
    let 'VALUE *= 86400'
    RESULT1=`perl -e '@stats = stat("/home/cognos/cognos/c8/configuration/signkeypair"); print ((time - $stats[9]) < "$VALUE");'`
    RESULT2=`perl -e '@stats = stat("/home/cognos/cognos/c8/configuration/encryptkeypair"); print ((time - $stats[9]) < "$VALUE");'`
    RESULT3=`perl -e '@stats = stat("/home/cognos/cognos/c8/configuration/caSerial"); print ((time - $stats[9]) < "$VALUE");'`
    while [ "$RESULT1" -o "$RESULT2" -o "$RESULT3" ]
    do
            echo "Sending mail."
            # Calculate days left
            CURRENT_DATE=`date +"%Y-%m-%d" | sed 's/-//g'`
            CREATION_DATE=`ls -logE /home/cognos/cognos/c8/configuration/ | grep -i signkeypair | awk '{print $4}' | sed 's/-//g'`
            EXPIRY_DATE=`ymdadd $CREATION_DATE $VALUE_BACKUP`
            DAYS_LEFT=`daysLeft $CURRENT_DATE $EXPIRY_DATE`
            # Identify environment from hostname - DEV/UAT/PRD
            LOCALHOST=`hostname`
            ENVIRONMENT_TYPE=`echo $LOCALHOST | perl -ne '~m/.*([a-zA-Z]{3})[0-9]*$/; print $1;'|tr '[a-z]' '[A-Z]'`
            # Identify process - FormPF/GoReporting
            if (echo $LOCALHOST | grep -i cfp >/dev/null) then
                   PROCESS="FormPF"
            else
                   PROCESS="GoReporting"
            fi
            # Add details to mail body
            echo "The key was created on `ls -log /home/cognos/cognos/c8/configuration/ | grep -i signkeypair | awk '{print $4,$5,$6}'`, and was set to expire after $VALUE_BACKUP days." > mail.txt
            echo "Key expires in $DAYS_LEFT days !!" >> mail.txt
            echo " " >> mail.txt
            echo "The server is-" >> mail.txt
            hostname >> mail.txt
            echo " " >> mail.txt
            echo "Status of folders/files-" >> mail.txt
            echo " " >> mail.txt
            ls -log /home/cognos/cognos/c8/configuration/ | grep -i signkeypair | awk '{print $4,$5,$6,$7}' >> mail.txt
            ls -log /home/cognos/cognos/c8/configuration/ | grep -i encryptkeypair | awk '{print $4,$5,$6,$7}' >> mail.txt
            ls -log /home/cognos/cognos/c8/configuration/ | grep -i caSerial | awk '{print $4,$5,$6,$7}' >> mail.txt
        echo " " >> mail.txt
        echo "To reactive key, please restart the server at weekend with below options:" >> mail.txt
        echo " " >> mail.txt
        echo "/home/cognos/etc/restartAllServers.sh -cdsk" >> mail.txt
            # Send warning mail !!
            SUBJECT="!! ($ENVIRONMENT_TYPE) $PROCESS ($LOCALHOST) Cognos CSK(Common Symmetric Key) Expiry !!"
            EMAIL="xyz@abc.com"
            cat mail.txt | mailx -s "$SUBJECT" "$EMAIL"
        rm mail.txt
            break
    done
    logout
    END_TEXT
    count=`expr $count + 1`
done
exit 0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T14:56:49.857

移动 heredoc 中的函数。它可能需要对代码结构进行一些更改，但它会起作用。

```
ssh app01.datacentre.private <<EOD
hostdatefunc () {
echo \$(hostname) \$(date)
}
hostdatefunc
EOD 
```

您将获得远程服务器上的主机名和日期，而不是您的。作品。愚蠢的例子，但概念证明。

# mysql - 有没有比这更干净的方法将几个分隔字符串转换为 MySQL 中的表？

> ID：13197210
> 
> 赞同：1
> 
> 时间：2012-11-02T14:27:58.530
> 
> 标签：mysql, string

通常存在这样一种情况，例如，Web 表单输入会产生多个长度相同的数组，其中每个数组都是不同的变量，需要包含在查询的特定部分中。假设你有...

`set @transforms = "a,b,c"; set @bys = "colX,colY,colZ";`

……你想要……

```
+------+---+------+
| row  | x | x    |
+------+---+------+
|    1 | a | colX |
|    2 | b | colY |
|    3 | c | colZ |
+------+---+------+ 
```

是否有这样做的最佳实践，或者至少有此类问题的名称？据我所知，它可能已经是 ArtfulSoftware 上的示例之一，我只是不知道要查找什么标题。我能想到的最好的代码是下面的代码，但感觉就像我在重新发明轮子，我宁愿以真正知道自己在做什么的人喜欢的任何方式来做。有什么建议么？谢谢。

```
DELIMITER ##
DROP PROCEDURE IF EXISTS twoarrays ##
CREATE PROCEDURE hs.twoarrays
-- example usage: 
-- call twoarrays('array1','array2','delim1','delim2')
(
        IN array1   VARCHAR(2000),
        IN array2   VARCHAR(2000),
        IN delim1   VARCHAR(10),
        IN delim2   VARCHAR(10)
)
BEGIN
    IF delim1 is NULL THEN SET delim1 = ','; END IF;
    IF delim2 is NULL THEN SET delim2 = delim1; END IF;
    set @@group_concat_max_len = 99999;
    select @foo := concat("select @rowa := @rowa + 1 as row, '",
        replace(array1,delim1,"' x union select @rowa := @rowa + 1,'"),
        "' from (select @rowa := 0) r");
    select @bar := concat("select @rowb := @rowb + 1 as row, '",
        replace(array2,delim2,"' x union select @rowb := @rowb + 1,'"),
        "' from (select @rowb := 0) r");
    select @baz := concat("select a.*,b.x from (",
        @foo,
        ") a join (",
        @bar,
        ") b on a.row = b.row");
prepare twoarrayproc from @baz;
execute twoarrayproc;
END ## 
DELIMITER ; 

call twoarrays(@transforms,@bys,NULL,NULL); 
```

# javascript - 剪切、复制、粘贴在微型 mce 编辑器中不起作用

> ID：13197212
> 
> 赞同：1
> 
> 时间：2012-11-02T14:28:01.167
> 
> 标签：javascript, html, security, browser, text-editor

我使用微型 MCE 编辑器输入内容。如果我想剪切、复制或粘贴任何单词，它会显示一些错误消息，例如
“复制/剪切/粘贴在 Mozilla 和 Firefox 中不可用。您是否需要有关此问题的更多信息？”

或“您的浏览器当前不支持，请改用键盘快捷键。”..

我该如何解决这个问题。任何人帮助我。

提前致谢..

# c - 编译器可能不会跨序列点移动对 volatile 变量的访问；这是什么意思？

> ID：13197214
> 
> 赞同：6
> 
> 时间：2012-11-02T14:28:04.490
> 
> 标签：c, compiler-construction, volatile, sequence-points

将变量声明为“易失性”意味着直接从内存位置读取/写入，而不是从寄存器变量。我对“序列点”有所了解。但我不明白标题中提到的陈述。

有人可以解释一下，并给出一些代码片段吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-02T15:02:57.730

所有这些都在 C11 5.1.2.3 中描述

> 程序执行
> 
> /--/
> 
> 访问 volatile 对象、修改对象、修改文件或调用执行这些操作的函数都是*副作用*，它们是执行环境状态的变化。表达式的评估通常包括值计算和副作用的启动。
> 
> *之前排序*是由单个线程执行的评估之间的不对称、传递、成对关系，这导致这些评估之间存在偏序。给定任意两个评估 A 和 B，如果 A 在 B 之前排序，则 A 的执行应先于 B 的执行。 ...
> 
> 在表达式 A 和 B 的求值之间存在一个*序列点*意味着与 A 相关的每个值计算和副作用都在与 B 相关的每个值计算和副作用之前排序。
> 
> /--/
> 
> 如果一个实际的实现可以推断出它的值没有被使用并且没有产生所需的副作用（包括调用函数或访问易失性对象引起的任何副作用），则它不需要评估表达式的一部分。
> 
> /--/
> 
> 对一致性实现的最低要求是：
> 
> — 对 volatile 对象的访问严格按照抽象机的规则进行评估。

这不是很容易解释，但用简单的英语大致意思是：由于对 volatile 对象的访问是一种副作用，因此不允许编译器优化此类访问，也不允许将它们排序为不同的顺序，否则它可能会这样做，以便在具有指令缓存/分支预测的 CPU 上获得更好的性能，或者只是更好的性能，因为它具有方便地存储在某些 CPU 寄存器中的某些值。

（C11 标准还明确指出 volatile 对象不能保证是线程安全的，上下文切换后 volatile 对象的值是未指定的行为。）

**编辑**一个例子

给定代码

```
volatile int x;
volatile int y;
volatile int z;

x=i;
y=something;
z=i; 
```

则不允许编译器将可执行文件中的指令重新排序为

```
x=i;
z=i;
y=something 
```

因为对 y 的访问必须在访问 z 之前进行排序。在分号处有一个序列点。但是如果变量不是易失的，编译器可以重新排序它们，如果它可以确定它不会影响程序的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T15:05:22.827

考虑这个故意设计的例子：

```
volatile int v = 5;
int x;
int y = (x=7), (x+v); 
```

回想一下，逗号创建了一个序列点。因此，作业`x=7`将在`x+v`评估之前完成。此外，由于`v`is `volatile`，编译器可能不会认为这仅仅是因为在其声明和访问点之间`5`没有代码修改：编译器必须生成一条指令来*读取*。`v` *`v`*

 *然而，这给编译器留下了一个重要的决定：*什么时候应该`v`读取*？更具体地说，在**分配*****之前*****可以阅读`v` *`x`****吗？*

 *这就是您的问题陈述的来源：

> 编译器可能不会跨序列点移动对 volatile 变量的访问

`v`它明确禁止编译器在分配之前读取`x`，因为这样做会将访问移动到由逗号运算符创建的序列点。`v`如果没有这个限制，编译器将可以在分配之前或之后自由阅读`x`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-02T15:19:26.340

在 C++“抽象机器”的上下文中，程序由`volatile`执行的访问序列（“可观察行为”）定义，优化器可以更改任何其他内容。

例如，如果你的 CPU 有很多寄存器，编译器在其中存储对象是完全可以接受的，除非它们被声明为`volatile`. 查看 CPU 执行的内存访问的人将不再看到程序所做的一切，但可以保证`volatile`访问将在那里。

如果该程序产生与`volatile`未优化程序相同的访问序列和相同的数据，则该程序是正确优化的。

序列点的概念存在于另一层——这涉及抽象机器内部的操作顺序。如果您有两个操作之间没有序列点，则没有排序保证，这就是为什么`x = 0; return x++ + x++;`没有定义的结果。

`volatile`将这两个概念放在一起是很困难的，因为关于不可访问的保证很少。我能很快想到的唯一例子是

```
int *y = ...;
volatile int *x = ...;
std::exception up;

if (*y == 0)
    throw up;

return *x; 
```

事实上，将任何对它的访问移动到任何地方，甚至在可能的情况下优化它们是完全可以接受的，但在任何情况下都`*y`不能评估 if 。`volatile``*x``*y == 0`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-02T14:37:29.030

易失性意味着您的变量可能会在您的程序之外被修改，并且编译器无法通过在程序的表达式序列（指令）中移动它来优化它的访问。易失性使用的一个很好的例子是操作系统的滴答声。volatile 提示优化器说我们不希望他更改其访问权限：在 os ticks 的示例中，我们不想在编码位置之后或更快地读取它。**

# iphone - NSMutableArray 快速枚举问题

> ID：13197227
> 
> 赞同：1
> 
> 时间：2012-11-02T14:28:38.403
> 
> 标签：iphone, objective-c, ios, xcode, fast-enumeration

新手 obj-c 问题。

我有一个带有四个自定义单元格的自定义表格视图。每个单元格中都有一个用于客户信息的可编辑文本字段。我需要通过输入附件视图改进文本字段之间的切换。 [http://uaimage.com/image/62f08045](http://uaimage.com/image/62f08045)

我创建了一个容量为 4 的 NSMutableArray。我标记了文本字段并将它们添加到文本字段委托方法中的此数组中：

```
- (BOOL) textFieldShouldReturn:(UITextField *)textField {
    FDTextFieldCell *cell = (FDTextFieldCell *)[textField superview];
    NSIndexPath *indexPath = [[self tableView] indexPathForCell:cell];

    if ([indexPath section] == 0) {
        if ([indexPath row] == 0) {
            [[FDProfile sharedProfile] setName:[textField text]];
            [textField setTag:1];
            [textFieldsArray insertObject:textField atIndex:0];
        } else if ([indexPath row] == 1) {
            [[FDProfile sharedProfile] setSurname:[textField text]];
            [textField setTag:2];
            [textFieldsArray insertObject:textField atIndex:1];
        } else if ([indexPath row] == 2) {
            [[FDProfile sharedProfile] setNickname:[textField text]];
            [textField setTag:3];
            [textFieldsArray insertObject:textField atIndex:2];
        } else if ([indexPath row] == 3) {
            [[FDProfile sharedProfile] setEmail:[textField text]];
            [textField setTag:4];
            [textFieldsArray insertObject:textField atIndex:3];
            [textField resignFirstResponder];
        }
    }

    [[self tableView] reloadData];
    return YES;
} 
```

现在我尝试改进按钮“下一步”的功能：

```
- (void) inputAccessoryViewDidSelectNext:(FDInputAccessoryView *)view {
    for (UITextField *textField in [self textFieldsArray]) {
        if ([textField isFirstResponder]) {
     textField = [[self textFieldsArray] objectAtIndex:textField.tag + 1];
            [textField becomeFirstResponder];
        }

    }
} 
```

但是这段代码不起作用。我认为使用快速枚举存在问题？

有人可以帮忙吗？谢谢，亚历克斯。

* * *

从 c-had 解决的一些想法：

1.  为什么要在 textFieldShouldReturn: 中设置 textFieldsArray？这不应该在初始化完成的地方（例如视图控制器的viewDidLoad）完成吗？问题可能是您的阵列从未实际设置，或者只是部分设置。此外，将设置放在这里意味着它将被一遍又一遍地调用，每次都会改变你的数组并将事情搞砸。
2.  你的标签少了一个。您应该从 0 开始分配它们，而不是 1（或考虑 inputAccessoryViewDidSelectNext 的差异：）。如果您的代码正常工作，它将跳过 2 个文本字段，因为第一个字段将返回标签 1，您将跳到 objectAtIndex:2，这是第三个字段。
3.  你不考虑结束。如果您在最后一个字段，递增将不会回到开头。

我实际上建议根本不使用标签。相反，在设置时，只需遍历字段，将它们添加到您的数组中。然后，在 inputAccessoryViewDidSelectNext: 中，使用计数器而不是快速枚举来确定您的位置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T14:52:57.580

1.  你为什么要设置你的`textFieldsArray`in `textFieldShouldReturn:`？这不应该在初始化完成`viewDidLoad`的地方（例如视图控制器）完成吗？问题可能是您的阵列从未实际设置，或者只是部分设置。此外，将设置放在这里意味着它将被一遍又一遍地调用，每次都会改变你的数组并将事情搞砸。
2.  你的标签少了一个。您应该从 0 开始分配它们，而不是 1（或考虑到 的差异`inputAccessoryViewDidSelectNext:`）。如果您的代码正常工作，它将跳过 2 个文本字段，因为第一个字段将返回标签 1，您将跳到 objectAtIndex:2，这是第三个字段。
3.  你不考虑结束。如果您在最后一个字段，递增将不会回到开头。

我实际上建议根本不使用标签。相反，在设置时，只需遍历字段，将它们添加到您的数组中。然后，在 中`inputAccessoryViewDidSelectNext:`，使用计数器而不是快速枚举来确定您的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T14:57:03.147

我建议不要使用任何数组来拥有 textFields，而是从 tableView 的单元格中获取 textFields。

你可以这样做，

使用它所在的单元格的 indexPath 设置您的 textFields 标记。

然后使用`textFieldDidEnd`委托，从标签中获取下一个文本字段的单元格，稍后从单元格获取文本字段并使其成为第一响应者。

如果您可以通过`FDInputAccessoryView`以下方法获取单元格，您也可以在此处进行操作。

```
- (void) inputAccessoryViewDidSelectNext:(FDInputAccessoryView *)view` 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T03:23:15.243

根据文档，“[Fast] 枚举是‘安全的’——枚举器有一个突变保护，因此如果您在枚举期间尝试修改集合，则会引发异常。” 这可能就是它不起作用的原因。你可以用一个普通的while循环来完成同样的事情。

# asp.net - ASP 安全异常：相同但不同

> ID：13197230
> 
> 赞同：0
> 
> 时间：2012-11-02T14:28:49.030
> 
> 标签：asp.net

绞尽脑汁，我尝试了许多在网上找到的“解决方案”。基本上，我们正在从供应商处演示此应用程序，并且初始安装运行良好。该应用程序实际上是四个不同的应用程序。在我们的 Windows 服务器上，我们有我们的主站点，其中包含四个供供应商使用的应用程序。所有这些都使用默认的应用程序池。一切正常。

他们要求我们更新软件，结果一败涂地。更新涉及删除所有旧文件并用他们发送给我们的新文件替换它们，然后更新我们的 SQL 数据库。我们完成了两个应用程序有错误：

```
Exception Details: System.Security.SecurityException: Request for the permission of type
'System.Web.AspNetHostingPermission, System, Version=2.0.0.0, Culture=neutral,
PublicKeyToken=b77a5c561934e089' failed. 
```

我已经找到了很多关于这个的答案。将加载用户配置文件更改为ture，尝试过，取消阻止所有dll文件，尝试过。弄乱信任级别，尝试过。从那以后，我将应用程序分成了自己的池（根据供应商的建议，但他们似乎不知道），在搞砸了很多之后，我现在运行了三个应用程序，奇怪的是最初运行的一个应用程序是没有运行的那个。问题是应用程序最初正在运行，我们所做的只是将文件更新到新版本。

我猜我的问题是 System.Web.AspNetHostingPermission 在哪里调用？那只是一般级别的 Asp 应用程序吗？我对此感到很沮丧，如果我们不能让它运行，我们可能只需要告诉供应商将他们的产品带到别处，但我 99% 确定这是服务器设置问题。问题是，我从来没有处理过更新过程所在的软件，删除所有文件并用这个 zip 文件中的文件替换它们。

对此有任何想法。我觉得我已经尝试了大多数明显的解决方案，但需要一些更深入的想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T02:30:24.680

这最终很可能是由第三方的应用程序引起的。他们的安装说明没有说明每个应用程序都有一个单独的应用程序池。（基本上有 4 个部分。一旦我们切换到在其自己的应用程序池上运行的每个应用程序，问题就消失了。

# macos - 我的 sudo 命令不起作用

> ID：13197232
> 
> 赞同：6
> 
> 时间：2012-11-02T14:28:58.880
> 
> 标签：macos, permissions, sudo

我有一个 mac 10.8.2 山狮，当我尝试使用 sudo 命令时，我得到了这个：

```
 sudo: /private/etc/sudoers is owned by uid 501, should be 0
 sudo: no valid sudoers sources found, quitting 
```

我已经搜索了谷歌并尝试了几件事，但有一件事有点解决了我原来的烫发问题，0440 是 0640 或其他东西，但我明白了。任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-02T14:36:00.793

解决此问题的最简单方法是使用磁盘工具的修复磁盘权限功能。运行磁盘工具，在边栏中选择您的启动卷，选择 First Sid 选项卡，然后单击修复磁盘权限。

并且在将来，使用该`visudo`命令编辑 sudoers 文件以避免此类问题。

更新：修复磁盘权限功能在 El Capitain (10.11) 中被删除，因为它（大部分）被[System Integrity Protection](https://support.apple.com/en-us/HT204899)取代。如果您需要在 10.11 或更高版本中修复 /etc/sudoers 的权限，您可以从 AppleScript 中完成：

1.  打开脚本编辑器实用程序。
2.  如果新的（空白）脚本窗口没有自动打开，请选择“文件”菜单 >“新建”（或按 Command-N）打开一个。
3.  输入以下脚本：

    ```
    do shell script "chown root:wheel /etc/sudoers; chmod 440 /etc/sudoers; chmod -N /etc/sudoers" with administrator privileges 
    ```

4.  选取“脚本”菜单 >“编译”（或按下 Command-K，或点按工具栏中的“编译”按钮）。它应该为脚本着色以指示 AppleScript 语法。如果它报告任何错误，请确保您正确复制了脚本。

5.  选取“脚本”菜单 >“运行”（或按下 Command-R，或点按工具栏中的“运行”按钮）。
6.  出现提示时输入您的管理员密码。

# xml - 在 CRM 2011 中修改站点地图 - 更改不可见

> ID：13197235
> 
> 赞同：0
> 
> 时间：2012-11-02T14:29:05.853
> 
> 标签：xml, dynamics-crm-2011

我正在使用 CRM 2011。我是 CRM 家族的初学者。作为练习的一部分，我通过更改`customizations.xml`文件修改了 CRM Web 界面的站点地图。为此，我导出了位于客户端扩展中的站点地图实体。在修改站点地图之前，我保存了原始站点地图解决方案。导入解决方案后更改成功。现在，我想导入原始站点地图解决方案，成功导入和发布后，更改不会回滚（即没有出现原始站点地图界面）。

**我在这里错过了什么吗？请提出建议，因为我现在一无所知。**

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T14:56:44.240

听起来您可能没有发布您的自定义，或者您的“原始”解决方案文件不包含站点地图。如果您有多个环境，您可能会不小心推到错误的环境。我会比较你的两个customizations.xml 文件以确保它们不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T10:41:47.497

通过重新启动 PC 解决了该问题。仍然无法追查根本原因，但我提供的customizations.xml 是正确的:)

# ruby-on-rails - Rails：JSON 还是 REST 吗？

> ID：13197236
> 
> 赞同：1
> 
> 时间：2012-11-02T14:29:10.257
> 
> 标签：ruby-on-rails, rest

我对网络开发还是很陌生，所以如果这个问题真的很愚蠢，请多多包涵。

我正在尝试遵循 REST 原则，但是，我真的很欣赏 JSON 如何与 Ruby 以及任何通过 API 进行外部连接的东西一起流动。我知道在 REST 中将参数直接输入到 URL 中是非常标准的，如下所示：myurl.com/ExampleModel/MyIDParameter 并将 JSON（如果有）发送到该 URI，对吗？

我想知道的是：从 URI 中删除参数（以及如果我永远不会使用它的路由）并将参数包含在 JSON 中是否违反 REST 原则？

例如，而不是调用这个：

```
myurl.com/ExampleModel/id
{
    "name" : "My Name",
    "anotherParameter" : "A random string"
} 
```

你可以这样称呼：

```
myurl.com/ExampleModel
{
    "id" : 512,
    "name" : "My Name",
    "anotherParameter" : "A random string"
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-02T14:43:26.617

如果`myurl.com/ExampleModel`标识一个*唯一*资源，您可以将其用作 URI。但我对此表示怀疑。

您的应用程序也可以像这样具有*不同*的资源表示吗？

```
{
    "id" : 513,
    "name" : "Some Other Name",
    "anotherParameter" : "A differnet random string"
} 
```

如果是，它的 URI 是什么？

我建议使用第一种形式来处理这样的资源表示：

```
GET http://myurl.com/ExampleModel/513 
```

**注意：**您的 JSON 无效，因为它缺少双引号和逗号。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-02T14:37:05.073

我不认为数据交换的格式与 REST 是什么或不是什么有关。

去吧。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-02T14:45:34.060

首先，免责声明：我不会用 Ruby 编程，所以我不能回答关于 Ruby 的具体问题。但我的回答是针对您关于 REST 原则的问题。

最后，答案是：这是您的应用程序如何运行的问题。我将首先解释开发人员使用的一种常用方法。我提到了***常见***的，并不是金科玉律。

When you specify `myurl.com/ExampleModel/id`. A common meaning of such a pattern is used in with GET or PUT operation. GET in the sense that I want information on some object of ID value `id`. PUT in the sense that I have some request body attached with the request to be Updated to the Data Store whose Object have a ID of `id`.

Your second URL when you mentioned just `myurl.com/ExampleModel`, A common interpretation is to show me all the records from the `ExampleModel` collection. This is pretty much the default behaviour used by developers who write APIs.

So, does it break REST principles when you want to do things, the answer is NO. But if you hand your API to other people, the might get a bit confused over it.

So there you have it. Now it's upto you to decide what is best suited for your application.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-02T14:47:32.550

REST is really more of a concept than a strictly designed protocol. Most people equate REST to simply using all of the HTTP verbs to do different things on the same URL, and there's some validity to that way of thinking.

But, if you want some information about how to use the original intent behind REST to actually make a good API:

[http://blog.steveklabnik.com/posts/2011-07-03-nobody-understands-rest-or-http](http://blog.steveklabnik.com/posts/2011-07-03-nobody-understands-rest-or-http)

[http://blog.steveklabnik.com/posts/2011-08-07-some-people-understand-rest-and-http](http://blog.steveklabnik.com/posts/2011-08-07-some-people-understand-rest-and-http)

So if you follow the principles from the blog, it's pretty important to refer to resources by their ID, in the URL. But it's your API and there's no strict rules on how things must be done, just recommendations on how to make your API more discoverable.

# c++ - 如何重载加法运算符以进行交换计算？

> ID：13197240
> 
> 赞同：0
> 
> 时间：2012-11-02T14:29:13.673
> 
> 标签：c++

> **可能重复：**
> [C++ 中的运算符重载为 int + obj](https://stackoverflow.com/questions/1188566/operator-overloading-in-c-as-int-obj)

我有`A`一个重载的类`operator+`。我的问题是我希望能够通过以下两种方式使用求和。

```
A a;

a + 5; 
```

和

```
5 + a; 
```

我如何超载`+`才能做到这一点？我知道我们可以重载`++`执行后增量和前增量（`++x`和`x++`），那么我怎样才能模拟上述能力呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-02T14:30:23.493

您将操作员定义为非成员：

```
class A
{
   int operator + (int x) const
   { 
       return 42;
   }
};

inline int operator + (int x, const A& a)
{
   return a+x;  //calls a.operator +(x)
} 
```

如果`inline`您在标题中定义运算符，则可以防止多次定义符号。

# video - 在 JavaFX 2 中播放带字幕的视频

> ID：13197243
> 
> 赞同：2
> 
> 时间：2012-11-02T14:29:28.177
> 
> 标签：video, javafx-2, javafx, subtitle

我注意到 JavaFX 1 有一个`SubtitleTrack`用于从视频文件中提取字幕的类，但我在 JavaFX 2 中找不到等效的功能（`javafx.scene.media`似乎不存在类似名称的类。在这种情况下，这个功能是否已实现？它搬到了？或者它计划在未来发布？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T22:03:33.403

我不认为 JavaFX 2.2 实现了视频字幕支持。

我认为[媒体轨道功能的公共 API 更改](http://javafx-jira.kenai.com/browse/RT-25678)实现了您询问的功能。[您可以在最新的jdk8 快照版本](http://jdk8.java.net/download.html)中测试实现。

# java - 为什么在循环中读取logcat只读一次

> ID：13197247
> 
> 赞同：3
> 
> 时间：2012-11-02T14:29:41.420
> 
> 标签：java, android, logcat

我在从 2.3.3 到 4.1 的任何模拟器和真实设备上运行我的服务（将 logcat 写入文件）。一切都好。在此设备上生成正确的日志：

```
--------- beginning of /dev/log/main
--------- beginning of /dev/log/system
I/ActivityManager( 3386): START {act=android.intent.action.MAIN cat=[android.intent.category.HOME] flg=0x10000000 cmp=com.android.launcher/com.androWAcivtMaae( 36:IvldakgNme W/ActivityManager( 3386): Duplcaefns eus orcitRod45c6 o.vnotsolet.tiiyilg
I/ActivityManager( 3386): Displayed com.android.calculator2/.Calculator: +9s374ms<br>
.....
..... 
```

但是当我在 4.1.2 (samsung (google) Nexus S (soju, crespo), SDK 16, flash 485486, build JZO54K) 或 2.3.6 上运行服务时，我的服务在日志中的**一行后停止。**

在此设备上生成错误日志：

```
--------- beginning of /dev/log/main 
```

只打印一行，什么都没有......服务留在内存中，但不能正常工作......

这是我的代码

**AndroidManifest**

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
          package="com.my.logcatt"
          android:versionCode="1"
          android:versionName="0.5">
    <uses-sdk android:minSdkVersion="10" />
    <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
    <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
    <uses-permission android:name="android.permission.READ_LOGS" />
    <application android:theme="@android:style/Theme.NoTitleBar">
     <activity android:name=".ActivityMain" android:label="logcatt">
      <intent-filter>
       <action   android:name="android.intent.action.MAIN" />
       <category android:name="android.intent.category.LAUNCHER" />
       </intent-filter>
     </activity>
     <receiver android:name=".BroadcastBoot" android:enabled="true" android:exported="false">
      <intent-filter>
       <action android:name="android.intent.action.BOOT_COMPLETED" />
      </intent-filter>
     </receiver>
     <service android:name=".ServiceMain" android:enabled="true" />
    </application>
</manifest> 
```

**活动**

```
package com.my.logcatt;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;

public class ActivityMain extends Activity
 {
   @Override
   public void onCreate( Bundle savedInstanceState) 
    {
      super.onCreate( savedInstanceState);
      setContentView( R.layout.main);
      try { startService( new Intent( getApplicationContext(), ServiceMain.class)); }  catch( Exception e) {}
    } 
 } 
```

**服务**

```
package com.my.logcatt;

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.FileWriter;
import java.io.InputStreamReader;

import android.app.Service;
import android.content.Intent;
import android.os.Environment;
import android.os.IBinder;

public class ServiceMain extends Service
 {
   public  static Process             procLogcatClean = null;
   public  static Process             procLogcatAM    = null;
   public  static BufferedReader      readerLogcat    = null;

   public static void fLog( String sLogMessage)
    {
      FileWriter     fileLog   = null;
      BufferedWriter bufferLog = null;
      try
        {
          fileLog = new FileWriter( Environment.getExternalStorageDirectory().getAbsolutePath() + "/123.log", true);
          if( fileLog != null)
            {
              bufferLog = new BufferedWriter( fileLog);
              bufferLog.write( sLogMessage + "\r\n");
              bufferLog.flush();
            }
        }
       catch( Exception e) {}
       finally 
        {
          if( bufferLog != null) { try { bufferLog.close(); } catch( Exception e) {} }
          if( fileLog   != null) { try { fileLog.close();   } catch( Exception e)   {} }
        }
    }

   @Override
   public void onCreate()
    {
      super.onCreate();
      startService();
    }

   @Override
   public IBinder onBind(Intent intent) 
    {
      return null;
    }

   @Override
   public void onDestroy()
    {
      super.onDestroy();
    }

   public void startService()
    {
      final Thread thread = new Thread()
       {
         public void run()
          {
            try
              {
                Runtime localRuntimeClear = Runtime.getRuntime();
                String[] sLogcatClear = new String[ 2];
                sLogcatClear[ 0] = "logcat";
                sLogcatClear[ 1] = "-c";
                procLogcatClean = localRuntimeClear.exec( sLogcatClear);
                procLogcatClean.waitFor();

                Runtime localRuntimeAM = Runtime.getRuntime();
                String[] sLogcatAM = new String[ 2];
                sLogcatAM[ 0] = "logcat";
                sLogcatAM[ 1] = "ActivityManager:I *:S";
                procLogcatAM = localRuntimeAM.exec( sLogcatAM);

                readerLogcat = new BufferedReader( new InputStreamReader( procLogcatAM.getInputStream()), 1024);

                String str = "";
                while( true)
                 {
                   str = "";
                   try
                     {
                       if( readerLogcat != null)
                         {
                           str = readerLogcat.readLine();
                           fLog( str);
                         }
                     }
                    catch( Exception e) {}

                   if( str.compareTo( "") == 0)  continue;
                 }
              }
             catch( Exception e) {}
             finally {}
           }
       };
      thread.setPriority( Thread.MAX_PRIORITY);
      thread.start();
   }
 } 
```

怎么了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-02T14:45:40.283

在 4.1.2\. 上，只有 root 和系统应用程序可以访问 logcat。如果已root，您可以使用“su logcat”。

[https://groups.google.com/forum/?fromgroups=#!topic/android-developers/6U4A5irWang](https://groups.google.com/forum/?fromgroups=#!topic/android-developers/6U4A5irWang)

我怀疑您会发现此行会引发您无法处理的异常（顺便说一句，这是不好的做法 - 如果您有适当的捕获，我认为您会发现这一点）。

```
procLogcatAM = localRuntimeAM.exec( sLogcatAM); 
```

否则，请检查 Android 版本并执行不同的操作或检查权限拒绝。或者，将您的应用限制为 < 4.1。

# php - 序列化与内爆

> ID：13197255
> 
> 赞同：2
> 
> 时间：2012-11-02T14:30:08.987
> 
> 标签：php, mysql, arrays, serialization, implode

您认为在 MySQL 数据库的记录中存储一些图像 ID 的更好方法是什么？它只是用于从不同库中获取图像的图像 ID。

我是在 1#4#7#9#10#12 之类的记录中内爆 id，还是只是序列化数组并存储它？使用其中一个而不是另一个有任何性能优势吗？稳定性偏好？

我只是一直使用内爆和爆炸，从来没有真正考虑过。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-02T14:35:51.990

如果您不想（过度？）规范化您的表，并且您真的只想存储一个 id 列表，那么我建议使用一个简单的逗号分隔列表，因为 MySQL 已经有一些可以直接处理逗号的函数-分隔的字符串值：

`FIND_IN_SET`： [http ://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_find-in-set](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_find-in-set)

```
SELECT FIND_IN_SET('b','a,b,c,d'); --> 2 
```

`CONCAT_WS`：[http ://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_concat-ws](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_concat-ws)

```
SELECT CONCAT_WS(',','First name',NULL,'Last Name'); --> 'First name,Last Name' 
```

当然，您将无法执行 SQL JOIN，但它仍然会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T14:32:08.413

我更喜欢**序列化**或 JSON 编码。
它**更灵活**，例如允许您在未来添加图像标题和其他详细信息......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-02T14:33:11.130

据我所知，在这种情况下没有显着差异，但`implode()`速度有点快，因为它假定一个数组并且`serialize()`不知道你传递给它的内容。

**根据 OP 的评论进行**编辑：****

 **> 好吧，所有图像都存储在一个单独的库表中，其中包含标题和描述之类的东西。但是，是的，我明白你的意思。

在这种情况下不是一个好主意，因此将多个 ID 序列化到一个字段中。您需要的是 2 个表之间的 *-to-Many 关系。这是表示多值字段的正确方法：

```
+----------------------+
|  USER                |
+---------+------+-----+
| user_id | name | ... |
+---------+------+-----+

+----------------------+
|  USER_PICTURE        |
+---------+------------+
| user_id | picture_id |
+---------+------------+

+--------------------------+
|  PICTURE                 |
+------------+-------+-----+
| picture_id | title | ... |
+------------+-------+-----+ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-02T14:34:10.303

我的朋友，序列化是获取对象状态的字符串表示。即使它有效，我也不认为是做你想做的最好的方法。我更愿意用 id 存储一个 json 对象。因为 json 对象是多平台的，是一个字符串，并且很容易被人类阅读，我认为这是一个好方法。**

# java - JComboBox 隐藏在 awt Canvas 后面

> ID：13197257
> 
> 赞同：1
> 
> 时间：2012-11-02T14:30:13.120
> 
> 标签：java, swing, awt, mixing

是的，我正在混合 awt 和 swing 组件，但也许有一个简单的解决方法，因为我不太了解 Java。

我的画布对象覆盖绘制和更新：

```
package demo;
import java.awt.*;

public class rectangle extends Canvas {
    public rectangle() {
        this.setSize(500,300);
        this.setVisible(true);
    }
    public void paint(Graphics g) {
        Graphics2D g2 = (Graphics2D) g;
        g2.setColor(Color.YELLOW);

        g2.fill3DRect(0, 0, 500, 300, true);
    }
    public void update(Graphics g) { paint(g); }
} 
```

当我的 JComboBox 在上面打开时，它不会在上面绘制。例如，这是一个 JFrame，它演示了我在说什么：

```
package demo;
import javax.swing.*;
import java.util.*;
import java.awt.*;

public class ASframe extends JFrame {
    public ASframe() {
        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        ArrayList listNames = new ArrayList();
        listNames.add("One");
        listNames.add("Two");
        listNames.add("Three");
        listNames.add("Four");

        rectangle r = new rectangle();
        JComboBox listBox = new JComboBox(listNames.toArray());
        listBox.setVisible(true);

        JPanel listPane = new JPanel();
        listPane.setLayout(new BoxLayout(listPane, BoxLayout.PAGE_AXIS));
        listPane.add(listBox);
        listPane.add(r);

        this.setResizable(false);
        this.add(listPane);
        this.pack();
    }
    public static void main(String arg[]) {
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new ASframe().setVisible(true);
            }
        });
    }
} 
```

真正有趣的是，如果矩形比 JComboBox 小，则完全没有问题。因此，将矩形更改为 300x20 并按预期工作。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-08T00:49:46.467

尝试告诉 Swing 使用重量级组件，看看是否有效。

```
JComboBox listBox = new JComboBox(listNames.toArray());
listBox.setVisible(true);

// additional line below    
listBox.setLightWeightPopupEnabled(false); // use heavyweight component 
```

# url - liferay 页面布局缩略图未显示

> ID：13197262
> 
> 赞同：1
> 
> 时间：2012-11-02T14:30:25.580
> 
> 标签：url, layout, liferay-6

问题是我看不到页面布局的缩略图。我正在使用 Liferay Portal EE 6.1.20。

当我转到管理 -> 页面布局时，我看不到缩略图。

一些事情

1.  我没有使用 OOB Liferay，它是一个自定义解决方案，其中 Liferay 被捆绑为自定义门户解决方案

2.  这东西在 Liferay OOB 中运行良好，所以肯定有一些配置问题

3.  我尝试使用 Firebug 进行调试，它能够从指定的 URL 获取图像。

4.  上下文路径从更改`/`为`/portal`

5.  生成的图片 URL 是这样的`/portal/layouttpl/custom/1_2_columns_ii.png`。这也不能从浏览器本身访问。

6.  其他 URL 喜欢`/portal/html`或`/portal/wap/`工作正常。只有 from`/portal/layouttpl`不允许访问静态资源。

任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T13:11:21.300

检查图像的文件权限可能值得。在我的 Liferay*开发环境*中，我将所有图像设置为 777：

```
user@ubuntu:/usr/liferay/tomcat/webapps/ROOT/layouttpl/custom$ ll *.png
-rwxrwxrwx 1 root root 1801 Apr  2  2012 1_2_1_columns.png*
-rwxrwxrwx 1 root root 1798 Apr  2  2012 1_2_columns_ii.png*
-rwxrwxrwx 1 root root 1793 Apr  2  2012 1_2_columns_i.png*
-rwxrwxrwx 1 root root 1425 Apr  2  2012 1_column.png*
-rwxrwxrwx 1 root root 1923 Apr  2  2012 2_2_columns.png*
-rwxrwxrwx 1 root root 1718 Apr  2  2012 2_columns_iii.png*
-rwxrwxrwx 1 root root 1735 Apr  2  2012 2_columns_ii.png*
-rwxrwxrwx 1 root root 1618 Apr  2  2012 2_columns_i.png*
-rwxrwxrwx 1 root root 1852 Apr  2  2012 3_columns.png*
-rwxrwxrwx 1 root root 1740 Apr  2  2012 freeform.png* 
```

# objective-c - 核心数据：通过中间的抽象实体遍历托管对象关系

> ID：13197263
> 
> 赞同：1
> 
> 时间：2012-11-02T14:30:28.073
> 
> 标签：objective-c, ios, model-view-controller, database-design, core-data

我有以下核心数据模型，其中`ProFormaPeriod`是**抽象实体** `FiscalPeriod`的子类。在我的 fetch 请求中，我想从 to`CalendarPeriod`遍历`IBEstType`。

我该如何做到这一点，因为这`fiscalPeriod`是我在代码完成中获得的唯一关系，而不是`ProformaPeriod`.

`CalendarPeriod`我需要从to建模一个额外的直接关系`ProformaPeriod`吗？

![在此处输入图像描述](../Images/ce803803bd6091bcfe19e20a1d73e68a.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T14:52:08.110

一种方法是获取`FiscalPeriod`并遍历结果以检查正确的类并过滤出正确的 IBEstType(s)。与谓词中的直接键路径相比，它仍然应该非常有效，具体取决于数据的大小。

否则，是的，您必须使子实体成为直接关系。

检查类：

```
for (NSManagedObject *obj in fetchedFiscalPeriods) { 
    if ([obj isKindOfClass:[ProformaPeriod class]]) {
        ProformaPeriod *period = (ProformaPeriod*) obj;
        // check period.estimateType
    }
} 
```

# cordova - 在 Cordova PhoneGap 2.1.0 中将文件复制到 SD 卡

> ID：13197266
> 
> 赞同：3
> 
> 时间：2012-11-02T14:30:32.527
> 
> 标签：cordova, filesystems

我正在尝试将文件（图片）从应用程序的本地缓存目录复制到 SD 卡上图片的永久存储。我尝试搜索并找到如何在 Java 中执行此操作的示例，但我找不到如何使用 Cordova PhoneGap 执行此操作的示例。

我按照 API 说明在下面构建了以下代码，但我不明白如何获取图片目录的路径。使用测试目录时，我的 CopyTo 命令似乎也无法正常工作。

```
function onCameraSuccess(uri) {
    copyFileToStorage(uri);
}

var fileSystem;
var fileURI;
function copyFileToStorage(uri) {
    fileURI = uri;
    window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, onRequestFileSysSuccess, fsFail);
}
function onRequestFileSysSuccess(fs) {
    fileSystem = fs;
    fileSystem.root.getFile(fileURI, {create: false}, onFileEntrySuccess, fsFail);
}
function onFileEntrySuccess(fileEntry) {
    parentEntry = fileSystem.root.getDirectory("test", {create: true});
    fileEntry.copyTo(parentEntry, "file.copy", onCopyToSuccess, fsFail);
}
function onCopyToSuccess(r) {

}
function fsFail(evt) {
    console.log(evt.code);
    alert('fsFail');
} 
```

谢谢您的帮助！杰森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T09:15:09.180

您可以通过调用获取图片目录 `navigator.camera.DestinationType.FILE_URI`。在我的安卓设备上，它返回“/mnt/sdcard/Pictures”。并且使用 Cordova File API，您应该可以复制到图片目录。

# python - QSqlRelationalTableModel 和自动完成字段（PyQt4）

> ID：13197267
> 
> 赞同：1
> 
> 时间：2012-11-02T14:30:35.820
> 
> 标签：python, autocomplete, combobox, pyqt4

我使用 QSqlRelationalTableModel 创建了一个单字段表视图。此表视图中的唯一字段取自具有一长串名称的表（mysql）。当我在与查询“like”逻辑连接的字段中写入名称时，创建自动完成的正确方法是什么。

```
self.model = QtSql.QSqlRelationalTableModel()

self.model.setTable("archlibri")
self.model.setHeaderData(0, QtCore.Qt.Horizontal, "ID")
self.model.setHeaderData(1, QtCore.Qt.Horizontal, "Autore")
self.model.setHeaderData(2, QtCore.Qt.Horizontal, "Titolo")
self.model.setRelation(1, QtSql.QSqlRelation("elAutori", "aID", "aNome"))
self.model.select()

tabella.setModel(self.model)       

tabella.setItemDelegate(QtSql.QSqlRelationalDelegate(tabella)) 
```

Tabella 是一个 QTableView。“Autore”列（列有关系委托）是我想在写名字时添加自动完成的地方

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-11-27T08:46:07.717

根据您的作者字段是什么类型的字段，您必须实现一个查询，该查询从数据库中选择作者姓名以及用户输入的内容。例如。Hemingw... 查询选择... where.. 名称如 %placeholder。返回的值将设置为 ui 中的作者字段。您需要与更改的信号数据一起执行此操作。

# javascript - XHR 上的 Javascript 请求

> ID：13197270
> 
> 赞同：0
> 
> 时间：2012-11-02T14:30:41.637
> 
> 标签：javascript, jquery, xmlhttprequest

我试图通过 XHR 下载一个网页，然后在浏览器中渲染它（使用 document.write()），但是当我这样做时，虽然页面显示了，但 jQuery 的 ready() 函数并没有执行。如果我直接下载完全相同的页面，它会执行。是否需要做一些事情来使通过 XHR 传递的页面执行 ready() 函数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T14:33:25.047

不要`document.write()`用来替换页面内容，会以泪水收场。

只需找到一个合适的顶级元素并使用`.replaceWith()`它来摆脱其现有内容并包含从 XHR 检索到的新内容，例如：

```
$.get(url, function(html) {
    $(body).replaceWith($(html).find('body'));
}); 
```

请注意，这不会替换`<head>`，也不会执行可能包含在新内容中的任何其他 Javascript 块。

你也可以使用`.load()`

```
$(body).load(url); 
```

# javascript - E2E 测试、单元测试和使用 $httpBackend 模拟数据之间的混淆

> ID：13197272
> 
> 赞同：18
> 
> 时间：2012-11-02T14:30:44.863
> 
> 标签：javascript, angularjs, unit-testing, integration-testing

我们刚刚开始使用 AngularJS 开发一个 Web 应用程序，并且在正确测试它时遇到了一些问题，因此我们可以使用一些建议。

一般有以下几个组件需要测试：

1.  网络 API
2.  角度控制器
3.  角度路由
4.  HTML 渲染和控制器与 HTML 元素的 Angular 绑定

如何以最小的努力测试所有这些并且尽可能不重叠？

对于任何以数据库为中心的应用程序，完整的集成测试（即使用实时服务器，连接到加载数据的数据库）将特别混乱，因为必须有一个过程为所有测试生成足够的数据并重置数据库和测试必须小心不要修改彼此的数据。（如果我在这里遗漏了什么，请告诉我）

鉴于上述观点，我假设最好切断服务器和客户端之间的链接，并仅使用模拟数据运行 Angular 测试。

另外，我假设如果 E2E 测试考虑到所有可能的场景，单元测试控制器是多余的，因为它们的值绑定到模型（因此将测试上面的所有 2、3 和 4）。单元测试仅对非常复杂的控制器或测试服务和指令有用。

但是，我们找不到任何关于如何`$httpBackend`在每个测试的基础上模拟东西的信息，就像你在单元测试中所做的那样，使用`expect*()`. Angular 文档似乎建议在必要时`when*()`偶尔使用 plus 。`passthrough()`

但是，这带来了为所有场景创建测试数据的上述问题，并且您可能需要在每次测试之前重置内存数据库以确保测试不受影响。此外，您正在失去使用`$httpBackEnd.expect*()`which 检查没有丢失或冗余调用服务器的安全性 - 这向我表明它还需要单元测试控制器来检查这一点。

有人可以为 AngularJS 应用程序提供详细的测试策略来解决上述 4 个组件的测试以及上面写的问题吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-09T17:55:59.797

1.  不确定 - 由于您的 Angular 应用程序在理论上与您的后端分离，因此没有特别的理由需要将 Angular 测试和后端测试混合在一起。我会单独测试它们，每个测试套件都假设其他组件工作正常。（因此，在测试 Angular 时，您假设服务器将按预期工作。）

2.  单元测试——它们比 E2E 测试提供更多的深度。更容易验证代码将面临的特定条件。根据需要模拟所有依赖项并仅测试单元测试感兴趣的组件也很容易。单元测试不关心 UI 的工作方式，也不关心正确的数据是否正确绑定，而不是业务逻辑该应用程序是正确的。

3.  （和 4）E2E 测试 - 粒度较小，专注于确保 UI 从最终用户的角度来看符合预期。您说得对，针对实时数据库进行测试很麻烦（尽管有些人喜欢完整的端到端集成测试提供的安全性），因此您应该使用[$httpBackend](http://docs.angularjs.org/api/ngMockE2E.%24httpBackend)来模拟服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-01T11:16:18.663

请参阅此[https://www.sitepoint.com/unit-and-e2e-testing-in-angularjs/](https://www.sitepoint.com/unit-and-e2e-testing-in-angularjs/)。如果您的服务/工厂使用 http 服务调用远程 API，您可以从中返回虚假数据以进行单元测试。如果您正在开始一个新的 Angular 项目，请考虑使用 Protractor 进行 E2E 测试。

# android - 在android中使用moveTaskToBack()方法的目的是什么？

> ID：13197281
> 
> 赞同：30
> 
> 时间：2012-11-02T14:31:27.940
> 
> 标签：android, android-activity

我在我的活动中使用 moveTaskToBack() 方法。

当我按下后退按钮时，活动仍然可见。后退键不起作用。我在这里做错了什么？我想导航回上一个活动。

```
public void onBackPressed() {
    // TODO Auto-generated method stub
    moveTaskToBack(true);
    new Finalizer().killApp(false);
    super.onBackPressed();
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-02T14:41:22.210

moveTaskToBack 的目的：

[http://developer.android.com/reference/android/app/Activity.html](http://developer.android.com/reference/android/app/Activity.html)

> moveTaskToBack（布尔非根）
> 
> 将包含此活动的任务移到活动堆栈的后面。

你可以做的是：

```
public void onBackPressed() {
    moveTaskToBack(true); // I don't think you're looking for this.
    new Finalizer().killApp(false); // Neither this.
    super.onBackPressed();
} 
```

也许是这样的：[Android：返回上一个活动](https://stackoverflow.com/questions/4038479/android-go-back-to-previous-activity)`onBackPressed()`在你的之后 类似的东西`super.OnBackPressed();` 还要确保当你点击你的后退按钮时，你实际上是在这个方法中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-02T14:40:46.343

如果调用`super`它会触发返回按钮的默认实现，它只是完成当前活动。尝试删除该行`super.onBackPressed();`，然后查看新行为是否符合您的预期。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-05-19T15:59:48.667

## 在我更新代码之前，当我想在这些情况下关闭我的应用程序时，一些意想不到的事情发生在我身上。

> 启动 -> isSignIn(yes) -> `MainActivity`-> 按返回 -> 关闭。

* * *

> 启动 -> isSignIn(no) -> `SignInActivity`-> 按返回 -> 关闭。

* * *

> 启动-> isSignIn（是）-> `MainActivity`->按注销-> `SignInActivity`->按返回-> `SignInActivity`->按返回-> `SignInActivity`（依此类推，`SignInActivity`直到我按历史记录/最近的应用程序/主页按钮）。

* * *

> 启动 -> isSignIn(no) -> `SignInActivity`-> Press Sign In -> `MainActivity`-> Press Sign Out -> `SignInActivity`-> Press Sign In -> `MainActivity`-> Press Back -> `MainActivity`-> Press Back -> `MainActivity`（依此类推循环并卡住`MainActivity`直到我按下历史/最近的应用程序/主页按钮）。

## `SignInActivity`现在我在具有登录按钮和`MainActivity`退出按钮的情况下提供此代码。

```
@Override
    public void onBackPressed() {
        super.onBackPressed();
        moveTaskToBack(true);
        finish();
    } 
```

它现在在每种情况下都可以正常工作。当我按返回时，应用程序关闭。

# android - 启动android应用程序时Eclipse挂起

> ID：13197286
> 
> 赞同：1
> 
> 时间：2012-11-02T14:31:45.173
> 
> 标签：android, eclipse, drivers

我在 eclipse 中一直遇到这个问题，我的项目构建良好，但是当我运行应用程序时，eclipse 挂起并且冻结或抛出如下所示的启动错误

```
[2012-11-02 14:17:31 - Unexpected error while launching logcat. Try reselecting the device.] device not found
com.android.ddmlib.AdbCommandRejectedException: device not found
    at com.android.ddmlib.AdbHelper.setDevice(AdbHelper.java:752)
    at com.android.ddmlib.AdbHelper.executeRemoteCommand(AdbHelper.java:373)
    at com.android.ddmlib.Device.executeShellCommand(Device.java:462)
    at com.android.ddmuilib.logcat.LogCatReceiver$1.run(LogCatReceiver.java:110)
    at java.lang.Thread.run(Unknown Source) 
```

我也有这个错误文件 错误文件[的图片](http://tinypic.com/r/2r5annd/6)

我不知道如何查明这个问题的根源。我在 Windows 64 位机器上的 eclipse indigo 上使用 android sdk 4.1.2（APK 16）和 android ADT 21（预览版）。我还为我的设备 nexus 7 安装了最新的可用驱动程序

无论我尝试在设备上还是在模拟器上运行，都会出现同样的问题，所以我有点不知道从哪里开始故障排除......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T12:06:01.963

您可能会尝试在 Eclipse.ini 中设置更高的内存限制。由于构建 APK，您的应用程序的实际启动需要更多内存，而在此之前只涉及 Java 编译器。

此外，您可以尝试通过从 Android AVD 管理器对话框（可以通过工具栏按钮之一访问）手动启动 AVD 来解决您的问题。然后仅在模拟器完全启动后启动您的应用程序。

# regex - 使用正则表达式的 Express 参数验证

> ID：13197287
> 
> 赞同：0
> 
> 时间：2012-11-02T14:31:43.827
> 
> 标签：regex, node.js, express

我想使用正则表达式验证 Express（和 express-param）中的 http 请求参数。该参数必须是至少 11 位的数字。

为什么`app.param('uid', /^[0-9]{11,}+$/);`返回错误？

为什么`app.param('uid', /^[0-9]{11,}/);`不能正常工作？它阻止参数 like`1234567890c`并接受`12345678901c`or `12345678901ca`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T14:36:41.237

你的两种模式不一致。第一个（这是一个无效的正则表达式）有一个结尾`$`，指定输入必须匹配您的模式直到字符串的结尾。问题是您`+`在数字之后有一个导致它无效的数字，因为您指定了它应该已经重复的次数`{11,}`。

第二种模式同时删除`+`和`$`。删除 the`+`是完美的，但是，当您删除 the 时，`$`您会说数字*后面*的任何内容都可以出现。

尝试将 a 添加`$`到第二个模式：

```
app.param('uid', /^[0-9]{11,}$/); 
```

# qt4 - 是否可以在基于 QThread 的类中使用 QWebPage？

> ID：13197288
> 
> 赞同：0
> 
> 时间：2012-11-02T14:31:45.440
> 
> 标签：qt4, qt4.8

在基于 QThread 的类中，我有一个 QWebPage，当 loadFinished() 时，我需要解析内容，它会卡住 UI。所以我把所有东西都放在一个线程中：

```
class Thread: public QThread
{
   public:
      Thread (QObject *p): QThread (p)
      {
         moveToThread (this);
         connect (&page, SIGNAL(loadFinished(bool)), SLOT(loadFinished(bool)));
      }
   private slots:
      void loadFinished (bool ok)
      { 
         // never get called, unless I remove the `moveToThread(this)`
      }
}; 
```

我也尝试将 QWebPage 的事件移动到这个基于 qthread 的类中，我得到了错误，似乎你不能将事件移动到一个新线程。

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T04:03:09.027

不幸的是，不能在主 GUI 线程之外的单独线程上创建 Qt GUI 元素。如果您试图补偿由于 QWebPage 中的资源加载而导致的 GUI 减速，我完全理解您的思考过程。我已经彻底调查了这个问题，但还没有找到太明确的答案。

已经报告了一个在 Windows 中需要很长时间的代理查找错误：[https](https://bugreports.qt-project.org/browse/QTBUG-10106) ://bugreports.qt-project.org/browse/QTBUG-10106这个错误目前尚未解决，但将来可能会有解决方案。

# cmake - 从源文件和头文件目录创建 CMake 项目

> ID：13197294
> 
> 赞同：2
> 
> 时间：2012-11-02T14:32:05.607
> 
> 标签：cmake

是否有等效的东西`qmake -project`会自动从源文件和头文件目录创建一个 CMake 项目？

理想情况下，这应该递归地工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T14:36:47.913

不，但这是一个易于设置的项目：

```
project(myProject)

enable_language(CXX)

file(GLOB SRC_FILES *.cpp)

include_directories(${PROJECT_SOURCE_DIR})

add_executable(myExe ${SRC_FILES}) 
```

假设您正在制作可执行文件。`add_library`如果您正在制作图书馆，应该使用。如果您的项目位于子目录（如`src`和`include`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-07T15:35:12.980

（我知道这是很久以前问过的，但无论如何我都会发布我的答案，以供将来参考。）

我认为更好的主意不是`CMakeLists.txt`每次运行时都自动添加带有全局的所有源，而是使用静态源。我猜最初的意思是一个脚本，它扫描当前目录（递归）以查找源文件并将它们添加到 CMake 文件中。这可能会节省大量将每个源文件的名称复制到 CMake 文件的时间。因此：让我们自动化吧！

创建一个包含`cmake-project.sh`以下内容的文件：

```
#!/bin/bash

# use the first argument as project name
PROJECT_NAME=$1

# find source files, but exclude the build directory
PROJECT_SOURCES=$(find . -iname "*.cpp" -not -path "./build/*") 

# find header files, but exclude the build directory;
# only print the name of the directory; only print unique names
PROJECT_SOURCE_DIR=$(find . -iname "*.h" -not -path "./build/*" \
  -printf "%h\n" | sort -u) 

# The standard content of the CMakeLists.txt can be edited here
cat << EOF > CMakeLists.txt
cmake_minimum_required (VERSION 2.8)

set(PROJ_NAME      $PROJECT_NAME )
set(PROJ_SOURCES   $PROJECT_SOURCES )

project(\${PROJ_NAME})

include_directories(${PROJECT_SOURCE_DIR})

add_executable(\${PROJ_NAME} \${PROJ_SOURCES})
EOF 
```

然后，使用 . 使文件可执行`chmod +x cmake-project.sh`。现在你可以`./cmake-project.sh [your_project_name]`在根目录下运行`CMakeLists.txt`自动创建一个静态（即没有glob）。

当然，如有必要，您必须进行调整（例如，使用`.cc`代替`.cpp`），但您明白了。

# .net - 如何优雅地完成拥有线程并引发事件的对象？

> ID：13197295
> 
> 赞同：0
> 
> 时间：2012-11-02T14:32:05.647
> 
> 标签：.net, multithreading, thread-safety, .net-2.0

*问题是当调用者忘记*处理我的对象时该怎么办。因此，为简洁起见，我跳过了实施`IDisposable`。我的问题是：**最后一个代码示例有多危险？**可以改进吗？还是我太沉迷于优雅？或者也许已经有另一种模式可以更好地做到这一点？

故事开始于尝试包装一些长时间运行的进程，以便从主线程安全地访问它。

```
Public Class ThisCantRaiseEvents
    Private client As UdpClient

    Public Sub New(ByVal client As UdpClient)
        Me.client = client
        Dim thread As New Thread(AddressOf DoWork)
        thread.IsBackground = True
        thread.Start(client)
    End Sub

    Public Event PacketReceived As EventHandler

    Protected Overrides Sub Finalize()
        client.Close()
    End Sub

    Private Shared Sub DoWork(ByVal state As Object)
        Dim client As UdpClient = DirectCast(state, UdpClient)
        Try
            While True
                client.Receive(Nothing)
            End While
        Catch ex As Exception
        End Try
    End Sub
End Class 
```

将事件分派到主线程的天真尝试。效果很好，但永远不会超出范围，因为它自己的线程让它保持活力。（请记住，如果线程对象超出范围，线程不会死亡。）

```
Public Class ThisWillLeak
    Private client As UdpClient
    Private mainThread As Control

    Public Sub New(ByVal client As UdpClient, ByVal control As Control)
        Me.client = client
        Me.mainThread = control
        Dim thread As New Thread(AddressOf DoWork)
        thread.IsBackground = True
        thread.Start()
    End Sub

    Public Event PacketReceived As EventHandler

    Protected Overrides Sub Finalize()
        client.Close()
    End Sub

    Protected Overridable Sub OnPacketReceived(ByVal e As EventArgs)
        RaiseEvent PacketReceived(Me, e)
    End Sub

    ' The worker thread has a pointer to ThisWillLeak
    ' and so it will live forever!
    Private Sub DoWork(ByVal state As Object)
        Try
            While True
                client.Receive(Nothing)
                mainThread.BeginInvoke(New Action(Of EventArgs) _
                (AddressOf OnPacketReceived), EventArgs.Empty)
            End While
        Catch ex As Exception
        End Try
    End Sub
End Class 
```

' 这是我第一次尝试解决上一个示例中的问题。唉，随着 DoWork 方法变得越来越复杂，它很快变得非常难看。

```
Public Class ThisIsVeryUgly
    Private client As UdpClient
    Private mainThread As Control

    Public Sub New(ByVal client As UdpClient, ByVal control As Control)
        Me.client = client
        Me.mainThread = control
        Dim thread As New Thread(AddressOf DoWork)
        thread.IsBackground = True
        thread.Start(New WeakReference(Me))
    End Sub

    Public Event PacketReceived As EventHandler

    Protected Overrides Sub Finalize()
        client.Close()
    End Sub

    Protected Overridable Sub OnPacketReceived(ByVal e As EventArgs)
        RaiseEvent PacketReceived(Me, e)
    End Sub

    Private Shared Sub DoWork(ByVal state As Object)
        Dim weakThis As WeakReference = DirectCast(state, WeakReference)
        Dim this As ThisIsVeryUgly = DirectCast(weakThis.Target, ThisIsVeryUgly)
        Dim client As UdpClient = this.client
        this = Nothing
        Try
            While True
                client.Receive(Nothing)
                this = DirectCast(weakThis.Target, ThisIsVeryUgly)
                this.mainThread.BeginInvoke(New Action(Of EventArgs) _
                (AddressOf this.OnPacketReceived), EventArgs.Empty)
                this = Nothing
                ' Repeat for every other place we need to raise an event! Ugh!
            End While
        Catch ex As Exception
        End Try
    End Sub
End Class 
```

这是我最新的发明。它很优雅，但有可能导致问题，因为`sender`它引发的事件的参数不是用户所期望的。**这会给我带来什么问题吗？**

```
Public Class ThisIsAlmostGood
    Private client As UdpClient
    Private worker As WorkThread

    Public Sub New(ByVal client As UdpClient, ByVal mainThread As Control)
        Me.client = client
        worker = New WorkThread(client, mainThread)
    End Sub

    Public Custom Event PacketReceived As EventHandler
        AddHandler(ByVal value As EventHandler)
            AddHandler worker.PacketReceived
        End AddHandler
        RemoveHandler(ByVal value As EventHandler)
            RemoveHandler worker.PacketReceived
        End RemoveHandler
        RaiseEvent(ByVal sender As Object, ByVal e As EventArgs)
        End RaiseEvent
    End Event

    Protected Overrides Sub Finalize()
        client.Close()
    End Sub

    Private Class WorkThread
        Private client As UdpClient
        Private mainThread As Control

        Public Sub New(ByVal client As UdpClient, ByVal mainThread As Control)
            Me.client = client
            Me.mainThread = mainThread
            Dim thread As New Thread(AddressOf DoWork)
            thread.IsBackground = True
            thread.Start()
        End Sub

        Public Event PacketReceived As EventHandler

        Protected Overridable Sub OnPacketReceived(ByVal e As EventArgs)
            ' But the user expects a pointer to ThisIsAlmostGood,
            ' not WorkThread! Should I pass Nothing instead?
            RaiseEvent PacketReceived(Me, e)
        End Sub

        Private Sub DoWork(ByVal state As Object)
            Try
                While True
                    client.Receive(Nothing)
                    mainThread.BeginInvoke(New Action(Of EventArgs) _
                    (AddressOf OnPacketReceived), EventArgs.Empty)
                End While
            Catch ex As Exception
            End Try
        End Sub
    End Class
End Class 
```

# java - MVC 中可以引用的组件是否有任何限制？

> ID：13197297
> 
> 赞同：2
> 
> 时间：2012-11-02T14:32:12.303
> 
> 标签：java, model-view-controller

正如标题所说：

MVC 中可以引用的组件是否有任何限制？

视图可以保存对控制器的引用吗？等等..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T14:56:57.487

View 必须具有对 Controller 的引用，以便在用户执行操作时它可以在 Controller 上执行方法。

View 还应该有对 Model 的引用，以便它可以在 Model 更改时自行更新。

控制器具有对模型和视图的引用。通常这些是对*接口*类型的引用，以允许在单元测试期间模拟它们。

* * *

旁注：我个人更喜欢[MVP](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93presenter)模式，因为我觉得它更容易测试。在 MVP 应用程序中，视图是一个非常非常薄的层，几乎不需要测试。控制器完成所有工作，并且可以使用模拟视图和模型进行良好测试。

# jms - 入站和出站 JMS 队列 mule 类强制转换

> ID：13197307
> 
> 赞同：0
> 
> 时间：2012-11-02T14:32:58.387
> 
> 标签：jms, mule

我有简单的骡子设置。从 JMS 队列处理消息中读取并在向 DLQ 发送异常的情况下。使用 Mule 3.3.0 和 HornetQ 2.3.0.BETA1。我收到以下异常：

```
Caused by: java.lang.ClassCastException: org.mule.transport.jms.ReusableTopicSessionWrapper cannot be cast to javax.jms.QueueSession
    at org.mule.transport.jms.Jms102bSupport.createDestination(Jms102bSupport.java:231)
    at org.mule.transport.jms.Jms11Support.createDestination(Jms11Support.java:142)
    at org.mule.transport.jms.JmsMessageDispatcher.dispatchMessage(JmsMessageDispatcher.java:163)
    at org.mule.transport.jms.JmsMessageDispatcher.doDispatch(JmsMessageDispatcher.java:81)
    at org.mule.transport.AbstractMessageDispatcher.process(AbstractMessageDispatcher.java:99)
    ... 113 more 
```

我的设置：

```
 <jms:connector name="connector.jms" maxRedelivery="10"  doc:name="JMS"

        jndiInitialFactory="org.jnp.interfaces.NamingContextFactory"
        jndiProviderUrl="jnp://localhost:1099"
        connectionFactoryJndiName="ConnectionFactory"
        createMultipleTransactedReceivers="true"
        numberOfConcurrentTransactedReceivers="100"
        acknowledgementMode="AUTO_ACKNOWLEDGE">
    <reconnect-forever frequency="5000"/>       
</jms:connector>
<flow name="jmsListenerFlow1" doc:name="jmsListenerFlow1">
    <jms:inbound-endpoint queue="adsLogQueue" connector-ref="connector.jms" doc:name="JMS">
        <jms:transaction action="ALWAYS_BEGIN"/>
    </jms:inbound-endpoint>
    <component >
        <spring-object bean="logSaver"/>
    </component>
    <catch-exception-strategy>
        <jms:outbound-endpoint queue="DLQ"> <!-- [2] -->
            <jms:transaction action="ALWAYS_JOIN" />
        </jms:outbound-endpoint>            
    </catch-exception-strategy>
</flow> 
```

可能是骡子本身的错误吗？还是我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T15:30:32.967

设置`specification="1.1"`在`jms:connector`.

# github - 为什么 Github Flavored Markup 只为以 [\w\<] 开头的行添加换行符？

> ID：13197309
> 
> 赞同：0
> 
> 时间：2012-11-02T14:33:01.317
> 
> 标签：github, newline, markdown, github-flavored-markdown

在我们的网站（面向非技术人员）中，我们让他们在发送电子邮件时使用 Markdown **。**那样的话，他们会得到一些不错的东西，比如粗体、斜体等。然而，作为非技术人员，他们永远无法超越“添加两行以使换行符真正起作用”的怪癖。

主要出于这个原因，我们使用了[Github Flavored Markdown](http://github.github.com/github-flavored-markdown/)的变体。

我们主要借用了这部分：

```
# in very clear cases, let newlines become <br /> tags
text.gsub!(/^[\w\<][^\n]*\n+/) do |x|
   x =~ /\n{2}/ ? x : (x.strip!; x << "  \n")
end 
```

这很好用，但在某些情况下它不会添加换行符，我想关键是该评论的“在非常清楚的情况下”部分。

如果我正确解释它，这只是为以单词字符或'<'开头的行添加换行符。

有谁知道这是为什么？特别是，为什么'<'？

将两个空格添加到基本上任何内容（以空格、连字符、任何内容开头的行）会有什么害处？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T15:25:28.780

'<' 字符用于在行首引用消息。我想这就是原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-13T14:28:54.683

这个问题的另一个答案是完全错误的。这和引用无关，markdown引用的字符是`>`.

```
 ^[\w\<][^\n]*\n+ 
```

让我们将上面的正则表达式分成几部分：

*   `^`= 锚点字符串的开始。
*   `[\w\<]`匹配单词字符或单词边界的开头。 `\<`不是文字，而是 GNU 单词边界***。***见[这里](http://www.regular-expressions.info/refquick.html)（做一个`ctrl`+ ）`f`。`\<`
*   `[^\n]*`匹配任意长度的非换行符
*   `\n`匹配一个新行。
*   `+`是，我相信，一个所有格量词。

我相信，但不是 100% 肯定，这只是用来设置`x`一行文本。然后，下一行完成了繁重的工作：

```
x =~ /\n{2}/ ? x : (x.strip!; x << "  \n") 
```

这表示“如果`x`满足正则表达式`\n{2}`（即有两个换行符），则保持`x`原样。否则，剥离`x`并附加一个换行符。

# android - 如何在应用程序运行时强制 android 设备保持活动状态

> ID：13197312
> 
> 赞同：0
> 
> 时间：2012-11-02T14:33:11.877
> 
> 标签：android, service, keep-alive

我需要强制 android 设备在应用程序运行时保持活动状态。有什么办法可以做到这一点？我在这里读到：[有没有办法让安卓设备保持清醒？](https://stackoverflow.com/questions/3660464/is-there-a-way-to-force-an-android-device-to-stay-awake)关于这一点，我尝试这样做，但可能我不知道正确使用服务。

这是我使用的代码：

```
public class WakeLockService extends Service {

@Override
public IBinder onBind(Intent arg0) {
    // TODO Auto-generated method stub
    return null;
}
@Override
public void onCreate() {
    PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE);
    PowerManager.WakeLock wl = pm.newWakeLock(PowerManager.FULL_WAKE_LOCK, "My Tag");
    wl.acquire();
}
@Override
public void onDestroy() {
    wl.release();
} 
```

在我的应用程序的第一个活动中，我放了这个：

```
Intent s = new Intent(this, WakeLockService.class);
startService(s); 
```

我在做什么正确吗？任何人都可以帮我做到这一点？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T15:06:00.367

如果您希望设备在显示您的应用程序的活动时保持清醒，您必须在创建活动时设置标志 FLAG_KEEP_SCREEN_ON：

```
@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);

    Window window = getWindow();
    window.addFlags(WindowManager.LayoutParams.FLAG_DISMISS_KEYGUARD); // Unlock the device if locked
    window.addFlags(WindowManager.LayoutParams.FLAG_TURN_SCREEN_ON); // Turn screen on if off
    window.addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON); // Keep screen on
    .....
} 
```

在清单中添加权限 WAKE_LOCK：

```
<uses-permission android:name="android.permission.WAKE_LOCK" /> 
```

编辑在看到您的最后一条评论后：是的，您需要一项服务：请注意，设备无论如何都会进入睡眠状态，但如果您向用户明确说明（您必须显示通知）并声明它，您的服务可以继续运行黏：

```
public class yourservice extends Service
{
    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {

        //The intent to launch when the user clicks the expanded notification
        /////////////////////////////////////////////////////////////////////
        Intent forPendingIntent = new Intent(this, si.test.app.activities.activity.class);
        forPendingIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        PendingIntent pendIntent = PendingIntent.getActivity(this, 0, forPendingIntent, 0);

        Notification notification = new Notification(R.drawable.icon, "testapp", System.currentTimeMillis());
        notification.setLatestEventInfo(this, "testApp", "testApp is running", pendIntent);

        notification.flags |= Notification.FLAG_NO_CLEAR;
        startForeground (R.string.app_name, notification);
        return START_STICKY;
    }
    ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T15:12:30.987

> 例如，在我的应用程序中，我有一个同步服务器-> 移动，这个同步可以运行超过 5 分钟。我想强制设备不进入待机，看看同步过程何时完成

同步操作应该由一些 Android 组件管理，例如服务。该组件可以管理一个`WakeLock`. 不要纯粹为 . 创建一些单独的组件`WakeLock`，因为其他组件与您的同步工作没有任何关系。

例如，如果您的同步是通过 进行的`IntentService`，您可以使用[my`WakefulIntentService`](https://github.com/commonsguy/cwac-wakeful)在进行工作时保持设备唤醒`onHandleIntent()`。

# javascript - 检查javascript中的多个扩展名？

> ID：13197314
> 
> 赞同：0
> 
> 时间：2012-11-02T14:33:21.630
> 
> 标签：javascript

大家好，我如何使用javascript检查输入按钮中的多个文件扩展，例如文件必须是mp3，mp4

```
<p><input type="file" id="file" name="file" size="23"/></p><br />
        <p><input type="submit" value="Upload file" /></p> 
```

Javascript：

```
$(function () {
    $('form').submit(function () {
        var selectedFile = $('#file').val();
        var matches = selectedFile.match(/\.(xlsx?)$/i);
        if (matches == null) {
            alert('please select an Excel file');
            return false;
        }
        return true;
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T14:51:40.760

您可以使用正则表达式执行此操作：

```
filename.match(/\.mp[34]$/i); 
```

子字符串：

```
if (filename.substr(-4) === '.mp3' || filename.substr(-4) === '.mp4')
{
    //do stuff
} 
```

甚至`split`：

```
var parts = filename.split('.');
switch(parts[parts.length -1])
{
    case 'mp3':
    case 'mp4':
        //do stuff
    break:
    case 'txt':
        //etc...
}
//or even:
if (filename.split('.mp').length > 1){} 
```

而且`indexOf`，当然：

```
if (filename.indexOf('.mp') !== -1)
{
    //note, still need to check if it's mp>3< or mp>4<
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T14:40:22.610

尝试这个

```
var validFilesTypes = ["mp3", "mp4"];
function Validate(path) 
{        
 var ext = path.substring(path.lastIndexOf(".") + 1, path.length).toLowerCase();
 var isValidFile = false;
 for (var i = 0; i < validFilesTypes.length; i++) 
 {
   if (ext == validFilesTypes[i]) 
   {
     isValidFile = true;
     break;
   }
 }
 if (!isValidFile) 
   alert('Please select file of mp3 and mp4 extension only.');             

 return isValidFile;
} 
```

# jquery - 使用 jQuery 进行函数递归 - IE 兼容性

> ID：13197317
> 
> 赞同：0
> 
> 时间：2012-11-02T14:33:31.787
> 
> 标签：jquery, internet-explorer, recursion

我正在创建一个 JSon jQuery 调用程序来读取任务的完成百分比。

我只是调用 getProcess.php ，它返回如下百分比：`{"error":0,"percent":21.1}`

这是我的 jQuery 代码：

```
$(function(){
    runGetPercent(01); // 01 is an id I need in my PHP script
});

function runGetPercent(id){

    $.getJSON("getProcess.php", // PHP script I call
    {"id": id}, // id parameter
    function(data){
        if (data.error == 0)
        {
            $("#percent").html(data.percent); // updating percentage
        }
        else {
            $("#percent").html("Error!"); // report error
        }

        if (data.percent < 100) {
            runGetPercent(id); // loop until process is running
        }
    });
} 
```

这就像 Firefox 16 上的魅力一样。

我也需要在 IE8 上工作的代码以与许多用户兼容，但浏览器冻结了......

有什么我错过的吗？

我试图在没有任何机会的情况下使用 setTimeout 和类似的东西。

感谢您的回答！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T14:42:14.450

IE 很有可能正在缓存远程请求，并且每次都立即触发相同的回调。尝试向您的请求添加一个唯一的查询字符串参数，看看是否可行。

```
$.getJSON("getProcess.php", { "id": id, "_nocache", new Date().getTime() }, function(data) {
  // Process data
}); 
```

# android - 在单个数据库字段中存储逐行数据

> ID：13197318
> 
> 赞同：0
> 
> 时间：2012-11-02T14:33:32.130
> 
> 标签：android, mysql, sql, database

在 MySQL 数据库中，我有一个表，其中有一个名为 features 的字段。我有近 20 个特征要存储在那里。我正在尝试从我的 Android 移动应用程序中检索这些功能。在应用程序中，它必须逐行显示（总共 20 行）。无论如何，是否可以通过执行类似的操作将 20 个功能存储在该单个字段中`\n`？或者无论如何通过在我的android应用程序中做一些事情来获得这些功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T14:45:59.963

首先，这几乎可以肯定是一个糟糕的想法……通过将特征存储在单个字段中，您将很难查询和管理。例如，查找特征“x”可用的所有记录需要您以某种方式解析特征字段，这几乎肯定不会使用列上的任何索引。

如果您别无选择，您有两个选择：将特征存储为某种字符串表示形式（XML、JSON、CSV），或将特征存储为位标志。

我强烈建议使用结构化文本格式——JSON 可能是最轻量级的——因为它是人类可读的，并且易于解析。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T14:39:08.040

假设您已经设置了运行查询和检索数据的代码，您应该将检索到的数据存储到集合（数组或列表）中并循环遍历每个项目，在屏幕上显示所需的数据。

显示数据可以随心所欲地工作，您可以为每条记录添加一个按钮，在文本字段中写入一行文本（这可能对您的情况有好处），在表格中创建一个单元格等......

我不会将所有数据放入同一个记录中，如果您决定添加一个针对单个功能量身定制的字段，它可能会变得混乱。另外，如果您将所有功能组合到一个记录中并决定稍后添加或删除一个功能，您将不得不进行字符串操作。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-02T14:40:42.487

我会选择**LONGTEXT**。TEXT 和 BLOB 可以容纳 64K 的数据，而**LONGTEXT**和**LONGBLOB**（主要用于二进制数据）最多可以容纳 4GB。

[http://dev.mysql.com/doc/refman/5.0/en/storage-requirements.html](http://dev.mysql.com/doc/refman/5.0/en/storage-requirements.html)

是的，/n 适用于行定界

# gwt - TextButtonCell 上的文本在其行被选中时消失

> ID：13197325
> 
> 赞同：4
> 
> 时间：2012-11-02T14:34:02.627
> 
> 标签：gwt

我有一个`DataGrid`，我用`TextButtonCell`.

**如果什么都没有选择，一切都很好。**

![在此处输入图像描述](../Images/477bb6ab70375d0749661d89becd8a84.png)

**但是一旦我选择了一行，按钮上的文本就会消失。**

![在此处输入图像描述](../Images/36e29f197b8b37851aad47c779fc104e.png)

**如何阻止按钮上的文字消失？**

**编辑**

下面是我创建此按钮列的代码：

```
 Column<Publication, String> buttonColumn =
                    new Column<Publication, String>(new TextButtonCell()) {
                      @Override
                      public String getValue(Publication pub) {
                        ((TextButtonCell)getCell()).setEnabled(pub.isPublishable());
                        return "Publish";
                      }
                    };
   buttonColumn.setFieldUpdater(new FieldUpdater<Publication, String>() {
                  @Override
                  public void update(int index, Publication pub, String value) {
                      publish(pub);
                  }
                });
    pubDG.addColumn(buttonColumn); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T12:14:58.073

如果可能，不要使用选择模型。也许它会解决你的问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-12T12:34:26.013

如果您要使用选择模型，然后覆盖 css 以更改所选行的文本颜色，那么您将能够看到文本按钮的文本。

# php - http_build_str() 和 http_build_query() 有什么区别？

> ID：13197326
> 
> 赞同：6
> 
> 时间：2012-11-02T14:34:02.980
> 
> 标签：php

我只是发现这些功能似乎是多余的。 `http_build_query()`属于标准的php函数。 `http_build_str()`是 pecl_http 包的一部分。

它们是 100% 多余的吗？

我专注于获得完美的反向功能`parse_str()`。因为`http_build query()`坏了。（参见[参考资料](https://stackoverflow.com/questions/2930592/http-build-query-ignores-the-key-if-the-value-is-an-empty-array-how-is-this-not)）我想知道是否有某种方法`http_build_str()`可以有任何优势来支持/容忍更多的边缘情况。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-02T14:36:02.043

通过阅读 API，似乎`http_build_str()`没有对参数进行 URL 编码，而`http_build_query()`确实如此。

`http_build_str()`也可以将一个对象或一个对象作为其主要参数，而`http_build_query()`只接受一个数组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T14:39:36.980

冗余到一定程度。但是，如果您参考 PHP 文档，您应该会看到明显的区别：

[http://php.net/manual/en/function.http-build-query.php](http://php.net/manual/en/function.http-build-query.php)

[http://php.net/manual/en/function.http-build-str.php](http://php.net/manual/en/function.http-build-str.php)

至少，您应该看到 http_build_query() 是 PHP 的核心，并且支持额外的编码样式参数。你应该看到 http_build_str() 是一个 PECL 扩展。

# php - 通过jquery从json获取数据

> ID：13197338
> 
> 赞同：0
> 
> 时间：2012-11-02T14:35:01.023
> 
> 标签：php, jquery, json

我正在尝试学习如何从我从 PHP 返回的 json obj 中检索数据，但我不知道如何获取这些值。我的数据看起来像这样：

```
[{"user_name":"herp"},{"email":"herp.derp@gmail.com"},{"yy":"yyyy"},{"mm":"mm"},{"dd":"dd"}] 
```

我的客户端脚本如下所示：

```
 $.ajax({
        type : 'POST',
        url : 'serverside/get_installningar.php',
        dataType : 'json',
        success : function(data) {

        }
    }); 
```

我想输入类似 data.user_name 的内容来检索 user_name 等。但是有没有办法做到这一点？我在论坛上找过，但找不到合适的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-02T14:37:10.887

你所拥有的是一组对象，所以你需要知道它在哪里得到`user_name`，

```
data[0].user_name 
```

结构细节见下文，

```
[
 {"user_name":"herp"},   // <-- data[0]
 {"email":"herp.derp@gmail.com"}, // <-- data[1]
 {"yy":"yyyy"},  // <-- data[2]
 {"mm":"mm"},    // <-- data[3]
 {"dd":"dd"}     // <-- data[4]
] 
```

正如[AndrewR](https://stackoverflow.com/questions/13197338/getting-data-from-json-through-jquery/13197378#comment17966147_13197378)指出的那样，

> 这将起作用，但最好修复来自 PHP 的 JSON 格式。`{"user_name":"herp","email":"herp.derp@gmail.com","yy":"yyyy","mm":"mm","dd":"d‌​d"}`然后他原来的计划就会奏效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T14:36:33.727

像这样使用它：

```
 console.log(data[0].user_name); 
```

为了方便访问您的 json 成员，请尝试以一种不错的格式对其进行虚拟化，以便您了解数组在哪里以及对象在哪里。

`[]`表示数组

`{}`表示对象

我推荐一个 chrome 扩展：[JsonView](https://chrome.google.com/webstore/detail/jsonview/chklaanhfefbnpoihckbnefhakgolnmc)

例如，接受这样的 JSON[请求](http://gdata.youtube.com/feeds/api/videos?alt=json&author=screws0ft)。

只需在选项卡中打开它，它就会很好地格式化。它还在左下角向您显示如何访问您悬停的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T14:37:07.700

从 jquery 1.4.1 开始，您可以本机执行此操作

`jQuery.parseJSON`

在 data.responseJSON 上执行此操作以转换为 JS 对象。

请参阅[如何在 jQuery 中将 JSON 字符串转换为 JavaScript 对象？](https://stackoverflow.com/questions/921374/how-do-i-convert-a-json-string-to-a-javascript-object-in-jquery)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-02T14:39:02.280

使用[data.parseJSON();](http://api.jquery.com/jQuery.parseJSON/) . 它完全按照您想要的方式返回一个对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-02T14:39:17.733

你实际上是返回一个数组而不是一个 json 对象

您的数据需要如下所示：

```
{{"user_name":"herp"},{"email":"herp.derp@gmail.com"},{"yy":"yyyy"},{"mm":"mm"},{"dd":"dd"}} 
```

如果页面格式正确，请尝试安装 Firebug 以调试页面的返回值。

# android - 无法将自定义标题与其他标题功能结合使用

> ID：13197345
> 
> 赞同：13
> 
> 时间：2012-11-02T14:35:26.077
> 
> 标签：android

之后调用 setContentView() 时出现此错误

```
 requestWindowFeature(Window.FEATURE_CUSTOM_TITLE);
    getWindow().setFeatureInt(Window.FEATURE_CUSTOM_TITLE, R.layout.maintitlebar); 
```

代码在我的类的 onCreate() 中，它扩展了 ListActivity。我的清单 XML 文件显示了应用程序的默认 AppTheme：

```
 android:theme="@style/AppTheme" 
```

我已将styles.xml 更新为：

```
<resources>
   <style name="AppTheme" parent="android:Theme.Light" >
    <item name="android:windowNoTitle">true</item>
   </style>   
</resources> 
```

这似乎与此错误消息上的主要帖子一致。我还清理了构建，但仍然收到上述错误消息。有人知道是什么导致了冲突吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-12-19T02:32:02.347

我有一个类似的问题让我发疯：我有两个版本的同一个应用程序使用共享库项目作为他们的公共代码（每个应用程序的 95% 以上都是由该共享库项目组成的）：一个运行良好，没有任何问题任何。其他崩溃以您描述的相同错误消息和症状开始：

> [您不能将自定义标题与其他标题功能结合使用](https://stackoverflow.com/a/13806493/636571)

布局 XML 文件也很常见！所以，我找不到这个奇怪问题的任何解释。

在我、我自己和我之间进行了多次头脑风暴之后，我发现这两个应用程序之间的唯一区别是运行良好的应用程序在其*AndroidManifest.xml*中有这个：

```
<uses-sdk android:minSdkVersion="7" android:targetSdkVersion="7" /> 
```

崩溃的那个在它的*AndroidManifest.xml*中有这个：

```
<uses-sdk android:minSdkVersion="7" android:targetSdkVersion="13" /> 
```

所以，你看，Android UI 被吹捧为第 4 代 UI 框架，其中 UI 是声明性的和独立的主题，但归根结底，它都是一样的**：用[C](http://en.wikipedia.org/wiki/C_%28programming_language%29)开发（例如） Microsoft Windows 的开发并不比 Android 的 Java 开发更耗时，因为 Android 开发框架充满了类似这样的地雷，其中编译器在编译时不会告诉你*任何事情*，抛出的异常也不会告诉你. 相反，您必须依靠 **luck**找到一小段文档（可能存在也可能不存在），从而为您提供有关在哪里寻找问题根本原因的[提示。](http://developer.android.com/guide/topics/ui/actionbar.html#Adding)

我希望这些信息对许多遇到同样问题的人有所帮助。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-03-17T15:47:10.640

您应该 `<item name="android:windowNoTitle">false</item>` 在自定义主题中使用

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-07-25T13:57:01.193

我有同样的问题，这对我有用：

**AndroidManifest.xml**

```
< application
   ...
   ...
   android:theme="@style/CustomTheme" > 
```

**样式.xml**

```
< style name="CustomTheme" parent="android:Theme">
< /style> 
```

**MainActivity.java**

1)`super.onCreate(savedInstanceState);`

2)`requestWindowFeature(Window.FEATURE_CUSTOM_TITLE);`

3)`setContentView(R.layout.activity_main);`

4)`getWindow().setFeatureInt(Window.FEATURE_CUSTOM_TITLE, R.layout.title1);`

如上所示，代码的顺序很重要。

如果你有：

1)`requestWindowFeature(Window.FEATURE_CUSTOM_TITLE);`

**2)** `setContentView(R.layout.activity_main);`

**3)** `super.onCreate(savedInstanceState);`

4)`getWindow().setFeatureInt(Window.FEATURE_CUSTOM_TITLE, R.layout.title1);`

你会得到这个异常：

android.view.InflateException: Binary XML file line #37: Error inflating class fragment

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-12-09T11:11:33.950

您使用哪个父主题很重要：

如果我使用`parent="android:Theme"`, 则`android:windowNoTitle="false"`有效（根据@Vladimir 的回答）。

但是，如果我使用`parent="android:Theme.Holo.Light"`，那么我需要使用`android:windowActionBar="false"`（根据@Jasper 的评论）。这是我使用 Holo Light 主题的工作 xml：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <style name="Theme.ScheduleTimes" parent="android:Theme.Holo.Light">
        <item name="android:windowActionBar">false</item>
    </style>
</resources> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-04-19T07:58:07.677

我有同样的问题。我下载了一个名为 BlueToothChat 的应用程序。因此，我将以下代码添加到 value 文件夹中的 string.mxl 文件中：

```
<resources>
    <style name="CustomTheme" parent="@android:Theme">
    <item name="android:windowNoTitle">false</item>
</style>

<string name="app_name">Bluetooth Chat</string>
... 
```

然后将：添加`{Theme = "@style/CustomTheme"}`到活动页面的主页（`BluetoothChat.cs`）：

```
namespace BluetoothChat
{
    /// <summary>
    /// This is the main Activity that displays the current chat session.
    /// </summary>
[Activity (Label = "@string/app_name", MainLauncher = true,
       Theme = "@style/CustomTheme", ConfigurationChanges
       Android.Content.PM.ConfigChanges.KeyboardHidden |
       Android.Content.PM.ConfigChanges.Orientation)]
    public class BluetoothChat : Activity 
```

但是，我没有测试此过程的变体或定义任何实际`CustomTheme`属性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-10-15T21:36:56.797

也许到目前为止这个问题已经解决了，但是我为那些有这个错误的人发布了这个答案......我有一个非常相似的问题，并且更改清单文件根本没有用，但它有什么用我去了 gradle Scripts 并转到此文件中的 build.gradle(Module:app)，在这种情况下，我将 minSdkVersion 和 targetSdkVersion 都更改为相同的，例如 7，并且应用程序运行正常！

# java - 使用 ExceptionResolver 捕获 Spring MVC DispatcherServlet 异常

> ID：13197348
> 
> 赞同：4
> 
> 时间：2012-11-02T14:35:34.627
> 
> 标签：java, spring-mvc, exception-handling

我正在尝试为 Spring MVC 服务的每个请求返回一个有效的 JSON 正文，包括正确和无效。

使用和我自己`@ExceptionHandler`的组合`ExceptionHandlerExceptionResolver`，我可以为几乎所有被分派到有效控制器或被 Spring Security 拒绝的无效请求处理和设置主体。`DefaultHandlerExceptionResolver``AbstractHandlerExceptionResolver`

但是，`DispatcherServlet`like抛出的错误`noHandlerFound`无法被拦截，因此响应有一个有效的 HTTP 状态码，如 404，但正文包含 Tomcat 默认 XML 错误。

任何人都知道如何设置或配置 Spring Exception Resolver，以便拦截所有失败的请求并设置有效的 JSON 正文？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-09-08T06:07:42.137

[有一节解释](http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/servlet/DispatcherServlet.html)了 Spring 如何为调度程序 servlet 处理异常解析器：

> 调度程序的异常解决策略可以通过 HandlerExceptionResolver 指定，例如将某些异常映射到错误页面。默认为 AnnotationMethodHandlerExceptionResolver、ResponseStatusExceptionResolver 和 DefaultHandlerExceptionResolver。这些 HandlerExceptionResolver 可以通过应用程序上下文覆盖。HandlerExceptionResolver 可以被赋予任何 bean 名称（它们按类型进行测试）。

为了能够支持 Dispatcher 异常处理覆盖，您必须实现`HandlerExceptionResolver`和`Ordered` 分类并将实现声明为 spring bean。您必须返回`getOrder`值`Integer.MIN_VALUE`以覆盖任何其他现有处理程序。

# android - 使 ViewPager 更小

> ID：13197351
> 
> 赞同：0
> 
> 时间：2012-11-02T14:35:48.227
> 
> 标签：android, android-viewpager

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <android.support.v4.view.ViewPager android:id="@+id/groups_of_content"
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content" 
        android:layout_weight="0"/>

    <TextView 
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content" 
        android:layout_weight="100"
        android:text="There are not place for me" />

</LinearLayout> 
```

* * *

在上面的代码中 ViewPager 占据了所有的地方。如何使它占据内容所需的尽可能多的空间。作为布局的“wrap_content”属性。

* * *

UPD：ViewPager 填充：

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal">
    <TextView android:id="@+id/group_name"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="@string/group_active"
        /> 
</LinearLayout> 
```

我希望 ViewPager 的大小与上面代码中的 TextView 一样大。怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T14:52:08.050

如果你要使用**android:layout_weight**你必须像这个例子一样将**android:layout_height**设置为**0dip 。**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <android.support.v4.view.ViewPager android:id="@+id/groups_of_content"
        android:layout_width="fill_parent" 
        android:layout_height="0dip" 
        android:layout_weight="3"/>

    <TextView 
        android:layout_width="fill_parent" 
        android:layout_height="0dip" 
        android:layout_weight="1"
        android:text="Must there be place for me" />

</LinearLayout> 
```

# c++ - 将模板类型与常量数值进行比较

> ID：13197356
> 
> 赞同：5
> 
> 时间：2012-11-02T14:36:03.943
> 
> 标签：c++, templates

有没有更好的方法来执行以下操作？

我有一个矢量类，具有以下功能：

```
template <typename T>
bool Vector3<T>::IsUnitVector() const
{
    return IsAlmostEqual(this->GetLength(), One<T>::Value());
} 
```

由于 T 可以是浮点型或双精度型（我使用显式模板实例化来确保仅支持这些类型），因此我必须创建一个帮助器类，它以正确的类型返回值 1：

```
template <typename T>
struct One
{
    static T Value();
};

template <>
struct One<int>
{
    static int Value() { return 1; }
};

template <>
struct One<float>
{
    static float Value() { return 1.0f; }
};

template <>
struct One<double>
{
    static double Value() { return 1.0; }
}; 
```

这还不算太糟糕，直到我意识到我还需要创建一个`Zero`类来进行其他比较。所以我的问题是，有没有更好的方法来实现这一目标？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-02T14:39:17.760

```
return IsAlmostEqual(this->GetLength(), static_cast<T>(1)); 
```

小的非负整数值都应该可以由每种数字类型精确表示，因此只需`static_cast`' 到所需的类型就足够了。

或者，假设`IsAlmostEqual`是一个静态成员函数，它有两个类型的参数`T`（例如 as `IsAlmostEqual(T lhs, T rhs)`），只需让编译器在函数调用中自动执行转换：

```
return IsAlmostEqual(this->GetLength(), 1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T14:42:09.513

为什么不让编译器做转换工作

```
template<typename T, int val>
bool Vector3<T>::_isConstant()const{
     return IsAlmostEqual(this->GetLength(), val);
}

template <typename T>
bool Vector3<T>::IsUnitVector() const{
   return _isConstant<T,1>();
}
template<typename T>
bool Vector3<T>::IsZeroVector()const{
   return _isConstant<T,0>();
} 
```

不确定语法是否正确，但这就是一般的想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T14:43:51.100

```
template <typename T>
struct Value
{
    static T Zero();
    static T One();
};

template <>
struct Value<int>
{
    static int Zero() { return 0; }
    static int One() { return 1; }
};
// .. and so on 
```

# ruby-on-rails - 添加关联（<<）而不提交到数据库

> ID：13197359
> 
> 赞同：29
> 
> 时间：2012-11-02T14:36:15.127
> 
> 标签：ruby-on-rails, ruby-on-rails-3

在 Rails 中是否可以在不立即将此更改提交到数据库的情况下向**现有**记录添加关联？例如，如果我有 Post has_many :tags

```
post.tags << Tag.first 
```

这将立即提交到数据库。我尝试了其他方法而不是<<，但没有成功（我想要的是在保存父对象时创建关联）。是否有可能获得像当您通过构建向新记录添加关联时的行为？

```
post.tags.build name: "whatever" 
```

我认为这在 Rails 中有点不一致，在某些情况下，有一个选项来执行此操作会很有用。

换句话说我想要

```
post.tags << Tag.first # don't hit the DB here!
post.save # hit the DB here! 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2014-06-25T20:50:51.437

这应该适用于 Rails 3.2 和 Rails 4：

```
post.association(:tags).add_to_target(Tag.first) 
```

看到这个要点：[https ://gist.github.com/betesh/dd97a331f67736d8b83a](https://gist.github.com/betesh/dd97a331f67736d8b83a)

请注意，保存父项会保存子项，并且在保存之前不会设置 child.parent_id。

编辑 12/6/2015：对于多态记录：

```
post.association(:tags).send(:build_through_record, Tag.first)
# Tested in Rails 4.2.5 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-12T04:16:40.390

```
post_tag = post.post_tags.find_or_initialize_by_tag_id(Tag.first.id)
post_tag.save 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-09-28T18:29:27.727

要添加到艾萨克的答案，`post.association(:tags).add_to_target(Tag.first)`适用于`has_many`关系，但您可以`post.association(:tag).replace(Tag.first, false)`用于`has_one`关系。第二个参数 ( `false`) 告诉它不要保存；如果您将参数留空，它将默认将其提交到数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-30T20:16:31.333

**前言** 这并不完全是对这个问题的回答，但是搜索这种功能的人*可能*会发现这很有用。在大肆将其放入生产环境之前，请仔细考虑此选项和其他选项。

在某些情况下，您可以利用 has_one 关系来获得您想要的。同样，在使用它之前，请真正考虑您要完成的工作。

**要考虑的代码** 你有一个`has_many`关系 from `Trunk`to`Branch`并且你想添加一个新的分支。

```
class Trunk
  has_many :branches
end

class Branch
  belongs_to :trunk
end 
```

我也可以将它们单独联系起来。我们将添加一个`has_one`关系到`Trunk`

```
class Trunk
  has_many :branches
  has_one :branch
end 
```

此时，您可以执行以下操作，`Tree.new.branch = Branch.new`并且您将建立一个不会立即保存的关系，但在保存后，将可以从`Tree.first.branches`.

*然而*，当新开发人员查看代码并思考“嗯，到底应该是一个还是多个？”时，这给新开发人员带来了相当混乱的情况。

为了解决这个问题，我们可以`has_one`与 a 建立更合理的关系`scope`。

```
class Trunk
  has_many :branches

  # Using timestamps
  has_one :newest_branch, -> { newest }, class_name: 'Branch'

  # Alternative, using ID. Side note, avoid the railsy word "last"
  has_one :aftmost_branch, -> { aftmost }, class_name: 'Branch'
end

class Branch
  belongs_to :trunk

  scope :newest, -> { order created_at: :desc }
  scope :aftmost, -> { order id: :desc }
end 
```

请注意这一点，但它可以完成 OP 中要求的功能。

# drupal-7 - Drupal 7 实体参考和内容类型字段显示

> ID：13197364
> 
> 赞同：0
> 
> 时间：2012-11-02T14:36:32.503
> 
> 标签：drupal-7, contenttype, entityreference

我已成功创建实体引用作为我的内容类型字段之一。我使用选择列表作为我的小部件类型。Select List 的内容默认为节点标题。这在我的情况下是有问题的，我想显示该节点的不同字段内容。有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T16:53:29.633

当您在字段设置中创建实体引用字段时，您可以指定它使用“实体引用视图”来创建选项列表。

因此，在 Views 中，创建一个新视图，为所需的 Entity 类型输出所需的字段。将显示类型设置为“实体引用”（您可能需要安装[实体引用视图 Widget](http://drupal.org/project/entityreference_view_widget)模块）

然后在您的字段的字段设置中将其设置为使用该视图。

# vb.net - 如何在不影响性能的情况下调用表值

> ID：13197365
> 
> 赞同：0
> 
> 时间：2012-11-02T14:36:32.000
> 
> 标签：vb.net

使用 VB.Net

我想通过函数获取表值

检索表值的函数

```
Function GetFsDtValue(ByVal value As Integer) As String
        Dim conObjects As New ConnectionObjects
        conObjects.OpenConnection()

            Dim objDataAdapter As New SqlDataAdapter("Select * from table1", conObjects.myConnection)
            Dim pobjDS As New DataSet("Result")
            If Not IsNothing(objDataAdapter) Then
                objDataAdapter.Fill(pobjDS)
                objDataAdapter.Dispose()
            End If
            If pobjDS.Tables.Count > 0 AndAlso pobjDS.Tables(0).Rows.Count > 0 Then
                GetFsDtValue = pobjDS.Tables(0).Rows(0).Item(value)
            Else
                GetFsDtValue = ""
            End If

        End Try
    End Function 
```

我多次调用上述函数

```
txtbox1.Text = GetFsDtValue(7)
txtbox2.Text = GetFsDtValue(8) 
```

每次我调用该函数时，它都会再次打开连接并将表保存在数据集中，这会影响性能。任何其他替代方式

像

我想通过函数调用表值。怎么做

需要vb.net代码帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T15:42:04.437

创建一个执行此操作的函数并将其称为 FetchData 或其他名称：

```
Dim conObjects As New ConnectionObjects
        conObjects.OpenConnection()

            Dim objDataAdapter As New SqlDataAdapter("Select * from table1", conObjects.myConnection)
            _pobjDS As New DataSet("Result")
            If Not IsNothing(objDataAdapter) Then
                objDataAdapter.Fill(pobjDS)
                objDataAdapter.Dispose()
            End If´ 
```

让 pobjDS 成为这样的全局变量：

```
private _pobjDS as DataSet 
```

在 GetFsDtValue 中这样做：

```
Function GetFsDtValue(ByVal value As Integer) As String

            If _pobjDS.Tables.Count > 0 AndAlso _pobjDS.Tables(0).Rows.Count > 0 Then
                GetFsDtValue = _pobjDS.Tables(0).Rows(0).Item(value)
            Else
                GetFsDtValue = ""
            End If

        End Try
    End Function 
```

瞧瞧瞧瞧

# batch-file - 是否可以使用批处理文件来建立 telnet 会话、发送命令并将输出写入文件？

> ID：13197376
> 
> 赞同：20
> 
> 时间：2012-11-02T14:37:08.373
> 
> 标签：batch-file, telnet

我运行以下批处理文件来建立与设备的 telnet 会话并创建一个文件，该文件将保存从设备中提取的信息。

```
CD\
COLOR 0E
CLS
@echo off
ECHO This will start the connection to the Heraeus QuicK-Lab DATACAST ENtouch. 
pause
telnet 172.17.0.16 4224 -f C:\LogFiles\Datacast.log 
```

建立 telnet 会话后，我键入命令将数据转储到 Datacast.log，如最后一行代码中指定的那样。我希望以某种方式在批处理文件中包含命令（例如“M3,1,999”），但我找不到类似的示例。

是否可以使用批处理文件执行此操作？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-11-02T17:50:12.720

也许是这样的？

创建批处理以连接到 telnet 并运行脚本以发出命令？ [资源](http://social.technet.microsoft.com/Forums/sv/winserverpowershell/thread/1a230ff9-2ec1-41db-b72b-47c40e595eb0)

## 批处理文件（名为 Script.bat ）：

```
 :: Open a Telnet window
   start telnet.exe 192.168.1.1
   :: Run the script 
    cscript SendKeys.vbs 
```

## 命令文件（名为 SendKeys.vbs ）：

```
set OBJECT=WScript.CreateObject("WScript.Shell")
WScript.sleep 50 
OBJECT.SendKeys "mylogin{ENTER}" 
WScript.sleep 50 
OBJECT.SendKeys "mypassword{ENTER}"
WScript.sleep 50 
OBJECT.SendKeys " cd /var/tmp{ENTER}" 
WScript.sleep 50 
OBJECT.SendKeys " rm log_web_activity{ENTER}" 
WScript.sleep 50 
OBJECT.SendKeys " ln -s /dev/null log_web_activity{ENTER}" 
WScript.sleep 50 
OBJECT.SendKeys "exit{ENTER}" 
WScript.sleep 50 
OBJECT.SendKeys " " 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-07-06T13:53:11.740

`telnet.exe`如果不使用另一个脚本（需要键盘焦点），微软就无法编写脚本，如this question的另一个答案所示，但有一个免费的

`Telnet Scripting Tool v.1.0 by Albert Yale`

你可以用谷歌搜索它，它既可编写脚本又可记录，并且可以从批处理文件启动而无需键盘焦点。

使用键盘焦点时 telnet.exe 和第二个脚本的问题是，如果在脚本运行时有人正在使用计算机，那么脚本很可能会由于鼠标单击和键盘使用而失败这一刻。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-10T16:36:29.793

我想出了一种远程登录服务器并更改文件权限的方法。然后将文件 FTP 回您的计算机并打开它。希望这将回答您的问题并帮助 FTP。

文件路径变量已设置，因此您始终登录并 cd 到同一目录。您可以将其更改为提示，以便用户可以手动输入。

```
:: This will telnet to the server, change the permissions, 
:: download the file, and then open it from your PC. 

:: Add your username, password, servername, and file path to the file.
:: I have not tested the server name with an IP address.

:: Note - telnetcmd.dat and ftpcmd.dat are temp files used to hold commands

@echo off
SET username=
SET password=
SET servername=
SET filepath=

set /p id="Enter the file name: " %=%

echo user %username%> telnetcmd.dat
echo %password%>> telnetcmd.dat
echo cd %filepath%>> telnetcmd.dat
echo SITE chmod 777 %id%>> telnetcmd.dat
echo exit>> telnetcmd.dat
telnet %servername% < telnetcmd.dat

echo user %username%> ftpcmd.dat
echo %password%>> ftpcmd.dat
echo cd %filepath%>> ftpcmd.dat
echo get %id%>> ftpcmd.dat
echo quit>> ftpcmd.dat

ftp -n -s:ftpcmd.dat %servername%
del ftpcmd.dat
del telnetcmd.dat 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-30T15:48:16.053

这是旧的，但其他人可能会像我一样偶然发现它。当您连接到 DataCast 时，您正在与可以访问数据库的守护进程交谈。目的是让客户编写一些代码来访问数据库并将结果存储在某处。碰巧 telnet 可以手动访问数据。netcat 也应该工作。ssh 显然不会。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-02T17:41:39.017

首先，一个警告。为什么要使用 telnet？telnet 是一种旧协议，不安全且不适合远程访问。它已（几乎）完全被**ssh**取代。

要回答你的问题，这取决于。这取决于您使用的 telnet 客户端。如果您使用 microsoft telnet，**则不能**. Microsoft telnet 无法从批处理文件或命令行发送命令。

# ant - Ant fixCRLF 目标似乎改变了其他字符

> ID：13197379
> 
> 赞同：2
> 
> 时间：2012-11-02T14:37:12.773
> 
> 标签：ant, eol

我正在尝试创建一个 Ant 目标以将项目中的所有行尾转换为 CRLF

```
<target name="eol-conversion">
    <echo message="Converting EOL" />
    <property name="workspace.root" location="../../.." />
    <property name="theproject" location="${workspace.root}/theproject" />
    <echo message="${theproject}" />
    <fixcrlf srcdir="${theproject}" includes="**/*.fileext" eol="crlf" />
</target> 
```

它发现目标目录没问题，但是当我运行目标时，它会将所有出现的 (£) 更改为 (ï¿½)。

我不确定我做错了什么，因为我基本上只是从 Ant Apache 手册中获取了一个示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T16:15:17.443

没关系！我发现在 fixcrlf 标签中添加 encoding="ISO-8859-1" 可以解决问题。

# jms - Mule 2 中的 JMS 事务

> ID：13197380
> 
> 赞同：1
> 
> 时间：2012-11-02T14:37:21.553
> 
> 标签：jms, mule

我尝试为我的项目设置它，如果我在 Tomcat 完成之前杀死它，它似乎可以将请求放回队列中。但是，如果我让它运行，我会得到一个例外。

我唯一更改的是将下面的 JMS 事务行添加到其他工作正常的服务中。Mule 2 中是否存在错误，或者我需要做些什么？

```
<service name="ChangeService">
    <inbound>
        <jms:inbound-endpoint
                connector-ref="jmsConnectorWMQ"
                address="${change.service.inbound.endpoint}?method=applyListToRecords"
                transformer-refs="Jms2Obj TraceRouteInbound"
                responseTransformer-refs="DiagnosticsXForm TraceRouteOutbound MessagePropertiesTransformer Obj2Jms">
            <jms:transaction action="ALWAYS_BEGIN"/>
        </jms:inbound-endpoint>
    </inbound>

    <component>
        <interceptor-stack ref="InterceptorStack"/>
        <spring-object bean="service"/>
    </component>
</service> 
```

例外：

```
ERROR [asyncDelivery4][2012-10-18 13:52:21,123] - org.oclc.mule.interceptors.FaultHandlingInterceptor Invocation failed:
org.mule.api.service.ServiceException: Component that caused exception is: SedaService{ChangeServiceAnyXml}. Message payload is of type: JMSTextMessage
    at org.mule.component.DefaultLifecycleAdapter.invoke(DefaultLifecycleAdapter.java:216)
    at org.mule.component.AbstractJavaComponent.invokeComponentInstance(AbstractJavaComponent.java:83)
    at org.mule.component.AbstractJavaComponent.doInvoke(AbstractJavaComponent.java:74)
    at org.mule.component.AbstractComponent.invokeInternal(AbstractComponent.java:133)
    at org.mule.component.AbstractComponent.intercept(AbstractComponent.java:93)
    at org.mule.component.ComponentInterceptorInvoker.invoke(ComponentInterceptorInvoker.java:52)
    at org.mule.interceptor.InterceptorStack$Invoc.invoke(InterceptorStack.java:70)
    at org.mule.api.interceptor.Invocation$invoke.call(Unknown Source)
    at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:42)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:108)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:112)
    at org.oclc.mule.interceptors.FaultHandlingInterceptor.intercept(FaultHandlingInterceptor.groovy:39)
    at org.mule.interceptor.InterceptorStack$Invoc.invoke(InterceptorStack.java:65)
    at org.mule.api.interceptor.Invocation$invoke.call(Unknown Source)
    at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:42)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:108)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:112)
    at org.oclc.mule.interceptors.StatsLoggingInterceptor.intercept(StatsLoggingInterceptor.groovy:37)
    at org.mule.interceptor.InterceptorStack$Invoc.invoke(InterceptorStack.java:65)
    at org.mule.interceptor.InterceptorStack.intercept(InterceptorStack.java:46)
    at org.mule.component.ComponentInterceptorInvoker.invoke(ComponentInterceptorInvoker.java:48)
    at org.mule.component.AbstractComponent.invoke(AbstractComponent.java:165)
    at org.mule.service.AbstractService.invokeComponent(AbstractService.java:921)
    at org.mule.model.seda.SedaService.doSend(SedaService.java:256)
    at org.mule.service.AbstractService.sendEvent(AbstractService.java:499)
    at org.mule.DefaultMuleSession.sendEvent(DefaultMuleSession.java:359)
    at org.mule.routing.inbound.DefaultInboundRouterCollection.send(DefaultInboundRouterCollection.java:228)
    at org.mule.routing.inbound.DefaultInboundRouterCollection.route(DefaultInboundRouterCollection.java:188)
    at org.mule.transport.AbstractMessageReceiver$DefaultInternalMessageListener.onMessage(AbstractMessageReceiver.java:382)
    at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:258)
    at org.mule.transport.AbstractMessageReceiver.routeMessage(AbstractMessageReceiver.java:203)
    at org.mule.transport.AbstractReceiverWorker$1.doInTransaction(AbstractReceiverWorker.java:147)
    at org.mule.transaction.TransactionTemplate.execute(TransactionTemplate.java:117)
    at org.mule.transport.AbstractReceiverWorker.doRun(AbstractReceiverWorker.java:165)
    at org.mule.transport.AbstractReceiverWorker.run(AbstractReceiverWorker.java:67)
    at org.mule.work.WorkerContext.run(WorkerContext.java:310)
    at org.mule.work.SyncWorkExecutor.doExecute(SyncWorkExecutor.java:41)
    at org.mule.work.MuleWorkManager.executeWork(MuleWorkManager.java:287)
    at org.mule.work.MuleWorkManager.doWork(MuleWorkManager.java:180)
    at org.mule.transport.jms.MultiConsumerJmsMessageReceiver$SubReceiver.onMessage(MultiConsumerJmsMessageReceiver.java:316)
    at com.ibm.mq.jms.MQMessageConsumer.receiveAsync(MQMessageConsumer.java:2969)
    at com.ibm.mq.jms.SessionAsyncHelper.run(SessionAsyncHelper.java:406)
    at java.lang.Thread.run(Thread.java:619) 
```

# mysql - 在 mysql 数据库中存储跟踪应用程序的 GPS 数据的最佳实践

> ID：13197381
> 
> 赞同：6
> 
> 时间：2012-11-02T14:37:21.307
> 
> 标签：mysql, database, mapping, datamodel

我有一个 GPS 跟踪应用程序的数据模型问题。当有人使用我们的应用程序时，它会每 5 秒保存一次纬度、经度、当前速度、时间戳和燃烧卡路里。锻炼完成后，锻炼的平均速度、总时间/距离和消耗的卡路里将存储在数据库中。到目前为止，一切都很好..

我们还想要存储每 5 秒保存一次的数据，以便我们稍后可以利用它来绘制锻炼的图形/图表。

我们应该如何将这么多的数据存储在数据库中？如果有人跑了一个小时，一次锻炼可以包含 720 行。可能是单行中的序列化/gz 压缩数据数组。我知道这是不好的做法..

关系型一对/多对多模型将被撤消？我知道 MySQL 可以轻松处理大量数据，但我们谈论的是 720 * 每周两次锻炼 * 7000 名用户 = 每周超过 1000 万行。（当然，我们只能存储每 10 秒的数据以将行数减半，或者每 20 秒等……但随着时间的推移，它仍然会是大量数据+图表的准确性会降低）

你会怎么做？提前感谢您的意见！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-02T15:46:21.183

只是一些想法：

1.  量化您的纬度/经度数据。我相信由于技术原因，数据很可能已经被量化了，所以如果你能检测到这种量化，你可能会使用它。这里的想法是将双精度数转换为合理的整数。在最坏的情况下，您可能会量化为提供的精度双精度数，这意味着使用 64 位整数，但我非常怀疑您的数据是否接近该分辨率。也许一个边长大约一米的简单网格对你来说就足够了吗？
2.  计算差异。就绝对值而言，大多数数字都相当大，但也非常接近（除非您的成员跑遍世界的一半……）。所以这将导致相当小的数字。此外，只要人们以恒定的速度向恒定的方向奔跑，您就会经常看到相同的差异。步骤 1 中的空间网格越粗糙，您在此处获得完全相同的差异的可能性就越大。
3.  计算这些差异的[霍夫曼码](http://en.wikipedia.org/wiki/Huffman_coding)。您可以尝试分别编码 lat 和 long 运动，或者在其叶子处计算具有 2d 位移矢量的单个代码。尝试两者并比较结果。
4.  将结果存储在 BLOB 中，连同用于解码 Huffman 代码的字典以及初始位置，以便您可以将数据返回到绝对坐标。

结果应该是每个数据集的一小部分数据，您可以将其作为一个整体进行检索和解压缩。从数据库中检索单个部分是不可能的，但听起来你不需要那个。

霍夫曼编码优于 gzip 的好处是您不必人为地引入中间字节流。使用它们各自的属性直接编码您遇到的实际差异应该会更好。

# wpf - WPF 中类似 Silverlight 的过渡效果？

> ID：13197382
> 
> 赞同：0
> 
> 时间：2012-11-02T14:37:22.077
> 
> 标签：wpf, silverlight, microsoft-metro, transitions

我见过像 MahApps (http://mahapps.com/MahApps.Metro/) 这样的软件包，它允许 WPF 程序具有 Metro 的外观和感觉。

我还看到了一些非常漂亮的 Silverlight 程序，这些程序是考虑到 Metro 主题而创建的。例如，当您单击一个按钮时，一个面板将在大约四分之一秒的时间跨度内滑出/过渡（我不是指简单的淡入，我是指面板在屏幕上物理移动直到它全尺寸）。我的理解是，这是通过情节提要实现的。

我的问题是是否可以在 WPF 应用程序中执行这些转换/视觉效果？还是严格属于 Silverlight 领域的东西？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T22:16:49.163

没有什么可以阻止您在 WPF 中进行这些转换。

# jsf - 如何使用依赖对象关系更新多个组件（selectOneMenu）？

> ID：13197385
> 
> 赞同：7
> 
> 时间：2012-11-02T14:37:42.237
> 
> 标签：jsf, jsf-2, primefaces, selectonemenu

我有以下（不言自明的）实体关系：

```
* Manufacturer
* Car    (Manufacturer.getCars())
* Tire   (Car.getTires()) 
```

**豆豆**

```
private List<Manufacturer> allManufacturers

private Manufacturer selectedManufacturer
private Car selectedCar
private Tire selectedTire 
```

**xhtml**

```
<p:selectOneMenu id="manufacturerSel" value="#{myBean.selectedManufacturer}" converter="#{manufacturerConverter}">
    <f:selectItem itemLabel="None" itemValue="#{null}" />
    <f:selectItems value="#{myBean.allManufacturers}" />
    <p:ajax update="carSel tireSel" />
</p:selectOneMenu>

<p:selectOneMenu id="carSel" value="#{myBean.selectedCar}" converter="#{carsConverter}" disabled="#{empty myBean.selectedManufacturer.cars}">
    <f:selectItem itemLabel="None" itemValue="#{null}" />
    <f:selectItems value="#{myBean.selectedManufacturer.cars}"  />
    <p:ajax update="tireSel" />
</p:selectOneMenu>

<p:selectOneMenu id="tireSel" value="#{myBean.selectedTire}" converter="#{tiresConverter}" disabled="#{empty myBean.selectedCar.tires}">
    <f:selectItem itemLabel="None" itemValue="#{null}" />                            
    <f:selectItems value="#{myBean.selectedCars.tires}"  />
</p:selectOneMenu> 
```

*   最后两个`p:selectOneMenu`应根据第一个中的选择进行更新
*   最后一个`p:selectOneMenu`ID`tireSel`未正确更新
*   所有要更新的组件都在同一个内部`NamingContainer`
*   得到`carSel`更新，但加载的值`tireSel`很奇怪（似乎对最后一个请求有效）
*   `update="@form"`我也试过`manufacturerSel`

**编辑** 显示使用了哪个 EL 版本：这是我的 pom.xml 的摘录

```
<dependency>
    <groupId>javax.faces</groupId>
    <artifactId>javax.faces-api</artifactId>
    <version>2.1</version>
</dependency>
<dependency>
    <groupId>org.glassfish</groupId>
    <artifactId>javax.faces</artifactId>
    <version>2.1.12</version>
</dependency>    
<dependency>
    <groupId>javax.el</groupId>
    <artifactId>el-api</artifactId>
    <version>2.2</version>
    <scope>provided</scope>
</dependency> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-02T14:44:04.033

您基本上需要清除该`selectedCar`值。你可以用`<p:ajax listener>`这个。

```
<p:ajax listener="#{myBean.clearSelectedCar}" update="carSel tireSel" /> 
```

和

```
public void clearSelectedCar() {
    selectedCar = null; // You might want to clear selectedTire as well.
} 
```

否则，旧的选定值仍将保留在 bean 中，并且轮胎列表仍将依赖于此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-05-30T10:08:35.537

通常，PrimeFaces 命令按钮更新适用于整个表单。但有时我们不想更新整个表单，也许我们想更新一个 id 的 div 或同一个类的多个 div。它适用于 Primefaces 和 Spring Boot。

如果您想更新整个表单，只需更改更新属性 -

```
update="@form" 
```

如果要更新 ID 中的 div

```
update="@(#divId)" 
```

如果要使用类名更新多个 div 或单个 div-

```
update="@(.className)" 
```

如果要使用类名更新多个 div 或单个 div-

```
update="@(.className1, .className2)" 
```

# string - PHP 严格标准符合变量

> ID：13197388
> 
> 赞同：-4
> 
> 时间：2012-11-02T14:37:49.083
> 
> 标签：string, php

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-02T14:40:12.280

# c# - 解决子类中的属性或绑定问题

> ID：13197394
> 
> 赞同：0
> 
> 时间：2012-11-02T14:38:09.643
> 
> 标签：c#, windows-phone-7, binding

我有一个问题，我不确定它是什么。我在一个类中有一个类，它的值需要绑定到控件，在这种情况下是可见性。代码正确更改了值，但输出没有更改（即折叠控件）

```
 <Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0">
        <StackPanel Orientation="Vertical">
            <Button x:Name="buttonOne" Content="Show Hide" Width="Auto" Click="buttonOne_Click"/>

        <ListBox x:Name="aListBox">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                            <TextBlock x:Name="blockOne" Grid.Column="0" Text="Raw "/>
                            <TextBlock x:Name="blockTwo" Grid.Column="1" Text="{Binding aValue}" Visibility="{Binding Path=visControl.VisibleState, BindsDirectlyToSource=True}"/>
                    </Grid>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
        </StackPanel>

    </Grid> 
```

公共部分类 MainPage : PhoneApplicationPage {

```
 private List<myClass> listOfClasses = new List<myClass>();
    // Constructor
    public MainPage()
    {

        myClass classA = new myClass("one");
        myClass classB = new myClass("two");
        myClass classC = new myClass("three");
        listOfClasses.Add(classA);
        listOfClasses.Add(classB);
        listOfClasses.Add(classC);

        InitializeComponent();
        aListBox.ItemsSource = listOfClasses;
    }

    private void buttonOne_Click(object sender, RoutedEventArgs e)
    {
        foreach (myClass cl in listOfClasses)
            if (cl.SwitchVisible)
                cl.SwitchVisible = false;
            else
                cl.SwitchVisible = true;
    }
}

public class myClass
{
    private string _aValue;
    private bool _switchVisible;

    public bool SwitchVisible { get { return _switchVisible; } set { _switchVisible = value; visControl.changeVisibility(_switchVisible); } }
    public string aValue { get { return _aValue; } }
    public controlProperties visControl;

    public myClass(string invalue)
    {
        visControl = new controlProperties();
        visControl.VisibleState = Visibility.Visible;
        _aValue = invalue;
    }

}

public class controlProperties
{
    private Visibility _visibility;

    public Visibility VisibleState { get { return _visibility; } set { _visibility = value; } }

    public void changeVisibility(bool isVisible)
    {
        if (isVisible)
            _visibility = Visibility.Visible;
        else
            _visibility = Visibility.Collapsed;
    }
} 
```

如果这是一个路径问题或绑定问题，有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T15:00:52.223

如果您希望控件在更改属性值时自动更新，您的类必须实现[INotifyPropertyChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged%28v=vs.95%29.aspx)接口。

例如：

```
public class controlProperties : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;

    private Visibility _visibility;

    public Visibility VisibleState
    {
        get
        {
            return _visibility;
        }

        set
        {
            _visibility = value;
            this.NotifyPropertyChanged("VisibleState");
        }
    }

    public void changeVisibility(bool isVisible)
    {
        if (isVisible)
            this.VisibleState = Visibility.Visible;
        else
            this.VisibleState = Visibility.Collapsed;
    }

    private void NotifyPropertyChanged(string propertyName)
    {
        var eventHandler = this.PropertyChanged;

        if (eventHandler != null)
        {
            eventHandler(sender, new PropertyChangedEventArgs(propertyName));
        }
    }
} 
```

# php - Sphinx - 在配置中使用多个 sql_attr_uint

> ID：13197397
> 
> 赞同：0
> 
> 时间：2012-11-02T14:38:13.113
> 
> 标签：php, api, full-text-search, sphinx

我需要在我的配置文件中为每个索引使用两个 sql_attr_uint 值。我从之前的帖子中发现不要对通过命令行的搜索命令过于相信。 [Sphinx PHP API 顺序与搜索守护进程不同](https://stackoverflow.com/questions/13162698/sphinx-php-api-order-differs-from-search-daemon)

我当前的问题是当被 PHP API 访问时，我无法检索两个 sql_attr_uint 值（但是通过命令行使用搜索时会出现两个 sql_attr_uint 值）

下面是我的配置文件.. [http://pastebin.com/30Si7bw5](http://pastebin.com/30Si7bw5)

通过 PHP API 获取结果时，我只能看到 sql_attr_uint table_id，但看不到名为 pub_id 的 sql_attr_uint。

谁能建议它为什么会这样做？

```
$cl = new SphinxClient();
$cl->SetServer($CONF['sphinx_host'], $CONF['sphinx_port']);
$cl->SetMatchMode($mode);
$cl->SetLimits(0, 1000);
// below line commented out atm - to only show those rows with this sql_attr_uint of 760 (is this the correct syntax?)
//$cl->SetFilter ( 'pub_id', array(760), FALSE );
$result = $cl->Query($q); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T15:07:40.457

我猜你没有重新启动 searchd 。您仍然使用旧索引。

重新索引时，请确保使用 --rotate 以使 searchd 重新加载。

失败了。完全停止 searchd，重新索引索引并启动干净启动。

（你的语法是正确的，还有其他事情发生）

# mysql - MySQL + Substring 怎么做？+ 替换？

> ID：13197400
> 
> 赞同：2
> 
> 时间：2012-11-02T14:38:40.443
> 
> 标签：mysql

*   我不太擅长 SQL，希望能够变得更好。

*   我在尝试执行某种表格操作时遇到了一些麻烦。

*   我希望能够从下面的 ProgUID 列中选择子字符串

就像是...

```
SUBSTRING(table.ProgUID,3,12); 
```

这将为我提供 ProgUID P-CAMVE-9701-1 的 CAMVE-9701（从开头删除 P-，从结尾删除 -1），然后将子字符串插入该行 UID。

我认为这应该相当容易，而且我一直在努力解决这个问题，但运气不佳。

如果有更好的方法请告诉我！

提前感谢您的想法/帮助！

![在此处输入图像描述](../Images/eff5d335372ec025958ca3b9998eb671.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-02T14:41:01.167

使用`UPDATE`声明

```
UPDATE tableName
   SET UID = SUBSTRING(ProgUID,3,12) 
```

*   [**请参阅 SQLFiddle 演示**](http://sqlfiddle.com/#!2/f45d2/1)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T14:43:19.333

如果您想要的部分始终是 12 个字符，那么

```
UPDATE table
SET UID = SUBSTRING(ProgUID, 3, 12) 
```

除此以外

```
UPDATE table
SET UID = SUBSTRING(ProgUID, 3, LENGTH(ProgUID)-2) 
```

# html - 动力学 js 画布

> ID：13197401
> 
> 赞同：1
> 
> 时间：2012-11-02T14:38:49.537
> 
> 标签：html, canvas, kineticjs, stage

我正在玩 Kinetic js 框架。我正在开发一个绘画应用程序，在舞台上放置形状时遇到了麻烦。原来是因为我将 html5 画布设置为形状不会显示的舞台的容器......

这就提出了一个问题，如果我不再使用画布作为我的容器，我会失去画布的所有功能吗？有没有办法可以在画布上放置一个动态舞台？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-02T16:38:45.780

我刚刚在对您的其他问题的评论中回答了这个问题，但我也会在这里回答。KineticJS 需要一个 div 作为舞台容器，然后在该 div 中创建画布元素，所以不要担心“不使用它们”。

如果您在应用程序中使用某种 HTML 元素检查器，您会看到 div 包含画布元素，即使您没有手动添加任何元素；对于您添加到舞台的每一层，Kinetic 都会添加一个画布元素并将它们堆叠在一起。

# silverlight - 在 windowsphone 中获取磁贴详细信息

> ID：13197403
> 
> 赞同：0
> 
> 时间：2012-11-02T14:38:53.907
> 
> 标签：silverlight, windows-phone-7

如何以编程方式获取 windowsphone 开始菜单中所有磁贴的磁贴详细信息（包括磁贴名称、磁贴图像、导航 uri 等）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T22:01:24.173

您唯一能做的就是使用[ShellTile.ActiveTiles](http://msdn.microsoft.com/en-us/library/microsoft.phone.shell.shelltile.activetiles%28v=vs.92%29.aspx)方法枚举您的应用程序的动态磁贴。对于每个图块实例，您将只能获得 Uri，无法获得任何其他信息。

# c# - 想要将 HTML 值分配给 String 变量

> ID：13197404
> 
> 赞同：0
> 
> 时间：2012-11-02T14:38:55.483
> 
> 标签：c#, html

我想将 HTML 片段分配给字符串变量。就像是 -

```
 string div = "<table><tr><td>Hello</td></tr></table>"; // It should return only 'Hello' 
```

请建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T14:42:13.250

如果您确定 HTML 不会在您想要获取的字符串之间发生变化，您可以简单地在两个常量字符串之间执行一个**Substring**，您将把您的字符串放入您的变量中。

```
 const string prefix = "<table>";
        const string suffix = "</table>";
        string s = prefix + "TEST" + suffix ;
        string s2 = s.Substring(prefix.Length, s.IndexOf(suffix, StringComparison.Ordinal) - prefix.Length); 
```

这是正则**表达式**版本：

```
 const string prefix = "<table>";
        const string suffix = "</table>";
        string s = prefix + "TEST" + suffix;
        string s2 = Regex.Match(s, prefix + "(.*)" + suffix).Groups[1].Value; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T14:54:57.970

```
 string div = "<table><tr><td>Hello</td></tr></table>"; // It should return only 'Hello

        var doc = new XmlDocument();
        doc.LoadXml(div);
        string text = doc.InnerText; 
```

你还需要这个的 Jquery 版本吗？

# sas - SAS MP（多处理）连接

> ID：13197406
> 
> 赞同：3
> 
> 时间：2012-11-02T14:39:00.287
> 
> 标签：sas

我正在使用 SAS MP Connect 开发我的第一段代码，以从同一个 sas 作业运行并行线程。

我了解 MP CONNECT 在物理上仅受可用 CPU 数量的限制，但理想情况下，我不想将它们全部用于我的工作！

SAS 是否可以选择限制执行的 MP CONNECT 进程的数量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T15:49:41.167

我不知道`MP CONNECT`与可用 CPU 数量相关的任何限制。 `MP CONNECT`只是一种创建多个同时执行的 SAS 会话的技术，所有这些都在“父”会话的控制下。更大的问题是 I/O 和内存，因为每个会话都是它自己的进程。您甚至可以`MP CONNECT`在单个 CPU 机器上运行进程（在这种情况下，您当然不会获得真正的并行性能）。

此外，对于您的具体问题，没有选项可以控制`MP CONNECT`您可以调用多少个会话。

这是一篇[相当不错的 SAS 论文](http://support.sas.com/rnd/scalability/papers/mpconnect0401.pdf)；虽然有点老了，但原则仍然有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T15:02:53.870

我不是 MP Connect 方面的专家，但即使在 BASE SAS 中，您也可以使用 OPTION CPUCOUNT，从而可以设置 SAS 可用的 CPU 数量。

[http://support.sas.com/documentation/cdl/en/lrdict/64316/HTML/default/viewer.htm#a002197020.htm](http://support.sas.com/documentation/cdl/en/lrdict/64316/HTML/default/viewer.htm#a002197020.htm)

# c++ - OpenGL通用图像阅读器和GLFW（glfwReadImage，glfwLoadTexture2D）支持各种图像格式

> ID：13197412
> 
> 赞同：2
> 
> 时间：2012-11-02T14:39:16.870
> 
> 标签：c++, c, image, opengl, glfw

在学习 OpenGL 时，我正在寻找可以评估各种图像类型的图像阅读器，例如`".png", ".bmp", ".tga", ".dds", ...`. 我的计划是提取图像文件的参数，如`height`, `width`，`type`并使用以下函数进行设置：

```
glTexImage2D(GL_TEXTURE_2D, 0, <color format>, <width>, <height>,
    0, <color orientation>, <data type>, <actual data>); 
```

我浏览了[CImg 库](http://cimg.sourceforge.net/)和[stb_image.c](http://nothings.org/stb_image.c)。但是，我不知道如何获取 ,`widhth`等`height`参数`type`。

这似乎是`<GL/glfw.h>`一个很好的框架。我的印象是它只是`".tga"`使用以下函数加载格式：

```
int glfwLoadTexture2D(const char *name, int flags); 
```

它支持所有格式吗？

另外，我在它附近看到了以下功能。如果有人可以简要介绍一下，那将是一个奖励。

```
int  glfwReadImage(const char *name, GLFWimage *img, int flags);
void glfwFreeImage(GLFWimage *img); 
```

在哪里：

```
typedef struct {
  int Width, Height;
  int Format;
  int BytesPerPixel;
  unsigned char *Data;
} GLFWimage; 
```

如果 GLFW 不支持所有格式，那么是否有任何库可以获取上述`GLFWimage`参数，并允许我们`glTexImage2D`单独设置它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T14:56:53.340

你应该看看[DevIL——](http://openil.sourceforge.net/)它可能正是你想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T17:45:08.210

[DevIL](http://openil.sourceforge.net/)对多种图像格式提供了相当不错的支持，但不再处于积极开发中；作者太忙了。

[GLI](http://www.g-truc.net/project-0024.html#menu)也是一个不错的选择；它只是 DDS，但这并不像人们想象的那么大。加载 JPG/PNG/等。便于原型开发（并且易于最终用户自定义），但 DDS 文件通常是更好的长期选择，因为它们原生支持游戏和交互式应用程序中常用的多种功能（BCn[压缩纹理格式](http://msdn.microsoft.com/en-us/library/windows/desktop/hh308955%28v=vs.85%29.aspx)、立方体环境地图、体积纹理等）。

# web-services - 从 UNIX 调用 Web 服务

> ID：13197416
> 
> 赞同：0
> 
> 时间：2012-11-02T14:39:20.567
> 
> 标签：web-services, unix, salesforce

我需要通过 UNIX 框的 Web 服务启动 salesforce.com 中的工作流。任何人都可以建议我实现这种情况的选项或指导方针吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T14:50:52.953

我认为您不能仅仅“启动工作流程”。您必须在 Salesforce 中执行满足工作流输入标准的记录插入或更新。

有一个名为[Data Loader](http://wiki.developerforce.com/page/Data_Loader)的 Java 工具，用于您的基本数据操作活动（您可以从自己的生产组织下载它），它可以为计划运行编写脚本，具有配置文件，您可以在其中以安全的方式存储用户密码等。查看[pdf 指南](https://na1.salesforce.com/help/doc/en/salesforce_data_loader.pdf)以获取更多信息（“命令行快速入门”一章）

所以我不认为你真的需要一个网络服务调用......

* * *

除非我误解了，并且您正在谈论调用具有“webservice”关键字的 Apex 类的方法并且它会以某种方式执行更新？

在这种情况下，您需要下载为该类生成的 WSDL 文件（Setup->Develop->Classes），然后使用您选择的语言（Java、PHP、Python...[这个链接](http://www.salesforce.com/docs/developer/cookbook/Content/api_setup_intro.htm)将有所帮助，步骤并没有太大的不同），那么你的命令行魔法呢？

[http://wiki.developerforce.com/page/Integration](http://wiki.developerforce.com/page/Integration)为您提供了大量资源 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T03:57:00.750

Salesforce 将 SOAP 用于其 Web 服务。他们现在没有宁静的网络服务。只需要求他们提供 wsdl 文件即可。使用此 wsdl 文件生成 java 代码。之后获取他们的 webService url，以便您可以继续提取数据此链接可能会对您有所帮助..

[http://salesforce-walker.blogspot.in/2011/12/to-access-salesforce-data-from-java-we.html](http://salesforce-walker.blogspot.in/2011/12/to-access-salesforce-data-from-java-we.html)

希望这可以帮助

# c - 字符串的长度作为字符串

> ID：13197422
> 
> 赞同：0
> 
> 时间：2012-11-02T14:39:47.150
> 
> 标签：c, string, string-length

> **可能重复：**
> [如何在 C 中将整数转换为字符串？](https://stackoverflow.com/questions/9655202/how-to-convert-integer-to-string-in-c)

我想计算字符串的长度并将值作为字符串传递给函数。

```
char* s="abcd";
int i = strlen(s);
char* lengthAsString = ????(i); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-02T14:41:38.447

```
char* s = "abcd";
int i = strlen(s);
char lengthAsString[50];
sprintf(lengthAsString, "%d", i);

// now you can use lengthAsString to pass it to a function 
```

# javascript - ajax 和哈希 url

> ID：13197423
> 
> 赞同：0
> 
> 时间：2012-11-02T14:39:47.233
> 
> 标签：javascript, ajax, hash, hyperlink

我有一个旨在使用 ajax 重新加载数据的网页。我所有的 ajax 都运行良好，但我现在意识到我想跟踪您在页面上的位置，并且还能够将人们链接到网站上的特定页面。

这是我正在谈论的网站：

www.stevenlebel.com

如您所见，该页面由将新内容加载到屏幕的电视组成。视频页面使用嵌入的 Vimeo 代码，音乐页面使用 Soundcloud，图像使用 Imugr 库。我以这种方式构建它的原因是允许我的朋友在没有我帮助的情况下更新他的页面。

所以我的问题是，如何将哈希链接添加到 URL - 我还希望能够链接到页面上的某个视频、歌曲或图像，但不确定这是否可以使用 Vimeo/Soundcloud/Imgur。

有人对这个有经验么？

非常感谢，

凯蒂

一个额外的问题：有谁知道如何删除.html，所以当我使用哈希链接时，页面会说 x/x/#whatever 而不是 x/x.html#whatever？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T14:49:31.240

如果我正确理解您的问题，您需要 HTML5 History API。你可以使用一些很酷的跨浏览器 API，看看这里[http://html5demos.com/history](http://html5demos.com/history)它是如何工作的。

您将需要这些东西来跟踪您的位置。我认为您没有刷新页面并使用 Ajax。

history.pushState 事件，使用它推送任何数据，并将在 # 之后附加到 url

history.popstate 事件，使用后退/前进来弹出数据。

window.hashchange 事件，如果您复制 url 并将其打开到另一个或共享到任何地方。您将能够在 # in url 之后获取数据。

您可以尝试这些跨浏览器 API。

[https://github.com/browserstate/History.js/](https://github.com/browserstate/History.js/)

[https://github.com/devote/HTML5-History-API](https://github.com/devote/HTML5-History-API)

祝你好运！

# algorithm - 多个 IF 和一个 ELSE

> ID：13197425
> 
> 赞同：3
> 
> 时间：2012-11-02T14:39:50.707
> 
> 标签：algorithm, syntax, if-statement

我想考虑一种语法改进。

我怎样才能写得更好：

```
IF condition1 
    IF condition2
        { do something }
    ELSE 
        { message1 }
ELSE 
    { message1 } 
```

有两个 IF 语句不能在一个语句中连接，但在两个 ELSE 部分中的代码必须相同（在此示例中为 message1）。

这个怎么写更好？我不想两次编写相同的代码（在 ELSE 部分中）。

提前TnX！

内马尼亚

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-02T14:41:53.443

显而易见的解决方案是将这两个条件结合起来：

```
IF condition1 AND condition2
    { do something }
ELSE 
    { message1 } 
```

但是，如果由于某种原因这两个条件确实无法组合，并且您使用的是具有`break`关键字或等效项的类 C 语言，那么您可以执行以下操作：

```
DO
   IF condition1
      IF condition2
          { do something }
          BREAK
   { message1 }
WHILE FALSE 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-02T14:41:45.410

关于什么

```
IF condition1 AND condition2
    { do something }
ELSE 
    { message1 } 
```

如果你不能加入这两个语句，你可以使用某种 GOTO （ps：这是不好的做法）

```
IF condition1 
    IF condition2
        { do something }
    ELSE 
        GOTO ELSE_CODE
ELSE 
    :ELSE_CODE
    { message1 } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-02T14:53:23.373

如果您正在谈论一种没有短路布尔评估的语言，您可以手动实现它

```
flag = condition1 
IF flag
    flag = flag AND condition2
IF flag
    { do something }
ELSE 
    { message1 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-23T00:08:54.180

我搜索了这个答案，我意识到你只需要重新排序语句。

而不是 2 个 IF 语句和一个像这样的其他语句

```
{
     if(FirstCheck === true){
         //run function 1
     }
     if(SecondCheck === true){
         //run function 2
      }
}else{
    //run this else only when the first 2 IFs are false
    // run function 3        
     }
} 
```

你想做一个 IF 是因为你想在 else 中运行函数，然后为那个 IF 放置一个 else，然后运行你原来的 IF

```
if(orginalElse !== true){
    //run function 3
    //this is the orginal else you would want to run, just with a negative if statement
}else{
    if(FirstCheck === true){
        //run function 1
    }
    if(SecondCheck === true){
        //run function 2
    }
} 
```

# c# - 在屏幕上逐个渲染 wpf 控件，并有一些延迟

> ID：13197428
> 
> 赞同：0
> 
> 时间：2012-11-02T14:40:08.337
> 
> 标签：c#, wpf

我正在我的 wpf 应用程序中尝试一个小动画。
有一个包含 5 个矩形形状的 WPF 表单，`Border`我想然后加载几乎没有延迟。

这是代码片段：

```
<StackPanel>
<Border name="Border1"/>
<Border name="Border2"/>
<Border name="Border3"/>
<Border name="Border4"/>
<Border name="Border5"/>
</stackpanel> 
```

我只想在屏幕上一点一点地渲染它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T16:06:28.653

我会使用故事板。看看[这篇文章](http://www.codeproject.com/Articles/364529/Animation-using-Storyboards-in-WPF)以获得一些很好的例子。

# ios - 从 sharekit 共享后弹出到根视图控制器

> ID：13197431
> 
> 赞同：0
> 
> 时间：2012-11-02T14:40:14.213
> 
> 标签：ios, twitter, sharekit

我在我的应用程序中使用 sharekit 将文本发布到 twitter。问题是当用户单击模态视图中的发送到 twitter 按钮时，我需要弹出到根视图控制器（主控制器）。如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T14:54:44.357

如果您运行的是 iOS 5 或更高版本，您可以使用 TWTweetComposer 来发送推文，而不是使用 iOS 6 中的 ShareKit 或社交框架。

但是，如果您想使用 sharekit，您的 modalView 需要一个委托。

您需要创建一个协议。在模态视图标题中使用类似

```
@protocol TwitterModalDelegate
-(void)closeModal;
@end 
```

然后实现一个符合该协议的 id 作为属性或 ivar（通常称为委托）

```
@property (nonatomic, assign) id<TwitterModalDelegate> delegate 
```

现在在您的视图控制器中显示模态，告诉它它使用协议。

```
@interface YourViewControllerName : UIViewController <TwitterModalDelegate> 
```

您需要将模态视图标头导入您的 ViewController 标头。

您现在可以控制模式视图关闭时发生的情况。

```
-(void)closeModal
{
   [self dismissViewControllerAnimated:YES completion:^
   {  
      [self.navigationController popToRootViewControllerAnimated:YES ];
   }];

} 
```

因此，当您确认已发送推文时，在您的模态视图中，您可以简单地调用

```
[self.delegate closeModal]; 
```

在创建模态视图的实例时请记住：

```
YourModalView* modalView = [YourModalView alloc]init];
modalView.delegate = self
[self presentViewController:modalView animated:YES completion:nil]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T15:28:43.860

将您的 sharekit 实例委托设置为您当前的控制器并实现 (void)sharerFinishedSending:(SHKSharer *)sharer; 这是处理完成请求的sharekit委托方法

# xml - Eclipse xml 验证

> ID：13197443
> 
> 赞同：3
> 
> 时间：2012-11-02T14:41:09.507
> 
> 标签：xml, eclipse, validation, xsd

如何让 Eclipse Indigo 针对我的类路径 jar 中存在的 xsd 验证 xml？目前，它似乎仅针对 xsd 的 Web 发布版本进行验证。例如，我的 xml 中有以下内容：

```
 xmlns:gfe="http://www.springframework.org/schema/gemfire"
    xsi:schemaLocation="http://www.springframework.org/schema/gemfire   http://www.springframework.org/schema/gemfire/spring-gemfire-1.2.xsd" 
```

在 Eclipse 中，验证与位于[http://www.springframework.org/schema/gemfire/spring-gemfire-1.2.xsd](http://www.springframework.org/schema/gemfire/spring-gemfire-1.2.xsd)的文档相反。但是，当我在 Eclipse 外部运行应用程序时，验证会针对包含在我的类路径上的库 jar 文件中的 xsd。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T14:44:07.197

使用Eclipse 支持[的 XML Catalog 特性。](http://wiki.eclipse.org/Using_the_XML_Catalog)

[http://www.eclipse.org/webtools/community/tutorials/XMLCatalog/XMLCatalogTutorial.html](http://www.eclipse.org/webtools/community/tutorials/XMLCatalog/XMLCatalogTutorial.html)

# google-maps - 谷歌地图融合表中不同颜色的多边形

> ID：13197447
> 
> 赞同：2
> 
> 时间：2012-11-02T14:41:22.847
> 
> 标签：google-maps, polygon, google-fusion-tables

我正在将从融合表中获得的多边形放到谷歌地图上。有没有办法根据另一个融合表中的数据使每个多边形都有自己独特的颜色，例如遍历我的 fusionTableLayer 中的每个多边形？如果是这样，它是如何完成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T15:06:02.770

[您可以使用 Google Maps API v3 FusionTablesLayer](https://developers.google.com/maps/documentation/javascript/reference?hl=pl#FusionTablesLayer)动态设置融合表的样式。您可以为地图上的[一个 FusionTablesLayer](https://developers.google.com/maps/documentation/javascript/fusiontableslayer#fusion_table_styles)创建最多5 种样式。

# tomcat - 为什么在 Tomcat 上以另一个用户身份启动 Jenkins 时所有配置都丢失了？

> ID：13197450
> 
> 赞同：1
> 
> 时间：2012-11-02T14:41:39.373
> 
> 标签：tomcat, jenkins, redhat

我让 Jenkins 在 Red Hat 机器上的 Tomcat 上运行。我已经用我自己的 Linux 用户名启动了服务器。如果我以 root 用户身份启动同一台服务器，那么 Jenkins 仪表板和所有内容都将为空。为什么会这样？我想以任何用户身份启动 Tomcat 服务器并找到所有相同的 Jenkins 配置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T16:44:52.963

这可能是 Jenkins 期望在哪里找到其配置文件的问题。如果您定义了环境变量 JENKINS_HOME，它将在 $JENKINS_HOME 中查找，否则它将使用运行 Tomcat 服务器的用户主目录中的子目录 .jenkins。

在您的情况下，我猜 Jenkins 配置文件位于您首次启动 Jenkins 的用户主目录下的 .jenkins 中。

有关更多详细信息，请参阅[Jenkins 管理文档](https://wiki.jenkins-ci.org/display/JENKINS/Administering+Jenkins)。

# asp.net - 32 位池和 64 位池之间的内存使用情况

> ID：13197455
> 
> 赞同：21
> 
> 时间：2012-11-02T14:41:51.720
> 
> 标签：asp.net, .net, nhibernate, memory-management, iis-7.5

我们有一个 ASP.NET 应用程序，围绕 MonoRail 和 NHibernate 构建，我注意到在 64 位模式或 32 位模式下运行它时会出现奇怪的行为。一切都编译为 AnyCPU，并且在两种模式下都可以正常运行，但内存使用情况差异很大。

查看 ANTS 的以下快照：

32bit_snapshot：![在此处输入图像描述](../Images/ff71d52fd3c4cf5e84ba42b2c32a51da.png)

对比

64位快照：![在此处输入图像描述](../Images/d385b530a711338ccbe760b6ce8073f3.png)

两个快照的使用场景非常相似（我在两次运行中都点击了相同的页面）。

首先，为什么在 64 位模式下未使用的内存这么高？为什么非托管内存是 64 位模式下的 4 倍？

对此的任何见解都会非常有帮助。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-06T00:38:01.593

64 位进程的初始内存分配远高于等效的 32 位进程。

从理论上讲，这可以减少垃圾收集的运行频率，从而提高性能。它还有助于碎片化，因为一次分配更大的内存块。

这篇文章： http: [//blogs.msdn.com/b/maoni/archive/2007/05/15/64-bit-vs-32-bit.aspx](http://blogs.msdn.com/b/maoni/archive/2007/05/15/64-bit-vs-32-bit.aspx)给出了更详细的解释。

您看到较高的非托管内存使用率可能是由于在 32 位模式下运行的 .NET 对象使用最少 12 字节（8 字节 + 4 字节引用），而 64 位中的相同对象将占用 24 字节（12字节 + 8 字节参考）。

另一篇更完整地解释这一点的文章：[http ://www.simple-talk.com/dotnet/.net-framework/object-overhead-the-hidden-.net-memory--allocation-cost/](http://www.simple-talk.com/dotnet/.net-framework/object-overhead-the-hidden-.net-memory--allocation-cost/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T16:49:22.417

64 位系统内存问题的标准答案是，大多数内存操作默认对齐到 16 字节。对 128 位 XXM 寄存器的内存读取预计与 16 字节边界对齐。堆栈中的两个参数占用与三个相同的内存量（返回地址占用缺少的 8 个字节）。Gnu malloc 将分配的区域对齐到 16 字节边界。

如果分配单元的大小很小，那么开销就会很大：首先是对齐数据的开销，然后是对齐与数据关联的簿记的开销。

我还预测，在 64 位系统中，数据结构已经发展：平衡的、splay 或任何树可能有意义，而不是二进制或 2-3-4但可以使用保证存在的 SSE 扩展来快速处理。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-05T09:45:27.117

我不能确切地告诉你发生了什么，但可能会做一个很好的猜测。32 位进程的内存限制与 64 位进程不同。CLR 会经常在 32 位进程中运行 GC。您可以通过图表上的尖峰看到这一点。但是，当您运行 64 位进程时，在内存不足之前不会调用 GC。这将取决于您系统的总内存使用情况。

在数字上，您的 32 位进程只能分配大约 1gig，而您的 64 位进程可以分配所有内存。在 32 位进程中，GC 将更快开始清理，因为您的程序在使用过多内存时会降低性能。当您的总系统内存降至某个垃圾保留以下时，64 位进程上的 CLR 将开始清理。

# java - Mac X 10.8.2 上的 gephi 0.8.1 问题无法加载 libjogl_awt.jnilib

> ID：13197457
> 
> 赞同：8
> 
> 时间：2012-11-02T14:41:53.700
> 
> 标签：java, gephi

我是 JAVA 的新手。我在 Mac OS X 10.8.2 上。使用gephi 0.8.1。我得到：

```
echo $JAVA_HOME
/Library/Java/JavaVirtualMachines/1.6.0_33-b03-424.jdk/Contents/Home
echo $JDK_HOME
/Library/Java/JavaVirtualMachines/1.6.0_33-b03-424.jdk/Contents/Home 
```

gephi 库列表：

```
/Applications/gephi.app/Contents/Resources/gephi/gephi/modules/lib/macosx-universal/libjogl.jnilib
/Applications/gephi.app/Contents/Resources/gephi/gephi/modules/lib/macosx-universal/libjogl_awt.jnilib
/Applications/gephi.app/Contents/Resources/gephi/gephi/modules/lib/macosx-universal/libjogl_cg.jnilib 
```

通过单击图标启动 gephi 不起作用，我需要使用命令行：

```
./gephi --jdkhome /Library/Java/JavaVirtualMachines/1.6.0_33-b03-424.jdk/Contents/Home 
```

在此之后，我得到“无法加载 libjogl_awt.jnilib”

关于我可以做些什么来修复我的 JAVA 环境的任何建议——或者至少启动 gephi？谢谢。

更新：正如 gephi 论坛中所建议的，我还将 /System/Library/Frameworks/JavaVM.framework/Versions/CurrentJDK 链接到 /Library/Java/JavaVirtualMachines/1.6.0_33-b03-424.jdk/Contents 并拥有 32 - 在 Java 首选项中优先位 Java...

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-11-09T15:16:37.477

要在 OS X Mavericks 上运行 Gephi，只需安装 Apple 的 Java 6 更新[http://support.apple.com/kb/DL1572?viewlocale=en_US](http://support.apple.com/kb/DL1572?viewlocale=en_US)

如果你仍然有问题，那可能意味着你已经安装了 Java 7，并且 Gephi 正在使用它。您可以通过编辑 Gephi 的配置文件来覆盖该行为：

打开 /Applications/Gephi.app/Contents/Resources/gephi/etc/gephi.conf 并将`jdkhome`值设置为：

`jdkhome="/System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T21:41:12.753

我为 OSX 2012-006 重新安装了 Java，现在 gephi 可以工作了——不知道为什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T08:59:14.490

您可以尝试删除 /Your_username/Library/Application support/gephi 下的 gephi 设置文件夹，然后再次运行。

# vb.net - 将控件属性绑定到用户控件属性

> ID：13197462
> 
> 赞同：1
> 
> 时间：2012-11-02T14:42:16.697
> 
> 标签：vb.net, binding

我有一个用户控件，它具有一些公共属性（如 Dirty :boolean）和一个更改该属性的事件（ControlValueChanged）。
我将该控件添加到表单中。在表单中，我有一个按钮 (btnOK)，我想将按钮的 Enabled 属性绑定到 Dirty 属性。
我阅读了[http://msdn.microsoft.com/en-us/library/ms229614.aspx](http://msdn.microsoft.com/en-us/library/ms229614.aspx)但我在将其实施到我的项目时遇到了一些问题。
我的代码形式为：

```
btnOK.DataBindings.Add("Enabled", Me.wwdp, "Dirty") 'wwdp is my user Control 
```

因此，根据我的研究，我必须添加我的自定义控件：

```
Imports System.ComponentModel

Public Class wwDynamicPanel

Implements INotifyPropertyChanged

Public Event PropertyChanged As PropertyChangedEventHandler _
    Implements INotifyPropertyChanged.PropertyChanged

 Public Property Dirty As Boolean
    Get
        Return mbDirty
    End Get
    Set(ByVal value As Boolean)
        mbDirty = value
        NotifyPropertyChanged()
    End Set

End Property

Private Sub NotifyPropertyChanged(<CallerMemberName()> Optional ByVal propertyName As String = Nothing)
    RaiseEvent PropertyChanged(Me, New PropertyChangedEventArgs(propertyName))
End Sub 
```

我收到一个错误：未定义类型“CallerMemberName”。
问题是我在 msdn 中没有找到更多内容。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-02T14:56:15.490

我很抱歉。MSDN 中的链接适用于框架 4.5
，我找到了正确的[http://msdn.microsoft.com/en-us/library/ms184414(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/ms184414(v=vs.100).aspx)。对于我的框架，我解决了这个问题。
我留下这个问题是因为其他人觉得它很有用。
所以工作代码是：

```
Imports System.ComponentModel

Public Class wwDynamicPanel

Implements INotifyPropertyChanged

Public Event PropertyChanged As PropertyChangedEventHandler _
   Implements INotifyPropertyChanged.PropertyChanged

Public Property Dirty As Boolean
   Get
      Return mbDirty
   End Get
   Set(ByVal value As Boolean)
      mbDirty = value
      NotifyPropertyChanged("Dirty")
   End Set
End Property

Private Sub NotifyPropertyChanged(ByVal info As String)
     RaiseEvent PropertyChanged(Me, New PropertyChangedEventArgs(info))
End Sub 
```

# javascript - 使用 jquery 动画的 div 移动

> ID：13197463
> 
> 赞同：0
> 
> 时间：2012-11-02T14:42:20.010
> 
> 标签：javascript, jquery, animation

我只想`div`在用户选择时移动 a 。当用户单击链接时，会`div`出现从右到左移动的链接。然后在里面有另一个链接`div`，当用户点击它时，`div`应该从左到右移动并消失。

以下是我尝试过的 jQuery 代码：

```
$('#show').click(function(e){
    e.preventDefault();
    $('div').show().animate({ 'left': 0 }, 300;
});   

$('#hide').click(function(e){
    e.preventDefault();
    $('div').animate({'left': 2050}, 300,function() {$('div').hide()});
}); 
```

还附上了小提琴，[http://jsfiddle.net/sameerast/JNBAn/](http://jsfiddle.net/sameerast/JNBAn/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T15:06:54.023

我建议你注意css动画。请参阅此示例：[http ://slides.html5rocks.com/#css-transitions](http://slides.html5rocks.com/#css-transitions)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T14:54:00.317

如上所述，这只需要第 4 行的逗号，然后小提琴开始工作：

```
$('#show').click(function(e){
    e.preventDefault();
    $('div').show().animate({ 'left': 0 }, 300);
});   

$('#hide').click(function(e){
    e.preventDefault();
    $('div').animate({'left': 2050}, 300,function() {$('div').hide()});
}); 
```

作为旁注，我发现 Chrome 中的 JavaScript 控制台在这方面非常有帮助...通过 View -> Developer -> JavaScript Console 进行检查（在这种情况下，由于缺少括号，它显示了意外的 ; 错误）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-02T15:05:32.920

在缺少的括号旁边。 [这是一个更新的代码](http://jsfiddle.net/JNBAn/7/)，使 div 从右到左显示，然后从左到右隐藏。

JS：（缺少括号）

```
$('#show').click(function(e){
    e.preventDefault();
    $('div').show().animate({'left': 0 }, 300);
});   

$('#hide').click(function(e){
    e.preventDefault();
    $('div').animate({'left': 2050}, 300,function() {$('div').hide()});
});  ​ 
```

CSS：

```
div{
    width:100px; 
    height:100px;
    background:#333;
    color:#999;
    position:absolute;
    top:10px;
    left:2050px;
    text-align:center;
    display:none;
}​ 
```

希望这可以帮助！

# windows-8 - Windows 8 中的实时时间

> ID：13197465
> 
> 赞同：8
> 
> 时间：2012-11-02T14:42:21.203
> 
> 标签：windows-8, microsoft-metro

Windows Store 中有一个名为“The Time”的应用程序，它在其 Tile 上显示当前时间（每分钟）。该应用程序无需注册任何后台任务即可执行此操作。

它怎么能做到这一点？

**更新：**它似乎安排了很多很多的瓷砖！因为如果你把电脑时间拉回来，它就会停止工作。但是，我不知道它调度了多少个磁贴以及可以调度多少个磁贴？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-07T00:53:10.013

来自作者本人：

1.  可能会安排实时磁贴更新
2.  应用程序可以通过后台任务基础设施获得时间片

因此，简单地说，当操作系统执行 The Time 的后台任务时，它们会排队进行许多实时磁贴更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T08:38:58.567

据我所知，这在 Windows 8 中是不可能的——更新磁贴的后台任务可以每 15 分钟运行一次，但不会更频繁。
[在后台保持生产力——后台任务](http://blogs.msdn.com/b/windowsappdev/archive/2012/05/24/being-productive-in-the-background-background-tasks.aspx)

# c# - NHibernate 中的工作单元和每个请求的会话

> ID：13197467
> 
> 赞同：1
> 
> 时间：2012-11-02T14:42:25.950
> 
> 标签：c#, nhibernate, unit-of-work, session-per-request

我想我的架构中可能有我的工作单元设置错误。这是我目前拥有的（缩进以显示顺序）：

```
HttpRequest.Begin()
  UnitOfWork.Begin()
    Session.BeginTransaction(System.Data.IsolationLevel.ReadCommitted); 
```

在这里，我使用 NHibernate 调用各种服务来执行 crud。当我想对数据库进行更改（更新/保存）时，我调用此代码：

```
 using (var transaction = unitOfWork.Session.BeginTransaction())
        {
            try
            {
                // These are just generics
                ret = (Key)unitOfWork.Session.Save(entity);
                transaction.Commit();
                rb.unitOfWork.Session.Clear();
            }
            catch
            {
                transaction.Rollback();
                rb.unitOfWork.Session.Clear();
                rb.unitOfWork.DiscardSession();
                throw;
            }
        } 
```

当 HttpRequest 结束时，我执行以下步骤：

```
 UnitOfWork.Commit()
    Transaction.Commit() // This is my sessions transaction from the begin above 
```

我遇到了能够回滚大批量进程的问题。因为我在我的 CRUD 层中提交我的事务，如上所示，我的事务不再处于活动状态，当我尝试在我的 UnitOfWork 中回滚时，它什么也不做，因为事务已经被提交。我在我的 CRUD 层中提交我的代码的原因是我可以尽可能快地保存我的数据，而不会锁定数据库太久。

在上述情况下采取的最佳行动方案是什么？我是否只是进行不提交批处理作业的特殊 CRUD 操作，只是在我的工作结束时处理提交，还是我的逻辑与我的 UnitOfWork 和每个请求的会话有缺陷？有什么建议么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-03T05:24:57.343

您已经发现了每个请求会话模式如此流行的原因以及可能源于对您的工作单元进行微观管理的问题。

通常对于每个 Web 请求，需要在该请求中完成的所有事情都可以被认为是一个工作单元，因此有理由认为在该单个 Web 请求期间您应该只打开一个工作单元和一个 NHibernate 会话。

另外，我认为您可能会对 NHibernate 的工作原理感到有些困惑，因为您的问题中有这句话：“我在 CRUD 层中提交代码的原因是，我可以在不锁定数据库的情况下尽快保存我的数据时间过长。”

NHibernate 不会在您的数据库中造成任何锁定。每次调用 ISession.Save(entity) 时，只要不调用 ISession.Flush() 或 ITransaction.Commit()，就不会将任何内容写入数据库，而是将其添加到要插入的项目队列中或在 Web 请求结束时提交当前事务时在数据库中更新。

因此，您的每个请求的会话应该设置如下：

```
void Application_BeginRequest()
{
    // Start your unit of work, open a session and begin a transaction
}

// Do all of your work ( Read, insert, update, delete )

void Application_EndRequest()
{
    try
    {
        // UnitOfWork.Current.Transaction.Commit();
    }
    catch( Exception e )
    {
        // UnitOfWork.Current.Transaction.Rollback();
    }
} 
```

当然有很多方法可以做同样的事情，但这是每个请求会话模式的基础——整个 Web 请求只有一个会话。

# sql - SQL 查询和 VBA 错误

> ID：13197468
> 
> 赞同：1
> 
> 时间：2012-11-02T14:42:37.120
> 
> 标签：sql, vba, ado

> **可能重复：**
> [SQL 查询和 VBA 错误](https://stackoverflow.com/questions/13197011/sql-query-vba-error)

我不断收到此错误：

BOF 或 EOF 设置为真，或当前记录已被删除。请求的操作需要当前记录。

```
 MyQuery = "Select Destinataire, SUM(" & Entete & ") AS NombreTotal FROM [Feuil1$] " _
         & "WHERE [DateMad] Between #" _
         & Format(date_deb, "yyyy/mm/dd") _
         & "# And #" & Format(date_fin, "yyyy/mm/dd") & "#" & Query3 & " Group By Destinataire"

         objRecordSet.Open MyQuery, objConnection, adOpenStatic, adLockOptimistic

         Feuil3.Cells(1, Col) = Entete
         Feuil3.Cells(strLine, 2) = Entete2
         Feuil3.Cells(2, Col).Value = objRecordSet.Fields("NombreTotal").Value 
```

我在最后一行得到错误

```
 Feuil3.Cells(2, Col).Value = objRecordSet.Fields("NombreTotal").Value 
```

为什么它问我 BOF 或 EOF，因为我问的是 SUM？还有如何让这个查询工作？我无法呼吸这个调试

debug.print MyQuery 给出以下内容：

```
 Select Destinataire, SUM(NbCompteurElecNR) AS NombreTotal FROM [Feuil1$] WHERE [DateMad] Between #2012/11/21# And #2012/11/26# And [Destinataire] = 'REL12' Group By Destinataire 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T15:30:21.380

无法评论您的数据，但您收到 EOF 错误，因为您的查询 (MyQuery) 不会产生任何数据行。使用查询打开记录集后，您必须首先检查它是否包含任何行，然后再继续（即它尚未位于文件“EOF”的末尾）。例如，请参见下文。

```
MyQuery = "....."

Set objRecordSet = New ADODB.Recordset
objRecordSet.Open MyQuery, objConnection, adOpenStatic, adLockOptimistic

If Not objRecordSet.EOF Then
    'The record set contain one or more rows, do stuff
Else
    'The record set does not contain any rows, take action and notify user
End If

objRecordSet.Close
Set objRecordSet = Nothing 
```

如果您处于更新/插入操作的中间，您应该在遇到数据库错误或其他失败的情况下对数据库进行适当的回滚，否则您可能会使数据库处于不愉快的状态。例如，请参见下文。

```
On Error Goto Rollback

objConnection.BeginTrans

MyInsertQuery = "..."

Set objRecordSet = New ADODB.Recordset
objRecordSet.Open MyInsertQuery , objConnection, adOpenStatic, adLockOptimistic

objRecordSet(1) = someValue
objRecordSet(2) = someOtherValue
objRecordSet.Update

objRecordSet.Close
Set objRecordSet = Nothing

objConnection.CommitTrans

Exit Sub

Rollback:
    objConnection.RollbackTrans
    objRecordSet.Close
    Set objRecordSet = Nothing 
```

# python - 如何让 Matplotlib 图形在 Tkinter GUI 中正确滚动+调整大小

> ID：13197469
> 
> 赞同：5
> 
> 时间：2012-11-02T14:42:41.263
> 
> 标签：python, matplotlib, tkinter

我有一个 Tkinter GUI，它显示了一个 Matplotlib 图（Python 2.7.3 和 Matplotlib 1.2.0rc2）并允许用户配置图的某些方面。绘图往往会变大，因此该图形被包裹在滚动画布中。配置绘图的一个方面是更改其大小。

现在，一方面情节可以正确滚动，另一方面调整大小也可以正常工作，但这两个操作不能结合使用。下面是一个演示效果的脚本。（对不起，我不能让它更短。）您可以滚动绘图（使用滚动条），它可以变得越来越小（使用按钮）。但是，*无论何时*滚动，图形都会*重置为其原始大小*。显然，我希望图形的大小不会因使用滚动条而改变。

```
import math
from Tkinter import Tk, Button, Frame, Canvas, Scrollbar
import Tkconstants
from matplotlib import pyplot as plt
from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg

def addScrollingFigure(figure, frame):

    # set up a canvas with scrollbars
    canvas = Canvas(frame)
    canvas.grid(row=0, column=0, sticky=Tkconstants.NSEW)

    xScrollbar = Scrollbar(frame, orient=Tkconstants.HORIZONTAL)
    yScrollbar = Scrollbar(frame)

    xScrollbar.grid(row=1, column=0, sticky=Tkconstants.EW)
    yScrollbar.grid(row=0, column=1, sticky=Tkconstants.NS)

    canvas.config(xscrollcommand=xScrollbar.set)
    xScrollbar.config(command=canvas.xview)
    canvas.config(yscrollcommand=yScrollbar.set)
    yScrollbar.config(command=canvas.yview)

    # plug in the figure
    figAgg = FigureCanvasTkAgg(figure, canvas)
    mplCanvas = figAgg.get_tk_widget()
    mplCanvas.grid(sticky=Tkconstants.NSEW)

    # and connect figure with scrolling region
    canvas.create_window(0, 0, window=mplCanvas)
    canvas.config(scrollregion=canvas.bbox(Tkconstants.ALL))

def changeSize(figure, factor):
    oldSize = figure.get_size_inches()
    print "old size is", oldSize
    figure.set_size_inches([factor * s for s in oldSize])
    print "new size is", figure.get_size_inches()
    print
    figure.canvas.draw()

if __name__ == "__main__":

    root = Tk()
    root.rowconfigure(0, weight=1)
    root.columnconfigure(0, weight=1)

    frame = Frame(root)
    frame.grid(column=0, row=0, sticky=Tkconstants.NSEW)
    frame.rowconfigure(0, weight=1)
    frame.columnconfigure(0, weight=1)

    figure = plt.figure(dpi=150, figsize=(4, 4))
    plt.plot(xrange(10), [math.sin(x) for x in xrange(10)])

    addScrollingFigure(figure, frame)

    buttonFrame = Frame(root)
    buttonFrame.grid(row=0, column=1, sticky=Tkconstants.NS)
    biggerButton = Button(buttonFrame, text="larger",
                          command=lambda : changeSize(figure, 1.5))
    biggerButton.grid(column=0, row=0)
    smallerButton = Button(buttonFrame, text="smaller",
                           command=lambda : changeSize(figure, .5))
    smallerButton.grid(column=0, row=1)

    root.mainloop() 
```

我想我错过了一些关于情节和滚动画布是如何联系在一起的东西；我尝试在每次通话后重新配置滚动画布（使用`canvas.create_window(...)`and ） ，但这没有帮助。我开始工作的另一种方法是在每次调整大小后重新生成整个设置（图形、画布、滚动条）。（然而，除了看起来有点残酷之外，还有一个问题是我无法正确处理旧数据，使得程序随着时间的推移积累了相当多的内存。）`canvas.config(...)``changeSize`

那么，是否有人对调整大小操作后如何让这些滚动条正常运行有任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-19T22:34:39.343

正确的; 在[这个答案](https://stackoverflow.com/a/16634108/277826)中的滚动条讨论之后，我最终经历了这个：

*   [如何在 Matplotlib 中设置图形标题和轴标签字体大小？](https://stackoverflow.com/questions/12444716/how-do-i-set-figure-title-and-axes-labels-font-size-in-matplotlib)
*   [如何更改 matplotlib 图上的字体大小](https://stackoverflow.com/questions/3899980/how-to-change-the-font-size-on-a-matplotlib-plot)
*   [Python 子图为公共轴标签留出空间](https://stackoverflow.com/questions/14099435/python-subplots-leaving-space-for-common-axis-labels)
*   [matplotlib 中带有标题、轴标签的确切图形大小](https://stackoverflow.com/questions/8775622/exact-figure-size-in-matplotlib-with-title-axis-labels)
*   [Matplotlib subplots_adjust hspace 使标题和 xlabels 不重叠？](https://stackoverflow.com/questions/2418125/matplotlib-subplots-adjust-hspace-so-titles-and-xlabels-dont-overlap)

..而且我想我设法得到了一种缩放代码，它也缩放（有点）标签和填充，所以（大约）整个情节适合里面（注意，第二张图片使用来自 imgur 的“中等”比例）：

![最小的](../Images/72d18ef62b50e633c6feba10774cf777.png) ![中等的](../Images/bdf92b6f03dccfe93be30617c3923dd0.png) ![大的](../Images/5476c37ead2fa5b46a364dbd2323c07c.png)

对于非常小的尺寸，标签再次开始消失 - 但它仍然适用于一系列尺寸。

请注意，对于较新的`matplotlib`（> = 1.1.1），有一个函数`figure.tight_layout()`可以为这种情况（它是一个子图）执行边距（但不是字体大小） - 但如果您使用的是较旧的`matplotlib`，您可以做`figure.subplots_adjust(left=0.2, bottom=0.15, top=0.86)`这就是这个例子所做的；并且已经过测试：

```
$ python2.7 -c 'import matplotlib; print(matplotlib.__version__)'
0.99.3
$ python3.2 -c 'import matplotlib; print(matplotlib.__version__)'
1.2.0 
```

（*我确实尝试过看看是否可以复制`tight_layout`旧的 matplotlib - 不幸的是，它需要一组相当复杂的函数，这些函数包含在[tight_layout.py](https://github.com/matplotlib/matplotlib/blob/master/lib/matplotlib/tight_layout.py)中，这反过来又要求 Figure 和 Axes 也有特定的规范，在 v.0.99 中不存在*）

由于`subplots_adjust`采用相对参数（从 0.0 到 1.0），原则上我们可以只设置一次 - 并希望它们在我们想要的比例范围内保持不变。对于其余的（字体和标签板的缩放），请参见下面的代码：

```
import math
import sys
if sys.version_info[0] < 3:
  from Tkinter import Tk, Button, Frame, Canvas, Scrollbar
  import Tkconstants
else:
  from tkinter import Tk, Button, Frame, Canvas, Scrollbar
  import tkinter.constants as Tkconstants

import matplotlib
from matplotlib import pyplot as plt
from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg
import pprint, inspect

frame = None
canvas = None
ax = None

def printBboxes(label=""):
  global canvas, mplCanvas, interior, interior_id, cwid, figure
  print("  "+label,
    "canvas.bbox:", canvas.bbox(Tkconstants.ALL),
    "mplCanvas.bbox:", mplCanvas.bbox(Tkconstants.ALL),
    "subplotpars:", figure.subplotpars.__dict__ )

def addScrollingFigure(figure, frame):
  global canvas, mplCanvas, interior, interior_id, cwid
  # set up a canvas with scrollbars
  canvas = Canvas(frame)
  canvas.grid(row=1, column=1, sticky=Tkconstants.NSEW)

  xScrollbar = Scrollbar(frame, orient=Tkconstants.HORIZONTAL)
  yScrollbar = Scrollbar(frame)

  xScrollbar.grid(row=2, column=1, sticky=Tkconstants.EW)
  yScrollbar.grid(row=1, column=2, sticky=Tkconstants.NS)

  canvas.config(xscrollcommand=xScrollbar.set)
  xScrollbar.config(command=canvas.xview)
  canvas.config(yscrollcommand=yScrollbar.set)
  yScrollbar.config(command=canvas.yview)

  # plug in the figure
  figAgg = FigureCanvasTkAgg(figure, canvas)
  mplCanvas = figAgg.get_tk_widget()

  # and connect figure with scrolling region
  cwid = canvas.create_window(0, 0, window=mplCanvas, anchor=Tkconstants.NW)
  printBboxes("Init")
  changeSize(figure, 1)

def changeSize(figure, factor):
  global canvas, mplCanvas, interior, interior_id, frame, cwid
  oldSize = figure.get_size_inches()
  print("old size is", oldSize)
  figure.set_size_inches([factor * s for s in oldSize])
  wi,hi = [i*figure.dpi for i in figure.get_size_inches()]
  print("new size is", figure.get_size_inches())
  print("new size pixels: ", wi,hi)
  mplCanvas.config(width=wi, height=hi) ; printBboxes("A")
  canvas.itemconfigure(cwid, width=wi, height=hi) ; printBboxes("B")
  canvas.config(scrollregion=canvas.bbox(Tkconstants.ALL),width=200,height=200)
  tz.set_fontsize(tz.get_fontsize()*factor)
  for item in ([ax.title, ax.xaxis.label, ax.yaxis.label] +
               ax.get_xticklabels() + ax.get_yticklabels()):
    item.set_fontsize(item.get_fontsize()*factor)
  ax.xaxis.labelpad = ax.xaxis.labelpad*factor
  ax.yaxis.labelpad = ax.yaxis.labelpad*factor
  #figure.tight_layout() # matplotlib > 1.1.1
  figure.subplots_adjust(left=0.2, bottom=0.15, top=0.86)
  figure.canvas.draw() ; printBboxes("C")
  print()

if __name__ == "__main__":
  global root, figure
  root = Tk()
  root.rowconfigure(1, weight=1)
  root.columnconfigure(1, weight=1)

  frame = Frame(root)
  frame.grid(column=1, row=1, sticky=Tkconstants.NSEW)
  frame.rowconfigure(1, weight=1)
  frame.columnconfigure(1, weight=1)

  figure = plt.figure(dpi=150, figsize=(4, 4))
  ax = figure.add_subplot(111)
  ax.plot(range(10), [math.sin(x) for x in range(10)])
  #tz = figure.text(0.5,0.975,'The master title',horizontalalignment='center', verticalalignment='top')
  tz = figure.suptitle('The master title')

  ax.set_title('Tk embedding')
  ax.set_xlabel('X axis label')
  ax.set_ylabel('Y label')
  print(tz.get_fontsize()) # 12.0
  print(ax.title.get_fontsize(), ax.xaxis.label.get_fontsize(), ax.yaxis.label.get_fontsize()) # 14.4 12.0 12.0

  addScrollingFigure(figure, frame)

  buttonFrame = Frame(root)
  buttonFrame.grid(row=1, column=2, sticky=Tkconstants.NS)
  biggerButton = Button(buttonFrame, text="larger",
                        command=lambda : changeSize(figure, 1.2))
  biggerButton.grid(column=1, row=1)
  smallerButton = Button(buttonFrame, text="smaller",
                         command=lambda : changeSize(figure, 0.833))
  smallerButton.grid(column=1, row=2)
  qButton = Button(buttonFrame, text="quit",
                         command=lambda :  sys.exit(0))
  qButton.grid(column=1, row=3)

  root.mainloop() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-19T11:20:55.930

我刚刚遇到了同样的问题-据我所知（通过实验），在做之前，您还必须为它设置画布创建的窗口`figure.set_size_inches()`的新大小（这也迫使一个人使用全局变量 - 或类定义）。此外，显然不需要“网格” - 因为它已经是 的子级，它已经是“网格”了。并且可能想要锚定 NW，因此在每次调整大小时，绘图都会在左上角的 0,0 处重新绘制。`mplCanvas``figure.canvas.draw()``mplCanvas``canvas`

这对我有用（我也尝试使用“内部”框架，如[Python Tkinter 滚动条中的 frame](https://stackoverflow.com/questions/16188420/python-tkinter-scrollbar-for-frame)，但这没有用；其中一些留在片段的末尾）：

```
import math
import sys
if sys.version_info[0] < 3:
  from Tkinter import Tk, Button, Frame, Canvas, Scrollbar
  import Tkconstants
else:
  from tkinter import Tk, Button, Frame, Canvas, Scrollbar
  import tkinter.constants as Tkconstants

from matplotlib import pyplot as plt
from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg
import pprint

frame = None
canvas = None

def printBboxes(label=""):
  global canvas, mplCanvas, interior, interior_id, cwid
  print("  "+label,
    "canvas.bbox:", canvas.bbox(Tkconstants.ALL),
    "mplCanvas.bbox:", mplCanvas.bbox(Tkconstants.ALL))

def addScrollingFigure(figure, frame):
  global canvas, mplCanvas, interior, interior_id, cwid
  # set up a canvas with scrollbars
  canvas = Canvas(frame)
  canvas.grid(row=1, column=1, sticky=Tkconstants.NSEW)

  xScrollbar = Scrollbar(frame, orient=Tkconstants.HORIZONTAL)
  yScrollbar = Scrollbar(frame)

  xScrollbar.grid(row=2, column=1, sticky=Tkconstants.EW)
  yScrollbar.grid(row=1, column=2, sticky=Tkconstants.NS)

  canvas.config(xscrollcommand=xScrollbar.set)
  xScrollbar.config(command=canvas.xview)
  canvas.config(yscrollcommand=yScrollbar.set)
  yScrollbar.config(command=canvas.yview)

  # plug in the figure
  figAgg = FigureCanvasTkAgg(figure, canvas)
  mplCanvas = figAgg.get_tk_widget()
  #mplCanvas.grid(sticky=Tkconstants.NSEW)

  # and connect figure with scrolling region
  cwid = canvas.create_window(0, 0, window=mplCanvas, anchor=Tkconstants.NW)
  printBboxes("Init")
  canvas.config(scrollregion=canvas.bbox(Tkconstants.ALL),width=200,height=200)

def changeSize(figure, factor):
  global canvas, mplCanvas, interior, interior_id, frame, cwid
  oldSize = figure.get_size_inches()
  print("old size is", oldSize)
  figure.set_size_inches([factor * s for s in oldSize])
  wi,hi = [i*figure.dpi for i in figure.get_size_inches()]
  print("new size is", figure.get_size_inches())
  print("new size pixels: ", wi,hi)
  mplCanvas.config(width=wi, height=hi) ; printBboxes("A")
  #mplCanvas.grid(sticky=Tkconstants.NSEW)
  canvas.itemconfigure(cwid, width=wi, height=hi) ; printBboxes("B")
  canvas.config(scrollregion=canvas.bbox(Tkconstants.ALL),width=200,height=200)
  figure.canvas.draw() ; printBboxes("C")
  print()

if __name__ == "__main__":
  root = Tk()
  root.rowconfigure(1, weight=1)
  root.columnconfigure(1, weight=1)

  frame = Frame(root)
  frame.grid(column=1, row=1, sticky=Tkconstants.NSEW)
  frame.rowconfigure(1, weight=1)
  frame.columnconfigure(1, weight=1)

  figure = plt.figure(dpi=150, figsize=(4, 4))
  plt.plot(range(10), [math.sin(x) for x in range(10)])

  addScrollingFigure(figure, frame)

  buttonFrame = Frame(root)
  buttonFrame.grid(row=1, column=2, sticky=Tkconstants.NS)
  biggerButton = Button(buttonFrame, text="larger",
                        command=lambda : changeSize(figure, 1.5))
  biggerButton.grid(column=1, row=1)
  smallerButton = Button(buttonFrame, text="smaller",
                         command=lambda : changeSize(figure, .5))
  smallerButton.grid(column=1, row=2)

  root.mainloop()

"""
  interior = Frame(canvas) #Frame(mplCanvas) #cannot
  interior_id = canvas.create_window(0, 0, window=interior)#, anchor=Tkconstants.NW)
  canvas.config(scrollregion=canvas.bbox("all"),width=200,height=200)
  canvas.itemconfigure(interior_id, width=canvas.winfo_width())

  interior_id = canvas.create_window(0, 0, window=interior)#, anchor=Tkconstants.NW)
  canvas.config(scrollregion=canvas.bbox("all"),width=200,height=200)
  canvas.itemconfigure(interior_id, width=canvas.winfo_width())
""" 
```

一个有趣的注意事项是，`mplCanvas`如果它变大（如单击“更大”），它将遵守大小 - 但如果它变小，则保持旧大小：

```
$ python2.7 test.py 
('  Init', 'canvas.bbox:', (0, 0, 610, 610), 'mplCanvas.bbox:', (0, 0, 600, 600))
## here click "larger":
('old size is', array([ 4.06666667,  4.06666667]))
('new size is', array([ 6.1,  6.1]))
('new size pixels: ', 915.0, 915.0)
('  A', 'canvas.bbox:', (0, 0, 925, 925), 'mplCanvas.bbox:', (0, 0, 926, 926))
('  B', 'canvas.bbox:', (0, 0, 915, 915), 'mplCanvas.bbox:', (0, 0, 926, 926))
('  C', 'canvas.bbox:', (0, 0, 915, 915), 'mplCanvas.bbox:', (0, 0, 926, 926))
()
## here click "larger":
('old size is', array([ 6.1,  6.1]))
('new size is', array([ 9.15,  9.15]))
('new size pixels: ', 1372.4999999999998, 1372.4999999999998)
('  A', 'canvas.bbox:', (0, 0, 915, 915), 'mplCanvas.bbox:', (0, 0, 926, 926))
('  B', 'canvas.bbox:', (0, 0, 1372, 1372), 'mplCanvas.bbox:', (0, 0, 926, 926))
('  C', 'canvas.bbox:', (0, 0, 1372, 1372), 'mplCanvas.bbox:', (0, 0, 1372, 1372))
()
## here click "smaller":
('old size is', array([ 9.14666667,  9.14666667]))
('new size is', array([ 4.57333333,  4.57333333]))
('new size pixels: ', 686.0, 686.0)
('  A', 'canvas.bbox:', (0, 0, 1372, 1372), 'mplCanvas.bbox:', (0, 0, 1372, 1372))
('  B', 'canvas.bbox:', (0, 0, 686, 686), 'mplCanvas.bbox:', (0, 0, 1372, 1372))
('  C', 'canvas.bbox:', (0, 0, 686, 686), 'mplCanvas.bbox:', (0, 0, 1372, 1372))
() 
```

在 Python3.2中也可以看到相同的行为`mplCanvas`......不确定这是否是某种错误，或者我也没有理解正确的东西`:)`

另请注意，以这种方式进行的缩放不能处理轴/抽动等字体的大小调整（字体将尝试保持相同的大小）；这就是我最终可以用上面的代码得到的（截断的抽动）：

![代码截图](../Images/256474ffb5f74ab878753d5b183e097c.png)

...如果添加轴标签等，情况会变得更糟。

无论如何，希望这会有所帮助，
干杯！

# c# - 如何获取已安装的图像编辑器

> ID：13197471
> 
> 赞同：0
> 
> 时间：2012-11-02T14:42:56.567
> 
> 标签：c#, .net

是否有获取用户已安装的所有图像编辑软件的代码？我想知道如何通过注册表列出所有应用程序，有什么方法可以只过滤掉可以编辑图像的应用程序，如画图、Photoshop 等...？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T14:49:52.037

以下是任何通用文件类型的示例：

[如何在 C# 中获取与文件扩展名相关的推荐程序](https://stackoverflow.com/questions/6679385/how-to-get-recommended-programs-associated-with-file-extension-in-c-sharp)

如果您查找 jpg、png 等，您将获得图像编辑器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T14:52:18.143

不。

不期望每个应用程序开发人员以某种方式将其应用程序的元数据标签放置在注册表内（或任何地方）......并且，如果出于某些原因，少数应用程序开发人员没有办法保证一致性。更不用说应用程序开发人员并不总是使用您对他们的应用程序所期望的常用词......并非每个图像编辑应用程序都包含“照片”一词（例如，[`Picasa`](http://picasa.google.com/)来自 Google）。

您可以期望的最好的结果是构建一些要查找的关键字，添加不符合您期望的关键字约定（“Paint”、“Photo”、“Image”等）的著名应用程序列表，并使用它......要么自己创建一个大型数据库进行检查。此外，正如其他答案/评论所表明的那样，寻找用于特定扩展的应用程序是有帮助的。

虽然没有任何保证。

# javascript - 我无法在 Telerik 网格中绑定数据

> ID：13197473
> 
> 赞同：-1
> 
> 时间：2012-11-02T14:43:06.423
> 
> 标签：javascript, telerik, telerik-grid

我写的控制器如下：

```
public class CommodityController : Controller
{
    public ActionResult Vessel()
    {
        return View();
    }
    [GridAction]
    public ActionResult SelectVessel()
    {
        var query = _productServices.GetAllProducts().ToList();
        var model = PreparedBasicProductModel(query);
        return View(new GridModel(model));
    }

} 
```

我写了如下观点：

```
@using Telerik.Web.Mvc.UI;
@using Telerik.Web.Mvc;
@model List<VesselSelection.Models.Vessel.ProductModel>

@(Html.Telerik().Grid<VesselSelection.Models.Vessel.ProductModel>()
    .Name("Grid")
     .DataBinding(dataBinding => dataBinding.Ajax().Select("SelectVessel", "Commodity")
     ) 
    .DataKeys(keys => keys.Add(c => c.Id))
    .Columns(columns =>
    {
        columns.Bound(c => c.Id).Title("Picture");
        columns.Bound(c => c.Name).Title("Data");
        columns.Bound(c => c.ProductPicture).Title("Command");
    })
    .ClientRowTemplate(grid => "<div class='employee-details'>" +
            "<img class='t-widget' src='<#= ProductPicture #>' alt='<#= Name #>' title='<#= Name #>' />" +
            "<dl>" +
                "<dt>Weight:</dt><dd><#= Weight #></dd>" +
                "<dt>Cost Price:</dt><dd><#= CostPrice #></dd>" +
                "<dt>Vendor:</dt><dd><#= VendorName #></dd>" +
        "<div class='commands'>" + grid.EditButton(null) + grid.DeleteButton(null)     +    "</div>" +
        "</div>"
    )

    .Sortable()
    .Editable(editing => editing.Mode(GridEditMode.PopUp))
    .Scrollable(scrolling => scrolling.Height(500))
    .Pageable()
) 
```

我的问题是，当我运行此应用程序时，数据未绑定，因此在网格中显示为空白。请帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T16:51:44.953

您是否尝试过在数据绑定中使用 .OperationMode(GridOperationMode.Client) ？

例子：

```
.DataBinding(dataBinding => dataBinding.Ajax()
    .OperationMode(GridOperationMode.Client)
    .Select("SelectVessel", "Commodity")
 ) 
```

如有疑问，您可以随时查看 [Telerik 的在线文档。](http://www.telerik.com/help/aspnet-mvc/telerik-ui-components-grid-introduction.html)

# machine-learning - 如何更容易地获得超参数？

> ID：13197474
> 
> 赞同：1
> 
> 时间：2012-11-02T14:43:12.490
> 
> 标签：machine-learning, hyperparameters

机器学习中的许多模型都包含超参数。使用保留数据查找这些超参数的最佳做法是什么？或者你的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T06:56:58.717

网格搜索和手动搜索是优化机器学习算法超参数最广泛使用的技术。**然而， James Bergstra**和**Yoshua Bengio**最近发表的一篇论文认为，对于超参数优化，随机搜索优于网格和手动搜索。有关随机（网格和手动）搜索的更多信息，请查看他们的论文：

[**超参数优化的随机搜索**](http://www.google.lk/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CB8QFjAA&url=http://jmlr.csail.mit.edu/papers/volume13/bergstra12a/bergstra12a.pdf&ei=BhCWUP_eE8zJrAeXwIHABA&usg=AFQjCNF1gXNq2P-jExfSFEJO0T4pKuVF0A&sig2=3tea-zmw9NrOtxEO210a8g&cad=rja)

[最近，我为Pattern Recognition Letters](http://www.journals.elsevier.com/pattern-recognition-letters/) Journal提交（并接受了）一篇论文。对于那篇论文，我使用了随机搜索技术。

# php - 如何在 PHP 文件中使用 etags？

> ID：13197479
> 
> 赞同：22
> 
> 时间：2012-11-02T14:43:25.073
> 
> 标签：php, caching, header, etag

您如何在 PHP 文件中实现 etags？我要上传什么到服务器，我要在我的 PHP 文件中插入什么？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-11-02T14:43:25.073

创建/编辑您的 .htaccess 文件并添加以下内容：

```
FileETag MTime Size 
```

将以下内容放在函数中或将其放在需要 etags 处理的 PHP 文件的顶部：

```
<?php 
    $file = 'myfile.php';
    $last_modified_time = filemtime($file); 
    $etag = md5_file($file); 

    header("Last-Modified: ".gmdate("D, d M Y H:i:s", $last_modified_time)." GMT"); 
    header("Etag: $etag"); 

    if (@strtotime($_SERVER['HTTP_IF_MODIFIED_SINCE']) == $last_modified_time || 
        trim($_SERVER['HTTP_IF_NONE_MATCH']) == $etag) { 
        header("HTTP/1.1 304 Not Modified"); 
    exit; 
} 
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-05-15T23:08:30.387

对应[https://datatracker.ietf.org/doc/html/rfc7232#section-2.3](https://datatracker.ietf.org/doc/html/rfc7232#section-2.3)的版本（etag值必须加引号）：

```
<?php
$file = __DIR__ . '/myfile.js';
$etag = '"' . filemtime($file) . '"';

// Use it if the file is changed more often than one time per second:
// $etag = '"' . md5_file($file) . '"';

header('Etag: ' . $etag);

$ifNoneMatch = array_map('trim', explode(',', trim($_SERVER['HTTP_IF_NONE_MATCH'])));
if (in_array($etag, $ifNoneMatch, true) || count($ifNoneMatch) == 1 && in_array('*', $ifNoneMatch, true)) {
    header('HTTP/1.1 304 Not Modified');
    exit;
}

print file_get_contents($file); 
```

# c# - 通过 NDepend 查找仅在特殊类中使用的代码

> ID：13197482
> 
> 赞同：2
> 
> 时间：2012-11-02T14:43:31.313
> 
> 标签：c#, dependency-injection, ndepend, static-code-analysis

我正在尝试使用 NDepend 删除我们代码库中的死代码。由于我们使用的是依赖注入，我想找到仅在从注册表库派生的类中使用的接口（和实现）：

```
public class PresenterRegistry : Registry
{
    public PresenterRegistry()
    {
        For<IExamplePresenter>().Use<ExamplePresenter>();
    }
} 
```

有没有办法做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T16:18:34.780

在尝试了一点之后，我创建了一个按我需要的方式工作的查询：

```
// <Name>Interfaces registered but potentially not used</Name>
warnif count > 0 
from t in JustMyCode.Types
from i in JustMyCode.Types
where t.DeriveFrom("StructureMap.Configuration.DSL.Registry")
   && i.IsInterface
   && t.IsUsing(i)
   && i.NbTypesUsingMe < 3 // one using for implementation, one in registry
select i 
```

没有我预期的那么多代码:-) 这个查询没有涵盖任何可能性，但它是一个好的开始。

尽管如此：帕特里克，感谢您的帮助！

* * *

不客气，Rico :) 顺便说一句，这个代码规则可以用这种方式重写，以在*O(N)*而不是*O(N^2)*中运行（N 是*JustMyCode.Types*的数量）。这种优化是通过神奇的[UsedByAny()](http://www.ndepend.com/API/webframe.html?NDepend.API~NDepend.CodeModel.ExtensionMethodsSequenceUsage~UsedByAny.html)方法实现的。该规则还提供了更详细的结果。

```
warnif count > 0 
let registryDerived = JustMyCode.Types.Where(t => t.DeriveFrom("StructureMap.Configuration.DSL.Registry"))
from i in JustMyCode.Types.UsedByAny(registryDerived)
where i.IsInterface &&
      i.NbTypesUsingMe < 3 // one using for implementation, one in registry
select new { i, 
             registryDerivedUser = i.TypesUsingMe.Intersect(registryDerived),
             i.TypesUsingMe } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T17:02:06.810

我不确定你的要求是什么。

*我想查找仅在派生自注册表库的类中使用的接口（和实现）：*以下查询与派生自的任何类型使用的应用程序接口和类匹配`Microsoft.Win32.Registry`：

```
let registryDerived = Application.Types.Where(t => t.DeriveFrom("Microsoft.Win32.Registry"))
from t in Application.Types.UsedByAny(registryDerived)
select t 
```

..通过下一个查询，您还可以获得与上一个查询匹配的接口的派生类型和实现：

```
let registryDerived = Application.Types.Where(t => t.DeriveFrom("Microsoft.Win32.Registry"))
from t in Application.Types.UsedByAny(registryDerived)
let tDerived = t.DerivedTypes
let tImpl = t.TypesThatImplementMe
select new { t, tDerived, tImpl } 
```

...或将它们全部列出：

```
let registryDerived = Application.Types.Where(t => t.DeriveFrom("Microsoft.Win32.Registry"))

let tUsed = Application.Types.UsedByAny(registryDerived)
let tDerived = tUsed.SelectMany(t => t.DerivedTypes)
let tImpl = tUsed.SelectMany(t => t.TypesThatImplementMe)

from t in tUsed.Union(tDerived).Union(tImpl)
select t 
```

顺便说一句，`Microsoft.Win32.Registry`是密封的，所以它不是你在谈论的类。但是你可以用你自己的类名替换它，前缀为命名空间。

# r - 使用R将动物园对象写入csv文件时如何降低小数精度？

> ID：13197484
> 
> 赞同：0
> 
> 时间：2012-11-02T14:43:40.643
> 
> 标签：r, csv, zoo

当使用 write.zoo() 将 zoo 对象写入 CSV 文件时，我实际上希望将小数精度从默认的 14 降低到仅 3。但是，即使在 options() 中设置了 scipen 和数字，我也没有能够降低输出的精度。

这是一个示例代码来说明这个问题。

```
blah <- zoo(cbind(c(1.590833333333335, NA), c(NA, 21.590833333333337)))
index(blah) <- c("Dec 1985", "Dec 1986")
colnames(blah) <- c("FooHeader", "BarHeader")
options(scipen = 3, digits = 3)
write.zoo(blah, file = "blah.csv", sep = ",") 
```

如果我打开`blah.csv`文件，我会看到

```
"Index","FooHeader","BarHeader"
"Dec 1985",1.59083333333334,NA
"Dec 1986",NA,21.5908333333333 
```

但我真正想看到的是

```
"Index","FooHeader","BarHeader"
"Dec 1985",1.591,NA
"Dec 1986",NA,21.591 
```

我该如何去做呢？提前致谢！

注意：我知道通过降低精度，如果我再次将数据读入 R，我仍然会失去精度。没关系。我可以忍受这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-02T16:04:23.253

试试这个

```
write.zoo(round(blah, 3), sep = ",")
## "Index","FooHeader","BarHeader"
## "Dec 1985",1.591,NA
## "Dec 1986",NA,21.591 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T14:53:46.927

? `write.table`指出：

> 在几乎所有情况下，数字量的转换都由选项“ `scipen`”（参见`options`）控制，但内部等效于`digits=15`. 为了更好地控制，使用`format`来制作一个字符矩阵/数据框，然后调用`write.table`它。

不幸的是，需要进行一些整理才能将其返回到`format`对象：`matrix``zoo`

```
write.zoo(`index<-`(zoo(format(blah,digits=4)),index(blah)))
"Index" "FooHeader" "BarHeader"
"Dec 1985" " 1.591" "    NA"
"Dec 1986" "    NA" "21.591" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-02T15:19:47.340

我会使用`coredata<-`and`round`将数值强制为正确的精度，因为您希望`as.character`在此之后引用它们。

```
 coredata(blah) <- as.character(round(coredata(blah), 3))
 write.zoo(blah, file="testzoo.csv", sep= ",")
#----file------
"Index","FooHeader","BarHeader"
"Dec 1985","1.591",NA
"Dec 1986",NA,"21.591" 
```

# c# - 选择解析器生成器以使用 C# 为自定义语言构建解释器？

> ID：13197487
> 
> 赞同：0
> 
> 时间：2012-11-02T14:43:50.500
> 
> 标签：c#, parsing, compiler-construction, programming-languages, interpreter

这是我第一次真正尝试实现领域特定语言。

我知道语言语法和抽象语法树的基础知识，但是我之前在实现它们时并没有动手。

我想构建一种小语言、简单的变量/数组和条件语句。我想通过我用 C# 构建的解释器来解释和执行用户输入的代码。在精神上与 PHP 非常相似，但更简单。

我搜索，我变得困惑。

我发现具有良好 C# 支持的最佳解析器生成器是 Gold 和 Irony。我也找到了 ANTLR，但我看到太多人抱怨 C# 支持的问题。此外，这三个似乎缺乏良好的文档。

我主要担心的是开始使用其中一个，然后发现它不能用于该任务，要么是因为缺乏良好的 C# 支持，要么是因为缺乏良好的文档或其他原因。我想要一些我可以“自信地”开始工作的东西，让自己在项目中开始。

任何人都可以帮我挑选一些可以很好地完成工作并保证与 C# 一起工作的东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T15:09:09.333

我建议你试试[TinyPG](http://www.codeproject.com/Articles/28294/a-Tiny-Parser-Generator-v1-2)。它编译为 C#，您可以直接在语法中提供 C#。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T14:47:39.560

我建议你使用ANTLR。我使用它编写了自己的编译器（用于 MSIL）。ANTLR 支持 C#，我没有发现任何问题。

您还可以查看[我的源代码](http://code.google.com/p/wlcompiler/)（我不能作为工作示例，但它有 ANTLT .g 文件）作为示例。

# parsing - 解析器实现

> ID：13197491
> 
> 赞同：4
> 
> 时间：2012-11-02T14:44:07.240
> 
> 标签：parsing, prolog

嗨，我正在尝试用这样的语法为一种简单的语言实现解析器。

```
program ::= "program" declarations "begin" statements "end"
declaration ::= "var" ident "as" type
type ::= "string" | "int" 
```

我已经完成了前两个，我将如何编写类型语法？

```
program( prog( DECLS, STATS ) ) -->
[ 'program' ], declarations( DECLS ),
[ 'begin' ], statements( STATS ), [ 'end' ].

declaration( decl( IDENT, TYPE ) ) -->
[ 'var' ], ident( IDENT ), [ 'as' ], type( TYPE ). 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T15:46:52.320

您的语法可能未指定。实际上，您没有定义关键字如何与标识符等其他标记分开。有些编程语言不需要将关键字与标识符分开。还有其他一些编程语言需要一些空格或布局字符。

在你的情况下，“varaasint”是一个有效的声明吗？你的语法表明了这一点。或者你必须写“var a as int”。

您可能想了解[更多信息](https://stackoverflow.com/a/12942551/772868)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T15:48:07.880

```
type(string) --> ['string'].
type(int) --> ['int']. 
```

（其实`'`不需要）

您可以使用`|`or `;`，但这会使您返回找到的类型的方式复杂化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-02T19:25:48.130

你错过了`statements`规则！

无论如何，DCG 规则只是 Prolog 上的普通语法糖，然后您可以使用您喜欢的任何 Prolog 功能。如果您需要保持语法紧凑：

```
type(type(T)) --> [T], {memberchk(T, [int, string])}. 
```

大括号允许将通用 Prolog 与语法规则混合。

正如@false 所指出的，您的语法只有在您有一个分词器时才有用，它会拆分您的输入并*丢弃*空格。或者您可以使用此模式更直接地处理它（注意，未经测试的代码）：

```
program( prog( DECLS, STATS ) ) -->
   s, "program", s, declarations( DECLS ),
   s, "begin", s, statements( STATS ), s, "end", s.

declaration( decl( IDENT, TYPE ) ) -->
   "var", s, ident( IDENT ), s, "as", s, type( TYPE ).

declarations([D|Ds]) --> declaration(D), declarations(Ds).
declarations([]) --> [].

type(type(int)) --> "int".
type(type(string)) --> "string".

% skip 1 or more whitespace
s --> (" " ; "\n"), (s ; []). 
```

# ruby - 在“it”块之外访问 ExampleGroup 范围

> ID：13197492
> 
> 赞同：1
> 
> 时间：2012-11-02T14:44:19.220
> 
> 标签：ruby, rspec

我正在尝试使用 RSpec 的宏来干燥我的规范，但遇到了一个问题。

```
describe "..." do
  let!(:blog) { create(:blog) }

  post "/blogs/#{blog.id}/posts" do
    # some macros
  end
end 
```

我想访问`blog`变量，但我不想在`it { ... }`块内这样做，因此无论资源如何都可以使用我的宏（例如，我想将它应用到`blogs`、`posts`、`comments`等）。

是否可以？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T18:16:33.350

> 我想访问 blog 变量，但我不想在它 { ... } 块内进行

尽量不要将其`let`视为正常范围的变量定义。`let`是[一种复杂的辅助方法，用于在同一示例组内的多个调用中缓存代码块的结果](https://www.relishapp.com/rspec/rspec-core/v/2-6/docs/helper-methods/let-and-let)。您`let`将*只*存在于示例组中的任何内容，这意味着您无法访问外部块的`let`ted“变量” 。`it`

```
require 'spec'

describe "foo" do 
  let(:bar) { 1 }

  bar
end
# => undefined local variable or method `bar' 
```

也就是说，如果您只想`create(:blog)`跨多个示例重用结果，您可以这样做：

```
describe "foo" do
  let(:blog) { create(:blog) }

  it "does something in one context" do  
    post "/blogs/#{blog.id}/posts"

    # specification
  end

  it "does something else in another context" do  
    post "/blogs/#{blog.id}/comments"

    # specification
  end
end 
```

# jquery - 简单的滑块在函数被调用两次之前不起作用

> ID：13197493
> 
> 赞同：0
> 
> 时间：2012-11-02T14:44:23.370
> 
> 标签：jquery, jquery-load, easyslider

我在里面使用了简单的滑块，其中的内容加载了 Jquery.load()，当您单击我的投资组合页面上的缩略图时会调用该滑块。问题是第一次单击缩略图并加载内容时，滑块不起作用，但是如果您使用滑块关闭 div 并重新单击缩略图以重新打开它，它就会开始工作。我感觉它与 Jquery.load() 有关。这是网站[iancramergraphics.com/new](http://iancramergraphics.com/new)

抱歉，这是我第一次在论坛上发帖，所以我仍然习惯于提出我的问题的最佳方式。我之前也没有创建自己的 js fiddle，我不确定如何包含我的 jquery ajax 调用。这是我的 .js 和 html（我希望这足以帮助您理解）

​</p>

```
$(document).ready(function() {
var id = $(this).attr("id");

$('.thumbnails div').click(function() {

    $('.portfolioDisplay').slideDown('fast');
    $("#slider").load('portfolio/' + id + ".html #slider > *");

    $("#slider").easySlider({
        continuous: true,
        nextText: "",
        prevText: ""
    });
}
});​ 
```

我尝试在 (document).ready 中移动 easyslider 声明，但没有运气

谢谢你

html 没有发布在最后一个上。这里是

```
<div class="thumbnails">
<div id="zubrickyremodeling"><img src="images/thumbnails/zubricky.png" alt="Zubricky            Remodeling" /></div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T17:51:56.703

You are binding plugin on dinamically loaded content, you need something like this [http://docs.jquery.com/Plugins/livequery](http://docs.jquery.com/Plugins/livequery) (pretty much lightweight)

then you can do:

```
$("#slider").load(url);

$.livequery(function(){
$("#slider").easySlider({
        continuous: true,
        nextText: "",
        prevText: ""
    });
}); 
```

or better (should work) using ajax without the plugin i linked to:

```
$('.thumbnails div').on('click',function() {
    $.ajax({
    url:'http://www.yoursite.com/portfolio/' + id + ".html #slider > *",
    type:'GET',
    data:{},
    dataType:'data',
    error:function(){},
    beforeSend:function(){},
    success:function(_data){
    $('.portfolioDisplay').slideDown('fast');
    $('#slider').html(_data);
     $("#slider").easySlider({
            continuous: true,
            nextText: "",
            prevText: ""
        });
    }
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T19:37:53.347

我让它工作了。我无法让插件工作或第二组 ajax 代码（我确定任何一个都可以工作，但我无法做到正确），但你的第二个回复告诉我我必须使用 .ajaxComplete 事件. 这就是我想出的：

```
 $('.thumbnails div').click(function(){
        var id = $(this).attr("id");

$("#slider").load('portfolio/' + id + ".html #slider > *");
        $('#slider').ajaxComplete(function(){
        $("#slider").easySlider({
            continuous: true,
            nextText: "",
            prevText: "" 
        }); 
```

这行得通。非常感谢你的帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T19:41:09.187

我无法获得您建议的插件或第二组代码（我确定只是因为我对 ajax 缺乏经验），但您让我意识到我必须在 .load 之后使用 .ajaxComplete。这就是我想出的：

```
 $('.thumbnails div').click(function(){
        var id = $(this).attr("id");

    $("#slider").load('portfolio/' + id + ".html #slider > *");
        $('#slider').ajaxComplete(function(){
        $("#slider").easySlider({
            continuous: true,
            nextText: "",
            prevText: "" 
        });

        });
    }); 
```

# c# - 使用 Google 分析的用户的电子邮件地址

> ID：13197497
> 
> 赞同：-10
> 
> 时间：2012-11-02T14:44:35.233
> 
> 标签：c#, asp.net

如何在谷歌分析中获取访问我网站的用户的电子邮件地址？我的网站在 asp.net

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T14:52:26.647

您最好的办法是向客户询问他们的电子邮件地址作为您网站上某些内容的一部分，然后将 IP 地址连同它一起记录下来。然后，您可以将该 IP 与分析联系起来。

当然没有办法从分析本身中提取它。

# windows-8 - 在哪里可以找到 Windows 运行时的概念文档？

> ID：13197500
> 
> 赞同：2
> 
> 时间：2012-11-02T14:44:55.423
> 
> 标签：windows-8, windows-runtime

我正在尝试充分了解 Windows 运行时，以便就我的雇主将我们现有的应用程序移植到它需要什么提出建议。我无法找到提供 API 工作原理技术概述的文档。

我所有的网络搜索似乎都将我引向了[MSDN 上的 API 参考](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/br211369.aspx)，它简洁到难以阅读的程度。它记录了 API 类和方法的正式签名，但似乎假设读者已经知道事物是如何组合在一起的。每个方法的*目的*通常只是描述为一个简洁的句子片段，用空格而不是 CamelCase 重述其名称，并且几乎完全没有关于类型声明中明显的限制、期望和不变量的进一步解释。（这与普通 Win32 API 参考文档中相当丰富的“备注”部分形成对比）。

显然，我不应该使用本文档来初步了解 API 的工作原理。我*应该*使用什么？

[在 MSDN 中向上](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/br229519.aspx)移动一个级别，有一个名为*Concepts and Architecture*的部分，以及一些听起来更有前途的*编程概念*和*基础知识*——但它们实际描述的是看似随机选择的相当专业的主题，当然不是我需要理解 API 参考。

是否有我需要购买和阅读的书本形式的官方文档？MSDN 之外的东西？我找不到的秘密 MSDN 链接？

我已经看到[了这个](https://stackoverflow.com/questions/7789126/is-there-any-definitive-documentation-on-the-ontology-of-windows-runtime-winrt)没有得到任何真正答案的上一个问题，也许是因为它的措辞相当不透明，比如“本体”之类的 5 美元。为了更好地解释我在寻找什么，这里有一些问题示例，我希望我寻求的文档能告诉我以下问题的答案：

*（请注意，这些只是示例。我的主要目标是找到一个能够回答这些**和类似问题**的规范，而不是获得这些特定示例的答案。）*

> `Windows.Networking.Sockets.StreamSocket`有一个`InputStream`type 的属性，`Windows.Storage.Streams.IInputStream`我显然应该用它来从套接字读取。但唯一的方法`IInputStream`是`ReadAsync`读入`IBuffer`, 并且`IBuffer`是一个只声明容量和大小属性的接口。如何获取正在读取的实际字节？如果我`IBuffer`自己实现，系统将如何将它们交付给我？
> 
> *经过数小时的沮丧点击和谷歌搜索*，我初步得出结论，该接口是一个谎言——`IBuffer`不是任何人都可以实现的，而是`ReadAsync`特别想要一个`Windows.Storage.Streams.Buffer`（没有`I`），不管它的类型声明说什么。然后看来我可以用来`DataReader`从`Buffer`. 真的是这样吗？

或者

> 嗯，它看起来`DataReader`有一个带 的构造函数`IInputStream`，所以也许我可以`Buffer`删掉中间人。但是，这似乎是错误的，因为`DataReader`诸如 的方法`ReadBytes`是*同步*的，并且据说 WinRT 中的所有 I/O 都是异步的；当然，声明的方法之一`IInputStream`是。那么这是如何工作的呢？
> 
> *在更沮丧的谷歌搜索和点击之后*：哦，有一种`LoadAsync`方法`DataReader`可以做到……某事。根据 MSDN，它“从输入流中加载数据”，但使用它的约定是什么？我应该在构造之后立即调用它一次`DataReader`，还是我可以多次调用它以`DataReader`在下一次读取操作中重用它？内部是否`DataReader`包含循环缓冲区？如果我尝试读取的字节数比已经异步读取的多，会发生什么？这些方法的超简洁文档`ReadFoo`没有提到异常或错误条件；`DataReader`或的类文档也没有`IDataReader`。

或者

> 显然，应用程序可以是多线程的，因为受[支持的 Win32 API](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/br205762.aspx)包括类似的东西`InterlockedCompareExchange`，`EnterCriticalSection`等等。但是似乎既不支持`CreateThread`也不支持 RTL ，而且在 WinRT 类层次结构中的任何地方似乎都没有任何 Java-ish 类。如何开始一个新线程？`_beginthreadex``Thread`

或者

> 谈到异步 I/O ...我对异步 I/O 和完成延续的一般概念很满意，但是 WinRT 中的精确规则是什么，比如调用完成例程的线程是什么？如果它始终是我开始 I/O 操作的同一个线程（我希望！），我是否需要确保它不时进入某种警报等待，以便系统有机会在那里调用我的代码?

或者

> 维基百科声称*“WinRT 本质上是一个基于 COM 的 API，尽管依赖于增强的 COM。”* 这种“增强”究竟是什么？如果我遵循 COM 规则和约定，我是否会因为“增强”而面临被不同工作方式所困扰的风险？或者，相反，由于增强，我可以做一些更容易的事情吗？

或者

> 对异步回调如何工作的唯一描述使它看起来非常特定于实现语言——它在 C#/CLR、JavaScript 和 C++/CX 之间看起来完全不同。这里的 COM/ABI 级别实际发生了什么？特别是，由于 API 文档似乎假定“C++”表示“C++/CX”，如果我改用 WRL，异步 I/O 将如何工作？或者仅仅是`await`and`then`业务只是语言提供的糖，而*真正的*ABI 总是按照`AsyncOperationWithProgressCompletedHandler`API 参考中描述的等等？但这是一个委托类型；就COM而言，这甚至具有明确定义的含义吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T20:52:04.090

我刚刚注意到 MSDN 上似乎有两个*并行*的页面层次结构描述了 WinRT API：

*   Windows 应用商店应用开发 | API 参考 | [Windows 应用商店应用程序的 Windows API 参考](http://msdn.microsoft.com/en-us/library/windows/apps/br211377.aspx)

这是我在问题中咆哮的几乎空洞的文档。但是，一些 API 元素*也在*

*   MSDN 库 | 其他资源 | [Windows 运行时 C++ 参考](http://msdn.microsoft.com/en-us/library/br224617%28v=vs.85%29.aspx)

它稍微接近 COM 金属，并且偶尔包含有用的*备注*部分。例如，它的 IBuffer 页面显示[IBuffer](http://msdn.microsoft.com/en-us/library/hh438362%28v=vs.85%29.aspx)的实现还必须实现[IBufferByteAccess](http://msdn.microsoft.com/en-us/library/hh846267%28v=vs.85%29.aspx)，它提供对实际字节的访问。

这并不理想（而且似乎仍然隐含了很多信息），但它至少是一些东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T13:20:38.800

我认为这篇文章可能是一个[https://chat.stackoverflow.com/](https://chat.stackoverflow.com/)辩论，但不是问题。WinRT Api 和投影（c#/xaml 或 html/js 等）参考是在他们的第一个版本中，从我的角度来看，它们只是一个基本参考，而不是一个扩展的文档源。

这通常发生在所有最近创建的技术中，我认为您只需要等待几个月，文档就会开始逐渐改进。

# vb.net - 如果我们不知道 column_names VB.net，我们如何处理 `SELECT` 语句？

> ID：13197504
> 
> 赞同：1
> 
> 时间：2012-11-02T14:45:04.980
> 
> 标签：vb.net

`SELECT`如果我们不知道 column_names，我们如何处理该语句

如果我有以下查询，我的经验很少

```
 SELECT * FROM emp 
```

我会做

```
 While sqlReader.Read()
        Dim name as string = sqlReader.Item("emp_name")
    End While 
```

**问题**

但是如果我不知道我得到的数字和列名有什么 *方法可以处理这个* 方法告诉我们选择了 x 个列及其名称

然后将其作为字符串列表返回，我不知道这是否重要，但我将其作为 Web 服务执行

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T14:53:31.493

您可以使用 的`FieldCount`属性`System.Data.SqlClient.SqlDataReader`来获取字段的数量。然后，您可以使用该`GetName`属性来获取字段名称。

```
Dim Names as New list(of String) 
For i as integer = 0 to sqlReader.FieldCount -1 
    Names.Add(sqlReader.GetName(i))
Next 
```

[http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.aspx](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T14:52:00.267

SqlDataReader类具有[FieldCount](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader%28v=vs.90%29.aspx)[属性](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.fieldcount%28v=vs.90%29.aspx)来告诉您有多少列，以及[GetName](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.getname%28v=vs.90%29.aspx)方法来告诉您它们的名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-02T14:52:42.667

如果您使用的是 Sql Server，则可以查询 sys.columns 视图。

```
SELECT name FROM sys.columns WHERE object_id = OBJECT_ID('tablename'); 
```

在您的示例中，表名将是“emp”。

如果您使用不同的数据库，您可以尝试 INFORMATION_SCHEMA.COLUMNS 视图，它返回类似的信息。

# c++ - 为什么使用嵌套的 OpenMP pragma 时 c++11 线程变得不可连接？

> ID：13197510
> 
> 赞同：6
> 
> 时间：2012-11-02T14:45:36.540
> 
> 标签：c++, multithreading, c++11, openmp

以下代码应该非常简单，但在尝试对具有嵌套 OpenMP 代码的线程执行 .join() 时，似乎最终会陷入挂起状态。使用 GCC 编译器 4.7.2 x64 和来自[http://sourceforge.net/projects/mingwbuilds](http://sourceforge.net/projects/mingwbuilds)的pthreads`g++ threadexample.cpp -Wall -std=c++11 -fopenmp -o threads`

```
// threadexample.cpp
#include <iostream>
#include <thread>
#include <omp.h>

using namespace std;

void hello(int a) {

    #pragma omp parallel for
        for (int i=0;i<5;++i) {
            #pragma omp critical
            cout << "Hello from " << a << "! " << "OMP thread iter " << i << endl;
        }

    cout << "About to return from hello function" << endl;
}

int main (int argc, char ** argv) {

    thread t1(hello, 1); //fork
    cout << "t1 away!" << endl;
    thread t2(hello, 2);
    cout << "t2 away!" << endl;

    t1.join(); //join
    cout << "thread 1 joined" << endl;
    t2.join();
    cout << "thread 2 joined" << endl;

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-02T15:46:36.277

混合 OpenMP 和任何其他线程库（`pthreads`、Win32 线程等）可能不是一个好主意。编写 OpenMP 运行时可能会假定它完全控制线程并且可能不支持`parallel`同时运行的区域（例如，它可能使用信号量等全局变量来控制线程池）。

实现这一点的更好的纯 OpenMP 方法是：

```
#include <iostream>
#include <omp.h>

using namespace std;

void hello(int a) {

    #pragma omp parallel for
    for (int i=0;i<5;++i) {
        #pragma omp critical
        cout << "Hello from " << a << "! " << "OMP thread iter " << i << endl;
    }

    cout << "About to return from hello function" << endl;
}

int main (int argc, char ** argv) {

    omp_set_nested(1);

    #pragma omp parallel sections num_threads(2)
    {
       #pragma omp section
       {
           hello(1);
       }
       #pragma omp section
       {
           hello(2);
       }
    }

    return 0;
} 
```

需要调用 to`omp_set_nested()`才能启用默认禁用的嵌套并行性。

# google-app-engine - AppEngine过滤不等式与列表替代

> ID：13197518
> 
> 赞同：0
> 
> 时间：2012-11-02T14:45:52.733
> 
> 标签：google-app-engine, nosql, google-cloud-datastore, google-cloud-sql

目前，对于使用 DataStore 的 AppEngine 应用程序，我有以下模型结构（为清楚起见而缩写）：

```
class User(db.Model):
    name = db.StringProperty()
class Game(db.Model):
    name = db.StringProperty()
class UserGame(db.Model):
    user = db.ReferenceProperty(User)
    game = db.ReferenceProperty(Game)
    high_score = db.IntegerProperty() 
```

游戏多，用户多。我正在尝试查询用户尚未加入的游戏列表，类似于（伪）SQL 等价于`SELECT * from Game where name NOT IN (SELECT * from UserGame where user = <<current_user>>)`

我的第一种方法是获取 UserGames 列表并遍历该列表，添加`.filter('__key__ !=',<<user_key>>)`但不可能链接不等式过滤器。

我的问题是，有没有更好的建模想法人们可以想象得到我需要的数据，或者我应该将所有内容迁移到 CloudSQL？我看不到如何使用我正在使用的当前模型在数据存储级别获取这些信息。

我知道我可以通过保留该用户的 UserGame 列表来以编程方式执行此操作，抓取 Game.all()，并以编程方式过滤掉结果，但这并不理想，因为我想使用光标对结果进行分页。

谢谢大家的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T15:44:43.730

您可以使用快速投影查询来获取用户的游戏密钥列表。当您拥有所有游戏密钥的列表时，您可以使用 Python 集来找到答案。要获取所有游戏键的列表，如果需要进一步优化，可以执行快速 key_only 查询并保存（pickle）此列表。

这是一个关于 appengine 的精彩视频：SQL 与 NoSQL：后端之战 [https://developers.google.com/events/io/sessions/gooio2012/306/](https://developers.google.com/events/io/sessions/gooio2012/306/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T20:51:47.427

如果您的游戏是固定的，则可能有一种“不同”的方式来做到这一点。具体来说，如果游戏没有及时更改，那么您可以`User`使用包含所有游戏的属性初始化模型，并且对于用户加入的每个游戏，将其从列表中删除。因此，您始终可以拥有未加入游戏的列表。

此外，为了避免大量的写入操作，您可以将此属性设置为未索引。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T18:19:11.737

好的，我想通了。事实证明，您确实必须使用未记录的`__key__`属性来过滤您的查询。基本上，您使用 DataStore 来查询要首先过滤掉的实体，类似于以下内容：

```
joined_list = models.UserGame.all()
joined_list.filter('user =', <<current_user>>) 
```

然后你遍历它并使用过滤掉`!=`，就像这样：

```
for joined in joined_list:
    games.filter('__key__ !=', joined.key()) 
```

这里唯一的问题是您不能在任何其他属性上使用不等式（DataStore 限制）。

这将为您提供用户尚未加入的所有游戏的列表。

希望这对其他人有帮助！

# iphone - 我想在 NSObject 类中添加 MBProgressHUD

> ID：13197522
> 
> 赞同：0
> 
> 时间：2012-11-02T14:46:25.680
> 
> 标签：iphone, ios, mbprogresshud

我正在从我的 NSObject 类在服务器上上传数据，现在我想在上传数据时显示 MBProgressHUD，我知道如何使用 ViewController 显示 MBProgressHUD，但不知道如何使用 NSObject 类显示它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T15:05:33.323

```
AppDelegate* delegate = [[UIApplication sharedApplication] delegate];
[delegate.window addSubview:HUD];
...
[HUD removeFromSuperview]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T15:13:03.500

有几种方法可以解决此类问题。最常见的一种是使用委托模式，尽管您可以使用块、KVO 或通知。

你应该首先创建一个协议，这样你就可以在你`UIViewController`和你`NSObject`的调用者之间进行通信。尽管您不需要一个人来创建这种通信，但您应该使用它来拥有更灵活的代码。

通常，我会做这样的事情：

```
@protocol CommunicationDelegate <NSObject>

@required

-(void)communicationSucceed;

-(void)communicationFailedWithError:(NSError*)anError; 
```

在您的内部`NSObject`，您将有一个`weak`符合协议的对象的引用`CommunicationDelegate`。在你的 .h 你应该有这样的东西：

```
@property(nonatomic, weak) id <CommunicationDelegate> communicationDelegate; 
```

就在你真正开始你的工作之前`NSObject`，你应该做：

```
myObjectThatWillDoSomething.communicationDelegate = self; 
```

此时，您的`UIViewController`和您的`NSObject`. 在 UIViewController 的 .h 文件中，添加以下内容：

```
@interface myViewController : UIViewController <CommunicationDelegate> 
```

所以你`UIViewController`遵守`CommunicationDelegate`协议。

您现在可以`MBProgressHUD`从您的`UIViewController`. 完成`NSObject`他的工作后，您可以致电：

```
[communicationDelegate communicationSucceed]; 
```

或者

```
[communicationDelegate communicationFailedWithError:anError]; //anError is used to describe what went wrong 
```

一旦（其中一个）这些方法被调用，您就可以删除您的`MBProgressHUD`. 了解此方法在您的`UIViewController`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T15:08:58.123

使用 NSNotification Center 停止 Indicator，在视图控制器中用监听方法声明 NSNotification。并从 Webservice 文件发布通知。通知中心监听方法中的停止指示器。

这个链接可以帮助你

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-02T15:09:02.737

在您的上传器对象上创建一个委托协议

```
@protocol UploaderThingyDelegate <NSObject>

-(void)stuffStarted;

-(void)stuffEnded;

@end

@interface UploaderThingy : NSObject

@property (weak) id<UploaderThingyDelegate> delegate; 
```

将您的相关 View 或 ViewController 设置为上传者委托并在那里触发 MBProgressHUD 添加/删除。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-02T14:53:26.723

当您上传您的 NSObject 时，会显示一个视图，对吗？因此，在该视图中显示您的 HUD。您可能需要创建一个委托来通知视图何时开始下载、何时结束以及是否有错误。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-02-20T04:18:09.430

这些下面的代码在 NSObject 文件中工作正常

第 1 步：下载[https://github.com/jdg/MBProgressHUD](https://github.com/jdg/MBProgressHUD)

第 2 步：添加委托 MBProgressHUDDelegate

第三步：声明实例 MBProgressHUD *HUD；

第 4 步：在您想要的地方编写代码：

```
HUD = [[MBProgressHUD alloc] initWithWindow:[UIApplication sharedApplication].keyWindow];
[[UIApplication sharedApplication].keyWindow addSubview:HUD];

HUD.delegate = self;
HUD.labelText = @"Processing";
[HUD show:YES]; 
```

# java - android - java.lang.IllegalArgumentException 当两个日期之间没有天数差时

> ID：13197524
> 
> 赞同：-1
> 
> 时间：2012-11-02T14:46:42.437
> 
> 标签：java, android, illegalargumentexception, android-date

在我的应用程序中，我使用以下代码计算旧日期和新日期之间的天数差异。它在 android 2.2 和 2.3.6 设备上运行良好，但在 android 4.0 设备上它会崩溃 `java.lang.IllegalArgumentException`。我不知道 sdk 4.0 不支持我的代码。请帮我。

我的代码是：

```
Date date;
String old_Date = null;
.....
date = new Date();
old_Date = date.toString(); // i am storing it in sharedPreference so that i convert to string 
.......
date = new Date();
long diff = calculate_dateDifference(date,new Date(old_Date));  // line no 65.
... 
```

和我的方法：

```
 protected long calculate_dateDifference(Date newerDate, Date olderDate) {
        return (newerDate.getTime() - olderDate.getTime()) / (1000 * 60 * 60 * 24);
    } 
```

我的样本日志猫：

```
Caused by: java.lang.IllegalArgumentException
at java.util.Date.parse(Date.java:506)
at java.util.Date.<init>(Date.java:149)
at com.xxx.zzz.MainActivity.onCreate(MainActivity.java:65) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T14:50:54.313

看这部分

```
calculate_difference(date, new Date(old_date));

//and earlier
old_Date = date.toString(); 
```

显然，您不能再`Date`从`String`. 您必须弄清楚一些事情，但我建议使用`SimpleCalendar`和`DateFormat`- 使用`DateFormat`将您的字符串存储在 SharedPreferences 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T14:52:21.750

自 java1.1 以来，[public Date (String string)是不推荐使用的方法，不能保证按预期运行。](http://developer.android.com/reference/java/util/Date.html#Date%28java.lang.String%29)

如果您有字符串并想将其转换为日期使用

```
DateFormat df = DateFormat.getDateInstance();
myDate = df.parse(myString); 
```

这是[DateFromat javadoc](http://developer.android.com/reference/java/text/DateFormat.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T15:01:38.977

我建议存储毫秒而不是日期字符串。作为奖励，您可以使用表示毫秒的长参数来实例化日期。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-02T15:11:34.940

也许使用带有时间戳的日期：

```
System.currentTimeMillis(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-02T15:15:55.573

根据您的日期格式，您可以使用以下代码，

```
Date oldDate   = new SimpleDateFormat("dd-MM-yyyy").parse("29-10-2012");
Date newerDate = new Date();

int dayInMillisecs = 1000 * 60 * 60 * 24;

int dayDifference = (int) ((newerDate.getTime() - oldDate.getTime()) / dayInMillisecs); 
```

# asp.net-mvc - ASP.NET MVC 定位从 cshtml 生成的 cs 文件？

> ID：13197525
> 
> 赞同：11
> 
> 时间：2012-11-02T14:46:51.077
> 
> 标签：asp.net-mvc, razor

所以我最近开始使用 ASP.NET MVC 4。我正在使用剃刀引擎。我的问题是关于后缀为 cshtml 的视图文件。在我看来，这些是由 razor 预编译成 *.cs 文件的，然后这些文件又被编译成 MSIL。（我作为 JSP 开发人员时熟悉的一种模式。）我做出这种假设的一个原因是，如果我在 cshtml 文件中输入一些无效的 c# 代码，我会收到如下所示的编译错误：

> 第 34 行：公共类 _Page_Views_BaseDataAdmin_Index_cshtml ：...

并且第 34 行并不表示错误在 cshtml 文件中的位置，就像 _Page_Views_BaseDataAdmin_Index_cshtml 类似乎指的是常规 .net 类而不是视图文件一样。

所以我的问题是：我在哪里可以找到 cs 文件？具体来说，在上面的示例中，“_Page_Views_BaseDataAdmin_Index_cshtml.cs”？也许我需要添加一些配置来告诉 MVC 将此 .cs 文件保留在磁盘上，如果是这样，我该怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-05-15T21:58:23.507

查找生成文件的快速提示是将其添加到您的 .cshtml 文件中。

这将立即向您显示完整路径

```
<div>This file is compiled to  @this.GetType().Assembly.CodeBase</div> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-02T16:20:28.363

您可以在 Temporary ASP.NET Files 文件夹中找到已编译的视图。

首先找到与您的视图对应的 .compiled 文件（例如：home.cshtml）： **home.cshtml.a8d08dba.compiled**

此文件包含程序集名称：**assembly="App_Web_hkc53urb"**

您的 .cs 文件将是与数字连接的程序集名称：**App_Web_hkc53urb.1.cs**

一种更简单的方法可能是使用 Windows 搜索临时 ASP.NET 目录中的视图名称。

# sql-server-2008 - 遍历我的 SQL Server 数据库中的所有记录

> ID：13197526
> 
> 赞同：1
> 
> 时间：2012-11-02T14:46:52.247
> 
> 标签：sql-server-2008, tsql

我有以下 SQL 脚本。如您所见，我手动将`@listingid`值设置为 30653。

但是应该对`[listings]`表中`@listingid`分配了`[listings].id`列值的所有记录执行此脚本。

```
DECLARE @profname nvarchar(150)
DECLARE @furl nvarchar(250)
DECLARE @city nvarchar(250)
DECLARE @listingid int

set @listingid=30653
--select the top 1 professionname
SELECT TOP 1 @profname=REPLACE(LOWER(pn.title),' ','-'),@furl=l.friendlyurl,@city=REPLACE(REPLACE(LOWER(l.city),'''',''),' ','-') FROM healthprof_professionnames hpn
INNER JOIN professionname pn ON pn.id=hpn.professionnameid
INNER JOIN listings l on l.id=hpn.healthprofid
WHERE l.id=@listingid ORDER BY pn.title

--check if current friendlyurl already contains profession
IF NOT CHARINDEX(@profname,@furl)>0
    SET @furl = @furl + '-' + @profname

IF NOT CHARINDEX(@city,@furl)>0
SET @furl = @furl + '-' + @city

SET @furl = @furl + '-3'

UPDATE listings set friendlyurl=@furl WHERE id=@listingid 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T14:50:53.753

您可以使用游标遍历结果集中的每一行：

```
declare cur cursor for
select distinct id from listings

declare @listingid int
open cur
fetch next from cur into @listingid 

while @@FETCH_STATUS = 0
BEGIN
    -- your code from above goes here

    fetch next from cur into @listingid 
END 
```

话虽如此，我同意蒂姆的上述评论。如果可能的话，重写它以在一个基于集合的操作中工作。我*认为*这会起作用，但我还没有测试过：

```
;WITH vars AS (
    SELECT id, profname, furl, city
    FROM (
        SELECT l.id,
            REPLACE(LOWER(pn.title),' ','-') as profname,
            l.friendlyurl as furl,
            REPLACE(REPLACE(LOWER(l.city),'''',''),' ','-') as city,
            ROW_NUMBER() OVER (PARTITION BY l.id ORDER BY pn.title) as rnk
        FROM healthprof_professionnames hpn
        INNER JOIN professionname pn ON pn.id=hpn.professionnameid
        INNER JOIN listings l on l.id=hpn.healthprofid
    ) A
    WHERE A.rnk = 1
),
vars2 AS (
    SELECT id,
        CASE WHEN NOT CHARINDEX(profname, furl) > 0
            THEN furl + '-' + profname ELSE furl END as furl,
        city
    FROM vars
),
vars3 as (
    SELECT id,
        CASE WHEN NOT CHARINDEX(city, furl) > 0
            THEN furl + '-' + city ELSE furl END as furl
    FROM vars2
)
UPDATE listings SET friendlyurl = vars3.furl + '-3'
FROM listings INNER JOIN vars3 on vars3.id = listings.id 
```

# .net - 在 WPF 中的网格上放置边框

> ID：13197528
> 
> 赞同：0
> 
> 时间：2012-11-02T14:47:15.540
> 
> 标签：.net, wpf, user-controls, border

有没有办法`Border`在`Grid`不包围元素`Grid`的情况下放置 a ？`Border`

```
<Border Margin="{Binding ElementName=thisUserControl, Path=PrintMargin}"
        BorderThickness="{Binding ElementName=thisUserControl, 
                             Path=PrintMarginThickness}"
        BorderBrush="LightGray">
    <Grid x:Name="mainGrid"
          Background="{Binding ElementName=thisUserControl, Path=Background}" />
</Border> 
```

我可以在网格上使用像“BitmapEffect”这样的东西吗？我只需要在我的 WpfUserControl 上显示或不显示名为“PrintMargin”的边框...

这个边框应该或不可见，也许我需要控制它的**厚度**和**颜色**（画笔）......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T15:01:22.050

做你提到的方式（网格周围的边框）没有任何问题，但如果你真的想要你可以添加`Border`作为你的最后一个元素`Grid`：

```
<Grid>
    .. other elements ..
    <Border BorderBrush="DeepPink" BorderThickness="1" />
</Grid> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T15:58:16.853

好吧，我`Button`几周前就这样做了，也许您可​​以将样本调整为`Grid`对照？

```
 <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="Button">
                <Border Name="border" 
                        BorderThickness="{TemplateBinding BorderThickness}"
                        Padding="{TemplateBinding Padding}" 
                        BorderBrush="{TemplateBinding BorderBrush}" 
                        CornerRadius="5"
                        Margin="{TemplateBinding Margin}"
                        Background="{TemplateBinding Background}">
                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                </Border>
            </ControlTemplate>
        </Setter.Value>
    </Setter> 
```

**编辑：**我想您将不得不使用该`Panel`方法而不是`ContentPresenter`，不知道如何从那里开始，但希望这会有所帮助。

# objective-c - 接受从 iPhoto 或 Aperture 拖放

> ID：13197533
> 
> 赞同：0
> 
> 时间：2012-11-02T14:47:39.263
> 
> 标签：objective-c, macos, cocoa, nspasteboard, iphoto

我创建了一个应用程序，其中包含一个 ImageView 子类，它直接从 Finder 接受拖放文件/文件夹。

问题是我现在正试图让它接受来自 iPhoto 或 Aperture 的照片。

`PboardType`我应该注册哪个？

我目前正在做的是：

```
 [self registerForDraggedTypes:
     [NSArray arrayWithObjects:NSFilenamesPboardType, nil]]; 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T15:38:41.603

使用 Pasteboard Peeker（来自 Apple）向我展示了 Aperture 为您提供文件名/U​​RL 以及“光圈图像数据”（无论是什么）。iPhoto 似乎只给出“ImageDataListPboardType”，这是一个 PLIST。我猜你可以用 NSLog() 来查看它的结构并从中提取图像信息。它可能包括文件名/U​​RL 信息以及作为数据的实际图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T01:26:33.693

您注册 NSFilenamesPboardType 是正确的。完成任务：

1：确保在draggingEntered中接受复制操作。通用操作是不够的。

```
- (NSDragOperation)draggingEntered:(id <NSDraggingInfo>)sender {

    NSDragOperation sourceDragMask = [sender draggingSourceOperationMask];
    NSPasteboard *pasteboard = [sender draggingPasteboard];
    if ( [[pasteboard types] containsObject:NSFilenamesPboardType] ) {
            if (sourceDragMask & NSDragOperationCopy) {
                return NSDragOperationCopy;
            }
    }

    return NSDragOperationNone;
} 
```

2：每张照片将有一个文件名。和他们做点什么。

```
- (BOOL)performDragOperation:(id <NSDraggingInfo>)sender {
    NSPasteboard *pasteboard;
    NSDragOperation sourceDragMask;

    sourceDragMask = [sender draggingSourceOperationMask];
    pasteboard = [sender draggingPasteboard];

    if ([[pasteboard types] containsObject:NSFilenamesPboardType])
    {    
         NSData* data = [pasteboard dataForType:NSFilenamesPboardType];        
         if(data)
         {
             NSString *errorDescription;
             NSArray *filenames = [NSPropertyListSerialization propertyListFromData:data mutabilityOption:kCFPropertyListImmutable format:nil errorDescription:&errorDescription];

             for (NSString* filename in filenames)
             {
                 NSImage* image = [[NSImage alloc]initWithContentsOfFile:filename];
                 //Do something with the image
             }
         }
     }

    return YES;
} 
```

# firebug - Firebug 控制台交互与回显行为

> ID：13197535
> 
> 赞同：0
> 
> 时间：2012-11-02T14:47:44.010
> 
> 标签：firebug

Firebug 中的控制台只是回显我输入的所有内容，而不是像以前那样解释它。如果有切换此行为的选项，我找不到它。

```
Command line window:
var x=5;
x*x;

Console:
>>> var x=5; x*x; 
```

交互模式如何恢复？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T13:44:00.053

重新安装 Firebug 将损坏的功能恢复到工作状态。

# php - 如何通过弹出窗口确认表单提交，而不是重定向？

> ID：13197537
> 
> 赞同：0
> 
> 时间：2012-11-02T14:47:52.997
> 
> 标签：php, jquery, forms, popup, contact

我一直在寻找解决我正在尝试重新使用的 PHP 脚本的特定问题的解决方案。

```
<?php $name = $_POST['name'];
$company = $_POST['company'];
$email = $_POST['email'];
$message = $_POST['message'];
$formcontent = "$name \nMessage: $message";
$recipient = "me@me.com";
$subject = "Contact Form";
$mailheader = "From: $email \r\n";
mail($recipient, $subject, $formcontent, $mailheader) or die ("Error!");
echo "Thank You!" . " -" . " <a href = '../index.html' style = 'text-decoration:none;color:#ff0099;'>Return Home</a>";
?> 
```

我不想重新定向到另一个页面，而是渴望了解一种通过模式弹出窗口启动确认的简洁方法。

我将脚本作为外部文件运行，所以我猜答案已经有一半了，但就调用 jQuery 插件来完成其余工作而言，我可以使用一两个指针！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T15:06:24.737

*   将所有 html 输入包装在一个表单元素中。
*   单击发送邮件链接，附加一个 ajax 事件以向包含发送邮件的业务逻辑的 php 文件发送一个 ajax POST 请求（如您的问题所示）。
*   然后在事件成功时，您可以向用户显示成功消息。
*   为了用最少的代码实现这一点，我建议您结合使用 JQuery（对于 ajax 表单帖子）和 Twitter Bootstrap（对于 CSS 和模式窗口）
*   下面的代码之类的一些实现可能会对您有所帮助

$('#divId').click(function () {

```
//start the ajax
$.ajax({
    //this is the php file that processes the data and send mail
    url: "send_mail.php",

    //POST method is used
    type: "POST",
    // here we are serializing all form values ( its is not php serialize)
    data: $("#Form").serialize(),
    //Do not cache the page
    cache: false,

    //success
    success: function (html) {             
        if (html=='1') {    
            $('#divModal').modal('show') ; 

        }              
    }      
});

//cancel the submit button default behaviours
return false; 
```

});

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T14:49:12.527

如果您不想重新加载或重定向到新页面，则需要通过 AJAX 发布。

在 AJAX 调用的“成功”方法上，您将触发您的对话框。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T14:53:55.490

或者您可以在 onsubmit 属性中使用它

```
onSubmit="javascript: return confirm('Are you sure you want to submit this?');" 
```

将要求确定/取消确认

--- jQuery Ajax -----

```
function doSubmit(){
  var postData = jQuery('#your-form-id').serialize();    

  jQuery.ajax({
    url: 'form-action.php',
    data: postData
  }).done(function( html ) {
    alert(html);
  });
} 
```

-- 在你的表单标签中 ---

```
<form id="your-form-id" onsubmit="javascript: doSubmit();" ... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-02T14:54:58.870

正如 Diodeus 建议的那样，您应该使用 HTTP 请求来调用您的 php 文件。使用从请求中返回的输出，您可以创建一个弹出窗口或任何您想通知用户的内容。[在这里](http://www.w3schools.com/php/php_ajax_php.asp)，您可以找到有关如何执行此操作的一些基本信息。

# php - 错误！如果发送空帖子，则得到未定义的变量

> ID：13197538
> 
> 赞同：-1
> 
> 时间：2012-11-02T14:47:54.927
> 
> 标签：php

如果在我的注册表单中发送空帖子，我会收到错误消息

**注意：未定义索引：第 34 行 /opt/lampp/htdocs/user/register.php 中的术语**

在第 34 行我有这个

```
$terms = trim($_POST["terms"]); 
```

并以我的形式

```
<p>
<input type="checkbox" name="terms" id="terms"> I have read and accept the conditions of use
</p> 
```

这就是所有的验证表格

```
if(!empty($_POST))
{
        $errors       = array();
        $terms        = trim($_POST["terms"]);
        $captcha      = md5($_POST["captcha"]);
    $name         = trim($_POST["name"]);

    if($terms == "")
    {
        $errors[] = lang("ACCOUNT_SPECIFY_NAME");
    }

    //End data validation
    if(count($errors) == 0)
    {   
            //Construct a user object
            $user = new User($username,$password,$email,$name,$lastname);

            //Checking this flag tells us whether there were any errors such as possible data duplication occured
            if(!$user->status)
            {
                if($user->username_taken) $errors[] = lang("ACCOUNT_USERNAME_IN_USE",array($username));
                if($user->email_taken)    $errors[] = lang("ACCOUNT_EMAIL_IN_USE",array($email));   
                if($user->email_blocked)  $errors[] = lang("ACCOUNT_EMAIL_BLOCKED");        
            }
            else
            {
                //Attempt to add the user to the database, carry out finishing  tasks like emailing the user (if required)
                if(!$user->userCakeAddUser())
                {
                    if($user->mail_failure) $errors[] = lang("MAIL_ERROR");
                    if($user->sql_failure)  $errors[] = lang("SQL_ERROR");
                }
            }
    }
} 
```

?>

为什么我收到此警报消息？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T14:50:11.437

这不是一个错误，而是一个通知，如果它不是关键的，可以忽略它。

```
if(isset($_POST['terms']))$terms = trim($_POST["terms"]); 
```

`isset()`PHP 中的函数确定变量是否已设置且不为 NULL。它返回一个布尔值，也就是说，如果设置了变量，则返回 true，如果变量值为 null，则返回 false。

您也可以使用关闭通知

```
error_reporting(E_ALL ^ E_NOTICE); 
```

在脚本的开头..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T14:49:13.423

尝试替换这个：

`if(!empty($_POST))`

有了这个：

`if(!empty($_POST["terms"]))`

您需要确保数组**$_POST**具有包含关键**术语的值**

**编辑：**

尝试这个：

```
$terms        = empty($_POST["terms"]) ? null : trim($_POST["terms"]);
$captcha      = empty($_POST["captcha"]) ? null : md5($_POST["captcha"]);
$name         = empty($_POST["name"]) ? null : trim($_POST["name"]); 
```

而不是这个：

```
$terms        = trim($_POST["terms"]);
$captcha      = md5($_POST["captcha"]);
$name         = trim($_POST["name"]); 
```

# javascript - 如何检测浏览器何时放置保存的密码？

> ID：13197539
> 
> 赞同：3
> 
> 时间：2012-11-02T14:47:59.567
> 
> 标签：javascript, jquery, cross-browser

我试图检测浏览器何时将保存的用户名和密码放入输入字段。我看过[这篇文章](https://stackoverflow.com/questions/3200011/how-can-i-detect-when-a-browser-enters-a-stored-password-into-web-login)，但我没有选择更改此功能的选项，并且其他解决方案也不起作用。

基本上，如果加载时字段为空，我有一个禁用的登录按钮。但是当浏览器填写输入时，它不会启用按钮。我正在尝试找到如何查看它是否会发生变化。

我正在使用 jQuery 和 JS。

我试过 .change、on .ready、on .load 等等。它似乎发生在 .load 事件之后。

有谁知道解决这个问题？我想避免使用任何类型的超时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T14:54:27.563

我认为没有办法检测浏览器是否有一些预填充字段的内置功能。

如果有东西，您可以使用启用按钮的计时器来解决问题。像这样的东西：

```
setInterval(function (){
 if($("#username").val()!=""){
  $("#loginbutton").attr("enabled","enabled"); 
 }
},1000) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T14:50:13.627

关键是该字段将被填充，而该字段中没有任何按键。

因此，如果您在输入字段上捕获 .keypress 以了解是否按下了某个键，那么如果您提交表单并发现尽管有一个值但没有按键 - 那么您可以在一定程度上确定浏览器预先填充它。

如果您想在提交之前知道（在页面加载后不久），您需要在一个间隔上运行检查，看看值是否在没有按键的情况下发生了变化。

正如@japrescott 指出的那样，您可能还需要检查 .focus 以防用户在其中粘贴值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T14:56:04.530

还没有对此进行测试，但是您不能简单地将每个字段的默认值与页面加载后的每个字段的值进行比较（或者如果这是一个问题，则在页面加载后 0.2 秒）？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-02T15:06:24.877

试一试Jquery [.live() 函数](http://api.jquery.com/live/)

```
$('.element').live('load', function(){
  enableLogin();
}); 
```

# php - 从 mysql 日期输入到现在经过的秒数

> ID：13197545
> 
> 赞同：-1
> 
> 时间：2012-11-02T14:48:30.370
> 
> 标签：php, mysql, datetime

我已经搜索过，我有太多的试验/错误，但没有运气。所以这里是：

我想找出自插入的 Mysql 条目`NOW()`的日期和格式为 . 的当前日期以来已经过去了多少秒。这`date("Y.m.d H:i:s")`是我的 php 函数（取自用户发布的@stackoverflow）。

```
function multipost(){
global $dbh;
$ip= $_SERVER['REMOTE_ADDR']; 

$sql = "select * from  table where ip='$ipa' order by date_time desc limit 1";

foreach ($dbh->query($sql) as $row) {
    $timeFirst=$row['date_time'];
    $timeSecond=date("Y.m.d H:i:s");
    $differenceInSeconds = $timeSecond-$timeFirst;
    echo $differenceInSeconds;
} 
```

我也尝试过`strtotime($row['date_time'];)`，但没有运气。有什么帮助吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T14:58:13.807

```
function secDifference($date,$time){
    $dateVals = explode("-",$date);
    $timeUnix = 0;
    if($time == 0){
        $timeUnix = date("U",mktime(0,0,0,$dateVals[1],$dateVals[2],$dateVals[0]));
    }
    else{
        $tempVals = explode(" ",$dateVals[2]);
        $dateVals[2] = $tempVals[0];
        $timeVals = explode(":",$tempVals[1]);
        $timeUnix = date("U",mktime($timeVals[0],$timeVals[1],$timeVals[2],$dateVals[1],$dateVals[2],$dateVals[0]));
    }
    return (date("U")-$timeUnix);
} 
```

复制此功能。要获得 DATE 和 NOW 的差异：

```
secDifference("12/03/1993"); 
```

要获得日期时间和现在的差异：

```
secDifference("12/03/1993 14:54:32",1); 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T15:05:18.267

您可以让 mysql 为您返回值：

```
select *, TIMESTAMPDIFF(SECOND, NOW(), date_time) AS time_diff from  table where ip='$ipa' order by date_time desc limit 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T15:02:12.717

如果您只想知道以秒为单位的时间差异，您可以使用 MySQL `TIMESTAMPDIFF()`。您的查询字符串如下所示：

```
$sql = "SELECT *, TIMESTAMPDIFF(SECOND, date_time, NOW()) AS time_diff FROM table WHERE ip='$ipa' ORDER BY date_time DESC LIMIT 1"; 
```

**请注意**，返回的`TIMESTAMPDIFF`存储为“time_diff”。您的结果将添加“time_diff”作为列。

如需更多文档，请参阅[此页面](http://dev.mysql.com/doc/refman/5.1/de/date-and-time-functions.html)。

# xamarin.android - MvvmCross vNext：ObservableColletion 定义在未引用的程序集中

> ID：13197546
> 
> 赞同：1
> 
> 时间：2012-11-02T14:48:40.437
> 
> 标签：xamarin.android, portable-class-library, mvvmcross

我现在要构建我的 PCL 模型，这需要一些时间来制作插件，但是现在在我的 Android UI 项目中，我在构建它时遇到了两个错误。

第一个错误是：

```
The type 'System.Collections.ObjectModel.ObservableCollection`1<T0>' is defined in an assembly that is not referenced.
You must add a reference to assembly 'System.Windows, Version=2.0.5.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e,
Retargetable=Yes'.  C:\ENM\Main\src\prod\Mobile\Stakeholder\UI.Android.vNext\Views\LocationsMapView.cs  40  32  UI.Android.vNext 
```

第二个错误是：

```
foreach statement cannot operate on variables of type 
'System.Collections.ObjectModel.ObservableCollection`1<BK.EMS.Stakeholder.Model.ViewModels.LocationViewModel>' 
because 'System.Collections.ObjectModel.ObservableCollection`1<BK.EMS.Stakeholder.Model.ViewModels.LocationViewModel>' 
does not contain a public definition for 'GetEnumerator'
C:\ENM\Main\src\prod\Mobile\Stakeholder\UI.Android.vNext\Views\LocationsMapView.cs  40  32  UI.Android.vNext 
```

我已经`System.Windows`从`System.Windows.Droid`项目中引用了程序集，它应该是 forward `ObservableCollection<>`。

发生错误的行：

```
private void AddLocationOverlays()
{
    if (_itemizedOverlay.Size() > 0) _itemizedOverlay.ClearOverlayItems();
    RunOnUiThread(() =>
    {
        foreach (var location in ViewModel.Locations)
        {
            _itemizedOverlay.AddOverlayItem(location);
        }
        _mapView.Invalidate();
    });
} 
```

我的 ViewModel 中的`Locations`属性如下所示：

```
public ObservableCollection<LocationViewModel> Locations
{
    get { return _locations; } 
    set
    {
        _locations = value;
        RaisePropertyChanged(() => Locations);
    }
} 
```

没有什么太复杂并且在非 PCL 模型中工作正常......

那么我该如何解决这个问题呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T08:28:52.977

我们现在有一个解决这个问题的方法 - 请参阅 Daniel Plaisted[在 MonoTouch/MonoDroid 中的 Portable Class Library strong assembly reference questions 中的修复](https://stackoverflow.com/questions/13028321/portable-class-library-strong-assembly-reference-problems-in-monotouch-monodroid)

此修复程序已在[https://github.com/slodge/MvvmCross/commit/f6a88048467838e5ac5ca687744dc0b2d1958aa8签入](https://github.com/slodge/MvvmCross/commit/f6a88048467838e5ac5ca687744dc0b2d1958aa8)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T15:46:45.490

**更新**：查看其他答案。看来我们现在有了解决这个问题的办法！

* * *

我相信这与这个问题有关[——Portable Class Library strong assembly reference questions in MonoTouch/MonoDroid](https://stackoverflow.com/questions/13028321/portable-class-library-strong-assembly-reference-problems-in-monotouch-monodroid)

链接到：[https ://github.com/slodge/MvvmCross/issues/41](https://github.com/slodge/MvvmCross/issues/41)

这是与 Xamarin 一起提出的错误：[https](https://bugzilla.xamarin.com/show_bug.cgi?id=8035) ://bugzilla.xamarin.com/show_bug.cgi?id=8035和

恐怕我现在不了解推荐的强签名解决方案。

请对错误报告进行投票，以提醒 Microsoft PCL 和 Xamarin 团队注意这一点。MS 和 Xamarin 团队正在就此进行交流（尽管是通过我！），我希望我们能找到一种方法让 Microsoft 或 Xamarin 发布一些签名的 DLL。

* * *

与此同时，一些可能的解决方法是：

1.  使用 IEnumerable 访问而不是 ObservableCollection - 集合仍然可以是 ObservableCollection 实例，只是不要在 UI 代码中将其作为 ObservableCollection 引用。

2.  尝试将您的迭代代码放在类库中而不是应用程序项目中 - 感觉很奇怪，编译器似乎非常乐意在库中而不是应用程序中构建相同的代码

3.  尝试使用 Mono 编译器在 MonoDevelop 中构建 - 这似乎没有相同的强名称引用检查。

* * *

查看您的示例代码，我会尝试：

```
private ObservableCollection<LocationViewModel> _locations;
public IEnumerable<LocationViewModel> Locations
{
    get { return _locations; } 
    set
    {
        if (value != null && !(value is ObservableCollection<LocationViewModel>)
        {
            throw new Exception("You must Set an ObservableCollection");
        }
        _locations = (ObservableCollection<LocationViewModel>)value;
        RaisePropertyChanged(() => Locations);
    }
} 
```

然后`AddLocationOverlays`可以保持不变。

唯一的问题是，如果你想`INotifyCollectionChanged`在这个集合上绑定 - 但我认为你也可以在需要时找到解决方法 - 例如，你可以以某种方式公开另一个 INotifyCollectionChanged 钩子，或者你可以尝试使用涉及中间类库。

* * *

我接受现在这些是解决方法而不是解决方案：/

# actionscript-3 - Flash AS3 中的 addChild 和 removeChild(action script3)

> ID：13197549
> 
> 赞同：1
> 
> 时间：2012-11-02T14:48:50.783
> 
> 标签：actionscript-3, removechild, addchild

接下来的代码是关于一个非常简单的幻灯片放映。点击后，我想显示一张图片（或 swf），同时让其他图片消失......这是我的代码，它工作正常，但在 btn3 中，当我点击时，第二张图片不会消失..我不知道为什么。你能教我一些新方法来充分重写我的代码吗？

```
 import flash.display.Loader;
    import flash.events.Event;

    var my_first_swf_loading_ever:Loader=new Loader();
    my_first_swf_loading_ever.load(new URLRequest('1.jpg'));
    var my_second_pic:Loader=new Loader();
    my_second_pic.load(new URLRequest('2.jpg'));
    var my_3_pic:Loader=new Loader();
    my_3_pic.load(new URLRequest('pictures/3.jpg'));

    btn.addEventListener(MouseEvent.CLICK, clicked);

    function clicked(evt:Event):void
    {

    if (contains(my_second_pic)) {
        removeChild(my_second_pic);
        if (contains(my_3_pic)) {
            removeChild(my_3_pic);
        }
    }
    my_first_swf_loading_ever.x=120;
    my_first_swf_loading_ever.y=120;
    addChild(my_first_swf_loading_ever);

    }

    btn2.addEventListener(MouseEvent.CLICK, clicked2);
    function clicked2(evt:Event):void
    {
        if (contains(my_first_swf_loading_ever)) {
            removeChild(my_first_swf_loading_ever);

            if (contains(my_3_pic)) {
                removeChild(my_3_pic);
            }
        }
        my_second_pic.x=120;
        my_second_pic.y=120;
        addChild(my_second_pic);

    }

    btn3.addEventListener(MouseEvent.CLICK, clicked3);
    function clicked3(evt:Event):void
    {
        if (contains(my_first_swf_loading_ever)) {
            removeChild(my_first_swf_loading_ever);
            if (contains(my_second_pic)) {
                removeChild(my_second_pic);

            }
        }
        my_3_pic.x=120;
        my_3_pic.y=120;
        addChild(my_3_pic);

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T15:00:22.710

您应该将代码格式化为更整洁，因为问题会更清晰。在以下几行中：

```
if (contains(my_first_swf_loading_ever)) {
        removeChild(my_first_swf_loading_ever);
    if (contains(my_second_pic)) {
        removeChild(my_second_pic);

}} 
```

检查第二张图片的代码没有执行，如果你重构代码，你可以看到原因：

```
if (contains(my_first_swf_loading_ever)) // First check
{
    removeChild(my_first_swf_loading_ever);
    if (contains(my_second_pic)) // Second check is only reached if first check returns true
    {
        removeChild(my_second_pic);
    }
} 
```

重组为：

```
if (contains(my_first_swf_loading_ever))     // First check
{
    removeChild(my_first_swf_loading_ever);
}
if (contains(my_second_pic))                 // Second check - not reliant on first
{
    removeChild(my_second_pic);
} 
```

以便进行两项检查。其余代码也是如此，如果检查相反，您将在其他按钮上遇到相同的问题。

这是一个很好的参考，您可以在编码时查看不同的内容如何格式化以提高代码的可读性：http: [//techwiki.openstructs.org/index.php/AS3_Coding_Standards#Function_Declarations](http://techwiki.openstructs.org/index.php/AS3_Coding_Standards#Function_Declarations)

# java - 使用带有重复的排序数组的二分搜索

> ID：13197552
> 
> 赞同：27
> 
> 时间：2012-11-02T14:48:56.123
> 
> 标签：java, duplicates, binary-search

我的任务是创建一个方法，该方法将打印在排序数组中找到值 x 的所有索引。

我知道，如果我们只是从 0 到 N（数组长度）扫描数组，它的运行时间会是 O(n) 最坏的情况。由于将传递给方法的数组将被排序，我假设我可以利用使用二进制搜索，因为这将是 O(log n)。但是，这仅适用于数组具有唯一值的情况。因为二进制搜索将在第一次“找到”特定值之后完成。我正在考虑进行二进制搜索以在已排序的数组中找到 x，然后检查该索引之前和之后的所有值，但是如果数组包含所有 x 值，它似乎不会好得多。

我想我要问的是，有没有更好的方法来找到比 O(n) 更好的排序数组中特定值的所有索引？

```
public void PrintIndicesForValue42(int[] sortedArrayOfInts)
{
    // search through the sortedArrayOfInts

    // print all indices where we find the number 42\. 
} 
```

例如： sortedArray = { 1, 13, 42, 42, 42, 77, 78 } 将打印：“42 was found at Indices: 2, 3, 4”

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-12-03T18:01:45.943

你会得到 O(lg n) 的结果

```
public static void PrintIndicesForValue(int[] numbers, int target) {
    if (numbers == null)
        return;

    int low = 0, high = numbers.length - 1;
    // get the start index of target number
    int startIndex = -1;
    while (low <= high) {
        int mid = (high - low) / 2 + low;
        if (numbers[mid] > target) {
            high = mid - 1;
        } else if (numbers[mid] == target) {
            startIndex = mid;
            high = mid - 1;
        } else
            low = mid + 1;
    }

    // get the end index of target number
    int endIndex = -1;
    low = 0;
    high = numbers.length - 1;
    while (low <= high) {
        int mid = (high - low) / 2 + low;
        if (numbers[mid] > target) {
            high = mid - 1;
        } else if (numbers[mid] == target) {
            endIndex = mid;
            low = mid + 1;
        } else
            low = mid + 1;
    }

    if (startIndex != -1 && endIndex != -1){
        for(int i=0; i+startIndex<=endIndex;i++){
            if(i>0)
                System.out.print(',');
            System.out.print(i+startIndex);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-11-02T14:52:19.413

好吧，如果您确实有一个排序数组，您可以进行二进制搜索，直到找到您要查找的索引之一，然后从那里，其余的应该很容易找到，因为它们都在每个旁边-其他。

一旦你找到了你的第一个实例，你就会找到它之前的所有实例，然后找到它之后的所有实例。

使用该方法，您应该大致得到**O(lg(n)+k)**，其中**k**是您正在搜索的值的出现次数。

编辑：

而且，不，您将永远无法在小于**O(k)**的时间 内访问所有**k值。**

 ****第二次编辑：**这样我就可以感觉到我实际上在贡献一些有用的东西：

除了搜索 X 的第一次和最后一次出现之外，您还可以对第一次出现进行二进制搜索，对最后一次出现进行二进制搜索。这将导致**O(lg(n))**总数。一旦你这样做了，你就会知道所有的索引之间也包含 X（假设它是排序的）

您可以通过搜索检查值是否等于**x**并检查左侧的值（或右侧**，**取决于您是在寻找第一次出现还是最后一次出现）是否等于**x**来做到这一点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-02T15:46:45.547

```
public void PrintIndicesForValue42(int[] sortedArrayOfInts) {
    int index_occurrence_of_42 = left = right = binarySearch(sortedArrayOfInts, 42);
    while (left - 1 >= 0) {
        if (sortedArrayOfInts[left-1] == 42)
            left--;
    }
    while (right + 1 < sortedArrayOfInts.length) {
        if (sortedArrayOfInts[right+1] == 42)
            right++;
    }
    System.out.println("Indices are from: " + left + " to " + right);
} 
```

这将在 O(log(n) + #occurrences) 中运行 阅读并理解代码。这很简单。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-12-07T05:20:00.790

我想出了使用二进制搜索的解决方案，唯一的事情是如果找到匹配项，则在两侧进行二进制搜索。

```
public static void main(String[] args) {
    int a[] ={1,2,2,5,5,6,8,9,10};
    System.out.println(2+" IS AVAILABLE  AT = "+findDuplicateOfN(a, 0, a.length-1, 2));
    System.out.println(5+" IS AVAILABLE  AT = "+findDuplicateOfN(a, 0, a.length-1, 5));
    int a1[] ={2,2,2,2,2,2,2,2,2};
    System.out.println(2+" IS AVAILABLE  AT = "+findDuplicateOfN(a1, 0, a1.length-1, 2));

    int a2[] ={1,2,3,4,5,6,7,8,9};
    System.out.println(10+" IS AVAILABLE  AT = "+findDuplicateOfN(a2, 0, a2.length-1, 10));
}

public static String findDuplicateOfN(int[] a, int l, int h, int x){
    if(l>h){
        return "";
    }
    int m = (h-l)/2+l;
    if(a[m] == x){
        String matchedIndexs = ""+m;
        matchedIndexs = matchedIndexs+findDuplicateOfN(a, l, m-1, x);
        matchedIndexs = matchedIndexs+findDuplicateOfN(a, m+1, h, x);
        return matchedIndexs;
    }else if(a[m]>x){
        return findDuplicateOfN(a, l, m-1, x);
    }else{
        return findDuplicateOfN(a, m+1, h, x);
    }
}

2 IS AVAILABLE  AT = 12 
5 IS AVAILABLE  AT = 43 
2 IS AVAILABLE  AT = 410236578 
10 IS AVAILABLE  AT = 
```

我认为这仍然提供了 O(logn) 复杂度的结果。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-02-06T00:44:47.010

```
Find_Key(int arr[], int size, int key){
int begin = 0;
int end = size - 1;
int mid = end / 2;
int res = INT_MIN;

while (begin != mid)
{
    if (arr[mid] < key)
        begin = mid;
    else
    {
        end = mid;
        if(arr[mid] == key)
            res = mid;
    }
    mid = (end + begin )/2;
}
return res;
} 
```

假设整数数组是升序排列的；返回键出现的第一个索引或 INT_MIN。在 O(lg n) 中运行。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-02T14:53:27.720

如果您不需要使用二进制搜索，Hashmap 可能会起作用。

创建一个 HashMap ，其中`Key`是值本身，然后 value 是一个索引数组，其中该值在数组中。循环遍历您的数组，为每个值更新 HashMap 中的每个数组。

每个值的索引查找时间约为 O(1)，创建地图本身的时间约为 O(n)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-11-02T18:54:56.657

下面是返回搜索键在给定排序数组中展开的范围的 java 代码：

```
public static int doBinarySearchRec(int[] array, int start, int end, int n) {
    if (start > end) {
        return -1;
    }
    int mid = start + (end - start) / 2;

    if (n == array[mid]) {
        return mid;
    } else if (n < array[mid]) {
        return doBinarySearchRec(array, start, mid - 1, n);
    } else {
        return doBinarySearchRec(array, mid + 1, end, n);
    }
}

/**
 * Given a sorted array with duplicates and a number, find the range in the
 * form of (startIndex, endIndex) of that number. For example,
 * 
 * find_range({0 2 3 3 3 10 10}, 3) should return (2,4). find_range({0 2 3 3
 * 3 10 10}, 6) should return (-1,-1). The array and the number of
 * duplicates can be large.
 * 
 */
public static int[] binarySearchArrayWithDup(int[] array, int n) {

    if (null == array) {
        return null;
    }
    int firstMatch = doBinarySearchRec(array, 0, array.length - 1, n);
    int[] resultArray = { -1, -1 };
    if (firstMatch == -1) {
        return resultArray;
    }
    int leftMost = firstMatch;
    int rightMost = firstMatch;

    for (int result = doBinarySearchRec(array, 0, leftMost - 1, n); result != -1;) {
        leftMost = result;
        result = doBinarySearchRec(array, 0, leftMost - 1, n);
    }

    for (int result = doBinarySearchRec(array, rightMost + 1, array.length - 1, n); result != -1;) {
        rightMost = result;
        result = doBinarySearchRec(array, rightMost + 1, array.length - 1, n);
    }

    resultArray[0] = leftMost;
    resultArray[1] = rightMost;

    return resultArray;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-10-26T08:52:54.663

log(n) 对最左边目标和最右边目标的二进制搜索的另一个结果。这是用 C++ 编写的，但我认为它非常易读。

这个想法是我们总是在`left = right + 1`. 因此，要找到最左边的目标，如果我们可以移动`right`到小于目标的最右边的数字，那么左边将是最左边的目标。

对于最左边的目标：

```
int binary_search(vector<int>& nums, int target){
    int n = nums.size();
    int left = 0, right = n - 1;

    // carry right to the greatest number which is less than target.
    while(left <= right){
        int mid = (left + right) / 2;
        if(nums[mid] < target)
            left = mid + 1;
        else
            right = mid - 1;
    }
    // when we are here, right is at the index of greatest number
    // which is less than target and since left is at the next, 
    // it is at the first target's index
    return left;
} 
```

对于最右边的目标，想法非常相似：

```
int binary_search(vector<int>& nums, int target){
    while(left <= right){
        int mid = (left + right) / 2;
        // carry left to the smallest number which is greater than target.
        if(nums[mid] <= target)
            left = mid + 1;
        else
            right = mid - 1;
    }
    // when we are here, left is at the index of smallest number
    // which is greater than target and since right is at the next, 
    // it is at the first target's index
    return right;
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-01-28T06:18:37.880

它正在使用修改后的二进制搜索。它将是 O(LogN)。空间复杂度为 O(1)。我们调用了 BinarySearchModified 两次。一个用于查找元素的开始索引，另一个用于查找元素的结束索引。

```
private static int BinarySearchModified(int[] input, double toSearch)
    {
        int start = 0;
        int end = input.Length - 1;

        while (start <= end)
        {
            int mid = start + (end - start)/2;
            if (toSearch < input[mid]) end = mid - 1;
            else start = mid + 1;
        }

        return start;
    }

    public static Result GetRange(int[] input, int toSearch)
    {
        if (input == null) return new Result(-1, -1);

        int low = BinarySearchModified(input, toSearch - 0.5);

        if ((low >= input.Length) || (input[low] != toSearch)) return new Result(-1, -1);

        int high = BinarySearchModified(input, toSearch + 0.5);

        return new Result(low, high - 1);
    } 

 public struct Result
    {
        public int LowIndex;
        public int HighIndex;

        public Result(int low, int high)
        {
            LowIndex = low;
            HighIndex = high;
        }
    } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-11-02T14:58:19.447

```
public void printCopies(int[] array)
{
    HashMap<Integer, Integer> memberMap = new HashMap<Integer, Integer>();
    for(int i = 0; i < array.size; i++)
       if(!memberMap.contains(array[i]))
           memberMap.put(array[i], 1);
       else
       {
           int temp = memberMap.get(array[i]); //get the number of occurances
           memberMap.put(array[i], ++temp); //increment his occurance
       }

    //check keys which occured more than once
    //dump them in a ArrayList
    //return this ArrayList
 } 
```

或者，您可以将它们的索引放在数组列表中，然后将其放在地图中而不是计数中，而不是计算出现次数。

```
 HashMap<Integer, ArrayList<Integer>> 
   //the integer is the value, the arraylist a list of their indices

public void printCopies(int[] array)
{
    HashMap<Integer, ArrayList<Integer>> memberMap = new HashMap<Integer, ArrayList<Integer>>();
    for(int i = 0; i < array.size; i++)
       if(!memberMap.contains(array[i]))
       {
           ArrayList temp = new ArrayList();
           temp.add(i);
           memberMap.put(array[i], temp);
       }
       else
       {
           ArrayList temp = memberMap.get(array[i]); //get the lsit of indices
           temp.add(i);
           memberMap.put(array[i], temp); //update the index list
       }

    //check keys which return lists with length > 1
    //handle the result any way you want
 } 
```

呵呵，我想这将不得不发布。

```
 int predefinedDuplicate = //value here;
 int index = Arrays.binarySearch(array, predefinedDuplicate);
 int leftIndex, rightIndex;
 //search left
 for(leftIndex = index; array[leftIndex] == array[index]; leftIndex--); //let it run thru it
 //leftIndex is now the first different element to the left of this duplicate number string
 for(rightIndex = index; array[rightIndex] == array[index]; rightIndex++); //let it run thru it

 //right index contains the first different element to the right of the string
 //you can arraycopy this [leftIndex+1, rightIndex-1] string or just print it
 for(int i = leftIndex+1; i<rightIndex; i++)
 System.out.println(array[i] + "\t"); 
```**

# css - Twitter 2.2轮播示例：如何保持图片比例？

> ID：13197553
> 
> 赞同：6
> 
> 时间：2012-11-02T14:48:57.947
> 
> 标签：css, twitter-bootstrap

如果您在访问[http://twitter.github.com/bootstrap/examples/carousel.html](http://twitter.github.com/bootstrap/examples/carousel.html)时减小窗口浏览器宽度，您可以看到背景图像纵横比发生了变化。我想保持它（1:1），在左边或右边裁剪我的图像，或者水平对齐它。

你有什么建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T03:23:31.713

您有**2 个**选项，并且都保持图像比例：

**选项1**

```
background: url(yourimage.jpg) no-repeat center center / cover; 
```

最后一部分是`background-size: cover`属性。它将根据浏览器宽度放大背景图像，以确保它填满**整个**div。

示例：http: [//i.imgur.com/0tQ9Rxm.png](http://i.imgur.com/0tQ9Rxm.png)

**选项 2**

```
background: url(yourimage.jpg) no-repeat center center; 
```

这是相同的效果，但没有放大部分。背景将保持其纵横比并居中，但如果您的浏览器宽度大于图像宽度（在本例中为 1500 像素），您将看到背景颜色（在本例中为白色）。

示例：http: [//i.imgur.com/6x594jH.png](http://i.imgur.com/6x594jH.png)

我推荐**选项 1**。如果您调整浏览器的大小，您只会看到缩放效果，但几乎没有人这样做，访问者只会看到填充的背景。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-23T19:09:43.883

作为@jgthms 回复的后续行动，我使用了选项 1。但是，在 iOS Safari 上，背景图像根本没有出现。单行 CSS 语法似乎不太好。通过将其更改为以下内容，我能够使其正常工作：

```
background: url(yourimage.jpg) no-repeat center center;
background-size: cover; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-22T06:19:01.030

对于那些像我一样没有看到 CSS 发挥作用的人来说，这里有一个上下文示例（使用 iOS 样式）。我应该注意到这是使用 Bootstrap 3.1.1。

```
 <div class="item active" style="background: url(slide1.jpg) no-repeat center center; background-size: cover;">
      <div class="container">
        <div class="carousel-caption">
          <p>Example text
            <a class="btn btn-lg btn-primary" href="YourURLHERE" role="button">YourLink</a>
          </p>
        </div>
      </div>
    </div> 
```

# web - 您是否建议在不同的网站中使用相同的点赞框？

> ID：13197556
> 
> 赞同：-1
> 
> 时间：2012-11-02T14:49:17.473
> 
> 标签：web, facebook-likebox

我有一个关于城市旅游的主要网站，在那个网站上我有类似的盒子插件。

现在我正在建立两个关于同一城市的餐厅和酒店的新网站。

您是否建议在不同的网站中使用相同的点赞框？

关于同一个城市的类似内容，想法是更快地获得更多喜欢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T14:54:48.423

如果您使用不同的网站，那么我建议您使用不同的类似框。我敢肯定，没有人会喜欢点击某件事，只是让它不是他们真正想要的。

# asp.net - 在经典 ASP 使用的 DLL 中使用 WCF 引用

> ID：13197559
> 
> 赞同：1
> 
> 时间：2012-11-02T14:49:30.313
> 
> 标签：asp.net, dll, asp-classic

我创建了一个 .NET DLL 库，它是 COM 可见的，供 Classic ASP 使用。我在库中引用了 WCF 服务，每当我尝试从经典 ASP 调用 DLL 时，都会收到以下错误：

`Could not find default endpoint element that references contract 'ContractName' in the ServiceModel client configuration section. This might be because no configuration file was found for your application, or because no endpoint element matching this contract could be found in the client element.`

现在，我将引用设置为内部访问级别。我注意到 VS 使用服务端点信息创建了一个 DLL.config 文件，因此我将配置文件放在该 DLL 的程序集文件夹中，但没有运气。

知道如何使用 WCF 端点引用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T19:05:22.223

解决了

我需要做的就是动态创建`BasicHTTPBinding`一个端点地址并提供一个端点地址。然后使用创建的绑定和端点地址创建一个新的 Web 服务实例。

# jquery - JAVASCRIPT/JQUERY 存储对象

> ID：13197561
> 
> 赞同：1
> 
> 时间：2012-11-02T14:49:33.313
> 
> 标签：jquery, variables, this, storage

故事：我需要将 JQuery('') 存储到一个数组中以供进一步工作。

我的半功能解决方案（无法正常工作）：

```
 var myArray = new Array();
    var $selected_place;

    function addPlace(){
        var new_place = jQuery('<div/>', {
            class: 'place'
        });

        new_place.click(function(){
             doSomething($(this));
        });

        myArray[myArray.length] = new_place;
    } 
```

问题：

```
function doSomething(link) {
    var number;
    for (var i = 0; i < myArray.length; i++){
        if (myArray[i] == link){
            number= i;
            break;
        } //end of if
    } //end of for
    alert(number);
} //end of function 
```

警报始终只返回“未定义”。

解决方案：

将 $(this) 替换为全局变量解决了我的问题，现在它可以正常工作了。$selected_place = new_place; 并在 doSomething 方法/函数中 if 语句 myArray[i] == $selected_place

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T14:52:23.760

这可能是因为 myArray 不包含 $selected_place 的值。您可能以错误的顺序调用您的函数。

虽然只是一个挑剔：

你可以`myArray.push(new_place)`用来完成`myArray[myArray.length] = new_place;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T14:50:59.523

selected_place 和/或 myArray 为空。将其作为参数传递给函数 doSomething()

# oracle - 使用触发器跟踪更改 - 备用字段名称

> ID：13197563
> 
> 赞同：0
> 
> 时间：2012-11-02T14:49:46.030
> 
> 标签：oracle, oracle11g

使用下面提到的触发器，我在审计或更改日志表中跟踪生产表中的更改。我的问题是跟踪表中的字段名称与table1中的字段名称不同。值相同，但列的名称不同。

那么问题来了，触发器中的语法必须如何更改才能获取一个字段名称的值并将其插入到跟踪表中另一个名称的字段中？

感谢您的任何和所有帮助或建议。

{

```
CREATE OR REPLACE TRIGGER track_change_trg
AFTER INSERT OR UPDATE OR DELETE
ON table1
FOR EACH ROW
BEGIN

IF INSERTING THEN
    INSERT INTO tracking table  VALUES 
    (:new.pname, :new.p_id, :new.p_type, :new.t1name,
    'INSERTED', SYSDATE);

ESLIF UPDATING THEN
    INSERT INTO tracking table  VALUES 
    (:new.pname, :new.p_id, :new.p_type, :new.t1name,
    'UPDATED', SYSDATE);

ELSIF DELETING THEN
    INSERT INTO tracking table VALUES 
    (:old.pname, :old.p_id, :old.p_type, :old.t1name,
    'DELETED', SYSDATE);

    END IF;
END;
/ 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T15:36:25.540

如果主表和审计表中的列名不同，则没有区别。我不确定您为什么认为这是一个问题 - 显示任何错误可能有助于澄清您的问题以及表定义。我可以立即看到抛出的唯一错误 - 假设其中的空格`tracking table`是转录错误 - 是如果列*顺序*不匹配并且您将错误的数据类型或大小放入列中。很难猜出你看到了什么。

您在通常会列出列名的语句中省略了可选[列部分。](http://docs.oracle.com/cd/E11882_01/server.112/e26088/statements_9014.htm#SQLRF55080)`insert`如果没有列名的显式列表，则将根据目标表中列的顺序分配值，如`user_tab_columns.column_id`或中所示`describe`。最好列出列以避免歧义。因此，如果表定义发生更改（例如，添加了列，因此您没有足够的值）或列顺序在另一个环境中不同（可以说在体面的源代码控制下不应该发生），您就不会遇到问题）。也更容易发现琐碎的错误。

无论如何，只需列出您要插入的表中的列名：

```
INSERT INTO tracking_table (x_name, x_id, x_type, x_t1name, x_action, x_when)
VALUES (:new.pname, :new.p_id, :new.p_type, :new.t1name, 'INSERTED', SYSDATE); 
```

...用`x_name`来自的实际列名替换等`tracking_table`。

# android - 从故障转储中提取变量

> ID：13197565
> 
> 赞同：2
> 
> 时间：2012-11-02T14:49:48.363
> 
> 标签：android, android-ndk, gdb, debug-symbols

当一些原生 Android 代码崩溃时，系统会生成堆栈转储并在崩溃点注册。如果我有一个崩溃库的副本，其中包含调试符号（即未剥离），我可以检索崩溃函数的局部变量的名称/值以及调用堆栈上的函数吗？

这些值都在堆栈中。堆栈结构的描述必须在调试信息中的某个位置，或者调试器如何在运行时对其进行解密。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-02T15:29:05.013

如果我正确理解了您的问题，那么您可以这样做。我有一个我给我写的便条，这里我只是把它的内容没有修改。

例如，假设您的 logcat 中有以下错误：

```
I/DEBUG ( 72): *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
I/DEBUG ( 72): Build fingerprint: 'generic/full_crespo/crespo:2.3.4/GRJ22/eng.yury.20120906.111243:eng/test-keys'
I/DEBUG ( 72): pid: 694, tid: 694 >>> app_process <<<
I/DEBUG ( 72): signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr deadd00d
I/DEBUG ( 72): r0 fffffe74 r1 deadd00d r2 00000026 r3 00000000
I/DEBUG ( 72): r4 acaab808 r5 aca91541 r6 00000000 r7 4214f8b8
I/DEBUG ( 72): r8 400290c8 r9 0000ce78 10 4214f8a0 fp 41908f70
I/DEBUG ( 72): ip acaab914 sp beac9b50 lr afd191d9 pc aca48b88 cpsr 20000030
I/DEBUG ( 72): d0 74726f6261204d69 d1 7461736e552f676e
I/DEBUG ( 72): d2 694c646569667367 d3 3b726f7272456b0a
I/DEBUG ( 72): d4 42151f7c42151f48 d5 421531b042151fb0
I/DEBUG ( 72): d6 42153218421531e4 d7 421532804215324c
I/DEBUG ( 72): d8 0000000000000000 d9 0000000000000000
I/DEBUG ( 72): d10 0000000000000000 d11 0000000000000000
I/DEBUG ( 72): d12 0000000000000000 d13 0000000000000000
I/DEBUG ( 72): d14 0000000000000000 d15 0000000000000000
I/DEBUG ( 72): d16 42194090000003e8 d17 0000000000000000
I/DEBUG ( 72): d18 0000000000000000 d19 0000000000000000
I/DEBUG ( 72): d20 0000000000000000 d21 0000000000000000
I/DEBUG ( 72): d22 0000000000000000 d23 0000000000000000
I/DEBUG ( 72): d24 0000000000000000 d25 0000000000000000
I/DEBUG ( 72): d26 0000000000000000 d27 0000000000000000
I/DEBUG ( 72): d28 0000000000000000 d29 0000000000000000
I/DEBUG ( 72): d30 0000000000000000 d31 0000000000000000
I/DEBUG ( 72): scr 60000000
I/DEBUG ( 72): 
I/DEBUG ( 72): #00 pc 00048b88 /system/lib/libdvm.so
I/DEBUG ( 72): #01 pc 000482b6 /system/lib/libdvm.so
I/DEBUG ( 72): #02 pc 00051886 /system/lib/libdvm.so
I/DEBUG ( 72): #03 pc 00019510 /system/lib/libdvm.so
I/DEBUG ( 72): #04 pc 0001e838 /system/lib/libdvm.so
I/DEBUG ( 72): #05 pc 0001d714 /system/lib/libdvm.so
I/DEBUG ( 72): #06 pc 0006297c /system/lib/libdvm.so
I/DEBUG ( 72): #07 pc 0006a85a /system/lib/libdvm.so
I/DEBUG ( 72): #08 pc 00019510 /system/lib/libdvm.so
I/DEBUG ( 72): #09 pc 0001e838 /system/lib/libdvm.so
I/DEBUG ( 72): #10 pc 0001d714 /system/lib/libdvm.so
I/DEBUG ( 72): #11 pc 00062714 /system/lib/libdvm.so
I/DEBUG ( 72): #12 pc 00062a04 /system/lib/libdvm.so
I/DEBUG ( 72): #13 pc 0006e13e /system/lib/libdvm.so
I/DEBUG ( 72): #14 pc 0006f3da /system/lib/libdvm.so
I/DEBUG ( 72): #15 pc 00017d7c /system/lib/libdvm.so
I/DEBUG ( 72): #16 pc 0001e838 /system/lib/libdvm.so
I/DEBUG ( 72): #17 pc 0001d714 /system/lib/libdvm.so
I/DEBUG ( 72): #18 pc 00062714 /system/lib/libdvm.so
I/DEBUG ( 72): #19 pc 00062a04 /system/lib/libdvm.so
I/DEBUG ( 72): #20 pc 0006e566 /system/lib/libdvm.so
I/DEBUG ( 72): #21 pc 000561ec /system/lib/libdvm.so
I/DEBUG ( 72): #22 pc 0004a564 /system/lib/libdvm.so
I/DEBUG ( 72): #23 pc 0004c5fa /system/lib/libdvm.so
I/DEBUG ( 72): #24 pc 00032f98 /system/lib/libandroid_runtime.so
I/DEBUG ( 72): #25 pc 000333d4 /system/lib/libandroid_runtime.so
I/DEBUG ( 72): #26 pc 0003358c /system/lib/libandroid_runtime.so
I/DEBUG ( 72): #27 pc 00008ce8 /system/bin/app_process
I/DEBUG ( 72): #28 pc 00014b52 /system/lib/libc.so
I/DEBUG ( 72): 
I/DEBUG ( 72): code around pc:
I/DEBUG ( 72): aca48b68 447a4479 f7c94c0b 2000ee20 ef18f7c9 
I/DEBUG ( 72): aca48b78 447c4809 6bdb5823 4798b103 22264902 
I/DEBUG ( 72): aca48b88 f7c9700a bf00ef80 deadd00d 00045bc7 
I/DEBUG ( 72): aca48b98 00047785 00062c8a fffffe74 4b09b40e 
I/DEBUG ( 72): aca48ba8 4c09b517 aa05447b f852591b 6b5b1b04 
I/DEBUG ( 72): 
I/DEBUG ( 72): code around lr:
I/DEBUG ( 72): afd191b8 4a0e4b0d e92d447b 589c41f0 26004680 
I/DEBUG ( 72): afd191c8 686768a5 f9b5e006 b113300c 47c04628 
I/DEBUG ( 72): afd191d8 35544306 37fff117 6824d5f5 d1ef2c00 
I/DEBUG ( 72): afd191e8 e8bd4630 bf0081f0 00028344 ffffff88 
I/DEBUG ( 72): afd191f8 b086b570 f602fb01 9004460c a804a901 
I/DEBUG ( 72): 
I/DEBUG ( 72): stack:
I/DEBUG ( 72): beac9b10 aca13280 /system/lib/libdvm.so
I/DEBUG ( 72): beac9b14 aca14970 /system/lib/libdvm.so
I/DEBUG ( 72): beac9b18 00000000 
I/DEBUG ( 72): beac9b1c beac9b68 
I/DEBUG ( 72): beac9b20 afd4270c 
I/DEBUG ( 72): beac9b24 afd426b8 
I/DEBUG ( 72): beac9b28 00000000 
I/DEBUG ( 72): beac9b2c afd191d9 /system/lib/libc.so
I/DEBUG ( 72): beac9b30 00062c8a 
I/DEBUG ( 72): beac9b34 aca91541 /system/lib/libdvm.so
I/DEBUG ( 72): beac9b38 00000000 
I/DEBUG ( 72): beac9b3c 4214f8b8 
I/DEBUG ( 72): beac9b40 400290c8 
I/DEBUG ( 72): beac9b44 afd182d1 /system/lib/libc.so
I/DEBUG ( 72): beac9b48 df002777 
I/DEBUG ( 72): beac9b4c e3a070ad 
I/DEBUG ( 72): #00 beac9b50 4324ad8f 
I/DEBUG ( 72): beac9b54 aca482bb /system/lib/libdvm.so
I/DEBUG ( 72): #01 beac9b58 4324ad8f 
I/DEBUG ( 72): beac9b5c 4324ad8f 
I/DEBUG ( 72): beac9b60 4219429c 
I/DEBUG ( 72): beac9b64 00000000 
I/DEBUG ( 72): beac9b68 00011f28 
I/DEBUG ( 72): beac9b6c aca5188b /system/lib/libdvm.so 
```

您可以使用一个名为 stack 的特殊实用程序（我不记得我在哪里下载了它）。所以这里是这个实用程序的内容）：

```
#!/usr/bin/python2.4 -E

import getopt
import os
import re
import string
import sys
import getpass
import urllib
import subprocess

def PrintUsage():
  print
  print "  usage: " + sys.argv[0] + " [options] [FILE]"
  print
  print "  --symbols-dir=path"
  print "       the path to a symbols dir, such as =/tmp/out/target/product/dream/symbols"
  print
  print "  --symbols-zip=path"
  print "       the path to a symbols zip file, such as =dream-symbols-12345.zip"
  print
  print "  --auto"
  print "       attempt to:"
  print "         1) automatically find the build number in the crash"
  print "         2) if it's an official build, download the symbols "
  print "            from the build server, and use them"
  print
  print "  FILE should contain a stack trace in it somewhere"
  print "       the tool will find that and re-print it with"
  print "       source files and line numbers.  If you don't"
  print "       pass FILE, or if file is -, it reads from"
  print "       stdin."
  print
  sys.exit(1)

def FindSymbolsDir():
  cmd = "CALLED_FROM_SETUP=true make -f build/core/envsetup.mk " \
      + "dumpvar-abs-TARGET_OUT_UNSTRIPPED"
  stream = os.popen(cmd)
  str = stream.read()
  stream.close()
  return str.strip()

# returns a list containing the function name and the file/lineno
def CallAddr2Line(lib, addr):
  uname = os.uname()[0]
  if uname == "Darwin":
    proc = os.uname()[-1]
    if proc == "i386":
      uname = "darwin-x86"
    else:
      uname = "darwin-ppc"
  if lib != "":
    #cmd = "./prebuilt/" + uname + "/toolchain-eabi-4.2.1/bin/arm-eabi-addr2line" \
    cmd = "arm-eabi-addr2line" \
        + " -f -e " + SYMBOLS_DIR + lib \
        + " 0x" + addr
    stream = os.popen(cmd)
    lines = stream.readlines()
    list = map(string.strip, lines)
  else:
    list = []
  if list != []:
    # Name like "move_forward_type<JavaVMOption>" causes troubles
    mangled_name = re.sub('<', '\<', list[0]);
    mangled_name = re.sub('>', '\>', mangled_name);
    #cmd = "./prebuilt/" + uname + "/toolchain-eabi-4.2.1/bin/arm-eabi-c++filt "\
    cmd = "arm-eabi-c++filt "\
          + mangled_name
    stream = os.popen(cmd)
    list[0] = stream.readline()
    stream.close()
    list = map(string.strip, list)
  else:
    list = [ "(unknown)", "(unknown)" ]
  return list

class SSOCookie(object):
  """
  creates a cookie file so we can download files from the build server
  """
  def __init__(self, cookiename=".sso.cookie", keep=False):
    self.sso_server = "login.corp.google.com"
    self.name = cookiename
    self.keeper = keep
    self.tmp_opts = ".curl.options"
    if not os.path.exists(self.name):
      user = os.environ['USER']
      print "\n%s, to access the symbols, please enter your LDAP " % user,
      password = getpass.getpass()
      params = urllib.urlencode({"u": user, "pw": password})
      fd = os.open(self.tmp_opts, os.O_RDWR | os.O_CREAT, 0600)
      os.write(fd, '-b "%s"\n' % self.name)
      os.write(fd, '-c "%s"\n' % self.name)
      os.write(fd, '-s"\n-L\n-d "%s"\n' % params)
      os.write(fd, 'url = "https://%s/login?ssoformat=CORP_SSO"\n' % 
               self.sso_server)
      # login to SSO
      response = os.popen("/usr/bin/curl -K %s" % self.tmp_opts)
      response.close()
      if os.path.exists(self.tmp_opts):
        os.remove(self.tmp_opts)
      if os.path.exists(self.name):
        os.chmod(self.name, 0600)
      else:
        print "Could not log in to SSO"
        sys.exit(1)
  def __del__(self):
      """clean up"""
      if not self.keeper:
        os.remove(self.name)

class NoBuildIDException(Exception):
  pass

def FindBuildFingerprint(lines):
  """
  Searches the given file (array of lines) for the build fingerprint information
  """
  fingerprint_regex = re.compile("^.*Build fingerprint:\s'(?P<fingerprint>.*)'")
  for line in lines:
    fingerprint_search = fingerprint_regex.match(line.strip())
    if fingerprint_search:
      return fingerprint_search.group('fingerprint')

  return None  # didn't find the fingerprint string, so return none

class SymbolDownloadException(Exception):
  pass

DEFAULT_SYMROOT = "/tmp/symbols"
def DownloadSymbols(fingerprint, cookie):
  """
  Attempts to download the symbols from the build server, extracts them,
  and returns the path.  Takes the fingerprint from the pasted stack trace
  and the SSOCookie
  """
  if fingerprint is None:
    return (None, None)
  symdir = "%s/%s" % (DEFAULT_SYMROOT, hash(fingerprint))
  if not os.path.exists(symdir):
    os.makedirs(symdir)
  # build server figures out the branch based on the CL
  params = {
              'op': "GET-SYMBOLS-LINK",
              'fingerprint': fingerprint,
           }
  url = urllib.urlopen("http://android-build/buildbot-update?",
                            urllib.urlencode(params)).readlines()[0]
  if url == "":
    raise SymbolDownloadException, "Build server down? Failed to find syms..."

  regex_str = (r'(?P<baseURL>http\:\/\/android-build\/builds\/.*\/[0-9]+' + 
           r'\/)(?P<img>.*)')
  url_regex = re.compile(regex_str)
  url_match = url_regex.match(url)
  if url_match is None:
    raise SymbolDownloadException, "Unexpected results from build server URL..."

  baseURL = url_match.group('baseURL')
  img =  url_match.group('img')
  symbolfile = img.replace("-img-", "-symbols-")
  symurl = baseURL + symbolfile
  localsyms = symdir + symbolfile

  if not os.path.exists(localsyms):
    print "downloading %s ..." % symurl
    curlcmd = ("""/usr/bin/curl -b %s -sL -w %%{http_code} -o %s %s""" % 
                          (cookie.name, localsyms, symurl))
    (fi,fo,fe) = os.popen3(curlcmd)
    fi.close()
    code = fo.read()
    err = fe.read()
    if err != "":
      raise SymbolDownloadException, "stderr from curl download: %s" % err
    if code != "200":
      raise SymbolDownloadException, "Faied to download %s" % symurl
  else:
    print "using existing cache for symbols"

  print "extracting %s..." % symbolfile
  saveddir = os.getcwd()
  os.chdir(symdir)
  unzipcode = subprocess.call(["unzip", "-qq", "-o", localsyms])
  if unzipcode > 0:
    raise SymbolDownloadException, ("failed to extract symbol files (%s)." 
                             % localsyms)
  os.chdir(saveddir)

  return (symdir, "%s/out/target/product/dream/symbols" % symdir)

def UnzipSymbols(symbolfile):
  """Unzips a file to DEFAULT_SYMROOT and returns the unzipped location.

  Args:
    symbolfile: The .zip file to unzip

  Returns:
    A tuple containing (the directory into which the zip file was unzipped,
    the path to the "symbols" directory in the unzipped file).  To clean
    up, the caller can delete the first element of the tuple.

  Raises:
    SymbolDownloadException: When the unzip fails.
  """
  symdir = "%s/%s" % (DEFAULT_SYMROOT, hash(symbolfile))
  if not os.path.exists(symdir):
    os.makedirs(symdir)

  print "extracting %s..." % symbolfile
  saveddir = os.getcwd()
  os.chdir(symdir)
  unzipcode = subprocess.call(["unzip", "-qq", "-o", symbolfile])
  if unzipcode > 0:
    raise SymbolDownloadException, ("failed to extract symbol files (%s)." 
                             % symbolfile)
  os.chdir(saveddir)

  return (symdir, "%s/out/target/product/dream/symbols" % symdir)

def PrintTraceLines(traceLines):
    maxlen = max(map(lambda tl: len(tl[1]), traceLines))
    print
    print "Stack Trace:"
    print "  ADDR      " + "FUNCTION".ljust(maxlen) + "  FILE:LINE"
    for tl in traceLines:
      print "  " + tl[0] + "  " + tl[1].ljust(maxlen) + "  " + tl[2]
    return

def PrintValueLines(valueLines):
    print
    print "Stack Data:"
    print "  ADDR      VALUE     " + "FILE:LINE/FUNCTION"
    for vl in valueLines:
      print "  " + vl[1] + "  " + vl[2] + "  " + vl[4]
      if vl[4] != "":
        print "                      " + vl[3]
    return

def ConvertTrace(lines):
  PROCESS_INFO_LINE = re.compile("(pid: [0-9]+, tid: [0-9]+.*)")
  SIGNAL_LINE = re.compile("(signal [0-9]+ \(.*\).*)")
  REGISTER_LINE = re.compile("(([ ]*[0-9a-z]{2} [0-9a-f]{8}){4})")
  TRACE_LINE = re.compile("(.*)\#([0-9]+)  (..) ([0-9a-f]{3})([0-9a-f]{5})  ([^\r\n \t]*)")
  VALUE_LINE = re.compile("(.*)([0-9a-f]{2})([0-9a-f]{6})  ([0-9a-f]{3})([0-9a-f]{5})  ([^\r\n \t]*)")
  THREAD_LINE = re.compile("(.*)(\-\-\- ){15}\-\-\-")

  traceLines = []
  valueLines = []

  for line in lines:
    header = PROCESS_INFO_LINE.search(line)
    if header:
      print header.group(1)
      continue
    header = SIGNAL_LINE.search(line)
    if header:
      print header.group(1)
      continue
    header = REGISTER_LINE.search(line)
    if header:
      print header.group(1)
      continue
    if TRACE_LINE.match(line):
      match = TRACE_LINE.match(line)
      groups = match.groups()
      if groups[5] == "<unknown>" or groups[5] == "[heap]" or groups[5] == "[stack]":
        traceLines.append((groups[3]+groups[4], groups[5], groups[5]))
      else:
        info = CallAddr2Line(groups[5], groups[4])
        traceLines.append((groups[3]+groups[4], info[0], info[1]))
    if VALUE_LINE.match(line):
      match = VALUE_LINE.match(line)
      groups = match.groups()
      if groups[5] == "<unknown>" or groups[5] == "[heap]" or groups[5] == "[stack]" or groups[5] == "":
        valueLines.append((groups[0], groups[1]+groups[2], groups[3]+groups[4], groups[5], ""))
      else:
        info = CallAddr2Line(groups[5], groups[4])
        valueLines.append((groups[0], groups[1]+groups[2], groups[3]+groups[4], info[0], info[1]))
    header = THREAD_LINE.search(line)
    if header:
      if len(traceLines) > 0:
        PrintTraceLines(traceLines)

      if len(valueLines) > 0:
        PrintValueLines(valueLines)
      traceLines = []
      valueLines = []
      print
      print "-----------------------------------------------------\n"

  if len(traceLines) > 0:
    PrintTraceLines(traceLines)

  if len(valueLines) > 0:
    PrintValueLines(valueLines)

SYMBOLS_DIR = FindSymbolsDir()

if __name__ == '__main__':
  try:
    options, arguments = getopt.getopt(sys.argv[1:], "",
                             ["auto", "symbols-dir=", "symbols-zip=", "help"])
  except getopt.GetoptError, error:
    PrintUsage()

  AUTO = False
  zipArg = None
  for option, value in options:
    if option == "--help":
      PrintUsage()
    elif option == "--symbols-dir":
      SYMBOLS_DIR = value
    elif option == "--symbols-zip":
      zipArg = value
    elif option == "--auto":
      AUTO = True

  if len(arguments) > 1:
    PrintUsage()

  if AUTO:
    cookie = SSOCookie(".symbols.cookie")

  if len(arguments) == 0 or arguments[0] == "-":
    print "Reading native crash info from stdin"
    f = sys.stdin
  else:
    print "Searching for native crashes in %s" % arguments[0]
    f = open(arguments[0], "r")

  lines = f.readlines()
  rootdir = None
  if AUTO:
    fingerprint = FindBuildFingerprint(lines)
    print "fingerprint:", fingerprint
    rootdir, SYMBOLS_DIR = DownloadSymbols(fingerprint, cookie)
  elif zipArg is not None:
    rootdir, SYMBOLS_DIR = UnzipSymbols(zipArg)

  print "Reading symbols from", SYMBOLS_DIR
  lines = ConvertTrace(lines)

  if rootdir is not None:
    # be a good citizen and clean up...os.rmdir and os.removedirs() don't work
    cmd = "rm -rf \"%s\"" % rootdir
    print "\ncleaning up (%s)" % cmd
    os.system(cmd)

  # vi: ts=2 sw=2 
```

您可以通过以下方式使用该实用程序：

```
python stack.py [options] [FILE] 
```

选项：

*   `--symbols-dir=path` 符号目录的路径，例如 =/tmp/out/target/product/dream/symbols
*   `--symbols-zip=path`符号 zip 文件的路径，例如 =dream-symbols-12345.zip"
*   `--auto`尝试：

    ```
     1) automatically find the build number in the crash

       2) if it's an official build, download the symbols from the build server, and use them 
    ```

*   `FILE`

    应该在其中包含一个堆栈跟踪，该工具会在某个地方找到它并使用源文件和行号重新打印它。如果你不传递 FILE，或者如果文件是 -，它从标准输入读取。

**例子：**

```
python stack.py --symbols-dir=/home/yury/PROJECTS/MOSES/source_code/MOSES/out/target/product/crespo/symbols error.txt 
```

之后，您将看到以下输出：

```
yury@yury-laptop:~/PROJECTS/MOSES/source_code/MOSES$ python stack.py --symbols-dir=/home/yury/PROJECTS/MOSES/source_code/MOSES/out/target/product/crespo/symbols error.txt
build/core/envsetup.mk:11: /version_defaults.mk: No such file or directory
build/core/envsetup.mk:41: /product_config.mk: No such file or directory
make: *** No rule to make target `/product_config.mk'.  Stop.
Searching for native crashes in error.txt
Reading symbols from /home/yury/PROJECTS/MOSES/source_code/MOSES/out/target/product/crespo/symbols
pid: 694, tid: 694  >>> app_process <<<
signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr deadd00d
  r0 fffffe74  r1 deadd00d  r2 00000026  r3 00000000
  r4 acaab808  r5 aca91541  r6 00000000  r7 4214f8b8
  r8 400290c8  r9 0000ce78  10 4214f8a0  fp 41908f70
  ip acaab914  sp beac9b50  lr afd191d9  pc aca48b88

Stack Trace:
  ADDR      FUNCTION                                                FILE:LINE
  00048b88  dvmAbort                                                /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/Init.c:1738
  000482b6  dvmThrowChainedException                                /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/Exception.c:230
  00051886  dvmThrowException                                       /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/Exception.h:35
  00019510  dalvik_mterp                                            /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/mterp/out/InterpAsm-armv7-a-neon.S:13163
  0001e838  dvmMterpStd                                             /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/mterp/Mterp.c:105
  0001d714  dvmInterpret                                            /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/interp/Interp.c:1369
  0006297c  dvmInvokeMethod                                         /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/interp/Stack.c:1000
  0006a85a  Dalvik_java_lang_reflect_Method_invokeNative            /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/native/java_lang_reflect_Method.c:101
  00019510  dalvik_mterp                                            /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/mterp/out/InterpAsm-armv7-a-neon.S:13163
  0001e838  dvmMterpStd                                             /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/mterp/Mterp.c:105
  0001d714  dvmInterpret                                            /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/interp/Interp.c:1369
  00062714  dvmCallMethodV                                          /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/interp/Stack.c:623
  00062a04  dvmCallMethod                                           /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/interp/Stack.c:461
  0006e13e  dvmInitClass                                            /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/oo/Class.c:4480
  0006f3da  dvmResolveStaticField                                   /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/oo/Resolve.c:493
  00017d7c  cmp_long_taint_prop                                     /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/mterp/out/InterpAsm-armv7-a-neon.S:10110
  0001e838  dvmMterpStd                                             /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/mterp/Mterp.c:105
  0001d714  dvmInterpret                                            /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/interp/Interp.c:1369
  00062714  dvmCallMethodV                                          /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/interp/Stack.c:623
  00062a04  dvmCallMethod                                           /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/interp/Stack.c:461
  0006e566  dvmGetSystemClassLoader                                 /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/oo/Class.c:4665
  000561ec  dvmPrepMainThread                                       /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/Thread.c:878
  0004a564  dvmStartup                                              /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/Init.c:1301
  0004c5fa  JNI_CreateJavaVM                                        /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/Jni.c:4503
  00032f98  android::AndroidRuntime::startVm(_JavaVM**, _JNIEnv**)  /home/yury/PROJECTS/MOSES/source_code/MOSES/frameworks/base/core/jni/AndroidRuntime.cpp:866
  000333d4  android::AndroidRuntime::start(char const*, bool)       /home/yury/PROJECTS/MOSES/source_code/MOSES/frameworks/base/core/jni/AndroidRuntime.cpp:919
  0003358c  android::AndroidRuntime::start()                        /home/yury/PROJECTS/MOSES/source_code/MOSES/frameworks/base/core/jni/AndroidRuntime.cpp:996
  00008ce8  main                                                    /home/yury/PROJECTS/MOSES/source_code/MOSES/frameworks/base/cmds/app_process/app_main.cpp:171
  00014b52  __libc_init                                             /home/yury/PROJECTS/MOSES/source_code/MOSES/bionic/libc/bionic/libc_init_dynamic.c:114

Stack Data:
  ADDR      VALUE     FILE:LINE/FUNCTION
  beac9b10  aca13280  /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/mterp/out/InterpAsm-armv7-a-neon.S:451
                      dvmAsmInstructionStart
  beac9b14  aca14970  /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/mterp/out/InterpAsm-armv7-a-neon.S:2994
                      dalvik_inst
  beac9b18  00000000  
  beac9b1c  beac9b68  
  beac9b20  afd4270c  
  beac9b24  afd426b8  
  beac9b28  00000000  
  beac9b2c  afd191d9  /home/yury/PROJECTS/MOSES/source_code/MOSES/bionic/libc/stdio/fwalk.c:50
                      _fwalk
  beac9b30  00062c8a  
  beac9b34  aca91541  ??:0
                      ??
  beac9b38  00000000  
  beac9b3c  4214f8b8  
  beac9b40  400290c8  
  beac9b44  afd182d1  /home/yury/PROJECTS/MOSES/source_code/MOSES/bionic/libc/stdio/fflush.c:44
                      fflush
  beac9b48  df002777  
  beac9b4c  e3a070ad  
  beac9b50  4324ad8f  
  beac9b54  aca482bb  /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/Exception.c:234
                      dvmThrowChainedException
  beac9b58  4324ad8f  
  beac9b5c  4324ad8f  
  beac9b60  4219429c  
  beac9b64  00000000  
  beac9b68  00011f28  
  beac9b6c  aca5188b  /home/yury/PROJECTS/MOSES/source_code/MOSES/dalvik/vm/Native.c:128
                      dvmResolveNativeMethod 
```

# xcode4.5 - 使用 Xcode 4.5.1 时出现不支持的架构 armv7s 错误

> ID：13197567
> 
> 赞同：0
> 
> 时间：2012-11-02T14:49:51.623
> 
> 标签：xcode4.5, ios-frameworks

我在 9 月下旬更新了我的应用程序以支持 iOS 6。我能够毫无问题地存档并上传到商店。现在，我无法验证我的存档文件，而是收到错误消息：iPad/iPod Touch：应用程序包含不受支持的架构：armv7s (-19031)。我没有更改任何代码，也没有更改项目中使用的任何框架。具体来说，我使用以下框架：SystemConfiguration、Foundation、UIKit、CoreGraphics 和 AVFoundation。我在 StackOverflow 上的其他帖子中看到的建议是删除 armv7s 支持，直到所有框架都更新为包含 armv7s 支持。但是，我无法想象这些通用框架不支持新架构。自上次更新以来我所做的两项更改是：1) 升级到 OS X 10.7.5 和 2) 升级到 Xcode 4.5.1。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T14:59:33.567

看起来这是 Xcode 4.5.1 的问题。升级到 Xcode 4.5.2 后，错误消失了，我能够成功上传。

# django - Django 包含基于上下文的模板

> ID：13197569
> 
> 赞同：0
> 
> 时间：2012-11-02T14:49:55.593
> 
> 标签：django, django-templates, django-template-filters

我想知道是否有办法在 Django 模板的 include 语句中包含变量。例如，如果您对一组对象有一个 for 循环，并且您只想加载与这些对象相关的模板（示例如下）。

```
{% for app in apps %}
<div class="modal fade hidden" id="myModal_{{ app.id }}">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">Add {{ app.title }}</h3>
  </div>
  <div class="modal-body">
    <form class="bs-docs-example form-horizontal">

      {% include "app_templates/{{ app.title }}/modal-config.html" %}

    </form>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    <button class="add-app-btn btn btn-primary" data-appid="{{ app.id }}">Add</button>
  </div>
</div>
{% endfor %} 
```

或者有没有更好的方法来做到这一点。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T14:57:03.117

你可以这样做：

```
{% with template_name="app_templates/"|add:app.title|add:"/modal-config.html" %}
    {% include template_name %}
{% endwith %} 
```

我不确定这是否可行：

```
{% include "app_templates/"|add:app.title|add:"/modal-config.html" %}. 
```

但在那种情况下，我宁愿制作一个模板标签或过滤器来封装这个逻辑远离模板。

# android - 将一个 Android 项目链接到另一个

> ID：13197570
> 
> 赞同：2
> 
> 时间：2012-11-02T14:49:56.417
> 
> 标签：android, android-library

我将一个项目转换为库项目并将其链接到另一个项目，但出现这些错误（SearchFacebook 是库项目）：

```
[2012-11-02 16:29:10 - FacebookFollower] G:\AndroidProjects\FacebookUpdaterFollower\SearchFacebook\res\layout\test_results_auto_complete.xml:2: error: No resource identifier found for attribute 'categories' in package 'shira.android.facebook.updaterfollower.search'
[2012-11-02 16:29:10 - FacebookFollower] G:\AndroidProjects\FacebookUpdaterFollower\SearchFacebook\res\layout\test_results_auto_complete.xml:2: error: No resource identifier found for attribute 'max_results' in package 'shira.android.facebook.updaterfollower.search' 
```

我检查了 R 文件和资源标识符，当链接项目编译为独立项目（而不是库）时，我没有收到这些错误。

顺便说一句，我可以链接一个 Android 项目而不将其转换为库吗？

**更新：**正如建议的那样，我更改了使用它们的自定义属性的命名空间。我在项目中使用该库的布局文件现在看起来像这样（相关部分）：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent" android:layout_height="match_parent" android:padding="5dp"
xmlns:search="http://schemas.android.com/apk/res-auto">

<shira.android.facebook.updaterfollower.search.FacebookResultsAutoComplete 
    android:id="@+id/followed_type_auto_complete" android:layout_width="match_parent" 
    android:layout_height="wrap_content" android:layout_alignParentLeft="true" 
    android:layout_alignParentTop="true" android:hint="@string/followed_type" 
    search:max_results="15"/> 
```

但是，我仍然遇到与以前相同的错误，并且我将 Android 工具更新到了最新版本，那么可能出了什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T20:07:03.667

您可能会遇到由库项目中的自定义属性引起的已知错误。

[http://code.google.com/p/android/issues/detail?id=9656](http://code.google.com/p/android/issues/detail?id=9656)

幸运的是，r17 android 工具引入了一个修复程序。[关于这个问题的评论 71](http://code.google.com/p/android/issues/detail?id=9656#c71)应该为您指出一个可行的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-11T08:17:47.467

导航到库项目 gen 并删除它的全部内容。对主项目执行相同的操作。从 Eclipse 选项菜单中选择项目 -> 清理。完成后选择构建并查看是否发生错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T17:50:30.420

也许使用该方法的类，需要导入该包

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-11T08:51:47.530

尝试将项目导出为 jar，然后在另一个项目中将其作为 jar 文件使用。希望这可以帮助..

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-08T12:27:10.373

需要有关您的实施的更多信息。您可以在此处提供代码片段（`not complete`）来支持您的问题。

1.  提供您正在使用的两个包（main、lib）。（`need not to be original`）。（**必须是唯一**的）
2.  确保您没有在库项目和主项目中重复相同的资源 ID。（如果选择不同）
3.  检查您的导入包查询`R`文件。（**这很重要**）正确的 R 文件在哪里导入。

当我使用库项目时，该`R`文件经常以**android.R**的形式导入，很长一段时间后我通过导入它的相关 R 文件来解决。

希望这会帮助你。

# ios - 如何使用 AFImageRequestOperation 从 Web 服务器 API 检索图像？

> ID：13197571
> 
> 赞同：0
> 
> 时间：2012-11-02T14:49:58.503
> 
> 标签：ios, xcode, api, uiimage, afnetworking

我是 AFNetworking 的新手，我很难从服务器中检索图像数据。我想显示存储在 Web 服务器 API 中的图像。这是我的 URLRequest 回来的：

```
 {
o_id: "2",
g_id: "1",
title: "Here's a new objective",
description: "This is the description",
hint: "",
target: "10",
timestamp: "2012-09-19 17:24:59",
filename: "http://uploadedimageurl.co.uk/view/uploads/obj_2_1351788537.jpg",
image_width: "600",
active: "1",
group_name: "Test Group",
n_insights: "15",
n_comments: "0",
unixtimestamp: 1348071899,
} 
```

我想检索*文件名中的图像：*我只是对我将如何做这件事画个空白。我已经尝试过使用*AFImageRequestOperation*但我不确定我是否走在正确的轨道上 - 我将展示我到目前为止所拥有的......

```
NSURL *url = [NSURL URLWithString:[NSString stringWithFormat:@"%@/api/groups/get/1",URL_ROOT]];
    AFHTTPClient *httpClient = [[AFHTTPClient alloc] initWithBaseURL:url];
    NSURLRequest *request = [httpClient requestWithMethod:@"GET" path:nil parameters:nil];
 AFImageRequestOperation *imageOperation = [AFImageRequestOperation imageRequestOperationWithRequest:request imageProcessingBlock:nil success:^(NSURLRequest *request, NSHTTPURLResponse *response, UIImage *image)
    {

    } failure:nil];

    [imageOperation start]; 
```

只是想看看我是否朝着检索此图像数据的正确方向前进，但也想知道如何检索存储在*文件名中的图像：*有什么想法吗？在此先感谢伙计们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T16:57:19.653

您将需要发送 2 个请求：

1.  AFJSON请求操作
2.  AFImageRequestOperation

在第一个请求操作的成功块中，您检索图像 url：

```
NSString* filename = [JSON valueForKey:@"filename"];
NSURL* imageURL = [NSURL URLWithString:filename]; 
```

然后使用该 URL 发送第二个请求（仅当它不为零时）。如果 AFImageRequestOperation，您会在成功块中收到 UIImage。

# regex - 排除特定起始字符串的正则表达式

> ID：13197573
> 
> 赞同：0
> 
> 时间：2012-11-02T14:50:04.717
> 
> 标签：regex

我有一个正则表达式字符串（见下文）。我想要的是它选择所有适当的模式，但不包括以 MZ 开头的模式

图案 -`^[A-Z]{2}\d{7}[A-Z]?[A-Z]?$`

我已经阅读了一些关于前瞻性断言的帖子，但我担心它们太复杂了，我无法理解。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T14:53:46.963

跟着图案走

```
^(?!MZ)[A-Z]{2}\d{7}[A-Z]?[A-Z]?$ 
```

where`(?!...)`是一个[否定的lookahead](http://www.regular-expressions.info/lookaround.html)，它确保它`MZ`不在字符串的开头。

# python - openpyxl - 调整列宽大小

> ID：13197574
> 
> 赞同：113
> 
> 时间：2012-11-02T14:50:05.047
> 
> 标签：python, openpyxl

我有以下脚本将 CSV 文件转换为 XLSX 文件，但我的列大小非常窄。每次我必须用鼠标拖动它们来读取数据。有人知道如何设置列宽`openpyxl`吗？

这是我正在使用的代码。

```
#!/usr/bin/python2.6
import csv
from openpyxl import Workbook
from openpyxl.cell import get_column_letter

f = open('users_info_cvs.txt', "rU")

csv.register_dialect('colons', delimiter=':')

reader = csv.reader(f, dialect='colons')

wb = Workbook()
dest_filename = r"account_info.xlsx"

ws = wb.worksheets[0]
ws.title = "Users Account Information"

for row_index, row in enumerate(reader):
    for column_index, cell in enumerate(row):
        column_letter = get_column_letter((column_index + 1))
        ws.cell('%s%s'%(column_letter, (row_index + 1))).value = cell

wb.save(filename = dest_filename) 
```

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2013-01-22T02:20:42.643

您可以估计（或使用单宽字体）来实现这一点。假设 data 是一个嵌套数组，例如

```
[['a1','a2'],['b1','b2']] 
```

我们可以获得每列中的最大字符数。然后将宽度设置为该值。宽度正是等宽字体的宽度（如果至少不改变其他样式）。即使您使用可变宽度字体，这也是一个不错的估计。这不适用于公式。

```
from openpyxl.utils import get_column_letter

column_widths = []
for row in data:
    for i, cell in enumerate(row):
        if len(column_widths) > i:
            if len(cell) > column_widths[i]:
                column_widths[i] = len(cell)
        else:
            column_widths += [len(cell)]

for i, column_width in enumerate(column_widths,1):  # ,1 to start at 1
    worksheet.column_dimensions[get_column_letter(i)].width = column_width 
```

有点小技巧，但您的报告将更具可读性。

* * *

## 回答 #2

> 赞同：72
> 
> 时间：2016-03-04T07:33:00.180

我对 Bufke 回答的变体。避免与数组进行一些分支并忽略空单元格/列。

现在修复了非字符串单元格值。

```
ws = your current worksheet
dims = {}
for row in ws.rows:
    for cell in row:
        if cell.value:
            dims[cell.column] = max((dims.get(cell.column, 0), len(str(cell.value))))    
for col, value in dims.items():
    ws.column_dimensions[col].width = value 
```

从 openpyxl 版本 3.0.3 开始，您需要使用

```
 dims[cell.column_letter] = max((dims.get(cell.column_letter, 0), len(str(cell.value)))) 
```

`column_dimensions`如果您传递数字而不是列字母，openpyxl 库将引发 TypeError ，因此其他所有内容都可以保持不变。

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2016-12-02T15:03:24.787

设置至少在 openpyxl 版本 2.4.0 中有效的所有列的宽度的更 Pythonic 方式：

```
for column_cells in worksheet.columns:
    length = max(len(as_text(cell.value)) for cell in column_cells)
    worksheet.column_dimensions[column_cells[0].column].width = length 
```

as_text 函数应该将值转换为适当长度的字符串，例如 Python 3：

```
def as_text(value):
    if value is None:
        return ""
    return str(value) 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2020-03-22T16:12:21.583

使用 openpyxl 3.0.3 修改列的最佳方法是使用[DimensionHolder](https://openpyxl.readthedocs.io/en/stable/api/openpyxl.worksheet.dimensions.html)对象，这是一个将每列映射到[ColumnDimension](https://openpyxl.readthedocs.io/en/stable/api/openpyxl.worksheet.dimensions.html)对象的字典。ColumnDimension 可以获取参数为[bestFit](https://openpyxl.readthedocs.io/en/stable/api/openpyxl.worksheet.dimensions.html#openpyxl.worksheet.dimensions.ColumnDimension.bestFit)、[auto_size](https://openpyxl.readthedocs.io/en/stable/api/openpyxl.worksheet.dimensions.html#openpyxl.worksheet.dimensions.ColumnDimension.auto_size)（它是 bestFit 的别名）和[width](https://openpyxl.readthedocs.io/en/stable/api/openpyxl.worksheet.dimensions.html#openpyxl.worksheet.dimensions.ColumnDimension.width)。就个人而言， auto_size 没有按预期工作，我不得不使用 width 并发现列的最佳宽度是`len(cell_value) * 1.23`.

要获取每个单元格的值，必须遍历每个单元格，但我个人没有使用它，因为在我的项目中我只需要编写工作表，所以我直接在我的数据上获得了每列中最长的字符串。

下面的示例仅显示如何修改列尺寸：

```
import openpyxl
from openpyxl.worksheet.dimensions import ColumnDimension, DimensionHolder
from openpyxl.utils import get_column_letter

wb = openpyxl.load_workbook("Example.xslx")
ws = wb["Sheet1"]

dim_holder = DimensionHolder(worksheet=ws)

for col in range(ws.min_column, ws.max_column + 1):
    dim_holder[get_column_letter(col)] = ColumnDimension(ws, min=col, max=col, width=20)

ws.column_dimensions = dim_holder 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2017-04-24T23:26:57.497

我遇到了 merge_cells 的问题，并且 autosize 不能正常工作，如果你有同样的问题，你可以用下面的代码解决：

```
for col in worksheet.columns:
    max_length = 0
    column = col[0].column # Get the column name
    for cell in col:
        if cell.coordinate in worksheet.merged_cells: # not check merge_cells
            continue
        try: # Necessary to avoid error on empty cells
            if len(str(cell.value)) > max_length:
                max_length = len(cell.value)
        except:
            pass
    adjusted_width = (max_length + 2) * 1.2
    worksheet.column_dimensions[column].width = adjusted_width 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2016-10-17T12:50:10.887

对上述接受的答案略有改进，我认为这更像是pythonic（请求宽恕比请求许可更好）

```
column_widths = []
for row in workSheet.iter_rows():
    for i, cell in enumerate(row):
        try:
            column_widths[i] = max(column_widths[i], len(str(cell.value)))
        except IndexError:
            column_widths.append(len(str(cell.value)))

for i, column_width in enumerate(column_widths):
    workSheet.column_dimensions[get_column_letter(i + 1)].width = column_width 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2019-06-20T06:31:49.710

我们可以将数字转换为它们的 ASCII 值并将其提供给 column_dimension 参数

```
import openpyxl as xl

work_book = xl.load_workbook('file_location')
sheet = work_book['Sheet1']
column_number = 2
column = str(chr(64 + column_number))
sheet.column_dimensions[column].width = 20
work_book.save('file_location') 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2019-05-15T02:48:33.663

这是我引用@Virako 的代码片段的版本

```
def adjust_column_width_from_col(ws, min_row, min_col, max_col):

        column_widths = []

        for i, col in \
                enumerate(
                    ws.iter_cols(min_col=min_col, max_col=max_col, min_row=min_row)
                ):

            for cell in col:
                value = cell.value
                if value is not None:

                    if isinstance(value, str) is False:
                        value = str(value)

                    try:
                        column_widths[i] = max(column_widths[i], len(value))
                    except IndexError:
                        column_widths.append(len(value))

        for i, width in enumerate(column_widths):

            col_name = get_column_letter(min_col + i)
            value = column_widths[i] + 2
            ws.column_dimensions[col_name].width = value 
```

使用方法如下，

```
adjust_column_width_from_col(ws, 1,1, ws.max_column) 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2019-05-29T04:29:34.000

以上所有答案都产生了一个问题，即 col[0].column 正在返回数字，而 worksheet.column_dimensions[column] 仅接受诸如“A”、“B”、“C”之类的字符来代替列。我已经修改了@Virako 的代码，现在运行良好。

```
import re
import openpyxl
..
for col in _ws.columns:
    max_lenght = 0
    print(col[0])
    col_name = re.findall('\w\d', str(col[0]))
    col_name = col_name[0]
    col_name = re.findall('\w', str(col_name))[0]
    print(col_name)
    for cell in col:
        try:
            if len(str(cell.value)) > max_lenght:
                max_lenght = len(cell.value)
        except:
            pass
    adjusted_width = (max_lenght+2)
    _ws.column_dimensions[col_name].width = adjusted_width 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2019-08-24T00:44:25.840

当 openpxyl 更新时，我不得不更改上面的 @User3759685 答案。我遇到了一个错误。好吧，@phihag 也在评论中报告了这一点

```
for column_cells in ws.columns:
    new_column_length = max(len(as_text(cell.value)) for cell in column_cells)
    new_column_letter = (openpyxl.utils.get_column_letter(column_cells[0].column))
    if new_column_length > 0:
        ws.column_dimensions[new_column_letter].width = new_column_length + 1 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-11-11T09:38:58.657

从 openpyxl2.5.2a 更新到最新的 2.6.4（python 2.x 支持的最终版本）后，我在配置列的宽度时遇到了同样的问题。

基本上我总是计算一列的宽度（dims 是一个保持每个列宽的字典）：

```
dims[cell.column] = max((dims.get(cell.column, 0), len(str(cell.value)))) 
```

之后我将比例修改为比原始大小稍大的东西，但现在你必须给列的“字母”值，而不是一个 int 值（下面的 col 是值，并被转换为正确的字母）：

```
worksheet.column_dimensions[get_column_letter(col)].width = value +1 
```

这将修复可见错误并为您的列分配正确的宽度；）希望有所帮助。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-10-22T16:39:15.713

这是一个肮脏的修复。但 openpyxl 实际上支持`auto_fit`. 但是没有方法可以访问该属性。

```
import openpyxl
from openpyxl.utils import get_column_letter

wb = openpyxl.load_workbook("Example.xslx")
ws = wb["Sheet1"]
for i in range(1, ws.max_column+1):
    ws.column_dimensions[get_column_letter(i)].bestFit = True
    ws.column_dimensions[get_column_letter(i)].auto_size = True 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2021-07-07T17:01:01.807

编译和应用上面的多个建议，并将合并单元格检测扩展到仅水平合并的单元格，我可以提供以下代码：

```
def adjust_width(ws):
    """
    Adjust width of the columns
    @param ws: worksheet
    @return: None
    """

    def is_merged_horizontally(cell):
        """
        Checks if cell is merged horizontally with an another cell
        @param cell: cell to check
        @return: True if cell is merged horizontally with an another cell, else False
        """
        cell_coor = cell.coordinate
        if cell_coor not in ws.merged_cells:
            return False
        for rng in ws.merged_cells.ranges:
            if cell_coor in rng and len(list(rng.cols)) > 1:
                return True
        return False

    for col_number, col in enumerate(ws.columns, start=1):
        col_letter = get_column_letter(col_number)

        max_length = max(
            len(str(cell.value or "")) for cell in col if not is_merged_horizontally(cell)
        )
        adjusted_width = (max_length + 2) * 0.95
        ws.column_dimensions[col_letter].width = adjusted_width 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2022-02-04T12:56:47.780

另一种不存储任何状态的方法可能是这样的：

```
from itertools import chain
# Using `ws` as the Worksheet
for cell in chain.from_iterable(ws.iter_cols()):
    if cell.value:
        ws.column_dimensions[cell.column_letter].width = max(
            ws.column_dimensions[cell.column_letter].width,
            len(f"{cell.value}"),
        ) 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-06-24T15:40:34.207

当我遇到这个问题时，我只是用 openpyxl 完成了我想做的所有事情，保存了工作簿，然后用 pywin32 再次打开它。Pywin32 内置了自动调整功能，无需制定一堆规则/条件。

编辑：我应该注意 pywin32 仅适用于 Windows。

```
from win32com.client import Dispatch

excel = Dispatch('Excel.Application')
wb = excel.Workbooks.Open("excelFile.xlsx")

excel.Worksheets(1).Activate()
excel.ActiveSheet.Columns.AutoFit()

wb.Save()
wb.Close()
excel.Quit() 
```

但是，我确实添加了一条规则，因为我有一个文本列，其中包含一些不需要显示的长值。我将任何列限制为 75 个字符。

```
excel = Dispatch('Excel.Application')
wb = excel.Workbooks.Open("excelFile.xlsx")

excel.Worksheets(1).Activate()
excel.ActiveSheet.Columns.AutoFit()

for col in excel.ActiveSheet.Columns:
    if col.ColumnWidth > 75:
        col.ColumnWidth = 75

wb.Save()
wb.Close()
excel.Quit() 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2020-11-27T13:31:45.490

由于在 openpyxl 2.6.1 中，设置宽度时需要列字母，而不是列号。

```
 for column in sheet.columns:
    length = max(len(str(cell.value)) for cell in column)
    length = length if length <= 16 else 16
    sheet.column_dimensions[column[0].column_letter].width = length 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2019-11-02T02:19:05.263

这是 Python 3.8 和 OpenPyXL 3.0.0 的答案。

我试图避免使用该`get_column_letter`功能但失败了。

此解决方案使用新引入的[赋值表达式](https://www.python.org/dev/peps/pep-0572/)，即“海象运算符”：

```
import openpyxl
from openpyxl.utils import get_column_letter

workbook = openpyxl.load_workbook("myxlfile.xlsx")

worksheet = workbook["Sheet1"]

MIN_WIDTH = 10
for i, column_cells in enumerate(worksheet.columns, start=1):
    width = (
        length
        if (length := max(len(str(cell_value) if (cell_value := cell.value) is not None else "")
                          for cell in column_cells)) >= MIN_WIDTH
        else MIN_WIDTH
    )
    worksheet.column_dimensions[get_column_letter(i)].width = width 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2021-05-26T17:22:41.430

我制作了一个对大型 Excel 文件非常快的函数，因为它使用 pandas.read_excel

```
import pandas as pd
from openpyxl import load_workbook
from openpyxl.utils import get_column_letter

def auto_adjust_column_width(file_path, sheet_name=0):
    column_widths = []

    df = pd.read_excel(file_path, sheet_name=sheet_name, header=None)
    for col in df.columns:
        max_length = int(df[col].astype(str).str.len().max() * 1.2)
        column_widths.append(max_length)

    wb = load_workbook(file_path)
    if isinstance(sheet_name, int):
        sheet_name = wb.sheetnames[sheet_name]

    worksheet = wb[sheet_name]
    for i, column_width in enumerate(column_widths):
        column = get_column_letter(i+1)
        worksheet.column_dimensions[column].width = column_width
    wb.save(file_path) 
```

# list - 在rpy2中按名称提取列表元素？

> ID：13197579
> 
> 赞同：0
> 
> 时间：2012-11-02T14:50:16.107
> 
> 标签：list, rpy2

阅读手册并搜索stackoverflow后，我无法找到按名称提取列表元素的方法。我最终得到的是以下提取p.value的方法。但最好是提取名称为“p.value”的元素，以便代码更具可读性。有人告诉我有办法这样做，但我找不到。有人可以告诉我怎么做吗？谢谢！

```
import rpy2.robjects as robjects
kstest=robjects.r['ks.test']

x=robjects.IntVector([1, 2, 3, 4, 5])
y=robjects.IntVector([11, 12, 13, 14, 15])

result=kstest(x, y)
print result[1][0] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T17:13:15.727

[rpy2 文档 -> 向量 -> 提取项目](http://rpy.sourceforge.net/rpy2/doc-2.3/html/vector.html#extracting-items)

# c# - 调用 System.Reflection.Assembly.Load 时，TFS 2010 单元测试在构建机器上失败

> ID：13197581
> 
> 赞同：0
> 
> 时间：2012-11-02T14:50:23.683
> 
> 标签：c#, .net, tfsbuild

使用 TFS 2010 和 2010：

在构建机器上开始构建时，单元测试失败是在尝试执行 System.Reflection.Assembly.Load 时出现 System.IO.FileNotFoundException。

如果我在本地运行这些测试，它们可以正常工作。此外，如果我远程进入构建机器并手动打开解决方案，单元测试将正常工作。

正在加载的程序集是包含在解决方案中的项目，并由单元测试项目引用。它用于本地化，这就是为什么我们要做一个 assembly.load。

构建服务使用的构建机器上是否存在导致此问题的临时位置？是否需要配置一些东西以便构建服务可以找到程序集？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T16:34:23.050

抱歉，误导性评论是您的单元测试失败，而不是您的构建

在尝试进行负载的测试中，您是否使用部署属性对其进行了标记，例如

```
[TestMethod]
[DeploymentItem("SomeLibrary.dll")]
public void TestSomeStuff()
{
} 
```

我遇到了同样的问题，因为我的测试在我的机器上运行良好，但是如果没有在我们的 buold 服务器上失败的属性，它们就没有被移动到所有测试对象所在的文件夹中。

# xquery - XML 标头创建

> ID：13197586
> 
> 赞同：1
> 
> 时间：2012-11-02T14:50:41.800
> 
> 标签：xquery, xmlspy

我有一些工作的 XQuery 脚本，我想用它们来生成有效的 XML 文档。因此，我还想包含一个 XML 标头：`<?xml version="1.0" encoding="UTF-8"?>`. 我知道此标头是可选的，但无论如何我都希望将其包含在内，尤其是要指定正确的编码。

但是，我不知道如何将此标头插入到输出中。我的编辑器 (XMLSpy) 抱怨我能想到的插入标题的任何变体。

根据我在这方面找到的少数资源，可能是我不应该手动生成此标头，而是让我的序列化程序为我执行此操作，可能通过使用`declare option`. 然而，当涉及到 XMLSpy 时，我找不到任何关于此的信息。

有没有办法手动插入这个标题？如果没有，我是否需要修改我的解释器以使其自动生成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T16:45:41.533

我认为声明选项是特定于实现的，因此您需要为您的 xQuery 处理器查找正确的选项。例如：

### 撒克逊人：

```
declare option saxon:output "omit-xml-declaration=no"; 
```

### 标记逻辑：

```
declare option xdmp:output "omit-xml-declaration=no"; 
```

但是，您应该能够通过将其添加到输出中来手动输出序言：

```
<?xml version="1.0" encoding="UTF-8" ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T16:37:25.807

假设您使用 AltovaXML 执行 xquery，您需要`omitXMLDeclaration`通过您使用的任何接口（命令行、java 或其他任何接口）设置为 false（默认值为 true）。似乎没有 xquery 级别的选项声明来设置它。[http://manual.altova.com/AltovaXML/altovaxmlcommunity/](http://manual.altova.com/AltovaXML/altovaxmlcommunity/)上的文档显示了如何针对各种情况执行此操作。

# javascript - Recorder.js 单数据点

> ID：13197601
> 
> 赞同：1
> 
> 时间：2012-11-02T14:51:10.863
> 
> 标签：javascript, flash

我正在使用[jwegener 的 recorder.js](https://github.com/jwagener/recorder.js/)进行录音。我很好奇是否可以在记录器运行时从 javascript 轮询闪存以获取音频的“帧”以构建波形。

在我想象的伪代码中：

```
function record() {
    Recorder.Record();

    setInterval(function(){
      Recorder.fetchCurrentAudioSnapshot();
    }, 50);
} 
```

理想情况下，这会给我一个可以用来绘制波形的数值。

感谢您提供的任何想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T18:00:21.590

我想到了。

我做的第一件事是将示例 javascript 放入一个对象中。这是我正在使用的记录功能：

```
record: function() {
        this.data = [];
        this.poll = '';

        Recorder.record({
            start: function () {
                alert("recording starts now. press stop when youre done. and then play or upload if you want.");
            },
            progress: function (milliseconds) {
                document.getElementById("time").innerHTML = Voiceover.timecode(milliseconds);
            }
        });

        this.waveform = new Waveform({
            container: document.getElementById("voiceover_waveform"),
            interpolate: false
        });
        var ctx = this.waveform.context;

        var gradient = ctx.createLinearGradient(0, 0, 0, this.waveform.height);
        gradient.addColorStop(0.0, "#f60");
        gradient.addColorStop(1.0, "#ff1b00");
        this.waveform.innerColor = gradient;

        var i=0;

        this.poll = setInterval(function() {
            Voiceover.data.push(Recorder.PollAudioBuffer());
            Voiceover.waveform.update({
                data: Voiceover.data
            });
        }, 70);
    }, 
```

这会初始化波形并设置 70ms 的间隔来轮询记录器以获取新数据点并将其绘制在波形上。

在`recorder.js`中，我添加了以下功能：

```
PollAudioBuffer: function() {
    try {
        var poll = this.flashInterface().pollAudioBuffer();

        console.log(poll);

        if(poll < 0.15) {
                            // Messing around with the math a bit to improve the effect. 
                            // The final result just has to be between 0 and 1.
            poll = Math.floor((Math.random()*1.5)+1)/10;
        }

        return poll;
    }
    catch(error) {
        console.log(error);
    }
}, 
```

现在到动作脚本。在`Recorder.as`中，我添加了我的`pollAudioBuffer()`函数，现在实际上有点名不副实。

```
protected function pollAudioBuffer():Number
    {
        return (microphone.activityLevel*2)/100;
    } 
```

要使函数正常工作，您需要在`addExternalInterfaceCallbacks()`in 中添加回调引用`Recorder.as`：

```
ExternalInterface.addCallback("pollAudioBuffer",this.pollAudioBuffer); 
```

这些更改使我能够即时创建波形。希望这对其他人有帮助。

# android - 在 Android 应用程序中访问文本字段时出错

> ID：13197602
> 
> 赞同：0
> 
> 时间：2012-11-02T14:51:12.123
> 
> 标签：android

我在下面的示例中将 EditText e1 的值设为空。所以它抛出空指针异常。我在 MainActivity 中写了下面的内容，并在单击按钮时调用函数 calculateSquare。我错过了什么吗？

```
public void calculateSquare(View view) {
    setContentView( R.layout.activity_main);
    EditText e1=(EditText) findViewById(R.id.editText1);
    int number = Integer.parseInt(e1.getText().toString());
    int square=number * number;
    TextView e2=(TextView) findViewById(R.id.textView2);
    e2.setText(square);
} 
```

activity_main.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >
<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:layout_centerHorizontal="true"
    android:layout_marginTop="25dp"
    android:text="@string/hello_world"
    tools:context=".MainActivity" />
<EditText
    android:id="@+id/editText1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_below="@+id/textView1"
    android:layout_marginLeft="32dp"
    android:layout_marginTop="52dp"
    android:layout_toLeftOf="@+id/textView1"
    android:ems="10"
    android:inputType="number" />
<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/editText1"
    android:layout_centerHorizontal="true"
    android:layout_marginTop="29dp"
    android:text="CalculateSquare" 
    android:onClick="calculateSquare"/>
<TextView
    android:id="@+id/textView2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_alignTop="@+id/editText1"
    android:layout_marginRight="36dp"
    android:text="Square"
    android:textAppearance="?android:attr/textAppearanceLarge" />
</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-02T15:00:12.360

您需要将字符串作为参数传递给 setText()。将您的代码更改为：

```
e2.setText(square+""); 
```

当您调用时`setText(int)`，系统将通过给定的 id(int) 查找字符串资源，这需要从 R 类中提供。

```
e2.setText(R.string.mystring); 
```

关于空指针，请尝试清理您的项目，您应该将启动移动到 onCreate() 方法。

```
@Override
public void onCreate(Bundle savedInstanceState){
  super.onCreate(savedInstanceState);
  setContentView( R.layout.activity_main);
  EditText e1=(EditText) findViewById(R.id.editText1);
  TextView e2=(TextView) findViewById(R.id.textView2);
}

public void calculateSquare(View view) {
  int number;
  if (e1.getText().toString().length()>0){
     number = Integer.parseInt(e1.getText().toString());
     int square=number * number;
     e2.setText(square+"");
  }
} 
```

您总是需要检查是否在 edittext 中输入了某些内容，因为空字符串无法转换为 int。

# objective-c - 复制字典将 NSMutableArray 更改为 NSArray？

> ID：13197603
> 
> 赞同：0
> 
> 时间：2012-11-02T14:51:21.297
> 
> 标签：objective-c, nsmutablearray, nsmutabledictionary

所以我有这个 NSMutableDictionary 对象：

```
pdata=[[NSMutableDictionary alloc] initWithObjectsAndKeys:
       @"",@"pid",
       @"",@"pname",
       [[NSMutableArray alloc] initWithCapacity:1],@"ilist",
       nil]; 
```

然后我将此对象复制到另一个对象中，如下所示：

```
NSMutableDictionary *pdataCopy=[[NSMutableDictionary alloc] initWithDictionary:pdata copyItems:TRUE]; 
```

但是一旦我这样做了，`pdataCopy.ilist`现在是一个 NSArray 而不是 NSMutableArray。

如何在复制字典对象的同时保持其内部属性的可变性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T14:58:11.893

其实你不能。您可以通过

```
NSMutableArray *mutableArray = [pdataCopy.ilist mutableCopy] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T15:20:08.607

你有三个选择：

1.  不指定`copyItems:YES`
2.  复制后扫描字典并根据需要将 NSArrays 替换为 NSMutableArrays（使用`mutableCopy`）。
3.  创建您自己的 NSMutableArray 子类，它`copyWithZone`通过生成自身的可变副本来响应（并在字典中使用该类的对象）。

# ruby - URI.parse 的替代方案，允许主机名包含下划线

> ID：13197605
> 
> 赞同：6
> 
> 时间：2012-11-02T14:51:34.223
> 
> 标签：ruby, uri

我正在使用[DMOZ](http://rdf.dmoz.org)的[url 主题列表](http://rdf.dmoz.org/rdf/content.rdf.u8.gz)，其中包含一些具有包含下划线的主机名的 url。

例如：

```
608  <ExternalPage about="http://outer_heaven4.tripod.com/index2.htm">
609    <d:Title>The Outer Heaven</d:Title>
610    <d:Description>Information and image gallery of McFarlane's action figures for Trigun, Akira, Tenchi Muyo and other Japanese Sci-Fi animations.</d:Description>
611    <topic>Top/Arts/Animation/Anime/Collectibles/Models_and_Figures/Action_Figures</topic>
612  </ExternalPage> 
```

虽然这个 url 可以在网络浏览器中使用（或者，至少在我的浏览器中可以使用：p），[但根据标准，它是不合法的](http://en.wikipedia.org/wiki/Hostname#Restrictions_on_valid_host_names)：

> 主机名不能包含其他字符，例如下划线字符 (_)，

尝试解析此类 URL 时会导致错误`URI.parse`：

```
[2] pry(main)> require 'uri'
=> true
[3] pry(main)> URI.parse "http://outer_heaven4.tripod.com/index2.htm"
URI::InvalidURIError: the scheme http does not accept registry part: outer_heaven4.tripod.com (or bad hostname?)
from ~/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/uri/generic.rb:213:in `initialize' 
```

有没有替代`URI.parse`我可以使用的具有较低严格性的替代方法，而不仅仅是自己滚动？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-02T14:59:25.670

试试[Addressable::URI](https://github.com/sporkmonger/addressable/tree/)。它比 URI 更接近 RFC，并且非常灵活。

```
require 'addressable/uri'
uri = Addressable::URI.parse('http://outer_heaven4.tripod.com/index2.htm') 
uri.host 
=> "outer_heaven4.tripod.com" 
```

我已经将它用于一些项目并且对它感到满意。URI 有点……生锈了，需要 TLC。其他人也对此发表了评论：

[http://www.cloudspace.com/blog/2009/05/26/replacing-rubys-uri-with-addressable/](http://www.cloudspace.com/blog/2009/05/26/replacing-rubys-uri-with-addressable/)

几年前，Ruby 开发人员对 URI 的状态进行了相当大的讨论。我现在找不到指向它的链接，但有人建议使用 Addressable::URI 作为替代。我不知道是否有人加紧接管 URI 开发，或者现在情况如何。在我自己的代码中，我继续将 URI 用于简单的事情，并在 URI 证明对我做错事时切换到 Addressable::URI。

# c# - 设置打印机首选项 - 页面方向为横向

> ID：13197606
> 
> 赞同：3
> 
> 时间：2012-11-02T14:51:38.503
> 
> 标签：c#, winforms, printing, landscape-portrait

我想将页面方向设置为 LandScape，以便从我的 excel Vsto 项目中打印 excel 工作表。从“打印”表单弹出的“**打印机首选项”**窗口手动设置页面方向。

我需要一些自动化，每次用户发出打印命令时都会将方向设置为 LandScape。

![在此处输入图像描述](../Images/1d9af8e0c4d27b45ee3760ac7508ee94.png)

我注意到，如果我从我的 excel 应用程序中将方向设置为**LandScape**，那么如果我想从 MS-word 应用程序中打印出来，它会保持不变，反之亦然。所以必须有某种标志，可以从任何简单的 winform 应用程序中更改。

有什么办法可以操纵属性吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-11T07:32:54.083

我找不到任何方法可以自定义任何单个打印机的打印机设置。这是适用于我的 EXCEL 应用程序的代码。

`CommonData._WORKBOO`K 是一个静态工作簿对象

```
Worksheet ws = CommonData._WORKBOOK.Application.ActiveSheet as Worksheet;

var _with1 = ws.PageSetup;

_with1.Orientation = Microsoft.Office.Interop.Excel.XlPageOrientation.xlLandscape;
CommonData._WORKBOOK.Application.Dialogs[Microsoft.Office.Interop.Excel.XlBuiltInDialog.xlDialogPrint].Show(Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing,
                            Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing,
                            Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing,
                            Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing,
                            Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing,
                            Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T16:48:48.003

您可以尝试以下类似的方法应该适合您

```
public void CustPrinting() 
{
   try 
     {
       strPrint = new StreamReader (filePath);
     try 
       {
         printFont = new Font("Arial", 10);
         PrintDocument pd = new PrintDocument(); 
         pd.PrintPage += new PrintPageEventHandler(pd_PrintPage);
         pd.PrinterSettings.PrinterName = printer;
         // Set the page orientation to landscape.
         pd.DefaultPageSettings.Landscape = true;
         pd.Print();
       } 
     finally 
     {
       strPrint.Close() ;
     }
   } 
   catch(Exception ex)
   { 
     MessageBox.Show(ex.Message);
   }
 } 
```

# php - PHP Mailer 发送一个 mysql blob 对象

> ID：13197607
> 
> 赞同：1
> 
> 时间：2012-11-02T14:51:38.983
> 
> 标签：php, mysql, blob, phpmailer

我将 pdf 或文本文件存储在 mysql blob 对象中，并且我正在尝试使用 php mailer 将其作为邮件中的附件发送。

我正在发送邮件。

```
$mail->AddAddress($pr_email);
$mail->Subject = "Meeting Invitation -$meeting_name";

$mail->AddStringAttachment($data);
$mail->IsHTML(true);
$mail->Body =$message;

if(!$mail->Send())
{
    $message= "Error sending: " . $mail->ErrorInfo;
    header("Location:userprofile.php?Message={$message}");
} 
```

从哪里来`$data` _

```
$tmpName  = $_FILES['image']['tmp_name'];
$fp     = fopen($tmpName, 'r');
$data = fread($fp, filesize($tmpName));
$data = addslashes($data);
fclose($fp);
$query = "UPDATE demo_meeting SET attachment='$data' where meetingID='$mtngid'";
$results = mysql_query($query); 
```

现在我以附件形式接收邮件，但内容不存在，仅显示 `0K`.

请告诉我我可能做错了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T15:56:30.997

正如我[在 StackOverflow](https://stackoverflow.com/questions/1201955/phpmailer-addstringattachment-and-data-uri-scheme)中看到的，您没有将其他参数传递给 AddStringAttachment：mime 类型和文件名。

```
$filename="test.png";
$encoding = "base64"; 
$type = "image/png";
$mail->AddStringAttachment(base64_decode($data), $filename, $encoding, $type); 
```

此外，永远不要使用`addslashes`“保护” mysql 字段，您必须`mysql_real_escape_string`改用（或者，使用不会很快被标记为过时的[PDO_MySQL驱动程序）](http://php.net/manual/en/ref.pdo-mysql.php)

# jquery - 固定标题问题中的下拉菜单

> ID：13197613
> 
> 赞同：1
> 
> 时间：2012-11-02T14:52:07.407
> 
> 标签：jquery, css, drop-down-menu, scroll

我正在从 Tutsplus（很棒的网站）构建一个[CSS3 下拉菜单。](http://net.tutsplus.com/tutorials/html-css-techniques/how-to-build-a-kick-butt-css3-mega-drop-down-menu/)我没有任何问题地实现了菜单，并且它以应有的方式工作。然而，我的问题是我在一个固定的标题中使用这个菜单。我在这个下拉菜单中有很多内容，在正常大小的屏幕上，我使用没有问题`overflow-y: auto;`但是，当屏幕调整大小时，即使滚动，大部分菜单也会被切断。当试图用鼠标滚动时，只有页面正文中的内容会滚动（由于固定的标题）。有没有一种方法可以在下拉菜单被激活时只允许下拉菜单中的 div 滚动（我正在使用悬停效果，但将使用更可行的 onClick id）？例如，像 Facebook 这样的东西，当单击固定标题中的菜单项时，只有在下拉 div 内溢出才会滚动。谢谢！

# javascript - 如何用 jasmine.js 干掉这些测试

> ID：13197628
> 
> 赞同：0
> 
> 时间：2012-11-02T14:53:11.420
> 
> 标签：javascript, unit-testing, coffeescript, jasmine

我有很多测试，如下所示：

```
it "Should call togglePadding if df-padding is checked", ->
        spyOn(App.columnsSetupBuildingBlockController.content, 'togglePadding')
        App.view.set("paddingChecked", null)

        Em.run ->
            App.view.set("paddingChecked", true)

        expect(App.columnsSetupBuildingBlockController.content.togglePadding).toHaveBeenCalledWith(true)

    it "Should call togglePadding if df-padding is unchecked", ->
        spyOn(App.columnsSetupBuildingBlockController.content, 'togglePadding')
        App.view.set("paddingChecked", true)

        Em.run ->
            App.view.set("paddingChecked", null)

        expect(App.columnsSetupBuildingBlockController.content.togglePadding).toHaveBeenCalledWith(null) 
```

每个测试中只有几个不同的值是不同的。我如何编写一个共享函数来干燥重复的位并使其看起来更干净？

我也有相同的测试来测试边距、边框等

请帮忙。

谢谢瑞克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T15:44:46.227

我很确定我在你的问题中遗漏了一些东西......但这是我理解你想要做的

```
setup = (mode = null)->
    value1 = mode
    value2 = if not mode then true else null
    spyOn(App.columnsSetupBuildingBlockController.content, 'togglePadding')
    App.view.set("paddingChecked", value1)

    Em.run ->
        App.view.set("paddingChecked", value2)

    expect(App.columnsSetupBuildingBlockController.content.togglePadding).toHaveBeenCalledWith(value2)

it "Should call togglePadding if df-padding is checked", ->
    setup null

it "Should call togglePadding if df-padding is unchecked", ->
    setup true 
```

# ios6 - 如何绘制一个像素宽的 UIBezierPath？

> ID：13197634
> 
> 赞同：2
> 
> 时间：2012-11-02T14:53:28.657
> 
> 标签：ios6, retina-display, quartz-2d

我在设置为 iPhone（Retina 4 英寸）的模拟器中运行此代码

```
-(void)drawRect:(CGRect)rect {
    [[UIColor whiteColor]set];
    UIRectFill(self.bounds);
    UIBezierPath *vertLine = [UIBezierPath bezierPath];
    [vertLine moveToPoint:CGPointMake(20.5, 10.0)];
    [vertLine addLineToPoint:CGPointMake(20.5, 20.0)];
    vertLine.lineWidth = 1.0;
    [[UIColor blackColor]set];
    [vertLine stroke];
} 
```

我希望有一条一像素的垂直线，但这条线宽两像素，并且是纯黑色。纯黑色似乎表明这不是由于像素网格上的线对齐问题（在这种情况下它将是 50% 灰色）

这里发生了什么事 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T10:14:45.003

对于 UIKit，您不指定像素，而是指定点。然后点会自动映射到像素。您的 1-point-width-line 似乎映射到两个视网膜像素。

[请参阅http://developer.apple.com/library/ios/#documentation/2DDrawing/Conceptual/DrawingPrintingiOS/GraphicsDrawingOverview/GraphicsDrawingOverview.html](http://developer.apple.com/library/ios/#documentation/2DDrawing/Conceptual/DrawingPrintingiOS/GraphicsDrawingOverview/GraphicsDrawingOverview.html)中的“点与像素”

# artificial-intelligence - 特征的顺序影响神经网络的结果

> ID：13197638
> 
> 赞同：0
> 
> 时间：2012-11-02T14:53:40.297
> 
> 标签：artificial-intelligence, neural-network

好吧，我真的很困惑。

我有一个简单的特征顺序，即所有字母和几个符号，计算字符串中包含多少次。

我的选择结果如下

```
numberOf_a
numberOf_b
...
numberOf_Z
numberOf_.
numberOf_, 
```

我有一个 65 个值的测试样本，MLP 可以得到 46 个正确值。

现在，如果我随机选择特征的顺序，使用相同的数据进行训练，评估相同的值，我会得到不同数量的正确预测，例如 49。

结果是一致的（相同的顺序将产生相同的精度），但随机顺序之间的精度会发生变化。

问题是，这应该发生吗？我看不出理论如何支持这一点。我在这里遗漏了一些大的东西？

PS。我正在使用 WEKA 的 MLP 实现

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T17:09:55.980

我不熟悉 MLP 的 WEKA 实现，但这似乎不是神经网络算法应该发生的事情。

似乎它陷入了某种局部最小值。该算法可能每次都以相同的方式初始化各个神经元的权重。更改参数顺序可能会导致算法每次针对某个参数顺序得出相同的答案，具体取决于初始参数顺序。“局部最小值”可能由算法每次仅经过一定次数的迭代来确定。

# iphone - iphone html 5 视频 - 如何从不同时间开始

> ID：13197641
> 
> 赞同：0
> 
> 时间：2012-11-02T14:53:47.047
> 
> 标签：iphone, html, mobile-safari, html5-video

从特定时间开始播放视频的正确方法是什么？

目前，我们使用的方法是每隔一段时间检查是否可以通过 currentTime 进行搜索，然后进行搜索。这样做的问题是，当视频全屏视图弹出时，它会在搜索之前从头开始播放长达一秒钟。

我尝试过诸如`onloadmetadata`and之类的事件`canplay`，但这些事件似乎发生得太早了。

**补充信息**：似乎我能做的最好的事情就是设置一个计时器，`currentTime`一旦`play()`被调用，它就会尝试重复设置，但是，这还不够直接。视频从头开始加载，大约一秒钟后，取决于设备，跳转。这对我来说是个问题，因为它给用户带来了不满意的体验。

似乎没有更好的解决方案，但我想看看是否有：a）我错过了一些聪明/无证的东西，它允许您在加载之前搜索或以其他方式指示视频需要不是从00:00开始，而是从任意点开始起来，但它会立即在我需要的地方开始，而不是寻找）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T23:09:18.683

对于桌面浏览器 Chrome/Safari，您可以将 #t=starttimeoffsetinseconds 附加到您的视频 src url 以使其从某个位置开始。对于 iOS 设备，我们能做的最好的就是监听 timeupdated 事件，并在那里进行搜索。我想这与您使用计时器的原始方法相同。

-R

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T15:12:09.593

做这样的事情；

```
var video = document.getElementsById("video");
video.currentTime = starttimeoffset; 
```

可以[在此页面上找到更多信息，专门用于视频时间偏移 howtos](http://blog.gingertech.net/2009/08/19/jumping-to-time-offsets-in-videos/)

# c# - 是否可以在 WatiN 中暂停？

> ID：13197648
> 
> 赞同：0
> 
> 时间：2012-11-02T14:54:07.930
> 
> 标签：c#, watin

我的 WatiN 应用程序通过多个网页实现自动化。

自动化是否可以在某个点暂停，并且仅在用户这样说（单击“继续”按钮）时才继续自动化？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T08:54:05.160

我在我的项目中做了类似的事情，也许这会有所帮助（我没有正确测试过这个，但它可能会为你指明正确的方向：D）

```
private System.Threading.AutoResetEvent arEvent = null;
private System.Windows.Forms.NotifyIcon nIcon = null;

public void WatinBreakpoint()
{
    this.arEvent = new System.Threading.AutoResetEvent(false);
    this.nIcon = new NotifyIcon();
    this.nIcon.Text = "Watin Breakpoint.  Double click to continue";
    this.notifyIcon.DoubleClick += new EventHandler(notifyIcon_DoubleClick);
    this.arEvent.WaitOne();
}

private void notifyIcon_DoubleClick(object sender, EventArgs e)
{
    this.arEvent.Set();
} 
```

！

# javascript - 对象不支持属性或方法“mediaelementplayer”

> ID：13197650
> 
> 赞同：2
> 
> 时间：2012-11-02T14:54:14.363
> 
> 标签：javascript, mediaelement.js

我正在尝试添加视频标签并将[MediaElement.js](http://mediaelementjs.com/)应用于它。

如果我这样做，它可以正常工作（为简洁起见减少了 Video 标签，但不会引发任何错误）：

```
<link rel='stylesheet' href='/_layouts/MediaElementWebPart/mediaelementplayer.min.css' />
<script type="text/javascript" src='/_layouts/MediaElementWebPart/jquery.js'></script>
<script type="text/javascript" src='/_layouts/MediaElementWebPart/mediaelement-and-player.min.js'></script>
<video width='640' height='320' id='MEWP'>
</video>
<script>$('MEWP').mediaelementplayer()</script> 
```

但是，如果我通过代码添加标签，.mediaelementplayer() 会抛出 **SCRIPT438: Object doesn't support property or method 'mediaelementplayer'**

```
<link rel='stylesheet' href='/_layouts/MediaElementWebPart/mediaelementplayer.min.css' />
<script type="text/javascript" src='/_layouts/MediaElementWebPart/jquery.js'></script>
<script type="text/javascript" src='/_layouts/MediaElementWebPart/mediaelement-and-player.min.js'></script>
<div id="videosContainer">
</div>
<script type="text/javascript">
    $(function () {
        var random = Math.floor((Math.random() * 100000) + 1);
        var id = "MEWP-" + random.toString();
        var video = "<video width=\'640\' height=\'320\' id=\'" + id + "\' ></video>";
        $(video).appendTo('#videosContainer');
        $('#' + id).mediaelementplayer();
    });
</script> 
```

不过，根据调试器，似乎找到了视频标签的元素

```
[+]     $('#' + id)[0]  {...}   [Object, HTMLVideoElement] 
```

我在这里想念什么？任何有关解决此类问题的一般建议，不胜感激。

# php - 在 PHP 中清理全局数组

> ID：13197651
> 
> 赞同：0
> 
> 时间：2012-11-02T14:54:23.087
> 
> 标签：php, security, sanitize

我正在尝试找到在 PHP 中清理请求的最佳方法。

从我读到的内容中，我了解到只有在显示 GET 变量时才应该对其进行清理，而不是在“请求流”开始时进行清理。发布变量（不是来自数据库）。

我可以在这里看到几个问题：

当然，我可以创建清理这些变量的函数，并通过调用类似`Class::post('name')`, 或者`Class::get('name')`一切都是安全的。但是，如果将来使用我的代码的人会忘记它并使用casual `$_POST['name'`] 而不是我的函数怎么办？我可以提供，还是应该在这里提供一些安全性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T15:03:01.343

从来没有一种万能的消毒方法。“清理”意味着您操纵一个值以符合某些属性。例如，您将应该是数字的东西转换为数字。或者你`<script>`从假定的 HTML 中去除标签。清理什么以及如何清理取决于价值应该是什么以及您是否需要进行清理。例如，为白名单标签清理 HTML 非常复杂。

因此，没有什么魔法`Class::sanitize`可以同时适用于所有事物。任何使用您的代码的人都需要*考虑*他们想要做什么。如果他们只是盲目地`$_POST`按原样使用值，他们已经失败了，需要上交他们的程序员卡。

您*始终*需要做的是根据上下文进行*转义。*但由于这取决于上下文，因此您只在必要时才这样做。你不会盲目地逃避所有`$_POST`的价值观，因为你不知道你在逃避*什么*。有关整个主题的更多背景信息，请参阅[The Great Escapism（或：使用文本中的文本需要知道的内容）。](http://kunststube.net/escapism/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T15:00:07.040

当 PHP 读取变量时，这些变量基本上被“清理”了。意思是如果我要提交

```
"; exec("some evil command"); $blah=" 
```

那么就 PHP 而言，这不会是一个问题 - 你会得到那个文字字符串。

但是，当将它从 PHP 传递给其他东西时，确保“其他东西”不会误解字符串是很重要的。因此，如果它要进入 MySQL 数据库，那么您需要根据 MySQL 规则对其进行转义（或使用准备好的语句，这将为您执行此操作）。如果要进入 HTML，则至少需要进行`<`编码`&lt;`。如果它要进入 JavaScript，那么您需要对它进行 JSON 编码，依此类推。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T15:00:31.243

你可以做这样的事情......不是万无一失的，但它有效..

```
foreach($_POST as $key => $val)
{
  //do sanitization
  $val = Class::sanitize($val);

  $_POST[$key] = $val;
} 
```

编辑：你想把它放在尽可能靠近标题的地方。我通常将我的放在控制器中，以便它`__construct()`自动执行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-02T15:01:08.493

将 $_POST 数组替换为行为类似数组的 sanitizer 对象。

# ruby-on-rails - order_by 多个字段，包括一个布尔值

> ID：13197663
> 
> 赞同：4
> 
> 时间：2012-11-02T14:55:04.783
> 
> 标签：ruby-on-rails, ruby, mongodb, mongoid

我正在尝试以首先显示布尔值的方式订购我的 default_scope `important = true`，然后按`created_at`desc 顺序排列。

所以，我有以下代码：

```
default_scope order_by(:important => :desc, :created_at => :desc) 
```

但是，看起来`important`字段顺序被忽略了。

我怎样才能让它工作？

提前致谢

* * *

编辑：

我只是改变了订单参数的顺序，它就可以工作：

```
default_scope order_by(:created_at => :desc, :important => :desc) 
```

就这么简单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T15:05:11.977

这是一个关于如何在 rails 中对两列进行排序的示例（可能您可能需要稍微修改它以符合您的要求），但我认为您明白了

```
<Model>.all(:order => 'important, created_at') 
```

高温高压

# python - 计算字符串中的连续字符

> ID：13197668
> 
> 赞同：6
> 
> 时间：2012-11-02T14:55:14.853
> 
> 标签：python, string, count, character

我需要编写一个代码来分割字符串（这是一个输入），将它附加到一个列表中，计算每个字母的数量 - 如果它与它之前的字母相同，请不要将它放在列表中，而是增加该字母在前一个中的出现次数。嗯，这应该是这样的：

```
assassin [['a', 1], ['s', 2], ['a', 1], ['s', 2]], ['i', 1], ['n', 1] 
```

刺客这个词只是需要的一个例子。到目前为止我的代码是这样的：

```
userin = raw_input("Please enter a string :")
inputlist = []
inputlist.append(userin)
biglist = []
i=0
count = {}
while i<(len(userin)):
    slicer = inputlist[0][i]
    for s in userin:
        if count.has_key(s):
            count[s] += 1
        else:
            count[s] = 1
    biglist.append([slicer,s])
    i = i+1
print biglist 
```

谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-02T14:56:49.467

使用[`Collections.Counter()`](http://docs.python.org/2/library/collections.html#collections.Counter), dictionary 是一种更好的存储方式：

```
>>> from collections import Counter
>>> strs="assassin"
>>> Counter(strs)
Counter({'s': 4, 'a': 2, 'i': 1, 'n': 1}) 
```

或使用[`itertools.groupby()`](http://docs.python.org/2/library/itertools.html#itertools.groupby)：

```
>>> [[k, len(list(g))] for k, g in groupby(strs)]
[['a', 1], ['s', 2], ['a', 1], ['s', 2], ['i', 1], ['n', 1]] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T15:45:25.880

```
last = ''
results = []
word = 'assassin'
for letter in word:
if letter == last:
    results[-1] = (letter, results[-1][1] +1)
else:
    results.append((letter, 1))
    last = letter

print result # [('a', 1), ('s', 2), ('a', 1), ('s', 2), ('i', 1), ('n', 1)] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-02T15:06:15.637

仅使用内置函数：

```
def cnt(s):
    current = [s[0],1]
    out = [current]
    for c in s[1:]:
        if c == current[0]:
            current[1] += 1
        else:
            current = [c, 1]
            out.append(current)
    return out

print cnt('assassin') 
```

# php - 将产品选择小部件添加到 Magento 中的自定义属性

> ID：13197670
> 
> 赞同：2
> 
> 时间：2012-11-02T14:55:27.633
> 
> 标签：php, magento

有谁知道如何使用小部件渲染器添加自定义产品属性？如果您选择 SKU，您可以在促销规则中看到这一点，您将看到一个带有产品选择的 Ajax 弹出窗口。

那么我该怎么做呢？在 ：

```
$installer->addAttribute(Mage_Catalog_Model_Product::ENTITY... 
```

换句话说，我如何使用小部件来选择自定义属性值？

编辑：场景如下：

我想创建一个产品属性，单击按钮即可打开产品选择小部件。

选择后，所选 SKU 将以逗号分隔的格式输入。

这种行为可以在目录和购物车价格规则中看到。如果您按 SKU 过滤规则（必须启用 SKU 属性以“应用于规则”），您将获得一个字段和一个用于打开产品选择小部件的按钮。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T17:31:06.057

以下是一些可以让您走上正轨的想法：

首先，在设置脚本中，创建您的实体：

```
$installer->addAttribute('catalog_product', 'frontend_display', array(
    'label' => 'Display Test',
    'type'  => 'varchar',
    'frontend_model' => 'Test_Module/Entity_Attribute_Frontend_CsvExport',
    'input' => 'select',
    'required' => 0,
    'user_defined' => false,
    'group' => 'General'
)); 
```

确保将 frontend_model 设置为您要使用的模型。前端模型影响属性的显示（在前端和 adminhtml 部分中）。

接下来，创建自己的类，并覆盖以下一个或两个函数：

```
public function getInputType()
{
    return parent::getInputType();
}

public function getInputRendererClass()
{
    return "Test_Module_Block_Adminhtml_Entity_Renderer_CsvExport";
} 
```

第一个 ( `getInputType()`) 用于将输入类型更改为烘焙输入类型（请参阅`Varien_Data_Form_Element_*`选项）。但是，要设置您自己的渲染器类，请使用后一个函数 - `getInputRendererClass()`。这就是我将在下面演示的内容：

```
public function getElementHtml()
{
    return Mage::app()->getLayout()->createBlock('Test_Module/Adminhtml_ExportCsv', 'export')->toHtml();
} 
```

在这里，为了清理，我正在实例化另一个块，因为元素本身没有显示按钮等的额外功能。

最后，创建这个文件：

```
class Test_Module_Block_Adminhtml_ExportCsv extends Mage_Adminhtml_Block_Widget
{
    protected function _prepareLayout()
    {
        $button = $this->getLayout()->createBlock('adminhtml/widget_button')
            ->setData(array(
            'label' => $this->__('Generate CSV'),
            'onclick' => '',
            'class' => 'ajax',
        ));

        $this->setChild('generate', $button);
    }

    protected function _toHtml()
    {
        return $this->getChildHtml();
    }
} 
```

这不包括 AJAX 部分，但会让您非常接近让其余部分工作。

# cordova - 用于浏览器调试的 PhoneGap/Cordova 模拟器

> ID：13197672
> 
> 赞同：7
> 
> 时间：2012-11-02T14:55:34.967
> 
> 标签：cordova

全部，

是否有 PhoneGap/Cordova 模拟器/模拟库，以便我们可以在普通的 Web 浏览器中开发和调试我们的应用程序（特别是因为我们的绝大多数代码是应用程序逻辑，很少有 Cordova API 调用）。通过实际的移动设备或设备模拟器进行调试/编码要麻烦得多，并且会破坏开发工作流程。请注意，我们不想测试 Cordova API 是否有效。我们只是希望能够在 Web 浏览器中运行我们的应用程序而不会因为`navigator.suchAndASuch.thisAndThat()`未定义而死掉。

TIA。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-02T17:49:53.013

您正在寻找[Ripple Emulator](http://emulate.phonegap.com/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-14T22:10:23.387

结帐 Cordova 浏览器，可用于新发布的 Cordova 4.0

阅读此页面上的“**新平台：Cordova 浏览器**”部分：http: [//cordova.apache.org/announcements/2014/10/16/cordova-4.html](http://cordova.apache.org/announcements/2014/10/16/cordova-4.html)

# javascript - 简单对象的 JSON 序列化不一致

> ID：13197673
> 
> 赞同：0
> 
> 时间：2012-11-02T14:55:43.047
> 
> 标签：javascript, json, serialization

我使用的每个 JSON 序列化实用程序或库似乎都已损坏，对此我无法得到合乎逻辑的解释。

让我解释。我在 Firebug 中为 .NET 的 JSON 库运行以下代码，可能适用于其他语言。

当我运行时，我只是签入 Firefox：

```
var obj1 = "test";
var obj1serialization = JSON.stringify(obj1); 
```

输出是`""test""`。但这是**无效的 JSON 对象**！因此，当我尝试从该序列化 JSON 重新创建对象时，它失败了，说明 JSON 字符串不正确：

```
var obj2 = JSON.parse(obj1serialization); 
```

字符串是对象。但是它们在 JSON 中的序列化不起作用。这种情况有什么合乎逻辑的解释吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T14:58:18.147

在[JSON](http://json.org/)中（与几种编程语言不同），字符串不是对象，它们是原语（如数字和布尔值）。您要求序列化程序创建一个 JSON*片段*。有效 JSON 文档的顶级项始终是对象或数组。如果您将其中一个输入`JSON.stringify`，它将生成一个有效的、完整的 JSON 文档。

大多数 JSON 序列化程序允许片段这一事实非常有用。如果您向它们传递了不是对象或数组的东西，他们唯一的选择就是抛出异常。

[`JSON.parse`](http://ecma-international.org/ecma-262/5.1/#sec-15.12.2)更具限制性，要求您提供的 JSON 文档既完整又格式良好。并非所有 JSON 解析例程都有那么严格，但确实如此。

# java - 如何通过单击按钮在面板的同一区域显示不同的 JPanel

> ID：13197682
> 
> 赞同：2
> 
> 时间：2012-11-02T14:56:18.890
> 
> 标签：java, swing, validation, user-interface, jpanel

我希望在按下按钮时显示不同的 JPanel。面板中显示的其他两个 JPanel 不得移动。我试过了，但是当按下按钮时，什么也没有发生。甚至多次按下按钮时，必须显示许多文本字段，否则是一个简单的滚动窗格。这是代码：

最终 JPanel 选择TypeOfAnswer = new JPanel();

```
 choseTypeOfAnswer.add(radioBox);
    radioBox.setToolTipText("Answer in form of radiobox");
    radioBox.setIcon(GUI.createImageIcon("check.png"));          
    radioBox.setAlignmentX(Component.LEFT_ALIGNMENT);
    radioBox.setPreferredSize(new Dimension(30, 20));  
    radioBox.setVisible(true);
    radioBox.addActionListener(new ActionListener(){

        private int clicked;
        public void actionPerformed(ActionEvent e){
            clicked++;
            //reset contents of the image preview field
            if((clicked % 2) == 0){

            add(new JLabel("<html><b>Answer:</b>"));

            JTextField textField = new JTextField(20);
            JTextField textField1 = new JTextField(20);
            JTextField textField2 = new JTextField(20);
            JTextField textField3 = new JTextField(20);

            choseTypeOfAnswer.add(textField);
            choseTypeOfAnswer.add(textField1);
            choseTypeOfAnswer.add(textField2);
            choseTypeOfAnswer.add(textField3);

            add(BorderLayout.NORTH,choseTypeOfAnswer);
            }else{
            add(new JLabel("<html><b>Answer:</b>"));
            //now a scroll pane for the answer area
            JScrollPane answerScroller = new JScrollPane(answerArea);
            answerScroller.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_AS_NEEDED);
            answerScroller.setHorizontalScrollBarPolicy(ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);
            choseTypeOfAnswer.add(answerScroller);
            //add(answerScroller);
            add(choseTypeOfAnswer);

            }
        }
        });//den emfanizei tpt me to patima tou koympiou

    add(choseTypeOfAnswer);

    //holds the bottom two components: "important" checkbox, "create card" button
    JPanel bottomContainer = new JPanel();
    //bottomContainer.setLayout(new BoxLayout(bottomContainer,BoxLayout.PAGE_AXIS));
    //important.setAlignmentX(Component.CENTER_ALIGNMENT);
    //bottomContainer.add(important);

    createCard.setText("Finish and add card");
    createCard.setIcon(GUI.createImageIcon("check.png"));          
    createCard.setAlignmentX(Component.CENTER_ALIGNMENT);
    createCard.setAlignmentY(Component.BOTTOM_ALIGNMENT);
    createCard.setPreferredSize(new Dimension(180, 45));           
    createCard.addActionListener(new cardListener());
    bottomContainer.add(createCard);

    //now add the bottom container
    add(bottomContainer, BorderLayout.SOUTH); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T19:39:57.507

使用`Component#setVisible(...)`使一个面板可见，并隐藏另一个。

# android - android.support.v4 在某些设备上导致强制关闭

> ID：13197685
> 
> 赞同：0
> 
> 时间：2012-11-02T14:56:38.207
> 
> 标签：android, nullpointerexception, proguard

我在 Playstore 中列出了一个应用程序，一些用户报告了强制关闭问题。我去开发者控制台查看详细信息，并显示以下消息。我`android support library`在应用程序中使用过。类扩展`FragmentActivity`和我使用的其他导入是

```
import android.support.v4.app.FragmentActivity;
import android.support.v4.app.LoaderManager;
import android.support.v4.content.AsyncTaskLoader;
import android.support.v4.content.Loader; 
```

**堆栈跟踪**

```
java.lang.RuntimeException: An error occured while executing doInBackground()
at android.support.v4.a.h.done(Unknown Source)
at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:274)
at java.util.concurrent.FutureTask.setException(FutureTask.java:125)
at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:308)
at java.util.concurrent.FutureTask.run(FutureTask.java:138)
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
at java.lang.Thread.run(Thread.java:1019)
Caused by: java.lang.NullPointerException
at my.package.name.k.n(Unknown Source)
at my.package.name.k.d(Unknown Source)
at android.support.v4.a.a.e(Unknown Source)
at android.support.v4.a.b.a(Unknown Source)
at android.support.v4.a.b.a(Unknown Source)
at android.support.v4.a.g.call(Unknown Source)
at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
... 4 more

For applications that include obfuscated code, stack traces contain obfuscated symbol  
names. If the application was obfuscated using ProGuard, you can unobfuscate the stack 
trace using the "retrace" tool, included in the Android SDK Tools r8 and later. For 
more information, see the ProGuard document. 
```

# python - 如何确保 Python while 循环需要特定的时间才能运行？

> ID：13197686
> 
> 赞同：5
> 
> 时间：2012-11-02T14:56:37.560
> 
> 标签：python, python-2.7, while-loop, serial-port, pyserial

我正在使用 while 循环读取串行数据。但是，我无法控制采样率。

代码本身似乎需要 0.2 秒才能运行，所以我知道我不会比这更快。但我希望能够精确控制采样的速度。

我觉得我可以使用“睡眠”来做到这一点，但问题是循环本身在不同点可能需要更长的时间来读取（具体取决于通过串行数据传输的内容），所以代码会有弥补余额。

例如，假设我想每 1 秒采样一次，循环运行时间从 0.2 秒到 0.3 秒不等。我的代码需要足够聪明才能睡 0.8 秒（如果循环需要 0.2 秒）或 0.7 秒（如果循环需要 0.3 秒）。

```
import serial
import csv
import time

#open serial stream
    while True:

        #read and print a line
        sample_value=ser.readline()
        sample_time=time.time()-zero
        sample_line=str(sample_time)+','+str(sample_value)
        outfile.write(sample_line)
        print 'time: ',sample_time,', value: ',sample_value 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-02T15:06:25.530

只需测量运行代码所花费的每次循环迭代的时间，并`sleep`相应地：

```
import time

while True:
    now = time.time()            # get the time
    do_something()               # do your stuff
    elapsed = time.time() - now  # how long was it running?
    time.sleep(1.-elapsed)       # sleep accordingly so the full iteration takes 1 second 
```

当然不是 100% 完美（可能不时关闭一毫秒或另一毫秒），但我想这已经足够好了。

* * *

另一个不错的方法是使用[twisted](http://twistedmatrix.com/)的[`LoopingCall`](http://twistedmatrix.com/documents/8.1.0/api/twisted.internet.task.LoopingCall.html)：

```
from twisted.internet import task
from twisted.internet import reactor

def do_something():
    pass # do your work here

task.LoopingCall(do_something).start(1.0)
reactor.run() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T16:35:50.023

一个相当优雅的方法是你在 UNIX 上工作：使用信号库

编码 ：

```
import signal

def _handle_timeout():
    print "timeout hit" # Do nothing here

def second(count):
    signal.signal(signal.SIGALRM, _handle_timeout)
    signal.alarm(1)
    try:
        count += 1 # put your function here
        signal.pause()

    finally:
        signal.alarm(0)
        return count

if __name__ == '__main__':

    count = 0
    count = second(count)
    count = second(count)
    count = second(count)
    count = second(count)
    count = second(count)

    print count 
```

和时间：

```
 georgesl@cleese:~/Bureau$ time python timer.py
 5

 real   0m5.081s
 user   0m0.068s
 sys    0m0.004s 
```

但是有两个警告：它只适用于 *nix，而且它不是多线程安全的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T15:01:26.980

在循环开始时检查是否经过了适当的时间。如果还没有，`sleep`.

```
# Set up initial conditions for sample_time outside the loop
sample_period = ???
next_min_time = 0
while True:
    sample_time = time.time() - zero
    if sample_time < next_min_time:
        time.sleep(next_min_time - sample_time)
        continue
    # read and print a line
    sample_value = ser.readline()
    sample_line = str(sample_time)+','+str(sample_value)
    outfile.write(sample_line)
    print 'time: {}, value: {}'.format(sample_time, sample_value)
    next_min_time = sample_time + sample_period 
```

# php - Laravel 雄辩的计算关系

> ID：13197692
> 
> 赞同：32
> 
> 时间：2012-11-02T14:56:56.843
> 
> 标签：php, laravel, eloquent

我是 laravel 和雄辩的新手，我不确定这是否可能。但我有 2 个具有一对多关系的表。一种是“位置”，一种是“用户”。一个位置可以有多个用户。

因此，如果我想获得所有用户的所有位置，我会这样做：

```
Location::with("users")->get(); 
```

*但我也想知道每个*位置有多少用户，我试过这样做

```
Location::with("users")->count("users")->get(); 
```

但这没有用。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2014-05-15T17:32:16.803

如果您使用急切加载，则不会出现提到的 n+1 问题。

```
$locations = Location::with('users')->get();

$locations->users()->count(); 
```

无论您有多少用户或位置，这都会导致三个查询。

*   根据位置模型计算查询
*   从位置中选择 *
*   select * from users where in

混淆源于这样一个事实：

```
$locations = Location::all();

$locations->users()->count(); 
```

但在这种情况下，它会为每个位置查询一次。

有关更多信息，请参阅文档：http: [//laravel.com/docs/eloquent#eager-loading](http://laravel.com/docs/eloquent#eager-loading)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2018-03-21T12:42:36.200

您应该使用 just`withCount`但我想它在 2012 年不可用。

所以它应该是这样的：

```
Location::with("users")->withCount("users")->get(); 
```

并且您将`users_count`在您的对象上有一个可用的属性。

阅读文档以获取更多详细信息：[https](https://laravel.com/docs/5.5/eloquent-relationships#querying-relations) ://laravel.com/docs/5.5/eloquent-relationships#querying-relations （向下滚动一下，您将看到**Counting Related Models**）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-11-13T08:36:05.730

您需要在每个位置记录上调用 count 方法来获取每个位置的用户计数，这是一个示例：

```
foreach(Location::get() as $location) // or foreach(Location::with("users")->get() as $location)
{
  echo $location->users()->count();
} 
```

这应该可以解决您的问题并为您提供每个位置的用户数量。您可以在循环中添加检查以忽略用户计数 = 0 的位置

# java - 使用递归生成给定字符串的所有子字符串

> ID：13197696
> 
> 赞同：4
> 
> 时间：2012-11-02T14:57:04.060
> 
> 标签：java, string, recursion, substring

我应该首先说这里提出了类似的问题，但是对于我正在进行的作业，我不能使用任何循环，并且这些问题的所有答案都使用循环。所以使用 java 6 和递归来生成给定字符串的所有子字符串。例如，您给定的 String word = "Ralph"; 我需要像这样格式化输出。

```
Ralph
Ralp
Ral
Ra
R
alph
alp
al
a
lph
lp
l
ph
h 
```

这是我的生成方法

```
 //written by Justin Tew<BR>

public static void generate(String word) 
{

    //base case... wtf is the base case here?
    //idk bout this 
    if (word.length() == 1)
    {
        System.out.println(word);
        return;
    }

    //recursive case
    if (word.length() != 0)
    {

        System.out.println(word);
        generate(word.substring(0, word.length()-1)); //gets the first 5 substrings
    } 
```

输出：

```
Ralph
Ralp
Ral
ra
r 
```

在我看来，这个电话`generate(word.substring(1, word.length()-1));`应该得到下一个 5 但它不会得到非常奇怪的输出......

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T16:47:45.240

两个答案都非常正确。我刚刚添加了一个名为的新方法`suffixGen`：

```
public static void suffixGen(String word)
{
    if (word.length() > 1)
    {
        generate(word);
        suffixGen(word.substring(1));
    }

} 
```

在我的主要工作中，我只是打电话`suffixGen`而不是`generate`它让我得到了想要的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T15:06:22.263

您可以递归单词长度，而不是递归单词的字母。例如，在递归的顶层，您可以找到所有带有`word.length()`字母的子字符串，然后是`word.length() - 1`字母等等。不过，这可能需要两种递归方法，一种遍历单词长度，另一种遍历该长度的所有可能子字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-02T15:10:44.847

听起来你已经完成了大部分工作。只需编写另一个递归`generateSuffix(word)`方法

*   第一次打电话`generate(word)`
*   `generateSuffix()`然后用最长的单词后缀调用。

您仍然需要与您在生成中所拥有的基本案例类似的基本案例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-05T06:27:42.613

您不需要辅助方法，如果您将附加字符串传递给该方法，只需将其值作为空白传递，如下面的方法调用所示：

```
 public static void substrings(String str, String temp)
    {
        if(str.length()==0)
        {
            System.out.println(temp); return;
        }

          substrings(str.substring(1), temp+str.substring(0,1));
          substrings(str.substring(1), temp);
    } 
```

示例调用 ---> **substrings("abc", "")** ;

产生以下输出：

美国广播公司

抗体

交流

一个

公元前

b

C

有一个不可见的字符串实际上是一个空白字符串。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-12T02:47:15.953

一个易于阅读的解决方案在这里

```
public class AllSubStrings {
    //hashset to keep a record of all the substrings
    static HashSet<String> subStrings_r=new HashSet<>();

    public static void main(String[] args) {
        String testString="Sujal";
        getSubstrings_r(testString);
        System.out.println("RECURSION ->"+subStrings_r);
    }

    public static void getSubstrings_r(String testString){
        _getSubstrings_r(testString, 0, testString.length());
    }

    public static void _getSubstrings_r(String testString,int start,int end){
        if(start==end){ //base condition
            return;
        }
        subStrings_r.add(testString.substring(start, end));
        //start getting substrings from left to right
        _getSubstrings_r(testString,start+1,end); 
        //start getting substrings from right to left
        _getSubstrings_r(testString,start,end-1);
    }

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-07-18T01:58:46.370

尝试这样的事情

```
String word; 
int word_length = word.length(); //get the length of the word

for(int i=0;i<word_length;i++){
   for(int j=0; j<=word_length-i ; j++){

       String sub = word.substring(i,i+j); 
       System.out.println(sub); //print the substrings
    } 
```

# java - 比较等于星号的字符串

> ID：13197699
> 
> 赞同：1
> 
> 时间：2012-11-02T14:57:09.520
> 
> 标签：java, string, comparison

如上所述，我如何查找等于的字符串`*`？

我试过这个：

```
if (string.equals("*")) {
    return message;
} 
```

该程序只是不会进入该`if`语句。我能知道我哪里出错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T15:01:01.520

此代码工作正常，下面的代码返回`"happy"`控制台，`.equal`在字符串上使用 for没有任何问题`*`。

```
 public class NumberFun {
    static String string = "*";
    static String message = "happy";

    public static void main(String args[]) {
        System.out.println(getMessage());
    }

    private static String getMessage() {
        if (string.equals("*")) {
            return message;
        }
        return "fail";
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T14:58:13.177

我猜你`String`可能有空格。我会尝试申请`trim()`

```
if(string.trim().equals("*")){
        return message;
    } 
```

这是示例：

```
String mytem ="*";

     if(mytem.equals("*"))
     {
         System.out.println("Hello");
     } 
```

输出：

```
Hello 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T15:09:12.260

好的，我要再打赌：您要比较的字符串作为命令行参数传递。但是命令行参数由 shell 扩展（至少在 Unix/Linux 等上）。例如，单个星号将扩展为当前目录中的文件列表。您的 Java 程序（甚至 JVM）没有机会看到原始输入星号。

在进行比较之前打印您的字符串。如果我的猜测是正确的，请将命令行参数括在引号中以避免 shell 扩展。

# java - 在保留 Java 中的当前元素的同时调整数组的大小？

> ID：13197702
> 
> 赞同：69
> 
> 时间：2012-11-02T14:57:15.510
> 
> 标签：java, arrays

我已经搜索了一种在 Java 中调整数组大小的方法，但是我找不到*在保留当前元素的同时*调整数组大小的方法。

我找到了类似的示例代码`int[] newImage = new int[newWidth];`，但这会删除之前存储的元素。

我的代码基本上会这样做：每当添加新元素时，数组都会增大**1**。我认为这可以通过动态编程来完成，但我不确定如何实现它。

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2012-11-02T15:00:13.893

您无法在 Java 中调整数组的大小。您需要：

1.  创建一个所需大小的新数组，并将原始数组中的内容复制到新数组，使用[`java.lang.System.arraycopy(...);`](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#arraycopy(java.lang.Object,%20int,%20java.lang.Object,%20int,%20int))

2.  使用[`java.util.ArrayList<T>`](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html)该类，当您需要使数组更大时，它会为您执行此操作。它很好地封装了您在问题中描述的内容。

3.  使用[`java.util.Arrays.copyOf(...)`](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#copyOf(T[],%20int))返回更大数组的方法，其中包含原始数组的内容。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-11-02T15:02:26.867

不好，但有效：

```
 int[] a = {1, 2, 3};
    // make a one bigger
    a = Arrays.copyOf(a, a.length + 1);
    for (int i : a)
        System.out.println(i); 
```

如前所述，使用[ArrayList](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html)

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2015-09-04T18:05:16.827

这里有几种方法可以做到这一点。

* * *

方法一[`System.arraycopy()`](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#arraycopy(java.lang.Object,%20int,%20java.lang.Object,%20int,%20int))：：

> 将指定源数组中的数组从指定位置开始复制到目标数组的指定位置。数组组件的子序列从 src 引用的源数组复制到 dest 引用的目标数组。复制的组件数量等于长度参数。源数组中位置 srcPos 到 srcPos+length-1 的分量分别复制到目标数组的位置 destPos 到 destPos+length-1。

```
Object[] originalArray = new Object[5];   
Object[] largerArray = new Object[10];
System.arraycopy(originalArray, 0, largerArray, 0, originalArray.length); 
```

* * *

方法二[`Arrays.copyOf()`](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#copyOf(T[],%20int))：：

> 复制指定的数组，截断或填充空值（如有必要），使副本具有指定的长度。对于在原始数组和副本中都有效的所有索引，这两个数组将包含相同的值。对于在副本中有效但在原始副本中无效的任何索引，副本将包含 null。当且仅当指定长度大于原始数组的长度时，此类索引才会存在。结果数组与原始数组的类完全相同。

```
Object[] originalArray = new Object[5];   
Object[] largerArray = Arrays.copyOf(originalArray, 10); 
```

请注意，这种方法通常`System.arraycopy()` [在幕后](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8u40-b25/java/util/Arrays.java#Arrays.copyOf%28java.lang.Object%5B%5D%2Cint%2Cjava.lang.Class%29)使用。

* * *

方法 3: [`ArrayList`](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html):

> List 接口的可调整大小的数组实现。实现所有可选列表操作，并允许所有元素，包括 null。除了实现 List 接口之外，该类还提供了一些方法来操作内部用于存储列表的数组的大小。（这个类大致相当于 Vector，只是它是不同步的。）

ArrayList 的功能类似于数组，除了当您添加的元素超过它可以包含的内容时它会自动扩展。它[由 array 支持](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8u40-b25/java/util/ArrayList.java?av=f#134)，并[使用 Arrays.copyOf](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8u40-b25/java/util/ArrayList.java#ArrayList.grow%28int%29)。

```
ArrayList<Object> list = new ArrayList<>();

// This will add the element, resizing the ArrayList if necessary.
list.add(new Object()); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-11-02T14:58:08.267

您可以使用`ArrayList`which 为您完成这项工作。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-10-15T19:59:42.667

*无法更改数组大小。* 但是您可以通过创建更大尺寸的 Array 将一个数组的元素复制到另一个数组中。

*如果 Array 已满，建议创建双倍大小的 Array，如果 Array 已满一半，建议将 Array 减半*

```
public class ResizingArrayStack1 {
    private String[] s;
    private int size = 0;
    private int index = 0;

    public void ResizingArrayStack1(int size) {
        this.size = size;
        s = new String[size];
    }

    public void push(String element) {
        if (index == s.length) {
            resize(2 * s.length);
        }
        s[index] = element;
        index++;
    }

    private void resize(int capacity) {
        String[] copy = new String[capacity];
        for (int i = 0; i < s.length; i++) {
            copy[i] = s[i];
            s = copy;
        }
    }

    public static void main(String[] args) {
        ResizingArrayStack1 rs = new ResizingArrayStack1();
        rs.push("a");
        rs.push("b");
        rs.push("c");
        rs.push("d");
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-11-02T14:59:44.107

您可以使用 ArrayList 而不是数组。这样您就可以添加 n 个元素

```
 List<Integer> myVar = new ArrayList<Integer>(); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-11-02T14:59:52.473

标准类 java.util.ArrayList 是可调整大小的数组，随着新元素的添加而增长。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-02-10T00:13:06.970

您无法调整数组的大小，但可以重新定义它以保留旧值或使用 java.util.List

以下是两个解决方案，但在运行下面的代码时发现了性能差异

Java 列表快 450 倍，但内存重 20 倍！

```
testAddByteToArray1 nanoAvg:970355051 memAvg:100000
testAddByteToList1 nanoAvg:1923106 memAvg:2026856
testAddByteToArray1 nanoAvg:919582271 memAvg:100000
testAddByteToList1 nanoAvg:1922660 memAvg:2026856
testAddByteToArray1 nanoAvg:917727475 memAvg:100000
testAddByteToList1 nanoAvg:1904896 memAvg:2026856
testAddByteToArray1 nanoAvg:918483397 memAvg:100000
testAddByteToList1 nanoAvg:1907243 memAvg:2026856

```

```
import java.util.ArrayList;
import java.util.List;

public class Test {

    public static byte[] byteArray = new byte[0];
    public static List<Byte> byteList = new ArrayList<>();
    public static List<Double> nanoAvg = new ArrayList<>();
    public static List<Double> memAvg = new ArrayList<>();

    public static void addByteToArray1() {
        // >>> SOLUTION ONE <<<
        byte[] a = new byte[byteArray.length + 1];
        System.arraycopy(byteArray, 0, a, 0, byteArray.length);
        byteArray = a;
        //byteArray = Arrays.copyOf(byteArray, byteArray.length + 1); // the same as System.arraycopy()
    }

    public static void addByteToList1() {
        // >>> SOLUTION TWO <<<
        byteList.add(new Byte((byte) 0));
    }

    public static void testAddByteToList1() throws InterruptedException {
        System.gc();
        long m1 = getMemory();
        long n1 = System.nanoTime();
        for (int i = 0; i < 100000; i++) {
            addByteToList1();
        }
        long n2 = System.nanoTime();
        System.gc();
        long m2 = getMemory();
        byteList = new ArrayList<>();
        nanoAvg.add(new Double(n2 - n1));
        memAvg.add(new Double(m2 - m1));
    }

    public static void testAddByteToArray1() throws InterruptedException {
        System.gc();
        long m1 = getMemory();
        long n1 = System.nanoTime();
        for (int i = 0; i < 100000; i++) {
            addByteToArray1();
        }
        long n2 = System.nanoTime();
        System.gc();
        long m2 = getMemory();
        byteArray = new byte[0];
        nanoAvg.add(new Double(n2 - n1));
        memAvg.add(new Double(m2 - m1));
    }

    public static void resetMem() {
        nanoAvg = new ArrayList<>();
        memAvg = new ArrayList<>();
    }

    public static Double getAvg(List<Double> dl) {
        double max = Collections.max(dl);
        double min = Collections.min(dl);
        double avg = 0;
        boolean found = false;
        for (Double aDouble : dl) {
            if (aDouble < max && aDouble > min) {
                if (avg == 0) {
                    avg = aDouble;
                } else {
                    avg = (avg + aDouble) / 2d;
                }
                found = true;
            }
        }
        if (!found) {
            return getPopularElement(dl);
        }
        return avg;
    }

    public static double getPopularElement(List<Double> a) {
        int count = 1, tempCount;
        double popular = a.get(0);
        double temp = 0;
        for (int i = 0; i < (a.size() - 1); i++) {
            temp = a.get(i);
            tempCount = 0;
            for (int j = 1; j < a.size(); j++) {
                if (temp == a.get(j))
                    tempCount++;
            }
            if (tempCount > count) {
                popular = temp;
                count = tempCount;
            }
        }
        return popular;
    }

    public static void testCompare() throws InterruptedException {
        for (int j = 0; j < 4; j++) {
            for (int i = 0; i < 20; i++) {
                testAddByteToArray1();
            }
            System.out.println("testAddByteToArray1\tnanoAvg:" + getAvg(nanoAvg).longValue() + "\tmemAvg:" + getAvg(memAvg).longValue());
            resetMem();
            for (int i = 0; i < 20; i++) {
                testAddByteToList1();
            }
            System.out.println("testAddByteToList1\tnanoAvg:" + getAvg(nanoAvg).longValue() + "\t\tmemAvg:" + getAvg(memAvg).longValue());
            resetMem();
        }
    }

    private static long getMemory() {
        Runtime runtime = Runtime.getRuntime();
        return runtime.totalMemory() - runtime.freeMemory();
    }

    public static void main(String[] args) throws InterruptedException {
        testCompare();
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-07-05T13:22:09.497

您可以在某个类中尝试以下解决方案：

```
int[] a = {10, 20, 30, 40, 50, 61};

// private visibility - or change it as needed
private void resizeArray(int newLength) {
    a = Arrays.copyOf(a, a.length + newLength);
    System.out.println("New length: " + a.length);
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-07-29T23:21:11.980

无法调整数组的大小。但是，可以通过将原始数组复制到新大小的数组并保留当前元素来更改数组的大小。还可以通过删除元素和调整大小来减小数组的大小。

```
import java.util.Arrays 
public class ResizingArray {

    public static void main(String[] args) {

        String[] stringArray = new String[2] //A string array with 2 strings 
        stringArray[0] = "string1";
        stringArray[1] = "string2";

        // increase size and add string to array by copying to a temporary array
        String[] tempStringArray = Arrays.copyOf(stringArray, stringArray.length + 1);
        // Add in the new string 
        tempStringArray[2] = "string3";
        // Copy temp array to original array
        stringArray = tempStringArray;

       // decrease size by removing certain string from array (string1 for example)
       for(int i = 0; i < stringArray.length; i++) {
           if(stringArray[i] == string1) {
               stringArray[i] = stringArray[stringArray.length - 1];
               // This replaces the string to be removed with the last string in the array
               // When the array is resized by -1, The last string is removed 
               // Which is why we copied the last string to the position of the string we wanted to remove
               String[] tempStringArray2 = Arrays.copyOf(arrayString, arrayString.length - 1);
                // Set the original array to the new array
               stringArray = tempStringArray2;
           }
       }
    }    
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-10-03T20:20:22.830

抱歉，但此时无法调整数组大小，并且可能永远不会。

所以我的建议是**多**考虑找到一个解决方案，让您从流程开始就获得您需要的数组大小。这通常意味着您的代码需要更多时间（行）才能运行，但您会节省大量内存资源。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2022-02-09T11:23:21.117

我们不能使用数组数据类型来做到这一点。而是使用一个可增长的数组，它是 Java 中的 arrayList。

# jsf - 从 Java 页面流迁移到 JSF

> ID：13197703
> 
> 赞同：1
> 
> 时间：2012-11-02T14:57:17.227
> 
> 标签：jsf, weblogic, portal, migrate, beehive

我目前正在开发一个使用 WebLogic Portal 和 Apache Beehive Page Flow Controller 的项目。

该团队希望删除 WebLogic Portal 和带有 JSF 的页面流控制器。目前我们还没有找到一种方法来管理 JSF 的工作流，就像使用 PFC 一样。

使用 Spring MVC 会很容易，因为我们只使用 Spring MVC Annotations 删除 Beehive 注释，但我们想直接使用 JSF，所以稍后我们可以开始使用 icefaces。

关于我在哪里可以找到有关我们想要做什么的信息的任何建议？

非常感谢您提前。

# c# - 如何在 WinRT 中获取类的属性

> ID：13197704
> 
> 赞同：13
> 
> 时间：2012-11-02T14:57:39.457
> 
> 标签：c#, reflection, microsoft-metro, windows-runtime

我正在用 C# 和 XAML 编写一个 Windows 8 应用程序。我有一个具有许多相同类型属性的类，它们在构造函数中以相同的方式设置。我不想手动为每个属性编写和分配，我想获取我的类上某种类型的所有属性的列表，并将它们全部设置在一个 foreach 中。

在“正常”.NET 中我会写这个

```
var properties = this.GetType().GetProperties();
foreach (var property in properties)
{
    if (property.PropertyType == typeof(Tuple<string,string>))
    property.SetValue(this, j.GetTuple(property.Name));
} 
```

`j`我的构造函数的参数在哪里。在 WinRT`GetProperties()`中不存在。Intellisense for`this.GetType().`没有显示任何我可以使用的有用信息。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-02T15:00:35.907

您需要使用[`GetRuntimeProperties`](http://msdn.microsoft.com/EN-US/library/hh875138.aspx)而不是`GetProperties`：

```
var properties = this.GetType().GetRuntimeProperties();
// or, if you want only the properties declared in this class:
// var properties = this.GetType().GetTypeInfo().DeclaredProperties;
foreach (var property in properties)
{
    if (property.PropertyType == typeof(Tuple<string,string>))
    property.SetValue(this, j.GetTuple(property.Name));
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-11T21:48:56.470

尝试这个：

```
public static IEnumerable<PropertyInfo> GetAllProperties(this TypeInfo type)
{
    var list = type.DeclaredProperties.ToList();

    var subtype = type.BaseType;
    if (subtype != null)
        list.AddRange(subtype.GetTypeInfo().GetAllProperties());

    return list.ToArray();
} 
```

并像这样使用它：

```
var props = obj.GetType().GetTypeInfo().GetAllProperties(); 
```

**更新：**`GetRuntimeProperties`仅当不可用时才使用此扩展方法，因为`GetRuntimeProperties`它的作用相同，但它是一种内置方法。

# version-control - 跟踪 Dev Branch 中的更改

> ID：13197709
> 
> 赞同：0
> 
> 时间：2012-11-02T14:57:54.363
> 
> 标签：version-control, tfs, branching-and-merging

我最近开始对使用类似于 Vincent Driessens [Git 分支模型](http://nvie.com/posts/a-successful-git-branching-model/)的分支模型感兴趣。我们有多个开发人员在同一个项目上工作，因此为不同的功能使用不同的分支对我们来说是一大优势。该模型指出，在开发了一个特性之后，它会被合并回 Development 分支，并且在某个时间会从它创建一个发布分支。

现在我的问题是，我不知道自上一个版本以来谁在 dev 分支中添加了什么，但我确实想提供一个将为下一个版本实施的更改列表。所以问题是，我怎么知道 dev 分支中添加了哪些功能？

我们使用 TFS 进行版本控制。据我所知，我有以下选择：

*   更好的版本标签和评论（目前没有标签和评论）
*   将 TFS 任务链接到版本（虽然还不确定如何创建一个不错的列表）

也许我应该按照上面自己的选择，但我很好奇你们如何处理这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T23:54:46.713

首先，我建议您查看[TFS 分支和合并指南](http://vsarbranchingguide.codeplex.com/)，因为它可能会回答您的大部分问题。

> 我如何知道 dev 分支中添加了哪些功能？

我认为 Driessen 模型中的“开发”分支最接近于 TFS 指南中的“主”分支。我建议您不要将更改合并到 main 中，除非它们已经计划进入下一个版本。然后，当您准备好发布时，您只需从最新版本的 main 分支。

跟踪下一个版本的功能将由工作项跟踪系统处理。

另外，您可能会发现 Team Explorer 的[Track Work Item](http://blogs.msdn.com/b/slange/archive/2012/07/11/vs-tfs-2012-tidbits-merging-changes-by-work-item.aspx)功能很有帮助。

# gcc - 无法为 android NDK、cygwin gcc 链接静态库

> ID：13197713
> 
> 赞同：0
> 
> 时间：2012-11-02T14:58:00.357
> 
> 标签：gcc, android-ndk, cygwin, linkage

我有 PROJ4 库，在 cygwin 下成功编译并安装到 /usr/local。

我正在尝试编译为：

`$ arm-linux-androideabi-gcc -o conftest -mthumb temp.c -lproj -L/usr/local/lib -lproj -lz -lm -ldl`

`C:/dev/Android/android-ndk-r7c/android-8-toolchain/bin/../lib/gcc/arm-linux-androideabi/4.4.3/../../../../arm-linux-androideabi/bin/ld.exe: cannot find -lproj collect2: ld returned 1 exit status`

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T16:08:45.053

尝试

```
$ arm-linux-androideabi-gcc -o conftest -mthumb temp.c /usr/local/lib/libproj.a -lz -lm -ldl 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T18:43:53.283

嗯，问题是android-gcc不理解cygwin路径，所以我们需要使用windows路径：

`$ arm-linux-androideabi-gcc -o conftest -mthumb temp.c -lproj -Lc:/path/to/lib -lproj -lz -lm -ldl`

# android - Android MapView 自定义标记都是一样的大小

> ID：13197725
> 
> 赞同：2
> 
> 时间：2012-11-02T14:58:21.750
> 
> 标签：android, android-mapview, google-maps-markers, itemizedoverlay

我正在编写一个应用程序，它将显示一张带有一堆标记的地图。我希望标记是动态的（在它们上显示动态内容）。因为标记内容是动态的，所以每个标记的大小是不同的。

我在文档中发现这一点说“可以为不同的状态返回不同的标记。不同的标记可以有不同的界限。” 这里：[https://developers.google.com/maps/documentation/android/reference/com/google/android/maps/OverlayItem#getMarker(int)](https://developers.google.com/maps/documentation/android/reference/com/google/android/maps/OverlayItem#getMarker(int))

我认为这意味着同一叠加层上的多个标记可以是不同的大小。那是对的吗？

我的叠加层上有一个 ArrayList（扩展 BalloonItemizedOverlay）。叠加层的 createItem() 方法如下所示：

```
@Override
protected OverlayItem createItem(final int index)
{
    final Person person = people.get(index);
    final GeoPoint gp = new GeoPoint(person.getLat(), person.getLng());

    final OverlayItem oi = new OverlayItem(gp, person.getName(), person.getName());
    oi.setMarker(new PersonDrawable(defaultMarker, person));

    return oi;
} 
```

然后在我的`PersonDrawable`有一个drawable，它有一个9补丁作为背景图像，然后在它上面绘制文本：

```
public PersonDrawable(final Drawable iBackground, final Person person)
{
    background = iBackground;
    text = person.getName();
    padding = new Rect();

    if (background instanceof NinePatchDrawable)
    {
        // This is getting hit, and just sets the value of the padding
        final NinePatchDrawable ninePatch = (NinePatchDrawable) background;
        ninePatch.getPadding(padding);
    }

    // set the bounds of the marker
    bounds = background.getBounds();

    paint = new Paint();
    paint.setColor(Color.rgb(255, 255, 255));
    paint.setFakeBoldText(true);
    paint.setTextSize(30);

    // find the bounds of the text
    final Rect textBounds = new Rect();
    paint.getTextBounds(text, 0, text.length(), textBounds);

    // set the left and right bounds to that of the text plus the padding (then center it)
    bounds.left = 0 - (textBounds.width() / 2) - padding.left;
    bounds.right = 0 + (textBounds.width() / 2) + padding.right;

    // set the bounds of the drawable
    setBounds(bounds);
}

@Override
public void draw(final Canvas canvas)
{
    // when it's time to draw, draw the background
    background.draw(canvas);
    // then draw the text within the padding
    canvas.drawText(text, bounds.left + padding.left, bounds.bottom - padding.bottom, paint);
} 
```

每个标记都有一个不同的边界集，即使在它被绘制在覆盖上之后，它的边界也是不同的。（`MapView`或`Overlay`）没有重用来自 的对象`createItem()`。然而，`Overlay`似乎总是选择一个标记并假设这是所有标记的大小。这只是行为吗？我能做些什么来让它尊重每个标记的不同边界吗？

这里有一些图片，当它决定选择一个更大的标记时，一切正常：

![金刚狼更长，所以看起来还不错](../Images/36476cd07bab5e6fec9335c8d281cd34.png)

但是，当它选择使用较小的标记作为大小时：

![野兽有点矮，溢出来了](../Images/51428e93932e440c8073faa372e009a9.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T19:18:51.797

问题是当`Drawable`从资源加载 a 时，它被视为可共享资源。从`Drawable`文档中：

> 默认情况下，从同一资源加载的所有可绘制实例共享一个公共状态；如果您修改一个实例的状态，所有其他实例将收到相同的修改。

在 中`OverlayItem`，假设`Drawable`将始终保持相同的大小。您看到的效果是对 的最后一次修改`Drawable`覆盖了之前的所有修改，因此所有显示的`Drawable`都显示完全相同。

解决方案是防止共享`Drawable`的修改。您可以将此`mutate()`方法与从资源中多次加载 Drawable 结合使用。`PersonDrawable`您应该与上面概述的构造函数一起执行此操作。

# office365 - office 365 中是否提供外发邮件编码设置？

> ID：13197730
> 
> 赞同：1
> 
> 时间：2012-11-02T14:58:40.577
> 
> 标签：office365

由于我们在 gmail 中有外发消息编码设置，所以我们在 office 365 中是否有这样的设置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T09:52:37.370

是的，你可以 - 描述你如何做到这一点：http: [//office.microsoft.com/en-gb/outlook-help/change-message-encoding-used-to-send-messages-in-other-languages- HP005242882.aspx](http://office.microsoft.com/en-gb/outlook-help/change-message-encoding-used-to-send-messages-in-other-languages-HP005242882.aspx)

# qt - 在某个浏览器选项卡/窗口中打开 URL

> ID：13197731
> 
> 赞同：7
> 
> 时间：2012-11-02T14:58:42.933
> 
> 标签：qt, url, browser, qt4, openurl

在我的 Qt 应用程序中，我想在同一个浏览器选项卡/窗口中重复打开 URL。（以编程方式“刷新”此选项卡）

使用

```
QDesktopServices::openUrl(QUrl("http://www.domain.tld")); 
```

为每个呼叫打开一个新选项卡/窗口。是否有可能在某处添加“target=”参数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T22:37:12.833

你所要求的不可能以你想象的方式去做。[openUrl()](http://qt-project.org/doc/qt-4.8/qdesktopservices.html#openUrl)使用操作系统来指定程序以打开其文档中提到的参数。

可能有一些解决方法，但它们都不能很好地工作，或者适用于所有浏览器。只是这种细粒度的控制对你来说很可能是不可能的。

如果您想控制浏览器中的选项卡，您可以找到该选项卡所代表的窗口并在打开新选项卡之前将其关闭。这个解决方案有点hacky。

另一个 hacky 解决方案是找到保存 URL 的编辑框的 HWND，并尝试使用`SendMessage()`. 但是，这在 Chrome 上不起作用，因为它没有为 URL 窗口使用单独的控件。它可能适用于 Firefox 或 IE。

更好的解决方案是使用 Qt WebKit 制作您自己的 Web 浏览器。在其中呈现页面并更改查看的 url 非常容易。[QWebView](http://qt-project.org/doc/qt-4.8/qwebview.html#details)是一个易于使用的QtWebKit[实现](http://qt-project.org/doc/qt-4.8/qtwebkit.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-16T22:34:26.507

也许你会发现这很有用：

您可以打开网页并重新加载活动选项卡。

> 如果您提供浏览器的名称作为参数，它将找到并重新加载当前页面

[https://unix.stackexchange.com/questions/37258/refresh-reload-active-browser-tab-from-command-line](https://unix.stackexchange.com/questions/37258/refresh-reload-active-browser-tab-from-command-line)

# java - 通过调用堆栈传递数据而不修改方法

> ID：13197733
> 
> 赞同：0
> 
> 时间：2012-11-02T14:58:52.157
> 
> 标签：java, algorithm

我有一些疯狂的任务，这听起来像是不可能完成的任务。我需要通过一堆方法传递一些数据，我无法修改（只能修改最后一个）。例子：

```
SomeData someData; //not passed in method1
obj1.method1(...); 
```

这是obj1类代码

```
obj1 {
    someReturnClass method1(...) {
        ...
        obj2.method2(...);
        ...
    }
} 
```

obj2 和 method2 在到达 objN.methodM() 之前调用了更多方法。它甚至可以在单独的线程中运行（因此，ThreadLocal 无济于事）。我需要访问methodM内部的someData，它没有通过这个堆栈作为参数传递。

我有一些概念可以通过异常和双重运行方法M，但它看起来很难看。

您有什么想法，如何将 someData 传递给 methodM()？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T15:44:57.140

如果您不能以任何其他方式偷运访问——例如，通过将引用添加`SomeData`到通过调用堆栈传递的其他对象中*——*那么您最终将不得不使用全局变量。这当然是一个糟糕的设计，但考虑到您的限制，其他任何事情都是不可能的。

您在评论中提到您可能对您的方法“活动”进行了多次调用（它是递归的，还是您有多个线程？）在这种情况下，您将需要有一个全局集合，并有一些推断的方法从通过调用堆栈传递的数据*中*选择集合的哪个元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T15:03:20.643

我知道您需要访问方法激活中的局部变量，该方法您无法更改，但您知道该方法在堆栈中的位置较低。

这里显而易见的是使用 Java 调试架构：[http ://docs.oracle.com/javase/7/docs/technotes/guides/jpda/index.html](http://docs.oracle.com/javase/7/docs/technotes/guides/jpda/index.html)

这将允许您检查所有线程的堆栈。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T15:51:58.480

最后，我找到了解决方案：

创建 JAAS 主题

```
Subject subject = new Subject(); 
```

将数据放在主体的主体或凭据中的某个位置：

```
subject.getPublicCredentials().add(new String("Trololo")); 
```

在您需要的任何地方获取此主题及其数据（即使在另一个线程中也可以使用）：

```
Subject subject = Subject.getSubject(AccessController.getContext());
System.out.println(subject.getPublicCredentials()); 
```

它仅在一种情况下不起作用：线程在创建主题之前启动。

# php - 将多维数组从多个选项框传递到 mysql

> ID：13197734
> 
> 赞同：0
> 
> 时间：2012-11-02T14:58:54.233
> 
> 标签：php, html, mysql

任何帮助将非常感激。

我有一个选择/选项框将一个`$_GET`数组传递给一个 php 控制器，该控制器将该值传递给一个检索一些 MySQL 的模型。

但是，我已经到了我现在只是一厢情愿地刺痛的阶段。我认为问题出在数组上。

```
<select id="frm_type" style="margin-left:180px; width: 136px; height:100%;" name="uid[]" multiple="multiple">
    <option value="U4BC3128209B01">All Users</option>
    <option value="U4D88B8CFE7579">more options</option>        
</select> 
```

`$_GET`看起来像这样这像`?&uid%5B%5D=U4DFF15A4581A4&uid%5B%5D=U4D88B8CFE7579` 这样进入控制器......

`$filter_in = $_GET;`

然后像这样被调用到模型中。

`$body_data['user_stats'] = $this->mtvm_model->user_stats($filter_in);`

然后最后想要使用它的相关部分执行此操作：

```
 if ($filter_in['uid'] != '')
        {
        $sqlQuery .= " AND ";

        foreach($filter_in['uid'] as $key=>$value)
            {
            $sqlQuery .= " ".$this->tables_calls.".userId = '".mysql_real_escape_string($value)."' ";
            if($key != count($filter_in['uid'])-1) 
                {
                $sqlQuery .= " OR ";
                }
            }
        } 
```

仅仅是我错误地尝试将数组传递为`$filter_in['uid']`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T15:15:28.590

查询字符串：

```
uid%5B%5D=U4DFF15A4581A4&uid%5B%5D=U4D88B8CFE7579 
```

意味着`$_GET["uid"]`看起来像这样：

```
Array
(
    [0] => U4BC3128209B01
    [1] => U4D88B8CFE7579
) 
```

你应该像这样检查这个变量的存在：

```
if (isset($filter_in['uid']) && is_array($filter_in['uid'])) {
    // ... 
```

# java - 持久性类中的构造函数

> ID：13197743
> 
> 赞同：0
> 
> 时间：2012-11-02T14:59:40.963
> 
> 标签：java, hibernate

我正在使用 HIbernate 版本 3.2.5。

我在休眠教程中阅读了以下行：

`The no-argument constructor is a requirement for all persistent classes.Hibernate has to create objects for you, using Java Reflection. The constructor can be private`

这是教程的链接：

[http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/tutorial.html](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/tutorial.html)

但是当我编写一个没有无参数构造函数的持久性类时，它也可以正常工作（我只尝试了检索部分）。

因此，上述陈述的有效性在哪里？

请让我知道我是否穿了一些东西。

问候，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T15:00:28.930

如果您在持久类中没有任何构造函数，JVM 默认为您创建无参数构造函数，这就是您的代码运行良好的原因。

阅读本[教程](http://docs.oracle.com/javase/tutorial/java/javaOO/constructors.html)以了解有关构造函数的更多信息。

# twitter - 使用 Twitteroauth 获取 Twitter 用户信息

> ID：13197745
> 
> 赞同：1
> 
> 时间：2012-11-02T14:59:44.937
> 
> 标签：twitter, twitter-oauth

当用户使用其 Twitter 帐户登录时，我使用以下代码设置一些会话：

```
 $twitteroauth = new TwitterOAuth(YOUR_CONSUMER_KEY, YOUR_CONSUMER_SECRET, $_SESSION['oauth_token'], $_SESSION['oauth_token_secret']);
    $access_token = $twitteroauth->getAccessToken($_GET['oauth_verifier']);     
    $_SESSION['access_token'] = $access_token;

    $user_info = $twitteroauth->get('account/verify_credentials'); 
```

如您所见，我将所有令牌（令牌、秘密令牌和访问令牌）存储在会话中，以便稍后当用户想要更改他的个人资料图片时使用它

但是当我想再次访问用户信息时......我无法访问它。我再次建立 twitteroauth 连接，但现在使用登录期间存储的会话：

```
 $twitteroauth = new TwitterOAuth(YOUR_CONSUMER_KEY, YOUR_CONSUMER_SECRET, $_SESSION['oauth_token'], $_SESSION['oauth_token_secret']);
    $access_token = $_SESSION['access_token'];
    $user_info = $twitteroauth->get('account/verify_credentials');

    if (isset($user_info->error)) {

        echo "token:", $_SESSION['oauth_token'], "<br>";
        echo "token_secret:", $_SESSION['oauth_token_secret'], "<br>";
        echo "access-token:", $access_token, "<br>";

         echo "error";

    }  else { 

    echo "oke";

    } 
```

我收到错误回声。当我回显我的令牌字符串时，所有字符串都包含数据，并且访问令牌包含值“数组”。

有人知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T04:07:59.520

您需要使用 print_r 打印数组值。

# javascript - JavaScript 在函数执行时冻结浏览器

> ID：13197746
> 
> 赞同：0
> 
> 时间：2012-11-02T14:59:49.930
> 
> 标签：javascript

我正在开发一个充当数据库查询工具的网页。数据库表的大小非常大（26MB），因此我决定将表中的每一行作为 JavaScipt 对象存储在一个数组中（以防止数据的连续传输）。

页面加载没有问题。当我开始“查询”JavaScript 对象数组时，麻烦就开始了。

下面的函数在 HTML 文本框的 keyup 事件上执行。当此函数执行时，它会导致浏览器变得无响应并暂时冻结，直到函数完成执行。我以前读过使用 setTimeout() 和 setInterval() 函数来克服这个问题，但我无法使这些适应我自己的问题。

```
function searchStock() {
    results.innerHTML = "Stock Loading..."; //results is a div tag where query results are displayed
    var stringTyped = nameTextBox.value;
    var resultString = "<table>";
    for (var z = 0; z < stock.length; z++) //stock is the array of objects to be searched
    {
        if (stringTyped == "") {
            resultString = resultString + rows[z]; //rows is an array consisting of how each item in the stock is displayed
        }
        else {
            if (stock[z].Stock_Name.indexOf(stringTyped) != -1) {
                resultString = resultString + rows[z];
            }
        }
    }
    resultString = resultString + "</table>";
    results.innerHTML = resultString;
}​ 
```

# ruby-on-rails - PhantomJS 1.4.0 版本问题

> ID：13197747
> 
> 赞同：3
> 
> 时间：2012-11-02T14:59:50.667
> 
> 标签：ruby-on-rails, ruby, phantomjs

我今天安装了 PhantomJS 并在尝试使用它时遇到了这个错误：

```
PhantomJS version 1.4.0
is too old. You must use at least version 1.7.0  
(Capybara::Poltergeist::PhantomJSTooOld) 
```

如何安装较新的版本？

我可以在以下位置*获得*更新的版本 (1.7)： http: [//phantomjs.org/download.html](http://phantomjs.org/download.html)

一旦我下载了它，我该如何实际安装它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T17:00:15.700

您使用的是 Linux 还是 OS X？您需要从源代码构建或安装更新的 PhantomJS 包。您还可以下载二进制文件并安装在已安装 PhantomJS 的系统上。键入“which phantomjs”，它应该显示 PhantomJS 的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T20:41:47.170

如果您使用的是自制软件，只需：

```
brew upgrade phantomjs 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T19:14:54.947

我昨天不得不解决这个问题，它需要我更新 brew，告诉 brew 卸载 phantomJS，然后更新 xcode，然后安装最新的 xcode 命令实用程序，然后使用 brew 重新安装 phantomjs。终于让它引入了最新版本。你可以试试这个（mac）：

1.  酿造更新
2.  brew卸载phantomjs
3.  brew doctor（如果有的话，请遵循它推荐的修复程序......我的正在更新 xcode）
4.  酿造安装 phantomjs

那时它应该抓住最新的。

祝你好运！

# vb.net - 拆分字符串并插入换行符

> ID：13197750
> 
> 赞同：0
> 
> 时间：2012-11-02T14:59:53.747
> 
> 标签：vb.net, string, insert, split

我有一串说 2000 个字符的字符串，我如何将屏幕拆分为 70 个字符并为我尝试的前 70 个字符的每 70 行插入换行符，并且工作正常，如下所示：

```
Dim notes As String = ""
        If (clmAck.Notes.Count > 70) Then
            notes = clmAck.Notes.Insert(70, Environment.NewLine)
        Else 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T15:16:25.640

我现在写这个是为了好玩：

```
public static class StringExtension
{
    public static string InsertSpaced(this string stringToinsertInto, int spacing, string stringToInsert)
    {
        StringBuilder stringBuilder = new StringBuilder(stringToinsertInto);
        int i = 0;
        while (i + spacing < stringBuilder.Length)
        {
            stringBuilder.Insert(i + spacing, stringToInsert);
            i += spacing + stringToInsert.Length;
        }
        return stringBuilder.ToString();
    }
} 
```

```
[TestCase("123456789")]
public void InsertNewLinesTest(string arg)
{
    Console.WriteLine(arg.InsertSpaced(2,Environment.NewLine));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T15:18:59.047

它是 C#，但应该很容易翻译：

```
string notes = "";
var lines = new StringBuilder();

while (notes.Length > 0)
{
    int length = Math.Min(notes.Length, 70);
    lines.AppendLine(notes.Substring(0, length));

    notes = notes.Remove(0, length);
}

notes = lines.ToString(); 
```

# html - Soundcloud 播放器小部件使页面瘫痪

> ID：13197751
> 
> 赞同：2
> 
> 时间：2012-11-02T14:59:56.563
> 
> 标签：html, iframe, soundcloud

我在页面上有一个 soundcloud 播放器小部件，它导致页面运行非常缓慢。当鼠标悬停在按钮上时，光标需要很长时间才能改变，并且在播放歌曲时页面上的其他功能变得无法使用。歌曲停止时一切正常。

即使是这个简单的 HTML 页面也存在问题，从鼠标悬停在播放器按钮上时非常缓慢的变化可以看出这一点。我已经在具有各种浏览器的 PC 和 iMac 上进行了尝试。

```
<html>
<head>
</head>
<body>
<iframe width="100%" height="166" scrolling="no" frameborder="no" src="http://w.soundcloud.com/player/?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F61858057&amp;auto_play=true&amp;show_artwork=true&amp;color=ff6c00"></iframe>
</body>
</html> 
```

最近有没有其他人遇到过这个问题？Soundcloud 的任何人都可以对此有所了解吗？

# python - 让这个战斗引擎工作？

> ID：13197752
> 
> 赞同：0
> 
> 时间：2012-11-02T14:59:56.750
> 
> 标签：python

目前卡在 Zed Shaw 的[LPTHW](http://www.learnpythonthehardway.org)的第 36 次练习中，我真的可以使用一些帮助来弄清楚为什么我制作的这个战斗引擎不起作用。我重写了之前的尝试，试图让它更清楚。这是我相信的相关代码，如果它太长，我很抱歉，但作为一个新手，我不完全确定什么是相关的。

```
#Check to hit and applies damage / crit + damage use p for player and m for monster

def hit_check(x):

    global current_hp, monster_current_hp, to_hit, monster_to_hit, crit
    global monster_crit, dmg, monster, monster_dmg

    if x == 'p':
        if d20() >= to_hit and d100() <= crit:
            monster_current_hp = monster_current_hp - dmg * 3
            print "You critically wounded the %s!" % monster
            next()
        elif d20() >= to_hit and d100() > crit:
            monster_current_hp = monster_current_hp - dmg
            print "You wounded the %s!" % monster
            next()
        else: 
            print "You missed the %s." % monster
            next()
    elif x == 'm': 
        if d20() >= monster_to_hit and d100() <= monster_crit:
            current_hp = current_hp - monster_dmg * 3
            print "The %s critically wonded %s!" % (monster, name)
            next()
        elif d20() >= to_hit and d100() > crit:
            current_hp = current_hp - dmg
            print "The %s wounded %s." % (monster, name)
            next()
        else:
            print "The %s missed %s." % (monster, name)
            next()
    else:
        print "Ray diddnt correctly assign a hit check"
        exit(0)

# Combat engine / prompt

def combat_engine():

    global current_hp, monster_current_hp, wins, gold, hit_points, p, m

    """Will choose a monster, and then allow the player to fight monster"""

    global current_hp, monster_current_hp, prompt

    if wins == 0:
        choose_monster(level_zero_monsters)
    elif wins == 1: 
        choose_monster(level_one_monsters)
    elif wins == 2:
        choose_monster(level_two_monsters)
    elif wins == 3: 
        choose_monster(level_three_monsters)
    elif wins == 4:
        choose_monster(level_four_monsters)
    else:
        print "bug in choosing monsters over wins"
        exit(0)

    print """
Welcome  %s to the Arena

Today you will be fighting a %s

Description of monster: %s
          """ % (name, monster, description)
    next()

    running = True

    while running:
        if current_hp > 0 and monster_current_hp > 0:
            prompt = raw_input("Type 'a' to attack, 's' for stats, 'q' for quit :> ")
            if prompt == 'a':
                hit_check('p')
                hit_check('m')
        elif current_hp <= 0:
            break
            print "You were killed by the %s, better luck next time."
            exit()
        elif monster_current_hp <= 0: 
            break
            print "You defeated the %s! Great Job!"
            next()
            if wins == 0:
                gold_earned = d6() + 2
            elif wins == 1:
                gold_earned = d6() + d6() + 2
            elif wins == 2:
                gold_earned = d6() + d6() + 4
            elif wins == 3:
                gold_earned = d6() + d6() + 5
            elif wins == 4:
                gold_earned = d6() + d6() + 6
            else:
                break
                print "There is a bug you have wins than allowed"
                exit(0)

            gold = gold + gold_earned
            print "You win %d gold, you have %d gold total." % (gold_earned,
                                                                gold)
            wins = wins + 1
            hit_points = hit_points + d6()
            hit_points = current_hp
            print "You feel hardier. You make your way back to the barracks."
            next()
            barracks()

        else:
            break
            print "Bug in combat engine"
            exit(0) 
```

当我在这里运行这个是终端打印的内容时，出于某种原因转储到我的代码的库存方。

```
Welcome  Ray to the Arena

Today you will be fighting a goblin

Description of monster: A tiny miserable creature that lives to eat shit.

Press Enter To Continue...
Type 'a' to attack, 's' for stats, 'q' for quit :> a
You missed the goblin.
Press Enter To Continue...
The goblin missed Ray.
Press Enter To Continue...
Type 'a' to attack, 's' for stats, 'q' for quit :> a
You wounded the goblin!
Press Enter To Continue...
The goblin wounded Ray.
Press Enter To Continue...

Your current weapon is now a dagger. Press Enter To Continue

logout

[Process completed] 
```

任何有关如何解决此问题的帮助或建议将不胜感激。

编辑：这是整个代码，所以人们可以让它运行。

```
# Imports, lots of imports, 

from random import randint

from random import choice

import pprint

from sys import exit

#Setting some core stats
wins = 0
times_trained = 0
gold = randint(1, 3) + 2

#Some Quips for the barracks
def gladiator_quips():

    q = []
    q.append('A warrior grunts, "A sword is more versatile than other weapons."')
    q.append('A rogue remarks "Oi I heard that training improves your primary skills."')
    q.append('A wench stats "At least you can fight for your freedom %s."' % character_class)
    q.append('A drunk sings you a song of the legend of Doobieus poorly.')
    q.append('A guard remarks how his polearm gets more lucky hits')
    q.append('A slave mentions that maces pack a heavy punch.')
    q.append('A barkeep laments "I need a vacation."')
    q.append('A one eyed gladiator recalls his youth before slavers killed his family.')
    q.append('A child remarks how training can affect abilities.')
    quips = choice(q)
    print quips

#nice little function that brings up the next page prompt
def next():
    raw_input("Press Enter To Continue...")

# Barracks need to restrict training after training. Also need to 
# add training restrictions. 
def barracks():
    print  """
Welcome to the barracks %s
                                                    ^^^^ ^^^^^^^^^^^^^^^^
                                                   >----<|arena|training|>
 ~                     MMM    ~                   <|shop<| _   |   __   |>
{ } mmm      ~~~      [~~~]  { } mmm      ~~~     <|    <|{}\  |  /{}\  |>
{ } |||D   _______    [~~~]  { } |||D   _______   <|     -||-  |  -||-  |>
{ } |||   <uuuuuuu>   [~~~]  { } |||   <uuuuuuu>  <|     |||   |   ||   |>
-------------------------------------------------------------------------

There are several other gladiators moving around, you may 'talk' to them.

You can take a look at your 'stats' 

You can 'shop' for new weapons. 

You may enroll in skill 'training' nearby.

You may face your next opponent in the 'arena'.

You may give up on your quest for freedom & 'quit'
""" % name

    answer = raw_input(":> ")
    if "talk" in answer:
        gladiator_quips()
        next()
        barracks()
    elif "stats" in answer:
        pp = pprint.PrettyPrinter(indent=30)
        pp.pprint(character_sheet)
        next()
        barracks()
    elif "training" in answer:
        if times_trained == 0: 
            train()
        else:
            print "The training center is now closed."
            next()
            barracks()
    elif "arena" in answer:
        combat_engine()

    elif "quit" in answer:
        print "You are now a slave forever. Goodbye %s." % name
        exit(0)
    elif "shop" in answer:
        if wins == 0:
            print "The shop is closed for the day, you must win your first fight"
            next()
            barracks()  
        elif wins == 1:
            buy_weapon(level_one_weapons)
        elif wins == 2:
            buy_weapon(level_two_weapons)
        elif wins == 3:
            buy_weapon(level_three_weapons)
        elif wins == 4:
            buy_weapon(level_four_weapons)
        else:
            print "Ray left a bug somewhere. Ballz."
            exit(0)
    else:
        print "I didn't understand %s, please try again." % answer
        next()
        barracks()

#training code
def train_code(stat):
    if check != 1:
        gold = gold - 7
        character_sheet.remove(character_sheet[9])
        character_sheet.insert(9, "You have %d gold pieces." % gold)
        times_trained = 1
        stat = stat + 1
        if stat == str:
            character_sheet.remove(character_sheet[3])
            character_sheet.insert(3, "Strength: %s" % str)
        elif stat == dex:
            character_sheet.remove(character_sheet[4])
            character_sheet.insert(3, "Dexterity: %s" % dex)
        elif stat == con:
            character_sheet.remove(character_sheet[5])
            character_sheet.insert(3, "Constiution: %s" % cond)
        else:
            print "Ray left a stupid bug somewhere"

        print "You feel stronger and return to the barracks as training closes."
        next()
        barracks()

    else: 
        times_trained = 1
        gold = gold - 7
        character_sheet.remove(character_sheet[9])
        character_sheet.insert(9, "You have %s gold pieces." % gold)
        print "You feel like the training was useless. You return to the barracks as training closes."
        next()
        barracks()

# training room
def train():
    global gold, str, dex, con
    print  """
Welcome %s to the training center.
You currently have %d gold pieces.

You may enroll in one class before each battle.

Keep in mind, there is a chance you will fail to learn anything.

Training costs 7 gold pieces.

You may train 'str', 'dex', or 'con'

Type 'quit' if you wish to return to the barracks.

Which stat do you wish to train?
    """ % (name, gold)

    answer = raw_input(":> ")
    check = randint(1, 6)
    if 'str' in answer and gold >= 7:
        train_code(str)
    elif 'dex' in answer and gold >= 7:
        train_code(dex)
    elif 'con' in answer and gold >= 7:
        train_code(con)
    elif 'quit' in answer:
        print "You leave the training area."
        next()
        barracks()
    else: 
        print """"You either dont have enough gold (%s gp,) or you typed in an error (%s)
""" % (gold, answer)
        next()
        train()

#dice
def d20():
    return randint(1, 20)

def d100():
    return randint(1, 100)  

def d6():
    return randint(1, 6)    

# Doing Stuff for weapons and the shopkeeper. #################################

def level_zero_price():
    """Generates the price for level one weapons"""
    return randint(1, 3)

def level_one_price():
    """Generates the price for level two weapons"""
    return randint(3, 6)

def level_two_price():
    """Generates the price for level three weapons"""
    return randint(6, 9)

def level_three_price():
    """Generates the price for level four weapons"""
    return randint(9, 12)

def level_four_price():
    "Generates the price for level four weapons"""
    return randint(12, 15)

#weapon inventory code

def weapon_code(weapons):
    global current_weapon
    weapon_choice = raw_input(":> ")
    if weapons[0] in weapon_choice and gold >= sword_price:
        gold_math(agile_price) 
        if wins != 0:
            character_sheet.remove(character_sheet[10])
        else:
            current_weapon = weapons[2]
            inventory(weapons[2])   
            character_sheet.append("Current Weapon: %s" % current_weapon)
            barracks()

    elif weapons[1] in weapon_choice and gold >= blunt_price:
        gold_math(agile_price) 
        if wins != 0:
            character_sheet.remove(character_sheet[10])
        else:
            current_weapon = weapons[2]
            inventory(weapons[2])   
            character_sheet.append("Current Weapon: %s" % current_weapon)
            barracks()

    elif weapons[2] in weapon_choice and gold >= agile_price:
        gold_math(agile_price) 
        if wins != 0:
            character_sheet.remove(character_sheet[10])
        else:
            current_weapon = weapons[2]
            inventory(weapons[2])   
            character_sheet.append("Current Weapon: %s" % current_weapon)
            barracks()

    elif "quit" in weapon_choice and wins != 0:
            barracks()

    elif "quit" in weapon_choice and wins == 0:
        print "You must buy a weapon first before you can go to the barracks."
        next()
        buy_weapon(level_zero_weapons)

    else: 
        print "Either you dont have enough money, or I dont know what %s means" % weapon_choice
        next()
        buy_weapon(weapons)

# price display
def prices(weapons):
    print  """
Please type in the weapon you want to buy.

%s, price: %d gold pieces

%s, price: %d gold pieces

%s, price: %d gold pieces.
""" % (weapons[0], sword_price, weapons[1], blunt_price,weapons[2], 
       agile_price)

# gold buying
def gold_math(weapon_price):
    global gold
    character_sheet.remove(character_sheet[9])
    gold = gold - weapon_price
    character_sheet.insert(9, "You have %s gold pieces." % gold) 

### Shop / buy weapons room ###############

def buy_weapon(weapons):
    global gold, sword_price, blunt_price, agile_price, current_weapon
    """big bit of code that allows you to buy a weapons from a weapon list.
The function acts a little differently after level zero weapons"""
    global current_weapon
    if weapons == level_zero_weapons:
        sword_price = level_zero_price()
        blunt_price = level_zero_price()
        agile_price = level_zero_price()

        prices(level_zero_weapons)
        weapon_code(level_zero_weapons)

    elif weapons == level_one_weapons:
        sword_price = level_one_price()
        blunt_price = level_one_price()
        agile_price = level_one_price()

        prices(level_one_weapons)
        weapon_code(level_one_weapons)

    elif weapons == level_two_weapons:
        sword_price = level_two_price()
        blunt_price = level_two_price()
        agile_price = level_two_price()

        prices(level_two_weapons)
        weapon_code(level_two_weapons)

    elif weapons == level_three_weapons:
        sword_price = level_three_price()
        blunt_price = level_three_price()
        agile_price = level_three_price()

        prices(level_three_weapons)
        weapon_code(level_three_weapons)

    elif weapons == level_four_weapons:
        sword_price = level_four_price()
        blunt_price = level_four_price()
        agile_price = level_four_price()

        prices(level_four_weapons)
        weapon_code(level_four_weapons)

    else:
        print"~~~There is a bug somwhere, forgot to assign (weapons)\n\n\n"
    raw_input("""
Your current weapon is now a %s. Press Enter To Continue
""" % current_weapon)

def inventory(current_weapon):
    """Attaches modifiers to secondary stats according to current weapon """
    global mod_dmg, mod_crit

    if current_weapon == level_zero_weapons[0]:
        mod_dmg = dmg
        mod_crit = crit
    elif current_weapon == level_zero_weapons[1]:
        mod_dmg = dmg + 1
        mod_crit = crit
    elif current_weapon == level_zero_weapons[2]:
        mod_dmg = dmg
        mod_crit = crit + 3
    elif current_weapon == level_one_weapons[0]:
        mod_dmg = dmg + 1
        mod_crit = crit + 3
    elif current_weapon == level_one_weapons[1]:
        mod_dmg = dmg + 2
        mod_crit = crit
    elif current_weapon == level_one_weapons[2]:
        mod_dmg = dmg
        mod_crit = crit + 5
    elif current_weapon == level_two_weapons[0]:
        mod_dmg = dmg + 1
        mod_crit = crit + 5
    elif current_weapon == level_two_weapons[1]:
        mod_dmg = dmg + 3
        mod_crit = crit 
    elif current_weapon == level_two_weapons[2]:
        mod_dmg = dmg
        mod_dmg = crit + 6
    elif current_weapon == level_three_weapons[0]:
        mod_dmg = dmg + 2
        mod_crit = crit + 5
    elif current_weapon == level_three_weapons[1]: 
        mod_dmg = dmg + 4
        mod_crit = crit + 3
    elif current_weapon == level_three_weapons[2]:
        mod_dmg = dmg + 1
        mod_crit = + 8
    elif current_weapon == level_four_weapons[0]:
        mod_dmg = dmg + 3
        mod_crit = crit + 7
    elif current_weapon == level_four_weapons[1]:
        mod_dmg = dmg + 5
        mod_crit = crit + 5
    elif current_weapon == level_four_weapons[2]:
        mod_dmg = dmg + 2
        mod_crit = crit + 10
    else: 
        print"There is a bug, ray forgot a weapon or typed shit wrong."
        exit(0)

#End Of Buying / Inventory functions ########################################## 

#function for monster damage

def monster_dice(a, b):
    return randint(a, b)

#Function for monster stats
def monster_stats(a, b, c, d):  
    global monster_current_hp, monster_crit, monster_dmg, monster_to_hit
    monster_current_hp = a
    monster_crit = b
    monster_dmg = monster_dice(1, c)
    monster_to_hit = d

# Chooses a random monster and sets stats
def choose_monster(monster_list):
    global monster, description
    if monster_list == level_zero_monsters:
        monster = choice(level_zero_monsters)
        if monster == 'wolf':
            monster_stats(4, 5, 6, 12)
            description = "A small and angry dog like creature."
        elif monster == 'goblin':
            monster_stats(5, 7, 5, 10)
            description = "A tiny miserable creature that lives to eat shit."
        elif monster == 'kobold':
            monster_stats(6, 10, 4, 9)
            description = "A small humaniod lizard, very sneaky and annoying"
        else:
            print "Bug in choose monster level 0"
            exit(0)

    elif monster_list == level_one_monsters:
        monster = choice(level_one_monsters)
        if monster == 'orc':
            monster_stats(6, 8, 6, 10)
            description = "A human sized horrid creature, smells awful."
        elif monster == 'gnoll':
            monster_stats(7, 10, 8, 12)
            description = "A large humanoid dog, they can cackle for hours."
        elif monster == 'giant ant':
            monster_stats(8, 7, 7, 11)
            description = "A large and terrifying insect, it makes clicking noises."
        else:
            print "Bug in choose monster level 1"
            exit(0)

    elif monster_list == level_two_monsters:
        enemy = choice(level_two_monsters)
        if monster == 'wight':
            monster_stats(9, 10, 10, 12)
            description = "A powerful undead warrior, terrifying in size."
        elif monster == 'komodo dragon':
            monster_stats(7, 12, 8, 10)
            description = "A deadly man sized lizard, very sharp teeth."
        elif monster == 'ogre':
            monster_stats(10, 5, 12, 11)
            description = "A Big and strong stupid ogre."
        else:
            print "Bug in monster level 2"

    elif monster_list == level_three_weapons:
        monster = choice(level_three_monsters)
        if monster == 'troll':
            monster_stats(12, 7, 12, 11)
        elif monster == 'owlbear':
            monster_stats(10, 12, 11, 10)
        elif monster == 'dark priest':
            monster_stats(9, 13, 10, 9) 
        else:
            print "Bug in monster level 3"

    elif monster_list == level_four_monsters:
        monster = choice(level_four_monsters)
        if monster == 'dark wizard':
            monster_stats(11, 15, 12, 9)
        elif monster == 'hydra':
            monster_stats(12, 14, 15, 10)
        elif monster == 'stone golem':
            monster_stats(15, 13, 13, 11)
        else:
            print "Problem with monster level 4"
    else:
        print "Ray left diddnt assign a correct combat(argv)"
        exit(0)

#Check to hit and applies damage / crit + damage use p for player and m for monster

def hit_check(x):

    global current_hp, monster_current_hp, to_hit, monster_to_hit, crit
    global monster_crit, dmg, monster, monster_dmg

    if x == 'p':
        if d20() >= to_hit and d100() <= crit:
            monster_current_hp = monster_current_hp - dmg * 3
            print "You critically wounded the %s!" % monster
            next()
        elif d20() >= to_hit and d100() > crit:
            monster_current_hp = monster_current_hp - dmg
            print "You wounded the %s!" % monster
            next()
        else: 
            print "You missed the %s." % monster
            next()
    elif x == 'm': 
        if d20() >= monster_to_hit and d100() <= monster_crit:
            current_hp = current_hp - monster_dmg * 3
            print "The %s critically wonded %s!" % (monster, name)
            next()
        elif d20() >= to_hit and d100() > crit:
            current_hp = current_hp - dmg
            print "The %s wounded %s." % (monster, name)
            next()
        else:
            print "The %s missed %s." % (monster, name)
            next()
    else:
        print "Ray diddnt correctly assign a hit check"
        exit(0)

# Combat engine / prompt

def combat_engine():

    global current_hp, monster_current_hp, wins, gold, hit_points, p, m

    """Will choose a monster, and then allow the player to fight monster"""

    global current_hp, monster_current_hp, prompt

    if wins == 0:
        choose_monster(level_zero_monsters)
    elif wins == 1: 
        choose_monster(level_one_monsters)
    elif wins == 2:
        choose_monster(level_two_monsters)
    elif wins == 3: 
        choose_monster(level_three_monsters)
    elif wins == 4:
        choose_monster(level_four_monsters)
    else:
        print "bug in choosing monsters over wins"
        exit(0)

    print """
Welcome  %s to the Arena

Today you will be fighting a %s

Description of monster: %s
          """ % (name, monster, description)
    next()

    running = True

    while running:
        if current_hp > 0 and monster_current_hp > 0:
            prompt = raw_input("Type 'a' to attack, 's' for stats, 'q' for quit :> ")
            if prompt == 'a':
                hit_check('p')
                hit_check('m')
        elif current_hp <= 0:
            break
            print "You were killed by the %s, better luck next time."
            exit()
        elif monster_current_hp <= 0: 
            break
            print "You defeated the %s! Great Job!"
            next()
            if wins == 0:
                gold_earned = d6() + 2
            elif wins == 1:
                gold_earned = d6() + d6() + 2
            elif wins == 2:
                gold_earned = d6() + d6() + 4
            elif wins == 3:
                gold_earned = d6() + d6() + 5
            elif wins == 4:
                gold_earned = d6() + d6() + 6
            else:
                break
                print "There is a bug you have wins than allowed"
                exit(0)

            gold = gold + gold_earned
            print "You win %d gold, you have %d gold total." % (gold_earned,
                                                                gold)
            wins = wins + 1
            hit_points = hit_points + d6()
            hit_points = current_hp
            print "You feel hardier. You make your way back to the barracks."
            next()
            barracks()

        else:
            break
            print "Bug in combat engine"
            exit(0)

def you_win():
 print  """
 YOU WIN!

 CONGRATULATIONS! 

 THANKS FOR PLAYING!
 """        

# Monster List
level_zero_monsters = ['wolf', 'goblin', 'kobold']
level_one_monsters = ['orc', 'gnoll', 'giant ant',]
level_two_monsters = ['wight', 'komodo dragon', 'ogre']
level_three_monsters = ['troll', 'owlbear', 'dark priest']
level_four_monsters = ['dark wizard', 'hydra', 'stone golem']

# Weapon lists 
level_zero_weapons = ['short sword', 'club', 'dagger']
level_one_weapons = ['sword', 'mace', 'rapier']
level_two_weapons = ['long sword', 'morningstar', 'trident']
level_three_weapons = ['claymore', 'flail', 'sycthe']
level_four_weapons = ['bastard sword', 'dragon bone', 'crystal halbred']

def roll_3d6():
    """This rolls 3D6, and returns the sum."""
    return randint(1, 6) + randint(1, 6) + randint(1, 6)

def character_gen():
    """Creates A character and also can call character sheet"""
    global name, str, dex, con, hit_points, dmg, crit, character_class
    global gender, damage_print, current_hp, character_sheet, to_hit

    character_sheet = []
    name = raw_input("Please tell me your name brave soul. :> ")

    print "\n\t\tLets now randomly generate brave gladiator %s." % name

    str = roll_3d6()
    if str > 12:
        dmg = randint(1, 6) + 1
        damage_print = "1D6 + 1"
    else:
        dmg = randint(1, 6)
        damage_print = "1D6"

    dex = roll_3d6()
    if dex >= 13:
        crit = 15
        to_hit = 9
    elif dex >= 9 and dex <=12:
        crit = 10
        to_hit = 10
    else:
        crit = 10
        to_hit = 11

    con = roll_3d6()
    if con > 14:
        hit_points = 8
        current_hp = hit_points
    else:
        hit_points =  6
        current_hp = hit_points

    if str >= dex:
        character_class = "Warrior"
    else:
        character_class = "Rogue"

    random_gender = randint(1, 2)
    if random_gender == 1:
        gender = "Male"
    else:
        gender = "Female"   

    character_sheet.append("Name: %s:" % name)  
    character_sheet.append("Gender: %s" % gender)
    character_sheet.append("Character Class: %s" % character_class)
    character_sheet.append("Strength: %s" % str)
    character_sheet.append("Dexterity: %s" % dex)
    character_sheet.append("Constitution: %s" % con)
    character_sheet.append("Damage %s" % damage_print)
    character_sheet.append("Crit Chance {}%".format(crit))
    character_sheet.append("Hit Points: %s/%s" % (hit_points, current_hp))
    character_sheet.append("You have %s gold pieces." % gold)

    pp = pprint.PrettyPrinter(indent=30)
    pp.pprint(character_sheet)
    raw_input("Please Press Enter To Buy A Weapon")
    buy_weapon(level_zero_weapons)

#main
character_gen() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T18:15:51.657

以下是您的程序流程的概要：

`character_gen`呼唤`buy_weapon`，呼唤`weapon_code`，呼唤`barracks`，呼唤`combat_engine`。在内部`combat_engine`，一旦你将敌人的生命值降低到零或以下，它就会执行第二个`elif`分支，其第一条语句是`break`。该语句导致`combat_engine`'while 循环终止。`combat_engine`结束，所以控制返回到`barracks`。`barracks`结束，所以控制返回到`weapon_code`。`weapon_code`结束，所以控制返回到`buy_weapon`。`buy_weapon`执行调用后发生的任何代码`weapon_code`，即这一行：

```
raw_input("""
Your current weapon is now a %s. Press Enter To Continue
""" % current_weapon) 
```

`buy_weapon`结束，控制返回`character_gen`。`character_gen`结束并且控制返回到主模块。主模块结束，您的程序终止。这解释了为什么你得到你得到的输出。

至于修复它，我建议两件事：

1.  继续阅读`break`以确认它正在做你认为它正在做的事情。例如，break 之后的任何内容`print "You defeated the %s! Great Job!"`在任何情况下都不会执行。
2.  有关代码的整体流程，请查看[State Machines](http://en.wikipedia.org/wiki/State_machine)。兵营/库存/等不是功能，而是每个都应该是它们自己的状态，用户的输入决定要转换到哪个状态。按照您现在的方式，您将在大约 500 次操作后遇到堆栈溢出。

# algorithm - 生成“有效”数字

> ID：13197755
> 
> 赞同：1
> 
> 时间：2012-11-02T15:00:05.050
> 
> 标签：algorithm

我在一次采访中被问到以下问题。我不知道如何解决这个问题。有什么建议么？

> 给定开始和结束整数作为用户输入，生成具有以下属性的所有整数。
> 
> 例子：
> 
> ```
> 123 , 1+2 = 3 , valid number
> 121224 12+12 = 24 , valid number
> 1235 1+2 = 3 , 2+3 = 5 , valid number
> 125 1+2 <5 , invalid number 
> ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T15:13:02.050

实现这一点的几种方法是：

1.  测试输入范围内的每个数字，看看它是否符合条件。

2.  仅生成符合条件的数字。对两个起始值使用嵌套循环，将循环索引的总和附加到循环索引以得出合格数。当附加数字超过上限时退出内部循环。

第二种方法可能计算效率更高，但第一种方法更易于编写和维护，并且是 O(n)。

我不知道面试官在寻找什么，但我怀疑沟通能力比答案更重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T15:15:48.713

解决这个问题的简单方法是迭代设置范围内的数字，将数字解析为数字序列，然后根据规则测试序列。有一个优化，该问题本质上要求您找到斐波那契数，因此您可以使用两个变量或寄存器并按顺序添加它们。

从您的问题中不清楚组件编号是否必须具有相同的位数。如果没有，那么您将必须生成组件编号排列的所有组合。

# java - 同步方法递归调用自身。这是坏了吗？

> ID：13197756
> 
> 赞同：31
> 
> 时间：2012-11-02T15:00:06.467
> 
> 标签：java, recursion, synchronized

这个问题的重点是说明 Java 没有按我的预期工作。

您希望以下代码的行为如何？

```
public class SynchTester {
  private static SynchTester synchTester;

  public synchronized static SynchTester getSynchTester(){
    if(synchTester==null){
      synchTester = new SynchTester();
    }

    return synchTester;
  }

  private SynchTester() {
    SynchTester myTester = getSynchTester();
  }

  public static void main(String[] args) {
    SynchTester tester = SynchTester.getSynchTester();
  }
} 
```

我希望它在等待递归完成时会出现死锁，但它会抛出 StackOverflow。显然同步不会阻止对同一线程的访问。

这是一个错误吗？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-11-02T15:09:27.883

在 Java 中，同步锁是[可重入](http://en.wikipedia.org/wiki/Reentrancy_%28computing%29)的。

> 回想一下，一个线程不能获得另一个线程拥有的锁。**但是线程可以获取它已经拥有的锁**。允许一个线程多次获取同一个锁可以实现重入同步。这描述了一种情况，同步代码直接或间接调用一个也包含同步代码的方法，并且两组代码都使用相同的锁。如果没有可重入同步，同步代码将不得不采取许多额外的预防措施来避免线程导致自身阻塞。

*来源：见[本页底部](http://docs.oracle.com/javase/tutorial/essential/concurrency/locksync.html)*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-02T15:07:58.503

同步方法需要能够获得对监视器对象的锁定。监视器对象是实例（或静态方法的类）。已经拥有锁的线程不需要再次获取它。所以是的，这可能会导致堆栈溢出（harhar）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-02T15:09:20.973

来自[java教程](http://docs.oracle.com/javase/tutorial/essential/concurrency/syncmeth.html)：

> 当一个线程正在为一个对象执行同步方法时，所有其他为同一对象调用同步方法的线程都会阻塞（暂停执行），直到第一个线程处理完该对象。

所以我认为 syncronized 关键字按预期工作，同步递归调用在 java 中是完全合法的（并且有效）。

# javascript - 获取错误未转义'-'

> ID：13197758
> 
> 赞同：-1
> 
> 时间：2012-11-02T15:00:09.880
> 
> 标签：javascript

> **可能重复：**
> [出现错误：jshint 中未转义的“-”](https://stackoverflow.com/questions/13196436/getting-error-unescaped-in-jshint)

```
Line 5: var filter = /^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i; 
```

得到错误：`Unescaped '-'`。

有谁知道问题出在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T15:02:28.770

字符类中的连字符需要转义，它们是元字符。

```
/^([\w\-]+(?:\.[\w\-]+)*)@((?:[\w\-]+\.)*\w[\w\-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T15:01:58.377

```
[\w-] 
```

该字符不能在 char 类中未转义

通常你会这样使用它`[a-z]`

# javascript - html中的表格边框

> ID：13197773
> 
> 赞同：1
> 
> 时间：2012-11-02T15:00:52.527
> 
> 标签：javascript, html, css

我正在尝试创建一个带有圆形边框的表格，但仅在底部。我正在使用这个 CSS 编码器：

```
#table_rounded_white{
            border-style: solid; 
            /*border-top-style: none;*/
            border-width: 1px;
            border-color: #8E8C8C;
            border-radius: 15px;
            -moz-border-radius: 15px;
            -webkit-border-radius: 15px;
            background-color: #FFFFFF;
            padding: 10px;
        } 
```

我需要的是在不四舍五入的情况下做顶部边框。

有人知道如何做到这一点？

谢谢你

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-02T15:02:20.610

而不是为每个角定义所有半径：

```
border-radius: 15px;
-moz-border-radius: 15px; 
```

只定义你需要的半径：

```
-webkit-border-bottom-right-radius: 15px;
-webkit-border-bottom-left-radius: 15px;
-moz-border-radius-bottomright: 15px;
-moz-border-radius-bottomleft: 15px;
border-bottom-right-radius: 15px;
border-bottom-left-radius: 15px; 
```

这是一个快速生成样式的便捷工具：http: [//border-radius.com/](http://border-radius.com/)

# php - Jquery ajax没有来自php的响应

> ID：13197774
> 
> 赞同：0
> 
> 时间：2012-11-02T15:00:58.727
> 
> 标签：php, jquery, ajax

我有一个模式对话框中的表单。当我提交表单时，我没有收到来自 php.ini 的响应。我知道表单和脚本正在运行，因为我可以在对话框之外运行它们并且一切正常。

这是我的表单html代码：

```
 <div id="add_user">
        <form action="resetProcess.php" method="post">
          <input type="hidden" name="action" value="Reset Password" />
          <table width="385" border="0" cellspacing="0" cellpadding="3">
            <tr>
              <td colspan="3">
                </td>
              </tr>
            <tr>
              <td width="191" align="right"><label for="firstname2">First name *</label></td>
              <td width="194" colspan="2"><input type="text" name="firstname" id="firstname2" value="" /></td>
              </tr>
            <tr>
              <td align="right"><label for="lastname2">Last name *</label></td>
              <td colspan="2"><input type="text" name="lastname" id="lastname" value="" /></td>
              </tr>
            <tr>
              <td align="right"><label for="email2">Email address *</label></td>
              <td colspan="2"><input type="text" name="email" id="email" value="" /></td>
              </tr>
            <tr>
              <td colspan="3" style="padding-top:20px;">
              <input  type="submit" name="action1" id="requestButton" value="Get Email" /></tr>
            </table>
        </form>

</div> 
```

这是php进程文件。请记住，这可以正常工作，因为它是在它自己的浏览器窗口中提交的。

```
<?php 
    // Required files
    include("includes/common.inc.php");
    require_once( "users.class.php" );

    session_start();

// check if the reset password form has been submitted.
if ( isset( $_POST["action1"] ) and $_POST["action"] == "Reset Password" ) {    

      $user = new User( array(
        "firstname" => isset( $_POST["firstname"] ) ? preg_replace( "/[^ \-\_a-zA-Z0-9]/", "", $_POST["firstname"] ) : "",                  
        "lastname" => isset( $_POST["lastname"] ) ? preg_replace( "/[^ \-\_a-zA-Z0-9]/", "", $_POST["lastname"] ) : "",
        "email" => isset( $_POST["email"] ) ? preg_replace( "/[^ \-\_a-zA-Z0-9]@/", "", $_POST["email"] ) : "",

      ) );

$existingUser = User::getByEmailAddress( $user->getValue( "email"));

  if ($existingUser) {
  var_dump($existingUser);
  echo "Success!!  Your Request has been sent!";
  } else {
  echo "That email address does not match anyone in our system.  Please go back and re-enter your information.";
  }
}

?> 
```

这是头文件中包含的js代码：

```
 <script>
// increase the default animation speed to exaggerate the effect
$.fx.speeds._default = 1000;
$(function() {
    $( "#dialog" ).dialog({
        autoOpen: false,
        show: "fade",
        hide: "fade",
        width: "400px",
    });

    $( "#reset-form" ).click(function() {
        $( "#dialog" ).dialog( "open" );
        return false;

    });

    // Hide Form error labels
    $('.error').hide();

    $('#requestButton').click(function(e){
        e.preventDefault();
        var firstname = $('#firstname').val();
        if (firstname == "") {
            $('label#firstname_error').show();
            $('label#firstname').focus();
            return false;
        }
        var lastname = $('#lastname').val();
        if (lastname == "") {
            $('label#lastname_error').show();
            $('label#lastname').focus();
            return false;
        }
        var email = $('#email').val();
        if (email == "") {
            $('label#email_error').show();
            $('label#email').focus();
            return false;
        }
        var dataString = 'firstname=' + firstname + '&lastname=' + lastname + '&email=' + email;

        // ajax call
        $.ajax({
            type: "POST",
            url: "resetProcess.php",
            data: dataString,
            success: function(result){
                //$("#passRequest").fadeOut(500, function(){
                    console.log("Result: " + result);
                //});
            },
        });    
        return false;
    });

    });
    </script> 
```

最后，我将包含类文件中的查询方法：

```
 public static function getByEmailAddress( $email ) {
            $conn = parent::connect();
            $sql = "SELECT * FROM " . TBL_USERS . " WHERE email = :email";

            try {
              $st = $conn->prepare( $sql );
              $st->bindValue( ":email", $email, PDO::PARAM_STR );
              $st->execute();
              $row = $st->fetch();
              parent::disconnect( $conn );
              if ( $row ) return new User( $row );
            } catch ( PDOException $e ) {
              parent::disconnect( $conn );
              die( "Query failed: " . $e->getMessage() );
            }
          } 
```

谢谢您的帮助！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T16:25:52.123

问题是 php 脚本正在检查以确保提交按钮已通过，并且还设置了其他隐藏字段。

```
// check if the reset password form has been submitted. 
```

if ( isset( $_POST["action1"] ) 和 $_POST["action"] == "重置密码" )

这不是与 AJAX Post 请求一起发送的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T15:06:17.810

为什么不发送这样的数据呢？

```
$.ajax({
    type: "POST",
    url: "resetProcess.php",
    data: {
        'firstname': firstname,
        'lastname': lastname,
        'email': email
    },
    success: function(result) {
        //$("#passRequest").fadeOut(500, function(){
        console.log("Result: " + result);
        //});
    },
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T15:06:22.417

我认为你实际上是在做一个 get 请求，但指定 post。

在您的 ajax 调用中传递这个而不是字符串：

```
var data = {
    'firstname': firstname,
    'lastname': lastname,
    'email': email
} 
```

或者您更改您的方法以发布并保留 get-query-string 原样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-02T16:01:03.013

我会检查所需的文件是否正确包含/需要，

```
// Required files
include("includes/common.inc.php");
require_once( "users.class.php" ); 
```

因为也许您访问 resetProcess.php 文件的方式与没有 ajax 的方式不同。您可以通过检查 User 类是否实际存在来检查它。

# prettyphoto - 在 prettyphoto 中打开幻灯片图像

> ID：13197777
> 
> 赞同：1
> 
> 时间：2012-11-02T15:01:05.503
> 
> 标签：prettyphoto

我想为下面函数输出的链接添加一个 rel 属性。它来自我正在尝试自定义的幻灯片插件。我希望幻灯片/图像在单击时在漂亮照片中打开。插件的图片链接开头是这样的：a style="" href=""。我希望他们这样开始：a rel=prettyPhoto[pics] style="" href="" ....

有人可以帮我吗？

我想要这些图片：[http](http://www.publicnewshub.com/volvo-v40-revealed/) ://www.publicnewshub.com/volvo-v40-revealed/ 像这样打开：[http ://www.publicnewshub.com/jub-jub-co-accused-guilty/](http://www.publicnewshub.com/jub-jub-co-accused-guilty/)

```
loadEls: function () {
    function _(_, B) {
        var $ = new RegExp("\\[a((.*?)\\[\\/a\\]", "gi"),
            A = _.match($);
        $J.$A(A).j14(function (D) {
            if (B.textEffect == "fixed" && (new RegExp("href", "gi")).test(D)) {
                var A = D + "",
                    C = new RegExp('^.*?href=\\"([^\\"]+)\\".*$', "gi");
                href = D.replace(C, "$1");
                if ((new RegExp("onclick", "gi")).test(A)) {
                    C = new RegExp('onclick=\\"([^\\"]+)\\"', "gi");
                    A = A.replace(C, "onclick=\"$1;document.location.href='" + href + "';\"");
                    A = A.replace($, "<a $1>$2</a>");
                } else {
                    A = A.replace($, "<a $1 onclick=\"document.location.href='" + href + "';\">$2</a>");
                }
            } else {
                return A = D.replace($, "<a $1>$2</a>");
            }
            _ = _.split(D).join(A);
        });
        return _; 
```

# django - 用于向模型实例发布更新的 Django URL 设计

> ID：13197779
> 
> 赞同：1
> 
> 时间：2012-11-02T15:01:06.470
> 
> 标签：django, django-views, django-urls

假设我定义了以下模型：

```
class Location(models.Model):
    name = models.CharField(max_length=20)
    longitude = models.CharField(max_length=30)
    latitude = models.CharField(max_length=30) 
```

并且有一个现有的 Location 实例`id=1`

我想针对此实例发布更新，但我不确定应该如何将 pk/id 发送到服务器。我有两个想法。

1.  将其作为 url 的一部分包括在内（例如`^update_location/(?P<pk>[0-9]+)/$'`）。
2.  将其与用于更新其他属性的值一起包含在 POST 数据中。

我的问题是为什么我要选择一个而不是另一个？

我更倾向于选项 1，因为默认情况下，`django.views.generic.edit.UpdateView`我正在使用的通用视图支持它。但是后来我还是不知道怎么选。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T15:03:34.417

选项 1 使 python 更容易，因为 reverse() 将使 url 很好。

选项 2 使 javascript 更容易，因为它不必组成 url 和 POST 数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T15:09:33.977

我会说你可以这样做：

```
url(r'^update_location/(?P<location_id>\d+)/$', 'location.views.update'), 
```

然后在你看来：

```
def detail(request, location_id):
    // do whatever needed with location_id object
    location = Location.objects.get(id=location_id)
    return HttpResponse("You're updating location %s." % location_id) 
```

关于表单处理，您可以查看： [https ://docs.djangoproject.com/en/dev/topics/forms/?from=olddocs](https://docs.djangoproject.com/en/dev/topics/forms/?from=olddocs)

# sql-server - Service Broker：设计两个 SQL 服务器之间的通信

> ID：13197781
> 
> 赞同：1
> 
> 时间：2012-11-02T15:01:10.663
> 
> 标签：sql-server, service-broker

**目标：**将连续生成的记录可靠地传输到中央 SQL。

**总结：**卫星需要向中央询问自己这边的最新数据是什么，然后它会不断地发送更新的数据。

卫星 SQL 服务器有时可能会（重新）启动（与物理生产机器有关），中央 SQL 机器可能会运行更长时间，但也可能会有一些停机时间。这些线路大多是可靠的，但人们永远不知道......我希望SQL Server 服务代理能够*自然*地解决连接问题。但是，我需要解决初始握手和发送数据的问题。我需要设计协议，而我的 SSB 知识仍然很差。

我希望我了解使用 SSB 进行通信的基础知识，这些基础知识被很好地简要描述为

> 您应该从每个工作项开始进行自己的对话。生产者（发起者）开始对话并发送描述工作项的消息，然后提交。消费者（目标）接收消息（或被激活），检查有效负载以了解工作项详细信息，执行工作，然后结束对话并提交。生成的 EndDialog 消息被发送回发起者服务队列，发起者队列上的一个激活过程通过结束发起者端的对话来响应它。

... 由 Remus Rusanu 撰写（如果有兴趣，请参阅[他之前的回答中的更多详细信息](https://stackoverflow.com/a/1263999/1346705)）。

我想将记录作为这样的 XML 消息发送（此处为多行字符串）

```
<row a="1" b="11" c="111" />
<row a="2" b="22" c="222" />
<row a="3" b="33" c="333" />
<row a="4" b="44" c="444" /> 
```

而且我已经学会[了如何编写`SELECT`从 XML 消息中获取信息的方法](https://stackoverflow.com/a/11579148/1346705)。

**通信：**假设SQL服务器之间的通信机制刚刚激活......

1.  卫星 SQL 获得了新数据，不知怎的，它知道卫星和中央之间没有待处理的消息。但它也不知道哪些数据已经发送到中央。因此，它必须询问中央它最后可用的数据是什么。

2.  如果我理解`END CONVERSATION`正确，该命令会导致仅发送一种空消息`N'http://schemas.microsoft.com/SQL/ServiceBroker/EndDialog'`。因此，中央可能应该`ReplyMessage`在`END CONVERSATION`.

3.  同时，卫星可能不应该做任何异步行为（即在发送后等待`RequestMessage`）。一旦`ReplyMessage`到达，它就会激活一个卫星程序，该程序：

    *   接收消息并获得想要的信息，
    *   接收到 EndDialog 消息并在卫星端结束之前的对话，
    *   准备要发送到中央的数据（XML 字符串形式），
    *   打开新对话框，
    *   发送准备好的数据，
    *   并让自己处于休眠状态，直到另一个`ReplyMessage`人到来。
4.  中央应该有类似的行为。一旦`RequestMessage`到达，它就会激活中央程序：

    *   接收请求消息，
    *   提取 XML 信息并更新中央数据库，
    *   获取有关卫星最后可用数据的信息，
    *   形成并发送`ReplyMessage`,
    *   在中间结束对话。

到目前为止，我的观点正确吗？

**现在有一些我不确定的细节：**因为我想让它变得健壮，在没有人为接触的情况下工作，它应该在安装机制时自行启动。通信应始终由卫星启动（即使卫星工作甚至存在，中央也可能不知道）。

卫星已经使用由原始数据触发的触发器，该触发器被处理以构建在中央收集的记录。这样，触发器可以以某种方式向中心发起卫星的第一个 SSB 请求。但...

*   触发器如何检查卫星和中央之间没有挂起的通信？由于卫星始终是发起者，问题也可以表述为……触发器如何检查卫星是否等待一些`ReplyMessage`？或者，如何知道卫星和中央之间有一些开放的对话？
    *   如果没有对话，触发器形成数据记录（存储在本地表中），然后它可以启动通信过程（参见上面的第 1 点）。
    *   如果有任何对话，触发器只会形成稍后要发送的记录，不会做任何其他事情。`ReplyMessage`当通过激活的程序获得时，将发送数据（参见上面的第 3 点）。
*   关于*使卫星休眠*（参见上面第 3 点的最后一个项目符号），我的意思是消息队列中可能没有其他消息（循环中没有要处理的内容），并且激活的过程自然会完成。但我不确定我在这里是否正确地思考。你能对此发表评论吗？
*   如果没有任何问题，并且数据产生的速度足够快，那么卫星和中央总有一些东西可以交换。这样，触发器永远不应该尝试开始通信。
*   当激活的卫星程序没有其他内容要发送到中央时（实际上，它不是活动的），或者当系统以某种方式重新启动（尚不存在对话）时，触发器启动通信过程。但我怎么能做到呢？触发器是否应该简单地将 发送`RequestMessage`到中央？（这种方式`ReplyMessage`将激活卫星程序，并且程序将继续，直到有任何事情要处理。）
*   比如说，这里的`RequestMessage`手段*是一些数据，处理它们，然后回复最后一个*（或者下一个应该发送什么或者从中央推荐下一个动作——取决于业务逻辑，在这里可能并不重要）。在*我不知道您还需要什么*的意义上发送*空 XML*是否可以 - 告诉我？`RequestMessage`

 ***第一次更新**- 基于[以下 Remus Rusanu 的回答](https://stackoverflow.com/a/13198768/1346705)。

我不得不同意这将是*健谈*的协议。此外，这些记录是作为来自真实环境的温度样本创建的，并且采样频率相当低。这意味着复杂的协议只有在重启一切的特殊情况下才有用。

*但是当对话应该永远*打开时，对话句柄的唯一标识符应该永久存储在某个配置表中，或者它甚至可以硬连线到代码中。触发器将立即即时发送记录，而中央根本不会发送`ReplyMessage`. 这是对的吗？这种覆盖可以有效地被认为是独白吗？

**第二次更新**使这个问题相当简短。

请参阅续篇[Service Broker：触发器应如何启动无限打开的对话框？](https://stackoverflow.com/q/13203389/1346705)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T15:55:48.987

> 我需要解决初始握手和发送数据的问题。

我无法告诉你阅读这篇文章是如何带回 2004 年的闪存的……当时我们在设计发布-订阅协议（“独白”与“对话”），其中一个设计要点是要求“检查点”。这样想：“发布者”分发项目目录。它最初将目录的内容作为*检查点*消息发送，然后继续将任何更新发送到目录（添加或删除的项目、价格变化等）作为*更新*消息。每当有人订阅此发布时，它都需要获取检查点消息和所有后续更新消息，以便他的目录是最新的。随着时间的推移，更新列表变得非常长，因此发布者会定期重新发送当前目录状态作为“检查点”。后续订阅者只需要最后一个检查点，以及此后的任何更新。此外，发布者基础设施可以删除在最后一个检查点之前发送的所有消息，因为订阅者将不再需要它。这解决了新订阅者加入“中间”数据流并获得一致状态的问题。问题（和解决方案）与 SQL Server 本身处理日志记录和恢复的方式没有什么不同（并且名称“检查点”并非巧合......）。现在当然，

我将您提出的消息交换模式总结如下：卫星需要向中心站询问中心的当前状态（“水印”）。它以典型的请求-响应模式执行此操作：BEGIN_TRAN->BEGIN_DIALOG->SEND_Request->COMMIT 在发送方，Activation->BEGIN_TRAN->RECEIVE->SEND_Response->END->COMMIT 在接收方大小，Activation->BEGIN_TRAN ->RECEIVE->END->COMMIT 在发送方。

一般来说，这是一个不错的模式，但我认为这不是你想要的模式。你最终会得到类似这样的结果：*对于卫星拥有的每一条新信息，它都会询问中心：“你已经拥有了吗？” 然后中心会回复“嗯，是的，我愿意”或“不，请发给我”*. 这是一个令人难以置信的健谈协议，涉及为最终从卫星到中心的每条信息交换大量消息。我认为您应该长时间保持对话畅通，将其视为沟通渠道。一旦建立，卫星将在每次有一些新信息时简单地发送数据。您不需要询问中心状态，这是 SSB 的工作，以确保您发送的任何内容都到达中心，即使存在网络故障。*在 SSB 编程中*，开始对话、发送 1MM 消息并将其保持打开状态是完全可以的。3 个月后发送另一条 1MM 消息也是如此。甚至在系统断开 2 周并且只能在感恩节之后才能真正传递消息的情况下这样做。那是*正是*SSB 旨在处理的内容。问题是您的程序代码也应该准备好处理这个问题（即永远不要等待回复，它可能会在...... 2周内出现）。

关于 SSB 编程模型的更多信息。通常，任何时候都没有任何人积极地“等待”任何事情，SSB 编程就是对事件的响应。激活模型更接近现在的“函数式编程”。想想 node.js。您的绝大多数代码将依赖于激活的程序。您的代码应始终采用以下形式：“开始事务->接收消息->从数据库中读取消息所属项目的当前状态->确定结果->更新数据库状态->发送响应（如果有）->提交- >退出。onyl 异常是您拥有的触发器之类的东西，即在此激活驱动程序的乒乓球中注入新消息的代码。这个代码（触发器）永远不应该等待它发送的任何响应。它应该发送并继续。对此触发器的 SEND 的任何响应都应通过激活来处理。异步，再次。想想 C# 的新 await async。*

# java - 如何在 java swing 中创建下载按钮/链接？

> ID：13197786
> 
> 赞同：1
> 
> 时间：2012-11-02T15:01:23.283
> 
> 标签：java, swing, download

有没有办法在 java swing 上创建一个下载按钮？我尝试在互联网上搜索答案，但我只得到有关如何在 jsp/servlet 上创建下载链接的链接

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-02T15:13:34.057

创建一个 JButton，其 ActionListeners ActionPerformed 函数执行文件下载。

这是有关如何使用 Java 从 url 下载文件的 stackoverflow 链接

[如何使用 Java 从 Internet 下载和保存文件？](https://stackoverflow.com/questions/921262/how-to-download-and-save-a-file-from-internet-using-java)

这是一个示例，未测试

```
...
JButton jb = new JButton('Download Button');
jb.addActionListener(new ActionListener() {
    public void actionPerformed(ActionEvent e) {
        // Download file
        URL url = new URL('www.example.com/example_file.jpg');
        File f = new File('...');
        org.apache.commons.io.FileUtils.copyURLToFile(url, f);
    }
});
... 
```

# rabbitmq - RabbitMQ 无法使用 windows server 2008 R2 上的管理插件发布消息

> ID：13197790
> 
> 赞同：0
> 
> 时间：2012-11-02T15:01:38.260
> 
> 标签：rabbitmq, windows-server-2008-r2

我需要使用管理 UI 发布一些测试消息。

我可以在我的 Windows 7 机器上的“队列”部分看到“发布消息”，但在 Windows Server 2008 R2 上看不到。

我在两台机器上都以相同的方式安装了 RabbitMQ。

有任何想法吗？

# mysql - 语法错误：意外的 $q

> ID：13197791
> 
> 赞同：1
> 
> 时间：2012-11-02T15:01:49.040
> 
> 标签：mysql

我收到语法错误，$q 行出现意外 $q ..

```
<?php
$sql = "SELECT title FROM `PREFIX_GOOGLEMAPZZZ_markers`"
$q = mysql_query($sql)
echo "<select name=\"title\">";
echo "<option size =30 ></option>";
while ($row = mysql_fetch_array($q)) {
echo "<option value='" . $row['title'] . "'>" . $row['title'] . "</option>";
}
echo "</select>";
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T15:03:16.500

您在这些行的末尾缺少分号。

```
 $sql = "SELECT title FROM `PREFIX_GOOGLEMAPZZZ_markers`";
 $q = mysql_query($sql); 
```

# javascript - 处理 node.js 中 require() 模块抛出的错误

> ID：13197795
> 
> 赞同：74
> 
> 时间：2012-11-02T15:02:05.643
> 
> 标签：javascript, node.js, error-handling

尝试 require() 不存在的模块时，我的代码中有一些障碍。代码循环遍历一个目录并对`var appname = require('path')`每个文件夹执行一次。这适用于适当配置的模块，但会抛出：`Error: Cannot find module`当循环遇到非模块时。

我希望能够优雅地处理这个错误，而不是让它停止我的整个过程。简而言之，如何捕获由 引发的错误`require()`？

谢谢！

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-11-03T23:48:51.727

看起来像 try/catch 块可以解决这个问题，例如

```
try {
 // a path we KNOW is totally bogus and not a module
 require('./apps/npm-debug.log/app.js')
}
catch (e) {
 console.log('oh no big error')
 console.log(e)
} 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2016-08-11T00:04:27.123

> 如果给定的路径不存在，require() 将抛出一个错误，其代码属性设置为“MODULE_NOT_FOUND”。

[https://nodejs.org/api/modules.html#modules_file_modules](https://nodejs.org/api/modules.html#modules_file_modules)

所以在 try catch 块中做一个要求并检查`error.code == 'MODULE_NOT_FOUND'`

```
var m;
try {
    m = require(modulePath);
} catch (e) {
    if (e.code !== 'MODULE_NOT_FOUND') {
        throw e;
    }
    m = backupModule;
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2015-11-30T18:02:19.380

使用包装函数：

```
function requireF(modulePath){ // force require
    try {
     return require(modulePath);
    }
    catch (e) {
     console.log('requireF(): The file "' + modulePath + '".js could not be loaded.');
     return false;
    }
} 
```

用法：

```
requireF('./modules/non-existent-module'); 
```

当然基于OP的答案

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-03-30T14:34:36.100

如果问题出在不存在的文件上，您应该做的是：

```
let fs = require('fs');
let path = require('path');
let requiredModule = null; // or a default object {}

let pathToModule = path.join(__dirname, /* path to module */, 'moduleName');
if (fs.existsSync(pathToModule)) {
  requiredModule = require(pathToModule);
}

// This is in case the module is in node_modules
pathToModule = path.join(__dirname, 'node_modules', 'moduleName');
if (fs.existsSync(pathToModule)) {
  requiredModule = require(pathToModule);
} 
```

# c++ - C++ 不输出... +1 否定

> ID：13197801
> 
> 赞同：-5
> 
> 时间：2012-11-02T15:02:23.183
> 
> 标签：c++

我如何制作输出NOT（x）的程序？

例子：

*   12到3
*   0到1
*   2比1

解释：

*   1100 至 0011
*   0到1
*   01 至 10

    `printf("%i\n%i\n%i\n", ~12, ~0, ~2);`

印刷：

```
-13
-1
-3

printf("%i\n%i\n%i\n", !12, !0, !2); 
```

印刷：

```
0
1
0 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-02T15:10:58.960

您对 printf 的可变参数被提升为`int`，将其视为首先将您的位存储在变量中（int），*然后*对它们执行位而不是：

```
int x = 12;     // 0x0000000C
int y = ~x;     // 0xFFFFFFF4 
```

y 现在是负符号 int 值。

将您的格式字符串和值更改为无符号，它可能更接近您正在寻找的内容：

```
int main(int argc, char *argv[])
{
    unsigned int x = 12;
    unsigned int y = ~x;
    printf("%u:%u\n",x,y);
    return EXIT_SUCCESS;
} 
```

结果：

```
12:4294967283 
```

如果您正在寻找打印值的实际“位”的功能，可以[在这里找到](https://stackoverflow.com/questions/111928/is-there-a-printf-converter-to-print-in-binary-format)一个很好的起点，因为 printf() 没有本机位二进制打印功能。

最后，如果您对翻转感兴趣的只是最重要的非零位，请务必在输入值为零 (0) 时对您的情况进行特殊处理。你真的需要一个“这么多位对我来说很重要”的价值来真正做到这一点。

**编辑**：一个非常低效的位串：显然，如果没有**数字类型** 作为前导模板参数，这将不起作用。自行决定使用（和危险）。

```
template<typename T, size_t N=sizeof(T)*8>
std::string bit_string(T value, size_t maxbits=N)
{
    static const char *one = "1";
    static const char *zero = "0";
    std::string result;

    maxbits = std::min(maxbits, N);
    for (size_t i=0;i<maxbits;i++)
    {
        result = ((value & T(1)) ? one : zero) + result;
        value >>= 1;
    }
    return result;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-02T15:12:48.980

您的第一个示例之所以如此工作，是因为负数[的二进制补码二进制表示法。](http://en.wikipedia.org/wiki/Two%27s_complement)

例如，该值`12`实际上将表示为`0000000000001100`一个 16 位整数，并且很可能实际上是一个 32 位整数。这个值的位非是`1111111111110011`，这是`-13`二进制补码。

您的第二个示例代码使用布尔非运算符。C++ 将任何非零值视为真，而“非真”的值始终`false`为 或整数`0`。同样，`!0`表示“非假”并将`-1`作为 C++ 的“标准真”值返回。（使用此值是因为`!0 == -1`在二进制补码中，所以`!false`和`~false`是等价的操作。）

所以：你打算做的事情比你想象的要复杂。您所说的“NOT(x)”实际上是“二进制数的按位非，截断为有效数字的最小数量，并解释为无符号数。” 这并不像你说的那么简单！

有效数字部分尤为重要。如果所有数字都是 8 位无符号数，则 "NOT(2)" 实际上`253` *不是*（如您所说）`1`。

有趣的是，您的定义意味着 NOT 不再可逆：`NOT(NOT(12))`is not `12`，但实际上会`NOT(12) = 3`and then `NOT(3) =`**`0`**。

所以，为了实现你想要的：

1.  计算出原始数字的最高位是多少（这是小于原始数字的 2 的最大幂？）。（表示此值以`sd`供稍后使用。）
2.  按位反转您的原始数字
3.  按位与结果`2 ^ (sd) - 1`

例如，使用数字`12`：

1.  最高有效数字是`4`(2 ^ 4 = 16)
2.  倒数（假设为 16 位）是`1111111111110011`
3.  `2 ^ 4 - 1 = 15`二进制是`0000000000001111`
4.  `1111111111110011 AND 0000000000001111 == 0000000000000011`这就是你想要的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T15:11:05.190

好吧，如果你想翻转 int 中的所有位，你可以从 中减去值`int max`，或者翻转一个短，从`short max`... 至少我认为这就是你要问的。

# java - ObjectInputStream.readObject 导致 EOFException

> ID：13197805
> 
> 赞同：0
> 
> 时间：2012-11-02T15:02:33.517
> 
> 标签：java, io

我正在编写一个简单的客户端-服务器应用程序，其中服务器打开一个线程，该线程监视文件创建的目录。这些文件是序列化的对象。线程应该反序列化它们，读取数据并创建一个新对象以将其发送给客户端。所以总的来说它工作得很好，但有时我会得到：

> java.io.ObjectInputStream$BlockDataInputStream.peekByte(ObjectInputStream.java:2571) 的 java.io.EOFException 在 java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1315) 在 java.io.ObjectInputStream.readObject(ObjectInputStream.java: 369) 在 ServerSend.start(ServerSend.java:58) 在 ServerSend.run(ServerSend.java:25) 在 java.lang.Thread.run(Thread.java:722)

但为什么会这样？为什么只是有时......我阅读对象的程序的一部分：

```
FileInputStream fileStream = new FileInputStream(dirpath+"/"+t);
ObjectInputStream ois = new ObjectInputStream(fileStream);
Object toSend = ois.readObject(); 
```

[pastebin 上的源代码](http://pastebin.com/5kcQAcik)

其他一些程序创建这些对象，我的 StreamReader 想要读取：

```
FileOutputStream fileStream = new FileOutputStream(filepath_to_where_listening);
            ObjectOutputStream oos = new ObjectOutputStream(fileStream);
            oos.writeObject(mmout); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T15:07:16.623

该文件是原子创建的吗？或者您是否有可能在创建文件时正在读取文件？

您可以创建带有`.tmp`扩展名的文件（例如），然后在文件完成后删除扩展名。这取决于使用的文件系统，但我希望这对于大多数（全部？）Unix/Linux 文件系统来说是原子的。

或者，您的写入过程可以写入文件，然后写入相应的标志文件，这表明它已完成写入序列化对象（例如`objectfile.ser`and `objectfile.ser.done`）

另一种解决方案（非常不确定）是监视文件，然后在读取文件之前等待指定的时间，以允许它完成创建。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T15:07:53.793

可能由两种情况引起

*   文件未正确关闭，导致文件末尾被截断。如果文件被丢弃，GC 可以为你关闭文件，但这种行为是不可靠的。
*   ObjectOutputStream writeXxxx 而 ObjectInputStream readYyyy 其中 Xxxx 不是 Yyyy。例如 writeObject 和 readInt 将导致此错误。

# java - 仅在循环中每百万次执行一条语句

> ID：13197806
> 
> 赞同：0
> 
> 时间：2012-11-02T15:02:38.940
> 
> 标签：java, while-loop

我有一个运行大约 1000 万次的 while 循环，每次都会增加一个变量“天”。我希望程序仅在经过一百万天后才打印一行（即

100万天过去了

200万天过去了

...

循环完成

到目前为止，我有代码：

```
double dayMill; //outside the loop
...
dayMill = day/1000000; //every runthrough of the loop 
```

我正在考虑使用 if 语句来处理类似的事情

```
if( (int)dayMill == dayMill){} 
```

因为当 day = 1,000,000 然后 daymill = 1 所以转换为 int 它也是 1。但是，这不起作用。它打印了 00 万天......很多直到 1.0 很多......我想要的每一百万都不仅仅是一行

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-02T15:04:16.987

```
if(dayMill % 1000000 == 0)
{
    //print statement
} 
```

也就是说，如果您将 dayMill 设为 int。如果你加一，为什么它是双倍的？我想我真的不明白你在做什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T15:04:35.030

怎么样

```
if (day % 1000000 == 0) {...} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-02T15:05:26.877

无论您的循环索引是什么，

```
if (index % 1000000 == 0)
{
    // do your magic
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-02T15:05:31.800

您可以使用模数

```
for (long i = 1; ; i++) {
    if (i % 1000000 == 0)
        System.out.println(i);

} 
```

印刷

```
1000000
2000000
3000000
4000000
5000000
6000000
7000000
... etc ... 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-02T15:07:16.707

或者....

```
i++;
if(i == 1000000) {
    print stuff;
    i=0;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-02T15:07:34.960

我会做的是：

```
int count = 0;
int times = 1_000_000;
while (true) {
    ....
    if ( ++count % times == 0 ) {
       ...
    }
} 
```

# php - 删除和替换图像文件但仍显示旧图像

> ID：13197811
> 
> 赞同：3
> 
> 时间：2012-11-02T15:02:47.380
> 
> 标签：php, codeigniter, file-upload

我有一个脚本，用于删除/更新显示的图像文件。

问题是，它们正在被删除和替换（当我签入特定目录时），但在该特定 url 上显示的图像仍然是旧图像。

即我在删除旧文件（1.jpg，它是灰色的）后，目录是这样的：

![在此处输入图像描述](../Images/55a06426025a5c101197d98e0dc835ec.png)

但是，网址仍然显示 1.jpg 作为旧的灰色 img，即 ![在此处输入图像描述](../Images/e2ad261cbd701db90c6a2468e188925a.png)

现在，您可能认为我正在查找错误的 url 并添加/编辑另一个文件，但为了确认，我在同一目录中添加了一个 foo.html 文件并将 1.jpg 替换为 foo.html 以确认我在正确的目录中，我是。

我的编辑替换文件的脚本是这样的：

```
if(!empty($_FILES["pic".$ite]["name"])){
        if($id){
            unlink($path."$ite.jpg");

        }
        $ext = pathinfo($_FILES['pic'.$ite]['name'], PATHINFO_EXTENSION);
        $config["file_name"]="$ite.jpg";
        $this->transfer.="$ite.$ext";
        $this->upload->initialize($config);

        if(!$this->upload->do_upload("pic".$ite)){
            $this->transfer.=lang('msg_errorimage').' '.$ite;
        }
        } 
```

* * *

我只是将文件夹从“3”重命名为“3a”，然后打开图像的链接并收到 404 错误，然后将文件夹的名称从“3a”改回“3”，现在显示正确的图像.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-02T15:12:47.057

尝试加载图像时在文件扩展名后放置一些参数，

例如 1.jpg?t=`<?=time()?>`

因为有时浏览器会缓存数据，所以如果您加载同名文件，
它将加载缓存而不是真实文件。

即使在 js 文件中，有时如果您更改 js 文件中的某些代码行，它
不会使您所做的更改生效，您需要强制刷新缓存
才能看到更改，它可以是 ctrl+F5 或只是在文件扩展名后放置参数

例如：jsfile.js?t=`<?=time()?>`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-02T16:27:23.353

选项 1：清理缓存（CTRL+F5 强制从服务器加载页面），选项 2：如果可能，选择唯一的文件名。

请注意，选项 1 将导致整个页面从服务器重新加载，而选项 2 将仅加载新图像。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-02T19:44:02.680

如果您想从该页面中删除捕获，则需要在页面顶部包含以下内容：-

```
$this->output->set_header("Expires: Tue, 01 Jan 2000 00:00:00 GMT"); 
$this->output->set_header("Last-Modified: " . gmdate("D, d M Y H:i:s") . " GMT"); 
$this->output->set_header("Cache-Control: no-store, no-cache, must-revalidate, max-age=0"); 
$this->output->set_header("Cache-Control: post-check=0, pre-check=0", false); 
$this->output->set_header("Pragma: no-cache"); 
```

# database - 一些带有svn图片的数据库

> ID：13197815
> 
> 赞同：0
> 
> 时间：2012-11-02T15:02:54.510
> 
> 标签：database, svn, version-control

我有一大组图片，我打算保存在一些 ODB 中。这些图片可以在插入数据库后更改（尽管不经常）。

我的问题：如何在这些图片中使用 SVN？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T15:04:15.860

您可以使用 SQLite。它轻巧且易于使用的 RDBMS 引擎。整个数据库只是一个文件，因此您可以提交到 SVN 并在那里进行所有修订。

# php - 循环遍历大文件内存不足

> ID：13197820
> 
> 赞同：2
> 
> 时间：2012-11-02T15:03:00.530
> 
> 标签：php, memory, file-io, spl

[编辑的 OP 在这里是简短的版本]

循环遍历文件并读取内容，然后写入会导致函数失败。这似乎是一个内存问题。这是我试过的三个版本。

首先尝试了这个：

```
$file = new SplFileObject($this->getDirectoryPath() . $this->getFileName(), "a+");
$file->setFlags(SplFileObject::DROP_NEW_LINE | SplFileObject::SKIP_EMPTY);

if ($this->exists()) {
    foreach ($file as $line) {
        $tempArray = unserialize($line);
        if ($tempArray['Key'] == $arrayOfData['Key']) {
            foreach ($totalsToBeAdded as $key) {
                $arrayOfData[$key] += $tempArray[$key];
            }
        }
    }
}

$tempString = serialize($arrayOfData);

$file->fwrite("$tempString\r\n");

$this->numLines++; 
```

然后我尝试了这个：

```
$file = new SplFileObject($this->getDirectoryPath() . $this->getFileName(), "a+");
$file->setFlags(SplFileObject::DROP_NEW_LINE | SplFileObject::SKIP_EMPTY);

if ($this->exists()) {
    while (!$file->eof()) {
        $tempArray = unserialize($file->current());
        if ($tempArray['PartNumber'] == $arrayOfData['PartNumber']) {
            foreach ($totalsToBeAdded as $key) {
                $arrayOfData[$key] += $tempArray[$key];
            }
        }

        $file->next();
    }
}

$tempString = serialize($arrayOfData);

$file->fwrite("$tempString\r\n");

$this->numLines++; 
```

最后我放弃了 SplFileObject 并使用了普通的 fopen 等：

```
$handle = fopen($this->getDirectoryPath() . $this->getFileName(), "a+");

if ($this->exists()) {
    while (false !== ($line = fgets($handle))) {
        $tempArray = unserialize(trim($line));
        if ($tempArray['Key'] == $arrayOfData['Key']) {
            foreach ($totalsToBeAdded as $key) {
                $arrayOfData[$key] += $tempArray[$key];
            }
        }
    }
}

$tempString = serialize($arrayOfData);
fwrite($handle, "$tempString\r\n");
fclose($handle);
$this->numLines++; 
```

编辑更多信息：

我很好奇 PHP 的底层代码在逐行遍历文件时是否使用数组作为迭代器，这可能会杀死它。

而且文件确实开始构建，我可以看到它写入到大约 500-600k 然后它就死了。

最终文件大小约为 10mb。

最后一次更新：

这有效（注意缺少打开和读取文件）：

```
public function writeUnique($arrayOfData, $totalsToBeAdded) {  
        $tempArray = array();

        $handle = fopen($this->fullPath, "a+");

        $tempString = serialize($arrayOfData);
        fwrite($handle, "$tempString\r\n");
        fclose($handle);
        $this->numLines++;
} 
```

虽然这会中断（注意所有正在执行的操作都是循环整个文件然后写入文件）：

```
public function writeUnique($arrayOfData, $totalsToBeAdded) {  
        $tempArray = array();

        $handle = fopen($this->fullPath, "a+");

        if ($this->exists()) {
            while (false !== ($line = fgets($handle))) {

            }
        }

        $tempString = serialize($arrayOfData);
        fwrite($handle, "$tempString\r\n");
        fclose($handle);
        $this->numLines++;
} 
```

更新三号：

我现在已经对此进行了测试：

```
public function writeUnique($arrayOfData, $totalsToBeAdded) {

    $handle = fopen($this->fullPath, "a+");

    if ($this->exists()) {
        while (false !== ($line = fgets($handle))) {

        }
    }

    $tempString = serialize($arrayOfData);
//        fwrite($handle, "$tempString\r\n"); Commented out the writing.
    fclose($handle);
    $this->numLines++;
} 
```

这行得通。没有失败，内存错误或其他方面。

因此，这似乎要么是重读大文件的相同行的迭代问题，要么是函数的写入部分在某种程度上踩到了读取函数的脚趾。老实说，这没有意义. 我知道每个人都认为这与我的阵列有关。但是我已经充分利用了我所有的逻辑，我只是​​想读/写一个大文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T15:44:06.770

尝试：

```
if ($this->exists()) {
    while (false !== ($line = fgets($handle))) {
        $tempArray = unserialize(trim($line));
        unset($line);
        if ($tempArray['Key'] == $arrayOfData['Key']) {
            foreach ($totalsToBeAdded as $key) {
                $arrayOfData[$key] += $tempArray[$key];
            }
        }
        unset($tempArray);
    }
} 
```

我在这里可以看到的唯一持久数组是`$totalsToBeAdded`and `$arrayOfData`，从您的`+=`运算符看来它是一维的，因此您无能为力，只能进行微优化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T16:18:14.810

所以我终于崩溃了，计算了一下我需要 php 在这个文件上完成多少个循环，这个数字是 8,788,338,000,000 次。

这反过来又导致 PHP 超时。为了防止它超时，需要添加这行代码。

```
set_time_limit(0); // ignore php timeout 
```

现在可以逐行读取和解析临时文件。但是，在大文件（10 mb +）上，完成该功能的时间到目前为止已经超过一个小时（它仍在运行，因为我可以看到临时文件越来越大）。

我得出的结论是，如果速度至关重要，那么将 LARGE 数据集存储到临时 SQL 表中可能会更好。这以前对我来说不是一个选择，但现在我正在用允许它的权力来强迫这个问题。最坏的情况下，这将至少允许它运行。

请注意：这将允许无限循环永远运行并可能杀死服务器。在尝试之前，请确保您知道如何通过 UNIX 终止进程。

# javascript - FadeTo & FadeIn 不能正常工作。多班

> ID：13197823
> 
> 赞同：0
> 
> 时间：2012-11-02T15:03:06.367
> 
> 标签：javascript, jquery, function, opacity, fadein

我希望在按下按钮时创建一个漂亮的淡入淡出效果。

几乎可以工作，但有 1 个问题。

单击时，class="number2 number3" 也会褪色。

是否可以调用 --> 如果类包含值 number3 而不是 fadeIN。

我有以下标记：

```
<div class="mouseclicks"><a href="#">test</a></div>
<div class="number1">tesx1</div>
<div class="number2">tesx2</div>
<div class="number2 number3">tesx3</div> 
```

JS

```
$(function(){
$(".mouseclicks a").click(function(){
$('.number1').fadeTo("fast",0.1);
$('.number2').fadeTo("fast",0.1);
$('.number3').fadeIn("fast",1);

});}); 
```

**- - - - - - 编辑 - - - - - - - - - -**

这确实会淡出特定的数字，但不会在按下按钮 2 时恢复淡入。

```
$(function(){
$(".mouseclicks a").click(function(){
$('.number1').fadeTo("fast",0.1);
$('.number2').not('.number3').fadeTo("fast",0.1);
$('.number3').fadeIn("fast",1);
});});

$(function(){
$(".mouseclicks2 a").click(function(){
$('.number1').fadeTo("fast",0.1);
$('.number3').not('.number2').fadeTo("fast",0.1);
$('.number2').fadeIn("fast",1);
});}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T15:07:12.750

```
$(document).ready(function() {
    $(".mouseclicks a").click(function() {
        $('.number1').fadeTo("fast",0.1);
        $('.number2').not('.number3').fadeTo("fast",0.1);
        $('.number3').fadeIn("fast",1);
    });
}); 
```

这不包括 div ，`class="number2 number3"`但`.fadeTo()`仍然`.fadeIn()`适用于它

**编辑**

对于 2 按钮版本，对按钮 2 执行以下操作：

```
$(".mouseclicks2 a").click(function() {
    $('.number1').fadeTo("fast",0.1);
    $('.number3').fadeTo("fast",0.1);
    $('.number2').not('.number3').fadeIn("fast",1);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T15:19:23.167

给他们一个共同的父母，你可以让它更具未来感。

```
<div class="mouseclicks"><a href="#">test</a></div>
<div class="number-wrapper">
    <div class="number1">tesx1</div>
    <div class="number2">tesx2</div>
    <div class="number2 number3">tesx3</div>
</div> 
```

-

```
$(document).ready(function(){
    $(".mouseclicks a").click(function(){
        $('.number3').fadeTo("fast",1).siblings().fadeTo("fast",0.1);
    });
}); 
```

# session - 登录脚本、session_id、cookies

> ID：13197824
> 
> 赞同：0
> 
> 时间：2012-11-02T15:03:09.137
> 
> 标签：session, cookies, login

我一直在研究 PHP 登录脚本（到目前为止我发现的主要事情是坏的比好的多……），唯一让我感到困惑的是使用登录脚本中的会话和 cookie。

我想我了解会话的使用，就用户何时通过登录检查而言，在会话中存储一些唯一变量并通过页面跟踪它，以便页面知道它是哪个用户，但到目前为止我一直使用用户的用户名或电子邮件地址。我已经读过使用在 session_start() 中创建的 session_id，并将该值存储在 cookie 和 user_id 中，但想知道这样做的好处是什么..（它比用户名更难猜测吗？ ？）。如果 session_id cookie 存在（如“记住我”功能）是否用于自动重新登录用户，或者是否对此执行进一步检查？cookie 值在哪里匹配？

抱歉，如果这是一个微不足道的问题，只是不想在敏感问题上开始走错路。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T15:06:53.423

对于 PHP 安全的权威答案，我强烈推荐 Chris Shiflett 的 Essential PHP Security。对于不使用框架的 PHP 开发人员来说，这是无价的。

# php - preg_replace 替换匹配中的一个额外字符

> ID：13197825
> 
> 赞同：2
> 
> 时间：2012-11-02T15:03:09.300
> 
> 标签：php, preg-replace

我有一个几乎可以正常工作的正则表达式:)

```
/test[^test<]/ 
```

我正在使用 prep_replace() 并且我希望它找到字符串“test”的任何出现并用 test 替换它，除非字符串是“test<”（意味着已经被替换）。

测试文本是：“这是一个测试。这是一个测试吗？一些测试和测试但测试< testowanie”

它给了我这个结果：“这是一个测试这是一个测试一些测试和测试但是测试< testwanie”

所以它正确地排除了字符串 'test<' 但与任何其他匹配替换 'test' + 一个额外的字符。

任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T15:04:21.593

方括号代表一个字符类，而`^`代表该字符类的否定。最终结果是您匹配的序列`test`后跟任何一个字符不是`t`, `e`, `s`,`t`或`<`

请改用：`/test(?!<)/`, 来匹配所有出现的`test`不跟左尖括号的序列。

# javascript - 如何在动态设置时（在超时内）使列表项尊重 ul padding-right

> ID：13197826
> 
> 赞同：1
> 
> 时间：2012-11-02T15:03:09.460
> 
> 标签：javascript, html, css, html-lists, settimeout

我面临的问题是，当尝试在 setTimeout 中运行的代码中设置元素的 padding-right 属性时，其中的**li**元素未正确调整大小。当我不在 setTimeout 内时，问题不会发生（或至少很少发生）。

有人可以确认这是一个**webkit 错误**还是指向解决方案？

我能够在 Chrome 和 Safari 中重现它。

我创建了 3 个场景（请使用 Chrome 和 Safari 进行测试）：

1.  在静态 css 中带有 padding-right 的 ul - 显然有效[http://jsbin.com/ufifos/5/edit](http://jsbin.com/ufifos/5/edit)
2.  在 js 代码中设置了 padding-right 的 ul 不在 setTimeout 内 - 工作（大多数时候）见 jsbin.com/ekazow/1/edit
3.  在 setTimeout 内的 js 代码中设置了 padding-right 的 ul - 无法正常工作[http://jsbin.com/uzorux/1/edit](http://jsbin.com/uzorux/1/edit)

padding-right 已设置，但**li**元素未正确重绘。浏览器调整大小（或几个调整大小）修复它。

基本上代码是

```
setTimeout(function(){

    document.getElementById('container').style.paddingRight = '20px';

}, 2000); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T15:13:39.603

问题在于这条规则：

```
li {
   width: 100%;
} 
```

它不在第一个“工作”测试中。删除它，它应该可以正常工作。您可能还需要设置`display: block`li 。

# javascript - 在 JavaScript 中检查特殊字符的最有效方法是什么？

> ID：13197827
> 
> 赞同：-5
> 
> 时间：2012-11-02T15:03:15.183
> 
> 标签：javascript, regex, string

检查 JavaScript 字符串是否包含特殊字符的最有效方法是什么？我正在尝试使用循环并检查各种字符，但这似乎效率不高，也不能捕获所有字符。

具体来说，目标是检查字符串是否包含除 AZ 和 0-9 之外的任何字符，不包括 Q 和 R。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T15:05:03.363

研究使用[正则表达式](http://en.wikipedia.org/wiki/Regular_expression)和[`.test()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/RegExp/test)方法。

**[`.test()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/RegExp/test)**：

> 执行正则表达式和指定字符串之间的匹配搜索。返回真或假。

[`RegExp`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/RegExp)也可能有帮助，但这不是标准。

[正则表达式备忘单](http://www.addedbytes.com/cheat-sheets/regular-expressions-cheat-sheet/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T15:47:35.283

要检查 a 是否包含除, and之外的`myString`任何字符，不包括and ，请使用`A-Z``0-9``Q``R`

```
var re = /[^A-PS-Z0-9]+/i;
document.write(re.test(myString)); 
```

`i`模式末尾的位置是`re`可选的，取决于您是否希望正则表达式模式不区分大小写。

检查**[这个演示](http://jsfiddle.net/RvjeD/)**。

# objective-c - 如何在不包括任何夏令时的情况下从日期创建日期字符串？

> ID：13197830
> 
> 赞同：3
> 
> 时间：2012-11-02T15:03:18.617
> 
> 标签：objective-c, date, iso8601

```
NSString* dateString = @"2012-04-01T15:37:53Z";

ISO8601DateFormatter *dateFormat = [[ISO8601DateFormatter alloc] init];
[dateFormat setIncludeTime:YES];
NSTimeZone *utcTimeZone = [NSTimeZone timeZoneWithName:@"UTC"];

NSDate* date = [dateFormat dateFromString:dateString timeZone:&utcTimeZone];

STAssertEqualObjects([dateFormat stringFromDate:date timeZone:utcTimeZone], dateString, nil, nil); 
```

上述测试失败

> '2012-04-01T16:37:53Z' 应该等于 '2012-04-01T15:37:53Z'

不知道为什么 stringFromDate:date 返回的 NSString 是 1 小时后，因为两个日期都使用 UTC。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T11:54:34.570

看起来#stringFromDate 中[存在已在 fork 中解决](https://github.com/carllindberg/iso-8601-date-formatter/commit/0e355eeb0ddb5397cee9b668193e45069f5c3f43)[的错误](https://github.com/boredzo/iso-8601-date-formatter/pull/4)。

# php - 你如何在 PHP 中获得大块的二进制文件？

> ID：13197833
> 
> 赞同：0
> 
> 时间：2012-11-02T15:03:21.233
> 
> 标签：php, file-io, binaryfiles, magic-numbers, sfx

我正在创建一个 PHP 应用程序，它会在某个时候从网站下载 SFX 存档并需要从中提取数据。

由于我在 Linux 机器上运行它，我需要删除文件的 SFX 可执行部分并将压缩文件保存在文件系统上，然后我将运行一个程序来解压缩/提取。（SFX 档案基本上是一个 EXE 文件，其后附加了压缩档案。我已经用十六进制编辑器手动尝试过这个，它工作得很好。）

SFX 存档中压缩存档的文件类型将始终相同，我知道该文件类型的幻数是什么。

然后我需要在 PHP 中做的是，在下载文件（让我们假设一个简单的`file_get_contents()`使用 URL 参数）并且它位于内存中之后，我需要从压缩存档的幻数开始的内容中提取数据。

我在想我也许可以做某种正则表达式方法，但是，我需要将其处理为二进制信息（幻数需要表示为十六进制）而不是字符数据。幻数本身包含非打印/不显示为任何可读字符的十六进制值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T15:11:46.847

正则表达式是二进制安全的。但是，您可能会更好`strpos`。

```
$magicpos = strpos($downloaded_data,"\x1a\x09\x01"); 
```

假设幻数是 0x1A 0x09 0x01 - 你可以用实际的数字替换它。然后：

```
$archive = substr($downloaded_data,$magicpos); 
```

This will get the archive data from the magic number (included) onwards.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T15:10:41.357

您可以使用以下语法进行`preg_match`二进制处理：`\xXX`

```
preg_match('/\x00/', chr(0)) 
```

# wcf - 为什么没有使用端点上的 Windows ClientCredential？

> ID：13197838
> 
> 赞同：2
> 
> 时间：2012-11-02T15:03:40.750
> 
> 标签：wcf

我有一个 WCF 通道工厂，它的端点已针对 WCF 服务调用进行了修改。我想要的是在通常是直截了当的不同上下文中完成服务调用。但是它对我不起作用。我可以成功地将凭据添加到端点行为、检查它们并查看它们，但调用不是使用“NewUser”凭据进行的。

```
internal static void UpdateChannelClientBehavior(ChannelFactory factory)
{
   factory.Endpoint.Behaviors.Remove<ClientCredentials>();
   //MyCustomCredentials is a custom class class variable that inherits System.ServiceModel.Description.ClientCredentials
   MyCustomCredentials.Windows.AllowedImpersonationLevel = System.Security.Principal.TokenImpersonationLevel.Impersonation;
   MyCustomCredentials.Windows.ClientCredential = new NetworkCredential("NewUser", "password", "MyDomain");
   factory.Endpoint.Behaviors.Add(MyCustomCredentials);
   return;
} 
```

因此，在此代码之后，端点确实具有新的 Windows 凭据，但服务器端仍然在默认上下文下调用它，而*不是*使用“NewUsers”凭据。我做错了什么来完成这项工作？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T14:37:02.600

实际上这段代码确实有效：

```
internal static void UpdateChannelClientBehavior(ChannelFactory factory)
{
   factory.Endpoint.Behaviors.Remove<ClientCredentials>();
   //MyCustomCredentials is a custom class class variable that inherits System.ServiceModel.Description.ClientCredentials
   MyCustomCredentials.Windows.ClientCredential = new NetworkCredential("NewUser", "password", "MyDomain");
   factory.Endpoint.Behaviors.Add(MyCustomCredentials);
   return;
} 
```

如果您直接实例化 WCF 客户端代理的实例，则可以这样做的另一种方法如下：

```
MyWcfService.MyWcfServiceServiceClient client = new MyWcfService.MyWcfServiceServiceClient();
client.ClientCredentials.Windows.ClientCredential = new NetworkCredential("NewUser", "password", "MyDomain"); 
```

我正在反复尝试进行代码更改，并且弄乱了影响此代码的下游内容。您*确实可以*使用上面的代码更改调用的上下文，以模拟进行 WCF 调用的不同用户。如果需要临时提升对 WCF 服务的调用，这会*非常方便。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T20:21:33.353

更改您的服务以使用“用户名”clientCredentialType 而不是“Windows”。然后更改您的客户端以使用用户名和密码凭据。默认情况下，WCF 将根据 Windows 帐户数据库检查凭据，除非您另有指定。

```
factory.Credentials.UserName.UserName = "NewUser";
factory.Credentials.UserName.Password = "password"; 
```

如果您使用“Windows”凭据类型，则无法更改它，它将始终在运行用户的上下文中。

# php - 创建一个显示 xml 值的 php 文件

> ID：13197848
> 
> 赞同：0
> 
> 时间：2012-11-02T15:04:31.907
> 
> 标签：php, xml

我有我的 xml 文件，它运行良好并且显示正确，现在我正在创建一个 php 程序，可以轻松快速有效地更新它，这是我现在的 php 脚本。我的问题：它当前只显示每组中的一个记录，它不显示整个记录。在我的 php 下面是一个 xml 文件的小样本。谢谢！这是一个示例[http://codepad.viper-7.com/7RznW7](http://codepad.viper-7.com/7RznW7)

```
<?php 
$doc = new DOMDocument(); 
$doc->load( 'menu-1a.xml' ); 

$allmenu = $doc->getElementsByTagName( "menu" ); 
foreach( $allmenu as $themenu ) 
    {
    $head = $themenu->getElementsByTagName( "menuhead" ); 
    $menuhead = $head->item(0)->nodeValue; 

            $menunames = $themenu->getElementsByTagName( "menuname" ); 
            $menuname = $menunames->item(0)->nodeValue; 

            $desc= $themenu->getElementsByTagName( "menudesc" ); 
            $menudesc= $desc->item(0)->nodeValue; 

            $price = $themenu->getElementsByTagName( "price" ); 
            $price = $price->item(0)->nodeValue; 

            $info2 = $themenu->getElementsByTagName( "price2des" ); 
            $price2des = $info2->item(0)->nodeValue; 

            $cost2 = $themenu->getElementsByTagName( "price2" ); 
            $price2 = $cost2->item(0)->nodeValue; 

            echo " <h3>$menuhead</h3><b>$menuname - $menudesc - $price -     $price2des - $price2 \n</b><br>";

    }
?> 
```

--XML文件--

```
<main>
    <menu id="appet">
    <menuhead>
    Appetizers
    </menuhead>
    <menuitem>
        <menuname>
        Cheese Stick
        </menuname>
        <menudesc>
        (6 Sticks)
        </menudesc>
        <price>
        $7
        </price>
        <price2des>
        </price2des>
        <price2>
        </price2>
    </menuitem> 
```

——新代码！作品——加载（'menu-1a.xml'）；

```
$allmenu = $doc->getElementsByTagName( "menu" ); 
foreach( $allmenu as $themenu ) {
$head = $themenu->getElementsByTagName( "menuhead" ); 
$menuhead = $head->item(0)->nodeValue; 
print "$menuhead";
foreach ($themenu->getElementsByTagName('menuitem') as $menuitem) {
    $menuname = $menuitem->getElementsByTagName( "menuname" )->item(0)->nodeValue;
    $menudesc = $menuitem->getElementsByTagName( "menudesc" )->item(0)->nodeValue;
    $price = $menuitem->getElementsByTagName( "price" )->item(0)->nodeValue;
    $price2des = $menuitem->getElementsByTagName( "price2des" )->item(0)->nodeValue;
    $price2 = $menuitem->getElementsByTagName( "price2" )->item(0)->nodeValue;
    print "<b>$menuname - $menudesc - $price -     $price2des - $price2 \n</b><br>";
    }
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T15:15:22.983

您也想`<menuitem>`在“菜单”循环中循环 s ，并搜索个人`<menuitem>`的子节点以获取奖品等。像这样的东西：

```
foreach( $allmenu as $themenu ) {
    $head = $themenu->getElementsByTagName( "menuhead" ); 
    $menuhead = $head->item(0)->nodeValue; 
    print $menuhead;
    foreach ($themenu->getElementsByTagName('menuitem') as $menuitem) {
        $menuname = $menuitem->getElementsByTagName( "menuname" )->item(0)->nodeValue;
        // ... the others
        print <b>$menuname - $menudesc - $price -     $price2des - $price2 \n</b><br>";
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T15:15:04.893

每个部分只显示一个条目，因为您已经以这种方式编写了代码。

您*始终*只访问第一个元素，例如 in `$menunames->item(0)`。

如果您改为访问*所有*子元素 - 不仅是第一个 - 并输出它们，您的问题就解决了。

请参阅[`DOMElement::getElementsByTagName`](http://php.net/domelement.getElementsByTagName)，它包含一个示例，您可以如何做到这一点。

# c# - 如何完全禁用签名程序集？

> ID：13197850
> 
> 赞同：3
> 
> 时间：2012-11-02T15:04:36.053
> 
> 标签：c#, asp.net, .net, visual-studio-2010

我有一个包含多个项目的 VS.NET 2010 解决方案。我刚刚添加了一个新的库项目（the.library.assembly）。启动项目是一个网站。当我运行该网站时，我收到此错误：

> 无法加载文件或程序集“the.library.assembly”或其依赖项之一。无法验证强名称签名。该程序集可能已被篡改，或者它被延迟签名但未使用正确的私钥完全签名。（来自 HRESULT 的异常：0x80131045）

这是从哪里来的？我没有在其他项目中使用签名程序集，它们工作正常。

- - 编辑 - -

实际上，我确实发现 the.library.assembly 已签名。这与解决签名问题有关。我已在项目属性中取消选中它并浏览了解决方案中的所有项目。没有人签名。我现在收到构建错误：

```
Assembly generation failed -- Referenced assembly 'the.library.assembly' does not have a strong name. 
```

我想这可能与 the.library.assembly 引用的 WCF 服务有关。我删除了服务和相关代码。一切都很好。我重新添加了服务。另一个很好的构建。我将服务相关代码添加回了.library.assembly。仍然建立。然后我将 the.library.assembly 调用添加到 Web 应用程序中。那是我得到上述构建失败的时候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T17:48:05.687

我在 Web 应用程序的 AssemblyInfo.cs 中找到了引用签名的条目。将这些注释掉可以构建解决方案。

# python - python-requests：获取响应内容的头部而不消耗它

> ID：13197854
> 
> 赞同：4
> 
> 时间：2012-11-02T15:04:41.587
> 
> 标签：python, http, unicode, python-requests

使用 python-requests 和 python-magic，我想测试 web 资源的 mime 类型而不获取其所有内容（特别是如果该资源恰好是例如 ogg 文件或 PDF 文件）。根据结果​​，我可能会决定全部获取。但是，在测试完 mime 类型后调用 text 方法只会返回尚未使用的内容。如何在不消耗响应内容的情况下测试 mime 类型？

以下是我当前的代码。

```
import requests
import magic

r = requests.get("http://www.december.com/html/demo/hello.html", prefetch=False)
mime = magic.from_buffer(r.iter_content(256).next(), mime=True)

if mime == "text/html":
    print(r.text)  # I'd like r.text to give me the entire response content 
```

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-02T16:03:08.023

如果 'content-type' 足够，您可以发出 HTTP 'Head' 请求而不是 'Get' 来接收 HTTP 标头。

```
import requests

url = 'http://www.december.com/html/demo/hello.html'
response = requests.head(url)
print response.headers['content-type'] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-02T15:14:05.533

*注意*：在提出这个问题时，正确的方法是仅获取正文中的标头流`prefetch=False`。该选项已被重命名为`stream`并且布尔值被反转，所以你想要`stream=True`.

原始答案如下。

* * *

一旦使用`iter_content()`，您必须继续使用它；`.text`间接使用引擎盖下的相同接口（通过`.content`）。

换句话说，通过使用`iter_content()`at all，您必须`.text`手动完成工作：

```
from requests.compat import chardet

r = requests.get("http://www.december.com/html/demo/hello.html", prefetch=False)
peek = r.iter_content(256).next()
mime = magic.from_buffer(peek, mime=True)

if mime == "text/html":
    contents = peek + b''.join(r.iter_content(10 * 1024))
    encoding = r.encoding
    if encoding is None:
        # detect encoding
        encoding = chardet.detect(contents)['encoding']
    try:
        textcontent = str(contents, encoding, errors='replace')
    except (LookupError, TypeError):
        textcontent = str(contents, errors='replace')
    print(textcontent) 
```

假设您使用 Python 3。

另一种方法是提出 2 个请求：

```
r = requests.get("http://www.december.com/html/demo/hello.html", prefetch=False)
mime = magic.from_buffer(r.iter_content(256).next(), mime=True)

if mime == "text/html":
     print(r.requests.get("http://www.december.com/html/demo/hello.html").text) 
```

Python 2 版本：

```
r = requests.get("http://www.december.com/html/demo/hello.html", prefetch=False)
peek = r.iter_content(256).next()
mime = magic.from_buffer(peek, mime=True)

if mime == "text/html":
    contents = peek + ''.join(r.iter_content(10 * 1024))
    encoding = r.encoding
    if encoding is None:
        # detect encoding
        encoding = chardet.detect(contents)['encoding']
    try:
        textcontent = unicode(contents, encoding, errors='replace')
    except (LookupError, TypeError):
        textcontent = unicode(contents, errors='replace')
    print(textcontent) 
```

# c# - C# 中的数据集和网络流

> ID：13197856
> 
> 赞同：1
> 
> 时间：2012-11-02T15:04:55.567
> 
> 标签：c#

我想使用 C# 中的 XML 文件将 DataTable 从服务器发送到客户端。我在服务器端使用了以下代码

```
DataSet ds = new DataSet();
ds.WriteXml(nw, XmlWriteMode.WriteSchema); 
```

其中 nw 是服务器上的 NetworkStream

以下代码在客户端

```
DataSet ds = new DataSet();
ds.ReadXml(clientSockStream, XmlReadMode.ReadSchema); 
```

服务器正在发送数据，但在客户端，程序停止了。服务器端：

```
tcpserver = new TcpListener(IPAddress.Any, 4444);
tcpserver.Start();
Socket serverSocket = tcpserver.AcceptSocket(); // accepting connection
    if (serverSocket.Connected)
    {
        serversockstream = new NetworkStream(serverSocket);
        serverStreamReader = new StreamReader(serversockstream);
        serverStreamWriter = new StreamWriter(serversockstream);
        handleClinet client = new handleClinet(); 
        client.startClient(serverStreamReader, serversockstream,serverStreamWriter);
    }

    public void startClient(StreamReader streamReader, NetworkStream ser, StreamWriter streamWriter)
    {
        this.sread = streamReader;
        this.swrite = streamWriter;
        this.nwstram = ser;
        Thread ctThread = new Thread(handleClients);
        ctThread.Start();
    }

    private void handleClients()
    {
        // Creating Dummy DataTable to send to Client...
        DataSet ds = new DataSet();
        DataTable d = new DataTable();
        d.Columns.Add("Name");
        d.Columns.Add("City");
        d.Rows.Add("John","USA");

        ds.Tables.Add(d);

        try
        {    

            while ((true))
            {
                String mystr = sread.ReadLine();
                if (mystr.Equals("sendTable"))
                    break;
            }
            swrite.WriteLine("done");
            swrite.Flush();
            if(nwstram.CanWrite)
            {
                MessageBox.Show("it can write...");
                ds.WriteXml(nwstram, XmlWriteMode.IgnoreSchema);
            }
            nwstram.Flush();
            MessageBox.Show("XML Sent");

        } 
```

客户端：

```
 tcpClient = new TcpClient("127.0.0.1", 4444);

    IPHostEntry ip = Dns.GetHostEntry("127.0.0.1");
    //get a network stream from server
    clientSockStream = tcpClient.GetStream();
    clientStreamReader = new StreamReader(clientSockStream);
    clientStreamWriter = new StreamWriter(clientSockStream);

    private void button2_Click(object sender, EventArgs e)
    {
        try
        {
            clientStreamWriter.WriteLine("sendTable");
            clientStreamWriter.Flush();
            DataSet ds = new DataSet();
            String str = "";
            while (true)
            {
                str = clientStreamReader.ReadLine();
                if (str.Equals("done"))
                    break;

            }
            //MessageBox.Show("Client :" + str);
            if (clientSockStream.CanRead)
            {
                ds.ReadXml(clientSockStream, XmlReadMode.IgnoreSchema);
            }
        }
        dataGridView1.DataSource = ds.Tables[0];
    } 
```

假设所有 catch 块和必要的变量都已声明..请回复..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T15:02:01.920

我不确定我是否看到了你所有的代码，但这里有一个例子，如果我不得不使用 TcpSockets 而不是 WCF，我会做什么。

**服务器端**

```
public void StartServer()
{
    TcpListener listener = null;
    TcpClient client = null;
    NetworkStream nwStream = null; 

    try
    {
        listener = new TcpListener(IPAddress.Any, 4444);
        listener.Start();
    }
    catch(Exception ex)
    { Console.WriteLine(ex.Message); }

    byte[] buffer = new byte[1024];

    try
    {
        bool waiting = true;

        while(waiting)
        {
            if(listener.Pending())
            {

                client = listener.AcceptTcpClient();
                nwStream = client.GetStream();

                using(var ms = new MemoryStream())
                {
                    CreateDataSet().WriteXml(ms);
                    ms.Position = 0;

                    int read = 0;
                    while((read = ms.Read(buffer, 0, 1024)) != 0)
                    {
                        nwStream.Write(buffer, 0, read);
                    }
                }
                nwStream.Flush();
                nwStream.Close();
                client.Close();
                waiting = false;
            }
        }
    }
    catch(Exception ex)
    {
       Console.WriteLine(ex.Message);
    }
}

private DataSet CreateDataSet()
{
    //Create your dataset here and return something
} 
```

**客户端**

```
public DataSet GetDataSet()
{
    DataSet ds = new DataSet();
    TCPClient client = null;
    NetworkStream nwStream = null;

    try
    {
        client = new TcpClient("127.0.0.1", 4444);
        nwStream = client.GetStream();

        using(var ms = new MemoryStream())
        {
            byte[] buffer = new byte[1024];
            int read = 0;
            while((read = nwStream.Read(buffer, 0, 1024)) != 0)
            {
                ms.Write(buffer, 0, read);
            }
            ms.Position = 0;

            ds.ReadXml(ms);
        }
    }
    finally
    {
        nwStream.Close();
        client.Close();
    }

    return ds;
} 
```

我不会说这会完全按照您的意愿工作，但是进行一些修改应该是一个好的开始。但是，我强烈建议研究 WCF（我是一个巨大的支持者），因为这是您在某些代码中的相同服务的框架。

**WCF 服务器端**

```
[ServiceContract]
public interface IDataService
{
    [OperationContract]
    DataSet GetData();
}

public class DataService: IDataService
{
    public DataSet GetData()
    {
        //return some dataset here
    }
} 
```

**WCF 客户端**

```
private DataSet GetDataSet()
{
    DataSet ds;

    //This would be utilizing some gerated code, or you can make your own client
    var client = new DataServiceClient(someEndPoint, someBinding);
    client.Open();

    ds = client.GetData();

    client.Close();
    return ds;
} 
```

同样，这不是完全有效的代码，而只是一个示例，说明为什么 WCF 如此受欢迎，而不是通过套接字编写自己的疯狂代码。如果您希望保持语言中立，您甚至可以升级到 http 套接字，它仍然可以与 Java 一起使用，只要它是 SOAP 标准（有一些功能，如可靠消息传递，与 .网）。

# ruby-on-rails - 没有用于当前用户身份验证的 SQL 查询的 Web 应用程序

> ID：13197863
> 
> 赞同：1
> 
> 时间：2012-11-02T15:05:14.113
> 
> 标签：ruby-on-rails, api, rest, web-applications, concurrency

我有一个每秒有很多请求的网络服务器。为了优化数据库的 I/O 性能，服务器目前仅通过 HTTP 查询执行 2 个 SQL 查询：

*   为了获取当前用户，有一个查询，
*   有一个查询可以读取或写入资源。

而且我目前想知道在会话变量中缓存当前用户的ID是否不明智。这样，服务器可以通过 HTTP 查询仅执行 1 个 SQL 查询。

为此，客户端必须在应用程序上进行身份验证。然后，在检查用户名+密码的 SQL 查询之后，服务器可以将他的 id 保存在会话变量中。在此之后，我们可以删除无用的 SQL 查询。

由于这看起来非常简单且有用，我想知道为什么流行的身份验证插件，例如 Devise gem（用于 Rails 或 Sinatra）似乎不能以这种方式工作。

他们是这样做的最佳方式吗？你有什么想法？

感谢您的任何想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T15:34:36.853

这*就是*Devise 和大多数身份验证框架的功能。将 ID 保存在会话中的目的是让您可以快速轻松地从数据库中检索用户：推测您获取用户是有原因的（例如在页面上显示他们的姓名、检查身份验证、模型分配），并且仅从会话中获取他们的 ID 不会告诉您任何此类信息。所以无论如何你仍然必须从数据库中获取用户。

# sql - 在多个数据库中查找重复值

> ID：13197867
> 
> 赞同：3
> 
> 时间：2012-11-02T15:05:20.607
> 
> 标签：sql, sql-server, sql-server-2008-r2

我正在尝试找到一种方法来在多个数据库的表中查找重复的电子邮件地址。我有 30 个数据库，所有数据库都有一个具有相同字段的“用户”表（每个数据库都是我们的不同客户）。我需要遍历每个数据库，从该表中获取电子邮件地址，然后在当前数据库和所有其他数据库中搜索该电子邮件地址。如果存在，则写出记录，如果不存在，则转到下一个用户记录并重复。这是我到目前为止所得到的，但我被困住了。我想我必须在另一个游标内创建一个游标，但不知道它是否可以动态完成：

```
DECLARE @DBName varchar(20)
DECLARE @sSQL      varchar(2000)

DECLARE LoopCursor CURSOR FOR
    SELECT DBName
    FROM Configuration

    OPEN LoopCursor

    FETCH NEXT FROM LoopCursor
    INTO @DBName

    WHILE @@FETCH_STATUS = 0
    BEGIN
        SET @sSQL = '
            Select EmailAddress
            FROM ' + @DBName + '.dbo.Users'

        --Not to sure what to do from here??

        EXEC(@sSQL)

        FETCH NEXT FROM LoopCursor
        INTO @DBName
    END

    CLOSE LoopCursor
DEALLOCATE LoopCursor

SELECT 'DONE' 
```

我们正在使用 SQL Server 2008 R2 顺便说一句。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T15:24:42.627

未经测试，但这样的事情应该将它们全部转储到您放入的任何表中`db.schema.DuplicateEmailAddresses`

```
Declare @DBName varchar(20)
Declare @sql nvarchar(max)
Declare @join nvarchar(max) = ''

Declare LoopCursor Cursor For
    Select DBName
    From Configuration

Set @sql = N'Select EmailAddress Into db.schema.DuplicateEmailAddresses From ('

Open LoopCursor

Fetch Next From LoopCursor Into @DBName

While  @@FETCH_STATUS = 0
Begin
    Set @sql = @sql + @join + N'Select EmailAddress From ' + QuoteName(@DBName) + N'.dbo.Users'
    Set @join = N' Union All '
    Fetch Next From LoopCursor Into @DBName
End

Close LoopCursor
Deallocate LoopCursor

Set @sql = @sql + N') as tmp Group By EmailAddress Having Count(*) > 1'

exec sp_executesql @sql, N'' 
```

# mysql - 使用 set 子句中的 select 更新 MySQL 表中的行

> ID：13197869
> 
> 赞同：1
> 
> 时间：2012-11-02T15:05:23.377
> 
> 标签：mysql, sql-update, insert-update

从另一个 MySQL 表向 MySQL 表中插入一行很容易：

```
INSERT INTO sometable (SELECT * FROM anothertable WHERE somefield='somevalue') 
```

但是如果我想更新而不是插入，我该怎么做？我正在寻找类似的东西

```
UPDATE sometable SET (SELECT * FROM anothertable WHERE somefield='somevalue') 
```

显然，这是行不通的。（sometable 和 anothertable 的结构是相同的）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T15:08:02.530

你可以加入两张桌子，试试这样的

```
UPDATE sometable a
       INNER JOIN anotherTable b
           ON a.colname = b.colName
SET    a.val = b.val,
       a.val2 = b.val2
WHERE  b.somefield='somevalue' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T15:11:57.243

如果您尝试根据主键的匹配来更新行，那么您可以使用`REPLACE`而不是 INSERT。

```
REPLACE INTO sometable SELECT * FROM anothertable WHERE somefield='somevalue'; 
```

这意味着当主键列与 中的主键列`anothertable`具有相同的值时`sometable`，则 SELECT 返回的所有其他列都将用于覆盖 中的这些列`sometable`。

见[http://dev.mysql.com/doc/refman/5.5/en/replace.html](http://dev.mysql.com/doc/refman/5.5/en/replace.html)

如果行匹配基于主键以外的其他内容，则您必须使用@John Woo 所示的多表 UPDATE 语法。

# web-services - 如何在 GlassFish 3.1 中创建的 WebLogic 12c 中部署 ejb 独立

> ID：13197872
> 
> 赞同：2
> 
> 时间：2012-11-02T15:05:29.800
> 
> 标签：web-services, deployment, ejb, weblogic

美好的一天，我想部署一个 EJB 应用程序项目，其中包含一个使用 JAX-WS 库的类 Session Bean 和 WebServices，并且 Session Bean 使用另一个 JavaApplication 项目中的远程接口。我通过注入使用 WebServices 的会话 Bean，一切正常。我希望我可以将这两个 Web 服务用作位于另一个应用程序服务器中的另一个项目的会话 bean。起初我使用 NetBeans IDE 开发 GlassFish 3，但我很难在另一台安装了 GlassFish 的机器上部署 EJB，现在我正在处理 WebLogic server 12c。我安装了 WebLogic 并使用管理控制台部署了包含远程接口的 JavaApplication，然后我部署了 EJB，在左侧面板中选择“部署”，然后选择“安装” 并浏览到位于 EJB 项目的文件夹 dist 中的 .jar。但后来我收到以下错误：

[EJB:015001]无法链接类服务。Jar C:\Oracle\Middleware\user_projects\domains\domain\servers\AdminServer\stage\BancaSimulacionIBancaria\BancaSimulacionIBancaria.jar 中的服务：java.lang.NoClassDefFoundError: service/ServicesRemote

我想知道在部署EJB之前做什么，需要做什么？

![在此处输入图像描述](../Images/ea46de6bcd39d27804799e84d365edad.png)

# ruby - BinData：根据前两个字节定义结构

> ID：13197878
> 
> 赞同：0
> 
> 时间：2012-11-02T15:06:00.707
> 
> 标签：ruby, bindata

我正在使用 Ruby 并尝试从 TCP 接口读取二进制数据。收到的消息包含一个标头和一个有效负载。有效负载由标头中的 id 确定。

这是一个例子：

```
class TCPmessage < BinData:: Record

  class PayloadType_1 < BinData::Record
    uint8 :payloadType_1
    # more payload data
  end

  class PayloadType_2 < BinData::Record
    uint8 :payloadType_2
    # more payload data
  end

  uint8 :payload_id

  array :payload, :type => <<Here I need to select "PayloadType_1" or "PayloadType_2" based on the "payload_id" from above>>, ...

end 
```

我尝试了一些变体，但只提出了以下解决方案：

```
class TCPmessage < BinData:: Record

  class PayloadType_1 < BinData::Record
    uint8 :payload_id
    uint8 :payloadType_1
    # more payload data
  end

  class PayloadType_2 < BinData::Record
    uint8 :payload_id
    uint8 :payloadType_2
    # more payload data
  end

  uint8 :payload_id
end 
```

在主程序中，我首先阅读`payload_id`然后使用`case`语句来选择接下来要实例化的类：

```
x = TCPmessage.new
case x.read("TCPmessage").payload_id.to_s
when "1"
  y = TCPmessage::PayloadType_1.new
when "2"
  y = TCPmessage::PayloadType_2.new
end
y.read("TCPmessage") 
```

我确定还有另一种使用 BinData gem 中的复合类型（数组/选择）的解决方案，但我看不到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-02-20T23:24:10.737

我不知道在问这个问题时 BinData gem 是否已经具有该功能，但是对于声明性方法，您希望使用其[Choice](https://github.com/dmendel/bindata/wiki/CompoundTypes#choices)类型。

对于您的情况，可能是这样的：

```
require 'bindata'

class PayloadType_1 < BinData::Record
  uint8 :type_one_byte
  # more payload data for type 1
end

class PayloadType_2 < BinData::Record
  uint8 :type_two_byte
  # more payload data for type 2
end

class TCPmessage < BinData::Record
  uint8 :payload_id
  choice :payload, selection: :payload_id do
    array 1, type: :payloadType_1, read_until: :eof
    array 2, type: :payloadType_2, read_until: :eof
  end
end

puts TCPmessage.read "\x01ABC" # {:payload_id=>1, :payload=>[{:type_one_byte=>65}, {:type_one_byte=>66}, {:type_one_byte=>67}]}
puts TCPmessage.read "\x02DEF" # {:payload_id=>2, :payload=>[{:type_two_byte=>68}, {:type_two_byte=>69}, {:type_two_byte=>70}]} 
```

请注意，这`selection: :payload_id`是`selection: lambda { payload_id }`. 因此，如果您出于某种原因实际上需要按字符串索引选择，您可以

```
 # [...]
  choice :payload, selection: lambda { payload_id.to_s } do
    array "1", type: :payloadType_1, read_until: :eof
    array "2", type: :payloadType_2, read_until: :eof
  end
  # [...] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T16:33:28.223

鉴于我们对您正在尝试做的事情知之甚少，我认为您的操作方式没有任何问题。

我会写得有点不同，但在功能上不会有太大的不同：

```
x = TCPmessage.new
y = case x.read("TCPmessage").payload_id
    when 1
      TCPmessage::PayloadType_1.new
    when 2
      TCPmessage::PayloadType_2.new
    end
y.read("TCPmessage") 
```

# php - 通过带有花引号的标签检索 Delicious JSON 数据

> ID：13197883
> 
> 赞同：0
> 
> 时间：2012-11-02T15:06:19.447
> 
> 标签：php, json, curl, delicious-api

我创建了一个从[Delicious](http://www.delicious.com)中检索数据的脚本，如下所示：

```
...retrieve usernames and such...

$username = 'randomUser';
$parentTag = array("tag'12","tag’12"); //note the different quotes being used!
$amount = 100;

foreach ($parentTag as $pTag){
    $url = "http://feeds.delicious.com/v2/json/".$username."/".$pTag."?count=".$amount;     
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_HEADER, 0);
    curl_exec($ch);
    curl_close($ch);

    ...store data to DB...
} 
```

当手动访问两个链接（使用不同的标签）时，Delicious 会显示不同的数据，因为它将两者都视为单独/不同的标签，并且用户使用了这两种类型的报价。当使用我的脚本访问数据时，第一个有效，但第二个失败并且根本不显示任何数据。

我试过 urlencoding 和 rawurlencoding 标签，用 ’ 手动替换花括号；和 %92 但无济于事。

所以问题是：如何更改我的脚本以从 Delicious 获取两个标签的 JSON 数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T19:04:53.333

不是真正的答案。但对我来说，这只是工作：

```
<?php
    // Used sprintf to keep it readable, shouldn't make a difference
    $urlTemplate = 'http://feeds.delicious.com/v2/json/%s/%s?count=%d';
    $tag = 'tag’12';
    $url = sprintf($urlTemplate, 'wjzijderveld', $tag, 20);

    echo $url . PHP_EOL;

    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_HEADER, 0);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    var_dump(json_decode(curl_exec($ch))).PHP_EOL;
    curl_close($ch); 
```

我从终端尝试过。我唯一能想到的是，您的数据可能不是 utf-8 编码的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T13:54:55.477

终于找到了解决问题的方法，将来可能会对其他人有所帮助。不确定这是否是解决此问题的最佳方法，但它确实有效。

Willem-Jan 为我指出了关于编码的正确方向。我使用 Firefox 的附加 Live HTTP Headers 来调查 URL 发送到 Delicious 的方式。链接“http://feeds.delicious.com/v2/json/username/tag'12?count=100”转换为“http://feeds.delicious.com/v2/json/username/tag%E2% 80%9912?count=100”。

当使用已翻译的 URL 作为 $url 变量时，请求会显示正确的结果。

# clojure - assoc-in 可以创建一个新的向量而不是一个新的地图吗？

> ID：13197897
> 
> 赞同：2
> 
> 时间：2012-11-02T15:06:48.733
> 
> 标签：clojure

assoc-in 可以更改向量/映射中索引/键的值。在地图中，如果一个键不存在，那么它会创建一个新的键/值对。向量是否有类似的东西（如果索引不存在，它会在该索引处创建一个具有该值的列表）类似于：

```
 (reduce (fn [g [x y]] (assoc-in g [x y] y ))
        []
        (for [x (range 2) 
              y (range 2)]
             [x y])) 
```

上面的代码生成：

```
[{1 1, 0 0} {1 1, 0 0}] 
```

我希望它生成：

```
[[0 1] [0 1]] 
```

这可能以简单的方式吗？

谢谢

编辑：为了更清楚，我只是希望它生成嵌套向量而不是嵌套映射（或映射向量）现在我将 y 作为一个值，但这只是一个例子。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-02T15:46:43.760

在一般情况下，创建向量而不是地图不会很好，因为您只能`assoc`在向量中使用现有索引或下一个索引：

```
user=> (assoc [:a] 0 :b) ; works because index 0 exists
[:b]
user=> (assoc [:a] 1 :b) ; works because index 1 is next
[:a :b]
user=> (assoc [:a] 2 :b) ; fails since index is out of range
IndexOutOfBoundsException   clojure.lang.PersistentVector.assocN (PersistentVector.java:136) 
```

但是，如果你小心，你仍然可以让它工作。这是以下的实现`assoc-in`：

```
(defn assoc-in
  [m [k & ks] v]
  (if ks
    (assoc m k (assoc-in (get m k) ks v))
    (assoc m k v))) 
```

请注意，它调用`get`了`if`条件的真实分支。如果您希望自己的版本`assoc-in`使用向量，则可以添加一个空向量作为返回的默认值`get`：

```
(defn vassoc-in
  [m [k & ks] v]
  (if ks
    (assoc m k (vassoc-in (get m k []) ks v))
    (assoc m k v))) 
```

在您的问题中使用`vassoc-in`而不是`assoc-in`在示例代码中会产生`[[0 1] [0 1]]`您想要的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T15:32:11.217

看来您需要类似的东西：

```
user=> (let [cv #(apply vector %)] 
         (cv (map cv (repeat 5 (range 2)))))
[[0 1] [0 1] [0 1] [0 1] [0 1]] 
```

# java - 为什么spring任务调度器要等待上一个任务完成？

> ID：13197904
> 
> 赞同：7
> 
> 时间：2012-11-02T15:07:01.697
> 
> 标签：java, spring

我有以下任务计划程序设置：

```
<bean id="Task" class="foo.bar.Task" />

<bean id="TaskScheduler"
  class="org.springframework.scheduling.concurrent.ThreadPoolTaskScheduler">
    <property name="waitForTasksToCompleteOnShutdown" value="true" />
    <property name="poolSize" value="1000" />
</bean>

<task:scheduled-tasks scheduler="TaskScheduler">
  <task:scheduled ref="Task" method="run" cron="*/5 * * * * *" />
</task:scheduled-tasks> 
```

任务只打印一行并休眠 10 秒。使用此设置，我的期望是该任务将每 5 秒运行一次，无论前一个任务是否已完成执行（即停止睡眠）。但事实并非如此，任务每 15 秒运行一次（睡眠时间，然后是下次 cron 被命中时）。

如何配置它，以便任务每 5 秒运行一次，而不管之前的执行是否完成？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-02T15:23:27.153

在你运行方法中放@Async 注释并查看

```
 @Async
   public void run{

   } 
```

或者你可以

试试这个

```
<bean id="schedulerTask"
       class="org.springframework.scheduling.timer.MethodInvokingTimerTaskFactoryBean">
    <property name="mytaskClass" ref="mytaskClass" />
    <property name="targetMethod" value="fooMethod" />
</bean>

<bean id="mytaskClass" class="foo.bar.Task" />

<bean id="timerTask" class="org.springframework.scheduling.timer.ScheduledTimerTask">
    <property name="timerTask" ref="schedulerTask" />
    <property name="delay" value="10" />
    <property name="period" value="5000" />
</bean>

<bean class="org.springframework.scheduling.timer.TimerFactoryBean">
    <property name="scheduledTimerTasks">
        <list>
            <ref local="timerTask" />
        </list>
    </property>
</bean> 
```

然后你的课

```
 package foo.bar;

 public class Task{

  public void fooMethod(){
  // do task
 }

} 
```

根据要求添加

```
 <!-- Thread pool related configurations  -->
   <bean name="workerThread" class="foo.WorkerThread"/>

  <bean name="managerThread" class="foo.ManagerThread" >
     <constructor-arg type="org.springframework.core.task.TaskExecutor" ref="taskExecutor" />
     <constructor-arg type="foo.process.WorkerThread" ref="workerThread"/>
   </bean>

   <bean id="taskExecutor" class="org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor" >
 <property name="corePoolSize" value="5" />
 <property name="maxPoolSize" value="30" />
 <property name="queueCapacity" value="100" />
</bean>
<!-- End Thread pool related configurations  --> 
```

ManagerThread.java

```
public class ManagerThread {

private  TaskExecutor taskExecutor=null;
private  WorkerThread workerThread=null;

/**
 * @param taskExecutor
 * @param workerThread
 */
public ManagerThread(final TaskExecutor taskExecutor,final WorkerThread workerThread) {

    this.taskExecutor = taskExecutor;
    this.workerThread = workerThread;
}  

/**
 * Create a new thread and execte the requests
 * @param parameter
 */
 public synchronized void  fire(final Object parameter) {
    taskExecutor.execute( new Runnable() {
         public void run() {
             workerThread.execute( parameter );
         }
    });
  } 
```

WorkerThread.java

```
@Component
public class WorkerThread {

public void execute(final Object request) {

     // do the job
    }

} 
```

您可以根据您的要求自定义它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-20T10:25:56.887

您可以增加线程池大小以允许多个 cron 作业同时运行。

```
<task:scheduler id="taskScheduler" pool-size="10"/> 
```

# c# - 反序列化 System.Drawing.Color 值 - 内置方法？

> ID：13197910
> 
> 赞同：2
> 
> 时间：2012-11-02T15:07:16.097
> 
> 标签：c#, colors, deserialization

我想知道.Net框架中是否已经有一种方法可以从包含RGB三元组的字符串中实例化颜色值，如下所示：

> “166、103、208”

如果颜色存储在我的应用程序的 app.config 中，它会存储为字符串。如果可能的话，我想知道.Net 如何将这些字符串值反序列化回颜色。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T15:18:02.407

不要认为 .NET 可以原生地做到这一点（如果 Color 有 Parse 方法会很好）

**试试这个**

```
string[] strValues = "166, 103, 208".Split(',');
byte[] numValues = new byte[3];
for(int index = 0; index < numValues.Length; index++)
{
    numValues[index] = Byte.Parse(strValues[index]);
}
Color result = Color.FromArgb(numValues[0], numValues[1], numValues[2]); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T16:13:00.693

*（[根据要求](https://stackoverflow.com/questions/13197910/deserializing-system-drawing-color-values-built-in-method#comment17967493_13197910)，我将其作为答案）*

使用[`ColorTranslator`类](http://msdn.microsoft.com/en-us/library/system.drawing.colortranslator.aspx)而不是将其写为三个字节怎么样？

通过使用[`ToHtml`](http://msdn.microsoft.com/en-us/library/system.drawing.colortranslator.fromhtml.aspx)and[`FromHtml`方法](http://msdn.microsoft.com/en-us/library/system.drawing.colortranslator.tohtml.aspx)以 HTML 格式存储并以 HTML 格式而不是字节格式回读，您可以使用内置的东西，尽管它不是每个定义的“序列化”。

一个例子可能是：

```
// "Deserialize" from a given string.
Color myColor = ColorTranslator.FromHtml("#45A3C7");

// "Serialize" to a string.
string htmlColor = ColorTranslator.ToHtml(Color.Red); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-02T16:21:49.143

使用`Split`和`BitConverter`

```
string rgb = "166, 103, 208";
var c = Color.FromArgb(BitConverter.ToInt32(rgb.Split(',')
    .Select(s => byte.Parse(s))
    .Reverse().Concat(new byte[] { 0 })
    .ToArray(), 0)); 
```

# python - “str”对象没有属性“标点符号”

> ID：13197913
> 
> 赞同：4
> 
> 时间：2012-11-02T15:07:30.140
> 
> 标签：python, string

我可能在这里真的很愚蠢，但我无法弄清楚这个错误：

```
'str' object has no attribute 'punctuation' 
```

这发生在线：

```
docLines[counter][counter2] = [(docLines[counter][counter2]).translate(None, string.punctuation)] 
```

其中 docLines[counter][counter2] 只是一个单词。

我出错的任何想法是代码行？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-02T15:10:46.323

您已将字符串（的实例`str`）分配给名为 的变量`string`。重命名变量，问题就会消失。

要对此进行调试，`print repr(string)`请在有问题的行之前添加，它将打印一个字符串实例。模块中不同位置的大量此类打印将帮助您发现名称`string`停止引用`string`模块并开始引用`str`实例的位置。

# php - Apache权限问题无法上传文件

> ID：13197914
> 
> 赞同：0
> 
> 时间：2012-11-02T15:07:32.657
> 
> 标签：php, linux, apache, permissions, posix

我最近构建了我的第一个 Debian 6 挤压箱作为 LAMP 服务器，一切似乎都运行良好。它使用最新的 Mysql、PHP 和 Apache.. 全部使用 apt-get 命令安装。

我创建了几个域，它们都运行良好（CMS 系统），但有一个主要例外。

我不能使用 CMS 网站功能来上传扩展程序或插件，除非先将权限更改为 777，然后再将它们放回 755。它几乎就好像 apache 服务没有以 root 身份运行，或者没有文件的权限......并且更像是一个公共用户。

对于我的个人网站，我认为这是可以接受的，但如果我为其他人制作 CMS，我不能让他们无法上传自己的扩展。

任何人都可以建议最佳实践（很高兴重做所有事情）以确保 apache 服务具有文件和目录所需的全部权限，因此我可以将权限保留在 755 .. 或地狱，甚至 604。

我在根目录中创建了一个名为 www 的容器，该目录包含一个以域名称命名的文件夹，即 example.com，其中有文件夹 backup、logs、public.. 网站文件位于 public 目录中。

我已经为所有人配置了虚拟名称服务器，当然还启用了该站点。

预先感谢您的任何帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T16:42:38.783

恕我直言，您需要在网站公共目录下创建一个*上传目录*（例如）并将其权限设置为 775 ..

第二件事，上传的文件可能首先进入*/tmp*，因此您需要将上传的文件从那里移动到*上传目录*..确保您的文件首先在 /tmp 下成功上传..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-26T22:26:41.143

对我来说（在 Ubuntu 上），我必须添加`umask 002`以`/etc/apache2/envvars`让 Wordpress 上传具有 775 权限而不是 755 权限的插件/图像（即允许除 Apache 和 root 之外的任何人更改上传的文件）

# javascript - 单击保存按钮时如何防止表单提交？

> ID：13197918
> 
> 赞同：-1
> 
> 时间：2012-11-02T15:07:48.617
> 
> 标签：javascript, jquery

我已经创建了一个基于 JSON 提要的表单，当用户单击“保存”时，我会显示引导模式窗口并且没有提交表单

但是我注意到当我添加这段代码时，表单正在提交，我需要它来填充模态窗口并在模态窗口中显示一个表格。

我怎样才能阻止它提交？修改后的代码：

```
 $('#myModal').modal('show'); 
     $.each(data, function(key, val) {
        var tablefeed= $('<tr><td>ID: '+key+'</td><td id="'+key+'">'+val+'</td><tr>').appendTo('#display');
    });
$(".modal-body").html(tablefeed); 
```

正如@pmandell 所建议的那样，我移至 ev.preventdefault 并且有效

```
 <script type="text/javascript">

   $('#myform').on('submit', function(ev) {

        ev.preventDefault();

    var data = $(this).serializeObject();
    json_data = JSON.stringify(data);
     $("#results").text(json_data); 
     $('#myModal').modal('show'); 
         $.each(data, function(key, val) {
            var tablefeed= $('<tr><td>ID: '+key+'</td><td id="'+key+'">'+val+'</td><tr>').appendTo('#display');
        });
    $(".modal-body").html(tablefeed); 

    }); 

        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T15:13:57.960

```
$('#myform').on('submit', function(ev) {
    ev.preventDefault();
... 
```

# css - CSS显示：表格；Chrome上的间距问题

> ID：13197919
> 
> 赞同：7
> 
> 时间：2012-11-02T15:07:49.537
> 
> 标签：css, google-chrome

我`display:table;`在一个`div`元素上使用。在我测试过的所有其他浏览器上都没有问题。但是，在 Chrome 22（最新）和 Canary`div`上，左右两侧的间距均为 1px。

知道问题出在哪里吗？

**编辑：**
`margin` , `border`,`padding`都是 0。

此外，所有表属性都被删除：

```
border-spacing:0;
border-collapse:collapse;
table-layout:fixed; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-18T19:42:35.257

我有同样的问题。它是由 Micro clearfix hack 引起的。删除 .clearfix 样式解决了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T15:54:37.350

我还会将空格视为可能的违规者并使用`font-size: 0`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T15:17:41.743

我会在所有浏览器上重置边距和填充。

```
*{margin:0; padding:0;} 
```

请注意，如果需要，您也可以下载重置的 css 文件。

[normalize.css](http://necolas.github.com/normalize.css/)或[reset.css](http://meyerweb.com/eric/thoughts/2011/01/03/reset-revisited/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-08T21:16:57.190

这个问题的答案解决了我的问题：[Chrome中的CSS表格单元格](https://stackoverflow.com/questions/18571612/css-table-cell-in-chrome)

他们建议添加`table-layout: fixed`到您已应用的元素中`display: table`。

如果您的标记没有`.clearfix`应用 hack，就像我的情况一样，这可能会对您有所帮助！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-06-22T09:08:04.083

我在 2015 年就注意到了这个问题——它只影响谷歌浏览器，解决它的唯一方法是将你的 display:table 移动到子容器中，所以如果你有：

```
<div style="width:50%; height:300px; display:table">
     <div style="display:table-cell; vertical-align: middle;">
          <p>Your centred content here</p>
     </div>
</div> 
```

将其更改为以下添加一个 div：

```
<div style="width:50%;">
     <div style="display:table; height:300px;">
          <div style="display:table-cell; vertical-align: middle;">
               <p>Your centred content here</p>
          </div>
     </div>
</div> 
```

看起来在 google chrome 中，当它应用于同一个标签时，宽度和 display:table 存在冲突。

在 chrome 和 firefox 中打开以下链接，您会看到右边框在 firefox 中对齐，但在 chrome 中不对齐，因为它增加了 1px 的额外间隙。

长话短说，我的修复适用于 chrome :)

[https://jsfiddle.net/2u1t8ffj/](https://jsfiddle.net/2u1t8ffj/)

[![左边的 Firefox - 很好，右边的 Chrome - 1px 间隙](../Images/1d500016ef508f30b25de49a88e17453.png)](https://i.stack.imgur.com/5S5nI.png)

# razor - Umbraco 或 MVC Razor 元素在标签开头可能具有不同的 CSS 样式

> ID：13197927
> 
> 赞同：2
> 
> 时间：2012-11-02T15:08:20.413
> 
> 标签：razor, umbraco

所以我以前见过这样做，我完全忘记了语法在哪里或是什么。非常感谢您的帮助。

所以我有一个元素，我想根据 Umbraco CMS 中填写或未填写的属性添加 CSS 样式。我认为它在元素标签之后涉及冒号 (:) 或类似的东西。但不完全确定。

我想做这样的事情

```
 foreach(var item in @Model.myNodeList)
      if(@item.myProperty != String.Empty){
      <div class="myStyleOne">
      }
      else if(@item.myProperty == String.Empty){
      <div class="myStyleTwo">
      }
      else{
     <div class="myDefaultStyle">
      }
        <p>My content that will be inside of this div with different starting tags</p>
      </div>
 } 
```

我知道这段代码并不完全正确，而且我遗漏了一些东西。谁能指出我正确的方向？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T15:10:35.027

你的意思是[条件运算符](http://msdn.microsoft.com/en-us/library/ty67wk28.aspx)？

```
<div class="@(item.myProperty != String.Empty ? "myStyleOne" : "myStyleTwo")"> 
```

看到字符串是否为空，我不确定您`myDefaultStyle`的位置。

这也适用于内联样式。在评论中使用您的示例，它看起来像这样

```
<div style="@(item.boxBackgroundColor != String.Empty ? "background-color:" + item.boxBackgroundColor + "; color:#fff !important" : "background-color:#fff;")"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T05:57:18.247

`@:`并且该`@Html.Raw()`方法将做同样的事情。但是`@:`会让你继续输入 html 而`@Html.Raw()`需要一个字符串。

您可以通过使用该类的变量来稍微清理您的代码：

```
foreach (var item in Model.myNodeList)
{
    string myClass = (item.myProperty != String.Empty) ? "myStyleOne" : "myStyleTwo";

    <div class="@myClass">
        <p>My content that will be inside of this div with the same starting tag</p>
    </div>
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T15:26:10.897

好的，以防万一其他人也想这样做。我发现它是什么。

这就是解决方案。它涉及在元素的开始和结束标记前添加 @: 符号。注意：取出最后一个else。感谢@Brandon。第一次这样做没有意义。布兰登的方式或这种方式也有效。

```
 foreach(var item in @Model.myNodeList)
    if(@item.myProperty != String.Empty){
    @:<div class="myStyleOne">
    }
    else if(@item.myProperty == String.Empty){
    @:<div class="myStyleTwo">
    }
    <p>My content that will be inside of this div with different starting tags</p>
    @:</div>
  } 
```

# c++ - 如何手动调用 SEL_MenuHandler

> ID：13197929
> 
> 赞同：0
> 
> 时间：2012-11-02T15:08:28.233
> 
> 标签：c++, cocos2d-x, ccmenuitem

我知道 CCMenuItem 有 a`CCObject* rec`和 a`SEL_MenuHandler selector`并且它会在选择时调用它们，但我想知道，仅给定这两个变量，我是否可以自己手动调用它们，如果可以，如何？

我知道 CCMenuItem 的 activate() 方法，但我试图在不创建 CCMenuItem 的情况下调用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T00:08:13.860

```
this->yourFunctionName(NULL); 
```

或者

```
rec->*selector(NULL); 
```

或者

```
rec->*selector(rec); ? 
```

不太确定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T15:27:32.393

你有没有尝试过：

```
[rec performSelector:selector]; 
```

# ruby-on-rails - 如何使用自定义控制器方法？

> ID：13197931
> 
> 赞同：0
> 
> 时间：2012-11-02T15:08:45.273
> 
> 标签：ruby-on-rails, controller

我正在尝试学习如何在视图中使用超链接来访问自定义控制器方法。我的控制器中有以下代码，我想使用`link_to`视图中的命令来访问它。我猜我需要在路由文件中做一些事情才能使该`launch_build_file`方法起作用？我应该在视图中列出什么代码来触发该`launch_build_file`方法？

```
class ReportsController < ApplicationController

  def index
  end

  def launch_build_file
    Process.spawn("ruby #{Rails.root}/lib/build.rb")
  end

end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T15:14:16.257

```
link_to "foo", :controller => :reports, :action => :launch_build_file 
```

或者您可以创建一个命名路由并使用它来获取 URL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T15:15:24.440

在您的路线文件中假设您有报告资源，如果没有，那么您可以使用命名路线

```
resources :reports do

 collection do
  get :launch_build_file
 end

end
#or
match '/reports/launch_build_file' => "reports#launch_build_file", :as => 'launch_build_file'

#If it's collection route 
link_to launch_build_file_reports_path
#or 
link_to launch_build_file_path 
```

# sql - =0、='0'、IN(0)、IN('0')之间的SQL区别

> ID：13197934
> 
> 赞同：2
> 
> 时间：2012-11-02T15:08:58.283
> 
> 标签：sql, database, teradata

我从同事那里继承了一些代码，我注意到一些代码的方式不一致例如，以下之间是否存在任何功能差异：

```
sum(case when (elephants = 0)then 1 else 0 end),

sum(case when (elephants = '0')then 1 else 0 end),

sum(case when (elephants IN (0))then 1 else 0 end),

sum(case when (elephants IN ('0'))then 1 else 0 end); 
```

如果在查找单个值时使用单个 qutoes 或 IN vs = 之间没有功能差异，那么还有什么其他原因可以解释它（除了草率的代码）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T15:12:56.173

`x IN (a, b, c)`意味着`x = a OR x = b OR x = c`。当`IN`列表包含单个项目时，`x IN (a)`仅表示`x = a`.

至于 和 的区别`0`，`'0'`前者是整数，后者是字符串。后者可以转换成整数，所以when`elephants`也是整数，`elephants = 0`也`elephants = '0'`测试同样的东西。

四者并无实质区别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T15:14:20.297

简而言之：

```
= 0 //equal to the number zero
= '0' //equal to the string "0"
IN (0) //appears in the list in parenthesis. In this case, the single-item list of numerical zero
IN ('0') //appears in the list in parenthesis. In this case, the single-item list of string "0" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-02T15:12:05.993

`=`用于单个值，但`IN`可以在一个集合中有*多个*值。

例如`=`

```
a = b 
```

但是对于`IN`, 而不是写多个`OR`

```
a = 1 OR a = 2 or a = 3 
```

你可以把它写成

```
a IN (1,2,3) 
```

关于单引号，如果列的数据类型是数值，服务器会自动将字符串值解析为数值。

# c# - 通过接口调用子类的方法而不在那里实现该方法

> ID：13197935
> 
> 赞同：0
> 
> 时间：2012-11-02T15:08:58.947
> 
> 标签：c#, inheritance, interface

我有接口`IPet`，在另一个项目中我有`Dog`继承自`IPet`.
在`Dog`我有方法`Bark()`但没有在`IPet`.
在我的项目中，`IPet`我还有一个类`PetSimulation`，其中我有一个`IPet`.
现在我想做这样的事情：

```
IPet myDog = new IPet("Rex");  
myDog.Bark(); 
```

但是`IPet`没有该方法`Bark()`，并且应该保持这种方式，因为其他类（例如`Cat`和`Horse`）也继承自`IPet`但也没有该方法`Bark`。
我也不能这样做：

```
Dog myDog = new Dog("Rex"); 
```

因为`Dog`在另一个项目中。

有什么办法让我通过接口调用`Bark`子类的方法而不在那里实现方法？`Dog``IPet`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T15:14:26.770

简短的回答：没有。

稍微长一点的答案：

您可以测试`IPet`以查看它是否为`Dog`，如下所示：

```
Dog dog = myDog as Dog;
if (dog != null)
{
    dog.Bark();
} 
```

请注意，您不能像在问题中那样直接创建界面，除非在[极少数情况下](https://stackoverflow.com/a/1093623/1595658)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T15:20:24.663

你不能。但是你可以使用 Bark 方法创建一个接口 IDog，它会继承自 IPet

```
public interface IPet
{

}

public interface IDog : IPet
{
    void Bark();    
}

public class Dog : IDog
{
    public void Bark()
    {
        Console.WriteLine("Wouff!");    
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T15:14:38.417

如果您真的无法访问 Dog 类并且正在使用 .NET 4+，您可以尝试

```
dynamic dog = new ...
dog.Bark() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-02T15:12:12.597

您需要将 myDog 转换为 Dog 才能访问只有该类具有的方法：

```
IPet myDog = new IPet("Rex");  
((Dog)myDog).Bark(); 
```

如果您在接口中实现 Bark，那么所有实现它的类都需要它。

您可以通过添加对 Dog 的项目的引用来访问 Dog 吗？

# objective-c - UITableViewCell 不从情节提要加载子视图

> ID：13197936
> 
> 赞同：6
> 
> 时间：2012-11-02T15:09:01.090
> 
> 标签：objective-c, ios, uitableview

我认为这里发生了一些奇怪的事情。我有一个带有几个标签作为子视图的原型单元，并使用`viewWithTag`它来尝试找到它们来设置它们的文本。我已经在同一个项目中完成了另外 3 次，所以我对可能出错的地方感到迷茫。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *CellIdentifier = @"Result Cell";
    UITableViewCell *cell = [self.tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    UILabel *racerNameLabel = (UILabel*) [cell viewWithTag:5002153];
    //more labels ... 
    return cell;
} 
```

如果我输入断点，racerNameLabel 为 nil，并且单元格没有子视图：

```
(lldb) po [[cell contentView] subviews]
    (id) $5 = 0x08161da0 <__NSArrayI 0x8161da0>(

) 
```

这是情节提要本身的片段，显示标签子视图肯定应该在那里。它还显示小区标识符是正确的。

```
<tableViewCell contentMode="scaleToFill" selectionStyle="blue" hidesAccessoryWhenEditing="NO" indentationLevel="1" indentationWidth="0.0" reuseIdentifier="Result Cell" rowHeight="80" id="hGh-MB-iBH">
        <rect key="frame" x="0.0" y="22" width="382" height="80"/>
        <autoresizingMask key="autoresizingMask"/>
        <view key="contentView" opaque="NO" clipsSubviews="YES" multipleTouchEnabled="YES" contentMode="center">
            <rect key="frame" x="0.0" y="0.0" width="382" height="79"/>
            <autoresizingMask key="autoresizingMask"/>
            <subviews>
                <label opaque="NO" clipsSubviews="YES" userInteractionEnabled="NO" tag="5002153" contentMode="left" text="Racer Name" lineBreakMode="tailTruncation" baselineAdjustment="alignBaselines" adjustsFontSizeToFit="NO" translatesAutoresizingMaskIntoConstraints="NO" id="Sf6-ol-OLA">
                    <constraints>
                        <constraint firstAttribute="width" constant="166" id="iI1-0U-gN8"/>
                    </constraints>
                    <fontDescription key="fontDescription" type="system" pointSize="17"/>
                    <color key="textColor" cocoaTouchSystemColor="darkTextColor"/>
                    <color key="highlightedColor" white="1" alpha="1" colorSpace="calibratedWhite"/>
                </label> 
```

（请注意，我将标签设置为一个愚蠢的数字，以试图使其正常工作）

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-09-15T21:34:51.483

如果您使用在 Interface Builder 的 Inspector 中输入的标识符注册自定义 UITableViewCell 单元格，则可能是问题所在。我遇到了同样的问题，当我删除了在 viewDidLoad 中注册自定义类的行时，它起作用了。

# bash - ftp 传输后无法执行任何操作

> ID：13197940
> 
> 赞同：0
> 
> 时间：2012-11-02T15:09:13.023
> 
> 标签：bash, ftp, download, unzip

我编写了从 ftp 下载 zip 文件的脚本，然后将每个不同的扩展名解压缩到自己的文件夹中。 **下载.sh**

```
#!/bin/bash
ftp -in sitehere.com << EOF
user username pass
binary
hash
lcd ./temp
mget *.zip
bye
unzip -n './temp/*.zip' -d ../../base/images/ *.TIF
unzip -n './temp/*.zip' -d ../../base/dbfs/ *.dbf 
```

但下载后我在终端中有 2 个错误“未知格式”。请告诉我我做错了什么？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T15:10:19.273

`EOF`在 FTP 命令列表的末尾插入。没有它，这两个`unzip`命令将被发送到 FTP 服务器。

```
#!/bin/bash
ftp -in sitehere.com << EOF
user username pass
binary
hash
lcd ./temp
mget *.zip
bye
EOF

unzip -n './temp/*.zip' -d ../../base/images/ *.TIF
unzip -n './temp/*.zip' -d ../../base/dbfs/ *.dbf 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T15:11:08.087

你不需要关闭你的[heredoc](http://tldp.org/LDP/abs/html/here-docs.html)吗？即`EOF`当您想与 ftp 断开连接时，请放在单独的线路上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T10:39:08.750

```
ftp -n 192.168.1.111<<EOF
user USERNAME
pass PASSWORD 
prompt off
mput file1.txt
bye
EOF

ftp -n 192.168.9.122<<EOF
user USERNAME
pass PASSWORD 
prompt off
mput file2.txt
bye

 Second file i.e. file2 is not getting uploaded 
```

# wordpress - Wordpress 单篇文章 URL

> ID：13197942
> 
> 赞同：0
> 
> 时间：2012-11-02T15:09:20.547
> 
> 标签：wordpress, url, blogs

我正在为客户构建一个 Wordpress，一切正常，但我已将永久链接更改为显示帖子标题，但现在在 URL 的末尾，它在末尾添加了一个随机字符串 fo 字符

**#.UJPe_2moqsg**

这仅发生在单个帖子上，而不是网站的其余部分。

有没有人见过这个。

其他细节，最新版本的 Wordpress，使用 Starkers 主题作为基础。我尝试了另一个主题，但似乎没有发生。

我应该寻找任何可能导致这种情况发生的具体地方吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T15:18:58.000

我认为是 AddThis 将这些字符添加到您的 URL - 这与 WordPress 本身无关。如果从 AddThis 代码中删除这一行，字符应该消失：

```
<script type="text/javascript">var addthis_config = {"data_track_addressbar":true};</script> 
```

AddThis 添加这些字符，以便它可以通过复制和粘贴您的 URL 来跟踪共享的人的共享。如果您只想通过 AddThis 按钮跟踪标准共享，则不需要此数据跟踪，并且您的标准 URL 不会受到干扰。

# javascript - 将字符串输入 url - 使用 html 表单和 javascript

> ID：13197947
> 
> 赞同：0
> 
> 时间：2012-11-02T15:09:39.343
> 
> 标签：javascript, string, forms, input

```
<p><input name="form[ip]" id="ip" class="ip" type="text" value="Enter IP here" />
</p>            
<p><input type="submit" value="Submit" /></p> ​   

var currentPageURL = "http://api.hostip.info/get_html.php?ip=12.215.42.19&position=true";
var ip = getMeasurementsFromUrl(currentPageURL)

alert(ip);

function getMeasurementsFromUrl(ip)
{

var ipMeasurmentString = ip.substring(ip.lastIndexOf('ip=')+3);

ipMeasurmentString =ipMeasurmentString.replace("&position=true",""); 
ipMeasurmentString =ipMeasurmentString.replace(",","."); 
ipMeasurmentString =ipMeasurmentString.replace("/","."); 
ipMeasurmentString =ipMeasurmentString.replace("-",".");
ipMeasurmentString =ipMeasurmentString.replace(",","."); 
ipMeasurmentString =ipMeasurmentString.replace("/","."); 
ipMeasurmentString =ipMeasurmentString.replace("-",".");
ipMeasurmentString =
return ipMeasurmentString;
} 
```

我正在尝试编辑网址，以便它读取输入的 ip，到目前为止，我已经让它读取地址中当前的 ip，并有一个表格来输入 ip。

此外，如果有人对如何使表单更具 ip 格式有任何提示，将会有所帮助。

[http://jsfiddle.net/mqWGm/8/](http://jsfiddle.net/mqWGm/8/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T16:16:09.050

如果 ip 地址没有改变，您可以使用：

```
element = document.getElementById("ip");
var newstring = ipMeasurmentString.replace("ip=12.215.42.19&",element.value); 
```

如果它改变你可以尝试：

```
var part = str.split("ip=");
var newstring = part[0] + "ip=" + element.value + "&position=true"; //part[0] = text before the ip= 
```

# sql - 如何在 Teradata 13.0 中重新设计我当前的 SQL 案例逻辑实现

> ID：13197950
> 
> 赞同：0
> 
> 时间：2012-11-02T15:09:57.807
> 
> 标签：sql, database-design, case, teradata

我正在为主数据构建一个暂存层，并有以下情况和当前解决方案。我的交易数据只有主数据 ID 或“代码”，没有文字描述。大多数我所有的文本描述都在一个通用表中提供，其中包含所有可能的“代码”及其后续文本值。在将此数据移动到暂存层时，我需要根据原始字段长度将 VARCHAR(60) 中的代码修剪为实际字段长度。

简而言之，主数据代码从正确投射到此着陆环境的源环境和填充它们的 VARCHAR(60) 中移动。当我进入 Staging 时，我需要根据字段长度进行修剪。

我正在使用以下 SQL，但已将其包装在 CASE 逻辑中以管理我将看到的不同可能的字段长度。因此，我必须为我处理的每个不同的 MD 代码重现这一点逻辑。我正在寻找一种方法来调整它，以便它在一个逻辑中处理所有字段长度。

```
SELECT ATTR_NM
    , CASE 
        WHEN ATTR_NM = 'DOC_TYP'
            THEN(
                CASE WHEN CHARACTER_LENGTH (TRIM(BOTH FROM tx.MSTR_DATA_ATTR_CD)) > 1
                    THEN SUBSTRING( tx.MSTR_DATA_ATTR_CD FROM CHARACTER_LENGTH(TRIM(BOTH FROM tx.MSTR_DATA_ATTR_CD))-1)
                    ELSE tx.MSTR_DATA_ATTR_CD
                END
                )
    WHEN SAP_ATTR_NM = 'ACCT_GRP'
        THEN(
            CASE WHEN CHARACTER_LENGTH (TRIM(BOTH FROM tx.MSTR_DATA_ATTR_CD)) > 4
                THEN SUBSTRING( tx.MSTR_DATA_ATTR_CD FROM CHARACTER_LENGTH(TRIM(BOTH FROM tx.MSTR_DATA_ATTR_CD))-2)
                ELSE tx.MSTR_DATA_ATTR_CD
            END
            )
        END AS MSTR_DATA_ATTR_CD
    , LANG_ISO_CD AS LANG_ISO_CODE
    , tx.LANG AS LANG
    , tx.END_DT AS END_DT
    , tx.FRM_DT AS FRM_DT
FROM MASTER_DATA_DESC_BASE_VOL tx; 
```

我不能只修剪前导 0，因为我可以有一个带有前导 0 的代码。我需要知道字段长度，然后通过 Trim 函数调用应用该数值。或者有人有更好的方法。我是一名长期的程序员顾问，但对 Teradata 有点陌生。

此外，这是有效的，目前可以处理 20 多种不同的情况，并且运行效率很高。我只知道有更好的方法来做我需要的事情，而且我还必须继续添加越来越多的案例。

# jquery - 将文本值添加到 jquery 函数（var）

> ID：13197951
> 
> 赞同：0
> 
> 时间：2012-11-02T15:10:06.160
> 
> 标签：jquery

如何将输入文本变量（值）添加到函数（变量描述）？

```
$(".update").click(function()
{
var article_id=$(this).attr("article_id");
var description=$(this).attr("description");
$.ajax
({
type: "POST",
url: "conf.php",
    data: {
    article_id: article_id,
    description: description,
    },..

<a href="javascript:;" class="update" article_id="$id">Description</a><input type="text"></input> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T15:11:50.220

你的意思是

```
$(".update").click(function(e) {
  e.preventDefault(); // do not follow the link
  var article_id=$(this).attr("article_id");
  var description=$(this).next("input").val(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T15:17:49.560

尝试如下，

```
var description=$(this).attr("description") + $(this).siblings('input[type=text]').val(); 
```

# css - 网站在错误的位置寻找字体文件

> ID：13197952
> 
> 赞同：0
> 
> 时间：2012-11-02T15:10:07.870
> 
> 标签：css, fonts, webserver, font-face

我正在尝试让一种风格的字体在网络服务器上工作，但它总是在错误的位置寻找文件。

我的文件系统如下所示：

```
/phhiv_asia_workshop_2012
|
|--index.html
|--/css
    |--global.css
    |--/fonts
       |--font.woff 
```

我有这样的@font-face 声明：

```
@font-face {
font-family: 'Pictos';
src: url("/fonts/font-web.eot");
src:local('☺'), url("/fonts/font-web.woff") format("woff"), url("/fonts/font-web.ttf") format("truetype"), url("/fonts/font-web.svg#webfontIyfZbseF") format("svg");
font-weight: normal;
font-style: normal;
} 
```

它在本地运行良好，但是当我在服务器上检查它时，它正在寻找字体文件：

example.com/fonts/pictos.woff example.com/fonts/pictos.woff

当网站位于：

[http://his.unhcr.org/phhiv_asia_workshop_2012/](http://his.unhcr.org/phhiv_asia_workshop_2012/) 和 [http://twine.unhcr.org/phhiv_asia_workshop_2012/](http://twine.unhcr.org/phhiv_asia_workshop_2012/)

如果我将 url 更改为 ("fonts/font-web.eot") 它在本地工作正常，但在服务器上它开始在以下位置查找文件：

example.com/phhiv_asia_workshop_2012/css/global.css/fonts/pictos-web.woff/

为什么它从查看根目录变为试图在 css/global.css/fonts/pictos-web.woff 中找到它？

（我不得不使用 example.com，因为我的声誉很低，但你可以补充它 twine.unhcr.org 或 his.unhcr.org）

其他一些事实： twine.unhcr.org/phhiv_asia_workshop_2012/ 重定向自 his.unhcr.org/phhiv_asia_workshop_2012/

我无权访问服务器，所以我试图在 xampp 中使用 htaccess 文件来重定向我的本地文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T15:39:40.060

尝试使用字体文件的绝对路径，即。[http://www.mydomain.com/css/fonts/font-web.woff](http://www.mydomain.com/css/fonts/font-web.woff)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T15:50:08.497

尝试使用这个`./fonts/font-web.woff`

# java - 重写规则附加 webapp 上下文路径与 和 标签库

> ID：13197954
> 
> 赞同：1
> 
> 时间：2012-11-02T15:10:08.737
> 
> 标签：java, spring-mvc, nginx, jstl, taglib

我有一个 MV webapp，它使用`<c:url>`（或`<spring:url>`）jsp 标签在视图中生成链接。

我的 webapp 目前使用上下文路径“/”部署，因此可以在 address 访问`http://mydomain`。

现在我想用 contextpath 部署这个应用程序`/app`。

访问应用程序的新 URL 现在是`http://mydomain/app`。

我不希望 Web 用户看到部署应用程序的 contextPath 并保持 URL 干净。我现在使用 RewriteRule 将 /app 附加到每个通过 Apache 的请求，然后再点击 Tomcat。

因此用户可以浏览到`http://mydomain`，重写规则会将请求转发到部署在 contextpath 下的正确 webapp `/app`。

我现在遇到的问题是，使用`<c:url>`视图会在包含 contextPath 的 HTML 中生成页面链接。我试图用重写规则隐藏。

因此，在`/app`上下文下部署 webapp 后，HTML 包含链接，`http://mydomain/app/other/careers.html`而不是`http://mydomain/other/careers.html`

有没有办法解决这个问题而不必修改所有页面使用`<c:url>`？

taglib 的目的正是管理 contextPath 以便它不会在页面中硬编码。但我的问题是，当我使用重写规则引擎时，我不再需要 HTML 页面中的这个上下文路径，因为我在重写规则本身中处理它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T17:16:48.787

[您可能想在http://tukey.org/urlrewrite/](http://tuckey.org/urlrewrite/)上查看 UrlRewriteFilter

使用此项目，您可以操作**入站**和**出站**链接，后者是通过修改在`c:url`后台执行的调用结果来确定如何构建 URL 来完成的。

当前版本的文档似乎有点令人费解，但是`<outboud-rule>`（[https://cdn.rawgit.com/paultukey/urlrewritefilter/master/src/doc/manual/4.0/index.html#outbound-rule](https://cdn.rawgit.com/paultuckey/urlrewritefilter/master/src/doc/manual/4.0/index.html#outbound-rule)）元素是您正在寻找自动修改所有页面链接的内容。

如果您仅`c:url`用于所有链接，则只需添加 UrlRewriteFilter 而无需更改单个页面。

根据您的整体设置，UrlRewriteFilter 还可以处理传入的重写（独立于出站链接配置），因此可能不需要 mod_rewrite。

希望这会有所帮助。

# java - 将日期转换为不同的时区

> ID：13197956
> 
> 赞同：24
> 
> 时间：2012-11-02T15:10:17.033
> 
> 标签：java, date, datetime, calendar, timezone

我正在尝试使用 Java 日期和日历进行从一个时区到另一个时区的简单转换。我正在尝试运行以下代码

```
 Calendar instance = Calendar.getInstance(TimeZone.getTimeZone("Europe/London"));
    Date date = instance.getTime();
    System.out.println(date);

    GregorianCalendar instance2 = new GregorianCalendar(TimeZone.getTimeZone("Europe/Athens"));
    instance2.setTime(instance.getTime());
    System.out.println(instance2.getTime()); 
```

但这仍然返回相同的日期，而不是 +1 小时......整个问题似乎微不足道，但我找不到任何简单的答案。在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-11-02T15:12:40.903

当您使用 打印日期`System.out.println(date); or System.out.println(instance2.getTime());`时，`Date` 返回的`instance2.getTime()`是`TimeZone independent`并且始终以本地时区打印日期。

相反，您可能想使用`DateFormat/SimpleDateFormat`：

```
 DateFormat formatter= new SimpleDateFormat("MM/dd/yyyy HH:mm:ss Z");
  formatter.setTimeZone(TimeZone.getTimeZone("Europe/London"));
  System.out.println(formatter.format(date));

  formatter.setTimeZone(TimeZone.getTimeZone("Europe/Athens"));
  System.out.println(formatter.format(instance2.getTime())) 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-07-15T07:19:36.773

接受的答案是正确的。java.util.Date 类没有分配时区^(†</sup>，但它的`toString`实现令人困惑地应用了 JVM 当前的默认时区。)

# 避免使用 java.util.Date & .Calendar

这是避免与 Java 捆绑在一起的臭名昭著的麻烦 java.util.Date、.Calendar 和 SimpleDateFormat 类的众多原因之一。避开他们。而是使用：

*   [乔达时间](http://www.joda.org/joda-time/)
*   新的[java.time 包](http://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html)与 Java 8 捆绑在一起，并受到 Joda-Time 的启发。

# 乔达时间

Joda-Time 2.3 中的一些示例代码如下。在 StackOveflow 中搜索更多示例和讨论。

```
DateTimeZone timeZoneLondon = DateTimeZone.forID( "Europe/London" );
DateTimeZone timeZoneAthens = DateTimeZone.forID( "Europe/Athens" );

DateTime nowLondon = DateTime.now( timeZoneLondon );
DateTime nowAthens = nowLondon.withZone( timeZoneAthens );
DateTime nowUtc = nowLondon.withZone( DateTimeZone.UTC ); 
```

# java.time

Java 8 及更高版本内置了一个新的[java.time 包](http://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html)。这个包的灵感来自 Joda-Time。虽然它们有一些相似之处和类名，但它们是不同的；每个都有其他人缺乏的功能。一个显着的区别是 java.time 避免使用构造函数，而是使用静态实例化方法。

在这个问题的情况下，它们以相同的方式工作。指定时区，并调用[`now`](http://docs.oracle.com/javase/8/docs/api/java/time/ZonedDateTime.html#now-java.time.ZoneId-)方法获取当前时刻，然后基于旧的不可变实例创建新实例以适应时区。

请注意两个不同的时区类。一个是命名时区，包括夏令时和其他此类异常的所有规则以及与 UTC 的偏移量，而另一个只是偏移量。

```
ZoneId zoneMontréal = ZoneId.of("America/Montreal"); 
ZonedDateTime nowMontréal = ZonedDateTime.now ( zoneMontréal );

ZoneId zoneTokyo = ZoneId.of("Asia/Tokyo"); 
ZonedDateTime nowTokyo = nowMontréal.withZoneSameInstant( zoneTokyo );

ZonedDateTime nowUtc = nowMontréal.withZoneSameInstant( ZoneOffset.UTC ); 
```

* * *

^(†</sup>实际上，`java.util.Date`该类在[其源代码](http://hg.openjdk.java.net/jdk8/jdk8/jdk/file/tip/src/share/classes/java/util/Date.java)*中确实*有一个时区。但是出于大多数实际目的，该课程忽略了该时区。因此，作为简写，人们常说 juDate 没有指定时区。令人困惑？是的。避免 juDate 的混乱并使用 Joda-Time 和/或 java.time。)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-07-15T04:35:34.833

您可以使用以下代码片段

```
String dateString = "14 Jul 2014 00:11:04 CEST";
date = formatter.parse(dateString);
System.out.println(formatter.format(date));

// Set the formatter to use a different timezone - Indochina Time
formatter.setTimeZone(TimeZone.getTimeZone("Asia/Bangkok"));
System.out.println("ICT time : "+formatter.format(date)); 
```

# php - 从弹出页面读取 Post 数据

> ID：13197960
> 
> 赞同：0
> 
> 时间：2012-11-02T15:10:39.727
> 
> 标签：php, javascript, html

我是 php 的新手，正在做一个项目。

我在一个页面上有一个按钮，可以打开一个弹出页面以供某些用户输入。

用户单击弹出页面上的提交按钮后，如何将弹出页面上的数据传递给父页面？

有没有我必须使用的 javascript，或者这可以在 php 代码的帮助下完成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T15:19:10.870

好的，您可以先给我们一些代码，但是弹出页面将是一个表单，当用户按下 ok （例如）时，该方法将是 post\get 并带有您需要的父页面的操作，这是你将如何通过 var！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T15:24:39.057

您可以使用更高级的 AJAX，尤其是如果您不熟悉编程。一种更简单的方法是使用带有 POST/GET 的 HTML 表单，以您的 PHP 脚本为目标。

考虑：

```
// form.html
<form action="myScript.php" action="POST">
   <input type="text" name="username" />
</form>

// myScript.php
<?php

// Check if the user tried to pass data to the script
if( isset($_POST['username']) ) {
   echo "Hello, your username is: " . $_POST['username'];
}

?> 
```

W3Schools[这里](http://www.w3schools.com/php/php_post.asp)有更详细的教程。如果您使用这种方法，则需要清理用户输入以防止 SQL 注入和 XSS。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T15:15:05.923

如果您说弹出窗口时指的是一个新窗口，则可以像这样从弹出窗口中获取/设置开启者的元素： window.opener.document.getElementById("your element").value = "new value";

# java - 关于在 JNI 中分配的数组

> ID：13197965
> 
> 赞同：3
> 
> 时间：2012-11-02T15:10:53.677
> 
> 标签：java, android, android-ndk, java-native-interface

我在 Android JNI 中编写了一个分配 Java 数组的函数。但是，如果从 Java 中连续调用此函数，则会出现错误[*Fatal signal 11 (SIGSEGV)]。

C++

```
static jbyteArray buffer = NULL;
static int cbuflen = 0;
jbyteArray Java_com_sample_buffer_Buffer_updateBuffer(JNIEnv* env, jobject thiz, jlong handle, jint buflen)
{
    if(buflen > cbuflen){
        if(buffer != NULL) env->DeleteLocalRef(buffer);
        buffer = env->NewByteArray(buflen);
        cbuflen = buflen;
    }
    return buffer;
} 
```

爪哇

```
byte[] buf = conv.updateBuffer(buflen); 
```

我不应该使用这种方式吗？或者有什么措施？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-02T18:04:55.003

如果您想在 JNI 调用之间保留 jobject（如 jbyteArray），您需要将其设为 GlobalRef：

```
jbyteArray temp_buffer = env->NewByteArray(buflen);
buffer = (jbyteArray)env->NewGlobalRef(temp_buffer); 
```

然后才记得删除对象以释放内存：

```
env->DeleteGlobalRef(buffer); 
```

# javascript - 将表单数据作为文本传递到下一页

> ID：13197968
> 
> 赞同：0
> 
> 时间：2012-11-02T15:11:00.027
> 
> 标签：javascript, forms, cookies

我有一个由我们的 ESP 生成的电子邮件注册表单插入网页。当用户点击提交时，它会将他们带到我们创建的自定义确认页面。我想在确认页面上显示他们提交的电子邮件地址，所以它会显示类似“感谢您的加入，您现在将在 [电子邮件地址] 收到电子邮件”。我们的 ESP 不提供执行此操作的方法。有没有一种简单的方法可以从表单中获取电子邮件地址并使用 JavaScript 将其传递到下一页？

我已经尝试过这里提供的解决方案，但如果我尝试更新表单标签，表单会中断：[http ://www.webdeveloper.com/forum/showthread.php?232612-Pass-Variables-from-one-page -to-another-JAVASCRIPT-HTML](http://www.webdeveloper.com/forum/showthread.php?232612-Pass-Variables-from-one-page-to-another-JAVASCRIPT-HTML)

我在网上找到了这篇文章，但我不明白cookie如何只记录电子邮件地址或如何在下一页检索此信息：[http ://webdesign.about.com/od/cookies/a/aa083198.htm](http://webdesign.about.com/od/cookies/a/aa083198.htm)

这是我页面上的当前表单代码：

```
<script type="text/javascript" src="https://app.e2ma.net/app2/audience/tts_signup/1723547/4d1180e592869543e75486faa4eb9d23/37406/?v=a"></script>
<div id="load_check" class="signup_form_message">
    This form needs Javascript to display, which your browser doesn't support. <a href="https://app.e2ma.net/app2/audience/signup/1723547/37406/?v=a"> Sign up here</a> instead 
</div>
<script type="text/javascript">signupFormObj.drawForm();</script> 
```

我对 JavaScript 的了解非常有限，对 PHP 也没有了解，所以你能给出的回复越具体越好。任何帮助是极大的赞赏。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T15:16:38.857

由于您正在提交表单，因此可以访问服务器端的电子邮件地址，为什么不直接输出呢？Javascript一卸载就会失去页面之间的连接。您尝试使用 javascript 执行此操作对于 HTML1 能够执行的操作来说太复杂了。

# prism - 如何集成 Prism、Unity 和 Enterprise Library

> ID：13197974
> 
> 赞同：1
> 
> 时间：2012-11-02T15:11:18.520
> 
> 标签：prism, unity-container, enterprise-library, prism-4

我正在构建一个 WPF 应用程序。我正在使用 Prism 4 和 Unity。我想向应用程序中添加两个 Enterprise Library 5 块，即日志记录和异常处理。我的基础设施类中有一个支持 ILoggerFacade 的单例 LoggerFacadeCustom.cs，我在引导程序中创建了它，它正在生成日志文件。它在其构造函数中“通知”了一个统一容器（第二个代码块）

在哪里为 ExceptionManager 添加 container.resolve？如何在我的引导程序中将异常处理块连接到 ILoggerFacade？如何让所有异常出现在同一个日志中？这是我现有的 bootstrapper.cs

```
 public class Bootstrapper : UnityBootstrapper {

     protected override ILoggerFacade CreateLogger() {
        return LoggerFacadeCustom.Instance;
     }

     protected override DependencyObject CreateShell() {
        return Container.Resolve<Shell>();
     }

     protected override void InitializeShell() {
        base.InitializeShell();

        App.Current.MainWindow = (Window)Shell;
        App.Current.MainWindow.Show();

     //Other shell stuff...

     }

     protected override IModuleCatalog CreateModuleCatalog() {

        var catalog = new ModuleCatalog();

        //These primary modules must register their own services as if they were acting independantly
        catalog.AddModule(typeof(XmlCommentMergeModule));

        //These support modules require at least one primary module above to be added first
        catalog.AddModule(typeof(ToolboxHeaderModule));
        catalog.AddModule(typeof(ToolboxFooterModule));
        catalog.AddModule(typeof(ToolboxStartModule));
        return catalog;
     }
  } 
```

LoggerFacadeCustom：

```
 public class LoggerFacadeCustom : ILoggerFacade {

     private static readonly LoggerFacadeCustom _instance = new LoggerFacadeCustom();
     public static LoggerFacadeCustom Instance { get { return _instance; } }

     private LoggerFacadeCustom() {
        var container = new UnityContainer();
        container.AddNewExtension<EnterpriseLibraryCoreExtension>();

        _logWriter = container.Resolve<LogWriter>();
     }

     private readonly LogWriter _logWriter;

     public void Write(string message) { Write(message, null); }

           public void Write(string message, string category, int priority) {
     _logWriter.Write(message, category, priority);
  }

           public void Write(string message, Dictionary<string, object> properties) {
     _logWriter.Write(message, LiteralString.LogCategoryProcess, properties);
  }

     #region ILoggerFacade Members

     public void Log(string message, Category category, Priority priority) {
        throw new NotImplementedException();
     }

     #endregion
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T20:31:14.943

您的引导程序是应用程序的[组合根。](http://blog.ploeh.dk/2011/07/28/CompositionRoot.aspx)您应该在那里注册所有依赖项。而且只有那里。您永远不应该直接在组合根之外引用容器。

如果您的类具有依赖项，则应使用[构造函数注入](http://martinfowler.com/articles/injection.html)之类的模式注入该依赖项。

不要使用静态类。静态杀死依赖注入和可测试性，并将依赖隐藏到一个点，从任何地方引用所有内容。

使您的记录器外观成为构造函数参数。您可以对错误处理块执行相同的操作。

不要将容器用作 ServiceLocator。这[在现代软件架构中被认为是一种反模式](http://blog.ploeh.dk/2010/02/03/ServiceLocatorIsAnAntiPattern.aspx)。

# selenium - Selenium Capturescreenshot() 在 IE8 中不起作用

> ID：13197977
> 
> 赞同：1
> 
> 时间：2012-11-02T15:11:36.773
> 
> 标签：selenium

我的 C# 程序中有以下代码：

selenium.CaptureScreenshot("c:\test.png");

不幸的是，每次我运行程序时，当我到达这条线时，它就会倒下。我在 IE8 浏览器上运行我的测试。我不断收到的错误消息如下所示。任何帮助将不胜感激 - 我已经尝试了一切并且正处于放弃的边缘。PS。我正在使用 selenium-server-standalone-2.25.0

Selenium.NotSupportedException: CaptureScreenshot

CaptureScreenShiot 是否在 Internet Explorer 8 中不起作用

# php - modx进化外部数据库

> ID：13197979
> 
> 赞同：0
> 
> 时间：2012-11-02T15:11:43.093
> 
> 标签：php, mysql, rss, modx

我有 3 个单独的 modx 进化网站。所有 3 个网站都完全不同，因此运行一个单独的数据库。然而，对于每个网站的新闻和事件页面，我希望它们都从 3 个网站中的 1 个的数据库中运行。我这可能吗？是否已经为此目的创建了一个额外的？

我已经研究过使用 RSS 提要的可能性，但宁愿让它们直接从数据库运行，因为这将允许从 3 个网站中的任何一个添加新闻文章。

谢谢，肖恩。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T16:26:41.147

您可以在一个 modx 实例中创建额外的表并从外部访问它们~但是它们需要在同一个文件系统上。我不知道通过 http/API 等执行此操作的方法。请参见此处。

[http://rtfm.modx.com/display/revolution20/Loading+MODx+Externally](http://rtfm.modx.com/display/revolution20/Loading+MODx+Externally)

您要做的是创建额外的表并使用 xPDO 扩展 modx，最初进行设置是一项相当大的工作，但从长远来看是值得的。这是入门的最佳示例，尽管您不会扩展任何东西 [但 modx] 它确实为您提供了创建模式并将其注册到 modx 的有用示例。

[http://rtfm.modx.com/display/revolution20/Extending+modUser](http://rtfm.modx.com/display/revolution20/Extending+modUser)

和

[http://rtfm.modx.com/display/revolution20/Using+Custom+Database+Tables+in+your+3rd+Party+Components](http://rtfm.modx.com/display/revolution20/Using+Custom+Database+Tables+in+your+3rd+Party+Components)

最后，还有一个额外的东西会为你生成你所有的模式文件，但是我似乎找不到它叫什么......对不起。如果您有多个使用外键的表，它可能对您没有那么有用，因为它不会在它生成的文件中创建关系。

# c# - String.Format 失败并出现奇怪的错误

> ID：13197981
> 
> 赞同：1
> 
> 时间：2012-11-02T15:11:44.690
> 
> 标签：c#, multithreading, exception, string.format

我有一个使用以下代码运行的方法：

```
private void WriteToDb()
{
    using (SqlConnection dbConnection = new SqlConnection(_conStr))
    {
        dbConnection.Open();
        using (SqlBulkCopy sbc = new SqlBulkCopy(_conStr))
        {
            sbc.DestinationTableName = "tblLog";
            try
            {
                sbc.WriteToServer(_tblLog);
            }
            catch (Exception e)
            {
                Console.WriteLine(String.Format("{0} Error writing log info: {1} \n {3}", DateTime.Now.ToString(), e.Message, e.StackTrace));
            }
        }
    }

    _tblLog.Rows.Clear();
} 
```

我从`String.Format()`具有以下堆栈跟踪的方法收到异常：

> 未处理的异常：System.FormatException：索引（从零开始）必须大于或等于零且小于参数列表的大小。在 System.Text.StringBuilder.AppendFormat(IFormatProvider provider, String format, Object[] args) 在 System.String.Format(IFormatProvider provider, String format, Object[] args) 在 System.String.Format(String format, Object args) , 对象 arg1, 对象 arg2) 在 MyCompany.MyClient.MySoftware.Logger.WriteToDb()

我真的可以看到这个错误的来源。据我所知，我没有在该方法中使用任何集合。我还不得不承认这种方法是多线程的，但我还是想不出可能的影响。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-02T15:12:59.267

您的最后一个格式编号`{3}`是`{2}`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-02T15:13:39.193

```
Console.WriteLine(String.Format("{0} Error writing log info: {1} \n {3}", DateTime.Now.ToString(), e.Message, e.StackTrace)); 
```

应该

```
Console.WriteLine(String.Format("{0} Error writing log info: {1} \n {2}", DateTime.Now.ToString(), e.Message, e.StackTrace)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-02T15:17:07.083

> 据我所知，我没有在该方法中使用任何集合。

`System.String.Format(String format, Object arg0, Object arg1, Object arg2)`调用`System.String.Format(IFormatProvider provider, String format, Object[] args)`所以这就是`Collection`进入堆栈的地方。

正如其他人解释的那样，您正在使用`{3}`但数组只有三个元素，在索引`0`处`2`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-02T15:13:29.050

您正在使用`{3}`而不是`{2}`：

```
Console.WriteLine(String.Format("{0} Error writing log info: {1} \n {2}", DateTime.Now.ToString(), e.Message, e.StackTrace)); 
```

# php - 如何启用- 灯

> ID：13197983
> 
> 赞同：-2
> 
> 时间：2012-11-02T15:11:46.733
> 
> 标签：php, configuration, lamp

> **可能重复：**
> [如何启用 PHP 短标签？](https://stackoverflow.com/questions/2185320/how-to-enable-php-short-tags)

快速提问如何启用： `<?="something"?>`

它应该只是回应：某事

如何在 Web 服务器配置中打开它？怎么称呼它`<?= ?>`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T15:15:09.557

打开 php.ini 文件，然后设置以下

```
short_open_tag=On 
```

并重新启动您的 Apache 服务器。

# javascript - 在客户端系统中使用客户端脚本的文件下载选项

> ID：13197992
> 
> 赞同：6
> 
> 时间：2012-11-02T15:12:01.010
> 
> 标签：javascript, filesystems, download, client-side

我们目前正在努力为用户提供下载选项以下载 MP3 文件。我们正在开发一个无需服务器即可在本地系统中完全执行的应用程序。

但是下载 mp3 文件选项在大多数浏览器中都不起作用。它在大多数浏览器的内置媒体播放器中打开。

我们已经检查了解决方案，因为我们得到了诸如在服务器端使用标头设置“内容处置”或使用 PHP 或 ASP 脚本使其可下载的答案。

我还检查了 jquery filedownload.js 插件。这也有一个部分，如设置内容处置和设置cookie。

所以我想知道是否可以创建一个文件下载链接（用于 MP3）*，仅使用 Javascript 或 jQuery 等客户端脚本兼容所有浏览器。

**重要的提示：**

实际上，该过程不是从服务器下载文件，而是从客户端系统本身下载文件。

也就是说，MP3 文件应该从客户端系统中的一个位置（目录）复制到另一个位置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T16:32:46.820

此解决方案需要 XHR2 的浏览器支持 (http://dvcs.w3.org/hg/xhr/raw-file/tip/Overview.html)

它将 MP3 下载到一个 blob 中，然后将创建一个您可以访问该 blob 的 URL。在此过程中，您可以将 Mimetype 覆盖为您需要的任何内容。

```
window.URL = window.URL || window.webkitURL;

    var xhr = new XMLHttpRequest();
    xhr.open('GET', 'http://robtowns.com/music/blind_willie.mp3', true);
    xhr.responseType = 'blob';
    xhr.overrideMimeType('application/octet-stream');
    xhr.onload = function(e) {
        if (this.status == 200) {
            var blob = this.response;
            $('#link').html('<a href="'+window.URL.createObjectURL(blob)+'">Download</a>');
        }
    };

    xhr.send(); 
```

JSfiddle 示例要求您在浏览器中关闭 web-security 以允许跨域请求。 [http://jsfiddle.net/D2DzR/3/](http://jsfiddle.net/D2DzR/3/)

# javascript - onreadystatechange 永远不会被调用

> ID：13197998
> 
> 赞同：0
> 
> 时间：2012-11-02T15:12:13.237
> 
> 标签：javascript, ajax, xmlhttprequest

我已经创建了 XHR，并且我也正确地从服务器获得了响应。但由于某种原因，回调没有发生。请帮忙。

```
function uploadDr(){
    var url = "UploadExcelServlet";     
    if (req != null) {
        try {
            req.open("GET", url, true);
        } catch (e) {
            alert(e);
        }
        req.onreadystatechange = callBk;
        req.setRequestHeader("Content-Type", "multipart/form-data");
        req.send();
    } else {
        alert("Null Request");
    }
}

function callBk(){
    if (req.readyState == 4){
        if (req.status == 200){
            alert(req.responseXml);
        } else {
            alert(req.statusText);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T08:39:17.560

对于 GET 请求，您*不需要*设置“Content-Type”标头，因为数据始终在 URL 中传递。

也许您需要设置请求数据以发送如下：

```
req.send(null); 
```

然后`readyState`在回调函数中测试：

```
function callBk(){
    console.log(req.readyState); // don't stop the script by using alert!
    // other stuff
} 
```

使`readyState`不等于`0`( `XMLHttpRequest.UNSENT`) 的舒尔。