# StackOverflow 问答 14553000-14553999

# javascript - 如何在库中包含modernizr

> ID：14553002
> 
> 赞同：0
> 
> 时间：2013-01-27T22:21:29.957
> 
> 标签：javascript, modernizr

我目前正在开发一个将[Modernizr](http://modernizr.com/)作为依赖项的 javascript 库。将 Modernizr 包含在库中而不干扰库用户包含他们自己的 Modernizr 构建的最佳实践是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T04:06:12.120

您要求他们使用 Modernizr 中的哪些测试？

我会用这些预设链接到构建器并说“去获取这个自定义构建的modernizr。如果你已经使用它，请确认你的构建中有这些检测。”

# html - 使用透明背景更改悬停按钮的背景

> ID：14553004
> 
> 赞同：0
> 
> 时间：2013-01-27T22:21:52.563
> 
> 标签：html, css, dreamweaver

老实说，我认为标题很清楚，所以我想要的是当用户将鼠标悬停在按钮上时，背景图像会发生变化。我没有使用特定的类，因为 background: transparent 搞砸了。

这是按钮的代码：

```
<button type="submit" style="border: 0; padding: 0px; margin-top: -1px; background: transparent">
    <img src="../images/login open.png" alt="Inloggen" width="130" height="29" />
</button> 
```

感谢您调查它；）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T06:17:38.390

你没有使用透明的PNG吗？您可以完全避免使用 background:transparent ，而只需使用 button:hover 来更改背景。

HTML：

```
 <button type="submit"></button> 
```

CSS：

```
 button {
 background:url(yourImage.png) no-repeat 0 0;
 height: 29px;
 width: 130px;
 border:none;
 }

 button:hover {
 background:url(yourImage.png) no-repeat 0 0;
 } 
```

见[http://jsfiddle.net/Hc5Dz/](http://jsfiddle.net/Hc5Dz/)

# php - 将值发送到 php 文件

> ID：14553005
> 
> 赞同：0
> 
> 时间：2013-01-27T22:21:53.617
> 
> 标签：php

我试图向 PHP 文件发送一个值，但是当我检查时，这个值变成了`null`.

我通过以下方式发送值：user_login.php?p_action=New_User

user_login.php 的代码是：

```
require("include/session_inc.php");
require("include/user_handling_inc.php");
require("include/db_inc.php");

start_Session(false, false);

switch ($p_action) {
case 'Login': {
 $l_flag = verify_User($p_in_username, $p_in_password);
 if ($l_flag == "Not_Found") {
     $l_flag = "New_User";
 }
 break; 
}
case 'Save_Profile': {
$l_flag = "Save_Profile";
    break;
}
case 'New_User':
$l_flag = "New_User";
    break;
case 'Create_New_User':
$l_flag = "Create_New_User";
}

switch ($l_flag) {
    case 'New_User': {
    include "include/user_new_inc.php";
    break;
  }
case 'Save_Profile': {
    load_User_Data(" username = '$p_in_username' ", false);
    include "include/user_profile_save_inc.php";
    break;
  }
case 'Wrong_Password': 
    echo "Wrong Pass";
    break;
case 'OK': 
    load_User_Data(" username = '$p_in_username' ", true);
    store_User_Cookie($g_userdata->user_id);
    include "include/user_profile_inc.php";
    break;
case 'Create_New_User':
$l_user_id = create_New_User ($p_in_username, $p_in_email, 'Y');
    if ($l_user_id != -1) {
        store_User_Cookie($l_user_id);
        echo "Success !! <br><br> \n";
        echo "<a href\"/index.php\"> Back to Main </a>";
     }
break;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T22:26:02.017

你需要像这个朋友一样制作代码

```
switch ($_GET["p_action"]) {
case 'Login': {
 $l_flag = verify_User($p_in_username, $p_in_password);
 if ($l_flag == "Not_Found") {
     $l_flag = "New_User";
 } 
```

那好给你get的价值！！！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T22:51:57.280

[首先，您的代码不正确，请在此处](http://php.net/manual/en/control-structures.switch.php)阅读有关使用 Switch 的更多信息

第二次访问来自 url 的任何变量，您可以使用全局变量 $_GET 或 $_REQUEST

[你可以从这里](http://php.net/manual/en/reserved.variables.get.php)和[这里](http://php.net/manual/en/reserved.variables.request.php)阅读更多关于它们的信息

这是修复后的代码，请尝试运行它

```
 <?php
require("include/session_inc.php");
require("include/user_handling_inc.php");
require("include/db_inc.php");

start_Session(false, false);
$p_action=$_GET["p_action"];

switch ($p_action) {
case 'Login':
 $l_flag = verify_User($p_in_username, $p_in_password);
 if ($l_flag == "Not_Found") {
     $l_flag = "New_User";
}
 break; 

case 'Save_Profile': 
$l_flag = "Save_Profile";
    break;

case 'New_User':
$l_flag = "New_User";
    break;
case 'Create_New_User':
$l_flag = "Create_New_User";
 break;
}

switch ($l_flag) {
    case 'New_User': 
    include "include/user_new_inc.php";
    break;

case 'Save_Profile': 
    load_User_Data(" username = '$p_in_username' ", false);
    include "include/user_profile_save_inc.php";
    break;

case 'Wrong_Password': 
    echo "Wrong Pass";
    break;
case 'OK': 
    load_User_Data(" username = '$p_in_username' ", true);
    store_User_Cookie($g_userdata->user_id);
    include "include/user_profile_inc.php";
    break;
case 'Create_New_User':
$l_user_id = create_New_User ($p_in_username, $p_in_email, 'Y');
    if ($l_user_id != -1) {
        store_User_Cookie($l_user_id);
        echo "Success !! <br><br> \n";
        echo "<a href\"/index.php\"> Back to Main </a>";
     }
break;
 }
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T22:38:09.200

> 使用[$_GET](http://php.net/manual/en/reserved.variables.get.php)获取您的参数。

有时[$_REQUEST](http://php.net/manual/en/reserved.variables.request.php)更可取，因为它同时访问获取和发布数据。

第二件事永远不要相信用户输入，所以你必须使用[addlashes();](http://php.net/manual/en/function.addslashes.php) 或[real_escape_string()](http://php.net/manual/en/mysqli.real-escape-string.php)函数来防止对系统的攻击。

所以代码会是这样的：

```
$var = addslashes($_GET['p_action']);

switch($p) {
   case 'Login':
    $l_flag = verify_User($p_in_username, $p_in_password);
    if ($l_flag == "Not_Found") {
        $l_flag = "New_User";
    }
    break;

   "OTHER CASES HERE"
} 
```

> **请注意：不要为 CASE 添加 { }。在此处阅读 switch 的语法 [。](http://php.net/manual/en/control-structures.switch.php)**

# java - glEnable(GL_DEPTH_TEST) - 不渲染任何东西

> ID：14553007
> 
> 赞同：0
> 
> 时间：2013-01-27T22:21:57.420
> 
> 标签：java, opengl, lwjgl, depth-buffer, bit-depth

我正在做一个项目来学习渲染 3d 形状。为了获得正确的深度，我正在尝试使用 glEnable(GL_DEPTH_TEST)。正如预期的那样，它不会渲染任何东西，所以我添加了 glClear（GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT），但我仍然没有得到任何渲染。这是我的代码的简化版本。

```
public class Main {

public static void main(String[] args) {

    initDisplay();
    gameLoop();
    cleanUp();
}
public static void initDisplay(){
    try {

        Display.setDisplayMode(new DisplayMode(500,500));
        Display.create();

    } catch (LWJGLException ex) {
        Logger.getLogger(Main.class.getName()).log(Level.SEVERE, null, ex);
    }
}

public static void gameLoop(){
    float x = 0;
    float y = 0;
    float z = -20;
    float cubeX = 0;
    float cubeY = 0;
    float cubeZ = 0;
    float apothem = 1;
    float aspect = Display.getWidth()/Display.getHeight();
    Camera cam = new Camera(aspect,70,0.0f, 1000);
    Cube cube = new Cube(1);
    while(!Display.isCloseRequested() && Display.isActive()){
        if(Keyboard.isKeyDown(Keyboard.KEY_RIGHT)){
            x+=.003;
        }
        if(Keyboard.isKeyDown(Keyboard.KEY_LEFT)){
            x-=.003;
        }
        if(Keyboard.isKeyDown(Keyboard.KEY_UP)){
            z-=.003;
        }
        if(Keyboard.isKeyDown(Keyboard.KEY_DOWN)){
            z+=.003;
        }
        if(Keyboard.isKeyDown(Keyboard.KEY_D)){
            cubeZ+=.03;
        }
        if(Keyboard.isKeyDown(Keyboard.KEY_A)){
            cubeZ-=.03;
        }
        if(Keyboard.isKeyDown(Keyboard.KEY_W)){
            cubeX+=.03;
        }
        if(Keyboard.isKeyDown(Keyboard.KEY_S)){
            cubeX-=.03;
        }
        cam.setX(x);
        cam.setY(y);
        cam.setZ(z);

        glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

        glLoadIdentity();
        cam.useView();
        cube.render(cubeX,cubeY,cubeZ);
        Display.update();
    } 
```

}

这是用于创建和渲染立方体的类

```
public class Cube {
float apothem;
Cube(float apothem){
    this.apothem = apothem;
}
public void render(float x, float y, float z){

    glPushMatrix();

        glRotatef(x,1,0,0);
        glRotatef(y,0,1,0);
        glRotatef(z,0,0,1);
        glBegin(GL_QUADS);
            //front face
            glColor3f(.22f, .64f, .14f);
            glVertex3d(-apothem,apothem,apothem);
            glVertex3d(apothem,apothem,apothem);
            glVertex3d(apothem,-apothem,apothem);
            glVertex3d(-apothem,-apothem,apothem);

            //back face
            glColor3f(.23f, .26f, .64f);
            glVertex3d(-apothem,apothem,-apothem);
            glVertex3d(apothem,apothem,-apothem);
            glVertex3d(apothem,-apothem,-apothem);
            glVertex3d(-apothem,-apothem,-apothem);

            //left face
            glColor3f(.72f, .16f, .39f);
            glVertex3d(-apothem,apothem,-apothem);
            glVertex3d(-apothem,apothem,apothem);
            glVertex3d(-apothem,-apothem,apothem);
            glVertex3d(-apothem,-apothem,-apothem);

            //right face
            glColor3f(.53f, .21f, .84f);
            glVertex3d(apothem,-apothem,apothem);
            glVertex3d(apothem,-apothem,-apothem);
            glVertex3d(apothem,apothem,-apothem);
            glVertex3d(apothem,apothem,apothem);

            //top face
            glColor3f(.42f, .99f, .37f);
            glVertex3d(-apothem,apothem,apothem);
            glVertex3d(-apothem,apothem,-apothem);
            glVertex3d(apothem,apothem,-apothem);
            glVertex3d(apothem,apothem,apothem);

            //bottom face
            glColor4f(.44f, .11f, .74f,25f);
            glVertex3d(apothem,-apothem,-apothem);
            glVertex3d(apothem,-apothem,apothem);
            glVertex3d(-apothem,-apothem,apothem);
            glVertex3d(-apothem,-apothem,-apothem);
       glEnd();
   glPopMatrix();

} 
```

这是我用来查看事物的相机

```
private float x,y,z;
private float rx,ry,rz;

private float aspect;
private float fov;
private float zNear, zFar;

Camera(float aspect, float fov, float zNear, float zFar){
    x = 0;
    y = 0;
    z = 0;
    rx = 0;
    ry = 0;
    rz = 0;
    this.aspect = aspect;
    this.fov = fov;
    this.zNear = zNear;
    this.zFar = zFar;
    initProjection();

}
private void initProjection(){
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluPerspective(fov, aspect, zNear, zFar);
    glMatrixMode(GL_MODELVIEW);
    glEnable(GL_DEPTH_TEST);
}
public void useView(){
    glRotatef(rx,1,0,0);
    glRotatef(ry,0,1,0);
    glRotatef(rz,0,0,1);
    glTranslatef(x,y,z);
} 
```

# php - XPATH - 如何提取这个？

> ID：14553009
> 
> 赞同：-2
> 
> 时间：2013-01-27T22:22:12.500
> 
> 标签：php, xpath

**目标：****仅使用且仅使用**锚 ID (msg123456) 作为起点获取锚链接 (some_path) 和锚值 (用户名)的值。

**HTML：**

```
<!-- a lot of HTML code before this -->
<a id="msg123456"></a><a id="new"></a>
<div class="windowbg">
    <span class="topslice"><span></span></span>
    <div class="post_wrapper">
        <div class="poster">
            <h4><a href="some_path" title="some_user">User Name</a></h4>
        </div>
    </div>
</div>
<!-- a lot of HTML code after this --> 
```

**问题：**我知道如何将 XPATH 用于简单任务，但在这种情况下，我不确定从哪里开始。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T22:52:49.267

获取您可以搜索的锚标记，这仍然很容易。更困难的部分是找到下一个 div，您可以使用`following-sibling::div[1]`它来获取`<div/>`当前上下文之后同一级别的第一个后续。之后的事情又简单了。

对于路径：

```
//a[@id="msg123456"]/following-sibling::div[1]//a/@href/data() 
```

对于用户名：

```
//a[@id="msg123456"]/following-sibling::div[1]//a/data() 
```

# jquery - 使用 Jquery 动画计时 Ajax 调用

> ID：14553010
> 
> 赞同：0
> 
> 时间：2013-01-27T22:22:23.633
> 
> 标签：jquery, ajax

我正在使用以下脚本为每个用户的页面加载帖子。

```
$.post("postupdate.php", function(data){
var postoutput = $("#postoutput", data);
$("#postcontainer").load("postupdate.php?user=<? echo $profileuser_id; ?> #postoutput");
$( '#postcontainer' ).fadeIn();
}, "html"); 
```

除了淡入淡出功能外，一切正常。我的加载时间各不相同，所以有时 postcontainer div 会在它被 Ajax Call 的帖子填充之前淡入。如何控制淡入淡出功能何时关闭，以便确保它始终在显示 div 之前完成加载内容？当它们有时只是凭空出现时，现在看起来真的很糟糕。

-谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T22:27:12.843

使用回调`.load()`并在那里淡入淡出。

```
$("#postcontainer").load("postupdate.php?user=<? echo $profileuser_id; ?> #postoutput", function(){
    $( '#postcontainer' ).fadeIn();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T22:27:35.390

从文档中：

```
$("#postcontainer").load("postupdate.php?user=<? echo $profileuser_id; ?> #postoutput", function() {
    $('#postcontainer').fadeIn();
}); 
```

[`.load()`](http://api.jquery.com/load/#callback-function)有一个回调函数，可以是在要发送的数据之后，也可以是url。该函数在加载完成时执行。

# jquery - 'DRY' jQuery 点击函数

> ID：14553014
> 
> 赞同：0
> 
> 时间：2013-01-27T22:22:48.150
> 
> 标签：jquery, dry

我有一个无序列表的链接，它们都对应于我的 JS 文件中的不同事件。现在我正在使用

```
$('#gst').click(function(){
    preset(gst);
});
$('#gsd').click(function(){
    preset(gsd);
});
$('#ts').click(function(){
    preset(ts);
});
$('#none').click(function(){
    preset(none);
}); 
```

这是我的预设功能：

```
function preset(setter){
if(setter === gst){
    currentPreset = gTitle;
    $('#count').html(currentPreset);
}else if(setter === gsd){
currentPreset = gDesc;
}else if(setter === ts){
currentPreset = tLimit;
}else{
currentPreset = none;
$('#count').html(currentPreset);
}
} 
```

它看起来很可怕。我知道有一种“干”的方法可以做到这一点。但我还没有找到一个。有谁知道做到这一点的最佳方法？这一定非常棒！

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T22:25:58.647

```
$("#gst, #gsd, #ts, #none").click(function(){
    preset(this.id);
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-27T22:26:15.500

```
function handleClick() {
    preset(window[$(this).attr('id')]);
}

$('#gst, #gsd, #ts, #none').click(handleClick); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-27T22:26:08.280

使预设以字符串为参数，然后按照以下方式执行操作

```
$('.classGivenToAll').click(function() {
    preset($(this).attr("id"));
}); 
```

如果您想切换到任何其他属性，我会以这种方式获取 id。

# python - python mutagen eyed3 写 id3v1 标签

> ID：14553016
> 
> 赞同：0
> 
> 时间：2013-01-27T22:22:52.743
> 
> 标签：python, mutagen, eyed3

我正在使用诱变剂来操纵我的 mp3，但我发现很难使用它来编写 id3v1 标签，看起来流行的 eyed3 包也没有提供任何关于如何执行此操作的示例。任何从事 mutagen 和 eyed3 工作的人都可以给我关于如何将 id3v1 标签写入 mp3 文件的建议吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T17:08:33.773

请参阅： [http](http://code.google.com/p/mutagen/wiki/Tutorial) ://code.google.com/p/mutagen/wiki/Tutorial 2011 年 10 月 4 日的评论对如何保存这些标签进行了一些解释。

这是你要找的吗？

# c++ - “有符号和无符号整数表达式之间的比较”实际上会导致错误吗？

> ID：14553017
> 
> 赞同：8
> 
> 时间：2013-01-27T22:22:54.780
> 
> 标签：c++, comparison, int, warnings, unsigned

通常，我使用的对象将具有（签名的）`int`参数（例如`int iSize`），这些参数最终会存储某物应该有多大。同时，我经常将它们初始化`-1`为表示对象（等）尚未设置/尚未填充/尚未准备好使用。

`comparison between signed and unsigned integer`当我做类似的事情时，我经常会收到警告`if( iSize >= someVector.size() ) { ... }`。

因此，我名义上*不想*使用`unsigned int`. 是否有任何情况会导致错误或意外行为？

如果不是：处理此问题的最佳方法是什么？如果我使用编译器标志`-Wno-sign-compare`，我可能（假设地）错过我**应该**使用`unsigned int`（或类似的东西）的情况。`unsigned int`那么在与--eg比较时我应该只使用演员表`if( iSize >= (int)someVector.size() ) { ... }`吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T22:36:07.383

是的，有，而且非常微妙。如果您好奇，可以查看Stephan T. Lavavej 的[这个有趣的演示文稿](http://channel9.msdn.com/Series/C9-Lectures-Stephan-T-Lavavej-Core-C-/Stephan-T-Lavavej-Core-C-7-of-n)，内容是关于算术转换和 Microsoft 的 STL 实现中的一个错误，该错误仅由有符号与无符号比较引起。

通常，问题是由于补码 2 算术，非常小的负整数值与非常大的无符号整数值（例如`-1 = 0xFFFF = 65535`）具有相同的位表示。

在检查的特定情况下`size()`，为什么不首先使用 type `size_t`for`iSize`呢？无符号值只会给你更大的表现力，使用它。

如果您不想声明`iSize`为`size_t`，只需通过使用显式强制转换来明确说明您知道这种比较的性质。编译器试图帮助您处理这些警告，正如您正确写的那样，在某些情况下，忽略它们可能会让您非常头疼。

因此，如果`iSize`有时是负数（并且应该被评估为小于 的所有`unsigned int`值`size()`），请使用成语：`if ((iSize < 0) || ((unsigned)iSize < somevector.size())) ...`

# javascript - 如何使用不同的输入设置 Grunt.js？

> ID：14553021
> 
> 赞同：1
> 
> 时间：2013-01-27T22:23:56.717
> 
> 标签：javascript, compression, minify, gruntjs

我使用 Grunt.js 来合并/缩小文件 - 但想使用 1 个常见的 grunt.js 文件来合并/压缩不同网站的多个目录中的文件。最好的方法是什么？

我希望我可以像这样设置 2 个不同的任务：

```
//ATG INTL US (excluding VIR)
    concat1: {
      dist: {
        src: ['<banner:meta.banner>', '../js/plugins/jquery.tools.min.js','../js/plugins/jquery.validate.min.js','../js/plugins/jcarousellite_1.0.1.min.js','../js/plugins/jquery.jcarousel.min.js','../js/plugins/jquery.qtip-1.0.0-rc3.min.js','../js/plugins/jquery.cookie.js','../js/plugins/jquery.fancybox-1.3.4.min.js','../js/lib/modernizr/modernizr.custom.39125.js','../js/plugins/jquery.select2.min.js'],        dest: '../js/common/plugins.js'
      }
    },
    // ATG INTL US (VIR ONLY)
    concat2: {
      dist: {
        src: ['<banner:meta.banner>', '../js/plugins/jquery.tools.min.js','../js/plugins/jquery.validate.min.js','../js/plugins/jcarousellite_1.0.1.min.js','../js/plugins/jquery.jcarousel.min.js','../js/plugins/jquery.qtip-1.0.0-rc3.min.js','../js/plugins/jquery.cookie.js','../js/plugins/jquery.fancybox-1.3.4.min.js','../js/lib/modernizr/modernizr.custom.39125.js','../js/plugins/jquery.select2.min.js','../include/js/plugins/jquery-ui.selectmenu.js'],        dest: '../js/common/plugins.js'
      }
    }, 
```

然后在我想运行它时注册不同的任务：

```
 grunt.registerTask('default', 'lint qunit mincss concat1 min'); 
```

但这似乎行不通，我听说过手表，但不确定这是否行得通。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T22:57:10.927

我想到了！

我可以设置不同的目录：

```
concat: {
      //ATG INTL US (excluding VIR)
      atgintlus: {
        src: ['<banner:meta.banner>', '../js/plugins/jquery.tools.min.js','../js/plugins/jquery.validate.min.js','../js/plugins/jcarousellite_1.0.1.min.js','../js/plugins/jquery.jcarousel.min.js','../js/plugins/jquery.qtip-1.0.0-rc3.min.js','../js/plugins/jquery.cookie.js','../js/plugins/jquery.fancybox-1.3.4.min.js','../js/lib/modernizr/modernizr.custom.39125.js','../js/plugins/jquery.select2.min.js'],        dest: '../js/common/plugins.js'
      },
      // ATG INTL US (VIR ONLY)
      atgintlvir: {
        src: ['<banner:meta.banner>', '../js/plugins/jquery.tools.min.js','../js/plugins/jquery.validate.min.js','../js/plugins/jcarousellite_1.0.1.min.js','../js/plugins/jquery.jcarousel.min.js','../js/plugins/jquery.qtip-1.0.0-rc3.min.js','../js/plugins/jquery.cookie.js','../js/plugins/jquery.fancybox-1.3.4.min.js','../js/lib/modernizr/modernizr.custom.39125.js','../js/plugins/jquery.select2.min.js','../include/js/plugins/jquery-ui.selectmenu.js'],        dest: '../js/common/plugins.js'
      }
    }, 
```

然后注册不同的任务：

```
 // ATG INTL US task.
  // Run in Command line using Grunt atgintlus
  grunt.registerTask('atgintlus', ['lint','mincss','concat:atgintlus', 'min:atgintlus']);

  // VIR US task.
  // Run in Command line using Grunt atgintlvir
  grunt.registerTask('atgintlvir', ['lint','mincss','concat:atgintlvir', 'min:atgintlvir']); 
```

像梦一样工作！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T17:14:07.027

对，所以您所做的是创建了一个“多任务”（具有多个目标的任务）。看起来你已经开始了，但你可能想看看我在 grunt.js 上制作的[一系列](http://www.youtube.com/watch?v=H9WXnwy2C00)视频，以帮助你进一步了解 grunt.js，这是关于[任务](http://www.youtube.com/watch?v=FRWhjOxG7EE)的视频。

# java - Java XML DocumentBuilderFactory 写空标签 从空值

> ID：14553022
> 
> 赞同：0
> 
> 时间：2013-01-27T22:24:11.883
> 
> 标签：java, xml, xsd

嘿，所以我想知道如何`<Category />`使用`DocumentBuilderFactory` （基于此[资源](http://www.mkyong.com/java/how-to-create-xml-file-in-java-dom/)，库*`javax.xml.parsers.*;`*）编写一个空标签，因为目前我必须应用一个 if 条件`if object.getCategory() != null`然后创建`Category Tag`否则忽略它。

```
//add the Category
if(excel.getCategory() != null){
    Element Category = doc.createElement("category");
    Category.appendChild(doc.createTextNode(excel.getCategory()));
    Rows.appendChild(Category);
} 
```

和架构

```
<xs:complexType name="data">
    <xs:all>
    <xs:element name="Category" type="xs:string" minOccurs="1" />
    <!-- other columns.. -->
    </xs:all>
</xs:complexType> 
```

而且我注意到如果我添加一个为空的文本节点，`transformer.transform(source, result);`它将返回一堆`NullException`错误。有没有办法配置转换器以知道 TextNode 是故意留空的？进而创建`<Category />`or `<Category></Category>`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T22:29:05.533

```
//add the Category
Element Category = doc.createElement("category");
Rows.appendChild(Category);
if(excel.getCategory() != null){
    Category.appendChild(doc.createTextNode(excel.getCategory()));
} 
```

在这里，我无条件地添加`category`元素`Rows`，但仅在`getCategory()`非空时添加文本节点子节点。如果它为 null，那么这将创建一个空`category`元素，该元素将序列化为 XML 为`<category />`.

如果您希望能够在 XML 中区`null`分值`excel.getCategory()`和空字符串值，那么通常的 XML 模式习惯用法是使元素“可空”

```
<xs:complexType name="data">
    <xs:all>
    <xs:element name="Category" type="xs:string" nillable="true" />
    <!-- other columns.. -->
    </xs:all>
</xs:complexType> 
```

并用`xsi:nil`

```
//add the Category
Element Category = doc.createElement("category");
Rows.appendChild(Category);
if(excel.getCategory() != null){
    Category.appendChild(doc.createTextNode(excel.getCategory()));
} else {
    Category.setAttributeNS(XMLConstants.W3C_XML_SCHEMA_INSTANCE_NS_URI,
                            "xsi:nil", "true");
} 
```

这将产生

```
<category /> 
```

何时`excel.getCategory().equals("")`和

```
<category xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true" /> 
```

什么时候`excel.getCategory() == null`

# ruby - 在 Mac OSX 10.8.2 上安装 Jekyll 时出错

> ID：14553023
> 
> 赞同：2
> 
> 时间：2013-01-27T22:24:14.130
> 
> 标签：ruby, macos, command-line, installation, jekyll

我是 Ruby 新手，对命令行也比较陌生。我正在尝试安装 Jekyll 来构建静态站点，但遇到了一些问题。我安装了 Ruby v. 1.8.7 和 Ruby Gems v. 1.8.25，但运行时出现此错误：

```
$ sudo gem install jekyll 
```

我明白了：

```
Building native extensions.  This could take a while...
ERROR:  Error installing jekyll:
ERROR: Failed to build gem native extension.

    /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby extconf.rb
mkmf.rb can't find header files for ruby at /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/ruby.h

Gem files will remain installed in /Library/Ruby/Gems/1.8/gems/fast-stemmer-1.0.1 for inspection.
Results logged to /Library/Ruby/Gems/1.8/gems/fast-stemmer-1.0.1/ext/gem_make.out 
```

谁能告诉我如何安装 ruby​​ 的头文件？我需要将它们安装在特定目录中吗？我是否需要在不同的目录中完全重新安装 Ruby，因为这是我的 Mac 附带的原始安装/设置？

# 更新

我已经安装了 XCode 并安装了 RVM，但我无法超越这一点。当我尝试安装 Ruby 时，我得到了这个：

```
Daniels-MacBook-Air:~ danielrosenthal$ rvm -v

rvm 1.18.3 (stable) by Wayne E. Seguin <wayneeseguin@gmail.com>, Michal Papis <mpapis@gmail.com> [https://rvm.io/]

Daniels-MacBook-Air:~ danielrosenthal$ rvm install 1.8.7
Searching for binary rubies, this might take some time.
No binary rubies available for: osx/10.8/x86_64/ruby-1.8.7-p371.
Continuing with compilation. Please read 'rvm mount' to get more information on binary rubies.
The provided compiler '/usr/bin/gcc' is LLVM based, it is not yet fully supported by ruby and gems, please read `rvm requirements`.
Daniels-MacBook-Air:~ danielrosenthal$ rvm requirements
Requirements for osx/10.8/x86_64

NOTE: 'ruby' represents Matz's Ruby Interpreter (MRI) (1.8.X, 1.9.X)
             This is the *original* / standard Ruby Language Interpreter
      'ree'  represents Ruby Enterprise Edition
      'rbx'  represents Rubinius

Additional Dependencies:
# For update-system:
Always update your system first!

# For rvm:
Install: bash curl git patch

# For ruby:
Install: osx-gcc-installer libksba openssl libreadline git zlib1g libyaml libsqlite3     sqlite3 libxml2 libxslt autoconf libc6 libgdbm ncurses automake libtool bison pkg-config

# For jruby:
Install: openjdk ant 
```

有人可以帮我解决这个问题吗？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T23:06:18.367

除了（或取而代之，取决于工具）Xcode，您还需要命令行工具，它可以从 Xcode 的首选项窗格中安装。Xcode 可以在 App Store 中找到，应该是免费的或非常便宜的。

顺便说一句，我强烈建议你不要乱用系统自带的 ruby​​；安装[rvm](https://rvm.io/)以获得完全隔离的 ruby​​ 版本（您可以选择您喜欢的版本），您可以在其中安装所有 gem。

安装 rvm 后，只需执行以下操作：

```
rvm install 1.8.7
rvm use 1.8.7
gem install jekyll 
```

**更新**

如果你需要 gcc 来编译某个版本的 Ruby，你应该[安装 homebrew](http://brew.sh/)，然后使用这个命令安装 gcc：

```
brew tap homebrew/dupes && brew install apple-gcc42 
```

否则，请尝试安装 AFAIK 应该与 LLVM/GCC 一起使用的 ruby​​ 1.9.3（我现在不在 Mac 上，无法检查）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T22:26:03.147

我过去曾这样做过，但个人并不记得所有细节。您可以尝试查看有关超级用户的相关帖子（解决方案 #2：“找不到头文件”）：[https ://superuser.com/questions/154292/ruby-rubygems-why-do-i-always-尝试安装宝石时获取错误消息](https://superuser.com/questions/154292/ruby-rubygems-why-do-i-always-get-error-messages-when-trying-to-install-gems)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T15:25:56.227

如果您还没有安装 Xcode（[https://developer.apple.com/xcode/](https://developer.apple.com/xcode/)），请按照所述安装 Xcode。**另外**，您需要命令行工具。

打开 Xcode。去`Preferences > Downloads > Install Command Line Tools`

# java - JPanel 中的 JTabbedPane？

> ID：14553024
> 
> 赞同：3
> 
> 时间：2013-01-27T22:24:21.007
> 
> 标签：java, swing, jpanel, jtabbedpane

当我想在我的 jpanel 中添加选项卡时，我遇到了一个简单的问题。选项卡的对齐方式是水平而不是垂直，看起来像废话 =/。

它看起来像这样：

![在此处输入图像描述](../Images/9da16d8cf2a5a2820995d7d2d428645b.png)

如果我放弃面板并将 tabbedPane 直接添加到框架中，一切正常。如果您取消注释三行代码并删除，`getContentPane().add(jtp);`您可以重现我的问题。

工作代码：

```
public class TabbedPane extends JFrame
{
    public TabbedPane()
    {
        setTitle("Tabbed Pane");
        setSize(300, 300); // set size so the user can "see" it
        JTabbedPane jtp = new JTabbedPane();

        // JPanel panel = new JPanel();//uncomment all three lines
        // panel.add(jtp);
        // getContentPane().add(panel);

        getContentPane().add(jtp);//remove me

        JPanel jp1 = new JPanel();// This will create the first tab
        JPanel jp2 = new JPanel();// This will create the second tab

        JLabel label1 = new JLabel();
        label1.setText("This is Tab 1");
        jp1.add(label1);

        jtp.addTab("Tab1", jp1);
        jtp.addTab("Tab2", jp2);

        JButton test = new JButton("Press");
        jp2.add(test);

        setVisible(true); // otherwise you won't "see" it
    }

    public static void main(String[] args)
    {
        TabbedPane tab = new TabbedPane();
    }

} 
```

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T00:34:45.673

> 如果我放弃面板并将其`tabbedPane`直接添加到框架中，一切正常。

的默认布局`JPanel`是`FlowLayout`，“让每个组件呈现其自然（首选）大小”。的默认布局`JFrame`是`BorderLayout`，`CENTER`忽略首选大小。在任何一种情况下，调用都会`setSize()`阻止布局最初运行。重新调整框架大小以查看效果。取而代之的是`pack()`，它“导致它`Window`的大小适合其子组件的首选大小和布局”。

```
setDefaultCloseOperation(EXIT_ON_CLOSE);
pack();
setVisible(true); // otherwise you won't "see" it 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-28T05:31:57.780

从@trashgod 的建议开始，我会在该代码中更改许多内容。OTOH 这是将选项卡式窗格拉伸到父容器的宽度/高度所需的最小更改。

```
// give the panel a layout that will stretch components to available space
JPanel panel = new JPanel(new GridLayout());//uncomment all three lines
panel.add(jtp);
getContentPane().add(panel);

//getContentPane().add(jtp);//remove me 
```

有关更多详细信息，请参阅[此答案](https://stackoverflow.com/a/7181197/418556)。

![](../Images/c058125e61cbffae7a1f5014b1bc0aa9.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-28T16:31:38.543

试试[GridbagLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/gridbag.html)。一旦你掌握了它，你就可以使用这种布局设计任何类型的 UI。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-27T23:01:47.250

那么首先你可以试试这个：

```
 JPanel panel = new JPanel();//uncomment all three lines
    panel.setLayout(new GridLayout());
    JPanel jp1 = new JPanel();// This will create the first tab
    JPanel jp2 = new JPanel();// This will create the second tab

    JLabel label1 = new JLabel();
    label1.setText("This is Tab 1");
    jp1.add(label1);

    jtp.addTab("Tab1", jp1);
    jtp.addTab("Tab2", jp2);

    JButton test = new JButton("Press");
    jp2.add(test);
    getContentPane().add(jtp); 
```

主要是：

```
 TabbedPane tab = new TabbedPane();
    tab.pack();
    tab.setVisible(true); 
```

我可以建议使用[MigLayout](http://www.miglayout.com/)来设置布局，它会让你的生活更轻松。希望能帮助到你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-03T10:21:01.053

我同意[prasanth](https://stackoverflow.com/users/2013044/prasanth)关于使用`GridBagLayout`

我曾经遇到过这个问题，我通过添加`JTabbedPane`到面板中解决了这个问题`GridBagLayout`，请确保根据您的对象中的要求添加`JTabbedPane`使用`ipadx`和`ipady``GridBagConstraints`

```
JPanel myPanel=new JPanel();
myPanel.setLayout(new GridBagLayout());
JTabbedPane jTP=new JTabbedPane();
jTP.add("Tab1",new JPanel());//substitute your component instead of "new JPanel"
GridBagConstraints myConstraints=new GridBagConstraints();
myConstraints.ipadx=400;//streches the component being added along x axis - 200 px on both sides
myConstraints.ipady=600;//streches the component being added along y axis - 200 px on both sides
myPanel.add(jTP,myConstraints); 
```

您可以根据最适合您的需要调整这两个属性

# java - 如何从 R 加载。在 android 中使用名称

> ID：14553033
> 
> 赞同：0
> 
> 时间：2013-01-27T22:25:10.460
> 
> 标签：java, android, image, drawable

我的可绘制文件夹中有很多图像，我想将其放入 setImageDrawable() 中。但我不知道如何使用图片名称获取图像。谁能帮助我？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T22:26:42.257

使用`setImageResource()`并通过`R.drawable.pic_name_here`.

* * *

这是一个典型的例子：

```
if (bonus <= 0) {
    imageView.setImageResource(R.drawable.feed_points_off);
} else {
    imageView.setImageResource(R.drawable.feed_points_on);
} 
```

甚至

```
imageView.setImageResource(isFemale ? R.drawable.ic_female : R.drawable.ic_male); 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-27T22:30:29.303

像这样

```
ViewObject.setBackgroundResource(R.drawable.image_name; 
```

# backbone.js - Marionette View 在第二次调用 show 方法时不渲染

> ID：14553036
> 
> 赞同：0
> 
> 时间：2013-01-27T22:25:25.730
> 
> 标签：backbone.js, marionette

有一个 Marionette ItemView 第一次正确呈现为窗口左侧的条形。侧边栏可以隐藏，并通过调用视图的 close 方法正确发生。但是，当我想再次显示侧边栏时，我会创建一个新的视图实例并将其显示在未显示的区域中。初始化方法和 onShow 一样被调用，但是元素没有添加到 DOM 中，因此它们不会显示在屏幕上。提前感谢您的帮助

# cocoa - 如果登录不正确，告诉 Cocoa App 退出

> ID：14553040
> 
> 赞同：0
> 
> 时间：2013-01-27T22:25:59.107
> 
> 标签：cocoa, security

如果用户尝试输入错误的密码或尝试取消登录过程，我想退出我的可可应用程序。

可以用这个吗：

```
[NSApp performSelector:@selector(terminate:) withObject:nil afterDelay:0.0]; 
```

还是有其他首选？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T22:27:53.497

在 Macintosh 上，只要用户清楚地了解应用程序退出的原因，就可以自行终止。

在 iOS 设备上，最好让用户停留在登录屏幕并抛出“密码错误”警报。Apple 倾向于不赞成 iPhone 上的自动终止应用程序。

# django - django-social-auth facebook登录不断覆盖同一个用户

> ID：14553041
> 
> 赞同：0
> 
> 时间：2013-01-27T22:26:00.443
> 
> 标签：django, django-socialauth

我实现了 django-social-auth 并让它通过 Facebook 对我进行身份验证。

我希望它还可以在系统中创建一个新用户，并尽可能写下电子邮件、姓名和电话号码。

但是，每次我以用户身份登录时，它都会覆盖 root 用户而不是创建新用户？

我也在使用自定义身份验证模块，它没有在自定义模型中创建用户。

设置.py：

```
MIDDLEWARE_CLASSES = (
    'django.middleware.common.CommonMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
)

ROOT_URLCONF = 'something.urls'

WSGI_APPLICATION = 'something.wsgi.application'

TEMPLATE_DIRS = (
    templatedir
)

INSTALLED_APPS = (
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.sites',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'frontpage',
    'social_auth',
    'django.contrib.admin'
)

AUTHENTICATION_BACKENDS = (
    'something.auth_backends.CustomUserModelBackend',
    'social_auth.backends.twitter.TwitterBackend',
    'social_auth.backends.facebook.FacebookBackend',
)

CUSTOM_USER_MODEL = 'accounts.CustomUser'
SOCIAL_AUTH_NEW_ASSOCIATION_REDIRECT_URL = '/newuser/'
SOCIAL_AUTH_DISCONNECT_REDIRECT_URL = '/disconnected/'
SOCUAL_AUTH_USER_MODEL = 'accounts.CustomUser'
SOCIAL_AUTH_CREATE_USERS = True

FACEBOOK_APP_ID = 'XXX'
FACEBOOK_API_SECRET = 'XXX'
FACEBOOK_EXTENDED_PERMISSIONS = ['email','user_birthday','user_hometown','user_location','user_about_me']

LOGIN_URL = '/'
LOGIN_REDIRECT_URL = '/home/'
LOGIN_ERROR_URL = '/login-error/'
SOCIAL_AUTH_DEFAULT_USERNAME = 'social_auth_user'
SOCIAL_AUTH_ENABLED_BACKENDS = ('twitter','facebook','google')

TWITTER_CONSUMER_KEY = 'XXX'
TWITTER_CONSUMER_SECRET = 'XXX' 
```

URL的.py

```
from django.conf.urls import patterns, include, url
from django.contrib.auth.views import login, logout

from frontpage.views import LoginPage, FrontPageView
from frontpage import views
from django.contrib import admin

from social_auth import __version__ as version
from social_auth.utils import setting

admin.autodiscover()

urlpatterns = patterns('',
    url(r'', include('social_auth.urls')),
    url(r'^$', views.LoginPage, name='LoginPage'),
    url(r'^login/$', views.loginreq, name='loginreq'),
    url(r'^newuser/$', views.newuser, name='newuser'),
    url(r'^logout/$', views.logout, name='logout'),
    url(r'^home/$', views.HomePage, name='HomePage'),
    url(r'^jobs/offers$', views.jobsoffers, name='jobsoffers'),
    url(r'^jobs/view$', views.jobsview, name='jobsview'),
    #url(r'^home/$', FrontPageView.as_view(), name='front_list'),
    (r'^admin/jsi18n/$', 'django.views.i18n.javascript_catalog'),

    # Examples:
    # url(r'^$', 'something.views.home', name='home'),
    # url(r'^something/', include('something.foo.urls')),

    # Uncomment the admin/doc line below to enable admin documentation:
    # url(r'^admin/doc/', include('django.contrib.admindocs.urls')),

    # Uncomment the next line to enable the admin:
    url(r'^admin/', include(admin.site.urls)),
) 
```

视图.py

```
class FrontPageView(ListView):
    context_object_name = 'front_list'
    template_name = 'homepage.html'
    queryset = classifield.objects.all()

    def get_context_data(self, **kwargs):
        context = super(FrontPageView, self).get_context_data(**kwargs)
        context['offers'] = offers.objects.all()
        return context

def logout(request):
    auth_logout(request)
    return HttpResponseRedirect('/')

def LoginPage(request):
    classifield_list = classifield.objects.all()
    offers_list = offers.objects.all()
    return render_to_response("login.html", {'classifield_list': classifield_list,'offers_list':offers_list}, context_instance=RequestContext(request))

@login_required
def HomePage(request):
    classifield_list = classifield.objects.all()
    ctx = {'last_login':request.session.get('social_auth_login_backend')}
    return render_to_response("homepage.html", {'classifield_list': classifield_list, 'ctx':ctx}, context_instance=RequestContext(request)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T10:59:57.713

好的，对于其他坚持这一点的人：不要登录到管理员！由于您已登录管理员，因此它会不断覆盖您的管理员用户。退出管理员，它会工作！耶！

# html - IE中的表格呈现不正确

> ID：14553054
> 
> 赞同：1
> 
> 时间：2013-01-27T22:26:52.710
> 
> 标签：html, css, internet-explorer, css-tables, volusion

我在为客户设置的电子商务商店中的 IE 中不正确地呈现表格时遇到了一个真正的问题。这是链接：

[http://jpgrv.zjbzq.servertrust.com/products-s/1819.htm](http://jpgrv.zjbzq.servertrust.com/products-s/1819.htm)

表格是实际包含产品的区域。如果您在 IE 中查看，您会发现行的高度太高。我尝试将 CSS 直接应用于行和列（内联、外部样式表和内部样式表）。

我有一个想法，也许图像太高了，所以我调整了它们的大小并尝试了它，但无济于事。

我已经进行了 Google 搜索，知道在表格和 IE 方面存在很多错误，但我发现的已知问题都没有帮助我找到解决方案。

顺便说一句，当您查看源代码并检查该站点时，它可能看起来像是一堆乱七八糟的表格等，这是因为该站点是在 Volusion 框架内构建的，因此有很多动态生成的内容。

如果有人有任何建议或可以指出我正确的方向，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T20:54:44.990

由于 div “容器”内的 div “add_button” 存在额外的高度。

你可以看到它是这个截图： ![来自开发人员工具的屏幕截图，显示 div 占用了不需要的空间](../Images/4d676636f03d3ccbcfa02801c46ea2fc.png)

# php - 将 div 类添加到 PHP 列表

> ID：14553063
> 
> 赞同：1
> 
> 时间：2013-01-27T22:27:38.043
> 
> 标签：php, css

您好，我有一些 php 正在为我生成一个列表。我添加了

*   咬自己，很高兴它实际上做的事情比给出 ma php 错误

    ```
     <?php
        $termid = arg(2);
        $terms = taxonomy_get_related($termid, $key = 'tid');
        //print_r($terms);
        foreach($terms as $term){

           $link = url('taxonomy/term/'.$term->tid);
           echo '<li><a href="'.$link.'">'.$term->name.'</a></li>';
         }
      ?> 
    ```

    不过，我想为我的列表设置样式并尝试了-

    ```
     <div class="sidey"><?php
        $termid = arg(2);
        $terms = taxonomy_get_related($termid, $key = 'tid');
        //print_r($terms);
        foreach($terms as $term){

           $link = url('taxonomy/term/'.$term->tid);
           echo '<li><a href="'.$link.'">'.$term->name.'</a></li>';
         }
      ?></div> 
    ```

    和-

    ```
     .sidey .inner ul li, .sidey .view-content div.views-row {
        border-bottom-color: #DDDDDD;
    list-style-image: none;
    line-height: 130%;
        padding: 5px 0;
     border-bottom-style: solid;
        border-bottom-width: 1px;
    } 
    ```

    但没有效果。这应该有效还是我在这里错过了一些非常基本的东西？我觉得我是。也试过这个，但再次无济于事-

    ```
     <?php
        $termid = arg(2);
        $terms = taxonomy_get_related($termid, $key = 'tid');
        //print_r($terms);
        foreach($terms as $term){

           $link = url('taxonomy/term/'.$term->tid);
           echo '<div id="sidey"><li><a href="'.$link.'">'.$term->name.'</a></li></div>';
         }
      ?> 
    ```

    谁能指出我正确的方向？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T22:29:56.080

您缺少[无序列表的开头和结尾](http://www.w3schools.com/tags/tag_ul.asp) `<ul></ul>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T22:34:42.280

如果您要为 div 分配一个 ID，那么请确保您打开和关闭您的 UL（就像下面提到的那样），那么您的 CSS 应该是：

```
div#sidey ul li {
    border-bottom-color: #DDDDDD;
    list-style-image: none;
    line-height: 130%;
    padding: 5px 0;
     border-bottom-style: solid;
    border-bottom-width: 1px;
} 
```

# java - 从 Android/Java 中的连接线程读取双精度

> ID：14553064
> 
> 赞同：0
> 
> 时间：2013-01-27T22:27:40.907
> 
> 标签：java, android, bluetooth, double

我目前在`GraphView`GitGub 上使用开发人员 jjoe64 提供的，我想知道如何将`double`我在我的 BT 连接线程类中创建的检索到`GraphView`该类。这是调用随机数据的原始函数，但我想要来自我的蓝牙类的串行数据这个实时图中的当前函数是：

```
private double getRandom() {
    double high = 3;
    double low = 0.5;
    return Math.random() * (high - low) + low;
} 
```

在我的蓝牙课上，我有命令`ConnectedThread.read()`，但它并没有真正起作用。这里是：

```
public static double read() {
    try {
        byte[] buffer = new byte[1024];
        double bytes = mmInStream.read(buffer);
        return bytes;
    } catch(IOException e) {
        return 5;
    }
} 
```

我不确定是不是我的手机太慢了，它运行的是 Android2.3 (DesireHD)，但我学校的教授说如果我只是打电话`ConnectedThread.read()`并让它等于`double`. 有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T22:53:14.610

您没有为开箱即用的解决方案提供足够的信息，但无论如何我都会试一试。

首先，我认为这`mmInStream`是一个`InputStream`或其子类。查看以下 API `int InputStream.read(byte[] b)`：

> 从输入流中读取一些字节并将它们存储到缓冲区数组 b. 实际读取的字节数以整数形式返回。在输入数据可用、检测到文件结尾或引发异常之前，此方法会一直阻塞。

这意味着您从`read()`方法返回的只是已写入`buffer`from的字节数`mmInStream`。这可能不是你想要做的。您可能想要做的只是从该流中读取*值。*为此，您应该：

*   在创建之后将您包装`mmInStream`在 a中：`DataInputStream``mmInStream`

    ```
    mmInStream = yourMethodCreatingInputStream();
    dataInStream = new DataInputStream(mmInStream); 
    ```

*   从 中读取`double`值`dataInStream`。但与所有计算机系统一样，您必须了解输入值的确切格式。您必须参考用于获取输入数据的设备的规范。

现在`dataInStream`派上用场了，因为它抽象了必要的低级 IO 操作并让您专注于数据。它会自动将您对数据的查询转换为 IO 操作。例如：

*   如果你的数据是`double`格式的（我相信根据你教授的话是这样），你的`read()`方法很简单：

    ```
    public static double read() {
        return dataInStream.readDouble();
    } 
    ```

*   如果数据以以下`float`格式出现：

    ```
    public static double read() {
        return (double)dataInStream.readFloat();
    } 
    ```

但同样，请务必查阅您正在使用的设备的规格以了解确切的格式。某些设备可能会以特殊格式向您传递数据，例如：“前 2 个字节是结果值的整数部分，后 2 个字节是小数部分”。作为数据的消费者，您可以遵循其格式。

# less - 少 css &:hover

> ID：14553066
> 
> 赞同：13
> 
> 时间：2013-01-27T22:27:43.910
> 
> 标签：less

我怎样才能用更少的东西创建这个类？

```
.class {
    display: none;
}

a:hover .class {
    display: block; 
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-27T22:31:11.320

像这样？

```
.class {
    display: none;

    a:hover & {
        display: block;
    }
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-01-27T15:38:43.783

```
.class {
  display: none;

  &:hover {
    display: block;
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-17T20:55:28.143

我从您给定的 CSS 代码中假设您的 HTML 结构是这样的：

```
<a>
    <div class="class">Content</div>
</a> 
```

您会很高兴知道使用 Less 可以轻松实现您想要实现的目标；这是下面显示的代码：

```
a {
    &:hover {
        .class {
            //Apply styling here
        }
    }
} 
```

我希望这有帮助。

# batch-file - 批量文本中间的光标

> ID：14553073
> 
> 赞同：-2
> 
> 时间：2013-01-27T22:28:59.567
> 
> 标签：batch-file

我正在寻找一种将光标放置在几行回显命令之间的方法，因此暂停似乎位于代码的中心，而不是在末尾，同时仍显示最后一行文本而不继续下一行标签直到点击任意键。这可能吗？我希望实际文本的最后一行是页脚，与上面的文本分开。

目前，我的排序看起来与此类似：

```
:LABEL
CLS
ECHO text1
ECHO.
ECHO.
(want the PAUSE to appear here)
ECHO.
ECHO.
ECHO text2
PAUSE (while the PAUSE is really here to prevent text2 from being lost)
GOTO OTHERLABEL 
```

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T14:47:31.287

我想我知道你在问什么，如果我错了，请纠正我。你想要这个功能：

```
echo hello
pause
echo bye 
```

但是你想在屏幕上切换暂停和回声再见的位置。如果是这样，那就不容易了。我想你可以使用一个 vbscript，一旦在上面的代码中运行第一个暂停，就会向批处理文件发送一个密钥，这会回显。很多次，然后再次暂停，然后 vbscript 可以在批处理文件中向上滚动。这不值得。

# javascript - jquery 在并发动画结束时

> ID：14553077
> 
> 赞同：1
> 
> 时间：2013-01-27T22:29:22.740
> 
> 标签：javascript, jquery, animation

所以我在一个元素上运行两个并发动画，我想在两个动画结束后做一些事情

```
 $("#MyDiv").stop().animate({left: "-=" + 500 + "px"}, 1000);
        $("#MyDiv").animate({top: "-=" + 500 + "px"}, 1000, 

function() {
//do something here
}); 
```

所以这是我的方法。我想知道是否有更好的方法，因为第一个动画可能会提前或推迟几毫秒结束。

**第二个问题： .stop().animate() 和 .animate() 之间有什么区别吗？如果是，那是什么？**

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T22:33:15.407

> “因为第一个动画可能会提前或推迟几毫秒结束”

不，您已将两个动画都设置为 1000 毫秒。

> “ .stop().animate() 和 .animate() 之间有什么区别吗？如果是，那是什么？”

是的，如果动画处于活动状态并调用了 stop()，则第一个动画将停止。

由于您正在为相同的元素设置动画，因此您不需要选择它两次。我建议你这样做：

```
$("#MyDiv").stop(true).animate({left: "-=" + 500 + "px", top: "-=" + 500 + "px"}, 1000, 
function(){
    //animation complete
}); 
```

如果动画“卡住”，您可以在 stop 方法中添加第二个布尔值`stop(true, true)`（“jumpToEnd”）。第一个将清除动画队列。如果不看更多代码，很难说出你需要什么。

# facebook - 构建类似 TweetDeck 的东西——存储所有推文是否现实？

> ID：14553078
> 
> 赞同：0
> 
> 时间：2013-01-27T22:29:25.043
> 
> 标签：facebook, twitter

我正在创建一个用于问答的应用程序，它将 Twitter 提及/DM、Facebook 墙上的帖子/消息以及电子邮件和短信统一到一个收件箱中。我知道我将如何处理 SMS（存储每条传入消息和传出响应），但我想知道将相同的方法应用于 twitter/facebook 消息是否现实。

我想我需要存储它们，这样我至少可以将它们标记为已读/未读。这就是 TweetDeck 的做法吗？我无法想象他们在不缓存任何东西的情况下不断地轮询 API。

顺便说一句，如果您知道已经有一个应用程序可以做到这一点，那就太棒了。除了 SMS 和电子邮件之外，Hootsuite 都做的很奇怪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T06:57:24.847

假设您正在构建一个移动应用程序（因为您提到了 SMS），如果您的目标是支持任意 Facebook 和 Twitter 帐户（即包括非常繁忙的帐户）并长时间使用，那么您无法存储所有移动设备上的推文和帖子：所需的存储空间会随着时间的推移而增长，超过任何设备的容量。

您可以完整存储合理数量的“最近”推文/帖子；这些构成了 UI 视图的支持模型。当用户导航通过任一端时，您可以通过 API 检索更多内容，并且您将对这个集合执行内务管理，使其不会变得太大，并在必要时丢弃旧的。

（这个集合最终可能会变得有差距：例如，如果我一周没有运行该应用程序，当我启动它时，它会检索最近一天的内容，在昨天的内容和一周前的内容之间留下一个差距。Twitter 的应用程序这样做并显示空白，允许用户通过 API 填写它们。）

如果您需要跟踪已读/未读状态，您可以为更多项目存储此 ID 和唯一 ID；但同样，您最终也需要清除这些。

您可能想查看[Twitter 用户流](https://dev.twitter.com/docs/streaming-apis/streams/user)功能；[Facebook 的实时更新](https://developers.facebook.com/docs/reference/api/realtime/)不太适合移动应用程序（除非有您自己的服务器支持）。

# z-index - 无法使 z-index 工作

> ID：14553080
> 
> 赞同：1
> 
> 时间：2013-01-27T22:29:55.577
> 
> 标签：z-index

请帮忙！我无法让它工作，我不明白为什么。

这是一个简单的代码，但它只是不工作。

我希望 folder_image.png 出现在 folder.png 下，仅此而已！非常感谢！！！

```
<!DOCTYPE html>
<html>
<head>
    <style>
    .container {
        width:  136px;
        height: 201px;
        background: url(http://s-ola.me/img/folder.png) no-repeat;
        z-index: 2;
                    position:relative;
    }

    .folder {
        width:  136px;
        height: 101px;
        background: url(http://s-ola.me/img/folder_image.png) no-repeat;
        z-index: 1;
                    position:relative;
    }

    .text {

    }
    </style>
</head>
<body>
    <div class="container">
    <div class="folder"></div>
    <div class="text">text</div>
    </div>

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T23:41:53.517

I made this solution but i dont like it. It didnt answered on my question.

```
<html>
<head>
    <style>

    #test{z-index:-10; position:relative;}
    .container {
        width:  136px;
        height: 201px;
        background: url(http://s-ola.me/img/folder.png) no-repeat;
        position: relative;
        margin:0 auto;
    }

     .folder {
        width:  136px;
        height: 101px;
        background: url(http://s-ola.me/img/folder_image.png) no-repeat;
        z-index:-1;
        position:relative;
    }
    .text {
 margin:0 auto;
 position:relative;
 margin-left:40px;
    }
    </style>
</head>
<body>
<div id="test">
    <div class="container">
        <div class="folder"></div>
        <div class="text">text</div>
    </div>
    </div>
</body>
 </html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T22:32:55.093

把这个

```
<div class="folder" style="{z-index: 2};"> 
```

并将其从 CSS 中取出

# c++ - C++：如何让不同的类函数操作我的类成员变量

> ID：14553082
> 
> 赞同：2
> 
> 时间：2013-01-27T22:30:06.183
> 
> 标签：c++, oop, object, external, overriding

我可能遗漏了一些非常简单的东西，但如果有人能指出我正确的方向，我将不胜感激。

我有 2 个类：A 和 B。A 有一组数据结构和修改它们的函数（举个假设的例子，比如向数据结构添加、删除、插入等）。B 具有一组函数，这些函数指定***如何***在 A 中修改数据结构。

为了可扩展性，B被继承以反映A的数据结构上不同的可能行为。B 的一种实现可以选择添加到 A 的数据结构的开头，从结尾删除，等等。另一种实现可能会添加到末尾，从开头删除，等等。

我在创建A的过程中传递了一个基类B的对象，这样A的泛型addNode()、deleteNode()等函数实际上可以查找到创建过程中传递给它的特定类型的B对象，并参考它在 B 中的实施，以了解要遵循的操作。

在下面的这个假设示例中，所关注的数据结构是一个双向链表。在我的问题中，数据结构本身不是问题。我担心如何在 B 的派生类中调用正确的方法来修改我在 A 中的数据结构。

A类：

```
class A
{
    static A create(B bObj);  // returns an A object after calling the constructor
    void addNode(int);
    void deleteNode();
    ...
private:
    struct myNode
    {
        int value;
        myNode *next;
        myNode *prev;
    }
    myNode *head;
    myNode *tail;
} 
```

B类：

```
class B
{
    virtual void addNode(int);
    virtual void deleteNode();
    ...
} 
```

ChildB1 类：

```
class ChildB1
{
    void addNode(int)
    {
        // code for add to the front
    }
    void deleteNode()
    {
        // code for delete from the back
    }
} 
```

ChildB2 类：

```
class ChildB2
{
    void addNode(int)
    {
        // code for add to the back
    }
    void deleteNode()
    {
        // code for delete from the front
    }
} 
```

我遇到的问题是如何让 B 的子类访问正在运行的 AI 的当前对象？假设，在使用 create() 方法创建 A (aObj) 的对象时，我传递了对对象 ChildB2 的引用。

```
B *bObj = new ChildB2();
A aObj = A.create(*bObj); 
```

现在我在调用aObj.add()的时候，希望它调用ChildB2类的add()方法，这样它就可以对A中的链表进行操作，并将其添加到链表的后端。但是 ChildB2 类的 add() 函数是如何访问 aObj 的链表的呢？

如果这个问题冗长而幼稚，我深表歉意。如果需要，我很乐意提供进一步的说明。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T23:28:11.280

加`B`为好友`A`。

```
class A
{
   friend class B;
   // the rest
}; 
```

由于友谊不是继承的，`B`因此必须明确为其继承人提供访问`A`私人部分的权限。

```
class B
{
  protected:
    // since A::myNode is private, redeclare it here
    // for heirs
    typedef A::myNode myNode;

    // access to A parts
    void getAParts (A*, myNode*** head, myNode*** tail)
    {
      *head = &a->head;
      *tail = &a->tail;
    }
    // the rest

}; 
```

几点注意事项：您应该通过引用而不是值传递`B`给，否则您的对象将被*切片*。您还需要以某种方式管理生命周期。`create``ChildB2`*`B`*

# c++ - 递归返回链表中的最后一个节点

> ID：14553084
> 
> 赞同：0
> 
> 时间：2013-01-27T22:30:16.653
> 
> 标签：c++, list, linked-list

我正在尝试编写函数以递归方式返回链表的最后一个节点，而无需声明任何局部变量。这是正确的吗？

```
ListNode* lastPtr(ListNode* list){
If(list = NULL)
Return NULL;
Else 
List = lastPtr(list->next);
If(list->next = NULL)
Return list;
} 
```

语言是c++

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T22:48:30.770

```
ListNode *lastPtr(ListNode* list) {
return (list && list->next) ? lastPtr(list->next) : list;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T22:43:17.767

C++ 中的等号与 C 中一样，而 Java 中的等号是`==`而不是`=`

尝试更正您的代码。

```
ListNode * lastNode(ListNode *list)
{
    if (list!=NULL)
    {
        if (list->next==NULL)
            return list;
        else return lastNode(list->next);
    }
    else return NULL;
} 
```

# ruby-on-rails - Rails：after_add 给出错误的参数数量错误（1 代表 0）

> ID：14553085
> 
> 赞同：6
> 
> 时间：2013-01-27T22:30:28.070
> 
> 标签：ruby-on-rails, arguments

我有以下型号：

```
class Review < ActiveRecord::Base
  attr_accessible :votes_sum

  has_many :votes, :as => :voteable,
    :after_add => :sum_votes,
    :after_remove => :sum_votes

  def sum_votes
    update_attribute(:votes_sum, votes.sum(:value))
  end
end 
```

和：

```
class Vote < ActiveRecord::Base
  attr_accessible :value

  belongs_to :voteable, :polymorphic => true
end 
```

当我尝试创建投票时，我收到此错误：

```
wrong number of arguments (1 for 0) 
```

在 review.rb 的第 13 行触发：

```
def sum_votes 
```

这个论点从何而来？当我调用 sum_votes 时，我没有传递参数。

更新：

完整的堆栈跟踪：

```
app/models/review.rb:13:in `sum_votes'
activerecord (3.2.11) lib/active_record/associations/collection_association.rb:507:in `block in callback'
activerecord (3.2.11) lib/active_record/associations/collection_association.rb:504:in `each'
activerecord (3.2.11) lib/active_record/associations/collection_association.rb:504:in `callback'
activerecord (3.2.11) lib/active_record/associations/collection_association.rb:352:in `add_to_target'
activerecord (3.2.11) lib/active_record/associations/collection_association.rb:112:in `build'
C:in `build'
app/models/user.rb:251:in `build_vote'
app/controllers/votes_controller.rb:9:in `create'
actionpack (3.2.11) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
actionpack (3.2.11) lib/abstract_controller/base.rb:167:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/rendering.rb:10:in `process_action'
actionpack (3.2.11) lib/abstract_controller/callbacks.rb:18:in `block in process_action'
activesupport (3.2.11) lib/active_support/callbacks.rb:425:in `_run__943985968__process_action__580999264__callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.11) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.11) lib/abstract_controller/callbacks.rb:17:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/rescue.rb:29:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
activesupport (3.2.11) lib/active_support/notifications.rb:123:in `block in instrument'
activesupport (3.2.11) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
activesupport (3.2.11) lib/active_support/notifications.rb:123:in `instrument'
actionpack (3.2.11) lib/action_controller/metal/instrumentation.rb:29:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/params_wrapper.rb:207:in `process_action'
activerecord (3.2.11) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (3.2.11) lib/abstract_controller/base.rb:121:in `process'
actionpack (3.2.11) lib/abstract_controller/rendering.rb:45:in `process'
actionpack (3.2.11) lib/action_controller/metal.rb:203:in `dispatch'
actionpack (3.2.11) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
actionpack (3.2.11) lib/action_controller/metal.rb:246:in `block in action'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:73:in `call'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:36:in `call'
journey (1.0.4) lib/journey/router.rb:68:in `block in call'
journey (1.0.4) lib/journey/router.rb:56:in `each'
journey (1.0.4) lib/journey/router.rb:56:in `call'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:601:in `call'
warden (1.2.1) lib/warden/manager.rb:35:in `block in call'
warden (1.2.1) lib/warden/manager.rb:34:in `catch'
warden (1.2.1) lib/warden/manager.rb:34:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
rack (1.4.4) lib/rack/etag.rb:23:in `call'
rack (1.4.4) lib/rack/conditionalget.rb:35:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/head.rb:14:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/flash.rb:242:in `call'
rack (1.4.4) lib/rack/session/abstract/id.rb:210:in `context'
rack (1.4.4) lib/rack/session/abstract/id.rb:205:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/cookies.rb:341:in `call'
activerecord (3.2.11) lib/active_record/query_cache.rb:64:in `call'
activerecord (3.2.11) lib/active_record/connection_adapters/abstract/connection_pool.rb:479:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `_run__942047474__call__281283767__callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.11) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.11) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/reloader.rb:65:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.11) lib/rails/rack/logger.rb:32:in `call_app'
railties (3.2.11) lib/rails/rack/logger.rb:16:in `block in call'
activesupport (3.2.11) lib/active_support/tagged_logging.rb:22:in `tagged'
railties (3.2.11) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.4) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.4) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.11) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.4) lib/rack/lock.rb:15:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/static.rb:62:in `call'
railties (3.2.11) lib/rails/engine.rb:479:in `call'
railties (3.2.11) lib/rails/application.rb:223:in `call'
rack (1.4.4) lib/rack/content_length.rb:14:in `call'
railties (3.2.11) lib/rails/rack/log_tailer.rb:17:in `call'
rack (1.4.4) lib/rack/handler/webrick.rb:59:in `service'
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-03-29T22:36:51.053

Mongoid 将关联集合中创建的文档传递给回调方法，请参见此处：[关系回调](http://mongoid.org/en/mongoid/docs/callbacks.html#relation_callbacks)

即使您不使用它，您也必须更改方法的签名才能接收该文档（我也改进了该方法，使用`inc`）：

```
def sum_votes(vote)
  inc(:votes_sum, 1)
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T22:32:45.277

中的`sum`方法`votes.sum(:value)`不应该有论点，只是：`votes.sum`总结所有投票......

你到底是什么意思`:value`？

编辑

如果您正在寻找值的总和：

```
votes.values.sum 
```

# c++ - 烦人的错误：“{”标记之前的预期类名

> ID：14553087
> 
> 赞同：1
> 
> 时间：2013-01-27T22:30:30.243
> 
> 标签：c++, oop, compiler-errors, arduino

我一直在尝试使用 arduino 库编译一个基本程序，并且在“{”令牌错误之前一直得到这个预期的类名。我是 C++ 的新手，因此非常感谢详细的解释/插入式解决方案。

这是代码：

**串行GSM.h**

```
#ifndef _SerialGSM_H
#define _SerialGSM_H
#include "Arduino.h"
#include <SoftwareSerial.h>

#define SERIALTIMEOUT 2000
#define PHONESIZE 13
#define MAXMSGLEN 160

class SerialGSM : public SoftwareSerial {
public:
  SerialGSM(int rxpin,int txpin);
  void FwdSMS2Serial();
  void SendSMS();
  void SendSMS(char * cellnumber,char * outmsg);
  void DeleteAllSMS();
  void Reset();
  void EndSMS();
  void StartSMS();
  int ReadLine();
  int ReceiveSMS();
  void Verbose(boolean var1);
  boolean Verbose();
  void Sender(char * var1);
  char * Sender();
  void Rcpt(char * var1);
  char * Rcpt();
  void Message(char * var1);
  char * Message();
  void Boot();

  boolean verbose;
  char sendernumber[PHONESIZE + 1];
  char rcpt[PHONESIZE + 1];
  char outmessage[160];
  char inmessage[160];

protected:
  unsigned long lastrec;

};

#endif /* not defined _SerialGSM_H */ 
```

**串行GSM.cpp**

```
// SerialGSM version 1.1
// by Meir Michanie
// meirm@riunx.com

// error codes
// http://www.developershome.com/sms/resultCodes2.asp
#include <SerialGSM.h>

SerialGSM::SerialGSM(int rxpin,int txpin):
SoftwareSerial(rxpin,txpin)
{
 verbose=false;
}

void SerialGSM::FwdSMS2Serial(){
  Serial.println("AT+CMGF=1"); // set SMS mode to text
  this->println("AT+CMGF=1"); // set SMS mode to text
  delay(200);
  this->ReadLine();
  Serial.println("AT+CNMI=3,3,0,0"); // set module to send SMS data to serial out upon receipt 
  this->println("AT+CNMI=3,3,0,0"); // set module to send SMS data to serial out upon receipt 
  delay(200);
  this->ReadLine();
}

void SerialGSM::SendSMS(char * cellnumber,char * outmsg){
  this->Rcpt(cellnumber);
  if (verbose) Serial.println(rcpt);
  this->StartSMS();
  this->Message(outmsg);
  Serial.print(outmessage);
  this->print(outmessage);
  this->EndSMS();
  delay(500);
  this->ReadLine();
}

void SerialGSM::SendSMS(){
  if (verbose) Serial.println(rcpt);
  if (verbose) Serial.println(outmessage);
  this->StartSMS();
  Serial.print(outmessage);
  this->print(outmessage);
  this->EndSMS();
  delay(500);
  this->ReadLine();
}

void SerialGSM::DeleteAllSMS(){
  Serial.println("AT+CMGD=1,4"); // delete all SMS
  this->println("AT+CMGD=1,4"); // delete all SMS
  delay(200);
  this->ReadLine();
}

void SerialGSM::Reset(){
  Serial.println("AT+CFUN=1,1"); // Reset Modem
  this->println("AT+CFUN=1,1"); // Reset Modem
  delay(200);
  this->ReadLine();
}

void SerialGSM::EndSMS(){
  this->print(char(26));  // ASCII equivalent of Ctrl-Z
  Serial.println();

  //delay(5 * 1000); // the SMS module needs time to return to OK status
}

void SerialGSM::StartSMS(){

  Serial.println("AT+CMGF=1"); // set SMS mode to text
  this->println("AT+CMGF=1"); // set SMS mode to text
  delay(200);
  this->ReadLine();

  Serial.print("AT+CMGS=");
  this->print("AT+CMGS=");

  this->print(char(34)); // ASCII equivalent of "

  Serial.print(rcpt);
  this->print(rcpt);

  this->println(char(34));  // ASCII equivalent of "

  delay(500); // give the module some thinking time
  this->ReadLine();

}

int SerialGSM::ReadLine(){
  static int pos=0;
  char nc;
  while (this->available()){
    nc=this->read();
    if (nc == '\n' or (pos > MAXMSGLEN) or ((millis()> lastrec + SERIALTIMEOUT)and (pos > 0)) ){
      nc='\0';
      lastrec=millis();
      inmessage[pos]=nc;
     pos=0;
     if (verbose) Serial.println(inmessage);
      return 1;
    }
    else if (nc=='\r') {
    }
    else{
      inmessage[pos++]=nc;
      lastrec=millis();
    }
  }
  return 0;
}

int SerialGSM::ReceiveSMS(){
  static boolean insms=0;
  if (this->ReadLine()){
  // Get the number of the sms sender in order to be able to reply
    if ( strstr(inmessage, "CMT: ") != NULL ){
        insms=1;
        int sf=6;
        if(strstr(inmessage, "+CMT:")) sf++; 
            for (int i=0;i < PHONESIZE;i++){
              sendernumber[i]=inmessage[sf+i];
            }
        sendernumber[PHONESIZE]='\0';
        return 0;
     }else{ 
        if(insms) {
            insms=0;
            return 1;
        }
    }
  }
  return 0;
}

boolean SerialGSM::Verbose(){
    return verbose;
}

void SerialGSM::Verbose(boolean var1){
    verbose=var1;
}

char * SerialGSM::Sender(){
    return sendernumber;
}

char * SerialGSM::Rcpt(){
    return rcpt;
}

char * SerialGSM::Message(){
    return inmessage;
}

void SerialGSM::Sender(char * var1){
    sprintf(sendernumber,"%s",var1);
}

void SerialGSM::Rcpt(char * var1){
    sprintf(rcpt,"%s",var1);
}

void SerialGSM::Message(char * var1){
    sprintf(outmessage,"%s",var1);
}

void SerialGSM::Boot(){
  int counter=0;
  while(counter++ < 15){
    if (verbose) Serial.print(".");
    delay(1000);
  }
  if (verbose) Serial.println();

} 
```

**阿杜诺素描**

```
#include <SerialGSM.h>
SerialGSM cell(2,3);

boolean sendonce=true;
void setup(){
  Serial.begin(9600);
  // cell.begin(9600);
  cell.Verbose(true);
  cell.Boot();
  cell.DeleteAllSMS();
  cell.FwdSMS2Serial();
 }

void loop(){
  if (cell.ReceiveSMS()){
     Serial.print("Sender: ");
     Serial.println(cell.Sender());
     Serial.print("message: ");
     Serial.println(cell.Message());
     cell.DeleteAllSMS();
  }
} 
```

编辑：

这是完整的错误消息：/home/agt/arduino/libraries/SerialGSM.h:10: error : expected class-name before '{' token 谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T22:41:08.170

您正在头文件“arduino.h”和“serialgsm.h”之间建立相互包含。通过使用前向声明来解决这个问题，错误很可能会消失（或者你至少会得到一个不同的错误）。

# javascript - Jquery在函数之间传递参数

> ID：14553092
> 
> 赞同：-2
> 
> 时间：2013-01-27T22:30:53.933
> 
> 标签：javascript, jquery, html, css

嘿，我想从 jquery 中的函数传递一个参数，但我无法让它工作。我究竟做错了什么？我想将点击函数中的“名称”传递给对话框块函数以防止重复代码

**更新：**我在函数之后定义了名称。但是我仍然不能像这样传递它 <%=GetUserName(name)%>

**更新 2** jsFiddle 链接 [http://jsfiddle.net/bbKw8/](http://jsfiddle.net/bbKw8/)

```
 <div id="dialog-block" >
                <p>
                    <b>Friends List:</b>
                    <% =GetFriends(0) %>
                </p>
            </div>
            <div id="Div1">
                <p>
                    <b>Friends List:</b>
                    <% =GetFriends(0) %>
                </p>
            </div>
            <script type="text/javascript">

                // the jQuery document ready handler
                $(function () {
                    var name;
                    // create our dialog
                    $('#dialog-block').dialog({
                        title: '<%=GetUserName(name)%>',
                        autoOpen: false,
                        width: 400,
                        buttons: {
                            "Close": function () {
                                closeDialog($(this))
                            }
                        }
                    });

                    // the button to open the dialog
                    $('#user0chair,#apDiv1').click(function (event) {
                        if (this.id == 'user0chair') {
                            $('#dialog-block').dialog('open');
                            name = 1;
                        }
                        else if (this.id == 'user1chair') {
                            $('#dialog-block').dialog('open');
                        }
                    });

                });

                function closeDialog(elem) {
                    elem.dialog("close");
                }
            </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T22:40:29.477

由于您未能`name`使用`var`关键字进行定义，因此页面上的任何其他代码都可以访问它。

除了这种特殊情况，变量具有函数作用域，因此`var name...`在比需要访问它的两个函数更高的级别定义 a 。

[为什么你应该使用'var'](http://scribu.net/blog/javascript-var-keyword-for-php-developers.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T22:40:51.037

就在之后

```
 $(function () { 
```

放 `var name ;`

解释 ：

在全局范围内创建变量，然后我们从一个函数中分配它，它可以在它之外访问..

您将变量包装为文本！周围有 qouts ，这意味着这是一些文本而不是变量，您应该将行更改为标题：

```
'<%=GetUserName(' + name + ')%>' 
```

这一行意味着将引号之间的任何内容视为文本，当您命名时，只需获取它的值并将其附加到文本中，然后完成文本..

编辑：在这里等一下，你不能将javascript变量传递给服务器端的函数，除了ajax，但不是这样..你应该使用post或get将它发送到服务器，然后从那里抓取它并触发函数并返回结果！

# android - 我如何从一个活动中获取文本并将其放在另一个活动的按钮上。

> ID：14553095
> 
> 赞同：0
> 
> 时间：2013-01-27T22:31:22.553
> 
> 标签：android

我想知道如何从活动 B 中的编辑文本中获取文本并将该文本放在活动 A 的按钮上。我想这样做，以便当我按下活动 b 上的“输入”按钮时它会得到文本的edittext并替换活动A中按钮的文本。我认为它是这样的

```
 public void pressEnter (View v){
    EditText et = (EditText) findViewById(R.id.editText1);
    String t = et.getText().toString();
    Button p1_button = (Button)findViewById(R.id.button1);
    p1_button.setText(t);
} 
```

但我不知道如何从要设置文本的活动 A 中获取按钮的 ID。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T22:36:06.747

一种选择是使用`startActivityForResult()`.

[在这个](https://stackoverflow.com/a/10407371/554002)答案中可以找到很好的用法示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T00:57:16.013

如果您将变量设为静态，您可以使用点运算符互相引用它们，例如：

```
ActivityA.p1_button or ActivityB.t 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T23:50:24.353

您也许可以使用 messenger，当您想与 UI 线程交谈时，它也适用于非 UI 线程： [如何从 IntentService 收集信息并更新 Android UI](https://stackoverflow.com/questions/7871521/how-to-collect-info-from-intentservice-and-update-android-ui)

# asp.net - System .NET Mail html 未在 Outlook 中正确格式化

> ID：14553097
> 
> 赞同：1
> 
> 时间：2013-01-27T22:31:32.667
> 
> 标签：asp.net, .net, outlook, system.net.mail

我有使用 system.net.mail 发送 html 格式电子邮件的代码。它们在基于 Web 的电子邮件服务（GMail、Hotmail 等）中按需要显示，但在 Outlook 中，html（特别是图像）显示不正确。

当您双击电子邮件将其放大时，图像不会随 div 的其余部分一起展开。html如下：

```
strHtml = "<html><body><div style='background-color:#EDF4F8;color:#fff;width:740px;'>";
strHtml += "<div style='width:100%;'><img src='cid:banner' width='100%'/></div><div"    
strHtml += "style='padding:40px;'>";
strHtml += "<div style='font-size:9pt;font-family:'Verdana',sans-serif;padding-top:7;'>";
strHtml += "</div>";
strHtml += "</div></div></body></html>";

SmtpClient client = new SmtpClient("xxx");
client.Credentials = new NetworkCredential("x", "x", "xxx");
MailMessage message = new MailMessage();
message.From = new MailAddress("xx");
message.To.Add("xx");
AlternateView htmlView = AlternateView.CreateAlternateViewFromString(strHtml, null, "text/html");
LinkedResource r = new LinkedResource("c:\\blah.png", "image/png");
htmlView.LinkedResources.Add(r);
message.AlternateViews.Add(htmlView);
message.IsBodyHtml = true;
mailServer.Send(message); 
```

同样，这在 GMail、Hotmail 等中工作正常，链接的资源图像显示和所有内容，但不是 Outlook。具体来说：

1.  在 Outlook 中，我在上面设置的 40 像素的填充不显示
2.  如果您双击电子邮件以在其自己的窗口中打开它，则上面 html 中的横幅图像不会随电子邮件的其余部分一起展开。它在创建时保持其大小（740 像素）。在所有其他电子邮件客户端中，图像扩展了 div 的宽度。

我在这里想念什么？为什么这会出现在其他客户端而不是 Outlook 中？Outlook 是否在电子邮件中嵌入了一些额外的内容，从而导致 HTML 失效？我知道至少有**一些**html 可以正常工作，因为我设置的背景颜色会显示出来，并且我已经摆弄了文本颜色和字体粗细，它们都显示在 Outlook 中。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T22:38:03.973

您缺少的是基于 Web 的浏览器使用您的 Web 浏览器来呈现图像。Outlook 不使用 Web 浏览器，而是使用更有限的自定义 HTML 呈现引擎。对于其他不使用内置 HTML 呈现的基于应用程序的客户端，您可能会发现类似的问题（每个客户端的处理方式略有不同）。

您可能会发现这些链接很有帮助：

[http://www.campaignmonitor.com/css/](http://www.campaignmonitor.com/css/) [http://www.versapay.com/developer-blog/the-art-and-science-of-email-rendering-across-email-clients/](http://www.versapay.com/developer-blog/the-art-and-science-of-email-rendering-across-email-clients/)

有一项服务可以向您显示主要客户的预览，但它不是免费的 [http://litmus.com/email-testing](http://litmus.com/email-testing)

# windows - 'and' 未被识别为内部或外部命令

> ID：14553098
> 
> 赞同：1
> 
> 时间：2013-01-27T22:31:34.750
> 
> 标签：windows, batch-file

如何检查是否存在带空格的目录或文件名

```
@echo off
if not exist "C:\"Documents and Settings"\box\putty\file"
( 
echo hello
)
pause 
```

错误：

```
'and' is not recognized as an internal or external command,
operable program or batch file.
hello
Press any key to continue . . . 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T22:32:29.070

取出其他引号，路径仅被一组引号包围（`""`）

```
@echo off
if not exist "C:\Documents and Settings\box\putty\file" ( 
echo hello
)
pause 
```

确保中间有空格`" (`

# javascript - 查找线或点是否靠近线

> ID：14553105
> 
> 赞同：7
> 
> 时间：2013-01-27T22:32:52.710
> 
> 标签：javascript, coordinates

我在这里有这段代码来确定一条线是否在一个圆圈中。（也许您可以使用它来作为您的答案的基础）

```
/**
*@param l1  Line point 1, containing latitude and longitude
*@param l2  Line point 2, containing latitude and longitude
*@param c   Center of circle, containing latitude and longitud
*@param r   Radius of the circle
**/
Maps.ui.inCircle = function(l1, l2, c, r){
    var a = l1.lat() - l2.lat()
    var b = l1.lng() - l2.lng()
    var x = Math.sqrt(a*a + b*b)
    return (Math.abs((c.lat() - l1.lat()) * (l2.lng() - l1.lng()) - (c.lng() - l1.lng()) * (l2.lat() - l1.lat())) / x <= r);
} 
```

这非常适合。但是现在我需要确定一个点是否在一条线周围的区域中。例如，这里的蓝点将返回 true，而紫色线 I 将返回 true。但不是绿线或绿点。我还需要找出一条线是否穿过这条线。

![在此处输入图像描述](../Images/60464bca90e6755503f729415bdb2008.png)

这是我的代码，用于查看一条线是否与这条线相交：

```
function getLineIntersaction(y1,x1,y2,x2, y3,x3,y4,x4){
    if (Math.max(X1,X2) < Math.min(X3,X4)) // This means no same coordinates
        return false;  
    m1 = (y1-y2)/(x1-x2); 
    m2 = (y3-y4)/(x3-x4); 
    c1 = y1-m1x1; 
    c2 = y3-m2x3; 
    if(m1=m2)//segments are parallel.
        return false;
    var x = (c1-c2)/(m2-m1); 
    if(!isNaN(x) && isFinite(x)){
        if( x < Math.max(Math.min(x1,x2),math.min(x3,x4)) || x > Math.min(Math.max(x1,x2),Math.max(x3,x4)))
            return false;
        else
            return true;
    }
    return false;
} 
```

所以这需要与其他代码集成。

我怎样才能做到这一点？我可以将函数传递一条线，也可以只传递一个点。

如果传递了一行，那么我们将运行上述函数。我希望它返回一个数组。如果数组中的第一项靠近它（在红色区域中），它将返回，如果线段切割线，则数组中的第二项将返回。这意味着如果它只是一个点，那么第二项将永远是错误的。

**问题**

如何判断一条线或点是否位于红色区域内？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-28T01:32:45.337

*引用我对[这个问题的回答](https://stackoverflow.com/questions/14371841/finding-if-a-point-is-on-a-line/14372111#14372111)*

第一步是找到点在直线上的法线投影。这其实很简单：取点 1 到目标的距离，点 2 到目标的距离，分别称它们为 D1 和 D2。然后计算`D1+(D2-D1)/2`。这是从点 1 到直线上投影点的距离。

您现在可以找到该点，并获得从该点到目标的距离。如果距离为零，则目标正好在线上。如果距离小于 5，则目标距离小于 5px，以此类推。

编辑：一张照片值一千字。这是一个图表：

[![图表](../Images/d9fcab10d50fd71da647ea94b41eda54.png)](https://i.stack.imgur.com/cvaMu.png)
[（来源：[adamhaskell.net](http://adamhaskell.net/img/schematic.png)）]

（事后看来，可能应该让这些圆圈变成不同的颜色......另外，紫色线应该垂直于线 AB。用蓝色线怪我的糟糕目标！）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T22:49:13.287

你需要找到一个点到直线的距离，d。

首先，得到一条垂直于原线的斜率。（将其保留为比率很方便：`dx,dy`是原始斜率，`dy,-dx`是垂线，其中 dx 是原始直线中 x 的差异，dy 是原始直线的 y 差异。）

要测试点 p1，请获取原始直线与通过 p1 的垂线的交点 (p2)。换句话说，原始线与线的`p2`交点`(p2.x+dy, p2.y-dx)`

如果 p2 位于原直线的端点之间，那么到直线的距离 (d) 就是 P1 和 P2 之间的距离。

如果 P2 位于原始线的端点之外，则到线的距离 (d) 是从 P1 到原始线端点的距离中的较短者。

```
original line: points pq1 and pq2
point to measure: p1
distance to line: d

dx = pq2.x - pq1.x
dy = pq2.y - pq1.y

p2.x = p1.x + dy // get perpendicular, arbitrary length
p2.y = p1.y - dx

px = intersection(pq1-pq2, p1-p2)

if px.x is between pq1.x and pq2.x inclusive then // check y's instead if it's near vertical
  d = distance(p1-px)
else
  d = minimum(distance(p1, pq1), distance(p1, pq2))
end if 
```

# ruby-on-rails - 为什么这个请求需要 10 倍的时间？

> ID：14553110
> 
> 赞同：-1
> 
> 时间：2013-01-27T22:33:18.193
> 
> 标签：ruby-on-rails, performance, file-upload, paperclip, rmagick

我正在我的 MacOS 和 VPS 上下文上试验 Rails 应用程序的上传操作。在我的 MacOS 上，我看到：

```
Completed 200 OK in 462ms (Views: 0.2ms | ActiveRecord: 19.4ms) 
```

但是，在 VPS 上我得到：

```
Completed 200 OK in 21762ms (Views: 0.1ms | ActiveRecord: 29.0ms) 
```

Rails 动作只是用回形针保存文件，用 rmagick 处理如下：

```
命令 :: identify -format '%wx%h,%[exif:orientation]' '/var/folders/dp/d61_ggqs0zvg9dcnybvfjgb40000gn/T/Bildschirmfoto 2013-01-27 um 16.39.0020130127-3196-8zjox1.png[0] '
命令 :: identify -format %m '/var/folders/dp/d61_ggqs0zvg9dcnybvfjgb40000gn/T/Bildschirmfoto 2013-01-27 um 16.39.0020130127-3196-8zjox1.png[0]'
命令 :: identify -format %m '/var/folders/dp/d61_ggqs0zvg9dcnybvfjgb40000gn/T/Bildschirmfoto 2013-01-27 um 16.39.0020130127-3196-8zjox1.png[0]'
命令 :: convert '/var/folders/dp/d61_ggqs0zvg9dcnybvfjgb40000gn/T/Bildschirmfoto 2013-01-27 um 16.39.0020130127-3196-8zjox1.png[0]' -auto-orient -resize "100x" -crop "100x100+ 0+0" +repage '/var/folders/dp/d61_ggqs0zvg9dcnybvfjgb40000gn/T/Bildschirmfoto 2013-01-27 um 16.39.0020130127-3196-8zjox120130127-3196-16s5ce0'
命令 :: file -b --mime '/var/folders/dp/d61_ggqs0zvg9dcnybvfjgb40000gn/T/Bildschirmfoto 2013-01-27 um 16.39.0020130127-3196-8zjox120130127-3196-16s5ce0'
命令 :: identify -format '%wx%h,%[exif:orientation]' '/var/folders/dp/d61_ggqs0zvg9dcnybvfjgb40000gn/T/Bildschirmfoto 2013-01-27 um 16.39.0020130127-3196-8zjox1.png[0] '
命令 :: identify -format %m '/var/folders/dp/d61_ggqs0zvg9dcnybvfjgb40000gn/T/Bildschirmfoto 2013-01-27 um 16.39.0020130127-3196-8zjox1.png[0]'
命令 :: identify -format %m '/var/folders/dp/d61_ggqs0zvg9dcnybvfjgb40000gn/T/Bildschirmfoto 2013-01-27 um 16.39.0020130127-3196-8zjox1.png[0]'
命令 :: convert '/var/folders/dp/d61_ggqs0zvg9dcnybvfjgb40000gn/T/Bildschirmfoto 2013-01-27 um 16.39.0020130127-3196-8zjox1.png[0]' -auto-orient -resize "50x" -crop "50x38+ 0+6" +repage '/var/folders/dp/d61_ggqs0zvg9dcnybvfjgb40000gn/T/Bildschirmfoto 2013-01-27 um 16.39.0020130127-3196-8zjox120130127-3196-1n2s0ck'
命令 :: file -b --mime '/var/folders/dp/d61_ggqs0zvg9dcnybvfjgb40000gn/T/Bildschirmfoto 2013-01-27 um 16.39.0020130127-3196-8zjox120130127-3196-1n2s0ck'

```

这是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T23:09:16.990

如果没有更多信息，不可能给出明确的答案，但是：

1.  当您在本地测试上传操作时，传输文件所花费的时间约为 0。当您在实际服务器上尝试时，会花费一些时间来传输数据（多少时间取决于您的 Internet 连接速度）。Chrome 中的开发人员工具可以向您显示这需要多少时间。

2.  我不知道您使用哪个提供商进行托管，但过去我发现 S3（一个）与我的开发机器相比性能非常缓慢。（不过，10 倍的差异相当极端。）

3.  您是否尝试过使用 ImageMagick 从命令行运行一些图像大小调整命令？（顺便说一句，我相信 Paperclip 使用 shell 命令调用 ImageMagick，而不是通过 RMagick。）试试看它是否看起来异常缓慢。

4.  分析操作并确保问题不是由应用程序中的其他代码引起的。

5.  如果问题似乎确实来自 ImageMagick，请检查您在本地和 VPS 上安装的版本。

# erlang - 从 erlang shell 使用 lhttpc 时出错

> ID：14553112
> 
> 赞同：0
> 
> 时间：2013-01-27T22:33:50.507
> 
> 标签：erlang

当我在 erlang shell 中运行以下命令时

```
lhttpc:request("http://www.google.co.uk", get, [], infinity). 
```

我收到这个错误

```
** exception exit: {noproc,{gen_server,call,
                                   [lhttpc_manager,
                                    {socket,<0.44.0>,"www.google.co.uk",80,false},
                                    infinity]}} 
```

我是 erlang 的新手，我从上面了解到的唯一一件事是某些`gen_server`模块已退出并出现一些错误。如何修复此错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T22:46:08.333

我在freenode的erlang频道上找到了答案。我需要在发出任何请求之前运行以下命令

```
ssl:start().
lhttpc:start(). 
```

# java - Java：HashMap.get 返回 null

> ID：14553115
> 
> 赞同：1
> 
> 时间：2013-01-27T22:34:12.593
> 
> 标签：java, comparison, hashmap, bytearray, serversocket

我正在用 Java 为 AS3 中的 MMORPG 编写套接字服务器。我对 HashMap.get(byte[]) 的奇怪行为有一些问题。哪些事情可能导致以下问题？

我不使用任何序列化系统，我发送字节并且客户端和服务器都知道如何处理接收到的字节的哪些字节。客户端发出的第一个请求是要求服务器创建一个播放会话。服务器将生成一个带有 8 个条目的随机会话令牌作为 byte[]，并将令牌添加到 HashMap。响应将是 9 个字节长。第一个定义响应类型（在这种情况下，字节“+”表示“您已被接受。这是您的令牌。”），字节 2-9 是令牌。客户端必须存储令牌并将其附加到任何进一步的请求中（这个概念可以与 PHP 会话进行比较）。

这是将客户端添加到 HashMap 的代码：

```
byte[] token = Util.generateToken();

// f is ResultSet entry of JDCB SQL query return value
Client client = new Client(f.getInt("id"), token);
Core.clients.put(token, client);

// I display client.token instead of token to make sure client != null      
Log.log("User " + f.getString("name") + " has logged in with session token " + Util.getHexString(client.token) + "."); 
```

日志：

> [01:50:30] 用户已使用会话令牌 92:B7:F8:C6:4B:53:17:3A 登录。

这些是将在任何进一步请求时显示的一些调试行：

```
// Show (byte[]) Token as Hex String, 8 bytes long
Log.soc("Token: " + Util.getHexString(buffer.getBytes(1, 9)));

// Show all keys in (HashMap<byte[], client>) Core.clients
int it = 0;
for (byte[] b : Core.clients.keySet())
Log.soc("Key Core.clients #" + StringUtils.leftPad(String.valueOf(++it), 2, '0') + " = " + Util.getHexString((b)));

// Display availability bool to make sure
Log.soc(Core.clients.containsKey(buffer.getBytes(1, 9)));

// Get Core.clients value where key = Token
Log.soc("Client: " + Core.clients.get(buffer.getBytes(1, 9))); 
```

日志：

> [01:51:09] 令牌：92:B7:F8:C6:4B:53:17:3A
> 
> [01:51:09] 关键 Core.clients #01 = 92:B7:F8:C6:4B:53:17:3A
> 
> [01:51:09] 错误
> 
> [01:51:09] 客户：空

那么，我怎样才能知道出了什么问题呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-27T22:38:46.377

HashMap 使用`hashCode()`and`equals()`从给定的键中查找条目。并且一个字节数组将永远等于它自己。它不会等于另一个字节数组，即使这个另一个字节数组具有相同的长度和相同的字节。您应该将数组包装在一个覆盖`equals()`并`hashCode()`使其工作的 Key 类中。

# regex - 如果表达式超过 4 个字符，正则表达式会从表达式中删除最后一个字符

> ID：14553116
> 
> 赞同：0
> 
> 时间：2013-01-27T22:34:16.073
> 
> 标签：regex, character, cut

我正在寻找一种方法来从表达式中删除最后一个字符，如果它使用正则表达式超过 4 个字符

例如

187
6
31673
9667
11857
07

处理后应如下所示：

187
6
3167
9667
1185
07

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T22:39:29.397

你为什么要使用正则表达式而不是这样的东西？

```
var output = (input.Length <= 4) ? input : input.SubString(0, input.Length - 1); 
```

如果您必须使用正则表达式，这个应该可以完成这项工作。

```
^(.{0,4})$|^(.+)(?:.)$ 
```

# expressionengine - 查找字段值大于或小于的通道条目

> ID：14553117
> 
> 赞同：1
> 
> 时间：2013-01-27T22:34:17.560
> 
> 标签：expressionengine

我认为有一种简单的方法可以通过字段提取条目值。我正在建立一个网站，该网站对价格（财产）进行基本搜索，并希望执行以下操作：

```
{exp:channel:entries channel="property" search="price < 200000"}
  <blah />
{exp:channel:entries} 
```

但是，似乎我只能搜索等于或不等于字段值的值。这是对的还是我这个周末特别厚？我对EE比较陌生，所以如果这是一个愚蠢的问题，请道歉......

假设我不厚，有没有插件可以做到这一点？

# css - 悬停 this + after 和 this (n+1) and before

> ID：14553122
> 
> 赞同：6
> 
> 时间：2013-01-27T22:34:41.687
> 
> 标签：css

[jsfiddle.net/rqJAY/](http://jsfiddle.net/rqJAY/)

HTML：

```
<table class="table_database_edit">
<tr><td>Magazyn wycieraczek</td><td>Edytuj</td><td>Usuń</td></tr>
<tr class="more" id=""><td colspan="3">aa</td></tr>
<tr><td>test</td><td>Edytuj</td><td>Usuń</td></tr>
<tr class="more" id=""><td colspan="3">aa</td></tr>
</table> 
```

CSS：

```
tr.more{
    #display: none;
}
table.table_database_edit{
    width: 100%;
    border-collapse:collapse;
    border-spacing: 0;
}
table.table_database_edit  tr:nth-child(4n+3), table.table_database_edit  tr:nth-child(4n+4){
    background-color: #EFF0F1;
}
table.table_database_edit  tr:hover:nth-child(n) + tr:nth-child(n):after{
    background-color: #FFFFCC;
}
table.table_database_edit  tr:hover:nth-child(n+1) + tr:nth-child(n+1):before{
    background-color: #FFFFCC;
} 
```

我有桌子。每两行是一个组。组交替背景颜色。第 1 行和第 2 行是白色的。第 3 行和第 4 行是灰色的。第 5 行和第 6 行是白色的。等等。

当您将鼠标悬停在组上时，我想将背景颜色设置为黄色。我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-28T00:40:14.980

您正在寻找的是`tbody`. 该`tbody`元素类似于`colgroup`，但用于对行进行分组。从那里开始，CSS 很简单：

```
<table class="table_database_edit">
    <tbody>
        <tr><td>Magazyn wycieraczek</td><td>Edytuj</td><td>Usuń</td></tr>
        <tr class="more" id=""><td colspan="3">aa</td></tr>
    </tbody>

    <tbody>
        <tr><td>test</td><td>Edytuj</td><td>Usuń</td></tr>
        <tr class="more" id=""><td colspan="3">aa</td></tr>
    </tbody>
</table> 
```

CSS：

```
tr.more{
    #display: none;
}
table.table_database_edit{
    width: 100%;
    border-collapse:collapse;
    border-spacing: 0;
}
table.table_database_edit  tbody:nth-child(odd) tr {
    background-color: #EFF0F1;
}

table.table_database_edit  tbody:hover tr {
    background-color: #FFFFCC;
} 
```

[http://jsfiddle.net/rqJAY/13/](http://jsfiddle.net/rqJAY/13/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T22:54:52.987

您将不得不修改您的 HTML 或使用 javascript。我考虑了一下，我认为答案是“不”，原因有一个。

CSS 中没有“上一个兄弟”选择器。您在示例代码中使用`before`and `after`，但这些伪选择器用于插入内容，而不是用于修改兄弟姐妹的 CSS 属性。

最接近的是相邻的兄弟组合器，但它只选择下一个兄弟。没有可用的[先前兄弟选择器](https://stackoverflow.com/questions/1817792/css-previous-sibling-selector)。因此，您可以在超过第一行时突出显示两行，但在超过第二行时不能突出显示第一行。

[http://jsfiddle.net/rqJAY/2/](http://jsfiddle.net/rqJAY/2/)

我考虑过使用类，但缺少以前的同级组合器再次造成灾难。除非你做了一些事情，比如为每个分组分配一个唯一的类。这将导致大量多余的 html 和 css。

您将需要修改 HTML 或使用 javascript。如果您可以修改 HTML，我会放弃表格并改用 div。如果您可以使用javascript，则实现起来相对简单。

- 编辑

我没有意识到你可以在一个表中声明多个 tbody。如果您可以修改 html，这绝对是可行的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T22:54:44.967

不确定这是否正是您正在寻找的，但这里有一个使用 jQuery 和 CSS 的解决方案。这将是一个更好的跨浏览器解决方案，因为 CSS :nth-child 尚未得到所有主要浏览器的支持。

jQuery：

```
//Add group classes to rows
$('table.table_database_edit tr').each(function () {
    if ($('.table_database_edit tr').index($(this)) + 1 !== 1 && ($('.table_database_edit tr').index($(this)) + 1) % 4 === 0) {
        $(this).removeClass('groupOne').addClass('groupTwo');
        $(this).prev().removeClass('groupOne').addClass('groupTwo');
    } else {
        $(this).addClass('groupOne');
        $(this).next().addClass('groupOne');
    }
});

//Highlight groups of two
$('table.table_database_edit tr').hover(function () {
    if ($('.table_database_edit tr').index($(this)) === 0 || $('.table_database_edit tr').index($(this)) % 2 === 0) {
        $(this).addClass('highlight');
        $(this).next().addClass('highlight');
    } else {
        $(this).addClass('highlight');
        $(this).prev().addClass('highlight');
    }
}, function () {
    $('.table_database_edit tr').removeClass('highlight');
}); 
```

CSS：

```
table.table_database_edit {
    width: 100%;
    border-collapse:collapse;
    border-spacing: 0;
}
table.table_database_edit tr.groupOne {
    background-color: #fff;
}
table.table_database_edit tr.groupTwo {
    background-color: #EFF0F1;
}
table.table_database_edit tr.highlight {
    background-color: yellow;
} 
```

如果您需要我调整它，请告诉我！

完整解决方案：[更新 JSFiddle - 无限分组](http://jsfiddle.net/rqJAY/9/)

# jquery - jQuery tablesorter 显示列中的所有元素

> ID：14553126
> 
> 赞同：1
> 
> 时间：2013-01-27T22:35:12.787
> 
> 标签：jquery, css, tablesorter

Tablesorter 工作正常，但所有元素都显示在另一列下的一列中，而不是正常的连续显示方式。只有 IE 才能正确显示它们:)

这是链接：http: [//jsfiddle.net/cmMvF/2/](http://jsfiddle.net/cmMvF/2/)

当我删除 tablesorter 脚本时，表格显示正确。除了 tablesorter 演示蓝色主题之外，我没有其他关于表格的课程。我的表头部分很简单：

```
<table id='catalog_model_line' width='100%' class='tablesorter'>
    <thead>
      <tr>
        <th class="header headerSortDown">Модельный ряд</th>
        <th class="header">Кузов</th>
        <th class="header">Дата выпуска</th>
     </tr>
    </thead>
.................. 
```

在这种情况下该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T02:36:40.497

问题是 tablesorter 将类添加`header`到`TH`. `.header`这与将宽度设置为 100%的主页 css 规则相冲突。可以在浏览器控制台中快速看到这一点。添加规则`.tablesorter .header`应该修复它

# c# - 结构映射到 Ninject

> ID：14553127
> 
> 赞同：0
> 
> 时间：2013-01-27T22:35:21.083
> 
> 标签：c#, ninject, structuremap

我需要将 StructureMap 代码转换为 Ninject（以支持我的托管服务提供商，因为它们仅支持在中等信任下运行的应用程序）。我在 StructureMap 中的基本寄存器是：

```
ObjectFactory.Initialize(x =>
{
    x.For<IDbConnection>()
     .HttpContextScoped()
     .Use(() =>
     {
        var constr = ConfigurationManager
            .ConnectionStrings["conn"].ConnectionString;                
        var conn = new SqlConnection(constr);        
        conn.Open();        
        return conn;
     });

    x.FillAllPropertiesOfType<IDbConnection>();
    x.For<ICurrent>().Use<Current>();
    x.For<ILogger>().Use<Logger>();
    x.For<IMembershipService>().Use<SpaceMembership>();
    x.For<IFormsAuthenticationService>()
        .Use<FormsAuthenticationService>();
    x.Scan(sc =>
    {
        sc.Assembly("Space360.DB");
        sc.AddAllTypesOf(typeof(IRepository<>));
        sc.WithDefaultConventions();
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T11:28:58.400

它看起来类似于：

```
// IDbConnection binding
Bind<IDbConnection>().ToMethod(x => {
                          var constr = ConfigurationManager.ConnectionStrings["conn"].ConnectionString;
                          var conn = new SqlConnection(constr);
                          conn.Open();
                          return conn;})
                     .InRequestScope();

// ommited fill all properties of type

Bind<ICurrent>().To<Current>(); // .InRequestScope() - just suggestion
Bind<ILogger>().To<Logger>();
Bind<IMembershipService>().To<SpaceMembership>();
Bind<IFormsAuthenticationService>().To<FormsAuthenticationService>();

// for this: Ninject.Extensions.Conventions has to be referenced
Bind(x=> x.From("Space360.DB")
          .SelectAllClasses().InheritedFrom<IRepository>()
          .BindDefaultInterface()
       // .Configure(b => b.InRequestScope())
     ); 
```

恐怕目前还没有类似于`FillAllPropertiesOfType`Ninject 的内置方法。您必须使用属性标记所有依赖`[Inject]`属性（但它会将您的类绑定到`Ninject.Core`），或者您可以尝试本文中描述的方法：

[Ninject 3.0 没有 [Inject] 属性的属性注入](http://jarrettmeyer.com/blog/2012/05/18/ninject-30-property-injection-without-inject-attribute)

基本上，它创建了 Ninject 组件，实现了`IInjectionHeuristic`，它连接到 ninject 内核，因此它知道如何解释启发式。在方法中注入的规则`ShouldInject`是：

1.  该属性是 Ninject 生成的类的公共可写属性
2.  它位于我们个人关心的组件中
3.  IT可以解决

* * *

对于我示例的最后一行，您将需要使用[ninject.extensions.conventions](https://github.com/ninject/ninject.extensions.conventions)

*注意，还有[ninject.extensions.logging](https://github.com/ninject/ninject.extensions.logging)用于隐式注入记录器（目前支持 Log4Net 和 NLog）。*

# java - 设计实现过滤链

> ID：14553130
> 
> 赞同：4
> 
> 时间：2013-01-27T22:35:56.227
> 
> 标签：java, spring, oop, design-patterns

我必须设计像过滤器这样的实体，由`Filter`接口表示，声明`apply(Content content)`方法，可以应用于内容对象。过滤器可以在链中组合在一起，类似于工作流，但它们是动态的。例如，如果FilterA返回X，那么我将应用filterB，而接收结果Y将导致应用FilterC。过滤器链是特定于应用程序的，我还没有决定如何允许构建过滤器链。

我会以与某些工作流框架相同的方式设计此行为：一个管理器组件遍历过滤器列表，并调用`filter.apply(content)`每个过滤器。但是如何允许像 if/else 语句这样的动态？

现在我构思了一个 Workflow 或 FilterChain 接口，声明一个`getNextFilter(previousResult)`. 实现这个接口可以声明一个特定于应用程序的工作流。但是 Workflow 接口的实现会很无聊：跟踪当前步骤（整数？），然后在每次`getNextFilter()`调用时，通过 switch/case 语句确定下一个过滤器？！？

哪种解决方案可能更好？如何声明一个链？

我正在使用Java和Spring，所以可以使用IoC。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T14:25:38.267

对于这种情况，我会尝试对链进行建模，并通过给节点更多的“智能”来将执行的责任转移到链本身。在某种程度上，我会将节点视为命令，因为它们可以自己执行，并且通过具有通用接口，能够创建[组合](http://www.oodesign.com/composite-pattern.html)。（顺便说一句，我不是 Java 程序员，所以请原谅我可能的语法错误）。所以，我的主要设计决策是：

1.  链知道如何执行自己。
2.  链节点可以是复合的。

我将首先定义如下内容：

```
public abstract class ChainNode {
   public abstract Content apply(Content content);
}

/** 
   The NullObject of the chain 
   http://www.oodesign.com/null-object-pattern.html
*/
public class FinalNode extends ChainNode {
    public Content apply(Content content) {
        return content;
    }
}

/** A sample filter */
public class FilterA extends ChainNode {
    private ChainNode nextNode;

    FilterA(ChainNode nextNode) {
        this.nextNode = nextNode;
    } 

    public Content apply(Content content) {
        filteredValue = //Apply the filter
        return nextNode.apply(filteredValue);
    }
}

/** An if-then-else filter */
public abstract class ConditionalFilter extends ChainNode {
    private ChainNode trueFilter;
    private ChainNode falseFilter;

    ConditionalFilter(ChainNode trueFilter, ChainNode falseFilter) {
        this.trueFilter = trueFilter;
        this.falseFilter = falseFilter;
    } 

    public Content apply(Content content) {
       if (this.evalCondition(content)) {
           return this.trueFilter.apply(content);
       } 
       else {
           return this.falseFilter.apply(content);
       }
    }

    private abstract boolean evalCondition(Content content);
} 
```

使用这种方法，您正在做的是将控制结构转换为对象并要求它们执行，这甚至允许您创建与标准 if-then 或 switch 语句不同的逻辑。有了这个基础，您可以创建一个具有不同分支运算符的链，触发不同的过滤路径。

需要注意的一些事项是：

1.  我假设一个过滤器返回 type 的东西`Content`，这实际上允许您将一个过滤器链接到另一个过滤器。我想这在你的要求中是正确的，但我不确定。
2.  对于每个新过滤器，您只需创建一个新类并定义`apply`方法。
3.  空对象始终是链的最后一个节点，停止链调用。
4.  要定义新的“分支节点”，您必须从子类化`ConditionalFilter`并重新定义该`evalCondition`方法。我不知道 Java 是否有闭包（我认为没有），但如果有，您可以添加一个`condition`实例变量并用闭包对其进行参数化，从而避免为每个新条件进行子类化。或者，在 Java 世界中可能有更可接受的解决方法，我只是不知道 :(。
5.  我假设条件分支是根据`content`参数决定的。如果您需要更多信息来做出决定，您还可以在`apply`方法中传递一个上下文对象。根据您的需要，这可以是结构化对象，如果您需要更大的灵活性，也可以只是字典。

最后，关于链条的构建，如果链条很长且构建复杂，我认为这里的[构建器](http://www.oodesign.com/builder-pattern.html)应该适合您的需求。

高温高压

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-28T23:05:44.493

为了一般性，我假设条件不仅应该在单个过滤器之间决定，而且应该在过滤器链之间决定。

经过一番思考，在我看来[复合模式](http://en.wikipedia.org/wiki/Composite_pattern)非常适合这里。

*   `Component`: 你的`Filter`界面
*   `Leafs`: 混凝土过滤器
*   `Composite`：您的“工作流或 FilterChain 接口”

`ConditionalFilter`可以是 a或`Leaf`a `Composite`。在这两种情况下，都使用比较和两个`Filter`对象进行初始化，它可以在单个过滤器或过滤器工作流上分支。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-10-22T12:44:03.573

这是在 php 中实现过滤器链的复合模式的示例。

```
$filter = new BookFilter\Chain();
$filter->appendFilter(new BookFilter\Isbn('978-5-8459-1597-9'))
       ->appendFilter(new BookFilter\Title('Domain Driven', BookFilter\Title::CONTAINS))
       ->appendFilter(new BookFilter\Publisher('Вильямс', BookFilter\Publisher::EQUALS))
       ->appendFilter(new BookFilter\Price(100, 10.000))
       ->appendFilter(new BookFilter\Ebook(true));
$bookCollection = $bookSeachService->findAllByFilter($filter); 
```

取自这里：[http ://crazycode.net/blog/6-architecture/10-structural-patterns](http://crazycode.net/blog/6-architecture/10-structural-patterns)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-27T22:46:59.563

由于您只想按顺序执行过滤器链，因此将过滤器链实现为`List<Filter>`. 您可以对它们进行循环并执行。类似的东西（注意这显然是我没有尝试过的快速实现）：

```
public class FilterChainImpl implements FilterChain {
  private List<Filter> filterChain = new ArrayList<Filter>();

  public addFilter(final Filter f) {
    filterChain.add(f);
  }

  public apply(final Content content) {
    Content prevContent = content;
    for(Filter f : filterChain) {
      prevContent = f.apply(prevContent);
    }
  }
} 
```

然后您可以使用它来创建您喜欢的任何过滤器链。如果您将拥有许多不同的过滤器链，您可能会使用一些工厂技术来创建过滤器链。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-27T23:21:26.767

您在这里需要的是模式[责任链](http://en.wikipedia.org/wiki/Chain-of-responsibility_pattern)。

在 Java 中实现了很多次之后，我的建议是：

*   您可能在某处不需要完整的链条：每个项目都会有一个链接到其后继项目
*   如果您确实需要链中成员的完整列表，您可以使用 LinkedList。
*   记住你可以有多个链
*   关键设计问题是是否有任何部分处理，通常没有：链的每个成员都看，如果它可以处理它，则它会调用它的后继者

参与机制应该是一个接口，这样你就可以有专门的代理来做非常不同的事情，并同意只接收消息并根据接口指示传递它们。

如果您想逐步过滤，您可以传递内容，正如您在问题中显示的那样，每个参与者都可以对其进行变异。[我在 GitHub 上有一个名为scraper](http://github.com/ontometrics/scraper.git)的开源项目，它使用责任链来实现代理链，这些代理链提取被抓取的页面中包含内容的部分。

# android - 如何将 dir .apt_generated 放入 gitignore

> ID：14553139
> 
> 赞同：0
> 
> 时间：2013-01-27T22:37:07.100
> 
> 标签：android, git, gitignore

我把 .gitignore 文件

```
.apt_generated 
```

但每次在 Eclipse 中重新编译项目 eGit 并`git status -s`显示 .apt_generated 中的文件都已更改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T23:28:34.897

如果您`.gitignore`在提交一次后将其添加到索引中，则需要通过键入将其从索引中删除

```
git rm --cached .apt_generated 
```

# java - 检查java中两个链表之间的子集

> ID：14553140
> 
> 赞同：0
> 
> 时间：2013-01-27T22:37:09.407
> 
> 标签：java, linked-list

我正在尝试编写一个布尔方法 isSubset （如果集合 A 中的每个元素都在集合 B 中，则返回布尔值，否则返回 false），其中方法调用可以这样编写`setA.subsetOf(setB)`。我的想法是提取setA的每个元素并将其与setB进行比较。如果 setA 的第一个元素与 setB 中的任何元素匹配，则继续检查 setA 中的下一个元素。如果 setA 中的所有元素都与 setB 中的任何元素匹配，则方法返回 true，否则（并非 setA 中的所有元素都在 setB 中）返回 false。我已经编写了检查元素是否包含到链表的方法，如下所示：

```
 public boolean contain (Object target) {
      boolean status = false;
      Node cursor;
      for (cursor = head; cursor.getNext() != null; cursor = cursor.getNext()) {
          if (target.equals(cursor.getElement())) 
              status = true;
      }   
      return status;
  } 
```

由于我仍然对链表操作的语法感到困惑，我的问题是如何提取每个元素并完成剩下的工作。任何帮助，将不胜感激。节点被声明

```
 public Node(Object o, Node n) {
    element = o;
    next = n;
  } 
```

链表

```
 public SLinkedList() {
    head = new Node(null, null); // create a dummy head
    size = 0;
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T23:28:55.560

您检查集合 A 是否是集合 B 的子集的逻辑是正确的。您问“如何提取每个元素”，但您的代码`contain`表明您已经知道如何遍历链表。因此，只需以相同的方式遍历集合 A，并调用`setB.contain(cursor)`您遍历的每个元素。如果对任何元素返回 false，则立即返回 false。

这样做的问题是如果列表很大，它会**很**慢。我猜您是编程新手，可能从未听说过“大 O”表示法。这是一种描述算法性能如何随着输入数据大小的变化而变化的方式。您的`subsetOf`方法将是 O(n^2)。如果`setB`存储在散列集而不是链表中，它将是 O(n)，这*要*好得多。

您可以在以下网址了解有关此主题的更多信息：[http](http://en.wikipedia.org/wiki/Time_complexity) ://en.wikipedia.org/wiki/Time_complexity 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T00:17:22.653

首先，您的包含方法中有一个小错误。for 条件`cursor.getNext() != null;`应该是`cursor != null;`. 这样做可以防止搜索空集（这会导致您的代码崩溃）以及允许搜索列表中的最后一个节点。如果你这样做`return status;`，你的代码会运行得更快`status=true;`

isSubset 的结构与您创建的循环非常相似；循环看起来像这样：

```
for(cursor = head; cursor!=null; cursor.getNext()){
  if(setB.contain(cursor.getElement()) == false){
    return false;
  }
} 
```

# node.js - 加速 websocket 的最佳方法

> ID：14553142
> 
> 赞同：2
> 
> 时间：2013-01-27T22:37:22.547
> 
> 标签：node.js, web-applications, websocket, ping, sockjs

我使用基于 sockjs 的 websockets 编写 node.js 应用程序，我需要在客户端上进行最少的更新时间。

应用程序中的事件每 Nms（例如 20ms）发生一次，我需要尽快对用户进行广播更改。

每次更新为 100-200 字节。Ping 到服务器是 90-200 毫秒。

如果我每次发生事件时都发送消息 - 客户端应用程序存在一些滞后，并且.. 从设计上来说这是个坏主意。

如果我每 Nm （例如 200 毫秒）发送消息 - 客户端上的更新看起来更流畅，但有太多“丢帧”

混合这些方法并发送这是个好主意吗

也许我需要进行“不必要”的更新，如果“第二个”更新将早于“第一个”更新，它将覆盖，因为 ping ..如果客户端上有大量更新，如何“丢帧”。

向用户广播更新的最佳方式是什么？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T07:25:42.040

好的，补偿延迟滞后只有一种解决方案——预测两个数据包之间的事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T22:49:32.753

我只能推荐一件事，那就是看一下流星.js 的源代码，他们使用延迟补偿和 SockJS [。](http://meteor.com/)

# class - 剪辑错误：现有类的任何对象都不能满足 is-a 对象模式的限制

> ID：14553144
> 
> 赞同：1
> 
> 时间：2013-01-27T22:37:58.223
> 
> 标签：class, artificial-intelligence, rule-engine, expert-system, clips

我收到此错误：

*[OBJRTBLD2] 现有类的任何对象都不能满足 is-a 对象模式的限制。*

当我运行以下规则时：

```
(defrule update_input "Updateinput1" 
(object (is-a Shmeio) 
(timh ?eis1) 
(onoma "Eisodos 1"))
 => 
(printout t "htane: " ?eis1)) 
```

我的代码如下：

```
(defclass Shmeio
(is-a USER)
(role abstract)
(single-slot timh
(type INTEGER)
;+   (cardinality 1 1)
(create-accessor read-write))
(single-slot onoma
(type STRING)
;+   (cardinality 1 1)
(create-accessor read-write))
(multislot input_at
(type INSTANCE)
(allowed-classes Eksartima)
(create-accessor read-write)))
(defclass Shmeio_Eisodou
(is-a Shmeio)
(role concrete))

(definstances facts
; ...............
([Kuklomata_Class10] of Shmeio_Eisodou
(input_at [Kuklomata_Class74])
(onoma "Eisodos 1")
(timh 21))
([Kuklomata_Class36] of Shmeio_Eisodou
(input_at [Kuklomata_Class76])
(onoma "Eisodos 2")
(timh 28))
([Kuklomata_Class45] of Shmeio_Eisodou
(input_at [Kuklomata_Class77])
(onoma "Eisodos 3")
(timh 13))
([Kuklomata_Class54] of Shmeio_Eisodou
(input_at [Kuklomata_Class77])
(onoma "Eisodos 4")
(timh 25)) 
```

有人可以帮我吗？因为我现在被困了几个小时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-06T21:57:38.640

抽象类是非反应性的（您不能对它们进行模式匹配），并且此行为由子类继承，因此您必须在子类中显式启用此功能。

```
CLIPS> (defclass A (is-a USER) (role abstract))
CLIPS> (defclass A1 (is-a A) (role concrete))
CLIPS> (defclass A2 (is-a A) (role concrete))
CLIPS> (defrule A-match (object (is-a A)) =>)
[OBJRTBLD2] No objects of existing classes can satisfy is-a restriction in object pattern.

ERROR:
(defrule MAIN::A-match
   (object (is-a A)
CLIPS> (defclass B (is-a USER) (role abstract))
CLIPS> (defclass B1 (is-a B) (role concrete) (pattern-match reactive))
CLIPS> (defclass B2 (is-a B) (role concrete) (pattern-match reactive))
CLIPS> (defrule B-match (object (is-a B)) =>)
CLIPS> 
```

# c++ - XWarpPointer 不适用于 wmware 播放器中的 ubuntu 12.04

> ID：14553155
> 
> 赞同：0
> 
> 时间：2013-01-27T22:38:48.570
> 
> 标签：c++, qt, ubuntu, vmware, xlib

您好，我正在尝试在我的 Qt 应用程序中使用 Xlib 来移动鼠标指针：

```
cout <<"move mouse to "<<x<<","<<y<<endl;
XWarpPointer(defaultdisplay, None, desktoproot, 0, 0, 0, 0, x, y);
XFlush(defaultdisplay);
//QCursor::setPos(x,y); 
```

但这在 wmware 播放器内的 ubuntu 中不起作用（也许 vmware 工具使用 X11），有什么想法可以禁用 vmware 鼠标集成或使用任何其他代码？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T19:46:47.247

我终于找到了解决方案，我需要做的就是在我的 Ubuntu 虚拟机目录中编辑 .vmx 文件并添加以下行：

```
vmmouse.present = "FALSE" 
```

那就是禁用鼠标集成。

# php - 无法使用 PDO 和 PHP 删除带有 bindParam 的表

> ID：14553157
> 
> 赞同：2
> 
> 时间：2013-01-27T22:38:59.590
> 
> 标签：php, mysql, pdo

例如，这很好用：

```
$dropTable = $dbConnection->prepare('DROP TABLE IF EXISTS announcements');
$dropTable->execute();

$createTable = $dbConnection->prepare('CREATE TABLE announcements(
            id MEDIUMINT NOT NULL AUTO_INCREMENT,
            announcements TEXT NOT NULL,
            PRIMARY KEY (id))');
$createTable->execute(); 
```

但这失败了：

```
$dropTable = $dbConnection->prepare('DROP TABLE IF EXISTS :tableToDrop');
$dropTable->bindParam(':tableToDrop', $_GET['table']);
$dropTable->execute();

$createTable = $dbConnection->prepare('CREATE TABLE announcements(
        id MEDIUMINT NOT NULL AUTO_INCREMENT,
            announcements TEXT NOT NULL,
            PRIMARY KEY (id))');
$createTable->execute(); 
```

有错误：

```
Fatal error: Uncaught exception 'PDOException' with message 'SQLSTATE[42000]:   
  Syntax error or access violation: 1064 You have an error in your SQL syntax;   
  check the manual that corresponds to your MySQL server version for the right  
  syntax to use near '?' at line 1' in xxxx/createTables.php:9  
Stack trace: #0 xxxxx/createTables.php(9):   
  PDO->prepare('DROP TABLE IF E...') #1 {main} thrown in xxxx/createTables.php on line 9 
```

我敢肯定这是微不足道的，但我已经做了好几个小时了。干杯。

编辑：原来你不能[用表名绑定参数](http://webdevrefinery.com/forums/topic/4602-dynamic-tablename-with-pdo-prepare/)。无论如何用动态表名做一个安全的准备语句？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T23:35:30.880

Safe way (and u should use that, event if what u wrote could work):

```
$t=array('t1'=>'t1','t2'=>'t2'....'tn'=>'tn');

$sql = "drop table {$t[$_GET['table']]} ..." 
```

# java - 在手机不移动时生成一个位置

> ID：14553164
> 
> 赞同：0
> 
> 时间：2013-01-27T22:39:40.933
> 
> 标签：java, android

我想知道**如何在手机不移动超过 10 米的情况下使用 gps 或网络提供商生成一个位置，**这意味着您在家中或在同一个地方。

我猜 minTime 参数并不重要（当然是说 requestLocationUpdates 方法）， minDistance 是应该产生差异的参数。我试图将值设置为 100m，但我在我没有移动的情况下不断获取位置（可能 1 米..在我睡觉时进行了测试）所以我不断提高值并在 500 米处停了下来！因为它变得无用了。

也许有一种方法可以检查两个位置之间的距离？或者接收有关手机移动的信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T23:02:50.520

请记住，GPS 精度约为 +/- 20 米。再加上由于环境条件导致的可用卫星信号可能出现的波动，这意味着报告的位置会发生一定程度的变化，即使对于固定设备也是如此。

唯一对您不起作用的原因`minDistance`是，如果它正在为您提供*报告位置*小于您请求的最小距离的位置。`LocationManager`只能与报告的职位一起工作；它没有其他方法可以确定设备是否真的在移动。

如果您检查您`LocationListener`在`minDistance`. 另一方面，如果问题是由于 GPS 子系统认为设备正在移动（因此位置相差超过`minDistance`），您正在获得修复，那是 GPS 和您的硬件的限制，您无能为力这样做。

# ios - FB 应用程序未在 IOS 中正确集成

> ID：14553165
> 
> 赞同：1
> 
> 时间：2013-01-27T22:39:46.870
> 
> 标签：ios, facebook

我正在关注本教程： [入门](https://developers.facebook.com/docs/getting-started/facebook-sdk-for-ios/3.1/)并且我已经正确运行了示例。

我现在想添加移动添加特性，我按照本教程进行操作： [FB 移动安装广告](http://developers.facebook.com/docs/tutorials/mobile-app-ads/)

在第 1 步中它说：

```
Set up your app to measure mobile app install ads 
```

一步一步，我评论我已经做了什么：

```
1.You need to integrate Facebook's latest SDK -->DONE with the tutorial getting started
2.For iOS 3.0 or greater, add the following to your UIApplicationDelegate applicationDidBecomeActive selector:
[FBSettings publishInstall:YOUR_APP_ID];-->DONE

I have added:
[FBSettings publishInstall:@"220............"]; in my appdelegate.m and imported the <FacebookSDK/FacebookSDK.h> 
```

然后问题来了：

```
3\. You can confirm that your app is correctly configured in the App Dashboard, or go directly there at https://developers.facebook.com/apps/YOUR_APP_ID. You should see a field in the "Summary" section labeled "Last Mobile Install Reported," with a time stamp for the last time your app reported an install. 
```

这是我想看到的： ![假设看到](../Images/7fb62dac0e25c6b92c6659b6b7e84022.png)

这就是我所看到的：

![在此处输入图像描述](../Images/050bd3842ff1ba59092d6c2344bde2b4.png)

我怎么知道我已经正确设置了这个并且我的 fb 移动安装广告会正常播放？

编辑：

我已经添加了两个 URLScheme：

![网址方案](../Images/16922e8c9abd3ddc8bc1a053686dcaa3.png)

和链接器标志：

![其他链接器标志](../Images/e83c0161de3e9fc44e9533c2cad2efe1.png)

以及本机 ios 信息：

![本机 ios 信息](../Images/235281e233aced0101ee9858e0715561.png)

问题仍然存在:(我没有看到我的应用程序正在从我的手机安装..

仅当我正确设置广告系列和广告时，这才有效？因为我~还没有创建广告，我只是想确保我会支付 FB 并且我的广告会将用户带到我的应用程序。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-29T02:44:40.953

好的，您还没有正确设置所有内容，所以我将快速引导您完成整个过程。

您需要做的第一件事是转到您的项目，然后选择您的应用程序的目标>>构建设置并搜索“其他链接器标志”。在那里您将添加“-lsqlite3.0”，如下图所示。![在此处输入图像描述](../Images/153744b9a026f7c9fd6b0ff75efbbacb.png)

接下来，您需要导航回 Summary 选项卡，向下滚动到“Linked Frameworks and Libraries”，然后添加 Social、Accounts 和 AdSupport 框架。此外，对于旧设备，将它们从必需更改为可选。还要添加 FacebookSDK 框架。你应该有这样的东西：![在此处输入图像描述](../Images/c7205ef6532176cc855046839043d38d.png)

最后，你需要做一些似乎给你最困难的事情。在项目导航器中导航到 .plist 文件。在那里，您需要修改您的 plist 以反映如下内容：![在此处输入图像描述](../Images/897e02e75bee7e448ad07242fb36abf4.png)

确保您对大写字母等非常精确。我这么说是因为我注意到您在问题中使用了“id”而不是“ID”。

您要做的最后一件事就是在您准备好使用 FacebookSDK 框架时将其导入您的文件。

```
#import <FacebookSDK/FacebookSDK.h> 
```

最后一个额外的提示。我总是添加一个名为“FacebookSDKResources.bundle”的包，因为我发现我经常最终使用它。该包可以在 FacebookSDK >> FacebookSDK.framework >> 资源中找到。以与添加 FacebookSDK.faramework 文件本身相同的方式将该包添加到您的项目中，您应该已经准备好开始了！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-28T22:30:15.180

看来，您没有在[此处](https://developers.facebook.com/apps)设置“URL 方案后缀” ：

例子，

```
fb12345678901234 
```

在您的应用程序包中：

例子，

```
FacebookAppID: 12345678901234 
```

在**URL Schemes** ( Target->Info->URL Types->URL Schemes )的 URL **Types**中：

 **例子，

```
fb12345678901234 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T18:34:32.720

您是否尝试在模拟器上启动应用程序？在将构建加载到真实设备之前，我遇到了同样的问题。**

# css - CSS文本边框？

> ID：14553166
> 
> 赞同：12
> 
> 时间：2013-01-27T22:39:53.300
> 
> 标签：css

> **可能重复：**
> [CSS 字体边框？](https://stackoverflow.com/questions/2570972/css-font-border)

是否可以使用 CSS 设置“*文本边框*”？

最好有多个边界？像图像上的东西

![在此处输入图像描述](../Images/34c97f4d198a3dc89d031c6cf8ce6bef.png)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-27T22:41:49.913

那么你可以试试字体阴影。但是，可能必须对图像进行具有多个边框的操作。

```
 text-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-27T22:44:58.393

我想你可能想看看`CSS text-shadow`

[http://www.quirksmode.org/css/textshadow.html](http://www.quirksmode.org/css/textshadow.html)

你无法实现多个边界，但你可以用它做一些令人惊奇的事情：

[http://line25.com/articles/using-css-text-shadow-to-create-cool-text-effects](http://line25.com/articles/using-css-text-shadow-to-create-cool-text-effects)

（我喜欢那种霓虹灯效果：）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-27T22:46:11.633

您可以像之前的答案一样模拟描边文本：-

[对文本的轮廓效果](https://stackoverflow.com/questions/4919076/outline-effect-to-text)

# mysql - 查询中的mysql用户定义变量

> ID：14553171
> 
> 赞同：3
> 
> 时间：2013-01-27T22:40:26.840
> 
> 标签：mysql

我正在尝试使用用户定义的变量来代替表名，这样我就可以只使用 mysql 而不需要任何其他语言。

这个例子很简单——真正的脚本使用了很多表名，最终用户能够更容易地更改变量而不是搜索/替换。

```
SET @tablename = 'mytable';
SELECT * FROM @tablename; 
```

这不起作用，但显示了我需要的最终结果。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T23:18:00.157

使用准备好的语句：

```
SET @tablename = 'mytable';

SET @query = CONCAT('SELECT * FROM ', @mytable);
PREPARE stmt FROM @query;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

如果您的实际查询要复杂得多，您可以将查询的构建包装在一些存储函数中：

```
DELIMITER //
CREATE FUNCTION GetQuery(tableName VARCHAR(50)) RETURNS VARCHAR(100)
BEGIN
    DECLARE finalQuery VARCHAR(100);
    SET finalQuery = CONCAT('SELECT * FROM ', tableName);
    -- do something fancier with finalQuery here
    RETURN finalQuery;
END //
DELIMITER ;

SET @query = GetQuery('mytable');
PREPARE stmt FROM @query;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

更好的是：在存储过程中做所有事情：

```
DELIMITER //
CREATE PROCEDURE QueryTable(tableName VARCHAR(50))
BEGIN
    SET @finalQuery = CONCAT('SELECT * FROM ', tableName);
    PREPARE stmt FROM @finalQuery;
    EXECUTE stmt;
    DEALLOCATE PREPARE stmt;
    SET @finalQuery = NULL;
END //
DELIMITER ;

CALL QueryTable('mytable'); 
```

# java - Java Android 低分辨率字体

> ID：14553176
> 
> 赞同：1
> 
> 时间：2013-01-27T22:40:57.013
> 
> 标签：java, android, fonts

我正在玩 Java for Android，我注意到字体质量非常低。有什么办法可以改善吗？

（试图附上一张图片， http: [//i.imgur.com/MipnaH1.png](http://i.imgur.com/MipnaH1.png)如果它不起作用，这里是链接）

左边的文本是图像，右边的文本是从画布中绘制的。他们都使用相同的字体：Leelawadee Bold ( [http://fontzone.net/font-details/Leelawadee+Bold/](http://fontzone.net/font-details/Leelawadee+Bold/) )

我正在使用“ *canvas.drawText()* ”方法绘制字体。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T22:51:32.307

在绘制文本时使用`Paint.setAntiAlias(true)`和`Paint.setSubPixelText(true)`在您正在使用的绘制对象上。

# python - 将 ☺ 编码为 IBM-437 失败，而其他有效字符（如 é）成功

> ID：14553178
> 
> 赞同：4
> 
> 时间：2013-01-27T22:41:22.220
> 
> 标签：python, encoding, python-3.x, codepages

☺：

```
>>> bytes('☺','ibm437')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python3.3/encodings/cp437.py", line 12, in encode
    return codecs.charmap_encode(input,errors,encoding_map)
UnicodeEncodeError: 'charmap' codec can't encode character '\u263a' in position 0: character maps to <undefined> 
```

与 é 相反，它有效：

```
>>> bytes('é','ibm437')
b'\x82' 
```

我希望☺能把我带回来`b'\x01'`。我怎样才能做到这一点？

[代码页 437 的图像。](http://en.wikipedia.org/wiki/File%3aCodepage-437.png)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-27T22:56:07.470

IBM-437 有点特殊，它不仅是一个代码页（即定义了字节值 128-255 应该发生的情况），而且还重新定义了一些 ASCII 控制字符，[但仅限于某些上下文](http://en.wikipedia.org/wiki/Code_page_437#Interpretation_of_code_points_1.E2.80.9331_and_127)。Python 将这些有问题的代码点映射到控制字符，而不是它们在某些上下文中显示的可见字符。

要进行转换，您可以使用以下辅助方法：

```
ibm437_visible = lambda byt: byt.decode('ibm437').translate({
    0x01: "\u263A", 0x02: "\u263B", 0x03: "\u2665", 0x04: "\u2666",
    0x05: "\u2663", 0x06: "\u2660", 0x07: "\u2022", 0x08: "\u25D8",
    0x09: "\u25CB", 0x0a: "\u25D9", 0x0b: "\u2642", 0x0c: "\u2640",
    0x0d: "\u266A", 0x0e: "\u266B", 0x0f: "\u263C", 0x10: "\u25BA",
    0x11: "\u25C4", 0x12: "\u2195", 0x13: "\u203C", 0x14: "\u00B6",
    0x15: "\u00A7", 0x16: "\u25AC", 0x17: "\u21A8", 0x18: "\u2191", 
    0x19: "\u2193", 0x1a: "\u2192", 0x1b: "\u2190", 0x1c: "\u221F",
    0x1d: "\u2194", 0x1e: "\u25B2", 0x1f: "\u25BC", 0x7f: "\u2302",
})
assert ibm437_visible(b'\x01') == '☺' 
```

# android - 如何在带有注释的 sql lite 数据库中保存地图标记？

> ID：14553181
> 
> 赞同：0
> 
> 时间：2013-01-27T22:41:40.650
> 
> 标签：android, google-maps-markers, android-maps-v2

到目前为止，我已经弄清楚如何通过点击在屏幕上获取标记，它显示经度和纬度数字，我希望能够将标记保存在 SQL lite 数据库中，并在标记上添加注释，所以当地图被加载并且标记与地图一起加载，当用户点击标记时，标记信息将显示在标记上方。到目前为止，这是我的地图类：

```
public class Map extends  FragmentActivity {

GoogleMap googleMap;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.map);
    setUpMapIfNeeded();

    SupportMapFragment supportMapFragment = (SupportMapFragment)
    getSupportFragmentManager().findFragmentById(R.id.map);

    // Getting a reference to the map
    googleMap = supportMapFragment.getMap();

    googleMap.setOnMapClickListener(new OnMapClickListener() {

        @Override
        public void onMapClick(LatLng latLng) {

            // Creating a marker
            MarkerOptions markerOptions = new MarkerOptions();

            // Setting the position for the marker
            markerOptions.position(latLng);

            // Setting the title for the marker.
            // This will be displayed on taping the marker
            markerOptions.title(latLng.latitude + " : " + latLng.longitude);

            // Clears the previously touched position
            googleMap.clear();

            // Animating to the touched position
            googleMap.animateCamera(CameraUpdateFactory.newLatLng(latLng));

            // Placing a marker on the touched position
            googleMap.addMarker(markerOptions);
        }
    });
}

  @Override
    protected void onResume() {
        super.onResume();
        setUpMapIfNeeded();
    }

  private void setUpMapIfNeeded() {
        // Do a null check to confirm that we have not already instantiated the map.
        if (googleMap == null) {
            // Try to obtain the map from the SupportMapFragment.
            googleMap = ((SupportMapFragment) getSupportFragmentManager().findFragmentById(R.id.map))
                    .getMap();
            // Check if we were successful in obtaining the map.
            if (googleMap != null) {
                setUpMap();
            }
        }
    }

  private void setUpMap() {

      googleMap.setMyLocationEnabled(true);
      googleMap.getMyLocation();
    }

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T23:00:48.237

您需要像这样在地图点击侦听器（或 LongClick 侦听器）上设置：

```
map.setOnMapClickListener(new OnMapClickListener() {

        @Override
        public void onMapClick(LatLng point) {

        }
    }); 
```

在该侦听器中，您将获得地图上单击位置的 LatLng 点。然后你将像这样创建标记：

```
map.addMarker(new MarkerOptions()
        .position(point)
        .title("title")
        .snippet("snippet")
        .icon(icon)); 
```

为了保存标记，只需使用 List 或 HashMap，因为 map 没有这样的方法来获取添加的标记（也许我错了）。

希望这可以帮助。

# php - preg_replace 单词

> ID：14553182
> 
> 赞同：0
> 
> 时间：2013-01-27T22:41:41.690
> 
> 标签：php, regex, arrays, string, preg-replace

**只是**试图用`<span class="brc">Words</span>`.

```
<td class="views-field views-field-summoner-name-1"> Zeit für ein dududuDUELL </td>
<td class="views-field views-field-summoner-name-1"> EloDrop </td>
<td class="views-field views-field-summoner-name-1"> HighPINGklärtGG </td>
<td class="views-field views-field-summoner-name-1"> BlaViShi </td>
<td class="views-field views-field-summoner-name-1"> Bruteforce tv </td> 
```

td 类**视图字段**不能用于它。我目前的代码是：

```
<?php

$url = "http://competitive.euw.leagueoflegends.com/de/ladders/euw/current/ranked_team_3x3";

preg_match('#<table class="views-table cols-6"[^>]+>[\w\W]*?</table>#i', file_get_contents($url), $match);
echo $match[0];

$brc = array("Zeit für ein dududuDUELL","OP Scheisse","Selbstzerstörungsknopf","EloDrop","HighPINGklärtGG","BlaViShi");
echo preg_replace(I dont know how this works);
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T22:49:08.527

如果`$brc`是要包装的字符串数组，则`span`可以循环遍历它们并使用[`str_replace`](http://ca.php.net/manual/en/function.str-replace.php)：

```
foreach($brc as $str) {
    $match[0] = str_replace($str, '<span class="brc">'.$str.'</span>', $match[0]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T02:27:13.690

You can use [preg_replace_callback](http://php.net/preg_replace_callback);

```
$s = '<table class="views-table cols-6">
        <td class="views-field views-field-summoner-name-1"> Zeit für ein dududuDUELL </td>
        <td class="views-field views-field-summoner-name-1"> EloDrop </td>
        <td class="views-field views-field-summoner-name-1"> HighPINGklärtGG </td>
        <td class="views-field views-field-summoner-name-1"> BlaViShi </td>
        <td class="views-field views-field-summoner-name-1"> Bruteforce tv </td>
      </table>';
$s = preg_replace_callback('~<td(.*?)>(.*?)</td>~isu', function($m) {
    return sprintf('<td%s><span class="brc">%s</span></td>', $m[1], $m[2]);
}, $s);
print $s; 
```

Output;

```
<table class="views-table cols-6">
    <td class="views-field views-field-summoner-name-1"><span class="brc"> Zeit für ein dududuDUELL </span></td>
    <td class="views-field views-field-summoner-name-1"><span class="brc"> EloDrop </span></td>
    <td class="views-field views-field-summoner-name-1"><span class="brc"> HighPINGklärtGG </span></td>
    <td class="views-field views-field-summoner-name-1"><span class="brc"> BlaViShi </span></td>
    <td class="views-field views-field-summoner-name-1"><span class="brc"> Bruteforce tv </span></td>
</table> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T22:49:31.787

```
array_walk($brc, function (&$elem) { $elem = "/" . preg_quote($elem) . "/"; });
echo preg_replace($brc, '<span class="brc">\0</span>', $match[0]); 
```

这`array_walk`只是在单词周围添加正则表达式分隔符并正确转义它们，但您也可以手动执行此操作。

# c# - 当参数为空时，nHibernate QueryOver 获取所有记录

> ID：14553183
> 
> 赞同：3
> 
> 时间：2013-01-27T22:41:44.077
> 
> 标签：c#, nhibernate, null

我有以下情况。我有`Customer`和`CompanyCustomerAssignment`对象（具有 1:1 的关系）。中的属性之一`CompanyCustomerAssignment`是`CustomerGroup`。现在 - 我想`QueryOver`- 何时`CustomerGroup`通过，而不是 fetch`Customers`属于该组，但是当它为 null 时，我想查询所有。好吧，在“SQL”中看起来很简单：

```
...WHERE CustomerGroupId = @param OR @param is NULL; 
```

不幸的是，我不知道 QueryOver （`custGrp`是参数 - 可以是对象或`null`）

```
Customer c = null;
CompanyCustomerAssignment cca = null;

_session.QueryOver<Customer>(() => c)
    .JoinAlias(() => c.CompanyCustomerAssignment, () => cca)
    .Where(() => cca.Company == currentCompany && c.IsActive == true)
    .And(() => cca.CustomerGroup == custGrp || custGrp == null ) // <- this seems to be problem to me
    .List()
    .Select(x => new CustomerApiModel() {CustomerId = x.Id})
    .ToList(); 
```

但这不起作用 - 我收到一条消息，它`Customer`没有这样的属性，这听起来合乎逻辑，但对我毫无帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T05:54:05.543

在这种情况下，我们在执行查询之前就知道条件`@param is NULL`，或者在组装之前更好。`custGrp`因此，让我们仅在 Criteria 被填充时扩展 Criteria 。

```
var criteria = _session.QueryOver<Customer>(() => c)
    .JoinAlias(() => c.CompanyCustomerAssignment, () => cca)
    .Where(() => cca.Company == currentCompany && c.IsActive == true);

// if during the query build
if(custGrp != null)
{
  criteria.Where(() => cca.CustomerGroup == custGrp);
}

var results = criteria
    .List()
    ... 
```

这使得 SQL 部分更高效，我们可以做更多的技巧......

# git - 一个文件的 git checkout 的行为是什么？

> ID：14553184
> 
> 赞同：0
> 
> 时间：2013-01-27T22:41:44.937
> 
> 标签：git, version-control, versioning, git-revert

如果 x 和 y 是你的文件，并且你做了一些这样的提交：

```
commit 0: x / y
commit 1: x / y+1
commit 2: x+1/y+1
commit 3: x+1 / y+2 (HEAD) 
```

如果你这样做了：

```
git checkout master~1 x 
```

你会得到`x`或`x+1`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T22:44:01.177

是什么阻止你尝试这个来找出答案？反正`master~1`就是指之前的commit `master`。假设`master`分支位于提交 3，您将`x`在提交 2 处获得文件，即`x+1`.

# sql-server - 两个外键引用一个表 - ON UPDATE SET NULL 不起作用

> ID：14553188
> 
> 赞同：9
> 
> 时间：2013-01-27T22:42:09.847
> 
> 标签：sql-server, tsql, foreign-keys, constraints, cascade

我在一个表中有两个外键。让我们假设 table 被调用`News`并且有外键`updatedById`and `createdById`，它们都指向`userId`in table `Users`。

现在我想在`NULL`删除用户时设置为外键，但是当我尝试设置`ON DELETE SET NULL`该关系时，我得到：

> 在表“News”上引入 FOREIGN KEY 约束“FK_News_Users”可能会导致循环或多个级联路径。指定 ON DELETE NO ACTION 或 ON UPDATE NO ACTION，或修改其他 FOREIGN KEY 约束。

我不明白为什么两个外键都不能设置为空？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-28T01:36:14.837

[**多个级联操作**](http://msdn.microsoft.com/en-us/library/ms186973(v=sql.105).aspx)

> 由单个 DELETE 或 UPDATE 触发的一系列级联引用操作必须形成不包含循环引用的树。**在由 DELETE 或 UPDATE 产生的所有级联引用操作的列表中，任何表都不能出现多次。此外，级联引用操作的树不能有多个路径到任何指定的表。**树的任何分支在遇到未指定 NO ACTION 或为默认值的表时都会结束。

可能在这种情况下，您可能需要考虑实现功能以逻辑方式而不是物理方式删除用户（例如，通过在`Users`表中引入标志字段 Active 或 Deleted）。这样一来，所有关系都保持不变，并且可以进行回顾性分析。

但是，如果您仍然需要`ON DELETE SET NULL`为两个 FK 实现，则可以在表上使用`FOR DELETE`触发器，`User`如下所示：

```
CREATE TRIGGER Users_News_Delete_Trigger 
ON Users FOR DELETE
AS BEGIN
    UPDATE News SET createdById = NULL 
     WHERE createdById = DELETED.id;
    UPDATE News SET updatedById = NULL 
     WHERE updatedById = DELETED.id;
END 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-18T21:48:56.817

一种替代方法是在表 A 和表 B 之间创建一个交叉引用表，其中每个条目是 A.ID 和 B.ID 并且 B.ID 具有 B 的外键。然后您可以简单地对交叉引用进行 CASCADE 删除。您需要在交叉引用中添加第三个字段，以说明引用的唯一目的，例如

```
[NewsID] INT NOT NULL DEFAULT 0,
[UsersID] INT NOT NULL DEFAULT 0,
[IsCreatedBy] bit NOT NULL DEFAULT 0 
```

自然地，您会将这些字段从表 A 中取出。如果这些字段丢失，左连接将为您提供 null。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-28T01:41:10.227

我认为不可能（在 SQL Server 中）在同一个表上的 2 个或多个 FK 约束上执行它，指向同一个 FK。

> > 通常在这种情况下，您宁愿在逻辑上删除用户，然后在物理上通过引入标志字段（例如 Active 或 Deleted）来删除用户。这样一来，所有关系都保持不变，并且可以进行回顾性分析。--- 彼得

如果您想坚持设置 NULL 的原始想法，解决该问题的一种方法是处理您在存储过程中删除用户并让它在之后立即执行更新。

```
CREATE PROCEDURE sp_DeleteUser 
    @UserId INT
AS
BEGIN
    SET NOCOUNT ON;

    DELETE FROM Users WHERE Id = @UserId;

    UPDATE News SET created_byId = NULL WHERE created_byId = @UserId;

    UPDATE News SET updated_byId = NULL WHERE created_byId = @UserId;
END
GO 
```

# html - 如何在整个网页中保持 SQL 连接？

> ID：14553190
> 
> 赞同：1
> 
> 时间：2013-01-27T22:42:56.320
> 
> 标签：html, sql, web

假设我正在创建一个基本页面，所述页面的文本取决于通过 GET 变量传递给它的内容。

页面顶部有一个标题，如下所示：

```
<?php 
mysql_connect("stuff", "stuff", "stuff");
mysql_select_db("dbname");
mysql_query("SELECT * FROM table WHERE ID = '{$_GET['url']}'");

//Now we have connected to the SQL database.
?> 
```

假设我继续在那里编码，因此标题文本会根据传递到 URL 的内容而有所不同（但是，这无关紧要，这是我要质疑的下一部分）。

现在让我们说，在页面的下方，有更多的 PHP 代码，但中间也有更多的 HTML 代码。如果我想在第二个 PHP 片段中再次访问数据库，是否必须重新连接到数据库？或者有没有办法确保连接会话保持打开状态，即使它是一个完全不同的`<?php ?>`区域？如何使我的 SQL 连接在我结束`<?php`标签时不会被丢弃？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T22:46:25.240

来自： http: [//php.net/manual/en/function.mysql-connect.php](http://php.net/manual/en/function.mysql-connect.php)

> 注意：一旦脚本执行结束，到服务器的链接将关闭，除非它通过显式调用 mysql_close() 提前关闭。

# 编辑

抱歉，语言错误:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T22:58:34.780

让我们一次解决几个问题:-)

1.  除非您自己明确地这样做，否则*不会*断开连接。当然，它会在脚本结束时被删除。即使这样，也有一些*持久连接*和*连接池*技术可以帮助您避免开销。

2.  `mysql_*`函数系列已被弃用**[，](http://it1.php.net/manual/en/function.mysql-query.php)**可能很快就会完全停止工作。转移到更强大、更安全的例如[PDO 函数会更好。](http://php.net/manual/en/ref.pdo-mysql.php)

3.  当您将`_GET`参数直接放在 SQL 查询（或其他服务器代码）中而不进行检查/验证时，您会将自己暴露在该参数包含一些令人讨厌的惊喜的危险中。除了[XKCD](http://xkcd.com/327/)之外，经典示例是如果您检查`$_GET['password']`对应于 field `password`。如果您只是将其编码为

    WHERE ...密码='$_GET[密码]'

并且有人在该字段中放置了值

```
' OR ''==' 
```

SQL 服务器将看到

```
WHERE ... password = '' OR ''=='' 
```

并且由于 ''*确实*等于 ''，因此该查询将返回**true** - 并且用户将在不知道密码的情况下登录。如果可能的话，这种“ [SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)”通常可以调整到允许攻击者被识别为站点管理员的程度，而这一切都需要。这就是为什么您**不想**“按原样”使用客户端参数的原因。PDO 的准备好的语句也可以提供帮助。

# module - AngularJs。在模块中使用延迟

> ID：14553194
> 
> 赞同：1
> 
> 时间：2013-01-27T22:43:13.113
> 
> 标签：module, angularjs, deferred

我有从 api 获取数据的自定义模块。它是异步的，所以我使用 defer 。

```
angular.module('module', []).factory('api', function($q){
    var $scope;
    return {
        setScope: function(scope){ $scope = scope; },
        getPic:function(){
            var def = $q.defer();
            $.ajax({
                url: 'https://graph.facebook.com/shaverm/picture?redirect=false',
                dataType: 'jsonp',
                success: function(r){
                    def.resolve(r.data.url);
                    $scope.$apply();
                },
            });
            return def.promise
        }
    }
}); 
```

它工作正常，但我担心在模块中使用 scope.$apply 。

这是示例[http://jsfiddle.net/mfbFs/](http://jsfiddle.net/mfbFs/)

可以改进吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T22:51:02.090

你为什么要使用 jQuery 的 ajax，而 Angular 自带了它并且有一个内置的 Promise？

```
angular.module('module', []).factory('api', function($http){
  return {
    getPic: function(){
      return $http.jsonp('https://graph.facebook.com/shaverm/picture?redirect=false&callback=JSONP_CALLBACK');
    }
  };
}); 
```

简单多了！并且无需担心摘要 - 您的控制器已经确保在它应该发生的时候发生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T22:48:21.120

您无需`$scope`在调用 API 之前设置，只需在服务上注入`$rootScope`并在该范围内调用`$apply()`（或`$digest()`），如下所示：

```
angular.module('module', []).factory('api', function($q, $rootScope){
    return {           
        getPic:function(){
            var def = $q.defer();
            $.ajax({
                url: 'https://graph.facebook.com/shaverm/picture?redirect=false',
                dataType: 'jsonp',
                success: function(r){
                    def.resolve(r.data.url);
                    $rootScope.$apply();
                },
            });
            return def.promise
        }
    }
});
function demoCtrl ($scope, api){         
     $scope.url = api.getPic();   
} 
```

# c# - 确保 UTF-8 编码的字符串适合 2048 个字节

> ID：14553196
> 
> 赞同：0
> 
> 时间：2013-01-27T22:43:19.247
> 
> 标签：c#, string, unicode, encoding, utf-8

我正在编写一个包含 2,000 行的 DataGridView 的 C#/WinForms 应用程序。我的用户将在这些行中输入字符串。字符串可以是任何语言，但最可能的两种语言是英语和阿拉伯语。我对字符串中的最大字符数本身没有明确的限制，但我所拥有的是在将每个字符串写入磁盘时存储每个字符串的 2048 个字节的限制。如果生成的字节数组小于 2048 字节，我需要用空字符填充它。我假设 UTF-8 可能是存储这些字符串的最有效编码？如果是这样，那么我在想在允许存储字符串之前我会做这样的事情：

```
byte[] stringAsBytes = System.Text.Encoding.UTF8.GetBytes(myString);
if (stringAsBytes.Length > 2048)
{
    // string is too long to be stored in 2048 bytes
} 
```

如果我理解正确，由于 UTF-8 是可变长度编码，给定字符串中的最大字符数将取决于构成字符串语言的字符的代码点范围？如果这是正确的，我真的需要为每次按键执行类似上述代码的操作，以确定字符串何时超过最大存储大小吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T22:51:07.317

不，您可以使用以下代码：

```
var encoding=Encoding.UTF8;
var requiredBytes=encoding.GetByteCount("hello world!"); 
```

或者，您可以将字符串长度限制为

```
2048 / encoding.GetMaxByteCount(1) 
```

这将保证您编码的所有字符串都适合缓冲区。不幸的是，UTF8 只有 341 个字符。

# c++ - 数组元素的地址c ++

> ID：14553197
> 
> 赞同：0
> 
> 时间：2013-01-27T22:43:20.197
> 
> 标签：c++

> **可能重复：**
> [C++ 中的指针算法使用 sizeof(type) 增量而不是字节增量？](https://stackoverflow.com/questions/11037503/pointer-arithmetics-in-c-uses-sizeoftype-incremention-instead-of-byte-increm)

试图找到答案，但找不到。我有以下 C++ 代码：

```
struct A {
    uint16_t a;
    uint16_t b;
    uint16_t c;
}

int main() {
    uint16_t * B = new uint16_t[5000];
    for (int i=0;i<5000;i++)
        B[i] = i;

    uint16_t * D = &B[500]+sizeof(A);
} 
```

问题是：为什么 *D=512 在这之后？当我按应有的方式调试 sizeof(A) = 6 时。然而，我将 B[500] 的内存地址添加到 A 的大小，它增加了 12 而不是 6。我正在使用内存地址仍然存在乘法，我无法弄清楚为什么会这样。

请指教。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T22:50:20.563

如果`sizeof(A)`确实是 6，这是一个编译器错误。

```
&B[500] + 6 == &B[506] 
```

因此`*D`应该是506。这是我编译的时候

```
#include <iostream>
#include <cstdint>

struct A {
    uint16_t a;
    uint16_t b;
    uint16_t c;
};

int main() {
    uint16_t * B = new uint16_t[5000];
    for (int i=0;i<5000;i++)
        B[i] = i;

    uint16_t * D = &B[500]+sizeof(A);
    std::cout << (*D) << std::endl;
    return 0;
} 
```

使用 g++-4.7.1 或 clang++-3.1。

# c# - 如何在我的 GA 实现中执行双数的交叉？

> ID：14553198
> 
> 赞同：0
> 
> 时间：2013-01-27T22:43:27.417
> 
> 标签：c#, bit-manipulation, genetic-algorithm, mutation

简而言之，我该怎么做：

*   从头到尾`double`，
*   然后做交叉（一点，两点），
*   然后回到`double`

我可以开发轮盘赌选择。我看不清楚的是混合两个双打如何给我一个“更好”的双打。这是完全随机的吗？如果我的“最适者”`doubles`和我的“最弱者”结合起来，他们不会产生一个中点`double`吗？

**详细说明：** [从一点到这条曲线的最短距离](https://stackoverflow.com/questions/14531309/shortest-distance-from-a-point-to-this-curve)

**编辑 1：**不减慢程序*太多*。

**编辑 2：**我考虑使用 a `byte[]`，但我不知道这是否会违背遗传算法部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T04:15:24.927

这对我有用：

```
BitArray BAA1 = new BitArray(BitConverter.GetBytes(a1));
BitArray BAA2 = new BitArray(BitConverter.GetBytes(a2));

    for (int i = r.Next(0, 64); i > 0; i--)
            {
                temp = BAA1.Get(i);
                temp2 = BAA2.Get(i);

                BAA1.Set(i, temp2);
                BAA2.Set(i, temp);

                temp = BAB1.Get(i);
                temp2 = BAB2.Get(i);

                BAB1.Set(i, temp2);
                BAB2.Set(i, temp);
            }

        byte[] tempbytes = new byte[BAA1.Length];

        BAA1.CopyTo(tempbytes, 0);
        double baa1 = BitConverter.ToDouble(tempbytes, 0);

        BAA2.CopyTo(tempbytes, 0);
        double baa2 = BitConverter.ToDouble(tempbytes, 0); 
```

## baa1 和 baa2 是十字架的最终产物。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T12:42:15.197

这里最好的方法确实取决于双重“意味着”什么以及每个双重代表的基因组部分有多大。通常，最好的方法是将双打视为离散的，并一次跨越整个双打。

所以，如果你的父母是 {0.1 0.2 0.3 0.4 0.5} 和 {0.6 0.7 0.8 0.9 1.0} 那么他们可能会产生（例子）：

*   {0.1 0.6 0.3 0.4 0.5} 在统一选择下（从随机父母中选择每个基因）
*   单点交叉下的{0.1 0.2 0.3 0.9 1.0}（从一个亲本中获取前n个基因，从另一个亲本中获取其余基因，其中n是随机数
*   两点交叉下的{0.1 0.7 0.8 0.4 0.5}（选择两个随机数并将它们之间的基因从一个亲本插入另一个）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-27T22:56:41.603

我认为执行稍微不同的双打交叉可能会更好，例如。如果你有**1.0**和**2.0**，为什么不：

1.  取中间，**(1.0 + 2.0) / 2 = 1.5**
2.  添加一个小突变，**1.5 * random(0.9, 1.0) = 1.57**

混合两个双打的位可能会产生一个与两个父母中的任何一个都不同的孩子双打。

# ruby-on-rails - rails：多态性/抽象/继承：案例研究

> ID：14553201
> 
> 赞同：0
> 
> 时间：2013-01-27T22:43:40.133
> 
> 标签：ruby-on-rails, polymorphism

我正在尝试将我的项目从 php 迁移到 rails。Mow，我面临着一个 pb 到我有 php 解决方案的女巫，但我不知道如何使它与 rails 一起工作。

这是我的桌子

```
ads
  id
  category_id
  title
  text

ad_real_estate_details
  id
  ad_id
  nb_room
  floor

ad_car_details
  id
  ad_id
  color
  brand 
```

这是我成功的做法：

```
class Ad < ActiveRecord::Base
  attr_accessible :category_id :title, :text, :ad_real_estate_details
  has_one :ad_real_estate_details
  accepts_nested_attributes_for :ad_real_estate_details, allow_destroy: true
end

class AdRealEstateDetail < ActiveRecord::Base
  belongs_to :ad
  validates :ad_id, presence: true
end 
```

但是，这不适用于房地产以外的其他类别。

所以我在考虑多态，但是多态意味着我应该在我的“广告”表中添加一个引用到详细表，并从详细表中删除 annonce_id，我认为这是无稽之谈，因为有些广告可以没有细节，而细节是非- 没有广告的感觉。

我也在考虑一个抽象类 AdDetails，并且 AdRealEstateDetail 将从它继承，但是这对于 rails 是不可能的，因为所有子类都将共享同一个表。

有没有人有解决这种问题的方法？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T23:13:15.380

您是说要根据广告类型存储不同的“详细信息”？

一种简单的解决方案是将“详细信息”序列化为 JSON（或您喜欢的任何格式），并将它们存储在 TEXT 列中。

# android - ruboto 应用程序启动缓慢

> ID：14553202
> 
> 赞同：4
> 
> 时间：2013-01-27T22:43:46.647
> 
> 标签：android, jruby, ruboto

演示脚本（由新应用生成器生成的脚本）在我的 SGS2 上启动大约需要 6 秒。这是 jRuby 税还是我没有正确安装它（我假设`rake install`是这样）？

如果它就是这样，那么我想知道一个比其竞争对手多玩 6 秒的应用程序是否对任何人都有任何价值（真正的问题 - 不是拖钓）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-28T09:56:36.143

启动时间就是现在的样子，所以你没有做错任何事。启动时间的主要部分是 JRuby 初始化。正在努力加快这一进程，但您不应期望在不久的将来会发生重大变化。

启动时间有几种解决方法。

您可以添加漂亮的飞溅，而不是无聊的进度微调器。您可以通过在 res/layout/ 中添加 splash.xml 来做到这一点。一个漂亮的飞溅将使启动看起来更短。

您可以在用户启动应用程序之前初始化 JRuby 运行时。一种方法是通过添加侦听 BOOT_COMPLETED 事件的广播接收器在启动时启动服务。服务可以是空的，但是通过启动服务，JRuby 运行时被初始化，之后启动的任何活动都将在几毫秒内启动。你可以在这里找到一个例子：

[https://github.com/ruboto/ruboto/wiki/Tutorial%3A-Detect-and-display-the-connected-WIFI-network](https://github.com/ruboto/ruboto/wiki/Tutorial%3A-Detect-and-display-the-connected-WIFI-network)

您可以让应用程序的初始活动基于 Java，并在后台启动 JRuby 初始化。在这种情况下，JRuby 将在用户选择下一个活动时被初始化。

我不能说更长的启动时间的实际影响是什么。越快越好，但我使用了几个基于 Java 的应用程序，它们需要 10 秒或更长时间才能启动，对我来说，这并不是一个阻碍。这在很大程度上取决于应用程序的类型。

# javascript - JavaScript 词法分析器：处理“/”

> ID：14553203
> 
> 赞同：2
> 
> 时间：2013-01-27T22:43:47.160
> 
> 标签：javascript, lexer

> **可能的重复：**
> [在标记 Javascript 时出现除法/正则表达式冲突](https://stackoverflow.com/questions/4726295/division-regexp-conflict-while-tokenizing-javascript)

我正在编写一个 JS 词法分析器来取乐，并且只缺少一件：可以在正则表达式中咀嚼的部分。

以以下有效的 JS 代码为例：`/ab+c/;`

JS 词法分析器如何知道它是在处理正则表达式还是处理
`[Operator('/'), Identifier('ab'), Operator('+'), Identifier('c'), Operator('/'), Semicolon]`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T22:59:29.563

> JS 词法分析器如何知道它是在处理正则表达式还是 [some expression with `operator /`inside]？

好吧，词法分析器不能。这是解析器应该做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T22:58:58.060

您需要实现包括解析正则表达式的词汇语法。根据 [ECMA Script 文档](http://people.mozilla.org/~jorendorff/es6-draft.html#sec-5.1.2)，“ECMAScript 的 RegExp 语法在[`15.10`](http://people.mozilla.org/~jorendorff/es6-draft.html#sec-15.10)”中给出：

```
"The form and functionality of regular expressions is modeled 
after the regular expression facility in the Perl 5 programming language." 
```

另请参阅：[ECMAScript 词汇约定](http://people.mozilla.org/~jorendorff/es6-draft.html#sec-7)

# javascript - Facebook 永久访问令牌

> ID：14553208
> 
> 赞同：1
> 
> 时间：2013-01-27T22:44:24.893
> 
> 标签：javascript, html, facebook, facebook-access-token

我在一家公司的团队中工作，该公司希望在 Facebook 帖子的仪表板上显示最后一篇帖子的时间。这是一个网页。

为此，需要访问令牌。

标准 Facebook 令牌会持续 1-2 小时，然后才会变得无法使用。可以选择将此临时令牌换成长期版本，持续 60 天（约 2 个月）。有永久的令牌吗？（即没有到期日）。

**编辑**

这是一个带有一些 PHP 代码的 HTML 页面，用于显示特定 Facebook 个人资料的最后一篇文章的时间。

**编辑2**

这是这种情况：

我工作的公司目前有一个 HTML 页面，页面上有很多统计信息，例如天气、警报、图表和其他 JavaScript 小部件。我被要求显示一个小部分，显示某个 Facebook 个人资料的最后一篇帖子的时间。为此，我应该构建一个“Facebook 应用程序”，还是有其他更好的方法来检索这些信息？我可以在不创建 Facebook 应用程序的情况下使用 Facebook API 获取最后一篇文章吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T23:14:07.267

据我所知`offline_access`，已被弃用，因此无法选择永久`access_token`。您可以获得的最长的持续 60 天。

如果您想显示特定帐户的最后一篇文章的日期（我想这是针对观众帐户），您可以创建 Facebook 应用程序，请求 read_stream 扩展权限，检查最后一篇文章的日期并将其显示在一个请求中（使用 JavaScript SDK ）。

你可以用它来获取最后一篇文章

```
/me/feed?limit=1 
```

# c++ - Monty Hall 模拟中的意外结果

> ID：14553209
> 
> 赞同：1
> 
> 时间：2013-01-27T22:44:37.893
> 
> 标签：c++

根据我读到的概率，切换门应该有大约 66% 的机会选择正确的门。下面的代码是我想出的，它输出了大约 50% 的胜利，而不是我期望的 66%。任何关于我在这里出错的地方的帮助将不胜感激。

```
for (int count = 0; count < 10000; count++)
{
    // Chooses which door contains DAT GRAND PRIZE YO.
    wDoor = rand() % 3 + 1;

    // AI Contestants Door choice
    aiDoor = rand() % 3 + 1;

    // Using oldChoice to ensure same door isn't picked.
    oldChoice = aiDoor;
    // Used in determining what door to open.
    openedDoor = aiDoor;

    // "Open" a door that is not the winning door and not the door chosen by player.
    do
    {
                openedDoor = rand() % 3 + 1;

    }while (openedDoor != wDoor && openedDoor != aiDoor);

    // Select new door between the remaining two.
    do
    {
              aiDoor = rand() % 3 + 1;

    }while (aiDoor != oldChoice && aiDoor != openedDoor);

    // Increment win counter if new door is correct.
    if (aiDoor == wDoor)
    {
               chooseAgain++;
    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T22:49:53.640

你的`while`条件是错误的：

```
while (openedDoor != wDoor && openedDoor != aiDoor) 
```

应该

```
while (openedDoor == wDoor || openedDoor == aiDoor) 
```

等等

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T22:59:05.233

你的条件颠倒了。do ... while (...) 循环将按照您的评论所述执行，如果它们是重复的 .. until(...)，它对于终止测试具有相反的极性。

否定实现所需算法的条件。

请注意，在这两种情况下，您最多可以选择两扇门。使用这些知识，您最多可以使用一次 rand() 并且没有循环来确定隔壁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T23:22:41.137

```
// "Open" a door that is not the winning door and not the door chosen by player.
    do
    {
                openedDoor = rand() % 3 + 1;

    }while (openedDoor != wDoor && openedDoor != aiDoor); 
```

当您打开获胜门 (!) 或玩家选择的门时，此条件为假（即循环结束）。这与您想要的相反。

```
 // Select new door between the remaining two.
    do
    {
              aiDoor = rand() % 3 + 1;

    }while (aiDoor != oldChoice && aiDoor != openedDoor); 
```

当玩家选择与之前相同的门或打开的门时，此条件为假（即循环结束）。这也与您想要的相反。

颠倒条件给出了预期的结果（~0.66）。

# javascript - 自动完成问题，如果搜索词相同，则不会打开 - jquery ui autocomplete

> ID：14553211
> 
> 赞同：0
> 
> 时间：2013-01-27T22:44:55.243
> 
> 标签：javascript, jquery, jquery-ui, autocomplete

jquery 做的自动完成似乎有一个很小的问题，但令人不安，

随着时间的推移，我已经在许多输入字段中实现了它，但我总是觉得以下烦人：

如果你在上面搜索一个词，说“书”，然后它会很好地打开显示在 li 中呈现的书，好吧，但是现在如果你快速使 control + a 全选，然后 control + x 剪切，然后控制+ v 粘贴，你会注意到发生了什么，自动完成只是没有打开。

似乎它不会搜索输入的术语是否相同，这是一个好的机制，可以按下与该术语不同的其他键，就像 ctrl 键一样，或者如果您要再次模糊自动完成和焦点，您也不一定需要它来搜索，但是如果您删除字符（术语）然后重新输入完​​全相同的字符，我主要通过执行 ctrl + a、ctrl + x、ctrl + v 键来尝试组合，然后自动完成保持关闭。

这似乎有点尴尬，我想知道如果搜索词仍然与上次搜索的内容相同，要进行哪些更改以使其“打开”。

感谢任何对此有解决方案的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-10T16:25:42.980

这可以处理粘贴而不需要模糊。

```
$(document).on('input propertychange',
               '.ui-autocomplete-input',
                function() { 
                 $(this).autocomplete('search',$(this).val()); 
                }); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-27T23:08:06.957

您可以使用

```
 $(document).on('change',
                   '.ui-autocomplete-input',
                   function(){
                   $(this).autocomplete('search',$(this).val()); 
                   }); 
```

# scala - 添加“扩展 AnyVal”会导致“类型参数不符合”错误

> ID：14553214
> 
> 赞同：4
> 
> 时间：2013-01-27T22:45:47.967
> 
> 标签：scala, scala-2.10

在 Scala 2.10 中，这有效：

```
implicit class T1[A](val self: Iterator[A]) {
  def :+[B >: A](elem: B): Iterator[B] =
    self ++ Iterator(elem)
} 
```

但是当我尝试使它成为一个价值类时：

```
implicit class T2[A](val self: Iterator[A]) extends AnyVal {
  def :+[B >: A](elem: B): Iterator[B] =
    self ++ Iterator(elem)  
} 
```

我得到错误：

```
type arguments [B] do not conform to method ++'s type parameter bounds [B >: A] 
```

为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T23:34:16.140

这是一个错误，它已经在当前的夜间修复。

请参阅[此票](https://issues.scala-lang.org/browse/SI-7022)以获取更多信息。

# joomla - Joomla！2.5 语言文件 - 无法将描述翻译成 xml 文件

> ID：14553225
> 
> 赞同：0
> 
> 时间：2013-01-27T22:46:26.830
> 
> 标签：joomla, joomla2.5, joomla-extensions

我在这里查看了问题：[Joomla！2.5 语言文件 - 翻译描述](https://stackoverflow.com/questions/13844746/joomla-2-5-language-file-translate-description) 这正是我遇到的问题，但不幸的是我无法回答 Valentin 的评论。所以这又是我的问题：

在我的**xml 文件**中，我有这一行：

```
<description>COM_MYCOMPONENT_DESCRIPTION</description> 
```

在文件**en-GB.com_mycomponent.sys.ini**我有这个：

```
COM_MYCOMPONENT="MyComponent"
COM_MYCOMPONENT_DESCRIPTION="This is the myComponent description"
COM_MYCOMPONENT_SUMMARY="Summary" 
```

但是在语言的调试模式下，我每次都会得到这个结果：

```
??COM_MYCOMPONENT_DESCRIPTION?? 
```

有任何想法吗？

比约恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T08:28:38.560

您正确使用了语言文件，因此我认为这是由于文件的位置所致。确保您的 XML 文件中有以下内容：

```
<languages folder="language">
        <language tag="en-GB">en-GB/en-GB.com_mycomponent.ini</language>
        <language tag="en-GB">en-GB/en-GB.com_mycomponent.sys.ini</language>
</languages> 
```

还要注意位置：

我在文件名之前使用了`folder="language"`then `en-GB`，因此文件夹结构将如下所示：

```
root(where the XML is)/language/en-GB/en-GB.com_mycomponent.sys.ini 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-08T17:06:26.357

您不必将语言文件放在这两个地方。您的第一个配置实际上是正确的，并且肯定在 Joomla 3.3 上运行。在您的清单文件中，您应该将语言文件声明为

```
<administration>
    ....
    <folder>language</folder>
    .....
 </administration> 
```

并且不要利用

```
<languages>....</languages> 
```

同样在您的包上，文件夹结构应该是
admin/language/en-GB/en-GB.yourcomponent.sys.ini。

如果您已经有此配置，那么您是正确的。
在那种情况下，从语言调试模式的消息来看，我假设您拼错了某些内容，或者您​​的语言文件中有错误。
后者是我经常发生的事情。例如很多时候我有这个错误：

```
COM_MYCOMPONENT_TRA="A translation string"
COM_MYCOMPONENT_ANOTHER_ONE="Another one"
COM_MYCOMPONENT_SOMEOTHER=Some othen translation string"
COM_MYCOMPONENT_MORE="One more "
COM_MYCOMPONENT_LAST_ONE="E translation string" 
```

（缺少第三行的第一个双引号）。

# php - 如何在 PHP / HTML 中显示 MySQL 选择语句

> ID：14553232
> 
> 赞同：2
> 
> 时间：2013-01-27T22:47:24.850
> 
> 标签：php, html

MySQL 选择未在 PHP/HTML 中正确显示

这是我的代码：

```
<?php
session_start();
require_once("database.php");
require_once("MySQL_connection.php");

/* Database connection */
$db = new MySQLConnection($config['sql_host'], $config['sql_username'], $config['sql_password'], $config['sql_database']);
$db->Connect();

unset($config['sql_password']);

/* Cron */
require_once("cron.php");

/* Display Advert */

$ad_link = $db->Query("SELECT `site_url` FROM `adverts` WHERE `zone`=1 AND `days`>0 ORDER BY RAND() LIMIT 0,1;");

$img_link = $db->Query("SELECT `image_url` FROM `adverts` WHERE `zone`=1 AND `days`>0 ORDER BY RAND() LIMIT 0,1;");

?>

<!DOCTYPE html>
<html>
<body>
<a href="<?php echo $ad_link ?>"><img src="<? echo $img_link ?>"></a>
</body>
</html> 
```

由于某种原因，显示为：

```
<html><head></head><body>
<a href="Resource id #6"><img src="Resource id #7"></a>

</body></html> 
```

有人知道出了什么问题吗？

忘记添加 MYSQL_connection.php 的代码，以下代码是该文件中用于连接数据库的所有内容。

```
<?php

class MySQLConnection {

    private $sqlHost;
    private $sqlUser;
    private $sqlPassword;
    private $sqlDatabase;

    private $mySqlLinkIdentifier = FALSE;

    public $QueryFetchArrayTemp = array();

    private $numQueries = 0;

    public $UsedTime = 0;

    public function __construct($sqlHost, $sqlUser, $sqlPassword, $sqlDatabase = FALSE) {
        $this->sqlHost = $sqlHost;
        $this->sqlUser = $sqlUser;
        $this->sqlPassword = $sqlPassword;
        $this->sqlDatabase = $sqlDatabase;
    }

    public function __destruct() {
        $this->Close();
    }

    public function Connect() {
        if($this->mySqlLinkIdentifier !== FALSE) {
            return $this->mySqlLinkIdentifier;
        }

        $this->mySqlLinkIdentifier = mysql_connect($this->sqlHost, $this->sqlUser, $this->sqlPassword, TRUE); // Open new link on every call
        if($this->mySqlLinkIdentifier === FALSE) {
            return FALSE;
        }

        if($this->sqlDatabase !== FALSE) {
            mysql_select_db($this->sqlDatabase, $this->mySqlLinkIdentifier);
        }

        return $this->mySqlLinkIdentifier;
    }

    public function Close() {
        if($this->mySqlLinkIdentifier !== FALSE) {
            mysql_close($this->mySqlLinkIdentifier);
            $this->mySqlLinkIdentifier = FALSE;
        }
    }

    public function GetLinkIdentifier() {
        return $this->mySqlLinkIdentifier;
    }       

    public function Query($query) {
        $start = microtime(true);
        $result = mysql_query($query, $this->GetLinkIdentifier());
        $this->UsedTime += microtime(true) - $start;
        $this->numQueries++;

        if( $result === false ){
            die($this->GetErrorMessage());
        }

        return $result;
    }

    public function FreeResult($result) {
        mysql_free_result($result);
    }

    public function FetchArray($result) {
        return mysql_fetch_array($result, MYSQL_ASSOC);
    }

    public function FetchArrayAll($result){
        $retval = array();
        if($this->GetNumRows($result)) {
            while($row = $this->FetchArray($result)) {
                $retval[] = $row;
            }           
        }
        return $retval;
    }   

    public function GetNumRows($result) {
        return mysql_num_rows($result);
    }

    public function GetNumAffectedRows() {
        return mysql_affected_rows($this->mySqlLinkIdentifier);
    }

    // Helper methods
    public function QueryFetchArrayAll($query) {
        $result = $this->Query($query);
        if($result === FALSE) {
            return FALSE;
        }

        $retval = $this->FetchArrayAll($result);
        $this->FreeResult($result);

        return $retval;         
    }

    public function QueryFirstRow($query) {
        $result = $this->Query($query);
        if($result === FALSE) {
            return FALSE;
        }

        $retval = FALSE;

        $row = $this->FetchArray($result);
        if($row !== FALSE) {
            $retval = $row;
        }

        $this->FreeResult($result);

        return $retval;     
    }

    public function QueryFirstValue($query) {
        $row = $this->QueryFirstRow($query);
        if($row === FALSE) {
            return FALSE;
        }

        return $row[0];         
    }

    public function GetErrorMessage() {
        return "SQL Error: ".mysql_error().": ";
    }

    public function EscapeString($string) {
        if (is_array($string))
        {
            $str = array();
            foreach ($string as $key => $value)
            {
                $str[$key] = $this->EscapeString($value);
            }

            return $str;
        }

        return get_magic_quotes_gpc() ? $string : mysql_real_escape_string($string, $this->mySqlLinkIdentifier);
    }

    function GetNumberOfQueries() {
        return $this->numQueries;
    }

    public function BeginTransaction() {
        $this->Query("SET AUTOCOMMIT=0");
        $this->Query("BEGIN");
    }

    public function CommitTransaction() {
        $this->Query("COMMIT");
        $this->Query("SET AUTOCOMMIT=1");
    }

    public function RollbackTransaction() {
        $this->Query("ROLLBACK");
        $this->Query("SET AUTOCOMMIT=1");
    }

    public function GetFoundRows() {
        return $this->QueryFirstValue("SELECT FOUND_ROWS()");
    }

    public function GetLastInsertId() {
        return $this->QueryFirstValue("SELECT LAST_INSERT_ID()");           
    }

    public function QueryFetchArray($query, $all = false, $useCache = true)
    {
        $tempKey = sha1($query . ($all === true ? 'all' : 'notAll'));
        $temp = $this->QueryFetchArrayTemp[$tempKey];

        if ($temp && $useCache === true)
        {
            return unserialize($temp);
        }
        else
        {
            $queryResult = $this->Query($query);
            $result = $all === true ? $this->FetchArrayAll($queryResult) : $this->FetchArray($queryResult);

            $this->QueryFetchArrayTemp[$tempKey] = serialize($result);
            return $result;
        }
    }
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T22:50:51.397

您正在使用一些自定义 MySQL 包装器，但您可能应该使用或类似方法从查询`mysql_result()`中获取结果。`mysql_fetch_array()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T23:01:30.790

您最好阅读`mysqli`，这是执行 MySQL 查询的一种更安全的方法。你可以在这里找到优秀的文档：http: [//php.net/manual/en/book.mysqli.php](http://php.net/manual/en/book.mysqli.php)，这里还有一个非常有用的教程，涵盖了像你这样的简单查询：[http ://www.phphaven.com /article.php?id=65](http://www.phphaven.com/article.php?id=65)

对于您的具体问题，我将使用以下内容：

```
$query = "SELECT `site_url`,`image_url` FROM `adverts` WHERE `zone`=1 AND `days`>0 ORDER BY RAND() LIMIT 0,1;";
$result = $mysqli->query($query) or die($mysqli->error.__LINE__);

if($result->num_rows > 0) {
    while($row = $result->fetch_assoc()) {
        // I've split these lines up to make them a little more readable.
        echo '<a href="';
        echo $row['site_url'];
        echo '">';
        echo '<img src="';
        echo $row['image_url'];
        echo '"</img></a>';
    }
}
else {
    echo 'NO RESULTS';  
} 
```

我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T23:23:15.723

使用您的自定义 MySQL 类，这可能会起作用：

```
$result = $db->Query("SELECT `site_url`,`image_url` FROM `adverts` WHERE `zone`=1 AND `days`>0 ORDER BY RAND() LIMIT 0,1;");

while($row = $db->FetchArray($result)) {
    echo '<a href="' . $row['site_url'] . '"><img src="' . $row['image_url'] . '"></a>';
}

$db->FreeResult($result); 
```

但是，正如其他人指出的那样，您的自定义 MySQL 类中使用的代码已被弃用，应该更新以使用更新的 php 方法/库。

# php - SQL语句我绕不过去（脑洞太小）

> ID：14553233
> 
> 赞同：9
> 
> 时间：2013-01-27T22:47:29.920
> 
> 标签：php, sql, inner-join

我正在编写一种旅行“约会”应用程序。

*   用户自行注册
*   用户告诉应用他们是男性还是女性
*   用户告诉应用他们想访问哪些国家
*   用户告诉应用他们想与男性 (pref_m=1) 还是女性 (pref_f=1) 一起旅行

## 我的桌子

**表 1：用户**

`id (key) | gender | pref_m | pref_f
------------------------------------
 1          male     1        0
 2          male     1        1`

**表 2：国家选择**

`id (key) | userid | countryid
------------------------------------
 1          1        123
 2          1        111
 3          1        100
 4          1        110
 5          2        123
 6          2        111
 7          2        202
 8          2        210` 

## 那么select语句必须做什么

**输入：**当前用户的用户 ID
**输出（在逻辑中）：**选择用户 ID 和匹配国家/地区的所有人，这些人想去和我一样的国家旅行，并想和我性别的人一起旅行（
*加入）*选择 我显然只需要与我正在寻找的性别相同的人。
由与我 DESC 最匹配的国家的人订购。

## 到目前为止我所拥有的（警告：不多）

`$sql = "SELECT userid,count(*) AS matches from countryselection";
 $sql .= " WHERE countryid IN (SELECT countryid FROM countryselection WHERE userid = :userid) GROUP BY userid ORDER BY matches DESC;";` *这给了我一份想要去和我一样的国家旅行的所有人的名单（以及我们有多少个共同国家）*

## 最后注

我显然在性别选择部分苦苦挣扎。
不确定我是否做了正确的事情来以我的方式存储用户选择。
我可能也需要一些指导。

**显然 - 谢谢大家。**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-27T23:04:17.510

```
SELECT        
    us2.id, -- etc. 
    COUNT(cs2.countryid) as countries_in_common               
FROM
    countryselection cs1 -- let's gather user countries he want to visit
LEFT JOIN -- now let's find other users!
    countryselection cs2 ON
    (
        cs2.userid <> :userid AND -- which are not him
        cs2.countryid = cs1.countryid -- and want to visit same countries
    )
INNER JOIN -- let's grab our user_data
    users us1 ON 
    (
        us1.id = cs1.userid
    )
INNER JOIN -- and let's grab other user data!
    users us2 ON
    (
        us2.id = cs2.userid
    )
WHERE
    cs1.userid = :userid AND -- finding our user countries he want to visit
    -- final checks
    (
        (us1.pref_m = 1 AND us2.gender = 'male') 
        -- he is looking for male and second user is male
        OR
        (us1.pref_f = 1 AND us2.gender = 'female') 
        -- he is looking for female and second user is female
    ) AND
    (
        (us2.pref_m = 1 AND us1.gender = 'male')
        OR
        (us2.pref_f = 1 AND us1.gender = 'female') 
    ) 
GROUP BY
    cs2.userid -- finally group by user_id 
```

最好的是没有子查询，您可以通过多种方式轻松使用此查询。（更改顺序、分组依据和使用聚合函数）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T23:37:53.557

如果您不按大多数国家/地区共同进行排序，这很容易（如果结果集不会太大，您可以稍后在代码中进行）：

```
SELECT
    o.id userid, u_cs.countryid
FROM users u
JOIN countryselection u_cs ON (u.id = u_cs.userid)
JOIN countryselection o_cs ON (u_cs.countryid = o_cs.countryid)
JOIN users o ON (o_cs.userid = o.id)
WHERE
    u.id = :userid AND   -- The user we want
    u.id <> o.id AND     -- Exclude ourselves
    (                    -- Check whether the other person is
                         -- compatible with us
        (u.pref_m = 1 AND o.gender = 'male') OR
        (u.pref_f = 1 AND o.gender = 'female')
    ) AND
    (                    -- Check whether we're compatible with the
                         -- other person
        (o.pref_m = 1 AND u.gender = 'male') OR
        (o.pref_f = 1 AND u.gender = 'female')
    ) 
```

[SQL小提琴](http://sqlfiddle.com/#!2/5ee7c/23)

* * *

如果您*确实*想要排序，我认为最好的选择是使用`GROUP_CONCAT`（因为 MySQL 很烂并且不支持窗口/分析功能）。

```
SELECT
    o.id userid, GROUP_CONCAT(u_cs.countryid) countries
FROM users u
JOIN countryselection u_cs ON (u.id = u_cs.userid)
JOIN countryselection o_cs ON (u_cs.countryid = o_cs.countryid)
JOIN users o ON (o_cs.userid = o.id)
WHERE
    u.id = :userid AND   -- The user we want
    u.id <> o.id AND     -- Exclude ourselves
    (                    -- Check whether the other person is
                         -- compatible with us
        (u.pref_m = 1 AND o.gender = 'male') OR
        (u.pref_f = 1 AND o.gender = 'female')
    ) AND
    (                    -- Check whether we're compatible with the
                         -- other person
        (o.pref_m = 1 AND u.gender = 'male') OR
        (o.pref_f = 1 AND u.gender = 'female')
    )
GROUP BY o.id
ORDER BY COUNT(u_cs.countryid) DESC 
```

你也可以用一些讨厌的子查询来解决这个问题，但我觉得它会影响性能。

[SQL小提琴](http://sqlfiddle.com/#!2/5ee7c/22)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-28T00:03:09.760

```
SELECT t4.id, COUNT(t4.id) AS frequency
FROM users t1
LEFT JOIN countryselection t2
ON t1.id = t2.userid
INNER JOIN countryselection t3 
  ON t2.userid != t3.userid AND t2.countryid = t3.countryid
INNER JOIN users t4 
  ON t3.userid = t4.id 
   AND ((t4.pref_m = 1 AND t1.gender = 'male' OR t4.pref_f = 1 AND t1.gender = 'female')
     AND (t1.pref_m = 1 AND t4.gender = 'male' OR t1.pref_f = 1 AND t4.gender = 'female'))
WHERE t1.id = ?
GROUP BY t4.id
ORDER BY frequency DESC 
```

与此处的其他人类似，但使用适当的连接类型和连接条件而不是 where 条件。

来自[MySQL 文档](http://dev.mysql.com/doc/refman/5.5/en/join.html)：

> 与 ON 一起使用的 conditional_expr 是可以在 WHERE 子句中使用的任何形式的条件表达式。通常，您应该对指定如何连接表的条件使用 ON 子句，并使用 WHERE 子句来限制结果集中需要哪些行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-27T23:22:00.330

推断 DDL：

```
create table users (id int, gender text, pref_m bool, pref_f bool);
create table countryselection (id int, userid int, countryid int); 
```

这是您可以`.import`（使用 sqlite3，在做之后`.separator ,`）进入问题中的表的 CSV：

用户.csv：

```
1,male,1,0
2,male,1,1 
```

国家选择.csv

```
1,1,123
2,1,111
3,1,100
4,1,110
5,2,123
6,2,111
7,2,202
8,2,210 
```

彼得的 sql，编辑为使用问题中的字段名称：

```
SELECT        
    us2.id,
    COUNT(cs2.*) as countries_in_common
FROM
    countryselection cs1 
LEFT JOIN 
    countryselection cs2 ON
    (
        cs2.userid <> $userid AND 
        cs2.countryid = cs1.countryid 
    )
LEFT JOIN 
    users us1 ON 
    (
        us1.id = cs1.userid
    )
LEFT JOIN 
    users us2 ON
    (
        us2.id = cs2.userid
    )
WHERE
    cs1.userid = $userid AND 
    cs2.userid IS NOT NULL AND
    (
        (us1.pref_m = 1 AND us2.gender = 'male') 
        OR
        (us1.pref_f = 1 AND us2.gender = 'female') 
    ) AND
    (
        (us2.pref_m = 1 AND us1.gender = 'male')
         OR
        (us2.pref_f = 1 AND us1.gender = 'female') 
    )          
GROUP BY
    cs2.userid 
; 
```

你可以像这样执行它：

```
sqlite3 myDBname < peters_sql.sql 
```

设置`$userid`为`1`，我得到`2`输出。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-27T23:43:12.740

我认为这行得通

```
select me.id meid
     , them.id themid
     , me.gender mygender
     , them.gender themgender
     , me.pref_m mepref_m
     , me.pref_f mepref_f
     , them.pref_m thempref_m
     , them.pref_f thempref_f
     , csme.countryid

  from users me

 cross
  join users them

 inner
  join countryselection csme
    on me.id = csme.userid

 inner
  join countryselection csthem
    on them.id = csthem.userid

 where csme.countryid = csthem.countryid
   and ((me.gender = 'male' and them.pref_m) or (me.gender = 'female' and them.pref_f))
   and ((them.gender = 'male' and me.pref_m) or (them.gender = 'female' and me.pref_f))
   and me.id != them.id
   and me.id = 2 
```

[http://sqlfiddle.com/#!2/06351/25/0](http://sqlfiddle.com/#!2/06351/25/0)

我故意将分组排除在外，以便更容易验证结果。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-27T23:48:19.683

更新：（添加国家）

```
SELECT u1.id AS uid1
        , u2.id AS uid2
        , cs.countryid
FROM users u1
, users u2
JOIN countryselection cs ON cs.userid = u2.id
-- WHERE u1.id < u2.id -- tiebreaker
WHERE u1.id = 12345
AND EXISTS (
        SELECT * FROM countryselection cs1
        JOIN countryselection cs2 ON cs1.countryid = cs2.countryid
        WHERE cs1.userid = u1.id
        AND cs2.userid = u2.id
        )
AND ((u1.pref_m = True AND u2.gender = 'male')
        OR (u1.pref_f = True AND u2.gender = 'female') )
        -- the love must be mutual ...
AND ((u2.pref_m = True AND u1.gender = 'male')
        OR (u2.pref_f = True AND u1.gender = 'female') )
        ; 
```

# regex - notepad++ 正则表达式在模式之间插入值

> ID：14553236
> 
> 赞同：0
> 
> 时间：2013-01-27T22:47:51.087
> 
> 标签：regex

我需要一个正则表达式匹配器来查找由一堆记录组成的列表的模式

所有这些都以逗号结尾。

我想在第一次出现逗号时插入开头和结尾的 h1 标签。

我尝试使用（。*），

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T22:51:12.643

尝试使用`(.*?),`或`([^,]+),`。前者是首选，但 Notepad++ 可能不支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T23:06:08.307

这应该捕获一行中的所有内容，直到并包括逗号：

```
[^,]*?, 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-27T23:22:17.533

您可以使用此正则表达式：

```
^([^,]*), 
```

这将定位一行中第一个逗号之前的字符串。还有一个捕获组，它捕获第一个逗号之前的文本以供替换参考。

# entity-framework - 从 ObjectContext 获取 DBContext

> ID：14553239
> 
> 赞同：11
> 
> 时间：2013-01-27T22:48:08.670
> 
> 标签：entity-framework, dbcontext, objectcontext

我正在使用最新版本的 ASP.NET MVC、SQL Server 和实体框架。我*没有*先使用代码。

我可以使用我的 EDMX 文件生成的类轻松创建对象上下文。

但是有没有办法`DBContext`从那个类中获取一个对象？我想使用它的扩展功能。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-27T23:13:20.253

您可以为`DbContext`. 右键单击 edmx 的设计图面并选择“添加代码生成项”，然后从“添加新项”对话框中选择 DbContext Generator（您可能需要查看在线模板）。这将创建一个 t4 模板，该模板生成一个`DbContext`.

如果您想继续使用`ObjectContext`API，但有时想切换到`DbContext`您可以创建一个`DbContext`接受作为参数[的构造函数。`ObjectContext`](http://msdn.microsoft.com/en-us/library/gg696505%28v=vs.103%29.aspx)

# java - 在 Android 中动态创建多个 ListView

> ID：14553248
> 
> 赞同：2
> 
> 时间：2013-01-27T22:49:32.680
> 
> 标签：java, android, xml, android-layout, listview

我目前正在使用 android 开发一个基本的新闻聚合应用程序，我知道那里有很多负载，但我基本上只是创建一个，因为我认为对于刚开始使用 Android 开发的人来说，这是一个很好的起点。

我的目标是显示来自多个提要的文章。每个提要都有自己的水平滑动列表，有点像脉冲新闻应用程序。到目前为止，我已经设法找到有关创建“Horizo​​ntalListView”的教程，现在我的应用程序显示了一个基本的水平滑动列表视图，如下所示：

**截图链接： http:** [//www.dev-smart.com/wp-content/uploads/2011/03/device-200x300.png](http://www.dev-smart.com/wp-content/uploads/2011/03/device-200x300.png)

**脉冲应用程序屏幕截图：** [http://a1525.phobos.apple.com/us/r1000/080/Purple/v4/ba/6a/01/ba6a01d1-f0b7-4bb7-3f94-5a5761653e3c/mzl.zxnjzzmk.480x480-75。 jpg](http://a1525.phobos.apple.com/us/r1000/080/Purple/v4/ba/6a/01/ba6a01d1-f0b7-4bb7-3f94-5a5761653e3c/mzl.zxnjzzmk.480x480-75.jpg)

代码：

```
public class HorizontalListViewDemo extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.listviewdemo);

    HorizontalListView listview = (HorizontalListView) findViewById(R.id.listview);
    listview.setAdapter(mAdapter);

}

private static String[] dataObjects = new String[]{ "Text #1",
    "Text #2",
    "Text #3", "Text #4"  }; 

private BaseAdapter mAdapter = new BaseAdapter() {

    private OnClickListener mOnButtonClicked = new OnClickListener() {

        @Override
        public void onClick(View v) {
            AlertDialog.Builder builder = new AlertDialog.Builder(HorizontalListViewDemo.this);
            builder.setMessage("hello from " + v);
            builder.setPositiveButton("Cool", null);
            builder.show(); 
        }
    };

    @Override
    public int getCount() {
        return dataObjects.length;
    }

    @Override
    public Object getItem(int position) {
        return null;
    }

    @Override
    public long getItemId(int position) {
        return 0;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View retval = LayoutInflater.from(parent.getContext()).inflate(R.layout.viewitem, null);
        TextView title = (TextView) retval.findViewById(R.id.title);
        Button button = (Button) retval.findViewById(R.id.clickbutton);
        button.setOnClickListener(mOnButtonClicked);
        title.setText(dataObjects[position]);
        return retval;
    }   
};
} 
```

XML:

```
<?xml version="1.0" encoding="utf-8"?>

<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
>

<LinearLayout
  xmlns:android="http://schemas.android.com/apk/res/android"
  android:orientation="vertical"
  android:layout_width="fill_parent"
  android:layout_height="wrap_content"
  android:background="#000"
  >

  <com.devsmart.android.ui.HorizontalListView
    android:id="@+id/listview"
    android:layout_width="fill_parent"
    android:layout_height="250dp"
    android:background="#ddd"
  />

</LinearLayout>
</ScrollView> 
```

正如我所提到的，每个 Horizo​​ntalListView 将代表 1 个提要并如上所述显示其相关文章。因此，我在此开发中的下一步是尝试动态创建这些 Horizo​​ntalListView，以便用户可以从应用程序中声明一个提要，然后在已定义的提要下方动态创建它。

忽略该过程中涉及的所有其他努力，我实际上只是寻求帮助创建一个新的 Horizo​​ntalListView，它可以回收已经定义的 XML listview 布局 id="listview"。我知道如果我在哪里预定义所有提要并创建具有唯一 id 的唯一 XML 布局，我可以让它工作，但我想知道有没有一种方法可以定义一个新的 Horizo​​ntalListView 重用现有布局。

我希望你们能对我有所了解。

谢谢

**更新 1：** 使用视图？

```
//Defining main XML file "listviewdemo.xml"
setContentView(R.layout.listviewdemo);
//Creating a new view to apply to my HorizontalListViews, /res/layout/listviewStyle.xml
View view = getLayoutInflater().inflate(R.layout.listviewStyle, null);

//Defining my first HorizontalListView      
HorizontalListView listview = (HorizontalListView) view.findViewById(R.id.listviewReuse);
listview.setAdapter(mAdapter); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T23:40:09.923

```
HorizontalListView listview = (HorizontalListView) findViewById(R.id.listview); 
```

This line will always return the first view found with R.id.listview. Not very nice when you have multiple list views.

Now instead of calling Activity.findViewById() call findViewById() on a subview. You can contain each listview inside of a layout. Then call findViewById to find the layout that is the parent to the listview. The call findViewById on the layout.

Once you have found the listView the first time remember it for later use.

In the updated code you posted, remove this line. It is not doing anything b/c this view is not apart of the layout R.layout.listviewdemo.

```
View view = getLayoutInflater().inflate(R.layout.listviewStyle, null); 
```

Then in The xml for R.layout.listviewdemo add both listviews to the same .xml (assuming that is your goal). Whatever the case maybe you should add all of your views to the same layout then retrieve the views using `findViewById`.

# ruby-on-rails - 根据库存水平构建数组

> ID：14553255
> 
> 赞同：1
> 
> 时间：2013-01-27T22:50:31.390
> 
> 标签：ruby-on-rails, ruby

我做了一个简单的库存系统，想在购买产品之前显示一个选择器来选择尺寸。我希望选择器只显示有库存的商品，不允许用户选择没有库存的商品。我这样做是为了在创建产品时创建一组变体，包括它们的名称和数量。因此，当我创建产品时，它会创建 3 个变体，分别命名为 Small、Medium 和 Large，每个变体的数量为 0。我使用 ruby​​ 控制台更新了每个变体的数量，因此以下内容将起作用：

意见/产品/show.html.erb

```
<div class="size"><br/>Size: <%= f.select(:size, options_for_select(@sizes_availiable), :prompt => "Select a size") %></div> 
```

product_controller.rb

```
 def show
    @product = Product.find(params[:id])
    @sizes_availiable = Product.build_size_enum( @product.id )
  end 
```

产品.rd

```
 def self.build_size_enum(product_id)
    p = Product.find(product_id)
    a = []
    p.variants.each do |var|
      unless var.qty = 0
        a << var.name
      end
    end
    a
  end 
```

但是，选项是空的（只有“选择尺寸”选项）。如果我从 Product.rb 中删除了 unless 语句（这违背了目的），因此该方法如下所示，列表中填充了小型和大型：

产品.rd

```
 def self.build_size_enum(product_id)
    p = Product.find(product_id)
    a = []
    p.variants.each do |var|
      a << var.name
    end
    a
  end 
```

关于为什么除非语句引起问题的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T22:58:50.210

您正在使用`=`而不是`==`. `var.qty = 0`将始终在 Ruby 中测试为“真”，但不幸的副作用是清除您尝试测试的数据。将其更改为`var.qty == 0`，您应该没问题。

# c# - 如何将二维数组的一部分作为参数传递给函数？

> ID：14553257
> 
> 赞同：2
> 
> 时间：2013-01-27T22:51:01.460
> 
> 标签：c#

我有一个像这样的二维数组：

```
double[,] results = new double[100,100]; 
```

我想将数组的每个一维部分作为参数传递给函数。

```
for (int i = 0; i < 100; i++){
     cool_function (results[???], 10);
} 
```

我如何在 C# 中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T22:53:37.217

如果不复制数组的相应部分，您将无法做到这一点。

否则，您可以使用`double[][]`. 初始化：

```
double[][] results = new double[100][];
for(int i = 0; i < 100; i++)
    results[i] = new double[100]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T22:55:08.713

[source](http://www.c-sharpcorner.com/UploadFile/mahesh/WorkingWithArrays11232005064036AM/WorkingWithArrays.aspx) 锯齿状数组是数组的数组。交错数组的元素是其他数组。

声明交错数组

锯齿状数组的声明涉及两个括号。例如，以下代码片段声明了一个包含三个数组项的交错数组。

```
int[][] intJaggedArray = new int[3][]; 
```

下面的代码片段声明了一个包含两个数组项的锯齿状数组。

```
string[][] stringJaggedArray = new string[2][]; 
```

初始化交错数组

在可以使用交错数组之前，必须对其项进行初始化。下面的代码片段初始化一个交错数组；第一项包含一个包含两个整数的整数数组，第二项包含一个包含 4 个整数的整数数组，第三项包含一个包含 6 个整数的整数数组。

```
// Initializing jagged arrays
intJaggedArray[0] = new int[2];
intJaggedArray[1] = new int[4];
intJaggedArray[2] = new int[6]; 
```

我们还可以通过提供数组项的值来初始化交错数组的项。以下代码片段在声明期间直接初始化数组的项。

```
// Initializing jagged arrays
intJaggedArray[0] = new int[2]{2, 12};
intJaggedArray[1] = new int[4]{4, 14, 24, 34};
intJaggedArray[2] = new int[6] {6, 16, 26, 36, 46, 56 }; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-27T22:54:50.210

*如果您的意思是要为大小为y的**x*数组调用函数的数组*myarray[x][y]* ，那么您只需要以下代码：

 **```
int i;

for (i = 0; i < 100; i++)
{
    cool_function(array[i], 10);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-27T23:01:15.413

您可以通过使用锯齿状数组`Type[][]`而不是`Type[,]`. 在这种情况下，您可以通过`array[index]`. 否则，您将不得不将二维数组与感兴趣的子数组的索引一起传递并在调用的方法中执行索引，或者创建感兴趣的子数组的副本。**

# c# - 在 VS2012 中无法将新的单游戏内容项目添加到解决方案中

> ID：14553270
> 
> 赞同：6
> 
> 时间：2013-01-27T22:52:32.277
> 
> 标签：c#, windows-7, visual-studio-2012, monogame

我正在尝试将新的 MonoGame 内容项目（通过安装在 MonoGame 3.0 安装程序中的模板）添加到 Visual Studio 2012（专业版）中的现有解决方案中，但它总是出现以下对话框：

![错误弹出窗口](../Images/57068cc89d73ef709a93f200590f4af7.png)

它确实在项目应该存在的地方创建了一些空文件夹，尽管它们中没有任何内容。在此弹出窗口之后，它还会出现：

![第二个错误弹出](../Images/b8eccd056be8d5d1faebb27028562d4a.png)

我没有安装 XNA，因为 VS2012 不支持它。

另外，我使用的是 Windows 7。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T16:26:17.507

如果我是你，我会阅读 Tara Walker 撰写的关于 Windows 8 游戏开发的三篇博客文章，从这篇文章开始：[概述、安装和 MonoGame 3.0。](http://blogs.msdn.com/b/tarawalker/archive/2012/12/04/windows-8-game-development-using-c-xna-and-monogame-3-0-building-a-shooter-game-walkthrough-part-1-overview-installation-monogame-3-0-project-creation.aspx)

第三篇博客文章讨论了在 Mono Game 之外创建内容管道（使用 XNA）并将其导入到 MonoGame 项目中。听起来你需要 XNA，所以你需要阅读她的信息并弄清楚如何让它在 VS2012 Express 中工作。

我在业余时间一直在涉足 MonoGame 项目，并且我能够在没有专门的内容项目的情况下加载一些纹理和精灵表；一切都只是添加到项目解决方案中，并在主类初始化期间创建。但我不知道这是否长期可行。

HTH。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-12-18T11:11:00.840

Mono Content Project 依赖于 XNA，因为 MONOGAME 仍在开发真正独立的 CONTENT MANAGER。所以现在我们必须安装 XNA。[从XNA zip](https://msxna.codeplex.com/releases/view/117230)下载它并解压缩内容，因为 XNA 不受 MS 官方支持。阅读随附的自述文件并按照说明进行安装。不要忘记将文件放入名为“XNA Game Studio 4.0 (2012).vsix”的 zip 文件夹中，它会安装 VS 的“XNA”模板。

现在尝试为您的内容创建一个子项目。你的问题应该解决！！

# python - 每个计数添加数字？

> ID：14553271
> 
> 赞同：0
> 
> 时间：2013-01-27T22:52:32.840
> 
> 标签：python

我想在 Python 上编写一个程序，每次计数增加 5 直到计数为 20，所以总数为 100。所以基本上我想用这种方式显示 5 * 20 的结果。

```
num = 5
count = 0
total = 0 
```

我试过这段代码，但它返回为零。为什么？

```
while(count == 20):
    total = num * count
    if(total == num * count):
        count = count + 1
print total 
```

请纠正我犯的任何错误。我是 Python 新手...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T22:54:13.493

## 你可能是说`while count <= 20:`

为 while 循环指定的条件是它*继续*运行所需的条件 - 而不是它何时结束。

`while`另请注意，和`if`条件不需要括号。

## 不过，您的代码也有一些奇怪的冗余。

例如：

```
total = num * count
if total == num * count:
    count = count + 1 
```

`if`鉴于您在上一行中将总计设置为您检查它所对照的同一事物，该声明将始终为真。换句话说，你可以写...

```
total = num * count
if True:
    count = count + 1 
```

甚至只是...

```
total = num * count
count = count + 1 
```

### 此外...

您在每次迭代中设置`total`equal `num * count`，但如果您的目标只是打印出`num * 20`，则不必数到 20 - 您可以从 20 开始。

```
num = 5
count = 20
print num * count 
```

### 还要注意...

这条线可以更简洁地说：

```
count = count + 1 
```

也可以写成...

```
count += 1 
```

## 最后...

如果你真正想要的是一个以 5 到 100 为增量的数字列表，你可以这样做：

```
>>> range(0, 101, 5)
[0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100] 
```

或这个：

```
>>> [n*5 for n in range(21)]
[0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100] 
```

# php - 使用php在工作时间显示电话号码

> ID：14553272
> 
> 赞同：-2
> 
> 时间：2013-01-27T22:52:35.307
> 
> 标签：php, image

我正在为我们的商业网站创建一个 joomla 模板。而且我只想在工作时间显示我们的电话号码。我们的电话号码是我用以下代码调用的图像。

`<div> <img src="templates/images/phone_number.gif" width="428" height="41" alt="" /> </div>`

有没有办法让我只在我们的营业时间内显示，周一上午 9 点至下午 5 点，东部时间周六？我在互联网上找到了一些代码可以在某些时间显示它，但没有设置为东部时间。

我无法弄清楚这一点，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T23:12:43.893

尝试这个：

```
$openTime = strtotime(date('Y-m-d').' 08:00:00'); // 8:00 am
$closeTime = strtotime(date('Y-m-d').' 17:00:00'); // 5:00 pm
$currTime = strtotime('now'); // Now

if (($openTime <= $currTime) && ($currTime <= $closeTime)) {
    echo "We're open! Show the phone number....";
} else {
    echo "Sorry, we're closed.";
} 
```

马特

# css - 如何防止 HTML 元素相互重叠或滑动？

> ID：14553273
> 
> 赞同：7
> 
> 时间：2013-01-27T22:52:47.987
> 
> 标签：css, layout, position

我正在尝试将页面布局为三列，我希望中间列随页面调整大小，但问题是如果页面非常窄，左列要么滑到中间列下方（如果我使用浮动定位列）或它重叠（如果我使用绝对定位）。一旦达到最小宽度并停止移动，我希望右栏“撞”到中间栏，此时页面应该开始显示水平滚动条。

以下是我对绝对定位的尝试：

```
h2 {
  margin-top: 0;
}

#leftside {
  position: absolute;
  left: 0;
  width: 200px;
}

#rightside {
  position: absolute;
  right: 0;
  width: 150px;
}

#content {
  min-width: 200px;
  margin: 0 150px 0 200px;
}
```

```
<div id="leftside">
  <ul>
    <li><a href="">Left Menu 1</a></li>
    <li><a href="">Left Menu 2</a></li>
  </ul>
</div>
<div id="rightside">
  <ul>
    <li><a href="">Right Item 1</a></li>
    <li><a href="">Right Item 2</a></li>
  </ul>
</div>
<div id="content">
  <h2>Content Title</h2>
  <p>Some paragraph.</p>
  <h2>Another title</h2>
  <p>Some other paragraph with total nonsense. Just plain old text stuffer that serves no purpose other than occupying some browser real-estate</p>
</div>
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T23:04:11.723

您应该能够使用包装器`div`以及`min-width`最终来做到这一点`overflow`，例如：http: [//jsfiddle.net/5zsyj/](http://jsfiddle.net/5zsyj/)

尝试重新调整窗口大小，如果列是`< 300px`，它将显示滚动条，而不是仅仅调整元素本身的大小，或者浮动在彼此之上。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-27T23:08:55.057

一个解决方案是将其添加到 CSS 中：

```
html {
min-width: 550px;
position: relative;
} 
```

演示：http: [//jsfiddle.net/4PH4B/](http://jsfiddle.net/4PH4B/)

基本思想是，当页面达到所有列宽度的总和时，它不应再缩小，而只显示滚动条。还有位置：相对；声明用于将第三列与 html 内容的右侧对齐，而不仅仅是窗口。

# c++ - 为什么要插入一个？（问号）就在地图条目之前？

> ID：14553279
> 
> 赞同：1
> 
> 时间：2013-01-27T22:53:27.887
> 
> 标签：c++, yaml, yaml-cpp

Yaml-cpp 似乎在我的地图条目之前插入了一个问号。这是结果：

```
baryons:
  nucleons:
    - proton:
        quarkContent: [u, u, d]
        charge: 1
    - antiproton:
        quarkContent: [au, au, ad]
        charge: -1
    - neutron:
        quarkContent: [d, d, u]
        charge: 0
    - antineutron:
        quarkContent: [ad, ad, au]
        charge: 0
? hyperons:
    - lambda:
        quarkContent: [u, d, s]
        charge: 0
    - antilambda:
        quarkContent: [au, ad, as]
        charge: 0 
```

如您所见，从超子开始，有一个问号。我尝试添加更多条目以查看会发生什么。它似乎在`?`和之间交替`:`。这很奇怪。

我尝试删除核子键和超子键的所有内容，我仍然得到这个

```
baryons:
  nucleons:
    - Hello
? hyperons:
    - Hello 
```

嗯。确实很奇怪。这是我的代码。原谅凌乱

```
#include "yaml-cpp/yaml.h"
#include <string>
#include <sstream>
#include <iostream>
#include <fstream>
#include <typeinfo>
using namespace YAML;

void addParticle(Emitter * e, std::string name, std::string qc1, std::string qc2, std::string qc3, int charge){
    *e << BeginMap << Key << name;
    *e << Value;
        *e << BeginMap;
        *e << Key << "quarkContent" << Value << Flow << BeginSeq << qc1 << qc2 << qc3 << EndSeq;
        *e << Key << "charge" << Value << charge;
        *e << EndMap;
    *e << EndMap;

    *e << BeginMap << Key << "anti" + name;
    *e << Value;
        *e << BeginMap;
        *e << Key << "quarkContent" << Value << Flow << BeginSeq << "a" + qc1 << "a" + qc2 << "a" + qc3 << EndSeq;
        *e << Key << "charge" << Value << charge * -1;
        *e << EndMap;
    *e << EndMap;
};

int main(){
    Emitter e;

    e << BeginMap;
    e << Key << "baryons";
    e << Value;

        e << BeginMap;
        e << Key << "nucleons";
        e << Value;
            e << BeginSeq;
            addParticle(&e, "proton", "u", "u", "d", 1);
            addParticle(&e, "neutron", "d", "d", "u", 0);
            e << EndSeq;
        e << EndMap;

        e << BeginMap;
        e << Key << "hyperons";
        e << Value;
            e << BeginSeq;
            addParticle(&e, "lambda", "u", "d", "s", 0);
            e << EndSeq;
        e << EndMap;

    e << EndMap;

    std::ofstream particlesYAML;
    particlesYAML.open("particles.yml");
    particlesYAML.write(e.c_str(), strlen(e.c_str()));
    particlesYAML.close();
    return 0;
}; 
```

在旁注中，我正在缩进以减少混乱。所以也原谅。

另外，我的 YAML 结构好吗？还是我应该修改一些不同的东西？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T23:24:19.797

当您真的想要一个具有两个键/值对的单个映射时，您正在编写两个连续的映射作为单个节点。具体来说（这是您的代码片段）：

```
 e << BeginMap;
    e << Key << "nucleons";
    e << Value;
        e << BeginSeq;
        addParticle(&e, "proton", "u", "u", "d", 1);
        addParticle(&e, "neutron", "d", "d", "u", 0);
        e << EndSeq;
    // you previously had a EndMap and BeginMap
    e << Key << "hyperons";
    e << Value;
        e << BeginSeq;
        addParticle(&e, "lambda", "u", "d", "s", 0);
        e << EndSeq;
    e << EndMap; 
```

yaml-cpp 之所以给你额外的`?`，而不是仅仅给出一个错误，是因为你实际上不需要提供`YAML::Key`or `YAML::Value`。您的代码如下所示：

```
e << YAML::BeginMap;
e << YAML::Key << "foo";  // specifies the key
e << YAML::Value;
e << YAML::BeginMap;      // specifies the value
// stuff
e << YAML::EndMap;
e << YAML::BeginMap;      // specifies a new key (the YAML::Key is implied)
// stuff
e << YAML::EndMap;
                          // no value is provided for that key
e << YAML::EndMap; 
```

所以你有一个包含两个键/值对的映射。第一个是您所期望的（键是`foo`，值是地图）。然而，对于第二个，*键*是一个映射并且没有提供值，所以它被解释为`null`. 由于键是一个映射，它必须是一个长格式的键，用那个 extra 指定`?`。

旁注：有一个`e.size()`可以为您提供输出字符串的长度，因此您无需使用`strlen`.

# python - 带有预告片值的嵌套 while 循环

> ID：14553281
> 
> 赞同：1
> 
> 时间：2013-01-27T22:53:43.870
> 
> 标签：python, loops, python-2.7, while-loop, nested-loops

我的程序的目的是成为一个虚拟的麦当劳收银员。我的程序的第一部分让收银员接受一个客户的订单。由于 while 循环，客户可以订购任意数量的商品。最后，它显示税款、小计和最终账单。以及用户支付的金额和他们的零钱。现在我需要我的程序来完成第一部分的所有工作，但我需要用户/收银员为尽可能多的排队客户执行此操作。我尝试将两个 while 循环嵌套在一起，但我做错了什么，我不知道是什么。有人能帮我吗？顺便说一句，第一部分工作 100%。

# 第一部分

```
num1 = 4.87
num2 = 5.03
num3 = 5.50
num4 = 9.45
num5 = 1.29
num6 = 2.19
num7 = 2.29
itemnum = 0
Subtotal = 0
tax = 0.0565
amtgiven = 0
change = 0
quantity = 0
foodprice = 0
Totalprice1 = 0
Totalprice2 = 0
Totalprice3 = 0
Totalprice4 = 0
Totalprice5 = 0
Totalprice6 = 0
Totalprice7 = 0
billtax = 0
finalbill = 0
change = 0

print "Welcome to Virtual McDonald's!"   "Would you like to order a food item"
print "Item:                     Meal/tem:                          Price:"
print "1                          Big Mac Meal                        4.87"
print "2                          Quarter Pounder Meal                5.03"
print "3                          Chicken Nuggets Meal (5 piece)      5.50"
print "4                          ChickenNuggets Meal (10 piece)      9.45"
print "5                          Apple Pie                           1.29"
print "6                          Large Drink                         2.19"
print "7                          Large Fries                         2.29"

itemnum = input("Enter the item you would like to purchase! ")
quantity = input("How many of this item do you want?")
while itemnum != -1:

    if itemnum == 1:
        foodprice = quantity * num1
        Totalprice1 = foodprice

    if itemnum == 2:
        foodprice = quantity * num2
        Totalprice2 = foodprice

    if itemnum == 3:
        foodprice = quantity * num3
        Totalprice3 = foodprice

    if itemnum == 4:
        foodprice == quantity * num4
        Totalprice4 = foodprice

    if itemnum == 5:
        foodprice = quantity * num5
        Totalprice5 = foodprice

    if itemnum == 6:
        foodprice == quantity * num6
        Totalprice6 = foodprice

    if itemnum == 7:
        foodprice = quantity * num7
        Totalprice7 = foodprice   

    subtotal = Totalprice1 + Totalprice2 + Totalprice3 + Totalprice4 + Totalprice5 + Totalprice6 + Totalprice7 
    billtax = subtotal * tax
    finalbill = subtotal + billtax
    itemnum = input("Enter the item you would like to purchase! ")
    quantity = input("How many of this item do you want?")

print "Your total bill without tax is... ", round(subtotal,2)
print "Your total tax is... ", round(billtax,2)
print "Your final bill is... ", round(finalbill,2)
amtgiven = input ("How much do you want to pay with?")
change = amtgiven - finalbill
print "Your change is... ", round(change,2) 
```

# 第二部分

```
num1 = 4.87
num2 = 5.03
num3 = 5.50
num4 = 9.45
num5 = 1.29
num6 = 2.19
num7 = 2.29
itemnum = 0
Subtotal = 0
tax = 0.0565
amtgiven = 0
change = 0
quantity = 0
foodprice = 0
Totalprice1 = 0
Totalprice2 = 0
Totalprice3 = 0
Totalprice4 = 0
Totalprice5 = 0
Totalprice6 = 0
Totalprice7 = 0
billtax = 0
finalbill = 0
change = 0
customer = 0

print "Welcome to Virtual McDonald's!"   "Would you like to order a food item"
print "Item:                     Meal/tem:                          Price:"
print "1                          Big Mac Meal                        4.87"
print "2                          Quarter Pounder Meal                5.03"
print "3                          Chicken Nuggets Meal (5 piece)      5.50"
print "4                          ChickenNuggets Meal (10 piece)      9.45"
print "5                          Apple Pie                           1.29"
print "6                          Large Drink                         2.19"
print "7                          Large Fries                         2.29"

customer = raw_input ("Would you like to order? (If not type No)")
while customer != "No":

    while itemnum != -1: 
        itemnum = input("Enter the item you would like to purchase! ")
        quantity = input("How many of this item do you want? ")

        if itemnum == 1:
            foodprice = quantity * num1
            Totalprice1 = Totalprice1 + foodprice

        if itemnum == 2:
            foodprice = quantity * num2
            Totalprice2 = Totalprice2 + foodprice

        if itemnum == 3:
            foodprice = quantity * num3
            Totalprice3 = Totalprice3 + foodprice

        if itemnum == 4:
            foodprice = quantity * num4
            Totalprice4 = Totalprice4 + foodprice

        if itemnum == 5:
            foodprice = quantity * num5
            Totalprice5 = Totalprice5 + foodprice

        if itemnum == 6:
            foodprice = quantity * num6
            Totalprice6 = Totalprice6 + foodprice

        if itemnum == 7:
            foodprice = quantity * num7
            Totalprice7 = Totalprice7 + foodprice

    itemnum = input("Enter the item you would like to purchase! ")
    quantity = input("How many of this item do you want? ")
    subtotal = Totalprice1 + Totalprice2 + Totalprice3 + Totalprice4 + Totalprice5 + Totalprice6 + Totalprice7 
    billtax = subtotal * tax
    finalbill = subtotal + billtax        
    print "Your total bill without tax is... ", round(subtotal,2)
    print "Your total tax is... ", round(billtax,2)
    print "Your final bill is... ", round(finalbill,2)
    amtgiven = input ("How much do you want to pay with? ")
    change = amtgiven - finalbill
    print "Your change is... ", round(change,2)
    customer = raw_input ("Would you like to order? (If not type No)") 
```

＃输出

当我运行第二个程序时，输出如下：

```
Welcome to Virtual McDonald's!Would you like to order a food item
Item:                     Meal/tem:                          Price:
1                          Big Mac Meal                        4.87
2                          Quarter Pounder Meal                5.03
3                          Chicken Nuggets Meal (5 piece)      5.50
4                          ChickenNuggets Meal (10 piece)      9.45
5                          Apple Pie                           1.29
6                          Large Drink                         2.19
7                          Large Fries                         2.29
Would you like to order? (If not type No) yes
Enter the item you would like to purchase! 1
How many of this item do you want? 2
Enter the item you would like to purchase! 1
How many of this item do you want? 4
Your total bill without tax is...  9.74
Your total tax is...  0.55
Your final bill is...  10.29
How much do you want to pay with? 11
Your change is...  0.71
Enter the item you would like to purchase! 
```

（在输入几个菜单项后，程序停止运行循环并直接进入账单。同样在账单之后，它不会询问用户他们是否是另一个客户。）

当我运行第一部分时，这是输出：

```
Welcome to Virtual McDonald's!Would you like to order a food item
Item:                     Meal/tem:                          Price:
1                          Big Mac Meal                        4.87
2                          Quarter Pounder Meal                5.03
3                          Chicken Nuggets Meal (5 piece)      5.50
4                          ChickenNuggets Meal (10 piece)      9.45
5                          Apple Pie                           1.29
6                          Large Drink                         2.19
7                          Large Fries                         2.29
Enter the item you would like to purchase! 1
How many of this item do you want?4
Enter the item you would like to purchase! 2
How many of this item do you want?1
Enter the item you would like to purchase! -1
How many of this item do you want?-1
Your total bill without tax is...  24.51
Your total tax is...  1.38
Your final bill is...  25.89
How much do you want to pay with? 26
Your change is...  0.11 
```

我希望第二部分输出第一部分输出的内容。除了给客户他/她的更改后，我希望它执行另一个循环，因此询问用户是否有另一个客户。如果用户输入“是”，那么程序将为另一个客户重新运行。只有当没有更多客户时，用户才输入“否”来结束程序。（我去了python shell，复制了这些输出结果。右边的数字是我输入的数字。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T02:30:40.947

好的，您的程序可以在语法和逻辑上解决一些问题。我继续修复它们，我会解释我做了什么以及为什么。首先，您需要另一个`while`循环以满足您对用户指定是否有其他客户排队的需要。我创建了一个新变量来处理新`while`循环。这是代码：

```
nextcustomer = "yes"    
while nextcustomer != "no":
    amtgiven = 0
    change = 0
    quantity = 0
    foodprice = 0
    totalprice = 0
    billtax = 0
    finalbill = 0
    itemnum = 0 
```

然而，在这个新循环中，我们需要添加一些变量，这些变量需要在每个客户之后重置。循环外的全局变量应该是不需要因客户而异的变量，即食品价格或税率。我们将需要添加更改和总价格以及这些东西，我在前面的代码中这样做了。

此外，在所有其他事情发生之后，是否会有另一个客户的问题将进入第一个 while 循环，以便它知道是否再次迭代。这个问题在这里：

```
while nextcustomer != "no":
    (all of the code)
    nextcustomer = raw_input("Is there another customer? (yes or no) ") 
```

我在第二个 while 循环中也添加了一些中断，否则它将继续迭代，而无法提示用户是否要订购。

我所做的另一项更改是将您的所有`Totalprice1, Totalprice2`...variables 合并到一个 variable`totalprice`中。您只需要一个变量，因为您已经在他们自己的变量中定义了价格（`num1, num2`...）。每个选择下的计数器变量的代码如下所示：

```
totalprice += foodprice 
```

这相当于`totalprice = totalprice + foodprice`。它只是更好的语法。现在你甚至不需要一个`subtotal`变量。

我还在`if`他们选择的数字问题之后添加了一条声明，如果他们输入 -1 会拾取，这样您就不必输入 -1 项目的数量：

```
if itemnum == -1:
    break 
```

我敢肯定还有一些更改，我可能会回来编辑它以确保一切都得到解释，但这是编辑后的完整程序代码：

```
num1 = 4.87
num2 = 5.03
num3 = 5.50
num4 = 9.45
num5 = 1.29
num6 = 2.19
num7 = 2.29
tax = 0.0565
customer = 0
nextcustomer = "yes"
while nextcustomer != "no":
    amtgiven = 0
    change = 0
    quantity = 0
    foodprice = 0
    totalprice = 0
    billtax = 0
    finalbill = 0
    itemnum = 0
    print "Welcome to Virtual McDonald's!"
    print "Item:                     Meal/item:                          Price:"
    print "1                          Big Mac Meal                        4.87"
    print "2                          Quarter Pounder Meal                5.03"
    print "3                          Chicken Nuggets Meal (5 piece)      5.50"
    print "4                          ChickenNuggets Meal (10 piece)      9.45"
    print "5                          Apple Pie                           1.29"
    print "6                          Large Drink                         2.19"
    print "7                          Large Fries                         2.29"

    customer = raw_input ("Would you like to order? (If not type no)")
    while customer != "no":

        while itemnum != -1: 
            itemnum = input("Enter the item you would like to purchase! ")
            if itemnum == -1:
                break
            quantity = input("How many of this item do you want? ")

            if itemnum == 1:
                foodprice = quantity * num1
                totalprice += foodprice

            elif itemnum == 2:
                foodprice = quantity * num2
                totalprice += foodprice

            elif itemnum == 3:
                foodprice = quantity * num3
                totalprice += foodprice

            elif itemnum == 4:
                foodprice = quantity * num4
                totalprice += foodprice

            elif itemnum == 5:
                foodprice = quantity * num5
                totalprice += foodprice

            elif itemnum == 6:
                foodprice = quantity * num6
                totalprice += foodprice

            elif itemnum == 7:
                foodprice = quantity * num7
                totalprice += foodprice

        billtax = totalprice * tax
        finalbill = totalprice + billtax        
        print "Your total bill without tax is... ", round(totalprice,2)
        print "Your total tax is... ", round(billtax,2)
        print "Your final bill is... ", round(finalbill,2)
        amtgiven = input("How much do you want to pay with? ")
        change = amtgiven - finalbill
        print "Your change is... ", round(change,2)
        break
    nextcustomer = raw_input("Is there another customer? (yes or no) ") 
```

这能解决你的问题吗？

# background - pygame，停止背景滚动

> ID：14553283
> 
> 赞同：2
> 
> 时间：2013-01-27T22:53:52.597
> 
> 标签：background, python-2.7, scroll, pygame

我想阻止屏幕背景图像随播放器移动，但我不知道该怎么做。下面是一个示例，当玩家移动时，背景图像也会随之移动。我只希望相机与玩家一起移动，而背景是静止的。任何人都可以帮忙吗？

**例子：**

![在此处输入图像描述](../Images/3db3bf594ddaceadc1a7426b08065265.png)

**代码：**

```
import pygame
from pygame import *

WIN_WIDTH = 800
WIN_HEIGHT = 640
HALF_WIDTH = int(WIN_WIDTH / 2)
HALF_HEIGHT = int(WIN_HEIGHT / 2)

DISPLAY = (WIN_WIDTH, WIN_HEIGHT)
DEPTH = 0
FLAGS = 0
CAMERA_SLACK = 30

def main():
    pygame.init()
    screen = pygame.display.set_mode(DISPLAY, FLAGS, DEPTH)
    pygame.display.set_caption("ABCDEFGHIJKLMNOPQRSTUVWXYZ")
    timer = pygame.time.Clock()

    up = left = right = False
    entities = pygame.sprite.Group()
    player = Player(32, 32)
    platforms = []

    x = 0
    y = 0
    level = [
        "PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP",
        "P                                          P",
        "P                                          P",
        "P                                          P",
        "P                                          P",
        "P                                          P",
        "P                                          P",
        "P                                          P",
        "P                                          P",
        "P                                          P",
        "P                                          P",
        "P                                          P",
        "P                                          P",
        "P                                          P",
        "P                                          P",
        "P                                          P",
        "P                           PPPP     PPPPPPP",
        "P                           PPPP     PPPPPPP",
        "P                           PPPP     PPPPPPP",
        "P              PPPPP        PPPP     PPPPPPP",
        "P                           PPPP     PPPPPPP",
        "P                           PPPP     PPPPPPP",
        "P                           PPPP     PPPPPPP",
        "P                           PPPP     PPPPPPP",
        "P                     PPPPPPPPPP     PPPPPPP",
        "P                           PPPP     PPPPPPP",
        "P      PPPP                 PPPP     PPPPPPP",
        "P                           PPPP     PPPPPPP",
        "P                           PPPP     PPPPPPP",
        "P                           PPPP     PPPPPPP",
        "PPPPP                       PPPP     PPPPPPP",
        "P                           PPPP     PPPPPPP",
        "P                           PPPP     PPPPPPP",
        "P                           PPPP     PPPPPPP",
        "P           PPPPP           PPPP     PPPPPPP",
        "P                                       PPPP",
        "P                                       PPPP",
        "P                                       PPPP",
        "P                         PPPPPPPPPPPPPPPPPP",
        "P                         PPPPPPPPPPPPPPPPPP",
        "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",
        "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",
        "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",
        "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",
        "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",
        "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",
        "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",
        "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",
        "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",
        "PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP",]

    total_level_width = len(level[0]) * 32
    total_level_height = len(level) * 32
    #print(total_level_width, total_level_height)
    background = pygame.image.load("Untitled.png")

    # build the level
    for row in level:
        for col in row:
            if col == "P":
                p = Platform(x, y)
                platforms.append(p)
                entities.add(p)
            if col == "E":
                e = ExitBlock(x, y)
                platforms.append(e)
                entities.add(e)
            x += 32
        y += 32
        x = 0

    camera = Camera(complex_camera, total_level_width, total_level_height)
    entities.add(player)

    while 1:
        timer.tick(60)

        for e in pygame.event.get():
            if e.type == QUIT: raise SystemExit, "QUIT"
            if e.type == KEYDOWN and e.key == K_ESCAPE:
                raise SystemExit, "ESCAPE"

            if e.type == KEYDOWN and e.key == K_UP:
                up = True
            if e.type == KEYDOWN and e.key == K_LEFT:
                left = True
            if e.type == KEYDOWN and e.key == K_RIGHT:
                right = True

            if e.type == KEYUP and e.key == K_UP:
                up = False
            if e.type == KEYUP and e.key == K_LEFT:
                left = False
            if e.type == KEYUP and e.key == K_RIGHT:
                right = False

        # draw background
        screen.blit(background, (0,0))

        #draw entities
        for e in entities:
            screen.blit(e.image, camera.apply(e))

        # update player, update camera, and refresh
        player.update(up, left, right, platforms)
        camera.update(player)
        pygame.display.flip()

class Camera(object):
    def __init__(self, camera_func, width, height):
        self.camera_func = camera_func
        self.state = Rect(0, 0, width, height)

    def apply(self, target):
        return target.rect.move(self.state.topleft)

    def update(self, target):
        self.state = self.camera_func(self.state, target.rect)

def complex_camera(camera, target_rect):
    l, t, _, _ = target_rect
    _, _, w, h = camera
    l, t, _, _ = -l + HALF_WIDTH, -t +HALF_HEIGHT, w, h

    l = min(0, l)                           # stop scrolling left
    l = max(-(camera.width - WIN_WIDTH), l)   # stop scrolling right
    t = max(-(camera.height-WIN_HEIGHT), t) # stop scrolling bottom

    return Rect(l, t, w, h)

class Entity(pygame.sprite.Sprite):
    def __init__(self):
        pygame.sprite.Sprite.__init__(self)

class Player(Entity):
    def __init__(self, x, y):
        Entity.__init__(self)
        self.xvel = 0
        self.yvel = 0
        self.onGround = False
        self.image = Surface((32,32))
        self.image.fill(Color("#0000FF"))
        self.image.convert()
        self.rect = Rect(200, 1200, 32, 32)

    def update(self, up, left, right, platforms):
        print(self.yvel)
        if up:
            if self.onGround:
                self.yvel = 0
                self.yvel -= 10 # only jump if on the ground
        if left:
            self.xvel = -8
        if right:
            self.xvel = 8
        if not self.onGround:
            self.yvel += 0.3 # only accelerate with gravity if in the air
            if self.yvel > 80: self.yvel = 80 # max falling speed
        if not(left or right):
            self.xvel = 0

        self.rect.left += self.xvel # increment in x direction
        self.collide(self.xvel, 0, platforms) # do x-axis collisions
        self.rect.top += self.yvel # increment in y direction
        self.onGround = False; # assuming we're in the air
        self.collide(0, self.yvel, platforms) # do y-axis collisions

    def collide(self, xvel, yvel, platforms):
        for p in platforms:
            if pygame.sprite.collide_rect(self, p):
                if isinstance(p, ExitBlock):
                    pygame.event.post(pygame.event.Event(QUIT))
                if xvel > 0: self.rect.right = p.rect.left
                if xvel < 0: self.rect.left = p.rect.right
                if yvel > 0:
                    self.rect.bottom = p.rect.top
                    self.onGround = True
                if yvel < 0:
                    self.rect.top = p.rect.bottom

class Platform(Entity):
    def __init__(self, x, y):
        Entity.__init__(self)
        self.image = Surface((32, 32))
        self.image.convert()
        self.image.fill(Color("#FFFFFF"))
        self.rect = Rect(x, y, 32, 32)

    def update(self):
        pass

class ExitBlock(Platform):
    def __init__(self, x, y):
        Platform.__init__(self, x, y)
        self.image = pygame.image.load("bush.png")

if __name__ == "__main__":
    main() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T07:53:51.967

> 我只希望相机与玩家一起移动，而背景是静止的。

反之亦然：背景已经静止。您希望它与相机一起移动。

所以而不是

```
screen.blit(background, (0,0)) 
```

利用

```
screen.blit(background, camera.apply((0,0))) 
```

并将您的相机类更改为此

```
class Camera(object):
    def __init__(self, camera_func, width, height):
        self.camera_func = camera_func
        self.state = Rect(0, 0, width, height)

    def apply(self, target):
        try:
            return target.rect.move(self.state.topleft)
        except AttributeError:
            return map(sum, zip(target, self.state.topleft))

    def update(self, target):
        self.state = self.camera_func(self.state, target.rect) 
```

允许将其应用于任意坐标，而不仅仅是`Sprite`s。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T23:02:41.180

问题是背景不滚动。由于相机已经这样做了，您只需要存储当前的偏移量，然后用它进行 blit，而不是`(0,0)`

注意使用[rect 的属性（文档）](http://www.pygame.org/docs/ref/rect.html)。替换这些：

```
l, t, _, _ = target_rect
_, _, w, h = camera 
```

和

```
l, t = target_rect.topleft
w, h = camera.size 
```

*像 HALFWIDTH 这样的东西可以使用这些属性来简化数学。 `topleft, bottomleft, topright, bottomright midtop, midleft, midbottom, midright center, centerx, centery`*ETC..

# c - 将 argv 字符串传递给 C 中的函数

> ID：14553284
> 
> 赞同：0
> 
> 时间：2013-01-27T22:54:07.153
> 
> 标签：c, string, function, argv

我知道有一篇关于这个的帖子，我试图通过它们，但它们似乎没有解决我的问题。我猜这是我忽略的一些简单的事情，但我发誓我没有看到它。

所以这里...

从主要

```
char *newstr = argv[3];
header(newstr); 
```

函数头

```
void header(char *read_file){ 
```

我得到“标题”的冲突类型，并警告：从不兼容的指针类型传递“标题”的参数 1。

我浏览了[该线程](https://stackoverflow.com/questions/1807530/difference-between-using-character-pointers-and-character-arrays)中的参考链接，似乎我正在遵循正确的路径来传递参数。我唯一的猜测是它与argv有关。

这也是我的参数，在这让我绊倒之前我一直在使用它们。

```
-q Imhere.txt b.txt dynArray.c b.txt 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T23:03:48.057

这对我来说编译得很好（使用 gcc 版本 4.2.1（基于 Apple Inc. build 5658）（LLVM build 2336.1.00））：

```
#include <stdio.h>

void header (char *read_file) {
    printf("%s\n", read_file);
}

int main(int argc, char* argv[]) {
    char *newstr = argv[3];
    header(newstr);
    return 0;
} 
```

输出：

```
$ ./a.out -q Imhere.txt b.txt dynArray.c b.txt
b.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T00:04:15.820

在您的编译选项之后，执行此操作 [gcc ........ 2> ERROR.TXT]

然后在此处发布这些错误，以便我们查看问题所在。

# java - FileInputStream 不适用于相对路径

> ID：14553292
> 
> 赞同：27
> 
> 时间：2013-01-27T22:55:27.237
> 
> 标签：java, filenotfoundexception, fileinputstream

我试图创建一个对象`FileInputStream`并将文件的相对值传递给它的构造函数，但它不能正常工作并抛出一个`FileNotFoundException`

```
try {
   InputStream is = new FileInputStream("/files/somefile.txt");
} catch (FileNotFoundException ex) {
   System.out.println("File not found !");
} 
```

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-01-27T23:01:52.450

`/`开头将使路径成为绝对路径而不是相对路径。

尝试删除前导`/`，所以替换：

```
InputStream is = new FileInputStream("/files/somefile.txt"); 
```

和：

```
InputStream is = new FileInputStream("files/somefile.txt"); 
```

如果您仍然遇到问题，请尝试通过[检查当前目录](https://stackoverflow.com/questions/4871051/getting-the-current-working-directory-in-java)来确保程序正在从您认为的位置运行：

```
System.out.println(System.getProperty("user.dir")); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-27T23:03:47.953

其他海报是正确的，您给出的路径不是相对路径。你可能会做类似的事情`this.getClass().getResourceAsStream("Path relative to the current class")`。这将允许您基于相对于您调用它的类的路径将文件作为流加载。

有关更多详细信息，请参阅 Java API：[http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getResourceAsStream(java.lang.String)](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getResourceAsStream(java.lang.String))

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-27T22:57:55.743

1.  这不是相对路径，而是绝对路径。
2.  如果您使用的是 Windows，则需要在路径前添加驱动器号：

`InputStream is = new FileInputStream("C:/files/somefile.txt");`

windows 不支持`/`符号为“root”

如果要加载将放入 JAR 的文件，则需要使用

```
getClass().getResource("path to your file"); 
```

或者

```
getClass().getResourceAsStream("path to your file"); 
```

# android - 显示时背景警报对话框不暗

> ID：14553294
> 
> 赞同：0
> 
> 时间：2013-01-27T22:55:37.433
> 
> 标签：android

我一直在谷歌搜索一些文章或其他东西来帮助解决我的问题，也许你们中的一个可以给我一些解决方案。我只想在显示并更改为浅蓝色时使警报对话框周围的颜色不暗。

```
AlertDialog.Builder alertbox = new AlertDialog.Builder(c);
                alertbox.setMessage(res.getString(R.string.proceed));
                alertbox.setPositiveButton(res.getString(R.string.yes),
                        new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface arg0,
                                    int arg1) {
                                finish();

                            }

                        });

                alertbox.show(); 
```

之前谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T23:19:03.630

尝试这个：

```
AlertDialog.Builder alertbox = new AlertDialog.Builder(
      new ContextThemeWrapper(c, android.R.style.Theme_Dialog)); 
```

我不知道您要使用的实际主题来代替 Theme_Dialog，只需尝试它们，直到找到您喜欢的主题。或者创建自己的主题。

# hadoop - hadoop 上的 FileNotFoundException

> ID：14553296
> 
> 赞同：0
> 
> 时间：2013-01-27T22:55:56.313
> 
> 标签：hadoop, mapreduce

在我的地图函数中，我试图从分布式缓存中读取一个文件，将其内容加载到哈希映射中。

MapReduce 作业的 sys 输出日志打印 hashmap 的内容。这表明它已找到文件，已加载到数据结构中并执行了所需的操作。它遍历列表并打印其内容。从而证明操作是成功的。

但是，在运行 MR 作业几分钟后，我仍然收到以下错误：

```
27 年 13 月 1 日 18:44:21 信息 mapred.JobClient：任务 ID：尝试_201301271841_0001_m_000001_2，状态：失败
java.io.FileNotFoundException：文件不存在：/app/hadoop/jobs/nw_single_pred_in/predict
    在 org.apache.hadoop.hdfs.DFSClient$DFSInputStream.openInfo(DFSClient.java:1843)
    在 org.apache.hadoop.hdfs.DFSClient$DFSInputStream.(DFSClient.java:1834)
    在 org.apache.hadoop.hdfs.DFSClient.open(DFSClient.java:578)
    在 org.apache.hadoop.hdfs.DistributedFileSystem.open(DistributedFileSystem.java:154)
    在 org.apache.hadoop.fs.FileSystem.open(FileSystem.java:427)
    在 org.apache.hadoop.mapreduce.lib.input.LineRecordReader.initialize(LineRecordReader.java:67)
    在 org.apache.hadoop.mapred.MapTask$NewTrackingRecordReader.initialize(MapTask.java:522)
    在 org.apache.hadoop.mapred.MapTask.runNewMapper(MapTask.java:763)
    在 org.apache.hadoop.mapred.MapTask.run(MapTask.java:370)
    在 org.apache.hadoop.mapred.Child$4.run(Child.java:255)
    在 java.security.AccessController.doPrivileged（本机方法）
    在 javax.security.auth.Subject.doAs(Subject.java:396)
    在 org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1121)
    在 org.apache.hadoop.mapred.Child.main(Child.java:249)

```

这是使用要放置在分布式缓存中的文件的位置初始化 Path 的部分

```
    // 在 main 内部，被 try catch 块包围，但这里没有抛出异常
        配置 conf = new Configuration();
        // 与 conf 相关的其他内容
        路径知识filepath = new Path(args[3]); // args[3] = /app/hadoop/jobs/nw_single_pred_in/predict/knowledge.txt
        DistributedCache.addCacheFile(knowledgefilepath.toUri(), conf);
        job.setJarByClass(NBprediction.class);
        // 其他作业设置
        作业.waitForCompletion(true); // 开始加载

```

这个在 map 函数里面：

```
    尝试 {
    System.out.println("里面试试！！");
    路径文件[]= DistributedCache.getLocalCacheFiles(context.getConfiguration());
    路径 cfile = new Path(files[0].toString()); // 只有一个文件
    System.out.println("文件路径："+cfile.toString());
    CSVReader reader = new CSVReader(new FileReader(cfile.toString()),'\t');
    而 ((nline=reader.readNext())!=null)
    data.put(nline[0],Double.parseDouble(nline[1])); // 加载到哈希图中
    }
    捕获（异常 e）
    {// 处理异常 }

```

帮助表示赞赏。

干杯！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T15:22:32.107

做了一个全新的hadoop安装并用同一个jar运行了这个工作，问题就消失了。似乎是一个错误而不是编程错误。

# javascript - 刷新后如何选择相同的div

> ID：14553303
> 
> 赞同：1
> 
> 时间：2013-01-27T22:56:44.647
> 
> 标签：javascript, jquery, css, ajax

如果我有 5 个这样的 div：

```
<div id="container">
   <div class="selected"></div>
   <div></div>
   <div></div>
   <div></div>
   <div></div>
</div> 
```

选中的 div 可以通过单击另一个来更改。现在，如果我使用 ajax 调用刷新容器的内容，我想保持选中 div。我如何实现这一目标？

我知道我可以使用以下方法获取选定的 div：

```
var selectedDiv = $('.selected'); 
```

但是我如何使用它再次选择它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T23:00:46.840

在执行 Ajax 调用之前，获取选定对象的索引`div`并将其存储在变量中：

```
var selected_index = $('#container div.selected').index(); 
```

然后，在更新内容后，使用索引选择正确的 div：

```
$('#container div').eq(selected_index).addClass('selected'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T23:01:21.573

编辑：似乎在我做之前几秒钟就发布了相同的答案，哈哈

选择的变量

```
 $('div').click(function(){
    selected = $("#selected").index()+1;
    }) 
```

然后选择元素

```
var element = '.div-class:nth-child('+selected+')';
$(element) 
```

* * *

当用户选择一个 div 时执行此操作

选择的变量

```
$('div').click(function(){
selected = $("#selected").index();
}) 
```

然后使用再次选择元素`.eq(selected)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T23:02:26.043

更新您的变量以存储 div 的索引。

```
var selectedDiv = $('#container div').index($('.selected')); 
```

然后在您的 ajax 调用的成功函数中将类设置为先前选择的 div。

```
success: function(){
  $('#container div:eq(selectedDiv)').addClass('selected');
} 
```

# java - 我如何知道另一个课程何时更新？

> ID：14553304
> 
> 赞同：3
> 
> 时间：2013-01-27T22:56:49.427
> 
> 标签：java, swing, actionlistener

我正在编写一个 Java 程序，它显示一个从属性文件中获取信息的组合框。有一个设置类允许用户更新组合框中的字段名称。我的问题是当调用和修改设置类时，我无法弄清楚如何使用新设置更新组合框。我有一种方法可以重新绘制整个面板并重新加载组合框。但是我不知道在设置类中按下“应用”按钮时如何激活该方法。

这是我想要完成的一个粗略而艰难的例子。

主类：

```
package testing;

import java.awt.*;
import java.awt.event.*;
import java.io.*;
import java.util.Properties;

import javax.swing.*;

public class testConfigLoad extends JFrame
{
    JButton apply = new JButton("Apply");
JButton set   = new JButton("Settings");

    Properties          config      = new Properties();
    FileInputStream     fis         = null;
    FileOutputStream    fos         = null;
    final String        configFile  = "config.properties";

    OptPanel opt;

    public testConfigLoad() throws IOException
    {
        super("Test Program");
        setSize(200, 200);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setLayout(new FlowLayout());

        config();
        opt = new OptPanel(config);
        buildFrame();
    }

    public void buildFrame()
    {
        set.addActionListener(new setListener());

        add(opt);
        add(apply);
        add(set);

        setVisible(true);
    }

    public void config() throws IOException
    {
        try
        {
            fis = new FileInputStream(configFile);
            config.load(fis);
        }
        catch (FileNotFoundException e)
        {
            System.out.println("File not found");
        }
        finally
        {
            if (fis != null)
            {
                fis.close();
            }
        }       
    }

    private class setListener implements ActionListener
    {
        public void actionPerformed(ActionEvent e)
        {
            settings set = new settings(config);
        }
    }

    public static void main(String[] args) throws IOException
    {
        new testConfigLoad();
    }
} 
```

需要刷新的面板：

```
package testing;

import java.util.Properties;
import javax.swing.*;

public class OptPanel extends JPanel
{
    String[] opts;
    JLabel optLabel = new JLabel("Available Options");
    Properties config;

    public OptPanel(Properties p)
    {
        config = p;
        opts = new String[3];
        buildPanel();
    }

    public void buildPanel()
    {
        for (int i = 0; i < opts.length; i++)
        {
            opts[i] = config.getProperty("option." + i + ".name");
        }

        JComboBox optBox = new JComboBox(opts);

        add(optLabel);
        add(optBox);
    }

    public void refPanel()
    {
        removeAll();
        this.buildPanel();
        ((JPanel) this).revalidate();
        repaint();
    }
} 
```

和设置类：

```
package testing;

import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.FileOutputStream;
import java.io.IOException;
import java.util.Properties;
import javax.swing.*;

public class settings 
{
    Properties config;
    final String        configFile  = "config.properties";

    JFrame setFrame = new JFrame("Settings");
    JLabel opt1 = new JLabel("Option 1");
    JLabel opt2 = new JLabel("Option 2");
    JLabel opt3 = new JLabel("Option 3");
    JTextField text1 = new JTextField(15);
    JTextField text2 = new JTextField(15);
    JTextField text3 = new JTextField(15);
    JButton apply = new JButton("Apply");

    public settings(Properties p)
    {
        config = p;
        setFrame.setSize(275, 200);
        setFrame.setDefaultCloseOperation(JFrame.HIDE_ON_CLOSE);
        setFrame.setLayout(new FlowLayout());

        buildSetFrame();
    }

    public void buildSetFrame()
    {
        text1.setText(config.getProperty("option.0.name"));
        text2.setText(config.getProperty("option.1.name"));
        text3.setText(config.getProperty("option.2.name"));

        apply.addActionListener(new applyListener());

        setFrame.add(opt1);
        setFrame.add(text1);
        setFrame.add(opt2);
        setFrame.add(text2);
        setFrame.add(opt3);
        setFrame.add(text3);
        setFrame.add(apply);

        setFrame.setVisible(true);
    }

    private class applyListener implements ActionListener
    {
        public void actionPerformed(ActionEvent e) 
        {
            config.setProperty("option.0.name", text1.getText());
            config.setProperty("option.1.name", text2.getText());
            config.setProperty("option.2.name", text3.getText());

            FileOutputStream fos = null;
            try
            {
                fos = new FileOutputStream(configFile);
                config.store(fos, null);
            }
            catch (IOException f)
            {
                System.out.println("Error");
            }
            finally
            {
                if (fos != null)
                {
                    try
                    {
                        fos.close();
                    }
                    catch (IOException g)
                    {
                        System.out.println("Problem");
                    }
                }
            }
            setFrame.setVisible(false);

            //  This is where I need to pass something back to the 
                    //  testConfigLoad class to tell it to 
            //  run the refPanel method in the OptPanel class.
        }
    }
} 
```

配置文件名为 config.properties，如下所示：

```
option.2.name=two
option.1.name=one
option.0.name=zero 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T23:35:07.013

一种方法是在`OptPanel`和`settings`类之间使用回调。您可以提取将元素添加到属性的功能`JComboBox`到它自己的方法中：

```
public void updateProperties(Properties p) {
    model.removeAllElements();
    for (String s: p.stringPropertyNames()) {
        model.addElement(p.getProperty(s));
    }
} 
```

哪里`model`是`DefaultComboBoxModel`。然后你可以简单地打电话

```
optPanel.updateProperties(config); 
```

成功存储属性后。

* * *

*几点：*

*   首选方法是不使用多个`JFrames`. `JFrame`一种选择是使用带有模态对话框的单个。请参阅此[讨论](https://stackoverflow.com/questions/9554636/the-use-of-multiple-jframes-good-bad-practice)。
*   不要扩展 JFrame，而是直接使用实例。
*   Java[命名约定](http://www.oracle.com/technetwork/java/codeconv-138413.html)表明类名以大写字母开头，因此`settings`将变为`Settings`

# ruby - 单行更改多个字符串，大写，小写等？

> ID：14553305
> 
> 赞同：1
> 
> 时间：2013-01-27T22:56:51.370
> 
> 标签：ruby, string, variables

嘿第一天编码 ruby​​，我想知道是否有任何方法可以在一行中更改多个变量。

```
first_name = "JOHN"
last_name = "DOE"
[first_name, last_name] = [first_name, last_name].downcase

Output : john doe 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T23:00:54.527

要更改值，请使用[map](http://ruby-doc.org/core-1.9.3/Array.html#method-i-map)：

```
first_name = "JOHN"
last_name = "DOE"
first_name, last_name = [first_name, last_name].map &:downcase

p first_name # => john 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-27T22:59:47.347

一种解决方案可能是使用该方法的`!`版本`downcase`

```
[first_name, last_name].each {|str| str.downcase!} 
```

也可以写成：

```
[first_name, last_name].each(&:downcase!) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-28T10:18:12.840

您也可以使用“收集”。

```
[first_name, last_name].collect(&:downcase) 
```

返回

```
=> ["john", "doe"] 
```

如果您想将它们作为全名连接在一起，您可以使用“join”。

```
[first_name, last_name].collect(&:downcase).join(' ') 
```

返回

```
=> "john doe" 
```

# sql-server - 收到错误“传递给 LEFT 或 SUBSTRING 函数的长度参数无效。”

> ID：14553309
> 
> 赞同：1
> 
> 时间：2013-01-27T22:57:32.250
> 
> 标签：sql-server, tsql, syntax-error, substring, error-log

我正在尝试从我们的 SQL 日志文件中提取登录成功和失败。这是我能够开始工作的声明，现在运行它时出现错误。任何帮助将不胜感激。我知道它在最后一条语句中，因为其余的在独立运行时可以正常工作。系统没有任何变化，所以我不明白为什么它会开始给出错误？

```
CREATE TABLE [dbo].[#TmpErrorLog]
([LogDate] DATETIME NULL,
[ProcessInfo] VARCHAR(20) NULL,
[Text] VARCHAR(MAX) NULL);

CREATE TABLE [dbo].[#TmpErrorLog2]
([LogDate] DATETIME NULL,
[ProcessInfo] VARCHAR(20) NULL,
[Text] VARCHAR(MAX) NULL,
[LoginAttempt] VARCHAR(20) NULL);

INSERT INTO #TmpErrorLog ([LogDate], [ProcessInfo], [Text])   
EXEC [master].[dbo].[xp_readerrorlog] 0 ;

INSERT INTO #TmpErrorLog2 ([LogDate], [ProcessInfo], [Text], [LoginAttempt])
Select LogDate, ProcessInfo, Replace(Text,'''','"') as Text, SUBSTRING(Text,0,16)      as     LoginAttempt
From #TmpErrorLog
Where LogDate > GETDATE() - 1 and Text like '%\%'

INSERT INTO LogData ([LogDate], [LoginAttempt], [LoginUser])
Select 
LogDate, 
Case LoginAttempt When 'Login succeeded' Then 'Successfull' Else 'Failed' End as      LoginAttempt,
SUBSTRING(SUBSTRING(Text, CHARINDEX('"', Text,1), CHARINDEX('"', Text, CHARINDEX('"',     Text, 0)) - 4),2,50) as LoginUser
From #TmpErrorLog2
Where LogDate Not In(Select LogDate From LogData)

Drop Table #TmpErrorLog
Drop Table #TmpErrorLog2 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T22:59:11.180

IIRC，CHARINDEX 可以返回 -1，这不是 SUBSTRING 的有效参数。我猜你在你的 CHARINDEXes 上得到了一些非命中。

# node.js - 如何在 stunnel 后面的 node.js/connect 应用程序中设置 req.connection.proxySecure

> ID：14553310
> 
> 赞同：1
> 
> 时间：2013-01-27T22:57:53.110
> 
> 标签：node.js, stunnel, node.js-connect

我们有一个 node.js/express 应用程序位于 stunnel 后面，用于 ssl 终止。我无法弄清楚如何强制使用安全会话 cookie。查看会话中间件源：

```
 // only send secure session cookies when there is a secure connection.
    // proxySecure is a custom attribute to allow for a reverse proxy
    // to handle SSL connections and to communicate to connect over HTTP that
    // the incoming connection is secure.
    var secured = cookie.secure && (req.connection.encrypted || req.connection.proxySecure);
    if (secured || !cookie.secure) {
      res.setHeader('Set-Cookie', cookie.serialize(key, req.sessionID));
    } 
```

我显然必须将 req.connection.proxySecure 设置为 true，但我不知道该怎么做。似乎 stunnel 应该“通过 HTTP”进行通信，但 stunnel 无法设置标头。所以我很茫然。我应该尝试在会话中间件之前通过自定义中间件在本地设置它，还是在某处的连接配置变量中设置它？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T20:13:40.870

确保代理正在设置`X-Forwarded-Proto: https`标头。然后，您必须将`proxy:true`配置参数添加到会话中间件。

# android - Android：在 ListAdapter 中设置 TextView 的可见性

> ID：14553312
> 
> 赞同：1
> 
> 时间：2013-01-27T22:58:20.517
> 
> 标签：android, android-listview

我有一个包含两个 ListView 的布局（见下图），它们都是使用两个 SimpleAdapter 创建的；让我们将 QLocations ListView 顶部的 ListView 称为 AllLocations ListView 底部的 ListView。

我想从我的 AllLocations ListView 中隐藏所有红色的 TextView 元素。我无法弄清楚如何仅将 TextViews 与 AllLocations ListView 隔离，而不是与 QLocations ListView 隔离。

所以，我的问题是，**如何隐藏特定 ListView 中的所有 TextView 元素？**

![在此处输入图像描述](../Images/0d36ca06eb1c206d492c71589cbb7bb0.png)

这是我的代码：

**创建列表视图**

```
 // Getting qListView: List View for locations with Qs
    qLV = (ListView) activity.findViewById(R.id.qListView);

    // list adapter
    ListAdapter qAdapter = new SimpleAdapter(activity, qListItems,
            R.layout.google_places_item,
            new String[] { KEY_REFERENCE, KEY_NAME}, new int[] {
                    R.id.reference, R.id.name });

    // Adding data into listview
    qLV.setAdapter(qAdapter);

    // Getting allListView: List View for locations without Qs
    allLV = (ListView) activity.findViewById(R.id.allListView);

    // list adapter
    ListAdapter allAdapter = new SimpleAdapter(activity, placesListItems,
            R.layout.google_places_item,
            new String[] { KEY_REFERENCE, KEY_NAME}, new int[] {
                    R.id.reference, R.id.name });

    // Adding data into listview
    allLV.setAdapter(allAdapter); 
```

**google_places_item.xml**

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <TextView android:id="@+id/reference"
        android:visibility="gone"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"/>

    <!-- Row for each location -->
    <LinearLayout 
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:id="@+id/qLocationRow"
        android:orientation="horizontal"
        >

    <!-- Q Name -->
    <TextView android:id="@+id/name"
        style="@style/qName"
    />

    <!-- Q WaitTime -->
    <TextView android:id="@+id/qName.qWaitTime"
        style="@style/qName.qWaitTime"
        android:text="14"
        />

    </LinearLayout>
</LinearLayout> 
```

**活动布局**

```
<?xml version="1.0" encoding="utf-8"?>

<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
     style="@style/fullWidth"> 

    <!--  Label for List View of QLocations -->

    <TextView
        android:id="@+id/qListLabel"
        style="@style/widthMargins.Label"
        android:text="@string/qListLabel" />

    <!-- Horizontal Rule -->

    <View
        android:id="@+id/horizontalRule1"
        style="@style/widthMargins.horizontalRule"
        android:layout_below="@+id/qListLabel"
         />

    <!-- Linear Layout containing progress bar + text description -->
    <LinearLayout
        android:layout_width="200dp"
        android:layout_height="60dp"
        android:id="@+id/lin_progressBar"
        android:visibility="visible"
        android:layout_centerHorizontal="true"
        android:layout_below="@id/horizontalRule1"
        android:layout_marginTop="10dp"
        android:orientation="horizontal">

        <ProgressBar
            android:id="@+id/loadPlacesProgress"
            style="?android:attr/progressBarStyleLarge"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            />
        <TextView 
            android:id="@+id/loadPlacesText"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:layout_marginLeft="5dp"
            android:text="Loading..."       
            android:gravity="center_vertical"
            android:textSize="15sp"    
            />

        </LinearLayout>

    <!-- ListView for Q Locations -->    
        <ListView
            android:id="@+id/qListView"
            style="@style/widthMargins"
            android:layout_height="140dp"
            android:layout_below="@+id/horizontalRule1" />

    <!--  Label for List View of All Locations -->

    <TextView
        android:id="@+id/allListLabel"
        style="@style/widthMargins.Label"
        android:layout_below="@+id/qListView"
        android:text="@string/allListLabel" />

    <!-- Horizontal Rule -->

    <View
        android:id="@+id/horizontalRule2"
        style="@style/widthMargins.horizontalRule"
        android:layout_below="@+id/allListLabel"
         />

        <!-- Linear Layout containing progress bar + text description -->
        <LinearLayout
            android:layout_width="200dp"
            android:layout_height="60dp"
            android:id="@+id/lin_progressBar2"
            android:visibility="visible"
            android:layout_centerHorizontal="true"
            android:layout_below="@id/horizontalRule2"
            android:layout_marginTop="10dp"
            android:orientation="horizontal">

        <ProgressBar
            android:id="@+id/loadPlacesProgress2"
            style="?android:attr/progressBarStyleLarge"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            />
        <TextView 
            android:id="@+id/loadPlacesText2"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:layout_marginLeft="5dp"
            android:text="Loading..."       
            android:gravity="center_vertical"
            android:textSize="15sp"    
            />

        </LinearLayout>

    <!-- ListView for All Locations -->    

        <ListView
            android:id="@+id/allListView"
            style="@style/widthMargins"
            android:layout_height="140dp"
            android:layout_below="@+id/horizontalRule2"
            />

    <!-- Show on Map button -->
    <Button android:id="@+id/btn_show_map"
        style="@style/fullWidth"
        android:layout_centerHorizontal="true"
        android:text="Map"
        android:padding="20dp"
        android:layout_alignParentBottom="true"
        android:layout_marginTop="10dip"/>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T01:58:28.703

因此，在您设置适配器后，您应该能够运行下面的代码以提供所需的效果。我不确定它的效率如何，但至少应该可以完成工作。

```
 int numChildren = allLV.getListView().getChildCount();
    for(int i = 0; i < numChildren; i++)
    {
        LinearLayout ll = (LinearLayout) allLV.getListView().getChildAt(i);
        TextView tv = (TextView) ll.findViewById(R.id.qName.qWaitTime);
        tv.setVisibility(View.INVISIBLE);
    } 
```

然后当你想显示红色框的文本时，使用类似的方法将它们再次设置为可见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T23:12:44.743

首先要知道您的列表视图项目和数据之间没有一对一的映射。如果您有许多项目，则在您浏览列表时视图会被重用。

首先，您要更新适配器中的所有项目以具有正确的值。一旦你更新了数据。然后通知适配器它的数据已经改变，它会重建自己`adapter.notifyDataSetChanged()`。通过适当缓存数据来快速重建列表。

您可以阅读 MVC（模型-视图-控制器）以更好地了解这里发生的事情。

# c++ - `delete[] obj` 和 `delete obj` 如何在编译器级别实现

> ID：14553313
> 
> 赞同：4
> 
> 时间：2013-01-27T22:58:29.597
> 
> 标签：c++, memory-management

> **可能重复：**
> [为什么在 delete ( delete [] ) 中使用 [] 来释放动态分配的数组？](https://stackoverflow.com/questions/1913853/why-is-used-in-delete-delete-to-free-dynamically-allocated-array)
> [为什么 C++ 仍然有一个 delete[] AND 一个删除运算符？](https://stackoverflow.com/questions/10999985/why-does-c-still-have-a-delete-and-a-delete-operator)

我想知道它们有什么区别，我知道有些人可能会说的明显答案，一个是删除数组，另一个是删除单个对象，但我想知道为什么这两个操作应该有两种不同的删除方法? 我的意思是删除基本上是使用 C`free`方法实现的，它不关心指针实际上是指向数组还是单个对象。我能想到的唯一原因是两个能够知道它是否是一个数组并为每个单元格调用析构函数，而不仅仅是第一个对象，但这也是不可能的，因为编译器无法猜测数组的长度只是看着它指针。顺便说一句，虽然据说调用未定义的行为来调用`delete`分配的内存`new[]`我可以'

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T23:06:44.233

正如您所发现的，编译器需要知道数组的长度（至少对于非平凡类型）才能为每个元素调用析构函数。对于这个 new[] 通常分配一些额外的字节来记录元素计数并返回一个指向这个簿记区域末尾的指针。

当您使用 delete[] 时，编译器将查看数组之前的内存以找到计数并调整指针，以便释放最初分配的块。

如果您用于`delete`销毁动态分配的数组，则不会调用元素（第一个除外）的析构函数，通常这将最终尝试释放不指向已分配块开头的指针，这可能会损坏堆。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T23:01:16.920

> 但这也是不可能的，因为编译器不能仅仅看它的指针就猜出数组的长度

这不是真的。编译器本身不需要猜测任何东西，但它会根据它看到的运算符决定调用哪个函数来释放内存。有一个单独的函数专门用于释放数组，并且该函数确实知道要释放的数组的长度，因此它可以适当地调用析构函数。

它知道数组的长度，因为通常`new[]`分配的内存包括数组长度（因为这在分配时是已知的）并返回一个指向仅分配的“可用”内存的指针。当`delete[]`被调用时，它知道如何根据指向给定数组可用部分的指针来访问该内存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T23:01:31.573

当您使用 分配内存`new[]`时，编译器不仅需要构造每个元素，还需要跟踪已分配的元素数量。`delete[]`这是正常工作所必需的。

由于`new`和`delete`对标量进行操作，因此它们不需要这样做，并且可以节省一点开销。

绝对不需要`new`兼容，`delete[]`反之亦然。将两者混合是未定义的行为。

# javascript - 访问角度模板元素

> ID：14553321
> 
> 赞同：1
> 
> 时间：2013-01-27T22:59:10.687
> 
> 标签：javascript, angularjs

我想知道访问主 html 模板元素的正确角度方式是什么。我可以使用 getelementbyid 也可以使用 attr.$$element[0] 访问它，但想知道是否有更清洁的方法。在下面的示例中，我想要 getElementById 行的等效项。

```
var app = angular.module('test', []);
app.directive('test', function(){
  return {
    restrict: 'E',
    template: '<canvas id="test-canvas"></canvas>',
    replace: true,
    link: function(scope, elem, attr) {
      // what is angular way of doing this?
      var canvas = initCanvas(document.getElementById("test-canvas")),
      // this works - is this recommended method?
      var canvas = attr.$$element[0];

    }
  };
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-06-13T17:03:09.407

你应该`elem`像这样使用参数：

```
var canvas = elem; 
```

`jqLite (jQuery)`正如评论中提到的，它是一个包装元素。

或者

```
var canvas = elem[0]; 
```

获取原始元素。

如果你想访问子元素并用它们做一些事情，你应该使用`angular.element`. Angular 使用`jqLite`，它提供了有限的`jQuery`方法。您可以在此处进一步阅读：[Angular 的 jqLit​​e](https://docs.angularjs.org/api/ng/function/angular.element)。例如，`jqLite`您`find()`只能与标签名称选择器一起使用，因此如果您想通过 id 选择子项，您应该使用以下内容：

```
angular.element(elem[0].querySelector('#your_child')).bind('click', () => {
  elem.toggleClass('some_class');
} 
```

如果您使用的是 jQuery，则可以使用`find()`，那么代码将如下所示：

```
elem.find('#your_child').click(() => {
    elem.toggleClass('some_class');
}); 
```

试试看`console.log(elem)`你会知道它是什么。希望这可以帮助！

PS：假设您要从`ng-repeat`指令中选择子元素。以前的解决方案将不起作用，因为这些元素还不存在。您需要做的就是`$timeout`像这样添加：

```
function yourDirective($timeout) {
  return {
    ...
    link: function (scope, elem, attrs) {
      $timeout(() => {
        angular.element(elem[0].querySelectorAll('.your_child')).bind('click', () => {
          // Do something
        }
      });
    }
  }
}

angular
  .module('yourApp')
  .directive('yourDirective', yourDirective); 
```

# xcode - Xcode tableview如何在每个部分中选择一行

> ID：14553323
> 
> 赞同：13
> 
> 时间：2013-01-27T22:59:12.793
> 
> 标签：xcode, tableview

我有一个包含 2 个部分的表格视图。我希望每个部分只选择一行。现在我可以选择一行，但它适用于整个表格。最终，我希望选择 2 行，但每个 SECTION 只能选择 1 行。我已经坚持了好几天了，无法弄清楚。这可能吗？？我是 Xcode 的新手，所以非常感谢任何帮助。提前致谢！

这是我的代码：

```
//  OptionsViewController.h

#import <UIKit/UIKit.h>

@interface OptionsViewController : UIViewController <UITableViewDataSource, UITableViewDelegate>
{
    NSArray *themeDataArray;
    NSArray *levelDataArray;
    NSIndexPath *selectedRowIndex;
}

@property (weak, nonatomic) NSArray *themeDataArray;
@property (weak, nonatomic) NSArray *levelDataArray;
@property (weak, nonatomic) NSIndexPath *selectedRowIndex;
@property (weak, nonatomic) IBOutlet UITableView *tableView;

@end

//  OptionsViewController.m

#import "OptionsViewController.h"
@interface OptionsViewController ()
@end

@implementation OptionsViewController

- (void)viewDidLoad
{
    themeDataArray = [[NSArray alloc] initWithObjects:@"Classic",@"Animals",@"Dinosaurs",@"Cars", nil];
    levelDataArray = [[NSArray alloc] initWithObjects:@"Easy",@"Medium",@"Hard", nil];

    //set default rows on startup
    NSIndexPath *indexPath=[NSIndexPath indexPathForRow:0 inSection:0];
    [self.tableView selectRowAtIndexPath:indexPath animated:YES  scrollPosition:UITableViewScrollPositionTop];

    NSIndexPath *indexPath2=[NSIndexPath indexPathForRow:0 inSection:1];
    [self.tableView selectRowAtIndexPath:indexPath2 animated:YES  scrollPosition:UITableViewScrollPositionNone];

    [super viewDidLoad];
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    return 2;
}

- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection (NSInteger)section
{
    //For each section, return header label
    if(section == 0) return @"Themes";
    if(section == 1) return @"Difficulty Level";
    return nil;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    //For each section, return number of rows in section
    if(section == 0) return [themeDataArray count];
    if(section == 1) return [levelDataArray count];
    return 0;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell1 = nil;

    //recycles cells to save memory
    cell1 = [tableView dequeueReusableCellWithIdentifier:@"cell1"];

    if (cell1 == nil)
    {
        cell1 = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"cell1"];
    }

    cell1.textLabel.text=[themeDataArray objectAtIndex:indexPath.row];
    return cell1;
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    [tableView reloadData];
    switch (indexPath.section)
    {
        case 0:
        {
            if (self.selectedRowIndex)
            {
                UITableViewCell *deselectCell = [tableView cellForRowAtIndexPath:self.selectedRowIndex];
                deselectCell.highlighted = FALSE;
                [tableView reloadData];
            }

            //select new row and assign new indexPath
            UITableViewCell *newCell = [tableView cellForRowAtIndexPath:indexPath];
            newCell.highlighted = TRUE;

            self.selectedRowIndex = indexPath;
            break;
        }
        case 1:
        {
            if (self.selectedRowIndex)
            {
                UITableViewCell *deselectCell = [tableView cellForRowAtIndexPath:self.selectedRowIndex];
                deselectCell.highlighted = FALSE;
            }

            //select new row and assign new indexPath
            UITableViewCell *newCell = [tableView cellForRowAtIndexPath:indexPath];
            newCell.highlighted = TRUE;

            self.selectedRowIndex = indexPath;
            break;
        }
        default:
            break;
    }
}

@end 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-01-27T23:15:27.913

那么，您希望在每个部分中一次选择不超过 1 行吗？然后一个解决方案是，每当用户触摸一行时，取消选择同一部分中的任何选定行。

```
- (NSIndexPath*)tableView:(UITableView *)tableView willSelectRowAtIndexPath:(NSIndexPath*)indexPath {
    for ( NSIndexPath* selectedIndexPath in tableView.indexPathsForSelectedRows ) {
        if ( selectedIndexPath.section == indexPath.section )
            [tableView deselectRowAtIndexPath:selectedIndexPath animated:NO] ;
    }
    return indexPath ;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-07-24T23:47:29.067

[这是上面John Sauer](https://stackoverflow.com/users/1523962/john-sauer)答案的 Swift 3 等价物（以防其他人像我一样偶然发现这个问题）：

```
func tableView(_ tableView: UITableView, willSelectRowAt indexPath: IndexPath) -> IndexPath? {
    if let selectedIndexPaths = tableView.indexPathsForSelectedRows {
        for selectedIndexPath in selectedIndexPaths {
            if selectedIndexPath.section == indexPath.section {
                tableView.deselectRow(at: selectedIndexPath, animated: true)
            }
        }
    }
    return indexPath
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-10-13T09:03:42.313

我认为这是上面答案的更多 Swifty 风格的代码。

```
func tableView(_ tableView: UITableView, willSelectRowAt indexPath: IndexPath) -> IndexPath? {
    tableView.indexPathsForSelectedRows?
        .filter { $0.section == indexPath.section }
        .forEach { tableView.deselectRow(at: $0, animated: true) }
    return indexPath
} 
```

# python - 如何在这个短代码中提高 numpy 性能？

> ID：14553331
> 
> 赞同：3
> 
> 时间：2013-01-27T23:00:04.717
> 
> 标签：python, performance, numpy, fortran

我试图弄清楚为什么我的一个 python 脚本与 gfortran 相比慢了大约 4 倍，我已经做到了：

```
import numpy as np

nvar_x=40
nvar_y=10

def fn_tst(x):
    for i in range(int(1e7)):
        y=np.repeat(x,1+nvar_y)
    return y

x = np.arange(40)
y = fn_tst(x)

print y.min(),y.max() 
```

这比下面的 fortran 代码慢了大约 13 倍

```
module test
integer,parameter::nvar_x=40,nvar_y=10
contains
subroutine fn_tst(x,y)
real,dimension(nvar_x)::x
real,dimension(nvar_x*(1+nvar_y))::y

do i = 1,10000000
   do k = 1,nvar_x
      y(k)=x(k)
      ibeg=nvar_x+(k-1)*nvar_y+1
      iend=ibeg+nvar_y-1
      y(ibeg:iend)=x(k)
   enddo
enddo

end subroutine fn_tst
end module test

program tst_cp
use test
real,dimension(nvar_x)::x
real,dimension(nvar_x*(1+nvar_y))::y
do k = 1,nvar_x
   x(k)=k-1
enddo

call fn_tst(x,y)

print *,minval(y),maxval(y)

stop
end 
```

您能否建议加快python脚本速度的方法。其他指向 numpy 良好性能的指针也将不胜感激。我宁愿坚持使用 python 而不是为 fortran 例程构建 python 包装器。

谢谢

@isedev，所以，就是这样。1.2s gfortran vs. 6.3s for Python？这是我第一次担心性能问题，但正如我所说，在我试图加速的代码中，使用 Python 只能达到 gfortran 速度的四分之一左右。

对，对不起，代码没有做同样的事情。确实，您在循环中指出的内容更像我在原始代码中的内容。

除非我遗漏了什么，否则我不同意最后的说法：我必须在 fn_tst 中创建 y。而 np.repeat 只是 RHS 上的术语之一（将 o/p 直接放在现有数组中）。如果我注释掉 np.repeat 术语，事情会很快......

```
rhs_slow = rhs[:J]
rhs_fast = rhs[J:]

rhs_fast[:] = c* ( b*in2[3:-1] * ( in2[1:-3] - in2[4:]  ) - fast) + hc_ovr_b * np.repeat(slow,K) #slow 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-28T01:12:32.990

首先，python 代码不会生成与 fortran 代码相同的输出。在 fortran 程序中，y 是从 0 到 39 的序列，然后是十个 0，十个 1，...，一直到十个 39。python 代码输出 11 个 0、11 个 1 到 11 个 39。

此代码产生与原始代码相同的输出并执行相似数量的内存分配：

```
import numpy as np

nvar_x = 40
nvar_y = 10

def fn_tst(x):
    for i in range(10000000):
        y = np.empty(nvar_x*(1+nvar_y))
        y[0:nvar_x] = x[0:nvar_x]
        y[nvar_x:] = np.repeat(x,nvar_y)
    return y

x = np.arange(40)
fn_tst(x)

print y.min(), y.max() 
```

在我的系统上（只有 1,000,000 个循环），fortran 代码在 1.2 秒内运行，上述 python 在 8.6 秒内运行。

但是，这不是一个公平的比较：对于 fortran 代码，y 被分配一次（在 fn_tst 例程之外），而对于 python 代码，y 在 fn_tst 函数内分配。

因此，如下重写 Python 代码可以提供更好的比较：

```
import numpy as np

nvar_x = 40
nvar_y = 10

def fn_tst(x,y):
    for i in range(10000000):
        y[0:nvar_x] = x[0:nvar_x]
        y[nvar_x:] = np.repeat(x,nvar_y)
    return y

x = np.arange(40)
y = np.empty(nvar_x*(1+nvar_y))
fn_tst(x,y)

print y.min(), y.max() 
```

在我的系统上，以上运行时间为 6.3 秒（同样是 1,000,000 次迭代）。所以已经大约。快 25%。

在这种情况下，主要的性能损失是 numpy.repeat() 正在生成一个数组，然后需要将其复制回 y 中。如果可以指示 numpy.repeat() 将其输出直接放在现有数组中（即本例中的 y ），事情会快得多......但这似乎是不可能的。

# jquery - 这是如何进行关键字查找器/密度检查吗？

> ID：14553332
> 
> 赞同：2
> 
> 时间：2013-01-27T23:00:06.677
> 
> 标签：jquery

嗨，我有一个相对较大的文本块，我想在其中找到最常见的关键字并计算这些关键字的密度。我想到的方式似乎可能很慢或性能要求高且困难：

遍历文本块中的每个单词。
为这些单词中的每一个找到所有相同的匹配项计算这些单词中的每一个的总匹配项假设前 5 个最多匹配项，然后计算它们相对于总块的密度。输出结果

有没有使用 jquery 做这件事的简单快速更好的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T23:07:51.980

```
var text = "Lorem ipsum ...";

var word_list = text.split(/\W+/); // Split the text into words.

var counts = {};#
Allocate a dictionary

for (var i = 0; i < word_list.length; ++i) {
    var word = word_list[i];
    counts[word] = (counts[word] || 0) + 1; // Increment count by one.
}

var densities = {};

for (word in counts) {
    densities[word] = parseFloat((counts[word] / word_list.length) * 100).toFixed(2); // Calculates all the densities percentage.
} 
```

剩下的就是获取最常见的。

您可能想要更改文本拆分为关键字的方式，或过滤掉非常常见/简短的单词。现在“it's”最终分裂成“it”、“s”。这可能不是你想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T23:05:23.160

我会用不同的滑动窗口来解决这个问题。每次遇到空格`" "`时，增加一个单词计数器，并将当前单词添加到存储桶中。如果存储桶包含该单词，则在存储桶中添加一个计数器。解析整个文本后，获取具有最大计数的存储桶。输出桶字，将桶数除以最大计数。

# php - 在php中解密aes密码的问题

> ID：14553333
> 
> 赞同：0
> 
> 时间：2013-01-27T23:00:10.773
> 
> 标签：php, encryption, aes

我正在编写一些 PHP 代码来执行 AES 字符串加密和解密。加密工作正常，但我似乎无法解密它。

下面是进行加密并添加所需填充的代码。

```
function encrypt($data) 
    { 
        $iv = "PRIVATE";
        $key = CIPHERKEY;

        return base64_encode(mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $key, addpadding($data), MCRYPT_MODE_CBC, $iv));
    }

    function addpadding($string, $blocksize = 16)
    {
        $len = strlen($string);
        $pad = $blocksize - ($len % $blocksize);
        $string .= str_repeat(chr($pad), $pad);

        return $string;
    } 
```

上面的代码运行良好，下面的代码在解密时一直失败。我尝试进行解密，然后剥离填充，但填充函数总是返回 false。

下面是进行解密和剥离的代码。

```
function strippadding($string)
{
    $slast = ord(substr($string, -1));
    $slastc = chr($slast);
    $pcheck = substr($string, -$slast);
    if(preg_match("/$slastc{".$slast."}/", $string)){
        $string = substr($string, 0, strlen($string)-$slast);
        return $string;
    } else {
        return "false";
    }
}

    function decrypt($data)
    {
        $iv = "PRIVATE";
        $key = CIPHERKEY;

        //$decoded = mcrypt_decrypt(MCRYPT_RIJNDAEL_128, $key, $data, MCRYPT_MODE_CBC, $iv);
        $decrytped = mcrypt_decrypt(MCRYPT_RIJNDAEL_128, $key, $data, MCRYPT_MODE_CBC, $iv);
        $base64Decoded = base64_decode($decrytped);
        return strippadding($base64Decoded);
    } 
```

感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T23:27:06.530

在您的解密方法中，解密和 base64 步骤是倒退的。重要的是，无论您以何种顺序进行加密操作，您都可以反向进行解密。

在您的加密方法中，您正在对密文进行 base64 编码：

```
base64_encode(mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $key, addpadding($data), MCRYPT_MODE_CBC, $iv)); 
```

解密时，您需要撤消 base64 编码，然后解密该结果。

```
$base64Decoded = base64_decode($data);
$decrytped = mcrypt_decrypt(MCRYPT_RIJNDAEL_128, $key, $base64Decoded, MCRYPT_MODE_CBC, $iv); 
```

此外，看起来 mcrypt 将处理填充不均匀块，因此您的 addpadding() 方法可能是多余的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T23:26:41.927

您使用的 IV 太短，小于块大小。我假设这会导致在解密时使用不同的 IV。Blocksize 是 16 个字节，所以 IV 应该是 16 个字节，但是您的固定字符串 IV 只有 7 个字节（如果计算底层 C 代码可能添加的终止零字节，则为 8 个字节）。

而不是使用固定字符串，您应该使用由[`mcrypt_create_iv()`](http://php.net/manual/en/function.mcrypt-create-iv.php). 您可以使用PHP 手册`mcrypt_get_iv_size()`中的示例 1 中所示的方法找出一个块的长度。`mcrypt_create_iv()`然后，您将发送/存储附加到密文的随机 IV，以便您知道 IV 在解密时是什么。

此外，mcrypt 自己填充，所以你不需要。而且，正如 mfanto 指出的那样，您需要在解密之前而不是之后解码 Base64。

# css - 背景图像固定并覆盖在手机/平板电脑上

> ID：14553334
> 
> 赞同：1
> 
> 时间：2013-01-27T23:00:24.303
> 
> 标签：css, responsive-design, tablet, smartphone

如何获得可缩放到视口的固定背景图像以在智能手机/平板电脑上正常工作？

[此处提到](http://css-tricks.com/perfect-full-page-background-image/)的任何方法都不适用于我测试过的方法（Galaxy Nexus 和 TF300t，使用默认浏览器、Firefox 或 Chrome 都存在闪烁/奇怪调整大小或忽略“封面”指令的问题）

我看到的一件事是不要将背景图像放在触摸设备的 HTML 标记上，因为它们似乎滚动了全高视口，而不是在 HTML 标记内滚动。

```
body {
  background: black url("../img/cover.jpg") no-repeat top center fixed;
  -webkit-background-size: cover; 
  -moz-background-size: cover; 
  -o-background-size: cover; 
  background-size: cover;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T00:17:24.023

几个月前我写了一种适合您需求的方法：http: [//plugins.jquery.com/fitpic/](http://plugins.jquery.com/fitpic/)

**HTML**

```
<img src="http://ge.tt/api/1/files/1jN8IzR/0/blob?download" class='bg'> 
```

**CSS** *并不真正需要*

```
.bg {
    position: fixed;
    top: 0;
    left: 0;
    z-index: -1
} 
```

**JS**

```
var fitPic = (function() {
    var winW = $(window).width(),
        winH = window.innerHeight || $(window).height(); // `innerHeight` for mobile safari

    $(".bg").each(function() {

        var elem = $(this),
            elemW = elem.width(),
            elemH = elem.height(),

            imgW = (elemW * winH) / elemH,
            imgH = (elemH * winW) / elemW,

            newW = imgH < winH ? imgW : winW,
            newH = imgH < winH ? winH : imgH;

        this.style.width = newW + "px";
        this.style.height = newH + "px";

    });
});

$(window).on('load resize', fitPic); 
```

# php - 避免硬编码的嵌套 foreach 循环

> ID：14553338
> 
> 赞同：1
> 
> 时间：2013-01-27T23:01:06.613
> 
> 标签：php, mysql, loops

有什么办法可以避免这样做（这是循环访问数据库中的目录数据，然后为它的所有孩子和孩子的孩子获取相同的数据......无限期：

```
$directories = DB::queryOneColumn('id', "SELECT `id` FROM `data` WHERE `level` = '1' AND `batch` = %s", $lastBatchID);
foreach ($directories as $dir) {

$dirInfo = DB::query("SELECT `folder`, `size` FROM `data` WHERE `id` = $dir");
$size = intval($dirInfo[0]['size']) * 1024;
echo stripslashes($dirInfo[0]['folder']) . "  -Current:" . human_filesize($size) . "<br>";

$directories2 = DB::queryOneColumn('id', "SELECT `id` FROM `data` WHERE `parentID` = %s AND `batch` = %s", $dir, $lastBatchID);

foreach ($directories2 as $dir2) {

    $dirInfo = DB::query("SELECT `folder`, `size` FROM `data` WHERE `id` = $dir2");
    $size = intval($dirInfo[0]['size']) * 1024;
    echo "=>" . stripslashes($dirInfo[0]['folder']) . "  -Current:" . human_filesize($size) . "<br>";

    $directories3 = DB::queryOneColumn('id', "SELECT `id` FROM `data` WHERE `parentID` = %s AND `batch` = %s", $dir2, $lastBatchID);

    foreach ($directories3 as $dir3) {

        $dirInfo = DB::query("SELECT `folder`, `size` FROM `data` WHERE `id` = $dir3");
        $size = intval($dirInfo[0]['size']) * 1024;
        echo "=>=>" . stripslashes($dirInfo[0]['folder']) . "  -Current:" . human_filesize($size) . "<br>";

        $directories4 = DB::queryOneColumn('id', "SELECT `id` FROM `data` WHERE `parentID` = %s AND `batch` = %s", $dir3, $lastBatchID);

        foreach ($directories4 as $dir4) {

            $dirInfo = DB::query("SELECT `folder`, `size` FROM `data` WHERE `id` = $dir4");
            $size = intval($dirInfo[0]['size']) * 1024;
            echo "=>=>=>" . stripslashes($dirInfo[0]['folder']) . "  -Current:" . human_filesize($size) . "<br>";

            $directories5 = DB::queryOneColumn('id', "SELECT `id` FROM `data` WHERE `parentID` = %s AND `batch` = %s", $dir4, $lastBatchID);

            foreach ($directories5 as $dir5) {

                $dirInfo = DB::query("SELECT `folder`, `size` FROM `data` WHERE `id` = $dir5");
                $size = intval($dirInfo[0]['size']) * 1024;
                echo "=>=>=>=>" . stripslashes($dirInfo[0]['folder']) . "  -Current:" . human_filesize($size) . "<br>";
            }
        }
    }
} 
```

}

基本上，我们正在获取 x 级目录的数据，并且需要为每个级别循环显示数据，如下所示：

```
C:\it\AD-Chris Integration -Current:49.70M
=>C:\it\AD-Chris Integration\AD-Chris2 -Current:49.69M
=>=>C:\it\AD-Chris Integration\AD-Chris2\AD-Chris -Current:5.22M
=>=>=>C:\it\AD-Chris Integration\AD-Chris2\AD-Chris\Common -Current:599.00K
=>=>=>C:\it\AD-Chris Integration\AD-Chris2\AD-Chris\Department -Current:453.00K
=>=>=>C:\it\AD-Chris Integration\AD-Chris2\AD-Chris\Encrypt -Current:327.00K
=>=>=>C:\it\AD-Chris Integration\AD-Chris2\AD-Chris\Location -Current:387.00K
=>=>=>C:\it\AD-Chris Integration\AD-Chris2\AD-Chris\Manager -Current:1.36M
=>=>=>C:\it\AD-Chris Integration\AD-Chris2\AD-Chris\ScanForStaffID -Current:348.00K
=>=>=>C:\it\AD-Chris Integration\AD-Chris2\AD-Chris\Title -Current:498.00K
=>=>=>C:\it\AD-Chris Integration\AD-Chris2\AD-Chris\bin -Current:529.00K
=>=>=>C:\it\AD-Chris Integration\AD-Chris2\AD-Chris\obj -Current:439.00K
=>=>C:\it\AD-Chris Integration\AD-Chris2\_Deploy -Current:622.00K 
```

我有一个可用的变量，其中包含我们需要深入的级别数

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T23:11:44.010

```
function something($dir, $lastBatchID, $level = 0) {
    $dirInfo = DB::query("SELECT `folder`, `size` FROM `data` WHERE `id` = $dir");
    $size = intval($dirInfo[0]['size']) * 1024;

    echo str_repeat('=>', $level);
    echo stripslashes($dirInfo[0]['folder']) . "  -Current:" . human_filesize($size) . "<br>";

    $directories2 = DB::queryOneColumn('id', "SELECT `id` FROM `data` WHERE `parentID` = %s AND `batch` = %s", $dir, $lastBatchID);

    if ($level > 5) return;

    foreach ($directories2 as $dir2) {
        something($dir2, $lastBatchID, $level + 1);
    }
}

$directories = DB::queryOneColumn('id', "SELECT `id` FROM `data` WHERE `level` = '1' AND `batch` = %s", $lastBatchID);
foreach ($directories as $dir) {
    something($dir, $lastBatchID);
} 
```

# sed - Sed 将特定行上的每个单词大写

> ID：14553339
> 
> 赞同：2
> 
> 时间：2013-01-27T23:01:08.550
> 
> 标签：sed, capitalize

我的降价文件格式如下

```
chapter one
Blah, blah, blah.
chapter one-hundred-fifty-three 
```

以及格式如下的文件

```
CHAPTER ONE
Blah, blah, blah.
CHAPTER ONE-HUNDRED-FIFTY-THREE 
```

在这两种情况下，我都想将章节行大写

```
# Chapter One
Blah, blah, blah.
# Chapter One-Hundred-Fifty-Three 
```

我想使用 sed （或 awk 或可能其他一些管道输入和输出的 linux cli 程序）

我找到了限制文件中每个单词的解决方案，但我不确定如何将其限制为特定行或如何包含 words-connected-with-dashes-instead-of-whitespace

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T23:18:38.810

使用`GNU sed`，使用地址（指示目标行号）告诉它将替换应用到所需的行。例如，将替换应用于第一行：

```
sed -r '1s/(\w)(\w*)/\U\1\L\2/g' file 
```

要将替换应用于第三行：

```
sed -r '3s/(\w)(\w*)/\U\1\L\2/g' file 
```

要将替换应用于第一行和第三行：

```
sed -r -e '1s/(\w)(\w*)/\U\1\L\2/g' -e '3s/(\w)(\w*)/\U\1\L\2/g' 
```

如果您不介意修改第二行，则可以使用地址范围：

```
sed -r '1,3s/(\w)(\w*)/\U\1\L\2/g' 
```

***编辑：***

根据以下评论：

```
sed -r '/^chapter/I { s/^/# /; s/(\w)(\w*)/\U\1\L\2/g }' file 
```

结果：

```
# Chapter One
Blah, blah, blah.
# Chapter One-Hundred-Fifty-Three
# Chapter One
Blah, blah, blah.
# Chapter One-Hundred-Fifty-Three 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T23:54:35.430

我会在 Perl 中做类似的事情：

```
#!/usr/bin/perl

while(<>) {
  if(/^chapter/i) {
    $_ = join " ", map ucfirst, split / /, lc;
    $_ = join "-", map ucfirst, split /-/;
  }
  print;
} 
```

像这样称呼它`perl script < input-text > capitalized-text`。我的 Perl-fu 生锈了，我敢肯定有人会将它折叠成一个称为参数的单行。

# c++ - 拆分后维护二维点的排序数组（C++）

> ID：14553344
> 
> 赞同：0
> 
> 时间：2013-01-27T23:01:21.463
> 
> 标签：c++, sorting, split

到目前为止，我有一个二维点数组 (x_i, y_i)。在第一步中，我创建了一个按 x 坐标排序的数组和一个按 y 坐标排序的数组。然后我将 x 排序数组分成两半。我如何从这两半中重建 y 排序数组的相应两半，而无需再次按 y 坐标排序。似乎在线性时间内是可能的，而且应该很容易。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T23:04:52.537

在伪代码中：

```
for p in sorted-by-y
    if p is in first half of sorted-by-x
        add p to first half of sorted-by-y
    else
        add p to second half of sorted-by-y 
```

如果将 p 添加到每个“半集”的末尾，则将保持“按 y 排序”的排序顺序。

# c++ - 此合并排序有问题

> ID：14553347
> 
> 赞同：0
> 
> 时间：2013-01-27T23:01:34.633
> 
> 标签：c++, c, mergesort

我想对数组进行排序。所以我写了这个合并排序，它没有做我想要的，即排序，只是停顿！我一遍又一遍地检查算法，我觉得这很正确，但是没有！请看一下并告诉我可能出了什么问题。

```
void mergeSort(int *arr, int low, int high){
int mid = (low+high)/2;
while(low<high){
    mergeSort(arr, low, mid);
    mergeSort(arr, mid+1, high);
    merge(arr, low, high, mid);
}
}

void merge(int *arr,int low, int high, int mid){
int i =low,j=mid+1,k=0;
int temp[50];  // should i new/malloc this with size of ( high -low +1) ?
while(i<=mid && j<=high){
    if(arr[i]<arr[j])
        temp[k++] = arr[i++];
    else
        temp[k++] = arr[j++];
}
while(i<=mid)
    temp[k++] = arr[i++];
while(j<=high)
    temp[k++] = arr[j++];
for(int x = 0; x<=high; x++){
    arr[x]=temp[x];
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T23:06:26.710

```
void mergeSort(int *arr, int low, int high){
    int mid = (low+high)/2;
    while(low<high){ 
```

如果完全进入循环，则它是一个无限循环，因为既没有`low`也没有`high`改变。

```
 mergeSort(arr, low, mid);
        mergeSort(arr, mid+1, high);
        merge(arr, low, high, mid);
    }
}

void merge(int *arr,int low, int high, int mid){
    int i =low,j=mid+1,k=0;
    int temp[50];  // should i new/malloc this with size of ( high -low +1) ? 
```

是的，您绝对应该分配正确的存储量。

```
 while(i<=mid && j<=high){
        if(arr[i]<arr[j]) 
```

最好是有一个稳定的排序，尽管这对s`arr[i] <= arr[j]`无关紧要。`int`

```
 temp[k++] = arr[i++];
        else
            temp[k++] = arr[j++];
    }
    while(i<=mid)
        temp[k++] = arr[i++];
    while(j<=high)
        temp[k++] = arr[j++];
    for(int x = 0; x<=high; x++){ 
```

那应该是`for(int x = low; ...`。

```
 arr[x]=temp[x]; 
```

`arr[x] = temp[x-low];`（或使用两个索引）。

```
 }
} 
```

# google-cloud-datastore - App Engine 模拟数据存储区 - 奇怪的观察

> ID：14553348
> 
> 赞同：0
> 
> 时间：2013-01-27T23:01:44.913
> 
> 标签：google-cloud-datastore

我正在我的机器上试验“数据存储”。使用此代码。

```
 Key parentKey = KeyFactory.createKey("parent", "parentId");
            try {
    //          Entity parent = new Entity("parent", "parentId");
    //          parent.setUnindexedProperty("property1", "value1");
    //          ds.put(parent);
                Entity savedParent = ds.get(parentKey);
    //          savedParent.setUnindexedProperty("property1", "value3");
    //          ds.put(savedParent);
    //          Entity child = new Entity("child", "childId", savedParent.getKey());
                Entity child = ds.get(KeyFactory.createKey(savedParent.getKey(), "child", "childId"));
                child.setUnindexedProperty("property1", "val2");
                ds.put(child);
    //          logger.info("Saved child.");
            } catch (EntityNotFoundException e) {
                throw new RuntimeException(e);
            } 
```

首先，我保存了父实体并将其属性设置为“value2”，然后我添加了一个具有属性 val1 的子实体。然后我将父属性更新为 value3。然后我将子属性更新为 val2。然后我在管理控制台中发现，父属性的值又回到了 value2。我又重复了一遍，结果相同。我错过了什么吗？或者这是某种错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T00:17:26.647

我想，这是最终一致性的体现，对吧？我在一个新的 JVM 实例中运行每个步骤，认为在我关闭它时必须存储值：-。与常识相矛盾，但在模拟最终一致性方面是正确的......

# python - 在 Python 中查找数字的倍数

> ID：14553349
> 
> 赞同：16
> 
> 时间：2013-01-27T23:01:46.443
> 
> 标签：python, math, range

我正在尝试编写一个代码，让我找到一个数字的前几个倍数。这是我的尝试之一：

```
def printMultiples(n, m):
for m in (n,m):
    print(n, end = ' ') 
```

我发现，通过 put `for m in (n, m):`，它会在循环中运行任何数字`m`。

```
def printMultiples(n, m):
'takes n and m as integers and finds all first m multiples of n'
for m in (n,m):
    if n % 2 == 0:
        while n < 0:
            print(n) 
```

经过多次搜索，我只能找到java中的示例代码，因此我尝试将其翻译成python，但没有得到任何结果。我有一种感觉我应该`range()`在这个地方使用这个功能，但我不知道在哪里。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-27T23:05:01.927

如果你试图找到 的第一个`count`倍数`m`，这样的事情会起作用：

```
def multiples(m, count):
    for i in range(count):
        print(i*m) 
```

或者，您可以使用范围执行此操作：

```
def multiples(m, count):
    for i in range(0,count*m,m):
        print(i) 
```

请注意，这两个都从倍数开始`0`- 如果您想改为从 开始`m`，则需要将其抵消这么多：

```
range(m,(count+1)*m,m) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-27T23:04:29.973

这是做你想做的吗？

```
print range(0, (m+1)*n, n)[1:] 
```

对于 m=5，n=20

```
[20, 40, 60, 80, 100] 
```

或者更好的是，

```
>>> print range(n, (m+1)*n, n)
[20, 40, 60, 80, 100] 
```

对于 Python3+

```
>>> print(list(range(n, (m+1)*n, n)))
[20, 40, 60, 80, 100] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-01-23T16:43:33.853

基于数学概念，我理解：

*   所有自然数，除以`n`，`0`余数都是 的倍数`n`

因此，以下计算也适用于解决方案（1 到 100 之间的倍数）：

```
>>> multiples_5 = [n for n in range(1, 101) if n % 5 == 0]
>>> multiples_5
[5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100] 
```

进一步阅读：

*   [https://www.mathsisfun.com/definitions/natural-number.html](https://www.mathsisfun.com/definitions/natural-number.html)
*   [https://www.mathwizz.com/arithmetic/help/help9.htm](https://www.mathwizz.com/arithmetic/help/help9.htm)
*   [https://www.calculatorsoup.com/calculators/math/multiples.php](https://www.calculatorsoup.com/calculators/math/multiples.php)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-27T23:18:07.887

对于 5 的前十个倍数，比如说

```
>>> [5*n for n in range(1,10+1)]
[5, 10, 15, 20, 25, 30, 35, 40, 45, 50] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-05-29T14:13:39.867

你可以做：

```
def mul_table(n,i=1):
    print(n*i)
    if i !=10:
        mul_table(n,i+1)
mul_table(7) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-09-24T05:07:34.170

可以做的另一种方法是尝试制作一个列表。这是我获取 7 的前 20 个倍数的示例。

**输入：**

```
multiples_7 = [x * 7 for x in range(1,21)] 

print(multiples_7) 
```

**输出：**

```
[7, 14, 21, 28, 35, 42, 49, 56, 63, 70, 77, 84, 91, 98, 105, 112, 119, 126, 133, 140] 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-07-26T08:31:19.160

如果这是您正在寻找的 -

找出给定数字和极限之间的所有倍数

```
def find_multiples(integer, limit):
    return list(range(integer,limit+1, integer)) 
```

这应该返回 -

```
Test.assert_equals(find_multiples(5, 25), [5, 10, 15, 20, 25]) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-08-02T23:37:59.170

对于 5 的前 10 个倍数，您可以这样做

```
import numpy as np
#np.arange(1,11) array from 1 to 10 
array_multipleof5 = [5*n for n in np.arange(1,11)]
array_multipleof5 = np.array(array_multipleof5)
print(array_multipleof5) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-01-18T15:59:21.520

```
def multiples(n,m,starting_from=1,increment_by=1):
    """
    # Where n is the number 10 and m is the number 2 from your example. 
    # In case you want to print the multiples starting from some other number other than 1 then you could use the starting_from parameter
    # In case you want to print every 2nd multiple or every 3rd multiple you could change the increment_by 
    """
    print [ n*x for x in range(starting_from,m+1,increment_by) ] 
```

# haskell - Haskell 模式绑定破坏性地修改变量？

> ID：14553351
> 
> 赞同：1
> 
> 时间：2013-01-27T23:01:51.707
> 
> 标签：haskell

我对 Haskell 有点陌生，但这种行为对我来说很奇怪。如果我有一个简单的函数定义如下：

```
foobar :: Integer -> [Integer] -> Integer
foobar x y = case y of
  (a:x:b) -> x
  _ -> -1 
```

我基本上期望如果 y 包含至少两个元素并且 y 的第二个元素只是 foobar 的第一个参数，该函数应该评估为 foobar 的第一个参数。否则得到-1。但是在 ghci 中：

```
foobar 5 [6,7] 
```

给我 7，而不是 -1。

我如何理解这种行为？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-27T23:04:31.143

您在这里所做的不是“更新”`x`变量，而是隐藏它。您正在创建一个`x`在 case 语句的第一个分支范围内调用的新变量。

您不能像我认为您正在尝试做的那样使用 case 语句来比较平等。如果这是您的目标，您将需要执行类似的操作

```
foobar :: Integer -> [Integer] -> Integer
foobar x y = case y of
    (a:x':b) | x == x' -> x
    _                  -> -1 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-28T16:04:55.887

您可以通过像这样调整代码来判断它`x`不会*破坏性地更新*：

```
foobar :: Integer -> [Integer] -> Integer
foobar x y = (case y of
    (a:x:b)  -> x
    _        -> -1
    ) + x 
```

最后`x`的将使用原始`x`值；它没有被破坏，相反，表达式`x`内部的绑定被遮蔽了。`case`调用`foobar 5 [6,7]`将产生 12，而不是 14。

# python - python 3.2.3 xml.etree.cElementTree unicode 字符无法正常工作

> ID：14553354
> 
> 赞同：0
> 
> 时间：2013-01-27T23:02:07.790
> 
> 标签：python, xml, urllib, elementtree

我偶然发现了 python 的这个特殊问题，我无法解释它为什么会发生。假设我有来自服务器的这个 xml 片段：

```
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<!--Get the Object if known to the system-->
<object>
  <ID>1</ID>
  <name>object1</name>
  <tags type="languages">English,Español</tags>
</object> 
```

我使用以下代码从服务器获取它：

```
temp = urllib.request.urlopen("http://someurl.com")
tree = elementTree.parse(temp)
node = tree.getroot() 
```

一切正常，直到我在“Español”中得到一个像“ñ”这样的特殊字符。我没有正确打印这些字符，而是在我的 HTML 代码中得到以下内容：

```
<b>tags</b>: English,EspaÃ±ol <br/> 
```

我是如何从 'ñ' 变成 'Ã±' 的？

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T23:05:56.973

您看到 UTF-8 数据被解释为拉丁语 1：

```
>>> '\u00f1'.encode('utf8').decode('latin1')
Ã± 
```

`\u00f1`后面带有波浪号的小拉丁文 n 的 unicode 代码点在哪里：ñ。

您的终端可能已配置为 Latin-1 显示；尝试从 UTF-8 解码：

```
print(str(tag, 'utf8')) 
```

# r - 在超级计算机上并行化，然后合并并行结果 (R)

> ID：14553357
> 
> 赞同：5
> 
> 时间：2013-01-27T23:02:27.717
> 
> 标签：r, bash, statistics, cluster-computing

我可以访问一个强大的大型集群。我是一名中规中矩的 R 程序员，但对 shell 命令（以及一般的终端命令，除了使用 ubuntu 需要做的基本事情之外）完全陌生。

我想使用这个集群在 R 中运行一堆并行进程，然后我想将它们组合起来。具体来说，我有一个类似的问题：

```
my.function <-function(data,otherdata,N){
    mod = lm(y~x, data=data)
    a = predict(mod,newdata = otherdata,se.fit=TRUE)
    b = rnorm(N,a$fit,a$se.fit)
    b
    }

r1 = my.function
r2 = my.function
r3 = my.function
r4 = my.function
...
r1000 = my.function

results = list(r1,r2,r3,r4, ... r1000) 
```

上面只是一个愚蠢的例子，但基本上我想并行做 1000 次，然后用 1000 个进程的所有结果做一些事情。

如何将 1000 个作业同时提交到集群，然后合并所有结果，就像代码的最后一行一样？

任何关于我使用 RTFM 的编写良好的手册/参考的建议也将受到欢迎。不幸的是，我找到的文件并不是特别容易理解。

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T23:05:06.460

您可以`plyr`与`doMC`包（即包的并行后端`foreach`）结合，如下所示：

```
require(plyr)
require(doMC)
registerDoMC(20) # for 20 processors

llply(1:1000, function(idx) {
    out <- my.function(.)
}, .parallel = TRUE) 
```

**编辑：**如果您正在谈论提交同时工作，那么您没有[LSF 许可证](http://en.wikipedia.org/wiki/Platform_LSF)吗？然后，您可以根据`bsub`需要提交尽可能多的作业，并且它还负责负载平衡等等......！

**编辑 2：**关于负载平衡的小说明（使用 LSF 的示例`bsub`）：

您提到的内容类似于我在这里写的内容 => `LSF`。可以`jobs`分批提交。例如：使用 in`LSF`您可以使用`bsub`向集群提交作业，如下所示：

```
bsub -m <nodes> -q <queue> -n <processors> -o <output.log> 
     -e <error.log> Rscript myscript.R 
```

这会将您置于队列中并为您分配处理器数量（如果可用），您的作业将开始运行（取决于资源）。你可以`pause`，你`restart`的`suspend`工作.. 以及更多..`qsub`类似于这个概念。学习曲线可能有点陡峭，但值得。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-27T23:19:35.197

我们在 Journal of Statistical Software（开放期刊）上写了一篇关于[R 并行计算技术现状的](http://www.jstatsoft.org/v31/i01)调查论文。您可能会发现这作为介绍很有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-27T23:11:32.323

[消息传递接口](http://www.stats.uwo.ca/faculty/yu/Rmpi/)做你想做的事，而且很容易做到。编译后，你需要运行：

```
mpirun -np [no.of.process] [executable] 
```

您可以使用带有主机 ip 字段的简单文本文件选择在何处运行它，例如：

```
node01   192.168.0.1
node02   192.168.0.2
node03   192.168.0.3 
```

[这里](http://www.lam-mpi.org/tutorials/one-step/ezstart.php)有更多 MPI 的例子。

# c - 为什么不能用 getchar() 读取换行符和空格？

> ID：14553358
> 
> 赞同：1
> 
> 时间：2013-01-27T23:02:37.837
> 
> 标签：c

我需要让用户使用 getchar 输入输入，并检查空格、换行符和其他字符的数量。

这是我的代码：

```
#include <stdio.h>

int main()

{

    char word;
    int spaces, newLines, theRest;
    spaces = 0;
    newLines = 0;
    theRest = 0;
    printf("please type an input:\n");

    while ((word = getchar() != '#'))
    {
        if (word == ' ')
            spaces++;
        else if (word == '\n')
            newLines++;
        else
            theRest++;
    }
    printf("number of spaces: %d, number of new lines: %d, other characters: %d", spaces, newLines, theRest);

} 
```

对于我提供的任何输入，我只获得`theRest`包含所有字符的值。你能告诉我我在这里做错了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T23:05:46.087

```
while (word = getchar() != '#') 
```

应该：

```
while ((word = getchar()) != '#') 
```

# ruby - 未调用 Datamapper + Carrierwave 存储方法，仅缓存

> ID：14553361
> 
> 赞同：3
> 
> 时间：2013-01-27T23:03:20.530
> 
> 标签：ruby, sinatra, datamapper, carrierwave

我有一个非常简单的 sinatra 应用程序，它使用 datamapper 和carrierwave。

我已将上传器减少到最低限度：

```
class PhotoUploader < CarrierWave::Uploader::Base
  include CarrierWave::MiniMagick

  storage :file
end 
```

并有一个使用它的简单模型：

```
class Photo
  include DataMapper::Resource

  property :id, Serial
  property :caption, String
  property :position, Integer
  property :created_at, DateTime
  property :updated_at, DateTime

  mount_uploader :source, PhotoUploader

  belongs_to :album
end 
```

碰巧当我使用它时：

```
post '/admin/album/:id/photo/create' do
  album = Album.get(params[:id])
  photo = Photo.create(params[:photo])
  album.photos << photo
  album.save!

  redirect '/admin/album'
end 
```

`photo`正在数据库上正常创建，并且文件正在正常上传到缓存目录，但未移动到最终存储目标。

我已经进入了载波代码，并且可以验证`cache!`正在调用该方法而不是该`store!`方法。

我尝试使用与对象没有任何关联的上传器：

```
get '/lorem' do
  f = File.open('test.png')
  u = PhotoUploader.new
  u.store!(f)

  "ok"
end 
```

在这种情况下，一切都按预期工作。

**==================== 更新====================**

我相信我已经找到了问题的根源。在运行调试器时，我得到了这个：

```
gems/dm-core-1.2.0/lib/dm-core/query.rb:1014
conditions.each do |condition|
(rdb:1) 
gems/carrierwave-0.6.2/lib/carrierwave/sanitized_file.rb:290
def sanitize(name)
(rdb:4) 
gems/carrierwave-0.6.2/lib/carrierwave/sanitized_file.rb:299
def split_extension(filename)
(rdb:4) 
gems/carrierwave-0.6.2/lib/carrierwave/sanitized_file.rb:29
self.file = file
(rdb:4) 
gems/carrierwave-0.6.2/lib/carrierwave/sanitized_file.rb:269
if file.is_a?(Hash)
(rdb:4) 
gems/carrierwave-0.6.2/lib/carrierwave/sanitized_file.rb:274
@file = file

(rdb:4) pp file
"/Users/jvalente/Projects/dummy/public/uploads/{:filename=>\"Screen Shot 2013-01-24 at 4.57.15 PM.png\", :type=>\"image/png\", :name=>\"photo[source]\", :tempfile=>#<File:/var/folders/jp/wm1gxk8558d36rh9vzkmx4jw0000gn/T/RackMultipart20130128-27245-105ybbf>, :head=>\"Content-Disposition: form-data; name=\\\"photo[source]\\\"; filename=\\\"Screen Shot 2013-01-24 at 4.57.15 PM.png\\\"\\r\\nContent-Type: image/png\\r\\n\"}" 
```

这显然是错误的，因为它将不符合`file.is_a?(Hash)`条件并进入：

```
@file = file
@original_filename = nil
@content_type = nil 
```

不过，我不明白为什么会发生这种情况。

# c++ - 无法输出向量 到一个文件

> ID：14553375
> 
> 赞同：2
> 
> 时间：2013-01-27T23:05:19.213
> 
> 标签：c++, vector, cout

我是 C++ 新手。我无法将数据输出到文件。我正在使用迭代器来打印地图。print 方法接受 i，一个键值，并打印出它对应的向量。现在，当我使用 cout<< 正常输出时，这工作得非常好，但是当我尝试将相同的输出放入文件时，我的程序崩溃了。我知道它是 outfile<< 行中的 *it 导致它崩溃，因为如果我用一些随机字符串替换它，它会将它输出到文件中。另外，我知道 print 方法中的参数没有引起任何问题，因为我可以将该方法直接转移到程序的 main 函数并得到相同的错误。任何有关如何解决此问题的帮助将不胜感激，谢谢！这是发生错误的打印方法：

```
 public: void print(int i, vector<string> in, ostream& outfile) // print method for printing a vector and it's key
{

    sort(in.begin(), in.end()); // sort the vector alphabetically first

    vector<string>::iterator it; 

    it= unique(in.begin(), in.end()); // makes sure there are no duplicate strings

    in.resize( distance(in.begin(),it) );

    for( it = in.begin(); it != in.end(); it++ ) // iterate through it

    cout << i << ": "<< *it<<endl; // and print out the key value and each string in the vector
   // outfile<< i << ":" << *it<< endl; // prints to file
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T23:09:31.523

您是否同时使用该`cout`线路？如果是这样，我想我知道它是什么。

没有大括号的`for`循环将执行下一条语句作为其循环体。如果您同时使用`cout`行和`outfile`行，您将打印所有内容，然后在循环之后，`it`将位于数组末尾的后面。然后，您尝试取消引用它并将其写入文件，这当然会失败，因为您正在取消引用无效的迭代器。

简短的回答，用大括号将语句包装在你的 for 循环中。

例如，您有以下内容（正确缩进时）：

```
for( it = in.begin(); it != in.end(); it++ ) // iterate through it
    cout << i << ": "<< *it<<endl; 
outfile<< i << ":" << *it<< endl; // prints to file 
```

在最后一行，`it = in.end()`，其中是*刚刚超过*向量末尾的`in.end()`元素。然后，您尝试访问该位置不存在（并且无效）的元素，因此它失败了。相反，您需要将其移动到循环内，该循环应为

 *```
for( it = in.begin(); it != in.end(); it++ ) // iterate through it
{
    cout << i << ": "<< *it<<endl; // and print out the key value and each string in the vector
    outfile<< i << ":" << *it<< endl; // prints to file
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T23:40:56.750

@slugonamission 已经给了你正确的答案，所以我只想指出你的函数实际上可以被简化并且更不容易出错。我写这个作为答案只是因为需要代码格式化，否则我会在评论中发布它：

```
void print(int i, vector<string> v, ostream& o)
{
    sort(begin(v), end(v));
    v.erase(unique(begin(v), end(v))); // Do this in one step, no iterator mess
    for (auto const& s : v) // Avoid manual iteration cycles if you can
    {
        o << i << ":" << s << endl;
        ...
    }
} 
```

**编辑：**

正如@juanchopanza 正确指出的那样，实现相同目标的更快方法是将矢量的内容传输到关联容器中以确保唯一性。这将允许您通过以下方式传递向量`const &`：

```
void print(int i, vector<string> const& v, ostream& o)
{
    unordered_set<string> c(begin(v), end(v));
    for (auto const& s : c)
    {
        o << i << ":" << s << endl;
    }
} 
```*

# javascript - 用ajax更新的js函数定义，如何重新定义函数/eval？

> ID：14553382
> 
> 赞同：0
> 
> 时间：2013-01-27T23:06:07.460
> 
> 标签：javascript, jquery, twig

我有一个幻灯片 Web 应用程序，对于某些幻灯片，它包括从服务器端与该幻灯片一起呈现的 beforeSlideshowAction，javascript 与该幻灯片的内容一起呈现，因为它是生成此内容的幻灯片模板的一部分。

但是，以下的 javascript 函数不会与我的内容一起更新。例如，如果我要加载幻灯片，然后在这两张幻灯片上切换位置（更新将在幻灯片运行完整周期后由 ajax 完成），下面的 beforeSlideshowAction_slide1() 现在将呈现为 beforeSlideshowAction_slide2( )，但是当被调用时，只会存在一个名为 beforeSlideshowAction_slide1() 的函数，我假设所有 javascript 函数仅在页面初始加载时注册。

我记得通过在包含更新函数的脚本块上调用 eval 再次解决了类似的问题，我的问题是否有不那么骇人听闻的解决方案？

```
{# comment: from here the document will be updated by Ajax #}
<div id="slideshowbody">

    {# comment: ordernumber is now 1 #}
    <div id="slide{{ ordernumber }}">

        //some content goes here

        <script>
        function beforeSlideshowAction_slide{{ ordernumber }}() {

            //assign appropriate value to videoContent for current slide
            videoContent[{{ ordernumber }}]='video={{ data0 }}&height={{ data1 }}&width={{ data2 }}&codec={{ data3 }}&fullscreen={{ data5 }}';

        }
        </script>

    </div>

    {# comment: ordernumber is now 2 #}
    <div id="slide{{ ordernumber }}">

        //some content goes here

        //slide 2 doesn't have a function for a "beforeSlideshowAction"

    </div>

</div> 
```

不要担心我可能正在调用一个不存在的函数，我在 try/catch 块中执行它，我已经设置它以便为 try/catch 中的每张幻灯片调用一个 beforeSlideshowFunction，并且在幻灯片模板 如果我想要一个函数，我只是在那里定义一个函数，如果不是，我就跳过它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T21:06:26.537

这是我最终解决的方法

```
<script id="beforeSlideshowAction{{ ordernumber }}_script" type='text/javascript'>

//define the function for later use (page updates)
window.beforeSlideshowAction_slide{{ ordernumber }} = function() {  

    console.log('runnin beforeSlideshowAction for slide {{ ordernumber }}');

    //assign appropriate value to videoContent for current slide
    videoContent[{{ ordernumber }}]='video={{ data0 }}&height={{ data1 }}&width={{ data2 }}&codec={{ data3 }}&fullscreen={{ data5 }}';

}

//run
var x = window['beforeSlideshowAction_slide{{ ordernumber }}'];
x();

</script> 
```

...后来，当这已被 ajax 更改时，slide1 函数可能改为 slide3 函数...

```
 //replace the innerHTML of body with the new stuff
            document.getElementById('slideshow_body').innerHTML=newContent;

            //update the videoContents and run other beforeSlideshow-actions
            for (var i=1;i<(pauseTimes.length+1);i++)
            { 

                try {
                    console.log('slide '+i+' action...');

                    //set previous version of beforeSlideshowAction i to null
                    window['beforeSlideshowAction_slide'+i] = null;

                    //define it anew (will this run it too?)
                    ie_compatible_eval( document.getElementById('beforeSlideshowAction'+i+'_script').innerHTML )

                }
                catch(e) {
                    console.log('slide '+i+' none');
                    //do nothing since we will not have a function named that for every slide, error is expected
                }

            } 
```

# java - 如何将 IDEA 的构建文件夹从 TEMP 更改为其他内容？

> ID：14553383
> 
> 赞同：3
> 
> 时间：2013-01-27T23:06:07.603
> 
> 标签：java, applet

我试图运行：

```
import java.applet.Applet;
import java.awt.*;
import java.net.URL;

public class img extends Applet
{
    private Image img;
    public void init()
    {
        img = null;
    }
    public void loadImage()
    {
        try
        {
            img = getImage(getCodeBase(), "winter.jpg");
            System.out.println(img);
            System.out.println(prepareImage(img, 300, 400, this));
        }
        catch(Exception e){}

        System.out.println(getDocumentBase());
    }
    public void paint(Graphics g)
    {
        if (img == null)
            loadImage();
        g.drawImage(img, 0, 0, this);
    }
} 
```

但它找不到winter.jpg，除非它位于：file:/C:/Users/Admin/AppData/Local/Temp/

System.out.println(getDocumentBase()); 返回：file:/C:/Users/Admin/AppData/Local/Temp/AppletPage1228891259548967526.html 而不是：C:/Users/Admin/Dropbox/dev/idea/Exam3/out/production/Exam3/（其中 .class文件位于）

我正在使用 IntelliJ IDEA 12。

我只是想将我的 JPEG 文件放在 Exam3 文件夹中，而不是 Temp 文件夹中。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-20T22:38:57.307

使用 getDocumentBase() 加载资源的一种解决方法，您可以使用类的 getResource 获取 URL，该类获取相对于该类的资源。

```
URL base = img.class.getResource("/data/winter.jpg");
Image img = ImageIO.read(base); 
```

其中 data 是您的情况下 Exam3 文件夹中的一个文件夹，其中包含此类文件。

# java - 在一个大的、稀疏的、嘈杂的体积中找到位置很近的点

> ID：14553385
> 
> 赞同：2
> 
> 时间：2013-01-27T23:06:09.430
> 
> 标签：java, distance

提前为文字墙道歉——我已经有一段时间没有完成编程了，可能有更好的术语来表达我的意思。搜索了我能想到的所有内容，但没有在网站上找到任何相关问题，但也许我们可以找到更好的条款，因此我们将不胜感激任何帮助！

**我正在尝试提高查找相隔不超过一组[出租车/曼哈顿距离](http://en.wikipedia.org/wiki/Taxicab_geometry)的对象组的性能。** 所以，假设我的距离是“x”，点“a”是距离点“b”的 x 个单位，点“b”是距离“c”的 x 个单位，点“c”是距离点“a”的 x+3 个单位; 我应该将 a、b 和 c 标识为一个组，以及其中任何一个 x 单位内的任何对象（等等）。

我已经确定了几种用于查找这些组的简单算法，但我认为性能可以更好。聚类算法似乎在这里应该是相关的，但我一直无法找到适合我的问题的算法。我也不确定我是否尽可能有效地存储数据——现在我只是在处理静态数据，所以我可以在开始之前将它复制成我需要的任何形式；但是在未来，我希望有一个可以有效地处理添加和删除点的实现。以下是详细信息：

*   我从两个无序的 ArrayLists 对象开始，它们的许多属性中有一个唯一的整数坐标三元组 (x,y,z)。
*   物体稀疏地分散在一个非常大的体积上（比如 5 亿立方单位），我设定的距离相对较小（<15 个单位）
*   我不需要找到大小为 1 的组，因此有很多“噪音”。在我的数据中，超过三个的组非常罕见。
*   超过 90% 的时间附近的对象是在相似的时间添加到 ArrayLists 中的，所以如果可以的话，我想利用这个事实。
*   另一个有用的事实是，一个维度 (y) 的范围大约是其他两个维度的 1/10，因此二维算法可能是一种更快的开始方式，如有必要，稍后会拆分二维组。
*   找到这些组后，我需要访问组中的每个对象以进行函数调用，因此我需要识别对象，而不仅仅是坐标。

**如何改进仅使用偏移网格循环遍历 ArrayLists 两次然后重新分析我创建的组的性能？** 我的语言是 Java，但算法比特定类型和库更重要（尽管我也会接受这些！）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T23:19:48.273

我认为您正在尝试实现[Range search](http://en.wikipedia.org/wiki/Range_search)的特殊情况。也许将您的数据存储在[kd 树](http://en.wikipedia.org/wiki/K-d_tree)中会很有用。至少，您应该能够轻松地提取位于围绕您正在搜索的点之一的超立方体中的点。然后您可以检查它们的距离是否符合要求。

另请参阅：“ [Fixed-Radius Near Neighbors and Geometric Basics](http://www.cs.wustl.edu/~pless/546/lectures/Lecture2.pdf) ”了解一些解决方案。

# makefile - automake 环境变量条件

> ID：14553389
> 
> 赞同：3
> 
> 时间：2013-01-27T23:06:36.897
> 
> 标签：makefile, conditional, environment-variables, autotools, automake

我有一个文件 Makefile.am 我用来生成一个 Makefile。在生成的 Makefile 中，我想要类似的东西：

```
ifndef SOURCECODEPATH
   SOURCECODEPATH := /home/root/source_code_path
endif 
```

看起来很简单，有人知道我该怎么做吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-28T00:37:31.330

使用[AM_CONDITIONAL](http://www.gnu.org/software/automake/manual/html_node/Usage-of-Conditionals.html)宏`configure.ac`。

该脚本设置了一个您可以测试的变量，例如，如果启用了条件，则该变量设置为非空：`AM_CONDITIONAL([ENABLE_SOURCECODEPATH], [test "x$ac_srcpath" != "x"])`

然后在`Makefile.am`：

```
if !ENABLE_SOURCECODEPATH
SOURCECODEPATH = ...
endif 
```

但是，由于如果未定义变量，您将显式定义变量，因此您可能应该`configure.ac`无论如何定义它，使用`AC_SUBST(SRCPATH, $ac_srcpath)`：

```
SOURCECODEPATH = @SRCPATH@ # or $(SRCPATH) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-29T15:48:50.143

您可以简单地使用 Makefile.am 包含的辅助生成文件（以及它的扩展）。

生成文件.am：

```
#...
include Makefile.env
#... 
```

和 Makefile.env：

```
ifndef SOURCECODEPATH
   SOURCECODEPATH := /home/root/source_code_path
endif 
```

`automake`不会触及（或尝试解析）`include`d Makefile.env

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T18:31:21.313

实际上，正如[http://www.gnu.org/software/make/manual/make.html#Flavors](http://www.gnu.org/software/make/manual/make.html#Flavors)所说，`?=`用于用`=`. 如果您需要为用 声明的变量设置默认值`:=`，请使用如下构造：

```
ifeq ($(origin SOURCECODEPATH), undefined)
  SOURCECODEPATH := /home/root/source_code_path
endif 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-28T16:54:51.427

以下解决方案至少应适用于 GNU Make 和 BSD Make。Brett Hale的[autotools 解决方案](https://stackoverflow.com/a/14553976/1257631)应该适用于任何地方，但它要复杂得多。

```
SOURCECODEPATH?=/home/root/source_code_path 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-28T19:04:35.200

你真的不应该使用 automake 来生成不可移植的 makefile，但是如果你真的想这样做来生成一个用于 GNU make 的 Makefile，那么你可以简单地在之前添加一个空格`endif`：

```
ifndef SOURCECODEPATH
   SOURCECODEPATH := /home/root/source_code_path
 endif 
```

如果`e`不在第一列，Automake 将不会尝试解析`endif`为 automake 条件的结尾，而是将文本逐字复制到 Makefile。GNU-make 将识别带有空格的条件（至少，3.80 识别它。我没有尝试过任何其他的。）

# javascript - 使用 jQuery-ui 滑块或可选时触发的函数

> ID：14553390
> 
> 赞同：1
> 
> 时间：2013-01-27T23:06:41.923
> 
> 标签：javascript, jquery-ui, uislider, jquery-ui-selectable

当使用滑块或选择时，会改变各个变量。我想在另一个函数中使用滑块/可选函数之外的这些变量。

我有这个滑块：

```
handlevalues=[300,3000]
$(function() {
$( "#slider-range" ).slider({
range: true,
min: 300,
max: 3000,
values: [ 300, 3000 ],
step: 10,
slide: function( event, ui ) {
$( "#amount" ).val( "$" + ui.values[ 0 ] + " - $" + ui.values[ 1 ] );
  handlevalues=($("#slider-range").slider('values'));

}
});
$( "#amount" ).val( "$" + $( "#slider-range" ).slider( "values", 0 ) +
" - $" + $( "#slider-range" ).slider( "values", 1 ) );
} ); 
```

这个可选：

```
var whatsselected=[1,2,3,4,5,6]
$(function() {
        $("#selectable").bind("mousedown", function(e) {
            e.metaKey = true;
        }).selectable({
            stop: function() {}
        });
    }); 
```

每当用户移动滑块或进行选择时，我都需要出现这个。

```
console.log(handlevalues)
console.log(whatsselected) 
```

是在可选函数中定义的`var whatsselected=`，但我认为没有必要在此处发布。我想要一个功能来听这两件事，因为会有很多滑块和可选择项。我知道我可以在滑块/可选的代码中添加一个函数，但我需要它们在外面。

我什至没有费心发布我的尝试。我是新手，我自己还没有创建滑块。`var handlevalues`我想到了在何时或更改时触发控制台消息的功能，`var whatsselected`但我不确定如何/是否可能，考虑到它应该听两个变量。

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T09:14:59.110

对于滑块：

在某处有隐藏字段：

```
<input type="hidden" id="leftValue" value="0" /> 
<input type="hidden" id="rightValue" value="0" /> 
```

为您的滑块函数添加“更改”回调：

```
$(function() {
$( "#slider-range" ).slider({
range: true,
min: 300,
max: 3000,
values: [ 300, 3000 ],
step: 10,
slide: function( event, ui ) {
$( "#amount" ).val( "$" + ui.values[ 0 ] + " - $" + ui.values[ 1 ] );
  handlevalues=($("#slider-range").slider('values'));

},
 change: function(event, ui) {

 $('#leftValue').val(ui.values[0]); //left value
 $('#rightValue').val(ui.values[0]); //left value

 }
}); 
```

至于可选择的，我不熟悉它，但它可能是类似的东西。

希望能帮助到你..

# svg - 被 SVG viewBox、宽度、高度等困扰

> ID：14553392
> 
> 赞同：23
> 
> 时间：2013-01-27T23:06:44.993
> 
> 标签：svg

如果我对 SVG 的理解是正确的，那么以下两个 SVG 描述会产生相同的图像，但事实并非如此。（注意：这两个代码列表的不同之处仅在于其`svg`标签中的坐标值。更具体地说，对于第一个列表中的每个 ( *x* , *y* ) 对，第二个列表中都有一个 ( *x* -205, *y* -55) 对。）

```
<!DOCTYPE html>
<html>
  <head><title>title</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  </head>
  <body>

    <svg xmlns="http://www.w3.org/2000/svg" version="1.1"
     x="0" y="0" width="210" height="60" viewBox="0 0 210 60">

      <g style="stroke: black; fill: none;">
        <path d="M 5 5 Q 105 55 205 55"/>
      </g>

    </svg>

  </body>
</html> 
```

```
<!DOCTYPE html>
<html>
  <head><title>title</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  </head>
  <body>

    <svg xmlns="http://www.w3.org/2000/svg" version="1.1"
     x="-205" y="-55" width="210" height="60" viewBox="-205 -55 5 5">

      <g style="stroke: black; fill: none;">
        <path d="M -200 -50 Q -100 0 0 0"/>
      </g>

    </svg>

  </body>
</html> 
```

事实上，至少在 Firefox 看来，它们看起来完全不同。我对它们的预期渲染是 Firefox 为第一个提供的（即，一条从左到右缓慢向下倾斜的曲线，初始斜率为 -1/2，最终斜率为 0）。我完全被 FF 为第二个生成的东西弄糊涂了，因为，AFAICT，第二个规范是一个简单的批发（“刚性”）翻译，由第一个的向量（-205，-55）。

> 为什么两个显示器看起来不一样？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2014-08-01T03:43:48.210

有关 viewBox 的详细信息，请参见本文中的（唯一）图：[https ://web.archive.org/web/20140119030353/https://software.intel.com/en-us/html5/blogs/viewbox- a-window-into-the-soul-of-svg](https://web.archive.org/web/20140119030353/https://software.intel.com/en-us/html5/blogs/viewbox-a-window-into-the-soul-of-svg)，为方便起见，内联如下：

![简而言之，viewBox](../Images/4a1ac510d6f8d094efa44de8cd8a6012.png)

那张图值得1000字的解释。

宽度和高度参数，也就是 W3C 术语中的视口是另一回事。但是你并没有改变上面例子中的那些。有一个稍微复杂的算法来确定 SVG 的宽度和高度是否真的有任何作用，因为它们可以被例如`<object>`将 SVG 嵌入 HTML 页面的标签覆盖。[http://www.w3.org/TR/SVG/coords.html#ViewportSpace](http://www.w3.org/TR/SVG/coords.html#ViewportSpace)解释了更多极端案例。有关此视口问题的更直观（也许更平易近人）的解释，您还可以查阅 Inkscape 手册[http://tavmjong.free.fr/INKSCAPE/MANUAL/html/Web-SVG-Positioning.html](http://tavmjong.free.fr/INKSCAPE/MANUAL/html/Web-SVG-Positioning.html)（作为除此之外，还有一个扩展可用于从 Inkscape 直观地设置 viewBox[http://pernsteiner.org/inkscape/viewbox/；](http://pernsteiner.org/inkscape/viewbox/;)您实际上不必像 Inkscape 手册 [仍然] 所说的那样直接编辑 XML。）

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-01-28T05:01:55.243

因为 viewbox 的坐标不是 x1, y1, x2, y2 - 它们是[minx, miny, width 和 height](http://www.w3.org/TR/SVG/coords.html#ViewBoxAttribute)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-04T22:51:42.693

这一点很晚，但为了澄清迈克尔在上面为未来的观众提出的一点：

如果你在这里改变一些数字，但不是很多，你会得到相同的结果。

您遇到的一个问题是您认为这`min-x + width`在任一 svg 节点中应该是相同的。`min-x`并且`min-y`是您的最左边和最上面的坐标`viewBox`- 有效地将`0, 0`位置更改为`min-x, min-y`, 并且实际上只与`viewBox`( 并通过您`path`的`d`属性扩展) 的坐标系相关，而不是与`viewBox`自身的大小有关。

此外，节点的 x 和 y 位置`svg`有效但被忽略，与任何位置无关。

所以要让你的第二条路径看起来像你的第一条，你可以去掉`x`and`y`属性，并改变里面的`width`and`height`数字`viewBox`来匹配第一个：

```
<svg xmlns="http://www.w3.org/2000/svg" version="1.1"
 width="210" height="60" viewBox="-205 -55 210 60">

  <g style="stroke: black; fill: none;">
    <path d="M -200 -50 Q -100 0 0 0"/>
  </g>

</svg> 
```

# android - 无法使用 sleep-Timer 和 TimerTask 在 Android 中停止线程

> ID：14553395
> 
> 赞同：0
> 
> 时间：2013-01-27T23:07:38.520
> 
> 标签：android, multithreading, networking

我想在一段时间循环中从网络获取一些数据，直到用户单击屏幕上的按钮，然后停止接收数据并显示另一个活动。我收到的内容如下：

```
Thread listUpdater; 
```

...

```
listUpdater = new Thread() {
    @Override
    public void run() {
        TimerTask task = new UpdateListTask();

        while (true) {
            task.run();
        }
    }
};
listUpdater.start(); 
```

...

```
public class UpdateListTask extends TimerTask {

     public UpdateListTask() {
     }

     @Override
     public void run() { 
        // get some data from network (asynchronically)
     }
} 
```

用户单击按钮后，我将运行以下代码：

```
try {
    listUpdater.join();
} catch (InterruptedException e) {
    e.printStackTrace();
} 
```

但它不会停止新线程/计时器任务中的运行循环，所有代码仍在运行——这是我不想要的。我能做些什么来停止正在运行的代码？有没有办法停止线程？或者我可以做一些线程间布尔变量设置来停止while循环吗？

我尝试了一切，但没有成功。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T23:20:20.473

.join 等待线程完成。你的线程永远不会结束，所以一切都会中断。

实际停止线程的一种简单方法是：

```
volatile boolean updateList;
Thread listUpdater; 
```

...

```
listUpdater = new Thread() {
    @Override
    public void run() {
        TimerTask task = new UpdateListTask();

        while (updateList) {
            task.run();
        }
    }
};
updateList = true;
listUpdater.start(); 
```

和

```
try {
    updateList = false;
    listUpdater.join();
} catch (InterruptedException e) {
    e.printStackTrace();
} 
```

这样，您可以使用布尔变量作为标志来控制 listUpdater 线程的执行。每次要重新启动线程时，请记住将其设置回 true。

# java - 错误的类型推断

> ID：14553397
> 
> 赞同：0
> 
> 时间：2013-01-27T23:07:46.633
> 
> 标签：java, eclipse, generics

我有以下代码：

```
SomeInterface self = sessionContext.getBusinessObject(sessionContext.getInvokedBusinessInterface()); 
```

并遵循方法签名（*来自 eclipse 工具提示（不是真实代码）*）：

```
<Object> Object javax.ejb.SessionContext.getBusinessObject(Class<Object> arg0) throws IllegalStateException 
```

由于某种原因，返回类型被解析为对象。这很奇怪，因为 eclipse 没有将此行标记为错误，但是 ant 和 maven 构建器在此行上失败了，说 Object 不能转换为 SomeInterface。

我有几个问题：

*   我的代码有什么问题，所以类型推断不正确（实际上它不应该是 Object，因为变量类型是`SomeInterface`）？
*   为什么在 Eclipse（错误）中没有将行标记为错误？

我有以下示例，该示例在 Eclipse 下正确编译，但在 Maven 中失败：

```
public class TestClass implements SomeInterface {
    private Resolver resolver;

    /**
     * 
     */
    @SuppressWarnings("unchecked")
    public TestClass() {
        SomeInterface c = resolver.some(resolver.someClass());
    }

    @Override
    public void something() {
    }
}

class Resolver {
    public <T> T some(final Class<T> c) {
        return null;
    }

    public Class someClass() {
        return null;
    }
}

interface SomeInterface {
    void something();
} 
```

这里的类型是正确推断的（*来自 eclipse 工具提示（不是真正的代码）*）：

```
 <SomeInterface> SomeInterface Resolver.some(Class<SomeInterface> c) 
```

但是这个类仍然不能用maven编译器编译。

我正在使用日食朱诺。

**UPD**

Maven失败：

```
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:2.3.2:compile (default-compile) on project jpharm-server: Compilation failure
[ERROR] TestClass.java:[21,39] incompatible types
[ERROR] found   : java.lang.Object
[ERROR] required: SomeInterface 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T23:11:46.403

你可以写：

```
SomeInterface c = resolver.<SomeInterface> some(resolver.someClass()); 
```

帮助编译器。

您给出的具体示例不应该编译。编译器在应用类型推断时，会尝试找到适合语句所有操作数的最具体的类型。在这里，`resolver.someClass()`返回 a`Class`可以是任何类，即它确实是 a`Class<? extends Object>`并且没有办法推断它`? extends Object`是 a `SomeInterface`。

例如，`someClass`很可能是：

```
public Class someClass() {
    return Object.class;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T23:24:58.417

问题是这一行：

```
public Class someClass() { 
```

这将返回一个原始类型`Class`对象，它*实际上*与`Class<? extends Object>`. 您也应该使此方法通用：

```
public Class<? extends T> someClass() { 
```

并调用它：

```
resolver.<SomeInterface>someClass(); 
```

理想情况下，您会在您的签名中填写一个实际类型，`getInvokedBusinessInterface()`以便它返回一个`Class<? extends SomeInterface>`.

# javascript - 在多个地方使用 Jquery 显示输入字段

> ID：14553398
> 
> 赞同：0
> 
> 时间：2013-01-27T23:07:47.303
> 
> 标签：javascript, jquery, forms, select, input

我有一个包含 6 个步骤的订单，由隐藏的 div 组成。每个输入字段和选择字段都有自己的 ID。

所有值都必须显示 1 次，除了带有 ID 的选择：catid，这个必须显示在每一页上。但是下面的代码只显示在一个 div 中。

谁能帮我？

使用此 jquery，我将显示最后一步的所有值，这是一种总结。

```
<script>
$("text1preview").draggable({ containment: '#dragcontainer' });
$("address1preview").draggable({ containment: '#dragcontainer' });
$("titlepreview").draggable({ containment: '#dragcontainer' });
$("zipcodepreview").draggable({ containment: '#dragcontainer' });
$("descriptionpreview").draggable({ containment: '#dragcontainer' });
$("wijkpreview").draggable({ containment: '#dragcontainer' });
$("address2preview").draggable({ containment: '#dragcontainer' });
$("tagspreview").draggable({ containment: '#dragcontainer' });
$("catidpreview").draggable({ containment: '#dragcontainer' });
$("pricepreview").draggable({ containment: '#dragcontainer' });
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T00:45:06.497

要显示选定的文本值，您可以使用 jQuerys .text(); 如下例所示

```
$("#myselect :selected").text(); 
```

更新示例：http:
[//jsfiddle.net/davidoleary/cTDvd/2/](http://jsfiddle.net/davidoleary/cTDvd/2/)

# c - 测试 ARM CPU 模拟器

> ID：14553401
> 
> 赞同：2
> 
> 时间：2013-01-27T23:08:00.030
> 
> 标签：c, assembly, arm, emulation

我目前正在编写一个 Gameboy Advance 模拟器，纯粹是为了好玩。它有一个`ARM7TDMI`CPU，我已经编写了大部分 CPU 仿真代码。我的问题是，如何进行测试？

在随机 GBA 软件上测试它并没有太大帮助 - 程序可能会由于与 CPU 无关的原因而崩溃，最好逐个测试，而不是一起测试。

是否有任何可用的程序可以测试`ARM`CPU，尤其是指令集？我查看了几个`ARM`模拟器的源代码，但没有找到我要找的东西。如果没有，我将编写自己的程序，但很难使测试全面。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T23:39:34.907

如果您的目的是编写一个全系统仿真器，那么在您担心 CPU 仿真是否有效之前，我会找出您至少需要支持的其他系统并实施它们。图形和内存控制器是最重要的。它们也更容易为它们编写单元测试，并且如果您可以说服自己它们工作正常，那么您将拥有合适的工具来测试您的 CPU 仿真。

话虽如此，如果您确实想先测试 CPU 仿真，我会添加一些调试代码来反汇编指令并在每条指令之前打印所有寄存器的值（可能还有它们可能指向的内存中的值）。然后尝试运行一些游戏。即使它们不会走得太远，您也可以查看大量数据来评估仿真代码是否对寄存器/内存状态进行了正确的更改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-28T15:46:06.347

我同意 R. 首先测试 cpu，和/或与仿真硬件分开测试。有一个坚实的基础开始。

我编写了指令集模拟器并测试了它们以及正在开发的真实处理器。

有明显的定向测试，针对特定指令来查看它们是否有效。例如，仔细查看 ARM 文档，移位具有 if-then-else 定义，如果移位等于 32 则不要移位或类似的东西，创建一个测试来验证 if-then-else 中的每个条件。

无论什么指令集，标志总是很棘手（当然，没有标志的除外）。让您的有符号和无符号溢出正确（进位 = 无符号溢出）以进行加法。然后弄清楚你的目标处理器如何处理减法。通常，您希望反转进位和第二个操作数（进入加法器），其中一种架构与另一种不同的是进位，有些反转进位以进行减法，有些则不。如果有借位减法指令，那么无论进位规则是否会影响借位减法，无论它是否在进位时反转。幸运的是，有 C 编译器可以帮助解决这个问题，假设它们的输出适用于真实处理器（其中的一部分）工作是从处理器错误中整理出编译器错误，并且您会遇到编译器错误）。全零、全一和全零 (0x80000000) 的特殊情况应进行定向测试，以确保它们的（有符号）溢出正常工作。某些操作仅影响某些标志或某些操作将某些标志归零等。确保您创建情况来测试它。ARM 还允许任何有条件的指令和 alu 指令选择性地修改标志，从而使情况变得更糟。

我喜欢使用 zlib 和 jpeg 解码器、mp3 解码器，任何开源的并且可以以裸机方式编译的东西（是的，这些已经提到过可以！），这意味着在这种情况下没有操作系统。例如，现在 zlib 在混合 long 和 int 方面是一场噩梦，因此取决于您的编译器当天在主机上的工作方式（某些编译器，有时使用主机架构而不是目标架构来调整变量的大小交叉编译，这很烦人）。我什至会为它所做的所有类型跳转调用 zlib buggy，所以我已经减少使用它进行测试，因为调试编译所花费的时间而不是它返回的值推动处理器，因为它不推动处理器非常难（尽管我发现使用它的处理器错误）。对于有损的 jpeg 和 mp3 解码器，您需要预先计算的答案，在您的主机上计算。除非您想使用软浮点数，否则您需要整数解决方案而不是浮点数。

在使用编译器进行测试时，了解一些事情，首先你要尝试所有的优化，因为每个编译的测试都有 -O0、-O1、-O2 和 -O3 版本，因为它会创建不同的指令混合并推送处理器以不同的方式。请注意，尽管这可能是您开始遇到编译器错误的地方。同一个编译器的不同版本和不同的编译器会产生不同的输出，不同的指令混合，如果可能的话，最好尽可能多地获得不同的编译器，使用 evals 或其他。在评估编译器时，我发现了许多编译器错误，以至于他们给了我一段时间的完整版本的免费副本。YMMV。另外，这对你来说可能是不可能的，不同的人（不受编码标准严格控制）产生不同的指令组合（asm或更高），在你拥有每条指令之后，理论上，在孤立的情况下工作，你可能会发现当某个指令跟随另一个指令时仍然存在错误，所以尝试创建指令组合很有用，即使您从未发现错误，这也是一个很好的验证。正如我已经提到的那样编译代码，但是您可能还想创建一个 alu 操作序列，例如使用随机发生器来选择操作以及源和目标寄存器（使用混合标志的操作），并在可能的情况下运行该代码在真正的处理器上然后在你的处理器上运行它，看看你是否得到相同的结果。您可能会发现当某个指令跟随另一个指令时仍然存在错误，因此尝试创建指令混合很有用，即使您从未发现错误，这也是一个很好的验证。正如我已经提到的那样编译代码，但是您可能还想创建一个 alu 操作序列，例如使用随机发生器来选择操作以及源和目标寄存器（使用混合标志的操作），并在可能的情况下运行该代码在真正的处理器上然后在你的处理器上运行它，看看你是否得到相同的结果。您可能会发现当某个指令跟随另一个指令时仍然存在错误，因此尝试创建指令混合很有用，即使您从未发现错误，这也是一个很好的验证。正如我已经提到的那样编译代码，但是您可能还想创建一个 alu 操作序列，例如使用随机发生器来选择操作以及源和目标寄存器（使用混合标志的操作），并在可能的情况下运行该代码在真正的处理器上然后在你的处理器上运行它，看看你是否得到相同的结果。

我使用的一个处理器在硬件中构建了一个测试夹具，我可以在其中与测试夹具中的外围设备通信，这将 1）允许我以某种速率发送中断 2）为特定地址创建数据/预取中止。所以我做了一个 zlib 测试，在它运行的时候我用中断敲了它，然后在中断中我查看了指令的返回地址，并在几个字之后武装了预取中止，有时他们命中有时没有，这很好，关键是让主应用程序运行完美，尽管有中断（我会让中断正常继续，中止会解除，备份并让它重试）。至少，您应该能够通过中断来冲击您的测试应用程序，并确保它们继续运行。

不幸的是，GBA 中的大部分逻辑都是图形方面的，因此即使您在处理器上投入了大量精力，您仍然必须调试图形。您可以通过在伪内存解码器上放置一个测试接口来隔离该代码，并让主机应用程序访问虚拟外围设备，而不是总是必须模拟 arm 代码来执行此操作。归根结底，尽管我认为正在玩现成的游戏，这将是最困难的，是的，调试问题可能非常困难。我认为拥有一个坚实的 arm 核心将使调试更容易，少一件需要担心的事情，少一件问题的根源。

另一个问题是，由于 gba 的设计方式，通过在拇指模式下运行 arm 可以显着提升性能，因此您会看到许多拇指模式程序，这是要验证/调试的更多 arm 核心内容。混合模式等

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-27T23:41:10.397

QEMU 非常适合 ARM CPU/指令集。[Balau](http://balau82.wordpress.com/2010/02/28/hello-world-for-bare-metal-arm-using-qemu/)是入门的好文章。QEMU可以为很多广泛使用的硬件平台做Linux，甚至可以为少数ARM硬件平台做U-Boot/bare metal code。

y对于您的 Gameboy 模拟器，您的图形将如何显示？

# restsharp - RESTSharp GET 与正文

> ID：14553403
> 
> 赞同：2
> 
> 时间：2013-01-27T23:08:11.770
> 
> 标签：restsharp

我需要带有 RESTSharp GET 调用的正文元素 (JSON)，虽然这听起来不正确，但我没有其他选择，因为第三方 REST 服务提供商希望我发送 GET 请求，但它需要正文中的某些参数，

当我尝试使用 GET 方法在 RESTSharp 请求中使用 AddBody 时，它似乎没有在最终请求中包含正文（使用 Fiddler 检查时）

有没有办法用 JSON 正文创建 GET 请求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-24T21:03:25.293

我有同样的问题。我首先尝试更改 Restsharp 源代码，以便在 GET 请求中尝试编写正文部分。但是后来我得到了异常“无法发送具有这种动词类型的内容主体”，又进行了一次搜索：

[https://stackoverflow.com/a/3981584/2291894](https://stackoverflow.com/a/3981584/2291894)

似乎这在.net中无法实现

# facebook-graph-api - 使用 access_token 获取离线更新

> ID：14553406
> 
> 赞同：1
> 
> 时间：2013-01-27T23:08:47.527
> 
> 标签：facebook-graph-api, permissions, access-token

我正在构建将为 Facebook 用户提供新过滤器的应用程序。为了使这些过滤器起作用，我需要（从他的墙上）获取用户帖子，所以我设法让他们通过他们的 Facebook 帐户登录，并且我正在存储他们的 access_token 以便在实时更新到来时获取更新。

问题是 - 当用户浏览我的页面时，每个请求都允许我进行一次 Graph API 调用（用户授予我的应用程序的权限），但是当我尝试进行第二次调用时（当用户是，即阅读他最好的朋友的帖子）即使我提供了有效的 access_token，Graph API 也仅返回有关此用户的公共信息。

我能做些什么来克服这个问题吗？我正在拨打的电话示例：

```
/1198448946?access_token=token 
```

该令牌可以检查用户的电子邮件（我获得了所需的权限），但响应被删除了。当我尝试在 Graph API Explorer 中使用相同的 URI 时 - 它返回了我想要的响应（使用相同的 access_token！），但应用程序仍然只显示公共信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T23:30:03.517

您需要做的第一件事是阅读以下内容：

[https://developers.facebook.com/roadmap/offline-access-removal/](https://developers.facebook.com/roadmap/offline-access-removal/)

简短的回答是，您默认收到的令牌将是短暂的（1-2 小时）。Facebook 已取消离线访问权限，但您现在可以将短寿命令牌换成长寿命令牌（60 天）。您每次访问您的网站时更新此令牌以获得另外 60 天。

此资源应该可以帮助您了解访问令牌过期的原因。它还记录了在用户在场时检测到过期令牌时应采取的正确步骤。 [https://developers.facebook.com/docs/howtos/login/debugging-access-tokens/](https://developers.facebook.com/docs/howtos/login/debugging-access-tokens/)

# java - 如何一键查找和删除 MongoDb Collection Entity 并节省系统资源

> ID：14553408
> 
> 赞同：-1
> 
> 时间：2013-01-27T23:08:55.200
> 
> 标签：java, mongodb, morphia

我有一个 mongodb 集合，其中包含生命周期较短的实时数据。当我需要它们时，我也想删除一旦我找到，

这是使用 morphia 包装器的伪代码：

```
for(LogEntity log: mongo.find(LogEntity.class, "grabMe", true)){
    mongo.delete(mongo.createQuery(LogEntity.class).filter("logId", log.id));
    //Do work and dispose the log
} 
```

我正在对此进行一些测试，因为这是 Google GCM 的一部分，所以很难模拟重负载。

这是在每 2 秒`Runnable`喂一次的 a 中运行的。`ScheduledExecutorService` `scheduleAtFixedRate`

这会起作用还是有更好的方法来做到这一点。`find()`在这种情况下工作如何。我会通过从 find() 中删除来搞乱 find() 的内部数组吗？如果有很多`LogEntity`，我无法记住它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T09:10:38.420

生命周期短的重负载日志，我会选择 capped collection。在这种情况下，您无法删除上限集合中的文档。

另一方面，如果您想选择正常的收集来记录日志并进行定时清理，那么您的查找和删除循环会很慢。如果您的代码是`foreach item in collection.find(query) {collection.remove({_id:item._id};}`使用`collection.remove(query)`方法。

# heroku - Hirefire 不适用于 Heroku/Delayed Job/Mongoid - 最新版本

> ID：14553414
> 
> 赞同：1
> 
> 时间：2013-01-27T23:10:36.530
> 
> 标签：heroku, mongoid, delayed-job, hirefire

我正在使用[hirefire beta](https://manager.hirefire.io)来管理我的基于mongoid 的DJ 队列工作者——随着队列深度的变化添加和删除dynos。

问题是我得到的只是错误：

```
2013-01-27T23:07:14+00:00 app[web.1]: Started GET "/hirefire/d98c3c1f840e8b903j3od03kka3f110b1779ccb5/info" for 5.19.20.84 at 2013-01-27 23:07:14 +0000
2013-01-27T23:07:14+00:00 app[web.1]:
2013-01-27T23:07:14+00:00 app[web.1]: ArgumentError (wrong number of arguments (2 for 1)):
2013-01-27T23:07:14+00:00 app[web.1]:   config/initializers/hirefire.rb:3:in `block (2 levels) in <top (required)>' 
```

我的版本：

```
Using rails (3.2.11)
Using delayed_job (3.0.4)
Using delayed_job_mongoid (2.0.0)
Using mongoid (3.0.19) 
```

`config/initializers/hirefire.rb`：

```
HireFire::Resource.configure do |config|
  config.dyno(:worker) do
    HireFire::Macro::Delayed::Job.queue
  end
end 
```

有什么建议么？我尝试了各种我能找到的建议，所有这些都导致了各种其他错误并且没有进展。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-09T08:06:30.397

对我来说，这是由于仍然安装了 ActiveRecord，Mongoid 安装有一些关于从您的应用程序中删除 ActiveRecord 的详细信息。

[http://mongoid.org/en/mongoid/docs/installation.html#installation](http://mongoid.org/en/mongoid/docs/installation.html#installation)

# c++ - OpenGL：在顶点停止光线的简单方法？

> ID：14553415
> 
> 赞同：0
> 
> 时间：2013-01-27T23:11:07.830
> 
> 标签：c++, opengl, vertex, lighting

我有一个用 OpenGL 构建的场景。当我的灯在房间中央时，房间外面就亮了。有什么简单的方法可以让 OpenGL 在顶点处停止照明，还是需要复杂的计算。以下是我的蹩脚、快速场景的照片，显示了问这个问题时的照明情况：![](../Images/f7a4424f2f03d91c7f69aed0da93cc8b.png)

![](../Images/fc171e1376d6006c16ccae997cf76bf9.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T23:23:21.283

本质上，您希望房间的墙壁投下阴影。当您希望对象的外部不被照亮时，这就是您想要的。

图形中的阴影通常是一个*相当困难的问题*。有很多好的和快速的解决方案，但不是两者兼而有之——任何一种解决方案都将是两者之间的权衡。SIGGRAPH[充满](http://visual-computing.intel-research.net/art/publications/sdsm/)了真正聪明的人试图解决这个问题的[各种](http://s2012.siggraph.org/attendees/sessions/efficient-real-time-shadows)[论文。](http://www-graphics.stanford.edu/papers/deepshadows/)

如果你想要一些快速而肮脏的东西，[阴影贴图](http://en.wikipedia.org/wiki/Shadow_mapping)并不是非常困难（至少是简单的那种），但它并不精确。你会在你的对象和墙壁的交叉处看到文物，例如。为了精确起见，[模板阴影](http://en.wikipedia.org/wiki/Stencil_shadows)会起作用，但你会有硬边阴影。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-30T18:52:09.377

这里的一个解决方案可能是以某种方式创作几何图形，即对象不会突出到墙外（或将它们分成内部/外部部分）。然后用不同的灯光渲染内部和外部。

如果一切都会给一切投下阴影，你就不会有问题。

如果灯光是静态的，您可能需要考虑预先计算（烘焙）光照（连同阴影）。您可以在许多 3D 包中执行此操作，从编程的角度来看，这可能是最简单的解决方案。

如果你有一个针对每盏灯的实时渲染阴影的通用解决方案，那也可以解决你的问题，但这是一项具有挑战性的任务，而且如果你想保持良好的帧，它也可能不是最佳选择——率。

如果您想了解实时阴影渲染，我建议您查看阴影贴图——它们通常是当今大多数游戏中使用的解决方案。请注意，对于点光源，您需要为立方体贴图的 6 个面渲染阴影贴图。出于实际目的，您应该真正考虑哪些灯光真正需要投射阴影，并做出某种权衡。

# jsf - PrimeFaces CSS 看起来'n'feel 缺失和 JS “未捕获的参考错误：PrimeFaces 未定义”

> ID：14553417
> 
> 赞同：5
> 
> 时间：2013-01-27T23:11:14.343
> 
> 标签：jsf, primefaces

我正在尝试使用 Primefaces 的 Picklist。当页面被渲染时，Chrome 中的 javascript 引擎找不到 Primefaces 对象。我收到以下错误“未捕获的 ReferenceError：未定义 PrimeFaces”。我是否缺少在我的 .xhtml 文件中包含任何资源（js）？请指教。谢谢。

Xhtml

```
<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:ui="http://java.sun.com/jsf/facelets">
<head>
<link rel="stylesheet" type="text/css"
    href="../jquery-ui-1.8.23.custom/css/ui-lightness/jquery-ui-1.8.23.custom.css" />
<link rel="stylesheet" type="text/css" href="css/form.css" media="all" />
<script src="../jquery-ui-1.8.23.custom/js/jquery-1.8.0.min.js"></script>
<script
    src="../jquery-ui-1.8.23.custom/js/jquery-ui-1.8.23.custom.min.js"></script>

</head>
<h:body>
<form id="form_486588" class="appnitro" method="post">
            <div class="form_description"></div>
            <p:pickList id="pickList" value="#{editorsMB.editors}" var="editor"
                itemLabel="#{editor}" itemValue="#{editor}" />
            <p:commandButton id="citySubmit" value="Submit"
                style="margin-top:5px" />
        </form>
</h:body>
</html> 
```

托管豆

```
import java.util.ArrayList;
import java.util.List;
import javax.faces.bean.ManagedBean;
import javax.faces.bean.SessionScoped;
import org.primefaces.model.DualListModel;

@ManagedBean(name = "editorsMB")
@SessionScoped
public class AdminEditorsBean {

    private DualListModel<String> editors;  

    public AdminEditorsBean(){
    List<String> adminsSource = new ArrayList<String>();  
    List<String> adminsTarget = new ArrayList<String>();  

    adminsSource.add("aaa");  
    adminsTarget.add("target1");
    editors = new DualListModel<String>(adminsSource, adminsTarget);  
    }

    public DualListModel<String> getEditors() {  
        return editors;    
}  
    public void setEditors(DualListModel<String> editors) {  
        this.editors = editors;  
    }  

} 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-01-28T19:45:37.043

PrimeFaces 将在`<h:head>`.

但是，您没有该标签。你有一个“纯 HTML” `<head>`。相应地修复它：

```
<html>
    <h:head>
        ...
    </h:head>
    <h:body>
        ...
    </h:body>
</html> 
```

这个错误也应该记录在服务器日志中，如下所示：

> [一个或多个资源的目标是“头”但未在视图中定义“头”组件](https://stackoverflow.com/questions/18940644/one-or-more-resources-has-the-target-of-head-but-not-head-component-has-been)

另请参阅[如何使用 JSF 2.0 Facelets 在 XHTML 中包含另一个 XHTML？](https://stackoverflow.com/questions/4792862/how-to-include-another-xhtml-in-xhtml-using-jsf-2-0-facelets)以及[何时使用 <ui:include>、标记文件、复合组件和/或自定义组件？](https://stackoverflow.com/questions/6822000/when-to-use-uiinclude-tag-files-composite-components-and-or-custom-componen)有关创作 JSF/Facelets 页面的各种正确示例。

* * *

**与具体问题无关**：PrimeFaces 作为一个基于 jQuery 的 JSF 组件库，已经捆绑了 jQuery 和 jQuery UI。您应该从页面中删除手动包含的脚本以避免冲突。另请参阅[将 jQuery 添加到 PrimeFaces 导致 Uncaught TypeError over all place](https://stackoverflow.com/questions/16166039/adding-jquery-to-primefaces-results-in-uncaught-typeerror-over-all-place)。

立即抓住机会将冗长`<link>`的内容替换为`<h:outputStylesheet>`. 另请参阅[如何在 Facelets 模板中引用 CSS / JS / 图像资源？](https://stackoverflow.com/questions/8367421/how-to-reference-css-js-image-resource-in-facelets-template)

# matlab - 在Matlab中将圆锥螺旋投影到圆锥上？

> ID：14553420
> 
> 赞同：0
> 
> 时间：2013-01-27T23:11:37.557
> 
> 标签：matlab, math, geometry

![在此处输入图像描述](../Images/05a20d6c483205a03191534d544ba471.png) ![在此处输入图像描述](../Images/8349d58547be3dd019e7099b7a24441b.png)

> 假设你有`f(x)=x-floor(x)`.
> 
> ![在此处输入图像描述](../Images/fd6dcd1d139e66d783a1d00d26284941.png)
> 
> 通过这种方式，您可以通过将顶部和底部粘合在一起然后将左侧挤压为零来生成凹槽 - 现在您有一个锥形螺旋：线围绕锥形旋转直到它碰到底部。你已经有了圆锥螺旋方程的一种形式，即`x=a*cos(a); y=a*sin(a); z=a`。现在像 [这里](https://chat.stackexchange.com/transcript/message/7868186#7868186)：
> 
> **你如何在 Matlab 中将锥形螺旋投影到圆锥上？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T06:17:03.420

我会在不使用的情况下解决您的问题`plot3`，而是使用[`meshgrid`](http://www.mathworks.com/help/matlab/ref/meshgrid.html)and [`sinc`](http://www.mathworks.com/help/signal/ref/sinc.html)。请注意，这`sinc`是一个 matlab 内置的函数，`sin(x)./x`例如：

![在此处输入图像描述](../Images/e950f63cdfbcd99d57ac584c0c6d52a6.png)

所以在一维中，如果我理解正确，你想`sinc(x)`在`sqrt(x.^2)`. 你的问题的问题是你提到了点积的投影，但是点积会降低维度，所以两个向量的点积给出一个标量，两个二维表面的一个向量，所以我不明白什么你的意思是。从您添加的二维图中，我将问题解释为将一个功能与另一个功能“搭配”，例如...

这是实现：

```
N=64;
[x y]=meshgrid(linspace(-3*pi,3*pi,N),linspace(-3*pi,3*pi,N));
t=sqrt(x.^2+y.^2);
f=t+2*sinc(t);

subplot(1,2,1)
mesh(x,y,f) ;      axis vis3d

subplot(1,2,2)
mesh(x,y,f)
view(0,0) ;  axis square
colormap bone 
```

![在此处输入图像描述](../Images/27a5af8fd76bebb0e87e18cb887f1fe6.png)

中的因素`2`是`sinc`为了更好地可视化 的波动`sinc`。

# php - 使用书签进行网络抓取 - 从页面的 jquery 弹出窗口中获取 html

> ID：14553421
> 
> 赞同：0
> 
> 时间：2013-01-27T23:11:41.513
> 
> 标签：php, jquery, web-scraping

网站：freepeople.com/clothes/

当我点击页面下方“此类别中的顶级款式”下的任何项目时，会出现一个带有产品图片和价格的弹出窗口。

使用我在 PHP 和 JS 中创建的小书签，我该如何捕获这个弹出窗口的 HTML？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T12:23:32.903

弹出窗口是通过[AJAX](http://en.wikipedia.org/wiki/Ajax_%28programming%29)加载的，这意味着您需要进行另一个 http 调用（在 php 中）才能获取弹出窗口中的信息。在 freepeople.com/clothes/ 的情况下，该站点已努力支持较旧的浏览器，因此链接也是实际链接，而不仅仅是 javascript ajax 调用，因此您可以忽略 ajax 而只关注链接本身。

尝试查看禁用 javascript 的站点。

例如，如果您按表中的第一个链接（在发布帖子时），您将到达 /cmCategoryID/8a61524b-907c-474c-ab37-f357c9ae11e3/&detailcross/?=1359375343410">http://www .freepeople.com/Big-Dipper-Oversized-Tee// *cmCategoryID/8a61524b-907c-474c-ab37-f357c9ae11e3/&detailcross/?* =1359375343410。

# ruby-on-rails - 从 Ruby on Rails 中的现有嵌套对象/模态创建嵌套对象/模态

> ID：14553433
> 
> 赞同：0
> 
> 时间：2013-01-27T23:13:39.377
> 
> 标签：ruby-on-rails, ruby-on-rails-3, nested-forms, nested-attributes, cocoon-gem

我在我的项目中使用深度嵌套模型（使用 simple_form 和 cocoon）。只要所有嵌套对象都是新的，一切都会正常工作。

我的问题是，我想从现有（嵌套）对象创建嵌套对象。

## 这是我的模型

```
class Application < ActiveRecord::Base
    belongs_to :submitter
    has_one :composition

    accepts_nested_attributes_for :submitter, :composition
end

class Submitter < ActiveRecord::Base
    has_one :spouse
    has_many :children
    has_many :receipts
    has_many :applications

    accepts_nested_attributes_for :spouse, :children, :receipts, :applications
end

class Child < ActiveRecord::Base
    belongs_to :submitter
    has_many :receipts
end 
```

工作流程如下：

> 新应用程序 --> 新提交者 --> 新子项

所有这些都可以使用一种形式创建。

此外，我还想实现以下过程：

> 新应用程序 -->**现有**提交者 --> 新子项

现有对象应由下拉列表框选择。

## 这是视图的（简化的，工作的）代码：

**新的.html.erb**

```
<%= simple_form_for(@application)  do |f| %>
    <%= f.simple_fields_for :submitter do |submitter| %>  
        <%= render "submitter_fields", :f => submitter %>
    <% end %>
<% end %> 
```

**_submitter_fields.html.erb**

```
<%= f.input :firstname %>
<%= f.input :lastname %>
<%= render "child", :f => f %> 
```

**_child.html.erb**

```
<div id="childs">
    <%= f.simple_fields_for :children do |child| %>
      <%= render "child_fields", :f => child %>
    <% end %>
    <div class="links">
        <%= link_to_add_association 'Add child', f, :children %>
    </div>
</div> 
```

**_child_fields.html.erb**

```
<div class="nested-fields">
    <%= f.input :firstname %>
    <%= f.input :lastname %>
    <%= link_to_remove_association "Remove child", f %>
</div> 
```

现在我想添加一个包含所有现有提交者的下拉列表。例如：

```
<%= f.assosciation :submitter %> 
```

我的问题从这里开始：要构建用于向所选提交者添加新孩子的表单，我需要将此对象分配给表单构建器。我不知道该怎么做。

有人可以给我一个提示如何实现这个吗？或者这种情况根本不可能？

提前致谢！

基督教

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T14:54:54.843

simple_fields_for 接受对象的第二个参数：[https](https://github.com/plataformatec/simple_form/blob/master/lib/simple_form/action_view_extensions/form_helper.rb#L33) ://github.com/plataformatec/simple_form/blob/master/lib/simple_form/action_view_extensions/form_helper.rb#L33如果您通过现有的提交者，它可能会起作用。

# linux - 如何在 Linux 中监听鼠标事件？

> ID：14553435
> 
> 赞同：8
> 
> 时间：2013-01-27T23:14:35.223
> 
> 标签：linux, mouseevent, x11

我想编写一个程序，该程序将在发生鼠标单击时在后台运行并记录指针的位置。我试图在 Google 中搜索它，但结果是针对 NCurses 和一些 GUI 库的。有什么方法可以编写一个在后台监听鼠标事件的程序吗？首选 C 和/或 Python 方式。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-30T08:08:48.110

以下是记录鼠标位置、点击和释放的示例：

```
#include <stdio.h>
#include <X11/Xlib.h>

char *key_name[] = {
    "first",
    "second (or middle)",
    "third",
    "fourth",  // :D
    "fivth"    // :|
};

int main(int argc, char **argv)
{
    Display *display;
    XEvent xevent;
    Window window;

    if( (display = XOpenDisplay(NULL)) == NULL )
        return -1;

    window = DefaultRootWindow(display);
    XAllowEvents(display, AsyncBoth, CurrentTime);

    XGrabPointer(display, 
                 window,
                 1, 
                 PointerMotionMask | ButtonPressMask | ButtonReleaseMask , 
                 GrabModeAsync,
                 GrabModeAsync, 
                 None,
                 None,
                 CurrentTime);

    while(1) {
        XNextEvent(display, &xevent);

        switch (xevent.type) {
            case MotionNotify:
                printf("Mouse move      : [%d, %d]\n", xevent.xmotion.x_root, xevent.xmotion.y_root);
                break;
            case ButtonPress:
                printf("Button pressed  : %s\n", key_name[xevent.xbutton.button - 1]);
                break;
            case ButtonRelease:
                printf("Button released : %s\n", key_name[xevent.xbutton.button - 1]);
                break;
        }
    }

    return 0;
} 
```

编译它使用：

```
$ gcc mouse.c -o mouse -lX11
$ ./mouse 
Mouse move      : [664, 395]
Mouse move      : [665, 393]
Mouse move      : [666, 393]
Mouse move      : [666, 392]
Mouse move      : [664, 392]
Mouse move      : [664, 393]
Mouse move      : [664, 395]
Button pressed  : first
Button released : first
Button pressed  : third
Button released : third
^C
$ 
```

也看这里[Keyboard and Pointer Events并且在](http://tronche.com/gui/x/xlib/events/keyboard-pointer/keyboard-pointer.html)[The Xlib Manual](http://tronche.com/gui/x/xlib/)中有很多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T00:17:33.400

类似的问题：[如何在 Linux 的后台使用 python 捕获鼠标事件和键事件](https://stackoverflow.com/questions/12384772/how-can-i-capture-mouseevents-and-keyevents-using-python-in-background-on-linux)

上面的答案是对 evdev 使用 python 绑定。此绑定可用于捕获鼠标事件。

# html - CSS：标题 bg 图像位置

> ID：14553437
> 
> 赞同：0
> 
> 时间：2013-01-27T23:15:19.023
> 
> 标签：html, css, background, header, frontend

我目前正在开发一个网站，我在标题背景上有问题，所以我正在制作的标题是：

[http://i.imgur.com/h1JLm9A.jpg](http://i.imgur.com/h1JLm9A.jpg)

目前我有这个：

[http://i.imgur.com/LgF6HXm.jpg](http://i.imgur.com/LgF6HXm.jpg)

我正在尝试在标题上放置背景图像，但是要正确定位图像，它不能在标题中，因为图像也显示在标题之外。我怎样才能做到这一点？我尝试使用 z-index 但不起作用。

html:

```
<div id="container">            
<div id="header">  
        <div id="logo">
            <a href="http://localhost/Yazigi/"><img src="http://localhost/Yazigi/wp-content/uploads/2013/01/logo.png" width="155" height="85" alt="Yazigi – Araçatuba"></a>
        </div>        

            <span class="site-description ir">Você cidadão do mundo</span>
            <form method="get" id="searchform" class="search" action="#">
                <input type="text" class="search_input" name="s" id="s" placeholder="Procure aqui">
                <input type="submit" class="search_bt ir" name="submit" id="searchsubmit" value="">
            </form>

            <ul class="menu l_tinynav1">
                <li class="current_page_item"><a href="http://localhost/" title="Início">Início</a></li>
                <li class="page_item page-item-2"><a href="http://localhost/Yazigi/?page_id=2">Página de Exemplo</a></li>
            </ul>
        </div>
</div> 
```

CSS：

```
#container {
margin: 0 auto;
max-width: 960px;
padding: 0px 25px;
}    
#header {
    height: 232px;
    background: url(images/topbg.jpg);
    margin: 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T23:44:37.357

为什么不在标题中使用图像而不是使用 CSS 背景？将它放在带有绝对位置和一些负 z-index 的标题后面，然后将它的边距放在你想要的位置。

这是一些显示此内容的代码：（[小提琴](http://jsfiddle.net/LASDz/2/)）

```
<div id="header">
    <img src="http://jamesmcgillis.com/upload/google_logo_1_small(1).jpg"/>
</div>

<style>
    #header {
        height: 232px;
        border: solid;
        margin-left: 120px;
    }
    img {
        margin-left: -50px;
        z-index:-1;
        position:absolute;
    }
</style> 
```

那是你需要的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T23:51:37.077

您在这里有许多不同的方法，但可能最适合跨浏览器的方法是：

**1\. 在 html 中：**创建一个外部 div，（当然，宽度为 100%）并添加地图/绘图图像背景。

```
 <div id="outer-container">
       <div id="container">            
          <div id="header">... etc

          </div>
       </div>
    </div> <!-- outer-container--> 
```

**2\. 在 css 中：** a) 将渐变图像添加到具有背景属性的主体中。b) 将地图/绘图图像添加到具有背景属性的外部容器中。

```
 body {
        background: (your-gradient-gray-image.jpg) repeat-x;
    }

    #outer-container { 
        background: url(images/topbg.jpg) no-repeat center top;
    } 
```

# mysql - MySQL 语句 UPDATE IF 等于或大于 else 什么都不做

> ID：14553438
> 
> 赞同：1
> 
> 时间：2013-01-27T23:15:26.587
> 
> 标签：mysql

我有以下 MySQL 语句：

```
$stmt = $conn->prepare('UPDATE `equipment` SET `currentHours`= :unitHours, `lastUpdate`= :lastUpdate WHERE `equipType`= :equipType AND `unitNumber`= :unitNumber'); 

    $stmt ->execute(array(':lastUpdate'=> $dateToday, ':unitHours' => $unitHours, ':equipType'=> $equipType, ':unitNumber'=> $unitNumber)); 
```

我只需要更新该`currentHours`值是否等于或大于该行中当前存储的值。这可以通过 MySQL 语句实现还是我必须在 PHP 中实现？如果这听起来像一个简单的问题，我对编程很抱歉。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T23:18:31.850

```
UPDATE `equipment` SET `currentHours`= :unitHours, `lastUpdate`= :lastUpdate

 WHERE `equipType`= :equipType AND `unitNumber`= :unitNumber

AND
    currentHours<:unitHours 
```

以上**仅**更新当前小时数低于输入的记录，它不会更新**所有**匹配其余条件的最后更新字段。
如果您只想在**字段**currenthours低于输入时更新它，但无论如何都更新 lastupdate 字段，那么**：**

```
UPDATE `equipment` 
SET `currentHours`= IF(currentHours<:unitHours,:unitHours,currentHours), 
`lastUpdate`= :lastUpdate

WHERE `equipType`= :equipType AND `unitNumber`= :unitNumber 
```

# node.js - 监控 Node.js 发送的请求标头

> ID：14553441
> 
> 赞同：1
> 
> 时间：2013-01-27T23:15:37.413
> 
> 标签：node.js, reddit

因此，我正在开发一项服务，该服务调用 subreddit 并请求 JSON 格式的最热门文章。现在 Reddit 喜欢任何使用 reddit API 的人修改他们的 User-Agent Header 以使其具有描述性（这里是格式[的链接](https://github.com/reddit/reddit/wiki/API)）。

所以使用 Node.JS 和[Request](https://github.com/mikeal/request)插件，我写了这样的东西

```
var subreddit = 'somesupercoolsubreddit';
var stories = '5';
var options ={
    url : url.parse(REDDIT_URL+"/r/"+subreddit+"/hot.json"+"?"+"limit="+stories),
    headers : {'User-Agent' :  'Super Cool Reddit Service for Local Widgets! by /u/mrkaiser'}, 
    json: true
};
request(options,function(err,response,body){
    serverResponse.send(body);
}); 
```

但我怎么知道这行得通？有没有办法知道请求标头是否真的被填充了，或者 Reddit 是否得到了正确的用户代理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T23:18:44.360

创建另一个等待连接并输出标头的节点脚本。更改您的 reddit 脚本以临时调用新脚本并验证标题。

# backbone.js - 骨干结构

> ID：14553442
> 
> 赞同：1
> 
> 时间：2013-01-27T23:15:41.793
> 
> 标签：backbone.js

我是骨干新手，但看过几个关于它的教程截屏视频，无论是否有requirejs。

我的问题涉及设置结构（如果使用需要，则为文件结构和/或变量/对象结构）。

我看过的大多数教程，似乎更喜欢 App.Models、App.Collections 和 App.Views 方法，并且里面的每个项目都有模块的名称：即，

```
App.Models.todo = Backbone.Model.extend({...});
App.Collections.todos = Backbone.Collection.extend({...});
App.Views.todo = Backbone.View.extend({...}); 
```

经过一番研究，试图找到与我想使用的风格相同的人，我终于找到了：[使用 requirejs 和主干的 web 应用程序的文件结构](https://stackoverflow.com/questions/11034706/file-structure-for-a-web-app-using-requirejs-and-backbone)。他们似乎更喜欢 App.[Module Name] 方法：即，

```
App.Todo.Model = Backbone.Model.extend({...});
App.Todo.Collection = Backbone.Collection.extend({...});
App.Todo.Views = Backbone.View.extend({...}); 
```

我个人更喜欢 App.[Module Name] 结构而不是拆分我的模块，但想知道拥有不同结构的好处（如果有的话）。

您使用哪种结构，它对您过去可能见过或使用的不同结构有何帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T04:50:14.593

我喜欢这个博客中描述的方法： [http ://weblog.bocoup.com/organizing-your-backbone-js-application-with-modules/](http://weblog.bocoup.com/organizing-your-backbone-js-application-with-modules/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T23:58:24.197

如果您使用的是 requireJS，则不需要/不想将模型/视图附加到附加到窗口的全局命名空间对象（没有 App.Views、App.Models）。使用 requireJS 或不同的 AMD 模块加载器的好处之一是您可以避免使用全局变量。

您可以像这样定义模型：

```
define(['underscore', 'backbone'], 
    function(_, Backbone) {
    var MyModel = Backbone.Model.extend({});

    return MyModel;
}); 
```

然后定义一个视图：

```
define(['underscore', 'backbone', 'tpl!templates/someTemplate.html'],
  function(_, Backbone, template) {
  var MyView = Backbone.View.extend({});

  return MyView;
}); 
```

现在你有一个模型和一个没有全局变量的视图。然后，如果某个其他模块需要创建其中一个（可能是您的 App 模块），您将其添加到`define()`数组中并拥有它。

# python - time.time() 不是计时

> ID：14553445
> 
> 赞同：2
> 
> 时间：2013-01-27T23:16:23.850
> 
> 标签：python, performance, time, semantics

我在 WingIDE 101（版本 4）的 Windows 7 操作系统上运行 Python 3.2。在这种情况下，环境并不重要，但我认为我应该具体。

我的代码如下。它并不是最优的，只是找到素数的一种方法：

```
def isPrime2(n):
  if n == 1:
      return False  
  count = 0
  for i in range(2,n+1,2):
    if n%i == 0:
      count = count + 1
      if count > 2:
        return False
  for i in range(1,n+1,2):
    if n%i == 0:
      count = count + 1
      if count > 2:
        return False         
  if count == 2:
    return True

start = time.time()
x = isPrime2(571)
end = time.time()
time_interval = end - start
print("%1.15f"%time_interval)
print(x) 
```

我遇到的问题是 time.time() 函数似乎不是计时的。当我运行这个程序时，我得到

```
0.000000000000000
True 
```

我还尝试了最多 30 位数字，并且所有数字都保持为零。

考虑到我有多个 For 循环，我的程序不可能这么快。

我的问题是，为什么我的功能没有计时？或者如果是，为什么我知道它不应该这么快？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T23:29:30.830

在 Windows 上，您想[`time.clock()`](http://docs.python.org/2/library/time.html#time.clock)改用；`time.time()`只有 1/60 秒的粒度，而前者为您提供微秒粒度。

或者，为了让它保持跨平台，请[`timeit.default_timer()`](http://docs.python.org/2/library/timeit.html#timeit.default_timer)改用，它将`time`为您的平台使用正确的功能：

```
import timeit

start = timeit.default_timer() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T23:24:00.237

`time.time()`实际上并不能保证分辨率优于 1 秒。您需要改用`timeit`具有更高分辨率的模块。

（编辑）

```
Examples of alternative usages for `timeit`:

n = 10000
# Method 1: using default_timer()
start = timeit.default_timer()
for i in range (n):
    x = isPrime2(571)
end = timeit.default_timer()
time_interval = (end - start)/n
print("%1.15f"%time_interval)

# Method 2: using timeit()
print("%1.15f"%(timeit.timeit('isPrime2(571)','from __main__ import isPrime2',number=n)/n))
print(x) 
```

上面的代码替换了`start = time.time()`提问者代码中的代码，两种替代方法产生了相似的时序。另请参阅[如何正确使用 timeit](https://stackoverflow.com/questions/8220801/how-to-use-timeit-correctly)。

# javascript - 插入填充以补偿“滚动条跳跃”

> ID：14553449
> 
> 赞同：1
> 
> 时间：2013-01-27T23:17:27.930
> 
> 标签：javascript, jquery, html, css, twitter-bootstrap

我有一个水平居中的容器，带有一个导航栏，可以用 js 隐藏和显示不同长度的 div。有时，如果显示的 div 中的内容太长，显示 div 也会显示滚动条，并导致页面在某些浏览器中“跳转”到左侧。CSS 只是 Bootstrap 的基本脚手架。

以下是网站上正在发生的事情的要点。但您可以在这里看到生产中的问题：http: [//dylanpatrickclark.com](http://dylanpatrickclark.com)

```
<body>
  <script type="text/javascript">
  $(document).ready(function(){ 
    function setNavState(currentHash) {
      $('nav ul li').removeClass('active');
      var selector = 'nav ul li a[href="' + currentHash + '"]';
      $(selector).parent().addClass('active');
    };
    function hash() {
      var hash = window.location.hash;
      if (hash != ''){
        $('.tabs div').hide();
        $(hash).show();
      }
      else {
        $('.tabs div').hide();
        $('.tabs div#tab1').show();
        hash = 'tab1'
      }
      setNavState(hash);
    };
    hash();
    $(window).bind('hashchange', function() {
      hash()
    });
  });
</script>

<h1>Hello, world!</h1>
<div class="container">
  <div class="row">
    <nav>
      <ul>
        <li> <a href="#tab1">Tab1</a> </li>
        <li> <a href="#tab2">Tab2</a> </li>
      </ul>
    </nav>
  </div>
</div>
<div class="row">
  <div class="tabs">
    <div class="tab-pane" id="tab1">
      <p>Short</p>
    </div>
    <div class="tab-pane" id="tab2">
      <p>Long</p>
    </div>
  </div>
</div>
</body> 
```

我在这里看到了很多关于这个问题的旧答案，其中很多建议强制滚动条显示，但我宁愿使用 js 插入填充以补偿滚动条。我认为facebook会做这样的事情。我真的不想担心 IE 支持，因为我主要专注于寻找一个我可以理解的解决方案，我对 javascript 的基本了解。

任何人都可以简单地解释如何最好地用javascript补偿滚动条的出现/消失吗？太感谢了！

![滚动条前的站点图像](../Images/7c012e67507f635475d019eac6c70342.png) ![滚动条后的网站图片](../Images/bfc4a26ec5be281bb051932c04dd4fc9.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-14T13:28:06.363

`body {overflow-y:scroll}`当我遇到这个问题时，对我来说非常有用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T23:26:09.550

我想到了两种方法，首先您可以使用滚动定义防止滑动，其次您可以使用[滚动条插件](http://baijs.nl/tinyscrollbar/)`body { overflow:scroll }`创建自己的滚动并定义滚动条的 css 。注：to or course。`{ position: absolute; right:0px; }``relative``body``wrapper`

# jquery - 在 for 循环中从 jQuery 编写 CSS

> ID：14553450
> 
> 赞同：1
> 
> 时间：2013-01-27T23:17:28.253
> 
> 标签：jquery

我的脚本需要在页面部分动态创建样式表（而不是在每个元素上放置内联样式，因为稍后我需要使用媒体查询覆盖这些样式）。

**编码**

```
for (var i=0; i<theElements.length; i++){

    $(theElements[i]).not('.responsive-wrap').each(function(i, elem){
        var theWidth = $(this).width();
        var parentWidth = $(this).parent().width();

        $(this).addClass('element' + [i]);

        $("#dynamicStylesheet").text('.element' + [i] + ' {max-width: ' + theWidth + 'px;}');
    });
} 
```

**主要问题是：**

这完全覆盖了`#dynamicStylesheet`每次循环运行中的文本（所以当我加载页面时，只有一个规则`.element22`）。我怎样才能让它添加文本而不覆盖？

**积分的子问题：**

*   这在大多数情况下都有效，但仅`[i]`在方括号中时才有效。为什么是这样？

    我需要`for loop`这里，还是`.each(function(){})`基本上创建一个`for loop`？`each`在这个函数下面还有另一个函数`for loop`，我没有发布它以保持简洁。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T23:25:38.833

我不会在每次迭代期间添加文本。相反，构建一个字符串，然后将其添加到元素中。这也提高了性能。

您不需要 for 循环。

```
var cssString = '';
$(theElements).not('.responsive-wrap').each(function(i, elem){
    var theWidth = $(this).width();
    var parentWidth = $(this).parent().width();

    $(this).addClass('element' + [i]);

    cssString += '.element' + [i] + ' {max-width: ' + theWidth + 'px;}';
});

$("#dynamicStylesheet").text(cssString); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T23:20:06.877

这将是添加文本而不是每次都覆盖它的快速方法

```
$("#dynamicStylesheet").text(
             $("#dynamicStylesheet").text()
             + '.element' + [i] + ' {max-width: ' + theWidth + 'px;}'); 
```

至于 for 循环，是的，`each`应该就是你所需要的。如果您需要数字，可以添加一个计数变量。我还在`$("#dynamicStylesheet")`循环之外设置了一个变量，这样 jQuery 就不必每次都查找元素——这是为了提高性能。

```
var i = 0,
    stylesheet = $("#dynamicStylesheet");

$(theElements).not('.responsive-wrap').each(function(){
    var theWidth = $(this).width();
    var parentWidth = $(this).parent().width();
    var elemName = "element" + i;

    $(this).addClass(elemName);

    stylesheet.text(
             stylesheet.text()
             + '.' + elemName + ' {max-width: ' + theWidth + 'px;}');
}); 
```

**编辑**

如果`theElements`是一组标签名称，这样的东西会比我原来的效果更好。

```
var i = 0,
    stylesheet = $("#dynamicStylesheet");

$.each(theElements, function(){
  if( !$(this).hasClass('responsive-wrap') ){

    var theWidth = $(this).width();
    var parentWidth = $(this).parent().width();
    var elemName = "element" + i;

    $(this).addClass(elemName);

    stylesheet.text(
             stylesheet.text()
             + '.' + elemName + ' {max-width: ' + theWidth + 'px;}');
 }
}); 
```

未经测试，但应该可以工作..

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-27T23:38:51.287

好的，所以，有几件事。假设这`theElements`是一个 HTML 元素数组，则`each`是不必要的。但情况似乎并非如此，因为您说正在显示（如果是 HTML 元素数组，`element22`您编写的代码只会`element0`一遍又一遍地创建）。`theElements`所以显然`theElements`是一个数组数组，或者一个 jQuery 对象数组。鉴于它的名字，这很奇怪，但让我们通过吧。

正如其他人所提到的，您每次迭代都会覆盖文本，这很糟糕。构建一个字符串稍微好一点，但是你仍然在做重复的字符串连接，这很慢。如果我们必须这样做，我们应该附加到一个数组，然后在最后将它连接在一起（这样更快，因为附加到一个字符串每次都会从头开始创建整个字符串）。

```
var css = [];
for (var i = 0; i < theElements.length; i++) {
    $(theElements[i]).not('.responsive-wrap').each(function(i) {
        var theWidth = $(this).width();
        $(this).addClass('element' + i);
        css.push('.element' + i + ' {max-width: ' + theWidth + 'px;}');
    });
}
$("#dynamicStylesheet").text(css.join('\n')); 
```

现在，这行得通，并且会做你想做的事。但这几乎绝对不是做你想做的任何事情的正确方法。在客户端动态构建 CSS 并不好，除非您正在编写类似 CSS 编辑器的东西。有很多更简单的方法可以解决导致您走上这条道路的任何问题。

如果创建客户端样式表*绝对重要*，那么也有更好的方法来做到这一点。创建一个适用于所有元素的 CSS 规则`theElements`（哇，看看那句话）。如果它们是随机选择的，这是不可能的，但如果你通过一些逻辑查询找到它们，你可以在 CSS 中使用相同的查询。

就`[i]`事情而言——我不知道该告诉你什么。由于 JavaScript 对数组进行字符串化的奇怪方式，它们是等价的，如果`i`对你不起作用，那么就有很大的问题。如果我是你，我会使用`i.toString()`，但`i`应该可以正常工作。

### 编辑

如果`theElements`是标签名称数组，则可以简化为：

```
var tagNames = theElements; // clear variable names are important!
var css = [];
$(tagNames.join(',')).not('.responsive-wrap').each(function(i) {
    var $this = $(this);
    $this.addClass('element' + i.toString());
    css.push('.element' + i.toString() + '{ max-width: ' + $this.width() + 'px; }');
});
$("#dynamicStylesheet").text(css.join('\n')); 
```

# java - Java中的正则表达式，无法搜索所有HTML

> ID：14553452
> 
> 赞同：1
> 
> 时间：2013-01-27T23:17:54.957
> 
> 标签：java, regex

我正在 Android 平台上使用 Java 正则表达式。

我正在尝试在[此](http://krakow.dlastudenta.pl/teatr/repertuar_teatrow/teatry.html)HTML 中搜索已定义的正则表达式。

这是我的代码：

```
 public void mainaaForWWW(String websiteSource){

    try {
        websiteSource = readDataFromWWW(websiteSource);
    } catch (IOException e1) {
        e1.printStackTrace();
    }

    ArrayList<String> cinemaArray = new ArrayList<String>();
    Pattern sample = Pattern.compile("<div class=\"theatre\">");
    Matcher secuence = sample.matcher(websiteSource);
    try {
        while (secuence.find()) {
            cinemaArray.add(secuence.group());
        }
    } catch (Exception e) {
        e.printStackTrace();
    }

    titleTableForWWW = new String[cinemaArray.size()];
    for(int i = 0; i < titleTableForWWW.length; i++)
        titleTableForWWW[i] = cinemaArray.get(i);
} 
```

问题很奇怪，因为当我调试代码时，`String websiteSource`一切正常（所有 HTML 文件都已完全加载），但只有 4 个 while 循环。在 HTML 文档中，我手动找到了 11 个匹配项。这个正则表达式被简化只是为了找到发生了什么。有任何想法吗？

好吧，我的错。我找到了一个解决方案：

所以，这是我负责编写`HTML`源代码的代码`String`：

```
public String readDataFromWWW(String UrlAdress) throws IOException
    {

        String line = null;
        URL url = new URL(UrlAdress);
        HttpURLConnection conn = (HttpURLConnection) url.openConnection();
        BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream(), "ISO-8859-2"));
        while (rd.readLine() != null) {
            line += rd.readLine();
        }

        System.out.println(line);

        return line; 
```

我认为以这种方式读取字符串可能会搞砸，所以我用这个方法替换了这个方法：

```
public String readDataFromWWW(String UrlAdress) throws IOException
    {
        String wyraz = "";

         try {
                String webPage = UrlAdress;
                URL url = new URL(webPage);
                URLConnection urlConnection = url.openConnection();
                InputStream is = urlConnection.getInputStream();
                InputStreamReader isr = new InputStreamReader(is, "ISO-8859-2");

                int numCharsRead;
                char[] charArray = new char[1024];
                StringBuffer sb = new StringBuffer();
                while ((numCharsRead = isr.read(charArray)) > 0) {
                    sb.append(charArray, 0, numCharsRead);
                }
                wyraz = sb.toString();

            } catch (MalformedURLException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            }

        return wyraz;
    } 
```

一切正常！非常感谢您的线索和帮助。我认为问题与写作期间的换行有关`String`，但我不太确定。

# c - 释放结构中的字符串时出现分段错误 - C

> ID：14553456
> 
> 赞同：0
> 
> 时间：2013-01-27T23:18:15.383
> 
> 标签：c, malloc

我一直被困在很长一段时间的分段错误上。我声明了一个带有指向字符串的指针的结构。我写了两个函数，create 和 remove 来操作值。结构如下：

```
#include "filename.h"  
//*in filename.h:* typedef struct linkNode linkNode_t;

struct linkNode{
    struct linkNode *next;
    char *value;
}; 
```

create 函数会先为节点分配内存，然后为值分配内存，然后将输入的值复制到值字段中：

```
linkNode_t* create(char* stuff){
    linkNode_t *ptr=malloc(sizeof(linkNode_t));
    if(ptr==NULL){
        printf("malloc failure");
        return NULL;
    }
    char* tempvalu=malloc(sizeof(char)*strlen(stuff)+1);
    if(tempvalu==NULL){
        printf("malloc failure");
        return NULL;
    }
    strcpy(tempvalu,stuff);
    ptr->next=NULL;
    ptr->value=tempvalu;
    return ptr;
} 
```

一个函数用于将一个节点插入到链表中：

```
linkNode_t* insertLast(linkNode_t* start, linkNode_t* newNode){
    linkNode_t* current=start;
    while(current->next!=NULL){
        current=current->next;
    }
//now current points to the last element in the linked list
    current->next=newNode;
    return start;
} 
```

引起我问题的部分如下：

```
linkNode_t* removebyValue(linkNode_t* start, char* valu){
/**removes the first instance of a node with a certain value. Return *start after     removing.
    if linked list becomes empty, return NULL*/

    linkNode_t *current=start;
    linkNode_t *previous=start;
    while(current!=NULL){
        if(strcmp(valu,current->value)==0) {//found the node to delete
            if(current==start){//removing the head
                linkNode_t* retvalue= current->next;
                free(current->value);
                free(current);
                return retvalue;
            }
            else{   //removing other elements in the linked list
                previous->next=current->next;
                free(current->value);
                free(current);
                return start;
            }
        }
        else{
            previous=current;
            current=current->next;
        }
    }
    return start;
} 
```

在 Main 中，我创建了一个包含两个元素 1 和 2 的链表，并在发生分段错误时尝试释放元素 1。

```
int main(){
    linkNode_t *pt1=create("1");
    pt1=insertLast(pt1,create("2"));
    removebyValue(pt1,"1"); //Causes seg fault. If I replace "1" by "2" nothing happens 
```

有人可以对此提出一些建议吗？提前致谢

编辑：我放了所有可能相关的代码，因为有人说我放的部分没有错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T23:54:27.513

我认为您在正确维护开始指针的同时过度考虑删除节点。考虑一种希望更简单的方法。

```
typedef struct node_t 
{
    struct node_t* next;
    char* value;
} node_t;

node_t* remove(node_t *start, const char* valu)
{
    node_t* current=start;
    node_t* prev=NULL;

    while(current && strcmp(current->value, valu))
    {
        prev = current;
        current = current->next;
    }

    if (current)
    {
        if (prev) // we're not deleting start node
            prev->next = current->next;

        else      // we *are* deleting start node
            start = current->next;

        // now the node is unlinked. remove it.
        free(current->value);
        free(current);
    }
    return start;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T23:55:05.043

这是一个可以正常工作的替代测试代码，请尝试一下，看看它是否有帮助。此外，您可以添加

```
typedef struct node_t {
    struct node_t* next;
    char* value;
} node; 
```

这似乎更容易理解，但这并不是因为 typedef 的性质令人困惑。我强烈建议你看一下[https://github.com/torvalds/linux/blob/master/Documentation/CodingStyle](https://github.com/torvalds/linux/blob/master/Documentation/CodingStyle) 这是linux内核的编码风格，很短很简单，不是特别规律，但是值得注意的是……

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

struct node_t {
    struct node_t* next;
    char* value;
};

struct node_t* create(const char* istr) 
{
    struct node_t* ptr = (struct node_t*)malloc(sizeof(struct node_t));
    char* tmp = (char*)malloc(sizeof(char) * (strlen(istr) + 1));

    strcpy(tmp, istr);
    ptr->next = 0;
    ptr->value = tmp;
    return ptr;
}

struct node_t* remove(struct node_t* start, const char* value)
{
    struct node_t* current = start;
    struct node_t* prev = start;

    while (current != 0) {
        if (!strcmp(value, current->value)) {
            if (current == start) {
                struct node_t* retval = current->next;
                free(current->value);
                free(current);
                return retval;
            } else {
                /* nothing happens */
                return 0;
            }
        }
    }
}

int main(const int argc, const char** argv)
{
    struct node_t* pt = create("1");
    printf("%s\n", pt->value);
    pt->next = create("2");
    printf("%s\n", pt->next->value);
    remove(pt, "1");    

    return 0;
} 
```

# scala - scala中带有main（）的对象和扩展App之间的区别

> ID：14553461
> 
> 赞同：3
> 
> 时间：2013-01-27T23:18:38.923
> 
> 标签：scala

我正在通过 ScalaInAction 工作（这本书仍然是 MEAP，但代码在 github 上是公开的）现在我在第 2 章中查看这个 restClient: : [https://github.com/nraychaudhuri/scalainaction/blob/master/ chap02/RestClient.scala](https://github.com/nraychaudhuri/scalainaction/blob/master/chap02/RestClient.scala)

首先，我使用 scala 扩展设置了 intelliJ，并创建了一个 HelloWorld `main()`：

```
<ALL the imports>

object HelloWorld {
   def main(args: Array[String]) {
     <ALL the rest code from RestClient.scala>
   }
} 
```

编译时出现以下错误：

```
scala: forward reference extends over defintion of value command
val httppost = new HttpPost(url)
                ^ 
```

我可以通过移动以下行来解决此问题，直到相对于`def`'s的顺序正确

```
require( args.size >= 2, "You need at least two arguments to make a get, post, or delete request")

val command = args.head
val params = parseArgs(args)
val url = args.last

command match {
  case "post"    => handlePostRequest
  case "get"     => handleGetRequest
  case "delete"  => handleDeleteRequest
  case "options" => handleOptionsRequest
} 
```

在浏览 github 页面时，我发现了这个：[https ://github.com/nraychaudhuri/scalinaction/tree/master/chap02/restclient](https://github.com/nraychaudhuri/scalainaction/tree/master/chap02/restclient)

哪个使用实现 RestClient.scala 使用`extends App`而不是`main()`方法：

```
<All the imports>
object RestClient extends App {
   <All the rest of the code from RestClient.scala>
} 
```

然后我将我的更改`object HelloWorld`为仅使用`extends App`而不是实现`main()`方法，并且它可以正常工作

为什么这样做的`main()`方法会产生错误但`extends App`不会产生错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-28T09:32:33.273

因为 main() 是一个方法，而变量的 in 方法不能是前向引用。

例如：

```
object Test {

   // x, y is object's instance variable, it could be forward referenced

   def sum = x + y // This is ok
   val y = 10    
   val x = 10

} 
```

但是方法中的代码无法前向引用。

```
object Test {
    def sum = {
        val t = x + y // This is not ok, you don't have x, y at this point
        val x = 10
        val y = 20
        val z = x + y // This is ok
    }
} 
```

在您的情况下，如果您将所有代码从 RestClient.scala 复制粘贴到 main()，您将遇到同样的问题，因为`var url`它是在 handlePostRequest 中使用后声明的。

# ruby-on-rails - 验证多态父母的存在

> ID：14553463
> 
> 赞同：14
> 
> 时间：2013-01-27T23:18:44.773
> 
> 标签：ruby-on-rails, polymorphism, associations

我正在使用以下模型开发 Rails 3.2 应用程序：

```
class User < ActiveRecord::Base
  # Associations
  belongs_to :authenticatable, polymorphic: true

  # Validations
  validates :authenticatable, presence: true # this is the critical line
end

class Physician < ActiveRecord::Base
  attr_accessible :user_attributes

  # Associations
  has_one :user, as: :authenticatable
  accepts_nested_attributes_for :user
end 
```

我想要做的是验证用户是否总是有一个可验证的父级。这本身就可以正常工作，但是在我的表单中，用户模型抱怨不存在可验证的内容。

我正在使用以下控制器为新医生显示一个表单，该表单接受用户的嵌套属性：

```
def new
  @physician = Physician.new
  @physician.build_user

  respond_to do |format|
    format.html # new.html.erb
    format.json { render json: @physician }
  end
end 
```

这是我的创建方法：

```
def create
  @physician = Physician.new(params[:physician])

  respond_to do |format|
    if @physician.save
      format.html { redirect_to @physician, notice: 'Physician was successfully created.' }
      format.json { render json: @physician, status: :created, location: @physician }
    else
      format.html { render action: "new" }
      format.json { render json: @physician.errors, status: :unprocessable_entity }
    end
  end
end 
```

在提交表单时，它说用户的可验证性不能为空。但是，authenticable_id 和authenticable_type 应该在`@physician`保存后立即分配。如果我使用相同的表单来编辑医生及其用户，它工作得很好，因为那时分配了 id 和 type。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-06-20T15:23:57.383

我相信这是意料之中的：

[https://github.com/rails/rails/issues/1629#issuecomment-11033182](https://github.com/rails/rails/issues/1629#issuecomment-11033182)（最后两条评论）。

[还要从rails api](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)检查一下：

> 一对一关联
> 
> 将对象分配给 has_one 关联会自动保存该对象和被替换的对象（如果有的话），以更新它们的外键 - 除非父对象未保存（new_record？== true）。
> 
> 如果这些保存中的任何一个失败（由于其中一个对象无效），则会引发 ActiveRecord::RecordNotSaved 异常并取消分配。
> 
> 如果您希望将对象分配给 has_one 关联而不保存它，请使用 build_association 方法（如下所述）。被替换的对象仍将被保存以更新其外键。
> 
> 将对象分配给 belongs_to 关联不会保存对象，因为外键字段属于父项。它也不保存父母。

和这个

> build_association(attributes = {}) 返回关联类型的新对象，该对象已用属性实例化并通过外键链接到该对象，但尚未保存。

您必须先创建一个父级。然后将它的 id 分配给多态对象。

从我所见，您创建了一个构建 User 的对象 Physician.new，但此时它尚未保存，因此它没有 id，因此没有任何内容可分配给多态对象。所以验证总是会失败，因为它是在保存之前调用的。

换句话说：在您调用 build_user 的情况下，它返回 User.new NOT User.create 。因此authenticatable 没有分配authenticatable_id。

你有几个选择：

*   首先保存关联用户。

    或者

*   将验证移至 after_save 回调（可能但非常烦人且不好）

    或者

*   改变你的应用程序结构 - 也许避免多态关联并通过切换到 has_many？我很难判断，因为我不了解内部和业务需求。但在我看来，这不是多态关联的好候选。除了用户之外，您还会拥有更多可验证的模型吗？

恕我直言，多态关联的最佳候选者是电话、地址等。地址可以属于用户、客户、公司、组织、Area51 等，是家庭、运输或账单类别，即它可以**MORPH**以适应多种用途，所以它是提取的好对象。但是 Authenticatable 在我看来有点做作，并在不需要它的地方增加了复杂性。我没有看到任何其他对象需要是可验证的。

如果你能展示你的 Authenticatable 模型和你的推理，也许还有迁移（？）我可以给你更多建议。现在我只是凭空提出来 :-) 但它似乎是重构的好候选。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-17T13:25:12.057

您可以将验证移至 before_save 回调，它会正常工作：

```
class User < ActiveRecord::Base
  # Associations
  belongs_to :authenticatable, polymorphic: true

  # Validations
  before_save :check_authenticatable

  def check_authenticatable
    unless authenticatable
      errors[:customizable] << "can't be blank"
      false
    end
  end
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-15T03:59:30.133

在创建操作中，我必须手动分配它：

```
@physician = Physician.new(params[:physician])
@physician.user.authenticatable = @physician 
```

我的问题有点不同（has_many 和不同的验证），但我认为这应该可行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-02T23:47:36.803

通过覆盖嵌套的属性设置器，我能够让它工作。

```
class Physician
  has_one :user, as: :authenticatable
  accepts_nested_attributes_for :user

  def user_attributes=(attribute_set)
    super(attribute_set.merge(authenticatable: self))
  end
end 
```

为了干掉它，我将多态代码移到了一个关注点：

```
module Authenticatable
  extend ActiveSupport::Concern

  included do
    has_one :user, as: :authenticatable
    accepts_nested_attributes_for :user

    def user_attributes=(attribute_set)
      super(attribute_set.merge(authenticatable: self))
    end
  end
end

class Physician
  include Authenticatable
  ...
end 
```

对于`has_many`关联，同样可以使用 a 来完成`map`：

```
class Physician
  has_many :users, as: :authenticatable
  accepts_nested_attributes_for :users

  def users_attributes=(attribute_sets)
    super(
      attribute_sets.map do |attribute_set|
        attribute_set.merge(authenticatable: self)
      end
    )
  end
end

class User
  belongs_to :authenticatable, polymorphic: true
  validates :authenticatable, presence: true
end 
```

综上所述，我认为 konung 的最后一条评论是正确的——你的例子看起来不像是多态性的好候选者。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-28T06:57:57.717

我不确定这是否能解决您的问题，但是在验证多态父级是否存在时，我会使用类似的方法。

这是我在具有多态关联的`video`模型中使用的一些代码。`parent`这进去了`video.rb`。

```
 validates_presence_of :parent_id, :unless => Proc.new { |p|
      # if it's a new record and parent is nil and addressable_type is set
      # then try to find the parent object in the ObjectSpace
      # if the parent object exists, then we're valid;
      # if not, let validates_presence_of do it's thing
      # Based on http://www.rebeccamiller-webster.com/2011/09/validate-polymorphic/
      if (new_record? && !parent && parent_type)
        parent = nil
        ObjectSpace.each_object(parent_type.constantize) do |o|
          parent = o if o.videos.include?(p) unless parent
        end
      end
      parent
    } 
```

# nfc - 是否可以将 2 个 URI 写入 1 个 NFC 标签？

> ID：14553468
> 
> 赞同：0
> 
> 时间：2013-01-27T23:19:53.793
> 
> 标签：nfc, ndef

我正在与一家公司合作，该公司已经在过滤器处理/android清单中定义了一个URI，例如“brand://start”——挑战在于，如果手机没有，他们没有预料到需要调用一个URL他们的应用程序已安装。我想知道如果找不到他们的应用程序，我会在 NFC 标签上编码什么来处理他们的 URI 和备份 URL。

我宁愿写第二条 NDEF 记录（url brand.domain.com/download）..

所以，所有这些（假设我无法访问他们的清单文件）我如何编码一个标签来处理这两个选项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T10:20:33.477

如果是 Android 设备，您可以简单地将[Android 应用程序记录](http://developer.android.com/guide/topics/connectivity/nfc/nfc.html#aar)添加到 NDEF 消息中。这将确保在未安装应用程序时将用户重定向到 Play 商店进行安装。

# python - 字母的随机组合？

> ID：14553480
> 
> 赞同：0
> 
> 时间：2013-01-27T23:22:00.220
> 
> 标签：python, random

使用 Python，我怎样才能得到字母的随机组合？

我想做这样的事情：

```
def ranStr():
    # some code
    return random_string 
```

所以，如果我打电话`ranStr()`，我想得到类似（随机字母长度的随机组合）：

```
'aAFGresdFTg'
'EFRwdfWe'
'rgAijD' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T23:27:36.660

这是一种方法。

```
import random
def generate_key():
    STR_KEY_GEN = 'ABCDEFGHIJKLMNOPQRSTUVWXYzabcdefghijklmnopqrstuvwxyz'
    return ''.join(random.choice(STR_KEY_GEN) for _ in xrange(70)) 
```

或者

```
import random, string
def generate_key():
    return ''.join(random.choice(string.ascii_letters) for _ in xrange(70)) 
```

根据建议。

# python - Numpy __getitem__ 延迟评估和 a[-1:] 与 a[slice(-1, None, none)] 不同

> ID：14553485
> 
> 赞同：8
> 
> 时间：2013-01-27T23:22:48.953
> 
> 标签：python, numpy, magic-methods

所以这是关于我假设的两个问题是我所假设的相同的基本潜在混淆。我希望没关系。

这里有一些代码：

```
import numpy as np

class new_array(np.ndarray):

    def __new__(cls, array, foo):
        obj = array.view(cls)
        obj.foo = foo
        return obj

    def __array_finalize__(self, obj):
        print "__array_finalize"
        if obj is None: return
        self.foo = getattr(obj, 'foo', None)

    def __getitem__(self, key):
        print "__getitem__"
        print "key is %s"%repr(key)
        print "self.foo is %d, self.view(np.ndarray) is %s"%(
            self.foo,
            repr(self.view(np.ndarray))
            )
        self.foo += 1
        return super(new_array, self).__getitem__(key)

print "Block 1"
print "Object construction calls"
base_array = np.arange(20).reshape(4,5)
print "base_array is %s"%repr(base_array)
p = new_array(base_array, 0)
print "\n\n"

print "Block 2"
print "Call sequence for p[-1:] is:"
p[-1:]
print "p[-1].foo is %d\n\n"%p.foo

print "Block 3"
print "Call sequence for s = p[-1:] is:"
s = p[-1:]
print "p[-1].foo is now %d"%p.foo
print "s.foo is now %d"%s.foo
print "s.foo + p.foo = %d\n\n"%(s.foo + p.foo)

print "Block 4"
print "Doing q = s + s"
q = s + s
print "q.foo = %d\n\n"%q.foo

print "Block 5"
print "Printing s"
print repr(s)
print "p.foo is now %d"%p.foo
print "s.foo is now %d\n\n"%s.foo

print "Block 6"
print "Printing q"
print repr(q)
print "p.foo is now %d"%p.foo
print "s.foo is now %d"%s.foo
print "q.foo is now %d\n\n"%q.foo

print "Block 7"
print "Call sequence for p[-1]"
a = p[-1]
print "p[-1].foo is %d\n\n"%a.foo

print "Block 8"
print "Call sequence for p[slice(-1, None, None)] is:"
a = p[slice(-1, None, None)]
print "p[slice(None, -1, None)].foo is %d"%a.foo
print "p.foo is %d"%p.foo
print "s.foo + p.foo = %d\n\n"%(s.foo + p.foo) 
```

这段代码的输出是

```
Block 1
Object construction calls
base_array is array([[ 0,  1,  2,  3,  4],
       [ 5,  6,  7,  8,  9],
       [10, 11, 12, 13, 14],
       [15, 16, 17, 18, 19]])
__array_finalize

Block 2
Call sequence for p[-1:] is:
__array_finalize
p[-1].foo is 0

Block 3
Call sequence for s = p[-1:] is:
__array_finalize
p[-1].foo is now 0
s.foo is now 0
s.foo + p.foo = 0

Block 4
Doing q = s + s
__array_finalize
q.foo = 0

Block 5
Printing s
__getitem__
key is -1
self.foo is 0, self.view(np.ndarray) is array([[15, 16, 17, 18, 19]])
__array_finalize
__getitem__
key is -5
self.foo is 1, self.view(np.ndarray) is array([15, 16, 17, 18, 19])
__getitem__
key is -4
self.foo is 2, self.view(np.ndarray) is array([15, 16, 17, 18, 19])
__getitem__
key is -3
self.foo is 3, self.view(np.ndarray) is array([15, 16, 17, 18, 19])
__getitem__
key is -2
self.foo is 4, self.view(np.ndarray) is array([15, 16, 17, 18, 19])
__getitem__
key is -1
self.foo is 5, self.view(np.ndarray) is array([15, 16, 17, 18, 19])
new_array([[15, 16, 17, 18, 19]])
p.foo is now 0
s.foo is now 1

Block 6
Printing q
__getitem__
key is -1
self.foo is 0, self.view(np.ndarray) is array([[30, 32, 34, 36, 38]])
__array_finalize
__getitem__
key is -5
self.foo is 1, self.view(np.ndarray) is array([30, 32, 34, 36, 38])
__getitem__
key is -4
self.foo is 2, self.view(np.ndarray) is array([30, 32, 34, 36, 38])
__getitem__
key is -3
self.foo is 3, self.view(np.ndarray) is array([30, 32, 34, 36, 38])
__getitem__
key is -2
self.foo is 4, self.view(np.ndarray) is array([30, 32, 34, 36, 38])
__getitem__
key is -1
self.foo is 5, self.view(np.ndarray) is array([30, 32, 34, 36, 38])
new_array([[30, 32, 34, 36, 38]])
p.foo is now 0
s.foo is now 1
q.foo is now 1

Block 7
Call sequence for p[-1]
__getitem__
key is -1
self.foo is 0, self.view(np.ndarray) is array([[ 0,  1,  2,  3,  4],
       [ 5,  6,  7,  8,  9],
       [10, 11, 12, 13, 14],
       [15, 16, 17, 18, 19]])
__array_finalize
p[-1].foo is 1

Block 8
Call sequence for p[slice(-1, None, None)] is:
__getitem__
key is slice(-1, None, None)
self.foo is 1, self.view(np.ndarray) is array([[ 0,  1,  2,  3,  4],
       [ 5,  6,  7,  8,  9],
       [10, 11, 12, 13, 14],
       [15, 16, 17, 18, 19]])
__array_finalize
p[slice(None, -1, None)].foo is 2
p.foo is 2
s.foo + p.foo = 3 
```

请注意两点：

1.  调用`p[-1:]`不会导致调用`new_array.__getitem__`。如果`p[-1:]`被诸如`p[0:]`,`p[0:-1]`等之类的东西替换，这是正确的……但是诸如`p[-1]`and `p[slice(-1, None, None)]`do 之类的语句会导致调用`new_array.__getitem__`. 对于像`p[-1:] + p[-1:]`or这样的语句也是如此，`s = p[-1]`但对于像`print s`. 您可以通过查看上面给出的“块”来看到这一点。

2.  变量`foo`在调用期间正确更新`new_array.__getitem__`（参见块 5 和 6），但在评估完成后不正确`new_array.__getitem__`（再次参见块 5 和 6）。我还应该补充一点，将行替换为`return super(new_array, self).__getitem__(key)`也`return new_array(np.array(self.view(np.ndarray)[key]), self.foo)`不起作用。以下块是输出的唯一区别。

    ```
    Block 5
    Printing s
    __getitem__
    key is -1
    self.foo is 0, self.view(np.ndarray) is array([[15, 16, 17, 18, 19]])
    __array_finalize__
    __getitem__
    key is -5
    self.foo is 1, self.view(np.ndarray) is array([15, 16, 17, 18, 19])
    __array_finalize__
    __array_finalize__
    __array_finalize__
    __getitem__
    key is -4
    self.foo is 2, self.view(np.ndarray) is array([15, 16, 17, 18, 19])
    __array_finalize__
    __array_finalize__
    __array_finalize__
    __getitem__
    key is -3
    self.foo is 3, self.view(np.ndarray) is array([15, 16, 17, 18, 19])
    __array_finalize__
    __array_finalize__
    __array_finalize__
    __getitem__
    key is -2
    self.foo is 4, self.view(np.ndarray) is array([15, 16, 17, 18, 19])
    __array_finalize__
    __array_finalize__
    __array_finalize__
    __getitem__
    key is -1
    self.foo is 5, self.view(np.ndarray) is array([15, 16, 17, 18, 19])
    __array_finalize__
    __array_finalize__
    __array_finalize__
    new_array([[15, 16, 17, 18, 19]])
    p.foo is now 0
    s.foo is now 1

    Block 6
    Printing q
    __getitem__
    key is -1
    self.foo is 0, self.view(np.ndarray) is array([[30, 32, 34, 36, 38]])
    __array_finalize__
    __getitem__
    key is -5
    self.foo is 1, self.view(np.ndarray) is array([30, 32, 34, 36, 38])
    __array_finalize__
    __array_finalize__
    __array_finalize__
    __getitem__
    key is -4
    self.foo is 2, self.view(np.ndarray) is array([30, 32, 34, 36, 38])
    __array_finalize__
    __array_finalize__
    __array_finalize__
    __getitem__
    key is -3
    self.foo is 3, self.view(np.ndarray) is array([30, 32, 34, 36, 38])
    __array_finalize__
    __array_finalize__
    __array_finalize__
    __getitem__
    key is -2
    self.foo is 4, self.view(np.ndarray) is array([30, 32, 34, 36, 38])
    __array_finalize__
    __array_finalize__
    __array_finalize__
    __getitem__
    key is -1
    self.foo is 5, self.view(np.ndarray) is array([30, 32, 34, 36, 38])
    __array_finalize__
    __array_finalize__
    __array_finalize__
    new_array([[30, 32, 34, 36, 38]])
    p.foo is now 0
    s.foo is now 1
    q.foo is now 1 
    ```

    现在包含对 的过多调用`new_array.__array_finalize__`，但变量的“问题”没有变化`foo`。

3.  我的期望是`p[-1:]`对`new_array`对象的调用`p.foo = 0`会导致该语句`p.foo == 1`返回`True`。显然情况并非如此，即使`foo`在调用期间被正确更新`__getitem__`，因为这样的语句`p[-1:]`会导致大量调用`__getitem__`（一旦考虑到延迟评估）。此外，调用`p[-1:]`和`p[slice(-1, None, None)]`会导致不同的值`foo`（如果计数工作正常）。在前一种情况下`foo`会`5`添加到它，而在后一种情况下`foo`会`1`添加到它。

# 问题

虽然延迟评估 numpy 数组切片在评估我的代码期间不会导致问题，但使用 pdb 调试我的一些代码是一个巨大的痛苦。基本上，语句似乎在运行时和在 pdb 中评估不同。我认为这不太好。这就是我偶然发现这种行为的方式。

我的代码使用输入来`__getitem__`评估应该返回什么类型的对象。在某些情况下，它返回相同类型的新实例，在其他情况下，它返回某种其他类型的新实例，在其他情况下，它返回一个 numpy 数组、标量或浮点数（取决于底层 numpy 数组认为正确的任何内容）。我使用传递的键`__getitem__`来确定要返回的正确对象是什么。但是如果用户传递了一个切片，例如类似的东西，我就不能这样做`p[-1:]`，因为该方法只获取单个索引，例如用户写的`p[4]`。**那么，如果我的 numpy 子类的`key`in`__getitem__`没有反映用户是在请求一个由 给出的切片，`p[-1:]`还是只是一个由 给出的条目，我该怎么做`p[4]`呢？**

作为一个侧面点，[numpy 索引](http://docs.scipy.org/doc/numpy/reference/arrays.indexing.html)文档意味着切片对象，例如，`slice(start, stop, step)`将被视为与类似的语句相同，`start:stop:step`. 这让我觉得我错过了一些非常基本的东西。暗示这一点的句子很早就出现了：

> 当 obj 是切片对象（由括号内的 start:stop:step 表示法构造）、整数或切片对象和整数的元组时，就会发生基本切片。

我不禁觉得，同样的基本错误也是我认为该`self.foo += 1`行应该计算用户请求切片或实例的元素`new_array`的次数的原因（而不是“在“ 一片）。**这两个问题实际上是否相关？如果是，如何相关？**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-28T03:49:59.967

你确实被一个讨厌的虫子咬了。知道我不是唯一的人是一种解脱！幸运的是，它很容易解决。只需将以下内容添加到您的课程中即可。这实际上是我几个月前写的一些代码的复制粘贴，文档字符串可以说明发生了什么，但您可能还想阅读[python 文档](http://docs.python.org/2/reference/datamodel.html#object.__getslice__)。

```
def __getslice__(self, start, stop) :
    """This solves a subtle bug, where __getitem__ is not called, and all
    the dimensional checking not done, when a slice of only the first
    dimension is taken, e.g. a[1:3]. From the Python docs:
       Deprecated since version 2.0: Support slice objects as parameters
       to the __getitem__() method. (However, built-in types in CPython
       currently still implement __getslice__(). Therefore, you have to
       override it in derived classes when implementing slicing.)
    """
    return self.__getitem__(slice(start, stop)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T01:12:17.830

使用`isinstance`方法检查切片类型。

```
from __future__ import print_function

class SliceExample(object):
    def __getitem__(self, key):
        if isinstance(key, slice):
            return key.start, key.stop
        return key

sl = SliceExample()

print(repr(sl[1]))
print(repr(sl[1:2])) 
```

# javascript - 围绕 Node.js 中的回调进行思考

> ID：14553489
> 
> 赞同：2
> 
> 时间：2013-01-27T23:23:39.063
> 
> 标签：javascript, node.js

我只是在尝试一个简单的回调来让代码按顺序而不是异步执行。这不起作用：

```
function fn1(string, func){
    console.log("hello");
    func();
};

function fn2(){
    console.log("world");
}

fn1("meaninglessString", fn2()); 
```

它实际上将“world”然后“hello”打印到控制台然后崩溃。但这确实：

```
function fn1(string, func){
    console.log("hello");
    func();
};

fn1("meaninglessString", function(){
    console.log("world");
}); 
```

我是否必须始终在调用中编写回调函数代码，`fn1`或者有没有办法引用已经编写的函数？此外，如果我只想在另一个功能完成后发生一个功能，这是在 Node.js 中执行此操作的最佳方式吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T23:26:05.797

看看你的最后一行：

```
fn1("meaninglessString", fn2()); 
```

它应该是以下内容：

```
fn1("meaninglessString", fn2); 
```

包含括号会导致 fn2 立即执行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T23:36:02.407

在您的第一个区块中，您有：

```
fn1("meaninglessString", fn2()); 
```

这表示“使用参数调用 fn1 “meaninglessString”以及不使用参数调用 fn2 的结果”。因此，解释器执行它调用 fn2 并从中得到任何回报，它将“world”打印为副产品，然后使用参数“meaninglessString”和 undefined 调用 fn1，后者打印“hello”并调用尚未被调用的函数set(undefined) 因此它崩溃了。

相反，如果您更改代码以传递函数而不是调用函数的结果，如下所示，它将按预期工作

```
function fn1(string, func){
    console.log("hello");
    func();
};

function fn2(){
    console.log("world");
}

fn1("meaninglessString", fn2); 
```

# php - Wordpress：自定义帖子类型的永久链接 with_front 导致重定向循环

> ID：14553491
> 
> 赞同：1
> 
> 时间：2013-01-27T23:23:51.150
> 
> 标签：php, wordpress, url-rewriting, custom-post-type, permalinks

所以在搜索谷歌并通过SO之后，我发现添加

'with_front' => false`

到新内容类型的重写属性，使

`'rewrite' => array('slug' => 'Venue','with_front' => false)`

应该删除前置目录（例如 blog/，默认为我的其他页面）。

但是，它只是导致重定向循环..

我的默认前置固定链接`blog/`通常很好。但是，我有一个`event`不希望添加的自定义内容类型`blog/`。

发生了什么：`url.com/blog/event/new-event-12/`

我想要的是：`url.com/event/new-event-12/`

另一种/最好的方法是什么？

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T23:38:11.860

Ok, so this works.

I didn't know you had to refresh the permalinks to have the new code take effect.

The easiest way to do this is to just go to the permalink settings page and click save.

# qt-creator - QT5 QWebView 链接器错误

> ID：14553492
> 
> 赞同：18
> 
> 时间：2013-01-27T23:23:58.357
> 
> 标签：qt-creator, linker-errors, qtwebkit, qwebview, qt5

现在我只是想在按下按钮时让“www.google.com”加载到网络视图中。在设计器中添加 webview 后，链接器开始发疯。我在 Windows 7 上使用 QT Creater 2.6.1 和 QT5。我将 QT += 'webkit stuff' 添加到 .pro 文件中。我试过清理和重建，仍然得到链接器错误。

出于某种奇怪的原因`#include <QWebView>`，在任何文件中添加“”会产生文件未找到错误：“C:\Users\Scott\Desktop\eCookBook\eCookBook2\cookbook.cpp:3: 错误：C1083：无法打开包含文件：'QWebView'：没有相应的文件和目录”

食谱.h：

```
#ifndef COOKBOOK_H
#define COOKBOOK_H

#include <QMainWindow>
#include <QtWebKit/QWebElement>
#include <QtWebKit/QtWebKit>
#include <QtWebKitWidgets/QWebPage>

namespace Ui {
class cookBook;
}

class cookBook : public QMainWindow
{
    Q_OBJECT

public:
    explicit cookBook(QWidget *parent = 0);
    ~cookBook();

private slots:
    void on_pushButton_clicked();

    void on_textBrowser_anchorClicked(const QUrl &arg1);

private:
    Ui::cookBook *ui;
    //QWebPage page;
};

#endif // COOKBOOK_H 
```

食谱.cpp

```
#include "cookbook.h"
#include "ui_cookbook.h"
//#include <QWebView>
//#include <QtWebKit/QtWebKit>

cookBook::cookBook(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::cookBook)
{
    ui->setupUi(this);
}

cookBook::~cookBook()
{
    delete ui;
}

void cookBook::on_pushButton_clicked()
{
    ui->listWidgetTest->insertItem(ui->listWidgetTest->count(), "TEST");

    const QUrl testsite = "www.google.com";
    ui->widget->load(testsite);
    ui->widget->show();

} 
```

。轮廓

```
#-------------------------------------------------
#
# Project created by QtCreator 2013-01-23T14:46:45
#
#-------------------------------------------------

QT       += core gui
QT += webkit
QT += webkit webkitwidgets

greaterThan(QT_MAJOR_VERSION, 4): QT += widgets

TARGET = eCookBook2
TEMPLATE = app

SOURCES += main.cpp\
        cookbook.cpp

HEADERS  += cookbook.h

FORMS    += cookbook.ui 
```

编译器输出：

```
15:04:58: Running steps for project eCookBook2...
15:04:58: Configuration unchanged, skipping qmake step.
15:04:58: Starting: "C:\QtCommercial\QtCommercial5.0.0\Tools\QtCreator\bin\jom.exe" 
    C:\QtCommercial\QtCommercial5.0.0\Tools\QtCreator\bin\jom.exe -f Makefile.Debug
    cl -c -nologo -Zm200 -Zc:wchar_t -Zi -MDd -GR -W3 -w34100 -w34189 -EHsc -DUNICODE -DWIN32 -DQT_QML_DEBUG -DQT_DECLARATIVE_DEBUG -DQT_WIDGETS_LIB -DQT_GUI_LIB -DQT_CORE_LIB -DQT_OPENGL_ES_2 -DQT_OPENGL_ES_2_ANGLE -I"..\..\..\..\..\QtCommercial\QtCommercial5.0.0\5.0.0\msvc2010\include" -I"..\..\..\..\..\QtCommercial\QtCommercial5.0.0\5.0.0\msvc2010\include\QtWidgets" -I"..\..\..\..\..\QtCommercial\QtCommercial5.0.0\5.0.0\msvc2010\include\QtGui" -I"..\..\..\..\..\QtCommercial\QtCommercial5.0.0\5.0.0\msvc2010\include\QtCore" -I"debug" -I"." -I"." -I"..\..\..\..\..\QtCommercial\QtCommercial5.0.0\5.0.0\msvc2010\mkspecs\win32-msvc2010" -Fodebug\ @C:\Users\Scott\AppData\Local\Temp\cookbook.obj.5244.0.jom
cookbook.cpp
..\eCookBook2\cookbook.cpp(34) : warning C4100: 'arg1' : unreferenced formal parameter
    echo 1 /* CREATEPROCESS_MANIFEST_RESOURCE_ID */ 24 /* RT_MANIFEST */ "debug\\eCookBook2.exe.embed.manifest">debug\eCookBook2.exe_manifest.rc
    if not exist debug\eCookBook2.exe del debug\eCookBook2.exe.embed.manifest>NUL 2>&1
    if exist debug\eCookBook2.exe.embed.manifest copy /Y debug\eCookBook2.exe.embed.manifest debug\eCookBook2.exe_manifest.bak
    link /NOLOGO /DYNAMICBASE /NXCOMPAT /DEBUG /SUBSYSTEM:WINDOWS "/MANIFESTDEPENDENCY:type='win32' name='Microsoft.Windows.Common-Controls' version='6.0.0.0' publicKeyToken='6595b64144ccf1df' language='*' processorArchitecture='*'" /MANIFEST /MANIFESTFILE:debug\eCookBook2.exe.embed.manifest /OUT:debug\eCookBook2.exe @C:\Users\Scott\AppData\Local\Temp\eCookBook2.exe.5244.2012.jom
cookbook.obj : error LNK2019: unresolved external symbol "__declspec(dllimport) public: __thiscall QWebView::QWebView(class QWidget *)" (__imp_??0QWebView@@QAE@PAVQWidget@@@Z) referenced in function "public: void __thiscall Ui_cookBook::setupUi(class QMainWindow *)" (?setupUi@Ui_cookBook@@QAEXPAVQMainWindow@@@Z)
cookbook.obj : error LNK2001: unresolved external symbol "public: virtual struct QMetaObject const * __thiscall QWebView::metaObject(void)const " (?metaObject@QWebView@@UBEPBUQMetaObject@@XZ)
cookbook.obj : error LNK2001: unresolved external symbol "public: virtual void * __thiscall QWebView::qt_metacast(char const *)" (?qt_metacast@QWebView@@UAEPAXPBD@Z)
cookbook.obj : error LNK2001: unresolved external symbol "public: virtual int __thiscall QWebView::qt_metacall(enum QMetaObject::Call,int,void * *)" (?qt_metacall@QWebView@@UAEHW4Call@QMetaObject@@HPAPAX@Z)
cookbook.obj : error LNK2001: unresolved external symbol "public: virtual bool __thiscall QWebView::event(class QEvent *)" (?event@QWebView@@UAE_NPAVQEvent@@@Z)
cookbook.obj : error LNK2001: unresolved external symbol "public: virtual class QSize __thiscall QWebView::sizeHint(void)const " (?sizeHint@QWebView@@UBE?AVQSize@@XZ)
cookbook.obj : error LNK2001: unresolved external symbol "protected: virtual void __thiscall QWebView::mousePressEvent(class QMouseEvent *)" (?mousePressEvent@QWebView@@MAEXPAVQMouseEvent@@@Z)
cookbook.obj : error LNK2001: unresolved external symbol "protected: virtual void __thiscall QWebView::mouseReleaseEvent(class QMouseEvent *)" (?mouseReleaseEvent@QWebView@@MAEXPAVQMouseEvent@@@Z)
cookbook.obj : error LNK2001: unresolved external symbol "protected: virtual void __thiscall QWebView::mouseDoubleClickEvent(class QMouseEvent *)" (?mouseDoubleClickEvent@QWebView@@MAEXPAVQMouseEvent@@@Z)
cookbook.obj : error LNK2001: unresolved external symbol "protected: virtual void __thiscall QWebView::mouseMoveEvent(class QMouseEvent *)" (?mouseMoveEvent@QWebView@@MAEXPAVQMouseEvent@@@Z)
cookbook.obj : error LNK2001: unresolved external symbol "protected: virtual void __thiscall QWebView::wheelEvent(class QWheelEvent *)" (?wheelEvent@QWebView@@MAEXPAVQWheelEvent@@@Z)
cookbook.obj : error LNK2001: unresolved external symbol "protected: virtual void __thiscall QWebView::keyPressEvent(class QKeyEvent *)" (?keyPressEvent@QWebView@@MAEXPAVQKeyEvent@@@Z)
cookbook.obj : error LNK2001: unresolved external symbol "protected: virtual void __thiscall QWebView::keyReleaseEvent(class QKeyEvent *)" (?keyReleaseEvent@QWebView@@MAEXPAVQKeyEvent@@@Z)
cookbook.obj : error LNK2001: unresolved external symbol "protected: virtual void __thiscall QWebView::focusInEvent(class QFocusEvent *)" (?focusInEvent@QWebView@@MAEXPAVQFocusEvent@@@Z)
cookbook.obj : error LNK2001: unresolved external symbol "protected: virtual void __thiscall QWebView::focusOutEvent(class QFocusEvent *)" (?focusOutEvent@QWebView@@MAEXPAVQFocusEvent@@@Z)
cookbook.obj : error LNK2001: unresolved external symbol "protected: virtual void __thiscall QWebView::paintEvent(class QPaintEvent *)" (?paintEvent@QWebView@@MAEXPAVQPaintEvent@@@Z)
cookbook.obj : error LNK2001: unresolved external symbol "protected: virtual void __thiscall QWebView::resizeEvent(class QResizeEvent *)" (?resizeEvent@QWebView@@MAEXPAVQResizeEvent@@@Z)
cookbook.obj : error LNK2001: unresolved external symbol "protected: virtual void __thiscall QWebView::contextMenuEvent(class QContextMenuEvent *)" (?contextMenuEvent@QWebView@@MAEXPAVQContextMenuEvent@@@Z)
cookbook.obj : error LNK2001: unresolved external symbol "protected: virtual void __thiscall QWebView::dragEnterEvent(class QDragEnterEvent *)" (?dragEnterEvent@QWebView@@MAEXPAVQDragEnterEvent@@@Z)
cookbook.obj : error LNK2001: unresolved external symbol "protected: virtual void __thiscall QWebView::dragMoveEvent(class QDragMoveEvent *)" (?dragMoveEvent@QWebView@@MAEXPAVQDragMoveEvent@@@Z)
cookbook.obj : error LNK2001: unresolved external symbol "protected: virtual void __thiscall QWebView::dragLeaveEvent(class QDragLeaveEvent *)" (?dragLeaveEvent@QWebView@@MAEXPAVQDragLeaveEvent@@@Z)
cookbook.obj : error LNK2001: unresolved external symbol "protected: virtual void __thiscall QWebView::dropEvent(class QDropEvent *)" (?dropEvent@QWebView@@MAEXPAVQDropEvent@@@Z)
cookbook.obj : error LNK2001: unresolved external symbol "protected: virtual void __thiscall QWebView::changeEvent(class QEvent *)" (?changeEvent@QWebView@@MAEXPAVQEvent@@@Z)
cookbook.obj : error LNK2001: unresolved external symbol "protected: virtual void __thiscall QWebView::inputMethodEvent(class QInputMethodEvent *)" (?inputMethodEvent@QWebView@@MAEXPAVQInputMethodEvent@@@Z)
cookbook.obj : error LNK2001: unresolved external symbol "public: virtual class QVariant __thiscall QWebView::inputMethodQuery(enum Qt::InputMethodQuery)const " (?inputMethodQuery@QWebView@@UBE?AVQVariant@@W4InputMethodQuery@Qt@@@Z)
cookbook.obj : error LNK2001: unresolved external symbol "protected: virtual bool __thiscall QWebView::focusNextPrevChild(bool)" (?focusNextPrevChild@QWebView@@MAE_N_N@Z)
cookbook.obj : error LNK2001: unresolved external symbol "protected: virtual class QWebView * __thiscall QWebView::createWindow(enum QWebPage::WebWindowType)" (?createWindow@QWebView@@MAEPAV1@W4WebWindowType@QWebPage@@@Z)
cookbook.obj : error LNK2019: unresolved external symbol "__declspec(dllimport) public: virtual __thiscall QWebView::~QWebView(void)" (__imp_??1QWebView@@UAE@XZ) referenced in function "public: virtual void * __thiscall QWebView::`scalar deleting destructor'(unsigned int)" (??_GQWebView@@UAEPAXI@Z)
cookbook.obj : error LNK2019: unresolved external symbol "__declspec(dllimport) public: void __thiscall QWebView::load(class QUrl const &)" (__imp_?load@QWebView@@QAEXABVQUrl@@@Z) referenced in function "private: void __thiscall cookBook::on_pushButton_clicked(void)" (?on_pushButton_clicked@cookBook@@AAEXXZ)
debug\eCookBook2.exe : fatal error LNK1120: 29 unresolved externals
jom: C:\Users\Scott\Desktop\eCookBook\eCookBook2-build-Desktop_Qt_5_0_0_MSVC2010_32bit_SDK-Debug\Makefile.Debug [debug\eCookBook2.exe] Error 1120
jom: C:\Users\Scott\Desktop\eCookBook\eCookBook2-build-Desktop_Qt_5_0_0_MSVC2010_32bit_SDK-Debug\Makefile [debug] Error 2
15:05:01: The process "C:\QtCommercial\QtCommercial5.0.0\Tools\QtCreator\bin\jom.exe" exited with code 2.
Error while building/deploying project eCookBook2 (kit: Desktop Qt 5.0.0 MSVC2010 32bit (SDK))
When executing step 'Make' 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-29T15:11:03.817

首先尝试“运行 qmake”（从 Creator 中的“构建”菜单）重新生成 make 文件，然后重新构建。`.pro`基本上，每次修改文件后都需要“运行 qmake” 。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-02-09T16:45:21.210

1.  在 Creator 中按 Ctrl+5。
2.  取消选中“影子构建”。
3.  `.pro`将文件行更改为：

    ```
    QT += core gui network webkit webkitwidgets 
    ```

4.  重建项目

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-09-01T13:31:33.607

修复了相同的错误。尝试在包含中添加 qwebview.h 的路径，例如：（将“QtWebKitWidgets”更改为您的）

```
#include <QtWebKitWidgets/QWebView.h> 
```

而不仅仅是`#include <QWebView.h>`

尝试将其添加到所有使用 QWebView 的文件中。

# c++ - 在 Mac OSX 中使用 cv::VideoWriter 会产生“警告：无法创建空电影文件容器”。

> ID：14553494
> 
> 赞同：1
> 
> 时间：2013-01-27T23:24:09.637
> 
> 标签：c++, xcode, macos, opencv

我正在尝试在 Mac OSX 上使用 C++ 中的 OpenCV 4.3.2 将图像列表转换为视频文件。该项目正在 XCode 中编译。每次我运行我的代码时，都会出现以下输出：

> 警告：无法创建空电影文件容器。
> 
> 未能成功更新电影文件。

第一个警告是由于：

```
 writer.open(argv[2],codec,fps,size); 
```

关于更新电影文件的第二部分来自：

```
 writer << im; 
```

这是完整的代码：

```
#include <cv.h>
#include <highgui.h>

int main( int argc, char** argv )
{
    /*
        Skipping unrelated code
    */

    // Set FPS of movie
    double fps = 30;
    // Set frame size of movie
    cv::Size size = cv::Size(1920,1080);
    // VideoWriter stream to write images to
    cv::VideoWriter writer;
    int codec = CV_FOURCC('D', 'I', 'V', 'X');

    std::cout << "Using codec " << codec << std::endl;

    // Open VideoWriter stream
    writer.open(argv[2],codec,fps,size);

    // Verify that the VideoWriter is open
    if(!writer.isOpened())
    {
        std::cout << "VideoWriter unable to open" << std::endl;
        return -3;
    }

    // Structure to hold image
    cv::Mat im;

    for(int i = 0; i < photos.size(); i++)
    {
        // Read image from file
        im = cv::imread(photos[i].c_str(), 1 );

        if(im.data != NULL )
        {
            std::cout << "Writing " << photos[i] << " to file." << std::endl;
            // Resize it to match video output
            cv::resize(im,im,size);
            // Write image to VideoWriter stream
            writer << im;
        }
        else
        {
            std:: cout << "Unable to read file " << photos[i] << std::endl;

            return -4;
        }
    }

    return 0;
} 
```

我见过其他人有类似的错误，但没有解决方案修复它（例如更改编解码器等）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-04-04T19:39:57.173

我遇到了同样的问题。我尝试更改 codex 和格式。问题似乎是当我在一个听起来很愚蠢的字符串中创建目录时。（Mac OSX、C++、Eclipse、opencv）

```
string directory = "directory/videos/";
VideoWriter out_capture(directory, 
    CV_FOURCC('D', 'I', 'V', 'X'), frame_rate, Size(512,512)); 
```

当我直接添加目录时，它起作用了：

```
VideoWriter out_capture("directory/videos/", 
    CV_FOURCC('D', 'I', 'V', 'X'), frame_rate, Size(512,512)); 
```

如果有人提出更好的解决方案，我很想听听。

# eclipse - 无法安装理性软件架构师v8.5

> ID：14553497
> 
> 赞同：0
> 
> 时间：2013-01-27T23:24:24.193
> 
> 标签：eclipse, rational-rsa

我在安装 RSA V8.5 时遇到了以下异常，尽管我将再次安装它，但很想知道它背后的原因以及我们如何解决它。

```
Error during "complete" phase:
CRIMA1084E: The singleton bundle "org.eclipse.epf.richtext_1.6.0.v20101028_0720" 
cannot be installed in this Eclipse configuration because there is a 
non-singleton bundle "org.eclipse.epf.richtext_1.5.0.v20080714-1745" 
that is already installed. 
```

感谢您分享您的知识。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T01:12:16.700

您提到您选择通过扩展现有的 Eclipse 安装来安装 RSA。此消息告诉您 RSA 未安装特定组件，因为相同类型 ( `org.eclipse.epf.richtext`) 的组件已作为非单例存在。

这很可能会导致问题。尽管 IBM 确实为您提供了扩展现有 Eclipse 配置的机会，但它并没有明确说明您可以扩展哪些 Eclipse 版本。您现有的 Eclipse 安装似乎比 RSA 本身提供的版本更早。

您应该执行以下操作之一：

1.  不扩展现有的 Eclipse 安装。
2.  确保您正在扩展的 Eclipse 安装与 RSA 随附的 Eclipse 安装版本相同，以确保兼容性。RSA 附带 Eclipse 平台版本 3.6.3，即 Eclipse Helios。

# php - PHP：识别成功存储在数据库中的数据的函数

> ID：14553499
> 
> 赞同：0
> 
> 时间：2013-01-27T23:24:48.487
> 
> 标签：php, mysql

我试图在 PHP 中找到一种方法，一旦数据成功存储在数据库中，在这种情况下是注册数据，PHP 有一种方法可以识别这一点，也许是一个函数，然后可以执行下一个过程，例如加载一个页面，其中包含指向用户电子邮件的链接以进行帐户验证。同样在加载该页面时 header() 是最好的方法。我有一种偷偷摸摸的感觉，会议可能是要走的路。无论如何，所有的建议都非常感谢:)）））））

我遇到的问题是我想在特定点执行 header () 并且我已经编写了以下代码来执行此操作：

```
 $rowcount = $statement->rowCount();
         if ($rowcount === 1){
         header('Location:verifyemail.php');
          } 
```

我认为这段代码作为我正在使用的 PDO 类的一部分可以检查 MySql 数据库中的行是否刚刚通过 $statement->execute(); 更新。但是，由于已经有输出，标头将不起作用，我收到此错误：无法修改标头信息-标头已由（输出开始于.....但是如果我将标头（）放在输出之前，我会得到这个错误：PHP 致命错误：在......中的非对象上调用成员函数 rowCount() 我需要根据成功的数据库事务来重定向页面，但已经有输出时间我想执行那个.........我已经看到了一个 JS 解决方案，但如果关闭，该网站将基本上停止正常运行............

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T06:13:05.297

如果无法存储数据，数据库通常会返回错误。使用[PDO](http://php.net/manual/en/book.pdo.php)时，您可以这样做：

```
$db = new PDO(...);
$db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
try {
   $stmt = $db->prepare('INSERT INTO table (column) VALUES (?)');
   $stmt->execute(array('something'));
   doSomethingWhenInsertWasSuccessful();
}
catch (PDOException $e) {
   doSomethingBecauseInsertWasNotSuccessful();
} 
```

您可以安全地将`header()`-redirect 放入`doSomethingWhenInsertWasSuccessful()`函数中。除非您的应用程序事先写入任何输出，否则没有理由不这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T23:39:00.393

The most straightforward way I know of is to store the data in the database, then re-query the data back out. If the data comes back out, it was obviously stored correctly.

As far as using header or not, I see no problem with it. Just make sure after you set the header, the next line is "exit();" so execution will stop on the current page.

# sql - VB Count 查询结果在文本框中

> ID：14553507
> 
> 赞同：0
> 
> 时间：2013-01-27T23:26:09.390
> 
> 标签：sql, vb.net, ms-access-2007

我想在一个显示有多少结果的文本框中填充 Access 数据库上的 SQL 计数查询的结果。例如，我在数据库中输入了一个代码 200 次，我希望文本框显示 200。

到目前为止，这是我的代码：

```
 ID = DataGridView1.CurrentRow.Cells(0).Value
    fn = DataGridView1.CurrentRow.Cells(1).Value
    ln = DataGridView1.CurrentRow.Cells(2).Value
    SKU = DataGridView1.CurrentRow.Cells(4).Value
    FC = DataGridView1.CurrentRow.Cells(5).Value

    Dim countNoTwo As String = "SELECT COUNT skuNo FROM table WHERE skuNo = " & SKU & ""
    Dim connection As New OleDbConnection(duraGadgetDB)
    Dim dataadapter As New OleDbDataAdapter(countNoTwo, connection)
    Dim ds As New DataSet()
    connection.Open()
    dataadapter.Fill(ds, "dura")
    connection.Close()

   txtbox1.Text 
```

如何将数据集的结果绑定到 txtbox1.Text？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T23:50:10.327

*   一、不要使用字符串连接构建sql命令（原因= [Sql Injection](https://stackoverflow.com/questions/332365/xkcd-sql-injection-please-explain) + Parsing 问题）
*   其次，如果您的命令只返回一个结果，您可以使用 [ExecuteScalar](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executescalar.aspx)
*   三、使用[Using语句](http://msdn.microsoft.com/en-us/library/htd05whh.aspx)确保你的连接和命令在使用后正确处理

    ```
    Dim countNoTwo As String = "SELECT COUNT skuNo FROM table WHERE skuNo = ?"
    Using connection As New OleDbConnection(duraGadgetDB)
        Using command As New OleDbCommand(countNoTwo, connection)
           command.Parameters.AddWithValue("@sku", SKU)
           connection.Open()
           Dim result = Convert.ToInt32(command.ExecuteScalar())
           txtbox1.Text = result.ToString
        End Using
    End Using 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T23:31:49.327

尝试这个

```
Dim dt As DataTable = ds.Tables(0)
txtbox1.Text = dt.Rows(0).Item(0).ToString() 
```

# android - 为什么使用应用内计费设置开发人员有效负载很重要？

> ID：14553515
> 
> 赞同：78
> 
> 时间：2013-01-27T23:26:44.973
> 
> 标签：android, android-billing

我正在使用第 3 版的应用内计费 API。我有一个单一的、托管的、非消耗品。我还没有在我的应用程序中发布这个功能，所以我想在购买之前决定购买有效载荷的内容。

来自[“安全最佳实践”](http://developer.android.com/google/play/billing/billing_best_practices.html)：

> **发出购买请求时设置开发者有效负载字符串**
> 
> 使用 In-app Billing Version 3 API，您可以在向 Google Play 发送购买请求时包含一个“开发者有效负载”字符串令牌。通常，这用于传递唯一标识此购买请求的字符串令牌。如果您指定字符串值，Google Play 会将此字符串与购买响应一起返回。随后，当您查询此次购买时，Google Play 会返回此字符串以及购买详情。
> 
> 您应该传入一个字符串令牌，以帮助您的应用程序识别进行购买的用户，以便您以后可以验证这是该用户的合法购买。对于消耗品，您可以使用随机生成的字符串，但对于非消耗品，您应该使用唯一标识用户的字符串。
> 
> 当您从 Google Play 收到响应时，请确保验证开发人员有效负载字符串与您之前随购买请求发送的令牌匹配。作为进一步的安全预防措施，您应该在自己的安全服务器上执行验证。

对或错，我决定*不*采取设置服务器进行购买验证的“进一步安全预防措施”。而且我不存储自己的购买记录——我总是调用计费 API。那么我真的有任何理由进行此有效负载验证吗？验证 API 本身肯定会在将商品报告为已购买之前验证用户的身份，如果攻击者入侵了设备（应用程序或 google play API），我看不出进行额外检查有什么好处用户在设备上的标识，很容易被绕过。还是有我没有想到的这样做的理由？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2013-01-28T01:51:46.143

如果您不保留记录，则无法验证您收到的内容是否就是您发送的内容。因此，如果您将某些内容添加到开发人员有效负载中，您可以相信它是合法的（如果签名验证，这是一个合理的假设），或者不完全信任它并且仅将其用作参考，但不能用于验证许可证状态等. 例如，如果您存储用户电子邮件，您可以使用该值而不是要求他们再次输入它，这对用户来说稍微友好一些，但如果它不存在，您的应用程序不会中断。

就个人而言，我认为整个“最佳实践”部分令人困惑，并且试图让您做 API 真正应该做的工作。由于购买与 Google 帐户相关联，并且 Play 商店显然会保存此信息，因此他们应该在购买详细信息中为您提供此信息。获取正确的用户 ID 需要额外的权限，您不需要添加这些权限只是为了弥补 IAB API 的缺陷。

因此，简而言之，除非您有自己的服务器和特殊的附加逻辑，否则不要使用开发人员有效负载。你应该没问题，只要 IAB v3 API 有效（不幸的是，此时这是一个很大的“如果”）。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2013-05-04T06:37:17.263

> 您应该传入一个字符串令牌，以帮助您的应用程序识别进行购买的用户...

如果您的应用程序提供自己的用户登录名和身份，这与手机所连接的 Google 帐户不同，那么您需要使用开发人员有效负载将购买附加到您进行购买的帐户之一。否则，有人可能会在您的应用中切换帐户，并从购买的东西中受益。

例如

假设我们的应用程序有用户 A 和用户 B 的登录名。而手机的安卓谷歌账号是X。

1.  userA，登录我们的应用程序并购买生活会员。购买详情存储在谷歌账户 X 下。
2.  userA 退出，userB 登录到我们的应用程序。现在，userB 也获得了终身会员的福利，因为 android google 帐号仍然是 X。

为避免此类滥用，我们会将购买绑定到一个帐户。在上面的示例中，我们将在 userA 进行购买时将开发人员有效负载设置为“userA”。因此，当用户 B 登录时，有效负载将与登录用户 (userB) 不匹配，我们将忽略购买。因此，用户B 无法从用户A 的购买中获得收益。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-03-26T15:38:05.130

开发人员有效负载处理还有另一种方法。正如 Nikolay Elenkov 所说，要求用户 ID 和为您的应用程序设置用户配置文件的额外权限的开销太大，所以这不是一个好方法。因此，让我们看看 Google 在 In-App Billing v3 示例中最新版本的 TrivialDrive 示例应用中所说的内容：

> *   警告：在开始购买时本地生成随机字符串并在此处进行验证似乎是一种好方法，但如果用户在一台设备上购买商品然后在另一台设备上使用您的应用程序，这将失败，因为在您将无法访问您最初生成的随机字符串的其他设备。

因此，如果您要在另一台设备上验证购买的商品，随机字符串不是一个好主意，但他们仍然没有说这不是验证购买响应的好主意。我想说 - 仅使用开发人员有效负载通过发送随机唯一字符串来验证购买，将其保存在首选项/数据库中，并在购买响应中检查此开发人员有效负载。至于在活动开始时查询库存（应用内购买） - 不要费心检查开发人员有效负载，因为这可能发生在您没有存储随机唯一字符串的另一台设备上。我就是这么看的。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2014-12-01T10:45:14.720

这取决于您如何验证`developerPayload`. 有两种场景：远程验证（使用服务器）和本地（在设备上）。

**服务器**

如果您使用服务器进行`developerPayload`验证，它可以是可以在设备和服务器上轻松计算的任意字符串。您应该能够识别执行请求的用户。假设每个用户都有对应`accountId`的 ，`developerPayload`可以`purchaseId`像这样与 (SKU name) 组合计算：

```
MD5(purchaseId + accountId) 
```

**设备**

`developerPayload` **不应该是用户电子邮件**。Google for Work 服务就是您不应使用电子邮件作为有效负载的一个很好的例子。用户可以更改与该帐户关联的电子邮件。唯一不变的是`accountId`。在大多数情况下，电子邮件是可以的（例如，Gmail 地址目前是不可变的），但请记住为未来设计。

多个用户可能使用同一设备，因此您必须能够区分谁是该项目的所有者。对于设备验证`developerPayload`，是一个唯一标识用户的字符串，例如：

```
MD5(purchaseId + accountId) 
```

**结论**

通常，`developerPayload`在这两种情况下可能只是`accountId`. 对我来说，它看起来像是[默默无闻的安全](https://en.wikipedia.org/wiki/Security_through_obscurity)。MD5（或其他散列算法）`purchaseId`只是一种使有效负载更加随机的方法，而无需明确显示我们正在使用帐户的 id。攻击者必须反编译应用程序以检查其计算方式。如果应用程序被混淆，对你来说更好。

**有效载荷不提供任何安全性**。它可以很容易地通过“设备”方法进行欺骗，而无需在“服务器”检查中进行任何努力。请记住使用您在 Google Publisher 帐户控制台中提供的公钥来实施签名检查。

*关于使用帐户 ID 而非电子邮件[的必读](http://android-developers.blogspot.com/2014/10/tips-for-integrating-with-google.html)博文。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2018-11-06T01:06:00.987

2018 年末更新：官方 Google Play 计费库有意不公开`developerPayload`. 从[这里](https://issuetracker.google.com/issues/63381481#comment3)：

> 字段 developerPayload 是一个遗留字段，保持与旧实现的兼容性，但如购买应用内计费产品页面（[https://developer.android.com/training/in-app-billing/purchase-iab ）所述-products.html](https://developer.android.com/training/in-app-billing/purchase-iab-products.html)），在完成与应用内结算相关的任务时，此字段并不总是可用。由于该库旨在代表最新的开发模型，因此我们决定在我们的实现中不支持 developerPayload，并且我们没有计划将此字段包含到库中。
> 
> 如果您将应用内计费逻辑的任何重要实现依赖于 developerPayload，我们建议您更改此方法，因为此字段将在某个时候（或很快）被弃用。推荐的方法是使用您自己的后端来验证和跟踪有关您的订单的重要详细信息。有关更多详细信息，请查看安全和设计页面 ( [https://developer.android.com/google/play/billing/billing_best_practices.html](https://developer.android.com/google/play/billing/billing_best_practices.html) )。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-03-16T07:46:20.127

在琐碎驱动器示例的作者本人提供的有关 IAB v3 的 Google IO 视频中，在视频结尾处简要介绍了这一点。这是为了防止重放攻击，例如攻击者嗅探流量，窃取包含成功购买的数据包，然后尝试在自己的设备上重放数据包。如果您的应用在发布高级内容（也最好是从您的服务器上）之前没有通过开发负载（理想情况下在您的服务器上）检查买家的身份，那么攻击者就会成功。签名验证无法检测到这一点，因为数据包是完整的。

在我看来，这种保护似乎非常适合具有在线帐户连接的应用程序，例如部落冲突（有效负载自然会出现，因为无论如何您都必须识别用户），尤其是在黑客破坏多人游戏玩法的情况下，除了简单的本地化盗版案例外，还具有深远的影响. 相反，如果客户端对 apk 的黑客攻击已经可以解锁高级内容，那么这种保护就不是很有用了。

（如果攻击者试图欺骗有效载荷，签名验证应该会失败）。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-03-06T04:11:11.337

我与这个斗争。由于 Google Play 帐户只能拥有任何“托管”项目中的一个，但可以拥有多个设备（我有三个），因此您出售“每个设备”的上述评论将不起作用......他们会能够将它放在他们的第一台设备上，而其他任何设备都没有......如果您购买高级升级，它应该可以在您的所有手机/平板电脑上使用。

我鄙视获取用户电子邮件地址的想法，但我真的没有找到其他可靠的方法。因此，我在帐户列表中获取与“google.com”匹配的第一个帐户（是的，添加到您的清单的权限），然后立即对其进行哈希处理，使其不再可用作电子邮件地址，但确实提供了“足够独特“令牌。这就是我作为开发人员有效负载发送的内容。由于大多数人使用他们的 Google Play id 激活他们的设备，因此很可能所有三个设备都将获得相同的令牌（在每个设备上使用相同的哈希算法）。

它甚至可以在具有多个“用户”的 KitKat 上运行。（我的开发者 ID 在一个用户上，我的测试 ID 在另一个用户上，每个用户都在自己的沙箱中）。

我已经在总共 3 个用户的六台设备上对其进行了测试，每个用户的设备都返回了相同的哈希值，并且不同的用户都有不同的哈希值，满足了指导方针。

我绝不会存储用户的电子邮件地址，它直接从代码中传递以获取帐户名称到哈希函数，并且只有哈希值保存在堆中。

可能还有更好的解决方案，更加尊重用户隐私，但到目前为止我还没有找到。一旦应用程序发布，我将非常清楚地说明我如何在我的隐私政策中使用用户电子邮件地址。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-03-24T22:36:11.610

这通常响应产品定义（您的应用程序）。例如订阅的情况。同一用户能否在他/她拥有的所有设备上使用订阅？如果答案是肯定的。我们没有检查有效载荷。

对于消耗品。假设您的应用程序中的一次购买给了您 10 个虚拟硬币。用户能否在不同的设备上使用这些硬币？一台设备上 4 个，另一台设备上 6 个？如果我们只想在购买的设备上工作，我们必须检查有效负载，例如使用自行生成的字符串并在本地存储。

基于这些问题，我们必须决定如何实施有效载荷检查。

问候

圣地亚哥

# wordpress - 在二十十二儿童主题中将菜单上移到徽标旁边

> ID：14553517
> 
> 赞同：1
> 
> 时间：2013-01-27T23:27:13.457
> 
> 标签：wordpress

我正在做我的第一个基于 212 主题的 WordPress 子主题，我想将我的菜单上移到我的标题徽标旁边......

下面是它现在的外观示例，以及我想要实现的目标......蓝色框代表标题徽标，我希望我的菜单出现在它的右侧......

![例子](../Images/6ce90c215587a94487bac1f70f651e96.png)

我当前的菜单 CSS 是：

```
.main-navigation ul.nav-menu, .main-navigation div.nav-menu > ul {
    display: inline-block !important;
    text-align: right;
    color: #656565;
    font-size: 0.9em;
    font-family: Verdana, Geneva, sans-serif;   
} 
```

我发现这个[SO 帖子](https://stackoverflow.com/questions/13199046/twenty-twelve-header-image-and-navigation-in-same-line)是关于相同的，但是当我使用它提出的解决方案时，我的菜单突然在我的网站上的帖子下方...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T09:02:43.337

好吧，通过将位置样式放置在#site-navigation 而不是我以前的代码中然后使用这些值（使用顶部而不是底部）来让它工作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T20:06:45.070

您还可以考虑更改 stylesheet.css 文件中的标签“nav”显示样式：

```
nav {
    display: block;
} 
```

尝试内联块或内联。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T20:36:35.880

```
#masthead hgroup {float: left;}
nav#site-navigation {float: right; width: 500px;} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-11T21:29:33.487

```
#masthead {position: relative;}

#site-navigation {
    position: absolute;
    bottom: 0; /* or top, if you prefer */
    right: 0;
} 
```

# python - Python - 嵌套 if 的相同 else 代码

> ID：14553519
> 
> 赞同：2
> 
> 时间：2013-01-27T23:27:34.053
> 
> 标签：python, django

在 Django 中，处理表单的规范方式是：

```
if request.method == 'POST':
    form = SomeForm(request.POST)
    if form.is_valid():
        use the form data 
```

无论没有 POST 还是表单无效，我都想执行相同的代码 - 这是几行代码，所以我想知道是否有比两个重复的 else 块更好的方法（一个用于内部if 和一个用于外部）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T23:32:13.797

使用单独的函数：

```
if request.method != 'POST':
    return do_something_function_for_invalid(request)

form = SomeForm(request.POST)
if not form.is_valid():
    return do_something_function_for_invalid(request)

# do something 
```

然后定义`do_something_function_for_invalid()`为：

```
def do_something_function_for_invalid(request):
    # do something

    return response 
```

或者，使用异常处理：

```
try:
    if request.method != 'POST':
        raise ValueError('invalid form')

    form = SomeForm(request.POST)
    if not form.is_valid():
        raise ValueError('not a POST request')

     # do something
except ValueError as ve:
    # handle ve exception, ve.args[0] is the error message 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-27T23:36:50.210

A very concise way that does not require a separate function, and doesn't repeat conditions:

```
form = SomeForm(request.POST) if request.method == 'POST' else None

if form and form.is_valid():
    # do your valid-submission stuff
else:
    # do your invalid-submission stuff 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T23:31:43.773

简单到

```
if (request.method != 'POST') or (not SomeForm(request.POST).is_valid()):
   do something 
```

# python - VTK 将窗口图像渲染到 numpy 数组

> ID：14553523
> 
> 赞同：12
> 
> 时间：2013-01-27T23:28:06.437
> 
> 标签：python, numpy, vtk

在 VTK 中，我可以使用以下代码段将渲染窗口保存为图像。但是，实际上我想直接将它作为一个 numpy 数组获取（无需写入然后读取）。

```
im = vtkWindowToImageFilter()
writer = vtkPNGWriter()
im.SetInput(renderWindow)
im.Update()
writer.SetInputConnection(im.GetOutputPort())
writer.SetFileName("file.png")
writer.Write() 
```

做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-28T18:40:44.670

我相信没有必要涉及`vtkXWriter`（`X`某种格式在哪里），除非您需要`X`格式中的数据。在定义了要将其内容导出为图像的窗口后，您可以继续获取 VTK 图像并使用它。

```
from vtk.util.numpy_support import vtk_to_numpy

...

vtk_rw = vtk.vtkRenderWindow()

...

vtk_win_im = vtk.vtkWindowToImageFilter()
vtk_win_im.SetInput(vtk_rw)
vtk_win_im.Update()

vtk_image = vtk_win_im.GetOutput()

width, height, _ = vtk_image.GetDimensions()
vtk_array = vtk_image.GetPointData().GetScalars()
components = vtk_array.GetNumberOfComponents()

arr = vtk_to_numpy(vtk_array).reshape(height, width, components)

... 
```

# c - 为什么我在这个带有 C (LINUX) 线程的小程序中得到这些结果？

> ID：14553526
> 
> 赞同：3
> 
> 时间：2013-01-27T23:28:12.617
> 
> 标签：c, linux, pthreads

我有一个在操作系统课程的考试科目中发现的小程序。

```
void * func (void * p) {
    int n = p;
    printf("%d \n",n);
    return NULL;
}

int main() {
    int i;
    pthread_t t[3];
    for(i=0; i<3; i+=1)
        pthread_create(&t[i] ,NULL, func, (void*)i);
    return 0;
} 
```

当我运行它时，我得到以下结果（每个数字后都有一个新行）：

> 第一次运行：0 0
> 第二次运行：1 0 2 2
> 第三次运行：0 1 1

为什么当我只创建 3 个线程时它会打印 4 个数字。它如何打印重复项？

代码在 Ubuntu 中使用 gcc 编译。

![终端截图](../Images/3da8f39b3e2a37a8c5f3e9ef6ea566ff.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-27T23:40:48.170

在退出 main() 之前不要加入线程。将以下内容添加到`main()`：

```
for(i=0; i<3; i+=1)
    pthread_join(t[i], NULL); 
```

当程序退出时线程继续执行时，不加入线程会导致*未定义的行为。*未定义的行为可以自由地做任何事情，包括打印重复项。

这样想，`void*`传递给线程的值存储在某个地方，一旦你过早退出 main，你*可能会*破坏要传递给线程的数据，此时它可以采用任何值（包括重复值）。但这甚至不值得尝试解释，因为它是*未定义的行为*。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T23:45:05.960

`return`from`main`函数相当于调用`exit`并终止整个过程。所以它或多或少是随机的，哪个输出可以通过你的屏幕。您应该执行以下操作之一

*   加入您创建的所有线程
*   `pthread_exit`在结束时调用`main`而不是调用`exit`或使用`return`

# javascript - 使用 $.ajax 从服务器上的文本文件中读取数据以调用 php 脚本

> ID：14553531
> 
> 赞同：1
> 
> 时间：2013-01-27T23:29:27.397
> 
> 标签：javascript, php, jquery

这是我第一次在这个网站上发帖。我查看了与该主题相关的几个先前的帖子，但没有找到适合我的任何内容。我正在尝试使用 javascript 和 jquery $.ajax 在服务器上调用 php 脚本并返回文件的内容。到目前为止，我没有得到任何数据。我可以使用 $.ajax 更新服务器上的 .txt 文件，但可以使用一些帮助来找出我做错了什么来检索它。我没有看到从 php 脚本生成的任何错误，并且 events.txt 文件不是空白的。vb.net 和 c# 是我的母语，所以这对我来说有点陌生。

我的js是：

```
function readText() {
        var url = "readdata.php";
        var result = "";
        $.ajax({
            url: url,
            type: 'get',
            dataType: 'text',
            success: function (data) {
                result = data;
                alert(result);
            },
            async: false
        });
    } 
```

我的 readdata.php 脚本是：

```
<? 
$file=fopen("events.txt","r");
$read=fread($file,filesize("events.txt"));
fclose($file); 
echo $read;
?> 
```

欢迎任何建议。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T23:51:27.210

$.ajax 中的类型应该是大写的

```
type: 'GET'

function readText() {
        var url = "readdata.php";
        var result = "";
        $.ajax({
            url: url,
            type: 'GET',
            dataType: 'text',
            success: function (data) {
                result = data;
                console.info(result);
            },
            async: false
        });
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-24T19:40:52.523

添加`error: function(){}`到 ajax 调用后，我能够解决这个问题。

事实证明，问题的一部分是服务器上的权限（无法从服务器上的文件权限中读取文件）。

我也试图在本地运行，但我的本地机器上没有安装 php。

# javascript - 如何使用 JavaScript 获取选定的文本

> ID：14553534
> 
> 赞同：4
> 
> 时间：2013-01-27T23:30:01.410
> 
> 标签：javascript, getselection

我有点困惑为什么这段代码不起作用！

HTML 标记：

```
<div id="diva"><b>Score</b> some <i>goals</i></div>
<div id="soda"></div> 
```

JavaScript 代码：

```
function GetSelectedText () {
if (window.getSelection) {  // all browsers, except IE before version 9
    var range = window.getSelection ();
    alert (range.toString ());
} 
else {
    if (document.selection.createRange) { // Internet Explorer
        var range = document.selection.createRange ();
        alert (range.text);
    }
}
}

var butn = document.getElementById("soda");
butn.onclick = function(){
    GetSelectedText();
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-28T00:16:43.167

您可能会遇到的一个问题是，在某些浏览器（尤其是 IE）中，当按钮的`click`事件触发时，选择已被破坏。您可以通过使用`mousedown`事件来解决此问题（它仍然允许销毁选择，但仅在处理事件之后），或者通过[使按钮 unselectable](https://stackoverflow.com/questions/826782/css-rule-to-disable-text-selection-highlighting/4358620#4358620)。

我假设您的按钮不是实际的按钮输入，因为这种行为只发生在常规元素上。

演示：http: [//jsfiddle.net/L9bvU/1/](http://jsfiddle.net/L9bvU/1/)

```
function GetSelectedText () {
    if (window.getSelection) {  // all browsers, except IE before version 9
        var range = window.getSelection ();
        alert (range.toString ());
    } 
    else {
        if (document.selection.createRange) { // Internet Explorer
            var range = document.selection.createRange ();
            alert (range.text);
        }
    }
}
```

```
span {
    background-color: #ccc;
    padding: 3px;
    border: solid gray 1px;

}

*[unselectable="on"] {
   -moz-user-select: -moz-none;
   -khtml-user-select: none;
   -webkit-user-select: none;

   /*
     Introduced in IE 10.
     See http://ie.microsoft.com/testdrive/HTML5/msUserSelect/
   */
   -ms-user-select: none;
   user-select: none;
}
```

```
<div contenteditable="true">Please select some of this text and press a button below</div>

<span onclick="GetSelectedText()">Click</span>
<span onmousedown="GetSelectedText()">Mousedown</span>
<span unselectable="on" onclick="GetSelectedText()">Click, unselectable</span>
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-02-20T15:59:01.007

```
function getSelectedText() {
    if (window.getSelection) {
        return window.getSelection();
    } 
    if (window.document.getSelection) {
        return window.document.getSelection();
    } 
    if (window.document.selection) {
        return window.document.selection.createRange().text;
    }
    return "";  
} 
```

```
<p onmouseup="getSelectedText(); alert(txt)">
Highlight some of this text
with the mouse select press button end release
to fire the event. </p> 
```

*这是我的方式*。您只需要选择文本结束警报文本或其他任何内容。
有谁知道 OnMouse(event) 如何在 html 中为整个文档设置，并且不必直接添加到 html 页面。
另一方面，*我们可以改变萤火虫中的元素！*>-示例

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-28T00:25:38.127

那么上面的代码有两个问题。- 你不能保证

```
var butn = document.getElementById("soda"); 
```

将起作用，因为它可能在文档完成加载之前执行

- 当您单击另一个不是按钮的元素时，选择会丢失。如果您将“苏打水” div 更改为，那么它将起作用：

> ```
> <div id="diva"><b>Score</b> some <i>goals</i></div>
> <div id="soda" onclick="GetSelectedText()">This will NOT work</div>
> <input type="button" onclick="GetSelectedText()" value="This will work"/> 
> ```

但是，我强烈建议您按照此处其他人的建议查看 jQuery；它会让你的喜欢*更*容易！

# html - 防止浏览器中的后退按钮？

> ID：14553537
> 
> 赞同：0
> 
> 时间：2013-01-27T23:30:13.900
> 
> 标签：html, forms, http, web, browser

我做了 30 多分钟的研究，但我无法弄清楚问题所在。我想防止用户在浏览器中回击并再次查看该页面。我该如何预防？我进行了大量研究并查看了我的银行发送的标题，但仍然无法弄清楚问题所在。

我必须支持 firefox，但让它在其他浏览器上工作也很好。

我发布的标题是（我通过查看我的浏览器认为的响应来确认）

```
Expires: Thu, 01 Jan 1970 00:00:00 GMT
Pragma: No-cache
Cache-Control: no-cache 
```

在 html 我开​​始

```
<!DOCTYPE html>
<html>
<head>
    <title>The Title</title>
    <link href="/my.css" rel="stylesheet" type="text/css" />
    <META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE">
    <META HTTP-EQUIV="EXPIRES" CONTENT="Thu, 01 Jan 1970 00:00:00 GMT">
    <META HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE">
</head> 
```

当我提交表单并回击时，我仍然可以看到该页面。我想让浏览器说文档过期/无效或重置所有 html，这样表单就没有用户数据了。我该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T23:45:42.777

Have a look at [History.js by Benjamin Lupton](https://github.com/balupton/History.js/). You can register an event handler to the `onstatechange` event and then prevent the default action. We use the jQuery adapter and handle our own history records because of Ajax requests with a method like this.

```
History.Adapter.bind(window, 'statechange', function() {
    var HistoryState = History.getState();
    if (HistoryState) {

        var stateData = HistoryState.data;

        if (stateData) {

        }
    }
}); 
```

You should be able to use [e.preventdefault](https://stackoverflow.com/questions/2017755) and stop the user going back.

We add the state data object for each page in the data object with `History.pushState(state, null, '');` but not sure if you need any data to stop them going back.

# ios - NSURLConnection - didReceiveData 没有被调用 - iOS & ARC

> ID：14553538
> 
> 赞同：3
> 
> 时间：2013-01-27T23:30:17.680
> 
> 标签：ios, http, ios6, nsurlconnection

我目前正在尝试使用 twitter 流 api，并且正在尝试使用`NSURLConnection`. 由于它不适用于 twitter，我简化了所有内容并尝试从 google 的网站上获取一些源代码，但这也不起作用。

连接开始和结束，但不调用`didReceiveData`委托。我确定我错过了一些东西。希望你们能帮助我！

在标题中：`@interface ViewController : UIViewController <NSURLConnectionDataDelegate, NSURLConnectionDelegate, NSURLConnectionDownloadDelegate, NSURLAuthenticationChallengeSender>`

在体内：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    NSURLConnection *connection;
    NSMutableURLRequest *request;
    // Do any additional setup after loading the view, typically from a nib.
    request = [[NSMutableURLRequest alloc] initWithURL:[NSURL URLWithString:@"http://www.google.com"]];
    [request setHTTPMethod:@"GET"];
    connection = [[NSURLConnection alloc] initWithRequest:request delegate:self];
    [connection start];
}

- (void)connectionDidFinishDownloading:(NSURLConnection *)connection destinationURL:(NSURL *)destinationURL {
    NSLog(@"Stream finished.");
}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
    NSString *dataString = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
    NSLog(@"%@", dataString);
}

- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error{
    NSLog(@"Connection failed!");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T04:25:00.663

几个想法。

1.  您的声明[`connectionDidFinishLoading`](http://developer.apple.com/library/ios/documentation/Foundation/Reference/NSURLConnectionDataDelegate_protocol/Reference/Reference.html#//apple_ref/occ/intfm/NSURLConnectionDataDelegate/connectionDidFinishLoading%3a)看起来不正确。标准[`NSURLConnectionDataDelegate`](http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSURLConnectionDataDelegate_protocol/Reference/Reference.html)方法没有`destinationURL`参数：

    ```
    - (void)connectionDidFinishLoading:(NSURLConnection *)connection
    {
        NSLog(@"%s", __FUNCTION__);
    } 
    ```

2.  鉴于 的存在`NSURLAuthenticationChallengeSender`，如果您期待挑战（您不会通过 Google 网站获得），那么您显然会相应地处理它：

    ```
    - (void)connection:(NSURLConnection *)connection didReceiveAuthenticationChallenge:(NSURLAuthenticationChallenge *)challenge
    {
        // For example, if you have a userid/password to use, see if this is the first 
        // challenge, and then tell NSURLConnection to try using those credentials, and if 
        // it failed a second time, you might just cancel the authentication challenge.

        if (challenge.previousFailureCount == 0) {
            NSURLCredential *credential = [NSURLCredential credentialWithUser:kUserID password:kPassword persistence:NSURLCredentialPersistenceForSession];
            [challenge.sender useCredential:credential forAuthenticationChallenge:challenge];
        } else {
            [challenge.sender cancelAuthenticationChallenge:challenge];
        }
    } 
    ```

3.  顺便说一句，您不想[`start`](http://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSURLConnection_Class/Reference/Reference.html#//apple_ref/doc/uid/20001697-SW4)在使用`initWithRequest`or时调用方法`connectionWithRequest`。`initWithRequest:delegate:startImmediately:`仅当您执行简单操作并指示它*不要* 时才需要它`startImmediately`。

4.  无论如何，我使用了以下，它工作正常：

    ```
    - (void)viewDidLoad
    {
        [super viewDidLoad];

        NSMutableURLRequest *request = [[NSMutableURLRequest alloc] initWithURL:[NSURL URLWithString:@"http://www.google.com"]];
        [NSURLConnection connectionWithRequest:request delegate:self];
    }

    - (void)connectionDidFinishLoading:(NSURLConnection *)connection
    {
        NSLog(@"%s", __FUNCTION__);
    }

    - (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
        NSString *dataString = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
        NSLog(@"%s: %@", __FUNCTION__, dataString);
    }

    - (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error{
        NSLog(@"%s error=%@", __FUNCTION__, error);
    } 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T23:47:28.437

您的 NSURLConnection 局部变量`connection`在`viewDidLoad`. 向您的 ViewController 添加一个属性以在范围内保存 NSURLConnection 变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T23:33:44.907

这里有人说是他们的SOAP格式 [NSURLConnection委托方法：didReceiveData not called ...Why ?? (iPhone SDK)](https://stackoverflow.com/questions/3923190/nsurlconnection-delegate-method-didreceivedata-not-called-why-iphone-sdk)

这也可能是您正在寻找的 [NSURLConnection didReceiveData not called](https://stackoverflow.com/questions/11420469/nsurlconnection-didreceivedata-not-called)

# ruby-on-rails - Rails 3 - has_many 通过自引用跟随/跟随关系的嵌套路由

> ID：14553543
> 
> 赞同：1
> 
> 时间：2013-01-27T23:31:43.803
> 
> 标签：ruby-on-rails, routes, nested

我使用这个答案建立了这样的关系：[Ruby on Rails has_many through self-referential following/follower Relations](https://stackoverflow.com/questions/6762919/ruby-on-rails-has-many-through-self-referential-following-follower-relationships)

所以我有以下模型：

```
class User < ActiveRecord::Base

  has_many :is_trustings
  has_many :trusted_users, :through => :is_trustings, :source => 'trusted'

  has_many :trusters, :class_name => 'IsTrusting', :foreign_key => 'trusted_id'
  has_many :trusting_users, :through => :trusters, :source => :user

end 
```

&

```
class IsTrusting < ActiveRecord::Base
  belongs_to :user
  belongs_to :trusted, :class_name => 'User'
end 
```

在控制台中使用它时一切正常。现在我想创建一个嵌套路由以允许客户端检索用户的关注者。

但它不像我期望的那样工作......

看，在我的 routes.rb 中我写了

```
resources :user do
   resources :is_trusting
   resources :trusted_users
   resources :trusting_users
end 
```

威奇制作这样的路线：

```
/users/:user_id/is_trustings(.:format)       is_trusting#index 
```

我可以接受这个，因为它是中间模型

现在我想要嵌入式模型，但这是我得到的：

```
/users/:user_id/trusted_users(.:format)       trusted_users#index
/users/:user_id/trusting_users(.:format)      trusting_users#index 
```

这显然不起作用，因为没有 TrustedUsersController。我不希望这条路线用于 UserController。

必须有一个内置的快捷方式，例如模型中的 :class_name => 'Users'...

有人知道吗？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T00:13:31.957

据我了解，您可以使用`:controller`密钥

```
#....
 resources :trusted_users, :controller => :users
#.. 
```

希望你要求它）

# android - Android 连接到 Python 服务器

> ID：14553546
> 
> 赞同：0
> 
> 时间：2013-01-27T23:31:52.180
> 
> 标签：android, python, tcp

我的朋友用 Python 制作了一个服务器，并希望我创建一个连接到它的 Android 应用程序，但我不知道从哪里开始。这是服务器的代码。任何人都可以帮助我或让我走上正确的道路吗？

```
from twisted.internet.protocol import Factory, Protocol
from twisted.internet import reactor

class IphoneChat(Protocol):
    def connectionMade(self):
        self.factory.clients.append(self)
        print "clients are ", self.factory.clients

    def connectionLost(self, reason):
        self.factory.clients.remove(self)

    def dataReceived(self, data):
        a = data.split(':')
        print a
        if len(a) > 1:
            command = a[0]
            content = a[1]

            msg = ""
            if command == "iam":
                self.name = content
                msg = self.name + " has joined"

            elif command == "msg":
                msg = self.name + ": " + content

            print msg

            for c in self.factory.clients:
                c.message(msg)

    def message(self, message):
        self.transport.write(message + '\n')

factory = Factory()
factory.protocol = IphoneChat
factory.clients = []

reactor.listenTCP(5633, factory)
print "Chat Server Started..."
reactor.run() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T00:31:54.473

如果您是网络编程的新手，那么阅读[客户端-服务器模型](https://en.wikipedia.org/wiki/Client%E2%80%93server_model)和[套接字](https://en.wikipedia.org/wiki/Network_socket)（[尤其是伯克利的](https://en.wikipedia.org/wiki/Berkeley_sockets)套接字）是一个好的开始。

一旦你掌握了基本概念，你会想要查看[Android 套接字文档](https://developer.android.com/reference/java/net/Socket.html)，最后尝试[一个教程](http://micropilot.tistory.com/entry/Android-Socket-example)

# php - 什么是最好的 php DOM 2 数组函数？

> ID：14553547
> 
> 赞同：4
> 
> 时间：2013-01-27T23:31:55.120
> 
> 标签：php, xml, arrays, domdocument

我想解析 xml 文件，到目前为止我发现的最好方法是使用 DOMDocument() 类。

示例 xml 字符串：

```
<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
<response>
<resData>
<contact:infData xmlns:contact="http://example.com/contact-1.0">
<contact:status s="value1"/>
<contact:status s="value2"/>
<contact:status s="value3"/>
<contact:status s="value4"/>
</contact:infData>
</resData>
</response> 
```

我使用函数 dom2array（波纹管）来解析 dom，但它只返回 1 个元素（仅限 value4）

```
<?php
    function dom2array($node) {
    $res = array();
    if($node->nodeType == XML_TEXT_NODE){
       $res = $node->nodeValue;
    }else{
       if($node->hasAttributes()){
           $attributes = $node->attributes;
            if(!is_null($attributes)){
               $res['@attributes'] = array();
               foreach ($attributes as $index=>$attr) {
                   $res['@attributes'][$attr->name] = $attr->value;
               }
           }
       }
       if($node->hasChildNodes()){
           $children = $node->childNodes;
           for($i=0;$i<$children->length;$i++){
               $child = $children->item($i);
               $res[$child->nodeName] = dom2array($child);
           }
       }
    }
    return $res;
    }
?> 
```

有没有办法解析所有 xml 元素并将它们发送到数组？

输出数组：

```
Array
(
[response] => Array
    (
        [#text] => 

        [resData] => Array
            (
                [#text] => 

                [contact:infData] => Array
                    (
                        [#text] => 

                        [contact:status] => Array
                            (
                                [@attributes] => Array
                                    (
                                        [s] => value4
                                    )

                            )

                    )

            )

    )

) 
```

value1, value2, value3 在哪里？：（ 谢谢

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-01-28T01:47:31.930

您可以使用它（基于： http: [//php.net/manual/en/book.dom.php#93717](http://php.net/manual/en/book.dom.php#93717)）；

```
function xml_to_array($root) {
    $result = array();

    if ($root->hasAttributes()) {
        $attrs = $root->attributes;
        foreach ($attrs as $attr) {
            $result['@attributes'][$attr->name] = $attr->value;
        }
    }

    if ($root->hasChildNodes()) {
        $children = $root->childNodes;
        if ($children->length == 1) {
            $child = $children->item(0);
            if ($child->nodeType == XML_TEXT_NODE) {
                $result['_value'] = $child->nodeValue;
                return count($result) == 1
                    ? $result['_value']
                    : $result;
            }
        }
        $groups = array();
        foreach ($children as $child) {
            if (!isset($result[$child->nodeName])) {
                $result[$child->nodeName] = xml_to_array($child);
            } else {
                if (!isset($groups[$child->nodeName])) {
                    $result[$child->nodeName] = array($result[$child->nodeName]);
                    $groups[$child->nodeName] = 1;
                }
                $result[$child->nodeName][] = xml_to_array($child);
            }
        }
    }

    return $result;
} 
```

测试;

```
$s = '<?xml version="1.0" encoding="UTF-8" standalone="no"?>
        <response>
            <resData foo="1">
                <contact:infData xmlns:contact="http://example.com/contact-1.0" bar="1">
                    <contact:status s="value1"/>
                    <contact:status s="value2"/>
                    <contact:status s="value3"/>
                    <contact:status s="value4"/>
                </contact:infData>
            </resData>
        </response>';

$xml = new DOMDocument();
$xml->loadXML($s);
$xmlArray = xml_to_array($xml);
print_r($xmlArray);
// print_r($xmlArray['response']['resData']['contact:infData']['contact:status'][0]['@attributes']['s']);
// foreach ($xmlArray['response']['resData']['contact:infData']['contact:status'] as $status) {
    // echo $status['@attributes']['s'] ."\n";
// } 
```

# wpf - 使用自定义窗口拖动

> ID：14553548
> 
> 赞同：0
> 
> 时间：2013-01-27T23:32:03.717
> 
> 标签：wpf, styles, draggable

我有一个 WPF 窗口，没有默认窗口“chrome”。

```
<Window x:Class="Genesis.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Genesis (Alpha)" Height="812" Width="917" Loaded="Window_Loaded"
    DataContext="{Binding RelativeSource={RelativeSource Self}}" Name="Genesis" Closing="Genesis_Closing"
    WindowStyle="None" BorderThickness="0" Margin="0" ShowInTaskbar="False" AllowsTransparency="True" Background="#F8F8F8"></Window> 
```

由于用于拖动窗口的默认栏不存在，我无法拖动窗口。如何使用新控件重新创建拖动？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T23:54:21.963

您需要使用[Window.DragMove](http://msdn.microsoft.com/en-us/library/system.windows.window.dragmove.aspx)方法。

从上面的链接：

> 允许通过鼠标左键向下拖动窗口到窗口客户区的暴露区域。

像这样的东西：

```
private void Genesis_MouseDown(object sender, MouseButtonEventArgs e)
{
    if (Mouse.LeftButton == MouseButtonState.Pressed )
        this.DragMove();
} 
```

# ios - 用于不同 iPhone（3,5 和 4'）的两个故事板

> ID：14553550
> 
> 赞同：-1
> 
> 时间：2013-01-27T23:32:14.723
> 
> 标签：ios, iphone-5

我在一个故事板上编写 3.5 英寸的应用程序，在另一个故事板上编写 4 英寸的应用程序。作为启动时的代表检查输入的设备和从那里输入的方法可以携带启动故事板或iphone 4或iphone 5

（因为iphone 5屏幕更大，可以扩展功能吗？）

这是对的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T00:26:06.987

你不必这样做。界面生成器的左下角有一个按钮，可让您在屏幕尺寸之间切换，使用自动调整大小将针对两种屏幕尺寸进行调整。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T01:17:56.750

您也可以使用自动布局

# asp.net-mvc - 在 MVC Unobtrusive Validation 中如何验证 DateTime？

> ID：14553555
> 
> 赞同：7
> 
> 时间：2013-01-27T23:33:33.707
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-4, jquery-validate, unobtrusive-validation

使用启用了客户端和非侵入式验证的 MVC4，我试图了解验证如何确定输入的 DateTime 值是否有效。

在我的应用程序中，这个格式化的日期是有效的：`01/31/2013`，而如果我输入：`31/01/2013`，我得到：

> 字段 [fieldId] 必须是日期

它如何确定什么是有效日期？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T07:08:52.683

> 它如何确定什么是有效日期？

它使用客户端浏览器上定义的当前文化来确定正确的格式。例如，如果您的浏览器被配置为使用`en-US`默认语言，那么正确的格式是`M/d/yyyy`. 如果您的客户端浏览器配置为使用`fr-FR`语言，则正确的格式为`dd/MM/yyyy`.

这完全取决于您的浏览器配置为使用什么语言。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T23:46:37.860

好问题。这似乎是 MVC 3 中一个持续存在的问题。我一直都看到它。有无数关于这个问题的投诉[http://forums.asp.net/t/1831712.aspx/1](http://forums.asp.net/t/1831712.aspx/1)

Darin Dimitrov 写了一篇很棒的文章，其中他使用 DataStringFormat 来强制它。

[在asp.net mvc 4中格式化日期时间](https://stackoverflow.com/questions/11272851/format-datetime-in-asp-net-mvc-4)

我强烈推荐它。伟大的阅读。如果您使用它，请给他的答案+1。

对于我的$$$，我将坚持并发誓JQuery 日期选择器填充不可编辑的控件以使用户受益。

# css - 重力形成 css 推断布局

> ID：14553557
> 
> 赞同：-3
> 
> 时间：2013-01-27T23:33:47.497
> 
> 标签：css, wordpress

我正在使用 Gravity Forms（原始 ASP 站点）将联系表从此处： [http ://www.niclaims.co.uk/ 迁移到新的 Wordpress 版本。](http://www.niclaims.co.uk/)

但是，我不熟悉它控制表单输出的 CSS 的方式。我已在选项中将其关闭，但小部件似乎在我在这里制作的那个上添加了额外的填充：http: [//niclaims.webdeveloperbelfast.com/](http://niclaims.webdeveloperbelfast.com/)。这是我需要帮助的主页侧栏上的联系表。我怎样才能删除这个额外的填充？

另外，我需要知道，使用 Gravity Forms 有没有一种方法可以使标签内联在文本框中并消失在焦点上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T16:49:18.320

我不是 CSS 神童，以前从未使用过重力形式。但是你可以试试这个插件[http://wordpress.org/extend/plugins/dropifi-contact-widget/](http://wordpress.org/extend/plugins/dropifi-contact-widget/)它提供了一种更简单的方法来创建联系表单而无需接触任何代码。希望能帮助到你！

# java - 导航引擎无法处理请求

> ID：14553560
> 
> 赞同：0
> 
> 时间：2013-01-27T23:34:19.790
> 
> 标签：java, endeca

我在 Endeca 中收到以下错误：

```
com.endeca.navigation.ENEException: Navigation Engine not able to process 
request `http://myhost:15000/search?terms=remote&rank=0&offset=0&irversion=601` 
```

我的 MDEX 版本是 6.3.0

我的应用程序中引用的 jar 文件是：

`endeca_navigation.jar`：规范-IR-版本：6.3.0（从清单文件中读取） `endeca_logging.jar`：规范-版本：6.1.2（从清单文件中读取）

即使有这些引用的罐子，为什么请求参数仍然存在`irversion=601`？我正在使用 java 1.5 并在 eclipse 中构建我的应用程序。起初，它引用了较旧的 jar 文件（601），但我完全删除了这些文件并用上面列出的较新的 jar 文件替换了它们。我已经重建了我的应用程序，但我仍然看到参数 irversion=601。几个小时以来，我一直试图找出问题所在，但我没有运气。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-04T21:19:06.743

除了 Wiszh 的响应之外，查看 dgraph 请求查询日志（位于 /logs/dgraph/Dgraphxx/Dgraphxx.log 和 .reqlog 中）很有用，这将显示更具体的错误和导致它的查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T14:11:44.220

如果没有别的，我认为您需要一个 N=0 参数才能请求工作。

此外，如果您使用 Weblogic 之类的应用程序服务器来运行您的应用程序，它倾向于缓存引用的 jar，可能必须清除这些 jar 才能获取新版本的 jar。

最后，如果所有其他方法都失败了，你的 dgraph 上有一个 --back_compat 601 参数，它指示了可接受的 navigation.jar 版本。您可以使用此参数来确定问题是 jar 版本还是介于两者之间的其他问题。

祝你好运

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-03T21:03:20.607

您的 jars 是否与您正在查询的 Endeca 服务器的版本相匹配？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-22T19:59:52.970

此问题是由于您的类路径中的旧导航 api jar

检查`ToolsAndFrameworks\version\assembler\lib`以获取正确版本的导航 api jar。那应该可以解决这个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-21T00:36:09.773

正确的 jar 路径为我解决了问题 ToolsAndFrameworks\version\assembler\lib

# graphviz - 与其他节点具有相同等级的graphviz集群

> ID：14553562
> 
> 赞同：3
> 
> 时间：2013-01-27T23:34:55.047
> 
> 标签：graphviz, dot

我正在尝试创建一个图表，我明确指定了许多节点的等级并指定了集群。以下代码生成我想要的图形类型：

```
digraph {
    rankdir=LR
    subgraph cluster0 {
        "MATH 208"
        "MATH 211"
        graph [rankdir=LR, style="rounded,filled", color=gray]
    }
    subgraph year1 {
        subgraph {
            "MATH 100"
            "MATH 110"
            graph [rankdir=LR, rank=same]
        }
        subgraph {
            "MATH 101"
            "MATH 211"
            "MATH 208"
            graph [rankdir=LR, rank=same]
        }
        graph [rankdir=LR]
    }
    subgraph year2 {
        subgraph {
            "MATH 205"
            "PHIL 203"
            graph [rankdir=LR, rank=same]
        }
        graph [rankdir=LR]
    }
    subgraph year3 {
        subgraph {
            "MATH 311"
            "MATH 312"
            "MATH 375"
            graph [rankdir=LR, rank=same]
        }
        graph [rankdir=LR]
    }
    subgraph year4 {
        subgraph {
            "MATH 447"
            "MATH 412"
            graph [rankdir=LR, rank=same]
        }
        graph [rankdir=LR]
    }
    "MATH 100" -> "MATH 101"
    "MATH 100" -> "MATH 208"
    "MATH 101" -> "MATH 205"
    "MATH 110" -> "MATH 311"
    "MATH 211" -> "MATH 311"
    "MATH 110" -> "MATH 312"
    "MATH 211" -> "MATH 312"
    "PHIL 203" -> "MATH 375"
    "MATH 110" -> "MATH 447"
    "MATH 211" -> "MATH 447"
    "MATH 311" -> "MATH 412"
    "MATH 312" -> "MATH 412"
} 
```

这会产生一个正确的图表，其中“MATH 211”与“MATH 101”的等级相同，但是 graphviz 会发出警告

```
Warning: MATH 208 was already in a rankset, ignored in cluster pruned
Warning: MATH 211 was already in a rankset, ignored in cluster pruned 
```

如果我从 year1 子图中删除“MATH 211”和“MATH 208”，graphviz 不再抱怨，但结果图不再具有与“MATH 101”相同等级的集群（为什么会......）：

有没有办法重新排列/重新排列我的点文件以生成第一个图形但没有任何警告？或者指定某个集群应该与另一个节点处于同一级别？

我应该注意到，该图可以使用 graphviz 2.26 成功编译，但使用 graphviz 2.28 编译失败...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T16:48:42.430

几个想法

*   我认为子图需要有一个以“集群”开头的名称才能获得任何样式。实际上，如果没有集群前缀，它们可能根本不会做任何事情，这可能是您许多问题的根源。
*   您不需要重复 rankdir=LR。在顶部指定一次就足够了。
*   如果子图中的所有节点都没有相互依赖关系，那么它们很可能已经处于相同的等级并且不需要 rank=same。

这是一个适合我的版本：

```
 digraph {
    rankdir=LR
    subgraph cluster0 {
        "MATH 208"
        "MATH 211"
        graph [style="rounded,filled", color=gray]
    }
    subgraph clusteryear1 {
        subgraph cluster100{
            "MATH 100"
            "MATH 110"
            graph [rank=same]
        }
        subgraph cluster101{
            "MATH 101"
            "MATH 211"
            "MATH 208"
            graph [rank=same]
        }
    }
    subgraph clusteryear2 {
        subgraph cluster205{
            "MATH 205"
            "PHIL 203"
            graph [rank=same]
        }
    }
    subgraph clusteryear3 {
        subgraph cluster311{
            "MATH 311"
            "MATH 312"
            "MATH 375"
            graph [rank=same]
        }
    }
    subgraph clusteryear4 {
        subgraph cluster447 {
            "MATH 447"
            "MATH 412"
            graph [rank=same]
        }
    }
    "MATH 100" -> "MATH 101"
    "MATH 100" -> "MATH 208"
    "MATH 101" -> "MATH 205"
    "MATH 110" -> "MATH 311"
    "MATH 211" -> "MATH 311"
    "MATH 110" -> "MATH 312"
    "MATH 211" -> "MATH 312"
    "PHIL 203" -> "MATH 375"
    "MATH 110" -> "MATH 447"
    "MATH 211" -> "MATH 447"
    "MATH 311" -> "MATH 412"
    "MATH 312" -> "MATH 412"
} 
```

# javascript - How to navigate through the jquery tabs with links outside the tabs

> ID：14553567
> 
> 赞同：1
> 
> 时间：2013-01-27T23:35:37.187
> 
> 标签：javascript, jquery, html, tabs, hyperlink

I am searching and tweaking all the day to fix this issue. I have searched the whole stackoverflow forum for the solutions that is fitting to my situation.

I have 5 tabs on my homepage. I would like to use links outside the tab to jump to and open the desired tab. When I click on Tab2 it jumps to the top of the page but it wont open tab2 it stays on tab1 (HOME tab). How to fix this?

Link to specific tab:

```
<a href="#" goto="tab2">Tab2</a> 
```

HTML CODE:

```
<div id="tabContaier">

    <ul>
        <li><a class="active" href="#tab1">HOME</a></li>
        <li><a href="#tab2">SERVICES</a></li>
        <li><a href="#tab3">OPTIONS</a></li>
            <li><a href="#tab4">ABOUT US</a></li>
            <li><a href="#tab5">CONTACT US</a></li>
    </ul><!-- //Tab buttons -->

    <div class="tabDetails">
        <div id="tab1" class="tabContents">
                <h1>Title1</h1>
                <iframe src="Home.html" width="1150" height="600" frameBorder="0" scrolling="no">Browser not compatible. </iframe >
        </div><!-- //tab1 -->
        <div id="tab2" class="tabContents">
                <h1>Title2  </h1>
                <h2>  </h2>
                <h3>  </h3>
                <iframe src="Services.html" width="1150" height="640" frameBorder="0" scrolling="no">Browser not compatible. </iframe >
        </div><!-- //tab2 -->
        <div id="tab3" class="tabContents">
               <h1>Title3</h1>
               <iframe src="Options.html" width="1150" height="600" frameBorder="0" scrolling="no">Browser not compatible. </iframe >
        </div><!-- //tab3 -->
        <div id="tab4" class="tabContents">
            <h1>Title4 </h1>
            <iframe src="Aboutus.html" width="1150" height="600" frameBorder="0" scrolling="no">Browser not compatible. </iframe >
        </div><!-- //tab4 -->
        <div id="tab5" class="tabContents">
            <h1>Title5</h1>
           <iframe src="Contactus.html" width="1150" height="600" frameBorder="0" scrolling="no">Browser not compatible. </iframe >
        </div><!-- //tab5 -->
    </div><!-- //tab Details -->
</div><!-- //Tab Container --> 
```

CSS:

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>jQuery Tab</title>
<style type="text/css">
*{margin:10; padding:0;}

body{

    font:normal 14px/1.5em Arial, Helvetica, sans-serif;
}
a{outline:none;}

#tabContaier{
    background:#f0f0f0;
    border:1x solid #fff;
    margin:100px auto;
    padding:20px;
    position:absolute;
    width:1315px;
}
    #tabContaier ul{
        overflow:hidden;
        border-left:0px solid #fff;
        height:80px;
        position:center;
        z-index:100;
    }
    #tabContaier li{
        float:left;
        list-style:none;
    }
    #tabContaier li a{
        background:#ddd;
        border:3px solid #ffff;
        border-left:0;
        color:#666;
        cursor:pointer;
        display:block;
        height:35px;
        line-height:35px;
        padding:0 98px;
        text-decoration:none;
        text-transform:bold;
    }
    #tabContaier li a:hover{
        background:#fff;
    }
    #tabContaier li a.active{
        background:#fbfbfb;
        border:px solid #fff;
        border-right:px;
        color:#333;
    }
    .tabDetails{
        background:#fbfbfb;
        border:1px solid #fff;
        margin:34px px;
    }
    .tabContents{
        padding:px

}
    .tabContents h1{
        font:normal 24px/1.1em Georgia, "Times New Roman", Times, serif;
        padding:0 0 px;
                                width:auto;

</style> 
```

JAVASCRIPTCODE:

```
<script type="text/javascript" src="js/jquery-1.4.2.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){

    // Hide all tab conten divs by default
    $(".tabContents").hide(); 

    // Show the first div of tab content by default
    $(".tabContents:first").show(); 

    //Fire the click event
    $("#tabContaier ul li a").click(function(){ 

        // Catch the click link
        var activeTab = $(this).attr("href"); 

        // Remove pre-highlighted link
        $("#tabContaier ul li a").removeClass("active"); 

        // set clicked link to highlight state
        $(this).addClass("active");         

        // hide currently visible tab content div
        $(".tabContents").hide(); 

        // show the target tab content div by matching clicked link.
        $(activeTab).fadeIn(); 
 return true;

    });
});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T23:56:40.047

你的 jQuery 和 html 看起来不错，你应该有 jQuery 1.4 版本的问题。

如果您想要对标签的 url 响应，请使用以下命令：

```
var anchor = window.location.hash;//returns url hash only like: '#tab4'

if ( anchor.length > 1 ) {
    $("#tabContaier ul li a").removeClass("active"); 
    $('a[href="' + anchor + '"]').addClass('active');

    $(anchor).fadeIn();
} 
```

# android - Layout out elements within a RelativeLayout

> ID：14553569
> 
> 赞同：1
> 
> 时间：2013-01-27T23:35:41.940
> 
> 标签：android, user-interface

I'm having a very difficult time figuring out how to lay out this element. Here's what I want to do (apologies for my MS Paint skills):

![Layout](../Images/2587568565ebdc0f75fe9b5400e3bede.png)

Here, the gray box is supposed to be an ImageView. The red lines here are just to make the sections more clear - not worried abot how to draw them. The features that I'm trying to get are:

1.  The ImageView is aligned relative to the topmost red line, and to the left edge of the green box.

2.  The "TEXT" is to the right of the image, and centered vertically in its section.

Without the ImageView, this is pretty straightforward - just a LinearLayout with three TextViews and some padding. I've tried doing this wit a RelativeLayout, but I'm unsure of how to center Text within the box without relying on guessing at the padding/margin.

I figured out how to get the box hanging over. I created my RelativeLayout

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="200dp"
    android:layout_height="200dp"
    android:layout_marginTop="20dp"
    android:background="#3AF">
    <LinearLayout
        android:orientation="vertical"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:layout_marginTop="20dp"
        android:background="#AAA">
    <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="New Text"
            android:padding="10dp"
            android:id="@+id/textView"/>
    <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="New Text"
            android:padding="10dp"
            android:id="@+id/textView1"/>
    <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="New Text"
            android:padding="10dp"
            android:id="@+id/textView2"/>
    </LinearLayout>
    <ImageView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginLeft="10dp"
        android:src="@drawable/ic_launcher"
        android:id="@+id/imageView"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"/>
</RelativeLayout> 
```

But what I can't figure out is how to align the topmost TextView to the right of the ImageView. (Note - this is just my attempt. The layout type/style is entirely flexible at this point).

Here's a screenshot of how it looks in the designer:

![Screenshot](../Images/841d378957f2fc6424e380224a737c14.png)

Any ideas?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T23:54:27.110

```
android:layout_toRightOf 
```

应该工作......如果没有，你能解释什么是错的，你的问题是什么，因为它在这里工作正常......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T00:52:07.977

尝试将您的第一行放入您的 LinearLayout，然后将其他所有内容放入您的 RelativeLayout。我没有尝试过这段代码，但如果我正确理解了你的场景，它应该可以解决问题。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="200dp"
    android:layout_height="200dp"
    android:layout_marginTop="20dp"
    android:background="#3AF">
    <LinearLayout
        android:orientation="horizontal"
        android:layout_width="fill_parent"
        android:layout_height="wrap_parent"
        android:layout_alignParentTop="true"
        android:layout_marginTop="20dp"
        android:background="#AAA">
    <ImageView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginLeft="10dp"
        android:src="@drawable/ic_launcher"
        android:id="@+id/imageView"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"/>
     <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="New Text"
            android:padding="10dp"
            android:id="@+id/textView"/>
    </LinearLayout>

    <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="New Text"
            android:padding="10dp"
            android:id="@+id/textView1"/>
    <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="New Text"
            android:padding="10dp"
            android:id="@+id/textView2"/>
    </LinearLayout>

</RelativeLayout> 
```

# bash - 在脚本中重定向 exec

> ID：14553571
> 
> 赞同：0
> 
> 时间：2013-01-27T23:35:52.383
> 
> 标签：bash, shell, unix

您能解释一下脚本中以下行背后的机制吗？

```
exec > >(tee logfile.txt) 
```

这基本上将 STDOUT 输出到控制台以及 logfile.txt 在脚本中时。我知道它的作用，但我无法准确解释它为什么会这样工作。我了解 >(command args) 是一个进程替换。我的主要困惑来自为什么有额外的“>”？为什么不执行>（tee logfile.txt）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T00:20:25.907

请参阅`exec`( `$ help exec`) 的帮助。相关部分是

> 如果未指定 COMMAND，则任何重定向都会在当前 shell 中生效。

由于每个命令都从生成它的 shell 继承其标准输出，因此每个命令现在都将给定的进程替换作为其标准输出，而不是终端。

# php - 使用 zfcuser 和自定义模块选择字段

> ID：14553577
> 
> 赞同：2
> 
> 时间：2013-01-27T23:37:21.000
> 
> 标签：php, zend-framework2, zfcuser

我上周开始学习ZF2。我已经成功安装了骨架应用程序和 ZfcUser 模块。我决定按照 ZfcUser Wiki 中的建议编辑注册表单： [https ://github.com/ZF-Commons/ZfcUser/wiki/How-to-modify-the-form-objects-used-by-ZfcUser](https://github.com/ZF-Commons/ZfcUser/wiki/How-to-modify-the-form-objects-used-by-ZfcUser)

并添加一个选择字段，您可以在官方表单文档中找到相同的字段。

但是选择没有正确显示，因为它像输入字段一样呈现。你可以 [在这里](http://ilvelista.fraz.org/user/register)看到一个例子。

这是我的 Application/Module.php

```
<?php
/**
 * Zend Framework (http://framework.zend.com/)
 *
 * @link      http://github.com/zendframework/ZendSkeletonApplication for the canonical source repository
 * @copyright Copyright (c) 2005-2012 Zend Technologies USA Inc. (http://www.zend.com)
 * @license   http://framework.zend.com/license/new-bsd New BSD License
 */

namespace Application;
use Zend\Mvc\ModuleRouteListener;
use Zend\Mvc\MvcEvent;
use Zend\Form\Form;

class Module
{
    public function onBootstrap(MvcEvent $e)
    {
        $e->getApplication()->getServiceManager()->get('translator');
        $eventManager        = $e->getApplication()->getEventManager();
        $moduleRouteListener = new ModuleRouteListener();
        $moduleRouteListener->attach($eventManager);

        $events = $e->getApplication()->getEventManager()->getSharedManager();
        $events->attach('ZfcUser\Form\Register','init', function($e) {
            $form = $e->getTarget();
            $form->add(array(
                    'type' => 'Zend\Form\Element\Select',
                    'options' => array(
                            'label' => 'Which is your mother tongue?',
                            'value_options' => array(
                                    '0' => 'French',
                                    '1' => 'English',
                                    '2' => 'Japanese',
                                    '3' => 'Chinese',
                            ),
                    ),
                    'name' => 'language'
            ));         
        });
        $events->attach('ZfcUser\Form\RegisterFilter','init', function($e) {
            $filter = $e->getTarget();
            // Do what you please with the filter instance ($filter)

        });
    }

    public function getConfig()
    {
        return include __DIR__ . '/config/module.config.php';
    }

    public function getAutoloaderConfig()
    {
        return array(
            'Zend\Loader\StandardAutoloader' => array(
                'namespaces' => array(
                    __NAMESPACE__ => __DIR__ . '/src/' . __NAMESPACE__,
                ),
            ),
        );
    }
} 
```

拜托，谁能帮助我理解这种行为并指出正确的方向？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T09:11:20.197

您的代码很好，问题在于用户模块提供的用于呈现表单的标准视图。

注册.phtml

```
<dd><?php echo $this->formInput($element) . $this->formElementErrors($element) ?></dd> 
```

这是使用输入视图帮助渲染任何额外的元素。这可能应该是 formElement 助手，它是一个通用助手，可以根据其类型呈现任何元素：

```
<dd><?php echo $this->formElement($element) . $this->formElementErrors($element) ?></dd> 
```

这会很有魅力，但最好添加一个额外的检查，例如：

```
<?php elseif ($element instanceof Zend\Form\Element\Select): ?>
        <dd><?php echo $this->formSelect($element) . $this->formElementErrors($element) ?></dd>
<?php else: ?> 
```

# javascript - MVC: Share Javascript file between projects in the same solution

> ID：14553579
> 
> 赞同：8
> 
> 时间：2013-01-27T23:37:37.000
> 
> 标签：javascript, asp.net-mvc

I looked at [this tutorial](https://stackoverflow.com/a/8541764) for creating a javascript that is used withing several projects in the same solution. Basically, I created a class Library where I have a script folder in which I create a script file which I want to use in several projects within the same solution.

In the script folder of the projects which use the commonscript file, I added an existng item as described in the link above. I added the file as a link and not a copy of the file. However, my view s not able to read this javascript file.

I even add this command to the pre-build event for project using the javascript so I could copy the file from the classlibrary to my project during before building but did did not work either.

```
copy $(SolutionDir)ClassLibraryName\Scripts\CommonScript.js* $(ProjectDir)Scripts\CommonScript.js 
```

and added the script to my view

```
<script src="@Url.Content("~/Scripts/CommonScript.js")" type="text/javascript"></script> 
```

How can I create a javascript file and use it in several projects in the same solution

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-03-10T14:36:33.407

另一种选择是拥有一个与您的网站分开的“媒体服务器”或“静态资产服务器”。这可能只是 IIS 中的另一个虚拟目录，可以包含任何静态资产，如 JavaScript、CSS 或图像。然后您需要从您的 MVC 项目中正确引用这些资产：

```
<script type="text/javascript" src="/assets/foo.js"></script> 
```

如果静态资产虚拟目录位于同一服务器上，您仍然可以使用相对 URL。我可能会建议为 IIS 设置此设置：

*   默认网站
    *   assets/（虚拟目录）
    *   webapp1/（应用程序）
    *   webapp2/（应用程序）

由于“资产”虚拟目录只是一个包含文件的文件夹，因此您甚至不需要为其创建 Visual Studio 项目。使用像[Sublime Text](https://www.sublimetext.com/)这样的文本编辑器就足够了，因为它可以打开一个文件夹并像项目一样呈现它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-10T14:29:35.890

您也可以考虑重组您的应用程序以使用区域，而不是使用两个完全独立的项目。仅将多个项目用于应用程序的完全独立部分（即一个项目中的接口，另一个项目中的模型，第三个中的类定义，第四个中的区域，控制器和视图），我取得了最大的成功。如果您使用区域，那么您的视图可以从同一组资源（例如 Content 和 Script 文件夹）中提取。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T17:25:34.313

你有没有想过托管你的文件？这是工业界通常会做的事情，也是我在自己的项目中养成的习惯。使用 Apache 或 IIS 很容易设置。

# windows-phone-7 - 不同的屏幕尺寸？

> ID：14553581
> 
> 赞同：1
> 
> 时间：2013-01-27T23:37:57.043
> 
> 标签：windows-phone-7

我一直在开发一个windows 7手机。我想知道是否有不同的尺寸需要考虑？或者，如果我的应用在 Windows 模拟器中看起来不错，那么它在实际手机上看起来也不错？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T23:59:10.807

世界上所有的 WP7 设备都只有一种屏幕尺寸，480x800。

现在 WP8 已经发布，还有 WP8 设备，具有 1280x768 和 1280x720 屏幕。

# gnupg - gpg trustdb.gpg loading

> ID：14553585
> 
> 赞同：0
> 
> 时间：2013-01-27T23:38:48.773
> 
> 标签：gnupg

I have a problem in using gpg on linux boot up (Debian).

I have a process that is being loaded on bootup using `rc.local`. This process will call `gpg` verify API's using `gpgme`. I found out that by running the process manually `gpg` works fine, while when the process is loaded using `rc.local` gpg doesn't work. (`rc.local` runs on boot up.) I get no keys on boot up when I try:

```
gpg --list-keys 
```

I am guessing that the `rc.local` is being called before loading the keys (`trustdb.gpg`). Do you know where in the kernal on boot up we load the public gpg keys?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-04T13:03:53.700

您在 rc.local 中运行的脚本是否具有适当的权限（即，它是否向有权读取 gpg db 的用户以外的用户起诉？）root 当然总是可以访问，但是当 gpg db创建它总是在用户特定的级别上，所以如果该用户没有访问权限，它将无法工作。正如上面的评论所说，su 到正确的用户，并指定 gpg 主目录：

```
su user

gpg --homedir ~/.gnupg.userkeyring 
```

# css - 调整大小时响应菜单不起作用

> ID：14553589
> 
> 赞同：0
> 
> 时间：2013-01-27T23:38:55.460
> 
> 标签：css, menu, hover, responsive-design, menuitem

我正在为自己开发一个响应式网站，但我对菜单有点卡住了。

当我将屏幕调整为 670 像素时，我的菜单会发生变化，但我的 2 个底部菜单项无法正常工作。

这是来自媒体查询的代码：

CSS

```
@media screen and (min-width:670px) {       
    nav select{
        display:none;
}

    nav ul:first-of-type{
        display: block;
        list-style: none;
        font-size: 1.4em;
    }

    nav ul li{
        border-top: black 1px solid;
        line-height: 2.5em;
    }

    nav ul li:last-of-type{
        border-bottom: black 1px solid;
    }

    nav ul li a{
        display: block;
    }

    nav ul li a:hover{
        opacity: .2;    
    }

    #video1{
        display: none;
    }

    #video2{
        display: block;
    }

    #bio{
        padding-top: 2em;   
    }

    p{
        font-size: 1em;
    }

    a{
        color: #000;
    }   
} 
```

HTML

```
<div id="menu">
    <nav>
        <ul>
            <li><a href="#1">biography</a></li>
            <li><a href="#2">illustration</a></li>
            <li><a href="#3">film</a></li>
            <li><a href="#4">tumblr</a></li>
            <li><a href="#5">contact</a></li>
        </ul>
    </nav>
</div>

<nav>
    <select>
        <option value="#1" selected>Biography</option>
        <option value="#2">Illustration</option>
        <option value="#3">Film</option>
        <option value="#4">Tumblr</option>
        <option value="#5">Contact</option>
    </select> 
</nav> 
```

[您可以在http://nickzijlstra.com/resp](http://nickzijlstra.com/resp)上查看实时网站

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T04:20:50.427

页脚的高度为 50%，覆盖底部的几个导航按钮。

玩弄导航的z-index，这应该可以让你到达你需要去的地方

# php - jQuery + PHP 发送重复的空白电子邮件

> ID：14553592
> 
> 赞同：1
> 
> 时间：2013-01-27T23:39:50.097
> 
> 标签：php, jquery, forms, email

正在尝试设置联系表格。表单提交电子邮件和可选的抄送发件人。如果启用了 javascript，表单将提交到 contact-ajax.php（用感谢消息替换表单），否则提交到 contact.php（重定向到感谢页面）。后备表单工作正常，但每次 ajax 表单触发时，它也会发送一封完全空白的电子邮件（如果选中了 CC 选项，则发送给发件人和收件人）。我无法弄清楚为什么会发生这种情况。任何见解将不胜感激。

表单 HTML：

```
<form method="post" id="email_form" name="email_form" action="contact.php">
    <label for="name">Name:</label><br />
    <input type="text" name="name" id="name" placeholder="John Doe" /><br />
    <label for="email">Email Address:</label><br />
    <input type="text" name="email" id="email" placeholder="johndoe@gmail.com" /><br />
    <label for="subject">Subject </label></td><br />
    <input type="text" name="subject" id="subject" placeholder="Subject" /><br />
    <label for="message">Message:</label></td><br />
    <textarea cols="35" rows="5" name="message" id="message" placeholder="Your Message"></textarea><br />
    <input type="checkbox" name="cc" id="cc" checked value="Yes" /><label for="cc"> Send yourself a copy of this message</label><br />
    <input class="submit pulldown button" name="submit" id="submit" type="submit" value="Send Message" />
</form> 
```

Javascript：

```
$(document).ready(function() {
$('#email_form #submit').click(function(event) {
    event.preventDefault();
    $.ajaxSetup ({
        cache: false
        });
    $.ajax({
        type: 'POST',
        url: 'contact-ajax.php',
        data: $("#email_form").serializeArray(),
        success: function(msg) {
            if(msg=='Mail sent') {
                alert(msg);
                }
            else {
                alert('Error sending mail. Please try again.');
                }
            },
        error: function(ob,errStr) {
            alert('Error sending mail. Please try again.');
            }
        });
    return false;
    });
}); 
```

脚本调用的 PHP 表单 (contact-ajax.php)：

```
<?php
if($_SERVER['REQUEST_METHOD'] == "POST") {
    $name = $_POST['name'];
    $visitor_email = $_POST['email'];
    $email_subject = $_POST['subject'];
    $message = $_POST['message'];
    $today = date('r');
    $email_from = "address@domain.tld";
    $to = "address@domain.tld";
    $email_body = "On $today $name wrote:\n"."$message";
    $headers = "From: $email_from \r\n";
    $headers .= "Reply-To: $visitor_email \r\n";
    if (isset($_POST['cc'])) {
        $headers .= "CC: $visitor_email \r\n";
        }
    $headers .= "X-Mailer: PHP/". phpversion();
    mail($to,$email_subject,$email_body,$headers);
    if(mail($to, $subject, $body, $headers)) {
        die('Mail sent');
        }
    else {
        die('Error: Mail failed');
        }
    }
?> 
```

非 Ajax php 脚本 (contact.php) 是相同的，只是它以`header('Location: thanks_page.html');`而不是最后一条`if`语句结尾。

空白电子邮件不包含主题或消息正文，但 From、Reply-To 和 CC 字段都完全按照正确（非空）消息中的内容填写。几天来我一直试图找出问题所在，但似乎无法找到它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T23:42:31.723

mail函数发送邮件..你写了2次mail()..在if中检查返回值

```
mail($to,$email_subject,$email_body,$headers);
if(mail($to, $subject, $body, $headers)) { ...... 
```

只能这样使用：

```
if(mail($to, $subject, $body, $headers)) { //mail sent 
} else { 
//mail not sent 
} 
```

**UPDATE** 使用[PHPMailer](https://github.com/Synchro/PHPMailer)易于使用，我认为比简单的 php 邮件功能更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T23:46:46.727

我相信就是这样：

```
if (isset($_POST['cc'])) {
    $headers .= "CC: $visitor_email \r\n";
}
$headers .= "X-Mailer: PHP/". phpversion();
mail($to,$email_subject,$email_body,$headers); <-- Sends FIRST email
if(mail($to, $subject, $body, $headers)) { <-- Sends ANOTHER email
    die('Mail sent');
    }
else {
    die('Error: Mail failed');
    }
} 
```

也许尝试：

```
$retVal = mail($to,$email_subject,$email_body,$headers);
if($retVal) { 
```

谢谢，马特

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T23:49:53.287

Bence 有一个有效点，您两次调用了邮件功能......

我不太确定为什么有些信息是空白的，但你能在 PHP 中做到这一点吗？：

```
$headers = "From: $email_from \r\n";
$headers .= "Reply-To: $visitor_email \r\n";
if (isset($_POST['cc'])) {
    $headers .= "CC: $visitor_email \r\n";
    } 
```

我总是像这样进行连接：

```
$headers = "From: ".$email_from." \r\n";
$headers .= "Reply-To: ".$visitor_email." \r\n";
if (isset($_POST['cc'])) {
    $headers .= "CC: ".$visitor_email." \r\n";
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-28T01:07:03.670

除了涵盖为什么您收到两封邮件的所有答案之外，还有一个相当明显的原因可以说明为什么第二封邮件是空的：

```
mail($to,$email_subject,$email_body,$headers);
if(mail($to, $subject, $body, $headers)) 
```

在 if 语句中，你有`$subject`and`$body`而不是`$email_subject`and `$email_body`。

# python - web2py：未提交自定义表单

> ID：14553594
> 
> 赞同：0
> 
> 时间：2013-01-27T23:40:35.400
> 
> 标签：python, crud, web2py

我在 web2py 中使用自定义表单并遇到了 2 个问题

*   1) 错误没有被捕获和显示
*   2) 表格未提交：

经过验证/验证后，我得到了这些值：

```
form.accepts(request.vars, session) => False
form.errors => <Storage ()> 
```

现在我有什么：

**控制器**：

```
def new():
    form=crud.create(db.i2l_letter)
    print form.errors
    if form.accepts(request.vars, session):
        response.flash='Bitte warten'
    elif form.errors:
        response.flash='Bitte fuellen sie das Formular richtig aus'
    else:
        pass
    return dict(form=form) 
```

**观点**：

```
{{if form.errors:}}
  Your submitted form contains the following errors:
  <ul>
  {{=form.errors.date_format}}
  {{for fieldname in form.errors:}}
    <li>{{=fieldname}} error: {{=form.errors[fieldname]}}</li>
  {{pass}}
  </ul>
  {{form.errors.clear()}}
{{pass}}
{{=form.custom.begin}}

<table>
<tr>
<td>{{=form.custom.label.date_format}}</td>
<td>{{=form.custom.label.myref}}</td>
<td>{{=form.custom.label.yourref}}</td>
</tr>
<tr>
<td>{{=form.custom.widget.date_format}}</td>
<td>{{=form.custom.widget.myref}}</td>
<td>{{=form.custom.widget.yourref}}</td>
</tr>
</table>
<div>{{=form.custom.submit}}</div>
{{=form.custom.end}}
{{pass}} 
```

那我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T00:01:58.990

如果您有 web2py 2.0+，请尝试用以下代码替换您的控制器代码：

```
def new():
    form=SQLFORM(db.i2l_letter)
    print form.errors
    if form.process().accepted:
        response.flash='Bitte warten'
    elif form.errors:
        response.flash='Bitte fuellen sie das Formular richtig aus'

    return dict(form=form) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T00:50:04.367

`crud.create()`自动处理表单处理，所以你不应该`form.accepts()`在它之后调用。请阅读[有关 Crud 的书籍部分](http://web2py.com/books/default/chapter/29/07#CRUD)。

# php - 如果前面没有某些单词，则匹配正则表达式

> ID：14553604
> 
> 赞同：0
> 
> 时间：2013-01-27T23:42:45.540
> 
> 标签：php, regex

**更新：实际上 php 不支持可变长度的lookbehind。这种方法在 php.ini 中是不可能的。任何可变长度的lookbehind都会给出错误“编译失败：lookbehind断言不是固定长度”**

我有以下正则表达式（我正在使用 php）：

```
/\d{2}\s\b(ans|year|years|sana|años|anos|sna)\b/i 
```

匹配以下模式：

```
22 years
49 ans
98 anos 
```

如果输入前面有某些单词（“since”、“depuis”等），我需要使其不匹配

所以 ：

```
I'm 22 years
I have 49 years 
```

**将匹配**，而：

```
Since 19 years
Depuis 10 ans 
```

**不匹配**。

我试过这个，没有效果：

```
/(?<!(depuis|since|monz))\d{2}\s\b(ans|year|years|sana|años|anos|sna)\b/i 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T01:29:56.287

你的lookbehind没有很好地形成。后视中的“或”条件（在 PHP 中的括号内使用时）需要相同的长度。否则，您可以像在

```
$str = "I'm 22 years and I have 49 years but Since 19 years and Depuis 10 ans";
preg_match_all(
'~
    (?<!
        \bdepuis\s  |
        \bsince\s   |
        \bmonz\s
    )
    \d{2}\s
    (?:
        ans?    |
        years?  |
        sana    |
        años?   |
        anos?   |
        sna
    )\b
~xi',$str,$m);
print_r($m); 
```

## [编辑 2]

最后一个单词和所需部分之间可能有多个空格（如[@nhahtdh](https://stackoverflow.com/users/1400768/nhahtdh)在下面的评论中写道）。虽然这不是一个单一的模式，但这里是您可以避免这种情况的方法。

```
$pat =
'~
    (
        (?(?<=^)(?=\s*)             # if it is the beginning of the string
            (?:\s*)                 # match possible spaces
            |                       # otherwise match
            (?:
                (?<=\s)             # following a space,
                (?:                 # a word that is not listed below
                    (?!(?:
                        depuis  |
                        since   |
                        monz
                    ))
                    \S
                )+
                \s+                 # and 1 or more spaces
            )
        )
    )
    \d{2}\s+                        # then your pattern itself
    (?:
        ans?    |
        years?  |
        sana    |
        años?   |
        anos?   |
        sna
    )\b
~xi';
preg_match_all($pat,$str,$matches);
foreach ($matches[0] as $k => &$v)
    // replace the previous word if any
    $v = substr($v,strlen($matches[1][$k]));
// and delete the reference
unset($v);
print_r($matches); 
```

# c++ - 具有固定大小的未命名成员的结构

> ID：14553606
> 
> 赞同：1
> 
> 时间：2013-01-27T23:42:52.990
> 
> 标签：c++, struct

我正在为游戏解析一些结构。我知道关于结构的大部分事情，但也有很多事情我不知道，我也不真正关心它们。但我在解析中需要它们，这样事情就可以排列起来。例如：

```
template <unsigned int Size>
class unknown
{
    BYTE data[Size];
};

struct s_object
{
    int stuff;
    unknown<100> unk1;
    int otherstuff;
    unknown<200> unk2;
}; 
```

这是一个人为的例子，但它显示了我正在尝试做的事情。我不喜欢必须命名成员`unk1`，然后`unk2`。理想情况下，我想这样做

```
 struct s_object
    {
        int stuff;
        unknown<100>;
        int otherstuff;
        unknown<200>;
    }; 
```

但这当然行不通。编译器有没有办法生成一个随机名称，不使用名称，或者只是将其视为填充？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T23:47:25.120

**编辑**：即使 GCC 也不允许你这样做！已更正。

一般来说，没有。*如果您真的*想的话，您可以使用`__FILE__`,`__LINE__`和/或`__COUNTER__` （后者是另一个编译器扩展，但在 GCC 和 MSVC 等中支持）组合一个宏来为您命名字段。

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T23:52:35.897

您可以使用`__COUNTER__`宏（但需要一些预处理器技巧）。它由[GCC](http://gcc.gnu.org/onlinedocs/cpp/Common-Predefined-Macros.html)、[Visual C++](http://msdn.microsoft.com/en-us/library/b0084kay%28v=vs.110%29.aspx)和可能的其他人实现。

然后，您可以定义一个名为的宏，例如在使用时`_`扩展为类似的东西`_unused_15`， `_unused_16`依此类推。有了它，您的代码将变为：

```
struct s_object
{
    int stuff;
    unknown<100> _;
    int otherstuff;
    unknown<200> _;
}; 
```

诡计是，即

```
#define CAT(a,b)           a##b
#define CAT_DELAYED(a,b)   CAT(a,b)
#define _                  CAT_DELAYED(_unused_,__COUNTER__) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-27T23:52:50.807

如果您真的必须“自动”执行此操作，则可以执行以下操作：

```
#define UNKNOWNY(line, size) char unknown_##line[(size)]
#define UNKNOWNX(line, size)  UNKNOWNY(line, size)
#define UNKNOWN(size)   UNKNOWNX(__LINE__, size) 
```

但我真的不明白这比写作好得多`char unknown1[100]`。您知道的时间并不长 - 您可以随时复制/粘贴。

编辑：添加额外的`#define`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-27T23:46:23.027

对不起，但它不能做到你最定义的名字！*

# android - 使用 facebook 的 FriendPickerFragment 查找具有相同应用的朋友

> ID：14553608
> 
> 赞同：4
> 
> 时间：2013-01-27T23:43:51.157
> 
> 标签：android, facebook

在 facebook SDK“What's New in Facebook SDK 3.0 for Android”页面上，在“Ready-to-Use native UI views”下，它声明：“Friend Picker 让人们可以在 Open Graph 操作中标记朋友或**查找安装了您的应用程序的其他人**。” 这听起来非常有用，但在 FriendPickerFragment 参考页面上没有关于在 Bundle arg 中包含哪些信息以获取其他配置信息的信息。我正在开发一款 Android 游戏，我希望允许用户与也是 facebook 好友的其他用户开始游戏，但不知道如何获取安装了相同应用程序的好友列表。有谁知道**可以将哪些参数传递给 FriendPickerFragment 以获取其他应用程序用户的列表？**提前非常感谢，如果需要更多信息以使这个问题更相关/更有意义，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T18:08:26.923

查看 SDK 附带的 BooleanOG 示例应用程序。它显示了如何根据安装了您的应用程序的朋友过滤结果的示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-24T13:31:07.123

```
friendPickerFragment.setFilter(new GraphObjectFilter<GraphUser>() {
        @Override
        public boolean includeItem(GraphUser graphObject) {
            if(graphObject.asMap().containsKey("installed") && (Boolean) graphObject.asMap().get("installed"))
                return false;
            else{
                return true;
            }
        }
    }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-19T12:14:51.867

默认情况下 FriendPickerFragment 显示已安装您的应用程序的朋友列表。您可以更改指定类型的显示列表 (setFriendPickerType())。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-31T10:09:18.087

Facebook Scores API 为您服务

> 该列表按分数值降序排序，因此它首先返回分数最高的朋友。

RF：[分数 API](https://developers.facebook.com/docs/games/scores/ "评分 API")

# windows - Is it possible for one process to inject code into another without administrative privileges?

> ID：14553610
> 
> 赞同：6
> 
> 时间：2013-01-27T23:44:07.820
> 
> 标签：windows, security, winapi, cryptoapi, dpapi

The [`CryptProtectMemory`](http://msdn.microsoft.com/en-us/library/aa380262%28v=vs.85%29.aspx) API in the DPAPI allows you to pass the `CRYPTPROTECTMEMORY_SAME_PROCESS` flag, which prevents other processes from decrypting the memory. One way around this would be to use `OpenProcess`, `WriteProcessMemory`, and `CreateRemoteThread` to inject code into the target process and have it call `CryptUnprotectMemory`, thus decrypting the memory and leaking it to the other process.

Assuming both processes are running under the context of the same limited privilege user (i.e. not an administrator) on Windows Vista or later, is this still possible? I was under the impression that process memory write operations were denied to limited users, regardless of the process ACL, but I may be wrong.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T00:55:21.217

Windows 尊重进程 ACL，默认情况下，这允许访问正在运行进程的用户以及本地系统帐户和用户的登录会话 SID。管理员可以使用 SeDebugPrivilege 绕过此 ACL。

否则，您需要成为管理员才能调试自己的代码。

您可以更改进程 ACL，但由于通常（IIRC）当前用户是进程所有者，我不确定您是否可以阻止当前用户上下文中的另一个进程将其更改回来。此外，由于这些进程很可能在同一个桌面上运行，因此无论如何您都会受到[粉碎攻击](http://en.wikipedia.org/wiki/Shatter_attack)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T10:44:57.373

您没有描述需要使用代码注入的确切场景。如果在没有管理权限的情况下运行的操作进程创建另一个关于[CreateProcess](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682425%28v=vs.85%29.aspx)的进程，例如，一个拥有所有权限的新进程的句柄（`PROCESS_ALL_ACCESS`PROCESS_INFORMATION [）](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684873%28v=vs.85%29.aspx)。例如，您可以[在此处](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684880%28v=vs.85%29.aspx)阅读以下内容`hProcess`

> `CreateProcess`函数 返回的句柄具有对进程对象的**PROCESS_ALL_ACCESS**访问权限。

因此，应该只保留从返回的处理程序`CreateProcess`并且在您需要完全访问子进程之前不要关闭它。[这样，您将拥有调用CreateRemoteThread](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682437%28v=vs.85%29.aspx)和[WriteProcessMemory](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681674%28v=vs.85%29.aspx)所需的 PROCESS_CREATE_THREAD、PROCESS_QUERY_INFORMATION、PROCESS_VM_OPERATION、PROCESS_VM_WRITE 和 PROCESS_VM_READ 访问权限。

所以你的问题的答案是：“是的，在一些额外的条件下是可能的”。

# c# - How to get strings inside tags?

> ID：14553615
> 
> 赞同：0
> 
> 时间：2013-01-27T23:45:36.217
> 
> 标签：c#, xml, string, xml-parsing

I have a webservice that returns this string value:

```
<NewDataSet>
  <Table>
    <Country>Mexico</Country>
    <City>Acapulco / G. Alvarez</City>
  </Table>
  <Table>
    <Country>Mexico</Country>
    <City>Aerop. Internacional Monterrey, N. L.</City>
  </Table>
  <Table>
    <Country>Mexico</Country>
    <City>Aguascalientes, Ags.</City>
  </Table>
</NewDataSet> 
```

I need to insert the City values in a database table. What I intend to do is search the entire string and everytime it detects a tag , I want to extract the value inside and then I would store each value in a List for later use.

However I have not been able to find a way to repeat the process various times on the same string.

I first tried Substring and Split with no success yet. Do you know a method that help me solve this problem? Thanks in advance.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T23:50:51.497

```
var cities = XDocument.Parse(myString).Descendants("City").Select(d => d.Value); 
```

这是使用 LINQ to XML 获取值的示例。一般来说，您的问题基本上是您有一个 XML 字符串，您需要以某种方式解析并获取适当的值。其他一些常用方法可能是使用 XmlDocument 或将您的 XML 反序列化为类结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T23:51:44.773

使用 Linq to XML 或类似的 XML 解析：

[http://msdn.microsoft.com/en-us/library/bb299195.aspx](http://msdn.microsoft.com/en-us/library/bb299195.aspx)

```
XElement stringAsXml = XElement.Parse(myString); 
```

# javascript - bringing focus to the parent window from a child window launched via showmodaldialog

> ID：14553620
> 
> 赞同：0
> 
> 时间：2013-01-27T23:46:26.830
> 
> 标签：javascript, html, focus, showmodaldialog

I have a scenario like this.

Window 1->opens->modal popup->opens-> window 2.

Modal popup is launched using showmodaldialog method from window 1\. From the modal popup a normal window (window 2) is launched using "window.open" method. On launching the window 2, the modal popup is closed using `self.close()` in the popup window's javascript.

Now the windows open are window 1 & window 2\. I want to transfer the focus of the window 1 from window 2\. is there anyway this can be done?

I have removed other programming code due to security restrictions at the workplace. However, given below is the gist of the code for the scenario I have explained above. Please let me know if there is anything that can be done to solve this problem?

Following is my code:

*   Parent Window (window 1):

    ```
    <html>
     <head><title> Parent Window <title>
      <script> 
          function show_popup(){ 
          base_win=window; 
          var win1=window.showModalDialog("Child_Window 1.html",base_win,"dialogHeight:500px;dialogWidth:500px;dialogLeft:300");
           } 
       </script> 
      </head>
      <body> 
          This is the parent Window 
          <input type="button" id="button1" value="click this" onclick="javascript:show_popup();">
      </body> 
    </html> 
    ```

*   Modal Popup Window:

    ```
    <html>
     <head>
       <title>Child Window 1</title>
       <script> 
             function show_window(){ 
             var win1=window.open("Child_Window 2.html","");
             self.close();
              }
       </script>
      </head>
      <body> 
          This is the Child Window 1 
           <br>
           <br>
           <input type="button" id="but1" value="click this" onclick="javascript:show_window();">
       </body>
     </html> 
    ```

*   Child Window (window 2):

    ```
    <html>
      <head>
         <title>Child Window 2</title>
          <script> 
              function goto_parent(){
               var w = window.opener; 
               window.opener = self; 
               w.focus(); 
               } 
           </script> 
         </head> 
         <body> 
             This is the child Window 
              <input type="button" id="but1" value="parent window" onclick="javascript:goto_parent();">
         </body>
     </html> 
    ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-12T07:02:25.000

在 ModalDialog 未关闭之前，窗口 1 将无法运行。因此，在基本窗口中的以下代码之后立即调用第三个窗口的实例 -

```
 var win1=window.showModalDialog("Child_Window 1.html",base_win,"dialogHeight:500px;dialogWidth:500px;dialogLeft:300"); 
```

关闭 ModalDialog 后，基本窗口将调用所需窗口的焦点。

# php - 数组（$this，$some_method_string）是什么意思？

> ID：14553623
> 
> 赞同：9
> 
> 时间：2013-01-27T23:46:41.700
> 
> 标签：php, arrays, methods

对不起，如果它看起来很简单，但这意味着什么：

```
array($this, $some_method_string) 
```

在这段代码中：

```
array_map(array($this, $some_method_string), $some_data) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-27T23:51:39.293

```
array($this, $some_method_string) 
```

这是一个有效的回调，在 $this 上调用 $some_method_string 方法：

使用 array_map ，对于 $some_data 的每个元素，调用`$this->$some_method_string(currentElement)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T23:55:26.783

您有一个带有名称的函数，例如`function my_function ...`.

您必须将该函数的名称作为字符串或字符串变量提供。

# mysql - PHPMyAdmin 错误 - “服务器没有响应”

> ID：14553625
> 
> 赞同：0
> 
> 时间：2013-01-27T23:47:03.913
> 
> 标签：mysql, phpmyadmin, wamp

在 WAMP 上访问 PHPMyAdmin 时遇到问题。数据库打不开，报错如下图：

> 错误
> MySQL 说：
> 
> #2003 - 服务器没有响应

请协助，并告知是否应该进行任何配置。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-05-23T06:04:01.743

# 完全删除您的 php 和 phpmyadmin ：

1.  sudo dpkg -P phpmyadmin
2.  sudo rm -f /etc/apache2/conf.d/phpmyadmin.conf
3.  须藤服务 apache2 重启
4.  sudo apt-get purge php.*
5.  须藤服务 apache2 重启

# 然后安装 php 7.0 ：

1.  sudo apt-get install php7.0 php7.0-fpm php7.0-mysql -y

# 最后，安装 phpmyadmin ：

1.  sudo apt-get install phpmyadmin

***sudo apt-get 享受 :)**

# javascript - 按下后退按钮刷新页面

> ID：14553626
> 
> 赞同：2
> 
> 时间：2013-01-27T23:47:23.743
> 
> 标签：javascript, html, session, back-button

我看到了与此问题相关的其他问题/答案，但我找不到任何可以清楚地解释它的东西。

我想知道当用户按下后退按钮时是否有任何 JavaScript 代码刷新页面。就像在 Facebook 或 Gmail 中一样，当您执行注销然后按返回按钮时，什么也没有发生；页面被刷新。

我创建了一个 Web 项目，当用户执行注销时，会话终止并被重定向到索引页面。但如果用户想要，他可以通过后退按钮返回并再次查看信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T23:58:01.303

如果你告诉浏览器不要缓存页面，当他们按下后退按钮时它会再次请求它。

# node.js - 为什么这个 node.js 循环在 112050 次迭代后运行缓慢？

> ID：14553629
> 
> 赞同：13
> 
> 时间：2013-01-27T23:47:40.823
> 
> 标签：node.js, performance, loops, file-io, io

我在玩 node.js，发现这个简单的程序运行得非常慢，我什至没有等到 3 分钟过去后花了多长时间。

```
var fs = require ('fs')
var s = fs.createWriteStream("test.txt");
for (i = 1; i <= 1000000; i++)
      s.write(i+"\n");
s.end() 
```

我尝试使用不同的值，发现 1-112050 需要 3 秒，而 1-112051 需要一分钟。这种突然的下降很奇怪。python 中的相同程序或等效的 shell 脚本“seq 1 112051”在合理的时间内（0-2 秒）运行。

请注意，这个 node.js 应用程序运行得更快：

```
var fs = require('fs')
     , s = []
for (var i = 1; i <= 1000000; i++) s.push(i.toString())
s.push('')
fs.writeFile('UIDs.txt', s.join('\n'), 'utf8') 
```

谁能向我解释为什么 node.js 会这样，以及为什么下降如此突然？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-28T01:54:49.950

发生这种情况是因为`for`循环是同步的，但`Writable.write()`不是。对于您的示例 s.write 创建**一百**万块队列。这导致超过**一百万个**函数调用（[像这样](https://github.com/joyent/node/blob/master/lib/fs.js#L1614)）来处理这个队列。所以，`Writable.write`不是为小块设计的。您可以[查看来源](https://github.com/joyent/node/blob/master/lib/_stream_writable.js#L121)以`Writable.write`获取有关它的更多信息。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-30T01:15:28.990

这是一个被填满的缓冲区。每次写入都将返回`true`或`false`取决于内核缓冲区的状态。

如果你开始听返回码并使用[drain](http://nodejs.org/api/stream.html#stream_event_drain)事件，它至少会在速度上保持一致。

```
var fs = require ('fs') 

function runTest(stop) {
  var s = fs.createWriteStream("test.txt");
  var startTime = Date.now();
  var c = 1;
  function doIt() {
    while (++c <= stop) {
      if (!s.write(c+"\n")) {
        s.once('drain', doIt);
        return;
      }
    }

    s.end();
    var diffTime = Date.now() - startTime;
    console.log(stop+': took '+diffTime+'ms, per write: '+(diffTime/stop)+'ms')
  }

  doIt();
}

runTest(10000);
runTest(100000);
runTest(1000000);
runTest(10000000);
runTest(100000000); 
```

输出：

```
$ node test.js
10000: took 717ms, per write: 0.0717ms
100000: took 5818ms, per write: 0.05818ms
1000000: took 42902ms, per write: 0.042902ms
10000000: took 331583ms, per write: 0.0331583ms
100000000: took 2542195ms, per write: 0.02542195ms 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2013-01-28T00:10:22.547

我相信这可能是特定于环境的，您在什么情况下编写此代码？例如，最初我认为它是用于网站的，但它涉及编写文件，这让我很反感。

否则，根据实现，使用文件系统的工作很有趣，我不应该责怪编程语言，但我真的不知道 javascript 如何处理特定系统上的文件 IO，文件 IO 的性能本身就是一门科学，可能与计算机科学本身一样古老。

# gtk - 绘制透明的 Gtk.Window

> ID：14553630
> 
> 赞同：2
> 
> 时间：2013-01-27T23:47:58.593
> 
> 标签：gtk, go, cairo

我正在尝试制作一个透明的 GTK 窗口来绘制；但是，我似乎无法弄清楚如何使用[go-cairo](https://github.com/ungerik/go-cairo)和[go-gtk](https://github.com/mattn/go-gtk/)来实现这一点。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T19:12:09.300

go-gtk doesn't have any window opacity functionality yet, making the task impossible unless you implement them yourself. This is evidenced by lines [1392](https://github.com/mattn/go-gtk/blob/master/gtk/gtk.go#L1392) and [1393](https://github.com/mattn/go-gtk/blob/master/gtk/gtk.go#L1393) of gtk.go.

As for go-cairo(which I haven't personally used) if you look at [this](https://github.com/ungerik/go-cairo/blob/master/surface.go#L109), you'll see the functionality that is compatible with [this](http://zetcode.com/gfx/cairo/transparency/). The Go function in questions is:

```
func (self *Surface) SetSourceRGBA(red, green, blue, alpha float64) {
    C.cairo_set_source_rgba(self.context, C.double(red), C.double(green), C.double(blue), C.double(alpha))
} 
```

which is the wrapper for cairo_set_source_rgba. A C-based example of this in action is available through [plan99.net](http://plan99.net/~mike/files/alphademo.c).

I would say that playing with alpha channels in go-cairo is the best bet right now to get the desired effect.

# c++ - C 或 C++ 中位域的最大大小？

> ID：14553632
> 
> 赞同：12
> 
> 时间：2013-01-27T23:48:13.477
> 
> 标签：c++, c, struct, bit-fields

> **可能重复：**
> [struct bitfield max size (C99, C++)](https://stackoverflow.com/questions/2647320/struct-bitfield-max-size-c99-c)

我可以在 C 或 C++ 的位字段中指定的位数是否有限制？例如，我可以这样做：

```
struct HugeInt {
    int myInt: 1000;
}; 
```

我在询问 C 和 C++，因为我知道语言规范有时会有所不同，并且想看看上面的示例是否可以保证在 C 或 C++ 中工作/不工作。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-27T23:52:44.940

在 C11 第 6.7.2.1 节第 4 节中：

> 指定位域宽度的表达式应是一个整数常量表达式，其非负值不超过在省略冒号和表达式时将指定的类型的对象的宽度。如果值为零，则声明不应有声明符。

所以简而言之，如果它没有位域部分，它必须在零和类型的大小之间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T23:52:36.257

位域“myInt”的大小（1000 位）不能超过其类型的大小（int，通常为 32 位）

# haskell - 并发线程管理器

> ID：14553634
> 
> 赞同：3
> 
> 时间：2013-01-27T23:48:17.297
> 
> 标签：haskell, concurrency

我有以下并发线程管理器的实现

```
newtype Query = Query String

type ThreadWorker = (Query, ThreadStatus)
data ThreadStatus = Running | Finished | Threw IOException

newtype ThreadManager = Manager (MVar (M.Map ThreadId (MVar ThreadWorker) 
```

我想写`manageWorkers :: ThreadManager -> IO ()`遍历并`Map`查看`ThreadStatus`.`ThreadWorker`

如果`ThreadWorker`完成，则将其从`ThreadManager`. 如果抛出了异常，那么应该处理它（打印到 stdout 就可以了）并且应该派生一个新线程来处理查询（假设存在一个函数`runQuery :: Query -> IO a`）并添加到`ThreadManager`，否则线程仍在运行，应该不理会。

我的第一次尝试是：

```
manageWorkers :: ThreadManager -> IO ()
manageWorkers (Manager mgr) =
    modifyMVar mgr $ \m -> do
        m' <- M.traverseWithKey manageWorker m
        return (m', ())
where manageWorker :: ThreadId -> MVar ThreadWorker -> IO (MVar ThreadWorker)
      manageWorker tid wkr = tryTakeMVar wkr >>= \mwkr ->
          case mwkr of
               Just (_, Finished) -> undefined -- need to delete this finished ThreadWorker
               Just (q, Threw e ) -> do
                   putStrLn ("[ERROR] " ++ show e)
                   tid' <- forkIO $ runQuery q
                   undefined -- need to add new ThreadWorker
               Just r -> newMVar r
               _ -> newEmptyMVar 
```

但后来我被卡住了，似乎无法从/添加`ThreadManager`到`manageWorker`. 我不确定是否可以从`traverse`-like 函数中执行我想要的操作。

`manageWorkers`是否可以使用 my实现此功能，`ThreadManager`或者那里有更好的抽象？

编辑：在 ThomasM.DuBuisson 建议使用折叠时，我现在有以下内容

```
manageWorkers (Manager mgr) =
    modifyMVar mgr $ \m ->
    return (M.foldrWithKey manageWorker M.empty m, ())
where manageWorker :: ThreadId -> MVar ThreadWorker -> M.Map ThreadId (MVar ThreadWorker)
                      -> IO (M.Map ThreadId (MVar ThreadWorker))
      manageWorker tid wkr ts = tryTakeMVar wkr >>= \mwkr ->
          case mwkr of
              Just (q, Threw e) -> do
                  putStrLn ("[ERROR] " ++ show e)
                  wkr' <- newEmptyMVar
                  tid' <- forkIO $ runQuery q
                  return $ M.insert tid' wkr' ts
              Just (_, Running) -> return $ M.insert tid wkr
              _ -> return ts 
```

唯一的问题是，显然`manageWorker`'s 签名不能用`M.foldrWithKey`。我需要一个`M.foldrWithKeyM :: Monad m => (k -> a -> b -> m b) -> b -> M.Map k a -> m b`但这样的东西不存在，而且我自己编写它时遇到了麻烦。

显然，我可以`unsafePerformIO`用来逃避 IO monad 并满足编译器的要求，但我只会将其用作最后的手段。在这种情况下使用是否有意义`unsafePerformIO`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T14:11:05.183

在我看来，您的问题与并发无关。
您只想遍历一个映射，同时从映射中删除一些键或在映射中插入一些键并执行一些`IO`操作。
问题是`traverseWithKey`无法从映射中删除键或在映射中插入键，`foldrWithKey`无法执行`IO`操作。
你需要一个`M.foldrWithKeyM :: Monad m => (k -> a -> b -> m b) -> b -> M.Map k a -> m b`
的确，这样的事情是不存在的。但是，如果您查看 的文档`foldrWithKey`，其中指出：

```
foldrWithKey f z == foldr (uncurry f) z . toAscList. 
```

如果我们用 复制，我们可以猜测这样`M.foldrWithKeyM`可以组成。 以下是我的解决方案。 `foldr``foldM`

```
manageWorkers :: ThreadManager -> IO ()
manageWorkers (Manager mgr) = 
    modifyMVar mgr $ \m -> do
        m' <- foldM manageWorker m (M.toList m)
        return (m', ())
  where manageWorker :: M.Map ThreadId (MVar ThreadWorker) -> (ThreadId, MVar ThreadWorker) -> IO (M.Map ThreadId (MVar ThreadWorker))
        manageWorker ts (tid, wkr) = tryTakeMVar wkr >>= \mwkr ->
            case mwkr of
                 Just (_, Finished) -> return $ M.delete tid ts -- need to delete this finished ThreadWorker
                 Just (q, Threw e ) -> do
                       putStrLn ("[ERROR] " ++ show e)
                       wkr' <- newEmptyMVar
                       tid' <- forkIO $ runQuery q
                       return $ M.insert tid' wkr' ts -- need to add new ThreadWorker
                 _ -> return ts 
```

# iphone - Apple 推送通知未到达测试设备

> ID：14553637
> 
> 赞同：2
> 
> 时间：2013-01-27T23:48:43.993
> 
> 标签：iphone, objective-c, push-notification

我遵循[了 Apple 的文档](http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/ProvisioningDevelopment/ProvisioningDevelopment.html#//apple_ref/doc/uid/TP40008194-CH104-SW5)。

在我的应用程序中，我成功注册了通知（警报、徽章和声音）并将设备令牌发送到我的服务器（它是一个 32 字节的字符串，我对它进行了十六进制编码以用于传输和存储）。这一切都有效。

如文档中所述，我的配置文件包含设置为“开发”的“aps-environment”。我已经从证书和与此证书关联的密钥生成了一个 PEM*文件*。

我正在使用 Grocer（在[Github](https://github.com/grocer/grocer)上）从我的服务器发送通知。Apple 很高兴地接受了通知，但它从未到达设备上。在过去的 12 小时内，我已经尝试了很多次，以确保应用程序没有在前台运行。我使用**gateway.sandbox.push.apple.com**作为端点。

我不知所措。我应该看什么？Apple自己的[故障排除指南](http://developer.apple.com/library/ios/#technotes/tn2265/_index.html) 对我没有帮助。

有些人提到生成一个 Ad-Hoc 配置文件（尽管 Apple 没有声明这是必需的）。无论如何我都试过了，但是配置文件在 aps-environment 下说“生产”，我无法在我的设备上安装我的应用程序。

编辑 | 我只能假设我的 PEM 证书设置不正确......我这么说是因为即使我使用一些完全随机的证书，杂货店似乎仍然“发送”通知。不知道如何调试任何错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T00:02:40.630

使用开发者配置文件时需要沙箱网关：

```
gateway.sandbox.push.apple.com 
```

如果这仍然不起作用，请尝试重新启动设备！这通常有帮助！

不要忘记在您的应用发布时更改链接！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T12:13:38.527

事实证明，这只是我在客户端错误地对设备令牌进行了十六进制编码。我实际上是这样做的：

```
char *buf = malloc(sizeof(char) * 2 * numBytes);

while (numBytes--)
  sprintf(buf+=2, "%02x", *(bytes++)); 
```

问题是那`bytes`是 a `char*`，而它应该是 a `unsigned char*`，所以数据被破坏了。

# javascript - Javascript 并从另一个命名空间属性引用

> ID：14553639
> 
> 赞同：1
> 
> 时间：2013-01-27T23:49:30.840
> 
> 标签：javascript, namespaces

> **可能重复：**
> [Javascript 对象如何引用自身的值？](https://stackoverflow.com/questions/2787245/how-can-a-javascript-object-refer-to-values-in-itself)

假设我有：

```
var myNamespace = {
      _prop1: 'hello',
      _prop2: _prop1 + ' you!'
}; 
```

我现在才发现这会`_prop2`在加载时出错。

我不明白为什么这不起作用，我已经在我的代码中解决了它，但我仍然想理解。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T23:59:41.867

当您尝试设置 prop2 时，该对象尚未初始化，因此 prop1 和 mynamespace 的值都未定义。

有几种方法可以实现您想要的，一种方法是将 prop2 创建为函数，以便它可以动态获取 prop1 的值

```
var myNamespace = {
      _prop1: 'hello',
      _prop2: function(){ return this._prop1 + ' you!' }
}; 
```

另一种方法是在 myNamespace 初始化后设置 prop2

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T23:57:59.827

你必须使用这个：

```
var myNamespace = {
    _prop1: 'hello'
};
myNamespace._prop2: myNamespace._prop1 + ' you!'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T23:53:15.757

好吧，你可以做

```
var myNamespace = {
      _prop1: 'hello',
      _prop2: myNamespace._prop1 + ' you!'
}; 
```

我认为不可能在声明中以任何其他方式做到这一点（例如：使用“self”或“this”不起作用）

# android - Datadroid 和滑动菜单 / HoloEverwhere

> ID：14553640
> 
> 赞同：1
> 
> 时间：2013-01-27T23:49:33.070
> 
> 标签：android, slidingmenu, android-holo-everywhere, datadroid

我正在尝试使用 Datadroid 和滑动菜单/HoloEverywhere。滑动菜单正在使用`Fragment`. Datadroid 是否有可能成为主要活动的片段？:) 我已经成功地在这样的一个活动中制作了一个 datadroid 应用程序：

```
public final class tonesListActivity extends DataDroidActivity implements RequestListener,
OnClickListener, ConnectionErrorDialogListener, LoaderCallbacks {
..... 
```

但是如果datadroid是主要活动的片段呢？有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T08:00:56.317

DataDroid - [https://github.com/foxykeep/DataDroid](https://github.com/foxykeep/DataDroid)？

DataDroidActivity 扩展 android.support.v4.app.FragmentActivity。
是的，你可以在这个activity中添加fragment，但是如果你改变这一行会更好：
`java public abstract class DataDroidActivity extends FragmentActivity`
on
`java public abstract class DataDroidActivity extends org.holoeverywhere.app.Activity`
并且对DataDroidApplication进行了类似的转换。

# ruby-on-rails - 如何使用 RSpec 测试嵌套的 Ruby on Rails 控制器？

> ID：14553642
> 
> 赞同：2
> 
> 时间：2013-01-27T23:49:46.737
> 
> 标签：ruby-on-rails, rspec

我有一个名为的**Rails**控制器，它嵌套在*app/controllers/sevenpages/public/pages_controller.rb*`PagesController`中，如下所示：

 *```
module Sevenpages
  module Public
    class PagesController < ApplicationController
      layout nil
      def show 
      end
    end
  end
end 
```

我想使用**RSpec测试这个控制器**

*当我在spec/controllers/sevenpages/pubic/pages_controller_spec.rb*创建以下测试时：

```
require 'spec_helper'

describe Sevenpages:Public::PagesController do
  describe 'GET #show' do
    get :show, use_route: :sevenpages
    {{ tests go here }}
  end
end 
```

我收到以下错误：

```
undefined method `get' for #<Class:0x007fe5c88e4300> (NoMethodError) 
```

现在我明白了这个错误信息的含义。问题是这些`RSpec::Rails::ControllerExampleGroup`方法没有自动包含在控制器测试中，所以标准的 Rails 方法，如`get`,`post`等在测试中不可用。

我已经尝试了所有推荐的解决方案，但没有运气。这是我尝试过的：

*   确保`spec/spec_helper.rb`包含`require 'rspec/rails'`

*   使用以下命令显式声明测试类型：

    `describe Sevenpages::Public::PagesController, type: :controller do`

*   使用以下命令显式包含控制器示例组：

    `include RSpec::Rails::ControllerExampleGroup`在控制器主体中

我不知道还能尝试什么。我应该注意我正在使用：

*   导轨 3.2.11
*   RSpec 2.12.2

**我的应用程序是 Rails 引擎**，因此是`use_route`该方法的参数`get`。

我唯一能想到的是，RSpec 不知道如何处理嵌套如此深的控制器。是否有一些我应该注意的语法以使 RSpec 能够正确地将其解析为控制器测试？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T01:17:28.637

您在上面发布的代码在描述块中进行了测试。通常使用 Rspec，您将测试放在“it”块中。像：

```
describe Sevenpages:Public::PagesController do
  describe 'GET #show' do
    it 'should work' do
      get :show, use_route: :sevenpages
      {{ tests go here }}
    end
  end
end 
```

如果您尝试这样做，该方法是否会正确定义？*

# lua - 执行通用循环时“尝试调用零值”

> ID：14553647
> 
> 赞同：0
> 
> 时间：2013-01-27T23:50:13.250
> 
> 标签：lua

Lua（标准解释器）出现错误，我找不到问题的根源。我正在尝试创建类似于 Java、C# 等语言的枚举的东西。我必须定义枚举标准的当前代码是这样的：

```
enum = {
    new = function (self, ...)
        local o = {};
        setmetatable(o, self);
        self.__index = self;
        for k,v in args do -- THIS LINE IS GIVING THE ERROR
            self[v] = 2^k;
        end
        table.sort(self, function(a,b) if a>b then return true; else return false; end end)
        return o;
    end,
    sum = function (self, ...)
        local s
        for k,v in args do
            s = s+self[v];
        end
    end,
    expand = function (self, number)
        indices = {};
        for k,v in ipairs(self) do
            if v < number then
                table.append(k);
                number = number-v;
            end
        end
        return unpack(indices);
    end
} 
```

错误出现在`new`函数中，在循环语句中（而不是其中的语句）。这可能是什么原因？我不是在“调用”这些值，只是引用它们。我也尝试用 替换`2^k`，`math.pow(2,k)`所以这也不是数学。我运行以下代码来测试脚本：

```
myEnum = enum:new("a","b","c"); 
```

我应该注意，错误只是说明标题上的内容，没有变量名或任何内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T00:29:32.163

首先，该类型的 for 循环`for k,v in...`需要一个迭代器函数，而不是一个表；其次，`args`当您引用它时未设置。如果要将可变参数循环到函数，请使用`for k,v in ipairs({...})`.

请注意，如果其中一个可变参数为 nil，则迭代`ipairs`可能会在 nil 处停止，并且`pairs`不能保证迭代以它们传递的相同顺序返回可变参数。如果这是一个问题，可以在[此处](https://stackoverflow.com/questions/7183998/in-lua-what-is-the-right-way-to-handle-varargs-which-contains-nil)找到解决方法。

# jquery - jquery隐藏/显示淘汰赛foreach循环

> ID：14553648
> 
> 赞同：0
> 
> 时间：2013-01-27T23:50:16.143
> 
> 标签：jquery, knockout.js

在 foreach 循环中我有我的内容......

```
 <div foreach:"data">
             <input type="image" id="hideshow" src="/Images/aud_down-arrow.gif" />    
           <div id="content"> 
         <textarea data-bind="text:valueoftext" rows='5' cols='60'></textarea>

        </div></div>
     jQuery(document).ready(function ()     {    
    jQuery('#hideshow').live('click', function (event)     {    
        jQuery('#content').toggle('show');
           });    
}); 
```

目前它会创建文本框，但只有第一个文本框隐藏/显示... 循环中的所有文本框都不起作用。

任何关于如何完成这项工作的建议都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T03:48:47.533

使用 class="content" 而不是 id="content"

```
jQuery('.content').toggle('show'); 
```

对于 id 选择器，jQuery 使用 JavaScript 函数 document.getElementById()，如果多个元素被分配了相同的 ID，使用该 ID 的查询将只选择 DOM 中第一个匹配的元素。

在以下位置查看更多信息： http: [//api.jquery.com/id-selector/](http://api.jquery.com/id-selector/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T00:53:26.067

好的，我最好的猜测是填补你的问题中的空白，你正在以这样一种方式生成 html，即你为每个输入重新使用了相同的 id，并为每个 div 重新使用了相同的 id。这会导致 html 无效，因为 id 在页面上必须是唯一的，并且尝试通过 id JS/jQuery 选择元素只会找到第一个。

您需要做的是为每个输入提供相同的*类*属性而不是 id，并且对于 div 类似。如果每组项目都在自己`<li>`的 a`<ul>`中，或者在它自己`<tr>`的 a中，这将是有意义的`<table>`，所以我建议你做这样的事情：

```
<ul>
   <li>
       <input type="image" class="hideshow" src="/Images/aud_down-arrow.gif" />    
       <div class="content"> 
          <textarea data-bind="text:valueoftext" rows='5' cols='60'></textarea>
       </div>
   </li>
   <li>
       <input type="image" class="hideshow" src="/Images/aud_down-arrow.gif" />    
       <div class="content"> 
          <textarea data-bind="text:valueoftext" rows='5' cols='60'></textarea>
       </div>
   </li>
   <!-- etc. -->
</ul> 
```

然后你可以使用 jQuery 的 DOM 导航方法找到与每个图像关联的 div：

```
jQuery(document).ready(function ()     {    
    jQuery('.hideshow').live('click', function (event) {    
        jQuery(this).closest("li").find("div.content").toggle('show');
    });
}); 
```

也就是说，当单击图像时，向上导航到最近的包含`<li>`（或`<tr>`您正在使用的任何内容）的树，然后从那里向下导航到该容器内的适当内容。

请注意，这`.live()`已经过时了，应该替换为*-*`.on()`给包含元素（`<ul>`或者`<table>`你正在使用的任何东西）一个 id，说`"mylist"`然后这样做：

```
jQuery('#mylist').on('click', '.hideshow', function() { ... 
```

如果由于某种原因您没有容器中的每组元素并且您真的不想添加包含元素，那么您仍然需要将 id 更改为 classes 但可以这样做：

```
 jQuery('.hideshow').live('click', function (event) {    
        jQuery(this).next().toggle('show');
    }); 
```

即，选择紧随单击项目之后的任何元素并切换它。我仅将其作为最后手段推荐的原因是它将您的 JS 与 html 的结构紧密联系在一起。使用`$(this).closest("someParentElement").find("associatedElement")`type 方法更加灵活，如果 html 结构需要更改，可能不需要更改。

# ruby-on-rails - 为什么我的 rails localhost 服务器在我停止时会继续运行？

> ID：14553651
> 
> 赞同：1
> 
> 时间：2013-01-27T23:50:36.580
> 
> 标签：ruby-on-rails

我正在使用 Aptana Studio 并且有 2 个终端，一个用于命令，另一个用于服务器。当我运行 rails server ( `rails s`) 时，做任何我需要做的事，而不是停止它。就好像我没有关闭它一样。我`PostgreSQL`在 Windows 7 上使用数据库。其他人有这个问题吗？

也许这不是 Rails 问题，而是 Windows 问题。如果是后者，我将如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T00:26:19.810

这不是 Rails 问题，它也发生在 ubuntu 12.10 上，如果我想重新启动 rails 服务器，我会在 ubuntu 中手动终止进程

```
 ps -x | grep rails 
   sudo kill -9 "id of the process" 
```

在Windows中，只需从任务管理器中终止进程会更容易

# entity-framework-5 - EntityFramework 上下文：单例？

> ID：14553656
> 
> 赞同：1
> 
> 时间：2013-01-27T23:51:19.643
> 
> 标签：entity-framework-5

我在使用 EF5 的上下文中遇到了一些问题。我仍在研究这个问题，但我认为用单例模式实现我的 DataContext 类是一个好主意，以便让不同的实体存储库使用相同的对象。是自杀还是有意义？另一个想法是在这里实现一个 ContextManager：http: [//www.codeproject.com/Articles/70061/Architecture-Guide-ASP-NET-MVC-Framework-N-tier-En](http://www.codeproject.com/Articles/70061/Architecture-Guide-ASP-NET-MVC-Framework-N-tier-En)（但我仍在检查他的代码和我还没有真正深入了解它）。

你怎么看？

**- 编辑 -**

在 Web 应用程序中，我正在为我必须管理的每个实体实现一个存储库

```
public DataContext : DbContext
{
    //...
} 
```

*解决方案 1*：很好，但是如果我需要在一次调用中执行多个操作，即插入和删除，我想我将对 db 进行两次调用。

```
public Entity1Repository
{
    public void Add(Entity1 entity)
    {
        using(DataContext context = new DataContext())
        {
            context.Entity1.Add(entity);
            context.SaveChanges();
        }
    }
    public void Delete(Entity1 entity)
    {
        using(DataContext context = new DataContext())
        {
            context.Entity1.Remove(entity);
            context.SaveChanges();
        }
    }
} 
```

*解决方案 2*：在这种情况下，我想我只会调用一次 db，但我需要记住调用 Dispose()

```
public Entity1Repository
{
    private DataContext context;

    public void Add(Entity1 entity)
    {
        context.Entity1.Add(entity);
    }

    public void Save() 
    {
        context.SaveChanges();
    }

    public void Dispose()
    {
        context.Dispose();
    }
} 
```

哪个是最好的实现？（如果我理解正确，单身不是一个好人）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-28T13:14:21.050

我建议您通过构造函数注入（依赖注入）共享您的 dbcontext。

然后，我将使用 IoC 将上下文注入容器中，每个请求具有生命周期。因此，为您的 Web 中的每个请求创建 dbcontext，并在该请求期间与每个存储库共享，然后在请求后处理。

Mark seemann 有一本关于依赖注入和示例的好书。 [http://www.manning.com/seemann/](http://www.manning.com/seemann/)

希望这可以帮助您入门。

# python - 使用 python 从 MS Word 中读取数据（与变量相关）

> ID：14553663
> 
> 赞同：0
> 
> 时间：2013-01-27T23:51:54.497
> 
> 标签：python, ms-word

Python 新手。我有许多带有文本框的 Word 文档。使用 VBA，我将这些框中的文本捕获到变量中。首先，我希望能够打开给定文件夹中的每个 Word 文档，读取每个包含文本框数据的 VBA 变量并将其打印到文本文件中。

我有 Python 2.7.3 并安装了 Pywin32。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T02:19:27.783

有两种方法可以从你所在的位置开始：使用 Python + COM 远程控制你的 word 应用程序——这应该是更容易做的事情。从 Python 访问 Word 数据的另一种方法是将 Python 脚本写入 LibreOffice 套件——它能够自行导入 MS-word 文件，并与 Python 交互。但是这样做应该很复杂，因为该接口的文档记录很差，并且很少有人使用。

因此，自动化 ms-word 是更简单的方法 - 请查看此处的示例 - 它们应该可以帮助您入门： [http ://win32com.goermezer.de/content/view/158/192/](http://win32com.goermezer.de/content/view/158/192/)

# mysql - 将图像与事件相关联的简单 MySQL 查询

> ID：14553664
> 
> 赞同：0
> 
> 时间：2013-01-27T23:51:55.783
> 
> 标签：mysql

在我的小型应用程序中，我的事件可以与多个图像相关联。

例如，事件“单板滑雪”可能具有与其相关联的三个图像。

**这是我的表：**

```
Events
   event_id  title

Event_Images
   event_image_id   image_src   time_uploaded 
```

这是我目前正在使用的查询：

```
SELECT * FROM Events, Event_Images 
   WHERE Events.event_id = Event_Images.event_id 
```

结果如下：

```
[
    {
        "event_id": "67",
        "title": "Setting up the UGS App!",
        "event_image_id": "64",
        "image_src": "uploads/50f47bce35d4f.jpg",
        "time_uploaded": "2013-01-14 16:42:41"
    },
    {
        "event_id": "67",
        "title": "Setting up the UGS App!",
        "event_image_id": "92",
        "image_src": "uploads/49f4709eppdl.jpg",
        "time_uploaded": "2013-02-14 12:44:43"
    }
] 
```

但是，这对我来说似乎是多余的。我认为冗余最少的数据结构如下所示：

```
[
    {
        "event_id": "67",
        "title": "Setting up the UGS App!",
        "event_image_id": "64",
        "images": [
            {
                "image_src": "uploads/50f47bce35d4f.jpg",
                "time_uploaded": "2013-01-14 16:42:41"
            },
            {
                "image_src": "uploads/49f4709eppdl.jpg",
                "time_uploaded": "2013-02-14 12:44:43"
            }
        ]
    }
] 
```

我想要么我目前的做法是正确的，要么有一种方法可以减少我的查询的冗余结果。

如果这似乎是一个简单的问题，请原谅我的无知。

非常感谢任何参考或帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T23:54:19.817

SQL 返回匹配的行。它不会从 RBMS 返回数据层次结构。您将需要两个查询来实现您想要的数据结构——一个选择事件，然后一个选择事件图像。然后将事件图像附加到事件对象中的“图像”数组中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T01:22:56.367

好的，多亏了 inhan，我有了答案——在数据返回后使用 php 格式化数据。有了这些信息，我就写了一个可重用的函数：

```
function merge_data($data, $merge_key, $merge_prop, $merge_data) {
    /* build an array of the merge data arranged by the merge key */
    $associated_data_keys = array();
    foreach($data as $value) {
        $grouped_merge_data = array(); // group together the merge data
        foreach($merge_data as $merge_value) {
            $grouped_merge_data[$merge_value] = $value[$merge_value];
        }
        if (empty($associated_data_keys[$value[$merge_key]])) {
            $associated_data_keys[$value[$merge_key]] = array();
        }
        array_push($associated_data_keys[$value[$merge_key]], $grouped_merge_data);
    }

    /* remove duplicate data values */
    $existing_keys = array();
    foreach($data as $key => $value) {
        if (!in_array($value[$merge_key], $existing_keys)) {
            array_push($existing_keys, $value[$merge_key]);
        } else {
            unset($data[$key]);
        }
    }

    /* remove merge data properties */
    foreach($merge_data as $value) {
        foreach($data as $key => $data_value) {
            unset($data[$key][$value]);
        }
    }

    /* put our data from the first statement back into our data set */
    foreach($data as $key => $value) {
        /* assign our data set at this value at the merge property to the corresponding merged data */
        $data[$key][$merge_prop] = $associated_data_keys[$value[$merge_key]];
    }

    return $data;
} 
```

在这种情况下使用：

```
$events = merge_data($events, 'event_id', 'images', array('event_image_id', 'image_src', 'time_uploaded')); 
```

# php - 访问由 jQuery 动态创建的文本框中的值

> ID：14553665
> 
> 赞同：1
> 
> 时间：2013-01-27T23:52:21.873
> 
> 标签：php, javascript, jquery, jquery-plugins

我使用 jQuery 动态创建了填充随机数的文本框。我不确定如何访问动态创建的文本框中的值。我想访问文本框的值，以便我可以测试它们是否有重复的数字，或者检查它们是否是非数字的，因为用户可以在创建文本框后更改并将任何字符输入到文本框中。我可能无法使用数组来访问它们，因为在使用 PHP 将它们插入 MySQL 之前，我将无法使用 jQuery Validate 插件（或者我可以吗？）测试这些值。另外，我想访问文本框的值，以便可以使用 PHP 将它们插入 MySQL。有谁知道我如何访问这些动态创建的文本框的文本框值，以便可以使用 PHP 引用它们以插入 MySQL？非常感谢您的帮助。

这是创建动态文本框并输入随机数的主要代码。

```
 // Fill the textboxes with the generated numbers
    var parentForm = $(this).closest(".form");
    for (var n in random_numbers)
    parentForm.find(".inputs input:eq(" + n + ")").val(random_numbers[n]);
}

$(document).ready(function() {
    $('#dropdownadd').change(function() {

        var dropDownDiv = $('#dropdowndiv');

        dropDownDiv.html("");

        $loopcount = $(this).val();

        for (var i = 1; i <= $loopcount; i++) {
            var setHtml = "";

            setHtml = '<div class="form"><form id="frm' + i + '">';
            setHtml += '<label>Number Set #' + i + '</label>';
            setHtml += '<div class="action"><input type="button" class="button" id="btn' + i + '" value="Generate Numbers" /></div>';
            setHtml += '<div class="inputs">';
            for (var t = 0; t < 3; t++) {
                setHtml += '<input type="text" name="num' + t + '" id="num' + t + '" class="input" />';
            }
            setHtml += '</div>';
            setHtml += '</div>';
            dropDownDiv.append(setHtml);

            $("#btn" + i).bind('randomize', getRandomNumbers).click(function(e) {
                $(this).trigger('randomize');
            });
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T14:24:36.910

基于我在这里创建的演示是我目前在 php 中接收表单的方式：

```
print_r( $_GET); 
```

结果是：

```
Array
(
    [num_1_0] => 385122
    [num_1_1] => 719388
    [num_1_2] => 865862
    [num_2_0] => 205449
    [num_2_1] => 819047
    [num_2_2] => 870961
) 
```

可以轻松地将这个数组操作成任何其他格式。字段名称中的第一个数字是行，第二个是行中的索引

**编辑**：要将此输出设置表单方法可视化为“GET”，请将操作设置为`process-form.php`. 放入`process-form.php`以下内容：

```
echo '<pre>';
print_r( $_GET); 
```

现在提交表格

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T23:59:26.273

当您动态创建文本框时，给它们一个唯一的**id**标签和一个**名称**标签（相同的值）

例如 TB1 TB2 TB3....

然后，您将能够从 JS 访问它们

```
$('#TB' + n).val() 
```

其中**n**是您要访问的文本框编号。

由于它们在表单中，因此这些值将发布到标签**操作**中指定的表单 url，并可用于 PHP 处理

# c# - WebClient.DownloadFileAsync 获取不完整的内容

> ID：14553668
> 
> 赞同：1
> 
> 时间：2013-01-27T23:52:35.690
> 
> 标签：c#, .net, webclient, downloadfileasync

我`WebClient.DownloadFileAsync`用来获取一批文件。然而，有些文件是不完整的，也不例外。

我的问题是，当下载的文件不完整时如何标记？没有要验证的 md5 校验和。

代码片段是：

```
using (WebClient client = new WebClient())
{
    Uri sUri = new Uri(sFileLink);
    client.DownloadFileAsync(sUri, myPath);
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-27T23:58:08.653

您在客户端完成下载之前将其处理掉。不要那样做。

您应该只在出现错误或完成时处理，您会通过引发`WebClient`的事件发现（或在 .NET 4.5 中使用，并等待结果任务）。`WebClient``DownloadFileTaskAsync`

# c# - 与 c# 统一的雾

> ID：14553672
> 
> 赞同：1
> 
> 时间：2013-01-27T23:52:49.857
> 
> 标签：c#, unity3d

我正在尝试使用 c# 脚本在 unity3d 中使雾随着时间的推移变得更加密集

在开始时我打开它，如下代码所示

```
 void Start () {
    RenderSettings.fog =true;
    RenderSettings.fogDensity = 0.00f;
 } 
```

在更新中，我每 3 秒检查一次并添加到密度，如下代码所示

```
 void Update () {
      StartCoroutine(updateTheFog());
 } 
```

updateTheFog 函数是

```
IEnumerator updateTheFog(){

    yield return new WaitForSeconds(3); 

    RenderSettings.fogDensity+=0.01f;
} 
```

问题是它等待 3 秒，然后自动转到 1.0，而不是每 3 秒递增 0.01

感谢任何帮助解决这个问题

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T03:33:21.130

根据[这个](http://answers.unity3d.com/questions/375656/execute-coroutine-in-update.html)问题，您不应该为此使用更新，因为更新每帧运行一次并且不能延迟。而不是这样做，您可以做的是在 Start() 中启动协程并使用`while(true)`无限循环手动重复此操作。

```
void Start () 
{
    RenderSettings.fog =true;
    RenderSettings.fogDensity = 0.00f;
    StartCoroutine(updateTheFog());
}

IEnumerator updateTheFog() 
{
    while(true)
    { 
        //this makes the loop itself yield 
        return new WaitForSeconds(3); 

        RenderSettings.fogDensity+=0.01f;
    }
    //if you want to stop the loop, use: break;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T23:27:31.390

Lee Taylor 所说的应该可行，但作为替代方案，您可以使用 InvokeRepeating 函数，它允许您设置一个函数以在特定时间间隔调用，有点像 .net 框架中的计时器。您甚至可以通过调用 CancelInvoke 来停止调用重复。

```
void Start(){
    InvokeRepeating("updateTheFog",3,3);
}
void updateTheFog(){
// do your fog stuff
if(fogDensity == 1)
    cancleInvoke()
 } 
```

# javascript - 如何发布多个复选框列表并进行处理？

> ID：14553674
> 
> 赞同：1
> 
> 时间：2013-01-27T23:52:53.120
> 
> 标签：javascript, jquery, html

我的应用程序将用户的电话号码作为输入并将它们存储在数据库中。在一个单独的页面上，我们要求用户检查应该对其他用户可见的电话号码。请不要问任何关于我们为什么要这样做的问题，因为这样做是出于与此问题无关的一些商业原因。

现在，我正在尝试显示这些电话号码并要求用户检查那些应该可见的电话号码或取消选中他之前检查过的电话号码。我有以下未解决的问题：

1.  当用户提交表单时，我不知道他的电话号码是什么。如何将复选框与电话号码关联？
2.  如果我使用隐藏字段，给这些输入字段，它们对应的电话号码作为 ID 是否是标准做法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T00:18:36.677

假设没有电话号码重复，最简单的方法是将每个复选框的值设置为其关联的电话号码：

```
0262543210 <input type="checkbox" name="makeVisible" value="0262543210">
0265511223 <input type="checkbox" name="makeVisible" value="0265511223">
0398123456 <input type="checkbox" name="makeVisible" value="0398123456"> 
```

（显然你会添加某种格式，表格或无序列表或其他东西。）

然后在您的服务器端代码中处理每个`makeVisible`（或您给它的任何名称）值，请记住只有选中的那些会被提交。此方法不需要 JavaScript。

如果您想为每个数字提交一个是/否或真/假（可见/隐藏）值，那么 no-JS 方法就是使用单选按钮。但是使用复选框最简单的方法可能是根据复选框状态设置隐藏字段：

```
<table>
  <tr>
    <th>Phone Number</th>
    <th>Make visible?</th>
  </tr>
  <tr>
    <td>0262543210</tr>
    <td>
       <input type="hidden" name="number" value="0262543210">
       <input type="hidden" name="makeVisible">
       <input type="checkbox" class="numbervisibility">
    </td>
  </tr>
  <tr>
    <td>0265511223</tr>
    <td>
       <input type="hidden" name="number" value="0265511223">
       <input type="hidden" name="makeVisible">
       <input type="checkbox" class="numbervisibility">
    </td>
  </tr>
  <!-- etc. -->
</table> 
```

如果需要，添加带有记录 ID 的其他隐藏字段，或者使用记录 ID 而不是电话号码 - 任何适合您的数据结构的内容。

然后在复选框更改时使用一些简单的 jQuery 设置隐藏值：

```
$(".numbervisibility").click(function() {
    $(this).closest("td").find('input[name="makeVisible"]').val(this.checked ? "Y" : "N");
}); 
```

这样，在服务器端，您最终会得到具有数字和相关可见性设置的匹配字段数组。

请注意，如果您使用的是 PHP，则应`[]`在末尾为重复字段命名，例如`"makeVisible[]"`.

（当然，在任一解决方案中，您都可以使用服务器端代码将电话号码注入 html。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T00:14:22.517

好吧，当您提交页面时，您肯定会将数据作为 PhoneNumber/Show 对的集合发送到后端处理代码（无论是什么平台），并基于此将它们创建到数据库中（无论如何您都这样做） )，根据给定对的数据设置 Show 标志。

即在 jquery 中（假设你没有使用我建议你这样做的敲除之类的数据绑定框架）当用户单击提交按钮时，你将 $().each 包含 CheckBox/Phone 的所有容器编号元素并构造一些 JSON 来发送，如下所示：

```
{
   UserID:xxx,
  [{PhoneNumber:12345,Show:true},
  {PhoneNumber:999,Show:false}]
} 
```

然后发送它，但是您通常会发送您的数据

然后在服务器端，你有一个相应的类来接收这些信息，遍历它并在数据库中做任何需要做的事情，如果它不存在则创建它，如果它存在则更新它等等。

还是我错过了什么？您能否提供更多有关平台的信息、应用程序如何呈现页面（本机、html5）、您当前如何将数据发送到服务器等？

# r - ggplot2 绘图函数和 strptime(as.character() )

> ID：14553675
> 
> 赞同：0
> 
> 时间：2013-01-27T23:52:57.780
> 
> 标签：r, datetime, ggplot2

我有一个时间序列数据，我想用这段代码来绘制它：

```
temp  <- read.csv("C:/Thesis/Data_set/grosseroor/25.csv",
                        header = FALSE)

names(temp) <- c("dt","ambtemp")
require(ggplot2)
library(scales)
temp$dt <-strptime(as.character(temp$dt), format = "%Y/%m/%d %H:%M")
ggplot(temp, aes(dt, ambtemp)) + geom_line() +
  scale_x_datetime(breaks = date_breaks("5 hour"),labels=date_format("%H:%M")) +
  xlab("Time 00.00 ~ 24:00 (2007-09-29)") + ylab("Tempreture") 
```

样本数据：

```
date_time                
    10/20/2007 4:52 -6.14
    10/20/2007 4:54 -6.17
    10/20/2007 4:56 -6.09
    10/20/2007 5:00 -7.2
    10/20/2007 5:02 -6.65
    10/20/2007 5:04 -6.04
    10/20/2007 5:16 -6.26
    10/20/2007 5:20 -6.52
    10/20/2007 5:22 -6.4
    10/20/2007 5:24 -6.92
    10/20/2007 5:26 -7.04
    10/20/2007 5:28 -6.84
    10/20/2007 5:30 -6.16
    10/20/2007 5:32 -7.13
    10/20/2007 5:34 -7.43
    10/20/2007 5:36 -6.84
    10/20/2007 5:38 -7.82
    10/20/2007 5:40 -6.84
    10/20/2007 5:42 -6.84
    10/20/2007 5:44 -7.46
    10/20/2007 5:46 -7.74
    10/20/2007 5:48 -8.04 
```

但是当我运行该行时`temp$dt <-strptime((temp$dt), format = "%Y/%m/%d %H:%M")`，所有日期时间列都更改为`NA`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T07:33:14.117

问题是`format`由于`strptime`. 您指定`%m/%d/%Y`了 ，但数据的格式不同：月/日/年。因此，您必须将命令更改为：

```
temp$dt <-strptime(as.character(temp$dt), format = "%m/%d/%Y %H:%M") 
```

如您所见，日期元素的顺序随后自动显示为年-月-日：`2007-10-20`。

专栏还有另一个问题`ambtemp`。正如您在评论中看到的那样，这是一个因素。我认为它应该是数字。您可以使用以下命令对其进行转换：

```
temp$ambtemp <- as.numeric(as.character(temp$ambtemp )) 
```

现在，您可以绘制数据（我没有更改以下命令）：

```
require(ggplot2)
library(scales)

ggplot(temp, aes(dt, ambtemp)) + geom_line() +
  scale_x_datetime(breaks = date_breaks("5 hour"),labels=date_format("%H:%M")) + 
  xlab("Time 00.00 ~ 24:00 (2007-09-29)") + 
  ylab("Tempreture") 
```

![在此处输入图像描述](../Images/914db31fddab2497f5a59cd1e089c070.png)

# javascript - javascript中的字符串函数任务

> ID：14553678
> 
> 赞同：-2
> 
> 时间：2013-01-27T23:53:17.643
> 
> 标签：javascript, regex, string, function, string-parsing

大家好，我正在尝试获取表单的 URL

```
http://www.domainname.com/stuff/morestuff/content?extrastuff 
```

并使用 JavaScript 字符串函数根据周围的正则表达式“morestuff/”和“?”解析出“内容”。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T23:57:04.627

```
var c = yourString.match(/\/morestuff\/([^?]*)/)[1]; 
```

# c - 不同进程的共享结构

> ID：14553679
> 
> 赞同：1
> 
> 时间：2013-01-27T23:53:31.793
> 
> 标签：c, parallel-processing, exec, fork, shared-memory

我需要在 C/C++ 中的不同可执行文件之间定义一个共享结构。我怎样才能做到这一点？在我的 starter.c 文件中：

```
pid_t child = fork();
if (child > 0) {
  // Parent.
  ... // detach shared memory
  argv[0] = "./app1";
  execv(argv[0], argv);
}
else {
  // Child.
  argv[0] = "./app2";
  execv(argv[0], argv);
} 
```

*   start.h -> 定义共享结构
*   start.c -> 创建对象和分叉（如上面的代码）
*   app.c -> 使用共享结构

**更新：**

*   如果我在*start.h定义一个类，在共享内存中的**fork()*之前创建它（使用 MAP_SHARED），并在 app1.c 中访问它的成员（如 shared_class->s），则会出现分段错误

*   **所以问题是：**如何在执行后保持类/变量不变？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T01:16:05.557

如果你有一个共享结构，为什么不在一个单独的 .h(header) 文件中声明它，并将它作为头文件包含在你的 starter.c 和 app.c C 文件中。

如果您必须独立编译它们，您可以继续使用共享内存。如果您将结构加载到共享内存中，那么您的两个进程都可以毫无问题地访问它们！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T01:47:36.360

不知道你用的是什么平台。

如果是linux的话。您可以使用[mmap](http://www.kernel.org/doc/man-pages/online/pages/man2/mmap.2.html)。

[首先使用shm_open](http://www.kernel.org/doc/man-pages/online/pages/man3/shm_open.3.html)创建共享内存映射文件。

然后将其映射到您创建的每个可执行文件中。

向/从共享内存写入/读取您的结构。

您的所有进程都可以访问相同的共享内存。

您可能需要找到一些 mmap 教程。

# c# - 使用 MVVM 将 URL 加载到 WebBrowser

> ID：14553680
> 
> 赞同：2
> 
> 时间：2013-01-27T23:53:32.933
> 
> 标签：c#, windows-phone-7, mvvm

我正在制作一个应用程序，您在底部有一个列表框，上面有不同网站的徽标，`WebBrowser`顶部有一个。这个想法是，当您按下徽标时，webBrowser 会加载相应的页面。我已经完成了这项工作，但我想用 MVVM 重新制作应用程序以使其更好。`WebBrowser`我已经制作了包含所有徽标的列表框，但是当我单击徽标时，我不知道如何将 URL 加载到列表框上。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-28T00:57:08.020

不是 100% 确定这是否适用于 Phone7，但值得一试……

拳头`WebBrowser`Source 属性不可绑定，因为它不是 a `DependancyProperty`，因此您必须创建一个帮助器类来创建`AttachedProperty`帮助绑定。

然后，您可以使用包含来自您的 ListBoxItem 的实际链接的属性将您链接`ListBox` `SelectedItem`到新属性。`LinkSource`

例子：

xml:

```
<Window x:Class="WpfApplication8.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WpfApplication8"
        Title="MainWindow" Height="233" Width="405" Name="UI">

    <StackPanel Orientation="Horizontal" DataContext="{Binding ElementName=UI}">
        <ListBox x:Name="listbox" ItemsSource="{Binding Links}" Width="100" DisplayMemberPath="Name"/>
        <WebBrowser local:WebBrowserHelper.LinkSource="{Binding ElementName=listbox, Path=SelectedItem.Site}" Width="200"/>
    </StackPanel>

</Window> 
```

代码：

```
public partial class MainWindow : Window
{
    private ObservableCollection<Link> _links = new ObservableCollection<Link>();

    public MainWindow()
    {
        InitializeComponent();
        Links.Add(new Link { Name = "StackOverflow", Site = new Uri("http://stackoverflow.com/") });
        Links.Add(new Link { Name = "Google", Site = new Uri("http://www.google.com/") });
    }

    public ObservableCollection<Link> Links
    {
        get { return _links; }
        set { _links = value; }
    }
}

// ListBox item
public class Link
{
    public string Name { get; set; }
    public Uri Site { get; set; }
}

// helper calss to create AttachedProperty
public static class WebBrowserHelper
{
    public static readonly DependencyProperty LinkSourceProperty =
        DependencyProperty.RegisterAttached("LinkSource", typeof(string), typeof(WebBrowserHelper), new UIPropertyMetadata(null, LinkSourcePropertyChanged));

    public static string GetLinkSource(DependencyObject obj)
    {
        return (string)obj.GetValue(LinkSourceProperty);
    }

    public static void SetLinkSource(DependencyObject obj, string value)
    {
        obj.SetValue(LinkSourceProperty, value);
    }

    // When link changed navigate to site.
    public static void LinkSourcePropertyChanged(DependencyObject o, DependencyPropertyChangedEventArgs e)
    {
        var browser = o as WebBrowser;
        if (browser != null)
        {
            string uri = e.NewValue as string;
            browser.Source = uri != null ? new Uri(uri) : null;
        }
    }

} 
```

结果：

![在此处输入图像描述](../Images/b34d3cd78ac0ad10be42e13e3ceb881c.png)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-28T00:19:55.490

你的问题实际上是两个问题。

1.  有几种方法可以从列表框中获取点击。最基本的一个是`<Listbox SelectedItem="{Binding selectedItem,mode=TwoWay}" ...`

2.  要设置 Web 浏览器的 URL，您可以在 VM 中实现 INotifyPropertyChanged，`public Uri browserUri { get; private set; }`在 WM 中声明，确保在更改属性时引发 PropertyChanged，在 XAML 中`<WebBrowser Source="{Binding browserUri}" />`

# php - Php 分页 - 如何在后续页面中继续编号

> ID：14553681
> 
> 赞同：0
> 
> 时间：2013-01-27T23:53:39.713
> 
> 标签：php, paging

在我的分页代码中，我每页列出 5 个建筑物，并将它们从 1 到 5 编号，

```
<?php
$page = intval($_GET['page']);
if(!$page) $page = 1;
$totalno=mysql_num_rows(mysql_query("SELECT M1_ID FROM M1Buildings WHERE M1_Cat2 BETWEEN 3 AND 4 && M1_Status=5"));
$limit = 5;
$show = $page * $limit - $limit;
$buildinglist = mysql_query("SELECT * FROM M1Buildings  WHERE M1_Cat2 BETWEEN 3 AND 4 && M1_Status=5 ORDER BY M1_Height DESC LIMIT $show,$limit",$con);
$firstrowno=1;//This will be 1 for page 1, 6 for page 2, 11 for page 3 etc..
?> 
```

一些html代码在这里，然后：

```
<?php
$startno=1;//This is the number of each row, starting from 1
while ($rowblist = mysql_fetch_array ($buildinglist))
{
echo '<tr>
        <td>'.$startno.'</td>
<td>Some information here</td>
<td>Some information here</td>
    </tr>';
    $startno++;
    $firstrowno+5;
}
?> 
```

第一页没有问题，但是当我传递到第2页时，它又从1开始，但我希望它从6开始，我不知道如何实现它。我进行了搜索，但没有结果。实际上，我的英语有限，我猜我不知道如何用适当的词搜索它。感谢您的理解！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T00:06:42.720

您需要更新查询以使用偏移量。(** 抱歉，没有注意到您使用的是速记 **)

我花了一点时间来了解问题的要点。使用：$startno = $show + 1；

而不是： $firstrowno= 1;

在 HTML 之后：

```
<?php
while ($rowblist = mysql_fetch_array ($buildinglist))
{
echo '<tr>
        <td>'.$startno.'</td>
<td>Some information here</td>
<td>Some information here</td>
    </tr>';
    $startno++;
}
?> 
```

变量在访问服务器之间不会保留它们的状态。（除非您存储它们并从会话中检索它们。

# django - Django中的跨站点请求伪造保护-更好的解释？

> ID：14553691
> 
> 赞同：1
> 
> 时间：2013-01-27T23:55:01.417
> 
> 标签：django, csrf

我刚刚完成了 Django 1.4 教程的第 4 部分，我敢肯定他们只是把 CSRF 和通用视图扔进去，把我搞糊涂了。

好的，我现在得到的通用视图，但我不明白 CSRF 保护发生了什么。

这就是我认为正在发生的事情：CSRF 令牌是由应用程序中使用的模块生成的哈希/密钥，如果已登录，则为登录用户。令牌以某种方式通过 POST 方法表单发送到接收视图，该视图再次生成散列并将其与随表单发送的进行比较以确保没有人窥探？我完全错了吗？

在教程中使用了 Django 手册的其余部分，这是迄今为止我读过的最令人困惑的手册页。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T00:07:04.497

这很令人困惑，因为它解决了 Web 浏览器的一个微妙漏洞。

假设我们有两个站点：site.com 和 evil.com。然后 evil.com 的所有者，如果他知道 site.com 网站的结构（如果他会使用，这很容易），就可以设置一个针对它的表单。

```
<form action="http://target.com/my_account/_delete" method="POST">
    <input type="submit" value="Click Here for candy"></input>
</form> 
```

任何点击它并登录到 site.com 的人都会立即触发链接到的操作（在这种情况下，销毁他们自己的帐户）。

csrf 令牌的想法是合法形式如下所示：

```
<form action="http://target.com/my_account/_delete" method="POST">
    <input type="hidden" name="csrf_token" value="AEyaF8af8AIHJFA0L"></input>
    <input type="submit" value="Don't click this unless absolutely sure!"></input>
</form> 
```

并且因为这个值是用户特定的，并且只有网站知道并显示在网站上，所以用户现在是安全的，并且不能在没有先通过正确页面的情况下删除他们的帐户，因为攻击者的任何页面都不会知道这个值.

希望这更清楚。

# c# - 多线程 4 层混合生产者消费者模式 - 线程不正确交替

> ID：14553699
> 
> 赞同：1
> 
> 时间：2013-01-27T23:56:54.720
> 
> 标签：c#, multithreading, producer-consumer, levels, mixed

这是我试图建模的问题：我有一个呼入呼叫中心（没有呼出电话）。有 3 个员工级别 - 应届生、技术主管、项目经理。在我们的呼叫中心，只有一名 TL、一名 PM 和多名应届生。Freshers 无法处理的呼叫会升级到 TL，TL 无法处理的呼叫会升级到 PM。

我需要采用 OO C# 方法。

这是我目前的尝试：我使用 C# ConcurrentQueue 因为我认为它会处理“锁”。我想要呼叫中心的 FIFO。我为每个级别做了一个队列。

我有一个生产者（调用者）将调用添加到第一个队列。混合产品/消费者新生检查电话（接听或升级到下一个队列）。混合产品/消费者 tl，然后是纯消费者项目经理。

输出不是我所期望的。只有第一个新人运行，项目经理根本不运行。随着呼叫被添加到队列中，我预计会有更多的交替。

我的代码如下。有没有人有更好的方法来解决这个问题或者我的代码有问题？

CallCenter 类是大部分操作发生的地方。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;
using System.Collections.Concurrent;
namespace CallCenterThreaded
{
/// <summary>
/// 
/// MIXED CONSUMER/PRODUCER TYPE
/// </summary>
class Fresher
{
    // add a class variable for the number of Employee objects instantiated
    private static int fresherNum = 0;
    private int fresherId;
    private ConcurrentQueue<Call> incommingCalls;
    private ConcurrentQueue<Call> outgoingCalls;

    public Fresher(ConcurrentQueue<Call> calls, ConcurrentQueue<Call> outcalls)
    {
        fresherId = ++fresherNum;
        incommingCalls = calls;
        outgoingCalls = outcalls;
        //start the producer thread
        Thread thread = new Thread(new ThreadStart(HandleCalls));
        thread.Start();
    }

    public int ID
    {
        get { return fresherId; }
    }

    /// <summary>
    /// 
    /// </summary>
    public void HandleCalls() 
    {

        while (incommingCalls.Count > 0)
        {

            Call call;
            incommingCalls.TryDequeue(out call);

            if (call != null)
            {
                if (call.EscalationLevel == 0)
                {
                    TakeCalls(call);
                }
                else 
                {
                    TransferCalls(call);
                }
            }

        }

    }

    /// <summary>
    /// Transfer to the TL
    /// </summary>
    public void TransferCalls(Call call)
    {
        outgoingCalls.Enqueue(call);
        Console.WriteLine(".......Fresher {0} escalated call {1}", ID, call.CallID);
    }

    /// <summary>
    /// Consume the calls
    /// </summary>
    public void TakeCalls(Call call)
    {
        Console.WriteLine("Fresher {0} handled call {1}", ID, call.CallID);
    }

}
}
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Text;
    using System.Threading;
    using System.Collections.Concurrent;
   namespace CallCenterThreaded
    {
    /// <summary>
    /// MIXED CONSUMER/PRODUCER TYPE
    /// </summary>
    class TechnicalLead
    {

    // add a class variable for the number of Employee objects instantiated
    private static int tlNum = 0;
    private int tlId;

    private ConcurrentQueue<Call> incommingCalls;
    private ConcurrentQueue<Call> outgoingCalls;

    public TechnicalLead(ConcurrentQueue<Call> calls, ConcurrentQueue<Call> outcalls)
    {
        tlId = ++tlNum;
        incommingCalls = calls;
        outgoingCalls = outcalls;
        //start the producer thread
        Thread thread = new Thread(new ThreadStart(HandleCalls));
        thread.Start();
    }

    public int ID
    {
        get { return tlId; }
    }

    /// <summary>
    /// 
    /// </summary>
    public void HandleCalls() 
    {

        while (incommingCalls.Count > 0)
        {

            Call call;
            incommingCalls.TryDequeue(out call);

            if (call != null)
            {
                if (call.EscalationLevel == 1)
                {
                    TakeCalls(call);
                }
                else 
                {
                    TransferCalls(call);
                }
            }

        }

    }
    /// <summary>
    /// Transfer to the PM
    /// </summary>
    public void TransferCalls(Call call)
    {
        //Console.WriteLine(".......Technical Lead {0} escalated call {1}", ID, call.CallID);
        outgoingCalls.Enqueue(call);           
    }

    /// <summary>
    /// Consume the calls
    /// </summary>
    public void TakeCalls(Call call)
    {
        Console.WriteLine("Technical Lead {0} handled call {1}", ID, call.CallID);
    }
}
}
    using System;
   using System.Collections.Generic;
 using System.Linq;
 using System.Text;
   namespace CallCenterThreaded
   {
class Call
{
    private static int numberCalls = 0;
    private int callno;

    private int esclataion;

    public Call() 
    {
        callno = ++numberCalls;
        esclataion = 0;
        if(callno % 3 == 0)
        {
            esclataion = 1;
        }
        if(callno % 5 == 0)
        {
            esclataion = 2;
        }

    }

    public int CallID { get { return callno; } }
    public int EscalationLevel { get { return esclataion; } }
}
}
 using System;
 using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;
using System.Collections.Concurrent;
namespace CallCenterThreaded
{
/// <summary>
/// 
/// </summary>
class CallCenter
{

    private ConcurrentQueue<Call> fresherCalls;
    private ConcurrentQueue<Call> tlCalls;
    private ConcurrentQueue<Call> pmCalls;

    private List<Caller> myCallers;
    private List<Fresher> myFreshers;

    private TechnicalLead tl;
    private ProjectManager pm;

    public CallCenter() 
    {
        //initial incomming calls to the fresher queue
        fresherCalls = new ConcurrentQueue<Call>();
        tlCalls = new ConcurrentQueue<Call>();
        pmCalls = new ConcurrentQueue<Call>();

        myFreshers = new List<Fresher>();
        myCallers = new List<Caller>();

        generate_callers();
        generate_freshers();

        tl = new TechnicalLead(tlCalls, pmCalls);
        pm = new ProjectManager(pmCalls);
    }

    /// <summary>
    /// 
    /// </summary>
    private void generate_freshers() 
    {
        for (int i = 0; i < 5; i++ )
        {
            myFreshers.Add(new Fresher(fresherCalls, tlCalls));
        }
    }

    /// <summary>
    /// 
    /// </summary>
    private void generate_callers() 
    {
        for (int i = 0; i < 5; i++ )
        {
            myCallers.Add(new Caller(fresherCalls));
        }
    }

   }
}
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;
using System.Collections.Concurrent;
namespace CallCenterThreaded
{
/// <summary>
/// PURE CONSUMER
/// </summary>
class ProjectManager
{

     // add a class variable for the number of Employee objects instantiated
    private static int pmNum = 0;
    private int pmId;

    private ConcurrentQueue<Call> incommingCalls;

    public ProjectManager(ConcurrentQueue<Call> calls)
    {
        pmId = ++pmNum;
        incommingCalls = calls;

        //start the producer thread
        Thread thread = new Thread(new ThreadStart(HandleCalls));
        thread.Start();
    }

    public int ID
    {
        get { return pmId; }
    }

    /// <summary>
    /// 
    /// </summary>
    public void HandleCalls() 
    {

        while (incommingCalls.Count > 0)
        {

            Call call;
            incommingCalls.TryDequeue(out call);

            if (call != null && call.EscalationLevel == 2)
            {
                TakeCalls(call); 
            }

        }

    }
    /// <summary>
    /// Consume the calls
    /// </summary>
    public void TakeCalls(Call call)
    {
        Console.WriteLine("Project Manager {0} handled call {1}", ID, call.CallID);
    }
}
}
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;
using System.Collections.Concurrent;
namespace CallCenterThreaded
{
class MainClass
{
    static void Main(string[] args)
    {

        CallCenter myCenter = new CallCenter();

        Console.ReadLine();
    }
}
}
    using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Collections.Concurrent;
using System.Threading;
namespace CallCenterThreaded
{
/// <summary>
/// This is a producer. It produces calls and adds them to the queue.
/// PURE PRODUCER TYPE
/// </summary>
class Caller
{

    private ConcurrentQueue<Call> incommingCalls;

    public Caller(ConcurrentQueue<Call> calls)
    {
        incommingCalls = calls;
        //start the producer thread
        Thread thread = new Thread(new ThreadStart(placeCalls));
        thread.Start();
    }

    public void placeCalls()
    {

        //place 10 calls
        for (int callno = 0; callno < 4; callno++)
        {
            //Console.WriteLine("Call {0} was added to the queue", callno);
            incommingCalls.Enqueue(new Call());
        }

    }

}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T00:45:20.083

问题出在`HandleCalls()`方法上：

```
public void HandleCalls() 
{
    while (incommingCalls.Count > 0)
    {
        …
    }
} 
```

这段代码的作用是检查`incomingCalls`，如果没有，它会立即退出线程。就好像工人来上班，看了看他的电话队列，什么也没找到（因为他和应该转接电话的新生同时上班），所以他离开回家了。

你需要做的是等待如果此刻没有工作。可能最好的方法是使用[`BlockingCollection`](http://msdn.microsoft.com/en-us/library/dd267312.aspx)而不是`ConcurrentQueue`.

此外，您的设计似乎并不那么好。例如，有很多重复的代码。

# c# - 以编程方式设置 VerticalScrollingOffset

> ID：14553702
> 
> 赞同：1
> 
> 时间：2013-01-27T23:57:10.607
> 
> 标签：c#, winforms, scrollbar

我正在使用自定义滚动条，我现在面临的问题是，当我在数据网格中有数千行并一直滚动到底部时，`dataGrid.VerticalScrollingOffset`大约 + 400 高谢谢`customScrollbar.Value`。最后 dataGrid 现在显示最后几条记录，因为它没有向下滚动。

如果我可以设置`dataGrid.VerticalScrollingOffset`值或获取dataGrid的最大垂直滚动值，那将是完美的，我找不到任何关于下界的信息。

目前我正在计算最大值，例如`rowCount*rowHeight`，它没有给出确切的最大值，因此它没有一直向下滚动。有什么建议么？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T00:00:59.883

您可以使用 [ `FirstDisplayedScrollingRowIndex`][1]：

```
// To Scroll down
this.FirstDisplayedScrollingRowIndex = this.FirstDisplayedScrollingRowIndex + 1; 
```

如果您想要每像素增量，请将其放在`DataGridView`属性设置为 的中。`Panel``AutoScroll``true`

# c++ - c++ 将字符串转换为空指针

> ID：14553703
> 
> 赞同：14
> 
> 时间：2013-01-27T23:57:22.117
> 
> 标签：c++, string, casting, void, void-pointers

我使用具有回调函数的库，其中一个参数是 type `void *`。（我想让发送任何类型的值。）

我需要传递一个字符串（`std::string`或 a`char[]`相同）。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-28T00:12:52.637

如果您确定对象在函数的生命周期内是活动的（并且可以修改），则可以对字符串指针进行强制转换，将其转回回调中的引用：

```
#include <iostream>
#include <string>

void Callback(void *data) {
    std::string &s = *(static_cast<std::string*>(data));
    std::cout << s;
}

int main() {
    std::string s("Hello, Callback!");
    Callback( static_cast<void*>(&s) );
    return 0;
} 
```

输出是`Hello, Callback!`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-27T23:59:50.267

如果你有一个 char 数组，那么它可以隐式转换为 void 指针。如果你有一个 C++ 字符串，你可以获取第一个元素的地址：

```
void f(void *);   // example

#include <string>

int main()
{
    char a[] = "Hello";
    std::string s = "World";

    f(a);
    f(&s[0]);
} 
```

确保`std::string`函数调用表达式的寿命更长。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-28T00:08:17.147

**如果它是您提供**的回调函数，那么您可以简单地传递`std::string`对象的地址

```
void f(void* v_str)
{
  std::string* str = static_cast<std::string*>(v_str);
  // Use it
}
...
...
std::string* str = new std::string("parameter");
register_callback(&f, str); 
```

无论哪种方式，就像 Kerrek SB 所说，确保字符串对象的生命周期至少与使用回调的时间跨度一样长。

# algorithm - 关于加密的问题

> ID：14553710
> 
> 赞同：-4
> 
> 时间：2013-01-27T23:58:10.713
> 
> 标签：algorithm, encryption, cryptography, primes, cracking

我打算重新发明轮子。我通过例子学到了很多东西。这是您在回答时应该考虑的重要信息。 **这不是家庭作业，它纯粹是一个业余项目。**

现在，我听说过模数数学。我试图用它来制作一个不可破解的（按照今天的技术标准）。

我有不止一个问题：

1.  如何让加密更难破解（非对称）
2.  随机数或模式（例如，有一套标准，不是随机的），为什么或为什么不。
3.  这个公式是否易受攻击：

> a = (未知素数)
> 
> b =（未知素数）
> 
> c =（未知素数）
> 
> d = (a ^ b) 模 c

如果 d = 9，你能得到 a、b 和 c 吗？不要蛮力它，而是实际上制定一个公式来扭转它。如果可以，请发布。

这是制作钥匙、种子或类似性质的东西的好方法吗？为什么或者为什么不？

无论如何，回答你所理解的，最好的答案会被标记为如此，而且是公平的！

另外，如果可以的话，请给我参考密码学文本（免费）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T01:35:23.150

这是一个广泛的问题。正如*templatetypedef*所提到的，您不应该设计任何计划在现实世界中使用的密码学相关算法，因此您可能想忘记“尝试使用它来制作不可破解的 [cipher]”并将其留给专家。

回答您的问题：

1- 一般的理解是，如果你想让消息更难“破解”，你增加密钥大小。当有经过验证的真正算法时，开发一个全新的（并且肯定是弱的）密码是没有意义的。

2-很难说出这里问的是什么，但我假设您指的是给定密文的随机性。一般的理解是，密文的*任何*一种模式（非随机性）都是一个**非常糟糕的信号**。密文应该与纯随机数据无法区分，并且有几组测试可以检查（参见[ENT](http://www.fourmilab.ch/random/)、[Diehard](http://www.stat.fsu.edu/pub/diehard/)和[许多其他人](http://www.mandala.co.uk/links/random/)）

3-您给出的公式接近[RSA](https://en.wikipedia.org/wiki/RSA_%28algorithm%29)中使用的公式，尽管 a,b,c 不是直接的素数。此外，尚不清楚您的哪个变量是明文（提示：只能加密素数的密码并不是特别有用）。AFAICT，正如您所说，它也是不可逆的（这根本不是一件好事，除非您不打算**解密**这些消息......）

最后一点，您正在寻找**密码学**参考，而不是**密码**学参考。许多人将密码学与经典（且易于破解）密码联系在一起，例如[凯撒的](https://en.wikipedia.org/wiki/Caesar_cipher). [Bruce Schneier 的应用密码学](http://www.schneier.com/book-applied.html)是该主题的标准教科书。它不是免费的，但您可以随时尝试大学图书馆。

# java - 为什么 .length() 不是 Java 中数组的方法？

> ID：14553713
> 
> 赞同：6
> 
> 时间：2013-01-27T23:58:32.480
> 
> 标签：java, arrays, methods

> **可能重复：**
> [Java - 数组的长度属性](https://stackoverflow.com/questions/9297899/java-arrays-length-property)
> [String.length() 与 Array.length](https://stackoverflow.com/questions/12082196/string-length-vs-array-length)

我目前在高中的 AP 计算机科学课上，我在阅读中遇到了这个问题。

据我了解，`.length()`是一种用于字符串的方法，但是为什么`.length()`在应用于数组时不是一种方法？我知道它们是不同的对象，但为什么 Java 不只是另一种方法来查找数组的长度呢？

我很感激我得到的任何回应。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-28T00:03:30.190

由于数组是在实例化时定义的固定长度，因此长度是类上的公共最终字段。无需将其设为方法，因为在运行时无需进行计算。

有关详细信息，请参阅 Java 规范的这一部分：http: [//docs.oracle.com/javase/specs/jls/se7/html/jls-10.html#jls-10.7](http://docs.oracle.com/javase/specs/jls/se7/html/jls-10.html#jls-10.7)

现在，关于为什么他们没有提供获取值的访问器方法的设计问题没有指定。也许这是在设置任何其他约定之前完成的，这只是一个遗留问题。只有语言设计者会知道他们决定这样做的“为什么”部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-28T00:01:22.667

数组在[Java 语言规范 #10.7](http://docs.oracle.com/javase/specs/jls/se7/html/jls-10.html#jls-10.7)中定义。尤其：

> 数组类型的成员全部如下：
> 
> *   公共最终字段长度，其中包含数组的组件数。长度可以是正数或零。
> *   [...]

我无法回答为什么语言设计者选择了这种方法。

[有趣的是，在作为 Java 的祖先](http://en.wikipedia.org/wiki/Oak_%28programming_language%29)[的 Oak 规范](http://aioo.be/mirrored/OakSpec0.2.pdf)中已经出现了这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-28T00:00:40.877

我怀疑这是否有充分的技术原因。

我怀疑这是那些没有及早发现并在不破坏大量代码的情况下修复的小不一致之一。

# solr - 在 Windows 7 上安装 Apache Solr 4.1

> ID：14553714
> 
> 赞同：17
> 
> 时间：2013-01-27T23:58:38.013
> 
> 标签：solr

我如何在**Windows 7上****安装 apache solr 4.1 搜索服务器** 我浏览了网络，但我找不到任何有用的问题答案

 *** * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-02-12T03:33:29.560

我可以看到您不熟悉 Java Servlet，因此我会推荐一个不错的 Windows 安装程序，它不仅可以安装 SolR，还可以安装 Apache。

[http://bitnami.org/stack/solr](http://bitnami.org/stack/solr)

只需单击几下，无需更改配置，您将在几分钟内启动并运行，并显示如下漂亮的屏幕：

![在此处输入图像描述](../Images/81cd21a436fcfafc306bb4eb789a97d8.png)

顺便说一句，Bitami 不仅为您提供了一个不错的 Windows 安装程序，还为您提供了一个带有 Solr 的 VM（因此您可以在不破坏当前系统的情况下对其进行测试）以及更多安装和运行 SolR 的方法！

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-01-28T21:02:17.160

成功的六个简单步骤...

1.  确保已安装 Java
2.  下载 Solr
3.  安装并启动 Solr（它带有 Jetty 作为应用服务器）
    1.  这是一个 Java servlet，所以不要指望安装程序，只需将文件内容解压缩到`.zip`文件夹中即可
4.  使用示例和文档来学习 Solr
5.  使用您自己的架构和文档，让您自己安装 Solr
6.  如果在 Windows 7 服务器上，请将 Solr 服务器 jar 设置为在启动/重启时自动启动**

# html - 从 Safari 阅读器禁用复制和粘贴

> ID：14553717
> 
> 赞同：-1
> 
> 时间：2013-01-27T23:59:07.993
> 
> 标签：html, css, safari

我是一名网页设计师，我有一个客户，他经营着一个付费订阅博客网站，其中包含他不想复制和共享的敏感内容（因此是付费订阅）。

我最近能够成功禁用从实际网页复制内容的所有功能（使用 wordpress 插件，并且还使用 css -webkit-user-select 设置为 none 来定位某些元素）

但最近我发现，如果用户使用 Safari 的阅读器查看网页，您仍然可以复制和粘贴所有内容。无论如何，是否有禁止用户从 Reader 内部复制文本的能力？

感谢您提供任何反馈并帮助您发送我的方式！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T00:16:30.623

您可以尝试实施各种“技巧”来禁用复制。它们基本上与单击拖动以选择文本时防止默认操作有关（Google for jQuery preventDefault）。当触发动作时，您绑定一个动作，然后在事件上进行*preventDefault 。*

您也可以尝试阻止默认某些按键，例如 cmd-c 和 cmd-a

但是......当页面被传递到浏览器时，文本就在用户的机器上。所以上述所有技术都可以被规避。

在某些浏览器中，上述技巧可能不起作用。或者，聪明的用户可以打开页面源并提取文本。

您可以更进一步，将文本呈现到图像服务器端。

但是有动力的用户可能会手动重写文本......

结论：您可以使普通用户更难复制文本。完全避免是不可能的。

希望这可以帮助...

# android - 带有 4.0 的模拟器上的 Android 内置动画

> ID：14553722
> 
> 赞同：2
> 
> 时间：2013-01-27T23:59:45.237
> 
> 标签：android

当面向 V11 并使用支持库 Fragment 类构建以从 V7 及更高版本运行时，我的应用程序一直在使用 4.0 模拟器。但是现在我的目标是 V14（也是最小 SDK），我在片段过渡动画上遇到以下致命错误：

```
E/AndroidRuntime(1098): FATAL EXCEPTION: main
E/AndroidRuntime(1098): java.lang.RuntimeException: Unknown animator name: alpha
E/AndroidRuntime(1098):     at android.animation.AnimatorInflater.createAnimatorFromXml(AnimatorInflater.java:129)
E/AndroidRuntime(1098):     at android.animation.AnimatorInflater.createAnimatorFromXml(AnimatorInflater.java:93) 
```

这是指定片段事务的代码：

```
FragmentTransaction ft = mFrag.getFragmentManager().beginTransaction();
ft.setCustomAnimations(android.R.anim.fade_in, android.R.anim.fade_out,
        android.R.anim.fade_in, android.R.anim.fade_out);
ft.replace(mParentId, frag);
ft.addToBackStack(null);
ft.commit(); 
```

是否发生了一些变化，这些动画将不再被发现？是否与不使用支持库有关？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T02:32:49.290

你只需要使用`android.R.animator.fade_in`而不是`android.R.anim.fade_in`

# nginx - 使用 FastCGI 的 SSI 子请求的缓存键错误

> ID：14553726
> 
> 赞同：1
> 
> 时间：2013-01-28T00:00:37.760
> 
> 标签：nginx, ssi

当我使用 SSI 时，NGinx 对子请求使用了错误的缓存键

```
fastcgi_cache_key       "$request_method $scheme://$host$uri"; 
```

问题是，它以无限递归结束，因为在主请求上，NGinx 将包含 SSI 元素的页面存储在其缓存中，然后当它触发子请求时，使用该页面（包括 SSI 元素）作为结果的子请求（等等等等）。我认为`$uri`正是为了避免这种情况而设计的（不像`$request_uri`），但显然它不起作用。

nginx版本是1.3.8

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T21:53:05.350

稍长的调试会话（nginxs 调试日志...很大）给了我答案：它不是直接的缓存键，但默认情况下`REQUEST_URI`设置为`$request_uri`in `/etc/nginx/fastcgi_params`。缓存键是正确的，但请求始终与父页面相同，因此父页面被缓存了两次：一次用于 parent-uri-key，一次用于 ssi-subrequest。在每次后续调用中，都会使用（损坏的）缓存值。

```
fastcgi_param REQUEST_URI $uri; 
```

# c# - 重定向到具有复杂模型的动作作为具有字符串属性数组的参数

> ID：14553727
> 
> 赞同：2
> 
> 时间：2013-01-28T00:00:40.373
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3

我遇到了一个问题，我有谷歌，但我没有找到解决方法。

我有这两个动作

```
 public ActionResult ActionA(DTOA dtoA)
    {
       .....
    }

    [HttpPost]
    public ActionResult ActionB(DTOB dtoB)
    {
        DTOA dto = new DTOA();
        dto.ArraOfStringA = dtoB.ArraOfStringB;
        dto.Id = dtoB.Id;

        return RedirectToAction("ActionA", dto);
    } 
```

模型

```
public class DTOA
{
    public int Id{get;set;}
    public string[] ArraOfStringA { get; set; }

}

public class DTOB
{
    public int Id{get;set;}
    public string[] ArraOfStringB { get; set; }

} 
```

所以情况是

当我发布到 ActionB 时，dtoB 参数的字符串数组填充了 2 个元素。“1”和“2”

但是当这个动作重定向到ActionA 时，dtoA 参数填充了1 个itens。“系统。字符串 []”。

如果我在浏览器中输入“domain/controler/ActionA?ArraOfStringA=1&ArraOfStringA=2”

dtoA 参数填充了两个项。“1”和“2”（预期行为）

那么，如何重定向到 ActionA 传递具有数组 os 字符串属性的复杂模型？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-28T00:09:06.147

如果模型很复杂，您可能需要考虑`TempData`在两个操作之间传输时使用来存储模型，而不是使用路由参数。

```
public ActionResult ActionA()
{
   var dto = TempData["model"] as DTOA;

   ...
}

[HttpPost]
public ActionResult ActionB(DTOB dtoB)
{
    DTOA dto = new DTOA();
    dto.ArraOfStringA = dtoB.ArraOfStringB;
    dto.Id = dtoB.Id;

    TempData["model"] = dto;

    return RedirectToAction("ActionA");
} 
```

# css - 停止固定定位的标题以重叠导航栏

> ID：14553730
> 
> 赞同：0
> 
> 时间：2013-01-28T00:00:46.600
> 
> 标签：css, scroll, css-position

我有这样的事情：

```
<div id="navigation"></div>
<div id="header"></div>
<div id="content"></div> 
```

有`#header`，`"position:fixed; top: 0;"`我需要它是这种方式，除非`#navigation`可见（不滚动），在这种情况下，`#header`应该在`#navigation`.

这可以用纯css完成吗？
或者任何干净的JS解决方案？

这是[jsfiddle](http://jsfiddle.net/pomber/v6H4Z/)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T00:23:15.610

听起来像是 jQuery Waypoints 插件的工作：http: [//imakewebthings.com/jquery-waypoints/](http://imakewebthings.com/jquery-waypoints/)

使用[粘性元素快捷方式](http://imakewebthings.com/jquery-waypoints/shortcuts/sticky-elements/)：

只需添加

```
$(document).ready(function() {
    $('#header').waypoint('sticky');
}) 
```

和卡住元素的样式

```
#header.stuck {
    position: fixed;
    top: 0;
} 
```

这是[更新的小提琴](http://jsfiddle.net/pomber/v6H4Z/5/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T00:27:14.843

这是一个使用 jQuery 的解决方案。

[更新了 JSFiddle](http://jsfiddle.net/v6H4Z/4/)

```
//Checks if navigation is visible and sets position of header accordingly
function headerPosition(){
    if($('#navigation').is(':visible')){
        $('#header').css('position', 'static');
    }
    else{
        $('#header').css('position', 'fixed');
    }
}

//Run function to set correct header position
headerPosition();

//Show/Hide navigation to see function in action - not needed for production
$('button').on('click', function(){
   $('#navigation').toggle();
   headerPosition();
}); 
```

# c++ - 如何从计算机内存中读取第三方应用程序的聊天/日志

> ID：14553735
> 
> 赞同：0
> 
> 时间：2013-01-28T00:01:34.290
> 
> 标签：c++, memory

想象一个 3rd 方应用程序（游戏），比如farmville 或发生事情的地方，它会吐出诸如“你的农场需要 XYZ”之类的文本。因为它在我的电脑上，我知道文本一定在我电脑内存的某个地方。我希望能够从我的计算机内存中访问该文本信息，以便可以将其用作脚本的输入。

如何实时搜索我的计算机内存以查找该文本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T00:07:46.547

实际上有一个非常好的教程关于如何做到这一点，但是它被从网上删除了。幸运的是，[Wayback Machine 有它的存档副本](http://web.archive.org/web/20110613060052/www.codingthewheel.com/archives/how-i-built-a-working-poker-bot)。

[这是一个指向](http://web.archive.org/web/20110903010711/www.codingthewheel.com/tags/poker%20bot)标签页面的链接，可以让您进入文章的其他部分，我相信有 8 个部分，但该标签页面上也有其他相关页面。

# ios - ios 和evernote：我怎么知道哪个 Createnote 失败了？

> ID：14553738
> 
> 赞同：1
> 
> 时间：2013-01-28T00:01:55.427
> 
> 标签：ios, evernote

我在 iOS 上使用 Evernote sdk，效果很好。

但有时我会连续发送几个 CreateNote 方法，并且由于 Evernote 异步发送它们，如果其中一个出错，我不能说是哪一个......

CreateNote 方法成功时返回 Note 对象，失败时返回 NSError。而这个并没有说明它是哪个查询。

我如何知道哪些笔记创建失败？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T18:09:34.770

Evernote SDK 确实异步发送请求，但它总是一次一个请求。因此，如果请求失败，它始终是您发出的最后一个请求。

# android - 从 LocationManger Android GPS 中删除监听器

> ID：14553745
> 
> 赞同：0
> 
> 时间：2013-01-28T00:03:05.893
> 
> 标签：android, gps

基本上，当 GPS 找不到信号时，我试图阻止它扫描，这有一些 SO，但不是特别针对我想要做的。

我在服务中设置了以下内容。

```
private void grabsensor() {
    this.locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
    locationManager.removeUpdates(this);
    List<String> enabledProviders = this.locationManager.getProviders(true);

    for (String provider:enabledProviders){
        this.locationManager.requestLocationUpdates(provider, 5000, 0, this);
    }
} 
```

我正在尝试设计我的应用程序，以便当它以小于 30 米的精度读取网络时，它不会扫描 GPS，因为在我的用例中，用户在建筑物内，这是我的方式节省电池。

所以我尝试执行以下操作：

```
 // Smart location handling algorithm
    if ((int) location.getAccuracy() < 30) {
        this.locationManager.removeUpdates(this);
    } 
```

除了这将删除所有提供者之外，我只想删除 GPS 提供者，然后下次调用它时，它将检查相同的 if 语句，如果它是错误的，它将添加 GPS 提供者。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T00:31:04.190

您可以为每种提供程序类型创建新的侦听器实例。根据文档，没有任何方法可以检查侦听器是否已注册。

```
class MyLocationListener implements LocationListener {
    //..
}

private LocationListener locationListenerGPS = new MyLocationListener();

private LocationListener locationListenerOther = new MyLocationListener();

private void grabsensor() {
    this.locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
    locationManager.removeUpdates(this);
    List<String> enabledProviders = this.locationManager.getProviders(true);

    for (String provider:enabledProviders) {
        if (provider == LocationManager.GPS_PROVIDER)
            this.locationManager.requestLocationUpdates(provider, 5000, 0, locationListenerGPS);
        else
            this.locationManager.requestLocationUpdates(provider, 5000, 0, locationListenerOther);
    }
}

private void removeGPSListener() {
    if ((int) location.getAccuracy() < 30) {
        this.locationManager.removeUpdates(locationListenerGPS);
    }
} 
```

# ios - IOS 图像未在图像视图中设置

> ID：14553746
> 
> 赞同：1
> 
> 时间：2013-01-28T00:03:06.143
> 
> 标签：ios, uiimageview, tablecell

我在我的两个视图控制器中使用了相同的代码（它们实现了相同的类，它们下载的 url 发生了变化），并且在一种情况下，图像正确显示，而在另一种情况下，我确实看到了一个空单元格。

这是我的代码：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *simpleTableIdentifier=@"MyCell";
    //this is the identifier of the custom cell
    MyCell *cell = (MyCell *)[tableView dequeueReusableCellWithIdentifier:simpleTableIdentifier];

    tableView.backgroundColor=[UIColor clearColor];
    tableView.opaque=NO;
    tableView.backgroundView=nil;

    if (cell == nil)
    {
        NSArray *nib = [[NSBundle mainBundle] loadNibNamed:@"MyCell" owner:self options:nil];
        cell = [nib objectAtIndex:0];
    }
    NSLog(@"Image url is:%@",[images_url objectAtIndex:indexPath.row]);
    NSURL *url_image=[NSURL URLWithString:[images_url objectAtIndex:indexPath.row]];

    cell.myimage.image=[UIImage imageWithData:[NSData dataWithContentsOfURL:url_image]];

    return cell;
} 
```

正如我告诉你的，我有 2 个视图控制器实现了同一个类。在确实加载的视图中，url 是根据标志的值设置的。如果我打开控制器 A，我看不到图像，如果我打开视图 B，我可以看到图像。这两个网址都是正确的，因为我可以使用我插入的 NSLog 检查它。

可能是什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T00:37:38.573

不幸的是，调用“NSData dataWithContentsOfURL”是一个阻塞调用。程序的执行将停止，直到 iOS 能够从服务器获取所有数据或尝试失败。如果您使用的是 LTE 或 WiFi，这通常可能“很快”；但可能需要很长时间。

同时，你在你的应用程序的“主线程”上——所以你的应用程序会出现冻结，系统的看门狗定时器可能会杀死你的应用程序。如果除您之外的任何人都将使用此应用程序，您绝对需要使用立即检索的本地数据或使用异步方法填充您的 tableview 单元格的图像。

只是谷歌“延迟加载 UIImage”。这个 SO question 有一些关于这个主题的好技巧： [lazy-load-images-in-uitableview](https://stackoverflow.com/questions/1130089/lazy-load-images-in-uitableview)

此外，您应该将这些行移到一些设置代码中。您不需要每次都执行它们来更新单元格：

```
tableView.backgroundColor=[UIColor clearColor];
tableView.opaque=NO;
tableView.backgroundView=nil; 
```

祝你好运！

# c# - div.Visible 不在其他代码之前执行

> ID：14553751
> 
> 赞同：2
> 
> 时间：2013-01-28T00:03:46.203
> 
> 标签：c#, asp.net

我正在使用 c# 在 asp.net 中制作一个 Web 应用程序，它一次从 http Web 服务收集大量信息。由于这个数据收集过程需要 10-20 秒，我想用一个小的旋转图像显示一个小的加载框架。

为了在一个页面上实现这一点，我调用`loadingdiv`了一个 div，我将其`Visible`属性设置为`false`during `PageLoad`。当我的“查找电影”按钮被按下时，c#代码应该隐藏页面上的内容，在后端加载web服务信息时显示加载图像，然后隐藏加载图像并显示数据显示分区。

如果我注释掉从 web 服务加载数据的类，这工作正常。但是一旦我添加了我的网络服务信息，它就会完全跳过这`loadingdiv.Visible = true`条线，只进行 10-20 秒的操作。

这是相关的代码行。

```
 protected void btnFindMovies_Click(object sender, EventArgs e)
 {
    //Hides the main content that contained search options for movies
    thisarticle.Visible = false;
    articlediv.Visible = false;
    lblGenres.Visible = false;
    ratingdiv.Visible = false;
    List<int> gList = new List<int>(); //Genre List

    /* Other code that goes through checkboxes to find out which genres 
    to search for in the movie search */

    string title = "Movie Title Here"; 
    Page.Title = title;

    loadingdiv.Visible = true; //Shows loading div before completing search

    MovieSearch search = new MovieSearch(gList);  //Intensive web service use 
    (10-20 seconds)
    loadingdiv.Visible = false; //removes the loading div from the screen
} 
```

`loadingdiv`当我的 Web 服务操作正在进行时，我如何才能显示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T00:13:13.510

该方法中的所有内容都发生在向用户提供任何响应**之前。**这意味着会发生以下情况：

*   用户单击您的按钮。
*   请求被发送到服务器并发生回发。
*   在回发期间，`btnFindMovies_Click`被解雇。你设置好`Visible = true`，等待网络服务返回自己的信息再设置`Visible = false`。
*   响应提供给浏览器。

因为这都是在同一个请求上完成的，所以在所有这些完成之前不会向浏览器返回任何内容，这有效地`loadingdiv.Visible = true;`完全消除了该行。

如果您希望在某些服务器端代码向 Web 服务发出请求时显示加载 div，则必须使用 AJAX 异步进行这些调用，并使用 Javascript 相应地隐藏/显示加载 div。

下面看起来像是一个有用的 AJAX 介绍指南：

[http://www.simple-talk.com/dotnet/asp.net/ajax-basics-with-jquery-in-asp.net/](http://www.simple-talk.com/dotnet/asp.net/ajax-basics-with-jquery-in-asp.net/)

# ios - 如何生成 RSA 公钥/私钥对并使用它们在 iOS 上加密/解密 NSData？

> ID：14553752
> 
> 赞同：2
> 
> 时间：2013-01-28T00:03:52.210
> 
> 标签：ios, objective-c, cryptography, commoncrypto

这是针对我开始的一个开源项目，所以理想情况下我想使用我可以包含的其他开源作品。

对于好奇：我正在寻找使用 RSA 加密 AES 密钥。然后我将使用 AES 密钥来加密/解密用户的数据。

# scheme - 方案中的结构定义

> ID：14553755
> 
> 赞同：1
> 
> 时间：2013-01-28T00:04:04.417
> 
> 标签：scheme, racket

```
(define-struct student (first last major age))

(define student1 (make-student "David" "Smith" 'Math 19))
(define student2 (make-student"Joe" "Jones" 'Math 21))
(define student3 (make-student "Eli" "Black" 'Spanish 20))

(define (same-age? s1 s2)
  (string=? (student-age s1)
            (student-age s2))) 
```

因此，如果两个学生年龄相同，我试图将布尔值作为输出，但是当我运行它时，它说它需要一个字符串作为第一个参数，但给出了 19。问题是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T00:47:22.503

您的几个问题是相关的，您似乎在比较不同的数据类型时遇到困难，这里有一些提示：

*   比较数字时，使用`=`
*   比较字符时，使用`char=?`
*   比较符号时，使用`symbol=?`
*   比较字符串时，使用`string=?`
*   或者简单地使用`equal?`, 适用于多种类型的包罗万象的过程，只要其两个操作数的类型相同且相等，它就会返回 true

例如，以下所有比较都将返回`#t`：

```
(equal? 1 1)
(equal? 1.5 1.5)
(equal? #\a #\a)
(equal? 'x 'x)
(equal? "a" "a")
(equal? (list 1 2 3) (list 1 2 3)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T00:08:12.970

您创建学生的`age`字段是整数，而不是字符串（注意缺少双引号），然后尝试使用`string=?`函数来比较它们。您应该使用该`=`函数进行比较`age`：

```
(define-struct student (first last major age))

(define student1 (make-student "David" "Smith" 'Math 19))
(define student2 (make-student "Joe" "Jones" 'Math 21))
(define student3 (make-student "Eli" "Black" 'Spanish 20))

(define (same-age? s1 s2)
  (= (student-age s1)
     (student-age s2))) 
```

或创建学生，他们的`age`字段表示为字符串：

```
(define-struct student (first last major age))

(define student1 (make-student "David" "Smith" 'Math "19"))
(define student2 (make-student "Joe" "Jones" 'Math "21"))
(define student3 (make-student "Eli" "Black" 'Spanish "20"))

(define (same-age? s1 s2)
  (string=? (student-age s1)
            (student-age s2))) 
```

# php - 将多个变量从 jquery 传递到 php

> ID：14553756
> 
> 赞同：1
> 
> 时间：2013-01-28T00:04:09.357
> 
> 标签：php, jquery, ajax, html, css

希望到目前为止每个人都在享受他们的一天编码：D。我对 JQUERY 比较陌生，AJAX 一直在努力寻找自己的出路，不过我已经到了那里。然而，我有一个小问题。我有使用 PHP 从 MYSQL 数据库生成的 HTML 内容（因此复选框的值不同）；这是我正在为我的网站开发的一个简单的内部消息传递程序。我有一个复选框，我可以单击它来选择页面上的所有其他复选框。但是我希望实现的是，当用户选择特定数量的复选框甚至几个复选框时，然后按下图片然后调用我的 php 文件，该文件将负责删除用户检查的消息。这个先前的问题有很大帮助：[如何将 jQuery 变量传递给 PHP 变量？](https://stackoverflow.com/questions/5202070/how-to-pass-jquery-variables-to-php-variable)但我有很多复选框

HTML/JS：

```
<body>
    Check Box: <input type="checkbox" name="check" value="1">
Check Box: <input type="checkbox" name="check" value="4">
Check Box: <input type="checkbox" name="check" value="3">
Check Box: <input type="checkbox" name="check" value="4">

<img id = "delete" src="http://icons.iconarchive.com/icons/visualpharm/must-have/256/Delete-icon.png">

<script>
$("#delete").click(function () {
   $.post('sql_delete.php', 'num=' + $(this).val(), function (response) {
      alert(response);
   });
}); 
</script>
</body> 
```

PHP

```
<?php
    require 'functions/init.php';

        $messageid = "_$POST[num]";

        $sql_statement = "DELETE FROM chj_messages WHERE message_ID = $messageid";
        mysql_query($sql_statement);

?> 
```

我怀疑我可能在 JS 和 PHP 中都需要循环，但并不完全确定。欢迎您提出所有美丽的建议：D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T00:07:15.097

`$messageid = "_$POST[num]";`应该`$messageid = $_POST['num'];`

当用户单击它们时，您的代码将一一删除复选框。如果您想让用户检查尽可能多的内容，然后单击某个按钮将其删除，则需要`click`从复选框中删除该侦听器并将其绑定到提交按钮或您提到的图像。您还需要更改进行 ajax 调用的方式 - 您必须序列化所有检查的 id 并发送它。此外，PHP 代码需要反序列化该数据并对每个收到的 ID 进行 DELETE 查询。

此外，可能是最重要的，在使用任何使用 MySQL 的站点之前阅读[SQL 注入。](http://www.acunetix.com/websitesecurity/sql-injection/)并且不推荐使用 mysql_* 函数，就像它在[php.net](http://php.net/manual/en/function.mysql-db-query.php)上所说的那样，所以你最好切换到 mysqli_* 或 PDO。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T00:28:26.800

jQuery：

```
$('#your_form').submit(function() {
    $.post('sql_delete.php', $("#your_form").serialize(), function (response) {
        alert(response);
    });
    return false;
}); 
```

html:

```
<form id="your_form">
  Check Box: <input type="checkbox" name="check[]" value="1">
  Check Box: <input type="checkbox" name="check[]" value="6">
  Check Box: <input type="checkbox" name="check[]" value="8">
  Check Box: <input type="checkbox" name="check[]" value="4">
  <input type="image" src="path/to/your/image">
</form> 
```

php:

```
$messageid = $_POST['check'];
foreach($messageid as $id) {
     $sql_statement = "DELETE FROM chj_messages WHERE message_ID = $id";
      mysql_query($sql_statement);

} 
```

上面编辑的代码已经过测试。

此外，php 可能应该在没有循环的情况下完成

```
$messageid = $_POST['check']; // sql injection already discussed.
$in = implode(", ", $messageid);
$sql_statement = "DELETE FROM chj_messages WHERE message_ID IN ($in)";
mysql_query($sql_statement); 
```

# python - Mayavi - 更改对象的大小？

> ID：14553759
> 
> 赞同：1
> 
> 时间：2013-01-28T00:04:42.740
> 
> 标签：python, mayavi

我在 python 脚本中使用 Mayavi。除了我无法更改颜色条的大小和位置外，一切正常。

我生成了这样的颜色条：

```
 colorbar = mlab.colorbar(title='Frequency', orientation='vertical', label_fmt = '%.1f') 
```

我该怎么做才能改变它的大小并将它移动到场景中的不同位置？我已经在这几天了，一直无法得到任何工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-02-05T14:00:38.747

您可以像这样调整位置：

```
colorbar.scalar_bar_representation.position = [0.1, 0.9]
colorbar.scalar_bar_representation.position2 = [0.8, 0.05] 
```

干杯，

R。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-11T21:28:42.430

这可能不是最干净的解决方案，但请尝试

```
colorbar.scalar_bar_representation.proportional_resize=True 
```

之后，我可以在屏幕上拖动一个栏并调整它的大小。如果您想做一些更精致的事情，请查看 scalar_bar_representation 中的一些属性（阅读此处的源代码可能会很有帮助）。

# c - C中的Getaddrinfo问题

> ID：14553760
> 
> 赞同：1
> 
> 时间：2013-01-28T00:04:50.693
> 
> 标签：c, sockets

我正在为一个项目开发 C 语言的代理应用程序。`getaddrinfo()`当我将解析的主机名传递给它时，我遇到了一个不成功的问题。如果我对主机进行硬编码，例如“www.google.ca”，它不会出错，但是当给出 URL（来自代码接收的 GET 请求）时，它确实会产生错误（确切的错误是“未知名称或服务”）。我已经尝试在 NetBeans 中进行调试，据我所知，解析的 URL 与我硬编码的 URL 没有什么不同。下面是我正在使用的代码：

接收请求并尝试转发它的代码片段：

```
...
//Message is received in the code before this
if (get_host(message, &url) == 0)
{
//Tries to open a socket to the parsed URL. This is where the issue happens
forawrd_fd = create_forward_socket(url, "80");
}
... 
```

获取主机功能：

```
int get_host(char *request, char **host_url)
{
    char url[BUFFER_SIZE];

    if(sscanf(request, "%*s %s HTTP/1.1\r\n", url) != 1)
    {
        return -1;
    }
    else
    {
        int len = strlen(url);

        //If there is a / at the end of the URL remove it
        if(url[len-1] == '/')
        {
            printf("%c%c\n", url[len-2], url[len-1]);
            url[len-1] = '\0';
            printf("%s\n", url);
        }

        *host_url = &url;
        //If the start of the string is http:// remove it
        if(url[0] == 'h' && url[1] == 't' && url[2] == 't'&& url[3] == 'p')
        {
            *host_url += 7;
        }

        return 0;
    }
} 
```

获取文件描述符并生成 getaddrinfo 的函数

```
int create_forward_socket(char* url, const char* port)
{
    //Status variable needed for some calls
    int status, socket_fd, received_data;

    //Setup address info structs
    struct addrinfo hints;
    struct addrinfo *result, *current;

    //Initialize our hints.
    memset(&hints, 0, sizeof hints);
    //IPv4 or IPv6 we don't
    hints.ai_family = AF_UNSPEC;
    //We want a stream socket not datagram
    hints.ai_socktype = SOCK_STREAM;
    //Whatever this means (I forget but again the interwebs says...)
    hints.ai_flags = AI_PASSIVE;

    //Get a linked list of address info that we will choose from
    if ((status = getaddrinfo(url, port, &hints, &result)) != 0) //Status here is -2 when called with the parsed URL
    {
        return -1;
    }

    for (current = result; current != NULL; current = current->ai_next)
    {
        if ((socket_fd = socket(current->ai_family, current->ai_socktype, current->ai_protocol)) != -1)
        {
            if (connect(socket_fd, current->ai_addr, current->ai_addrlen) != -1)
            {
                //We found a usable socket
                break;
            }
            else
            {
                close(socket_fd);
            }
        }
    }

    if (current == NULL)
    {
        return -2;
    }
    else
    {
        return socket_fd;
    }
} 
```

任何帮助，将不胜感激。如果需要更多我的代码，请告诉我。我只包含了我认为重要的内容，因此帖子不会太长。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T00:18:32.213

我的猜测是您正在返回一个指向局部变量的指针。看，`url`是一个局部变量，并且该`*host_url = url;`行（我假设这是一个输出参数）会将它返回给调用者。但是局部变量将在函数返回时被销毁，然后，`*host_url`将指向不知名的地方。

代码调用`get_host()`如下：

```
char *host;
get_host(req, &host);
//call getaddrinfo with host 
```

但`host`不会指向`get_host`.

解决方案是调用者分配缓冲区：

```
int get_host(char *request, char *url)
{ ... } 
```

当你调用它时：

```
char host[BUFFER_SIZE];
get_host(req, host);
//call getaddrinfo with host 
```

# python - 树数据结构中的根节点操作

> ID：14553762
> 
> 赞同：2
> 
> 时间：2013-01-28T00:05:23.270
> 
> 标签：python, oop, tree, class-method, instance-method

需要一种方法来指示/强制某些方法只能在`Node`我的树数据结构的根上完成。我正在使用 Python 2.x

我有一个类 Node，我将它与另一个类 Edge 结合使用来构建树数据结构（在这种情况下，边是字母，节点是单词）。

Node 的每个实例都需要 Node 中的一些方法，例如`get_word`，它在树中向后运行以确定该 Node 表示的单词。但是其他 Node 操作，比如`load_word_into_tree`，看起来更像是一个类方法——它们在整个树上操作。此外，按照我构建该调用的方式，它只需要根节点和根节点作为其输入。如果在任何其他节点上调用它，它会完全弄乱树。

我看到两个选项：

*   创建一个实例方法，但如果在任何不是根的节点上调用它，`load_word_into_tree`则会引发错误。我倾向于这个，但似乎有些不对劲。在我看来，实例方​​法是每个实例都应该需要的方法，并且当这个方法只能用于根时，将这个方法附加到每个节点上似乎是一种浪费。

*   创建一个类方法，但将`load_word_into_tree`根节点作为 arg 传递给它。这解决了“浪费”实例方法的问题，但也似乎是对类方法概念的误用，因为它采用单个节点作为其输入。此外，我不确定`cls`对于每个类方法可用的所需变量有什么用处。

任何有关在何处以及如何实现此功能的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T00:07:02.573

创建一个`Tree`子类`Node`并在该类上添加仅树方法。

然后使您的根成为 的实例`Tree`，图形的其余部分使用`Node`实例。

# php - 切片未按预期工作

> ID：14553763
> 
> 赞同：0
> 
> 时间：2013-01-28T00:06:10.193
> 
> 标签：php

怎么来的？这有效（正确计算目录中的文件）：

```
$result = count($files[0]);
echo $result; 
```

这有效（正确获取目录中的最后（最新）文件）：

```
$finalone = end($files[0]);
echo $finalone; 
```

但这会返回单个单词“array”

```
$nfive = -5;
$lastfive = array_slice($files[0], $nfive);
echo $lastfive; 
```

我真正想做的是从该目录中**提取最后 5 个（最后一个最新的）文件。**

丹尼斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T00:10:23.613

这部分代码：

```
$nfive = -5;
$lastfive = array_slice($files[0], $nfive);
echo $lastfive; 
```

应该是这样的；注意[`print_r`](http://php.net/manual/en/function.print-r.php)：

```
$nfive = -5;
$lastfive = array_slice($files[0], $nfive);
print_r($lastfive); 
```

您已将一个数组拆分为另一个数组。因此，`echo`您解释的行为是预期的。

# python - 通过 python 脚本启动 John the Ripper

> ID：14553764
> 
> 赞同：1
> 
> 时间：2013-01-28T00:06:26.527
> 
> 标签：python, macos, security, hash, cracking

所以，是的，我一直在研究一个从 Mac 中提取密码哈希的 python 脚本。现在我想把它提升到一个新的水平，破解它。经过一些快速研究，我找到了开膛手约翰（[http://www.openwall.com/john/](http://www.openwall.com/john/)）并决定尝试使用它。（注意：我尝试过其他软件，但没有一个能够破解我的测试哈希。问题是，当我尝试启动 john the ripper 时，它失败了。（我使用的是一些自定义的 mac 1.7.3 版本，还没有尝试更新，我不想更新）当前脚本（经过大约 1 000 000 次更改和重试：

```
output__ = "1dc74ff22b199305242d62f76f6a5c5c47b4c2e3"
print output__
txt = file('john/sha1.txt','wt')
sha1textfile = "%s:%s" % (output2[0], output__)
txt.write(sha1textfile)
txt2 = file('startjohn.command', 'wt')
stjtextfile = """
#!/bin/bash
cd /hax/john
./run/john sha1.txt
"""
txt2.write(stjtextfile)
shell('chmod 777 startjohn.command')
shell('open startjohn.command') 
```

现在我得到的错误是：

```
/hax/startjohn.command ; exit;
My-MacBook:~ albertfreakman$ /hax/startjohn.command ; exit;
No password hashes loaded
logout 
```

帮我解决这个问题，让我免于精神错乱！真诚的，杜克。

一些快速说明：

1.  Output__ 是我的测试哈希，已经让提取哈希部分工作。
2.  如果您有一个使用除 John 之外的任何其他 Hashcracker 的解决方案，那就更好了！只要它可以使用单词表或蛮力。
3.  哈希是 SHA1

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:50:07.753

好的，我发现了问题，我的测试哈希没有大写字母，因此没有被开膛手约翰接受。

# java - 如何反转数组？

> ID：14553773
> 
> 赞同：-3
> 
> 时间：2013-01-28T00:07:16.323
> 
> 标签：java, arrays, reverse

我需要反转一个数组，例如将点 5 中的内容移动到 0、4 到 1、3 到 2。

```
 int size, length;

    System.out.print("how big of a list do you have: ");
    size=reader.nextInt();

    length=size-1;

    int [] array = new int [size];

    for (int count=0; count < array.length; count ++){
        System.out.println("enter a number: ");
        array [count] = reader.nextInt();
    }
    for (int count=length; count > 0; count --)
    array [(length-count)];
} 
```

}

我在 Eclipse 中执行此操作，并且在最后一行中不断出现错误，说我没有使用运算符/表达式：`array [(length-count)];`但我不知道为什么减号不起作用？或者如果我的程序可以正常工作，它没有通过构建部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T00:09:45.473

Array[(length-count)] 不起作用，因为它是一个值，它和写一样

```
 0; 
```

它不是对过程或操作的调用，所以它是一个错误。

试试这个：

```
 int temp = 0 ;
    for(int start=0, end = numbers.length -1 ; start < end; start++, end--){
        //swap numbers
        temp = array[start];
        array[start] = array[end];
        array[end] = temp;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T00:13:03.237

```
int temp = 0;
for (int i = 0; i < array.length / 2; i++)
{
    int temp = array[i];
    array[i] = array[array.length - i--];
    array[array.length - i--] = temp;
} 
```

`temp`用于使数字不会相互覆盖。把它想象成从冰箱里取食物。牛奶在水后面，你想要一些牛奶。为了得到牛奶，你取水并把它放在你的手中（`temp`将是手）。然后你把牛奶放在水所在的地方，水放在牛奶所在的地方。没有“手”，你就会失去水（掉在地板上，或者在 的情况下`temp`，失去记忆），只剩下牛奶。

# drupal - Drupal 7 - 带标题的幻灯片

> ID：14553775
> 
> 赞同：1
> 
> 时间：2013-01-28T00:07:27.717
> 
> 标签：drupal, view, slideshow, caption

我正在尝试为我正在设计的网站创建一个视图幻灯片，并拥有它，以便在每个图像上放置一个特定于图像的标题/描述。我一直在谷歌搜索一些解决方案，我唯一能找到的解决方案是在图像上方或下方放置标题，而不是在其顶部。我觉得这种事情应该有一个非常简单的解决方案，但是，我一直找不到。

首先，我想知道这是否可以通过 View Slideshow 实现，如果可以，那么如何实现。

所提供的任何信息将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T00:17:59.377

只需使用 CSS！当您考虑它时，它与视图模块无关。甚至 html 也不允许您将两个东西放在同一个地方。无论如何都不是没有CSS。

我设法在[这个网站](http://best-grenoble.fr/public/fr)上做了同样的事情（参见主页的幻灯片）。我只使用`position:relative`然后例如`top:XXXpx`和`left:XXXpx`属性将文本放置在幻灯片容器中我想要的任何位置。

如果您不熟悉这些 CSS 属性，[这里](http://www.barelyfitz.com/screencast/html-training/css/positioning/)有一个关于它如何工作的小演示。玩得开心！

# youtube-api - 响应中缺少 YouTube API V3 recordingDetails 对象

> ID：14553776
> 
> 赞同：1
> 
> 时间：2013-01-28T00:07:41.867
> 
> 标签：youtube-api

我今天从 curl 尝试了这个 YouTube API v3 调用：

[http://www.googleapis.com/youtube/v3/videos?id=ZCJgvabihQ8&key=apiKey&part=snippet,recordingDetails](http://www.googleapis.com/youtube/v3/videos?id=ZCJgvabihQ8&key=apiKey&part=snippet,recordingDetails)

其他一切都很好，但是我没有在响应json中找到recordingDetails对象：

```
{
"kind":"youtube#videoListResponse",
"etag":"\"oLweQuB9Vh7wAB9a0AIHg_K-wsM/EuRsJ-sxI3qstP1T58S5Qnb_NIg\"",
"items":[
{
    "id":"ZCJgvabihQ8",
    "kind":"youtube#video",
    "etag":"\"oLweQuB9Vh7wAB9a0AIHg_K-wsM/CYNTRL05S4okPzkUfE5LbrRKt9g\"",
    "snippet":{
    "publishedAt":"2013-01-25T13:36:19.000Z",
    "channelId":"UCpVm7bg6pXKo1Pr6k5kxG9A",
    "title":"Weird Nature: Pink Dolphins?",
    "description":"Up to 9 feet long and weighing up to 300 pounds, pink river dolphins           are the largest freshwater dolphins in the world.",
    "thumbnails":{
        "default":{
           "url":"https://i.ytimg.com/vi/ZCJgvabihQ8/default.jpg"
        },
        "medium":{
           "url":"https://i.ytimg.com/vi/ZCJgvabihQ8/mqdefault.jpg"
        },
        "high":{
           "url":"https://i.ytimg.com/vi/ZCJgvabihQ8/hqdefault.jpg"
        }
    },
    "categoryId":"24"
    }
}
]
} 
```

有什么我错过的吗？非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T20:35:12.077

recordingDetails 并非对所有视频都是公开的，因此如果视频没有这些属性可用，则不会返回任何内容。通过不返回任何内容，YouTube 节省了带宽并且响应时间可以更快。

* * *

原回复：

> 这看起来像一个合法的错误......
> 
> recordingDetails 在视频资源概述页面上列为一个选项，但未在此处的视频列表方法中列为有效部分：[https ://developers.google.com/youtube/v3/docs/videos/list](https://developers.google.com/youtube/v3/docs/videos/list)
> 
> 通常，当您尝试使用无效部分时，您会收到“400 Bad Request”错误，但 recordingDetails 仍会返回 200 响应，因此看起来确实应该返回...
> 
> 您应该在此处提交错误报告： [https://code.google.com/p/gdata-issues/issues/entry?template=YouTube%20(Defect%20Report)](https://code.google.com/p/gdata-issues/issues/entry?template=YouTube%20(Defect%20Report))

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T22:01:46.783

`recordingDetails`只有明确设置了地理位置或录制时间的视频才会返回。（并非所有视频都设置了录制时间；这是与发布时间不同的元数据。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-17T21:25:27.087

您可以进行[列表](https://developers.google.com/youtube/v3/docs/search/list#try-it)调用以检索基于 a`location`和的视频列表`locationRadius`。

然后，使用返回的列表，您可以进行[视频](https://developers.google.com/youtube/v3/docs/videos)`id`通话，包括查询参数中的所有视频 ID 。然后，您可以指定`recordingDetails`为“部分”，它将起作用。

这就是 Youtube 在这里的做法：

[https://github.com/youtube/geo-search-tool](https://github.com/youtube/geo-search-tool)

# oracle - Oracle PL/SQL 数据访问包代码生成器

> ID：14553779
> 
> 赞同：1
> 
> 时间：2013-01-28T00:07:56.353
> 
> 标签：oracle, database-design, code-generation, data-access-layer

正如许多在 Oracle 上从事 PL/SQL 开发工作的人可能在他们的职业生涯中所经历的那样，创建包以处理特定表上的数据访问层是很常见的。我的意思是，给定一个表'employee'是创建一个包'da_employee'（'da'代表'数据访问'）的普遍做法，该包实现诸如ins（）之类的例程，以便将一行插入员工，del () 用于删除一行，upd() 用于更新，lock() 用于锁定，...，我可以继续...

包的内容可能会根据需要和个人选择而有所不同，但可以说，一旦为表设计了数据访问包的结构，我计划在我的模式中创建数百个表可能需要基于相同设计的包。

在这一点上，我可以说可以使用存储在数据库中的元数据和包本身的模板来自动生成这种包。

我想我不是第一个得出这个结论的人，所以我想知道周围是否有这样的代码生成解决方案，无论是商业的还是免费的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-31T11:02:53.097

Toadworld 不再提供 CodeGen 实用程序。我现在正在研究在 PL/SQL Challenge 站点 (plqlchallenge.com) 上为 TAPI（以及更普遍的数据访问层）生成提供替代方案。Rick，我很想和你谈谈你的 - 请随时通过 steven@stevenfeuerstein.com 与我联系。

关于是否使用TAPI的问题：我认为首先关注基本原理，然后寻找最佳解决方案是最重要的。

对我来说，关键原则是避免在我的应用程序中重复 SQL 语句，从而更容易优化、维护和增强这些语句。因此，数据访问层至关重要。我们中的一些人构建了在单个表上执行 DML 的应用程序，因此我们发现 TAPI 很有用。其他人则不喜欢“XAPI”（事务 API）。

这些天来，我编写的包包含两者的一部分——并尽可能多地生成它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-21T11:04:40.067

你可以试试

[https://code.google.com/p/tapig/](https://code.google.com/p/tapig/)

我简要地看了看..但它有一个问题，因为我的表名中带有_

# android - 由 png 和 overlay 组成的 XML drawable

> ID：14553784
> 
> 赞同：10
> 
> 时间：2013-01-28T00:09:01.780
> 
> 标签：android, xml, button, png, drawable

我有一个 png 按钮，它已启用，未按下。当用户单击按钮时，我只想使 png 变暗。我需要这样的东西：

```
 <selector xmlns:android="http://schemas.android.com/apk/res/android" >
  //normal button with background my_button.png
        <item 
            android:state_enabled="true" 
            android:drawable="@drawable/my_button"   //my_button.png
            />
  //pressed button with background my_button.png overlayed by 50% black
        <item 
            android:state_pressed="true"
            android:state_enabled="true"    
            >
            <RelativeLayout 
               android:layout_width="wrap_content"
               android:layout_height="wrap_content">

              <bitmap  android:src="@drawable/my_button"/>
              <color android:color="#00000088"/>
            </RelativeLayout>
        </item>      
    </selector> 
```

有什么方法可以做到这一点吗？还是我必须有另一个 png 文件？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-11-21T12:33:04.750

在 my_button_bg.xml 中：

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:drawable="@drawable/button_pressed" android:state_pressed="true"/>
    <item android:drawable="@drawable/button_normal"/>
</selector> 
```

button_normal 是一个 png

button_pressed 是一个 xml：

```
<?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android" >
    <item android:drawable="@drawable/button_normal"/>
    <item android:drawable="@color/btn_bg_pressed_mask"/>
</layer-list> 
```

其中 btn_bg_pressed_mask 是一种颜色：

```
<color name="btn_bg_pressed_mask">#19000000</color> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-11-21T08:21:06.800

这应该工作

```
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">

    <item
        android:state_enabled="true"
        android:drawable="@drawable/my_button" />
    <item>
        <selector>
            <item
                android:state_pressed="true"
                android:state_enabled="true">
                <color android:color="#00000088" />
            </item>
        </selector>
    </item>

</layer-list> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-17T17:10:11.833

选择器 XML 中的项目顺序会有所不同。第一个匹配是要显示的内容。正如您在marmor的回答中看到的那样，按钮的正常状态列在最后。

要记住的另一件事是，如果您使用 9-patch 图像 (.9.png)，颜色将仅应用于内容区域。因此，如果您希望将颜色覆盖在整个图像上，请确保将整个图像标记为内容区域。

# backend - Varnish 似乎无法保持与后端的连接（错误 503）

> ID：14553786
> 
> 赞同：1
> 
> 时间：2013-01-28T00:09:11.030
> 
> 标签：backend, varnish

我在本地环境中一直在努力解决这个问题已经有一段时间了。我一直在到处寻找尝试许多不同的解决方案。

**设置**：我在配置文件中创建了一个后端，该后端指向没有缓存（通过）的外部网站。

**行为**：随机关闭后端连接并显示消息“错误 503 服务不可用”。

我有一个由 Amazon EC2 提供的简单网页。我使用 Varnish 重定向我的电话。我在浏览器中按 F5，有时它可以工作，有时不能。使用 varnishlog，我一直在试图弄清楚发生了什么：唯一有意义的是它说“BackendClose”的那一行。之后，所有后续请求都失败。（另外，我还配置了其他后端，它工作正常。）

另外，我一直在尝试使用保持活动/会话长度，但到目前为止没有任何效果。据我了解，似乎与后端的连接已关闭（可能由于某种原因通过亚马逊），但清漆等待一段时间才能恢复它。

所以，如果有人有一些建议，我很乐意尝试。

清漆版本：varnish-3.0.2 修订版 cbf1284

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T19:15:50.583

在试图弄清楚问题出在哪里之后，我终于弄明白了。

似乎有什么东西因为某种原因阻止了 ip。在检查防火墙随机阻止一些数据包和不同的交换机策略后，我发现问题是因为我的机器有第二个以太网配置。我不知道为什么它在那里，所以我删除了它。从那以后，这个问题就没有了。

所以感谢帮助我解决这个问题的网络人员，因为我变得疯狂 :P 最后，这不是 Varnish 问题。下一次，我会尝试在不同的机器和环境上做许多不同类型的测试，然后再浪费这么多时间。

# python - python setup.py sdist 仅包括来自顶级模块的 .py 源

> ID：14553787
> 
> 赞同：30
> 
> 时间：2013-01-28T00:09:11.630
> 
> 标签：python, setup.py, sdist

我有一个 setup.py：

```
from setuptools import setup

setup(
      ...
      packages=['mypackage'],
      test_suite='mypackage.tests',
      ...
    ) 
```

`python setup.py sdist`创建一个仅包含来自顶级 mypackage 的源模块而不包含 mypackage.tests 或任何其他子模块的文件。

我究竟做错了什么？

使用 python 2.7

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-01-28T00:12:13.273

使用[`find_packages()`功能](http://setuptools.readthedocs.io/en/latest/setuptools.html#using-find-packages)：

```
from setuptools import setup, find_packages

setup(
    # ...
    packages=find_packages(),
) 
```

该函数将搜索 python 包（带有`__init__.py`文件的目录）并将它们作为格式正确的列表返回。它将从与 setup.py 脚本相同的目录开始，但可以指定一个明确的起始目录，以及排除模式（如果您需要它来跳过某些内容）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-29T15:11:56.343

对于使用纯 distutils 而不是 setuptools 的人：您必须在 packages 参数中传递所有包和子包（但不是所有子模块，它们都被检测到）的列表。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-10-07T23:08:55.067

只需在包列表中包含所有子模块：

```
from setuptools import setup

setup(
      ...
      packages=['mypackage', 'mypackage.tests', 'mypackage.submodules'],
      ...
     ) 
```

# algorithm - 直接布雷森纳姆

> ID：14553789
> 
> 赞同：2
> 
> 时间：2013-01-28T00:09:52.243
> 
> 标签：algorithm, loops, graphics, bresenham

Bresenham 有一个众所周知的画线算法，维基百科有很好的关于它的文章：[http](http://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm) ://en.wikipedia.org/wiki/Bresenham's_line_algorithm 。

主循环根据需要通过加或减 1 来迭代计算 x 或 y 坐标。

给定 start-point `x1`、`y1`、 end-point`x2`和`y2`一些`y`（`y1`<= `y`<= `y2`），是否可以直接计算`x`row 处活动像素的所有坐标`y`？

例如，假设我使用标准 Bresenham 方法画一条线：

```
 oooo               - y1
        ooo
           oooo
               ooo     - y
                  oooo - y2

    |                |
    x1               x2 
```

所以为此`y`我想得到一个`[x1+11, x1+12, x1+13]`.

我不确定是否甚至可以像上面那样修改布雷森汉姆，所以如果事实证明这是不可能的，是否有任何其他方法可以获得看起来与布雷森汉姆计算的序列完全相同的序列？我不在乎它是快还是慢，是否使用浮点数，只要可以直接评估即可。

提前致谢！

编辑：为了能够比较我写了一个简单的参考测试的想法：

```
def line(x0, y0, x1, y1):
    canvas = [[u'\u25a1'] * (max(x0, x1) + 1) for y in range(max(y0, y1) + 1)]
    dx = abs(x1-x0)
    dy = abs(y1-y0)
    if x0 < x1:
        sx = 1
    else:
        sx = -1
    if y0 < y1:
        sy = 1
    else:
        sy = -1
    err = dx-dy
    while True:
        canvas[y0][x0] = u'\u25a0'
        if x0 == x1 and y0 == y1:
            break
        e2 = 2*err
        if e2 > -dy:
            err = err - dy
            x0 = x0 + sx
        if e2 < dx:
            err = err + dx
            y0 = y0 + sy
    return '\n'.join(' '.join(r) for r in canvas) 
```

打字：

```
print line(2, 1, 10, 8) 
```

印刷：

```
□ □ □ □ □ □ □ □ □ □ □
□ □ ■ □ □ □ □ □ □ □ □
□ □ □ ■ □ □ □ □ □ □ □
□ □ □ □ ■ □ □ □ □ □ □
□ □ □ □ □ ■ ■ □ □ □ □
□ □ □ □ □ □ □ ■ □ □ □
□ □ □ □ □ □ □ □ ■ □ □
□ □ □ □ □ □ □ □ □ ■ □
□ □ □ □ □ □ □ □ □ □ ■ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T02:11:08.623

好的，所以 Bresenham 的算法很有吸引力，因为它使用整数数学（它简化了像素位于整数 x,y 坐标的假设）。

求解整数 y 处某行的像素数的算法将执行以下操作：

```
count = 1
y_query = your query row
x_intercept = intercept of your line at y_query.
round x_intercept to the nearest integer. 
(x_intercept, y_query) now define a pixel in the row 
```

想法是从这个坐标向左和向右走，看看你是否还在 y_query 行中：

```
//going left
x_new = x_intercept - 1
y_new = the y intercept for the line given x_new
round y_new to the nearest integer
if (y_new == y_query), add 1 to our count of pixels in this row, else break; 
```

对 x_new = x_intercept + 1 执行相同的操作

# svn - 将 SVN 工作目录的闪存驱动器副本转换为正确的工作目录？

> ID：14553792
> 
> 赞同：2
> 
> 时间：2013-01-28T00:10:17.613
> 
> 标签：svn

我有一个相当大的项目（13 GB）和糟糕的互联网连接。我将我的工作目录的副本放在闪存驱动器上——但没有 .svn 目录，它会使大小翻倍。

**我希望复制闪存驱动器的内容，然后将其转换为正确的工作目录。** 本质上是一个结帐，但我的闪存驱动器提供了 13 GB 的文件。

*   这个想法[https://stackoverflow.com/a/861020/826062](https://stackoverflow.com/a/861020/826062)是将闪存驱动器文件导入新的本地存储库，签出该存储库，然后将 sw --relocate 签出到在线存储库。请注意，这需要设置本地 repo 的 UUID，否则 SVN 会拒绝。

由于各种原因，这个聪明的想法行不通（E155017：校验和不匹配或“找到了阻碍工作的副本”）。

*   我的下一个想法是创建一个空的结帐树（通过我的连接做很便宜），然后将我的文件同步到其中。SVN 对此并不是很感兴趣（将深度恢复到无穷大的各种问题）。

有了许多这些想法/实验，SVN 尝试再次通过我的连接下载整个东西（可能是因为它无法校验和来比较本地和远程？）

抱歉，解释太长了，但我认为这对整个画面来说是必要的。

还有其他人尝试将复制的本地文件与现有的 SVN 存储库同步吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-01T09:27:01.513

该`.svn`目录包含每个版本化源文件的“干净”副本，这就是它如此之大的原因。但是它也包含元数据，这将很难重建。

相比之下，工作文件可以很容易地从`.svn`. 因此，另一种方法是仅复制目录*，*`.svn`然后运行`svn revert -R .`以恢复工作文件，而无需进一步的网络流量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-28T00:30:39.920

不幸的是，没有`.svn`目录的工作副本根本不是工作副本。您可能可以避免复制文本库（或从 Subversion 1.7 开始称为原始文本），但您不能完全忽略`.svn`目录。

一些可能的补救措施：

您可能想尝试使用一些 DVCS 作为断开连接的工作副本的机制，因为它们在复制方面更具弹性。`git-svn`想到了。

您也可以将工作副本压缩到闪存驱动器上的文件中，然后将其解压缩到家里的磁盘上。

# ajax - jQuery 和 ajax：等待图像在显示之前先加载？

> ID：14553795
> 
> 赞同：0
> 
> 时间：2013-01-28T00:10:25.800
> 
> 标签：ajax, image, jquery, loading

> **可能重复：**
> [jQuery Ajax 等到所有图像都加载完毕](https://stackoverflow.com/questions/4774746/jquery-ajax-wait-until-all-images-are-loaded)

我想在显示之前先在我的 ajax 调用中加载我的图像。我怎么做？

```
$.ajax({
   url: 'ajax.php',
   type: 'post',
   data:  "q="+query,
   success: function(data) {

     $('.show').html(data).fadeIn('fast');

   }
}); 
```

我想对我的 ajax 进行干净的淡入处理，但现在它会立即显示出来，并且我的文本已完全加载，但我的图像加载缓慢，并且从页面顶部加载到底部页面。

理想情况下，当我的图像在后台加载时，我想显示一个加载符号，然后有一个干净的淡入淡出。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T00:15:58.473

为图像加载和错误事件添加事件侦听器以计算加载的图像事件

```
success: function(data) {
    var count = 0;
    var images = $('.show').html(data).find('img').on('load', function(){
        count++;
        if (count == images){
            $('.show').fadeIn('fast');
        }
    }).on('error', function(){
        count++;
        if (count == images){
            $('.show').fadeIn('fast');
        }
    }).length;
} 
```

# php - SQL查询检索邻接表模型中某些类别下的所有产品

> ID：14553796
> 
> 赞同：3
> 
> 时间：2013-01-28T00:11:59.227
> 
> 标签：php, mysql, sql, many-to-many

我有一个使用邻接列表方法的数据库来处理产品的分类，其中一种产品可以在许多类别下找到。看看以下数据库布局：

```
cats
id    parent    title           desc
1     0         top             top level
2     1         Electronics
3     2         Gaming
4     2         Computers
5     4         Tablets
6     1         Food
7     3         Xbox

products
id        title         qty
1         ToshibaTV     5
2         I-PAD2        9
3         Laser Pen     24
4         Asus Notebook 5

cats_products
id   product_id   cat_id 
1    2            3
2    2            5
3    1            2
4    3            2
5    4            4 
```

在上面的示例中，我需要一个 SQL 查询，该查询能够检索在**Electronics**类别中找到的所有产品及其任何级别的任何子类别（例如 Xbox，它不是 Electronics 的直接子类别），而无需重复找到的产品在多个类别中，例如 I-PAD2。

我可以在 PHP 中的应用程序的帮助下做到这一点，但我想知道是否可以在 MySQL 中只使用纯 sql 来做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-28T01:43:40.200

使用邻接列表模型您尝试做的事情相当困难。正如@Mike 所建议的那样，使用嵌套集模型会使这变得容易得多。或者通过您的 php 代码进行操作会更容易。

但是，假设您知道可能有多少个父子级别（或者您可以假设不会超过 X），您可以尝试这样的事情。如果 MySQL 支持 CTE，这将更容易阅读，但不幸的是，它不支持。在这个例子中，我已经深入了 4 个级别——你可以理解更深入的想法。

```
SELECT p.Id, p.Title, p.Qty
FROM Products p
   JOIN Cats_Products cp on p.id = cp.product_id
WHERE cp.cat_id IN (
   SELECT c.id
   FROM Cats c
   WHERE c.title = 'Electronics'
   UNION ALL
   SELECT c2.id
   FROM Cats c
      LEFT JOIN Cats c2 ON c.id = c2.parent
   WHERE c.title = 'Electronics'
   UNION ALL
   SELECT c3.id
   FROM Cats c
      LEFT JOIN Cats c2 ON c.id = c2.parent
      LEFT JOIN Cats c3 ON c2.id = c3.parent
   WHERE c.title = 'Electronics'
   UNION ALL
   SELECT c4.id
   FROM Cats c
      LEFT JOIN Cats c2 ON c.id = c2.parent
      LEFT JOIN Cats c3 ON c2.id = c3.parent
      LEFT JOIN Cats c4 ON c3.id = c4.parent
   WHERE c.title = 'Electronics'
)
GROUP BY p.Id, p.Title, p.Qty 
```

这是[SQL Fiddle](http://sqlfiddle.com/#!2/366be0/1)。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T01:33:42.603

这是你问题的第一部分。您能否更详细地解释一下子部分。我想这与猫的父母有关。

尝试这个：

```
SELECT distinct(p.title) 
FROM cats AS c
JOIN cats_products AS cp
ON cp.cat_id = c.id AND c.title = "Electronics"
JOIN products AS p
ON p.id = cp.product_id; 
```

样本数据：

```
CREATE TABLE cats
    (`id` int, `parent` int, `title` varchar(11), `desc` varchar(9))
;

INSERT INTO cats
    (`id`, `parent`, `title`, `desc`)
VALUES
    (1, 0, 'top', 'top level'),
    (2, 1, 'Electronics', ''),
    (3, 2, 'Gaming', ''),
    (4, 2, 'Computers', ''),
    (5, 4, 'Tablets', ''),
    (6, 1, 'Food', ''),
    (7, 3, 'Xbox', '')
;

CREATE TABLE products
    (`id` int, `title` varchar(13), `qty` int)
;

INSERT INTO products
    (`id`, `title`, `qty`)
VALUES
    (1, 'ToshibaTV', 5),
    (2, 'I-PAD2', 9),
    (3, 'Laser Pen', 24),
    (4, 'Asus Notebook', 5)
;

CREATE TABLE cats_products
    (`id` int, `product_id` int, `cat_id` int)
;

INSERT INTO cats_products
    (`id`, `product_id`, `cat_id`)
VALUES
    (1, 2, 3),
    (2, 2, 5),
    (3, 1, 2),
    (4, 3, 2),
    (5, 4, 4)
; 
```

[SQL 小提琴演示](http://www.sqlfiddle.com/#!2/655b7/25)

**编辑第二部分**：

```
SELECT distinct(v.title) FROM products AS v
JOIN (
  SELECT Y.product_id FROM cats_products AS Y
    JOIN(
      SELECT distinct(z.id) FROM cats AS Z
        JOIN
          (SELECT c.parent
           FROM cats AS c
           JOIN cats_products AS cp
           ON cp.cat_id = c.id 
           AND c.title = "Electronics") AS X
         ON x.parent = z.parent) AS W
    ON W.id = Y.cat_id) AS u
ON u.product_id = v.id
; 
```

样本数据

```
CREATE TABLE cats
    (`id` int, `parent` int, `title` varchar(11), `desc` varchar(9))
;

INSERT INTO cats
    (`id`, `parent`, `title`, `desc`)
VALUES
    (1, 0, 'top', 'top level'),
    (2, 1, 'Electronics', ''),
    (3, 2, 'Gaming', ''),
    (4, 2, 'Computers', ''),
    (5, 4, 'Tablets', ''),
    (6, 1, 'Food', ''),
    (7, 3, 'Xbox', '')
;

CREATE TABLE products
    (`id` int, `title` varchar(13), `qty` int)
;

INSERT INTO products
    (`id`, `title`, `qty`)
VALUES
    (1, 'ToshibaTV', 5),
    (2, 'I-PAD2', 9),
    (3, 'Laser Pen', 24),
    (4, 'Asus Notebook', 5),
    (5, 'French Fries', 50)
;

CREATE TABLE cats_products
    (`id` int, `product_id` int, `cat_id` int)
;

INSERT INTO cats_products
    (`id`, `product_id`, `cat_id`)
VALUES
    (1, 2, 3),
    (2, 2, 5),
    (3, 1, 2),
    (4, 3, 2),
    (5, 4, 4),
    (5, 5, 6)

; 
```

这是我对您的问题的解释：每个类别都有一个父类别，您想选择具有相同父类别的所有其他类别。更具体地说，所有具有相同父类别的产品。 [SQL 小提琴演示](http://www.sqlfiddle.com/#!2/76397/2)

# mysql - 无法登录或获取 Mysql cmd 行

> ID：14553797
> 
> 赞同：0
> 
> 时间：2013-01-28T00:12:02.817
> 
> 标签：mysql, centos, vps

我有一个运行 CentOS 的 VPS，并安装了 apache、php、mysql。我正在按照安装教程进行安装，并且在设置 mysql 时显然做错了（我相信设置用户和密码）。现在，每当我尝试访问 MySQL 命令行界面时，都会收到此错误。

```
ERROR 1045 (28000): Access denied for user 'root'@'localhost' (using password: YES) 
```

我查了一下，得到了一些尝试绕过的建议，以便我可以重置密码。我试过了：

```
/etc/init.d/mysqld --skip-grant-tables 
```

出现了同样的错误。我尝试通过首先删除mysql然后再次安装来重新安装。出现同样的错误。我还可以做些什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T20:59:56.320

（如果您在 DB 中没有任何内容，请删除 mysqlDB - 不是安装，而是 /var/lib/mysql/ 中的 DB 文件 - 先备份它！）

开始这个：shell#mysql_secure_installation

它会要求你：

*   设置根密码。如果你已经拥有它
*   您需要在其余步骤中输入它。
*   移除匿名用户
*   禁用非本地 root 访问
*   删除测试数据库和与之相关的访问规则
*   重新加载权限表，使上述更改生效

BR

# sql-server - 选择第 8 行后的前 3 行

> ID：14553798
> 
> 赞同：1
> 
> 时间：2013-01-28T00:12:05.720
> 
> 标签：sql-server, sql-server-2008

我有一张桌子：`id, Group, Status, Subject`。

我需要 group=2 AND status=2 的行，但我想跳过前 8 个结果（按 排序`id`）。这是我尝试过的，但它不会跳过前 8 行：

```
SELECT TOP 3 [id], LEFT ([subject],30) AS Title 
FROM [Katavot] 
    WHERE (([Status] = @Status) AND ([Group] = @Group)) 
ORDER BY [id] DESC 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T00:24:42.693

```
;WITH Katavod_Modified AS 
(
    SELECT id, LEFT ([subject],30) As Subject, [Group], [Status],  ROW_NUMBER() OVER (ORDER BY id) RN
    FROM [Katavot]
)
SELECT TOP 3 [id], LEFT ([subject],30) AS Title FROM [Katavod_Modified] WHERE 
(([Status] = @Status) AND ([Group] = @Group) AND (RN > 8)) ORDER BY [id] DESC 
```

[看起来和这个](https://stackoverflow.com/questions/7137889/skip-first-row-in-sql-server-2005)很相似。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T00:27:45.833

基于[row_number](http://msdn.microsoft.com/en-us/library/ms186734.aspx)

```
WITH MyResult AS
{
SELECT ROW_NUMBER() OVER(ORDER BY Id DESC) AS RowNumber, [id], LEFT ([subject],30) AS Title 
FROM [Katavot] 
    WHERE (([Status] = @Status) AND ([Group] = @Group)) 
ORDER BY [id] DESC
}
SELECT [id], Title 
FROM MyResult
WHERE RowNumber BETWEEN 9 AND 12 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-28T00:28:10.170

MySQL：

```
LIMIT x, y 
```

微软SQL：

```
select top y *
from <table>
where <unique id> not in (select top x <unique id> from <table> order by <unique id>)
from <table> order by <unique id> 
```

# cdn - 以编程方式获取最新的 Google 托管库版本？

> ID：14553800
> 
> 赞同：3
> 
> 时间：2013-01-28T00:12:25.400
> 
> 标签：cdn, google-cdn

有谁知道是否有办法以编程方式获取 Google 托管库的最新版本？

我问这个的原因是在模板生成器中使用它。恕我直言，最好在将模板应用于项目时下载最新的库，并且仅仅因为库发布了新版本而不得不更新 repo 有点烦人。

不要误会我的意思，这并不意味着在您的应用程序运行时始终使用最新的。它旨在始终为您提供在提出项目时可用的最新版本。

谢谢！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T08:01:28.933

如果你使用cdnjs：[http ://cdnjs.com/packages.json](http://cdnjs.com/packages.json)

也可通过 HTTPS 获得：[https ://cdnjs.com/packages.json](https://cdnjs.com/packages.json)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T06:06:06.633

我找不到合适的解决方案，所以我出去建造了一个。您愿意[试一试 CDN.io](http://cdnio.uxtemple.com)并分享您的想法吗？

**客观的？**始终以编程方式获取对 CDN 托管库的最新参考。

**为什么这会有用？**即，用于模板生成器。通过这种方式，我们始终可以放心，用户将获得他们 CDNed 库的最新版本，我们不必再担心更新助手。

**为什么我还要打扰？**因为 CDN 服务不提供 API 来访问其托管库列表！

**如果您不想使用 Web 服务怎么办？**没问题，只需将其用作库即可。

谢谢！:) 达里奥

# android - 在ItemClickListener 上打开视频

> ID：14553801
> 
> 赞同：1
> 
> 时间：2013-01-28T00:12:26.637
> 
> 标签：android, android-listview, onitemclicklistener

当用户单击列表中的项目时，我正在尝试打开视频。我有 listview 工作的代码和打开视频的代码。我只是不知道如何将两者结合起来。

这是我打开视频的代码。

```
 String video_path = "http://www.youtube.com/watch?v=qrEUBl2pacU";
    Uri uri = Uri.parse(video_path);

    uri = Uri.parse("vnd.youtube: " + uri.getQueryParameter("v"));

    Intent intent = new Intent(Intent.ACTION_VIEW, uri);
    startActivity(intent); 
```

是否可以将此代码放入onItemClick？

编辑：这是整个班级。我感觉我的代码不正确，因为它都在 onCreate 中。但是，我遵循了一个教程，这就是它的所在。

```
public class Videos extends Activity{

private ListView lv;
String videoNames[] = {"Doctor Who Trailer", "T+S - Northshore", "Foo Fighters - Everlong"};

public void onCreate(Bundle icicle) {
    super.onCreate(icicle);
    setContentView(R.layout.videos);
    lv = (ListView) findViewById(R.id.videosListView);

    lv.setAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, videoNames));
    lv.setTextFilterEnabled(true);

    lv.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?>Videos, View v, int position, long id) {

    String video_path = "http://www.youtube.com/watch?v=qrEUBl2pacU";
    Uri uri = Uri.parse(video_path);

    uri = Uri.parse("vnd.youtube: " + uri.getQueryParameter("v"));

    Intent intent = new Intent(Intent.ACTION_VIEW, uri);
    startActivity(intent);
};
  });
 }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T00:43:50.413

这就是你的 onclicklistener 的样子。试试这个代码：

```
 final ArrayAdapter<String> aa = new ArrayAdapter<String>(this,R.layout.list_view,listItems);
    setListAdapter(aa);

    //This creates a listener for the Files listed
    getListView().setOnItemClickListener(new OnItemClickListener() {
        @Override
        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {
            String url = aa.getItem(position);
            Intent i = new Intent(Intent.ACTION_VIEW);
            i.setData(Uri.parse(url));
            startActivity(i);   
            return false;
        }
    }); 
```

更新：我建议使用 Hashmap 作为键值对。类似的东西（我没有编译这个）：

```
HashMap<String, String> hm = new HashMap<String, String>();
hm.put("videoText1", "youtube_link1");
hm.put("videoText2", "youtube_link2");
hm.put("videoText3", "youtube_link3"); 
```

然后，您可以使用 hm.keySet() 获取所有列表视图集。

```
ArrayList<String> listItems = new ArrayList<String>(hm.keySet());
final ArrayAdapter<String> aa = new ArrayAdapter<String>(this,R.layout.list_view,listItems);
    setListAdapter(aa); 
```

最后使用 Hashmap 查找 youtube 链接：

```
String url = hm.get(aa.getItem(position)); 
```

……

# c# - 详细信息视图控件仅显示 ASP.NET 网站的一条记录

> ID：14553802
> 
> 赞同：1
> 
> 时间：2013-01-28T00:12:27.567
> 
> 标签：c#, asp.net, user-controls

我确信对此有一个简单的答案，但是为什么在我的页面中使用绑定到访问数据源的详细信息视图控件时，为什么只显示我的表的第一条记录？

当我将下拉列表绑定到同一个数据源时，下拉列表会显示我的表中的所有记录。

在另一个页面上，我使用了一个数据列表，它显示了我创建的 select 语句的所有记录。

我是否需要一个 for 循环来将每条记录加载到详细信息视图控件中？

感谢您的任何建议，并对菜鸟问题感到抱歉。

编辑：这是我所引用的页面的代码

```
<%@ Page Language="C#" AutoEventWireup="true"  CodeFile="Default.aspx.cs"            Inherits="_Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>Untitled Page</title>
</head>
<body>
    <form id="form1" runat="server">
    <div>

        <br />
        <br />
        <asp:DropDownList ID="DropDownList1" runat="server" AutoPostBack="True" 
            DataSourceID="AccessDataSource2" DataTextField="Name" 
            DataValueField="ProductID">
        </asp:DropDownList>
        <asp:AccessDataSource ID="AccessDataSource2" runat="server" 
            DataFile="~/App_Data/Halloween.mdb" 
            SelectCommand="SELECT [ProductID], [Name] FROM [Products]">
        </asp:AccessDataSource>
        <br />
        <br />
        <br />
        <asp:DetailsView ID="DetailsView1" runat="server" 
            DataSourceID="AccessDataSource1" Height="50px" Width="125px" 
            DataKeyNames="ProductID">
            <Fields>
                <asp:BoundField DataField="ProductID" HeaderText="ProductID" ReadOnly="True" 
                    SortExpression="ProductID" />
                <asp:BoundField DataField="Name" HeaderText="Name" SortExpression="Name" />
                <asp:BoundField DataField="CategoryID" HeaderText="CategoryID" 
                    SortExpression="CategoryID" />
            </Fields>
        </asp:DetailsView>
        <asp:AccessDataSource ID="AccessDataSource1" runat="server" 
            DataFile="~/App_Data/Halloween.mdb" 
            SelectCommand="SELECT [ProductID], [Name], [CategoryID] FROM [Products] ORDER BY [CategoryID]">
        </asp:AccessDataSource>
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />

    </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T17:37:30.890

我找到了答案，DetailsView 控件在绑定到数据源时的默认行为与下拉列表或 ListView 控件不同。DetailView 控件通常一次显示一个表中的一条记录。您可以“启用分页”，它允许设置“分页器设置”，以便超链接将引导您浏览表中的每条记录。希望我的发现能在未来对其他人有所帮助。

这是 DetailsView 控件的代码，以及它与上述符号的不同之处。

```
<asp:DetailsView ID="DetailsView1" runat="server" 
            DataSourceID="AccessDataSource1" Height="50px" Width="125px" 
            DataKeyNames="ProductID" AllowPaging="True" AutoGenerateRows="False">
            <PagerSettings Mode="NextPreviousFirstLast" />
            <Fields>
                <asp:BoundField DataField="ProductID" HeaderText="ProductID" ReadOnly="True" 
                    SortExpression="ProductID" />
                <asp:BoundField DataField="Name" HeaderText="Name" SortExpression="Name" />
                <asp:BoundField DataField="CategoryID" HeaderText="CategoryID" 
                    SortExpression="CategoryID" />
            </Fields>
        </asp:DetailsView>
        <asp:AccessDataSource ID="AccessDataSource1" runat="server" 
            DataFile="~/App_Data/Halloween.mdb" 
            SelectCommand="SELECT [ProductID], [Name], [CategoryID] FROM [Products] ORDER BY [CategoryID]">
        </asp:AccessDataSource> 
```

# bash - sed 不替换行

> ID：14553804
> 
> 赞同：8
> 
> 时间：2013-01-28T00:12:40.933
> 
> 标签：bash, replace, sed

我有一个包含 1 行文本的文件，名为`output`. 我对文件有写权限。我可以毫无问题地从编辑器中更改它。

```
$ cat output
1
$ ls -l o*
-rw-rw-r-- 1 jbk jbk 2 Jan 27 18:44 output 
```

我想要做的是用一个新值替换这个文件中的第一行（也是唯一一行），要么是 1 要么是 0。在我看来，sed 应该是完美的：

```
$ sed '1 c\ 0' output
 0
$ cat output
1 
```

但它永远不会更改文件。我已经尝试将它分布在反斜杠上的 2 行中，并使用双引号，但我无法让它在第一行中放置 0（或其他任何内容）。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-28T00:13:58.767

Sed 对流进行操作并将其输出打印到标准输出。

它不会修改输入文件。

当您想在文件中捕获其输出时，通常会这样使用它：

```
#
# replace every occurrence of foo with bar in input-file
#
sed 's/foo/bar/g' input-file > output-file 
```

上面的命令调用`sed`on`input-file`并将输出*重定向*到一个名为`output-file`.

根据您的平台，您可能可以使用 sed 的`-i`选项来修改文件：

```
sed -i.bak 's/foo/bar/g' input-file 
```

笔记：

并非所有版本的 sed 都支持`-i`。

此外，不同版本的 sed 实现方式也`-i`不同。

在某些平台上，您**必须**指定备份扩展名（在其他平台上您不必）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-24T18:31:03.367

由于这是一个非常简单的文件，因此 sed 实际上可能有点矫枉过正。听起来您希望文件只有一个字符：“0”或“1”。

在这种情况下，只覆盖文件而不是编辑它可能更有意义，例如：

```
echo "1" > output 
```

或者

```
echo "0" > output 
```

# c# - Moq.Mock.Verify() 是否使用身份或 .Equals() 比较参数？

> ID：14553805
> 
> 赞同：15
> 
> 时间：2013-01-28T00:12:51.247
> 
> 标签：c#, moq

在类似的命令中

```
var mockObj = new Mock<MyObject>()
var anotherObj = Utilities.DoStuff();
// some tests...
mockObj.Verify(foo => foo.someMethod(anotherObj)); 
```

Moq 是使用身份比较还是使用`.Equals()`来确定是否`someMethod()`曾经`anotherObj`作为参数调用过？换句话说，我指定为参数的对象是否`foo.someMethod()`必须与之前调用的对象完全相同`someMethod()`才能通过验证，还是只需要等于`anotherObj`？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-28T00:25:10.200

`Moq`将按身份进行比较，它将寻找您使用身份指定的确切实例。如果这不是您想要的，而您正在寻找`equals`比较，您可以使用`It.Is`：

```
mockObj.Verify(foo => foo.someMethod(It.Is<MyObject>(m => m.Equals(anotherObj)))); 
```

# c++ - 布尔标志重置？

> ID：14553808
> 
> 赞同：-1
> 
> 时间：2013-01-28T00:13:11.343
> 
> 标签：c++, boolean

```
while(true){
    bool flag;
    while(true){
        if (conditions) {
            flag=true; 
            break;
        }
    }
} 
```

在这种情况下，标志在退出内部 while 循环后是否重置为 false 条件？从控制台的显示看来，它仍然处于真实状态。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T00:59:45.990

不，没有“重置”。没有任何魔法。事实上，`flag`甚至不会`false`为你神奇地初始化，你必须自己做。

我认为您正在考虑范围和阴影的经典示例：

```
int a = 4;
//a is 4 here
{
    int a = 3;
    //a is 3 here
}
//a is 4 here 
```

但这里也没有魔法。有两个不同的变量`a` *碰巧共享一个名称*。`a`在内部块中指的是第二个整数。如果您可以引用第一个整数，那么您将读取一个完全不同的整数。

这里有一些魔法：

```
SomeClass x; //x's constructor is called
{
    SomeOtherClass y; //y's constructor is called
} //y's destructor is called 
```

由于`y`是自动的，它会在其作用域结束时被销毁。（顺便说一下，第二个也是如此`a`，只是没有办法告诉。）如果它有一个析构函数，它将被调用。如果它的析构函数做了一些花哨的事情，比如“重置一些标志”，你会看到结果。（只有不通过`y`，这将消失。）

`{}`没有 if/while/function/etc的事实。依附于他们是无关紧要的。

# c++ - 全局 alt+space 热键抓取 - 奇怪的键盘焦点行为

> ID：14553810
> 
> 赞同：4
> 
> 时间：2013-01-28T00:13:30.193
> 
> 标签：c++, c, qt, x11, xcb

我正在`Alt+Space`使用 获取全局热键`xcb_grab_key`，如下所示：

```
xcb_key_symbols_t *keysyms = xcb_key_symbols_alloc(c);
xcb_keycode_t *keycodes = xcb_key_symbols_get_keycode(keysyms, XK_space), keycode;

// add bindings for all screens
xcb_screen_iterator_t iter;
iter = xcb_setup_roots_iterator (xcb_get_setup (c));
for (; iter.rem; xcb_screen_next (&iter)) {
    int i = 0;
    while(keycodes[i] != XCB_NO_SYMBOL) {
        keycode = keycodes[i];
        xcb_grab_key(c, true, iter.data->root, XCB_MOD_MASK_ANY, keycode, XCB_GRAB_MODE_SYNC, XCB_GRAB_MODE_SYNC);
        i += 1;
    }
} 
```

然后在 Qt 的 QAbstractNativeEventFilter 子类中，我处理它并在键匹配时发出 Qt 信号`Alt+Space`：

```
xcb_keycode_t *keycodes = xcb_key_symbols_get_keycode(keysyms, XK_space);
int i = 0;
bool found = false;
while(keycodes[i] != XCB_NO_SYMBOL) {
    if(event->detail == keycodes[i]) {
        if(event->state & GetModifier(c, keysyms, XK_Alt_L) || event->state & GetModifier(c, keysyms,  XK_Alt_R)) {
            xcb_allow_events(c, XCB_ALLOW_ASYNC_KEYBOARD, event->time);
            emit gotHotKey();
            found = true;
        } else {
            xcb_allow_events(c, XCB_ALLOW_REPLAY_KEYBOARD, event->time);
        }
        break;
    }
    i += 1;
}
if(found) return true; 
```

（`GetModifier`是[从 VLC 复制的，](http://svn.tribler.org/vlc/trunk/modules/control/globalhotkeys/xcb.c)但我认为这部分无关紧要，因为 Alt 键匹配正确）

我遇到的问题是，在`show()`按下热键时主窗口后，键盘大部分时间¹没有正确聚焦。我可以打字，但是光标不可见，输入框没有突出显示，`Ctrl+Q`退出des的快捷方式不起作用。可以通过移动窗口或按空格来解决它 - 然后恢复焦点 - 光标+边框重新出现并`Ctrl+Q`起作用。什么可能导致这种行为？

我正在使用 Qt 5.0.0 和 xcb 1.8.1。[可以从 github](https://github.com/jkozera/zeal)下载完整的应用程序进行编译。

¹这意味着有时问题是不可重现的 - 即使重复的窗口隐藏/显示也正确设置了焦点，但其他时候它会在一行隐藏/显示中发生多次。它经常发生在整体上。

（编辑：我已经实现了一个（非常丑陋的......）解决方法，因此要重现 github 项目的问题，需要删除以下代码）

```
#ifndef WIN32
    // Very ugly workaround for the problem described at http://stackoverflow.com/questions/14553810/
    // (just show and hide a modal dialog box, which for some reason restores proper keyboard focus)
    hackDialog.setGeometry(0, 0, 0, 0);
    hackDialog.setModal(true);
    hackDialog.show();
    QTimer::singleShot(100, &hackDialog, SLOT(reject()));
#endif 
```

# assembly - 如何计算补码

> ID：14553815
> 
> 赞同：1
> 
> 时间：2013-01-28T00:13:47.343
> 
> 标签：assembly, logic, bits, circuit

如果没有在公式中明确使用 0001（使用幂 - 1111 - 或接地 - 0000），您将如何获得 4 位数字的 2 补码？

我尝试使用拆分器，但将单独的 1 位数字重建回 4 位数字不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T06:31:55.810

To calculate two's complement with logic, one typically uses a chain of half adders:

```
(sum,c_out) = HA(a,b) ==  
 c_out := a & b,
 sum := a ^ b; 
```

The first HA is actually a tautology: bit_0 == a_0, c_1 == 1, and can be optimized out, if so wanted. Also the last carry out c_4 is rejected.

```
(bit_0,c_1)   := HA(not a_0, c_0 = 1)
(bit_1,c_2)   := HA(not a_1, c_1)
(bit_2,c_3)   := HA(not a_2, c_2)
(bit_3,[c_4]) := HA(not a_3, c_3) 
```

With assembler one can use the fact that twos_comp(i) for n bit number == 2^n - i, for i!=0.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T01:00:54.363

您可以将 4 位放入字节的高 4 位，取反字节，然后查看高 4 位。

# java - 生成 BigInteger 数字然后相乘。

> ID：14553819
> 
> 赞同：0
> 
> 时间：2013-01-28T00:14:23.613
> 
> 标签：java, algorithm, biginteger

我正在尝试生成具有 X 位数的大整数。我以为我已经弄清楚了，直到我意识到下面的代码正在创建位，而不是数字。我一直在试图找出一种体面的方法来创建数字而不是位。有人可以帮助我并指出正确的方向吗？直到现在我还没有使用过 BigInteger。哦，这是一个家庭作业问题，这就是我寻求帮助的原因，而不是一个确切的答案。再次感谢各位。

```
BigInteger X = new BigInteger(23000, new Random());
BigInteger Y = new BigInteger(23001, new Random());
BigInteger result =  X.multiply(Y); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T00:57:53.803

`log2(10) =~ 3.321928`，因此如果需要 23000 个十进制数字，则应指定 76404 位（23000*3.321928）。请注意，这将在区间 [0..10 ^(23000) ] 中生成一个数字。该号码本身可能没有 23000 位数字。

如果你想强制它有 23000 位，你应该在 [0..10 ^(22999) ] 范围内生成一个数字并添加 10 ^(22999)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T09:16:20.310

您可能想要创建一个 char 数组，该数组的每个项目保存一个数字。而且你们很多人需要实现一个算法来乘以它。

如果你的作业需要考虑使用更少的内存，你可能想使用每个 char 来存储 2 位数字或使用一个整数来存储 9 位数字。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-28T00:33:29.933

您在这里使用的是一个构造函数，`BigInteger`它接受 a`int`和 a并`Random`生成**均匀分布在 to 范围内**的a 。[请参阅 BigInteger Oracle 文档](http://docs.oracle.com/javase/7/docs/api/java/math/BigInteger.html)——它将帮助您完成作业。`BigInteger` **`0``(2^(numBits) - 1)`**

 ****编辑：**

也许以下内容会有所帮助：计算机只能识别两个数字：0 和 1。

它们被称为**位**。

8 位代表一个**八位字节**。

在当今的大多数计算机系统中，8 位也代表一个**字节**。

所以下面的数：010以2为底（计算机识别的底），由3位组成，等于以10为底（人们广泛使用）到3。以10为底的4等于到 011 和 5 等于 100 - 希望你明白了。

用 3 位来表示一个数，就等于说你可以表示一个从 0 到 (2^(3) - 1)=7 的数。因此，3 位允许我们表示一个具有 1 位数字的数字。使用 4 位将允许我们表示范围从 0 到 (2^(4) - 1)=15 的数字 - 即具有两位数的数字。

现在你需要想出一种方法来告诉你如何找到代表数字的`X`位数。**

# performance - GPGPU - 算术强度和缓存

> ID：14553820
> 
> 赞同：1
> 
> 时间：2013-01-28T00:14:25.933
> 
> 标签：performance, gpgpu, bandwidth

我正在研究用于科学应用的 GPU 的理论知识，我发现了这句话：

> 高算术强度和许多数据元素意味着可以通过计算而不是大数据缓存来隐藏内存访问延迟。

这到底是什么意思？可以解释为建议避免在为 GPU 编程时存储一些预先计算的结果，而是在每次我们在设备上运行函数时计算它们？

例如，假设我们有一个代码执行递归循环以计算一个长数组，其中包含大量计算。此外，假设我们可以预先计算一些部分数组，这将有助于在循环内部跳过一些计算，甚至是一些不是很昂贵的计算。根据引用，我们是否应该避免这种情况，但每个周期都计算这些数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T19:09:14.620

GPU 可以访问不同类型的内存。您用来提供 GPU 数据的内存类型以及在 GPU 完成计算后从 GPU 检索的数据是全局内存（例如，标准 GTX480 有 1.5GB 内存）。

该内存具有高带宽，但也具有高延迟（在 GTX480 上约为 400-800 个周期）。因此，与其预先计算事物，将其存储在全局内存中，然后检索它（导致高延迟），不如在 GPU 上计算它。这样，您不必等待内存来检索预先计算的数据。

如果在给定时间所有线程都处于活动状态（= warp），那么这会导致高延迟，因为这些线程无法前进，因为数据尚未到达。GPU 可以在 400-800 个周期内进行大量计算，因此最好交换内存获取以进行计算。

话虽如此，您可以使用其他可用的内存类型。例如，在 CUDA 中，您可以访问片上内存（共享内存），它非常快且延迟非常低。您可以让 warp 中的一个线程计算某些内容，将其存储在共享内存中，并让其他线程使用该值。因此，您将预先计算转移到 GPU，并使用片上内存来检索预先计算的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T18:21:29.013

GPU 适用于数据并行计算。换句话说，相同的指令但在不同的数据集上。在每个周期，GPU 运行一组有限的线程。但在这种情况下，一组线程（32 个线程 = warp）执行加载/存储操作，这将需要访问全局内存并因此产生延迟，另一组线程可以在前一组等待其数据时执行。因此，关键词*很多数据元素*。GPU 上的延迟容限是通过拥有许多可供其支配的线程来完成的，这样在长时间延迟操作的情况下，可以执行另一批线程。

但是，我不认为它暗示不将预先计算的结果存储在 GPU 中，如果它们将用于其他计算。在矩阵乘法的情况下，乘积矩阵中的元素共享公共操作数，当这些操作数存储在共享内存中时，性能会得到提升，因为它是每个多处理器的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-10T17:11:26.923

延迟隐藏是一个概念，您可以隐藏正在进行的计算活动背后的数据负载：您发出对将来需要的数据的请求，并在等待它时计算其他内容。CUDA 可以轻松隐藏延迟，因为它可以在线程之间快速切换。所以一个线程发出一个数据请求，它阻塞等待该数据，但核心可以立即切换到另一个线程的执行，该线程确实有它的数据。

为此，您当然需要大量计算才能在两者之间进行切换。但是，由于数据传输比实际计算中使用的数据慢，因此您需要比数据加载更多的计算才能发生这种隐藏。这就是计算强度的定义：每个字节/字/数字加载的操作比率很高。

我不认为这与预计算有任何关系，尽管您可以通过重新计算某些部分结果（从本地仍然可用的数据）来考虑更高的算术强度，如果这样可以为您节省一些来自较慢内存的数据加载。

# javascript - Ember.js 隐藏了一个带有按钮的分隔线，但保留了 didInsertElement 功能

> ID：14553821
> 
> 赞同：1
> 
> 时间：2013-01-28T00:14:42.940
> 
> 标签：javascript, ember.js

我正在尝试显示和隐藏一些按钮，`Ember.js`如下所示。

```
{{#view App.myView contentBinding="App.myObject"}

<div id="my_widget" class="well span3">                                                                                 
{{#if content.isConditionTrue}}                                         
  <button id="stop_button" class="btn btn-primary"> Stop </button>                                              
  <button id="start_button" class="btn btn-primary" > Start </button>
  <button id="record_button" class="btn btn-primary">Record </button>
</div>                                            
{{else}}                                            
  <div id="widget_warning_box" class="well">                                                  
    <p> No cameras are open, open a camera in Add/Remove Cameras tab. </p>                                          
  </div>
{{/if}}                                         
</div>
{{/view}} 
```

和视图看起来像：

```
App.myView = Ember.View.Extend({
   didInsertElement: function() {
      $record = $("#record_button")
      $start = $("#start_button")
      $stop = $("#stop_button")

      $record.click(function(){
           console.log("record clicked")
           });

      $start.click(function(){
           console.log("start clicked")
           });
   }); 
```

myObject 控制器是

```
 App.myObject = Ember.Object.create({
      isConditionTrue : false;
  }); 
```

这种作品（按钮被替换为文本 if `myObject.isConditionTrue`is `false`，并在`isCondionTrue`is时出现`true`）但是当显示按钮时，它们在点击时没有任何功能。我猜是因为在调用 didInsertElement 时它们不在 DOM 中。那么，有没有办法解决这个问题？我应该进行子/父视图设置吗？任何指针表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T02:34:37.897

好吧，我绝对不是那种能说出正确方法的人，因为我也只是在学习 ember，但这是我在小提琴上的工作方法

[http://jsfiddle.net/drulia/zkPQt/](http://jsfiddle.net/drulia/zkPQt/)

基本上每次您切换`myObject.isConditionTrue`到 时`false`，ember 都会从 DOM 中删除您的按钮，这就是您的 jQuery 选择器停止工作的原因。我附加了 ember js {{action}} 助手并放置了响应 myObject 中事件的函数，现在按钮正在工作并在屏幕上显示操作结果。

# java - 无效输入验证后如何开始循环？

> ID：14553824
> 
> 赞同：0
> 
> 时间：2013-01-28T00:15:35.230
> 
> 标签：java, arrays, validation

我正在编写一个程序，该程序接受五个学生的用户输入和每个学生的四个测试分数并将它们放入数组中。然后它平均学生的分数并给出一个字母等级。该程序还需要一个不接受低于 0 和超过 100 的分数的输入验证。

到目前为止，我的程序验证了用户并告诉他们输入了无效的数字，但我也希望它在用户输入无效的数字后提示用户重新开始。正如您将在下面看到的（在方法中），我尝试了几个不同的选项`enterData`，但没有一个会强制用户重新开始。有什么建议么？

```
import java.util.Scanner;

public class GradeBook {
    private String[] names = new String[5];

    private char[] grades = new char[5];

    private double[] scores1 = new double[5];
    private double[] scores2 = new double[5];
    private double[] scores3 = new double[5];
    private double[] scores4 = new double[5];
    private double[] scores5 = new double[5];

    int studentData = 0;
    int studentCount = 0;

    Scanner keyboard = new Scanner(System.in);

    public void enterData() {
        do {
            System.out.println("Enter the student's name:");
            String student = keyboard.nextLine();

            System.out.println("Enter the student's first test score");
            double score1 = Double.parseDouble(keyboard.nextLine());
            if (score1 > 0 || score1 < 100) {
            } else {
                System.out.println("Invalid number");
                continue;
            }

            System.out.println("Enter the student's second test score");
            double score2 = Double.parseDouble(keyboard.nextLine());
            if (score2 > 0 || score2 < 100) {
            } else {
                System.out.println("Invalid number");
                System.out.println("Please start over");
                continue;
            }

            System.out.println("Enter the student's third test score");
            double score3 = Double.parseDouble(keyboard.nextLine());
            if (score3 < 0 || score3 > 100)
                System.out.println("Invalid number");

            System.out.println("Enter the student's fourth test score");
            double score4 = Double.parseDouble(keyboard.nextLine());
            if (score4 < 0 || score4 > 100)
                System.out.println("Invalid number");

            addStudent(student, score1, score2, score3, score4);
            studentData++;
        } while (studentData < 5);
    }

    public String toString() {
        StringBuilder printout = new StringBuilder();
        for (int i = 0; i < names.length; i++) {
            if (names[i] == null)
                continue;
            printout.append("Student name: " + names[i] + "\t" + "Average test score: " +
                    getAverage(i) + "\t" + "Grade: " + grades[i] + "\n");
        }
        return printout.toString();
    }

    private void addStudent(String inName, double scr1, double scr2, double scr3, double scr4) {

        names[studentCount] = inName;
        scores1[studentCount] = scr1;
        scores2[studentCount] = scr2;
        scores3[studentCount] = scr3;
        scores4[studentCount] = scr4;
        grades[studentCount] = getLetterGrade(studentCount);
        studentCount++;
    }

    private double getAverage(int index) {
        double score1 = scores1[index];
        double score2 = scores2[index];
        double score3 = scores3[index];
        double score4 = scores4[index];
        double average = (score1 + score2 + score3 + score4) / 4.0;
        return average;
    }

    private char getLetterGrade(int index) {
        double average = getAverage(index);
        char grade;

        if (average >= 90)
            grade = 'A';
        else if (average >= 80)
            grade = 'B';
        else if (average >= 70)
            grade = 'C';
        else if (average >= 60)
            grade = 'D';
        else
            grade = 'F';

        return grade;
    }

} 
```

我使这比需要的更困难。这工作得很好。

```
 System.out.println("Enter the student's third test score");
    double score3 = Double.parseDouble(keyboard.nextLine());          
      while (score3 < 0 || score3 > 100)
      {
          System.out.println("Invalid score, plese reenter");
          System.out.println("Enter the student's third test score");
        score3 = Double.parseDouble(keyboard.nextLine());
      } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T00:22:01.167

好吧，我知道一种使用 JOptionPanes 的方法：

```
int n = JOptionPane.showConfirmDialog(null,
        "Would you like to start over?",
        "Incorrect Input",
        JOptionPane.YES_NO_OPTION);

if(n == JOptionPane.YES_OPTION)
{
    //start over
}
else
{
    System.exit(0);
} 
```

我猜这在 System 类中是什么等价物。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T00:29:30.227

您要做的是流量控制。最简单的方法是：

1）让你的方法返回一个布尔值。如果方法正确退出（所有数据输入） return `true`，如果方法必须错误退出（如本例），则返回`false`（在本例中，从`if`控制条件的内部。

2) 如果方法发现错误，则抛出异常。

在这两种情况下，调用您的方法的逻辑都必须检查抛出的返回值/异常，并在需要时再次调用该方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T20:53:24.693

```
System.out.println("Enter the student's third test score");
double score3 = Double.parseDouble(keyboard.nextLine());          
  while (score3 < 0 || score3 > 100)
  {
      System.out.println("Invalid score, plese reenter");
      System.out.println("Enter the student's third test score");
    score3 = Double.parseDouble(keyboard.nextLine());
  } 
```

# java - 参数内部和块内部的短/字节有什么区别

> ID：14553825
> 
> 赞同：2
> 
> 时间：2013-01-28T00:15:52.937
> 
> 标签：java, compiler-construction, compiler-optimization, short

> **可能重复：**
> [Eclipse 错误？什么时候短不是短？](https://stackoverflow.com/questions/14297113/eclipse-bug-when-is-a-short-not-a-short)

在 Java 中，我可以像这样分配一个`short`或一个`byte`内部块：

```
short s = 20000;
byte  b = 120; 
```

因为 20000 是一个`short`值，而 120 是一个`byte`值，所以如果我尝试尝试：

```
short s = 67000;
byte  b = 128; 
```

我会收到一个错误，指出它无法从`int`哪里`byte`编译

```
byte b = (byte)12232; 
```

甚至不会触发价值可能丢失的警告。在函数调用中，无论如何我都不得不强制转换它：

```
void test(short s){}
test(1) //invalid
test((short)1) //valid 
```

在`return`类型上它又可以了。

```
short test(){
    return 1; //valid
} 
```

为什么编译器有时想知道数字的范围（至少从常量中），而它似乎在别处忘记了它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T00:25:26.333

Java 中的整型数字文字只有两种：（`int`声明为`123`）和`long`（声明为`123L`）。

*   `short s = 1`是允许的，因为它是一个赋值，并且在那里允许一个狭义的转换
*   `short s = 67000`不起作用，因为您超出了可以用 a 表示的最大值`short`
*   `short s = (short)67000`有效，因为您要进行强制转换，因此您明确要求类型检查器忽略 67000 超过最大值的事实
*   `test(1)`不起作用，因为它是一个方法调用，不允许窄转换（int -> short）并且`1`总是被编译器评估为整数文字

# javascript - 花括号上的 JS 正则表达式

> ID：14553826
> 
> 赞同：1
> 
> 时间：2013-01-28T00:15:55.320
> 
> 标签：javascript, regex

我有一个示例语句：

```
"function(){var x=0;if(true){var y=0;}}" 
```

我尝试了很多表达式，但它们只返回`"{var y=0;}"`

我想提取以下结果：

```
["{var x=0;if(true){var y=0;}}","{var y=0;}"] 
```

什么是最好的正则表达式？

我只使用 JavaScript，所以不可能进行后向搜索。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T13:44:30.080

我刚刚使用 JS Regex 测试器测试了以下内容，它似乎可以工作：

*   图案 -`({.*((?={).*(?:})).*})`

*   测试字符串 - “function(){var x=0;if(true){var y=0;}}”

*   正则表达式工具 - [http://www.regextester.com/index2.html](http://www.regextester.com/index2.html)

此正则表达式仅适用于 2 个嵌套大括号，可能不适用于 3 个或更多，但正则表达式可以相应调整。

亲切的问候，

    亚龙·沙赫拉巴尼。

# c# - 如何在 C# 中创建 xml 或 json 数据并将其作为 Web 服务返回？

> ID：14553828
> 
> 赞同：1
> 
> 时间：2013-01-28T00:16:05.117
> 
> 标签：c#, asp.net, xml, json, web-services

我正在创建一个 C# ASP.NET Web 服务应用程序。我需要从 SQL 数据库访问数据并将这些数据作为 XML 或 JSON 返回。当您运行 HelloWorld 方法（参见下面的代码）时，它会以 XML 格式返回数据。但我需要从 SQL 数据中制作自己的 XML 标记。这是怎么做到的？

此外，如何让 Web 服务使用 JSON，而不是 XML？

例如，假设我从 SQL 返回一个包含 2 行和 2 列的表集，并将其格式化为 XML：

```
<returnSet>
  <row1>
    <FirstName>
      David
    </FirstName>
    <LastName>
      Faustino
    </LastName>
  </row1>
  <row2>
    <FirstName>
      Henry
    </FirstName>
    <LastName>
      Irons
    </LastName>
  </row2>
</returnSet> 
```

非常感谢您提供的任何帮助。

**更新**

我修改了下面的代码以包含返回的 JSON。问题是当我调试应用程序并单击该方法时，它仍然显示 XML：

```
<?xml version="1.0" encoding="utf-8" ?>
<string xmlns="http://tempuri.org/">"Hello World"</string> 
```

我的期望是编写下面的代码，然后转到 Debug => Start Debugging。单击*HelloWorld*，瞧，它以 JSON 的形式返回数据。我在其他地方看到有些人使用 jQuery 或纯 JavaScript 调用它。这是测试它返回 JSON 数据的唯一方法吗？

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Services;
using System.Web.Script.Services;
using System.Web.Script.Serialization;

namespace WebApplication2
{
    /// <summary>
    /// Summary description for WebService1
    /// </summary>
    [WebService(Namespace = "http://tempuri.org/")]
    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
    [System.ComponentModel.ToolboxItem(false)]
    // To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
    [System.Web.Script.Services.ScriptService]
    public class WebService1 : System.Web.Services.WebService
    {

        [WebMethod]
        [ScriptMethod(ResponseFormat = ResponseFormat.Json)]
        public string HelloWorld()
        {

            JavaScriptSerializer js = new JavaScriptSerializer();

            return js.Serialize("Hello World");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T07:43:28.880

您可以在 HelloWorld 方法的 [WebMethod] 下方添加另一个属性来获取 json：

```
[ScriptMethod(ResponseFormat = ResponseFormat.Json)] 
```

# c# - 为进程设置环境变量

> ID：14553830
> 
> 赞同：53
> 
> 时间：2013-01-28T00:16:13.260
> 
> 标签：c#, windows, environment-variables, processstartinfo

什么是环境变量概念？

在 C# 程序中，我需要调用一个可执行文件。该可执行文件将调用驻留在同一文件夹中的其他一些可执行文件。可执行文件依赖于两个环境变量“PATH”和“RAYPATH”来正确设置。我尝试了以下两件事：

1.  我创建了一个进程并在 StartInfo 中设置了两个变量。变量已经存在，但缺少所需的信息。
2.  我尝试使用 System.Environment.SetEnvironmentVariable() 设置变量。

当我运行该进程时，系统找不到可执行文件（“executable1”）。我试图将 StartInfo.FileName 设置为“executeable1”的完整路径 - 但是在“executeable1”中找不到名为 form 的 EXE 文件......

我该如何处理？

```
string pathvar = System.Environment.GetEnvironmentVariable("PATH");
System.Environment.SetEnvironmentVariable("PATH", pathvar + @";C:\UD_\bin\DAYSIM\bin_windows\;C:\UD_\bin\Radiance\bin\;C:\UD_\bin\DAYSIM;");
System.Environment.SetEnvironmentVariable("RAYPATH", @"C:\UD_\bin\DAYSIM\lib\;C:\UD_\bin\Radiance\lib\");

System.Diagnostics.Process p = new System.Diagnostics.Process();
p.StartInfo.WorkingDirectory = @"C:\UD_\bin\DAYSIM\bin_windows";

//string pathvar = p.StartInfo.EnvironmentVariables["PATH"];
//p.StartInfo.EnvironmentVariables["PATH"] = pathvar + @";C:\UD_\bin\DAYSIM\bin_windows\;C:\UD_\bin\Radiance\bin\;C:\UD_\bin\DAYSIM;";
//p.StartInfo.EnvironmentVariables["RAYPATH"] = @"C:\UD_\bin\DAYSIM\lib\;C:\UD_\bin\Radiance\lib\";

p.StartInfo.UseShellExecute = false;
p.StartInfo.RedirectStandardOutput = true;
p.StartInfo.CreateNoWindow = true;

p.StartInfo.FileName = "executeable1";
p.StartInfo.Arguments = arg1 + " " + arg2;
p.Start();
p.WaitForExit(); 
```

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2013-01-29T12:29:29.887

你的问题究竟是什么？`System.Environment.SetEnvironmentVariable`改变**当前进程**的环境变量。如果您想更改您创建的流程的变量，只需使用`EnvironmentVariables`字典属性：

```
var startInfo = new ProcessStartInfo();

// Sets RAYPATH variable to "test"
// The new process will have RAYPATH variable created with "test" value
// All environment variables of the created process are inherited from the
// current process
startInfo.EnvironmentVariables["RAYPATH"] = "test";

// Required for EnvironmentVariables to be set
startInfo.UseShellExecute = false;

// Sets some executable name
// The executable will be search in directories that are specified
// in the PATH variable of the current process
startInfo.FileName = "cmd.exe";

// Starts process
Process.Start(startInfo); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-11-01T13:32:43.303

有许多类型的环境变量，例如系统级别和用户。这取决于您的要求。

要设置环境变量，只需使用 Get Set 方法。将变量名称和值作为参数传递，如果用于定义访问级别，则必须与它一起传递。要访问该值，请使用 Set 方法也传递访问级别参数。

例如，我正在定义用户级变量：

```
//For setting and defining variables
System.Environment.SetEnvironmentVariable("PathDB", txtPathSave.Text, EnvironmentVariableTarget.User);
System.Environment.SetEnvironmentVariable("DBname", comboBoxDataBaseName.Text, EnvironmentVariableTarget.User);

//For getting
string Pathsave = System.Environment.GetEnvironmentVariable("PathDB", EnvironmentVariableTarget.User);
string DBselect = System.Environment.GetEnvironmentVariable("DBname", EnvironmentVariableTarget.User); 
```

# scala - Lift：如何使用设计师友好的模板构建表单？

> ID：14553835
> 
> 赞同：3
> 
> 时间：2013-01-28T00:16:50.313
> 
> 标签：scala, lift

作为测试，我正在尝试使用设计人员友好的模板在电梯中创建一个表单。我正在使用电梯 2.5

我已经设法使用 toForm 创建了一个工作表单，但我只是在探索所有可能的方法。

我的 html 文件包含以下代码：

```
...
<span class="lift:Util.entry?form=post">
  <span id="etitle"></span>
  <span id="ebody"></span>
  <span id="esubmit"></span>
</span>
... 
```

在我的 Util.scala 中，我定义了如下的条目片段：

```
def entry = {
  "#etitle *" #> SHtml.text(title, title = _)
  "#ebody *" #> SHtml.text(body, body = _)
  "#submit *" #> SHtml.submit("Save", saveEntry)
} 
```

所有的跨度都是空的；我究竟做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-28T09:27:00.897

您是否忘记将转换 ( `#>`) 与 & 符号 ( `&`) 合并？

```
def entry = {
  "#etitle *" #> SHtml.text(title, title = _) &
    "#ebody *" #> SHtml.text(body, body = _) &
    "#esubmit *" #> SHtml.submit("Save", saveEntry)
} 
```

# javascript - 带有 ID 的 Sharepoint NewForm 重定向

> ID：14553840
> 
> 赞同：1
> 
> 时间：2013-01-28T00:17:35.747
> 
> 标签：javascript, sharepoint-2010, sharepoint-designer

当我将新项目添加到列表中时，保存时我需要重定向到另一个带有刚刚添加的项目 ID 值的表单。通过 URL 发送。我已经从编辑表单或显示表单中看到了如何做到这一点的帖子，其中 id 已经存在。但这是来自新形式。谢谢你。

更新：或者如果这很难，我怎样才能获得该列表中的最后一个 ID？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T00:32:52.820

我在这里使用了这个解决方案。您只需要更改列表名称。 [http://sympmarc.com/2009/06/12/redirect-to-another-page-from-newform-aspx-with-the-new-items-id/](http://sympmarc.com/2009/06/12/redirect-to-another-page-from-newform-aspx-with-the-new-items-id/)

# jquery - 选择带有文本链接的选项卡

> ID：14553845
> 
> 赞同：0
> 
> 时间：2013-01-28T00:18:16.083
> 
> 标签：jquery, html, tabs

我有一个关于选项卡脚本（不是 jquery ui 选项卡）的问题。我想在页面顶部选择带有普通文本链接的选项卡。选项卡位于页面底部。我希望这可以通过锚来实现，但没有......

链接：

```
<a class="reviewslink" href="#reviews">blabla</a> 
```

单击选项卡本身的脚本：

```
$('.tabs a').click(function(){
        var tabs = $(this).closest('.tabs');
        var pages = tabs.next();
        tabs.find('a').closest('li').removeClass('active');
        pages.find('.page').removeClass('active');
        $(this).closest('li').addClass('active');
        pages.find('.page.'+$(this).attr('rel')).addClass('active');
        return false;
    }); 
```

的HTML：

```
<div class="tabs">
          <ul>
            <li class="active"><a rel="bestellen" href="#">Test</a></li>
            <li><a rel="ruilen" href="#" name="maattabel">Test1</a></li>
          </ul>
        </div>

        <div class="tabsPages">
         <div class="page bestellen active"></div>
         <div class="page ruilen"></div>
        </div> 
```

我在下面尝试了这个，但这不起作用，很明显。我不知道该怎么做。

```
 $('.reviewslink').click(function() { // bind click event to link

        var tabs = $(this).closest('.tabs');
        var pages = tabs.next();
        tabs.find('a').closest('li').removeClass('active');
        pages.find('.page').removeClass('active');

        tabs.select('select', 3).addClass('active');
        pages.find('.page.reviews.'+$(this).attr('rel')).addClass('active');

        return false;
  }); 
```

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T21:19:11.140

示例 HTML 并不完整和/或一致，但我想我理解你想要做什么。如何将点击事件发送到选项卡？

```
$('.reviewslink').click(function() {
    var name = $(this).attr('href').substr(1);
    var tab = $('a[name=' + name + ']');
    tab.click();
    return false;
} 
```

要使此代码正常工作，您需要添加`name="reviews"`到`a`单击链接时要选择的选项卡元素。

# c++ - 如果在并行部分执行会引发错误？

> ID：14553846
> 
> 赞同：2
> 
> 时间：2013-01-28T00:18:16.623
> 
> 标签：c++, exception, c++11, parallel-processing, stdthread

在我的代码中，我有一个使用静态随机引擎生成器运行的函数，如果用户尝试从与主线程不同的线程调用此函数，我希望能够抛出错误。

例如，如果您考虑以下功能：

```
void f()
{
    if (/* SOMETHING */) {
        throw std::future_error("ERROR = f() : cannot be executed in parallel");
    }
} 
```

会是`/* SOMETHING */`什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T00:23:03.130

我在线程方面不是很有经验，但不知何故我很想按照单例/其他设计模式做一些事情。

话虽这么说，我不相信这个想法很优雅，我不知道你为什么要这样做，所以我不知道如何提出任何替代方案......

虽然我确实认为可以在 main 中创建一个单例，这样就可以防止任何从其他线程调用 f 的尝试。

单身人士通常被滥用，所以......我会小心的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-28T12:43:14.140

尽管我认为您要实现的目标不是很优雅（锁定或保存每个线程的随机引擎生成器的状态，例如使用线程本地存储可能会更好），但这里有一个解决您所要求的解决方案：

```
static const auto mainThreadId = std::this_thread::get_id();

void f()
{
    if (std::this_thread::get_id() != mainThreadId) {
        throw std::future_error("ERROR = f() : cannot be executed in parallel"
            "/from a thread other than the main one");
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-28T23:39:17.420

一个非常非常好的解决方案是让您检索随机数是线程安全的。

这可以通过以下两种方式之一完成：

1.  在检索随机数时获取[互斥锁。](http://en.cppreference.com/w/cpp/thread/mutex)
2.  给任何需要生成随机数的线程自己的随机对象。

**让我们谈谈#1。**[由于您建议包装调用以获取随机数，因此使用 mutex 包装这些调用并](http://en.cppreference.com/w/cpp/thread/lock_guard)不太牵强。我们不是简单地在运行时将问题呈现给用户（这通常是一个非常糟糕的开发选择），而是解决了这个问题。唯一的缺点是我们减慢了对随机数生成器的调用速度——这可能是可以接受的，但如果不是……请选择选项#2。

**而且，对于＃2 ...**您说这是一个*静态*随机数生成器。也许这意味着您不能再制作它的副本，但这无论如何都值得一提。[`rand`](http://en.cppreference.com/w/cpp/numeric/random/rand)并且[`srand`](http://en.cppreference.com/w/cpp/numeric/random/srand)是这样的。但是，如果您使用的是 C++11 之类的东西[`std::uniform_int_distribution`](http://en.cppreference.com/w/cpp/numeric/random/uniform_int_distribution)，那么为每个线程创建一个副本应该没有问题。（也许考虑[`std::thread_local`](http://en.cppreference.com/w/c/thread/thread_local)一下你是否找不到放置每个线程副本的好地方。）

# sql-server - Visual Studio 2012 项目是否需要 4.5 托管？

> ID：14553847
> 
> 赞同：0
> 
> 时间：2013-01-28T00:18:26.960
> 
> 标签：sql-server, visual-studio, hosting, asp.net-4.5

Visual Studio 2012 项目是否需要 4.5 托管？我也在使用 2012 SQL Server。这是否需要 4.5 框架进行托管？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T00:21:17.310

这取决于您的项目的设置。在 VS2012 中，在 Project --> Properties 对话框中，您可以设置目标框架版本。根据您正在做的事情，您可能需要也可能不需要完整的 4.5 框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T00:25:58.973

不，您不需要 .NET 4.5 - 您可以通过转到项目 -> 属性来选择所需的框架版本。SQL Server 似乎只依赖于 .NET 4（不是 .NET 4.5）

![在此处输入图像描述](../Images/2c7a1f3dee7ab8c47304ef0d725de616.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-28T00:32:39.990

不，除非您的项目使用 .NET Framework 4.5

# ruby-on-rails-3 - Ruby on rails + Tiny TDS 未连接到 sql epxress

> ID：14553851
> 
> 赞同：1
> 
> 时间：2013-01-28T00:18:52.653
> 
> 标签：ruby-on-rails-3, ruby-on-rails-3.2, tiny-tds

我正在尝试让 Rails 应用程序连接到 SQL Express 实例。我在windows环境下工作。

我不想设置 DSN，所以我选择了 Tindy TDS。不幸的是，我无法让它工作。

当我执行

```
rake db:migrate 
```

我懂了

```
rake db:migrate
rake aborted!
closed connection
C:/site/config/environment.rb:5:in `<top (required)>'
Tasks: TOP => db:migrate => environment
(See full trace by running task with --trace) 
```

当我运行跟踪时，我看到

```
** Invoke db:migrate (first_time)
** Invoke environment (first_time)
** Execute environment
rake aborted!
closed connection
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activerecord-sqlserver-adapter-3.2.10/lib/active_record/connection_adapters/sqlserver_adap
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activerecord-sqlserver-adapter-3.2.10/lib/active_record/connection_adapters/sqlserver_adap
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activerecord-sqlserver-adapter-3.2.10/lib/active_record/connection_adapters/sqlserver_adap
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activerecord-sqlserver-adapter-3.2.10/lib/active_record/connection_adapters/sqlserver_adap
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activerecord-sqlserver-adapter-3.2.10/lib/active_record/connection_adapters/sqlserver_adap
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activerecord-sqlserver-adapter-3.2.10/lib/active_record/connection_adapters/sqlserver_adap
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activerecord-sqlserver-adapter-3.2.10/lib/active_record/connection_adapters/sqlserver_adap
'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/connection_pool.rb:315:
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/connection_pool.rb:325:
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/connection_pool.rb:247:
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/connection_pool.rb:242:
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/connection_pool.rb:242:
C:/Ruby193/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/connection_pool.rb:239:
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/connection_pool.rb:102:
C:/Ruby193/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/connection_pool.rb:101:
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/connection_pool.rb:410:
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/connection_specificatio
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/connection_specificatio
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activerecord-3.2.11/lib/active_record/model_schema.rb:308:in `clear_cache!'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activerecord-3.2.11/lib/active_record/railtie.rb:97:in `block (2 levels) in <class:Railtie
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.11/lib/active_support/callbacks.rb:418:in `_run__107948286__prepare__477
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.11/lib/active_support/callbacks.rb:405:in `__run_callback'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.11/lib/active_support/callbacks.rb:385:in `_run_prepare_callbacks'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.11/lib/active_support/callbacks.rb:81:in `run_callbacks'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/actionpack-3.2.11/lib/action_dispatch/middleware/reloader.rb:74:in `prepare!'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/actionpack-3.2.11/lib/action_dispatch/middleware/reloader.rb:48:in `prepare!'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/application/finisher.rb:47:in `block in <module:Finisher>'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/initializable.rb:30:in `instance_exec'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/initializable.rb:30:in `run'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/initializable.rb:55:in `block in run_initializers'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/initializable.rb:54:in `each'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/initializable.rb:54:in `run_initializers'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/application.rb:136:in `initialize!'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/railtie/configurable.rb:30:in `method_missing'
C:/rorblog/rorblog/config/environment.rb:5:in `<top (required)>'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:251:in `require'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:251:in `block in require'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:236:in `load_dependency'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:251:in `require'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/application.rb:103:in `require_environment!'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/application.rb:297:in `block (2 levels) in initialize_tasks'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:228:in `call'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:228:in `block in execute'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:223:in `each'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:223:in `execute'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:166:in `block in invoke_with_call_chain'
C:/Ruby193/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:159:in `invoke_with_call_chain'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:187:in `block in invoke_prerequisites'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:185:in `each'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:185:in `invoke_prerequisites'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:165:in `block in invoke_with_call_chain'
C:/Ruby193/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:159:in `invoke_with_call_chain'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:152:in `invoke'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:143:in `invoke_task'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:101:in `block (2 levels) in top_level'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:101:in `each'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:101:in `block in top_level'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:110:in `run_with_threads'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:95:in `top_level'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:73:in `block in run'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:160:in `standard_exception_handling'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:70:in `run'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.0.3/bin/rake:33:in `<top (required)>'
C:/Ruby193/bin/rake:23:in `load'
C:/Ruby193/bin/rake:23:in `<main>'
Tasks: TOP => db:migrate => environment 
```

我的 database.yml 是

```
development:
  adapter: sqlserver
  database: MyDatabase
  dataserver: localhost\SQLEXPRESS
  mode: dblib
  username: sa
  password: "1234" 
```

在跟踪文件中，我看到“缺少方法”，但不知道这是问题所在还是其他原因。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-01-28T01:34:26.470

更新了我的 environment.rb 文件以添加错误捕获

```
begin
  MySite::Application.initialize!
rescue Exception => ex
  puts '--------------------'
  puts ex.message
  puts '--------------------'
end 
```

我可以看到 TinyTDS 出现错误

```
--------------------
Unable to connect: Adaptive Server is unavailable or does not exist
-------------------- 
```

所以现在我必须弄清楚这一点。

# html - 使用 jQuery 展开时，浮动到左侧的框会被推到右侧

> ID：14553853
> 
> 赞同：0
> 
> 时间：2013-01-28T00:19:17.467
> 
> 标签：html, css

我可以解释这一点的最好方法是使用 JSFiddle 示例：http: [//jsfiddle.net/8tXku/](http://jsfiddle.net/8tXku/)

我将每个`.project`div 浮动到左侧并使用一些简单的 jQuery 使它们在单击时展开以显示描述，但是如果单击第一个项目，它会将第三个项目推到右侧，因为它占用了太多空间扩大。

有没有办法让第三个项目 div 优雅地向下移动带有扩展内容的页面，而不是向右移动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T00:44:47.530

这可能是一个肮脏的解决方案，但它的效果很好。

给`.project-description`a`position:absolute;`将允许它在`.slideDown()`不影响周围环境的情况下`divs`，但必须进行一些其他调整。

我添加`position:relative;`到，`.project`以便每个`.project-description`都包含在其中。

**最终的 CSS**

```
.project {
    width: 250px;
    float: left;
    border: 1px solid #dedede;
    border-radius: 6px;
    -webkit-box-shadow: 0px 0px 20px rgba(50, 50, 50, 0.4);
    -moz-box-shadow:    0px 0px 20px rgba(50, 50, 50, 0.4);
    box-shadow:         0px 0px 20px rgba(50, 50, 50, 0.4);
    margin-right: 30px;
    margin-bottom: 30px;
position:relative;
}

.project-description {
    padding: 5px;
    font-size: 12px;
    display: none;
    position:absolute;
    background-color:white;
    left:0;
    right:0;
    z-index:99;
} 
```

看看这个：http: [//jsfiddle.net/AliBassam/N4U3R/](http://jsfiddle.net/AliBassam/N4U3R/)

**更新**

当`.project-description`包含大文本（显然）时，它将隐藏在底部 div 下，只需添加`z-index:99;`到`.project-description`

看看这个：http: [//jsfiddle.net/AliBassam/pMGDZ/](http://jsfiddle.net/AliBassam/pMGDZ/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T00:48:48.050

用这个替换`.project-description`当前样式

```
.project-description {
    padding: 5px;
    font-size: 12px;
    display: none;
    position: absolute;
    -webkit-box-shadow: 0px 0px 20px rgba(50, 50, 50, 0.4);
    -moz-box-shadow: 0px 0px 20px rgba(50, 50, 50, 0.4);
    box-shadow: 0px 0px 20px rgba(50, 50, 50, 0.4);
    width:325px;
    border-radius: 0 0 6px 6px;
    background: #FFFFFF;
    z-index: 1;    
} 
```

**演示：http:** [//jsfiddle.net/enve/8tXku/4/](http://jsfiddle.net/enve/8tXku/4/)

# linux - 在 linux 中使用音频输出监视程序

> ID：14553855
> 
> 赞同：1
> 
> 时间：2013-01-28T00:19:21.460
> 
> 标签：linux, audio, watch

我想观看输出音频的程序。基本上，我尝试制作一个系统，让 VLC 在后台运行，如果我在 Firefox 中启动视频，VLC 会自动静音。有人知道怎么做吗？我猜一个相当于命令行的命令行`pavucontrol`会很酷。

但是当有多个输出音频的进程时，一个脚本或二进制文件会做一些事情会非常酷。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T03:04:22.283

[PulseAudio D-Bus 接口](http://www.freedesktop.org/wiki/Software/PulseAudio/Documentation/Developer/Clients/DBus)的`NewPlaybackStream`信号将让您知道另一个应用程序何时开始播放（或技术上当它们连接到 PulseAudio 服务器时，通常用于播放音频），而.`PlaybackStreamRemoved`

# google-maps-api-3 - Google Maps Api V3 风格地图

> ID：14553861
> 
> 赞同：0
> 
> 时间：2013-01-28T00:21:04.247
> 
> 标签：google-maps-api-3

我在实现 Google Maps APi 样式的地图时遇到了一点麻烦，我可以通过删除 var 样式和 map.setoptions 来使位置和自定义标记正常工作）但是当我尝试将 google 样式编码重新添加到地图中时不再有效，有什么想法吗？

```
<script type="text/javascript">
      function initialize() {
        var styles = [ 
          { 
          featureType: "water", 
          elementType: "geometry.fill",
          stylers: [ 
            { color: "#73b6e6" }
            ] 
            },{
          featureType: "road.highway",
          elementType: "geometry.fill",
          stylers: [ 
            { color: "#ffffff" } 
            ] 
            },{
          featureType: "road.highway",
          elementType: "geometry.stroke",
          stylers: [
            { color: "#c8c8c8" }
            ] 
            },{
          featureType: "road.local",
          stylers: [ 
            { color: "#ffffff" } 
            ] 
            },{
          featureType: "road.arterial",
          elementType: "geometry.fill", 
          stylers: [ 
            { color: "#ffffff" } 
            ] 
            },{
          featureType: "road.arterial",
          elementType: "geometry.stroke",
          stylers: [ 
            { color: "#c8c8c8" } 
            ] 
            },{
          featureType: "road.highway",
          elementType: "labels.text.stroke",
          stylers: [ 
            { visibility: "off" } 
            ] 
            },{
          featureType: "road.arterial", 
          elementType: "labels.text.stroke",
          stylers: [ { visibility: "off" } 
            ] 
            },{
          featureType: "poi",
          elementType: "labels",
          stylers: [ { "visibility": "off" } 
            ] 
            },{
          featureType: "poi.park",
          stylers: [ { color: "#cae6a9" } 
            ] 
            },{
          featureType: "administrative.neighborhood",
          elementType: "labels.text.fill",
          stylers: [ { "visibility": "off" } 
            ] 
            }
        ];
        map.setOptions({styles: styles});
        var mapOptions = {
          center: new google.maps.LatLng(-34.94533,138.58934),
          zoom: 14,
          scrollwheel: false,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var map = new google.maps.Map(document.getElementById("location-map"),
            mapOptions);
        var image = 'images/main/location.png';
        var myLatLng = new google.maps.LatLng(-34.94533,138.58934);
        var beachMarker = new google.maps.Marker({
            position: myLatLng,
            map: map,
            icon: image
        });
      };
    </script> 
```

HTML 代码

```
<div id="location-map" style="background-color: #E5E3DF; overflow: hidden;">
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T00:24:58.690

map var 在您创建之前不存在，但您在此行之前调用 map.setOptions：

```
var map = new google.maps.Map(document.getElementById("location-map"),
            mapOptions); 
```

只需移动这一行：

```
map.setOptions({styles: styles}); 
```

在这个之后：

```
var map = new google.maps.Map(document.getElementById("location-map"),
            mapOptions); 
```

# php - MongoDB 聚合在 PHP 中不起作用（或非常慢）并且在 shell 中完美运行？

> ID：14553862
> 
> 赞同：1
> 
> 时间：2013-01-28T00:21:13.320
> 
> 标签：php, mongodb, aggregation-framework

我正在尝试对我的集合（包含超过 20M 个文档）使用聚合方法。

我首先在 Windows shell 中尝试过：

```
db.data.aggregate([
{$match: {firstname: "Roger"}},
{$group:{"_id":"$id_car",count:{$sum: 1}}},
{$sort: {count: -1}},
{$limit: 50}]) 
```

它运行良好，几秒钟后返回结果。

当我在 PHP 中“翻译”它时：

```
$data = $db->data;
$ops = array(
    array(
         '$match' => array(
             'firstname' => 'Roger'
         )
    ),
    array(
        '$group' => array(
            '_id' => '$id_car',
            'count' => array(
                '$sum' => 1     
            )       
        )
    ),
    array(
        '$sort' => array(
            'count' => -1
        )
    ),
    array(
        '$limit' => 4       
    )
);
$res = $data->aggregate($ops); 
```

我收到超时 PHP 致命错误：

```
Uncaught exception 'MongoCursorTimeoutException' with message 'localhost:27017: cursor timed out (timeout: 30000, time left: 30:0, status: 0)' 
```

我不知道我的 PHP 代码是否出错，或者 PHP 中的聚合应该比 shell 慢得多？

另外，我在“名字”字段上添加了一个索引，以使查询更快。

顺便说一句，有没有办法将这种调用的超时设置为无穷大？

非常感谢你的帮助 ！

乔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-13T18:12:01.920

我真的不知道您的问题（PHP 比 MongoShell 慢），但我所做的允许我在 PHP 中运行聚合（由于超时问题）正在改变我调用聚合的方式。

希望这可以帮助由于超时问题而到达此页面的人，就像我一样！

而不是`$data->aggregate($ops)`我运行以下等效于您的案例：

```
$db->command(
    array('aggregate' => 'data', 'pipeline' => $ops),
    array('timeout' => 100000000)
) 
```

请注意，您必须对`$db`集合而不是您的集合运行命令。

# vba - Word 2007 vba saveas 从页码丢失开始

> ID：14553864
> 
> 赞同：0
> 
> 时间：2013-01-28T00:21:49.970
> 
> 标签：vba, ms-word

在我的文档中，我将 Format Page Numbers / Start at: 设置为 0，以便不计算标题页。

当我通过 VBA 执行 SaveAs 时，文档会丢失该设置！它也丢失了“不同的首页”设置，所以我直接在 VBA 中进行了设置，从而解决了这个问题。我认为，因为我在执行 SaveAs 之前通过 VBA 格式化页脚，所以我会以某种方式影响设置？无论如何，我尝试在 SaveAs 之后设置 Start At 页码，但它没有设置它。

```
 ' Save our new Workbook - the output file
                            ' That makes the new file the ActiveDocument
    ActiveDocument.SaveAs filename:=fname & ".docx", FileFormat:= _
        wdFormatXMLDocument, LockComments:=False, Password:="", AddToRecentFiles _
        :=True, WritePassword:="", ReadOnlyRecommended:=False, EmbedTrueTypeFonts _
        :=False, SaveNativePictureFormat:=False, SaveFormsData:=False, _
        SaveAsAOCELetter:=False

    ' Sets this option correctly
    ActiveDocument.PageSetup.DifferentFirstPageHeaderFooter = True

    ' Problem: Doesnt set this option
    ActiveDocument.Sections(1).Footers(wdHeaderFooterPrimary).PageNumbers.StartingNumber = 0

                            ' Update the TOC
    ActiveDocument.TablesOfContents(1).Update 
```

有任何想法吗？

谢谢，默里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T07:45:44.320

“RestartNumberingAtSection 属性，如果设置为 False，将覆盖 StartingNumber 属性，以便页码可以从上一节继续。” ( [http://msdn.microsoft.com/en-us/library/office/ff821408.aspx](http://msdn.microsoft.com/en-us/library/office/ff821408.aspx) )

因此，您必须将 RestartNumberingAtSection 属性设置为 true：

```
With ActiveDocument.Sections(1)
 .Footers(wdHeaderFooterPrimary).PageNumbers.RestartNumberingAtSection = True
 .Footers(wdHeaderFooterPrimary).PageNumbers.StartingNumber = 0
End With 
```

问候， 狮子座

# ios - 更新 UIImage 方向元数据？

> ID：14553866
> 
> 赞同：12
> 
> 时间：2013-01-28T00:22:08.133
> 
> 标签：ios, nsdictionary

**基本任务：**更新与 UIImage 关联的元数据的 EXIF 方向属性。我的问题是我不知道方向属性在所有 EXIF 信息中的位置。

* * *

**复杂的背景：**我正在更改返回的图像的方向，`imagePickerController:didFinishPickingMediaWithInfo:`所以我认为我还需要在保存图像之前更新元数据`writeImageToSavedPhotosAlbum:(CGImageRef)imageRef metadata:(NSDictionary *)metadata`。

换句话说，除非我更改它，否则元数据将包含旧的/初始方向，因此是错误的。我改变方向的原因是因为当我运行`Core Image`人脸检测例程时它总是让我绊倒。使用前置摄像头在人像模式下使用 iPhone（设备）拍照，方向为`UIImageOrientationRight`(3)。如果我重写图像使方向为`UIImageOrientationUp`（0），我会得到很好的人脸检测结果。作为参考，重写图像的例程如下。

我发现整个相机方向的事情非常令人困惑，我似乎正在将自己更深地挖掘到所有这些代码洞中。我看过帖子（[这里](https://stackoverflow.com/questions/11520209/how-to-update-exif-of-alasset-without-changing-the-image)、[这里](https://stackoverflow.com/questions/5125323/problem-setting-exif-data-for-an-image)和[这里](http://blog.codecropper.com/2011/05/adding-metadata-to-ios-images-the-easy-way/)。根据这篇文章（[https://stackoverflow.com/a/3781192/840992](https://stackoverflow.com/a/3781192/840992)）：

> “相机实际上是横向原生的，所以当你在风景中拍摄照片时你会向上或向下，当你在纵向拍摄照片时你会向左或向右（取决于你拿着设备的方式）。”

...这完全令人困惑。如果上述情况属实，我认为我应该了解前置摄像头`UIImageOrientationLeftMirrored`或`UIImageOrientationRightMirrored`前置摄像头的方向。这些都不能解释为什么`CIDetector`选择器返回的原始图像会失败。

我正在向后接近这个屁股，但我似乎无法定向......

* * *

```
-(UIImage *)normalizedImage:(UIImage *) thisImage
{
    if (thisImage.imageOrientation == UIImageOrientationUp) return thisImage;

    UIGraphicsBeginImageContextWithOptions(thisImage.size, NO, thisImage.scale);
    [thisImage drawInRect:(CGRect){0, 0, thisImage.size}];
    UIImage *normalizedImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    return normalizedImage;
} 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-28T00:36:17.433

看看我的答案：
[强制 UIImagePickerController 以纵向/尺寸 iOS 拍照](https://stackoverflow.com/questions/14484816/force-uiimagepickercontroller-to-take-photo-in-portrait-orientation-dimensions-i/14491293#14491293)

以及[github 上的相关项目](https://github.com/foundry/UIImageMetadata)（您不需要运行该项目，只需查看自述文件）。

它更关心读取而不是写入元数据——但它包括一些关于 Apple 的 imageOrientation 和相应的方向“Exif”元数据的注释。

这可能也值得一读
[在 IOS 6.0 或 iPhone 中上传期间自动旋转的捕获照片](https://stackoverflow.com/questions/13971491/captured-photo-automatically-rotated-during-upload-in-ios-6-0-or-iphone/13974815#13974815)

有两种不同的常数编号约定来指示图像方向。

1.  在 TIFF/IPTC 图像元数据标签中使用的 kCGImagePropertyOrientation 常量
2.  UIImage imageOrientation 属性使用的 UIImageOrientation 常量。

iPhone 的原生相机方向是横向左侧（右侧带有主页按钮）。原生像素尺寸始终反映这一点，旋转标志用于根据显示方向正确定位图像。

```
Apple            UIImage.imageOrientation     TIFF/IPTC kCGImagePropertyOrientation

iPhone native     UIImageOrientationUp    = 0  =  Landscape left  = 1  
rotate 180deg     UIImageOrientationDown  = 1  =  Landscape right = 3  
rotate 90CCW      UIImageOrientationLeft  = 2  =  Portrait  down  = 8  
rotate 90CW       UIImageOrientationRight = 3  =  Portrait  up    = 6 
```

`UIImageOrientation`4-7 映射到`kCGImagePropertyOrientation`2,4,5,7 - 这些是镜像对应物。

UIImage 从底层的 kCGImagePropertyOrientation 标志派生它的 imagerOrientation 属性——这就是它是只读属性的原因。这意味着只要您正确获取元数据标志，imageOrientation 就会正确执行。但是，如果您正在阅读数字以应用转换，则需要知道您正在查看哪些数字。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-28T02:24:29.803

A few gleanings from my world o' pain in looking into this:

**Background:** `Core Image` face detection was failing and it seemed to be related to using [featuresInImage:options:](http://developer.apple.com/library/ios/#documentation/CoreImage/Reference/CIDetector_Ref/Reference/Reference.html) and using the [UIImage.imageOrientation](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImage_Class/Reference/Reference.html) property as an argument. With an image adjusted to have no rotation and not mirrored, detection worked fine but when passing in an image directly from the camera detection failed.

Well...`UIImage.imageOrientation` is *DIFFERENT* than the actual orientation of the image.

In other words...

```
UIImage* tmpImage = [self.imageInfo objectForKey:UIImagePickerControllerOriginalImage];
printf("tmpImage.imageOrientation: %d\n", tmpImage.imageOrientation); 
```

Reports a value of 3 or `UIImageOrientationRight` whereas using the metaData returned by the [UIImagePickerControllerDelegate](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImagePickerControllerDelegate_Protocol/UIImagePickerControllerDelegate/UIImagePickerControllerDelegate.html) method...

```
 NSMutableDictionary* metaData = [[tmpInfo objectForKey:@"UIImagePickerControllerMediaMetadata"] mutableCopy];
   printf(" metaData orientation    %d\n", [[metaData objectForKey:@"Orientation"] integerValue]); 
```

Reports a value of 6 or `UIImageOrientationLeftMirrored`.

I suppose it seems obvious now that `UIImage.imageOrientation` is a *display orientation* which *appears* to determined by source image orientation *and* device rotation. *(I may be wrong here)* Since the display orientation is **different** than the actual image data, using that will cause the `CIDetector` to fail. Ugh.

I'm sure all of that serves very good and important purposes for liquid GUIs etc. but it is too much to deal with for me since all the `CIDetector` coordinates will also be in the original image orientation making CALayer drawing sick making. So, for posterity here is how to change the `Orientation` property of the metaData AND the image contained therein. This metaData can then be used to save the image to the cameraRoll.

**Solution**

```
// NORMALIZE IMAGE
UIImage* tmpImage = [self normalizedImage:[self.imageInfo objectForKey:UIImagePickerControllerOriginalImage]];
NSMutableDictionary * tmpInfo =[self.imageInfo mutableCopy];
NSMutableDictionary* metaData = [[tmpInfo objectForKey:@"UIImagePickerControllerMediaMetadata"] mutableCopy];

[metaData setObject:[NSNumber numberWithInt:0] forKey:@"Orientation"];
[tmpInfo setObject:tmpImage forKey:@"UIImagePickerControllerOriginalImage"];
[tmpInfo setObject:metaData forKey:@"UIImagePickerControllerMediaMetadata"];

self.imageInfo = tmpInfo; 
```

# c++ - C - 一次读取标准输入 BUFSIZE 个字符

> ID：14553868
> 
> 赞同：2
> 
> 时间：2013-01-28T00:22:24.067
> 
> 标签：c++, c, linux, sockets, unix

我正在编写一个小型套接字程序（GNU libc）。我有一个循环询问用户输入（例如“MSG>”）。当用户按下回车键时，消息被发送（当前发送到 localhost 上的服务器）。

无论如何，我想从标准输入读入一个字符缓冲区[256]。我目前使用的 fgets() 不能满足我的要求。我不确定如何编写代码，以便我询问用户然后一次获取 256 -1 个字节的数据，以便我可以通过几个 256 字节的字符串发送一个 1000 字节的 c 字符串。

编辑：添加代码

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define BUFSIZE 256

int main(int argc, char *argv[])
{
  char msg[BUFSIZE];
  size_t msgLen;

  msgLen = strlen(fgets(msg, BUFSIZE, stdin));
  puts(msg);

  // This simply checks whether we managed to fill the buffer and tries to get
  // more input
  while (msgLen == (BUFSIZE - 1))
    {
      memset (msg, '\0', BUFSIZE);
      fread(msg, BUFSIZE, 1, stdin);
      msg[BUFSIZE - 1] = '\0';
      msgLen = strlen(msg);
      puts(msg);
      if (msgLen < (BUFSIZE - 1))
    break;
    }

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T02:11:22.787

您正在实现一个循环以确保收到 1000 个字节，对吗？为了清晰起见，循环应该指示它最多计数 1000。跟踪您读取的字节数（使用 += 运算符），并在循环条件中使用该数字。

您似乎假设`fread`将读取 255 个字节，但这是在 255 个字节可用的无效假设下。当读取的字节数少于 255 时，这并不一定表示错误；继续阅读！当 的返回值`fread`小于零时，您应该担心。确保你处理这些情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T00:25:53.583

您可以考虑使用该`read`函数进行缓冲输入。它需要一个打开的文件描述符（标准输入为 STDIN_FILENO）、一个指向缓冲区的指针（`char *`）和要读取的字节数。有关详细信息，请参阅手册[条目。](http://linux.die.net/man/3/read)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-28T00:29:36.623

这个怎么样：

```
fread(buffer, sizeof(buffer), 1, stdin); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-28T00:30:33.003

如果您正在使用`fgets()`，则您正在使用标准 IO 库。您将要使用`fread()`then （而不是`read()`使用文件描述符的 , ）来指定要读取的字节数。见：[http ://www.cplusplus.com/reference/cstdio/fread/](http://www.cplusplus.com/reference/cstdio/fread/)

# javascript - 更新侧边栏视图内容的 Ember.js 最佳实践是什么？

> ID：14553872
> 
> 赞同：1
> 
> 时间：2013-01-28T00:23:36.803
> 
> 标签：javascript, model-view-controller, controller, ember.js

我正在开发一个简单的应用程序。作为应用程序的一部分，有一个侧边栏显示较大集合的子集。主集合显示在右侧并显示集合中的所有项目，其中侧边栏显示标志“已加星标”设置为 TRUE 的项目子集。

我有一个名为“Campaigns”的简单控制器，看起来像这样......

```
var App = require('app');

App.CampaignsIndexController = Em.ArrayController.extend({

}); 
```

模型看起来像这样...

```
var App = require('app');
var attr = DS.attr;

App.Campaign = DS.Model.extend({

    name: DS.attr('string'),
    starred: DS.attr('boolean')

}); 
```

保持这个例子的基础。

我们的 App Router 映射如下...

```
var App = require('app');

App.Router.map(function() {

    this.route('index', { path: '/'});

    this.resource('campaigns', { path: '/campaigns'}, function() {

        this.route('new', { path: '/new' });
        this.route('campaign', { path: '/:campaign_id' });

    });

}); 
```

主应用程序模板如下所示。注意侧边栏视图是如何直接放入模板中的。出口`{{ outlet page }}`是上面的路线将丢弃其内容的地方。在此示例中，路径`/campaigns`将显示 中所有活动的列表`{{ outlet page }}`。

```
<div id="app" class="">

    <div id="sidebar" class="">

        {{ view App.StarredCampaignsView }}

    </div>

    <div id="page" class="">

        {{ outlet page }}

    </div>

</div> 
```

活动的路线将渲染连接到页面出口......

```
var App = require('app');

App.CampaignsCampaignRoute = Ember.Route.extend({

    renderTemplate: function(controller, model) {

        this.render({outlet: 'page'});

    }

}); 
```

**我的困境**
绑定传入的内容的最佳实践是什么

`{{ view App.StarredCampaignsView }}`

以便它反映在中看到的确切集合

`{{ outlet page }}`?

**奖励积分**
将集合过滤为模型中看到的布尔标志“已加星标”的最佳做法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T07:42:50.153

将其绑定到控制器内部定义的计算属性

**控制器**

```
filteredValues: function(){
  //returns all the records whose starred property is true
  return this.get('campaigns').filterProperty("starred"); 
}.property('campaigns.@each.starred') 
```

**车把**

```
<div id="sidebar" class="">
  {{#collection contentBinding="filteredValues"}}
    <b>{{view.content.name}}</b>
  {{/collection}}
</div> 
```

# php - 带有 Zend 框架 2 的 SOAP 客户端

> ID：14553873
> 
> 赞同：2
> 
> 时间：2013-01-28T00:23:43.580
> 
> 标签：php, soap, zend-framework2, soap-client

我正在尝试在 Zend 框架 2 中创建一个 SOAP 客户端，我创建了以下正确返回数据的客户端

```
try {
  $client = new Zend\Soap\Client("http://www.webservicex.net/country.asmx?WSDL");
  $result = $client->GetCountries();      
  print_r($result);
} catch (SoapFault $s) {
  die('ERROR: [' . $s->faultcode . '] ' . $s->faultstring);
} catch (Exception $e) {
  die('ERROR: ' . $e->getMessage());
} 
```

但是，当我尝试将数据发送到网络服务时，例如使用

```
try {
  $client = new Zend\Soap\Client("http://www.webservicex.net/country.asmx?WSDL");
  $result = $client->GetCurrencyByCountry('Australia');
  print_r($result);
} catch (SoapFault $s) {
  die('ERROR: [' . $s->faultcode . '] ' . $s->faultstring);
} catch (Exception $e) {
  die('ERROR: ' . $e->getMessage());
} 
```

我刚收到以下消息

```
ERROR: [soap:Receiver] System.Web.Services.Protocols.SoapException: Server was unable to process request. ---> System.Data.SqlClient.SqlException: Procedure or function 'GetCurrencyByCountry' expects parameter '@name', which was not supplied. at WebServicex.country.GetCurrencyByCountry(String CountryName) --- End of inner exception stack trace --- 
```

如何为 web 服务提供参数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-28T03:11:39.400

您的问题出在请求中，WDSL 定义了复杂类型：

```
<s:element name="GetCurrencyByCountryResponse">
    <s:complexType>
        <s:sequence>
            <s:element minOccurs="0" maxOccurs="1" name="GetCurrencyByCountryResult" type="s:string"/>
        </s:sequence>
    </s:complexType>
</s:element> 
```

因此，您需要构建一个对象或关联数组以供 Web 服务使用。对于对象变体，您可以使用 stdClass。如果您像这样修改函数调用：

```
$params = new \stdClass(); 
$params->CountryName = 'Australia'; 
$result = $client->GetCurrencyByCountry($params); 
```

您的请求符合类型，数据将发送到服务器。在提供的 WDSL 中，您必须处理更复杂的变体：

```
<wsdl:message name="GetISOCountryCodeByCountyNameSoapOut"> 
    <wsdl:part name="parameters" element="tns:GetISOCountryCodeByCountyNameResponse"/> 
</wsdl:message> 
```

需要这样的设置：

```
$params = new \stdClass();
$params->parameters = new \stdClass();
$params->parameters->GetISOCountryCodeByCountyNameResult = 'YOURVALUE'; 
```

或者作为一个数组：

```
$params = array('parameters'=> 
  array('GetISOCountryCodeByCountyNameResult'=>'VALUE')
); 
```

# c++ - 传递矢量时遇到问题 作为函数参数 C++

> ID：14553877
> 
> 赞同：1
> 
> 时间：2013-01-28T00:24:33.650
> 
> 标签：c++, vector, parameter-passing

所以这是我正在使用的代码。我希望能够将所有输入传递给该函数，该函数`new_flight`目前没有其他代码，然后是一个空声明。我正在尝试通过引用传递令牌，但我已经尝试过`*` `&`并且只是通过值，但似乎没有一个工作。

```
#include <iostream>
#include <string>
#include <sstream>
#include <algorithm>
#include <vector>
#include <iterator>

using namespace std;

void new_flight( vector<string> &tokens );

int main( int argc, char *argv[] )
{
    vector<string> tokens;

    cout << "Reservations >> ";
    getline(cin, input);
    istringstream iss( input );
    copy(istream_iterator<string>( iss ),
         istream_iterator<string>(),
         back_inserter<vector<string> > ( tokens ));

    new_flight( tokens );
} 
```

这是编译器告诉我的

```
Undefined symbols for architecture x86_64:
  "new_flight(std::vector<std::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::basic_string<char, std::char_traits<char>, std::allocator<char> > > >&)", referenced from:
      _main in ccplPBEo.o
ld: symbol(s) not found for architecture x86_64
collect2: ld returned 1 exit status 
```

此外，如果我注释掉我实际将令牌传递给 new_flight 的行，`new_flight( tokens )`它编译得很好。

谢谢参观

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T00:27:08.737

为了存根一个函数，你需要提供一个函数定义，而不是函数声明：

```
void new_flight( vector<string> &tokens ) {
    // Not implemented
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-28T00:26:21.260

您得到的不是编译器错误，而是*链接器*错误，这是由于您的函数`new_flight()`未定义。但你似乎意识到了这个事实。如果您调用未定义的函数，您不能期望您的程序能够工作，因此链接器首先拒绝创建它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-28T00:27:00.250

您正在声明 function `new_flight`，但没有定义它，因此链接器无法链接它。编写实现（如果只有一个存根），它将编译。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-28T00:26:30.900

您不能调用声明。你需要一个定义。编译器应该为此调用生成什么代码？它没有该功能的代码。您的程序无法编译。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-28T00:29:24.890

正如其他帖子指出的那样：

```
#include <iostream>
#include <string>
#include <sstream>
#include <algorithm>
#include <vector>
#include <iterator>

using namespace std;

void new_flight( vector<string> &tokens );

int main( int argc, char *argv[] )
{
   vector<string> tokens;

   cout << "Reservations >> ";
   getline(cin, input);
   istringstream iss( input );
   copy(istream_iterator<string>( iss ),
     istream_iterator<string>(),
     back_inserter<vector<string> > ( tokens ));

   new_flight( tokens );
}

void new_flight( vector<string> &tokens ) 
{

   // implementation
} 
```

因为您本质上是在 main 之后定义功能，所以编译器需要知道该函数存在，因此我们创建了一个`void new_flight( vector<string> &tokens );`定义该函数的“原型”。

# java - 剑道 UI 简单网格

> ID：14553881
> 
> 赞同：0
> 
> 时间：2013-01-28T00:25:11.747
> 
> 标签：java, javascript, jsp, kendo-ui, kendo-grid

我正在努力在 Kendo UI 中使用 JSP 包装器。我检查了他们的论坛，没有发现任何东西。我检查了stackoverflow，一无所获。我通读了 API，但找不到问题的答案。

对 url 的调用：“CustomerAjaxServlet?str=The R”，

返回以下 json 对象：

```
[
    {"id":0,"customerId":"RO113","name":"The Robe Gallery Inc."},
    {"id":1,"customerId":"TH204","name":"The Robe Collection"}
] 
```

网格正在使用正确的列标题呈现，并且分页正在返回 1 of 10 121 Items。但是没有数据。121 是 json 对象的字符数。如果我更改对 ajax servlet 的调用，项目数也会随着 ...

```
<%@ page language="java" %>

<%@ taglib uri="/WEB-INF/tlds/esc.tld" prefix="esc" %>
<%@ taglib uri="/WEB-INF/tlds/struts-html.tld" prefix="html" %>
<%@ taglib uri="/WEB-INF/tlds/struts-bean.tld" prefix="bean" %>
<%@ taglib uri="/WEB-INF/tlds/struts-logic.tld" prefix="logic" %>

<%@taglib prefix="kendo" uri="http://www.kendoui.com/jsp/tags"%>

<%@ page import="org.apache.struts.taglib.TagUtils" %>

<% SessionContext context = SessionContext.getSessionContext(request); %>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
    <title>Detail template</title>
    <meta http-equiv="Content-Type" content='text/html; charset=us-ascii'>
      <meta name='author' content=Test'>

    <link href="common/js/kendo/examples/content/shared/styles/examples-offline.css" rel="stylesheet">
    <link href="common/js/kendo/styles/kendo.common.min.css" rel="stylesheet">
    <link href="common/js/kendo/styles/kendo.default.min.css" rel="stylesheet">

    <script src="common/js/kendo/js/jquery.min.js"></script>
    <script src="common/js/kendo/js/kendo.web.min.js"></script>
    <script src="common/js/kendo/content/shared/js/console.js"></script>
</head>
<body>
    <a class="offline-button" href="../index.html">Back</a>

        <div id="example" class="k-content">
            <div id="grid"></div>

            <script type="text/x-kendo-template" id="template">
                <div class="tabstrip">
                    <div>
                        <div class='customer-details'>
                            <ul>                            
                                <li><label>id:</label>#= id #</li>
                                <li><label>name:</label>#= name #</li>
                                <li><label>customerId:</label>#= customerId #</li>
                            </ul>
                       </div>
                    </div>
                </div>

            </script>

            <script>
                $(document).ready(function() {
                    var element = $("#grid").kendoGrid({
                        dataSource: {
                            transport: {
                                read: function(options) {                                                            
                                          $.ajax( {
                                                url:  "CustomerAjaxServlet?str=The R",
                                                data: options.data,                                                                                                success: function(result) {
                                                options.success(result);
                                                //alert(result);
                                          }
                                          });
                                }
                            },
                            pageSize: 10,
                            serverPaging: true,
                            serverSorting: true
                        },
                        height: 450,
                        sortable: true,
                        pageable: true,
                        dataBound: function() {
                            this.expandRow(this.tbody.find("tr.k-master-row").first());
                        },
                        columns: [
                            {
                                field: "id",
                                title: "Id"
                            },
                            {
                                field: "name",
                                title: "Name"
                            },
                            {
                                field: "customerId",
                                title: "Customer Id"
                            }                          
                        ]
                    });
                });

            </script>
            <style scoped="scoped">
                .customer-details ul
                {
                    list-style:none;
                    font-style:italic;
                    margin-bottom: 20px;
                }

                .customer-details label
                {
                    display:inline-block;
                    width:90px;
                    font-style:normal;
                    font-weight:bold;
                }
            </style>
        </div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T02:25:54.373

Your code runs fine. Did you check the `contentType` of the json object returned? It should be "application/json".

I run your code with the following `CustomerAjaxServlet`

```
<%@ page contentType="application/json;charset=UTF-8" language="java" %>
<%
    out.println("[" +
            "{\"id\":0,\"customerId\":\"RO113\",\"name\":\"The Robe Gallery Inc.\"}," +
            "{\"id\":1,\"customerId\":\"TH204\",\"name\":\"The Robe Collection\"}" +
            "]");
%> 
```

# c - 如何避免在 while 循环中打印 '\n' 的 ASCII 值？

> ID：14553882
> 
> 赞同：4
> 
> 时间：2013-01-28T00:25:18.013
> 
> 标签：c

我的任务是获取输入，打印出字符和 ASCII 值，并以 8 表示 1 行。对于我输入的每个输入，我也会得到换行符的值，我不想打印它。

这是我的代码：

```
#include <stdio.h>

int main()    
{       
    char ch;
    int count = 0;

    printf("please type an input:\n");
    while ((ch = getchar()) != '#')          
    {
        ++count;           
        printf("%c=%d ", ch, ch);
        if (count%8 == 0) printf("\n");
    }        
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T00:28:28.063

您可以`getchar()`在阅读第一个后立即使用另一个：

```
 while ((ch = getchar()) != '#')
  {
       getchar();  // To eat the newline character
       // Rest of code
  } 
```

* * *

或者您可以使用 scanf() 并等效地重写循环：

```
 while (scanf(" %c", &ch)==1)
    {
        if(ch != '#')
        {
          ++count;
          printf("%c=%d ", ch, ch);
          if (count%8 == 0)
             printf("\n");
        }
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-28T00:43:08.153

```
int main()    
{       
    char ch;
    int count = 0;

    printf("please type an input:\n");
    while (1) {
        ch = getchar();
        if (ch == '#') break;
        if (ch == '\n') continue;         

        printf("%c=%d ", ch, ch);
        if (!(++count%8)) printf("\n");
    }        
} 
```

# vb.net - 如何在 vb.net 的二维数组中找到最右边的列？

> ID：14553883
> 
> 赞同：2
> 
> 时间：2013-01-28T00:25:18.330
> 
> 标签：vb.net, visual-studio-2010, multidimensional-array

如何在 vb.net 的二维数组中找到最右边的列？我目前有一个二维数组如下

Dim intArray(0 To 34, 0 To 57) As Integer

我想找到最右边的列（最高的第二个数字），而 UBound 只返回最后一行。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T00:41:49.390

指定，尺寸`UBound()`：

```
numColumns = UBound(intArray, 2) + 1    (assumes zero based) 
```

另一个例子：

```
Dim A(1 To 50, 0 To 10, -3 To 9)

                            Value 
UBound(A, 1)                   50                   
UBound(A, 2)                   10 
UBound(A, 3)                    9 
```

# c++ - 如何转换数组中的参数列表

> ID：14553887
> 
> 赞同：1
> 
> 时间：2013-01-28T00:25:53.027
> 
> 标签：c++

我想将相同类型的参数列表转换为 C 数组。这是我发现解决问题的最佳方法：

```
template <typename T > class _Arr {
    template <size_t N> struct Rep_base {
        T m_el[N]; 
        operator T * () { return m_el; } 
    }; 
public:
    template <size_t N> struct Rep; 
    template <> struct Rep<1> : public Rep_base<1> {
        Rep(const T & a) { m_el[0] = a; };
    }; 
    template <> struct Rep<2> : public Rep_base<2> {
        Rep(const T & a, const T & b) { m_el[0] = a; m_el[1] = b;}; 
    };
    ... 
}; 
```

所以给定一个函数：

```
void f(int x[5]); 
```

如果可以打电话`f(_Arr<int>::Rep<5>(1, 2, 3, 4, 5)).`

这太可怕了。有没有人更好的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T00:35:39.837

如果您真的希望它作为辅助函数并且不使用 C++11，则可以使用可变参数：

```
#include <iostream>
#include <stdarg.h>
#include <vector>

std::vector<int> var_func( int n, ... ) {
    va_list ap;
    va_start(ap, n);
    std::vector<int> args;
    for(int i = 0; i != n; ++i) {
        args.push_back(va_arg(ap, int));
    }
    va_end(ap);
    return args;
}

void f(int x[5]) {
    for( int i = 0; i != 5; ++i ) std::cout << x[i];
}

int main() {
    f( var_func(5, 1, 2, 3, 4, 5).data() );
    return 0;
} 
```

输出是`12345`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T00:39:22.433

你为什么要重新发明轮子？C++ 已经拥有完全希望您尝试的预构建容器。如果您想要一个动态大小的数组，请使用[`std::vector`](http://en.cppreference.com/w/cpp/container/vector). 如果您想要一个固定大小的数组，请使用[`std::array`](http://en.cppreference.com/w/cpp/container/array). 这些是您应该考虑的替代方案。

# r - 求解 R 中的超越方程

> ID：14553900
> 
> 赞同：2
> 
> 时间：2013-01-28T00:27:09.373
> 
> 标签：r

R中是否有求解超越方程的函数？

例如，我想解决以下方程

```
x = 1/tan(x) 
```

有什么建议么？我知道解决方案有多个根，所以我也希望能够恢复给定间隔的所有答案

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-28T00:38:30.117

我将绘制函数曲线并查看它以查看它的外观：

```
R > y = function(x) { x - 1/tan(x) }
R > curve(y, xlim = c(-10, 10))
R > abline(h = 0, color = 'red') 
```

![在此处输入图像描述](../Images/4f4a1c6c8551a60402372e69db99f60e.png)

然后我看到在 0 和 3 之间有一个根，我会用它`uniroot`来获取我想要的根：

```
R > uniroot(y, interval = c(0, 3))
$root
[1] 0.8603

$f.root
[1] 6.612e-06

$iter
[1] 7

$estim.prec
[1] 6.104e-05 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-28T00:35:15.087

您可以使用它`uniroot`来查找给定范围内*任何一维方程的根。*然而，获得多个根一般来说似乎是一个非常困难的问题（例如，请参阅*数字食谱*的相关章节了解一些背景：[http](http://apps.nrbook.com/c/index.html) ://apps.nrbook.com/c/index.html 的第 9 章）。当有多个根时，很难预测找到哪个根。*如果*您对问题有足够的了解，可以将空间细分为具有零个或一个根的子区域，或者如果您愿意将其划分为许多区域并希望找到所有的根，那么您可以做到。否则我期待其他人的解决方案......

在这种特殊情况下，如@liuminzhao 的解决方案所示，（最多？确切地说？）`n*pi`和之间有一个解决方案`(n+1)*pi`

```
y = function(x) x-1/tan(x)
curve(y,xlim=c(-10,10),n=501,ylim=c(-5,5))
abline(v=(-3:3)*pi,col="gray")
abline(h=0,col=2) 
```

![在此处输入图像描述](../Images/ab8ad7b1931d998c7674710adcf99bd0.png)

这有点小技巧，但它会找到方程的根（前提是它们不太接近 pi 的倍数：`eps`如果你愿意，你可以减少......）。但是，如果您想求解*不同*的多根超越方程，您可能需要另一种（专门的）策略......

```
f <- function(n,eps=1e-6) uniroot(y,c(n*pi+eps,(n+1)*pi-eps))$root
sapply(0:3,f)
## [1] 0.8603337 3.4256204 6.4372755 9.5293334 
```

# php - ajax - 将变量传递给特定行的自动完成

> ID：14553905
> 
> 赞同：0
> 
> 时间：2013-01-28T00:27:44.157
> 
> 标签：php, ajax

我有这样的代码

```
 $(function() {
              $('.serial_number').live('focus.autocomplete', function() { 
                $(this).autocomplete("/admin/includes/getinvoiceajax.php", {
                    width: 300,
                    matchContains: true,
                    mustMatch: true,
                    selectFirst: false
                }); 
              });
            }); 
```

它从表中获取序列号列表。现在它只是获取整个列表，但我想将一个变量 [man_part_number] 传递给它，以便我可以改进我的结果。问题是我无法弄清楚当 man_part_number 从输入字段到输入字段时如何传递。它需要匹配该特定行。我想也许我可以序列化这个。

```
<input type="hidden" name="man_part_number[]" id="man_part_number" class="man_part_number" />
<input type="text" name="serial_number[]" id="serial_number" class="serial_number" />
<input type="hidden" name="man_part_number[]" id="man_part_number" class="man_part_number" />
<input type="text" name="serial_number[]" id="serial_number" class="serial_number" />
<input type="hidden" name="man_part_number[]" id="man_part_number" class="man_part_number" />
<input type="text" name="serial_number[]" id="serial_number" class="serial_number" />
<input type="hidden" name="man_part_number[]" id="man_part_number" class="man_part_number" />
<input type="text" name="serial_number[]" id="serial_number" class="serial_number" /> 
```

# vim - vi 粘贴格式混乱

> ID：14553908
> 
> 赞同：19
> 
> 时间：2013-01-28T00:28:19.080
> 
> 标签：vim, vi

当我在终端上打开 vim 编辑器时，我将以下文本从另一个来源复制到剪贴板

```
 int thisVal = findMin(m);
    // System.out.println(val);
    m.add(val); 
```

但它变成

```
 int thisVal = findMin(m);
                // System.out.println(val);
                //                      m.add(val); 
```

为什么会出现这种情况以及如何正确粘贴格式？谢谢你。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-01-28T00:29:34.397

```
:set paste 
```

应该会导致缩进正常工作。正如 uku 指出的那样，您可以使用以下方式阅读有关粘贴模式的更多信息

```
:h paste 
```

你可以关闭粘贴模式

```
:set nopaste 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-28T01:07:43.490

采用

```
:set paste 
```

或者

```
:set noai 
```

Noai（无自动缩进）可以再次使用禁用`:set ai`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-08-10T19:00:43.860

为了永久保存定义的变量：

```
vi ~/.vimrc 
```

添加以下行，保存并退出

```
:set paste #will enable the paste mode as answered above
:set nu #this will show the line numbers for editor 
```

可以从以下列表中添加一些其他允许的参数：

```
autoindent(ai)
autowrite(aw)
exrc(ex)
errorbells
flash
ignorecase(ic)
lisp
list
magic
modelines
number(nu)
showmatch(sm)
showmode(smd)
wrapscan(ws) 
```

希望这对其他人也有帮助。

# sql - SQL中的组合触发器

> ID：14553914
> 
> 赞同：1
> 
> 时间：2013-01-28T00:28:44.723
> 
> 标签：sql, sqlite, triggers

我有这些表：

*   电影（mID、片名、年份、导演）
*   审稿人（rID，姓名）
*   评级（rID、mID、星数、ratingDate）

和一些观点：

*   视图`LateRating`包含 2011 年 1 月 20 日之后的电影评分。视图包含电影 ID、电影名称、星数和评分日期。

    ```
    create view LateRating as 
      select distinct R.mID, title, stars, ratingDate 
      from Rating R, Movie M 
      where R.mID = M.mID 
      and ratingDate > '2011-01-20' 
    ```

*   视图`HighlyRated`包含至少有 1 个评分高于 3 星的电影。该视图包含电影 ID 和电影标题。

    ```
    create view HighlyRated as 
      select mID, title 
      from Movie 
      where mID in (select mID from Rating where stars > 3) 
    ```

*   View`NoRating`包含数据库中没有评分的电影。该视图包含电影 ID 和电影标题。

    ```
    create view NoRating as 
      select mID, title 
      from Movie 
      where mID not in (select mID from Rating) 
    ```

这是我的数据集：[https ://prod-c2g.s3.amazonaws.com/db/Winter2013/files/viewmovie.sql](https://prod-c2g.s3.amazonaws.com/db/Winter2013/files/viewmovie.sql)

我应该编写一个而不是触发器，它组合触发器以启用对属性 mID、标题和/或视图 LateRating 中的星号的同时更新。

我可以编写简单的触发器，但这看起来很复杂？我该如何解决这个问题？

# jquery-ui - 通过 Tag-it jqueryui 使用可排序

> ID：14553917
> 
> 赞同：2
> 
> 时间：2013-01-28T00:29:01.083
> 
> 标签：jquery-ui, list, input, jquery-ui-sortable

我一直在使用[https://github.com/aehlke/tag-it](https://github.com/aehlke/tag-it)中的 tag-it 插件（演示 - [http://aehlke.github.com/tag-it/examples.html](http://aehlke.github.com/tag-it/examples.html)）。

在此代码中，有一个选项可以在另一个输入、textarea 等中显示输入的标签。第一个选项 -

```
 $('#singleFieldTags').tagit({
            availableTags: sampleTags,

            singleField: true,
            singleFieldNode: $('#mySingleField')
        }); 
```

这里的 id -`#singleFieldTags`是输入字段，它是一个类似列表的列表，`<ul`而 id -`#mySingleField`显示“列表排序”标签，每个标签之间都有逗号。

中添加和删除的所有标签都`#singleFieldTags`出现在`#mySingleField`. 由于 tag-it 没有内置的可排序功能，因此添加 a`sortable()`以更改 中的标签顺序`#singleFieldTags`，不会更改 中的标签顺序`#mySingleField`。

第二个选项是简单的，只有`#singleFieldTags`以下内容：-

```
 $('#singleFieldTags').tagit({
            availableTags: sampleTags,
        }); 
```

虽然在 tag-it.js 中有一个 ，但在提交 php 表单后，该值不会出现在 mysql 表中，因为上面的标签列表放在`<li></li>`.

如何使标签可排序并确保列表字段中相同的标签排列`<ul`显示在`<textarea`第一个选项中？或者如何在单个字段中对标签进行排序`<input`并使其能够通过表单提交？

编辑：这里有一个类似 Tag-it 的插件，称为 tagit：[http](http://webspirited.com/tagit/) ://webspirited.com/tagit/ 。如果标签被交换，这个插件有一个输入框的可排序，当在表单上提交时，它会按排序顺序出现。但是，缺点是它具有自定义的主题滚轮主题，这些主题并不相似，甚至无法链接到 jQuery UI (jqueryui.com) 上的主题。

但另一方面，tag-it 插件（不是 tagit）可以加载这些主题，但不提供可排序功能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T13:00:41.840

这是一个使用 tag-it 插件的解决方案，因为我知道您的报价中解释了您缺少的功能“ *...添加一个 sortable() 以更改 #singleFieldTags 中的标签顺序，不会更改标签的顺序#mySingleField* “。

为了让“#mySingleField”反映新的排序顺序，我在 sortable() 的停止事件中添加了一个处理程序：

```
$('#singleFieldTags').sortable({
    stop: function(event,ui) {
        $('#mySingleField').val(
            $(".tagit-label",$(this))
                .clone()
                .text(function(index,text){ return (index == 0) ? text : "," + text; })
                .text()
        );
    }
}); 
```

和

```
$('#singleFieldTags2').siblings(".tagit").sortable({
    stop: function(event,ui) {
        $('#singleFieldTags2').val(
            $(".tagit-label",$(this))
                .clone()
                .text(function(index,text){ return (index == 0) ? text : "," + text; })
                .text()
        );
        console.log( $('#singleFieldTags2').val() );        // just for reference
    }
}); 
```

这是一个[演示功能的 jsfiddle](http://jsfiddle.net/martyk/KYQbf/2/) （为单个输入字段添加的功能）

# python - SQLAlchemy 说“表已经存在”，尽管它没有

> ID：14553918
> 
> 赞同：3
> 
> 时间：2013-01-28T00:29:07.573
> 
> 标签：python, mysql, sqlalchemy

我想使用 SQLAlchemy ORM 不仅可以查询数据库，还可以创建表。所以我连接到我的数据库的空模式：

```
engine = create_engine(connection_string)
Base = declarative_base() 
```

我有一些类似于以下示例的类：

```
class SomeClass(Base):
    __tablename__= 'SomeClass'
    id = Column(Integer, primary_key=True, auto_increment=True)
    name = Column(String(50))

    def __init__(self, name):
        self.name = name 
```

要创建我调用的数据库：

```
Base.metadata.create_all(engine) 
```

这很好用——第一次。如果我现在从数据库中手动**删除**表或调用`Base.metadata.drop_all()`并重新启动脚本（因此`create_all`再次调用），我会收到一个错误，表明我的表已经存在：

```
sqlalchemy.exc.OperationalError: (OperationalError) (1050, "Table 'someclass' already exists") 
```

我可以清楚地说，这不是真的。我可以使用 CLI 工具中的 CREATE TABLE 创建同名表，并且*如果**我现在**停止****数据库守护程序**并重新启动它，我**将**能够使用`create_all`.*

所以我猜这与 SQLAlchemy 和数据库之间的连接有关。Obviosly SQLAlchemy 认为该表在我删除后仍然存在，这是不正确的。但是，如果我尝试查询这个不存在的表，它会告诉我，该表不存在。

我四处搜索，但无法找到这种行为的解释。我不经常使用 SQLAlchemy，所以也许我对它的了解不够深入，无法理解这个问题。

无论如何，我会很感激能得到提示。

我正在使用**Python 2.7.3**和**MySQL 5.1.47**和**SQLAlchemy 0.8.0b2**

PS：使用 Postgres 我从来没有遇到过这样的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T11:41:22.903

我通过升级到 MySQL 5.1.66 解决了这个问题。请注意，我不只是升级旧实例，而是从我的系统中完全卸载它并从头开始安装新版本。因此，我仍然无法判断问题是由于我的旧安装配置错误还是只是一个错误。

但是，现在一切正常。

# android - Android GoogleMap 在暂停恢复后停止反应

> ID：14553919
> 
> 赞同：1
> 
> 时间：2013-01-28T00:29:08.447
> 
> 标签：android, fragment, google-maps-android-api-2

我正在开发一个用于跟踪 GPS 数据的应用程序，它的界面中有一个大的 GoogleMap 显示正在跟踪的内容。事情按照我想要的方式进行，直到活动因任何原因（电话、主页按钮等）暂停，然后我恢复活动。

初始启动后，地图不会对任何用户交互做出反应，到目前为止这对我有用。任何将相机动画到某个位置的调用都有效，标记被绘制，用户位置和方位也是如此。在暂停-恢复循环之后，情况正好相反。地图接受用户的所有手势，但不对任何呼叫作出反应。我无法为相机设置动画、绘制标记或显示用户位置。

我尝试了很多东西，试图在恢复时强制重新加载地图设置并在暂停时将地图归零，但似乎没有任何效果。

这是我设置地图的地方，在 onCreate 中调用（并在 onResume 中尝试过）：

```
private void setupMap(){
    getSupportFragmentManager().beginTransaction().replace(R.id.trackeractivity_map, new SupportMapFragment()).commit();
    FragmentManager fragmentManager = getSupportFragmentManager();
    SupportMapFragment supportMapFragment = (SupportMapFragment) fragmentManager.findFragmentById(R.id.trackeractivity_map);
    mMap = supportMapFragment.getMap();
    mMap.setMapType(GoogleMap.MAP_TYPE_NORMAL);
    mMap.setMyLocationEnabled(true);
} 
```

这是我更新用户位置并为相机设置动画的地方：

```
private void updateUserLocation(double lat, double lon){
    Log.d(TAG, "updateUserLocation - " + lat + " : " + lon);
    mLastLocationLat = lat;
    mLastLocationLon = lon;
    if (mMap != null){
        CameraPosition userPos = new CameraPosition(new LatLng(lat, lon), mMap.getMaxZoomLevel()-4, 0, 0);
        mMap.animateCamera(CameraUpdateFactory.newCameraPosition(userPos));
    }
} 
```

这就是我向轨道添加新标记的地方：

```
private void updateMapOverlay(double lat, double lon){
    Log.d(TAG, "updateMapOverlay - " + lat + " : " + lon + " - Type " + mCurrentType);
    MarkerOptions marker = new MarkerOptions();
    marker.position(new LatLng(lat, lon));
    marker.draggable(false);
    marker.icon(BitmapDescriptorFactory.fromResource(getTypeDrawableID(mCurrentType)));
    mMap.addMarker(marker);
} 
```

以及布局中的地图片段：

```
<fragment
        android:id="@+id/trackeractivity_map"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_margin="10dp"
        class="com.google.android.gms.maps.SupportMapFragment"
    /> 
```

如您所见，我正在使用 supportfragmentmanager，并且该活动还使用了 JFeinstein 的 SlidingMenu - 顺便说一句，效果很好。

即使在暂停恢复之后，对地图工作有任何帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T19:20:02.437

我发现您在 setupMap 方法中添加片段的方式可能存在一些问题。我建议重新阅读谷歌的指南，或查看以下文章，特别是答案中链接的博客文章，因为它有一个完整的工作类，可以跟踪用户的位置并在暂停/恢复时正常工作。

[https://stackoverflow.com/a/13753518/1103584](https://stackoverflow.com/a/13753518/1103584)

# javascript - 在 easytabs 中加载 flexslider

> ID：14553922
> 
> 赞同：0
> 
> 时间：2013-01-28T00:29:17.110
> 
> 标签：javascript, jquery, tabs, flexslider

我正在尝试在 easytabs 中加载 flexslider。我在页面上有两个 flexslider。一个在与页面一起加载的照片下，另一个在功能下。功能选项卡上的 flexslider 不会加载，因为它最初是隐藏的。

我正在寻找一些 js 代码来在单击选项卡时执行第二个 flexslider。

任何帮助表示赞赏

注意：我已经进行了调整并确认两个 flexslider 都可以在没有标签的页面上工作。

我选择了 pikachoose 而不是 flexslider，它起作用了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-20T01:44:30.283

我发现这对我想做的事情有用。

```
$(document).ready(function(){
    $('.flexslider').flexslider({
        animation: 'slide',
        animationLoop: false,
        prevText: '',
        nextText: '',
        controlNav: false,
        keyboard: false,
        slideshow: false,
        start: function(){
            // This is your easytabs install
            $('.tab-container').easytabs({
                updateHash: false,
                animate: false
            });
        }
    });
}); 
```

基本上它只在 flexslider 完成时初始化 easytabs。

# phantomjs - 将幻像 js 处理的页面保存到具有绝对 url 的 html 文件中

> ID：14553925
> 
> 赞同：5
> 
> 时间：2013-01-28T00:29:28.793
> 
> 标签：phantomjs, absolute

我想在通过所有 url 将文档加载到特殊文件名后保存我的特殊网页，并且链接转换为绝对 url，例如`wget -k`.

```
//phantomjs
var page = require('webpage').create();
var url = 'http://google.com/';
page.open(url, function (status) {
var js = page.evaluate(function () {
return document;
});
console.log(js.all[0].outerHTML);
phantom.exit();
}); 
```

例如我的 html 内容是这样的：

```
<a href="//page.html">page</a> 
```

一定是

```
<a href="http://google.com/page.html">page</a> 
```

这是我的示例脚本，但如何转换所有 url 和链接，例如`wget -k`使用 phantomjs？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T12:57:44.217

您可以修改最终的 HTML 以使其具有`<base>`标签 - 这将使所有相对 URL 正常工作。在您的情况下，请尝试将`<base href="http://google.com/">`其`<head>`放在页面上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-29T06:04:41.893

PhantomJS 并不真正支持它，它不仅仅是一个 HTTP 客户端。想象一下，如果有一个 JavaScript 代码在主登录页面上拉取带有图像的随机内容。

可能对您来说也可能不适合的解决方法是替换 DOM 中所有引用的资源。这可以使用一些 CSS3 选择器（href 代表 a，src 代表 img 等）和相对于基本 URL 的手动路径解析。如果您确实需要跟踪和登记每个资源 URL，请使用[网络流量监控](https://github.com/ariya/phantomjs/wiki/Network-Monitoring)功能。

最后但并非最不重要的一点是，要获得可以使用的生成内容，而不是使用和`page.content`进行复杂的舞蹈。`evaluate``outerHTML`

# c - 如何在C中使用带有范围的rand（）函数

> ID：14553930
> 
> 赞同：-2
> 
> 时间：2013-01-28T00:30:07.857
> 
> 标签：c

> **可能重复：**
> [在 C 中，如何从 rand() 中获取特定范围的数字？](https://stackoverflow.com/questions/1202687/in-c-how-do-i-get-a-specific-range-of-numbers-from-rand)
> [生成范围内的随机数？](https://stackoverflow.com/questions/2999075/generate-a-random-number-within-range)

我被困在如何使用 rand() 函数并包含该随机数的范围。我需要一个介于 67.00 和 99.99 之间的随机数才能打印。

这是我尝试过的，但失败了......

```
#include <stdio.h>
#include <stdlib.h>

int main(void)

{
    int x = rand();

    if(x>=67.00)
    if(x<=99.99)
          printf("%d\n",x);
        else
        printf("not in range");
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T00:33:26.323

*您可以强制*结果在您想要的范围内，而不是*检查*结果是否在范围内：

 *```
int HIGH = 100;
int LOW = 67;
int rnd = LOW + (rand() % (HIGH-LOW)); 
```

的值在和`rnd`之间，包括 和 。`LOW``HIGH-1`

如果您不想强制数字进入范围，请将您的条件更改为

```
if(x>=67.00 && x<=99.99) 
```

目前，`else`属于内部`if`，因此`printf`当数字小于 时，不会发生第二个`67`。*

# ruby-on-rails - ActiveMerchant 支持确定 PayPal Express Checkout 客户/买家的帐户状态（已验证/未验证）

> ID：14553933
> 
> 赞同：0
> 
> 时间：2013-01-28T00:30:34.617
> 
> 标签：ruby-on-rails, paypal, activemerchant

我目前正在开发一个 Ruby-on-Rails 网络应用程序，该应用程序通过 PayPal 的 Express Checkout 和 ActiveMerchant 接受 PayPal 付款。我已经对 ActiveMerchant 的支持进行了几项研究，以确定客户/买家是否使用经过验证或未经验证的 PayPal 帐户付款，但我没有找到有用的指南。

我还发现 ActiveMerchant 目前没有很好的文档记录，所以它根本没有帮助。

以下是我的项目目前正在使用的相关代码。在 PaymentsController#purchase 上，我暂时使用EXPRESS_GATEWAY.purchase 方法调用返回的对象的`#params['protection_eligibility']`和方法来评估 PayPal 客户/买家是否拥有经过验证/未经验证的 PayPal 帐户。后来发现这并不是了解客户账户状态的可靠依据。`#params['protection_eligibility_type']``ActiveMerchant::Billing::PaypalExpressResponse`

我希望有人能给我一个智慧，让我知道 PayPal 客户/买家是否有一个使用 Ruby-on-Rails 的 ActiveMerchant 或使用 Rails 上的其他替代品的已验证/未验证帐户。

```
# config/environments/development.rb
config.after_initialize do
  ActiveMerchant::Billing::Base.mode = :test
  paypal_options = {
      # credentials removed for this StackOverflow question
      :login => "",
      :password => "",
      :signature => ""
  }
  ::EXPRESS_GATEWAY = ActiveMerchant::Billing::PaypalExpressGateway.new(paypal_options)
end

# app/models/payment.rb
class Payment < ActiveRecord::Base
  # ...
  PAYPAL_CREDIT_TO_PRICE = {
      # prices in cents(US)
      1  =>  75_00,
      4  => 200_00,
      12 => 550_00
  }
  STATUSES  = ["pending", "complete", "failed"]
  TYPES     = ["paypal", "paypal-verified", "paypal-unverified", "wiretransfer", "creditcard"]
  # ...
end

# app/controllers/payments_controller.rb
class PaymentsController < ApplicationController
  # ...
  def checkout
    session[:credits_qty] = params[:credit_qty].to_i

    total_as_cents = Payment::PAYPAL_CREDIT_TO_PRICE[session[:credits_qty]]
    setup_purchase_params = {
        :allow_guest_checkout => true,
        :ip => request.remote_ip,
        :return_url => url_for(:action => 'purchase', :only_path => false),
        :cancel_return_url => url_for(:controller => 'payments', :action => 'new', :only_path => false),
        :items => [{
                       :name => pluralize(session[:credits_qty], "Credit"),
                       :number => 1,
                       :quantity => 1,
                       :amount => Payment::PAYPAL_CREDIT_TO_PRICE[session[:credits_qty]]
                   }]
    }

    setup_response = EXPRESS_GATEWAY.setup_purchase(total_as_cents, setup_purchase_params)
    redirect_to EXPRESS_GATEWAY.redirect_url_for(setup_response.token)
  end

  def purchase
    if params[:token].nil? or params[:PayerID].nil?
      redirect_to new_payment_url, :notice => I18n.t('flash.payment.paypal.error')
      return
    end

    total_as_cents = Payment::PAYPAL_CREDIT_TO_PRICE[session[:credits_qty]]
    purchase_params = {
        :ip => request.remote_ip,
        :token => params[:token],
        :payer_id => params[:PayerID],
        :items =>  [{
                        :name => pluralize(session[:credits_qty], "Credit"),
                        :number => 1,
                        :quantity => 1,
                        :amount => Payment::PAYPAL_CREDIT_TO_PRICE[session[:credits_qty]]
                    }]
    }

    purchase = EXPRESS_GATEWAY.purchase total_as_cents, purchase_params
    if purchase.success?
      payment = current_user.payments.new
      payment.paypal_params = params
      payment.credits = session[:credits_qty]
      payment.amount  = Payment::PAYPAL_CREDIT_TO_PRICE[session[:credits_qty]]
      payment.currency = "USD"
      payment.status = "complete"
      if(purchase.params["receipt_id"] && (purchase.params["success_page_redirect_requested"] == "true"))
        payment.payment_type = "creditcard"
      else
        if purchase.params['protection_eligibility'] == 'Eligible' && purchase.params['protection_eligibility_type'] == 'ItemNotReceivedEligible,UnauthorizedPaymentEligible'
          payment.payment_type = 'paypal-verified'
        else
          payment.payment_type = 'paypal-unverified'
        end
      end
      payment.ip_address = request.remote_ip.to_s
      payment.save!

      SiteMailer.paypal_payment(payment).deliver
      SiteMailer.notice_payment(payment).deliver

      notice = I18n.t('flash.payment.status.thanks')
      redirect_to profile_url, :notice => notice
    else
      notice = I18n.t('flash.payment.status.failed', :message => purchase.message)
      redirect_to new_payment_url, :notice => notice
    end
  end
  # ...
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T20:49:52.840

我使用 PayPal 的 paypal-sdk-merchant gem 来完成 ActiveMerchant 无法帮助我完成的工作（获取付款人帐户的状态：已验证/未验证的 PayPal 帐户。我在[https 上安装了 paypal-sdk-merchant： //github.com/paypal/merchant-sdk-ruby](https://github.com/paypal/merchant-sdk-ruby)

*   gem 'paypal-sdk-merchant'
*   捆绑安装
*   rails 生成 paypal:sdk:install

然后我设置了他们的示例[https://github.com/paypal/merchant-sdk-ruby#samples](https://github.com/paypal/merchant-sdk-ruby#samples)。设置示例后，转到 Rails 应用程序的 /samples ，您会发现很多代码生成器可用于您从 PayPal 的 API 中需要的任何功能。不要忘记配置您的 config/paypal.yml。我配置了用户名、密码和签名（可以从您的 PayPal 沙箱中获得，特别是您的测试卖家帐户）并在我的案例中删除了 app_id。

我使用 PayPal 的示例 (/samples) 获得了以下代码，用于获取 PayPal 付款人的帐户状态（已验证/未验证），并将其放在我的应用程序中模型的类方法中：

```
def self.get_paypal_payer_status(transaction_id)
  require 'paypal-sdk-merchant'
  api = PayPal::SDK::Merchant::API.new

  get_transaction_details = api.build_get_transaction_details({
    :Version => "94.0",
    :TransactionID => transaction_id
  })
  get_transaction_details_response = api.get_transaction_details(get_transaction_details)

  get_transaction_details_response.payment_transaction_details.payer_info.payer_status
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T02:22:09.077

我对 ActiveMerchant 不熟悉，所以我无法具体告诉您，但是对于任何 Express Checkout 实施，您都可以使用[GetExpressCheckoutDetails](https://www.x.com/developers/paypal/documentation-tools/api/getexpresscheckoutdetails-api-operation-nvp)来获取付款人信息，其中包括一个值为“已验证”或“未验证”的 PAYERSTATUS 参数.

这是一个可选调用，但我认为 ActiveMerchant 可能包含它，因此您只需要跟踪它并相应地提取该参数。

或者，您可以使用[即时付款通知 (IPN)](https://www.x.com/developers/paypal/documentation-tools/ipn/integration-guide/IPNIntro)接收交易信息，您也将在此处返回一个 payer_status 参数。

# php - PHP - 搜索数组或通过数据库查询处理？

> ID：14553937
> 
> 赞同：0
> 
> 时间：2013-01-28T00:31:17.563
> 
> 标签：php, mysql, arrays, search

我创建了一个由我的 MySQL 数据库中的记录组成的数组。它包含大量配方，包括“嵌套”数组。

我允许用户在数组中搜索多个术语然后只显示符合条件的数组的最佳方法是什么？或者我应该尝试为每个搜索构建特定的数组？

这是数组的示例输出：

对不起，我不知道如何很好地显示这个......

```
35 => 
    array (size=17)
      'id' => string '35' (length=2)
      'name' => string 'Yummy stuff!!' (length=13)
      'recipeType' => string 'Appetizer' (length=9)
      'photo' => string 'url/recipe.gif' (length=31)
      'thumbnail_uri' => string '' (length=0)
      'published' => string '2002-04-03 00:00:00' (length=19)
      'summary' => string 'The summary of the recipe is that it is really good!' (length=52)
      'review' => string 'The review of this recipe is awesome! More please!' (length=50)
      'prepTime' => string '70' (length=2)
      'cookTime' => string '30' (length=2)
      'totalTime' => string '140' (length=3)
      'nutrition' => string 'No calories here.' (length=17)
      'instructions' => string 'I instruct you to cook it long and good, until it&#39;s warm' (length=60)
      'yield' => string 'It yields enough for me and you.' (length=32)
      'ingredient' => string '2 apples, one banana, and 18 lemons' (length=35)
      'author' => string 'John Sample Man' (length=12)
      'dietary_restrictions' => 
        array (size=2)
          6 => string 'Low fat' (length=7)
          7 => string 'Grain Free' (length=10)
36 => 
    array (size=17)
      'id' => string '36' (length=2)
      'name' => string 'A good recipe' (length=13)
      'recipeType' => string 'Appetizer' (length=9)
      'photo' => string 'url/recipe.gif' (length=31)
      'thumbnail_uri' => string '' (length=0)
      'published' => string '2002-04-03 00:00:00' (length=19)
      'summary' => string 'The summary of the recipe is that it is really good!' (length=52)
      'review' => string 'The review of this recipe is awesome! More please!' (length=50)
      'prepTime' => string '70' (length=2)
      'cookTime' => string '30' (length=2)
      'totalTime' => string '140' (length=3)
      'nutrition' => string 'No calories here.' (length=17)
      'instructions' => string 'I instruct you to cook it long and good, until it&#39;s warm' (length=60)
      'yield' => string 'It yields enough for me and you.' (length=32)
      'ingredient' => string '2 apples, one banana, and 18 lemons' (length=35)
      'author' => string 'John Sample Man' (length=12)
      'dietary_restrictions' => 
        array (size=2)
          4 => string 'Gluten-Free' (length=11)
          7 => string 'Grain Free' (length=10) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T00:36:09.103

你想做一个嵌套数组搜索，[这个问题及其答案](https://stackoverflow.com/questions/2693310/search-for-values-in-nested-array)有很多解决问题的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T00:37:16.280

看看[`array_filter()`](http://php.net/array-filter)。您可以使用它来检查当前条目是否与搜索词匹配，如下所示：

```
$search = Array(
    "recipeType"=>"Appetizer",
    "dietary_restrictions"=>"Low fat"
);
$results = array_filter($big_array,function($e) use ($search) {
    foreach($search as $k=>$v) {
        if( is_array($e[$k])) {
            if( !array_search($v,$e[$k])) return false;
        }
        elseif(strcasecmp($v,$e[$k]) != 0) return false;
    }
    return true;
}); 
```

# objectify - Objectify Ref.get() 调用了两次

> ID：14553939
> 
> 赞同：0
> 
> 时间：2013-01-28T00:31:26.340
> 
> 标签：objectify

如果我第二次调用 Ref<>.get() ，它是查询数据存储还是使用已经加载的值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T03:42:25.467

它只进入数据存储（或内存缓存，或其他）一次。该值缓存在 Ref 本身中。

# ios - 在情节提要崩溃中放松

> ID：14553941
> 
> 赞同：1
> 
> 时间：2013-01-28T00:31:36.317
> 
> 标签：ios, ios6, uistoryboardsegue

我正在编写一个具有多个 (3) 视图的应用程序。如果我从 3 到 2 到 1 展开两次，最后一次展开会使应用程序崩溃并显示以下消息：

> ABGViewController setResultE1:]：无法识别的选择器发送到实例 0x751d4b0'

ResultE1 是第三个视图上的标签。如果我将目的地取消到第二个 segue，则不会发生这种情况。怎么了？我无法意识到冲突在哪里。

这是第一个 segue（这是崩溃的展开，但如果我删除视图 3rd 则不会崩溃）：

```
-(void) prepareForSegue:(UIStoryboardSegue *)segue sender: (id)sender
{
    ResultsABGViewController *destination=[segue destinationViewController];       
    {
        if (na<135)
        {
            destination.Result4=@"Hypo";
        } 
    }
} 
```

这是第二个转场（如果`if _lbl....resultE1`取消，则不会发生错误，但如果我删除第三个视图，它会起作用。它调用 ResultE1 似乎导致崩溃）：

```
-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    ElectrolytesViewController *destination=[segue destinationViewController];

    if (_lblResult4.text=@"Hypo")
    {
      destination.ResultE1=@"yyy";
    }
} 
```

# security - 在移动网站中嵌入 youtube 视频有效，但“域协议和端口必须匹配”错误正在干扰浏览器

> ID：14553944
> 
> 赞同：0
> 
> 时间：2013-01-28T00:32:04.610
> 
> 标签：security, jquery-mobile, youtube, embed, mobile-website

我正在尝试通过 jQuery 注入以下代码，将 youtube 视频动态嵌入到移动网页中。

$("#tgetId").append("http://www.youtube.com/embed/oHg5SJYRHA0' frameborder='0'>");

我正在 chrome ios 上对此进行测试，并且视频确实可以正确渲染，但是网页的某些部分似乎认为视频没有渲染，并且每隔半秒左右我就会收到以下错误的新实例。

```
Unsafe JavaScript attempt to access frame with URL http://mydomain.html from frame with URL http://www.youtube.com/embed/oHg5SJYRHA0\. Domains, protocols and ports must match. 
```

这似乎真的阻塞了浏览器并导致加载事件回调函数（id '第一行代码'）一遍又一遍地触发。

$('iframe').load(function(){ //第一行代码 $(this).load(function(){ //第二行代码 }) });

有一个更好的方法吗。谁能解释我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T02:31:59.417

这修复了它：

```
<iframe scrolling='no' class='youtube-player' style='height:200px;width:100%' src='https://www.youtube.com/embed/oHg5SJYRHA0?html5=1' frameborder='0'></iframe> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-29T06:42:55.743

不知道你在做什么

> `$("#tagetId").append("http://www.youtube.com/embed/oHg5SJYRHA0' frameborder='0'>");`

但这看起来像是附加了格式错误的 HTML。

也许您只是没有附加整个 iframe 标记？

# c# - 在反序列化之前从我的 JSON 中删除奇怪的隐藏字符

> ID：14553954
> 
> 赞同：0
> 
> 时间：2013-01-28T00:33:33.360
> 
> 标签：c#, regex, serialization

我有一些 JSON 被发送给我，当它试图被反序列化时会中断。它似乎包含一颗黑色钻石，`?`里面有一个。我看不到这个角色，但它显然就在那里，而且它在我的系统上失败了。

如何摆脱这种情况并仍然保持我的 JSON 完整以进行反序列化？

**更新：**

这是我的 JSON 中间的示例：

```
"UDF5" : "�65", 
```

我什至愿意通过 RegEx 完全从我的 JSON 中删除这个属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T02:06:05.623

作为回答：[使用正则表达式删除一段字符串（JSON字符串）](https://stackoverflow.com/questions/14554147/remove-piece-of-string-json-string-with-regex/14554202#14554202)并根据您在该问题中提供的格式（我假设将编辑到这个）：

假设我可以依赖您在上面显示的格式，并且它是每个运行正则表达式的格式之一，这可以像这样简单地完成

`([\S\s]*\"])\"UDF5\" : \"[\S\s]*?\",([\S\s]*)`

使用反向引用 $1$2 引用 UDF5 字段之前和之后的部分来写回。

如果有要删除的换行符，我现在不这样做。这可能会更好 - 如果其他人有时间更正或提供额外的答案。但为了让您获得紧急修复，我希望这会有所帮助。

# r - 针对某些初始值产生 NaN 的函数的优化

> ID：14553955
> 
> 赞同：1
> 
> 时间：2013-01-28T00:33:42.910
> 
> 标签：r, optimization, nan, arbitrary-precision

我想找到以下目标函数的所有局部最小值

```
func <- function(b){Mat=matrix(c(+0.5*1/((1/(exp(-b[1]-b[2]*-5)+1))*(1-(1/(exp(-b[1]-b[2]*-5)+1))))*exp(-b[1] - b[2] * -5)/(exp(-b[1] - b[2] * -5) + 1)^2*exp(-b[1] - b[2] * -5)/(exp(-b[1] - b[2] * -5) + 1)^2+0.5*1/((1/(exp(-b[1]-b[2]*5)+1))*(1-(1/(exp(-b[1]-b[2]*5)+1))))*exp(-b[1] - b[2] * 5)/(exp(-b[1] - b[2] * 5) + 1)^2*exp(-b[1] - b[2] * 5)/(exp(-b[1] - b[2] * 5) + 1)^2,+0.5*1/((1/(exp(-b[1]-b[2]*-5)+1))*(1-(1/(exp(-b[1]-b[2]*-5)+1))))*exp(-b[1] - b[2] * -5) * -5/(exp(-b[1] - b[2] * -5) + 1)^2*exp(-b[1] - b[2] * -5)/(exp(-b[1] - b[2] * -5) + 1)^2+0.5*1/((1/(exp(-b[1]-b[2]*5)+1))*(1-(1/(exp(-b[1]-b[2]*5)+1))))*exp(-b[1] - b[2] * 5) * 5/(exp(-b[1] - b[2] * 5) + 1)^2*exp(-b[1] - b[2] * 5)/(exp(-b[1] - b[2] * 5) + 1)^2,+0.5*1/((1/(exp(-b[1]-b[2]*-5)+1))*(1-(1/(exp(-b[1]-b[2]*-5)+1))))*exp(-b[1] - b[2] * -5)/(exp(-b[1] - b[2] * -5) + 1)^2*exp(-b[1] - b[2] * -5) * -5/(exp(-b[1] - b[2] * -5) + 1)^2+0.5*1/((1/(exp(-b[1]-b[2]*5)+1))*(1-(1/(exp(-b[1]-b[2]*5)+1))))*exp(-b[1] - b[2] * 5)/(exp(-b[1] - b[2] * 5) + 1)^2*exp(-b[1] - b[2] * 5) * 5/(exp(-b[1] - b[2] * 5) + 1)^2,+0.5*1/((1/(exp(-b[1]-b[2]*-5)+1))*(1-(1/(exp(-b[1]-b[2]*-5)+1))))*exp(-b[1] - b[2] * -5) * -5/(exp(-b[1] - b[2] * -5) + 1)^2*exp(-b[1] - b[2] * -5) * -5/(exp(-b[1] - b[2] * -5) + 1)^2+0.5*1/((1/(exp(-b[1]-b[2]*5)+1))*(1-(1/(exp(-b[1]-b[2]*5)+1))))*exp(-b[1] - b[2] * 5) * 5/(exp(-b[1] - b[2] * 5) + 1)^2*exp(-b[1] - b[2] * 5) * 5/(exp(-b[1] - b[2] * 5) + 1)^2),2,2);d=(det(Mat));return(d)} 
```

'func' 是 Logistic 回归模型的 Fisher 信息矩阵的行列式，是参数 b1 和 b2 的函数，其中 b1 属于 [-.3, .3]，b2 属于 [6, 8]

假设 b = c(b1, b2) 的这两个初始值

```
> in1 <- c(-0.04785405, 6.42711047)
> in2 <- c(0.2246729, 7.5211575) 
```

具有初始值的局部最小值`in1`为：

```
> optim(in1, fn = func, lower = c(-.3, 6), upper = c(.3, 8), method = "L-BFGS-B")

$par
[1] -0.04785405  6.42711047

$value
[1] 3.07185e-27

$counts
function gradient 
   1        1 

$convergence
[1] 52

$message
[1] "ERROR: ABNORMAL_TERMINATION_IN_LNSRCH" 
```

从优化过程中发生的终止中可以看出，`$massage`最小值无法计算并作为局部最优值`optim`返回 。`in1`

对于“in2”，也会出现错误：

```
> optim(in2, fn = func, lower = c(-.3, 6), upper = c(.3, 8), method = "L-BFGS-B")

Error in optim(in2, fn = func, lower = c(-0.3, 6), upper = c(0.3, 8),  : 
L-BFGS-B needs finite values of 'fn' 
```

发生此错误是因为 NaN` 的`func`值`in2' is`：

```
> func(in2)
[1] NaN 
```

然而，对于`in1`目标函数的值，`in1`计算但优化终止，因为`optim`无法继续计算另一个初始值：

```
> func(in1)
[1] 3.07185e-27 
```

让我定义没有 det 的 func ，就像矩阵一样，看看发生了什么：

```
Mat.func <- function(b){Mat=matrix(c(+0.5*1/((1/(exp(-b[1]-b[2]*-5)+1))*(1-(1/(exp(-b[1]-b[2]*-5)+1))))*exp(-b[1] - b[2] * -5)/(exp(-b[1] - b[2] * -5) + 1)^2*exp(-b[1] - b[2] * -5)/(exp(-b[1] - b[2] * -5) + 1)^2+0.5*1/((1/(exp(-b[1]-b[2]*5)+1))*(1-(1/(exp(-b[1]-b[2]*5)+1))))*exp(-b[1] - b[2] * 5)/(exp(-b[1] - b[2] * 5) + 1)^2*exp(-b[1] - b[2] * 5)/(exp(-b[1] - b[2] * 5) + 1)^2,+0.5*1/((1/(exp(-b[1]-b[2]*-5)+1))*(1-(1/(exp(-b[1]-b[2]*-5)+1))))*exp(-b[1] - b[2] * -5) * -5/(exp(-b[1] - b[2] * -5) + 1)^2*exp(-b[1] - b[2] * -5)/(exp(-b[1] - b[2] * -5) + 1)^2+0.5*1/((1/(exp(-b[1]-b[2]*5)+1))*(1-(1/(exp(-b[1]-b[2]*5)+1))))*exp(-b[1] - b[2] * 5) * 5/(exp(-b[1] - b[2] * 5) + 1)^2*exp(-b[1] - b[2] * 5)/(exp(-b[1] - b[2] * 5) + 1)^2,+0.5*1/((1/(exp(-b[1]-b[2]*-5)+1))*(1-(1/(exp(-b[1]-b[2]*-5)+1))))*exp(-b[1] - b[2] * -5)/(exp(-b[1] - b[2] * -5) + 1)^2*exp(-b[1] - b[2] * -5) * -5/(exp(-b[1] - b[2] * -5) + 1)^2+0.5*1/((1/(exp(-b[1]-b[2]*5)+1))*(1-(1/(exp(-b[1]-b[2]*5)+1))))*exp(-b[1] - b[2] * 5)/(exp(-b[1] - b[2] * 5) + 1)^2*exp(-b[1] - b[2] * 5) * 5/(exp(-b[1] - b[2] * 5) + 1)^2,+0.5*1/((1/(exp(-b[1]-b[2]*-5)+1))*(1-(1/(exp(-b[1]-b[2]*-5)+1))))*exp(-b[1] - b[2] * -5) * -5/(exp(-b[1] - b[2] * -5) + 1)^2*exp(-b[1] - b[2] * -5) * -5/(exp(-b[1] - b[2] * -5) + 1)^2+0.5*1/((1/(exp(-b[1]-b[2]*5)+1))*(1-(1/(exp(-b[1]-b[2]*5)+1))))*exp(-b[1] - b[2] * 5) * 5/(exp(-b[1] - b[2] * 5) + 1)^2*exp(-b[1] - b[2] * 5) * 5/(exp(-b[1] - b[2] * 5) + 1)^2),2,2);d=Mat;return(d)} 
```

我们得到

```
 > Mat.func(in1)
              [,1]         [,2]
         [1,] 1.109883e-14 2.784007e-15
         [2,] 2.784007e-15 2.774708e-13

        > Mat.func(in2)
              [,1] [,2]
          [1,]  Inf  Inf
          [2,]  Inf  Inf 
```

`Mat.func(in2)`因此，通过双精度，元素的值为`Inf`. 我还`Mat.func`用 mpfr 函数重写：

```
Mat.func.mpfr <-function(b, prec){ d=c(+0.5*1/((1/(exp(-mpfr(b[1], precBits = prec)-mpfr(b[2], precBits = prec)*-5)+1))*(1-(1/(exp(-mpfr(b[1], precBits = prec)-mpfr(b[2], precBits = prec)*-5)+1))))*exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * -5)/(exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * -5) + 1)^2*exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * -5)/(exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * -5) + 1)^2+0.5*1/((1/(exp(-mpfr(b[1], precBits = prec)-mpfr(b[2], precBits = prec)*5)+1))*(1-(1/(exp(-mpfr(b[1], precBits = prec)-mpfr(b[2], precBits = prec)*5)+1))))*exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * 5)/(exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * 5) + 1)^2*exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * 5)/(exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * 5) + 1)^2,
                                   +0.5*1/((1/(exp(-mpfr(b[1], precBits = prec)-mpfr(b[2], precBits = prec)*-5)+1))*(1-(1/(exp(-mpfr(b[1], precBits = prec)-mpfr(b[2], precBits = prec)*-5)+1))))*exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * -5) * -5/(exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * -5) + 1)^2*exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * -5)/(exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * -5) + 1)^2+0.5*1/((1/(exp(-mpfr(b[1], precBits = prec)-mpfr(b[2], precBits = prec)*5)+1))*(1-(1/(exp(-mpfr(b[1], precBits = prec)-mpfr(b[2], precBits = prec)*5)+1))))*exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * 5) * 5/(exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * 5) + 1)^2*exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * 5)/(exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * 5) + 1)^2,
                                   +0.5*1/((1/(exp(-mpfr(b[1], precBits = prec)-mpfr(b[2], precBits = prec)*-5)+1))*(1-(1/(exp(-mpfr(b[1], precBits = prec)-mpfr(b[2], precBits = prec)*-5)+1))))*exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * -5)/(exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * -5) + 1)^2*exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * -5) * -5/(exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * -5) + 1)^2+0.5*1/((1/(exp(-mpfr(b[1], precBits = prec)-mpfr(b[2], precBits = prec)*5)+1))*(1-(1/(exp(-mpfr(b[1], precBits = prec)-mpfr(b[2], precBits = prec)*5)+1))))*exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * 5)/(exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * 5) + 1)^2*exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * 5) * 5/(exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * 5) + 1)^2,
                                   +0.5*1/((1/(exp(-mpfr(b[1], precBits = prec)-mpfr(b[2], precBits = prec)*-5)+1))*(1-(1/(exp(-mpfr(b[1], precBits = prec)-mpfr(b[2], precBits = prec)*-5)+1))))*exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * -5) * -5/(exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * -5) + 1)^2*exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * -5) * -5/(exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * -5) + 1)^2+0.5*1/((1/(exp(-mpfr(b[1], precBits = prec)-mpfr(b[2], precBits = prec)*5)+1))*(1-(1/(exp(-mpfr(b[1], precBits = prec)-mpfr(b[2], precBits = prec)*5)+1))))*exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * 5) * 5/(exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * 5) + 1)^2*exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * 5) * 5/(exp(-mpfr(b[1], precBits = prec) - mpfr(b[2], precBits = prec) * 5) + 1)^2)
                               Mat = new("mpfrMatrix", d, Dim = c(2L, 2L))
                               return(Mat)} 
```

因此：

```
require(Rmpfr)
> Mat.func.mpfr(c(in1), prec = 54)
'mpfrMatrix' of dim(.) =  (2, 2) of precision  54   bits 
     [,1]                   
 [1,] 1.10988301365972506e-14
 [2,] 2.78400749725484580e-15
      [,2]                   
 [1,] 2.78400749725484580e-15
 [2,] 2.77470753414931256e-13

 > Mat.func.mpfr(c(in2), prec = 54)
 'mpfrMatrix' of dim(.) =  (2, 2) of precision  54   bits 
      [,1] [,2]
 [1,]  Inf  Inf
 [2,]  Inf  Inf

 > Mat.func.mpfr(c(in2), prec = 55)
 'mpfrMatrix' of dim(.) =  (2, 2) of precision  55   bits 
      [,1]                    
 [1,]  4.16032108702067276e-17
 [2,] -8.34300174643550123e-17
      [,2]                    
 [1,] -8.34300174643550154e-17
 [2,]  1.04008027175516816e-15 
```

因此，精度为 55，矩阵元素的值`Inf`不再存在。不幸的是， `mpfr`函数改变了目标的类别，也`det`没有 r 优化函数不能应用，为了澄清，我提供了两个例子：

```
> class(mpfr (1/3, 54))
[1] "mpfr"
attr(,"package")
[1] "Rmpfr"

## determinant
example1 <- function(x){
  d <- c(mpfr(x, prec = 54), 3 * mpfr(x, prec = 54), 5 * mpfr(x, prec = 54), 7 * mpfr(x, prec = 54))
  Mat = new("mpfrMatrix", d, Dim = c(2L, 2L))
  return(det(Mat))
}

> example1(2)
Error in UseMethod("determinant") : 
no applicable method for 'determinant' applied to an object of class "c('mpfrMatrix',    'mpfrArray', 'Mnumber', 'mNumber', 'mpfr', 'list', 'vector')"

##optimization 
example2 <- function(x)  ## Rosenbrock Banana function
   100 * (mpfr(x[2], prec = 54) - mpfr(x[1], prec = 54) * mpfr(x[1], prec = 54 ))^2 + (1 - mpfr(x[1], prec = 54))^2

> example2(c(-1.2, 1))
1 'mpfr' number of precision  54   bits 
[1] 24.1999999999999957
> optim(c(-1.2,1), example2)
Error in optim(c(-1.2, 1), example2) : 
(list) object cannot be coerced to type 'double' 
```

因此，使用 mpfr 无法解决问题。

为了找到所有的局部最小值，应该编写一个应用不同**随机初始值的算法。**但是可以看出，对于函数产生的一些初始值`NaN` （忽略这些值不是一个好主意，因为它通常可能导致丢失一些局部最小值，特别是对于具有大量局部最优值的函数）。

我想知道是否有任何 R 包可以进行**任意精度**的优化过程以避免`NaN`目标函数？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T15:27:40.183

我认为**答案**（我认为“agstudy”也给出了）是：确保您最小化的函数*不*返回 NaN（或 NA），而是返回 +Inf（如果您最小化，或者 -Inf 如果您最大化）。

第二：而不是 log(det(.)) 你*真的*应该使用
{ r <- determinant(., log=TRUE) ; if(r$sign <= 0) -Inf else r$modulus }

这也更准确。{提示：看看 det 在 R 中是如何定义的！}

现在到Rmpfr，我会单独回复。它*应该*像标准 R 一样使用“mpfr”-numbers，....Rmpfr 的作者说....但是您可能需要一点小心。但是，不应需要 tryCatch()。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-28T02:03:13.640

我试图重新制定你可怕的（对不起这个词）目标函数。我很确定 w 我们可以找到更简单的形式。希望其他人可以使用它来找到您的优化问题的解决方案...

```
func1 <- function(b){
  A <- exp(-b[1]+5*b[2])
  C <- exp(-b[1]-5*b[2])
  A1 <- A + 1
  C1 <- C + 1
  D <- 1/A1
  H <- 1/C1
  K <- D*(1-D)
  J <- H*(1-H)
  M <- (A/A1^2)^2/K
  N <- (C/C1^2)^2/J

Mat <- matrix(c( 1 *M    + 1  *N,
                -5 *M    + 5  *N,
                -5 *M    + 5  *N,
                25 *M    + 25 *N),2,2)

  Mat <- 0.5*Mat
  d <- log(det(Mat))
  return(d)
} 
```

**编辑**

正如我所说，您可以再次简化您的功能。它看起来好多了

```
func1 <- function(b){
  A <- exp(-b[1]+5*b[2])
  C <- exp(-b[1]-5*b[2])
  A1 <- A + 1
  C1 <- C + 1
  M <- A/A1^2
  N <- C/C1^2
  det.Mat <-25*M*N
  log(det.Mat)
} 
```

这里有两个函数之间的一些测试。

```
func1(c(1,2))
[1] -16.7814
> func1(c(8,2))
[1] -17.03498
> func1(c(10,2))
[1] -18.16742
> func(c(10,2))
[1] -18.16742
> func(c(10,5))
[1] -46.83608 
```

重新制定最大限度地减少了下溢/上溢的可能性（不能将中间结果存储在寄存器中）..这就是为什么我们得到 Inf 而不是 NA（见下文），它是无限的但仍然是一个**数字**，适合进一步计算相反到 NaN 这就像一个 NA 值..

> func(c(10,100))
> [1] NaN func1(c(10,100)) [1] -Inf

现在我以更简单的形式测试您的优化指令，它会收敛，如您所见：

```
in1 <- c(-0.04785405, 6.42711047)
in2 <- c(0.2246729, 7.5211575)
ll <- optim(in1, fn = func1, lower = c(-.3, 6), upper = c(.3, 8), method = "L-BFGS-B")
 do.call(rbind,ll)

            function                                           gradient                                          
par         "-0.04785405"                                      "8"                                               
value       "-76.7811241751318"                                "-76.7811241751318"                               
counts      "2"                                                "2"                                               
convergence "0"                                                "0"                                               
message     "CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL" "CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL" 
```

in2 也一样

```
optim(in2, fn = func1, lower = c(-.3, 6), upper = c(.3, 8), method = "L-BFGS-B")
$par
[1] 0.2246729 8.0000000

$value
[1] -76.78112

$counts
function gradient 
       2        2 

$convergence
[1] 0

$message
[1] "CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-29T15:17:03.767

使用 - 生成的矩阵回答您的问题`Rmpfr`：（虽然效率不高......！......）：

是的，determinant() 不适用于 mpfr 矩阵， *但是*您可以简单地使用类似的东西

```
M <- Mat.func.mpfr(in2, prec = 55)
m <- as(M, "matrix")
ldm <- determinant(m) # is already  log() ! 
```

然后使用

```
 { r <- determinant(., log=TRUE) ; if(r$sign <= 0) -Inf else r$modulus } 
```

我在上面提到过......比使用 log(det(.)) 的“设计错误”要好得多

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-28T01:20:35.377

对于任意精度： `gmp`和/或`Rmpfr`. 不过，您可能最好`tryCatch`在代码中添加一些内容（以避免在给定尝试导致该`NaN`错误时崩溃）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-29T11:16:16.763

使用`mpfr`可用于避免`NaN`在函数中进行计算（以及在优化算法中停止）。但是 `mpfr`输出是一个 'mpfr' 类，一些 R 函数（例如`optim`and `det`）可能不适用于这种类。像往常一样 `as.numeric`，可以将“mpfr”类转换为“数字”类。

```
exp(9000)
[1] Inf

require(Rmpfr)
number <- as.numeric(exp(mpfr(9000, prec = 54)))

class(number)
[1] "numeric"

round(number)
[1] 1.797693e+308

number * 1.797692e-308
[1] 3.231699

number * 1.797693e-307
[1] 32.317

number * (1/number)
[1] 1

number * .2
[1] 3.595386e+307

number * .9
[1] 1.617924e+308

number * 1.1
[1] Inf

number * 2
[1] Inf

number / 2
[1] 8.988466e+307

number + 2
[1] 1.797693e+308

number + 2 * 10 ^ 291
[1] 1.797693e+308

number + 2 * 10 ^ 292
[1] Inf

number - 2
[1] 1.797693e+308

number - 2 * 10 ^ 307
[1] 1.597693e+308

number - 2 * 10 ^ 308
[1] -Inf 
```

现在考虑以下矩阵函数：

```
mat <- function(x){
x1 <- x[1]
x2 <- x[2]
d = matrix(c(exp(5 * x1+ 4 * x2), exp(9 * x1), exp(2 * x2 + 4 * x1),
           exp(3 * x1)), 2, 2)
         return(d)
} 
```

该矩阵的元素极有可能产生`Inf`：

```
mat(c(300, 1))
    [,1] [,2]
[1,]  Inf  Inf
[2,]  Inf  Inf 
```

所以如果 `det`在函数环境中返回，而不是我们得到的数字结果`NaN`，`optim`函数肯定会被终止。为了解决这个问题，这个函数的行列式写成`mpfr`：

```
func <- function (x){
  x1 <- mpfr(x[1], prec = precision)
  x2 <- mpfr(x[2], prec = precision)
  mat <- new("mpfrMatrix",c(exp(5 * x1+ 4 * x2), exp(9 * x1), exp(2 * x2 + 4 * x1),   exp(3 * x1)), Dim = c(2L,2L))
  d <- mat[1, 1] * mat[2, 2] - mat[2, 1] * mat[1, 2]
  return(as.numeric(-d))
} 
```

那么对于 x1 = 3 和 x2 = 1，我们有：

```
func(c(3,1))
[1] 6.39842e+17

optim(c(3, 1),func)

$par
[1] 0.4500 1.4125

$value
[1] -4549.866

$counts
function gradient 
  13       NA 

$convergence
[1] 0

$message
NULL 
```

对于 x1 = 300 和 x2 = 1：

```
func(c(300,1))
[1] 1.797693e+308

optim(c(300, 1),func)
$par
[1] 300   1

$value
[1] 1.797693e+308

$counts
function gradient 
   3       NA 

$convergence
[1] 0

$message
NULL 
```

可以看出，`optim`优化过程没有停止甚至声称收敛。但是，似乎没有迭代，`optim`只是将初始值作为局部最小值返回（当然，1.797693e+308 不是这个函数的局部最小值！！）。在这种情况下，应用`mpfr`程序可以防止优化过程的终止，但是如果我们真的希望优化算法从它们的值是`Inf`R 双精度的这些点开始并继续迭代以达到局部最小值，除了定义一个函数对于“mpfr”类，优化功能也应该具有与“mpfr”类一起使用的能力。

# rdfa - 如何为“textNode HTMLElement textNode”之类的内容创建 RDFa 定义？

> ID：14553956
> 
> 赞同：-1
> 
> 时间：2013-01-28T00:34:05.017
> 
> 标签：rdfa, symfony-cmf, hallo-js

我试图为基于[symfony-cmf](http://symfony.com/doc/master/cmf/index.html)的 CMS 界面创建一些自定义块。为了使用 createphp/hallo 内联编辑这些块，我需要为它们创建 RDFa 映射。

包含块的基本示例如下所示：

```
<type
        xmlns:sioc="http://rdfs.org/sioc/ns#"
        xmlns:dcterms="http://purl.org/dc/terms/"
        xmlns:skos="http://www.w3.org/2004/02/skos/core#"
        typeof="sioc:Post"
        >
    <attribute key="class" value="articleContainer span3"/>
    <children>
        <property property="dcterms:title" identifier="title" tag-name="h2"/>
        <property property="sioc:content" identifier="content" />
    </children>
</type> 
```

这会产生这样的结果：

```
<h2>The title input</h2>
<p>the content, however i beleive the actual &lt;p&gt; tag is applied by the editor</p> 
```

这一切都很好......我很难弄清楚如何为这样的资源定义这个映射：

`<h1>Text string with <strong>emphasized phrase</strong> in the middle</h1>`

我可能只使用该`sioc:content`类型，然后依靠用户在编辑器中“加粗”强调的短语，但我宁愿明确编辑它。

有没有办法做到这一点？另外，如果有人可以向我指出可靠的 RDFa 教程，那就太好了。我的 google-fu 通常很强大，但我似乎只能找到实际的规范，以及一堆关于看似不相关的用法的帖子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-13T12:21:14.250

RDFa 映射的想法是指定要使用哪些标签呈现文档的哪些属性。实际内容通常是所见即所得。我猜 RDFa 非常复杂，它会支持像您所要求的那样的内联嵌套信息。但是读取此 XML 配置以生成正确数据的 midgard/createphp 组件不支持嵌套内容。我不确定 create.js 是否会支持它，但我认为不会。

请注意，您可以映射子级并输出整个内容层次结构。但这不会处理您强调的片段。

# d3.js - 在 d3 中添加和删除元素时遇到问题

> ID：14553962
> 
> 赞同：2
> 
> 时间：2013-01-28T00:34:55.940
> 
> 标签：d3.js, exit

我的目标是从我的条形图中删除一个数据点。

**然后它会自我更新：**
更新 X 和 Y 轴
更新实际的条形图
更新图例

**我遇到的问题：**
当我 exit().remove() 图表中的矩形时，代码也会删除图例中的矩形。当我尝试 enter() 图例中的矩形时，它们不会出现。我不确定这里发生了什么，但由于数据更改，我无法成功添加和删除元素。任何帮助，将不胜感激。

**我认为我遇到问题的代码片段：**
这也是删除图例中的矩形的部分（我不确定我应该在这里还是在图例的输入/更新/删除部分执行此操作）

下面的代码在用户单击“全部删除”按钮后立即执行。我的意图是只删除一根柱（名为“ALL”的柱）并更新图表。

```
 //Select rectangles
            var bars = svg.selectAll("rect")
                          .data(dataset, function(d) { return d.State; });

            //Enter rectangles
            bars.enter()
                .append("rect")
                .style("fill", function(d,i) { return color(i) })
                .attr("x", function(d) { return xScale(d.State); })
                .attr("y", function(d) { return yScale(d.CustomerCount) })
                .attr("width", xScale.rangeBand()) //returns rangeRoundBands width
                .attr("height", function(d) { return h - yScale(d.CustomerCount) });                                  

            //Update rectangles
            bars.transition()
                .duration(1000)
                .style("fill", function(d,i) { return color(i) })
                .attr("x", function(d) { return xScale(d.State); })
                .attr("y", function(d) { return yScale(d.CustomerCount) })
                .attr("width", xScale.rangeBand()) //returns rangeRoundBands width
                .attr("height", function(d) { return h - yScale(d.CustomerCount) });

            //Exit rectangles       
            bars.exit()
                .transition()
                .duration(500)
                .attr("x", w)
                .remove(); 
```

**这是完整的代码： http:**
[//plnkr.co/edit/Nue5bocQsI4E6D5wfNSP](http://plnkr.co/edit/Nue5bocQsI4E6D5wfNSP)

**这是稍微小一点的代码：**
我试图尽可能地减少代码，但它仍然很大。
[http://jsfiddle.net/aNQWV/](http://jsfiddle.net/aNQWV/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T01:14:29.443

在您更新数据的部分中，您说：

```
var bars = svg.selectAll("rect")
    .data(dataset, function(d) { return d.State; }); 
```

问题是此时 svg 包含两种矩形。一种对应于条形，另一种是图例的一部分。这意味着您要将新数据加入到这种矩形组合中，而实际上您只想将新数据与条形加入。

因此，您需要一个仅针对条形矩形的更具体的选择器。典型的方法是在创建这些矩形时为它们添加一个类：

```
svg.selectAll(".bar")
    .data(input)
  .enter().append("rect")
    .attr("class", "bar"); 
```

然后在您更新数据的部分中，您会说：

```
var bars = svg.selectAll(".bar")
    .data(dataset, function(d) { return d.State; }); 
```

# javascript - 在ckEditor（所见即所得）中如何设置默认点击按钮

> ID：14553971
> 
> 赞同：1
> 
> 时间：2013-01-28T00:36:38.733
> 
> 标签：javascript, ckeditor, wysiwyg, fckeditor

执行 ckEditor 后，我希望已单击特定按钮（以编程方式）。例如，我希望按钮 blockquote 已经被点击： ![在此处输入图像描述](../Images/207940c48b43726e523cfe48c85060b0.png) 这样当用户打开 ckEditor 时，与 blockquote 按钮相关的功能已经被触发。我在哪里看到过，但我不记得了。有点像

```
 dialoge.click ='blockquote ' or something 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T06:40:15.910

在 Config.js 中添加以下内容：

```
CKEDITOR.on( 'instanceReady',function(ev) {
            ev.editor.execCommand( 'blockquote' );
        } ); 
```

注意：命令总是小写。它是“blockquote”或“bulletedlist”，而不是“BlackQuote”或“BulletedList”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T13:52:20.940

尝试这个：

```
CKEDITOR.replace( 'editor1', {
    on: {
        instanceReady: function() {
            this.execCommand( 'blockquote' );
        }
    }
} ); 
```

# php - PHP 新手问题 - 登录和 Cookie

> ID：14553973
> 
> 赞同：-1
> 
> 时间：2013-01-28T00:36:50.880
> 
> 标签：php, html, forms, cookies, login-system

我只是从 PHP 开始，如果我感到困惑，很抱歉。

我创建了我的索引页面 (index.php)，方法是使用 HTML 布局并使用 CSS 设置样式。

我有几个问题想问一下，以便对我需要看什么或做什么有一个基本的了解。

所以在我的主页（index.php）上，我有一个注册和登录表单。我还不一定担心注册表格，但更多的是登录表格。我还找到了有关如何执行此操作的教程，但它的工作方式与我希望它的工作方式略有不同。

我需要用户登录并转到控制面板（可能是 control.php）。我猜这相当简单。但是如果用户出错，我需要在索引页面（在登录表单下）显示错误消息。所以我需要创建一个名为 login.php 的单独页面来设置表单上的操作，还是应该将操作设置为 index.php 并将登录代码放在主页上。

另一件事是语言转换器。首先，我以法语、西班牙语，当然还有英语提供这个网站。我有一个选择框，onchange 运行一个 javascript 函数，将所有文本（使用 .InnerHTML）更改为该特定语言，但我想确保用户不必每次访问网站时都这样做。我猜你会为此使用cookie。但是我该怎么做呢？通过使用“表格”，我可以（在页面加载时）检查以查看哪种语言并转到 www.mysite.com/index.php?english.. 我对此完全陌生.. 所以基本上，我问你会怎么做？我可以保留 Javascript 函数，还是必须将其重新编码为 PHP（文本转换器）？

任何意见，答案或建议表示赞赏！

谢谢！-瑞安

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T00:41:52.080

结构完全取决于您 - 您可以将所有内容放在一个页面上，或者为所有内容（索引、登录、控制、错误等）提供大量页面。一旦您的网站发展壮大，您需要决定什么最有效。

关于语言更改，您也可以扩展 Javascript 以设置语言 cookie。在每个页面的顶部（考虑包含或配置文件的好时机，这样您就不必重复您的代码）您需要检查该 cookie，如果它存在并且它具有适当的值，您可以要么在页面加载后触发您的 Javascript 来更改它，要么使用 PHP 自动生成翻译页面。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-28T11:11:20.547

理想情况下，我们会看到一些您自己的代码......但是......

> 我需要用户登录并转到控制面板（可能是 control.php）。我猜这相当简单。

**1) 你需要为你的 HTML 表单命名，并给它一个 index.php 的动作；**

见：[http ://www.w3schools.com/tags/tag_form.asp](http://www.w3schools.com/tags/tag_form.asp)

```
<form action="index.php" method="post"> 
```

**2) 使用合适的 ID 和名称命名您的用户名和登录框；**

见：[http ://www.w3schools.com/tags/att_input_name.asp](http://www.w3schools.com/tags/att_input_name.asp)

```
<input type="text" name="name"><br>
<input type="text" name="password"><br> 
```

**3) 添加一个带有一些内联 PHP 的 Div 标签，让您的用户知道他们的用户名或密码是否不正确；**

见：[http ://www.w3schools.com/php/default.asp](http://www.w3schools.com/php/default.asp)

```
<div><?PHP echo $ErrorText ?></div> 
```

**4) 添加提交按钮**

```
<input type="submit" value="Login"> 
```

**5) 添加一些 PHP，在提交表单时读取登录和密码框 PostBack 值；**

见：[http ://www.w3schools.com/php/php_post.asp](http://www.w3schools.com/php/php_post.asp)

```
$UserName = $_POST['name'];
$Password= $_POST['password']; 
```

6）添加一些代码和SQL来检查用户名和密码；

见： http: [//php.net/manual/en/mysqli.quickstart.php](http://php.net/manual/en/mysqli.quickstart.php)

```
$mysqli = new mysqli("localhost", "user", "password", "database");
if ($mysqli->connect_errno) {
    echo "Failed to connect to MySQL: (" . $mysqli->connect_errno . ") " . $mysqli->connect_error;
    die();
}

if (!($stmt = $mysqli->prepare("SELECT * FROM Users WHERE UserName = '$UserName'))) {
    echo "Prepare failed: (" . $mysqli->errno . ") " . $mysqli->error;
    die();
}

if (!$stmt->execute()) {
    echo "Execute failed: (" . $stmt->errno . ") " . $stmt->error;
    die();
}

if (!($res = $stmt->get_result())) {
    echo "Getting result set failed: (" . $stmt->errno . ") " . $stmt->error;
    die();
}

if ($res->row_count > 1) {
    echo "Too many users!";
    die();
    }

$row = $res->fetch_assoc(); 
```

**7）检查密码，如果正确，重定向到您的控制面板，否则报告您的错误；**

```
if ($row['Password'] == $Password)
{
    header('Location: http://www.example.com/control.php');
}
else
{
    $ErrorText = "Incorrect Username or Password!";
} 
```

您还需要将用户信息存储为 cookie 或会话。有关此信息，请参阅；[http://www.w3schools.com/php/php_cookies.asp](http://www.w3schools.com/php/php_cookies.asp)和[http://www.w3schools.com/php/php_sessions.asp](http://www.w3schools.com/php/php_sessions.asp)

正如 Shomz 所说，对于 Language Changer，有很多方法可以做到这一点。但是使用 PHP 显示所有文本是这里最好的方法。

请注意......我没有测试过上面的任何代码，所以可能会有奇怪的错误......但这应该能让你继续前进！

# jquery - 从视图中的多 N 个列表框中检索选择

> ID：14553974
> 
> 赞同：0
> 
> 时间：2013-01-28T00:36:52.037
> 
> 标签：jquery, asp.net-mvc

我的视图中有一个编辑器模板，它有一个名为服务类型的模型属性。简而言之，页面上可能会呈现 N 个列表框。

```
@Html.ListBoxFor(model => model.ServiceTypes, new MultiSelectList(RunLog.Domain.Lists.GlobalList.PartsServiceTypes(), "ID", "Name"), new { style = "width: 200px; height: 80px;", id = "lstbox", name = "listbox" } ) 
```

以下 Jquery .Load 函数呈现部分视图。在这个对话框中有一个带有复选框的树视图，一旦他们从树视图中选择/检查项目并点击选择，例如他们选择了 10 个复选框，点击选择 10 个列表 vbox 后将出现。有一个 jquery .load 从操作中获取信息并呈现列表框。

```
if (btnText == 'Select') {
                partTextArea = "";
                $("#parts :checkbox:checked").each(function () {

                    var v = $(this).val();
                    if (partTextArea.length > 0) {
                        partTextArea = partTextArea + "| ";

                    }
                    partTextArea = partTextArea + v;
                });

                $('body').css('cursor', 'wait');
                $("#inputParts").load(serviceListPartsUrl, { ServiceEntryID: $("#ServiceEntryID").val(), Parts: partTextArea });

                $('body').css('cursor', 'auto');
            } 
```

现在的问题是每次发生此 .load 后，多个列表框中先前选择的服务类型都会丢失。有任何想法吗？

# c++ - 发出 textChanged() 信号时获取 QTextEdit 更改

> ID：14553979
> 
> 赞同：5
> 
> 时间：2013-01-28T00:38:00.900
> 
> 标签：c++, qt, notepad, qtextedit

我有一个`QTextEdit`，我将`textChanged()`插槽连接到一个信号。发出信号时如何找到变化。例如，我想保存光标位置和写东西时写的字符。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T02:25:11.730

In the slot that gets called when the signal is emitted you can get the text with `QString str = textEdit->toplainText();`. Also you can store the previous version of the string and compare to get the character that was added and its position.

Regarding the cursor position you can us QTextCurosr class as in this example:

widget.h file:

```
#ifndef WIDGET_H
#define WIDGET_H

#include <QWidget>
#include <QTextEdit>
#include <QTextCursor>
#include <QVBoxLayout>
#include <QLabel>

class Widget : public QWidget
{
    Q_OBJECT

public:
    Widget(QWidget *parent = 0);

    ~Widget();

private slots:
    void onTextChanged();
    void onCursorPositionChanged();

private:
    QTextCursor m_cursor;
    QVBoxLayout m_layout;
    QTextEdit m_textEdit;
    QLabel m_label;
};

#endif // WIDGET_H 
```

widget.cpp file:

```
#include "widget.h"

#include <QString>

Widget::Widget(QWidget *parent)
    : QWidget(parent)
{
    connect(&m_textEdit, SIGNAL(textChanged()), this, SLOT(onTextChanged()));
    connect(&m_textEdit, SIGNAL(cursorPositionChanged()), this, SLOT(onCursorPositionChanged()));

    m_layout.addWidget(&m_textEdit);
    m_layout.addWidget(&m_label);

    setLayout(&m_layout);
}

Widget::~Widget()
{

}

void Widget::onTextChanged()
{
    // Code that executes on text change here
}

void Widget::onCursorPositionChanged()
{
    // Code that executes on cursor change here
    m_cursor = m_textEdit.textCursor();
    m_label.setText(QString("Position: %1").arg(m_cursor.positionInBlock()));
} 
```

main.cpp file:

```
#include <QtGui/QApplication>
#include "widget.h"

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);
    Widget w;
    w.show();

    return a.exec();
} 
```

# html - 这是一种纠正绝对 iframe 的 Internet Explorer 视图的方法吗？

> ID：14553980
> 
> 赞同：0
> 
> 时间：2013-01-28T00:38:04.830
> 
> 标签：html, css, internet-explorer, iframe

我有一个 iframe 用作索引文件来隐藏下一个网站的 url。

```
<iframe style="position:absolute; top:0px; left:0px; " src="  http://..." width="100%" height="100%" frameborder="0" scrolling="auto"></iframe> 
```

这一切都适用于我所有已知的浏览器，而不是 Internet Explorer（选中 9）。这是使它正确可见的简单方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T00:43:21.160

首先，将 html 属性与 css 混合是一件讨厌的事情。

无论如何，如果您正在寻找全屏 iframe，这应该可以完美地工作：

**CSS：**

```
/* notice you actually don't need absoulte positioning */
body,html,iframe {
   margin:0;
   padding:0;
   width: 100%;
   height: 100%;
}
body,html {
   overflow: hidden;
} 
```

**HTML：**

```
<html>
  // add head, css
<body>
   <iframe src=""></iframe>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T00:40:43.937

不幸的是，不是我发现的。相反，您需要使用 JavaScript 来监控窗口大小。

或者只使用常规框架：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN" "http://www.w3.org/TR/html4/frameset.dtd">
<html>
  <head>
    <title>Page title</title>
  </head>
  <frameset rows="*">
    <frame src="http://..." />
  </frameset>
</html> 
```

# android - Android - 如何从 EditText 引用字符串？

> ID：14553983
> 
> 赞同：0
> 
> 时间：2013-01-28T00:38:54.357
> 
> 标签：android, android-edittext, textview

基本上我有一个显示用户默认状态的文本视图

```
 <TextView
            android:id="@+id/clickable_text_view"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:clickable="true"
            android:onClick="editStatus"
            android:paddingLeft="3dp"
            android:paddingRight="3dp"
            android:text="Online"/> 
```

当我点击它时，键盘会打开并转换为 EditText。发生这种情况时，会出现一个新按钮，上面写着“保存状态”。我想要做的是当我点击“保存状态”按钮时，它将创建一个新的文本视图，其中将显示使用输入的文本。这是我的代码，但我在 and 下有红色波浪`new TextView(this)`线`linearLayout`。

```
 private OnClickListener keyboard = new OnClickListener() {
    public void onClick(View v) {
        // Hide Keyboard
        InputMethodManager inputManager = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);
        inputManager.hideSoftInputFromWindow(getCurrentFocus()
                .getWindowToken(), InputMethodManager.HIDE_NOT_ALWAYS);
        // Hide EditText
        EditText status = (EditText) findViewById(R.id.hidden_edit_view);
        status.setVisibility(View.GONE);
        // Get inputtes text
        String text = status.getText().toString();
        // Display text in TextView
        LinearLayout layout = (LinearLayout) findViewById(R.id.contactlist);
        TextView valueTV = new TextView(this);
        valueTV.setText(text);
        ((LinearLayout) linearLayout).addView(valueTV); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T00:41:04.867

您将希望通过执行以下操作来引用外部类：

```
TextView valueTV = new TextView(YourActivity.this); 
```

因为当您仅`this`在内部类内部使用时，您正在引用内部类实例，它不是 a `Context`，而是一个`OnClickListener`.

# javascript - 如何在 UIAutomation 的 TableView 中获取下一个单元格

> ID：14553990
> 
> 赞同：0
> 
> 时间：2013-01-28T00:40:13.313
> 
> 标签：javascript, ios, ios-ui-automation

在 UIAutomation 中有类似于 DOM 中的兄弟姐妹的东西 - [https://developer.mozilla.org/en-US/docs/DOM/Node.nextSibling](https://developer.mozilla.org/en-US/docs/DOM/Node.nextSibling)或 jQuery 中的下一个 - [http://docs.jquery.com/Traversing/next](http://docs.jquery.com/Traversing/next)

在我得到一个单元格后，我想要它之前或之后的单元格。例如在下面

![在此处输入图像描述](../Images/fe0f399747ab491308e7816b3c0780df.png)

假设我已经引用了名为 12:00 pm 的 Cell。如何在其上方和下方获取单元格？

我想我可以采用这种方法 - [https://stackoverflow.com/a/574914/31252](https://stackoverflow.com/a/574914/31252)工作，但我想知道是否有什么我可以做得更好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T02:34:19.233

不，唉，这不像文档对象模型。元素对它们的兄弟姐妹或如何遍历树一无所知。您必须构建自己的数据结构来跟踪这些信息。

# c - 尽管满足条件，但循环重复

> ID：14553993
> 
> 赞同：-2
> 
> 时间：2013-01-28T00:40:36.817
> 
> 标签：c, while-loop, conditional-statements

我希望我的`while`循环在用户输入 1 或 2 时停止。如果输入了其他任何内容，那么它应该重复。我尝试在变量名前加上一个感叹号并使用等号。我尝试使用单个或运算符。

`petId`变量得到了正确的数字——我看到了“`NSLog()`狗”和“猫”的 s。尽管输入了 1 或 2，为什么循环仍然循环？

```
int petId;
while(petId != 1 || petId!=2)
        {
            NSLog(@"%d",petId);
            NSLog(@"Would you like to create a dog or a cat?\n1.Dog 2.Cat");
            //Scan user input
            scanf("%i",&petId);
            if(petId == 1)
            {
                NSLog(@"Dog");
            }
            else if(petId==2)
            {
                NSLog(@"Cat");
            }
            else
            {
                NSLog(@"Invalid Entry");
            }
        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T00:46:35.467

好吧，你会踢自己的。

意思是`||`或。如果 EITHER 表达式为真：`(petId != 1)`OR `(petId != 2)`，则循环将继续。

*   如果`petID == 1`那`petID != 2`是真的。
*   如果`petID == 2`那`petID != 1`是真的。
*   如果`petID == 3`那么两者都是真的。

你正在寻找`&&`.

```
while (exp1 && exp2) { ... 
```

然后只要`petId`不是 1 而不是 2，循环就会继续。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T01:12:52.423

如果你的输入是 2，那么它就不是 1。

如果您的输入是 1，那么它不是 2。

因此，您的 (petId != 1 || petId!=2) 条件始终为真。

将其替换为 (petId != 1 && petId!=2) 就完成了！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-28T00:44:34.563

您可能在布尔运算符中犯了一个错误：替换

```
while(petId != 1 || petId!=2) 
```

和

```
while(petId != 1 && petId!=2) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-28T00:45:12.003

`petId != 1 || petId!=2`如果`petId`不等于 1*或*不等于 2，则该表达式为真- 因为它不能同时为 1 和 2，所以该表达式始终为真...

尝试`petId != 1 && petId != 2`

# html - 向右对齐/浮动我的导航栏

> ID：14553995
> 
> 赞同：8
> 
> 时间：2013-01-28T00:40:43.853
> 
> 标签：html, css, layout

我目前正在尝试将导航栏向右对齐，但它顽固地粘在左侧，我不知道该怎么做。我觉得我已经尝试了所有方法 - text-align、float 等。我还包含了 HTML5 CSS 重置，如果这有所作为的话。

有人可以查看我的代码并让我知道这些导航项目是否有某些原因不会移动到另一边？我真的很沮丧。谢谢。

HTML：

```
<ul>
  <li><a href="index.html">Home</a></li>
  <li><a href="company.html">Company</a></li>
  <li><a href="team.html">Management Team</a></li>
  <li><a href="contact.html">Contact</a></li>
</ul> 
```

CSS：

```
 body {font: normal 300 .8em 'Open Sans', sans-serif; overflow-x: hidden;}
  ul {text-align: right; width: 100%; background-color: #999; height: 20px; padding-  left: 150px;}
  li {float: left;}
  ul a {color: white; padding: 0 10px; text-decoration: none;}
  ul a:hover {color: #333;} 
```

注意：这是我刚刚修复它的 hacky 方式

```
ul {text-align: right; width: 100%; background-color: #999; height: 20px; **padding-left: 750px;**} 
```

但是，我不确定这是一个非常好的方法......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-28T00:59:36.970

一种，公认的非常愚蠢的解决方案（但它有效），是将列表项向右浮动，然后在 HTML 中反转它们的顺序。像这样：

```
<ul>
  <li><a href="contact.html">Contact</a></li>
  <li><a href="team.html">Management Team</a></li>
  <li><a href="company.html">Company</a></li>
  <li><a href="index.html">Home</a></li>
</ul>

body {font: normal 300 .8em 'Open Sans', sans-serif; overflow-x: hidden;}
ul {text-align: right; width: 100%; background-color: #999; height: 20px;}
li {float: right;}
ul a {color: white; padding: 0 10px; text-decoration: none;}
ul a:hover {color: #333;} 
```

[这是它的 JSFiddle](http://jsfiddle.net/w9ncR/3/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-28T03:00:51.563

这很简单

[http://jsfiddle.net/qZ7Tr/10/](http://jsfiddle.net/qZ7Tr/10/)

更改`li float`为`display:inline;`

```
body {
    font: normal 300 .8em'Open Sans', sans-serif;
    overflow-x:hidden;
}
ul {
    text-align: right;
    width: 100%;
    background-color: #999;
    height: 20px;
}
li {
    display:inline;
}
ul a {
    color: white;
    padding: 0 10px;
    text-decoration: none;
}
ul a:hover {
    color: #333;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-28T01:05:58.403

在 CSS 中更改这一行：

```
ul {text-align: right; width: 100%; background-color: #999; height: 20px; padding-left: 150px;} 
```

对此：

```
ul {float: right; background-color: #999; height: 20px; padding-left: 150px;} 
```

问题是您的原始代码将宽度设置为 100%。所以它在屏幕上伸展。`text-align`不会将内部`<li>`元素浮动到右侧。所以实现它的唯一方法是摆脱`width: 100%;`并设置一个`float: right;`

如果您想在页面上显示一个灰色框，则将 包装`<ul>`在`<div>`具有`background-color: #999;`和 的a 中`width:100%`。唯一的办法。

这是我为演示而创建的 HTML 文件：

```
<!DOCTYPE html>

<html lang="en">
<head>
  <title></title>
  <style type="text/css">
body {font: normal 300 .8em 'Open Sans', sans-serif; overflow-x: hidden;}
  ul {float: right; background-color: #999; height: 20px; padding-left: 150px;}
  li {float: left;}
  ul a {color: white; padding: 0 10px; text-decoration: none;}
  ul a:hover {color: #333;}
  </style>
</head>

<body>
  <ul>
    <li><a href="index.html">Home</a></li>

    <li><a href="company.html">Company</a></li>

    <li><a href="team.html">Management Team</a></li>

    <li><a href="contact.html">Contact</a></li>
  </ul>
</body>
</html> 
```

**编辑：**附加测试 HTML 文件以显示`<div>`包装器概念。这个对我有用。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">

<html lang="en">
<head>

  <title></title>
  <style type="text/css">
    body
    {
        font: normal 300 .8em 'Open Sans', sans-serif;
        overflow-x: hidden;
    }

    div
    {
        float: left;
        width: 100%;
        background-color: #999;
    }

    ul
    {
        float: right;
        background-color: #999;
        height: 20px;
        padding- left: 150px;
    }

    li { float: left; }

    ul a
    {
        color: white;
        padding: 0 10px;
        text-decoration: none;
    }

    ul a:hover { color: #333; }
</style>
</head>

<body>
  <div>
    <ul>
      <li><a href="index.html">Home</a></li>

      <li><a href="company.html">Company</a></li>

      <li><a href="team.html">Management Team</a></li>

      <li><a href="contact.html">Contact</a></li>
    </ul>
  </div>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-28T02:39:46.737

我建议下面的代码可以轻松应用样式：

**HTML：**

```
<div class="nav">
    <ul>
      <li><a href="index.html">Home</a></li>
      <li><a href="company.html">Company</a></li>
      <li><a href="team.html">Management Team</a></li>
      <li><a href="contact.html">Contact</a></li>
    </ul>
</div> 
```

**CSS：**

```
body {
    font: normal 300 .8em 'Open Sans', sans-serif; 
    overflow-x:hidden;
}
.nav {
    overflow: hidden;
    background-color: #999;    
    height: 20px; 
}
 ul {
    overflow: hidden;
    float: right;
}
ul li {
      float: left;
}
ul li a {color: white; 
    padding: 0 10px; 
    text-decoration: none;
}
 ul li a:hover {
      color: #333;
} 
```

查看代码截断[http://jsfiddle.net/sophy/eRLtw/](http://jsfiddle.net/sophy/eRLtw/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-09T20:58:36.713

```
ul {float:right;} 
```

不要给 ul 一个宽度，你会得到你正在寻找的东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-09-19T13:22:02.063

不知道你有没有整理过这个，但可以试试这个......

```
ul {
    display:block;
    width:100%;
    margin:0;
    padding:0;
    text-align:right;
}
ul li {
    display:inline-block;
} 
```

然后用填充等设置你需要的样式。

可能会在不担心浮动的情况下做到这一点。

担

# java - 从多个 Java 线程调用不可重入的本机共享库

> ID：14553996
> 
> 赞同：5
> 
> 时间：2013-01-28T00:41:02.937
> 
> 标签：java, fortran, shared-libraries, jna, reentrancy

我有一些 Java 代码正在调用一些本机代码，这些代码最初是用 Fortran 编写的，使用 JNA。（它是一个数值库，许多数学家在 Fortran 中进行编码。）它被编译成一个`.so`库，见下文：

*   Fortran：[https ://github.com/mizzao/libmao/tree/master/src/main/fortran](https://github.com/mizzao/libmao/tree/master/src/main/fortran)
*   Java绑定：[https ://github.com/mizzao/libmao/blob/master/src/main/java/net/andrewmao/probability/MvnPackDirect.java](https://github.com/mizzao/libmao/blob/master/src/main/java/net/andrewmao/probability/MvnPackDirect.java)

在我的代码中对所有单元进行了测试，我得到了很好的结果，但后来我尝试使用来自多个线程的代码，一切都开始失败并出现奇怪的错误。然后我研究了一些[关于可重入 Fortran 代码](http://software.intel.com/en-us/forums/topic/270572)的东西，并意识到我使用的库相当于一些全局变量（`SAVE`Fortran 中的关键字，它在再次调用函数时记住变量的值：[fortran SAVE 语句](https://stackoverflow.com/questions/2893097/fortran-save-statement)）

现在，我正在将对库的调用打包成`synchronized`块，但这会显着降低性能。在我看来，将库重新设计为可重入需要付出巨大的努力（它有几千行数字代码，并且不清楚在运行子例程时这些值如何传递。）有谁知道解决问题的最佳方法是什么？我的想象表明...

*   有没有办法让每个 Java 线程在内存中加载共享库的单独副本，以便全局变量有效地是线程本地的？这甚至可能吗？我不确定 JNA 的直接绑定或库绑定是如何工作的，以及是否有办法以这种方式使用它。
*   即使从不同的虚拟机调用它还会被搞砸吗？我如何检查以确保？
*   有没有办法让`gfortran`( `gcc`) 以可重入的方式编译 Fortran 代码？
*   是否有一些快速而肮脏的方法可以使 Fortran 代码可重入？我搜索了`RECURSIVE`关键字，它显然将变量保留在堆栈中，但这似乎与现有代码不兼容。
*   还有其他可能的解决方案吗？

**我确认多个虚拟机一切正常；这是有道理的，因为它们不共享内存。仍然是 PITA，而且比线程更不方便。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-26T22:38:52.790

作为参考，我只想分享我为此实现的以下类。它采用给定的库和接口，制作`n`副本并将 JNA 代理接口映射到每个副本，然后返回另一个实现线程安全锁定的代理接口，创建一个可重入的版本，并且可以运行最多处理器数量有。

```
public class LibraryReplicator<C> {

    final BlockingQueue<C> libQueue;
    final Class<C> interfaceClass;
    final C proxiedInterface;

    @SuppressWarnings("unchecked")
    public LibraryReplicator(URL libraryResource, Class<C> interfaceClass, int copies) throws IOException {
        if (!interfaceClass.isInterface()) 
            throw new RuntimeException(interfaceClass + "is not a valid interface to map to the library.");

        libQueue = new LinkedBlockingQueue<C>(copies);
        this.interfaceClass = interfaceClass;

        // Create copies of the file and map them to interfaces
        String orig = libraryResource.getFile();
        File origFile = new File(orig);
        for( int i = 0; i < copies; i++ ) {
            File copy = new File(orig + "." + i);
            Files.copy(origFile, copy);                     

            C libCopy = (C) Native.loadLibrary(copy.getPath(), interfaceClass);         
            libQueue.offer(libCopy); // This should never fail
        }               

        proxiedInterface = (C) Proxy.newProxyInstance(
                interfaceClass.getClassLoader(), 
                new Class[] { interfaceClass }, 
                new BlockingInvocationHandler());
    }

    public LibraryReplicator(URL libraryResource, Class<C> interfaceClass) throws IOException {
        this(libraryResource, interfaceClass, Runtime.getRuntime().availableProcessors());
    }

    public C getProxiedInterface() {
        return proxiedInterface;
    }

    /*
     * Invocation handler that uses the queue to grab locks and maintain thread safety.  
     */
    private class BlockingInvocationHandler implements InvocationHandler {
        @Override
        public Object invoke(Object proxy, Method method, Object[] args) throws Exception {
            C instance = null;

            // Grab a copy of the library out of the queue          
            do {
                try { instance = libQueue.take(); }
                catch(InterruptedException e) {}
            } while(instance == null);

            // Invoke the method
            Object result = method.invoke(instance, args);

            // Return the library to the queue
            while(true) {
                try { libQueue.put(instance); break; }
                catch( InterruptedException e ) {} 
            } 

            return result;
        }       
    }

} 
```

作为静态初始化程序的一部分，示例用法如下所示：

```
MvnPackGenz lib = new LibraryReplicator<MvnPackGenz>(
        MvnPackGenz.class.getClassLoader().getResource("mvnpack.so"), 
        MvnPackGenz.class).getProxiedInterface(); 
```

这会创建一堆库的副本（在我的例子中是 12 个）创建`lib`上面的变量“看起来”是可重入的，并且可以由多个线程安全地运行：

```
-rw-r--r-- 1 mao mao 50525 Sep 26 13:55 mvnpack.so
-rw-r--r-- 1 mao mao 50525 Sep 26 18:21 mvnpack.so.0
-rw-r--r-- 1 mao mao 50525 Sep 26 18:21 mvnpack.so.1
-rw-r--r-- 1 mao mao 50525 Sep 26 18:21 mvnpack.so.10
-rw-r--r-- 1 mao mao 50525 Sep 26 18:21 mvnpack.so.11
-rw-r--r-- 1 mao mao 50525 Sep 26 18:21 mvnpack.so.2
-rw-r--r-- 1 mao mao 50525 Sep 26 18:21 mvnpack.so.3
-rw-r--r-- 1 mao mao 50525 Sep 26 18:21 mvnpack.so.4
-rw-r--r-- 1 mao mao 50525 Sep 26 18:21 mvnpack.so.5
-rw-r--r-- 1 mao mao 50525 Sep 26 18:21 mvnpack.so.6
-rw-r--r-- 1 mao mao 50525 Sep 26 18:21 mvnpack.so.7
-rw-r--r-- 1 mao mao 50525 Sep 26 18:21 mvnpack.so.8
-rw-r--r-- 1 mao mao 50525 Sep 26 18:21 mvnpack.so.9 
```

您可以在以下位置查看更新版本

> [https://github.com/mizzao/libmao/blob/master/src/main/java/net/andrewmao/misc/LibraryReplicator.java](https://github.com/mizzao/libmao/blob/master/src/main/java/net/andrewmao/misc/LibraryReplicator.java)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T03:46:54.467

我不确定每个线程都有一个单独的库实例，但这是我多年前所做的：让操作系统为您重新进入。

我最终在 Unix 机器上创建了一个应用程序实例池，并使用网络套接字与它们通信——每个进程都在监听自己的套接字。

即使库不是可重入的，也可以将其作为单独的进程启动。. . 也许您可以围绕库编写一个精简的 unix 包装器，并通过您自己的专有协议进行通信。

# entity-framework - 为什么我必须手动提供外键属性值（在这种情况下）？

> ID：14553999
> 
> 赞同：3
> 
> 时间：2013-01-28T00:41:32.180
> 
> 标签：entity-framework, .net-4.0, ef-code-first, entity-framework-5

当我有这样的模型时...

```
public class Order
{
    [Key, Column(Order = 1)]
    public int CustomerId { get; set; }
    [Key, Column(Order = 2)]
    public int OrderId { get; set; }

    public ICollection<OrderItem> Items { get; set; }
}

public class OrderItem
{
    [Key, Column(Order = 1)]
    public int CustomerId { get; set; }
    [Key, Column(Order = 2)]
    public int OrderId { get; set; }
    [Key, Column(Order = 3)]
    public int OrderItemId { get; set; }
} 
```

...当我将图形添加到数据库时`OrderItem.CustomerId`，我不需要手动提供外键值：`OrderItem.OrderId``Order - OrderItems`

```
var order = new Order
{
    CustomerId = 5,
    OrderId = 1,
    Items = new List<OrderItem>
    {
        // I don't need to set CustomerId and OrderId here
        new OrderItem { OrderItemId = 12 }
    }
};
context.Orders.Add(order);
context.SaveChanges(); 
```

`SaveChanges`将生成 SQL 语句来插入`Order`和`OrderItem`. 因为`OrderItem`它是：

```
exec sp_executesql N'insert
[dbo].[OrderItems]([CustomerId], [OrderId], [OrderItemId])
values (@0, @1, @2)
',N'@0 int,@1 int,@2 int',@0=5,@1=1,@2=12 
```

因此，FK`CustomerId`和`OrderId`正确设置（`@0=5`和`@1=1`）。

`Customer`但是，如果我通过将导航属性添加到模型来向模型添加与实体的另一个关系`Order`...

```
public Customer Customer { get; set; } 
```

......`Customer`像这样的课程......

```
public class Customer
{
    [DatabaseGenerated(DatabaseGeneratedOption.None)]
    public int CustomerId { get; set; }
} 
```

...并调用与上面相同的代码（假设数据库中存在`Customer`with `CustomerId`= `5`）我得到以下 SQL：

```
exec sp_executesql N'insert
[dbo].[OrderItems]([CustomerId], [OrderId], [OrderItemId])
values (@0, @1, @2)
',N'@0 int,@1 int,@2 int',@0=0,@1=1,@2=12 
```

几乎相同，但`CustomerId`在`0`这种情况下 ( `@0=0`) 会导致关系违反外键约束`Order - OrderItem`。如果存在`Customer`with `CustomerId`=`0`并且该客户有`Order`with `OrderId`= `1`，则不会发生异常，并且`OrderItem`将被添加到可能比异常更糟糕的错误订单中。

可以通过在 new 中设置`CustomerId`（它是 FK 的一部分）来解决该问题`OrderItem`：

```
Items = new List<OrderItem>
{
    // I don't need to set OrderId here, BUT CustomerId
    new OrderItem { CustomerId = 5, OrderItemId = 12 }
} 
```

或者 - 可以通过将带有 Id 的客户附加`5`到上下文来修复它（我不知道它为什么会起作用）。

**是否有合理的解释为什么我必须手动提供 FK（或本示例中的 FK 的一部分）或者这是一个错误？**

（我在这个模型中使用了 EF 5.0 和 .NET 4.0。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T01:58:49.523

你的模型对我来说看起来很奇怪，我怀疑会导致你的困惑。

根据我所看到的，我猜你的客户可以有很多订单，每个订单应该只有一种类型的 OrderItem，但可以有很多 OrderItem。一份订单不能属于多个客户。一个 OrderItem 可以属于多个 Order。

如果这是真的，那么我认为你需要一个像这样的模型；

```
public class Customer
    {
        //Is the key by naming convention or you could use [Key]
        public Guid CustomerId { get; set; }
        public ICollection<Order> Orders { get; set; } 
    }
    public class Order
    {
        //Is the key by naming convention or you could use [Key]     
        public Guid OrderId { get; set; }
        public Guid CustomerId { get; set; } //This doesn't need to be part of the key 
        public Customer Customer { get; set; }
        public ICollection<OrderItem> OrderItems { get; set; } 
    }
    public class OrderItem
    {
        [Key, Column(Order = 0)]
        public Guid OrderItemId { get; set; }
        [Key, Column(Order=1)]
        public Guid OrderId { get; set; }
        public ICollection<Order> Orders { get; set; }
    } 
```

然后，当您需要查询是否需要按客户了解 OrderItems 时，您可以使用 Include 或使用数据投影来执行此操作，例如

```
OrderItems.Select(x=>new { 
CustomerId = x.Order.Customer.Id,
//this rest of your properties
}); 
```

或者如果你想要整个实体

```
 OrderItems.Include(x=>x.Order.Customer) 
```