# StackOverflow 问答 15209000-15209999

# php - PHP 简单 HTML DOM 解析器 - 打印类名

> ID：15209002
> 
> 赞同：0
> 
> 时间：2013-03-04T18:58:58.950
> 
> 标签：php, class, parsing, dom

从一个网页解析一些数据我没有什么问题。我正在尝试获取某些的类名`div`。

例子：

```
< div class="stars b3"></div> 
```

我只想保存在数组中`b3`。是否有可能做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:01:45.580

看到这个：

```
<?php // http://stackoverflow.com/questions/4835300/php-dom-to-get-tag-class-with-multiple-css-class-name

$html = <<< HTML
<td class="pos" >
    <a class="firstLink" href="Search/?List=200003000112097&sr=1" >
        Firs link value
    </a>

    <br />

    <a class="secondLink SecondClass" href="/Search/?KeyOpt=ALL" >
        Second Link Value
    </a>
</td
HTML;

$dom = new DOMDocument();
@$dom->loadHTML($html);
$dom->preserveWhiteSpace = false;
$xpath = new DOMXPath($dom);
$hrefs = $xpath->evaluate(
    "/html/body//a[@class='secondLink SecondClass']"
);
echo $hrefs->item(0)->getAttribute('class'); 
```

参考。 [http://codepad.org/VZVUXgrT](http://codepad.org/VZVUXgrT)

# php - JS 和 PHP 的加载时间不一致

> ID：15209003
> 
> 赞同：6
> 
> 时间：2013-03-04T18:59:06.717
> 
> 标签：php, javascript, google-chrome-devtools

我有一个由 JS 通过 JQuery 加载的 PHP 脚本`$.ajax`。我使用以下方法测量了 PHP 脚本的执行时间：

```
$start = microtime(); // top most part of code
// all other processes that includes AES decryption
$end = microtime(); // bottom part of code
file_put_contents('LOG.TXT','TIME IT TOOK: '.($end-$start)."\n",FILE_APPEND); 
```

**它测量的时间不到 1 秒。**没有前置/附加 PHP 脚本。

在 JS`$.ajax`代码中，我通过以下方式测量了执行时间：

```
success: function(response) {
    console.log(date('g:i:s a') + ' time received\n');
    // all other processes including AES decryption
    console.log(date('g:i:s a') + ' time processed\n');
} 
```

**接收时间和处理时间相同。**

但是，当我检查 Chrome 开发人员工具时，**它声称 PHP 脚本加载了大约 8 秒**。

我测量这些东西的方式可能有什么问题？我确定 PHP 加载速度很快，但 Chrome 怎么会报告它花了超过 8 秒？

我正在使用本地主机，我的网络服务器很快，这是我唯一一次遇到这个问题。所有其他 AJAX 调用都很快。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:16:38.440

在 PHP 部分，确保您使用`microtime(true)`的是**浮点数**而不是**字符串**。对字符串使用减法可能会产生不正确的结果。

* * *

示例：http: [//ideone.com/FWkjF2](http://ideone.com/FWkjF2)

```
<?php

// Wrong
$start = microtime();
sleep(3);
$stop  = microtime();
echo ($stop - $start) . PHP_EOL;  // Prints 8.000000000008E-5

// Correct
$start = microtime(true);
sleep(3);
$stop  = microtime(true);
echo ($stop - $start) . PHP_EOL;  // Prints 3.0000791549683

?> 
```

# excel - Excel VBA 单词匹配计数修复

> ID：15209004
> 
> 赞同：0
> 
> 时间：2013-03-04T18:59:10.057
> 
> 标签：excel, vba

我在下面有这段代码非常接近我想要做的。它的工作原理是您按下 Excel 电子表格中的“列出单词问题”按钮，它会逐个单元格地扫描 A 列中的所有文本，并针对包含单词列表的单独工作表进行扫描。如果存在匹配项（在第 1 列中每个单独单元格中的内容之间），则它将匹配的单词放入 b 列中的相邻行中。

这里（[http://mintywhite.com/more/software-more/microsoft-excel-analyze-free-text-surveys-feedback-complaints-part-2](http://mintywhite.com/more/software-more/microsoft-excel-analyze-free-text-surveys-feedback-complaints-part-2)）是我找到代码的文章的链接和链接 ( [http://mintywhite.com/wp-content/uploads/2011/02/wordcount2.xls](http://mintywhite.com/wp-content/uploads/2011/02/wordcount2.xls) ) 下载整个 .xls 电子表格。

我正在寻找的是一个简单的更改，因此除非该单词在第一个工作表的 A 列的每个单元格/行中出现至少 5 次，否则不会有“匹配”。

```
 Sub WordCount()

    Dim vArray, WordIssue, ElementCounter As Variant
    Dim lngLoop, lngLastRow As Long
    Dim rngCell, rngStoplist As Range

    ElementCounter = 2 'setting a default value for the counter
    Worksheets(1).Activate
    For Each rngCell In Worksheets("Word").Range("A3", Cells(Rows.Count, "A").End(xlUp))
        vArray = Split(rngCell.Value, " ") 'spliting the value when there is a space
        vrWordIssue = ""
        ElementCounter = ElementCounter + 1 'increases the counter every loop
        For lngLoop = LBound(vArray) To UBound(vArray)

            If Application.WorksheetFunction.CountIf(Sheets("Issue").Range("A2:A" & Sheets("Issue").UsedRange.Rows.Count), vArray(lngLoop)) > 0 Then 'this is to test if the word exist in the Issue Sheet.
                If vrWordIssue = "" Then
                    vrWordIssue = vArray(lngLoop) 'assigning the word
                Else
                    If InStr(1, vrWordIssue, vArray(lngLoop)) = 0 Then 'a binary of comparison
                        vrWordIssue = vrWordIssue & ", " & vArray(lngLoop) 'this will concatinate words issue that exist in Issue Sheet
                    End If
                End If
            End If

        Next lngLoop

        Worksheets("Word").Range("B" & ElementCounter).Value = vrWordIssue 'entering the final word issue list into cell.
    Next rngCell

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T20:24:21.467

如果您有兴趣，请快速评论一些代码：

```
Dim lngLoop, lngLastRow As Long 
```

lngLoop 实际上是 Variant，不是很长。不幸的是，您不能像在 C++ 中那样声明数据类型。

你需要这样做：

```
Dim lngLoop As Long, lngLastRow As Long 
```

此外，`WordIssue`从未使用过。它应该是`vrWordIssue`。

事实上，我几乎*不会*将 Variant 用于 VBA 中的任何内容。我不相信该网站的这个作者知道大量的 VBA。（至少，不是他们写的时候）

也就是说，我要修复的第一件事是变量：

从：

```
Dim vArray, WordIssue, ElementCounter As Variant
Dim lngLoop, lngLastRow As Long
Dim rngCell, rngStoplist As Range 
```

至：

```
Dim vArray As Variant
Dim vrWordIssue As String
Dim ElementCounter As Long
Dim lngLoop As Long, lngLastRow As Long
Dim rngCell As Range, rngStoplist As Range 
```

并添加`Option Explicit`到模块的顶部。这将有助于调试。

...而且您几乎不必为任何事情使用激活...

....你知道吗？我会完全使用不同的方法。老实说，我不喜欢这段代码。

我知道不鼓励提供完整的解决方案，但我不喜欢像这样传播不太好的代码（来自 Douglas 链接的网站，不一定是 Douglas 写的）。

这就是我要做的。顺便说一下，这会检查区分大小写的问题词。

```
Option Explicit

Public Type Issues
    Issue As String
    Count As Long
End Type

Const countTolerance As Long = 5

Public Sub WordIssues()
' Main Sub Procedure - calls other subs/functions
    Dim sh As Excel.Worksheet
    Dim iLastRow As Long, i As Long
    Dim theIssues() As Issues

    Set sh = ThisWorkbook.Worksheets("Word")
    theIssues = getIssuesList()
    iLastRow = sh.Cells(sh.Rows.Count, 1).End(xlUp).Row

    ' loop through worksheet Word
    For i = 3 To iLastRow
        Call evaluateIssues(sh.Cells(i, 1), theIssues)
        Call clearIssuesCount(theIssues)
    Next i
End Sub

Private Function getIssuesList() As Issues()
    ' returns a list of the issues as an array
    Dim sh As Excel.Worksheet
    Dim i As Long, iLastRow As Long
    Dim theIssues() As Issues
    Set sh = ThisWorkbook.Sheets("Issue")

    iLastRow = sh.Cells(sh.Rows.Count, 1).End(xlUp).Row
    ReDim theIssues(iLastRow - 2)

    For i = 2 To iLastRow
        theIssues(i - 2).Issue = sh.Cells(i, 1).Value
    Next i

    getIssuesList = theIssues
End Function

Private Sub clearIssuesCount(ByRef theIssues() As Issues)
    Dim i As Long

    For i = 0 To UBound(theIssues)
        theIssues(i).Count = 0
    Next i
End Sub

Private Sub evaluateIssues(ByRef r As Excel.Range, ByRef theIssues() As Issues)
    Dim vArray As Variant
    Dim i As Long, k As Long
    Dim sIssues As String
    vArray = Split(r.Value, " ")

    ' loop through words in cell, checking for issue words
    For i = 0 To UBound(vArray)
        For k = 0 To UBound(theIssues)
            If (InStr(1, vArray(i), theIssues(k).Issue, vbBinaryCompare) > 0) Then
                'increase the count of issue word
                theIssues(k).Count = theIssues(k).Count + 1
            End If
        Next k
    Next i

    ' loop through issue words and see if it meets tolerance
    ' if it does, add to the Word Issue cell to the right
    For k = 0 To UBound(theIssues)
        If (theIssues(k).Count >= countTolerance) Then
            If (sIssues = vbNullString) Then
                sIssues = theIssues(k).Issue
            Else
                sIssues = sIssues & ", " & theIssues(k).Issue
            End If
        End If
    Next k

    r.Offset(0, 1).Value = sIssues
End Sub 
```

# c++ - is_permutation 和结构谓词的编译器错误

> ID：15209006
> 
> 赞同：1
> 
> 时间：2013-03-04T18:59:28.237
> 
> 标签：c++, algorithm, struct, compiler-errors, predicate

我不明白我在最后一行遇到的编译器错误：

```
#include <iostream>
#include <algorithm>

struct X{
  int number;
};
bool same_number_X(const int & a, const X & b)
{ return a == b.number; }

bool same_number_int(const int & a, const int & b)
{ return a == b; }

int main(){

   std::vector<int> vec1{1,2,3};
   std::vector<int> vec2{2,3,1};
   std::vector<X> vec3{{2},{3},{1}};

   std::cout << std::is_permutation(vec1.begin(), vec1.end(), vec2.begin(), same_number_int);
   std::cout << std::is_permutation(vec1.begin(), vec1.end(), vec3.begin(), same_number_X);
} 
```

[你可以在这里](http://liveworkspace.org/code/1ncIoI%240)看到错误 它说

```
In instantiation of 'typename std::iterator_traits<_InputIterator>::difference_type std::count_if(_IIter, _IIter, _Predicate) [with _IIter = __gnu_cxx::__normal_iterator<X*, std::vector<X> >; _Predicate = std::_Bind<bool (*(std::_Placeholder<1>, int))(const int&, const X&)>; typename std::iterator_traits<_InputIterator>::difference_type = long int]':
c++/4.7/bits/stl_algo.h:4367:37: required from 'bool std::is_permutation(_FIter1, _FIter1, _FIter2, _BinaryPredicate) [with _FIter1 = __gnu_cxx::__normal_iterator<int*, std::vector<int> >; _FIter2 = __gnu_cxx::__normal_iterator<X*, std::vector<X> >; _BinaryPredicate = bool (*)(const int&, const X&)]'
source.cpp:23:90: required from here
c++/4.7/bits/stl_algo.h:4681:2: error: no match for call to '(std::_Bind<bool (*(std::_Placeholder<1>, int))(const int&, const X&)>) (X&)' 
```

任何人都可以用非编译器的话解释/解决它吗？:-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T19:03:33.177

来自 C++11 标准的第 25.2.12/1 段：

```
template<class ForwardIterator1, class ForwardIterator2>
bool is_permutation(ForwardIterator1 first1, ForwardIterator1 last1,
                    ForwardIterator2 first2);

template<class ForwardIterator1, class ForwardIterator2, class BinaryPredicate>
bool is_permutation(ForwardIterator1 first1, ForwardIterator1 last1,
                    ForwardIterator2 first2, BinaryPredicate pred); 
```

> 1*要求*：`ForwardIterator1`并且`ForwardIterator2` **应具有相同的值类型**。比较函数应为等价关系。

在您最后一次调用 中`is_permutation()`，第一个参数（从哪个类型`ForwardIterator1`推导出来）是`int`值的迭代器，而第三个参数（从哪个类型`ForwardIterator2`推导出来）是`X`值的迭代器。因此，您违反了上述段落所述的先决条件。

# javascript - 在 Three.js 中使用与默认字体不同的字体

> ID：15209008
> 
> 赞同：4
> 
> 时间：2013-03-04T18:59:45.267
> 
> 标签：javascript, fonts, three.js, typeface.js

所以我在一个项目中使用了three.js，并且希望能够使用默认的“helvetiker”以外的字体。我做了一些挖掘，发现您需要使用 typeface.js 转换字体以获取字体文件，并且已经这样做了，我只是不知道如何将这种字体“插入”到threejs中。我已经挖掘了 mrdoob three.js 示例并且找不到任何东西，我还在three.js 源文件中挖掘并在 THREE.FontUtils 中找到了一个 loadFace 函数，但我不确定如何使用它. 这是我第一个使用 Three.js 的项目，所以任何帮助都将不胜感激。谢谢！

格雷格

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-27T17:32:58.730

我看到这个问题没有得到确切的回答。threejs 所需的确切字体名称应在字体 (js) 文件的末尾找到。这是：

“familyName”：“字体名称”

threejs 需要引号内的名称，但要小写。所以例如字体示例：Old English Text MT

您应该在 (js) 字体文件的末尾找到...,"familyName":"Old English Text MT",... 所以您填写三个js：

字体：“旧英文文本 mt”

（或任何在引号中的familyName之后但小写的内容。如果您在（js）字体文件中编辑familyName之后的文本，例如“familyName”：“cAt aNd DOg”，那么您必须使用它。所以threejs声明应该看起来那么：

var text3d = new THREE.TextGeometry(n.text, { size: 15, height: 10, curveSegments: 10, font: "cat and dog" });

最后确保将 (js) 字体文件放入网站的标题部分，例如：

`<script src="fonts/droid/droid_serif_bold.typeface.js"></script>`

最后有用的是（js）字体文件生成器的链接：http: [//typeface.neocracy.org/fonts.html](http://typeface.neocracy.org/fonts.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T19:17:22.440

我所要做的就是在脚本标签中加载字体并更改 TextGeometry 中的字体：

```
var text3d = new THREE.TextGeometry(n.text, {
  size: 10,
  height: 5,
  curveSegments: 2,
  font: "droid sans"  //change this
}); 
```

我认为不需要任何其他步骤。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T02:45:57.383

正如 Tim 所说，唯一棘手的事情是正确设置字体名称。它似乎是生成的 js 中的“姓氏”，`font_family_name`小写的 ( ) - 保留空格。如果您觉得方便，您甚至可以编辑它（在 .js 中）——我自己已经完成 [了](http://st.hjg.com.ar/mysis/mysis?lang=en)。

# asp.net-mvc - MVC 视图 造型

> ID：15209009
> 
> 赞同：0
> 
> 时间：2013-03-04T18:59:57.683
> 
> 标签：asp.net-mvc, razor

这可能是针对傻瓜的问题，但是如何在里面设置样式`<text>`？例如，将颜色放入：

```
@{
      if (TempData.Count != 0)
      {
          <text>The quantity available is  @TempData["checkQuantity"]</text>
      }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T19:02:07.543

`<text>`不是 HTML 标签；相反，它是一个特殊的符号，它告诉 Razor 里面的任何东西都不是代码。

如果要应用 CSS，则需要使用 HTML 标记。
Razor 足够聪明，可以意识到代码块中的 HTML 标记不是代码，因此您不需要做任何不同的事情：

```
@if (TempData.Count > 0) {
    <strong class="MyClass">...</strong>
} 
```

# ruby-on-rails - 插入和编辑用户评论

> ID：15209014
> 
> 赞同：0
> 
> 时间：2013-03-04T19:00:14.363
> 
> 标签：ruby-on-rails, ruby

我有一个评论系统，允许用户为电影创建评论，如果他们尝试为同一部电影添加另一个评论，它会更新他们之前的评论。更新是通过`create`审查控制器中的方法完成的。

我正在尝试在电影放映页面中使用它。目前，用户可以通过选择始终存在的电影放映页面上的“添加评论”选项来添加评论。如果他们之前通过选择“添加评论”为该特定电影写过评论，他们之前的评论仍然会更新。我想要做的是显示一个按钮，如果他们之前写过评论，则显示“编辑评论”，如果没有，则显示“添加评论”。有任何想法吗？

审查控制器 - 创建：

```
def create    
@review = Review.find_or_create_by_film_id_and_name(params[:review][:film_id],        
User.find(session[:user_id]).name)
@review.update_attributes(params[:review])
if @review.save
film = Film.find(@review.film.id)
redirect_to film, notice: 'Your review was successfully added.'
else
render action: "new"
end
end 
```

审查控制器 - 新：

```
def new
if logged_in?
@review = Review.new(:film_id => params[:id], :name =>     
User.find(session[:user_id]).name)
session[:return_to] = nil 
else
session[:return_to] = request.url 
redirect_to login_path, alert: " 'You need to login to write a review' "
end
end 
```

电影放映页面：

```
<%= button_to 'Add Review',{controller: 'reviews', action: 'new', id: @film.id },
{class: "button-to"}%> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:17:39.787

您可以执行以下操作：

在`show`控制器的作用下：

```
 def show
   @current_user_review = Review.find_by_film_id_and_name(film_id, user_name)
   #your stuff
 end

 def edit
   @review = Review.find(params[:id])
   render 'new'
 end 
```

在`view`：

```
 <% if @current_user_review.blank? %>
   <%= link_to 'Add Review',new_review_path(film_id: @film.id),
      {class: "button-to"}  %>
 <% else %>
   <%= link_to 'Edit Your Review', edit_review_path(@current_user_review), {class: "button-to"} %>
 <% end %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T20:03:18.087

```
<% if @current_user_review.blank?%>
   <%= link_to_function("Create New Review", "$('create').toggle()") %>
<%else%>
   <%= link_to_function("To edit Review, Click here", "$('Edit').toggle()") %> 
```

```
<div id="create" style="display: none;">
   <%= render :partial => "new" %> 
</div>

<div id="Edit" style="display: none;">
   <%=render :partial => edit %> # The new partial can also be be used here.
</div> 
```

# php - 从下拉菜单中捕获用户选择值的数据库 id

> ID：15209020
> 
> 赞同：0
> 
> 时间：2013-03-04T19:00:37.777
> 
> 标签：php, mysql

嗨，我目前正在为我的学位项目构建一个粗略的原型，上周我有点卡住了。基本上我有一个系统供测试人员记录防病毒软件的测试结果。我已经用父表中的记录填充了一个下拉列表，现在我想捕获用户选择的值和用户 ID，并将其输入到链接表中以记录它。但我只想捕获该测试的主键 testID 而不是测试的名称，这就是我卡住的地方。如果有人有任何想法，这将对我有很大帮助。

这是第一页的代码

```
<?php
//Template for all pages
$pagename="Select File Associations";
session_start();
include ("mysqli_test.php");
// css style sheet for template
echo "<link rel=stylesheet type=text/css href=stylesheet.css>";
// displays name in window tab
echo "<title>".$pagename."</title>";

// use header file

include("header.html");

// display the current date and time
echo date ('l d F Y H:i:s');

echo "<p></p>";
// display page name on the page
echo "<h2>".$pagename."</h2>";

$testsql = "SELECT testID, testName from tests";
$testresult = mysql_query($testsql);

echo "<td>Select Test:</td>";
echo "<select name= testName>";
while ($row = mysql_fetch_array($testresult))
{
 echo "<option value=\"". $row['testID']."\">". $row['testName']. "</option>";
}
echo "</select>";

echo "<form method=post action= confirm_selection2.php>";
echo "<tr><td><input type=submit value='Submit'></td>";
echo "<td><input type=reset value='clear'></td></tr>";

// use footer file
include("footer.html");
?> 
```

然后是表单处理页面confirm_selections.php

```
<?php
//Template for all pages
$pagename="confirm_selection";
session_start();
include ("mysqli_test.php");

// css style sheet for template
echo "<link rel=stylesheet type=text/css href=stylesheet.css>";
// displays name in window tab
echo "<title>".$pagename."</title>";

// use header file
include("header.html");

// display the current date and time
echo date ('l d F Y H:i:s');

echo "<p></p>";
// display page name on the page
echo "<h2>".$pagename."</h2>";

// retrieve POST data from the user selected test
$testselection=$_POST['testName'];

// check if the selections were made

if(isset($testselection)){

$instestSQL = "INSERT INTO test_performance SET
testID='$testselection'
testerID='$_SESSION['testID']);
$exeintestSQL=mysql_query($instestSQL) OR die(mysql_error());
}

// use footer file
include("footer.html");

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:05:16.487

选择元素在您的表单之外，将其更改为：

```
echo "<form method=post action= confirm_selection2.php>";
echo "<select name= testName>";
while ($row = mysql_fetch_array($testresult))
{
 echo "<option value=\"". $row['testID']."\">". $row['testName']. "</option>";
}
echo "</select>";
echo "<tr><td><input type=submit value='Submit'></td>";
echo "<td><input type=reset value='clear'></td></tr>";
echo "</form>"; 
```

所有表单元素都应放置在`<form></form>`元素内。

# ravendb - DocumentStore.OpenSession("InvalidDatabase") 不抛出异常

> ID：15209025
> 
> 赞同：1
> 
> 时间：2013-03-04T19:00:43.863
> 
> 标签：ravendb

在 RavenDB 中，当我调用 DocumentStore.OpenSession("invalid database name here") 时，它不会引发异常。而是打开与系统（默认）数据库的会话。这是设计使然吗？是否可以更改某些设置以使其引发异常？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T06:35:05.977

这不是设计使然，也不应该发生。你应该在读/写时得到一个错误。

# php - PHP Curl - 会话已过期

> ID：15209026
> 
> 赞同：0
> 
> 时间：2013-03-04T19:00:44.723
> 
> 标签：php, curl

我正在尝试使用 CURL 登录远程站点，但我不断收到错误消息，您的会话已过期，请重新登录。

```
$username="xxxxxx"; 
$password="yyyyyyyy"; 
$url="https://remotesite.com/my.activation.php3"; 
$cookie="cookie.txt"; 

$postdata = "username=".$username."&password=".$password; 

$ch = curl_init(); 
curl_setopt ($ch, CURLOPT_URL, $url); 
curl_setopt ($ch, CURLOPT_SSL_VERIFYPEER, FALSE); 
curl_setopt ($ch, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.6) Gecko/20070725 Firefox/2.0.0.6"); 
curl_setopt ($ch, CURLOPT_TIMEOUT, 60); 
curl_setopt ($ch, CURLOPT_FOLLOWLOCATION, 0); 
curl_setopt ($ch, CURLOPT_RETURNTRANSFER, 1); 
curl_setopt ($ch, CURLOPT_COOKIEJAR, $cookie); 
curl_setopt ($ch, CURLOPT_REFERER, $url); 

curl_setopt ($ch, CURLOPT_POSTFIELDS, $postdata); 
curl_setopt ($ch, CURLOPT_POST, 1); 

// check for errors before close
$result = curl_exec($ch);
echo $result;
curl_close($ch); 
```

cookie 文件是可写的，并且正在写入一些内容。有什么想法可以让会议继续进行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:36:22.723

确保您使用正确的[选项](http://php.net/manual/en/function.curl-setopt.php)。`CURLOPT_COOKIE*`

`CURLOPT_COOKIEJAR`- 当句柄关闭时保存所有**内部cookies**的文件的名称，例如在调用curl_close之后。

`CURLOPT_COOKIE`**- HTTP 请求中使用**的“Cookie:”标头的内容。请注意，多个 cookie 用分号后跟空格分隔（例如，“fruit=apple; colour=red”）

`CURLOPT_COOKIEFILE`-**包含 cookie 数据的文件的名称**。cookie 文件可以是 Netscape 格式，或者只是转储到文件中的普通 HTTP 样式的标头。如果名称为空字符串，则不加载任何 cookie，但仍启用 cookie 处理。

* * *

此外，`CURLOPT_VERBOSE`在调试 cURL 时启用可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-07T08:36:17.823

利用`curl_setopt ($ch, CURLOPT_COOKIESESSION, TRUE);`

# sql - 将电子邮件转换为 MD5 的更新语句未计算正确的结果

> ID：15209028
> 
> 赞同：0
> 
> 时间：2013-03-04T19:00:47.000
> 
> 标签：sql, sql-server-2008

我试图循环浏览我的数据库和 MD5 哈希我的电子邮件地址。这是我厌倦了使用的代码：

```
update Recipients set MD5Email = CONVERT(VARCHAR(MAX), HASHBYTES( 'md5', NonMd5.EmailAddress ), 2)
from 
 Recipients INNER JOIN Recipients as NonMd5
on 
 Recipients.Id = NonMd5.Id 
```

我也试过这个，结果是一样的：

```
update Recipients set MD5Email = CONVERT(VARCHAR(MAX), HASHBYTES( 'md5', Recipients.EmailAddress ), 2)
    from 
     Recipients 
```

如果我用硬编码字符串替换 NonMd5.EmailAddress，它会正确计算。我不知道出了什么问题。

这是我的表：

```
CREATE TABLE [dbo].[Recipients] (
[Id] uniqueidentifier NOT NULL DEFAULT (newid()) ,
[EmailAddress] nvarchar(MAX) COLLATE Latin1_General_CI_AS NULL ,
[IsProcessed] bit NOT NULL ,
[MD5Email] nvarchar(80) COLLATE Latin1_General_CI_AS NULL ,
CONSTRAINT [PK__Recipien__3214EC0703317E3D] PRIMARY KEY ([Id])
)
ON [PRIMARY]
TEXTIMAGE_ON [PRIMARY]
GO 
```

更新：

如果我将电子邮件地址设置为 test@test.com 这是我的结果： `4767DCA4A82B295C59D18097EE7B4070`

在上面的代码中将其作为直接值运行，这是我的结果：

```
b642b4217b34b1e8d3bd915fc65c4452 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:15:26.903

怎么样：

```
UPDATE dbo.Recipients 
  SET MD5Email = CONVERT(NVARCHAR(80), HASHBYTES('MD5', EmailAddress), 2); 
```

也就是说，您确实应该考虑 SHA 或其他 MD5 算法，并且您确实不应该将哈希输出存储为*字符串*- 使用 varbinary。

这是我得到的结果：

[SQLFiddle](http://sqlfiddle.com/#!3/bf899/1)

现在，我认为您缺少一个非常重要的区别。您当前将电子邮件地址存储为`NVARCHAR(MAX)`- 我不知道您为什么使用 Unicode（世界上大多数服务器仍然不支持双字节字符），我不知道您为什么使用`MAX`. 但是比较这些：

```
SELECT CONVERT(NVARCHAR(80), HASHBYTES('MD5', 'test@test.com'), 2);

SELECT CONVERT(NVARCHAR(80), HASHBYTES('MD5', N'test@test.com'), 2);
----------- this N is very important ---------^ 
```

鉴于当前的 SMTP 标准，您的列*可能*应该是 320 个字符（域名为 255 个字符，本地部分为 64 个字符，加上 @ 符号）而不是`MAX`（没有人的电子邮件地址超过 4000 个字符，更不用说 10 亿个字符）。`NVARCHAR`只有当您确实需要支持 Unicode 电子邮件地址时才需要- 正如我所说，当今大多数邮件服务器都无法识别这些地址。如果您更改数据类型，您将看到它与您的测试匹配。如果您继续使用`NVARCHAR`，则需要将苹果与苹果进行比较，因此在运行测试时，请确保在硬编码值前加上`N`.

# objective-c - ASIFormDataRequest：无法使用异步请求将文件发送到服务器

> ID：15209031
> 
> 赞同：0
> 
> 时间：2013-03-04T19:01:11.167
> 
> 标签：objective-c, asynchronous, synchronous, asiformdatarequest

我想将文件异步发送到服务器；但是，似乎当我确实将请求发送到服务器时。服务器给了我一个 HTTP 代码：200，这没问题，但没有文件上传到服务器。

但是，当我让它保持同步时......它工作得很好。诡异的..

任何想法将不胜感激，

```
- (void) sendCSVtoServer: ( Session * ) archive_session {

    NSLog(@"file name: %@", [archive_session getFile]);

    NSURL *url = [NSURL URLWithString:@"http://xx.x.xxx.xxx:3000/xxx/xxxxxxxx"];

    ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL:url];

    [request setPostValue: [archive_session getEmail] forKey:@"email"];
    [request addFile: [archive_session getFile] forKey:@"csv"];
    [request setDelegate:self];
    [request startSynchronous];

} 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:25:35.440

您正在设置一个委托，但您提到您没有实现任何这些方法。`ASIFormDataRequest`extends `ASIHTTPResquest`，因此继承了它的所有属性。

您必须`ASIHTTPRequestDelegate`至少实现在 中标明的方法

`- (void)requestFinished:(ASIHTTPRequest *)request;`

和

`- (void)requestFailed:(ASIHTTPRequest *)request;`

也许其他取决于您的需要。

您的上传可能仍在工作（您可以检查您的服务器吗？），但是，当您异步发送请求时，您无法确定请求是成功还是失败；现在你只是sedning和忘记。

中声明的所有方法`ASIHTTPRequestDelegate.h`都标记为可选，这就是调试器、编译器和运行时没有抱怨的原因。

# c++ - vs2012 DirectXMath 多实例重载函数

> ID：15209033
> 
> 赞同：0
> 
> 时间：2013-03-04T19:01:15.113
> 
> 标签：c++, directx, directx-11

我在 Windows 7 上的 VS2012 中使用 directx 11 (Windows SDK 8)

我收到了这个错误

```
1 IntelliSense: more than one instance of overloaded function "XMMatrixTranspose" matches the argument list:
        function "DirectX::XMMatrixTranspose(DirectX::CXMMATRIX M)"
        function "XMMatrixTranspose(DirectX::CXMMATRIX M)"
        argument types are: (const DirectX::XMMATRIX) c:\Program Files (x86)\Windows Kits\8.0\Include\um\DirectXMathMatrix.inl 
```

我只包含的代码没有什么特别的，`#include <DirectXMath.h>` 而且任何时候都使用 XMMatrix 方法之一，我得到了这个

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T12:28:35.437

这是因为 Windows 7 包含部分 Windows 8 DirectX 11.1 文件。例如，许多头文件将被包含两次，这将使 Visual Studio 发出一百万条警告。但是，这就是我系统中的全部内容。为什么在 Windows 7 上使用 Windows 8 SDK？只是出于好奇...

我建议只在 Windows 7 上使用 Windows 7 SDK，在 Windows 8 上使用 Windows 8 SDK。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-02T04:59:21.127

我在 Windows 7 64 位上使用 Windows 10 SDK 来开发具有新代码模型的 DirectX 11 应用程序。我和OP有同样的问题。

我的解决方案是在调用它们时完全指定 DirectXMath.h 库中的任何方法（例如 DirectX::XMMatrixTranspose）。

示例调用：

```
m_viewMatrix = DirectX::XMMatrixLookAtLH(position, lookAt, up); 
```

# r - 使用 ggplot2 创建折线图，使用时间段作为 x 变量

> ID：15209034
> 
> 赞同：2
> 
> 时间：2013-03-04T19:01:15.380
> 
> 标签：r, graph, ggplot2, line

我对 R 很陌生，所以这个问题非常初级，但我自己无法解决。非常感谢您的帮助。

这是我想使用的一种数据框：

```
 Period                           Value   Cut.off
1   January 1998 - August 2002      8.798129    1.64
2   September 2002 - Jun 2006       4.267268    1.64
3   Jul 2006 - Dec 2009             7.280275    1.64 
```

这是我正在使用的代码：

```
require(ggplot2)
bq <- ggplot(data=glomor, aes(x=as.character(Period),y=Value))+geom_point()+ylim(0,10)

bq <- bq + scale_x_discrete(limits=c("January 1998 - August 2002","September 2002 - Jun 2006","Jul 2006 - Dec 2009"))

bq + geom_line() 
```

我收到以下错误消息：

```
geom_path: Each group consist of only one observation. Do you need to adjust the group aesthetic? 
```

我如何需要更改代码，以便点将通过一条线连接？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T19:07:10.177

`group=1`您应该添加`aes()`呼叫以将点与线连接起来。这将*通知* `geom_line()`您所有的点都属于一个级别，并且应该连接它们。

```
ggplot(data=glomor, aes(x=as.character(Period),y=Value,group=1))+
   geom_point()+ylim(0,10) + geom_line() 
```

# html - 如何在 CSS 上制作高度为 100% 的 div？

> ID：15209037
> 
> 赞同：4
> 
> 时间：2013-03-04T19:01:26.340
> 
> 标签：html, css

大家好！我想让我的左侧菜单具有 100% 的高度。

右侧将有一个内容区域，右侧也有一个页脚。

我希望左侧的浅蓝色菜单到达页面的底部 0。

检查这个 JSFiddle [http://jsfiddle.net/mYw72/](http://jsfiddle.net/mYw72/)

或者这个代码！

```
 <div id="container">
        <div id="top">
            <div id="logo"></div>
            <div id="user-tools">
                <a href="#">Help</a>
                <span>&nbsp;|&nbsp;</span>
                <a href="#">Contact us</a>
            </div>
        </div>

        <div id="sidebar">
            <ul>
                <li><a href="#">Company</a></li>
                <li><a href="">Administrator</a></li>
                <li><a href="#">App</a></li>
                <li><a href="#">Configuration</a></li>
                <li><a href="#">Statistics</a></li>
                <li><a href="#">Monitor</a></li>
                <li><a href="#">Preference</a></li>
            </ul>
        </div>
        <div id="rightSide">
            <div id="content">
                Content.
            </div>

            <div id="bottom1">
                <div id="line-bottom"></div>
                <div id="text-bottom">Copyright 2012 <span>ME</span>, Inc. All Rights Reserved</div> 
            </div>
        </div>
    </div> 
```

CSS是这样的

```
html { 
padding:0px;
margin:0px;
}

body {
background-color: #ECEDEF;
font-family: Verdana, Tahoma, Sans-Serif;
color:#564b47;
padding:0px;
margin:0px;
}

#top {
background-image: url('../img/top.png');
background-repeat: repeat-x;
width: 100%;
height: 96px;
}

#rightSide{
overflow: hidden;
}

#sidebar{
position: relative; 
background:lightblue;
border-right:1.7px solid #FFFFFF; 
min-height: 100%;
line-height: 100%;
float: left; 
height:  100%;
margin-top: -5px;
}

#sidebar ul li {
list-style-type: square;
list-style-position: inside;
width:209px;
height:100%;
margin-top:15px;    
}
#sidebar ul li a{
list-style-position: inside;
display: block;
color:#3C3C3C;
text-decoration:none;
font-size:13px;
font-weight:bold;
padding:10px 20px 10px 40px;

}
#sidebar ul li a:hover {
color:#7da536;
width:209px;
border-right: 1.7px solid #ECEDEF;
background: #ECEDEF;
}
#sidebar ul li a:active{
background: #ECEDEF;
border-top: 1.7px solid #D8D9DB;
border-bottom: 1.7px solid #FFF;
border-right: 1.7px solid #FFF;
width:149px;

}

#content{
margin-left: 10px;

}

#bottom {
position: absolute;
bottom: 0;
background-color: #ECEDEF;
width: 100%;
padding: 53px 0 0 0;
}

#bottom1 {
position: absolute;
bottom: 0;
/*background-color: #ECEDEF;*/
background-color: greenyellow;
/*    width: 85.3%;*/
width: 100%;
padding: 53px 0 0 0;

/*    margin-left: 211px;*/
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T19:05:47.643

```
html, body, #container { height: 100% } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T19:08:11.947

您可以将左侧栏的高度设置为 100%，因为它里面的所有东西也都设置为 100% 的高度。

示例CSS：

```
html, body, #container{height:100%}
#sidebar{height:100%;} 
```

# oracle - Oracle 学说2 分组依据

> ID：15209040
> 
> 赞同：0
> 
> 时间：2013-03-04T19:01:54.393
> 
> 标签：oracle, doctrine-orm, oracle11g

我不太了解甲骨文。我最近不得不将用 PHP/MySQL 制作的应用程序迁移到 PHP/Oracle。当我使用 Doctrine2 时，我认为这不会那么难，但我在这里遇到了这个查询。这是 Doctrine2 生成的 SQL：

```
SELECT a.*
FROM
  (SELECT b0_.id     AS id0,
  b0_.created      AS created1,
  b1_.businessName AS businessName2,
  b1_.isVerified   AS isVerified3,
  COUNT(b2_.id)    AS sclr4
FROM br_merchants b1_
INNER JOIN br_user b0_
ON b1_.id = b0_.id
LEFT JOIN br_campaigns b2_
ON b1_.id = b2_.merchant_id
GROUP BY b0_.id,
  b0_.created,
  b1_.businessName,
  b1_.isVerified
ORDER BY b2_.created DESC
) a
WHERE ROWNUM <= 10 
```

我得到了`ORA-00979: not a GROUP BY expression`。我在某处读到我需要在 group by 语句中指定聚合函数未使用的所有列。我这样做了，但结果是一样的。

谁能告诉我哪里出错了！谢谢！

编辑：我做了`ORDER BY 2 DESC`并且它在 SQL Developer 中工作，但查询生成器不会占用 2。那么我该如何在 Doctrine2 查询生成器中做到这一点！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:13:54.697

我认为您的订单应该是`ORDER BY b0_.created DESC`而不是`ORDER BY b2_.created DESC`。当您尝试`ORDER BY 2 DESC`它时它正在工作，因为您是按第二列订购 -`b0_.created`

# search - 带有 edismax 的 RequestHandler 忽略同义词和停用词

> ID：15209043
> 
> 赞同：2
> 
> 时间：2013-03-04T19:01:58.967
> 
> 标签：search, solr, solrcloud

我在我的中定义了以下查询`solrconfig.xml`：

```
 <requestHandler name="/defaultSearch" class="solr.SearchHandler">
    <!-- Adds filters to all queries-->
    <lst name="appends">
      <str name="fq">-DELETED:true</str>
    </lst>

    <lst name="defaults">
      <!-- See http://wiki.apache.org/solr/DisMaxQParserPlugin -->
      <str name="defType">edismax</str>
      <str name="echoParams">explicit</str>
      <str name="df">text</str>
      <!-- As dismax is used, 0.00 = is pure dismax , 1.00 = sum -->
      <float name="tie">1.00</float>
      <!-- Query Fields - Search fileds with its height -->
      <str name="qf">
        DocumentDisplayName^10 DocumentName^9
        DocumentContent^5 DocumentDescription^3 DocumentTAGS^8
      </str>
      <!-- Phrase Field - frases fields used on quer as phrase >> "" -->
      <str name="pf">
        DocumentDisplayName^10 DocumentName^9
        DocumentContent^5 DocumentDescription^3 DocumentTAGS^8
      </str>
      <!-- See http://wiki.apache.org/solr/DisMaxQParserPlugin -->
      <str name="mm">
        2&lt;-1 5&lt;-2 6&lt;90%
      </str>
      <!-- Phrase whitespace ignore -->
      <int name="ps">10</int>
    </lst>
  </requestHandler> 
```

它工作得很好，但是，它只是忽略了我的停用词和同义词文件。

我不明白发生了什么，也不知道如何解决它。有什么帮助吗？

* * *

# 编辑

[使用的查询、结果（使用 debug=true）和 schema.xml 的有趣部分](https://gist.github.com/caarlos0/4ad53583fb2b30ef0bec)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T04:29:49.007

在没有通配符的情况下进行查询现在“解决”了这个问题。

谢谢。

# android - 调试已签名的 apk

> ID：15209048
> 
> 赞同：1
> 
> 时间：2013-03-04T19:02:16.867
> 
> 标签：android, eclipse, debugging

我正在尝试调试在真实设备上运行的签名 apk ......当我说调试时，我的意思是添加断点和单步之类的事情 - 我不仅仅意味着查看日志输出。

看看其他类似的问题，我似乎需要显示 DDMS 视图，然后以某种方式将调试器附加到进程，但我感到困惑有两个原因。

1.  我看不到真实设备下的进程列表（尽管如果我启动模拟器，我确实看到了进程列表）。**[这点现在解决了 - 见评论]**

2.  即使我确实运行了正在运行的进程列表，如何在实际运行应用程序之前在源代码中设置断点？eclipse怎么可能知道apk对应的源是什么？

我想我在这里遗漏了什么？是否有博客文章或类似文章可以指导我完成整个过程？

作为记录，我的设备已经配置为允许 USB 调试，并且我确实看到了来自我签名的 apk 应用程序的日志消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:38:07.730

根据我发现您正在尝试调试应用内购买代码的评论。为此，您不需要使用真正的证书。您也可以使用调试证书。因此，注册调试证书并使用该*调试*API 密钥。

所以你可以调试你已经知道的应用程序。

# jquery - 如何在 CSS 属性中使用 jQuery 变量

> ID：15209049
> 
> 赞同：5
> 
> 时间：2013-03-04T19:02:16.877
> 
> 标签：jquery, html, css, responsive-design

我有以下 jQuery，它可以找到响应式图像的高度：

```
 $(document).ready( function() { //Fires when DOM is loaded
            getImageSizes();
            $(window).resize(function() { //Fires when window is resized
                getImageSizes();
            });
        });
        function getImageSizes() {
            $("#slideshow img").each(function() {
                var $height = $(this);
                console.log( $height.height() );

            });

        } 
```

我的目标是使用 $height 变量来指定具有幻灯片 ID 的 div 的高度。

我假设我可以使用这个：

```
$('#slideshow').css({'height': $height + 'px;'}); 
```

但是它不起作用（没有指定高度）。

我像这样包含了上面的行：

```
 $(document).ready( function() { //Fires when DOM is loaded
            getImageSizes();
            $(window).resize(function() { //Fires when window is resized
                getImageSizes();
            });
        });
        function getImageSizes() {
            $("#slideshow img").each(function() {
                var $height = $(this);
                console.log( $height.height() );

                $('#slideshow').css({'height': $height + 'px;'});
            });

        } 
```

有什么我想念的吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T19:05:14.057

您正在记录`$height.height()`，但仅`$height`在 CSS 中使用。

如果你更好地命名你的变量，它会更容易：p

```
var $height = $(this).height();
$("#slideshow").css({"height":$height+"px"}); 
```

或者我的偏好：

```
document.getElementById('slideshow').style.height = this.height+"px"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T19:04:41.840

`$height`是一个 jQuery 变量。您需要通过调用来获取它的高度`.height()`。

```
$('#slideshow').css({'height': $height.height() + 'px'}); 
```

或者，您可以将实际高度存储为变量。

```
var height = $(this).height();
$('#slideshow').css({'height': height  + 'px'}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T19:05:03.843

您正在`$(this)`为变量保存 jQuery 对象`$height`

让它：`var $height = $(this).height();`你会一切准备就绪。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-04T19:06:12.643

问题出在您的事件处理程序中：

```
 function() {
            var $height = $(this);
            console.log( $height.height() );

            $('#slideshow').css({'height': $height + 'px;'});
        } 
```

您正在尝试将`$height`（一个 jQuery 对象）与`'px;'`（一个字符串）连接起来。这以 string 结尾`'[object Object]px;'`，这显然不是您想要的。您需要改用高度的值。这是我认为你想要的：

```
 function() {
            var height = $(this).height();
            console.log( height );

            $('#slideshow').css({'height': height + 'px'});
        } 
```

# delphi - 如何在 TStringGrid 中显示行号？

> ID：15209050
> 
> 赞同：3
> 
> 时间：2013-03-04T19:02:17.263
> 
> 标签：delphi, delphi-xe2, firemonkey, tstringgrid

如何在 FireMonkey 的 TStringGrid 中创建一个显示行号的列？

如果是使用 LiveBinding，我不知道怎么做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T21:20:52.990

您的表单/网格 OnGetValue 事件处理程序将该行作为其参数之一传递。只需验证该列是您想要的列并返回行号。

```
function Form1.Grid1GetValue(const Row, Col: Integer): TValue;
begin
  if Col = 0 then
    Result := TValue.From<Integer>(Row);
end; 
```

# css - 如果我们针对多个类，属性选择器的效率是否仍然低于类选择器？

> ID：15209053
> 
> 赞同：2
> 
> 时间：2013-03-04T19:02:26.640
> 
> 标签：css, css-selectors

我试图弄清楚使用查找特定前缀的属性选择器与手写每个需要样式的类选择器是否更有意义。例子：

```
[class^=c2] {
  ... 
} 
```

对比

```
.c2-1, .c2-2, .c2-3, .c2-4, [...] , .c2-9999 {
  ...
} 
```

我知道属性选择器[效率较低](http://csswizardry.com/2011/09/writing-efficient-css-selectors/)，但是当替代方案写出数百个类时，它们的效率是否仍然较低？我将其推向了逻辑极端，因为我还需要编写嵌套类，这意味着不使用 attr 选择器将导致 100-200 个手写类。

编辑：另一个约束：您不能更改标记或添加额外的类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T20:46:26.893

事实证明，这在页面加载、浏览器等方面有所不同。我们使用[http://stevesouders.com/efws/css-selectors/csscreate.php测试了差异](http://stevesouders.com/efws/css-selectors/csscreate.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T19:10:04.047

抱歉，但是`.c2`为每个元素添加一个类呢？
这绝对是最快、最合乎逻辑的方式。

# python - Python：解释 cProfile 日志

> ID：15209058
> 
> 赞同：0
> 
> 时间：2013-03-04T19:02:51.757
> 
> 标签：python, performance, cprofile

我有一种方法可以为每个人确定最合适的人。基本上，字典的项目上有两个嵌套循环，从一个人映射到一个列表（其中相似的列表确定兼容性），如果它大于外部循环的人的先前最大值，则计算并保存 compat .
所以我决定通过更新其他人的兼容性（内循环中的 on）来优化性能，因为兼容性是相同的，当外循环到达人 2 时我不必进行相同的计算和内在的一个人 1 [使用相容关系的对称性]。
好吧，我最终**慢了 20 倍**. c-profile 日志很奇怪，因为改进版本的所有操作都比未改进代码中的操作具有更好（或相似）的总时间。所以我绝对无法找到瓶颈。:(
**谁能给我关于如何解释这些日志的建议？邪恶的指令去哪儿了？**

正常代码日志：

```
 $ python -m cProfile -s time ./jukebox.py sample.txt
         92661414 function calls (92661412 primitive calls) in 124.355 CPU seconds

   Ordered by: internal time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
    10000   93.324    0.009  124.168    0.012 jukebox.py:88(solve_problem_4)
 42900000   16.616    0.000   16.616    0.000 {method 'intersection' of 'set' objects}
 42900000   10.831    0.000   10.831    0.000 {len}
  6180396    2.212    0.000    2.212    0.000 {method 'append' of 'list' objects}
   670000    1.185    0.000    1.185    0.000 {method 'items' of 'dict' objects}
        1    0.170    0.170  124.353  124.353 jukebox.py:1(<module>)
        1    0.009    0.009    0.013    0.013 heapq.py:31(<module>)
        1    0.004    0.004    0.004    0.004 bisect.py:1(<module>)
        1    0.002    0.002  124.355  124.355 {execfile}
       66    0.001    0.000    0.001    0.000 jukebox.py:18(update_bands)
       67    0.001    0.000    0.001    0.000 fileinput.py:166(isfirstline)
        1    0.000    0.000    0.002    0.002 jukebox.py:9(__init__)
        1    0.000    0.000    0.000    0.000 {open}
      198    0.000    0.000    0.000    0.000 {method 'strip' of 'str' objects}
      132    0.000    0.000    0.000    0.000 {method 'split' of 'str' objects}
        1    0.000    0.000  124.355  124.355 <string>:1(<module>)
        1    0.000    0.000    0.000    0.000 fileinput.py:240(__iter__)
       68    0.000    0.000    0.000    0.000 fileinput.py:243(next)
        1    0.000    0.000    0.000    0.000 {range}
        1    0.000    0.000    0.000    0.000 {method 'close' of 'file' objects}
        1    0.000    0.000    0.000    0.000 {isinstance}
        1    0.000    0.000    0.000    0.000 fileinput.py:80(<module>)
        1    0.000    0.000    0.000    0.000 fileinput.py:184(FileInput)
        1    0.000    0.000    0.000    0.000 fileinput.py:197(__init__)
        2    0.000    0.000    0.000    0.000 {method 'readlines' of 'file' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
      4/2    0.000    0.000    0.000    0.000 fileinput.py:292(readline)
      396    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 fileinput.py:91(input)
        1    0.000    0.000    0.000    0.000 fileinput.py:266(nextfile)
        1    0.000    0.000    0.000    0.000 jukebox.py:4(Reader)
       67    0.000    0.000    0.000    0.000 fileinput.py:371(isfirstline) 
```

“优化”一的日志：

```
$ python -m cProfile -s time ./jukebox-imp.py sample.txt
         49761414 function calls (49761412 primitive calls) in 2166.613 CPU seconds

   Ordered by: internal time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
    10000 2147.248    0.215 2165.759    0.217 jukebox-imp.py:88(solve_problem_4)
 21450000    8.952    0.000    8.952    0.000 {method 'intersection' of 'set' objects}
 21450000    5.951    0.000    5.951    0.000 {len}
  6180396    2.152    0.000    2.152    0.000 {method 'append' of 'list' objects}
   660000    1.441    0.000    1.441    0.000 {method 'items' of 'dict' objects}
        1    0.837    0.837 2166.611 2166.611 jukebox-imp.py:1(<module>)
    10000    0.015    0.000    0.015    0.000 {method 'keys' of 'dict' objects}
        1    0.010    0.010    0.013    0.013 heapq.py:31(<module>)
        1    0.003    0.003    0.003    0.003 bisect.py:1(<module>)
        1    0.002    0.002 2166.613 2166.613 {execfile}
       66    0.002    0.000    0.002    0.000 jukebox-imp.py:18(update_bands)
        1    0.000    0.000    0.000    0.000 {open}
      198    0.000    0.000    0.000    0.000 {method 'strip' of 'str' objects}
      132    0.000    0.000    0.000    0.000 {method 'split' of 'str' objects}
        1    0.000    0.000 2166.613 2166.613 <string>:1(<module>)
        1    0.000    0.000    0.000    0.000 fileinput.py:240(__iter__)
        1    0.000    0.000    0.002    0.002 jukebox-imp.py:9(__init__)
       68    0.000    0.000    0.000    0.000 fileinput.py:243(next)
        1    0.000    0.000    0.000    0.000 {range}
        1    0.000    0.000    0.000    0.000 {method 'close' of 'file' objects}
        1    0.000    0.000    0.000    0.000 {isinstance}
        1    0.000    0.000    0.000    0.000 fileinput.py:80(<module>)
        1    0.000    0.000    0.000    0.000 fileinput.py:184(FileInput)
        1    0.000    0.000    0.000    0.000 fileinput.py:197(__init__)
        2    0.000    0.000    0.000    0.000 {method 'readlines' of 'file' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
      4/2    0.000    0.000    0.000    0.000 fileinput.py:292(readline)
      396    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
       67    0.000    0.000    0.000    0.000 fileinput.py:166(isfirstline)
        1    0.000    0.000    0.000    0.000 fileinput.py:91(input)
        1    0.000    0.000    0.000    0.000 fileinput.py:266(nextfile)
       67    0.000    0.000    0.000    0.000 fileinput.py:371(isfirstline)
        1    0.000    0.000    0.000    0.000 jukebox-imp.py:4(Reader) 
```

//**编辑**：
以防万一我也可以提供代码。据我所知，后者绝对没有理由比前者慢 20 倍。

正常的一个：

```
def solve_problem_4(colleagues):
MIN_COMPAT = 1
compat_dict = dict()

for colleague_1, bands_1 in colleagues.items():
    compat_dict[colleague_1] = (0,[])
    for colleague_2, bands_2 in colleagues.items():
        if colleague_1 == colleague_2:
            continue

        compat = len(set(bands_1).intersection(set(bands_2)))
        if compat > MIN_COMPAT:
            old_compat,top_colleagues  = compat_dict[colleague_1]
            if compat > old_compat:
                compat_dict[colleague_1] = (compat,[colleague_2])
            elif compat == old_compat:
                top_colleagues.append(colleague_2)

return compat_dict 
```

和“优化”：

```
def solve_problem_4(colleagues):
MIN_COMPAT = 1
compat_dict = defaultdict(lambda: (0,[]))  #change here
checked_pairs = []

for colleague_1, bands_1 in colleagues.items()[:-1]:
    for colleague_2, bands_2 in colleagues.items():
        if colleague_1 == colleague_2 or (colleague_2,colleague_1) in checked_pairs:  # change here, exclude used pairs
            continue

        checked_pairs += [(colleague_1,colleague_2)]  # change here, note down checked pair  
        compat = len(set(bands_1).intersection(set(bands_2)))

        if compat > MIN_COMPAT:
            old_compat, top_colleagues  = compat_dict[colleague_1]
            if compat > old_compat:
                compat_dict[colleague_1] = compat,[colleague_2]
            elif compat == old_compat:
                top_colleagues.append(colleague_2)

            old_compat, top_colleagues  = compat_dict[colleague_2] # change here, update symmetric pair
            if compat > old_compat:  # imagine extract method refactoring here ;)
                compat_dict[colleague_2] = compat,[colleague_1]
            elif compat == old_compat:
                top_colleagues.append(colleague_1)
return compat_dict 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T19:56:59.253

或者，在 cProfile 转储上运行 runsnakerun 可提供易于理解的图形视图。

```
python -m cProfile -o dump.cprofile script.py   
runsnakerun dump.cprofile 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T19:13:46.063

如果你按cumtime排序应该更清楚。

# matlab - 为分割图像着色

> ID：15209059
> 
> 赞同：0
> 
> 时间：2013-03-04T19:02:56.877
> 
> 标签：matlab, image-segmentation

我已经分割了一个图像，我现在希望我的用户将颜色作为线段输入到段上，并用所需的颜色为段着色，我该怎么做？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T15:13:23.120

使用[ginput](http://www.mathworks.com/help/matlab/ref/ginput.html)

```
[x,y,button] = ginput 
```

你可以得到点击的坐标。然后你可以使用

```
image(x-R:x+R,y-R:y+R) = COLOR 
```

我假设你有一个二维图像矩阵。对于 3D，您必须使用[repmat](http://www.mathworks.com/help/matlab/ref/repmat.html)和[shiftdim](http://www.mathworks.com/help/matlab/ref/shiftdim.html)来使颜色矢量的大小为 1x1x3：

```
image(x-R:x+R,y-R:y+R,:) = repmat(shiftdim(COLOR,1),[2*N+1,2*N+1,1]) 
```

再次假设您要制作一个彩色正方形。圆圈有点复杂——可能布尔掩码是最好的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T15:53:48.390

如果您有灰度或索引图像，则可以`ginput`按照 Dedek 的建议获取输入坐标，然后在这些坐标处修改索引/灰度值的[颜色图。](http://www.mathworks.com/help/matlab/ref/colormap.html)您还应该查看上面`Colormap Editor`链接底部的`colormap`链接，看看是否满足您的需求。

# ios - 在某些情况下重复使用 UITableViewCells

> ID：15209060
> 
> 赞同：0
> 
> 时间：2013-03-04T19:02:58.917
> 
> 标签：ios, uitableview

我有一个表格视图，每个单元格都包含另一个用于水平滚动的表格视图。主表格视图只有 6 个单元格高，所以最初我没有重用单元格，尽管垂直滚动很不稳定，所以我决定重用单元格。在垂直表格视图中有 3 种不同类型的水平单元格。2 种工作正常。1 种类型正在复制。我在这里展示了一个图表，希望能更好地解释这一点：

```
Vertical TableView

Row 0 Cell type A
Row 1 Cell type B
Row 2 Cell type C
Row 3 Cell type C
Row 4 Cell type C
Row 5 Cell type B
Row 6 Cell type C 
```

它们都显示正确，但由于某种原因，第 6 行中显示的数据与第 2 行中显示的数据相同。显然还有其他 C 行，但只有 2-6 行重复。我检查了数据数组，并且正确的数据被传递到该行。此外，当我滚动第 6 行并上升到第 2 行时，它也会滚动到相同的索引。当我关闭重用单元格时，这个问题就消失了，但是滚动并不顺畅。这是有问题的单元格类型的表格视图代码。

```
 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
  {
  static NSString *CellIdentifier = @"HorizontalCell";
  HorizontalTableCell *cell = (HorizontalTableCell *)[self.homeTable dequeueReusableCellWithIdentifier:CellIdentifier];
       if (cell == nil)
        {
           cell = [[HorizontalTableCell alloc] initWithFrame:CGRectMake(0, 0, self.homeTable.frame.size.width, self.homeTable.frame.size.height)];

                    // Configure cell
                    UIImage *bgImage = [UIImage imageNamed:@"verticalCell-back.png"];
                    UIImageView *bgView = [[UIImageView alloc]initWithFrame:cell.frame];
                    [bgView setImage:bgImage];
                    cell.backgroundView = bgView;

                    // Set up the title label
                    UILabel * titleLabel = [[UILabel alloc]init];
                    titleLabel.tag = TITLE_LABEL_TAG;
                    titleLabel.font = [UIFont boldSystemFontOfSize:13];
                    titleLabel.textColor = [UIColor lightGrayColor];
                    titleLabel.backgroundColor = [UIColor clearColor];
                    titleLabel.shadowColor = [UIColor blackColor];
                    titleLabel.shadowOffset = CGSizeMake(0, -1);

                    // Set up the value label
                    UILabel * titleValueLabel = [[UILabel alloc]init];
                    titleValueLabel.tag = TITLE_VALUE_LABEL_TAG;
                    titleValueLabel.font = [UIFont boldSystemFontOfSize:13];
                    titleValueLabel.textColor = [UIColor whiteColor];
                    titleValueLabel.backgroundColor = [UIColor clearColor];
                    titleValueLabel.shadowColor = [UIColor blackColor];
                    titleValueLabel.shadowOffset = CGSizeMake(0, -1);

                    [cell addSubview:titleValueLabel];
                    [cell addSubview:titleLabel];

                    cell.selectionStyle = UITableViewCellSelectionStyleNone;
                }

                cell.data = [dataArray objectAtIndex:indexPath.section];
                cell.horizontalTableView.scrollsToTop = NO;

                for (int i = 0; i < [[dataArray objectAtIndex:indexPath.section] count]; i++ ) {
                    PosterData *poster = [[dataArray objectAtIndex:indexPath.section] objectAtIndex:i];
                    NSLog(@"Row Number %u Data %@", indexPath.section, poster.name);
                }

                //Set up the title label
                NSArray *labelTextArray =  [[titlesArray objectAtIndex:indexPath.section] componentsSeparatedByString:@"**"];
                CGSize expectedLabelSize = [[labelTextArray objectAtIndex:0] sizeWithFont:[UIFont boldSystemFontOfSize:13]
                                                                        constrainedToSize:CGSizeMake(280, 15)
                                                                            lineBreakMode:NSLineBreakByTruncatingTail];

                // Get the labels
                UILabel * titleLabel = (UILabel *)[cell viewWithTag:TITLE_LABEL_TAG];
                UILabel * titleValueLabel = (UILabel *)[cell viewWithTag:TITLE_VALUE_LABEL_TAG];

                titleLabel.frame = CGRectMake(8, 13, expectedLabelSize.width + 2, 15);
                titleValueLabel.frame = CGRectMake(expectedLabelSize.width + 8, 13, 150, 15);

                titleLabel.text = [labelTextArray objectAtIndex:0];
                NSLog(@"Label Text Array %@", labelTextArray);
                if ([labelTextArray count] > 1) {
                    titleValueLabel.text = [labelTextArray objectAtIndex:1];
                }
                else titleValueLabel.text = @"";

                return cell; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T00:13:58.720

看到没人评论，我解决了这个问题。以为我会分享答案。我没有`-(void) prepareForReuse`在我的细胞中实施。我只是用那个方法重新加载了水平tableView，解决了我的问题

# java - Java PreparedStatement 语法问题

> ID：15209061
> 
> 赞同：0
> 
> 时间：2013-03-04T19:03:03.643
> 
> 标签：java, sql, derby

在使用 Java PreparedStatements 时，我遇到了一些 SQL 语法错误问题。

我试图准备的三个陈述如下：

```
insertBook = con.prepareStatement("INSERT INTO Books ? VALUES ?");
selectBooks = con.prepareStatement("SELECT * FROM Books?");
deleteBooks = con.prepareStatement("DELETE FROM Books?"); 
```

在第一个语句中，我想传入两个字符串，一个包含要插入的列列表，另一个包含要插入的所有值。在另外两个语句中，我想在末尾插入一个（可选的）WHERE 子句。

我已经看到[这个](https://stackoverflow.com/questions/10739408/why-am-i-getting-a-syntax-error-with-this-prepared-statement)问题似乎处理了类似的问题，但在他的情况下，他似乎试图在没有意义的地方使用 ?s ；除非我在 SQL 上失败了，否则我看不出有什么理由不能在这里插入我的字符串。我已经搜索了 Javadocs，但似乎也无法在那里给出解释。

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:07:05.920

这就是它的设计方式。?-s 仅用于参数，考虑用于`StringBuilder`连接您的“WHERE”子句。

这只是一个你可能不会`StringBuilder`在这里使用的简单案例，它对于构建复杂的查询很有效

这是你的例子

```
String whereClause = " WHERE Id = ?";

String insert = "INSERT INTO [Table](C1, C2) VALUES(?, ?)";
String select = "SELECT * FROM [Table] ";
String update = "UPDATE [Table] SET C1 = ? ";
String delete = "DELETE FROM [Table] ";

PreparedStatement insertSt = con.prepareStatement(insert);
PreparedStatement selectSt = con.prepareStatement(select + whereClause);
PreparedStatement deleteSt = con.prepareStatement(update + whereClause);
PreparedStatement updateSt = con.prepareStatement(delete + whereClause); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T19:07:59.447

对于您的第一个陈述：

```
insertBook = con.prepareStatement("INSERT INTO Books ? VALUES ?"); 
```

我将从第二个开始`?`，之后`VALUES`。由于您只有一个`?`，因此您只有一个占位符，因此只能将一个值传递给语句。仅此部分就使您的目标无法通过 JDBC 实现。事实上，prepareStatement() 将至少对于某些驱动程序和数据库，将语句发送到数据库服务器，指示它准备语句。届时，服务器将解析和规划语句，因此此时必须知道列和参数的数量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T19:08:38.727

这 ”？” 在 JDBC 中，与底层 DBMS 协议支持的参数替换密切相关。但是，您正在尝试更改发送到数据库的实际 SQL，而不是替换参数。

# c - gcc：将 sysroot 指定为环境变量？

> ID：15209062
> 
> 赞同：0
> 
> 时间：2013-03-04T19:03:05.733
> 
> 标签：c, linux, gcc, environment-variables

这与这个问题完全相同：[替代 gcc 的 --sysroot 开关？](https://stackoverflow.com/questions/2977182/alternatives-to-the-sysroot-switch-of-gcc)但它有一个非常模糊的非建设性答案。

所以我只是迁移了工具链，我不想用'gcc --sysroot=/my/path/'替换'gcc'的每个实例。我已经尝试将/my/path 放入$PATH、$SYSROOT 和$GNUSYSROOT。

gcc -dumpspecs 只有 4 个对 sysroot 的引用：

```
*sysroot_spec:
--sysroot=%R

*sysroot_suffix_spec:

*sysroot_hdrs_suffix_spec: 
```

我还有其他方法可以做到这一点吗？

# mysql - 用mysql从时间戳中减去日期时间

> ID：15209064
> 
> 赞同：0
> 
> 时间：2013-03-04T19:03:12.477
> 
> 标签：mysql, sql, database

我必须在来自两个不同表的两个字段之间进行减法运算，其中一个字段是日期时间，另一个字段是时间戳。

实现这一目标的最佳方法是什么？

首先转换为unix时间戳？

就像是：

```
select UNIX_TIMESTAMP(t1.col1) - UNIX_TIMESTAMP(t2.col2) from t1, t2 ... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:10:33.513

[`TIMESTAMPDIFF`](https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_timestampdiff)是迄今为止最通用的选择。

```
select timestampdiff(SECOND, t1.col1, t2.col2); 
```

[在小提琴](http://sqlfiddle.com/#!2/c9a58/3)中看到它

# javascript - 如何限制输入文本

> ID：15209070
> 
> 赞同：-1
> 
> 时间：2013-03-04T19:03:48.947
> 
> 标签：javascript, jquery, html

我有一个小的 html 联系表格，其中仅包含姓名和电话。

我想要做的是每当`Key Up`事件发生时我想检查按下了哪个键，并且对于该`Phone`字段我只接受数字。对于该`Name`字段，我只允许字母，而不是数字。

例如，如果我在输入中输入数据`Phone`，并且按下除数字以外的任何字符，则它不应显示在输入字段中。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:16:41.263

HTML

```
<input type="text" name="phone" id="phone" placeholder="Phone" /><br />
<input type="text" name="name" id="name" placeholder="Name" /> 
```

jQuery

```
$("#phone").keyup(function() {
    if (this.value.match(/[^0-9]/g)) {
      this.value = this.value.replace(/[^0-9]/g, '');
    }
});

$("#name").keyup(function() {
     if (this.value.match(/[^a-zA-Z]/g)) {
       this.value = this.value.replace(/[^a-zA-Z]/g, '');
     }
}); 
```

演示：http: [//jsfiddle.net/calder12/KfRxv/](http://jsfiddle.net/calder12/KfRxv/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T19:13:31.763

对于数字字符，仅添加以下 javascript：

```
function checkInput(e)
{
  var k;
  document.all ? k = e.keyCode : k = e.which;
  var char = String.fromCharCode(k);
  if(!char.match(/^\d+$/))return false;

  return true;
} 
```

然后在输入元素的标记中添加 onkeypress="return checkInput(event)"。

您可以修改 JS 以仅允许您想要的任何字符。

# git - 如何拥有干净的 git 历史记录

> ID：15209075
> 
> 赞同：1
> 
> 时间：2013-03-04T19:04:10.553
> 
> 标签：git, git-merge, git-push, git-pull, github-api

就在将本地更改推送到远程存储库之前，git 总是要求我们将本地分支与远程分支同步。为此，我先做 git pull，然后提交拉取的更改，最后再推送。

这种方法的问题是，git 将拉入的文件与我现有的更改合并，并且将来当我试图弄清楚我在该特定提交上做了什么时，我所做的和合并的拉取之间没有明显的区别。

我希望有一个干净的历史记录，即我的提交总是应该有/只显示我添加的那些更改，而不是由于拉取而合并的那些更改。

对于这个问题，我能想到的一种解决方案是为给定的远程分支设置两个本地分支。(1) 用于您的更改，(2) 用于与遥控器同步，当需要推送时，先将 (2) 与遥控器同步，然后将 (1) 与 (2) 合并，然后从 (2) 推送

关于如何拥有干净的历史记录还有其他建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T19:09:13.297

在推送到远程存储库（您的本地提交）之前，您应该执行

```
git fetch origin 
```

获取对存储库所做的所有更改（origin 只是一个示例名称）。之后，做一个

```
git rebase origin/remote-branch 
```

为了将您的本地分支重新设置在原始/远程分支之上。

如果文件在本地和存储库中都发生了更改，则必须在此处修复合并问题。如果`rebase`顺利完成，您就可以推动：

```
git push origin local-branch 
```

这将保持一个干净的直 git 分支。

# image - 如何在 Delphi 中获取图像文件的尺寸？

> ID：15209076
> 
> 赞同：8
> 
> 时间：2013-03-04T19:04:16.160
> 
> 标签：image, delphi, dimensions, image-size

我想在打开该文件之前知道图像文件的宽度和高度。

那么，我该怎么做呢？

这是指[JPEG](https://en.wikipedia.org/wiki/JPEG)、[BMP](https://en.wikipedia.org/wiki/BMP_file_format)、[PNG](https://en.wikipedia.org/wiki/Portable_Network_Graphics)和[GIF](https://en.wikipedia.org/wiki/Graphics_Interchange_Format)类型的图像文件。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-04T19:12:14.610

如果“图像文件”是指 VCL 图形系统识别的那些光栅图像文件，而“打开之前”是指“在用户可能注意到文件已打开之前”，那么您可以很容易地做到这一点：

```
var
  pict: TPicture;
begin
  with TOpenDialog.Create(nil) do
    try
      if Execute then
      begin
        pict := TPicture.Create;          
        try
          pict.LoadFromFile(FileName);
          Caption := Format('%d×%d', [pict.Width, pict.Height])
        finally
          pict.Free;
        end;
      end;
    finally
      Free;
    end; 
```

当然，文件*是打开*的，如果图像很大，这需要很大的内存。但是，如果您需要在不加载文件的情况下获取元数据（如维度），我相信您需要一个更“复杂”的解决方案。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-03-04T19:15:35.803

你可以试试[这个页面](http://www.delphidabbler.com/tips/201)。我没有测试过它，但它似乎很合理。

此外，不同的文件类型有不同的获取宽度和高度的方法。

其中一页回答：

```
unit ImgSize;

interface

uses Classes;

procedure GetJPGSize(const sFile: string; var wWidth, wHeight: word);
procedure GetPNGSize(const sFile: string; var wWidth, wHeight: word);
procedure GetGIFSize(const sGIFFile: string; var wWidth, wHeight: word);

implementation

uses SysUtils;

function ReadMWord(f: TFileStream): word;

type
  TMotorolaWord = record
  case byte of
  0: (Value: word);
  1: (Byte1, Byte2: byte);
end;

var
  MW: TMotorolaWord;
begin
  // It would probably be better to just read these two bytes in normally and
  // then do a small ASM routine to swap them. But we aren't talking about
  // reading entire files, so I doubt the performance gain would be worth the trouble.
  f.Read(MW.Byte2, SizeOf(Byte));
  f.Read(MW.Byte1, SizeOf(Byte));
  Result := MW.Value;
end;

procedure GetJPGSize(const sFile: string; var wWidth, wHeight: word);
const
  ValidSig : array[0..1] of byte = ($FF, $D8);
  Parameterless = [$01, $D0, $D1, $D2, $D3, $D4, $D5, $D6, $D7];
var
  Sig: array[0..1] of byte;
  f: TFileStream;
  x: integer;
  Seg: byte;
  Dummy: array[0..15] of byte;
  Len: word;
  ReadLen: LongInt;
begin
  FillChar(Sig, SizeOf(Sig), #0);
  f := TFileStream.Create(sFile, fmOpenRead);
  try
    ReadLen := f.Read(Sig[0], SizeOf(Sig));
    for x := Low(Sig) to High(Sig) do
      if Sig[x] <> ValidSig[x] then
        ReadLen := 0;
      if ReadLen > 0 then
      begin
        ReadLen := f.Read(Seg, 1);
        while (Seg = $FF) and (ReadLen > 0) do
        begin
          ReadLen := f.Read(Seg, 1);
          if Seg <> $FF then
          begin
            if (Seg = $C0) or (Seg = $C1) then
            begin
              ReadLen := f.Read(Dummy[0], 3);  // don't need these bytes
              wHeight := ReadMWord(f);
              wWidth := ReadMWord(f);
            end
            else
            begin
              if not (Seg in Parameterless) then
              begin
                Len := ReadMWord(f);
                f.Seek(Len - 2, 1);
                f.Read(Seg, 1);
              end
              else
                Seg := $FF;  // Fake it to keep looping.
            end;
          end;
        end;
      end;
    finally
    f.Free;
  end;
end;

procedure GetPNGSize(const sFile: string; var wWidth, wHeight: word);
type
  TPNGSig = array[0..7] of byte;
const
  ValidSig: TPNGSig = (137, 80, 78, 71, 13, 10, 26, 10);
var
  Sig: TPNGSig;
  f: tFileStream;
  x: integer;
begin
  FillChar(Sig, SizeOf(Sig), #0);
  f := TFileStream.Create(sFile, fmOpenRead);
  try
    f.Read(Sig[0], SizeOf(Sig));
    for x := Low(Sig) to High(Sig) do
      if Sig[x] <> ValidSig[x] then
        exit;
      f.Seek(18, 0);
      wWidth := ReadMWord(f);
      f.Seek(22, 0);
      wHeight := ReadMWord(f);
  finally
    f.Free;
  end;
end;

procedure GetGIFSize(const sGIFFile: string; var wWidth, wHeight: word);
type
  TGIFHeader = record
  Sig: array[0..5] of char;
  ScreenWidth, ScreenHeight: word;
  Flags, Background, Aspect: byte;
end;
  TGIFImageBlock = record
  Left, Top, Width, Height: word;
  Flags: byte;
end;
var
  f: file;
  Header: TGifHeader;
  ImageBlock: TGifImageBlock;
  nResult: integer;
  x: integer;
  c: char;
  DimensionsFound: boolean;
begin
  wWidth  := 0;
  wHeight := 0;
  if sGifFile = '' then
    exit;

  {$I-}

  FileMode := 0;  // read-only
  AssignFile(f, sGifFile);
  reset(f, 1);
  if IOResult <> 0 then
    // Could not open file
  exit;
  // Read header and ensure valid file
  BlockRead(f, Header, SizeOf(TGifHeader), nResult);
  if (nResult <> SizeOf(TGifHeader)) or (IOResult <> 0)
    or (StrLComp('GIF', Header.Sig, 3) <> 0) then
  begin
    // Image file invalid
    close(f);
    exit;
  end;
  // Skip color map, if there is one
  if (Header.Flags and $80) > 0 then
  begin
    x := 3 * (1 SHL ((Header.Flags and 7) + 1));
    Seek(f, x);
    if IOResult <> 0 then
    begin
      // Color map thrashed
      close(f);
      exit;
    end;
  end;
  DimensionsFound := False;
  FillChar(ImageBlock, SizeOf(TGIFImageBlock), #0);
  // Step through blocks
  BlockRead(f, c, 1, nResult);
  while (not EOF(f)) and (not DimensionsFound) do
  begin
    case c of
    ',':  // Found image
    begin
      BlockRead(f, ImageBlock, SizeOf(TGIFImageBlock), nResult);
      if nResult <> SizeOf(TGIFImageBlock) then
      begin
        // Invalid image block encountered
        close(f);
        exit;
      end;
      wWidth := ImageBlock.Width;
      wHeight := ImageBlock.Height;
      DimensionsFound := True;
    end;
    ',' :  // Skip
    begin
      // NOP
    end;
    // nothing else, just ignore
  end;
  BlockRead(f, c, 1, nResult);
end;
close(f);

{$I+}

end;

end. 
```

对于 BMP（也可以在我提到的页面上找到）：

```
function FetchBitmapHeader(PictFileName: String; Var wd, ht: Word): Boolean;
// similar routine is in "BitmapRegion" routine
label ErrExit;
const
  ValidSig: array[0..1] of byte = ($FF, $D8);
  Parameterless = [$01, $D0, $D1, $D2, $D3, $D4, $D5, $D6, $D7];
  BmpSig = $4d42;
var
  // Err : Boolean;
  fh: HFile;
  // tof : TOFSTRUCT;
  bf: TBITMAPFILEHEADER;
  bh: TBITMAPINFOHEADER;
  // JpgImg  : TJPEGImage;
  Itype: Smallint;
  Sig: array[0..1] of byte;
  x: integer;
  Seg: byte;
  Dummy: array[0..15] of byte;
  skipLen: word;
  OkBmp, Readgood: Boolean;
begin
  // Open the file and get a handle to it's BITMAPINFO
  OkBmp := False;
  Itype := ImageType(PictFileName);
  fh := CreateFile(PChar(PictFileName), GENERIC_READ, FILE_SHARE_READ, Nil,
           OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, 0);
  if (fh = INVALID_HANDLE_VALUE) then
    goto ErrExit;
  if Itype = 1 then
  begin
    // read the BITMAPFILEHEADER
    if not GoodFileRead(fh, @bf, sizeof(bf)) then
      goto ErrExit;
    if (bf.bfType <> BmpSig) then  // 'BM'
      goto ErrExit;
    if not GoodFileRead(fh, @bh, sizeof(bh)) then
      goto ErrExit;
    // for now, don't even deal with CORE headers
    if (bh.biSize = sizeof(TBITMAPCOREHEADER)) then
      goto ErrExit;
    wd := bh.biWidth;
    ht := bh.biheight;
    OkBmp := True;
  end
  else
  if (Itype = 2) then
  begin
    FillChar(Sig, SizeOf(Sig), #0);
    if not GoodFileRead(fh, @Sig[0], sizeof(Sig)) then
      goto ErrExit;
    for x := Low(Sig) to High(Sig) do
      if Sig[x] <> ValidSig[x] then
        goto ErrExit;
      Readgood := GoodFileRead(fh, @Seg, sizeof(Seg));
      while (Seg = $FF) and Readgood do
      begin
        Readgood := GoodFileRead(fh, @Seg, sizeof(Seg));
        if Seg <> $FF then
        begin
          if (Seg = $C0) or (Seg = $C1) or (Seg = $C2) then
          begin
            Readgood := GoodFileRead(fh, @Dummy[0],3);  // don't need these bytes
            if ReadMWord(fh, ht) and ReadMWord(fh, wd) then
              OkBmp := True;
          end
          else
          begin
            if not (Seg in Parameterless) then
            begin
              ReadMWord(fh,skipLen);
              SetFilePointer(fh, skipLen - 2, nil, FILE_CURRENT);
              GoodFileRead(fh, @Seg, sizeof(Seg));
            end
            else
              Seg := $FF;  // Fake it to keep looping
          end;
        end;
      end;
  end;
  ErrExit: CloseHandle(fh);
  Result := OkBmp;
end; 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-03-04T19:29:59.253

作为对[Rafael 回答](https://stackoverflow.com/a/15209265/282848)的补充，我相信这个更短的过程可以检测 BMP 尺寸：

```
function GetBitmapDimensions(const FileName: string; out Width,
  Height: integer): boolean;
const
  BMP_MAGIC_WORD = ord('M') shl 8 or ord('B');
var
  f: TFileStream;
  header: TBitmapFileHeader;
  info: TBitmapInfoHeader;
begin
  result := false;
  f := TFileStream.Create(FileName, fmOpenRead);
  try
    if f.Read(header, sizeof(header)) <> sizeof(header) then Exit;
    if header.bfType <> BMP_MAGIC_WORD then Exit;
    if f.Read(info, sizeof(info)) <> sizeof(info) then Exit;
    Width := info.biWidth;
    Height := abs(info.biHeight);
    result := true;
  finally
    f.Free;
  end;
end; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-10-08T10:34:17.020

如果有人对在不加载图形的情况下检索 TIFF 图像尺寸感兴趣，那么有一种经过验证的方法可以在所有环境中完美地为我工作。我还为此找到[了另一种解决方案](http://delphi.xcjc.net/viewthread.php?tid=44798)，但它从 Illustrator 生成的 TIFF 中返回了错误的值。但是有一个很棒的图形库，[由 Mike Lischke](http://www.soft-gems.net/supplement/download.php?ID=13)（TVirtualStringTree 的非常有才华的开发人员）称为 GraphicEx。有许多流行的图像格式的实现，它们都来自基类 TGraphicExGraphic，它实现了 ReadImageProperties 虚拟方法。它是基于流的，并且只在所有实现中读取文件头。所以它快如闪电...... :-)

因此，这里是一个示例代码，它检索 TIFF 的尺寸（该方法对于所有图形实现都是相同的，PNG、PCD、TGA、GIF、PCX 等）：

```
Uses ..., GraphicEx,...,...;

Procedure ReadTifSize (FN:String; Var iWidth,iHeight:Integer);
Var FS:TFileStream;
    TIFF:TTIFFGraphic;
Begin
  iWidth:=0;iHeight:=0;
  TIFF:=TTIFFGraphic.Create;
  FS:=TFileStream.Create(FN,OF_READ);

  Try
    TIFF.ReadImageProperties(FS,0);
    iWidth:=TIFF.ImageProperties.Width;
    iHeight:=TIFF.ImageProperties.Height;
  Finally
    TIFF.Destroy;
    FS.Free;
  End;
End; 
```

就是这样...... :-) 这对于单元中的所有图形实现都是一样的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-07-20T15:01:35.593

我不太喜欢[Rafael 的](https://stackoverflow.com/questions/15209076/how-can-i-get-dimensions-of-an-image-file-in-delphi/15209265#15209265)JPEG 文件解决方案，因为他的算法会解析每个字节，直到达到 FFC0。它没有利用几乎所有标记（FFD8、FFD9 和 FFFE 除外）后跟两个长度字节的事实，允许从一个标记跳到另一个标记。所以我建议以下过程（通过填充检查标记并将值检索到同一函数中，我进一步压缩了该过程）：

```
procedure GetJPGSize(const Filename: string; var ImgWidth, ImgHeight: word);
const
  SigJPG : TBytes = [$FF, $D8];
  SigC01 : TBytes = [$FF, $C0];
  SigC02 : TBytes = [$FF, $C1];
var
  FStream: TFileStream;
  Buf: array[0..1] of Byte;
  Offset,CheckMarker : Word;
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  function  SameValue(Sig:TBytes):Boolean;
  begin
     Result := CompareMem(@Sig[0], @Buf[0], Length(Sig));
  end;
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  function  CheckMarkerOrVal(var Value:Word):Boolean;
  begin
    FStream.ReadData(Buf, Length(Buf));
    Value := Swap(PWord(@Buf[0])^);
    Result := (Buf[0] = $FF);
  end;
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
begin
  FStream := TFileStream.Create(Filename, fmOpenRead);
  Try
    // First two bytes in a JPG file MUST be $FFD8, followed by the next marker
    If not (CheckMarkerOrVal(CheckMarker) and SameValue(SigJPG))
      then exit;
    Repeat
      If not CheckMarkerOrVal(CheckMarker)
        then exit;
      If SameValue(SigC01) or SameValue(SigC02) then begin
        FStream.Position := FStream.Position + 3;
        CheckMarkerOrVal(ImgHeight);
        CheckMarkerOrVal(ImgWidth);
        exit;
      end;
      CheckMarkerOrVal(Offset);
      FStream.Position := FStream.Position + Offset - 2;
    until FStream.Position > FStream.Size div 2;
  Finally
    FStream.Free;
  end;
end; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-06-22T03:42:46.570

由于`GetGIFSize`在[Rafael 的回答中，答案](https://stackoverflow.com/questions/15209076/how-can-i-get-dimensions-of-an-image-file-in-delphi/15209265#15209265)是破碎的并且非常复杂，这是我个人的版本：

```
function GetGifSize(var Stream: TMemoryStream; var Width: Word; var Height: Word): Boolean;
var
    HeaderStr: AnsiString;

begin
    Result := False;
    Width := 0;
    Height := 0;

    //GIF header is 13 bytes in length
    if Stream.Size > 13 then
    begin
        SetString(HeaderStr, PAnsiChar(Stream.Memory), 6);
        if (HeaderStr = 'GIF89a') or (HeaderStr = 'GIF87a') then
        begin
            Stream.Seek(6, soFromBeginning);
            Stream.Read(Width, 2);  //Width is located at bytes 7-8
            Stream.Read(Height, 2); //Height is located at bytes 9-10

            Result := True;
        end;
    end;
end; 
```

我通过阅读[RFC](https://www.w3.org/Graphics/GIF/spec-gif89a.txt)找到了它。

# c++ - 在 Windows 中找到超过 4gb 的正确文件大小

> ID：15209077
> 
> 赞同：6
> 
> 时间：2013-03-04T19:04:25.040
> 
> 标签：c++, windows, visual-studio, winapi

我已使用此 c++ 代码在 Windows 中查找某些文件的文件大小（使用 Visual Studio）：

```
(p_findFileData->nFileSizeHigh * MAXDWORD) + p_findFileData->nFileSizeLow); 
```

如果文件大于 4gb，这并没有给我正确的文件大小。经过一些研究，我尝试了：

```
(p_findFileData->nFileSizeHigh * (MAXDWORD+1)) + p_findFileData->nFileSizeLow); 
```

当我读到 nfilesizehigh 和 nfilesizelow 是文件大小的 64 位值中的每个 32 位时，如果文件大小值大于 32 位，我们将 maxdword（在我的情况下为 0xffffffff）乘以 nfilesizehigh。第二种解决方案也不起作用，并且给了我比原来更小的尺寸。我再次尝试了这个：

```
ULONGLONG FileSize = (FindFileData.nFileSizeHigh * 4294967296) + FindFileData.nFileSizeLow; 
```

它奏效了。此外，我还使用了另一种解决方案来获取文件大小：

```
 ULONGLONG FileSize = FindFileData.nFileSizeHigh;
 FileSize <<= sizeof( FindFileData.nFileSizeHigh ) *8; 
 FileSize |= FindFileData.nFileSizeLow; 
```

上述解决方案也有效：

我想知道为什么前两个解决方案不起作用，如果可能的话，我还想知道最后一个解决方案的解释，因为我想知道代码的内部工作。帮助将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-04T20:41:00.690

使用`ULARGE_INTEGER`结构来组合值，而不是尝试手动计算/移动它们：

```
ULARGE_INTEGER ul;
ul.HighPart = p_findFileData->nFileSizeHigh;
ul.LowPart = p_findFileData->nFileSizeLow;
ULONGLONG FileSize = ul.QuadPart; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-04T19:23:23.723

我会使用：

```
ULONGLONG FileSize = (static_cast<ULONGLONG>(FindFileData.nFileSizeHigh) <<
                      sizeof(FindFileData.nFileSizeLow) *8) |
                     FindFileData.nFileSizeLow; 
```

在 32 位值进入 FileSize 变量之前，必须转换为 ULONGLONG 才能将 32 位值转换为 64 位值。

您当然也可以使用乘法 - 但它在任何特定方式上都不是“更好”，而且很可能会慢一点[在这种特殊情况下可能没什么大不了的，但我可以看到使用乘法没有任何好处.

现在对于“不工作”的变体：

即使这确实有效：

```
 (p_findFileData->nFileSizeHigh * MAXDWORD) + p_findFileData->nFileSizeLow); 
```

你会得到错误的值，因为`MAXDWORD`它小于 4GB，所以你最终会得到错误的值 [是的，它可能很接近，但它至少会错 1 个字节，可能更多]。但是，由于我们处理的是 32 位值，它实际上变成了：

```
 -p_findFileData->nFileSizeHigh + p_findFileData->nFileSizeLow; 
```

因为`MAXDWORD`与 -1 相同（是的，它很可能是一个无符号值，但如果你以这种方式使值溢出，它的行为与负符号值相同）。

这个在数学上是正确的，但由于它溢出了一个 32 位值，所以它不起作用。

```
 (p_findFileData->nFileSizeHigh * (MAXDWORD+1)) + p_findFileData->nFileSizeLow); 
```

所以你得到了`low part + (0 * high part)`当然是不正确的。

使用演员表，这将起作用：

```
 static_cast<ULONGLONG>(p_findFileData->nFileSizeHigh) * (MAXDWORD+1) +
 p_findFileData->nFileSizeLow; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-04T19:21:14.847

```
(p_findFileData->nFileSizeHigh * MAXDWORD) + p_findFileData->nFileSizeLow); 
```

这不会给出正确的结果，因为 MAXDWORD 是错误的值。

```
(p_findFileData->nFileSizeHigh * (MAXDWORD+1)) + p_findFileData->nFileSizeLow); 
```

这不起作用，因为您在将类型转换为足以容纳该值的大小之前向 MAXDWORD 添加了 +1。

```
(FindFileData.nFileSizeHigh * 4294967296) + FindFileData.nFileSizeLow; 
```

这是有效的，因为`4294967296`它是 64 位类型。

```
FileSize <<= sizeof( FindFileData.nFileSizeHigh ) *8; 
FileSize |= FindFileData.nFileSizeLow; 
```

这是有效的，因为您将高位移动 32（这与乘以 4294967296 相同），然后使用按位或“添加”低位。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-11-06T09:27:43.197

我遇到了完全相同的问题，对于我的代码来说答案非常简单。只需将 MAXDWORD 转换为 64 位 int（例如 uint64_t）。这背后的解释可以在我收到的答案中[找到](https://stackoverflow.com/questions/53152486/uint64-t-t3-maxdword-1-0)。

# javascript - Angularjs 指令未按预期工作

> ID：15209080
> 
> 赞同：0
> 
> 时间：2013-03-04T19:04:35.310
> 
> 标签：javascript, jquery, angularjs, angularjs-directive

我对 angularjs 很陌生，所以这听起来很简单。我想要完成的是最初在页面上显示一个图像和一个按钮。当用户单击按钮时，另一个图像也会出现在页面上。

这是我的html代码

```
 <div ng-app="test">
<hello>
    <pane>
    </pane>
</hello>
</div> 
```

我的角度 js 指令是

```
 angular.module('test', []).directive('hello', function() {
    return {
        restrict : 'E',
        template : '<div style="position: relative"><input name="Add" type="submit" ng-click="AddMarker()" ><img src="http://www.india-travelinfo.com/india-maps/india-map.jpg" /></div>',
        replace: true,
        link : function(scope, element, attrs) {
                 $("#mr").draggable();
        },
        controller: function($scope, $element) {
        var panes = $scope.panes = [];

        $scope.select = function(pane) {
          angular.forEach(panes, function(pane) {
            pane.selected = false;
          });
          pane.selected = true;
        }

        this.addPane = function(pane) {
          if (panes.length == 0) $scope.select(pane);
          panes.push(pane);
        }
      }
    };
}).
 directive('pane', function() {
    return {
      require: '^hello',
      restrict: 'E',
      transclude: true,
      scope: { title: '@' },
      link: function(scope, element, attrs, tabsCtrl) {
        tabsCtrl.addPane(scope);
      },
      template:
        '<img id="mr" class="drag-image" src="http://www.mbs.edu/i/gmap_marker_default.gif" style="position: absolute;" />',
      replace: true
    };
  }) 
```

任何人都可以指出这个指令可能有什么问题吗？这是一个[jsfiddle](http://jsfiddle.net/SfFub/1/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T20:53:28.617

实际上，我认为您对指令的了解太深了。您要构建的功能实际上只是直接的 Angular，不需要指令。试试这个（小提琴更新）：

```
<div ng-app="test" ng-controller="mapController">
    <div style="position: relative">
        <button name="Add" type="button" ng-click="showMarker = true">Show Marker</button>
        <img src="http://www.india-travelinfo.com/india-maps/india-map.jpg" />
        <img id="mr" ng-show="showMarker" class="drag-image" src="http://www.mbs.edu/i/gmap_marker_default.gif" style="position: absolute;" />
    </div> 
</div> 
```

控制器：

```
angular.module('test', [])
.controller('mapController', function ($scope) {

}) 
```

[http://jsfiddle.net/SfFub/3/](http://jsfiddle.net/SfFub/3/)

# c++ - 快速排序中的无限循环？

> ID：15209088
> 
> 赞同：0
> 
> 时间：2013-03-04T19:05:12.673
> 
> 标签：c++

当我运行这个程序时，我可以在输入数字时进入该阶段，但此后代码就停止了工作。

光标闪烁，但我不能做任何事情，也不能输入任何其他内容。如果代码有错误，请指出，或者如果有一般错误，请赐教。

```
#include<iostream>
using namespace std;
void sort(int *a, int o, int p, int r);
int main()
{

    int a[10],i,o=5,p=0,r=9;
    cout<<"Enter the elments \n";
    for(i=0; i<10; i++)
    {
             cin>>a[i];
    }       
    sort(a,o,p,r);
    cout<<"\n The Sorted Array is";
    for(int yy=0; yy<10; yy++)
    {
            cout<<a[yy]<<"\n";
    }
   system("PAUSE");
   return 0;
}
void sort(int *a, int o, int p, int r)
{
    int ii=0,kj=10,uu,uv,tmp;
    if(p<r)
    {
        while((ii<10)&&(kj>0)){
            while(ii<=o){
                ii++;
            }
            while(kj>=o){
                kj--;
            }
            if(ii<kj)
            {
                tmp=a[ii];
                a[ii] = a[kj];
                a[kj] = tmp;
            }
        }
        uu=(p+o)/2;
        uv=(r+o)/2;
        sort(a,uu,p,o);
        sort(a,uv,o,r);
    }               
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T19:24:09.867

为什么要在排序例程中比较索引？你不应该比较指数的*价值吗？*

你认为这应该做什么？

```
void sort(int *a, int o, int p, int r)
{                               // call in with o=5, p=0, r=9
    int ii=0,kj=10,uu,uv,tmp;   
    if(p<r)
    {
        while((ii<10)&&(kj>0)){
            while(ii<=o){
                ii++;
            }                  // ii is now 6
            while(kj>=o){
                kj--;
            }                  // kj is now 4
            if(ii<kj)          // NEVER true
            {
                tmp=a[ii];
                a[ii] = a[kj];
                a[kj] = tmp;
            }
        }                      // infinite loop 
```

同样重要的是，为什么要使用硬编码值 5 作为枢轴值？你为什么叫它`o`而不是`p`至少？var 的单字母名称**只有**在它们不言自明**或**用注释解释时才适用。

# javascript - 如何在 iPad 上自动选择文本输入字段？

> ID：15209090
> 
> 赞同：0
> 
> 时间：2013-03-04T19:05:14.363
> 
> 标签：javascript, ipad, input, focus

我需要一个文本输入字段，以便在页面打开后立即输入。我发现有几个这样的问题得到了解答，但似乎没有一个是特定于是否可以在 iPad 上进行的。

我正在使用这个 javascript：

```
window.onload = function(){
    var text_input = document.getElementById('barcode');
    text_input.focus ();
    text_input.select ();  
} 
```

我的输入HTML是这样的：

```
<input type="text" name="text" class="textinput" id="barcode"> 
```

当我在 Google Chrome 中测试网页时，它可以工作，但是当我在 iPad 上测试它时，它就不行了。我也尝试过 HTML5 自动对焦元素，但我听说它在 iPad 上也不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T20:34:35.143

我过去在 iPad 上遇到过类似的问题。

您可以尝试在按下按钮时运行您的代码，看看是否有效，如果有效，那么它可能与我遇到的问题相同，即 iPad 不允许自动运行的代码执行某些功能。

就我而言，我想开始播放 html 5 视频标签，但只能在按下按钮时这样做，而不是在页面加载时自动播放。

正如其他人建议的那样，尝试`alert()`在您的`window.onload`方法中添加一个，或尝试设置超时并在几毫秒后运行此代码。如果您可以验证您的代码实际上正在运行，那将是一个开始。

# .net - 绑定列表 当 DGV 具有特定列类型时到 Datagridview

> ID：15209093
> 
> 赞同：0
> 
> 时间：2013-03-04T19:05:17.953
> 
> 标签：.net, vb.net, winforms, datagridview

我正在尝试从列表中填充 DGV。Datagridview 是可编辑的，并指定了特定的列类型。即文本框、组合框、复选框。

如果我使用 DGV.Datasource = MyList ，它会将我的 T 的所有属性添加到指定列**之后的 DGV 中。**（*例如 Address1, County, City, ID, Address1, County, City*）

```
Addresses = New List(Of Address)

    Dim a1 = New Address(Guid.NewGuid())
    a1.Address1 = "Address 1"
    a1.County = "County Test"
    a1.City = "My City"

    Addresses.Add(a1)

    Dim a2 = New Address(Guid.NewGuid())
    a2.Address1 = "Address 1"
    a2.County = "County Test"
    a2.City = "My City"

    Addresses.Add(a2)

    Dim a3 = New Address(Guid.NewGuid())
    a3.Address1 = "Address 1"
    a3.County = "County Test"
    a3.City = "My City"

    Addresses.Add(a3)
    uxAddresses.DataSource = Addresses 
```

如果我循环遍历，如下所示，它将第一行设置为正常，但不是第 2 行或第 3 行（在我的测试对象中）。

```
Private Sub DataGridViewPaint(ByVal la As List(Of Address),
                              ByVal paramDgv As DataGridView)
    Dim intDr As Integer = 0

    For Each g In la
        paramDgv.Rows(intDr).Cells("ID").Value = g.Id
        paramDgv.Rows(intDr).Cells("Address1").Value = g.Address1
        paramDgv.Rows(intDr).Cells("County").Value = g.County
        paramDgv.Rows(intDr).Cells("City").Value = g.City
        intDr += 1
    Next
End Sub 
```

这让我想知道，完成此任务的正确方法是什么，因为我觉得我在这里遗漏了一些东西......谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:12:31.303

您可以尝试[`DataGridViewColumn.DataPropertyName`](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcolumn.datapropertyname.aspx)像这样使用该属性：

```
Column1.DataPropertyName = "Address1"
Column2.DataPropertyName = "County"
Column3.DataPropertyName = "City"
Column4.DataPropertyName = "ID" 
```

然后，设置`DGV.Datasource = MyList`.

附加说明：您需要设置每一列的`DataPropertyName`字段，否则您可能会得到重复的列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T19:13:08.287

您不必一次将列表添加到网格视图中的一行。您可以将整个列表绑定到网格视图，如下所示：

```
<asp:GridView ID="GridView1" runat="server" AllowSorting="False"
  AutoGenerateColumns="false" BackColor="White" 
  BorderWidth="2px" BorderStyle="Solid"
  CellPadding="4" ForeColor="#333333" GridLines="both" 
  EmptyDataText="No Log Messages">

     <HeaderStyle BackColor="#5D7B9D" Font-Bold="True" ForeColor="White" />
     <AlternatingRowStyle BackColor="White" ForeColor="#284775" />
     <RowStyle BackColor="#F7F6F3" ForeColor="#333333" />
     <Columns>                                  
       <asp:TemplateField Visible="false" ItemStyle-HorizontalAlign="Center" HeaderText="ID" HeaderStyle-ForeColor="white">
         <ItemTemplate>
            <asp:Label ID="lblId" runat="Server" Text=' <%#Eval("ID")%>' />
             </ItemTemplate>
        </asp:TemplateField>  
<asp:TemplateField Visible="false" ItemStyle-HorizontalAlign="Center" HeaderText="Address" HeaderStyle-ForeColor="white">
         <ItemTemplate>
            <asp:Label ID="lblAddress" runat="Server" Text=' <%#Eval("Address1")%>' />
             </ItemTemplate>
        </asp:TemplateField>                   
     </Columns>
 </asp:GridView> 
```

然后只需绑定源：

```
 Addresses = New List(Of Address)
'file the list

me.GridView1.dataSource = Addresses 
me.GridView1.DataBind() 
```

只需确保客户端 gridview: <%#Eval("Address1")%> 中的代码与对象列表中的属性名称匹配。

# android - EditText 如何同时拥有 singleLine="false" 和 imeOptions="actionNext"？

> ID：15209106
> 
> 赞同：6
> 
> 时间：2013-03-04T19:05:49.560
> 
> 标签：android, focus, android-edittext, android-softkeyboard, multiline

## 背景

假设您有多个 EditText 实例。

您希望能够使用键盘的下一个按钮（用作 ENTER 键的替代品）在它们之间切换。

每个 EditText 可能有很长的内容，可以显示在多行中（假设我希望将其限制为 3 行，如果文本仍然太长，请使用 ellipsize）。

## 问题

正如我所注意到的，TextView 和 EditText 都有非常奇怪的行为并且缺乏一些基本功能。其中之一是，如果您希望转到下一个视图，则需要为每个 EditText 实例设置一个 singleLine="true"。

## 我试过的

我尝试了下一个 xml 布局（和其他试验），但它不起作用：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
  xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent"
  android:layout_height="match_parent" android:orientation="vertical"
  android:gravity="center" tools:context=".MainActivity">

  <EditText android:id="@+id/editText1" android:layout_width="wrap_content"
    android:layout_height="wrap_content" android:nextFocusDown="@+id/editText2"
    android:singleLine="false" android:imeOptions="actionNext"
    android:maxLines="3" android:ellipsize="end"
    android:text="@string/very_long_text" />

  <EditText android:id="@+id/editText2" android:layout_width="wrap_content"
    android:layout_height="wrap_content" android:nextFocusDown="@+id/editText3"
    android:singleLine="false" android:imeOptions="actionNext"
    android:maxLines="3" android:ellipsize="end"
    android:text="@string/very_long_text" />

  <EditText android:id="@+id/editText3" android:layout_width="wrap_content"
    android:layout_height="wrap_content" android:singleLine="false"
    android:maxLines="3" android:ellipsize="end"
    android:text="@string/very_long_text"/>

</LinearLayout> 
```

我也尝试了下一个代码，但这确实是一个愚蠢的解决方案：

```
...
final EditText editText=(EditText)findViewById(R.id.editText1);
editText.setOnEditorActionListener(new OnEditorActionListener()
  {
    @Override
    public boolean onEditorAction(final TextView v,final int actionId,final KeyEvent event)
      {
      if(actionId==EditorInfo.IME_NULL)
        {
        final View view=findViewById(editText.getNextFocusDownId());
        if(view!=null)
          {
          view.requestFocus();
          return true;
          }
        }
      return false;
      }
  }); 
```

它有效，但由于以下原因，这是一个愚蠢的解决方案：

*   我需要为每个 EditText 设置此行为（或扩展 EditText 并在那里添加某种逻辑）。
*   它不显示软键盘中的键的“下一个”。相反，它显示 ENTER 键。
*   使用 XML 不允许我在最后设置椭圆大小，并且我不断得到滚动行为。

## 问题

有没有更好的方法来实现这一目标？一个优雅、有效并显示“下一个”键而不是 ENTER 键？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-21T20:28:28.310

对于这里的答案 - 如果需要，您可以同时设置它们。然而，强制它实际显示下一个并让回车键充当下一个键取决于键盘。我知道在 Swype，我们故意覆盖了任何多行文本字段，以始终显示回车键并充当换行符，并且从不显示下一个键。没有办法强制它像你想要的那样在所有键盘上工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-14T21:45:19.577

我发现这个问题类似于*Multi* [-line EditText with Done action button](https://stackoverflow.com/q/2986387/7550472) post。既然我已经为此写了一个答案，让我再放一次。不过，我只能回答你的*前 2 点*，因为我还没有使用*Ellipsize* （我认为一旦你**设置了**下**一个按钮**部分，它应该*相对容易*）。

 ****以下*Java 代码*可用于将键盘输入更改为“完成”/“下一步”按钮：

```
////////////Code to Hide SoftKeyboard on Enter (DONE) Press///////////////
editText1.setRawInputType(InputType.TYPE_CLASS_TEXT|InputType.TYPE_TEXT_VARIATION_VISIBLE_PASSWORD|InputType.TYPE_TEXT_FLAG_NO_SUGGESTIONS);
editText1.setImeActionLabel("DONE",EditorInfo.IME_ACTION_DONE);              //Set Return Carriage as "DONE"
editText1.setImeOptions(EditorInfo.IME_ACTION_DONE);

editText1.setOnEditorActionListener(new TextView.OnEditorActionListener() {
    @Override
    public boolean onEditorAction(TextView v, int actionId, KeyEvent event) 
    {
                if (event == null) {
                    if (actionId == EditorInfo.IME_ACTION_DONE) {
                        // Capture soft enters in a singleLine EditText that is the last EditText
                        // This one is useful for the new list case, when there are no existing ListItems
                        editText1.clearFocus();

                        editText2.requestFocus();       //Call the next Edit_Text into Focus  
                        //Comment above requestFocus() for edit_text3

                        //Hiding SoftKeyboard. Uncomment it for edit_text3
                        //InputMethodManager inputMethodManager = (InputMethodManager)  getActivity().getSystemService(Activity.INPUT_METHOD_SERVICE);
                        //inputMethodManager.hideSoftInputFromWindow(getActivity().getCurrentFocus().getWindowToken(), 0);

                    }

                    else if (actionId == EditorInfo.IME_ACTION_NEXT) {
                        // Capture soft enters in other singleLine EditTexts
                    } else if (actionId == EditorInfo.IME_ACTION_GO) {
                    } else {
                        // Let the system handle all other null KeyEvents
                        return false;
                    }
                } 
        else if (actionId == EditorInfo.IME_NULL) {
                    // Capture most soft enters in multi-line EditTexts and all hard enters;
                    // They supply a zero actionId and a valid keyEvent rather than
                    // a non-zero actionId and a null event like the previous cases.
                    if (event.getAction() == KeyEvent.ACTION_DOWN) {
                        // We capture the event when the key is first pressed.
                    } else {
                        // We consume the event when the key is released.
                        return true;
                    }
                } 
        else {
                    // We let the system handle it when the listener is triggered by something that
                    // wasn't an enter.
                    return false;
                }
                return true;
        }
}); 
```****

# sql - 甲骨文 10g。导入数据时为模式创建别名

> ID：15209107
> 
> 赞同：1
> 
> 时间：2013-03-04T19:05:55.037
> 
> 标签：sql, oracle, plsql, oracle10g, dbeaver

我有一个带有 Oracle 11 的产品盒和一个名为`A`. 出于测试目的，我需要产品数据的本地快照。数据不是很大，所以导出不是问题。我已经导出`A`到一组 SQL 文件（使用 DBeaver），每个表一个，内容如下：

```
INSERT INTO A.TABLE1 (F1, F2, F3) VALUES ('v11', 'v21', 'v31');
INSERT INTO A.TABLE1 (F1, F2, F3) VALUES ('v12', 'v22', 'v32'); 
```

等等。问题是，出于开发目的，我使用名为 schema 的模式`B`，所以在导入时我需要这样的插入：

```
INSERT INTO B.TABLE1 (F1, F2, F3) VALUES ('v11', 'v21', 'v31');
INSERT INTO B.TABLE1 (F1, F2, F3) VALUES ('v12', 'v22', 'v32'); 
```

我知道我可以找到并替换所有内容`INSERT INTO A.`，`INSERT INTO B.`这将解决我的问题，但也许我可以为模式创建某种别名，`B`这样我就可以这样做（伪代码）：

```
CREATE ALIAS 'A' FOR SCHEMA 'B'
@TABLE1.sql
@TABLE2.sql
DELETE ALIAS 'A' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T06:46:03.057

编写完全没有架构名称的脚本。或者，如果它是由一些愚蠢的工具生成的，则编辑它的模式名称:)

在您的驱动程序脚本中，`ALTER SESSION SET CURRENT_SCHEMA x`在调用插入脚本之前运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T19:12:36.990

您不能创建将一个架构映射到另一个架构的别名。

*   您可能会导致生成脚本的工具完全省略模式名称。然后你可以`INSERT`在你想要的任何模式中运行语句
*   你可以使用不同的工具。例如，Oracle 导出和导入实用程序（经典或 DataPump）具有允许您从一种模式映射到另一种模式的参数。

然而，我强烈质疑使用与生产中不同的模式名称进行开发的智慧。这大大增加了诸如推广代码之类的事情的复杂性。某人（或某些工具）会无意中将模式前缀添加到查询中的表名中。在将脚本从一种环境升级到另一种环境之前，您必须手动编辑脚本，并且最终有人会在升级过程中犯错误并更改代码的功能。

# spring - 如果我使用 Spring External log4j.properties 文件，如何获取启动序列的日志？

> ID：15209111
> 
> 赞同：1
> 
> 时间：2013-03-04T19:06:04.247
> 
> 标签：spring, properties, log4j, external

所以问题是这个应用程序的启动顺序很重要，因为它需要在第一次启动时从数据库中获取一些信息。如果我在 web.xml 文件中使用它：

```
<context-param>
    <param-name>log4jConfigLocation</param-name>
    <param-value>classpath:log4j.applicationName.properties</param-value>
</context-param>
<context-param>
    <param-name>log4jRefreshInterval</param-name>
    <param-value>10000</param-value>
</context-param>
<listener>
    <listener-class>org.springframework.web.util.Log4jConfigListener</listener-class>
</listener> 
```

上面的问题是它需要 Spring 10000... 毫秒？..so 然后 10 秒加载属性文件，我在日志中看不到任何启动顺序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T19:50:21.377

是的。它必须出现在上下文加载侦听器之前。

# python - Python - 创建一个使用 threading.lock() 锁定对象的类

> ID：15209113
> 
> 赞同：2
> 
> 时间：2013-03-04T19:06:09.337
> 
> 标签：python, multithreading, locking

尝试创建一个可以使用 threading.lock 锁定对象的类：

```
class ObjectLock(object):
    def __init__(self):
        self._lock = threading.Lock()
        self._value = False
    def __str__(self):
        self.acquire() 
        try: 
            if(self._value):
                return self._value
            else:
                return self._value
        finally: 
            self.release() 
    def __enter__(self):
        self.acquire()
    def __exit__(self, type, value, traceback):
        self.release()
    def acquire(self):   
        self._lock.acquire()
    def release(self):
        self._lock.release() 
    def locked(self):
        return self._lock.locked()

lock = ObjectLock()

print(lock)
with lock:
    print (lock) 
```

问题是我正在尝试实施“with”。如果在“with”块中调用方法（例如**str**，则重新获取锁......这很糟糕。当我知道我在锁中工作时，我是否必须创建一组单独的方法来调用?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:10:28.383

首先，我不明白为什么`__str__`需要获取锁，所以我认为前提是没有实际意义的。

如果您确定内部锁定是可取的，请考虑使用可重入锁，例如[`threading.RLock`](http://docs.python.org/2/library/threading.html#threading.RLock). 这样，单个线程将能够根据需要多次获取锁而不会死锁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T19:10:56.277

而不是使用`threading.Lock`，使用[`threading.Rlock`](http://docs.python.org/2/library/threading.html#rlock-objects)。这是一个可重入锁，它允许同一个线程多次获取锁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T19:10:44.080

使用可重入锁（threading.RLock）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T19:20:47.413

> 当我知道自己在锁中工作时，是否必须创建一组单独的方法来调用？

不，这已经为您完成了。类`threading.RLock`（可重入锁）会为您处理这个问题，它实现与`Lock`.

这个`R`角色会神奇地挥舞你的问题。

# matlab - 未应用图像处理过滤器

> ID：15209120
> 
> 赞同：0
> 
> 时间：2013-03-04T19:06:25.437
> 
> 标签：matlab, image-processing

我正在研究某人的代码，该代码会删除除所选颜色之外的所有颜色。如果要替换代码示例中的下一行，它将尝试将除红色之外的所有内容都涂成黑色

> nonRedIndex = (hPlane > 20) & (hPlane < 340);

但是，我发现其他 diaposons 不起作用。你能告诉我为什么吗？

```
cdata = imread(path);
hsvImage1 = rgb2hsv(cdata);         %# Convert the image to HSV space
hPlane = 360.*hsvImage1(:,:,1);     %# Get the hue plane scaled from 0 to 360
sPlane = hsvImage1(:,:,2);          %# Get the saturation plane
lPlane = hsvImage1(:,:,3); 
nonRedIndex = (hPlane > 140) & ...  %# Select "non-red" pixels
              (hPlane < 120);
sPlane(nonRedIndex) = 0;           %# Set the selected pixel saturations to 0
lPlane(nonRedIndex) = 0;
hsvImage1(:,:,2) = sPlane;          %# Update the saturation plane
hsvImage1(:,:,3) = lPlane;

rgbImage1 = hsv2rgb(hsvImage1); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T10:47:27.007

有一个错误的逻辑连接 - hPlane 元素必须大于 140 并且同时小于 120。这应该有效：

```
nonRedIndex = (hPlane < 140) & (hPlane > 120); 
```

# html - 使用 Visual Studio Web Developer 构建常规 html 网站？

> ID：15209121
> 
> 赞同：1
> 
> 时间：2013-03-04T19:06:30.357
> 
> 标签：html, visual-studio, web, ide

我想知道使用 VS 作为 IDE 来构建一个使用 CSS 和 Javascript 而不使用 ASP.NET 的常规 HTML 网站是否是个好主意。这主要是因为我已经习惯了 VS 及其提供的便利。

我计划使用 aspx 文件构建一个“主项目”，并在准备好部署后创建单独的 html 文件。html 文件将从我的测试环境中的浏览器接收到的内容生成。

我尝试过 Aptana Studio 和 Dreamweaver，它们都非常好，但我想用一个 IDE 尽可能地集中化。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:14:30.747

我认为为项目选择 IDE 完全取决于开发人员以及他/她对它的熟悉程度。

对于您的情况，我认为您应该使用 vs，因为首先您熟悉它（并且可能知道热键），第二个 vs 在我看来是所有其他可用于 html 的 IDE 中最好的 IDE，适用于任何想要使用其智能感知的人如果您使用 vs 2012 for microsoft 为 html 构建一个非常好的 ide 并在 2012 版本中使用它，它将比任何其他 ide 提出更多建议。我 mysqlf 通常使用 notepad++ ，但在您的情况下，我建议使用 2012。

# java - Java Swing 文本字段错误

> ID：15209128
> 
> 赞同：1
> 
> 时间：2013-03-04T19:07:02.500
> 
> 标签：java, swing, textfield

我是 Java 和 Java Swing 的新手，我无法让它工作。我有 2 个文本字段，textfield1 中的文本需要通过单击按钮传递到 te textfield2，但它不断崩溃。

这是代码：

```
package javaapplication7;

import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.*;

public class JavaApplication7 {

    public static void main(String[] args) {
        JFrame theFrame = new JFrame();
        theFrame.setTitle("Title");
        theFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        theFrame.setSize(400, 400);
        theFrame.setLocation(400, 400);

        theFrame.setContentPane(new Paneel());
        theFrame.setVisible(true);
    }
}

class Paneel extends JPanel{
            JButton button1;
            JTextField field1;
            JTextField field2;

    public Paneel(){
            JButton button1 = new JButton("Click");
            button1.addActionListener(new KH());
            add(button1);

            JTextField field1 = new JTextField(10);
            add(field1);

            JTextField field2 = new JTextField(10);
            add(field2);
    }

    class KH implements ActionListener{
        @Override
        public void actionPerformed(ActionEvent e){
            field2.setText(field1.getText());
        }
    }
} 
```

当我运行它时，它给出了一个巨大的错误列表，有人知道吗？

错误列表：

```
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
    at javaapplication7.Paneel$KH.actionPerformed(JavaApplication7.java:54)
    at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:2018)
    at javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2341)
    at javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel.java:402)
    at javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:259)
    at javax.swing.plaf.basic.BasicButtonListener.mouseReleased(BasicButtonListener.java:252)
    at java.awt.Component.processMouseEvent(Component.java:6505)
    at javax.swing.JComponent.processMouseEvent(JComponent.java:3321)
    at java.awt.Component.processEvent(Component.java:6270)
    at java.awt.Container.processEvent(Container.java:2229)
    at java.awt.Component.dispatchEventImpl(Component.java:4861)
    at java.awt.Container.dispatchEventImpl(Container.java:2287)
    at java.awt.Component.dispatchEvent(Component.java:4687)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:4832)
    at java.awt.LightweightDispatcher.processMouseEvent(Container.java:4492)
    at java.awt.LightweightDispatcher.dispatchEvent(Container.java:4422)
    at java.awt.Container.dispatchEventImpl(Container.java:2273)
    at java.awt.Window.dispatchEventImpl(Window.java:2719)
    at java.awt.Component.dispatchEvent(Component.java:4687)
    at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:729)
    at java.awt.EventQueue.access$200(EventQueue.java:103)
    at java.awt.EventQueue$3.run(EventQueue.java:688)
    at java.awt.EventQueue$3.run(EventQueue.java:686)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:87)
    at java.awt.EventQueue$4.run(EventQueue.java:702)
    at java.awt.EventQueue$4.run(EventQueue.java:700)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:699)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:242)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:161)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:150)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:146)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:138)
    at java.awt.EventDispatchThread.run(EventDispatchThread.java:91) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T19:11:36.917

您当前正在*隐藏**变量*, `button1`, `field1`in `field2`，即`Paneel`您正在.*`Paneel``null``NPE`*

 *通过删除`JButton`and `JTextField`type 关键字，您可以将组件分配给预期的类成员变量：

```
public Paneel(){
   button1 = new JButton("Click");
   ...
   field1 = new JTextField(10);
   ...
   field2 = new JTextField(10);
   ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T19:11:16.587

您在构造函数中声明新的本地“button1”、“field1”和“field2”变量，而不是初始化实例变量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-04T19:18:15.100

确实将此代码用于 Panel 构造函数。

```
 public Paneel(){
        JButton button1 = new JButton("Click");
        button1.addActionListener(new KH());
        add(button1);

        field1 = new JTextField(10);
        add(field1);

        field2 = new JTextField(10);
        add(field2);
       } 
```

`field1`并且`field2`您在构造函数中创建的对于构造函数来说是本地的。类的成员字段 (`field1`和`field2`)`Paneel`仍然为空。所以在`actionPerformed`里面扔`NullPointerException`。*

# ruby-on-rails - 如何使用自定义时区的时间预填充 datetime_select？

> ID：15209130
> 
> 赞同：3
> 
> 时间：2013-03-04T19:07:08.650
> 
> 标签：ruby-on-rails, controller, ruby-on-rails-3.2, timezone, edit

我有可以在**不同时区的****事件**。

 ****编辑**后，我希望时间和日期与该事件的时区一起显示。

但是，当我点击**edit**时，`datetime_select`总是显示用户时区的时间（而不是事件的时间）。

**例子：**

*   活动于上午 10 点在阿姆斯特丹 (GMT+1) 开始
*   用户时区配置为伦敦 (GMT+0)

结果：*在编辑时，事件时间被错误地预设为上午 9 点*

**代码片段：**

```
def edit
  Time.zone = @event.time_zone
  @event.beginn = @event.beginn.in_time_zone
  @event.endd = @event.endd.in_time_zone

  # [...]
end 
```

请注意，**@event.time_zone**包含所需的时区（上例中的“Amsterdam”）。

**如何`datetime_select`在编辑时预设相应区域中的事件时间？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T02:04:50.050

正如**pixeltrix**在错误报告的线程中指出的那样，覆盖相关属性的读取器/获取器会更干净，如下所示：

```
# in event model

def beginn
  super.in_time_zone(time_zone) if super
end

def endd
    super.in_time_zone(time_zone) if super
end 
```

这样可以省略问题中概述的**编辑操作**中的逻辑，并避免与依赖**Time.zone**的其他部分的干扰。**

# c# - 使用资源文件是否有与 oracle 等效的查询 sql？

> ID：15209135
> 
> 赞同：0
> 
> 时间：2013-03-04T19:07:35.873
> 
> 标签：c#, asp.net, oracle, resources

**sql查询到资源文件**

我开始与 Oracle 合作，我需要知道这个解决方案是否可以应用于 Oracle 查询。

**SQL 版本**

**资源：从 mytable order by** **{0}** **{1}** 中选择 value1、value2、value3

 ****代码：**

```
 using (SqlCommand cm = new SqlCommand((contactId == 0 ? String.Format(Resource.SqlScripts.List, **orderByField**, **orderByDirection**)
 { 
```

. . .

是否有使用资源查询的等效 Oracle 查询？**

# javascript - 如何计算 JSON 数组元素的长度

> ID：15209136
> 
> 赞同：57
> 
> 时间：2013-03-04T19:07:39.480
> 
> 标签：javascript, jquery

我正在尝试计算 JSON 数组元素的长度。我知道使用 . 来计算数组的长度`json.array.length`。那就是需要找出每个索引中有多少项。

如果我的数组是：

```
{
  "shareInfo": [{
      "id": "1",
      "a": "sss",
      "b": "sss",
      "question": "whi?"
    },
    {
      "id": "2",
      "a": "sss",
      "b": "sss",
      "question": "whi?"
    },
    {
      "id": "3",
      "a": "sss",
      "b": "sss",
      "question": "whi?"
    },
    {
      "id": "4",
      "a": "sss",
      "b": "sss",
      "question": "whi?"
    }
  ]
} 
```

然后我需要找到 的长度`{"id":"1","a":"sss","b":"sss","question":"whi?"}`。其中有四项。我试过这个`data.shareInfo[i].length`。但它会产生错误。

请任何人告诉我如何找到长度....谢谢....

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2013-03-04T19:35:32.580

在回答之前阅读本[文档](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/keys)一次。那你就清楚的明白答案了。

试试这个它可能对你有用。

```
Object.keys(data.shareInfo[i]).length 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-03-04T19:10:06.153

首先，如果您正在处理的对象是一个字符串，那么您需要解析它然后找出键的长度：

```
obj = JSON.parse(jsonString);
shareInfoLen = Object.keys(obj.shareInfo[0]).length; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T19:40:38.290

首先，没有 JSON 对象之类的东西。JSON 是一种字符串格式，可用作 Javascript 对象文字的表示。

由于 JSON 是一个字符串，Javascript 会将它视为一个字符串，而不是一个对象（或数组或任何你试图使用它的东西。）

这是一个很好的 JSON 参考来阐明这种差异：

[http://benalman.com/news/2010/03/theres-no-such-thing-as-a-json/](http://benalman.com/news/2010/03/theres-no-such-thing-as-a-json/)

因此，如果您需要完成问题中提到的任务，则必须将 JSON 字符串转换为对象或将其作为字符串处理，而不是作为 JSON 数组处理。有几个库可以做到这一点。查看[http://www.json.org/js.html](http://www.json.org/js.html)以获取参考。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T19:23:46.223

我觉得你应该试试

```
data = {"shareInfo":[{"id":"1","a":"sss","b":"sss","question":"whi?"},
{"id":"2","a":"sss","b":"sss","question":"whi?"},
{"id":"3","a":"sss","b":"sss","question":"whi?"},
{"id":"4","a":"sss","b":"sss","question":"whi?"}]};

ShareInfoLength = data.shareInfo.length;
alert(ShareInfoLength);
for(var i=0; i<ShareInfoLength; i++)
{
alert(Object.keys(data.shareInfo[i]).length);
} 
```

# c# - C# Seeding StaticRandom in parallel.for 以获得可重现的序列

> ID：15209137
> 
> 赞同：3
> 
> 时间：2013-03-04T19:07:42.037
> 
> 标签：c#, multithreading, random, seed

我正在开发一个需要在 parallel.for 循环中使用随机数的 C# 项目。为此，我使用 Jon Skeet 的 MiscUtil 中的 StaticRandom 类。

对于测试，我希望能够重现我的结果。因此，我尝试播种底层 System.Random 以在每次测试运行时获得相同的序列。然而，即使有了种子，我每次都会得到不同的结果。在常规的 for 循环中，每次都输出相同的序列。下面有重现我的问题的代码（您必须使用机器的输出更新预期的序列）。

有没有办法播种 Random 以便我可以在 parallel.for 循环中获得可重现的序列？

```
 [TestMethod]
    public void MultiThreadedSeededRandom()
    {
        var actual = new ConcurrentBag<int>();
        Parallel.For(0, 10, i =>
        {
            actual.Add(StaticRandom.Next(1000));
        });

        WriteActualToOutput(actual);

        var expected = new int[] { 743, 51, 847, 682, 368, 959, 245, 849, 192, 440, };

        Assert.IsTrue(AreEqual(expected, actual.ToArray()));
    }

    public static bool AreEqual<T>(T[] expected, T[] actual)
    {
        if (expected.Length != actual.Length)
            return false;

        for (int i = 0; i < expected.Length; i++)
        {
            if (!expected[i].Equals(actual[i]))
                return false;
        }
        return true;
    }

    private static void WriteActualToOutput(ConcurrentBag<int> acual)
    {
        var result = string.Empty;
        result += "new int[] {";
        foreach (var value in acual)
        {
            result += value.ToString() + ",";
        }
        result += "};";

        Trace.WriteLine(result);
    }

    public static class StaticRandom
    {
        private static Random random = new Random(1231241);
        private static object myLock = new object();

        public static int Next(int max)
        {
            object obj;
            Monitor.Enter(obj = StaticRandom.myLock);
            int result;
            try
            {
                result = StaticRandom.random.Next(max);
            }
            finally
            {
                Monitor.Exit(obj);
            }
            return result;
        }
    } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-04T19:15:20.730

当您使用`Parallel.For`时，按照设计，您将获得不按顺序排列的结果，因为每次迭代将以非确定性的方式并行运行。如果您需要相同的“随机”数字序列，则需要以`Random.Next()`可靠的顺序调用。这不适用于多个线程。

与其尝试使用`Parallel.For`填充随机数，不如考虑提前生成“随机”数序列，然后`Parallel.For`在事后根据这些数进行处理。这样，您将始终以正确的顺序生成数字，这将保留顺序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-01T21:19:39.353

在单独的注释中，如果您从未使用过它，您可以在输出方法中使用 StringBuilder 的效率：

```
private static void WriteToArrayString(ICollection items)
    {
        var result = new StringBuilder("new []{");

        var index = 0;
        foreach(var value in items)
        {
            if (index == (items.Count - 1))
            {
                result.Append(string.Concat(value));
                index++;
                continue;
            }
            result.Append(string.Concat(value, ','));
            index++;
        }
        result.Append("};");

        Trace.WriteLine(result.ToString());
    } 
```

# java - Android Jellybean Activity 生命周期错误

> ID：15209138
> 
> 赞同：3
> 
> 时间：2013-03-04T19:07:42.550
> 
> 标签：java, android, android-4.2-jelly-bean, activity-lifecycle

我的问题仅在我锁定屏幕时出现并且仅在 Jellybean 4.1.2 和 4.2.2 中出现。在 Galaxy mini 和 HTC 上测试。两者都是氰mod。问题是当我锁定它时，它会调用 onPause 然后 onResume 然后再次 onPause 。当我解锁它时，它不会调用任何事件。当我按下主页并返回时，它表现正常。我还在 2.3.5 (Gingerbread) 上进行了测试，它运行良好。这怎么可能？

我认为这是 android 操作系统或 rom 中的错误，但我也认为可以找到解决方法。

如果可以的话，请给我一个答案。

```
03-04 20:14:30.844: D/dalvikvm(24688): Late-enabling CheckJNI
03-04 20:14:30.994: E/Trace(24688): error opening trace file: No such file or directory (2)
03-04 20:14:31.404: D/libEGL(24688): loaded /system/lib/egl/libEGL_adreno200.so
03-04 20:14:31.414: D/libEGL(24688): loaded /system/lib/egl/libGLESv1_CM_adreno200.so
03-04 20:14:31.414: D/libEGL(24688): loaded /system/lib/egl/libGLESv2_adreno200.so
03-04 20:14:31.424: I/Adreno200-EGL(24688): <qeglDrvAPI_eglInitialize:294>: EGL 1.4 QUALCOMM build: AU_LINUX_ANDROID_JB.04.01.01.00.036_msm8960_JB_CL2644550_release_AU (CL2644550)
03-04 20:14:31.424: I/Adreno200-EGL(24688): Build Date: 07/31/12 Tue
03-04 20:14:31.424: I/Adreno200-EGL(24688): Local Branch: 
03-04 20:14:31.424: I/Adreno200-EGL(24688): Remote Branch: quic/master
03-04 20:14:31.424: I/Adreno200-EGL(24688): Local Patches: NONE
03-04 20:14:31.424: I/Adreno200-EGL(24688): Reconstruct Branch: AU_LINUX_ANDROID_JB.04.01.01.00.036 +  NOTHING
03-04 20:14:31.464: D/OpenGLRenderer(24688): Enabling debug mode 0 <- ENTERED THE APP
03-04 20:14:33.564: D/Weird Error(24688): Resumed
03-04 20:14:33.714: D/Weird Error(24688): Created
03-04 20:14:43.044: D/Weird Error(24688): Paused <- LOCKED THE SCREEN
03-04 20:14:43.244: W/IInputConnectionWrapper(24688): beginBatchEdit on inactive InputConnection
03-04 20:14:43.244: W/IInputConnectionWrapper(24688): endBatchEdit on inactive InputConnection
03-04 20:14:43.394: D/Weird Error(24688): Resumed
03-04 20:14:43.394: D/Weird Error(24688): Paused
03-04 20:16:31.294: I/dalvikvm(24688): threadid=3: reacting to signal 3
03-04 20:16:31.344: I/dalvikvm(24688): Wrote stack traces to '/data/anr/traces.txt'
03-04 20:16:38.054: E/Trace(24767): error opening trace file: No such file or directory (2)
03-04 20:16:38.384: D/libEGL(24767): loaded /system/lib/egl/libEGL_adreno200.so <- I GUESS UNLOCKED IT BUT NOTHING PROVES IT
03-04 20:16:38.384: D/libEGL(24767): loaded /system/lib/egl/libGLESv1_CM_adreno200.so
03-04 20:16:38.394: D/libEGL(24767): loaded /system/lib/egl/libGLESv2_adreno200.so
03-04 20:16:38.394: I/Adreno200-EGL(24767): <qeglDrvAPI_eglInitialize:294>: EGL 1.4 QUALCOMM build: AU_LINUX_ANDROID_JB.04.01.01.00.036_msm8960_JB_CL2644550_release_AU (CL2644550)
03-04 20:16:38.394: I/Adreno200-EGL(24767): Build Date: 07/31/12 Tue
03-04 20:16:38.394: I/Adreno200-EGL(24767): Local Branch: 
03-04 20:16:38.394: I/Adreno200-EGL(24767): Remote Branch: quic/master
03-04 20:16:38.394: I/Adreno200-EGL(24767): Local Patches: NONE
03-04 20:16:38.394: I/Adreno200-EGL(24767): Reconstruct Branch: AU_LINUX_ANDROID_JB.04.01.01.00.036 +  NOTHING
03-04 20:16:38.434: D/OpenGLRenderer(24767): Enabling debug mode 0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T19:54:54.377

我找到了！

我改变了这个：

```
android:configChanges="orientation" 
```

对此：

```
android:configChanges="keyboardHidden|orientation|screenSize" 
```

我会留下这个问题，以便其他遇到相同问题的人可以找到答案。

# macos - mac os x 10.7.3 lion vbox guest 上的JDK/JRE 7，libjvm.dylib 插件错误

> ID：15209139
> 
> 赞同：1
> 
> 时间：2013-03-04T19:07:48.573
> 
> 标签：macos, java, virtualbox

在我的 mac os x virtualbox 客户机上启动基于 swing/awt 的 Java 应用程序时，我遇到了 libjvm.dylib 崩溃。我不确定为什么会这样。我能够在来宾上安装jdk，`java -version java version "1.7.0_15" Java(TM) SE Runtime Environment (build 1.7.0_15-b03) Java HotSpot(TM) 64-Bit Server VM (build 23.7-b01, mixed mode)`

这是我尝试打开 Java 控制面板时的日志。 [http://pastebin.com/vHFWKeEk](http://pastebin.com/vHFWKeEk)

`host specs: AMD Athlon(tm) 7750 3072MB RAM ATI Radeon HD 5550`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-21T09:04:36.787

此错误的原因是存在兼容性问题，导致 Java 7 运行时无法在缺乏硬件加速 OpenGL 支持的 OS X 平台上启动，包括在 Fusion 和 ESXi 上运行的 OS X VMware 虚拟机。这同样适用于 Virtualbox。

[在这里，您可以找到解决该问题的二进制补丁。](http://communities.vmware.com/docs/DOC-22830)但请注意，提供的补丁只修复了浏览器插件的上述错误！如果您想将 JRE/JDK 用于开发目的或在 Mac OSX 来宾系统中运行 SWT/AWT 应用程序，请使用以下脚本：

[VMware-Java7-patch.py](http://nicolas.baumgardt.ch/macosx/VMware-Java7-patch.py)

如果您安装了当前 JDK/JRE 7 Update 21 以外的其他版本，请编辑 Python 脚本的倒数第二行以指向您当前的 JDK 版本（将 jdk1.7.0_21.jdk 更改为您当前安装的任何版本/目录你的系统）：

patchLibLwAwt("/Library/Java/JavaVirtualMachines/jdk1.7.0_21.jdk/Contents/Home/jre/lib/lwawt/liblwawt.dylib")

最后通过在终端/控制台中键入“sudo python ./VMware-Java7-patch.py​​”来运行脚本。

这应该可以解决问题，Java 应用程序现在应该可以毫无问题地运行，无需重新启动系统。此补丁适用于 VMWare 和 Virtualbox。

此致。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-21T07:00:16.133

如果您的错误与 JVM 有关，您尚未安装 JVM，或者 JVM 缺少路径，

JDK和JRE的文件结构[`link`](http://download.virtualbox.org/jdk6/archive/b104/docs/technotes/tools/windows/jdkfiles.html)

这将表明如果您没有安装 JVM，那么您没有安装 libjvm.dylib 文件。

我仍然不确定这是主要原因，但这可能是原因之一。

还请检查路径，并阅读此内容[`old post`](https://stackoverflow.com/questions/2030434/eclipse-no-java-jre-jdk-no-virtual-machine)

这篇文章指出“您可以在 Eclipse 中仅注册一个 JRE，因为它足以运行您的程序，但 JVM 将允许更多操作。”

因此，如果 swing/awt 是高级的并且依赖于 jvm，就像在 eclipse 的旧帖子中一样。

我不是高级 Java 用户，所以不精通 AWT/SWING.. :)

但我还想补充一件事，它有内存过量使用选项，你必须禁用它，因为这会导致问题，对于崩溃，[`link1`](http://opsmonkey.blogspot.in/2007/01/linux-memory-overcommit.html)请阅读此博客了解详细信息。我在这里找到了这个细节[`link2`](https://forums.oracle.com/forums/thread.jspa?threadID=1557245&tstart=405)

我希望这会做:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-22T18:11:57.577

我正在运行相同的配置，我的虚拟机非常慢。我有一个采用 VT-x 技术（英特尔虚拟化技术）的英特尔 i7 处理器。AMD 有一个类似的功能称为 AMD-v。如果可用，请务必在 BIOS 中激活该功能 - 它可以显着提升性能。

# php - 在 PHPUnit 中测试包含或本地文件

> ID：15209147
> 
> 赞同：3
> 
> 时间：2013-03-04T19:08:38.980
> 
> 标签：php, unit-testing, dependency-injection, phpunit, dataprovider

我在一个类中有一个简单的方法，它执行以下操作

```
 class ToBeTested
 {
      public function getLocalSettings()
      {
          require_once 'local.php';

           return (isset($configSetting['foo'])) ? true : false;
      }
 } 
```

在 local.php 中

```
 <?
      $configSetting = array(
           'foo' => '1',
           'bar' => 'false',
      ); 
```

我正在寻找为 getLocalSettings 创建单元测试。我意识到这有点像依赖注入，但我不能完全理解我应该如何编写测试。测试变得过于复杂似乎是一个非常简单的代码块，但我可以自由地在这里重构，我想用我自己的值/数据提供者替换“local.php”以进行测试

**编辑清晰度/评论**

我在这里使用了一个配置作为示例，但我们实际使用的是一个巨大的文件，该文件从数据库输出并作为数据源包含在内，并在此函数中进行解析。我编写了它的简化版本以避免问题过于复杂，但包含的数组是几个兆，而不是实际上“只是一个配置文件”。不幸的是，在处理文件配置时提供不同方法的解决方案没有帮助，但是注入这个数组的方法可以正常工作（但在某些时候我需要运行那个'require'。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T19:29:56.467

`ToBeTested`您应该通过构造函数或设置器将配置数组注入到类中。这将消除由（包含另一个文件）引起的副作用`getLocalSettings`，并允许您在测试时模拟设置。您的类定义可能如下所示：

```
class ToBeTested
{
    private $localSettings;

    public function __construct($localSettings)
    { 
        $this->localSettings = $localSettings;
    }
} 
```

然后，当通过正常使用实例化此类时，您只需将配置数组提供给构造函数（`local.php`应该在引导代码中包含）。当你想对类进行单元测试时，你可以在实例化它时注入任何你需要的设置，并且你对文件系统没有硬依赖。为此，您可以选择使用 PHPUnit（[文档](http://www.phpunit.de/manual/current/en/writing-tests-for-phpunit.html)）中的数据提供程序功能。

# css - 元素如何在窗口调整大小时选择缩小到哪个角落？

> ID：15209148
> 
> 赞同：0
> 
> 时间：2013-03-04T19:08:43.643
> 
> 标签：css, resize

当我调整浏览器窗口的大小时，图像会缩小（应该如此），但会在其 div 内向上和向左缩小。是什么决定了它收缩的方向，我可以选择吗？

示例在这里：[http](http://cdpn.io/FdIKv) ://cdpn.io/FdIKv （缩小页面查看）

如何使文本缩小而不是重叠/被重叠的奖励。

谢谢！

编辑：抱歉，这里是代码：

```
<style type="text/css">
#logo-div {
    max-width: 24%;
    width: 24%;
    height: auto;
    clear: both;
    z-index: 0;
    float: right;
    overflow: hidden;
}

#site-logo {
    max-width: 100%;
   display : block;
   margin : 0 auto;
    }

#site-title a {
    color: #CB2027;
    font-size: 2.7em;
    margin-right: auto;
    position: relative;
    overflow: hidden;
}

#site-title {
    margin-right: auto;
    width: 80%;
    position: relative;
    overflow: hidden;
}

#site-description {
    color: #000000;
    font-size: 2.340em;
    position: relative;
    overflow: hidden;
    width: 76%;

}

#branding hgroup {
    max-width: 60%;
float: left;
width: 60%;
}

</style>
<header id="branding" role="banner">
<!--<div id="logo-and-hgroup">-->
<div id="logo-div"><img id="site-logo" src="http://farm6.staticflickr.com/5016/5421726832_eb5c0e25fc_m.jpg" alt="" /> </div>
    <hgroup>

<h1 id="site-title">
<a href="http://google.com/" title="Thisisone ATest" rel="home">Thisisone ATest</a>
</h1>
                <h2 id="site-description">This is where the description will go</h2>

            </hgroup> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:42:14.910

*默认情况下*，所有内容都会向左上角缩小。向顶部收缩是因为大多数人类书写系统是从上向下运行的——这是公认的普遍惯例。从左到右更具争议性——有许多从右到左的数字书写格式（例如阿拉伯语），可以使用 CSS`{direction: rtl}`或 HTML 属性指定`dir="rtl"`。

所以默认情况下，所有内容都从左上角开始，向右延伸，当不可用时返回到下面的下一个可用空间。默认情况下，一个`display: block`元素（如 a `div`）将占据它可用的全部宽度——这意味着，如果没有任何额外的 CSS，以下内容将出现在它的下方。

但是，您的代码指定`#logo-div`包含您的 image 的that`#site-logo`应该`float: right`——这意味着它将拥抱其容器的右侧边缘（`#branding`标题，如所讨论的那样占据整个可用宽度）。默认情况下，浮动元素会缩小它们的宽度以适应它们的内容，但它也有一个设置为百分比的宽度，这意味着它会根据可用的宽度缩小或扩大。

您不能`float`向上或向下 - 只能向左和向右 - 但您可以使用`position: absolute`to define `bottom: 0`，这将强制其底部边缘与最近的相对定位的祖先（在本例中为视口）的底部边缘相匹配。但是，就像当你指定一个浮点数时，一个块会忽略它的自然全角，向下序列位置，绝对定位意味着浮点数被忽略（你也可以设置左值和右值）。

为您创建[了一个演示](http://codepen.io/anon/pen/qyGtf)，其中一些属性应用于探索差异。

# c++ - 错误：'in >> *(arr + ((long unsigned int)(((long unsigned int)i) * 8ul)))'中的'operator>>'不匹配

> ID：15209152
> 
> 赞同：2
> 
> 时间：2013-03-04T19:08:49.220
> 
> 标签：c++, templates

对于我在函数加载中的作业，我实例化了一个 ifstream 对象，打开一个文件并开始读入，得到长编译器错误。我也尝试过通过重定向输入来摆脱 fstream 并使用 cin，但我从来没有走到那一步。完全相同的错误，除了使用 cin 而不是 in。

```
 #ifndef _BUBBLE_SORT_H
    #define _BUBBLE_SORT_H

    #include <iostream>
    #include <fstream>
    #include <cstdlib>

    using namespace std;

    template <typename T>
    void swap(T *a, T *b){
            T t = *a; 
            *a = *b; 
            *b = t;
    }

    template <typename T>
    void bubbleSort(T * arr, int n){ 
            bool isSorted = false;
            for (int last = n-1; last > 0 && !isSorted; last--) {
                    isSorted = true;
                    for (int i = 0; i < last; i++)
                            if (arr[i] > arr[i+1]) {
                                    swap((arr+i), (arr+i+1));
                                    isSorted = false;
                             }
                    if (last % 1000 == 0) cerr << ".";
            }
    }

    template <typename T>
    void print(T arr[], int n){ 
            for(int i = 0; i < n; i++)
                    cout << arr[i] << '\t';
    }

    template <typename T>
    T &load(string filename, int &n){
            ifstream in; 
            in.open(filename.c_str());

            in >> n;
            if(!in) {
                    cerr << "Error opening file" ;
                    exit(1);
            }   
            T *arr = new T[n];

            for(int i = 0; i < n; i++)
                    in >> *(arr + i); 
            in.close();
            return *arr;
    } 

#endif 
```

我正在使用 gnu gcc 编译器

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T20:12:04.990

问题在于对加载函数的调用。你在调用它，表明你正在读取的数组的类型？以下是编辑加载函数以返回数组的建议，以及主函数中的调用者：

```
template <typename T>
T *load(string filename, int &n){
        ifstream in; 
        in.open(filename.c_str());

        in >> n;
        if(in.fail()) {
                cerr << "Error opening file" ;
                exit(1);
        }   
        T *arr = new T[n];

        for(int i = 0; i < n; i++)
                in >> *(arr + i); 
        in.close();
        return arr;
} 

int main(){
        int x, i;
        string fileName = "test.txt";
        double *arr = load<double>(fileName, x); // make sure you have <double> in the call
        for(i = 0; i < x; i++) cout << arr[i] << endl;
        delete [] arr;
        return 0;
        } 
```

确保你包含你正在读取的数组类型，比如说，double，否则你会得到一个错误。另外，以我的拙见，最好返回一个如上面代码片段所示的指针。希望有帮助。

**编辑**

模板工作方式的一些额外内容。编译代码时，模板会扩展为同一函数的多个不同版本，具体取决于在整个程序中使用了多少不同类型（并由 T 表示）。因此，考虑到这一点并查看问题中提出的代码，尝试从文件输入流中读取类型 T 是没有意义的，因为编译器无法扩展到基于未知类型的任何函数。但是，当模板变量 T 的类型已知时（在您`typename`的 s 都出现在函数参数中的情况下），则`<double>`可以省略规范，因为它是从函数调用中传递的参数类型推断出来的。

# iphone - 更新自定义 UIView

> ID：15209159
> 
> 赞同：0
> 
> 时间：2013-03-04T19:09:15.720
> 
> 标签：iphone, ios, objective-c

我正在为我的应用程序创建一个自定义进度条。

我已经分类`UIView`，所有的绘图都在`drawRect`.

现在，自定义进度条有 6 个属性，它们都改变了它的显示方式。

```
minProgress
maxProgress
progress
onColor
offColor
numberOfSections 
```

这些都由子类设置为默认值，但是在控制器的 viewWillAppear 方法中有几个地方所有这些值都被更改了。

目前我已经为所有看起来像这样的属性编写了setter函数......

```
- (void)setProgress:(float)progress
{
    _progress = progress;

    [self setNeedsDisplay];
} 
```

但这是否意味着 drawRect 方法会在实际显示在屏幕上之前被调用 6 次？这似乎是一种不好的做法。

我对此是否正确？还有另一种方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T19:13:33.560

`setNeedsDisplay`只是将您的视图标记为在下一个绘制阶段需要重绘。如果您在下一次抽奖之前多次调用它，它仍然只会被抽一次。

# java - 如何使用 HttpURLConnection 设置 HTTP 请求 MOVE？

> ID：15209160
> 
> 赞同：1
> 
> 时间：2013-03-04T19:09:23.660
> 
> 标签：java, http, httpurlconnection

如何设置 HTTP 请求方法 MOVE 使用`HttpURLConnection`？

使用`HttpURLConnection`或依赖于该类的库，代码会抛出异常`Caused by: java.net.ProtocolException: Invalid HTTP method: MOVE`。所以我猜`MOVE`Java平台不支持该方法。

是否有针对此问题/限制的补丁或解决方法？解决方法可能是另一个用于创建 HTTP 请求的 java 库。

**编辑：**请注意，`MOVE`动词支持[WebDav HTTP extension](http://en.wikipedia.org/wiki/WebDAV)。还有后来添加到协议中的[`PATCH`扩展。](https://www.rfc-editor.org/rfc/rfc5789)

这里的参考是 SkyDrive API 以及我们正在尝试实现的[移动功能。](http://msdn.microsoft.com/en-us/library/live/hh826531.aspx#move)

请注意，[Ruby 平台支持该`MOVE`方法](http://ruby-doc.org/stdlib-2.0/libdoc/net/http/rdoc/Net/HTTP/Move.html)。*我想知道为什么 java 不支持甚至不允许这些扩展*。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-06-11T05:22:24.180

如果服务器支持它，您可以尝试`POST`使用标头发出请求`X-HTTP-Method-Override: MOVE`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T20:09:57.100

这是 HttpURLConnection 中的一个错误。如果您不想切换到其他库，可以尝试使用自省覆盖该方法（是的，这就是 Jersey 所做的，请参阅[http://java.net/jira/browse/JERSEY-639](http://java.net/jira/browse/JERSEY-639)）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-06T14:18:54.253

我更喜欢使用 Apache Http-Components 客户端。它有一个自定义的网络实现，因此可以使用非标准的 HTTP 方法，如 MOVE 或 PATCH：

```
CloseableHttpClient httpclient = HttpClients.createDefault();
HttpUriRequest moveRequest = RequestBuilder
            .create("MOVE")
            .setUri("http://example.com")
            .build();        
CloseableHttpResponse response = httpclient.execute(moveRequest); 
```

马文坐标：

```
<dependency>
    <groupId>org.apache.httpcomponents</groupId>
    <artifactId>httpclient</artifactId>
    <version>4.2+</version>
</dependency> 
```

# java - 高效的 onDraw 位图和硬件加速的复杂剪裁

> ID：15209162
> 
> 赞同：4
> 
> 时间：2013-03-04T19:09:48.477
> 
> 标签：java, android, memory, 2d

我正在寻找有关动画内容的最佳渲染（可能还有缓存）的建议，这些动画内容的性质是在运行时确定的并且无法预先计算。

我正在开发我的第一个 Android 应用程序，并决定开发一个（当前）“玩具”项目，该项目采用相对较短的字母数字代码并将它们转换为图像和动画。（SourceForge 项目位于[http://sourceforge.net/projects/picturecode](http://sourceforge.net/projects/picturecode)，设计文档位于[https://docs.google.com/file/d/0B-yO-2scTVuRSkk2NDdiZ3YzTDg/edit?usp=sharing](https://docs.google.com/file/d/0B-yO-2scTVuRSkk2NDdiZ3YzTDg/edit?usp=sharing)）

我正在设计用于在其他代码中嵌套预定义和用户定义代码的操作，以允许更复杂的图像使用更短的代码。我也在尝试设计相关的操作，这些操作将有助于以相对简单的代码表示来制作同样复杂但有趣的图像。

因此，我认为有用的操作之一是能够使用预定义或用户定义的代码作为掩码来剪辑其他绘图操作。在我发现硬件加速视图不支持 clipPath 并强制视图基于软件后，我得以实现此功能。（我的渲染器检查我们是否处于定义“剪切路径”并将操作添加到路径而不是在画布上绘制它们的模式，但这有点乏味并且不支持所有操作。）

我正在考虑切换回硬件加速模式的替代方案。我想到的是创建一个 ALPHA_888 位图并绘制到该位图，而不是在我处于该剪切模式时创建剪切路径。这可能具有的一个优点是支持任意操作会更直接。当我处于剪切模式时，我只是在该位图上而不是在主画布上绘制它们。一旦我有了位图，我假设我可以使用具有适当 PorterDuff 模式的 Paint 以某种方式将它与 drawBitmap 一起使用（进入另一个中间位图）。

我希望有一天我（或任何人，因为该项目在 SourceForge 上）可能会在更大的项目中重用这个组件，作为表示可以以纯文本但短/优化格式传输的图形的轻量级方式。我将其视为动画 GIF，但创建起来更简单，传输也更小。

我的问题是：

1.  一般来说，硬件加速有多重要？这是保留的重要功能还是应该放弃它以支持其他功能？（如果其他人要使用此功能，我假设他们通常希望组件与硬件加速兼容。）
2.  掩盖一个强大/重要的操作，还是有更好的我可以使用的东西（比如直接到画布上的纯 porter-duff-filtered 绘图）？
3.  我是否正在考虑实施复杂掩蔽的正确轨道？

最后也是**最重要的**：

*   如果有的话，我应该如何使用和管理位图（例如，掩码位图）？当我开始这个项目时，我注意到在 OnDraw 期间分配任何新对象是不可取的。所以我预先分配了所有我可以使用的东西——一个 Paint、一个 PointF、一个 RectF、一个 Path 和其他一些，以便我可以在 onDraw 期间使用它们。目前，我仍在直接绘制到画布上，但我想知道是否应该在单独的线程上渲染到某种缓冲区，如位图，然后在 onDraw 期间将缓冲区绘制到屏幕上。这是否会破坏硬件加速的目的（并且首先不需要关闭视图本身的硬件加速）？更重要的是，我如何/何时可以安全地分配这些位图而不会冒犯 lint 和经验丰富的 android 开发人员，他们知道在 onDraw 期间分配内存是不好的？如果我在单独的绘图线程上分配位图，我可能必须为每个包含/嵌入图片的每一帧分配一次，因为这些图片可以是动画。或者我可能只想为当前帧分配一个位图，以帮助剪切或合成多个图像。

很难将其缩小到一个非常具体的问题。我所拥有的介于一堆问题和关于我什至可能不知道的功能或想法的一般建议之间。我对 Java 和 Android 开发比较陌生，但对 C#、2D 图形和游戏开发非常熟悉。我的问题是否指出了我对 2D 动画应如何在 Android 上运行的理解中的任何明显漏洞？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T11:50:13.343

在阅读[一篇关于 Android 硬件加速](http://developer.android.com/guide/topics/graphics/hardware-accel.html)的文章时，我偶然发现了对 Canvas 的 saveLayer 函数的引用，我相信这正是我在这里遗漏的部分。

**更新：**我已经确认 saveLayer 是我所追求的。我不是基于路径应用复杂的剪辑区域，然后在其中绘制，而是调用 saveLayer 创建一个屏幕外缓冲区，将在其中应用绘制操作，绘制一个图像，将 Xfermode 切换到 SRC_IN，然后绘制第二张图片。这产生了两个图像的交集，第二个图像是可见内容。当我调用 restore 时，我基本上得到了第二张图像被第一张图像的内容剪辑，这比我最初试图完成的要好。

# nfc - Mifare Classic 1k - 仅在三星 S III mini GT-i8190N 上出现错误

> ID：15209165
> 
> 赞同：3
> 
> 时间：2013-03-04T19:10:05.210
> 
> 标签：nfc, rfid, mifare

嗨，我的应用程序有问题。应用程序正在使用 Mifare Classic 1k 芯片。**我用钥匙 B**在卡上写了一些信息。

问题是：虽然应用程序在三星 S3（果冻 4.1.2，调试模式开启，nfc 开启）上运行良好，但在**三星 S III mini GT-i8190N**（果冻 4.1.2，调试模式开启，nfc 开启）上**，相同的应用程序是不能正常工作**。我可以用 keyA 阅读，但我**不能用 keyB 写作**。事实上，任何调用`authenticateSectorWithKeyB`返回的尝试都会`false`导致任何后续写入请求抛出以下异常：

> 01-01 01:21:44.682: E/TAG(4392): java.io.IOException: Transceive failed 01-01 01:21:44.682: E/TAG(4392): at android.nfc.TransceiveResult.getResponseOrThrow(TransceiveResult .java:52)

知道为什么会这样吗？有什么办法可以解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-28T14:17:34.060

不幸的是，我没有找到有关三星 S3 mini NFC 芯片制造商的任何信息。但是...也许尝试使用另一个 NFC 芯片（例如 NTAG203）。Mifare Classic 1k 芯片不完全符合 NFC 标准，因此仅适用于 NXP 芯片组。

# git - 无法正确解决文件冲突后，是否可以恢复冲突？

> ID：15209168
> 
> 赞同：2
> 
> 时间：2013-03-04T19:10:09.307
> 
> 标签：git, conflict, resolve

假设我做了一个 rebase 并且 100 个文件有冲突。我必须一一解决。假设我已经解决了 (N-1) 个文件，并且正在处理文件 N。在处理了一段时间后，我发现我把文件弄乱了。所以我想再次从头解决它。但我不想中止变基并再次变基，因为我不想再次解析 (N-1) 文件。

是否可以仅恢复文件 N 的合并冲突，以便我可以从头开始再次解决它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:16:15.590

假设您正在处理的文件名为`test.txt`，并且该文件由于合并尝试而留下了冲突标记，并且您以某种方式拙劣地手动解决了这些冲突，您可以使用冲突标记重新创建文件用几个命令。

作为背景，它有助于知道，当合并需要对文件进行手动冲突解决时，它会在`git`索引中留下该文件的三个不同副本（称为“阶段”）。阶段 1 是被合并文件的两个版本的共同祖先，阶段 2 和 3 是您尝试合并的两个分支的两个版本。一些（但不是全部）实用程序了解引用这些条目`git`的语法。`:<stage>:<filename>`

所以，你首先需要做的是在某处重新创建这三个文件的临时副本——我将`/tmp`在这里使用，但这不是强制性的：

```
git cat-file -p :1:test.txt > /tmp/test.txt.1
git cat-file -p :2:test.txt > /tmp/test.txt.2
git cat-file -p :3:test.txt > /tmp/test.txt.3 
```

然后，使用`git`管道命令`git merge-file`重新创建具有适当冲突标记的文件。请注意，参数的顺序在这里很重要，最好保存您已经在此文件上完成的工作，以防您想在重新进行合并时引用它。

```
mv test.txt test.txt.broken
git merge-file -p /tmp/test.txt.2 /tmp/test.txt.1 /tmp/test.txt.3 > test.txt 
```

这将使用冲突标记重新创建`test.txt`（尽管没有通常包含的分支名称注释 - 如果您真的想要这些，您需要添加一些`-L <branchname>`参数 - 您可以键入`git help merge-file`以获取更多信息）。

At that point, you can clean up the temporary files, and start over on resolving the conflicts in that file. Remember to `git add` it when you're done, and then continue with the rest of the files.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T06:25:17.120

I believe you're looking for `git checkout --merge --`*`path/to/file`*.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T19:39:13.343

也许不是一个很好的解决方案（看起来不是那么 git'ish），但这是一种可能的方法：

1.  将 (N - 1) 个文件复制到临时目录
2.  git rebase --abort
3.  将 (N - 1) 个文件复制回 git 目录
4.  处理您的第 N 个文件。

# c# - 无法调用在后面插入代码的 jquery 函数

> ID：15209170
> 
> 赞同：0
> 
> 时间：2013-03-04T19:10:21.283
> 
> 标签：c#, jquery

在我的页面中，我有一个用户控件，它会在开关打开时插入一个 jQuery 函数。这是我在用户控件背后的代码：

```
public bool isRequired {
  set {
    if (value == true) {
      ClientScriptManager cs = Page.ClientScript;

      string csname = "isRequiredScript";
      if (!cs.IsClientScriptBlockRegistered(this.GetType(), csname)) {
        StringBuilder cstext = new StringBuilder();
        cstext.Append("<script type=\"text/javascript\">");
        cstext.Append("$(document).ready(function () {");
        cstext.Append("function QuestionwithConditionalInfo_validation() {");
        cstext.Append("if ($(\"#MainPlaceHolder_" + QuestionOption.ClientID + " :checked\").val() == null) {");
        cstext.Append("alert(\"Please answer the question '" + setQuestionText + "'\");");
        cstext.Append("return false;");
        cstext.Append("}} });");
        cstext.Append("</script>");
        cs.RegisterClientScriptBlock(this.GetType(), csname, cstext.ToString(), false);
      }
    }
  }
} 
```

然后在主页面中，我打算调用那个 jQuery 函数：

```
function childpage_validation() {
  if (QuestionwithConditionalInfo_validation() == false)
    return false;
}

<asp:Button ID="page1_Next" Text="Next page" runat="server" OnClick="page1_Next_Command" OnClientClick="return childpage_validation()" /> 
```

然后我收到错误说该函数`QuestionwithConditionalInfo_validation()`未定义，之后我尝试`RegisterStartupScript`而不是`RegisterClientScriptBlock`得到相同的错误。有谁知道为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:20:37.483

了解准备好的文档只需要允许它在该事件期间执行 - 它实际上是一个事件处理程序。由于您不需要（事件已经发生），您可以从代码中删除它：

```
cstext.Append("<script type=\"text/javascript\">");
cstext.Append("function QuestionwithConditionalInfo_validation() {");
cstext.Append("if ($(\"#MainPlaceHolder_" + QuestionOption.ClientID + " :checked\").val() == null) {");
cstext.Append("alert(\"Please answer the question '" + setQuestionText + "'\");");
cstext.Append("return false;");
cstext.Append("}};");
cstext.Append("</script>"); 
```

同样通过删除它，您可以删除它的闭包，它现在是一个全局对象，并且可以在您表达您的愿望时从页面访问。

# java-native-interface - Android NDK - 为 android 应用程序使用预先存在的 c 库

> ID：15209173
> 
> 赞同：0
> 
> 时间：2013-03-04T19:10:35.090
> 
> 标签：java-native-interface

是否可以从应用程序对 android 内核进行系统调用？示例：system(cmd) 在 C 程序中，我正在使用 JNI 在我的 android 活动中访问它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T17:57:51.400

答案：系统调用——是的。调用 system() - 一种。

两者不是一回事。系统调用由内核提供，Bionic 为它们提供了一个瘦包装器，与普通 LibC 在 vanilla linux 中包装它们的方式非常相似。

然而，system() 不是系统调用，而是 LibC 提供的一个函数，实际上相当于 fork()，然后在子进程中 execl("/system/bin/sh", "...args") 和等待。

粗略查看 Android 源代码显示 Bionic 不会导出 system()。但您可以手动实现它。然而，更重要的是，您为什么要这样做？从技术上讲，您可以加载 JNI（Java 中的 System.loadLibrary），然后让本机方法执行任何操作 - 但这会使您的生活变得非常复杂，尤其是考虑到您的应用程序是沙盒的并且您不能依赖 shell 命令的正常行为（如大多数是由设备上的工具箱提供的，如果有的话）。

# javascript - 如何序列化NodeJS？

> ID：15209174
> 
> 赞同：2
> 
> 时间：2013-03-04T19:10:35.950
> 
> 标签：javascript, node.js, rest

我正在使用 NodeJS 探索服务器端 JavaScript，并使用 ExpressJS 编写 REST API。我的 REST API 用于配置设备，就像配置家庭路由器一样。我想阻止并行 REST 调用尝试配置客户端而不阻止多个非配置请求。

示例 API 资源：

```
/api/config/network
/api/config/filesystem 
```

在我的示例 API 中，从概念上讲，我希望一个客户端能够配置网络资源，而另一个客户端配置文件系统资源，同时允许其他客户端查询这些资源。

我不确定如何使用 JavaScripts 异步编程模型来实现这一点。我来自非异步编程背景（多线程 C++）。我无法解决这个问题，想知道有什么方法可以手动解决这个问题，如果我必须编写插件/模块怎么办？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-04T19:32:21.610

当您的 express 应用收到编辑配置的请求时，将项目添加到配置为并发 1 的[async.js 队列](https://caolan.github.io/async/docs.html#queue)。这将防止 > 1 并发尝试编辑远程配置。伪代码将是：

*   在应用程序启动时，定义您的`updateNetworkConfig`功能
*   在应用启动时，创建一个并发队列 1
    *   `var networkQueue = async.queue(updateNetworkConfig, 1);`
*   REST 像 PUT /api/config/network 一样使用新配置作为 JSON 中的请求正文
*   将一个项目添加到队列中，传递新的配置数据
    *   `networkQueue.push(req.body.config);`
    *   （`req.body`由 bodyParser 连接中间件提供）
*   为每个独立配置重复该设置：文件系统等

您将需要一堆其他管道来处理回调并在保存配置时通知 REST 客户端。如果队列不为空，则由您决定是否排队呼叫或拒绝新呼叫。

由于您坚持不学习和使用令人敬畏的 async.js 库，这将提高您对异步编程的流畅度并教给您有价值的东西，这就是交易。使用这个叫做变量的东西。

```
var updatingNetwork = false;
app.put('/api/config/network', function (req, res) {
   if (updatingNetwork) {
       return res.status(409).send("Try later");
   }
   updatingNetwork = true;
   updateNetworkConfig(req.body.config, function (error) {
       updatingNetwork = false;
       if (error) {
           return res.status(500).send(error);
       }
       res.status(200).send("done");
   });   
}); 
```

*   当一个请求进来时，如果`updatingNetwork`是真的，你知道已经有一个更新在处理中，要么排队要么拒绝它。

# android - 如何在android中使用onclick方法获取写在按钮上的文本？

> ID：15209181
> 
> 赞同：-4
> 
> 时间：2013-03-04T19:11:04.320
> 
> 标签：android, xml

我正在为此设计国际象棋，我创建了 64 个按钮。对于棋子，我使用了 ascii 代码。对于每个按钮，我都包含了 onclick 属性。现在我想要在单击的按钮上写的文本（ascii 值）。这是怎么可能的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:14:19.517

在 onClick() 方法中，您会收到被单击视图的 View 参数。对此简单调用 getText() ：

```
public void onClick(View v) {
    Button myButton = (Button) v;
    String text = myButton.getText().toString();
} 
```

如果您已经有相关按钮的引用，您也可以使用它。

# php - 如何在提交时传递多个变量？

> ID：15209185
> 
> 赞同：0
> 
> 时间：2013-03-04T19:11:30.357
> 
> 标签：php, html, http, post, get

我有一个小表格：

```
//GET the unit and community id
$UNIT = $_GET['unit'];
$COMID = $_GET['comid'];

...//i have echoed $UNIT and $COMID to ensure that they do have values
...

<form action="ModifyNoteScript.php" method="post"  />
        <input name="Comment" type="hidden" value="<?php echo $Comment; ?>" />
        <input name="UNIT" type="hidden" value="<?php echo $UNIT; ?>" />
        <input name="COMID" type="hidden" value="<?php echo $COMID; ?>" />
        <textarea name="Comment" cols="55" rows="6" class="text1" id="Comment"><?php echo $Comment; ?>
        </textarea>
        <br />
        <input type="submit" name="sendnotify" class="formbutton" id="Submit" value="Replace previous note with current" />
      </form> 
```

就是这个：

![在此处输入图像描述](../Images/35ec6df954fb57647cb569475fd274ed.png)

如您所见，我正在将变量设置`comment`为`textarea`

它毫无问题地传递到下一页 ModifyNoteScript.php。

`UNIT`但是，其他两个变量`COMID`由于某种原因被传递为`[blanks]`

这是 ModifyNoteScript.php 的样子：

```
<?php
include '../Check.php';
include '../CustomConnect.php';

$UNIT= $_POST['unit']; 
$COMID= $_POST['comid']; 
$NOTE= $_POST['Comment']; 

    $comment_update = mssql_query("UPDATE pmp_property__unit
    SET  
    comments = '$NOTE'
    WHERE 
    communityidy='$COMID' and
    unit='$UNIT'") 
             or die ("Changes to Record could not be Saved."); 

?> 
```

**为什么这两个变量作为空白传递？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:14:03.157

在`ModifyNoteScript.php`中，`$_POST`变量必须是：

```
$UNIT= $_POST['UNIT']; // uppercase
$COMID= $_POST['COMID']; // uppercase
$NOTE= $_POST['Comment']; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T19:16:49.547

`name`检查标签和`$_POST`索引之间的大小写差异。

你总是可以尝试`var_dump($_POST)`看看你得到了什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T19:19:16.673

首先，您的脚本对 XSS 攻击开放，因为您没有进行任何验证（至少它是这样显示的）。

```
$UNIT = $_GET['unit']; // should be $_POST['UNIT']
$COMID = $_GET['comid']; // should be $_POST['COMID'] 
```

您正在尝试获取两个 GET 变量，同时它们是使用 POST 提交的并且是大写的。请记住，GET 和 POST 变量区分大小写。

你也有一个`input[type=hidden]`和一个`textarea`相同的`name`，它们都被提交了。您应该更改其中之一以避免混淆。

# jquery - 如何将复选框状态从一个复制到另一个

> ID：15209187
> 
> 赞同：0
> 
> 时间：2013-03-04T19:11:33.483
> 
> 标签：jquery, checkbox

假设我在这里有这个代码，有 2 个按钮将 inputa 复制到 inputb 并将 inputb 复制到 inputc ：

```
<input id="inputa" type="checkbox" name="input[1][]"> 

<input id="inputb" type="checkbox" name="input"> 

<input id="inputc" type="checkbox" name="input[2][]"> 
```

我想要的是通过单击使用 JQuery 的按钮将 haircolor0 的状态复制到 haircolor1。然后使用相同的方法，我将从 haircolor 1 复制到 0。以模拟复制和粘贴，以便我的用户可以通过表单复制和粘贴他们的选择。不想使用循环。

只是学习 JQuery 并不是很好。需要帮忙

我的意思是一个模板，只需要完成这个的功能。

[http://jsfiddle.net/andrewvmail/ujhaC/1/](http://jsfiddle.net/andrewvmail/ujhaC/1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T20:06:21.390

不确定我是否理解正确。你应该展示你所做的代码。

[制作了jsfiddle示例](http://jsfiddle.net/6kfsW/1/)

jQuery :

```
$('.copy').click(function(){

    // button id
   var id = $(this).attr('id');

    //loop through checked inputs
    $('.' + id + ':checked').each(function(){
        var inputId = $(this).attr('id').split('-'),
           value = inputId[0], number = inputId[1] ;

        //check checkboxes
         $("#" + value + "-" + (parseInt(number)+1) ).attr('checked', 'checked');
    }); 

}); 
```

# sharepoint - 如何将自定义服务应用程序提供给内容数据库

> ID：15209192
> 
> 赞同：1
> 
> 时间：2013-03-04T19:11:43.170
> 
> 标签：sharepoint, sharepoint-2010, sharepoint-api, sharepoint-2013

我有一个自定义服务应用程序，它查看网站集并在该网站集上标记 pdf。

问题在于运行服务应用程序的应用程序池无权访问网站集的数据库。

手动授予它访问权限很容易，但如果服务器场管理员创建另一个内容数据库，则服务应用程序将无权访问该数据库。我希望能够检查哪些 Web 应用程序使用服务应用程序并确保相关帐户可以访问适当的内容数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T21:35:06.593

我认为您可以做两件事，具体取决于您的需要。一种是，在数据库级别，您可以使用来保证您的服务应用程序帐户 Shell Admin 权限`Add-SPShellAdmin`- 如果您需要对数据库本身（不推荐）或 iis/文件系统进行一些类似管理的更改，这可能会有所帮助。

第二件事，我希望它更适合您的需求，但它适用于 Web 应用程序级别，正在创建[Web 应用程序上的用户策略](http://www.thesharepointblog.com/Lists/Posts/Post.aspx?ID=15)，您可以在其中授予您的服务帐户对所有文档的读写访问权限。

如果我误解了什么，请告诉我。

# c# - 两个（未排序的）数据表之间匹配的优化算法？

> ID：15209193
> 
> 赞同：0
> 
> 时间：2013-03-04T19:11:43.227
> 
> 标签：c#, .net, algorithm

我正在我的应用程序中开发一些功能，查询我们的数据库并将数据拉到一个数据表中，然后打开一个 excel 文件并填充另一个数据表。

因为 excel 文件不包含可用的 ID，所以我无法对数据进行排序，并且可能无法使用`DataTable.Merge()`.

这是我创建的匹配算法的代码。

```
 private void RunMatchingAlgorithm()
    {
        // Initialize variables
        string partNumber = "";
        DateTime expiration_date = DateTime.Now;
        decimal contract_cost = 0;
        string contract_no = "";

        string partNumber2 = "";
        DateTime expiration_date2 = DateTime.Now;
        decimal contract_cost2 = 0;
        string contract_no2 = "";

        //Get values from DataBase
        for (int i = 0; i < dtFromTableContracts.Rows.Count; i++)
        {
            partNumber2 = dtFromTableContracts.Rows[i]["supplier_part_no"].ToString();
            contract_no2 = dtFromTableContracts.Rows[i]["contract_no"].
            expiration_date2 = Convert.ToDateTime(dtFromTableContracts.Rows[i]["con_end_date"]).Date;

            //Get Values from converted Excel table
            for (int j = 0; j < dtConversion.Rows.Count; j++)
            {
                contract_no = dtConversion.Rows[j]["vend_contract_no"].ToString();

                //If we have even a partial match, check for a part number match
                if (contract_no2.StartsWith(contract_no))
                {
                    partNumber = dtConversion.Rows[j]["vend_item_id"].ToString();

                    //If the values match, populate from both tables
                    if (partNumber == partNumber2)
                    {
                        dtConversion.Rows[j]["wpd_expiration_date"] = expiration_date2.Date;
                        dtConversion.Rows[j]["wpd_cont_cost"] = dtFromTableContracts.Rows[i]["contract_cost"];
                        dtConversion.Rows[j]["wpd_contract_no"] = dtFromTableContracts.Rows[i]["contract_no"];
                        dtConversion.Rows[j]["wpd_item_id"] = dtFromTableContracts.Rows[i]["supplier_part_no"];
                        dtConversion.Rows[j]["wpd_item_no"] = dtFromTableContracts.Rows[i]["item_id"];
                        dtConversion.Rows[j]["discontinued"] = dtFromTableContracts.Rows[i]["discontinued"];
                        dtConversion.Rows[j]["job_no"] = dtFromTableContracts.Rows[i]["job_no"];
                    }
                }
            }
        }
    } 
```

如果您好奇，稍后的方法会删除所有不匹配的行，并且我们仅在 DGV 中显示匹配的记录。

这目前按预期工作，但如果我的大 O 表示法是正确的，我正在处理 O(m*n) ，它在更大的数据集下变得相当慢，并且处理器密集度极高。

我正在寻找一种更有效的方法来完成此任务，而不是遍历每一行，因为我们使用的一些 excel 电子表格接近 40,000 行。这个算法需要大约 6 分钟才能完成这个大小的集合。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T19:37:29.117

哦，男孩，有很多简化机会的代码。您可以缩小局部变量的范围，消除为它们分配未使用值的任何诱惑。当除了访问集合之外不使用索引时，您还可以将 For 循环转换为 ForEach 循环。

初步简化：

```
private void RunMatchingAlgorithm() {
    foreach (var databaseRow in dtFromTableContracts.Rows) {
        string partNumber2 = databaseRow["supplier_part_no"].ToString();
        string contract_no2 = databaseRow["contract_no"].ToString();
        DateTime expiration_date2 = Convert.ToDateTime(databaseRow["con_end_date"]).Date;

        foreach (var excelRow in dtConversion.Rows) {
            string contract_no = excelRow["vend_contract_no"].ToString();

            //If we have even a partial match, check for a part number match
            if (contract_no2.StartsWith(contract_no)) {
                string partNumber = excelRow["vend_item_id"].ToString();

                //If the values match, populate from both tables
                if (partNumber == partNumber2) {
                    excelRow["wpd_expiration_date"] = expiration_date2.Date;
                    excelRow["wpd_cont_cost"] = databaseRow["contract_cost"];
                    excelRow["wpd_contract_no"] = databaseRow["contract_no"];
                    excelRow["wpd_item_id"] = databaseRow["supplier_part_no"];
                    excelRow["wpd_item_no"] = databaseRow["item_id"];
                    excelRow["discontinued"] = databaseRow["discontinued"];
                    excelRow["job_no"] = databaseRow["job_no"];
                }
            }
        }
    }
} 
```

想一想，这几乎就是 linq 查询的设计目的。我们可以将大部分代码转换为查询：

```
private void RunMatchingAlgorithm() {
    var matches = from databaseRow in dtFromTableContracts.Rows
                  let partNumber2 = databaseRow["supplier_part_no"].ToString()
                  let contract_no2 = databaseRow["contract_no"].ToString()
                  let expiration_date2 = Convert.ToDateTime(databaseRow["con_end_date"]).Date
                  from excelRow in dtConversion.Rows
                  let contract_no = excelRow["vend_contract_no"].ToString()
                  where contract_no2.StartsWith(contract_no)
                  let partNumber = excelRow["vend_item_id"].ToString()
                  where partNumber == partNumber2
                  select new { databaseRow, excelRow, expiration_date2 }
    foreach (var m in matches) {
        var dst = m.excelRow;
        var src = m.databaseRow;

        dst["wpd_expiration_date"] = m.expiration_date2.Date;
        dst["wpd_cont_cost"] = src["contract_cost"];
        dst["wpd_contract_no"] = src["contract_no"];
        dst["wpd_item_id"] = src["supplier_part_no"];
        dst["wpd_item_no"] = src["item_id"];
        dst["discontinued"] = src["discontinued"];
        dst["job_no"] = src["job_no"];
    }
} 
```

现在我看到了可以在哪里应用优化。我们正在使用“where”进行嵌套的“from”，这相当于交叉连接。此外，我们可以删除大部分现在只使用一次的临时文件：

```
private void RunMatchingAlgorithm() {
    var matches = from databaseRow in dtFromTableContracts.Rows
                  join excelRow in dtConversion.Rows
                  on excelRow["vend_item_id"].ToString() equals databaseRow["supplier_part_no"].ToString()
                  where databaseRow["contract_no"].ToString().StartsWith(excelRow["vend_contract_no"].ToString())
                  select new { databaseRow, excelRow }
    foreach (var m in matches) {
        var dst = m.excelRow;
        var src = m.databaseRow;

        dst["wpd_expiration_date"] = Convert.ToDateTime(src["con_end_date"]).Date;
        dst["wpd_cont_cost"] = src["contract_cost"];
        dst["wpd_contract_no"] = src["contract_no"];
        dst["wpd_item_id"] = src["supplier_part_no"];
        dst["wpd_item_no"] = src["item_id"];
        dst["discontinued"] = src["discontinued"];
        dst["job_no"] = src["job_no"];
    }
} 
```

我实际上并没有太多使用交叉连接，但我假设他们在底层使用哈希表来获得 O(n+m) 复杂度而不是 O(n*m)。如果两个表都在数据库中，那么数据库可以利用已经构建的哈希表/索引。

您可能还想考虑某种生成的 Linq2SQL 类，这样您就可以对行字段进行类型安全的访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T19:24:48.397

您可以散列要匹配的值并具有 O(m+n) 复杂度。

您必须创建一个函数来解析双方并创建一对（或一组）统一结果，然后可以对其进行散列。例如，如果您`contract_no`的一侧有一些已知格式的前缀，而另一侧没有前缀，您可以删除前缀并对其进行哈希处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T19:25:51.660

在找到匹配的零件号后，您应该能够通过退出内部循环将时间减少大约一半。也就是说，将 a`break`作为零件编号匹配时执行的代码中的最后一条语句。

尽管如此，永远的一半仍然是永远。

只需 40,000 行，您就可以轻松地填充一个字典，其中包含合同号和零件号作为键，转换表行索引作为值。就像是：

```
Dictionary<string, int> conversionLookup = new Dictionary<string, int>();
for (int i = 0; i < dtConversion.Rows.Count; ++j)
{
    conversionLookup.Add(string.Format("{0}:{1}", 
        dtConversion.Rows[j]["vend_contract_no"].ToString(),
        dtConversion.Rows[j]["vend_item_id"].ToString()), j);
} 
```

然后，您的外循环变为：

```
for (int i = 0; i < dtFromTableContracts.Rows.Count; i++)
{
    partNumber2 = dtFromTableContracts.Rows[i]["supplier_part_no"].ToString();
    contract_no2 = dtFromTableContracts.Rows[i]["contract_no"].ToString();
    string lookup = string.Format("{0}:{1}", contract_no2, partNumber2);
    int ix;
    if (conversionLookup(lookup, out ix))
    {
        // update dtConversion.Rows[ix]
    }
} 
```

我不熟悉对零件编号的限制（`StartsWith`您在内循环中使用而不是 equals），因此您可能需要稍微调整索引。

那应该非常快。

如果您无法创建使用合同编号进行直接查找的键，您可以通过`List`使用合同编号和零件编号创建一个非常类似的操作，然后对其进行二进制搜索。那将是 O(m log n) 而不是 O(m * n)。还是快了不少。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T19:35:37.980

[Trie](http://en.wikipedia.org/wiki/Trie)将是查找子字符串的最快结构。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-04T19:36:23.310

如果 ContractTable.ContractNo 具有已知的恒定长度，那么您（事实上）在以下两个表之间具有 PK-FK 关系：

```
ContractTable.ContractNo = substring(Conversion.VendContractNo,1,K)
ContractTable.PartNumber = Conversion.PartNumber 
```

其中 K == 长度（ContractTabel.ContractNo）。

在这个键结构上索引两个表将允许在 O(Log N) + O(Log M) 时间内进行匹配，索引创建需要 O(N * Log N) + O(M * Log M) 时间。散列可以进一步改善这一点，这取决于一个好的散列的构造。

# php - PHP：获取用户单击重定向到我的外部站点的链接的服务器的 IP 地址

> ID：15209195
> 
> 赞同：0
> 
> 时间：2013-03-04T19:11:51.800
> 
> 标签：php, apache

为了清楚起见，想象一下这种情况：

*   用户在 siteA.com
*   用户点击指向我的网站的链接：siteB.com
*   我的站点希望在收到请求后确定 siteA.com 的 IP 地址，以便它知道为此请求链接到它的服务器的 IP。

有没有办法用 PHP 和 Apache 做到这一点？如果没有，有什么办法可以做到这一点？

```
<?php

// Perhaps something like:
$linking_server_ip = $_SERVER[LINKING_SERVER_IP];

?> 
```

**编辑：**

所以 $_SERVER['HTTP_REFERER'] 不能被依赖，但我想我可以随便使用它（补充/机会主义信息表明推荐人不是来自预期的端点，如果它可能不是空的。虽然听起来考虑到任何插件客户端仍然可能破坏该值，因此即使这么多也不可靠，从而使合法推荐似乎来自其他服务器）。

我仍然存在这个问题：

我需要验证服务器是否引用了我网站上的特定页面（充当该服务器的证书）。

EG 他们的页面有一个指向 certificate.php?serverid=1234 的链接

我想验证他们没有欺骗系统并在他们的任何其他服务器上使用此证书（例如，使用 siteA 的 siteC 证书并避免为应该在 siteC 上完成的服务付费）。

即使使用使siteA的服务器http请求我的服务器（siteB）获取一次性使用令牌以便在certificate.php上进行验证的粗略解决方案，他们也可以在每次其他站点时使用siteA获取令牌需要验证令牌，以便他们可以欺骗验证并为 siteA 申请证书。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:13:31.173

HTTP`Referer`标头（是的，就是这样拼写的！）告诉您这一点。它在您的 PHP 脚本中以`$_SERVER['HTTP_REFERER']`.

（但请注意，不能保证所有浏览器都会提供它，并且它可以被欺骗。不要使用它来执行任何安全策略。）

# ruby-on-rails - RSpec 与设计

> ID：15209197
> 
> 赞同：0
> 
> 时间：2013-03-04T19:12:05.723
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec-rails

我是 Rails 新手 :) 我正在尝试运行我的第一个测试。为什么这个测试通过？用户名应该至少有 2 个字符，我的用户名有更多并且它仍然通过测试。

用户.rb：

```
validates :username, :length => { :minimum => 2 } 
```

user_spec.rb

```
require 'spec_helper'

describe User do

before do
  @user = User.new(username: "Example User", email: "user@example.com",
                   password: "foobar", password_confirmation: "foobar")
end

describe "when name is not present" do
  before { @user.username="aaaahfghg" }
  it { should_not be_valid }   end

end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:28:53.737

```
describe "when name is not present" do
 before {  @user.username = "aaaahfghg" }
 it { should_not be_valid }   
end 
```

首先，您的描述块正在测试错误的东西。如果您想测试“名称不存在”，您应该设置：

> @user.username = "" #使用户名为空。

但是，为了检查用户名是否为空，您应该添加`validates :username, presence: true`. 虽然您可能不需要它，因为您有`{ minimum: 2 }`验证

现在，`@user.username = "aaaahf"`# 一个更好的写法是 'a' * 5 例如，它创建一个由 5 a's = aaaaa 组成的字符串。

这表示您的用户名超过 2 个字符，因此您的验证很好，`{ minimum: 2 }`测试应该通过。

如果您想确保用户名超过 2 个字符，那么

```
@user.username = 'a' 
```

希望有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T21:31:04.283

这一行：

```
it { should_not be_valid } 
```

使用[隐式主语](https://www.relishapp.com/rspec/rspec-core/v/2-0/docs/subject/implicit-subject)。RSpec 自动创建类的实例，`User`然后您可以在`it`块中隐式使用该实例。但是您的测试随后会创建另一个实例并将其分配给`@user`- 这两个实例不相同。

如果你想使用隐式主语，你可以这样做：

```
subject { User.new(args) }
before {  subject.username = "aaaahfghg" }
it { should_not be_valid } 
```

# c++ - 包含目录的 CMAKE 选项

> ID：15209201
> 
> 赞同：2
> 
> 时间：2013-03-04T19:12:17.943
> 
> 标签：c++, opencv, cmake, cross-compiling

我正在尝试在基于 ARM-linux 的系统上编译 OPENCV。为此，我创建了一个带有以下选项的工具链 cmake 文件

```
SET (CMAKE_SYSTEM_NAME Linux)
SET (CMAKE_SYSTEM_VERSION 1)
SET (CMAKE_SYSTEM_PROCESSOR arm)

SET (CMAKE_C_COMPILER "/usr/local/arm/4.3.1-eabi-armv6/usr/bin/arm-linux-gcc")
SET (CMAKE_CXX_COMPILER "/usr/local/arm/4.3.1-eabi-armv6/usr/bin/arm-linux-g++")

SET (CMAKE_FIND_ROOT_PATH "/usr/local/arm/4.3.1-eabi-armv6/")
SET (CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)
SET (CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)
SET (CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY)

SET (LIBRARY_OUTPUT_PATH "/home/xxx/OpenCV-2.4.3/lib")
SET (OPENCV_CONFIG_FILE_INCLUDE_DIR "/home/xxx/OpenCV-2.4.3")
SET (OPENCV_WARNINGS_ARE_ERRORS OFF) 
```

运行 cmake 命令和 make 命令后，出现以下错误：

```
In file included from /usr/local/arm/4.3.1-eabi-armv6/usr/bin-ccache/../lib/gcc/arm-samsung-linux-gnueabi/4.3.1/../../../../arm-samsung-linux-gnueabi/include/c++/4.3.1/bits/postypes.h:47,
             from /usr/local/arm/4.3.1-eabi-armv6/usr/bin-ccache/../lib/gcc/arm-samsung-linux-gnueabi/4.3.1/../../../../arm-samsung-linux-gnueabi/include/c++/4.3.1/iosfwd:47,
             from /usr/local/arm/4.3.1-eabi-armv6/usr/bin-ccache/../lib/gcc/arm-samsung-linux-gnueabi/4.3.1/../../../../arm-samsung-linux-gnueabi/include/c++/4.3.1/ios:44,
             from /usr/local/arm/4.3.1-eabi-armv6/usr/bin-ccache/../lib/gcc/arm-samsung-linux-gnueabi/4.3.1/../../../../arm-samsung-linux-gnueabi/include/c++/4.3.1/ostream:45,
             from /usr/local/arm/4.3.1-eabi-armv6/usr/bin-ccache/../lib/gcc/arm-samsung-linux-gnueabi/4.3.1/../../../../arm-samsung-linux-gnueabi/include/c++/4.3.1/iostream:45,
             from /home/zwang/OpenCV-2.4.3/3rdparty/openexr/Half/half.h:88,
             from /home/zwang/OpenCV-2.4.3/3rdparty/openexr/Half/half.cpp:48:
/usr/local/arm/4.3.1-eabi-armv6/usr/bin-ccache/../lib/gcc/arm-samsung-linux-gnueabi/4.3.1/../../../../arm-samsung-linux-gnueabi/include/c++/4.3.1/cwchar:52:24: error: wchar.h: No such file or directory 
```

总结：编译器找不到wchar.h、stdio.h、wctype.h、ctype.h。这些标头位于 /usr/local/arm/4.3.1-eabi-armv6/usr/include 中。我想我需要使用 cmake 选项包含这个文件夹。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T19:46:08.527

您可以通过以下[`include_directories`](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#command%3ainclude_directories)命令执行此操作：

```
include_directories(SYSTEM /usr/local/arm/4.3.1-eabi-armv6/usr/include) 
```

更健壮的解决方案是在此路径中搜索标头，如果找到则包含该目录，否则将失败。除了比将本地路径硬编码到 CMakeLists.txt 中更健壮之外，另一个好处是它在 CMake 运行时失败，而不是在稍后的构建时失败。最好使用[`find_path`](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#command%3afind_path).

例如，您可以这样做：

```
find_path(WcharPath wchar.h PATHS /usr/local/arm/4.3.1-eabi-armv6/usr/include)
if(WcharPath)
  include_directories(SYSTEM ${WcharPath})
else()
  message(FATAL_ERROR "Failed to find wchar.h")
endif() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-15T13:26:11.450

您可以设置 CMAKE_SYSROOT 来解决这个问题。看起来您应该将其设置为

```
/usr/local/arm/4.3.1-eabi-armv6/ 
```

在这种情况下。

[http://www.cmake.org/cmake/help/v3.0/manual/cmake-toolchains.7.html#cross-compiling](http://www.cmake.org/cmake/help/v3.0/manual/cmake-toolchains.7.html#cross-compiling)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-04T19:18:35.057

您可以设置`CMAKE_INCLUDE_PATH`为环境变量，CMAKE 文档中提供了有关格式的说明：

[http://www.cmake.org/Wiki/CMake_Useful_Variables](http://www.cmake.org/Wiki/CMake_Useful_Variables)

# buddypress - Buddypress 翻译

> ID：15209202
> 
> 赞同：0
> 
> 时间：2013-03-04T19:12:20.827
> 
> 标签：buddypress

无法获取 buddypress 1.6.4。翻译。我已将 .po 和 .mo 文件添加到 buddypress/bp-languages/ 内的插件目录中的 wordpress

文件名为 **buddypress-mysite.po**和 **buddypress-mysite.mo**

我还在{WP-ROOT}/wp-content/plugins 中创建了**bp-custom.php并添加了以下代码：**

```
<?php
define( 'BPLANG', 'mysite' );
if ( file_exists( BP_PLUGIN_DIR . '/bp-languages/buddypress-' . BPLANG . '.po' ) ) {
    load_textdomain( 'buddypress', BP_PLUGIN_DIR . '/bp-languages/buddypress-' . BPLANG . '.po' );
}?> 
```

仍然无法让它工作:(我已经做了一些调试，似乎 bp-custom.php 在域上正确读取，但它不会触发 .mo 和 .po 文件来翻译实际页面。

有人可以帮忙吗？我真的需要这个工作！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T11:01:57.083

我不知道你想要什么语言，但我已经安装了[buddypress-translations](http://wordpress.org/extend/plugins/buddypress-translations/)并且效果很好。

# c# - 下拉列表控件的值更改时的确认

> ID：15209204
> 
> 赞同：0
> 
> 时间：2013-03-04T19:12:31.310
> 
> 标签：c#, javascript, asp.net, .net, web-applications

我的 aspx 中有以下代码（使用 C# 作为后面的代码）。

```
<asp:DropDownList ID="ddlConfirm" runat="server" </asp:DropDownList> 
```

有两个值。是和否。

最初，该值为 Yes。我想在用户选择 NO 后立即显示一个确认弹出框（在任何提交或单击任何内容之前）。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:31:04.653

您可以使用以下 jQuery 来显示消息。

```
<asp:DropDownList ID="ddlConfirm" runat="server" OnChange="ddlConfirmClick()">
</asp:DropDownList>
function ddlConfirmClick() {
   if ($('#<%= ddlConfirm.ClientID %>').val() == "NO") {
      if(confirm("Are you sure you want to continue?")){
         // do something.
      }
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T07:20:22.917

```
 $('#<%= ddlConfirm.ClientID %>').change(function(){
        //on-change code goes in here.
        if (this.val() == "NO") {
        alert("message")
}
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T07:12:11.050

您可以在 javascript 中处理它。

```
<script type='text/javascript'>
    window.onload = function() { HookUpEvent(); }

    function HookUpEvent()
    {
        var comboBox= document.getElementById ( "MyComboId" );
        comboBox.onchange = function () { OnComboSelected( this ); }
    }

    function OnComboSelected(selectedElement)
    {
        if(selectedElement.value == 'No')
        {
           alert('Your warning message!');
        } 
        return false;  
    }
</script> 
```

请注意，这里的关键是`return false;`- 您需要它来防止页面回发。

您可以通过简单地返回有条件地继续回发`true`。

# matlab - 如何在 MATLAB 中读取制表符分隔的文本文件，该文件主要包含数字，但有时在几个单元格中包含单词 MAX？

> ID：15209211
> 
> 赞同：2
> 
> 时间：2013-03-04T19:13:05.763
> 
> 标签：matlab, readfile, csv

我想使用 MATLAB 从制表符分隔的文本文件中读取一系列单元格。这个单元格范围应该是数字，但最近提供这些数字的软件已将单词 MAX 放在数字太大的位置。这意味着我现在正在查看的单元格范围包含一些字符串，表示 MAX，其余的是数值。

到目前为止，我一直在使用 dlmread 来读取这个数值范围，并且它工作正常。当有 MAX 时， dlmread 不起作用。

这是我用来读取数据的代码：

```
data = dlmread(filename, '\t', 20, 5); 
```

这是错误：

```
Mismatch between file and format string.
Trouble reading number from file (row 152u, field 31u) ==> MAX
MAX MAX 552.397949  33.415199   7.425600    3.379600
6.6422090   \n 
```

有什么方法可以在不将其转换为 .csv 的情况下读取此文件？我想读入文件并将显示 MAX 的单元格更改为 1500 之类的数字。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T20:21:06.500

你可以试试[`textscan`](http://www.mathworks.de/de/help/matlab/ref/textscan.html)

```
C = textscan(fid, '%f', 'delimiter', '\t', 'treatAsEmpty', {'MAX'},'EmptyValue', 1500); 
```

这将返回一个 1 x N 单元格向量，其中 N 是文件中值的数量。要将其转换为矩阵，您可以使用[`reshape`](http://www.mathworks.de/de/help/matlab/ref/reshape.html)

```
C = reshape(cell2mat(C),[numOfRows numOfCols]); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-23T13:42:48.227

[http://www.mathworks.se/help/stats/tblread.html](http://www.mathworks.se/help/stats/tblread.html)看起来是一个很好的函数，用法很简单：

数据=tblread('data.tsv','\t')

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T19:24:22.763

最简单的方法可能是简单地预处理文件，对“MAX”进行搜索和替换，用“inf”或您选择的数字（即1500）交换它。

# jquery - jQuery cycle2 'cycle-before/after' 仅适用于第一次转换

> ID：15209213
> 
> 赞同：1
> 
> 时间：2013-03-04T19:13:09.217
> 
> 标签：jquery, slideshow, jquery-cycle2

这是关于 Cycle2： http: [//www.malsup.com/jquery/cycle2/](http://www.malsup.com/jquery/cycle2/)

我有一个包含图像和`div`内容描述的幻灯片。目标是首先在图像转换后使描述淡入。我正在尝试使用`'cycle-before'`and`'cycle-after'`来实现这一点。

```
$('#slider').cycle({
    slides: '>li',
    timeout: 5000
});
$('#slider').on( 'cycle-before', function( event, opts ) {
    $('.descriptiontext').fadeOut(); 
});
$('#slider').on( 'cycle-after', function( event, opts ) {
    $('.descriptiontext',this).delay(1000).fadeIn(1000);
}); 
```

但我不认为我了解如何使用此功能。在我的实际版本中，只有第一个转换有描述延迟。在下面的 Fiddle 示例中，它根本不起作用。帮助！

[http://jsfiddle.net/56wQY/1/](http://jsfiddle.net/56wQY/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T22:06:01.387

我复制了所有参数，并按照提供的方式使用传入、传出的幻灯片。我确信有一种不那么冗长的方法可以做到这一点，但至少它有效。

```
$('#slider').cycle({
    slides: '>li',
    timeout: 5000
});

$('#slider').on( 'cycle-before', function(event, optionHash, outgoingSlideEl, incomingSlideEl, forwardFlag) {
    $('.descriptiontext',outgoingSlideEl).fadeOut(); 
});

$('#slider').on( 'cycle-after', function(event, optionHash, outgoingSlideEl, incomingSlideEl, forwardFlag) {
    $('.descriptiontext',incomingSlideEl).delay(1000).fadeIn(1000);
}); 
```

# c++ - 如何处理 HTTP 请求

> ID：15209214
> 
> 赞同：0
> 
> 时间：2013-03-04T19:13:10.033
> 
> 标签：c++, sockets, http, webserver

当浏览器请求一个网页时，浏览器会发送大量请求。您需要如何处理这些请求？我可以接受所有这些多线程页面并将结果发回（使用发送锁定），还是我只需要接受一个数据包并发送结果，接受另一个数据包并发送结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:27:44.980

我建议在你走得更远之前复习一下 TCP/IP 网络、套接字编程和 HTTP 协议的一些基础知识。

建议：

1) 查看[Beej 的网络编程指南](http://beej.us/guide/bgnet/)

2) 这里有一些关于 HTTP 的链接以及它是如何工作的：

*   [http://www.jmarshall.com/easy/http/](http://www.jmarshall.com/easy/http/)

*   [http://www.w3.org/Protocols/rfc2616/rfc2616.html](http://www.w3.org/Protocols/rfc2616/rfc2616.html)

*   [http://en.wikipedia.org/wiki/Http](http://en.wikipedia.org/wiki/Http)

3) 首先，我肯定会得到一份 Wireshark 的副本，并在您的浏览器和某些服务器之间跟踪几个简单的 HTTP 请求和响应：

*   [http://www.wireshark.org](http://www.wireshark.org)

恕我直言...

# json - JSON分页 - 休眠，春天

> ID：15209215
> 
> 赞同：2
> 
> 时间：2013-03-04T19:13:12.303
> 
> 标签：json, hibernate

我是 JSON 和休眠的新手。我相信我知道如何在休眠中进行分页，但不确定如何使用 JSON 显示带有页面信息的数据。我想有以下格式的输出：

```
{
"page" : 1,
"pagesize" : 10,
"pagecount" : 3,
"models" : [{"id":1, "name":"text1"}, {"id":2, "name":"text2"}, {"id":3, "name":"text3"}]
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:30:23.763

Spring 将使用您传递给它的任何数据将您的 modelMap 转换为 JSON。所以如果你调用了这个控制器方法：

```
@RequestMapping("/test")
public @ResponseBody ModelAndView sample() {
    ModelMap model = new ModelMap();
    model.put("foo", "bar");
    return new ModelAndView("jsonView", model);
} 
```

你会在回复中得到这个：

```
{
    "foo": "bar"
} 
```

在控制器中正确设置您的模型，让 Spring 处理其余的工作。

# git - git 分支显示相同的内容

> ID：15209217
> 
> 赞同：1
> 
> 时间：2013-03-04T19:13:28.800
> 
> 标签：git, branching-and-merging

我是 git 新手，正在学习分支和合并。

当我执行以下操作时：

> git checkout -b 测试

创建了一个新分支，我切换到该分支。当我：

> vim 测试文件

并输入一些文本并保存，测试文件按预期创建。但是，当我通过以下命令更改到另一个分支时：

> git结账大师

或者

> git checkout 无关分支

我发现 testfile 也存在于这些具有相同内容的其他分支中。

这种行为与我对分支如何工作的理解不一致。一些互联网资源表明我在这里使用的命令是需要的。

有人可以告诉我我做错了什么或为什么这是理想的行为吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T19:19:35.287

`testfile`未跟踪，并且您的更改未提交。

因此，`testfile` *不是*在所有分支上。它*不在*树枝上。Git 甚至不知道它的存在，因此它在切换分支时无法将其从工作目录中清除。这是有用的（如果出乎意料的）行为，因为您不想让 git 弄乱未跟踪的文件。

做：

```
git add testfile
git commit -m "Adding testfile to branch test"
git checkout master 
```

你会看到 testfile 消失了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T19:20:09.487

看起来`testfile`不受版本控制。

尝试`git status`先运行以查看它是否`testfile`在`Untracked files`.

例子：

```
git status
# On branch master
# Untracked files:
#   (use "git add <file>..." to include in what will be committed)
#
#   testfile
no changes added to commit (use "git add" and/or "git commit -a") 
```

如果您在上面的示例中看到类似下面的`testfile`列表，则需要使用该命令`untracked files`将其添加到版本控制中。`git add`

```
git add testfile 
```

最后，不要忘记使用提交更改`git commit`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-04T19:15:27.613

这可能是因为该文件没有被跟踪。

尝试做：`git add testfile`将其添加到新分支。

# ruby-on-rails - Ruby on Rails 未安装

> ID：15209234
> 
> 赞同：2
> 
> 时间：2013-03-04T19:14:11.383
> 
> 标签：ruby-on-rails, windows-7-x64

在 Win7 机器上

我正在尝试安装 RoR，当我输入：

导轨新的“路径”

一切似乎都很好，但突然间我收到以下消息。

这条消息是在它说运行捆绑安装之后出现的

**“无法验证[https://rubygems.org/](https://rubygems.org/)的 SSL 证书。您有可能遇到中间人攻击，但很可能您的系统没有验证所需的 CA 证书。有关 OpenSSL 证书的信息，请参阅 bit.ly/ssl-certs。要在不使用 SSL 的情况下进行连接，请编辑您的 Gemfile 并将“https”更改为“http”。”**

答案可能是将 https 更改为 http，但我找不到执行此操作的文件。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:27:42.937

`Gemfile`在您的新 RoR 项目的根目录中有一个名为的文件。它包含这一行：

```
source "https://rubygems.org" 
```

只需将其更改为

```
source "http://rubygems.org" 
```

之后你只需要`bundle install`再次跑步

附带说明一下，您可能会认真考虑在 Linux VM 上进行开发。Windows RoR 会很痛苦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T10:30:17.527

需要良好的 SSL 证书来证明收到的 gem 足够值得信赖以运行代码，具体取决于预期用途。否则，您下载 MITM 修改代码的机会很小但很长。

Ruby 安装很可能存在问题......我在 Mac 上使用 brew'd OpenSSL 1.0.1c 而不是 1.0.1e 时遇到问题。

[http://railsapps.github.com/openssl-certificate-verify-failed.html](http://railsapps.github.com/openssl-certificate-verify-failed.html)

在 2.0.0 成熟之前，请务必使用最新的 1.9.3（撰写本文时为 p392）Ruby 安装程序。

[http://rubyforge.org/frs/download.php/76798/rubyinstaller-1.9.3-p392.exe](http://rubyforge.org/frs/download.php/76798/rubyinstaller-1.9.3-p392.exe)

并与此处的校验和进行比较：

[https://cdn.rubyinstaller.org/checksums/rubyinstaller-20130224.md5](https://cdn.rubyinstaller.org/checksums/rubyinstaller-20130224.md5)

# ruby-on-rails - Google Chrome - 防止在 Rails 应用程序中刷新时重新提交表单

> ID：15209235
> 
> 赞同：2
> 
> 时间：2013-03-04T19:14:11.793
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我是 Rails3 的新手，我正在构建非常简单的应用程序（我不想要 AJAX）。无论如何，我有`index`和`create`行动。该`index`动作包含以下形式：

```
<%= form_for @message, url: promote_index_path do |f| %>
 ...
<% end %> 
```

我的`promote_controller`样子是这样的：

```
 def index
    @message = Message.new url: @last_video, message_body: @last_message
  end

  def create
    @message = current_user.messages.new(params[:message])
    @message.get_video_id
    if @message.save
      redirect_to promote_index_url, flash: {notice: "Promotion has been started"}
    else
      render 'index'
    end
  end 
```

这一切都很好，除了表单提交成功，并且通知闪烁，如果用户点击`F5`，表单会重新提交。这不应该是这种情况，因为我是`redirect_to`在成功保存后做的。我相信我在这里做的事情根本上是错误的，所以请帮帮我。

编辑：这是我的`routes.rb`

```
 resources :home
  resources :find
  resources :promote
  resources :settings
  root to: 'home#index'
  match 'auth/:provider/callback', to: 'sessions#create'
  match 'auth/failure', to: redirect('/')
  match 'logout', to: 'sessions#destroy', as: 'logout'
  match 'find', to: 'find#index', as: 'find'
  match 'promote', to: 'promote#index', as: 'promote'
  match 'settings', to: 'settings#index', as: 'settings' 
```

这是我的`rake routes`

```
Jans-MacBook-Pro-2:tp3 jan$ rake routes
settings_index GET    /settings/index(.:format)          settings#index
    home_index GET    /home(.:format)                    home#index
               POST   /home(.:format)                    home#create
      new_home GET    /home/new(.:format)                home#new
     edit_home GET    /home/:id/edit(.:format)           home#edit
          home GET    /home/:id(.:format)                home#show
               PUT    /home/:id(.:format)                home#update
               DELETE /home/:id(.:format)                home#destroy
    find_index GET    /find(.:format)                    find#index
               POST   /find(.:format)                    find#create
      new_find GET    /find/new(.:format)                find#new
     edit_find GET    /find/:id/edit(.:format)           find#edit
          find GET    /find/:id(.:format)                find#show
               PUT    /find/:id(.:format)                find#update
               DELETE /find/:id(.:format)                find#destroy
 promote_index GET    /promote(.:format)                 promote#index
               POST   /promote(.:format)                 promote#create
   new_promote GET    /promote/new(.:format)             promote#new
  edit_promote GET    /promote/:id/edit(.:format)        promote#edit
       promote GET    /promote/:id(.:format)             promote#show
               PUT    /promote/:id(.:format)             promote#update
               DELETE /promote/:id(.:format)             promote#destroy
      settings GET    /settings(.:format)                settings#index
               POST   /settings(.:format)                settings#create
   new_setting GET    /settings/new(.:format)            settings#new
  edit_setting GET    /settings/:id/edit(.:format)       settings#edit
       setting GET    /settings/:id(.:format)            settings#show
               PUT    /settings/:id(.:format)            settings#update
               DELETE /settings/:id(.:format)            settings#destroy
          root        /                                  home#index
                      /auth/:provider/callback(.:format) sessions#create
  auth_failure        /auth/failure(.:format)            :controller#:action
        logout        /logout(.:format)                  sessions#destroy
          find        /find(.:format)                    find#index
       promote        /promote(.:format)                 promote#index
      settings        /settings(.:format)                settings#index 
```

编辑：问题似乎出在谷歌浏览器中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T18:53:18.263

我遇到了同样的问题，并最终将其归结为 Chrome 中的一个错误（[https://code.google.com/p/chromium/issues/detail?id=177855](https://code.google.com/p/chromium/issues/detail?id=177855)）

我使用的解决方法只是添加一些获取参数。以下是我处理错误和挫折的方式。结果可能不适用于所有场景。幸运的是我的应用程序是内部的。

```
def create
  @message = current_user.messages.new(params[:message])
  @message.get_video_id
  if @message.save
    flash[:notice] = "Promotion has been started"
    redirect_to promote_index_url(chrome_bug_workaround: 177855)
  else
    render 'index'
  end
end 
```

另一种选择是创建一个基本上是索引别名的收集路由。

在`routes.rb`：

```
match 'promote/all' => 'promote#index', :as => 'all_promotions' 
```

在`promote_controller.rb`：

```
def create
  @message = current_user.messages.new(params[:message])
  @message.get_video_id
  if @message.save
    redirect_to all_promotions_url, flash: {notice: "Promotion has been started"}
  else
    render 'index'
  end
end 
```

顺便说一句，您的`find`、`promote`和`settings`match 路由似乎与资源路由的索引操作是多余的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T20:28:47.113

尝试将您的方法更改为：

```
def index
    @message = Message.new url: @last_video, message_body: @last_message

    respond_to do |format|
      format.html
    end
  end

  def create
    @message = current_user.messages.new(params[:message])
    @message.get_video_id

    respond_to do |format|
      if @message.save
        format.html {redirect_to promote_index_url, notice: "Promotion has been started"}
      else
        render 'index'
      end
    end
  end 
```

# templates - 使用 FuncMap 的多个模板

> ID：15209236
> 
> 赞同：4
> 
> 时间：2013-03-04T19:14:12.683
> 
> 标签：templates, text, go

目标：在我想将换行符更改为`<br/>`某些字符串上的标签的 HTTP 服务器中使用多个模板。

一个精简的例子：

我有两个模板`a.tmpl`，`b.tmpl`看起来像这样：

```
Template a {{dosomething}} 
```

（和其他模板类似）。两者都驻留在一个名为`templates`. 我相信我需要创建一个函数来执行`\n`->`<br />`替换（`dosomething`上面）。

这是我的（非工作）示例代码：

```
package main

import (
    "log"
    "text/template"
)

func main() {
    // funcMap := template.FuncMap{
    //  "dosomething": func() string { return "done something" },
    // }

    templates, err := template.ParseGlob("templates/*.tmpl")
    if err != nil {
        log.Fatal(err)
    }
    log.Printf("%#v", templates)

} 
```

错误信息是：

```
2013/03/04 20:08:19 template: a.tmpl:1: function "dosomething" not defined
exit status 1 
```

这是有道理的，因为在解析期间，函数`dosomething`是未知的。

1.  如何在多个模板中使用我的函数？[这个问题](https://stackoverflow.com/questions/10199219/go-template-function)的答案是唯一的出路吗？
2.  这是正确的方法吗？请记住，我想更改一些字符串上的文本，类似于文档中的标题示例（[http://golang.org/pkg/text/template/#FuncMap](http://golang.org/pkg/text/template/#FuncMap) - Example (Func)）？
3.  如何`b.tmpl`在以下代码中访问：

    ```
    package main

    import (
        "log"
        "text/template"
    )

    func main() {
        funcMap := template.FuncMap{
            "dosomething": func() string { return "done something" },
        }

        t, err := template.New("a.tmpl").Funcs(funcMap).ParseGlob("templates/*.tmpl")
        if err != nil {
            log.Fatal(err)
        }
        log.Printf("%#v", t)
    } 
    ```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T20:59:34.820

你的最后一段代码对我来说看起来很合适。

要渲染 b.tmpl，只需调用

```
t.ExecuteTemplate(w, "b.tmpl", data) 
```

你可以用同样的方式访问a.tmpl；我建议这样做是为了保持一致性，而不是在对 New 的调用中将名称设置为“a.tmpl”。

# kml - KML：180 线的 GroundOverlay 问题

> ID：15209239
> 
> 赞同：1
> 
> 时间：2013-03-04T19:14:23.280
> 
> 标签：kml

我有一张需要叠加为跨越 180 线的 GroundOverlay 的图像。

前任： `<north>65.93</north><south>52.84</south><east>-178.55</east><west>-191.65</west>`

我只得到 -178.55 到 -180 - 其余的都不见了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:42:39.460

尤其是 Google 地球和许多地图应用程序，通常会在穿过反子午线（-180/+180 经度）的线或叠加层出现错误。

一些相关错误：
[https ://code.google.com/p/earth-issues/issues/detail?id=1145](https://code.google.com/p/earth-issues/issues/detail?id=1145)
[https://code.google.com/p/earth-issues/issues/detail?id=1340](https://code.google.com/p/earth-issues/issues/detail?id=1340)
[https://code.google.com/p/earth-issues/issues/detail?id=1348](https://code.google.com/p/earth-issues/issues/detail?id=1348)

解决此错误的唯一方法是将地面叠加层分成两个图像，每个图像都接触但不越过 180 线。

请注意，Google 地球中的经度在 [-180, +180] 范围内，因此 -191.65 归一化为 +168.35。

在您的 KML 中使用这些区域：

```
<north>65.93</north><south>52.84</south><east>-178.55</east><west>-180</west>
<north>65.93</north><south>52.84</south><east>180</east><west>168.35</west> 
```

# grails - Grails 中元标记中的属性被自动转义

> ID：15209240
> 
> 赞同：1
> 
> 时间：2013-03-04T19:14:28.970
> 
> 标签：grails, tags

我在 Grails 中遇到了元属性被双重转义的问题，例如：
`<meta name="title" content="${'bla bla "bla"'.encodeAsHTML()}" />`
正在成为：
`<meta name="title" content="bla bla &amp;quot;bla&amp;quot;">`
显然删除 encodeAsHTML() 会停止双重转义，但这很奇怪，因为没有其他任何东西自动转义，而且我不确定还有什么可能被自动转义。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T19:14:28.970

事实证明`meta`，标签`title`的`body`属性`.encodeAsHTML()`在`SiteMeshTagLib.groovy`.

这真的应该记录在某个地方，因为我找不到任何提及它并认为它可能是一个错误。

# java - 应用服务器实现的 JDBC 数据源

> ID：15209242
> 
> 赞同：0
> 
> 时间：2013-03-04T19:14:31.303
> 
> 标签：java, postgresql, jdbc

我正在学习数据源，我想我已经开始理解它了，但是这一段我不明白。

据我所知，MySQL 和 PostgreSQL 等数据库供应商编写了他们自己的不同 DataSource 接口的实现。现在，这还不够吗？应用服务器应该提供 DataSource 实现是什么意思？这样做的原因是什么？

> ConnectionPoolDataSource 的 PostgreSQL 实现。应用服务器或中间件供应商应提供利用此 ConnectionPoolDataSource 的 DataSource 实现。如果没有，您可以使用称为 PoolingDataSource 的 PostgreSQL 实现，但仅当您的服务器或中间件供应商不提供他们自己的时才应使用。为什么？服务器可能希望在同一事务中请求连接的所有 EJB 中重用相同的连接，或者提供其他类似的高级特性。

[http://jdbc.postgresql.org/documentation/publicapi/org/postgresql/ds/PGConnectionPoolDataSource.html](http://jdbc.postgresql.org/documentation/publicapi/org/postgresql/ds/PGConnectionPoolDataSource.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T20:07:41.910

通常，webapp DataSource 将委托给 PostgreSQL 实现。这允许 webapp 中的监控和其他功能，如果您管理自己的数据源，这些功能将不可用。

# java - 使用 jdom 将内容添加到现有 xml

> ID：15209245
> 
> 赞同：4
> 
> 时间：2013-03-04T19:14:44.040
> 
> 标签：java, xml, class, document, jdom

```
package xml.dierenshop.flaming.v1;

import org.jdom2.Document;
import org.jdom2.Element;
import org.jdom2.output.XMLOutputter;
import org.jdom2.output.Format;
import java.io.FileWriter;
import java.io.IOException;

public class Writer {

    public void Writer(String categorie, String code, String naamartikel, String beschrijvingartikel, double prijz, String imgurl, String imgurl2, String imgurl3, String imgurl4, String imgurl5) {
        String prijs = String.valueOf(prijz);
        Document document = new Document();
        Element root = new Element("productlist");
        String naamelement = "naam";
        String categorieelement = "category";
        String descriptionelement = "description";
        Element child = new Element("product");
        child.addContent(new Element(categorieelement).setText(categorie));
        child.addContent(new Element("code").setText(code));
        child.addContent(new Element(naamelement).setText(naamartikel));
        child.addContent(new Element(descriptionelement).setText(beschrijvingartikel));
        child.addContent(new Element("price").setText(prijs));
        child.addContent(new Element("image").setText(imgurl));
        child.addContent(new Element("image").setText(imgurl2));
        child.addContent(new Element("image").setText(imgurl3));
        child.addContent(new Element("image").setText(imgurl4));
        child.addContent(new Element("image").setText(imgurl5));
        root.addContent(child);
        document.setContent(root);
        try {
            FileWriter writer = new FileWriter("products.xml");
            XMLOutputter outputter = new XMLOutputter();
            outputter.setFormat(Format.getPrettyFormat());
            outputter.output(document, writer);
            outputter.output(document, System.out);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
} 
```

这是我用主类中的变量编写 xml 文件的类。这里的输出是：

[http://pastebin.com/nFtiv2b8](http://pastebin.com/nFtiv2b8)

现在我有一个问题，下次我运行这个 java 应用程序时，我希望它添加一个新产品，但保留旧产品。但是每次我尝试这个时，它都会用新数据替换旧数据。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-04T20:18:49.970

基本上，您需要加载一个现有的 xml 文件并`Document`通过解析它并从中获取根元素来制作它。如果文件不存在，则创建一个新文档和一个新的根元素。之后，您可以继续使用您显示的代码。

创建一个类`Product`来保存产品数据。将每个产品数据作为参数传递给方法是不行的。

产品类（为简单起见，所有字段都是公共的，这不是一个好习惯，您应该至少使它们受到保护，并且每个字段都有一个 getter 和一个 setter 方法）

```
public class Product {
    public String categorie;
    public String code;
    public String naamartikel;
    public String beschrijvingartikel;
    public double prijz;
    public String imgurl;
    public String imgurl2;
    public String imgurl3; 
    public String imgurl4;
    public String imgurl5;
} 
```

写入器方法

```
public static void Writer(Product product) throws JDOMException, IOException {

    Document document = null;
    Element root = null;

    File xmlFile = new File("products.xml");
    if(xmlFile.exists()) {
        // try to load document from xml file if it exist
        // create a file input stream
        FileInputStream fis = new FileInputStream(xmlFile);
        // create a sax builder to parse the document
        SAXBuilder sb = new SAXBuilder();
        // parse the xml content provided by the file input stream and create a Document object
        document = sb.build(fis);
        // get the root element of the document
        root = document.getRootElement();
        fis.close();
    } else {
        // if it does not exist create a new document and new root
        document = new Document();
        root = new Element("productlist");
    }

    String prijs = String.valueOf(product.prijz);
    String naamelement = "naam";
    String categorieelement = "category";
    String descriptionelement = "description";
    Element child = new Element("product");
    child.addContent(new Element(categorieelement).setText(product.categorie));
    child.addContent(new Element("code").setText(product.code));
    child.addContent(new Element(naamelement).setText(product.naamartikel));
    child.addContent(new Element(descriptionelement).setText(product.beschrijvingartikel));
    child.addContent(new Element("price").setText(prijs));
    child.addContent(new Element("image").setText(product.imgurl));
    child.addContent(new Element("image").setText(product.imgurl2));
    child.addContent(new Element("image").setText(product.imgurl3));
    child.addContent(new Element("image").setText(product.imgurl4));
    child.addContent(new Element("image").setText(product.imgurl5));
    root.addContent(child);
    document.setContent(root);
    try {
        FileWriter writer = new FileWriter("products.xml");
        XMLOutputter outputter = new XMLOutputter();
        outputter.setFormat(Format.getPrettyFormat());
        outputter.output(document, writer);
        outputter.output(document, System.out);
        writer.close(); // close writer
    } catch (IOException e) {
        e.printStackTrace();
    }
} 
```

最后是一个小测试

```
public static void main(String[] args) throws JDOMException, IOException {
    Product product = null;

    product = new Product();
    product.categorie = "cat1";
    product.code = "code1";
    product.naamartikel = "naam1";
    product.beschrijvingartikel = "beschrijving1";
    product.prijz = 100d;
    product.imgurl = "http://localhost/img1.png";
    product.imgurl2 = "http://localhost/img2.png";
    product.imgurl3 = "http://localhost/img3.png";
    product.imgurl4 = "http://localhost/img5.png";
    product.imgurl5 = "http://localhost/img5.png";
    Writer(product);

    product = new Product();
    product.categorie = "cat2";
    product.code = "code2";
    product.naamartikel = "naam2";
    product.beschrijvingartikel = "beschrijving2";
    product.prijz = 200d;
    product.imgurl = "http://localhost/img21.png";
    product.imgurl2 = "http://localhost/img22.png";
    product.imgurl3 = "http://localhost/img23.png";
    product.imgurl4 = "http://localhost/img25.png";
    product.imgurl5 = "http://localhost/img25.png";
    Writer(product);

    product = new Product();
    product.categorie = "cat3";
    product.code = "code3";
    product.naamartikel = "naam3";
    product.beschrijvingartikel = "beschrijving3";
    product.prijz = 300d;
    product.imgurl = "http://localhost/img31.png";
    product.imgurl2 = "http://localhost/img32.png";
    product.imgurl3 = "http://localhost/img33.png";
    product.imgurl4 = "http://localhost/img35.png";
    product.imgurl5 = "http://localhost/img35.png";
    Writer(product);
} 
```

此外，文件名`products.xml`不应在 java 文件中硬编码；而是在运行程序时将其作为参数传递。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-05-20T21:52:25.830

替换`root=document.getRootElement();`为

```
root = document.detachRootElement(); 
```

因为一个元素只能与 jdom 中的一个文档相关联。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2015-05-19T21:15:17.807

在将 root 设置为文档内容之前使用：

```
root = root.detach(); 
```

因为一个元素只能与 jdom 中的一个文档相关联。

# php - SQL 嵌套插入查询

> ID：15209249
> 
> 赞同：1
> 
> 时间：2013-03-04T19:14:51.147
> 
> 标签：php, mysql, insert

我今天有一个数据库，其中包含 3 个用于测试用例中的统计信息的查询。我使用 php 构建网站，但查询执行时间过长，因此我无法显示完整的网站统计信息，因为我不想这样做。因为现在数据库很少批量更新，所以我可以为此目的每天/每周更新数据库。

我今天有以下 3 个查询来显示我想要的信息：

```
SELECT key FROM testcase GROUP BY key; 
```

这给了我一个包含 4-10 组测试的 int 列表。对于争论的情况说 1,2,3,4。然后，我在子查询中将其作为键进行迭代，以通过以下 2 个查询获得通过的测试数和未通过的测试数：

```
SELECT COUNT(*) AS passed FROM testcase INNER JOIN testcases ON 
  testcase.ID = testcases.testcaseid WHERE pass = 1 AND key = %value%; 
```

和

```
SELECT COUNT(*) AS failed FROM testcase INNER JOIN testcases ON 
  testcase.ID = testcases.testcaseid WHERE pass = 0 AND key = %value%; 
```

这就是今天的工作方式。每个键的查询大约需要 25-30 秒，这会使站点超时。（%value% 是 for 循环中当前值的伪代码）

相反，我正在考虑一个 sql 查询，将其添加到一个数据库表中，该表由我每天/每周填充的键、通过、失败表组成，以在网站上显示为统计信息。我已经看到了一些可以使用子查询进行迭代的情况，但是由于 2 个执行的查询是相反的，所以我看不到任何解决方案。

我尝试索引我在查询中使用的值但没有成功（这也可能是错误的）。

// Andreas（SQL 新手）

**编辑：**

哦，困境，在哪里设置解决方案，我从 Gordon 和 Joe 那里做了一个组合，以做出最快的查询，就像一个魅力：

```
INSERT INTO statistics (key,passed,failed)
  SELECT
    key,
    SUM(case when T.pass = 1 then T.matches else 0 end) as passed,
    SUM(case when T.pass = 0 then T.matches else 0 end) as failed
  FROM
    (SELECT
      key,pass,COUNT(*) AS matches
    FROM testcase INNER JOIN testcases ON
      testcase.ID = testcases.testcaseid
    GROUP BY key,pass)T
  GROUP BY key 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:21:54.713

I think you should do this all with one query, that returns the key and the information you want:

```
select key,
         SUM(case when pass = 1 AND key = %value% then 1 else 0 end) as passed,
         SUM(case when pass = 0 AND key = %value% then 1 else 0 end) as failed
from testcase INNER JOIN testcases ON 
      testcase.ID = testcases.testcaseid 
group by key 
```

To the extent possible, you should let the database do the "iterations" and just read back the resulting data.

In response to your comment. If you have a list of keys in $VALUE, then you could do:

```
insert into statistics(key, pass, fail)
    select key,
           SUM(case when pass = 1 then 1 else 0 end) as passed,
           SUM(case when pass = 0 then 1 else 0 end) as failed
    from testcase INNER JOIN testcases ON 
         testcase.ID = testcases.testcaseid 
    where concat(',', $VALUE, ',') like concat('%', key, '%')
    group by key 
```

Or, if you are generating the query, you can put the list in an `in` clause. So, the `where` could look like:

```
where key in (2, 3, 4, 5) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T19:18:24.253

尝试：

```
select key, pass, count(*) from testcase group by key, pass 
```

上的索引`pass`将毫无用处。上的索引`key`，这应该会有所帮助。但是基数为 4-10，嗯，不会很有帮助。

# php - 如何使用 URL 参数

> ID：15209250
> 
> 赞同：-5
> 
> 时间：2013-03-04T19:14:55.100
> 
> 标签：php, mysql, url, parameters

您如何使这样的 url 参数起作用？：

/searchtestingv4.php?categories=rockandpop&sort=PriceLow

或者

/searchtestingv4.php?sort=PriceLow&page=2

这是我尝试的地方： http: [//tinyurl.com/bv6fm7b](http://tinyurl.com/bv6fm7b)

这是我的代码：

分页：

```
$tableName="searchacts";        
    $targetpage = "searchtestingv4.php";    
    $limit = 5; 

    $query = "SELECT COUNT(*) as num FROM $tableName";
    $total_pages = mysql_fetch_array(mysql_query($query));
    $total_pages = $total_pages[num];

    $stages = 3;
    $page = mysql_escape_string($_GET['page']);
    if($page){
        $start = ($page - 1) * $limit; 
    }else{
        $start = 0; 
        }   

    // Get page data
    $query = "SELECT * FROM $tableName LIMIT $start, $limit";
    $result = mysql_query($query);

    // Initial page num setup
    if ($page == 0){$page = 1;}
    $prev = $page - 1;  
    $next = $page + 1;                          
    $lastpage = ceil($total_pages/$limit);      
    $LastPagem1 = $lastpage - 1;                    

    $paginate = '';
    if($lastpage > 1)
    {   

        $paginate .= "<div class='paginate'>";
        // Previous
        if ($page > 1){
            $paginate.= "<a href='$targetpage?page=$prev'>previous</a>";
        }else{
            $paginate.= "<span class='disabled'>previous</span>";   }

        // Pages    
        if ($lastpage < 7 + ($stages * 2))  // Not enough pages to breaking it up
        {   
            for ($counter = 1; $counter <= $lastpage; $counter++)
            {
                if ($counter == $page){
                    $paginate.= "<span class='current'>$counter</span>";
                }else{
                    $paginate.= "<a href='$targetpage?page=$counter'>$counter</a>";}                    
            }
        }
        elseif($lastpage > 5 + ($stages * 2))   // Enough pages to hide a few?
        {
            // Beginning only hide later pages
            if($page < 1 + ($stages * 2))       
            {
                for ($counter = 1; $counter < 4 + ($stages * 2); $counter++)
                {
                    if ($counter == $page){
                        $paginate.= "<span class='current'>$counter</span>";
                    }else{
                        $paginate.= "<a href='$targetpage?page=$counter'>$counter</a>";}                    
                }
                $paginate.= "...";
                $paginate.= "<a href='$targetpage?page=$LastPagem1'>$LastPagem1</a>";
                $paginate.= "<a href='$targetpage?page=$lastpage'>$lastpage</a>";       
            }
            // Middle hide some front and some back
            elseif($lastpage - ($stages * 2) > $page && $page > ($stages * 2))
            {
                $paginate.= "<a href='$targetpage?page=1'>1</a>";
                $paginate.= "<a href='$targetpage?page=2'>2</a>";
                $paginate.= "...";
                for ($counter = $page - $stages; $counter <= $page + $stages; $counter++)
                {
                    if ($counter == $page){
                        $paginate.= "<span class='current'>$counter</span>";
                    }else{
                        $paginate.= "<a href='$targetpage?page=$counter'>$counter</a>";}                    
                }
                $paginate.= "...";
                $paginate.= "<a href='$targetpage?page=$LastPagem1'>$LastPagem1</a>";
                $paginate.= "<a href='$targetpage?page=$lastpage'>$lastpage</a>";       
            }
            // End only hide early pages
            else
            {
                $paginate.= "<a href='$targetpage?page=1'>1</a>";
                $paginate.= "<a href='$targetpage?page=2'>2</a>";
                $paginate.= "...";
                for ($counter = $lastpage - (2 + ($stages * 2)); $counter <= $lastpage; $counter++)
                {
                    if ($counter == $page){
                        $paginate.= "<span class='current'>$counter</span>";
                    }else{
                        $paginate.= "<a href='$targetpage?page=$counter'>$counter</a>";}                    
                }
            }
        }

                // Next
        if ($page < $counter - 1){ 
            $paginate.= "<a href='$targetpage?page=$next'>next</a>";
        }else{
            $paginate.= "<span class='disabled'>next</span>";
            }

        $paginate.= "</div>";       

}
 echo $total_pages.' Results';
 // pagination
 echo $paginate; 
```

按位置过滤的类别：

```
if($_GET['categories'] == 'rockandpop') {   

        $query = "SELECT * FROM searchacts WHERE category='Rock and Pop'";   
    } 

        if($_GET['categories'] == 'tributebands') {   

        $query = "SELECT * FROM searchacts WHERE category='Tribute Bands'";   
    } 
```

由 where 过滤的最高价格，例如：

```
// process form when posted 
if(isset($_GET['upto'])) { 
    if($_GET['upto'] == 'upto100') { 

        $query = "SELECT * FROM searchacts WHERE price <= '100'";   
    } 
```

按选项排序，例如：

```
// process form when posted 
if(isset($_GET['sort'])) { 
    if($_GET['sort'] == 'PriceLow') { 

        $query = "SELECT * FROM searchacts ORDER BY price ASC";   
    } 
```

表格例如：

```
<div id="sortingcontainer"> <span class="sortbyheader">Sort By:</span>
<form action='<?php echo $_SERVER['PHP_SELF']; ?>' method='get' name='form_filter' class="sortoptions" >  
  <select name="sort">  
      <option value="all">All</option>  
      <option value="PriceLow">Price (Low to High)</option>  
      <option value="PriceHigh">Price (High to Low)</option>  
      <option value="NameAZ">Name (A-Z)</option>  
      <option value="NameZA">Name (Z-A)</option>  
      </select>  
    <br />  
    <input type='submit' value = 'Re-Order your results'>  
</form>
  </div>
    <div id="sortingcontainer"> <span class="sortbyheader">Sort By:</span>
<form action='<?php echo $_SERVER['PHP_SELF']; ?>' method='get' name='form_filter' class="sortoptions" >  
  <select name="upto">  
      <option value="upto100">Up to £100</option>  
      <option value="upto200">Up to £200</option>  

      </select>  
    <br />  
    <input type='submit' value = 'Re-Order your results'>  
</form>
  </div> 
```

并将我的数据收集到 div：

```
<?php
$i=0;
while ($i < $num) {

$image=mysql_result($result,$i,"image");
$name=mysql_result($result,$i,"name");
$category=mysql_result($result,$i,"category");
$description=mysql_result($result,$i,"description");
$stamps=mysql_result($result,$i,"stamps");
$stickmen=mysql_result($result,$i,"stickmen");
$price=mysql_result($result,$i,"price");
$view=mysql_result($result,$i,"view");
$actpagelink=mysql_result($result,$i,"actpagelink");

?>

  <a href="<?php echo $actpagelink; ?>" class="searchitem">
  <div class="searchimage"><img src="<?php echo $image; ?>"/></div>
  <div class="searchtext">
    <div class="searchname"><?php echo $name; ?></div>
    <div class="searchcategory"><?php echo $category; ?></div>
    <div class="searchdescription"><?php echo $description; ?></div>
  </div>
  <div class="searchstamps"><img src="<?php echo $stamps; ?>" /></div>
  <div class="searchstickmen"><img src="<?php echo $stickmen; ?>" /></div>
  <div class="searchprice"><span class="pricefrom">from</span>&pound;<?php echo $price; ?></div>

  <div class="searchview"><img src="<?php echo $view; ?>" /></div>

  </a>

  <?php
$i++;
}

mysql_close();
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:33:07.677

首先，抑制错误`@`是一个非常糟糕的主意。

虽然功能确实`mysql_*`不会很快消失，但建议使用 PDO 或 mysqli 代替，因为`mysql`不推荐使用扩展。

为了：

> /searchtestingv4.php?categories=rockandpop&sort=PriceLow

您可以通过以下方式访问变量：

```
$_GET['categories']; // rockandpop
$_GET['sort']; // PriceLow 
```

为了：

> /searchtestingv4.php?sort=PriceLow&page=2

您可以通过以下方式访问变量：

```
$_GET['sort']; // PriceLow
$_GET['page']; // 2 
```

您可以检查 a 的存在`var`：

```
(isset($_GET['key'])) // is true only if the GET var with key `key` exists 
```

你可以用它们做任何类型的逻辑。例如，如果你想`sort`被要求，你可以这样做：

```
if (!isset($_GET['sort'])) { /* print error */ } 
```

或者：

```
if (!in_array('sort', $_GET)) { /* print error */ } 
```

# jquery - 拖动时jqueryui可拖动重新定位偏移

> ID：15209253
> 
> 赞同：0
> 
> 时间：2013-03-04T19:15:02.967
> 
> 标签：jquery, css, jquery-ui, draggable, droppable

`margin:0px auto;`我有想要拖动的带有 set 的元素。当拖动开始时，元素向左移动，不考虑自动边距。可拖动对象显着位于光标的左侧。我正在尝试将元素拖到元素右侧的 droppable 中。由于这个偏移量，droppable 不会激活。如果我调整窗口大小以使自动边距几乎为零，则元素将正确激活可放置。

我已经尝试过`cursorAt`，并在拖动功能中更改了可拖动的 css，但都没有工作。克隆助手也会发生同样的事情。如果我控制拖动功能，它看起来像是在工作，但元素实际上并没有移动到它应该在的右边。

```
start: function(e, ui){
            $(ui.helper).addClass("ui-draggable-helper");
            window.cloneoffset = parseInt($(this).css('margin-left'));
            console.log(window.cloneoffset);
        },
        // cursorAt:{left:window.cloneoffset}
        drag:function(){        
            $('.ui-draggable-helper').css('left',(parseInt($('.ui-draggable-helper').css('left'))+window.cloneoffset)+'px');            
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T02:27:54.393

韦尔普，原来我通过将另一个 div 放在执行边距自动部分的可拖动对象周围并从可拖动对象中删除自动边距来解决它。

# c# - 有没有办法删除单个实体的更改跟踪机制？

> ID：15209256
> 
> 赞同：7
> 
> 时间：2013-03-04T19:15:06.567
> 
> 标签：c#, asp.net-mvc, entity-framework

我有这样的事情：

```
var dbTransactions = context.Transactions.Where(t => t.Date >= yesterday).Select(t => t).ToList(); 
```

现在，我想从`dbTransactions`列表中删除对象，而不是从实际数据库中删除。后来我打电话`context.SaveChanges()`，如果我这样做，它会从我的数据库中删除行。如何禁用更改跟踪`dbTransactions`？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-04T19:21:16.937

我认为您可以使用[AsNoTracking](http://msdn.microsoft.com/en-us/library/gg679352%28v=vs.103%29.aspx)并且对于交易使用 Detach

```
Youcontext.YourEntities.AsNoTracking().Where); 
```

或使用

```
Youcontext.Transactions.Detach(obj); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T19:18:53.023

使用以下方法从上下文中删除这些实体[`Detach()`](http://msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.detach.aspx)：

```
context.Transactions.Detach(obj); 
```

很明显，您将不得不恢复该列表-但随后只需遍历它并分离它们即可。

# ios - Objective-c：通过点符号和方法使用属性之间的区别？

> ID：15209258
> 
> 赞同：0
> 
> 时间：2013-03-04T19:15:09.743
> 
> 标签：ios, objective-c

通过点表示法和通过发送消息获取和设置属性有什么区别？

```
... = anObject.property;
... = [anObject property];

anObject.property = ...;
[anObject setProperty:...]; 
```

点表示法只是用于消息发送的语法糖，并且代码编译完全相同，还是在`nil`处理、性能等方面存在一些差异？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T19:17:07.720

> 点符号是否只是消息发送的语法糖，并且代码编译完全相同？

是的，它们完全一样。

# tfs - TFS 组成员资格 - HTTP 代码 400：错误请求

> ID：15209264
> 
> 赞同：0
> 
> 时间：2013-03-04T19:15:30.000
> 
> 标签：tfs, tfs-2012

我正在使用新安装的 TFS2012，在项目集合中工作了一段时间后，我进入管理控制台更改组成员身份。单击 Admin Console 中的 Group Membership 或 Administer Security 链接会导致错误：

> 请求被服务器拒绝。HTTP 代码 400：错误请求

我已经验证并重新应用了服务帐户权限和管理控制台用户权限，但没有成功。但是，我可以通过基于 Web 的控制面板为集合配置安全性。

有人对可能的原因有想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-04T21:13:11.843

显然 TFS 是配置 IIS 绑定的真正选择。通过恢复到默认的“*”绑定而不是特定的主机头，我能够让所有安全按钮工作。

现在我在 iis 中有两个 tfs 网站的绑定。

第一个：*：8080 第二个：tfs.company.com:8080

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-25T00:06:00.823

我在 IIS 中添加了到 * 和端口 8080 的 http 绑定，它解决了这个问题以及与管理团队项目和集合相关的类似问题。

# c++ - 引入参数时，从指针调用成员函数的 C++ 调用内存访问冲突

> ID：15209268
> 
> 赞同：1
> 
> 时间：2013-03-04T19:15:44.417
> 
> 标签：c++, pointers, member-function-pointers

我正在使用 Winsock2 编写服务器。接收到的所有数据都是字符串形式。我有一个字符串解析器，它可以从以字符串形式给出的方法签名中提取方法名称和参数。因此 AddNewMember(arg1,arg2) 被拆分为一个名为 signature 的字符串，其中包含 AddNewMember 和一个包含 arg1 和 arg2 元素的字符串向量。这工作正常。为了使这些消息有意义，我有一个字符串到成员函数指针的映射，所有函数都采用相同的参数向量 args。这是我的 ServerControl 课程中的地图：

```
//from header
map<string, string (ServerControl::*)(vector<string>)> functionMap;

//this on init creates all entries to function map
functionMap["AddNewMember"] = &ServerControl::AddNewMemberFunc;
functionMap["GetMember"] = &ServerControl::GetMemberFunc;
functionMap["RemoveMember"] = &ServerControl::RemoveMemberFunc;

...etc 
```

然后，一旦传入的消息被解析成它的部分，下面的代码就会访问映射以获取成员函数指针。

```
if (functionMap.find( signature ) != functionMap.end()) 
{
     return (this->*functionMap[message])(arguments); 
} 
```

再次，签名部分是“AddNewMethod”，参数是在 () 之间传递的参数向量。

如果参数向量为空，这将按预期工作，但即使一旦将参数添加到向量中，当代码到达此行并尝试调用成员函数时，我都会遇到内存访问冲突。我试过这个，参数是 a`vector<string>*`和普通的`vector<string>`。我很困惑。

我才真正开始在这个项目上使用函数指针，所以我不是专业人士。任何帮助将不胜感激！谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:21:10.057

您正在使用`signature`搜索地图，但随后使用`message`从地图中检索成员指针。如果`signature`和不是相同的值，您将不会得到您期望的指针，如果映射中尚不存在`message`该值，甚至可能是 NULL 指针。检索指针时`message`需要再次使用。`signature`更好的是，由于您已经执行了一次搜索，您应该使用搜索结果而不是调用`[]`运算符再次执行相同的搜索。

试试这个：

```
typedef string (ServerControl::*VectorArgMember)(vector<string>);
map<string, VectorArgMember> functionMap; 
```

.

```
map<string, VectorArgMember>::iterator i = functionMap.find( signature );
if (i != functionMap.end()) 
{
    VectorArgMember memberPtr = i->second;
    return (this->*memberPtr)(arguments); 
} 
```

# ember.js - 视图中的参数和绑定

> ID：15209271
> 
> 赞同：0
> 
> 时间：2013-03-04T19:16:01.260
> 
> 标签：ember.js

所以我正在为 disqus 评论小部件构建一个视图。因为（通常）您会将 disqus 放在静态页面上（不像使用 Ember 呈现的页面那样动态），所以我必须将一些额外的参数传递给 Disqus API 以刷新页面。为此，我需要将标识符传递给 API。所以现在，我有一个像 /posts/:id 这样的路由结构。所以我想将该 ID 传递给 Disqus 视图，但我不确定如何——或者我是否正确理解了 Ember 架构。如果有人能指出我正确的方向，那就太棒了。

这是我在我的帖子模板中调用 DisqusView 的方式（这使用玉作为我的服务器模板语言）。

```
div(class="post limit-width")
    h3 {{headline}}
    p {{body}}
    h6
        em Posted by {{creator}} on {{created}}
    {{ view App.DisqusView identifier=id }} 
```

我的 DisqusView 看起来像这样。

```
App.DisqusView = Em.View.extend({
    tagName: 'div',
    //controller: App.MapController,
    didInsertElement: function(){
        this.get('element').id = 'disqus_thread';
        console.log(this.get('identifier'));

        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'sitename'; // required: replace example with your forum shortname
        var identifier = new Date().getTime();
        this.set('identifier', identifier);

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();

    }
}); 
```

所以这行得通；它实际上呈现了 Disqus 控件，但是当我在控制台上记录标识符时，我看到的只是“id”，而不是帖子模板中可用的实际 id。所以我只需要一种方法来访问那个“标识符”值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:20:21.287

(1) 您可以在 {{view}} 助手中使用 id="disqus_thread" 来设置 ID。不要直接修改视图的元素。

(2) 使用 identifierBinding="id" 以便视图助手知道遵循指定的路径，否则它将被视为一个值。

# django - 将参数从模板传递到视图（链接）

> ID：15209276
> 
> 赞同：0
> 
> 时间：2013-03-04T19:16:30.723
> 
> 标签：django, django-models, django-templates

我想从模板调用视图并将参数传递给视图（见下文）。但是，代码会引发以下错误：

```
Reverse for 'project_list' with arguments '(u'member',)' and keyword arguments '{}' not found. 
```

**从模板：**

```
<a class="btn" href="{% url project_list 'member' %}">Member</a> 
```

**从观点来看：**

```
def project_list(request, projects_to_show = 'All'):
    if projects_to_show == 'member':
    ... 
```

**来自 urls.py：**

```
url(r'^projects/$', 'project_app.views.project_list', name="project_list"), 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:29:08.533

您的`project_list`网址不带任何参数。您需要定义另一个带有`projects_to_show`参数的 URL：

```
url(r'^projects/(?P<projects_to_show>\w+)$', 'project_app.views.project_list', name="project_list_filtered"), 
```

接着：

```
<a class="btn" href="{% url project_list_filtered 'member' %}">Member</a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T19:29:14.540

您的 URL 和视图都需要接受您的论点。

网址：

```
url(r'^projects/(?P<member>[\w]+)$', 'project_app.views.project_list', name="project_list"), 
```

看法：

```
def project_list(request, projects_to_show = 'All'):
    if projects_to_show == 'member':
    ... 
```

[您可以在此处](https://docs.djangoproject.com/en/dev/topics/http/urls/#reverse-resolution-of-urls)阅读有关反向 URL 解析的文档。

# asp.net - 考虑到标头名称，如何将 HttpRequestBase 转换为 HttpRequestMessage？

> ID：15209284
> 
> 赞同：9
> 
> 时间：2013-03-04T19:17:04.103
> 
> 标签：asp.net, httpclient

我将 an 包装`HttpRequestBase`为`HttpRequestMessage`，这需要复制所有标题。但由于`HttpRequestMessage`特别关注哪些标头适用于请求对象和内容对象，因此`httpRequest.Headers.Add`下面的行有时会抛出 InvalidOperationException。

```
public static HttpRequestMessage AsHttpRequestMessage(this HttpRequestBase request) {
    Requires.NotNull(request, "request");

    var httpRequest = new HttpRequestMessage(new HttpMethod(request.HttpMethod), request.Url);
    foreach (string header in request.Headers) {
        httpRequest.Headers.Add(header, request.Headers.GetValues(header));
    }

    if (request.Form != null) {
        // Avoid a request message that will try to read the request stream twice for already parsed data.
        httpRequest.Content = new FormUrlEncodedContent(request.Form.AsKeyValuePairs());
    } else if (request.InputStream != null) {
        httpRequest.Content = new StreamContent(request.InputStream);
    }

    return httpRequest;
} 
```

显然，我希望我的代码不抛出异常，而是将每个标头适当地应用于适当的对象。我怎么能预测这个？有没有什么方法可以用来测试没有生成和捕获异常的标头的适用性？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-05T23:20:25.970

事实证明这很简单。这个片段的灵感来自[ASP.NET 自己的开源源代码](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/4764b0111b91#src/System.Web.Http.WebHost/HttpControllerHandler.cs)。

```
/// <summary>
/// Clones an <see cref="HttpWebRequest" /> in order to send it again.
/// </summary>
/// <param name="message">The message to set headers on.</param>
/// <param name="request">The request with headers to clone.</param>
internal static void CopyHeadersFrom(this HttpRequestMessage message, HttpRequestBase request) {
    Requires.NotNull(request, "request");
    Requires.NotNull(message, "message");

    foreach (string headerName in request.Headers) {
        string[] headerValues = request.Headers.GetValues(headerName);
        if (!message.Headers.TryAddWithoutValidation(headerName, headerValues)) {
            message.Content.Headers.TryAddWithoutValidation(headerName, headerValues);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T08:09:04.703

您应该能够使用 TryAddWithoutValidation 而不是 Add 来避免抛出。您需要注意是否调用 GetBufferlessStream 取决于您是否要缓冲请求。请参阅以下类中的 ConvertRequest 方法：http: [//aspnetwebstack.codeplex.com/SourceControl/changeset/view/4764b0111b91#src/System.Web.Http.WebHost/HttpControllerHandler.cs](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/4764b0111b91#src/System.Web.Http.WebHost/HttpControllerHandler.cs)

# .htaccess - .htaccess 重定向。找到匹配项后忽略其他规则？

> ID：15209288
> 
> 赞同：0
> 
> 时间：2013-03-04T19:17:21.967
> 
> 标签：.htaccess

我有一个大规模定制的 .htaccess 文件，我不能对其进行过多修改（因为它会破坏现有的旧站点）。但是，我需要重定向*一些*路径。

我在顶部附近放置了以下内容`RewriteEngine on`：

```
Redirect 301 /old_very_long_page /foob/new_site/newpage 
```

重定向有效，但 .htaccess 中的另一条规则将标题作为查询字符串附加到页面，例如：

```
http://foob/new_site/newpage?foo=blablalblalbabla 
```

我无法删除此重写，因为它会破坏网站的其他部分。一旦找到匹配项，有没有办法可以在 .htaccess 中返回以忽略所有其他规则？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T20:56:48.473

我已经想通了。我会回答我自己的问题，以防其他人遇到同样的问题。

```
RewriteRule ^old_very_long_page(/?.*) /foob/new_site/newpage$1 [R=301,L] 
```

# ajax - CGridView 上的自定义搜索

> ID：15209291
> 
> 赞同：0
> 
> 时间：2013-03-04T19:17:31.277
> 
> 标签：ajax, search, yii

我的用户/索引视图上有一个 CGridView 小部件。但是，我还想在同一页面上实现一个用户查找功能，顶部有一个搜索框，它执行 ajax 自动建议类型的用户名或 id 查找用户。这与管理页面上的搜索类型不同。有什么想法可以实现吗？Yii新手在这里。谢谢！

这就是我想要完成的事情。

```
<div id="search">
<form action="users/lookup">
<input type="text" id="lookup" name="userid" />
<input type="submit" value="Search" />
</form></div>

<?php $this->widget('zii.widgets.grid.CGridView', array(
    'dataProvider'=>$dataProvider,
    'pager' => array('cssFile' => Yii::app()->baseUrl. '/css/gridViewStyle/gridView.css'),
    'template'=>"{items}\n{pager}\n{summary}", 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T09:04:05.737

Yii Playground 上有一个例子：[Autocomplete](http://www.yiiplayground.com/index.php?r=UiModule/jui/ziiAutocomplete)。您可以将此类小部件作为过滤器添加到`CGridView`.

# ios - 如何检查特定 ViewController 是否在 UINavigationController 堆栈上？

> ID：15209298
> 
> 赞同：0
> 
> 时间：2013-03-04T19:17:58.970
> 
> 标签：ios, objective-c, uinavigationcontroller

我有一个主视图，它通过一个按钮链接到第二个视图，并通过导航栏中的“返回”按钮链接回来。我想在主视图中隐藏导航栏，只在场景视图中显示。

我在主视图上隐藏了导航栏，在第一次启动时它看起来不错，但是一旦第二个视图从堆栈中弹出，主视图上就会出现一个空的导航栏。

有什么方法可以检测主视图当前是否可见，然后随时隐藏导航栏？或者我遇到的问题的任何其他修复？

预先感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:22:29.510

这将通过您的 navigationController 堆栈中的视图控制器运行。一旦你找到你的班级，做任何你必须做的事情！

```
for ( UIViewController *vc in [self.navigationController viewControllers]) {
      if ([vc isKindOfClass:[YourClass class]]) {
             // do something
      }
} 
```

编辑

这将检查您的主视图控制器是否正在显示：

```
if ([[self.navigationController topViewController] isKindOfClass:[yourmainviewcontroller class]]){
    self.navigationController.navigationBarHidden = YES;
}else{
    self.navigationController.navigationBarHidden = NO;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T20:09:08.613

你这样做有点错误。无需在堆栈上查找特定的视图控制器并更改其属性，而是直接在两个视图控制器内进行。使用 `viewWillAppear:`和`viewWillDisappear:`方法：

第一个（顶部）视图控制器：

```
- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
    [[self navigationController] setNavigationBarHidden:YES animated:YES];
} 
```

第二个（子）视图控制器：

```
- (void)viewWillDisappear:(BOOL)animated
{
    [super viewWillDisappear:animated];
    [[self navigationController] setNavigationBarHidden:YES animated:YES];
} 
```

子视图控制器中的代码是可选的，如果您有更多的子视图控制器，则不应使用它。

# php - 使用 Slim 框架创建 OR 功能

> ID：15209299
> 
> 赞同：0
> 
> 时间：2013-03-04T19:18:05.863
> 
> 标签：php, mysql, api, slim

我有一个苗条的 GET 方法设置，其基本签名如下所示：

```
$app->get('/musicians/name/:name', function($name) use ($allFields, $app, $db) 
```

然后，我创建了一些查询文本，类似于以下内容：

```
$queryText = "SELECT date, bio, articles FROM Musicians WHERE name = :name" 
```

然后我继续将 :name 参数绑定到调用函数时引入的 $name 变量。

这很好用，但如果我想让用户一次搜索多个音乐家会发生什么？有没有一种方法可以让用户在 URL 中输入一些内容，将我的内容翻译`$queryText`成类似于以下内容的内容`"SELECT date, bio, articles FROM Musicians WHERE name = 'Beethoven' OR 'Bach' OR 'The Sex Pistols'"?`

注意：我使用 PDO 进行数据库处理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:23:07.363

是的，你可以做到：

```
$queryText = "SELECT date, bio, articles 
              FROM Musicians 
              WHERE name = :name or name = :name1 or name = name2"; 
```

然后您可以单独绑定每个值或使用值数组。

更新：

您可以在 url 中使用 name1&name2&name3，然后，您可以使用：

```
<?php
$names = explode("&", $querystring); //$querystring here is name1&name2&name3
//now names is an array contains all keywords
//lets build the query
$i = 1;
foreach($names as $name){
 $where[] = "name = :name$i";
 $params[":name$i"] = $name;
 $i++;
}
$queryText = "SELECT date, bio, articles 
              FROM Musicians 
              WHERE ".implode(" OR ", $where);
$sth = $dbh->prepare($queryText);
$sth->execute($params);
?> 
```

# ravendb - 存储对父文档的引用而不是存储文档的副本

> ID：15209310
> 
> 赞同：3
> 
> 时间：2013-03-04T19:18:45.043
> 
> 标签：ravendb

在 Orders 和 OrderLines 的经典案例中，每个 OrderLine 都有对其父 Order 的引用。当我将 OrderLine 保存到 RavenDB 时，它会将完整 Order 记录的副本保存为每个 OrderLine 的属性。我如何让它只保存订单的链接？像这样：

```
{ 
...other orderline properties...
Order : "orders/123"
} 
```

而不是这个

```
 {
        ...other orderline properties...
        Order : {
    ...all properties for order 123...
        }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T20:10:32.373

欢迎使用非关系数据库！订单行没有 ID。他们不会被放入自己的文件中。它们存储在重要的地方 - 与订单！

```
public class OrderLine
{
    public string Product { get; set; }
    public int Quantity { get; set; }
    public decimal Price { get; set; }
}

public class Order
{
    public string Id { get; set; }
    public string CustomerId { get; set; }
    public List<OrderLine> Lines { get; set; }
    public decimal Total { get; set; }
} 
```

生成如下文件：

```
orders/123
{
    "CustomerId": "customers/456",
    "Lines": [
        { "Product": "Foo", "Quantity": 2, "Price": 10.00 },
        { "Product": "Bar", "Quantity": 3, "Price": 20.00 },
        { "Product": "Baz", "Quantity": 4, "Price": 30.00 }
    ]
    "Total": 200.00
} 
```

有关更多信息，请参阅[文档](http://ravendb.net/docs/theory/document-structure-design)。

# android - 仅当已修改 android 时才从 url 更新图像

> ID：15209311
> 
> 赞同：1
> 
> 时间：2013-03-04T19:18:48.483
> 
> 标签：android, http-headers

使用 Java，如何仅返回图像的标头？我可以得到上次修改我手机上的文件的时间......

```
SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy HH:mm:ss");
sdf.format(file.lastModified())); 
```

所以我决定从服务器获取最后一次更新......如果它不同，请下载它，否则不要担心。

我害怕的是打服务器太多。我想减轻负担。这是一个很好的解决方案吗？

# c - 使用 libusb 的 USB 权限错误

> ID：15209315
> 
> 赞同：2
> 
> 时间：2013-03-04T19:19:02.893
> 
> 标签：c, permissions, usb, driver, libusb

我正在尝试为 USB-to-DMX 转换器 (Velleman VM116.) 创建驱动程序。

我遇到的问题是，当我尝试打开 USB 设备并对其进行配置时，它返回一个错误：`Configurating USB failed: Operation not permitted`，我找不到这个错误代表什么。如何配置 USB 设备的好方法？这是我的代码：

```
int dmxOpen(){
    int result;

    struct usb_bus *busses;
    struct usb_bus *bus;

    usb_init();
    usb_find_busses();
    result = usb_find_devices();
    if(result < 0){
        perror("Finding USB devices failed");
        return 0;
    }

    usb_set_debug(1);

    busses = usb_get_busses();
    for(bus = busses; bus; bus = bus->next){
        for(dev = bus->devices; dev; dev = dev->next){
             if ((dev->descriptor.idVendor == 0x10cf) && (dev->descriptor.idProduct == 0x8062)){
                udev = usb_open(dev);
#if defined(LIBUSB_HAS_GET_DRIVER_NP) && defined(LIBUSB_HAS_DETACH_KERNEL_DRIVER_NP)
                usb_detach_kernel_driver_np(udev, 0);
#endif
                result = usb_set_configuration(udev, dev->descriptor.bNumConfigurations);
                if(result < 0){
                    usb_close(udev);
                    perror("Configurating USB failed");
                    return 0;
                }
                result = usb_claim_interface(udev, 0);
                if(result < 0){
                    usb_release_interface(udev, 1);
                    usb_close(udev);
                    perror("Claiming USB failed");
                    return 0;
                }
                return 1;
            }
        }
    }
    return 0;
} 
```

顺便说一句，我的计算机在 Linux Debian 64 位上运行，这是设备规格：

```
Bus 010 Device 002: ID 10cf:8062 Velleman Components, Inc. 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               1.10
  bDeviceClass            0 (Defined at Interface level)
  bDeviceSubClass         0 
  bDeviceProtocol         0 
  bMaxPacketSize0         8
  idVendor           0x10cf Velleman Components, Inc.
  idProduct          0x8062 
  bcdDevice            0.00
  iManufacturer           1 
  iProduct                2 
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           41
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          4 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              100mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           2
      bInterfaceClass         3 Human Interface Device
      bInterfaceSubClass      0 No Subclass
      bInterfaceProtocol      0 None
      iInterface              0 
    HID Device Descriptor:
      bLength                 9
      bDescriptorType        33
      bcdHID               1.00
      bCountryCode            0 Not supported
      bNumDescriptors         1
      bDescriptorType        34 Report
      wDescriptorLength      29
     Report Descriptors: 
       ** UNAVAILABLE **
      Endpoint Descriptor:
    bLength                 7
    bDescriptorType         5
    bEndpointAddress     0x81  EP 1 IN
    bmAttributes            3
      Transfer Type            Interrupt
      Synch Type               None
      Usage Type               Data
    wMaxPacketSize     0x0008  1x 8 bytes
    bInterval              10
      Endpoint Descriptor:
    bLength                 7
    bDescriptorType         5
    bEndpointAddress     0x01  EP 1 OUT
    bmAttributes            3
      Transfer Type            Interrupt
      Synch Type               None
      Usage Type               Data
    wMaxPacketSize     0x0008  1x 8 bytes
    bInterval              10 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T20:17:37.167

> 这确实是一个特权问题，当我`sudo`它起作用时

您可以使用[UDEV](https://www.google.com/search?q=UDEV+script)脚本在附加时更改 USB 设备的权限。这样您就不需要`root`允许通过`libusb`.

# android - 如何查看设备是否为 7 英寸平板电脑

> ID：15209317
> 
> 赞同：0
> 
> 时间：2013-03-04T19:19:07.857
> 
> 标签：android, android-actionbar, android-resolution

我正在尝试在我的操作栏中设置选项卡，但在 7 英寸平板电脑上，这些选项卡不适合，因此它们被推到操作栏中的下拉视图中。

如果我缩写选项卡中的某些单词，它们会显示在选项卡中，但我不希望总是如此，因为在 10 英寸平板电脑上它很好。

那么如何查看当前设备是否是 7 英寸平板电脑，以便我知道我必须缩写标签文本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:24:06.677

您应该阅读Android 开发者指南中的[Supporting Multiple Screens](http://developer.android.com/guide/practices/screens_support.html)页面。

您不应该根据物理尺寸检测和纠正不同类型的屏幕。这对您的资产意味着什么？一个 7 英寸的平板电脑很可能具有与手机相同的像素数，并且两者都会有相同的 UI 问题。您想要的是针对不同的像素密度。

以下是该页面的一些粗略指南：

> *   320dp：典型的手机屏幕（240x320 ldpi、320x480 mdpi、480x800
> *   hdpi 等）。480dp：像 Streak (480x800 mdpi) 这样的补间平板电脑。
> *   600dp：7 英寸平板电脑 (600x1024 mdpi)。720dp：10 英寸平板电脑（720x1280
> *   mdpi、800x1280 mdpi 等）。

您可以通过使用目标资产文件夹（例如`res/layout-sw600dp/main_activity.xml`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T19:26:50.270

> 我正在尝试在操作栏中设置选项卡，但在 7 英寸平板电脑上，选项卡不适合，因此它们被推入操作栏中的下拉视图

这与“7英寸平板电脑”关系不大。Android 将根据自己的规则选择是否将操作栏选项卡显示为选项卡或下拉菜单。这是基于多种因素，包括方向。

> 在 10 英寸平板电脑上很好。

您是否在制造过的每台平板电脑上都对其进行了测试？如果不是，你怎么能确定这个说法？

更不用说将来会制造出可能具有不同特性的新设备。而且，当然，Android 可以更改其算法以确定何时在选项卡和下拉列表之间切换。

如果您不希望将选项卡切换到下拉列表，请不要使用操作栏选项卡。采用：

*   `ViewPager`与`PagerTabStrip`, 或
*   `ViewPager`使用 ViewPagerIndicator 库中的选项卡指示器，或
*   `FragmentTabHost`

# c# - 检测我的数据库中的表是否因优化需要而更改

> ID：15209324
> 
> 赞同：2
> 
> 时间：2013-03-04T19:19:42.023
> 
> 标签：c#, asp.net-mvc, database, optimization

我正在使用 Sql Server Compact 并正在构建一个 MVC 应用程序。

在获取我的数据时，许多表都建立了许多链接，最终会演变成复杂的循环和较长的加载时间，因为每次加载数据时都要获取数据并建立链接。

所以我认为优化是一个好主意，一种方法是在加载任何数据之前检查数据是否发生了变化。如果为真，则进行总加载，否则参考实际存在的数据结构。

有没有办法检查我的数据库表中的数据是否发生了变化？一个方法，也许？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:23:47.910

正如斯派罗在[他们的回答](https://stackoverflow.com/questions/8643018/mysql-fastest-way-to-check-if-data-in-innodb-table-has-changed/8643198#8643198)中所说：

> 简单的方法是使用触发器添加一个 TIMESTAMP 类型的可为空列：
> 
> > ON UPDATE CURRENT_TIMESTAMP。
> 
> 因此，插入不会更改，因为该列接受空值，您可以通过以下方式仅选择新的和更改的列：
> 
> ```
> SELECT * FROM `table` WHERE `mdate` > '2011-12-21 12:31:22' 
> ```
> 
> 每次更新一行时，此列都会自动更改。
> 
> 以下是更多信息： [http ://dev.mysql.com/doc/refman/5.0/en/timestamp.html](http://dev.mysql.com/doc/refman/5.0/en/timestamp.html)
> 
> 要查看已删除的行，只需创建一个触发器，它将每次删除记录到另一个表：
> 
> ```
> DELIMITER $$
> CREATE TRIGGER MyTable_Trigger
> AFTER DELETE ON MyTable
> FOR EACH ROW
> BEGIN
>   INSERT INTO MyTable_Deleted VALUES(OLD.id, NOW());
> END$$ 
> ```

或者，您可以对所有表结果执行哈希函数（MD5，SHA1）并将其保存，就像表`MD5(table);` 的值已`MD5(table);`更改一样！

```
// Serialize the table
DataContractSerializer serializer = new DataContractSerializer(typeof(DataTable));
MemoryStream memoryStream = new MemoryStream();
XmlWriter writer = XmlDictionaryWriter.CreateBinaryWriter(memoryStream);
serializer.WriteObject(memoryStream, table);
byte[] serializedData = memoryStream.ToArray();

// Calculte the serialized data's hash value
SHA1CryptoServiceProvider SHA = new SHA1CryptoServiceProvider();
byte[] hash = SHA.ComputeHash(serializedData);

// Convert the hash to a base 64 string
string hashAsText = Convert.ToBase64String(hash); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T19:27:55.557

你知道，当我构建一个离线解决方案时，人们可以离线更改数据，然后在晚上同步备份，我找到了确定我们的配置数据的最佳方法（很像你处理）是[`timestamp`](http://technet.microsoft.com/en-us/library/bb726005.aspx)在每一行举行。之所以如此有效，是因为我可以构建一个表，该表`timestamp`基于对每个表的简单 MAX 查询来索引这些值。所以该表可能如下所示：

```
CREATE TABLE TimestampIndex (
    TableName SYSNAME PRIMARY KEY,
    LastChange TIMESTAMP
) 
```

然后我可以运行基本查询并在它们离线时填充该表：

```
IF EXISTS (SELECT TableName FROM TimestampIndex WHERE TableName = 'Table1')
    UPDATE TimestampIndex SET LastChange = (SELECT MAX(ts) FROM Table1)
ELSE
    INSERT INTO TimestampIndex (TableName, LastChange) SELECT 'Table1', MAX(ts) FROM Table1 
```

然后当他们重新上线时，我可以简单地执行以下操作：

```
IF NOT EXISTS (SELECT TableName FROM TimestampIndex WHERE TableName = 'Table1' AND LastChange = (SELECT MAX(ts) FROM RemoteDb.dbo.Table1))
BEGIN
    -- there must be changes to make then
END 
```

# html - 更改包含输入表单的 div 的 CSS

> ID：15209327
> 
> 赞同：0
> 
> 时间：2013-03-04T19:20:12.727
> 
> 标签：html, css

当您专注于“输入”时，我想要做的就是更改“应用程序搜索”的边框。我想只使用 CSS 来做到这一点。

帮助？谢谢你 ：）

```
<form class="apps-search" type="text"  method="GET">
   <input name="search_query" id="search_query" placeholder="Hey" />
<button type="submit"> <span class="search-icon"> S</span></button>
</form> 
```

我的代码：http: [//jsfiddle.net/yhQ2C/](http://jsfiddle.net/yhQ2C/)

编辑：好的，所以这不能在 CSS、jquery/javascript 帮助中完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:27:41.713

您将需要设置 2 个 CSS 类（即**apps-search**和**app-search-black-border**）

然后，使用一些基本的 jquery 进行切换。这是一篇解释您需要做什么的文章：http: [//buildinternet.com/2009/01/changeing-form-input-styles-on-focus-with-jquery/](http://buildinternet.com/2009/01/changing-form-input-styles-on-focus-with-jquery/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T19:37:27.990

我添加了一些用于焦点和模糊的 jquery 处理程序以及一个示例 css 类“悬停边界”。这是小提琴 - [http://jsfiddle.net/yhQ2C/4/](http://jsfiddle.net/yhQ2C/4/)

```
$('#search_query').focus(function(){
    $('.apps-search').addClass('hover-border');
});

$('#search_query').blur(function(){
    $('.apps-search').removeClass('hover-border');
}); 
```

# objective-c - 禁用添加对象的选项，该对象已经在从 NSUserDefaults 加载的数组中

> ID：15209331
> 
> 赞同：0
> 
> 时间：2013-03-04T19:20:21.857
> 
> 标签：objective-c, nsuserdefaults

我正在将 plist 中的食谱加载到 NSArray（自定义对象食谱）并将它们显示在 UITableView 中。
我在详细视图中添加了一个选项，以将食谱添加到收藏夹视图。

显然，我想要保存用户收藏夹选择的选项，因此我使我的自定义类符合 NSCoding 并将 initWithCoder 和 encodeWithCoder 方法添加到我的自定义对象中。

重新启动应用程序后，收藏夹数组已正确保存并重新加载。
问题是我可以在每次重新启动时添加相同的配方（当应用程序运行时，我可以添加和删除配方就好了）。

有人可以帮我想出一种方法来禁用添加上次应用程序运行时已经添加的食谱的选项吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:25:11.383

您可以使用该方法检查数组`[array containsObject:obj]`，它还需要`isEqual:`在您的类中实现正确的方法。

此外，您可能会考虑使用`NSSet`而不是`NSArray`，因为在`NSSet`逻辑上比 更适合唯一的对象集`NSArray`。使用 NSSet，您仍然需要`isEqual:`实现！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T19:24:48.900

你可以让它们覆盖 -hash 和 -isEqual: 并使用一个集合......然后你可以尝试一遍又一遍地添加它们，这没关系，因为一个集合只包含一个......或者你可以继续使用一个数组并检查对象的数组。

```
if ([someArray indexOfObject:someObj]==NSNotFound)
{
    [someArray addObject:someObj];
} 
```

# seo - 截断锚文本会伤害 SEO 吗？

> ID：15209334
> 
> 赞同：0
> 
> 时间：2013-03-04T19:20:28.867
> 
> 标签：seo

截断链接中的锚文本是否会对 SEO 产生负面影响？Google 仅在锚点中看到部分相关文本。我有一长串需要从我的主页链接到的产品网址。这些链接中的绝大多数都在 30 个字符以下，但有些非常长，超过 100 个字符。出于 UI/UX 的原因，我在这些锚点上获得了字符上限，因此我必须为我使用的锚点文本找到最佳解决方案，因为该限制。我对人们可以提供的 SEO 观点非常感兴趣。

示例锚文本：NormalPartNameNumberTruncated

VeryVeryLongWhichIsPartNumber 已截断...

另一个非常非常长的零件编号被截断...

NeedToLimitMyVeryLongPartNumberAnchors...

问题：

我应该在截断的锚文本末尾使用省略号还是留下尽可能多的字符？Google 是否对截断非常长的锚点持消极态度？

提前感谢您的想法和见解！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:24:05.573

截断的唯一影响是，当 Google 确定接收页面的链接值时，不会考虑从锚文本中删除的任何文本。因此，如果这些是内部链接，您将降低这些链接的价值。但是，如果文本真的很长，那么这是一个番茄/番茄场景，因为您可以确定 Google 会限制它在链接中考虑的关键字数量，因为垃圾邮件发送者肯定会塞满充满文本的垃圾链接。

底线，如果你截断的文本很长，这不会伤害你。如果它可以帮助您的用户，那么它是值得的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T19:25:23.413

将整个文本留在那里并使用`text-overflow: ellipsis`如何？见[http://www.quirksmode.org/css/textoverflow.html](http://www.quirksmode.org/css/textoverflow.html)

（这取决于弄清楚不支持的旧浏览器`text-overflow: ellipsis`对您是否重要，以及是否有解决方法。）

# .net - Azure 服务总线中继中的 304 响应

> ID：15209335
> 
> 赞同：3
> 
> 时间：2013-03-04T19:20:31.943
> 
> 标签：.net, http, azure, servicebus, azure-servicebusrelay

我有一个包含[If-None-Match](http://en.wikipedia.org/wiki/HTTP_ETag)标头的请求，然后我将其与服务上的计算响应进行比较。如果它们匹配并且自上次以来尚未修改响应，我将返回一个空的 304 响应。

所有这一切都很好，因为我的内容很少更改，但我喜欢经常检查更改。

然而，当通过服务总线中继公开服务资源时，这似乎成为一个问题。从服务发送 304 时，我*没有在中继端点收到响应*。

这是一个已知问题吗？如您所见，有没有办法解决它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T19:54:40.970

这似乎是 ServiceBus Relay 中的一个错误。当您的侦听器返回 304（或 204）时，请确保 HttpResponseMessageProperty..StatusDescription 在通过 SERVICEBUS 发回响应之前为空，这应该可以解决此问题。

# asp.net - 编辑 Web.config

> ID：15209339
> 
> 赞同：1
> 
> 时间：2013-03-04T19:20:44.300
> 
> 标签：asp.net, vb.net, visual-studio-2008

我有一个 ASP.NET 网站（不是 Web 应用程序），我使用“发布”选项发布它（到五个 Windows 服务器 (2003)）。

我的开发 PC 包含版本 11 的 Oracle (DataAccess.dll)，而 Web 服务器使用版本 10。我无法降级我的开发机器，因为它有 Windows 7，这与版本 10 不兼容。我无法将服务器升级到版本 11，因为同时Windows Server 2003 是兼容的，它似乎不能很好地与 Oracle 11 一起工作。我已确保服务器已修补。

因此，在发布网站时，我在 web.config 中有以下行：

```
<add assembly="Oracle.DataAccess, Version=10.2.0.100, Culture=neutral, PublicKeyToken=89B483F429C47342"/> 
```

然后，一旦 Web 应用程序发布，我手动更改 web.config。是否有这样做的自动化方式，也许使用构建脚本？如果我转换成 Web 应用程序会有帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:45:41.017

您需要的是 Visual Studio 2010 中可用的 web.config 转换。

[你可以在这里](http://blogs.msdn.com/b/webdev/archive/2009/05/04/web-deployment-web-config-transformation.aspx)找到“如何做”

# ios - 如何获取动画 UIImageView 的坐标

> ID：15209342
> 
> 赞同：0
> 
> 时间：2013-03-04T19:20:52.600
> 
> 标签：ios, core-animation, coordinates

所以，我有一个具有动画 UIImage 的 UIImageView。UIImageView 本身使用 CAKeyframeAnimation 和 CGMutablePathRef 进行动画处理，以在路径中提供一些随机性。我的问题是我需要跟踪有人点击动画 UIIMageView 的时间。

在这方面我已经把头撞到墙上一段时间了，似乎我应该将 UITouch 与 UIImage 的表示层在屏幕上的位置进行比较，但我不知道如何获取坐标它。

所以主要问题是，我如何获得在屏幕上动画的 UIIMageView 的坐标，并将其与点击发生的位置进行比较？

如果我现在按原样运行代码，它将引发错误：

-[CALayer 中心]：无法识别的选择器发送到实例 0xa105150

**它不再崩溃，但我仍然不知道如何确定 UIImageView 在屏幕上移动时的位置。**

我的相关代码如下。任何帮助将不胜感激。

```
- (void)animateCarrierFish
{
    NSInteger getWhichFish = (arc4random()%[self.fishes count]);
    NSArray *selectedFish = [NSArray arrayWithArray:[self.fishes objectAtIndex:getWhichFish]];
    UIImage *fishName = [selectedFish objectAtIndex:0];

    UIImageView *fishCarrier = [[UIImageView alloc] initWithImage:fishName];
    fishCarrier.animationImages = selectedFish;
    fishCarrier.animationDuration = 1.5;
    fishCarrier.animationRepeatCount = 0;
    fishCarrier.frame = CGRectMake(0, 0, fishName.size.width*screenScale, fishName.size.height*screenScale);

    NSInteger startPoint;
    NSInteger endPoint;
    NSInteger oppositeMod;

    NSInteger fromWhichDirection = (arc4random()%2);
    if(fromWhichDirection==1)
    {
        startPoint = rightEdge;
        endPoint = leftEdge;
        oppositeMod = -rightEdge;
        fishCarrier.transform = CGAffineTransformMakeScale(-1, 1);
    } else {
        startPoint = leftEdge;
        endPoint = rightEdge;
        oppositeMod = 0;
    }

    NSInteger aniSpeed = [self getRandomNumberBetweenMin:15 andMax:20];

    CAKeyframeAnimation *pathAnimation = [CAKeyframeAnimation animationWithKeyPath:@"position"];
    pathAnimation.duration = aniSpeed;
    pathAnimation.calculationMode = kCAAnimationCubic;
    pathAnimation.fillMode = kCAFillModeForwards;
    pathAnimation.removedOnCompletion = NO;

    CGMutablePathRef pointPath = CGPathCreateMutable();

    NSInteger yPoint = [self getRandomNumberBetweenMin:waterLine andMax:seaFloor];
    CGPathMoveToPoint(pointPath, NULL, startPoint, yPoint);

    NSInteger howManyDips = [self getRandomNumberBetweenMin:2 andMax:4];

    int i=0;
    for (i = 0; i < howManyDips; i++)
    {
        yPoint = [self getRandomNumberBetweenMin:waterLine andMax:seaFloor];
        NSInteger xMod = [self getRandomNumberBetweenMin:-25 andMax:25];

        NSInteger xPoint = (([[UIScreen mainScreen] bounds].size.height/(howManyDips+1))*(i+1)) + xMod + oppositeMod;
        if (xPoint <0)
        {
            xPoint = xPoint*-1;
        }
        CGPathAddLineToPoint(pointPath, NULL, xPoint, yPoint);
    }

    yPoint = [self getRandomNumberBetweenMin:waterLine andMax:seaFloor];
    CGPathAddLineToPoint(pointPath, NULL, endPoint, yPoint);
    pathAnimation.path = pointPath;
    CGPathRelease(pointPath);

    [fishCarrier.layer addAnimation:pathAnimation forKey:@"pathAnimation"];
    [self.view addSubview:fishCarrier];
    [fishCarrier startAnimating];

    fishCarrier.userInteractionEnabled = YES; // these two lines don't seem to do anything
    fishCarrier.multipleTouchEnabled = YES;
    fishCarrier.tag=[self.swimmers count];

    [self.swimmers addObject:fishCarrier];
}

- (void) touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    [super touchesBegan:touches withEvent:event];

    UITouch *touch = [touches anyObject];
    CGPoint touch_point = [touch locationInView:self.view];

    for (UIImageView *image in self.swimmers) {
        // HOW do I get the coordinates in the main view of this sublayer?
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T16:17:28.997

通过对我的 touchesBegan 方法进行以下更改，我终于能够让对象报告它们在屏幕上的位置：

```
- (void) touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    [super touchesBegan:touches withEvent:event];

    UITouch *touch = [touches anyObject];
    CGPoint startPoint = [touch locationInView:self.view];
    CGFloat x = startPoint.x;
    CGFloat y = startPoint.y;

    //create touch point
    CGPoint touchPoint = CGPointMake(x, y);

    // loop through the items we're iterested in being tapped on here
    for (UIImageView *fish in self.swimmers) {
        CGRect fishFrame = [[fish.layer presentationLayer] frame];

        if (CGRectContainsPoint(fishFrame, touchPoint)) {
            NSLog(@"You hit fish: %u",fish.tag); // do stuff here
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T19:26:37.243

为什么你期望`CALayer`回复`center`消息？如果您阅读过它的[文档](https://developer.apple.com/library/mac/#documentation/graphicsimaging/reference/CALayer_class/Introduction/Introduction.html)，您会发现它没有实现名为`center`. 如果要获取图层的几何中心，请手动计算：

```
CGPoint center;
center.x = CGRectGetMidX(layer.bounds);
center.y = CGRectGetMidY(layer.bounds); 
```

编辑：您似乎想要相对于超级（图层？视图？无论如何...）的中心：

```
CGPoint center;
center.x = CGRectGetMidX(layer.frame);
center.y = CGRectGetMidY(layer.frame); 
```

# doctrine-orm - 如何在 Doctrine 上使用 --generate-annotations 参数

> ID：15209344
> 
> 赞同：2
> 
> 时间：2013-03-04T19:21:06.587
> 
> 标签：doctrine-orm, doctrine

我正在使用 Doctrine 从数据库中生成实体，

```
 vendor/bin/doctrine orm:convert-mapping --from-database yml configuration/yaml 
```

我成功导出到 Yaml 然后我生成了实体

```
 vendor/bin/doctrine orm:generate-entities entities/ 
```

我看到注释不完整但我也看到有一个参数`--generate-annotations`

我使用了命令行：

```
 vendor/bin/doctrine orm:generate-entities --generate-annotations entities/ 
```

但我得到了错误：

```
 [RuntimeException]
  Not enough arguments. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-01T11:52:58.917

您需要以这种方式使用命令行：

```
vendor/bin/doctrine orm:generate-entities --generate-annotations=1 entities/ 
```

只需设置 annotations=1 或 annotations="true"

# php - 在完全工作的数据库上构建 Yii Web 应用程序

> ID：15209346
> 
> 赞同：2
> 
> 时间：2013-03-04T19:21:13.427
> 
> 标签：php, sql-server, yii

在另一个软件正在使用的 SQL Server 数据库上构建 Yii 应用程序是否安全？想法是为 WebApp 迁移该桌面软件，但**我必须让数据库结构保持不变**。这是一个非常复杂的数据库，我也有非常复杂的 SQL 查询，所以我应该避免使用 DAO 和 AR。我一直在网上寻找一些信息，但我不清楚这个过程有多安全。我应该使用 RAW SQL 构建所有应用程序并小心执行它吗？

你们中的任何人都可以告诉我我应该遵循的正确道路吗？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:32:43.050

这样做是绝对安全的，使用 Yii 你可以使用任何你需要的数据库结构。您只需要根据当前的数据库结构创建模型。

这里是使用 Yii 和 SQLServer 的快速指南[http://www.yiiframework.com/wiki/192/config-use-ms-sql-server-2005-2008/](http://www.yiiframework.com/wiki/192/config-use-ms-sql-server-2005-2008/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T09:23:10.960

你可以在 Yii 中使用纯 SQL，看看[http://www.yiiframework.com/doc/api/1.1/CDbCommand](http://www.yiiframework.com/doc/api/1.1/CDbCommand)

但是如果你想要更多的灵活性，我可以推荐你以下方式。

1.  创建一个初始数据库迁移，只是`execute()`来自现有数据库的普通 SQL 转储。
2.  根据需要创建数据库迁移
3.  应用迁移
4.  开发
5.  转到步骤 1。如果您想使用更新的数据进行测试并将迁移重新应用到您的数据库
6.  关闭旧应用程序

由于您的迁移使用您的应用程序进行版本控制，您可以例如。使用旧的 db-schema 维护一个分支，并在具有另一个 db-schema 的更新版本上并行工作。

# java - Spring的TestExecutionListener接口中的prepareTestInstance和beforeTestMethod有什么区别？

> ID：15209351
> 
> 赞同：0
> 
> 时间：2013-03-04T19:21:23.600
> 
> 标签：java, spring, testing, junit4

因此，在进行一些基本调查后，一个简单的时间表显示如下：

1.  实例化类
2.  班级设置
3.  上下文注入
4.  准备测试实例（）
5.  ....某物 .....
6.  之前测试方法（）

第 5 步会发生什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:31:54.283

我认为`prepareTestInstance`在创建的测试类实例上调用一次。`beforeTestMethod`在调用测试类实例的每个测试方法之前调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T20:08:47.157

除了 Michail 的回答：[相关的 javadoc](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/test/context/TestExecutionListener.html)还提到，例如，在此阶段处理依赖注入，而`beforeTestMethod`在每个测试方法之前调用的，可用于设置固定装置等。

# c# - 如何首先在代码中实现多级继承

> ID：15209353
> 
> 赞同：0
> 
> 时间：2013-03-04T19:21:31.977
> 
> 标签：c#, sql, code-first

我正在使用 Code First 方法来创建数据库。我正在尝试使用 TPH（每个层次结构的表）继承。我的 POCO 课程是：

```
public abstract class Address
{
    public int AddressId { get; set; }
    ...
}

public abstract class PersonalDetail : Address
{
    public int PersonalDetailId { get; set; }
    ...   
}

public partial class AccountHolder : PersonalDetail
{
    public int AccountHolderId { get; set; }
}

public partial class Nominee : PersonalDetail
{
    public int NomineeId { get; set; }
} 
```

我创建了 2 个抽象类*Address*和*PersonalDetail*以及 2 个派生类*AccountHolder*和*Nominee*。*PersonalDetail*继承*address*并且进一步*AccountHolder*和*Nominee*继承*PersonalDetail*。我流利的api代码是：

```
 modelBuilder.Entity<Address>().Map<PersonalDetail>(m => m.Requires("AddressOf"));
        modelBuilder.Entity<PersonalDetail>().Map<AccountHolder>(m => m.Requires("PersonalDetailOf"));
        modelBuilder.Entity<PersonalDetail>().Map<Nominee>(m => m.Requires("PersonalDetailOf")); 
```

现在，当我尝试插入数据时，它会引发异常，即：

> 在表“地址”上引入 FOREIGN KEY 约束“FK_dbo.Addresses_dbo.Addresses_AccountHolder_AddressId”可能会导致循环或多个级联路径。指定 ON DELETE NO ACTION 或 ON UPDATE NO ACTION，或修改其他 FOREIGN KEY 约束。

谁能告诉我这是什么问题，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:30:28.707

你应该 WillCascadeOnDelete false

```
 modelBuilder.Entity<T>()
                    .HasRequired(e => e.)
                    .WithMany(t => t.)
                    .HasForeignKey(e => e.)
                    .WillCascadeOnDelete(false); 
```

或使用此代码\

```
 modelBuilder.Conventions.Remove<OneToManyCascadeDeleteConvention>(); 
```

# php - 将数据库纯文本作为 PHP 代码执行

> ID：15209356
> 
> 赞同：0
> 
> 时间：2013-03-04T19:21:37.943
> 
> 标签：php, output, plaintext

我将包含 HTML 和 PHP 的单个页面作为纯文本存储在数据库中，如下所示：

```
<body>
<h1>Welcome</h1>
<?PHP $welcome = "Hello"; 
      echo $welcome; 
?>
<br />
</body> 
```

并且期望的结果是执行混合了纯文本的 PHP 代码，所以上面的代码在浏览器中看起来像下面的 HTML：

```
<body>
<h1>Welcome</h1>
Hello<br />
</body> 
```

我正在使用一个简单的函数*ECHO*是从数据库到页面的纯文本，所以很明显，PHP 永远不会被视为 PHP。

您将如何将 PHP 从被解释为纯文本转换为作为实际 PHP 代码执行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T19:22:52.763

请看一下[eval()](http://www.php.net/eval)。

这会将 PHP 字符串评估为 PHP 代码。但是*要[**非常**](https://stackoverflow.com/questions/15209356/executing-database-plain-text-as-php-code/15209380#comment21435136_15209380)小心*。

# javascript - 不能改变变量

> ID：15209357
> 
> 赞同：0
> 
> 时间：2013-03-04T19:21:40.820
> 
> 标签：javascript, jquery

我有一些 JavaScript 代码（如下）。在每种情况下，在循环结束时 $sid 应该为零，但“alert($sid)”总是给我 200。我在我的代码中找不到错误。请你帮助我好吗？

提前致谢。

```
$sid = 200;
$canAppend = 0;
$iPage = 1;

while ($sid && $canAppend==0 && $iPage==1) {
    alert($sid);
    $.ajax({
    url: "tmp/result1.html",
    success: function(html)
    {
        if(html)
        {
            $("#inzeraty").append(html);
            $('div#loadmoreajaxloader').hide();
            $sid = 0;
        }            
    },
    error: function()
        {
            $sid = 0;
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:43:23.873

问题是ajax调用是异步的。JavaScript 将这个请求发送到服务器，然后继续执行下一行代码。直到 JavaScript 完成 while 循环的执行之后，才会调用您的成功和错误回调函数。

此外，代码的结构根本没有任何意义（对不起，不是故意粗鲁）。$canAppend 和 $iPage 变量未使用或更改。这段代码将做的是进入一个循环并且永远不会退出。为什么是这样？这是因为对 $.ajax() 的调用是非阻塞的。它不会等到请求完成，它会继续。由于 JavaScript（本质上）是单线程的，因此在当前执行过程完成之前，无法执行错误和成功的回调。因为无法运行成功和错误处理程序，所以无法设置 $sid。因为 $sid 不能被发送，所以代码不能退出 while 循环。

我看不到您的代码实际上是如何利用 while 循环的。相反，只需调用 $.ajax() 函数并在成功处理程序中处理结果。试试这个大小，以帮助您更好地了解发生了什么：

```
$sid = 200;

alert("$sid is 200: " + $sid); // you'll see this first

$.ajax({
    url: "tmp/result1.html",
    success: function(html)
    {
        if(html)
        {
            $("#inzeraty").append(html);
            $('div#loadmoreajaxloader').hide();
            $sid = 0;
            alert("$sid is now 0: " + $sid); // you'll see this third if html is not false
        } else {
            alert("$sid is STILL 200: " + $sid); // you'll see this third if html is false
        }
    },
    error: function()
    {
        $sid = 0;
        alert("you got an error, but $sid is now 0: " + $sid); // you'll see this third if there's an error
    }
});

alert("$sid is still 200: " + $sid); // you'll see this second 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-04T19:34:14.137

默认情况下，ajax 调用是异步的，成功或错误函数被推迟到 $.ajax 检索到 tmp/result1.html 之后。在您的情况下，它们将被永远推迟，因为 while 循环将保留手，$sid 将保持等于 200，并且您将继续堆积 ajax 调用。

一个快速的解决方法是让你的 ajax 调用同步：

```
$.ajax({
  url: "tmp/result1.html",
  async: false,
  success: function(html)
// etc. 
```

重写代码以避免混合使用 while 循环和 ajax 可能是一个更好的主意（但我不知道您的具体上下文）。

# java - Ivy declare dependencies on all artifacts under a repository directory

> ID：15209360
> 
> 赞同：0
> 
> 时间：2013-03-04T19:21:46.243
> 
> 标签：java, ant, ivy

Relatively new to Ivy here.

I have a growing list of projects that all publish to the same repository under the same organization. And I'm trying to find out how, if at all possible, I can declare dependencies from another project to artifacts created by all those projects.

My *ivisettings.xml* already has a resolver that points to that repository location. All artifacts in that repo are from the same organization. I trying to determine if there's a way to easily include artifacts in that location as dependencies from another project. I was hoping that I could do this using a wildcard for its names, like:

```
 <dependencies>
            <dependency org="my.org.name" name="**" rev="${current.iteration}" conf="master" />
    </dependencies> 
```

But of course the above doesn't work. So, any pointer/comment/pointer suggestion would be welcomed. I can't be the first guy to want to do this, so there's got to be a way to do this and maybe I'm just not using the right keywords in my searches. Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:31:01.943

发布一个额外的 ivy 文件，将所有其他项目列为依赖项列表。

```
<ivy-module version="2.0">
    <info organisation="my.org.name" module="projects" revision="1.0.0" status="release" publication="20130215110241"/>

    <dependencies>
        <dependency org="my.org.name" name="projectA" rev="1.0.0"/>
        <dependency org="my.org.name" name="projectB" rev="1.0.0"/>
        <dependency org="my.org.name" name="projectC" rev="1.0.0"/>
        ..
        ..
    </dependencies>

</ivy-module> 
```

为这个特殊的 ivy 模块创建单个依赖项，然后将其他项目工件作为传递依赖项拉入。

```
<dependency org="my.org.name" name="projects" rev="1.0.0"/> 
```

# 增强

您可以更进一步，创建不同的配置来对项目的工件进行分类：

```
<ivy-module version="2.0">
    <info organisation="my.org.name" module="projects" revision="1.0.0" status="release" publication="20130215110241"/>

    <configurations>
        <conf name="web-apps" description="Projects which provide functionality for webapps"/>
        <conf name="standalone" description="Projects which provide functionality for stand-alone java apps"/>
    </configurations>

    <dependencies>
        <dependency org="my.org.name" name="projectA" rev="1.0.0" conf="webapps->default"/>
        <dependency org="my.org.name" name="projectB" rev="1.0.0" conf="standalone->default"/>
        <dependency org="my.org.name" name="projectC" rev="1.0.0" conf="webapps->default;standalone->default"/>
    </dependencies>

</ivy-module> 
```

配置是一个非常有用的 ivy 功能​​。客户端构建可以使用映射来拉入与 webapp 或独立开发相关的工件。此功能类似于 Maven 中的“作用域”，但功能更强大。

# 更新：动态修订

发布“项目”模块时，您可能希望使用[动态修订](http://ant.apache.org/ivy/history/latest-milestone/ivyfile/dependency.html)来简化维护。

```
<ivy-module version="2.0">
    <info organisation="my.org.name" module="projects"/>

    <dependencies>
        <dependency org="my.org.name" name="projectA" rev="latest.release"/>
        <dependency org="my.org.name" name="projectB" rev="latest.release"/>
        <dependency org="my.org.name" name="projectC" rev="latest.release"/>
        ..
        ..
    </dependencies>

</ivy-module> 
```

[发布任务](http://ant.apache.org/ivy/history/latest-milestone/use/publish.html)将生成并推送使用每个项目的最新版本解析的 ivy 文件。

您仍然需要列出每个项目，但这实际上是一件好事。这意味着引入旧版本的“项目”模块将导致在某个时间点进行相同数量的修订。

## 生成常春藤文件

最后要完全自动化这个过程，使用可变数量的项目，也许你可以生成“项目”常春藤文件？

以下是您可以使用的[groovy 代码段](http://groovy.codehaus.org/The+groovy+Ant+Task)：

```
<groovy>
    import groovy.xml.MarkupBuilder

    new File("build/ivy.xml").withWriter { writer ->
        def xml = new MarkupBuilder(writer)
        xml."ivy-module"(version:"2.0") {
            info(organisation:"my.org.name", module:"projects")
            dependencies() {
                new File("/path/to/projects/directory").listFiles().each { dir ->
                    dependency(org:"my.org.name", name:dir.name, rev:"latest.release")
                }
            }
        }
    }
</groovy> 
```

# apache - Can't connect to a remote zookeeper from a Kafka producer

> ID：15209361
> 
> 赞同：4
> 
> 时间：2013-03-04T19:21:47.263
> 
> 标签：apache, timeout, distributed, apache-zookeeper

I've been playing with Apache Kafka for a few days, and here is my problem, If I set up the local test described in the "quick start" section on the website, everything is fine, the kafka producer/ consumer, zookeeper server and kafka broker work perfectly.

Now if I run on a remote server (let's call it node2) : - Zookeeper - port 2181 - Kafka Broker - port 9092 - kafka consumer

And then if I run from my local computer : - kafka producer

Assuming that there is no firewall on node2\. The connection end up with a timeout.

Here is the error log :

```
/etc/java/jdk1.6.0_41/bin/java -Didea.launcher.port=7533 -Didea.launcher.bin.path=/home/kevin/Documents/idea-IU-123.169/bin -Dfile.encoding=UTF-8 -classpath /etc/java/jdk1.6.0_41/lib/dt.jar:/etc/java/jdk1.6.0_41/lib/tools.jar:/etc/java/jdk1.6.0_41/lib/jconsole.jar:/etc/java/jdk1.6.0_41/lib/htmlconverter.jar:/etc/java/jdk1.6.0_41/lib/sa-jdi.jar:/home/kevin/Desktop/kafka-0.7.2/examples/target/scala_2.8.0/classes:/home/kevin/Desktop/kafka-0.7.2/project/boot/scala-2.8.0/lib/scala-compiler.jar:/home/kevin/Desktop/kafka-0.7.2/project/boot/scala-2.8.0/lib/scala-library.jar:/home/kevin/Desktop/kafka-0.7.2/core/target/scala_2.8.0/classes:/home/kevin/Desktop/kafka-0.7.2/core/lib_managed/scala_2.8.0/compile/jopt-simple-3.2.jar:/home/kevin/Desktop/kafka-0.7.2/core/lib_managed/scala_2.8.0/compile/log4j-1.2.15.jar:/home/kevin/Desktop/kafka-0.7.2/core/lib_managed/scala_2.8.0/compile/zookeeper-3.3.4.jar:/home/kevin/Desktop/kafka-0.7.2/core/lib_managed/scala_2.8.0/compile/zkclient-0.1.jar:/home/kevin/Desktop/kafka-0.7.2/core/lib_managed/scala_2.8.0/compile/snappy-java-1.0.4.1.jar:/home/kevin/Desktop/kafka-0.7.2/examples/lib_managed/scala_2.8.0/compile/jopt-simple-3.2.jar:/home/kevin/Desktop/kafka-0.7.2/examples/lib_managed/scala_2.8.0/compile/log4j-1.2.15.jar:/home/kevin/Documents/idea-IU-123.169/lib/idea_rt.jar com.intellij.rt.execution.application.AppMain kafka.examples.KafkaConsumerProducerDemo
log4j:WARN No appenders could be found for logger (org.I0Itec.zkclient.ZkConnection).
log4j:WARN Please initialize the log4j system properly.
Exception in thread "Thread-0" java.net.ConnectException: Connection timed out
    at sun.nio.ch.Net.connect(Native Method)
    at sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:532)
    at kafka.producer.SyncProducer.connect(SyncProducer.scala:173)
    at kafka.producer.SyncProducer.getOrMakeConnection(SyncProducer.scala:196)
    at kafka.producer.SyncProducer.send(SyncProducer.scala:92)
    at kafka.producer.SyncProducer.send(SyncProducer.scala:125)
    at kafka.producer.ProducerPool$$anonfun$send$1.apply$mcVI$sp(ProducerPool.scala:114)
    at kafka.producer.ProducerPool$$anonfun$send$1.apply(ProducerPool.scala:100)
    at kafka.producer.ProducerPool$$anonfun$send$1.apply(ProducerPool.scala:100)
    at scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:57)
    at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:43)
    at kafka.producer.ProducerPool.send(ProducerPool.scala:100)
    at kafka.producer.Producer.zkSend(Producer.scala:137)
    at kafka.producer.Producer.send(Producer.scala:99)
    at kafka.javaapi.producer.Producer.send(Producer.scala:103)
    at kafka.examples.Producer.run(Producer.java:53)

Process finished with exit code 0 
```

And here is my Producer's code :

```
import java.util.Properties;
import kafka.javaapi.producer.ProducerData;
import kafka.producer.ProducerConfig;

public class Producer extends Thread{

  private final kafka.javaapi.producer.Producer<String, String> producer;
  private final String topic;
  private final Properties props = new Properties();

  public Producer(String topic)
  {
    props.put("zk.connect", "node2:2181");
    props.put("connect.timeout.ms", "5000");
    props.put("socket.timeout.ms", "30000");
    props.put("serializer.class", "kafka.serializer.StringEncoder");
    props.put("producer.type", "sync");
    props.put("conpression.codec", "0");
    producer = new kafka.javaapi.producer.Producer<String, String>(new ProducerConfig(props));
    this.topic = topic;
  }

  public void run() {
      String messageStr = new String("Message_test");
      producer.send(new ProducerData<String, String>(topic, messageStr));
  }
} 
```

**So I also tested to switch

```
props.put("zk.connect", "node2:2181"); 
```

by

```
props.put("broker.list", "0:node2:9082"); 
```

And in that case I can connect successfully.**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T22:09:55.573

[请参阅http://kafka.apache.org/faq.html](http://kafka.apache.org/faq.html)中的第 3 项

解决方法是在 Kafka 的 server.properties 中显式设置主机名属性

您可以使用 Zookeeper 来验证这一点。如果您使用的是 kafka 0.7*，请打开 ZkCli 控制台并获取 /brokers/ids/0，您应该会获取所有代理元数据。确保此处的 IP 地址/主机名与您在生产者代码中使用的 Zk 连接字符串匹配 -

```
props.put("zk.connect", "node2:2181"); 
```

就我而言，我正在使用在本地机器上运行的生产者连接到 ubuntu VM（相同的机器，不同的 IP），这种解决方法很有帮助。

# ruby-on-rails-3 - How to access virtual attributes of model in a nested form with Rails

> ID：15209362
> 
> 赞同：1
> 
> 时间：2013-03-04T19:21:48.427
> 
> 标签：ruby-on-rails-3, nested-forms, virtual-attribute

I have a basic nested form. I want to access a virtual attribute for the nested form's model.

```
Model 1: Lease
  Has_many :transactions
  accepts_nested_attributes_for :transactions, :reject_if => lambda { |a| a[:dated].blank? }, :allow_destroy => true
  ...

Model 2: Transaction
  belongs_to :lease
  def balance_to_date(aDate)
    #Returns the current balance up to aDate
    ...
  end
  ... 
```

In the nested form I want to put something like:

```
<td style="width:100px;"><%= nested_f.text_field :dated, size: 8 %> </td>
<td style="width:100px;"><%= nested_f.text_field :label, size: 8 %> </td>
<td style="width:100px;"><%= nested_f.text_field :credit, size: 6  %> </td>
<td style="width:100px;"><%= nested_f.text_field :debit, size: 6  %> </td>
<td style="width:100px;"><%= nested_f.balance_to_date(:dated) %> </td> 
```

And I want the following to give me the balance to date.

> nested_f.balance_to_date(:dated)

Or to be able to do something like

Running the code as shown here gives me:

```
undefined method `balance_to_date' for#<ActionView::Helpers::FormBuilder:0xac78bac> 
```

Other than the virtual attribute error, this form works as expected.

The code should produce an editable table of transactions with the balance up to that point. ( [xx] are my way of showing input fields ).

```
 Dated         Label      Credit    Debit   Balance  
 [ 1/1/2012 ]  [ Rent due ] [       ] [ 600 ]  -600  
 [ 1/2/2012 ]  [ Payment  ] [ 600   ] [     ]  0 
 [ 2/1/2012 ]  [ Rent due ] [       ] [ 600 ]  -600 
 [ 2/2/2012 ]  [ Payment  ] [ 500   ] [     ]  -100 
 [ 3/1/2012 ]  [ Rent due ] [       ] [ 600 ]  -700 
 [ 3/6/2012 ]  [ late fee ] [       ] [ 50  ]  -750 
 [ 3/7/2012 ]  [ Payment  ] [ 800   ] [     ]  50 
 [ 4/1/2012 ]  [ Rent due ] [       ] [ 600 ]  -550 
```

Any advice on how to access and display that virtual attribute of the model and the date from the current record being displayed would be really appreciated. I hope I haven't duplicated a previous question.

I'm using Rails 3.2.12 and Ruby 1.9.3.

Thanks! Phil

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T23:18:39.080

如果我了解您要做什么，那么您已经很接近了。您只需深入一层即可访问表单构建器正在使用的模型对象：

```
<td style="width:100px;"><%= nested_f.object.balance_to_date(:dated) %> </td> 
```

# powershell-2.0 - Ping in startup script

> ID：15209363
> 
> 赞同：0
> 
> 时间：2013-03-04T19:21:51.767
> 
> 标签：powershell-2.0

Can ping command be used in a startup script to check connectivity to a network server ? Powershell startup script:

```
$Ping=new-object System.Net.NetworkInformation.Ping
$Reply=$ping.send("MyServer01")
if ($Reply.status() -eq "Success")
{
Perform operations
}
Else
{Perform other operations} 
```

Rightnow, the $reply is blank during startup script execution but has values if I run after logged in.

Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T12:02:21.640

Test-Connection 应该可以正常工作，但它不返回字符串“True”，而是返回布尔值 $True。所以：

```
if (Test-Connection "MyServer01" -Quiet) {
    Some-Command
} else {
    Other-Command
} 
```

这在我的盒子（W2K3、Powershell 2、.NET 4.5）上运行良好。

PS：如果你只是运行`cmd`, `ping MyServer01`，它会工作吗？

# .htaccess - htaccess redirects are "ignored"

> ID：15209364
> 
> 赞同：0
> 
> 时间：2013-03-04T19:21:54.027
> 
> 标签：.htaccess

Have looked at all the other posts regarding this, but can't seem to get it to work. There are a number of unrelated reasons why I can't change the Joomla config, items, etc., but in any event, it seems that these should work regardless of that.

In short, I want *any* link with *Itemid=30* in it to redirect to the one given. What am I doing wrong? The first 3 are what I've tried, that last line is one that is working.

```
RedirectMatch 301 ^Itemid=30$ http://inside.beta.oursite.com/index.php?option=com_cware&view=courses&Itemid=125

redirect 301 index.php?option=com_cware&view=courses&Itemid=30 http://inside.beta.oursite.com/index.php?option=com_cware&view=courses&Itemid=125

RewriteEngine On
RewriteCond %{QUERY_STRING} Itemid=30
RewriteRule ^Itemid=30/$ index.php?option=com_content&view=article&id=106&Itemid=121 [R=301]

# If query string contains "username=admin"
RewriteCond %{QUERY_STRING} username=admin
# Block it without mercy
RewriteRule .* - [F] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T22:03:30.957

[`Redirect`](http://httpd.apache.org/docs/current/mod/mod_alias.html#redirect) considers only URL paths, which excludes the query string. If you want to take the query string into account, you must employ [`mod_rewrite`](http://httpd.apache.org/docs/current/mod/mod_rewrite.html).

Same applies to [`RewriteRule`](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewriterule)

> If you wish to match against the hostname, port, or query string, use a RewriteCond with the %{HTTP_HOST}, %{SERVER_PORT}, or %{QUERY_STRING} variables respectively.

Therefore, if you want to match some query string and redirect all URLs to some other URL, use a RewriteCond in combination with RewriteRule

```
RewriteEngine On
RewriteCond %{QUERY_STRING} Itemid=30
RewriteRule .* index.php?option=com_content&view=article&id=106&Itemid=121 [R=301] 
```

This redirects any URL `.*` with the query string containing `Itemid=30` to `index.php?option=com_content&...`

# c - Asynchronous streams in CUDA do not yield increase in performance

> ID：15209367
> 
> 赞同：1
> 
> 时间：2013-03-04T19:22:04.680
> 
> 标签：c, cuda

I am trying to accelerate the following bit of CUDA code by using multiple streams.

```
#define N (4096 * 4096)
#define blockDimX  16
#define blockDimY  16

float domain1 [N];
float domain2 [N];

__global__ updateDomain1_kernel(const int dimX, const int dimY) {
    // update mechanism here for domain1
    // ...
}

__global__ updateDomain2_kernel(const int dimX, const int dimY) {
    // update mechanism here for domain2, which is nearly the same
    // ...
}

__global__ addDomainsTogether_kernel(float* domainOut, 
                                     const int dimX, 
                                     const int dimY) 
{
    // add domain1 and domain2 together and fill domainOut
}

void updateDomains(float* domainOut) {
    dim3 blocks((dimX + blockDimX - 1) / blockDimX , (dimY + blockDimY- 1) / blockDimY);
    dim3 threads(blockDimX, blockDimY);

    updateDomain1_kernel<<<blocks, threads>>> (dimX, dimY);
    updateDomain2_kernel<<<blocks, threads>>> (dimX, dimY);
    addDomainsTogether_kernel<<<block, threads>>> (domainOut_gpu, dimX, dimY);
    cudaMemcpy(domainOut, domainOut_gpu, N * sizeof(float), cudaMemcpyDeviceToHost);
} 
```

The precise implementation doesn't really matter; what's important is that updating the respective domains are two completely independent operations, after which both are used in the third kernel call. Hence I thought it a good idea to try to accelerate it by putting each update kernel in its own stream, which I want to run simultaneously. So I changed it to the following:

```
void updateDomains(float* domainOut) {
    dim3 blocks((dimX + blockDimX - 1) / blockDimX , (dimY + blockDimY- 1) / blockDimY);
    dim3 threads(blockDimX, blockDimY);

    cudaStream_t stream0, stream1;
    cudaStreamCreate(&stream0);
    cudaStreamCreate(&stream1);

    updateDomain1_kernel<<<blocks, threads, 0, stream0>>> (dimX, dimY);
    updateDomain2_kernel<<<blocks, threads, 0, stream1>>> (dimX, dimY);
    cudaDeviceSynchronize();

    addDomainsTogether_kernel<<<block, threads>>> (domainOut_gpu, dimX, dimY);
    cudaMemcpy(domainOut, domainOut_gpu, N * sizeof(float), cudaMemcpyDeviceToHost);

    cudaStreamDestroy(stream0);
    cudaStreamDestroy(stream1);
} 
```

I presumed to find a difference in performance speed, but there is absolutely no noticeable difference. So thinking that maybe the compiler was being smart the first time by automatically scheduling the update calls at the same time, I assumed that the following should slow down the performance:

```
void updateDomains(float* domainOut) {
    dim3 blocks((dimX + blockDimX - 1) / blockDimX , (dimY + blockDimY- 1) / blockDimY);
    dim3 threads(blockDimX, blockDimY);

    cudaStream_t stream0;
    cudaStreamCreate(&stream0);

    updateDomain1_kernel<<<blocks, threads, 0, stream0>>> (dimX, dimY);
    updateDomain2_kernel<<<blocks, threads, 0, stream0>>> (dimX, dimY);

    addDomainsTogether_kernel<<<block, threads0, stream0>>> (domainOut_gpu, dimX, dimY);
    cudaMemcpy(domainOut, domainOut_gpu, N * sizeof(float), cudaMemcpyDeviceToHost);

    cudaStreamDestroy(stream0);
} 
```

However, again there is hardly any difference in performance speed. If anything, the last one seems fastest. Which makes me think there is something about CUDA streams I do not understand. Can someone enlighten me on how accelerate this code?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:24:05.600

*如果您还没有*使用所有可用的内核，则增加的并行性只会增加您的计算吞吐量。如果您已经拥有足够的并行度，那么除了增加同步开销之外，它对您无济于事。

# php - photo upload working on local host but not on server?

> ID：15209368
> 
> 赞同：0
> 
> 时间：2013-03-04T19:22:08.050
> 
> 标签：php, mysql, forms

hi i have a photo upload script which is working fine on my local host but when i upload it to my ftp server it doesn't upload the file. any ideas why this is, i get no error or anything just doesn't upload the file.

heres my index.php file:

```
 <div id="areas">

                <input type="file" class="droparea spot" name="xfile" data-post="upload_image_1.php"  data-width="90" data-height="90" data-crop="true"/>

                <form id="sampleform" action="post_image_1.php" method="post">

                </form>
                <script>
                    $('#sampleform').submit(function(e){
                        e.preventDefault();
                        $.ajax({
                            url:$(this).attr('action'),
                            type:'post',
                            data:$(this).serialize(),
                            dataType:'json',
                            success:function(r){
                                $('#form-result').append(
                                '<div><b>Title: </b>'+r.title+'</div>'
                                ,'<div><b>Description: </b>'+r.description+'</div>'
                                ,'<div><b>Image/File: </b>'
                                  +'<a href="'+ r.url +'" target="_blank">'+ r.url +'</a>'
                                  +'</div>'
                                );
                            }
                        });
                });
                </script>
            </div>

            <script>
            // Calling jQuery "droparea" plugin
            $('.droparea').droparea({
                'init' : function(result){
                    //console.log('custom init',result);
                },
                'start' : function(area){
                    area.find('.error').remove(); 
                },
                'error' : function(result, input, area){
                    $('<div class="error">').html(result.error).prependTo(area); 
                    return 0;
                    //console.log('custom error',result.error);
                },
                'complete' : function(result, file, input, area){
                    if((/image/i).test(file.type)){
                        area.find('img').remove();
                        //area.data('value',result.filename);
                        area.append($('<img>',{'src': result.path + result.filename + '?' + Math.random()}));
                    } 
                    //console.log('custom complete',result);
                }
            });
            </script>

            <!-- /development area -->
        </div> 
```

here's my post.php file:

```
<?php

// LOG
$log = '=== ' . @date('Y-m-d H:i:s') . ' ===============================' . "\n"
        . 'FILES:' . print_r($_FILES, 1) . "\n"
        . 'POST:' . print_r($_POST, 1) . "\n";
$fp = fopen('post-log.txt', 'a');
fwrite($fp, $log);
fclose($fp);

// Result object
$r = new stdClass();
// Result content type
header('content-type: application/json');

$data = $_POST['thumbnail'];
unset($_POST['thumbnail']);

if($data){

    // Uploading folder
    $folder = '../'. '../'. 'data/'. 'photos/'. $_SESSION['user_id'] . '/';
    if (!is_dir($folder))
        mkdir($folder);
    // If specifics folder 
    $folder .= $_POST['folder'] ? $_POST['folder'] . '/' : '';
    if (!is_dir($folder))
        mkdir($folder);

    $filename = $_POST['value'] ? $_POST['value'] :
            $folder . sha1(@microtime() . '-' . $_POST['pic1']) . '.mp4';

            $filename = addslashes($filename);

$sql=mysql_query('INSERT INTO ptb_photos SET file_name ="$filename",id="$_SESSION[user_id]", user_id="$_SESSION[user_id]"');

    $data = split(',', $data);
    file_put_contents($filename, base64_decode($data[1]));

}
die(json_encode(array_merge(array('url' => $filename), $_POST)));

?> 
```

And lastly heres my upload.php file:

```
<?php
session_start()
?>
<?

// LOG
$log = '=== ' . @date('Y-m-d H:i:s') . ' ===============================' . "\n"
        . 'FILES:' . print_r($_FILES, 1) . "\n"
        . 'POST:' . print_r($_POST, 1) . "\n";
$fp = fopen('upload-log.txt', 'a');
fwrite($fp, $log);
fclose($fp);

// Result object
$r = new stdClass();
// Result content type
header('content-type: application/json');

// Maximum file size
$maxsize = 10; //Mb
// File size control
if ($_FILES['xfile']['size'] > ($maxsize * 1048576)) {
    $r->error = "Max file size: $maxsize Kb";
}

// Uploading folder
$folder = '../'. '../'. 'data/'. 'photos/'. $_SESSION['user_id'] . '/';
if (!is_dir($folder))
    mkdir($folder);

// If specifics folder 
$folder .= $_POST['folder'] ? $_POST['folder'] . '/' : '';
if (!is_dir($folder))
    mkdir($folder);

// PASS USER_ID HERE
$folder2 = '../'. '../'. 'data/'. 'photos/'. $_SESSION['user_id'] . '/';
if (!is_dir($folder2))
    mkdir($folder2);

// New directory with 'files/USER_SESSION_ID/'
$folder = $newDir . $folder2;

// If the file is an image
if (preg_match('/image/i', $_FILES['xfile']['type'])) {

    $filename = $_POST['value'] ? $_POST['value'] :
            $folder . 'thumb_pic1.jpg';

} else {

    $tld = split(',', $_FILES['xfile']['name']);
    $tld = $tld[count($tld) - 1];
    $filename = $_POST['value'] ? $_POST['value'] :
            $folder . sha1(@microtime() . '-' . $_FILES['xfile']['name']) . $tld;
}

// Supporting image file types
$types = Array('image/png', 'image/gif', 'image/jpeg');
// File type control
if (in_array($_FILES['xfile']['type'], $types)) {
    // Create an unique file name    
    // Uploaded file source
    $source = file_get_contents($_FILES["xfile"]["tmp_name"]);
    // Image resize
    imageresize($source, $filename, $_POST['width'], $_POST['height'], $_POST['crop'], $_POST['quality']);
} else
// If the file is not an image
if (in_array($_FILES['xfile']['type'], $types)) 
    move_uploaded_file($_FILES["xfile"]["tmp_name"], $filename);

// File path
$path = str_replace('upload_image_1.php', '', $_SERVER['SCRIPT_NAME']);

// Result data
$r->filename = $filename;
$r->path = $path;
$r->img = '<img src="' . $path . $filename . '" alt="image" />';

// Return to JSON
echo json_encode($r);

// Image resize function with php + gd2 lib
function imageresize($source, $destination, $width = 0, $height = 0, $crop = false, $quality = 80) {
    $quality = $quality ? $quality : 80;
    $image = imagecreatefromstring($source);
    if ($image) {
        // Get dimensions
        $w = imagesx($image);
        $h = imagesy($image);
        if (($width && $w > $width) || ($height && $h > $height)) {
            $ratio = $w / $h;
            if (($ratio >= 1 || $height == 0) && $width && !$crop) {
                $new_height = $width / $ratio;
                $new_width = $width;
            } elseif ($crop && $ratio <= ($width / $height)) {
                $new_height = $width / $ratio;
                $new_width = $width;
            } else {
                $new_width = $height * $ratio;
                $new_height = $height;
            }
        } else {
            $new_width = $w;
            $new_height = $h;
        }
        $x_mid = $new_width * .5;  //horizontal middle
        $y_mid = $new_height * .5; //vertical middle
        // Resample
        error_log('height: ' . $new_height . ' - width: ' . $new_width);
        $new = imagecreatetruecolor(round($new_width), round($new_height));
        imagecopyresampled($new, $image, 0, 0, 0, 0, $new_width, $new_height, $w, $h);
        // Crop
        if ($crop) {
            $crop = imagecreatetruecolor($width ? $width : $new_width, $height ? $height : $new_height);
            imagecopyresampled($crop, $new, 0, 0, ($x_mid - ($width * .5)), 0, $width, $height, $width, $height);
            //($y_mid - ($height * .5))
        }
        // Output
        // Enable interlancing [for progressive JPEG]
        imageinterlace($crop ? $crop : $new, true);

        $dext = strtolower(pathinfo($destination, PATHINFO_EXTENSION));
        if ($dext == '') {
            $dext = $ext;
            $destination .= '.' . $ext;
        }
        switch ($dext) {
            case 'jpeg':
            case 'jpg':
                imagejpeg($crop ? $crop : $new, $destination, $quality);
                break;
            case 'png':
                $pngQuality = ($quality - 100) / 11.111111;
                $pngQuality = round(abs($pngQuality));
                imagepng($crop ? $crop : $new, $destination, $pngQuality);
                break;
            case 'gif':
                imagegif($crop ? $crop : $new, $destination);
                break;
        }
        @imagedestroy($image);
        @imagedestroy($new);
        @imagedestroy($crop);

    }
}

?>
<?php 
if($_FILES['xfile']['name'])
{
  $target_dir = '../'. '../'. 'data/'. 'photos/'. $_SESSION['user_id'] . '/';

  $upload_file_name = basename( $_FILES['xfile']['name']);
  $upload_file_ext = pathinfo($_FILES['xfile']['name'], PATHINFO_EXTENSION);

  $target_file = $target_dir . 'pic1.jpg';
  $target_file_sql = $target_dir . mysql_real_escape_string($upload_file_name . '.');

  if (move_uploaded_file($_FILES['xfile']['tmp_name'], $target_file)) 
  {  

    if (copy($target_file, $target_thumb))
    {

    }
  }
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:25:32.307

你有CHMOD吗？所以不要把文件夹 CHMOD 到 777

# c++ - How do I input variables using cin without creating a new line?

> ID：15209370
> 
> 赞同：17
> 
> 时间：2013-03-04T19:22:24.890
> 
> 标签：c++, windows, visual-studio

Whenever I input a variable using `cin`, after one hits enter it automatically goes to a new line. I'm curious if there's a way to use `cin` without having it go to a new line. I'm wanting to `cin` and `cout` multiple things on the same line in the command prompt. Is this possible?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-04T20:16:27.180

您不能`cin`为此使用或任何其他标准输入。但肯定有可能达到您想要的效果。我看到您在 Windows 上使用 Visual Studio，因此您可以使用例如[_getch](http://msdn.microsoft.com/en-us/library/078sfkak.aspx)。这是一个读取到下一个空格并将结果存储在字符串中的示例。

```
#include <conio.h> // for _getch

std::string get_word()
{
    std::string word;
    char c = _getch();
    while (!std::isspace(c))
    {
        word.push_back(c);
        std::cout << c;
        c = _getch();
    }
    std::cout << c;
    return word;
} 
```

这不是很好。例如，它不能很好地处理非打印字符输入。但它应该让你知道你需要做什么。您可能还对[Windows API 键盘功能](http://msdn.microsoft.com/en-us/library/windows/desktop/ff468857%28v=vs.85%29.aspx)感兴趣。

如果您想要更广泛的受众，您将需要研究一些跨平台库，例如[SFML](http://www.sfml-dev.org/)或[SDL](http://www.libsdl.org/)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-08-29T13:23:30.703

您还可以使用空格进行输入，而不是输入如下内容：

```
cin >> a >> b >> c; 
```

并在输入中键入

```
10 20 30 
```

然后

```
a=10
b=20
c=30 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-04T19:41:28.213

正如其他人所指出的，您不能使用 来执行此操作`cin`，但可以使用 来执行此操作`getchar()`。你需要做的是：

1.  使用单独收集每个字符（例如，在读入时`getchar()`将每个字符添加到 a 的末尾），然后`string`
2.  读取每个字符后，决定何时到达一个变量值的末尾（例如，通过检测`' '`输入中的一个或多个字符，如果您正在读取`int`或`double`值），然后
3.  如果您已到达变量文本的末尾，请将您构建的字符串转换为适当类型的变量（例如`int`，`double`等），然后
4.  将任何内容输出到可能需要的行上，然后
5.  继续您正在读取的下一个变量。

稳健地处理错误会很复杂，所以我没有为此编写任何代码，但您可以看到可以使用的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-04T19:34:54.093

我不认为你想做的事情可以用cin来实现。您可以做的是将所有输入写在一行中，并使用您选择的分隔符，然后解析输入字符串。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-04T19:34:38.883

这不可能。引用@Bo Persson 的话，它不是由 C++ 控制的，而是控制台窗口。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-07T19:53:25.190

只需使用 gotoxy 语句。您可以按“输入”并在同一行中输入值，例如。在 3*3 矩阵的输入中：

```
#include<iostream.h>
#include<conio.h>
void main()
{clrscr();
int a[20][20],x,y;
cout<<"Enter the matrix:\n ";
for(int r=2;r<7;r+=2)
for(int c=2;c<7;c+=2)
{gotoxy(c,r);
cin>>a[r][c];
}
getch();} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-09-08T12:40:38.530

我无法发表评论，但如果你在整数之间留有空格，那么你可以获得所需的效果。这`cin`也适用。

```
int a, b, c;
cin>>a; cin>>b; cin>>c; 
```

如果您输入您的值，`10 20 30`那么它们将分别存储在 a、b 和 c 中。

# php - PHP登录/注销如果会话超时=真做某事

> ID：15209373
> 
> 赞同：3
> 
> 时间：2013-03-04T19:22:29.420
> 
> 标签：php, session, login, logout, session-timeout

我有一个脚本可以登录和注销用户。它完美地工作。现在我有一个小部件，它可以计算注册和激活的用户数量以及在线用户数量。我通过在我的用户数据库中有一个字段表示 online = 1 或 0 来做到这一点。当这个人登录时，online = 1 并注销 online = 0。现在我没有考虑到这个字段只是被更新因为用户正在做某事。我没有考虑到会话会超时。

如何创建一个函数，如果会话超时 = true 然后更新用户设置在线 = 0 其中用户名 = $ 用户名和 user_id = $ user_id。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T19:29:07.613

在您的数据库表中，添加另一列，例如`last_seen`. 每次看到您的用户在线时更新此信息。在一段时间不活动后，它们将被标记为不活动。事实上，我建议你`online`用这个替换你的字段。

例如，

```
ALTER TABLE users CHANGE COLUMN `online` `online` DATETIME; -- SAMPLE SQL query only 
```

要检查有多少用户在线：

```
SELECT * FROM users WHERE online>(NOW()-INTERVAL 1 HOUR); -- SELECTS all users online in the past hour. 
```

如果用户注销，您可以简单地设置`online = NOW()-INTERVAL 1 HOUR`. 或者，您也可以保留以前的`online`字段，并且可以检查用户是否空闲（使用我的建议）或`online=0`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T19:28:01.480

与其尝试使用布尔值来查看是否有人登录，不如尝试使用 TIMESTAMP。然后，您可以根据某人离开的时间执行更准确的逻辑。如果有人最后一次在您的网站上加载页面是 30 分钟前，您认为他们在线吗？你甚至认为他们在他们的键盘上吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T19:29:20.317

添加 lastOnline 字段，该字段存储上次用户活动的时间戳。在页面上有一些 ajax 函数，每“n”秒更新一次时间戳。

要检查用户是否在线 - 同时检查：在线字段和时间戳。如果时间戳在“n”秒前更新 - 即使在线字段等于 1，用户仍处于离线状态。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T19:28:18.917

会话只有在您希望它这样做时才会超时。这个问题实际上与“[如何使 PHP 会话过期？](https://stackoverflow.com/questions/520237/how-do-i-expire-a-php-session-after-30-minutes)'

代码仅在提供 php 页面时执行，因此您需要跟踪用户上次活动的时间，我使用会话变量来跟踪页面上次提供给该用户的时间。然后，每当向用户提供任何 php 页面时，请检查超时期限是否已过，如果已过，请注销用户，请参阅[链接](https://stackoverflow.com/questions/3068744/php-session-timeout)以获取示例。

# ruby-on-rails - 将 to_sentence 与 HAML 和 mongoid 一起使用

> ID：15209376
> 
> 赞同：0
> 
> 时间：2013-03-04T19:22:35.393
> 
> 标签：ruby-on-rails, ruby, haml

我知道这应该很简单，但我是 ruby​​、haml 和 rails 的新手。

我想显示特定律师的位置列表。我想将它们转换为“to_sentence”，所以除了最后一个位置之外，每个位置后面都有逗号。

这就是我的`show.html.haml`观点。

```
%ul
- @lawyers.each do |lawyer|
  - if lawyer == @lawyer
    %li.active
      %article
        %h3= lawyer.full_name
        - unless lawyer.phone.nil?
          .phone== Direct #{lawyer.phone}
        .email
          = mail_to lawyer.email, lawyer.email
        - unless @lawyer.office_locations.empty?
          - if @lawyer.office_locations.count > 1
            .locations_list
              %ul
                %li Locations:
                - @lawyer.office_locations.each do |office_location|
                  %li.locations== #{office_location.city}
          - else
            .locations_list
              %ul
                %li Location:
                - lawyer.office_locations.each do |office_location|
                  %li== #{office_location.city} 
```

编辑：这是我尝试过的。

```
 - unless @lawyer.office_locations.empty?
          - if @lawyer.office_locations.count > 1
            .locations_list
              %ul
                %li Locations:
                %li== lawyer.office_locations.collect{ |p| "#{p.office_locations.city}"}.to_sentence 
```

我不知道它是否有所不同，但是`lawyer`它们`office_location`是两个独立的模型，它们都是 HABTM。

我知道这是错误的做法，但我似乎无法获得`to_sentece`或`.pluralize`工作。我尝试在这篇文章中使用答案[Ruby on Rails 似乎是由 link_to 创建的自动转义 html，](https://stackoverflow.com/questions/5434767/ruby-on-rails-seems-to-be-auto-escaping-html-created-by-link-to)但我无法让它工作。

我假设我可能想把这个逻辑放在一个助手中？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:38:09.183

这一行有一个问题：

```
%li== lawyer.office_locations.collect{ |p| "#{p.office_locations.city}"}.to_sentence 
```

您正在从关系中调用`.office_locations`每个。我怀疑你想要这个块。`p``lawyer.office_locations``{ |p| "#{p.city}"}`

如果你想复数“Location/s”，你可以用一个参数调用复数方法： `"Location".pluralize(1)`将返回“Location”，并且 `"Location".pluralize(2)`（或任何大于 1 的值）将返回“Locations”。因此，您可以将其添加到您的模板中：

```
%li= "Location".pluralize(lawyer.office_locations.count) 
```

# java - 网址缩短器重定向到 index.html

> ID：15209381
> 
> 赞同：0
> 
> 时间：2013-03-04T19:22:54.307
> 
> 标签：java, tomcat, servlets, jetty, stack-overflow

是的，又一个用 java 编写的 url 缩短器，因为我想要自己的，为什么不呢。目前一切正常，只是不是我想要的方式。总之，整个项目中只有一个映射到“/”的servlet。没有涉及任何框架或任何花哨的东西，这只是一个基本的 Servlet“项目”。在 doPost 上创建了一个新的 shortUrl，您会收到一个 JSON 响应。在 doGet 上，如果 URL 是“/*{any_valid_short_url}”，则发送重定向（如下）。

```
response.sendRedirect("longUrlString") 
```

我遇到的问题是索引页面，当调用相同的 doGet 时，我检查请求的路径，如果它是“/”，那么目前，我使用 FileInputStream 并通过 response.getOutputStream 将 index.html 页面输出（ )，在我看来这很 hacky。我想改用 requestDispatcher，但是当我尝试实现它时（如下），我进入了重定向循环，并且 servlet 容器（jetty 或 tomcat）堆栈溢出。

```
getServletContext().getRequestDispatcher("/index.html").forward(req, res); 
```

我对这是如何完成的有什么误解吗？该项目目前托管在我的 github 页面上。 [https://github.com/justinmburrous/ShortUrl](https://github.com/justinmburrous/ShortUrl)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T11:20:49.210

您需要使此检查范围更窄，因为对于所有请求，此条件都为真，因此所有请求都会一次又一次地转发到“index.html”

```
 if(requestedPath.equals("/")){

    //tried with multiple variations of /index.html, renamed to jsp, etc...
RequestDispatcher dispatcher = request.getRequestDispatcher("index.html");
dispatcher.forward(request, response);    
    } 
```

**编辑：** 由于您的 servlet 被映射为默认 servlet ，所有转发或请求都将由该 Servlet 处理。您应该将 url 映射到更具体的范围。

[RequestDispatcher - forward - 产生无限循环](https://stackoverflow.com/questions/13934909/how-to-let-servlet-mapping-to)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:56:25.430

好的，感谢**[How to access static resources when mapping a global front controller servlet on /*](https://stackoverflow.com/questions/870150/how-to-access-static-resources-when-using-default-servlet/3593513#3593513)**

我的 github 页面包含过滤器、修改后的 servlet 和 web.xml 的工作代码。

# javascript - 将 Javascript 字典转换为 python 字典

> ID：15209386
> 
> 赞同：4
> 
> 时间：2013-03-04T19:23:14.483
> 
> 标签：javascript, python, dictionary

在我的 Django 应用程序的某个地方，我对我的视图进行了 Ajax 调用

```
$.post("/metrics", {
  'program': 'AWebsite',
  'marketplace': 'Japan',
  'metrics': {'pageLoadTime': '1024'}
}); 
```

在我的python代码中，我有

```
@require_POST
def metrics(request):
    program = request.POST.get('program', '')
    marketplace = request.POST.get('marketplace', '')
    metrics = request.POST.get('metrics', '')
    reportMetrics(metrics, program, marketplace) 
```

python中的`metrics()`函数应该`reportMetrics()`使用这些参数调用，然后应该进入日志文件。但是在我的日志文件中，我没有看到“pageLoadTime”值——可能是因为它是作为字典传入的。将来我需要为此添加更多项目，因此它需要保留一个字典（而不是像前两个那样的字符串）。

将此传入的 javascript 字典转换为 python 字典的最简单方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T19:27:16.803

将 javascript 字典作为 json 发送并导入 python`json`模块以将其拉回。您将使用 json.loads(jsonString)。

**编辑 - 添加示例**

```
$.post("/metrics", {
   data: JSON.stringify({
      'program': 'AWebsite',
      'marketplace': 'Japan',
      'metrics': {'pageLoadTime': '1024'}
   })
}); 
```

然后在python方面

```
import json
def metrics(request):
    data = json.loads(request.POST.get('data'))
    program = data.get('program','')
    marketplace = data.get('marketplace','')
    metrics = data.get('metrics','') 
```

我现在真的没有很好的测试方法，但我相信它应该可以工作。您可能还需要检查某个字段是否为空白，但我相信`.get()`会为您处理。

# html - 使用缩进和对齐在图像周围环绕文本

> ID：15209389
> 
> 赞同：26
> 
> 时间：2013-03-04T19:23:15.537
> 
> 标签：html, css

我想做这样的东西。

问题是我需要`p`有一个缩进并证明对齐。

我可以将图像浮动到左侧，然后将显示`h3`和设置`p`为内联，但是我无法设置缩进，更重要的是无法使文本对齐。

[![](../Images/069c6298b511c4f504e5d358622cd3fd.png)](https://i.stack.imgur.com/nV97r.jpg)

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-03-04T19:27:22.460

```
img {
    float: left;
    margin: 0 20px 20px 0;
}

p {
    text-align: justify;
    text-indent: 2em;
} 
```

这是小提琴：http: [//jsfiddle.net/9VkQR/](http://jsfiddle.net/9VkQR/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-02-19T07:48:17.330

另一种方法可以做到这一点。它还可以使用[shape-outside](https://developer.mozilla.org/en-US/docs/Web/CSS/shape-outside)属性来控制图像周围的浮动文本。

```
.wrapper {
  width: 35rem;
}

h3 {
  line-height: 2rem;
  margin-bottom: -0.6rem;
}

p {
  text-align: justify;
  text-indent: 2em;
}

img {
  width: 11rem;
  height: 11rem;
  float: left;
  margin: 0 2rem 1rem 0;
}

.shape {
  shape-outside: inset(0 0 0 0);
}

.circle {
  shape-outside: circle(50%);
}
```

```
<div class='wrapper'>
  <img class='shape' src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxASEA8QEg8PEhESDxUVFRUVFRAPFRcVFRUXFxUTExUYHSggGBolHRYXITEhJSkrLi4uFx8zODMsNygtLisBCgoKDg0OFxAQFy0lICYtLS0tLS0tLS0tKy0tKystLS0rLSstLS0tKy0tLS0tLS0tLS0tLS0tKy0tLS0tLS0tLf/AABEIAOEA4QMBEQACEQEDEQH/xAAbAAEAAQUBAAAAAAAAAAAAAAAABgEDBAUHAv/EAEcQAAEDAgIHBAYHBgQFBQAAAAEAAgMEESExBQYSQVFhcQcTgZEiMkKhsfAUI1JicoLBM0OSssLRRGOi8SRTVNLhFyU0c5P/xAAaAQEAAgMBAAAAAAAAAAAAAAAAAwQBAgYF/8QAPBEAAgEDAQUFBwMBBwUBAAAAAAECAxExBAUSIUFhE1FxgdEiMpGhscHhFCPwQhUzNENScvFFU2OC0iT/2gAMAwEAAhEDEQA/AO3oBfcEAJ3BACd29ACbcygBNuqAXtmgF95QAHecEAB37kBYqq6KMXkljjbuL3NZfpdYckssjqVYU1eckvE0lVrtQsJAlc+32GuPkTYe9RutBFKptXTQ/qv4I1k/aND7FPMfxFjPhdaPULuKstuUliD+S9TFd2kHdSDxlv8A0LX9Q+4h/t3/AMfz/AHaQ7/pB/8Aqf8AsT9Q+75hbdfOn8/wZEPaPH7VNIPwva/4gLb9R0JIbcg/eg1539DY02vdE71nSxn7zCf5brZV4lmntfTSy2vFelzdUWlqeX9nPE88GuBd/DmpFOLwy9T1FKp7kk/MzL7ytiYA7ygAO/cgAN+iAA36IBfggBO4IATuGaAE+aArdAEBQ8EBTkEAywGfziUAy5koBlzJQDLE5/OAQDmUAJA9JxAAxxwA5lA3Yi+l9eKWK4jvO4bm4M8X7/C6hlXiscTytRtehT4R9p9MfH0IdpPXOsmuBIImH2Y/RPi71vIhQSqyZ41fauoqcE7Lp65I/I8uJLiSTmSSSfEqI85ybd27sosmoQz1YWB4hBkIMhDGRzQz4G40brPWQ22ZnOaPZk+sb78R4ELeNSUcMu0do6ilwjK668SX6J1/ifZtQwxH7TbvZ1IzHvU8a65ns6fbVOXCqrPvyvX6kvp6hkrQ9j2vYci0hwPiFOmnxR7EJxmrxd0XM+iybDPAZIByCAZYBAMsN6AZcyUBUC2JzQFUBQncEBTLAZ/OJQDLmSgGXMlAMsTn84BAOZQGj1g1ngpcHHblt6MbTiOBefZ+PJRzqqPiUdXtClp1Z8Zd3r3HN9N6xVNUT3j7R3wjbdrB1HtHqqkpylk5nVa6rXdpPh3LH5NStCngqGk5IYbSyexDzS5rvnsRBYua7zyeg0cAhi7eSqwYyEGSmyOAWRd8ihjHBLm288I8GHmlzO/yLbmHgsmykuRRDbBmaM0pPTu2oZHM4jNruTmnAraMnHiiahqalB3hK30Oh6va6xT7MU1oZThf9248Gk+qeR81ZhWT4M6TR7Vp1bRqcJfJ+hK+QU56wywCAZYb0Ay5koBlic/nAICoG8oCqAoTuGaAplzJQDLmSgGWJz+cAgHM/wCyAgmteuti6GmIvk6XMDlHxP3vLiq1StyieDr9rW/boPjzfp6kBc4kkkkkm5JxJJzJKrnOttu7yGtJWDDaiXWxBYuRuRcWDUIOrCAIMhBkIAgCAIAgweHRg8lm5spNFp7CFk3TR5Q26sleq2uUkGzDNeSHIOzfH0+03l5cFNTquPB4PX0O1JUrQq8Y/Nfg6XTzsexr2OD2vFwQbgjiraaaujp4zjNKUXdFzLmSsmwyxOfzgEA5lAVA3lAVugKE26lAUy5koBlic/nAIBzP+yA5vrnrYZS6ngdaIYPePb4tafs/HpnUq1b8EcztLaXaXpUnw5vv/H18Mw1QHi4Pccd+iNmjlYvgcMlqRhAEHVhAEGQgyEAQBAEAQYCDAQDkg6lqSLgs3N4y7y0skmTfaq6yvpH2N3wuPpM3j77OB5b/AHqSnUcH0PQ0Gvlp5WfGPNfdHWKWoY9jZWOD2vF2kbxyV1NNXR10JxnFSi7plzmVk2HMoCoxx3ID1dAeSbdUBTLE5/OAQDmUBA9ftZfWpIncpXDd/ljnx8uKrVqn9KPA2tr7XoU/N/b1ICqxz2C5HHfE5I2aSlbgi8tSPAQBB1YQBBkIMhAEAQBAEGAgwEAQdWEAQZLcke8ZrKZtGRZWxJkk2peshppO7kP1Dzj/AJbj7Y5cfPdjJSqbrs8Hq7N17oT3Je6/l19TqjTf0sLbt46q6dYM8Tl84lAVGPT4oD0gPJwxQFOZQGh1w059FguCO+ku2McOLz0+JCiqz3VwyUNoav8AT0uHvPHr5HJHOJJJJJJuScSTxKpHHNu/U9RMv0Rs0k7F9akeAgCDqwgCDIQZCAIDYavwNkqqdjwC10guDkRwK3gk5JFvQwjPUQhJXTZtNe6OOOpZ3bGsa6EOIaA0X2nC9hlkFvXSUuBc2zRhSrpQVrrl4sjahPIwEGAgCDqwgCDIQZCAtSs3rKZvGXItLJJ0R0Ts809tt+iSn0mC8RO9ozaeY3cuitUJ/wBLOk2RrN5djJ8Vjw7vIm2fT4qwe4VvfogPSA8niUB5e4AF7iA1oJxyAGZKGG0ldnGtZNLGqqHy47HqxjgwZeJz8VQnLedzi9bqnXquXLC8DWNbc2WhTb3UZIG7ctSEIAg6sIAgyEGQgCAIDaar/wDzKb/7Qt6fvou7O/xVPxNv2jG9VHw7gfzvUuo97yL+3v7+P+37siirnh4CAIOrCAIMhBkIAgCDwLEjLHktkSxfA9UlQ6ORkjDZzHBzTzHHksp2d0S06kqclKOUdp0RpBtTBHM3Brm4jg4YOb4G6vwlvK52+nrKtTjNczNvuGS2JitkBQjedyAiXaJpXu6cQg2dObfkb6xPXAdCVBXlZW7zyNsans6O4sy+nM5iqhy2C/C3BYZFJntYNQg6sIAgybbVimp5KhrKgnZcCGi5aHPw2WkjIZ+NlJTUXK0i9s6nRq11Gtjl4mVrTq26ldttu6FxwOZafsu/Q71mrScH0J9o7NlpnvR4wfy8SPqI8oIAgPUUha4OaSC0ggjAgjIhZwbRk4NOL4l2trJJn7cj3Pda1zwG4cAjbfFm9WtOrLfqO7LCwRBB1YQGx0JoiSpk7tgsBi95yaOJ58BvW8IObsi1o9HU1VTdjjm+42muGiqWm7mOJzjLY7YJ2sMLOdwJ4Bb1oRjZIvbV0un0+5Gm/a5+r6kaUJ44QBAEBR7bhZMp2MZbEuCa9mulNmR9KT6Mnps/G0ekB1aL/lU9CVnunu7F1G7J0nz4rx5/zodGvuCtHSFbIChHkgOQ666R7+slIN2R/Vt6Mz/1Fyo1ZXkzjtp1+01ErcuC8vyaNgubKM89uyuZK1IQg6sIAgyEGQgJvqvrKyRn0WrIILdlr35EfYeTv4H9c7NOqmt2R0mztpRqR7DUeCb59H6/ci2m6eKOolZE/bjB9E32sxci++2V+SgmkpNI8TWU6dOtKFJ3RgrUrBBgIMBAEHVhAe4mguaCbAkAnOwJxPgsm0UpSSbsifV+maagp2w0pZJI4X2gWvz/AHjyMzwH6K1KpGnG0Tp62soaKiqenab+Pm+v8wQGaVznOe5xc5xuScSSVVycxOcpycpPieFg1CAIAgwEGCxMMVsiSL4FyhqnRSxys9aN4cPA5eOXisp2dyejUdKcai5M7hTzNexjmYte0OB5OFwV6Cd1c7qElKKksMurJsYemKvuoJpf+XG5wHEgYDzstZPdTZFXqdlSlPuRw8knPHiV55wjfNl2AZrDI5l1YNOrCAIMhBkIAgCAIC/RUckzxHGwvcdw+JO4cyspNuyJaNGdWW5TV2TfROojMHVDy8/ZZ6LehdmfCytQ0/8AqOj02woR41nd9yx6/Q3Z0dQQixjpYxxf3d/N6l3KceSPR/T6OguMYrxt9yrafR8vosbRv/D3Lj/pxS1OXcFT0dXglB+FvsazSmpFO8fUl0T/ABezxBxHgfBRy08XjgU9RsShU40/ZfxRBtLaJmpn7ErbXycMWu5g/pmq0oOLszm9TpKunlu1F58n4GCtCtkIAgCAIAgwEGAgPEww6LKNo54lhZJerOr9n9b3lExubonOYenrN9zgPBXKLvE67ZNXtNMl3cCTKY9Ii3aNU7NEW/8AMlY3yu8/yqGu7RPL2xU3dM13tL7/AGOVqockZEQwC1ZHLN2elg1CDIQZCAIAgCAvUdM+WRkbBdz3AAfqeW9ZSbdkSUqUqk1COWdT0Vo6CigNyAALyyHAuP8AbcB+qvxjGnE7XTaaloqPF+L7/wCckQ7T2uM0pLICYosrjB7up9noPNVp128cDwNbtipUbjS9mPzfoRhziSSSSTmTifNQHjNtu7KIYN5obWiopyBtGWPex5J/hdm34clLCrKPgelpNqV6D4u8e5/Zk/ikpq6mOG21+BBsHsePgR84FW/ZqxOojKhrqHen8U/U5nprRj6aZ0T8bYtP2mnIj5zBVKcXF2Zx2r0stPVdOXl1XeYC0KwQBAEGAgwEAQAjcg6mKtibJOuy2ps6pivm1rwOhLXH3tVjTvi0dBsOpxnDwf8APkdCVo6EgfanN6NLHxdI4+AaB/MVW1DwjwduTtGnHxf0Ofqsc71ZlDgtSDPEIMhBkIAgCAIAgwTbs40eHGWoI9X6tvUi7/cWjxKs6eOZHRbB069qs/Bff7FntB0sXSClYfQjsX23vIuB4C3ieSxqJ3e6abb1blNUVhZ8fwQ9VzwOoQBBkIMm81Q0saeobc/VykMeOvqu8CfIlS0p7suh6Wy9W6FdL+l8H9mSztA0dt0wmt6cLh/A4gEedj4FWNRG8b9x7m29P2lDtFmP0ZzdUjkQgCDAQYCAIAgCDJjPzPVbEy4okvZ1Ns1zR9uJ7fcH/wBKmov2z1djztqbd6fr9jqyuHWHOu1J31tMOEbj5uH9lV1GUc5tx+3DwZCAq54PUylqQ5CDIQBAb3VbQLat0gdLsbDQbAAuN7447hb3hS06e+3xPS2boY6qUk5Wt8WSIdn8f/USfwtU36Zd5639gU/9b+RodaNXW0ojc2bbDyRsuAa7DHaFsx/4UVWluW4nmbR2dHSKLjK9+TyR5QnlYOo6jMtQxW9pzyT+cj4AK9QXsI7TY8baSHW/1ZzrTEpfUTu4zP8ALaNvcqcneTZyerlvV5yfe/qYa1K4QZCDIQBB4HXJ/rqBznfvKS/8Ud79V6D9qn5Hdz/e0jffH6o5GvPOENpq5ooVU4iMndjZLr5k2tg0ccfcVvThvO1y7oNKtRV7NytwuSr/ANP4z/iJLfharH6Zd57f9gU/9b+RqtZNVWU0PetnLrOA2XANvf7Nt4UdSjuK9ylr9lQ01LtFO/R8yLKA8QIAgCDJjy5lbIljxRutSHWr6Y/eePONwUlL30ejsx//AKoW6/RnYFeOxOcdqI+vp+cR/m/8qpqPeRze3F+5B9CFBQHhZMpakOQgCAIAgCDAQYCA6fqHPtUTGjNj3tPL0tr4OCvUHeB2WxpqWliu5tfO/wBzn+n6cx1VQzhK4jo47Q9xCqTVpNHL62m6eoqRfe/nxMehha+SNjn7DXOALrXtfeQtUrviRUYRqVIxk7JvPcb7SeqZhkc01EDWO/ZmR4a533SLYcL5KWVGzyj09Rsl05tdpFLld8X/ADvMZmrMh2WtmpXSE2LBK0ubfLrfkteybw18SFbMnK0YzjfuuuBb1k0M2ldGzvdt7ow54tbZPI7wcbb8EqQ3Glc11+jjpZRgpXbXHoahrSSABck2A5lRlBJt2R1vSH1NDJfKOlLR1DNke9ehL2ab8Duq37Okku6NvlY5GvPOEwEGAgCAIAgCDIQGPLmVsiWOLI3OpQ/4+m/E7+Rykpe+j0Nmf4qHn9Gdhurx2Rz/ALVI8aR3ESD+Qj4lVtQuKOe27H+7fj9iBqseBkygtSAIAgCAIMBBgIAg6slvZ9pQRyupybCXFt8g8bvEfAKxp52du893Yeq3KjpSxLHj+TYa/wChS4CqjF3NbaQDE7Iyf4ZHlbgt9RT/AKkWtt6JzXbx5Z8O/wAiBKocxkmdA4V9E6Bx/wCJpxeMnNzch5+qfylWY/uQ3eaOhotbQ0jpP34Y6/zD8mWdUaaOCKXSM2IYC2NuFy7IkczfZHUrWklFObI9l0oUactXU5cF/Pl8SM1tW+aR8shu57rn9AOQGHgoW23dnj1q0qs3OWWSHUbQplmE7x9VEbi/tPGQHTPyU1CF3fuPV2PonUqdrJezH5v8G37RNKARspmnF5DnfhafRv1OP5VJqJ8N0vbc1SjTVFZfF+H/AD9CAKocvgIAgCAIMhBkIAgMeTMrYlWLEg7P4tqviO5jXu/0FvxcFLR99HqbJjfVR6X+h1q6unXEQ7Tae9LG/eyYeTmkfGyg1C9lM8fbUN6gpdzOZKoctkyIzgCsEUs2PSwYCAIMBBgIAg6sID0x5aQQSHAggjAgjIhDMW07rkdN1W1kZUMEchAqALEZB4+039Qr1KqpcHk7HZ20Y6mO7L3vr4Gq1j1MbZ80Dg2wLnRn1cMT3Z3dPgo6lDnEpa7Y0XepRduduXl6GF2cft5j/kf1NWun95lfYP8Aez/2/cAf+yk/5/8AWsf5PmP+lef3LGqmq/0kd9I/ZiDiNkes4ixNzuGP+yUqW/xZHs3Za1C7Sb9m/m/QmOl9KwUULWhrRZto4m4X5ng2+Z/VWJzjTVj3tVqqOipJJeC/nLqcvrqt80j5Xm7nm5PwA5AYeCottu7ONrVZVZupPLLCwRBAEAQBBkIAgCDojFPFbE2OBM+zCnvUTybmQhvi9wP9BU9Be02e5sOn+5OXcrfH/g6UrZ0pqdaaPvaOpZa7u7Lmjmz0gB4haVFeLRV1tLtNPOPT6cTjCoHE9C9AcFhkc+hcWDQIMBBgIAg6sIDYaF0RLUyd3GMsXOPqtHE/oFvCDm7ItaTR1NVPdh5vki3pbR7qeZ8Li0uaRiMiCAQeWBWJRcXZmuq08qFV05PBYponucO7a9zxiNgOLsN4tisK7wRU4zlK1NNvpk6+2NzqYB19t1Pb0r32iy2PO69CzcfI71RlKjbm4/OxHtT9XZ6aWSSXu7Oi2Rsu2sdoHHDkoqNKUHxPK2Zs+rppylO3FW4CLV2c6N+inYbJ3u1i70bbV7kgFYVKXZ7vMR2fV/Q9hw3r+WTa6q6KfTwd1IWE9453okkWIHEDgpKUHCNmXdnaWemo7k2r3b4EV1w1dkZ3tX3veB0uIsRstcbNxubgYBQVqTV5XPF2ps6cN7Ub1+OO5Pz8ERSJhc5rRm5wA3Yk2CgPDhFykkss2+ndW5qUNc4tew4Fzb2a77Jv7it50nDJf1mzaumSlLiu9d5pVGecEGQgyEAQBAeZDgVkzHJjrYmwdN7NKQtpXyH97Kbc2s9Ee/aVqgvZudRsWlu0HJ839P4yYKc9g8kDMoDienqDuKmaK1g152fwnFvuIXnyjuto4fV0exrSgu/5cjCiOK1ZVkuBkLUiwEGAgCDqwgM/Qui31MwiYQDbac45NaLXdzzGHNbwg5uyLOk0s9VUUI+fRE10tpOHRsIp4ADMRfGxIJ/eScTwH6KzOaprdjk6PU6mls+l2NFe1/OL6/zBz6aVznOe5xc5xuScSSVUycrOcpycpPiTTs1gbeplPrAMaOQNybdbDyVnTLLOh2BBfuT58ESypryxxH0eoktvY1mzj95zgFO525M9ypXcZbqhJ+CX3aLX0+d2IopQN23JAzzs4rG9L/T9DTt6rxSfm4+rHf1rsqenaPvTvP8ALGl59y+P4G/qX/RFf+z/APkbNa726Vg5Nlk/qant9DNtU+cV5N/dFrW14FFUXtbYA/MSALDrZYre4yPaUlHS1N7u+ZyZUDhicaraxtkb9DqbO2hstc7EOB9h/Pgd/XO1Sq3W7I6TZu0lVj2Go434Jvn0f2f3NLrXq+aR4LTtRSE7JOYO9rv7qKrT3H0PO2ls96ae8vdeOnQ0KiPMyEAQBAEBanO5bIkgrFtjS4gAXJNgOJOQQkSbaSydu0RRiGCGEZRsAJ4u9o+JuV6EY7qSO509JUqUYLkjOstiY8kbygID2maMv3VUBgPq3+8scfePJVq8cSPA23p+Eay8H9iBKsc9gyGOuFghasz0sGAg6sIAgyX6OskheHxvcx9rXHA7uYWU2ndEtKtOlLepuzLcsrnOL3OLnONySbkk80yaTnKcm27s8LBqTTs1DtuoPsBjb/iudn3bXuVnTZZ0OwN7eqWxw+P8uTwY4nJWzpgTfE4BAY02kIW+tNE0c3sb8StXKK5kU69KHvTS8WjHfp+kyFTEfwuDz0Abda9rDvIXrtMv8xfG/wBDG1xgElFMB7LQ8H8JB+F/NYrK8GRbUpqppZ9OPwOUqgcQEBk1ekJpQwSSveGCzdo3t82zWzk3lk1XUVaySnJtLBjLUhCAIAgBPksgxXG6yTJWJJqFovvqtryPq4PTd+L2B54/lUtGN5eB6mydP2ldSeI8fT18jq99wV060rZAUI45IDF0nRNqIZIX+o9pHO+5w6Gx8FiUd5WIq1KNWnKEsM4pW0r4pHxPFnMcWnw3jkc/Fee1Z2Zw9WnKlNwllFuN1jyWGRSXAyFqRdWEAQZCDIQBAEBNuzWcbVRGcyGPHRtwfiPNWdM+LR0ewKiTqQ58GS2p0XFK4vf3p5d7M1uH3A4AeSsOCbuz3J6aE5b0r/F2+F7GO/RFEDd0MHV9nE+Llh06fNIjek0q4yjHz/J5+k6OjwD6JluBhB6WCxvU13GqqaKnhwXwKSaz0LcBUM/KHO/lCdtDvMS2lpIf5i8vwaHWrWmnkpnwwOc5zyATsubZt7k3Ixva3ioqtaMo2R5m0dqUalBwpO7fRrgQVVTmshBkIAgCAIAgwWpnbllG8FbiWlkkOvanaI+jUzWkWlk9OTkTk3wGHW6vUobsTstnabsKKTy+L/nQ3vIKQvFUBQi/RAUz6ICE9oug9tv0uNvpMAEtt7NzvDfy6KvXh/Ujw9saTej20VxWfDv8vp4HO1VOb6svRP3LDI5LmXFg0yEGQgCAIAgLkE72HaY9zDa12ktNuFwsptYN4VJU3eDafQ9y1crvWlkd1c4/Epd95tKtUfvSb82dC1d0ZQTwMeyniJsBIDdxDwMRifkK3Tp05K9jqtDptHWoxnGCvz52fmbh2jqSNpd3FOxrRdzthgAA4myl3ILki/8Ap9PTTluRS8Ecr01VtlqJZGNDWOd6Itb0QLA23XAuqE3vSbOK1lWNWvOcVwb4GEtSsEGQgCAIAgCDB5kfZZRtFGOskmCVag6C7+bvnD6qFwI4OkzA8MCfBTUYbzuz19k6Ptanaywvm/wdQ5BXDqiuWG/5xQFUBQi/RAUzwGSAo4AgtsCCLHeLcEDVzk2uOrxpJbsBMEhOwc9k5lhPw4joVSqU919DkNo6H9PPeXuvHToR9RHm5L8b79Vhojkj2sGoQBAEAQYCDAQF+krJInbUUj2O4tJb4HisptcUSUq1Sk96Emn0L1bpWomAbJM944E4dbDC6y5SllklbV1qy/cm2jCWpXyEGQgCAIAgCDBR7rLJlIx3OuskqVjO0JoqSqmbDHhfFzswxu9x/txW0YuTsizpdNPUVFGP/B2PR9EyCJkMQs1gt/dx4knFX4xUVZHaUqUaUFCOEZGWAz+cSskhUYdSgKoCh4ICnIIBlgEBj6Qoo5o3QyN2mvGPHk4HcQsSipKzI6tKNWDhNcGcj1j0FJSS7DvSY6+w/c4cDwcN4VGcHF2Zx+t0c9POzxyf85mpWhSyXo5OOaw0Ryj3FxYNQgCDAQYCAIAgCDIQZCAIAgCAIMHl77LNjKiWHOuskqVjI0dQyTyNhibtPd5Ab3OO4BZSbdkTUKE601GK4s65q7oSOki7tnpSOsZH2xcf7DcP7lXoQUUdho9JDTQ3Vnm+/wDBtcsBn84lblsZcyUBUYdSgKoChO4ICmWAQDLDegGXMlAY2kaCKaN0crdprvMHcWncQtZRUlZkVajCtBwmro5VrLq1LSOubvhJ9GQD/S/g73FU503A5PW6Cpp33x7/AFNGoyh0R7ZJxySxo49xea66waNWKrBjAQBAEAQBBkIAgCAIAT5LILT5eCJG6hbJaWTfBnaH0TNUyCOJt/tOODWji4raMXJ2RZ02lqaie7Bfg6vq/oKKkj2GelI623IRiT+g4BXYU1BHW6TRw00LRzzff+Da5YDP5xK3LYy5koBljv8AnAICoG85oCqAoTuGaAplhvQDLmSgGWJz+cAgHMoDxLE17XB7Q5pFi0gEEcxvRq5iUVJNNcCA6xaiuG1LS4tz7on0h+AnPoceqqzoW4xOe1mx2rzofD0IRIwglrgWkGxBBBB4EHJQHhSi4uzXE8grBqXGzFLGrgXBIFixruvLPSwa+IQZCDIQBAEHQoXjismbPkW3TcAljZQsWy4lZN0rFEMko1d1MmqLPl2oYeYs9w+605dT5FTQpOXFnq6PZVSt7VThH5s6To+gigYIoWBrR53+047yrUYqKsjpqVGFKO7BWRk5YDP5xK2JRlzJQDLHf84BAMsSgKgbygPSA8k+aAplzJQDLE5/OAQDmUA5lAM8Tl84lAM+nxQGs0zoCnqx9Yz0gMJG+i8dDvHI3C0lTjLJV1Ojpahe2uPfzIHpfUWpjuYSJ2DhZrx+U4HwPgq0qMljieBqNj1afGn7S+ZF5onMcWOa5rhmHAtI6gqI8mUJRdpKzPCwY6sA2QxnJ6Eh4pYxuple9KWG6mO9KWG6sFO8PFLDdXI8kk5oZslgLJnAAvgsBIkGiNT6uexLO5j+1Jdp/KzM+4c1LGlKR6On2XXq8Wt1dfQnehNUqanIcB3so9t9jY/cbkPeeasQoxjxPf0uzaNDja7739jf8gpT0BlgM/nEoBlzJQDLHf8AOAQDLEoBzKAqMcSgK3QAoCgFsTmgAG8oABvKAWvickAtfp8UAOPRADwGSAHgEBjVtBDK3ZkijkH3mh1uYOYPRYcU8ojqUadRWnFPxI3XagUrv2bpYjwB7xviHY+9QuhF4PMq7GoS91tfP6+po6rs8qG/s5oX/i2oz5WI96jdCXJlCpsSqvdkn8vU1k2pte39xtc2vjP63WrpT7irLZWqXDc+aMV2rVaM6WbwbtfBa9nLuI3s/Urh2bKN1crT/hZv4SE3Jdxj9Bqf+2zIi1Qr3f4Zw6ujb8XLPZT7iRbM1TxD5r1NjS9n1W713wxjq558gLe9bKhIs09i137zSN3Q9nkAsZZpJOTQIgfifepFp1zZepbEpR4zk38iR6P0LTQYQwsZ96207ptG596ljCMcI9KjpaNH3IpfX4mwPALcsDkEAyyz+c0AtbmUAAtjvQADec0AA3lALXxKAZ9EB6QFEAQBACgKlAEAQFAgAQBAVQFEAQBACgBQFUAQAICgQBAEAQBAEBVAUKAqgKID/9k="
    alt="bulb">
  <h3>This is a heading</h3>
  <p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim
    veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt
    in culpa qui officia deserunt mollit anim id est laborum. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
</div>
<hr>
<div class='wrapper'>
  <img class='circle' src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxASEA8QEg8PEhESDxUVFRUVFRAPFRcVFRUXFxUTExUYHSggGBolHRYXITEhJSkrLi4uFx8zODMsNygtLisBCgoKDg0OFxAQFy0lICYtLS0tLS0tLS0tKy0tKystLS0rLSstLS0tKy0tLS0tLS0tLS0tLS0tKy0tLS0tLS0tLf/AABEIAOEA4QMBEQACEQEDEQH/xAAbAAEAAQUBAAAAAAAAAAAAAAAABgEDBAUHAv/EAEcQAAEDAgIHBAYHBgQFBQAAAAEAAgMEESExBQYSQVFhcQcTgZEiMkKhsfAUI1JicoLBM0OSssLRRGOi8SRTVNLhFyU0c5P/xAAaAQEAAgMBAAAAAAAAAAAAAAAAAwQBAgYF/8QAPBEAAgEDAQUFBwMBBwUBAAAAAAECAxExBAUSIUFhE1FxgdEiMpGhscHhFCPwQhUzNENScvFFU2OC0iT/2gAMAwEAAhEDEQA/AO3oBfcEAJ3BACd29ACbcygBNuqAXtmgF95QAHecEAB37kBYqq6KMXkljjbuL3NZfpdYckssjqVYU1eckvE0lVrtQsJAlc+32GuPkTYe9RutBFKptXTQ/qv4I1k/aND7FPMfxFjPhdaPULuKstuUliD+S9TFd2kHdSDxlv8A0LX9Q+4h/t3/AMfz/AHaQ7/pB/8Aqf8AsT9Q+75hbdfOn8/wZEPaPH7VNIPwva/4gLb9R0JIbcg/eg1539DY02vdE71nSxn7zCf5brZV4lmntfTSy2vFelzdUWlqeX9nPE88GuBd/DmpFOLwy9T1FKp7kk/MzL7ytiYA7ygAO/cgAN+iAA36IBfggBO4IATuGaAE+aArdAEBQ8EBTkEAywGfziUAy5koBlzJQDLE5/OAQDmUAJA9JxAAxxwA5lA3Yi+l9eKWK4jvO4bm4M8X7/C6hlXiscTytRtehT4R9p9MfH0IdpPXOsmuBIImH2Y/RPi71vIhQSqyZ41fauoqcE7Lp65I/I8uJLiSTmSSSfEqI85ybd27sosmoQz1YWB4hBkIMhDGRzQz4G40brPWQ22ZnOaPZk+sb78R4ELeNSUcMu0do6ilwjK668SX6J1/ifZtQwxH7TbvZ1IzHvU8a65ns6fbVOXCqrPvyvX6kvp6hkrQ9j2vYci0hwPiFOmnxR7EJxmrxd0XM+iybDPAZIByCAZYBAMsN6AZcyUBUC2JzQFUBQncEBTLAZ/OJQDLmSgGXMlAMsTn84BAOZQGj1g1ngpcHHblt6MbTiOBefZ+PJRzqqPiUdXtClp1Z8Zd3r3HN9N6xVNUT3j7R3wjbdrB1HtHqqkpylk5nVa6rXdpPh3LH5NStCngqGk5IYbSyexDzS5rvnsRBYua7zyeg0cAhi7eSqwYyEGSmyOAWRd8ihjHBLm288I8GHmlzO/yLbmHgsmykuRRDbBmaM0pPTu2oZHM4jNruTmnAraMnHiiahqalB3hK30Oh6va6xT7MU1oZThf9248Gk+qeR81ZhWT4M6TR7Vp1bRqcJfJ+hK+QU56wywCAZYb0Ay5koBlic/nAICoG8oCqAoTuGaAplzJQDLmSgGWJz+cAgHM/wCyAgmteuti6GmIvk6XMDlHxP3vLiq1StyieDr9rW/boPjzfp6kBc4kkkkkm5JxJJzJKrnOttu7yGtJWDDaiXWxBYuRuRcWDUIOrCAIMhBkIAgCAIAgweHRg8lm5spNFp7CFk3TR5Q26sleq2uUkGzDNeSHIOzfH0+03l5cFNTquPB4PX0O1JUrQq8Y/Nfg6XTzsexr2OD2vFwQbgjiraaaujp4zjNKUXdFzLmSsmwyxOfzgEA5lAVA3lAVugKE26lAUy5koBlic/nAIBzP+yA5vrnrYZS6ngdaIYPePb4tafs/HpnUq1b8EcztLaXaXpUnw5vv/H18Mw1QHi4Pccd+iNmjlYvgcMlqRhAEHVhAEGQgyEAQBAEAQYCDAQDkg6lqSLgs3N4y7y0skmTfaq6yvpH2N3wuPpM3j77OB5b/AHqSnUcH0PQ0Gvlp5WfGPNfdHWKWoY9jZWOD2vF2kbxyV1NNXR10JxnFSi7plzmVk2HMoCoxx3ID1dAeSbdUBTLE5/OAQDmUBA9ftZfWpIncpXDd/ljnx8uKrVqn9KPA2tr7XoU/N/b1ICqxz2C5HHfE5I2aSlbgi8tSPAQBB1YQBBkIMhAEAQBAEGAgwEAQdWEAQZLcke8ZrKZtGRZWxJkk2peshppO7kP1Dzj/AJbj7Y5cfPdjJSqbrs8Hq7N17oT3Je6/l19TqjTf0sLbt46q6dYM8Tl84lAVGPT4oD0gPJwxQFOZQGh1w059FguCO+ku2McOLz0+JCiqz3VwyUNoav8AT0uHvPHr5HJHOJJJJJJuScSTxKpHHNu/U9RMv0Rs0k7F9akeAgCDqwgCDIQZCAIDYavwNkqqdjwC10guDkRwK3gk5JFvQwjPUQhJXTZtNe6OOOpZ3bGsa6EOIaA0X2nC9hlkFvXSUuBc2zRhSrpQVrrl4sjahPIwEGAgCDqwgCDIQZCAtSs3rKZvGXItLJJ0R0Ts809tt+iSn0mC8RO9ozaeY3cuitUJ/wBLOk2RrN5djJ8Vjw7vIm2fT4qwe4VvfogPSA8niUB5e4AF7iA1oJxyAGZKGG0ldnGtZNLGqqHy47HqxjgwZeJz8VQnLedzi9bqnXquXLC8DWNbc2WhTb3UZIG7ctSEIAg6sIAgyEGQgCAIDaar/wDzKb/7Qt6fvou7O/xVPxNv2jG9VHw7gfzvUuo97yL+3v7+P+37siirnh4CAIOrCAIMhBkIAgCDwLEjLHktkSxfA9UlQ6ORkjDZzHBzTzHHksp2d0S06kqclKOUdp0RpBtTBHM3Brm4jg4YOb4G6vwlvK52+nrKtTjNczNvuGS2JitkBQjedyAiXaJpXu6cQg2dObfkb6xPXAdCVBXlZW7zyNsans6O4sy+nM5iqhy2C/C3BYZFJntYNQg6sIAgybbVimp5KhrKgnZcCGi5aHPw2WkjIZ+NlJTUXK0i9s6nRq11Gtjl4mVrTq26ldttu6FxwOZafsu/Q71mrScH0J9o7NlpnvR4wfy8SPqI8oIAgPUUha4OaSC0ggjAgjIhZwbRk4NOL4l2trJJn7cj3Pda1zwG4cAjbfFm9WtOrLfqO7LCwRBB1YQGx0JoiSpk7tgsBi95yaOJ58BvW8IObsi1o9HU1VTdjjm+42muGiqWm7mOJzjLY7YJ2sMLOdwJ4Bb1oRjZIvbV0un0+5Gm/a5+r6kaUJ44QBAEBR7bhZMp2MZbEuCa9mulNmR9KT6Mnps/G0ekB1aL/lU9CVnunu7F1G7J0nz4rx5/zodGvuCtHSFbIChHkgOQ666R7+slIN2R/Vt6Mz/1Fyo1ZXkzjtp1+01ErcuC8vyaNgubKM89uyuZK1IQg6sIAgyEGQgJvqvrKyRn0WrIILdlr35EfYeTv4H9c7NOqmt2R0mztpRqR7DUeCb59H6/ci2m6eKOolZE/bjB9E32sxci++2V+SgmkpNI8TWU6dOtKFJ3RgrUrBBgIMBAEHVhAe4mguaCbAkAnOwJxPgsm0UpSSbsifV+maagp2w0pZJI4X2gWvz/AHjyMzwH6K1KpGnG0Tp62soaKiqenab+Pm+v8wQGaVznOe5xc5xuScSSVVycxOcpycpPieFg1CAIAgwEGCxMMVsiSL4FyhqnRSxys9aN4cPA5eOXisp2dyejUdKcai5M7hTzNexjmYte0OB5OFwV6Cd1c7qElKKksMurJsYemKvuoJpf+XG5wHEgYDzstZPdTZFXqdlSlPuRw8knPHiV55wjfNl2AZrDI5l1YNOrCAIMhBkIAgCAIC/RUckzxHGwvcdw+JO4cyspNuyJaNGdWW5TV2TfROojMHVDy8/ZZ6LehdmfCytQ0/8AqOj02woR41nd9yx6/Q3Z0dQQixjpYxxf3d/N6l3KceSPR/T6OguMYrxt9yrafR8vosbRv/D3Lj/pxS1OXcFT0dXglB+FvsazSmpFO8fUl0T/ABezxBxHgfBRy08XjgU9RsShU40/ZfxRBtLaJmpn7ErbXycMWu5g/pmq0oOLszm9TpKunlu1F58n4GCtCtkIAgCAIAgwEGAgPEww6LKNo54lhZJerOr9n9b3lExubonOYenrN9zgPBXKLvE67ZNXtNMl3cCTKY9Ii3aNU7NEW/8AMlY3yu8/yqGu7RPL2xU3dM13tL7/AGOVqockZEQwC1ZHLN2elg1CDIQZCAIAgCAvUdM+WRkbBdz3AAfqeW9ZSbdkSUqUqk1COWdT0Vo6CigNyAALyyHAuP8AbcB+qvxjGnE7XTaaloqPF+L7/wCckQ7T2uM0pLICYosrjB7up9noPNVp128cDwNbtipUbjS9mPzfoRhziSSSSTmTifNQHjNtu7KIYN5obWiopyBtGWPex5J/hdm34clLCrKPgelpNqV6D4u8e5/Zk/ikpq6mOG21+BBsHsePgR84FW/ZqxOojKhrqHen8U/U5nprRj6aZ0T8bYtP2mnIj5zBVKcXF2Zx2r0stPVdOXl1XeYC0KwQBAEGAgwEAQAjcg6mKtibJOuy2ps6pivm1rwOhLXH3tVjTvi0dBsOpxnDwf8APkdCVo6EgfanN6NLHxdI4+AaB/MVW1DwjwduTtGnHxf0Ofqsc71ZlDgtSDPEIMhBkIAgCAIAgwTbs40eHGWoI9X6tvUi7/cWjxKs6eOZHRbB069qs/Bff7FntB0sXSClYfQjsX23vIuB4C3ieSxqJ3e6abb1blNUVhZ8fwQ9VzwOoQBBkIMm81Q0saeobc/VykMeOvqu8CfIlS0p7suh6Wy9W6FdL+l8H9mSztA0dt0wmt6cLh/A4gEedj4FWNRG8b9x7m29P2lDtFmP0ZzdUjkQgCDAQYCAIAgCDJjPzPVbEy4okvZ1Ns1zR9uJ7fcH/wBKmov2z1djztqbd6fr9jqyuHWHOu1J31tMOEbj5uH9lV1GUc5tx+3DwZCAq54PUylqQ5CDIQBAb3VbQLat0gdLsbDQbAAuN7447hb3hS06e+3xPS2boY6qUk5Wt8WSIdn8f/USfwtU36Zd5639gU/9b+RodaNXW0ojc2bbDyRsuAa7DHaFsx/4UVWluW4nmbR2dHSKLjK9+TyR5QnlYOo6jMtQxW9pzyT+cj4AK9QXsI7TY8baSHW/1ZzrTEpfUTu4zP8ALaNvcqcneTZyerlvV5yfe/qYa1K4QZCDIQBB4HXJ/rqBznfvKS/8Ud79V6D9qn5Hdz/e0jffH6o5GvPOENpq5ooVU4iMndjZLr5k2tg0ccfcVvThvO1y7oNKtRV7NytwuSr/ANP4z/iJLfharH6Zd57f9gU/9b+RqtZNVWU0PetnLrOA2XANvf7Nt4UdSjuK9ylr9lQ01LtFO/R8yLKA8QIAgCDJjy5lbIljxRutSHWr6Y/eePONwUlL30ejsx//AKoW6/RnYFeOxOcdqI+vp+cR/m/8qpqPeRze3F+5B9CFBQHhZMpakOQgCAIAgCDAQYCA6fqHPtUTGjNj3tPL0tr4OCvUHeB2WxpqWliu5tfO/wBzn+n6cx1VQzhK4jo47Q9xCqTVpNHL62m6eoqRfe/nxMehha+SNjn7DXOALrXtfeQtUrviRUYRqVIxk7JvPcb7SeqZhkc01EDWO/ZmR4a533SLYcL5KWVGzyj09Rsl05tdpFLld8X/ADvMZmrMh2WtmpXSE2LBK0ubfLrfkteybw18SFbMnK0YzjfuuuBb1k0M2ldGzvdt7ow54tbZPI7wcbb8EqQ3Glc11+jjpZRgpXbXHoahrSSABck2A5lRlBJt2R1vSH1NDJfKOlLR1DNke9ehL2ab8Duq37Okku6NvlY5GvPOEwEGAgCAIAgCDIQGPLmVsiWOLI3OpQ/4+m/E7+Rykpe+j0Nmf4qHn9Gdhurx2Rz/ALVI8aR3ESD+Qj4lVtQuKOe27H+7fj9iBqseBkygtSAIAgCAIMBBgIAg6slvZ9pQRyupybCXFt8g8bvEfAKxp52du893Yeq3KjpSxLHj+TYa/wChS4CqjF3NbaQDE7Iyf4ZHlbgt9RT/AKkWtt6JzXbx5Z8O/wAiBKocxkmdA4V9E6Bx/wCJpxeMnNzch5+qfylWY/uQ3eaOhotbQ0jpP34Y6/zD8mWdUaaOCKXSM2IYC2NuFy7IkczfZHUrWklFObI9l0oUactXU5cF/Pl8SM1tW+aR8shu57rn9AOQGHgoW23dnj1q0qs3OWWSHUbQplmE7x9VEbi/tPGQHTPyU1CF3fuPV2PonUqdrJezH5v8G37RNKARspmnF5DnfhafRv1OP5VJqJ8N0vbc1SjTVFZfF+H/AD9CAKocvgIAgCAIMhBkIAgMeTMrYlWLEg7P4tqviO5jXu/0FvxcFLR99HqbJjfVR6X+h1q6unXEQ7Tae9LG/eyYeTmkfGyg1C9lM8fbUN6gpdzOZKoctkyIzgCsEUs2PSwYCAIMBBgIAg6sID0x5aQQSHAggjAgjIhDMW07rkdN1W1kZUMEchAqALEZB4+039Qr1KqpcHk7HZ20Y6mO7L3vr4Gq1j1MbZ80Dg2wLnRn1cMT3Z3dPgo6lDnEpa7Y0XepRduduXl6GF2cft5j/kf1NWun95lfYP8Aez/2/cAf+yk/5/8AWsf5PmP+lef3LGqmq/0kd9I/ZiDiNkes4ixNzuGP+yUqW/xZHs3Za1C7Sb9m/m/QmOl9KwUULWhrRZto4m4X5ng2+Z/VWJzjTVj3tVqqOipJJeC/nLqcvrqt80j5Xm7nm5PwA5AYeCottu7ONrVZVZupPLLCwRBAEAQBBkIAgCDojFPFbE2OBM+zCnvUTybmQhvi9wP9BU9Be02e5sOn+5OXcrfH/g6UrZ0pqdaaPvaOpZa7u7Lmjmz0gB4haVFeLRV1tLtNPOPT6cTjCoHE9C9AcFhkc+hcWDQIMBBgIAg6sIDYaF0RLUyd3GMsXOPqtHE/oFvCDm7ItaTR1NVPdh5vki3pbR7qeZ8Li0uaRiMiCAQeWBWJRcXZmuq08qFV05PBYponucO7a9zxiNgOLsN4tisK7wRU4zlK1NNvpk6+2NzqYB19t1Pb0r32iy2PO69CzcfI71RlKjbm4/OxHtT9XZ6aWSSXu7Oi2Rsu2sdoHHDkoqNKUHxPK2Zs+rppylO3FW4CLV2c6N+inYbJ3u1i70bbV7kgFYVKXZ7vMR2fV/Q9hw3r+WTa6q6KfTwd1IWE9453okkWIHEDgpKUHCNmXdnaWemo7k2r3b4EV1w1dkZ3tX3veB0uIsRstcbNxubgYBQVqTV5XPF2ps6cN7Ub1+OO5Pz8ERSJhc5rRm5wA3Yk2CgPDhFykkss2+ndW5qUNc4tew4Fzb2a77Jv7it50nDJf1mzaumSlLiu9d5pVGecEGQgyEAQBAeZDgVkzHJjrYmwdN7NKQtpXyH97Kbc2s9Ee/aVqgvZudRsWlu0HJ839P4yYKc9g8kDMoDienqDuKmaK1g152fwnFvuIXnyjuto4fV0exrSgu/5cjCiOK1ZVkuBkLUiwEGAgCDqwgM/Qui31MwiYQDbac45NaLXdzzGHNbwg5uyLOk0s9VUUI+fRE10tpOHRsIp4ADMRfGxIJ/eScTwH6KzOaprdjk6PU6mls+l2NFe1/OL6/zBz6aVznOe5xc5xuScSSVUycrOcpycpPiTTs1gbeplPrAMaOQNybdbDyVnTLLOh2BBfuT58ESypryxxH0eoktvY1mzj95zgFO525M9ypXcZbqhJ+CX3aLX0+d2IopQN23JAzzs4rG9L/T9DTt6rxSfm4+rHf1rsqenaPvTvP8ALGl59y+P4G/qX/RFf+z/APkbNa726Vg5Nlk/qant9DNtU+cV5N/dFrW14FFUXtbYA/MSALDrZYre4yPaUlHS1N7u+ZyZUDhicaraxtkb9DqbO2hstc7EOB9h/Pgd/XO1Sq3W7I6TZu0lVj2Go434Jvn0f2f3NLrXq+aR4LTtRSE7JOYO9rv7qKrT3H0PO2ls96ae8vdeOnQ0KiPMyEAQBAEBanO5bIkgrFtjS4gAXJNgOJOQQkSbaSydu0RRiGCGEZRsAJ4u9o+JuV6EY7qSO509JUqUYLkjOstiY8kbygID2maMv3VUBgPq3+8scfePJVq8cSPA23p+Eay8H9iBKsc9gyGOuFghasz0sGAg6sIAgyX6OskheHxvcx9rXHA7uYWU2ndEtKtOlLepuzLcsrnOL3OLnONySbkk80yaTnKcm27s8LBqTTs1DtuoPsBjb/iudn3bXuVnTZZ0OwN7eqWxw+P8uTwY4nJWzpgTfE4BAY02kIW+tNE0c3sb8StXKK5kU69KHvTS8WjHfp+kyFTEfwuDz0Abda9rDvIXrtMv8xfG/wBDG1xgElFMB7LQ8H8JB+F/NYrK8GRbUpqppZ9OPwOUqgcQEBk1ekJpQwSSveGCzdo3t82zWzk3lk1XUVaySnJtLBjLUhCAIAgBPksgxXG6yTJWJJqFovvqtryPq4PTd+L2B54/lUtGN5eB6mydP2ldSeI8fT18jq99wV060rZAUI45IDF0nRNqIZIX+o9pHO+5w6Gx8FiUd5WIq1KNWnKEsM4pW0r4pHxPFnMcWnw3jkc/Fee1Z2Zw9WnKlNwllFuN1jyWGRSXAyFqRdWEAQZCDIQBAEBNuzWcbVRGcyGPHRtwfiPNWdM+LR0ewKiTqQ58GS2p0XFK4vf3p5d7M1uH3A4AeSsOCbuz3J6aE5b0r/F2+F7GO/RFEDd0MHV9nE+Llh06fNIjek0q4yjHz/J5+k6OjwD6JluBhB6WCxvU13GqqaKnhwXwKSaz0LcBUM/KHO/lCdtDvMS2lpIf5i8vwaHWrWmnkpnwwOc5zyATsubZt7k3Ixva3ioqtaMo2R5m0dqUalBwpO7fRrgQVVTmshBkIAgCAIAgwWpnbllG8FbiWlkkOvanaI+jUzWkWlk9OTkTk3wGHW6vUobsTstnabsKKTy+L/nQ3vIKQvFUBQi/RAUz6ICE9oug9tv0uNvpMAEtt7NzvDfy6KvXh/Ujw9saTej20VxWfDv8vp4HO1VOb6svRP3LDI5LmXFg0yEGQgCAIAgLkE72HaY9zDa12ktNuFwsptYN4VJU3eDafQ9y1crvWlkd1c4/Epd95tKtUfvSb82dC1d0ZQTwMeyniJsBIDdxDwMRifkK3Tp05K9jqtDptHWoxnGCvz52fmbh2jqSNpd3FOxrRdzthgAA4myl3ILki/8Ap9PTTluRS8Ecr01VtlqJZGNDWOd6Itb0QLA23XAuqE3vSbOK1lWNWvOcVwb4GEtSsEGQgCAIAgCDB5kfZZRtFGOskmCVag6C7+bvnD6qFwI4OkzA8MCfBTUYbzuz19k6Ptanaywvm/wdQ5BXDqiuWG/5xQFUBQi/RAUzwGSAo4AgtsCCLHeLcEDVzk2uOrxpJbsBMEhOwc9k5lhPw4joVSqU919DkNo6H9PPeXuvHToR9RHm5L8b79Vhojkj2sGoQBAEAQYCDAQF+krJInbUUj2O4tJb4HisptcUSUq1Sk96Emn0L1bpWomAbJM944E4dbDC6y5SllklbV1qy/cm2jCWpXyEGQgCAIAgCDBR7rLJlIx3OuskqVjO0JoqSqmbDHhfFzswxu9x/txW0YuTsizpdNPUVFGP/B2PR9EyCJkMQs1gt/dx4knFX4xUVZHaUqUaUFCOEZGWAz+cSskhUYdSgKoCh4ICnIIBlgEBj6Qoo5o3QyN2mvGPHk4HcQsSipKzI6tKNWDhNcGcj1j0FJSS7DvSY6+w/c4cDwcN4VGcHF2Zx+t0c9POzxyf85mpWhSyXo5OOaw0Ryj3FxYNQgCDAQYCAIAgCDIQZCAIAgCAIMHl77LNjKiWHOuskqVjI0dQyTyNhibtPd5Ab3OO4BZSbdkTUKE601GK4s65q7oSOki7tnpSOsZH2xcf7DcP7lXoQUUdho9JDTQ3Vnm+/wDBtcsBn84lblsZcyUBUYdSgKoChO4ICmWAQDLDegGXMlAY2kaCKaN0crdprvMHcWncQtZRUlZkVajCtBwmro5VrLq1LSOubvhJ9GQD/S/g73FU503A5PW6Cpp33x7/AFNGoyh0R7ZJxySxo49xea66waNWKrBjAQBAEAQBBkIAgCAIAT5LILT5eCJG6hbJaWTfBnaH0TNUyCOJt/tOODWji4raMXJ2RZ02lqaie7Bfg6vq/oKKkj2GelI623IRiT+g4BXYU1BHW6TRw00LRzzff+Da5YDP5xK3LYy5koBljv8AnAICoG85oCqAoTuGaAplhvQDLmSgGWJz+cAgHMoDxLE17XB7Q5pFi0gEEcxvRq5iUVJNNcCA6xaiuG1LS4tz7on0h+AnPoceqqzoW4xOe1mx2rzofD0IRIwglrgWkGxBBBB4EHJQHhSi4uzXE8grBqXGzFLGrgXBIFixruvLPSwa+IQZCDIQBAEHQoXjismbPkW3TcAljZQsWy4lZN0rFEMko1d1MmqLPl2oYeYs9w+605dT5FTQpOXFnq6PZVSt7VThH5s6To+gigYIoWBrR53+047yrUYqKsjpqVGFKO7BWRk5YDP5xK2JRlzJQDLHf84BAMsSgKgbygPSA8k+aAplzJQDLE5/OAQDmUA5lAM8Tl84lAM+nxQGs0zoCnqx9Yz0gMJG+i8dDvHI3C0lTjLJV1Ojpahe2uPfzIHpfUWpjuYSJ2DhZrx+U4HwPgq0qMljieBqNj1afGn7S+ZF5onMcWOa5rhmHAtI6gqI8mUJRdpKzPCwY6sA2QxnJ6Eh4pYxuple9KWG6mO9KWG6sFO8PFLDdXI8kk5oZslgLJnAAvgsBIkGiNT6uexLO5j+1Jdp/KzM+4c1LGlKR6On2XXq8Wt1dfQnehNUqanIcB3so9t9jY/cbkPeeasQoxjxPf0uzaNDja7739jf8gpT0BlgM/nEoBlzJQDLHf8AOAQDLEoBzKAqMcSgK3QAoCgFsTmgAG8oABvKAWvickAtfp8UAOPRADwGSAHgEBjVtBDK3ZkijkH3mh1uYOYPRYcU8ojqUadRWnFPxI3XagUrv2bpYjwB7xviHY+9QuhF4PMq7GoS91tfP6+po6rs8qG/s5oX/i2oz5WI96jdCXJlCpsSqvdkn8vU1k2pte39xtc2vjP63WrpT7irLZWqXDc+aMV2rVaM6WbwbtfBa9nLuI3s/Urh2bKN1crT/hZv4SE3Jdxj9Bqf+2zIi1Qr3f4Zw6ujb8XLPZT7iRbM1TxD5r1NjS9n1W713wxjq558gLe9bKhIs09i137zSN3Q9nkAsZZpJOTQIgfifepFp1zZepbEpR4zk38iR6P0LTQYQwsZ96207ptG596ljCMcI9KjpaNH3IpfX4mwPALcsDkEAyyz+c0AtbmUAAtjvQADec0AA3lALXxKAZ9EB6QFEAQBACgKlAEAQFAgAQBAVQFEAQBACgBQFUAQAICgQBAEAQBAEBVAUKAqgKID/9k="
    alt="bulb">
  <h3>CSS Shape-Outside</h3>
  <p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim
    veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt
    in culpa qui officia deserunt mollit anim id est laborum. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
</div>
```

# php - json jquery php之外的变量

> ID：15209390
> 
> 赞同：1
> 
> 时间：2013-03-04T19:23:18.677
> 
> 标签：php, jquery, json

我想访问不起作用的范围之外的变量

```
$.getJSON("ajax_files/getSingleRow.php?id="+id+"&type="+type, function(json){ 
  var json = json[0];
  $.each(json, function (key, val) {
    //alert(key + '=' + val);
    $("#"+key).val(val);
  });
}); 
```

现在我想在这里使用那些不起作用的变量

```
alert(json.id); 
```

这是我在 getSingleRow.php 上的 json 变量形式

```
$results = array();

while($rw = $oAppl->row($res)) {
  $results[]=array(
    'id'=>$rw['id'],
    'ref'=>$rw['ref'],
    'name'=>$rw['name'],
    'description_demo'=>$rw['description_demo']
  );
}

echo json_encode($results);

[{"id":"1","ref":"RH-R-1","name":"","description_demo":"this is desc test"}] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:37:03.943

因为您在回调中声明变量。

尝试

```
var json = null;
$.getJSON("ajax_files/getSingleRow.php?id="+id+"&type="+type, function(json){ 
  json = json[0];
  $.each(json, function (key, val) {
    //alert(key + '=' + val);
    $("#"+key).val(val);
  });
}); 
```

此外，不要忘记 $.getJSON 函数是异步的。因此，在服务器响应之前，您将无法使用您的变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T19:37:10.507

如果您想访问函数范围之外的变量，那么您只需要在外部定义它并在调用`getJSON`.

这种方法存在问题。由于该函数是一个回调，因此它将在请求完成时执行，如果它只是您调用`getJSON`. 所以你需要以某种方式限制它。在下面的示例中，在回调执行结束时调用了一个函数。

```
var externalJson;
$.getJSON("ajax_files/getSingleRow.php?id="+id+"&type="+type, function(json){
    externalJson = json[0];
    $.each(externalJson, function (key, val) {
         //alert(key + '=' + val);
         $("#"+key).val(val);
    });

    // Function used to gate attempt to access JSON content until it has been processed
    finishUp();
});

function finishUp() {
    alert(externalJson.id);
} 
```

# ms-access - 如何运行此查询？

> ID：15209392
> 
> 赞同：1
> 
> 时间：2013-03-04T19:23:19.977
> 
> 标签：ms-access

一些背景信息：我有一个在线数据库，另一个在本地托管。

每个数据库都有一个产品表，其 ID 相互对应。就示例而言，它们都可以称为 product_id 本地数据库有一个复选框，上面写着“在 Internet 上”，该字段仅称为 OnInternet。

情况。我正在尝试运行一个查询，该查询将列出 OnInternet 为“否”的所有 product_id

当我尝试运行查询时，它只显示相同的产品。

我究竟做错了什么？

# excel-formula - 在另一个工作表中查找一个工作表的值

> ID：15209393
> 
> 赞同：0
> 
> 时间：2013-03-04T19:23:22.777
> 
> 标签：excel-formula

基本上，我可以手动执行此操作，但由于数据量很大，因此需要很长时间。这很紧急，我相信应该有任何公式化的方法来做到这一点。

我在excel中有两个工作表。

工作表 1。

```
Column-A       Column-B          
Device Names    Total numbers
Device A        19
Device B        81   
Device C        12
Device D        21
etc.            etc. 
```

工作表 2。

```
Column-A        Column-B          
Device Names    Total numbers
Device D        
Device S           
Device Z        
Device S        
etc. 
```

我需要在 ColumnA/Worksheet 1 中查找 Column-A/Worksheet 2 中的设备名称的公式。如果工作表 2 和工作表 1 中的设备名称匹配，则应传输 worksheet-1 的 Column-B 中的数据到工作表 2 中的 B 列。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:33:00.603

您需要在工作表 2 的数字列中使用公式。

=查找（A2，Sheet1！A2：B5）

假设 A2 是“设备 D”单元格，Sheet!A2:B5 是工作表 1 上的设备/数值范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T19:34:44.470

试试 VLOOKUP 功能。我只用你的例子中的 4 条记录尝试了这个，并且似乎有效。您可能需要调整查找范围：

```
=VLOOKUP(A1,Sheet1!A$1:B$4,2,FALSE) 
```

结果：

```
Device D    21
Device S    #N/A
Device Z    #N/A
Device S    #N/A 
```

# ruby-on-rails - Factory Girl - belongs_to 对象的覆盖属性

> ID：15209395
> 
> 赞同：1
> 
> 时间：2013-03-04T19:23:25.053
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, factory-bot

我正在尝试创建一个会议对象，并在这样做的同时覆盖会议对象所属的课程对象的属性：

这是我的模型：

```
class Course < ActiveRecord::Base
  attr_accessible :name, :description
end

class Meeting < ActiveRecord::Base
  attr_accessible :name
  belongs_to :course
end 
```

这是我的定义：

```
factory :course, class: Course do
    name      "Generic Course Name"
    description: "Very cheap"
end

factory :meeting, class: Meeting do
  name "Meeting name"
  course
end 
```

这是我正在尝试做的事情：

```
FactoryGirl.create(:meeting) do |meeting| 
    meeting.course.name = "other name"
end 
```

但是，我似乎无法覆盖默认的课程名称。我可以通过简单地将 meeting.course.name = "other name" 替换为 meeting.name = "other name" 来覆盖会议名称，但是访问 belongs_to 对象并没有达到预期的效果。

任何帮助，将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T19:34:17.670

关于什么？

```
course = create(:course, name: "My Course Name")
create(:meeting, course: course) 
```

# java - 输出流不打印任何东西

> ID：15209396
> 
> 赞同：-1
> 
> 时间：2013-03-04T19:23:27.400
> 
> 标签：java, outputstream, printwriter

```
public class Demo
{
    public static void main(String[] args)
    {
        PrintWriter outputStream= null;
        try
        {
            outputStream = new PrintWriter (new BufferedWriter(new PrintWriter("text.txt")));
        }
        catch(FileNotFoundException e)
        {
            System.out.println("Error");
            System.exit(0);
        }
        finally {
                if (outputStream!= null)
                    outputStream.close(); 
        }

        outputStream.println("Hahahahaha");

    }
} 
```

所以我得到了这个示例代码，但奇怪的是它根本不起作用，因为当我打开文本文件时。它完全是空白的。这怎么可能？是因为 output.close 吗？我评论了那部分，但它仍然不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:26:22.250

为什么使用：

outputStream = new PrintWriter (new BufferedWriter(new PrintWriter("text.txt")));

为什么不直接使用：

PrintWriter outputStream = new PrintWriter("text.txt");

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T19:26:24.313

在关闭流之前编写您的 println 语句

```
public class Demo
{
    public static void main(String[] args)
    {
        PrintWriter outputStream = null;
        try
        {
            outputStream = new PrintWriter (new BufferedWriter(new PrintWriter("text.txt")));
        outputStream.println("Hahahahaha");
        }
        catch(FileNotFoundException e)
        {
            System.out.println("Error");
            System.exit(0);
        }
        finally {
                if (outputStream != null)
                    outputStream.close(); 
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T19:27:40.327

你`outputStream`在写信之前就关闭了。

请注意，该`finally`块**总是在 try 块退出时执行**。`outputStream`因此，您必须在退出`try`块之前写入。

关闭它，您将看到您输入的文本。

```
try
{
    outputStream = new PrintWriter (new BufferedWriter(new PrintWriter("text.txt")));
    outputStream.println("Hahahahaha");
}
catch(FileNotFoundException e)
{
    System.out.println("Error");
    System.exit(0);
}
finally {
    if(outputStream != null)
       outputStream.close();
} 
```

# oracle - OBIEE Answers 未显示结果

> ID：15209397
> 
> 赞同：1
> 
> 时间：2013-03-04T19:23:37.823
> 
> 标签：oracle, oracle11g, business-intelligence, obiee

我最近安装了 OBIEE 11.1.1.6.0。我从 11.1.1.5 导入了我拥有的存储库，到目前为止它运行良好。

在管理工具中，我可以查询我的数据并更新行，我可以使用与连接池相同的凭据进行连接，而在 SQLPLUS 中没有问题。

用户具有 RESOURCE 和 CONNECT 权限。

我的 weblogic 用户拥有所有权限，并且已被授予对我的主题区域的读/写权限。我已经设置了环境变量，修改了 instancesconfig.xml 并尝试了我在 OTN 上可以找到的所有东西，但 BI Answers 继续给我这个错误

```
View Display Error

Odbc driver returned an error (SQLExecDirectW).

Error Details

Error Codes: OPR4ONWY:U9IM8TAC:OI2DL65P

State: HY000\. Code: 10058\. [NQODBC] [SQL_STATE: HY000] 
[nQSError: 10058] A general error has occurred. 
[nQSError: 43113] Message returned from OBIS. 
[nQSError: 43119] Query Failed: 
[nQSError: 17001] Oracle Error code: 1017, message: ORA-01017: invalid username/password; logon denied at OCI call OCISessionBegin. 
[nQSError: 17014] Could not connect to Oracle database. (HY000)
SQL Issued: SELECT 0 s_0, "SAP_AVIS"."Fait SAP AVIS"."Avis" s_1 FROM "SAP_AVIS" FETCH FIRST 65001 ROWS ONLY 
```

请帮忙，我很绝望。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T15:38:35.973

我已经能够解决我的 OCI ORA-01017 错误。

问题是由我的连接池引起的。

我有一个名为“A”的连接来访问我的数据库中某个模式中的表，而这次名为“B”的另一个连接是访问另一个模式中但在同一个数据库中的表。

在 Oracle BI Answers（演示文稿）中，我试图查看连接 B 中的数据，但奇怪的是 OBIEE Answers 正在使用连接 A。

最后，我删除/重命名了连接 A，一切都像什么都没发生过一样。

我并不是说这是最好的方法。也许我跳过了分配要使用的默认连接池的配置，但它完成了这项工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T14:36:03.537

选项 1：将 tnsnames.ora 复制到 {Oracle_BI1}\network\admin 目录和 {oracle_common}\network\admin 目录

选项 2：不使用 RPD 中的 tnsnames.ora 条目，而是使用完整扩展的 tnsnames。

我从来没有遇到过这个问题，所以我不确定这是否可行，但你可以尝试。选项 2 可能只是解决问题。

维杰。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-18T08:36:22.830

对我来说没有安装oracle客户端，当我安装oracle客户端问题得到解决

# javascript - isDirty 检查未按预期工作

> ID：15209400
> 
> 赞同：0
> 
> 时间：2013-03-04T19:24:02.917
> 
> 标签：javascript

我正在使用以下脚本来检查表单内容是否已更改，以防止用户在不保存更改的情况下浏览。

```
<script type="text/javascript">
var isDirty = false;
var msg = 'You have unsaved changes.';
$(document).ready(function(){
    $(':input').change(function(){
        if(!isDirty){
            isDirty = true;
        }
    });
    window.onbeforeunload = function(){
        if(isDirty){
            return msg;
        }
    };
});
</script> 
```

保存按钮当前如下所示：

```
<input type="submit" name="frmProjectAction" value="Save" onclick='selectAll(frmProjectResources,true);' /> 
```

这在大多数情况下都有效，但我有两个问题：

1\. 即使用户单击表单上的“保存”按钮，它也会触发。我怎样才能防止这种情况？

2\. 它没有检测到我表单上的 TinyMCE 文本框的变化。如何检测 TinyMCE 文本框以及表单上所有其他字段中的更改？

在此先感谢 - 戴夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:34:12.467

1：在将 isDirty 设置为 false 的保存按钮上使用 click() jquery 函数。您需要先向保存按钮添加一个 id 或一个类，以便您可以使用 jquery 定位它。假设您将保存按钮 ID 设置为“保存按钮”，然后执行以下操作：

```
$('#savebutton').click(function(){
  selectAll(frmProjectResources,true); // <-- from your onclick="" attribute
  isDirty = false;
}) 
```

您会注意到我们已将 selectAll(...) 部分从保存按钮的 onclick 属性移动到 jquery。因此，您应该从按钮中删除 onclick 属性。

2：TinyMCE 有[onchange_callback](http://www.tinymce.com/wiki.php/Configuration%3aonchange_callback)，您可以使用它触发一个将 isDirty 设置为 true 的函数。onchange_callback 是在初始化 TinyMCE 时设置的，并在表单更改时为其指定要触发的函数的名称。

```
//first define the function

function setIsDirty(){
  isDirty = true;
}

// then init the tinyMCE
tinyMCE.init({
        ... // some parameters
        onchange_callback : "setIsDirty"
}); 
```

这样，您可以精确控制更改编辑器时发生的情况。如果只需要在离开页面前检查是否被编辑过，也可以使用 TinyMCE 自带的[isDirty](http://www.tinymce.com/wiki.php/API3%3amethod.tinymce.Editor.isDirty)方法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T19:30:04.903

这实际上只是问题 1 的解决方案：

您将需要一个额外的事件处理程序，即表单上的 onsubmit 事件处理程序。

在该事件处理程序中，您将 isDirty 更新为 false （因为您现在正在保存表单......所以它不再“脏”）

我无法对 tinyMCE 发表评论，因为我从未使用过它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-13T16:07:50.287

```
plugins: "autosave"
autosave_ask_before_unload: true
toolbar: "restoredraft" 
```

# php - Ajax 加载的表单不通过 ajax 发布数据

> ID：15209401
> 
> 赞同：0
> 
> 时间：2013-03-04T19:24:04.267
> 
> 标签：php, ajax, html, codeigniter, jquery

嗨，我使用 codeigniter 并构建了 ajax 无限滚动。并且在该 ajax 滚动条上有评论表单，我担心的是当页面加载时，会加载 10 个帖子，如果向下滚动，则会加载另外 10 个帖子，现在所有 20 个帖子都将包含自己的评论表单。我使用 ajax 发表评论。因此，对于在页面加载评论表单工作时加载的第 10 个帖子，但对于 ajax 加载的帖子评论表单，ajax 帖子不起作用。下面是我使用的代码。

```
<script type="text/javascript">
$('.post_comment').click(function() {
  var form_data = {
    csrfsecurity: $(this).parent().find("input[name=csrfsecurity]").val(),
    post_text: $(this).parent().find('.comment_text').val()    
  };

  $.ajax({
    url: "<?php echo site_url('/comment'); ?>",
    type: 'POST',
    data: form_data,
    success: function(response){
      $(".home_user_feeds").html("markUpCreatedUsingResponseFromServer");
    }
  });
  return false;
});
</script> 
```

向下滚动页面时，以下表单将加载 10 次

```
<form action="http://localhost/comment" method="post" accept-charset="utf-8">
<input type="text" name="comment_text" value="" id="comment_text" size="35" class="comment_text">
<input type="submit" id="post_comment" name="post_comment" value="submit comment" class="post_comment" >
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:31:51.040

我的猜测是您没有将事件侦听器添加到您正在 AJAX 处理的 HTML 中。您的前十个工作是因为您在文档加载时为原始 10 个添加事件侦听器。

您将需要再次运行 jquery 代码，将事件处理程序添加到 DOM 元素（类似于 post_comment 类的元素）单击事件。

# c# - 在 asp.net 中哪个更有效，在运行时或设计时添加属性？

> ID：15209407
> 
> 赞同：3
> 
> 时间：2013-03-04T19:24:12.337
> 
> 标签：c#, asp.net, html

我正在清理一些较旧的 C# 代码，并在`Page_Load`方法中遇到了这个块。

```
txtFirstName.Attributes.Add("onchange", "CheckChange();");
txtMiddleName.Attributes.Add("onchange", "CheckChange();");
txtLastName.Attributes.Add("onchange", "CheckChange();");
txtIdentifier.Attributes.Add("onchange", "CheckChange();"); 
```

保持原样或在 HTML 中设置这些特定属性会更有效吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T19:30:28.367

> 保持原样或在 HTML 中设置这些特定属性会更有效吗？

我认为这里的效率不那么重要，而且无论哪种方式，差异都可能非常小。

但是......我认为应该在客户端编写 HTML 属性，特别是 javascript 事件和代码。

***当您在客户端编写客户端代码时，将关注点分开，***您的代码更容易开发和维护。这是在新应用程序中使用 Asp.net-MVC 而 Asp.Net 几乎有 0 个新应用程序的原因之一。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T19:36:01.320

我用这个 TextBox 创建了一个简单的页面

```
<asp:TextBox runat="server" ID="txtFirstName" onblur="CheckBlur()"></asp:TextBox> 
```

在 PageLoad 我放置那行

```
txtFirstName.Attributes.Add("onchange", "CheckChange();"); 
```

现在，我去检查编译后的文件，发现编译器添加了这一行

```
#line 12 "D:\StackOverFlow\AttrTest.aspx"
((System.Web.UI.IAttributeAccessor)(@__ctrl)).SetAttribute("onblur", "CheckBlur()"); 
```

因此，**编译器添加相同的行，就像你将它放在后面的代码上一样**。所以从这个角度来看，结果似乎在速度或页面编译方面是相同的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T19:30:58.333

我宁愿在 aspx 页面中编写代码，并且会在不可能这样做的情况下选择代码隐藏，例如在提交页面后动态生成锚点并将一些 javascript 链接到它。它涉及可维护性而不是性能。

**编辑**

作为附加输入，请考虑在 javascript 中使用松散耦合的代码，而不是直接在标签上指定事件，例如

```
document.getElementById('txtLastName').onclick = function () { 
//code 
}; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-04T19:30:13.723

我想在 HTML 中设置它们会稍微更有效，因为 HTML 可以按原样写入输出，并且需要使用一些字符串连接和格式化操作将控件的对象模型转换为 HTML。

但总而言之，如果您没有数千个这样的属性，我认为这不会影响您页面的性能。

不过，我不能 100% 确定，因为我从未尝试过这样的微优化

# android-camera - 有什么方法可以确定相机是否空闲？

> ID：15209409
> 
> 赞同：0
> 
> 时间：2013-03-04T19:24:31.153
> 
> 标签：android-camera

我正在使用原始相机图像，但需要在捕获图像后重新启动预览。当我在 takePicture 之后调用 startPreview() 时，android 挂起，因为相机一直在使用中。我一直等到原始图像写入磁盘后，但相机仍在使用中，所以开始预览仍然会挂起系统。

```
camera.takePicture(null, null, null);
(test needed here){
camera.startPreview();      
} 
```

将开始预览放在 rawcallback 中会挂起 android。

调用 takePicture 时，jpegCallback 发生在相机完成后，因此可以安全地开始预览，但这也会创建一个 .jpg。

问题是跟着takePicture，有没有办法判断相机什么时候空闲？（除了 jpegCallback？）。

我找到了解决问题的方法，例如在计时器上启动预览，但仍然想知道是否有任何方法可以确定相机的实际状态以及测试何时保存以重新启动预览的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:31:31.703

调用[takePicture() 函数](http://developer.android.com/reference/android/hardware/Camera.html#takePicture%28android.hardware.Camera.ShutterCallback,%20android.hardware.Camera.PictureCallback,%20android.hardware.Camera.PictureCallback,%20android.hardware.Camera.PictureCallback%29)后，您必须等待 JPEG 回调返回，以便相机再次准备好使用。无法监控其状态。该文档明确指出以下内容：

> 调用此方法后，在 JPEG 回调返回之前，您不得调用 startPreview() 或拍摄另一张照片。

如果您需要一些快速获取帧（即图像）的方法，而无需停止和重新启动相机预览，您可以实现[PreviewCallback](http://developer.android.com/reference/android/hardware/Camera.PreviewCallback.html)接口，它只允许您在不停止预览的情况下抓取预览帧。请记住，您需要将这些从 YUV 格式转换（使用 Android 的[YUVImage 类](http://developer.android.com/reference/android/graphics/YuvImage.html)并不难。

# java - 使用java在postgresql中插入串行类型字段数据

> ID：15209413
> 
> 赞同：2
> 
> 时间：2013-03-04T19:24:46.820
> 
> 标签：java, postgresql, insert

这是我的代码不起作用

```
 String sql="insert into user_master(User_Id,'First_Name','Last_Name','Address','City','Country','Email_Id',Cell_Number) values(DEFAULT,'"+fname+"','"+lname+"','"+address+"','"+city+"','"+country+"','"+email+"',"+cellno+")"; 
```

这个工作正常

```
 String sql="insert into user_master values(1,'"+fname+"','"+lname+"','"+address+"','"+city+"','"+country+"','"+email+"',"+cellno+")"; 
```

但我不想每次都增加 id，我已经使用了我指定的序列类型。但是使用 DEFAULT 它不起作用。

任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:53:10.840

使用命名列，并省略您想要默认的列：

```
String sql="insert into user_master(first_name,last_name,address,city,country,email_id,cell_number) values('"+fname+"','"+lname+"','"+address+"','"+city+"','"+country+"','"+email+"',"+cellno+")"; 
```

这将解决您的问题，但出于其他原因（SQL 注入、引用问题等），您仍应使用上述准备好的语句。

# mysql - 如何在 UPDATE 查询中执行三个表 JOIN？

> ID：15209414
> 
> 赞同：489
> 
> 时间：2013-03-04T19:24:47.867
> 
> 标签：mysql, join

我问了一个问题，得到了这个有帮助的答复。

```
 UPDATE TABLE_A a JOIN TABLE_B b
   ON a.join_col = b.join_col AND a.column_a = b.column_b
   SET a.column_c = a.column_c + 1 
```

现在，如果有三个表涉及这样的事情，我希望这样做。

```
 UPDATE tableC c JOIN tableB b JOIN tableA a 
```

我的问题基本上是......是否可以对一个`UPDATE`语句进行三个表连接？它的正确语法是什么？

我是否执行以下操作？

```
 JOIN tableB, tableA
 JOIN tableB JOIN tableA 
```

* * *

## 回答 #1

> 赞同：851
> 
> 时间：2013-03-04T19:28:20.073

答案是*肯定*的，你可以。

试试这样：

```
UPDATE TABLE_A a
    JOIN TABLE_B b ON a.join_col = b.join_col AND a.column_a = b.column_b
    JOIN TABLE_C c ON [condition]
SET a.column_c = a.column_c + 1 
```

对于一般*更新*加入：

```
UPDATE TABLEA a
JOIN TABLEB b ON a.join_colA = b.join_colB
SET a.columnToUpdate = [something] 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2015-06-17T15:31:13.880

[实现相同结果](http://sqlfiddle.com/#!9/740a7)的另一种方法是根本不使用`JOIN`关键字。

```
UPDATE TABLE_A, TABLE_B
SET TABLE_A.column_c = TABLE_B.column_c + 1
WHERE TABLE_A.join_col = TABLE_B.join_col 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2017-06-19T14:56:56.010

下面是包含和的*更新*查询。同样，我们可以使用多个 join/where 子句：`JOIN``WHERE`

```
UPDATE opportunities_cstm oc JOIN opportunities o ON oc.id_c = o.id
 SET oc.forecast_stage_c = 'APX'
 WHERE o.deleted = 0
   AND o.sales_stage IN('ABC','PQR','XYZ') 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-05-31T17:18:07.003

另一种*总体计划*：

```
UPDATE table A
JOIN table B ON {join fields}
JOIN table C ON {join fields}
JOIN {as many tables as you need}
SET A.column = {expression} 
```

例子：

```
UPDATE person P
JOIN address A ON P.home_address_id = A.id
JOIN city C ON A.city_id = C.id
SET P.home_zip = C.zipcode; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-07-20T12:46:48.753

是的，您可以为更新语句执行三表连接。这是一个例子：

```
UPDATE customer_table c

  JOIN
      employee_table e
      ON c.city_id = e.city_id
  JOIN
      anyother_ table a
      ON a.someID = e.someID

SET c.active = "Yes"

WHERE c.city = "New york"; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-12-28T08:24:43.157

对于 PostgreSQL 示例：

```
UPDATE TableA AS a
SET param_from_table_a=FALSE -- param FROM TableA
FROM TableB AS b
WHERE b.id=a.param_id AND a.amount <> 0; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-01-01T10:53:18.173

没有一个答案对我不起作用我在 mysql 手册上找到了这个

```
UPDATE T1,T2 INNER JOIN T2 ON T1.C1 = T2.C1 SET T1.C2 = T2.C2,       T2.C3 = expr WHERE condition 
```

# c# - 文本框静态值+文本

> ID：15209417
> 
> 赞同：1
> 
> 时间：2013-03-04T19:24:50.620
> 
> 标签：c#, wpf

我想自动将一段纯文本添加到我的 TextBox 值中。例如，我想要显示 John Latham 的统计信息，因此最好自动添加“Statistics for”，然后将 Text 属性分配给我的控件。我做了一些研究，但由于某种原因它对我不起作用。你能验证为什么吗？我想这可能是由于绑定的原因，我怎样才能从后面的代码中获得相同的结果？谢谢！

```
<StackPanel Grid.Row="0" Grid.Column="1">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="50"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Image Name="imgStatistic" Source="/Images/Statistics.gif" Grid.Column="0" HorizontalAlignment="Left" Height="50" Width="50"/>
        <TextBlock Text="{Binding Title, StringFormat='Statistic for  {0}'}" Name="txtStatistics"  VerticalAlignment="Bottom" Grid.Column="1" FontSize="18" TextWrapping="Wrap"/>

    </Grid>
</StackPanel> 
```

代码背后：

```
 this.txtStatistics.Text = emp.FirstName + " " + emp.LastName; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T19:40:46.543

`Text="{Binding Title}"`意味着它将 the 的属性值绑定`Title`到' s 。 那句笨拙的句子会说：您需要一个具有属性并将其设置为父级或父级之一的对象。`DataContext``TextBox``TextBox``Text`
`Title``DataContext``TextBox`

如果您没有这样的对象，则数据绑定不适合您。
只需将您的代码更改为：

```
this.txtStatistics.Text = string.Format("Statistic for {0} {1}",
                                        emp.FirstName, emp.LastName); 
```

# perl - 内部网站是否需要“污点”模式？

> ID：15209419
> 
> 赞同：1
> 
> 时间：2013-03-04T19:25:10.137
> 
> 标签：perl, taint

我进来支持的中型内部网站大约有 1/2 的 *.cgi 文件没有“污点”模式。内部网站是否需要“污点”模式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T19:28:03.467

你信任内部用户吗？如果不是，那么是的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T20:45:13.243

假设您*确实*信任您的内部用户并且目前*不需要*污点。您可以考虑在任何现有脚本中保持 taint ON，如果只是为了训练自己如何使用 taint。它并不像一开始的感觉那么糟糕，有点像在煤上行走。好起来。

我可以说，我有多个“内部”网站突然（要求发生变化）变成面向客户、暴露在互联网上并需要更好的安全性。

要记住的另一件事是，内部用户有时是最不满意的，最有可能想要伤害您的组织是一些小事。

# xpath - 在 Selenium 中使用 getAttribute 方法时出现无效的 Xpath 错误

> ID：15209420
> 
> 赞同：0
> 
> 时间：2013-03-04T19:25:11.237
> 
> 标签：xpath, selenium

使用 getAttribute 方法时出现无效的 xpath 错误...尽管我能够在 firepath 中使用相同的 xpath 定位图像。

我正在使用以下方法..

String imgAtt = StartServer.browser.getAttribute("//img[contains(@alt,'Selenium IDE Logo')]");

**错误：**

线程“主”com.thoughtworks.selenium.SeleniumException 中的异常：错误：无效的 xpath [2]：//img [包含（在 com.thoughtworks.selenium.HttpCommandProcessor.throwAssertionFailureExceptionOrError（HttpCommandProcessor.java:112）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:36:17.197

也许你需要使用`fn:contains`：

```
String imgAtt = StartServer.browser.getAttribute("//img[fn:contains(@alt,'Selenium IDE Logo')]"); 
```

或者声明默认的函数命名空间。但我对 Selenium 不够熟悉，无法告诉你如何做到这一点。

您调用的 XPath`getAttribute`也不会返回属性。这将是一个`<img>`元素。由于无效的参数类型，函数可能会引发异常。如果您只想要属性，请使用：

```
String imgAtt = StartServer.browser.getAttribute("//img/@alt[contains(.,'Selenium IDE Logo')]"); 
```

# tsql - Microsoft SQL Server INFORMATION_SCHEMA.COLUMNS CHARACTER_MAXIMUM_LENGTH 对于数字类型为 NULL

> ID：15209423
> 
> 赞同：1
> 
> 时间：2013-03-04T19:25:25.147
> 
> 标签：tsql, information-schema

我想选择 on`INFORMATION_SCHEMA.COLUMNS`以获取数字列的大小。我可以看到大小是在 Microsoft SQL Server Management Studio 的属性中设置的，但`INFORMATION_SCHEMA.COLUMNS`没有此信息。是否有其他表格可以在其中获取数字列的此信息？

例如，我有一个定义为`INT`大小为 4 的列，但 `INFORMATION_SCHEMA.COLUMNS CHARACTER_MAXIMUM_LENGTH`它是`NULL`.

如何在 select 语句中获得这个大小？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T21:47:18.080

如果你想坚持，`INFORMATION_SCHEMA.COLUMNS`那么你将不得不从基于整数的列的数据类型中推断出来：

```
SELECT COLUMN_NAME,
    DATA_TYPE,
    COALESCE(CHARACTER_MAXIMUM_LENGTH, 
        (Select Length From sys.systypes s Where s.name = c.DATA_TYPE)
        ) As Max_Len
FROM    INFORMATION_SCHEMA.COLUMNS c 
```

不过，您必须对其他一些类型做额外的工作（如 NUMERIC、DECIMAL 等）。

# html - 在单个 UL 中左右分隔列表项

> ID：15209428
> 
> 赞同：0
> 
> 时间：2013-03-04T19:25:34.887
> 
> 标签：html, css, html-lists

我有一个 UL 用作菜单，在此我有几个列表项，我想将它们分开到页面的右侧和左侧，即菜单项将在右侧并在左侧登录链接，虽然我可以'找不到用于执行此操作的属性，我尝试将 LI 向左对齐但没有成功，并尝试将它们定义为单独的类并浮动他，但它们再次没有向左移动。

对正确的 css 属性有任何帮助吗？

非常感谢提前，

安东

```
<li>
<a href="@" class="logon">page4</a>
</li>

li.class{
float:right;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:28:39.477

尝试更改您的 css 代码，例如

```
li > a {

     float:right;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T20:12:18.520

伙计们非常感谢您的帮助，我终于修复了它，问题是我在他们之前浮动了定义#menu 的 UL LI 属性，一旦我删除了这个声明，它就使用类移到了左边。

# css - 适用于大屏幕的 Foundation 4 响应式网格布局

> ID：15209430
> 
> 赞同：2
> 
> 时间：2013-03-04T19:25:43.430
> 
> 标签：css, responsive-design, sass, zurb-foundation, grid-layout

我曾经用框架`compass`创建新`sass`项目。`zurb foundation 4`我的`screen.scss`文件如下所示：

```
// Reset and normalization settings
@import "normalize";

// Global Foundation Settings
@import "settings";

// Comment out this import if you are customizing you imports below
@import "foundation"; 
```

默认设置包含以下行：

```
$row-width: 62.5em; 
```

这意味着对于至少 768px 的屏幕，我们的网格行必须是 1000px (62.5em)。

添加一个媒体条件的正确方法是什么，`$row-width`对于至少 1280 像素的屏幕，这将增加变量高达 75em（1200 像素）？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-06T10:21:21.780

在 app.scss 中为 .row 创建断点，如下所示：

```
.row{
    @media #{$medium} {
        max-width: 75em;
    }
} 
```

Foundation 在 _visibility.scss 中有用于媒体查询的屏幕尺寸变量，例如 $medium 转换为“仅屏幕和 (min-width:80em)”。我自己还没有尝试过，但应该可以。另外，看看这个答案，我只是稍微修改了一下： [https ://stackoverflow.com/a/14247136/961064](https://stackoverflow.com/a/14247136/961064)

您可以在 _visibility.scss 中找到不同屏幕尺寸的其他变量：[https ://github.com/zurb/foundation/blob/master/scss/foundation/components/_visibility.scss](https://github.com/zurb/foundation/blob/master/scss/foundation/components/_visibility.scss)

# ios - UITextField 的变化

> ID：15209432
> 
> 赞同：-1
> 
> 时间：2013-03-04T19:25:50.803
> 
> 标签：ios, objective-c, uitextfield

我建立应用程序计算器减少。

我如何使用 UITextField 的更改。

这是我的代码

视图控制器.h

```
double p;
double r;
UITextField * priceproduct;
UITextField * percent;
UILabel * result;
UIButton * solve; 
```

在 priceproduct 你写产品的价格和百分比你写产品的百分比折扣。

当您单击按钮时，它会在标签中显示产品折扣后的价格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:31:07.217

您所需要的一切都在 UITextFieldDelegate 协议中定义。[http://developer.apple.com/library/ios/#documentation/uikit/reference/UITextFieldDelegate_Protocol/UITextFieldDelegate/UITextFieldDelegate.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITextFieldDelegate_Protocol/UITextFieldDelegate/UITextFieldDelegate.html)

# c++ - 或 C++ 中的语句

> ID：15209433
> 
> 赞同：0
> 
> 时间：2013-03-04T19:25:51.150
> 
> 标签：c++, statements

我是另一个使用 devkit pro 为 nds 编写 c++ 的新手，令人惊讶的是，我在网上找不到任何关于此的内容。如何编写如下的 or 语句：

```
if ((keys & KEY_L && LR==true) or (keys & KEY_X && LR==false))
{
    ...
} 
```

如果您想说**“如果按下 L 键...”**，您将使用**“if (keys & KEY_L)...”**

那么我怎么说**“如果 LR 为真，按下 L 键，或者如果 LR 为假，按下 X 键”**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:28:10.560

`LR == true`（注意**双等号**，否则你写的是*赋值*而不是*比较*！）是不必要的：只需使用`LR`. 同样，使用`!LR`代替`LR == false`. 此外，添加几个括号也不会受到伤害：

```
if (((keys & KEY_L) && LR) || ((keys & KEY_X) && !LR))
{
    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T19:29:28.417

你很近。出于某种奇怪的原因，`&&`and`||`运算符的优先级高于 | 和`&`，所以你需要一些额外的括号：

你需要使用 == 来检查是否相等。

改变这个：

```
if ((keys & KEY_L && LR=true) or (keys & KEY_X && LR=false)) 
```

对此：

```
if (((keys & KEY_L) && LR==true) or ((keys & KEY_X) && LR==false)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T19:27:57.860

几乎就像您所做的那样，仅`==`用于相等比较：

```
if ((keys & KEY_L && LR==true) || (keys & KEY_X && LR==false))
{
    ...
} 
```

虽然`or`会起作用，但它只是`||`. 此外，您可以更改`LR==false`为 just `!LR`。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-04T19:28:09.217

1.  `&`学习和之间的区别`&&`。
2.  `==`学习和之间的区别`=`。
3.  了解如何`if`工作。 和...`if(val == true)`一样`if(val)`
4.  使用括号分组来制作更小的布尔表达式并构建它们。

# sql-server-2008 - 如何组合 SQL Server 中没有公共列的两个表？

> ID：15209436
> 
> 赞同：-2
> 
> 时间：2013-03-04T19:26:00.357
> 
> 标签：sql-server-2008, tsql

如何将两个表合并为一个显示两个表中的列的表？我的一个表是常规表，我需要从这个表中将值提供给另一个表，该表是标量值函数作为参数。

例如

```
T1 -> | c1 | c2 | c3 | 
  ________________

T2 -> fnGetValue(@c1) -> one column table 
```

我需要组合这两个表，但 c1 需要作为参数传递以从 T2 获取值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:30:43.470

如果`fnGetValue`是表值函数，则可以使用[`APPLY`](http://technet.microsoft.com/en-us/library/ms175156%28v=sql.105%29.aspx)运算符：

```
select t1.c1, t1.c2, t1.c3, t2.*
from table1 t1
outer apply fnGetValue(t1.c1) t2 
```

来自[MSDN 文档](http://technet.microsoft.com/en-us/library/ms175156%28v=sql.105%29.aspx)：

> OUTER APPLY 返回生成结果集的行和不生成结果集的行，在表值函数生成的列中具有 NULL 值。

如果`fnGetValue`是标量函数，那么您应该能够使用：

```
select t1.c1, t1.c2, t1.c3, fnGetValue(t1.c1) as Value
from table1 t1 
```

# c# - 接口通用层次结构

> ID：15209437
> 
> 赞同：4
> 
> 时间：2013-03-04T19:26:05.473
> 
> 标签：c#, generic-interface

我有一些相互链接的通用接口。

```
public interface IA
{
    int val { get; set; }
}
public interface IB<T> where T:IA
{
    T a_val { get; set; }
}
public interface IC<T> where T : IB<IA>
{
    T b_val { get; set; }
}

public class a:IA
{
    public int val { get; set; }
}
public class b:IB<a>
{
    public a a_val { get; set; }
}
public class c:IC<b>
{
    public b b_val { get; set; }
} 
```

对于最后一个类 c，我有一个错误：

> 类型“b”不能用作泛型类型或方法“IC”中的类型参数“T”。没有从“b”到“IB”的隐式引用转换。

在这种情况下如何正确使用通用接口？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-04T19:32:58.960

`T`in`IC<T>`必须是`IB<IA>`. 你给了它一个`IB<A>`. 您无法保证 an`IB<A>`可以用作`IB<IA>`仅因为`A`implements `IA`。

可以这样想：if`IB<T>`意思是“我可以吃任何 T 型的东西”，`IA`意思是“我是水果”，`A`意思是“苹果”，然后`IB<IA>`意思是“我可以吃任何水果”，`IB<A>`意思是“我可以吃任何苹果”。如果某些代码想喂你香蕉和葡萄，那么它需要一个`IB<IA>`，而不是一个`IB<A>`。

让我们假设`IB<A>`可以转换为`IB<IA>`，看看出了什么问题：

```
class AppleEater : IB<Apple> 
{  
    public Apple a_val { get; set; }
}
class Apple : IA 
{
    public int val { get; set; }
}
class Orange : IA 
{
    public int val { get; set; }
}
...
IB<Apple> iba = new AppleEater();
IB<IA> ibia = iba; // Suppose this were legal. 
ibia.a_val = new Orange(); // ibia.a_val is of type IA and Orange implements IA 
```

现在我们只是设置`iba.val`，它是一个类型的属性，`Apple`指向一个类型的对象的引用`Orange`。

这就是为什么转换必须是非法的。

那么如何才能使这合法化呢？

就代码而言，你不能，因为正如我刚刚展示的那样，它不是类型安全的。

`T`您可以通过如下标记使其合法`out`：`interface IB<out T>`. 但是，`T`在任何“输入上下文”中使用都是非法的。特别是，您不能拥有任何`T`具有 setter 的类型的属性。如果我们做出这个限制，那么问题就会消失，因为`a_val`不能设置为实例，`Orange` *因为它是只读的*。

这个问题在 SO 上被问得非常频繁。在 C# 中查找有关“协变和逆变”的问题，以获得大量示例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T19:30:30.457

我不知道它是否可以更容易（并且更*干净*），但是这段代码可以编译：

```
public interface IA
{
    int val { get; set; }
}
public interface IB<T> where T : IA
{
    T a_val { get; set; }
}
public interface IC<T, U> where T : IB<U> where U : IA
{
    T b_val { get; set; }
}

public class a : IA
{
    public int val { get; set; }
}
public class b : IB<a>
{
    public a a_val { get; set; }
}
public class c : IC<b, a>
{
    public b b_val { get; set; }
} 
```

更重要的是，它不允许你做这样的事情：

```
public class a1 : IA
{
    public int val { get; set; }
}

public class c : IC<b, a1>
{
    public b b_val { get; set; }
} 
```

编译器抛出以下错误：

> 类型“ConsoleApplication2.b”不能用作泛型类型或方法“ConsoleApplication2.IC”中的类型参数“T”。没有从“ConsoleApplication2.b”到“ConsoleApplication2.IB”的隐式引用转换。

这真是一个很酷的功能，不是吗？

# linux - 自旋锁 -（单处理器与多处理器）-（抢占式与非抢占式内核）

> ID：15209439
> 
> 赞同：0
> 
> 时间：2013-03-04T19:26:15.540
> 
> 标签：linux, linux-kernel, linux-device-driver

我是 linux 领域的新手。

我对在各种情况下使用自旋锁（在内核模式下）有些困惑。请说清楚。

自旋锁用作忙等待机制。

1）自旋锁（单处理器+非抢占式内核）-->不存在（因为如果你在自旋锁中睡觉会导致死锁）

2) Spinlocks(Uniprocessor + Preemptive kernel)-->不应该使用，因为它浪费资源。（当线程在持有锁的情况下休眠会发生什么？？其他进程可以正常执行吗？）

3) Spinlocks(Multiprocessor + Preemptive kernel)-->应谨慎使用。（当线程在持有锁的情况下休眠时会发生什么？？其他进程可以正常执行吗？）

请让我知道我对上述情况的理解是否正确，并请提供任何额外的信息来帮助我澄清自旋锁的使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:23:49.600

IIRC，在 UP 的情况下，自旋锁大部分被忽略（除了可能禁用抢占，对于一些自旋锁功能变体，还有 IRQ）。

在多处理器情况下，抢占再次被禁用，IRQ 也可能被禁用。

一般来说，持有自旋锁的任务不应该处于休眠状态。（如果他们只是禁用中断，那就更是如此）

（免责声明：帖子的内容可能不太准确/非常不准确，因为已经晚了，我无法验证详细信息 ATM）

# android - 如何在应用程序安装期间部署 .so 文件

> ID：15209440
> 
> 赞同：0
> 
> 时间：2013-03-04T19:26:15.537
> 
> 标签：android, shared-libraries

我目前正在开发一个使用共享库 (.so) 文件的 android 应用程序。

在我的开发过程中，我在 ADB（adb push 命令）的帮助下推送了 .so，一切运行良好！

现在我想知道如何在用户应用程序安装期间部署这个 .so 文件（例如 Google Play 部署（即使在此步骤之前有很多东西！））。

预先感谢您的建议。

问候，

乔泽

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-04T19:50:54.910

您可能可以使用 PREBUILT_SHARED_LIBRARY 目标，请参阅 your-ndk\docs\PREBUILTS.html

# .htaccess - htaccess 文件 URL 重写

> ID：15209441
> 
> 赞同：0
> 
> 时间：2013-03-04T19:26:16.760
> 
> 标签：.htaccess

对于我的测试，我有两个 html 页面，`TEST.HTML`并且`TEST2.HTML`

`TEST.HTML`有一个链接可以去`TEST2.HTML`：

链接是**test2.html/city/state/category**

这工作正常，但是当`TEST2.HTML`页面加载时，它显示的 URL 为： **test2.html?var1=city&var2=state&var3=category**

我希望 URL 干净，只显示： **test2.html/city/state/category**，而不是完整的 URL。（这有意义吗？？！）

谁能给我一些关于从哪里开始的指示？我尝试了许多不同的东西，但它不起作用。

如果您需要任何进一步的信息，请告诉我。

这是我的`.htaccess`文件：

```
Options +FollowSymLinks
RewriteEngine On
RewriteRule ^test2.html/([^/.]+)/([^/.]+)/([^/.]+)?$ http:/www.mydomain.com/test2.html?var1=$1&var2=$2&var3=$3 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T04:59:22.430

欢迎来到堆栈溢出。

通过在重写目标中包含域，您实际上是在指示重定向，而不是重写。

如果你删除它，它会将参数传递给文件，这就是你想要的：

```
RewriteRule ^test2.html/([^/.]+)/([^/.]+)/([^/.]+)?$ test2.html?var1=$1&var2=$2&var3=$3 [L] 
```

我还包括了`L`标志，如果找到特定的重写，它将停止重写。

# python - 为什么 setup.py 保留在我的分发包中？

> ID：15209446
> 
> 赞同：2
> 
> 时间：2013-03-04T19:26:25.613
> 
> 标签：python, distutils

我对 Python 有点陌生，甚至对 distutils 也比较陌生。

我想为我办公室的其他用户创建我的程序分发版，所以我使用了 distutils.core 中的设置。我设置了我的目录结构，创建了一个 manifest.in 文件和一个 setup.py 文件。一切似乎都按计划进行。结果是我有一个 .zip 文件，其中包含我想要的目录结构。

.zip 文件中不包含 maifest 文件（我假设只有 distutils 需要它），但 setup.py 文件保留在 .zip 文件中。这是为什么？最终用户需要 setup.py 吗？

谢谢，

-RS

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:35:08.390

在正常情况下，用户通过运行来安装你的应用程序`python setup.py install`，或者其他有效地做同样事情的东西（比如`pip install foo`）。

当然，在某些情况下他们不需要`setup.py`——例如，因为他们正在安装预打包的二进制 egg 或 Windows 安装程序或其他任何东西——但大多数软件包必须在正常情况下工作。因此，默认打包命令包括它。在文档中，[指定要分发的文件](http://docs.python.org/2/distutils/sourcedist.html#specifying-the-files-to-distribute)说：

> 如果您不提供明确的文件列表（或有关如何生成文件的说明），则 sdist 命令会将最小默认设置放入源代码分发中：
> 
> … `setup.py`（或任何你调用的设置脚本）…</p>

# php - 联系方式：AJAX 和 jQuery 动画和编码结构

> ID：15209447
> 
> 赞同：-2
> 
> 时间：2013-03-04T19:26:25.690
> 
> 标签：php, jquery, ajax, forms, contact

我有这个问题。看看这个：[http ://santz.net/index.contacto.html](http://santz.net/index.contacto.html)

尝试发送任何内容，看看会发生什么（这是我的，我收到了，发送任何内容都没问题......）。（它离开页面，显示一个对话框，感谢您与我们联系......并将您重定向到同一页面）。我讨厌这个！！！

我正在寻找一些 AJAX 和 jQuery 代码，在发送消息后，它会清除表单并打开一个对话框（常见的......就像典型的登录框）并且淡化页面并显示一些“x”内容...

问题是我不知道如何做这些事情，我快疯了！如果你能给我代码并告诉我把它放在哪里，或者只是为新手提供一个教程或类似的东西，那就太好了......

我在这里留下我正在使用的 PHP 代码：

```
<?php
$field_name = $_POST['php_name'];
$field_email = $_POST['php_email'];
$field_phone = $_POST['php_phone'];
$field_message = $_POST['php_message'];

$field_sender = 'alpha@hotmail.com';

$mail_to = 'gama@hotmail.com.ar';
$subject = 'Mensaje via Santz.net de '.$field_name;

$body_message = 'From: '.$field_name."\n";
$body_message .= 'E-mail: '.$field_email."\n";
$body_message .= 'Phone: '.$field_phone."\n";
$body_message .= 'Message: '.$field_message;

$headers = 'From: '.$field_sender."\r\n";
$headers .= 'Reply-To: '.$field_email."\r\n";

$mail_status = mail($mail_to, $subject, $body_message, $headers);

if ($mail_status) { ?>
    <script language="javascript" type="text/javascript">
        alert('Gracias por contactarse, en breve, me pondre en contacto.\n\nSantz Design | www.santz.net');
        window.location = 'index.contacto.html';
    </script>
<?php
}
else { ?>
    <script language="javascript" type="text/javascript">
        alert('El envio fallo. Por favor, envie un mail directamente a info@santz.net');
        window.location = 'index.contacto.html';
    </script>
<?php
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:31:09.707

尝试改变这个：

```
window.location.assign('http://www.santz.net/'); 
```

代替：

```
window.location = 'index.contacto.html'; 
```

在同一页面上显示错误消息，请遵循以下示例： [在字段集中添加验证消息而不是 js 弹出窗口](https://stackoverflow.com/questions/14651957/add-validation-message-in-fieldset-instead-of-js-popup/14652771#14652771)

对于模态窗口，使用这样的插件：

[http://www.mywebdeveloperblog.com/my-jquery-plugins/modalpoplite](http://www.mywebdeveloperblog.com/my-jquery-plugins/modalpoplite)

演示：

[http://www.mywebdeveloperblog.com/projects/modalpoplite/demo/](http://www.mywebdeveloperblog.com/projects/modalpoplite/demo/)

问候；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T20:36:50.417

你为什么不使用 jQuery

```
$('input[type="submit"]').click(function(e){
 e.preventDefault();
 $.ajax({
 type: "POST",
 url: contact.php,
 data: $('#contact-form"').serialize();,
 success: function() {
   //modal
  }
 });
}); 
```

沿着这些思路的东西将是提交表单的 ajax 方式，然后向用户弹出一个窗口说谢谢，请查看[我的表单](http://codepen.io/davidchase/pen/znsEj)以获得一个想法，而无需弹出窗口

# android - Android REST 访问外网

> ID：15209448
> 
> 赞同：0
> 
> 时间：2013-03-04T19:26:29.973
> 
> 标签：android, rest, routing

我正在尝试使用我的 Android 手机上的 REST 访问服务器的 Web 服务（我在网络内部）。在路由器中，我已经完成了“路由”以从外部访问所有查询，但路由器具有用户名和密码。

我的问题是是否有必要在 HTTP Post 或 HTTP 客户端中添加一些代码来访问我的路由器，因为所有连接都给了我`HttpHostConnectException: Connection to http://myipaddress:myport refused`

我尝试了一些代码，但这没有用。

```
@Override
protected Void doInBackground(Object... params) {
    kkk = ((Integer) params[2]);

    parametros = params;
    Log.i("SendOnlyOneFact", "Guardando datos de la actividad " + kkk);

    Thread.currentThread().setName("NA_SendOnlyOneFact-" + kkk);
    // Guardar los datos creados
    getActividades().get(kkk).saveData((android.app.Activity) params[1]);
    // Serializar los datos creados
    String cosa_serializada = getActividades().get(kkk).getMeasure()
            .serializeData(getActividades().get(kkk), (android.app.Activity) params[1]);

    // Obtener el XML a partir de ese arraylist
    // Enviarlo mediante REST
    HttpHost targetHost = new HttpHost(((GateDefinition) params[0]).getServer(),
            ((GateDefinition) params[0]).getPort(), "http");

    HttpPost httpPost = new HttpPost("http://" + ((GateDefinition) params[0]).getServer() + ":"
            + ((GateDefinition) params[0]).getPort() + "/" + ((GateDefinition) params[0])
            .getWeb_service());
    // Also be sure to tell the server what kind of content we are sending
    httpPost.setHeader("content-type", "text/plain");

    // Something like this, but this doesn't work :(
    ArrayList<NameValuePair> nvps = new ArrayList<NameValuePair>();
    nvps.add(new BasicNameValuePair("login", "1234"));
    nvps.add(new BasicNameValuePair("password", "1234"));
    try {
        httpPost.setEntity(new UrlEncodedFormEntity(nvps, "UTF_8"));
    } catch (UnsupportedEncodingException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    try {
        StringEntity entity = new StringEntity(cosa_serializada, "UTF-8");
        entity.setContentType("text/plain");
        httpPost.setEntity(entity);

        // execute is a blocking call, it's best to call this code in a
        // thread separate from the ui's
        response = httpClient.execute(targetHost, httpPost);
    } catch (SocketException ex) {
        Log.e("SendOnlyOneFact", "No existe conexión con el servidor");
        ex.printStackTrace();
    } catch (Exception ex) {
        ex.printStackTrace();
    }
    return null;
} 
```

**编辑：我用数据连接测试它并且它可以工作，但是用wifi它给了我这个例外，我不知道为什么！:o**

# perl - NetAddr 转储器输出

> ID：15209450
> 
> 赞同：0
> 
> 时间：2013-03-04T19:26:33.037
> 
> 标签：perl

`NetAddr::IP::Compact`尝试使用该功能时，我的脚本出现问题

```
my $var = new NetAddr::IP '127.0.0.1/8';
print Dumper $var; 
```

输出是：

```
$VAR1 = bless({
     'addr' => '',
     'isv6' => 0,
     'mask' => '?????????????'
}, 'NetAddr::IP'); 
```

我的问题是为什么我没有看到这里填写的地址和掩码字段？

```
Use of uninitialized value in sort at blib/lib/NetAddr/IP.pm (autosplit into blib/lib/auto/NetAddr/IP/compactref.al) line 737. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T20:35:45.147

因为 Data::Dumper 的默认设置很糟糕。

```
{
   local $Data::Dumper::Useqq = 1;
   print Dumper $var;
} 
```

# asp.net - Gridview中的Listbox绑定问题

> ID：15209454
> 
> 赞同：1
> 
> 时间：2013-03-04T19:26:50.813
> 
> 标签：asp.net, vb.net, gridview, listbox

我是一名 AS400 程序员，被要求使用 vb.net 在 asp.net 中编写程序。我以前从未这样做过，并且在 Gridview 中填充列表框时遇到问题。我已经研究了这个主题好几天了，但是我在示例中找到的所有我尝试过的代码都不起作用。请原谅任何非常糟糕的代码，因为我对.net 如此陌生，我相信这可以写得更好。感谢您提供的任何帮助。网格是“AdjusterList”，列表框称为“MAICD”。我认为 Public Sub AdjusterList_RowDataBound 中的“失败/错误”代码。它在数据绑定之前的行给了我一个空异常错误；oCtrl.DataSource = oRs

我正在使用一位高级 .net 程序员给我的代码，他无法为这个新手提供更多帮助。仅供参考....

这是我的aspx。

```
 <div id="div1" runat="server">
        <asp:GridView ID="AdjusterList" runat="server" Width="1100px" 
             ClientIDMode="Static" AllowSorting="True"
             AutoGenerateColumns="False" 
             OnRowCommand="AdjusterList_RowCommand"
             OnRowEditing="AdjusterList_RowEditing" 
             OnRowUpdating="AdjusterList_RowUpdating" 
             OnRowDeleting="AdjusterList_RowDeleting" 
             OnRowCancelingEdit="AdjusterList_RowCancelingEdit" 
             OnRowDataBound="AdjusterList_RowDataBound"
             DataKeyNames="INSCD, INSSEQ" 
             ShowHeaderWhenEmpty="True" EditRowStyle-BackColor="#FF9900" PageSize="20" 
             EmptyDataText="NO RECORDS FOUND FOR THIS INSURER" 
             ShowFooter="True"EnableViewState="true">
             <EditRowStyle BackColor="#FF9900" />

             <RowStyle BackColor="White" ForeColor="Black" />
            <Columns>

<asp:TemplateField>
<ItemTemplate>
<asp:LinkButton id="btnedit" runat="server" CommandName="Edit"/>
</ItemTemplate>
<EditItemTemplate>
<asp:LinkButton id="btnupdate" runat="server" CommandName="Update" Text="Save" />
<asp:LinkButton id="btncancel" runat="server" CommandName="Cancel" Text=Cancel"/>
</EditItemTemplate>

<FooterTemplate>
<asp:LinkButton id="btninsert" runat="server" CommandName="Insert" Text="Insert"/>
</FooterTemplate>
</asp:TemplateField> 

 <asp:TemplateField HeaderText ="Mail Code" ItemStyle-HorizontalAlign="Center">
 <ItemTemplate>
 <asp:Label ID="lblmaicd" runat="server" Text='<%# Bind("MAICD")%>'></asp:Label> 
 </ItemTemplate>
 <EditItemTemplate>
 <asp:ListBox ID="MAICD" runat="server" Rows="1"DataTextField="Text"
  DataValueField='<%# Bind("MAICD")%></asp:ListBox>
  </EditItemTemplate> 

  <FooterTemplate>
  <asp:ListBox ID="MAICD" runat="server" width="200" DataTextField="Text">
  </asp:ListBox>
  </FooterTemplate>
  </asp:TemplateField>
  </Columns>
  </asp:GridView> 
```

我后面的代码...

```
Imports System.Data
Imports System.Data.SqlClient
Imports System.Data.OleDb

Public Class EditAdjusterData
Inherits System.Web.UI.Page

Protected Sub Page_Load(ByVal sender As Object, ByVal e AsSystem.EventArgs)    
     Dim sAdjuster As String = Session("Adjuster")
     Dim sSeqNo As String = Session("SeqNo")

    PopulateEdit(sAdjuster, sSeqNo, dateok)
    If IsPostBack Then
        'divEdit.Visible = False
        'divSelect.Visible = True
        'ShowForm()
    Else
        AdjusterList.DataBind()
        'divEdit.Visible = True
        'divSelect.Visible = False
    End If

End Sub

Protected Sub PopulateEdit(sValue As String, sValue2 As String, sValue3 As String)

    ' CALL TO PGRTSTLIB FILE INSP TO GET INSURER NAME

    ' 2ND CALL TO PGRTSTLIB FILE INSD 

    Dim oConn As New OleDbConnection()
    Dim sConn As String = ""
    Dim oCmd As New OleDbCommand()
    Dim oAdapter As New OleDbDataAdapter()
    Dim oRs As DataSet = New DataSet
    Dim sSql As String = ""

    sConn = "Provider=IBMDA400.DataSource.1; 
    oConn = New OleDb.OleDbConnection(sConn)
    oConn.Open()

    sSql = "SELECT INSCD, INSSEQ, MAICD, MAISEQ, (substr(char(EFFDT),5,2) || '-' || substr(char(EFFDT),7,2) || '-' || substr(char(EFFDT),1,4)) AS EFFDT, (substr(char(CANDT),5,2) || '-' || substr(char(CANDT),7,2) || '-' || substr(char(CANDT),1,4)) AS CANDT, ACCFIL FROM PGRTSTLIB.INSD WHERE INSCD = '" & sValue & "' "

    oCmd = New OleDbCommand(sSql, oConn)

    Session(INSCD) = INSCD
    Session(EFFDT) = EFFDT
    Session(MAICD) = MAICD
    Session("CANDT") = CANDT

    oCmd.CommandType = CommandType.Text
    oAdapter.SelectCommand = oCmd
    oAdapter.Fill(oRs, "Data")

    Dim sMailCode As String = " "
    Dim sMailSeq As String = " "

    Dim pRow As DataRow
    For Each pRow In oRs.Tables("Data").Rows
        sMailCode = pRow("MAICD").ToString()
    Next

    Session(sMailCode) = MAICD
    Session(MAICD) = sMailCode
    Session(sMailCode) = sMailCode

    AdjusterList.DataSource = oRs
    'AdjusterList.DataBind()

    'If sMailCode <> " " Then
    '    PopulateMailCode(sMailCode)
    'End If

    oRs.Dispose()
    oAdapter.Dispose()
    oCmd.Dispose()
    oConn.Dispose()

     End Sub

Protected Sub AdjusterList_PageIndexChanging(ByVal sender As Object, 
ByVal e As  System.Web.UI.WebControls.GridViewPageEventArgs) 
    AdjusterList.PageIndex = e.NewPageIndex

    AdjusterList.DataBind()

   End Sub

Protected Sub AdjusterList_RowCommand(ByVal sender As Object,
ByVal e As System.Web.UI.WebControls.GridViewCommandEventArgs) 

End Sub

Protected Sub AdjusterList_RowCreated(ByVal sender As Object,
ByVal e As System.Web.UI.WebControls.GridViewRowEventArgs)

 End Sub

Public Sub AdjusterList_RowDataBound(ByVal Sender As Object,
ByVal e As GridViewRowEventArgs) Handles AdjusterList.RowDataBound

    If e.Row.RowType = DataControlRowType.DataRow Then

        If e.Row.FindControl("MAICD") IsNot Nothing Then

            Dim MAICD As ListBox = e.Row.FindControl("MAICD")

            'If (e.Row.RowState And DataControlRowState.Edit) > 0 Then

            BindAjusterList()

        End If
    End If

End Sub

 Public Sub BindAjusterList()

    Dim oConn As New OleDbConnection()
    Dim sConn As String = ""
    Dim oCmd As New OleDbCommand()
    Dim oAdapter As New OleDbDataAdapter()
    Dim oRs As DataSet = New DataSet
    Dim sSql As String = ""

    sConn = "Provider=IBMDA400.DataSource.1; "
    oConn = New OleDb.OleDbConnection(sConn)
    oConn.Open()

    'sSql = "SELECT MAICD as Value,  MAICD  AS Text from PGRTSTLIB.INSM order by MAICD"
    sSql = "SELECT MAICD As Value, MAICD AS TEXT from PGRTSTLIB.INSM"
    oCmd = New OleDbCommand(sSql, oConn)

    'oCmd.Parameters.Add(New SqlParameter("@Type", Insurer))
    oCmd.CommandType = CommandType.Text
    oAdapter.SelectCommand = oCmd
    oAdapter.Fill(oRs, "ListBox")

    Dim oCtrl As ListBox
    oCtrl = AdjusterList.FindControl("MAICD")

    oCtrl.Items.Add(New ListItem("", ""))

    oCtrl.DataSource = oRs
    oCtrl.DataBind()

    oCtrl.Items.Insert(0, New ListItem(String.Empty, String.Empty))

    If Len(sValue) > 0 Then
        oCtrl.SelectedValue = sValue
    Else
        sValue = " "
    End If

    oRs.Dispose()
    oAdapter.Dispose()
    oCmd.Dispose()
    oConn.Dispose()
End Sub

Public Sub AdjusterList_RowEditing(ByVal sender As Object, 
ByVal e As System.Web.UI.WebControls.GridViewEditEventArgs) 

 AdjusterList.EditIndex = e.NewEditIndex

 AdjusterList.DataBind()

End Sub

Protected Sub AdjusterList_RowUpdating(ByVal sender As Object, 
ByVal e As System.Web.UI.WebControls.GridViewUpdateEventArgs) 

    ' Dim row As GridViewRow = DirectCast(SubsidaryList.Rows(e.RowIndex), GridViewRow)

Dim INSCD As String = DirectCast(AdjusterList.Rows(e.RowIndex).Cells (0).FindControl    ("INSCD"), TextBox).Text
    Dim INSSEQ As String = DirectCast(AdjusterList.Rows(e.RowIndex).Cells(1).FindControl("INSSEQ"), TextBox).Text
    Dim MAICD As String = DirectCast(AdjusterList.Rows(e.RowIndex).Cells(2).FindControl("MAICD"), ListBox).Text
    Dim MAISEQ As String = DirectCast(AdjusterList.Rows(e.RowIndex).Cells(3).FindControl("MAISEQ"), TextBox).Text
    Dim EFFDT As String = DirectCast(AdjusterList.Rows(e.RowIndex).Cells(4).FindControl("EFFDT"), TextBox).Text
    Dim CANDT As String = DirectCast(AdjusterList.Rows(e.RowIndex).Cells(5).FindControl("CANDT"), TextBox).Text
    Dim ACCFIL As String = DirectCast(AdjusterList.Rows(e.RowIndex).Cells(6).FindControl("ACCFIL"), TextBox).Text

    AdjusterList.EditIndex = -1
    AdjusterList.DataBind()

    ' New Data to DataBind to sql datasource and resend page after RECORD updated

           Response.Redirect("EditAdjusterData.aspx")

   End Sub

Protected Sub AdjusterList_RowCancelingEdit() Handles AdjusterList.RowCancelingEdit
    AdjusterList.EditIndex = -1
    AdjusterList.DataBind()
End Sub

 End Class 
```

我对.net 很陌生，我可能无法完全理解每个示例。我认为高级 .net 程序员认为这很有趣:(

非常感谢，如果您能提供任何帮助，请随时与我联系。我只需要填充该死的列表框。我删除了我认为与此列表框问题无关的所有代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:52:34.763

在您的标记中，您应该将`DataValueField`ListBox 的属性更改为“Value”字符串，因为它是您为查询中的属性提供的别名`("SELECT MAICD As Value, MAICD AS TEXT from PGRTSTLIB.INSM")`：

```
<asp:ListBox ID="MAICD" runat="server" Rows="1"DataTextField="Text" DataValueField="Value"></asp:ListBox> 
```

此外，`RowDataBound`如果您正在使用该方法检索该行的 ListBox 实例`FindControl`，但随后您将在该`BindAjusterList()`方法中再次检索它。尝试更改方法以接收找到的控件：

```
Public Sub AdjusterList_RowDataBound(ByVal Sender As Object, ByVal e As GridViewRowEventArgs) Handles AdjusterList.RowDataBound
    If e.Row.RowType = DataControlRowType.DataRow Then
        If e.Row.FindControl("MAICD") IsNot Nothing Then
            Dim MAICD As ListBox = e.Row.FindControl("MAICD")            
            BindAjusterList(MAICD)
        End If
    End If
End Sub

Public Sub BindAjusterList(ByVal oCtrl As ListBox)
   ' existing logic
   oCtrl.Items.Add(New ListItem("", ""))

   oCtrl.DataSource = oRs
   oCtrl.DataBind()
   ' existing logic
End Sub 
```

# css - TinyMCE 和 Chrome 的 CSS 问题

> ID：15209455
> 
> 赞同：1
> 
> 时间：2013-03-04T19:26:50.993
> 
> 标签：css, google-chrome, tinymce

由于 Chrome 版本 25.0.1364.99 的发布，包括最近发布的版本 25.0.1364.152，当单击 TinyMCE 编辑内容时，CSS 引用似乎丢失了，TinyMCE IFrame 中内容的所有格式都丢失了。

CSS 引用可以在 HEAD 标记内的 IFrame 中看到。TinyMCE 控件中的内容看起来很好，直到您单击它以编辑内容。那时所有的 CSS 样式都会丢失。

# java - 让我们在java中获得一个流程

> ID：15209462
> 
> 赞同：0
> 
> 时间：2013-03-04T19:27:17.313
> 
> 标签：java, flow

我只是一个初学者并尝试学习 Java

目标 - 尝试在 java 中创建几个流，我的程序必须创建 3 个流和 1 个主流，然后停止。

做了什么：

使用已实现的 Runnable 创建类

```
class NewThread implements Runnable {
String name;
Thread t;

NewThread(String threadname){
    name = threadname;
    t = new Thread (this, name);
    System.out.println(t);
    t.start();
}

public void run (){
    try {
        System.out.println("111");// why cant see it?
        Thread.sleep(1000);
    }
    catch (InterruptedException e){
        System.out.println(e);
    }
    System.out.println("End Thread");
} 
```

主要：

```
 public class ThreadDemo {
 public static void main (String []args){
    new Thread ("F");
    new Thread ("S");
    new Thread ("T");

    try {
        Thread.sleep(10000);
    }
    catch (InterruptedException e){

    }
    System.out.println("End M");
}
} 
```

我想我会得到像 3 串 111 和一串 End M 这样的结果 -

```
111
111
111
End M 
```

但我只是

```
 End M 
```

谁能说为什么我的程序结果没有得到 3 个字符串？

非常感谢所有人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:30:25.013

您需要创建*`NewThread`*实例而不是通用`Threads`代码才能执行：

```
new NewThread("F");
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T19:33:12.810

`new Thread ("F");`创建一个[`Thread`](http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html)名为“F”的新对象，它与您的`NewThread`对象之一不同。您永远不会创建任何这些，因此您不应该期望他们的任何代码运行。此外，`Thread`在[`Runnable`](http://docs.oracle.com/javase/7/docs/api/java/lang/Runnable.html). 相反，您应该创建一个`Runnable`，然后[创建一个`Thread`来保存您`Runnable`](http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html#Thread%28java.lang.Runnable%29)[`start()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html#start%28%29)的和`Thread`. [Java Concurrency 教程](http://docs.oracle.com/javase/tutorial/essential/concurrency/)可能会帮助您理清思路。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T19:30:17.923

使用以下内容`public static void main`：

```
NewThread th1 = new NewThread ("F");
NewThread th2 = new NewThread ("S");
NewThread th3  =new NewThread ("T"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T19:33:57.060

找出我的错误

我必须写

```
public static void main (String []args){
    new NewThread ("F");
    new NewThread ("S");
    new NewThread ("T"); 
```

代替

```
 new Thread ("F"); 
```

现在好啦。

# java - SVN：“Base Revision”和“Latest from Repository”有什么区别？

> ID：15209463
> 
> 赞同：13
> 
> 时间：2013-03-04T19:27:17.557
> 
> 标签：java, eclipse, svn

在将工作区中的本地文件与存储库中的文件进行比较时，我遇到了：与>>“基本修订版”比较和与>>“存储库中的最新版本”进行比较。

那么，我想知道“基本修订版”和“存储库中的最新版本”有什么区别？

谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-04T19:32:08.333

“基本修订版”是您从存储库获得的最后一个修订版。“来自存储库的最新代码”是存储库拥有的最新代码。

来源：[当-does-svn-base-become-equal-to-the-head](https://stackoverflow.com/questions/742772/when-does-svn-base-become-equal-to-the-head)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-04T19:31:16.187

“基本修订”也称为`BASE`，即：工作副本中项目的修订号。如果项目已在本地修改，这是指项目在没有这些本地修改的情况下显示的方式。

“来自存储库的最新版本”是`HEAD`，即：存储库中的最新（或“最年轻”）修订版。

（取自[这里](http://svnbook.red-bean.com/en/1.7/svn.tour.revs.specifiers.html#svn.tour.revs.keywords)）

# javascript - 在 .png 图像中发送信息，然后通过 javascript 提取它？

> ID：15209468
> 
> 赞同：1
> 
> 时间：2013-03-04T19:27:29.650
> 
> 标签：javascript, jquery, performance, web-applications

在谷歌搜索了一段时间后，我的问题没有任何运气或指导。

**我希望能够使用 javascript、ajax 加载网站，以减少服务器需要来自客户端的请求数量。我的目标是在图像中嵌入/编码数据，这样只有客户端需要通过 ajax 调用请求该图像，然后解码以找到所需的 js、css 和其他文件。然后将js、css等文件插入到DOM中。**

如果我能让上述工作正常进行，那么我可以在如何加载我的 web 应用程序方面有很大的灵活性，并且能够通知用户 web 应用程序有多接近准备好查看。

**目前我的问题是我找不到如何对图像中的数据进行编码。**

即使这不是提供 Web 应用程序的方式，我的好奇心也越来越强，我真的很想这样做。

任何指导或指示将不胜感激！

**另外：我正在学习 Python，所以如果你知道我可以玩的 Python 模块，那会很酷。目前我正在玩[pypng](https://github.com/drj11/pypng)模块，看看是否可以这样做。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T20:35:01.740

坦率地说。不要那样做。

地球上最聪明的人使用其他方法来减少请求数量和响应时间。最小化请求数量的最常用技术称为捆绑。简而言之，您只需将所有 js 文件一个接一个地复制粘贴到一个大 js 文件中，然后将所有 css 文件复制到一个大 css 文件中。这样就需要下载两个文件，一个js，一个css。比这更好的通常不值得麻烦。

为了进一步缩短响应时间，您通常会缩小 js 和 css 文件。这是一个删除所有空格、注释等并尽可能缩短内部变量名称的过程。

最后，您可以将 js 和 css 文件作为 gzip 文件提供，以进一步减小要传输的文件大小。

有许多工具可以为您进行捆绑和缩小。谷歌并选择一个适合您的其他工具支持的工具。

# visual-studio - 在 Visual Studio 中暗淡/隐藏记录代码行

> ID：15209471
> 
> 赞同：11
> 
> 时间：2013-03-04T19:27:35.087
> 
> 标签：visual-studio, visual-studio-2012

有什么方法可以使 Visual Studio 变暗或按需隐藏/显示我的代码记录行？
我们在我们的项目中使用了大量的日志记录，并且很难阅读这样的代码。

我希望它是这样的，例如：

![我希望它是这样的，例如：](../Images/f8a52aaf1a39b4b352a6f2609ce66190.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2019-09-26T15:38:11.360

Unobtrusive Code 扩展适用于 Visual Studio 2019。它降低了日志行（和我禁用的评论的不透明度 - 我喜欢阅读我的评论）的不透明度。他对 nuget 包进行了快速更新，效果很好。

[https://marketplace.visualstudio.com/items?itemName=niklaskallander.UnobtrusiveCode](https://marketplace.visualstudio.com/items?itemName=niklaskallander.UnobtrusiveCode)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-02-10T05:27:37.343

我用这个。希望有一天他们也会添加颜色自定义和行选择正则表达式选项：

[https://marketplace.visualstudio.com/items?itemName=ElmarXCV.GrayLogLines](https://marketplace.visualstudio.com/items?itemName=ElmarXCV.GrayLogLines)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T19:30:49.637

标准 Visual Studio IDE 无法做到这一点。为了做到这一点，您需要定义一个自定义扩展来识别这样的行，用特定格式标记它们，并在 IDE 中将该格式着色为较浅的颜色

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T19:40:00.880

一种“更黑客”的方式是将所有日志记录在预处理器指令中，例如

```
#if DEBUG
Log.Info(........)
#endif 
```

Visual-Studio 将使里面的代码“变暗”。并有某种配置头，你

```
#define DEBUG 0 
```

不是最漂亮的，但如果您不想将调试代码编译到 Release 二进制文件中，那就太好了

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-03-04T19:38:17.730

你为什么不把你的部分放在#region 标签中。

例如：

```
     #region 在此处输入一些区域名称供您参考
          你的代码/评论/随便
     #endregion

```

# php - 如何将 2 个数组与数字索引合并并在 PHP 中替换值？

> ID：15209475
> 
> 赞同：2
> 
> 时间：2013-03-04T19:27:44.773
> 
> 标签：php, arrays, merge

我有 2 个数组嵌套到来自外部源的 4 或 5 个级别（因此，如果可能，我不能也不想手动更改结构）。我已经简化了下面的问题，但请记住，这些结构超出了我的控制范围，所以我需要一个通用的解决方案。

```
$x = array (
  'one' => 
  array (
    'two' => 2,
    'three' => 
    array (
      0 => 3,
    ),
  ),
);

$y = array (
  'one' => 
  array (
    'three' => 
    array (
      0 => 3,
    ),
    'four' => 4,
    'five' => 5,
  ),
  'six' => 6
); 
```

我想合并这些并得到：

```
array (
  'one' => 
  array (
    'two' => 2,
    'three' => 
    array (
      0 => 3,
    ),
    'four' => 4,
    'five' => 5,
  ),
  'six' => 6
) 
```

我已经尝试了以下所有方法，但没有一个能完全满足上述要求：

```
var_dump($x+$y);
var_dump(array_merge($x,$y));
var_dump(array_merge_recursive($x,$y));

var_dump($y+$x);
var_dump(array_merge($y,$x));
var_dump(array_merge_recursive($y,$x)); 
```

所以，我想我需要一些自定义代码来进行合并。那会是什么？保持通用和简单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:36:25.097

```
function array_merge_recursive_unique($array1, $array2) {
  if (empty($array1)) return $array2; //optimize the base case

  foreach ($array2 as $key => $value) {
    if (is_array($value) && is_array(@$array1[$key])) {
      $value = array_merge_recursive_unique($array1[$key], $value);
    }
    $array1[$key] = $value;
  }
  return $array1;
} 
```

发帖前请先搜索。这是[merge-2-arrays-with-no-duplicated-keys 的副本](https://stackoverflow.com/questions/4137140/merge-2-arrays-with-no-duplicated-keys)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T19:37:24.620

使用 Zend\StdLib\ArrayUtils::merge()，此方法用于合并 ZF2 中的配置数组并按照您的意愿进行操作。

见： [https ://github.com/zendframework/zf2/blob/master/library/Zend/Stdlib/ArrayUtils.php](https://github.com/zendframework/zf2/blob/master/library/Zend/Stdlib/ArrayUtils.php)

# osx-mountain-lion - tmux OSX 10.8.3 显示 ipaddress

> ID：15209482
> 
> 赞同：1
> 
> 时间：2013-03-04T19:28:06.660
> 
> 标签：osx-mountain-lion, tmux

我正在尝试在 tmux 状态行的右侧显示我的 ipaddress 和日期。我有以下命令：

```
set -g status-right "#[fg-cyan]#(ifconfig | awk '$1 == "inet" { print $2 }') #[fg=cyan]%d %b %R" 
```

它显示日期，但不显示 IP 地址。我没有从 Tmux 收到任何错误，所以我不确定出了什么问题。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T09:45:34.777

检查实际最终设置的值：

```
tmux show-option -g | grep status-right 
```

我希望您会发现 . 周围没有双引号`inet`。双引号解析不认为`#()`语法是特殊的（与`"$()"`shell 不同，您可以在命令替换中简单地使用双引号）。因此，解析分三部分完成：

*   `"#[fg-cyan]#(ifconfig | awk '$1 == "`
*   `inet`
*   `" { print $2 }') #[fg=cyan]%d %b %R"`

这些被连接到这个：

```
#[fg-cyan]#(ifconfig | awk '$1 == inet { print $2 }') #[fg=cyan]%d %b %R 
```

作为一个*awk*程序，这最终会检查`$1`一个未设置的变量`inet`，而不是文字 string `"inet"`；*awk*可能不会抱怨，但没有行会匹配。

您可以转义双引号以让它们传递到最终字符串中：

```
set -g status-right "#[fg-cyan]#(ifconfig | awk '$1 == \"inet\" { print $2 }') #[fg=cyan]%d %b %R" 
```

当我设置这个时，我只是看到`127.0.0.1`；您可能想要添加 a`|tail -1`以使用最后一行而不是第一行。

另外两个项目：

*   你有`[fg-`而不是`[fg=`, 和
*   因为您在两个地方都指定了相同的颜色，所以您可以省略第二个。

因此：

```
set -g status-right "#[fg=cyan]#(ifconfig | awk '$1 == \"inet\" { print $2 }'|tail -1) %d %b %R" 
```

# ios - iOS App UIView 旋转，内容不旋转

> ID：15209493
> 
> 赞同：3
> 
> 时间：2013-03-04T19:28:45.547
> 
> 标签：ios, objective-c

我目前正在构建一个 iOS 应用程序，唯一支持的方向是左右横向。我已经通过几种方式指定了这一点：

```
-(BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation{
    return UIInterfaceOrientationIsLandscape(toInterfaceOrientation); //iOS 5 compatibility.
}
-(NSInteger)supportedInterfaceOrientations:(UIWindow *)window{
    return UIInterfaceOrientationMaskLandscape; //iOS 6
}
-(BOOL)shouldAutorotate{
    return YES;
} 
```

而且我已经在应用程序的 Info.plist 中将支持的方向指定为仅横向的方向。当我在我的设备上（甚至在模拟器中）运行应用程序时，我知道根视图是横向的（切换器位于屏幕的长边，通知中心也是如此），但是内容仍然来自屏幕的左上角，就像在纵向模式下一样，而不是左下角或右上角，就像我想要的那样。我不知道是什么导致内容不随父视图旋转，因为此代码适用于 iOS 5，但不适用于 iOS 6。

编辑：[这是一个截图。](http://d.pr/i/ZOgY)

编辑：这是我的 main.m：

```
#import <UIKit/UIKit.h>
int main(int argc, char **argv) {
    NSAutoreleasePool *p = [[NSAutoreleasePool alloc] init];
    int ret = UIApplicationMain(argc, argv, @"ClockApplication", @"ClockApplication");
    [p drain];
    return ret;
} 
```

这是我的 ClockApplication.mm：

```
#import "RootViewController.h"

@interface ClockApplication: UIApplication <UIApplicationDelegate> {
    UIWindow *_window;
    RootViewController *_viewController;
}
@property (nonatomic, retain) UIWindow *window;
@end

@implementation ClockApplication
@synthesize window = _window;
- (void)applicationDidFinishLaunching:(UIApplication *)application {
    _window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    _viewController = [[RootViewController alloc] init];
    [_window addSubview:_viewController.view];
    [_window makeKeyAndVisible];
}

- (void)dealloc {
    [_viewController release];
    [_window release];
    [super dealloc];
}
@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:43:14.853

尝试从这里改变你的方法

```
-(NSInteger)supportedInterfaceOrientations:(UIWindow *)window{
} 
```

对此

```
-(NSUInteger)supportedInterfaceOrientations{
} 
```

编辑

尝试在这样的导航控制器中调用您的视图：

```
UIViewController *yourViewController = [[UIViewController alloc] init];
UINavigationController *nc = [[UINavigationController alloc] initWithRootViewController:yourViewController];
nc.navigationBarHidden = YES;
[self.navigationController presentModalViewController:nc animated:NO];
[self.navigationController dismissModalViewControllerAnimated:NO]; 
```

**编辑**

```
#import "RootViewController.h"

@interface ClockApplication: UIApplication <UIApplicationDelegate> {
    UIWindow *_window;
    RootViewController *_viewController;
}
@property (nonatomic, retain) UIWindow *window;
@end

@implementation ClockApplication
@synthesize window = _window;
- (void)applicationDidFinishLaunching:(UIApplication *)application {
    _window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];

    UINavigationController *nc = [[UINavigationController alloc] initWithRootViewController:_viewController];
    nc.navigationBarHidden = YES;

    _window.rootViewController = nc;
    [_window makeKeyAndVisible];
}

- (void)dealloc {
    [_viewController release];
    [_window release];
    [super dealloc];
}
@end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T20:14:55.450

尝试添加：

```
_window.rootViewController = _viewController; 
```

编辑：无论如何，您的代码看起来像使用“已弃用”样式。我建议为 iOS6 建立一个新项目并使用它的模板。它在 iOS5 上运行，但 iOS 发生了变化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T20:17:07.553

只有`rootViewController`您的`UIWindow`人会收到轮换事件。

```
[_window setRootViewController:_rootViewController]; 
```

查看[苹果技术说明](http://developer.apple.com/library/ios/#qa/qa1688/_index.html)。

# c++ - 将freetype位图复制到opengl纹理的问题

> ID：15209494
> 
> 赞同：2
> 
> 时间：2013-03-04T19:28:48.607
> 
> 标签：c++, opengl, freetype

我正在尝试为 to 中的字符生成所有位图`' '`并将`'~'`它们添加到一个长纹理中。我打算将它们放置在固定宽度的纹理中，但现在我只是想确保这个概念能够奏效。

但我遇到了问题。我没有得到预期的纹理，而是得到下面的 16px 字体： ![在此处输入图像描述](../Images/b4a3947fc7ca6eb932b33d5b7551b8cc.png)

在我看来，好像我复制错了，但无论我做什么，我似乎总是得到相同的输出。

最后，代码：

字体.h

```
#ifndef _FONT_H_
#define _FONT_H_

#include <iostream>
#include <fstream>
#include <string>
#include <vector>
#include <GL/gl.h>

#include <ft2build.h>
#include FT_FREETYPE_H

#include "vector2.h"
#include "math_helper.h"

class Font {
public:
  Font(const std::string font_path, int size);
  ~Font();

  int get_texture() const { return texture_; }

private:
  unsigned int width_, height_, texture_;

  static FT_Library LIBRARY;
  static const char START_CHAR = ' ';
  static const char END_CHAR   = '~';

  static void initialize_library();
};

#endif 
```

字体.cpp

```
#include "font.h"

FT_Library Font::LIBRARY = NULL;        

Font::Font(const std::string font_path, int size)
  : width_(64), height_(2), texture_(0) {
  initialize_library();

  FT_Face face = NULL;
  int error = FT_New_Face(Font::LIBRARY, font_path.c_str(), 0, &face);

  if(error == FT_Err_Unknown_File_Format) {
    std::cout << "Error: Unknown file format for font \"" << font_path << "\"" << std::endl;
  } else if(error) {
    std::cout << "Error: Could not open font \"" << font_path << "\"" << std::endl;
  }

  error = FT_Set_Pixel_Sizes(face, 0, size);
  if(error) {
    std::cout << "Error: Could not set pixel size for font \"" << font_path << "\"" << std::endl;
  }

  int num_chars = (END_CHAR - START_CHAR);
  width_ = to_nearest_pow2(num_chars * size);
  height_ = to_nearest_pow2(size);
  std::vector<unsigned char> buffer(width_ * height_, 0);
  Vector2 pen;

  for(char c = START_CHAR; c <= END_CHAR; ++c) {
    error = FT_Load_Char(face, c, FT_LOAD_RENDER);

    if(error) {
      std::cout << "Error: Could not load char \"" << c << "\"" << std::endl;
      continue;
    }

    FT_Bitmap bmp = face->glyph->bitmap;
    int advance = (face->glyph->advance.x >> 6);
    int bitmapWidth = bmp.width; //I have tried pitch, same problem
    int bitmapHeight = bmp.rows;

    for(int h = 0; h < bitmapHeight; ++h) {
      for(int w = 0; w < bitmapWidth; ++w) {
        int index = h * bitmapWidth + pen.x;

        buffer[index + w] = bmp.buffer[w + bitmapWidth * h];
      }
    }

    pen.x += advance;
  }

  glPixelStorei(GL_UNPACK_ALIGNMENT, 1);
  glGenTextures(1, &texture_);
  glBindTexture(GL_TEXTURE_2D, texture_);
  glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
  glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
  glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP);
  glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP);
  glTexImage2D(GL_TEXTURE_2D, 0, GL_ALPHA, width_, height_, 0, GL_ALPHA, GL_UNSIGNED_BYTE, &buffer[0]);

  FT_Done_Face(face);
}

Font::~Font() {
  if(texture_ != 0) {
    glDeleteTextures(1, &texture_);
  }
}

void Font::initialize_library() {
  if(Font::LIBRARY == NULL) {
    if(FT_Init_FreeType(&Font::LIBRARY) != 0) {
      std::cout << "Error: Unable to initialize FreeType Library" << std::endl;
      return;
    }
  }
} 
```

Vector2 只是一个带有 x 和 y 字段的简单结构，在构造时初始化为 0。

`to_nearest_pow2`定义为：

```
template<typename T>
T to_nearest_pow2(const T num) {
  T nearest = 2;

  while((nearest <<= 1) < num);

  return nearest;
} 
```

哦，这就是我将它绘制到屏幕上的方式（我正在使用正交投影）

```
 glEnable(GL_BLEND);
  glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);

  glEnable(GL_TEXTURE_2D);
  glBindTexture(GL_TEXTURE_2D, test->get_texture());
  glBegin(GL_QUADS);
  glTexCoord2i(0, 0); glVertex2i(0, 0);
  glTexCoord2i(1, 0); glVertex2i(400, 0);
  glTexCoord2i(1, 1); glVertex2i(400, 400);
  glTexCoord2i(0, 1); glVertex2i(0, 400);
  glEnd(); 
```

**编辑**

我更改`index`为@shouston 建议的内容，现在我得到了这个输出

![在此处输入图像描述](../Images/b2a9be32efbdec431e9ec338cda9fc6e.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T22:59:21.787

将您的输出图像重新缩放到 1000x60 之类的大小，您会得到一个惊喜。这是paint.net 由您附加的PNG 制成的。

![在此处输入图像描述](../Images/7fe284fa529f070f765f7b1ae8dd35b1.png)

首先是显而易见的事情。字符基本上就在那里，但由于某种原因，你只是把它们渲染得非常小（`size`你传递了什么值？）

此外，您不会尝试处理任何自由类型字符度量，因此不要期望它们都很好地排列。然而...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T21:33:13.417

问题在于纹理缓冲区的索引：

```
int index = h * bitmapWidth + pen.x; 
```

应该

```
int index = h * width_ + pen.x; 
```

即，将 h 乘以纹理的全宽，而不是字形的宽度。

# c# - 通过缓存或委托调用来提高性能？

> ID：15209498
> 
> 赞同：1
> 
> 时间：2013-03-04T19:28:52.183
> 
> 标签：c#, reflection

我正在尝试提高下面代码中的性能，并且有点知道如何但不确定哪种方法是最好的。第一次命中需要更长的时间，但随后的命中应该更快。现在，我可以缓存 T（其中 T 是一个类），然后检查缓存以查看“T”是否存在，如果存在 - 继续获取其相关信息（NamedArguments）并遍历每个 NamedArguments，最后如果条件匹配，继续设置当前属性的值。

我只是想让它更有效率和性能。有任何想法吗？

```
var myProps = typeof(T).GetProperties(BindingFlags.Instance | BindingFlags.NonPublic | BindingFlags.Public | BindingFlags.Static).Where(prop => Attribute.IsDefined(prop, typeof(MyCustomAttribute)) && prop.CanWrite && prop.GetSetMethod() != null);

foreach (var currentProperty in myProps)
{
    foreach (var currentAttributeForProperty in currentProperty.GetCustomAttributesData())
    {
        foreach (var currentNamedArgument in currentAttributeForProperty.NamedArguments)
        {
            if (string.Equals(currentNamedArgument.MemberInfo.Name, "PropName", StringComparison.OrdinalIgnoreCase))
            {
                currentAttribParamValue = currentNamedArgument.TypedValue.Value == null ? null : currentNamedArgument.TypedValue.Value.ToString();

                // read the reader for the currentAttribute value
                if (reader.DoesFieldExist(currentAttribParamValue))
                {
                    var dbRecordValue = reader[currentAttribParamValue] == DBNull.Value ? null : reader[currentAttribParamValue];

                    // set it in the property
                    currentProperty.SetValue(val, dbRecordValue, null);
                }
                break;
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T19:36:26.650

DynamicMethods 或 ExpressionTrees 将比反射快得多。您可以为某个类型构建所有属性 getter/setter 的缓存，然后将该信息缓存在 a `Dictionary`(or `ConcurrentDictionary`) 中，并将 type 作为键。

*   [表达式树基础](http://blogs.msdn.com/b/charlie/archive/2008/01/31/expression-tree-basics.aspx)
*   [动态方法](http://msdn.microsoft.com/en-us/library/exczf7b9.aspx)

## 流动

*   发现类型信息（例如在应用启动时）。
*   为每个属性编译动态方法（一次执行所有属性）。
*   将这些方法存储在元数据类中（示例如下）。
*   在某处缓存元数据（即使是静态字段也可以，只要访问是同步的）。使用类型作为键。
*   在需要时获取该类型的元数据。
*   找到合适的 getter/setter。
*   调用，传递您希望对其执行操作的实例。

```
// Metadata for a type
public sealed class TypeMetadata<T> {

    // The compiled getters for the type; the property name is the key
    public Dictionary<string, Func<T, object>> Getters {
        get;
        set;
    }

    // The compiled setters for the type; the property name is the key
    public Dictionary<string, Action<T, object>> Setters {
        get;
        set;
    }
}

// rough invocation flow
var type = typeof( T);
var metadata = _cache[type];

var propertyName = "MyProperty";
var setter = metadata[propertyName];

var instance = new T();
var value = 12345;
setter( instance, value ); 
```

## 示例二传手

摘自[动态方法实现](http://lostechies.com/jimmybogard/2009/08/06/late-bound-invocations-with-dynamicmethod/)（关于该主题的好文章）。

我不能保证这个*确切的*代码有效，但我自己编写了非常相似的代码。如果您对 IL 不满意，请务必考虑使用表达式树。

```
public static LateBoundPropertySet CreateSet(PropertyInfo property)
{
    var method = new DynamicMethod("Set" + property.Name, null, new[] { typeof(object), typeof(object) }, true);
    var gen = method.GetILGenerator();

    var sourceType = property.DeclaringType;
    var setter = property.GetSetMethod(true);

    gen.Emit(OpCodes.Ldarg_0); // Load input to stack
    gen.Emit(OpCodes.Castclass, sourceType); // Cast to source type
    gen.Emit(OpCodes.Ldarg_1); // Load value to stack
    gen.Emit(OpCodes.Unbox_Any, property.PropertyType); // Unbox the value to its proper value type
    gen.Emit(OpCodes.Callvirt, setter); // Call the setter method
    gen.Emit(OpCodes.Ret);

    var result = (LateBoundPropertySet)method.CreateDelegate(typeof(LateBoundPropertySet));

    return result;
} 
```

^(*根据我的经验，快 25-100 倍)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T19:36:37.443

众所周知，反射在循环中的速度很慢，因此某种缓存可能会有所帮助。但是要决定缓存什么，你应该**测量**. 俗话说：“过早的优化是万恶之源”；您应该确保您确实需要优化以及具体要优化什么。

对于更具体的建议，属性是在编译时附加的，因此您可以缓存一个类型和它的 propertyInfos 列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T19:36:18.430

我曾经也遇到过类似的问题 - 反射非常缓慢。我用缓存，像你计划的一样，性能增长**10倍以上**。它再也不会成为性能的瓶颈。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T19:33:35.370

在为遇到的每种类型缓存“执行计划”之前，我已经创建了类似的逻辑。后续运行肯定会更快，但您必须分析您的场景以查看是否值得额外的代码复杂性和内存使用。

# asp.net - 在 ASP.NET 中，内联表达式是在后面的代码之前还是之后执行的？

> ID：15209500
> 
> 赞同：2
> 
> 时间：2013-03-04T19:28:59.243
> 
> 标签：asp.net, code-behind

[ASP 内联表达式](http://support.microsoft.com/kb/976112) 是在执行`<% ... %>`代码隐藏代码之前还是之后在服务器上运行的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-04T19:32:48.963

内联代码在 asp.net 页面生命周期中的预渲染页面之后执行。因此，它可以在某些事情之前运行，也可以在某些事情之后运行。在此处阅读页面生命周期：

[http://msdn.microsoft.com/en-us/library/ms178472(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/ms178472(v=vs.100).aspx)

prerender 之后发生的事件是：

*   预渲染完成
*   保存状态完成
*   使成为
*   卸下

所以其他页面生命周期事件中的任何代码都将首先执行。

来自[微软的文档](http://msdn.microsoft.com/en-us/library/ms178135.aspx)：

> 嵌入式代码块是在页面呈现阶段执行的服务器代码。

# android - 我如何知道我的 Android 应用程序是否在后台运行？

> ID：15209501
> 
> 赞同：1
> 
> 时间：2013-03-04T19:29:00.477
> 
> 标签：android, android-activity

我的 Android 应用程序中有一个 WebView。

我敬酒以显示加载进度。

```
 webView.setWebChromeClient(new WebChromeClient() {
        @Override
        public void onProgressChanged(WebView view, int progress) {
            super.onProgressChanged(view, progress);

            toast.setText("Loading..." + String.valueOf(progress) + "%");
            toast.show();
        }
    }); 
```

问题是当我按下“主页”按钮或启动另一个活动时，它仍然会不断更新并显示吐司。

有没有办法检查当前的活动是否正在显示？

例如：

```
if(getActivity().isVisible())
   toast.show(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T19:33:14.060

您可以在 onStop() 中为自己设置一个布尔标志，当您从屏幕上移除时会调用该标志。

```
private boolean amShowing = false;

protected void onStart(){
    super.onStart();
    amShowing = true;
}

protected void onStop() {
    super.onStop();
    amShowing = false;
} 
```

当您使用 if 语句时，您可以使用

```
if(amShowing) {
   toast.show();
} 
```

# matlab - matlab，数据游标值RGB可以作为变量使用吗？

> ID：15209503
> 
> 赞同：-1
> 
> 时间：2013-03-04T19:29:03.437
> 
> 标签：matlab

是否可以将上传图像的数据光标中给出的 RGB 值用作变量？

例如

如果 RGB = 9 28 90（在别处绘图）结束

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T20:25:19.697

如果您阅读了有关数据游标的文档，您会很容易找到它：

*   [将数据值导出到工作区变量](http://www.mathworks.com/help/matlab/creating_plots/data-cursor-displaying-data-values-interactively.html#f4-44319)

![在此处输入图像描述](../Images/9e2d53c1eb69868874d438da888eba18.png)

# .net-4.0 - 使用 .net 4.5 在构建服务器上编译 .net 4.0 项目

> ID：15209507
> 
> 赞同：5
> 
> 时间：2013-03-04T19:29:19.913
> 
> 标签：.net-4.0, msbuild, .net-4.5

我们遇到了看似常见的错误

```
Could not load type 'System.Runtime.CompilerServices.ExtensionAttribute' from assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089 
```

在需要针对 .Net 4.0 编译但构建在运行 Windows Server 2012（使用 .Net 4.5）的构建服务器上的项目中。该项目是一个 Web 应用程序，它被部署到运行 2003 的 Web 服务器上，其中不能选择安装 .Net 4.5。它与“经典”.Net 4.0 相悖

从类似的问题中，我们正在尝试 MSBuild 的命令行选项：

```
/property:FrameworkPathOverride="C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.0" 
```

我们还尝试了各种组合

```
/property:ReferencePath="C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.0"
/property:NoStdLib=true
/property:NoCompilerStandardLib=true 
```

参考程序集（包括 .dll 文件）实际上安装在构建服务器上的那个位置。但是当我们部署网站并访问主页时，我们得到了那个错误。（有趣的是，在页面重新加载时，错误消失了，并且站点正常运行。）针对 .Net 4.0 程序集进行编译所需的 MSBuild 参数是什么？

**更新** 我在 MSBuild 上打开了可笑级别的日志记录，我看到它显然是针对 .Net 4.0 参考程序集构建的：

```
Resolved file path is "C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.0\mscorlib.dll 
```

而且我没有看到任何提及该文件夹或构建服务器工作目录之外的程序集。所以它看起来可以正确编译，但是当部署在 Web 服务器上时，它会抛出异常。

至于页面重新加载时异常消失，我想知道这是否与标记预编译步骤有关。我们在构建服务器上运行 aspnet_compile。也许如果生成的程序集出现异常，Web 服务器将重新编译它。重新编译的程序集很好，因为它是用真正的 .Net 4.0 创建的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T16:27:24.840

好吧，结果证明是令人尴尬的边缘。在我们从详细的 MSBuild 输出确认它实际上是针对正确的参考程序集构建网站项目后，我们意识到项目中有几个内部 NuGet 包是针对 .Net 4.5 构建的。其中一个充满了扩展方法，这就是导致异常的原因。针对 .Net 4.0 重建它们解决了这个问题。

这带来了一个有趣的问题。如果为 4.0 编译第 3 方 NuGet 包但使用 4.5 引用，我们将处于相同的情况，但无法修复它。所以包发布者的教训是确保您的 4.0 版本是针对参考程序集编译的。

# php - PHP中模型验证的最佳方法？

> ID：15209511
> 
> 赞同：36
> 
> 时间：2013-03-04T19:29:29.580
> 
> 标签：php, validation, model

我了解到通常有很多方法可以解决一个编程问题，每种方法通常都有自己的好处和负面影响。

我今天要确定的是在 PHP 中进行模型验证的最佳方法。以一个人为例，我概述了我过去使用过的四种不同的方法，每种方法都包括类和一个用法示例，以及我喜欢和不喜欢每种方法的地方。

我的问题是：**你觉得哪种方法最好？或者你有更好的方法吗？**

## 方法 #1：在模型类中使用 setter 方法进行验证

### 好的

*   简单，只有一个类
*   通过抛出异常，类永远不会处于无效状态（业务逻辑除外，即死亡先于出生）
*   不必记得调用任何验证方法

### 坏的

*   只能返回 1 个错误（通过`Exception`）
*   需要使用异常并捕获它们，即使错误不是非常异常
*   只能作用于一个参数，因为其他参数可能尚未设置（无法比较`birth_date`和`death_date`）
*   由于大量验证，模型类可能很长

```
class Person
{
    public $name;
    public $birth_date;
    public $death_date;

    public function set_name($name)
    {
        if (!is_string($name))
        {
            throw new Exception('Not a string.');
        }

        $this->name = $name;
    }

    public function set_birth_date($birth_date)
    {
        if (!is_string($birth_date))
        {
            throw new Exception('Not a string.');
        }

        if (!preg_match('/(\d{4})-([01]\d)-([0-3]\d)/', $birth_date))
        {
            throw new Exception('Not a valid date.');
        }

        $this->birth_date = $birth_date;
    }

    public function set_death_date($death_date)
    {
        if (!is_string($death_date))
        {
            throw new Exception('Not a string.');
        }

        if (!preg_match('/(\d{4})-([01]\d)-([0-3]\d)/', $death_date))
        {
            throw new Exception('Not a valid date.');
        }

        $this->death_date = $death_date;
    }
} 
```

```
// Usage:

try
{
    $person = new Person();
    $person->set_name('John');
    $person->set_birth_date('1930-01-01');
    $person->set_death_date('2010-06-06');
}
catch (Exception $exception)
{
    // Handle error with $exception
} 
```

## 方法 #2：在模型类中使用验证方法进行验证

### 好的

*   简单，只有一个类
*   可以验证（比较）多个参数（因为在设置所有模型参数之后进行验证）
*   可以返回多个错误（通过`errors()`方法）
*   免于例外的自由
*   让 getter 和 setter 方法可用于其他任务

### 坏的

*   模型可能处于无效状态
*   开发者一定要记得调用验证`is_valid()`方法
*   由于大量验证，模型类可能很长

```
class Person
{
    public $name;
    public $birth_date;
    public $death_date;

    private $errors;

    public function errors()
    {
        return $this->errors;
    }

    public function is_valid()
    {
        $this->validate_name();
        $this->validate_birth_date();
        $this->validate_death_date();

        return count($this->errors) === 0;
    }

    private function validate_name()
    {
        if (!is_string($this->name))
        {
            $this->errors['name'] = 'Not a string.';
        }
    }

    private function validate_birth_date()
    {
        if (!is_string($this->birth_date))
        {
            $this->errors['birth_date'] = 'Not a string.';
            break;
        }

        if (!preg_match('/(\d{4})-([01]\d)-([0-3]\d)/', $this->birth_date))
        {
            $this->errors['birth_date'] = 'Not a valid date.';
        }
    }

    private function validate_death_date()
    {
        if (!is_string($this->death_date))
        {
            $this->errors['death_date'] = 'Not a string.';
            break;
        }

        if (!preg_match('/(\d{4})-([01]\d)-([0-3]\d)/', $this->death_date))
        {
            $this->errors['death_date'] = 'Not a valid date.';
            break;
        }

        if ($this->death_date < $this->birth_date)
        {
            $this->errors['death_date'] = 'Death cannot occur before birth';
        }
    }
} 
```

```
// Usage:

$person = new Person();
$person->name = 'John';
$person->birth_date = '1930-01-01';
$person->death_date = '2010-06-06';

if (!$person->is_valid())
{
    // Handle errors with $person->errors()
} 
```

## 方法#3：在单独的验证类中验证

### 好的

*   非常简单的模型（所有验证都在单独的类中进行）
*   可以验证（比较）多个参数（因为在设置所有模型参数之后进行验证）
*   可以返回多个错误（通过`errors()`方法）
*   免于例外的自由
*   让 getter 和 setter 方法可用于其他任务

### 坏的

*   稍微复杂一点，因为每个模型都需要两个类
*   模型可能处于无效状态
*   开发者一定要记得使用验证类

```
class Person
{
    public $name;
    public $birth_date;
    public $death_date;
} 
```

```
class Person_Validator
{
    private $person;
    private $errors = array();

    public function __construct(Person $person)
    {
        $this->person = $person;
    }

    public function errors()
    {
        return $this->errors;
    }

    public function is_valid()
    {
        $this->validate_name();
        $this->validate_birth_date();
        $this->validate_death_date();

        return count($this->errors) === 0;
    }

    private function validate_name()
    {
        if (!is_string($this->person->name))
        {
            $this->errors['name'] = 'Not a string.';
        }
    }

    private function validate_birth_date()
    {
        if (!is_string($this->person->birth_date))
        {
            $this->errors['birth_date'] = 'Not a string.';
            break;
        }

        if (!preg_match('/(\d{4})-([01]\d)-([0-3]\d)/', $this->person->birth_date))
        {
            $this->errors['birth_date'] = 'Not a valid date.';
        }
    }

    private function validate_death_date()
    {
        if (!is_string($this->person->death_date))
        {
            $this->errors['death_date'] = 'Not a string.';
            break;
        }

        if (!preg_match('/(\d{4})-([01]\d)-([0-3]\d)/', $this->person->death_date))
        {
            $this->errors['death_date'] = 'Not a valid date.';
            break;
        }

        if ($this->person->death_date < $this->person->birth_date)
        {
            $this->errors['death_date'] = 'Death cannot occur before birth';
        }
    }
} 
```

```
// Usage:

$person = new Person();
$person->name = 'John';
$person->birth_date = '1930-01-01';
$person->death_date = '2010-06-06';

$validator = new Person_Validator($person);

if (!$validator->is_valid())
{
    // Handle errors with $validator->errors()
} 
```

## 方法#4：模型类和验证类中的验证

### 好的

*   通过抛出异常，类永远不会处于无效状态（业务逻辑除外，即死亡先于出生）
*   可以验证（比较）多个参数（因为在设置所有模型参数后进行业务验证）
*   可以返回多个错误（通过`errors()`方法）
*   验证分为两组：类型（模型类）和业务（验证类）
*   让 getter 和 setter 方法可用于其他任务

### 坏的

*   错误处理更复杂，有抛出异常（模型类）和错误数组（验证类）
*   稍微复杂一点，因为每个模型都需要两个类
*   开发者一定要记得使用验证类

```
class Person
{
    public $name;
    public $birth_date;
    public $death_date;

    private function validate_name()
    {
        if (!is_string($this->person->name))
        {
            $this->errors['name'] = 'Not a string.';
        }
    }

    private function validate_birth_date()
    {
        if (!is_string($this->person->birth_date))
        {
            $this->errors['birth_date'] = 'Not a string.';
            break;
        }

        if (!preg_match('/(\d{4})-([01]\d)-([0-3]\d)/', $this->person->birth_date))
        {
            $this->errors['birth_date'] = 'Not a valid date.';          
        }
    }

    private function validate_death_date()
    {
        if (!is_string($this->person->death_date))
        {
            $this->errors['death_date'] = 'Not a string.';
            break;
        }

        if (!preg_match('/(\d{4})-([01]\d)-([0-3]\d)/', $this->person->death_date))
        {
            $this->errors['death_date'] = 'Not a valid date.';
        }
    }
} 
```

```
class Person_Validator
{
    private $person;
    private $errors = array();

    public function __construct(Person $person)
    {
        $this->person = $person;
    }

    public function errors()
    {
        return $this->errors;
    }

    public function is_valid()
    {
        $this->validate_death_date();

        return count($this->errors) === 0;
    }

    private function validate_death_date()
    {
        if ($this->person->death_date < $this->person->birth_date)
        {
            $this->errors['death_date'] = 'Death cannot occur before birth';
        }
    }
} 
```

```
// Usage:

try
{
    $person = new Person();
    $person->set_name('John');
    $person->set_birth_date('1930-01-01');
    $person->set_death_date('2010-06-06');

    $validator = new Person_Validator($person);

    if (!$validator->is_valid())
    {
        // Handle errors with $validator->errors()
    }
}
catch (Exception $exception)
{
    // Handle error with $exception
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:02:23.443

我不认为只有一种最佳方法，这取决于您将如何使用您的课程。在这种情况下，当您只有一个简单的数据对象时，我更喜欢使用**方法 #2：使用模型类中的验证方法进行验证**。

在我看来，坏事并没有那么糟糕：

> 模型可能处于无效状态

有时希望能够使模型处于无效状态。

例如，如果您从 Web 表单填充 Person 对象并想要记录它。如果您使用第一种方法，则必须扩展 Person 类，覆盖所有设置器以捕获异常，然后您就可以使该对象处于无效状态以进行日志记录。

> 开发者一定要记得调用验证 is_valid() 方法

如果模型绝对不能处于无效状态，或者方法要求模型处于有效状态，您始终可以`is_valid()`从类中调用以确保它处于有效状态。

> 由于大量验证，模型类可能很长

验证码必须仍然在某个地方。大多数编辑器允许您折叠函数，这样在阅读代码时就不会出现问题。如果有的话，我认为将所有验证集中在一个地方很好。

# dropbox - Dropbox 文件唯一标识符 - RESTful API

> ID：15209512
> 
> 赞同：13
> 
> 时间：2013-03-04T19:29:32.567
> 
> 标签：dropbox, dropbox-api

是否有任何与 Dropbox 文件相关联的唯一标识符，该标识符不会随修订/更改/重命名而更改，可以通过 RESTful API 访问？我想将它存储在数据库中并跟踪文件上的一些操作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T16:20:42.307

不幸的是，不，Dropbox API 目前没有像这样公开任何类型的文件 ID 或哈希。

* * *

编辑：Dropbox API v2 现在确实提供了跨移动/重命名持续存在的文件 ID。[您可以在文档的](https://www.dropbox.com/developers/documentation/http/documentation#formats)“路径格式”下找到更多信息。

文件 ID 可用作对象`id`上的字段`FileMetadata`，例如，由[/files/get_metadata](https://www.dropbox.com/developers/documentation/http/documentation#files-get_metadata)返回。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-10-14T10:04:57.187

新的 Dropbox [API v2](https://www.dropbox.com/developers/documentation/http#documentation-files-get_metadata)支持文件和文件夹的 ID。

但是，它不会自动将文件/文件夹移动、重命名等与事件流中的删除和创建区分开来。您可以使用像[Kloudless](https://kloudless.com)这样的服务，它提供了一个统一的云存储 API，其中包括 Dropbox 的文件/文件夹 ID。Kloudless 还对[事件流](http://developers.kloudless.com/docs#events)进行规范化，并通过单个 API 提供对其他几个云存储服务的访问。（我在 Kloudless 工作）

# firefox - firefox no-cache 不兑现？

> ID：15209514
> 
> 赞同：2
> 
> 时间：2013-03-04T19:29:38.157
> 
> 标签：firefox, caching

如何强制 Firefox 不缓存响应？我们尝试过：

```
response.setHeader("Cache-Control", "no-cache, no-store, must-revalidate"); // HTTP 1.1.
response.setHeader("Pragma", "no-cache"); // HTTP 1.0.
response.setDateHeader("Expires", 0); // Proxies. 
```

但在 about:cache 我们仍然看到：

```
Cache entry information
key:    http://myhost.my.domain.com:42133/ducc-servlet/timestamp
fetch count:    4
last fetched:    2013-03-04 09:21:40
last modified:    2013-03-04 09:12:53
expires:    1969-12-31 19:00:00
Data size:    24
file on disk:    none
Security:    This document does not have any security info associated with it.
Client:    HTTP
request-method:    GET
response-head:    HTTP/1.1 200 OK Content-Type: text/html;charset=UTF-8 Cache-Control: no-cache, no-store, must-revalidate 
Date: Sun, 03 Mar 2013 14:12:57 GMT 
Expires: Sun, 03 Mar 2013 14:12:57 GMT 
Content-Length: 24 
Server: Jetty(7.4.4.v20110707)

00000000:  32  30  31  33  2e  30  33  2e  30  34  20  30  39  3a  31  32  2013.03.04 09:12
00000010:  3a  35  36  20  4d  6f  6e  0a                                  :56 Mon. 
```

谢谢。

娄。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T04:25:39.313

Firefox 将始终（除非空间不足）将数据存储在其缓存中，以便它可以通过从缓存中提取数据来执行查看源代码、另存为等操作。当然，如果数据设置为“无缓存”，它可能不会将其用于正常的页面加载。

如果数据是无存储的，它将按照请求将缓存条目放在内存中，而不是磁盘上。

# python - 如何在python中停止当前系统调用的执行

> ID：15209515
> 
> 赞同：1
> 
> 时间：2013-03-04T19:29:38.713
> 
> 标签：python, function, exit

从python我调用一个java函数：

```
os.system("java -jar example.jar run myFunction 'inFile.txt' 'outFile.txt' " ) 
```

这个函数正在处理一个文件，输出被写入'outFile.txt'。输出取决于“inFile.txt”中的信息。在处理输入文件并写入输出文件时，有时“outFile.txt”变得太大（几十 GB），那时，我想退出当前处理并继续处理另一个 inFile.txt

有没有办法知道我正在编写的 outFile.txt 已经增长到超过 10GB。

编辑：正如 Maksym 所建议的，我正在使用以下代码并且似乎正在工作。谢谢

```
import subprocess
from time import sleep
p = subprocess.Popen(["java", "-jar", "example.jar", "run", "myFunction", "'inFile.txt'", "'outFile.txt'")
rc = p.poll()  #returncode
while (rc == None):
    sleep(1)
    if(os.path.getsize(outFileName) < 1000000000):
        rc = p.poll()
        continue
     else:
        p.kill()
        break 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:50:04.247

看看[子流程](http://docs.python.org/2/library/subprocess.html)模块。使用*Popen*，您可以分叉一个进程并在需要时终止它：

```
import subprocess
from time import sleep
p = subprocess.Popen(["java", "-jar", "example.jar", "run", "myFunction", "'inFile.txt'", "'outFile.txt'")
while not check_my_conditions():
    sleep(my_timeout)
p.kill() 
```

然后，您可以旋转文件并重新启动该过程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T19:36:08.483

`os.system`您应该强烈考虑使用[multiprocessing.Process](http://docs.python.org/2/library/multiprocessing.html)内置类，而不是直接调用。它更优雅地处理生成的进程。

您需要定期查看输出文件，或者使用`os.stat`检查文件大小之类的方法。然后，您可以在超过阈值时终止原始进程（或任何您想做的事情）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T19:35:49.990

java 应用程序在运行时是否向 stdout 或 stderr 提供任何输出（例如，处理的记录数）？如果是这样，您可以使用 Python 的 Popen 类（在 subprocess 模块中）调用它，并估计它何时处理了“太多”。

# haskell - 应用函子更有趣

> ID：15209516
> 
> 赞同：19
> 
> 时间：2013-03-04T19:29:43.547
> 
> 标签：haskell, monads, applicative

[之前](https://stackoverflow.com/questions/15123552/translate-from-monad-to-applicative)我问过翻译一元代码以仅使用 Parsec 的应用函子实例。不幸的是，我收到了几个答复，这些答复回答了我真正提出的问题，但并没有真正给我太多的见解。所以让我再试一次......

总结我到目前为止的知识，应用函子比单子更受限制。在“少即是多”的传统中，限制代码可以做的事情增加了疯狂代码操作的可能性。无论如何，很多人似乎认为使用 applicative 代替 monad 是一个可能的更好的解决方案。

该类`Applicative`在 中定义`Control.Applicative`，其 Haddock 的列表有助于将类方法和实用程序函数与它们之间的大量类实例分开，从而难以同时快速查看屏幕上的所有内容。但是相关的类型签名是

```
pure ::    x              -> f x
<*>  :: f (x -> y) -> f x -> f y
 *>  :: f  x       -> f y -> f y
<*   :: f  x       -> f y -> f x
<$>  ::   (x -> y) -> f x -> f y
<$   ::    x       -> f y -> f x 
```

完全有道理，对吧？

嗯，`Functor`已经给我们了`fmap`，基本上就是`<$>`。即，给定一个函数 from `x`to `y`，我们可以将 an 映射`f x`到 an `f y`。`Applicative`添加了两个本质上新的元素。一个是，它与（以及各种范畴论类中的其他几个运算符）`pure`具有大致相同的类型。`return`另一个是`<*>`，它使我们能够获取一个函数容器和一个输入容器，并产生一个输出容器。

使用上面的运算符，我们可以非常巧妙地做一些事情，比如

```
foo <$> abc <*> def <*> ghi 
```

这允许我们采用 N 元函数并从 N 个函子中获取其参数，这种方式很容易推广到任何 N。

* * *

这点我已经明白了。有两件主要的事情我*还不*明白。

首先，`*>`函数`<*`和`<$`。从它们的类型来看`<* = const`，`*> = flip const`、 和`<$`可能是相似的。大概这并*没有*描述这些功能实际上做了什么。（？？！）

其次，在编写 Parsec 解析器时，每个可解析实体通常最终看起来像这样：

```
entity = do
  var1 <- parser1
  var2 <- parser2
  var3 <- parser3
  ...
  return $ foo var1 var2 var3... 
```

由于应用函子不允许我们以这种方式将中间结果绑定到变量，我对如何为最后阶段收集它们感到困惑。为了理解如何做到这一点，我一直无法完全围绕这个想法。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-03-04T19:52:49.823

和函数非常简单：它们的工作方式`<*`与. 的工作方式与except不存在相同。基本上，给定，您首先“做” ，然后“做”并返回. 对于，您仍然先“做” ，然后“做” ，但您返回 的结果。（当然，对于“do”的适当含义。）`*>``>>``<*``<<``<<``a *> b``a``b``b``a <* b``a``b``a`

功能`<$`只是. `fmap const`所以`a <$ b`等于`fmap (const a) b`。您只需丢弃“动作”的结果并返回一个常量值。具有类型的`Control.Monad`函数可以写成。`void``Functor f => f a -> f ()``() <$`

这三个函数不是应用函子定义的基础。( `<$`, 事实上, 适用于任何函子。) 这又一次, 就像`>>`单子一样。我相信他们在课堂上可以更轻松地针对特定实例优化它们。

当您使用应用函子时，您不会从函子中“提取”值。在 monad 中，这是做什么`>>=`的，也是`foo <- ...`去糖的。相反，您将包装的值直接使用`<$>`and传递给函数`<*>`。因此，您可以将示例重写为：

```
foo <$> parser1 <*> parser2 <*> parser3 ... 
```

如果你想要中间变量，你可以只使用一个`let`语句：

```
let var1 = parser1
    var2 = parser2
    var3 = parser3 in
foo <$> var1 <*> var2 <*> var3 
```

正如您正确推测的那样，`pure`它只是`return`. 因此，为了使共享结构更加明显，我们可以将其重写为：

```
pure foo <*> parser1 <*> parser2 <*> parser3 
```

我希望这可以澄清事情。

现在只是一个小提示。人们*确实*建议使用应用函子函数进行解析。但是，只有在它们更有意义时才应该使用它们！对于足够复杂的事情，monad 版本（尤其是 do-notation）实际上可以更清晰。人们推荐这个的原因是

```
foo <$> parser1 <*> parser2 <*> parser3 
```

比

```
do var1 <- parser1
   var2 <- parser2
   var3 <- parser3
   return $ foo var1 var2 var3 
```

本质上，`f <$> a <*> b <*> c`它本质上就像提升功能的应用程序。您可以想象它`<*>`是一个空间（例如功能应用程序）的替代品，其方式与`fmap`功能应用程序的替代品相同。这也应该让您直观地了解我们为什么使用`<$>`- 它就像`$`.

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-03-04T21:10:09.543

可以在这里说几句，希望对大家有帮助。这反映了我的理解，这本身可能是错误的。

`pure`被异常命名。通常函数的命名是指它们产生的东西，但`pure x`它`x`是*纯*的。`pure x`产生一个“携带” pure 的应用函子`x`。“携带”当然是近似的。一个例子：`pure 1 :: ZipList Int`是一个`ZipList`，带有一个纯`Int`值，`1`。

`<*>`,`*>`和`<*`不是**函数，而是方法**（这回答了您的第一个问题）。`f`它们的类型不是一般的（就像函数一样），而是具体的，由特定实例指定。这就是为什么它们**确实**不只是`$`和。专门的类型指定*了组合的语义*。在通常的应用风格编程中，组合意味着应用。但是对于函子，存在一个额外的维度，由“载体”类型表示。在中，有一个“内容”，，但也有一个“上下文”，。`flip const``const``f`*`f``f x``x``f`*

 *“applicative functors”风格试图启用“applicative style”编程，具有效果。由函子、载体、上下文提供者代表的效果；“applicative”指的是函数式应用的正常应用风格。**写作只是`f x`为了表示应用**曾经*是一个革命性的想法*。不再需要额外的语法，没有`(funcall f x)`，没有`CALL`语句，这些额外的东西都没有 -*组合*是*应用程序*......不是这样，*似乎*有效果 - 当使用效果进行编程时，再次需要*特殊*语法。被杀的野兽再次出现。

因此，[带有效果的应用程序编程](http://www.soi.city.ac.uk/~ross/papers/Applicative.html)再次使组合意味着只是应用程序——在特殊的（也许是有效的）*上下文中*，如果它们确实*在*这样的上下文中。因此，对于`a :: f (t -> r)`and `b :: f t`，*（几乎简单的）*组合`a <*> b`是**在给定上下文**（类型）**中承载内容**（或类型`t -> r`and `t`）的应用。**`f`**

 **与 monad 的主要区别在于，**monad 是非线性的**。在

```
do {  x        <-  a
   ;     y     <-  b x
   ;        z  <-  c x y
   ;               return 
     (x, y, z) } 
```

计算`b x`取决于`x`，并且`c x y`取决于`x`和`y`。函数是*嵌套*的：

```
a >>= (\x ->  b x  >>= (\y ->  c x y  >>= (\z ->  .... ))) 
```

如果`b`并且`c`不*依赖*于先前的结果（`x`, `y`），则可以通过使*计算*阶段返回**重新打包的复合数据**来实现这一点（这解决了您的第二个问题）：

```
a  >>= (\x       ->  b  >>= (\y-> return (x,y)))       -- `b  ` sic
   >>= (\(x,y)   ->  c  >>= (\z-> return (x,y,z)))     -- `c  `
   >>= (\(x,y,z) ->  ..... ) 
```

这本质上是一种应用风格（`b`,`c`是预先完全知道的，独立于`x`产生的值`a`等）。因此，当您的组合创建包含进一步组合所需的所有信息的数据时，*并且不需要“外部变量”*（即所有计算都已经完全已知，独立于任何先前阶段产生的任何值），您可以使用这种风格的组合。

但是，如果您的单子链具有依赖于此类“外部”变量的值的**分支**（即单子计算的前一阶段的结果），那么您无法从中创建线性链。那么它*本质上是*一元的。

* * *

作为说明，该论文中的第一个示例显示了“monadic”函数

```
sequence :: [IO a] → IO [a]
sequence [ ] = return [ ]
sequence (c : cs) = do
  {  x       <-  c
  ;      xs  <-  sequence cs  -- `sequence cs` fully known, independent of `x`
  ;              return 
    (x : xs) } 
```

实际上可以用这种“扁平、线性”的方式编码为

```
sequence :: (Applicative f) => [f a] -> f [a]
sequence []       = pure []
sequence (c : cs) = pure (:) <*> c <*> sequence cs
                  --     (:)     x     xs 
```

这里没有用 monad 对先前结果进行分支的能力。

* * *

关于出色[的 Petr Pudlák 答案](https://stackoverflow.com/a/15211856/849891)的注释：在我的“术语”中，他`pair`是无*应用的**组合*。它表明 Applictive Functor 添加到普通 Functor 的本质是组合的能力。应用则由好老实现。这表明*组合仿函数*可能是一个更好的名称（*更新：*事实上，“Monoidal Functors”就是这个名称）。*`fmap`*

 **** * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-03-04T21:53:02.063

您可以这样查看函子、应用程序和单子：它们都带有一种“效果”和一种“值”。（请注意，术语“效果”和“价值”只是近似值 - 实际上不需要任何副作用或值 - 就像 in`Identity`或`Const`。）

*   你可以在`Functor`using 中修改可能的值`fmap`，但你不能对里面的效果做任何事情。
*   使用`Applicative`，您可以创建一个没有任何效果的值，`pure`您可以对效果进行排序并在其中组合它们的值。但是效果和值是分开的：在排序效果时，效果不能依赖于前一个效果的值。这反映在`<*`,`<*>`和`*>`: 它们对效果进行排序并组合它们的值，但是您不能以任何方式检查其中的值。

    您可以`Applicative`使用这组替代函数进行定义：

    ```
    fmap     :: (a -> b) -> (f a -> f b)
    pureUnit :: f ()
    pair     :: f a -> f b -> f (a, b)
    -- or even with a more suggestive type  (f a, f b) -> f (a, b) 
    ```

    （其中`pureUnit`不产生任何影响）并定义`pure`它们`<*>`（反之亦然）。这里`pair`对两个效果进行排序并记住它们的值。`Applicative`这个定义表达了一个*单曲面函子*的事实。

    `pair`现在考虑一个由、`fmap`和`pureUnit`一些原始应用值组成的任意（有限）表达式。我们有几个可以使用的规则：

    ```
    fmap f . fmap g           ==>     fmap (f . g)
    pair (fmap f x) y         ==>     fmap (\(a,b) -> (f a, b)) (pair x y)
    pair x (fmap f y)         ==>     -- similar
    pair pureUnit y           ==>     fmap (\b -> ((), b)) y
    pair x pureUnit           ==>     -- similar
    pair (pair x y) z         ==>     pair x (pair y z) 
    ```

    使用这些规则，我们可以对 s 重新排序，将s 向外`pair`推，并消除s，因此最终可以将这样的表达式转换为`fmap``pureUnit`

    ```
    fmap pureFunction (x1 `pair` x2 `pair` ... `pair` xn) 
    ```

    或者

    ```
    fmap pureFunction pureUnit 
    ```

    因此，确实，我们可以首先使用将所有效果收集在一起`pair`，然后使用纯函数在内部修改结果值。

*   使用`Monad`，效果可以取决于先前的单子值的值。这使他们如此强大。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-03-05T12:27:30.223

已经给出的答案非常好，但有一点我想明确说明，它与`<*`,`<$`和`*>`.

其中一个例子是

```
do var1 <- parser1
   var2 <- parser2
   var3 <- parser3
   return $ foo var1 var2 var3 
```

也可以写成`foo <$> parser1 <*> parser2 <*> parser3`。

假设 的值与- 例如它只是一些分隔空格`var2`无关。那么接受这个空格只是忽略它`foo`也是没有意义的。`foo`在这种情况下`foo`应该有两个参数，而不是三个。使用`do`-notation，您可以将其写为：

```
do var1 <- parser1
   parser2
   var3 <- parser3
   return $ foo var1 var3 
```

如果您只想使用它来编写它`<$>`，`<*>`它应该类似于以下等效表达式之一：

```
(\x _ z -> foo x z) <$> parser1 <*> parser2 <*> parser3
(\x _ -> foo x) <$> parser1 <*> parser2 <*> parser3
(\x -> const (foo x)) <$> parser1 <*> parser2 <*> parser3
(const  . foo) <$> parser1 <*> parser2 <*> parser3 
```

但这有点棘手，要正确处理更多的论点！

但是，您也可以编写`foo <$> parser1 <* parser2 <*> parser3`. 您可以调用以and`foo`为结果的语义函数，同时忽略两者之间的结果。没有的意思是表示忽略。`parser1``parser3``parser2``>`

如果您想忽略的结果`parser1`但使用其他两个结果，您可以类似地编写`foo <$ parser1 <*> parser2 <*> parser3`，使用`<$`而不是`<$>`。

我从来没有发现 ; 有太多用处`*>`，我通常会`id <$ p1 <*> p2`为忽略结果的解析器`p1`编写`p2`; 你可以这样写，`p1 *> p2`但这会增加代码读者的认知负担。

我已经为解析器学习了这种思维方式，但后来它被推广到`Applicative`s; 但我认为这个符号来自[uuparsing 库](http://hackage.haskell.org/packages/archive/uu-parsinglib/2.0.0/doc/html/Text-ParserCombinators-UU-Parsing.html)；至少我 10 多年前在 Utrecht 使用过它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-03-05T20:56:13.637

我想在非常有用的现有答案中添加/改写几件事：

应用程序是“静态的”。中`pure f <*> a <*> b`，`b`不依赖`a`，所以可以[静态分析](https://stackoverflow.com/a/7863380)。[这就是我在对您之前的问题的回答](https://stackoverflow.com/questions/15123552/translate-from-monad-to-applicative/15159650#15159650)中试图展示的内容（但我想我失败了——抱歉）——因为实际上没有解析器的顺序依赖，所以不需要 monad。

monad 带来的主要区别是`(>>=) :: Monad m => m a -> (a -> m b) -> m a`，或者，`join :: Monad m => m (m a)`。请注意，只要您有`x <- y`内部`do`符号，您就在使用`>>=`. 这些说单子允许您使用单子“内部”的值来“动态地”生成新的单子。这不能通过 Applicative 完成。例子：

```
-- parse two in a row of the same character
char             >>= \c1 ->
char             >>= \c2 ->
guard (c1 == c2) >>
return c1

-- parse a digit followed by a number of chars equal to that digit
--   assuming: 1) `digit`s value is an Int,
--             2) there's a `manyN` combinator
-- examples:  "3abcdef"  -> Just {rest: "def", chars: "abc"}
--            "14abcdef" -> Nothing
digit        >>= \d -> 
manyN d char 
-- note how the value from the first parser is pumped into 
--   creating the second parser

-- creating 'half' of a cartesian product
[1 .. 10] >>= \x ->
[1 .. x]  >>= \y ->
return (x, y) 
```

最后，Applicatives 启用了 @WillNess 提到的提升功能应用程序。要尝试了解“中间”结果是什么样的，您可以查看普通函数应用程序和提升函数应用程序之间的相似之处。假设`add2 = (+) :: Int -> Int -> Int`：

```
-- normal function application
add2 :: Int -> Int -> Int
add2 3 :: Int -> Int
(add2 3) 4 :: Int

-- lifted function application
pure add2 :: [] (Int -> Int -> Int)
pure add2 <*> pure 3 :: [] (Int -> Int)
pure add2 <*> pure 3 <*> pure 4 :: [] Int

-- more useful example
[(+1), (*2)]
[(+1), (*2)] <*> [1 .. 5]
[(+1), (*2)] <*> [1 .. 5] <*> [3 .. 8] 
```

不幸的是，您无法有意义地打印结果，`pure add2 <*> pure 3`原因与您无法`add2`...令人沮丧的原因相同。您可能还想查看[`Identity`](http://hackage.haskell.org/packages/archive/transformers/latest/doc/html/src/Data-Functor-Identity.html#Identity)及其类型类实例以了解 Applicatives。******

# macos - Apple Sandbox 拒绝在低级别调用中访问公共数据

> ID：15209520
> 
> 赞同：2
> 
> 时间：2013-03-04T19:30:03.267
> 
> 标签：macos, cocoa, sandbox, monomac

由于某种原因，Lion 上的沙箱导致我的应用程序在调用`getprotobyname`应该可用的调用时崩溃，因为它只读取 OSX 本身提供的静态数据。

这是Lion上的某种错误吗？沙盒是否有理由禁止这样做？似乎是一种非常常见的调用方法。

```
OfficeDrop Sync(1568) deny file-read-data /private/etc/protocols

Process:         OfficeDrop Sync [1568]
Path:            /Users/some-user/Downloads/OfficeDrop Sync.app/Contents/MacOS/OfficeDrop Sync
Load Address:    0x1000
Identifier:      OfficeDrop Sync
Version:         ??? (???)
Code Type:       X86 (Native)
Parent Process:  launchd [125]

Date/Time:       2013-03-04 14:02:50.897 -0500
OS Version:      Mac OS X 10.7.5 (11G63)
Report Version:  7

Backtrace:
0   libsystem_kernel.dylib            0x9c7e771e __open_nocancel + 10
1   libsystem_c.dylib                 0x96d6edc3 fopen$UNIX2003 + 90
2   libsystem_info.dylib              0x91352b4d _fsi_get_name_number_aliases + 123
3   libsystem_info.dylib              0x91351c2d file_protocol_byname + 44
4   libsystem_info.dylib              0x9135c0e8 search_protocol_byname + 69
5   libsystem_info.dylib              0x91357921 getprotobyname + 59
6   OfficeDrop Sync                   0x001b26c4 ves_icall_System_Net_Sockets_Socket_SetSocketOption_internal + 100
7                                     0x0654336c
8                                     0x065432b0
9                                     0x06545304
10                                    0x065426a4
11                                    0x0654212c
12                                    0x06540f8c
13                                    0x006b6cad
14  OfficeDrop Sync                   0x0000f894 mono_jit_runtime_invoke + 164
15  OfficeDrop Sync                   0x00184ed4 mono_runtime_invoke + 68
16  OfficeDrop Sync                   0x001851af mono_runtime_delegate_invoke + 63
17  OfficeDrop Sync                   0x001b8f3f async_invoke_thread + 2799
18  OfficeDrop Sync                   0x001be46c start_wrapper + 348
19  OfficeDrop Sync                   0x001f060a thread_start_routine + 154
20  OfficeDrop Sync                   0x00217cf4 GC_start_routine + 100
21  libsystem_c.dylib                 0x96daced9 _pthread_start + 335
22  libsystem_c.dylib                 0x96db06de thread_start + 34

Binary Images:
    0x1000 -   0x2bfff5 +com.officedrop.Sync.Mac (2.0.1 - 2.0.1) <943CAD79-B30C-3D5C-97EF-E2454D2FE6FC> /Users/some-user/Downloads/OfficeDrop Sync.app/Contents/MacOS/OfficeDrop Sync
0x91344000 - 0x91373ff7  libsystem_info.dylib (??? - ???) <37640811-445B-3BB7-9934-A7C99848250D> /usr/lib/system/libsystem_info.dylib
0x96d50000 - 0x96e1bfff  libsystem_c.dylib (763.13.0 - compatibility 1.0.0) <52421B00-79C8-3727-94DE-62F6820B9C31> /usr/lib/system/libsystem_c.dylib
0x9c7cf000 - 0x9c7edff7  libsystem_kernel.dylib (1699.32.7 - compatibility 1.0.0) <79179F83-457A-3539-A76B-E960D2108109> /usr/lib/system/libsystem_kernel.dylib 
```

# ipython - 默认将 IPython 配置为交互模式

> ID：15209530
> 
> 赞同：1
> 
> 时间：2013-03-04T19:30:30.543
> 
> 标签：ipython

我试图阅读 IPython 0.13 文档，但我一直无法弄清楚如何让 IPython 默认为交互模式。

回到 IPython 0.10，我可以输入：

```
ipython <some_script.py> 
```

并且脚本将运行并将我放到交互式提示中。

今天，使用 0.13，我必须添加`-i`命令行选项：

```
ipython -i <some_script.py> 
```

有人可以分享运行脚本后使 IPython 0.13 直接进入交互模式的 ipython 配置文件选项吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T04:15:24.140

1.  首先创建默认的 IPython 配置文件，如果你还没有

    > ipython 配置文件创建

2.  将此行添加到 profile_default/ipython_config.py （你可以找到 profile_default `ipython locate profile`）

    > c.TerminalIPythonApp.force_interact = True

这是`-i`在命令行设置的值。使用此配置，就好像您总是键入`ipython -i`.

# c++ - 如何终止从套接字 C++ 读取的线程？

> ID：15209531
> 
> 赞同：0
> 
> 时间：2013-03-04T19:30:31.037
> 
> 标签：c++, multithreading, sockets

在 C++ 中，“recvfrom”函数是一个阻塞函数（阻塞线程直到数据包到达）。

如何安全地终止在“recvfrom”中阻塞的线程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:38:05.127

`recvfrom`只有在 select/poll/epoll 成功返回后才调用来避免这种情况。

就像评论中提到的@Remy Lebeau 一样，您可以提取如下内容：

```
while(run_flag) {
    if(check select/poll/epoll) {
         recvfrom(..)
    }
} 
```

您可以在此处开始使用[epoll](http://en.wikipedia.org/wiki/Epoll)和[select](http://en.wikipedia.org/wiki/Select_%28Unix%29)。互联网上也有很多。

另一种方法是使用异步网络操作而不是线程。

我也可能会推荐使用[boost::asio](http://www.boost.org/doc/libs/1_52_0/doc/html/boost_asio.html)，因为这将只是你所有的网络东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T22:22:51.707

使用“自我管道”技巧。

使用 pipe(2) 系统调用打开管道。使用 select/poll/kqueue/从您关心的套接字和管道读取的任何内容坐在一个循环中。当您从套接字获取数据时，请像往常一样处理它。

要停止线程，请关闭要停止处理的线程中管道的另一端。您将在管道上将其检测为 EOF，然后您可以将其用作停止线程处理真实套接字的信号。

# c# - Toast 通知，当应用程序未运行时

> ID：15209535
> 
> 赞同：2
> 
> 时间：2013-03-04T19:30:40.830
> 
> 标签：c#, .net, push-notification, windows-phone, mpns

我在 Windows Phone 8 上编写带有推送通知服务的应用程序（仅 toast），我还没有将推送发送到我的移动应用程序的 MSSQL 作业。发送数据具有以下格式（*typeId*是 int，它告诉应用程序应该如何处理*数据*）：

```
<?xml version=\"1.0\" encoding=\"utf-8\"?>
<wp:Notification xmlns:wp=\"WPNotification\">
<wp:Toast>
<wp:Text1>title</wp:Text1>
<wp:Text2>subtitle</wp:Text2>
<wp:Data>typeId;data</wp:Data>
</wp:Toast>
</wp:Notification> 
```

当我运行应用程序时推送收入时，我可以通过方法为我的应用程序提供服务（这种情况下工作正常）

```
httpChannel.ShellToastNotificationReceived += 
    new EventHandler<NotificationEventArgs>(httpChannel_ShellToastNotificationReceived);

httpChannel.BindToShellToast(); 
```

当应用程序未运行时，我的问题是无法为 toast 推送通知提供服务。使用来自 XML 的文本推送收入，但是当我单击通知时，我进入了我的应用程序的主页。如何附加我的代码来决定通过*typeId*和XML中的*数据做什么*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T09:21:56.450

我找到解决方案：XML 应该包含

```
<wp:Param></wp:Param> 
```

节内`<wp:Toast>`节。在行中，我可以使用查询字符串放置查看地址。单击通知栏后，我将重定向到此视图。查询字符串中的参数将决定（在 NavigateTo 事件中）程序必须做什么 :)

# jquery - Backbone.js jQuery 渲染时间问题

> ID：15209536
> 
> 赞同：1
> 
> 时间：2013-03-04T19:30:40.927
> 
> 标签：jquery, backbone.js, underscore.js

我有一个我已经开发了一段时间的应用程序现在总是在本地机器上。我现在将它放入服务器环境中，并且在将模板插入主干视图时，我认为这些问题与 jQuery 的 .html() 函数的时间有关。

关于代码（重要部分）：

**应用程序.js**

```
define(["models/mapModel",
        "views/base/mapView"],function(MapModel, MapView){
    var initialize = function(){

    // Set up the application here
    var mapModel, mapView;

    dojo.ready(function(){

        mapModel = new MapModel();

        mapView = new MapView({
            model : mapModel
        });

        $("#appRoot").html(mapView.render().el);

    });
  };

  return {
    initialize: initialize
  };
}); 
```

**视图模板.html**

```
<div id="map">map goes here</div> 
```

**地图视图.js**

```
 // 'viewTemplate' is being retrieved with dojo's define() method,
   // this is not the issue as it is working in many other places.

   initialize : function(){
        var selectFeature = lang.hitch(this, this.getFeature);
        topic.subscribe("selectFeature", selectFeature);
    },
    render : function(){
        var tmpl = _.template(viewTemplate);
        this.$el.html(tmpl());
        this.model.on("change:map", this.createLocator, this);

        //Create the map once everything is drawn
        $(document).ready($.proxy(
            function() {
                this.createMap();
            },
        this));

        return this;
    },
    createMap : function(){
        console.log($('#appRoot').length); // returns 1
        console.log($('#map').length);     // returns 0
    } 
```

CreateMap 函数中的两行说明了我的问题。#appRoot 是在 index.html 中静态定义的，而 #map 是由 jQuery 的 .html() 函数在渲染中插入的。似乎在 CreateMap() 触发时没有插入 #map 元素。同样，这只发生在从 localhost 以外的机器上访问应用程序时。

谢谢太平绅士

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:42:00.843

试试`this.$('#map').length`。

`$('#map').length`不起作用，因为`#map`尚未添加到页面中，因为您在添加之前调用了渲染。

`$("#appRoot").html(mapView.render().el);`// 渲染视图，然后添加到页面。

下面的代码也可以修复它，但`this.$`无论如何使用会更好。

```
$("#appRoot").html(mapView.el); // add to page
mapView.render(); // render 
```

# vb.net - 复制/粘贴后更改的控件名称

> ID：15209538
> 
> 赞同：0
> 
> 时间：2013-03-04T19:30:43.593
> 
> 标签：vb.net, copy, controls, paste

我在选项卡中有控件，然后决定在该当前选项卡上添加另一个选项卡控件。

因此，我复制了第一个选项卡中的所有控件以将它们放入嵌套选项卡中。现在我的按钮不再是：

```
Private Sub Quit_Button_Click(sender As System.Object, e As System.EventArgs) Handles 
```

到

```
Private Sub Quit_Button_Click_1(sender As System.Object, e As System.EventArgs) Handles 
```

我在该选项卡上有大量控件，因此它们都不起作用……它们的所有名称也保持不变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:38:29.160

我假设您使用的是 MS Visual Studio，它将使用您注意到的约定重命名控件和方法。当然，如果您使用 GUI 设计器复制/粘贴控件。

为什么不进入代码（在表单中查找 InitializeComponent 方法）并更改包含您希望位于不同选项卡上的控件的“父”控件？

例如，从以下代码段开始：

```
Me.TabControl1 = New System.Windows.Forms.TabControl()
Me.TabPage1 = New System.Windows.Forms.TabPage()
Me.TabPage2 = New System.Windows.Forms.TabPage()
Me.MyButton = New System.Windows.Forms.Button()
Me.TabPage1.Controls.Add(Me.MyButton) 
```

将最后一行更改为：

```
Me.TabPage2.Controls.Add(Me.MyButton) 
```

...并且您的按钮（及其相关的事件处理方法等）现在将包含在第二个选项卡中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T19:55:18.483

在复制/粘贴期间，我的代码被转换为：

```
Private Sub btnAddNote_Click(sender As System.Object, e As System.EventArgs) 
```

代替：

```
Private Sub btnAddNote_Click(sender As System.Object, e As System.EventArgs) Handles btnAddNote.Click 
```

我只是错过了句柄和事件......由于某种原因，当我们复制和粘贴时它会删除它。

# php - PHP字符串偏移量？在执行许多 substr 时使用像缓冲区这样的变量太慢了？

> ID：15209541
> 
> 赞同：0
> 
> 时间：2013-03-04T19:30:48.733
> 
> 标签：php, pointers, substr

我有一个需要由 PHP 解释的缓冲区，但是随后在缓冲区上使用许多 substr 被证明是非常慢且 CPU 密集型的，可能是因为 substr 创建了子字符串的新副本。

我需要通过以下方式在缓冲区中前进：

移动 X 的偏移量（可变字节数）。或从头开始删除 X 个字节

PHP中是否有任何容器可以让我做这样的事情？

示例（伪代码）

```
while( !done )
{
   $itemSize = unpack( ?, $buffer );
   $item = substr($buffer, $itemSize );
   $done = doSomething( $item );
   $buffer = $item;
} 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:41:55.877

在字节级别上工作实际上并不是 PHP 的目的。PHP 管理内存的方式比你想象的要复杂得多。它适用于大量参考资料，即使您不使用`&`.

我非常怀疑这种缓慢来自于做很多事情`substr`，我非常怀疑使用 PHP 在字节级别管理内存会对此有所帮助。

# java - 使用 JSTL 迭代 HashSet

> ID：15209548
> 
> 赞同：3
> 
> 时间：2013-03-04T19:31:08.243
> 
> 标签：java, javascript, jstl, jsp-tags

我有一组对象。我想从集合中迭代这些对象以使用 JSTL 在 jsp 上显示它。它正在使用 List，但我需要使用 Set。

是否可以使用 jstl 迭代一个集合？

```
<c:forEach items="${pitches}" var="pitch" /> 
```

在上面：pitch有一组对象说`Set<employee>`......

我怎样才能在球场内迭代这个员工集？？？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T19:32:58.730

是`<c:forEach>`的适用于所有 Iterable 所以 Set 应该是好的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T19:34:02.280

JSTL 标签[`<c:forEach>`](http://docs.oracle.com/javaee/5/jstl/1.1/docs/tlddocs/c/forEach.html)适用于任何`Collection`实现

**来自文档：**

> 基本的迭代标签，接受许多不同的集合类型并支持子集和其他功能

# python - 列表中的 Python 函数

> ID：15209552
> 
> 赞同：10
> 
> 时间：2013-03-04T19:31:23.430
> 
> 标签：python, list, functional-programming

所以今天在计算机科学中，我询问了使用函数作为变量的问题。例如，我可以创建一个函数，例如`returnMe(i)`并创建一个用于调用它的数组。就像`h = [help,returnMe]`然后我可以说 h1 它会调用`returnMe("Bob")`. 对不起，我对此有点兴奋。我的问题是有没有办法调用like`h.append(def function)`并定义一个只存在于数组中的函数？

编辑：

这是我用这个写的一些代码！所以我刚刚用这个解决方案完成了一个很棒的 FizzBu​​zz 再次非常感谢你！以该代码为例：

```
funct = []
s = ""

def newFunct(str, num):
    return (lambda x: str if(x%num==0) else "")

funct.append(newFunct("Fizz",3))
funct.append(newFunct("Buzz",5))

for x in range(1,101):
    for oper in funct:
        s += oper(x)
    s += ":"+str(x)+"\n"

print s 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-04T19:32:04.230

`lambda`您可以使用关键字创建匿名函数。

```
def func(x,keyword='bar'):
    return (x,keyword) 
```

大致相当于：

```
func = lambda x,keyword='bar':(x,keyword) 
```

所以，如果你想创建一个包含函数的列表：

```
my_list = [lambda x:x**2,lambda x:x**3]
print my_list[0](2)  #4
print my_list[1](2)  #8 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-04T19:34:43.970

不是真的在 Python 中。正如 mgilson 所示，您可以使用普通函数执行此操作，但它们只能包含表达式，而不是语句，因此非常有限（例如，您不能分配给变量）。

当然，其他语言也支持这一点：例如，在 Javascript 中，创建大量匿名函数并传递它们是一件非常惯用的事情。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-04T19:40:25.297

您可以在原始范围内创建函数，将它们分配给数组，然后将它们从原始范围中删除。因此，您确实可以从数组中调用它们，但不能作为局部变量。我不确定这是否符合您的要求。

```
#! /usr/bin/python3.2

def a (x): print (x * 2)
def b (x): print (x ** 2)

l = [a, b]

del a
del b

l [0] (3) #works
l [1] (3) #works
a (3) #fails epicly 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-04T19:55:58.803

您可以创建一个`lambda`函数列表，以按从 0 到 9 的每个数字递增，如下所示：

```
increment = [(lambda arg: (lambda x: arg + x))(i) for i in range(10)]
increment[0](1) #returns 1
increment[9](10) #returns 19 
```

边注：

我认为同样重要的是要注意这个（函数指针不是 lambdas）有点像 python 在大多数类中保存方法的方式，除了它不是一个列表，它是一个函数名称指向函数的字典。在许多但并非所有情况下`instance.func(args)`，等于`instance.__dict__['func'](args)`或`type(class).__dict__['func'](args)`

# regex - Eclipse 文件搜索 - 如何搜索特定字符串

> ID：15209556
> 
> 赞同：1
> 
> 时间：2013-03-04T19:31:32.123
> 
> 标签：regex, eclipse, search

在`Eclipse`中，使用该`File Search`功能，我试图在一个大包上进行文件搜索，以查找包含and`<button`但**不**包含.`class="someclass"` **`type="button"`**

 **在更一般的意义上，我如何搜索一些文本，同时排除它们包含另一位文本的结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:33:41.470

`CTRL + H`然后选择*File Search*，在那里你可以检查*正则表达式*选项。

为了得到你想要的，你可以尝试输入如下内容：

**^(?!.*type="按钮")。*类=“某类”。*$**

[您可以在此页面](http://www.eclipse.org/tptp/home/downloads/installguide/gla_42/ref/rregexp.html)获得更多关于 Eclipse 文件搜索的常规正则表达式信息。**

# maven - Nexus maven 存储库管理器之上的搜索引擎

> ID：15209557
> 
> 赞同：0
> 
> 时间：2013-03-04T19:31:37.537
> 
> 标签：maven, search, repository, nexus

我们使用 Nexus 作为我们的 maven 存储库管理器，虽然它确实具有内置的搜索/浏览功能，但使用起来可能有点笨拙。有没有办法将外部搜索引擎放在 Nexus 存储库之上，例如 maven 中央存储库使用的那个（[http://search.maven.org/](http://search.maven.org/)），这样搜索/浏览会更容易一些？或者那只是 Maven 中央仓库的自定义搜索引擎？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:54:04.047

对 Central 的搜索是自定义的。您在 Nexus 中的搜索有什么问题？

在极端情况下，您可以在自定义 Nexus 插件中实现自己的索引器并扩展搜索以使用它。

或者，如果您真的想创建自己的用户界面，您可以通过 REST API 从 Nexus 访问所有信息并编写自己的搜索应用程序。

# jquery - 无法打印从 Servlet 的 jQuery Ajax 调用中获取的值

> ID：15209558
> 
> 赞同：0
> 
> 时间：2013-03-04T19:31:40.923
> 
> 标签：jquery

我试图简单地打印从 Servlet 响应中获得的值。

```
 <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script src="http://code.jquery.com/jquery-latest.min.js"></script>
   <script>
      $(document).ready(function() {
             $('#Identify').click(function() {

                 var numberList = document.getElementById("inputString");
                 var kth = document.getElementById("nthHighest");
                 dataString = "inputString=" + numberList.value + "&nthHighest="+kth.value;
                 $.ajax({
                     url : "/HelloHalozen/HighestNumber",
                     data : dataString,
                     type : "POST",
                     dataType : "text",
                     success : function( responseText ) {
                         //$('#result').text(responseText);
                         $("#result").append(responseText);
                     },
                     error : function( xhr, status ) {
                           alert("Sorry, there was a problem!");
                     },
                     complete : function( xhr, status ) {
                          alert("The request is complete!");
                     }
                   });
               });
         });
      </script>`

 <button id="Identify">Identify</button> 
 <div id="result"></div> 
```

`

从我的 servlet 我执行以下操作： `response.getWriter().write("You have successfully made Ajax Call..." );`

在 Firebug 中，我可以看到我从 Servlet 得到的响应是“您已成功进行 Ajax 调用...”但我没有看到该消息按我的预期打印在页面上：
`$("#result").append(responseText);`。

你能帮我么。我是 Ajax 和 jQuery 的新手。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-13T16:48:21.230

**尝试关闭服务器上的 PrintWriter。也许这会有所帮助。**

下面的代码可能会有所启发

```
String answer = "You have successfully made Ajax Call...";
response.setContentType("text/plain");
PrintWriter out = response.getWriter();
out.print(answer); 
out.close(); 
```

也许来自服务器端和客户端的完整源代码可能有助于理解您的问题。

# batch-file - 将所有文件递归复制到一个文件夹中（不重新创建文件夹）

> ID：15209559
> 
> 赞同：5
> 
> 时间：2013-03-04T19:31:47.390
> 
> 标签：batch-file, directory, xcopy

使用批处理（.bat），我想复制 D:\TEMP 的 1 个子目录中的所有 mp3 文件

```
D:\TEMP\\(anyfolder)\\(anyfile.mp3) 
```

至

```
E:\MYFOLDER\ 
```

我尝试使用 xcopy 但是

*   我不知道如何判断“只递归 D:\TEMP 的子文件夹，而不是子文件夹、子子文件夹等”。

*   使用 xcopy 时，会在目标中创建文件夹（为了复制源的文件夹树），我不希望这样：文件应仅复制到 1 个单个文件夹中。

提前致谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-04T19:39:06.700

`for`命令是你的朋友。阅读`help for`然后在命令提示符下尝试

```
for /d %a in (*) do @echo %a 
```

如您所见，它跟随当前目录中的所有子文件夹。

因此，

```
for /d %a in (*) do @copy %a\*.mp3 e:\myfolder 
```

将所有 mp3 复制到目标文件夹。

# ios - 如何在 iOS 中实现登录屏幕（附截图）

> ID：15209563
> 
> 赞同：0
> 
> 时间：2013-03-04T19:31:56.943
> 
> 标签：ios

我有一个 iOS 应用程序的设计，它看起来像一个可编辑的表格单元格。![登录屏幕](../Images/10e929d52aea258345eea49beaee42b3.png)

我将如何实施以及电子邮件和密码字段？我不想让登录屏幕成为一个大的表格视图控制器，但我应该使用表格视图还是文本字段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:40:20.740

通过使用两个 UITextField 并更改边框样式，您可以获得非常相似的东西。但是，如果这对您不起作用，您始终可以将一个看起来与您想要的完全一样的图像放在背景中，并简单地隐藏文本字段上的边框。

# php - FTP文件传输或文件删除成功后的通知邮件

> ID：15209567
> 
> 赞同：1
> 
> 时间：2013-03-04T19:32:09.103
> 
> 标签：php, ftp, file-transfer, email-notifications

每次文件通过 FTP (FileZilla) 成功传输到特定文件夹或从特定文件夹中删除时，我想发送一封通知电子邮件。我如何意识到这一点？由于文件不是通过 PHP 传输的，因此函数 *is_uploaded_file* 似乎不是一个选项，是吗？

# vim - 如何在 Janus (VIM) 中将 Esc 重新映射到 Caps Lock

> ID：15209570
> 
> 赞同：0
> 
> 时间：2013-03-04T19:32:24.463
> 
> 标签：vim, macvim, janus

如何`esc`为 Janus (VIM) 重新映射 Mac (Mountain Lion) 上的 (escape) 键。

命令是什么？

我在什么文件中插入此代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T17:45:04.650

在 Vim 本身（或在 Janus 中）无法将 Caps-lock 重新映射到 Esc，因为 Vim 无论如何都无法识别 Caps-lock 键。

为此，您需要第三方工具：

*   [乌克莱莱](http://scripts.sil.org/cms/scripts/page.php?site_id=nrsi&id=ukelele)
*   [KeyRemap4MacBook](http://pqrs.org/macosx/keyremap4macbook/)
*   [PCKeyboardHack](http://pqrs.org/macosx/keyremap4macbook/pckeyboardhack.html.en)

也许还有其他人。

# html - 需要 css 帮助来强制单行上的元素

> ID：15209574
> 
> 赞同：3
> 
> 时间：2013-03-04T19:32:38.053
> 
> 标签：html, css

鉴于以下 HTML...

```
<div class="tester">
    <div>a</div>
    <div>abcd efgh ijkl mnop qrst abcd efgh ijkl mnop qrst abcd efgh ijkl mnop qrst abcd efgh ijkl mnop qrst </div>
    <div>c</div>
</div> 
```

我将如何更改此 css 以使上面的 3 个 div 出现在一行中？如果中间 div 超出其边界，我希望剪辑它。

```
.tester { width: 300px; overflow: auto; background-color: #c5c5c5; }
    .tester > div { float: left; overflow: hidden; }
        .tester > div:last-child { float: right; width: 50px; } 
```

[小提琴](http://jsfiddle.net/jeljeljel/B9ttJ/)

*** 更新 ***

**澄清** 我想将宽度保持在 300 像素，如果中间元素超出它的边界框，则应该剪辑。第一个元素的边界框由它的大小决定。最后一个元素的边界框设置为 50px。所以中间元素应该剪辑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T19:39:43.517

使用内联显示，这里有一个小演示：

[演示](http://jsfiddle.net/B9ttJ/6/)

HTML：

```
<div class="tester">
    <div>a</div>
    <div>abcd efgh ijkl mnop qrst abcd efgh ijkl mnop qrst abcd efgh ijkl mnop qrst abcd efgh ijkl mnop qrst
    <div>c</div>
</div> 
```

CSS：

```
.tester div {
    display:inline;
} 
```

结果：

> a abcd efgh ijkl mnop qrst abcd efgh ijkl mnop qrst abcd efgh ijkl mnop qrst abcd efgh ijkl mnop qrst c

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T19:34:56.050

使用显示属性

```
display: inline-block; 
```

# java - 从 Java 文件中读取俄语符号并输出到控制台

> ID：15209575
> 
> 赞同：1
> 
> 时间：2013-03-04T19:32:40.830
> 
> 标签：java, encoding, readline, filewriter

我正在编写一个小型 Java 应用程序。它只是读取一个文本文件并将其内容输出到控制台。我使用 FileWriter 方法 readLine() 来完成。该文件包含俄语文本。当我看到控制台输出时 - 有非常奇怪的符号，比如有编码的东西。在这种情况下我该怎么办？

谢谢你

# javascript - knockout.js 排序的可观察数组

> ID：15209576
> 
> 赞同：3
> 
> 时间：2013-03-04T19:32:41.830
> 
> 标签：javascript, knockout.js

我想要一个可观察的数组，当一个对象被推入其中时它会自行排序（如果它在比较器函数中使用的任何值被更改，它会自行排序会更好）。

您可以定义您希望数组排序的比较器函数，然后每次调用 push 时，它会将推送的对象添加到数组中的正确位置，因此数组保持排序，例如：

```
var sortedArray = ko.sortedObservableArray(
    function (a,b) { return b - a;},
    [1,7,4]
); // sortedArray will be [1,4,7]
sortedArray.push([5,2]); // sortedArray will now be [1,2,4,5,7] 
```

是否有任何图书馆可以为我做这件事，如果没有，最好的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T17:51:28.233

我最终通过扩展敲除可观察数组创建了一个排序的可观察数组：

```
ko.sortedObservableArray = function (sortComparator, initialValues) {
    if (arguments.length < 2) {
        initialValues = [];
    }
    var result = ko.observableArray(initialValues);
    ko.utils.extend(result, ko.sortedObservableArray.fn);
    delete result.unshift;
    result.sort(sortComparator);
    return result;
};

ko.sortedObservableArray.fn = {
    push: function (values) {
        if (!$.isArray(values)) {
            values = [values];
        }
        var underlyingArray = this.peek();
        this.valueWillMutate();
        underlyingArray.push.apply(underlyingArray, values);
        underlyingArray.sort(this.sortComparator);
        this.valueHasMutated();
    },
    sort: function (sortComparator) {
        var underlyingArray = this.peek();
        this.valueWillMutate();
        this.sortComparator = sortComparator;
        underlyingArray.sort(this.sortComparator);
        this.valueHasMutated();
    },
    reinitialise: function (values) {
        if (!$.isArray(values)) {
            values = [values];
        }
        var underlyingArray = this.peek();
        this.valueWillMutate();
        underlyingArray.splice(0, underlyingArray.length);
        underlyingArray.push.apply(underlyingArray, values);
        underlyingArray.sort(this.sortComparator);
        this.valueHasMutated();
    },
    reverse: function () {
        var underlyingArrayClone = this.peek().slice();
        underlyingArrayClone.reverse();
        return underlyingArrayClone;
    }
}; 
```

可以通过以下方式使用：

```
var sortedArray = ko.sortedObservableArray(
    function (a,b) { return a - b;},
    [1,7,4]
); // sortedArray will be [1,4,7]
sortedArray.push([5,2]); // sortedArray will now be [1,2,4,5,7]
sortedArray.sort(function (a,b){
    return b - a;
}); // sortedArray will now be [7,5,4,2,1]
sortedArray.push(6); // sortedArray will now be [7,6,5,4,2,1] 
```

我遇到的唯一问题是，当使用新数组重新初始化已排序的可观察数组时，您将重新初始化可观察数组，但未对已排序的可观察数组进行排序。为了解决这个问题，我在排序后的可观察数组上添加了一个重新初始化函数：

```
var sortedArray = ko.sortedObservableArray(
    function (a,b) { return a - b;},
    [1,7,4]
); // sortedArray will be [1,4,7]

sortedArray([3,2,8]); // this doesn't work correctly, sortedArray will be [3,2,8]
// instead of [2,3,8]

// To get around this you can use reinitialise()
sortedArray.reinitialise([3,2,8]); // sortedArray will be [2,3,8] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T19:43:09.573

试试这个：

```
var sortedArray = ko.observableArray();
sortedArray.subscribe(function () {
    if (!sortedArray._isSorting) {
        sortedArray._isSorting = true;
        sortedArray.sort(function (a, b) { return b - a; });
        sortedArray._isSorting = false;
    }
}); 
```

您可以将其包装在一个函数中，以便随时创建新的已排序可观察数组。

# asp.net - asp.net MySql MySqlConnection - 实现连接池或等效

> ID：15209579
> 
> 赞同：1
> 
> 时间：2013-03-04T19:32:51.670
> 
> 标签：asp.net, mysql

这是我第一次在 ASP.Net 上使用 MySql。

与我经常使用的 MSSql 不同，我注意到使用 MySqlConnection 连接到数据库需要很长时间（我的意思是一两秒），

```
MySql.Data.MySqlClient.MySqlConnection connection = new MySqlConnection(DBConnectionString); 
```

因此，我想知道如何实现一个连接池，或者任何可以存储一个连接对象（MySqlConnection）的推荐结构，以便在整个应用程序中使用。

是否有这样做的普遍做法或任何其他建议？

这是我正在使用的代码 - 也许我在这里做错了什么？

```
MySql.Data.MySqlClient.MySqlConnection connection = new MySqlConnection(DBConnectionString);
MySqlDataAdapter adapter = new MySqlDataAdapter();
if (connection.State != ConnectionState.Open)
{
    try
    {
      connection.Open();
    }
    catch (MySqlException ex)
    {
     throw (ex);
      }
 }
  MySqlCommand cmd = new MySqlCommand("SELECT this FROM that", connection);

            DataSet ds = new DataSet();
            adapter.SelectCommand = cmd;
            adapter.Fill(ds);

            cmd.Connection.Close(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:48:25.653

[根据文档](http://dev.mysql.com/doc/refman/5.0/en/connector-net-programming-connection-pooling.html)，默认情况下它是打开的。此外，您正在使用连接字符串创建实例，这很好，因为它允许连接器立即利用池。因此，创建这些连接需要一两秒钟的事实***几乎可以肯定***与连接池无关，而与您在工作环境中提供 MySQL 的硬件更相关。

**硬件**一词在这里非常广泛，因为您可以处理从网络到磁盘和内存相关问题的所有问题。

**请阅读文档**- 它确实向您展示了如何调整连接池 - 这样可能会对您有所帮助。我做出这样的声明是因为您的问题并没有为我们提供很多关于您如何使用此服务器或这些连接***的信息。***

# java - 为什么在 Callable 中设置中断位

> ID：15209583
> 
> 赞同：0
> 
> 时间：2013-03-04T19:33:00.890
> 
> 标签：java, interrupt, future, callable, interrupted-exception

因此，此资源（[http://www.ibm.com/developerworks/java/library/j-jtp05236/index.html](http://www.ibm.com/developerworks/java/library/j-jtp05236/index.html)）建议在线程不处理中断本身时在线程中设置中断位，“*这样调用堆栈上较高的代码就可以了解中断并在需要时对其进行响应*。”

假设我正在使用 ExecutorService 在不同的线程中运行某些东西。我构造了一个 Callable 并将这个 Callable 传递给 ExecutorService.submit()，它返回一个 Future。如果 Callable 被中断然后重置中断位，则关联的 Future 在调用 Future.get() 时不会抛出 InterruptedException。那么如果这个 Future 是主线程访问生成的线程的唯一方式，那么在 Callable 中设置中断位的目的是什么。

```
class MyCallable implements Callable<String> {
  @Override
  public String call() {
    while (!Thread.currentThread().isInterrupted()) {
    }
    Thread.currentThread().interrupt();
    return "blah";
  }
}

 ExecutorService pool = makeService();
 Future<String> future = pool.submit(new MyCallable());
 // Callable gets interrupted and the Callable resets the interrupt bit.
 future.get(); // Does not thrown an InterruptedException, so how will I ever know that the Callable was interrupted? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:47:01.153

在这种情况下，没有在 2 个线程之间传递中断标志是正确的（无论出于何种原因，这就是内置 ExecutorService 的设计方式）。如果您希望主线程看到可调用的中断状态，那么您必须从您的调用方法中抛出 InterruptedException。

```
class MyCallable implements Callable<String> {
  @Override
  public String call() {
    // ...
    if(Thread.currentThread().isInterrupted()) {
      throw new InterruptedException();
    }
    return "blah";
  }
} 
```

`Future.get()`请注意，在这种情况下，您仍然不会直接获得 InterruptedException 。由于它是由可调用对象抛出的，因此它将被包裹在一个中`ExecutionException`（这样您就可以区分可调用对象的中断和主线程的中断）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T20:30:51.107

中断线程应该会终止它，但方式比`kill()`. 仅在各种阻塞操作期间检查线程的中断状态。

如果您的线程在这些操作之一期间被中断，`InterruptedException`则会抛出 an 。发生这种情况时，您希望尽快干净地退出。那么，`Callable`如果executor服务线程中断了怎么办呢？

如果它的操作很短，一个有效的选择是正常完成该操作，但在线程上设置中断状态，以便执行器服务将在此操作完成后关闭。

如果操作较长，您可能希望抛出一个异常，告诉调用者该操作已中断。

# xamarin - 来自 mdtool 的额外详细输出？

> ID：15209585
> 
> 赞同：0
> 
> 时间：2013-03-04T19:33:03.427
> 
> 标签：xamarin, xamarin.ios

我正在 Xamarin.iOS 中开发一个项目，它恰好通过一个构建服务器（在 Mac 上运行）。

构建似乎通常会失败，但即使使用`--verbose`or`-v`它似乎也会默默地失败。例如，现在，在为 iOS 优化图形后似乎失败了。构建的最后一行说`Build complete -- 0 errors, 0 warnings`。但后来我`Build step 'Execute shell' marked build as failure`从詹金斯那里得到了一个。我知道这是 mdtool 构建的失败，因为我之前已经成功构建过，而且我知道在它真正成功之前还有几个步骤。

成功过程的下一步应该是`Compiling to native code`，但由于某种原因它在到达之前失败了，或者至少将其输出到控制台。

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T14:15:39.430

mdtool 构建逻辑中有几个地方在执行我（希望）为 Xamarin Studio 4.0.2 修复的 shell 程序时没有正确捕获异常。

如果没有看到完整的构建日志，很难确定，但可能是它尝试执行的任何 shell 命令不存在或没有标记为执行权限。

我能想到的 mdtool 将为 iOS 构建调用的程序是：

1.  `pngcrush`（优化 .png 文件）
2.  `plutil`（优化 .plist 和 .strings 文件）
3.  `codesign`（虽然这个在编译为本机代码*后被调用）*

当然，`mtouch`这是用于将 IL 编译为本机代码的方法。该`mtouch`命令是 Xamarin.iOS 的一部分，而其他 3 个实用程序是 Mac OS X（或 Xcode）的一部分。

我在一两周前帮助调试的其他有类似问题的人的解决方案是因为他修改了`launchd`启动应用程序的 PATH 环境，不包括 /usr/bin，因此 mdtool 找不到上面列出的实用程序.

我对 Jenkins 不是很熟悉（我知道我们在 Xamarin 中使用它，但我不是这样做的团队的一员），因此请确保它启动 mdtool 的 PATH 环境设置为包含 /usr/bin .

希望有帮助。

# google-analytics - Google Analytics 中的事件跟踪。代码在正确的位置？

> ID：15209586
> 
> 赞同：0
> 
> 时间：2013-03-04T19:33:04.593
> 
> 标签：google-analytics, event-tracking

我需要您的帮助才能找出为什么 Google Analytics 没有跟踪我创建的 3 个事件。

请查看[http://www.zulamian.com/](http://www.zulamian.com/)的源代码，并查找以下代码行。

事件跟踪代码是否在正确的位置？

1）联系表单提交跟踪：

```
_gaq.push(['_trackEvent', 'Contacto', 'Consultar', 'Formulario de Consulta', 0, false]); 
```

2) 简历提交表单跟踪：

```
_gaq.push(['_trackEvent', 'CV', 'Enviar CV', 'Formulario de CV', 0, false]); 
```

3) 时事通讯注册表单提交跟踪：

```
_gaq.push(['_trackEvent', 'Boletin', 'Suscribirse a Boletin', 'Formulario de Boletin', 0, false]); 
```

非常感谢您的帮助！

# unit-testing - DbUnit - 如何在一个 DBTestCase 下设置多个初始测试状态（xml）

> ID：15209588
> 
> 赞同：3
> 
> 时间：2013-03-04T19:33:09.113
> 
> 标签：unit-testing, dbunit

很容易通过以下方式设置初始状态

> ```
> @Override
> protected IDataSet getDataSet() throws Exception {
>     IDataSet data = new FlatXmlDataSetBuilder().build(new File("src/test/resources/my-init1.xml"));
>     return data;
> } 
> ```

但是，如果我有几个测试用例不到一个 DBTestCase ？我应该如何设置多个初始状态（使用一些不同的初始 xml 文件，如 my-init1.xml、my-init2.xml 和 my-init3.xml）？

提前致谢 ！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T12:28:32.110

嗨，我想您可能希望制作一个 CompositeDataSet

[http://www.dbunit.org/apidocs/org/dbunit/dataset/CompositeDataSet.html](http://www.dbunit.org/apidocs/org/dbunit/dataset/CompositeDataSet.html)

所以它可能看起来像......

```
@Override
protected IDataSet getDataSet() throws Exception {
  IDataSet[] datasets = new IDataSet[] {
     new FlatXmlDataSetBuilder().build(new File("src/test/resources/my-init1.xml")),
     new FlatXmlDataSetBuilder().build(new File("src/test/resources/my-init2.xml")),
     new FlatXmlDataSetBuilder().build(new File("src/test/resources/my-init3.xml"))
  }

  return new CompositeDataSet(datasets);

} 
```

# c - 电脑猜我的号码 C 编程

> ID：15209589
> 
> 赞同：0
> 
> 时间：2013-03-04T19:33:10.187
> 
> 标签：c

谁能告诉我我的代码有什么问题。我正在尝试创建一个游戏，让计算机猜测我输入的数字。这是我的代码：

* * *

```
#include <stdio.h>
#include <time.h>
#include <stdlib.h>

int main(void) {

int numberGuess = 0;
int low = 1;
int high = 100;
int computerGuess = 0;

printf("Enter a number, 1 - 100: ");
scanf("%d", &numberGuess);

while (computerGuess != numberGuess) 
{

  computerGuess = ((high - low) + low)/2;
  printf("%d ", computerGuess);

  if (numberGuess > computerGuess)
    {
    printf("Your guess was to low \n");
    low = computerGuess+1;
    }
  else if (numberGuess < computerGuess)
    {
    printf("Your guess was to high \n");
    high = computerGuess-1;
}
  else if (numberGuess == computerGuess)
{
printf("Yess!! you got it!\n");
    }
 }
return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:39:25.730

这一行：

```
computerGuess = ((high - low) + low)/2; 
```

应该：

```
computerGuess = (high - low)/2+low; 
```

您正在寻找的是介于高位和低位之间的数字（这是二进制搜索，但我相信您知道这一点）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T19:43:01.233

修复代码：

```
#include <time.h>
#include<stdio.h>
#include <stdlib.h>

int main(void) {

int numberGuess = 0;
int low = 1;
int high = 100;
int computerGuess = 0;

printf("Enter a number, 1 - 100: ");
scanf("%d", &numberGuess);

while (computerGuess != numberGuess) 
{

  computerGuess = ((high - low)/2 + low);
  printf("%d ", computerGuess);

  if (numberGuess > computerGuess)
    {
    printf("Your guess was to low \n");
    low = computerGuess+1;
    }
  else if (numberGuess < computerGuess)
    {
    printf("Your guess was to high \n");
    high = computerGuess-1;
}
  else if (numberGuess == computerGuess)
{
printf("Yess!! you got it!\n");
    }
 }

return 0; 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T19:38:23.893

```
computerGuess = ((high - low) + low)/2; 
```

在这里，您只需添加低，然后立即减去它，从而使代码相等

```
computerGuess = ((high)/2; 
```

并且您总是比较相同的值，而 while 循环永远不会结束。

# ruby - 多个具有多个指向相同模型的关系-在 ruby 中获取数据

> ID：15209601
> 
> 赞同：1
> 
> 时间：2013-03-04T19:33:42.060
> 
> 标签：ruby, has-many-through

我有两个独立的有许多通过一个关系指向相同的对象。

*   用户通过 photo_relationships 拥有许多照片
*   用户通过投票有很多照片

在我的控制器中，我试图通过以下代码为用户显示所有照片：

```
@user = User.find(params[:id])
@photos = @user.photos 
```

但是，Inner Join 由 User 模型中最后提到的任何 has_many 关系控制，在本例中为投票。有没有办法指定使用什么内部连接，例如：

```
@photos = @user.photos( joins: :photo_relationships) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:36:25.450

做这样的事情：

```
class User
  ...
  has_many :voted_photos,        class_name: 'Photo', through: :votes
  has_many :relationship_photos, class_name: 'Photo', through: :photo_relationships
end 
```

# php - PHP循环通过MySQL并更新现有值

> ID：15209605
> 
> 赞同：0
> 
> 时间：2013-03-04T19:34:03.827
> 
> 标签：php, mysql, loops

我有一个脚本，它从由在线模型组成的 XML 提要中提取数据并将结果输入到 MySql 数据库中，这部分我工作得很好......

我有一个“状态”字段，显示模型是在线还是离线，XML 提要仅包含实际在线的模型，因此我将查询设置为 REPLACE INTO 并最终建立了所有这些模型的数据库......

问题是状态字段始终包含值“在线”，因此我尝试运行一个查询，该查询将遍历所有行并将状态值更改为“离线”，然后再运行主查询以解析当前 XML 提要数据。 ..

使用 ：

```
$query = "SELECT status FROM models";
$result = mysql_query($query) or die('Query failed: ' . mysql_error() . "\nQuery: $query");

while($row = mysql_fetch_array($result)) {
mysql_query ("UPDATE models SET '$row[1]'=offline WHERE '$row[1]'");
} 
```

没有产生错误，但也没有任何更新...... $row[1] 是“状态”字段......

我也尝试过使用带有 for 循环的 mysql_num_rows 查询，但没有取得多大成功，除了我能够在每一行中回显“状态”的内容但无法达到预期的结果，要么将它们全部替换为“离线”不管或者什么都不换...

感谢大家提供的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:45:42.670

我想你想做这样的事情：

```
 $query = "SELECT status FROM models";
 $result = mysql_query($query) or die('Query failed: ' . mysql_error() . "\nQuery: $query");
 mysql_query ("UPDATE models SET status='offline' WHERE status='online'"); 
```

PS：这就是你所有代码的样子.....aps，不要使用mysql扩展；改用 mysqli 或 PDO 和红色框和 blabla XD

萨卢多斯 ;)

# linux - shellscript 的数组声明在计划的 cron 作业中不起作用？

> ID：15209607
> 
> 赞同：0
> 
> 时间：2013-03-04T19:34:11.770
> 
> 标签：linux, shell, cron, crontab

我创建了一个名为“script.sh”的 shell 脚本，它读取数组元素并将其打印在终端上。脚本如下：

```
 arr=("hello" "world")
for i in ${arr[@]}
do
echo  $i;
done 
```

它在终端中执行时给出了预期的输出，即“Hello World”，但是如果我在 crontab 作业中安排相同的脚本每分钟自动执行一次并将输出存储在另一个文件中，则作业失败并给出

`/home/vikash/script.sh: 1: Syntax error: "(" unexpected`错误。

每分钟执行一次脚本并将输出存储在另一个文件中的 crontab 作业如下：

```
* * * * * $HOME/script.sh >> $HOME/output.log 2>&1 
```

在这种情况下如何使用数组？请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-03-21T12:38:17.037

在脚本的第一行之前添加：

```
#!/bin/bash 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-10T08:20:09.900

如果这个问题仍然有效，只需运行您的脚本

```
bash script.sh 
```

我也用 sh 试了一下，它不能用 sh 工作，但用 bash 可以很顺利。

# bash - 在 crontab 中使用 qsub？

> ID：15209613
> 
> 赞同：3
> 
> 时间：2013-03-04T19:34:27.387
> 
> 标签：bash, crontab

我正在尝试在 crontab 中 qsub 一个脚本。在 crontab txt 文件中，我尝试了：

```
 0 1 * * * qsub /script.sh 
```

我得到的错误是“/bin/sh: qsub: command not found。” 我已经尝试了一堆类似的迭代，并在网上四处寻找，但没有成功。我会很感激任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T20:06:50.683

`cron`在有限的环境变量集下运行的程序。特别是，由于它不读取您的 shell 启动文件（`.bashrc`、`.profile`、`.cshrc`等），因此它不会有您的`$PATH`设置；`$PATH`很可能是一些简单的东西，比如`/usr/bin:/bin`.

您可以为单个命令设置 PATH，如下所示：

```
0 1 * * * PATH=/directory/containing/qsub:/usr/bin:/bin qsub /script.sh 
```

也可以全局设置环境变量；此类设置将适用于从您执行的所有命令`crontab`：

```
PATH=/directory/containing/qsub:/usr/bin:/bin

0 1 * * * qsub /script.sh 
```

`man 5 crontab`，或查看[此处](http://www.manpagez.com/man/5/crontab/)，了解有关编写 crontab 的更多信息。

如果您想查看 cron 作业的环境是什么样的，可以*暂时*将此行添加到您的 crontab 中：

```
* * * * * printenv > cron-env 
```

等到下一分钟，然后`cat ~/cron-env`- 然后从您的 crontab 中删除该行，这样它就不会继续执行。

（你的脚本真的在根目录下吗？为什么不在你的主目录下？）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-24T08:46:42.597

对我有用的方法是我首先在 /etc/profile.d/sge.sh 下获取 sge.sh

然后 crontab 将获得正确的环境变量并能够在 crontab 下运行 qsub。

# tcl - doxygen 可以从 itcl 类成员中提取保护级别吗？

> ID：15209616
> 
> 赞同：2
> 
> 时间：2013-03-04T19:34:32.423
> 
> 标签：tcl, doxygen

我正在尝试使用 doxygen 来记录我的 itcl 代码（版本 1.8.2）。但是，它似乎错过了保护级别（公共/受保护/私有）。此外，它将公共变量与实例变量混为一谈，将所有变量标记为静态（只有公共应该是静态的）。第三，它不喜欢带有初始化语句的构造函数。在下面的代码上运行 doxygen 可以明显看出所有这些行为。前两种行为在 doxygen 手册本身的 tcl 代码示例中也很明显。doxygen 中 tcl 扫描仪的这些已知限制是什么？谢谢。

```
##\file

## MyClass
itcl::class MyClass {
    private common a     ;#< private common a
    protected common b   ;#< protected common b
    public common c      ;#< public common c
    private variable x   ;#< private variable x
    protected variable y ;#< protected variable y
    public variable z    ;#< public variable z
    ## private proc aa
    private proc aa args {}
    ## protected proc bb
    protected proc bb args {}
    ## public proc cc
    public proc cc args {}
    ## private method xx
    private method xx args {}
    ## protected method yy
    protected method yy args {}
    ## public method zz
    public method zz args {}
    ## constructor
    constructor args {} { 
        eval configure $args 
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-27T13:17:32.553

有一种（实用的）方法可以让 doxygen 了解类方法以及实例和公共变量的范围。不过，生成的文档仍将所有 ivars 报告为“静态”。

用于确定方法/ivar 范围的 doxygen 命令是：

```
## \private
## \protected
## \public 
```

我从 doxygen 文档[示例](http://www.doxygen.nl/manual/docblocks.html#tclblocks)中推断出这一点，尽管关键字也以 doxygen 命令的形式存在。

doxygen 和 Tcl 存在许多我无法克服的问题。

*   实例变量被记录为“静态”
*   正如您的示例还显示的那样，不会为命令（例如 \private、\protected）解析简要文档 (;#< )。我不知道这是否是预期的行为......
*   在类中声明的 proc 被忽略（尽管在任何其他命名空间中声明它们，但该类自己的作品，甚至是父命名空间）。

并且在 doxygen 的 bugzilla 中没有报告关于此的错误...

我已经重写了您的示例，并添加了更多有效和无效的示例。

```
##\file

## MyClass
itcl::class MyClass {

   ## \private common a
   private common a
   ## \protected common b
   protected common b 
   ## common c
   public common c

   private variable t   ;#<  variable x \private
   protected variable u ;#<  variable u \protected
   public variable v    ;#<  variable v \public

   private variable x   ;#< \private variable x 
   protected variable y ;#< \protected variable y
   public variable z    ;#< \public variable z

   ## \private proc aa
   private proc aa args {}
   ## \protected proc bb
   protected proc bb args {}

   private method xx args {} ;#< \private method xx
   protected method yy args {} ;#< \protected method yy
   public method zz args {} ;#< \public method zz

   ## \private variable k
   variable k   
   ## \protected variable l
   variable l
   ## \public variable m
   variable m   

   ## constructor
   constructor args {} { 
      eval configure $args 
   }

   ## proc proc comment
   proc cc { args } {}

}

## proc proc comment outside
proc dd { args } {}

namespace eval ::MyClass {
   ## proc proc comment outside
   proc ee { args } {}
} 
```

# java - 在 python 中为图片生成 md5 和，然后在 Android 应用程序中进行验证

> ID：15209617
> 
> 赞同：3
> 
> 时间：2013-03-04T19:34:35.013
> 
> 标签：java, android, python, md5

所以几天前我在这里问[了这个](https://stackoverflow.com/questions/15158651/generate-a-md5-sum-from-an-android-bitmap-object)关于从 android.graphics.Bitmap 对象生成 md5 总和的问题。用户 Leonidos 帮了大忙，他建议的方法很有效。但是我之前使用同一张图片生成的 md5 总和给出了不同的总和。

我正在使用的Android代码如下：

```
public String md5ForBitmap(Bitmap bitmap)
{
    String hash = "";
    try
    {
        ByteArrayOutputStream stream = new ByteArrayOutputStream();
        bitmap.compress(Bitmap.CompressFormat.JPEG, 100, stream);
        byte[] bitmapBytes = stream.toByteArray();

        MessageDigest messageDigest = MessageDigest.getInstance("MD5");
        messageDigest.update(bitmapBytes);
        byte[] digestedBytes = messageDigest.digest();

        BigInteger intRep = new BigInteger(1, digestedBytes);
        hash = intRep.toString(16);
    }
    catch (NoSuchAlgorithmException e)
    {
        e.printStackTrace();
    }
    return hash;
} 
```

虽然 python 脚本看起来像这样：

```
def begin(path):
    os.chdir(path)
    files = glob.glob("*")

    for file in files:
        processFile(file, path)

def processFile(file, folder):
    with open(file, "r") as picture:
        fileContents = picture.read()
        md5 = hashlib.md5()
        md5.update(fileContents)
        hash = md5.hexdigest()
        print file + "   :   " + hash 
```

Android 应用程序从服务器接收一个 json 字符串，其中包含图像的 url 和 md5 总和。md5 的总和是事先用 python 脚本计算出来的。下载图像后，我留下了一个 Bitmap 对象，然后我在应用程序中使用该对象。

Leonidos 建议 Bitmap 对象的处理方式与 python 处理图像数据的方式不同，我需要在 Android 中找到原始图像数据的 md5 和。这听起来，对我来说，是一个完全合理的解释。只是当谈到这一切时，我真的很迷茫。

那么正确的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T20:45:38.663

好吧，这只是一个有根据的猜测，但对我来说似乎很明显，如果您想获得与未压缩文件相同的 MD5 哈希值，则不应使用 JPEG 压缩位图。

您可能做的最简单的事情是使用[copyPixelsToBuffer](http://developer.android.com/reference/android/graphics/Bitmap.html#copyPixelsToBuffer%28java.nio.Buffer%29)并调整您的 python 代码以仅读取实际像素并忽略标题等。使用 PIL 很容易。

位图类在内部可能实际上只是一个未压缩的像素缓冲区，因此您甚至无法从中获取原始文件内容。只要位图类和 PIL 以相同的方式解压缩原始文件（这似乎很可能），使用哈希的实际像素值就可以避免问题。

# ios - ARC陷入无限保留或释放循环

> ID：15209618
> 
> 赞同：2
> 
> 时间：2013-03-04T19:34:35.750
> 
> 标签：ios, automatic-ref-counting

我有一个旧应用程序，我转换为使用 ARC。原始版本没有内存泄漏，我使用调试器中的内存诊断修复了转换后的所有错误。有时，应用程序会崩溃，并且堆栈跟踪看起来像 ARC 卡在无限的保留或释放周期中，如下所示：

```
0   CoreFoundation                  0x329046a6 CFRelease + 46
1   CoreFoundation                  0x329046da CFRelease + 98
2   CoreFoundation                  0x329046da CFRelease + 98
3   CoreFoundation                  0x329046da CFRelease + 98
4   CoreFoundation                  0x329046da CFRelease + 98 
```

不幸的是，堆栈跟踪在 512 个条目处被切断，所以我看不到这条链从哪里开始。Apple 表示，如果 alloc 和 init 方法分开并且 init 方法返回与 alloc 不同的对象，则可能会发生这种情况。我检查了我们所有的分配，它们遵循推荐的格式：

```
Class *var = [[Class alloc] initMethod:arg]; 
```

有没有人见过这种无限循环？我在使用 Xcode 调试器时一直无法捕捉到它，而且非常不一致。由于 ARC 正在注入保留和释放，我不知道崩溃的起源。

# sql - 如何以 CSV 格式发送查询结果？

> ID：15209620
> 
> 赞同：18
> 
> 时间：2013-03-04T19:34:40.303
> 
> 标签：sql, ssis

我正在研究 ETL，我在 SSIS 包中的 SQL 任务中有以下 sql 代码。这就是我编码的方式。我正在从表中选择数据并将该查询的结果作为文件。我希望以 CSV 格式发送此附件。我该怎么做？

```
EXEC sp_send_dbmail @profile_name='default',
@recipients='dev@null.com',
@subject=@SUB,
@body=@BODY,

@query= 'SELECT [MID],[HID],[MeC],[LC],[RowCDate]
FROM [JBC].[dbo].[Table1] WHERE RowCDate >= GETDATE()
',
@attach_query_result_as_file=1 
```

任何帮助将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-03-04T20:15:13.973

添加`@query_result_separator`应该可以解决问题。

```
EXEC sp_send_dbmail @profile_name='default',
@recipients='dev@null.com',
@subject=@SUB,
@body=@BODY,

@query= 'SELECT [MID],[HID],[MeC],[LC],[RowCDate]
FROM [JBC].[dbo].[Table1] WHERE RowCDate >= GETDATE()
',
@attach_query_result_as_file = 1,
@query_attachment_filename   = 'Results.csv',
@query_result_separator      = ',' 
```

添加`@query_result_no_padding = 1`可能会稍微清理结果。所有的论点都可以在[这里找到](http://msdn.microsoft.com/en-us/library/ms190307.aspx)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-06-25T12:40:08.763

```
@query='
SET NOCOUNT ON;
select ''sep=;''
select ''Col1'',''Col2'',''Col3'',''Col3''

select CONVERT(NVARCHAR,Col1),ISNULL(Col2, ''''),Col4
FROM ...
SET NOCOUNT OFF;
',

--Additional settings
@query_attachment_filename   = '*.csv',
@query_result_separator      = ';',
@attach_query_result_as_file = 1,
@query_result_no_padding     = 1,
@exclude_query_output        = 1,
@append_query_error          = 0,
@query_result_header         = 0; 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-11-27T15:00:40.487

添加

```
'[sep=,' + CHAR(13) + CHAR(10) ColumnName] 
```

结果解决了这个问题

见[源](http://www.purplefrogsystems.com/blog/2014/04/excel-doesnt-open-csv-files-correctly-from-sp_send_dbmail/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-10-06T18:32:49.130

[这条关于紫色青蛙的评论](https://www.purplefrogsystems.com/blog/2014/04/excel-doesnt-open-csv-files-correctly-from-sp_send_dbmail/#comment-1739)表明您也可以使用制表符作为分隔符：

> ```
> DECLARE @tab char(1) = CHAR(9)
> EXEC msdb.dbo.sp_send_dbmail  
> @profile_name='donotreply' 
> ,@recipients ='xx@x'  
> ,@query= @query  
> ,@subject= 'xx'  
> ,@attach_query_result_as_file=1    
> ,@query_attachment_filename='xx.csv'    
> ,@query_result_separator=@tab
> ,@query_result_no_padding=1 –trim
> ,@query_result_width=32767 –stop wordwrap 
> ```

看起来这个答案已经发布了，我的错：[https ://stackoverflow.com/a/44315682/5758637](https://stackoverflow.com/a/44315682/5758637)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-11-20T16:44:49.320

在一个过程中：

```
SELECT 
table.myColumn AS [sep=, 
myColumn]
, table.myCol2
, table.myCol3... 
```

在“sep=”之后的列别名内有一个正常的硬返回。

# c++ - OpenGL分离RGB通道

> ID：15209630
> 
> 赞同：2
> 
> 时间：2013-03-04T19:35:08.757
> 
> 标签：c++, opengl-es, textures

使用 OpenGL，我已将图像上传到纹理中：

```
glTexImage2D (GL_TEXTURE_2D, 0, GL_RGB, imageWidth, imageHeight, 0, GL_RGBA, GL_UNSIGNED_BYTE, imageData); 
```

现在，我想看看我是否可以在 OpenGL 的帮助下分离我的通道？例如，能够将我的红/绿/蓝通道分别存储在单独的缓冲区中？这对OpenGL来说很容易吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:52:34.923

`RGB`纹理可以被视为 3 个单独的缓冲区，但可以跨步保存在内存中。但是，如果您需要使用三个单独的连续缓冲区，则`GL_RED`可以使用格式，您可以使用 3 次，每次用于一个通道。

要从这种数据中绘制，您必须将数据放回一个缓冲区，或者使用一次从 3 个纹理中采样的着色器：

```
vec2 tc;
sampler2d red, green, blue;

my_out_color = vec4(texture(red, tc).r, texture(green, tc).r, texture(blue, tc).r, 1.0); 
```

# python - 在 django 模型查询集中按自定义属性排序的好方法是什么？

> ID：15209632
> 
> 赞同：1
> 
> 时间：2013-03-04T19:35:15.210
> 
> 标签：python, django, sorting, sql-order-by, django-queryset

我的模型中有一个自定义属性，我想 order_by 使用该属性：

```
class Report(models.Model):
    title = models.CharField(max_length = 255)
    pub_date = models.DateTimeField('date published', blank=True, null=True)
    status = models.CharField(max_length = 2, choices=REPORT_STATUS)

    @property
    def risk_rating(self):
        # Calculate risk rating here
        return risk_rating 
```

我想要做

```
reports = Report.objects.all().order_by('-risk_rating') 
```

但当然它会返回一个关于不存在列的mysql错误。我不希望在使用 python 的排序算法中递归调用这个属性，但这是我认为我可以让它工作的唯一方法。

```
reports = sorted(Report.objects.all(), key=lambda t: t.risk_rating) 
```

我能不能做得比这更好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:40:05.590

不，ORM 使用数据库进行排序，不能对 python 值进行操作。

你可以...

1.  通过 django 在数据库级别计算`extra`
2.  计算数据并在模型保存时将其设置在新列中，然后按此排序。
3.  使用python排序

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T19:40:09.960

你可以避免`lambda`with`operator.itemgetter`

```
import operator
reports = sorted(Report.objects.all(), key=itemgetter(risk_rating)) 
```

但我不确定这是否“更好”，也许您可​​以解释一下您希望如何改进查询？

# php - 由 Joomla 会话变量控制的 HTML/CSS 进度条（到期日期）

> ID：15209634
> 
> 赞同：0
> 
> 时间：2013-03-04T19:35:18.890
> 
> 标签：php, session, variables, joomla, progress

我正在尝试使用进度条来显示用户在订阅中剩余的时间。我环顾四周，但找不到使用日期来控制 css % 的方法

[http://jsfiddle.net/vjNpj/1298/](http://jsfiddle.net/vjNpj/1298/)

我正在使用此代码显示用户帐户到期

```
<?php
$session =& JFactory::getSession();
echo $session->get('exp_date');?> 
```

它显示 MM/DD/YYYY

有谁知道如何做到这一点？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:41:18.057

您需要找到两个日期之间的百分比。这篇文章应该有所帮助。

[如何找到两个时间戳之间的百分比](https://stackoverflow.com/questions/5723017/how-to-find-percent-between-two-timestamps)

```
$begin= strtotime('-2 weeks');
$now = time();
$end = strtottime('+2 weeks');

$percent = ($now-$begin) / ($end-$begin) * 100; 
```

# python - convert_to_r_dataframe 模块对象没有属性

> ID：15209636
> 
> 赞同：1
> 
> 时间：2013-03-04T19:35:31.690
> 
> 标签：python, pandas, rpy2

我是 python 和学习熊猫的新手。我想将熊猫数据框“datframe”转换为 R 风格的数据框（稍后使用 rpy2）。为此，我的代码中有以下两行：

```
import pandas.rpy.common as com  
r_dataframe = com.convert_to_r_dataframe(datframe) 
```

第一个命令通过但随后出现以下错误：

```
回溯（最近一次通话最后）：
  文件“”，第 1 行，在
    r_dataframe = com.convert_to_r_dataframe(datframe)
AttributeError：“模块”对象没有属性“convert_to_r_dataframe””

```

我不确定为什么会发生这种情况以及如何解决它。在代码的前面，我有 import pandas as pd 这可能是问题吗？

我正在使用 python 2.7.3、rpy2-2.3.2 和 2.15.3

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:58:06.873

这个对我有用：

```
>>> import rpy2
>>> import pandas as pd
>>> import pandas.rpy.common as com
>>> rpy2.__version__
'2.3.1'
>>> pd.__version__
'0.10.0'
>>> datframe = pd.DataFrame({'a' : [1, 2, 3], 'b' : [3, 4, 5]})
>>> r_df = com.convert_to_r_dataframe(datframe)
>>> r_df
<DataFrame - Python:0x105b12710 / R:0x7fa8131d7918>
[IntVector, IntVector]
  a: <class 'rpy2.robjects.vectors.IntVector'>
  <IntVector - Python:0x105b12ab8 / R:0x7fa8131d7838>
[       1,        2,        3]
  b: <class 'rpy2.robjects.vectors.IntVector'>
  <IntVector - Python:0x105b12950 / R:0x7fa8131d7800>
[       3,        4,        5] 
```

不同的rpy2版本虽然..

# tsql - IF EXISTS-错误

> ID：15209642
> 
> 赞同：0
> 
> 时间：2013-03-04T19:35:40.417
> 
> 标签：tsql

有人可以告诉我正确使用`IF EXISTS`. 我有这个查询，但我的`IF EXISTS`功能有问题。

```
insert into master.dbo.turnover3(shop,somefield)
select '301',Curr_Turnover 
from [S301].vpm.dbo.BO_POS_SAP_Turnover
where datediff(day,left(Sale_Date,16),getdate())= '0' if not exists (select NULL) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:45:45.120

由于您没有在此处进行更新（或者由于没有其他部分），因此您无需检查记录是否存在。**`No records found means no records inserted`**.

```
insert into master.dbo.turnover3(shop,somefield)
select '301',Curr_Turnover 
from [S301].vpm.dbo.BO_POS_SAP_Turnover
where datediff(day,left(Sale_Date,16),getdate()) = 0 
```

另外作为旁注，不确定您在子句`left(Sale_Date,16)`中的*`datediff`*函数中做了什么。*`where`*如果`Scale_Date`是一种`date/datetime`类型，您可以将其用作`datediff(day,Sale_Date,getdate()= 0`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T19:42:47.270

正确使用`if exists`很容易。它不是`select`、`update`或`SQL`语句的有效语法。没有它，您的查询将正常工作：

```
insert into master.dbo.turnover3(shop,somefield)
    select '301',Curr_Turnover 
    from [S301].vpm.dbo.BO_POS_SAP_Turnover
    where datediff(day,left(Sale_Date,16),getdate())= '0' ; 
```

`if exists` *是*T-SQL 的一部分。也就是说，您可以使用它编写脚本。使用这种语法，它只是`if`语句的另一种变体：

```
if not exists (select *
               from master.dbo.turnover3(shop,somefield)
               where shop = '301'
              )
begin
    insert into master.dbo.turnover3(shop,somefield)
        select '301',Curr_Turnover 
        from [S301].vpm.dbo.BO_POS_SAP_Turnover
        where datediff(day,left(Sale_Date,16),getdate())= '0' ;
end; 
```

# ios - 如何检测用户在 iOS 中使用了语音输入？

> ID：15209662
> 
> 赞同：4
> 
> 时间：2013-03-04T19:36:29.933
> 
> 标签：ios, speech-recognition, text-to-speech, uitextinput

我想检测用户何时使用 iOS 键盘麦克风将文本添加到 UITextField。因此，在键盘出现进行文本输入后，只要他们使用听写麦克风一次，就会设置一个标志，指示他们已使用语音输入。我需要这样做以进行使用分析。

`dictationRecordingDidEnd`我尝试根据这个进行陷印：

[https://developer.apple.com/documentation/uikit/uitextinput](https://developer.apple.com/documentation/uikit/uitextinput)

并遇到了作者在这里遇到的同样问题： [dictationRecordingDidEnd never called](https://stackoverflow.com/questions/12268194/dictationrecordingdidend-never-called)

因为该方法似乎永远不会执行。还有另一种检测语音输入的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-09T16:12:32.870

MyThis 是采用的协议，因此您需要重写该方法。这对我在 iOS 8.1.1 下运行很有用：

```
#import <UIKit/UIKit.h>

@interface MyTextField : UITextField

@end

#import "MyTextField.h"

@implementation MyTextField

- (void) dictationRecordingDidEnd {
    printf("dictationRecordingDidEnd\n");
}

@end 
```

# c++ - C++：纯虚类型

> ID：15209663
> 
> 赞同：4
> 
> 时间：2013-03-04T19:36:30.830
> 
> 标签：c++, scala, templates, generic-programming

我正在探索 C++ (C++11) 中的模板恶作剧，我想要的一件事是抽象类中的纯虚拟类型。这就像 Scala 的[抽象类型](http://www.scala-lang.org/node/105)。在 C++ 中，我想做如下的事情：

```
struct Base {
  // Says any concrete subclass must define Type, but doesn't
  // require that it be anything in particular.
  virtual typedef MyType; 
};

struct Derived : Base {
  // Won't compile unless this typedef exists.
  typedef int MyType;
}; 
```

知道怎么做吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T19:46:51.390

我不确定 C++ 是否真的需要这个。

试图让自己处于寻找这种解决方案的设计师的位置，我会说需要这种约束来强制某些类型遵守某些语法约定。

很可能，这是需要的，因为通用算法需要语法约定：它不能与未定义此类类型关联的类型一起使用。

例如，下面的算法要求其参数的类型具有关联`bar_type`：

```
template<typename T>
bool foo(T t)
{
    typedef typename T::bar_type FT;
    FT ft;
    ...
} 
```

但如果是这种情况，则无需*强制执行*a`typedef`来有效地约束 : 的输入`foo<>()`：简单地省略类型定义 for`bar_type`不会使该类型与`foo<>()`.

当然，只有在您真正*尝试*这样做时，您才会发现这一点，而不是之前。并且能够定义一个*概念*，例如`HasBarType`，然后强制一些类型来实现这个概念会很好；另一方面，概念*还不*是 C++ 的一部分，尽管它们是可取的，但没有它们也是可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T19:56:04.783

*编辑*

这不起作用，但我认为[奇怪的重复模板模式](https://stackoverflow.com/questions/149336/practical-uses-for-the-curiously-recurring-template-pattern)可能是要走的路。

*/编辑*

```
template<typename Dependent>
class Base : public Dependent {
    typedef typename Dependent::MyType MyType;
}; 
```

然后使用[奇怪的重复模板模式](https://stackoverflow.com/questions/149336/practical-uses-for-the-curiously-recurring-template-pattern)：

```
struct Derived : Base<Derived> {
  // Won't compile unless this typedef exists.
  typedef int MyType;
}; 
```

# c++ - TinyXML 获得价值

> ID：15209665
> 
> 赞同：3
> 
> 时间：2013-03-04T19:36:35.630
> 
> 标签：c++, xml, parsing, tinyxml

给定 XML，例如：

```
<a>
    <result>0</result>
    <data>I9C3J9N3cCTZdKGK+itJW1Q==</data>
</a> 
```

我需要得到 0 的事实`<result>`并对其采取行动。

我在做：

```
TiXmlDocument doc;
bool bOK = doc.Parse((const char*)chunk.memory, 0, TIXML_ENCODING_UTF8);
if (bOK)
{
    TiXmlHandle hDoc(&doc);
    TiXmlElement *pRoot, *pParm, *pParm2;
    pRoot = doc.FirstChildElement("a");
    if(pRoot)
    {
        pParm = pRoot->FirstChildElement("result");
        if (pParm)
        {
            if (pParm->GetText()=="0")
            {
                pParm2 = pRoot->NextSiblingElement("data");
                if (pParm2)
                {
                    sValue = pParm2->GetText();
                    std::cout << "sValue: " << sValue << std::endl;
                }
            }
        }
    }
} 
```

我认为这`GetText()`是正确的答案，但我做错了，因为我从来没有进入`if`检查`<data>`元素。

任何人都可以为我解释一下吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T19:42:40.207

因为在您的情况下，`<data>`不是 Sibling 的`<a>`.

您正在检查**pRoot** ->NextSiblingElement("data") 而您应该检查**pParm** ->NextSiblingElement("data");

您也可以将其更改为

```
pParm2 = pRoot->FirstChildElement("data"); 
```

**编辑：** 对不起，我以为你指的是这个，如果：

```
if (pParm2) 
```

所以，解决方案可能是这样的：

```
if (std::string(pParm->GetText())=="0") 
```

或者

```
if (strcmp(pParm->GetText(), "0")) 
```

你选。我更喜欢第一个。

**编辑2：**

我真的很抱歉，我忘记了 strcmp 返回两个字符串相同的第一个位置，所以，在你的情况下它应该是：

```
if (strcmp(pParm->GetText(), "0") == 0) 
```

你也需要包括在内`<string.h>`。

# ruby-on-rails - 覆盖来自另一个扩展的refinerycms 页面扩展

> ID：15209670
> 
> 赞同：0
> 
> 时间：2013-03-04T19:37:01.690
> 
> 标签：ruby-on-rails, refinerycms, rails-engines, refinery

我正在制作重定向扩展，我想在页面扩展中为 PagesController 中的 find_page 制作一个装饰器（如果找不到页面，则处理重定向）。如果装饰器在主应用程序中，一切正常。如果我把它放在我的重定向扩展中，它会被加载——但结果不一致；有时有效，有时无效。

我的猜测是它与加载文件的顺序有关，所以我试图在我的引擎中加载装饰器之前要求页面扩展 - 但这没有帮助。任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T10:08:15.643

我能够按照[从外部 gem 增强模型的](https://stackoverflow.com/q/4018701/270237)建议完成这项工作- 尽管我必须将实际代码放入 to_prepare 以便在重新加载类时它始终在开发模式下工作。

# javascript - 如何将自定义错误消息传递给茉莉花匹配器？

> ID：15209673
> 
> 赞同：31
> 
> 时间：2013-03-04T19:37:06.777
> 
> 标签：javascript, unit-testing, jasmine

在我使用的所有测试框架中，都有一个可选参数来指定您自己的自定义错误消息。

这可能非常有用，我找不到开箱即用的茉莉花方法。

我有 3 位其他开发人员向我询问过这个确切的功能，当谈到 jasmine 时，我不知道该告诉他们什么。

是否可以在每个断言上指定您自己的自定义错误消息？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2016-01-15T16:06:36.427

Jasmine 已经在所有匹配器（toBe、toContain 等）中支持可选参数，因此您可以使用：

```
expect(true).toBe(false, 'True should be false'). 
```

然后在输出中它将如下所示：

```
Message:
    Expected true to be false, 'True should be false'. 
```

提交链接（文档中没有描述）： [https ://github.com/ronanamsterdam/DefinitelyTyped/commit/ff104ed7cc13a3eb2e89f46242c4dbdbbe66665e](https://github.com/ronanamsterdam/DefinitelyTyped/commit/ff104ed7cc13a3eb2e89f46242c4dbdbbe66665e)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-05T08:14:59.573

如果您查看 jasmine 源代码，您会发现无法从匹配器外部设置消息。例如`toBeNaN`匹配器。

```
/**
 * Matcher that compares the actual to NaN.
 */
jasmine.Matchers.prototype.toBeNaN = function() {
  this.message = function() {
      return [ "Expected " + jasmine.pp(this.actual) + " to be NaN." ];
  };

  return (this.actual !== this.actual);
}; 
```

如您所见，消息被硬编码到匹配器中，并且将在您调用匹配器时设置。我能想到拥有自己的消息的唯一方法是像描述的​​那样写你的匹配器[here](http://uxebu.com/blog/2013/01/08/make-tests-read-like-a-book/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-08-04T16:32:11.500

[这个问题](https://github.com/jasmine/jasmine/issues/641)`.because()`是跟踪使用机制实现自定义错误消息的兴趣。

与此同时，[avrelian](https://github.com/avrelian)创建了一个不错的库，它使用一种`since()`机制来实现自定义错误消息 - [`jasmine-custom-message`](https://github.com/avrelian/jasmine-custom-message).

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-10-22T16:40:16.933

**是的，这是可以做到的。**

您可以在全局范围内定义自定义匹配器，覆盖 jasmine 中的错误消息，如下所示：

```
beforeEach(function () {
    jasmine.addMatchers({
        toReport: function () {
            return {
                compare: function (actual, expected, msg) {
                    var result = {pass: actual == expected};
                    result.message = msg;
                    return result;
                }
            }
        }
    });
}); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-12-11T11:02:35.747

在.之后链式调用[withContext()](https://jasmine.github.io/api/edge/matchers.html#withContext) `expect()`例子：

```
expect(myValue)
  .withContext("This message will be printed when the expectation doesn't match")
  .toEqual({foo: 'bar'}); 
```

# mongodb - MongoDB 日志：范围 0:550000 并且找不到插件 [desc]

> ID：15209676
> 
> 赞同：2
> 
> 时间：2013-03-04T19:37:19.980
> 
> 标签：mongodb, meteor

我将 Meteor 与在 Windows 上运行的单独 MongoDB 一起使用。我将 MongoDB 作为服务运行。

我的 MongoDB 日志充满了以下内容：

```
Mon Mar 04 14:15:36 [conn19] info DFM::findAll(): extent 0:55000 was empty, skipping ahead. ns:webfm.graphdata
Mon Mar 04 14:15:38 [conn17] info DFM::findAll(): extent 0:55000 was empty, skipping ahead. ns:webfm.graphdata
Mon Mar 04 14:15:40 [conn16] info DFM::findAll(): extent 0:55000 was empty, skipping ahead. ns:webfm.graphdata
Mon Mar 04 14:15:43 [conn18] warning: can't find plugin [desc]
Mon Mar 04 14:15:43 [conn19] info DFM::findAll(): extent 0:55000 was empty, skipping ahead. ns:webfm.graphdata
Mon Mar 04 14:15:49 [conn18] info DFM::findAll(): extent 0:55000 was empty, skipping ahead. ns:webfm.graphdata
Mon Mar 04 14:16:14 [conn16] warning: can't find plugin [desc]
Mon Mar 04 14:16:20 [conn17] info DFM::findAll(): extent 0:55000 was empty, skipping ahead. ns:webfm.graphdata
Mon Mar 04 14:16:24 [conn16] warning: can't find plugin [desc]

Mon Mar 04 14:16:32 [conn20] info DFM::findAll(): extent 0:60000 was empty, skipping ahead. ns:webfm.history
Mon Mar 04 14:16:34 [conn16] warning: can't find plugin [desc] 
```

从我可以找到的“findAll(): extent 0:55000 ...”似乎与我的应用程序频繁删除数据有关。那是对的吗？

找不到插件 [desc] 怎么样？那个插件是什么？我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T17:30:52.130

该消息实际上是信息性的且无害的。它告诉您整个范围是空的。如果您最近删除了大量数据，则可能会发生这种情况。

您可以使用[compact](http://docs.mongodb.org/manual/reference/command/compact/_)命令对集合进行碎片整理和压缩（基本上将其重新写入磁盘并在集合上重新创建索引），这将消除日志消息。请注意，compact 是一项资源密集型操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T23:12:47.407

> 从我可以找到的“findAll(): extent 0:55000 ...”似乎与我的应用程序频繁删除数据有关。那是对的吗？

根据尼克的回答，该消息`extent 0:55000 was empty, skipping ahead`与您的频繁删除有关。这是跳过空数据范围时发出的警告，`0:55000`作为范围位置。当您向该集合添加更多数据时，通常会重复使用该空间。

如果您经常添加和删除此集合并且担心磁盘空间，您还可以考虑：

*   启用[`usePowerof2Sizes`](http://docs.mongodb.org/manual/reference/command/collMod/)此集合的标志（MongoDB 2.2 或更高版本）以更有效地重用已删除空间
*   将临时集合保存在单独的数据库中，并在完成后删除数据库（而不是运行频繁的压缩或修复）

> 找不到插件 [desc] 怎么样？那个插件是什么？我该如何解决？

这通常意味着您有一个无效的索引定义，并且找不到索引“插件”来处理它。在此示例中，我希望您有一个使用属性`desc`而不是声明的索引字段`-1`。

您可以使用以下命令检查索引定义[`db.collection.getIndexes()`](http://docs.mongodb.org/manual/reference/method/db.collection.getIndexes/)：

```
use webfm
db.graphdata.getIndexes() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T20:08:56.683

我不绝对确定这是一个问题。您可能运行 mongodb 时过于冗长，因此出于调试原因，它会在警告和进程中显示过多的细节。这是一件好事，因为如果存在问题或错误，则可以识别问题。

但是如果你想删除它：

减少 'v' 的数量或在启动命令中删除它们。

如果您使用配置文件更改其中任何一个，您必须为 false：

```
vvvvv = false
vvvv = false
vvv = false
vv = false
v = false 
```

# sql - SQL - 不包含指定表达式作为聚合函数

> ID：15209680
> 
> 赞同：2
> 
> 时间：2013-03-04T19:37:28.740
> 
> 标签：sql, ms-access

我正在尝试编写一个查询来计算和列出学生的 GPA，然后只显示低于所有学生平均 GPA 的那些。我已成功获得查询以输出每个学生的 GPA 表，但我无法让它仅显示低于平均水平的表。

以下是我当前的查询：

```
 SELECT SC.StudentID, S.StdLastName, GPA
    FROM (SELECT SC.StudentID, S.StdLastName, ROUND(SUM(C.Credits * GV.GradeValue)/SUM(C.Credits), 2) AS GPA
         FROM ((Student_Classes AS SC INNER JOIN GradeValues AS GV ON SC.Grade = GV.Grade) 
         INNER JOIN Students AS S ON SC.StudentID = S.StudentID)
         INNER JOIN Classes as C ON SC.ClassID = C.ClassID
         GROUP BY SC.StudentID, S.StdLastName)
    GROUP BY SC.StudentID, S.StdLastName, GPA
    HAVING GPA < AVG(GPA)
    ORDER BY GPA; 
```

当我这样做时，出现的错误是，

您尝试执行的查询不包含指定表达式 GPA < AVG(GPA) 作为聚合函数的一部分。

我在这个网站上发现了多个类似错误的页面，但仍然无法正常工作。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T21:15:33.273

当您说 时`GROUP BY SC.StudentID, S.StdLastName, GPA`，您是在告诉数据库使用这三列来创建数据组，然后`AVG`在每个组中应用聚合函数（在本例中）。这意味着，正如所写，您正在尝试根据该学生的平均水平过滤每个学生的 GPA。希望每个学生的平均 GPA 等于他们的实际 GPA...

为了完成这项工作，您需要第二个子查询，您可以使用它来获取总体平均 GPA：

```
SELECT sc.studentid, s.stdlastname, gpa
FROM   (SELECT sc.studentid, 
               s.stdlastname, 
               ROUND(SUM(c.credits * gv.gradevalue) / SUM(c.credits), 2) AS gpa
        FROM      ((student_classes sc
              INNER JOIN gradevalues gv
                 ON sc.grade = gv.grade)
              INNER JOIN students s
                 ON sc.studentid = s.studentid)
        GROUP BY sc.studentid, s.stdlastname)
GROUP BY sc.studentid, s.stdlastname, gpa
WHERE gpa < (SELECT AVG(GPA) as avg_gpa 
               FROM (SELECT ROUND(SUM(c.credits * gv.gradevalue) / SUM(c.credits), 2) AS gpa
                     FROM  student_classes sc
                           INNER JOIN gradevalues gv
                                   ON sc.grade = gv.grade
                     GROUP BY sc.studentid))
ORDER BY gpa; 
```

我不确定这是否会解决您的语法问题，但它应该可以解决您的逻辑问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T19:56:22.280

这是否摆脱了错误？如果是这样，您可以从中选择 sid、lname 和 GPA

```
 SELECT SC.StudentID, S.StdLastName, GPA, avg(GPA) as avgGPA
FROM (SELECT SC.StudentID, S.StdLastName, ROUND(SUM(C.Credits * GV.GradeValue)/SUM(C.Credits), 2) AS GPA
     FROM ((Student_Classes AS SC INNER JOIN GradeValues AS GV ON SC.Grade = GV.Grade) 
     INNER JOIN Students AS S ON SC.StudentID = S.StudentID)
     INNER JOIN Classes as C ON SC.ClassID = C.ClassID
     GROUP BY SC.StudentID, S.StdLastName)
WHERE GPA < avg(GPA)
GROUP BY SC.StudentID, S.StdLastName, GPA
    ORDER BY GPA; 
```

# c# - 为什么需要 wcf 双工？

> ID：15209682
> 
> 赞同：0
> 
> 时间：2013-03-04T19:37:29.803
> 
> 标签：c#, wcf, wcf-binding

WCF 双工在方法在服务器上运行之后执行回调，然后在客户端上运行代码。

如果我想通过按下服务器上的按钮从服务器上执行客户端上的方法，那么我认为 WCF 双工不合适。

为什么我不只是在我的 2 个应用程序的每一端创建一个客户端和一个服务器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T20:03:52.233

我是对你之前的问题发表评论的人之一，所以我可能在这里欠你一个答案：o）

您已经发布了相当多的代码，我没有详细查看它。但是，一般来说，使用 wsDualHttpBinding 和双工合同而不是更多的在双方都有服务的点对点方法*是有原因的，如下所示：*

双工方法适用于您拥有明确定义且永久运行的服务器的情况。这提供了交互的*中心*。这个想法是客户端在某种程度上比服务器更短暂。客户端可以启动和关闭或移动位置，服务器不需要提前知道它们。当客户端启动时，它被预先配置为知道服务器在哪里，因此它可以向服务器“注册”自己。

相反，服务器不需要预先配置就知道客户端在哪里。它启动并可以独立于任何客户端运行。它只接受来自所有具有有效凭据的客户端在上线时的“注册”，并且可以在客户端下线后继续运行。此外，如果客户端移动，它只会在新位置向服务器重新注册自己。

所以服务器在某种意义上是系统中更“重要”的部分。没有服务器，任何客户端都不能参与通信，但服务器可以独立于任何客户端运行。

要使用 WCF 双工服务执行此操作，您必须自己做一些额外的工作来实现发布/订阅行为。幸运的是，MSFT 模式和实践团队提供了一些关于如何做到这一点的指导

[http://msdn.microsoft.com/en-us/library/ms752254.aspx](http://msdn.microsoft.com/en-us/library/ms752254.aspx)

这与真正的点对点方法根本不同，在这种方法中，网络没有明确定义的集线器（即服务器），每个节点都可以进出而不影响网络的整体功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T20:02:05.837

当您有发布/订阅设置（也称为[观察者模式](http://en.wikipedia.org/wiki/Observer_pattern)）时，使用 WCF 双工。假设您有一项订阅某种通知的服务（例如新电子邮件）。通常，您需要定期检查更新。使用 WCF Duplex，当有更新时，发布者可以自动通知订阅者。

# datetime - 创建一个新实体，并立即更新另一个实体

> ID：15209683
> 
> 赞同：0
> 
> 时间：2013-03-04T19:37:30.583
> 
> 标签：datetime, symfony, orm, doctrine-orm, symfony-2.1

我已经对此进行了很多搜索，并且认真地询问是我的最后一个资源，教义让我很难受。

我有一个名为“合同”的实体和另一个“请求”，一个合同可能有多个请求，当添加一个新请求时，我搜索该客户的现有合同，如果已经存在则关联它，如果不存在则创建它。

在 RequestRepository.php 中：

```
 public function findOrCreate($phone)
  {
    $em = $this->getEntityManager();

    $contract = $this->findOneBy(array('phone' => $phone));

    if($contract === null)
    {
        $contract = new Contract();
        $contract->setPhone($phone)
                 ->setDesDate(new \DateTime());

        # save only if new
        $em->persist($contract);
    }

    return $contract;
 } 
```

问题是，当合同是新合同时，它可以正常工作，但是当从数据库“重用”时，我无法修改它的属性。我已经检查了 OneToMany 和 ManyToOne。

在 Contract.php 中：

```
/**
 * @var integer
 *
 * @ORM\Column(name="id", type="integer")
 * @ORM\Id
 * @ORM\GeneratedValue(strategy="AUTO")
 * @ORM\OneToMany(targetEntity="Request", mappedBy="contract")
 */
private $id; 
```

在 Request.php 中：

```
 /**
 * @var string
 * 
 * @ORM\JoinColumn(nullable=false)
 * @ORM\ManyToOne(targetEntity="Cid\FrontBundle\Entity\Contract", inversedBy="id", cascade={"persist"})
 */
protected $contract; 
```

我还有一个方法可以修改 Contract.php 中的属性：

```
 public function addTime($months)
{
    $days = $months * 30;

    $this->des_date->add(new \DateInterval("P".$days."D"));

    return $this;
} 
```

我创建了请求并“findOrCreate”了一个合同，但如果后者不是“新鲜的”，则 addTime 不会保存到数据库。

我究竟做错了什么？

编辑：控制器是一个常见的 CRUD，稍作修改。

不要担心“请求”名称冲突，实际代码是西班牙语，Request = Solicitud

```
public function createAction(Request $req) 
 {
    $entity  = new Request();
    $form = $this->createForm(new RequestType(), $entity);
    $form->bind($req);

    if ($form->isValid()) {
        $em = $this->getDoctrine()->getManager();

        $entity->setUser($this->getUser()); 

        $data = $request->request->get('cid_frontbundle_requesttype');
        $phone = $data['phone_number'];

        $reqRep = $em->getRepository('FrontBundle:Request');

        $entity = $reqRep->newRequest($entity, $phone);

        return $this->redirect($this->generateUrl('request_show', array('id' => $entity->getId())));
    }

    return $this->render('FrontBundle:Request:new.html.twig', array(
        'entity' => $entity,
        'form'   => $form->createView(),
    ));
} 
```

新请求：

```
public function newRequest($request, $phone)
{
    $em = $this->getEntityManager();
    $contractRep = $em->getRepository('FrontBundle:Contract');
    $contract = $contractRep->findOrCreate($phone);

    $contract->addTime(123); # this is the problem, I use var_dump and this method works, but doesn't persists

    $em->persist($request);
    $em->flush();

    return $request;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T22:21:10.963

尤里卡！！问题是原则似乎通过引用检查对象，而我对合同所做的只是将 DateInterval 添加到 DateTime 属性，因此对于原则而言，对象是相同的，并且没有保存。这是实现它的代码。

```
public function addTime($months)
{
    $days = $months * 30; # I know DateInterval has months but this is company policy ;)

    $other = new \DateTime($this->des_date->format('Y-m-d')); # creating a brand new DateTime did the trick

    $other->add(new \DateInterval("P".$days."D"));
    $this->des_date = $other;

    return $this;
} 
```

感谢@cheesemacfly 所做的一切。

# vb.net - 使用批处理或 vb.net 永久删除文件

> ID：15209687
> 
> 赞同：-5
> 
> 时间：2013-03-04T19:37:41.510
> 
> 标签：vb.net, batch-file, delete-file

我们得到了新电脑耶！但是，我们在旧 PC 上有一些中等敏感信息，我想知道我们如何永久删除这些文件（超出恢复软件的功能）。完成后，我们可以将老年人交给那里的孩子的工作人员。

我使用批处理进行编程，但是如果有更有效的 vb.net 方法可用，那么我也可以使用这种语言进行编程。

PC 上的信息并不过分敏感，但我们偶尔会保留一些我们宁愿留在屋内（而不是屋外）的 autocad 图纸，除此之外，PC 的状况良好，有点旧，但对身体来说是一种耻辱破坏其他人何时可以将它们用于家庭作业等..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:52:36.163

这里可能需要考虑的不仅仅是数据。软件许可呢？这些机器上是否安装了 Windows？您可以赠送 Windows 的副本吗？（我猜没有。）还有其他软件吗？

关于如何处理硬盘的一些想法可能包括：

1.  卸下硬盘驱动器并进行专业销毁。没有数据恢复的机会，除非工业间谍从破坏公司或公司内部拦截它们。你*可能*不需要走这么远，但它是安全的。
2.  卸下硬盘驱动器并保留它们。只是给人们空电脑，让他们可以安装自己的驱动器。
3.  破坏性格式化硬盘。这会在驱动器上执行重复的读/写测试，并非常有效地覆盖任何数据。这样，您不仅会删除文件，还会删除您可能不允许泄露的所有软件。它还向接收者保证驱动器已经通过了非常严格的测试并且没有坏扇区。
4.  正常格式化硬盘。如果攻击者想要数据足够糟糕，仍然可以恢复数据。考虑到您表达的（隐含的）风险/回报比，这*可能是*您最好的行动方案。
5.  电脑是给孩子的？拆开硬盘驱动器并进行工艺项目日，孩子们可以用盘片制作风铃。工作量很大，但是硬盘盘片可以制作出*很棒*的风铃。（如果你周围有铁磁流体，硬盘驱动器中的磁铁可以非常有效地产生非常酷的效果。）

# vim - 根据环境变量配置vimrc

> ID：15209688
> 
> 赞同：0
> 
> 时间：2013-03-04T19:37:45.807
> 
> 标签：vim, spork

是否可以根据环境变量配置 vimrc 命令映射？

例如，我正在使用 vim-ruby-test 插件，它提供以下配置：

```
let g:rubytest_cmd_test = "ruby %p" 
```

我想根据我是否使用 spork 运行测试来设置不同的命令：

带叉叉：

```
$ TESTDRB=y mvim .
let g:rubytest_cmd_test = "testdrb %p" 
```

没有Spork：

```
$ mvim .
let g:rubytest_cmd_test = "ruby %p" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T19:48:55.130

```
if $TESTDRB == 'y'
    let g:rubytest_cmd_test = 'ruby %p'
endif
" etc 
```

# admob - Admob 使用 iAd 配置中介

> ID：15209696
> 
> 赞同：3
> 
> 时间：2013-03-04T19:38:09.510
> 
> 标签：admob, iad

在 Admob 中，我有两种使用 Admob 配置 iAd 中介的方法

1.  eCPM -（我为每个广告网络设置 eCPM）
2.  % - 我设置了 % 份额（+ 国家定位作为可选选项）

我希望在可用时显示 iAd 并在其他情况下显示 admob。

我应该输入什么？（admob 文档没有帮助）

还有一些带有示例的文章，当我在 eCPM 字段中输入某些值时它将如何工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T01:22:51.343

[这里](http://googleadsdeveloper.blogspot.com/2012/06/distributing-ad-requests-for-admob.html)有一篇关于 eCPM 和百分比如何工作的相关博客文章。

对于 eCPM，AdMob 将根据网络的 eCPM 值降序排列网络。因此，如果您有 1.00 美元的 iAd 和 0.25 美元的 AdMob，iAd 将是第一个网络，而 AdMob 将回填其余的请求。如果您有 0.10 美元的广告网络 3，则订单将是 iAd、AdMob，然后是网络 3 填充 iAd 和 AdMob 未能填充的任何请求。

# sql - 查找具有单个 SSN 条目为空或多个 SSN 条目不相等的员工 ID

> ID：15209702
> 
> 赞同：0
> 
> 时间：2013-03-04T19:38:25.707
> 
> 标签：sql, sql-server

我有一个包含一个`employeeID`和一个 SSN 字段的表。我正在尝试使用以下标准过滤掉所有记录：

具有单个 SSN 条目且值为 null 的所有员工

拥有多个 SSN 条目的所有员工

下面展示了三种场景

```
ID          SSN
1           000000000
1           NULL

ID          SSN
1           000000000
1           111111111

ID          SSN
1           NULL 
```

这是表定义：我正在使用 Sybase 数据库中的数据填充此表

[http://tinypic.com/r/65wvhi/6](http://tinypic.com/r/65wvhi/6)

谢谢，布拉德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:44:06.333

```
select  employeeID 
from    YourTable
group by 
        employeeID
having  count(case when SSN is null then 1 end) > 0
        or count(distinct SSN) > 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T19:45:06.737

您将为此使用聚合，并带有一个`having`子句：

```
 select e.id
 from ssns e
 group by e.id
 having (count(*) = 1 and count(ssn) = 0) or  -- first condition
        count(*) > 1   -- second condition 
```

# cakephp-1.3 - 数据验证不允许仅数字

> ID：15209706
> 
> 赞同：0
> 
> 时间：2013-03-04T19:38:38.083
> 
> 标签：cakephp-1.3

我是 cakephp 新手，我正在尝试对程序名称进行数据验证。我希望我的程序名称只允许使用 alphaNumeric 或字符。我不希望它只允许数字或特殊字符。由于第二条规则，实际上不允许使用 Numeric 或 alphaNumeric。这是我的代码

```
$validate = array(    
    'program_name' => array(
        'required' => array(
            'rule' => 'isUnique',
            'allowEmpty'=> false,
            'message' => 'This Program Name already exists. Please enter a Program Name'
        ),
        'alphaNumeric'=> array(
            'rule' => 'alphaNumeric',
            'message'=> 'Please enter a valid name'
        ),
        'name' => array(
            'rule'    => '/^[a-zA-Z]*$/',
            'message' => 'Only letters or alphaNumerics. Please enter a valid name')
        )
    )
    //Validation rules for other fields, if any
); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T07:07:58.087

您对“必需”的使用已关闭，它可能应该是这样的：

```
$validate = array(    
    'program_name' => array(
        'isUnique' => array(
            'rule' => 'isUnique',
            'allowEmpty'=> false,
            'required' => true,
            'message' => 'This Program Name already exists. Please enter a Program Name'
        ),
        'alphaNumeric'=> array(
            'rule' => 'alphaNumeric',
            'message'=> 'Please enter a valid name'
        ),
        'name' => array(
            'rule'    => '/^[a-zA-Z]*$/',
            'message' => 'Only letters or alphaNumerics. Please enter a valid name')
        )
    )
    //Validation rules for other fields, if any
); 
```

现在，修复了“必需”的使用，我们将继续讨论您的问题。如果要检查字符串是否包含 alphaNumeric 字符，而不仅仅是数字：您需要编辑在“名称”规则中定义的正则表达式。我建议使用[这个问题](https://stackoverflow.com/questions/11773297/regex-only-alphanumeric-but-not-if-this-is-pure-numeric)的答案中的正则表达式。所以：用`/^[a-zA-Z]*$/`我提到的帖子中的正则表达式替换，然后删除名为 alphaNumeric 的规则，因此您的代码如下所示：

```
$validate = array(    
    'program_name' => array(
        'isUnique' => array(
            'rule' => 'isUnique',
            'allowEmpty'=> false,
            'required' => true,
            'message' => 'This Program Name already exists. Please enter a Program Name'
        ),
        'name' => array(
            'rule'    => '/^(?![0-9]*$)[a-zA-Z0-9]+$/',
            'message' => 'Only letters or alphaNumerics. Please enter a valid name')
        )
    )
    //Validation rules for other fields, if any
); 
```

# cassandra - 更新 cassandra 中的 TimeUUID 列

> ID：15209708
> 
> 赞同：2
> 
> 时间：2013-03-04T19:38:47.750
> 
> 标签：cassandra, pycassa, timeuuid

我正在尝试在以下列系列中存储一些时间序列数据：

```
create column family t_data with comparator=TimeUUIDType and default_validation_class=UTF8Type and key_validation_class=UTF8Type; 
```

我以这种方式成功插入数据：

```
data={datetime.datetime(2013, 3, 4, 17, 8, 57, 919671):'VALUE'}
key='row_id'
col_fam.insert(key,data) 
```

如您所见，使用 datetime 对象作为列名 pycassa 可以正确转换为 timeUUID 对象。

```
[default@keyspace] get t_data[row_id];

=> (column=f36ad7be-84ed-11e2-af42-ef3ff4aa7c40, value=VALUE, timestamp=1362423749228331) 
```

有时，应用程序需要**更新**一些数据。问题是当我尝试更新该列时，传递相同的 datetime 对象，pycassa 创建一个不同的 UUID 对象（时间部分是相同的），所以它不是更新列，而是创建另一个。

```
[default@keyspace] get t_data[row_id];

=> (column=f36ad7be-84ed-11e2-af42-ef3ff4aa7c40, value=VALUE, timestamp=1362423749228331)

=> (column=**f36ad7be**-84ed-11e2-b2fa-a6d3e28fea13, value=VALUE, timestamp=1362424025433209) 
```

问题是，如何使用传递 datetime 对象的 pycassa 更新基于 TimeUUID 的列？或者，如果这不是正确的方法，推荐的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T09:14:02.113

除非你做一个读-修改-写，否则你不能。UUID 本质上是独一无二的。它们的存在是为了解决如何获得按时间顺序排序的唯一 ID，同时避免恰好同时发生的事情发生冲突的问题。

因此，要更新该列，您需要先读取它，这样您就可以找到它的列键，更改它的值并再次将其写回。

这不是一个特别优雅的解决方案。你真的应该避免在 Cassandra 中读取-修改-写入。也许 TimeUUID 不是您的列键的正确类型？或者，也许还有另一种方法可以设计您的应用程序，以避免不得不返回并进行更改。

在不知道你的查询模式是什么样子的情况下，我不能确切地说你应该做什么，但这里有一些希望是相关的建议：

不要更新值，只需写入新值。如果某件事在时间 T 为真，那么在时间 T 中始终为真，即使它在时间 T + 1 时发生变化。当事情发生变化时，您在变化的时间写入一个新值，并让旧值保持不变。当您阅读时间线时，您可以通过选择最近的值来解决这些冲突 - 由于这些值将按时间顺序排序，因此最近的值将始终是最后一个值。这与 Cassandra 在内部做事的方式非常相似，并且是一种非常强大的模式。

不要担心这会占用更多的磁盘空间，或者在读取时间序列时需要一些额外的 CPU，与您必须实现的读取-修改-写入复杂性相比，它很可能很小。

可能还有其他方法可以解决您的问题，如果您提供更多详细信息，也许我们可以提出更适合的方法。

# java - 带油漆组件的计时器

> ID：15209710
> 
> 赞同：-1
> 
> 时间：2013-03-04T19:38:57.307
> 
> 标签：java, swing, timer, paintcomponent

我正在尝试在面板上绘制圆圈，但圆圈的颜色由某些参数决定。首先，圆圈应该被涂成白色，然后进入一个 for 循环检查哪个参数匹配并且应该用那种颜色涂上圆圈。圆圈的位置存储在一个数组中。我到目前为止所做的代码不起作用。我显然做错了什么，但我是 Java 和编码的新手，所以我非常卡住。如果有人能告诉我如何编辑/更改我的代码，我将不胜感激。ArrayList circlesT 是圆位置的数组列表， temp 是具有值的数组，我也有参数。

```
public void paintComponent(Graphics g) {            
        drawShapes(g, circlesT);          
    }           

    public void drawShapes(Graphics g, final ArrayList<Shape> circlesT) {
        final Graphics2D ga = (Graphics2D) g;
        ga.drawImage(newImage, 0, 0, null);
        for (int i = 0; i < circlesT.size(); i++) {
            ga.draw(circlesT.get(i));
            ga.setPaint(Color.white);
            ga.fill(circlesT.get(i));
        }    
        Timer timer = new Timer();
        TimerTask t;
        t = new TimerTask() {
            @Override
            public void run() {
                for (int i = 0; i < 10; i++) { 
                    if (read.temp.get(i) < 31 && read.temp.get(i) > 30) {
                        ga.draw(circlesT.get(i));
                        ga.setPaint(Color.green);
                        ga.fill(circlesT.get(i));
                    } else if (read.temp.get(i) < 32 && read.temp.get(i) > 31) {
                        ga.draw(circlesT.get(i));
                        ga.setPaint(Color.red);
                        ga.fill(circlesT.get(i));
                    } else if (read.temp.get(i) < 33 && read.temp.get(i) > 32) {
                        ga.draw(circlesT.get(i));
                        ga.setPaint(Color.yellow);
                        ga.fill(circlesT.get(i));
                    }                 
                }                    
            }
        };
        //repaint();
        timer.schedule(t, 0, 1000);    
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T19:46:09.877

几点。

*   您不应该在方法调用结束后继续持有该`Graphics`对象。`paintComponent`
*   一般来说，您应该使用`javax.swing.Timer`而不是`java.util.Timer`.
*   您在计时器任务/操作中实际应该做的是更新数据的状态并调用`repaint`.
*   完成所有绘画的代码应该`paintComponent`在它返回之前被调用。

# regex - 正则表达式查找包含一个单词但不包含另一个单词的文件

> ID：15209711
> 
> 赞同：11
> 
> 时间：2013-03-04T19:39:03.887
> 
> 标签：regex, eclipse, myeclipse

我正在尝试快速找到所有包含一个术语但缺少另一个术语的 .java 文件。我正在使用 MyEclipse 10.7 及其“搜索 | 文件搜索功能，支持正则表达式。

正则表达式会在这种情况下工作吗？正确的正则表达式是什么？

TIA，史蒂夫

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-13T15:44:58.290

我能找到工作的唯一解决方案是以下正则表达式：

```
^(?!.[\s\S]*MISSING_TERM).[\s\S]*INCLUDED_TERM.*$ 
```

它会找到每个包含`INCLUDED_TERM`但缺少的文件`MISSING_TERM`，而不管行。

关键是`\s\S`，它确保搜索整个文件而不是每一行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-04-20T10:34:28.073

如果您想在一行中找到它，请像这样使用它：

```
^(?!.*MISSING_TERM).*INCLUDED_TERM.*$ 
```

您也可以`\`用作转义字符，因为您可能需要它，例如`class\.variable`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T20:06:55.297

`(?m)\A(?=.*REGEX_TO_FIND)(?!.*MISSING_REGEX.*).*\z`

正则表达式可能有点棘手，但它分为两部分。

1.  找到匹配的术语/短语/单词。这部分不是太棘手，因为这是正则表达式通常寻找的。
2.  查找不存在的术语。这是棘手的部分，但这是可能的。

我有一个示例[HERE](http://rubular.com/r/uylPBOfJl9)，它显示了您希望如何`connectReadOnly`在文本中查找单词，但无法找到`disconnect`. 由于文本包含`connectReadOnly`它开始寻找下一段，而不是找到`disconnect`. 由于`disconnect`在文本中，它在整个字符串上都失败了（**整个文件匹配所需的内容**）。如果您使用第二部分，即否定部分`(?!.*disconnect.*)`，您可以将其设置为您需要的任何正则表达式。在我的示例中，我不想`disconnect`在我的代码中找到任何地方:) 您可以轻松地将其替换为要搜索的单词，甚至可以使用更复杂的正则表达式来“找不到”。

关键是使用多行模式，它使用`(?m)`字符串字符的开头然后使用开始/结尾来设置。使用`^`和`$`开始/结束一行，在哪里开始`\A`和`\z`结束一个字符串，从而将匹配扩展到整个文件。

编辑：对于`connectReadOnly`和`disconnect`问题使用：`(?m)\A(?=.*connectReadOnly)(?!.*disconnect.*).*\z`. 可以在[此处](http://rubular.com/r/uylPBOfJl9)找到更新的示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T20:14:43.030

你可以使用类似的东西：

```
(?<!.*bar)foo(?!.*bar) 
```

如果找到“foo”但没有找到“bar”，则匹配。

注意：您必须将搜索引擎配置为使用多行正则表达式（例如：Notepad++ 有一个名为“.matches newline”的选项），因为通常点表示*除*换行符之外的任何字符。

# java - 如何处理使用套接字连接到服务器的多个客户端？

> ID：15209712
> 
> 赞同：7
> 
> 时间：2013-03-04T19:39:04.750
> 
> 标签：java, android, sockets, client-server, wifi-direct

我有一个需要让多个设备连接的 Android 应用程序。一台设备应充当组所有者并向所有客户端发出指令以执行特定操作。我想它可以与一个玩家为主机的无线掌上游戏相媲美。

我有几个问题，所以我会尽量保持简洁。即使是第一个答案也会有所帮助。

首先，我已经使用套接字成功地将单个服务器和单个客户端电话配对。我使用 Android 的 Wi-Fi Direct 技术（[在此处描述](http://developer.android.com/guide/topics/connectivity/wifip2p.html)）来做到这一点。本教程很有帮助，但遗憾的是不是很透彻，特别是在描述一对多连接方面。一旦找到对等列表，就可以打开套接字连接。我能够使用服务器线程连接两个设备（[使用此示例](http://thinkandroid.wordpress.com/2010/03/27/incorporating-socket-programming-into-your-applications/)），如下所示：

```
public class ServerThread implements Runnable {

        public void run() {
             (Code...)
             client = serverSocket.accept();
             (...other code here.)
        }
} 
```

按下按钮后创建了一个客户端（我认为，我仍然试图了解我修改后的代码）：

```
public class MusicClientThread implements Runnable {
     Socket socket = new Socket(serverAddr, port);
     while (connected) {
          //(Other code here.)
          while ((line = in.readLine()) != null) {
          //While there are still messages coming
          }
     }
     socket.close();
     //(Other code here too.)
} 
```

所以我想我的第一个问题是：我将如何允许更多的客户端连接？我的 ServerThread 指的是上面的单个客户端变量，所以我看不到如何允许变化的数量（我的应用程序的目标是 2 到 10 个用户），我也不知道区分所有不同客户端的正确方法。我唯一的猜测是我会使用每部手机的唯一 IP 地址。

我的第二个问题是，一旦我与多个客户/对等方建立了连接，我将如何正确地向他们发送和接收指令？目前，我的单台服务器等待指令，并在收到指令后发出响应指令。我需要它，以便服务器可以从一开始就发送指令，使用按钮按下，并且这些结果在客户端设备上可见。

我希望我已经把一切都说清楚了！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-04T19:57:01.677

您必须为每个客户端启动一个新线程，因为套接字需要一个线程才能运行（因为它大部分时间都在等待输入）。例如，可以这样做（以这种简化的方式）：

```
public class ThreadHandler extends Thread {
      private ArrayList<ServerThread> serverThreads = new ArrayList<ServerThread>();
      public void run() {
            while (!isInterrupted()) { //You should handle interrupts in some way, so that the thread won't keep on forever if you exit the app.
                  (Code...)
                  ServerThread thread = new ServerThread(serverSocket.accept());
                  serverThreads.add(thread);
                  thread.start();
            }
      }
      public void doSomethingOnAllThreads() {
            for (ServerThread serverThread : serverThreads) {
                  serverThread.otherMethod();
            }
      }
} 
```

ServerThread 看起来像这样：

```
public class ServerThread extends Thread {
    private Socket socket;
    public ServerThread(Socket socket) {
          this.socket = socket;
    }
    public void run() {
         (...other code here.)
    }
    public void otherMethod() {
          //Signal to the thread that it needs to do something (which should then be handled in the run method)
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T15:40:11.307

我有一个谷歌电视盒。而且我有两部手机。

在 GoogleTV Box 上，我运行一个服务器。服务器在端口 6001 上有一个 ServerSocket。此外，服务器有两个用于两个客户端的套接字

第一个设备连接到服务器并使用套接字号一个第二个另一个....

我可以同时将来自 2 个设备的不同消息发布到谷歌电视盒插座并在电视上显示。

我使用以下解决方案：

**对于移动客户端（2 台设备）**

创建一个带有空白活动的新android项目并将此代码复制到。为包含编辑文本和按钮的客户端创建布局。确保在 ANDROIDMANIFEST.XML 中设置互联网和访问网络权限！！！并将此文件中的 serverIpAddress 编辑为您的服务器可访问的 IP。

```
package de.android.googletv.gameclient;

import java.io.BufferedWriter;
import java.io.IOException;
import java.io.OutputStreamWriter;
import java.io.PrintWriter;
import java.net.InetAddress;
import java.net.Socket;
import java.net.UnknownHostException;
import java.util.Random;

import android.app.Activity;
import android.os.AsyncTask;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

/**
 * 
 *  
 *
 */
public class FullscreenActivity extends Activity {

    private Socket socket;
    private String serverIpAddress = "192.168.22.253"; // GOOGLE TV IP
    private static final int PLAYER_1_SERVERPORT = 6001; 

    private Button bt;
    private TextView tv;

    String DEVICE_NAME;

    private class ConnectToServer extends AsyncTask {

        @Override
        protected Object doInBackground(Object... params) {

                System.out.println("connecting to server...");

                try {

                     InetAddress serverAddr = InetAddress.getByName(serverIpAddress);
                     socket = new Socket(serverAddr, PLAYER_1_SERVERPORT);

                  } catch (UnknownHostException e1) {
                      System.out.println("ERROR REACHING SERVER! 1");
                     e1.printStackTrace();
                  } catch (IOException e1) {
                      System.out.println("ERROR REACHING SERVER! 2");
                     e1.printStackTrace();
                  }

                System.out.println("Done!");

                return params;
         }

         protected void onPostExecute() {

         }

     }

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.activity_fullscreen);

        DEVICE_NAME = android.os.Build.MODEL;

        Button exit = (Button) findViewById(R.id.dummy_button);
        exit.setOnClickListener(new OnClickListener() {         
            @Override
            public void onClick(View v) {
                System.exit(1);             
            }
        });

        new ConnectToServer().execute("");  

        tv = (TextView) findViewById(R.id.editText1);

        bt = (Button) findViewById(R.id.button1);
        bt.setOnClickListener(new OnClickListener() {
            public void onClick(View v) {
                try {

                   Random rnd = new Random();                  

                   EditText et = (EditText) findViewById(R.id.editText1);
                   String str = DEVICE_NAME + " ID" + rnd.nextInt() + " says: " + et.getText().toString();

                   PrintWriter out = new PrintWriter(
                           new BufferedWriter(
                                   new OutputStreamWriter(
                                           socket.getOutputStream())),true
                                           );
                   out.println(str);

                   Log.d("Client", "Client sent message");

                } 
                catch (UnknownHostException e) {
                   tv.setText("UnknownHostException");
                   e.printStackTrace();
                } 
                catch (IOException e) {
                   tv.setText("IOException");
                   e.printStackTrace();
                } 
                catch (Exception e) {
                   tv.setText("Exception");
                   e.printStackTrace();
                }
             }
        });
    }

} 
```

**对于服务器（谷歌电视盒）**

使用空白活动创建一个新的 android 项目并将此代码复制到。创建一个只有文本字段的布局确保在 ANDROIDMANIFEST.XML 中设置互联网和访问网络权限！！！

```
package de.android.googletv.gameserver;

import java.io.IOException;
import java.net.ServerSocket;
import java.net.Socket;

import android.app.Activity;
import android.os.Bundle;
import android.os.Handler;
import android.os.Message;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.TextView;

/**
 * 
 * 
 *
 */
public class FullscreenActivity extends Activity {

    // server socket
    ServerSocket ss_plr1 = null;
    public static final int SERVERPORT_1 = 6001;

    int nr_connections = 0;

    // socket for player1
    Socket s1;

    // socket for player2
    Socket s2;

    Thread myCommsThread = null;

    protected static final int MSG_ID = 0x1337;
    String mClientMsg = "";

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.activity_fullscreen);

        Button exit = (Button) findViewById(R.id.dummy_button);
        exit.setOnClickListener(new OnClickListener() {         
            @Override
            public void onClick(View v) {
                System.exit(1);             
            }
        });

        TextView tv = (TextView) findViewById(R.id.fullscreen_content);
        tv.setText("Nothing from client yet");

        myCommsThread = new Thread(new CommsThread());
        myCommsThread.start();
    }

    @Override
    protected void onStop() {
        super.onStop();
        try {
            // make sure you close the socket upon exiting
            ss_plr1.close();            
        } 
        catch (IOException e) {e.printStackTrace(); }
    }

    Handler myUpdateHandler = new Handler() {
        public void handleMessage(Message msg) {

            System.out.println("handleMessage("+msg+")");

            switch (msg.what) {

            case MSG_ID:
                TextView tv = (TextView) findViewById(R.id.fullscreen_content);
                tv.setText((String)msg.obj);
                break;

            default:
                break;

            }
            super.handleMessage(msg);
        }
    };

    class CommsThread implements Runnable {

        public void run() {

            System.out.println("creating new sockets...");

            try {

                ss_plr1 = new ServerSocket(SERVERPORT_1 );

                if (s1 == null)
                    s1 = ss_plr1.accept();

                if (s2 == null)
                    s2 = ss_plr1.accept();

            } 
            catch (IOException e) {e.printStackTrace();}

            new Thread(new ConnectionHandler(s1, myUpdateHandler)).start();
            new Thread(new ConnectionHandler(s2, myUpdateHandler)).start();

        }

    }

} 
```

**...服务器需要的是线程消息传递的连接处理程序...**

在服务器项目中创建一个名为“ConnectionHandler.java”的附加类并将此代码复制到其中。它处理异步连接。

```
package de.android.googletv.gameserver;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.Socket;

import android.os.Handler;
import android.os.Message;

public class ConnectionHandler implements Runnable {

    Socket m_socket;
    Handler m_updateHandler;

    public ConnectionHandler(Socket socket, Handler updateHandler) {
        m_socket = socket;
        m_updateHandler = updateHandler;
    }

    @Override
    public void run() {

        while (!Thread.currentThread().isInterrupted()) {

            try {

                BufferedReader input = new BufferedReader(new InputStreamReader(m_socket.getInputStream()));

                String st = null;
                st = input.readLine();

                Message m = new Message();
                m.what = 0x1337;
                m.obj = st;
                m_updateHandler.sendMessage(m);

            } 
            catch (IOException e) { e.printStackTrace();}

        }

    }

} 
```

这不是最好的解决方案。多个“不好”的编码。例如 System.exit(1)。而且它只有两个设备支持。但它适用于不止一种设备，我很确定你会为你的目的修改它。它基于三个网络资源和我自己的其他尝试来使其工作。它只是我的原型....

我无法链接到他们 :( ... 声誉降低。

如果您构建并运行everthing，它应该如下所示：

[https://plus.google.com/u/0/109268217221135029753/posts/3iz6SF1hiJa](https://plus.google.com/u/0/109268217221135029753/posts/3iz6SF1hiJa)

# android - 背景没有出现在android 4.2.2，但出现在2.3

> ID：15209713
> 
> 赞同：4
> 
> 时间：2013-03-04T19:39:05.513
> 
> 标签：android, background, scrollview

我正在尝试制作一个图像作为我在 ScrollView 中的背景。该图像出现在运行于 Galaxy 5 和 Galaxy SII lite 的 Android 2.3 上，但它没有出现在运行于 Galaxy nexus 和 Asus nexus 的 4.2.2 上。

有趣的是，任何其他图像都可以使用，但我想使用的图像却不行。

这是一个 640x2844 尺寸的 PNG 图像。

我正在设置这样的背景：

```
<LinearLayout
    android:id="@+id/ll_flux"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" 
    android:background="@drawable/back_status_marca"
      > 
```

在我的活动中尝试过`setBackgroundResource(R.drawable.back_status_marca)`，但也没有用。

知道如何获得我的背景吗？也就是说，不改变图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:41:17.507

恕我直言，使用如此大的背景图像是个坏主意。如果背景中有渐变，则最好使用点[九补丁图像](http://developer.android.com/tools/help/draw9patch.html)。

这些图像可以随心所欲地缩放。

# php - 通过插件使用 PHP 时没有显示 Wordpress？

> ID：15209717
> 
> 赞同：0
> 
> 时间：2013-03-04T19:39:22.550
> 
> 标签：php, plugins, wordpress

我已经为 Wordpress安装了一个插件（[在帖子中使用 PHP ），但遇到了一些问题。](http://wordpress.org/extend/plugins/allow-php-in-posts-and-pages/)

这是我的代码（尽管我认为这不是问题）

```
$usertoget = $_GET['player'];
$partone = "http://website.co.uk/path/to/php/file.php";
if(strlen($usertoget) != 0) {
    $parttwo = "&player=";
    $partthree = $usertoget;
    $finalurl = $partone . $parttwo . $partthree;
    print '<iframe src="$finalurl"></iframe>';
}
else {
    print "<iframe src='/path/file.php'>";
} 
```

`iframe`完美打印并执行目标文件应执行的操作，但正如您从这张图片中看到的那样，格式混乱：

![页面截图](../Images/99de062c953278da3b08cfebc4d9382b.png)

1.  没有侧边栏；
2.  没有页脚；
3.  没有浮动标题。

我注意到页面源完成了并且除了关闭（ ）`iframe`之外什么都不做。`</body></html>`在它之后有很多东西应该出现但没有出现。

另一个问题是，使用`GET`请求（`/page/hello?player=9`和`/page/hello/?player=9`）返回 404。有什么方法可以解决这个问题？

有人知道我该如何解决这个问题吗？如果需要，我可以发布更多代码:)

任何帮助将不胜感激：D 谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T22:53:48.823

如果 PHP 突然停止发送预期的输出，通常意味着有一个 PHP 错误。你的日志里有什么吗？你试过[打开 WP_DEBUG](http://codex.wordpress.org/Debugging_in_WordPress)吗？

我很惊讶你说 iframe 打印得很完美。这条线

```
print '<iframe src="$finalurl"></iframe>'; 
```

对我来说看起来不对（尽管它不会导致 PHP 出错）。如果字符串周围有单引号，则不会评估变量。有关更多详细信息，请参阅[此问题。](https://stackoverflow.com/questions/2986588/simple-php-dollar-evaluation-in-string-questions)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-27T10:05:23.390

你在 $finalurl 的连接中有错误。你可以检查你的 html 它按原样打印 $finalurl 变量。它没有输出它的值。我已经检查过了。所以你只需要正确连接 $finalurl 变量。这里是你的代码，我已经更正了。

```
$usertoget = $_GET['player'];
$partone = "http://website.co.uk/path/to/php/file.php";
if(strlen($usertoget) != 0) {
    $parttwo = "&player=";
    $partthree = $usertoget;
    $finalurl = $partone . $parttwo . $partthree;
    print '<iframe src='.$finalurl.'></iframe>';
}
else {
    print "<iframe src='/path/file.php'>";
} 
```

如果您有任何疑问，请在下方评论。

# linux - 关闭 bash 变量替换

> ID：15209718
> 
> 赞同：0
> 
> 时间：2013-03-04T19:39:22.907
> 
> 标签：linux, bash

```
function ctrace {
  echo "+ $@"
  "$@"
}

ctrace echo "hi" 
```

我如何让这个函数输出（带引号）：

```
echo "hi" 
```

在这个版本中，引号丢失了`echo hi`......这是另一个例子：

```
a=b
ctrace echo $a 
```

这应该输出`echo $a`而不是`echo b`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:45:07.460

问题不在于函数，而在于调用者。

在第一种情况下，引号在函数获取参数之前被去掉。在第二个中，`$a`替换是在它到达函数之前完成的。

尝试：

```
ctrace 'echo "hi"'
ctrace 'echo $a' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T19:45:35.183

您需要将字符串括在单引号内

```
ctrace 'echo "hi"'
ctrace 'echo $a' 
```

# ios - 将文本添加到自定义后退按钮 iOS

> ID：15209721
> 
> 赞同：0
> 
> 时间：2013-03-04T19:39:27.333
> 
> 标签：ios, uinavigationcontroller

我在导航控制器中有一个带有图像的后退按钮，我想将文本设置在图像顶部。我试过这个，但它似乎没有出现：

```
 UIImage *normalBackImage = [UIImage imageNamed:@"button_tl.png"];
    UIButton *backButton = [UIButton buttonWithType:UIButtonTypeCustom]; backButton.bounds = CGRectMake(0, 0, normalBackImage.size.width, normalBackImage.size.height );
    [backButton setImage:normalBackImage forState:UIControlStateNormal];
    backButton.titleLabel.text = @"Back"; 
```

有谁知道如何做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T19:43:50.447

1.  设置标题的颜色，否则你什么都看不到:)

    *   setTitleColor:forState:

2\. 不要尝试设置图像（即 FOREGROUND 图像）。而是设置背景图像:)

```
– setBackgroundImage:forState: 
```

样本：

```
UIButton *backButton = [UIButton buttonWithType:UIButtonTypeCustom];
backButton.frame = CGRectMake(10, 10, 100, 50);
[backButton setTitleColor:[UIColor blackColor] forState:UIControlStateNormal];
[backButton setTitle:@"Bla" forState:UIControlStateNormal];

UIImage *normalBackImage = [UIImage imageNamed:@"button_tl.png"];
[backButton setBackgroundImage:normalBackImage forState:UIControlStateNormal];

[self.view addSubview:backButton]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T19:44:43.633

您可以创建一个 UILabel 并将其作为子视图添加到您的 UIImage。看起来像这样（在编译器之外编写代码，可能并不完美）

```
UILabel *myLabel = [[UILabel alloc] init];
[myLabel setText:@"My Label Text"];
[image addSubview:myLabel]; 
```

# websocket - websockets 是否可以在 cloudbees 上与 tomcat7 一起使用？

> ID：15209722
> 
> 赞同：0
> 
> 时间：2013-03-04T19:39:27.620
> 
> 标签：websocket, tomcat7, cloudbees

Cloudbees 现在支持 websockets：[http ://wiki.cloudbees.com/bin/view/RUN/WebSockets](http://wiki.cloudbees.com/bin/view/RUN/WebSockets)

我尝试使用 tomcat7 clickStack 在 cloudbees 上实现一个非常简单的测试

您可以在此处看到尝试打开此 websocket 的网页：[http ://wstest.ws.cloudbe.es/](http://wstest.ws.cloudbe.es/)

这在我的机器上工作，但不在 RUN@cloud

我错过了什么吗？tomcat7 clickStack 不支持 websockets？

提前致谢。

我的小服务程序：

```
import java.io.IOException;
import java.nio.ByteBuffer;
import java.nio.CharBuffer;

import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServletRequest;

import org.apache.catalina.websocket.MessageInbound;
import org.apache.catalina.websocket.StreamInbound;
import org.apache.catalina.websocket.WebSocketServlet;
import org.apache.catalina.websocket.WsOutbound;

@WebServlet(urlPatterns = "/testWebsocket")
public class TestWebsocket extends WebSocketServlet {

    private static final long serialVersionUID = 1L;

    @Override
    protected StreamInbound createWebSocketInbound(String string, HttpServletRequest hsr) {
        return new MessageInbound() {
            @Override
            protected void onOpen(WsOutbound outbound) {
                super.onOpen(outbound);
            }

            @Override
            protected void onClose(int status) {
                super.onClose(status);
            }

            @Override
            protected void onBinaryMessage(ByteBuffer bb) throws IOException {
            }

            @Override
            protected void onTextMessage(CharBuffer cb) throws IOException {
                System.out.println(cb.toString());
                WsOutbound outbound = getWsOutbound();
                outbound.writeTextMessage(CharBuffer.wrap((cb.toString()).toCharArray()));
            }
        };
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-18T07:11:51.453

我从未尝试过这种组合，但是afaik这应该可行。您是否在 http 1.1 模式下正确配置了您的路由器？

# javascript - 带取景器的 NVD3 折线图

> ID：15209727
> 
> 赞同：1
> 
> 时间：2013-03-04T19:40:01.677
> 
> 标签：javascript, d3.js, filtering, data-visualization, nvd3.js

任何人都知道是否有办法隐藏取景器，同时仍然让图表显示数据的子集？如果我在将数据发送到图表之前对其进行过滤，则图表线会倾斜而不是连续。

我正在尝试过滤数据的日期范围子集，同时保持线条与整个数据集连续。

我在源代码中注意到，在第 362 行，他们过滤了！d.disabled。我想知道我是否可以以某种方式参与其中。有谁知道这个的正确使用模式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T18:16:13.350

取景器实际上是 Square 的 Crossfilter，如果您想浏览源代码并查看更多文档，请在此处 [0] 找到。

但是，我只会在包含交叉过滤器的 svg 的 CSS 中将 display 属性设置为 none 并完成它。

![交叉过滤器从视图中隐藏，显示：未设置](../Images/45bb88946695048ee8700769c05536ce.png)

[0] [http://square.github.io/crossfilter/](http://square.github.io/crossfilter/)

# c# - 循环依赖问题

> ID：15209728
> 
> 赞同：0
> 
> 时间：2013-03-04T19:40:01.970
> 
> 标签：c#, wcf

我目前正在尝试学习如何创建 WCF 服务，但遇到了一个问题。

我有一个项目，可以调用它`MainProject`，它是一个控制台应用程序，还有一个名为的第二个项目`SoapServer`，它被创建为类库。

`MainProject`不需要引用 ，但`SoapServer`确实`SoapServer`需要引用`MainProject`.

但是，即使现在`MainProject`不需要访问`SoapServer`它，它也是为了让控制台应用程序可以在 WCF 服务上启动主机。

但是，这显然会导致循环依赖，因为我不能让 MainProject 引用 SoapServer，反之亦然。有没有办法解决这个问题。

下面是我如何打开 WCF 服务的连接。

```
public class SoapServer : ISoapServerInterface
    {

        public void startSoapServer()
        {
            Uri baseAddress = new Uri("http://localhost:6525/hello");

            using (ServiceHost host = new ServiceHost(typeof(SoapServer), baseAddress))
            {
                ServiceMetadataBehavior smb = new ServiceMetadataBehavior();
                smb.HttpGetEnabled = true;
                smb.MetadataExporter.PolicyVersion = PolicyVersion.Policy15;
                host.Description.Behaviors.Add(smb);

                host.Open();

                Console.WriteLine("The service is ready at: {0}", baseAddress);
                Console.WriteLine("Press <Enter> to stop the service");
                Console.ReadLine();
                host.Close();

            }
        } 
```

感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:44:01.030

托管应用程序（MainProject）中不应该有太多代码。它仅负责托管服务，这是其唯一目的。**不要在那里放置常用代码。**

而是**使用常用代码创建另一个类库，并从 SoapServer 和 MainProject 创建对它的引用**。

# php - php 函数全局定义变量不适用于 Yii

> ID：15209732
> 
> 赞同：2
> 
> 时间：2013-03-04T19:40:05.433
> 
> 标签：php, yii

我在尝试添加到 Yii 项目中的一些遗留代码时遇到问题。

它与全局变量有关，我很清楚应该将其作为参数传递，但由于这段旧代码用于其他项目，因此重写它并不是真正的选项。

```
$testVar = '123';
function testOutput() {
   global $testVar;
   var_dump($testVar);
}
testOutput(); 
```

现在，如果我将此文件包含在一个普通的 php 文件中，它可以工作并输出

```
string '123' (length=3) 
```

但是如果我将这个文件包含在 Yii 控制器甚至模板中，它会输出这个

```
null 
```

我试图搜索这个问题，但我只是得到一堆关于人们错误地使用全局变量的结果。我确信这实际上不是 Yii 问题，但很可能是 Yii 正在设置的 php_ini 设置，但是在搜索代码或 Yii 文档时我找不到任何可以解释这一点的东西。

这个例子可以通过使用我的第一个代码块创建一个文件来测试，然后将它包含到一个 Yii 模板或控制器中。我什至用一个干净的示例 Yii 项目对其进行了测试。

我希望通过用 Yii 标记这个 questiong 不会损害我解决这个问题的机会，因为我觉得这不仅仅是一个 Yii 特定的问题。

任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T20:27:43.727

如果你这样做，它会工作，我刚刚用 Yii 控制器测试过

```
global $testVar;
$testVar = '123';
function testOutput() {
   global $testVar;
   var_dump($testVar);
}
testOutput(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T19:55:01.913

正如 DCoder 所提到的，如果您在类、函数/方法中声明它们，那么它们不是全局的。您可以尝试将它们分配给 $_GLOBALS 数组：

```
$GLOBALS['testVar'] = 123; 
```

但是，根据遗留代码以及您如何集成它，您可能需要更改该遗留代码中的所有引用以`$GLOBALS['thevar']`代替使用`$thevar`或`extract($GLOBALS)`在部分或全部遗留文件的顶部执行操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T19:48:55.370

谷歌搜索：[Yii 中的全局变量](http://www.yiiframework.com/forum/index.php/topic/13825-global-variables-in-yii/page__p__68111__hl__global+variable#entry68111)

# c# - System.Windows.Forms.TrackBar 内存使用的最大值很大

> ID：15209736
> 
> 赞同：3
> 
> 时间：2013-03-04T19:40:23.720
> 
> 标签：c#, .net, memory, max, trackbar

我有一个包含 System.Windows.Forms.TrackBar 的控件。我将其最大值设置为~200,000,000。当我这样做时，控件需要 800MB 内存。将最大值减少到 2,000,000 使用了更合理的内存量。

```
//trackBar.Maximum = 210554060;  // uses ~800MB of memory
trackBar.Maximum = 1000000;      // uses a small amount of memory 
```

这是 Windows 控件中的错误吗？还是我要求轨迹栏做一些不合理的事情？

**更新：** 我创建了一个新的 Windows 窗体项目，窗体上只有一个轨迹栏。我将最大值设置为 200,000,000。我设置了 TickFrequency 和更改，以便没有数百万个刻度和更改步骤。

当我这样做时，应用程序使用了超过 800MB 的内存。我正在使用 .NET Framework 4。

![trackbar max 设置为 200,000,000，使用 > 800MB 内存](../Images/b70a9d7fa8b1977ba2df51e1e726682a.png).

**更新** 我发现了这个问题的一些解释：[http ://www.tech-archive.net/Archive/DotNet/microsoft.public.dotnet.framework.windowsforms.controls/2006-12/msg00015.html](http://www.tech-archive.net/Archive/DotNet/microsoft.public.dotnet.framework.windowsforms.controls/2006-12/msg00015.html)

**添加链接到测试项目** [https://www.dropbox.com/s/nh6jsymw05feoqn/testingTrackbar.zip?m](https://www.dropbox.com/s/nh6jsymw05feoqn/testingTrackbar.zip?m)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T02:16:56.300

> 这是 Windows 控件中的错误吗？

是的，我认为您可以称其为错误。在平台目标设置为 AnyCPU 的 64 位操作系统上尤其令人讨厌，因此内存分配没有合理的上限。我的机器完全死于鼠标和 Ctrl+Alt+Del 无响应的交换死亡，我硬启动它以使其恢复。谢谢。

实际上有两个错误。它从本机轨迹栏控件开始，没有对刻度数设置合理的上限。通过以正确的顺序分配属性，您可以在设计模式下幸存下来。但是由于 TrackBar 类包装器中的一个缺陷，它在运行时初始化本机控件时在 TickFrequency 属性*之前分配了 Maximum 属性。*所以在很短的时间内它仍然有无数的滴答声。好吧，当它有 20 亿个时，这并不简短，就像我无意中尝试的那样。

没有简单的解决方法，这个错误也不会得到修复。使用合理的值，您始终可以通过乘法映射它们。

# c# - 根据位置批量打开不同的程序

> ID：15209745
> 
> 赞同：0
> 
> 时间：2013-03-04T19:40:59.690
> 
> 标签：c#, batch-file, file-extension, file-type

是否有批处理代码/c# 例如，我有一个动漫文件夹和一个电影文件夹，我想用程序 A 观看动画，用程序 B 观看电影。
有没有办法获得相同的文件类型（.mkv /.avi/.mp4) 以根据其文件夹/硬盘驱动器位置使用不同的程序打开？
我假设我必须设置所有视频文件类型才能打开这批，但我不知道要输入的参数。
谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:48:49.073

如果你找到了你的文件，你可以为它创建一个 FileInfo 对象，并通过以下方式检查它的目录路径：

```
FileInfo file = new FileInfo(@"c:\Anime\Anime.avi"); 
string dirPath = file.DirectoryName;

if (dirPath == @"c:\Anime")
{
  //Open with VLC
}
else if (dirPath == ...something else...)
{
  //Open with something else
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T20:59:22.747

您可以编写一个批处理文件，根据该文件夹启动相应的应用程序，如下所示：

```
IF /I "%~dp1"=="C:\anime\" programA.exe %*
IF /I "%~dp1"=="C:\movie\" programB.exe %* 
```

然后右键单击您的一个文件并选择**Open With - Choose Default Program**，然后浏览到您刚刚创建的 .bat 文件。确保选中“**始终使用所选程序打开此类文件**”复选框。

从现在开始，您只需双击该文件即可启动正确的程序。

# java - R.java 类出错，未找到布局但存在于 R.java 中

> ID：15209746
> 
> 赞同：0
> 
> 时间：2013-03-04T19:41:07.090
> 
> 标签：java, android, eclipse

好吧，首先我很抱歉，但我的英语不是很好，因为我是法国人......我在 Eclipse 上工作一个 android 项目 (pong) 所以，当我写的时候，我的活动有问题：setContentView( R.layout.menu); 我有一个错误说：菜单无法解析或不是字段事实是......这是一个文件！我去了 R.java 并看到了它，但错误并没有消失。（我已经清理并构建了很多次项目，它仍然无法正常工作）我已经拍摄了一些屏幕;-)

[http://imageshack.us/photo/my-images/4/erreurmenupong1.png/](http://imageshack.us/photo/my-images/4/erreurmenupong1.png/) （在 Menu.java 中） [http://imageshack.us/photo/my-images/62/erreurmenupong2.png/](http://imageshack.us/photo/my-images/62/erreurmenupong2.png/) （在R.java)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T22:51:59.190

从您的导入中删除“android.R”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T22:49:20.187

我有同样的问题。我解决了这个问题，购买了一个新的工作空间并在那里导入了我所有的 android 项目。

# java - uri.getQueryParameter("oauth_verifier") 始终为空

> ID：15209747
> 
> 赞同：0
> 
> 时间：2013-03-04T19:41:11.037
> 
> 标签：java, android, oauth, signpost

我是 OAuth 的新手，我正在开发一个需要它的 Android 应用程序，并且我正在使用路标库。

我相信我已经完成了所有工作，直到可以使用

```
String token = uri.getQueryParameter("oauth_token"); 
```

哪个正确返回但是下一行

```
String verifier = uri.getQueryParameter("oauth_verifier"); 
```

返回空值。我已经调试并检查了初始化为的uri

```
 Uri uri = this.getIntent().getData(); 
```

而且它似乎没有密钥“oauth_verifier”

当我尝试以下行时，验证程序为 null 会导致 OAuthExpectationFailedException

```
provider.retrieveAccessToken(consumer, verifier); 
```

谁能帮我弄清楚为什么验证者为空我使用的是回调而不是OOB。

我在其他问题中看到过，并在回复中指导了这样的事情：

```
dat=myapp://twitter?oauth_token=tJpJHOOwoTGMwdvHyYbfX2tyHKOp0Y2kdRRZf3sM&
oauth_verifier=xc49oM8eVVmK46ZSLz2RMT2uqXn3SxrMxf5ZAMXaD2Y 
```

我的类似，但没有 ouath_verifier 密钥。

这是我发送有效的初始意图并获得回报的地方

```
 String clientKey = "xxxxxxx";
        String clientSecret = "yyyyyyyyy";

        CommonsHttpOAuthConsumer  consumer = new CommonsHttpOAuthConsumer(clientKey,clientSecret);

        provider = new CommonsHttpOAuthProvider(URL_Request_Token,
                URL_Access_Token, 
                URL_Authorize";
        provider.setOAuth10a(true);

        try {
            String authUrl = provider.retrieveRequestToken(consumer,CALLBACK_URI.toString());

            String token = consumer.getToken(); 
            String secret = consumer.getTokenSecret();

            this.startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse(authUrl)));
         } 
```

任何帮助深表感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:22:21.440

我在开发 twitter 交互示例时遇到的一个问题是我忘记从 twitter 应用程序控制台设置回调 url。

![在此处输入图像描述](../Images/42e985a41c0374d828214e609a128b7e.png)

如果您不这样做，您的应用程序将不会被重定向，因此它将无法获取验证者令牌。

促销模式开启

但是，如果你觉得特别勇敢，我最近一直在开发这个库[PostManLib](https://github.com/fedepaol/PostmanLib--Rings-Twice--Android)，我正在寻找 beta 测试人员。它应该在底层使用众所周知的 scribe 库来处理所有异步 oauth 交互。

促销模式关闭

# java - 将数据写入文件

> ID：15209748
> 
> 赞同：-1
> 
> 时间：2013-03-04T19:41:16.400
> 
> 标签：java, android

我想从我的应用程序内部创建一个文件夹。在文件夹中，我只想创建一个文件（比如*recents*），应用程序将在每次启动时逐行写入数据。

```
private void saveForRecents(String phoneNumber) {
    //Need to open File and write the phonenumbers that has been passed into it
    try{    
        File mydir = getDir("recents", 0); 

        //Creating an internal dir;
        File fileWithinMyDir = new File(mydir, "recents"); 

        //Getting a file within the dir.
        FileWriter fw = new FileWriter(fileWithinMyDir.getAbsoluteFile());

        BufferedWriter bw = new BufferedWriter(fw);
        bw.write(phoneNumber);
        bw.newLine();
        bw.flush();
        bw.close();

    }catch(Exception e){
        Toast.makeText(getApplicationContext(), "Failed to write into the file", Toast.LENGTH_LONG).show();
    }
} 
```

如何访问我的目录*mydir中的**最新*文件的内容？我想在逐行写入数据时逐行访问数据。如果有人花时间向我解释如何做，我将非常感激，因为我需要学习它。如果我做错了什么，请告诉我。

 ** * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T20:18:29.390

根据您所做的，我认为使用 SharedPreferences 是一种更好的方法。它不会被其他人覆盖，并且不会被文件资源管理器中的其他人所掩盖。这是一个简单的示例，假设您在某种数组中拥有最近的电话号码。当然其他方法也是可以的。

```
SharedPreferences Prefs = getSharedPreferences("RecentPhoneNumbers", MODE_PRIVATE);
Editor e = Prefs.edit();
e.clear();

for (String s : RecentPhoneArray)
{
   e.putString(s);
}
e.commit(); 
```

然后在下次应用程序启动或需要重新加载时加载它们：

```
SharedPreferences Prefs = getSharedPreferences("RecentPhoneNumbers", MODE_PRIVATE);
for (Map.Entry<String, ?> entry : Prefs.getAll().entrySet())
{
   String s = entry.getValue().toString();
   RecentPhoneArray.add(s);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T05:10:53.633

很长一段时间后，我发现了问题的第二部分。如果其他用户遇到相同的问题，这可能对他们有用。

用于制作自定义目录（此处为*recents*）和自定义文件（此处为*recent*）

```
try
{
      File mydir = getDir("recents", 0); 
      File fileWithinMyDir = new File(mydir, "recent"); 
      //true here lets the data to be added in the same file in the next line
      // No value at all or a false will overwrite the file
      FileWriter fw = new FileWriter(fileWithinMyDir.getAbsoluteFile(), true);
      BufferedWriter bw = new BufferedWriter(fw);
      bw.write("Anything you want to write");
      bw.newLine();
      bw.flush();

    bw.close();

    }catch(Exception e){

    Toast.makeText(getApplicationContext(), "Failed to write into the file", Toast.LENGTH_LONG).show();
} 
```

以下代码有助于读取同一目录（此处为*recents ）内的相同文件（此处为**recent*）

 *```
try 
{

    File mydir = this.getDir("recents", 0);
    File fileWithinMyDir = new File(mydir, "recent");
    try 
    {
    // open the file for reading
    InputStream instream = new FileInputStream(fileWithinMyDir);

    if (instream != null)
    {
        // prepare the file for reading
        InputStreamReader inputreader = new InputStreamReader(instream);
        BufferedReader buffreader = new BufferedReader(inputreader);

        String line;

        while ((line = buffreader.readLine())!= null)
        {

        // do something with the line 

        }

        instream.close();
    }
    } 
    catch (Exception ex) 
    {
    // print stack trace.
    } 
    finally 
    {
    // close the file.

    }
}
catch(Exception e)
{
    e.printStackTrace();
} 
```

需要注意的重要一点是，如果一个目录***最近****在此处*并且其中的文件***最近****在此处*不存在，那么它将在第一次运行时自动创建。从第二次运行开始，它将开始引用它，而不是重新创建整个事物......

**希望对部分用户有所帮助****

# c# - 在运行时设置实体框架连接字符串

> ID：15209754
> 
> 赞同：1
> 
> 时间：2013-03-04T19:41:33.443
> 
> 标签：c#, entity-framework-4, connection-string

我已经从 AdventureWorks 数据库生成了实体模型；现在我想删除 app.config 中的连接字符串并在运行时设置它。在 Model1.Context.cs 文件中，我将构造函数更改为

```
public AdventureWorksEntities(string str)
        : base("name=AdventureWorksEntities")
    {
        this.Database.Connection.ConnectionString = str;
    } 
```

并在 program.cs 文件中

```
EntityConnectionStringBuilder ecsb = new EntityConnectionStringBuilder();
        ecsb.Metadata = @"res://*/Model1.csdl|res://*/Model1.ssdl|res://*/Model1.msl";
        ecsb.Provider = @"System.Data.SqlClient";
        ecsb.ProviderConnectionString =
            @"data source=.\sqlexpress;initial catalog=AdventureWorks;integrated security=True;MultipleActiveResultSets=True;App=EntityFramework";

        using (var ent = new AdventureWorksEntities(ecsb.ConnectionString))
        {
            Console.WriteLine(ent.Database.Connection.ConnectionString);
            var add = ent.Addresses;
            foreach (var ad in add)
            {
                Console.WriteLine(ad.City);
            }

        }
        Console.ReadKey(); 
```

现在它说找不到元数据关键字。如何在运行时为实体框架设置连接字符串？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-08-13T11:02:31.570

这是一个使用标准 .aspx 登录信息来设置连接字符串中的用户 ID 和密码信息的示例。没有连接字符串设置存储在 web.config 或 app.config 文件中。

修改 Model.Designer.cs 页面如下：

```
public partial class Entities : ObjectContext
{
    #region Constructors

    public static string getConStrSQL(string UID,string PWD)
    {

        string connectionString = new System.Data.EntityClient.EntityConnectionStringBuilder
        {
            Metadata = "res://*",
            Provider = "System.Data.SqlClient",
            ProviderConnectionString = new System.Data.SqlClient.SqlConnectionStringBuilder
            {
                InitialCatalog = "your_database_name",
                DataSource = "your_server",
                IntegratedSecurity = false,
                UserID = UID,                
                Password = PWD,              
            }.ConnectionString
        }.ConnectionString;

        return connectionString;
    }

    /// <summary>
    /// Initialize a new Entities object.
    /// </summary>
    public Entities(string UID,string PWD)
        : base(getConStrSQL(UID,PWD), "Entities")
    {
        this.ContextOptions.LazyLoadingEnabled = true;
        OnContextCreated();
    }
    ...... 
```

然后在页面后面的代码中：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.Mvc;
using System.Web.Security;

public partial class views_html_form : System.Web.UI.Page
{
public void Page_Load()
{
    if (currentUser() == null)
    {
        HttpContext.Current.Response.Redirect("~/login.aspx");
    }
}
public static MembershipUser currentUser()
{
    MembershipUser currentUser = Membership.GetUser();
    return currentUser;
}

public static string UID()
{
    string UID = currentUser().UserName;
    return UID;
}
public static string PWD()
{
    string PWD = currentUser().GetPassword();
    return PWD;
}
public static void SelectRecord()
{
    YourModel.Entities db = new YourModel.Entities(UID(), PWD());
    var query = from rows in db.Table_Name orderby rows.ID select rows;
   ..... 
```

而已。不要乱用 .config 文件。或者，您可以发送数据库名称，例如，以相同方式作为参数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-15T15:25:09.003

我会选择类似的东西：

```
 public AdventureWorksEntities(string server, string databaseName, string user, string password)
        :base(new System.Data.EntityClient.EntityConnectionStringBuilder
        {
            Metadata = "res://*",
            Provider = "System.Data.SqlClient",
            ProviderConnectionString = new System.Data.SqlClient.SqlConnectionStringBuilder 
            {
                InitialCatalog = databaseName,
                DataSource = server,
                IntegratedSecurity = false,
                UserID = user,
                Password = password,

            }.ConnectionString
        }.ConnectionString) 
    {

    } 
```

# c++ - 指向模板函数的空指针

> ID：15209759
> 
> 赞同：1
> 
> 时间：2013-03-04T19:42:04.907
> 
> 标签：c++, templates, pointers, void

假设这不是我管理的模板函数：

```
template<class T, class U>
U templatefunc(T t){ //(...); } 
```

我可以有一个默认参数是模板函数类型的函数吗

```
templatefunc<int,double> 
```

那么如何声明 void 指针，所以我可以这样做：

```
void _new_func( const void*=&templatefunc<int,double>) 
```

我认为不，因为你不能有指向函数的 void 指针，它必须是函数指针，对吗？

以前是：

```
void _new_func(const void* = boost::test_tools::check_is_close) 
```

但是使用 boost 1.54 就不行了，因为 check_is_close 是模板。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:49:15.993

模板函数实例化是一个函数，因此您可以对函数执行任何操作，也可以对模板函数实例化执行任何操作。`void*`但是，无论该函数是普通函数还是模板函数实例化，都不能将函数的地址可移植地存储在 a 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T19:50:26.180

的类型`&templatefunc<int,double>`是指向函数的指针，该函数返回`double`并接受一个类型的参数`int`。模板参数不再重要 -`templatefunc<int,double>`只是（实例化）函数的名称。所以你可以有：

```
void _new_func(double(*func)(int) = &templatefunc<int,double>) 
```

但是，您似乎想要采用具有不同参数和返回类型的函数。在这种情况下，您可能会在不传递任何参数的情况下出现重载：

```
template <typename T, typename U>
void _new_func(U(*func)(T)) {
}

void _new_func() {
  _new_func(&templatefunc<int,double>);
} 
```

现在您可以调用`_new_func()`，它会将函数指针传递`&templatefunc<int,double>`给模板化版本。当你想`_new_func`用不同的实例化调用时`templatefunc`，你可以，例如，做：

```
__new_func(&templatefunc<float, double>); 
```

# visual-studio-2010 - VS 2010 数据库项目和由“select into”创建的表

> ID：15209762
> 
> 赞同：1
> 
> 时间：2013-03-04T19:42:06.837
> 
> 标签：visual-studio-2010, database-project

我正在尝试将现有数据库移动到 VS 2010 数据库项目中。这个数据库已经存在了很长时间，并且有很多存储过程。许多这些存储过程使用 SELECT ... INTO 语法创建工作表。当时这样做是为了减少通过事务日志的数据量。当我将数据库导入项目时，我取消了工作表。现在，当我查看警告时，我看到我所有的存储过程都说他们找不到工作表。有没有人有办法处理这个？我正在尽可能地减慢转换到 SSIS 的速度，但是在存储过程中必须提醒一些逻辑。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-01T15:10:12.867

在这种情况下，您要么必须忽略警告，要么导入存储过程工作绝对需要的那些工作表。如果表不存在，我认为项目不会正确构建，但这是预期的。

如果这些表已经存在于数据库中，你应该没问题，因为它们不会被重新创建。您可以在清理存储过程时慢慢弃用它们。

# ms-access - 将新数据分配给已经存在的主键

> ID：15209765
> 
> 赞同：1
> 
> 时间：2013-03-04T19:42:08.707
> 
> 标签：ms-access

我有一个电话交换机的命令数据库，表之间的关系是这样的； ![关系切换数据库](../Images/f908e6066a43efc2e48e2b3aff0dfe88.png)

我遇到的问题是当我使用我设计的表格时； ![数据表格](../Images/89681bbbee41d97f2e94f64e239e8721.png)

用于查看和输入数据。我必须将表单上的数据分配给一个覆盖 ID，它是覆盖中的主键。我知道当我输入新数据并输入相关的覆盖 ID 时表单正在尝试做什么，它正在尝试将覆盖 ID 添加为新的覆盖 ID，但覆盖 ID 已经存在，因此它不能复制 ID。

我只需要知道如何获取我的表单以允许我选择已经存在的覆盖 ID（以及相关的链接覆盖 ID）并分配我试图添加到其中的信息？

我知道我可以使用组合框，但是当我这样做时，它会更改其他记录，当在表单上时，没有覆盖 ID，并且当您将组合框中的覆盖 ID 设置回原始正确 ID 时，它只会更改其余记录到该 ID。

这是一个大学项目，需要至少 3 个实体（表），因此为什么会有一些可以说是不必要的表。

这可能只是一个愚蠢的问题，但是我完全盲目地进入了这个项目，对访问没有太多了解，现在没有人可以提供帮助！

叠加层就像交换机操作系统的一部分，允许您执行某些命令，因此某些命令可以在某个叠加层中使用，并且该叠加层将与选择的几个叠加层链接，这些叠加层也可以执行一些相同的命令.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T15:59:14.373

事实证明它并不像我想象的那么复杂，基本上我正在处理一个未绑定的表单（或者更确切地说，它绑定到一个包含所有相关字段的查询）。

如果我想像上面描述的那样针对另一个表的主键添加一条记录，我需要将表单绑定到 PlainTextFunction 表，该表包含要分配给 PK 的信息。这使我可以更改 PTF 表记录上的 FK，从而将其链接到所需的覆盖 ID，而无需更改或添加新的 PK。嗬！

所以澄清一下；为此，您要编辑需要在另一个表的 PK 下分类的记录的外键。从某种意义上说，这会将输入的记录分配给另一个表中的 PK。

# java - 为什么 JTextField.setText 会在 changedUpdate() 之前触发 DocumentListener 的 removeUpdate()？

> ID：15209766
> 
> 赞同：7
> 
> 时间：2013-03-04T19:42:14.613
> 
> 标签：java, swing, jtextfield

这是我的代码：

```
import javax.swing.*;
import javax.swing.event.DocumentEvent;
import javax.swing.event.DocumentListener;
import javax.swing.text.Document;
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

public class Frame extends JFrame {

    private JTextField txt1 = new JTextField(10);
    private JTextField txt2 = new JTextField(10);
    private JButton btn = new JButton("Set Text");

    public Frame() {
        super("Latihan");
        setLayout(new FlowLayout());
        btn.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                txt1.setText("TEST"); txt2.setText("TEST2");
            }
        });

        txt1.getDocument().addDocumentListener(new TheDocumentListener("txt1"));
        txt2.getDocument().addDocumentListener(new TheDocumentListener("txt2"));

        add(txt1);
        add(txt2);
        add(btn);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        pack();
        setVisible(true);
    }

    public static void main (String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new Frame();
            }
        });
    }
}

class TheDocumentListener implements DocumentListener {

    private String source;

    public TheDocumentListener(String source) {
        this.source = source;
    }
    @Override
    public void insertUpdate(DocumentEvent e) {
        System.out.println("insertUpdate from " + source);
    }

    @Override
    public void removeUpdate(DocumentEvent e) {
        System.out.println("removeUpdate from " + source);
    }

    @Override
    public void changedUpdate(DocumentEvent e) {
        System.out.println("changedUpdate from " + source);
    }
} 
```

当我第一次单击 JButton 时，只会`insertUpdate()`调用：

```
insertUpdate from txt1
insertUpdate from txt2 
```

但是如果我再次单击该按钮，`removeUpdate()`将在之前调用`insertUpdate()`：

```
removeUpdate from txt1
insertUpdate from txt1
removeUpdate from txt2
insertUpdate from txt2 
```

这是预期的行为还是我的代码有问题？

我可以制作`insertUpdate`执行时调用的唯一方法`JTextField.setText`吗？我想确保`removeUpdate`仅在用户删除文本字段中的文本时才被调用。怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T00:41:17.023

这是字符串替换的预期行为。实际上所做的是`setText()`删除整个字符串并设置一个新字符串。这里是实现`JTextField.setText()`：

```
public void setText(String t) {
    try {
        Document doc = getDocument();
        if (doc instanceof AbstractDocument) {
            ((AbstractDocument)doc).replace(0, doc.getLength(), t,null);
        }
        else {
            doc.remove(0, doc.getLength());
            doc.insertString(0, t, null);
        }
    } catch (BadLocationException e) {
    UIManager.getLookAndFeel().provideErrorFeedback(JTextComponent.this);
    }
} 
```

如您所见，`AbstractDocument.replace()`为`AbstractDocument`文档执行。否则，`remove()`和`insert()`被执行。

从[AbstractDocument.replace()](http://docs.oracle.com/javase/6/docs/api/javax/swing/text/AbstractDocument.html#replace%28int,%20int,%20java.lang.String,%20javax.swing.text.AttributeSet%29)文档：

> 删除从偏移到偏移+长度的文本区域，并将其替换为文本。这取决于实现如何实现，一些实现可能将其视为两个不同的操作：删除后跟插入，其他可能将替换视为一个原子操作。

所以这取决于文档的实现。`PlainDocument`例如继承`AbstractDocument`. A`PlainDocument`是文本字段的默认文档。

如果需要，您可以随时创建自己的文档实现，或者安装文档过滤器。有关详细信息，请参阅[使用文本组件](http://docs.oracle.com/javase/tutorial/uiswing/components/text.html)教程。但不确定，您试图实现的这种行为改变背后的原因是什么。

# ios - iOS按钮背景图像与图像

> ID：15209769
> 
> 赞同：0
> 
> 时间：2013-03-04T19:42:25.447
> 
> 标签：ios

对于一个按钮，我看到 2 个字段：背景图像和图像。背景图像允许在其上放置文本的唯一区别是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-04T19:49:11.393

这些图像有不同的用途。

`backgroundImage`是按钮的图形表示。此图像通常表示按钮的不同可能状态（正常、选定、突出显示），并且通常是可拉伸的（水平和/或垂直）以适用于不同的按钮大小。

`image`是按钮内的内容，是属性的图形类比`text`。

一个常见的使用模式是为`backgroundImage`应用程序中的多个按钮使用相同的主题以获得一致的主题，但`images`根据每个按钮的上下文含义使用不同的按钮。

此外，`backgroundImage`不用于布局计算。例如，`[myButton sizeToFit]`将考虑`image`但不考虑`backgroundImage`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T19:45:19.877

是的，这是我知道的唯一区别

# android - 将 Facebook 集成到 android - 登录权限

> ID：15209787
> 
> 赞同：0
> 
> 时间：2013-03-04T19:43:51.120
> 
> 标签：android, facebook, authentication, login, permissions

我正在将 Facebook 登录集成到我正在开发的 android 应用程序中。

我希望该应用程序被授权发布/发布到提要/时间线。目前，用户正在接收两个登录权限屏幕（一个用于初始登录，另一个用于发布权限）。这不是理想的用户体验。

当应用程序要求用户登录 Facebook 时，如何将发帖权限合并到出现的权限屏幕中。

经过一些研究，其他应用程序似乎可以在登录时获得身份验证，并且不需要重新登录权限屏幕即可显示包含发布权限的内容。

我显然错过了一些东西。

请帮忙！

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T20:14:05.380

可能的副本：[适用于 Android 的 Facebook SSO 我可以一次请求登录和许可吗](https://stackoverflow.com/questions/13312163/facebook-sso-for-android-can-i-ask-for-login-and-permission-all-in-one-time)

底线是：“使用新的 SDK，您需要与读取权限分开请求写入权限（例如“publish_actions”）”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T20:08:49.433

正如你所说，这不是一个理想的用户体验，我使用类似的方式来实现使用 sdk facebook 的用户登录，我按照[本](https://developers.facebook.com/docs/tutorials/androidsdk/3.0/scrumptious/authenticate/)教程进行操作，它应该只向用户显示一个登录，然后是一个显示发布权限的屏幕，而无需再次登录。

这个

# mysql - MySQL INSERT INTO ... SELECT ... GROUP BY 太慢了

> ID：15209791
> 
> 赞同：1
> 
> 时间：2013-03-04T19:44:05.427
> 
> 标签：mysql, select, sql-insert

我有一个大约 50M 行和格式的表格：

```
CREATE TABLE `big_table` (
  `id` BIGINT NOT NULL,
  `t1` DATETIME NOT NULL,
  `a` BIGINT NOT NULL,
  `type` VARCHAR(10) NOT NULL,
  `b` BIGINT NOT NULL,
  `is_c` BOOLEAN NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `a_b_index` (a,b)
) ENGINE=InnoDB; 
```

然后我定义 table `t2`，没有索引：

```
Create table `t2` (
  `id` BIGINT NOT NULL,
  `a` BIGINT NOT NULL,
  `b` BIGINT NOT NULL,
  `t1min` DATETIME NOT NULL
 ) ENGINE=InnoDB DEFAULT CHARSET=latin1; 
```

`t2`然后我使用来自的查询进行填充`big_table`（这将添加大约 12M 行）。

```
insert into opportunities
  (id, a,b,t1min)
  SELECT id,a,b,min(t1)
    FROM big_table use index (a_b_index)
    where type='SUBMIT' and is_c=1
   GROUP BY a,b; 
```

我发现这个查询需要大约一分钟来处理 5000 个不同`(a,b)`的`big_table`.
由于有 12M 不同`(a,b)`，`big_table`因此在所有`big_table`.

出了什么问题？

如果我只是这样做，`SELECT ...`那么查询会在大约 2 秒内完成 5000 行。如果 I `SELECT ... INTO OUTFILE ...`，那么对于 5000 行，查询仍然需要 60 秒。

`EXPLAIN SELECT ...`给出：

```
id,select_type,table,type,possible_keys,key,key_len,ref,rows,Extra
1,SIMPLE,stdnt_intctn_t,index,NULL,a_b_index,16,NULL,46214255,"Using where" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T06:55:39.593

我发现问题在于`GROUP_BY`导致对`big_table`. 以下策略允许通过`big_table`. 首先，我们添加一个键`t2`：

```
Create table `t2` (
  `id` BIGINT NOT NULL,
  `a` BIGINT NOT NULL,
  `b` BIGINT NOT NULL,
  `t1min` DATETIME NOT NULL,
  PRIMARY KEY (a,b),
  INDEX `id` (id)
) ENGINE=InnoDB DEFAULT CHARSET=latin1; 
```

然后我们填充`t2`使用：

```
insert into t2
  (id, a,b,t1min)
  SELECT id,a,b,t1
    FROM big_table
    where type='SUBMIT' and is_c=1
 ON DUPLICATE KEY UPDATE 
   t1min=if(t1<t1min,t1,t1min),
   id=if(t1<t1min,big_table.id,t2.id); 
```

由此产生的加速是几个数量级。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T20:40:28.123

group by 可能是问题的一部分。您正在 (a,b) 上使用索引，但未使用您的位置。我会有一个索引

（类型，is_c，a，b）

此外，您正在获得“ID”，但没有指定哪个......您可能想要执行 MIN(ID) 以获得一致的结果。

# rsync - rsync 无法解释的错误（代码 129）

> ID：15209794
> 
> 赞同：2
> 
> 时间：2013-03-04T19:44:10.717
> 
> 标签：rsync

我正在尝试将数据从一台服务器同步到另一台服务器，大约 1.1T 的数据，但是当我进行 rsync 时，我在传输终止过程的过程中遇到异常。

rsync 错误：rsync.c(541) [sender=3.0.7] 处出现无法解释的错误（代码 129）

nohup rsync -r -t -v -o -g -p -c -l -z /source/images/ranker root@xx.xxxx.xxx.xx:/mnt/source/images &

# .htaccess - htaccess 子目录 URLS 到根目录

> ID：15209795
> 
> 赞同：1
> 
> 时间：2013-03-04T19:44:16.133
> 
> 标签：.htaccess, redirect

我想将子目录中的所有文件重定向到它们的新根 URL。

旧网址是

```
www.domain.com/subdirectory/filename-here.html 
```

新位置是

```
www.domain.com/filename.here.html 
```

旧 URL 已在 Google 中列出，需要对这些 URL 进行某种重定向。我确定 htaccess 是去这里的方式，但不确定解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:57:54.137

```
RewriteEngine on
RewriteRule %{REQUEST_URI} ^/subdirectory/.*
RewriteRule subdirectory/(.*)$ /$1 [R=301,L] 
```

[在这里](http://htaccess.madewithlove.be/)测试。如果它不起作用 - 以`[^/]`这种方式添加屏蔽：`[^\/]`

# javascript - 从 SQL 获取数据到 Leaflet

> ID：15209796
> 
> 赞同：5
> 
> 时间：2013-03-04T19:44:16.473
> 
> 标签：javascript, sql, leaflet

我正在尝试从数据库中提取数据，然后使用 Leaflet 对其进行映射。我的直觉是，直接用 Javascript 查询我的数据库不是一个好主意（因为我发现另一个 stackoverflow 答案说“这不是一个好主意），但我不确定有什么好的选择。

我对 Javascript（和 Leaflet）非常陌生，并且对 SQL 有一定的了解。如果我需要制作一些中间查询页面，我确实知道一些 PHP 和 XML（然后 Leaflet 会获取该信息......？）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T02:03:43.777

除了使用 javascript 从您的数据库中直接查询的问题...

从数据库中获取数据后，您将需要遍历每个数据点并将其添加到地图中。例如，如果您的“中间查询页面”返回 JSON 格式的对象，那么您可以执行以下操作：

```
$.getJSON('path-to/intermediate-querying-page.php', function(data) {

    $.each(data, function(key, place) {
        var marker = L.marker([place.latitude, place.longitude]).addTo(map);
    });

}); 
```

# authentication - 在 WebAPI 中，FormsAuthentication 似乎不记得 cookie

> ID：15209805
> 
> 赞同：0
> 
> 时间：2013-03-04T19:44:45.697
> 
> 标签：authentication, asp.net-mvc-4, asp.net-web-api

在我的 webAPI 中，我调用了控制器

```
FormsAuthentication.SetAuthCookie(login.Username, true); 
```

但饼干似乎没有设置。

有没有办法在 webAPI 中发生这种情况？我知道有知道 system.web 所以也许这是我的问题（但电话在那里）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T02:59:28.407

SimonC 用 Auth Mode 击中了它的头部

# matlab - 制作多对角矩阵的有效方法

> ID：15209806
> 
> 赞同：2
> 
> 时间：2013-03-04T19:44:46.397
> 
> 标签：matlab, matrix, diagonal

有没有一种有效的方法来产生方形多对角矩阵，例如：

```
[[1,2,3],
 [2,1,2],
 [3,2,1]]

[[1,2,3,4,5],
 [2,1,2,3,4],
 [3,2,1,2,3],
 [4,3,2,1,2],
 [5,4,3,2,1]] 
```

到目前为止，我的努力产生了以下结果：

```
t=10
sum=zeros(t,t)
for i=1:t
 sum+=diag(ones(1,i)*(t-i)+1,t-i);
end
sum
sum+sum'-diag(ones(1,10),0) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T20:03:20.577

该命令`toeplitz`完全符合您的要求：

```
toeplitz([1,2,3,4,5,6])

ans =

 1     2     3     4     5     6
 2     1     2     3     4     5
 3     2     1     2     3     4
 4     3     2     1     2     3
 5     4     3     2     1     2
 6     5     4     3     2     1 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-04T20:01:52.000

您正在寻找的东西称为对称（Hermitian）toeplitz 矩阵。

我不熟悉matlab，但我在mathworks上找到[了这个文档：](http://www.mathworks.com/help/dsp/ref/toeplitz.html)

# delphi - 如何在 Delphi XE2 的应用程序中通过 A-link（A-keyword）调用上下文帮助？

> ID：15209807
> 
> 赞同：0
> 
> 时间：2013-03-04T19:44:48.863
> 
> 标签：delphi, delphi-xe2, help-system

如何在 Delphi XE2 的应用程序中通过 A-link（A-keyword）调用上下文帮助？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T18:22:14.057

您只需要这个功能：

```
procedure ShowHelpALink(const HelpFile, ALink: string);
var
  Link: THH_AKLink;
begin
  ZeroMemory(@Link, SizeOf(Link));
  Link.cbStruct := SizeOf(Link);
  Link.pszKeywords := PChar(AnsiString(ALink));
  Link.fIndexOnFail := True;
  HtmlHelp(GetDesktopWindow, HelpFile, HH_ALINK_LOOKUP, DWORD_PTR(@Link));
end; 
```

由于某种原因`HtmlHelp`，将记录中的字符串解释`THH_AKLink`为 ANSI 字符串。我找不到任何关于此的文档。我怀疑这只是 HtmlHelp 文件库中的一个错误。我认为你传入的字符串`THH_AKLink`必须是ANSI字符串。

# php - 从另一个数组中删除一个数组的值

> ID：15209810
> 
> 赞同：0
> 
> 时间：2013-03-04T19:45:05.113
> 
> 标签：php, arrays

假设我有这两个数组：

```
$arraryA = array(10587,10590,10598,10592,10602,10604,10607);

$arrayB = array(10590); 
```

我所知道的是，

1.  $arrayB 的值总是来自 $arrayA 的元素
2.  $arrayB 可能有一个或多个元素

我需要从 $arrayA 中删除 $arrayB 的值。

意味着，我需要一个新数组：

$arrayC = 数组（10587,10598,10592,10602,10604,10607）；

如果`$arrayB = array(10590, 10604)`， $arrayC 将是：

```
$arrayC = array(10587,10598,10592,10602,10607); 
```

任何的想法 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T19:46:48.807

采用[`array_diff()`](http://www.php.net/manual/en/function.array-diff.php)

```
$arrayC= array_diff($arrayA, $arrayB); 
```

**示例**：

```
$arrayA = array(10587,10590,10598,10592,10602,10604,10607);
$arrayB  = array(10590);
$arrayC  = array_diff($arrayA, $arrayB);

var_dump($arrayC);

// array(6) { [0]=> int(10587) [2]=> int(10598) [3]=> int(10592) [4]=> int(10602) [5]=> int(10604) [6]=> int(10607) } 
```

[看到它在行动](http://codepad.viper-7.com/gthuPV)

# css - 当子项被限制到不同的资源组时，如何将容器文件夹设置为非容器？

> ID：15209814
> 
> 赞同：0
> 
> 时间：2013-03-04T19:45:11.877
> 
> 标签：css, modx, zurb-foundation, modx-revolution

正如标题所说，“当子项被限制到不同的资源组时，如何将容器文件夹设置为非容器”？

我正在使用foundation 3框架，并且由于用户未登录而无法填充下拉菜单和弹出菜单时遇到了一些麻烦。当用户无权访问时，我需要以某种方式关闭容器标志子项，这样寻路器就不会插入 &parentClass。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-22T16:06:44.570

容器状态由**isfolder**的值设置。

Wayfinder 不会检查资源的子项是否可访问。

尝试[getResources](http://jasoncoward.com/technology/2013/06/finding-your-way-without-wayfinder.html)来构建您的菜单。

# ios6 - 存折更新推送未显示在锁屏上

> ID：15209815
> 
> 赞同：0
> 
> 时间：2013-03-04T19:45:16.947
> 
> 标签：ios6, apple-push-notifications, passbook

我正在玩苹果存折服务。我在所有设备上都有一个非常奇怪的行为。如果我通过 APNS 向设备发送推送，让他们知道某个通行证有更新，他们会进行更新，但不会在设备的锁屏上显示任何通知。

现在我正在记录我的 PHP-Webservice 和 APNS 之间的整个通信。我总是用 headre 200 和要求的答案来回答。（第 1 连载；第 2 次 Pass.pkpass）并且设备会进行更新，正如我在存折应用程序中看到的那样，但正如我已经说过的，我在锁屏上没有收到任何通知。如本文所述，设备已正确设置：[链接](http://support.apple.com/kb/HT5483)

我这样做我的 APNS 请求是这样的：

```
public function sendePushNotification($passTypeID, $debug = true)
{
// Zertifikat vorhanden ?
$certFullPath = dirname(dirname(__FILE__)) . DIRECTORY_SEPARATOR . "api/cert/ck.pem";
if (file_exists($certFullPath))
{
  /**
   * Payload vorbereiten
   */
  $message = 'PASSDROP UPDATE'; 
  $body = array();
  $body['aps'] = array('alert' =>  $message);

  /**
   * Host bestimmen
   */
  $apnsHost = "gateway.push.apple.com";   // Development Umgbung

  /**
   * Stream erstellen
   */
  $ctx = stream_context_create();
  stream_context_set_option($ctx, 'ssl', 'local_cert', $certFullPath);
  $fp = stream_socket_client('ssl://' . $apnsHost . ':2195', $err, $errstr, 2, STREAM_CLIENT_CONNECT, $ctx);
  if (!$fp) 
  {
    echo "Fehler beim APNS: " . $err . " / ". $errstr. "\n";
    return false;
  }

  /**
   * Payload versenden
   */
  $payload = json_encode($body);
  $msg = chr(0) . pack("n",32) . pack('H*', str_replace(' ', '', $this->token)) . pack("n",strlen($payload)) . $payload;      
}
else
{
  throw new Exception("Zertifikat-Bundle " . $certFullPath . " existiert nicht !!!");
}
} 
```

据我所知，Apple 在 Passbook 中推送 Pass 时不会读取有效负载。

有没有人暗示我接下来可以尝试什么？我需要 pass.json 文件中的任何内容吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T00:13:35.067

如果您的设备正在更新并接收新的通行证，但您没有看到通知，那么您的 pass.json 很可能不包含 changeMes​​sage 键。

为了显示通知：

*   传递数据值必须已更改（字段标签、颜色和图像不会触发更新），并且
*   更改的字段必须包含 changeMes​​sage 键，最好使用将替换为新字段值的 %@ 占位符。

对于 Passbook，APNS 推送的唯一目的是通知设备 Web 服务有新内容。所有通知活动都由新旧 pass.json 文件之间的差异决定。

如果您的 pass 字段正在更改，并且您设置了 changeMes​​sage 键但您没有看到通知，那么在 pass.json 的前后部分发布相关的内容可能有助于我们确定问题所在。

当 'after' pass 替换 'before' pass 时，下面的 json 摘录将触发以下两个通知：

*   请前往 22 号登机口
*   航班状态：登机

通过前：

```
 "boardingPass": {
        "headerFields": [{
            "key": "h1",
            "value": "--",
            "label": "Gate",
            "changeMessage": "Please proceed to gate %@"
        }, {
            "key": "h2",
            "value": "On Time",
            "label": "Status",
            "changeMessage": "Flight status: %@"
        }],
           ... 
```

通过后：

```
 "boardingPass": {
        "headerFields": [{
            "key": "h1",
            "value": "22",
            "label": "Gate",
            "changeMessage": "Please proceed to gate %@"
        }, {
            "key": "h2",
            "value": "Boarding",
            "label": "Status",
            "changeMessage": "Flight status: %@"
        }],
           ... 
```

# rest - JAX-RS：如何使用查询参数而不是 Accept 标头来定义响应类型？

> ID：15209816
> 
> 赞同：1
> 
> 时间：2013-03-04T19:45:17.460
> 
> 标签：rest, jersey, jax-rs, restlet, resteasy

在 JAX-RS 中，有没有办法使用查询参数而不是 Accept 标头（例如`/api/foo?format=json`）来定义响应类型？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T21:06:59.910

在 JAX-RS 中进行内容协商有 3 种方式：基于 URL、基于 Accept 头和基于请求参数。请查看[基于请求参数的内容协商链接](https://cwiki.apache.org/WINK/jax-rs-content-negotiation.html)。它包含如何对请求参数进行内容协商的示例代码。该链接适用于 Apache Wink 项目，但代码应该在 Jersey 实现中工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T19:59:30.120

我不知道基于查询参数的内置方法，但[UriConnegFilter](http://jersey.java.net/nonav/apidocs/latest/jersey/com/sun/jersey/api/container/filter/UriConnegFilter.html)支持使用 URI 后缀的建议方法，例如`/api/foo.json`. 也许你可以遵守那个约定？如果没有，UriConnegFilter 将是一个很好的起点，可以让您自己构建对使用查询参数的支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-02T14:29:21.917

在这种情况下，您需要在 web.xml 中启用一个开关，如下所示

```
 <context-param>
    <param-name>resteasy.media.type.param.mapping</param-name>
    <param-value>format</param-value>
   </context-param> 
```

/api/foo?format=json

# php - 在 PHP 中使用 .= 运算符

> ID：15209821
> 
> 赞同：1
> 
> 时间：2013-03-04T19:45:34.353
> 
> 标签：php

这是一个非常基本的问题，但我正在尝试找出一些最佳实践。运算符是否`.=`只是缩短某些代码的一种方法，如下所示：

```
$a = 'John';
$b = 'Doe';
$n = $a.' '.$b'; 
```

对此：

```
$n = 'John';
$n .= ' Doe'; 
```

这似乎是有道理的，但我想确保我没有遗漏任何东西。谢谢！:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T19:46:58.987

你没有错过任何东西。`.=`运算符仅用于此目的。

以下对是相等的：

```
$a = $a . 'b';
$a .= 'b';

$a = $a + 3;
$a += 3;

$a = $a - 3;
$a -= 3;

$a = $a / 3;
$a /= 3;

$a = $a * 3;
$a *= 3; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-04T19:47:09.597

你明白了。就是这样。

```
$a .= $b; 
```

相当于：

```
$a = $a . $b; 
```

只需确保事先定义了这*两个*变量。使用速记时容易让人忘记，但不应该进行`$a .= $b`没有定义的调用。`$a`您应该始终显式地初始化变量。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-04T19:47:45.570

要实际缩短一些这样的*代码*：

```
$n = 'John';
$n = $n .' Doe'; 
```

你的第一个代码连接**三个**字符串，第二个只有两个
，而你的第一个代码用 .=

```
$n  = 'John';
$n .= ' ';
$n .= 'Doe'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T19:47:11.590

你是对的。这只是为了编写更简洁的代码。很像`+=`在javascript中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-04T19:50:25.837

```
$forename = 'John ';

$surname = 'Bennet';

$forname = $forename . $surname;

echo $forname; 
```

是相同的

```
$forename = 'John ';

$surname = 'Bennet';

$forename .= $surname;

echo $forname; 
```

两个输出是相同的：

```
John Bennet 
```

# android - 保存数据以保持更新（Unity3D）

> ID：15209823
> 
> 赞同：1
> 
> 时间：2013-03-04T19:45:37.753
> 
> 标签：android, ios, unity3d

我即将在标准的 android 和 ios 应用商店上发布我的第一个 Unity3d 应用。我想将用户数据文件保存在设备上的一个目录中，以便用户可以下载未来的更新并将数据保留在他们的手机上（即，以便新更新的程序可以访问以前遗留的数据）。哪些是在 ios/android 上写入数据文件的正确目录？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-04T21:41:24.857

[通过Application 类](http://docs.unity3d.com/Documentation/ScriptReference/Application-persistentDataPath.html)使用 Unity 的持久数据路径：

```
string filePath = Application.persistentDataPath; 
```

您可能需要稍微[清理路径](http://answers.unity3d.com/questions/18647/unity-iphone-can-i-store-data-on-the-iphone-to-be.html)，具体取决于设备对数据文件夹的特定读/写访问权限。

对于任何想要更简单方法的人，[Unity 的 PlayerPrefs](http://docs.unity3d.com/Documentation/ScriptReference/PlayerPrefs.html)将处理存储会话数据，前提是您要保存的只是简单的数值或字符串。

# javascript - 为什么我的对象被添加到两个集合中？

> ID：15209829
> 
> 赞同：1
> 
> 时间：2013-03-04T19:45:53.500
> 
> 标签：javascript, model-view-controller, ember.js, javascript-framework, ember-data

请参考以下小提琴： http: [//jsfiddle.net/VkKX2/138/](http://jsfiddle.net/VkKX2/138/)（一定要打开你的控制台）

**TL;博士;** 我有 2 个 hasMany 集合，当我将新模型添加到一个集合时，它也会添加到另一个集合。

SO 需要代码，所以这里有一个非常高级的总结：

```
var foo = App.FooModel.find(101);
var bar = App.BarModel.find(204);

foo.get('collection2').addObject( bar );
foo.get('collection1').contains( bar ); // yields true 
```

**问题：**为什么我的对象被添加到*两个*集合中！？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:48:26.840

**就**在我发布这个的时候，我意识到了这个问题：

当我生成摘要时，我想遍历*任*一集合中的所有对象：

```
var bars = foo.get('collection1').addObjects( foo.get( 'collection2' )).uniq(); 
```

这具有将 collection2 添加到 collection1 的*引用*而不仅仅是结果`bar`变量的未实现效果。把代码改成这样，问题就解决了：

```
var bars = foo.get('collection1').toArray().addObjects( foo.get( 'collection2' )).uniq(); 
```

# android - 无法执行 dex：方法 ID 不在 [0, 0xffff] 中：65536

> ID：15209831
> 
> 赞同：346
> 
> 时间：2013-03-04T19:46:00.033
> 
> 标签：android, dex

我以前见过各种版本的 dex erros，但这个是新的。清理/重启等无济于事。图书馆项目似乎完好无损，并且依赖关系似乎正确链接。

```
Unable to execute dex: method ID not in [0, 0xffff]: 65536
Conversion to Dalvik format failed: Unable to execute dex: method ID not in [0, 0xffff]: 65536 
```

***或者***

```
Cannot merge new index 65950 into a non-jumbo instruction 
```

***或者***

```
java.util.concurrent.ExecutionException: com.android.dex.DexIndexOverflowException: method ID not in [0, 0xffff]: 65536 
```

**tl;dr**：Google 的官方解决方案终于来了！

[http://developer.android.com/tools/building/multidex.html](http://developer.android.com/tools/building/multidex.html)

只有一个小技巧，您可能需要这样做以防止在进行 dex-ing 时出现内存不足。

```
dexOptions {
        javaMaxHeapSize "4g"
} 
```

还有一种巨型模式可以以不太可靠的方式解决此问题：

```
dexOptions {
        jumboMode true
} 
```

更新：如果您的应用程序很胖并且您的主应用程序中有太多方法，您可能需要根据以下内容重新组织您的应用程序

[http://blog.osom.info/2014/12/too-many-methods-in-main-dex.html](http://blog.osom.info/2014/12/too-many-methods-in-main-dex.html)

* * *

## 回答 #1

> 赞同：379
> 
> 时间：2014-10-04T19:32:50.443

**更新 3 (11/3/2014)**
谷歌终于发布了[官方描述](http://developer.android.com/tools/building/multidex.html)。

* * *

**更新 2 (10/31/2014)**
适用于 Android 的 Gradle 插件 v0.14.0[添加了](http://tools.android.com/tech-docs/new-build-system)对多 dex 的支持。要启用，您只需在*build.gradle*中声明它：

```
android {
   defaultConfig {
      ...
      multiDexEnabled  true
   }
} 
```

如果您的应用程序支持 5.0 之前的 Android（即，如果您`minSdkVersion`是 20 或更低版本），您还必须动态修补*应用程序 ClassLoader*，以便它能够从辅助 dexes 加载类。幸运的是，有一个[库](http://developer.android.com/tools/support-library/features.html#multidex)可以为您做到这一点。将其添加到您的应用程序的依赖项中：

```
dependencies {
  ...
  compile 'com.android.support:multidex:1.0.0'
} 
```

您需要尽快调用 ClassLoader 补丁代码。`MultiDexApplication`类的[文档](http://developer.android.com/reference/android/support/multidex/MultiDexApplication.html)建议了三种方法（选择**其中一种**，一种对您来说最方便的方法）：

1 -在您的*AndroidManifest.xml*`MultiDexApplication`中将类声明为应用程序：

 *```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.android.multidex.myapplication">
    <application
        ...
        android:name="android.support.multidex.MultiDexApplication">
        ...
    </application>
</manifest> 
```

2 - 让你的`Application`类扩展[MultiDexApplication](http://developer.android.com/reference/android/support/multidex/MultiDexApplication.html)类：

```
public class MyApplication extends MultiDexApplication { .. } 
```

`MultiDex#install`3 -从您的方法调用`Application#attachBaseContext`：

```
public class MyApplication {
    protected void attachBaseContext(Context base) {
        super.attachBaseContext(base);
        MultiDex.install(this);
        ....
    }
    ....
} 
```

* * *

**更新 1（2014 年 10 月 17 日）：**
正如预期的那样，[multidex 支持](http://developer.android.com/reference/android/support/multidex/package-summary.html)在 Android 支持库的修订版 21 中提供。您可以在 /sdk/extras/android/support/multidex/library/libs 文件夹中找到 android-support-multidex.jar。

* * *

多 dex 支持解决了这个问题。dx 1.8 已经允许生成多个 dex 文件。
Android L 将原生支持 multi-dex，支持库的下一个版本将覆盖旧版本回到 API 4。

Anwar Ghuloum在[此Android Developers Backstage 播客节目中说明了这一点。](http://androidbackstage.blogspot.com/2014/08/android-developers-backstage-episode-11.html)我已经[发布了相关部分的成绩单](http://blog.osom.info/2014/10/multi-dex-to-rescue-from-infamous-65536.html)（和一般多 dex 解释）。

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2015-02-19T12:45:28.603

如前所述，您的项目和库中有太多方法（超过 65k）。

## 预防问题：使用 Play Services 6.5+ 和 support-v4 24.2+ 减少方法数量

由于 Google Play 服务通常是其[20k+ 方法](http://jakewharton.com/play-services-is-a-monolith/)“浪费”方法的主要嫌疑人之一。Google Play 服务版本 6.5 或更高版本，您可以[使用许多较小的客户端库在您的应用程序中包含 Google Play 服务。](http://android-developers.blogspot.co.at/2014/12/google-play-services-and-dex-method.html)例如，如果您只需要 GCM 和地图，您可以选择仅使用这些依赖项：

```
dependencies {
    compile 'com.google.android.gms:play-services-base:6.5.+'
    compile 'com.google.android.gms:play-services-maps:6.5.+'
} 
```

[子库的完整列表及其职责可以在官方谷歌文档中找到](https://developer.android.com/google/play-services/setup.html?utm_campaign=dex-1214&utm_source=dac&utm_medium=blog)。

**更新**：自支持库 v4 v24.2.0 以来，它被分成以下模块：

> `support-compat`, `support-core-utils`,和`support-core-ui`_`support-media-compat``support-fragment`

```
dependencies {
    compile 'com.android.support:support-fragment:24.2.+'
} 
```

但是请注意，如果您使用`support-fragment`，它将依赖于所有其他模块（即，如果您使用`android.support.v4.app.Fragment`没有任何好处）

[请参阅此处 support-v4 lib 的官方发行说明](https://developer.android.com/topic/libraries/support-library/revisions.html)

* * *

## 启用 MultiDexing

由于 Lollipop（又名构建工具 21+）它很容易处理。该方法是解决每个 dex 文件 65k 个方法的问题，为您的应用程序创建多个 dex 文件。将以下内容添加到您的 gradle 构建文件中（[取自官方 google doc on applications with more than 65k methods](http://developer.android.com/tools/building/multidex.html)）：

```
android {
    compileSdkVersion 21
    buildToolsVersion "21.1.0"

    defaultConfig {
        ...
        // Enabling multidex support.
        multiDexEnabled true
    }
    ...
}

dependencies {
  compile 'com.android.support:multidex:1.0.1'
} 
```

第二步是准备您的应用程序类，或者如果您不扩展应用程序，`MultiDexApplication`请在您的 Android 清单中使用：

要么将此添加到您的 Application.java

```
@Override
  protected void attachBaseContext(Context base) {
    super.attachBaseContext(base);
    MultiDex.install(this);
  } 
```

**或**使用 mutlidex 库中提供的应用程序

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.android.myapplication">
    <application
        ...
        android:name="android.support.multidex.MultiDexApplication">
        ...
    </application>
</manifest> 
```

* * *

## 使用 MultiDex 防止 OutOfMemory

作为进一步的提示，如果您`OutOfMemory`在构建阶段遇到异常，您可以使用

```
android {
    ...
    dexOptions {
        javaMaxHeapSize "4g"
    }
} 
```

这会将堆设置为 4 GB。

[有关 dex 堆内存问题的更多详细信息，请参阅此问题。](https://stackoverflow.com/questions/25013638/android-studio-google-jar-causing-gc-overhead-limit-exceeded-error)

* * *

## 分析问题的根源

要分析方法的来源，gradle 插件 [https://github.com/KeepSafe/dexcount-gradle-plugin](https://github.com/KeepSafe/dexcount-gradle-plugin)可以帮助结合 gradle 提供的依赖关系树，例如

```
.\gradlew app:dependencies 
```

[有关 android 中方法计数的更多信息，请参阅此答案和问题](https://stackoverflow.com/a/32328348/774398)

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2013-03-11T11:15:50.903

你的项目太大了。你的方法太多了。每个应用程序只能有 65536 个方法。见这里[https://code.google.com/p/android/issues/detail?id=7147#c6](https://code.google.com/p/android/issues/detail?id=7147#c6)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2014-09-25T21:23:09.647

如果您使用 Gradle，以下代码会有所帮助。允许您轻松删除不需要的 Google 服务（假设您正在使用它们）以恢复到 65k 阈值以下。这篇文章的所有功劳：[https ://gist.github.com/dmarcato/d7c91b94214acd936e42](https://gist.github.com/dmarcato/d7c91b94214acd936e42)

**编辑 2014-10-22**：关于上面提到的要点有很多有趣的讨论。TLDR？看看这个：[https ://gist.github.com/Takhion/10a37046b9e6d259bb31](https://gist.github.com/Takhion/10a37046b9e6d259bb31)

将此代码粘贴到 build.gradle 文件的底部并调整您不需要的 google 服务列表：

```
def toCamelCase(String string) {
    String result = ""
    string.findAll("[^\\W]+") { String word ->
        result += word.capitalize()
    }
    return result
}

afterEvaluate { project ->
    Configuration runtimeConfiguration = project.configurations.getByName('compile')
    ResolutionResult resolution = runtimeConfiguration.incoming.resolutionResult
    // Forces resolve of configuration
    ModuleVersionIdentifier module = resolution.getAllComponents().find { it.moduleVersion.name.equals("play-services") }.moduleVersion

    String prepareTaskName = "prepare${toCamelCase("${module.group} ${module.name} ${module.version}")}Library"
    File playServiceRootFolder = project.tasks.find { it.name.equals(prepareTaskName) }.explodedDir

    Task stripPlayServices = project.tasks.create(name: 'stripPlayServices', group: "Strip") {
        inputs.files new File(playServiceRootFolder, "classes.jar")
        outputs.dir playServiceRootFolder
        description 'Strip useless packages from Google Play Services library to avoid reaching dex limit'

        doLast {
            copy {
                from(file(new File(playServiceRootFolder, "classes.jar")))
                into(file(playServiceRootFolder))
                rename { fileName ->
                    fileName = "classes_orig.jar"
                }
            }
            tasks.create(name: "stripPlayServices" + module.version, type: Jar) {
                destinationDir = playServiceRootFolder
                archiveName = "classes.jar"
                from(zipTree(new File(playServiceRootFolder, "classes_orig.jar"))) {
                    exclude "com/google/ads/**"
                    exclude "com/google/android/gms/analytics/**"
                    exclude "com/google/android/gms/games/**"
                    exclude "com/google/android/gms/plus/**"
                    exclude "com/google/android/gms/drive/**"
                    exclude "com/google/android/gms/ads/**"
                }
            }.execute()
            delete file(new File(playServiceRootFolder, "classes_orig.jar"))
        }
    }

    project.tasks.findAll { it.name.startsWith('prepare') && it.name.endsWith('Dependencies') }.each { Task task ->
        task.dependsOn stripPlayServices
    }
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-03-08T09:18:12.780

我分享了一个示例项目，它使用 custom_rules.xml 构建脚本和几行代码解决了这个问题。

我在自己的项目中使用了它，它在 1M+ 设备上运行完美（从 android-8 到最新的 android-19）。希望能帮助到你。

[https://github.com/mmin18/Dex65536](https://github.com/mmin18/Dex65536)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-08-19T23:31:12.183

遇到了同样的问题，并通过在依赖项部分编辑我的 build.gradle 文件来解决它，删除：

```
compile 'com.google.android.gms:play-services:7.8.0' 
```

并将其替换为：

```
compile 'com.google.android.gms:play-services-location:7.8.0'
compile 'com.google.android.gms:play-services-analytics:7.8.0' 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2015-11-03T22:09:10.230

尝试在 build.gradle 中添加以下代码，它对我有用 -

```
compileSdkVersion 23
buildToolsVersion '23.0.1'
defaultConfig {
    multiDexEnabled true
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-07-31T11:01:33.030

完美的解决方案是使用 Proguard。正如评论中提到的阿莱布。它将 dex 文件的大小减少一半。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-06-03T00:01:43.060

您可以使用 Android Studio 分析问题（dex 文件引用）：

构建 -> 分析 APK ..

在结果面板上单击 classes.dex 文件

你会看到：

[![在此处输入图像描述](../Images/66b61748393f7abbe8aaf569118ed796.png)](https://i.stack.imgur.com/MPNup.png)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-10-22T07:12:48.620

gradle + proguard 解决方案：

```
afterEvaluate {
  tasks.each {
    if (it.name.startsWith('proguard')) {
        it.getInJarFilters().each { filter ->
            if (filter && filter['filter']) {
                filter['filter'] = filter['filter'] +
                        ',!.readme' +
                        ',!META-INF/LICENSE' +
                        ',!META-INF/LICENSE.txt' +
                        ',!META-INF/NOTICE' +
                        ',!META-INF/NOTICE.txt' +
                        ',!com/google/android/gms/ads/**' +
                        ',!com/google/android/gms/cast/**' +
                        ',!com/google/android/gms/games/**' +
                        ',!com/google/android/gms/drive/**' +
                        ',!com/google/android/gms/wallet/**' +
                        ',!com/google/android/gms/wearable/**' +
                        ',!com/google/android/gms/plus/**' +
                        ',!com/google/android/gms/topmanager/**'
            }
        }
    }
  }
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-11-04T12:10:11.077

从Libs文件夹中删除一些jar文件并复制到其他文件夹，然后转到_Project Properties>选择Java Build Path，选择Libraries，选择Add External Jar，选择Removed jar to your project，点击save，这将添加到Referenced下库而不是 Libs 文件夹。现在清理并运行您的项目。您不需要为 MultDex 添加任何代码。它只是为我工作。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-10-10T10:22:13.393

我今天遇到了同样的问题，有效的方法在下面

对于 ANDROID STUDIO... 启用即时运行

在 File->Preferences->Build, Execution, Deployment->Instant Run-> 勾选 Enable Instant run for hot swap...

希望能帮助到你*

# javascript - 对包含多个元素的表格进行分页？

> ID：15209838
> 
> 赞同：2
> 
> 时间：2013-03-04T19:46:26.560
> 
> 标签：javascript, jquery, html, css, html-table

假设我有一张这样的表：

```
<table>
    <thead>
        <tr><th>Customer</th><th>Order</th><th>Month</th></tr>
    </thead>
    <tbody>
        <tr><td>Customer 1</td><td>#1</td><td>January</td></tr>
        <tr><td>Customer 1</td><td>#2</td><td>April</td></tr>
        <tr><td>Customer 1</td><td>#3</td><td>March</td></tr>
    </tbody>
    <tbody>
        <tr><td>Customer 2</td><td>#1</td><td>January</td></tr>
        <tr><td>Customer 2</td><td>#2</td><td>April</td></tr>
        <tr><td>Customer 2</td><td>#3</td><td>March</td></tr>
    </tbody>
    <tbody>
        <tr><td>Customer 3</td><td>#1</td><td>January</td></tr>
        <tr><td>Customer 3</td><td>#2</td><td>April</td></tr>
        <tr><td>Customer 3</td><td>#3</td><td>March</td></tr>
    </tbody>
    ....
    .... 1000s of records like this
</table> 
```

有没有办法可以根据`tbody`元素进行分页？例如，我想在第 1 页显示前 50 条记录，依此类推。是否有一个 jQuery 插件已经可以做到这一点，或者我应该自己编写？有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T23:43:27.650

传奇，

[jQuery 分页插件](http://d-scribe.de/webtools/jquery-pagination/demo/demo_options.htm)- 不错的发现。

这是一种使用插件更接近您最初要求的方法。

```
$(document).ready(function () {
    var $tbodies = $("#myTable tbody");

    // Create pagination element with options from form
    var paginationOpts = {
        callback: pageselectCallback,
        items_per_page: 5,
        num_display_entries: 10,
        num_edge_entries: 2,
        prev_text: "Prev",
        next_text: "Next"
    };

    function pageselectCallback(page_index, jq) {
        //calculate limits of the page in terms of tbody indices
        var limits = {
            start: page_index * paginationOpts.items_per_page,
            end: (page_index + 1) * paginationOpts.items_per_page
        };
        $tbodies.filter(":visible").hide();
        $tbodies.slice(limits.start, limits.end).show();
        // Prevent click eventpropagation
        return false;
    }

    $("#Pagination").pagination($tbodies.length, paginationOpts);
}); 
```

我不是说这更好。对于 1000 多个 tbodies，HTML 可能很大，页面转换可能非常缓慢，但是如果您尚未修改数据提供方式，这种方法可以节省您的开发时间。

将来可能对某人有用。

[演示](http://jsfiddle.net/ZdCPs/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T20:08:03.960

最有效的方法是实现分页服务器端。

正如评论中所说，[Datatables](http://datatables.net/)似乎是您最好的选择。我也可以考虑[SlickGrid](https://github.com/mleibman/SlickGrid)

请注意，您可以使用这些 API 选择客户端或服务器端分页

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T20:47:24.073

[我通过一个名为jQuery Pagination Plugin](http://d-scribe.de/webtools/jquery-pagination/demo/demo_options.htm)的轻量级插件来完成这项工作。

如果有人感兴趣，这里有一个[演示。](http://jsfiddle.net/Legend/ZdCPs/)

HTML：

```
<div id="Pagination" class="pagination"></div>
<br style="clear:both" />
<table id="Searchresult"></table> 
```

JS：

```
var members = [
    // Any data array
];

var n = "";
function pageselectCallback(page_index, jq) {
    // Get number of elements per pagionation page from form
    var items_per_page = 5;
    var max_elem = Math.min((page_index + 1) * items_per_page, members.length);
    var newcontent = '';

    // Iterate through a selection of the content and build an HTML string
    newcontent = "<table>";
    for (var i = page_index * items_per_page; i < max_elem; i++) {
        newcontent += '<tbody><tr><td>' + members[i][0] + '</td></tr>';
        newcontent += '<tr><td class="state">' + members[i][2] + '</td>';
        newcontent += '<td class="party">' + members[i][3] + '</td></tr></tbody>';
    }
    newcontent += "</table>";

    // Replace old content with new content
    $('#Searchresult').html(newcontent);

    // Prevent click eventpropagation
    return false;
}

$(document).ready(function () {
    // Create pagination element with options from form
    var opt = {
        callback: pageselectCallback
    };
    opt.items_per_page = 5;
    opt.num_display_entries = 10;
    opt.num_edge_entries = 2;
    opt.prev_text = "Prev";
    opt.next_text = "Next";

    $("#Pagination").pagination(members.length, opt);
}); 
```

# javascript - rtl css方向属性在IE9中不起作用

> ID：15209839
> 
> 赞同：1
> 
> 时间：2013-03-04T19:46:45.587
> 
> 标签：javascript, html, css, d3.js

在 CSS 中，我指定：

```
#label{
  font-size: 11px;
  fill: black;
  direction: rtl;
  font-weight:bold;
} 
```

然后，在我的脚本中，我写道：

```
squares.append("text").attr("id", "label").text("");
squares.select("#label").attr("x", 0).attr("y", 0).text("Hello"); 
```

在 Chrome 中，文本从右到左增长，因此可以按我的意愿工作。但是在 IE9 中，它似乎忽略了 rtl 方向属性，即使我去：

```
squares.select("#label").attr("x", 0).attr("y", 0).text("Hello").style("direction", "rtl"); 
```

任何有助于使其在 IE9 中也能正常工作的帮助都会很棒！

# java - 查找节点之间的最短路径，以及图是否连通

> ID：15209841
> 
> 赞同：0
> 
> 时间：2013-03-04T19:46:48.107
> 
> 标签：java, data-structures, graph

显然下面是一个家庭作业问题。我听不懂我的教授在说什么，所以我什至不需要知道从哪里开始寻找找到这个问题的答案所需的信息。如果你能给我一些关于在哪里学习这些东西以及你如何解决这个问题的线索，我将不胜感激。

在下图中，找到两个节点之间的最短路径 - 您的选择，但要让问题变得有趣。

这是一个连通图吗？

![在此处输入图像描述](../Images/d8459811acd6cf1b3a50bc0eb9106343.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:50:10.477

您应该使用星型算法来找到两个节点之间的最短路径。 [http://en.wikipedia.org/wiki/A_star](http://en.wikipedia.org/wiki/A_star)

您可以使用门格尔定理来判断它是否正在连接 [http://en.wikipedia.org/wiki/Menger%27s_theorem](http://en.wikipedia.org/wiki/Menger%27s_theorem)

* * *

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T20:29:27.627

最好先了解图形在内存中的表示方式。如果由您决定，您可以使用二维数组，因为这是表示加权边缘的最简单方法。

最容易实现的最短路径算法可能是 Djikstra 算法，它比 A* 稍慢但不太复杂。要使用 Djikastra，您首先要实现优先级队列。在 Java 中有一个 PriorityQueue 类，否则您必须自己实现它。之后，使用 Wikipedia 或其他任何地方提供的伪代码，实现应该相当简单。

# scala - 在scala中使列表像元组一样解构，或使元组像列表一样迭代

> ID：15209847
> 
> 赞同：3
> 
> 时间：2013-03-04T19:47:06.843
> 
> 标签：scala

我有一些变量，我想通过一个函数运行每个变量来创建新变量。所以基本上我现在有

```
val formatted1 = format(raw1)
val formatted2 = format(raw2)
val formatted3 = format(raw3) 
```

有没有办法在一条线上做到这一点？寻找类似的东西

```
val (formatted1, formatted2, formatted3) = (raw1, raw2, raw3).map(format) 
```

但这似乎以不兼容的方式结合了 List 的功能和 Tuple 的功能。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-04T19:48:31.173

您可以映射元组，但如果您将项目放在列表中：

```
val List(formatted1, formatted2, formatted3) = List(raw1, raw2, raw3).map(format) 
```

这适用于许多其他集合，如 Seq、Array 等（两边的类型必须相同！但左侧可以有更通用的类型：例如`val Seq(...) = List(...)`）。

对于列表（但不适用于其他类型），您还可以编写如下内容：

```
val formatted1::formatted2::formatted3::Nil = List(raw1, raw2, raw3).map(format) 
```

从 Scala 2.10 开始，您可以使用 Seq 执行相同的技巧：

```
val formatted +: formatted2 +: formatted3 +: _ = .... 
```

# javascript - 将 Javascript 对象复制到另一个对象中，而不是创建新的属性

> ID：15209862
> 
> 赞同：1
> 
> 时间：2013-03-04T19:48:03.810
> 
> 标签：javascript, jquery

假设有两个对象

```
source = {
   name: "A",
   address: {
      city: "B",
      zipcode: "C"
   },
   car: {
      make: "D",
      model: "E"      
   }
};

target = {
   name: "",
   address: {
      city: ""
   }
}; 
```

现在我想将所有数据从源复制到目标。但是，如果目标中已经存在相应的属性，则必须进行复制。它类似于 jQuery 的扩展，没有添加新属性。有了上面的数据，结果将是......

```
target = {
   name: "A",
   address: {
      city: "B"
   }
}; 
```

如何轻松实现这一目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T19:54:48.733

这应该这样做：

```
function extend(target, source) {
    for (var prop in source)
        if (prop in target) // <== test this
            if (typeof target[prop] === "object")
                extend(target[prop], source[prop]);
            else
                target[prop] = source[prop];
} 
```

[免责声明：这个简单的方法不适用于数组、可枚举的原型属性、`null`值……</sub>]

您不妨将最外层的循环更改为

```
 for (var prop in target)
        if (prop in source) 
```

取决于两个对象中的哪一个具有较少的要枚举的属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T19:55:28.357

您可以循环`target`然后从 `source. 我建议使用递归函数，因为您的对象可能有多个子对象。

```
function fill_in_values(target, source){
    for(var prop in target){
        if(typeof target[prop] === 'object'){
            fill_in_values(target[prop], source[prop]);
        }
        else{
            target[prop] = source[prop];
        }
    }
} 
```

# javascript - 是否可以使用百分比相对定位将图钉图像定位在另一个图像上

> ID：15209863
> 
> 赞同：0
> 
> 时间：2013-03-04T19:48:04.703
> 
> 标签：javascript, css, image, css-position

我想要一张国家地图，每个州议会大厦的位置都有图钉，并且想让国家地图可以调整大小，这样当它变大或变小时，图钉会自动移动到屏幕上正确的新位置。

**这可以通过百分比定位来实现吗？**如果图钉具有绝对位置，我只能将图钉放置在另一个图像的顶部，但是我必须在调整大小时重新计算图钉位置。

有没有办法将图钉放置在`top: 50%; left 50%`相对于国家地图图像或包含国家地图图像的 div 上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:52:36.923

一般来说：

将包装元素设置为`position:relative.`这将为绝对定位的子元素设置原点

将子元素设置为`position:absolute`并提供`top:`和`left:`（或右：和底部：）以像素为单位。

对于图钉，您可能想要设置 CSS 背景，而不是内联图像。

```
<div class="pin pinA"></div> 
```

CSS：

```
.pin {
   position:absolute;
   height:20px;
   width:20px;
   background-image:url(...);
   background-repeat:no-repeat;
} 
```

...然后使用第二类进行定位：

```
.pinA {
     top:50px;
     left:300px;
} 
```

然后，您可以继续为 pinB、pinC 等输入条目。

# python - 正确使用 os.path 和 os.join

> ID：15209867
> 
> 赞同：7
> 
> 时间：2013-03-04T19:48:17.667
> 
> 标签：python

我正在尝试编写一个处理程序来处理各种子目录中的文件，但是虽然我的脚本可以*看到*这些文件，但它无法对它们做任何事情，因为它无法组装它们的路径。

有问题的部分来自这个循环：

```
for (path, dirs, files) in os.walk("data/"):
    for image in files: 
        #do something to the image 
```

现在，该脚本在`data`目录的第一级工作，但无法在`data`的子目录上工作。

我尝试使用`os.path.join()`：

```
for (path, dirs, files) in os.walk("data/"):
    print os.path.join(path, dirs) 
```

但这会引发以下内容：

```
Traceback (most recent call last):
  File "bench.py", line 26, in <module>
    print os.path.join(path, dirs)
  File "/usr/lib/python2.7/posixpath.py", line 75, in join
    if b.startswith('/'):
AttributeError: 'list' object has no attribute 'startswith' 
```

简而言之，我想做的是组装一条从`data`图像到包含`data`子目录的路径。这样做的最佳做法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-04T19:50:44.613

我认为你想`path`加入`file`每个`file``files`

```
for path,dirs,files in os.walk('data/'):
    for f in files:
        fname = os.path.join(path,f)
        assert(os.path.exists(fname)) 
```

`dirs`是`list`目录中的一个目录`path`。您实际上可以`dirs`就地修改以防止`os.walk`进入某些目录（整洁！）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T19:51:58.290

尝试：

```
for (path, dirs, files) in os.walk("data/"):
  for image in files: 
    fname = os.path.join(path, image)
    file = open(fname, 'rb') 
```

[os.walk 文档](http://docs.python.org/2/library/os.html)中的两个示例都是这样做的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T19:52:21.453

```
for (path, dirs, files) in os.walk("data/"):
  for image in files: 
    file_path = os.path.join(path, image)
    # do your stuff 
```

# javascript - 生产上的 JS 错误，但不是开发轨道

> ID：15209869
> 
> 赞同：0
> 
> 时间：2013-03-04T19:48:21.630
> 
> 标签：javascript, ruby-on-rails, coffeescript, ckeditor

我在生产中遇到了一些 JS 问题。这是我的 CoffeeScript：

```
$("form.edit_email_template").submit ->
    window.onbeforeunload = -> null
    $.each $("form.edit_email_template"), (i, v) ->
      if CKEDITOR.instances[$("form.edit_email_template[action='" + $(v).attr("action") + "'] .email_content_area").attr("id")]
        try
          $.ajax($(v).attr("action"),
            type: "POST"
            data:
              _method: "PUT"
              authenticity_token: $("form.edit_email_template[action='" + $(v).attr("action") + "'] input[name='authenticity_token']").val()
              email_template:
                sendLength: $("form.edit_email_template[action='" + $(v).attr("action") + "'] #email_template_sendLength").val()
                subject: $("form.edit_email_template[action='" + $(v).attr("action") + "'] #email_template_subject").val()
                content: CKEDITOR.instances[$("form.edit_email_template[action='" + $(v).attr("action") + "'] .email_content_area").attr("id")].getData()
          )
        catch error
          console.log(error) 
```

在开发中，它可以完美运行。在生产中，我收到此错误：

```
Uncaught TypeError: Cannot call method 'getData' of undefined 
```

我应该如何修复它？

```
CKEDITOR.instances => Object {et28: e, et31: e, et32: e, et36: e, et7: e…}
et: e
et7: e
et8: e
et24: e
et28: e
et31: e
et32: e
et36: e 
```

所有的 DOM 元素都存在。如果我将 CoffeeScript 生成的 JS 粘贴到 JS 控制台中，它可以工作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:55:42.820

确保你的 production.rb 文件中有这个：

```
config.assets.precompile << '*.js'
config.assets.precompile << '*.css' 
```

我猜CKEditor或者你的一些js没有被预编译。

# c# - 在运行时动态更新 TabControl 内容

> ID：15209870
> 
> 赞同：3
> 
> 时间：2013-03-04T19:48:25.013
> 
> 标签：c#, .net, wpf

所以这就是问题所在。我有一个窗口分为三个面板。中间包含一个绘图表面，左侧包含一个选项卡控件。选项卡控件的每个选项卡都包含一个必须在右侧面板中打开新菜单的按钮列表。我无法弄清楚如何在代码中执行此操作，因此我求助于在 C# 运行时单独创建每个按钮。似乎必须有更好的方法来解决它。我目前为按钮单击事件调用以下函数，以在运行时在名为“tabctrl”的右侧面板中绘制不同的菜单。它需要一个字符串参数来指定要绘制的菜单集，尽管此时我只为一个菜单编写了代码。下面是函数和xml的代码。有没有更好的方法来解决这个问题？

xml:

```
<TabControl DockPanel.Dock="Right" Background="White" x:Name="tabctrl">
        <TabItem Height ="38" Name="Tab1" Header="tab3"/>
    </TabControl> 
```

C＃：

```
private void menuOpen(string menuSelected)
    {

        //Logic statement for what menu is being opened
        switch (menuSelected)
        {
            case "BackGround":
                {
                    //Remove Current Tabs

                    //Initialize Tab Item, set title, and add tab item to tab control
                    TabItem BackGround = new TabItem();
                    BackGround.Header = "BackGround";
                    tabctrl.Items.Insert(1, BackGround);
                    BackGround.Height = 38;

                    //Initialize Stack Panel, set orientation, and add to tab control
                    StackPanel panel = new StackPanel();
                    panel.Orientation = Orientation.Vertical;
                    BackGround.Content = panel;

                    //Initialize Menu Items
                    Button AddMap = new Button();
                    Button AddDemoMap = new Button();
                    Button RemoveMap = new Button();
                    Button MoveSelected = new Button();
                    Button Properties = new Button();
                    Button ScaleBackground = new Button();

                    //Define Button Text
                    AddMap.Content = "Add Map";
                    AddDemoMap.Content = "Add Demo Map";
                    RemoveMap.Content = "Remove Map";
                    MoveSelected.Content = "Move Selected Map to Top of List";
                    Properties.Content = "Properties";
                    ScaleBackground.Content = "Scale Background to Pipes";

                    AddMap.Height = 50;
                    AddDemoMap.Height = 50;
                    RemoveMap.Height = 50;
                    MoveSelected.Height = 50;
                    Properties.Height = 50;
                    ScaleBackground.Height = 50;

                    //Add Buttons to StackPanel
                    panel.Children.Add(AddMap);
                    panel.Children.Add(AddDemoMap);
                    panel.Children.Add(RemoveMap);
                    panel.Children.Add(MoveSelected);
                    panel.Children.Add(Properties);
                    panel.Children.Add(ScaleBackground);
                }
                break; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T20:33:31.133

好吧，让我们来看看：

首先，你必须学会​​以**抽象**的方式思考你的 UI：

> 什么是 TabControl？

它是小部件列表的图形表示，用户一次可以拥有 1 个活动小部件。这些小部件具有标题（选项卡项文本）、可见性状态和启用/禁用状态。

> 什么是一堆堆叠的按钮？（工具栏，如果你想这样称呼它）

它是用户可以在任何给定时间执行的操作列表的图形表示。这些操作有一个描述（按钮的内容），可能是一个相关的图标或图形图像，以及一个启用/禁用状态。

> 什么是 ContextMenu 或菜单？

与上面相同，它是用户可以执行的操作列表的图形表示。

> 我将如何在 WPF 中创建动态 TabControl？

这是支持动态子项的 WPF TabControl 的 XAML：

```
<Window x:Class="WpfApplication4.Window12"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Window12" Height="300" Width="300">
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
    </Window.Resources>
        <TabControl ItemsSource="{Binding Items}" SelectedItem="{Binding SelectedItem}">
            <TabControl.ItemContainerStyle>
                <Style TargetType="TabItem">
                    <Setter Property="IsEnabled" Value="{Binding IsEnabled}"/>
                    <Setter Property="Visibility" Value="{Binding IsVisible, Converter={StaticResource BoolToVisibilityConverter}}"/>
                    <Setter Property="Header" Value="{Binding Title}"/>
                </Style>
            </TabControl.ItemContainerStyle>
        </TabControl>
</Window> 
```

视图模型：

```
 public class TabbedViewModel: ViewModelBase
    {
        private ObservableCollection<TabViewModel> _items;
        public ObservableCollection<TabViewModel> Items
        {
            get { return _items ?? (_items = new ObservableCollection<TabViewModel>()); }
        }

        private ViewModelBase _selectedItem;
        public ViewModelBase SelectedItem
        {
            get { return _selectedItem; }
            set
            {
                _selectedItem = value;
                NotifyPropertyChange(() => SelectedItem);
            }
        }
    }

    public class TabViewModel: ViewModelBase
    {
        private string _title;
        public string Title
        {
            get { return _title; }
            set
            {
                _title = value;
                NotifyPropertyChange(() => Title);
            }
        }

        private bool _isEnabled;
        public bool IsEnabled
        {
            get { return _isEnabled; }
            set
            {
                _isEnabled = value;
                NotifyPropertyChange(() => IsEnabled);
            }
        }

        private bool _isVisible;
        public bool IsVisible
        {
            get { return _isVisible; }
            set
            {
                _isVisible = value;
                NotifyPropertyChange(() => IsVisible);
            }
        }
    } 
```

在此示例中，TabControl 中的每个项目 (TabItem) 都将绑定到其中一个 ViewModel，然后只需为每个选项卡继承基本 TabViewModel 并为每个选项卡创建一个适当`DataTemplate`的问题。

正如您在此示例中所看到的，我绝不会在代码中创建或操作任何 UI 元素。这大大简化了所有代码，并有助于保持逻辑和 UI 之间的清晰分离。您可以将相同的概念应用于 WPF 中的所有内容。

# r - 如何将文本包装在数据框中以使用 grid.draw 打印？

> ID：15209873
> 
> 赞同：2
> 
> 时间：2013-03-04T19:48:26.633
> 
> 标签：r, gridextra

![在此处输入图像描述](../Images/3ef0bb89b0005e02e43dd8aa34d9a000.png)

我有`data.frame`一个列有多行文本。如何包装文本以使用 grid.draw 打印数据框？我尝试使用 strwrap 但没有运气。

```
A=data.frame(name=c("ABC","XYZ","DEF"),description=c(rep("This is an example for text wrap using grid.draw in package gridExtra",3)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:06:21.397

使用`gridExtra`具有 function 的包`grid.table`，并将其添加`\n`到您想要中断的数据框中：

```
A=data.frame(name=c("ABC","XYZ","DEF"),description=c(rep("This is an example for text wrap \nusing grid.draw in package gridExtra",3))
grid.newpage()
grid.table(A) 
```

您可以使用各种参数很好地调整表格。

# php - 参数错误信息

> ID：15209881
> 
> 赞同：0
> 
> 时间：2013-03-04T19:48:50.367
> 
> 标签：php, mysql

当我尝试登录我的网站时收到此错误消息：数据库错误：SQLSTATE [HY093]：无效参数编号：未定义参数我不确定这甚至意味着什么，即使在谷歌搜索之后也是如此。这是我的代码：

```
<?php
//declaring variables and assigning values from log in form

//validate text was entered in UserName text box
if(empty($_POST['txtUserName']))
    {
        showForm(null);
        exit();
    }
else
    {
        $User_Name = $_POST['txtUserName'];
    }

//validate text was entered in password text box
if(empty($_POST['txtPassword']))
    {
        showForm(null);
        exit();
    }
else
    {
        $Password = $_POST['txtPassword'];
    }

if ($PasswordForm != Password($User_Name))
{
    showForm('Customer ID and Password did not match. Please try again!');
    exit();
}

function Password($User_Name)
{   
//$UserName = $_GET['txtUserName'];
//$Password = $_GET['txtPassword'];

//declare and assign values to variables
$dsn = 'mysql:host=XXX;dbname=XXX';
$username='XXX';
$password='XXX';
//variable for errors
$options = array(PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION);
//try to run code
try {
//object to open database
$db = new PDO($dsn,$username,$password, $options);
//check username against password
    $SQL = $db->prepare("Select Password from user where USER_NAME = :USER_NAME");
    $SQL->bindValue(':User_Name', $User_Name);
    $SQL->execute();
    $username = $SQL->fetch();

    if($username === false)
        {
            $Password = null;
        }
    else
        {
            $Password = $username['Password'];
        }

    return $Password;
    $SQL->closeCursor();
    $db = null;

    } catch(PDOException $e){
        $error_message = $e->getMessage();
        echo("<p>Database Error: $error_message</p>");
        exit();
    }

}
function showForm($formMessage = "Please Enter Valid User ID and Password")
{ ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T23:14:00.087

```
<?php
//declaring variables and assigning values from log in form

//validate text was entered in UserName text box
if(empty($_POST['txtUserName']))
    {
        showForm(null);
        exit();
    }
else
    {
        $User_Name = $_POST['txtUserName'];
    }

//validate text was entered in password text box
if(empty($_POST['txtPassword']))
    {
        showForm(null);
        exit();
    }
else
    {
        $Password = $_POST['txtPassword'];
    }

if ($Password != Password($User_Name))
{
    include "teamc/index.php";
} 
else
{
    showForm('Customer ID and Password did not match. Please try again!');
    exit();
}

function Password($User_Name)
{   
//$UserName = $_GET['txtUserName'];
//$Password = $_GET['txtPassword'];

//declare and assign values to variables
$dsn = 'mysql:host=XXX;dbname=XXX';
$username='XXX';
$password='XXX';
//variable for errors
$options = array(PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION);
//try to run code
try {
//object to open database
$db = new PDO($dsn,$username,$password, $options);
//check username against password
    $SQL = $db->prepare("Select USER_PASSWORD FROM user WHERE USER_NAME = :USER_NAME");
    $SQL->bindValue(':USER_NAME', $User_Name);
    $SQL->execute();
    $username = $SQL->fetch();

    if($username === false)
        {
            $Password = null;
        }
    else
        {
            $Password = $username['USER_PASSWORD'];
        }

    return $Password;
    $SQL->closeCursor();
    $db = null;

    } catch(PDOException $e){
        $error_message = $e->getMessage();
        echo("<p>Database Error: $error_message</p>");
        exit();
    }

}
function showForm($formMessage = "Please Enter Valid User ID and Password")
{ ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T19:55:40.860

PHP 区分大小写，这意味着 :User_Name 与 :USER_NAME 不同。

因此改变

```
:USER_NAME to :User_Name 
```

# c# - 在 WPF 中使用 MessageBox 避免歧义

> ID：15209886
> 
> 赞同：1
> 
> 时间：2013-03-04T19:49:05.123
> 
> 标签：c#, wpf, winforms, messagebox

我最近经常遇到这个问题。我经常使用 WPF/C# 编写程序，并希望使用`OpenFileDialog`需要`System.Windows.Forms`. 我也经常使用 MessageBoxes（当添加 Forms 时，它们在两个库之间变得模棱两可）。

我添加了引用，但是（即使使用快捷方式）我必须使用类似`F.MessageBox.Show()`. 有没有办法`System.Windows.Forms`在我需要时临时使用参考或其他可以让我保持`MessageBox.Show()`完整的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T19:52:59.130

Microsoft 将许多 Windows 对话框移至 Microsoft.Win32 命名空间，因此您无需添加对所有 System.Windows.Forms 的引用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T19:52:48.490

您可以将以下 using 指令放在需要 WinForms MessageBox 的文件之上：

```
using MessageBox = System.Windows.Forms.MessageBox; 
```

这将解决歧义

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T19:57:39.503

我建议您使用 wpf 提供的等价物。这是 System.Windows.MessageBox。它几乎看起来像 windows 窗体中的那个，但是参数和返回值可能不同。下面是一个示例来说明它的使用。

```
var res = MessageBox.Show("Shutdown now ?", "Confirmation", MessageBoxButton.YesNo, MessageBoxImage.Question);
if (res== MessageBoxResult.Yes)
{
    Application.Current.Shutdown();
} 
```

# datanucleus - 奇怪的“com.vividsolutions.jts.geom.Geometry”ClassNotResolvedException 异常

> ID：15209890
> 
> 赞同：0
> 
> 时间：2013-03-04T19:49:15.760
> 
> 标签：datanucleus, jdoql

我正在执行一个看起来有点复杂的 JDOQL 查询：

```
Query q = pm.newQuery(IxlTest.class, "id == :tId && parameterGroups.get(oGroup.key).contains(tp) && oGroup.contains(opt) && opt.displayInResults");
q.setResult("oGroup, opt");
vars.append(TestTypeOptionsGroup.class.getName() + " oGroup;");
vars.append(TestTypeOption.class.getName() + " opt;");
vars.append(TestParameterGroup.class.getName() + " tpGroup;");
vars.append(TestParameter.class.getName() + " tp;");
q.declareVariables(vars.toString());
System.out.println(q.execute(testId)); 
```

我没有理由认为 DN 需要那个`Geometry`课程，因为我的课程与几何无关。这是`parameterGroups`映射`IxlTest`

```
@Persistent(defaultFetchGroup = "true", table = "ixl_test_parameter_groups_rel")
@Join(column = "test_fk", extensions = { @Extension(vendorName = "datanucleus", key = "primary-key", value = "false") })
@Key(types = { String.class }, column = "test_parameter_group_key", mappedBy = "name", dependent = "true")
@Value(types = { TestParameterGroup.class }, column = "test_parameter_group_fk", dependent = "true")
private Map<String, TestParameterGroup> parameterGroups; 
```

这些是`TestParameterGroup`字段

```
@Persistent(primaryKey = "true", valueStrategy = IdGeneratorStrategy.IDENTITY)
private long id;
private String name;
private String key;
private boolean active;
@Column(name = "script_substitute")
private boolean scriptSubstitute;
@Column(name = "substitute_all")
private boolean substituteAll;
@Column(name = "script_value_when_checked")
private String scriptValueWhenChecked;
@Column(name = "script_value_when_unchecked")
private String scriptValueWhenUnChecked;
@Persistent(defaultFetchGroup = "true")
@Key(types = { String.class }, mappedBy = "key", dependent = "true")
@Value(types = { TestParameter.class }, column = "parameters_group_id", dependent = "true")
private Map<String, TestParameter> parameters; 
```

这些是`TestParameter`字段

```
@Persistent(primaryKey = "true", valueStrategy = IdGeneratorStrategy.IDENTITY)
private long id;
private String key;
private String value;
private boolean active;
@Column(name = "script_substitute")
private boolean scriptSubstitute;
@Column(name = "substitute_all")
private boolean substituteAll; 
```

我仍在构建我的查询，但为了确保没有任何问题，我尝试在完成整个查询之前运行它，但我得到了这个异常：

```
javax.jdo.JDOException: Class "com.vividsolutions.jts.geom.Geometry" was not found in the CLASSPATH. Please check your specification and your CLASSPATH.
    at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:570)
    at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:252)

Class "com.vividsolutions.jts.geom.Geometry" was not found in the CLASSPATH. Please check your specification and your CLASSPATH.
org.datanucleus.exceptions.ClassNotResolvedException: Class "com.vividsolutions.jts.geom.Geometry" was not found in the CLASSPATH. Please check your specification and your CLASSPATH.
    at org.datanucleus.JDOClassLoaderResolver.classForName(JDOClassLoaderResolver.java:245)
    at org.datanucleus.JDOClassLoaderResolver.classForName(JDOClassLoaderResolver.java:410)
    at org.datanucleus.store.rdbms.sql.expression.SQLExpressionFactory.invokeMethod(SQLExpressionFactory.java:382)
    at org.datanucleus.store.rdbms.sql.expression.ObjectExpression.invoke(ObjectExpression.java:783)
    at org.datanucleus.store.rdbms.query.QueryToSQLMapper.processInvokeExpression(QueryToSQLMapper.java:2871)
    at org.datanucleus.query.evaluator.AbstractExpressionEvaluator.compilePrimaryExpression(AbstractExpressionEvaluator.java:200)
    at org.datanucleus.query.evaluator.AbstractExpressionEvaluator.compileUnaryExpression(AbstractExpressionEvaluator.java:169)
    at org.datanucleus.query.evaluator.AbstractExpressionEvaluator.compileAdditiveMultiplicativeExpression(AbstractExpressionEvaluator.java:148)
    at org.datanucleus.query.evaluator.AbstractExpressionEvaluator.compileRelationalExpression(AbstractExpressionEvaluator.java:123)
    at org.datanucleus.query.evaluator.AbstractExpressionEvaluator.compileOrAndExpression(AbstractExpressionEvaluator.java:65)
    at org.datanucleus.query.evaluator.AbstractExpressionEvaluator.evaluate(AbstractExpressionEvaluator.java:46)
    at org.datanucleus.query.expression.Expression.evaluate(Expression.java:337)
    at org.datanucleus.query.expression.DyadicExpression.evaluate(DyadicExpression.java:70)
    at org.datanucleus.query.expression.DyadicExpression.evaluate(DyadicExpression.java:67)
    at org.datanucleus.query.expression.DyadicExpression.evaluate(DyadicExpression.java:67)
    at org.datanucleus.store.rdbms.query.QueryToSQLMapper.compileFilter(QueryToSQLMapper.java:461)
    at org.datanucleus.store.rdbms.query.QueryToSQLMapper.compile(QueryToSQLMapper.java:381)
    at org.datanucleus.store.rdbms.query.JDOQLQuery.compileQueryFull(JDOQLQuery.java:883)
    at org.datanucleus.store.rdbms.query.JDOQLQuery.compileInternal(JDOQLQuery.java:343)
    at org.datanucleus.store.query.Query.executeQuery(Query.java:1747)
    at org.datanucleus.store.query.Query.executeWithArray(Query.java:1666)
    at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:243) 
```

为什么 DN 认为我需要任何基于地理的课程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T11:36:05.947

查询很奇怪（恕我直言）。你有

```
parameterGroups.get(oGroup.key).contains(tp) 
```

然而*“parameterGroups”*是一个地图，所以*“parameterGroups.get(...)”*是一个**TestParameterGroup**。因此，*“TestParameterGroup.contains”*试图做什么。或者“oGroup.contains(...)”也为此。

如果您将该类抛出异常，那么您可以引用它，或者在类路径中包含各种随机 jar，例如“datanucleus-spatial”。

# javascript - 这是什么href？

> ID：15209892
> 
> 赞同：1
> 
> 时间：2013-03-04T19:49:19.863
> 
> 标签：javascript, html, url

我试图理解这个特定的链接。我怀疑它会启动某种 Java 脚本，但我不确定。我最终想要的是提取 URL。

html标签是这样的：

```
<a href="#" 
    onclick="if(typeof jsfcljs == 
        'function' {jsfcljs(document.getElementById('resultadoForm'),
    {'resultado:0:j_id234':'resultado:0:j_id234'},'');}
    return false">
        11024968
</a> 
```

这可以通过转到`http://www.dataescolabrasil.inep.gov.br/dataEscolaBrasil/home.seam`，在“Código”中输入“11024968”，然后提交表单（“Pesquisar”）来实现。上面显示的链接适用于“11024968”。

还，

```
<script type="text/javascript" language="Javascript">function dpf(f) {var adp = f.adp;if (adp != null) {for (var i = 0;i < adp.length;i++) {f.removeChild(adp[i]);}}};function apf(f, pvp) {var adp = new Array();f.adp = adp;var i = 0;for (k in pvp) {var p = document.createElement("input");p.type = "hidden";p.name = k;p.value = pvp[k];f.appendChild(p);adp[i++] = p;}};function jsfcljs(f, pvp, t) {apf(f, pvp);var ft = f.target;if (t) {f.target = t;}f.submit();f.target = ft;dpf(f);};</script> 
```

因此，如果有人能解释如何关注（或提取）文本为“11024968”的网址，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:51:31.203

该链接指向一个空锚。这通常用于 JavaScript 处理的链接。因此，如果您的 JavaScript 失败，只需将哈希标记添加到当前 url。

魔法发生在`jsfcljs()`JavaScript 函数的代码中。没有代码，我们现在不能说更多。

让我们重新格式化代码并给它们起更好的名字：

```
function dpf(f) {                  // let's rename this to removeParameters
    var adp = f.adp;               // element store from apf (addParameters)
    if(adp != null) {              // check if the parematers needs to be removed
        for(var i=0; i<adp.length; i++) { // interates thrue the known paramters
            f.removeChild(adp[i]); // removes a child
        }
    }
};
function apf(f, pvp) { // let's rename this to addParameters
    var adp = new Array();
    f.adp = adp;
    var i = 0;
    for(k in pvp) { // iterates thrue the json structure
        // appends all parameters from the json structure to the
        // element store (apd) and to the given formular (f)
        var p = document.createElement("input");
        p.type = "hidden";
        p.name = k;
        p.value = pvp[k];
        f.appendChild(p);
        adp[i++] = p;
    }
};
function jsfcljs(f, pvp, t) { // let's rename this to postJsonData
    apf(f, pvp);              // add paramaters
    var ft = f.target;        // store orginal target
    if(t) {
        f.target = t;         // set new target if given
    }
    f.submit();               // submit the form
    f.target = ft;            // restore target
    dpf(f);                   // remove added parameters
}; 
```

# node.js - node.js 上 Azure 表存储的 CPU 使用率高

> ID：15209893
> 
> 赞同：0
> 
> 时间：2013-03-04T19:49:25.550
> 
> 标签：node.js, azure, profiler, azure-table-storage

我试图弄清楚为什么我的测试应用程序在负载测试 Azure 表存储插入时使用 100%。

在 100% cpu 下，我在一个小实例上获得大约 230 次插入/秒。我不确定这个数字是否可以，但即便如此我认为 cpu 使用率太高了。

我的应用程序基本上就是这样做的：

```
function insert(id)
{
  var task={ PartitionKey: id, RowKey: "1", Description: "bench bench bench" };
  pending.inc();
  var ts=azure.createTableService();
  ts.insertEntity("bench", task, function (err)
  {
    pending.dec();
    if (err) return console.log("error", err);
    reqStats.mark();
  });
} 
```

如果挂起低于 250，则添加另外 250 个插入（对于此测试，没有记录错误）。

我用 --prof 运行了节点，但我不确定如何解释输出：

```
Code move event for unknown code: 0x3fe5b8c0
Statistical profiling result from v8.log, (7703 ticks, 1 unaccounted, 0 excluded).

 [Unknown]:
   ticks  total  nonlib   name
      1    0.0%

 [Shared libraries]:
   ticks  total  nonlib   name
   4003   52.0%    0.0%  D:\Windows\SYSTEM32\ntdll.dll
   3347   43.5%    0.0%  F:\approot\node.exe
     47    0.6%    0.0%  D:\Windows\SYSTEM32\KERNEL32.DLL
     44    0.6%    0.0%  D:\Windows\SYSTEM32\KERNELBASE.dll
      3    0.0%    0.0%  D:\Windows\system32\mswsock.dll
      1    0.0%    0.0%  D:\Windows\SYSTEM32\WS2_32.dll

 [JavaScript]:
   ticks  total  nonlib   name
     14    0.2%    5.4%  Stub: CEntryStub
     12    0.2%    4.7%  Function: write F:\approot\node_modules\azure\node_modules\xml2js\node_modules\sax\lib\sax.js:883
     10    0.1%    3.9%  Function: EventEmitter.addListener events.js:138
      7    0.1%    2.7%  KeyedLoadIC: A keyed load IC from the snapshot
      7    0.1%    2.7%  Function: ~Request.init F:\approot\node_modules\azure\node_modules\request\main.js:108
      7    0.1%    2.7%  Function: ~ClientRequest http.js:1254
      6    0.1%    2.3%  Stub: StringAddStub
      5    0.1%    1.9%  Stub: RegExpExecStub
      5    0.1%    1.9%  LazyCompile: *urlParse url.js:92
      5    0.1%    1.9%  LazyCompile: *match native string.js:182
      5    0.1%    1.9%  Function: ~XMLFragment.toString F:\approot\node_modules\azure\node_modules\xmlbuilder\lib\XMLFragment.js:287
      4    0.1%    1.6%  LazyCompile: stringify native json.js:307
      4    0.1%    1.6%  LazyCompile: *formatProperty util.js:338
      4    0.1%    1.6%  LazyCompile: *formatPrimitive util.js:289
      4    0.1%    1.6%  LazyCompile: *EventEmitter.emit events.js:54
      4    0.1%    1.6%  Function: ~store http.js:571
      4    0.1%    1.6%  CallMegamorphic: args_count: 1
      3    0.0%    1.2%  Stub: SubStringStub
      3    0.0%    1.2%  LazyCompile: IN native runtime.js:354
      3    0.0%    1.2%  LazyCompile: APPLY_PREPARE native runtime.js:438
      3    0.0%    1.2%  LazyCompile: *GetOwnProperty native v8natives.js:637
      3    0.0%    1.2%  LazyCompile: *FromPropertyDescriptor native v8natives.js:373
      3    0.0%    1.2%  LazyCompile: *Encode native uri.js:179
      3    0.0%    1.2%  LazyCompile: *BuildResultFromMatchInfo native regexp.js:130
      3    0.0%    1.2%  Function: ~StorageServiceClient._buildRequestOptions F:\approot\node_modules\azure\lib\services\core\storageserviceclient.js:192
      3    0.0%    1.2%  Function: ~AtomHandler._writeAtomEntryValue F:\approot\node_modules\azure\lib\util\atomhandler.js:205
      3    0.0%    1.2%  Function: formatValue util.js:189
      3    0.0%    1.2%  CallMegamorphic: args_count: 3
      3    0.0%    1.2%  Builtin: A builtin from the snapshot {2}
      2    0.0%    0.8%  Stub: KeyedStoreElementStub {1}
      2    0.0%    0.8%  Stub: FastNewClosureStub
      2    0.0%    0.8%  Stub: CompareStub
      2    0.0%    0.8%  RegExp: ^"([a-zA-Z_][a-zA-Z_0-9]*)"$
      2    0.0%    0.8%  RegExp: Content-Length
      2    0.0%    0.8%  LazyCompile: join native array.js:410
      2    0.0%    0.8%  LazyCompile: ToString native runtime.js:550
      2    0.0%    0.8%  LazyCompile: ConvertToString native array.js:195
      2    0.0%    0.8%  LazyCompile: *toLowerCase native string.js:739
      2    0.0%    0.8%  LazyCompile: *socketOnData http.js:1480
      2    0.0%    0.8%  LazyCompile: *slice native string.js:510
      2    0.0%    0.8%  LazyCompile: *indexOf native string.js:118
      2    0.0%    0.8%  LazyCompile: *exports.stringStartsWith F:\approot\node_modules\azure\lib\util\util.js:131
      2    0.0%    0.8%  LazyCompile: *XMLFragment F:\approot\node_modules\azure\node_modules\xmlbuilder\lib\XMLFragment.js:8
      2    0.0%    0.8%  LazyCompile: *IsDataDescriptor native v8natives.js:354
      2    0.0%    0.8%  LazyCompile: *EventEmitter events.js:25
      2    0.0%    0.8%  Function: ~XMLFragment.element F:\approot\node_modules\azure\node_modules\xmlbuilder\lib\XMLFragment.js:18
      2    0.0%    0.8%  Function: ~Request.init F:\approot\node_modules\azure\node_modules\request\main.js:362
      2    0.0%    0.8%  Function: ~OutgoingMessage.end http.js:794
      2    0.0%    0.8%  Function: ~Logger.log F:\approot\node_modules\azure\lib\diagnostics\logger.js:68
      2    0.0%    0.8%  Builtin: A builtin from the snapshot {3}
      2    0.0%    0.8%  Builtin: A builtin from the snapshot {1}
      1    0.0%    0.4%  Stub: ToBooleanStub_String
      1    0.0%    0.4%  Stub: ToBooleanStub
      1    0.0%    0.4%  Stub: StoreArrayLiteralElementStub
      1    0.0%    0.4%  Stub: RecordWriteStub {1}
      1    0.0%    0.4%  Stub: RecordWriteStub
      1    0.0%    0.4%  Stub: NumberToStringStub
      1    0.0%    0.4%  Stub: KeyedStoreElementStub
      1    0.0%    0.4%  Stub: JSEntryStub
      1    0.0%    0.4%  Stub: InstanceofStub
      1    0.0%    0.4%  Stub: CallFunctionStub_Args0
      1    0.0%    0.4%  Stub: CallConstructStub_Recording
      1    0.0%    0.4%  Stub: CallConstructStub
      1    0.0%    0.4%  Stub: BinaryOpStub_ADD_OverwriteRight_BothStrings
      1    0.0%    0.4%  Stub: BinaryOpStub_ADD_OverwriteLeft_SMI
      1    0.0%    0.4%  Stub: BinaryOpStub_ADD_OverwriteLeft_BothStrings
      1    0.0%    0.4%  RegExp: [^A-Za-z0-9_-]
      1    0.0%    0.4%  RegExp: Date
      1    0.0%    0.4%  RegExp: (^"|"$)
      1    0.0%    0.4%  LazyCompile: toString native v8natives.js:223
      1    0.0%    0.4%  LazyCompile: Join native array.js:119
      1    0.0%    0.4%  LazyCompile: FILTER_KEY native runtime.js:398
      1    0.0%    0.4%  LazyCompile: *test native regexp.js:220
      1    0.0%    0.4%  LazyCompile: *startup.processNextTick.process.nextTick node.js:254
      1    0.0%    0.4%  LazyCompile: *startup.processNextTick.process._tickCallback node.js:233
      1    0.0%    0.4%  LazyCompile: *split native string.js:554
      1    0.0%    0.4%  LazyCompile: *replace native string.js:221
      1    0.0%    0.4%  LazyCompile: *onread net.js:377
      1    0.0%    0.4%  LazyCompile: *map native array.js:1190
      1    0.0%    0.4%  LazyCompile: *isRegExp util.js:427
      1    0.0%    0.4%  LazyCompile: *isArray native array.js:1463
      1    0.0%    0.4%  LazyCompile: *indexOf native array.js:1236
      1    0.0%    0.4%  LazyCompile: *freeParser http.js:1385
      1    0.0%    0.4%  LazyCompile: *forEach native array.js:1062
      1    0.0%    0.4%  LazyCompile: *copy F:\approot\node_modules\azure\node_modules\request\main.js:72
      1    0.0%    0.4%  LazyCompile: *afterConnect net.js:719
      1    0.0%    0.4%  LazyCompile: *insert F:\approot\server.js:1949
      1    0.0%    0.4%  LazyCompile: *UseSparseVariant native array.js:111
      1    0.0%    0.4%  LazyCompile: *TwoDigitString native date.js:213
      1    0.0%    0.4%  LazyCompile: *TableService.insertEntity F:\approot\node_modules\azure\lib\services\table\tableservice.js:500
      1    0.0%    0.4%  LazyCompile: *StringSplitOnRegExp native string.js:591
      1    0.0%    0.4%  LazyCompile: *Socket._write net.js:515
      1    0.0%    0.4%  LazyCompile: *Socket net.js:131
      1    0.0%    0.4%  LazyCompile: *ServiceClient.performRequest F:\approot\node_modules\azure\lib\services\core\serviceclient.js:161
      1    0.0%    0.4%  LazyCompile: *Request.end F:\approot\node_modules\azure\node_modules\request\main.js:952
      1    0.0%    0.4%  LazyCompile: *PropertyDescriptor native v8natives.js:482
      1    0.0%    0.4%  LazyCompile: *OutgoingMessage.write http.js:731
      1    0.0%    0.4%  LazyCompile: *CookieJar.get F:\approot\node_modules\azure\node_modules\request\vendor\cookie\jar.js:46
      1    0.0%    0.4%  LazyCompile: *AtomHandler._convertToAtomPropertyText F:\approot\node_modules\azure\lib\util\atomhandler.js:279
      1    0.0%    0.4%  LazyCompile: *Agent.addRequest http.js:1170
      1    0.0%    0.4%  LazyCompile: *$Array.configurable_ native v8natives.js:540
      1    0.0%    0.4%  Function: ~onanswer dns.js:116
      1    0.0%    0.4%  Function: ~forEach F:\approot\node_modules\lodash\dist\lodash.js:2325
      1    0.0%    0.4%  Function: ~exports.Parser.Parser.reset.saxParser.onopentag F:\approot\node_modules\azure\node_modules\xml2js\lib\xml2js.js:108
      1    0.0%    0.4%  Function: ~exports.Parser.Parser.reset.saxParser.onclosetag F:\approot\node_modules\azure\node_modules\xml2js\lib\xml2js.js:135
      1    0.0%    0.4%  Function: ~asyncCallback dns.js:65
      1    0.0%    0.4%  Function: ~WebResource.getQueryStringValues F:\approot\node_modules\azure\lib\http\webresource.js:204
      1    0.0%    0.4%  Function: ~WebResource.getQueryString F:\approot\node_modules\azure\lib\http\webresource.js:223
      1    0.0%    0.4%  Function: ~Socket.connect net.js:687
      1    0.0%    0.4%  Function: ~Socket.connect net.js:651
      1    0.0%    0.4%  Function: ~ServiceClient._performRequest.self._buildRequestOptions.requestStream.end F:\approot\node_modules\azure\lib\services\core\serviceclient.js:239
      1    0.0%    0.4%  Function: ~ServiceClient._performRequest.self._buildRequestOptions.operation F:\approot\node_modules\azure\lib\services\core\serviceclient.js:216
      1    0.0%    0.4%  Function: ~Request.write F:\approot\node_modules\azure\node_modules\request\main.js:948
      1    0.0%    0.4%  Function: ~Request.start.self.req.self.httpModule.request.response.on.self._ended F:\approot\node_modules\azure\node_modules\request\main.js:617
      1    0.0%    0.4%  Function: ~Request F:\approot\node_modules\azure\node_modules\request\main.js:84
      1    0.0%    0.4%  Function: ~EventEmitter.addListener events.js:138
      1    0.0%    0.4%  Function: ~AtomHandler.serialize F:\approot\node_modules\azure\lib\util\atomhandler.js:174
      1    0.0%    0.4%  CallNormal: args_count: 0
      1    0.0%    0.4%  CallMegamorphic: args_count: 2
      1    0.0%    0.4%  Builtin: A builtin from the snapshot {5}
      1    0.0%    0.4%  Builtin: A builtin from the snapshot {4}
      1    0.0%    0.4%  Builtin: A builtin from the snapshot

 [C++]:
   ticks  total  nonlib   name

 [GC]:
   ticks  total  nonlib   name
    268    3.5%

 [Bottom up (heavy) profile]:
  Note: percentage shows a share of a particular caller in the total
  amount of its parent calls.
  Callers occupying less than 2.0% are not shown.

   ticks parent  name
   4003   52.0%  D:\Windows\SYSTEM32\ntdll.dll
     97    2.4%    LazyCompile: *connect net.js:614
     97  100.0%      Function: ~Socket.connect net.js:687
     97  100.0%        Function: ~asyncCallback dns.js:65
     97  100.0%          Function: ~onanswer dns.js:116

   3347   43.5%  F:\approot\node.exe
    533   15.9%    Function: exports.Parser.Parser.parseString F:\approot\node_modules\azure\node_modules\xml2js\lib\xml2js.js:205
    533  100.0%      Function: ~__bind F:\approot\node_modules\azure\node_modules\xml2js\lib\xml2js.js:6
    533  100.0%        Function: ServiceClient._parseResponse F:\approot\node_modules\azure\lib\services\core\serviceclient.js:499
    516   96.8%          LazyCompile: *ServiceClient._processResponse F:\approot\node_modules\azure\lib\services\core\serviceclient.js:307
    516  100.0%            Function: ~ServiceClient._performRequest.self._buildRequestOptions.processResponseCallback F:\approot\node_modules\azure\lib\services\core\serviceclient.js:219
     17    3.2%          Function: ~ServiceClient._processResponse F:\approot\node_modules\azure\lib\services\core\serviceclient.js:307
     17  100.0%            Function: ~ServiceClient._performRequest.self._buildRequestOptions.processResponseCallback F:\approot\node_modules\azure\lib\services\core\serviceclient.js:219
    258    7.7%    LazyCompile: *socketOnData http.js:1480
    172   66.7%      LazyCompile: *onread net.js:377
      7    2.7%      Function: ~onread net.js:377
    196    5.9%    LazyCompile: *is F:\approot\node_modules\azure\node_modules\xml2js\node_modules\sax\lib\sax.js:275
    196  100.0%      Function: write F:\approot\node_modules\azure\node_modules\xml2js\node_modules\sax\lib\sax.js:883
    196  100.0%        Function: exports.Parser.Parser.parseString F:\approot\node_modules\azure\node_modules\xml2js\lib\xml2js.js:205
    196  100.0%          Function: ~__bind F:\approot\node_modules\azure\node_modules\xml2js\lib\xml2js.js:6
    196  100.0%            Function: ServiceClient._parseResponse F:\approot\node_modules\azure\lib\services\core\serviceclient.js:499
    161    4.8%    Function: write F:\approot\node_modules\azure\node_modules\xml2js\node_modules\sax\lib\sax.js:883
    161  100.0%      Function: exports.Parser.Parser.parseString F:\approot\node_modules\azure\node_modules\xml2js\lib\xml2js.js:205
    161  100.0%        Function: ~__bind F:\approot\node_modules\azure\node_modules\xml2js\lib\xml2js.js:6
    161  100.0%          Function: ServiceClient._parseResponse F:\approot\node_modules\azure\lib\services\core\serviceclient.js:499
    156   96.9%            LazyCompile: *ServiceClient._processResponse F:\approot\node_modules\azure\lib\services\core\serviceclient.js:307
      5    3.1%            Function: ~ServiceClient._processResponse F:\approot\node_modules\azure\lib\services\core\serviceclient.js:307
     90    2.7%    Function: ~ClientRequest.onSocket http.js:1617
     86   95.6%      LazyCompile: *startup.processNextTick.process._tickCallback node.js:233
      4    4.4%      Function: ~startup.processNextTick.process._tickCallback node.js:233
     85    2.5%    LazyCompile: *EventEmitter.emit events.js:54
     29   34.1%      Function: <anonymous> F:\approot\node_modules\azure\node_modules\request\main.js:636
     29  100.0%        LazyCompile: *EventEmitter.emit events.js:54
     29  100.0%          Function: ~Request.start.self.req.self.httpModule.request.buffer F:\approot\node_modules\azure\node_modules\request\main.js:621
     29  100.0%            LazyCompile: *EventEmitter.emit events.js:54
     23   27.1%      Function: ~Socket._destroy.destroyed net.js:357
     23  100.0%        LazyCompile: *startup.processNextTick.process._tickCallback node.js:233
     17   20.0%      Function: EventEmitter.addListener events.js:138
      7   41.2%        Function: ~<anonymous> F:\approot\node_modules\azure\node_modules\request\main.js:519
      7  100.0%          Function: ~g events.js:190
      7  100.0%            LazyCompile: *EventEmitter.emit events.js:54
      5   29.4%        Function: ~Request.start F:\approot\node_modules\azure\node_modules\request\main.js:503
      5  100.0%          Function: ~Request.write F:\approot\node_modules\azure\node_modules\request\main.js:948
      5  100.0%            Function: ~Request.init F:\approot\node_modules\azure\node_modules\request\main.js:362
      2   11.8%        LazyCompile: *Agent.createSocket http.js:1189
      2  100.0%          LazyCompile: *Agent.addRequest http.js:1170
      2  100.0%            Function: ~ClientRequest http.js:1254
      1    5.9%        LazyCompile: *parserOnIncomingClient http.js:1531
      1  100.0%          LazyCompile: *socketOnData http.js:1480
      1    5.9%        LazyCompile: *EventEmitter.once events.js:184
      1  100.0%          Function: ~<anonymous> F:\approot\node_modules\azure\node_modules\request\main.js:519
      1  100.0%            Function: ~g events.js:190
      1    5.9%        Function: ~Request.init F:\approot\node_modules\azure\node_modules\request\main.js:108
      1  100.0%          Function: ~Request F:\approot\node_modules\azure\node_modules\request\main.js:84
      1  100.0%            LazyCompile: *request F:\approot\node_modules\azure\node_modules\request\main.js:983
      4    4.7%      LazyCompile: *parserOnMessageComplete http.js:127
      4  100.0%        LazyCompile: *socketOnData http.js:1480
      3   75.0%          LazyCompile: *onread net.js:377
      3    3.5%      LazyCompile: *responseOnEnd http.js:1591
      3  100.0%        LazyCompile: *EventEmitter.emit events.js:54
      2   66.7%          LazyCompile: *IncomingMessage._emitEnd http.js:364
      2  100.0%            Function: ~parserOnMessageComplete http.js:127
      1   33.3%          LazyCompile: *parserOnMessageComplete http.js:127
      1  100.0%            LazyCompile: *socketOnData http.js:1480
      2    2.4%      Function: ~Request.start.self.req.self.httpModule.request.buffer F:\approot\node_modules\azure\node_modules\request\main.js:621
      2  100.0%        LazyCompile: *EventEmitter.emit events.js:54
      1   50.0%          Function: ~parserOnMessageComplete http.js:127
      1  100.0%            LazyCompile: *socketOnData http.js:1480
      1   50.0%          Function: ~IncomingMessage._emitEnd http.js:364
      1  100.0%            Function: ~parserOnMessageComplete http.js:127
      2    2.4%      Function: ~Agent.createSocket.onFree http.js:1209
      2  100.0%        LazyCompile: *EventEmitter.emit events.js:54
      2  100.0%          LazyCompile: *responseOnEnd http.js:1591
      2  100.0%            LazyCompile: *EventEmitter.emit events.js:54
     74    2.2%    LazyCompile: *replace native string.js:221
     44   59.5%      LazyCompile: *formatPrimitive util.js:289
     29   65.9%        LazyCompile: *formatValue util.js:189
     29  100.0%          LazyCompile: *formatProperty util.js:338
     29  100.0%            Function: <anonymous> util.js:278
     15   34.1%        Function: formatValue util.js:189
     15  100.0%          LazyCompile: *formatProperty util.js:338
     15  100.0%            Function: <anonymous> util.js:278
     26   35.1%      LazyCompile: *formatProperty util.js:338
     26  100.0%        Function: <anonymous> util.js:278
     26  100.0%          LazyCompile: *map native array.js:1190
     16   61.5%            LazyCompile: *formatValue util.js:189
     10   38.5%            Function: formatValue util.js:189
      3    4.1%      LazyCompile: *Agent.createSocket http.js:1189
      3  100.0%        LazyCompile: *Agent.addRequest http.js:1170
      3  100.0%          Function: ~ClientRequest http.js:1254
      3  100.0%            Function: ~exports.request http.js:1718 
```

显然在exports.Parser.Parser.parseString 上花费了很多时间（对吗？） - 但为什么该函数只列在自下而上的表中？

为什么一半的时间花在了ntdll上？

这是 azure-sdk-for-node 的问题，还是 node.js 本身的问题，还是我的期望太高了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:35:37.967

我将在这里填写一个基本答案。

看起来您所有的 CPU 工作都在网络级别以及将 XML 序列化到 JSON 或从 JSON 序列化。在评论中，您提到从 .NET 中获得 2-4 倍的性能提升。

> 这是 azure-sdk-for-node 的问题，还是 node.js 本身的问题，还是我的期望太高了？

我认为这两个部分的答案都是肯定的。

在纯粹受 CPU 限制的情况下，Windows 上的 .NET 将击败 Windows 上的 Node.JS。这里不是真正的比赛。

`azure-sdk-for-node`也就是说， Node.JS 本身和内部也很可能存在一些性能瓶颈。大多数这些东西已经存在了不到一年，node.js 主要是为 Linux 而不是 Windows 运行和调整的。

我强烈建议在 Linux 机器上测试相同的东西（*你可以在 Azure 中托管这些*），看看你是否能获得更好的性能。我还建议与处理 Node.js 的@MS 团队分享你的东西。

# ios - 更改委托方法的参数类型

> ID：15209896
> 
> 赞同：3
> 
> 时间：2013-03-04T19:49:46.303
> 
> 标签：ios, objective-c, delegates, nsinteger, nsuinteger

我有一个 NSURL 委托方法，它以 NSInteger 作为参数

```
- (void)connection:(NSURLConnection *)connection didSendBodyData:(NSInteger)bytesWritten totalBytesWritten:(NSInteger)totalBytesWritten totalBytesExpectedToWrite:(NSInteger)totalBytesExpectedToWrite 
```

有符号长整数的 NSInteger 范围为 -2147483647 到 2147483647。我的问题是，有时我得到的值超出了正数范围，这会导致该值变为我不想要的负数。

所以我将 NSInteger 更改为 NSUInteger

```
 - (void)connection:(NSURLConnection *)connection didSendBodyData:(NSUInteger)bytesWritten totalBytesWritten:(NSUInteger)totalBytesWritten totalBytesExpectedToWrite:(NSUInteger)totalBytesExpectedToWrite 
```

我的问题是是否可以进行这样的更改？到目前为止，我还没有遇到任何问题，正在调用该方法，并且我得到了预期的结果。

我担心可能会发生一些无法预料的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T20:32:57.760

这样做很好。更改`NSInteger`为`NSUInteger`仅执行普通的铸造。但是，我会将其保留`NSInteger`为方法参数，然后在方法实现开始时将其显式转换为`NSUInteger`.

# r - geom_text() 中超过 1 种颜色

> ID：15209899
> 
> 赞同：7
> 
> 时间：2013-03-04T19:49:53.000
> 
> 标签：r, ggplot2

我有这个数据：

```
data <- structure(list(Cod.projeto = c(7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L
), Nome.projeto = c("ESCOLAS INFANTIS", "ESCOLAS INFANTIS", "ESCOLAS INFANTIS", 
"ESCOLAS INFANTIS", "ESCOLAS INFANTIS", "ESCOLAS INFANTIS", "ESCOLAS INFANTIS", 
"ESCOLAS INFANTIS"), Secretarua = c("SMED", "SMED", "SMED", "SMED", 
"SMED", "SMED", "SMED", "SMED"), Comp = structure(c(1L, 2L, 1L, 
2L, 1L, 2L, 1L, 2L), .Label = c("28/02/2013", "01/03/2013"), class = c("ordered", 
"factor")), Estado = c("Criadas", "Criadas", "Providas", "Providas", 
"Criadas", "Criadas", "Providas", "Providas"), Categoria = c("A/G", 
"A/G", "A/G", "A/G", "B", "B", "B", "B"), Vagas = c(67, 67, 63, 
63, 124, 124, 73, 72)), .Names = c("Cod.projeto", "Nome.projeto", 
"Secretarua", "Comp", "Estado", "Categoria", "Vagas"), row.names = c(NA, 
-8L), class = "data.frame") 
```

这个`ggplot2()`条形图：

```
require(ggplot2)
ggplot(data, aes(x=Categoria, y=Vagas, fill=relevel(factor(Estado),'Providas'))) +   
  geom_bar(position='dodge', stat='identity') +
  ggtitle(substitute(atop(titulo, atop(subtitulo)),list(titulo=paste(data[1,1:2],collapse=' - '),subtitulo=data[1,3]))) +
  theme(legend.position = "bottom") +
  xlab("Categoria") +
  ylab("Vagas") +
  scale_fill_grey('') +
  theme(panel.background = element_rect(fill='white'),panel.grid.major = element_line(colour = "gray70", linetype = 2)) +
  geom_text(aes(x=Categoria, y=Vagas/2, label = sprintf("%1.0f", Vagas)),position = position_dodge(height=1,width=1), size=4, colour='white') +
  facet_wrap( ~ Comp) 
```

导致：![我的情节](../Images/ce0cdc8a06cf4d145f013c768bb306bd.png)

我只想在浅灰色列（Categoria = Criadas）中更改文本的颜色。我已经尝试在`colour`参数中使用两个值，但是没有用。我做的最接近的结果是当我添加`colour=relevel(factor(Estado),'Providas'))`inside时`aes()`，但文本是粉红色和蓝色并添加了一个我不想要的新图例。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-04T20:22:16.693

如果您使用`colour=relevel(factor(Estado),'Providas'))`呼叫，它应该可以工作，但添加

`+ scale_color_manual(values =c('white', 'black'),guide="none")`

黑色是你想要的任何颜色。

# image - 以“生活”尺寸显示图像而不仅仅是全尺寸？

> ID：15209904
> 
> 赞同：2
> 
> 时间：2013-03-04T19:50:18.577
> 
> 标签：image, image-processing

我正在一个网站上工作，用户输入几个名字，并在模板上以漂亮的字体呈现，以便稍后打印和跟踪到其他东西（纸、木头、金属等）。

假设模板是 4" x 3" 实物大小。是否可以在所有设备上显示 4" x 3" 的图像？根据所述设备的分辨率，所有设备的全尺寸都不同。我的最终目标是使图像可以从屏幕上追踪而不是打印。如果需要更多细节，我一定会提供所需的。jquery 或 kineticjs...

再次感谢，托德

编辑：为了清楚起见，我想要显示一个 4x3 英寸的图像，所以如果用户测量他们的实际屏幕，图像将是 4x3 英寸。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T22:43:23.073

这是不可能的，但有一些解决方法。

* * *

流行的看法是正确的：CSS 绝对测量是没有用的，除非您的浏览器故意违反规范的建议。

在屏幕上，CSS 英寸是 96 像素。对于“Retina”和基于缩放的设备来说，事情稍微有点复杂，但你仍然不能相信英寸。CSS 媒体查询也无济于事。JS/DOM/等。规范在某些情况下会有所帮助，但据我所知，没有人能够构建任何能够处理大多数情况的东西，更不用说全部了。

* * *

有关绝对单位的详细信息，请参阅 CSS 3 文档和早期版本中的[Resolutions](http://www.w3.org/TR/css3-values/#resolution)、[Overriding Image Resolutions](http://www.w3.org/TR/css3-images/#image-resolution)和[Absolute lengths](http://www.w3.org/TR/css3-values/#absolute-lengths)。但这里有一个总结：

在原始 CSS 中，英寸应该是英寸，像素应该是像素，两者之间没有固定的映射。但是 CSS 2.1 增加了每英寸有 96 个像素的假设，而没有改变定义。这显然意味着像素或英寸都不是真实的（除非您有 96dpi 的屏幕，而大多数人没有）。

CSS 3 规定每个 CSS 设备必须选择是“锚定”到像素还是物理测量值。它特别建议像印刷媒体这样的高分辨率设备应该锚定到物理测量，而像计算机屏幕这样的低分辨率设备应该锚定到像素。因此“……物理单位可能与他们的物理测量不匹配。” （事实上​​，它们*不会*，除非在 96dpi 设备上。）

因此，对于一台 112dpi 的笔记本电脑，每个设备像素映射到一个 CSS 像素，这意味着每实际英寸可以获得 0.86 CSS 英寸。

220dpi 笔记本电脑怎么样，比如 15 英寸 Retina MacBook Pro？好吧，在 OS X 下，用户不直接使用 2880x1800 屏幕，而是选择五种虚拟分辨率之一，如 1440x900 或 1680x1050（在幕后，显卡实际上正在渲染到更高的分辨率，然后缩小到 2880x1800)。那么，那是如何映射的？嗯，浏览器可以将 2x2 的 220dpi 实际像素映射到 96dpi CSS 像素，这意味着你得到 0.87 CSS 英寸每英寸，或者它可以将 1x1 的 128dpi 虚拟像素映射到 96dpi CSS 像素，这意味着你得到每英寸 0.75 CSS 英寸。你会发现浏览器两者都做，但它们都逐渐适应 Safari 设定的标准.

像 iPhone 这样的 326dpi 移动设备呢？移动 WebKit 是围绕点击缩放构建的，因此事情变得*更加*复杂，因此您通常不会以指定的大小查看内容。但你能得到的最好结果是每个 CSS 像素 4x4 设备像素，这意味着每英寸 1.18 CSS 英寸。

CSS 3[媒体查询](http://www.w3.org/TR/css3-mediaqueries/#resolution)可让您区分，例如 1:1 和 2:1 情况（如 96dpi 和 192dpi），但它们不能让您确定实际映射。

那么，如果 CSS 没有实际工作，为什么还要拥有所有这些复杂的功能呢？好吧，一方面，它*确实*适用于打印输出。（在打印输出中，*像素*是错误的，所以英寸是正确的。）另一方面，它鼓励基于视角而不是固定尺寸来设计东西——你真的不*希望*在 5 英寸 iPhone 和 5 英寸 iPhone 上使用 5 英寸宽的东西” 在您的 56 英寸电视上放宽，但在极少数情况下除外。但主要是为了向后兼容。正如规范所说，“......太多现有内容依赖于 96dpi 的假设，而打破该假设会破坏内容。”

* * *

我不会详细说明如何使用 JS 来提供帮助，但基本思想是您可以访问诸如窗口为一的屏幕的物理尺寸之类的东西，并尝试计算您与 96dpi 的距离。有关示例，请参阅[此页面](http://iruler.net)的源代码。但这真的行不通。例如，我有一台内置 15" 2800x1800/1680x1050 屏幕和 21" 1920x1200 外屏的笔记本电脑。最近的 Firefox 将内部屏幕检测为 20.6" 的 1680x1050 和 20.6" 的 1920x1200 外部屏幕。Safari 在 23.6" 时将它们检测为 1920x1200。旧版本的 Firefox 在 20.6" 时将它们检测为 3600x1200 的一个屏幕（并且他们必须非常努力地从 OS X 中获取错误信息……）。

您可以采取其他变通方法来检测 WebKit 或较旧的 Firefox 等，并弥补已知的错误，这可能会将您的成功率从 1/6 提高到 1/2。

Flash 或 Java 可能会做得更好……但我认为将它们中的任何一个嵌入到页面上只是为了测量屏幕大小是不值得的。

* * *

那么，你能做些什么呢？

第一种可能性是使用 PDF 而不是 HTML。您可能必须设置处置以鼓励它在阅读器/预览/等中打开。而不是在浏览器中内联。这仍然可能不起作用，因为某些用户可能有阅读器/预览/等。默认缩放。即使它总是有效，也有很多情况下这不是一个可接受的答案。

我见过的最好的纯网络解决方案是这样的：

*   给用户一个框来输入他们的实际 DPI。
*   包括一个“帮助”链接，该链接会弹出有关如何查找/测量 DPI 的信息。
*   还提供“校准”界面，您可以在其中显示尺子的图片并让他们缩小/扩大它，直到它与他们在屏幕上举起的尺子相匹配。
*   对于某些设备（主要是 iOS/Android，还有带有内置屏幕的 Mac 笔记本电脑），您可以使用一些技巧来猜测实际的 PPI。
*   对于其他设备，上面描述的 JS 技巧也值得尝试。
*   否则，回退到 96 或报告的 PPI 值。

* * *

未来呢？

This problem is not exactly secret. [Pixels Per Inch Awareness and CSS Px](http://static.zealous-studios.co.uk/projects/web_tests/PPI%20tests.html) discusses it (from the POV of trying to get an exact number of pixels, rather than an exact number of inches, but the issues are obviously complementary). Meanwhile, [Introduction to CSS Media Queries](http://www.javascriptkit.com/dhtmltutors/cssmediaqueries.shtml) is a more practical "how to" article on how to use what's actually available, without getting into why it's not what you actually want. These and many other articles point out what a pain the current design is.

这经常出现在[www 风格的](http://lists.w3.org/Archives/Public/www-style/)列表中，并且争论总是这样：大多数时候，当人们认为他们想要物理英寸时，他们错了。想想一个在不同视觉距离下使用的浏览器，比如电视或 iPhone。所以，即使我们没有向后兼容的问题，我们仍然想要一些接近我们所拥有的东西。物理英寸唯一有用的是“真人大小”图表。

但是当你*确实*想要一个“真人大小”的图表时呢？嗯……每次讨论似乎都以有人说“如果你真的需要它，建议添加一个 'physin' 单位而不是改变 'in' 单位”，然后是，“我真的需要那个，所以我建议添加一个”物理单位”，然后事情逐渐消失。也许最终它会发生，但到目前为止，还没有。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T20:11:45.107

我以前遇到过这个问题，恐怕这是不可能的 - 计算机本身通常不会知道屏幕的像素密度（它会知道屏幕有多少像素，但不一定知道显示器有多大面积是）。

有一些解决方法，但你经常需要改变你的目标：当我过去使用地图而不是显示比例（1:2500 或其他）时，我显示了一个条形图，它是已知的像素数（我知道真实世界的长度）。

在您的情况下，您可以让用户测量屏幕上已知数量的像素，输入真实世界的大小，并在生成图像时将其用作比例因子。

不理想，但我认为这是你能得到的最好的。

编辑：另一种方法（这可能比让用户测量和输入尺寸更好）是允许他们将图像的大小调整为他们可能躺在周围的已知真实世界对象的大小（例如，信用卡）。一旦他们调整了图像的大小，您就会知道像素密度并知道要渲染图像的大小。这让我想起了 80 年代校准操纵杆……

# symfony - 自适应 Symfony2 形式选择

> ID：15209910
> 
> 赞同：2
> 
> 时间：2013-03-04T19:50:30.627
> 
> 标签：symfony, symfony-forms

我刚刚创建了一个表单类类型，它有一个选择类型，其中`choice_list`必须根据登录的用户角色进行更改，因此表单类类型需要访问当前用户角色，然后`choice_list`根据它进行更改。

有人可以指出一种通过 Symfony2 表单模式完成它的巧妙方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T20:09:49.940

您需要将表单类型注册为服务并通过构造函数获取安全上下文。如果你已经`JMSDiExtraBundle`安装了，你可以这样做：

```
<?php
namespace ...;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Security\Core\SecurityContextInterface;
use JMS\DiExtraBundle\Annotation\FormType;
use JMS\DiExtraBundle\Annotation\InjectParams;
use JMS\DiExtraBundle\Annotation\Inject;

/**
 * @FormType
 */
class YourType extends AbstractType
{
    /**
     * @InjectParams({
     *     "securityContext" = @Inject("security.context")
     * })
     *
     * @var SecurityContextInterface
     */
    public function __construct(SecurityContextInterface $securityContext)
    {
        $this->securityContext = $securityContext;
    }

    /**
     * @return string
     */
    public function getName()
    {
        return 'your_type';
    }
} 
```

通过这种方式，您可以从安全上下文中获得所需的一切。

由于表单已注册为服务，因此在创建表单时使用其名称而不是其类：

```
$form = $this->createForm('your_type', /* ... */); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-04T18:42:08.520

这是另一种方法：

```
 /** @DI\FormType */ 

class ModelType extends AbstractType { 

/** @DI\Inject("security.context") */ 

public $security; 
```

# json - 在haskell中用aeson解析部分json对象

> ID：15209915
> 
> 赞同：7
> 
> 时间：2013-03-04T19:50:48.557
> 
> 标签：json, haskell, aeson

我在 Haskell 中使用 Warp（可能还有 Scotty）和酸状态制作了一个相当简单的 CRUD Web 服务。

在酸性状态下，我将用户记录存储在 Data.Map 中（根据[此](http://mirror.seize.it/acid-state/examples/KeyValue.hs)示例）。我知道这些记录在创建时总是完整的，所以我不需要用很多 MaybeS 来获得资格。但是，在更新用户时，客户端可能会选择发送部分 json 对象，其中仅填充一些字段。

表示这一点的惯用方式是什么？我是否应该在所有可选键PartialUser前面有一个数据声明FullUser，没有MaybeS，而一个与MaybeS完全相同，并让aeson自动为后者派生编码和解码，最后编写我自己的类型更新函数:: FullUser -> PartialUser -> FullUser？

它不会有太多代码，但感觉有点难看，并且有点违反 DRY。它应该是 Web 服务器中的一项常见任务，所以也许它已经普遍解决了（可能使用 TH）？

我意识到我可以只存储 json 字符串并始终检查丢失的键，这使它稍微笨拙但更多的未来证明模式更改，但我仍然想知道如何以“类型安全”的方式进行操作。

编辑：或者也许我应该只有 FullUser 并使用 aeson-lens 从 FullUser 和 json 字符串编写一个简单的更新函数？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-04T21:21:02.723

惯用的 Haskell 尽可能多地进行静态检查。您应该始终从是否可以用静态检查替换动态检查的角度来处理您的问题。这基本上就是使以下关于 Haskell 的陈述非常接近现实的原因：“如果它编译，它就可以工作”。所以绝对是使用纯 JSON 的“不”。

您的解决方案`FullUser`是`PartialUser`正确的。尽管我建议采用不同的命名方法：`User`并且`UserJSON`- 这样您就可以获得非常具有描述性和合理性的含义。

然而，Aeson 有一个小问题：生成的实例[还不支持解析缺失的字段](https://github.com/bos/aeson/issues/108)（请就这个问题投票）。因此，您必须手动定义实例。

# magento - Magento CMS 主页未显示

> ID：15209921
> 
> 赞同：1
> 
> 时间：2013-03-04T19:51:22.050
> 
> 标签：magento, magento-1.5

我的一些 Magento 商店有一个奇怪的问题。主页上的内容已消失。有问题的网站是：-

[http://www.hornchurchfineart.co.uk/](http://www.hornchurchfineart.co.uk/)

[http://www.artofwood.co.uk/](http://www.artofwood.co.uk/)

[http://www.domingodirect.co.uk/](http://www.domingodirect.co.uk/)

这些页面之前工作正常，突然停止工作，这个问题也困扰了我的托管公司。

我已经在管理员中清除了我的缓存，并通过手动删除 /var/cache 文件夹中的文件，但无济于事。

有没有人遇到过这个问题？

提前谢谢了，

加里

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-06-01T07:27:09.177

我终于找到了问题所在。在我的 .htaccess 文件中，我有以下条目。

SetEnv MAGE_IS_DEVELOPER_MODE 1

通过评论这一点返回的头版。

我希望这对将来的某人有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-07-23T05:51:34.273

确保没有具有空白 URL 重写的产品。

您可以通过转到**Catalog > URL Rewrite Management**并对列**Request Path**进行排序来检查这一点。如果其中有一个带有空白请求路径的项目（它应该在排序后位于顶部），它将覆盖主页。删除重写以恢复您的主页。

如果您使用导入脚本（例如 MagMi）创建产品，则可能会发生这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T01:14:49.200

在我的网站上，主页的内容存储在数据库中。也许某些事情导致您的条目被空白？

打开 Admin -> CMS -> Page 作为您的主页，然后在左侧的 Design 选项卡下，有一个名为“Layout Update XML”的部分。这就是我的“主页”页面正文的来源。在本节中是来自我们购买的模板的 XML，将它们的“块”插入到我们的主页上。

我们的模板是来自 Template Master 的付费模板，这是我们的“布局更新 XML”的一部分，它构成了我商店主页的一部分：

```
<reference name="content">
  <block type="easyslide/slider" name="homepage.slideridentificator">
        <action method="setSliderId"><id>default_a034</id></action>
  </block>
  <block type="core/template" name="tab_wrapper" template="cms/highlight.tab.phtml"/>
</reference> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-31T20:14:18.820

我遇到了类似的错误：前端无法访问 CMS 主页。就我而言，这是因为我在后端将主页从“主页”重命名为“主页”：CMS> Pages> URL Key。

# assembly - 理解汇编中的c函数

> ID：15209922
> 
> 赞同：0
> 
> 时间：2013-03-04T19:51:24.830
> 
> 标签：assembly, intel

我正在尝试学习如何理解汇编程序中的 c 函数。我使用“gcc code.c -m32 -o code -S -fno-stack-protector”编译了以下 c 程序

```
#include <stdio.h>

void function( int a, int b, int c )
{
   char buffer1[5];
   char buffer2[10];
}

void main()
{
   function( 1, 2, 3 );
} 
```

汇编输出如下：

```
 .section    __TEXT,__text,regular,pure_instructions
    .globl  _function
    .align  4, 0x90
_function:
    pushl   %ebp
    movl    %esp, %ebp
    subl    $28, %esp
    movl    16(%ebp), %eax
    movl    12(%ebp), %ecx
    movl    8(%ebp), %edx
    movl    %edx, -4(%ebp)
    movl    %ecx, -8(%ebp)
    movl    %eax, -12(%ebp)
    addl    $28, %esp
    popl    %ebp
    ret

    .globl  _main
    .align  4, 0x90
_main:
    pushl   %ebp
    movl    %esp, %ebp
    subl    $24, %esp
    movl    $1, (%esp)
    movl    $2, 4(%esp)
    movl    $3, 8(%esp)
    call    _function
    addl    $24, %esp
    popl    %ebp
    ret

.subsections_via_symbols 
```

esp 和 ebp 寄存器不能相等，因为定义 int a,b,c 的偏移量在 _main 和 _function 中不同。哪一行从 ebp 中减去 4？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T20:04:00.767

调用函数通常是这样的：

1) 在函数外部，参数被压入堆栈

```
subl    $24, %esp
movl    $1, (%esp)
movl    $2, 4(%esp)
movl    $3, 8(%esp) 
```

2) 在函数内部，在堆栈上分配空间来保存参数和局部变量。

低于 $28, %esp

在这种情况下，您有 3 个整数和 15 个字符，总共 27 个字节；这与 4 字节边界对齐。

3) 然后将参数复制到本地堆栈空间中。

```
movl    16(%ebp), %eax
movl    12(%ebp), %ecx
movl    8(%ebp), %edx
movl    %edx, -4(%ebp)
movl    %ecx, -8(%ebp)
movl    %eax, -12(%ebp) 
```

这里，16(%ebp) 和朋友是推到外面的参数的地址，-4(%ebp) 是新分配的堆栈空间中的地址，这些值被复制到其中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T19:55:22.023

无需在任何地方减去 4，因为它是返回地址（给定 32 位架构）将消耗堆栈上的前 4 个字节。

因此，当引用堆栈上的元素时，差价为 4 美元。在指令*之前*没有推送返回地址`call`因此偏移量 $0 $4 和 $8 在 main 中很好：

```
movl    $1, (%esp)
movl    $2, 4(%esp)
movl    $3, 8(%esp) 
```

执行：

```
call    _function 
```

in main 会将 eip 的内容（返回地址）推入堆栈，从而将 esp 增加 4。

在函数中，作为返回地址（消耗 4 个字节）将位于堆栈顶部，正确的偏移量是 -$4、-$8 和 -$12，这正是您的函数中使用的值：

```
movl    %edx, -4(%ebp)
movl    %ecx, -8(%ebp)
movl    %eax, -12(%ebp) 
```

# actionscript-3 - 在影片剪辑中访问影片剪辑 - actionscript 3

> ID：15209924
> 
> 赞同：0
> 
> 时间：2013-03-04T19:51:29.310
> 
> 标签：actionscript-3

我正在使用 ActionScript 3 开发游戏，但遇到了问题。

我在一个电影剪辑中的游戏中有一个 UI。在 UI-Movie Clip 内还有其他几个 Movie Clip，例如 HP 条。

我将 UI-Movie Clip 添加到游戏中，如下所示：

> var ui:ui_mc = 新的 ui_mc();
> 
> addChild(ui_mc);

现在我想在更新功能中访问和更改 HP bar-Movie Clip 上的帧等，但我不知道该怎么做。

有任何想法吗？或者这只是一个不好的方法？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:55:29.070

抱歉，解决了。。

对于不知道的人：您必须在父影片剪辑实例名称中提供影片剪辑。

# c - Eratosthenes 的多线程筛 - 花费了很长时间

> ID：15209927
> 
> 赞同：0
> 
> 时间：2013-03-04T19:51:38.113
> 
> 标签：c, multithreading, performance, pthreads, sieve-of-eratosthenes

我正在尝试创建一个多线程的埃拉托色尼筛

线程数默认设置为 4，但用户可以将它们指定为命令行参数。

我试图用几个不同的线程同时标记数组中素数的所有间隔。因此，包含 0 或 1 的数组被拆分为 arrayElements/threadNumber。

每个线程都有一个指定的数组的起始位置和结束位置，以便它检查其中的素数间隔。

因此，例如让我们假设您想要达到的数字是 20，并且您有 4 个线程。线程 0 将从 0 开始并上升到 20/4-1。下一个将从 20/4*threadNumber 开始，一直到 (20/4*nextThreadNumber)-1，依此类推。

然后我必须检查找到的素数是否在其中一个线程的数组区域内。这是因为如果是，则该素数不能被标记为非素数。我遇到了一个问题，因为素数在超出第一个线程的范围后会被标记为非素数，因为素数会自行相除。

正如您在下面看到的，我发现startingPosition 是否可以被素数整除。如果是，我将其设置为该线程的“非素数搜索”起点，并从那里增加素数，将范围内的每个实例标记为非素数。如果不是，那么我计算下一个非素数是什么（基于素数）并将其作为开始。

在这一切结束时，这是您通常的“以素数为间隔循环遍历数组，将每个实例标记为非素数”。

长话短说，我必须让这个数字达到 32 位整数（大约 20 亿）的范围。它适用于较小的数字，但在对 140 万个数字进行一些基准测试后，它需要 13.4 秒。540 万只需要 37.3 秒。1000 万只需要 68 秒。对于 20 亿，它只是继续工作（我让它运行了 10 分钟或更长时间），看不到尽头。

那么，我该如何改进我的代码呢？是什么导致它需要这么长时间？它似乎并不比单线程实现快（我将线程参数设置为 1 表示单线程，1000 万个数字需要 56 秒）

所以，这里是代码，与

定义 maxNum 10483646

线程函数：

```
 int numThreads; //number of threads
    int innerCounter;
    int composite[maxNum];

//need to find all prime numbers up to unsigned 32 bit integer
//creating n threads, (start to 1/n -1) 0,  (1/n to 2/n -1) , (2/n to 3/n -1) until it's (n-1/n to n/n) are starting positions for looking for primes so threads aren't accessing same area
void* markPrimes(int i){
    //Prime number should be innerCounter
    //printf("Threaded process: %d\n", i);
    //starting position in array: (maxNum/threadNum) * i
    //ending position in array: ((maxNum/threadNum)) * (i+1) - 1
    int startingPosition;
    int compositeCounter;
    int firstNonPrime;
    int endingPosition;
    int primeInRange;

        startingPosition = (double)(maxNum/numThreads) * i;
        endingPosition = (double)(maxNum/numThreads) * (i+1)-1;
        if(i == numThreads-1){
            endingPosition = maxNum;
        }

        if(startingPosition <= innerCounter && innerCounter <= endingPosition){ //the prime number is in range, and should be ignored
            primeInRange = 1;
        }

        firstNonPrime = startingPosition%innerCounter;
        if(firstNonPrime != 0){
            int temp = innerCounter - firstNonPrime;
            firstNonPrime = temp + startingPosition;
        }else{
            firstNonPrime = startingPosition;
        }
        if(primeInRange == 1){
            firstNonPrime = innerCounter + innerCounter;
        }

    if(firstNonPrime <= endingPosition){

        for(compositeCounter = firstNonPrime; compositeCounter <= endingPosition; compositeCounter += innerCounter){

                        composite[compositeCounter] = 1;

                    }
    }
    return (void*)0;
} 
```

现在主函数拥有算法的其余部分并创建线程：

```
int main(int argc, char** argv[]){

    clock_t start; //start time
    clock_t stop; //end time
    double total_time;
    int rc;
    int nextNum;
    int prevNum = 0;
    int i;
    int numPrimes;
    //unsigned int maxNum = INT_MAX; //maximum unsigned integer value to go up until
    //bit array for threads to check primes for
    for(i = 0; i < maxNum+1; i++){
        composite[i] = 0;
    }
    if(argc > 1){
        numThreads = atoi(argv[1]); //argument given for n number of threads
    }else{
        numThreads = 4; //default if no argument given is 4 threads
    }
    pthread_t threads[numThreads]; //array of threads
    start = clock(); //start timing

    //Sieve algorithm here! When prime found, spawn threads!
    int outerCounter = 1;
    while(outerCounter < sqrt(maxNum)){
        //searching numbers above the current for prime numbers

        for(innerCounter = outerCounter+1; innerCounter <= maxNum; innerCounter++){
            //not composite

            if(composite[innerCounter] == 0){
                //setting all multiples of innerCounter to 1, creating threads to split up the work!

                for(i = 0; i < numThreads; i++){

                    rc = pthread_create(&threads[i], NULL, markPrimes, (void*) i);

                    //Detecting Error
                    if(rc){
                        //perror("Thread creation error!");
                        //exit(-1);
                    }
                }
                for(i = 1; i < numThreads; i++){
                    pthread_join(threads[i], NULL);
                }
                outerCounter = innerCounter;
                numPrimes++;

            }
        }
    }

    stop = clock(); //stop timing
    total_time = (double)(stop - start) / CLOCKS_PER_SEC;

    printf("Time for threads: %.5f\n", total_time);
    printf("Number of primes: %d\n", numPrimes-1);

    return 0;
} 
```

我提前感谢大家的耐心和帮助！

编辑：我必须使用 pthreads

编辑 2：我以[How to sleep or pause a PThread in c on Linux](https://stackoverflow.com/questions/1606400/how-to-sleep-or-pause-a-pthread-in-c-on-linux)作为示例来尝试指导一些条件锁定和解锁。因为我确实想暂停和取消暂停素数的标记。我将 while 语句（使用 lock 和 unlock 语句）作为一个组放在我的线程函数中，在其中发现了 start/stop 部分。当在具有锁定/解锁语句的算法的内部 if 语句中找到素数时，我将 int 的标记设置为 1，并在具有锁定/解锁语句的 if 语句之外将该变量设置为 0。

那是我应该做的吗？

# ajax - Ajax发布方法发布数据但刷新页面时收到警报消息

> ID：15209928
> 
> 赞同：0
> 
> 时间：2013-03-04T19:51:47.260
> 
> 标签：ajax, jquery

我使用下面的ajax发布

```
$('#myFormId').on('submit', function() {

    var form_data = {
        csrfsecurity: $("input[name=csrfsecurity]").val(),
        post_text: $('#post_text').val()    
    };

    $.ajax({
        url: "<?php echo site_url('/post_status'); ?>",
        type: 'POST',
        data: form_data,
        success: function(response){
            $(".home_user_feeds").html("markUpCreatedUsingResponseFromServer");
        }
    });
    return false;
}); 
```

当我发布某些内容并刷新页面时，浏览器会显示以下警报。

```
Confirm Form Resubmission

The page that you're looking for used information that you entred. Returning to that page might cause any action you took to be repeated. 
```

如何摆脱它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:56:30.253

首先尝试阻止默认表单事件：

```
$('#myFormId').on('submit', function(e) {

    e.preventDefault();

    var form_data = {
        csrfsecurity: $("input[name=csrfsecurity]").val(),
        post_text: $('#post_text').val()    
    };

    $.ajax({
        url: "<?php echo site_url('/post_status'); ?>",
        type: 'POST',
        data: form_data,
        success: function(response){
            $(".home_user_feeds").html("markUpCreatedUsingResponseFromServer");
        }
    });
    return false;
}); 
```

# batch-file - 使用 if 语句移动和备份文件

> ID：15209930
> 
> 赞同：-3
> 
> 时间：2013-03-04T19:51:50.687
> 
> 标签：batch-file

```
for %%d in (text.txt, test1.txt)
    if c:\desktop\deploy_pkg\bin\%%d exist (
        del C:\jboss-5.1.0.GA\bin\text.txt.bak
        del C:\jboss-5.1.0.GA\bin\text1.txt.bak
        ren C:\jboss-5.1.0.GA\bin\text.txt text.txt.bak
        ren C:\jboss-5.1.0.GA\bin\text.txt text1.txt.bak
        copy "C:\Documents and Settings\deployment\Desktop\deploy_pkg\bin\text.txt" "C:\jboss-5.1.0.GA\bin"
        copy "C:\Documents and Settings\deployment\Desktop\deploy_pkg\bin\text1.txt" "C:\jboss-5.1.0.GA\bin"
     )
 )
pause 
```

这不起作用...有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T21:34:09.473

# 回答

如原始问题的评论中所述，您的脚本存在两个语法错误。

1.  括号数不匹配。每次关闭都需要打开，反之亦然。
2.  命令的顺序`if`不正确。 `exists`必须在路径之前。

现在这些只会修复脚本崩溃问题，不会修复脚本逻辑中可能存在的任何错误。在不知道脚本要执行的逻辑的情况下，无法检查它。

见`if /?`寻求帮助。

此外，Nate Hekman 为在 Stack Overflow 上写问题提供了一些很好的建议。

## 批处理新手

这里有一些从批处理脚本开始的很好的资源。

[`SS64`](http://ss64.com/), [`Rob VanderWoulde`](http://www.robvanderwoude.com/batchstart.php),[`DosTips`](http://www.dostips.com/)和[`Technet`](http://technet.microsoft.com/en-us/library/cc772390%28v=ws.10%29.aspx)

## 语法修复

```
for %%D in (text.txt, test1.txt) (
    if exist "c:\desktop\deploy_pkg\bin\%%~nxD" (
        del "C:\jboss-5.1.0.GA\bin\text.txt.bak"
        del "C:\jboss-5.1.0.GA\bin\text1.txt.bak"
        ren "C:\jboss-5.1.0.GA\bin\text.txt" "text.txt.bak"
        ren "C:\jboss-5.1.0.GA\bin\text.txt" "text1.txt.bak"
        copy "C:\Documents and Settings\deployment\Desktop\deploy_pkg\bin\text.txt" "C:\jboss-5.1.0.GA\bin"
        copy "C:\Documents and Settings\deployment\Desktop\deploy_pkg\bin\text1.txt" "C:\jboss-5.1.0.GA\bin"
    )
)
pause 
```

# c# - 如果第一个为空，则切换到不同的 IObservable

> ID：15209932
> 
> 赞同：6
> 
> 时间：2013-03-04T19:52:06.967
> 
> 标签：c#, .net, system.reactive

我正在编写一个函数来检索有关某个主题的新闻并通过 IObservable 返回值反馈此新闻。

但是，我有几个新闻来源。我不想`Merge`用来将这些来源合并为一个。相反，我想做的是按优先级排序——

1.  当我的函数被调用时，第一个新闻源被查询（它产生一个代表那个源的 IObservable）。
2.  如果该新闻源的 IObservable 完成但没有返回任何结果，则查询下一个新闻源。
3.  如果第二个来源完成但没有返回结果，则查询最终新闻来源。
4.  这整个行为被包装成一个我可以返回给用户的 observable。

这种行为是我可以使用内置的 Rx 扩展方法完成的，还是我需要实现一个自定义类来处理这个？我将如何做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2018-08-10T23:47:23.540

在我看来，接受的答案是不可取的，因为它使用`Subject`, `Do`, 并且当第一个序列不为空时仍然订阅第二个序列。如果第二个 observable 调用任何不平凡的东西，后者可能是一个大问题。我想出了以下解决方案：

```
public static IObservable<T> SwitchIfEmpty<T>(this IObservable<T> @this, IObservable<T> switchTo)
{
    if (@this == null) throw new ArgumentNullException(nameof(@this));
    if (switchTo == null) throw new ArgumentNullException(nameof(switchTo));
    return Observable.Create<T>(obs =>
    {
        var source = @this.Replay(1);
        var switched = source.Any().SelectMany(any => any ? Observable.Empty<T>() : switchTo);
        return new CompositeDisposable(source.Concat(switched).Subscribe(obs), source.Connect());
    });
} 
```

该名称`SwitchIfEmpty`符合[现有的 RxJava 实现](http://reactivex.io/RxJava/2.x/javadoc/io/reactivex/Observable.html#switchIfEmpty-io.reactivex.ObservableSource-)。[这](https://github.com/dotnet/reactive/issues/489)是关于将一​​些 RxJava 运算符合并到 RxNET 中的持续讨论。

我确信自定义`IObservable`实现会比我的更有效。你可以在[这里](https://github.com/akarnokd/reactive-extensions/blob/2407d03b5b18b6cf83372cecd66ebf5f6d6f6558/reactive-extensions/observable/SwitchIfEmpty.cs)找到由 ReactiveX 成员[akarnokd](https://github.com/akarnokd)编写的。它也可以在[NuGet](https://www.nuget.org/packages/akarnokd.reactive_extensions)上使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T20:03:19.597

## 从原始海报编辑：

我接受了这个答案，但把它变成了一种扩展方法——

```
/// <summary> Returns the elements of the first sequence, or the values in the second sequence if the first sequence is empty. </summary>
/// <param name="first"> The first sequence. </param>
/// <param name="second"> The second sequence. </param>
/// <typeparam name="T"> The type of elements in the sequence. </typeparam>
/// <returns> The <see cref="IObservable{T}"/> sequence. </returns>
public static IObservable<T> DefaultIfEmpty<T>(this IObservable<T> first, IObservable<T> second)
{
    var signal = new AsyncSubject<Unit>();
    var source1 = first.Do(item => { signal.OnNext(Unit.Default); signal.OnCompleted(); });
    var source2 = second.TakeUntil(signal);

    return source1.Concat(source2); // if source2 is cold, it won't invoke it until source1 is completed
} 
```

## 原答案：

这可能会奏效。

```
var signal1 = new AsyncSubject<Unit>();
var signal2 = new AsyncSubject<Unit>();
var source1 = a.Do(item => { signal1.onNext(Unit.Default); signal1.onCompleted(); });
var source2 = b.Do(item => { signal2.onNext(Unit.Default); signal2.onCompleted(); })).TakeUntil(signal1);
var source3 = c.TakeUntil(signal2.Merge(signal1));

return Observable.Concat(source1, source2, source3); 
```

编辑：哎呀，第二个源需要一个单独的信号，第三个不需要发出任何信号。Edit2：哎呀......类型。我习惯了 RxJs :)

PS 还有更少的 RX-y 方法可以做到这一点，可能会少一点打字：

```
var gotResult = false;
var source1 = a();
var source2 = Observable.Defer(() => return gotResult ? Observable.Empty<T>() : b());
var source3 = Observable.Defer(() => return gotResult ? Observable.Empty<T>() : c());
return Observable.Concat(source1, source2, source3).Do(_ => gotResult = true;); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T20:21:12.497

~~听起来您可以只使用一个普通的`Amb`查询。~~

编辑：根据评论，`Amb`不会这样做 - 试一试：

```
public static IObservable<T> SwitchIfEmpty<T>(
     this IObservable<T> first, 
     Func<IObservable<T>> second)
{
    return first.IsEmpty().FirstOrDefault() ? second() : first;
} 
```

试验台：

```
static Random r = new Random();
public IObservable<string> GetSource(string sourceName)
{
    Console.WriteLine("Source {0} invoked", sourceName);
    return r.Next(0, 10) < 5 
        ? Observable.Empty<string>() 
        : Observable.Return("Article from " + sourceName);
}

void Main()
{
    var query = GetSource("A")
        .SwitchIfEmpty(() => GetSource("B"))
        .SwitchIfEmpty(() => GetSource("C"));

    using(query.Subscribe(Console.WriteLine))
    {
        Console.ReadLine();
    }           
} 
```

一些示例运行：

```
Source A invoked
Article from A

Source A invoked
Source B invoked
Article from B

Source A invoked
Source B invoked
Source C invoked
Article from C 
```

编辑编辑：

我想您也可以将其概括为：

```
public static IObservable<T> SwitchIf<T>(
    this IObservable<T> first, 
    Func<IObservable<T>, IObservable<bool>> predicate, 
    Func<IObservable<T>> second)
{
    return predicate(first).FirstOrDefault() 
        ? second() 
        : first;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-04T23:07:35.833

另一种方法 - 与其他方法的差异相当大，所以我会提出一个新的答案：

这里有各种有趣的调试行：

```
public static IObservable<T> FirstWithValues<T>(this IEnumerable<IObservable<T>> sources)
{
    return Observable.Create<T>(obs =>
    {
        // these are neat - if you set it's .Disposable field, and it already
        // had one in there, it'll auto-dispose it
        SerialDisposable disp = new SerialDisposable();
        // this will trigger our exit condition
        bool hadValues = false;
        // start on the first source (assumed to be in order of importance)
        var sourceWalker = sources.GetEnumerator();
        sourceWalker.MoveNext();

        IObserver<T> checker = null;
        checker = Observer.Create<T>(v => 
            {
                // Hey, we got a value - pass to the "real" observer and note we 
                // got values on the current source
                Console.WriteLine("Got value on source:" + v.ToString());
                hadValues = true;
                obs.OnNext(v);
            },
            ex => {
                // pass any errors immediately back to the real observer
                Console.WriteLine("Error on source, passing to observer");
                obs.OnError(ex);
            },
            () => {
                // A source completed; if it generated any values, we're done;                    
                if(hadValues)
                {
                    Console.WriteLine("Source completed, had values, so ending");
                    obs.OnCompleted();
                }
                // Otherwise, we need to check the next source in line...
                else
                {
                    Console.WriteLine("Source completed, no values, so moving to next source");
                    sourceWalker.MoveNext();
                    disp.Disposable = sourceWalker.Current.Subscribe(checker);
                }
            });
        // kick it off by subscribing our..."walker?" to the first source
        disp.Disposable = sourceWalker.Current.Subscribe(checker);
        return disp.Disposable;
    });
} 
```

用法：

```
var query = new[]
{
    Observable.Defer(() => GetSource("A")), 
    Observable.Defer(() => GetSource("B")), 
    Observable.Defer(() => GetSource("C")), 
}.FirstWithValues(); 
```

输出：

```
Source A invoked
Got value on source:Article from A
Article from A
Source completed, had values, so ending

Source A invoked
Source completed, no values, so moving to next source
Source B invoked
Got value on source:Article from B
Article from B
Source completed, had values, so ending

Source A invoked
Source completed, no values, so moving to next source
Source B invoked
Source completed, no values, so moving to next source
Source C invoked
Got value on source:Article from C
Article from C
Source completed, had values, so ending 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-05T09:43:01.357

这是 JerKimball 运算符的非阻塞版本[`SwitchIfEmpty`](https://stackoverflow.com/a/15210388/11178549)。

```
/// <summary>Returns the elements of the first sequence, or the elements of the
/// second sequence if the first sequence is empty.</summary>
public static IObservable<T> SwitchIfEmpty<T>(this IObservable<T> first,
    IObservable<T> second)
{
    return Observable.Defer(() =>
    {
        bool isEmpty = true;
        return first
            .Do(_ => isEmpty = false)
            .Concat(Observable.If(() => isEmpty, second));
    });
} 
```

这是同一运算符的一个版本，它接受多个序列，并返回第一个非空序列的元素：

```
/// <summary>Returns the elements of the first non-empty sequence.</summary>
public static IObservable<T> SwitchIfEmpty<T>(params IObservable<T>[] sequences)
{
    return Observable.Defer(() =>
    {
        bool isEmpty = true;
        return sequences
            .Select(s => s.Do(_ => isEmpty = false))
            .Select(s => Observable.If(() => isEmpty, s))
            .Concat();
    });
} 
```

该`Observable.Defer`运算符用于防止多个订阅共享相同的`bool isEmpty`状态（有关此的更多信息[here](https://stackoverflow.com/questions/64843343/how-to-bind-a-non-disposable-object-with-each-subscription-of-a-cold-observable "如何将非一次性对象与冷可观察对象的每个订阅绑定？")）。

# python - nltk .lhs() 比较字符串的问题

> ID：15209936
> 
> 赞同：0
> 
> 时间：2013-03-04T19:52:17.560
> 
> 标签：python, nltk

分配`string = i.lhs()`其值时，稍后与 is比较时`print (var == 'P')`返回 false 。`var``'P'`

```
 for i in grammar.productions():
    var = i.lhs()
    P = "P"
    if (not i.is_nonlexical()):
        print var
        print (var == P) 
```

它在任何事情上都返回 false。我不明白为什么它在所有内容上都返回 false。任何提示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T08:19:22.097

您不能将 lhs() 对象与字符串进行比较，但您可以使用 获取对象的字符串表示形式`.lhs().__str__()`，并将其与另一个字符串进行比较，如下所示：

```
for i in grammar.productions() :
   var = i.lhs()
   P = "P"
   if (not i.is_nonlexical()) :
       print var
       print (var.__str__() == P) 
```

此外，您可以使用`is_lexical()`而不是询问它是否**不是非词汇的**

# xslt - 命名空间的排序

> ID：15209942
> 
> 赞同：2
> 
> 时间：2013-03-04T19:52:36.570
> 
> 标签：xslt, xpath-2.0

我创建了一个 XSLT 样式表文档。在此文档中，我创建了一个新的 XML 文档，如下所述：

```
...
<CREATE_REQ
            xsi:schemaLocation="http://fcubs.ofss.com/service/aServices theService.xsd"
            xmlns="http://fcubs.ofss.com/service/aServices"
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
... 
```

转换后（见下文），命名空间的顺序不同。一个普通的 XML 解析器可以处理这个问题，这通常是没有问题的。我的问题是接收应用程序无法处理这个问题，并且命名空间的顺序可能也不应该改变。

```
<CREATE_REQ xmlns="http://fcubs.ofss.com/service/aServices"
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xsi:schemaLocation="http://fcubs.ofss.com/service/aServices theService.xsd">

... 
```

是否有不会更改命名空间的函数或声明？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T08:24:45.500

如果接收应用程序无法处理它，则需要对其进行修复。编写它的人似乎没有掌握 XML 的全部内容。修复接收应用程序，或将其扔到它所属的 bin 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T03:53:45.437

> 转换后（见下文），命名空间的顺序不同。

**不，顺序完全相同**。根据 W3C **[XPath 1.0 数据模型](http://www.w3.org/TR/xpath/#data-model)**：

*元素的属性节点和命名空间节点出现在元素的子元素之前。**命名空间节点被定义为出现在属性节点之前**。*

这意味着虽然在提供的 XML 片段中，属性`xmlns:xsi` *似乎*在命名空间声明之前，但实际上它在它们之后。

因此，生成的输出不会更改原始 XML 文档的名称空间和属性的顺序。

**生成属性位于名称空间节点之前的 XML 文档将违反上面引用的定义，因此兼容的 XSLT 处理器不会生成这样的文档**。

# java - 在 Java 中需要属性方面的帮助

> ID：15209944
> 
> 赞同：-1
> 
> 时间：2013-03-04T19:52:41.013
> 
> 标签：java, string, oop, methods, void

我想要做的是访问一个对象，在这种情况下 date1 具有 3 个属性日、月和年。我正在尝试创建一个名为 showTomorrow() 的方法，它将以字符串格式显示对象信息 1 天。这意味着我无法更改原始对象的属性。

我已经编写了 Data.java 程序，它如下所示，如果有人能指出我正确的方向或向我展示它会有什么帮助的话。

我相信这就是我在主要方法上运行的内容。

```
**Date date1 = new Date(30, 12, 2013)** // instantiate a new object with those paramaters

**date1.showDate();** // display the original date

**date1.tomorrow();** // shows what that date would be 1 day infront 
```

问题是现在它没有显示任何内容。我想通过说 dayTomorrow = this.day++; 我将它的默认值 + 1 天添加到变量 dayTomorrow。

```
public class Date
{
    private int day;
    private int month;
    private int year;
    private int dayTomorrow;
    private int monthTomorrow;
    private int yearTomorrow;

    public Date()
    {
            day = 1;
            month = 1;
            year = 1970;
    }
    public Date(int inDay, int inMonth, int inYear)
    {
            day = inDay;
            month = inMonth;
            year = inYear;
    }
    public void setDate(int inDay, int inMonth, int inYear)
    {
            day = inDay;
            month = inMonth;
            year = inYear;
    }
    public String getDate()
    {
            String strDate;
            strDate = day + "/" + month + "/" + year;
            return strDate;
    }
    public String getTomorrow()
    {
            String strTomorrow;
            strTomorrow = dayTomorrow + "/" + monthTomorrow + "/" + yearTomorrow;
            return strTomorrow;
    }
    public String tomorrow()
    {
            dayTomorrow = this.day++;
            monthTomorrow = this.month;
            yearTomorrow = this.year;

            if(dayTomorrow > 30)
            {
                    dayTomorrow = 1;
                    monthTomorrow = this.month++;
            }
            if(monthTomorrow > 12)
            {
                    monthTomorrow = 1;
                    yearTomorrow = this.year++;
            }

            return getTomorrow();
    }
    public void showDate()
    {
            System.out.print("\n\n THIS OBJECT IS STORING ");
            System.out.print(getDate());
            System.out.print("\n\n");
    }
    public void showTomorrow()
    {
            System.out.print("\n\n THE DATE TOMORROW IS ");
            System.out.print(getTomorrow());
            System.out.print("\n\n");
    }
    public boolean equals(Date inDate)
    {
            if(this.day == inDate.day && this.month == inDate.month && this.year == inDate.year)
            {
                    return true;
            }
            else
            {
                    return false;
            }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:54:50.500

您只需要使用`++this.day`,`++this.month`和`++this.year`。当您使用`this.day++`它时，它会返回以前的日期值，而不是新的。把它`++`放在前面解决了这个问题。此外，它会更改`day`值...您可能希望将其更改为`this.day + 1`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T20:08:46.937

看看这个：[http ://docs.oracle.com/javase/tutorial/java/nutsandbolts/op1.html](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/op1.html)

增量后...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T20:12:47.987

您可以在 java 中使用本机日期支持，但我认为您只是在练习，对吗？

这应该可以解决问题：

```
public class Date {
    private int day = 1;
    private int month = 1;
    private int year = 1970;
    private int dayTomorrow = day+1;
    private int monthTomorrow;
    private int yearTomorrow;

    public Date()
    {
            tomorrow();
    }
    public Date(int inDay, int inMonth, int inYear)
    {
            day = inDay;
            month = inMonth;
            year = inYear;
            tomorrow();
    }
    public void setDate(int inDay, int inMonth, int inYear)
    {
            day = inDay;
            month = inMonth;
            year = inYear;
    }
    public String getDate()
    {
            String strDate;
            strDate = day + "/" + month + "/" + year;
            return strDate;
    }
    public String getTomorrow()
    {
            String strTomorrow;
            strTomorrow = dayTomorrow + "/" + monthTomorrow + "/" + yearTomorrow;
            return strTomorrow;
    }
    public void tomorrow()
    {
            monthTomorrow = this.month;
            yearTomorrow = this.year;

            if(dayTomorrow > 30)
            {
                    dayTomorrow = 1;
                    monthTomorrow = this.month++;
            }
            if(monthTomorrow > 12)
            {
                    monthTomorrow = 1;
                    yearTomorrow = this.year++;
            }
    }
    public void showDate()
    {
            System.out.print("\n\n THIS OBJECT IS STORING ");
            System.out.print(getDate());
            System.out.print("\n\n");
    }
    public void showTomorrow()
    {
            System.out.print("\n\n THE DATE TOMORROW IS ");
            System.out.print(getTomorrow());
            System.out.print("\n\n");
    }
    public boolean equals(Date inDate)
    {
            if(this.day == inDate.day && this.month == inDate.month && this.year == inDate.year)
            {
                    return true;
            }
            else
            {
                    return false;
            }
    }
} 
```

仔细查看我所做的任何更改；）这是主要的：

```
public static void main(String[] args) {
    Date d = new Date();
    d.showDate();
    d.showTomorrow();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T20:01:07.967

您是否在 date1.tomorrow() 之后调用 showDate() 来显示您的输出？

或代替`date1.tomorrow();`打电话`date1.showTomorrow();`

# android - Android - 有没有办法远程打开和调试给定的 Android 设备？

> ID：15209950
> 
> 赞同：12
> 
> 时间：2013-03-04T19:52:48.457
> 
> 标签：android, remote-debugging

我的场景如下：我正在开发一个应用程序，当它与我的国家不同时，应用程序中会出现一个错误，并且只有在那里。该错误与通过 URL 访问下载图像失败有关。现在，我还没有弄清楚它可能是什么。我已经查过的一些主题是：

*   它与国际化和/或文化无关，因为代码没有实现这一点；
*   与防火墙/安全访问无关，因为如果其他国家的用户打开图像的URL，他可以查看图像；

在不root设备的情况下，有没有办法远程打开和调试给定的Android设备，就像[SSH](http://en.wikipedia.org/wiki/Secure_Shell)或[VNC](http://www.realvnc.com/)一样？

类似的问题是：

*   [远程调试设备上的 android 应用程序](https://stackoverflow.com/questions/4508649/debugging-android-app-on-a-device-remotely)
*   [远程调试](https://stackoverflow.com/questions/13625528/remote-debugging)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-09-02T10:06:31.787

好吧，您可以使用 TCP/IP 连接调试设备（我有时在家中使用 WIFI 进行调试）。您需要做的就是确保远程设备已连接到 Internet，并且您的 PC 可以通过直接 TCP/IP 连接访问该设备。

由于 Android 设备连接在另一个位置 - 您必须确保路由器的防火墙允许 ADB 正在使用的端口中的通信传出连接，并且目标 Android 设备在该端口接收通信（如果它位于路由器后面 -路由器应该允许右端口下的连接并将该端口中的所有通信转发到android设备）。

换句话说 - 您必须将您的通信“隧道”到目标设备。还有其他隧道解决方案/产品，但我从未使用过它们，我更喜欢“手动”方式

祝你好运，丹

编辑：在 Android 11 中 - adb 可以在 WIFI 上原生工作：[https ://developer.android.com/studio/run/device#wireless](https://developer.android.com/studio/run/device#wireless)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T19:59:10.550

也许您可以让用户安装类似 aLogcat 的东西，然后让他们向您发送失败的日志。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-04T20:01:41.917

以及远程调试我不知道的设备，但您可以使用[ACRA（Android 应用程序崩溃报告）](https://code.google.com/p/acra/)。

您只需要设置一个 google doc，将 lib 添加到您的项目中，当应用程序崩溃时，它会向该 google doc 发送崩溃报告。[在此处查看快速设置](http://acra.ch/)

# java - 在可抛出对象中重载 getCause() 方法

> ID：15209957
> 
> 赞同：0
> 
> 时间：2013-03-04T19:53:26.887
> 
> 标签：java, throwable

如何在可抛出对象中重载 getCause() 方法？我有以下内容，但它似乎不起作用，因为它说它不能用字符串重载。

```
public class MyException extends RuntimeException   {
String cause;
MyException(String s)   {
    cause = s;
}
@Overwrite public String getCause()    {
    return cause;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:55:34.293

拥有两个仅返回类型不同的方法是非法的。假设有人写道：

```
Object obj = myException.getCause(); 
```

那是完全合法的java，编译器无法确定它是`String`版本还是`Throwable`版本。

同样，您不能替换超类签名，因为这也是完全合法的：

```
Throwable t = new MyException();
Throwable t0 = t.getCause();
//Returns String?!?!?!? 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-06-20T11:14:30.527

**接受的答案清楚了这一点**：

> 拥有两个仅返回类型不同的方法是非法的

**但是如果你有一种情况，`getCause()`应该返回自定义原因`MyException`，以防原始原因为空。**

在这种情况下，您可以使用`initCause()`设置原因和覆盖`toString()`方法。因此，当`getCause()`在 的对象上调用方法时`MyException`，它将显示来自 customCause 的消息，而不是 null。

**有什么用：**在遗留系统中，如果您在记录时使用`getCause()`了`MyException`对象，现在您想在不更改大量代码的情况下向其添加自定义原因，这就是方法。

```
 public class MyException extends RuntimeException {
        String customCause;

        MyException(String s) {
            super(s);
            customCause = s;
        }

        @Override
        public synchronized Throwable getCause() {
            if (super.getCause() != null) {
                return this;
            } else {
                this.initCause(new Throwable(customCause));
                return this;
            }
        }

        @Override
        public String toString() {
            String s = getClass().getName();
            String message = getLocalizedMessage();
            if (message == null) {
                message = customCause;
            }
            return (message != null) ? (s + ": " + message) : s;
        }
    } 
```

参考资料： [https://docs.oracle.com/javase/7/docs/api/java/lang/Throwable.html#initCause(java.lang.Throwable)](https://docs.oracle.com/javase/7/docs/api/java/lang/Throwable.html#initCause(java.lang.Throwable)) [https://docs.oracle.com/javase/7/ docs/api/java/lang/Throwable.html](https://docs.oracle.com/javase/7/docs/api/java/lang/Throwable.html)

# jquery - 使用 knockout.js 动态添加“td”和绑定

> ID：15209958
> 
> 赞同：2
> 
> 时间：2013-03-04T19:53:30.983
> 
> 标签：jquery, asp.net-mvc, knockout.js

有没有办法在不显式写入属性名称的情况下动态添加 'td with data-bind:"text: propertyName"'？：

```
<table>
<tbody data-bind="template: {name: 'Tmpl', foreach:person}">                      
</tbody>

<script id="Tmpl" type="text/html">
 <tr class="tableRow">
  <td data-bind="text: Name"></td>
  <td data-bind="text: Age"></td>
 </tr>
</script>
</table> 
```

我的“人”数据源可以有不同的属性名称和不同数量的 td，所以它非常动态。我尝试的是：

```
<table>
<tbody data-bind="template: {name: 'Tmpl', foreach: person}">                      
</tbody>
<script id="assessmentTmpl" type="text/html">
 <tr class="tableRow">
  <td data-bind="text: $data"></td>
 </tr>
</script>
</table> 
```

但这只会赋予对象本身而不是属性。我试图通过使用 knockout.js 来做到这一点，但我可能需要用 jquery 动态添加 td。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T20:09:48.107

如有疑问，请尝试自定义绑定！

```
<table>
    <tbody data-bind="template: {name: 'Tmpl', foreach:person, as : per}">                      
    </tbody>

    <script id="Tmpl" type="text/html">
        <tr class="tableRow" data-bind="createRow: per">
        </tr>
    </script>
</table>

ko.bindingHandlers.createRow =
{
    update: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext)
    {
        for(var item in valueAccessor())
        {
            $(element).append('<td data-bind="text:' + valueAccessor()[item] + '"></td>');
        });
    }
}; 
```

我认为这会起作用，如果数据绑定不正确，您可以自己输出该更新方法中的值：

```
$(element).append('<td>' + valueAccessor()[item] + '</td>'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-22T15:48:49.277

使用与先前答案建议的方法相同的方法，我提供了以下代码。请注意，它可以重构为更“优雅”的东西。

视图代码：

```
<table class='table table-striped table-bordered'>
    <thead>
        <tr class="tableRow" data-bind="createTheadRow: userEntityObj.UserList()[0]"></tr>
    </thead>
    <tbody data-bind="foreach:userEntityObj.UserList">
        <tr class="tableRow" data-bind="createTbodyRow: $data"></tr>
    </tbody>
</table> 
```

自定义绑定：

```
ko.bindingHandlers.createTheadRow =
{
    update: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext)
    {
        if($(element).html() == '')
        if (valueAccessor() != null)
        for (var key in valueAccessor())
            $(element).prepend('<th>' + key + '</th>');
    }
};
ko.bindingHandlers.createTbodyRow =
{
    update: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext)
    {
        if (valueAccessor() != null)
        for (var key in valueAccessor())
            $(element).prepend('<td data-bind="text:' + key + '"></td>');
    }
}; 
```

有了这个，您可以在不知道源属性的情况下生成一个表。您还可以添加自定义 TD 字段（例如，用于编辑/删除按钮），只需在 tr 块中添加此字段（绑定 make 前置，因此您的自定义 TD 将出现在 TR 的末尾）

# machine-learning - 前馈神经网络中的可变输入

> ID：15209959
> 
> 赞同：0
> 
> 时间：2013-03-04T19:53:35.550
> 
> 标签：machine-learning, neural-network

在前馈神经网络中具有可变长度输入的最常见策略是什么？

* * *

更具体地说，考虑以下假设场景：

1.  我有一辆车有四个传感器，两个在左边（接近度和颜色），两个在右边（还有接近度和颜色）。
2.  有两个执行器（假设左和右）。
3.  我已经成功地训练了一个神经网络，将两组输入（4 个神经元接近度/颜色）与一组输出（2 个神经元用于方向）相关联。

现在的问题是，我如何缩放它：

1.  相同类型传感器/执行器的固定上限（例如 50 个）；甚至
2.  任意数量的传感器/执行器？

PS：我的直觉是，我需要一种制作神经网络的形式来*作曲*，但我一点也不知道从哪里开始。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:56:32.243

简单的解决方案是始终构建一些固定的、最大数量的特征向量，并将不活动的特征保留为默认值。合理的默认值通常为零，尤其是。如果您将输入缩放到范围 [-1, 1]。

# ssh - zsh ssh-add -L `-L' 附近的解析错误

> ID：15209960
> 
> 赞同：0
> 
> 时间：2013-03-04T19:53:42.930
> 
> 标签：ssh, zsh

我正在尝试运行 ssh-add -L（或任何其他虚线选项），并且 zsh 返回 zsh: parse error near `-L'。这是我第一次看到 zsh 这样做，并且它不使用任何其他命令。

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T04:52:34.013

首先要弄清楚是`ssh-add`别名还是 shell 函数，而不是二进制可执行文件`/usr/bin/ssh-add`。

其次，尝试在没有自定义 ZSH 配置的情况下在 ZSH 会话中运行相同的命令。要获得干净的环境，请运行

```
env -i TERM=$TERM LC_ALL=$LC_ALL LANG=$LANG zsh -f 
```

然后再试`ssh-add -L`一次，让我们知道你看到了什么。

此外，请发布以下输出：

```
uname -a
zsh --version 
```

# c# - C# 应用内通用 Pub/Sub 子集模式

> ID：15209962
> 
> 赞同：1
> 
> 时间：2013-03-04T19:53:47.377
> 
> 标签：c#, publish-subscribe

我不完全确定我正在寻找的正确术语，所以请多多包涵。在我正在维护的应用程序中，我们有一个标准的 PubSub 实现，用于从几个不同的发布者获取数据到应用程序中。我们有一个“服务”来订阅处理 PubSub 协商的数据，不同类型的数据有不同的服务（例如产品、订单、供应商等）。这些服务通常通过普通的 .NET 事件通知应用程序消息。

然而，并非应用程序的所有部分都对所有事件感兴趣。例如，某些地方可能只对产品 A、B 和 C 感兴趣，而应用程序中的另一个地方需要产品 B、D 和 E，而想要的内容通常由用户输入驱动。最终发生的事情是，在应用程序的每个位置，都会将处理程序添加到服务的事件中，并且该处理程序会根据其他代码过滤掉不需要的事件，这些代码根据用户输入设置过滤器。毫不奇怪，用于过滤和设置过滤器的代码在任何地方都基本相同。

对于一个通用的 PubSub 对象集来说，这似乎是一个位于服务和需要数据的地方之间的好地方。我可以根据需要为每个数据场景设置对象的具体版本，并将它们添加到服务中，以供应用程序中的各个位置使用。不想重新发明轮子，我一直在谷歌搜索 PubSub，我能找到的最接近主题的是主题，但这些不适合这种情况，因为它需要为每个产品设置一个主题。

有没有人知道这方面的任何资源？我正在使用 C#，但如果需要，我可以适应其他语言。主要要求是这不能是单独的服务或进程，比如WCF；它需要驻留在应用程序中并使用现有的基础设施，大概是通过附加到服务的事件，然后以这种方式通知订阅者。同样值得关注的是这个应用程序是大量多线程的，因此倾向于线程安全会有所帮助，尽管我可以根据需要进行调整。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T20:18:34.863

我会关注 DDS 产品（数据分发服务），例如 RTI。他们提供您所需要的一切以及更多。见： [http ://www.rti.com/products/dds/](http://www.rti.com/products/dds/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T02:09:41.860

嗯..不确定我是否理解正确。这样的事情怎么样？使用模式

```
public void handleui(dynamic s)
{
    Application.Current.Dispatcher.Invoke(delegate
                                              {
                                                  btn1.Content = s.ToString();
                                              });
}
Globals.Events["error"] += msg=> Console.WriteLine(msg);//logger perhaps
Globals.Events["productb"] += handleui;//sub
Globals.Events["productb"] -= handleui;//unsub    
Globals.Events["productb"].Send("productbdata");//raise the event or publish to productb channel subscribers
Globals.Events.Send("broadcast?"); 
```

我想您可能会做一个过滤器，它只是将所有事件发送到 Events["producta"]、Events["productb"]、Events["productc"] 等，并且这些部分可以在需要时进行 sub/unsub。

执行。

```
using System;
using System.Collections.Concurrent;

public class Globals
{
    public static MsgBus Events = new MsgBus();
}

public class MsgBus
{
    private readonly ConcurrentDictionary<dynamic, MsgChannel> channels = new ConcurrentDictionary<dynamic, MsgChannel>();

    public MsgChannel this[dynamic channel]
    {
        set { channels[channel] = value; }
        get
        {
            var ch = (MsgChannel)channels.GetOrAdd(channel, new MsgChannel());
            return ch;
        }
    }

    private MsgChannel broadcast = new MsgChannel();
    public void Send(dynamic msg)
    {
        broadcast.Send(msg);
    }

    public static MsgBus operator +(MsgBus left, Action<dynamic> right)
    {
        left.broadcast += right;
        return left;
    }

    public static MsgBus operator -(MsgBus left, Action<dynamic> right)
    {
        left.broadcast -= right;
        return left;
    }
}

public class MsgChannel
{
    ConcurrentDictionary<Action<dynamic>, int> observers = new ConcurrentDictionary<Action<dynamic>, int>();
    public void Send(dynamic msg)
    {
        foreach (var observer in observers)
        {
            for (int i = 0; i < observer.Value; i++)
            {
                observer.Key.Invoke(msg);
            }
        }
    }
    public static MsgChannel operator +(MsgChannel left, Action<dynamic> right)
    {

        if (!left.observers.ContainsKey(right))
        {
            left.observers.GetOrAdd(right, 0);
        }

        left.observers[right]++;
        return left;
    }

    public static MsgChannel operator -(MsgChannel left, Action<dynamic> right)
    {
        if (left.observers.ContainsKey(right) &&
            left.observers[right] > 0)
        {
            left.observers[right]--;
            int dummy;
            if (left.observers[right] <= 0) left.observers.TryRemove(right, out dummy);
        }

        return left;
    }
} 
```

# python - 使用 ElementTree 时出现未定义实体错误

> ID：15209965
> 
> 赞同：2
> 
> 时间：2013-03-04T19:53:50.453
> 
> 标签：python, xml-parsing, elementtree

我有一组 XML 文件，我需要读取它们并将其格式化为单个 CSV 文件。为了从 XML 文件中读取，我使用了[这里](https://stackoverflow.com/questions/5530857/parse-xml-file-into-python-object)提到的解决方案。

我的代码如下所示：

```
from os import listdir
import xml.etree.cElementTree as et

files = listdir(".../blogs/")

for i in range(len(files)):
    # fname = ".../blogs/" + files[i]
    f = open(".../blogs/" + files[i], 'r')
    contents = f.read()
    tree=et.fromstring(contents)
    for el in tree.findall('post'):
        post = el.text

    f.close() 
```

这给了我`cElementTree.ParseError: undefined entity:`在线上的错误`tree=et.fromstring(contents)`。奇怪的是，当我在命令行 Python 上运行每个命令时（虽然没有 for 循环），它运行得很好。

如果你想知道 XML 结构，它是这样的：

```
<Blog>
<date> some date </date>
<post> some blog post </post>
</Blog> 
```

那么是什么导致了这个错误，为什么它不是从 Python 文件运行，而是从命令行运行呢？

更新：阅读[此链接](https://stackoverflow.com/questions/7693515/why-is-elementtree-raising-a-parseerror)后，我检查`files[0]`并发现“&”符号出现了几次。我认为这可能是导致问题的原因。当我在命令行上运行相同的命令时，我使用了一个随机文件来读取。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T20:18:14.697

正如我在更新中提到的，我怀疑某些符号可能会导致问题。当我在命令行上运行相同的行时没有出现错误的原因是因为我会随机选择一个没有任何此类字符的文件。

由于我主要需要`<post>`and`</post>`标记之间的内容，因此我创建了自己的解析器（如[更新中提到的链接中](https://stackoverflow.com/questions/7693515/why-is-elementtree-raising-a-parseerror)所建议的那样）。

```
from os import listdir

files = listdir(".../blogs/")

for i in range(len(files)):

    f = open(".../blogs/" + files[i], 'r')
    contents = f.read()
    seek1 = contents.find('<post>')
    seek2 = contents.find('</post>', seek1+1)
    while(seek1!=-1):
        post = contents[seek1+5:seek2+6]
        seek1 = contents.find('<post>', seek1+1)
        seek2 = contents.find('</post>', seek1+1)

    f.close() 
```

# javascript - 循环遍历 JSON 返回未定义？

> ID：15209968
> 
> 赞同：1
> 
> 时间：2013-03-04T19:53:59.570
> 
> 标签：javascript, arrays, json, for-loop

杰森：

```
[{"Name":"David Smith","ClaimNum":"123456789","Site":"SomeSite","ServiceDate":"2013-02-27","Program":"3","ServiceType":"168","ReportType":"ReportTypeHere","program":"Some Program 1","type":"ServiceTypeHere"},{"Name":"David Smith","ClaimNum":"123456789","Site":"SomeSite","ServiceDate":"2013-02-27","Program":"3","ServiceType":"168","ReportType":"ReportTypeHere","program":"Some Program 1","type":"ServiceTypeHere"}] 
```

Javascript：

```
var obj = eval ("(" + jsonString+ ")");
var string;
for(i=0; i < obj.length; i++){
    string += obj[i].Name + " - " + obj[i].ClaimNum + " - " + obj[i].Site + " - " + obj[i].ServiceDate + " - " + obj[i].program + " - " + obj[i].type + "<br/>";
} 
```

我使用的是 eval 而不是 JSON.parse，因为我们使用的一些较旧的 Web 浏览器不支持 JSON.parse :(

但是，当我这样做时，这确实有效：

```
 document.getElementById("results").innerHTML = string; 
```

第一个条目有：

```
undefinedDavid Smith 
```

我读到这是因为长度不能用于 json 对象，因此您必须转换为数组。我以为 eval 会这样做吗？

我很茫然，想为此使用直接的javascript。但是，如果没有其他方法可以使用 JQUERY。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T19:56:02.883

的初始值为`string`，`undefined`字符串化后变为`"undefined"`。

所以`string += obj[i].Name etc etc`意味着`string = "undefined" + obj[i].Name etc etc`

`string`初始化时分配一个空字符串。

```
var string = ""; 
```

* * *

> 我读到这是因为长度不能用于 json 对象，因此您必须转换为数组。

“json 对象”是一个非常无用的术语。

该`JSON`对象是浏览器提供的具有解析和序列化方法的对象。

JSON 文本是一段 JSON，通常被误认为是“对象”。

JSON 中的对象是具有命名键和值的数据结构。

如果您将 JSON 文本解析为 JavaScript（这就是您正在做的事情`eval`），那么您将获得一个 JavaScript 数据结构。如果你访问`length`一个对象的属性，那么`undefined`除非你给它一个`length`属性，否则它将是。外部数据结构是一个*数组*，这就是您要循环的内容。数组*确实*有`length`属性（等于数组上最大整数键名的值）。

# java - 在java中使用用户输入进行反射过程

> ID：15209972
> 
> 赞同：0
> 
> 时间：2013-03-04T19:54:18.633
> 
> 标签：java

基本上是在尝试制作 java 命令提示符。假设用户输入作为用户的输入：

```
new x java.util.ArrayList 
```

这里 x 是对象名称，java.util.ArrayList 是类。所以用户输入的这个脚本意味着创建一个java.util.ArrayList类的对象。

现在假设用户输入：

```
new x java.util.ArrayList int:5 
```

意味着创建 java.util.ArrayList 的对象 x 并使其大小为 5。像这样，我希望每次我输入与对象创建相关的内容作为输入时，我应该能够根据输入创建其对象及其方法的类用户这样做。我是 java 和反射的新手，所以请帮忙！这是我到目前为止想到的代码：

```
 public static void token_classification() throws ClassNotFoundException
    {
        my_hash = new HashMap();
        Keep_Obj_Info = new HashMap();
        if(expression_keeper[0].equalsIgnoreCase("new"))
        {
           my_hash.put("Object", expression_keeper[1]);
           Class Obj= Class.forName(expression_keeper[2]);
           Keep_Obj_Info.put("Modifier", Obj.getModifiers());
           Keep_Obj_Info.put("Package",Obj.getPackage());
                ////????

           Constructor[] constructors = Obj.getConstructors();

        }
        else
        if(expression_keeper[0].equalsIgnoreCase("call"))
        {

        }
        else
        if(expression_keeper[0].equalsIgnoreCase("print"))
        {

        }
        else
        {
           System.out.println("Invalid Script!");
        }
    } 
```

ExpressionKeeper 基本上是一个字符串数组，它以标记化的形式保存用户输入。意味着新位置的空白区域旁边的任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T20:43:14.190

非常适合在 java 中创建对象；构造函数及其参数是必需的。您可以有一个通用框架，它将接受来自命令提示符的输入并解释它们意味着找出输入的数据类型，例如：数字/字符串/字符/布尔等。您的框架也应该知道参数索引，例如说一个构造函数有 2 个参数，一个是字符串，另一个是 int。并说第一个参数是int，第二个参数是String，在从命令行传递参数时，用户首先传递字符串，然后在这种情况下传递int，你的程序应该足够聪明，可以按顺序正确排列它们。你需要处理很多这样的事情......现在来看你提到的 ArrayList 的例子，你可以编写一个程序如下：（我刚刚给了你一个伪代码，你可以用自己的方式实现）

{

```
 int howManyParametersFromCommandLine = getnoParameterCount;  //it will maintain no.of parameters passed from command line

           String[] parametersFromCommandLine  = getParametersFromcommandLine();  // Ex : {1,"ABC",new Double(80.0d)}; 

            List<Class>  parameterTypesList = parseParameters(parametersFromCommandLine); //This will identify type of each of the parameter

   Class  clazz = Class.forName("youClassName");

   Constructor[]  cons = clazz.getConstructors();

   for(Constructor c :  cons) 
```

{ 类[] 参数类型 = c.getParameterTypes();

```
 if(parameterTypes.length == howManyParametersFromCommandLine)

       {
          //try to match the parameter type in parameterTypesList with parameterTypes if this matches then

           boolean typeMatchingAndSequecneSucess = matchParameters(parameterTypes,parameterTypesList);

           if(typeMatchingAndSequecneSucess)
           {
               if(c.isAccessible())
               {
                  Object[] initargs = parseAndRetActualParamValue(parametersFromCommandLine); 
                  return c.newInstance(initargs); 
               }
           }
       }

   } 
```

}

希望对你有帮助 ！！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T20:11:43.480

您可能想要使用`Interpreter`设计模式。它仅用于此目的。
这`Interpreter`有点复杂，但可以确保您的代码解释正确。此外，它还使您可以轻松包含新命令。
看看这里：[http](http://en.wikipedia.org/wiki/Interpreter_pattern)
://en.wikipedia.org/wiki/Interpreter_pattern希望我能提供帮助。

# java - 用于标记值的 Spring MVC jsp 标记占位符

> ID：15209975
> 
> 赞同：0
> 
> 时间：2013-03-04T19:54:35.640
> 
> 标签：java, jsp, spring-mvc

我不确定如何在 Spring MVC 表单标签中定义 value 属性。我正在查询数据库，我想将数据返回给 jsp。我以列表的形式将一个对象返回给视图。我想知道如何为选项列表和输入框编写属性值。下面是我的代码：

**jsp**

```
<form:form id="citizenRegistration" name ="citizenRegistration" method="POST" commandName="citizens" action="citizen_registration.htm">

<li>
<label>Select Gender</label><form:select path="genderId" id="genderId" title="Select Your Gender"><form:options items = "${gender.genderList}" selected=???? itemValue="genderId" itemLabel="genderDesc" />
</form:select><form:errors path="genderId" class="errors"/>
</li>               
                                            <li><form:label for="weight" path="weight">Enter Weight <i>(lbs)</i></form:label>
<form:input path="weight" id="weight" title="Enter Weight" value= ???/><form:errors path="weight" class="errors"/>
</li> 
```

**爪哇道**

函数返回：..........................

```
 List<Citizens> listOfCitizens = getJdbcTemplate().query(sql, new CitizensMapper());      
    return listOfCitizens; 
```

**控制器**

```
if (user_request.equals("Query")){
 logger.debug("about to preform query");
 citizenManager.getListOfCitizens(citizen);

 if(citizenManager.getListOfCitizens(citizen).isEmpty()){
    model.addAttribute("icon","ui-icon ui-icon-circle-close");
    model.addAttribute("results","Notice: Query Caused No Records To Be Retrived!");    
  }

//how do i return the List<Citizens> listOfCitizens
//or what should be done to send the user the data from the database
return new ModelAndView("citizen_registration");                    
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T20:00:47.737

该值来自表单属性`citizens`定义的模型对象（在您的情况下） 。`commandName`Spring 使用该属性和`path`属性来查找表单对象的值。

因此，例如，不需要专门为`value`属性提供值。

**编辑：**

这是一个简化的示例：

```
 @RequestMapping(value = "/editCitizen", method = RequestMethod.GET)
  public String editCitizen(@ModelAttribute("citizen") Citizen citizen, Model model) {
    // set attributes of citizen
    citizen.genderId = "M";
    citizen.weight = 180;
    // etc.

    // set other model attributes like lists for <form:select>s
    model.addAttribute("genderList", <list of genders>);
    return "path.to.my.jsp";
  }

<form:form id="citizenRegistration" name ="citizenRegistration" method="POST" commandName="citizen" action="citizen_registration.htm">
  <form:select path="genderId" items="${genderList}" itemLabel="genderDesc" itemValue="genderId"></form:select>
  <form:input path="weight" id="weight" title="Enter Weight"/>
</form:form> 
```

# django - 在哪里存储密钥 DJANGO

> ID：15209978
> 
> 赞同：94
> 
> 时间：2013-03-04T19:54:52.040
> 
> 标签：django, django-settings

对于我的一生，我一直在到处寻找这个，但没有找到答案。我希望我没有发布重复。

到处都建议您将密钥保存在与常规 settings.py 不同的文件中。此外，您永远不应该提交包含诸如 SECRET_KEY、AWS_SECRET_KEY 等密钥的“secret.py”文件。

我的问题是：在您的生产服务器中，您需要引用您的密钥，这意味着您的“secret.py”设置文件应该位于服务器周围的某个地方，对吗？如果是这样，您如何在生产中保护您的密钥？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2020-04-26T08:24:21.843

我想添加一个新答案，因为作为初学者，以前接受的答案对我来说没有多大意义（这只是难题的一部分）。

所以这就是我在本地和生产（Heroku 等）中存储我的密钥的方式。

**注意：**只有当您计划将项目上线时，您才真正需要这样做。如果只是本地项目，没必要。

我还为喜欢这种格式的人制作了一个[视频教程。](https://youtu.be/bPR3Q0BFFzw)

**1) 安装 python-dotenv 以创建本地项目环境来存储您的密钥。**

```
pip install python-dotenv 
```

**2）在您的基本目录中创建一个`.env`文件（在哪里`manage.py`）。**

```
YourDjangoProject
├───project
│   ├───__init__.py
│   ├───asgi.py
│   ├───settings.py
│   ├───urls.py
│   └───wsgi.py
├───.env
├───manage.py
└───db.sqlite3 
```

如果你有一个 Heroku 项目，它应该看起来像这样：

```
YourDjangoProject
├───.git
├───project
│   ├───__init__.py
│   ├───asgi.py
│   ├───settings.py
│   ├───urls.py
│   └───wsgi.py
├───venv
├───.env
├───.gitignore
├───manage.py
├───Procfile
├───requirements.txt
└───runtime.txt 
```

**3) 添加`.env`到您的`.gitignore`文件中。**

```
echo .env > .gitignore  # Or just open your .gitignore and type in .env 
```

这是您保持密钥更安全的方式，因为您不会将 .env 文件上传到 git 或 heroku（或其他任何地方）。

**4）将您的 SECRET_KEY 从您的 settings.py 文件添加到 .env 文件中（不带引号）**

```
**Inside of your .env file**
SECRET_KEY=qolwvjicds5p53gvod1pyrz*%2uykjw&a^&c4moab!w=&16ou7 # <- Example key, SECRET_KEY=yoursecretkey 
```

**5) 在您的 settings.py 文件中，添加以下设置：**

```
import os
import dotenv # <- New

# Add .env variables anywhere before SECRET_KEY
dotenv_file = os.path.join(BASE_DIR, ".env")
if os.path.isfile(dotenv_file):
    dotenv.load_dotenv(dotenv_file)

# UPDATE secret key
SECRET_KEY = os.environ['SECRET_KEY'] # Instead of your actual secret key 
```

或者，感谢[@Ashkay Chandran 的回答](https://stackoverflow.com/a/65411006/10415970)：

```
from dotenv import load_dotenv, find_dotenv

load_dotenv(find_dotenv())

SECRET_KEY = os.environ['SECRET_KEY'] 
```

现在您的密钥已成功存储在本地。

**更新**：我发现您也可以使用似乎更容易`config`的包中的方法：`python-decouple`

```
from decouple import config

SECRET_KEY = config('SECRET_KEY') 
```

现在您不需要`import os`或使用`dotenv`它，因为它会为您处理这些部分并且仍将使用 .env 文件。我开始在我所有的项目中使用它。

**6) 在您的主机（例如 Heroku）上添加 SECRET_KEY 环境变量。**

* * *

我主要使用 Heroku 站点，因此如果您想将 Heroku 用于 Django 项目，这部分适合您。

这假设您已经有一个 Heroku 项目设置并且已经在您的计算机上下载了 Heroku CLI。

**您有 2 个选项：**

1.  从命令行/终端，您可以在项目目录中输入以下命令：

```
heroku config:set SECRET_KEY=yoursecretkey # Again, no quotes. 
```

2.  您可以转到 Heroku 仪表板，单击您的应用程序，转到您的应用程序设置，然后查看“Config Vars”部分，然后单击“Reveal Vars”或“Add Vars”并在那里添加您的 SECRET_KEY。

然后，当您通过 git 将项目推送到 Heroku 时，它应该可以正常工作，没有任何问题。

就是这样！

这个答案是针对初学者/中级的，希望能消除任何困惑（因为这对我来说绝对是令人困惑的）。

希望这可以帮助！

快乐编码。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2013-03-04T20:03:23.170

[有关此问题的讨论，](https://docs.djangoproject.com/en/stable/howto/deployment/checklist/#secret-key)请参阅Django 部署文档。

生产有很多选择。我这样做的方法是将我的敏感数据变量设置为生产环境中的环境变量。然后我像这样检索通过中的`settings.py`变量`os.environ`：

```
import os
SECRET_KEY = os.environ['SECRET_KEY'] 
```

另一种可能的选择是`secret.py`通过部署脚本复制文件。

我确信对于不同的 Web 服务器还有其他特定选项。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-03-04T20:07:55.320

您应该以模块化方式存储您的设置。我的意思是把你的设置分散到多个文件中。

例如，您可能必须`base_settings.py`存储所有基本设置；`dev_settings.py`用于您的开发服务器设置；最后`prod_base_settings.py`是所有生产设置。所有非基本设置文件将导入所有基本设置，然后只更改必要的内容：

```
# base_settings.py
...

# dev_settings.py
from base_settings import *
DEBUG = TRUE
...

# prod_base_settings.py
from base_settings import *
DEBUG = FALSE
... 
```

这种方法允许您从不同的设置中获得不同的设置。您还可以提交所有这些文件，除非在生产服务器上您可以创建实际的生产设置文件`prod_settings.py`，您将在其中指定所有敏感设置。此文件不应在任何地方提交，其内容应保持安全：

```
# prod_settings.py
from prod_base_settings import *
SECRET_KEY = 'foo' 
```

至于文件名，您可以使用您认为合适的任何文件名。就我个人而言，我实际上为设置创建了一个 Python 包，然后将各种设置保留在包中：

```
project/
  project/
    settings/
      __init__.py
      base.py
      dev.py
      ...
  app1/
    models.py
    ...
  app2/
    models.py
    ... 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-03-13T14:20:50.730

我知道这已经很长时间了，但我刚刚开源了一个小型 Django 应用程序，我正在使用它来生成一个新的密钥，如果它还不存在的话。它被称为[django-generate-secret-key](https://pypi.python.org/pypi/django-generate-secret-key)。

```
pip install django-generate-secret-key 
```

然后，在配置/部署运行我的 Django 项目的新服务器时，我运行以下命令（来自 Ansible）：

```
python manage.py generate_secret_key 
```

它很简单：

*   检查是否需要生成密钥
*   在文件中生成它`secretkey.txt`（可以自定义）

然后，您所需要的就是在您的设置文件中：

```
with open('/path/to/the/secretkey.txt') as f:
    SECRET_KEY = f.read().strip() 
```

您现在可以从*完全自动化*的配置过程中受益，*而无需在存储库中存储静态密钥*。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-05-03T16:12:38.420

您应该使用专为分解敏感数据而设计的工具，而不是 if/then 逻辑。我使用 YamJam [https://pypi.python.org/pypi/yamjam/](https://pypi.python.org/pypi/yamjam/)。它具有 os.environ 方法的所有优点，但更简单——您仍然需要设置这些环境变量，您需要将它们放在某个脚本中。YamJam 将这些配置设置存储在机器配置存储中，并且还允许逐个项目覆盖的能力。

```
from YamJam import yamjam

variable = yamjam()['myproject']['variable'] 
```

是基本用法。和 os.environ 方法一样，它不是特定于框架的，您可以将它与 Django 或任何其他应用程序/框架一起使用。我已经尝试了所有这些，多个 settings.py 文件，if/then 的脆弱逻辑和环境争论。最后，我改用了 yamjam 并没有后悔。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-09-18T07:56:32.030

将秘密存储在环境中仍然会将它们置于环境中；如果未经授权的用户可以访问环境，则可以利用它。列出环境变量是一项微不足道的工作，并且命名一个产品对于~~不良行为~~者和不受欢迎的用户`SECRET`来说更加有用和明显。

 ~~然而，秘密在生产中是必要的，那么如何在最小化攻击面的同时访问它们呢？[使用git-secret 之](https://git-secret.io)类的工具加密文件中的每个秘密，然后允许授权用户读取文件，如[django 的文档](https://docs.djangoproject.com/en/3.1/howto/deployment/checklist/#secret-key)中所述。然后“告诉”非 root 用户秘密，以便在初始化期间可以读入。

（或者，也可以使用 Hashicorp 的 Vault，并通过[HVAC python](https://github.com/hvac/hvac)模块访问存储在 Vault 中的秘密。）

一旦告诉这个非 root 用户，这样的事情就很容易了：

```
# Remember that './secret_key.txt' is encrypted until it's needed, and only read by a non-root user
with open('./secret_key.txt') as f:
    SECRET_KEY = f.read().strip() 
```

这并不完美，而且，是的，攻击者可以枚举变量并访问它——但在运行时这样做非常困难，而 Django 在保护其密钥免受这种威胁向量方面做得很好。

这比在环境中存储机密要安全得多。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-12-22T15:04:16.243

添加到[zack-plauch](https://stackoverflow.com/a/61437799/12167598)的答案中，要获取`.env`文件的路径，使用`python-dotenv` [module](https://pypi.org/project/python-dotenv/)`find_dotenv`时，可以使用该方法，

```
from dotenv import load_dotenv, find_dotenv

load_dotenv(find_dotenv())

SECRET_KEY = os.environ['SECRET_KEY'] 
```

在路径中`find_dotenv()`查找“ *.env* ”文件，因此它也可以保存在同一目录中，

此外，如果`.env`文件使用名称，例如“ *django-config.env* ” `load_dotenv(find_dotenv("django-config.env")`，则将获取并将其加载到主机环境变量映射。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-10-10T18:44:28.987

我很惊讶没有人谈论[django-environ](https://django-environ.readthedocs.io/en/latest/)。我通常会创建一个`.env`这样的文件：

```
SECRET_KEY=blabla
OTHER_SECRET=blabla 
```

该文件应添加到`.gitignore`

您可以签入 git，这是一个示例文件，`.env.example`只是为了让其他人知道他们需要哪个 env var。文件的内容`.env.example`看起来像这样（只是没有任何值的键）

```
SECRET_KEY=
OTHER_SECRETS= 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-06-22T14:20:59.237

## 在哪里存放`SECRET_KEY`DJANGO

> 将您的 django 存储`SECRET_KEY`在环境变量或单独的文件中，而不是直接编码在您的配置模块 settings.py

`settings.py`

```
#from an environment variable
import os

SECRET_KEY = os.environ.get('SECRET_KEY')

#from an file
with open('/etc/secret_key.txt') as f:
    SECRET_KEY = f.read().strip() 
```

## 如何`SECRET_KEY`手动生成 Django：

```
$ python -c "from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())" 
```

`7^t+3on^bca+t7@)w%2pedaf0m&$_gnne#^s4zk3a%4uu5ly86`

```
import string
import secrets

c = string.ascii_letters + string.digits + string.punctuation

secret_key = ''.join(secrets.choice(c) for i in range(67))

print(secret_key) 
```

`df&)ok{ZL^6Up$\y2*">LqHx:D,_f_of#P,~}n&\zs*:y{OTU4CueQNrMz1UH*mhocD`

*确保生产中使用的密钥没有在其他地方使用，并避免将其发送到源代码控制。*

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2021-02-08T21:05:13.167

django 调试输出将暴露存储在环境变量中的密码。~~

# http - ngMock 无法识别请求

> ID：15209979
> 
> 赞同：3
> 
> 时间：2013-03-04T19:54:59.660
> 
> 标签：http, angularjs, coffeescript, jasmine

我在控制器周围有以下规格。我有以下茉莉花规格：

```
 describe 'MyApp.Controller.SomeController', ->
   beforeEach module('mymodule')
   beforeEach inject ($rootScope , $httpBackend, $controller, SomeService) ->
      @scope = $rootScope.$new()
      @httpBackend = $httpBackend
      someService = SomeService
      @someResource = someService.someResource
      $controller 'MyApp.Controller.SomeController', $scope: @scope

   describe "#fetchMethod", ->
     describe "given an object", ->
       beforeEach ->
         @id = 17
         @scope.fetchMethod(@id)
       it "sets due to true", ->
         @httpBackend.whenGET().respond(200, {"someStrings": ["foo", "bar"], otherStrings: ["bar", "goo"]})
         expect(@scope.someStrings).toBeDefined()
         expect(@scope.otherStrings).toBeDefined() 
```

环绕以下控制器：

```
 MyApp.Controller.SomeController = (scope, someService) ->

   scope.fetchMethod = (ID)->
      someService.someResource.fetch
      Id: artID
      ,(response) ->
        scope.someStrings = response['someStrings']
        scope.otherStrings = response['otherStrings']
        scope.someStringsExist = true if scope.someStrings
 MyApp.Controller.SomeController.$inject = ['$scope', 'SomeService'] 
```

其中 SomeService 定义如下：

```
 MyApp.Service.SomeService = (resource) ->
   @someResource = resource '/api/foos/:ID', {},
   fetch:
     method: 'GET'

   @

 MyApp.myModule.service 'SomeService', ['$resource', MyApp.Service.SomeService] 
```

此设置似乎在站点上运行，正确执行请求并从 (rails) api 端点返回值。

但是，当运行 jasmine 规范时，它会失败并显示：

`Error: Unexpected request: GET /api/foos/17 No more request expected in http://localhost:3000/assets/helpers/angular-mocks.js?body=1 (line 889)`

我错过了什么？为什么 httpBackend 无法识别 GET 请求？

scope.initialize = (artifactId, artifactType)-> scope.artifactId = artifactId scope.artifactType = artifactType scope.currentVersionExists = false scope.attachmentFetcher(scope.artifactId)

MyApp.Controller.SomeController.$inject = ['$scope', 'SomeService']

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T20:01:12.240

在发出请求之前，您应该在响应中存根的这一行：

```
@httpBackend.whenGET().respond(200, {"someStrings": ["foo", "bar"], otherStrings: ["bar", "goo"]}) 
```

# php - 在 php 中更新过滤的 mysql 行

> ID：15209986
> 
> 赞同：0
> 
> 时间：2013-03-04T19:55:19.683
> 
> 标签：php, mysql, filtered-lookup

我正在尝试从 mysql 更新它们通过某些记录过滤的不同行。在此代码中，用户首先应输入两个输入：classnumber 和 level。他们拥有此字段的记录将显示在表中，然后用户应该能够更新此记录信息。但问题是所有记录都在 mysql 的一个表中，所以它们的 id 不同我的意思是，例如与两个输入 id 匹配的第一条记录是 2，然后下一个是 5，下一个是 6 和....

在这种情况下，我应该如何更改下面的代码？

```
<form id="searchform" method="post" dir="rtl" action=""> 
 level :<input name="level"  style="margin-top:5px; margin-left:6px;font-family: Tahoma,Geneva,sans-serif; font-size: 12px; margin-top: 5px; padding: 5px; width: 50px;" type="text" id="level" />
 classnumber :<input name="classnum"  style="margin-top:5px; margin-left:6px;font-family: Tahoma,Geneva,sans-serif; font-size: 12px; margin-top: 5px; padding: 5px; width: 50px;" type="text" id="classnum" />
 <input style="margin-top:10px; margin-left:120px; font-size: 14px;  padding: 5px 14px;" type="submit" value="جستجو" name="enter"   />
</form>

<?php
 if(isset($_POST['enter'])){
  $sql="SELECT * FROM  `".$tbl_name."` where classnum='".$_REQUEST['classnum']."' and level='".$_REQUEST['level']."' ";
  $result=mysql_query($sql,$link);
  $count=mysql_num_rows($result);
 }
?>

<div class="cleaner h30"></div>
<br>

 <form name="form1" action="" method="POST">
  <center>
   <div>                                
    <div align="center" width = 615>
    <table class="stats" cellspacing="0" width="615" border="1">
    <tr>
      <th width="20" scope="col" >Id</th>
     <th width="60" scope="col">Name</th>
     <th width="60" scope="col">Last Name</th>
     <th width="42" scope="col">Midterm</th>    
     <th width="54" scope="col">Class mark</th>
     <th width="42" scope="col">Final Quiz</th>
     <th width="54" scope="col">State</th>
     <th width="54" scope="col">Details</th>
    </tr>
                                            <?php
      while($rows=mysql_fetch_array($result)){
      $id[]=$rows['id'];
    ?>
                                        <tr>
      <td align="center">
     <input name="id[]" type="text" id="id" value="<? echo $rows['id']; ?>"  style=" font-family: Tahoma,Geneva,sans-serif; font-size: 12px;  padding: 5px; width: 10px;"></td>
      <td align="center"><input style=" font-family: Tahoma,Geneva,sans-serif; font-size: 12px;  padding: 5px; width: 60px;" type="text" name="name[]" id="name" value= "<? echo $rows['name']; ?>"  /></td>
     <td align="center"><input style=" font-family: Tahoma,Geneva,sans-serif; font-size: 12px;  padding: 5px; width: 60px;" type="text" name="lastname[]" id="lastname" value= "<? echo $rows['lastname']; ?>"  /></td> 
     <td align="center"><input style=" font-family: Tahoma,Geneva,sans-serif; font-size: 12px;  padding: 5px; width: 50px;" type="text" name="midmark[]" id="midmark" /></td>
     <td align="center"><input style=" font-family: Tahoma,Geneva,sans-serif; font-size: 12px;  padding: 5px; width: 50px;" type="text" name="classmark[]" id="classmark" /></td>
     <td align="center"><input style=" font-family: Tahoma,Geneva,sans-serif; font-size: 12px;  padding: 5px; width: 50px;" type="text" name="finalmark[]" id="finalmark" /></td>
     <td align="center"><input style=" font-family: Tahoma,Geneva,sans-serif; font-size: 12px;  padding: 5px; width: 50px;" type="text" name="state[]" id="state" /></td>
     <td align="center"><input style=" font-family: Tahoma,Geneva,sans-serif; font-size: 12px;  padding: 5px; width: 50px;" type="text" name="details[]" id="details"  /></td>
    </tr>

     <?php
                                         }
                                         ?>
                                            </table>
                                        </div>
    </div>
   </center>
   <input style="margin-top:10px; float:right; margin-right:175px; font-size: 14px;  padding: 5px 14px;" type="submit" value="ثبت" name="Submit"   />
  </form>

<?php
 // Check if button name "Submit" is active, do this 
 if(isset($_POST['Submit']))
  {
   for($i=0;$i<$count;$i++)
    {
    $sql1=mysql_query(" UPDATE `".$tbl_name."` SET midmark='".$_REQUEST['midmark'][$i]."' , classmark='".$_REQUEST['classmark'][$i]."' , finalmark='".$_REQUEST['finalmark'][$i]."' , state='".$_REQUEST['state'][$i]."' , details='".$_REQUEST['details'][$i]."'  WHERE id='".$_REQUEST['id'][$i]."' ");                           $result1=mysql_query($sql1);
    }
   }

if($result1){
 header("location:results.php");
  }
  mysql_close();
?> 
```

# r - 在服务器上运行一些 R 代码

> ID：15209989
> 
> 赞同：2
> 
> 时间：2013-03-04T19:55:24.210
> 
> 标签：r, rstudio, rstudio-server

是否可以从服务器上的机器执行一些任意 R 代码？我有一些需要大量内存的代码，我可以选择一些 R 代码并将其发送到具有更多 RAM 的服务器上运行（假设服务器配置正确）。我还要补充一点，我在 Windows 上使用 RStudio Desktop IDE，并在 Ubuntu 服务器上安装了 RStudio Server。

理想情况下，在 RStudio 中，我应该能够选择几行并在服务器上执行这些行并将结果带回我的桌面。（将代码复制到服务器，运行，然后将结果复制回桌面，效率低下且容易出错）

有没有类似的东西存在？

# assembly - 操作码 FF350E204000 是做什么的？

> ID：15209993
> 
> 赞同：4
> 
> 时间：2013-03-04T19:55:40.583
> 
> 标签：assembly, x86, opcode

我有 32 位操作码：`FF 35 0E 20 40 00`. 有没有人知道一个很好的操作码表来回答这个问题？（我知道我可以使用反汇编程序，但我想知道如何使用操作码表来确定这一点）。我找到[了这个](http://ref.x86asm.net/coder.html)网页，但有 7 种不同的解决方案`FF`。我不明白。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-04T21:01:43.240

你找错地方了。您应该在 Intel 或 AMD 的官方文档中查看。

`Appendix A Opcode Map`of `Vol 2B`of`Intel® 64 and IA-32 Architectures Software Developer’s Manual Combined Volumes: 1, 2A, 2B, 3A and 3B`说那`FF`是`INC/DEC Grp5`^(`1A`)。

`Table A-6 Opcode Extensions for One- and Two-byte Opcodes by Group Number`of`Vol 2B`表示`FF`/ , , , , , ,`Group 5`中的任何一个，取决于字节的第 5 位到第 3 位，即后面的字节。(0x35>>3)&7=6 或二进制的 110。所以，这是.`INC``DEC``CALLN``CALLF``JMPN``JMPF``PUSH``ModR/M``PUSH Ev`

`Chapter 2 Instruction Format`of`Vol 2A`解释指令由哪些部分组成，包括那些`ModR/M`字节和不包括哪些部分。

`Appendix A Using Opcode Tables`of`Vol 2B`告诉你`E`：

> ModR/M 字节跟随操作码并指定操作数。操作数要么是通用寄存器，要么是内存地址。如果它是一个内存地址，则该地址是根据段寄存器和以下任何值计算得出的：基址寄存器、索引寄存器、比例因子、位移。

它还告诉您`v`：

> 字、双字或四字（在 64 位模式下），取决于操作数大小属性。

因此，您知道这`Ev`意味着寄存器或内存操作数，并且由于这是针对 32 位代码并且没有指令前缀，因此操作数大小为 32 位。因此，`Ev`内存中的 32 位寄存器或 32 位变量。

现在你需要找出从 ModR/M 到结尾的其余字节。

看看。`Figure 2-1\. Intel 64 and IA-32 Architectures Instruction Format`_ `Vol 2A`它告诉你在`ModR/M`=0x35 中：

`Mod`= 00（二进制）
`Reg`= 110（二进制；我们之前已经提取了这 3 位）
`R/M`= 101（二进制）

`Table 2-2\. 32-Bit Addressing Forms with the ModR/M Byte`of`Vol 2A`告诉你`Mod`= 00 和`R/M`= 101 意味着`disp32`，IOW，指令中有一个由 32 位位移组成的内存操作数。

该字节的`Reg`字段`ModR/M`已用于选择七条指令之一，因此该字段不编码寄存器操作数。

所以，你的指令是`PUSH DWORD [0x0040200E]`。

这与我的反汇编程序输出一致。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-03-04T20:53:10.867

让我们尝试一次一个字节地遍历这个字节序列。

1.  第一个字节是`FF`. 在英特尔指令集参考中的操作码映射中查找它告诉我们这是一条`INC`或一条`DEC`指令，以及神秘的“Grp 5 - 1A”。1A 表示“ModR/M 字节的第 5、4 和 3 位用作操作码扩展”。ModR/M 字节是对用于该指令的操作数的源和地址进行编码的字节。在这种情况下，这三位用于扩展操作码。
2.  下一个字节是`35`. 这是 ModR/M 字节，通常出现在操作码本身之后，在使用它的指令中。`35`（十六进制）是`00110101`二进制的，所以位 5、4 和 3 是`110`. 在操作码扩展表（表 A-6）中查找它，我们可以看到这意味着这是一条`PUSH d64 Ev`指令。脚注的`d64`意思是“在 64 位模式下，指令默认为 64 位操作数大小，不能编码 32 位操作数大小。”。这是预期的`PUSH`指令。`Ev`是指定操作数编码的符号 - 最重要的是，它表明 ModR/M 字节跟在操作码本身之后。这`v`另一方面，表示操作数的大小取决于操作数大小属性。我们已经有了 ModR/M 字节，所以让我们对其进行解码（表 2-2，假设这段代码运行在 32 位模式下）：有效地址由 a 指定`disp32`，这意味着应该跟随 32 位位移ModR/M 字节。指定寄存器的部分说`ESI`应该使用，但在这种情况下，此字段用于操作码扩展，因此它不用于表示寄存器源操作数。
3.  接下来的四个字节是 32 位位移。`0E 20 40 00`，当解码为小端时，表示`0x40200e`。这是将用于该指令的操作数的地址。

综上所述，我们得到了，`FF 35 0E 20 40 00`即`PUSH DWORD [0x40200e]`它将从地址读取的 32 位值压入`0x40200e`堆栈。

# ruby - 自定义类实例化其超类对象

> ID：15209997
> 
> 赞同：1
> 
> 时间：2013-03-04T19:55:53.110
> 
> 标签：ruby, inheritance, matrix

我正在研究一个继承自的 Grid 类`Matrix`：

```
class Grid < Matrix
  def self.[](x,y=x)
    if x.is_a? String
      ary = x.lines.map { |l| l.strip.split('|') }.map.with_index do |col,x|
        col.map.with_index { |cell,y| ::Cell.new x: x, y: y, alive: !!(cell =~ /O/i) }
      end
      super *ary
    else
      super *Array.new(y) { [::Cell.new(x: x, y: y, alive: [true,false].sample)] * x }
    end
  end
end 
```

我似乎无法覆盖`::initialize`，因为它是私人的。以上工作但产生`Matrix`类的实例而不是我的自定义类，所以我被卡住了。意识到我的班级在调用`to_s`和接收`"Matrix[[X,O],[O,O]]"`东西时没有实例化。我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T20:20:45.790

ruby中没有`::new`方法，您可以通过以下方式定义它`#initialize`

当您调用 super 时，它会`Matrix::[]`使用提供的参数进行调用。

查看[源代码](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/matrix/rdoc/Matrix.html#method-c-5B-5D)：

```
def Matrix.[](*rows)
  Matrix.rows(rows, false)
end 
```

您可以尝试`Grid::rows`用您的逻辑进行定义。或者只是覆盖`#initialize`

* * *

顺便说一句，这写得不好，他们应该这样做`rows(rows,false)`（没有矩阵）来防止这个问题。

# ios - iOS 6 将群组添加到联系人应用程序

> ID：15209998
> 
> 赞同：1
> 
> 时间：2013-03-04T19:55:54.833
> 
> 标签：ios, objective-c, addressbook

我想在本机联系人应用程序中提供一个组，但所有组查询都不起作用。我可以成功地将联系人添加到通讯录，但我想为我的应用创建自己的单独组。类似于 Facebook 添加自己的群组。

编辑：看起来这些组已添加到默认帐户中......有没有办法提供单独的提供者？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T21:31:58.580

```
//Create new group like so:    
ABAddressBookRef ab = ABAddressBookCreate();
CFErrorRef error;
ABRecordRef group = ABGroupCreate();
ABRecordSetValue(group, kABGroupNameProperty,@"new group", &error);
ABAddressBookAddRecord(ab, group, &error);
ABAddressBookSave(ab, &error);

//Create new person and save to this group
ABRecordRef record = ABPersonCreate();
BOOL isSuccess ;

isSuccess  = ABRecordSetValue(record, kABPersonNicknameProperty,@"GroupMember nick name", &error);
isSuccess = ABRecordSetValue(record, kABPersonMiddleNameProperty, @"Middle name", &error);

ABMutableMultiValueRef copyOfPhones = ABMultiValueCreateMutable(kABPersonPhoneProperty);

CFTypeRef phone= CFSTR("123000222111");

ABMultiValueAddValueAndLabel(copyOfPhones, phone,kABPersonPhoneMobileLabel,NULL);

isSuccess = ABRecordSetValue(record, kABPersonPhoneProperty, copyOfPhones, &error);

isSuccess = ABAddressBookAddRecord(ab, record, &error);
isSuccess = ABAddressBookSave(ab, &error);

ABGroupAddMember(group, record, &error);

NSLog(@"is success %d", isSuccess);

ABAddressBookSave(ab, &error);
CFRelease(group); 
```