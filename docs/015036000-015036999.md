# StackOverflow 问答 15036000-15036999

# php - 使用 PHP - 用于 MMORPG 的 MySQL

> ID：15036004
> 
> 赞同：0
> 
> 时间：2013-02-23T01:33:50.867
> 
> 标签：php, javascript, mysql, flash

如果我要使用 PHP 命令将视频游戏数据从 Flash 存储到 MySQL 数据库，这些命令是通过访问我网站上 iFrame 中的任意网页而加载的，并且我触发通过 javascript 从 Flash 加载这些页面，这会开始减慢我的 MMORPG 的实时使用速度（滞后）是否比仅使用传统游戏服务器？对于我可以继续使用我已经知道的语言进行编码或者我应该设置服务器并为此学习一些 SDK 语言的程度而言，差异是否微不足道？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:04:26.030

通过 IFRAME 为 Flash 加载/保存数据是一种非常迂回的做事方式。ActionScript 可以直接发出 HTTP 请求。根据您使用的 ActionScript 版本：

1.  [http://help.adobe.com/en_US/AS2LCR/Flash_10.0/help.html?content=00000575.html](http://help.adobe.com/en_US/AS2LCR/Flash_10.0/help.html?content=00000575.html)

2.  [http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/2/help.html?content=00003121.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/2/help.html?content=00003121.html)

3.  [http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/URLRequest.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/URLRequest.html)

# ios - 如何从reverseGeocodeCoordinate获取国家、州、城市？

> ID：15036007
> 
> 赞同：24
> 
> 时间：2013-02-23T01:33:54.697
> 
> 标签：ios, google-maps-sdk-ios, reverse-geocoding

`GMSReverseGeocodeResponse`包含

```
- (GMSReverseGeocodeResult *)firstResult; 
```

其定义如下：

```
@interface GMSReverseGeocodeResult : NSObject<NSCopying>

/** Returns the first line of the address. */
- (NSString *)addressLine1;

/** Returns the second line of the address. */
- (NSString *)addressLine2;

@end 
```

有没有办法从这两个字符串（对*所有国家*和*所有地址都*有效）中获取国家、ISO 国家代码、州（administrative_area_1 或相应的）？

注意：我试图执行这段代码

```
[[GMSGeocoder geocoder] reverseGeocodeCoordinate:CLLocationCoordinate2DMake(40.4375, -3.6818) completionHandler:^(GMSReverseGeocodeResponse *resp, NSError *error)
 {
    NSLog( @"Error is %@", error) ;
    NSLog( @"%@" , resp.firstResult.addressLine1 ) ;
    NSLog( @"%@" , resp.firstResult.addressLine2 ) ;
 } ] ; 
```

但是由于某种原因，从未调用过处理程序。我确实添加了应用程序密钥，并将 iOS 捆绑包 ID 添加到了应用程序密钥。控制台中不会打印任何错误。我的意思是我不知道这些行的内容。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2014-02-17T02:05:40.220

最简单的方法是**升级到**[iOS 版 Google Maps SDK](https://developers.google.com/maps/documentation/ios/) 1.7版（2014 年 2 月发布）。
从[发行说明](https://developers.google.com/maps/documentation/ios/releases#version_17_-_february_2014)：

> `GMSGeocoder`现在通过 提供结构化地址`GMSAddress`，弃用`GMSReverseGeocodeResult`.

从[`GMSAddress`类参考](https://developers.google.com/maps/documentation/ios/reference/interface_g_m_s_address)中，您可以找到[以下属性](https://developers.google.com/maps/documentation/ios/reference/interface_g_m_s_address#properties)：

> **`coordinate`**
> 位置，或者`kLocationCoordinate2DInvalid`如果未知。
> 
> **`thoroughfare`**
> 街道号码和名称。
> 
> **`locality`**
> 地区或城市。
> 
> **`subLocality`**
> 地方、地区或公园的细分。
> 
> **`administrativeArea`**
> 地区/州/行政区域。
> 
> **`postalCode`**
> 邮政编码。
> 
> **`country`**
> 国家名称。
> 
> **`lines`**
> `NSString`包含地址的格式化行的 数组。

虽然没有 ISO 国家代码。
另请注意，某些属性可能会返回`nil`.

这是一个完整的例子：

```
[[GMSGeocoder geocoder] reverseGeocodeCoordinate:CLLocationCoordinate2DMake(40.4375, -3.6818) completionHandler:^(GMSReverseGeocodeResponse* response, NSError* error) {
    NSLog(@"reverse geocoding results:");
    for(GMSAddress* addressObj in [response results])
    {
        NSLog(@"coordinate.latitude=%f", addressObj.coordinate.latitude);
        NSLog(@"coordinate.longitude=%f", addressObj.coordinate.longitude);
        NSLog(@"thoroughfare=%@", addressObj.thoroughfare);
        NSLog(@"locality=%@", addressObj.locality);
        NSLog(@"subLocality=%@", addressObj.subLocality);
        NSLog(@"administrativeArea=%@", addressObj.administrativeArea);
        NSLog(@"postalCode=%@", addressObj.postalCode);
        NSLog(@"country=%@", addressObj.country);
        NSLog(@"lines=%@", addressObj.lines);
    }
}]; 
```

及其输出：

```
coordinate.latitude=40.437500
coordinate.longitude=-3.681800
thoroughfare=(null)
locality=(null)
subLocality=(null)
administrativeArea=Community of Madrid
postalCode=(null)
country=Spain
lines=(
    "",
    "Community of Madrid, Spain"
) 
```

* * *

或者，您可以考虑在[Google 地理编码 API](https://developers.google.com/maps/documentation/geocoding/)（[示例](https://developers.google.com/maps/documentation/geocoding/#reverse-example)）中使用[反向地理编码。](https://developers.google.com/maps/documentation/geocoding/#ReverseGeocoding)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2015-04-15T06:04:35.657

**用Swift**回答

 **使用 Google Maps iOS SDK（当前使用 V1.9.2 您无法指定返回结果的语言）：

```
@IBAction func googleMapsiOSSDKReverseGeocoding(sender: UIButton) {
    let aGMSGeocoder: GMSGeocoder = GMSGeocoder()
    aGMSGeocoder.reverseGeocodeCoordinate(CLLocationCoordinate2DMake(self.latitude, self.longitude)) {
        (let gmsReverseGeocodeResponse: GMSReverseGeocodeResponse!, let error: NSError!) -> Void in

        let gmsAddress: GMSAddress = gmsReverseGeocodeResponse.firstResult()
        print("\ncoordinate.latitude=\(gmsAddress.coordinate.latitude)")
        print("coordinate.longitude=\(gmsAddress.coordinate.longitude)")
        print("thoroughfare=\(gmsAddress.thoroughfare)")
        print("locality=\(gmsAddress.locality)")
        print("subLocality=\(gmsAddress.subLocality)")
        print("administrativeArea=\(gmsAddress.administrativeArea)")
        print("postalCode=\(gmsAddress.postalCode)")
        print("country=\(gmsAddress.country)")
        print("lines=\(gmsAddress.lines)")
    }
} 
```

使用 Google Reverse Geocoding API V3（目前您可以[指定](https://developers.google.com/maps/documentation/geocoding/#ReverseGeocoding)返回结果的语言）：

```
@IBAction func googleMapsWebServiceGeocodingAPI(sender: UIButton) {
    self.callGoogleReverseGeocodingWebservice(self.currentUserLocation())
}

// #1 - Get the current user's location (latitude, longitude).
private func currentUserLocation() -> CLLocationCoordinate2D {
    // returns current user's location. 
}

// #2 - Call Google Reverse Geocoding Web Service using AFNetworking.
private func callGoogleReverseGeocodingWebservice(let userLocation: CLLocationCoordinate2D) {
    let url = "https://maps.googleapis.com/maps/api/geocode/json?latlng=\(userLocation.latitude),\(userLocation.longitude)&key=\(self.googleMapsiOSAPIKey)&language=\(self.googleReverseGeocodingWebserviceOutputLanguageCode)&result_type=country"

    AFHTTPRequestOperationManager().GET(
        url,
        parameters: nil,
        success: { (operation: AFHTTPRequestOperation!, responseObject: AnyObject!) in
            println("GET user's country request succeeded !!!\n")

            // The goal here was only for me to get the user's iso country code + 
            // the user's Country in english language.
            if let responseObject: AnyObject = responseObject {
                println("responseObject:\n\n\(responseObject)\n\n")
                let rootDictionary = responseObject as! NSDictionary
                if let results = rootDictionary["results"] as? NSArray {
                    if let firstResult = results[0] as? NSDictionary {
                        if let addressComponents = firstResult["address_components"] as? NSArray {
                            if let firstAddressComponent = addressComponents[0] as? NSDictionary {
                                if let longName = firstAddressComponent["long_name"] as? String {
                                    println("long_name: \(longName)")
                                }
                                if let shortName = firstAddressComponent["short_name"] as? String {
                                    println("short_name: \(shortName)")
                                }
                            }
                        }
                    }
                }
            }
        },
        failure: { (operation: AFHTTPRequestOperation!, error: NSError!) in
            println("Error GET user's country request: \(error.localizedDescription)\n")
            println("Error GET user's country request: \(operation.responseString)\n")
        }
    )

} 
```

我希望这个代码片段和解释能对未来的读者有所帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-11-23T01:23:26.873

美国地址的 Swift 5 版本：

```
import Foundation
import GoogleMaps

extension GMSAddress {

    var formattedAddress: String {
        let addressComponents = [
            thoroughfare,        // One Infinite Loop
            locality,            // Cupertino
            administrativeArea,  // California
            postalCode           // 95014
        ]
        return addressComponents
            .compactMap { $0 }
            .joined(separator: ", ")
    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-24T06:09:11.483

在 swift 4.0 中，函数获取 CLLocation 并返回邮政地址

```
 func geocodeCoordinates(location : CLLocation)->String{
         var postalAddress  = ""
        let geocoder = GMSGeocoder()
        geocoder.reverseGeocodeCoordinate(location.coordinate, completionHandler: {response,error in
            if let gmsAddress = response!.firstResult(){
                for line in  gmsAddress.lines! {
                    postalAddress += line + " "
                }
               return postalAddress
            }
        })
        return ""
    } 
```**

# python - 假设我有三个加权选择：我如何随机选择一个？

> ID：15036009
> 
> 赞同：2
> 
> 时间：2013-02-23T01:34:05.323
> 
> 标签：python, random, probability

例如，我有这三个选项：

```
 Option 1
 Option 2
 Option 3 
```

我想随机选择其中一个，但有一定的概率偏差。例如：

```
 Option 1: 30% chance
 Option 2: 50% chance
 Option 3: 20% chance 
```

那么在保留它们在 python 中发生的概率的同时随机选择一个的最佳方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-23T01:42:18.420

效率不高，但很容易：

```
random.choice([1]*30 + [2]*50 + [3]*20) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-23T01:41:41.443

这有效：

```
import random

def weighted_choice(weights):
    choice = random.random() * sum(weights)
    for i, w in enumerate(weights):
        choice -= w
        if choice < 0:
            return i

weighted_choice([.3, .5, .2])   # returns 0,1,2 in proportion to the weight 
```

要测试它：

```
import collections
c = collections.Counter()
n = 1000000
for i in range(n):
    c[weighted_choice([.3, .5, .2])] += 1

for k, v in c.items():
    print '{}: {:.2%}'.format(k,float(v)/n) 
```

印刷：

```
0: 30.11%
1: 50.08%
2: 19.81% 
```

除了相当快之外，优点是 1) 列表元素不需要加起来 1 或 100，2) 更多选择，只需向列表中添加更多元素：

```
for i in range(n):
   c[weighted_choice([.3,.35,.1,.1,.15,.4])]+=1 
```

印刷：

```
0: 21.61%
1: 25.18%
2: 7.22%
3: 7.03%
4: 10.57%
5: 28.38% 
```

（根据接受的答案计时，它快了大约 2 倍......）

# c++ - 连接trie路径的字符串记录

> ID：15036011
> 
> 赞同：0
> 
> 时间：2013-02-23T01:34:28.110
> 
> 标签：c++, trie

我想连接结构通过特里树的路径记录-仅在使用不匹配路径时记录，这是我的特里树搜索功能：

```
void Trie::suggestCorrectionsHelper(nodeT *w, int index, string record, string final, double edits, Trie::MatchesT &matchSet, string gap_record, int level)
{   
    if (record.empty() || w == NULL ) {//tried everyChar
        matchSet.candidate = final+record;
        if ( matchSet.candidate.length() == record_delimiterFormat.size() ) { //check length and record exists
            updateSet(w, matchSet, edits,  gap_record );
        }
    } else {//look for end of node paths
        if(index == w->alpha.size() ) { return; //no more paths here
        } else {            
            //CASE A: self
            if (record[0] == w->alpha[index].token_char ) {//replace char with self so no edit distance
                suggestCorrectionsHelper(w->alpha[index].next, 0, record.substr(1), final+w->alpha[index].token_char, edits, matchSet, gap_record, level+1); //follow char, no edit

            //CASE B: follow new path
            } else {
                //CASE B1: wilds
                if (record[0] == '*' && (final.length() + record.length() ) != record_delimiterFormat.size() ) { 
                    suggestCorrectionsHelper(w->alpha[index].next, 0, '*'+record.substr(1), final+w->alpha[index].token_char, edits+1, matchSet, gap_record+=(IntegerToString(level)+","), level+1); //wilds, keep adding chars

                //CASE B2: no wilds
                } else {
                    suggestCorrectionsHelper(w->alpha[index].next, 0, record.substr(1), final+w->alpha[index].token_char, edits+1, matchSet, gap_record+=(IntegerToString(level)+","), level+1);//follow path
                }
            }
            //CASE C: try next path - place outside else to allow finding alternative char even when self path is valid
            suggestCorrectionsHelper(w, index+1, record, final, edits, matchSet, gap_record, level);//increment and check next path
        }
    }
} 
```

路径完成后，将添加到：

```
//write to struct and then adds to struct vector 
void Trie::updateSet(nodeT *w, Trie::MatchesT & matchSet, double &edits, string gap_record)
{   
    CorrectionT cs; // struct with attributes of match n
    cs.suggestedRecord = matchSet.candidate; // add attributes to struct
    cs.editDistance = edits;
    cs.gap = gap_record;
    matchSet.candidateStack.push_back(cs);
} 
```

我期待一个输出看起来像`0,1,3,5,12`

但我明白了`0,0,0,0,0,0,2,2,2,3,3,4,12`

它不能超过一个级别，所以通过递归我正在记录路径，我想单独记录每条路径；如何？

trie 类如下所示：

```
void Trie::AddFirstNode(){ // run-once, initial condition of first node
    nodeT *tempNode = new nodeT;
    root = tempNode;
}

void Trie::InsertNode(nodeT *w, ParseT & packet, string codeSoFar) // add new char
{
    for (unsigned int i = 0; i <= w->alpha.size(); i++) { // loop and insert tokens in sorted vector
        if (i == w->alpha.size() || codeSoFar[0] < w->alpha[i].token_char) { //position 

            //create new TokenT
            tokenT *tempChar = new tokenT;
            tempChar->next = NULL;
            tempChar->token_char = codeSoFar[0];

            nodeT *tempLeaf = new nodeT; //create new nodeT
            tempChar->next = tempLeaf; //link TokenT with its nodeT

            AddRecord(tempLeaf, packet, codeSoFar.substr(1)); //add next char in record, if last char AddRecord will terminate

            w->alpha.insert(w->alpha.begin()+i, *tempChar);
            return; 
        }
    }
}

//function to add record to trie
void Trie::AddRecord(nodeT *w, ParseT & packet, string codeSoFar)
{
    if (codeSoFar.empty() ) {   //condition 0: record's last char
        return;

    } else { //keep parsing down record path
        for (unsigned int i = 0; i < w->alpha.size(); i++) {    
            if (codeSoFar[0] == w->alpha[i].token_char) {
                return AddRecord(w->alpha[i].next, packet, codeSoFar.substr(1)); // condition 2: char exists
            }
        }
        InsertNode(w, packet, codeSoFar); //condition 3: no existing char
    }
} 
```

结构

```
struct MatchesT {
    string candidate;

    double testDistance; //try edit distance

    list<CorrectionT> candidateStack; //
}; 
```

输出

```
void PrintCorrections(Trie & tri, Trie::MatchesT & matchSet, ofstream& myfile)
{
while (!matchSet.candidateStack.empty() ) {
count++;
Trie::CorrectionT corr = matchSet.candidateStack.back();
matchSet.candidateStack.pop_back();

myfile << corr.suggestedRecord << ","  << fixed << setprecision(2) << corr.editDistance << "," << corr.gap << "\n";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T14:21:06.083

我找到了一个更好的解决方案，而不是将连接添加为 += 然后作为参数传递，只需将参数作为 gap_record+ 传递；当前节点内存被保留，路径上的下一个节点具有连接。

```
void Trie::suggestCorrectionsHelper(nodeT *w, int index, string record, string final, double edits, Trie::MatchesT &matchSet, string gap_record, int level)
{   
    if (record.empty() || w == NULL ) {//tried everyChar
        matchSet.candidate = final+record;
        if ( matchSet.candidate.length() == record_delimiterFormat.size() ) { //check length and record exists
            updateSet(w, matchSet, edits,  gap_record );
        }
    } else {//look for end of node paths
        if(index == w->alpha.size() ) { return; //no more paths here
        } else {            
            //CASE A: self
            if (record[0] == w->alpha[index].token_char ) {//replace char with self so no edit distance
                suggestCorrectionsHelper(w->alpha[index].next, 0, record.substr(1), final+w->alpha[index].token_char, edits, matchSet, gap_record, level+1); //follow char, no edit

            //CASE B: follow new path
            } else {
                //CASE B1: wilds
                if (record[0] == '*' && (final.length() + record.length() ) != record_delimiterFormat.size() ) { 
                    suggestCorrectionsHelper(w->alpha[index].next, 0, '*'+record.substr(1), final+w->alpha[index].token_char, edits+1, matchSet, gap_record+(IntegerToString(level)+","), level+1); //wilds, keep adding chars

                //CASE B2: no wilds
                } else {
                    suggestCorrectionsHelper(w->alpha[index].next, 0, record.substr(1), final+w->alpha[index].token_char, edits+1, matchSet, gap_record+(IntegerToString(level)+","), level+1);//follow path
                }
            }
            //CASE C: try next path - place outside else to allow finding alternative char even when self path is valid
            suggestCorrectionsHelper(w, index+1, record, final, edits, matchSet, gap_record, level);//increment and check next path
        }
    }
} 
```

# ruby-on-rails - 尝试部署到 heroku 并切换 sqlite -> pg- rake 时出错：db

> ID：15036012
> 
> 赞同：0
> 
> 时间：2013-02-23T01:34:31.957
> 
> 标签：ruby-on-rails, postgresql, heroku, sqlite, web-deployment

因此，我正在尝试将在 SQLite3 上本地运行良好的应用程序更改为 Postgresql，以便可以将其部署到 Heroku。我查看了各种帖子和教程，并对我的 Gem 文件和 database.yml 文件进行了调整，但是当我尝试 rake:db migrate 时，我收到错误消息：“请安装 postgresql 适配器。” 我知道大多数用户在他们的 gemfile 中不包含 gem 'pg' 时都会遇到这种情况，但我确实包含了它。

这是我收到的完整错误消息：http: [//dpaste.com/hold/972379/](http://dpaste.com/hold/972379/)

你能帮忙吗？我真的看了几十个帖子，并尝试了每一个配置。

我的 procfile 看起来像这样：

```
web: bundle exec thin start -p $PORT 
```

我的 database.yml 看起来像这样：

```
development:
  adapter: postgresql
  encoding: utf8
  database: project_development
  pool: 5
  username: 
  password:

test: &TEST
  adapter: postgresql
  encoding: utf8
  database: project_test
  pool: 5
  username: 
  password:

production:
  adapter: postgresql
  encoding: utf8
  database: project_production
  pool: 5
  username: 
  password: 
```

我的 gemfile 看起来像这样：

```
source 'https://rubygems.org'

gem 'rails', '3.2.11'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'

gem 'thin'
group :production do
gem 'pg'
end
group :development, :test do
gem 'sqlite3'
end

# Gems used only for assets and not required
# in production environments by default. 
```

宝石'jquery-rails'

```
# To use ActiveModel has_secure_password
# gem 'bcrypt-ruby', '~> 3.0.0'

# To use Jbuilder templates for JSON
# gem 'jbuilder'

# Use unicorn as the app server
# gem 'unicorn'

# Deploy with Capistrano
# gem 'capistrano'

# To use debugger
# gem 'debugger' 
```

注意：当我运行 bundle install 时，没有出现“使用 pg”，但我认为这是因为它不在生产中......仅供参考，以防万一它很重要

编辑： gem pg 在使用 heroku 生产时似乎运行良好。不知道发生了什么，因为一旦部署，它就不起作用了。这是我的heroku日志（我已经取出了我的电子邮件）：

```
2013-02-23T05:37:08+00:00 heroku[api]: Enable Logplex by XXXX@email.com
2013-02-23T05:37:08+00:00 heroku[api]: Release v2 created by XXXX@email.com
2013-02-23T05:37:18+00:00 heroku[slugc]: Slug compilation started
2013-02-23T05:38:28+00:00 heroku[api]: Scale to web=1 by XXXX@email.com
2013-02-23T05:38:28+00:00 heroku[api]: Attach HEROKU_POSTGRESQL_WHITE resource by XXXX@email.com
2013-02-23T05:38:28+00:00 heroku[api]: Release v3 created by XXXX@email.com
2013-02-23T05:38:29+00:00 heroku[api]: Add DATABASE_URL config by XXXX@email.com
2013-02-23T05:38:29+00:00 heroku[api]: Release v4 created by XXXX@email.com
2013-02-23T05:38:29+00:00 heroku[api]: Add  config by XXXX@email.com
2013-02-23T05:38:29+00:00 heroku[api]: Release v5 created by XXXX@email.com
2013-02-23T05:38:29+00:00 heroku[api]: Release v6 created by XXXX@email.com
2013-02-23T05:38:29+00:00 heroku[api]: Deploy cd00730 by XXXX@email.com
2013-02-23T05:38:30+00:00 heroku[slugc]: Slug compilation finished
2013-02-23T05:38:30+00:00 heroku[web.1]: Starting process with command `bundle exec thin start -p 55861`
2013-02-23T05:38:31+00:00 heroku[web.1]: Starting process with command `bundle exec thin start -p 55416`
2013-02-23T05:38:31+00:00 app[web.1]: bash: bundle: command not found
2013-02-23T05:38:32+00:00 heroku[web.1]: Process exited with status 127
2013-02-23T05:38:34+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
2013-02-23T05:38:34+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
2013-02-23T05:38:34+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
2013-02-23T05:38:37+00:00 app[web.1]: >> Using rack adapter
2013-02-23T05:38:37+00:00 app[web.1]: Connecting to database specified by DATABASE_URL
2013-02-23T05:38:37+00:00 app[web.1]: >> Maximum connections set to 1024
2013-02-23T05:38:37+00:00 app[web.1]: >> Thin web server (v1.5.0 codename Knife)
2013-02-23T05:38:37+00:00 app[web.1]: >> Listening on 0.0.0.0:55416, CTRL+C to stop
2013-02-23T05:38:38+00:00 heroku[web.1]: State changed from starting to up
2013-02-23T05:39:00+00:00 heroku[api]: Starting process with command `bundle exec rake db:migrate` by ray.lee@dartmouth.edu
2013-02-23T05:39:02+00:00 heroku[run.3422]: Awaiting client
2013-02-23T05:39:02+00:00 heroku[run.3422]: Starting process with command `bundle exec rake db:migrate`
2013-02-23T05:39:02+00:00 heroku[run.3422]: State changed from starting to up
2013-02-23T05:39:07+00:00 heroku[run.3422]: Client connection closed. Sending SIGHUP to all processes
2013-02-23T05:39:08+00:00 heroku[run.3422]: Process exited with status 0
2013-02-23T05:39:08+00:00 heroku[run.3422]: State changed from up to complete
2013-02-23T05:39:14+00:00 app[web.1]: Started GET "/" for 67.80.190.0 at 2013-02-23 05:39:14 +0000
2013-02-23T05:39:15+00:00 app[web.1]: Processing by LooksController#index as HTML
2013-02-23T05:39:15+00:00 app[web.1]:   Rendered looks/index.html.erb within layouts/application (7.7ms)
2013-02-23T05:39:16+00:00 heroku[router]: at=info method=GET path=/ host=quiet-everglades-5513.herokuapp.com fwd="67.80.190.0" dyno=web.1 queue=0 wait=1ms connect=2ms service=1385ms status=500 bytes=643
2013-02-23T05:39:16+00:00 heroku[router]: at=info method=GET path=/favicon.ico host=quiet-everglades-5513.herokuapp.com fwd="67.80.190.0" dyno=web.1 queue=0 wait=0ms connect=1ms service=7ms status=200 bytes=0
2013-02-23T05:39:16+00:00 app[web.1]: 
2013-02-23T05:39:16+00:00 app[web.1]:     5:   <%= stylesheet_link_tag    "application", :media => "all" %>
2013-02-23T05:39:16+00:00 app[web.1]:     8: </head>
2013-02-23T05:39:16+00:00 app[web.1]: Completed 500 Internal Server Error in 925ms
2013-02-23T05:39:16+00:00 app[web.1]:   app/controllers/looks_controller.rb:7:in `index'
2013-02-23T05:39:16+00:00 app[web.1]:     3: <head>
2013-02-23T05:39:16+00:00 app[web.1]: ActionView::Template::Error (no such file to load -- uglifier
2013-02-23T05:39:16+00:00 app[web.1]:   (in /app/app/assets/javascripts/application.js)):
2013-02-23T05:39:16+00:00 app[web.1]:   app/views/layouts/application.html.erb:6:in `_app_views_layouts_application_html_erb___1708027661978307033_32644180'
2013-02-23T05:39:16+00:00 app[web.1]: 
2013-02-23T05:39:16+00:00 app[web.1]:     6:   <%= javascript_include_tag "application" %>
2013-02-23T05:39:16+00:00 app[web.1]: 
2013-02-23T05:39:16+00:00 app[web.1]:     7:   <%= csrf_meta_tags %>
2013-02-23T05:39:16+00:00 app[web.1]:     9: <body>
2013-02-23T05:39:16+00:00 app[web.1]:     4:   <title>Scout</title> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T08:25:51.037

您提供的日志文件提到了另一个错误

```
ActionView::Template::Error (no such file to load -- uglifier
  (in /app/app/assets/javascripts/application.js)):
app/views/layouts/application.html.erb:6:in `_app_views_layouts_application_html_erb___1708027661978307033_32644180' 
```

`uglifier`是用于预编译资产和优化资产的 gem。在我的应用程序中`assets`，默认情况下它在组中，这意味着它在生产中不可用。

我对 Heroku 并不完全熟悉，但他们有一些关于[使用资产管道](https://devcenter.heroku.com/articles/rails3x-asset-pipeline-cedar)的信息可能会有所帮助。您还应该确保您在[Heroku “Cedar” 堆栈](https://devcenter.heroku.com/articles/stack)上。

或者，如果您不使用资产管道，[请将其禁用](http://guides.rubyonrails.org/asset_pipeline.html#what-is-the-asset-pipeline)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T02:14:33.493

这是您需要做的：

1.  从此处下载适用于您的 mac os 版本的命令行工具[https://developer.apple.com/downloads/index.action](https://developer.apple.com/downloads/index.action)

2.  安装您下载的命令行工具

3.  重启终端

4.  再次运行 bundle install （使用默认组中的 pg gem）。

这应该可以消除您在安装 pg.xml 时遇到的错误。安装后再次运行`rake db:migrate`，它应该可以工作。

# visual-studio-2010 - 在 Visual Studio 命令提示符上设置入口点

> ID：15036016
> 
> 赞同：1
> 
> 时间：2013-02-23T01:35:12.120
> 
> 标签：visual-studio-2010, command-line, sdl

我正在尝试使用 SDL 和 OpenGL 编译一个简单的 c++ 程序。问题是我不想使用 VS 普通项目来做到这一点。我想使用 VS 命令提示符编译它。我正在使用以下命令行：

```
 C:\Users\USER\Desktop\Program> cl /EHsc /MDd main.cpp 
```

它给出了以下错误：

```
 Microsoft (R) 32-bit C/C++ Optimizing Compiler Version 16
    Copyright (C) Microsoft Corporation.  All rights reserved

    main.cpp
    Microsoft (R) Incremental Linker Version 10.00.40219.01
    Copyright (C) Microsoft Corporation.  All rights reserved

    /out:main.exe
    main.obj
    LINK : fatal error LNK1561: entry point must be defined
    C:\Users\USER\Desktop\Program> 
```

我知道该错误仅在包含 SDL.h 时才会出现，但它对您没有帮助...那么，更改入口点的代码是什么以及整个编译命令行的外观如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T14:32:05.617

您需要告诉编译器头文件`/I`所在的位置以及之后安装库的位置`/link`。

我将库提取到一个名为`SDL-1.2.15`. 然后复制`SDL.dll`到与我的文件相同的文件夹中`.cpp`。

## 构建.cmd

```
cl ^
  /EHsc^
  /MDd^
  /ISDL-1.2.15/include^
  main.cpp^
  /link^
  SDL-1.2.15/lib/x86/SDL.lib^
  SDL-1.2.15/lib/x86/SDLmain.lib^
  /SUBSYSTEM:WINDOWS^
  /NODEFAULTLIB:msvcrt.lib 
```

我使用以下页面作为指南： http: [//lazyfoo.net/SDL_tutorials/lesson01/windows/msvsnet2010e/index.php](http://lazyfoo.net/SDL_tutorials/lesson01/windows/msvsnet2010e/index.php)

# php - Worker 随着应用程序的增长而扩展

> ID：15036022
> 
> 赞同：0
> 
> 时间：2013-02-23T01:35:59.220
> 
> 标签：php, worker

我目前有一个 PHP 守护程序，它需要通过一个永无止境的循环运行非常快速的迭代。

它看起来像`while(true) { /* do something */ }`

问题是随着我的应用程序的增长，我的应用程序需要这个循环来执行越来越多的操作。但是，如果循环运行时间过长，则可能会错过一些操作。由于循环正在发送网络请求，因此需要一些时间。目前它每个循环只发送大约 5 个请求，但我已经看到它很快就会增长到 50 个左右。

如果每个请求需要 1 秒，那么 50 秒的循环是不可接受的。信息会丢失。

我的问题是如何改进我当前的系统以适应更多的请求，同时仍然保持非常快速的循环迭代？

我知道 PHP 不适合这种情况，但当时提供了一个非常优雅的解决方案。我需要使用带有 JSON 编码/解码的 MySQL 数据库，而 PHP 非常适合。如果有更好的语言可以做到这一点，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T01:45:22.677

启动多个处理 url 子集的工作人员。许多事情取决于您想要实现的细节，但也许消息队列（如rabbitMQ）也会有所帮助。例如：每个工作人员都从队列中接收消息，并且该消息包含他们应该处理的 url。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-17T17:29:32.047

试试[工作狂](http://github.com/flrngel/workaholic)吧。

它使用 Redis 进行消息队列，提供票务系统进行检查工作。

并且使用基于 javascript 的代码，很容易理解代码。

# excel - Excel 工作表 - 如何在 VLookUp 中添加条件

> ID：15036027
> 
> 赞同：0
> 
> 时间：2013-02-23T01:36:43.870
> 
> 标签：excel, excel-formula

我有一个带有两张纸、sheet1 和 sheet2 的 excel 文件。sheet2数据为：

```
Name    Teacher
A       A
B       Ba
C       C
D       D 
```

sheet1有以下数据

```
Sno Name    Teacher Class

1   A       A       5
2   B       Ba      5
3   C       C       6
4   D       D       5 
```

在这里，教师栏的每个单元格都有一个公式`=VLOOKUP(B2, sheet2!A:B, 2, FALSE)`。在这个公式中，B2 将根据行发生变化，如 b3、b4 等。

我想更改此公式，如果在 sheet2 中找不到名称，则在教师列中添加相同的名称。就像我有“E”名称并且在 Sheet2 中找不到它，那么“E”应该出现在“教师”列中，而不是“#N/A”。请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T01:52:11.600

![在此处输入图像描述](../Images/a6886e0b99c1e5afb6f1d5d20193a436.png)我想你希望你的公式是

`=IF(ISNA(VLOOKUP(B6, Sheet2!A:B, 2, FALSE)),B6,VLOOKUP(B6, Sheet2!A:B, 2, FALSE))`

这将专门检查 NA，任何其他错误仍会引发错误并且不会用 E 代替教师。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T01:52:19.297

```
=IFERROR(VLOOKUP(B2,Sheet2!A:B,2,0),B2) 
```

（适用于XL2007+）

# twitter - Twitter倒计时推文脚本

> ID：15036032
> 
> 赞同：0
> 
> 时间：2013-02-23T01:37:31.427
> 
> 标签：twitter, twitter-oauth, countdown

我正在尝试运行一个脚本，该脚本每天更新一次我的 Twitter 帐户，说明距离某个日期还有多少天。我一直在使用[此处](http://www.nostate.com/3982/auto-tweet-a-countdown-to-twitter-from-your-php-website/)概述的步骤，但尚未成功。该教程中使用的方法是否可能已过时？

我已经按照概述上传了 abrahams twitteroauth，这是我在 tweet.php 中使用的代码：

```
<?php

require_once('config.php');
require_once('twitteroauth/twitteroauth.php');
$connection = new TwitterOAuth(CONSUMER_KEY, CONSUMER_SECRET, ACCESS_TOKEN, ACCESS_TOKEN_SECRET);
$today = idate('z', time());
$enddate = idate('z', strtotime('6 June 2013'));
$daysleft = $enddate - $today;

$tweetstr = 'Only ' . $daysleft . ' day';
if ($daysleft > 1) $tweetstr .= 's';
$tweetstr .= " left to this whatever event starts!";

$connection->post('statuses/update', array('status' => $tweetstr));

?> 
```

我已将 twitter 应用程序设置为读取、写入和发送消息。我忽略了什么吗？我对 twitter api 相当陌生。

这是我运行脚本时出现的错误日志：

```
[Sat Feb 23 13:18:20 2013] [error] [client 86.40.89.186] PHP Notice:  Use of undefined constant ACCESS_TOKEN - assumed 'ACCESS_TOKEN' in /var/www/vhosts/darrenmccarra.com/connormccarra.com/lc-tweet-bot/lctweet45i32nd/tweet.php on line 5
[Sat Feb 23 13:18:20 2013] [error] [client 86.40.89.186] PHP Notice:  Use of undefined constant ACCESS_TOKEN_SECRET - assumed 'ACCESS_TOKEN_SECRET' in /var/www/vhosts/darrenmccarra.com/connormccarra.com/lc-tweet-bot/lctweet45i32nd/tweet.php on line 5
[Sat Feb 23 13:18:20 2013] [error] [client 86.40.89.186] PHP Warning:  idate() [<a href='function.idate'>function.idate</a>]: It is not safe to rely on the system's timezone settings. You are *required* to use the date.timezone setting or the date_default_timezone_set() function. In case you used any of those methods and you are still getting this warning, you most likely misspelled the timezone identifier. We selected 'UTC' for 'GMT/0.0/no DST' instead in /var/www/vhosts/darrenmccarra.com/connormccarra.com/lc-tweet-bot/lctweet45i32nd/tweet.php on line 6
[Sat Feb 23 13:18:20 2013] [error] [client 86.40.89.186] PHP Warning:  strtotime() [<a href='function.strtotime'>function.strtotime</a>]: It is not safe to rely on the system's timezone settings. You are *required* to use the date.timezone setting or the date_default_timezone_set() function. In case you used any of those methods and you are still getting this warning, you most likely misspelled the timezone identifier. We selected 'UTC' for 'GMT/0.0/no DST' instead in /var/www/vhosts/darrenmccarra.com/connormccarra.com/lc-tweet-bot/lctweet45i32nd/tweet.php on line 7
[Sat Feb 23 13:18:20 2013] [error] [client 86.40.89.186] PHP Warning:  idate() [<a href='function.idate'>function.idate</a>]: It is not safe to rely on the system's timezone settings. You are *required* to use the date.timezone setting or the date_default_timezone_set() function. In case you used any of those methods and you are still getting this warning, you most likely misspelled the timezone identifier. We selected 'UTC' for 'GMT/0.0/no DST' instead in /var/www/vhosts/darrenmccarra.com/connormccarra.com/lc-tweet-bot/lctweet45i32nd/tweet.php on line 7 
```

# ruby - 通过 Homebrew (Mac OS 10.7) 升级 Mac Ruby

> ID：15036037
> 
> 赞同：1
> 
> 时间：2013-02-23T01:38:30.843
> 
> 标签：ruby, macos

我在设置 compy 486 以使用 Ruby 1.9.3 时遇到问题。我使用 _why 的说明（[http://poignant.guide/book/expansion-pak-1.html](http://poignant.guide/book/expansion-pak-1.html)）安装了自制软件，但是当我检查安装了哪个版本时，它仍然是 1.8.7。

据我了解，这是因为现在安装了两个版本的 ruby​​。（请参阅：[如何切换到使用 Homebrew 安装的 ruby​​ 1.9.3？](https://stackoverflow.com/questions/8730676/how-can-i-switch-to-ruby-1-9-3-installed-using-homebrew)）

看：

```
Last login: Fri Feb 22 17:20:40 on ttys000
MacBook-Air:~ andrew$ brew install ruby
Error: ruby-1.9.3-p385 already installed
To install this version, first `brew unlink ruby'
MacBook-Air:~ andrew$ ruby -v
ruby 1.8.7 (2012-02-08 patchlevel 358) [universal-darwin11.0]
MacBook-Air:~ andrew$ 
```

我读过我应该安装 Ruby 版本管理器，但是当我尝试时我遇到了问题。

```
MacBook-Air:~ andrew$ $ \curl -L https://get.rvm.io | bash -s stable --ruby
-bash: $: command not found 
```

那么有没有一种简单的方法可以访问我的 ruby​​ 1.9.3 的新版本，即使默认情况下不使用它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T01:58:50.807

我建议你使用 rbenv ( [https://github.com/rbenv/rbenv](https://github.com/rbenv/rbenv) )。

rbenv 比 RVM 更简单、更轻巧，而且它对您的系统很友好（RVM 会覆盖 CD 和 GEM 命令，这有点令人担忧）。

一旦你安装了 rbenv（我会使用自制软件，上面链接的 rbenv github 页面上的说明），你就可以做到这一点：

```
rbenv install 1.9.3-p392 
```

请注意，因为 RVM 会覆盖基本系统命令，所以您不能同时安装 RVM 和 rbenv。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T23:52:14.550

即使在通过 Homebrew 安装当前版本后，您仍然可以获得系统默认的 Ruby，这是一个简单的定义问题**：** OS `$PATH`X 的系统 Ruby 安装在 中`/usr/bin`，而 Homebrew 将其版本安装在.`/usr/local/bin` **`/usr/bin``$PATH`**

 **要获取新安装的 Ruby，请指定完整的二进制路径，即`/usr/local/bin/ruby`. 如果您想将其设为默认值，您当然可以使用 Ruby 版本管理器（*RVM*和*rbenv*是最著名的），但只需更改您的`$PATH`to put `/usr/local/bin`before`/usr/bin`也可以解决问题。**

# php - 具有多个值的 ArrayObjects？

> ID：15036042
> 
> 赞同：0
> 
> 时间：2013-02-23T01:39:01.800
> 
> 标签：php, arrays, multidimensional-array

嘿，我有一个简单的循环，我试图创建 ArrayObject 以便它拥有一个坐标系。

我试图通过将 Y 坐标放在 X 坐标中来减少数据量，以减少重复数据。

这是我尝试过的：

```
$object = new ArrayObject();
$xWidth=1;
$yWidth=2;

for ($x=0; $x < $xWidth; $x++) {
        $object[$x] = new ArrayObject();

  for ($y=0; $y < $yWidth; $y++) {
        $object[$x][$y];
   }
} 
```

问题是数据不是我预期的......这就是我看到数据的方式：

```
ArrayObject Object
(
    [storage:ArrayObject:private] => Array
        (
            [0] => ArrayObject Object
                (
                    [storage:ArrayObject:private] => Array
                        (
                        )

                )

        )

) 
```

知道如何将第二个 Y 数字放入 X ArrayObject 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T01:48:18.993

为什么不直接使用包含 y 和 x 的对象

```
 class coordinates{

             public __constructor($x, $y){
             $this->x = $x;
               $this->y = $y;
              }
              private $x;
            private $y;
            public function setX($x){
            $this->x = $x;
            }

             public function setY($y){
            $this->y = $y;
            }

            public function getX(){
            return $this->x;
            }

            public function getY(){
            return $this->y;
            }

            }

            $cordinate  = new coordinates($x, $y);

            $collectionCordinates[] = $cordinate; 
```

# api - 我可以将视频从我自己的网站上传到 YouTube

> ID：15036044
> 
> 赞同：10
> 
> 时间：2013-02-23T01:39:49.470
> 
> 标签：api, youtube, youtube-api

是否有一个 YouTube API 可以让我从我自己的网站上传视频到我的 YouTube 帐户并返回我可以存储在我的网站数据库中的嵌入代码。

我想添加一个名称、描述、自定义 URL 和嵌入链接，所有这些都进入我的在线数据库。嵌入应该从 YouTube 返回，这样我就可以将它存储在网上并且可以阅读。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-23T01:49:05.333

您可以使用 YouTube 开发人员的插入 API。

[https://developers.google.com/youtube/v3/docs/videos/insert](https://developers.google.com/youtube/v3/docs/videos/insert)

要上传，您可以使用此授权：[https ://www.googleapis.com/auth/youtube.upload](https://www.googleapis.com/auth/youtube.upload)

如果成功，此方法会在响应正文中返回视频资源。[https://developers.google.com/youtube/v3/docs/videos#resource](https://developers.google.com/youtube/v3/docs/videos#resource)

这可能对您的需求有所帮助。

# utf-8 - 通过 eggdrop 将 utf-8 字符转换为 html 实体时遇到问题

> ID：15036046
> 
> 赞同：1
> 
> 时间：2013-02-23T01:40:36.673
> 
> 标签：utf-8, tcl, eggdrop

首先要解决这个问题。我已经在 utf-8 编码下重新编译了 eggdrop。如果我在 strings( `\u00a7`) 中编写转义序列，我可以回显 utf-8 字符，但由于某种原因，我还无法弄清楚.. 我无法使用正则表达式将它们与对应的字符进行比较。

我正在尝试开发一个基于 eggdrop 的日志记录脚本，在 tcl 下编码。我已经花了几个小时只做研究，但要么没有任何帮助，要么我找错了地方。

用户在机器人所在的 irc 频道中键入输入字符串 §。linux 端的日志记录脚本将此字符解释为特殊控制字符（I -think-），并在 gedit 中呈现为外观类似于 'FFA7' 的两行特殊字符，FF 在第一行，第二个A7，全部装在一个盒子里。

我的正则表达式很简单：

```
regexp -all {\u00a7} $text 
```

我当然也尝试过：

```
regexp -all {\247} $text 
```

不幸的是，正如已经说过的......它不起作用。我每次都得到一个 0，这意味着它永远不会匹配字符。

对于我所做的所有研究，我一直无法弄清楚 eggdrop 将字符串发送到 tcl 脚本的格式。唯一有效的方法是将那个类似盒子的字符从 gedit 直接复制到脚本中。但考虑到我无法复制这个字符，否则编码变得相当不可能。

对于这个问题..我想知道我在这里做错了什么，如果实际上有正确的方法来解释机器人发送的字符串，那么我可以正确地将其中的特殊字符转换为 html 实体。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T03:22:08.753

对于那些想知道的人，从我的测试中可以看出我已经用简单的方法解决了这个问题：

```
set text [encoding convertfrom utf-8 $text] 
```

我的其他功能可以按应有的方式替换转义序列。我不知道我在研究早期是怎么错过的。

# python - 为什么 `gensim` 中的 tf-idf 模型在我转换语料库后会丢弃术语和计数？

> ID：15036048
> 
> 赞同：2
> 
> 时间：2013-02-23T01:40:55.927
> 
> 标签：python, nlp, information-retrieval, tf-idf, gensim

为什么`gensim`我转换语料库后 tf-idf 模型会丢弃术语和计数？

我的代码：

```
from gensim import corpora, models, similarities

# Let's say you have a corpus made up of 2 documents.
doc0 = [(0, 1), (1, 1)]
doc1 = [(0,1)]
doc2 = [(0, 1), (1, 1)]
doc3 = [(0, 3), (1, 1)]

corpus = [doc0,doc1,doc2,doc3]

# Train a tfidf model using the corpus
tfidf = models.TfidfModel(corpus)

# Now if you print the corpus, it still remains as the flat frequency counts.
for d in corpus:
  print d
print 

# To convert the corpus into tfidf, re-initialize the corpus 
# according to the model to get the normalized frequencies.
corpus = tfidf[corpus]

for d in corpus:
  print d 
```

输出：

```
[(0, 1.0), (1, 1.0)]
[(0, 1.0)]
[(0, 1.0), (1, 1.0)]
[(0, 3.0), (1, 1.0)]

[(1, 1.0)]
[]
[(1, 1.0)]
[(1, 1.0)] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-14T07:35:48.120

IDF 是通过将文档总数除以包含该术语的文档数，然后取该商的对数来获得的。在您的情况下，所有文档都有 term0，因此 term0 的 IDF 是 log(1)，等于 0。所以在您的 doc-term 矩阵中，term0 的列全为零。

出现在所有文档中的术语权重为零，它绝对不携带任何信息。

# c - 如何让用户输入到 C 上的动态字符数组中？

> ID：15036049
> 
> 赞同：0
> 
> 时间：2013-02-23T01:40:56.750
> 
> 标签：c, dynamic, char

例如：

```
char *t;

printf("Enter the value of t: "); 
```

如何将用户输入保存到 t 中？接下来我能做什么？

# c# - 使所有类事件在与构造函数调用线程相同的线程上触发

> ID：15036053
> 
> 赞同：0
> 
> 时间：2013-02-23T01:41:36.870
> 
> 标签：c#, .net, vb.net, multithreading, invoke

我有一个 windows 窗体应用程序和一个类。

该类在不同的线程中触发事件，因此我需要以接收事件的形式在函数中执行`Control.InvokeRequired`代码`Control.Invoke()`。

是否可以在类上进行所有线程处理，这样我就不需要`Invoke()`在表单中做，并假设所有即将发生的事件都已经在同一个线程上？

我不喜欢的我正在考虑的解决方案是在类的构造函数中启动一个虚拟控件，或者传递对类中表单的引用，然后进行检查`InvokeRequired`。

还有其他可能的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:39:58.363

一般来说，一个类不应该涉及 UI 实现细节。它很可能用于在另一个线程上引发事件无关紧要的场景。在这种情况下，您当然不想编组。你也不知道要编组什么。

有一种很好的方法可以通过 ISynchronizeInvoke 接口在 Winforms 中解耦，FileSystemWatcher.SynchronizingObject 就是一个很好的例子。该属性允许应用程序选择是自行处理编组还是留给 FSW 来完成。在带有 Foo 事件（VS2010 语法）的示例类中，您使它看起来像这样：

```
Imports System.ComponentModel

Public Class Example
    Public Event Foo As EventHandler

    Public Property SynchronizingObject As ISynchronizeInvoke

    Protected Sub OnFoo(e As EventArgs)
        If SynchronizingObject IsNot Nothing AndAlso SynchronizingObject.InvokeRequired Then
            SynchronizingObject.BeginInvoke(Sub() RaiseEvent Foo(Me, e), Nothing)
        Else
            RaiseEvent Foo(Me, e)
        End If
    End Sub
End Class 
```

现在，Form 类可以简单地将自己分配给 SynchronizingObject 属性，如下所示：

```
Public Class Form1
    Private WithEvents obj As Example

    Public Sub New()
        InitializeComponent()
        obj.SynchronizingObject = Me
    End Sub

    Private Sub obj_Foo(sender As Object, e As EventArgs) Handles obj.Foo
        '' No marshaling required
        ''...
    End Sub
End Class 
```

# mysql - 在存储过程中重复更新最后一个数字

> ID：15036056
> 
> 赞同：1
> 
> 时间：2013-02-23T01:41:45.687
> 
> 标签：mysql

```
CREATE DEFINER=`root`@`localhost` PROCEDURE `SampleProc`( name_in INT)
BEGIN
DECLARE exit_loop BOOLEAN;
    DECLARE l_name INT;
            DECLARE X  INT;
     DECLARE Y INT;
     DECLARE c1id INT;
      DECLARE done INT DEFAULT FALSE;
        DECLARE cur CURSOR FOR SELECT PaperID FROM scrpd_paper_authors WHERE AuthorID=name_in;
     DECLARE cur1 CURSOR FOR SELECT AuthorID FROM scrpd_paper_authors WHERE PaperID=l_name;
     DECLARE CONTINUE HANDLER FOR NOT FOUND SET exit_loop = TRUE;
    OPEN cur;

     example_loop: LOOP
      FETCH cur INTO l_name;
      IF exit_loop THEN
    CLOSE cur;
    LEAVE example_loop;
    END IF;
    OPEN cur1;
      example_loop1:LOOP
       FETCH cur1 INTO c1id;

    UPDATE recipes_new SET co_auths = IF(LENGTH(co_auths), CONCAT(co_auths, ',', c1id), c1id) WHERE id = name_in;       

       IF exit_loop THEN
    CLOSE cur1;
    LEAVE example_loop1;
     END IF;
 END LOOP example_loop1;
 END LOOP example_loop;
END$$ 
```

我在 sqlyog 中创建了一个存储过程，我面临的问题是当我在更新完成后看到表中的结果是 1,2,3,3 而它应该是 1,2,3 最后一个条目正在重复。任何猜测是什么问题？

```
recipes_new(My current result)       scrpd_paper_authors

id     co_auths                      PaperID     AuthorID

====    ========                      =======     ========
 1          1,1                          1            1
 2          2,2                          2            2
 3          3,4,4                        3            3
 4          3,4,5,6,7,7                  3            4
                                         4            5
                                         4            6
                                         4            7 
```

正如您在 recipes_new（我的当前结果）中看到的那样，我最后得到了额外的数字。我的预期结果是

```
 1
 2
 3,4
 3,4,5,6,7 
```

# rest - Ajax 请求使用 ServiceStack 返回空响应

> ID：15036059
> 
> 赞同：3
> 
> 时间：2013-02-23T01:42:24.800
> 
> 标签：rest, servicestack, cors

在涉及到宁静的东西、ajax 等等时，总共 n00b，所以请保持温和。

我有一个问题，我采用了示例 ServiceStack“Todo”服务，并试图开发一个使用该服务作为数据源的移动客户端。我正在尝试了解这一切是如何工作的，这样我就可以构建一个我认为 SS 比 WCF/WebAPI 更适合的特定服务。

无论如何，假设该服务正在运行， `http://localhost:1234/api/todos` 我已经启用了基于将其他各种帖子中的信息拼凑在一起的 CORS 支持。所以我的配置函数看起来像这样：

```
Plugins.Add(new CorsFeature());

            this.RequestFilters.Add((httpReq, httpRes, requestDto) =>
            {
                httpRes.AddHeader("Access-Control-Allow-Origin", "*");
                //Handles Request and closes Responses after emitting global HTTP Headers
                if (httpReq.HttpMethod == "OPTIONS")
                {
                    httpRes.AddHeader("Access-Control-Allow-Methods", "POST, GET, OPTIONS");
                    httpRes.AddHeader("Access-Control-Allow-Headers", "X-Requested-With, Content-Type");
                    httpRes.StatusCode = 204;
                    httpRes.End();
                }
            }); 
```

我在 TodoService 上有一个这样的服务方法：

```
[EnableCors]
        public object Post(Todo todo)
        {

            var t = Repository.Store(todo);
            return t;
        } 
```

使用浏览器 (FF/IE) 如果我调用这个 ajax 函数：

```
var todo = { content: "this is a test" };
            $.ajax(
            {
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify(todo),
                timeout:20000,
                url: "http://localhost:1234/api/todos",
                success: function (e) {
                    alert("added");
                    app.navigate("Todo");
                },
                error: function (x, a, t) {
                    alert("Error");
                    console.log(x);
                    console.log(a);
                    console.log(t);
                }
            }
            ); 
```

从`http://localhost:1234`，然后一切正常。待办事项被添加，并且在成功函数中，“e”包含服务创建的返回待办事项对象。但是，如果我从其他任何地方（`http://localhost:9999`即运行移动客户端应用程序的 asp.net 开发服务器）调用它，那么尽管执行了 Service 方法，并且确实在服务器端添加了 todo，但响应返回给 jquery是空的，它会立即触发错误函数。

我确信我在做一些愚蠢的事情，但我一辈子都看不到它。有人有任何线索吗？提前致谢...

更新：现在看来工作正常，问题似乎是

```
 httpRes.AddHeader("Access-Control-Allow-Origin", "*"); 
```

在“选项”块之外。所以在 apphost 中工作的代码是

```
Plugins.Add(new CorsFeature());
            this.RequestFilters.Add((httpReq, httpRes, requestDto) =>
            {

                //Handles Request and closes Responses after emitting global HTTP Headers
                if (httpReq.HttpMethod == "OPTIONS")
                {
                    httpRes.AddHeader("Access-Control-Allow-Methods", "POST, GET, OPTIONS");
                    httpRes.AddHeader("Access-Control-Allow-Origin", "*");
                    httpRes.AddHeader("Access-Control-Allow-Headers", "X-Requested-With, Content-Type");
                    httpRes.StatusCode = 204;
                    httpRes.End();
                }
            }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T13:12:00.303

所以原来我的原始代码有问题；修改后的代码是：

```
Plugins.Add(new CorsFeature());
            this.RequestFilters.Add((httpReq, httpRes, requestDto) =>
            {

                //Handles Request and closes Responses after emitting global HTTP Headers
                if (httpReq.HttpMethod == "OPTIONS")
                {
                    httpRes.AddHeader("Access-Control-Allow-Methods", "POST, GET, OPTIONS");
                    //this line used to be outside the if block so was added to every header twice.                      
                    httpRes.AddHeader("Access-Control-Allow-Origin", "*");
                    httpRes.AddHeader("Access-Control-Allow-Headers", "X-Requested-With, Content-Type");
                    httpRes.StatusCode = 204;
                    httpRes.End();
                }
            }); 
```

因此，CorsFeature() 插件似乎可以正确处理 POST、GET 的所有 CORs 内容，并且 RequestFilter 正在处理飞行前 OPTIONS 请求（混淆 - 为什么插件不只处理 OPTIONS 请求？）；在旧代码中，每个请求（通过插件和过滤器）都添加了两次 allow-origin 标头，这似乎使 jquery 或浏览器感到困惑。

并不是说我完全理解其中的任何内容，我还有一些阅读要做:) 无论如何，这一切都变得毫无意义，因为我使用的移动框架（DXTreme）似乎无法处理 JSONP 以外的任何东西（因为对我没有好处）我需要 POST/PUT）作为跨域的 Rest Data 源，所以我已经不得不走代理路线，或者转储框架，或者找到解决我的问题的其他方法。

# c++ - 使用可变参数模板解包参数列表时获取参数索引

> ID：15036063
> 
> 赞同：4
> 
> 时间：2013-02-23T01:43:21.230
> 
> 标签：c++, templates, c++11, variadic-templates

我需要在解包和转换参数列表时获取参数的索引。有没有针对以下问题的解决方案：

```
#include <iostream>
#include <vector>
#include <string>

using namespace std;

void test(int a, std::string b, bool c)
{
    cout << a << "," << b << "," << c << endl ;
}

template <typename... ARG>
static void call_test(const vector<void*> &params)
{
    test(*static_cast<ARG*>(params[ indexOf(ARG) ])...);
}

int main(int argc, char **argv)
{
    int    a = 1;
    string b = "string";
    bool c   = false;
    vector<void*> v(3);
    v[0] = &a;
    v[1] = &b;
    v[2] = &c;

    call_test<int,string,bool>(v);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T01:51:44.080

我就是这样做的。首先，您将需要一些机制来创建整数的编译时序列：

```
using namespace std;

//===========================================================================
// META-FUNCTIONS FOR CREATING INDEX LISTS

// The structure that encapsulates index lists
template <size_t... Is>
struct index_list
{
};

// Collects internal details for generating index ranges [MIN, MAX)
namespace detail
{
    // Declare primary template for index range builder
    template <size_t MIN, size_t N, size_t... Is>
    struct range_builder;

    // Base step
    template <size_t MIN, size_t... Is>
    struct range_builder<MIN, MIN, Is...>
    {
        typedef index_list<Is...> type;
    };

    // Induction step
    template <size_t MIN, size_t N, size_t... Is>
    struct range_builder : public range_builder<MIN, N - 1, N - 1, Is...>
    {
    };
}

// Meta-function that returns a [MIN, MAX) index range
template<size_t MIN, size_t MAX>
using index_range = typename detail::range_builder<MIN, MAX>::type;

//=========================================================================== 
```

然后，您可以使用该机制来实现函数调用，利用参数包扩展的力量：

```
#include <iostream>
#include <vector>
#include <string>

void test(int a, std::string b, bool c)
{
    cout << a << "," << b << "," << c << endl ;
}

namespace detail
{
    // This is the function that does the real work.
    template<typename... Ts, size_t... Is>
    void call_test(const vector<void*>& params, index_list<Is...>)
    {
        test((*static_cast<Ts*>(params[Is]))...);
    }
}

// This function just creates the compile-time integer sequence and 
// forwards to another function that performs the real work.
// In other words, this is a proxy that hides the complexity of the
// machinery from the client.
template <typename... ARG>
void call_test(const vector<void*>& params)
{
    detail::call_test<ARG...>(params, index_range<0, sizeof...(ARG)>());
}

int main(int argc, char **argv)
{
    int    a = 1;
    string b = "string";
    bool c   = false;
    vector<void*> v(3);
    v[0] = &a;
    v[1] = &b;
    v[2] = &c;

    call_test<int,string,bool>(v);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T01:48:50.413

最简单的解决方案肯定是不使用 a `vector`of `void*`; 只需直接使用值：

```
template<typename...Arg>
void call_test(Arg const&...arg) {
  test(arg...);
} 
```

（或该主题的一些变体。）但我想您想做的不仅仅是调用测试。

如果您真的想要索引，请使用这里所谓的“索引技巧”。你应该可以搜索到。

# android - 尝试解决线性布局中的嵌套权重问题（可能使用相对布局）

> ID：15036071
> 
> 赞同：0
> 
> 时间：2013-02-23T01:44:54.627
> 
> 标签：android, android-layout

我正在开发一个计算器应用程序，并希望拥有：

1.  多行中的按钮。
2.  按钮应填满整个屏幕尺寸，并且下方不留空白。

这已使用嵌套线性布局成功实现。但是，android lint 指出了线性布局中“嵌套权重”的低效率。请提出一种解决方法或使用相对布局实现相同的方法。

以下是线性布局的示例。

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical">

<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="0dp"
    android:layout_weight="0.5"
    android:orientation="horizontal">

    <Button
        android:id="@+id/button_7"
        android:layout_width="0dp"
        android:layout_weight="0.5"
        android:layout_height="match_parent"
        android:onClick="clickDigit"
        android:text="@string/button_7" />

    <Button
        android:id="@+id/button_8"
        android:layout_width="0dp"
        android:layout_weight="0.5"
        android:layout_height="match_parent"
        android:onClick="clickDigit"
        android:text="@string/button_8" />

</LinearLayout>

 <LinearLayout
    android:layout_width="match_parent"
    android:layout_height="0dp"
    android:layout_weight="0.5"
    android:orientation="horizontal">

     <Button
        android:id="@+id/button_dot"
        android:layout_width="0dp"
        android:layout_weight="0.5"
        android:layout_height="match_parent"
        android:onClick="clickDot"
        android:text="@string/button_dot" />

    <Button
        android:id="@+id/button_0"
        android:layout_width="0dp"
        android:layout_weight="0.5"
        android:layout_height="match_parent"
        android:onClick="clickDigit"
        android:text="@string/button_0" />

</LinearLayout> 
```

这是使用嵌套线性布局实现的屏幕截图，我希望使用相对布局实现相同的效果。

![截屏](../Images/62b4a12046449bb9864533f077efe753.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T10:31:49.313

> 请提出一种解决方法或使用相对布局实现相同的方法。

在中间使用一个锚点视图，并在该锚点视图的每一侧`RelativeLayout`放置两个`Buttons`加权。`LinearLayout`像这样的东西：

```
<RelativeLayout>
    <View android:id="@+id/anchor" android:layout_centerHorizontal="true" />
    <!-- the C button part -->
    <Linearlayout android:id="@+id/firstRow" android:layout_alignParentRight="true" android:layout_toRightOf="@id/anchor">
          <View android:layout_weight="1" />
          <Button android:text="C" android:layout_weight="1" />  
    </LinearLayout>  

    <Linearlayout android:id="@+id/firstRowPart2" android:layout_alignParentRight="true" android:layout_toRightOf="@id/anchor" android:below="@id/firstRow">
         <Button android:text="3" android:layout_weight="1" />  
          <Button android:text="+" android:layout_weight="1" />  
    </LinearLayout>  

    <Linearlayout android:id="@+id/firstRowPart1" android:layout_alignParentLeft="true" android:layout_toLeftOf="@id/anchor" android:below="@id/firstRow">
         <Button android:text="1" android:layout_weight="1" />  
          <Button android:text="2" android:layout_weight="1" />  
    </LinearLayout>  

    <!-- rest of the rows -->
</RelativeLayout> 
```

正如您所看到的，这需要将布局深度增加一倍，并在布局中添加额外的视图，因此最终性能提升不会那么大。

进行该布局的更好方法是使用一个`TableLayout`集合来拉伸所有列（在这种情况下，您只需要一些额外`TableRows`的 ，更准确地说是 5 ）。

进行该布局的更好方法是创建自己的自定义布局，这样您就可以`Buttons`仅使用一个布局（并且没有权重）将它们放置在网格中（并且应该很容易制作）。

> 但是，android lint 指出了线性布局中“嵌套权重”的低效率。

很高兴您考虑到这一点（并且您应该），但在您的情况下，应用程序可能很小/轻量级，因此这些嵌套权重不会对应用程序的性能产生如此大的影响。只是一个意见，不要仅仅为此而投反对票。

# javascript - JavaScript/Jquery 限制内容大小并拆分

> ID：15036075
> 
> 赞同：0
> 
> 时间：2013-02-23T01:45:26.110
> 
> 标签：javascript, regex

所以我根据固定大小的 div 来限制这个字符串的大小，额外的字符被放置到一个新的 div 中，例如：限制为 5 个字符和一个字符串 abcdefghijklmnopqrstuvwxyz。结果应该是： div abcde /div div fghij /div... 它适用于常规字符串，但问题是我的字符串包含 htmls 标签，因为我从所见即所得编辑器获取输入，并且变得不可预测。这是我的代码：

```
var content = '<?php echo $content; ?>';
var limit = 800;

var regex = new RegExp('.{1,'+limit+'}','g')

$(content.match(regex)).each(function(key,val){
    $('#mybook').append('<div>'+val+'</div>')

}) 
```

谢谢

# java - JTable Cell 中的 JDatechooser

> ID：15036077
> 
> 赞同：0
> 
> 时间：2013-02-23T01:45:59.617
> 
> 标签：java, swing, jtable, tablecelleditor, jdatechooser

我想在 JTable 单元中添加一个 JDateChooser。我知道如何添加文本框、组合框和复选框。

我允许用户向表中输入数据。用户应该能够为每一行选择一个日期。

任何帮助，将不胜感激。
谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T03:08:30.280

阅读 Swing 教程中关于[使用其他编辑器](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#editor)的部分。

它展示了如何使用 JColorChooser 创建自定义编辑器。我猜想代码与使用 JDateChooser 类似。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-06-26T10:54:45.647

**如下设置 CellEditor：**

```
table.getColumnModel().getColumn(1).setCellEditor(new JDateChooserEditor(new JCheckBox())); 
```

/************************************************* ************************/

**这是 JDateChooserEditor 的代码：**

```
class JDateChooserEditor extends DefaultCellEditor
{
  public JDateChooserEditor(JCheckBox checkBox)
  {
    super(checkBox);

  }

  JDateChooser date;
  public Component getTableCellEditorComponent(JTable table, Object value,
      boolean isSelected, int row, int column) 
  {

         date = new JDateChooser();
         date.setDateFormatString("dd-MM-yyyy");
         return date;
  }

  public Object getCellEditorValue() 
  {
    return new String(((JTextField)date.getDateEditor().getUiComponent()).getText());
  }

  public boolean stopCellEditing()
  {
    return super.stopCellEditing();
  }

  protected void fireEditingStopped() {
    super.fireEditingStopped();
  }
} 
```

[截屏](https://i.stack.imgur.com/RuJLG.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-03T11:40:43.970

```
This is a final solution for everyone, enjoy!!:

import com.toedter.calendar.JDateChooser;
import com.toedter.calendar.JTextFieldDateEditor;
import java.awt.Component;
import java.util.Calendar;
import java.util.Date;
import static javax.swing.BorderFactory.createEmptyBorder;
import javax.swing.JTable;
import javax.swing.table.TableCellRenderer;

/**
 *
 * @author Sergio
 */
public final class JDateChooserRenderer extends JDateChooser 
                                  implements TableCellRenderer  
{
    public JDateChooserRenderer() {                
        initilizie();
    }

    public void initilizie(){
        this.setPreferredSize(new java.awt.Dimension(50, 30));                 
        this.setDateFormatString("dd/MM/yyyy");
        this.setBorder(createEmptyBorder());    
    }

    @Override
    public Component getTableCellRendererComponent(JTable table, Object value,
                                                   boolean isSelected, boolean hasFocus,
                                                   int row, int column) {        
        // Configure text Editor
        JTextFieldDateEditor textEditor = (JTextFieldDateEditor) getDateEditor().getUiComponent();        
        textEditor.setBorder(createEmptyBorder());

        if (isSelected) {        
            textEditor.setBackground(table.getSelectionBackground()); 
        }   else {            
            textEditor.getUiComponent().setBackground(table.getBackground());
        }   

        if (value instanceof Date){
            this.setDate((Date) value);
        } else if (value instanceof Calendar){
            this.setCalendar((Calendar) value);
        }
        return this;        
    }
 }

import com.toedter.calendar.JDateChooser;
import com.toedter.calendar.JTextFieldDateEditor;
import javax.swing.AbstractCellEditor;
import javax.swing.table.TableCellEditor;
import java.beans.PropertyChangeEvent;
import java.beans.PropertyChangeListener;
import java.util.Calendar;
import java.awt.Component;
import javax.swing.JTable;
import java.lang.reflect.Field;
import java.util.Date;
import java.util.logging.Level;
import java.util.logging.Logger;
import static javax.swing.BorderFactory.createEmptyBorder;
import javax.swing.border.Border;

/**
 *
 * @author Sergio 
 */
public class JDateChooserEditor extends AbstractCellEditor
        implements TableCellEditor, PropertyChangeListener {

    JDateChooser DateChooser;
    Calendar calendar;  
    Border unselectedBorder = null;
    JTextFieldDateEditor textEditor = null;

    public JDateChooserEditor() {            
        DateChooser = new JDateChooser();         
        calendar = Calendar.getInstance();
        DateChooser.setPreferredSize(new java.awt.Dimension(50, 35));        
        DateChooser.setDateFormatString("dd/MM/yyyy"); 
        DateChooser.setCalendar(Calendar.getInstance());         
        // Configure text Editor
        textEditor = (JTextFieldDateEditor) DateChooser.getDateEditor().getUiComponent();        
        textEditor.setBorder(createEmptyBorder());
        // Listen for property changes
        DateChooser.addPropertyChangeListener(this);                          
    }

    @Override
    public void propertyChange(PropertyChangeEvent evt) {
        // If the 'date' property was changed...           
        if ("date".equals(evt.getPropertyName())) {
            JDateChooser edateChooser = (JDateChooser) evt.getSource();
            boolean isDateSelectedByUser = false;
            // Get the otherwise unaccessible JDateChooser's 'dateSelected' field.
            Field dateSelectedField = null;
            try {
                // Get the desired field using reflection
                dateSelectedField = JDateChooser.class.getDeclaredField("dateSelected");
                // This line makes the value accesible (can be read and/or modified)
                if (dateSelectedField != null) {
                    dateSelectedField.setAccessible(true);                    
                    isDateSelectedByUser = dateSelectedField.getBoolean(edateChooser);

                    if (isDateSelectedByUser) {
                        calendar = (Calendar) edateChooser.getCalendar();                                                                                                
                        DateChooser.setCalendar(calendar);                              
                    }                 
                }                 
                fireEditingStopped();                
            } catch (IllegalArgumentException | IllegalAccessException | NoSuchFieldException | SecurityException ex) {
                Logger.getLogger(JDateChooserEditor.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
    }

    // Se implementa el método CellEditor de la clase abstracta AbstractCellEditor.    
    @Override
    public Object getCellEditorValue() {       
       return calendar;
    }

    @Override
    public Component getTableCellEditorComponent(JTable table, Object value, boolean isSelected,int row, int column) {               
        DateChooser.getDateEditor().getUiComponent().setBackground(table.getSelectionBackground());         
        if (value instanceof Date){
            calendar.setTime((Date) value);             
        } else if (value instanceof Calendar){
            calendar = (Calendar) value;
        };  
        DateChooser.setCalendar(calendar);
        return DateChooser;
    } 
```

# templates - 另一个模板中的 apache 平铺模板

> ID：15036080
> 
> 赞同：0
> 
> 时间：2013-02-23T01:46:05.363
> 
> 标签：templates, jakarta-ee, tiles

我有一个所有页面的“t.base”视图定义：

```
<definition name="t.base" template="/WEB-INF/tiles/base.jsp">
    <put-attribute name="title" value="SomeTitle"/>
</definition> 
```

它的主要属性是`body`必须在每个子模板中定义。现在我想在主页上有一个滑块，它将直接放入正文中（与屏幕一样宽）：

```
<definition name="t.homepage" extends="t.base">
    <put-attribute name="body" value="/WEB-INF/jsp/homepage.jsp"/>
    <put-attribute name="title" expression="lyricsBase : home of lyrics"/>
</definition> 
```

所有其余的页面都必须放在一个 HTML 容器中（添加一些 CSS 样式），而不是使其与屏幕一样宽（边距等）。我希望这个容器模板“覆盖”`body`瓷砖属性：

```
<div class="container marketing">
    <div class="container">
        <tiles:insertAttribute name="body" />
    </div>
</div> 
```

容器 HTML 标记内的示例子视图：

```
<definition name="t.jukebox" extends="t.base">
    <put-attribute name="body">
        <definition template="/WEB-INF/tiles/container.jsp">
            <put-attribute name="body" value="/WEB-INF/jsp/jukebox.jsp" />
        </definition>
    </put-attribute>
    <put-attribute name="title" expression="${jukebox.name} - lyricsBase"/>
</definition> 
```

无论如何，这看起来不太好，我希望有一个更好的解决方案可以减少配置大小并产生完全相同的效果。我正在尝试定义这个容器：

```
<definition name="t.container" extends="t.base">
    <put-attribute name="body" value="/WEB-INF/tiles/container.jsp"/>
</definition> 
```

子模板将使用它。但我不知道如何配置它。

换句话说，我想在所有级别上使用相同的属性名称来实现类似[俄罗斯 Matrioszka 娃娃的效果。](http://en.wikipedia.org/wiki/Matryoshka_doll)只是覆盖属性。我习惯了这种`decorator`模式，这`composite view`对我来说仍然是抽象的。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-11T02:59:08.457

您可以使用定义继承，其中`t.homepage`将是 的扩展`t.container`，并且`t.container`将是 t.base 的扩展。甚至更多 - 您可以在 body 属性内部创建另一个插槽并在子定义中定义它。

# google-maps-mobile - 谷歌地图中使用的位置动画

> ID：15036081
> 
> 赞同：4
> 
> 时间：2013-02-23T01:46:19.353
> 
> 标签：google-maps-mobile, google-maps-sdk-ios

我在我的 ios 应用程序中使用谷歌地图，我喜欢显示谷歌地图中使用的位置动画。该动画通常用于显示当前位置并且是自动调整大小的，即标记大小的动画就像在浅蓝色中自我生长一样颜色。我喜欢为我的纬度和经度位置显示该动画。我该如何编程？我没有足够的声誉来上传图片。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T01:56:25.970

您应该可以设置`myLocationEnabled`，例如：

```
GMSMapView* mapView = ...;
mapView.myLocationEnabled = YES; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T23:30:29.797

如果您希望动画到您的位置，请使用`animateToLocation:(CLLocationCoordinate2D)location`：

```
GMSMapView* mapView = ...;
mapView.myLocationEnabled = YES;
[mapView animateToLocation:mapView.myLocation]; 
```

或者您`animateToCameraPosition:(GMSCameraPosition *)cameraPosition`甚至可以使用它来调整缩放

```
GMSCameraPosition *cameraPosition = [GMSCameraPosition cameraWithTarget:mapView.myLocation zoom:14.0f;
[mapView animateToCameraPosition:cameraPosition]; 
```

# php - 使用 Yii 发出 AJAX POST 请求时，$_GET['ajax'] 是如何自动设置的？

> ID：15036082
> 
> 赞同：0
> 
> 时间：2013-02-23T01:46:22.707
> 
> 标签：php, ajax, yii, cgridview

我正在使用 Yii 框架来开发一个基本的 CRUD 应用程序。我注意到动作函数中自动生成的代码通常包含以下几行：

```
// if AJAX request (triggered by deletion via admin grid view), we should not redirect the browser
if(!isset($_GET['ajax']))
     $this->redirect(isset($_POST['returnUrl']) ? $_POST['returnUrl'] : array('admin')); 
```

我无法弄清楚的部分是，即使我正在执行 AJAX POST，甚至当我使用 Firebug 或 Fiddler 检查请求中没有出现“ajax”参数时，这段代码也能正常工作。服务器是否向自己发出另一个 GET 请求，或者有什么`$_GET`我不理解的地方？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T05:21:26.450

[http://www.yiiframework.com/forum/index.php/topic/19324-whats-isset-getajax-for-in-the-generated-code/](http://www.yiiframework.com/forum/index.php/topic/19324-whats-isset-getajax-for-in-the-generated-code/)

如果您正在使用 Yii 库进行 Ajax 调用，看起来它是由 Yii 设置的

# javascript - 如何实现字符串树的差异？

> ID：15036083
> 
> 赞同：-2
> 
> 时间：2013-02-23T01:46:23.707
> 
> 标签：javascript, string, tree, diff

如何实现一个解释两棵字符串树之间差异的函数？例如：

```
diff(["aaa","bbb",["ccc","ddd"],"eee"],
     ["aaa","bbx",["ccc","ddd"]]); 
```

这个函数应该报告“bbb”的编辑和“eee”的删除。如何实现这样的功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T02:02:31.817

对于简单的文本差异，您可以将每棵树转换为平面文件。

将节点转换为行，这样每个子节点都带有选项卡（每个嵌套级别一个选项卡）。然后在两个平面文件上运行差异。例如：

```
["aaa","bbb",["ccc","ddd"],"eee"] 
```

变为（转义制表符和换行符）：

```
aaaa
bbb
    ccc
    ddd
eee 
```

如果您想要一个数字度量，请计算 diff 输出中的行数。

如果你想变得花哨，它可以在每个节点上完成，但根据结果的用途，这需要做很多工作。

# asp.net - ASP.Net / VB 从 Access 数据库构建 Excel 电子表格

> ID：15036087
> 
> 赞同：0
> 
> 时间：2013-02-23T01:47:11.093
> 
> 标签：asp.net, vb.net, excel

我需要组合一个原型 Web 应用程序来向用户展示来自 Access 数据库的选项，并使用这些选项来读取相同的 Access 数据库以构建并返回给他们一个 Excel 电子表格。

我以为我只是构建 Excel 宏来进行格式化并从 ASP.net 调用这些宏，但是我读的越多，这似乎就越不可能工作。我在 Excel、Access 和 VB 方面有丰富的经验，但我在 ASP 方面做任何事情已经有 12 年了。变了，只是一点点...

那么，工具集应该是 Windows 7、Office 2010、IIS、Visual Studio 2010 等等……还有什么？

# api - 获取 Google Analytics API“超出用户速率限制。请注册”，即使当天的第一次请求也是如此

> ID：15036088
> 
> 赞同：1
> 
> 时间：2013-02-23T01:47:12.363
> 
> 标签：api, google-analytics, google-analytics-api, garb-gem

我正在使用 Ruby gem Garb 从 Google Analytics 中提取一些视图计数。我可以使用我的用户名/密码毫无问题地进行身份验证。但是，当我尝试提取数据时，我得到了响应：

```
<?xml version=\"1.0\" encoding=\"UTF-8\"?>
<errors xmlns=\"http://schemas.google.com/g/2005\">
<error>
<domain>usageLimits</domain>
<code>userRateLimitExceededUnreg</code>
<internalReason>User Rate Limit Exceeded. Please sign up</internalReason><extendedHelp>https://code.google.com/apis/console</extendedHelp>
</error>
</errors> 
```

我已经在[https://code.google.com/apis/console/](https://code.google.com/apis/console/)上注册了。那里显示我每天有 50K 的礼貌请求。问题是，即使我没有在 24 小时内提出一个请求然后尝试提出一个请求，我也会收到错误消息。知道如何进行吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T01:16:30.243

该错误可能是在循环中运行查询的结果。默认情况下，您每秒只能查询 1 次。您可以将其增加到 10 qps，但我认为这并不能完全解决您的问题。您可以添加一些间隔。说使用睡眠（1）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T14:10:01.573

我以不同的方式遇到同样的问题：

*   当我从本地主机尝试时，它工作正常。
*   当我从生产中执行时，它给了我那个错误。

也许谷歌分析服务器阻止了我的生产服务器的 IP 地址？如果是这种情况，如何再次解锁？

# javascript - 在网络应用程序中使用 Google Talk 插件

> ID：15036092
> 
> 赞同：1
> 
> 时间：2013-02-23T01:48:06.657
> 
> 标签：javascript, webrtc, google-talk, video-conferencing

有谁知道网络应用程序开发人员是否可以使用 Google Talk 浏览器插件？我说的是用 HTML/JavaScript 操作它。Google Talk 开发网站似乎只为想要开发独立客户端/服务器应用程序的开发人员提供信息。但是使用 gmail、igoogle 和 orkut 使用的嵌入式插件（显然）没有任何意义。

我对使用音频/视频会议功能特别感兴趣；可能与非 Google libjingle 服务器一起使用。我猜谷歌没有发布 API 是出于竞争原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T01:55:59.157

我认为这是不可能的，但是有一个项目可以将这些功能引入浏览器。它被称为[WebRTC](http://www.webrtc.org/)。看起来它可以在 Chrome 和 Firefox 中使用。

# asp.net - 添加两个带有条件的 Gridview 列

> ID：15036093
> 
> 赞同：0
> 
> 时间：2013-02-23T01:48:06.900
> 
> 标签：asp.net, sql, tsql

我有一个带有 C# 编码的 asp.net 项目。

在这里我有这样的问题；“我需要计算网格视图中单元格的添加”我该怎么做。我需要将 IN 和 OUT 分钟相加并将它们除以 60 以找到工作时间。

选择 sum (cell1 + cell2) 因为某些东西不起作用，因为我有这样的网格；

```
NAME       WORK_TYPE        FM            FM_HOUR

-------------------------------------------------------

Mike         IN            -2800                

Mike         OUT            3400             ??

Jane         IN              400

Jane         OUT            -100             ?? 
```

应该是什么？？标记在这里。

我已经写了这个，但当然不起作用。因为程序不知道如何从那里获取值。

这是示例代码；

```
SqlConnection conn;
        SqlCommand cmd = new SqlCommand();
        string strSQL = "UPDATE bilgiler3 SET FM_HOUR= SELECT SUM((FM WHERE WORK_TYPE='OUT') + (FM WHERE WORK_TYPE='IN')) / 60 "
        string bag_str = WebConfigurationManager.ConnectionStrings["asgdb01ConnectionString"].ConnectionString;
        conn = new SqlConnection(bag_str);
        conn.Open(); 
```

. . .

请等待您的帮助。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T02:22:40.080

`GridView`允许添加列。我`TemplateField`在`ItemTemplate`我使用标签中使用 and 并对其他单元格数据的结果进行数学运算并在其中显示结果。在后面的代码中创建一个子例程，并`For Loop`为每一行使用一个。`row.FindControl`将帮助您找到标签并显示结果。如果您使用`BoundFields`切换到，`TemplateFields`那么您可以进行控制，您可以找到并获得那里的价值。

```
 <Columns>
         <asp:TemplateField HeaderText="some header info">
           <ItemTemplate >
            <asp:Label ID="lbId" runat="server" Text='<%# Eval("Id") %>' />
           </ItemTemplate>
          </asp:TemplateField>...

For Each row As GridViewRow In gv.Rows
 Dim id As Label = TryCast(row.FindControl("lbId"), Label)
 'other variables
Next 
```

# jquery - mediaelement.js 音频在 IE7/8 中加倍

> ID：15036095
> 
> 赞同：0
> 
> 时间：2013-02-23T01:48:17.100
> 
> 标签：jquery, audio, mediaelement.js, mediaelement

我正在使用[http://mediaelementjs.com](http://mediaelementjs.com)在我正在处理的项目中加载音频和视频。它可以在较新的浏览器上完美运行。

我需要的主要功能（跨浏览器音频/视频支持除外）是音频剪辑完成时的结束回调。

一切都在 IE7/8 中加载，但音频本身会增加一倍（倾斜/四倍）。这是一种诡异的效果。

我像这样加载它：

```
function play1(){
    var audioPlayer = MediaElement('player1', {
          success: function (media) {
              media.play();
              media.addEventListener('ended', function (e) {
                  setTimeout(function(){
                              play2();
                  }, 2000);
              }, false);
          };
    });
}; 
```

下一个音频剪辑 play2() 加载结束，其设置与上面的函数非常相似。出于某种原因，在 IE7/8 中它会连续加载音频。

我虽然也许我可以让 audioPlayer 成为一个全局变量，它每次都会覆盖音频，但这不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T22:09:24.380

使用此版本的函数**play1** mediaelement.js 成功加载：

```
function play1(){
    var audioPlayer = MediaElementPlayer('#player1', {
          success: function (media) {
              media.play();
              media.addEventListener('ended', function (e) {
                  setTimeout(function(){
                              play2();
                  }, 2000);
              }, false);
          }
    });
} 
```

您将 mediaelement.js 库的哪个 js 和 css 插入到文档的 head 部分？**尝试在结束事件侦听**器的开头添加以下行，以强制第一个音频暂停：

```
media.pause(); 
```

如果这不起作用，请尝试销毁第一个音频对象或您的 HTML 容器，前提是您不需要它以供将来参考。不过，这似乎有点矫枉过正。

# sql - 查询列名相同的两个表的内连接，字段列表中的列'exName'不明确

> ID：15036104
> 
> 赞同：7
> 
> 时间：2013-02-23T01:50:31.630
> 
> 标签：sql, inner-join, ambiguous

我正在使用以下查询查询三个表的内部联接。

其中两个表具有名为“name1”的列。我收到以下错误。

```
Column 'exName' in field list is ambiguous 
```

“name1”列是外键，因此信息应该相同。任何人都可以提出一个紧凑的方法来解决这个问题吗？

```
$result = mysql_query("SELECT name1,name2,name3 FROM `table1` INNER JOIN `table2` ON table2.name1=table1.PrimaryKey INNER JOIN `table3` ON table3.name1=table1.PrimaryKey"); 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-23T01:58:53.560

您需要使用表名限定列名。

```
 SELECT table1.name1, table2.name1, etc. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T02:01:43.987

您需要将选择列表中的列称为：

`SELECT <table name>.name1, <table name>.name2, <table name>.name3`

当您在 from 子句中引入表时，您还可以给表一个别名，以节省一些击键并使事情变得更简洁：

```
SELECT 
     t1.name1
    ,t2.name2
    ,t3.name3
FROM table1 AS t1
INNER JOIN table2 AS t2
    ON t2.name1 = t1.PrimaryKey
INNER JOIN table3 AS t3
    ON t3.name1 = t1.PrimaryKey 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-31T19:50:52.603

也许不是正确的问题，但我们如何能够创建这样的东西：

```
Table a
-------
id | x | y 
1 | 2 | 3 
```

```
Table b
-------
id | a_id | x | y 
1  | 1    | 2 | 3 
```

## SQL

```
SELECT * FROM
JOIN a.id = b.a_id 
```

结果会是这样的：

```
array(
    a.id: 1,
    b.id: 1,
    a.x: 2
) 
```

## 我的意思是什么

具有相同的表`column names`被合并，我猜第一个表的 ID 获胜。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T02:00:04.327

```
SELECT T1.name1,T2.name2,T3.name3 
FROM `table1` T1 
INNER JOIN `table2` T2 ON t2.name1=t1.PrimaryKey 
INNER JOIN `table3` T3 ON t3.name1=t1.PrimaryKey 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-10-15T15:04:25.070

确实，您必须使用表名来分隔列。例如，

```
 SELECT table1.name1, table2.name1, etc. 
```

正如@dud3 解释了`name1`table1中的列名`table1.name1`覆盖 table2中的列名的问题`table2.name1`。

您可以`AS`在选择它们时使用该语句，以便在数组中单独接收它们。例如

```
SELECT table1.name1, table2.name1 AS table2_name1, etc. 
```

您可以使用任何不同的列名来表示`table2_name1`。在这里，您将在形成的数组中使用不同的列名。

# angularjs - AngularJS 范围

> ID：15036105
> 
> 赞同：0
> 
> 时间：2013-02-23T01:50:35.950
> 
> 标签：angularjs

我在尝试使用 angularjs 引用模型时遇到了问题。我可以让其中一些参考，但其他一些不起作用。我已包含以下代码：

```
function DeleteCustomers($scope, func) {
     $scope.delete = function() {
         func.deleteCustomer($scope.customer);
     }
 }

function UpdateCustomers($scope, func) {
    $scope.update = function() {
        func.updateCustomer({ name: $scope.name2, telephone: $scope.telephone2,
            email: $scope.email2, street: $scope.street2,
            city: $scope.city2, zipcode: $scope.zipcode2 });
        }
    }
} 
```

html是

```
<div ng-controller="UpdateCustomers">
       <form class="test-angular-update">
           <input type="text" ng-model="name2"><br>
           <input type="text" ng-model="telephone2"><br>
           <input type="text" ng-model="email2"><br>
           <input type="text" ng-model="street2"><br>
           <input type="text" ng-model="city2"><br>
           <input type="text" ng-model="zipcode2"><br>
           <button class="button" ng-click="update()">Update</button><br>
       </form>
   </div>

   <br><br>
   <div ng-controller="DeleteCustomers">
       <form class="text-angular-delete">
           Customer Name <input type="text" ng-model="customer"><br>
           <button class="button" ng-click="delete()">Delete</button><br>
       </form>
   </div> 
```

控制器无法引用 UpdateCustomers 和 DeleteCustomers 中的所有模型。任何帮助，将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T18:38:02.333

这是一个更可靠的应用程序结构，它可能有助于确保正确注入 func 服务。不确定这是否是您遇到的问题。

```
//app.js
var app = angular.module('app', []);

//services.js
app.factory('func', function(){/* service code*/});

//controllers.js
app.controller('DeleteCustomers', ['$scope', 'func', function($scope, func){
   $scope.delete = function() {
     func.deleteCustomer($scope.customer);
   };
}]);//edit had typo here missing ']' 
```

编辑：工作演示[http://jsfiddle.net/grendian/Um3pR/](http://jsfiddle.net/grendian/Um3pR/)

# java - 将 AsYouTypeFormatter 与 JTextField 一起使用

> ID：15036117
> 
> 赞同：1
> 
> 时间：2013-02-23T01:52:17.950
> 
> 标签：java, swing, jtextfield, documentfilter, libphonenumber

我想使用 LibPhoneNumber ( [http://code.google.com/p/libphonenumber/](http://code.google.com/p/libphonenumber/) ) 中的 AsYouTypeFormatter 和 JTextField 来格式化电话号码。但是，我不能使用文档侦听器来更改 JTextField 中的文本，并且 ActionListener 仅在单击鼠标时才起作用。我看到的所有其他问题都涉及使用适用于 Android 的 AsYouTypeFormatter，但我正在制作一个桌面应用程序。

```
phoneUtil = PhoneNumberUtil.getInstance();
formatter = phoneUtil.getAsYouTypeFormatter("US");

addPhoneF = new JTextField(20);
addPhoneF.getDocument().addDocumentListener(this);

    @Override
public void insertUpdate(DocumentEvent e) {
    // TODO Auto-generated method stub
    String unformattedNumber = addPhoneF.getText();
    String formattedNumber = "";
    for (int i = 0; i<unformattedNumber.length() - 1; i++) {
        formattedNumber += formatter.inputDigit(unformattedNumber.charAt(i));
    }
    addPhoneF.setText(formattedNumber);
}   

@Override
public void removeUpdate(DocumentEvent e) {
    // TODO Auto-generated method stub
    String unformattedNumber = addPhoneF.getText();
    String formattedNumber = "";
    for (int i = 0; i<unformattedNumber.length() - 1; i++) {
        formattedNumber += formatter.inputDigit(unformattedNumber.charAt(i));
    }
    addPhoneF.setText(formattedNumber);
}

@Override
public void changedUpdate(DocumentEvent e) {
    // TODO Auto-generated method stub
    String unformattedNumber = addPhoneF.getText();
    String formattedNumber = "";
    for (int i = 0; i<unformattedNumber.length() - 1; i++) {
        formattedNumber += formatter.inputDigit(unformattedNumber.charAt(i));
    }
    addPhoneF.setText(formattedNumber);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T01:57:18.363

也许您想使用 DocumentFilter，而不是 DocumentListener。前者将允许代码在发生之前尝试对 Document 进行更改，我相信这就是您想要的。

# key-bindings - Java中的KeyBindings在组件重新制作后停止工作

> ID：15036118
> 
> 赞同：0
> 
> 时间：2013-02-23T01:52:18.900
> 
> 标签：key-bindings

我的 JPanel 的 KeyBindings 工作正常，直到我从 JFrame 中删除 JPanel，创建一个新的 JPanel 对象，然后将其添加到 JFrame。

KeyBinding 方法在新的 JPanel 对象上再次运行，但 Keys 不执行任何操作。

这是我为显示我的问题而制作的两个类：

```
public class KeyBindingsTester {

    static JFrame jf;
    static KeyBindingPanel kp;

public static void main(String[] args){
    new KeyBindingsTester(); 
}
public KeyBindingsTester(){

    jf = new JFrame();
    kp = new KeyBindingPanel();

    jf.add(kp, BorderLayout.CENTER);
    jf.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    jf.setVisible(true);
}
public static void reset(){
    jf.remove(kp);
    kp = new KeyBindingPanel();
    jf.add(kp,BorderLayout.CENTER);
            jf.setVisible(true);
}
} 
```

--------- 和小组：

```
public class KeyBindingPanel extends JPanel{

public KeyBindingPanel(){
    setUpKeyBindings();
    System.out.println("Keybindings set up");
}
public void setUpKeyBindings(){

    addKeyBinding("B");
    addKeyBinding("R");
}
public void addKeyBinding(String key){

    getInputMap().put(KeyStroke.getKeyStroke(key), key);
    getActionMap().put(key, new KeyBindingAction(key));
}

public class KeyBindingAction extends AbstractAction{

    String action;
    public KeyBindingAction(String actionName){
    action = actionName;
}
public void actionPerformed(ActionEvent e){
    if(action.equals("R")){
        KeyBindingsTester.reset();
    }
    if(action.equals("B")){
        System.out.println("BBB");
    }
}
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T05:21:38.483

问题是焦点不在所讨论的 JPanel 上。

改变这个： getInputMap().put(KeyStroke.getKeyStroke(key), key);
为此： getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW).put(KeyStroke.getKeyStroke(key), key);

# php - html表单无法传递给php

> ID：15036120
> 
> 赞同：0
> 
> 时间：2013-02-23T01:52:39.830
> 
> 标签：php, html, forms

传递-var.php

```
`<form method="post" action="catching-var.php">
 <input type="text" name="name1"/><br/>
 <input type="text" name="name2"/><br/>
 <input type="text" name="name3"/><br/>
 <input type="text" name="name4"/><br/>
 <input type="submit" name="submit"/>
  </form>` 
```

捕捉-var.php

```
<?php 
 $name0 = $_POST['name0'];
 $name1 = $_POST['name1']; 
 $name2 = $_POST['name2']; 
 $name3 = $_POST['name3']; 
 $name4 = $_POST['name4'];

 echo $name0.'<br/><br/>'; 
 echo $name1.'<br/><br/>'; 
 echo $name2.'<br/><br/>'; 
 echo $name3.'<br/><br/>'; 
 echo $name3.'<br/><br/>';
 ?> 
```

我已经搜索了大多数关于通过 php 变量传递变量的 html 表单的网站。我不明白为什么我的表单从 pass-var.php 不能将变量传递给 catch-var.php 。我检查了几个代码次，仍然无法找出问题所在.. 帮助将不胜感激.. 谢谢.. PS：我对 php 非常陌生，并且处于学习阶段

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T05:45:06.323

这在您的表单中不存在：

```
$name0 = $_POST['name0']; 
```

可能会说 $name0 未设置。但另一个名称变量应该可以正常工作。

在你的 catch-var.php 中尝试这样做。

```
if(isset($_POST['submit'])){

 $name1 = $_POST['name1']; 
 $name2 = $_POST['name2']; 
 $name3 = $_POST['name3']; 
 $name4 = $_POST['name4'];

 echo $name1.'<br/><br/>'; 
 echo $name2.'<br/><br/>'; 
 echo $name3.'<br/><br/>'; 
 echo $name3.'<br/><br/>';

} 
```

还要确保您的文件位于同一目录中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T02:42:24.510

在尝试使用它之前，您需要检查是否设置了 POST 变量。因此，由于您没有包含在表单中，因此当您尝试访问它时会出现错误。您可以检查是否已设置 var

```
$name0 = (isset($_POST['name0']) ? $_POST['name0'] : 'not set'); 
```

# scala - 在 Play2 / Scala 中从内存中的 MultipartFormData 中提取文件

> ID：15036121
> 
> 赞同：10
> 
> 时间：2013-02-23T01:52:44.313
> 
> 标签：scala, file-upload, playframework-2.0, buffer

我目前正在使用 FileUploader Javascript 实用程序将以下文件与 Play2/Scala 一起使用，以将文件上传到我的服务器：

```
def fileUploader = Action(parse.multipartFormData) { request =>
  request.body.file("qqfile").map { picture =>
    import java.io.File
    val filename = picture.filename 
    val contentType = picture.contentType
    picture.ref.moveTo(new File("/tmp",filename))
    Ok(Json.toJson(Map( "success" -> "true" )))
  }.getOrElse {
    Ok(Json.toJson(Map( "error" -> "error occured")))
  }
} 
```

我只处理小文件（<10MB），我想使用 casbah 使用 Mongo 驱动程序将这些文件直接写入 Mongo Document 或 GridFS。我意识到我可以从磁盘读取保存的文件，但是有没有办法从内存中处理这一切，而不需要先在磁盘上缓冲文件？

此处的播放文档建议编写自定义 BodyParser ( [http://www.playframework.com/documentation/2.1.0/ScalaFileUpload](http://www.playframework.com/documentation/2.1.0/ScalaFileUpload) )，但似乎没有任何关于如何编写的文档。目前尚不清楚 Scaladocs 中的 API/实现是如何工作的。我尝试查找 MultiPartFormData 源代码以查看它是如何工作的，但我似乎无法在他们的 Git 存储库中找到它：

[https://github.com/playframework/Play20/tree/master/framework/src/play/src/main/scala/play/api/mvc](https://github.com/playframework/Play20/tree/master/framework/src/play/src/main/scala/play/api/mvc)

我已经搜索了很多，但似乎找不到一个很好的例子。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-23T12:07:31.600

*未经* 测试的`Multipart`对象`BodyParsers`为我们做了很多工作。我们需要做的第一件事就是为`FilePart`. 我在这里假设您希望文件部分是`Array[Byte]`.

```
def handleFilePartAsByteArray: PartHandler[FilePart[Array[Byte]]] =
  handleFilePart {
    case FileInfo(partName, filename, contentType) =>
      // simply write the data to the a ByteArrayOutputStream
      Iteratee.fold[Array[Byte], ByteArrayOutputStream](
        new ByteArrayOutputStream()) { (os, data) =>
          os.write(data)
          os
        }.mapDone { os =>
          os.close()
          os.toByteArray
        }
  } 
```

下一步是定义你的身体解析器：

```
def multipartFormDataAsBytes:BodyParser[MultipartFormData[Array[Byte]]] = 
  multipartFormData(handleFilePartAsByteArray) 
```

然后，为了使用它，在你指定它`Action`：

```
def fileUploader = Action(multipartFormDataAsBytes) { request =>
  request.body.files foreach {
    case FilePart(key, filename, contentType, bytes) => // do something
  }
  Ok("done")
} 
```

以上代码中的一些类型和方法有点难找。以下是您需要时的完整导入列表：

```
import play.api.mvc.BodyParsers.parse.Multipart.PartHandler
import play.api.mvc.BodyParsers.parse.Multipart.handleFilePart
import play.api.mvc.BodyParsers.parse.Multipart.FileInfo
import play.api.mvc.BodyParsers.parse.multipartFormData
import play.api.mvc.MultipartFormData.FilePart
import play.api.libs.iteratee.Iteratee
import java.io.ByteArrayOutputStream
import play.api.mvc.BodyParser
import play.api.mvc.MultipartFormData 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-08-08T20:56:43.050

自发布以来，Play API 发生了相当大的变化。我有一个类似的用例，我不想要临时文件并将上面的内容翻译成以下内容，这似乎适用于 Play 2.6，以防有人需要：

```
def byteStringFilePartHandler: FilePartHandler[ByteString] = {
    case FileInfo(partName, filename, contentType) =>
      Accumulator(Sink.fold[ByteString, ByteString](ByteString()) { (accumulator, data) =>
        accumulator ++ data
      }.mapMaterializedValue(fbs => fbs.map(bs => {
        FilePart(partName, filename, contentType, bs)
      })))
}

def multipartFormDataAsBytes: BodyParser[MultipartFormData[ByteString]] =
  playBodyParsers.multipartFormData(byteStringFilePartHandler) 
```

在控制器中使用它确保您在下面注入`PlayBodyParsers`并提供一个`ExecutionContext`, 导入等：

```
import akka.stream.scaladsl.Sink
import akka.util.ByteString
import javax.inject._
import play.api.libs.streams.Accumulator
import play.api.mvc.MultipartFormData.FilePart
import play.api.mvc._
import play.core.parsers.Multipart.{FileInfo, FilePartHandler}
import scala.concurrent.ExecutionContext

@Singleton
class HomeController @Inject()(cc: ControllerComponents, playBodyParsers: PlayBodyParsers)
                              (implicit ec: ExecutionContext) extends AbstractController(cc) {

  def index = Action(multipartFormDataAsBytes) { request =>
    request.body.file("image").foreach((image) => {
      val arr = image.ref.toByteBuffer.array()
      println(arr)
    })
    Ok("got bytes!")
  }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-01-10T18:05:57.713

继马特的回答（嗨，马特！）之后，我最终需要为 Play 2.8 稍微调整一下（我怀疑 API 会进一步发展）：

```
 def byteStringFilePartHandler: FilePartHandler[ByteString] = {
    case FileInfo(partName, filename, contentType, dispositionType) =>
      Accumulator(Sink.fold[ByteString, ByteString](ByteString()) { (accumulator, data) =>
        accumulator ++ data
      }.mapMaterializedValue(fbs => fbs.map(bs => {
        FilePart(partName, filename, contentType, bs)
      })))
  }

  def multipartFormDataAsBytes: BodyParser[MultipartFormData[ByteString]] =
    controllerComponents.parsers.multipartFormData(byteStringFilePartHandler) 
```

由于我的用例是上传文本文件，因此我从结果中提取`request`：

```
 val body: String = request.body.files.head.ref.utf8String 
```

（为了安全起见，这里会使用一些不那么快速和肮脏的代码`headOption`。）

# javascript - 如何获取诺基亚地图中可拖动标记的经度和纬度？

> ID：15036123
> 
> 赞同：1
> 
> 时间：2013-02-23T01:52:54.150
> 
> 标签：javascript, here-api

我找到了这段代码，它工作得很好，但我想知道如何获取可拖动标记的信息、经度和纬度。这是代码：可 [拖动标记](http://pastebin.com/rQTFmz7Z)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T23:17:46.373

如果要在地图控件中（或之后）拖动标记时检索标记的坐标，可以使用专用事件。

这是基于您的代码的更新版本：

```
// Place this anywhere in the world.
var draggableMarker = new nokia.maps.map.StandardMarker([52.500556, 13.398889], 
{  
text:  "X",  
brush: {color: '#FF0000'} ,                 
draggable: true,                     
});   

// Add the listener function to the bubbling phase of the "dragend" event
draggableMarker.addListener("dragend", function(e) {
    var coordinate = display.pixelToGeo(e.displayX, e.displayY);
    alert(coordinate);
}, false);
// Add the marker to the map.
display.objects.add(draggableMarker); 
```

这里也是一个完整的例子：http: [//developer.here.com/apiexplorer/examples/api-for-js/markers/draggable-markers.html](http://developer.here.com/apiexplorer/examples/api-for-js/markers/draggable-markers.html)

# ruby-on-rails-3 - 如何绕过 active_admin 中的设计模型密码

> ID：15036124
> 
> 赞同：0
> 
> 时间：2013-02-23T01:53:06.620
> 
> 标签：ruby-on-rails-3, devise, activeadmin

我有一个需要在 active_admin 中编辑的设计用户模型。有什么方法可以绕过每次保存时更新该模型的密码的需要。如果管理员用户能够更新用户帐户而无需知道或更改他们的密码，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T14:09:51.847

尝试将其放入您的用户模型中（这些是设计覆盖......）

```
def password=(new_password)
  return '' if new_password.blank?
  @password = new_password
  self.encrypted_password = password_digest(@password) if @password.present?
end

def password_required?
  !persisted? || !password.blank? || !password_confirmation.blank?
end 
```

祝你好运。现在，如果您将密码输入字段都保留为空，它应该可以工作。

# android - Android：如何将文件从库项目写入内部存储器？

> ID：15036131
> 
> 赞同：2
> 
> 时间：2013-02-23T01:54:27.293
> 
> 标签：android, file-io, permissions

从一个源自外部应用程序的 android 库项目，

`fos = openFileOutput(CFG_NAME, Context.MODE_PRIVATE);`

返回一个`java.lang.NullPointerException`

该函数在类扩展中使用`Activity`。我如何使用这个库中的内部存储器？

# ios - UIGesture 返回 UIImageView 而不是自定义视图

> ID：15036132
> 
> 赞同：0
> 
> 时间：2013-02-23T01:54:34.143
> 
> 标签：ios, objective-c, uitapgesturerecognizer, responder-chain

我在我的 rootview 中添加了一个自定义视图并添加了一个 UITapGesture。当调用 UITapGesture 代码的“sender.view”时，它不再由我的自定义 UIView 表示，而是“sender.view”的类型为 UIImageView。

因此，当 iOS 期待 UIView 时，向我的自定义视图发送消息真的很困难——我得到的警告是：“不兼容的指针类型将 UIView 发送到参数 CardView（我的自定义视图）。

我认为这与响应链有关；文档说 - “当 iOS 识别一个事件时，它会将事件传递给看起来与处理该事件最相关的初始对象，例如发生触摸的视图。” -*关于 iOS 中的事件*

这里的关键字是“似乎”——我如何告诉 iOS 我的自定义视图是应该处理手势的？

问题：如何让 sender.view 直接引用我的自定义视图？

下面是一些代码：

```
//Creates the Card's view
CardView *cardView = [[CardView alloc]initWithFrame:CGRectMake(0, 0, 67,99)];
//For Single Tap
UITapGestureRecognizer *tapGesture = [[UITapGestureRecognizer alloc]initWithTarget:self action:@selector(handleSingleTapGesture:)];
[cardView addGestureRecognizer:tapGesture];
[self.view addSubview:cardView]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T10:02:17.053

在`handleSingleTapGesture:`将给你`(UITapGestureTecongnizer *)sender`这样的演员：

```
CardView *card = (CardView *)sender.view;
//do you stuff with card 
```

# ajax - AngularJS / AJAX 应用程序和搜索引擎爬虫

> ID：15036133
> 
> 赞同：1
> 
> 时间：2013-02-23T01:54:35.543
> 
> 标签：ajax, seo, angularjs, googlebot

我有一个大量使用 AngularJS / AJAX 的网络应用程序，我希望它可以被 Google 和其他搜索引擎抓取。我的理解是我需要做一些特别的事情才能使它工作，如下所述：[https ://developers.google.com/webmasters/ajax-crawling](https://developers.google.com/webmasters/ajax-crawling)

不幸的是，这看起来很讨厌，我宁愿不介绍哈希标签。我想做的是直接或通过向其发送 302 重定向向 Googlebot（基于用户代理）提供静态页面。这样一来，网络应用程序就可以保持不变，并且整个 Googlebot 变通方法被很好地隔离，直到不再需要它为止。

我担心 Google 可能会错误地认为我在试图欺骗 Googlebot，而我的目标是帮助它。你们如何看待这种方法，你会推荐什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T09:03:05.437

最近我看到了[yearofmoo 的这篇出色的帖子](http://www.yearofmoo.com/2012/11/angularjs-and-seo.html)，详细解释了如何使您的 Angular 应用程序 SEO 友好。本质上，当机器人看到带有哈希标签的 uri 时，它们会知道这是一个 ajaxed 页面，并会尝试通过替换“#！”来访问相同的 uri。在你的 uri 中使用 '?_escaped_fragment_='。这个替代 uri 指示机器人他们应该期望找到他们正在访问的页面的确定静态版本。

当然，要实现这一点，您必须在 uri 中引入哈希标签。我不明白你为什么要试图避免它们。gmail不是使用哈希标签吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T09:12:59.710

是的，不幸的是，如果你想被索引 - 你必须遵守该方案:(如果你运行一个 ruby​​ 应用程序 - 有一个 gem 可以为任何机架应用程序实现爬取方案....

```
gem install google_ajax_crawler 
```

关于如何使用它的文章位于[http://thecodeabode.blogspot.com.au/2013/03/backbonejs-and-seo-google-ajax-crawling.html](http://thecodeabode.blogspot.com.au/2013/03/backbonejs-and-seo-google-ajax-crawling.html)，源代码位于 [https://github.com/benkitzelman /google-ajax-crawler](https://github.com/benkitzelman/google-ajax-crawler)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-10T23:56:08.140

看看这些链接，它会给你一个很好的方向：

*   使用 Prerender.io 开源代码设置您自己的 Prerender 服务：

    ```
     https://prerender.io/ 
    ```

*   使用不同的现有服务，例如 BromBone、Seo.js 或 SEO4AJAX：

    ```
     http://www.brombone.com/
      http://getseojs.com/
      http://www.seo4ajax.com/ 
    ```

*   创建您自己的服务以向搜索引擎呈现和提供快照。阅读这篇文章。它会给你一个大图景：

    ```
     http://scotch.io/tutorials/javascript/angularjs-seo-with-prerender-io 
    ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-22T15:58:26.310

截至 2014 年 5 月，GoogleBot 现在执行 JavaScript。检查 WebmasterTools 以了解 Google 如何看待您的网站。

[http://googlewebmastercentral.blogspot.no/2014/05/understanding-web-pages-better.html](http://googlewebmastercentral.blogspot.no/2014/05/understanding-web-pages-better.html)

编辑：请注意，这并不意味着其他爬虫（Bing、Facebook 等）将执行 Javascript。您可能仍需要采取其他步骤来确保这些爬虫可以看到您的网站。

# bash - 在 virsh 或 sudoers 的脚本中使用 sed 和 EDITOR 变量

> ID：15036134
> 
> 赞同：3
> 
> 时间：2013-02-23T01:54:37.730
> 
> 标签：bash, sed

**长话短说，我需要下面的命令才能在 bash 脚本中工作。**

我需要更改虚拟 kvm 正在使用的网络子网。让我感到困难的是试图让它作为命令进行更改。通常，您运行命令 sudo **virsh net-edit default**它会打开一个 vi（或其他）会话，然后您进行编辑并关闭。

**net-edit**选项允许用户使用他们喜欢的编辑器编辑虚拟网络的 XML 配置。net-edit 启动命令（或脚本）在用户 $EDITOR 环境变量中定义，将虚拟网络的 XML 配置的临时副本传递给它。

当用户退出编辑器时，net-edit 检查临时文件是否已更改。

所以对我来说，我想通过 sed 传递它，这样我就可以在脚本中使用它。以下示例可以从命令行运行，但它不适用于我的脚本。我不确定我做错了什么，但我还没有弄清楚。如果有人有想法，将不胜感激。

这适用于命令行，但不适用于脚本。获取有关命令的错误消息：

```
 EDITOR='sed -i "s/192.168.100.1/192.168.11.1/g"' virsh net-edit default 
```

这是一个相关的线程： [Changing the dhcp IP range in Virbr0's XML file using virsh in bash script](https://stackoverflow.com/questions/14365391/changing-the-dhcp-ip-range-in-virbr0s-xml-file-using-virsh-in-bash-script)

这是错误信息

./test: line 2: export: `net-edit': 不是一个有效的标识符

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T22:00:13.223

我在几个方面遇到了 sed 命令的问题，有一次我忘记以 root 权限运行它，所以简而言之，上面的命令将在脚本中工作。

# r - 使用动物园读取并在列上拆分数据框

> ID：15036136
> 
> 赞同：2
> 
> 时间：2013-02-23T01:55:15.583
> 
> 标签：r, time-series, zoo

我有一个表格，其中包含对`restaurants`（由 ID 标识）分数的观察。变量`mean`是在以每天为中心的一周窗口中收到的评论的平均评分（即从前 3 天到 3 天后），变量`count`是在同一窗口中收到的评论数量（参见下面的代码a`dput`我的数据框的随机生成样本）。

我有兴趣查看那些在任一变量中都包含大峰值的餐厅（比如突然间他们的平均评分上升了很多，或者突然下降了）。对于那些餐馆，我想通过绘制分布来调查发生了什么（我有很多餐馆，所以我不能手动进行，我必须限制我的域以进行半手动检查）。

此外，由于我的数据是每天的，我希望它不那么精细。特别是，我想在一个值中平均给定月份的所有评级或计数。

我认为动物园应该帮助我做得很好：给定示例中的数据框，我想我可以将其转换为动物园时间序列，该时间序列以我想要的方式聚合并通过使用以下方式拆分我想要的方式：

```
z <- read.zoo(df, split = "restaurantID", 
       format = "%m/%d/%Y", index.column = 2, FUN = as.yearmon, aggregate = mean) 
```

但是，在 restaurantID 上拆分不会产生预期的结果。我得到的是很多 NA：

```
 mean.1006054 count.1006054 mean.1006639 count.1006639 mean.1006704 count.1006704 mean.1007177 count.1007177
Lug 2004           NA            NA           NA            NA           NA            NA           NA            NA
Ago 2004           NA            NA           NA            NA           NA            NA           NA            NA
Nov 2004           NA            NA           NA            NA           NA            NA           NA            NA
Gen 2005           NA            NA           NA            NA           NA            NA           NA            NA
Feb 2005           NA            NA           NA            NA           NA            NA           NA            NA
Mar 2005           NA            NA           NA            NA           NA            NA           NA            NA
         mean.1007296 count.1007296 mean.1007606 count.1007606 mean.1007850 count.1007850 mean.1008272 count.1008272
Lug 2004           NA            NA           NA            NA           NA            NA           NA            NA
Ago 2004           NA            NA           NA            NA           NA            NA           NA            NA
Nov 2004           NA            NA           NA            NA           NA            NA           NA            NA
Gen 2005           NA            NA           NA            NA           NA            NA           NA            NA
Feb 2005           NA            NA           NA            NA           NA            NA           NA            NA
Mar 2005           NA            NA           NA            NA           NA            NA           NA            NA 
```

请注意，如果我不在 restaurantID 列上拆分它，它会起作用。

```
df$website <- NULL
> z <- read.zoo(df, format = "%m/%d/%Y", index.column = 2, FUN = as.yearmon, aggregate = mean)
> head(z)
         restaurantID     mean count
Lug 2004      1418680 3.500000     1
Ago 2004      1370457 5.000000     1
Nov 2004      1324645 4.333333     1
Gen 2005      1425933 1.920000     1
Feb 2005      1315289 3.000000     1
Mar 2005      1400577 2.687500     1 
```

此外，`plot.zoo(z)`有效，但生成的图表对我来说当然没有意义。

我的问题是：

1) 如何筛选在任一列中具有较高“月-月”峰值的餐厅？

2）如何拆分 restaurantID 并仅绘制此类餐厅的时间​​序列？

[此处的数据（不符合 SO 的字数限制）](http://pastebin.com/raw.php?i=4N9C0fVq)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T06:09:08.927

开发了 robfilter r 包，用于过滤时间序列数据，以基于稳健的统计方法挑选出异常值以进行时间序列分析。您可以使用 adore.filter 函数将模式拟合到数据中，然后选择远离信号的异常值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T03:51:02.700

尝试：

```
# helper function to calculate change per time interval in a sequence
difflist <- function(v) {rr <- 0; for (i in 2:length(v)) {rr <- c(rr, v[i] - v[i-1])}; return(rr) }

# make center as dates
df$center <- as.Date(df$center,format='%m/%d/%Y')

# sort data frame in time order
df <- df[order(df$restaurantID, df$center),]

# now calculate the change in each column
deltas <- ddply(df, .(restaurantID), function(x) {cbind(center = x$center, delta_mean = difflist(x$mean), delta_count = difflist(x$count)) } )

# filter out only the big spikes
deltas_big <- subset(deltas, delta_mean > 2 | delta_count > 3)

# arrange the data
delta_melt <- melt(deltas_big,id.vars=c('restaurantID','center'))

# now plot by time
ggplot(delta_melt, aes(x=center,y=value,color=variable)) + geom_point() 
```

# jquery - jQuery 调整 CSS 元素的大小

> ID：15036139
> 
> 赞同：0
> 
> 时间：2013-02-23T01:55:53.323
> 
> 标签：jquery, css, resize, scale

我知道如何使用 CSS 解决我的问题。我需要设置从像素到百分比的每一个值，其中有 1000 个（有趣的时间！）。无论我是在事后还是在进行时这样做，总是很痛苦。我已经能够更快地设计避免它以支持像素，但现在希望一起避免它。

我假设使用 CSS 百分比（我的整个页面是固定的纵横比，所以实际上每个元素都需要转换为百分比）将是最轻量级的解决方案，但我希望可能存在一些可以调整元素大小的 jQuery 脚本？

有一次我想尝试访问浏览器缩放，但这似乎是不可能的。这是我对另一种方法的最后一次尝试。如果我不能做某事......我将不得不把它吸起来并将我所有的元素转换成百分比（真的应该有一个工具来为你做这件事！）。

任何和所有的帮助表示赞赏。谢谢！

编辑*这是一个描绘网站简单结构的小提琴：http: [//jsfiddle.net/hkdeA/4/](http://jsfiddle.net/hkdeA/4/)。我包含了一些代码来尝试扩展外部容器。如果所有内部容器都是 CSS 百分比，它会起作用，但我有 1000 个值要翻译，一个简单的脚本来调整所有元素的大小将节省大量的时间、精力和精力。

```
 <div id="container">
    <div id="vid">

    </div>
    <div id="sidebar">

    </div>
    <div id="footer">

    </div>    
</div>

#container{
    background:grey;
    width:480px;
    height:270px;
    float:left;
}

#vid{
    background:black;
    width:320px;
    height:180px;
    float:left;
}

#sidebar{
    background:blue;
    width:160px;
    height:180px;
    float:right;
}

#foot{
    background:yellow;
    width:480px;
    height:90px;
    float:left;
} 
```

最终目标：让我的网站应用程序调整到浏览器窗口的 100% 宽度或高度（取决于窗口的纵横比）。我知道可以使用 CSS 百分比和脚本来更改包含 div 的大小。但是，我想用脚本更改所有 div，以避免将我拥有的每个固定值转换为百分比的乏味。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:47:12.677

尝试这样的事情：

```
var list = [];
var containerW = $("#container").width();
var containerH = $("#container").height();
$("#container").find("*").each(function(){
  var obj = {};
  obj.w = $(this).width() * 100 / containerW;
  obj.h = $(this).height() * 100 / containerH;
  obj.el = $(this);
  list.push(obj);
});

for (var i in list) {
  var obj = list[i];
  obj.el.width(obj.w+'%');
  obj.el.height(obj.h+'%');
}

$("#container").width('100%');
// if you want height also to be 100%
$("#container").height('100%'); 
```

你可以在这里测试它：http: [//jsbin.com/izubed/1/edit](http://jsbin.com/izubed/1/edit)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T02:39:05.360

你在寻找这样的东西吗？

```
$('div').each(function(i,v){
  if($(v).width() > 0){
    $(v).width('auto');
  }
}); 
```

# maven - 如何让 maven 查找 war 文件而不是 jar 文件？

> ID：15036141
> 
> 赞同：5
> 
> 时间：2013-02-23T01:56:15.017
> 
> 标签：maven

当我在 pom.xml 中添加此依赖项时，Maven 尝试查找 jar 文件而不是 war 文件：

```
<dependency>
    <groupId>org.apache.wicket</groupId>
    <artifactId>wicket-examples</artifactId>
    <version>6.6.0</version>
</dependency> 
```

jar 文件似乎不在[http://repo1.maven.org/maven2](http://repo1.maven.org/maven2)中，但 war 文件存在。我如何让 maven 去寻找战争文件？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-23T02:07:46.900

```
<dependency>
   <groupId>org.apache.wicket</groupId>
   <artifactId>wicket-examples</artifactId>
   <version>6.6.0</version>
   <type>war</type>
</dependency> 
```

# java - 堆栈，队列和从文件中读取数学......奇怪的输出

> ID：15036143
> 
> 赞同：0
> 
> 时间：2013-02-23T01:56:25.447
> 
> 标签：java, stack, queue, infix-notation

你好，Stackoverflow，

我正在为后缀计算器创建中缀。计算器必须从文件中读取输入，然后使用堆栈和队列来创建后缀符号。我有我所有的代码来读取文件并在队列中创建后缀符号。我正在读取的文件包含：

> (4>3)+(3=4)+2

这是我在队列中放入后缀符号的代码：

```
import java.io.*;
import java.util.ArrayList;

public class Proj1Main {

    public static void main(String[] args) {

        readMathFile();
        q.printQueue();

    }

    public static void readMath(char c, myStack s, myQueue q) {
        if (c == '0' || c == '1' || c == '2' || c == '3' || c == '4' || c == '5' || c == '6' || c == '7' || c == '8' || c == '9') {
            System.out.println("NUMBER"); // <--for testing.
            int o = (int)c;
            q.enqueue(o);
        } else if(c == '+' || c=='-') {
            System.out.println("+ or -");
            Object x = s.pop();
            while( !s.isEmpty() ) {
                q.enqueue(x);
                x = s.pop();
            }
        } else if(c == '(' || c == ')' || c == '!' || c == '<' || c == '>' || c == '&' || c == '|' || c == '=') {
            System.out.println("other operator"); // <--for testing.
            Object x = s.pop();
            char y = x.toString().charAt(0);
            while( !s.isEmpty() && (y != '\\' || y != '*') ) {
                q.enqueue(y);
                y = (Character)s.pop();
                if(y != '\\' || y != '*') {
                    q.enqueue(y);
                    s.push(x);
                }
            }
        } else if(c=='\\' || c == '*') {
            System.out.println("divide or multiply"); // <--for testing.
            Object x = s.pop();
            while( !s.isEmpty() ) {
                q.enqueue(x);
                x = s.pop();
            }
        } else if(c == ')') {
            System.out.println("close paren"); // <--for testing.
            Object x = s.pop();
            while( !s.isEmpty() && x != "(" ) {
                q.enqueue(x);
                x = s.pop();
            }
        }
    }

    public static myStack s;
    public static myQueue q;

    // the file reading code was borrowed from:
    // http://www.java2s.com/Code/Java/File-Input-Output/Readfilecharacterbycharacter.htm
    public static void readMathFile() {
        s = new myStack();
        q = new myQueue();
        File file = new File("test.txt");
        if (!file.exists()) {
            System.out.println(file + " does not exist.");
            return;
        }
        if (!(file.isFile() && file.canRead())) {
            System.out.println(file.getName() + " cannot be read from.");
            return;
        }
        try {
            FileInputStream fis = new FileInputStream(file);
            char current;
            // in this while loop is where all of the reading happens
            while (fis.available() > 0) {
                current = (char) fis.read();
                readMath(current, s, q);
            }
            if(fis.available() == 0) {
                Object x = s.pop();
                while(!x.equals("empty stack"))
                    q.enqueue(s.pop());
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

} 
```

运行代码后，我打印输出结果是：

> 排队：52 51 51 52 50

我不知道 52、51 等是从哪里来的。它应该是“4>33=4+2+”（我想）我想知道是否有人能找出我的问题？或者给我一些关于如何解决它的提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:11:59.810

52 51 51 52 50... 分别是字符“4”、“3”、“3”、“4”、“2”的ASCII码。

当你在做：

```
current = (char) fis.read(); 
```

您正在获取角色本身。

稍后在 readMath() 中：

```
int o = (int)c; 
```

您正在转换一个整数并将其放入队列中。可能当您打印队列时，它仍然是一个整数，并且以 ascii 代码的形式出现。

您可以通过执行以下操作将数字 char 转换为它表示的整数：

```
Character.getNumericValue(c); 
```

# c# - 如何让 MouseHover 在同一个表单上更快或更重复地触发

> ID：15036144
> 
> 赞同：2
> 
> 时间：2013-02-23T01:56:59.223
> 
> 标签：c#, winforms

我有 128 个小表单，全部排列在一个更大的 FlowLayoutPanel 中。128 个表单中的每一个都有自己的 onPaint 覆盖：

```
 protected override void OnPaint(PaintEventArgs e)
    {
        foreach (CustomSquare cs in this.customSquares)
        {
            this.formGraphics.FillRectangle(cs.colorBrush, cs.boundingRectangle);
        }
    } 
```

每个表都实现了 MouseHover：

```
 public void customView_MouseHover(object sender, EventArgs e)
    {
        Debug.Print("greetings from table " + this.getTableNumber());
    } 
```

现在，当鼠标在表之间切换时，事件处理程序会重复且轻松地触发，如下所示：

```
greetings from table 3
greetings from table 0
greetings from table 3
greetings from table 0
greetings from table 1 
```

但是很难让 EventHandler 在同一张桌子上反复触发小鼠标移动或者说同一张桌子尺寸内部的移动，如下所示：

```
greetings from table 0
greetings from table 0
greetings from table 0 
```

该程序的主要功能要求我非常频繁且始终如一地知道用户鼠标所在的 128 种形式中的哪一种，并且使用 MouseHover 事件似乎是最好的方法，但我希望它更频繁地触发。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:46:35.063

@Hans Passant 有正确的答案。

从 MouseHover 更改为 MouseMove 让事件触发者的反应时间非常快。

# php - 包括由于某种原因不工作

> ID：15036145
> 
> 赞同：0
> 
> 时间：2013-02-23T01:57:09.020
> 
> 标签：php

在我的 php 代码中有一个部分需要从另一个 php 文件中检索。我尝试通过以下方式完成此操作：

```
include "teams.php?id=".$matchid; 
```

在teams.php中

```
$matchid = $_GET['id'];
echo "MATCH ID IS ".$matchid; 
```

问题是当我直接打开 teams.php?id=".$matchid 时，它会很好地显示匹配 ID

但是包含不起作用 - 我检查了原始页面的源代码 - 没有插入任何代码。有没有办法做我想做的事？我需要从另一个文件中获取 php 代码，同时将 2 个变量传递到该文件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T02:12:35.053

## 问题

问题与[真正包含的](http://php.net/manual/en/reserved.variables.get.php)[内容`$_GET`](http://php.net/manual/en/reserved.variables.get.php)有关：

> 通过 URL 参数传递给当前脚本的变量关联数组。(...)

而且你不会`$matchid`通过 URL 传递给脚本......在这种情况下你不应该。

## 解决方案

但是有办法。PHP 不会在文件之间分隔全局变量，因此一个文件中可用的变量也可以在包含的文件中使用：

*   在文件号 1：

    ```
    // Assume $matchid is defined
    include "teams.php"; 
    ```

*   在文件号 2个（包括一个）：

    ```
    // No need to redefine $matchid - it was defined in the first file
    echo "MATCH ID IS ".$matchid; 
    ```

还要确保`<?php`在文件的开头添加（不需要结束标签）。否则它将被视为文本而不执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T02:02:58.583

问题是当您调用 include 函数时您没有在浏览器中加载该页面，因此您附加的变量没有被作为 URL 查询参数处理。您实际上只是将teams.php 中的所有内容转储到该位置的另一个文件（包括teams.php 的文件）中。

如果您想有效地将​​某些内容传递给teams.php，那么只需在包含之前声明一个变量。

查看[http://php.net/manual/en/function.include.php](http://php.net/manual/en/function.include.php)，一切都会变得清晰。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T02:03:50.157

这不是 include 的工作方式。当你包含一个文件时，它的代码被执行，就好像它被写在它被包含的同一个文件中一样。所以当包含文件有这个变量时，teams.php 将有变量 $matchid，不需要传递它。还有您调用包含的方式不正确。执行您所做的操作会导致 php 在当前目录中查找名为“teams.php?id=0”的文件（将 0 替换为 $matchid 值）。此文件不存在，“teams.php”存在，而不是 URI。可以通过在 URL 前加上“http://”来指定 URL，但是结果可以与 team.php 中的代码一起使用，因为它希望能够读取 php 源代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T02:17:43.137

你可以这样`include "include "teams.php?id={$matchid}";`做 `$matchid = filter_input(INPUT_GET, 'id', FILTER_SANITIZE_STRING); echo "MATCH ID IS {$matchid}";`

如果您将使用此代码，您也将免受注入！我希望你能理解这一点。

# ruby-on-rails - Ruby On Rails：Ajax 刷新部分不工作

> ID：15036149
> 
> 赞同：2
> 
> 时间：2013-02-23T01:57:28.330
> 
> 标签：ruby-on-rails, ruby, ajax

我很难在按下按钮时让我的部分刷新。我想简单地刷新 div，而不是整个页面。这是我的观点：

```
<div id="ajax">
  <%= render 'layouts/confessions' %>
</div> 
```

然后在我的部分`_confessions.html.erb`中，我有一些基本的 html 和两个类似的按钮：

```
<%= form_tag( { :controller => :confessions, :action => :upvote, :id => conf.id }, { :method => :put } ) do %>
    <%= submit_tag 'Like' %>
<% end %> 
```

我的confession_controller.rb：

```
def upvote
  @confession = Confession.find(params[:id])    
  Confession.increment_counter :upvotes, @confession
  respond_to do |format|
    format.js
  end
end 
```

最后，`upvote.js.erb`：

```
$('#ajax').html("<%= escape_javascript(render(:partial => 'confessions')).html_safe %>"); 
```

提交到我的数据库的操作正在运行，但页面现在重定向到 `/upvote?id=9`（id 可以不同），而不是仅仅刷新 div。我究竟做错了什么？我是 Rails 的新手，所以我可能会遗漏一些完全明显的东西......

编辑：这是我的文件夹结构：

我的观点：`views/pages/home.html.erb`

我的部分：`views/layouts/_confessions.html.erb`

我的控制器：`controllers/confessions_controller.rb`

我的 js.erb 文件：`views/confessions/upvote.js.erb`

后`rake routes`

```
 confessions GET    /confessions(.:format)            confessions#index
                POST   /confessions(.:format)            confessions#create
new_confession  GET    /confessions/new(.:format)        confessions#new
edit_confession GET    /confessions/:id/edit(.:format)   confessions#edit
 confession     GET    /confessions/:id(.:format)        confessions#show
                PUT    /confessions/:id(.:format)        confessions#update
                DELETE /confessions/:id(.:format)        confessions#destroy
     upvote            /upvote(.:format)                 confessions#upvote
   downvote            /downvote(.:format)               confessions#downvote
       root            /                                 pages#home 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T11:46:51.457

确保你的 application.js 中有这个

```
//= require jquery
//= require jquery_ujs 
```

仅供参考：[Rails form_for :remote=>true 没有调用 js 方法](https://stackoverflow.com/questions/4227775/rails-form-for-remote-true-is-not-calling-js-method)

然后，改变这个，

```
$('#ajax').html("<%= escape_javascript(render(:partial => 'confessions')).html_safe %>"); 
```

至：

```
$('#ajax').html("<%= escape_javascript(render(:partial => 'layouts/confessions')).html_safe %>"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T02:10:49.003

添加 :remote => true

```
<%= form_tag( { :controller => :confessions, :action => :upvote, :id => conf.id }, { :method => :put, :remote=>true } ) do %> 
```

另外 - 阅读 rails 路线，了解如何设置 PUT 供认/投票的路线。

[http://guides.rubyonrails.org/routing.html#adding-more-restful-actions](http://guides.rubyonrails.org/routing.html#adding-more-restful-actions)

# android - 用边距填充水平列表行上的父级

> ID：15036151
> 
> 赞同：0
> 
> 时间：2013-02-23T01:57:43.367
> 
> 标签：android, listview, margin, android-relativelayout, imagebutton

好的，所以我在 ListView 上有一个水平相对布局，我想要 ListView 上不同行之间的边距，但我有一个问题。我有一个按钮被推到最右边，我希望点击区域尽可能大。如果相对布局的根元素上没有边距，我会很好，我的按钮将占据行的整个高度。但问题是因为有边距，所以用户有机会单击按钮上方和下方的边距以触发 OnItemClick 事件，这不是按钮的所需功能，有时可能会令人沮丧。

例子：

```
<RelativeLayout android:layout_height="match_parent"
                android:layout_width="match_parent"
                android:orientation="horizontal"
                android:layout_marginTop="10dp"
                android:layout_marginBottom="10dp"
                android:layout_marginLeft="5dp">

 <ImageButton
        android:id="@+id/list_button"
        android:layout_alignParentRight="true"
        android:layout_width="wrap_content"
        android:layout_height="fill_parent"
        android:src="@drawable/btn"
        android:background="@android:drawable/list_selector_background" />
</RelativeLayout> 
```

显然，任何帮助将不胜感激，我只是遗憾地看不到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:12:21.693

解决此问题的一种方法是将 ImageButton 包装在一个透明的布局视图（相对、线性、框架 - 取决于您的需要）中，它*确实*占据了整个空间（即 android:layout_width 和 android:layout_height 是 fill_parent）。然后将与按钮相同的单击处理程序添加到外部布局。

# mysql - Mysql View 和/或不同方法的问题？

> ID：15036153
> 
> 赞同：0
> 
> 时间：2013-02-23T01:58:07.757
> 
> 标签：mysql, phpmyadmin, sphinx

我正在尝试制作一个 mysql 视图，然后用于 Sphinx 搜索。

我有三张表：食谱、标签、配料。

**粗体字是行名*

食谱是我存储食谱**名称**和烹饪时间（**持续时间总计**）的地方

配料是我存储特定食谱所需的 1 种配料的地方（这意味着每个食谱对应的配料不止一种。）配料有一个对应于食谱的**recipe_id**和我存储配料名称的**配料字段。**

标签类似于成分，因为对于每个食谱，可以有多个标签。例如：*妈妈的鸡肉食谱有标签（逗号分隔）：yummy,chicken,thanksgiving*标签也有一个**recipe_id**字段和一个**标签**字段，我存储标签的名称。

现在，我正在实现 Sphinx 搜索，需要一种方法来组合

*   配方 ID ( **recipes.id** )
*   配方名称（**recipes.name**）
*   成分 ID ( **ingredients.id** )
*   成分名称（**成分.ingredient**）
*   配料对应的配方 ID ( **ingredients.recipe_id** )
*   标签 ID ( **tags.id** )
*   标签名称 ( **tags.tag** )
*   标签对应的配方 ID ( **tags.recipe_id** )

我的思考过程（我是一个漂亮的程序员，刚刚发现了 Sphinx）是创建一个 MYSQL 视图，它结合了上述所有行，所以我有一个看起来像这样的视图：

> 1.  食谱名称：To' Good Chicken Soup......标签：美味......成分：鸡肉
> 2.  食谱名称：To' Good Chicken Soup......标签：美味......成分：鸡肉
> 3.  食谱名称：To' Good Chicken Soup......标签：Soup......成分：Chicken
> 4.  食谱名称：To' Good Chicken Soup......标签：美味......成分：水

如您所见，这种方法的问题在于它重复了很多行。但由于这只是我能想到的方法，所以我继续创建了一个新视图：

```
SELECT
   recipes.id,
   recipes.name,
   ingredients.ingredient,
   tags.tag
FROM
   recipes, ingredients, tags
WHERE
   recipes.id=ingredients.recipe_id 
AND recipes.id=tags.recipe_id; 
```

我将这段代码放入 mysql 中，但我只得到具有对应标签/成分的食谱？另外，这是构建我的 mysql 视图的正确方法吗？

感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:00:12.337

如果您想获取所有食谱，无论它们是否有成分或标签，您都想使用`LEFT OUTER JOIN`

```
SELECT recipes.id, recipes.name, ingredients.ingredient, tags.tag
FROM recipes
 LEFT OUTER JOIN ingredients ON recipes.id=ingredients.recipe_id 
 LEFT OUTER JOIN tags ON recipes.id=tags.recipe_id; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T02:03:28.683

尝试左连接：http: [//www.w3schools.com/sql/sql_join_left.asp](http://www.w3schools.com/sql/sql_join_left.asp)

```
SELECT
   recipes.id,
   recipes.name,
   ingredients.ingredient,
   tags.tag
FROM
   recipes
LEFT JOIN ingredients ON recipes.id=ingredients.recipe_id
LEFT JOIN tags ON recipes.id=tags.recipe_id 
```

# android - 在 Android 的 AlertDialog 中显示项目时出现异常

> ID：15036154
> 
> 赞同：0
> 
> 时间：2013-02-23T01:58:19.233
> 
> 标签：android, exception, android-alertdialog

我正在尝试创建一个带有项目选择的 AlertDialog。我正在使用以下代码

```
final CharSequence[] items={"One","two","three"};

alertDialog = new AlertDialog.Builder(this).create();
alertDialog.setTitle("Choose COlor");                                
alertDialog.setItems(items, new DialogInterface.OnClickListener() {
                       public void onClick(DialogInterface dialog, int which) {
                           // The 'which' argument contains the index position
                           // of the selected item
                       }
                }); 
```

但我不断收到编译错误

> 方法 setItems(CharSequence[], new DialogInterface.OnClickListener(){}) 未为 AlertDialog 类型定义

我很困惑，因为我看到的所有示例都使用此代码，那么为什么会出现此错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T02:02:56.103

`setItems`是一种方法`AlertDialog.Builder`，不是`AlertDialog`。

您应该在构建器上调用所有方法，而不是对话框。例如：

```
alertDialog = new AlertDialog.Builder(this)
              .setTitle("Choose COlor")                            
              .setItems(items, new DialogInterface.OnClickListener() {
                   public void onClick(DialogInterface dialog, int which) {
                       // The 'which' argument contains the index position
                       // of the selected item
                   }
               })
               .create(); 
```

# java - JAX WS com.sun.xml.internal.ws.client.ClientTransportException：HTTP 传输错误：java.net.ConnectException：连接被拒绝

> ID：15036155
> 
> 赞同：4
> 
> 时间：2013-02-23T01:58:27.957
> 
> 标签：java, jax-ws, wsimport

我是 JAX-WS 的新手。我正在尝试访问公司内远程计算机上的 Web 服务。

我使用 wsimport 工具从我们内部网上的 WSDL 资源生成 JAVA 类。Java 文件已成功创建。

我尝试通过 SOAPUI 发送请求，得到有效响应。但是当我尝试运行我的代码时，它会抛出 Connection refused。

这是我的代码。

```
URL url = new URL("https://xmattersqa.com/api/services/xmatters-4.1.7?wsdl");

QName qname = new QName("http://www.xmatters.com/webservices/schema#4.1.7", "xmatters-   4.1.7");

FindWhoIsOnDuty f = new FindWhoIsOnDuty();  
Xmatters417 cdoubleprime = new Xmatters417(url,qname);

Xmatters417PortType port = cdoubleprime.getXmatters417SOAP11PortHttp();

FindWhoIsOnDutyReturn fresponse = port.findWhoIsOnDuty("fmsopsqa","fmsopsqa", "", "", "",   "Default Company", "Test Grp 1","23/02/2013 0:00:00 AM", "24/02/2013 0:00:00 AM", false); 
```

后来我尝试添加这段代码，它仍然不起作用。

```
Authenticator.setDefault(new ProxyAuthenticator("fmsopsqa","fmsopsqa"));
System.setProperty("http.proxHost","sprdxmaws401.corp.net");
System.setProperty("http.proxyPort", "8081"); 
```

这就是我得到的

```
com.sun.xml.internal.ws.client.ClientTransportException: HTTP transport error:    java.net.ConnectException: Connection refused
at      com.sun.xml.internal.ws.transport.http.client.HttpClientTransport.getOutput(HttpClientTransport.java:121)
at com.sun.xml.internal.ws.transport.http.client.HttpTransportPipe.process(HttpTransportPipe.java:142)
at com.sun.xml.internal.ws.transport.http.client.HttpTransportPipe.processRequest(HttpTransportPipe.java:83)
at com.sun.xml.internal.ws.transport.DeferredTransportPipe.processRequest(DeferredTransportPipe.java:105)
at com.sun.xml.internal.ws.api.pipe.Fiber.__doRun(Fiber.java:587)
at com.sun.xml.internal.ws.api.pipe.Fiber._doRun(Fiber.java:546)
at com.sun.xml.internal.ws.api.pipe.Fiber.doRun(Fiber.java:531)
at com.sun.xml.internal.ws.api.pipe.Fiber.runSync(Fiber.java:428)
at com.sun.xml.internal.ws.client.Stub.process(Stub.java:211)
at com.sun.xml.internal.ws.client.sei.SEIStub.doProcess(SEIStub.java:124)
at com.sun.xml.internal.ws.client.sei.SyncMethodHandler.invoke(SyncMethodHandler.java:98)
at com.sun.xml.internal.ws.client.sei.SyncMethodHandler.invoke(SyncMethodHandler.java:78)
at com.sun.xml.internal.ws.client.sei.SEIStub.invoke(SEIStub.java:107)
at $Proxy32.findWhoIsOnDuty(Unknown Source)
at FindDuty.main(FindDuty.java:76)
Caused by: java.net.ConnectException: Connection refused
at java.net.PlainSocketImpl.socketConnect(Native Method)
at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:351)
at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:213)
at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:200)
at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:432)
at java.net.Socket.connect(Socket.java:529)
at java.net.Socket.connect(Socket.java:478)
at sun.net.NetworkClient.doConnect(NetworkClient.java:163)
at sun.net.www.http.HttpClient.openServer(HttpClient.java:388)
at sun.net.www.http.HttpClient.openServer(HttpClient.java:523)
at sun.net.www.http.HttpClient.<init>(HttpClient.java:227)
at sun.net.www.http.HttpClient.New(HttpClient.java:300)
at sun.net.www.http.HttpClient.New(HttpClient.java:317)
at sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:970)
at sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:949)
at sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:836)
at sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1014)
at com.sun.xml.internal.ws.transport.http.client.HttpClientTransport.getOutput(HttpClientTransport.java:109) 
```

服务端点链接似乎设置正确。

```
@WebServiceClient(name = "xmatters-4.1.7", targetNamespace = "http://www.xmatters.com/webservices/schema#4.1.7", wsdlLocation = "https://xmattersqa.com/api/services/xmatters-4.1.7?wsdl") 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2015-12-02T09:56:59.600

我想这为时已晚，但也许这个解决方案将帮助其他面临同样问题的人。我刚刚遇到了同样的问题，发现我的代理存根对象正在调用另一个 URL，而不是我提供给服务对象的 URL。

```
java.net.URL wsdlURL = new URL("http://myServiceHost.com/online/myService?wsdl");
Service serviceWebClient = new ServiceWebClient(wsdlURL, new QName("my/namespace", "MyServiceName")); 
```

然后我的调试器向我展示了我的服务没有尝试访问给定的 URL，而是一个内部 IP 地址，该地址位于服务标签下此 URL 上的投影 wsdl 内。

```
<service name="MyServiceName">
  <port name="MyServicePort" binding="tns:MyServiceBindingBinding">
    <soap:address location="http://192.168.3.20:9443/online/myService/"/>
  </port>
</service> 
```

所以存根指向 192.168.3.20 的端点，但我的服务不在同一台机器上，因此显然无法到达。为了解决这个问题，您必须像这样更正存根上的 URL

```
MyService myService = serviceWebClient.getPort(MyService.class);
BindingProvider bindingProvider = (BindingProvider) myService;
bindingProvider.getRequestContext().put(BindingProvider.ENDPOINT_ADDRESS_PROPERTY, wsdlURL.toString()); 
```

这为我解决了这个问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-10-30T20:46:24.817

这可能很愚蠢，我有一种情况，我在 get 和 update 操作上定义了两个端口，实际上它们的意思是一样的。删除重复项后，问题已修复。以防万一它可以帮助任何人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-05T14:57:26.807

由于这是搜索此错误消息时的顶部搜索结果。如果您指定了错误的端口号，您还会收到“连接被拒绝”错误消息。对我来说，就这么简单。仔细检查以确保。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-01-30T20:06:45.233

除了作为可能原因的防火墙白名单之外，如果您收到“HTTP 状态代码 404：已处理”，它甚至可能没有该服务方法可用。

# wordpress - 将 Woocommerce 添加到购物车按钮添加到相关产品和产品列表

> ID：15036157
> 
> 赞同：5
> 
> 时间：2013-02-23T01:58:49.363
> 
> 标签：wordpress, cart, woocommerce

我在向 WooCommerce 添加其他内容时遇到了一些困难，因为我还是新手。我正在尝试将“添加到购物车”按钮添加到相关产品和产品列表中。

正在运行代码并卡在下面。

```
<a href="<?php the_permalink(); ?>">

        <?php
            /**
             * woocommerce_before_shop_loop_item_title hook
             *
             * @hooked woocommerce_show_product_loop_sale_flash - 10
             * @hooked woocommerce_template_loop_product_thumbnail - 10
             */
            do_action( 'woocommerce_before_shop_loop_item_title' );
        ?>

        <h3><?php the_title(); ?></h3>

        <?php
            /**
             * woocommerce_after_shop_loop_item_title hook
             *
             * @hooked woocommerce_template_loop_price - 10
             */
            do_action( 'woocommerce_after_shop_loop_item_title' );
        ?>

    </a>

    <?php do_action( 'woocommerce_after_shop_loop_item' ); ?> 
```

希望有人可以指导我如何添加按钮。提前致谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-25T08:13:10.597

解释每个 do_action 都在 woocommerce-hooks.php 内部，并指向 woocommerce-template.php 内部的一个函数

创建缩略图：

```
Function Name: woocommerce_template_loop_product_thumbnail()

do_action( 'woocommerce_before_shop_loop_item_title' ); 
```

提供价格：

```
Function Name: woocommerce_template_loop_price()

do_action( 'woocommerce_after_shop_loop_item_title' ); 
```

添加到购物车按钮：

```
Function Name: woocommerce_template_loop_add_to_cart()

do_action( 'woocommerce_after_shop_loop_item' ); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-29T12:04:04.000

`woocommerce_template_loop_add_to_cart`在您的 wordpress 文件夹中递归搜索。

默认情况下，WooCommerce 将其挂接到`woocommerce_after_shop_loop_item`wp-content\plugins\woocommerce\woocommerce-hooks.php

```
add_action( 'woocommerce_after_shop_loop_item', 'woocommerce_template_loop_add_to_cart', 10 ); 
```

我安装的主题[Mystile](http://www.woothemes.com/products/mystile/)删除了 wp-content\themes\mystile\includes\theme-woocommerce.php 中的这个钩子

```
// Remove add to cart button on archives
remove_action( 'woocommerce_after_shop_loop_item', 'woocommerce_template_loop_add_to_cart', 10); 
```

一旦我将其注释掉，就会出现“添加到购物车”按钮。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-06-21T19:36:40.593

要将“添加到购物车”按钮添加到产品列表页面，我个人复制了：

```
wp-content/plugins/woocommerce/templates/content-product.php 
```

进入 ：

```
wp-content/themes/myChildTemplate/woocommerce/content-product.php 
```

然后我替换了：

```
 do_action( 'woocommerce_after_shop_loop_item_title' );
    ?>

</a> 
```

经过：

```
 do_action( 'woocommerce_after_shop_loop_item_title' );
    ?>

</a>
    <?php do_action('woocommerce_simple_add_to_cart'); ?> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-08-21T10:44:18.690

仅供遇到此问题的任何人，您也可以尝试使用此钩子使其正常工作...

```
// Add add to cart button on archive page products
add_action( 'woocommerce_after_shop_loop_item_title', 'woocommerce_template_loop_add_to_cart', 10 ); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-01-18T19:13:27.987

在 ElegantTheme wordpress 主题 (Divi) 上使用 WooCommerce，我将此行添加到 functions.php ：

```
add_action( 'woocommerce_after_shop_loop_item_title', 'woocommerce_template_loop_add_to_cart', 10 ); 
```

它在标题和价格之后添加一个“添加到购物车”按钮（即每个产品一个“添加到购物车”按钮）

# php - MongoDB迭代

> ID：15036161
> 
> 赞同：1
> 
> 时间：2013-02-23T01:59:09.403
> 
> 标签：php, javascript, performance, mongodb

我正在尝试找到迭代 MongoDB 中数据的最快方法。我收集了 60k 个文档，我希望每个文档中的`remove`所有`fields`值都是`NULL`. （从 MySQL 转移）。我仅删除一个字段的测试功能是：

```
 db.collection.find({cc_type:null}).forEach(function(u) {
            db.collection.update(u, {$unset:{"cc_name":1} 
            //some other null-value fields to check
}); 
```

浏览数据大约需要 20 秒。我究竟做错了什么？另外，我正在为 PHP 使用 MongoDB 驱动程序。在 PHP 中迭代数据而不是使用 MongoDB 工具不是更有效吗？迭代大量数据并对其进行一些更改的最佳实践是什么（每个文档的不同更改取决于存在的字段）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:02:24.923

`update`在一次操作中完成它会更快。在外壳中它将是：

```
db.collection.update({cc_type:null}, {$unset: {cc_name: 1}}, false, true) 
```

该`true`参数是`multi`标志，因此它会影响所有文档，而不仅仅是第一个。

# sql - 基于组度量更新行

> ID：15036164
> 
> 赞同：0
> 
> 时间：2013-02-23T01:59:28.070
> 
> 标签：sql, sql-server

```
[UNIT] [PRICE] [QUANTITY] [REVENUE]     [PERCENTAGE]
A      $10     25         $250           25%
B      $5      30         $150           15%
C      $20     30         $600           60%
Total Revenue             $1,000             100% 
```

我正在尝试创建一个查询来计算 [PERCENTAGE] 列，这是我使用的：

```
UPDATE Table
SET [PERCENTAGE] = (PRICE*QUANTITY)/(sum(PRICE*QUANTITY) 
```

这是错误消息：

聚合可能不会出现在 UPDATE 语句的集合列表中。

有什么建议吗？

感谢您的阅读。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T02:06:30.077

```
UPDATE
    t1 target
    CROSS JOIN t1 src
SET
    target.PERCENTAGE = target.PRICE * target.QUANTITY / 
(SELECT SUM(src.PRICE * src.QUANTITY)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T03:01:53.023

我建议使用窗口函数和一个`with`子句来做到这一点：

```
with toupdate as (
      select t.*,
             sum(price*quantity) over () as total
      from t
     )
update toupdate
    set percentage = price*quantity / total; 
```

# javascript - 从 Firefox 捕获错误事件消息

> ID：15036165
> 
> 赞同：3
> 
> 时间：2013-02-23T01:59:36.017
> 
> 标签：javascript, events, firefox, throw

我找不到在 Firefox 下捕获错误消息的方法：

```
window.addEventListener("error", handleException, false);

...

function handleException(e) {   
    alert(e);
    return false;
}

...

<script>
throw new Error('sdasd');
</script> 
```

这很好地输入了`handleException`方法，但是`e`参数是`error event`在 firefox 下**，我不知道如何获取关联的消息**。例如，在 chrome 中，我得到了消息，`e.message`因为在错误冒泡到没有被捕获之后，在窗口级别触发了一个自动错误（参见[这个小提琴](http://jsfiddle.net/fz9y8/)：最终错误是“未捕获”），其中包含我的原始错误手动升起。

因此，为了在 firefox 下具有相同的行为（如果您在 firefox 下运行 fiddle，您会看到消息是“未定义”），我找到了一种解决方法，包括封装一个错误引发函数来设置手动“最后一个错误”架构：

```
function err(I_sText) { 
    g_lastManualError = new Error(I_sText);
    throw g_lastManualError; //this variable is global so I can get the message from anywhere
} 
```

所以`throw new Error(..)`我只打电话而不是这样做`err(..)`。这有效，至少对于用户定义的异常，这是我最关心的问题。在我的处理程序`handleException`中，我正在咨询全局变量。

你知道我该怎么做吗？我对这个解决方案不满意。

谢谢你，S。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T05:34:32.187

我修改了你的代码作为演示：

```
function handleException(e) { 
    console.log(e);
    alert(e);
    return false;
}
window.addEventListener("error", handleException, false);

try {
  throw new Error('sdasd');
}
catch (e) {
  console.log(e)
}
console.log('after exception 1');
throw new Error('foo');
console.log('after exception 2'); 
```

运行此代码（在 Firebug 中）向我展示了这一点：

```
Error: sdasd
[Break On This Error]   

Filtered chrome url chrome://firebug/content/console/commandLineExposed.js

comman...osed.js (line 175)
<System>

after exception 1

"Error: foo `    throw new Error('foo');` @14" 
```

如果您试图捕获错误，请使用`try {...} catch { ...}`. 看起来你只是绑定到一个错误事件，所以你抛出的异常仍然会传播到 window 并告诉 JS 引擎停止。在 Chrome 中运行这段代码，你会看到你永远不会看到“在异常 2 之后”，但你会看到“在异常 1 之后”。

异常（由 创建`throw`）的目的是停止代码执行，除非有处理该特定异常的代码。[您可以在MDN 页面上查看 try-catch](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/try...catch)的示例

**编辑**：我刚刚想到您可能正在尝试捕获 jQuery 错误事件。如果是这种情况，您的事件绑定是正确的，但您不应该使用`throw`

**编辑 2**：我应该早点注意到这一点，但是您正在尝试使用`window.addEventListener`. 错误事件不会中断执行。例外。

用以下代码替换您的`throw new Error('sdasd');`代码：

```
var customEvent = new CustomEvent('error')

window.dispatchEvent(customEvent); 
```

那应该可以解决您的问题。我使用[自定义事件的 MDN 页面](https://developer.mozilla.org/en-US/docs/DOM/Creating_and_triggering_events)作为参考。

# c - 如何提高 64 位 C/intel 汇编程序的内存性能/数据局部性

> ID：15036169
> 
> 赞同：1
> 
> 时间：2013-02-23T02:00:02.540
> 
> 标签：c, performance, optimization, assembly, intel-vtune

我正在使用一个爱好程序来自学高性能计算技术。

我的 PC 有一个 Intel Ivy Bridge Core i7 3770 处理器和 32 GB 内存和 Microsoft vs2010 C 编译器的免费版本。

64 位程序需要大约 20 GB 的内存，因为它有五个 4 GB 的查找表（下面的 bytevecM ... bytevecX）。这个搜索程序的内部循环被写成一个单独的 C 文件（因为我以后可能想用汇编版本替换它），如下所示：

```
#define H_PRIME 1000003
int inner(
   const char* bytevecM,
   const char* bytevecD,
   const char* bytevecC,
   const char* bytevecL,
   const char* bytevecX,
   int startval, int endval,
   int m2, int d2, int c2, int l2, int x2,
   int* ps
)
{
   int* psin = ps;
   int qqm;
   int m3, m4, m5, m6, m7;
   int d3, d4, d5, d6, d7;
   int c3, c4, c5, c6, c7;
   int l3, l4, l5, l6, l7;
   int x3, x4, x5, x6, x7;
   int q3, q4, q5, q6, q7, q8;
   for (q3 = startval; q3 < endval; ++q3)
   {
      if (q3 == 10 || q3 == 13) continue;
      m3 = (m2 ^ q3) * H_PRIME;
      d3 = (d2 ^ q3) * H_PRIME;
      c3 = (c2 ^ q3) * H_PRIME;
      l3 = (l2 ^ q3) * H_PRIME;
      x3 = (x2 ^ q3) * H_PRIME;
      for (q4 = 1; q4 < 128; ++q4)
      {
         if (q4 == 10 || q4 == 13) continue;
         m4 = (m3 ^ q4) * H_PRIME;
         d4 = (d3 ^ q4) * H_PRIME;
         c4 = (c3 ^ q4) * H_PRIME;
         l4 = (l3 ^ q4) * H_PRIME;
         x4 = (x3 ^ q4) * H_PRIME;
         for (q5 = 1; q5 < 128; ++q5)
         {
            if (q5 == 10 || q5 == 13) continue;
            m5 = (m4 ^ q5) * H_PRIME;
            d5 = (d4 ^ q5) * H_PRIME;
            c5 = (c4 ^ q5) * H_PRIME;
            l5 = (l4 ^ q5) * H_PRIME;
            x5 = (x4 ^ q5) * H_PRIME;
            for (q6 = 1; q6 < 128; ++q6)
            {
               if (q6 == 10 || q6 == 13) continue;
               m6 = (m5 ^ q6) * H_PRIME;
               d6 = (d5 ^ q6) * H_PRIME;
               c6 = (c5 ^ q6) * H_PRIME;
               l6 = (l5 ^ q6) * H_PRIME;
               x6 = (x5 ^ q6) * H_PRIME;
               for (q7 = 1; q7 < 128; ++q7)
               {
                  if (q7 == 10 || q7 == 13) continue;
                  m7 = (m6 ^ q7) * H_PRIME;
                  d7 = (d6 ^ q7) * H_PRIME;
                  c7 = (c6 ^ q7) * H_PRIME;
                  l7 = (l6 ^ q7) * H_PRIME;
                  x7 = (x6 ^ q7) * H_PRIME;
                  for (q8 = 1; q8 < 128; ++q8)
                  {
                     if (q8 == 10 || q8 == 13) continue;
                     qqm = bytevecM[(unsigned int)(m7 ^ q8)];
                     if (qqm != 0
                     &&  qqm == bytevecD[(unsigned int)(d7 ^ q8)]
                     &&  qqm == bytevecC[(unsigned int)(c7 ^ q8)]
                     &&  qqm == bytevecL[(unsigned int)(l7 ^ q8)]
                     &&  qqm == bytevecX[(unsigned int)(x7 ^ q8)])
                     {
                        *ps++ = q3; *ps++ = q4; *ps++ = q5;
                        *ps++ = q6; *ps++ = q7; *ps++ = q8;
                        *ps++ = qqm;
                     }
                  }
               }
            }
         }
      }
   }
   return (int)(ps - psin);
} 
```

顺便说一下，通过在每个线程中以不同的开始和结束范围运行一个副本，上述算法很容易并行化。

使用直觉、英特尔内在函数并单独对每个更改进行基准测试，我能够将运行时间从大约 5 小时减少到 3 小时，如下所示：

```
#include <emmintrin.h>
#include <smmintrin.h>
#define H_PRIME 1000003
#define UNROLL(q8) qqm = bytevecM[(unsigned int)(m7 ^ q8)];    \
  if (qqm != 0                                                 \
  &&  qqm == bytevecD[(unsigned int)(s7.m128i_i32[0] ^ q8)]    \
  &&  qqm == bytevecC[(unsigned int)(s7.m128i_i32[1] ^ q8)]    \
  &&  qqm == bytevecL[(unsigned int)(s7.m128i_i32[2] ^ q8)]    \
  &&  qqm == bytevecX[(unsigned int)(s7.m128i_i32[3] ^ q8)]) { \
    ps[j++] = _mm_set_epi16(0, qqm, q8, q7, q6, q5, q4, q3); }
int inner(
   const char* bytevecM,
   const char* bytevecD,
   const char* bytevecC,
   const char* bytevecL,
   const char* bytevecX,
   int startval, int endval,
   int m2, int d2, int c2, int l2, int x2,
   __m128i* ps
)
{
   __m128i s2 = _mm_set_epi32(x2, l2, c2, d2);
   __m128i hp = _mm_set1_epi32(H_PRIME);
   __m128i xt[128];
   __m128i s3, s4, s5, s6, s7;
   int qqm;
   int m3, m4, m5, m6, m7;
   int q3, q4, q5, q6, q7;
   int j = 0;
   int z; for (z = 1; z < 128; ++z) { xt[z] = _mm_set1_epi32(z); }
   for (q3 = startval; q3 < endval; ++q3)
   {
      if (q3 == 10 || q3 == 13) continue;
      m3 = (m2 ^ q3) * H_PRIME;
      s3 = _mm_mullo_epi32(_mm_xor_si128(s2, xt[q3]), hp);
      for (q4 = 1; q4 < 128; ++q4)
      {
         if (q4 == 10 || q4 == 13) continue;
         m4 = (m3 ^ q4) * H_PRIME;
         s4 = _mm_mullo_epi32(_mm_xor_si128(s3, xt[q4]), hp);
         for (q5 = 1; q5 < 128; ++q5)
         {
            if (q5 == 10 || q5 == 13) continue;
            m5 = (m4 ^ q5) * H_PRIME;
            s5 = _mm_mullo_epi32(_mm_xor_si128(s4, xt[q5]), hp);
            for (q6 = 1; q6 < 128; ++q6)
            {
               if (q6 == 10 || q6 == 13) continue;
               m6 = (m5 ^ q6) * H_PRIME;
               s6 = _mm_mullo_epi32(_mm_xor_si128(s5, xt[q6]), hp);
               for (q7 = 1; q7 < 128; ++q7)
               {
                  if (q7 == 10 || q7 == 13) continue;
                  m7 = (m6 ^ q7) * H_PRIME;
                  s7 = _mm_mullo_epi32(_mm_xor_si128(s6, xt[q7]), hp);
                  UNROLL(1)
                  UNROLL(96)
                  UNROLL(2)
                  UNROLL(3)
                  UNROLL(4)
                  UNROLL(5)
                  UNROLL(6)
                  UNROLL(7)
                  UNROLL(8)
                  UNROLL(9)
                  UNROLL(11)
                  UNROLL(12)
                  UNROLL(14)
                  // ... snipped UNROLL(15) .. UNROLL(125)
                  UNROLL(126)
                  UNROLL(127)
               }
            }
         }
      }
   }
   return j;
} 
```

这种加速大部分来自内部循环的手动展开。

由于我对英特尔 SSE/AVX 指令非常陌生，如果您刚刚看到上面的内容让您脸红，请告诉我。

Intel VTune 报告最大的热点出现在线路上：

```
UNROLL(1) 
```

在对应的汇编代码中，热点如下图所示：

```
mov     eax, ecx                         0.917s
mov     edx, ecx                         0.062s
xor     rax, 0x1
movdqa  xmmword ptr [rsp+0x20], xmm0
mov     ebx, dword ptr [rsp+0x2c]        0.155s
mov     r11d, dword ptr [rsp+0x28]       0.949s
movsx   ecx, byte ptr [rax+rdi*1]        0.156s
mov     r9d, dword ptr [rsp+0x24]       91.132s
mov     r8d, dword ptr [rsp+0x20]        0.233s
test    ecx, ecx
jz      0x14000225b
---
mov     eax, r8d                         0.342s
xor     rax, 0x1                         0.047s
movsx   eax, byte ptr [rax+r13*1]        0.124s
cmp     ecx, eax                        12.631s
jnz     0x14000225b
---
mov     eax, r9d
xor     rax, 0x1
movsx   eax, byte ptr [rax+r12*1]
cmp     ecx, eax                         0.016s
jnz     0x14000225b 
```

这对我来说似乎是一个“数据局部性”问题。每次通过内部循环时，m7 的值在 4 GB 范围内变化很大且不可预测，因此在查找 qqm=bytevecM[m7^1] 时，您可能会遇到第一个 UNROLL(1) 的缓存未命中。

由于随后的 UNROLL(2)..UNROLL(127) xor m7 与 2..127，您通常会在其余的 UNROLL 中获得缓存命中。奇怪的是，通过将 UNROLL(96) 移到 UNROLL(1) 之后来更改 UNROLL 的顺序，可以显着加快速度。

我知道从内存中读取一个字节会导致填充包含该字节的（64 字节）缓存行。

由于我对这个领域非常陌生，我欢迎任何关于如何加快内存查找的建议或良好参考，尤其是在处理大型表时（在我的例子中，4 GB 表）。

我看不到使用上述算法改善数据局部性的明显方法；也欢迎就如何实现这一目标提出建议。

**2013 年 3 月 29 日更新**

自从编写了这个节点以来，我已经能够将运行时间从 3 小时进一步减少到 20 分钟，如下所示。

为每个 4 GB bytevec 添加一个 4 MB 位图将其减少到大约 40 分钟，通过添加一些 _mm_prefetch 调用进一步减半。

请注意，基本算法保持不变：通过添加位图改善了数据局部性；通过添加 _mm_prefetch 调用减少了延迟。

欢迎提出进一步性能改进的建议。改进后的程序如下：

```
#include <emmintrin.h>
#include <smmintrin.h>
#define H_PRIME 1000003

#define UNROLL(qx) qqm = bytevecM[m7 ^ qx];         \
  if (qqm != 0                                      \
  &&  qqm == bytevecD[d7 ^ qx]) {                   \
    _mm_prefetch(&bytevecC[c7 ^ qx], _MM_HINT_T0);  \
    qd[nqd++] = qqm; qd[nqd++] = qx; }

int inner(
   const unsigned char* bitvecM,
   const unsigned char* bitvecD,
   const unsigned char* bitvecC,
   const unsigned char* bitvecL,
   const unsigned char* bitvecX,
   const unsigned char* bitvecV,
   const unsigned char* bitvecI,
   const unsigned char* bytevecM,
   const unsigned char* bytevecD,
   const unsigned char* bytevecC,
   const unsigned char* bytevecL,
   const unsigned char* bytevecX,
   int startval, int endval,
   int m2, int d2, int c2, int l2, int x2, int v2, int i2,
   __m128i* ps
)
{
   __declspec(align(16)) __m128i s2 = _mm_set_epi32(i2, v2, x2, l2);
   __declspec(align(16)) __m128i hp = _mm_set1_epi32(H_PRIME);
   __declspec(align(16)) __m128i xt[128];
   __declspec(align(16)) __m128i s3, s4, s5, s6;
   int m3, m4, m5, m6;
   int d3, d4, d5, d6;
   int c3, c4, c5, c6;
   unsigned int m7, d7, c7, l7, x7, v7, i7;
   int qqm;
   int q3, q4, q5, q6, q7, q8;
   int iret = 0;
   unsigned int qf[128*4];
   int nqf;
   int qz;
   int qd[128*2];
   int nqd;
   int cnt;
   int qh[128*3];
   int nqh;
   int qi[128*5];
   int nqi;
   unsigned int m7arr[128];
   unsigned int d7arr[128];
   const size_t* pbvM = (size_t*)bitvecM;
   const size_t* pbvD = (size_t*)bitvecD;
   const size_t* pbvC = (size_t*)bitvecC;
   const size_t* pbvL = (size_t*)bitvecL;
   const size_t* pbvX = (size_t*)bitvecX;
   const size_t* pbvV = (size_t*)bitvecV;
   const size_t* pbvI = (size_t*)bitvecI;
   int z; for (z = 1; z < 128; ++z) { xt[z] = _mm_set1_epi32(z); }

   for (q3 = startval; q3 < endval; ++q3)
   {
      if (q3 == 10 || q3 == 13) continue;
      m3 = (m2 ^ q3) * H_PRIME;
      d3 = (d2 ^ q3) * H_PRIME;
      c3 = (c2 ^ q3) * H_PRIME;
      s3 = _mm_mullo_epi32(_mm_xor_si128(s2, xt[q3]), hp);
      for (q4 = 1; q4 < 128; ++q4)
      {
         if (q4 == 10 || q4 == 13) continue;
         m4 = (m3 ^ q4) * H_PRIME;
         d4 = (d3 ^ q4) * H_PRIME;
         c4 = (c3 ^ q4) * H_PRIME;
         s4 = _mm_mullo_epi32(_mm_xor_si128(s3, xt[q4]), hp);
         for (q5 = 1; q5 < 128; ++q5)
         {
            if (q5 == 10 || q5 == 13) continue;
            m5 = (m4 ^ q5) * H_PRIME;
            d5 = (d4 ^ q5) * H_PRIME;
            c5 = (c4 ^ q5) * H_PRIME;
            s5 = _mm_mullo_epi32(_mm_xor_si128(s4, xt[q5]), hp);
            for (q6 = 1; q6 < 128; ++q6)
            {
               if (q6 == 10 || q6 == 13) continue;
               m6 = (m5 ^ q6) * H_PRIME;
               d6 = (d5 ^ q6) * H_PRIME;
               c6 = (c5 ^ q6) * H_PRIME;
               s6 = _mm_mullo_epi32(_mm_xor_si128(s5, xt[q6]), hp);
               for (q7 = 1; q7 < 128; ++q7)
               {
                  if (q7 == 10 || q7 == 13) continue;
                  m7arr[q7] = (unsigned int)( (m6 ^ q7) * H_PRIME );
                  _mm_prefetch((const char*)(&pbvM[m7arr[q7] >> 13]), _MM_HINT_T0);
                  d7arr[q7] = (unsigned int)( (d6 ^ q7) * H_PRIME );
                  _mm_prefetch((const char*)(&pbvD[d7arr[q7] >> 13]), _MM_HINT_T0);
               }
               nqh = 0;
               for (q7 = 1; q7 < 128; ++q7)
               {
                  if (q7 == 10 || q7 == 13) continue;
                  if ( (pbvM[m7arr[q7] >> 13] & ((size_t)1 << ((m7arr[q7] >> 7) & 63))) == 0 ) continue;
                  if ( (pbvD[d7arr[q7] >> 13] & ((size_t)1 << ((d7arr[q7] >> 7) & 63))) == 0 ) continue;
                  c7 = (unsigned int)( (c6 ^ q7) * H_PRIME );
                  _mm_prefetch((const char*)(&pbvC[c7 >> 13]), _MM_HINT_T0);
                  l7 = (unsigned int)( (s6.m128i_i32[0] ^ q7) * H_PRIME );
                  _mm_prefetch((const char*)(&pbvL[l7 >> 13]), _MM_HINT_T0);
                  qh[nqh++] = q7;
                  qh[nqh++] = c7;
                  qh[nqh++] = l7;
               }
               nqi = 0;
               cnt = 0;
               while (cnt < nqh)
               {
                  q7 = qh[cnt++];
                  c7 = qh[cnt++];
                  l7 = qh[cnt++];
                  if ( (pbvC[c7 >> 13] & ((size_t)1 << ((c7 >> 7) & 63))) == 0 ) continue;
                  if ( (pbvL[l7 >> 13] & ((size_t)1 << ((l7 >> 7) & 63))) == 0 ) continue;
                  x7 = (unsigned int)( (s6.m128i_i32[1] ^ q7) * H_PRIME );
                  _mm_prefetch((const char*)(&pbvX[x7 >> 13]), _MM_HINT_T0);
                  v7 = (unsigned int)( (s6.m128i_i32[2] ^ q7) * H_PRIME );
                  _mm_prefetch((const char*)(&pbvV[v7 >> 13]), _MM_HINT_T0);
                  qi[nqi++] = q7;
                  qi[nqi++] = c7;
                  qi[nqi++] = l7;
                  qi[nqi++] = x7;
                  qi[nqi++] = v7;
               }
               nqf = 0;
               cnt = 0;
               while (cnt < nqi)
               {
                  q7 = qi[cnt++];
                  c7 = qi[cnt++];
                  l7 = qi[cnt++];
                  x7 = qi[cnt++];
                  v7 = qi[cnt++];
                  if ( (pbvX[x7 >> 13] & ((size_t)1 << ((x7 >> 7) & 63))) == 0 ) continue;
                  if ( (pbvV[v7 >> 13] & ((size_t)1 << ((v7 >> 7) & 63))) == 0 ) continue;
                  i7 = (unsigned int)( (s6.m128i_i32[3] ^ q7) * H_PRIME );
                  if ( (pbvI[i7 >> 13] & ((size_t)1 << ((i7 >> 7) & 63))) == 0 ) continue;
                  _mm_prefetch(&bytevecD[d7arr[q7] & 0xffffff80], _MM_HINT_T0);
                  _mm_prefetch(&bytevecD[64+(d7arr[q7] & 0xffffff80)], _MM_HINT_T0);
                  qf[nqf++] = q7;
                  qf[nqf++] = c7;
                  qf[nqf++] = l7;
                  qf[nqf++] = x7;
               }
               cnt = 0;
               while (cnt < nqf)
               {
                  q7 = qf[cnt];
                  cnt += 4;
                  _mm_prefetch(&bytevecM[m7arr[q7] & 0xffffff80], _MM_HINT_T0);
                  _mm_prefetch(&bytevecM[64+(m7arr[q7] & 0xffffff80)], _MM_HINT_T0);
               }
               qz = 0;
               while (qz < nqf)
               {
                  q7 = qf[qz++];
                  c7 = qf[qz++];
                  l7 = qf[qz++];
                  x7 = qf[qz++];
                  m7 = m7arr[q7];
                  d7 = d7arr[q7];
                  nqd = 0;
                  UNROLL(1)
                  UNROLL(96)
                  UNROLL(2)
                  UNROLL(3)
                  UNROLL(4)
                  UNROLL(5)
                  UNROLL(6)
                  UNROLL(7)
                  UNROLL(8)
                  UNROLL(9)
                  UNROLL(11)
                  UNROLL(12)
                  UNROLL(14)
                  // ... snipped UNROLL(15) .. UNROLL(125)
                  UNROLL(126)
                  UNROLL(127)
                  if (nqd == 0) continue;
                  cnt = 0;
                  while (cnt < nqd)
                  {
                     qqm = qd[cnt++];
                     q8  = qd[cnt++];
                     if (qqm == bytevecC[c7 ^ q8]
                     &&  qqm == bytevecL[l7 ^ q8]
                     &&  qqm == bytevecX[x7 ^ q8])
                     {
                        ps[iret++] = _mm_set_epi16(0, qqm, q8, q7, q6, q5, q4, q3);
                     }
                  }
               }
            }
         }
      }
   }
   return iret;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:23:40.740

如果您确实需要以随机方式访问内存，那么您只能做一些装饰来节省主内存停顿的时间。硬件根本无法随机跳转到内存地址并在单个周期内获得可用数据。当然，总是有“技巧”，通常取决于确切的芯片组。不过，没有人想到这个问题。

对于非常高性能的系统，您通常需要仔细查看算法或技巧来避免工作。在您的另一个问题的上下文中考虑这个问题[使用 C/Intel 程序集，测试 128 字节内存块是否包含全零的最快方法是什么？](https://stackoverflow.com/questions/15172102/using-c-intel-assembly-what-is-the-fastest-way-to-test-if-a-128-byte-memory-blo#comment21372091_15172102)并且使用大多数时间内存为零的事实，您可以简单地设置每 128 字节甚至 512 字节 1 位，并将其用作测试完整块的短路。这可以看作是一个[http://en.wikipedia.org/wiki/Bloom_filter](http://en.wikipedia.org/wiki/Bloom_filter)，尽管我更喜欢将其视为每个条目 1 位的数组。

对于 4Gb 查找表，您将需要 31.5Mb（每 128 字节 1 位）或 7.8Mb（每 4x 128 字节 1 位等）。这里的目的是尝试让更小的存在指示符更可能是在缓存中。当然，查找表编写器会产生额外的内存写入。

另一种技术可能根本不适合，具体取决于数据如何写入查找数组，将值的地址存储在排序数组中，而不是数组本身。这将允许您使用 320Mb 作为地址值（如果我的数学是正确的）并允许您使用二进制搜索，但可以为初始探测带来良好的缓存效率。

或者，不是立即执行最终的内部循环，而是保存所需的输入变量，然后继续进行下一个封闭循环迭代。完成后，按内存地址对这个内部循环命中列表进行排序，然后在它们自己的循环中执行它们。这种技术有很多陷阱，只有在您可能重用相同的内存块时才真正有帮助，但这种方法在现实世界中使用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T18:45:40.910

几个想法：

我会尝试对这件作品进行变体：

```
#define UNROLL(q8) qqm = bytevecM[(unsigned int)(m7 ^ q8)];    \
  if (qqm != 0                                                 \
  &&  qqm == bytevecD[(unsigned int)(s7.m128i_i32[0] ^ q8)]    \
  &&  qqm == bytevecC[(unsigned int)(s7.m128i_i32[1] ^ q8)]    \
  &&  qqm == bytevecL[(unsigned int)(s7.m128i_i32[2] ^ q8)]    \
  &&  qqm == bytevecX[(unsigned int)(s7.m128i_i32[3] ^ q8)]) { \
    ps[j++] = _mm_set_epi16(0, qqm, q8, q7, q6, q5, q4, q3); } 
```

如果您进行以下更改，它可能会表现更好：

1.  使用`PXOR`而不是四个单独的`XOR`指令
2.  拉出宏，即在最里面的循环中做`_mm_set_epi16()` *第一*
    `__m128i pp = _mm_set_epi16(0, 0, 0, q7, q6, q5, q4, q3);`
    件事。
3.  插入迭代计数器`q8`和`qqm`需要的位置/时间

随着这些变化，它会变成这样：

```
#define UNROLL(q8)                                               \
qqm = bytevecM[(unsigned int)(m7 ^ q8)];                         \
if (qqm) {                                                       \
    pp = _mm_insert_epi16(pp, q8, 2);                            \
    __m128i qq = _mm_xor_si128(_mm_set1_epi32(q8), s7));         \
    if (qqm == bytevecD[qq.m128i_i32[0]] &&                      \
        qqm == bytevecC[qq.m128i_i32[1]] &&                      \
        qqm == bytevecL[qq.m128i_i32[2]] &&                      \
        qqm == bytevecX[qq.m128i_i32[3]]))                       \
        ps[j++] = _mm_insert_epi16(pp, qqm, 1);                  \
} 
```

此外，您从提早获得加速的事实`UNROLL(96)`意味着您在那时为 s 的所有 128 字节部分预填充了第二个缓存`bytevec`线。这也应该可以通过添加：

```
_mm_prefetch(&bytevecM[m7 | 0x60], _MM_HINT_T0);
_mm_prefetch(&bytevecD[s7.m128i_i32[0] | 0x60], _MM_HINT_T0);
_mm_prefetch(&bytevecC[s7.m128i_i32[1] | 0x60], _MM_HINT_T0);
_mm_prefetch(&bytevecL[s7.m128i_i32[2] | 0x60], _MM_HINT_T0);
_mm_prefetch(&bytevecX[s7.m128i_i32[3] | 0x60], _MM_HINT_T0); 
```

前第一`UNROLL(1)`。

# c - deleteNode 函数错误

> ID：15036171
> 
> 赞同：-3
> 
> 时间：2013-02-23T02:00:11.870
> 
> 标签：c

这是我的删除节点功能，谁能帮我看看它有什么问题？我似乎遇到了很多麻烦，因为我不明白其中的某些部分。

1.  指向头部的指针应该如何使用？struct lnode** head，我知道这是一个指向头指针的指针。但是我不确定我是否正确使用它。

2.  代码的第二部分，我不确定在删除函数调用的节点后是否正确连接了两个节点。

    ```
    void deleteNode (struct lnode** head, struct lnode* node) {
            if((*head) == node){
               struct lnode* temp = (*head) -> next;
               free(node);
               free(node->word);
               *head = temp;
            }
            else{
             struct lnode *nextNode = node->next;
             struct lnode *prevNode;
             while((*head) != NULL){
                if((*head)->next = node){
                    prevNode = *head;
                    break;
                }
                else
                    *head = (*head) ->  next;
            }
            prevNode->next = nextNode;
            free(node);
            free(node->word);
        }
    } 
    ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:08:59.233

请尝试使用此修改后的程序。在原始程序中，存在以下问题。

如果要删除的节点与 head 匹配，那么您将释放该节点两次。当您试图释放已经被释放的内存时，这将给出一个例外。

条件的比较`if`需要`if((*head)->next == node)`代替`if((*head)->next = node)`

释放内存的顺序很重要。因此`node->word`应该在释放`node`.

```
void deleteNode (struct lnode** head, struct lnode* node) {
     struct lnode *prevNode = *head;
    if((*head) == node){
       struct lnode* temp = (*head) -> next;
       *head = temp;
    }
    else{
     struct lnode *nextNode = node->next;
     while((*head) != NULL){
        if((*head)->next == node){
            prevNode = *head;
            break;
        }
        else
            *head = (*head) ->  next;
    }
    prevNode->next = nextNode;
    free(node->word);
    free(node);
}
} 
```

# php - 将 Jquery + Php 搜索传递回 javascript？

> ID：15036173
> 
> 赞同：0
> 
> 时间：2013-02-23T02:00:31.407
> 
> 标签：php, javascript, jquery, ajax

我有一个javascript函数如下::

```
 //THIS IS javascript.js
function dosomething(data){
 //splits and do something else
}

$(document).ready(function () {
dosomething();
} 
```

下面是一个来自搜索的 php 文件（使用 jquery 和 ajax 进行数据库搜索）

```
//THIS IS mysearch.php
while($row = mysqli_fetch_array($result,MYSQLI_ASSOC)){
    $url = $row['url']; 
    $text = $row['text'];
    $argument = $url"."$separator"."$text"; 
```

);

如何将 $argument 传递给 javascript 函数？我试过这样的事情。

```
echo '<p><a href="javascript:dosomething('.$argument.')">'.$text.'</a></p>'; 
```

**什么是解决这个问题的好方法？**

任何帮助，将不胜感激！提前致谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T02:04:49.633

这应该可以解决问题：

```
echo '<p><a href="javascript:dosomething(\''.htmlspecialchars($argument).'\')">'.$text.'</a></p>'; 
```

// 编辑：

如果遇到像 öäü 等特殊字符的问题，可以使用 json_encode()

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T02:07:17.603

很多人喜欢使用 json 和 ajax。

[http://api.jquery.com/jQuery.getJSON/](http://api.jquery.com/jQuery.getJSON/)

[http://php.net/manual/en/function.json-encode.php](http://php.net/manual/en/function.json-encode.php)

# asp.net-mvc - 一个云服务中的多个 Web 角色？

> ID：15036174
> 
> 赞同：1
> 
> 时间：2013-02-23T02:00:39.697
> 
> 标签：asp.net-mvc, azure

在我的 mvc 应用程序中，在服务定义文件中添加了一个 Web 角色（与另一个 Web 角色相同的项目），但出现类似“没有与（Webrole 名称）关联的项目”之类的错误。

我的疑问是，

1) 是否有机会运行具有两个 Web 角色的一个项目？

2) 目前我的应用程序正在使用一个 Web 角色和一个实例和 VMsize="small"。但我的应用程序运行性能低下。

3）有没有机会通过增加角色中的实例数量来提高应用程序的性能？

谢谢，

PCSSCP。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T09:30:13.227

错误“没有与...关联的项目”表示您已指定存在另一个 Web 角色，但您的解决方案（ASP.NET Web 项目、MVC 项目）中没有应部署为该 Web 角色的项目。在使用两个 Web 角色时，请确保您的解决方案中有两个 Web 项目。

作为替代方案，您可以部署到单个 Web 角色中的 Web 项目。

增加 VM 大小可为您的 Web 角色提供更多资源（CPU 速度、RAM 等）来执行，这可能会提高访问者的性能体验。

使用更多实例不会使应用程序更快，但由于所有请求都在实例之间共享，您可以同时为更多用户提供服务。

# asp.net - 过滤 AsyncFileUpload 中的文件类型

> ID：15036175
> 
> 赞同：0
> 
> 时间：2013-02-23T02:00:40.687
> 
> 标签：asp.net, ajax

有什么方法可以过滤我将使用 ajax 的 AsyncFileUpload 上传的文件？这是我想做的事情，这可能吗？

![在此处输入图像描述](../Images/d99d8acdbe6651f938752486354b4b99.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-04T19:40:22.363

Web 表单的 AsyncFileUpload 没有此选项。您是否必须实施此验证。

像这样：

```
 switch (`"file.exe"`)
        {
            case "exe":
                OK = false;
                break;
            case "dll":
                OK = false;
                break;
        } 
```

而当你上传文件时，你必须调用这个方法。

PS.：对不起我的英语，我是巴西人，我的英语很差。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-12T07:10:52.563

在后面的代码上使用下面

```
 Protected Sub FileUploadComplete(ByVal sender As Object, ByVal e As EventArgs)

    Dim contentType As String = AsyncFileUploadProfileImage.ContentType

    If (contentType = "image/jpeg" Or contentType = "image/png") Then
        Dim filename As String = System.IO.Path.GetFileName(AsyncFileUploadProfileImage.FileName)
        AsyncFileUploadProfileImage.SaveAs(Server.MapPath("img_prof/") + filename)
    Else
        lblMesg.Text = "We support only images of type jpg and png"
    End If

End Sub 
```

# coldfusion - CF：将 Fusioncharts 图表保存为图像以通过电子邮件发送

> ID：15036180
> 
> 赞同：2
> 
> 时间：2013-02-23T02:01:37.703
> 
> 标签：coldfusion, fusioncharts

有没有人有这方面的例子？谷歌今晚不是我的朋友。我有最新版本的 FusionCharts。我试图弄清楚如何将图形保存为图像文件以通过电子邮件发送。

我知道如何保存图像，然后将图像插入 HTML 电子邮件，我以前使用其他图形产品也这样做过。我只是不能很好地举例说明如何使用 Fusioncharts 做到这一点。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T10:11:05.053

在模板中使用以下代码并将 imageSaveURL 属性指向该模板。

您的图表提交了重建图表所需的所有数据。在我的示例中，我将其提供给浏览器，但您可以将其保存在本地，然后`cfmail`在必要时附加到。

我很确定我最初是从 fusioncharts 论坛得到的。这是针对 fusioncharts 3.1 更新的。

```
<cfif structKeyExists(Form, "width") >
    <cfset width = int(Form.width) />
<cfelse>
    <cfset width = int(Form.Meta_Width) />
</cfif>
<cfif structKeyExists(Form, "height") >
    <cfset height = int(Form.height) />
<cfelse>
    <cfset height = int(Form.Meta_Height) />
</cfif>

<cfif structKeyExists(Form, "data") >
    <cfset Form.data = Form.data />
<cfelse>
    <cfif structKeyExists(Form, "stream") >
        <cfset Form.data = Form.stream />
    </cfif>
</cfif>

<cfset user = viewState.getValue("user", structNew()) />

<!--- Impose some limits to mitigate DOS attacks --->
<cfif Not (0 lte width and width lte 5000)>
    <cfthrow message="Width out of range." />
</cfif>
<cfif Not (0 lte height and height lte 5000)>
    <cfthrow message="Height out of range." />
</cfif>

<!--- Check if we have the chart data --->
<cfif Not StructKeyExists(Form, "data") or Not Len(Trim( Form.data ))>
    <cfthrow message="Image Data not supplied." />
</cfif>

<!--- Default background color is white --->
<cfif Not StructKeyExists(Form, "bgcolor") or Not Len(Trim( Form.bgcolor ))>
    <cfset Form.bgcolor = "FFFFFF" />
</cfif>

<cfset gColor = CreateObject("java", "java.awt.Color") />
<cfset chart = CreateObject("java", "java.awt.image.BufferedImage") />
<cfset chart.init( JavaCast("int", width), JavaCast("int", height), chart.TYPE_3BYTE_BGR) />
<cfset gr = chart.createGraphics() />
<cfset gr.setColor( gColor.decode("##" & Form.bgcolor) ) />
<cfset gr.fillRect(0, 0, JavaCast("int", width), JavaCast("int", height)) />

<!--- Get rows with pixels --->
<cfset rows = ListToArray(Form.data, ";") />

<cfloop from="1" to="#ArrayLen(rows)#" index="i">

    <cfset pixels = ListToArray(rows[i], ",") />
    <!--- Horizontal index (x scale) --->
    <cfset horizIndex = 0 />

    <cfloop from="1" to="#ArrayLen(pixels)#" index="j">

        <cfif ListLen(pixels[j], "_") eq 2>
            <!--- We have the color and the number of times it must be repeated --->
            <cfset color  = ListGetAt(pixels[j], 1, "_") />
            <cfset repeat = ListGetAt(pixels[j], 2, "_") />
        <cfelse>
            <!--- Background color; how many pixels to skip --->
            <cfset color  = "" />
            <cfset repeat = ListGetAt(pixels[j], 1, "_") />
        </cfif>

        <cfif Len(Trim(color))>

            <!---  If the hexadecimal code is less than 6 characters, prefix with 0 to get a 6 char color --->
            <cfif Len(Trim(color)) lt 6>
                <cfset color = RepeatString(0, 6 - Len(Trim(color))) & color />
            </cfif>

            <!--- Draw a horizontal line for the number of pixels we must repeat --->
            <cfset gr.setColor(gColor.decode("##" & color)) />
            <cfset gr.drawLine(JavaCast("int", horizIndex), JavaCast("int", i - 1), JavaCast("int", horizIndex + repeat -1), JavaCast("int", i - 1)) />
        </cfif>

        <cfset horizIndex = horizIndex + repeat />
    </cfloop>

</cfloop>

<!--- Get writer for Jpeg --->
<cfset writer = "" />
<cfset iter = CreateObject("java", "javax.imageio.ImageIO").getImageWritersByFormatName("jpg") />
<cfloop condition="iter.hasNext()">
    <cfset writer = iter.next() />
</cfloop>

<!--- Set Jpeg quality to maximum --->
<cfset jpgParams = CreateObject("java", "javax.imageio.plugins.jpeg.JPEGImageWriteParam").init( CreateObject("java", "java.util.Locale").init("en") ) />
<cfset jpgParams.setCompressionMode( jpgParams.MODE_EXPLICIT ) />
<cfset jpgParams.setCompressionQuality( 1 ) />

<!--- Write image to a memory stream --->
<cfset imageOutput = CreateObject("java", "java.io.ByteArrayOutputStream").init() />
<cfset writer.setOutput( CreateObject("java", "javax.imageio.stream.MemoryCacheImageOutputStream").init( imageOutput ) ) />
<cfset writer.write(JavaCast("null", 0), CreateObject("java", "javax.imageio.IIOImage").init(chart, JavaCast("null", 0), JavaCast("null", 0)), jpgParams) />

<!--- Stream the image to the browser (hint browser to display the Save dialog) --->
<cfset filename="whatever.jpg" />
<cfheader name="Content-Disposition" value="attachment; filename=""#filename#""">
<cfcontent type="image/jpeg" variable="#imageOutput.toByteArray()#"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T06:04:31.003

查看最新的博客文章[在服务器端导出图表图像，](http://blog.fusioncharts.com/2013/03/how-to-save-charts-as-images-at-server-side/)其中描述了两个选项（wkhtmltoimage 和 PhantomJS。）以及两者的分步说明。

对于 ColdFusion，您可以尝试以下代码：

例如：

```
<cfexecute name="C:\Program Files\wkhtmltopdf\wkhtmltoimage.exe" arguments="--javascript-delay 10000 http://docs.fusioncharts.com/charts/Code/MyFirstChart/ms-weekly-sales-no-animation.html savedimage.png" /> 
```

执行上述脚本时，我们提供以下参数：图表完全呈现。

# ruby-on-rails - 为什么 Ruby 只运行一些测试而不运行其他测试？

> ID：15036184
> 
> 赞同：1
> 
> 时间：2013-02-23T02:02:26.803
> 
> 标签：ruby-on-rails, ruby, unit-testing, testing, testunit

我正在使用这个命令来运行一些测试......

```
bundle exec ruby -Itest test/functional/*.rb 
```

在我的`test/functional`目录中，我有两个文件...

```
file_sets_controller_test.rb
user_sessions_controller_test.rb 
```

使用上面的命令，所有的测试`file_sets_controller_test.rb`都运行，但`user_sessions_controller_test.rb`根本不运行——没有错误或其他输出报告。

但是，我可以直接运行该文件没问题，用这个......

```
bundle exec ruby -Itest test/functional/user_sessions_controller_test.rb 
```

这很好用。

我知道另一种选择是使用`rake test functionals`，但与直接运行它们相比，这非常慢。

* * *

```
ruby 1.9.3p327 (2012-11-10 revision 37606) [x86_64-darwin11.4.2]

Rails 3.2.12 
```

* * *

这是我的 Gemfile 的一部分...

```
group :development, :test do

  gem 'ansi'
  gem 'turn'

  gem 'minitest'
  gem 'minitest-matchers'

end 
```

这是我的`test_helper.rb`...

```
ENV["RAILS_ENV"] = "test"
require File.expand_path('../../config/environment', __FILE__)
require 'rails/test_help'

require 'turn/autorun'
Turn.config.ansi = true

require 'minitest/autorun'

class ActiveSupport::TestCase

  fixtures :all

end 
```

据我所知，移除 Turn 和 Minitest 宝石并没有改变任何东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-23T02:15:44.170

该`ruby`命令将要运行的 ruby​​ 文件作为其第一个参数，并使 ruby​​ 程序可以使用其他参数。shell 将您的 glob 表达式扩展为 2 个参数并将它们传递给`ruby`，因此`ruby`运行扩展中的第一个文件名。

额外的：

我认为你可以做你想做的事情，比如......

```
bundle exec ruby -Itest -e "Dir.glob('test/functional/*_test.rb').each{|f| require File.expand_path(f)}" 
```

# python - 是否需要定义 Python 列表才能向其附加内容？

> ID：15036189
> 
> 赞同：0
> 
> 时间：2013-02-23T02:03:09.520
> 
> 标签：python, list, append

我需要知道为什么以下两个代码块返回不同的输出。我有：

```
somelist = ['foo', 'bar']
somelist.append('baz')
print somelist 
```

`['foo', 'bar', 'baz']`按预期打印。然而，

```
print ['foo', 'bar'].append('baz') 
```

打印`None`。提前致谢！

**编辑：**谢谢大家。有没有办法在一行代码中使用`append`函数和命令？`print`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T02:03:54.677

`.append`on a list会**改变**列表。由于它正在改变列表，python 采用函数应该返回的约定，`None`以明确表明函数的目的是更改它的参数（在这种情况下，方法绑定到的列表实例绑定）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T02:04:10.743

`list.append`是一个就地操作，这意味着它返回`None`，但它会改变实际列表本身。

# c++ - 混淆三种参考形式

> ID：15036199
> 
> 赞同：0
> 
> 时间：2013-02-23T02:04:26.090
> 
> 标签：c++

```
 T const&
  const T&
  T& const   //error 
```

以上三者有什么区别？如果`&`是`*`，会发生什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T02:05:43.350

前两种形式是等价的，尽管我更喜欢第一种形式，因为它更容易推理模板参数推导，并且它澄清*了什么*是常量（它之前的所有内容）：因此，`int const*`比`const int*`.

此外，没有办法用前缀语法声明一个常量指针（例如，没有等价的`int* const`where`const`出现在类型的开头）。因此，为了语法统一，我宁愿总是使用后缀版本。

第三种形式在常规上下文中使用是错误的，相当于`T&`推导模板参数时（引用不能重新分配，所以它们在某种意义上总是恒定的，`const`被认为是多余的）。

如果你`&`改成`*`，那么前两种形式*仍然*是相同的，而第三种现在声明了一个指向类型对象的常量指针`T`。请注意，这意味着指针本身是常量（您不能重新分配它），而不是指向的对象。

```
int a = 0;
int b = 1;

int* const pA = &a;   // p cannot be reassigned, a can be modified
*pA = 42; // OK
 pA = &b; // ERROR

int const* pB = &b;   // p can be reassigned, b cannot be modified
*pB = 42; // ERROR
pB = &a; // OK

int const* const pC = &a; // p cannot be reassigned, a cannot be modified
*pC = 42; // ERROR
pC = &b; // ERROR

int& const d = a; // ERROR 
```

# python - 如何在字符串以 NUL 终止之前接收 python SocketServer

> ID：15036203
> 
> 赞同：0
> 
> 时间：2013-02-23T02:04:57.717
> 
> 标签：python, sockets, tcp, socketserver, nul

在 Python 中，我将如何编写接收字符串的 TCP SocketServer，直到`\0`找到 NUL 字符（）？完全接收到字符串后，我需要套接字继续能够接收新字符串。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T02:31:27.197

在阅读文档时，您要使用“使用流的[替代请求处理程序类](http://docs.python.org/3.3/library/socketserver.html)（通过提供标准文件接口来简化通信的类文件对象）”：

```
class MyTCPHandler(socketserver.StreamRequestHandler): 
```

一旦你有一个类似接口的文件，你就可以提取字节直到你得到 '\0' NUL 字符。您将阻止 read() 请求。

# python - numpy协方差矩阵

> ID：15036205
> 
> 赞同：22
> 
> 时间：2013-02-23T02:05:32.663
> 
> 标签：python, numpy, covariance

假设我有两个长度为 25 的向量，我想计算它们的协方差矩阵。我尝试使用 numpy.cov 执行此操作，但总是以 2x2 矩阵结束。

```
>>> import numpy as np
>>> x=np.random.normal(size=25)
>>> y=np.random.normal(size=25)
>>> np.cov(x,y)
array([[ 0.77568388,  0.15568432],
       [ 0.15568432,  0.73839014]]) 
```

使用 rowvar 标志也无济于事 - 我得到完全相同的结果。

```
>>> np.cov(x,y,rowvar=0)
array([[ 0.77568388,  0.15568432],
       [ 0.15568432,  0.73839014]]) 
```

如何获得 25x25 协方差矩阵？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-23T02:15:52.777

你有两个向量，而不是 25。我所在的计算机没有 python，所以我无法测试这个，但试试：

```
z = zip(x,y)
np.cov(z) 
```

当然....真正你想要的可能更像是：

```
n=100 # number of points in each vector
num_vects=25
vals=[]
for _ in range(num_vects):
    vals.append(np.random.normal(size=n))
np.cov(vals) 
```

`num_vects`这需要1x`n`向量的协方差（我认为/希望）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-02-25T13:55:43.587

试试这个：

```
import numpy as np
x=np.random.normal(size=25)
y=np.random.normal(size=25)
z = np.vstack((x, y))
c = np.cov(z.T) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-04-02T09:10:12.737

#  来自样本向量的协方差矩阵

为了澄清关于什么是使用两个 N 维向量定义的协方差矩阵的小混乱，**有两种可能性**。

您必须问自己的问题是您是否考虑：

*   **每个向量作为一个单一变量的 N 个实现/样本**（例如两个 3 维向量`[X1,X2,X3]`和`[Y1,Y2,Y3]`，其中变量 X 和 Y 分别有 3 个实现）
*   **每个向量作为 N 个变量的 1 个实现**（例如，两个 3 维向量`[X1,Y1,Z1]`和`[X2,Y2,Z2]`，其中每个向量的变量 X、Y 和 Z 有 1 个实现）

由于协方差矩阵直观地定义为基于两个不同变量的方差：

*   在第一种情况下，**您有 2 个变量，每个变量有 N 个示例值，因此您最终得到一个 2x2 矩阵**，其中协方差是通过每个变量的 N 个样本来计算的
*   在第二种情况下，**你有 N 个变量，每个变量 2 个样本，所以你最终得到一个 NxN 矩阵**

# 关于实际问题，使用 numpy

**如果您认为每个向量有 25 个变量**（使用 3 而不是 25 来简化示例代码），那么一个向量中的多个变量的一种实现，使用`rowvar=0`

```
# [X1,Y1,Z1]
X_realization1 = [1,2,3]

# [X2,Y2,Z2]
X_realization2 = [2,1,8]

numpy.cov([X,Y],rowvar=0) # rowvar false, each column is a variable 
```

代码返回，考虑 3 个变量：

```
array([[ 0.5, -0.5,  2.5],
       [-0.5,  0.5, -2.5],
       [ 2.5, -2.5, 12.5]]) 
```

**否则，如果您认为一个向量是一个变量的 25 个样本**，请使用`rowvar=1`（numpy 的默认参数）

```
# [X1,X2,X3]
X = [1,2,3]

# [Y1,Y2,Y3]
Y = [2,1,8]

numpy.cov([X,Y],rowvar=1) # rowvar true (default), each row is a variable 
```

代码返回，考虑 2 个变量：

```
array([[ 1\.        ,  3\.        ],
       [ 3\.        , 14.33333333]]) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-23T02:16:31.293

阅读文档，

```
>> np.cov.__doc__ 
```

或查看[Numpy Covariance](http://docs.scipy.org/doc/numpy/reference/generated/numpy.cov.html)，Numpy 将数组的每一行视为一个单独的变量，因此您有两个变量，因此您得到一个 2 x 2 协方差矩阵。

我认为上一篇文章有​​正确的解决方案。我有解释:-)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-08-05T18:34:08.650

我想你正在寻找的实际上是一个协方差函数，它是一个时滞函数。我正在做这样的自协方差：

```
 def autocovariance(Xi, N, k):
    Xs=np.average(Xi)
    aCov = 0.0
    for i in np.arange(0, N-k):
        aCov = (Xi[(i+k)]-Xs)*(Xi[i]-Xs)+aCov
    return  (1./(N))*aCov

autocov[i]=(autocovariance(My_wector, N, h)) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-11-20T13:43:47.357

你应该改变

```
np.cov(x,y, rowvar=0) 
```

到

```
np.cov((x,y), rowvar=0) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-02-01T19:08:47.113

你得到的（2 x 2）比 25*25 更有用。X 和 Y 的协方差是对称 cov_matrix 中的非对角项。

如果你坚持我认为没用的（25 x 25），那你为什么不写出定义呢？

```
x=np.random.normal(size=25).reshape(25,1) # to make it 2d array.
y=np.random.normal(size=25).reshape(25,1)

cov =  np.matmul(x-np.mean(x), (y-np.mean(y)).T) / len(x) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-23T02:30:33.980

如上所述，你只有两个向量，所以你只会得到一个 2x2 cov 矩阵。

IIRC 的 2 个主要对角线项将是 sum( (x-mean(x))**2) / (n-1) ，对于 y 也是如此。

2 个非对角项将是 sum( (x-mean(x))(y-mean(y)) ) / (n-1)。在这种情况下，n=25。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-04-29T16:56:56.023

根据文档，您应该期望列中的变量向量：

```
If we examine N-dimensional samples, X = [x1, x2, ..., xn]^T 
```

虽然后来它说每一行都是一个变量

```
Each row of m represents a variable. 
```

所以你需要输入你的矩阵作为转置

```
x=np.random.normal(size=25)
y=np.random.normal(size=25)
X = np.array([x,y])
np.cov(X.T) 
```

并根据维基百科：[https ://en.wikipedia.org/wiki/Covariance_matrix](https://en.wikipedia.org/wiki/Covariance_matrix)

```
X is column vector variable
X = [X1,X2, ..., Xn]^T
COV = E[X * X^T] - μx * μx^T   // μx = E[X] 
```

你可以自己实现它：

```
# X each row is variable
X = X - X.mean(axis=0)
h,w = X.shape
COV = X.T @ X / (h-1) 
```

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2016-07-31T03:34:22.527

我认为您不了解协方差矩阵的定义。如果您需要 25 x 25 协方差矩阵，则需要 25 个向量，每个向量具有 n 个数据点。

# html - 无法获得图标字体/精灵翻转来更改颜色

> ID：15036207
> 
> 赞同：0
> 
> 时间：2013-02-23T02:05:43.513
> 
> 标签：html, css, css-sprites

我正在尝试在我的主导航上方放置一些相关图标。本质上，我想要完成的是当用户将鼠标悬停在适当的区域（具有大填充的标签）上时，将文本和图标更改为不同的颜色。我在实现这一点时遇到了问题。

我的想法是使用图标字体最容易做到这一点，但它们只是内联的。然后我尝试使用图标字体制作一个新字体并将它们放置在 man nav 上方，但是当用户将鼠标悬停在指定区域上时，我无法弄清楚如何让它改变颜色。

我还尝试了翻转方法，但我无法开始工作，因为当我在标签中创建一个类并将显示更改为阻止时，它会关闭我的导航。我的代码：

```
 <ul id="nav" role="navigation">
   <li><a href="#">EXCERPT</a></li>
   <li><a href="#">ABOUT</a></li>
   <li><a href="#">CONTACT</a></li>
</ul>

#header {
   overflow: hidden;
   background-color: #F5F5F5;
   border-bottom: 2px black solid;
   position: relative;
}

#nav {
   float: right;
   position: absolute;
   bottom: 0;
   right: 0;
   margin: 0 0 10px 0;
}

#nav li {
   list-style: none;
   display: inline;
   font-size: 2.5em;
   letter-spacing: 0.1em;
   font-family: 'OstrichSansMedium';
}

#nav a {
   text-decoration: none;
   color: #C4C4C4;
   padding: 200px 20px 15px;
}

#nav a:hover {
   color: #000000;
   background-color: green;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T02:56:39.670

我打算为你做一个小提琴，但 jsfiddle 已经停止维护了。您将不得不使用一些脚本来处理带有图像等的复杂条形图。精灵非常好且有效，但同样您至少需要几行脚本来支持它

查看[jQueryUI 上选项卡](http://jqueryui.com/tabs/)的来源。您上面的结构只不过是一个标签栏。

也看看这个网站。[现场示例](http://www.universal-american-medicare.com)顶部导航全部由图像、CSS 和一点点 jQuery 完成。抓住这个的来源，这样你就可以随时查看它。

# iframe - iFrame Click 事件未触发

> ID：15036222
> 
> 赞同：4
> 
> 时间：2013-02-23T02:09:02.063
> 
> 标签：iframe, jquery

如何使用 JQuery 捕获对 iframe 的点击。我有一个亚马逊横幅，当用户单击 iframe 时，我需要关闭其容器 DIV。我试过'内容'，点击iframe，绑定事件但没有任何效果。当我单击 iframe 时，它​​会在另一个选项卡上打开亚马逊的页面，但单击事件永远不会触发。我设置了一个断点并发出警报以确保。

我正在使用最新的 JQuery 1.9 版并在 Chrome 上对其进行了测试。我还考虑过捕获全局单击 ($(document).click) 并检查单击区域，但是当我单击 iframe 时，$(document).click 不会触发。有什么建议么？

同样，它是一个亚马逊横幅 iframe，它托管在亚马逊上而不是我的服务器上。

不起作用的常规绑定示例：http: [//jsbin.com/oyanis/4/edit](http://jsbin.com/oyanis/4/edit)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T03:43:34.997

有一个巧妙的技巧可以在 iframe 内容上获得“点击”。

你可以这样做：

```
<div id="iframeinside">
    <iframe />
</div> 
```

现在可以在 js 中说类似的内容：

```
 var oldActive = document.activeElement; /* getting active Element */
 var frame = $('#iframeinside iframe')[0];
 $('#iframeinside').mouseenter(function() {
      /* Setting interval to 1ms for getting eventually x,y mouse coords*/
      oldActive = document.activeElement;
      setInterval('doSomething()', 1); 
 });

 $('#iframeinside').mouseleave(function () {
      /* clear interval cause we arent over the element anymore*/
      clearInterval(intervalId); 
 }); 
```

这些间隔确实调用：

```
function doSomething() {
    /* if the focus has changed to the iframe */
    if(oldActive != frame && document.activeElement == frame) {
        oldActive = document.activeElement;
        alert(myQuery);
        alert('click did happen to the iframe');
    }
} 
```

我用它做了几件事，它总是有效的。我没有检查的是ie6,7和哥哥怎么样。

# mysql - 带有多个 Where 子句的 SQL

> ID：15036228
> 
> 赞同：0
> 
> 时间：2013-02-23T02:09:50.753
> 
> 标签：mysql, sql, having-clause

首先——我已经阅读了大约 7 页标题相似的帖子，但找不到适合我挑战的正确见解

我的 SQL：

```
SELECT name, address, lat, lng, city, state, phone, zip, info
    , ( 3959 * acos( cos( radians('37.4969') ) * cos( radians( lat ) ) * cos( radians( lng ) - radians('-122.2674') ) + sin( radians('37.4969') ) * sin( radians( lat ) ) ) ) AS distance 
FROM myhealthfinder_map 
HAVING distance < '50'  and location = '2'  
ORDER BY distance LIMIT 0 , 10 
```

我收到错误消息：无效查询：“有子句”中的未知列“位置”

如果不是 HAVING 我只是让它 WHERE location = '2' 那么它工作正常[它找到列]（但我需要距离选择器）。

关于如何将其击倒的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T02:13:31.957

同时使用 WHERE 和 HAVING。 `HAVING`用于聚合和计算列。在`WHERE`普通的旧柱子上。

```
SELECT name, address, lat, lng, city, state, phone, zip, info
    , ( 3959 * acos( cos( radians('37.4969') ) * cos( radians( lat ) ) * cos( radians( lng ) - radians('-122.2674') ) + sin( radians('37.4969') ) * sin( radians( lat ) ) ) ) AS distance 
FROM myhealthfinder_map 
WHERE location = '2' 
HAVING distance < '50'  
ORDER BY distance LIMIT 0 , 10 
```

在这里找到更多解释[WHERE vs HAVING](https://stackoverflow.com/questions/2905292/where-vs-having)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T02:20:37.473

不要使用`HAVING`没有`GROUP BY`。你可以试试这个

```
SELECT name, address, lat, lng, city, state, phone, zip, info, ( 3959 * acos( cos( radians('37.4969') ) * cos( radians( lat ) ) * cos( radians( lng ) - radians('-122.2674') ) + sin( radians('37.4969') ) * sin( radians( lat ) ) ) ) AS distance 
  FROM myhealthfinder_map 
 WHERE location = '2' AND
( 3959 * acos( cos( radians('37.4969') ) * cos( radians( lat ) ) * cos( radians( lng ) - radians('-122.2674') ) + sin( radians('37.4969') ) * sin( radians( lat ) ) ) ) < 50
 ORDER BY distance LIMIT 0 , 10 
```

它不漂亮，但它应该工作。

# ios - NSData 数据包解释

> ID：15036229
> 
> 赞同：0
> 
> 时间：2013-02-23T02:10:03.380
> 
> 标签：ios, ios6, nsdata, packet

关于我正在制作的应用程序中数据包的解释，我有一个相当复杂的问题。主机应用程序使用以下结构向客户端应用程序发送数据包：

[10 字节的头][选定的可变字节长度客户端的peerID][空字节][可变字节长度客户端的peerID][空字节][4 字节的int][可变字节长度客户端的peerID][空字节][int of 4 bytes]

以下是在此结构下生成的示例数据包：

434e4c50 00000000 006a3134 31303837 34393634 00313233 38313638 35383900 000003e8 31343130 38373439 36340000 0003e8

转换后看起来像这样：

CNLP j1410874964 1238168589 Ë1410874964 Ë

“CNLP j”是10字节的包头。“1410874964”是所选客户端的 peerID。“1238168589”是另一个客户端的 peerID。"Ë" 的 int 值为 1000。"1410874964" 是另一个客户端（在本例中为选定客户端）的 peerID。“Ë”也有一个int值1000。基本上，在这个数据包中，我传达了两件事——选定的客户端是谁以及与每个客户端关联的int值。

我的问题存在于解释端（客户端）。为了解释这种特殊类型的数据包，我使用以下方法：

```
 + (NSMutableDictionary *)infoFromData:(NSData *)data atOffset:(size_t) offset
{
    size_t count;

    NSMutableDictionary *info = [NSMutableDictionary dictionaryWithCapacity:8];

    while (offset < [data length])
    {
        NSString *peerID = [data cnl_stringAtOffset:offset bytesRead:&count];
        offset += count;

        NSNumber *number = [NSNumber numberWithInteger:[data cnl_int32AtOffset:offset]];
        offset += 4;

        [info setObject:number forKey:peerID];
    }

    return info;
} 
```

通常，这些数据包中的每一个的范围在 49 到 51 个字节之间。“offset”在之前的方法中设置，以反映包头之后的字节数加上所选播放器之后的空字节（在上述数据包的情况下，为 21）。“count”被初始化为 1。在这个特定的例子中，长度是 51。下面的方法被传递了上面的参数：

```
 - (NSString *)cnl_stringAtOffset:(size_t)offset bytesRead:(size_t *)amount
{
    const char *charBytes = (const char *)[self bytes];
    NSString *string = [NSString stringWithUTF8String:charBytes + offset];
    *amount = strlen(charBytes + offset) + 1;
    return string;
} 
```

该方法应该读取数据包中的可变长度字符串，将偏移量设置为 peerID 字符串后面的空字节填充后的字节，并返回读取的字符串。然后将“数量”设置为该方法读取的字符串的字节数（这将成为返回第一个方法后的新计数值）。然后将“offset”和“count”加在一起成为新的“offset”——从这里开始解释数据包的 int 部分。上述参数传递给以下方法：

```
- (int)cnl_int32AtOffset:(size_t)offset
{
    const int *intBytes = (const int *)[self bytes];
    return ntohl(intBytes[offset / 4]);
} 
```

此方法旨在返回在数据包的当前偏移值处读取的 32 位（4 字节）int 值。我认为当偏移量是一个不能被 4 整除的数字时，此方法中存在问题。在这种情况下，第一个 int 值 1000 被正确解释，并且在 while 的第一次迭代期间将 32 作为偏移量返回环形。但是，在第二次迭代期间，解释的 int 值是 909377536（通过读取数据包中的字节 36340000 而不是字节 000003E8 获得）这可能是由于此迭代期间的偏移量设置为 47（不能被 4 整除） . 在解释了上述类别中的 32 位 int 之后，在第一种方法中将偏移量添加 4 以占 4 字节（32 位 int）。如果我对不能被零整除的偏移量的直觉是正确的，非常感谢任何解决此问题的建议。很长一段时间以来，我一直在寻找解决这个问题的方法，也许新鲜的眼睛可能会有所帮助。谢谢你的帮助！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T02:39:09.443

不可移植的版本（由于许多原因未定义的行为）：

```
return ntohl(*(const int *)([self bytes]+offset)); 
```

半便携式版本有点棘手，但[在 C99](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf)中，您似乎可以假设`int32_t`是“通常的”二进制补码表示（没有陷阱表示，没有填充位），因此：

```
// The cast is necessary to prevent arithmetic on void* which is nonstandard.
const uint8_t * p = (const uint8_t *)[self bytes]+offset;
// The casts ensure the result type is big enough to hold the shifted value.
// We use uint32_t to prevent UB when shifting into the sign bit.
uint32_t n = ((uint32_t)p[0]<<24) | ((uint32_t)p[1]<<16) | ((uint32_t)p[2]<<8) | ((uint32_t)p[3]);
// Jump through some hoops to prevent UB on "negative" numbers.
// An equivalent to the third expression is -(int32_t)~n-1.
// A good compiler should be able to optimize this into nothing.
return (n <= INT32_MAX) ? (int32_t)n : -(int32_t)(UINT32_MAX-n)-1; 
```

这不适用于没有 8 位字节的架构，但此类架构可能对如何通过网络传递事物有不同的约定。

一个好的编译器应该能够在合适的架构上将其优化为单个（可能是字节交换）负载。

# php - PHP循环；如何打印每个结果并将其延迟一秒钟，然后再回显另一个结果？

> ID：15036232
> 
> 赞同：4
> 
> 时间：2013-02-23T02:11:07.410
> 
> 标签：php, loops, delay

这是我在 stackoverflow 上的第一个问题，我只是好奇.. 是否可以在 PHP 中延迟循环？我正在尝试将每个结果打印到浏览器并在处理另一个循环之前使用 sleep() 暂停脚本，但它不起作用，这是我使用的脚本：

```
<?php
$n = 1;

while ($n < 10) {
    echo $n."<br />";
    $n++;
    sleep(1);
}
?> 
```

PS：我在 Linux Mint 上使用 Firefox 和 Apache2。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-23T02:18:17.143

服务器通常会缓冲服务器端脚本的输出，直到其中有足够的输出尝试类似这样的东西。设置输出缓冲关闭和手动刷新缓冲区的组合。注意 implcit flush 行以及 flush 和 ob_flush 行。

```
<?php 
@ini_set("output_buffering", "Off");
@ini_set('implicit_flush', 1);
@ini_set('zlib.output_compression', 0);
@ini_set('max_execution_time',1200);

header( 'Content-type: text/html; charset=utf-8' );

echo "Testing time out in seconds\n";
for ($i = 0; $i < 1150; $i++) {
    echo $i." -- ";

    if(sleep(1)!=0)
    {
        echo "sleep failed script terminating"; 
        break;
    }
    flush();
    ob_flush();
}

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T02:16:39.670

PHP 在页面呈现其内容之前完全执行并呈现其输出。所以不，你不能像你想要的那样延迟 PHP 循环。

您可以并且应该使用 javascript 来执行此操作。如果您需要像这样延迟打印的来自服务器的信息，您可以使用 AJAX 在服务器可用时从服务器中提取信息。

# java - Hibernate 更快的 EntityManagerFactory 创建

> ID：15036233
> 
> 赞同：26
> 
> 时间：2013-02-23T02:11:20.327
> 
> 标签：java, sql, hibernate, jpa, orm

在我的桌面应用程序中，新数据库经常被打开。我使用`Hibernate`/`JPA`作为 ORM。问题是，创建`EntityManagerFactory`速度很慢，在快速机器上大约需要 5-6 秒。我知道它`EntityManagerFactory`应该是重量级的，但这对于用户希望快速打开新数据库的桌面应用程序来说太慢了。

1.  我可以关闭一些 EntityManagerFactory 功能以更快地获取实例吗？或者是否可以懒惰地创建一些 EntityManagerFactory 来加快创建速度？

2.  我可以在知道数据库 url 之前以某种方式创建 EntityManagerFactory 对象吗？我很乐意关闭所有验证以使其成为可能。

3.  通过这样做，我可以汇集 EntityManagerFactorys 供以后使用吗？

4.  还有其他想法如何更快地创建 EntityManagerFactory 吗？

**更新更多信息和 JProfiler 分析**

桌面应用程序可以打开保存的文件。我们的应用程序文档文件格式由 1 个 SQLite 数据库 + 和 ZIP 文件中的一些二进制数据组成。打开文档时，会提取 ZIP 并使用 Hibernate 打开数据库。数据库都具有相同的架构，但显然不同的数据。

似乎我第一次打开文件所需的时间比以下时间长得多。我使用 JProfiler 分析了第一次和第二次运行并比较了结果。

第一次运行：

```
create EMF: 4385ms
    build EMF: 3090ms
    EJB3Configuration configure: 900ms
    EJB3Configuration <clinit>: 380ms 
```

![调用树1.png](../Images/56672400005cc5804ab3f9fd478bafd0.png).

第二次运行：

```
create EMF: 1275ms
    build EMF: 970ms
    EJB3Configuration configure: 305ms
    EJB3Configuration <clinit>: not visible, probably 0ms 
```

![compare_calltree.png](../Images/38088ff7d64108a2c6affd97f5327bca.png).

在调用树比较中，您可以看到一些方法明显更快（DatabaseManager. 作为起点）：

```
create EMF: -3120ms
    Hibernate create EMF: -3110ms
        EJB3Configuration configure: -595ms
        EJB3Configuration <clinit>: -380ms
        build EMF: -2120ms
            buildSessionFactory: -1945ms
                secondPassCompile: -425ms
                buildSettings: -346ms
                SessionFactoryImpl.<init>: -1040ms 
```

热点比较现在有有趣的结果：

![截图 compare_hotspot.png](../Images/68ca4025253562edc6d84818580563bf.png).

```
ClassLoader.loadClass: -1686ms
XMLSchemaFactory.newSchema: -184ms
ClassFile.<init>: -109ms 
```

我不确定是加载 Hibernate 类还是我的 Entity 类。

第一个改进是在应用程序启动后立即创建一个 EMF，以初始化所有必要的类（我有一个空的 db 文件作为我的应用程序附带的原型）。@sharakan 感谢您的回答，也许 DeferredConnectionProvider 已经可以解决此问题。

接下来我将尝试 DeferredConnectionProvider！但我们也许可以进一步加快速度。你还有什么建议吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-13T17:54:21.463

您应该能够通过将自己`ConnectionProvider`的装饰器实现为真实的`ConnectionProvider`.

这里的关键观察是，在创建`ConnectionProvider`an 之前不使用`EntityManager`（请参阅注释以`supportsAggressiveRelease()`获取警告）。因此，您可以创建一个`DeferredConnectionProvider`类，并使用它来构造`EntityManagerFactory`，然后等待用户输入，并在实际创建任何`EntityManager`实例之前进行延迟初始化。我把它写成一个包装器`ConnectionPoolImpl`，但是你应该能够使用任何其他的实现`ConnectionProvider`作为基础。

```
public class DeferredConnectionProvider implements ConnectionProvider {

    private Properties configuredProps;
    private ConnectionProviderImpl realConnectionProvider;

    @Override
    public void configure(Properties props) throws HibernateException {
        configuredProps = props;
    }

    public void finalConfiguration(String jdbcUrl, String userName, String password) {
        configuredProps.setProperty(Environment.URL, jdbcUrl);
        configuredProps.setProperty(Environment.USER, userName);
        configuredProps.setProperty(Environment.PASS, password);

        realConnectionProvider = new ConnectionProviderImpl();
        realConnectionProvider.configure(configuredProps);
    }

    private void assertConfigured() {
        if (realConnectionProvider == null) {
            throw new IllegalStateException("Not configured yet!");
        }
    }        

    @Override
    public Connection getConnection() throws SQLException {
        assertConfigured();

        return realConnectionProvider.getConnection();
    }

    @Override
    public void closeConnection(Connection conn) throws SQLException {
        assertConfigured();

        realConnectionProvider.closeConnection(conn);
    }

    @Override
    public void close() throws HibernateException {
        assertConfigured();

        realConnectionProvider.close();
    }

    @Override
    public boolean supportsAggressiveRelease() {
        // This gets called during EntityManagerFactory construction, but it's 
        // just a flag so you should be able to either do this, or return
        // true/false depending on the actual provider.
        return new ConnectionProviderImpl().supportsAggressiveRelease();
    }
} 
```

如何使用它的粗略示例：

```
 // Get an EntityManagerFactory with the following property set:
    //     properties.put(Environment.CONNECTION_PROVIDER, DeferredConnectionProvider.class.getName());
    HibernateEntityManagerFactory factory = (HibernateEntityManagerFactory) entityManagerFactory;

    // ...do user input of connection info...

    SessionFactoryImpl sessionFactory = (SessionFactoryImpl) factory.getSessionFactory();
    DeferredConnectionProvider connectionProvider = (DeferredConnectionProvider) sessionFactory.getSettings()
                    .getConnectionProvider();

    connectionProvider.finalConfiguration(jdbcUrl, userName, password); 
```

您可以将初始设置`EntityManagerFactory`放在单独的线程或其他东西上，这样用户就不必等待它。然后，在指定连接信息之后，他们唯一需要等待的是连接池的设置，与解析对象模型相比，这应该相当快。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-14T05:29:57.387

> *我可以关闭一些 EntityManagerFactory 功能以更快地获取实例吗？*

不信。除了初始化 JDBC 连接/池之外，EMF 并没有太多的特性。

> *或者是否可以懒惰地创建一些 EntityManagerFactory 来加快创建速度？*

与其懒惰地创建 EMF，当用户注意到性能下降时，我建议你应该朝相反的方向前进——在用户真正需要之前主动创建 EMF。在应用程序初始化期间（或至少在您了解数据库后立即）在单独的线程中预先创建一次。在您的应用程序/数据库存在的整个过程中重复使用它。

> *我可以在知道数据库 url 之前以某种方式创建 EntityManagerFactory 对象吗？*

否 - 它创建一个 JDBC 连接。

我认为一个更好的问题是：为什么您的应用程序会*动态*发现数据库连接 URL？您是说您的数据库是即时创建/提供的，并且无法提前预测连接参数。这确实是要避免的。

> *通过这样做，我可以汇集 EntityManagerFactorys 供以后使用吗？*

不，您不能汇集 EMF。这是您可以汇集的连接。

> *还有其他想法如何更快地创建 EntityManagerFactory 吗？*

我同意 - 6 秒对于 EMF 的初始化来说太慢了。

我怀疑这更多地与您选择的数据库技术有关，而不是 JPA/JDBC/JVM。我的猜测是，您的数据库可能会在您连接时自行初始化。您在使用 Access 吗？你用的是什么数据库？

您是否连接到远程数据库？通过广域网？网络速度/延迟是否良好？

客户端 PC 的性能是否受到限制？

**编辑：评论后添加**

将您自己的 ConnectionProvider 实现为围绕真实 ConnectionProvider 的装饰器根本不会加快用户体验。数据库实例仍需初始化，EMF & EM 创建，JDBC 连接仍需后续建立。

选项：

1.  共享一个通用的预加载数据库实例：对于您的业务场景来说似乎是不可能的（尽管 JSE 技术支持这一点并且还支持客户端-服务器设计）。
2.  更改为启动速度更快的数据库：Derby（又名 Java DB）包含在现代 JVM 中，启动时间约为 1.5 秒（冷）和 0.7 秒（热 - 数据预加载）。
3.  在许多（大多数？）场景中，最快的解决方案是使用带有 STAX 的 JAXB 将数据直接加载到内存中的 Java 对象中。随后，使用内存中的缓存数据（特别是使用智能结构，如映射、散列和数组列表）。正如 JPA 可以将 POJO 类映射到数据库表和列一样，JAXB 可以将 POJO 类映射到 XML 模式并使用 XML 文档实例。如果您有非常复杂的查询，使用基于 SQL 集的逻辑，具有多个连接并强烈使用数据库索引，那么这将不太理想。

(2) 可能会在有限的努力下提供最好的改进。
另外： - 尝试在部署期间而不是在应用程序使用期间解压缩数据文件。- 在与 UI 启动并行运行的启动线程中初始化 EMF - 尝试将数据库初始化作为应用程序的最初步骤之一（这意味着使用 JDBC 连接到实际实例）。

# semantic-web - Java 源代码到 RDF 的转换

> ID：15036237
> 
> 赞同：1
> 
> 时间：2013-02-23T02:11:49.287
> 
> 标签：semantic-web

有没有办法将 java 源代码直接转换为等效的 RDF？我知道通过 Jena API 手动创建和 java 对象到 RDF/OWL 对象的映射，但是我需要将 java 源代码映射到 RDF/OWL 对象的自动化。有什么可用的工具吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T00:16:40.233

您可以查看[Empire](https://github.com/mhgrove/Empire)，它是 JPA 和 SPARQL 之间的集成，可让您围绕存储在 RDF 三元存储中的标准 POJO 构建应用程序。它为您处理 RDF 和 Java 之间的往返，并抽象出 RDF 的大部分细节——尽管一些 SPARQL 知识是理想的。

# php - 如何从 php 获取值到 html 标签？

> ID：15036239
> 
> 赞同：-2
> 
> 时间：2013-02-23T02:12:03.003
> 
> 标签：php, html, forms

我的第一个 HTML 文件有一个带有单选按钮的表单。我希望第二个文件（即 PHP）打印一条关于他们选择的信息。考虑到该消息，我想要一些文本格式（大小，颜色等）。

`file.html`：

```
<html>
<body>

<form action="file.php" method="post">
    <input type="radio" name="favorite" value="rbOne">
    <input type="radio" name="favorite" value="rbTwo">
    <input type="submit" value="Submit">
</form>

</body>
</html> 
```

`file.php`：

```
<html>
<head>
<style>
    body{
        background-color:white;
    }
    p{
        color:white;
        font-size:50px;
        font-weight:bold;
    }
</style>
</head>
<body>

<?php $choice = $POST_['favorite']; ?>

<p align="center">Thanks for voting for <?php echo "$choice" ?>!!</p>

</body>
</html> 
```

当我单击提交按钮时，它会转到`file.php`页面，但会显示：

```
Thanks for voting for !! 
```

它使`$choice`空白。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T02:13:33.617

您需要 PHP 开始和结束标签：

```
<?php echo $choice;?> 
```

还有，`$POST_['favorite']`应该`$_POST['favorite']`

# real-time - 为什么我们需要运营转型来实现实时协作？

> ID：15036245
> 
> 赞同：4
> 
> 时间：2013-02-23T02:12:46.560
> 
> 标签：real-time, operational-transform, collaborative-editing

看过 Google Docs 之类的应用程序和[ShareJS](http://sharejs.org/)和[EtherPad Lite](https://github.com/ether/etherpad-lite)之类的库后，我对实时协作感到非常兴奋，这似乎是使用一种称为操作转换的非常复杂的技术来实现的。

我的问题可能有点奇怪：为什么需要 OT？

我的意思是，在大多数设置中，我们在网络上的延迟非常低——使用 Google Docs、ShareJS 和 EtherPad 等工具，更改几乎立即反映在连接的客户端上。

为什么在服务器端解决冲突和保持同步的解决方案非常复杂？

熟悉[命令模式](http://en.wikipedia.org/wiki/Command_pattern)和撤消/重做，在我看来，一个更简单的解决方案是将文档的每个更改简单地实现为具有等效撤消命令的命令。

让客户端在进行更改时提交序列化命令。在服务器端为每个收到的命令分配一个序列号。将应用于文档的所有命令分发回客户端，客户端还维护命令历史记录。

每个连接的客户端都从服务器接收到应用于文档的所有命令，现在带有指示“正确”顺序的序列号，例如服务器接收命令的顺序，以及它们应用于主文档的顺序由服务器持有。

如果客户端在命令号 100 处，并向服务器提交了一条返回为 102 号的新命令，则客户端知道它错过了一条命令 - 然后它简单地对它提交的最后一条命令应用“撤消”命令，应用命令号 101，然后再次应用它自己的命令号 102，从而使事情恢复正常。

如果它落后于几个命令，它会根据需要简单地回滚，然后应用所有错过的命令，等等。

这对我来说听起来要简单得多。

运营转型在哪些方面比这更好？

# facebook - 发布到 Facebook Graph API 会返回一个奇怪的响应对象

> ID：15036247
> 
> 赞同：0
> 
> 时间：2013-02-23T02:12:55.077
> 
> 标签：facebook, facebook-graph-api, facebook-javascript-sdk

我正在使用 Facebook JS SDK 发布到 GRAPH API，当我的帖子成功发布时，它返回一个奇怪的响应对象，该对象被 jQuery .error 链捕获。这是我的代码：

```
var jqxhr = $.post("https://graph.facebook.com/"+sbFacebook.authentication.userID+"/feed", 
      { 
        'message' : $("#question-text").val(),
        'access_token' : sbFacebook.authentication.accessToken
      }).success(
      function(response) {
          console.log(response);
      })
.error(function(response) { 
          alert(response); 
}) 
```

响应对象如下所示：

[http://img689.imageshack.us/img689/964/screenshotfrom201302222.png](http://img689.imageshack.us/img689/964/screenshotfrom201302222.png)

任何人都知道发生了什么以及为什么它被 error() 函数捕获？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T02:30:31.970

这不是您应该使用[Facebook JS SDK](https://developers.facebook.com/docs/reference/javascript/FB.api/)的方式。

```
var body = 'Reading JS SDK documentation';
FB.api('/me/feed', 'post', { message: body }, function(response) {
  if (!response || response.error) {
    alert('Error occured');
  } else {
    alert('Post ID: ' + response.id);
  }
}); 
```

不要忘记[初始化](https://developers.facebook.com/docs/reference/javascript/)JS SDK：

# git - 已添加但未使用 GIT 提交的文件的差异？

> ID：15036252
> 
> 赞同：0
> 
> 时间：2013-02-23T02:13:21.690
> 
> 标签：git, diff

我使用以下命令添加了一堆文件：

```
git add . 
```

但在我提交更改之前，我首先想使用 diff 再次查看更改。

实现此目的的命令是什么？

# iphone - UIAnimation 导致 XCode 在一段时间后崩溃

> ID：15036257
> 
> 赞同：2
> 
> 时间：2013-02-23T02:13:48.867
> 
> 标签：iphone, ios, crash, uianimation

我的应用程序在闲置 5-7 分钟后在 XCode 中崩溃。我确定这与用于加载屏幕的动画有关 - 我粘贴了下面的代码。

我尝试启用 Zombie Objects 以查看它是否是对已释放对象的调用，并在它崩溃时附加了调试窗口的屏幕截图。

顺便说一句 - 如果我按“恢复”，应用程序将继续正常运行..

编辑：这是第一次。我设置的全局断点被停止在线`[UIView animateWithDuration:0.2...`，这是输出代码（这次它很难崩溃）：

```
XYZ(14098,0xac3eaa28) malloc: *** mmap(size=2097152) failed (error code=12)
*** error: can't allocate region
*** set a breakpoint in malloc_error_break to debug 2013-02-23 13:19:36.653 XYZ[14098:c07] *** Terminating app due to uncaught exception 'NSMallocException', reason: '*** -[NSObject allocWithZone:]: attempt to allocate object of class 'UIViewAnimationState' failed'
*** First throw call stack: (0x1cf3012 0x17e8e7e 0x1d7e1a4 0x17fca6b 0x17fca55 0x3acceb 0x3baeec 0x3bb1a7 0x37785 0x3badf6 0x3add66 0x3adf04 0x10fc7d8 0x196d014 0x195d7d5 0x1c99af5 0x1c98f44 0x1c98e1b 0x28f17e3 0x28f1668 0x36fffc 0x28fd 0x2825) libc++abi.dylib: terminate called throwing an exception 
```

* * *

```
- (void)startAnimating
{   
    _isAnimating = YES;
    float rotationAngle = 360.0 / 3;
    [UIView animateWithDuration:0.5
                          delay:0.0
                        options:UIViewAnimationOptionCurveEaseInOut
                     animations:^
    {
        self.marks.transform = CGAffineTransformRotate(self.marks.transform,
                                                       ((rotationAngle + 10) * (M_PI / 180.0)));
//        self.marks.transform = CGAffineTransformMakeRotation((rotationAngle + 10) * (M_PI / 180.0));
    }
                     completion:^(BOOL finished)
    {
        [UIView animateWithDuration:0.2
                              delay:0.0
                            options:UIViewAnimationOptionCurveEaseInOut
                         animations:^
        {
            self.marks.transform = CGAffineTransformRotate(self.marks.transform,
                                                           -10 * (M_PI / 180.0));
//            self.marks.transform = CGAffineTransformMakeRotation(-10 * (M_PI / 180.0));
        }
                         completion:^(BOOL finished)
        {
            self.marks.transform = CGAffineTransformIdentity;
            [self startAnimating];
        }];
    }];
} 
```

**正常崩溃时的截图：**

![禁用 NSZombieObjects 的屏幕截图](../Images/11baec14c73fdc0daa4b1bb2b48e63d6.png)

**启用 NSZombieObjects 时的截图：**

![启用 NSZombieObjects 的屏幕截图](../Images/8ab5d2c10c8580653a5bb5ca74c59668.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T05:50:38.083

第二个动画的完成块递归调用 startAnimating。我认为这是问题的原因。您应该改用循环或创建重复动画。

# jpa - Arquillian：我是否需要 domain.xml 和 arquillian.xml 才能使用 Derby DB 进行最低 Glassfish Embedded 测试？

> ID：15036259
> 
> 赞同：3
> 
> 时间：2013-02-23T02:14:18.847
> 
> 标签：jpa, junit, glassfish, derby

在互联网上，我经常找到关于这个主题的最新但相反的信息......因此我想问一个关于最低要求的问题。

我的目标是对简单的 EJB 3.1 应用程序做一个非常简单的集成测试：

*   EclipseLink 的简单 JPA 2.0 功能
*   Arquillian 和 JUnit 进行测试
*   马文
*   Derby DB（在内存或 ./target 中的文件中），JTA 持久性上下文。
*   在 Arquillian 中嵌入 Glassfish

所以我只想做一个简单的JPA测试。我让我的 Glassfish 在 Arquillian 中运行，但是在执行 JPA 工作时，我的应用程序总是无法处理 Derby DB（告诉我没有表等），但 DDL 文件看起来很正常。我尝试在我的 persistence.xml 中提供模式名称、用户等，但没有任何帮助。有时，一个偶然的帖子告诉我在一个最小的 domain.xml 中为嵌入式 Glassfish 进行更改以匹配我的 persistence.xml 或适应 arquillian.xml。

我的问题是：对于这种最小的方法 - 我真的需要 src/test/glassfish/domains/domain1/domain.xml 或 arquillian.xml 吗？

我很确定前一段时间我设法使用 Embedded Glassfish 做到了这一点，但使用 Hibernate 4 作为 JPA 提供程序。我无法再访问该项目，因此无法区分，除非我明确没有添加 domain.xml 等。像（[此处的其他问题](https://stackoverflow.com/questions/11728724/arquillian-glassfish-embedded-3-1-1-0-0-cr3-configuring-jdbc-datasource)）这样的帖子确实让我感到困惑。

重要的是我使用的不是托管服务器，而是嵌入式服务器。

谢谢和欢呼，蒂莫

这是我的版本之一，请参阅我的以下评论。

```
<persistence-unit name="localiser-core" transaction-type="JTA">
    <jta-data-source>jdbc/__default</jta-data-source>
    <properties>
        <property name="javax.persistence.jdbc.driver" value="org.apache.derby.jdbc.EmbeddedDriver" />
        <property name="javax.persistence.jdbc.url"
                  value="jdbc:derby:memory:test;create=true" />
        <property name="javax.persistence.jdbc.user" value="" />
        <property name="javax.persistence.jdbc.password" value="" />

        <property name="eclipselink.target-database" value="Derby"/>
        <property name="eclipselink.ddl-generation.output-mode"
                  value="database" />

        <property name="eclipselink.ddl-generation" value="create-tables" />
        <property name="eclipselink.application-location" value="target" />
        <property name="eclipselink.create-ddl-jdbc-file-name" value="create.sql"/>
        <property name="eclipselink.drop-ddl-jdbc-file-name" value="drop.sql"/> 
        <property name="eclipselink.debug" value="ALL"/>
        <property name="eclipselink.weaving" value="static"/>
        <property name="eclipselink.logging.level" value="FINEST"/>
        <property name="eclipselink.logging.level.sql" value="FINEST"/>
        <property name="eclipselink.logging.level.cache" value="FINEST"/>

    </properties>

</persistence-unit> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:05:38.170

由于您的连接 URL 是：jdbc:derby:memory:test;create=true，因此您告诉 Derby 的是：连接到文件夹“test”中的数据库，相对于 Derby 启动位置的当前工作目录，如果当前工作目录中不存在该数据库“测试”，请从头开始创建它。

因此，一种可能性是您的应用程序每次都有不同的当前工作目录，或者您的应用程序中的其他东西可能会在您每次运行应用程序时清除您当前的工作目录。

因此，Derby 不会在该位置找到以前的数据库，因此它会创建一个新的数据库。

解决此问题的一种方法是为数据库指定更明确的位置，方法是使用连接 URL，例如：jdbc:derby:memory:/users/timo/testdb

然后先创建一次数据库，然后您的应用程序将在指定位置找到数据库并使用它。

# php - 为什么 PHP exec() 命令不运行？

> ID：15036260
> 
> 赞同：1
> 
> 时间：2013-02-23T02:14:30.200
> 
> 标签：php, command, exec

我有一个非常简单的 PHP 脚本来尝试使用 exec 命令。代码是

```
 <?php
// outputs the username that owns the running php/httpd process
// (on a system with the "whoami" executable in the path)
echo("test<br>");
echo exec('whoami');
echo("test");
?> 
```

但是，当我访问该页面时，它只会打印出来：

```
test
test 
```

它不打印“whoami”命令的输出，从命令行运行时会显示

```
me 
```

这里有什么问题？我无法解决。

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T02:17:26.103

> （在路径中有“whoami”可执行文件的系统上）

`PATH`像所有环境变量一样，不是系统范围的，而是最终*每个进程的*。

也就是说，尽管您的典型 bash 会话很可能包含此可执行文件的路径，`PATH`但您的 PHP 脚本运行的环境（例如，Apache CGI 上下文）却没有。这可能是出于任何原因。

而是提供一个绝对路径`whoami`。

# asp.net - Page Inspector：URL 必须映射到当前解决方案中的项目

> ID：15036264
> 
> 赞同：2
> 
> 时间：2013-02-23T02:14:48.240
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-4, visual-studio-2012

我正在使用带有 ASP.NET MVC 4 的标准 Internet 应用程序模板。当我尝试通过 Page Inspector 查看 Login.cshtml 时，出现以下错误：

> Page Inspector：URL 必须映射到当前解决方案中的项目

我不明白为什么。我没有看到似乎映射到其他地方的 URL。为什么我会收到此错误？

即使在不修改任何代码的情况下创建新项目时也会发生这种情况。重现步骤：

1.  文件 -> 新建 -> 项目
2.  ASP.NET MVC 4 Web 应用程序
3.  选择互联网应用
4.  打开 Views/Account/Login.cshtml
5.  打开页面检查器（查看 -> 其他窗口 -> 页面检查器）
6.  单击页面检查器顶部的问题按钮
7.  您应该看到上面显示的错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T14:05:28.763

我发现了这个问题。在原始问题中按照步骤进行复制时，由于某种原因，Page Inspector 中的 URL 是这样的：

> file:///C:/Program%20Files%20(x86)/Microsoft%20Visual%20Studio%2011.0/Common7/IDE/Extensions/Microsoft/Web%20Tools/Eureka/en-US/Startup.html

我不确定为什么会发生这种情况，但 Page Inspector 肯定没有显示登录表单。

要让登录表单显示在 Page Inspector 中：

> 右键单击 Login.cshtml 中的任意位置，然后选择在 Page Inspector 中查看。瞧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-24T06:17:09.950

对我来说，解决方案原来是将项目属性 -> Web -> 覆盖应用程序根 URL 更改为 -> 未选中。

# c# - 从文本文件中获取文件大小

> ID：15036265
> 
> 赞同：3
> 
> 时间：2013-02-23T02:14:51.620
> 
> 标签：c#

尝试从列表中获取文件大小，然后将结果输出到文本文件。目前，我已经能够从文件中读取前半部分工作，检查文件是否存在，然后输出到控制台和文本文件

我是新编程“本周刚开始”。这可能是任何简单的问题并尝试过，但不能完全正常工作

我已经尝试将它放在 foreach 循环中并尝试读取路径，但它不起作用。

```
 DirectoryInfo di = new DirectoryInfo(path);
        FileInfo[] fiArr = di.GetFiles();
        foreach (FileInfo f in fiArr) 
```

到目前为止我的代码

```
 static void Main(string[] args)
    {

        string[] lines = System.IO.File.ReadAllLines(@"C:\Locations2.txt");
        foreach (string path in lines)
            if (File.Exists(path))
                using (System.IO.StreamWriter file = new System.IO.StreamWriter(@"C:\Results.txt", true))
                {
                    file.WriteLine("File found" + "\t" + path);
                    Console.WriteLine("File found" + "\t" + path);
                }

            else
                using (System.IO.StreamWriter file = new System.IO.StreamWriter(@"C:\Results.txt", true))
                {
                    file.WriteLine("Does not Exist" + "\t" + path);
                    Console.WriteLine("Does not Exist" + "\t" + path);
                }

    } 
```

提前谢谢你，如果代码很糟糕，你能告诉我为什么不应该这样做吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-23T02:19:54.730

`FileInfo`您可以通过类获取有关文件的信息（包括其大小）

例如

```
var fileName = @"C:\Locations2.txt";
FileInfo fi = new FileInfo(fileName);
var size = fi.Length;
Console.WriteLine("File Size in Bytes: {0}", size); 
```

您放在循环中的上面的代码是正确的概念，只是错误的实现。如果您知道要打开的文件名，则无需经过`DirectoryInfo.GetFiles`路由。直接访问就行了`FileInfo`。

所以你的代码看起来像这样：

```
static void Main(string[] args)
{

    string[] lines = System.IO.File.ReadAllLines(@"C:\Locations2.txt");
    foreach (string path in lines)
        if (File.Exists(path))
            using (System.IO.StreamWriter file = new System.IO.StreamWriter(@"C:\Results.txt", true))
            {
                file.WriteLine("File found" + "\t" + path);
                Console.WriteLine("File found" + "\t" + path);

                FileInfo fi = new FileInfo(path);
                var size = fi.Length;
                file.WriteLine("File Size in Bytes: {0}", size);
                Console.WriteLine("File Size in Bytes: {0}", size);
            }

        else
            using (System.IO.StreamWriter file = new System.IO.StreamWriter(@"C:\Results.txt", true))
            {
                file.WriteLine("Does not Exist" + "\t" + path);
                Console.WriteLine("Does not Exist" + "\t" + path);
            }

} 
```

# php - 为什么即使我使用 PRG 模式，Chrome 也会发出“确认表单重新提交”？

> ID：15036267
> 
> 赞同：7
> 
> 时间：2013-02-23T02:15:22.670
> 
> 标签：php, google-chrome

处理 POST 请求后，我正在执行非常标准的重定向到同一页面的操作，以便用户在重新加载页面时不会收到“确认表单重新提交”（或等效）对话框。

我正在使用 303 响应状态代码。

这是代码：

```
header( "HTTP/1.1 303 See Other" );
header( "Location: " . $_SERVER['REQUEST_URI'] );
exit(); 
```

这在 Safari 和 FF 中按预期工作。Chrome 会弹出“确认表单重新提交”对话框。

在 Chrome 中，我可以使用网络检查器查看确实发出了 303 重定向，并且在我的初始 POST 之后有一个 GET。

但是，如果我当时尝试重新加载页面，我会收到“确认表单重新提交”。

如果我通过添加虚假查询参数来修改 URL，则不会发生这种情况。那是...

```
header( "HTTP/1.1 303 See Other" );
header( "Location: " . $_SERVER['REQUEST_URI'] . '?foo' );
exit(); 
```

...工作得很好。

Chrome 是否试图过于聪明并缩短同一页面的重新加载？或者这是一个已知问题？我花了一些时间环顾四周，但除了一百万只需要使用 PRG 模式的人之外，什么都没有。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-23T02:58:32.050

这似乎是 Chrome 25 中的一个错误。我在使用 Chrome 24 的 virtualbox 中对其进行了测试，并更新到了 Chrome 25。

Chrome 24 => 没有对话框

Chrome 25 => 对话框

也许你应该提交一个错误。:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T22:09:32.313

您可以尝试代理重定向到具有不同 URI 的脚本

```
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
      header('Location: proxy.php?uri='.$_SERVER['REQUEST_URI'], true, 303);
} 
```

然后回来

```
# proxy.php

if (!empty($_GET['uri'])) {
    // maybe some validation here
    header('Location: '.$_GET['uri'], true, 303);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-12T13:22:51.053

当用户尝试恢复意外关闭的页面时，浏览器将显示此错误“err_cache_miss”。观看错误主要来源的视频证明 [https://www.youtube.com/watch?v=6c9ztzqlthE](https://www.youtube.com/watch?v=6c9ztzqlthE)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-01-19T10:34:55.213

这将帮助您以更好的方式将其放入包含所有文件的任何文件中

```
header("Cache-Control: no-cache, must-revalidate"); 
```

* * *

如果没有，那么试试这个

```
session_cache_limiter('private, must-revalidate');
session_cache_expire(60); 
```

# c++ - 字符串字面量的值类别是什么？

> ID：15036281
> 
> 赞同：6
> 
> 时间：2013-02-23T02:17:24.120
> 
> 标签：c++, c++11

我很确定整数、字符、布尔和浮点文字的值类别是纯右值。

用户定义的文字类似于函数调用，因此它们的值类别取决于它们解析为的运算符函数的返回类型。

我不清楚字符串文字。它们的类型为“const charx 数组”，其中 charx 是某种字符类型。

它在 3.10 中说：

> 文字 ... 的值也是纯右值。

但我认为这可能不适用于字符串文字？

字符串文字的值类别是什么？你是怎么确定的？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-23T02:21:02.153

> 所以我很确定整数、字符、布尔和浮点文字的值类别是纯右值。

这是正确的。

> 字符串文字的值类别是什么？

根据 C++11 标准的第 5.1.1/1 段：

> 文字是主要的表达方式。它的类型取决于它的形式（2.14）。**字符串文字是左值**；所有其他文字都是纯右值。

# android - android sqlite onUpgrade不起作用

> ID：15036285
> 
> 赞同：2
> 
> 时间：2013-02-23T02:17:51.547
> 
> 标签：android, sqlite

所以我正在创建一个琐事游戏，我的问题是尝试向数据库添加问题。我认为整个表是否被删除并不重要，但我似乎无法让它工作。我查看了无数帖子，无法弄清楚我做错了什么。我的数据库已设置，因此每个类别都是自己的表。

```
package com.triviagame;

import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.sql.SQLException;

import android.content.Context;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteException;
import android.database.sqlite.SQLiteOpenHelper;
import android.util.Log;

public class DataBaseHelper extends SQLiteOpenHelper{

    //The Android's default system path of the application's database.
    private static String DB_PATH = "/data/data/com.triviagame/databases/";

    private static String DB_NAME = "mobile_trivia2.db";

    private SQLiteDatabase myDataBase;

    private final Context myContext;
    private static final String DATABASE_TABLE = "geography";
    private static final int DATABASE_VERSION = 3; 

    /* Constructor
     * Takes and keeps a reference of the passed context in order to access to the      application assets and resources.
     * @param context
     */
    public DataBaseHelper(Context context) {
        super(context, DB_NAME, null, DATABASE_VERSION);
        this.myContext = context;
    }

    /**
     * Creates a empty database on the system and rewrites it with your own database.
     * */
    public void createDataBase() throws IOException{

        boolean dbExist = checkDataBase();

        if(dbExist){
            //do nothing - database already exist
        }
        else{
            //By calling this method and empty database will be created into the default system path
            //of your application so we are going to be able to overwrite that database with our database.
            this.getReadableDatabase();

            try {
                copyDataBase();
            } catch (IOException e) {
                throw new Error("Error copying database");
            }
        }
    }

    /**
     * Check if the database already exist to avoid re-copying the file each time you open the application.
     * @return true if it exists, false if it doesn't
     */
    private boolean checkDataBase(){
        SQLiteDatabase checkDB = null;

        try{
            String myPath = DB_PATH + DB_NAME;
            checkDB = SQLiteDatabase.openDatabase(myPath, null, SQLiteDatabase.OPEN_READONLY);
        }catch(SQLiteException e){
            //database does't exist yet.
            Log.e("DBHelper", "DataBase Does Not Exist closing returning null");
        }

        if(checkDB != null){
            Log.e("DBHelper", "DataBase Exists closing checkDB");
            checkDB.close();
        }

        return checkDB != null ? true : false;
    }

    /**
     * Copies your database from your local assets-folder to the just created empty database in the
     * system folder, from where it can be accessed and handled.
     * This is done by transferring byte-stream.
     * */
    private void copyDataBase() throws IOException{

        //Open your local db as the input stream
        InputStream myInput = myContext.getAssets().open(DB_NAME);

        // Path to the just created empty db
        String outFileName = DB_PATH + DB_NAME;

        //Open the empty db as the output stream
        OutputStream myOutput = new FileOutputStream(outFileName);

        //transfer bytes from the inputfile to the outputfile
        byte[] buffer = new byte[1024];
        int length;
        while ((length = myInput.read(buffer))>0){
            myOutput.write(buffer, 0, length);
        }

        //Close the streams
        myOutput.flush();
        myOutput.close();
        myInput.close();
    }

    public void openDataBase() throws SQLException{

        //Open the database
        String myPath = DB_PATH + DB_NAME;
        myDataBase = SQLiteDatabase.openDatabase(myPath, null, SQLiteDatabase.OPEN_READONLY);
    }

    @Override
    public synchronized void close() {
        if(myDataBase != null)
            myDataBase.close();
        super.close();
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
    }

    //Returns the question from the database using the category ID and the question ID passed to it
    public String getQuestion( int categoryId, int questionId){

        final String[] FROM = {"question"}; //string array of which columns to look through in the table
        String categoryStr = "General";     //default value

        //converts the numeric category ID to its corresponding String value
        switch (categoryId){
            case 0:
                categoryStr = "geography"; break;
            case 1:
                categoryStr = "politics"; break;
            case 2:
                categoryStr = "History"; break;
            case 3:
                categoryStr = "sports"; break;
            case 4:
                categoryStr = "science"; break;
            case 5:
                categoryStr = "movies"; break;
            case 6:
                categoryStr = "General"; break;
            default:
                categoryStr = "General"; break; 
        }

        Cursor cursor = myDataBase.query(categoryStr, FROM, "_id=="+questionId, null, null, null, null);//build the query, pass null for default filtering
        cursor.moveToFirst();//move the cursor to the first index location in the result column
        String result=cursor.getString(0);//return the first result column (index 0)        
        return result;  //returns question
    }

    //Returns the correct answer according the the category ID and the question ID passed to it
    public String getCorrectAnswer( int categoryId, int questionId){
        final String[] FROM = {"correct"}; //string array of which columns to look through in the table
        String categoryStr = "General"; //Default value

        //converts the numeric category ID to its corresponding String value
        switch (categoryId){
            case 0:
                categoryStr = "geography"; break;
            case 1:
                categoryStr = "politics"; break;
            case 2:
                categoryStr = "History"; break;
            case 3:
                categoryStr = "sports"; break;
            case 4:
                categoryStr = "science"; break;
            case 5:
                categoryStr = "movies"; break;
            case 6:
                categoryStr = "General"; break;
            default:
                categoryStr = "General";
        }

        Cursor cursor=myDataBase.query(categoryStr, FROM, "_id=="+questionId, null, null, null, null);//build the query, pass null for default filtering
        cursor.moveToFirst();//move the cursor to the first index location in the result column
        String result=cursor.getString(0);//return the first result column (index 0)
        return result;  //returns correct answer
    }

    //Returns the first wrong answer from the database according to the category ID and question ID passed to it
    public String getWrongAnswer1( int categoryId, int questionId){
        final String[] FROM = {"wrong1"}; //string array of which columns to look through in the table
        String categoryStr = "General"; //default value

        //converts the numeric category ID to its corresponding String value
        switch (categoryId){
            case 0:
                categoryStr = "geography"; break;
            case 1:
                categoryStr = "politics"; break;
            case 2:
                categoryStr = "History"; break;
            case 3:
                categoryStr = "sports"; break;
            case 4:
                categoryStr = "science"; break;
            case 5:
                categoryStr = "movies"; break;
            case 6:
                categoryStr = "General"; break;
            default:
                categoryStr = "General";    
        }

        Cursor cursor=myDataBase.query(categoryStr, FROM, "_id=="+questionId, null, null, null, null);//build the query, pass null for default filtering
        cursor.moveToFirst();//move the cursor to the first index location in the result column
        String result=cursor.getString(0);//return the first result column (index 0)
        return result;  //returns first wrong answer
    } 

    //Returns the second wrong answer from the database according to the category ID and question ID passed to it
    public String getWrongAnswer2( int categoryId, int questionId){
        final String[] FROM = {"wrong2"}; //string array of which columns to look through in the table
        String categoryStr = "General"; //default value

        //converts the numeric category ID to its corresponding String value
        switch (categoryId){
            case 0:
                categoryStr = "geography"; break;
            case 1:
                categoryStr = "politics"; break;
            case 2:
                categoryStr = "History"; break;
            case 3:
                categoryStr = "sports"; break;
            case 4:
                categoryStr = "science"; break;
            case 5:
                categoryStr = "movies"; break;
            case 6:
                categoryStr = "General"; break;
            default:
                categoryStr = "General";
        }

        Cursor cursor=myDataBase.query(categoryStr, FROM, "_id=="+questionId, null, null, null, null);//build the query, pass null for default filtering
        cursor.moveToFirst();//move the cursor to the first index location in the result column
        String result=cursor.getString(0);//return the first result column (index 0)
        return result;  //returns second wrong answer
    } 

    //Returns the second wrong answer from the database according to the category ID and question ID passed to it
    public String getWrongAnswer3( int categoryId, int questionId){
        final String[] FROM = {"wrong3"}; //string array of which columns to look through in the table
        String categoryStr = "General";

        //converts the numeric category ID to its corresponding String value
        switch (categoryId){
            case 0:
                categoryStr = "geography"; break;
            case 1:
                categoryStr = "politics"; break;
            case 2:
                categoryStr = "History"; break;
            case 3:
                categoryStr = "sports"; break;
            case 4:
                categoryStr = "science"; break;
            case 5:
                categoryStr = "movies"; break;
            case 6:
                categoryStr = "General"; break;
            default:
                categoryStr = "General";

        }

        Cursor cursor=myDataBase.query(categoryStr, FROM, "_id==" + questionId, null, null, null, null);//build the query, pass null for default filtering
        cursor.moveToFirst();//move the cursor to the first index location in the result column
        String result=cursor.getString(0);//return the first result column (index 0)
        return result;  //returns third wrong answer
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        if (oldVersion < 2) {
            db.execSQL("DROP TABLE IF EXISTS "+DATABASE_TABLE);
            onCreate(db);
        }       
    }  
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-25T21:35:52.877

当现有数据库版本低于您传入的版本时，始终调用 onUpgrade 方法

```
super(context, DB_NAME, null, DATABASE_VERSION); 
```

您将 3 作为数据库版本传递。我假设您的旧版本是 2，但您明确希望升级仅适用于 OLDER 比 2 的数据库。只需从 onUpgrade 中删除 IF。

```
@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

        db.execSQL("DROP TABLE IF EXISTS "+DATABASE_TABLE);
        onCreate(db);

} 
```

# ipad - 为 iPad 应用程序选择数据驱动的方法

> ID：15036291
> 
> 赞同：0
> 
> 时间：2013-02-23T02:18:48.483
> 
> 标签：ipad

我有一个新的 iPad 应用程序，它是数据驱动的（读取、删除、创建、更新），并且需要在安装了该应用程序的 iPad 设备上保持数据持久性。该应用程序大约有 10 个表；这 10 个表在某些方面是相关的（一对多；多对多；独立）。我是 iPad 数据驱动应用程序的新手。

我不知道我应该遵循 Core Data 方法还是 SQLite 方法。哪种方法更好且面向现实世界？请指教。非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T02:27:44.863

我的建议是两者都尝试；勾勒出你的应用程序的两个简单版本，每个实现一个。当然，Core Data 在幕后使用 SQLite 作为存储，但远不止这些。在我看来，这是一个非常复杂，笨重的野兽，但它是关于建模和持久化具有属性的对象，当您删除关系中涉及的对象时，它可以帮助很多一致性，并且 NSFetchedResultsController 有助于填充以节省内存的方式使用 UITableView。使用 SQLite，它只是一个数据库，仅此而已；你必须做所有的工作，但是有很好的 Objective-C 前端，你完全可以控制而不是必须以 Core Data 非常奇怪的方式做所有事情。

我的书中有一小部分演示了一个微小的 Core Data 应用程序，即使它很小，你也可以看到我花了很多时间把头撞在 Core Data 特殊做事方式的墙上：

[http://www.aeth.com/iOSBook/ch36​​.html#_core_data](http://www.apeth.com/iOSBook/ch36.html#_core_data)

上一节有几行展示了从带有漂亮 Objective-C 前端的 SQLite 数据库中获取数据是多么简单：

[http://www.aeth.com/iOSBook/ch36​​.html#_sqlite](http://www.apeth.com/iOSBook/ch36.html#_sqlite)

我建议您在投入使用之前阅读一本有关 Core Data 的书。有几个不错的。我并不是说它不好，但它根本不是初学者技术，你真的需要知道你在做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T02:29:48.107

在我看来，您在使用 Core Data 时走在了正确的轨道上，您需要问自己的是如何使用您的数据来对抗每种方法的好处。核心数据允许您使用像 NSDictionaries 这样的数据类型来更新和写入数据，这些数据类型不需要任何开箱即用的技术来处理和写入 SQLite 那样的数据。SQLite 确实可以工作并且可以按照您的意愿工作，但在我看来，使用第三方包装器只是实现已经原生的东西的又一步。

# blogger - 使用 Firefox 和 IE 在我的博客底部有大量空间

> ID：15036294
> 
> 赞同：0
> 
> 时间：2013-02-23T02:19:15.027
> 
> 标签：blogger

我的博客地址是[http://www.raymondhomesteadprimitives.com](http://www.raymondhomesteadprimitives.com)

在我的博客文章的末尾，有大量的额外空间。当我升级到名为“simple”的新博客模板时，这个问题就开始了。谷歌浏览器似乎没有问题，但 Firefox 和 IE 都有问题。我想删除博客页脚部分之后的极端差距，以及我的命中计数器和我上一篇文章之间的差距。

谢谢你的帮助。我在这个网站上查看了类似的问题，但无法找到如何在我的网站上专门解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-27T22:41:33.080

要删除底部的灰色空间，请从 body 标记中删除底部填充。命中计数器由其他几个元素与最后一篇文章分开，并包含在页脚中。也许尝试取出 `<div class="widget-HTML" id="HTML1"></div>`并将其放在文档中的更远位置。

# bash - wget维基媒体图片？

> ID：15036304
> 
> 赞同：3
> 
> 时间：2013-02-23T02:20:55.513
> 
> 标签：bash, shell, wget, wikimedia-commons

我正在尝试通过使用文件命名空间中页面的 URL 从 Wikimedia Commons 下载图像：

```
wget http://commons.wikimedia.org/wiki/File:A_golden_tree_during_the_golden_season.JPG 
```

我得到的只是一个无法打开的 JPG 文件。但是，当您转到链接时，您实际上看到的是页面而不是图像本身，但是有一个名为“全分辨率”的链接将您发送到真实的图像链接，即：http: [//upload.wikimedia.org/wikipedia /commons/9/92/A_golden_tree_during_the_golden_season.JPG](http://upload.wikimedia.org/wikipedia/commons/9/92/A_golden_tree_during_the_golden_season.JPG)

我怎样才能通过只有第一个链接来下载这个文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T04:18:59.300

您可以尝试以下方法：

```
wget http://commons.wikimedia.org/wiki/File:A_golden_tree_during_the_golden_season.JPG -O output.html; wget $(cat output.html | grep fullMedia | sed 's/\(.*href="\/\/\)\([^ ]*\)\(" class.*\)/\2/g') 
```

第一个`wget`获取您指定的链接。我浏览了几页，发现高分辨率图像在`div`class=fullMedia 下。它解析图像的 url，然后获取该图像。

**PS**：正如上面所建议的， bash 不是这样做的好方法。你应该看看解析 dom 树的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-02T16:04:56.040

提取没有命名空间 ( `A_golden_tree_during_the_golden_season.JPG`) 的标题并将其传递给[Special:Redirect](http://commons.wikimedia.org/wiki/Special%3aRedirect)。

```
wget http://commons.wikimedia.org/wiki/Special:Redirect/file/$( echo 'http://commons.wikimedia.org/wiki/File:A_golden_tree_during_the_golden_season.JPG' | sed 's/.*\/File\:\(.*\)/\1/g' ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T02:22:57.753

wget [http://upload.wikimedia.org/wikipedia/commons/9/92/A_golden_tree_during_the_golden_season.JPG](http://upload.wikimedia.org/wikipedia/commons/9/92/A_golden_tree_during_the_golden_season.JPG)

您正在获取网页而不是图像本身。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-05T05:42:13.493

您可以使用以下链接进行检索：[https](https://upload.wikimedia.org/wikipedia/commons/9/92/A_golden_tree_during_the_golden_season.JPG) ://upload.wikimedia.org/wikipedia/commons/9/92/A_golden_tree_during_the_golden_season.JPG 即使我遇到了同样的问题，点击图片你会得到上面的链接，我希望这可以帮助

# javascript - jQuery DIV 在悬停时扩展，在鼠标悬停时收缩

> ID：15036306
> 
> 赞同：1
> 
> 时间：2013-02-23T02:21:07.883
> 
> 标签：javascript, jquery

我有一组四个 DIV，每个都有一个段落的标题。我希望每个 DIV 在悬停时展开以显示一小段，然后在鼠标悬停时收缩。jQuery 运行正常。唯一的问题是，如果我快速在四个 DIV 上来回跟踪光标几次，它似乎会破坏该功能。

它所做的只是随机扩展和收缩各种 DIV，没有任何可辨别的模式。

```
 $('#iam_writer').hover(function(){
        $(this).animate({'height' : '120px'}, 'slow');
        $(this).on('mouseleave',function(){
            $(this).animate({'height' : '25px'}, 'fast');
        });                                     
    });     
    $('#iam_social').hover(function(){
        $(this).animate({'height' : '135px'}, 'slow');
        $(this).on('mouseleave',function(){
            $(this).animate({'height' : '25px'}, 'fast');
        });
    });
    $('#iam_creative').hover(function(){
        $(this).animate({'height' : '135px'}, 'slow');
        $(this).on('mouseleave',function(){
            $(this).animate({'height' : '25px'}, 'fast');
        });
    });
    $('#iam_strategic').hover(function(){
        $(this).animate({'height' : '140px'}, 'slow');
        $(this).on('mouseleave',function(){
            $(this).animate({'height' : '30px'}, 'fast');
        });
     }); 
```

也许有更好的方法来实现这一目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:24:19.890

`mouseleave`每次将鼠标悬停在 上面时，您都会绑定事件。`.hover`还接受两个参数：一个用于 mouseenter 的函数，一个用于 mouseleave 的函数，因此您可以这样编写：

```
$('#iam_writer').hover(function(){
    $(this).stop().animate({'height' : '120px'}, 'slow');
}, function () { 
    $(this).stop().animate({'height' : '25px'}, 'fast');
}); 
```

我还添加`.stop`了如果触发另一个动画（当您快速移入和移出元素时发生），则任何当前动画都会停止。

# java - 用于不调用重写方法的 java 注释

> ID：15036307
> 
> 赞同：1
> 
> 时间：2013-02-23T02:21:17.560
> 
> 标签：java, annotations, overriding, subclass, deprecated

我有两个类 Foo 和 Bar，其中 Bar 扩展了 Foo。

在超类中，有一个方法 f()。子类覆盖此方法并故意抛出异常，以便永远不会在 Bar 的实例上调用 f()。

```
class Foo {
  public void f() {
     // does something useful
  }

}

class Bar extends Foo {
  @Override
  public void f() {
      throw new UnsupportedOperationException("Srsly, thou shalt not");
  }
} 
```

现在这是我的问题：是否有一些注释可以用于与 IDE（例如 Eclipse）通信的被覆盖方法上，而不应该调用它？我发现自己想轻轻地滥用@deprecated 标记，以便在用户处理 Bar 实例时，Eclipse 中的自动完成列表~~跨越该方法，但我想知道是否有更好的选择。~~

```
class Bar extends Foo {

  /**
   * @deprecated
   */
  @Override
  public void f() {
      throw new UnsupportedOperationException("Srsly, thou shalt not");
  }
} 
```

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-02-23T11:57:06.843

我会将函数 f() 设为私有。这样，它就永远不能在 Bar 之外调用。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-23T02:31:20.027

不是真的，因为 Java 中的所有（非静态）方法都是虚拟的，并且调用是在运行时解决的。换句话说，编译器无法检测到 Bar 的方法版本将在运行时被调用。

# java - 在对话框中显示 log4j 输出

> ID：15036309
> 
> 赞同：0
> 
> 时间：2013-02-23T02:21:24.700
> 
> 标签：java, log4j

我试图让一个对话框窗口显示 log4j 输出。

我找到了[LogFactor5Dialog](http://www.docjar.org/html/api/org/apache/log4j/lf5/viewer/LogFactor5Dialog.java.html)。

这就是它的用途吗？

如果是这样，我该如何配置它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-11T09:34:30.873

在[Apache API Javadoc](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/lf5/viewer/LogFactor5InputDialog.html)中，LogFactor5InputDialog 的用途被描述为： 创建一个弹出式输入对话框，以便用户可以输入 URL 来打开日志文件。

所以这绝对不是你要找的。不过，我确实期待其他建议。

# matlab - Matlab的数据采集工具箱和图像采集工具箱能同步吗？

> ID：15036311
> 
> 赞同：4
> 
> 时间：2013-02-23T02:21:41.700
> 
> 标签：matlab, camera, synchronization, data-acquisition, nidaqmx

我想同时使用matlab从相机（即图像）和模拟电压获取数据。对于相机，我使用 imaq 工具箱，读取电压我使用 daq 工具箱（读取 NI-USB 设备），代码如下：

```
clear all
% Prepare camera
vid = videoinput('gentl', 1, 'Mono8');
src = getselectedsource(vid);
vid.FramesPerTrigger = 1;
vid.TriggerRepeat = Inf;
triggerconfig(vid, 'hardware', 'DeviceSpecific', 'DeviceSpecific');
src.FrameStartTriggerMode = 'On';
src.FrameStartTriggerActivation = 'RisingEdge';

% prepare DAQ
s=daq.createSession('ni');
s.addAnalogInputChannel('Dev1','ai1','Voltage');
fid = fopen('log.txt','w');
lh = s.addlistener('DataAvailable',@(src,event)SaveData(fid,event));
s.IsContinuous = true;

% Take data
s.startBackground();
start(vid)
N=10;
for ii=1:N
    im(:,:,ii)=getsnapshot(vid);
end

% end code
delete(lh );
fclose('all');
stop(vid)
delete(vid) 
```

函数`SaveData`是：

```
function SaveData(fid,event)
     time = event.TimeStamps;
     data = event.Data;
     fprintf(fid, '%f,%f\n ', [time data]);
end 
```

我确实获得了带有 daq 跟踪（时间和数据）的图像和 log.txt 文件，但是如何使用外部触发（触发相机）或其他时钟来同步两者？对于此示例，数据采集器读取相机触发 TTL 信号（@ 50 Hz），因此我想将每个 TTL 脉冲分配给图像。

**附录：** 我一直在搜索并找到了一些关于这个主题的讨论（比如这个[）](http://www.mathworks.com/matlabcentral/answers/2081-how-to-execute-two-matlab-scripts-simultaneously)，并阅读了在 Mathworks 网站上找到的[示例](http://www.mathworks.com/products/daq/examples.html)，但没有找到答案。该文档显示了如何[在外部事件上启动多触发采集](http://www.mathworks.com/help/daq/examples/start-a-multi-trigger-acquisition-on-an-external-event.html?prodcode=DA&language=en)，但所讨论的采集仅与基于 DAQ 的输入相关，而不是基于摄像头的输入（它也在前台工作）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:18:02.303

这不会完全解决您的问题，但它可能已经足够好了。由于您使用的同步信号为 50 Hz，因此您可以使用`clock`它来为两种类型的数据（相机图像和模拟电压）创建时间戳。由于该功能 `clock`几乎不需要时间（即低于 1e-7 秒），您可以尝试`SaveData`相应地编辑您的功能：

```
fprintf(fid, '%f,%f\n ', [clock time data]); 
```

并在 for 循环中添加：

```
timestamp(i,:)=clock; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T22:10:29.397

你能用同步触发AD板吗？从 USB-6009 手册...

将 PFI 0 用作数字触发器——定义模拟输入任务后，您可以将 PFI 0 配置为数字触发器输入。启用数字触发后，AI 任务在开始采集之前等待 PFI 0 上的上升沿或下降沿。要将 AI 启动触发 (ai/StartTrigger) 与数字源一起使用，请将 PFI 0 指定为源并选择上升沿或下降沿。

我的经验表明触发器和 AQ 之间的延迟非常短

对不起，我为此使用 Python 或 C，所以我不能给你 MatLab 代码，但你想看看类似的函数。

```
/* Select trigger source */
Select_Signal(deviceNumber, ND_IN_START_TRIGGER, ND_PFI_0, ND_HIGH_TO_LOW);

/* specify that a start trigger is to be used */
DAQ_Config(deviceNumber, startTrig, extConv); // set startTrig = 1

/* start the acquisition */ 
DAQ_Start(deviceNumber, …) 
```

如果您想走这条路，您可以从以下网址获得更多想法： [http ://www.ni.com/white-paper/4326/en](http://www.ni.com/white-paper/4326/en)

希望这会有所帮助，卡尔

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T10:16:41.333

这还不是完整的解决方案，但有一些想法可能有用。

> 我确实获得了带有 daq 跟踪（时间和数据）的图像和 log.txt 文件，但是如何使用外部触发（触发相机）或其他时钟来同步两者？

你能想出一种方法来校准你的设置吗？即修改您的实验并在您的图像流和电压测量中创建一个独特的事件，可用于同步？[像这样 ...](http://commons.wikimedia.org/wiki/File%3aClapperboard,_O2_film,_September_2008.jpg)

# node.js - 使用 ExpressJS 在 AppFog 上的会话

> ID：15036322
> 
> 赞同：2
> 
> 时间：2013-02-23T02:24:35.840
> 
> 标签：node.js, session, express, appfog

我在我的 ExpressJS 应用程序上遇到了会话问题。在本地它工作得很好，但是当我在 AppFog 上托管我的应用程序时，我遇到了一些会话问题，它们有时会丢失......在我的管理面板中。

我不知道为什么，但是当页面刷新时，会话不再工作......

```
var restrictedArea = function(req, res, next) {
    if( req.session.access )
        next();
    else
        res.redirect('/signin');
}

// Get/Post example on admin panel
app.get('/posts/add', restrictedArea, admin.addPost);
app.post('/posts/add', restrictedArea, admin.savePost);
app.post('/posts/delete', restrictedArea, admin.deletePost);
app.get('/posts/edit/:id', restrictedArea, admin.editPost); 
```

我的应用程序配置：

```
app.configure(function () {
    app.set('port', process.env.PORT || 3000);
    app.set('views', __dirname + '/views');
    app.set('view engine', 'jade');
    app.use(express.favicon());
    app.use(express.logger('dev'));
    app.use(express.bodyParser());
    app.use(express.static(path.join(__dirname, 'public')));
    //app.use(express.session({secret: 'some secret'}));
        app.use(express.cookieSession({
                secret: 'SECRET',
                cookie: { access: false }
            })
        );
    app.use(express.session({secret: 'some secret'}));
    app.use(app.router);
    app.use(function(req, res, next){
        res.render('404.jade', {
            title: "404 - Page Not Found",
            showFullNav: false,
            status: 404,
            url: req.url
        });
    });
}); 
```

我的路线：

```
exports.authenticate = function(req, res) {
    if( req.body.username == user.username && req.body.password == user.password ){
        req.session.access = true;
        renderToAdminIndex(req, res);
    }else{
        req.session.access = false;
        renderToSignin(req, res, "Error, please try again!");
    }
} 
```

签出功能：

```
exports.signout = function(req, res) {
    req.session.destroy(function(){
        res.redirect('/');
    });
} 
```

安东尼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T03:24:34.163

如果您使用 express 3.x，您需要使用`express.cookieSession`：

```
app.configure(function () {

  ...

  app.use(express.cookieParser());
  app.use(express.cookieSession(
    { 
      secret: 'SECRET', 
      cookie: { maxAge: ... }
    }
  )); 
```

参考：[http ://expressjs.com/api.html#cookieSession](http://expressjs.com/api.html#cookieSession)

**更新**

要清除会话：

```
exports.signout = function(req, res) {
  req.session = null;
  res.redirect('/');
} 
```

# java - 线程和公共 void run()

> ID：15036325
> 
> 赞同：0
> 
> 时间：2013-02-23T02:25:20.970
> 
> 标签：java, multithreading

```
import java.lang.Thread;

class ThreadExperiment implements Runnable {
  public static void main(String[] args) {
    Thread t = new Thread(new ThreadExperiment());
    @Override
    public void run(){      
        do {
            num ++;
            try {
                Thread.sleep(400);
            } catch (InterruptedException e){
            }
        } while (num >= 0);
    }

    Thread t2 = new Thread(new ThreadExperiment());
    @Override
    public void run() {
        do {
            num2--;
            try {
                Thread.sleep(400);
            } catch (InterruptedException e){
            }
        } while (num >= 1);
    }

    int num = 1;
    int num2 = 10;
    t.start();
    t2.start();
    if (num == num2) {
        t.interrupt();
        t2.interrupt();
    }
  }
} 
```

试图修补线程并转圈，总是如此接近。我想要两个线程，一个增加数字计数，另一个减少数字计数。如果他们相遇，我希望他们停下来。但是，我在使用 public void run() 时遇到了麻烦-目前，它说我`t have a semi-colon next to both of them. What isn`不对？这是放置 public void run() 的正确位置吗？

另外，一些网站说我需要两个单独的类来创建线程——这有什么原因吗？也许如果一个线程依赖于另一个线程的计算但走不同的路线，我可以理解，但我的感觉不同，只是两个独立的实体。

最后，我需要导入声明吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:40:13.770

首先，您的代码看起来应该有很多编译错误，这表明我可能会以错误的方式进行编码。如果您不能使用 IDE，那么您*必须尽早并经常编译，并且在修复**所有*编译错误之前不要再添加任何新代码。

例如，您似乎有一个方法 run，嵌入在另一个方法 main 中，而您根本无法做到这一点。我建议你重新开始，从一个可以编译的小代码骨架开始，然后再早点经常编译。还可以在 main 方法*之外*获取大部分代码。不，run 方法不在正确的位置，因为您应该只有*一个*run 方法，它应该在类本身中，而不是嵌入在 main 或任何其他方法中。

关于，

> 最后，我需要导入声明吗？

你的编译器会告诉你：去掉导入，看看会发生什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T02:48:46.640

1）。您希望您的代码能够编译。

您的编译问题是因为您要在 main 方法中声明您的运行方法。分离你的方法声明，然后只使用 main 来创建和运行你的线程。

2）。您希望有两个线程同时运行。

这意味着我们需要定义两个不同的线程类或一个具有逻辑来处理递增和递减的线程。Andrew Mao 的回答让您开始了解如何定义两个单独的线程。我上面的代码使用了一个 run 方法的单一定义，该方法使用一个参数来确定走哪条路。

3）。您希望两个线程同时处理相同的数据，因为当它们分别递增/递减时，它们需要检查冲突。

一个简单的方法是在 main 方法中创建您想要处理的对象（num1 和 num2），然后将这些对象的引用传递给您的线程。我上面的代码中的示例。

4）。你想测试一些东西

假设所有 java.lang.* 都是自动导入的。为了清楚起见，将其放在那里没有害处，但您选择的开发工具上的自动导入器命令可能会将其删除为多余的。

```
public class ThreadExperiment implements Runnable {
    /* these fields are unique to each instance of ThreadExperiment */
    private int increment = 0;

    /* these are used to point to the original num1 and num2 instances created in your main method */ 
    private Integer myNumber;
    private Integer theOtherNumber;

/** 
 * Constructor.   
 */
public ThreadExperiment(int increment, Integer num1Ref, Integer num2Ref) {
    this.increment = increment;
    this.myNumber = num1Ref;
    this.theOtherNumber = num2Ref;
}

@Override
public void run() {
    do {
        myNumber += increment;
        try {
            Thread.sleep(400);
        } catch (InterruptedException e) {
        }
        System.out.println(Thread.currentThread().getName() + " -- " + myNumber);
    } while (!myNumber.equals(theOtherNumber));
}

/** 
 * Your static main method used to instantiate & start threads 
 */
public static void main(String[] args) {
    Integer num1 = 0;
    Integer num2 = 10;

    Thread t = new Thread(new ThreadExperiment(1, num1, num2), "Thread 1");
    Thread t2 = new Thread(new ThreadExperiment(-1, num2, num1), "Thread 2");
    t.start();
    t2.start();
}

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T02:42:45.130

线程实现的`run`方法需要在一个单独的类中。您当然可以将其中一个放在您的`ThreadExperiment`班级中，但不能两者兼而有之。在这种情况下，您可以将两个线程分成内部类：

```
class ThreadExperiment {

  static int num = 1;
  static int num2 = 10;

  class Thread1 implements Runnable {
    @Override
    public void run(){      
        do {
            num++;
            try {
                Thread.sleep(400);
            } catch (InterruptedException e){
            }
        } while (num >= 0);
    }
  }

  class Thread2 implements Runnable {
    @Override
    public void run() {
        do {
            num2--;
            try {
                Thread.sleep(400);
            } catch (InterruptedException e){
            }
        } while (num >= 1);
    }
  }

  public static void main(String[] args) {

    Thread t = new Thread(new Thread1());    
    Thread t2 = new Thread(new Thread2());    

    t.start();
    t2.start();

    if (num == num2) {
        t.interrupt();
        t2.interrupt();
    }
  }
} 
```

现在我们到了某个地方，但您仍然需要解决一些逻辑问题：

*   将`int`s 设为静态并不是一个好习惯。（但是对于这个测试场景来说没关系。）
*   您的`num == num2`检查只会发生一次，并且无法保证发生这种情况时会出现什么值。线程被中断的可能性很小。
*   您需要声明`int`s `volatile`，因为它们将被不同的线程读取。
*   中的`while`条件`Thread1`将导致无限循环。

# java - Java 哈希码和桶大小 - 关系

> ID：15036327
> 
> 赞同：1
> 
> 时间：2013-02-23T02:25:57.083
> 
> 标签：java, data-structures, hash, hashmap

Java hashcode 是一个整数（大小 2 pow 32）

当我们创建哈希表/哈希图时，它会创建大小等于地图初始容量的桶。换句话说，它创建了一个大小为“初始容量”的数组

问题1、如何将key（java对象）的hashcode映射到bucket index？2.既然hashmap的大小可以增长，那么hashmap的大小可以等于2 pow 32吗？如果答案是肯定的，那么拥有一个大小为 2 pow 32 的数组是否明智？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T02:44:00.050

Java 数组的大小实际上仅限于 Integer.MAX_VALUE 元素，2^31-1。

HashMap 使用两个数组大小的幂，所以它可以使用的最大可能是 2^31。您将需要一个大的物理内存才能使其合理。

HashMap 在进行简单的按位与获取桶索引之前，会进行一系列移位和异或操作以减少一些冲突源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T03:22:06.540

这是当前源代码的链接：http: [//www.docjar.com/html/api/java/util/HashMap.java.html](http://www.docjar.com/html/api/java/util/HashMap.java.html)

您的问题的答案（部分）是特定于实施的。

1）查看代码。请注意，您对如何`initialCapacity`实现的假设是不正确的……至少对于 Oracle Java 6 和 7。具体来说，`initialCapacity`不一定是hashmap的数组大小。

2）a的大小`HashMap`是条目的数量，可以超过`2^32`！我假设您实际上是在谈论容量。HashMap 的数组的大小理论上限制为`2^31 - 1`（Java 数组的最大大小）。对于当前的实现，`MAX_CAPACITY`实际上是`2^30`; 看代码。

3）*“......明智的做法是有一个大小数组`2^32`？”* 使用当前定义的 Java 是不可能的，尝试做一些不可能的事情是不明智的。

如果您真的在询问 Java 中哈希表数据结构的设计，那么在正常大小的哈希表的效率和巨大的哈希表之间需要权衡；即具有显着多于`2^30`元素的地图。这些`HashMap`实现被调整为最适合正常大小的地图。如果您经常需要处理 HUGE 地图，并且性能至关重要，那么您应该寻求实现一个自定义地图类，该类已针对您的特定要求进行了调整。

# c# - 确认信息

> ID：15036329
> 
> 赞同：1
> 
> 时间：2013-02-23T02:26:27.257
> 
> 标签：c#, winforms, messagebox

如果用户选中 ，`Checkbox`我如何编码以显示`MessageBox.Show("..."`，在消息框中带有`YesNoCancel`按钮，并且当用户单击“否”时，会`MessageBox.Show`弹出另一个？

到目前为止，我的代码是这样的，它不起作用：

```
private void lipsCheckBox_CheckedChanged(object sender, EventArgs e)
    {
        if (lipsCheckBox.Checked = MessageBox.Show("...?",
            "Want something else?",
            MessageBoxButtons.YesNoCancel, MessageBox.Show("...?",
            "Yea, Burt's bees?",
            MessageBoxButtons.YesNoCancel, MessageBox.Show("...??",
            "Hell yea LipxMedx?",
            MessageBoxButtons.YesNoCancel),
            MessageBoxIcon.Question);
    } 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-23T06:30:29.513

你必须知道[`MessageBox Dialog`](http://www.dotnetperls.com/messagebox-show)

```
if (checkBox1.Checked && (MessageBox.Show("Yes or no", "The Title", 
    MessageBoxButtons.YesNo, MessageBoxIcon.Question, 
    MessageBoxDefaultButton.Button1) == System.Windows.Forms.DialogResult.Yes))
{
    //TODO: Stuff
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-23T02:32:20.583

做这样的事情：

```
if (checkBox1.Checked)
{

     DialogResult dr = MessageBox.Show("Message.", "Title", MessageBoxButtons.YesNoCancel, 
        MessageBoxIcon.Information);

    if (dr == DialogResult.Yes)
    {
        // Do something
    }
} 
```

您应该能够使用此代码段来完成您需要的其余部分。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-23T02:35:28.690

你可以这样做：

```
private void lipsCheckBox_CheckedChanged(object sender, EventArgs e)
{
    if (lipsCheckBox.Checked)
    {     
        DialogResult dr = MessageBox.Show("...?", "Want something else?", MessageBoxButtons.YesNoCancel, MessageBoxIcon.Information);

        if(dr == DialogResult.Yes)
        {
            //
        }
        else if(dr == DialogResult.Cancel)
        {
            //
        }
    }
} 
```

# apache - (htaccess) 允许流但禁用直接链接下载

> ID：15036333
> 
> 赞同：2
> 
> 时间：2013-02-23T02:27:41.407
> 
> 标签：apache, .htaccess

我目前正在使用：

```
RewriteEngine on
RewriteCond %{HTTP_REFERER} !^http://(www\.)?domain.com(/)?.*$     [NC]
RewriteRule .*\.(flv|mp4|pdf|xls|doc|mov|wmv|avi|mp3)$ http://domain.com [R,NC] 
```

它禁用了直接下载，但也停止了来自媒体播放器的流式传输。我意识到我无法完全停止下载，但我希望能够从一个域上的播放器流式传输，同时将文件托管在另一个域上。

# reporting-services - SSRS 旋转列

> ID：15036335
> 
> 赞同：9
> 
> 时间：2013-02-23T02:27:54.727
> 
> 标签：reporting-services, pivot

我目前有这个报告布局

**`ProductNumber``Description``PackType``Dimension``Weight`**
`PN 1                      ``Desc PN1      ``InnerPack ``1x1x1          ``1          `
`PN 1                      ``Desc PN1      ``SinglePack``1x1x1.2      ``1.2       `
`PN 2                      ``Desc PN2      ``InnerPack ``2x2x2          ``2          `
`PN 2                      ``Desc PN2      ``SinglePack``2x2.2x2.2   ``2.3       `
`PN 3                      ``Desc PN3      ``BulkPack  ``3x3x3          ``3          `

现在，我的用户想要像这样旋转

**                                              `          InnerPack          ``        SinglePack          ``            BulkPack          `**
**`ProductNumber``Description``Dimension``Weight``Dimension``Weight``Dimension``Weight`**
`PN 1                      ``Desc PN1      ``1x1x1         ``1          ``1x1x1.2       ``1.2       `
`PN 2                      ``Desc PN2      ``2x2x2         ``2          ``2x2.2x2.2    ``2.3       `
`PN 3                      ``Desc PN3      ``3x3x3          ``3            `

如何才能做到这一点？我正在使用 MS VS2008。

谢谢

TL

PS 感谢 ManisHearth 让我知道如何在帖子中创建表格。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-23T14:38:29.063

您可以使用标准**Matrix**来执行此操作。创建一个**矩阵**并添加一个基于*ProductNumber的***行组**和一个基于*PackType的***列组**。我还在矩阵中添加了几行，以允许在标题中添加更多详细信息。我必须拆分列标题单元格以添加*尺寸*和*重量*标题。

 *****将详细值添加到**Matrix**主体 - 我删除了添加到*Weight值的自动***Sum**，但这并不是绝对必要的。在设计器中它应该看起来像这样：

 *![在此处输入图像描述](../Images/f6041b226e182177b49e7164b99b3825.png)

还要考虑一件事；您的*PackType*组不是按字母顺序排列的，因此我更新了**Column Group**排序表达式以满足您所需的顺序。我用了：

```
=Switch(Fields!PackType.Value = "InnerPack", 1
    , Fields!PackType.Value = "SinglePack", 2
    , Fields!PackType.Value = "BulkPack", 3) 
```

最终结果，符合您的要求：

![在此处输入图像描述](../Images/e864c254b91768e581832fd6f45b2239.png)******

# php - 对停用词的全文布尔搜索返回空结果

> ID：15036338
> 
> 赞同：1
> 
> 时间：2013-02-23T02:28:35.077
> 
> 标签：php, mysql, full-text-search

我已经搜索了大量关于全文搜索的问题，但我找不到解决这个问题的方法。

我的命令如下：

`SELECT * FROM t1 WHERE MATCH (c1,c2,c3) AGAINST (:keyStr IN BOOLEAN MODE)`

如果 :keyStr == '+apple*' 我得到返回值。

如果 :keyStr == '+this*' 我什么也得不到。

如果 :keyStr == '+apple* +this*' 我什么也得不到。

如果 :keyStr == '+apple* +chicken*' 我得到返回值。

'this'、'apple' 和 'chicken' 都在数据库中，所有三个查询都应该返回非空结果。

我认为当有一个停用词输入数据库时​​会自动返回任何内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:48:54.457

我认为问题在于“this”是一个停用词，并且在“this”周围包含 + 和 *。

原因是它`:keyStr == '+apple* +this*'`需要 apple* 和 this*。但由于唯一匹配“this*”的是停用词，因此您看不到结果。

您可以尝试`:keyStr == '+apple* this*'`或插入一条带有 'thisorthat 的记录

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T02:33:51.423

不太可能。[Boolean Full-Text Search Documentation](http://dev.mysql.com/doc/refman/5.0/en/fulltext-boolean.html)明确指出它不会被视为停用词：

> 如果使用截断运算符指定单词，则不会从布尔查询中删除它，即使它太短（由 ft_min_word_len 设置确定）或停用词。出现这种情况是因为单词不是太短或停用词，而是作为前缀，必须以以前缀开头的单词的形式出现在文档中。

# java - java.lang.ClassCastException：java.lang.Integer 不能转换为 java.lang.Double

> ID：15036340
> 
> 赞同：3
> 
> 时间：2013-02-23T02:29:08.417
> 
> 标签：java, arrays, jakarta-ee

我在运行时面临编译这段代码的问题，这给我一个错误，即 java.lang.Integer 无法转换为 Java.lang.Double。如果有人帮助我更正此代码，我将非常高兴

```
 double x;

 public Double getMethod() {

     HashMap hashmap= new HashMap();

     hashmap = SumCal();

     List  listabc = (List) hashmap.get("abclist");
     int total=(Integer) hashmap.get("all_total");
     x = (Double) listabc.get(0)*100/total;
     return x;
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T02:37:40.557

您可以按照以下方式进行，但我建议您使用[Generics](http://docs.oracle.com/javase/tutorial/extra/generics/index.html)。

```
x = ((Integer) listabc.get(0) * 100 / total); 
```

如果您使用了像下面这样的泛型，则不需要任何强制转换。

```
List<Integer> listabc 
HashMap<String, Integer> hashmap 
x = listabc.get(0) * 100 / total; 
```

在这种情况下，您不需要任何铸造。引入 Integer、Double 等包装类的原因之一是避免强制转换。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T02:38:43.357

您的代码稍作更改将获得成功：

```
x = (double) listabc.get(0)*100/total; 
```

Integer 和 Double 不兼容，但 int 和 double 扩展兼容。在您当前的代码中，表达式的右侧（RHS）被自动装箱为一个整数，然后您将该结果指定为`Double`. 这个演员失败了。

相反，通过指定扩大转换，`Integer`结果被拆箱为 a `int`，然后转换为 a `double`。然后最后这一行：

```
return x; 
```

将 的值装箱`x`到 a中`Double`，并将其作为方法的结果返回。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T02:34:53.860

首先，您不应该使用泛型`HashMap`，因为这样编译器就无法帮助您处理类型。尝试声明以下内容：

```
HashMap<String, Integer> hashmap = new HashMap(); 
```

我不建议存储不同值类型的 HashMap，因为它只会引发编程错误。此外，无需将 an 强制`int`转换为`Double`. 您可以执行以下任何操作：

```
x = listabc.get(0) * 100.0 / total; // multiply by a floating-point number

x = (double) listabc.get(0) * 100 / total; // cast with (double) 
```

# xaml - Win8 XAML 如何将 List<> 绑定到 ListView

> ID：15036343
> 
> 赞同：0
> 
> 时间：2013-02-23T02:29:35.597
> 
> 标签：xaml, binding

我正在尝试在 Win8 应用程序的 XAML 页面上填充列表视图控件。我已将以下属性添加到页面 XAML：

```
<common:LayoutAwarePage x:Class="SecAviTools.ViewWeatherHome"
                    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:common="using:MyNameSpace.Common"
                    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                    xmlns:local="using:MyNameSpace"
                    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                    xmlns:viewmodel="using:MyNameSpace.Win8ViewModel"
                    x:Name="pageRoot"
                    DataContext="{Binding DefaultViewModel,
                                          RelativeSource={RelativeSource Self}}"
                    mc:Ignorable="d">

<!-- ... -->

<ListView ItemsSource="{Binding Path=viewmodel:Stations}">
    <ListView.ItemTemplate>
        <DataTemplate>
            <StackPanel>
                <TextBlock Text="{Binding Path=Id}"/>
                <TextBlock Text="{Binding Path=Name}"/>
            </StackPanel>
        </DataTemplate>
    </ListView.ItemTemplate>
</ListView> 
```

我的源类是：

```
namespace MyNameSpace.Win8ViewModel
{
    public class Stations : INotifyPropertyChanged, INotifyCollectionChanged
    {
        public event PropertyChangedEventHandler PropertyChanged;
        protected void OnPropertyChanged(string propertyName)
        {
            if (PropertyChanged != null)
                PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }

        public event NotifyCollectionChangedEventHandler CollectionChanged;
        protected void OnCollectionChanged<T>(NotifyCollectionChangedAction action, ObservableCollection<T> items)
        {
            if (CollectionChanged != null)
                CollectionChanged(this, new NotifyCollectionChangedEventArgs(action, items));
        }

        public Stations()
        {
            AllStations = new ObservableCollection<Station>();
            AddStations(new List<Station>());
        }

        public ObservableCollection<Station> AllStations { get; private set; }

        public void AddStations(List<Station> stations)
        {
            AllStations.Clear();
            foreach (var station in stations)
                AllStations.Add(station);

            OnCollectionChanged(NotifyCollectionChangedAction.Reset, AllStations);
            OnPropertyChanged("AllStations");
        }
    }

    public class Station
    {
        public int Id { get; set; }
        public string Name { get; set; }
    }
} 
```

页面上还有一个按钮（此处未显示）执行以下操作：

```
public sealed partial class MyPage : MyNameSpace.Common.LayoutAwarePage
{
    private Stations m_Stations = new Stations();

    //...

    private async void SearchButtonClick(object sender, RoutedEventArgs e)
    {
        var list = new List<Station>();
        list.Add(new Station() { Id = 0, Name = "Zero" });
        list.Add(new Station() { Id = 1, Name = "One" });

        m_Stations.AddStations(list);
    }
} 
```

但是，当我运行代码时，列表视图中没有显示任何内容。我错过了什么？

TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T15:55:37.050

你没有展示 DefaultViewModel 是什么，但我假设它被设置为你展示的类的实例，Stations。在这种情况下，您需要绑定为：

```
<ListView ItemsSource="{Binding Path=AllStations}"> 
```

绑定的路径通常是指某处的属性；如果没有进一步的规范，例如 Source，它是对象上设置为 DataContext 的属性。

无论如何，您不需要命名空间限定符“viewmodel:”。

顺便说一句，如果您最终绑定到 ObservableCollection，则不需要实现 INotifyCollectionChanged，只需要在设置 AllStations 属性时实现 INotifyPropertyChanged。

# jquery - 使用 .on Click 将处理程序附加到未来 点击事件

> ID：15036344
> 
> 赞同：0
> 
> 时间：2013-02-23T02:29:36.190
> 
> 标签：jquery

我有以下代码在被调用`<li>`时动态添加元素。点击处理程序使用 jQuery .on 点击​​事件`addBTS()`附加到所有当前和未来的元素：`<li>`

```
class Toolbar
  constructor: () ->

    @selected_BTS = undefined
    @bts_dropdown_selecion_clickhandler()

  addBTS: (name) =>
    $('#bts-dropdown').append "<li>#{name}</li>"

  bts_dropdown_selecion_clickhandler: () =>
    $('#bts-dropdown li').on 'click', ->
      console.log $(this).html
      Toolbar.selected_BTS = $(this).html
      $('#bts-display-button').html(@selected_BTS) 
```

`<li>`由于某种原因，当我单击任何生成的元素时，单击事件不会抵抗。谁能帮我解释为什么这不起作用？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:34:04.420

的绑定`on`需要绑定到从绑定时就存在的父元素。由于您`$('#bts-dropdown li')`直接绑定到它只会找到静态 li。应该工作的方式`on`如下：

```
$('#bts-dropdown').on('click', 'li', function()
{
}); 
```

但是，如果 #bts-dropdown 甚至假设发生了变化，那么请采取以下安全路线：

```
$(document).on('click', '#bts-dropdown li', function()
{
}); 
```

咖啡脚本中的语法是什么样的（这就是我假设的那样？可能想要编辑您的标签，以便它击中正确的受众），我不确定。但是，一旦您弄清楚如何使用正确的语法，这应该会让您到达您需要的位置。如果其他人以正确的语法提供了更正确的解决方案，请随时将其标记为正确答案。只是想帮忙。

我的猜测是：

```
$('#bts-dropdown').on 'click', 'li', -> 
```

编辑：为了解决您在调用`html`您需要的方法时记录到控制台的内容的新问题`()`。没有它，它会访问调用的属性（在本例中为函数）`html`然后调用`toString`它。您看到的是 jQuery`html`函数体。

```
console.log $(this).html() 
```

# ios - CoreData NSManagedObject being corrupted

> ID：15036348
> 
> 赞同：1
> 
> 时间：2013-02-23T02:30:06.220
> 
> 标签：ios, core-data

I have a controller that is the root of a workflow. If there is no data object for the workflow, then I create a new one, and if there is, I use the existing one. I have a property for the model object (an NSManagedObject)

```
@property (nonatomic, retain) Round *currentRound; 
```

and I call the following whenever the corresponding view is shown

```
self.currentRound = [self.service findActiveRound];
if (!self.currentRound) {
    NSLog((@"configure for new round"));
    self.currentRound = [self.service createNewRound];
    ...
} else {
    NSLog(@"configure for continue");
    // bad data here        
} 
```

The problem is at the place marked in the above, *sometimes* the data object is corrupted. In the parts I didn't show I set the values on some text fields to represent the values in the model. Sometimes its ok, but eventually the properties on the model object are empty and things break

In the debugger, the reference to the round doesn't appear to change, but NSLogging the relevant properties shows them nullified. debugging seems to delay the onset of the corruption.

I am aware I am not saving the context...should that matter? And if so, how come it doesn't always fail the first time I come back to this controller?

My findActiveRound message is nothing special, but in case it matters

```
-(Round *) findActiveRound
{
    NSLog(@"Create Active Round");
    NSFetchRequest *request = [[NSFetchRequest alloc]init];
    NSEntityDescription *entity = [NSEntityDescription entityForName:@"Round" inManagedObjectContext:context];
    [request setEntity:entity];

    NSPredicate *pred = [NSPredicate predicateWithFormat:@"isComplete == %@", [NSNumber numberWithBool:NO]];
    [request setPredicate:pred];

    NSError *error = nil;
    NSArray *results = [context executeFetchRequest:request error:&error];

    if ([results count] == 0) {
        return nil;
    } else {
        return [results objectAtIndex:0];
    }
} 
```

Many thanx.

**EDIT FOR RESPONSE**

By corrupted I mean when I try to get some simple string properties off the model object, I get nil values. So In the code above (where I think I have a round) I do stuff like

```
self.roundName.text = self.currentRound.venue;
self.teeSelection.text = self.currentRound.tees; 
```

and don't see the data I entered. Since it only fails sometimes, but always fails eventually, I will see the data I entered for a while before its gone.

I'm pretty sure the context is the same. My service is a singleton and created like so

```
@implementation HscService

+(id) getInstance
{
    static HscService *singleton = nil;
    static dispatch_once_t onceToken;

    dispatch_once(&onceToken, ^{
        singleton = [[self alloc] init];
    });
    return singleton;
}

-(id) init
{
    if (self = [super init]) {
        model = [NSManagedObjectModel mergedModelFromBundles:nil];
        NSPersistentStoreCoordinator *psc = [[NSPersistentStoreCoordinator alloc] initWithManagedObjectModel:model];

        NSString *path = [self itemArchivePath];
        NSURL *storeUrl = [NSURL fileURLWithPath:path];

        NSDictionary *options = [NSDictionary dictionaryWithObjectsAndKeys:
                                 [NSNumber numberWithBool:YES],
                                 NSMigratePersistentStoresAutomaticallyOption,
                                 [NSNumber numberWithBool:YES],
                                 NSInferMappingModelAutomaticallyOption, nil];

        NSError *error = nil;
        if (![psc addPersistentStoreWithType:NSSQLiteStoreType configuration:nil URL:storeUrl options:options error:&error]) {
            [NSException raise:@"Open failed" format: @"Reason: %@", [error localizedDescription]];
        }

        context = [[NSManagedObjectContext alloc] init];
        [context setPersistentStoreCoordinator:psc];
        [context setUndoManager:nil];
    }
    return self;
}

-(NSString *) itemArchivePath
{
    NSArray *docDirectories = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *dir = [docDirectories objectAtIndex:0];
    return [dir stringByAppendingPathComponent:@"hsc1.data"];
} 
```

and in every controller I get the singleton to perform operations. I plan on defining a delegate around round operations, and implementing it in my AppDelegate, so I'm only getting the service once in the app, but don't think that should matter for now....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:37:25.553

Are you sure the data is actually corrupted? Managed object contexts are highly efficient, and it's normal to fault in the debugger. From the docs:

> "Faulting is a mechanism Core Data employs to reduce your application’s memory usage..."

See [http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdFaultingUniquing.html](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdFaultingUniquing.html)

If the data is actually missing and cannot be accessed by other methods, make sure you're using the same Managed Object Context to access the data. If the data has not been committed to the data store, it will not "sync" between MOCs.

# html - 如何在 IE8 中隐藏新的 HTML5 元素之一？

> ID：15036353
> 
> 赞同：0
> 
> 时间：2013-02-23T02:31:16.373
> 
> 标签：html, internet-explorer-8, html5shiv

我有类似的东西：

```
<div id="body-no-aside">

  <div id="content">
    Some contents
  </div>

  <aside id="aside">
    Something aside
  </aside>

</div> 
```

我在我的页面标题中包含了 html5shiv.js。

现在，这个 CSS 似乎不适用于 IE8（#aside 仍然可见）：

```
#body-no-aside #aside {
  display: none;
} 
```

任何解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T05:46:06.687

你试过打电话吗

```
#aside{display:none;} 
```

如果您正在使用它，则没有充分的理由选择 id 之外的内容。它是所有选择器中最高的。我不知道这是否能解决你的问题，但我确信带有 js shiv 的 ie8 应该能够只选择一个旁边的 id。css3 后裔组合器（#body-no-aside #aside）可能是问题所在。

# hibernate - 使用hibernate和jdbc的事务隔离级别REPEATABLE_READ

> ID：15036355
> 
> 赞同：0
> 
> 时间：2013-02-23T02:31:25.220
> 
> 标签：hibernate, jdbc, transactions

我正在尝试开发一个演示来巩固我对 REPEATABLE_READ 隔离级别的理解。我尝试过使用 hibernate 和 jdbc 的演示。JDBC 按预期工作，但 hibernate 不能。

我的期望是，如果我在一个会话中读取数据库行，并且我尝试从另一个会话写入同一行，它应该阻塞直到第一个会话完成。

**休眠**：- 当我在线程 0 中“获取”一个对象（行）并休眠时，在线程 1 中我们尝试更新同一个对象（行），线程 1 应该等到线程 0 提交。

```
class HibernateExample7_IsolationRR_Read_Write_Thread implements Runnable {

    private static final Logger logger = LoggerFactory.getLogger(HibernateExample7_IsolationRR_Read_Write_Thread.class);

    SessionFactory sessionFactory;
    int sleep;
    int newnumberplate;
    public HibernateExample7_IsolationRR_Read_Write_Thread(SessionFactory sessionFactory, int sleep, int newnumberplate) {
        this.sessionFactory = sessionFactory;
        this.sleep = sleep;
        this.newnumberplate = newnumberplate;
    }

    public void run() {
        Session session = sessionFactory.openSession();
        Transaction tx = session.beginTransaction();
        logger.info("TRYING TO GET VEHICLE 1");
        Vehicle vid1 = (Vehicle) session.get(Vehicle.class, Integer.valueOf(1));
        logger.info("GOT VEHICLE 1");
        vid1.setNumberplate(this.newnumberplate);
        logger.info("SET NUMBERPLATE FOR 1");
        try {
            Thread.sleep(sleep);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        tx.commit();
        session.close();
        logger.info("COMMITED");
    }
} 
```

hibernate.connection.url 是**jdbc:derby:isolation;create=true**和 hibernate.connection.isolation 是**2**。我制作了两个 HibernateExample7_IsolationRR_Thread 对象，并创建了一个场景，其中线程 0 获取车辆并长时间休眠。同时线程 1 尝试获取和更新 Vehicle。它甚至在线程 0 提交之前成功提交。

由于 REPEATABLE_READ 隔离级别，T1 不应该等待提交。如果不是，那么它是 READ_COMMITED 隔离级别而不是 REPEATABLE_READ 隔离级别。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T08:42:20.480

你的期望是错误的。可重复读取并不意味着一个事务应该阻塞，而另一个事务读取同一行。这意味着在同一个事务中读取同一行两次应该返回相同的数据，即使另一个事务在第一次和第二次读取之间对该行提交了更改。

使用 Hibernate 可以免费获得（或多或少）这些，因为第二次读取将从一级缓存返回数据，而根本不需要访问数据库。

请参阅[http://en.wikipedia.org/wiki/Isolation_%28database_systems%29#Non-repeatable_reads](http://en.wikipedia.org/wiki/Isolation_%28database_systems%29#Non-repeatable_reads)

此外，您正在使用不支持此隔离级别的数据库进行测试：

[http://www.hsqldb.org/doc/2.0/guide/dbproperties-chapt.html#N15385](http://www.hsqldb.org/doc/2.0/guide/dbproperties-chapt.html#N15385)

# java - 如何调用不同类中的公共静态 void。

> ID：15036363
> 
> 赞同：1
> 
> 时间：2013-02-23T02:33:36.323
> 
> 标签：java, class, static-methods

我有 2 个课程，MainActivity 和 MainGame。如果我在 MainActivity 中有一个公共静态 void，在 MainGame 中有一个。我将如何从 MainActivity 执行 MainGame 中的那个？

例如，我有这个：

主要活动：

```
public static void 1()
{
2();
} 
```

主要游戏：

```
public static void 2()
{
//blah blah blah
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T02:35:41.373

我认为 2 不是一个有效的方法名称，但如果是这样的话：

```
MainActivity.2(); 
```

但是假设不是，而您将其称为两个，那么也许您正在寻找

```
public class MainGame {
    public static void one() {
        System.out.println("called one()");
    }
}

public class MainActivity {

    public static void two() {
        MainGame.one();
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T03:17:45.987

> 在 Java 中，所有名称必须以“_”或字母开头。

因此，我们可以将方法名称`1`作为`_1`和`2`as `_2`。

`static`在其他类中调用方法的语法是`ClassName.MethodName(arguments)`.
因此，在这种情况下，您将更改代码如下：

```
class MainActivity{
public static void _1()
{
MainGame._2();
}
}
class MainGame{
public static void _2()
{
//blah blah blah
}
} 
```

# windows - 希望在 Windows 中编写蓝牙“hcitool”等效项

> ID：15036364
> 
> 赞同：4
> 
> 时间：2013-02-23T02:33:46.377
> 
> 标签：windows, bluetooth, bluez

我在 Linux 中使用了 Bluez 蓝牙堆栈，它带有一个方便的实用程序“hcitool”。希望在 Windows 中构建具有相同或等效功能的类似功能。具体来说，'hcitool name < MAC >'，显示指定设备是否在范围内。任何指导将不胜感激。

我有带有 Visual Studio 2010 的 Windows SDK v7，使用 C/C++

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T19:49:12.970

使用我的[32feet.NET](https://github.com/inthehand/32feet)库，如下所示。

**编辑 3 月 3 日：**我现在添加了代码来*直接*按地址查找设备，而不是使用设备发现；所以这是一个简单的'new BluetoothDeviceInfo(...)'。

看看是否能找到你想要的设备。这要求远程设备仅处于“可连接”模式，而前者要求它处于“可发现”模式。（顺便说一句，我已将发现代码留在原处。）

**编辑 3 月 8 日：**现在进行连接（使用 SDP API）以检查设备是否在范围内（并且处于可连接模式）。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;
using InTheHand.Net.Bluetooth;
using InTheHand.Net;
using InTheHand.Net.Sockets;
using System.Diagnostics;
using System.Net.Sockets;

namespace hcitool
{
    partial class Program
    {
        static bool infoRatherThanName;
        static BluetoothAddress _searchAddress;

        static int Main(string[] args)
        {
            if (args.Length < 1) {
                Console.WriteLine("Please specify command.");
                return 2;
            }
            var cmd = args[0];
            switch (cmd) {
                case "name":
                    infoRatherThanName = false;
                    break;
                case "info":
                    infoRatherThanName = true;
                    break;
                //-
                case "dev":
                    return ShowRadios();
                //case "auth":
                //    return CauseAuth(GETADDRESS());
                default:
                    throw new NotImplementedException("Command: '" + cmd + "'");
            }
            if (args.Length < 2) {
                Console.WriteLine("Please specify device address.");
                return 2;
            }
            var addrS = args[1];
            _searchAddress = BluetoothAddress.Parse(addrS);
            //
            var dev = new BluetoothDeviceInfo(_searchAddress);
            bool isInRange = GetCanConnectTo(dev);
            if (isInRange) {
                PrintDevice(dev);
            } else {
                Console.WriteLine("Can't see that device.");
            }
            //
            Console.WriteLine("simple");
            return Simple();
            //return Fancier();
        }

        //----
        private static int ShowRadios()
        {
            BluetoothRadio[] list;
            try {
                list = BluetoothRadio.AllRadios;
            } catch (Exception) {
                return 1;
            }
            Debug.Assert(list.Length != 0, "Expect zero radios case to raise an error.");
            foreach (var curR in list) {
                Console.WriteLine("* {0} '{1}'", curR.LocalAddress, curR.Name);
                Console.WriteLine("{0}", curR.SoftwareManufacturer);
                Console.WriteLine("{0}", curR.Manufacturer);
                Console.WriteLine("{0}", curR.Mode);
            }//for
            return 0;
        }

        private static int CauseAuth(BluetoothAddress addr)
        {
            BluetoothSecurity.PairRequest(addr, null);
            return 0;
        }

        //----
        static int Simple()
        {
            BluetoothDeviceInfo[] devices;
            BluetoothDeviceInfo foundDev = null;
            var cli = new BluetoothClient();
            // Fast: Remembered/Authenticated
            devices = cli.DiscoverDevices(255, true, true, false, false);
            SimpleCheckDevice(devices, ref foundDev);
            if (foundDev == null) {
                // Slow: Inquiry
                cli.DiscoverDevices(255, false, false, true, false);
                SimpleCheckDevice(devices, ref foundDev);
            }
            //
            if (foundDev != null) {
                return 0;
            } else {
                return 1;
            }
        }

        private static void SimpleCheckDevice(IEnumerable<BluetoothDeviceInfo> devices,
            ref BluetoothDeviceInfo foundDev)
        {
            foreach (var cur in devices) {
                if (cur.DeviceAddress == _searchAddress) {
                    foundDev = cur;
                    PrintDevice(cur);
                }
            }//for
        }

        private static void PrintDevice(BluetoothDeviceInfo cur)
        {
            Console.WriteLine("* Found device: '{0}' ", cur.DeviceName);
            if (infoRatherThanName) {
                try {
                    var vs = cur.GetVersions();
                    Console.WriteLine(vs.Manufacturer);
                    Console.WriteLine(vs.LmpVersion);
                    Console.WriteLine(vs.LmpSubversion);
                    Console.WriteLine(vs.LmpSupportedFeatures);
                } catch (Exception ex) {
                    Console.WriteLine("Failed to get remote device versions info: "
                        + ex.Message);
                }
            }
        }

        //----
        private static bool GetCanConnectTo(BluetoothDeviceInfo device)
        {
            bool inRange;
            Guid fakeUuid = new Guid("{F13F471D-47CB-41d6-9609-BAD0690BF891}");
            try {
                ServiceRecord[] records = device.GetServiceRecords(fakeUuid);
                Debug.Assert(records.Length == 0, "Why are we getting any records?? len: " + records.Length);
                inRange = true;
            } catch (SocketException) {
                inRange = false;
            }
            return inRange;
        }

    }
} 
```

# crud - Dart 可以用于基本的 CRUD Web 应用程序吗？

> ID：15036366
> 
> 赞同：3
> 
> 时间：2013-02-23T02:33:57.463
> 
> 标签：crud, dart

我刚刚发现了这种语言，我想知道是否可以使用数据库制作基本的 CRUD Web 应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T04:56:14.810

有[mysql](https://github.com/jamesots/sqljocky)和[postgresql](https://github.com/xxgreg/postgresql)的库，核心库提供了一个支持 HTTP、HTTPS 和 WebSocket的[Web 服务器。](http://api.dartlang.org/docs/releases/latest/dart_io/HttpServer.html)

有一个[模板](https://code.google.com/p/dart/source/browse/#svn/branches/bleeding_edge/dart/utils/template)库，它不是正式版本的一部分。而且，还有一个社区 [mustache](https://github.com/valotas/mustache4dart)端口（我认为它目前还没有构建，所以你可能需要修复它）。

所以这绝对是可能的。但您将成为早期采用者。如果您想快速完成工作，我会选择其他东西，但如果您想学习新技能，请潜入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T03:31:14.183

当然。不过，它是一种相当新的语言，因此您还不会在其他语言中找到强大的库支持。但是它正在迅速增长，所以我认为它不会很长。你可以用 dart 编写你的服务器，也可以用另一种语言编写你的服务器，并公开一个基本的 HTTP 接口供你的 Dart 客户端使用。

这是一个编写简单的 Web 应用程序的[示例，该应用程序创建和存储“博客”帖子。](http://blog.dartwatch.com/2012/03/building-client-server-dart-app-part-1.html)客户端和服务器都是用 Dart 编写的。数据库是 MongoDB。

另请查看[此问题](https://stackoverflow.com/questions/9558282/dart-interaction-access-to-database)以获取更多信息。

# .net - 为什么我从 MS Test 单元测试中收到 InvalidComObjectException，但仅在构建服务器上？

> ID：15036371
> 
> 赞同：0
> 
> 时间：2013-02-23T02:34:59.917
> 
> 标签：.net, unit-testing, tfs, mstest

我有一个后来的兼容性项目，它恰好调用了 COM，为此我进行了一些单元测试。当我从本地机器运行这些测试时，一切都很好。

但是当这些测试在我团队的构建服务器上运行时，我收到以下错误：

> 类初始化方法 Foo.Bar.Baz.Initialize 抛出异常。System.Runtime.InteropServices.InvalidComObjectException：System.Runtime.InteropServices.InvalidComObjectException：无法使用已与其底层 RCW 分离的 COM 对象。

在 2005-2008 年的时间范围内，我已经看到一些关于 Visual Studio 早期版本的此类问题的讨论。但是单元测试基础设施在 2012 年被完全取代。大多数解决方案似乎都涉及编辑该项目没有的“.testsettings”文件。

我正在使用 Visual Studio 2012 Update 1 进行开发，构建服务器和 TFS 实例正在运行 TFS 2010 SP1。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T20:49:12.360

原因是构建服务器上的 TFS 2010 团队工具正在使用 Visual Studio 2010 测试位。

我创建了一个`.testsettings`包含以下内容的文件，并将其签入到 TFS：

```
<?xml version="1.0" encoding="UTF-8"?>
<TestSettings name="Local" id="2010983b-bdae-4cf9-910d-08bad14e68cf" 
              xmlns="http://microsoft.com/schemas/VisualStudio/TeamTest/2010">
  <Description>This forces tests to run as a MTA. (Visual Studio 2012 just works;
               2010 completely explodes on the build server)</Description>
  <Deployment enabled="false" />
  <Execution>
    <TestTypeSpecific />
    <AgentRule name="Execution Agents">
    </AgentRule>
    <ExecutionThread apartmentState="MTA" />
  </Execution>
</TestSettings> 
```

请注意，我实际上并没有将此文件添加到 Visual Studio 2012 中的单元测试项目本身。然后，我将构建服务器的构建定义配置为指向此签入`.testsettings`文件。

这样我就可以在我的开发盒上使用 Visual Studio 2012 中的新（更好的）测试运行程序，但 Visual Studio 2010 测试运行程序在构建服务器上工作得很好。

# android - 屏幕锁定时 Mp3 已暂停

> ID：15036372
> 
> 赞同：0
> 
> 时间：2013-02-23T02:35:16.727
> 
> 标签：android, url, service, mp3

mp3 在屏幕锁定时暂停..这是我的主要 java 代码...我搜索了一些信息，但没有任何帮助。顺便说一下，单击播放后，然后停止，然后重新播放，应用程序强制崩溃，有时它需要更多的点击，有时更少..有人可以帮我吗..谢谢！

```
import android.app.Activity;
import android.media.MediaPlayer;
import android.media.MediaPlayer.OnBufferingUpdateListener;
import android.media.MediaPlayer.OnPreparedListener;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.ProgressBar;

public class Main extends Activity implements OnClickListener {

private ProgressBar playSeekBar;

private Button buttonPlay;

private Button buttonStopPlay;

private MediaPlayer player;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    initializeUIElements();

    initializeMediaPlayer();
}
private void initializeUIElements() {

    playSeekBar = (ProgressBar) findViewById(R.id.progressBar1);
    playSeekBar.setMax(100);
    playSeekBar.setVisibility(View.INVISIBLE);

    buttonPlay = (Button) findViewById(R.id.buttonPlay);
    buttonPlay.setOnClickListener(this);

    buttonStopPlay = (Button) findViewById(R.id.buttonStopPlay);
    buttonStopPlay.setEnabled(false);
    buttonStopPlay.setOnClickListener(this);

}
public void onClick(View v) {
    if (v == buttonPlay) {
        startPlaying();
    } else if (v == buttonStopPlay) {
        stopPlaying();
    }
}  
private void startPlaying() {
    buttonStopPlay.setEnabled(true);
    buttonPlay.setEnabled(false);

    playSeekBar.setVisibility(View.VISIBLE);

    player.prepareAsync();

    player.setOnPreparedListener(new OnPreparedListener() {

        public void onPrepared(MediaPlayer mp) {
            player.start();
        }
    });

}

private void stopPlaying() {
    if (player.isPlaying()) {
        player.stop();
        player.release();
        initializeMediaPlayer();
    }

    buttonPlay.setEnabled(true);
    buttonStopPlay.setEnabled(false);
    playSeekBar.setVisibility(View.INVISIBLE);
}

private void initializeMediaPlayer() {
    player = new MediaPlayer();
    try {
        player.setDataSource("http://users1.jabry.com/mine/inna.mp3");
    } catch (IllegalArgumentException e) {
        e.printStackTrace();
    } catch (IllegalStateException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    player.setOnBufferingUpdateListener(new OnBufferingUpdateListener() {

        public void onBufferingUpdate(MediaPlayer mp, int percent) {
            playSeekBar.setSecondaryProgress(percent);
            Log.i("Buffering", "" + percent);
        }
    });
}

@Override
protected void onPause() {
    super.onPause();
    if (player.isPlaying()) {
        player.stop();
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T03:45:25.203

当屏幕被锁定时，您的 onPause 被调用，并且您明确地在那里停止播放器。

# android - 使用 android xml，假设我有一个带有按钮行的表格布局。有没有办法改变一个按钮的按钮高度来填充两行？

> ID：15036376
> 
> 赞同：0
> 
> 时间：2013-02-23T02:35:43.823
> 
> 标签：android, xml

使用 android xml，假设我有一个带有按钮行的表格布局。有没有办法改变一个按钮的按钮高度来填充两行？例如，我想要一个右侧带有“等于”按钮的计算器，其高度是许多简单计算器中的两倍。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T02:42:09.690

TableLayout 仅支持列跨越，不支持行跨越，因此在这种情况下，您需要将表格嵌套在另一个布局中，并在外部布局中添加等号按钮。例如，您可以使用水平 LinearLayout 作为外部布局。

# jquery - 从返回的 ajax 成功之外访问变量正在破坏我的代码

> ID：15036378
> 
> 赞同：-1
> 
> 时间：2013-02-23T02:35:53.307
> 
> 标签：jquery, ajax

好的，所以基本上我要做的是获取从 MySQL 插入返回的“slot_id”的创建 id 值。（有效），然后我尝试使用 slot_id 的返回值设置新的 tr 的 id。正在设置变量 slot_id 我想我只是用错了。这是代码。如果我添加一个 console.log(slot_id); 在成功时它返回值。

```
$('#add_slot').click(function(e){
        var slot_id;
        date = $("#slot_date").val(); 
        start_time = $("#slot_start").val(); 
        end_time = $("#slot_end").val();
        speaker_id = $("#speaker").val();
        speaker = $("#speaker option:selected").text();
        event_id = $("#event_id").val();
        last_row = $("tr:last").hasClass('odd');
            $.ajax({
                    type: 'POST',
                    url: 'ajax/process_slot.php',
                    data: {
                        date: date,
                        start_time: start_time,
                        end_time: end_time,
                        speaker_id: speaker_id,
                        event_id: event_id
                    },
                    success: function(response){
                            var $bodyresp=$(response);                 
                        var resp = $bodyresp.filter("#response").text();
                        slot_id = $bodyresp.filer("#slotid").text(); 
/// slot_id is the problem child. Why is it when I access it below to set the tr id value to slot_' + slot_id ......
                        $("#flash_message").html(resp);
                        $('#mask , .popup').fadeOut(300 , function() {
                            $('#mask').remove();  
                        });                    
                    }
                    });
        if(last_row === false){                             
        $("#slot_table").find('tbody')
        .append($('<tr id="slot_'+ slot_id +'" class="odd">')
            .append($('<td>' + date + '</td>' + '<td>' + start_time + '</td>' + '<td>' + end_time + '</td><td>'+ speaker+'</td><td><a class="delete_row" href="#delete_row">Delete Row</a></td>')
            )
        );

        }else {
        $("#slot_table").find('tbody')
        .append($('<tr id="slot_'+slot_id+'" class="even">')
            .append($('<td>' + date + '</td>' + '<td>' + start_time + '</td>' + '<td>' + end_time + '</td><td>'+ speaker+'</td><td><a class="delete_row" href="#delete_row">Delete Row</a></td>')
            )
        );
        }
        e.preventDefault();
    }) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:57:01.043

这里可能有几件事。slot_id 超出了范围...好吧，它是在没有 var 的情况下声明的，所以它是一个全局的（因此将可用，但已提升），但实际上尚未填充。您的下一步代码在 ajax 请求返回之前运行。尝试将以下块放在延迟中，例如

`$.ajax(...).then( stuff with slot_id )`

这意味着代码在 ajax 函数返回之前不会运行。

[http://api.jquery.com/category/deferred-object/](http://api.jquery.com/category/deferred-object/)

# javascript - CKEditor 未定义

> ID：15036379
> 
> 赞同：1
> 
> 时间：2013-02-23T02:36:16.177
> 
> 标签：javascript, asp.net, ckeditor

我已将[CKEditor.Net](http://ckeditor.com/download)添加到我的 ASP.NET Web 应用程序项目中。当我尝试使用 javascript 插入文本时，会出现此错误

```
Error: 'CKEDITOR' is undefined 
```

这是我的代码，

**HTML**

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Site.Master" AutoEventWireup="true"    CodeBehind="Test.aspx.cs" Inherits="eLetters.Test" %>
<%@ Register Assembly="CKEditor.NET" Namespace="CKEditor.NET" TagPrefix="CKEditor" %>

<asp:Content ID="Content1" ContentPlaceHolderID="HeadContent" runat="server">
    <script type="text/javascript">
        function insertText(text) {
            CKEDITOR.instances.insertText('text');
        }
    </script>
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="FeaturedContent" runat="server">
</asp:Content>
<asp:Content ID="Content3" ContentPlaceHolderID="MainContent" runat="server">
    <CKEditor:CKEditorControl ID="CKEditor1" BasePath="/ckeditor/" runat="server"></CKEditor:CKEditorControl>
</asp:Content> 
```

**C＃**

```
 protected void Button1_Click(object sender, EventArgs e)
    {
        Page.ClientScript.RegisterStartupScript(GetType(), "MyKey", "insertText('data');", true);
    } 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T02:43:49.070

尝试`BasePath="~/ckeditor"`在您的标记中设置。

这是一个用于实例化工具栏的代码隐藏片段：

```
CKEditor1.config.toolbar = new object[] 
{ 
    new object[] { "Bold", "Italic", "Underline", "Strike", "-", "Cut", 
    "Copy", "Paste", "PasteText", "-", "NumberedList", "BulletedList", 
    "-", "Outdent", "Indent", "Blockquote", "-", "JustifyLeft", 
    "JustifyCenter", "JustifyRight", "JustifyBlock"} }; 
```

注释掉您的文本插入脚本，然后将其设置为开始 ;-)

# php - 在另一个控制器中调用静态方法

> ID：15036380
> 
> 赞同：1
> 
> 时间：2013-02-23T02:36:19.743
> 
> 标签：php, yii

我想在另一个控制器中调用静态方法来执行一些类似全局实用程序的操作（例如更新文件）。但我收到一条错误消息：

> 包括（AnotherController.php）：未能打开流：没有这样的文件或目录

在*/yii/framework/YiiBase.php(421)*：

> 包括（$className.'.php'）；

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T05:12:27.810

Yii 不会自动加载控制器。将以下内容添加到您的配置文件中：

```
// autoloading model and component classes
'import'=>array(
    'application.controllers.*',
    ...
), 
```

或者，在调用给定控制器之前，添加以下行：

```
Yii::import('application.controllers.AnotherController'); 
```

# c# - 如何在 C# 中使用 LINQ 返回不同单词的列表？

> ID：15036381
> 
> 赞同：1
> 
> 时间：2013-02-23T02:36:30.567
> 
> 标签：c#, .net, linq

目标是对文本（即语音）进行排序，并将语音中不同单词的列表输出到文本框。我已经阅读了板上的很多提示并玩了很多，但此时我比开始时更加困惑。这是我的代码

```
 private void GenerateList(string[] wordlist)
    {
       List<string> wordList = new List<string>();

        for (int i = 0; i < wordlist.Length; i++)
        {
            wordList.Add(wordlist[i]);
        }

        var uniqueStr = from item in wordList.Distinct().ToList()
                        orderby item
                        select item;

        for (int i = 0; i < uniqueStr.Count(); i++ )
        {
            txtOutput.Text = uniqueStr.ElementAt(i) + "\n";
        }

    } 
```

在这一点上，我得到了一个字的回报。对于我使用的文本（葛底斯堡地址），它是“年”这个词，它是文本中该词的唯一实例。

我将函数传递给加载到字符串数组中的每个单词，然后将其放入列表中（这可能是多余的？）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T19:34:59.383

我希望这能以简单有效的方式满足您的需求（使用 LINQPad 中的 .Dump() ）

```
void Main()
{
    // can be any IEnumerable<string> including string[]
    var words = new List<string>{"one", "two", "four", "three", "four", "a", "z"};

    words.ToDistinctList().Dump();

    // you would use txtOutput.Text = words.ToDistinctList()
}

static class StringHelpers
{
    public static string ToDistinctList(this IEnumerable<string> words)
    {
        return string.Join("\n", new SortedSet<string>(words));
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-08T09:27:49.343

关于您的问题的一些提示：

*   没有理由把数组变成list，因为LINQ扩展方法是定义在`IEnumerable<T>`的，数组和list都实现了
*   确保所有字母的大小写相同 - 例如，使用 ToLower
*   您在每次迭代中都覆盖 txtOutput.Text。不要设置新值，而是将新部分附加到现有值

这是产生您想要的输出的简单代码：

```
IEnumerable<string> distinct =
    wordList
    .Select(word => word.ToLower())
    .Distinct()
    .OrderBy(word => word);

txtOutput.Text = string.Join("\n", distinct.ToArray()); 
```

在相关说明中，这是一个非常简单的 LINQ 表达式，它从文本中返回不同的单词，其中整个文本被指定为一个字符串：

```
public static IEnumerable<string> SplitIntoWords(this string text)
{

    string pattern = @"\b[\p{L}]+\b";

    return
        Regex.Matches(text, pattern)
            .Cast<Match>()                          // Extract matches
            .Select(match => match.Value.ToLower()) // Change to same case
            .Distinct();                            // Remove duplicates

} 
```

您可以在此处找到针对同一问题的更多正则表达式模式变体：[Regex and LINQ Query to Split Text into Distinct Words](http://www.codinghelmet.com/?path=hints/split-text-into-words)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-23T03:39:35.713

您可以使用[`StringBuilder`该类](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx)具有流畅接口以及 LINQ 的事实来大大简化这一点。

首先，您可以创建`StringBuilder`并将所有单词连接到同一个实例中，如下所示：

```
// The builder.
var builder = new StringBuilder();

// A copy of the builder *reference*.
var builderCopy = builder;

// Get the distinct list, order by the string.
builder = wordList
    // Get the distinct elements.
    .Distinct()
    // Order the words.
    .OrderBy(w => w).
    // Append the builder.
    Select(w => builderCopy.AppendLine(word)).
    // Get the last or default element, this will
    // cycle through all of the elements.
    LastOrDefault();

// If the builder is not null, then assign to the output, otherwise,
// assign null.
txtOutput.Text = builder == null ? null : builder.ToString(); 
```

请注意，您不必实际具体化列表，因为`wordList`它*已经*是一个具体化列表，它是一个数组（作为旁注，C# 中的类型化数组实现了[`IList<T>`接口](http://msdn.microsoft.com/en-us/library/5y536ey6.aspx)）。

该[`AppendLine`方法](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.appendline.aspx)（以及 上的大多数方法`StringBuilder`）返回执行操作的实例`StringBuilder`，这就是[`LastOrDefault`方法](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.lastordefault.aspx)调用起作用的原因；只需调用操作并返回结果（返回的每个项目都是相同的引用）。

该`builderCopy`变量用于避免[访问修改后的闭包](https://stackoverflow.com/a/235459/50776)（确保安全永远不会受到伤害）。

最后的空检查是针对`wordList`不包含任何元素的情况。在这种情况下，调用`LastOrDefault`将返回 null。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-23T02:44:10.620

以下是我如何简化您的代码以及实现您想要实现的目标。

```
private void GenerateList(string[] wordlist)
{
   List<string> wordList = wordlist.ToList(); // initialize the list passing in the array

    var uniqueStr = from item in wordList.Distinct().ToList()
                    orderby item
                    select item;

    txtOutput.Text = String.Join("\n", uniqueStr.ToArray());
} 
```

# javascript - 使用 javascript 请求结果作为值

> ID：15036382
> 
> 赞同：0
> 
> 时间：2013-02-23T02:36:58.393
> 
> 标签：javascript, xmlhttprequest, progress-bar, getelementbyid

我正在尝试测量上传百分比并将结果输出为纯文本以及进度条或 div 宽度的值。

```
 var request = new XMLHttpRequest();
request.upload.addEventListener('progress', function (event) {
    if (event.lengthComputable) {
        var percent = event.loaded / event.total;
        var progress = document.getElementById('upload_progress');

        while (progress.hasChildNodes()) {
            progress.removeChild(progress.firstChild);
        }
        progress.appendChild(document.createTextNode(Math.round(percent * 100) + ' %'));

    }
}); 
```

以上是我当前使用的部分内容，它向 id 为“upload_progress”的 div 输出四舍五入的百分比 + %。我还想将百分比输出到使用 html5 进度标记的进度条。像这样的东西`<progress id="progressbar" value="X" max="100"></progress>`，其中 X 来自 javascript。

```
var bar = document.getElementById('progressbar')
bar.value = (Math.round(percent * 100)) 
```

我认为在适当的地方添加它会有所帮助，但它似乎根本不起作用。

抱歉，如果这应该很明显，我对 javascript 和一般编程很陌生。我怎样才能使这项工作？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T12:06:52.087

首先，确保在 DOM 完全加载后获取元素。`value`此外，您应该在`progress`事件处理程序中设置进度百分比。

```
var progress, bar;
window.onload = function() {
    progress = document.getElementById('upload_progress');
    bar = document.getElementById('progressbar');
}

var request = new XMLHttpRequest();
request.upload.addEventListener('progress', function (event) {
    if (event.lengthComputable) {
        var percent = Math.round(event.loaded / event.total * 100);
        bar.value = percent;
        // other code here...
    }
}); 
```

你为什么要做这么多的 DOM 操作？您应该只设置`innerHTML`相应的`div`以显示百分比文本。

```
// instead of this:
//while (progress.hasChildNodes()) {
//    progress.removeChild(progress.firstChild);
//}
//progress.appendChild(document.createTextNode(percent + ' %'));

// You can do this:
progress.innerHTML = percent + ' %'; 
```

最后确保您正在调用`request.open(...);`
除此之外我没有看到您的代码有任何问题。

# php - 迭代我的对象中的值

> ID：15036385
> 
> 赞同：0
> 
> 时间：2013-02-23T02:37:08.183
> 
> 标签：php

我有一个包含二维数组的对象，但我似乎无法使输出正常工作。

我看起来像这样的数据：

```
foreach($myObj as $key){
    foreach($myObj[$key] as $key2){
        echo '['.$key.','.$key2.'], ';
    }
} 
```

但我没有得到任何输出，只是一个空白页。我的错误日志中也没有错误。

我的对象结构如下：

```
coOrds Object
(
    [xy:coOrds:private] => Array
        (
            [10] => Array //value 10 would be $key
                (
                    [10] => //10 here would be $key2
                    [11] => 
                    [12] => 
                )

            [11] => Array
                (
                    [10] => 
                    [11] => 
                    [12] => 
                )

        )
} 
```

我的循环做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:39:15.373

这应该有效：

```
foreach($myObj as $key => $array){
    foreach($array as $key2 => $array2){
        echo '['.$key.','.$key2.'], ';
    }
} 
```

**编辑**

由于`xy`是私有的，您应该：

*   公开
*   创建一个简单的getter`public function getXY() { return $this->xy; }`

然后：

```
foreach($myObj->getXY() as $key => $array){
    foreach($array as $key2 => $array2){
        echo '['.$key.','.$key2.'], ';
    }
} 
```

**编辑 2**

工作样本：

```
class coOrds {
  public $xy = array(10 => array(1, 2, 3), 11 => array(4,5,6));
}

$myObj = new coOrds();

foreach($myObj->xy as $key => $array){
    foreach($array as $key2 => $array2){
        echo '['.$key.','.$key2.'], ';
    }
} 
```

输出：

```
[10,0], [10,1], [10,2], [11,0], [11,1], [11,2], 
```

# javascript - 使用 JavaScript 使画在画布上的图像可拖动

> ID：15036386
> 
> 赞同：28
> 
> 时间：2013-02-23T02:37:11.967
> 
> 标签：javascript, html5-canvas

我能够在 HTML 画布上成功绘制图像。但我需要能够在画布上拖动图像。

我知道这个功能可以通过一些 JavaScript 库（如 KinectJS）轻松实现。但我只想用简单的 JavaScript 来做。

```
window.onload = function(){
var canvas = document.getElementById("myCanvas");
var context = canvas.getContext("2d");
var destX = 0;
var destY = 0;
var imageObj = new Image();

imageObj.onload = function(){
  context.drawImage(imageObj, destX, destY);
};
imageObj.src = "westeros.png"; 
```

```
<canvas id="myCanvas" height=1024 width=360></canvas> 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-02-23T04:37:32.913

要进行拖动，您需要处理 3 个鼠标事件：

1.  mousedown -- 设置一个标志，指示拖动已经开始。

2.  mouseup -- 清除该拖动标志，因为拖动结束

3.  mousemove -- 如果设置了拖动标志，则清除画布并在鼠标位置绘制图像

这是一些代码：

```
<!doctype html>
<html>
<head>
<link rel="stylesheet" type="text/css" media="all" href="css/reset.css" /> <!-- reset css -->
<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>

<style>
    body{ background-color: ivory; }
    canvas{border:1px solid red;}
</style>

<script>
$(function(){

    var img = new Image();
    img.onload = function(){
        ctx.drawImage(img, 0,0);
    };
    img.src = "http://images.christmastimeclipart.com/images/2/1271716593176_1788/img_1271716593176_17881.jpg";

    var canvas=document.getElementById("canvas");
    var ctx=canvas.getContext("2d");
    var canvasOffset=$("#canvas").offset();
    var offsetX=canvasOffset.left;
    var offsetY=canvasOffset.top;
    var canvasWidth=canvas.width;
    var canvasHeight=canvas.height;
    var isDragging=false;

    function handleMouseDown(e){
      canMouseX=parseInt(e.clientX-offsetX);
      canMouseY=parseInt(e.clientY-offsetY);
      // set the drag flag
      isDragging=true;
    }

    function handleMouseUp(e){
      canMouseX=parseInt(e.clientX-offsetX);
      canMouseY=parseInt(e.clientY-offsetY);
      // clear the drag flag
      isDragging=false;
    }

    function handleMouseOut(e){
      canMouseX=parseInt(e.clientX-offsetX);
      canMouseY=parseInt(e.clientY-offsetY);
      // user has left the canvas, so clear the drag flag
      //isDragging=false;
    }

    function handleMouseMove(e){
      canMouseX=parseInt(e.clientX-offsetX);
      canMouseY=parseInt(e.clientY-offsetY);
      // if the drag flag is set, clear the canvas and draw the image
      if(isDragging){
          ctx.clearRect(0,0,canvasWidth,canvasHeight);
          ctx.drawImage(img,canMouseX-128/2,canMouseY-120/2,128,120);
      }
    }

    $("#canvas").mousedown(function(e){handleMouseDown(e);});
    $("#canvas").mousemove(function(e){handleMouseMove(e);});
    $("#canvas").mouseup(function(e){handleMouseUp(e);});
    $("#canvas").mouseout(function(e){handleMouseOut(e);});

}); // end $(function(){});
</script>

</head>

<body>
    <canvas id="canvas" width=400 height=300></canvas>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-02-14T22:06:03.233

[markE的回答](https://stackoverflow.com/a/15037102/2044993)让我大部分时间都在那里，但是我在识别我的鼠标所在的位置时遇到了一些问题。我附上了我的代码，尽管因为我使用的是OO JS，所以它的结构会有所不同：

```
 hitImage: function() {
      return (this.startX > this.imageX && this.startX < this.imageX + this.imageWidth && this.startY > this.imageY && this.startY < this.imageY + this.imageHeight);
    },

    handleMouseDown: function(e){
      this.startX = parseInt(e.clientX - this.offsetX);
      this.startY = parseInt(e.clientY - this.offsetY);
      // set the drag flag
      this.isDragging= this.hitImage;
    },

    handleMouseUp: function(e,img){
      this.startX=parseInt(e.clientX-this.offsetX);
      this.startY=parseInt(e.clientY-this.offsetY);
      // clear the drag flag
      this.isDragging=false;
      this.drawImage(e,img);
    },

    handleMouseOut: function(e,img){
      this.handleMouseUp(e,img);
    },

    handleMouseMove: function(e,img){
      // only compute new positions if in drag
      if(this.isDragging){

        this.canMouseX=parseInt(e.clientX - this.offsetX);
        this.canMouseY=parseInt(e.clientY - this.offsetY);
      // move the image by the amount of the latest drag
        var dx = this.canMouseX - this.startX;
        var dy = this.canMouseY - this.startY;

        this.imageX += dx;
        this.imageY += dy;
        // Negative image locations break the pattern in this.fillPattern
        this.imageY = Math.max(0, this.imageY);
        this.imageX = Math.max(0, this.imageX);

        // reset the startXY for next time
        this.startX = this.canMouseX;
        this.startY = this.canMouseY;

        this.drawImage(e,img);
      } 
```

# ruby-on-rails - 将附加参数传递给设计 new_user_session_path

> ID：15036388
> 
> 赞同：2
> 
> 时间：2013-02-23T02:37:21.677
> 
> 标签：ruby-on-rails, devise, twitter, omniauth

我正在尝试为多个提供商实施设计和 Ominauth。一种情况是：用户首次使用 Twitter 登录，而无需先创建帐户。

为了处理这个问题，我将用户从回调链接 ( `/auth/twitter/callback`) 重定向到注册页面以填写电子邮件地址。

但是，我想将回调链接中的身份验证信息`{:provider => "twitter", :uid =>"123"}`带到注册页面 ( `new_registration_path`)。然后当用户提交注册表单时，身份验证将与帐户信息一起被捕获。

我该怎么做呢？我试过了

```
redirect_to(new_user_session_path, {:service => service}) 
```

`service = {:provider => "twitter", :uid =>"123"}` 但是服务没有作为参数传递。

我做错了什么？我需要修改 Devise 的源代码吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T06:17:32.473

你可能正在寻找这个：

```
redirect_to(new_user_session_path(:argument => "value")) 
```

在重定向后的控制器中（可能是 UserSessions#new），您可以使用以下命令访问参数：

```
params[:argument] 
```

您需要将参数传递给路径助手而不是 redirect_to 方法。

在您的示例中，它应该是：

```
redirect_to(new_user_session_path(service)) 
```

在重定向后的控制器中（可能是 UserSessions#new），您可以使用以下命令访问参数：

```
params[:provider]
params[:uid] 
```

或者

```
redirect_to(new_user_session_path(:service => service)) 
```

和

```
params[:service][:provider]
params[:service][:uid] 
```

# linux - Linux 目录有空格？

> ID：15036391
> 
> 赞同：0
> 
> 时间：2013-02-23T02:37:52.763
> 
> 标签：linux

我正在尝试为课程运行一些东西。

```
-bash-4.1$ w330=/network_shares/w_drive/c\ s/CJohnson/cs330
-bash-4.1$ cd .. && $w330/freql/test_freql
-bash: /network_shares/w_drive/c: No such file or directory 
```

从它的外观来看，即使我为空间做了一个 \，它似乎也没有识别 c 之后的任何目录名称？这里发生了什么？为什么它只是在 c 之后停止？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:39:52.283

改用这个：`w330="/network_shares/w_drive/c s/CJohnson/cs330"`

和这个：`"$w330/freql/test_freql"`

# c++ - 从向量中检索两个最高值

> ID：15036392
> 
> 赞同：0
> 
> 时间：2013-02-23T02:38:07.653
> 
> 标签：c++, opencv

我已经声明了一个向量，它存储给定帧中所有边界框的区域。然后我使用从头到尾迭代的这个向量来检索值。然后我按升序（最低 -> 最高）对这些值进行排序。

这是我使用的代码：

```
 double area = contourArea(boundingBoxArea);
    list_area.push_back(area);
    sort(list_area.begin(), list_area.end());
    vector<double>::const_iterator area_iter;

    int i = 0;
    for(area_iter = list_area.begin(); area_iter != list_area.end(); area_iter++)
    {
        i++;
        cout<<"Iterator " <<i<< " size is : " <<*area_iter<<endl;
    } 
```

我的问题是，我只对一组数字中的最后两个值（2 个最高值）感兴趣，但我无法真正理解它应该如何实现我的目标。

这里的任何人对我的问题有建议或解决方案......？

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:50:16.327

遍历列表，每次将新值与旧的最高值进行比较。如果新值更高，则将其存储为最高值，并有第二个变量保持先前的最高值。

像这样的东西..可能在语法上不正确，但它是：-

```
 int iCurrentHighest = 0;
    int previousHighest = 0;
    for(area_iter = list_area.begin(); area_iter != list_area.end(); area_iter++)
        {
            if(*area_iter>iCurrentHighest)
            {
              previousHighest  = iCurrentHighest;
              iCurrentHighest = *area_iter;

            }
        else
            {
            if ((*area_iter<iCurrentHighest) && (*area_iter>previousHighest))
                {
                  previousHighest = *area_iter;
                }  
            }

        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T02:56:46.967

你需要的是[std::nth_element](http://en.cppreference.com/w/cpp/algorithm/nth_element)

```
 double area = contourArea(boundingBoxArea);
    list_area.push_back(area);
    std::nth_element(list_area.begin(), list_area.begin() + 2, list_area.end(), std::greater<double>());
    // first 2 elements in list_area are now 2 greatest
    vector<double>::const_iterator area_iter;

    int i = 0;
    for(area_iter = list_area.begin(); area_iter != list_area.end(); area_iter++)
    {
        i++;
        cout<<"Iterator " <<i<< " size is : " <<*area_iter<<endl;
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T04:03:39.703

这是上面@Rich 提供的算法的不同版本，比较略少（而不是用最大的然后是第二大的值来测试每个值，通过颠倒顺序可以减少预期的比较次数：如果数字更小比第二大它只比较一次）。

```
int first = 0;
int second = 0;
for (auto const & v : list) {
   if (v > second) {
      second = v;
      if (second > first)
         std::swap(first,second);
   }
} 
```

如果没有*已知*值小于所有其他值，则可以使用向量中的前两个值（按顺序）初始化`first`和值。`second`

# wso2 - 用于实时语义应用的 WSO2

> ID：15036393
> 
> 赞同：0
> 
> 时间：2013-02-23T02:38:32.817
> 
> 标签：wso2

我想知道，是否可以使用 WSO2 构建应用程序。问题是我需要从不同的设备接收传感器数据。使用 OWL 实时处理这些数据并在语义上存储有意义的信息。我对开发这种应用程序需要考虑的 WOS2 产品类型有点困惑。将来我需要随着设备的增加来扩展这个系统。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T17:38:26.807

您可以查看 WSO2 复杂事件处理器 (CEP) 以了解实时事件处理要求。请仔细阅读文档以获得一个想法。 [http://docs.wso2.org/wiki/display/CEP210](http://docs.wso2.org/wiki/display/CEP210)

谢谢，迪丽热巴

# javascript - 如何更正此 JavaScript 添加功能？

> ID：15036394
> 
> 赞同：0
> 
> 时间：2013-02-23T02:38:35.333
> 
> 标签：javascript, input, add, validation

我有一个需要六个输入的表格（还有更多但现在只有这些重要）

**原价**

**原税**

**新票价**

**新税**

**费用**

客人人数

1.  当按下“计算”时，我使用 javascript**添加原始票价和原始税金**以获得**原始总数**

2.  然后我**添加新票价和新税**来获得**新的总数**

3.  现在我**将原始总数与新总数进行比较**

4.  **如果原始总数大于新总数**，则应该使用一种方法来完成我需要的数学运算并将结果设置为显示

我最初使用这些值测试所有内容：

原票价=1000原税=200

新票价 = 800 新税 = 200

费用 = 150 客人人数 = 3

可以在这里看到[https://pnrbuilder.com/_popups/exchangeMyPNR_MATH_TEST_2.php](https://pnrbuilder.com/_popups/exchangeMyPNR_MATH_TEST_2.php) **（页面仅适用于 chrome）** 上面的工作完全符合预期，但是当我将值更改为：

原票价 = 949.83 原税 = 321.18

新票价 = 453.91 新税费 = 143.91

费用 = 150 客人人数 = 3

在这里看到[https://pnrbuilder.com/_popups/exchangeMyPNR_MATH_TEST.php](https://pnrbuilder.com/_popups/exchangeMyPNR_MATH_TEST.php) **（页面仅适用于 chrome）** 此测试使用错误的 if 语句来完成其余的数学运算

我不明白为什么会发生这种情况，因为原始总数仍然 > 新总数，因此它应该使用与第一个示例相同的方法。我发出警报，让我确切知道使用哪个 if 语句进行数学运算，显然这里使用了错误的语句，但我不知道为什么。

我知道这很复杂，但有人可以帮我弄清楚我的逻辑哪里出了问题吗？

* * *

**这是完整的功能：**

```
function addMe(frm) {
    var orBase = Number(frm.box1.value);
    var orTax = Number(frm.box2.value);
    var nwBase = Number(frm.box3.value);
    var nwTax = Number(frm.box4.value);
    var fee = Number(frm.fee.value);
    var gsts = Number(frm.guests.value);

    var fltrd_orBase = orBase * 100;
    var fltrd_orTax = orTax * 100;
    var fltrd_orTtl = fltrd_orBase + fltrd_orTax;
    var orTtl = fltrd_orTtl / 100;
    var final_orTtl = orTtl.toFixed(2)
    frm.result.value = orTtl.toFixed(2)

    var fltrd_nwBase = nwBase * 100;
    var fltrd_nwTax = nwTax * 100;
    var fltrd_nwTtl = fltrd_nwBase + fltrd_nwTax;
    var nwTtl = fltrd_nwTtl / 100;
    var final_nwTtl = nwTtl.toFixed(2)
    frm.result2.value = nwTtl.toFixed(2)

    var e = document.getElementById("residual");
    var selectVal = e.options[e.selectedIndex].value;

    if (final_orTtl <= final_nwTtl) {

        document.getElementById("forfeitTable").style.display="none";
        document.getElementById("MCOtable").style.display="none";       

        var undiff = final_nwTtl - final_orTtl;
        var diff =undiff
        document.getElementById("differenceDisplay").innerHTML=diff.toFixed(2);
        frm.difference.value = diff.toFixed(2);

        var ppCost = diff + fee;
        frm.pptotal.value = ppCost.toFixed(2);
        document.getElementById("ppDisplay").innerHTML=ppCost.toFixed(2);

        var ttlCost = ppCost * gsts;
        frm.totalcost.value = ttlCost.toFixed(2);
        document.getElementById("grandTotalDisplay").innerHTML=ttlCost.toFixed(2);              

        // this is just for testing to show which method was actually used
        if (orBase != "" && orTax != "" && nwBase != "" && nwTax != "" && fee != "" && gsts != "") {
                    // this is in its own if statement so it doesnt popuop while entering data
                    alert('if 1 was used');
                }       

    }

    else if (final_orTtl > final_nwTtl) {

          if (selectVal == "residualX" || selectVal == "residualN") {

              document.getElementById("MCOtable").style.display="none";
              var diff = final_orTtl - final_nwTtl;

              var displayDiff = diff* -1;
              document.getElementById("differenceDisplay").innerHTML= displayDiff.toFixed(2);
              frm.difference.value = displayDiff.toFixed(2);

              document.getElementById("forfeitInfo").innerHTML = "Beyond the cost above";
              frm.lost.value = diff.toFixed(2);
              document.getElementById("ppForfeitedDisplay").innerHTML = diff.toFixed(2);

              var ttlfForfeited = diff * gsts;
              frm.lostTTL.value = ttlfForfeited.toFixed(2);
              document.getElementById("totalForfeitedDisplay").innerHTML=ttlfForfeited.toFixed(2);

              var ppCost = fee;
              frm.pptotal.value = ppCost.toFixed(2);
              document.getElementById("ppDisplay").innerHTML=ppCost;

              var ttlCost = fee * gsts;
              frm.totalcost.value = ttlCost.toFixed(2);
              document.getElementById("grandTotalDisplay").innerHTML=ttlCost;

                if (orBase != "" && orTax != "" && nwBase != "" && nwTax != "" && fee != "" && gsts != "") {
                    document.getElementById("forfeitTable").style.display="table";
                }
                // this is just for testing to show which method was actually used 
                if (orBase != "" && orTax != "" && nwBase != "" && nwTax != "" && fee != "" && gsts != "") {
                    // this is in its own if statement so it doesnt popuop while entering data
                    alert('if 2.1 was used');
                }
          }

          // this is the method that should be used below
          else if (selectVal == "residualA" ) {

              document.getElementById("MCOtable").style.display="none";
              var diff = final_orTtl - final_nwTtl;

              var displayDiff = diff* -1;
              document.getElementById("differenceDisplay").innerHTML= displayDiff.toFixed(2);
              frm.difference.value = diff.toFixed(2);

               if ( diff > fee) {

                    var residual =  diff - fee ;

                    document.getElementById("forfeitInfo").innerHTML = "No additional cost. However,";
                    frm.lost.value = residual.toFixed(2);
                    document.getElementById("ppForfeitedDisplay").innerHTML = residual.toFixed(2);

                    var ttlfForfeited = residual * gsts;
                    frm.lostTTL.value = ttlfForfeited.toFixed(2);
                    document.getElementById("totalForfeitedDisplay").innerHTML=ttlfForfeited.toFixed(2);

                    //document.getElementById("differenceDisplay").innerHTML=0;
                    frm.difference.value = diff;

                    document.getElementById("ppDisplay").innerHTML=0;
                    document.getElementById("grandTotalDisplay").innerHTML=0;

                       if (orBase != "" && orTax != "" && nwBase != "" && nwTax != "" && fee != "" && gsts != "") {
                          document.getElementById("forfeitTable").style.display="table";
                      }
                      // this is just for testing to show which method was actually used 
                      if (orBase != "" && orTax != "" && nwBase != "" && nwTax != "" && fee != "" && gsts != "") {
                        // this is in its own if statement so it doesnt popuop while entering data
                        alert('if 2.2 was used');
                      }

                }
              else  {

                    var remBal =  fee - diff ;

                    var ttlcost = remBal * gsts;
                    frm.totalcost.value = ttlcost.toFixed(2);

                    document.getElementById("ppDisplay").innerHTML=remBal.toFixed(2);
                    document.getElementById("grandTotalDisplay").innerHTML=ttlcost.toFixed(2);

                    document.getElementById("forfeitTable").style.display="none";

                      // this is just for testing to show which method was actually used 
                      if (orBase != "" && orTax != "" && nwBase != "" && nwTax != "" && fee != "" && gsts != "") {
                        // this is in its own if statement so it doesnt popuop while entering data
                        alert('if 2.3 was used');
                      }                  
                 }
          }
          else if (selectVal == "residualM" ) {

              var diff = final_orTtl - final_nwTtl;
              var displayDiff = diff* -1;
              document.getElementById("differenceDisplay").innerHTML= displayDiff.toFixed(2);
              frm.difference.value = displayDiff.toFixed(2);

              if (diff > fee) {   

                  var mco =  diff - fee ;
                  document.getElementById("MCOInfo").innerHTML=mco.toFixed(2);
                  frm.MCOamt.value = mco.toFixed(2);
                  //document.getElementById("differenceDisplay").innerHTML=diff;
                  //frm.difference.value = diff* -1;

                  frm.totalcost.value = 0;

                  document.getElementById("ppDisplay").innerHTML=0;
                  document.getElementById("grandTotalDisplay").innerHTML=0;

                     if (orBase != "" && orTax != "" && nwBase != "" && nwTax != "" && fee != "" && gsts != "") {
                              document.getElementById("forfeitTable").style.display="none";
                              document.getElementById("MCOtable").style.display="table";
                          }

                                  // this is just for testing to show which method was actually used 
                      if (orBase != "" && orTax != "" && nwBase != "" && nwTax != "" && fee != "" && gsts != "") {
                        // this is in its own if statement so it doesnt popuop while entering data
                        alert('if 2.4 was used');
                      }
              }
              else {   

                  var remBal =  fee - diff ;

                    var ttlcost = remBal * gsts;
                    frm.totalcost.value = ttlcost.toFixed(2);

                    document.getElementById("ppDisplay").innerHTML=remBal.toFixed(2);
                    document.getElementById("grandTotalDisplay").innerHTML=ttlcost.toFixed(2);

                    document.getElementById("forfeitTable").style.display="none";
                    document.getElementById("MCOtable").style.display="none";
                                          // this is just for testing to show which method was actually used 
                      if (orBase != "" && orTax != "" && nwBase != "" && nwTax != "" && fee != "" && gsts != "") {
                        // this is in its own if statement so it doesnt popuop while entering data
                        alert('if 2.5 was used');
                      }
              }

          }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T03:49:23.343

```
var nwTtl = fltrd_nwTtl / 100;
var final_orTtl = orTtl.toFixed(2)

var orTtl = fltrd_orTtl / 100;
var final_orTtl = orTtl.toFixed(2)

if (final_orTtl > final_nwTtl )  {

} 
```

这部分似乎是我的问题。出于某种原因，我在这里所做的 if 比较似乎不喜欢`'.toFixed(2)'` 我在上面所做的比较。我将其更改为：

```
var nwTtl = fltrd_nwTtl / 100;
var orTtl = fltrd_orTtl / 100;

if (orTtl > nwTtl )  {

} 
```

我仍在测试所有其他功能，但到目前为止这似乎按预期工作。我仍然很想知道为什么我的使用`'.toFixed(2)'`会导致两个明显高于或低于的数字被评估为相反的结果。并将接受对此问题该部分的任何答案

# facebook - Facebook个人资料照片，如何使用javascript使其成为实际大小

> ID：15036397
> 
> 赞同：0
> 
> 时间：2013-02-23T02:38:51.233
> 
> 标签：facebook

所以我想制作一张 Facebook 个人资料照片的实际尺寸：

[https://sphotos-b.xx.fbcdn.net/hphotos-snc6/179672_10151462004583896_870987263_n.jpg](https://sphotos-b.xx.fbcdn.net/hphotos-snc6/179672_10151462004583896_870987263_n.jpg) 这是照片。

我知道您可以在某处插入 java 脚本以实现这种方式，但我不知道 javascript 是什么，也不知道将它放在 facebook 的哪个位置。

帮助

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T02:43:31.307

你的意思是在你的网页上？

```
var Img = document.getElementById('ImgId');
if(Img && Img.style) {
Img.style.height = '200px';
Img.style.width = '100px';
} 
```

如果您只想调整大小，可以使用绘画、photoshop 或在线服务，如 picresize 和 cutmypic！

# c++ - 1 [main] 972 exception::handle: Exception: STATUS_ACCESS_VIOLATION 解释以及如何修复

> ID：15036399
> 
> 赞同：0
> 
> 时间：2013-02-23T02:39:07.467
> 
> 标签：c++, function, object, pointers

尽可能简单地询问任何人都可以解释为什么这个代码：

```
LinkedListByGrade::LinkedListByGrade(vector<Node> myNodes) {
int lowestGradeFound = myNodes[0].getGrade();
Node *pFristNode = new Node();
cout << "New node created" << endl;
for (size_t i = 0; i <= myNodes.size(); i++) {
    if (myNodes[i].getGrade() < lowestGradeFound) {

        cout << "if triggered" << endl;
        lowestGradeFound = myNodes[i].getGrade();
        pFristNode->reassasignNode(myNodes[i].getFristName(),
                myNodes[i].getLastName(), myNodes[i].getId(),
                myNodes[i].getGrade());
        cout << "int reassassigned" << endl;
    } 
```

给我这个错误：

```
1 [main] Project 972 exception::handle: Exception: STATUS_ACCESS_VIOLATION 
2130 [main] Project 972 open_stackdumpfile: Dumping stack trace to Project.exe.stackdump 
```

以及如何解决它的想法？

（对不起，我留在了诊断打印语句中。）

这也是影响 myNodes 的唯一代码：

```
vector<Node> Students;
Node node1("Bobby", "zilch",28,55);
Node node2("Evil", "Dentist",308,55);
Node node3("Raz", "Buton",10,55);
Students.push_back(node1);
Students.push_back(node2);
Students.push_back(node3);

cout<<"stuff"<<endl;
 LinkedListByGrade myList = LinkedListByGrade(Students); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T03:06:16.130

我不能肯定地说，但是您正在访问未分配给您的内存，因此很可能您正在运行`myNodes`. **您**将能够*通过使用调试器*来确定这一点。

我可以肯定地说，在您调用的函数的第一行中：

```
int lowestGradeFound = myNodes[0].getGrade(); 
```

如果 中没有项目`myNodes`，那么这应该会导致访问冲突。

而且您肯定会`myNodes`在`for`-loop 的末尾运行，因为您正在访问`myNodes[myNodes.size()]`.

尝试这样的事情：

```
LinkedListByGrade::LinkedListByGrade(vector<Node> const& myNodes) {
    // Pass by const-reference! ------------------^

    // Set this to something high. Don't access the vector, in case there are no
    // elements therein:
    int lowestGradeFound = std::numeric_limits<int>::max();

    // Where is this deleted?
    Node *pFirstNode = new Node();

    // Use iterators, not indices for looping over a container...
    for (vector<Node>::iterator i = myNodes.begin(), end = myNodes.end(); != end; ++i)
    {
        // Access element by `i->`
        if (i->getGrade() < lowestGradeFound)
        {
            // Now you can assign this safely...
            lowestGradeFound = i->getGrade();
            pFirstNode->reassasignNode(
                i->getFirstName(),
                i->getLastName(),
                i->getId(),
                i->getGrade());
        }
    }

    // [...]
} 
```

但是你真的，*真的*需要学习使用你的调试器！

# c - typedef 以前的名称的目的是什么？

> ID：15036407
> 
> 赞同：0
> 
> 时间：2013-02-23T02:40:09.277
> 
> 标签：c, typedef

如：

```
typedef struct _cairo_clip cairo_clip_t; 
```

为什么不直接使用`_cairo_clip`？在一些代码中看到许多类似的定义。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T02:43:42.377

背后的想法`typedef`是让您跳过`struct`关键字。与 C++ 不同，C 不允许您这样做：

```
struct _cairo_clip {
    int a;
    float b;
};
_cairo_clip cc;        // Not allowed
struct _cairo_clip cc; // Allowed, but requires a keyword 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T02:45:00.520

如果您尝试直接使用`_cairo_clip`，则需要调用它`struct _cairo_clip`。

`struct _cairo_clip`比 更详细`cairo_clip_t`。

使用 typedef 还提供了一些抽象，因为这意味着它`cairo_clip_t`可以实现为内置类型或实现为 a `struct`，而不会导致客户端代码的语法发生变化。

# c# - 检索 XmlNode SelectSingleNode 父节点

> ID：15036412
> 
> 赞同：1
> 
> 时间：2013-02-23T02:40:39.377
> 
> 标签：c#, xml

堆栈溢出帮助了我很多，并决定自己加入并提出问题。

我正在尝试执行的过程基本上是从 XML 文档中选择一个节点并删除用户选择的整个节点。

现在来一些代码！

```
int index = index = list_serverlist.SelectedIndex;
string selectedItem = list_serverlist.Items[index].ToString();

XmlNode selectedNode = doc.SelectSingleNode("/ServerList/Server/ServerName[text()='" + selectedItem + "']");

selectedNode.ParentNode.RemoveAll();
doc.Save(filePath); 
```

还有我正在使用的 XML 文件

```
<?xml version="1.0"?>
<ServerList>
  <Server>
    <ServerName>FAB13-HST01</ServerName>
    <ServerIP>wasd</ServerIP>
    <ServerUsername>..\Administrator</ServerUsername>
    <ServerPassword>wasd</ServerPassword>
  </Server>
  <Server>
    <ServerName>FAB13-HST02</ServerName>
    <ServerIP>wasd</ServerIP>
    <ServerUsername>..\Administrator</ServerUsername>
    <ServerPassword>wasd</ServerPassword>
  </Server>
  <Server>
    <ServerName>FAB13-HST03</ServerName>
    <ServerIP>wasd</ServerIP>
    <ServerUsername>..\Administrator</ServerUsername>
    <ServerPassword>wasd</ServerPassword>
  </Server>
</ServerList> 
```

现在我看到代码发生的方式是......

基本上，我得到了用户从 ListBox 中选择的内容，使其成为一个字符串，然后选择在 ServerName 字段中具有该节点的单个节点。调试时似乎工作正常。

但是当我使用命令时

```
selectedNode.ParentNode.RemoveAll(); 
```

它删除节点的所有子节点，不包括父节点。当我调试它并尝试获取 Parent 时，它似乎出于某种奇怪的原因返回 null 并且无法弄清楚原因。

XML新手，所以不确定我做错了什么......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T06:50:32.497

如果在调用 RemoveAll() 后尝试获取父节点，则所选节点不再存在。

要删除整个服务器元素，您可以使用类似的东西。

```
 XmlNode nodeParent = selectedNode.ParentNode;
    nodeParent.ParentNode.RemoveChild(nodeParent); 
```

# php - 为什么 Google Apps 电子邮件地址无法从 Magento 网站接收电子邮件？

> ID：15036413
> 
> 赞同：1
> 
> 时间：2013-02-23T02:40:39.430
> 
> 标签：php, zend-framework, magento, google-apps

好的，我一直在使用这个 Magento 1.7.0.2 网站：

[http://www.kharmakhare.com](http://www.kharmakhare.com)

目前网站上有两种表格。如果我将任一表格更改为任何 kharmakhare.com 电子邮件地址，则永远不会收到该电子邮件。如果我将任一表格更改为我的电子邮件地址，我就会收到电子邮件。

是的，我已经检查过垃圾邮件。Kharma Khare 电子邮件地址不会收到来自 Magento 的电子邮件。我认为这与未正确安装 Google Apps 有关……除非我登录电子邮件，那里已经有大量电子邮件。

他们在接收电子邮件时没有任何问题，他们只是没有收到来自网站的任何电子邮件。我在网上搜索了答案。我所能找到的只是通过 Google Apps 发送电子邮件而不接收它们的问题。

我的客户也已经设置了 SPF 记录。此外，上次我在 Google Apps 中（至少是一年前）看起来完全不同，所以我不知道任何东西在哪里了。

第一个表格在联系页面上（这使用 Magento 的默认联系模块）：

[http://www.kharmakhare.com/contact-us](http://www.kharmakhare.com/contact-us)

另一个是通过单击屏幕右上角的“免费样品”选项卡打开的。在花了几天时间研究这个问题之后，我终于弄清楚了如何在 wordpress 中完成 10 分钟的工作；创建备用电子邮件表单。-_-

无论如何，尽管我知道这两种形式都有效，但它们都不会发送到它实际需要发送到的电子邮件地址，这让我发疯了。有谁知道可能导致此问题的原因是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T09:01:29.873

关闭该域的邮件服务器。

他们没有收到电子邮件而您收到的原因是发送地址是`something@kharmakhare.com`，而接收地址是`somethingelse@kharmakhare.com`。在此实例中不使用将电子邮件卸载到 Google Apps 的 MX 记录，因为服务器将首先查找本地邮件服务器。

# ios - 使用 MonoTouch 检索 iOS 设备的设备序列号的最简单方法是什么？

> ID：15036415
> 
> 赞同：3
> 
> 时间：2013-02-23T02:41:33.633
> 
> 标签：ios, xamarin.ios, serial-number

MonoTouch 是否有一个简单的机制来检索 iOS 设备的设备序列号（不是 UDID）？我可以使用第三方库来获取它吗？

万一这很重要，我希望在内部应用程序中使用此功能，并且不关心 App Store 的审批流程。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-05T12:57:33.013

**更新：从 iOS 8 开始，我们无法检索我们的 iDevice 的序列号。**

要从 Monotouch 检索 iphone 序列号，您可以使用以下技术：

1.  从 XCode 创建一个静态库 .a，它具有获取序列号的功能
2.  在 MonoDevelop 中，创建一个绑定项目，将您的 .a 库绑定到 C# 类/函数（[http://docs.xamarin.com/guides/ios/advanced_topics/binding_objective-c_libraries](http://docs.xamarin.com/guides/ios/advanced_topics/binding_objective-c_libraries)）
3.  在您的应用程序中，您调用此绑定库（在步骤 2 中）。

* * *

详情：

步骤 1\. 在我的 library.a 中，我有一个类 DeviceInfo，这是获取序列号的实现

```
#import "DeviceInfo.h"

#import <dlfcn.h>
#import <mach/port.h>
#import <mach/kern_return.h>
@implementation DeviceInfo

- (NSString *) serialNumber
{
    NSString *serialNumber = nil;

    void *IOKit = dlopen("/System/Library/Frameworks/IOKit.framework/IOKit", RTLD_NOW);
    if (IOKit)
    {
        mach_port_t *kIOMasterPortDefault = dlsym(IOKit, "kIOMasterPortDefault");
        CFMutableDictionaryRef (*IOServiceMatching)(const char *name) = dlsym(IOKit, "IOServiceMatching");
        mach_port_t (*IOServiceGetMatchingService)(mach_port_t masterPort, CFDictionaryRef matching) = dlsym(IOKit, "IOServiceGetMatchingService");
        CFTypeRef (*IORegistryEntryCreateCFProperty)(mach_port_t entry, CFStringRef key, CFAllocatorRef allocator, uint32_t options) = dlsym(IOKit, "IORegistryEntryCreateCFProperty");
        kern_return_t (*IOObjectRelease)(mach_port_t object) = dlsym(IOKit, "IOObjectRelease");

        if (kIOMasterPortDefault && IOServiceGetMatchingService && IORegistryEntryCreateCFProperty && IOObjectRelease)
        {
            mach_port_t platformExpertDevice = IOServiceGetMatchingService(*kIOMasterPortDefault, IOServiceMatching("IOPlatformExpertDevice"));
            if (platformExpertDevice)
            {
                CFTypeRef platformSerialNumber = IORegistryEntryCreateCFProperty(platformExpertDevice, CFSTR("IOPlatformSerialNumber"), kCFAllocatorDefault, 0);
                if (CFGetTypeID(platformSerialNumber) == CFStringGetTypeID())
                {
                    serialNumber = [NSString stringWithString:(__bridge NSString*)platformSerialNumber];
                    CFRelease(platformSerialNumber);
                }
                IOObjectRelease(platformExpertDevice);
            }
        }
        dlclose(IOKit);
    }

    return serialNumber;
}

@end 
```

第 2 步。在 Monotouch 中我的 Binding Library 项目的 ApiDefinition.cs 中，我添加了这个绑定：

```
[BaseType (typeof (NSObject))]
    public interface DeviceInfo {
        [Export ("serialNumber")]
        NSString GetSerialNumber ();
    } 
```

STEP 3\. 在我的应用程序中，我在步骤 2 中导入对绑定库项目的引用，然后添加

使用 MyBindingProject；

...

```
string serialNumber = "";
            try {
                DeviceInfo nativeDeviceInfo = new DeviceInfo ();
                NSString temp = nativeDeviceInfo.GetSerialNumber();
                serialNumber = temp.ToString();
            } catch (Exception ex) {
                Console.WriteLine("Cannot get serial number {0} - {1}",ex.Message, ex.StackTrace);
            } 
```

希望有帮助。如果您有任何问题，请不要犹豫。

# android - VP8 在 android 上编码/解码产生带有红色、绿色和蓝色方块的黑白图像

> ID：15036417
> 
> 赞同：3
> 
> 时间：2013-02-23T02:41:50.227
> 
> 标签：android, video, voip, vp8

我有一个 VoIP 视频应用程序，它使用 VP8 编解码器在 MAC、Windows 和 iOS 上运行良好。当我在这些平台和 Android 之间拨打电话时，通话双方都有一个带有红色、绿色和蓝色方块的黑白图像。当 Android 调用 Android 时也会发生同样的情况。

我正在编译 VP8：

```
./libvpx/configure --target=armv7-android-gcc --sdk-path=/Applications/adt/ndk --disable-examples --enable-runtime-cpu-detect  --enable-realtime-only --enable-neon 
```

我的问题是为什么 Android 平台会产生这个结果，我该如何调试它？

这是问题的屏幕截图：

![](../Images/0b9d0382e4fc31c973c53779442028e3.png)

附加信息：

相机帧格式为 ImageFormat.NV21。编码器图像格式为 VPX_IMG_FMT_I420。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T19:49:59.137

因为 libvpx 配置为采用图像格式 VPX_IMG_FMT_I420，所以必须首先将 NV21 帧转换为 I420。

# regex - 快速正则表达式 Perl 未终止

> ID：15036418
> 
> 赞同：3
> 
> 时间：2013-02-23T02:41:54.303
> 
> 标签：regex, perl

我正在尝试将 Wiki 标记转换为 HTML 标记，即

```
[[Image:wiki.png]]
[[Image:wiki.png|Wikipedia, The Free Encyclopedia.]] 
```

至

```
<img src="wiki.png" alt=""/>
<img src="wiki.png" alt="Wikipedia, The Free Encyclopedia."/> 
```

使用一行 Perl

```
s/\[\[Image:(\w+?\.png)\|{0,1}(.*?)\]\]/g;
print; 
```

但是 Perl 不断抛出错误

> 换人未终止

它在[这个 RegExr 测试](http://regexr.com/33sk4)中有效，并且更改分隔符并没有解决问题。任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T02:52:57.087

Perl 告诉您替换替换没有终止，而不是“替换/替换没有终止”。

替换运算符`s`包含三个部分：`s/PATTERN/REPLACEMENT/FLAGS`.

你的代码有`s/PATTERN/g`.

也就是说，您有一个 REPLACEMENT 由`g`但没有 terminating组成`/`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-23T02:54:34.440

您有一个没有替换字符串的正则表达式替换。它应该看起来像

```
s/PATTERN/REPLACEMENT/ 
```

而你只有

```
s/PATTERN/ 
```

所以 Perl 告诉你替换没有终止。

这个程序使用你的正则表达式来做你想做的事

```
use strict;
use warnings;

for (<DATA>) {
  s/\[\[Image:(\w+?\.png)\|{0,1}(.*?)\]\]/<img src="$1" alt="$2"\/>/g;
  print;
}

__DATA__
[[Image:wiki.png]]
[[Image:wiki.png|Wikipedia, The Free Encyclopedia.]] 
```

**输出**

```
<img src="wiki.png" alt=""/>
<img src="wiki.png" alt="Wikipedia, The Free Encyclopedia."/> 
```

# javascript - 在没有 AJAX 的情况下调整大小和上传文件

> ID：15036419
> 
> 赞同：0
> 
> 时间：2013-02-23T02:42:00.027
> 
> 标签：javascript, jquery, canvas, upload

# 编辑

似乎这很可能是不可能的，因为画布和文件输入不是兼容的数据类型。

执行类似操作的方法是使用“数据 url”发送 AJAX 请求。我将对此进行更详细的研究。因为我不想使用 AJAX，所以我会尝试将工作流程伪装成更像一个普通的提交，即最后刷新。

# 结束编辑

我想在没有 AJAX 的情况下调整文件大小并上传文件，因为这是目前的工作方式（没有调整大小的图像 - 取自手机/平板电脑），并且在工作流程方面效果很好。

因此，在调整大小之后，如果可能的话，我希望能够使调整大小的“图像”成为字段的值。

我正在使用这个库[http://gokercebeci.com/dev/canvasresize](http://gokercebeci.com/dev/canvasresize)为我调整大小。

我尝试将`data`回调中的变量设置为 file1 输入的值，即

```
$("#file1").val(data); 
```

但这引发了错误。我已经在下面的代码中删除了它，因为我很确定这不是解决方法。

我已经复制了下面的整个 HTML/JS 文件（“图片上传”内容是使用 AJAX 上传图片的示例，我已将其注释掉，因为我不想这样做）。

```
<!DOCTYPE html>
<html>
<head>
    <title>Resize and Upload Images</title>
    <script type="text/javascript" src="/public/javascripts/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="/public/javascripts/zepto.min.js"></script>
    <script type="text/javascript" src="/public/javascripts/jquery.exif.js"></script>
    <script type="text/javascript" src="/public/javascripts/jquery.canvasResize.js"></script>
    <script type="text/javascript" src="/public/javascripts/binaryajax.js"></script>
    <script type="text/javascript" src="/public/javascripts/canvasResize.js"></script>
    <script type="text/javascript" src="/public/javascripts/exif.js"></script>

</head>
<body style="margin:48px;">
<div id="devcontainer">
    <div id="area">
        <h3>canvasResize</h3>
        <div>
            <form action="/upload" enctype="multipart/form-data" method="POST">
            <input name="file1" type="file" id="file1"/>
            <input name="file1" type="file"/>
            <input name="data1" type="text"/>
            <input name="data2" type="text"/>
            </form>
            <p><span></span></p>
            <i></i>
        </div>
        <script>
        $().ready(function() {

            $('input[name=file1]').change(function(e) {
            var file = e.target.files[0];

            // RESET
            $('#area p span').css('width', 0 + "%").html('');
            $('#area img, #area canvas').remove();
            $('#area i').html(JSON.stringify(e.target.files[0]).replace(/,/g, ", <br/>"));

            // CANVAS RESIZING
            canvasResize(file, {
                width: 600,
                height: 0,
                crop: false,
                quality: 80,
                callback: function(data, width, height) {

                // SHOW AS AN IMAGE
                // =================================================
                var img = new Image();
                img.onload = function() {

                $(this).css({
                    'margin': '10px auto',
                    'width': width,
                    'height': height
                }).appendTo('#area div');
            };

            // /SHOW AS AN IMAGE
            // =================================================
            $(img).attr('src', data);

                }
            });
            });

        });
        </script>
    </div>
    <div class="clearfix"></div>
</div>
</body>
</html>
<!--
   // IMAGE UPLOADING
                // =================================================

                // Create a new formdata
                var fd = new FormData();
                // Add file data
                var f = canvasResize('dataURLtoBlob', data);
                f.name = file.name;
                fd.append($('#area input').attr('name'), f);

                var xhr = new XMLHttpRequest();
                var loaded = Math.ceil((e.loaded / e.total) * 100);
                $('#area p span').css({'width': loaded + "%"}).html(loaded + "%");
                }
                }, false);
                // File uploaded
                xhr.addEventListener("load", function(e)
                {
                var response = JSON.parse(e.target.responseText);
                if (response.filename)
                {
                    // Complete
                    $('#area p span').html('done');
                    $('#area b').html(response.filename);
                    $('<img>').attr({
                    'src': response.filename
                    }).appendTo($('#area div'));
                }
                }, false);
                // Send data
                xhr.send(fd);

                }

--> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T04:01:20.250

在主窗口中创建回调函数。将 iFrame 添加到将处理文件上传的页面。上传文件后，使用文件名调用回调函数。将文件添加到画布。

# php - 获取每秒 'td' 元素的文本内容，在 'tr' 元素内

> ID：15036420
> 
> 赞同：0
> 
> 时间：2013-02-23T02:42:00.397
> 
> 标签：php, dom

我`loadHTMLFile`用来从 HTML 页面获取表格的 td 内容，它运行良好，

```
define('GLPI_ROOT', '..');
$dom = new DOMDocument();
$dom->loadHTMLFile(GLPI_ROOT . "/front/yourpage.html");
$tables = $dom->getElementsByTagName('table');
$table = $tables->item(9);
$ana = $table->getElementsByTagName('td');

foreach ($ana as $td) {
  if ($td->nodeName == 'td') {

    echo $td->nodeValue,"<br/>";

  }
} 
```

但我真正想要的只是获取`td`每个`tr`元素的第二个元素`table`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T03:03:40.560

你可以尝试这样的事情：

```
$cnt= 0;
foreach ($ana as $td) {
  if ($td->nodeName == 'tr')
    $cnt= 0;
  else
    $cnt++;

  if ($td->nodeName == 'td' && $cnt == 2) {

    echo $td->nodeValue,"<br/>";
  }
} 
```

# iphone - AFNetworking 错误：“（200-299）中的预期状态代码，得到 404”

> ID：15036422
> 
> 赞同：1
> 
> 时间：2013-02-23T02:42:06.183
> 
> 标签：iphone, ios, objective-c, rest, afnetworking

我的代码：

```
NSURL *url = [NSURL URLWithString:@"http:testurl.com"];
AFHTTPClient *httpClient = [[AFHTTPClient alloc] initWithBaseURL:url];

NSString *email = @"test@test.com";
NSString *password = @"test";

NSDictionary *params = [NSDictionary dictionaryWithObjectsAndKeys:
                        email, @"email",
                        password, @"password",
                        nil];

[httpClient postPath:@"/myobject" parameters:params success:^(AFHTTPRequestOperation *operation, id responseObject) {
    NSString *responseStr = [[NSString alloc] initWithData:responseObject encoding:AFJSONParameterEncoding];
    NSLog(@"Request Successful, response '%@'", responseStr);
} failure:^(AFHTTPRequestOperation *operation, NSError *error) {
    NSLog(@"[HTTPClient Error]: %@", error.localizedDescription);
}]; 
```

即使我知道服务器应该是一个 POST 我也尝试了 GET 和 PUT 并且仍然收到相同的错误。我还检查了 100 次 URL。关于导致错误的任何想法？

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T02:47:53.497

转到通过将`http:testurl.com`和`/myobject`放在一起在浏览器中创建的 URL。404 表示页面或资源不存在。

也尝试将斜杠移动到 baseUrl，即 baseURL to`http://testurl.com/`和 postPath 以`myobject`查看[此问题](https://github.com/AFNetworking/AFNetworking/issues/471)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T06:35:27.520

您的基本 URL 格式不正确。

改变这个：`"http:testurl.com"`

对此：`"http://testurl.com"`

# python - 返回正负浮点数之和

> ID：15036437
> 
> 赞同：2
> 
> 时间：2013-02-23T02:43:52.597
> 
> 标签：python, list, python-3.x, floating-point

我正在尝试创建一个函数，该函数采用浮点列表并返回两个数字的列表，这等于所有正浮点和所有负浮点的总和。例如：

```
statement([30.95, -15.67, 45.56, -55.00, 43.78])
returns [-70.67, 120.29] 
```

到目前为止，这是我们能够做到的：

```
res= []
for i in range(len(l)-1):
    for j in range(i,len(l)):
        if l[i]>=l[i+1]:
            res = 
return res 
```

但我有点卡住了。谁能帮我更好地理解这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T02:46:36.507

我会将它们过滤到两个列表中：

```
positives = [n for n in numbers if n < 0]
negatives = [n for n in numbers if n > 0] 
```

然后使用`sum()`：

```
return sum(negatives), sum(positives) 
```

或者如果你想让你的导师生气：

```
statement = lambda n: map(sum, zip(*map(lambda x: (x, 0)[::cmp(0, x)], n))) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-23T04:31:36.637

```
def sum_negpos(numbers):
    return [sum(n for n in numbers if n < 0), # sum of negative numbers
            sum(n for n in numbers if n > 0)] # sum of positive numbers 
```

该解决方案使用生成器表达式，它使用与[列表](http://docs.python.org/3/tutorial/datastructures.html#list-comprehensions)`(x for x in it if cond(x))`推导相同的语法，但一次只生成一个值，而不是一次创建整个列表。 `[x for x in it if cond(x)]`

单程：

```
def sum_negpos(numbers):
    sums = [0, 0] # negative, positive sum
    for n in numbers:
        sums[n > 0] += n
    return sums 
```

该解决方案利用了这样一个事实，即在 Python中， `True == 1`and是if和 it is else。`False == 0``sums[n > 0]``sums[1]``n > 0``sums[0]`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-23T02:56:58.393

另一个解决方案：

```
def statement(l):
    return reduce(lambda (n, p), x: (x < 0) and (n + x, p) \
        or (n, p + x), l, (0, 0))

statement([30.95, -15.67, 45.56, -55.00, 43.78])
(-70.67, 120.29) 
```

# ruby-on-rails - Postgres 连接泄漏 - 事务中的空闲（已中止）

> ID：15036438
> 
> 赞同：1
> 
> 时间：2013-02-23T02:43:54.423
> 
> 标签：ruby-on-rails, postgresql, activerecord

我有一个导致 Postgres 连接泄漏的 Rails 多线程应用程序。最终，当我尝试建立新连接时，它告诉我我有太多客户。

当我查看当前连接时，我看到一堆具有以下状态的连接：“事务中的空闲（中止）”。这是什么意思，最重要的是，有没有办法让 Postgres 定期检查这些类型的连接，并在它们长时间存在时终止它们？

我知道解决此问题的最佳方法是修复应用程序问题，但除此之外，我如何确保这些类型的陈旧连接不会阻塞连接池？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T03:16:15.473

因此，一种半骇人听闻的方法是摆脱处于空闲状态（已中止）状态超过 5 分钟的进程。您可以将其放入 Cron 作业中：

```
SELECT pg_terminate_backend(pid)
FROM pg_stat_activity 
WHERE datname = 'DBNAME'
  AND pid <> pg_backend_pid()
  AND state = 'idle in transaction (aborted)' 
  AND state_change < current_timestamp - INTERVAL '5' MINUTE 
```

对于 postgres 版本 ≤ 9.1，您可能想试试这个：

```
SELECT pg_terminate_backend(pid)
FROM pg_stat_activity
WHERE datname = 'DBNAME'
  AND procpid <> pg_backend_pid() 
  AND current_query = '<IDLE> in transaction (aborted)'
  AND query_start < current_timestamp - INTERVAL '5' MINUTE 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-04-23T08:54:35.843

对于问题的“这意味着什么”部分，我的回答是您的应用程序可能没有正确处理 SQL 错误：postgres 连接引发了应用程序无法检测到的错误并且不会回滚事务。所以连接永远保持*“在事务中（中止）” 。*

# c# - 将每个其他数组元素乘以 2

> ID：15036440
> 
> 赞同：1
> 
> 时间：2013-02-23T02:44:08.103
> 
> 标签：c#, arrays, indexof, modulus

我有一个 10 位数字的数组。我想乘以 2，数组的每个元素都有一个偶数索引。我想将具有奇数索引的元素乘以 1（实际上，保持不变）。因此，array[0] * 2、array[1] * 1、array[2] * 2 等。

我尝试在每个元素的索引号上使用模运算符，但我认为这不是我的代码实际所做的。我之前的愚蠢尝试如下：

```
for (int i = 0; i < 10; i++)
{
    if ((Array.IndexOf(myArray, i) % 2) == 0)
    {
        // multiply myArray[i] by 2
    }
    else // multiply myArray[i] by 1
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T03:13:30.433

此代码适用于列表中的任何 no.of 元素。（数组可以有 1 个或多个元素）

`myArray = myArray.Select(x => ((Array.IndexOf(myArray, x) % 2 == 0) ? x * 2 : x * 1)).ToArray();`

会给你一个整数数组，其中偶数索引元素乘以 2，奇数乘以 1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T02:47:40.877

```
for (int i = 0; i < 10; i++)
{
    if((i % 2) == 0)
    {
        // multiply myArray[i] by 2
    }
    else // multiply myArray[i] by 1
} 
```

`Array.IndexOf(firstParam,secondParam)`将为您提供 secondParam 的索引。例如：

*   arr[0] = 10
*   arr[1] = 3
*   arr[2] = 5
*   arr[3] = 1

`Array.IndexOf(arr,1)`= 3、`Array.IndexOf(arr,3)`= 1 等。

# mysql - mysql 按名称将列分组在一起

> ID：15036441
> 
> 赞同：0
> 
> 时间：2013-02-23T02:44:08.963
> 
> 标签：mysql, sql, join

我试图创建一个演示来解释如何加入并遇到了一些困难。

```
CREATE TABLE sample (
  id INT
);

INSERT INTO sample VALUES (1),(2),(3),(4); 
```

那是我的架构。

```
SELECT *
FROM sample AS s1
JOIN sample AS s2; 
```

如果你这样做，你会得到这个：

```
1,1
1,2
1,3
1,4
2,1
2,2
...
4,3
4,4 
```

至少这是 JOIN 看到的。但是，如果您尝试运行它，则会得到一列的值等于第一列。我不想要那个 - 我想要两列。

我可以做`s1.*, s2.*`而不是`*`我希望 SQL 使用它自己的分组。原因是 LEFT 和 RIGHT JOIN 不关心数据如何出现在输出中 - 他们关心的是连接到 RIGHT 和 LEFT 的表。而且，这并不能很好地扩展。我只想看看 JOIN 看到了什么。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:52:11.967

这是 MySQL 的一个特性。具有相同名称的列在输出时“组合”成单个列。我不相信这是符合 ANSI 的行为。

要演示连接，请尝试以下操作：

```
select s1.id as id1, s2.id as id2
FROM sample s1 cross join
     sample s2; 
```

这将重命名列，因此两者都出现在输出中。另外，我将其重命名`join`为`cross join`. 在 MySQL 中，`join`可用于常规连接或笛卡尔积，具体取决于`on`子句的存在。我觉得这种行为令人困惑。 `join`应该是内连接。笛卡尔积应该使用`cross join`.

这在 SQLFiddle 上似乎很奇怪。当我在 SQL Fiddle for SQL Server 上运行此代码时，我得到与您相同的结果。但是，当我在本地 SQL Server 上运行此代码时，我得到两列：

```
CREATE TABLE sample (
  id INT
);

INSERT INTO #sample VALUES (1),(2),(3),(4);

SELECT *
FROM sample AS s1
cross JOIN sample AS s2; 
```

这似乎是 SQL Fiddle 的问题。

# c# - 使用来自客户端应用程序的单个调用从 sql server 中的表中删除多行

> ID：15036443
> 
> 赞同：1
> 
> 时间：2013-02-23T02:44:21.877
> 
> 标签：c#, sql, sql-server, sql-server-2008, table-valued-parameters

这是我的要求：

*   我想删除表格的多行
*   我有需要在客户端应用程序中删除的所有 id 的列表。
*   我只想**从我的 C# 客户端应用程序中进行一次调用以删除所有这些记录。**

我之前的：

`foreach (var id in idList)`
`{`
`//Call a Stored Procedure which takes the id`
`//as parameter and deletes the record`
`}`

这是一个问题，因为循环中的每个项目都有一个数据库命中。

然后我开始使用**SQL Server 2008 新引入的表类型和表值参数**用于存储过程。

*   首先在数据库中创建一个表类型，该表类型具有单列（Id 类型）
*   创建一个接受此新表类型（表值参数）的新存储过程
*   在客户端代码中，创建一个包含所有要删除的 id 的列表/数据表。
*   对数据库进行一次调用以使用新的存储过程。

它在客户端代码中非常简单，如下所示：

`SqlParameter parameter = new SqlParameter();`
`parameter.SqlDbType = System.Data.SqlDbType.Structured;`

好的 - 虽然我达到了我设定的目标，但这绝对不适用于 2008 年之前的 SQL Server 版本。

所以我所做的就是引入一个回退机制：

*   我介绍了一个存储过程，它采用**逗号分隔的 id 值**
*   我的客户端代码将创建这样的逗号分隔的 id，然后简单地将其传递给新的存储过程。
*   然后存储过程将拆分所有这些 id，然后一一调用 delete。
*   因此，在某种程度上，即使在 2008 年之前的 SQL Server 版本上，我也实现了我所设定的目标：**使用单个数据库命中删除多行。**

但我对我采取的最后一种方法并不那么信服——在互联网上快速搜索并没有发现太多东西。

所以有人可以告诉我，如果我用逗号分隔的 id 和所有东西做正确的事情。
如果 id 是已知的，那么通过单个数据库命中从客户端应用程序中删除多条记录的通常最佳做法是什么。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T08:54:50.853

嗨，您只需将列表中的所有值与 delemeter 连接起来，如下所示 1,2,3,4,5

这是删除多行的示例存储过程

```
create PROCEDURE deleteusers  --deleteusers '1,2,3,4'
    -- Add the parameters for the stored procedure here
    @UsersIds varchar(max)

AS
BEGIN
declare @abc varchar(max)
set @abc='delete from users where userid in('+@UsersIds+')'
exec(@abc)
END
GO 
```

它将删除用户 ID 为 1、2、3、4 的用户

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-19T07:24:53.887

```
You can send a string containing comma separated or some other character(to be used for split) to send ids from C# end.

Create Procedure deleteusers
(
@ids nvarchar(MAX)
)
as
begin
DECLARE  @pos bigint,@count int,@id varchar(max),@I int,@Spos int
set @Spos=1
set @I=1
set @count=  len(@ids)-len(REPLACE(@ids,',','')) 
while(@I<=@count)
    begin
        SET @pos = CHARINDEX(',', @ids, 1)

        set @id = substring(@ids,@Spos,@pos-1)
delete from  TableName where id=@id 
set @ids= stuff(@ids, @Spos, @pos,'')

        set @I=@I+1
end
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T02:55:26.600

如果你有一个以列分隔的值列表，比如@list，你可以用这个`delete`语句做你想做的事情：

```
delete from t
where ','+@list+',' like '%,'+cast(t.id as varchar(255))+',%' 
```

这是用字符串操作模拟`in`表达式。

缺点是这需要全表扫描。它不会在 id 上使用索引。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T07:34:47.203

我建议不要在代码中构建 SQL 字符串，而是查看 ORM（对象关系映射器），例如[Entity Framework](http://msdn.microsoft.com/en-us/data/ef.aspx)或[NHibernate](http://nhforge.org/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-23T14:41:04.003

此处列出的动态 SQL 选项可能是您最好的选择，但只是为您提供了更多选择。

```
CREATE PROCEDURE deleteusers  --deleteusers '1,2,3,4'
-- Add the parameters for the stored procedure here
@UsersIds varchar(max)

CREATE TABLE #DeleteUsers (UserId Int)

-- Split @UserIds and populate into the #DeleteUsers temp table

DELETE FROM Users WHERE UserId IN (SELECT UserId FROM #DeleteUsers) 
```

# java - Java Scanner获取输入，调用一个方法，然后返回读取更多输入不起作用

> ID：15036445
> 
> 赞同：2
> 
> 时间：2013-02-23T02:44:51.813
> 
> 标签：java, exception, java.util.scanner

我有一个名为 的类`PlayGame`，在`main`方法中我有这段代码：

```
public class PlayGame {
    public static void main(String args[]) {
        while (true) {
            System.out.println("Where would you like your adventure to begin? (Enter a number)\n");
            System.out.println("1\. Play the Game\n2\. Quit the Game");
            Scanner userInput = new Scanner(System.in);
            String userAction;
            try {
                userAction = userInput.nextLine().trim();
                if (userAction.equals("1")) {
                    pressPlay();
                } else if (userAction.equals("2")) {
                    System.exit(0);
                } else {
                    System.out.println("Sorry, your selection wasn't valid.");
                }
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    }
} 
```

这一切都很好，当用户键入**1**时，`pressPlay()`会调用它并继续执行下一个方法，该方法会做一些事情，主要是将事情打印到屏幕上。但是，当我离开该`pressPlay()`方法并返回此主方法时，我开始收到读取输入的错误：

```
java.util.NoSuchElementException: No line found
    at java.util.Scanner.nextLine(Scanner.java:1516)
    at PlayGame.main(PlayGame.java:17) 
```

你能告诉我如何解决这个问题吗？非常感激！

**编辑**- 我只是希望它返回到 main 方法中的 while 循环并再次请求 1 或 2，并取一个有效的 1 或 2。我的代码一直运行到`userAction = userInput.nextLine().trim();`第二次不再等待用户输入，离开该`pressPlay()`方法后。

**编辑**- 该`pressPlay()`方法生成一个网格，玩家可以通过键入特定命令在其中移动。它内部有一个`while (true) {`循环，并`Scanner userInput = new Scanner(System.in);`接受玩家的输入。如果玩家键入 quit，它会调用 while 循环的中断并返回到 main 方法，然后出现问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T03:54:56.467

我已经设法解决了这个问题。

在我的 main 方法和我的`pressPlay()`方法中，我创建了单独的扫描仪从`System.in`. 相反，我将 Scanner 从 main 方法中取出并将其放在 之后`public class PlayGame {`，并在我的两种方法中都使用了相同的扫描仪，而不是单独的方法。

感谢 Jayamohan 和 Hossam 的意见（：

# java - DOCX4J：空指针异常

> ID：15036447
> 
> 赞同：0
> 
> 时间：2013-02-23T02:45:25.997
> 
> 标签：java, docx4j

我使用 WordprocessingMLPackage.createPackage() 方法创建了一个新的文档文件。现在我正在尝试操作默认样式的内容（“标题 1”、“正常”等）。当我尝试打印样式属性的值时，它返回 NullPointerException。我很确定样式在那里，因为名称可以打印出来。但是当我尝试访问它的段落属性时，它是空的。

所以现在我想知道我是否没有正确访问内容。

```
private static void createStyleFile() throws InvalidFormatException
    {
        WordprocessingMLPackage doc = WordprocessingMLPackage.createPackage();
        List<Style> styleList = doc.getMainDocumentPart().getStyleDefinitionsPart().getJaxbElement().getStyle();

        for(int x = 0; x < styleList.size(); x++)
        {
            Style curStyle = styleList.get(x);
            //C.out(curStyle.getStyleId());
            C.out(curStyle.getName().getVal());
            curStyle.getPPr().getInd().getFirstLine().intValue();
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T03:33:41.973

样式可以是段落、字符、表格或列表样式。

字符样式不会有 PPr 组件，因此您必须在样式类型上进行分支，或者测试 getPPr 是否返回 null。

如果 PPr 不为 null，则 getInd() 可能返回 null，因此您还需要在那里检查 null。

我建议您保存您的 docx，将其解压缩，然后查看 styles.xml 以更好地了解其中的内容。

# ejb-3.0 - Java EE 6 - 为什么需要将拦截器项目声明为 ejb-jar 而不仅仅是 jar？

> ID：15036451
> 
> 赞同：0
> 
> 时间：2013-02-23T02:46:13.097
> 
> 标签：ejb-3.0, java-ee-6, cdi

我能够确定我需要做什么才能让我的拦截器工作；但是，我不明白为什么我必须这样做。我在其中使用拦截器项目的所有项目都启用了 jar / war 和 CDI。

我认为 CDI 涵盖了 EJB bean、常规 POJO bean、属性以及任何可通过 EL 解析的内容。而且...要为 CDI bean 注册一个拦截器，我可以简单地在 beans.xml 中声明它。我的项目都不是 EAR。

现在我通过将项目构建为 ejb-jar 使其工作，这是主要的事情，但我认为它应该单独在 beans.xml 中工作并将项目构建为普通 jar 是错误的吗？

请指出任何明确指定这一点的文档，oracle 网站上的所有内容都表明 beans.xml 就足够了。

沃尔特

# javascript - 有没有更好的方法来编写这组 IF 语句？

> ID：15036452
> 
> 赞同：0
> 
> 时间：2013-02-23T02:46:22.860
> 
> 标签：javascript, jquery, if-statement

我的代码中有几个地方需要在多个不同的变量上测试是否为真 - 就像这样：

```
if(setting1){ Do something with El A };
if(setting2){ Do something with El B };
if(setting3){ Do something with El C };
if(setting4){ Do something with El D }; 
```

有没有更好的方法来写这个？

**我已经用额外的细节更新了这个问题，但看起来 IF 块是最好的选择。**

设置保存到 .data。这些设置是真/假，它们启用/禁用 HTML 元素。在我的脚本中的某些点，我需要在运行一些附加代码之前检查这些元素以查看它们是否已启用。例如，显示元素 - 如果用户已将 Nav 按钮的 .data 设置为 true - 则将显示 Nav 按钮。

```
if(setting1){ Do A to El A }; 
```

条件内的代码并没有真正的模式，所以我认为循环不是一个好的解决方案。同样，我认为 IF 块是最好的方法，但我很好奇是否有一些很酷的技巧来编写这个更清洁的东西。

```
if(setting1){ Do A to El A};
if(setting2){ Do B to El B};
if(setting3){ Do A to El A};
if(setting4){ Do X to El X}; 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T03:36:37.280

使用[Array.forEach](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/forEach)循环检查每个元素是否被禁用：

```
elements.forEach(function(el) {
    alert(el.disabled);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T03:00:52.283

如果你不是 KISS 的一员，

```
var settingsAndEffects = 
[
    {'test': function(params) { return bool; }, // setting1
        'apply': function(params) { ... }}, // Do something with El A
    {'test': function(params) { return bool; }, // setting2
        'apply': function(params) { ... }}, // Do something with El B
    ...
]

for(var i = 0; i < settingsAndEffects.length; i++) 
{
    if(settingsAndEffects[i].test(params))
        settingsAndEffects[i].apply(params);
} 
```

否则坚持ifs。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T02:48:39.793

使用`switch`声明... [此处填充文字]

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/switch](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/switch)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T02:55:24.167

如果`settingsX`也是任意的，`Do something`并且设置与元素，设置与代码或元素与代码之间没有任何关系，那么我相信您的代码是最小的。我可以建议许多替代方式来表达它们——这可能有助于促进重用，但不会使代码更小——但我需要更多关于上下文的信息。

例如，如果代码和设置都特定于元素：

```
$("#elementA").data("DoSomething", function() { ... });
$("#elementB").data("DoSomething", function() { ... });

$(".my_elements")
    .filter(function() { return specificSettings(this); })
    .each(function() { $(this).data("DoSomething")(); }); 
```

请注意，生成的代码更加冗长，因此如果您在多个地方重用它，这只是一个优势。

# java - 大写锁定警告

> ID：15036455
> 
> 赞同：2
> 
> 时间：2013-02-23T02:46:44.137
> 
> 标签：java, eclipse, boolean, capslock

我正在尝试创建一个应用程序，因此当用户尝试在 JTextfield 中输入大写字母或其他内容时，会出现错误，通知用户关闭大写锁定。

```
import java.awt.*;
import java.awt.event.*;

public class NewClass
{
    private static String check="false";

    public static void main(String[] args)
    {
        if ( Toolkit.getDefaultToolkit().getLockingKeyState (KeyEvent.VK_CAPS_LOCK ) );
        check="true";

        if(check.equals(true));
        System.out.println("Turn it off");
        {
        }
    } 
```

如何使用布尔值

```
( Toolkit.getDefaultToolkit().getLockingKeyState (KeyEvent.VK_CAPS_LOCK ) ); 
```

所以如果它是真实的显示信息来关闭它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T02:51:05.927

这个

```
if(check.equals(true)); 
```

应该

```
if(check.equals("true")) 
```

并`;`从第一个 if 语句中删除，尽管您真正需要做的就是

```
if(Toolkit.getDefaultToolkit().getLockingKeyState (KeyEvent.VK_CAPS_LOCK ))
{
     System.out.println("Turn it off");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T02:49:04.047

这应该工作！

```
boolean state= Toolkit.getDefaultToolkit()
                    .getLockingKeyState(KeyEvent.VK_CAPS_LOCK); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-23T02:53:10.590

这应该工作

```
if (Toolkit.getDefaultToolkit().getLockingKeyState(
        KeyEvent.VK_CAPS_LOCK)) {
    check = "true";
}
if (check.equals("true")) {
    System.out.println("Turn it off");
} 
```

您的代码中有错误的地方，

1) if 语句中的分号。请记住，如果 if 块不会执行，则末尾是否有分号。

```
 if (true); {
     // wont be executed
   }

   if (true) {
     // will be executed    
   } 
```

2）比较错误。它应该是。如果您将“检查”变量定义为布尔值，那么您的旧代码就可以了。由于您将它们用作字符串，因此您应该等同于如下。我建议你在那里使用布尔类型。

```
if (check.equals("true")) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T05:55:57.457

您不应该只看 CapsLock，因为有人可以按 shift 键输入大写字母。向 JTextField 添加一个键侦听器并检查键入的字母。您甚至可以将大写字母更改为小写。

```
 final JTextField jTextField = new JTextField() {
        {
            addKeyListener(new KeyListener() {
                public void keyTyped(final KeyEvent e) {
                    System.out.println(e.getKeyChar());
                    System.out.println(e.getModifiers());
                }
                public void keyReleased(final KeyEvent e) {
                }
                public void keyPressed(final KeyEvent e) {
                }
            });
        }
    }; 
```

# php - PHP - 在刮板中使用变量和对象

> ID：15036456
> 
> 赞同：0
> 
> 时间：2013-02-23T02:46:55.007
> 
> 标签：php, screen-scraping

我是 PHP 新手，并已尽力使用 PHP 参考指南，但我显然在这里遗漏了一些东西。这是我的工作流程：

1.  我有一个数组，里面存储了大约 120 个链接
2.  我想抓取这些链接并从中获取产品信息
3.  我想将该产品信息存储在数据库中

对于#3，我认为最好的方法是将信息存储在 PHP 对象中，然后将其导出到数据库。如果我错了，请纠正我，并且有更好的方法来做到这一点！

这是我的代码，当我尝试分配属性时，它当前正在返回“PHP 通知：尝试在 /home/scriptrunner/script.php 中获取非对象的属性”错误（奇怪的是，只有当我获得属性时`$$productName->moreImages3 = $the_html->find(".extra_images ", 2)->src;`但这可能是一个红鲱鱼。

```
class Product{ //Creates an object class for products
    public $name = '';
    public $infoLink = '';
    public $description = '';
    public $mainImage = '';
    public $moreImages1 = '';
    public $moreImages2 = '';
    public $moreImages3 = '';
    public $moreImages4 = '';
    public $price = '';
    public $designer= '';
}

function getInfo($infoLink){    // Trawls the product pages for info  

    $the_content = scraperwiki::scrape($infoLink);
    $the_html = str_get_html($the_content);

    $productName = $the_html->find("#item_info h1", 0)->innertext;
    $$productName = new Product;
        $$productName->name = $productName;
        $$productName->infoLink = $infoLink;
        $$productName->designer = $the_html->find("#item_info h2", 0)->innertext;
        $$productName->description = $the_html->find("#item_info .product-body", 0)->innertext; //Might cause issues because there are multiple <p> tags in this div
        $$productName->mainImage = $the_html->find("#item_image .imagecache-product_item_default", 0)->src;
        $$productName->moreImages1 = $the_html->find(".extra_images ", 0)->src;
        $$productName->moreImages2 = $the_html->find(".extra_images ", 1)->src;
        $$productName->moreImages3 = $the_html->find(".extra_images ", 2)->src;
        $$productName->moreImages4 = $the_html->find(".extra_images ", 3)->src;
        $$productName->price = $the_html->find("#price", 0)->innertext;

        print_r($$productName ->name); //A test to see if it's working
}

for ($i = 0; $i<count($allLinks); ++$i){
   getInfo($allLinks[$i]);
}; 
```

`for`循环贯穿 120 个链接（包含在 中）`$allLinks`。有什么想法我在这里出错了吗？

**编辑：**作为参考，每个页面上有四个带有 class 的图像`.extra_images`，所以我想将每个图像存储为一个单独的属性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T02:51:17.827

变量变量名称从来都不是一个好主意，尤其是批量。只需使用一个数组：

```
$products[$productName] = new Product;
$products[$productName]->name = $productName;  
$products[$productName]->infoLink = $infoLink;
$products[$productName]->designer = $the_html->find("#item_info h2", 0)->innertext;
$products[$productName]->description = $the_html->find("#item_info .product-body", 0)->innertext; //Might cause issues because there are multiple <p> tags in this div
$products[$productName]->mainImage = $the_html->find("#item_image .imagecache-product_item_default", 0)->src;
$products[$productName]->moreImages1 = $the_html->find(".extra_images ", 0)->src;
$products[$productName]->moreImages2 = $the_html->find(".extra_images ", 1)->src;
$products[$productName]->moreImages3 = $the_html->find(".extra_images ", 2)->src;
$products[$productName]->moreImages4 = $the_html->find(".extra_images ", 3)->src;
$products[$productName]->price = $the_html->find("#price", 0)->innertext; 
```

这样您就可以通过产品名称轻松地单独访问产品，例如

```
echo $products[$productName]->name; 
```

如果您需要，还可以遍历您的所有产品：

```
foreach($products as $product)
{
    var_dump($product);
} 
```

没有可怕的混乱。

# winrt-xaml - XML 网格不会扩展

> ID：15036457
> 
> 赞同：0
> 
> 时间：2013-02-23T02:47:08.303
> 
> 标签：winrt-xaml

我有一个托管 2 个较小网格的父网格（“输出”）。

较小的网格 MainDisplay（它基本上在 ViewBox 中显示一个图像，我想占据除 2 个子网格中的另一个中的 300 之外的所有水平空间）和 Input（固定宽度为 300，实际上按预期工作） .

我的问题是：

1）父网格不消耗所有水平空间。我希望额外的空间与 ViewBox 一起进入网格。

我已经洒了 'Horizo​​ntalAlignment="Stretch"' 和 'Width="*"' ，但它不会占用屏幕上的所有空间！

2）我有代码来获取图像的宽度/高度。除非我明确设置高度、宽度，否则后面的代码会尝试获取高度和宽度并崩溃……但如果我明确设置宽度/高度，恐怕它不会占用可用空间。

这是代码：

```
<Grid x:Name="Output" Background="#1D1D1D" Margin="0,2,0,-2" HorizontalAlignment="Stretch">
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition Width="300"/>
    </Grid.ColumnDefinitions>
    <Grid x:Name="MainDisplay" HorizontalAlignment="Stretch" VerticalAlignment="Top" Grid.Column="0">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <Viewbox Width="Auto" Height="Auto" MinWidth="400" MinHeight="400" x:Name="Scenario4ImageContainer" Stretch="Uniform">
            <Image x:Name="Scenario4Image" PointerPressed="Scenario4Image_PointerPressed" HorizontalAlignment="Stretch"  />
        </Viewbox>
    </Grid>
    <Grid Width="300" x:Name="Input" Grid.Column="1">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <StackPanel Grid.Row="0">
            <TextBlock Style="{StaticResource BasicTextStyle}" TextWrapping="Wrap" 
                       Text="Tools" />
            <Grid Margin="0,10,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition />
                    <RowDefinition />
                    <RowDefinition />
                    <RowDefinition />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="230" />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>

                <Button Grid.Row="0" Grid.Column="0" HorizontalAlignment="Stretch" Background="DarkSlateGray"
                        Content="Draw Mandelbrot set" Click="DrawMandelbrotSet_Click" />
                <TextBlock x:Name="Scenario4DrawMandelbrotDescription" Grid.Row="0" Grid.Column="1" 
                           Style="{StaticResource BasicTextStyle}" TextWrapping="Wrap" VerticalAlignment="Center"
                           Text="Text." />

                <Button x:Name="Scenario4SetSourceButton" Grid.Row="1" Grid.Column="0" HorizontalAlignment="Stretch"
                        Content="Load image using SetSource" Click="LoadImageUsingSetSource_Click" />
                <TextBlock x:Name="Scenario4SetSourceDescription" Grid.Row="1" Grid.Column="1" 
                           Style="{StaticResource BasicTextStyle}" TextWrapping="Wrap" VerticalAlignment="Center"
                           Text="Text." />

                <Button x:Name="Scenario4LoadImageButton" Grid.Row="2" Grid.Column="0" HorizontalAlignment="Stretch" 
                        Content="Load image using PixelBuffer" Click="LoadImageUsingPixelBuffer_Click" />
                <TextBlock x:Name="Scenario4LoadImageDescription" Grid.Row="2" Grid.Column="1" 
                           Style="{StaticResource BasicTextStyle}" TextWrapping="Wrap" VerticalAlignment="Center"
                           Text="Text." />
            </Grid>
        </StackPanel>
    </Grid> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:54:41.460

我对此不是 100% 确定，但请尝试`"*"`代替`"Auto"`您的第一列定义：

```
<Grid.ColumnDefinitions>
    <ColumnDefinition Width="*"/>
    <ColumnDefinition Width="300"/>
</Grid.ColumnDefinitions> 
```

# c# - Windows phone 8 开发人员：从未调用过 HttpWebRequest.BeginGetResponse 回调

> ID：15036458
> 
> 赞同：0
> 
> 时间：2013-02-23T02:47:11.653
> 
> 标签：c#, windows-phone-8, windows-phone-8-emulator

我正在我的 Windows 8 机器上开始 Windows Phone 8 开发，并在 Visual Studio 2012 附带的模拟器上进行测试。我有一个带有一个按钮的主页。按下按钮后，它会发出一个 http 请求。

```
private void Button_Click_1(object sender, RoutedEventArgs e)
{
    string uriString = "http://209.143.33.109/mjpg/video.mjpg?camera=1";
    var uri = new Uri(uriString);
    var httpWebRequest = HttpWebRequest.Create(uri);

    httpWebRequest.BeginGetResponse(new AsyncCallback(OnGettingResponse), httpWebRequest);
}

private void OnGettingResponse(IAsyncResult ar)
{
    var req = ar.AsyncState as HttpWebRequest;
    var response = (HttpWebResponse)req.EndGetResponse(ar);
    var responseStream = response.GetResponseStream();
} 
```

我在 OnGettingResponse 上设置了一个断点。但是当我按下按钮时，断点永远不会被击中。

我在这里遗漏了什么明显的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-26T07:03:31.673

我遇到了同样的问题，即使等待太久也没有调用我的回调。

我找到了这个 stackoverflow 答案[https://stackoverflow.com/a/15041383](https://stackoverflow.com/a/15041383)并相应地修改了我的代码。该问题的实际问题是，提问者希望在 Windows Phone 8 下的 HttpWebRequest 中具有一些超时功能。拥有计时器对我来说无关紧要，所以我只使用了以下部分代码：

```
public async Task<string> httpRequest(HttpWebRequest request)
{
    string received;

    using (var response = (HttpWebResponse)(await Task<WebResponse>.Factory.FromAsync(request.BeginGetResponse, request.EndGetResponse, null)))
    {
        using (var responseStream = response.GetResponseStream())
        {
            using (var sr = new StreamReader(responseStream))
            {

                received = await sr.ReadToEndAsync();
            }
        }
    }

    return received;
} 
```

并将我对该方法的调用修改为：

```
var response = await httpRequest(request); 
```

现在这对我来说很好。

我还仔细检查了 ID_CAP_NETWORKING 是否在 WMAppManifest.xml 中检查，并且互联网正在我的模拟器上运行。

# clojure - 将列表项分配给clojure中的变量

> ID：15036460
> 
> 赞同：1
> 
> 时间：2013-02-23T02:47:15.987
> 
> 标签：clojure

当我通过这个函数

```
(into [] 
      (map #(+ %1 %2)
           [1 2]
           [5 6])) 
```

我得到这个结果：`[6 8]`

我应该怎么做才能得到这个：`[6 7 7 8]`同时保持这个`#(+ %1 %2)`？

在这种情况下，似乎`map`不是正确的功能。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T03:06:42.203

`for`当您需要笛卡尔积时使用：

```
user=> (for [x [1 2] y [5 6]]
  #_=>   (+ x y))
(6 7 7 8) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T04:14:11.257

`for`是亚历克斯回答显示的一种选择。`map`也可以使用（with `mapcat`），如下所示：

```
user=> (mapcat #(map (partial + %1) [5 6]) [1 2])
(6 7 7 8) 
```

# matlab - 在matlab中动态创建按钮

> ID：15036472
> 
> 赞同：1
> 
> 时间：2013-02-23T02:48:45.400
> 
> 标签：matlab, user-interface, button, dynamic, push

我正在尝试在 matlab 中创建一个 GUI，其中必须动态创建按钮。即，当用户选择目录时，将创建与所选目录中的文件数量一样多的按钮。怎么能做到这一点？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T04:22:25.417

您想使用[句柄图形](http://www.mathworks.com/help/matlab/ref/uitoggletool.html)，更具体地说是[句柄图形组件](http://www.mathworks.com/help/matlab/creating_guis/adding-components-to-a-programmatic-gui.html#f15-1001532)。从同一个网页，您可以看到以编程方式创建按钮的代码，

```
h = figure('ToolBar','none');
ht = uitoolbar(h);
a = rand(16,16,3);
htt = uitoggletool(ht,'CData',a,'TooltipString','Hello'); 
```

并将它们的回调/处理程序属性设置为属性值对。

# ruby-on-rails - Rails：我想根据逻辑限制 form.html.erb 中可用的选择

> ID：15036475
> 
> 赞同：0
> 
> 时间：2013-02-23T02:48:59.627
> 
> 标签：ruby-on-rails, selection, limiting

考虑到先前建立的内容，我需要将可选项目减少到合适的程度。

假设我有 [Class] **has_many** [Order] **has_many** [Family]
*（还记得旧版的 Kingdom Phylum Class Order Family Genus Species 吗？）*

当数据输入人员之前选择过，比如说，**四足哺乳动物**[类]，

和**Canids** [Order]（我不知道这是否正确，但我希望你明白这一点），

他们应该**只**选择狼、狐狸和狗等作为他们的选择，因为他们已经把范围缩小到那么远了。
我不想给运营商一个 [Families] 的列表，比如 Cats、Crows 或 Crocodiles。

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T03:02:12.560

我假设您正在尝试绘制这样的`Family`选择框：

```
<%= collection_select :family_id, Family.all, :id, :name %> 
```

但是鉴于用户已经选择了一个订单（假设您已经将该对象实例化为`@order`：

```
<%= collection_select :family_id, @order.families, :id, :name %> 
```

# javascript - 使用 .replace() 的正则表达式

> ID：15036477
> 
> 赞同：0
> 
> 时间：2013-02-23T02:49:07.893
> 
> 标签：javascript, regex

```
value = value.replace('[b]', '');
value = value.replace('[/b]', ''); 
```

如何优化此代码？

我有一种感觉，我可以用正则表达式来做到这一点。就像是

```
value.replace('/^[\/?b]/', ''); 
```

但我无法弄清楚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T02:58:45.037

```
value = value.replace(/\[\/?b\]/g, ''); 
```

您需要转义括号和斜线，并且不要将正则表达式放在引号内。并且`g`需要修饰符来替换所有出现的地方。

# actionscript-3 - Flex：如何控制表单项和相应的errorString之间的间距？

> ID：15036478
> 
> 赞同：4
> 
> 时间：2013-02-23T02:49:07.530
> 
> 标签：actionscript-3, apache-flex, flex4

这是一个简单的应用程序来说明我的问题。指示：

1.  运行附加的 Flex 4 代码
2.  在第一个表单项中输入 0（例如“输入速度 (MPH)”）
3.  单击第二个表单项
4.  观察错误字符串出现在第一个表单项的右侧

问题：如何使错误字符串直接出现在第一个表单项的右侧，同时保持表单的宽度固定（例如，当前示例使用 400 px 的固定表单宽度）？

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
               xmlns:s="library://ns.adobe.com/flex/spark" 
               xmlns:mx="library://ns.adobe.com/flex/mx" minWidth="955" minHeight="600">

    <fx:Script>
        <![CDATA[
            private function validateSpeed():void {
                var num:Number=Number(speedId.text);
                speedId.errorString="";

                if (speedId.text=="") {
                    speedId.errorString="This field is required.";  
                    return;
                } else if ( Number(speedId.text)<1000) {
                    speedId.errorString="The speed must be at least 1 MPH.";
                    return;
                } else if ( Number(speedId.text)>1e11) {
                    speedId.errorString="The speed cannot exceed 100 MPH.";
                    return;
                }
            }       
        ]]>
    </fx:Script>

    <s:Form width="600" >   
        <s:layout>
            <s:FormLayout gap="-10" horizontalAlign="center"/>
        </s:layout> 

        <s:FormItem id="speedFI" label="Enter Speed (MPH):" width="600" required="true">
            <s:TextInput id="speedId" width="195" textAlign="right"
                     restrict="0-9" maxChars="7"
                     focusOut="validateSpeed();"
                     toolTip="Enter a speed between 1 and 100 MPH."/>
        </s:FormItem>   

        <s:FormItem id="dummyFI" label="Dummy Label:" width="600" required="true">
            <s:TextInput id="dummyId" width="195" textAlign="center"
                     restrict="0-9" maxChars="7" prompt="Click here after entering 0 above."
                     toolTip="Dummy form item."/>
        </s:FormItem>           
    </s:Form>
</s:Application> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T03:51:29.377

您可以通过自定义`FormItemSkin`.

以下是默认`FormItemSkin`类的一些片段。请注意，此皮肤使用“约束”列/行来排列各个部分。您可以修改列的定义或修改错误消息在“helpColumn”中的位置。还有很多其他方法可以解决这个问题，但看起来你需要在皮肤内部进行。

约束列/行声明：

```
<s:layout>
    <s:FormItemLayout>
        <s:constraintColumns>
            <!--- The column containing the sequence label. -->
            <s:ConstraintColumn id="sequenceCol" />
            <!--- The column containing the FormItem's label. -->
            <s:ConstraintColumn id="labelCol" />
            <!--- The column containing the FormItem's content. -->
            <s:ConstraintColumn id="contentCol" width="100%"/>
            <!--- The column containing the FormItem's help content. -->
            <s:ConstraintColumn id="helpCol" maxWidth="200"/>
        </s:constraintColumns>         
        <s:constraintRows>
            <!--- @private -->
            <s:ConstraintRow id="row1" baseline="maxAscent:10" height="100%"/>
        </s:constraintRows>  
    </s:FormItemLayout>
</s:layout> 
```

这是用于显示错误消息的标签对象。您可以使用以下内容将标签的左边缘设置为更靠近输入字段：（`left="helpCol:10"`而不是`helpCol:27`）。

```
<s:RichText id="errorTextDisplay" includeIn="errorStates"
            fontStyle="italic" fontWeight="normal" color="0xFE0000"
            left="helpCol:27" right="helpCol:10"
            bottom="row1:10" baseline="row1:0" 
            maxDisplayedLines="-1"/> 
```

# c# - 有什么方法可以使用 c# 在整个桌面上捕获鼠标移动事件？

> ID：15036479
> 
> 赞同：0
> 
> 时间：2013-02-23T02:50:09.220
> 
> 标签：c#

每次指针鼠标移动时我都需要更新标签，但不仅在表单中，我还需要在所有桌面上捕捉到移动。

可能吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:59:52.113

你只需要标签说“鼠标移动”还是取决于它移动到哪里。我想无论哪种方式，您都可以使用一个每隔一段时间关闭一次的计时器，并检查鼠标 x 和 y 位置并将它们与以前的位置进行比较。

```
prevMouseX = MouseX;
prevMouseY = MouseY;
mouseX = System.Windows.Forms.Cursor.Position.X;
mouseY = System.Windows.Forms.Cursor.Position.Y; 
```

然后比较的是 mouseX = prevMouseX 等...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T03:16:55.670

你可能想看看鼠标捕捉。我不确定您正在使用的所有情况，但请查看[此 MSDN 文章](http://msdn.microsoft.com/en-us/library/ms754010.aspx#mouse_capture)以了解鼠标捕获的概述。 [这个答案](https://stackoverflow.com/questions/942357/what-does-it-mean-to-capture-the-mouse-in-wpf)也提供了一些信息。

# python - Shell 脚本 Python Shell 导入

> ID：15036487
> 
> 赞同：0
> 
> 时间：2013-02-23T02:51:11.623
> 
> 标签：python, django, sh

当我在`python manage.py shell`. 基本上我有一个小 shell 脚本可以让我进入`>>>`shell，但我希望能够在我的 views.py 脚本中自动推送导入调用，这样我就不必每次想要测试时都输入它们某物。我尝试将它们写在 shell 脚本中，但似乎它们没有传递给 python shell。

这是我到目前为止所拥有的。

```
#!/usr/local/bin/bash
python ~/path/to/manage.py shell

import datetime
from django.shortcuts import render_to_response
from mymodel.models import *
from myapp.forms import *
... and so on 
```

我想要发生的是将所有导入行推送到 python shell 中，这样我就不必每次想在 shell 上调试时都键入/复制粘贴它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T02:53:17.177

将您的前传放入文件中。在这里，我假设它位于一个适当命名为`prequel`. 然后你可以像这样调整你的 bash 脚本：

```
cat prequel - | python ~/path/to/manage.py shell 
```

`cat`连接文件，但它可以将标准输入视为文件，因此我们连接您的前传，然后连接标准输入，然后将该连接连接到 shell。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T02:54:25.033

还有 django 扩展： http: [//www.michelepasin.org/blog/2010/11/17/preloading-stuff-in-djangos-interactive-shell/](http://www.michelepasin.org/blog/2010/11/17/preloading-stuff-in-djangos-interactive-shell/)

# asp-classic - 使用经典asp单击按钮创建表格

> ID：15036489
> 
> 赞同：1
> 
> 时间：2013-02-23T02:51:25.240
> 
> 标签：asp-classic, adodb

我正在尝试验证信息，而不切换页面（在这种情况下是用户名，如果找到用户名，很好，填充一个文本框并使用它的用户名动态创建一个表）。但是，我在第 75 行收到错误消息：

```
ADODB.Recordset

 error '800a0e78' 

Operation is not allowed when the object is closed. 

/login.asp, line 75 
```

我没有在任何地方关闭记录集。据我所知，它应该有效。我究竟做错了什么？

```
<%
Dim cn,rs
    Set cn = Server.CreateObject("ADODB.Connection")
    Set rs = Server.CreateObject("ADODB.recordset")

    cn.Provider = "Microsoft.Jet.OLEDB.4.0"

    cn.Open Server.MapPath("login.mdb")

'Default message for the user on the login page
msg = "Please login"

'Logout code. This code empties the session variable which holds the user's userID.
If Request.QueryString("action") = "logout" Then
    Session("user_id") = ""
    msg = "You have been logged out"
End If

'Check if the form has been submitted

If Request.Form("Submit") = "Test" Then

    user_name = Request.Form("user_name")
    user_pass = Request.Form("user_pass")

    mySQL = "SELECT user_id, user_name, user_pass FROM users WHERE user_name = '" & user_name & "' AND user_pass = '" & user_pass & "'"

    'Select the data from the database using the submitted data.
    rs.Open mySQL, cn

        'Check if a match was found.
        If NOT rs.EOF Then

            'Session("user_id") = rsLogin("user_id")
            'Response.Redirect("profile.asp")

            u = rs("user_name")

        Else
            'If a match was not found then output an error.
            Response.Redirect("login.asp?errmsg=Login failed")
        End If
End If
%>

<!DOCTYPE html>
<html>
<head>
</head>

<body>
<form name="form1" id="form1" method="post" action="">
  <table width="300" border="0" cellspacing="0" cellpadding="2">
    <tr>
      <td>Username</td>
      <td><input name="user_name" type="text" id="user_name" /></td>
    </tr>
    <tr>
      <td>Password</td>
      <td><input name="user_pass" type="password" id="user_pass" /></td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td><input type="submit" name="Submit" value="Test" /></td>
    </tr>
  </table>
</form>
<input id="fileno" value="<%=u%>" type="text">

<%
        While NOT rs.EOF
%>
    <table width="200" border="1" cellspacing="0" cellpadding="2">
  <tr>
    <th scope="col"><div align="left">username</div></th>
  </tr>

  <tr>
    <td><%=u%></td>
  </tr>
<%
        rs.MoveNext
        Wend
%>
</table>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T05:07:12.657

当这个条件失败时。

```
If Request.Form("Submit") = "Test" 
```

您的代码尝试在不打开记录集的情况下访问 rs.eof。

把`rs.open`那个块的外面。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-23T04:55:07.257

表示您尚未关闭连接对象，请在页面末尾
尝试`set cn =Nothing`

# ld - 解码神秘的 AIX ld 0711-788 错误消息 - 固定指令不是分支

> ID：15036490
> 
> 赞同：0
> 
> 时间：2013-02-23T02:52:08.770
> 
> 标签：ld, aix

在 AIX 上链接我的代码时，我收到这条神秘消息：

```
ld: 0711-788 SEVERE ERROR: Object /dir/libxx.so, RLD address 0x5106 in section 1:
    The fixed-up instruction at address 0x5104 is not a branch.
    Its opcode is 14. 
```

如果我正确阅读了文档，则 RLD 是一个[重定位条目](http://pic.dhe.ibm.com/infocenter/aix/v6r1/index.jsp?topic=/com.ibm.aix.cmds/doc/aixcmds3/ld.htm)，但如果我不正确，我肯定会感谢您的澄清。

谷歌搜索会出现这个[特定页面](http://mymemory.translated.net/it/English/Italian/rld)，但它只是 ld 中可能出现的错误消息列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T21:46:42.113

此错误是由机器上的不同 AIX 版本引起的。

*   libxx.so 在 AIX 机器 @ 5.3 TL12 SP3 上编译。
*   我们进行链接的机器有 AIX @ 5.3 TL8 SP4

一旦我们升级我们的机器并链接到后一个技术级别，一切都很好。

再次感谢大家的所有建议！

# asp.net - JQuery自动完成文本框返回错误

> ID：15036492
> 
> 赞同：0
> 
> 时间：2013-02-23T02:52:29.350
> 
> 标签：asp.net, .net, c#-4.0, jquery

我曾尝试使用 jquery 和下面提到的代码来做自动完成文本框，但我无法实现它，我在 jquery 中遇到错误。提前致谢。

自动完成文本框.aspx：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="AutoCompleteTextBox.aspx.cs" Inherits="Ajax_Using_Jquery.AutoCompleteTextBox" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>Ajax Auto Complete Using Jquery</title>

      <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>  
    <script type="text/javascript">
     var UserNameInput;

     $(document).ready(function () {

            $("#<%=txtName.ClientID %>").autocomplete({
                source: function (request, response) {
                    $.ajax({
                        type: "POST",
                        //contentType: "application/json; charset=utf-8",
                        url: "AutoCompleteTextBox.aspx/getUserNames",
                        data: "{'TextBoxVal':'" + document.getElementById('<%=txtName.ClientID%>').value + "'}",
                        dataType: "json",
                        success: function (data) {
                            alert("success");
                        },
                        error: function (result) {
                            alert("error ");
                        }
                    });
                }
            });
        });

    </script>
</head>
<body>
    <form id="form1" runat="server">
    <table>
    <tr>
    <td>
    <div>
    User Name : &nbsp;&nbsp;
        <asp:TextBox ID="txtName" runat="server" ></asp:TextBox>
    </div>
    </td>
    </tr>
    </table>
    </form>
</body>
</html> 
```

自动完成文本框.aspx.cs：

```
public List<string> getUserNames(string TextBoxVal)
    {
        string strCon;
        List<string> objList = new List<string>();
        strCon = ConfigurationManager.ConnectionStrings["EmpNameFetch"].ConnectionString;
        SqlConnection con = new SqlConnection(strCon);
        SqlCommand cmd = new SqlCommand(@"select EmpName from newTb2 where EmpName like '%"+TextBoxVal+"%'", con);
        con.Open();
        SqlDataReader objReader = cmd.ExecuteReader();

        while (objReader.Read())
        {
            objList.Add(objReader["EmpName"].ToString());
        }
        Response.Write(objList.ToString());
        con.Close();
        return objList;

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T05:56:01.160

我不知道您遇到了什么样的错误，但是您是否尝试过在下面的行中发表评论？您已经在发送响应，无需显式编写响应。您可能还想将您的方法转换为 Web 方法。

```
 Response.Write(objList.ToString()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T06:10:41.503

你应该像这样制作这个方法：

```
[WebMethod]
public List<string> getUserNames(string TextBoxVal)
{
    string strCon;
    List<string> objList = new List<string>();
    strCon = ConfigurationManager.ConnectionStrings["EmpNameFetch"].ConnectionString;
    SqlConnection con = new SqlConnection(strCon);
    SqlCommand cmd = new SqlCommand(@"select EmpName from newTb2 where EmpName like '%"+TextBoxVal+"%'", con);
    con.Open();
    SqlDataReader objReader = cmd.ExecuteReader();

    while (objReader.Read())
    {
        objList.Add(objReader["EmpName"].ToString());
    }
    //Response.Write(objList.ToString());
    //remove the above because you can not use Resonse.Write here
    con.Close();
    return objList;

} 
```

尝试使用 firebug 插件，这将为您提供有关您收到的错误的大量信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T03:53:22.613

为此，我没有调用 AutoCompleteTextBox.aspx 页面，而是添加了一个新服务并调用了 asmx 页面，并在 asmx.cs 页面中添加了这段代码

[System.Web.Script.Services.ScriptService()]

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Services;
using System.Data.SqlClient;
using System.Configuration;

namespace Ajax_Using_Jquery
{
    /// <summary>
    /// Summary description for AutoCompleteFetchService
    /// </summary>
    [WebService(Namespace = "http://tempuri.org/")]
    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
    [System.ComponentModel.ToolboxItem(false)]
    [System.Web.Script.Services.ScriptService()]
    // To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
    // [System.Web.Script.Services.ScriptService]
    public class AutoCompleteFetchService : System.Web.Services.WebService
    {

        [WebMethod]
        public List<string> getUserNames(string TextBoxVal)
        {
            string strCon;
            List<string> objList = new List<string>();
            strCon = ConfigurationManager.ConnectionStrings["EmpNameFetch"].ConnectionString;
            SqlConnection con = new SqlConnection(strCon);
            SqlCommand cmd = new SqlCommand(@"select EmpName from newTb2 where EmpName like '%" + TextBoxVal + "%'", con);
            con.Open();
            SqlDataReader objReader = cmd.ExecuteReader();

            while (objReader.Read())
            {
                objList.Add(objReader["EmpName"].ToString());
            }

            con.Close();
            return objList;

        }

    }
} 
```

在我编码的aspx页面中，

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="AutoCompleteTextBox.aspx.cs" Inherits="Ajax_Using_Jquery.AutoCompleteTextBox" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>Ajax Auto Complete Using Jquery</title>
    <script type="text/javascript" src="JQuery/jquery-1.9.0.mini.js"></script>
    <script type="text/javascript" src="JQuery/jquery-ui.min.js" ></script>
     <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript">
     $(document).ready(function () {
         $(".autosuggest").autocomplete({
             source: function (request, response) {
                 $.ajax({
                     type: "POST",
                     contentType: "application/json; charset=utf-8",
                     url: "AutoCompleteFetchService.asmx/getUserNames",
                     data: "{'TextBoxVal':'" + document.getElementById('txtName1').value + "'}",
                     dataType: "json",
                     success: function (data1) {
                         response(data1.d);
                         if (data1.d == "" || data1.d == null || typeof (data1.d) == 'undefined') {

                             response(["no search found"]);
                         }
                     },
                     error: function (XMLHttpRequest, textStatus, errorThrown) {
                         alert("error " + XMLHttpRequest);
                         alert("error " + textStatus);
                         alert("error " + errorThrown);
                     }
                 });
             }
         });
     });
    </script>
  <%--  <link href="StyleSheet/jquery-ui.css" type="text/css" rel="Stylesheet" />--%>
</head>
<body>
    <form id="form1" runat="server">
    <table>
    <tr>
    <td>
    <div>
    User Name : &nbsp;&nbsp;
        <input type="text" id="txtName1" class="autosuggest"  />
    </div>
    </td>
    </tr>
    </table>
    </form>
</body>
</html> 
```

# deployment - 当您拥有 RDP 访问权限时，如何手动更新 Azure webrole

> ID：15036500
> 
> 赞同：3
> 
> 时间：2013-02-23T02:53:54.520
> 
> 标签：deployment, azure

我相信很多人现在可能都知道 Azure 中断。我正在尝试更新我们的云服务网站（webrole），但几乎所有途径似乎都依赖于 azure 存储（VS2012、TFS 持续部署或门户升级）。至少我是这么认为的，因为他们现在都失败了。

我仍然可以 RDP 进入每个角色，因为我有 4 个角色，这可能是可行的（但不愉快）。一旦我 RDP，我看到

`e:\approot`和`e:\sitesroot\0\`

我启动了任务管理器，杀死了 w3wp.exe 和 WaIISHost.exe（正在使用 MVC4 应用程序的 .dll）并替换了那里的文件，然后重新启动了角色。重新启动后未反映更改。

任何想法如何在您拥有 RDP 时进行更新（并将开发人员的驱动器安装为本地资源以来回复制文件）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T20:34:49.723

好的，所以对我们来说效果很好的解决方案是：

*   从 azure 门户下载 .RDP 文件（选择实例 => 连接）
*   编辑 .rdp 文件 => 本地资源选项卡 => 更多 => 驱动器 => c:（或本地构建所在的任何位置）
*   RDP进入机器
*   在 Windows 资源管理器中，将构建文件从本地计算机（通过 RDP 安装为网络驱动器）复制到`e:\sitesroot\0\`（有时`f:`）
*   通过 IIS 管理器重新启动 IIS（有时需要）
*   希望你的角色不要被回收！

这不是一个永久的解决方案，但在可用性有限的时候效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T03:48:14.613

我自己没有尝试过，但我从 Microsoft 的某个人那里听说，如果您直接使用管理 API（或可能通过[Azure powershell cmdlet](http://msdn.microsoft.com/en-us/library/windowsazure/jj883943.aspx#BKMK_update_service)），您可以进行更改。值得注意的是，作为这次中断 (2013-02-23) 的一部分，您仍然可以使用 http 来访问存储，而不是 https，所以如果在使用 API 时它需要对存储的引用（我很确定这样做新部署确实如此）只需确保您不使用 https。

# eclipse-plugin - eclipse-cs 5.6 插件中是否弃用了 FileTypesFilter？

> ID：15036505
> 
> 赞同：0
> 
> 时间：2013-02-23T02:55:03.783
> 
> 标签：eclipse-plugin, checkstyle

我最近注意到我认为只检查 .java 文件的 checkstyle 配置不再这样做了：

```
<?xml version="1.0" encoding="UTF-8"?>
<fileset-config file-format-version="1.2.0" simple-config="false">
    <local-check-config name="My Checks" location="docu/checkstyle/my-checks.xml" type="project" description="My specific Checkstyle checks">
        <additional-data name="protect-config-file" value="false"/>
    </local-check-config>
    <fileset name="all" enabled="true" check-config-name="My Checks" local="true">
        <file-match-pattern match-pattern="." include-pattern="true"/>
    </fileset>
    <filter name="FileTypesFilter" enabled="true">
        <filter-data value="java"/>
    </filter>
</fileset-config> 
```

他们是否摆脱了“FileTypesFilter”？[高级过滤器文档](http://eclipse-cs.sourceforge.net/advanced_filters.html)似乎表明此功能仍然存在，并且应该比使用文件集执行此操作具有更高的性能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-18T23:01:08.520

我也注意到了这一点。我也不再在 GUI 中看到该选项。医生说

> 有人可能会正确地问为什么这个过滤器存在于你可以使用文件集实现相同的地方。答案很简单：性能。假设您正在将 Checkstyle 插件与包含数个 10,000 个文件的项目一起使用。仅使用文件集将针对可能的多个正则表达式检查项目的所有文件（完整的项目相对路径）。最坏的情况是执行 100,000 次或更多的正则表达式检查以确定是否需要检查文件。

也许这不再是一个问题，或者它被意外删除了。

# asp.net - 显示项目列表。在我的情况下，用户列表

> ID：15036508
> 
> 赞同：0
> 
> 时间：2013-02-23T02:55:18.167
> 
> 标签：asp.net, list, asp.net-mvc-3

我一直在尝试列出数据库中的所有用户，但我很难。我是 MVC3 的新手，请帮忙。:)

这是我的用户列表

```
using System;
using System.Data.Entity;
using System.Collections.Generic;
 using System.Linq;
using System.Web;
using System.ComponentModel.DataAnnotations;
using MVCDemo.Models.DB;
using MVCDemo.Models.ViewModel;

namespace MVCDemo.Models.ViewModel
{

    public class UserList
    {

        public string FirstName { get; set; }
        public string LastName { get; set; }
        public string ContactNumber { get; set; }
        public string Address { get; set; }
        public string Email { get; set; }
        public string Username { get; set; }
        public string Password { get; set; }

     }

    public class Users
    {
        private DeveloperReportEntities dre = new DeveloperReportEntities();
        public UserList _userList = new UserList();

        public Users()
        {
            DB.Users_Tbl userTBL = new DB.Users_Tbl();
            _userList.FirstName = userTBL.FirstName;
            _userList.LastName = userTBL.LastName;
            _userList.Email = userTBL.Email;
            _userList.Address = userTBL.Address;
            _userList.ContactNumber = userTBL.ContactNo;
            _userList.Username = userTBL.Username;
            _userList.Password = userTBL.Password;
         }

    }
} 
```

应该通过这里控制：AdminController

```
 public class AdminController : Controller
    {
        //
         // GET: /Admin/

        public ActionResult AdminHomePage()
        {
             return View();
        }

        public ActionResult ViewAll()
         {
            return View();
         }
     } 
```

在我的解决方案资源管理器中，模型文件夹中有一个 samplemodel.edmx

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T05:05:40.713

首先，该类`Users`应该封装一个`List`. `User`它应该是这样的：

**/Controllers/Admin/AdminController.cs**

```
public class User
{
   public string FirstName { get; set; }
   public string LastName { get; set }
}

public class AdminController : Controller
{
    //
    // GET: /Admin/
    public ActionResult AdminHomePage()
    {
         return View();
    }

    public ActionResult ViewAll()
    {
        var userTBL = new DB.Users_Tbl();
        var users = userTBL.Select(u => new User { FirstName = u.FirstName, LastName = u.LastName };
        return View(users);
    }
 } 
```

**/Views/Admin/ViewAll.cshtml**

```
@model List<User>
<ul>
@foreach(var user in Model)
{
   <li>@user.FirstName @user.LastName</li>
}
</ul> 
```

# axis2 - WSO2 ESB HL7 传输确认问题

> ID：15036513
> 
> 赞同：1
> 
> 时间：2013-02-23T02:55:43.740
> 
> 标签：axis2, wso2, wso2esb

WSO2 ESB 提供了 HL7 传输，这是一个不错的选择。传输以两种模式运行 1) 默认模式：自动确认 2) NACK 模式：无确认 3) ACK 模式：来自下游序列或另一个 HL7 端点的自定义确认。这些模式记录在[http://docs.wso2.org/wiki/display/ESB451/HL7+Transport](http://docs.wso2.org/wiki/display/ESB451/HL7+Transport)。此 JIRA 跟踪器还确认有关模式配置的相同信息。[https://wso2.org/jira/browse/ESBJAVA-954](https://wso2.org/jira/browse/ESBJAVA-954)

我面临的问题是 ACK 模式允许来自下游应用程序或序列的确认返回到已启动对 WSO2 ESB 的调用的应用程序。我可以在日志中清楚地看到下游应用程序或序列正在返回确认，并且正在被 HL7 传输 API 解析。但是，等待 WSO2 ESB 响应的应用程序始终只获得默认确认。

在查看 HL7 传输代码时，看起来 WSO2 代码有缺陷，并且它永远不会从下游序列返回确认。这是来自 HL7ProcessingContext.java 的方法

```
public Message handleHL7Result(MessageContext ctx, Message hl7Msg) throws HL7Exception     
{
    String resultMode = (String) ctx.getProperty(HL7Constants.HL7_RESULT_MODE);
    if (resultMode != null) {
        if (HL7Constants.HL7_RESULT_MODE_ACK.equals(resultMode)) {
            return this.createAck(hl7Msg);
        } else if (HL7Constants.HL7_RESULT_MODE_NACK.equals(resultMode)) {
            String nackMessage = (String) ctx.getProperty(HL7Constants.HL7_NACK_MESSAGE);
            if (nackMessage == null) {
                nackMessage = "";
            }
            return this.createNack(hl7Msg, nackMessage);
        }
    } else if (this.isAutoAck()) {
        return this.createAck(hl7Msg);
    }
    return this.createNack(hl7Msg, "Application Error: ACK/NACK was not explicitely returned");
} 
```

如果我没记错的话，这段代码需要修改如下

```
***** Original Code from above****
if (HL7Constants.HL7_RESULT_MODE_ACK.equals(resultMode)) {
            return this.createAck(hl7Msg);
}

***** Revised code *****
if (HL7Constants.HL7_RESULT_MODE_ACK.equals(resultMode)) {
    OMElement omElement = msgCtx.getEnvelope().getBody().getFirstElement().getFirstElement();
    String xmlFormat = omElement.toString();
    Message message = this.xmlParser.parse(xmlFormat);
    return message;
} 
```

有人可以确认这个修复吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-03-31T08:40:35.230

从 ESB 4.7.0 版本开始，您可以依次使用`HL7_APPLICATION_ACK`hl7 中的属性来等待后端应用程序的响应。

```
<property description="HL7_APPLICATION_ACK" name="HL7_APPLICATION_ACK" scope="axis2" type="STRING" value="true"/> 
```

`AutoAck`在 hl7 代理中参数为 false

`<parameter name="transport.hl7.AutoAck">false</parameter>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T15:55:52.040

现有代码实际上是正确的，如果您仔细查看 JIRA 问题，它已经提到了应该如何使用该功能。所以基本上，用户自己不必创建 ACK HL7 消息的 XML 表示，当他设置一个名为“HL7_RESULT_MODE”的 Axis2 范围消息属性时，这会自动完成，以表示 ACK 或 NACK。因此，基本上使用该功能，下游应用程序/序列可以通过适当地设置消息属性值来选择 ACK 或 NACK。希望这可以解决问题。

干杯，安佳娜。

# firefox - 为什么我不能在 Firefox 中设置 iframe 主体的 innerHtml？

> ID：15036514
> 
> 赞同：2
> 
> 时间：2013-02-23T02:55:55.917
> 
> 标签：firefox, iframe, internals

假设您有一个 iframe，并且您正在使用 javascript 修改它的 contentDocument。

从理论上讲，您可以通过`contentDocument.body.innerHTML`直接设置或使用`contentDocument.write()`

[在 jsbin 上查看此示例](http://jsbin.com/ekoreb/1/edit)

在 chrome 中，两者都可以正常工作。然而，在 Firefox 中，顶部闪烁进出。（在 IE10 中，顶部会抛出一个错误，主体为空，但我不担心 IE）。

两个问题：

*   为什么在Firefox中会发生这种情况？
*   根据规范，哪种行为是“正确的”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T05:56:14.733

在 Firefox 中，当您创建 iframe 时，它​​会开始加载`about:blank`. 然后，您的脚本会与该负载竞争：您修改 DOM，然后 about:blank 加载并清除您的更改。

到目前为止，“规范”并没有定义这里的行为（就像大多数文档加载一样），尽管 webapps 中有一个提案可以这样做。该建议是在这种情况下不应该有 about:blank 加载，而是应该触发一个虚假的加载事件，即使没有发生加载（因为网站依赖于没有 src 触发加载事件的帧）。

# c - C 程序未在 Objective-C 编译器上正确编译

> ID：15036515
> 
> 赞同：-3
> 
> 时间：2013-02-23T02:56:06.343
> 
> 标签：c, objective-c, pointers, int, scanf

我对 Objective-C 比较陌生，我知道它是 C 的超集。但是当我尝试在 GCC 中编译这个 C 代码时，它给了我一个错误，我无法执行代码。

```
 #include <stdio.h>  
  int main(){  
   int x;
   printf("Input int:\n");
   scanf("%d", x);
   printf("%d", x);
    return 0;             
} 
```

当我执行其他代码时，没有错误，但输出错误。注意：唯一的变化是“int *x”。

```
 #include <stdio.h>  
   int main(){  
   int *x;
   printf("Input int:\n");
   scanf("%d", x);
   printf("%d", x);
    return 0;             
}

  INPUT: 3
  OUTPUT: 2147307520 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-23T03:00:48.663

您需要像第一个那样为整数分配空间，但是您需要`scanf()`像第二个那样传递一个指针 - 有点；您需要将整数的地址传递给`scanf()`. 你应该写：

```
#include <stdio.h>  

int main(void)
{  
    int x;
    printf("Input int:\n");
    scanf("%d", &x);
    printf("%d\n", x);
    return 0;             
} 
```

这是现在工作的 C 代码；它也有可能像 Objective C 一样工作。在打印输出的末尾添加换行符也是一个好主意。

# mysql - 计算出多少行，渐近，一个查询将返回 x

> ID：15036516
> 
> 赞同：2
> 
> 时间：2013-02-23T02:56:14.753
> 
> 标签：mysql, sql, math, join

我有下表：

```
CREATE TABLE sample (
  id INT
); 
```

假设我有 x 行。

我这样做`SELECT COUNT(1) FROM sample`并得到 x 回来。

现在说我这样做：

```
SELECT COUNT(1)
FROM sample AS s1
JOIN sample AS s2
  ON s2.id < s1.id; 
```

这让我 (x*(x-1))/2 行回来了。

现在说我这样做：

```
SELECT COUNT(1)
FROM sample AS s1
JOIN sample AS s2
  ON s2.id < s1.id
LEFT JOIN sample AS s3
  ON s3.id < s2.id; 
```

这让我明白了`x*(x-1)*(x-2)/6+(x-1)`。如果我做了一个 JOIN 而不是一个 LEFT JOIN 我会得到回`x*(x-1)*(x-2)/6`行。

```
SELECT COUNT(1)
FROM sample AS s1
JOIN sample AS s2
  ON s2.id < s1.id
LEFT JOIN sample AS s3
  ON s3.id < s2.id
LEFT JOIN sample AS s4
  ON s4.id > s2.id
    AND s4.id < s1.id; 
```

我不知道我会回来多少行。

顺便说一句，最终查询的目的是为您提供第二个 id。例如。

```
SELECT s1.id
FROM sample AS s1
JOIN sample AS s2
  ON s2.id < s1.id
LEFT JOIN sample AS s3
  ON s3.id < s2.id
LEFT JOIN sample AS s4
  ON s4.id > s2.id
    AND s4.id < s1.id
WHERE s3.id IS NULL
  AND s4.id IS NULL; 
```

当 id 有与之关联的用户并且您尝试为特定用户或所有用户查找第二个 id 时，它会更有用。我只是想了解它是如何渐近执行的。

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T21:48:33.613

阅读您对性能和大 O 表示法的评论，我突然明白了您所追求的 - 或者至少我认为我这样做了。

*n*是表中元素的数量，第一次选择的性能是 O( *n* )：

```
SELECT COUNT(1) FROM sample  -> O(n) 
```

在您的第二次选择中，您是对的。它返回 ( *n* *( *n* -1))/2 行。由于等式的平方部分在*n*较大时占主导地位，因此您可以同时删除减法 (-1) 和除法 (/2)。性能为 O( *n²* )。回到您的 SQL 查询，这意味着您可以简单地在 JOIN 子句中删除条件。可以简化为：

```
SELECT COUNT(1) FROM sample, sample   => O(n²) 
```

第三个选择中的 LEFT JOIN 将具有相同的效果。一个简单的左连接 ON (s1.id<s2.id) 将返回额外的 n*(-1) 行，而 INNER JOIN 不会。在大 O 表示法中，无论有无 WHERE 子句，它仍然是 O(n²) *。*所以左加入与否，同样的事情。因此，您的第三个选择将遵循 O( *n³* ) 大*n*。

 *```
SELECT COUNT(1) FROM sample, sample, sample => O(n³) 
```

使用先前的理解，很容易看出您的第四个 SELECT 归结为

```
SELECT COUNT(1) FROM sample, sample, sample, sample => O(n^4) 
```

很容易看出 O() 是如何跟随样本表的记录数和自连接数的。

唯一需要回答的问题是“WHERE rightside.id IS NULL”如何影响系统。根据定义，“SELECT FROM a, LEFT JOIN b where b.key IS NULL”只能返回与表 a 相同或更少的行数。因此，选择可以简化为：

```
SELECT COUNT(1) FROM sample, sample, const, const => O(n²) 
```

一个数据库是否真的像那样执行，或者它是否会构建完整的笛卡尔积然后消除绝大多数行取决于数据库查询优化器的实现，并且必须针对特定的数据库实现来回答。最坏的情况下，数据库将像这样执行：

```
SELECT COUNT(1) FROM sample, sample, sample, sample => O(n^4) 
```

我希望这回答了你的问题。如果不是，我很抱歉......但即便如此，我仍然很高兴剖析你的查询:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T14:44:00.523

这是找到您正在寻找的多项式的一种不太数学的方法。您可以使用您制作的[小提琴](http://sqlfiddle.com/#!2/df034/4)来查找前几个数字的结果。之后，您可以使用[WolframAlpha](http://www.wolframalpha.com/input/?i=polynomial%20%7B%7B2,1%7D,%20%7B3,%203%7D,%20%20%7B4,%208%7D,%20%20%7B5,%2018%7D,%20%20%7B6,%2036%7D,%20%20%7B7,%2066%7D,%20%20%7B8,%20113%7D,%20%20%7B9,%20183%7D%7D)。

结果：x^4/24 - x^3/4 + 35*x^2/24 - 13*x/4 + 3。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T03:51:17.973

您是在寻找两个相同名称的条目，还是在寻找有关查询运行方式的技术解释？

我为 dups 设置了一个[SQLfiddle](http://www.sqlfiddle.com/#!3/cc746/32)，并用一个重复值放入了一些行。它通过向自身查询当前行的值来查找 value 列中的重复值，使用 count() 函数确定是否存在多个。

如果您愿意，您可以运行您拥有的连接查询，但我不会超过两个连接。:)*

# assembly - movzbl 参数

> ID：15036517
> 
> 赞同：2
> 
> 时间：2013-02-23T02:56:28.997
> 
> 标签：assembly, x86

所以我知道 movzbl 0x1(%esi,%eax), %ecx

将零使用 esi+eax+1 将一个字节扩展为一个 long 并将其保存在 ecx 中。但我对 movzbl 0x1(%esi,%eax,1),%ecx 会做什么感到困惑？它会只使用 esi+eax+2 还是我错过了 movzbl 的工作原理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T03:27:28.347

括号中的数字是最后一个（索引）寄存器的比例（或移位）因子，它不仅仅是要添加到其余部分的常数。

学习内存操作数。它们在 Intel/AMD 手册中进行了描述。

# python - 我的程序大部分已完成，但我无法将语句逐行打印

> ID：15036518
> 
> 赞同：0
> 
> 时间：2013-02-23T02:56:32.160
> 
> 标签：python, python-3.x, concatenation

到目前为止我的代码：

```
untranslated = open('english.txt','r')
vowels = ('a','e','i','o','u')
newWords = []

for lines in untranslated:
    words = lines.split()
    for word in words:
        if word[0] in vowels:
            word = word + 'yay'
        else:
            while word[0] not in vowels:
                word = word[1:] + word[0]
            word = word + 'ay'
        print(word) 
```

English.txt 文件的内容：

```
these are lines
meant to be translated
to piglatin 
```

到目前为止，我已经翻译了所有单词，但我的问题是它没有返回到与输入相同的行。

我希望最终结果看起来像：

```
esethay areyay ineslay
eantmay otay ebay anslatedtray
otay iglatinpay 
```

我该怎么做呢？

我得到的是：

```
esethay
areyay
ineslay
eantmay
otay
ebay
anslatedtray
otay
iglatinpay 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T03:00:54.677

我建议先列一个列表，然后再打印元素。

```
for lines in untranslated:
    latin = []
    words = lines.split()
    for word in words:
        if word[0] in vowels:
            word = word + 'yay'
        else:
            while word[0] not in vowels:
                word = word[1:] + word[0]
            word = word + 'ay'
        latin.append(word)
    print(' '.join(latin)) 
```

这将在每一行创建一个新列表。结果单词被附加到列表中，然后我们用 a 连接单词`' '`并打印它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T03:01:48.477

您每行打印一个单词。如果你想每行打印一个句子，你可以使用`join`：

```
pl_words = []

for word in words:
   ...
   pl_words.append(word)

print(' '.join(pl_words)) 
```

或`end`关键字参数`print`：

```
 print(word, end=' ')

print()  # To make a new line 
```

* * *

不过，我会用正则表达式来做：

```
import re

words = '''
    these are lines
    meant to be translated
    to piglatin
'''

vowels = 'aeiou'

def pig_latinize(word):
    if word[0] in vowels:
        return word + 'yay'

    while word[0] not in vowels:
        word = word[1:] + word[0]

    return word + 'ay'

def replacer(match):
    return pig_latinize(match.group())

print(re.sub(r'(\w+)', replacer, words)) 
```

# ios - 在常规 UIViewController 上的 UITableViewCell 中的键盘上方滚动 UITextField

> ID：15036519
> 
> 赞同：28
> 
> 时间：2013-02-23T02:56:36.453
> 
> 标签：ios, ios4

我已经尝试过 StackOverflow 上的大部分示例。我也用过苹果的。我似乎遇到的问题是他们没有考虑到 UITextField 在 UITableView 中。我已经多次这样做了，但不是这样。我有一个带有 UITextField 的自定义 UITableViewCell 。

在我的 UITableView（不是 UITableViewController）上，我需要能够避免将 UITextField 隐藏在 UITableView 下。

我现在有这个：

```
-(void)viewDidLoad
{
....
    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(keyboardWillShow:)
                                                 name:UIKeyboardWillShowNotification
                                               object:nil];

    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(keyboardWillHide:)
                                                 name:UIKeyboardWillHideNotification
                                               object:nil];

....
}

- (void)scrollToRectOfTextField {
    UITableViewCell *cell = (UITableViewCell*)[self.activeTextField superview];
    CGRect r = CGRectMake(self.activeTextField.frame.origin.x,
                          cell.frame.origin.y+self.activeTextField.frame.origin.y,
                          self.activeTextField.frame.size.width,
                          self.activeTextField.frame.size.height);
    [self.tableView scrollRectToVisible:r animated:YES];
}

- (void)keyboardDidShow:(NSNotification *)notification
{
    if (UI_USER_INTERFACE_IDIOM()== UIUserInterfaceIdiomPhone) {
        NSDictionary *userInfo = [notification userInfo];
        CGSize size = [[userInfo objectForKey:UIKeyboardFrameEndUserInfoKey] CGRectValue].size;
        NSLog(@"TableView: %@", NSStringFromCGRect(self.tableView.frame));
        CGRect newTableViewFrame = CGRectMake(self.tableView.frame.origin.x,
                                              self.tableView.frame.origin.y,
                                              self.tableView.frame.size.width, self.tableView.frame.size.height - size.height);
        self.tableView.frame = newTableViewFrame;
        NSLog(@"New TableView: %@", NSStringFromCGRect(self.tableView.frame));

        self.tableView.contentSize = CGSizeMake(self.tableView.contentSize.width, self.tableView.contentSize.height-size.height);
    }
}

- (void)keyboardWillHide:(NSNotification *)notification
{
    NSDictionary *userInfo = [notification userInfo];
    CGSize size = [[userInfo objectForKey: UIKeyboardFrameEndUserInfoKey] CGRectValue].size;
    self.tableView.frame = CGRectMake(self.tableView.frame.origin.x,
                                      self.tableView.frame.origin.y,
                                      self.tableView.frame.size.width,
                                      self.tableView.frame.size.height + size.height);

    NSLog(@"%@", NSStringFromCGRect(self.tableView.frame));
}

-(void)textFieldDidBeginEditing
{
     [self scrollToRectOfTextField];
} 
```

这似乎将一堆空白推过我的键盘。另请注意，我的 UITextField 上也有一个 inputAccessoryView。

哦，我不能使用任何第三方类。我喜欢 TPKeyboardAvoidingScrollView，但我不能使用任何第三方。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-02-23T03:33:41.863

我花了一整天的时间试图弄清楚这一点。我把它贴在这里，然后找到了一个博客链接和一个非常简单的解决方案。它看起来像这样：

```
-(BOOL)textFieldShouldBeginEditing:(UITextField *)textField {
    CGPoint pointInTable = [textField.superview convertPoint:textField.frame.origin toView:self.tableView];
    CGPoint contentOffset = self.tableView.contentOffset;

    contentOffset.y = (pointInTable.y - textField.inputAccessoryView.frame.size.height);

    NSLog(@"contentOffset is: %@", NSStringFromCGPoint(contentOffset));

    [self.tableView setContentOffset:contentOffset animated:YES];

    return YES;
}

-(BOOL)textFieldShouldEndEditing:(UITextField *)textField
{
    [textField resignFirstResponder];

    if ([textField.superview.superview isKindOfClass:[UITableViewCell class]])
    {
        UITableViewCell *cell = (UITableViewCell*)textField.superview.superview;
        NSIndexPath *indexPath = [self.tableView indexPathForCell:cell];

        [self.tableView scrollToRowAtIndexPath:indexPath atScrollPosition:UITableViewScrollPositionMiddle animated:TRUE];
    }

    return YES;
} 
```

[为 iOS 8 检查这个](http://iosdevelopertip.blogspot.in/2014/10/scroll-uitextfield-above-keyboard-in.html)

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2015-08-07T04:52:01.173

我尝试了@inturbidus 为 iOS8 发布的链接，但不幸的是它对我不起作用。经过一番挖掘，事实证明 Apple 在他们的网站上确实有示例代码，可以像在 UITableViewController 中一样自然地完成这项工作。这是 Objective-C 版本的 Apple 链接，我也在此处添加了 swift 版本。

**Apple 的 Objective-C 链接（滚动到清单 5-1）：** [https ://developer.apple.com/library/ios/documentation/StringsTextFonts/Conceptual/TextAndWebiPhoneOS/KeyboardManagement/KeyboardManagement.html](https://developer.apple.com/library/ios/documentation/StringsTextFonts/Conceptual/TextAndWebiPhoneOS/KeyboardManagement/KeyboardManagement.html)

**迅速适应 Objective-C 版本**

```
var activeField: UITextField?

func textFieldDidBeginEditing(textField: UITextField) {
    self.activeField = textField
}

func textFieldDidEndEditing(textField: UITextField) {
    self.activeField = nil
}

func registerForKeyboardNotifications() {
    NSNotificationCenter.defaultCenter().addObserver(self, selector: "keyboardWasShown:", name: UIKeyboardDidShowNotification, object: nil)
    NSNotificationCenter.defaultCenter().addObserver(self, selector: "keyboardWillBeHidden:", name: UIKeyboardWillHideNotification, object: nil)
}    

func keyboardWasShown(aNotification: NSNotification) {
    let info = aNotification.userInfo as! [String: AnyObject],
    kbSize = (info[UIKeyboardFrameBeginUserInfoKey] as! NSValue).CGRectValue().size,
    contentInsets = UIEdgeInsets(top: 0, left: 0, bottom: kbSize.height, right: 0)

    self.tableView.contentInset = contentInsets
    self.tableView.scrollIndicatorInsets = contentInsets

    // If active text field is hidden by keyboard, scroll it so it's visible
    // Your app might not need or want this behavior.
    var aRect = self.view.frame
    aRect.size.height -= kbSize.height

    if !CGRectContainsPoint(aRect, activeField!.frame.origin) {
        self.tableView.scrollRectToVisible(activeField!.frame, animated: true)
    }
}

func keyboardWillBeHidden(aNotification: NSNotification) {
    let contentInsets = UIEdgeInsetsZero
    self.tableView.contentInset = contentInsets
    self.tableView.scrollIndicatorInsets = contentInsets
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2017-06-09T17:22:27.960

我混合了**Matt**和**Salman**的答案。这适用于 tableView 中的许多文本字段。**斯威夫特 3**

基本上是获取textInput的**BOTTOM Y点。**一旦我们有了它，我检查键盘是否覆盖了 textInput，如果这样做，我将更改 tableView 的 contentOffset

首先注册通知。在 init 中如果是 UIView 或在 viewDidLoad 中如果是 UIViewController：

```
 NotificationCenter.default.addObserver(self, selector: #selector(keyboardWillShow), name: NSNotification.Name.UIKeyboardWillShow, object: nil)
    NotificationCenter.default.addObserver(self, selector: #selector(keyboardWillHide), name: NSNotification.Name.UIKeyboardWillHide, object: nil) 
```

然后将触摸的文本字段设置为当前输入

```
var inputActive: UITextField!

func textViewShouldBeginEditing(_ textView: UITextView) -> Bool {
    inputActive = textInput
    return true
} 
```

最后实现通知方法：

```
func keyboardWillShow(notification: NSNotification) {
    var userInfo = notification.userInfo!
    if let keyboardFrame = (userInfo[UIKeyboardFrameEndUserInfoKey] as? NSValue)?.cgRectValue {
        // Get my height size
        let myheight = tableView.frame.height
        // Get the top Y point where the keyboard will finish on the view
        let keyboardEndPoint = myheight - keyboardFrame.height
        // Get the the bottom Y point of the textInput and transform it to the currentView coordinates.
        if let pointInTable = inputActive.superview?.convert(inputActive.frame.origin, to: tableView) {
            let textFieldBottomPoint = pointInTable.y + inputActive.frame.size.height + 20
            // Finally check if the keyboard will cover the textInput
            if keyboardEndPoint <= textFieldBottomPoint {
                tableView.contentOffset.y = textFieldBottomPoint - keyboardEndPoint
            } else {
                tableView.contentOffset.y = 0
            }
        }
    }
}

func keyboardWillHide(notification: NSNotification) {
    tableView.contentOffset.y = 0
} 
```

几件事要补充。**填充**是我在我的情况下添加的一些额外距离，是 20 点。同样在我的情况下， UITableView 被添加到 UIViewController 但这也应该在 UITableViewController 中工作

希望这可以帮助！

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-09-24T04:05:09.027

感谢@Salman 的链接。
请注意，Apple 示例用于普通视图中的滚动视图。
在表格视图中，您必须将 activeField 的 Point 和 Rect 转换为表格的坐标，所以我在函数 keyboardWasShown 中更改了一些行：

```
func keyboardWasShown(aNotification: NSNotification) {
        let info = aNotification.userInfo as! [String: AnyObject],
        kbSize = (info[UIKeyboardFrameBeginUserInfoKey] as! NSValue).CGRectValue().size,
        contentInsets = UIEdgeInsets(top: 0, left: 0, bottom: kbSize.height, right: 0)

        self.tableBasket.contentInset = contentInsets
        self.tableBasket.scrollIndicatorInsets = contentInsets

        var aRect = self.view.frame
        aRect.size.height -= kbSize.height

        let pointInTable = activeField!.superview!.convertPoint(activeField!.frame.origin, toView: tableView)
        let rectInTable = activeField!.superview!.convertRect(activeField!.frame, toView: tableView)

        if !CGRectContainsPoint(aRect, pointInTable) {
            self.tableView.scrollRectToVisible(rectInTable, animated: true)
        }
} 
```

如果您的视图有 tabBarController，请记住使用 tabBar 高度而不是 UIEdgeInsetsZero 重置 contentInsets（如果没有，您的最后一行可能隐藏在 tabBar 下）：

```
func keyboardWillBeHidden(aNotification: NSNotification) {
        //UIEdgeInsetsZero is used in view without tabBar
        //let contentInsets = UIEdgeInsetsZero
        let tabBarHeight = self.tabBarController!.tabBar.frame.height
        let contentInsets = UIEdgeInsets(top: 0, left: 0, bottom: tabBarHeight, right: 0)
        self.tableView.contentInset = contentInsets
        self.tableView.scrollIndicatorInsets = contentInsets
    }
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-08-08T08:03:55.490

我的解决方案（适用于 Xcode 8.3.3、Swift 3、iOS 10.3.1）：

```
class MyTableViewController: UITableViewController {

    override func viewWillAppear(_ animated: Bool) {
        NotificationCenter.default.addObserver(self, selector: #selector(actionKeyboardDidShow(with:)), name: .UIKeyboardDidShow, object: nil)
        NotificationCenter.default.addObserver(self, selector: #selector(actionKeyboardWillHide(with:)), name: .UIKeyboardWillHide, object: nil)
    }

    override func viewDidDisappear(_ animated: Bool) {
        NotificationCenter.default.removeObserver(self, name: .UIKeyboardDidShow, object: nil)
        NotificationCenter.default.removeObserver(self, name: .UIKeyboardWillHide, object: nil)
    }

    @objc private func actionKeyboardDidShow(with notification: Notification) {
        guard let userInfo = notification.userInfo as? [String: AnyObject],
            let keyboardFrame = (userInfo[UIKeyboardFrameBeginUserInfoKey] as? NSValue)?.cgRectValue
            else { return }

        var contentInset = self.tableView.contentInset
        contentInset.bottom += keyboardFrame.height

        self.tableView.contentInset = contentInset
        self.tableView.scrollIndicatorInsets = contentInset
    }

    @objc private func actionKeyboardWillHide(with notification: Notification) {
        guard let userInfo = notification.userInfo as? [String: AnyObject],
            let keyboardFrame = (userInfo[UIKeyboardFrameBeginUserInfoKey] as? NSValue)?.cgRectValue
            else { return }

        var contentInset = self.tableView.contentInset
        contentInset.bottom -= keyboardFrame.height

        self.tableView.contentInset = contentInset
        self.tableView.scrollIndicatorInsets = contentInset
    }

} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-07-03T21:46:57.247

我混合了@Victor 的答案和我拥有的一些代码。我创建了一个方便的扩展，可以在许多 UITextField 中使用。

1.- 首先我们需要一个**UITextField 的扩展**来管理键盘通知

```
extension UITextField {

    func keepTextFieldAboveKeyboard(tableView:UITableView) {

        var willShowNotification: NSObjectProtocol?
        var willHideNotification: NSObjectProtocol?

        willShowNotification = NotificationCenter.default.addObserver(forName: NSNotification.Name.UIKeyboardWillShow, object: nil, queue: OperationQueue.main) {(notification) in

            var userInfo = notification.userInfo!

            if let keyboardFrame = (userInfo[UIKeyboardFrameEndUserInfoKey] as? NSValue)?.cgRectValue {
                // Get my height size
                let myheight = tableView.frame.height
                // Get the top Y point where the keyboard will finish on the view
                let keyboardEndPoint = myheight - keyboardFrame.height
                // Get the the bottom Y point of the textInput and transform it to the currentView coordinates.
                if let pointInTable = self.superview?.convert(self.frame.origin, to: tableView) {

                    let textFieldBottomPoint = pointInTable.y + self.frame.size.height + 20

                    // Finally check if the keyboard will cover the textInput
                    if keyboardEndPoint <= textFieldBottomPoint {

                        tableView.contentOffset.y = textFieldBottomPoint - keyboardEndPoint
                    } else {

                        tableView.contentOffset.y = 0
                    }
                }
            }

            NotificationCenter.default.removeObserver(willShowNotification!)
        }

        willHideNotification = NotificationCenter.default.addObserver(forName: NSNotification.Name.UIKeyboardWillHide, object: nil, queue: OperationQueue.main) { (notification) in

            tableView.contentOffset.y = 0

            NotificationCenter.default.removeObserver(willHideNotification!)
        }

    }

} 
```

2.- 这个之前的扩展应该在**textFieldShouldBeginEditing**中调用，所以我们也可以有一个**扩展**

```
extension UITextField : UITextFieldDelegate {

    public func textFieldShouldBeginEditing(_ textField: UITextField) -> Bool  {

        guard let tableView = textField.parentView(of: UITableView.self) else { return true };

        textField.keepTextFieldAboveKeyboard(tableView:tableView);

        return true;

    }
} 
```

3.- 最后，正如您在前面的方法中注意到的那样，我们需要具有 UITextField 的单元格所在**的 TableView 。**所以我们可以使用这个扩展（这对于其他目的也很有用）

```
extension UIView {
    func parentView<T: UIView>(of type: T.Type) -> T? {
        guard let view = self.superview else {
            return nil
        }
        return (view as? T) ?? view.parentView(of: T.self)
    }
} 
```

4.-最后在**UITextField所在的单元格中**，我们只写这行简单的代码

```
textField.delegate = textField; 
```

完全可重复使用和通用。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-06-19T09:03:16.483

此答案适用于 Xamarin iOS 用户，但有人可以轻松修改它以使其与 Swift 或 Objective C 一起使用。

该解决方案非常简单，并且在我需要一个单元格出现在屏幕的上半部分以使单元格的文本字段位于键盘上方的情况下非常有效。所以我做的是以下内容：

我通过以下方式实现了 textField.ShouldBeginEditing：

```
myTextField.ShouldBeginEditing = textField =>
{
   myTableView.ScrollToRow(indexPath, UITableViewScrollPosition.Top, true);

   return true;
}; 
```

在哪里：

***myTextField***是单元格的文本字段，

***myTableView***是表格视图，

***indexPath***是表格视图中单元格的索引路径。

正如我之前提到的，这个解决方案在我的情况下非常有效，所以我想我可以与你们分享它，以防它也适用于你。快乐编码:)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-07-23T17:48:07.317

[jqgsninimo](https://stackoverflow.com/users/1260976/jqgsninimo)的解决方案更新到 4.2。适用于 iOS 12.0。

**斯威夫特 4.2**

```
override func viewWillAppear(_ animated: Bool) {
    super.viewWillAppear(animated)
    NotificationCenter.default.addObserver(self, selector: #selector(keyboardDidShow(with:)), name: UIResponder.keyboardDidShowNotification, object: nil)
    NotificationCenter.default.addObserver(self, selector: #selector(keyboardWillHide(with:)), name: UIResponder.keyboardWillHideNotification, object: nil)
}

override func viewWillDisappear(_ animated: Bool) {
    super.viewWillDisappear(animated)
    NotificationCenter.default.removeObserver(self, name: UIResponder.keyboardDidShowNotification, object: nil)
    NotificationCenter.default.removeObserver(self, name: UIResponder.keyboardWillHideNotification, object: nil)
}

@objc func keyboardDidShow(with notification: Notification) {
    guard let userInfo = notification.userInfo as? [String: AnyObject],
        let keyboardFrame = (userInfo[UIResponder.keyboardFrameBeginUserInfoKey] as? NSValue)?.cgRectValue
        else { return }

    var contentInset = self.tableView.contentInset
    contentInset.bottom += keyboardFrame.height

    tableView.contentInset = contentInset
    tableView.scrollIndicatorInsets = contentInset
}

@objc func keyboardWillHide(with notification: Notification) {
    guard let userInfo = notification.userInfo as? [String: AnyObject],
        let keyboardFrame = (userInfo[UIResponder.keyboardFrameBeginUserInfoKey] as? NSValue)?.cgRectValue
        else { return }

    var contentInset = self.tableView.contentInset
    contentInset.bottom -= keyboardFrame.height

    tableView.contentInset = contentInset
    tableView.scrollIndicatorInsets = contentInset
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-12-05T07:24:51.623

**在常规 UIViewController swift 3 和 Xcode 8.1 上的 UITableViewCell 中的键盘上方滚动 UITextField**

1) 设置委托 = UITextFieldDelegate

```
 override func viewWillAppear(_ animated: Bool) {

        NotificationCenter.default.addObserver(self, selector: #selector(DayViewController.keyboardWillShow), name:NSNotification.Name.UIKeyboardWillShow, object: nil);
        NotificationCenter.default.addObserver(self, selector: #selector(DayViewController.keyboardWillHide), name:NSNotification.Name.UIKeyboardWillHide, object: nil);

   }
      func textFieldDidBeginEditing(_ textField: UITextField) {
          self.activeField = textField
   }
      func textFieldDidEndEditing(_ textField: UITextField) {
        self.activeField = nil
   }

//MARK: - Keyboard Show and Hide Methods
    func keyboardWillShow(notification: NSNotification)
    {
        let info = notification.userInfo! as! [String: AnyObject],
        kbSize = (info[UIKeyboardFrameBeginUserInfoKey] as! NSValue).cgRectValue.size,
        contentInsets = UIEdgeInsets(top: 0, left: 0, bottom: kbSize.height, right: 0)

        self.FourthTblMainTableView.contentInset = contentInsets
        self.FourthTblMainTableView.scrollIndicatorInsets = contentInsets

        var aRect = self.FourthTblMainTableView.frame
        aRect.size.height -= kbSize.height
    }
    func keyboardWillHide(notification: NSNotification)
    {
         let contentInsets = UIEdgeInsets.zero
        self.FourthTblMainTableView.contentInset = contentInsets
        self.FourthTblMainTableView.scrollIndicatorInsets = contentInsets
    } 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-01-05T09:52:43.187

将@Matt Hudsons 的答案转换为 Swift 4.2 并通过委托进行了改进：

```
func cell(_ cell: UITableViewCell, willStartEditing view: UIView) {
    if let inputAccessoryViewHeight = view.inputAccessoryView?.frame.size.height {
        var contentOffset = self.tableView.contentOffset
        let pointInTable = view.convert(view.frame.origin, to: self.tableView)

        contentOffset.y = pointInTable.y - inputAccessoryViewHeight

        self.tableView.setContentOffset(contentOffset, animated: true)
    }
}

func cell(_ cell: UITableViewCell, willEndEditing view: UIView) {
    view.resignFirstResponder()

    if let position = self.tableView.indexPath(for: cell) {
        self.tableView.scrollToRow(at: position, at: .middle, animated: true)
    }
} 
```

在 UITableViewCell 中实现 UITextFieldDelegate 并传递 UITextField，如下所示：

```
func textFieldShouldBeginEditing(_ textField: UITextField) -> Bool {
    delegate?.cell(self, willStartEditing: textField)
    return true
}

func textFieldShouldEndEditing(_ textField: UITextField) -> Bool {
    delegate?.cell(self, willEndEditing: textField)
    return true
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-03-22T02:49:23.083

在**swift4 中**，我们可以创建**UIViewController**的**扩展**。

 **```
extension UIViewController {
    //MARK: Keyboard user interactions
    func handleContainerViewFrameOnKeyboardShowHide(originalContainerFrame: CGRect) {
        NotificationCenter.default.addObserver(forName: NSNotification.Name.UIKeyboardWillShow, object: nil, queue: OperationQueue.main) {(notification) in
            var info = (notification as NSNotification).userInfo!
            let keyboardFrame: CGRect = (info[UIKeyboardFrameEndUserInfoKey] as! NSValue).cgRectValue
            var tableViewFrame = originalContainerFrame
            tableViewFrame.size.height = originalContainerFrame.size.height - keyboardFrame.size.height
            self.view.frame = tableViewFrame
        }
        NotificationCenter.default.addObserver(forName: NSNotification.Name.UIKeyboardWillHide, object: nil, queue: OperationQueue.main) { (notification) in
            self.view.frame = originalContainerFrame
        }
    }
} 
```**

# python - 在 Python 中的 UDP 套接字上接收 ICMP Host Unreachable 消息

> ID：15036522
> 
> 赞同：3
> 
> 时间：2013-02-23T02:56:49.867
> 
> 标签：python, linux, sockets, udp, icmp

我正在 Linux 2.6.38 上的 Python 2.7 中编写一个简单的 UDP 聊天服务器。

如何读取主机（客户端）在发送 UDP 段以表示无法访问的服务器时收到的 ICMP 错误消息？

我试过了

```
sockFd.setsockopt( socket.IPPROTO_IP, socket.IP_RECVERR, 1 ) 
```

但是**socket.IP_RECVERR**没有在**socket**模块中定义。

我尝试在 sockFd.recvfrom 上使用超时并再次发送到，**但这**没有帮助。是否有 API 可以读取主机收到的 ICMP 错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-08-28T15:15:35.230

这个问题有点老了，但我会回答，因为我遇到了同样的问题。

该常量`IP_RECVERR`在“IN”模块中定义，因此下一条语句应该完成这项工作：

```
import socket
import IN
sockFd.setsockopt( socket.IPPROTO_IP, IN.IP_RECVERR, 1 ) 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-23T03:05:23.607

ICMP 错误基本上是无用的。如果你收到一个错误，那并不能保证另一端没有收到数据包。如果您没有收到错误，则不能确保另一端确实收到了数据包。所以几乎没有理由费心去做这件事。

如果您告诉我们更多关于您认为需要这样做的原因，我们可以告诉您应该怎么做。

# javascript - Mediaelement.js Flashfallback 不起作用

> ID：15036525
> 
> 赞同：0
> 
> 时间：2013-02-23T02:56:58.497
> 
> 标签：javascript, jquery, internet-explorer, firefox, mediaelement.js

如果浏览器不支持文件的 mime 类型，我希望播放我的音频，在 Chrome 和 Firefox 中，我的代码可以工作，但在 IE9 中它会停止工作。

所以这是我的音频片段标记。

```
<audio id="player2" controls="controls">
    source id="mp3_path" src="audio.ogg" type="audio/ogg"></source>
</audio> 
```

这是中介的初始化代码。

```
 $('audio').mediaelementplayer({
        audioWidth: 960,
        audioHeight: 30,
        preload:true,
         plugins: ['flash'],
        features: ['playpause','progress','current','duration','tracks','volume'],
        flashName: 'flashmediaelement.swf',
    }); 
```

结果就是这样。

`Download File`

任何想法在 IE9 中为音频启用 Flash 回退？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T03:03:45.090

你必须定义路径

```
$('audio').mediaelementplayer({
    audioWidth: 960,
    audioHeight: 30,
    preload:true,
     plugins: ['flash'],
    features: ['playpause','progress','current','duration','tracks','volume'],
    pluginPath: '/myflashpath/',
    flashName: 'flashmediaelement.swf',
}); 
```

# java - 使用 JVM 8 时 MySQL Java 连接器无法初始化

> ID：15036526
> 
> 赞同：1
> 
> 时间：2013-02-23T02:56:58.857
> 
> 标签：java, mysql

我在 Arch 下的 Raspberry Pi 上使用 Java 8 EA。我仅限于 Java 8，因为 Arch 是硬浮点支持。当我连接到 MySql 数据库时，出现以下异常：

> 消息：java.lang.VerifyError：（类：com/mysql/jdbc/DatabaseMetaData，方法：supportsRefCursors签名：（）Z）非法使用非虚拟函数调用错误代码：0 java.sql.SQLException：java.lang.VerifyError： （类：com/mysql/jdbc/DatabaseMetaData，方法：supportsRefCursors 签名：（）Z）非法使用非虚函数调用

我对网络进行了研究，常见的建议是降级 JDK，这是我做不到的。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:23:18.790

您可以安装 Java Lambda 版本。Java lambda 版本解决了这个问题。

[http://jdk8.java.net/lambda/](http://jdk8.java.net/lambda/)

# git - 如何使用可以推送的 GitHub 客户端克隆存储库？

> ID：15036528
> 
> 赞同：1
> 
> 时间：2013-02-23T02:57:17.410
> 
> 标签：git, github

如果我的要求没有任何意义，请提前道歉：在 Git 方面我完全是绿色的。我放在 GitHub 上的第一个项目。有问题的软件是多平台的。单个功能更改通常涉及在几种不同的环境中工作（托管在我的 Windows 工作站上的虚拟机中，但我使用 Macbook 的 OSX 除外）。现在使用 SVN，我一直在为每个操作系统提交更改。这显然不是做事的好方法，因为这意味着将东西检入存储库中，这将在其他地方中断。所以我想做的是有一个本地存储库，我可以在最终推送到 GitHub 之前将各种环境中的所有内容推送到其中。但是，当我尝试将更改推送到 GitHub Windows 客户端设置的本地存储库时，Git 抱怨无法推送到非裸存储库。我没有找到将存储库克隆为裸露的选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T03:10:17.120

如果我理解正确，您可以使用分支。您可以拥有您的主分支，或者如您所说，您的“github”存储库，然后每个平台都有一个分支，然后您想要处理的每个功能都是平台分支的一个新分支，如果您想要每个平台分支上都有相同的功能分支，然后您可以`rebase`将功能分支添加到平台分支。

其他选择是拥有不同的[远程存储库](http://gitref.org/remotes/)。

另一种方法是分叉主项目，每个平台一个[分叉](https://help.github.com/articles/fork-a-repo)。它对你来说可能更干净，你甚至可以将你的 fork 合并到 master 中。

# java - 从 VIM 编辑 .java 文件时运行 java 类的最简单方法

> ID：15036529
> 
> 赞同：5
> 
> 时间：2013-02-23T02:58:00.433
> 
> 标签：java, vim, terminal

如果我在 cpp 中编码，在 Vim 中我可以：

```
!g++ % && ./a.out 
```

快速编译和运行代码。

但是，如果我用 Java 编码，在 Vim 中我可以：

```
!javac % 
```

为了快速编译，但为了运行 java 类，我不能这样做：

```
!java % 
```

因为我只需要输入类名（没有结尾的 .java 后缀）

VIM 中是否有一种快速的方法来完成我在 Cpp 中编码时所做的事情？

非常感谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-23T20:42:39.820

Vim 有修饰符，你可以用它来操作文件名。对于您的用例，`:r`修饰符返回*root*，即删除了最后一个扩展名的文件名：

```
:!java %:r 
```

请参阅完整列表`:help filename-modifiers`；它们也可以组合。请注意，对于更复杂的构建，像*Ant*或*Maven*这样的 Java 构建解决方案可能更有效；这些也可以从 Vim 启动；甚至融入其`:make`指挥。

# php - 使用 $app->render() 在 Slim PHP 中指向外部依赖项的相对路径

> ID：15036537
> 
> 赞同：1
> 
> 时间：2013-02-23T02:59:29.577
> 
> 标签：php, html, rest, slim

如果我使用外部依赖项（javascript/css）渲染一个实际的 html 站点

```
$app->render("./somewhere/index.html"); 
```

或者

```
echo "<html>...</html>"; 
```

由于某种原因，slim 无法解析依赖路径 - 因此无法正确加载该站点。一种解决方法是 $app->redirect("./somewhere/index.html"); 而不是 $app->render("./somewhere/index.html"); - 但浏览器地址栏中的 URL 路径也会发生变化。我想避免这种情况，因为我只想为从 URI 接收到的 REST 请求显示一个 HTML 模板 - 所以没有必要重定向到 html 文档并丢失 REST 参数。

我的问题的一个sscce：

目录结构：

```
- index.php
+ templates
|-- index.html
|-- dependency.js
+ Slim
|-- ...
|-- ... 
```

索引.php：

```
<?php
require 'Slim/Slim.php';
\Slim\Slim::registerAutoloader();
$app = new Slim\Slim();
$app->get('/:id', function ($id) use ($app) {
    $app->render('index.html');
});
$app->run();
?> 
```

/模板/index.html：

```
<html>
<head>
    <title>SSCCE</title>
    <script id="someid" type="text/javascript" src="dependency.js"></script>
</head>
<body>
    <a href="javascript:func_test()">Click here</a> 
</body>
</html> 
```

/模板/dependency.js：

```
function func_test() {
  alert("Test");
} 
```

1.) 成功：直接访问 /templates/index.html。（即通过输入 127.0.0.1/templates/index.html）。单击“单击此处”会打开一个消息框。

2.) 失败：从 Slim 访问 index.php 文件（注意：我没有在网络服务器上激活 mod_rewrite - 所以我使用 index.php/.../ 作为 URI 即 127.0.0.1/index.php/睾丸）。html 站点加载正确，但如果我单击“单击此处”，则没有任何反应。

我已经尝试过：src="../dependency.js"、src="../templates/dependency.js" 的不同变体，将 index.html 更改为 php 文件并使用 src="$webroot/templates/dependency .js” - 但没有任何效果。知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T03:20:36.760

我认为您对通常如何使用 Slim（或其他类似的微框架，如 Silex）感到困惑。您的资产（如 JS/CSS/images）不应该与您的路由 url 相关，因为该路由 url 不会直接映射到基于文件系统的资源。应该是绝对的。您的设置应如下所示：

```
Slim/
templates/
  index.html
  whatever.html
images/
js/
  /dependency.js
css/ 
```

所以你所有的 js 引用应该是这样的：

`src="/js/dependency.js"`

除非您想编写某种特殊的控制器来根据模板或其他东西提供正确的资源。但是，如果您的应用程序布局足够复杂以至于需要某些东西，您可能应该使用更像 Symfony2 或 ZF 的东西，它们具有封装完整功能集的模块/捆绑包的概念。

此外，您不应该能够通过 URL 公开访问模板，因为这些模板只能由您的 Slim 控制器提供服务。事实上，我通常不会在文档根目录中有模板。我的正常设置通常看起来像这样（`public`将是网络服务器文档根）：

```
Slim/
templates/
  index.html
public/
  index.php
  js/
  images/
  css/ 
```

# asp.net - 在托管 ASP 站点的 URL 中附加 www（即没有 IIS 访问）

> ID：15036542
> 
> 赞同：2
> 
> 时间：2013-02-23T03:00:21.350
> 
> 标签：asp.net, html, url

我看到很多类似的问题都是用乱码写的，我不明白：

*   [使用 .htaccess 将非 www URL 重定向到 www](https://stackoverflow.com/q/50931/153923)
*   [将不带 www 的 URL 重定向到 www](https://stackoverflow.com/q/2272159/153923)
*   [将非 WWW 重定向到 WWW URL](https://stackoverflow.com/q/7228653/153923)
*   [将 url 重写为非 www 多个站点](https://stackoverflow.com/q/9097298/153923)

我想知道如何使用微软的技术来做到这一点......或者只是向我解释其他人在谈论什么以及如何使用它们。

基本上，如果有人在地址栏中键入“mydomain.com”，我希望它在页面完成加载后解析为“www.mydomain.com”。

**编辑：**这是一个托管网站，所以我无法配置 IIS 服务器。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-23T03:17:17.793

1.  非 www 到 www 重定向
2.  www.yourdomainname.com/default.aspx 到 www.yourdomainname.com

现在在 web.config 中添加配置标签

```
<system.webServer>
<rewrite>
      <rules>
        <rule name="Redirect to WWW" stopProcessing="true">
          <match url=".*" />
          <conditions>
            <add input="{HTTP_HOST}" pattern="^yourdomainname.com$" />
          </conditions>
          <action type="Redirect" url="http://www.yourdomainname.com/{R:0}" redirectType="Permanent" />
        </rule>

        <rule name="Default Document" stopProcessing="true">
          <match url="(.*?)/?default\.aspx$" />
          <action type="Redirect" url="{R:1}/" />
        </rule>
      </rules>
    </rewrite>
  </system.webServer> 
```

（或）选择这个：

```
<rewrite>
    <globalRules>
        <rule name="Redirects to www.domain.com" patternSyntax="ECMAScript" stopProcessing="true">
            <match url=".*" />
            <conditions logicalGrouping="MatchAny">
                <add input="{HTTP_HOST}" pattern="^domain.*(com|net)$" />
                <add input="{HTTP_HOST}" pattern="^(www.)?mydomain2.(com|net)$" />
                <add input="{HTTP_HOST}" pattern="^www.domain.net$" />
            </conditions>
            <action type="Redirect" url="http://www.domain.com/{R:0}" />
        </rule>
    </globalRules>
</rewrite> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T03:13:16.677

这是一个有趣的解决方案。我只是因为你描述的限制而建议它。最好在 IIS 中执行此操作，或者像其他答案所建议的那样使用 HTTP 模块。但是，这也可以，但这不是实现它的好方法。

您可以将此代码放入您的 Page Init 事件处理程序（或母版页的 Init 处理程序）。

```
If Request.RawUrl.StartsWith("http://mydomain") Then
  Response.Redirect(Request.RawUrl.Replace("://", "://www."))
End If 
```

没有. `mydomain`_ `mydomain.com`_`www`

它检查 URL 是否没有 WWW “应该”在的地方。如果它不存在，则将用户重定向到在正确位置有 WWW 的那个页面的版本。

# perl - 以条件的形式输入多个正则表达式？

> ID：15036548
> 
> 赞同：0
> 
> 时间：2013-02-23T03:00:54.600
> 
> 标签：perl

我在这里得到了很好的输入，即对一串核苷酸进行搜索以搜索 3 个核苷酸的重复模式，并要求通过为其构建正则表达式来连续发生 7 次重复。

```
my $regex1 = qr/( ([ACGT]{3}) \2{6,} )/x; 
```

我了解如何扩展它以在 10 行中搜索 2 个 nucs 以及在 7 行中搜索 4 个。

但我想扩展代码，以便用户可以指向他们的输入文件，并检查上述正则表达式以及我需要为其他两个搜索创建的另外两个正则表达式。

编辑：我如何让我的输入文件像上面那样使用多个正则表达式？我在代码中创建了另外两个正则表达式（被哈希符号淘汰）

这是我当前的代码

```
print "Please specify the file location (DO NOT DRAG/DROP files!) then press ENTER:\n";
$seq = <STDIN>;

#Remove the newline from the filename
chomp $seq;

#open the file or exit
open (SEQFILE, $seq) or die "Can't open '$seq': $!";

#read the dna sequence from the file and store it into the array variable @seq1
@seq1 = <SEQFILE>;

#Close the file
close SEQFILE;

#Put the sequence into a single string as it is easier to search for the motif
$seq1 = join( '', @seq1);

#Remove whitespace
$seq1 =~s/\s//g;

#Count of number of nucleotides
#Initialize the variable
$number = 0;
$number = length $seq1;

#Use regex to say "Find 3 nucelotides and match at least 6 times
# qr(quotes and compiles)/( ([nucs]{number of nucs in pattern}) \2{number of repeats,}/x(permit within pattern)
my $regex1 = qr/( ([ACGT]{3}) \2{6,} )/x;
#my $regex = qr/( ([ACGT]){2}) \2{9,} )/x;
#my $regex2 = qr/( ([ACGT]{4}) \2{6,} )/x;

#Tell program to use $regex on variable that holds the file
$seq1 =~ $regex1;

#Now print the results to screen
#This will need to change to printing to a file (WHAT KIND OF FILE?)in the following manner :site, nucelotide match, # of times, length of full sequence
printf "MATCHED %s exactly %d times\n", $2, length($1)/3;
print "Length of sequence: $number\n";
exit; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T03:39:05.653

只需使用一个`for`循环。就像是

```
for my $regex ($regex1, $regex2, $regex3) {
  next unless $seq1 =~ $regex;
  printf "MATCHED %s exactly %d times\n", $2, length($1)/length($2);
} 
```

But you will probably want to change the output to describe the results better.

# maven - 在生命周期映射中更改默认 mojo 配置

> ID：15036550
> 
> 赞同：2
> 
> 时间：2013-02-23T03:00:56.227
> 
> 标签：maven, maven-3, maven-plugin

我正在编写一个 Maven 3 插件，它为另一个应用程序构建插件。插件基本上是一个带有一些精美清单的 JAR 文件。编译后的类需要进行后处理，插件才能与主机应用程序的生产版本一起使用。不幸的是，处理后的插件版本不适用于主机的调试版本。因此，我需要生成两个工件：带有分类器的原始类`debug`和作为主要工件的后处理版本。

我有一个可用的 Maven 插件，它定义了一个具有自己生命周期映射的新包装类型。但是，为了创建`debug`工件，我需要`jar:jar`使用`classifier`属性集进行调用。我还没有找到一种方法来从生命周期映射中更改 Mojo 执行的配置。这甚至可能吗？我是否必须让每个人都使用我的插件提供的超级 POM？

作为参考，这是我的相关部分`components.xml`：

```
<?xml version="1.0" encoding="utf-8" ?>
<component-set>
  <components>
    <!-- snip other components, including ArtifactHandler -->
    <component>
      <role>org.apache.maven.lifecycle.mapping.LifecycleMapping</role>
      <role-hint>my-packaging</role-hint>
      <implementation>org.apache.maven.lifecycle.mapping.DefaultLifecycleMapping</implementation>
      <configuration>
        <lifecycles>
          <lifecycle>
            <id>default</id>
            <phases>
              <!-- snip other phases -->
              <package>
                org.apache.maven.plugins:maven-jar-plugin:jar
              </package>
            </phases>
          </lifecycle>
        </lifecycles>
      </configuration>
    </component>
  </components>
</component-set> 
```

我需要执行等同于这个 POM 片段：

```
<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-jar-plugin</artifactId>
  <executions>
    <execution>
      <id>debug-jar</id>
      <phase>package</phase>
      <goal>jar</goal>
      <configuration>
        <classifier>debug</classifier>
      </configuration>
    </execution>
  </executions>
</plugin> 
```

我发现[一个 SO 问题](https://stackoverflow.com/questions/6218769/providing-configuration-for-existing-plugins-in-maven-lifecycle-mapping)似乎与我正在寻找的东西相同，但它没有任何答案。[这是](http://www.sonatype.com/people/2009/08/create-a-customized-build-process-in-maven/)我最初用来创建生命周期映射的文档。大量谷歌搜索没有出现任何似乎相关的内容，但我无法找到足够具体的搜索词。

# python - 拆分十六进制的最佳方法？

> ID：15036551
> 
> 赞同：3
> 
> 时间：2013-02-23T03:00:58.720
> 
> 标签：python, hex

一般来说，我对十六进制很陌生，而且我有一个需要我拆分十六进制数字的应用程序。例如，给定数字 0x607F，我需要返回高 (0x60) 或低 (0x7F) 字节。

这是可能的实现，但感觉有点混乱。在python中有没有更标准的方法来做到这一点？

```
def byte(integer,highlow):
    assert highlow=='high' or highlow=='low'
    if highlow=='high':
        return hex(int(bin(integer)[:-8],2))
    if highlow=='low':
        return hex(int(bin(integer)[-8:],2)) 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-23T03:03:49.817

这将高字节和低字节作为元组返回：

```
def bytes(integer):
    return divmod(integer, 0x100) 
```

例如：

```
>>> high, low = bytes(0x607F)
>>> hex(high)
'0x60'
>>> hex(low)
'0x7f' 
```

顺便说一句，根据您需要字节的用途以及整数的来源，可能会有更好的方法来满足您的需求。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-23T03:14:05.573

```
def bytes(num):
    return hex(num >> 8), hex(num & 0xFF)

bytes(0x607F) 
```

产量

```
('0x60', '0x7f') 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-04-20T00:06:42.100

为了补充 Ned 非常正确的答案，[struct](https://docs.python.org/3.5/library/struct.html)是提取字节的强大工具。

```
>>> import struct
>>> print("0x%2x 0x%2x\n" % tuple(struct.pack('<H',0x4355)))
0x55 0x43 
```

在这个例子中，“<”告诉 pack 将输入解释为[little-endian](https://en.wikipedia.org/wiki/Endianness)，而“H”表示期望一个 2 字节的数字。Struct 生成一个字节对象（在 Python 3 上），然后可以将其转换为元组以满足 %x 的字符串格式参数以打印出十六进制。

Python 2.7 稍微麻烦一些，只是因为 struct.pack 将信息放在一个字符串中，该字符串必须[拆分成字符](https://stackoverflow.com/questions/4978787/how-to-split-a-string-into-array-of-characters-with-python)：

```
>>> print("0x%2x 0x%2x\n" % tuple([ ord(x) for x in struct.pack('<H',0x4355)]))
0x55 0x43 
```

如果你真的*在*做像这个例子一样简单的事情，那可能是矫枉过正。如果您要处理更多值或不同长度的数字，例如，从微控制器观察到的寄存器，或者与 C 或 C++ 交换数据，请考虑使用 struct 以更容易地处理字节。

# android - 为什么我的安卓模拟器在使用函数调用图库时会失败？

> ID：15036554
> 
> 赞同：0
> 
> 时间：2013-02-23T03:01:42.267
> 
> 标签：android, android-emulator

我有一个可以调用画廊的 android 应用程序，以便用户可以选择图片。但它会返回此错误的宝贵活动。

`The application Camera(process.com.android.gallery) has stopped unexpectedly. Please try again.`

我为模拟器启用了一个摄像头，为 SD 卡添加了 64 MB。它仍然不起作用？虽然我没有添加任何图像文件，因为我不知道如何但它不应该正常工作吗？它在“画廊”顶部显示一个带有标题的黑色背景，然后它崩溃了。

当我为它制作 apk 时，该功能适用​​于我的平板电脑。但问题是，我无法在平板电脑上调试应用程序的其他部分，所以我真的需要让它在模拟器上正常运行才能解决其他问题。另外，我的平板电脑无法连接到adb，因为它是中国制造的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T03:21:44.480

AFAIK 模拟器上没有图库应用程序。所以你必须在真实的​​设备上运行它。

# c++ - 搜索集合

> ID：15036566
> 
> 赞同：0
> 
> 时间：2013-02-23T03:03:41.407
> 
> 标签：c++, iterator, traversal, set

我在尝试通过一组字符串时遇到了一些困难。用于向量和数组的方法在这里不起作用；我尝试了很多方法来遍历一个集合，包括调用一个迭代器，但编译器不会买它。我在网上看过，但没有答案似乎很正确。

域.h

```
#ifndef DOMAIN_H_
#define DOMAIN_H_
#include <sstream>
#include <string>
#include <set>

using namespace std;

class Domain {
public:
Domain();
virtual ~Domain();
void add(string added_domain);

    string toString();

private:
  set<string> the_domain;
  };

#endif /* DOMAIN_H_ */

Domain.cpp
    include "Domain.h"
    include <string>
    include <set>

Domain::Domain() {
    // TODO Auto-generated constructor stub

}

Domain::~Domain() {
    // TODO Auto-generated destructor stub
}

void Domain::add(string added_domain)
{
    the_domain.insert(added_domain);
}

string Domain::toString()
{
    // insert here
} 
```

希望我不需要再问这个了。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T03:22:19.600

```
bool Domain::searchForString(const string &str)
{
  return(the_domain.find(str) != the_domain.end());
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T03:36:41.393

您可以使用迭代器：

```
std::set<std::string> strs;
for( std::set<std::string>::const_iterator it = strs.begin(); it != strs.end; ++i ) { 
   std::cout << *it << std::endl;
} 
```

您可以使用 boost foreach：

```
std::set<std::string> strs;
BOOST_FOREACH( const std::string &str, strs ) {
   std::cout << str << std::endl;
} 
```

你可以使用 std::foreach

```
struct out { void operator()( const std::string &str ) { std::cout << str << std::endl; }
std::set<std::string> strs;
std::foreach( strs.begin(), strs.end(), out() ); 
```

您可以使用 c++11 范围循环：

```
std::set<std::string> strs;
for( const auto &str: strs ) {
   std::cout << str << std::endl;
} 
```

您可以使用其他 std 容器，而不仅仅是使用相同的代码而不是 std::set。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T03:46:58.337

```
#include <sstream>

string Domain::toString() const {
    std::ostringstream ss;

    for (const auto& s : strs) {
        ss << s << std::endl;
    }

    return ss.str();
} 
```

# php - PHP：根据 php.ini 配置文件中的配置（tmp_upload_dir 参数）上传特定目录中的文件而不是目录

> ID：15036569
> 
> 赞同：0
> 
> 时间：2013-02-23T03:04:00.050
> 
> 标签：php

我们在 Linux 机器上上传用 PHP 开发的文件功能时遇到了困难。该文件总是被上传到 /tmp 目录中，该目录被配置为 php.ini 文件中 tmp_upload_dir 参数的值。我们试图将文件上传到不同的目录，但它出错了。有没有一种方法可以动态覆盖 tmp_upload_dir 的默认值（通过程序/代码）或将文件上传到 php.ini 文件中配置的目录以外的其他目录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T03:06:56.317

```
ini_set('upload_tmp_dir', 'your_directory_goes_here'); 
```

[http://in2.php.net/manual/en/function.ini-set.php](http://in2.php.net/manual/en/function.ini-set.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T03:08:57.893

上传后为什么不移动文件？检查此[功能](http://php.net/manual/en/function.move-uploaded-file.php)和示例

# javascript - 为什么我的网站可以使用 Safari，但不能使用 FireFox 或 IE？

> ID：15036571
> 
> 赞同：0
> 
> 时间：2013-02-23T03:04:34.380
> 
> 标签：javascript, css, html, firefox, safari

我正在为一家小型摄影企业制作一个简单的网站。一切都很顺利，直到我在 Firefox 中进行测试。我注意到它完全不起作用。您可以在[此处](http://www.jeffreyaphoto.com/)找到该网站。

我在文本和图像之上有一个图像映射。当您单击图像地图中的某个区域时，它将根据您单击的位置更改左框架。问题出在 Firefox 中，它不起作用。我在索引页面中有所有的 CSS 和 Javascript。任何人都可以帮助我让这个工作普遍吗？

如果我的代码看起来很业余，那可能是因为我在专业环境中没有太多经验。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T03:09:22.500

您没有指定文档类型 .. 这将触发 IE 以[Quirks 模式呈现您的页面](http://www.cs.tut.fi/~jkorpela/quirks-mode.html)

为防止这种情况发生，`<!DOCTYPE html>`请在文件顶部包含一个 doctype，并确保其前面没有注释或空白。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T03:11:58.217

iframe`src`中的斜杠不是正斜杠，而是反斜杠。将它们切换为正斜杠，您的 iframe 将开始显示。

这是有同样问题的人：http: [//support.mozilla.org/en-US/questions/737230](http://support.mozilla.org/en-US/questions/737230)

> 我有同样的问题。我的 iFrame 可以在 IE 和 Chrome 中使用，但不能在 Firefox 中使用。将斜杠从斜杠更改为正斜杠，现在一切正常。这个在FF中不起作用

```
 <IFRAME src="\myride\TheRider\index.html" width="640" height="640" 
    frameborder="no"></IFRAME> 
```

> 这个很好用！

```
<IFRAME src="/myride/TheRider/index.html" width="640" height="640" 
    frameborder="no"></IFRAME> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-22T22:46:43.050

Firefox 可能不显示 iframe 内容的另一个原因是，如果您所在的页面是 https，但 iframe 中引用的页面只是 http，则 iframe 中引用的 URL 将被阻止。

# ruby-on-rails - 从多维数组中提取哈希值？

> ID：15036576
> 
> 赞同：0
> 
> 时间：2013-02-23T03:05:45.730
> 
> 标签：ruby-on-rails, ruby, multidimensional-array, nokogiri

我正在将 HTML 解析为一个数组，如下所示。我可以将数据放入数组，然后将数据推送到数据库中。数组数据的一行是：

```
{:address=>"6222 Lodgepole Dr", :members=>["Diana L Dillard", "Kemberly J Williams", "George S Williams Iii"]} 
```

数据库结果为：

```
Master                 Neighbor                     Name

7545 XYZ Dr     --- - 8283 Southern Watch Pl    --- - - Diana L Dillard - Kemberly J Williams - George S Williams Iii 
```

这些是我的问题：

1.  如何让`Address.create`循环仅将数组中的第一个成员（在此示例`Diana L Dillard`中）插入“名称”字段而不是所有名称？理想情况下，我想为第一个字段创建一个字段，然后为所有其他字段创建另一个字段。
2.  为什么我的数据中会插入这些破折号“---”？我不想要他们。

这是我当前的代码：

```
url = "XYZ"

doc = Nokogiri::HTML(open(url))

results = []

# parse .single tags
doc.css('.single').each do |single_div|

  res = {}
  res[:address] = single_div.at_css('span.address').text
  res[:members] = single_div.css('li.basic_info').collect{|el| el.text.strip}
  results << res
end

results.each do|address|
  puts "#{address}: #{members}"
  Address.create(:neighboradd => "#{address}", :master => '7545 XYZ Dr', :name => "{members}")
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T03:24:28.690

这个

```
results.each do |address|
  puts "#{address}: #{members}"
  Address.create(
    :neighboradd => "#{address}",
    :master => '7545 XYZ Dr',
    :name => "{members}"
  )
end 
```

应该是这样的

```
results.each do |res|
  puts "#{res[:address]}: #{res[:members]}"
  Address.create(
    :neighboradd => res[:address],
    :master => '7545 XYZ Dr',
    :name => res[:members].join(', ') # this should be "#{res[members]}"? (with "#")
  )
end 
```

这`---`是因为您将整个哈希用于`:neighboradd`.

如果您只想要第一个成员：

```
 :name => res[:members].first 
```

# scala - Scala 默认参数来自其他参数

> ID：15036577
> 
> 赞同：3
> 
> 时间：2013-02-23T03:06:06.657
> 
> 标签：scala

我正在尝试执行以下操作，但编译器不高兴...

```
def foo(db: Database = ctx.defaultDB)(implicit ctx: Context) 
```

也就是说，如果未指定 db，则使用 ctx 查找默认值。编译器不喜欢这个版本，所以我尝试了这个：

```
def foo(ctx: Context, db: Database = ctx.defaultDB) 
```

编译器也不喜欢这样...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T03:31:24.847

默认参数值有很多限制。

我建议重载：

```
def foo(db: Database)(implicit ctx: Context) = ...

def foo(implicit ctx: Context): Type = foo(ctx.defaultDB)(ctx) 
```

我不确定确切的要求是什么，但我的快速测试表明你必须明确第二次重载的返回类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T03:37:49.897

怎么样：

```
def foo(dbOption: Option[Database] = None)(implicit ctx: Context) {
  val db = dbOption.getOrElse(ctx.defaultDB)
  ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T20:28:10.220

怎么样

```
def foo(db: Database = implicitly[Context].defaultDB) = ??? 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-23T03:24:53.963

这个：

```
def foo(ctx:Context)(db:Database = ctx.defaultDB ) 
```

当然，这不是隐含的。您可能可以通过以下技巧使其隐含：

```
def foo(implicit ctx:Context) = {
  class XXX {
    def apply(db:Database = ctx.defaultDB) = ...
  }
  new XXX(ctx)
} 
```

但是，这不会像您期望的那样工作，因为`foo(x)`将`x`作为隐式传递，并`foo()(x)`会给出错误。只有`foo.apply(x)`会起作用，这很糟糕。

# windows - 如何将可执行文件的输出作为 Windows CMD 中另一个可执行文件的参数之一传递？

> ID：15036578
> 
> 赞同：0
> 
> 时间：2013-02-23T03:06:12.820
> 
> 标签：windows, cmd, pipe

如题，

我需要在我的程序中处理数据，

这些数据是现有可执行文件所需要的。

而且我想通过管道传递数据，而不是将数据写入文件。

我的平台是 Windows 7。

任何人都可以帮助我吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T11:57:27.297

您不能使用管道将输出作为参数传递给另一个程序。管道将一个进程的 STDOUT 与另一个进程的 STDIN 连接起来。

如果您希望将第一个进程的输出用作第二个进程的参数，您可以执行以下操作：

```
@echo off

setlocal EnableDelayedExpansion

for /f "tokens=*" %%a in ('p1.exe') do set output=!output! %%a

p2.exe "%output%" /foo /bar ...

endlocal 
```

# php - 不同页面上的不同菜单

> ID：15036582
> 
> 赞同：1
> 
> 时间：2013-02-23T03:07:08.810
> 
> 标签：php, wordpress, header

试图在不同的页面上有不同的导航菜单。我的主题不允许我编辑功能页面。我创建了一个新的标题模板和页面模板。我想更改新标题模板中使用的菜单，但我不明白下面的代码是什么意思，所以我不确定要更改什么。

我正在努力学习，有人可以帮助翻译这段代码的含义吗？

```
<ul id="menu-hosting-menu" class="curved">
                    <?php if ( is_page() ) $highlight = 'page_item'; else $highlight = 'page_item 

current_page_item'; ?>
                    <li class="<?php echo $highlight; ?> menu-item menu-item-type-custom menu-item-object-custom"><a href="<?php echo home_url( '/' ); ?>">Home</a></li>
                    <?php wp_list_pages( 'sort_column=menu_order&depth=3&title_li=&exclude=' ); ?>
                </ul><!-- /#nav -->
                <?php }  ?>

                 <select> 
                    <option value="" selected="selected">Select</option> 
                    <?php
                    $menu_name = 'primary-menu'; //same as theme_location
                    if ( ( $locations = get_nav_menu_locations() ) && isset( $locations[ 

 $menu_name ] ) ) {
                        $menu = wp_get_nav_menu_object( $locations[ $menu_name ] );
                        $menu_items = wp_get_nav_menu_items($menu->term_id);
                        var_dump($menu_items);
                        foreach ( (array) $menu_items as $key => $menu_item ) {
                            $title = $menu_item->title;
                            $url = $menu_item->url;
                            if($menu_item->menu_item_parent){
                                $title = '-- '.$title;
                            }
                            $menu_list .= '<option value="' . $url . '">' . $title . 

 '</option>'; 
   }} else {
                        $menu_list .= '<option  value="">Menu "' . $menu_name . '" not 

defined.</option>';
                    }
                    echo $menu_list;
                    ?>
                  </select> 

        </nav> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T03:51:34.690

您是要在全新模板上加载菜单，还是仅在特定页面上加载菜单？

我想一个（简单的）方法是创建一个新的页面模板和一个新的标题。然后，您只需告诉新页面模板（可在 CMS 的管理面板中选择）也调用新的（自定义）标题。

关于如何做到这一点的一个很好的解释可以在这里找到：

[http://reflectingthedesigner.com/wordpress/2011/10/24/creating-a-new-wordpress-page-template/](http://reflectingthedesigner.com/wordpress/2011/10/24/creating-a-new-wordpress-page-template/)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T04:13:48.670

弄清楚了。我刚刚删除了上面的所有代码并将其替换为

```
<?php wp_nav_menu( array('menu' => 'Hosting' )); ?> 
```

像魅力一样工作。

# c# - 多个参数的 Lambda 表达式

> ID：15036584
> 
> 赞同：33
> 
> 时间：2013-02-23T03:07:25.863
> 
> 标签：c#, linq

我理解 lambda 表达式本质上是一个内联委托声明，以防止额外的步骤

例子

```
delegate int Square(int x)
public class Program
{
   static void Main(String[] args)
   {
      Square s = x=>x*x;
      int result = s(5);
      Console.WriteLine(result); // gives 25
   }
} 
```

如何将 Lambda 表达式应用于多参数？

```
 delegate int Add(int a, int b)
 static void Main(String[] args)
 {
    // Lambda expression goes here
 } 
```

如何使用 Lambda 表达式表达多参数？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-02-23T03:10:12.947

您必须了解[Func](http://msdn.microsoft.com/en-us/library/bb549151.aspx)行为，其中最后一个参数始终是*输出*或*结果*

> 函数<1, 2, 输出>

```
Func<int, int, int> Add = (x, y) => x + y;

Func<int, int, int> diff = (x, y) => x - y;

Func<int, int, int> multi = (x, y) => x * y; 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-02-23T03:09:18.953

是的。当您有非一个（零或 > 1）的 lambda 参数时，请在它们周围使用括号。

例子

```
Func<int, int, int> add = (a,b) => a + b;

int result = add(1, 3);

Func<int> constant = () => 42;

var life = constant(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-01-06T17:06:42.763

```
delegate int Multiplication(int x, int y)
public class Program
{
   static void Main(String[] args)
   {
      Multiplication s = (o,p)=>o*p;
      int result = s(5,2);
      Console.WriteLine(result); // gives 10
   }
} 
```

# mod-rewrite - 编写包含没有索引内容的段的 URL 是否会受到 SEO 惩罚？

> ID：15036585
> 
> 赞同：2
> 
> 时间：2013-02-23T03:07:43.237
> 
> 标签：mod-rewrite, seo

我正在开发一个基于引导的响应式网站。主网站导航中的下拉菜单通过单击而不是悬停打开。每个部分没有索引内容，下拉列表中只有特定的页面链接。

内容位于以下位置是否有任何 SEO 处罚：

www.mysite.com/books/moby-dick

什么时候

www.mysite.com/books

导致404错误？

如果必须，我可以生成带有指向所有孩子的链接的索引页面，但我宁愿避免创建任何不打算直接查看的内容。

我想使用 mod_rewrite 按“文件夹”组织页面，此时我已经很好地处理了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T03:13:23.443

按照我的理解，搜索引擎在一个页面的 URL 上与另一个页面的 URL 没有相关性。您是否正在寻找一些文档。您在哪个搜索引擎上寻找文档？我什至不确定这种类型的信息是否被“记录”，但如果你仔细想想，URL 中的单词顺序只对我们人类有意义。引擎不会将链接的重要性放在 url 层次结构的上层或下层。这没有任何意义。

我什至认为您的页面 moby-dick 不会对域主页产生正面/负面影响。Google 至少将每个 URL 视为一个唯一页面，因此采用了“页面排名”算法。不是站点层次结构算法。

# python - 将值与列表匹配

> ID：15036586
> 
> 赞同：0
> 
> 时间：2013-02-23T03:07:45.003
> 
> 标签：python

我有两个变量，如下所示。目标是检查 baseAU 变量中的值是否与“out”匹配。最简单的方法是什么？一种方法是拆分并放入一个列表并对其进行解析。还有其他简单的方法吗？

```
baseAU = "AU_LINUX_ANDROID_test.04.02.01.40.144"

out=
"
AU_LINUX_ANDROID_test.04.02.01.40.134
AU_LINUX_ANDROID_test.04.02.01.40.135
AU_LINUX_ANDROID_test.04.02.01.40.136
AU_LINUX_ANDROID_test.04.02.01.40.137
AU_LINUX_ANDROID_test.04.02.01.40.138
AU_LINUX_ANDROID_test.04.02.01.40.139
AU_LINUX_ANDROID_test.04.02.01.40.140
AU_LINUX_ANDROID_test.04.02.01.40.141
AU_LINUX_ANDROID_test.04.02.01.40.142
AU_LINUX_ANDROID_test.04.02.01.40.143
AU_LINUX_ANDROID_test.04.02.01.40.144
AU_LINUX_ANDROID_test.04.02.01.40.145
AU_LINUX_ANDROID_dev.04.02.01.49.106
AU_LINUX_ANDROID_dev.04.02.01.49.107
AU_LINUX_ANDROID_dev.04.02.01.49.108
AU_LINUX_ANDROID_dev.04.02.01.49.109
AU_LINUX_ANDROID_dev.04.02.01.49.110
AU_LINUX_ANDROID_dev.04.02.01.49.111
AU_LINUX_ANDROID_dev.04.02.01.49.112
AU_LINUX_ANDROID_dev.04.02.01.49.113
AU_LINUX_ANDROID_dev.04.02.01.49.114
AU_LINUX_ANDROID_dev.04.02.01.49.115
AU_LINUX_ANDROID_dev.04.02.01.49.116
AU_LINUX_ANDROID_dev.04.02.01.49.117
AU_LINUX_ANDROID_dev.04.02.01.49.118
" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T03:16:01.770

将您的字符串拆分为一个列表：

```
baseAU in out.split() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T03:16:31.807

一种方法是匹配字符串，使用`in`

```
if baseAU in out:
   print "Have match" 
```

一种更方便的方法是将`out`变量分解为集合，并使用集合`in`运算符。这应该更有效率。

```
s = set(out.split())
if baseAU in s:
    print "Have match" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T03:33:42.187

将字符串与行匹配的简单方法：

```
if "%s\n" % baseAU in out:
    print "Match" 
```

AU_LINUX_ANDROID_test.04.02.01.40.14 将与 AU_LINUX_ANDROID_test.04.02.01.40.144 不匹配

# python - 如何修复“TypeError：+ 的不支持的操作数类型：'NoneType' 和 'str'”？

> ID：15036594
> 
> 赞同：16
> 
> 时间：2013-02-23T03:10:01.223
> 
> 标签：python, python-3.x, string, input, typeerror

我不确定为什么会收到此错误

```
count=int(input ("How many donuts do you have?"))
if count <= 10:
    print ("number of donuts: " ) +str(count)
else:
    print ("Number of donuts: many") 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-23T03:10:58.190

在 python3 中，*是*`print`一个返回. 所以，这条线：*`None`*

 *```
print ("number of donuts: " ) +str(count) 
```

你有`None + str(count)`。

您可能想要的是使用字符串格式：

```
print ("Number of donuts: {}".format(count)) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-23T03:11:32.150

你的括号在错误的位置：

```
print ("number of donuts: " ) +str(count)
                            ^ 
```

把它移到这里：

```
print ("number of donuts: " + str(count))
                                        ^ 
```

或者只使用逗号：

```
print("number of donuts:", count) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T03:12:42.450

在 Python 3中*print*不再是一个语句。你想做的，

```
print( "number of donuts: " + str(count) ) 
```

而不是添加到 print() 返回值（即无）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-07-28T09:15:38.137

现在，使用 python3，您可以使用`f-Strings`：

```
print(f"number of donuts: {count}") 
```*

# mysql - Ruby on Rails 通过迁移添加另一个索引导致超过 64 个字符的限制

> ID：15036595
> 
> 赞同：2
> 
> 时间：2013-02-23T03:10:11.347
> 
> 标签：mysql, ruby-on-rails, ruby-on-rails-3, activerecord, rails-migrations

我想在我的索引表中添加另一个索引列，但是收到的表索引太长；限制为 64 个字符。顺便说一句，Rails 3 和 MySQL DB。

当前架构如下：

```
 create_table "admin_users_projects", :force => true do |t|
    t.integer "admin_user_id"
    t.integer "project_id"
  end

  add_index "admin_users_projects", ["admin_user_id", "project_id"], :name =>     "index_admin_users_projects_on_admin_user_id_and_project_id" 
```

我正在尝试运行以下迁移来添加索引：

```
class AddIndexToAdminUsersProjects < ActiveRecord::Migration
  def change
    add_index :index_admin_users_projects_on_admin_user_id_and_project_id,     :admin_users_project_id
  end
end 
```

但是在尝试 rake 时得到以下信息（简而言之）：

```
Larrys-MacBook-Pro:scrumtool larrydavid$ rake db:migrate
==  AddIndexToAdminUsersProjects: migrating ===================================
-- add_index(:index_admin_users_projects_on_admin_user_id_and_project_id,     :admin_users_project_id)
rake aborted!
An error has occurred, all later migrations canceled:

Index name     'index_index_admin_users_projects_on_admin_user_id_and_project_id_on_admin_users_project_id'     on table 'index_admin_users_projects_on_admin_user_id_and_project_id' is too long; the limit     is 64 characters
[...] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T03:24:52.140

尝试这个

```
class AddIndexToAdminUsersProjects < ActiveRecord::Migration
  def change
    add_index :admin_users_project, [:admin_users_id, :project_id], :name => 'index_admin_projects_on_admin_and_project'
  end
end 
```

# javascript - 从 UIWebView 隐藏元素

> ID：15036598
> 
> 赞同：1
> 
> 时间：2013-02-23T03:10:18.680
> 
> 标签：javascript, ios, uiwebview, uiwebviewdelegate

我有一个我`UIWebView`在其中加载一个`NSURLRequest`. 我无法完全控制所显示页面的 html，但我知道它将包含一个元素，该元素具有我事先知道的 id。假设它是`submmit_form_button`。

我不希望应用程序的用户看到这个元素。我想在它出现在`UIWebView`.

这样做的最佳选择是什么？在控制器中显示`UIWebView`我应该将解决此问题的代码放在哪里？我知道我可以为此使用 Javascript。我更关心如何在本机 iOS 应用程序的上下文中处理此问题，该应用程序显示`UIWebView`从外部源获取它的 html。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T03:31:34.840

按照@Ric评论的引导，我解决了这个问题

```
- (void)webViewDidFinishLoad:(UIWebView *)webView {
    [webView stringByEvaluatingJavaScriptFromString:@"document.getElementById('submmit_form_button').style.display = 'none'"];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-16T12:14:33.013

为了用“;”隐藏同一单独行中的**多个项目**。

这是 Swift 中的示例：-

```
let items = "document.getElementById('item_1').style.display='none';" 
            + "document.getElementById('item_2').style.display='none'"

webView.stringByEvaluatingJavaScript(from: items) 
```

# android - 收到错误 Adob e AIR 版本未安装错误

> ID：15036611
> 
> 赞同：2
> 
> 时间：2013-02-23T03:11:43.623
> 
> 标签：android, air, flash-builder

尝试在 Android 上调试我的 AIR 应用程序时出现错误，“设备似乎处于脱机状态”。它曾经工作过。我已经安装了 AIR。我不确定发生了什么变化。我想也许 AIR 已经更新，这改变了一些东西，但我猜。

我附上了一张图片。

![在此处输入图像描述](../Images/c70583605825f551f1143dbb17a0341a.png)

我已经重启了几次设备。我正在使用 Flash Builder 4.7。我安装了 AIR 3.6.0.597。USB 调试已启用。它还作为媒体设备 (MTP) 连接，我可能不小心打开了它（但我不确定，而且似乎没有办法将其关闭）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-24T20:20:02.910

我最近还更新到 Jelly Bean 4.2.2，现在 Flash Builder 也显示了同样的内容。

Adobe AIR 版本：未安装状态：离线

操作系统：Windows 8。设备：Nexus 7。IDE：Flash Builder 4.6。空气：3.4。

如上所述，1.21 gigawatts 指出了[一个链接](http://forums.adobe.com/message/5086305)，该链接指向带有此建议的线程：

> 同一条船，从 \android-sdk\platform-tools 复制这些文件：aapt.exe、adb.exe、AdbWinApi.dll、AdbWinUsbApi.dll 和 dx.jar（在 lib 代表下）并粘贴到 \lib\android\bin
> 到检查，磁带在 cmd $ adb.exe 版本，你应该有 1.0.31 而不是 1.0.26 瞧！

可以在这里找到最新更新的 sdk：http: [//developer.android.com/sdk/index.html#download](http://developer.android.com/sdk/index.html#download)

去看看sdk更新是否有帮助。将“很快”报告。

[更新] 为我工作！感谢您发布[该链接](http://forums.adobe.com/message/5086305)1.21 吉瓦。是的，问题是[设备与您的计算机通信所需的新 RSA 密钥](http://www.androidcentral.com/semi-pro-tip-android-422-here-your-android-sdk-might-need-updating)。

我将上面列出的文件复制到了 flex air sdk 中。您需要在 Nexus 7 上确认与计算机的通信。会弹出一个小提示，询问您是否要允许与计算机通信。确认刷新设备列表后；设备将正确显示，您可以恢复正常生活。

对于那些仅仅因为没有提供所有信息而会否决原始问题的人，我有以下要说的。我找到了我需要的东西，但问题中没有包含每一个小细节。问题不需要完美，简单的“饼干屑”很有用。 *叹息* 我想知道有多少有用的信息会因为这种行为而丢失。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-25T07:07:49.470

所以这就是我如何*调试*以下工作。

我正在使用 Mac OSX 10.8.2、Nexus 7、Flash Builder 4.7 和 AIR：3.6。

1.  在此处下载最新的 Android SDK：http: [//developer.android.com/sdk/index.html](http://developer.android.com/sdk/index.html)
2.  解压并从[android-sdk]\platform-tools\目录下复制aapt、adb和dx.jar（dx.jar在\platform-tools\lib目录下）。
3.  将这些文件粘贴到 [FLEX_SDK_AIR_3.6]\lib\android\bin 目录中。
4.  重新启动 Flash Builder

我认为 dx.jar 在创建发布版本时是必要的。

还有另一个可能相关的问题，[air/android/device/runtime.apk 处的错误 SDK 组件已过期](https://stackoverflow.com/questions/15061151/error-sdk-component-at-air-android-device-runtime-apk-is-out-of-date)。仍在试图弄清楚这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-07T14:01:33.230

如果从给定的链接下载 sdk 后无法找到 aapt，则需要转到终端并从“工具”文件夹类型：./android update sdk 然后检查 build-tools 另外，对我来说它仍然没有工作直到我将 Adob​​e AIR SDK 更新到最新版本（使用 rsync 而不是常规副本），最后将 android-sdk-mac_x86/platforms/android-xx/android.jar 复制到 [air-sdk-version]/lib/android/lib/ android-res.jar

# android - android.database.sqlite.SQLiteException：没有这样的表：

> ID：15036612
> 
> 赞同：0
> 
> 时间：2013-02-23T03:11:53.220
> 
> 标签：android, database, android-sqlite

我正在尝试使用 SQlite 数据库制作 Android 应用程序，但是当我尝试对表“clientes”进行查询时，会显示一个 RuntimeException。我尝试了很多事情，我找到了很多解决方案，但没有一个有效。

主要课程：

```
public class AndroidBaseDatos extends Activity {

private TextView texto;
private String nombre;
private DBHelper BD;
/**Array donde guardamos los nuevos dispositivos encontrados**/
private ArrayAdapter<String> query;
private ListView queryResult;

UsuariosSQLiteHelper usdbh =
        new UsuariosSQLiteHelper(this, "DBUsuarios", null, 1);
    SQLiteDatabase db;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_android_base_datos);

    texto = (TextView) findViewById(R.id.textView1);
    queryResult = (ListView) findViewById(R.id.listView1);
    BD=new DBHelper(this);
    BD.open();
}

public void onStart() {
    super.onStart();        
    //Base de datos database
            String[] campos = new String[] {"nombre", "apellidos", "edad"};
            String[] args = new String[] {"2"};
             db=usdbh.getReadableDatabase();
            Cursor c = db.query("clientes", campos, "_id=?", args, null, null, null);
             //Cursor c = db.query("Usuarios", campos, null, null, null, null, null);

    // Inicializa el array
            query = new ArrayAdapter<String>(this, R.layout.nombre_dispositivo);

 // Establece el Listview para los dispositivos nuevos

    //Nos aseguramos de que existe al menos un registro
    if (c.moveToFirst()) {
         //Recorremos el cursor hasta que no haya más registros
         do {
              nombre = c.getString(0);
              String apellidos = c.getString(1);
              int edad = Integer.parseInt(c.getString(2));
              Log.d("obteniendo datos", nombre);
              query.add(nombre);
              query.add(apellidos);
              query.add(String.valueOf(edad));
              //String email = c.getString(1);
         } while(c.moveToNext());
    }
    texto.setText(nombre);
    queryResult.setAdapter(query);
    db.close();
} 
```

以及扩展 SQLiteOpenHelper 的类

```
public class DBHelper extends SQLiteOpenHelper {

// Ruta por defecto de las bases de datos en el sistema Android
private static String DB_PATH = "/data/data/com.example.bbdd/databases/";

private static String DB_NAME = "database.db";

private SQLiteDatabase myDataBase;

private final Context myContext;

// Array de strings para su uso en los diferentes métodos

/**
 * Constructor Toma referencia hacia el contexto de la aplicación que lo
 * invoca para poder acceder a los 'assets' y 'resources' de la aplicación.
 * Crea un objeto DBOpenHelper que nos permitirá controlar la apertura de la
 * base de datos.
 * 
 * @param context
 */
public DBHelper(Context context) {

    super(context, DB_NAME, null, 1);
    myContext = context;
    myDataBase = this.getReadableDatabase();

}

/**
 * Crea una base de datos vacía en el sistema y la reescribe con nuestro
 * fichero de base de datos.
 * */
public void createDataBase() throws IOException {

    boolean dbExist = checkDataBase();
    SQLiteDatabase db_Read = null;

    if (dbExist) {
        // la base de datos existe y no hacemos nada.
        Log.i("creando base de datos", "Ya existe");
        //copyDataBase();
    } else {
        // Llamando a este método se crea la base de datos vacía en la ruta
        // por defecto del sistema
        // de nuestra aplicación por lo que podremos sobreescribirla con
        // nuestra base de datos.

        db_Read = this.getReadableDatabase();
        db_Read.close();
        Log.i("creando base de datos", "Creando la base de datos");

        try {

            copyDataBase();

        } catch (IOException e) {
            throw new Error("Error copiando Base de Datos");
        }
    }

}

/**
 * Comprueba si la base de datos existe para evitar copiar siempre el
 * fichero cada vez que se abra la aplicación.
 * 
 * @return true si existe, false si no existe
 */
private boolean checkDataBase() {

    SQLiteDatabase checkDB = null;

    try {

        String myPath = DB_PATH + DB_NAME;
        checkDB = SQLiteDatabase.openDatabase(myPath, null,
                SQLiteDatabase.OPEN_READONLY);

    } catch (SQLiteException e) {

        // si llegamos aqui es porque la base de datos no existe todavía.

    }
    if (checkDB != null) {

        checkDB.close();

    }
    return checkDB != null ? true : false;
}

/**
 * Copia nuestra base de datos desde la carpeta assets a la recién creada
 * base de datos en la carpeta de sistema, desde dónde podremos acceder a
 * ella. Esto se hace con bytestream.
 * */
private void copyDataBase() throws IOException {
    Log.i("copiando base de datos", "Copiando...");
    // Abrimos el fichero de base de datos como entrada
    InputStream myInput = myContext.getAssets().open(DB_NAME);

    Log.i("copiando base de datos", myContext.getAssets().open(DB_NAME).toString());
    // Ruta a la base de datos vacía recién creada
    String outFileName = DB_PATH + DB_NAME;
    Log.i("copiando base de datos", DB_PATH + DB_NAME);

    // Abrimos la base de datos vacía como salida
    OutputStream myOutput = new FileOutputStream(outFileName);

    // Transferimos los bytes desde el fichero de entrada al de salida
    byte[] buffer = new byte[1024];
    int length;
    while ((length = myInput.read(buffer)) > 0) {
        myOutput.write(buffer, 0, length);
    }

    // Liberamos los streams
    myOutput.flush();
    myOutput.close();
    myInput.close();

}

public void open() throws SQLException {

    // Abre la base de datos
    try {
        createDataBase();
    } catch (IOException e) {
        throw new Error("Ha sido imposible crear la Base de Datos");
    }

    String myPath = DB_PATH + DB_NAME;
    myDataBase = SQLiteDatabase.openDatabase(myPath, null,
            SQLiteDatabase.OPEN_READONLY);

}

@Override
public synchronized void close() {
    if (myDataBase != null)
        myDataBase.close();
    super.close();
}

@Override
public void onCreate(SQLiteDatabase db) {

}

public void crearTabla(){
    String sqlCreate = "CREATE TABLE clientes (_id INTEGER, nombre TEXT, apellidos TEXT, edad INTEGER)";
    myDataBase.execSQL(sqlCreate);
    myDataBase.execSQL("INSERT INTO clientes (_id, nombre, apellidos, edad) " +
            "VALUES (2, 'Alberto', 'Redondo', 27)");
}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

} 
```

这是调试信息。

```
> 02-23 02:18:25.072: E/Trace(4081): error opening trace file: No such file or directory (2)
02-23 02:18:26.370: I/creando base de datos(4081): Ya existe
02-23 02:18:26.410: E/SQLiteLog(4081): (1) no such table: clientes
02-23 02:18:26.410: D/AndroidRuntime(4081): Shutting down VM
02-23 02:18:26.421: W/dalvikvm(4081): threadid=1: thread exiting with uncaught exception (group=0x40a13300)
02-23 02:18:26.450: E/AndroidRuntime(4081): FATAL EXCEPTION: main
02-23 02:18:26.450: E/AndroidRuntime(4081): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.bbdd/com.example.bbdd.AndroidBaseDatos}: android.database.sqlite.SQLiteException: no such table: clientes (code 1): , while compiling: SELECT nombre, apellidos, edad FROM clientes WHERE _id=?
02-23 02:18:26.450: E/AndroidRuntime(4081):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
02-23 02:18:26.450: E/AndroidRuntime(4081):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
02-23 02:18:26.450: E/AndroidRuntime(4081):     at android.app.ActivityThread.access$600(ActivityThread.java:130)
02-23 02:18:26.450: E/AndroidRuntime(4081):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
02-23 02:18:26.450: E/AndroidRuntime(4081):     at android.os.Handler.dispatchMessage(Handler.java:99)
02-23 02:18:26.450: E/AndroidRuntime(4081):     at android.os.Looper.loop(Looper.java:137)
02-23 02:18:26.450: E/AndroidRuntime(4081):     at android.app.ActivityThread.main(ActivityThread.java:4745)
02-23 02:18:26.450: E/AndroidRuntime(4081):     at java.lang.reflect.Method.invokeNative(Native Method)
02-23 02:18:26.450: E/AndroidRuntime(4081):     at java.lang.reflect.Method.invoke(Method.java:511)
02-23 02:18:26.450: E/AndroidRuntime(4081):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
02-23 02:18:26.450: E/AndroidRuntime(4081):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
02-23 02:18:26.450: E/AndroidRuntime(4081):     at dalvik.system.NativeStart.main(Native Method)
02-23 02:18:26.450: E/AndroidRuntime(4081): Caused by: android.database.sqlite.SQLiteException: no such table: clientes (code 1): , while compiling: SELECT nombre, apellidos, edad FROM clientes WHERE _id=?
02-23 02:18:26.450: E/AndroidRuntime(4081):     at android.database.sqlite.SQLiteConnection.nativePrepareStatement(Native Method)
02-23 02:18:26.450: E/AndroidRuntime(4081):     at android.database.sqlite.SQLiteConnection.acquirePreparedStatement(SQLiteConnection.java:882)
02-23 02:18:26.450: E/AndroidRuntime(4081):     at android.database.sqlite.SQLiteConnection.prepare(SQLiteConnection.java:493)
02-23 02:18:26.450: E/AndroidRuntime(4081):     at android.database.sqlite.SQLiteSession.prepare(SQLiteSession.java:588)
02-23 02:18:26.450: E/AndroidRuntime(4081):     at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:58)
02-23 02:18:26.450: E/AndroidRuntime(4081):     at android.database.sqlite.SQLiteQuery.<init>(SQLiteQuery.java:37)
02-23 02:18:26.450: E/AndroidRuntime(4081):     at android.database.sqlite.SQLiteDirectCursorDriver.query(SQLiteDirectCursorDriver.java:44)
02-23 02:18:26.450: E/AndroidRuntime(4081):     at android.database.sqlite.SQLiteDatabase.rawQueryWithFactory(SQLiteDatabase.java:1314)
02-23 02:18:26.450: E/AndroidRuntime(4081):     at android.database.sqlite.SQLiteDatabase.queryWithFactory(SQLiteDatabase.java:1161)
02-23 02:18:26.450: E/AndroidRuntime(4081):     at android.database.sqlite.SQLiteDatabase.query(SQLiteDatabase.java:1032)
02-23 02:18:26.450: E/AndroidRuntime(4081):     at android.database.sqlite.SQLiteDatabase.query(SQLiteDatabase.java:1200)
02-23 02:18:26.450: E/AndroidRuntime(4081):     at com.example.bbdd.AndroidBaseDatos.onStart(AndroidBaseDatos.java:90)
02-23 02:18:26.450: E/AndroidRuntime(4081):     at android.app.Instrumentation.callActivityOnStart(Instrumentation.java:1163)
02-23 02:18:26.450: E/AndroidRuntime(4081):     at android.app.Activity.performStart(Activity.java:5018)
02-23 02:18:26.450: E/AndroidRuntime(4081):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2032)
02-23 02:18:26.450: E/AndroidRuntime(4081):     ... 11 more
02-23 02:23:26.573: I/Process(4081): Sending signal. PID: 4081 SIG: 9 
```

它位于 db 文件名数据库上的表，当我用 shell 打开它时，它创建的表客户端，如果尝试再次创建它会显示一个 SQLException，表示该表已经存在，正如我之前检查的那样，但我不能显示对任何数据库中的任何表进行的任何查询。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T11:15:02.510

*   **首先：**删除创建数据库的代码。也就是说，坚持你的第一个想法（从资产文件夹复制数据库）。
*   **第二：**使用sqlite3在你的桌面上打开并测试你的数据库文件的有效性（也就是测试你的查询）。如果它有效并且测试成功，请继续..
*   **第三：使用**[这个实现](http://blog.kdehairy.com/using-a-preloaded-sqlite-database-with-sqliteopenhelper/)更容易更直接（这是我的博客）

如果出了什么问题，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T03:48:03.950

像这样尝试简单的创建插入和更新代码可能会有所帮助...

```
 public class MainActivity extends Activity implements OnClickListener {

SQLiteDatabase database;
private static final String DBNAME="Example";
Button btn1,btn2;
EditText et1,et2;
int id=0;
String name=null;
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    et1=(EditText) findViewById(R.id.editText1);
    et2=(EditText) findViewById(R.id.editText2);

    database=openOrCreateDatabase(DBNAME, MODE_PRIVATE, null);
    btn1=(Button) findViewById(R.id.button1);
    btn2=(Button) findViewById(R.id.button2);
    btn2.setOnClickListener(this);
    btn1.setOnClickListener(this);

}

@Override
public void onClick(View v) {

    switch(v.getId()){
    case R.id.button1:
        id =Integer.parseInt(et1.getText().toString());
        name=et2.getText().toString();
        try{
            database.execSQL("CREATE TABLE IF NOT EXISTS tabl(_id INTEGER PRIMARY KEY,id NUMERIC,name TEXT)");
            Log.v("hi", "table created");
            database.beginTransaction();
            database.execSQL("INSERT INTO tabl(id,name) VALUES ("+id+",'"+name+"');");
            database.setTransactionSuccessful();
            database.endTransaction();
        }
        catch(Exception e){
            Log.v("hi", e.toString());  
        }
        break;
    case R.id.button2:
        id =Integer.parseInt(et1.getText().toString());
        name=et2.getText().toString();
        try{
            database.beginTransaction();
            database.execSQL("UPDATE tabl SET name='"+name+"' WHERE id="+id+";");
            database.setTransactionSuccessful();
            database.endTransaction();
        }
        catch(Exception e){
            Log.v("hi", e.toString());
        }
    }
}
} 
```

和资源

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"     xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="match_parent" tools:context=".MainActivity">
    <EditText android:id="@+id/editText1" android:layout_width="wrap_content"        android:layout_height="wrap_content" android:layout_alignParentRight="true" android:layout_alignParentTop="true" android:layout_marginRight="91dp" android:layout_marginTop="64dp" android:ems="10">
     <requestFocus /> 
     </EditText>
     <EditText android:id="@+id/editText2" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_alignLeft="@+id/editText1" android:layout_below="@+id/editText1" android:layout_marginLeft="50dp" android:layout_marginTop="36dp" android:ems="10" /> 
     <Button android:id="@+id/button1" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_alignLeft="@+id/editText2" android:layout_centerVertical="true" android:text="Button" /> 
     <Button android:id="@+id/button2" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_alignBaseline="@+id/button1" android:layout_alignBottom="@+id/button1" android:layout_alignRight="@+id/editText2" android:text="Button" /> 
     </RelativeLayout> 
```

试试这样。，可能会有所帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T03:29:21.997

似乎您从不调用`crearTabla`从代码中的任何位置创建表。你至少应该在`onCreate`你的 SQLiteOpenHelper 上调用它。

# c# - 如何存储方法的输出？

> ID：15036614
> 
> 赞同：0
> 
> 时间：2013-02-23T03:12:06.580
> 
> 标签：c#, winforms

我正在寻找一种简单的方法来将方法的输出存储在某种变量中，以便它可以被另一个类使用。

例如：

```
partial class Form1 {
    public string orderNumber() {
        string ord="ORD"+get_next_id()+DateTime.Now.Year;
        return ord;
    }
} 
```

在`Form1`用户输入购买详细信息（例如姓名、地址...）的实例中，当用户单击添加条目按钮时，详细信息将保存在`ordernumber`上述代码生成的数据库中。同时，当用户单击添加条目时，它会杀死当前表单并调出另一个使用`ordernumber`先前生成的表单。当我喜欢

```
Form1 m=new Form1(); 
```

并做类似的事情（以下是伪代码）

```
m.orderNumber=string orderNUm. 
```

它会生成我不想要的不同订单号。我想使用保存在数据库中的订单号`Form1`。

我想将该命令存储在某个地方，以便我可以将它传递给另一个班级。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T03:20:50.787

另一个类可以简单地通过调用方法本身来使用结果：

```
public class A
{
    public string orderNumber()
    {
        string ord = "ORD" + get_next_id() + DateTime.Now.Year;
        return ord;
    }
}

public class B
{
    public void DoSomeWork()
    {
        A a = new A();
        string result = a.orderNumber();
    }
} 
```

“将其存储在某处”的概念感觉就像是全局变量的概念。虽然可以完成基本相同的事情，但不鼓励这样做，因为这并不代表面向对象的设计原则。

只是为了了解*如何*在 C# 中做到这一点（你*不应该这样做*），你可以这样做：

```
static public SharedStorage
{
    public string OrderNumber { get; set; }
}

// Somewhere in your code

SharedStorage.OrderNumber = a.orderNumber();

// Somewhere else in your code

string orderNumber = SharedStorage.OrderNumber; 
```

如果您想在实例上设置一次订单号*，*然后继续使用它，您可以将逻辑放在构造函数中：

```
public class A
{
    public string OrderNumber { get; private set; }
    public A()
    {
        OrderNumber = "ORD" + get_next_id() + DateTime.Now.Year;
    }
}

// Somewhere else in your code

A a = new A();
string orderNumber = a.OrderNumber; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T03:21:52.017

这是相当基本的东西，但将其添加到类的顶部：

```
public string OrderCode; 
```

接下来在该行`OrderCode = ord;`上方添加`return ord;`

现在，每当有人需要订单代码时，他们只需拨打电话`<YourClass>.OrderCode`

但是，他们可以只调用方法本身来获取订单号，因为它是公开的。

PS：该`orderNumber`方法不遵循 c# 约定。a) 它应该正确大写 (OrderNumber) 和 b) 更有意义的名称是 GetOrderNumber

# css - CSS 计数器重置

> ID：15036618
> 
> 赞同：1
> 
> 时间：2013-02-23T03:12:45.110
> 
> 标签：css

我无法理解为什么有些计数器有效，而有些则无效。在以下 HTML 中，目标是使用 cnt3 样式创建使用 <h3> 的目录列表，以匹配后续的 <h2> 标头。我希望目录中的编号与 <h2> 标题的编号相匹配。而且我正在尝试使用 CSS 计数器来做到这一点，而且大多数情况下它正在工作，但似乎我的目录的 h3s 计数器要么没有增加，要么经常重置，但我不知道为什么，我也没有弄清楚如何调试这个...... Mozilla Firebug 似乎告诉我反增量正在正确的地方使用，但它似乎对编号没有影响。显然，这是一个剥离的例子，只是为了演示这个问题，它出现在一个更大的文档中。

**HTML**

```
<h1>H1 Title</h1>
<h2>H2 Title</h2>
<h3 class="cnt3">H3 1</h3>
<h3 class="cnt3">H3 2</h3>
<h3 class="cnt3">H3 3</h3>
<h2 class="cnt">H2 Title 2</h2>
<h3 class="top">H3 4</h3>
<h3 class="top">H3 5</h3>
<h3 class="top">H3 6</h3>
<h2 class="cnt">H2 Title 3</h2> 
```

**CSS**

```
h1 {
    counter-reset: h2s;
    text-align: center;
    font-size: 24pt;
}
h2 {
    font-size: 20pt;
    counter-reset: h3s;
    counter-reset: h3t;
}
h3 {
    font-size: 16pt;
    counter-reset: h4t;
}
h2.cnt:before {
    content: 'Section ' counter( h2s, decimal ) ': ';
    counter-increment: h2s;
}
h3.cnt3:before {
    content: 'Section ' counter( h3s, decimal ) ': ';
    counter-increment: h3s;
}
h3.top:before {
    font-size: 16pt;
    content: counter( h2s, decimal ) '.' counter( h3t, decimal ) ': ';
    counter-increment: h3t;
}
h4 { font-size: 13pt; }
h4.top:before {
    font-size: 16pt;
    content: counter( h2s, decimal ) '.' counter( h3t, decimal ) '.' counter( h4t, decimal ) ': ';
    counter-increment: h4t;
} 
```

问题发生在 Firefox 和 Chrome 中，所以我想这是我的代码，而不是两个浏览器中的相同错误！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T07:05:29.327

您没有使用应该使用的方法。

级联规则也适用于此属性。所以在这里 ....

```
h2 {
    font-size: 20pt;
    counter-reset: h3s;
    counter-reset: h3t;
    } 
```

您对属性的第二个定义覆盖了前一个。

当您为同一元素重置 2 个计数器时，**应将它们一起指定，**如下所示

您的 h2 规则应如下所示

```
h2 {
    font-size: 20pt;
    counter-reset: h3s h3t;
} 
```

在这里你有一个工作正常的[JSBin](http://jsbin.com/avetod/1/edit)

# c - 我的输出中的间距在 C 中略微偏离

> ID：15036619
> 
> 赞同：0
> 
> 时间：2013-02-23T03:12:51.570
> 
> 标签：c, printf

```
700   =   17 + 683
702   =   11 + 691
704   =   3 + 701
706   =   5 + 701 
```

如您所见... 3 和 5 位于错误的位置，它应该是：

```
700   =   17 + 683
702   =   11 + 691
704   =    3 + 701
706   =    5 + 701 
```

我的代码：

```
fprintf(fpout, "%d   =   %d + %d\n", lower, primeNum1, primeNum2); 
```

我假设我需要使用一些特殊的技术来解决这个问题。有人可以在这里帮忙吗。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T03:15:05.663

`%`您可以通过在和之间放置一个数字来指定最小字段宽度`d`。当转换后的值小于最小字段宽度时，该字段将在左侧填充空格。

```
fprintf(fpout, "%3d   =   %2d + %3d\n", lower, primeNum1, primeNum2); 
```

当然，您可能需要根据您对 、 和 的预期值考虑适当的最小`lower`字段`primeNum1`宽度`primeNum2`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T03:15:20.333

指定字段宽度：

```
printf(fpout, "%3d = %3d + %3d\n", lower, primeNum1, primeNum2); 
```

# ios - 不可跨用户设备共享的非续订订阅

> ID：15036621
> 
> 赞同：0
> 
> 时间：2013-02-23T03:12:52.770
> 
> 标签：ios, subscription, in-app-purchase

我希望在我的 iOS 应用程序中实现 IAP，在一段时间内提供推送通知服务。这似乎属于非续订订阅的范畴。苹果的一项要求是

> 您需要为用户拥有的所有设备提供非续订订阅。Store Kit 不会自动将非续订订阅同步到所有设备；你必须自己实现这个基础设施。例如，大多数订阅是由外部服务器提供的；您的服务器将需要实施一种机制来识别用户并将订阅购买与购买它们的用户相关联。

但是，我不希望在所有用户的设备上共享此订阅（因为在其他设备上推送通知需要额外费用）。我的应用程序的要求是否违反了上述 Apple 的要求？有没有人遇到过与我将要做的类似的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T03:40:02.160

任何订阅都必须可恢复到与用户的 Apple ID 关联的任何设备。订阅的是 Apple ID，而不是设备。除非您完全遵守此规则，否则您将被拒绝。

你无能为力；苹果对此规定非常严格。

# assembly - 检查是否是数字

> ID：15036623
> 
> 赞同：0
> 
> 时间：2013-02-23T03:13:03.387
> 
> 标签：assembly, x86, nasm

我有一个将数字转换为 ASCII 的例程。问题是数字检查，不起作用。

```
.loop1: 
    xor edx,edx ;0
    mov ebx,10  ;divisor    
    div ebx      ;eax = eax/ebx 
    add edx,48   ;eax += 48 

    cmp edx,'0' ;if(edx < '0')      
    jl error    ; error()       
    cmp edx,'9' ;if(edx > '9')      
    jg error    ;error()        

    push edx    ;put value into STACK   
    add esi,1       
    test eax,eax    
    jz loop2
    jmp loop1 
```

问题是：

```
 cmp edx,'0'     
    jl error        
    cmp edx,'9'     
    jg error 
```

即使对于`mov eax,msg`哪里 `msg`的`msg db "abc"`代码也不会去`error`套路。

如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T03:31:25.227

无符号除以 10 的余数永远不会小于 0 或大于 9，因此这些指令`jl`和`jg`指令永远不会跳转到`error`.

# python - 使用 scikit learn (sklearn) 进行批量梯度下降

> ID：15036630
> 
> 赞同：10
> 
> 时间：2013-02-23T03:13:41.157
> 
> 标签：python, machine-learning, scikit-learn

我正在使用 Scikit-Learn (sklearn) 使用一对多的逻辑回归分类器。我有一个大型数据集，它太慢而无法一次性运行；我还想随着培训的进行研究学习曲线。

我想使用批量梯度下降来批量训练我的分类器，比如 500 个样本。有什么方法可以使用 sklearn 来做到这一点，还是我应该放弃 sklearn 并“自己动手”？

这是我到目前为止所拥有的：

```
from sklearn.linear_model import LogisticRegression
from sklearn.multiclass import OneVsRestClassifier

# xs are subsets of my training data, ys are ground truth for same; I have more 
# data available for further training and cross-validation:
xs.shape, ys.shape
# => ((500, 784), (500))
lr = OneVsRestClassifier(LogisticRegression())
lr.fit(xs, ys)
lr.predict(xs[0,:])
# => [ 1.]
ys[0]
# => 1.0 
```

即它正确地识别了一个训练样本（是的，我意识到用新数据评估它会更好——这只是一个快速的烟雾测试）。

重新批量梯度下降：我还没有创建学习曲线，但是可以简单地`fit`在训练数据的后续子集上重复运行吗？还是有其他功能可以批量训练？文档和谷歌对此事相当沉默。谢谢！

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-23T11:32:37.110

你想要的不是批量梯度下降，而是随机梯度下降；批量学习意味着一次性学习整个训练集，而您所描述的正确称为小批量学习。这是在 中实现的`sklearn.linear_model.SGDClassifier`，如果您给它选项，它适合逻辑回归模型`loss="log"`。

与`SGDClassifier`一样`LogisticRegression`，没有必要将估计器包装在一个`OneVsRestClassifier`开箱即用的一对多训练中。

```
# you'll have to set a few other options to get good estimates,
# in particular n_iterations, but this should get you going
lr = SGDClassifier(loss="log") 
```

然后，要在小批量上进行训练，请使用该`partial_fit`方法而不是`fit`. 第一次，你必须给它一个类列表，因为不是所有的类都可能出现在每个小批量中：

```
import numpy as np
classes = np.unique(["ham", "spam", "eggs"])

for xs, ys in minibatches:
    lr.partial_fit(xs, ys, classes=classes) 
```

（在这里，我`classes`为每个 minibatch 传递，这不是必需的，但也不会伤害并且使代码更短。）

# iphone - 捕获 dealloc（释放）错误

> ID：15036631
> 
> 赞同：0
> 
> 时间：2013-02-23T03:13:53.817
> 
> 标签：iphone, ios, objective-c

我正在开发的应用程序中有一些问题，有时如果我在动画正在进行时终止，它最终不会在动画 api 的内部调用 release 方法。

如果为了安全起见我在最后做了 [obj release]，那么如果代码确实正常工作并释放对象，它最终会导致引发内部错误。

所以，我的问题是，有没有办法忽略这些调用 release 的错误并继续下一行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T03:28:39.203

没有办法安全地忽略这些错误。

了解对象保留和释放语义是编写无错误的 Objective-C 代码的最重要部分之一。如果启用自动引用计数 (ARC)，您将省去很多麻烦，但事实是，如果不了解这些东西的工作原理，您就无法成为一名认真的 Objective-C 编码器。

至于特定的错误，我建议您提供一些代码片段以及您如何取消动画，以便我们指出如何正确平衡您的发布调用。

# c++ - 基类成员函数内的静态变量

> ID：15036633
> 
> 赞同：1
> 
> 时间：2013-02-23T03:14:55.197
> 
> 标签：c++, inheritance, static

我有以下内容：

```
 class base
   {
      public
       void f();
       ...
   }
    void base::f()
    {
        static bool indicator=false;
         .....
         if(!indicator)
         {
            ...
            indicator=true;
          }
     }
    class D:public base
    {      
       ...
     } 
```

在我的 main() 中，我有：

```
 main()
      {
          // first instance of D
          base *d1 = new D();
          d1->f();
           ....
           // 2nd instance of D
          base *d2 = new D();
          d2->f();
       } 
```

我发现第一次实例化 D 并调用 d1->f() 时，静态变量设置为 false。但我第二次调用 d2->f() 代码甚至没有命中“静态布尔指标=假”行 并且它保持为真（从 d1-f() 的第一遍开始）这正是我想要的行为，但我不明白为什么会这样。有人可以解释发生了什么。提前致谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-23T03:22:39.340

在成员函数中声明的静态变量将*在函数调用之间保持其值*。所有实例都只有*一个副本*，并且来自不同实例的所有访问都`indicator`将影响相同`indicator`。这意味着`indicator` *只会被初始化一次*。

有关更多信息，请参见此处：[成员函数中的静态变量](https://stackoverflow.com/q/6223355/873025)

此外，此代码不会切换`indicator`，如果它是 false，它总是将其设置为 true（我确定这是您想要的行为）。

```
if(!indicator)
     {
        ...
        indicator=true;
      } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T03:22:32.390

这正是在功能块内声明的静态变量的行为。自从在 C 编程语言中引入该功能以来，情况就是如此。

> 静态声明也可以应用于内部变量。内部静态变量对于特定函数是局部的，就像自动变量一样，但与自动变量不同的是，它们仍然存在，而不是在每次激活函数时来来去去。（K&R，第 61 页）。

静态初始化程序在第一次调用包含函数之前执行。作为静态变量，变量在调用过程中保持其最后状态。

# dart - 在 Dart 中制作矩阵

> ID：15036638
> 
> 赞同：3
> 
> 时间：2013-02-23T03:15:32.553
> 
> 标签：dart

好的，伙计们，我试过这个：

```
List<num> test
for(num i = ...){
   test[i]...
   (...)
    for(num j = ...){
      test[i][j] = ...
    }
} 
```

今天，但似乎没有工作。我的问题是......有没有办法在 Dart 中做到这一点？:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-23T04:16:59.940

这是一种方法：

```
main() {
  List<List<int>> matrix = new List<List<int>>();
  for (var i = 0; i < 10; i++) {
    List<int> list = new List<int>();

    for (var j = 0; j < 10; j++) {
      list.add(j);
    }

    matrix.add(list);
  }

  print(matrix);
  print(matrix[2][4]);
} 
```

如果您提前知道长度，并且它不会改变，您可以将长度传递给构造函数：

```
main() {
  int size = 10;
  List<List<int>> matrix = new List<List<int>>(size);
  for (var i = 0; i < size; i++) {
    List<int> list = new List<int>(size);

    for (var j = 0; j < size; j++) {
      list[j] = j;
    }

    matrix[i] = list;
  }

  print(matrix);
  print(matrix[2][4]);
} 
```

注意主要区别。在第一个示例中，列表创建为空，因此循环需要显式地将元素添加到列表中。在第二个示例中，列表以固定大小创建，每个索引处都有空元素。

**变更日志**：第二个示例的原始版本使用了`List.fixedLength(size)`Dart 1.0 之前存在的构造函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T05:02:57.343

在每个位置构造具有不同值的列表的一种方法是使用成语 `new Iterable.generate(size, function).toList()`

```
makeMatrix(rows, cols) =>
    new Iterable<List<num>>.generate(
        rows,
        (i) => new List<num>.fixedLength(cols, fill: 0)
      ).toList();

main() {
  print(makeMatrix(3, 5));
} 
```

印刷： `[[0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]]`

`fill:`要获取参数，您必须构造一个固定长度的列表，这有点烦人。如果没有填充值，内部列表将包含`null`s。获得具有初始值的可扩展列表的一种方法是创建一个空列表并对其进行扩展。

```
(i) => <num>[]..insertRange(0, cols, 0) 
```

`a..b()..c()`这是在返回它调用`a.b()`和`a.c()`返回之前使用方法级联来修改列表`a`。这很方便，因为它避免了对临时变量的需要。请注意，由于某种原因，`insertRange`它具有位置参数而不是命名`fill`参数。

如果您想对内容进行更多控制，可以将生成到列表的想法扩展到两个级别：

```
makeMatrix(rows, cols, function) =>
    new Iterable<List<num>>.generate(
        rows,
        (i) => new Iterable<num>.generate(cols, (j) => function(i, j)).toList()
      ).toList();

main() {
  print(makeMatrix(3,5, (i, j) => i == j ? 1 : 0));
} 
```

印刷：`[[1, 0, 0, 0, 0], [0, 1, 0, 0, 0], [0, 0, 1, 0, 0]]`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T04:17:57.733

[pub](http://pub.dartlang.org/)上有一些用于处理矩阵的优秀库（例如 Kevin Moore 的 BOT），但是如果您要快速寻找一些东西，您可以这样做：

```
List<List> test = new List<List>(n);
for (var i = 0; i < n; i++) {
  test[i] = new List(n);
}

for (var i = 0; i < n; i++) {
  for (var j = 0; j < n; j++) {
    test[i][j] = myValue;
  }
} 
```

# android - 将imageview中的图片与资源进行比较？

> ID：15036640
> 
> 赞同：-1
> 
> 时间：2013-02-23T03:15:48.543
> 
> 标签：android, imageview, android-resources

我是 android 编程新手，想知道是否有办法将 imageview 中的特定图片与资源图像进行比较，看看它们是否相同？先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T05:01:34.293

当你初始化 imageview 使用 setTag("1") 并且当你想检查然后使用 if(imageview.getTag("1")) 并且你可以做任何你喜欢的操作..

# php - 如何在 CodeIgniter 中结合 query() 和 limit() 方法

> ID：15036641
> 
> 赞同：4
> 
> 时间：2013-02-23T03:15:51.630
> 
> 标签：php, mysql, codeigniter, activerecord, limit

是否可以在codeigniter中做这样的事情：

```
publi function getcat($category_id)
{
    $query = "(SELECT cat.id, cat.title ";
    $query = $query . "FROM bf_categories cat ";
    $query = $query . "WHERE cat.id=" . $category_id;
    $this->db->limit(2, 4);
    $records = $this->db->query($query);
    return $records->result();
} 
```

我已经简化了查询只是为了演示目的......但它实际上非常复杂，这就是我决定使用该`query()`方法的原因。

但是查询中没有包含限制子句...我通过在控制器中启用 codeigniter 分析器进行了验证，我可以看到查询在没有任何限制子句的情况下运行。

您能告诉我如何使用该`query()`方法完成此操作吗？

**编辑 1**

我已将模型修改为如下所示：

```
public function get_categories_and_products($limit=5, $offset=0, $category_id=null)
{
    print "<BR>the function got the following offeset: $offset and limit: $limit";
    $query = "(SELECT cat.category_id, cat.title, cat.image_thumb, cat.deleted, cat.display_weight ";
            $query = $query."FROM bf_categories cat ";
            $query = $query."WHERE cat.parent_id=".$category_id;
    $query = $query." AND cat.category_id <>".$category_id;
    $query = $query.") UNION (";
    $query = $query."SELECT p.product_id, p.name, p.image_thumb, p.deleted , p.display_weight";
    $query = $query." FROM bf_product p ";
    $query = $query."Inner join bf_product_category cp ";
    $query = $query."on p.product_id=cp.product_id ";
    $query = $query."Where cp.category_id=".$category_id.") ?";

            $records = $this->db->query($query,array($this->db->limit(2, 4)));
            return $records->result();
     } 
```

我现在已经硬编码了限制值......但最终，我将使用传递给方法的值。不幸的是，这段代码仍然不起作用。根据分析器，这是正在执行的内容：

```
(SELECT cat.category_id, cat.title, cat.image_thumb, cat.deleted, cat.display_weight FROM bf_categories cat WHERE cat.parent_id=3 AND cat.category_id <>3) UNION (SELECT p.product_id, p.name, p.image_thumb, p.deleted , p.display_weight FROM bf_product p Inner join bf_product_category cp on p.product_id=cp.product_id Where cp.category_id=3)

SELECT * FROM (`bf_categories`) WHERE `category_id` = '3' LIMIT 4, 2 
```

所以它创建了两个单独的选择语句。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2017-02-17T12:13:42.293

我试过这种方式，多重加入开始和限制。您根据选择删除加入。

```
 $this->db->select('*');
    $this->db->from('tbl_requestservice as r');
    $this->db->join('tbl_service as s','s.service_id=r.service_id');
    $this->db->limit($limit, $start);
    $query = $this->db->get();
    print_r($query->result());
    return $query->result(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-23T03:27:03.930

这是 CI 中查询的样子：

```
$this->db->select("id, title");
$this->db->where("id", $category_id);
$this->db->from("bf_categories");
$this->db->limit($limit);
$query = $this->db->get();

if($query->num_rows() > 0)
{
   foreach($query->result() as $row)
   {
      echo $row->title;
   }
} 
```

如果您包含完整的查询，解决问题或向您展示更好、更有效的方法会更容易。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-27T02:09:00.733

最后，我手动完成所有操作。

```
public function get_categories_and_products($limit=10, $offset=0, $category_id=null)
{
    $query = "(SELECT cat.category_id, cat.title, cat.image_thumb, cat.deleted, cat.display_weight ";
    $query = $query."FROM bf_categories cat ";
    $query = $query."WHERE cat.parent_id=".$category_id;
    $query = $query." AND cat.category_id <>".$category_id;
    $query = $query.") UNION (";
    $query = $query."SELECT p.product_id, p.name, p.image_thumb, p.deleted , p.display_weight";
    $query = $query." FROM bf_product p ";
    $query = $query."Inner join bf_product_category cp ";
    $query = $query."on p.product_id=cp.product_id ";
    $query = $query."Where cp.category_id=".$category_id.") limit ".$offset.','.$limit;
    $catsandprods= $this->db->query($query);
    return $catsandprods->result();
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-03-24T10:11:00.820

[http://code-igniter.ru/user_guide/database/active_record.html](https://ellislab.com/codeigniter/user-guide/database/active_record.html)

```
$this->db->start_cache();
$this->db->select('field1');
$this->db->stop_cache();
$this->db->get('tablename'); 
```

`field1`从 ( `tablename`)中选择

```
$this->db->select('field2');
$this->db->limit(10);
$this->db->get('tablename'); 
```

// SELECT `field1`, `field2`FROM ( `tablename`) 限制 10

```
$this->db->flush_cache();
$this->db->select('field2');
$this->db->get('tablename'); 
```

//`field2`从 ( `tablename`)中选择

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-23T03:21:57.943

您可以使用

```
$query = "(SELECT cat.id, cat.title ";
$query = $query."FROM bf_categories cat ";
$query = $query."WHERE cat.id=".$category_id." ?";

$this->db->query($query,array($this->db->limit(2, 4))); 
```

或者

```
 $this->db->select('id,title')->from('bf_categories ')->where('id', $id)->limit(2, 4); 
```

[链接到文档](http://ellislab.com/codeigniter/user-guide/database/active_record.html#select)

# php - MYSQL 查询错误（结果数组）

> ID：15036647
> 
> 赞同：0
> 
> 时间：2013-02-23T03:17:14.090
> 
> 标签：php, mysql

我有这个结果

```
Furni Count: Array 
```

我的代码是

```
$query2 = mysql_query(
                "SELECT COUNT(DISTINCT id) FROM items
                 WHERE base_item='" . $weekly2['furniture_id'] . "'"
           );

$OwnerCount = mysql_fetch_array($query2);
echo "<tr><td width=\"92%\" >Owner Count: $OwnerCount<form><input type=\"submit\" value=\"Owner Last Online\"></form></td></tr>"; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T03:19:35.543

这是因为您`echo`输入了一个数组，尝试一下`print_r($Ownercount);`，您应该会看到数组（和键）。

例子：

```
echo $Ownercount[0]; 
```

应该返回数组中的第一个键（这可能是你想要的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T03:21:42.453

您可以在查询中添加别名，如下所示：

```
COUNT(DISTINCT id) as total 
```

然后打电话

```
$Ownercount["total"]; 
```

# storage - 您可以使用互联网将数据存储在国家之间的传输空间中吗？

> ID：15036651
> 
> 赞同：0
> 
> 时间：2013-02-23T03:18:11.910
> 
> 标签：storage

是否可以通过互联网在美国计算机和澳大利亚计算机之间反弹和转发数据，然后将这些数据包来回发送并将这些反弹的数据用作数据存储？

据我了解，数据从 A 传输到 B 需要一些时间，比如说 100 毫秒，因此传输中的数据可以被认为是存储中的数据。如果两个节点都有很好的带宽和空闲带宽，数据是否可以存储在这个传输空间中？- 通过在循环中反弹和转发数据。

是否有任何原因导致这不起作用。

* * *

这个想法来自我前一段时间的另一个想法，我认为你可以通过在两颗卫星之间间隔几分钟发射激光脉冲来将数据存储在空白空间中。在这短短的几分钟之间，您可以将数据存储在这个空白空间中作为数据传输。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T03:19:35.713

> 是否有任何原因导致这不起作用。

[丢包](http://en.wikipedia.org/wiki/Packet_loss)。尽管某些协议（如 TCP）具有防止数据包丢失的方法，但它涉及发送方根据需要重新发送丢失的数据包。这意味着每个节点仍必须保留一份可用于再次发送的数据副本（否则协议可能会失败），因此在通信未完成时您仍将使用本地存储。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T07:31:46.443

如果您参加过任何网络课程，您就会知道端到端原则，该原则指出

> 端到端原则指出，特定于应用程序的功能应该驻留在网络的终端主机中，而不是在中间节点中

因此，您不能指望两台主机之间的路由器为您保留数据。他们必须随时自由地丢弃它（或者他们自己可能随时崩溃，因为您的数据在他们的缓冲区中）。

有关更多信息，您可以阅读此 wiki 链接： [端到端原则](http://en.wikipedia.org/wiki/End-to-end_principle)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T10:38:56.947

它认为这实际上应该起作用，因为实际上您将该信息存储在众多路由器、交换机和网卡的各种 IO 缓冲区中。然而，可存储的信息量可能太少而无法实际使用，各级网络管理员不太可能喜欢和支持这种创造性的方法。

在延迟线中存储信息是一种已知的方法，过去已用于构建存储设备。然而，过去的方法依赖于信号在物理介质上传播期间的延迟。由于互联网主要使用随着光声传播的电线和电磁波，因此无法以这种方式存储太多信息。过去的存储设备大多使用声波。

# sql - 根据单个列的共性组合多个表

> ID：15036656
> 
> 赞同：-2
> 
> 时间：2013-02-23T03:20:02.520
> 
> 标签：sql

![在此处输入图像描述](../Images/42ab94cb57d5a1c84916aee9ffaad11a.png)

如何制作一个主表，其中包含“Instructor”列的一个实例，并在“Instructor”主列旁边显示“formsreturned”和“availability_avg”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T03:29:22.503

只需创建一个标准`INNER JOIN`：

```
SELECT T1.Instructor, T1.Availability_Avg, T2.FormsReturned
FROM Table1 T1
    INNER JOIN Table2 T2 ON T1.Instructor = T2.Instructor 
```

# windows-8 - 试图让 Twitter Oauth 在 Windows 8 中工作

> ID：15036659
> 
> 赞同：0
> 
> 时间：2013-02-23T03:21:09.447
> 
> 标签：windows-8, windows-runtime, twitter-oauth, winjs

我正在使用此处找到的 Microsoft 身份验证示例：http: [//code.msdn.microsoft.com/windowsapps/Web-Authentication-d0485122](http://code.msdn.microsoft.com/windowsapps/Web-Authentication-d0485122) 我没有修改任何内容，只需输入我得到的所有“消费者秘密”和“消费者密钥”是“无法连接到服务”。其他代码示例给了我 401 错误。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T01:22:46.707

Twitter 服务器需要时间在其所有服务器上全局注册 Ouath 密钥。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T01:20:28.413

它现在可以工作了.. 相同的消费者密钥/消费者秘密，同样的例子，它现在就可以工作了。

# python - 烧瓶邮件打破芹菜

> ID：15036660
> 
> 赞同：3
> 
> 时间：2013-02-23T03:21:22.453
> 
> 标签：python, flask, celery, flask-mail

我有一个 Flask 应用程序，其中 celery 可以正常工作，而 Flask-Mail 本身也可以正常工作。

```
from celery import Celery
from flask_mail import Mail, Message
app = Flask(__name__)
mail = Mail(app)

celery = Celery('main_app', 
                 broker='mongodb://localhost',
                 backend='mongodb://localhost')
@celery.task
def cel_test():
     return 'cel_test'

@app.route('/works_maybe')
def works_maybe():
    return cel_test.delay() 
```

# 到目前为止，一切都很好

cel_test 与 celery worker 配合得很好；一切都出现在 mongo 中。

但这就是奇怪的地方。“注册”加邮件方法没有 100% 有效`@celery.task`，但当它成为任务时就会崩溃。

```
@celery.task
def send_email(some_arg, name, email):
    msg = Message(…message details..)
    return mail.send(msg)

@app.route("/signup", methods=['POST'])
def signup():
    return send_email.delay(...stuff for the message…) 
```

# 痕迹

```
R = retval = fun(*args, **kwargs)
File "/Users/username/pymods/virtualenvs/directory/lib/python2.7/site-packages/celery-3.0.15-py2.7.egg/celery/task/trace.py", line 415, in __protected_call__
return self.run(*args, **kwargs)
File "/Users/username/pymods/directory/directory/main_app/main_app.py", line 43, in send_email
something = 'a string in the Message'),
File "/Users/username/pymods/virtualenvs/directory/lib/python2.7/site-packages/flask/templating.py", line 123, in render_template
ctx.app.update_template_context(context)  
AttributeError: 'NoneType' object has no attribute 'app' 
```

有人可以解释为什么在一种情况下芹菜效果很好，但是当我涉及 mail.send(msg) 时它会中断？

也许我需要更普遍地学习 python 的东西？

任何想法，如果至少是关于处理此类问题的方法，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-08-07T09:46:09.877

在烧瓶中完成的很多事情都绑定到应用程序上下文。例如，该`render_template`函数需要知道您的应用程序将其模板存储在何处。该`session`变量想知道您的应用程序的数据存储或缓存系统。该`request`对象和您`mail.send`在被调用时需要一些应用程序上下文。

如果您想在烧瓶应用程序范围之外调用它们，例如在您的 celery 任务中，请在应用程序上下文中执行此操作，如下所示：

```
...

with app.app_context():

    do_some_context_bound_actions()

    msg = Messgae(...)
    user_name = app.session["user"].name
    msg.html = render_template("mail/welcome.html", name=user_name)
    mail.send(msg)

... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T16:44:31.277

# 更新

该错误位于`send_email`任务的 render_template 部分。

```
@celery.task
def send_email(some_arg, name, email):
    msg = Message(
                  subject='hello', 
                  body=render_template('email.txt',
                  name=name, 
                  some_arg=some_arg),
                  recipients=[email]
                 )
    return mail.send(msg) 
```

当我删除*kablaam*`body=render_template`时，它可以工作。

 *我有`from flask import render_template`。也许`render_template`不能这样工作？

奇怪的是，*没有*芹菜，`send_email`加号就`render_template`完美了。

# 黑客式的成功

当我强制`app_context`使用另一个功能时，一切正常：

```
def create_email(some_arg, name, email):
    with app.test_request_context('/send_email'):
        return render_template('email.txt', 
                                name=name, 
                                some_arg=some_arg) 
```

然后把它扔进`send_email`任务中

```
body = render_template('email.txt'… 
```

变成

```
body= create_email(some_arg, name) 
```

而且我们是免费的。*

# python - 玩 py2app

> ID：15036667
> 
> 赞同：1
> 
> 时间：2013-02-23T03:21:54.433
> 
> 标签：python, macos, py2app

我在 Snow Leopard(10.6) 上玩 py2app，运行时遇到了一些问题

`python setup.py py2app`

我收到以下错误：-

```
% python setup.py py2app
running py2app
Traceback (most recent call last):
  File "setup.py", line 18, in <module>
    setup_requires=['py2app'],
  File "/System/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/distutils/core.py", line 152, in setup
    dist.run_commands()
  File "/System/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/distutils/dist.py", line 975, in run_commands
    self.run_command(cmd)
  File "/System/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/distutils/dist.py", line 995, in run_command
    cmd_obj.run()
  File "/Library/Python/2.6/site-packages/py2app-0.7.3-py2.6.egg/py2app/build_app.py", line 502, in run
    if sysconfig.get_config_var('PYTHONFRAMEWORK') is None:
AttributeError: 'NoneType' object has no attribute 'get_config_var' 
```

我已经按照[此处](http://svn.pythonmac.org/py2app/py2app/trunk/doc/index.html#abstract)的文档安装了 py2app ，但是似乎有一些环境变量我没有设置。我还尝试克隆一些项目，比如[这里](https://github.com/astrofrog/py2app-experiments)的一个，我最终遇到了同样的错误。

有人可以指出我在使用前应该如何配置 py2app 的文档吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T17:17:29.143

这是 py2app 中的一个错误，一个快速的解决方法：在 build_app.py 中（请参阅问题中的回溯以了解其位置）第 25 行将“sysconfig = None”更改为“from distutils import sysconfig”。

我已经在 py2app 的跟踪器 [1] 中提交了一个问题，并将很快发布一个新版本（一旦我有时间创建和测试补丁）。

[1] [https://bitbucket.org/ronaldoussoren/py2app/issue/96/py2app-doesnt-work-with-python-26-anymore](https://bitbucket.org/ronaldoussoren/py2app/issue/96/py2app-doesnt-work-with-python-26-anymore)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T03:43:29.057

py2app 文档很古老；你应该使用的是[这里](http://pythonhosted.org/py2app/)。

正如您从粘贴的堆栈跟踪中看到的那样，某些东西正在`distutils.sysconfig`导致`None`. 看起来您正在使用 Python 和 distutils 的系统版本，它们在 10.6.8 上对我来说工作得很好：

```
% /usr/bin/python -c "from distutils import sysconfig; print sysconfig.get_config_var('PYTHONFRAMEWORK')"
Python 
```

所以如果你得到与上面不同的结果，你可以从那里开始，否则你可以开始调试 py2app 代码，看看为什么`sysconfig`是`None`.

# cygwin - 如何在不安装的情况下从 cygwin 卸载 mpich2 包

> ID：15036675
> 
> 赞同：2
> 
> 时间：2013-02-23T03:23:22.743
> 
> 标签：cygwin, mpich

我已经在 cygwin (w7) 上安装了这个旧版本的 mpich2-1.2.1p1 使用 configure、make、make install 命令安装它，现在我想卸载它，我查看了 cygwin 文档、用户指南和网络，看来我还没有找到一个好的答案，你能建议一些方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T04:47:09.977

要卸载它，您需要一个已创建文件的列表。也许您可以将它再次安装到临时目录，以获取需要删除的文件列表。

```
make install DESTDIR=/tmp
find /tmp -type f 
```

# javascript - 获取jquery /css / javascript中相同类元素的最小宽度

> ID：15036676
> 
> 赞同：1
> 
> 时间：2013-02-23T03:23:26.587
> 
> 标签：javascript, jquery, css

```
<img class = "draggable moveable" id = "1" style="width:20px;" >...</img>
<img class = "draggable printable" id = "2" style="width:50px;" >...</img>
<img class = "draggable moveable" id = "3" style="width:10px;" >...</img> 
```

对于上面的情况，如何实现jquery/css选择器来获取同一个类的最小宽度？（本例为10px）

```
$('.draggable').('min:width'); 
```

有这样的语法吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T03:27:43.137

没有这样的语法，你可以根据元素的宽度和使用`first`方法对元素进行排序：

```
$('.draggable').sort(function(a, b){
   return $(a).width() > $(b).width(); 
}).first(); 
```

[http://jsbin.com/igovaw/1/edit](http://jsbin.com/igovaw/1/edit)

请注意，`img`元素没有结束标签。

如果您想获得最小宽度而不是元素，您可以使用`map`方法：

```
var w = $('.draggable').map(function(){
   return $(this).width(); 
}).get();

var min = Math.min.apply(null, w); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T03:28:23.200

```
var minwidth = undefined;
$('.draggable').each(function () {
    width = parseInt($(this).css('width'));
    if (minwidth === undefined || width < minwidth) {
        minwidth = width;
    }
}); 
```

# arrays - 调整图像大小并放置在 CrystalReports BlobField 的字节数组中

> ID：15036677
> 
> 赞同：5
> 
> 时间：2013-02-23T03:23:27.130
> 
> 标签：arrays, vb.net, image, crystal-reports, blob

我已尝试搜索此内容并拥有据我所见应该可以工作的代码，但是由于某种原因，我的 Crystal Report 中的结果图像是 5 页而不是 1 页！

基本上，我有一个水晶报表，其中包含从 BlobField 获取的整页图像，当源图像为 2409 像素宽和 3436 像素高 @ 300 dpi 时，它可以完美运行。

当我尝试使用 1700 宽 x 2436 高 @ 200 dpi 的源图像时，图像高度太大并且将报告挂在下一页上

我想“没问题，我只需调整图像的大小，报告就会正确显示”，但我在这样做时遇到了很大的困难。这是我目前正在使用的代码——当使用“正常”图像大小时这段代码，报告中的所有内容都显示得很好，但是如果我需要调整大小，它会延伸到五页以上，这比不理会它还要糟糕！:(

```
Dim fs As System.IO.FileStream = New System.IO.FileStream(FilePath, System.IO.FileMode.Open, System.IO.FileAccess.Read)
Dim Image() As Byte = New Byte(fs.Length - 1) {}
fs.Read(Image, 0, CType(fs.Length, Integer))
fs.Close()

'Byte[] to image
Dim imgMemoryStream = New IO.MemoryStream(Image)
Dim myImage = Drawing.Image.FromStream(imgMemoryStream)

' Check if image is 2409 wide, if it's not then resize to 2409 while preserving aspect ratio. WIN.
If myImage.Width <> 2409 Then
    MsgBox("myimage before: " & myImage.Width & " by " & myImage.Height)
    myImage = ImageResize(myImage, 3436, 2409)
    MsgBox("myimage after: " & myImage.Width & " by " & myImage.Height)
Else
    MsgBox("myimage (already correct for printing): " & myImage.Width & " by " & myImage.Height)
End If

Dim imgMemoryStream2 As IO.MemoryStream = New IO.MemoryStream()
myImage.Save(imgMemoryStream2, System.Drawing.Imaging.ImageFormat.Jpeg)
Image = imgMemoryStream2.ToArray

objDataRow(strImageField) = Image 
```

所以我将原始图像抓取到一个字节数组中（因为我假设图像大小默认为“正常”，并且只会将其直接插入 BlobField），然后将其转换回图像以检查图像大小。如果大小不“正常”，那么我将调整图像大小，然后将其转换回字节数组以提供给报告中的 BlobField。

这是图像调整大小代码：

```
Public Shared Function ImageResize(ByVal image As System.Drawing.Image, _
ByVal height As Int32, ByVal width As Int32) As System.Drawing.Image
Dim bitmap As System.Drawing.Bitmap = New System.Drawing.Bitmap(width, height, image.PixelFormat)
If bitmap.PixelFormat = Drawing.Imaging.PixelFormat.Format1bppIndexed Or _
bitmap.PixelFormat = Drawing.Imaging.PixelFormat.Format4bppIndexed Or _
bitmap.PixelFormat = Drawing.Imaging.PixelFormat.Format8bppIndexed Or _
bitmap.PixelFormat = Drawing.Imaging.PixelFormat.Undefined Or _
bitmap.PixelFormat = Drawing.Imaging.PixelFormat.DontCare Or _
bitmap.PixelFormat = Drawing.Imaging.PixelFormat.Format16bppArgb1555 Or _
bitmap.PixelFormat = Drawing.Imaging.PixelFormat.Format16bppGrayScale Then
Throw New NotSupportedException("Pixel format of the image is not supported.")
End If
Dim graphicsImage As System.Drawing.Graphics = System.Drawing.Graphics.FromImage(bitmap)
graphicsImage.SmoothingMode = Drawing.Drawing2D.SmoothingMode.HighQuality
graphicsImage.InterpolationMode = Drawing.Drawing2D.InterpolationMode.HighQualityBicubic
graphicsImage.DrawImage(image, 0, 0, bitmap.Width, bitmap.Height)
graphicsImage.Dispose()
Return bitmap
End Function 
```

也许我没有正确地解决这个问题，但基本上我试图找到一种方法来允许将任何大小的图像放入 Crystal Reports BlobField 并让它们占据一个完整的 A4 页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T05:17:14.217

You should have your image (as byte[]) stored somewhere already, pass it to this ResizeBytes function, along with the new dimensions you'd like your returned image to be.

```
private byte[] ResizeBytes(byte[] byteImageIn, int NewWidth, int NewHeight)
{
    //Convert Bytes to Image
    MemoryStream ms1 = new MemoryStream(byteImageIn);
    Image img = Image.FromStream(ms1);

    //Convert Image in to new image with new dimensions, padding with a white background
    img = FixedSize(img, NewWidth, NewHeight);

    //Convert image back to a byte array
    MemoryStream ms2 = new MemoryStream();
    img.Save(ms2, System.Drawing.Imaging.ImageFormat.Jpeg);
    byte[] imageBytes = ms2.ToArray();
    return imageBytes;
} 
```

The FixedSize function:

```
private Image FixedSize(Image imgPhoto, int Width, int Height)
{
    int sourceWidth = imgPhoto.Width;
    int sourceHeight = imgPhoto.Height;
    int sourceX = 0;
    int sourceY = 0;
    int destX = 0;
    int destY = 0;

    float nPercent = 0;
    float nPercentW = 0;
    float nPercentH = 0;

    nPercentW = ((float)Width / (float)sourceWidth);
    nPercentH = ((float)Height / (float)sourceHeight);
    if (nPercentH < nPercentW)
    {
        nPercent = nPercentH;
        destX = System.Convert.ToInt16((Width -
                      (sourceWidth * nPercent)) / 2);
    }
    else
    {
        nPercent = nPercentW;
        destY = System.Convert.ToInt16((Height -
                      (sourceHeight * nPercent)) / 2);
    }

    int destWidth = (int)(sourceWidth * nPercent);
    int destHeight = (int)(sourceHeight * nPercent);

    Bitmap bmPhoto = new Bitmap(Width, Height,
                      PixelFormat.Format48bppRgb); //Format24bppRgb
    bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
                     imgPhoto.VerticalResolution);

    Graphics grPhoto = Graphics.FromImage(bmPhoto);
    grPhoto.Clear(Color.White);
    grPhoto.InterpolationMode =
            InterpolationMode.HighQualityBicubic;

    grPhoto.DrawImage(imgPhoto,
        new Rectangle(destX, destY, destWidth, destHeight),
        new Rectangle(sourceX, sourceY, sourceWidth, sourceHeight),
        GraphicsUnit.Pixel);

    grPhoto.Dispose();
    return bmPhoto;
} 
```

# c# - 使用c#设置html选择选项

> ID：15036680
> 
> 赞同：1
> 
> 时间：2013-02-23T03:23:52.313
> 
> 标签：c#, html, html-agility-pack

好的，所以这似乎是一件容易的事情，但我找不到如何去做。我已经使用该`htmlagility`包来解析网页，并且效果很好。现在，问题在于以下。

```
<td width="45%" class="TextBold" nowrap>
<select name="ctl00$BodyContent$ddlChooseView" onchange="if (this.selectedIndex > 0
{pageTracker._trackEvent('webpage tracker','complete report',this.options
[this.selectedIndex].text);}
ShowProcessing(this);setTimeout('__doPostBack(\'ctl00$BodyContent$ddlChooseView\',\'\')', 
    0)" id="ctl00_BodyContent_ddlChooseView" class="TextBold">
        <option selected="selected" value=""> -- Select a view -- </option>
        <option value="H">Option1</option>
        <option value="R">Option2</option>
        <option value="N">Option3</option>
        <option value="NA">Option4</option>
        <option value="RN">Option5</option>
        <option value="QP">Option6</option>

</select>
</td> 
```

如果格式不正确，我深表歉意。我想在`html`选择对象中选择一个选项。触发页面上的新显示，然后解析该“新”网页。可以`htmlagilitypack`这样做吗？如果没有，我该怎么做才能选择其中一个选项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T04:35:23.437

此代码可能对您有用它包含基本细节。

```
<code>
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Text.RegularExpressions;

//Need to add these two libarary
//For that u need to have WebDriver.dll and WebDriver.Support.dll 
using OpenQA.Selenium;
using OpenQA.Selenium.Support.UI;

namespace Test
{
class Program
{
static void Main(string[] args)
{
//Intializing the webdriver. 
//Note i m using firefox driver, others can also be used.
IWebDriver driver = new OpenQA.Selenium.Firefox.FirefoxDriver();
//Navigating to the given page.
driver.Navigate().GoToUrl("url of the page you want to get the option from");
//Finding the element. If element not present it throws exception so do remember to handle it.
var element = driver.FindElement(By.Id("ctl00_BodyContent_ddlChooseView"));
//No intializing the select element option.
SelectElement selectElem = new SelectElement(element);
selectElem.SelectByValue("H"); 
//or i can select option using text that is
selectElem.SelectByText("Option1"); 
}

}
}
</code> 
```

抱歉缩进。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T03:42:02.800

我认为您对可以做什么有点困惑`HtmlAgilityPack`...

`HtmlAgilityPack`- 只是一个praser。

从`browser's point of view`，选择其中一个选项将导致浏览器向页面发送`POST`类型请求。

您现在可以做的是，使用或模拟该`POST`请求，然后您将可以使用.`WebClient``HttpWebRequest``new web page``HtmlAgilityPack`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T03:42:28.880

这可以通过使用 selenium webdriver 轻松完成。阅读它，非常适合处理这种东西。

在这里，我首先选择使用 Webdriver 库获得选项的元素
`var selectElem = driver.FindElement(By.Id("ctl00_BodyContent_ddlChooseView"));`

现在使用 WebDriver.Support.UI 库我得到了所有的选项
`SelectElement selectOption = new SelectElement(selectElem);`

现在您可以对元素执行任何操作。即
喜欢
`selectOption.SelectByValue("here u give the value")`
或
`selectOption.SelectByText("here u give the value")`

还有更多……您会发现。

# r - 根据 R 中的另一列查找摘要

> ID：15036682
> 
> 赞同：0
> 
> 时间：2013-02-23T03:23:55.963
> 
> 标签：r, aggregate, summary

我有一个数据集，其中有 5 列。在一列中有日期，在第二列中有表面数据，在第 3 列底部，在第 4 个 id 和在第 5 个 diff 中。

例如我有一个简单的数据如下：

```
 Date   Surface Bottom  id  diff
250.0416718 17.49998283 17.50068474 apple   0.00070191
250.0833282 17.50042152 17.50049591 apple   7.44E-05
250.125 17.50060844 17.50074196 apple   0.00013352
250.1666718 17.50083923 17.50092125 apple   8.20E-05
250.2083282 17.50104713 17.50112343 apple   7.63E-05
250.25  17.50044441 17.50311279 apple   0.00266838
250.2916718 17.50193024 17.50263214 apple   0.0007019
250.3333282 17.50139427 17.50404167 apple   0.0026474
250.375 17.50112724 17.50495529 apple   0.00382805
250.4166718 17.50050163 17.50526428 apple   0.00476265
250.4583282 17.4996891  17.5043335  apple   0.0046444
250.5   17.50051117 17.50292969 apple   0.00241852
250.5416718 17.50112534 17.50325584 apple   0.0021305
250.5833282 17.50115585 17.50579262 apple   0.00463677
250.625 17.49997902 17.51161766 apple   0.01163864
250.6666718 17.50042725 17.51110268 apple   0.01067543
250.7083282 17.50220871 17.51453209 apple   0.01232338
250.75  17.50037193 17.51698685 apple   0.01661492
250.7916718 17.49991035 17.51932716 apple   0.01941681
250.8333282 17.49968529 17.51773262 apple   0.01804733
250.875 17.49991989 17.51846504 apple   0.01854515
250.9166718 17.50037575 17.51842499 apple   0.01804924
250.9583282 17.50083351 17.5181942  apple   0.01736069
250.0416718 17.4834671  17.52766609 orange  0.04419899
250.0833282 17.50394249 17.50412369 orange  0.0001812
250.125 17.50208092 17.50209427 orange  1.33E-05
250.1666718 17.50076485 17.50090981 orange  0.00014496
250.2083282 17.50046158 17.50056648 orange  0.0001049
250.25  17.50087547 17.50146103 orange  0.00058556
250.2916718 17.50173569 17.50222969 orange  0.000494
250.3333282 17.50191689 17.503088   orange  0.00117111
250.375 17.50203133 17.50272942 orange  0.00069809
250.4166718 17.50189781 17.50306129 orange  0.00116348
250.4583282 17.50161171 17.50306129 orange  0.00144958
250.5   17.50050735 17.50379753 orange  0.00329018
250.5416718 17.50190926 17.50399017 orange  0.00208091
250.5833282 17.49914932 17.5080471  orange  0.00889778
250.625 17.4993763  17.51009941 orange  0.01072311
250.6666718 17.50062752 17.50571442 orange  0.0050869
250.7083282 17.50298119 17.50680923 orange  0.00382804
250.75  17.50000572 17.51567268 orange  0.01566696
250.7916718 17.49908829 17.52041054 orange  0.02132225
250.8333282 17.49832535 17.52310562 orange  0.02478027
250.875 17.50114822 17.5190239  orange  0.01787568
250.9166718 17.50248909 17.51517487 orange  0.01268578
250.9583282 17.50420952 17.51499939 orange  0.01078987
250.0416718 17.48648453 17.54705238 banana  0.06056785
250.0833282 17.49559593 17.51511574 banana  0.01951981
250.125 17.50065994 17.50082779 banana  0.00016785
250.1666718 17.49912643 17.50104332 banana  0.00191689
250.2083282 17.49981308 17.50061226 banana  0.00079918
250.25  17.48498726 17.51077271 banana  0.02578545
250.2916718 17.50126648 17.50265312 banana  0.00138664
250.3333282 17.50064278 17.50525475 banana  0.00461197
250.375 17.49790573 17.5075798  banana  0.00967407
250.4166718 17.49773407 17.50739861 banana  0.00966454
250.4583282 17.49995041 17.50810432 banana  0.00815391
250.5   17.50090981 17.50782394 banana  0.00691413
250.5416718 17.49921417 17.50924492 banana  0.01003075
250.5833282 17.50100517 17.50682259 banana  0.00581742
250.625 17.49917221 17.51366425 banana  0.01449204
250.6666718 17.49997902 17.516119   banana  0.01613998
250.7083282 17.49642563 17.52497673 banana  0.0285511
250.75  17.50387573 17.52059746 banana  0.01672173
250.7916718 17.49860764 17.52764511 banana  0.02903747
250.8333282 17.49892616 17.52431297 banana  0.02538681
250.875 17.49625969 17.51802826 banana  0.02176857
250.9166718 17.49425125 17.51676941 banana  0.02251816
250.9583282 17.49142265 17.51862717 banana  0.02720452
250.0416718 17.49982834 17.50016785 Pomogranate 0.00033951
250.0833282 17.50012589 17.5002079  Pomogranate 8.20E-05
250.125 17.50020981 17.50033951 Pomogranate 0.0001297
250.1666718 17.50007057 17.50069427 Pomogranate 0.0006237
250.2083282 17.50011444 17.50080299 Pomogranate 0.00068855
250.25  17.49681091 17.49951553 Pomogranate 0.00270462
250.2916718 17.46898651 17.50089264 Pomogranate 0.03190613
250.3333282 17.45019341 17.5055275  Pomogranate 0.05533409
250.375 17.45742989 17.50874901 Pomogranate 0.05131912
250.4166718 17.46098709 17.50691414 Pomogranate 0.04592705
250.4583282 17.46137619 17.5025692  Pomogranate 0.04119301
250.5   17.45593262 17.50370407 Pomogranate 0.04777145
250.5416718 17.45370865 17.50605965 Pomogranate 0.052351
250.5833282 17.45739937 17.50655365 Pomogranate 0.04915428
250.625 17.4641552  17.49952126 Pomogranate 0.03536606
250.6666718 17.46249771 17.49928856 Pomogranate 0.03679085
250.7083282 17.46813965 17.49975586 Pomogranate 0.03161621
250.75  17.47341919 17.50149536 Pomogranate 0.02807617
250.7916718 17.47782135 17.50320625 Pomogranate 0.0253849
250.8333282 17.47783089 17.50071907 Pomogranate 0.02288818
250.875 17.47754288 17.50206757 Pomogranate 0.02452469
250.9166718 17.47626305 17.50252533 Pomogranate 0.02626228
250.9583282 17.47546768 17.50405693 Pomogranate 0.02858925 
```

我想根据“id”列中的 id 找到每列“surface”、“bottom”和“diff”的摘要。我尝试使用如下代码：

```
jdbaba <- read.csv("statssal.csv")
summary(jdbaba)
sapply(jdbaba,summary) 
```

但我无法找到每个 id 的摘要。

**编辑：** 例如，我想要每个 id 的列差异摘要，例如苹果、橙色等。

可以在此处找到 csv 数据文件[https://www.dropbox.com/s/fxiavvt1eqlkig8/statssal.csv](https://www.dropbox.com/s/fxiavvt1eqlkig8/statssal.csv)

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-23T03:35:54.047

这是你想要的吗？

```
by(jdbaba[c("Surface","Bottom", "diff")], jdbaba$id, summary) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-23T03:36:57.363

```
> aggregate( dat[, c(2:3, 5)] , dat[4], summary)
           id Surface.Min. Surface.1st Qu. Surface.Median Surface.Mean Surface.3rd Qu.
1       apple        17.50           17.50          17.50        17.50           17.50
2      banana        17.48           17.50          17.50        17.50           17.50
3      orange        17.48           17.50          17.50        17.50           17.50
4 Pomogranate        17.45           17.46          17.47        17.47           17.49
  Surface.Max. Bottom.Min. Bottom.1st Qu. Bottom.Median Bottom.Mean Bottom.3rd Qu.
1        17.50       17.50          17.50         17.50       17.51          17.52
2        17.50       17.50          17.51         17.51       17.51          17.52
3        17.50       17.50          17.50         17.50       17.51          17.52
4        17.50       17.50          17.50         17.50       17.50          17.50
  Bottom.Max. diff.Min. diff.1st Qu. diff.Median diff.Mean diff.3rd Qu. diff.Max.
1       17.52 0.0000744    0.0014160   0.0046370 0.0074860    0.0144700 0.0194200
2       17.55 0.0001678    0.0063660   0.0144900 0.0159500    0.0239500 0.0605700
3       17.53 0.0000133    0.0006418   0.0032900 0.0081410    0.0117400 0.0442000
4       17.51 0.0000820    0.0128000   0.0285900 0.0277800    0.0435600 0.0553300 
```

# python - 2D Python 列表会有随机结果

> ID：15036694
> 
> 赞同：1
> 
> 时间：2013-02-23T03:25:24.110
> 
> 标签：python, list

我创建了一个 10 x 10 的游戏板。这是一个 2D 列表，里面有另一个 2 列表。我用过 `board = [[['O', 'O']] * 10 for x in range(1, 11)]`。所以它会产生类似的东西

['O', 'O'] ['O', 'O']...

['O', 'O'] ['O', 'O']...

稍后我想设置一个单元格来设置“C”，我使用`board.gameBoard[animal.y][animal.x][0] = 'C'` board 作为 gameBoard 所在的类，而 animal 是一个游戏块，x 和 y 只是整数。有时它会起作用，指定的单元格将变为 ['C', 'O']，其他时候它将用 ['C', 'O']['C', 'O'][' 填充整行C', 'O']['C', 'O'] 有谁知道为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T03:27:54.153

基本上，您正在创建一大堆对同一个列表的引用——为了演示，请考虑：

```
[ [] ]*10 
```

如果您打印`id`s：

```
>>> print map(id,[ [] ]*10)
[958336, 958336, 958336, 958336, 958336, 958336, 958336, 958336, 958336, 958336] 
```

你会看到它们都是一样的：

最简单的解决方法是执行以下操作：

```
[ [['O','O'] for _ in range(10)] for x in range(1, 11) ] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T03:28:00.393

别担心，很多人都和你落入了同样的陷阱。

`[['O', 'O']] * 10`[*创建相同列表的*](https://stackoverflow.com/a/15036705/1907098)10 个副本。这意味着当您更改其中一个列表中的元素时，更改会反映在所有其他列表中。

改为创建 10 个单独的列表：

```
[[['O', 'O'] for j in range(10)] for i in range(10)]  # or xrange in Python 2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T03:29:13.727

您的电路板正在获得对同一个数组的多个引用。您需要`* 10`用另一个列表理解替换。

# javascript - 有没有其他方法可以在 javascript 中引用 grandParent 对象

> ID：15036696
> 
> 赞同：4
> 
> 时间：2013-02-23T03:26:39.180
> 
> 标签：javascript

我有以下代码：

```
var objectParent:{
     child1:{
       test1:function(){},
       test2:function(){}
      },

      child2:{
       demo1:function(){},
       demo2:function(){},
       parent:this  // gives child2
       grandparent: .... // need to reference objectParent here

      }

    } 
```

我们可以使用**这个**关键字来引用对象，但是对于大对象或者我的意思是父对象的父对象呢？

现在，我正在使用**grandparent:objectParent**来引用父对象

有没有像**这个**选择器那样引用父对象的其他方式？

这些是我的编码是坏的、好的还是更好的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-23T03:47:59.727

如果您的所有对象都具有`parent`引用其父级的属性，则可以使用`object.parent.parent`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T03:31:32.150

目前尚不清楚您要做什么。

如果您有一个元素引用`elem`，那么您可以使用`elem.parentNode`. 你可以得到一个父母的父母（例如祖父母）`elem.parentNode.parentNode`等等。

如果这不是您想要做的，请更详细地解释您所说的祖父母对象的含义。

* * *

如果您根本不是在谈论 DOM 引用，而是在询问纯 javascript 中的嵌套对象，那么 javascript 不包含任何获取包含在其中的父对象的方法。您必须在子对象上创建一个属性并在构建对象后以这种方式设置它（您也不能使用静态声明来设置它）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-06-25T06:38:37.280

我必须做`div.parentElement.parentElement`才能实现它。

查看要访问的内容的一种方法是登录`div.__proto__`到控制台，该控制台会显示一长串您可以调用的属性和方法。

# php - Highrise API - 如何使用 XML 和操作变量

> ID：15036697
> 
> 赞同：0
> 
> 时间：2013-02-23T03:26:48.757
> 
> 标签：php, xml, api, parsing

使用带有 api 令牌的 curl 并将 XML 元素放入工作变量或至少以 html 格式查看。

这是执行 vardump 的代码：

```
$curl = curl_init('https://mywebsite.highrisehq.com/people.xml');
curl_setopt($curl,CURLOPT_RETURNTRANSFER,true);
curl_setopt($curl,CURLOPT_USERPWD,'myapitoken12345:x');
curl_setopt($curl,CURLOPT_SSL_VERIFYPEER,0);
curl_setopt($curl,CURLOPT_SSL_VERIFYHOST,0);

$data = curl_exec($curl);
curl_close($curl);  

$people_xml = new SimpleXMLElement($data);
var_dump($people_xml); 
```

在执行 var_dump 时，输出不是我所熟悉的。

```
object(SimpleXMLElement) #1 (2) { 
["@attributes"]=> array(1) { 
["type"]=> string(5) "array" } 
["person"]=> array(128) { ...  etc. etc. etc... 
```

HighriseHQ.com 显示的 XML 结构是这样的，用于获取有关如何检索元素的线索。

```
<people type="array">
  <person>
  <first-name>John</first-name>
  </person>
  <person>
  <first-name>Jane</first-name>
  </person>
</people>
  .... etc. etc. 
```

我如何或在哪里将所说的部分翻译`$people = simplexml_load_string($xml);`成我可以使用的变量？最终，我想显示、编辑或存储这些人，因为我将与高层同步网站数据库 - 这样便笺和联系人不会过时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T21:23:52.657

找到了解决方案。

```
$curl = curl_init('https://my_website_goes_here.highrisehq.com/people.xml');
curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
curl_setopt($curl, CURLOPT_USERPWD, 'my_api_token_goes_here:x');

curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, 0);
curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, 0);

$data = curl_exec($curl);
curl_close($curl);

$people_xml = new SimpleXMLElement($data);

foreach($people_xml->person as $person) {
    echo "<strong>" . $person->{'first-name'} . " " . $person->{'last-name'} . "</strong><br />";
    echo "Title: " . $person->{'title'} . "<br />";
    echo "Background: " . $person->{'background'} . "<br />";
    echo "Email: " . $person->{'email-address'} . "<br />";
    echo "ID: " . $person->id . "<br /><br />";
} 
```

# javascript - 使用回调 url 创建 facebook 应用程序

> ID：15036706
> 
> 赞同：20
> 
> 时间：2013-02-23T03:27:56.157
> 
> 标签：javascript, node.js, facebook, oauth-2.0, passport.js

我正在创建一个 Facebook 应用程序。我想让用户使用它（使用passportjs）登录我的网站。

但要做到这一点，我需要提供回调 url（我的网站 url）。但我在 facebook 应用程序创建页面中找不到该字段。

我错过了什么吗？我已经搜索了很长时间。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2014-02-02T07:08:12.603

截至 2014 年 2 月 2 日写作，我发现这些说明是最新的；

1.  转到您的应用
2.  在左侧边栏上，单击设置
3.  在主要部分下，单击添加平台
4.  点击“网站”
5.  在站点 URL 字段中指定您的回调（例如`http://localhost:3000/auth/facebook/callback)`.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-24T17:06:40.007

1.  转到您的应用程序。
2.  在左侧边栏上，单击设置。
3.  在主要部分下，单击添加平台。
4.  点击“网站”。
5.  在站点 URL 字段中指定您的回调（例如[http://localhost:3000/auth/facebook/callback](http://localhost:3000/auth/facebook/callback)）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-06-24T19:38:21.343

回调 URL 必须在 Clint O 身份验证设置中提供，以便 facebook 在用户通过您的应用程序登录 facebook 后发送用户凭据和访问令牌。Facebook 的开发者网站 UI 再次更改。现在客户端 OAuth 设置块已移至 Facebook 登录。提供回调 URL 现在路径是

您的应用仪表板 > 在左侧边栏 > facebook 登录 > Clint Oauth 设置 > 有效的 OAuth 重定向 URI

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-10-04T20:22:18.970

“回调 URL”是用户接受或拒绝 OAuth 请求后将联系的 URL。

这被设置为您的 OAuth 请求的参数。所以你在自己的程序中设置 URL，而不是在 Facebook 的某个地方。

在 Java/Spring 社交中，你会这样做：

```
OAuth2Parameters params = new OAuth2Parameters();
params.setRedirectUri("http://yoursite/callback"); 
```

设置后，它还必须与 sivanagaraju 的回答中提到的“有效 OAuth 重定向 URL”匹配，否则 Facebook 将拒绝它。在您的应用程序下的“Facebook 登录”选项卡中，输入所有有效的回调 URL，例如[http://localhost/callback](http://localhost/callback)、[http://productionUrl/callback](http://productionUrl/callback)等。

如果您的应用下没有看到“Facebook 登录”选项卡，请单击“添加产品-> Facebook 登录-> 开始”输入有效回调网址-> 保存更改。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-08-08T18:55:02.907

1.  转到 Facebook 开发人员页面。
2.  在左侧栏中的“产品”下，您将看到或需要添加 Facebook 登录产品。
3.  添加后，您可以转到 Facebook 登录设置并将您的 URL 添加到“有效 OAuth 重定向 URI”

# wordpress - wordpress 无缘无故地剥离代码

> ID：15036709
> 
> 赞同：0
> 
> 时间：2013-02-23T03:28:13.607
> 
> 标签：wordpress

看在上帝的份上，有人可以告诉我为什么这段代码在 WP 页面编辑器中不断被剥离。我根本无法切换到视觉。我必须始终使用 HTML。如果我不这样做，WordPress 会不断删除代码。到底是怎么回事？

```
</div>
<div class="art-layout-cell layout-item-4" style="width: 68%"> 
 <div style="font-size:0">
  <div id="bc9d86d7ebcb478ea75fec22a82fc804" style="position: relative; display: inline-block; z-index: 0; margin: 0px; border-width: 0px; " class="art-collage"> 
   <div class="art-slider art-slidecontainerbc9d86d7ebcb478ea75fec22a82fc804"> 
    <div class="art-slider-inner"> 
     <div class="art-slide-item art-slidebc9d86d7ebcb478ea75fec22a82fc8040"></div>
     <div class="art-slide-item art-slidebc9d86d7ebcb478ea75fec22a82fc8041"></div>
     <div class="art-slide-item art-slidebc9d86d7ebcb478ea75fec22a82fc8042"></div>
    </div>
   </div>
   <div class="art-slidenavigator art-slidenavigatorbc9d86d7ebcb478ea75fec22a82fc804">
    <a href="#" class="art-slidenavigatoritem"></a>
    <a href="#" class="art-slidenavigatoritem"></a>
    <a href="#" class="art-slidenavigatoritem"></a>
   </div>
  </div>
 </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T04:18:31.407

本文解释了如何解决 Wordpress 在其编辑器中处理 HTML 的方式的常见问题：

[http://smartypants.com/blogs/index.php/2012/08/06/a-fix-for-html-issues-with-the-wordpress-visual-editor/](http://smartypants.com/blogs/index.php/2012/08/06/a-fix-for-html-issues-with-the-wordpress-visual-editor/)

本质上它解释了下载这个插件： [http ://wordpress.org/extend/plugins/disable-wpautop/](http://wordpress.org/extend/plugins/disable-wpautop/)

并通过此“插件”将 Wordpress 的编辑器 TinyMCE 升级到其自身的高级版本： [http ://www.laptoptips.ca/projects/tinymce-advanced/](http://www.laptoptips.ca/projects/tinymce-advanced/)

干杯

# tidesdk - 将窗口定位到窗口的右下角？

> ID：15036710
> 
> 赞同：0
> 
> 时间：2013-02-23T03:28:15.430
> 
> 标签：tidesdk

如何将窗口定位到窗口的右下角？我正在考虑获取用户屏幕的最大宽度和最大高度，然后减去几个像素，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T15:44:53.867

您可以使用屏幕大小（`window.screen.width`和`window.screen.height`）和窗口大小来计算窗口左上角的所需位置，然后将其放置在那里：

```
var app_window=Ti.UI.getCurrentWindow();
app_window.setX(window.screen.width-app_window.getWidth());
app_window.setY(window.screen.height-app_window.getHeight()); 
```

# macos - 可扩展性如何？

> ID：15036711
> 
> 赞同：0
> 
> 时间：2013-02-23T03:28:15.927
> 
> 标签：macos, launchd

我正在考虑实施launchd 来查看我计算机上的文件结构。使用监视路径来判断其中一个目录是否发生更改，尽管我需要创建一个新的属性列表文件来说明每个目录。我的论点是它的可扩展性。如果我观看 10、100、1000 或更多目录，我会注意到我的计算机性能下降，还是观看这么多路径集中在内存而不是处理所消耗的资源？

这些作业将用于处理文件被删除或重命名时，并将更新此文件结构根目录中的清单，因此我的应用程序无需遍历树即可知道哪些文件在哪里；我正在尝试使应用程序更具响应性和意识。这些作业应该是守护进程还是代理？我假设是代理，因为我看不出如何在没有用户登录的情况下修改此结构，尽管这些作业不需要创建 gui。

launchd 的可扩展性是否足以以这种方式处理任意大小的文件结构？

还有其他选择吗？（便携性会很好。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T06:30:10.713

使用 FSEvents 或 kqueues 更好地处理文件是否已被重命名或以其他方式修改。

# c - 在C中修剪char数组

> ID：15036715
> 
> 赞同：1
> 
> 时间：2013-02-23T03:28:28.543
> 
> 标签：c, scanf, arrays, trim

我正在处理一项作业，我注意到我的编码作业存在问题。我不清楚如何解决这个问题，可能是因为睡眠不足，但无论如何。我需要为这个分配修剪它的空白字符数组。

我想到的解决方案涉及第二个 char 数组，只需将非空格复制到该数组即可。但是我如何在不知道它的大小的情况下创建一个 char 数组，因为那时我还不知道它的大小。我仍然需要修剪它才能知道需要将多少个字符复制到新数组中，这在分配中有所不同

我知道关于 stackoverflow 有很多很好的问题，但我认为这更多地与思考过程有关，而不是与正确的语法有关。

我的第二个问题是如何在 char 数组上执行 fscanf/fgetc，因为它需要一个流，给它一个指针而不是一个流就足够了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T03:35:14.473

如果简单地进行就地更改，则将每个字符移回一个空格，然后重复直到数组的末尾。这是非常低效的。

如果制作一个新副本，请制作一个相同长度的新数组，然后像以前一样做（复制所有非空格字符）。如果您也复制`\0`字符，则不会出现字符串终止问题。这效率更高。

* * *

根据您的评论，您似乎可以选择以您希望的任何形式输入数组。然后，我建议不要稍后进行文本操作，而只需以您需要的形式输入字符串。

您可以简单地使用`scanf`or`fscanf`重复，将单独的单词输入到同一个数组中。这将处理所有空格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T03:43:24.223

这是一个部分想法：您可以对 char 数组进行第一次传递并计算空格，然后将字符串长度减去第二个数组的空格，然后跳过空格执行复制。

您还可以通过数组创建一个传递：

测试直到数组结束：

我的（当前/索引）位置是空白的吗？（空间）

如果是这样，请获取下一个可用的非空白值并将其放在那里。

然后索引++

如果没有，索引++

不确定第二个，会做一些检查，看看我是否也能在那里找到一个好的答案。

# java - java在apache pdfbox中跳过catch子句直接跳转到finally

> ID：15036723
> 
> 赞同：8
> 
> 时间：2013-02-23T03:30:29.560
> 
> 标签：java, apache, try-catch, pdfbox, finally

我双手插在头发上。

我正在使用 Apache PDFBox，因为我想在 JAVA 中逐行读取 pdf 文件并稍后处理内容。但是我有以下问题.. 我在一个单独的 java 程序中使用了下面的代码（在 main 方法中），它在那里工作正常。但是，当我在我的 tomcat 服务器小程序中将它与石英调度程序结合使用时，出现了问题，我不知道为什么。请记住，我将下面的行从工作的单独测试程序复制+粘贴到我自己更大的项目中，所以它是完全相同的代码。然而，在我更大的项目中，程序一直运行到我放置断点的 String x1 = .. 行。当我尝试跳过它时，它不会给出任何错误、控制台输出或任何东西，而是直接跳过 catch 子句。我在 catch 子句中放了断点，它们

这是我的代码：

```
 PDFTextStripper stripper;
    PDDocument doc = null;      
    try{
      doc = PDDocument.load("00026614_F_21Jan2013-18Feb2013.pdf");
      stripper = new PDFTextStripper();
      String x1= stripper.getText(doc);    //SOMETHING GOES WRONG HERE
      //break up the file content returned as a string into individual lines
      List<String> ans= Arrays.asList(x1.split("\r\n"));//THIS IS NEVER REACHED
    }
    catch(Exception e){
        e.printStackTrace();    //THIS IS NEVER REACHED EITHER
    }
    finally{
       if(doc!=null) //IT GOES FROM STRING X1 STRAIGHT TO HERE.
       doc.close();
    } 
```

我得到的唯一输出来自 LOG4J，它必须为程序的其他部分初始化，最后几行输出是

```
34212 [DefaultQuartzScheduler_Worker-1] DEBUG org.apache.pdfbox.util.PDFStreamEngine  - processing substream token: PDFOperator{Tm}
34212 [DefaultQuartzScheduler_Worker-1] DEBUG org.apache.pdfbox.util.PDFStreamEngine  - processing substream token: COSName{ttf0}
34212 [DefaultQuartzScheduler_Worker-1] DEBUG org.apache.pdfbox.util.PDFStreamEngine  - processing substream token: COSInt{10}
34212 [DefaultQuartzScheduler_Worker-1] DEBUG org.apache.pdfbox.util.PDFStreamEngine  - processing substream token: PDFOperator{Tf} 
```

现在让我烦恼的是我如何才能弄清楚那个电话出了什么问题？就像我说的，如果我将代码放在单独的 java 程序中，它运行良好.. 但我无法获得任何错误输出或捕获任何异常（我正在尝试捕获异常，即使它应该给出 IOException 并且是的我也试过了）。

我希望你们中的任何人都知道该怎么做。亲切的问候

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-02-26T20:03:09.063

看起来有人已经回答了这个问题，但是为错误添加一个 catch 可以解决我遇到的类似问题。

我在异常的“catch”之后添加了这个“catch”（用于错误）：

```
catch (Error err){
    err.printStackTrace();
    throw (err);
} 
```

# c - 在 Ubuntu 中从 Eclipse 运行 C 代码时如何设置 CPU 亲和性？

> ID：15036725
> 
> 赞同：2
> 
> 时间：2013-02-23T03:30:43.320
> 
> 标签：c, eclipse, ubuntu, affinity

我可以使用“taskset -c 0 ./out”从终端执行此操作。我怎样才能从 Eclipse 做同样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-27T17:26:19.840

尝试这个

```
/* must be root to use these sched_function-----------------------*/

#define CPU_N 0 // affinity process

 void fix_affinity()
    {
      int error=0;
      cpu_set_t mask;
      /*  mask init  */
      CPU_ZERO(&mask);
      /* add CPU_N to  the mask */
      CPU_SET(CPU_N,&mask);

      /**
         test root access
      **/

      if(getuid()==0)
        {
          /*change affinity of process */
          error=sched_setaffinity(0,sizeof(cpu_set_t),&mask);
        }
      else
        {
          printf("must be root to change affinity\n");
        }
      if(error<0)
        {
          printf("sched_setaffinity() failed \n");
        }

    } 
```

只需在您的代码中调用它

```
 fix_affinity(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-06T10:27:20.430

运行 -> 运行配置 -> 参数（选项卡）

添加

**/C "tasket -c 0 .\out"**

# linux - Init.d 脚本导致启动挂起

> ID：15036726
> 
> 赞同：0
> 
> 时间：2013-02-23T03:31:06.333
> 
> 标签：linux, debian, init, raspberry-pi, init.d

我成功安装了一个脚本以在我的新 Raspberry Pi 上的 /etc/init.d 中自动启动。

不幸的是，它是一个永远不会返回的 node.js 应用程序，因此在启动期间会挂起设备（这是在 Debian 上）。是的，我是个白痴。

在启动期间是否可以进行秘密握手以防止它运行我的 init.d 脚本，以便我可以登录并使用 shell 来修复它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T04:07:54.850

我为解决这个问题所做的就是这个，我警告你，它涉及 Windows。

我在我的 PC 上安装了闪存卡并编辑了“cmdline”并将“ro 1”添加到内核配置的末尾。这仅允许引导通过运行级别 1 继续，然后在提示后将您放入 root shell。

注意：Windows 8 可以读取未经修改的内核配置文件 - 不需要特殊的驱动程序。

# php - 尝试 Catch 不起作用？

> ID：15036734
> 
> 赞同：1
> 
> 时间：2013-02-23T03:31:54.737
> 
> 标签：php

我不能`try`工作。我试过这个：

```
try {
    echo 1/0;
    } catch (Exception $e) {
    echo 'Caught exception: ',  $e->getMessage(), "\n";
    } 
```

导致错误：

```
Warning: Division by zero in /var/www/vhosts/saliganando.com/webs/momemi/apis/interpret-bot.php on line 6 
```

我尝试修改 error_reporting() 和 ini_set() 但我只设法删除警告或显示它，但从未显示“捕获异常...”。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T03:32:38.953

该代码永远不会产生异常。它会生成警告。您需要在错误处理程序（使用[`set_error_handler()`](http://php.net/set_error_handler)）中捕获警告以处理该错误。

有关异常如何工作以及如何捕获它们的大量示例，请参阅[有关异常的文档，其中包括模仿您正在寻找的功能的示例：](http://www.php.net/manual/en/language.exceptions.php)

```
function inverse($x) {
    if (!$x) {
        throw new Exception('Division by zero.');
    }
    else return 1/$x;
}

try {
    echo inverse(5) . "\n";
    echo inverse(0) . "\n";
} catch (Exception $e) {
    echo 'Caught exception: ',  $e->getMessage(), "\n";
} 
```

生成：

```
0.2
Caught exception: Division by zero. 
```

# android - 从不同的包启动活动的问题

> ID：15036741
> 
> 赞同：0
> 
> 时间：2013-02-23T03:32:52.840
> 
> 标签：android

嗨，我目前在我的 android 应用程序中有两个包说`com.packagea`和`com.packageb`。现在我正在尝试通过以下代码`com.packageb`从一个活动中激活一个活动`com.packagea`

```
 String username = ((android.widget.EditText)findViewById(R.id.editUserName)).getText().toString();
    String pass = ((android.widget.EditText)findViewById(R.id.editPass)).getText().toString();
    Intent i = new Intent(this, Authenticate.class);
    i.putExtra("uname", username);
    i.putExtra("pass",pass);
    startActivityForResult(i, 1); 
```

但是它甚至不会进入 Authenticate.class 中的`com.packageb`. 任何建议为什么它不在那个班级。这是我在清单文件中声明活动的方式

```
 <activity
        android:name=".Authenticate"
        android:label="@string/title_activity_options" >
    </activity> 
```

我需要指定一个包名吗？这只发生在我尝试从不同的包中调用活动时。有关如何解决此问题的任何建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T04:08:33.417

尝试使用完全限定名称：

```
 com.packageb.Authenticate

    <activity
      android:name="com.packageb.Authenticate"
      android:label="@string/title_activity_options" >
  </activity> 
```

代替

```
 <activity
    android:name=".Authenticate"
    android:label="@string/title_activity_options" >
</activity> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T05:15:10.157

如果 Authenticate 活动在 com.packageb 中，并且您尝试从 com.packagea 包中调用它，则可以使用ceonvenience方法[Intent.setClassName()](http://developer.android.com/reference/android/content/Intent.html#setClassName%28java.lang.String,%20java.lang.String%29)：

```
Intent i = new Intent();
i.setClassName("com.packageb", "com.packageb.Authenticate");
... 
```

# asp.net - AjaxFileUpload 问题未正确显示

> ID：15036748
> 
> 赞同：0
> 
> 时间：2013-02-23T03:34:38.320
> 
> 标签：asp.net, ajax, ajaxcontroltoolkit

我最近开始处理一个新项目，并且在使用 AjaxControlToolkit（更具体地说是 AjaxFileUpload 控件）时遇到了一些困难。我已经成功地使用了这个工具包并控制了其他项目，但我不确定这个工具包发生了什么。我引用了 AjaxControlToolkit，将所需的行放入我的 web.config，将所需的行放入我的 aspx 页面并设置脚本管理器，一切似乎都很好。该站点启动时没有错误，并且显示出来但它无法正常工作。基本上显示的是一个黑色的框，看起来像“上传”按钮，单击该按钮可以让我选择一个文件。但是，控件的其他功能都不起作用。

在此处查看图片：http: [//img571.imageshack.us/img571/3417/screenshot20130223at111.png](http://img571.imageshack.us/img571/3417/screenshot20130223at111.png)

```
<%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="AjaxControlToolkit" %> //at top of page

<AjaxControlToolkit:ToolkitScriptManager ID="tsm1" runat="server"></AjaxControlToolkit:ToolkitScriptManager> //on page

<AjaxControlToolkit:AjaxFileUpload ID="ajaxupload1" runat="server" />//on page
        <pages>//web.config
        <controls>
            <add tagPrefix="AjaxControlToolkit" namespace="AjaxControlToolkit" assembly="AjaxControlToolkit"/>
        </controls>
    </pages> 
```

正如我所说，该项目可以正常构建和启动，没有错误，并且正如您在屏幕截图中看到的那样，它尝试构建控件，但有些问题......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T22:39:32.180

这是我的 web.config 中的东西，不是 100% 确定是什么，但我正在搞砸它并让它正常工作。因此，如果其他人有此问题，则可能是您的 web.config 中的某些内容:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-28T15:20:35.890

我必须将此添加到我的 web.config 文件中：

```
<handlers>
  <add name="AjaxFileUploadHandler" verb="*" path="AjaxFileUploadHandler.axd" type="AjaxControlToolkit.AjaxFileUploadHandler, AjaxControlToolkit"/>
</handlers> 
```

# jquery - 如何使用 jquery 将元素移动到第三个位置？

> ID：15036753
> 
> 赞同：1
> 
> 时间：2013-02-23T03:35:31.630
> 
> 标签：jquery

请在这件事上给予我帮助。我有：

```
<ul>
  <li>
    <h2>Headline for element 1</h2>
    <p>Lorem ipsum dolor sit amet quosque tandem.</p>
  </li>
  <li>
    <h2>Headline for element 2</h2>
    <p>Lorem ipsum dolor sit amet quosque tandem.</p>
  </li>
  <li>
    <h2>Headline for element 3</h2>
    <p>Lorem ipsum dolor sit amet quosque tandem.</p>
  </li>
  <li>
    <h2>Headline for element 4</h2>
    <p>Lorem ipsum dolor sit amet quosque tandem.</p>
  </li>
  <li>
    <h2>Headline for element 5</h2>
    <p>Lorem ipsum dolor sit amet quosque tandem.</p>
  </li>
</ul> 
```

这就是我想要做的：

*   每次单击列表项时，它都会移动到中心位置（第 3 位）并应用“活动”类。

我在 jQuery 中有这个：

```
jQuery(document).ready(function(){

var third = $("ul li:eq(1)");

$("ul li").click(function() {
$("ul li").removeClass("active"); //Remove any "active" class
$(this).insertAfter(third);
$(this).addClass("active"); //Add "active" class to selected tab
});
}); 
```

但它不适用于第一个和第二个元素。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T04:17:04.027

> *“但它不适用于第一个和第二个元素。”*

那是因为当您移动项目时，其他项目会向上移动以填补空白。我建议您首先[`.detach()`](http://api.jquery.com/detach/)考虑有问题的项目，*然后*在重新插入分离的项目之前计算剩余元素中的中间位置。

另请注意，您在此处创建的变量：

```
var third = $("ul li:eq(1)"); 
```

...将引用列表中的第二项，*就像第一次加载文档时一样。*重新排序列表时，它*不会*自动更新以引用第二个项目。`third`（此外，调用引用*第二*项的变量没有意义。）您需要计算`.click()`处理程序中的中间位置：

```
jQuery(document).ready(function(){
  $("ul li").click(function() {
    $("li.active").removeClass("active"); //Remove any "active" class
    var $active = $(this).detach().addClass("active"),
        $lis = $("ul li");
    $active.insertBefore($lis.eq(Math.floor($lis.length / 2)));
  });
}); 
```

演示：http: [//jsbin.com/avupud/1/edit](http://jsbin.com/avupud/1/edit)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T04:16:17.103

尝试更改为`$(this).insertAfter("ul li:eq(1)");`

# r - R包xtable，如何从R创建具有多行和多列的乳胶表

> ID：15036754
> 
> 赞同：19
> 
> 时间：2013-02-23T03:35:52.480
> 
> 标签：r, latex

我的目标是使用 R 中的多行/多列功能创建乳胶表。我想要的乳胶表应该如下所示：

```
 colLabel  |  colLabel2
                         |
                 a1  a2  |   a3    a4  
 -------------------------------------
             b1  1    2  |   5     6
 rowLabel1               |
             b2  3    4  |   7     8
 --------------------------------------
             b3  9   10  |   13    14
 rowLabel2               |
             b4  11  12  |   15    16
 -------------------------------------- 
```

我目前正在使用 xtable，但我无法弄清楚如何使用这个包创建多行。谁能告诉我如何创建这样的表？

先感谢您

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2015-09-09T23:13:03.770

我只想指出 Christoph 的块条目[（此处）](http://christophj.github.io/replicating/r/how-to-produce-nice-tables-in-pdfs-using-knitr-sweave-and-r/)和 Gabor 在 R 邮件列表[（此处）](https://stat.ethz.ch/pipermail/r-help/2007-November/144981.html)中使用该`xtable`包的答案的组合。此外，该解决方案能够以这种方式合并单元格`\multirow`。

这是一个**MWE**：

```
require(xtable)

# set up data frame
df <- data.frame(c(replicate(2, c("L1")), replicate(2, c("L2"))),
                 replicate(4, "b"),
                 replicate(4, runif(4, 1, 10)) )

# only needed if first column consists of numbers
df[[1]] <- as.character(df[[1]])

rle.lengths <- rle(df[[1]])$lengths
first <- !duplicated(df[[1]])
df[[1]][!first] <- ""

# define appearance of \multirow
df[[1]][first] <-
   paste0("\\midrule\\multirow{", rle.lengths, "}{*}{\\textbf{", df[[1]][first], "}}")

strCaption <- paste0("\\textbf{Table Whatever} This table is just produced with some ",
                     "random data and does not mean anything. Just to show you how ",
                     "things work.")

# set up xtable output
print(xtable(df, digits = c(0, 0, 0, 3, 1, 0, 6), # first zero "represents" row numbers which we skip later
             align = "lllrr|rr",  # align and put a vertical line (first "l" again represents column of row numbers)
             caption = strCaption, label = "testTable"),
      size = "footnotesize", #Change size; useful for bigger tables "normalsize" "footnotesize"
      include.rownames = FALSE, #Don't print rownames
      include.colnames = FALSE, #We create them ourselves
      caption.placement = "top", #"top", NULL
      hline.after=NULL, #We don't need hline; we use booktabs
      floating=TRUE, # whether \begin{Table} should be created (TRUE) or not (FALSE)
      sanitize.text.function = force, # Important to treat content of first column as latex function
      add.to.row = list(pos = list(-1,
                                   2,
                                   nrow(df)),
                        command = c(paste("\\toprule \n",  # NEW row
                                          "\\multicolumn{2}{c}{} & \\multicolumn{2}{c}{\\textbf{colLabel1}} & \\multicolumn{2}{c}{colLabel2} \\\\\n",
                                          "\\cmidrule(l){3-4} \\cmidrule(l){5-6}\n",
                                          " & & a1 & a2 & a3 & a4 \\\\\n", # NEW row 
                                          "\\midrule \n"
                                          ),
                                    paste("\\cmidrule(l){3-4} \\cmidrule(l){5-6}\n" # we may also use 'pos' and 'command' to add a midrule
                                          ),
                                    paste("\\bottomrule \n"  # paste is used as it is more flexible regarding adding lines
                                          )
                                    )
                        )
      ) 
```

在 LaTeX 中编织下表：

[![在此处输入图像描述](../Images/80d6bb94bb2a277a6d4a64ae5f511493.png)](https://i.stack.imgur.com/chogv.png)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-23T05:47:10.117

您将必须更具体地了解您想要制表的具体内容，但我猜包装中`tabular`的功能`tables`可能会有所帮助。

这是根据 4 个二元因子变量对变量均值进行制表的示例：

```
mydf <- data.frame(rowFactor1 = sample(letters[1:2], 100, replace = TRUE), 
                colFactor1 = sample(LETTERS[1:2], 100, replace = TRUE), 
                x = rnorm(100), 
                rowFactor2 = sample(1:2, 100, replace = TRUE), 
                colFactor2 = sample(1:2, 100, replace = TRUE))

tab1 <- tabular(Heading()*RowFactor(rowFactor2, spacing = 1, 
                        levelnames = c("rowLabel1", "rowLabel2"))*
                Heading()*RowFactor(rowFactor1, 
                        levelnames = c("b1", "b2")) ~ 
                Heading()*Factor(colFactor2, 
                        levelnames = c("colLabel1", "colLabel2") )*
                Heading()*Factor(colFactor1, 
                        levelnames = c("a1", "a2"))*
                Heading()*(x)*Heading()*(mean), 
        data = mydf) 
```

这给了你这样的东西，但在使用乳胶输出时格式很好

```
 colLabel1         colLabel2        
                                                                a1        a2      a1        a2     
 \\nopagebreak rowLabel1                       \\nopagebreak b1 -0.1450    0.2633  0.91454   0.1222
                                               \\nopagebreak b2 -0.1499   -0.4290 -0.09706  -0.6977
 \\rule{0pt}{1.7\\normalbaselineskip}rowLabel2 \\nopagebreak b1  0.6976   -0.4888 -0.68492   1.6764
                                               \\nopagebreak b2 -0.2369   -0.1428 -0.66405   0.9469 
```

最后`latex(tab1)`给你乳胶代码：

```
\begin{tabular}{llcccc}
\hline
& & \multicolumn{2}{c}{colLabel1} & \multicolumn{2}{c}{colLabel2} \\ 
 &  & a1 & a2 & a1 & \multicolumn{1}{c}{a2} \\ 
\hline
\nopagebreak rowLabel1 & \nopagebreak b1  & $-0.1450$ & $\phantom{-}0.2633$ & $\phantom{-}0.91454$ & $\phantom{-}0.1222$ \\
 & \nopagebreak b2  & $-0.1499$ & $-0.4290$ & $-0.09706$ & $-0.6977$ \\
\rule{0pt}{1.7\normalbaselineskip}rowLabel2 & \nopagebreak b1  & $\phantom{-}0.6976$ & $-0.4888$ & $-0.68492$ & $\phantom{-}1.6764$ \\
 & \nopagebreak b2  & $-0.2369$ & $-0.1428$ & $-0.66405$ & $\phantom{-}0.9469$ \\
\hline 
\end{tabular} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-08-01T14:27:52.247

考虑[`kableExtra`包](http://haozhu233.github.io/kableExtra/awesome_table_in_pdf.pdf)。

```
\documentclass{article}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage[table]{xcolor}
\begin{document}

<<setup, include=FALSE>>=
library(knitr)
opts_chunk$set(echo=FALSE)
library(kableExtra)
options(knitr.table.format = "latex")
dat <- data.frame(
  group = c("rowLabel1", "rowLabel1", "rowLabel2", "rowLabel2"),
  a1 = c(1, 3, 9, 11),
  a2 = c(2, 4, 10, 12), 
  a3 = c(5, 7, 13, 15),
  a4 = c(6, 8, 14, 16)
)
@

<<results='asis'>>=
kable(dat, booktabs = TRUE, caption = "My  table", escape = FALSE) %>% 
  add_header_above(c(" ", "colLabel1"=2, "colLabel2"=2)) %>% 
  kable_styling(latex_options = "hold_position") %>%
  column_spec(1, bold=TRUE) %>%
  collapse_rows(columns = 1)
@

\end{document} 
```

[![在此处输入图像描述](../Images/629c53fa1fc4ef61be9c4741e769429f.png)](https://i.stack.imgur.com/Ntx5T.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-23T09:32:36.157

我对列标题无能为力，但对于过去的多行值，我已经作弊了。下面的函数会将相同值的第二组和后续组设置为 NA，然后 xtable 不会显示它们，因此您会得到一些看起来像多行值的东西（带有顶部对齐）

```
cleanf <- function(x){     
    oldx <- c(FALSE, x[-1]==x[-length(x)])  
    # is the value equal to the previous?    
    res <- x
    res[oldx] <- NA
    return(res)} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-03-29T17:07:08.720

这是使用`huxtable`包执行此操作的一种方法（我是作者）：

```
library(huxtable)
mydf <- data.frame(rowFactor1 = sample(letters[1:2], 100, replace = TRUE), 
  colFactor1 = sample(LETTERS[1:2], 100, replace = TRUE), 
  x = rnorm(100), 
  rowFactor2 = sample(1:2, 100, replace = TRUE), 
  colFactor2 = sample(1:2, 100, replace = TRUE))

tbl <- ftable(colFactor1 + colFactor2  ~ rowFactor1 + rowFactor2, data = mydf)
ht <- as_hux(tbl)

rowspan(ht)[c(4, 6), "V1"] <- 2 # these cells span 2 rows
colspan(ht)[1, c(4, 6)] <- 2    # these cells span 2 columns

ht[3, 1:2] <- '' # clean up some extraneous colum names
ht[1:2, 3] <- ''

right_border(ht)[,3] <- 1
bottom_border(ht)[c(2, 5, 7), ] <- 1
bottom_border(ht)[c(4,6), 1] <- 1
ht 
```

当打印到 LaTeX 时，它看起来像：

[![表图片](../Images/9b79ac1f6ad09742109fd6fdda4ece92.png)](https://i.stack.imgur.com/uF1Eo.png)

# function - FORTRAN 中 sin() 的源代码

> ID：15036756
> 
> 赞同：3
> 
> 时间：2013-02-23T03:36:06.420
> 
> 标签：function, fortran, implementation, trigonometry

我想知道 FORTRAN 中内置函数 sin() 是如何实现的，因为我尝试编写可以同时接收标量和数组作为其输入变量的函数，其效果可以在 sin() 中找到，即 sin (0) 返回 0 和 sin(a)，其中数组 a=(/0,3.14...)，返回一个数组 (0,0)。

我希望我要写的所有数学函数都能具有这种灵活性和优势。有人可以帮我一个忙吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T03:49:06.627

你可以做一个[`elemental`功能](http://fortranwiki.org/fortran/show/elemental)

# git - 将目录添加到 Github 存储库而不使用子模块

> ID：15036757
> 
> 赞同：0
> 
> 时间：2013-02-23T03:36:16.190
> 
> 标签：git, github, git-submodules

我拉了某人的 Github 存储库。我在目录中添加了一个目录并将其推送回 Github。

当我推送到 Github 时，该目录显示为一个绿色文件夹，一个子模块。我希望这个新目录简单地显示为一个文件夹。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T04:03:37.720

听起来您要添加的文件夹本身就是一个 git repo。检查它 - 它是否包含“.git”子文件夹？如果是这样，从副本中删除“.git”文件夹将允许您在要将此文件夹添加到的根存储库中执行标准的“git add”、“git commit”。

# java - 使用哈希码在 Java 中实现 Dijkstra 算法

> ID：15036758
> 
> 赞同：1
> 
> 时间：2013-02-23T03:36:22.040
> 
> 标签：java, hash, dijkstra

我的图表的实现是以下哈希表：

```
public class DiGraphHash{

private int numNodos, numArcos;
private TheList<Nodo> nodos[];
private TheList<Arco> arcos[];
private TheList<Arco> preds[]; 
```

}

TheList，是我自己制作的列表。

对于 Dijkstra 的算法，我需要映射每个节点的成本和到达该节点的路径。我有以下两个数组：

```
 int[] cost = new cost[num_nodes];
   Nodo[] path = new Nodo[num_nodes]; 
```

另一个重要的细节是，我的节点将是字母 A、B、C、D。

因此，当我映射节点时，例如，假设我必须将成本分配给节点 A，我如何找到数组中的位置？

我正在考虑使用 hashcode % array.length 但我不确定是否会发生冲突（考虑到它只有 1 个字符字母）

我不是在问代码，而是需要这个想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T04:16:30.777

两个想法：

1.  向您的班级添加一个`cost`字段。`Nodo`这样，您只需管理一组节点，而不是单独的一组成本。您可以在实例化节点时分配成本，并在以后轻松查找它们。

2.  比两个数组更好的数据结构可能是映射，其中键是节点本身，值是节点的成本。这是一个例子：

> ```
> HashMap<Nodo, Integer> nodesToCosts = new HashMap<Nodo, Integer>();
> 
> nodes.put(nodeA, new Integer(5));
> nodes.put(nodeB, new Integer(20));
> nodes.put(nodeC, new Integer(10));
> nodes.put(nodeD, new Integer(5)); 
> ```

# heroku - 我的应用程序可以有多个 heroku 子域吗？

> ID：15036759
> 
> 赞同：0
> 
> 时间：2013-02-23T03:36:29.000
> 
> 标签：heroku

假设您在 heroku 上托管了两个应用程序：appA 和 appB。它们可以在 appA.herokuapp.com 和 appB.herokuapp.com 上访问。有没有办法“共享”子域？如，我可以让 appA 监听两个 url 吗？

我想我可以让 appB 将其所有流量转发到 appA，但我更好奇是否可以通过一些 heroku 设置来完成。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T03:56:40.797

不，这不能通过 heroku 设置来完成。您要么需要两个应用程序之一作为另一个应用程序的反向代理，要么需要第三台服务器运行专用的反向代理，例如 nginx。

Heroku 支持曾经建议使用第三个 Heroku 应用程序作为带有自定义 buildpack 的 nginx 反向代理来完成此任务，尽管我决定不走那条路。不幸的是，Heroku 没有对同一域上的多个应用程序的系统支持，但这将大大增加其当前可预测和透明的路由平台（它本身是一个不可配置的反向代理）的复杂性。

# python - 在没有 NoneType 错误的情况下访问嵌套字典的 pythonic 方法是什么

> ID：15036763
> 
> 赞同：4
> 
> 时间：2013-02-23T03:36:42.160
> 
> 标签：python, dictionary, styles, nonetype, keyerror

我有一个深层嵌套的字典（从 json 解码，来自 instagram api）。我的初始代码是这样的：

```
caption = post['caption']['text'] 
```

但是，如果 'caption' 键或 'text' 键不存在，则会引发 NoneType 或 KeyError 错误。

所以我想出了这个：

```
caption = post.get('caption', {}).get("text") 
```

哪个有效，但我不确定它的风格。例如，如果我将此技术应用于我试图检索的更深层次的嵌套属性之一，它看起来很丑：

```
image_url = post.get('images',{}).get('standard_resolution',{}).get('url') 
```

有没有更好、更 Pythonic 的方式来写这个？我的目标是检索数据（如果存在），但如果不存在则不阻止执行。

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-23T03:43:13.020

最 Pythonic 的方法是简单地捕捉`KeyError`：

```
try:
    caption = post['caption']['text']
except KeyError:
    caption = None 
```

对于 Python 程序员来说，这很简单、很明显并且可以立即理解。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-08-25T04:00:26.030

Python 3.4 和更新版本包含一个 contextlib 上下文管理器`suppress`，它正是用于这种事情。当您提前知道它们可能会发生并且您的代码可以处理它时，抑制特定错误。

```
from contextlib import suppress

sample = {'foo': 'bar'}

with suppress(KeyError):
    print(sample['baz']) 
```

将防止`KeyError`被提升。

因此，要访问获取深度嵌套的字典值，您可以`suppress`像这样使用。

```
value = None
with suppress(KeyError):
    value = data['deeply']['nested']['dictionary']['key'] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-23T03:38:54.513

你对这样的事情感觉如何

```
if 'caption' in post:
    caption = post['caption']['text'] 
```

但它也开始崩溃

```
if 'images' in post and 'standard_resolution' in post['images']:
    image_url = post['images']['standard_resolution']['url'] 
```

所以我认为最 Pythonic 的方式就是[请求宽恕而不是许可](http://docs.python.org/2/glossary.html#term-eafp)

```
try:
    image_url = post['images']['standard_resolution']['url']
except KeyError:
    image_url = None 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-23T03:58:18.447

我会创建一个自定义 dict 子类，然后解决这个问题：

```
class SafeDict(dict):
    def __getitem__(self,k):
        if k in self:
            return dict.__getitem__(self,k)
        return None

a = SafeDict({'a':'a'})
print a['a']
>> a
print a['b']
>> None 
```

您可以执行自定义**初始化**以将嵌套字典作为 SafeDict 的另一个实例处理（这将允许您传递它们），或者您可以使用测试（或 try/except 块）来防止 KeyErrors

此外，您可以将其设为对象类、重载`__getattr__`，然后使用点符号处理。我更喜欢这种方法（我第一次看到这个是在 Pylons 框架中）

```
class AttributeSafeObject(object):

    def __init__(self,**kwargs):
        for key in kwargs:
            setattr(self,key,kwargs[key])

    def __getattr__(self, name):
        try:
            return object.__getattribute__(self,name)
        except AttributeError:
            return None

post = AttributeSafeObject({'a':'a'})
print post.a
>> a
print post.title
>> None 
```

# fadein - 多个图像反复淡入蚂蚁出

> ID：15036766
> 
> 赞同：0
> 
> 时间：2013-02-23T03:37:05.217
> 
> 标签：fadein, fadeout

我不知道怎么问这个。可以通过将 6 个图像中的每一个放在单独的 div 或 li（列表）中并添加淡入/淡出来实现[此效果吗？](http://www.essexllp.com/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T03:41:32.713

你在这里检查[了](http://jqueryui.com/effect/#default)吗？我喜欢[这个](http://tympanus.net/Development/AnimatedResponsiveImageGrid/index5.html)。

Jquery UI 库足以用于效果。

# css - Chrome 25：每页末尾的空样式标签

> ID：15036770
> 
> 赞同：1
> 
> 时间：2013-02-23T03:37:41.957
> 
> 标签：css, html, google-chrome

首先我开始在我正在处理的页面上看到这个，但现在我在 Chrome 中打开任何网站，它就在那里：

![在此处输入图像描述](../Images/ff7cb23476ee663a81debb4cd2b30b48.png)

有人知道这是什么吗？似乎没有破坏任何东西，但我有强迫症......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T05:38:01.353

您安装了（甚至曾经安装过）chrome 什么样的插件或扩展？如果您在所访问的每个站点上都看到了这一点，那您就完蛋了。

可能的解决方案：尝试禁用或卸载所有 chrome 扩展。或者，如果这不起作用，请使用 nuke chrome 并重新安装。我在firefox b4上遇到过这个问题，但从来没有chrome。

# bash - Bash：用常量字符串查找并替换所有变量字符，直到一个常量字符

> ID：15036775
> 
> 赞同：1
> 
> 时间：2013-02-23T03:38:28.527
> 
> 标签：bash, replace

我已经看到许多基于以下假设的搜索和替换线程：1\. 您要么知道要明确查找的字符串或子字符串，要么 2\. 您知道它在字符串中的确切位置，或者 3\. 两者结合。在我的情况下，我有一个包含一列和 1M 行的 csv 文件。例如

```
1,google.com
2,yahoo.com
3,twitter.com
4,xyz.com 
```

对于每一列，我想用 http 分号 dble 正斜杠 dubdubdub替换每个字符（递增的整数）**直到并包括逗号**

到目前为止，我有以下

```
HTTPSTRING="http://www."
cat X.csv << Will this ensure that the while block is executed on this file?
while IFS=, read line
  do {$line/(.*?),/HTTPSTRING} << This is where I am having trouble
done
exit 0 
```

我想要一个每行包含一个 URL 的文本文件，例如

```
http://www.google.com
...
http://www.${999,999_more_urls} 
```

非常感谢你提前

刘易斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T04:32:56.263

这是一个贪婪的匹配，如果你有任何逗号而不是分隔初始整数和你想要保留的字符的逗号，这将是一个问题。但它适用于您的示例 X.csv 文件，生成符合您的输出规范的 Y.csv 文件。

```
HTTPSTRING="http://www."
while read line
do
  echo ${line/*,/$HTTPSTRING}
done < X.csv > Y.csv
exit 0 
```

对于它的价值，如果你把它放在一个脚本中，你可以从代码本身中取出文件输入/输入重定向部分，而不是在调用脚本时应用它们。

如果您不严格限于 bash 本身，您可能需要考虑使用 sed。这些中的任何一个都应该做你想做的事，只是你喜欢转义字符串中的斜杠还是使用非标准分隔符：

```
sed 's/[0-9]*,/http:\/\/www./' X.csv > Y.csv
sed 's~[0-9]*,~http://www.~' X.csv > Y.csv 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T05:47:20.260

你的脚本很接近。您可以将 的输出`cat`直接传送到`while`循环，但最好使用输入重定向 ( `< X.csv`)。使用`IFS=,`before`read`会将行拆分为用逗号分隔的字段，但您只是缺少一个变量来保存第二个字段。

```
HTTPSTRING="http://www."
while IFS=, read number domain
do 
    echo "$HTTPSTRING$domain"
done < X.csv 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T08:51:23.983

您只能使用命令，不需要显式 Bash 循环：

```
cut -d',' -f2 < X.csv | sed 's_^_http://www._' > Y.txt 
```

请注意，在 in 之后使用的通常被`/`替换为，因为它包含在要替换的字符串中。匹配行的开头。`s``sed``_``^`

# c - C 结构数组和搜索：尝试匹配成员并在找到匹配项时打印整个结构。

> ID：15036777
> 
> 赞同：0
> 
> 时间：2013-02-23T03:38:37.760
> 
> 标签：c, search, struct, printf

这是结构

```
int main() {
    typedef struct {
        char firstName[25];
        char lastName[30];
        char street[35];
        char city[20];
        char state[3];
        int zip;
        char phone[15];
        int accountId;
    }Customer ; 
```

假设我用 x 量的数据填写了这个。

什么是基于其成员搜索此结构的数组索引的简单方法，然后打印该“客户”信息。具体来说，我希望按州搜索客户。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T05:04:00.180

下面是一个我相信会有所帮助的例子。当然，需要扩展客户定义、记录打印和数据填充。另请注意，customer[] 在此示例中位于堆栈上，因此其成员不会归零，因此应以一种或另一种方式设置为预期值。

```
#include <string.h>
#include <stdio.h>

#define NUM_RECORDS   10

int main()
{
    int i;
    typedef struct {
        char state[3];
    } Customer;

    Customer customer[NUM_RECORDS];
    strcpy(customer[2].state, "CA");

    for (i = 0; i < NUM_RECORDS; i++)
    {
        // if this customer record's state member is "CA"
        if (!strcmp(customer[i].state, "CA"))
            printf("state %d: %s\n", i, customer[i].state);
    }

    // Prints "state 2: CA"

    return 0;
} 
```

# php - 如何使用条件注释定义文件/页面？

> ID：15036778
> 
> 赞同：0
> 
> 时间：2013-02-23T03:38:41.473
> 
> 标签：php, wordpress, function

我很好奇如何利用条件注释用 PHP 定义页面/文件。

这种技术用于 WordPress；可以通过在文件顶部插入条件注释来定义模板文件。然后，当您选择此模板时，应用程序就知道要使用哪个文件。像这样的东西；

```
<?php
/*
Template Name: Snarfer
*/
?> 
```

我想指出，我不希望在 WordPress 环境中执行此肌动蛋白，但我很好奇他们是如何做到的。

那么如何在 PHP 中使用这种技术呢？我假设需要创建一个函数或一个类或一系列函数和类。

我尝试过搜索，但也许我在搜索中使用了错误的关键字。

如果有人能指出我的文档或教程，我将不胜感激。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-23T11:50:51.967

我认为您必须在 wordpress archive.php 上提供条件以检查您喜欢使用哪种自定义帖子类型，并且您可以在此处定义您喜欢调用的模板文件。

```
<?php if ( 'news' == get_post_type() ) { ?>

            <div class="container">

                    <?php
                        /* Include the Post-Format-specific template for the content.
                         * If you want to overload this in a child theme then include a file
                         * called content-___.php (where ___ is the Post Format name) and that will be used instead.
                         */
                        get_template_part( 'news-blog', get_post_format() ); 
                    ?>

            </div>
    <?php } else { ?>
Wordpress Default call
<?php } ?> 
```

在`get_template_part( 'news-blog', get_post_format() );` 拥有 news-blog 中是您模板的文件名。例如 news-blog.php

# jquery - 我也可以使用 jQuery 为 onlick 事件捕获 ENTER 键吗？

> ID：15036779
> 
> 赞同：0
> 
> 时间：2013-02-23T03:38:41.737
> 
> 标签：jquery

我有一个按钮可以向我的服务器发布消息，但我也想捕获 ENTER 键。这可能吗？

我当前的点击调用如下所示：

我的输入字段的 HTML：

```
<input class="span3 required" type="text" value="" name="postcode" id='postcode'/> 
```

jQuery：

```
$('#update_local').click(function(e) {
    e.preventDefault();
    ....
}); 
```

如何在此输入字段中捕获 Enter 击键并触发我的点击事件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T03:48:19.463

下面会做。`e.which`保存按下的键的字符代码。对于输入，我们要检查 13：

```
$('#postcode').keydown(function(e){
    if(e.which === 13){ //Enter key
        $('#update_local').click()
    }
}); 
```

# c - 可变参数函数 - 如何获取 var_args 的数量？

> ID：15036780
> 
> 赞同：1
> 
> 时间：2013-02-23T03:38:47.960
> 
> 标签：c, variadic-functions

这完全可以做到吗？有没有，例如，某种`va_num_args`？

基本上，我以`prinf()`类似的方式通过串行端口记录事件，采用格式字符串和可选的一些参数。我想知道是否存在任何此类选项参数。

例如，我可以区分`Trace("No paramters here");`和`Trace("forty two = %d", 43 - 1);`吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T03:50:06.720

不可以，但可以使用以下方法：

*   从格式字符串（如 ）推导出参数数`printf`。
*   使用[标记值](http://en.wikipedia.org/wiki/Sentinel_value)来指示最后一个参数。
*   提供一个专用的计数参数。

# ios - 不完整的实现 - Xcode 警告

> ID：15036783
> 
> 赞同：2
> 
> 时间：2013-02-23T03:39:00.637
> 
> 标签：ios

我刚刚开始进行 iOS 开发，由于警告而有点卡住了。构建成功，但这个警告让我很困扰。我检查了其他一些答案，但无法弄清楚出了什么问题。

Waring - 不完整的实现

复数.h

```
#import <Foundation/Foundation.h>

@interface ComplexNumbers : NSObject

-(void) setReal: (double)a;
-(void) setImaginary: (double)b;
-(void) print; // display as a + bi

-(double) real;
-(double) imaginary;

@end 
```

复数.m

```
#import "ComplexNumbers.h"

@implementation ComplexNumbers  // Incomplete implementation

{
double real;
double imaginary;
}

-(void) print
{
    NSLog(@"%f + %fi",real,imaginary);
}
-(void) setReal:(double)a
{
    real = a;
}
-(void) setImaginary:(double)b
{
    imaginary = b;
}

@end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T03:43:31.017

你的问题是你的界面说有`real`和`imaginary`方法，但你还没有实现这些。更好的是，通过将它们定义为属性，让编译器为您合成setter`real`和`imaginary`getter 方法，并且您的代码大大简化：

```
@interface ComplexNumbers : NSObject

@property (nonatomic) double real;
@property (nonatomic) double imaginary;

-(void) print; // display as a + bi

@end 
```

和

```
@implementation ComplexNumbers

-(void) print
{
    NSLog(@"%f + %fi", self.real, self.imaginary);
}

@end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T03:42:25.913

您还没有实现这些属性获取器：

```
-(double) real;
-(double) imaginary; 
```

您可以实现它们：

```
-(double) real { return _real; }
-(double) imaginary { return _imaginary; } 
```

或者让编译器通过在标题中将它们声明为属性来为您完成：

```
@property(nonatomic) double real;
@property(nonatomic) double imaginary; 
```

在 .m 文件中：

```
@synthesize real = _real, imaginary = _imaginary; 
```

其中 _ 是实例成员。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T03:50:58.403

试试这个，

```
#import "ComplexNumbers.h"

@implementation ComplexNumbers  // Incomplete implementation

{
double real;
double imaginary;
}

-(void) print
{
  NSLog(@"%f + %fi",real,imaginary);
}

-(void) setReal:(double)a
{
real = a;
 }
-(void) setImaginary:(double)b

{
imaginary = b;
}
 -(double) real
{
   return real;
}
-(double) imaginary
{
   return imaginary;
}

@end 
```

# javascript - 在 mediaelement.js 中禁用 Flash 后备选项

> ID：15036787
> 
> 赞同：1
> 
> 时间：2013-02-23T03:39:33.233
> 
> 标签：javascript, html, mediaelement.js

我正在使用[`MediaElement.js`](http://mediaelementjs.com)，并希望禁用将不`<video>`支持 HTML5 的浏览器重定向到 Flash 后备的选项。不幸的是，尽管查看了文档，但我还没有找到这样做的方法。如果可以做到，如何禁用 Flash 后备选项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T04:48:03.077

```
new MediaElement('player1', {
  // remove or reorder to change plugin priority
  plugins: ['silverlight']
}); 
```

# c# - Stream.Read 结合了两种不同的读取

> ID：15036790
> 
> 赞同：2
> 
> 时间：2013-02-23T03:40:18.823
> 
> 标签：c#, client, client-server, filestream

我有一个用 C# 编写的简单文件服务器\客户端应用程序。但我经常遇到我的流将两个不同的读取写入单个缓冲区的问题。我有一个同步的流，仍然没有帮助。有什么建议么？谢谢！

```
System.Threading.Thread.Sleep(25);
receive_fspos = new byte[30];
int bytesread = stream_1.Read(receive_fspos, 0, receive_fspos.Length);//this is where it gets combined
if (bytesread == 0) 
{ 
    finished = true; 
    System.Threading.Thread.Sleep(25); 
}
string string_1 = utf.GetString(receive_fspos).TrimEnd(new char[] { (char)0 });
int fsposition = (int)Convert.ToInt64(string_1);
bytestosend = fsposition;
filestream.Position = fsposition;
byte[] buffer_1 = new byte[bufsize];
int bytesreadfromfs = filestream.Read(buffer_1, 0, buffer_1.Length);
stream_1.Write(buffer_1, 0, buffer_1.Length);
Console.Write("\rSent " + fsposition + " / " + length + " bytes");
finished = true; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T05:46:35.580

如果您不完全理解它，我不建议您编写自己的流方法。

您遇到的问题是因为传入的数据是字节流，无法让您知道消息的长度是多少字节。

在下面的代码中，您声明要读取流的“receive_fspos.Length”字节。由于“receive_fspos.Length”为 30，因此将读取的字节数将介于 0 到 30 之间。

如果连接只接收到 15 个字节。它会给你15个字节。如果消息是 20 字节长。然后消息现在被分成不同的段。

如果第一个消息是 4 个字节，第二个消息是 12 个字节。现在您有 2 条消息和一组 16 个空白字节。更糟糕的是，这 16 个“空白”字节可能是进入流的第三条消息的开始。

如果消息是 50 字节长。那么您将只收到一半的消息。现在您需要将读取的字节添加到单独的缓冲区中。再次从流中读取。然后重复此操作，直到您确定已读取完成整个消息所需的确切字节数。然后将所有读取的字节连接回单个字节[]。

```
 receive_fspos = new byte[30];
     int bytesread = stream_1.Read(receive_fspos, 0, receive_fspos.Length);//this is where it gets combined 
```

请使用 BCL 方法，而不是滚动您自己的循环。听起来您正在使用字符串，所以这将是首选方法。我建议以下方法。

```
using(NetworkStream networkStream = tcpClient.GetStream())
using(StreamReader streamReader = new StreamReader(networkStream))
using(StreamWriter streamWriter = new StreamWriter(networkStream))
{
     networkStream.ReadTimeout = timeout; //Set a timeout to stop the stream from reading indefinately           

     //To receive a string
     string incomingString = stream.ReadLine();

     //To send a string
     stream.WriteLine(messageToSend);
     stream.Flush();
} 
```

您的回答澄清了您正在尝试发送文件。为此，我建议发送一个字节数组 []。使用此方法，您可以发送任何可以序列化的内容。这包括一个文件。请注意，文件的大小是有限的，因为它必须保存在内存中。要写入更大的文件，您可能希望在数据流式传输时将数据保存在块中。

```
//Please note that if the file size is large enough. It may be preferred to use a stream instead of holding the entire file in memory.
byte[] fileAsBytes = File.ReadAllBytes(fileName);

using(NetworkStream networkStream = tcpClient.GetStream())
using(BinaryReader binaryReader = new BinaryReader(networkStream))
using(BinaryWriter binaryWriter = new BinaryWriter(networkStream))
{
     networkStream.ReadTimeout = timeout; //Set a timeout to stop the stream from reading indefinately           

     //To receive a byte array
     int incomingBytesLength = BinaryReader.ReadInt32(); //The header is 4 bytes that lets us know how large the incoming byte[] is.
     byte[] incomingBytes = BinaryReader.ReadBytes(incomingBytesLength);

     //To send a byte array
     BinaryWriter.Write(fileAsBytes.Length); //Send a header of 4 bytes that lets the listener know how large the incoming byte[] is.
     BinaryWriter.Write(fileAsBytes);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T04:01:37.763

让它工作，代码> 30000个字符：\它有点乱，但是嘿，它的功能。

服务器：[https ://www.dropbox.com/s/2wyccxpjbja10z3/Program.cs?m](https://www.dropbox.com/s/2wyccxpjbja10z3/Program.cs?m)

客户端：[https ://www.dropbox.com/s/yp78nx4ubacsz6f/Program.cs?m](https://www.dropbox.com/s/yp78nx4ubacsz6f/Program.cs?m)

# jquery - 我可以使用 jQuery 的 Deferred.promise() 来替换对象的现有承诺吗？

> ID：15036792
> 
> 赞同：1
> 
> 时间：2013-02-23T03:40:30.160
> 
> 标签：jquery, jquery-deferred

根据 jQuery 文档`deferred.promise([target])`：

> 如果提供了 target， deferred.promise() 会将方法附加到它上面，然后返回这个对象而不是创建一个新对象。这对于将 Promise 行为附加到已经存在的对象很有用。

据我了解，调用`promise()`目标应该替换目标现有的承诺接口，在这种情况下，我希望记录以下内容`"new done"`：

```
var defer = $.Deferred();

defer.done(function() { 
    console.log('new done')
});

defer.promise( 
    $.getJSON('/foo').done(function() { 
        console.log('old done')
    })
); 
```

但我仍然得到目标的原始`done`回调。（使用 jQuery 1.8.3。）

我的理解完全不正确，还是有某种方法可以以某种方式替换对象的整个承诺接口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T07:14:19.833

您正在替换该 getJSON 调用的基于 Promise 的接口，但是在您发起请求并已经附加了“旧完成”回调之后，就会发生替换。此外，原始的 getJSON deferred 仍然是请求完成时解决的问题，这就是为什么它会触发而你的不会触发的原因。

要完成您正在尝试的操作，您必须在附加任何回调之前替换接口。您还必须在请求完成时手动解决您提供的延迟。

通常，这样的事情会起作用：

```
var deferred = $.Deferred();
var request = $.getJSON( "url" );

request.then(
  function() {
    deferred.resolveWith( this, arguments );
  },

  function() {
    deferred.rejectWith( this, arguments );
  }
);

// Now it's safe to replace the promise methods on the request
deferred.promise( request );

// This callback is being attached to the Deferred we provided,
// not the one managed internally by getJSON
request.done(function() {
    console.log( "Done!" );
}); 
```

此方法仅对 .done、.fail 和 .always 是安全的。此示例未处理其他已弃用的延迟处理程序（success、error、complete），尽管如果您愿意，修复它并不难。

# php - php：从字符串中删除特定索引？

> ID：15036794
> 
> 赞同：12
> 
> 时间：2013-02-23T03:40:41.563
> 
> 标签：php, string

我希望能够在字符串中指定索引并将其删除。

我有以下内容：

```
"Hello World!!" 
```

我想删除第 4 个索引（`o`在 Hello 中）。这将是最终结果：

```
"Hell World!!" 
```

我试过`unset()`了，但没有奏效。我已经用谷歌搜索了如何做到这一点，这是每个人都说的，但它对我没有用。也许我没有正确使用它，idk。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-23T03:54:30.850

这是解决它的通用方法：

```
$str = "Hello world";
$i = 4;
echo substr_replace($str, '', $i, 1); 
```

基本上，将索引之前的字符串部分替换为相邻的字符串部分。

也可以看看：[`substr_replace()`](http://www.php.net/substr_replace)

或者，简单地说：

```
substr($str, 0, $i) . substr($str, $i + 1) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-23T03:48:13.693

```
$str="Hello World";
$str1 = substr($str,0,4);
$str2 = substr($str,5,7);
echo $str1.$str2; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-06-23T15:00:08.760

This php specific of working with strings also bugged me for a while. Of course natural solution is to use string functions or use arrays but this is slower than directly working with string index in my opinion. With the following snippet issue is that in memory string is only replaced with empty � and if you have comparison or something else this is not good option. Maybe in future version we will get built in function to remove string indexes directly who knows.

```
$string = 'abcdefg';
$string[3] = '';
var_dump($string);
echo $string; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T04:02:14.337

```
$myVar = "Hello World!!";

$myArray = str_split($myVar);
array_splice($myArray, 4, 1);

$myVar = implode("", $myArray); 
```

个人我喜欢处理数组。

（抱歉，我的手机上没有代码括号）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-22T10:36:55.233

我认为可以创建一个函数并像这样调用它

```
 function rem_inx ($str, $ind)
    { 
       return substr($str,0,$ind++). substr($str,$ind);
    }

    //use
    echo rem_inx ("Hello World!!", 4); 
```

# google-app-engine - 在不关闭的情况下从后端写入数据存储

> ID：15036797
> 
> 赞同：0
> 
> 时间：2013-02-23T03:41:16.850
> 
> 标签：google-app-engine, google-cloud-datastore, backend

我正在尝试在 Google App Engine (Python) 中编写一个程序来持续运行一个常驻后端，该后端正在寻找一系列收敛到的内容。我想让它在后端运行，写入数据存储区，并且在任何时间点，您都可以知道该系列在哪个项目上以及它的价值。后端仅写入数据存储区中的一个实体，因此它不会使存储或任何东西过载。我可能遇到的可能是后端不会将实体写入数据存储区，因此我的前端网页可以访问它，直到后端是关闭，这违背了能够持续检查它的目的。如果有某种方法可以让后端写入数据存储以便前端页面可以签入它，请告诉我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T04:06:11.747

后端进程中的数据存储写入行为应该与前端应用程序中的写入没有什么不同，这意味着它们应该可以立即（几乎）在您的前端（在一致性约束内）读取。后端和前端都与同一个数据存储进行交互。

听起来您只需要实现对系列当前状态的重复写入（即每 x 个周期一次），而不是在后端进程结束时写入一次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T06:43:59.327

您的帖子提出了两个问题。

一是“不停机”。我们不保证后端将无限期运行。有关详细信息，请参阅[Shutdown 上的文档](https://developers.google.com/appengine/docs/python/backends/overview#Shutdown)。

第二个问题，如果我理解你的话，是你在后端写入值之后才看到它们写入的一段时间。您可能会遇到“最终一致性”，“最终”通常很短，但在极少数情况下可能会长得惊人。了解[隔离和一致性](https://developers.google.com/appengine/docs/python/datastore/transactions#Isolation_and_Consistency)可以在这里提供帮助。

# jquery - SignalR 和 ASP.net

> ID：15036799
> 
> 赞同：3
> 
> 时间：2013-02-23T03:41:34.107
> 
> 标签：jquery, asp.net, signalr

Signalr 构建在什么之上？开发 Signalr 使用的技术是什么？它是 JavaScript 库和 C Sharp 文件的组合吗？使用 Signalr 开发 Web 应用程序时，必须更新 JQuery 库。新版本的 JQuery 和Signalr lib 导致应用程序稳定？我们可以使用旧版本的 Asp.net 构建 Signalr 应用程序吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T04:02:50.763

当您需要构建一个调用客户端（浏览器/移动应用程序等）上的方法的 Web 应用程序（服务器）时，就需要 SignalR。

因此，SignalR 有两个部分——Web 服务器和客户端。

服务器部分构建在 .NET Framework 之上。支持 Web 套接字需要 .NET 4.5。[您可以在https://github.com/SignalR/SignalR/wiki/Hubs](https://github.com/SignalR/SignalR/wiki/Hubs)查看如何对服务器部分进行编程

客户端部分可以是 JavaScript、C# 或任何其他实现（有一个 ObjectiveC 实现）。如果您使用的是 JavaScript，那么最好将您的 jQuery 更新到最新版本。JavaScript 客户端教程位于[https://github.com/SignalR/SignalR/wiki/SignalR-JS-Client-Hubs，C#](https://github.com/SignalR/SignalR/wiki/SignalR-JS-Client-Hubs)客户端教程位于[https://github.com/SignalR/SignalR/wiki/SignalR-Client -集线器](https://github.com/SignalR/SignalR/wiki/SignalR-Client-Hubs)

我一直在使用 SignalR 的 RTM 版本（几天前发布）和最新版本的 jQuery，它们很稳定。

只要将现有项目升级到 .NET 4.5，就可以将 SignalR 添加到现有项目中。SignalR 本身不依赖于 WebForms 或 MVC 或 WebPages。您将通过从 Hub 类继承来创建 SignalR 服务器代码，然后通过包含 SignalR JavaScript 库将您的客户端（在 aspx 或 cshtml 中）连接到您的服务器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T03:47:45.990

SignalR 是使用 .NET 库和 JavaScript 库构建的。SignalR 目前依赖于 jQuery，但可以通过一些工作将它与 jQuery 分离（[在没有 jquery 的情况下实现 signalR](https://stackoverflow.com/questions/10812849/implement-signalr-without-jquery)）。我相信它最初的目标是支持 .NET 4 或更高版本，但有一个可用于 .NET 3.5 的版本

让我知道这是否回答了您的问题。

# c++ - 试图找出在特定时间内褪色的方程式

> ID：15036801
> 
> 赞同：2
> 
> 时间：2013-02-23T03:41:46.367
> 
> 标签：c++, time, sfml, equation, fading

我目前正在使用 SFML 在 c++ 中创建一个徽标序列，并且想输入所需的时间然后淡出该时间量，例如，如果输入为 3，则淡出颜色直到 3 秒结束。颜色整数的最大数量，作为一种颜色是 255 作为白色。这是我当前的代码：

```
sf::Time fadeCalc = clock.getElapsedTime();
int f = fadeCalc.asMilliseconds();
int l = logoLength.asSeconds();
int iColor = "Equation needed using variables"
sf::Color fadeColor(iColor,iColor,iColor);
Fade.setFillColor(fadeColor); 
```

任何帮助将不胜感激！对不起，我想不出一种更容易解释的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T05:14:57.470

您将逐渐淡出，`start color`每次平局迈出一步。`end color``total fade time``elapsed time`

因此，在每个绘制步骤中，您都需要将颜色设置为`start color + ((end color - start color) * (elapsed time / total time))`。这将为您提供您想要完成的更改量，计算此时应该发生的更改百分比，然后将更改的金额添加到您的初始金额。

例如，如果您想从 100 变为 255，并且它在 3000 毫秒中是 1000，那么您希望是从 100 到 255 的 1/3，或 151.6667（151 被截断）。在 2/3 处，它将是 203.333。等等。

一旦您 >= your `total time`，只需设置`start color`为`end color`.

# c - 使用#define（添加结束大括号）进一步缩短 printf，或缩短 #define C

> ID：15036803
> 
> 赞同：-2
> 
> 时间：2013-02-23T03:41:56.873
> 
> 标签：c

目前，我正在使用：

```
#define p printf( 
```

为了减少我在整个程序中使用 printf 的字符数量，例如，而不是：

```
printf("Hello, World."); 
```

我可以：

```
p"Hello, World."); 
```

我的问题是，是否有可能进一步缩短这个？例如，将结束大括号添加到定义中？类似（伪代码）：

```
#define p printf() 
```

还是这样的？或者更短的#define 方法？

编辑：在我被否决之前，我最好澄清一下。这样做的目的不是因为我懒惰，或者因为我想让它不可读而保存击键。我已经编写了有问题的程序（它可读性很强，希望不会让我陷入程序员的地狱），我很好奇我能得到多低的字符数。这个问题将有助于这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T03:52:35.117

您可以使用带有可变参数的宏：

```
#define p(...) printf(__VA_ARGS__) 
```

尽管这样的名称`p`不是一个好主意，但这种语法可以很好地用于条件日志记录。例如：

```
#ifndef NDEBUG
# define log(...) fprintf(stderr, __VA_ARGS__)
#else
# define log(...) ((void)0)
#endif 
```

* * *

有时，您可能想要对格式说明符做一些特定的事情。为此，您可以利用 gcc 扩展（可能还有其他编译器），例如：

```
#define log(fmt, ...) fprintf(stderr, "Log: "fmt"\n", ##__VA_ARGS__) 
```

请注意，这*不是*`##__VA_ARGS__`标准的。另请参阅[此答案](https://stackoverflow.com/a/679993/912144)。

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T03:44:43.090

是的，您的宏可以接受参数

[http://gcc.gnu.org/onlinedocs/cpp/Macro-Arguments.html](http://gcc.gnu.org/onlinedocs/cpp/Macro-Arguments.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T03:48:39.277

那是邪恶的。停止尝试保存击键并提高您的打字技巧。以这种方式“简化”代码并不适合使用宏，因为您只会让普通 C 程序员更难阅读您的代码。始终牢记可读性。

很高兴你不必写`System.out.println`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T03:51:17.037

根据您展示的需求，考虑[看跌期权](http://www.cplusplus.com/reference/cstdio/puts/)

这对宏化会更安全/更好，因为它不需要可变数量的参数。您已经使用 printf 并限制了它的使用。此外，用户将键入 p("%d") 并且程序将崩溃。*

# c# - “System.timeOut 异常”类型的未处理异常

> ID：15036809
> 
> 赞同：1
> 
> 时间：2013-02-23T03:42:52.357
> 
> 标签：c#, windows-phone-8

当应用程序启动时，它将运行 DispatcherTimer。每隔 10 秒，它会运行 running() 函数，并且 running() 函数消耗一个 web 服务，它运行得很好。当系统无法获取webservice时，会弹出“System.timeOut异常”。如何解决异常？

感谢您提供的任何帮助！

```
private void running()
    {    
         ServiceReference1.WebServiceSoapClient test = new ServiceReference1.WebServiceSoapClient();

         test.ReadTotalOutstandingInvoiceCompleted += new EventHandler<ServiceReference1.ReadTotalOutstandingInvoiceCompletedEventArgs>(serviceClient);  

         test.ReadTotalOutstandingInvoiceAsync();
    }

private void serviceClient(object sender, ReadTotalOutstandingInvoiceCompletedEventArgs e)

    {
         tbTesting.Text = e.Result.ToString();

         tbTextbox2.Text = "You have " + tbTesting.Text + " Invoice !!";
         ...
         MessageBox.Show("You have " + tbTesting.Text + " new Invoice" +Environment.NewLine+ Environment.NewLine+ DateTime.Now, "Invoice", MessageBoxButton.OK);
         ...
        } 
```

在reference.cs

```
public string EndReadTotalOutstandingInvoice(System.IAsyncResult result) {

        object[] _args = new object[0];
        string _result = ((string)(base.EndInvoke("ReadTotalOutstandingInvoice", _args, result)));
        return _result;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T03:57:32.483

这只是告诉您无论 web 服务正在做什么都已超时并且可能不可用。也很难说出“解决异常”是什么意思，如果 web 服务不可用，你可能无能为力。

# c# - 如何检索longblob格式

> ID：15036810
> 
> 赞同：1
> 
> 时间：2013-02-23T03:42:53.713
> 
> 标签：c#, asp.net, mysql

我应该如何显示 longblob 格式？
我想用 c# 在 MYSQL 中检索“内容”longblob 格式。

```
 string MyConnectionString = "Server=localhost;Database=newsborad;Uid=root;Pwd=root;"; 

    //this is the connection with the MYSQL
    MySqlConnection conn = new MySqlConnection(MyConnectionString); //communicate MYSQL
    MySqlCommand cmd = conn.CreateCommand();
    conn.Open();
    //content is longblob format in MYSQL
    cmd.CommandText = "Select content from message where msg_id = @id";
    cmd.Parameters.AddWithValue("@id", "1");

    while (reader.Read())
    {
        //how i should code?
    }
    conn.Close(); 
```

# vim - 设置 tw=80 无法正常工作

> ID：15036812
> 
> 赞同：0
> 
> 时间：2013-02-23T03:43:05.180
> 
> 标签：vim

因此，我尝试在 vim 中使用命令为 .c 文件中的每一行设置一个总列。但是，当我输入命令时`:set tw=132 gggqG`，它会从此变成一个代码：

```
int main()
{
  int i = 0;
  while(i<10)
  {
    cout<<"1";
  }
} 
```

至 ：

```
int main(){ int i = 0; while(i<10){cout<<"1";}} 
```

难道我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T03:52:12.197

`gq`表示“格式化文本”——它用于文本段落，而不是源代码。

如果你想格式化C代码，试试*[是否可以用VIM格式化C++代码？](https://stackoverflow.com/questions/2506776/is-it-possible-to-format-c-code-with-vim)*.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T20:46:20.560

该`gq`命令用于*文本*；在 C 文件中，您可以使用它来重新格式化多行注释（使用正确的`'formatoptions'`和`'comments'`选项），但不能将它用于源代码本身。

在那里，Vim 提供了通过 重新缩进`=`，即`gg=G`重新缩进整个缓冲区。如果您需要更花哨的东西，则必须将其委托给外部工具，例如`:%!astyle`.

# c# - 用于识别 Try-Catch 和 Try-Catch 的正则表达式最终块包含在 .cs 文件中

> ID：15036814
> 
> 赞同：0
> 
> 时间：2013-02-23T03:43:19.927
> 
> 标签：c#, .net, regex, io

您好我正在尝试创建一个应用程序来帮助我切换我的 Catch-Block 的测试内容并将它们替换为生产内容。我能够阅读我的文件并解析内容，但是在创建正则表达式（我仍然是全新的）来识别 try-catch 块时遇到问题，因此我可以选择删除或更改内容捕捉块。请问谁能帮我解决这个问题？？

到目前为止，我有下面的表达式（根本不起作用）

```
try{*}catch(*){*) 
```

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T03:55:48.647

您不能编写执行此操作的正则表达式，因为正则表达式[不能用于匹配嵌套模式](https://stackoverflow.com/questions/133601/can-regular-expressions-be-used-to-match-nested-patterns)。这意味着它将无法识别您的右大括号何时出现与代码中的其他嵌套大括号。您将需要一个解析器生成器，例如 ANTLR，就像链接的答案建议的那样来完成此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T07:31:07.753

我建议看一下正在开发的微软[Roslyn 编译器。](http://msdn.microsoft.com/en-us/vstudio/roslyn.aspx)它的 API 应该可以让你完成你想做的任何事情。它目前处于预览阶段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T11:13:56.453

我认为这会促使您找到解决方案：

```
try\s*\{[^{}]*([^{}]*\{[^{}]*\}[^{}]*)*[^{}]*\}\s*catch\s*\([^()]*(\([^()]*\))*\)\s*\{[^{}]*([^{}]*\{[^{}]*\}[^{}]*)*[^{}]*\} 
```

`try\s*`匹配 try 后跟零个或多个空格。

`\{[^{}]*([^{}]*\{[^{}]*\}[^{}]*)*[^{}]*\}`匹配一个块（`{`后跟零个或多个字符，除了 { 和 } 后跟零个或多个块，每个块之前和之后都有任意数量的字符）

`\s*catch\s*\([^()]*(\([^()]*\))*\)`匹配前后零个或多个空格`catch`，然后匹配括号内的内容`()`

`\s*\{[^{}]*([^{}]*\{[^{}]*\}[^{}]*)*[^{}]*\}`类似于 try 块

**注意：**如果注释包含`{`s 或`}`s可能会失败

# c# - 在一个可靠的解决方案中集成用 Python 编写的测试和用 C# 编写的测试

> ID：15036815
> 
> 赞同：5
> 
> 时间：2013-02-23T03:43:20.860
> 
> 标签：c#, python, asp.net, unit-testing

我正在尝试做的是将两种方法、两个框架组合成一个坚实的范围、过程......

1.  我有一堆`python`带有自写库的测试`TestRunner`，`proboscis`这给了我一个很好的方法来编写我自己的测试结果实现（我正在使用`jinja`）。这个框架现在是一个可靠的东西。**这些测试用于在ASP.NET**站点上测试 UI（使用`Selenium`） 。

***   另一方面，我必须为业务逻辑编写测试。显然使用`NUnit`or是正确`TestDriven.NET`的`C#`。** 

 **您能否给我一个提示、提示和建议，说明我应该如何将这两种方法整合到一个最终解决方案中？可能答案只是设置一个 CI 服务器，不要...

请注意，我将 Python 用于 ASP.Net 门户的原因在于它的灵活性和构建任何自定义测试运行器、测试加载器、测试发现等的机会......

PS 使用`IronPython`对我来说不是一个选项。

PPS 为了清楚起见：`proboscis`是允许设置选择测试的**测试顺序**和**依赖关系**的 python 库。而这两个选项就是要求！

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-29T19:30:45.617

我不知道您是否可以将它们放入一个跑步者或流程中。我对 Python 也不是很熟悉。不过，在我看来，Python 书面测试的水平更高。验收测试或集成测试或任何您想称呼它们的东西。NUnit 是单元测试级别。因此，我建议您首先运行单元测试，如果它们通过了 Python 测试。您应该能够将其集成到构建脚本中。正如您已经建议的那样，如果您可以在 CI 服务器上运行它，那将是我在您的情况下首选的方法。**

# algorithm - 在没有额外空间的 N 个排序数组中查找公共元素

> ID：15036821
> 
> 赞同：7
> 
> 时间：2013-02-23T03:44:14.023
> 
> 标签：algorithm, data-structures

给定 N 个大小为 N 的数组，并且它们都已排序，如果它不允许您使用额外的空间，那么如何有效地或以更少的时间复杂度找到它们的共同数据？

例如：

```
 1\. 10 160 200 500 500
 2\. 4 150 160 170 500
 3\. 2 160 200 202 203
 4\. 3 150 155 160 300
 5\. 3 150 155 160 301 
```

这是一个面试问题，我发现了一些类似的问题，但它们不包括输入被排序或无法使用额外内存的额外条件。

我想不出任何小于 O(n^2 lg n) 复杂度的解决方案。在这种情况下，我更愿意使用最简单的解决方案，它给我带来了这种复杂性，即：

```
 not_found_flag = false

  for each element 'v' in row-1
       for each row 'i' in the remaining set
           perform binary search for 'v' in 'i'
           if 'v' not found in row 'i'
                 not_found_flag = true
                 break
       if not not_found_flag 
           print element 'v' as it is one of the common element 
```

我们可以通过比较每行的最小值和最大值来改进这一点，并根据这一点决定数字“num”是否可能落在该行的“min_num”和“max_num”之间。

二进制搜索 -> O(log n) 用于在 n-1 行中搜索 1 个数字：O(nlogn) 对第一行中的每个数字进行二进制搜索：O(n2logn)

我选择了第一行，我们可以选择任何行，如果在任何（N-1）行中没有找到所选择的行的元素，那么我们实际上没有公共数据。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-23T04:30:59.953

看来这可以在`O(n^2)`; 即，只查看每个元素一次。请注意，如果一个元素对所有数组都是通用的，那么它必须存在于其中任何一个数组中。同样出于说明的目的（并且由于您使用了上面的 for 循环），我假设我们可以为每个数组保留一个索引，但稍后我将讨论如何解决这个问题。

`A_1`让我们通过调用数组`A_N`，并使用从 1 开始的索引。伪代码：

```
# Initial index values set to first element of each array
for i = 1 to N:
  x_i = 1 

for x_1 = 1 to N:
  val = A_1[x_1] 
  print_val = true
  for i = 2 to N:
    while A_i[x_i] < val:
      x_i = x_i + 1
    if A_i[x_i] != val:
      print_val = false
  if print_val:
    print val 
```

**算法说明。**我们使用第一个数组（或任意数组）作为参考算法，并并行遍历所有其他数组（有点像合并排序的合并步骤，除了 N 个数组。）参考数组的每个值是所有数组共有的，必须存在于所有其他数组中。因此，对于每个其他数组（因为它们已排序），我们增加索引`x_i`，直到该索引`A_i[x_i]`处的值至少是我们正在寻找的值（我们不关心较小的值；它们不可能是常见的。）我们可以这样做，因为数组是排序的，因此是单调非递减的。如果所有数组都有这个值，那么我们打印它，否则我们`x_1`在引用数组中增加并继续。即使我们不打印值，我们也必须这样做。

最后，我们打印了所有数组共有的所有值，而每个元素只检查了一次。

**绕过额外的存储需求。**有很多方法可以做到这一点，但我认为最简单的方法是检查每个数组的第一个元素并将最大值作为参考数组`A_1`。如果它们都相同，则打印该值，然后将索引存储`x_2 ... x_N`为每个数组本身的第一个元素。

Java 实现（为简洁起见，没有额外的 hack），使用您的示例输入：

```
public static void main(String[] args) {
    int[][] a = {
            { 10, 160, 200, 500, 500, },
            { 4, 150, 160, 170, 500, },
            { 2, 160, 200, 202, 203, },
            { 3, 150, 155, 160, 300 },
            { 3, 150, 155, 160, 301 } };

    int n = a.length;
    int[] x = new int[n];

    for( ; x[0] < n; x[0]++ ) {
        int val = a[0][x[0]]; 
        boolean print = true;
        for( int i = 1; i < n; i++ ) {
            while (a[i][x[i]] < val && x[i] < n-1) x[i]++;              
            if (a[i][x[i]] != val) print = false;               
        }   
        if (print) System.out.println(val);
    }   
} 
```

输出：

```
160 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T06:29:29.007

这是 python 中的一个解决方案`O(n^2)`，不使用额外的空间，但会破坏列表：

```
def find_common(lists):
    num_lists = len(lists)
    first_list = lists[0]
    for j in first_list[::-1]:
        common_found = True
        for i in range(1,num_lists):
            curr_list = lists[i]
            while curr_list[len(curr_list)-1] > j:
                curr_list.pop()
            if curr_list[len(curr_list)-1] != j:
                common_found = False
                break
        if common_found:
            return j 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-24T01:14:20.467

不使用额外存储，但修改原始数组的 O(n^2) (Python) 版本。允许存储公共元素而不打印它们：

```
data = [
    [10, 160, 200, 500, 500],
    [4, 150, 160, 170, 500],
    [2, 160, 200, 202, 203],
    [3, 150, 155, 160, 300],
    [3, 150, 155, 160, 301],
]

for k in xrange(len(data)-1):
    A, B = data[k], data[k+1]
    i, j, x = 0, 0, None

    while i<len(A) or j<len(B):
        while i<len(A) and (j>=len(B) or A[i] < B[j]):
            A[i] = x
            i += 1

        while j<len(B) and (i>=len(A) or B[j] < A[i]):
            B[j] = x
            j += 1

        if i<len(A) and j<len(B):
            x = A[i]
            i += 1
            j += 1

print data[-1] 
```

我正在做的基本上是获取数据中的每个数组，然后逐个元素地与下一个数组进行比较，删除那些不常见的数组。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-03-06T06:25:30.577

这是Java实现

```
public static Integer[] commonElementsInNSortedArrays(int[][] arrays) {
    int baseIndex = 0, currentIndex = 0, totalMatchFound= 0;
    int[] indices = new int[arrays.length - 1];
    boolean smallestArrayTraversed = false;
    List<Integer> result = new ArrayList<Integer>();
    while (!smallestArrayTraversed && baseIndex < arrays[0].length) {
        totalMatchFound = 0;
        for (int array = 1; array < arrays.length; array++) {
            currentIndex = indices[array - 1];
            while (currentIndex < arrays[array].length && arrays[array][currentIndex] < arrays[0][baseIndex]) {
                currentIndex ++;                    
            }

            if (currentIndex < arrays[array].length) {
                if (arrays[array][currentIndex] == arrays[0][baseIndex]) {
                    totalMatchFound++;
                }
            } else {
                smallestArrayTraversed = true;
            }
            indices[array - 1] = currentIndex;
        }
        if (totalMatchFound == arrays.length - 1) {
            result.add(arrays[0][baseIndex]);
        }
        baseIndex++;
    }

    return result.toArray(new Integer[0]);
} 
```

这是单元测试

```
@Test
public void commonElementsInNSortedArrayTest() {
    int arr[][] = { {1, 5, 10, 20, 40, 80},
                    {6, 7, 20, 80, 100},
                    {3, 4, 15, 20, 30, 70, 80, 120}
                   };

    Integer result[] = ArrayUtils.commonElementsInNSortedArrays(arr);
    assertThat(result, equalTo(new Integer[]{20, 80}));

    arr = new int[][]{
            {23, 34, 67, 89, 123, 566, 1000},
            {11, 22, 23, 24,33, 37, 185, 566, 987, 1223, 1234},
            {23, 43, 67, 98, 566, 678},
            {1, 4, 5, 23, 34, 76, 87, 132, 566, 665},
            {1, 2, 3, 23, 24, 344, 566}
          };

    result = ArrayUtils.commonElementsInNSortedArrays(arr);
    assertThat(result, equalTo(new Integer[]{23, 566}));
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-09-04T06:03:06.083

这个 Swift 解决方案复制了原始版本，但可以修改为采用`inout`参数，这样就不会占用额外的空间。我将其保留为副本，因为我认为最好不要修改原件，因为它会删除元素。通过保留索引可以不删除元素，但此算法删除元素以跟踪它的位置。这是一种功能性方法，可能不是超级有效但有效。由于它是功能性的，因此不需要条件逻辑。我发布它是因为我认为这可能是一种不同的方法，可能对其他人来说很有趣，也许其他人可以想办法让它更有效率。

```
func findCommonInSortedArrays(arr: [[Int]]) -> [Int] {
    var copy = arr
    var result: [Int] = []

    while (true) {

        // get first elements
        let m = copy.indices.compactMap { copy[$0].first }

        // find max value of those elements.
        let mm = m.reduce (0) { max($0, $1) }

        // find the value in other arrays or nil
        let ii = copy.indices.map { copy[$0].firstIndex { $0 == mm } }

        // if nil present in of one of the arrays found, return result
        if (ii.map { $0 }).count != (ii.compactMap { $0 }.count) { return result }

        // remove elements that don't match target value.
        copy.indices.map { copy[$0].removeFirst( ii[$0] ?? 0 ) }

        // add to list of matching values.
        result += [mm]

        // remove the matched element from all arrays
        copy.indices.forEach { copy[$0].removeFirst() }
    }
}

findCommonInSortedArrays(arr: [[9, 10, 12, 13, 14, 29],
                         [3, 5, 9, 10, 13, 14],
                         [3, 9, 10, 14]]
)

findCommonInSortedArrays(arr: [[],
                         [],
                         []]
)

findCommonInSortedArrays(arr: [[9, 10, 12, 13, 14, 29],
                         [3, 5, 9, 10, 13, 14],
                         [3, 9, 10, 14],
                         [9, 10, 29]]
)

findCommonInSortedArrays(arr: [[9, 10, 12, 13, 14, 29],
                               [3, 5, 9, 10, 13, 14],
                               [3, 9, 10, 14],
                               [9, 10, 29]]
) 
```

# post - 发布消息数据或通过 websockets 发送会更好吗？

> ID：15036824
> 
> 赞同：0
> 
> 时间：2013-02-23T03:44:48.523
> 
> 标签：post, websocket, socket.io

我有一个应用程序正在运行，其中不断维护套接字连接（使用 socket.io）。需要发送的数据类似于您在聊天应用程序中看到的数据。通过 POST 发送它会更好（本质上是发布该数据，防止页面重定向，然后使用 websockets 返回新的页面状态），还是只通过 websockets 发送它？各有什么优势？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T03:56:32.477

（您可能想更详细地解释您要完成的工作。您想实现类似聊天的功能）。

WebSocket 通过 HTTP 连接为您提供类似 TCP 的连接协议。它是全双工的，可让您双向推送和拉取内容。连接从“升级”连接类型的 HTTP 启动。它为您提供了一些额外的复杂性的灵活性。我认为它不适用于旧的 HTTP 1.0 代理。

一个简单的 HTTP POST 更暴力。除非您使用 ajax-ish 技术，否则它会将数据推送到 Web 服务并以新网页响应以替换浏览器中的任何内容。

# android - 回栈管理问题

> ID：15036828
> 
> 赞同：1
> 
> 时间：2013-02-23T03:45:35.280
> 
> 标签：android

我有一个使用 .replace() 管理大量片段的活动。使用后退按钮时出现问题。这是一个解释：

Activity 添加 f1 -> f1 被 f2 替换（添加到 backstack） -> f2 被 f3 替换（不添加 backstack）

按下返回按钮

f1 出现单击按钮将 f1 替换为 f2，f1 和 f2 都在屏幕上 - 重叠

关于这个问题，我看了很多问答，这就是我发现的：当f1被f2替换时，事务被添加到backstack中。因此，当单击返回时，它会删除 f2 并添加 f1。但是，f2 已被替换，因此无法删除。

我不确定这是否是我的问题，因为当我单击返回时，似乎 f3 正在被删除。

关于如何解决这个问题的任何想法？

谢谢！

编辑：有什么想法吗？如果有帮助，我可以提供更多信息

编辑：刚刚测试了将所有事务添加到backstack，并多次单击返回返回f1，问题就消失了。所以看起来这就是问题所在。我将如何解决它？

# sql-server - Excel 与 SQL Server 通信以识别用户。

> ID：15036830
> 
> 赞同：1
> 
> 时间：2013-02-23T03:46:28.337
> 
> 标签：sql-server, excel

Excel 查询 SQL Server。尝试使用当前用户名进行查询。我有一个在 SQL Server 中查询视图的 Excel 文件。视图设置为根据用户查询视图返回结果。

我在网络服务器上设置了一个文件供其他人访问，希望当他们打开文件时，它只会显示与他们相关的信息。

但这些信息仍然只针对我自己。我希望它显示用户使用文件的信息，就好像他们直接查询视图一样。

这是视图的示例查询：

```
Select * from dbo.WorkEstimate where Estimator = SUSER_NAME() 
```

但是 Excel 表只返回与我有关的信息。我认为这可能与`connectstring`总是指定我的工作站名称有关。有没有办法改变它以反映正在使用该文件的个人（或他们的工作站）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T04:21:01.587

SQL 语句中的`SUSER_NAME()`(transact-sql) 指​​的是当前执行的 SQL 语句上下文中的当前用户。在您的情况下，它是您在连接字符串中指定的用户 ID。sql server 使用您的连接字符串中指定的用户来运行该语句，从而`SUSER_NAME()`反映该用户。

您将需要使用以下 Excel 函数指定 Excel 在（Windows 环境）下运行的用户：

*   `Application.Username`是在 Excel 工具>选项中设置的用户名（在用户名框下）
*   `Environ("Username")`是您为 Windows 注册的名称，请参阅控制面板 > 系统

因此，您的 SQL 语句必须类似于：

```
vsSQL = "SELECT * FROM dbo.WorkEstimate WHERE (Estimator = '" & Environ("Username") & "');" 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T04:28:47.550

您无需让 Excel 与 SQL Server 通信即可解决此问题。Excel 需要与用户的机器进行通信。

使用此代码可发现与登录到机器的用户相关的所有环境变量。查看结果以确定您需要传递给查询的内容。

将模块添加到您的 Excel 文件并粘贴以下内容：

```
Sub ListAllEnvironmentVariables()
    Dim ws As Worksheet
    Dim rng As Range

    Set ws = Sheets("Sheet1")
    Set rng = ws.Range("A1")

    Dim i As Integer
    i = 1
    Do Until Environ$(i) = ""
        rng.Offset(i - 1).Value = Environ(i)
        i = i + 1
    Loop
End Sub 
```

我`Sheet1`在我的示例中使用，但您可以更改它并将其设置`ws`为工作簿中的任何空白表以查看它是如何工作的。`Sheet1`如果工作表上有数据，显然不要使用。

# php - PHP得到警告和错误信息？

> ID：15036831
> 
> 赞同：7
> 
> 时间：2013-02-23T03:46:36.637
> 
> 标签：php, error-handling

我想将警告和错误消息放入 php $variables 中，因此我将它们保存到我的数据库中。

例如，当出现任何类型的错误、警告或类似情况时：

```
Parse error: syntax error, unexpected T_VARIABLE in /example.php(136) on line 9
Warning: [...] 
```

我想让它们变量 $error_code

这是怎么做到的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-23T04:04:35.803

对于仅记录它们的简单情况：

```
set_error_handler(function($errno, $errstr, $errfile, $errline) use ($db) {
    // log in database using $db->query()
}); 
```

除了将它们记录到您的数据库中（一段时间后您可能不会查看它们）之外，您还可以让这些警告、通知等生成异常：

```
function exception_error_handler($errno, $errstr, $errfile, $errline)
{
    if (error_reporting()) { // skip errors that were muffled
        throw new ErrorException($errstr, $errno, 0, $errfile, $errline);
    }
}

set_error_handler("exception_error_handler"); 
```

来源：[`ErrorException`](http://php.net/errorexception)

异常会有更严重的副作用，所以你应该有一个[异常处理程序](http://www.php.net/set_exception_handler)来防止未捕获的异常导致白页死机。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T03:49:18.837

调查[`set_error_handler()`](http://php.net/manual/en/function.set-error-handler.php)

> 设置用户函数 (error_handler) 以处理脚本中的错误。
> 
> 此函数可用于定义您自己在运行时处理错误的方式，例如在发生严重错误时需要清理数据/文件的应用程序中，或者当您需要在某些条件下触发错误时（使用触发器错误（））。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-23T04:04:51.463

我一直在使用`error_get_last();`，直到找到更好的解决方案

```
$lastError = error_get_last();
echo $lastError ? "Error: ".$lastError["message"]." on line ".$lastError["line"] : "";
// Save to db 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T03:50:27.853

有一个名为 $php_errormsg 的变量会获取上一条错误消息。在这里查看更多信息 - [http://php.net/manual/en/reserved.variables.phperrormsg.php](http://php.net/manual/en/reserved.variables.phperrormsg.php)

# ruby - 将原语的 Ruby 数据结构转换为文字

> ID：15036832
> 
> 赞同：3
> 
> 时间：2013-02-23T03:46:40.927
> 
> 标签：ruby

我有一个由嵌套的内置 Ruby 类型组成的数据结构，例如哈希、数组、关键字、数字和字符串。我想将其转换为文字形式，以便评估该形式产生给定的数据结构。

例如：

```
[ { :some => [ 'thing' ] }, 42 ] -> "[ { :some => [ 'thing' ] }, 42 ]" 
```

这可以通过递归访问结构并处理所有所需的内置类型来获得，但我想知道是否有一些合适的内置/库解决方案我可以使用。

澄清：输出将在生成 Ruby 代码的代码上下文中使用，因此 JSON 等替代方案不是我所追求的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T09:18:38.353

[Object#inspect](http://ruby-doc.org/core-1.9.3/Object.html#method-i-inspect)可能是您正在寻找的。它将为您列出的所有类型生成 ruby​​ 表示。尽管对于日期等更复杂的类型，这可能会开始崩溃。

```
1.9.3 (main):0 > puts [ { :class => [ 'thing' ] }, 42 ].inspect
[{:class=>["thing"]}, 42] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T03:58:39.810

有几个选项，JSON 和 YAML 可能是 Ruby 中最流行的两个。

```
# using JSON
serialized = JSON.dump([ { :some => [ 'thing' ] }, 42 ])
deserialized = JSON.load(serialized)

# using YAML
serialized = YAML.dump([ { :some => [ 'thing' ] }, 42 ])
deserialized = YAML.load(serialized) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-23T06:40:46.707

您可以使用元帅。它是 ruby​​ 核心库。

[http://www.ruby-doc.org/core-1.9.3/Marshal.html](http://www.ruby-doc.org/core-1.9.3/Marshal.html)

来自自述文件：

编组库将 Ruby 对象的集合转换为字节流，允许将它们存储在当前活动脚本之外。随后可以读取该数据并重构原始对象。

# java - 替换android中的通知栏和面板

> ID：15036835
> 
> 赞同：1
> 
> 时间：2013-02-23T03:47:31.893
> 
> 标签：java, android, user-interface, android-4.0-ice-cream-sandwich

我正在尝试为 android（主要是 4.0.4）编写自己的完整 UI 替换（启动器/appdrawer/通知），但是我一直无法找到创建通知栏和面板的起点。我知道这些壮举是可能的，因为已经有一些应用程序可以做到这一点。但我找不到任何入门代码。

# python - 用 f2py 包装的 C 函数只返回零

> ID：15036847
> 
> 赞同：2
> 
> 时间：2013-02-23T03:48:16.030
> 
> 标签：python, c, f2py

我正在尝试使用 f2py 包装一个简单的 C 函数。它编译得很好，但函数只返回零。我是 C 的新手，所以我很确定在那里犯了一个愚蠢的错误。

例如 c 文件：

```
#include <stdio.h>
#include <stdlib.h>
void Test(double x, double y)
{
  x = y*2;
} 
```

.pyf 文件：

```
python module test
interface
   subroutine Test(x, y)        
     intent (c) Test  ! is a C function
     intent (c)         ! all arguments are considered as C based
     double precision intent(in)     :: x
     double precision intent(out)    :: y
   end subroutine Test
end interface
end python module test 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-03-11T22:46:15.200

要解决这个问题，你需要

1.  `.c`如@mgilson所述，要在函数中使用返回变量的指针，

    ```
    void Test(double *x, double y)
    {
       *x = y * 2;
    } 
    ```

2.  在`.pyf`接口中指定使用指针，它是大小为 1 的相同数组，

    ```
    double precision intent(out)   :: x(1)
    double precision intent(in)    :: y 
    ```

然后该`test.Test`函数将返回不是一个标量，而是一个长度为 1 的 numpy ndarray，包含该标量。不过，我不确定是否有另一种处理方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T03:58:27.347

我不是专家`C`，但我认为您的变量需要成为任何更改的指针：

```
void Test(double *x, double *y)
{
  *x = *y * 2;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-10T15:05:57.347

编辑：我的第一个答案是错误的，正如其他人所指出的，这些值确实应该作为指针传递给 C。

```
void Test(double* x, double* y)
{
    *y = *x * 2;
} 
```

# java - 当我编写多个对象时，我收到此 IO 错误“无效类型代码：AC”，为什么？

> ID：15036854
> 
> 赞同：1
> 
> 时间：2013-02-23T03:49:25.797
> 
> 标签：java, serialization

这是我的文件处理类......我在任何其他类中都没有任何错误......程序也覆盖了文件中的数据......它没有附加

```
import java.io.FileOutputStream;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.ObjectOutputStream;
import java.io.ObjectInputStream;
import java.io.EOFException;
import java.lang.ClassNotFoundException;
import java.util.NoSuchElementException;

public class FileHandling {

    FileHandling() {
    }

    public void addCustomer(Customer customerObject, String filePath) {

        ObjectOutputStream output;

        try {
            FileOutputStream fileOut = new FileOutputStream(filePath, true);
            output = new ObjectOutputStream(fileOut);
            output.writeObject(customerObject);
            output.close();
        }

        catch (IOException ioexception) {
            System.err.println("Error with file");
        }
    // end addCustomer function
    }

    public void retrieveCustomerData(String filePath) {

        Customer record = new Customer();

        ObjectInputStream input;

        try {
            FileInputStream fileOut = new FileInputStream(filePath);
            input = new ObjectInputStream(fileOut);

        }

        catch (IOException ioexception) {
            System.err.println("Error with file1");
            return;
        }

        try {
            while (true && input != null) {

                record = (Customer) input.readObject();

                System.out.println(record.getFirstName());
                System.out.println(record.getLastName());
                System.out.println(record.getEmailAddress());

            // end while loop   
            }

        // end try block    
        } catch (EOFException endOfFileException) {

        }

        catch (ClassNotFoundException ioexception) {
            System.err.println("Class not Found");
        }

        catch (IOException ioexception) {
            System.err.println("Error with file2");
            System.err.println(ioexception.getMessage());
        }

        try {
            if (input != null)
                input.close();
        }

        catch (IOException ioException) {
            System.err.println("Error closing file");
        }
    // end retrieveCustomerData function
    }

// end class fileHandling
} 
```

# mysql - 构造二维 MySQL 查询的最有效方法是什么？

> ID：15036871
> 
> 赞同：4
> 
> 时间：2013-02-23T03:52:43.937
> 
> 标签：mysql, sql, database, performance

我有一个 MySQL 数据库，其中包含以下表和字段：

*   学生卡）
*   班级号）
*   成绩（id、student_id、class_id、成绩）

学生和班级表在 id（主键）上建立索引。成绩表以 id（主键）和 student_id、class_id 和成绩为索引。

我需要构建一个查询，给定一个班级 ID，给出所有其他班级的列表以及在其他班级中得分更高的学生人数。

基本上，给定成绩表中的以下数据：

```
student_id | class_id | grade
--------------------------------------
1          | 1        | 87
1          | 2        | 91
1          | 3        | 75
2          | 1        | 68
2          | 2        | 95
2          | 3        | 84
3          | 1        | 76
3          | 2        | 88
3          | 3        | 71 
```

使用类 ID 1 查询应产生：

```
class_id | total
-------------------
2        | 3
3        | 1 
```

理想情况下，我希望它在几秒钟内执行，因为我希望它成为 Web 界面的一部分。

我遇到的问题是，在我的数据库中，我有超过 1300 个班级和 160,000 名学生。我的成绩表有近 1500 万行，因此查询需要很长时间才能执行。

到目前为止，这是我尝试过的以及每个查询所花费的时间：

```
-- I manually stopped execution after 2 hours
SELECT    c.id, COUNT(*) AS total
FROM      classes c
              INNER JOIN grades a ON a.class_id = c.id
              INNER JOIN grades b ON b.grade < a.grade AND
                  a.student_id = b.student_id AND
                  b.class_id = 1
WHERE     c.id != 1 AND
GROUP BY  c.id

-- I manually stopped execution after 20 minutes
SELECT    c.id,
          (
              SELECT    COUNT(*) 
              FROM      grades g 
              WHERE     g.class_id = c.id AND g.grade > (
                            SELECT   grade 
                            FROM     grades 
                            WHERE    student_id = g.student_id AND 
                                     class_id = 1
                        )
          ) AS total
FROM      classes c
WHERE     c.id != 1;

-- 1 min 12 sec
CREATE TEMPORARY TABLE temp_blah (student_id INT(11) PRIMARY KEY, grade INT);
INSERT INTO temp_blah SELECT student_id, grade FROM grades WHERE class_id = 1;
SELECT    o.id,
          ( 
              SELECT    COUNT(*)
              FROM      grades g
                            INNER JOIN temp_blah t ON g.student_id = t.student_id
              WHERE     g.class_id = c.id AND t.grade < g.grade
          ) AS total
FROM      classes c
WHERE     c.id != 1;

-- Same thing but with joins instead of a subquery - 1 min 54 sec
SELECT    c.id,
          COUNT(*) AS total
FROM      classes c
              INNER JOIN grades g ON c.id = p.class_id
              INNER JOIN temp_blah t ON g.student_id = t.student_id
WHERE     c.id != 1
GROUP BY  c.id; 
```

我还考虑创建一个 2D 表，其中学生作为行，类作为列，但是我可以看到两个问题：

*   MySQL 实现了最大列数（4096）和最大行大小（以字节为单位），这种方法可能会超过
*   我想不出一种查询该结构以获得所需结果的好方法

我还考虑将这些计算作为后台作业执行并将结果存储在某处，但为了使信息保持最新（必须），每次创建或更新学生、班级或成绩记录时都需要重新计算它们。

有谁知道构建此查询的更有效方法？

编辑：创建表语句：

```
CREATE TABLE `classes` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1331 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci$$

CREATE TABLE `students` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=160803 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci$$

CREATE TABLE `grades` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `student_id` int(11) DEFAULT NULL,
  `class_id` int(11) DEFAULT NULL,
  `grade` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `index_grades_on_student_id` (`student_id`),
  KEY `index_grades_on_class_id` (`class_id`),
  KEY `index_grades_on_grade` (`grade`)
) ENGINE=InnoDB AUTO_INCREMENT=15507698 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci$$ 
```

最有效查询的解释输出（1 分 12 秒）：

```
id | select_type        | table | type   | possible_keys                                                             | key                      | key_len | ref               | rows   | extra 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1  | PRIMARY            | c     | range  | PRIMARY                                                                   | PRIMARY                  | 4       |                   | 683    | Using where; Using index
2  | DEPENDENT SUBQUERY | g     | ref    | index_grades_on_student_id,index_grades_on_class_id,index_grades_on_grade | index_grades_on_class_id | 5       | mydb.c.id         | 830393 | Using where
2  | DEPENDENT SUBQUERY | t     | eq_ref | PRIMARY                                                                   | PRIMARY                  | 4       | mydb.g.student_id | 1      | Using where 
```

另一个编辑 - 解释 sgeddes 建议的输出：

```
+----+-------------+------------+--------+---------------+------+---------+------+----------+----------------------------------------------+
| id | select_type | table      | type   | possible_keys | key  | key_len | ref  | rows     | Extra                                        |
+----+-------------+------------+--------+---------------+------+---------+------+----------+----------------------------------------------+
|  1 | PRIMARY     | <derived2> | ALL    | NULL          | NULL | NULL    | NULL | 14953992 | Using where; Using temporary; Using filesort |
|  2 | DERIVED     | <derived3> | system | NULL          | NULL | NULL    | NULL |        1 | Using filesort                               |
|  2 | DERIVED     | G          | ALL    | NULL          | NULL | NULL    | NULL | 15115388 |                                              |
|  3 | DERIVED     | NULL       | NULL   | NULL          | NULL | NULL    | NULL |     NULL | No tables used                               |
+----+-------------+------------+--------+---------------+------+---------+------+----------+----------------------------------------------+ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T04:16:29.587

我认为这应该适合您使用`SUM`and `CASE`：

```
SELECT C.Id,
  SUM(
    CASE 
    WHEN G.Grade > C2.Grade THEN 1 ELSE 0 
    END
  ) 
FROM Class C
  INNER JOIN Grade G ON C.Id = G.Class_Id
  LEFT JOIN (
      SELECT Grade, Student_Id, Class_Id
      FROM Class
        JOIN Grade ON Class.Id = Grade.Class_Id
      WHERE Class.Id = 1
    ) C2 ON G.Student_Id = C2.Student_Id
WHERE C.Id <> 1
GROUP BY C.Id 
```

[小提琴演示示例](http://sqlfiddle.com/#!2/00473/1)

**- 编辑 -**

针对您的评论，这是另一个应该更快的尝试：

```
SELECT 
  Class_Id, 
  SUM(CASE WHEN Grade > minGrade THEN 1 ELSE 0 END)
FROM 
(
  SELECT 
    Student_Id,
    @classToCheck:=
      IF(G.Class_Id = 1, Grade, @classToCheck) minGrade ,
    Class_Id,
    Grade
  FROM Grade G
    JOIN (SELECT @classToCheck:= 0) t
  ORDER BY Student_Id, IF(Class_Id = 1, 0, 1)
  ) t
WHERE  Class_Id <> 1
GROUP BY Class_ID 
```

还有[更多的样品小提琴](http://sqlfiddle.com/#!2/6211e5/1)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T04:51:34.113

您也可以尝试一下原始数据吗？这只是一个加入:)

```
select
  final.class_id, count(*) as total
from
  (
    select * from   
      (select student_id as p_student_id, grade as p_grade from table1 where class_id = 1) as partial
    inner join table1 on table1.student_id = partial.p_student_id
    where table1.class_id <> 1 and table1.grade > partial.p_grade    
  ) as final
 group by
  final.class_id; 
```

[sqlfiddle 链接](http://sqlfiddle.com/#!2/eaaab/4/0)

# c++ - 使用递归后程序崩溃

> ID：15036873
> 
> 赞同：0
> 
> 时间：2013-02-23T03:53:22.437
> 
> 标签：c++, recursion

修改我的反向字符串函数以添加递归。不幸的是，我的程序一直在爆炸。

在 Visual Studio 中单步执行我的代码，由于某种原因，监视窗口会说 i 等于字符串的长度（即退出 while 循环的终止条件）。我最后一次跨过它，它说我现在比字符串长度少一。然后它永远停留在while循环中。

我知道这听起来很混乱，所以我举个例子。我输入“海绵宝宝”，它会做我想做的一切（即海绵宝宝的长度是 9，打印“bobegnopS”，将 i 增加到字符串长度等），但它说 i 现在是 8（即它是就在 9) 并且永远不会退出 while 循环。

这是我的 ReverseString() 函数：

```
void ReverseString(char * string, bool stringReversed, int stringLength, int i)
{
    i++;
    if(!stringReversed)
    {
        while(*string != '\0')
        string++;
    }
    stringReversed = true;

    while(i < stringLength)
    {
        string--;
        std::cout << *string;
        ReverseString(string, stringReversed, stringLength, i);
    }
   } 
```

这是电话：

```
 case 3:
    //Learn By Doing 16.6
    {
        char string[BUFFER_LENGTH];
        bool stringReversed = false;

        int base = 0;
        int exponent = 0;

        std::cout << "\nEnter base: " << std::endl;
        std::cin >> base;

        std::cout << "\nEnter exponent: " << std::endl;
        std::cin >> exponent;

        //Print pow
        NewLine();
        std::cout << base << " to the " << exponent << " is " << pow(base, exponent);

        //Reverse string using recursion
        std::cout << "\nEnter string: " << std::endl;
        std::cin >> string;

        NewLine();
        int stringLength = strlen(string);
        int i = 0;
        ReverseString(string, stringReversed, stringLength, i);

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T04:58:35.630

当您编写递归函数时，您总是需要指定何时停止的条件。想象一下，您想编写简单的阶乘递归实现。所以想法是这样计算：

```
n! = n * (n-1) *...*2*1 
```

如果您查看序列，您会发现您需要在值 1 处停止。所以天真的递归实现可能是这样的：

```
int factorial( int n )
{
   // stop when we reached 1
   // otherwise we never finish
   if( n == 1 ) return 1; 
   // now do the magic
   return n * factorial( n - 1 );
} 
```

您是否需要返回值这一事实并不会改变您需要设置停止条件的事实，否则您的递归函数将永远不会停止。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T04:53:12.093

```
void ReverseString(char * string, bool stringReversed, int stringLength, int i)
{
  ...
  while(i < stringLength)
  {
    string--;
    std::cout << *string;
    ReverseString(string, stringReversed, stringLength, i);
  }
} 
```

循环内没有任何东西修改`i`或`stringLength`（函数`ReverseString`通过值而不是通过引用获取它们。）所以它永远不会终止。

# c++ - 用于读取标准输入的 C++ 最快 cin？

> ID：15036878
> 
> 赞同：6
> 
> 时间：2013-02-23T03:54:15.550
> 
> 标签：c++, performance

我已经使用 cachegrind 在 Linux 上分析了一个计算量很大的 C++ 程序。令人惊讶的是，我的程序的瓶颈并不在于任何排序或计算方法......它在于读取输入。

这是 cachegrind 的屏幕截图，以防我误解了探查器结果（**请参阅** `scanf()`）：

![探查器结果](../Images/d0ecdf3615e89b1e4a5e52cea7f96778.png)

我希望我的说法是正确的，这`scanf()`占用了我运行时间的 80.92%。

我使用 读取输入`cin >> int_variable_here`，如下所示：

```
std::ios_base::sync_with_stdio (false); // Supposedly makes I/O faster
cin >> NumberOfCities;
cin >> NumberOfOldRoads;
Roads = new Road[NumberOfOldRoads];

for (int i = 0; i < NumberOfOldRoads; i++)
{
    int cityA, cityB, length;    

    cin >> cityA;
    //scanf("%d", &cityA);    // scanf() and cin are both too slow
    cin >> cityB;
    //scanf("%d", &cityB);
    cin >> length;
    //scanf("%d", &length);

    Roads[i] = Road(cityA, cityB, length);
} 
```

如果您没有发现此输入读取代码有任何问题，您能否推荐一种更快的读取输入的方法？我正在考虑尝试`getline()`（在等待回复的同时进行处理）。我的猜测是 getline() 可能运行得更快，因为它必须进行更少的转换并且它解析流的总次数更少（只是我的猜测，尽管我最终也必须将字符串解析为整数）。

我所说的“太慢”的意思是，这是一个更大的家庭作业的一部分，它在一段时间后超时（我相信它是 90 秒）。我非常有信心瓶颈就在这里，因为我故意注释掉了我程序其余部分的主要部分，但它仍然超时。我不知道讲师在我的程序中运行了哪些测试用例，但它一定是一个巨大的输入文件。那么，我可以用什么来最快地读取输入？

输入格式是严格的：每行用一个空格分隔的 3 个整数，对于多行：

样本输入：

```
7 8 3
7 9 2
8 9 1
0 1 28
0 5 10
1 2 16 
```

我需要`Road`从每一行中的整数中取出一个。

另外请不要将输入重定向到我的程序到标准输入（`myprogram < whatever_test_case.txt`）。我没有阅读特定的文件。我刚从`cin`.

## 更新

**使用[Slava 的](https://stackoverflow.com/a/15036951/555547)方法：**

输入读取似乎花费的时间更少，但它仍然超时（可能不再是由于输入读取）。Slava的方法在`Road() ctor`（2下`main`）中实现。所以现在它需要 22% 的时间，而不是 80%。我正在考虑优化`SortRoadsComparator()`，因为它被称为 26,000,000 次。

![在此处输入图像描述](../Images/6a7d7a245790485ce72867c464a58a2f.png)

**比较器代码：**

```
// The complexity is sort of required for the whole min() max(), based off assignment instructions
bool SortRoadsComparator(const Road& a, const Road& b)
{
    if (a.Length > b.Length) 
        return false;

    else if (b.Length > a.Length) 
        return true;

    else
    {
        // Non-determinism case
        return ( (min(a.CityA, a.CityB) < min(b.CityA, b.CityB)) ||
            (
            (min(a.CityA, a.CityB) == min(b.CityA, b.CityB)) && max(a.CityA, a.CityB) < max(b.CityA, b.CityB)                                     
            )
            );
    }
} 
```

**使用[enhzflep 的](https://stackoverflow.com/a/15037439/555547)方法**

![在此处输入图像描述](../Images/798b103f306d0a5555454fee759feeba.png)

### 考虑解决

我将考虑解决这个问题，因为瓶颈不再是读取输入。Slava 的方法对我来说是最快的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T04:07:46.673

流很清楚很慢。不过这并不令人意外——他们需要处理本地化、条件等。一种可能的解决方案是逐行读取文件 std::getline( std:::cin, str ) 并通过类似的方式将字符串转换为数字这：

```
std::vector<int> getNumbers( const std::string &str )
{
   std::vector<int> res;
   int value = 0;
   bool gotValue = false;
   for( int i = 0; i < str.length(); ++i ) {
      if( str[i] == ' ' ) {
         if( gotValue ) res.push_back( value );
         value = 0;
         gotValue = false;
         continue;
      }
      value = value * 10 + str[i] - '0';
      gotValue = true;
   }
   if( gotValue ) res.push_back( value );
   return res;
} 
```

我没有测试这段代码，写它来展示这个想法。我假设您不希望在输入中得到任何内容，除了空格和数字，因此它不会验证输入。

首先要优化排序，您应该检查是否真的需要对整个序列进行排序。对于比较器，我会编写方法 getMin() getMax() 并将该值存储在对象中（而不是一直计算它们）：

```
bool SortRoadsComparator(const Road& a, const Road& b)
{
    if( a.Length != b.Length ) return a.Length < b.length;
    if( a.getMin() != b.getMin() ) return a.getMin() < b.getMin();
    return a.getMax() < b.getMax();
} 
```

如果我了解您当前的比较器如何正常工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T05:30:43.870

正如 Slava 所说，就性能（和可执行文件大小）而言，流（即 cin）是绝对的猪

考虑以下两种方法：

```
start = clock();
std::ios_base::sync_with_stdio (false); // Supposedly makes I/O faster
cin >> NumberOfCities >> NumberOfOldRoads;
Roads = new Road[NumberOfOldRoads];
for (int i = 0; i < NumberOfOldRoads; i++)
{
    int cityA, cityB, length;
    cin >> cityA >> cityB >> length;
    Roads[i] = Road(cityA, cityB, length);
}
stop = clock();
printf ("time: %d\n", stop-start); 
```

和

```
start = clock();
fp = stdin;
fscanf(fp, "%d\n%d\n", &NumberOfCities, &NumberOfOldRoads);
Roads = new Road[NumberOfOldRoads];
for (int i = 0; i < NumberOfOldRoads; i++)
{
    int cityA, cityB, length;
    fscanf(fp, "%d %d %d\n", &cityA, &cityB, &length);
    Roads[i] = Road(cityA, cityB, length);
}
stop = clock();
printf ("time: %d\n", stop-start); 
```

每种方式运行 5 次（输入文件包含 1,000,000 个条目 + 前 2 个“控制”行）给我们以下结果：

1.  ***使用没有***方向的cin与 stdio 8291、8501、8720、8918、7164（平均 8318.3）不同步

2.  使用 cin***的***方向与 stdio 4875、4674、4921、4782、5171（平均 4884.6）不同步

3.  使用 fscanf 1681、1676、1536、1644、1675（平均 1642.4）

因此，很明显，可以看到 sync_with_stdio(false) 方向确实有帮助。人们还可以看到 fscanf 用 cin 击败了每一种方法。事实上，fscanf 方法比更好的 cin 方法***快近 3 倍***，并且在没有被告知避免与 stdio 同步的情况下比 cin***快 5 倍。***

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T04:29:04.343

```
inline void S( int x ) {
x=0;
while((ch<'0' || ch>'9') && ch!='-' && ch!=EOF) ch=getchar_unlocked();
if (ch=='-')
sign=-1 , ch=getchar_unlocked();
    else
sign=1;
do
x = (x<<3) + (x<<1) + ch-'0';
while((ch=getchar_unlocked())>='0' && ch<='9');
x*=sign;
} 
```

您可以将此功能用于任何类型的数字输入，只需更改参数类型。这将比 std scanf 运行得更快。

如果您想节省更多时间，最好的办法是使用 fread() 和 fwrite() 但在这种情况下，您必须自己操作输入。为了节省时间，您应该使用 fread() 在一次调用中从标准输入流中读取大量数据。这将减少 I/O 调用的数量，因此您会看到很大的时间差异。

# c++ - 如何在 C++ 中的基类和派生类之间共享一个通用的默认参数值？

> ID：15036886
> 
> 赞同：2
> 
> 时间：2013-02-23T03:55:18.337
> 
> 标签：c++, inheritance

考虑以下类：

```
class A {
   public:
   A( std::string param = "123" ) {} 
};

class B : public A{ 
   public: 
   B() : A() {}
   B( std::string param ) : A( param ) {}
}; 
```

有没有比这更好的方法来确保使用来自 A 的默认参数值？我希望有人能够通过提供或不提供字符串参数来构造 B。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T05:22:18.900

根据您的确切需求，这可能是最好的选择（如果您想确保在派生类型中立即获取基中默认参数的更改），或者您可以使用与您相同的方法在基地：

```
class B : public A {
public:
   B(std::string const & arg = "123") : A(arg) {}
// ... 
```

在这种情况下，如果更改基类型中的值，则需要记住更新派生类型中的默认值。您还可以将其分解为常数：

```
const char* defaultParam = "123";
class A {
public:
   A(std::string const& s=defaultParam) // ...
//...
};
class B : public A {
public:
   B(std::string const& s=defaultParam) : A(s) {}
//... 
```

# java - 如何从某个对象的数组中生成迭代器

> ID：15036887
> 
> 赞同：-1
> 
> 时间：2013-02-23T03:55:33.377
> 
> 标签：java, arrays, iterator

```
private SomeObject[] all_objs;     

public Iterator<SomeObject> iterator() {
   //
} 
```

从数组中获取迭代器的最佳方法是`SomeObject`什么？

**编辑** 因此，如果不使用 ArrayLists 或 HashSets 之类的包装器，就无法生成迭代器吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T04:02:18.270

您可以编写自己的类来实现`Iterator<SomeObject>`. 只需实现接口的方法。如果您不希望迭代器的用户从数组中删除项目（因为它不是 ArrayList），则在调用此方法时抛出 UnsupportedOperationException。

当然，如果您使用 an `ArrayList<SomeObject>`then 该`iterator()`方法只需从 ArrayList 返回迭代器，从而使您的生活更轻松。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T04:07:29.613

使用`List`迭代器：

```
import java.util.List;
import java.util.Arrays;

public <T> Iterator<T> iterator() {
    List<T> list = (List<T>) Arrays.asList(all_objs);

    return list.iterator();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T04:51:03.610

您还可以查看[java.util.ArrayList](http://www.docjar.com/html/api/java/util/ArrayList.java.html)的代码。这是您应该如何实现它的方法。

```
 T=SomeObject //Your Class

 public YourIterable<T> implements Iterable<T>{
     //**Iterable**  Implementing this interface allows an object 
     //to be the target of the "foreach" statement.
     public Iterator<T> iterator() {

          return new Itr();
      }  

   private class Itr implement Iterator<T> {
      //Complex Implementation - You have to maintain a Cursor to keep track of 
      // which record was accessed
            boolean hasNext() {
                 //Returns true if the iteration has more elements.
            }

            T next() { 
             //Returns the next element in the iteration.
            }  

            void remove() {//Remove 
          }

    }

 } 
```

# android - 在椭圆路径中移动图像

> ID：15036888
> 
> 赞同：0
> 
> 时间：2013-02-23T03:55:37.143
> 
> 标签：android, android-canvas, android-animation, android-imageview

我正在创建一个具有图像的 Android 应用程序。图像必须围绕椭圆路径的中心旋转。我需要一个函数来返回椭圆路径的 X 和 Y 坐标。你能帮我实现这个目标吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T04:17:43.347

下面的方程将为您提供椭圆的 x 和 y 坐标。

```
x = a cos t 
y = b sin t 
```

a - 与原点的水平距离。

b - 到原点的垂直距离

t - 您需要坐标的角度。 ![在此处输入图像描述](../Images/c8cdc43eb81b09c80c0284e6d8d541ca.png)

```
List<Double> xcoord = new ArrayList<Double>();
List<Double> ycoord = new ArrayList<Double>();

public void getCoordinates() {
    for(int i=0;i<360;i++) {
        xcoord.add(10 * Math.cos(i));
        ycoord.add(20 * Math.sin(i));
    }
} 
```

上面的函数将 0 到 360 的所有坐标添加到列表中，其中 10 为与原点的水平距离，20 为与原点的垂直距离。希望这可以帮助。

# javascript - jquery动画重复了几次

> ID：15036898
> 
> 赞同：1
> 
> 时间：2013-02-23T03:57:27.980
> 
> 标签：javascript, jquery

我的动画有问题。这是我的代码：

```
<html>
    <head>
        <script type='text/javascript' src='http://code.jquery.com/jquery-1.9.1.js'></script>
        <title>title</title>
        <style>
            div{
                width: 100px;
                height: 100px;
                background-color: green;
                position:relative;
                left: 0px;
            }
        </style>
    </head>
    <body>
        <h1>Animation</h1>
        <select id='text_1' type="text">
            <option>100</option>
            <option>200</option>
            <option>300</option>
            <option>400</option>
            <option>500</option>
            <option>600</option>
            <option>700</option>
            <option>800</option>
            <option>900</option>
            <option>1000</option>
        </select>
        <button>Animate Div</button><br/><br/>
        <div></div>
        <script>
            $(document).ready(function(){
                var number = 500;
                $('#text_1').bind('change', function(){
                    var number_2 = $('#text_1').val() != '' ? $('#text_1').val() : 500;
                    animation(number_2);
                });
                animation(number);
            });
            function animation(num){
                $('button').click(function(){
                    $('div').animate({
                        'left': num+'px',
                    }, 1000).animate({
                        'left': '0px',
                    }, 1000);;
                });
            }
        </script>
    </body>
</html> 
```

当我更改选择选项（例如：300）并单击按钮时，会执行两个动画。当我再次更改选择选项时，会出现树动画。怎么了。请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T04:05:07.203

这不是最优雅的解决方案，但是如果您将代码修改为如下所示：

```
function animation(num) {
    $('button').unbind('click'); //this removes the old click event
    $('button').click(function(){
        ....
    }
} 
```

那么这应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T04:05:43.187

尝试

```
$(document).ready(function()
{
    $('button').on('click',function()
    {
        var num = $('#text_1').val() != '' ? $('#text_1').val() : 500;

        $('div').animate(
        {
            'left': num+'px',
        }, 1000).animate(
        {
            'left': '0px',
        }, 1000);
    });

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T04:06:29.203

这可能无关紧要，但您应该学习如何使用 Javascript 调试器，例如 Firebug，如果这可能会给您提供线索的话。

如果您使用了调试器，并且在“click”函数中设置了断点，您会看到它被多次命中，加起来就是您更改选项下拉菜单的次数。我猜那是因为您的“animation()”函数每次调用时都会将新函数绑定到“click”事件，而不是删除以前的函数，因此单击按钮将多次执行“click”函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T04:08:33.163

这可能是你的意思

```
$(document).ready(function(){
    var number = 500;
    $('button').click(function(){
        $('div').stop().animate({
            'left': number+'px',
        }, 1000).animate({
            'left': '0px',
        }, 1000);
    });
    $('#text_1').bind('change', function(){
        number = $('#text_1').val() != '' ? $('#text_1').val() : 500;
    });
}); 
```

否则，您每次制作动画时都会将单击事件绑定到按钮，这将成为问题。第一次点击绑定一次，所以它动画一次，然后你的动画绑定到再次点击，所以它动画两次。还要注意 stop() ，它会导致 div 停止它正在做的事情并开始一个新的动画，以防止你多次单击按钮并保持动画几秒钟的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-23T04:29:39.933

您正在多次绑定 click 事件。

将其更改为：

```
 $('button').off('click').on('click', function(){
                $('div').animate({
                    'left': num+'px',
                }, 1000).animate({
                    'left': '0px',
                }, 1000);;
            }); 
```

请记住`.off`并`.on`替换`.bind`，`.unbind` 此外，出于性能原因，最好将这样的函数链接起来。

# oop - 在面向对象编程中，我们什么时候需要抽象？

> ID：15036900
> 
> 赞同：2
> 
> 时间：2013-02-23T03:57:38.963
> 
> 标签：oop, object, interface, abstract-class

我读了很多关于“接口”和“抽象类”的帖子

基本上，当我们谈论对象的特性时，我们使用“抽象类”。

当我们谈论对象能够做什么时，我们使用“接口”。

但这仍然令人困惑，所以我自己做一个例子来练习。

所以现在我在想一个对象'货物;

```
 public abstract class cargo {

        protected int id;

        public abstract int getWidth(int width);

        public abstract int setWidth(int width);

        public abstract int setHeight(int h);

        public abstract int getHeight(int h);

        public abstract int setDepth(int d);

        public abstract int getDepth(int d);

        public abstract int volume(int w,int h,int d);

        public int getId(){
            return this.id;
        }

        public abstract int setId();

        public abstract void setBrand();

        public abstract void getBrand( );

        .....so on , still have a lot of characteristic of a cargo
    }

    //in the other class
    public class usaCargo extends cargo{
                  ....
                  private 

    } 
```

所以这里有几个关于我的设计的问题。

1.那么在真实的编程项目世界中，我们真的是像上面那样做吗？对我来说，我认为这是好的设计，我们符合货物的基本特征。

1.  如果我们设置“private id”，那么我们实际上不能在任何子类中使用“id”这个变量，因为它是私有的，这是否意味着我们在抽象类中定义的每个变量都必须是公共/受保护的？

2.  有人可以举一些合适的例子让我的货物可以实现一些接口吗？

    ```
    public interface registration{
         public void lastWarrantyCheck();
    } 
    ```

    不过好像不太适合这里...

3.  我们通常不在接口内定义变量，对吗？

我试图在 OOP 上获得更多意义。原谅我长长的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T04:26:47.700

1.  抽象类可以包含实现，因此**它们可以具有私有变量和方法**。另一方面，接口不能。

2.  [您可以在此处](http://www.tutorialspoint.com/java/java_interfaces.htm)找到一些有关如何实现接口的示例。但是，我在下面包含了您将如何实现注册示例。

    ```
    public class Cargo implements Registration{
       public void lastWarrantyCheck(){
          System.out.println("Last warranty check");
       }           
    } 
    ```

3.  接口**变量**是可能的，但它们应该只包括常量声明（声明为静态和最终的变量声明）。可以在[此处](http://en.wikipedia.org/wiki/Interface_%28Java%29)找到有关此的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T04:35:12.483

您将在 Abstract 类中定义变量，以便在抽象类中定义的方法具有要使用的变量。这些变量的范围取决于您希望具体类如何访问这些变量：

`private`当您想强制具体类通过抽象类中定义的 getter 或 setter 时应该使用。

`protected`当您想要让具体类直接访问变量时应该使用。

`public`当您希望任何类都可以访问该变量时，应使用该变量。

Cargo 对象可能实现的合理接口可以是 Shippable ，就像如何将货物从源移动到目的地一样。有些货物可以通过货运列车运输，有些可以通过飞机运输，等等。实现 Shippable 并定义如何运输这种类型的货物取决于具体的类。

```
public interface Shippable {
    public void ship();
} 
```

最后，在接口中定义的变量必须是 public static 和 final 意味着它将是一个常量变量。

希望这可以为您解决问题！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T04:40:40.327

1.  抽象类中的变量可以声明为`protected`，并且它们只能在它和任何扩展类中可用。 `Private`在扩展类中永远无法访问变量。

2.  接口提供了实现它们的类所需的函数列表。例如，您可以使用接口 hasWarranty 来定义对象处理与保修相关的活动所需的所有功能。

    ```
    public interface hasWarranty {
        public void lastWarrantyCheck();
        public void checkWarranty();
    } 
    ```

    然后，任何需要执行保修相关活动的对象都应该实现该接口：

    ```
    // Disclaimer: been away from Java for a long time, so please interpret as pseudo-code.

    // Will compile
    public class Car implements hasWarranty {
        public void lastWarrantyCheck() {
            ... need to have this exact function or program won't compile ...
        }
        public void checkWarranty() {
            ... need to have this exact function or program won't compile ...
        }
    }

    // Missing one of the required functions defined in hasWarranty
    public class Bus implements hasWarranty {
        public void lastWarrantyCheck() {
            ... need to have this exact function or program won't compile ...
        }
    } 
    ```

3.  实际上，只有常量作为接口中声明的变量是不可变的，并且由实现该接口的所有对象共享。它们是隐含的“静态最终”。

# bash - 用于抓取数据和减去的 shell 脚本

> ID：15036901
> 
> 赞同：2
> 
> 时间：2013-02-23T03:57:59.767
> 
> 标签：bash, sed

游戏 A 和 B 的玩家：

```
 wget --output-document=- http://runescape.com/title.ws 2>/dev/null \
    | grep PlayerCount \
    | head -1l \
    | sed 's/^[^>]*>//' \
    | sed "s/currently.*$/$(date '+%r %b %d %Y')/" \
    | cut -d">" -f 3,4 \
    | sed 's/<\/span>//' 
```

输出：`111,048 people 10:43:54 PM Feb 22 2013`

游戏B的玩家：

```
wget --output-document=- http://oldschool.runescape.com/ 2>/dev/null | grep "people playing" 
```

输出：`There are currently 42823 people playing!`

我想计算有多少人玩游戏 A，但我不太确定如何从这两个输出中获取数字，然后减去它们并以相同的格式输出它们，如下所示：

```
`111,048 people 10:43:54 PM Feb 22 2013` 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T04:31:41.310

```
total=$(wget --output-document=- http://runescape.com/title.ws 2>/dev/null |
        sed -n '/PlayerCount/{s/^[^0-9]*<span>\([0-9,]*\).*/\1/;s/,//g;p;q;}')
gameb=$(wget --output-document=- http://oldschool.runescape.com/ 2>/dev/null | 
        sed -n '/people playing/{s/There are currently \([0-9]*\) people playing!/\1/;p;q;}')
gamea=$(($total - $gameb)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T04:35:21.267

```
#!/bin/sh

URL1=http://runescape.com/title.ws
tot=`wget  -qO- $URL1  | grep -i PlayerCount | cut -d\> -f4 | cut -d\< -f1 | sed -e's/,//'`
URL2=http://oldschool.runescape.com
b=`wget -qO- $URL2| grep "people playing" | awk '{print $4}'`
a=`expr $tot - $b`
echo "$a people `date '+%r %b %d %Y'`" 
```

...如果您想要逗号，请将这些行添加到脚本中...

```
export LC_ALL=en_US.UTF-8
a_with_comma=`echo $a | awk "{printf \"%'d\n\", \\$1}"`
echo "$a_with_comma people `date '+%r %b %d %Y'`" 
```

# node.js - Express & EJS - layout.ejs 未使用

> ID：15036904
> 
> 赞同：4
> 
> 时间：2013-02-23T03:58:23.013
> 
> 标签：node.js, express, ejs

我尝试将 EJS 作为 Express 的视图引擎。看来我的 layout.ejs 没有使用。我的“视图”文件夹中有两个视图 index.ejs 和 layout.ejs。似乎 index.js 已呈现，但 layout.ejs 未呈现。layout.ejs 文件应该包含一个 CSS 文件，但是当页面在浏览器中呈现时，它不存在。我放置在 layout.ejs 文件中的任何测试测试文本都不会随响应一起输出。

我是否缺少额外的配置步骤？

谢谢！

我的 server.js 代码：

```
var express = require('express');

var app = express();
    app.set('view engine', 'ejs');
    app.use(express.static(__dirname + '/public'));
    app.get('/', function(req, res){
            res.render('index.ejs', {title: 'EJS Engine'});
    });

    app.listen(8080); 
```

在我的 layout.ejs 中，我链接到位于公共文件夹中的单个 css 文件。

布局.ejs：

```
<!DOCTYPE html>
       <html>
       <head>
           <title><%= title %></title>
            <link rel="stylesheet" type="text/css" href="main.css">
       </head>
       <body>
              <%- body %>
       </body>
       </html> 
```

索引.ejs

```
<div id="container">
        index.html
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-02T23:38:59.323

这是您需要的模块： [https ://www.npmjs.org/package/express-ejs-layouts](https://www.npmjs.org/package/express-ejs-layouts)

请执行下列操作：

```
npm install express-ejs-layouts // install the layout module from the command line

var express = require("express")
    ,path = require('path')
    ,fs = require('fs')
    ,expressLayouts=require("express-ejs-layouts") // add this requirement
    , app = express();

app.use(express.bodyParser());
app.use(expressLayouts); // add this use()
app.use(express.static(__dirname)); 
```

现在 ejs 引擎应该使用您的布局。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-09T03:42:00.503

```
app.set('view options', { layout:'layout.ejs' }); 
```

将 layout.ejs 放入您的视图文件夹中。或者，您可以将 layout.ejs 放入 views/layouts 文件夹，然后使用

```
app.set('view options', { layout:'layouts/layout.ejs' }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-12T19:25:02.663

我有一个类似的问题。就我而言，我宁愿使用 Jade，但我需要为特定项目提供更多“html”样式的模板引擎。起初，我考虑过 express-partials 或 ejs-locals（正如 Jonathan Lonowski 的评论中所提到的），或者甚至通过 Jade 模板中的管道或点语法使用 html（有关该选项和[此](https://stackoverflow.com/questions/16094423/is-it-considered-bad-practise-to-use-html-in-jade)SO 帖子的更多信息，请参见[此处）。](https://github.com/visionmedia/jade/blob/master/jade.md#pipe-text)我无法将 express-partials 和 ejs-locals 的其他依赖项引入此项目。这两个项目看起来不错，可能会满足您的需求。

如果您不想使用这些项目，可以执行以下操作：

视图/布局-head.ejs

```
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>The title</title>
</head>
<body> 
```

视图/布局-foot.ejs

```
</body>
</html> 
```

views/index.ejs（或任何其他页面）

```
<% include layout-head %>
This is the index page - <%= title %>
<% include layout-foot %> 
```

路线/index.js

```
exports.index = function(req, res){
  res.render('index', { title: 'Express' });
} 
```

这不是最佳解决方案，但它有效。我的大部分应用程序将是一个单页应用程序，并且我还有一些其他限制我必须在其中工作，所以这可以满足我的需要。在许多情况下，这可能不是最佳解决方案 - 特别是如果您有复杂和/或不断变化的布局。

# ios - XCode & Instruments，如何清除进程列表

> ID：15036908
> 
> 赞同：1
> 
> 时间：2013-02-23T03:58:56.130
> 
> 标签：ios, objective-c, xcode, instruments

我正在调试一个 iPad 应用程序，当在 Instruments 中选择“选择目标”下拉菜单时，我得到了一个巨大的进程列表。

它实际上显示了我在启动和停止我正在调试的应用程序时运行和终止的每个进程。它们列在“附加到进程”->“系统”部分下，这是我要调试的 IOS 应用程序始终显示的位置，但它们从未被删除，因此我必须挖掘数百个条目。

我试过重启 xcode、instruments 和 IOS 模拟器......有没有办法在不重启我的 mac 的情况下清除它？我不想每次都这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T05:35:49.803

每次您在 iOS 模拟器中退出应用程序时，它都会创建所谓的“僵尸进程”。迄今为止，清除这些进程的唯一方法是重新启动您的 Mac。

此外，当您要为 Instruments 应用程序选择目标时，您要选择的进程很可能是您当前正在测试的应用程序的编号最高的进程。

这是关于 XCode 留下的僵尸进程的 stackoverflow 参考：[Xcode 在运行 iOS 测试/模拟器后留下僵尸进程](https://stackoverflow.com/questions/13209743/xcode-leaving-zombie-processes-after-running-ios-tests-simulator)

# clang - clang：如何列出支持的目标架构？

> ID：15036909
> 
> 赞同：118
> 
> 时间：2013-02-23T03:58:57.177
> 
> 标签：clang, llvm

目前我对 ARM 感兴趣，特别是 iphone/android 目标。但我只是想了解更多关于 clang 的信息，因为感觉它在未来几年会发挥重要作用。

我试过了

```
clang -cc1 --help|grep -i list
clang -cc1 --help|grep arch|grep -v search
clang -cc1 --help|grep target

 -triple <value>         Specify target triple (e.g. i686-apple-darwin9) 
```

我知道 clang 有 -triplet 参数，但是如何列出它的所有可能值？我发现 clang 在交叉编译方面与 gcc 非常不同，在 GCC 世界中，您应该对所有内容都有单独的二进制文件，例如 PLATFORM_make 或 PLATFORM_ld (i*86-pc-cygwin i*86-*-linux-gnu 等[。http ://git.savannah.gnu.org/cgit/libtool.git/tree/doc/PLATFORMS](http://git.savannah.gnu.org/cgit/libtool.git/tree/doc/PLATFORMS) )

在 clang 世界中，它只是一个二进制文件（正如我在一些论坛上看到的那样）。但是我如何获得支持的目标列表呢？如果我的目标在我的发行版（linux/windows/macos/whatever）上不受支持，我怎样才能获得支持更多平台的目标？

如果我 SVN 最新的叮当声是这样的：

```
svn co http://llvm.org/svn/llvm-project/cfe/trunk clang 
```

我会得到大部分平台吗？看起来 Clang 并没有立即考虑交叉编译，但是由于它是基于 llvm 的，所以理论上应该是非常交叉友好的？谢谢你！

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2016-01-28T12:46:05.417

据我所知，没有命令行选项可以列出给定`clang`二进制文件支持的体系结构，甚至`strings`在其上运行也无济于事。Clang 本质上只是一个 C 到 LLVM 的翻译器，而 LLVM 本身负责处理生成实际机器代码的细节，所以 Clang 没有过多关注底层架构也就不足为奇了。

正如其他人已经指出的那样，您可以询问`llc`它支持哪些架构。这并不是很有帮助，不仅因为这些 LLVM 组件可能没有安装，而且由于搜索路径和打包系统的变幻莫测，您的`llc`二进制`clang`文件可能与同一版本的 LLVM 不对应。

但是，为了争论，假设您自己编译了 LLVM 和 Clang，或者您很乐意接受您的 LLVM 二进制文件足够好：

*   `llc --version`将列出它支持的所有架构。默认情况下，它被编译为支持所有架构。您可能认为像 ARM 这样的单一架构可能有多个 LLVM 架构，例如常规 ARM、Thumb 和 AArch64。这主要是为了实现方便，因为不同的执行模式具有非常不同的指令编码和语义。
*   对于列出的每个架构，`llc -march=ARCH -mattr=help`将列出“可用的 CPU”和“可用的功能”。CPU 通常只是设置默认功能集合的便捷方式。

但现在是坏消息。在 Clang 或 LLVM 中没有可以转储的方便的三元组表，因为特定于体系结构的后端可以选择将三元组字符串解析为`llvm::Triple`对象（在[include/llvm/ADT/Triple.h](https://github.com/llvm-mirror/llvm/blob/2c4ca6832fa6b306ee6a7010bfb80a3f2596f824/include/llvm/ADT/Triple.h#L43)中定义）。换句话说，转储所有可用的三元组需要解决停机问题。例如，查看[`llvm::ARM_MC::ParseARMTriple(...)`](https://github.com/llvm-mirror/llvm/blob/2c4ca6832fa6b306ee6a7010bfb80a3f2596f824/lib/Target/ARM/MCTargetDesc/ARMMCTargetDesc.cpp#L136)解析字符串的特殊情况`"generic"`。

不过，归根结底，“三元组”主要是一种向后兼容功能，使 Clang 成为 GCC 的直接替代品，因此您通常不需要过多关注它，除非您将 Clang 或 LLVM 移植到新平台或建筑。相反，您可能会发现`llc -march=arm -mattr=help`大量不同 ARM 功能的输出和令人难以置信的结果在您的调查中更有用。

祝你的研究好运！

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2013-09-02T15:12:25.453

我正在使用 Clang 3.3，我认为获得答案的最佳方法是阅读源代码。在 llvm/ADT/Triple.h ( [http://llvm.org/doxygen/Triple_8h_source.html](http://llvm.org/doxygen/Triple_8h_source.html) ):

```
 enum ArchType {
    UnknownArch,

    arm,     // ARM: arm, armv.*, xscale
    aarch64, // AArch64: aarch64
    hexagon, // Hexagon: hexagon
    mips,    // MIPS: mips, mipsallegrex
    mipsel,  // MIPSEL: mipsel, mipsallegrexel
    mips64,  // MIPS64: mips64
    mips64el,// MIPS64EL: mips64el
    msp430,  // MSP430: msp430
    ppc,     // PPC: powerpc
    ppc64,   // PPC64: powerpc64, ppu
    r600,    // R600: AMD GPUs HD2XXX - HD6XXX
    sparc,   // Sparc: sparc
    sparcv9, // Sparcv9: Sparcv9
    systemz, // SystemZ: s390x
    tce,     // TCE (http://tce.cs.tut.fi/): tce
    thumb,   // Thumb: thumb, thumbv.*
    x86,     // X86: i[3-9]86
    x86_64,  // X86-64: amd64, x86_64
    xcore,   // XCore: xcore
    mblaze,  // MBlaze: mblaze
    nvptx,   // NVPTX: 32-bit
    nvptx64, // NVPTX: 64-bit
    le32,    // le32: generic little-endian 32-bit CPU (PNaCl / Emscripten)
    amdil,   // amdil: amd IL
    spir,    // SPIR: standard portable IR for OpenCL 32-bit version
    spir64   // SPIR: standard portable IR for OpenCL 64-bit version
  }; 
```

在 clang/lib/Driver/ToolChains.cpp 中，有关于 arm 的东西。

```
static const char *GetArmArchForMArch(StringRef Value) {
  return llvm::StringSwitch<const char*>(Value)
    .Case("armv6k", "armv6")
    .Case("armv6m", "armv6m")
    .Case("armv5tej", "armv5")
    .Case("xscale", "xscale")
    .Case("armv4t", "armv4t")
    .Case("armv7", "armv7")
    .Cases("armv7a", "armv7-a", "armv7")
    .Cases("armv7r", "armv7-r", "armv7")
    .Cases("armv7em", "armv7e-m", "armv7em")
    .Cases("armv7f", "armv7-f", "armv7f")
    .Cases("armv7k", "armv7-k", "armv7k")
    .Cases("armv7m", "armv7-m", "armv7m")
    .Cases("armv7s", "armv7-s", "armv7s")
    .Default(0);
}

static const char *GetArmArchForMCpu(StringRef Value) {
  return llvm::StringSwitch<const char *>(Value)
    .Cases("arm9e", "arm946e-s", "arm966e-s", "arm968e-s", "arm926ej-s","armv5")
    .Cases("arm10e", "arm10tdmi", "armv5")
    .Cases("arm1020t", "arm1020e", "arm1022e", "arm1026ej-s", "armv5")
    .Case("xscale", "xscale")
    .Cases("arm1136j-s", "arm1136jf-s", "arm1176jz-s", "arm1176jzf-s", "armv6")
    .Case("cortex-m0", "armv6m")
    .Cases("cortex-a8", "cortex-r4", "cortex-a9", "cortex-a15", "armv7")
    .Case("cortex-a9-mp", "armv7f")
    .Case("cortex-m3", "armv7m")
    .Case("cortex-m4", "armv7em")
    .Case("swift", "armv7s")
    .Default(0);
} 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2016-11-30T14:00:42.970

你可以做的一个提示：如果你想找到一个特定的目标三元组，是*在那个系统上*安装 llvm然后做一个

```
$ llc --version | grep Default
  Default target: x86_64-apple-darwin16.1.0 
```

或者：

```
$ llvm-config --host-target
x86_64-apple-darwin16.0.0
or
$ clang -v 2>&1 | grep Target
Target: x86_64-apple-darwin16.1.0 
```

然后你知道在交叉编译时如何定位它。

显然那里有“很多”目标，这里有一个列表，请随意添加，社区 wiki 风格：

```
arm-none-eabi
armv7a-none-eabi
arm-linux-gnueabihf 
arm-none-linux-gnueabi
i386-pc-linux-gnu 
x86_64-apple-darwin10
i686-w64-windows-gnu # same as i686-w64-mingw32
x86_64-pc-linux-gnu # from ubuntu 64 bit
x86_64-unknown-windows-cygnus # cygwin 64-bit
x86_64-w64-windows-gnu # same as x86_64-w64-mingw32
i686-pc-windows-gnu # MSVC
x86_64-pc-windows-gnu # MSVC 64-BIT 
```

无论如何，这是[文档](http://clang.llvm.org/docs/CrossCompilation.html)列表的内容（显然它是四倍[或五倍？]，而不是这些天的三倍）：

```
The triple has the general format <arch><sub>-<vendor>-<sys>-<abi>, where:
arch = x86, arm, thumb, mips, etc.
sub = for ex. on ARM: v5, v6m, v7a, v7m, etc.
vendor = pc, apple, nvidia, ibm, etc.
sys = none, linux, win32, darwin, cuda, etc.
abi = eabi, gnu, android, macho, elf, etc. 
```

您甚至可以微调指定目标 cpu，尽管它使用基于三元组的目标 cpu 的合理默认值。

有时目标“解决”到同一件事，因此要查看目标实际被视为什么：

```
 $ clang -target x86_64-w64-mingw32 -v 2>&1 | grep Target
 Target: x86_64-w64-windows-gnu 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2020-06-30T05:04:38.050

从 Clang 11（主干）开始，可以使用新添加的`-print-targets`标志轻松打印支持的目标架构列表：

```
$ clang-11 -print-targets
  Registered Targets:
    aarch64    - AArch64 (little endian)
    aarch64_32 - AArch64 (little endian ILP32)
    aarch64_be - AArch64 (big endian)
    amdgcn     - AMD GCN GPUs
    arm        - ARM
    arm64      - ARM64 (little endian)
    arm64_32   - ARM64 (little endian ILP32)
    armeb      - ARM (big endian)
    avr        - Atmel AVR Microcontroller
    bpf        - BPF (host endian)
    bpfeb      - BPF (big endian)
    bpfel      - BPF (little endian)
    hexagon    - Hexagon
    lanai      - Lanai
    mips       - MIPS (32-bit big endian)
    mips64     - MIPS (64-bit big endian)
    mips64el   - MIPS (64-bit little endian)
    mipsel     - MIPS (32-bit little endian)
    msp430     - MSP430 [experimental]
    nvptx      - NVIDIA PTX 32-bit
    nvptx64    - NVIDIA PTX 64-bit
    ppc32      - PowerPC 32
    ppc64      - PowerPC 64
    ppc64le    - PowerPC 64 LE
    r600       - AMD GPUs HD2XXX-HD6XXX
    riscv32    - 32-bit RISC-V
    riscv64    - 64-bit RISC-V
    sparc      - Sparc
    sparcel    - Sparc LE
    sparcv9    - Sparc V9
    systemz    - SystemZ
    thumb      - Thumb
    thumbeb    - Thumb (big endian)
    wasm32     - WebAssembly 32-bit
    wasm64     - WebAssembly 64-bit
    x86        - 32-bit X86: Pentium-Pro and above
    x86-64     - 64-bit X86: EM64T and AMD64
    xcore      - XCore 
```

参考：[LLVM PR](https://reviews.llvm.org/D79565)、[LLVM commit](https://reviews.llvm.org/rGcf2fb139321ca06b5200a88847fabec93ee92d80)、[Clang 11 文档](https://clang.llvm.org/docs/ClangCommandLineReference.html)。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2016-08-24T05:00:41.203

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-01-28T15:43:03.563

也试试

```
> llc -mattr=help

Available CPUs for this target:

  amdfam10      - Select the amdfam10 processor.
  athlon        - Select the athlon processor.
  athlon-4      - Select the athlon-4 processor.
  athlon-fx     - Select the athlon-fx processor.
  athlon-mp     - Select the athlon-mp processor.
  athlon-tbird  - Select the athlon-tbird processor.
  athlon-xp     - Select the athlon-xp processor.
  athlon64      - Select the athlon64 processor.
  athlon64-sse3 - Select the athlon64-sse3 processor.
  atom          - Select the atom processor.
  ...
Available features for this target:

  16bit-mode           - 16-bit mode (i8086).
  32bit-mode           - 32-bit mode (80386).
  3dnow                - Enable 3DNow! instructions.
  3dnowa               - Enable 3DNow! Athlon instructions.
  64bit                - Support 64-bit instructions.
  64bit-mode           - 64-bit mode (x86_64).
  adx                  - Support ADX instructions.
  ... 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-06-20T04:27:51.503

它不会列出所有的三元组，但是

```
llvm-as < /dev/null | llc -mcpu=help 
```

至少会列出所有的 CPU。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2020-11-18T05:58:07.963

> `clang -march=dont-know empty.c`

**错误：未知目标 CPU '不知道'**

注意：有效的目标 CPU 值为：nocona、core2、penryn、bonnell、atom、silvermont、slm、goldmont、goldmont-plus、tremont、nehalem、corei7、westmere、sandybridge、corei7-avx、ivybridge、core-avx-i、 haswell、core-avx2、broadwell、skylake、skylake-avx512、skx、cascadelake、cooperlake、cannonlake、icelake-client、icelake-server、tigerlake、knl、knm、k8、athlon64、athlon-fx、opteron、k8-sse3、 athlon64-sse3、opteron-sse3、amdfam10、巴塞罗那、btver1、btver2、bdver1、bdver2、bdver3、bdver4、znver1、znver2、x86-64

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-02-29T18:07:56.230

如果您对从源代码构建 LLVM 或 Clang 支持哪些目标感兴趣（的值），请在源代码分发的文件夹中`-DLLVM_TARGETS_TO_BUILD`查找子目录列表。`llvm/lib/Target`从 9.0.1 开始，有：

```
AArch64
AMDGPU
ARC
ARM
AVR
BPF
Hexagon
Lanai
MSP430
Mips
NVPTX
PowerPC
RISCV
Sparc
SystemZ
WebAssembly
X86 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-04-03T08:37:04.673

只有第一个（CPU架构）需要准确，其他参数都经过智能复杂的处理，可以使用“clang++ ... --verbose ...”查看处理结果，例如：

```
Command Line Input      After triple processing
x86_64                  x86_64
x86_64-foo              x86_64-foo
x86_64-windows          x86_64-unknown-windows-msvc19.28.29335
x86_64-windows-bar      x86_64-unknown-windows-msvc19.28.29335
x86_64-foo-windows-bar  x86_64-foo-windows-msvc19.28.29335
x86_64-foo-bar-foobar   x86_64-foo-bar-foobar 
```

通常除了第一个参数之外的参数只有在正确的情况下才会生效（经过三次处理可能会巧妙地使错误的正确正确），例如“windows”会影响代码：

```
/// Tests whether the OS is Windows.
bool isOSWindows() const {
    return getOS() == Triple::Win32;
} 
```

此方法被 Clang/LLVM 中的其他代码用于影响编译结果，它仅在参数为“windows”时返回 true，如果为其他任何东西，例如“foo”，则返回 false。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-10-23T05:17:39.193

对于那些最终来到这里查看他们特定的 x86 CPU 系列架构是否有 llvm/clang 优化目标的人（例如：zen3、zen1、skylake、penryn 等）

您可以查看下面的列表或运行以下命令：

```
$ llc -march=x86 -mattr=help
Available CPUs for this target:

  alderlake      - Select the alderlake processor.
  amdfam10       - Select the amdfam10 processor.
  athlon         - Select the athlon processor.
  athlon-4       - Select the athlon-4 processor.
  athlon-fx      - Select the athlon-fx processor.
  athlon-mp      - Select the athlon-mp processor.
  athlon-tbird   - Select the athlon-tbird processor.
  athlon-xp      - Select the athlon-xp processor.
  athlon64       - Select the athlon64 processor.
  athlon64-sse3  - Select the athlon64-sse3 processor.
  atom           - Select the atom processor.
  barcelona      - Select the barcelona processor.
  bdver1         - Select the bdver1 processor.
  bdver2         - Select the bdver2 processor.
  bdver3         - Select the bdver3 processor.
  bdver4         - Select the bdver4 processor.
  bonnell        - Select the bonnell processor.
  broadwell      - Select the broadwell processor.
  btver1         - Select the btver1 processor.
  btver2         - Select the btver2 processor.
  c3             - Select the c3 processor.
  c3-2           - Select the c3-2 processor.
  cannonlake     - Select the cannonlake processor.
  cascadelake    - Select the cascadelake processor.
  cooperlake     - Select the cooperlake processor.
  core-avx-i     - Select the core-avx-i processor.
  core-avx2      - Select the core-avx2 processor.
  core2          - Select the core2 processor.
  corei7         - Select the corei7 processor.
  corei7-avx     - Select the corei7-avx processor.
  generic        - Select the generic processor.
  geode          - Select the geode processor.
  goldmont       - Select the goldmont processor.
  goldmont-plus  - Select the goldmont-plus processor.
  haswell        - Select the haswell processor.
  i386           - Select the i386 processor.
  i486           - Select the i486 processor.
  i586           - Select the i586 processor.
  i686           - Select the i686 processor.
  icelake-client - Select the icelake-client processor.
  icelake-server - Select the icelake-server processor.
  ivybridge      - Select the ivybridge processor.
  k6             - Select the k6 processor.
  k6-2           - Select the k6-2 processor.
  k6-3           - Select the k6-3 processor.
  k8             - Select the k8 processor.
  k8-sse3        - Select the k8-sse3 processor.
  knl            - Select the knl processor.
  knm            - Select the knm processor.
  lakemont       - Select the lakemont processor.
  nehalem        - Select the nehalem processor.
  nocona         - Select the nocona processor.
  opteron        - Select the opteron processor.
  opteron-sse3   - Select the opteron-sse3 processor.
  penryn         - Select the penryn processor.
  pentium        - Select the pentium processor.
  pentium-m      - Select the pentium-m processor.
  pentium-mmx    - Select the pentium-mmx processor.
  pentium2       - Select the pentium2 processor.
  pentium3       - Select the pentium3 processor.
  pentium3m      - Select the pentium3m processor.
  pentium4       - Select the pentium4 processor.
  pentium4m      - Select the pentium4m processor.
  pentiumpro     - Select the pentiumpro processor.
  prescott       - Select the prescott processor.
  rocketlake     - Select the rocketlake processor.
  sandybridge    - Select the sandybridge processor.
  sapphirerapids - Select the sapphirerapids processor.
  silvermont     - Select the silvermont processor.
  skx            - Select the skx processor.
  skylake        - Select the skylake processor.
  skylake-avx512 - Select the skylake-avx512 processor.
  slm            - Select the slm processor.
  tigerlake      - Select the tigerlake processor.
  tremont        - Select the tremont processor.
  westmere       - Select the westmere processor.
  winchip-c6     - Select the winchip-c6 processor.
  winchip2       - Select the winchip2 processor.
  x86-64         - Select the x86-64 processor.
  x86-64-v2      - Select the x86-64-v2 processor.
  x86-64-v3      - Select the x86-64-v3 processor.
  x86-64-v4      - Select the x86-64-v4 processor.
  yonah          - Select the yonah processor.
  znver1         - Select the znver1 processor.
  znver2         - Select the znver2 processor.
  znver3         - Select the znver3 processor. 
```

上面的列表是截至 llvm-13 的最新列表

要运行上述程序，您至少需要安装 llvm 并获得与上述相同的结果，您至少需要 llvm-13。

# iphone - 来自 AppDelegate 的 PresentViewController

> ID：15036913
> 
> 赞同：0
> 
> 时间：2013-02-23T04:00:07.027
> 
> 标签：iphone, ios, objective-c, uinavigationcontroller, uimodalpresentationstyle

我正在尝试展示一个 ViewController，我知道可以使用以下行来完成。

```
[self presentViewController:myVC animated:YES completion:nil]; 
```

但是我有一个调用 AppDelegate 的部分，这就是我遇到麻烦的地方。

我可以设法解决它：

```
 [self.navigationController pushViewController:bvc animated:YES]; 
```

但正如代码所暗示的那样，这是一个导航推送——**我该怎么做，这样我就可以做一个垂直向上推？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T04:04:55.473

您可以在`navigation controller`-

```
[self.navigationController presentViewController:myVC animated:YES completion:nil]; 
```

# big-o - T(n) 转换为 O(n)

> ID：15036919
> 
> 赞同：2
> 
> 时间：2013-02-23T04:02:04.087
> 
> 标签：big-o, time-complexity

我对处理时间复杂度之间的区别`T(N)`以及`O(N)`处理时间复杂度时有点困惑。我有三种算法及其各自的`T(N)`方程，我必须找到最坏情况的时间复杂度`O(N)`，我不确定它与`T(N)`.

一个例子是：

```
T(n) = 150⋅N² + 3⋅N + 11⋅log₂(N) 
```

会`O()`不会只是`O(N²)`

另外，是否应该始终使用复杂度较低的算法？我感觉答案是否定的，但我不太确定为什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T04:27:20.770

> O() 是否只是 O(N²)

是的。

对于大 N，N² 项将主导运行时间，因此其他项不再重要。

例如，对于 N=10，在您的示例中，150⋅N² 已经是 15000，而 3⋅N = 30 和 11⋅log₂(N) = 36.5，因此非 N² 项仅占总数的 0.44%脚步。

对于 N=100, 150⋅N² = 1500000, 3⋅N = 300, 11⋅log₂(N) = 73.1，因此非 N² 项仅占总步数的 0.025%。

因此，对于更高的 N，低阶项的相关性会降低。

> 另外，是否应该始终使用复杂度较低的算法？

不会。因为 Big-O 表示法仅描述 N 变大时的渐近行为，并且不包括任何常数因子开销，因此您通常最好使用开销较低的次优算法。

在你的例子中，如果我有一个替代算法来解决你试图解决的问题，它的运行时间 T'(N) = 10⋅N³，那么对于 N=10，它只需要 10000 步，而你的例子需要 150067 步. 基本上，[对于任何 N ≤ 15](http://www.wolframalpha.com/input/?i=%2810%29N%5E3%20=%20%28150%29N%5E2%20%2b%20%283%29N%20%2b%20%2811%29log_2%28N%29)，T'(N) 算法会更快，而对于任何 N > 15，您的 T(N) 算法会更快。因此，如果您事先知道您不会看到任何 N > 15，那么您最好选择理论上效率较低的算法 T'(N)。

当然，在实践中还有许多其他考虑因素，例如：

*   您可以在库、网络等中重用的算法的可用性。
*   如果你自己实现它：易于实现
*   算法是否容易扩展到多核或多台机器

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T04:08:23.037

T(n) 是表示输入大小为 n 所用时间的函数。大哦符号是一种分类。就像您在示例中所说的那样，该示例的大哦将是 n^2。

关于您的第二个问题，大哦符号表示您应该使用的算法，因为输入大小接近无穷大。实际上，在某些情况下，您永远无法获得足够大的输入来进行补偿。

例如，如果 T1(n) = 999999999999*N 且 T2(n) = 2*N^2，最终 n 大到足以使 T2 大于 T1。然而，对于较小尺寸的 n，T1 较大。您可以绘制函数图，甚至求解方程组以找出 n 的大小会产生影响。

注意：还请记住，big-oh 是复杂性的*界限*，这意味着您可以有一个仍然正确的松散界限。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T04:13:31.667

T(n) 只是一个函数。O 或 big oh 是复杂程度。

就此而言，T(n) 可以是 f(n) 或 g(n)。

我希望这很清楚。

Big Oh 是衡量算法时间或空间复杂度的指标。

您不考虑复杂度的低阶，因为对于非常大的 n 值，高阶复杂度是 >> 低阶复杂度。

# dart-editor - 如何在编辑器中运行代码清理

> ID：15036920
> 
> 赞同：0
> 
> 时间：2013-02-23T04:02:05.040
> 
> 标签：dart-editor

我的 Web 应用在 M2 和 M3 之间中断，如何在 Dart 编辑器中运行代码清理？我似乎无法在任何地方找到菜单选项。我也不能通过其他一些操作（例如，运行分析器）调用它。我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T04:47:02.417

想通了：右键单击文件，然后选择“清理源”

# javascript - div淡入时更改背景颜色

> ID：15036924
> 
> 赞同：0
> 
> 时间：2013-02-23T04:02:40.693
> 
> 标签：javascript, jquery, css

我正在尝试在淡入`background-color`时进行更改`div`，但以下代码不起作用。

相反，`fadeOut`当我试图这样`click`做时，它只是没有显示`fadeIn.`

```
$('#divbutton').toggle(function(){
        $('#divbutton').text('Show');
        $('#message').fadeOut('1000');

   } , 
   function(){
       $('#divbutton').text('Hide');
       $('#message').$this.css('background-color', 'red').fadeIn('1000');

   }
); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T04:47:04.900

您对以下行的语法不正确。改变：

$('#message').$this.css('background-color', 'red').fadeIn('1000');

到：

$('#message').css('background-color', 'red').fadeIn('1000');

# django - django-shop vs Satchless？

> ID：15036926
> 
> 赞同：8
> 
> 时间：2013-02-23T04:02:50.593
> 
> 标签：django, paypal, e-commerce, shopping-cart

谁能比较这两个电子商务框架？

我找到[了这个链接](http://www.readncode.com/blog/the-state-of-ecommerce-in-django/)，但我不确定它可能有多过时。它提到Satchless仍处于早期阶段。至少根据去年的[这篇文章，django-shop 还没有准备好生产。](https://stackoverflow.com/questions/6238961/is-django-shop-ready-for-production)现在生产准备好了吗？

我需要的其实很简单。我只需要一个 B2C 网站（即只有我向客户销售产品）。所需的功能包括匿名结帐、运费+可计算税款、友好的产品退货界面、贝宝支持。该代码希望易于阅读和自定义（因此我将避免使用 Satchmo）

对于 Satchless：它是基于 Satchmo 还是重写？

对于 django-shop：我注意到 django-shop 有一个巨大的[生态系统](https://www.django-shop.org/en/ecosystem/)。这意味着 django-shop 是高度可定制的，但这也可能意味着代码设计和实现质量不一致。看起来即使是贝宝结账也需要第三方扩展？

再次感谢，感谢您的所有意见。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-24T02:05:26.193

Satchless 不是对 Satchmo 的重写，它的名称只是对 Satchmo 代码库质量差的一种反应。它的设计非常小，但可扩展。它在过去几年中发生了相当大的变化，因此可能不是一个特别稳定的平台选择（即，API 很可能会继续发生重大变化）。

还有 Oscar，它更有主见且功能丰富，但仍设计为可扩展：[https ://github.com/tangentlabs/django-oscar](https://github.com/tangentlabs/django-oscar)

免责声明：我曾与 Satchless 的家伙（不是 Satchless 本身）和 Oscar 直接合作过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T05:17:37.197

您的要求听起来像[Mezzanine](http://mezzanine.jupo.org/) + [Cartridge](http://cartridge.jupo.org/)对您来说是一个更好的解决方案。

# mysql - 布尔模式下的mysql全文索引搜索与基于相似的搜索联合

> ID：15036929
> 
> 赞同：1
> 
> 时间：2013-02-23T04:03:17.613
> 
> 标签：mysql, full-text-search

在搜索我的数据库时，我希望真正相关的结果（由我的布尔搜索返回的结果）排名，但同时我不希望完全省略一些不太相关（喜欢）的结果。

目前我的查询看起来像这样。

```
(SELECT *, MATCH (col1,col2,col3,col4) AGAINST (query* in boolean mode) AS score
FROM table where match(col1,col2,col3,col4) against (query* in boolean mode)
order by score DESC) 
   UNION (SELECT * from table where col1 like query 
          or col2 like query or col2 like query or col4 like query) 
```

这将返回一个错误，指出给定的两个 select 子句具有不同数量的列。我理解这是因为在查询的第一部分中将“分数”作为列添加。
这个问题有解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T11:05:36.637

只需使用列别名将假列分数添加到第二个查询中即可。您不需要使用该值，但会使联合工作。例如：

```
(SELECT *, MATCH (col1,col2,col3,col4) AGAINST (query* in boolean mode) AS score
FROM table where match(col1,col2,col3,col4) against (query* in boolean mode)
order by score DESC) 
UNION (SELECT *, 50 as score from table where col1 like query 
or col2 like query or col2 like query or col4 like query) 
```

您可以将 50 替换为您希望分配的任何默认分数。

# linux - 一个接一个地调用两个函数在 bash/sqlplus 中失败

> ID：15036930
> 
> 赞同：1
> 
> 时间：2013-02-23T04:03:35.273
> 
> 标签：linux, oracle, bash, sqlplus

我有两个功能-ABC，XYZ。ABC 删除 table1 中的一些行作为 user1，XYZ 删除一些用户作为 DB 用户。首先我打电话给ABC，然后是XYZ。ABC 函数正在执行，但在 XYZ 处失败 - “XYZ：找不到命令”

```
function ABC
{
        sqlplus -s $ur1/$pwd@$SID << EOF

        delete from table1 where row_name = 'A1';
        delete from table2 where row_name = 'A2';
        exit

        EOF
}

function XYZ
{
 sqlplus eip_dba/eip_dba$result@${input} << eof
 set timing off
 set serveroutput on size 10000
 set feedback off
 spool xyz_$input.out

 drop user usr1 cascade;
 drop user usr2 cascade;
 drop user usr3 cascade;
 commit;
 exit
 eof
}

ABC
XYZ

bash-3.2$ ./db_test.sh 

2 rows deleted.

2 rows deleted.

./db_test.sh: line 100: XYZ: command not found 
```

请让我知道出了什么问题。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T04:22:02.690

尝试在 EOF 之前删除空格

```
function ABC
{
        sqlplus -s $ur1/$pwd@$SID << EOF

        delete from table1 where row_name = 'A1';
        delete from table2 where row_name = 'A2';
        exit

EOF
} 
```

我在一个示例程序中尝试了这个，它解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T07:39:33.883

这里文档的格式是：

```
 <<WORD
here-document content ...
    here-document content ...
  here-document content ...
WORD 
```

`WORD`可以是你喜欢的任何标签，但结束标记必须是行上唯一的东西，前后不能有空格。

在您使用`eof`和`EOF`作为标签的示例函数中，您应该从它们前面删除空格字符，以便它们真正位于行首，如下所示：

```
function ABC
{
        sqlplus -s $ur1/$pwd@$SID << EOF

        delete from table1 where row_name = 'A1';
        delete from table2 where row_name = 'A2';
        exit

EOF
}

function XYZ
{
 sqlplus eip_dba/eip_dba$result@${input} << eof
 set timing off
 # ... and so on ....

eof
} 
```

也就是说，结尾`EOF`和`eof`就在行的开头，也没有尾随空格。

# jquery - 带有 ERB 错误的 CoffeeScript

> ID：15036934
> 
> 赞同：0
> 
> 时间：2013-02-23T04:04:00.343
> 
> 标签：jquery, ruby-on-rails, coffeescript, erb

我正在尝试在手风琴中预先打开一个 div。我`@expanded_section`在相应的控制器中设置一个实例变量。我正在尝试在 jQuery-UI 手风琴的参数中使用该值，就像在文件夹`active`中的咖啡脚本文件上使用 erb`assets/javascripts`

```
$( ".sections" ).accordion({
  active: <%=@expanded_section%>,
  header: "h4",
  collapsible: true,
  heightStyle: "content"  }).sortable({
  axis: "y",
  handle: "h4",
  update: ->
    $.post($(this).data('update'), $(this).sortable('serialize'))
  }) 
```

但我收到以下错误：

```
Error: Parse error on line 60: Unexpected ',' 
```

（在/home/steve/dev/rails/Sur​​vey/app/assets/javascripts/surveyys.js.coffee.erb）

`line 60`是`active: <%=@expanded_section%>,`

如果我`to_i`调用`@expanded_section`它会呈现`active:0`.

但是当我`@expanded_section`从控制器将值打印到控制台时，它会打印正确的预期值。

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T04:30:35.993

在您的控制器运行*之前*`assets/`，将处理下面的所有内容。这意味着它不会来自您的控制器，它将来自编译资产时的任何内容，因此它与所有实例变量一样，将在首次访问时创建并且将是. 结果是 CoffeeScript 会看到：*`@expanded_section``self``nil`*

 *```
$( ".sections" ).accordion({
  active: , 
```

这是一个语法错误。

您可以做的一件简单的事情是在视图的 HTML 中设置一个全局 JavaScript 变量：

```
<script type="text/javascript">
  window.expanded_section = <%= @expanded_section %>;
</script> 
```

然后您的资产脚本可以查看`window`：

```
$( ".sections" ).accordion({
  active: window.expanded_section, 
```

您可能希望将其隐藏在自定义命名空间中以避免与现有`window`属性发生冲突，但整体结构将是相同的。如果它是每个页面的`window.expanded_section = ...`一部分，那么它甚至可能会出现在您的布局中。*

# javascript - 获取 IFrame 子项的高度时出错

> ID：15036935
> 
> 赞同：3
> 
> 时间：2013-02-23T04:04:06.363
> 
> 标签：javascript, jquery, wordpress, iframe

我在获取从 iframe 调用的页面高度时遇到了非常奇怪的错误。我浏览了谷歌，还检查了与此“拒绝访问属性文档的权限”相关的其他 Stackoverflow 帖子，但尚未找到任何解决方案。我有一个指向另一台服务器的网站。我在 iframe 上收到此错误。让我提供代码

jQuery

```
$(document).ready(function()
    {
        // Set specific variable to represent all iframe tags.
        var iFrames = document.getElementsByTagName('iframe');

        // Resize heights.
        function iResize()
        {
            // Iterate through all iframes in the page.
            for (var i = 0, j = iFrames.length; i < j; i++)
            {
                // Set inline style to equal the body height of the iframed content.
                iFrames[i].style.height = iFrames[i].contentWindow.document.body.offsetHeight + 'px';
            }
        }

        // Check if browser is Safari or Opera.
        if ($.browser.safari || $.browser.opera)
        {
            // Start timer when loaded.
            $('iframe').load(function()
                {
                    setTimeout(iResize, 0);
                }
            );

            // Safari and Opera need a kick-start.
            for (var i = 0, j = iFrames.length; i < j; i++)
            {
                var iSource = iFrames[i].src;
                iFrames[i].src = '';
                iFrames[i].src = iSource;
            }
        }
        else
        {
            // For other good browsers.
            $('iframe').load(function()
                {
                    // Set inline style to equal the body height of the iframed content.
                    this.style.height = this.contentWindow.document.body.offsetHeight + 'px';
                }
            );
        }
    }
); 
```

和 IFrame

```
<iframe style="margin-bottom: 16px;" src="ourteamnav/first.php" frameborder="0" scrolling="no" width="597" height="240"></iframe> 
```

我收到“访问属性文档的权限被拒绝”错误，因此高度不是根据其中的文档高度来的。然后我尝试了以下代码

```
function resizeIframe(ifRef) 
        {
            var ifDoc;
            //alert(ifRef);

            try
            { 
                ifDoc = ifRef.contentWindow.document.documentElement; 
            }
            catch( e )
            {
                try
                { 
                ifDoc = ifRef.contentDocument.documentElement; 
                }
                catch( ee ){} 
            }
            var doc = ifRef.height;
            //alert(doc);
            if(ifDoc)
            {
                ifRef.height = 1; 
                ifRef.style.height = ifDoc.scrollHeight+'px';               
            }
        } 
```

和 iframe

```
<iframe onload="resizeIframe(this)" style="margin-bottom: 16px;" src="ourteamnav/first.php" frameborder="0" scrolling="no" width="597" height="240"></iframe`> 
```

在这种情况下，我在 javascript 上没有发现错误，但它不起作用。但是奇怪的是，他们俩都在我的本地服务器上工作，并且当现在存在代码的服务器没有指向另一个服务器时也在工作。（跨站点脚本）。

请帮我解决这个问题。

我使用的参考资料

[错误：访问属性“文档”的权限被拒绝](https://stackoverflow.com/questions/7995223/error-permission-denied-to-access-property-document)

[错误 document.form 在 javascript 中未定义](https://stackoverflow.com/questions/8892631/error-document-form-is-undefined-in-javascript)

[http://davidwalsh.name/iframe-permission-denied](http://davidwalsh.name/iframe-permission-denied)

[https://sqa.stackexchange.com/questions/1453/how-to-fix-permission-denied-to-access-property-document](https://sqa.stackexchange.com/questions/1453/how-to-fix-permission-denied-to-access-property-document)

[http://sahi.co.in/forums/discussion/2898/error-permission-denied-to-access-property-document-with-ckeditor/p1](http://sahi.co.in/forums/discussion/2898/error-permission-denied-to-access-property-document-with-ckeditor/p1)

[http://www.codingforums.com/showthread.php?t=236484](http://www.codingforums.com/showthread.php?t=236484)

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-02-23T05:30:13.007

这称为 XSS 异常。错误：错误：访问属性“文档”的权限被拒绝

不幸的是，您想要做的——在与父域不同的站点上操作 iframe 的内容或窗口——是不允许的。时期。

# coq - Coq 中的新作用域

> ID：15036938
> 
> 赞同：1
> 
> 时间：2013-02-23T04:04:18.970
> 
> 标签：coq

我想要我自己的范围，来玩弄长的分布。

```
Declare Scope my_scope.
Delimit Scope my_scope with my.
Open Scope my_scope.

Definition f (x y a b : nat) : nat := x+y+a+b.
Notation "x < y * a = b" := (f x y a b)
 (at level 100, no associativity) : my_scope.

Check (1 < 2 * 3 = 4)%my. 
```

你如何制作一个新的范围？

编辑：我选择“x < y * a = b”来覆盖 Coq 的运算符（每个运算符都有不同的优先级）。  

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T23:08:00.130

该命令`Declare Scope`不存在。[Coq 手册的第 12.2 节](https://coq.inria.fr/distrib/current/refman/Reference-Manual014.html#scopes)描述了有关范围的各种命令。

您对示例符号的选择存在固有问题，因为它与预定义的符号冲突，这些符号似乎在您的符号之前使用。

在查看第一个组件时，解析器看到`_ < _` 并认为您实际上是在谈论整数的比较，然后它将第二部分视为符号的实例`_ * _`，然后它看到所有这一切都是等式的左侧。解析器一直很高兴，它构造了一个形式的表达式：

```
(1 < (2 * 3)) = 4 
```

这是由解析器构造的，尚未请求类型系统。类型检查器将自然数视为第一个孩子`(_ < _)`并且很高兴。它认为`(_ * _)`是第二个孩子，它很高兴，它现在知道该产品的第一个孩子应该是一个 nat 数字，它仍然很高兴；最后它有一个等式，这个等式的第一个组成部分在 type 中`Prop`，但第二个组成部分在 type 中`nat`。

如果您键入`Locate "_ < _ * _ = _".`答案，则会告诉您您确实定义了一个新符号。问题是这个符号永远不会被使用，因为解析器总是找到另一个它以前可以使用的符号。理解为什么一个符号比另一个符号更受欢迎需要更多的解析技术知识，正如 Coq 手册第 12 章的句子中提到的那样（对我来说晦涩难懂）：

*Coq 可扩展解析由本质上是 LL1 解析器的 Camlp5 执行*。

您必须选择各种变量的水平，`x`, `y`, `a`, 等，`b`这样这些变量中的任何一个都不能匹配太多的文本。例如，我尝试定义一个接近你的符号，但有一个开始和一个结束括号（我想这大大简化了任务）。

```
Notation "<< x < y * a = b >>" := (f x y a b)
 (x at level 59, y at level 39, a at level 59) : my_scope. 
```

的水平`x`选择低于 的`=`水平， y 的水平选择低于 的水平`*`， 的水平`a`选择低于的水平`=`。通过阅读命令的答案获得级别`Print Grammar constr.` 它似乎工作，因为以下命令被接受。

```
Check << 1 < 2 * 3 = 4 >>. 
```

但是您可能需要包含更多的工程才能获得真正好的符号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-06T15:13:19.037

要回答标题中的实际问题：

当您声明使用它的符号时，就会创建新范围。也就是说，您不会`my_scope`单独声明新范围。你只写

```
Notation "x <<< y" := (f x y) (at level 100, no associativity) : my_scope. 
```

并声明了一个新的范围`my_scope`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-03T19:22:51.500

这个问题的答案只适用于旧版本的 Coq。我不确定它是什么时候开始的，但至少在 Coq 8.13.2 中，Coq 更喜欢用户首先使用`Declare Scope`创建一个新范围。OP 在他们的代码中拥有的是 Coq 现在声明范围的首选方式。

参见[当前手册](https://coq.inria.fr/distrib/current/refman/user-extensions/syntax-extensions.html#coq:cmd.Open-Scope)

# c# - 托管 C dll 调用 C# dll、FileNotFoundException

> ID：15036940
> 
> 赞同：0
> 
> 时间：2013-02-23T04:04:44.303
> 
> 标签：c#, c++, dll, unmanaged, managed

我有一个应用程序环境，它本质上是一个插件，其中：

主机应用程序调用非托管 c++ dll，后者调用托管 C++ dll，后者调用 C# dll

这是一种众所周知的方法，通过使用托管 C++ 的桥从非托管 C++ 调用 C#。在大多数情况下，这一切都很好，除了在我的 dll（非托管 C++、托管 C++ 和 C#）与调用 dll 的应用程序不在同一目录中的插件类型体系结构中。当应用程序调用非托管 C++ 时，一切都很好，因为应用程序知道要调用的目录以加载该 dll。但是，非托管 C++ 第一次调用托管 C++ 时，我们会收到 FileNotFoundException。事实证明，它没有找到 C# dll（注意所有三个 dll 都在同一个目录中，只是不在 app 目录中）。如果我将所有的 dll 放到 exe 的运行时目录中，那么一切正常，我们不会得到 FileNotFoundException。

所以，问题是当托管 C++ dll 加载时，如何在非托管 C++ 代码中以编程方式设置 C# dll 的加载目录？我已经尝试过 SetDllDirectory 并将系统上的路径变量设置为我的 dll 所在目录没有成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T05:03:53.517

默认情况下，CLR 仅在两个位置查找程序集：首先是 GAC，其次是启动 EXE 的目录。让它在别处寻找需要额外的工作。一种可能性是，在这种情况下，您不能为 AppDomain.AssemblyResolve 订阅事件处理程序。这会留下一个带有`<probing>`or`<codebase>`元素的 app.exe.config 文件。您必须为其指定与非托管 EXE 相同的名称，并将其存储在与 EXE 相同的文件夹中。

如果 EXE 不是您的，并且不能完全解决将内容排除在 EXE 目录之外的目标，这往往是不明智的。GAC 是一种简单的解决方法。

# .net - 使用 SpeechSynthesis 将文本转换为语音时，对 .NET 4.5 中 WebAPI 中的 HTTP Get 请求没有响应

> ID：15036942
> 
> 赞同：2
> 
> 时间：2013-02-23T04:04:54.187
> 
> 标签：.net, asp.net-web-api, text-to-speech, speechsynthesizer

我正在尝试使用 WebAPI 设置一个简单的 Web 服务。这是我的代码：

```
public class SpeakController : ApiController
    {
        //
        // api/speak

        public HttpResponseMessage Get(String textToConvert, String outputFile, string gender, string age = "Adult")
        {
            VoiceGender voiceGender = (VoiceGender)Enum.Parse(typeof(VoiceGender), gender);
            VoiceAge voiceAge = (VoiceAge)Enum.Parse(typeof(VoiceAge), age);

            using (SpeechSynthesizer synthesizer = new SpeechSynthesizer())
            {
                synthesizer.SelectVoiceByHints(voiceGender, voiceAge);
                synthesizer.SetOutputToWaveFile(outputFile, new SpeechAudioFormatInfo(8000, AudioBitsPerSample.Sixteen, AudioChannel.Mono));
                synthesizer.Speak(textToConvert);
            }

            return Request.CreateResponse(HttpStatusCode.OK, new Response { HttpStatusCode = (int)HttpStatusCode.OK, Message = "Payload Accepted." });
        }
    } 
```

代码相当简单，而且还没有准备好生产。但是在我的测试中，我注意到对控制器的任何请求都会发生以下情况：

*   WAV 文件生成成功
*   在调试期间，我可以看到控件点击返回并退出该方法
*   但是，我的浏览器一直在旋转，我从来没有从服务器得到响应

我对 Postman（Chrome 的 REST 客户端）进行了同样的尝试，得到了相同的结果。虽然我确实希望这是一个阻塞调用，但为了尝试其他我修改过的东西`synthesizer.Speak`并`synthesizer.SpeakAsync`遇到同样的问题。

但是，当我如下所示分别测试代码片段时，代码按预期工作。

**测试带有语音部分的 WebAPI 调用已注释掉：**

```
public class SpeakController : ApiController
{
    //
    // api/speak

    public HttpResponseMessage Get(String textToConvert, String outputFile, string gender, string age = "Adult")
    {
        VoiceGender voiceGender = (VoiceGender)Enum.Parse(typeof(VoiceGender), gender);
        VoiceAge voiceAge = (VoiceAge)Enum.Parse(typeof(VoiceAge), age);

        //using (SpeechSynthesizer synthesizer = new SpeechSynthesizer())
        //{
        //  synthesizer.SelectVoiceByHints(voiceGender, voiceAge);
        //  synthesizer.SetOutputToWaveFile(outputFile, new SpeechAudioFormatInfo(8000, AudioBitsPerSample.Sixteen, AudioChannel.Mono));
        //  synthesizer.Speak(textToConvert);
        //}

        return Request.CreateResponse(HttpStatusCode.OK, new Response { HttpStatusCode = (int)HttpStatusCode.OK, Message = "Payload Accepted." });
    }
} 
```

**在控制台应用程序中单独测试语音：**

```
static string usageInfo = "Invalid or no input arguments!"
    + "\n\nUsage: initiatives \"text to speak\" c:\\path\\to\\generate.wav gender"
    + "\nGender:\n\tMale or \n\tFemale"
    + "\n";

static void Main(string[] args)
{
    if (args.Length != 3)
    {
        Console.WriteLine(usageInfo);
    }
    else
    {
        ConvertStringToSpeechWav(args[0], args[1], (VoiceGender)Enum.Parse(typeof(VoiceGender), args[2]));
    }

    Console.WriteLine("Press any key to continue...");
    Console.ReadLine();
}

static void ConvertStringToSpeechWav(String textToConvert, String pathToCreateWavFile, VoiceGender gender, VoiceAge age = VoiceAge.Adult)
{
    using (SpeechSynthesizer synthesizer = new SpeechSynthesizer())
    {
        synthesizer.SelectVoiceByHints(gender, age);
        synthesizer.SetOutputToWaveFile(pathToCreateWavFile, new SpeechAudioFormatInfo(8000, AudioBitsPerSample.Sixteen, AudioChannel.Mono));
        synthesizer.Speak(textToConvert);
    }
} 
```

WebAPI 和 SpeechSynthesis 似乎不能很好地配合使用。任何帮助弄清楚这一点将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-18T23:19:19.680

我不知道为什么会发生这种情况，但是在单独的线程中运行 SpeechSynthesizer 似乎可以解决问题（不兼容的线程模型？）。这是我过去的做法。

基于：[ASP.NET MVC 中的超快速文本转语音 (WAV -> MP3)](https://stackoverflow.com/questions/12343249/ultra-fast-text-to-speech-wav-mp3-in-asp-net-mvc)

```
public dynamic Post(dynamic req)
{
    try 
    {
        string phrase = req["phrase"].Value;

        var stream = new MemoryStream();
        var t = new System.Threading.Thread(() =>
            {
                using (var synth = new SpeechSynthesizer())
                {
                    synth.SetOutputToWaveStream(stream);
                    synth.Speak(phrase);
                    synth.SetOutputToNull();
                }
            });

        t.Start();
        t.Join();

        stream.Position = 0;

        var resp = new HttpResponseMessage(HttpStatusCode.OK);
        resp.Content = new StreamContent(stream);

        resp.Content.Headers.ContentType = new MediaTypeHeaderValue("application/octet-stream");
        resp.Content.Headers.ContentDisposition = new System.Net.Http.Headers.ContentDispositionHeaderValue("attachment");
        resp.Content.Headers.ContentDisposition.FileName = "phrase.wav";

        return resp;
    }
    catch
    {
        return new HttpResponseMessage(HttpStatusCode.InternalServerError);
    }
} 
```

# android - 安装 FB 应用后，Android Facebook 示例应用无法登录

> ID：15036956
> 
> 赞同：7
> 
> 时间：2013-02-23T04:08:26.803
> 
> 标签：android, facebook, login

起初我以为这是我的应用程序，但在使用任何 FB 示例应用程序时都会遇到完全相同的问题。

以 HelloFacebookSample 为例，它为您提供了一个登录按钮，登录后会显示您的照片并允许您发布状态更新。

如果我的手机上没有安装 FB 应用程序，登录按钮会给我一个 Web 视图，我通过它登录，照片出现在应用程序中，我可以发帖。但是，如果我的手机上安装了 FB 应用程序，它会弹出一个对话框，说明该应用程序想要访问您的公共个人资料等。我按 OK，然后.....什么也没有。

我发现了许多看起来相似的问题，但问题通常是使用调试密钥而不是发布密钥，但我是从 Eclipse 运行的，所以调试密钥仍然合适。

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-23T06:22:38.553

如果您的手机中安装了默认的 Facebook 应用程序，或者您尝试在 Google Play 上上传您的应用程序，那么您需要一个不同的 KeyHash。因为，当您开发您的 FB 应用程序时，您已经使用默认 debug.keystore 创建的密钥哈希注册了您的 FB 应用程序。

所以，现在你需要一个不同的 KeyStore 来生成不同的 KeyHash。你需要一个签名的密钥库，你可以在[本教程](https://www.youtube.com/watch?v=IYhJp-jqJyM)的帮助下获得，在生成新的密钥库后，生成一个密钥哈希并使用这个新的密钥哈希注册你的 FB 应用程序。这应该有效。要生成新的 KeyHash，您可以点击[此链接](https://stackoverflow.com/questions/5306009/facebook-android-generate-key-hash/12405323#12405323)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-04T15:39:31.597

在上述情况下，我找到了对我有帮助的下一行：

```
mLoginFacebook.setReadPermissions(Arrays.asList("email")); 
```

它紧随其后：

```
mLoginFacebook = (LoginButton) rootView.findViewById(R.id.authButton);
mLoginFacebook.setFragment(this); 
```

解决了我所有的问题..干杯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T05:28:15.053

我会尝试按照本教程进行操作，看看您是否可以获得一个您自己构建的示例应用程序以与 Facebook 连接。我在将示例应用程序与 Facebook 连接时也遇到了问题。我还会检查您来自 Facebook 的应用程序 ID 是否在您的清单文件中。

[https://developers.facebook.com/docs/howtos/androidsdk/3.0/login-with-facebook/](https://developers.facebook.com/docs/howtos/androidsdk/3.0/login-with-facebook/)

# php - 如何将 Flickr API 返回的图像放入不同的页面？

> ID：15036958
> 
> 赞同：1
> 
> 时间：2013-02-23T04:08:32.340
> 
> 标签：php, javascript, api, flickr

我正在尝试创建一个网页来显示 Flickr API 返回的一些图像。但是返回了数千张图片，所以我不能将它们放在同一个网页上，因为人们需要一直滚动。所以我想像我们通常有的那样把它们放到单独的页面中，例如，“第 1 页 2 3 下一页”。但我不知道如何实现这一点。我的想法是使用 javascript 来告诉用户选择哪个页面，然后将此数字发送到 API 请求。但是，API 是由 php 处理的，我不知道如何将值从 JS 发送到 PHP，所以我还没有解决这个问题。任何人都可以给出任何想法！谢谢！

四月

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T21:16:59.463

这是这个问题的最终解决方案：Flickr API 调用的 php 代码：

```
$page = 1;
$tag1 = "puppy"; 
$tag2 = "cute";
$flickrUrl = "http://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=blablablabla&tag_mode=all&tags=$tag1\',\'$tag2&per_page=20&page=$page"; 
```

解决方案不是将 $page 分配给特定数字，而是使用以下语句：

```
$page = isset($_GET['page']) ? $_GET['page'] : 1; 
```

通过这样做，php 文件将直接通过 Flickr API 获取页面。

然后我使用了一些 DOM 元素，例如

作为“下一页”和“上一页”的链接，帮助您浏览不同的页面。

```
echo "<p id=\"nav_bar\">";
$back_page = $page - 1; 
$next_page = $page + 1; 

echo "<a href='?page=1'>First Page</a>";
if($page > 1) { 
     echo "<a href='?page=$back_page'>&laquo; <strong>Prev</strong></a>"; 
} 
// if current page is not last page
if($page != $page_count) { 
     echo "<a href='?page=$next_page'><strong>Next</strong> &raquo;</a>";
} 
$last_page = $page_count;
echo "<a href='?page=$last_page'>Last Page</a>";
echo "</p>"; 
```

最后，感谢所有帮助过的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T01:03:32.550

我不熟悉 flickr api，所以我不确切知道您希望如何对内容进行分页，但只需查看您发布的内容，您就可以使用 ajax 来请求 API 调用。因此，在您的 h4 中执行以下操作：

```
<h4 id=\"num_imgs\">
    Page <span data-page="1">1</span> | 
         <span data-page="2">2</span> | 
         <span data-page="3">3</span> | 
         <span data-page="4">4</span> | 
         <span data-page="5">5</span>
</h4> 
```

然后做一个 jqueryish 调用，如：

```
$('h4 span').click(function(){
    getImages($(this).data('page'));
} 
```

然后有一个 javascript 图像处理函数来获取图像并处理它们/将它们显示给用户。

```
getImages(page){
    var flickrUrl = "http://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=blablablabla&tag_mode=all&tags=$tag1\',\'$tag2&per_page=20&page="+page;
    $.get(flickrUrl,function(data){
        //PROCESS IMAGES
    });
} 
```

我希望这种设置是有意义的。这似乎是你想要做的。您可以使您的页面动态化并且仍然传递标签。那么你真的不需要 PHP 来设置你的页面，但是根据你的用户选择标签的方式，你仍然可以通过 PHP 来做。我可能会通过javascript做while事情。

# c - C：将一个表达式留空时，三元运算符给出错误

> ID：15036964
> 
> 赞同：-2
> 
> 时间：2013-02-23T04:09:40.013
> 
> 标签：c

我正在尝试使用一些利用三元语句的代码来运行特定部分，但是，当我这样做时，我收到警告：

```
expression result unused 
```

并且该特定部分中的代码不会运行。

这种情况下的代码是：

```
i != a ?: printf("|%*s\\\n", i, ""); 
```

为什么会这样？根据[这里](https://stackoverflow.com/questions/3319075/ternary-conditional-operator-behaviour-when-leaving-one-expression-empty)，这种形式的三元运算符，其中没有替代的情况，应该起作用，但是，它在这里简单地跳过它。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T04:12:29.673

您的代码相当于

```
(i != a) ? (i != a) : printf(...); 
```

请注意，您最终不会使用`i != a`结果，因此会发出警告。最好把它写成一个`if`声明：

```
if(i==a) printf(...); 
```

# javascript - Javascript：在 onkeyup 事件中更改值时不会触发 onchange 事件

> ID：15036965
> 
> 赞同：7
> 
> 时间：2013-02-23T04:09:51.040
> 
> 标签：javascript, onchange, onkeyup

我有这个简单的代码：

```
 <body>
        <input type="text" onkeyup="this.value = (new Date()).getSeconds()" onchange="alert(1)" /> 
    </body> 
```

我不知道为什么当我按下键时文本框的值发生了变化，但是 onchange 事件没有触发。我怎样才能触发 onchange 事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T04:14:59.853

当`onchange`您离开焦点时将触发（如果您执行了任何更改）。这种行为只发生在输入类型中`text`，`textarea`因为 javascript 不知道您何时完成输入。

我不知道为什么代码中有一个复选框，但无论如何。真诚地，我无法告诉你为什么，但问题是输入的动态值变化（猜测是用户没有执行更改，但我真的不知道），如果您删除 onkeyup 中的代码它将起作用。不管怎样，如果你想要在输入失去焦点时执行一些代码，你可以使用`onblur`，在这种情况下更准确。

# android - 关闭应用程序时共享偏好值丢失

> ID：15036967
> 
> 赞同：1
> 
> 时间：2013-02-23T04:09:58.023
> 
> 标签：android, android-intent, android-activity, android-notifications

我有一个很少有 TextViews 的活动。

我在异步函数中创建了一个服务，该服务作为警报在后台运行并将数据加载到共享首选项对象中。我将这些值加载到异步的那些 TextView 中。

我在 onStart() 中也有相同的函数，它复制保存在 TextView 中的 pref 值。

当我关闭应用程序（通过在 ICS 中将它们滑出）然后尝试再次打开它们时，TextView 中没有加载首选项值。

为什么更新方法在 onStart 中不起作用？这是 onStart 中的代码：

```
if(AsyncTaskTestActivity.session != null)
    {
    Log.e("SessionManagement", "onStart");
    updatePref();
    }
else{Log.e("SessionManagement", "falseonStart");} 
```

session 是一个静态变量。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T04:28:37.643

`onCreate()`而是加载首选项值`onResume()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T04:23:01.713

您可以通过设置标志来更改通知中的 PendingIntent 以重用 Activity 的先前实例。

就像是：

```
Intent intent = new Intent(context, MainActivity.class);
intent.setFlags(Intent.FLAG_CLEAR_TOP);
PendingIntent pending = PendingIntent.getActivity(context, 0, intent, PendingIntent.FLAG_UPDATE_CURRENT 
```

您还可以更改活动，以便在 onResume() 中加载 SharedPreferences，此方法在活动创建和恢复期间运行。

编辑：根据您关于丢失数据的评论，我为您提供以下附加代码。我在 AsyncTask 中使用此代码，并且在持久性方面没有任何问题。

```
public final class PreferenceUtils
{
    private static final String TAG                       = PreferenceUtils.class.getSimpleName();

    public static final String  SESSION_ID                = "sessionId";                          //$NON-NLS-1$
    public static final String  NAME                      = "name";                               //$NON-NLS-1$

    private PreferenceUtils()
    {
        // enforcing singleton
        super();
    }

    /**
     * Set sessionId in app preferences to the supplied value.
     * 
     * @param context
     * @param sessionId
     */
    public static void setSessionId(final Context context, final String sessionId)
    {
        final SharedPreferences settings = PreferenceManager.getDefaultSharedPreferences(context);
        final Editor editor = settings.edit();
        editor.putString(PreferenceUtils.SESSION_ID, sessionId);
        editor.commit();

        if (BuildConfig.DEBUG)
        {
            Log.d(PreferenceUtils.TAG, "Setting sessionId: " + sessionId); //$NON-NLS-1$
        }
    }

    /**
     * Get the current session id
     * 
     * @param context
     * @return session id or null on not activated
     */
    public static String getSessionId(final Context context)
    {
        final SharedPreferences settings = PreferenceManager.getDefaultSharedPreferences(context);
        return settings.getString(PreferenceUtils.SESSION_ID, null);
    }

    /**
     * Get current name stored in the app preferences
     * 
     * @param context
     * @return
     */
    public static String getName(final Context context)
    {
        final SharedPreferences settings = PreferenceManager.getDefaultSharedPreferences(context);
        return settings.getString(PreferenceUtils.NAME, null);
    }

    /**
     * Set name in app preferences to the supplied value.
     * 
     * @param context
     * @param name
     */
    public static void setName(final Context context, final String name)
    {
        final SharedPreferences settings = PreferenceManager.getDefaultSharedPreferences(context);
        final Editor editor = settings.edit();
        editor.putString(PreferenceUtils.NAME, name);
        editor.commit();

        if (BuildConfig.DEBUG)
        {
            Log.d(PreferenceUtils.TAG, "Setting name: " + name); //$NON-NLS-1$
        }
    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T07:18:25.067

The mistake was that I was creating the pref object in main activity. When I closed the main activity that object was destroyed. Async task kept running in the background and tried to access that object but failed since it was destroyed.

The trick was to initiate another object in Async separately.

# java - Java Swing - 单用户应用程序到多用户应用程序

> ID：15036969
> 
> 赞同：2
> 
> 时间：2013-02-23T04:10:09.327
> 
> 标签：java, swing, layer, multi-user, code-separation

我是新手......我有一个 Java Swing 应用程序，它在我的机器上运行良好。我想通过 Citrix 从服务器访问此应用程序。因此，当我单击已发布的图标时，它将运行 jar 文件中的 main 方法，并使我能够访问应用程序。此应用程序将能够访问数据库服务器中的数据库。

但我希望多个用户同时访问该应用程序，这就是我的问题所在：

1.  我想为 n 个用户创建 n 个可用的线程（即）我可以设置并发访问的限制。但是入口点是什么.....我的意思是当我点击发布的图标时，这意味着每次都会调用 main 方法。

2.  我可以考虑将我的用户界面与逻辑层分开......但我不知道该怎么做。当然，我正在遵循 MVC 模型。我的问题是每次访问应用程序时创建多个 gui 实例。

3.  最后我想使用数据库连接池。那么，这是否意味着我必须创建一个单独的 java 程序来创建这个池，并且我的应用程序将使用它的数据源？

任何人都可以“指出”我正确的方向吗？我不是在寻找具体的想法，而只是关于如何创建这个多用户应用程序的想法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T05:11:22.967

通常，对于多用户 Swing 应用程序，您可能希望将应用程序的“客户端”部分与“服务器”应用程序分开。

这工作如下：

*   每个用户都将获得他们自己的客户端应用程序运行实例。这可以在他们自己的机器上。
*   服务器应用程序是一个实例（或者可能是一个集群），它接受来自多个客户端的连接并与数据库通信
*   客户端应用程序在需要访问或更改数据时与服务器应用程序通信。您可以使用多种不同的通信方法。
*   可选地，服务器应用程序可以向客户端发送通知（例如，在另一个客户端更新数据的情况下）

如果您愿意让客户端连接到同一个数据库，则可以不使用服务器应用程序。这更容易设置，但有一些缺点：

*   您需要更加小心并发访问数据库/来自不同客户端试图同时更改相同数据的潜在损坏。
*   您需要允许从可能不受信任的客户端连接到您的数据库。这是一个安全风险。

鉴于您已经有一个工作应用程序，第二个选项可能更容易让您迁移到。请注意缺点：第一种选择通常是更好的架构。

# android - 运行android应用程序时标题未更改

> ID：15036971
> 
> 赞同：0
> 
> 时间：2013-02-23T04:10:46.850
> 
> 标签：android, android-layout, android-xml

我已经在 android 中创建了一个应用程序，现在我已经创建了活动 notes.xml、contactinfo.xml 和一个名为 listplaceholder5.xml 的 android xml 文件，我需要在“listplaceholder5”中将 textview 的 android:text 更改为“notes” .xml”文件，它在note.java中使用，但它不显示“notes”，它显示“contact”。我试过sode a sbelow：请帮助我更改代码以便我可以解决它，

**注意.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical"

     >

    <LinearLayout
        android:id="@+id/linearLayout1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >

          <TextView
            android:id="@+id/textView1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Name: " 
            android:textColor="#000000"
            android:textStyle="bold"
            android:textSize="16sp"
            android:paddingLeft="5dp"

            />

           <TextView
            android:id="@+id/item_title"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="item_title"
            android:textColor="#000000"
            android:textStyle="bold"
            android:textSize="16sp"
            android:paddingLeft="5dp" 
            android:ellipsize="end" 
            android:lines="1"
            android:scrollHorizontally="true"

        />
    </LinearLayout>

   <LinearLayout
        android:orientation="horizontal"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >

            <!--
            <TextView  
            android:layout_width="wrap_content" 
            android:layout_height="wrap_content"
            android:layout_gravity="left"
            android:text="@string/hello"
            android:visibility="gone"

         />-->

            <TextView
            android:id="@+id/textView1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Phone  :  " 
            android:textColor="#000000"

            android:textSize="14sp"
            android:paddingLeft="5dp"

            />

             <TextView
             android:id="@+id/item_subtitle"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"

            android:text="item_subtitle"

            android:textColor="#000000"
            android:textSize="14sp"

               />

          <TextView
            android:id="@+id/item_subtitle1"
            android:layout_height="wrap_content" 
            android:textColor="#000000"
            android:textSize="14sp" 
            android:layout_width="wrap_content"
             android:ellipsize="end" 
              android:lines="1"
              android:scrollHorizontally="true"

           />

            <!-- New Layout -->
            <LinearLayout
                android:orientation="horizontal"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:gravity="right" 
                android:paddingRight="10dp"
                >
                <ImageView
                    android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:src="@drawable/forward" />
                </LinearLayout>
            </LinearLayout>

</LinearLayout> 
```

**listplaceholder5.xml**

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"

     android:background="@drawable/detailpage">
    <LinearLayout android:layout_width="fill_parent" 
        android:weightSum="1" 
        android:background="@drawable/bottombackground" 
        android:id="@+id/linearLayout1" 

        android:layout_height="wrap_content">
        <TextView 
            android:layout_width="wrap_content" 
            android:textColor="#FFFFFF" 
            android:layout_marginLeft="18dp" 
            android:layout_weight="0.88" 
            android:textSize="18sp" 
            android:textStyle="bold" 
            android:id="@+id/textView1" 
            android:text="Notes" 
            android:gravity="center"
            android:layout_gravity="center"
            android:layout_height="wrap_content">

        </TextView>
    </LinearLayout>

    <ListView
        android:id="@id/android:list"
        android:layout_height="wrap_content"

        android:drawSelectorOnTop="false"  
        android:layout_width="fill_parent"
        android:cacheColorHint="#00000000"
        android:dividerHeight="2dp"
        android:listSelector="@drawable/list_selector"
        />

    <TextView
        android:id="@id/android:empty"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="No data"/>

</LinearLayout> 
```

**注意活动.java**

```
 package com.hussain.realtylog;

import java.util.ArrayList;
import java.util.HashMap;

import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import com.hussain.realtylog.Contact.DownloadWebPageTask;

import android.net.ConnectivityManager;
import android.os.AsyncTask;
import android.os.Bundle;
import android.os.Handler;
import android.os.Message;
import android.app.Activity;
import android.app.AlertDialog;
import android.app.ListActivity;
import android.app.ProgressDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.graphics.drawable.GradientDrawable;
import android.graphics.drawable.GradientDrawable.Orientation;
import android.view.KeyEvent;
import android.view.Menu;
import android.view.View;
import android.widget.AdapterView;
import android.widget.Button;
import android.widget.ListAdapter;
import android.widget.ListView;
import android.widget.SimpleAdapter;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.TextView;

public class NoteActivity extends ListActivity {
       JSONArray jArray = null;
       JSONObject json_data = null;
       String getMLSID =null;

       TextView titl;
      // Button btnBuyer;
     //  Button btnRental;
       String getJson =null;
       public String user=null;
       public static String urlContact=null;

       public static String jsonContact=null;
       ArrayList<HashMap<String, String>> mylist;

      private class DownloadWebPageTask extends AsyncTask<String, Void, String> {
        private ProgressDialog dialog;
        @Override
        protected String doInBackground(String... urls) {
            user= TabBarExample.getJsonUser;
            urlContact = StoreSession.strBaseURL+"&username="+user+"&act=ContactList";
             if( StoreSession.FlagContact == 0){
              boolean isNet = checkInternetConnection();
              if(isNet==true){
                jsonContact =  JSONfunctions.getJSONfromURL(urlContact);
              }else{
                alertbox("Contact", "Please check your mobile network setting and try again.");
              }
             }
             mylist = new ArrayList<HashMap<String, String>>();
             try{
               jArray = new JSONArray(jsonContact);
               for(int i=0;i<jArray.length();i++){                      
                HashMap<String, String> map = new HashMap<String, String>();    
                JSONObject e = jArray.getJSONObject(i);
                map.put("id",  String.valueOf(i));
                map.put("ID", e.getString("ID"));
                map.put("username", e.getString("username"));
                map.put("email",  e.getString("email"));
                map.put("phone", e.getString("phone"));
                map.put("phone2",  e.getString("phone2"));
                map.put("fullname",  e.getString("fullname"));
                map.put("address",  e.getString("address"));
                map.put("notes",  e.getString("info"));
                map.put("active",  e.getString("active"));
                map.put("created",  e.getString("created"));
                map.put("lastUpdate",  e.getString("lastUpdate"));
                map.put("guest",  e.getString("guest"));
                map.put("category",  "Category:  "+e.getString("category"));
                mylist.add(map);            
             }      
             }catch(JSONException e){
             //  Log.e("log_tag", "Error parsing data "+e.toString());
             }
             return null;
            }

        @Override
        protected void onPostExecute(String result) {

            ListAdapter adapter = new SimpleAdapter(NoteActivity.this, mylist , R.layout.activity_note, 
                        new String[] { "fullname", "phone" }, 
                        new int[] { R.id.item_title, R.id.item_subtitle });

            setListAdapter(adapter);

            final ListView lv = getListView();
            lv.setTextFilterEnabled(true);  
            int[] colors = {0, 0xFFFF0000, 0}; // red for the example
            lv.setDivider(new GradientDrawable(Orientation.RIGHT_LEFT, colors));
            lv.setDividerHeight(1);
            lv.setOnItemClickListener(new OnItemClickListener() {
            public void onItemClick(AdapterView<?> parent, View view, final int position, long id) {                
                final ProgressDialog dialog = ProgressDialog.show(NoteActivity.this, "Loading", 
                        "Please wait...", true);
                    final Handler handler = new Handler() {
                        public void handleMessage(Message msg) {
                          dialog.dismiss();
                         }
                        };
                        Thread checkUpdate = new Thread() {  
                            @SuppressWarnings("unchecked")
                            public void run() {
                                HashMap<String, String> o = (HashMap<String, String>) lv.getItemAtPosition(position);                   
                                final String strName= o.get("fullname").toString();
                                final String strEmail= o.get("email").toString();
                                final String Phone= o.get("phone").toString();
                                final String Phone2= o.get("phone2").toString();
                                getMLSID = o.get("notes").toString();
                                Intent newActivityFirst = new Intent(NoteActivity.this, ContactInfo.class);
                                newActivityFirst.putExtra("name", strName);
                                newActivityFirst.putExtra("strEmail", strEmail);
                                newActivityFirst.putExtra("phone", Phone);
                                newActivityFirst.putExtra("phone2", Phone2);
                                newActivityFirst.putExtra("notes", getMLSID);
                                NoteActivity.this.startActivity(newActivityFirst);

                                handler.sendEmptyMessage(0);
                                }
                                };
                                checkUpdate.start();

                }
            });
            StoreSession.FlagContact=1;
            //dialog.hide();
            dialog.dismiss();
        }
        private ListView getListView() {
            // TODO Auto-generated method stub
            return null;
        }

        private void setListAdapter(ListAdapter adapter) {
            // TODO Auto-generated method stub

        }

        protected void onPreExecute() {
            dialog = new ProgressDialog(NoteActivity.this);
            dialog.setCancelable(true);
            dialog.setMessage("Please wait...");
            dialog.show();
        }
      }

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_note);
         DownloadWebPageTask task = new DownloadWebPageTask();
            task.execute();

            setContentView(R.layout.listplaceholder5);

             TextView title=(TextView)findViewById(R.id.textView1); 
            title.setText("Notes");

    }

     @Override
        public boolean onKeyDown(int keyCode, KeyEvent event) {
            if (keyCode == KeyEvent.KEYCODE_BACK) {
                  StoreSession.FlagListing  =0;
                  StoreSession.FlagBuyer    =0;
                  StoreSession.FlagRental   =0;
                  StoreSession.FlagDocument =0;
                  StoreSession.FlagContact  =0;
                  ActiveShowingInfo.flagActiveClickCheck =0;
                  Main.username.setText("");
                  Main.pwd.setText("");

                return false;
            }
            return super.onKeyDown(keyCode, event);
        }

     protected void alertbox(String title, String mymessage)
        {
        new AlertDialog.Builder(this)
           .setMessage(mymessage)
           .setTitle(title)
           .setCancelable(true)
           .setNeutralButton(android.R.string.ok,
              new DialogInterface.OnClickListener() {
              public void onClick(DialogInterface dialog, int whichButton){}
              })
           .show();
        }
     private boolean checkInternetConnection() {
            ConnectivityManager cm = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);
            // test for connection
            if (cm.getActiveNetworkInfo() != null
                    && cm.getActiveNetworkInfo().isAvailable()
                    && cm.getActiveNetworkInfo().isConnected()) {
                return true;
            } else {
                //Log.v("tag", "Internet Connection Not Present");
                return false;
            }
        }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_note, menu);
        return true;
    }

} 
```

请帮我解决这个问题。提前谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T04:42:06.757

得到标题后如下：

```
title= (TextView) findViewById(R.id.item_title); 
```

使用`setText`方法根据需要设置标题。我认为它会解决你的问题。

# ruby-on-rails - 无法使用 ajax 刷新 rails html div

> ID：15036973
> 
> 赞同：1
> 
> 时间：2013-02-23T04:11:14.180
> 
> 标签：ruby-on-rails, ajax, ruby-on-rails-3

以下在 div 中呈现“2”，就像提交表单时一样。

完整品牌/create.js.erb 版本 1：

```
$("#brand_ajax").html("1")

$("#brand_ajax").html("0")

$("#brand_ajax").html("2") 
```

partialbrands/show_brands.html.erb **我要刷新的 div**

```
<% for brand in @brands%>
   ID: <%= h brand.id %>
<% end %> 
```

部分汽车/show.html.erb **ajax 调用**

```
<%= form_for([@car, @car.brands.build], **remote: true**) do |f| %>
<%= f.fields_for :brandsdo |a| %>
<%= a.text_field :name, placeholder: "New Manufacturer" %>
<% end %>
<%= f.submit "+", class: "btn inline" %>
<% end %>

**/*The div I want to refresh*/**
<div id="brand_ajax">
<%= render 'brands/show_brands' %>
</div> 
```

品牌控制器

```
respond_to do |format|
    if @brand.save
      format.html { redirect_to @car }
      format.js
    else
      flash[:notice] = "Error!"
      format.html { redirect_to @car }
     end
end 
```

提交新品牌表单后，以下内容不会呈现“2” - 根本不会刷新。只显示旧版本的“show_brands”。

全品牌/create.js.erb（说明）

```
$("#brand_ajax").html("1")

$("#brand_ajax").html("<%= escape_javascript render 'show_brands' %>")

$("#brand_ajax").html("2") 
```

任何想法为什么会发生这种事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T12:14:36.097

尝试

```
$("#brand_ajax").html("<%= j render :partial => 'show_brands' %>") 
```

# php - 使用 PHP 将 48 小时添加到 MySQL 日期时间并以 Javascript 日期格式打印

> ID：15036976
> 
> 赞同：-1
> 
> 时间：2013-02-23T04:12:13.580
> 
> 标签：php, javascript, jquery, mysql, date

我有一个日期时间存储到这样的数据库中

```
2013-02-22 00:00:00 
```

我想要做的是使用 PHP，它应该计算这个日期 + 48 小时，然后打印这样的消息

```
Sat Feb 23 2013 09:38:47 GMT+0530 (India Standard Time) 
```

这实际上是一个默认返回值 javascript Date() 函数。这样我就可以将它传递给我正在使用的倒数计时器插件。

有什么建议我怎么能做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T05:24:43.120

可以一起使用[date()](http://pl.php.net/manual/en/function.date.php)和[mktime()](http://pl.php.net/manual/en/function.mktime.php)来查找未来或过去的日期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T23:39:06.320

你也可以试试：

```
$dayAfterTomrrow = strtotime("2013-02-22 00:00:00")+172800;
echo date("r", $dayAfterTomorrow); 
```

..这将为您提供可以传递给javascript日期对象的格式。

但是您甚至不必将格式化的日期传递给 javascript 中的“new Date()”实例化器 - 您也可以以毫秒为单位传递时间戳（unix 纪元）。因此，如果您只使用 $dayAfterTomorrow 的标记并在 javascript 中将其乘以 1000，那么我的示例的第二行甚至都没有必要。

# assembly - aplib解压

> ID：15036993
> 
> 赞同：1
> 
> 时间：2013-02-23T04:16:04.113
> 
> 标签：assembly, compression

```
aP_depack_asm:
    ; aP_depack_asm(const void *source, void *destination)

    _ret$  equ 7*4
    _src$  equ 8*4 + 4
    _dst$  equ 8*4 + 8

    pushad

    mov    esi, [esp + _src$] ; C calling convention
    mov    edi, [esp + _dst$]

    cld
    mov    dl, 80h
    xor    ebx,ebx

literal:
    movsb
    mov    bl, 2
nexttag:
    call   getbit
    jnc    literal-------jump if no carry

    xor    ecx, ecx
    call   getbit
    jnc    codepair

    xor    eax, eax
    call   getbit
    jnc    shortmatch

    mov    bl, 2
    inc    ecx
    mov    al, 10h

.getmorebits:
    call   getbit
    adc    al, al
    jnc    .getmorebits

    jnz    domatch

    stosb
    jmp    nexttag

codepair:
    call   getgamma_no_ecx
    sub    ecx, ebx
    jnz    normalcodepair

    call   getgamma
    jmp    domatch_lastpos

shortmatch:
    lodsb
    shr    eax, 1
    jz     donedepacking

    adc    ecx, ecx
    jmp    domatch_with_2inc

normalcodepair:
    xchg   eax, ecx
    dec    eax
    shl    eax, 8
    lodsb
    call   getgamma

    cmp    eax, 32000
    jae    domatch_with_2inc
    cmp    ah, 5
    jae    domatch_with_inc

    cmp    eax, 7fh
    ja     domatch_new_lastpos

domatch_with_2inc:
    inc    ecx

domatch_with_inc:
    inc    ecx

domatch_new_lastpos:
    xchg   eax, ebp
domatch_lastpos:
    mov    eax, ebp

    mov    bl, 1

domatch:
    push   esi
    mov    esi, edi
    sub    esi, eax
    rep    movsb
    pop    esi
    jmp    nexttag

getbit:
    add    dl, dl
    jnz    .stillbitsleft
    mov    dl, [esi]
    inc    esi
    adc    dl, dl
  .stillbitsleft:
    ret

getgamma:
    xor    ecx, ecx

getgamma_no_ecx:
    inc    ecx
  .getgammaloop:
    call   getbit
    adc    ecx, ecx
    call   getbit
    jc     .getgammaloop

    ret

donedepacking:
    sub    edi, [esp + _dst$]
    mov    [esp + _ret$], edi ; return unpacked length in eax

    popad

    ret 
```

上面是aplib解压。已经提到它是lz78的派生。我想知道它用于从字典中读取代码的含义`getbit`、方式和位置。`algorithm`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-08-20T14:18:34.527

函数getbit 负责从输入数据流中读取一位（这是“混合的”，即包含纯字节和打包成字节的8 个独立位组）。

位读取是通过在寄存器 dl 中一次存储 8 位来完成的，并将这些位向左移动（添加 dl，dl 就可以了）。如果在移位寄存器后 dl 变为等于 0，这意味着所有位都已移出，需要从流中读取另一个字节，这在代码中完成：

```
getbit:
    add    dl, dl
    jnz    .stillbitsleft
    mov    dl, [esi]
    inc    esi
    adc    dl, dl
.stillbitsleft:
    ret 
```

ApLib 中使用的实际算法是原创的，但它建立在与 LZ78 非常不同的基础上，并且与 LZ77 有很多关系。基本上，在解压缩器循环的每次迭代中，从输入流中读取一位，如果为 0，则将一个字节从输入流复制到输出中。另一方面，如果该位为 1，则解压缩器知道必须从已解压缩的数据中复制匹配项。这个信号位的想法来自 LZSS。匹配的详细信息也在压缩数据流中指定。该格式的一个不太常见的功能包括使用rep-offsets 的可能性，即允许重用偏移量的命令。