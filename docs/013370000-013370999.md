# StackOverflow 问答 13370000-13370999

# php - 用 php regex 替换标签的 html

> ID：13370003
> 
> 赞同：0
> 
> 时间：2012-11-13T22:29:48.297
> 
> 标签：php, regex, html-parsing

我有一种情况，我认为我可能必须使用正则表达式来更改基于类属性的 html 标记内容或 src。

要记录我将解析的文件将是格式良好的 html、部分 html 或 php 文件。

EG 我需要用内部内容更改/填充这些标签：fileX.php

```
<?php
echo <<<_END
<div class="identifyingClass1"></div>
<div class="identifyingClass2"><span>holding content</span></div>
<img src='http://source.com/to/change' class='identifyingClass3' alt='descrip'/>
_END; 
```

结果文件X.php

```
<?php
echo <<<_END
<div class="identifyingClass1">New content jsd soisvkbsdv</div>
<div class="identifyingClass2">More new content</div>
<img src='new/source.tiff' class='identifyingClass3' alt='descrip'/>
_END; 
```

html可以是完整的，可以被php分隔，保持原样，在hereDOC中......

实现这一目标的最佳方法是仅使用正则表达式还是有人看到或使用过此类事情的类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T22:37:35.960

对于这种情况，[正则表达式是邪恶的。](https://stackoverflow.com/questions/1732348)更好地处理生成的 html。这是你如何做到的。

启用[输出缓冲](http://www.php.net/manual/en/function.ob-start.php)。在[ob_start](http://www.php.net/manual/en/function.ob-start.php)函数上添加您自己的回调。[在处理程序中使用DOMDocument](http://bd1.php.net/manual/en/class.domdocument.php)处理生成的 html 。像这样的东西，

```
function my_handler($contents){
     $doc = DOMDocument::loadHTML ($contents);
     // change your document here and return it later
     return $doc->saveHTML();
}
ob_start('my_handler'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T22:52:52.737

如前所述，不建议使用 RegEx 进行此类操作。[看看这个](https://stackoverflow.com/questions/3577641/how-to-parse-and-process-html-with-php)出色的答案。我个人最喜欢的是[SimleDom](http://simplehtmldom.sourceforge.net/)，它提供了类似 jQuery 的语法，让在 PHP 中使用 HTML 变得非常有趣；）。

# php - htaccess rewritecond 不工作

> ID：13370004
> 
> 赞同：0
> 
> 时间：2012-11-13T22:29:50.200
> 
> 标签：php, apache, .htaccess

我希望你能帮忙。我正在尝试编写一个 htaccess 文件，请执行以下操作。

1）重定向到www。地址

2）从网址中删除.php

3) 如果文件不存在，则使用 filechecker.php?page=filename

* * *

1 我可以做

RewriteCond %{HTTP_HOST} ^example.com$

重写规则 (.*) [http://www.example.com/](http://www.example.com/) $1 [R=301,L]

* * *

2）我可以做

RewriteCond %{SCRIPT_FILENAME}.php -f

重写规则 [^/]$ %{REQUEST_URI}.php [QSA,L]

* * *

3) 我想

RewriteCond %{REQUEST_FILENAME}.php !-f

RewriteRule ^([^/]*)$ filechecker.php?page=$1 [QSA,L]

会起作用，但由于某种原因，它忽略了页面确实存在的事实。

* * *

我希望你能帮助马克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T03:27:07.770

您对 2 的解决方案将循环，但很容易修复，请在您的文件中为第 2 部分和第 3 部分添加以下内容：

```
#If the Browser request contains a .php, instruct the browser to remove it.
RewriteCond %{THE_REQUEST}      \.php      [NC]
RewriteRule ^/?(.*)\.php$       http://%{HTTP_HOST}/$1         [R=301,NC,L]

#If a request is received for a non file-system object, that doesn't have a .php suffix, then store the full path, filename, and URI in a variables with that extention.
RewriteCond %{SCRIPT_FILENAME} !-d
RewriteCond %{SCRIPT_FILENAME} !-s
RewriteCond %{SCRIPT_FILENAME} !-f
RewriteCond %{SCRIPT_FILENAME} !^\.php$  [NC]
RewriteRule ([^/]+)$      -  [E=testScript:%{SCRIPT_FILENAME}.php,E=testFile:$1.php,E=testURI:%{REQUEST_URI}.php]

#See if the file exists with a .php extention, if it does internally rewrite
RewriteCond %{ENV:testScript} -s  [OR]
RewriteCond %{ENV:testScript} -f
RewriteRule .*              %{ENV:testURI} [L]

#Else if a ENV:testDile is set, then pass the name to the php script
RewriteCond %{ENV:testFile} !^$
RewriteRule .*               /filechecker.php?page=%{ENV:testFile} [L] 
```

仅供参考：Apache [mod_rewrite](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)文档值得一读，如果您不清楚上述规则的作用，或者如果您想要更抽象的东西，请考虑以下[帖子](http://www.experts-exchange.com/Software/Server_Software/Web_Servers/Apache/A_4043)。

# objective-c - 理解 Objective-C 覆盖代码

> ID：13370006
> 
> 赞同：0
> 
> 时间：2012-11-13T22:30:03.137
> 
> 标签：objective-c, xcode

**免责声明：**我编写的程序有效。我只需要帮助理解它。

今天我刚开始学习 XCode 和 Objective-C。我有大量的 Java 经验，我必须承认这是非常不同的。我目前正在关注一本让我们处理故事板上的两个场景的书。`Main View Controller Scene`和`Flipside View Controller Scene`。_

在主要场景中，我有一个`label outlet`说 Hello World 的场景。它的名字是标签。在反面场景中，我有一个`text outlet`. 当用户从反面场景翻转到主场景时，文本出口中的文本将应用于标签出口。因此，如果我在反面输入 Hello StackOverflow，然后翻转它，我将在主场景中看到 Hello StackOverflow。

我们通过转到控制翻转并位于主场景 .m 类中的方法并添加此代码来做到这一点。

```
self.label.text = controller.labelText.text; 
```

谁能解释一下这段代码？我知道 label 和 labelText 是我的名字。而文本正在寻找文本。但是我不知道 self 和 controller 是从哪里来的，书中也没有解释。谢谢你。

编辑

这是函数标题中具有控制器的函数的完整代码。我不明白这种方法发生了什么。任何解释都会很棒。

```
- (void)flipsideViewControllerDidFinish:(HWFlipsideViewController *)controller
{
    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone)
    {
        [self dismissViewControllerAnimated:YES completion:nil];
    }
    else
    {
        [self.flipsidePopoverController dismissPopoverAnimated:YES];
        self.flipsidePopoverController = nil;
    }

    self.label.text = controller.labelText.text;    
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T22:45:08.200

**self 是**java **this**指针，因此指向您的对象

**text 是一个属性**，将是**getText()**

所以 self.label.text 是 this.getLabel().getText() 但因为它设置**text=something 它是 setText！**

=> java-bean 风格的 getter 和 setter

**控制器**可能是一个局部变量。作为参数传递给方法或者它是 this 实例的对象上的成员变量

* * *

所以会的

```
this.getLabel().setText(controller.getLabelText().getText()); 
```

this = 你所在的对象和我认为的主要视图

控制器是翻转视图

“覆盖”将我们标签的字符串设置为控制器的文本字段字符串

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T22:38:13.673

您描述了，您处于控制翻转的上下文中。所以第二个控制器的实例（名为`controller`）必须在那里可用。所以你可以参考一下。

`self`是，正如 Xono 在评论中所说的那样，它已经是指向当前对象的指针，就像`this`在 java 中一样。

# ios - 状态栏重新出现时视图控制器不会自动调整大小

> ID：13370009
> 
> 赞同：1
> 
> 时间：2012-11-13T22:30:16.647
> 
> 标签：ios, cocoa-touch

在状态栏最初可见的情况下，我添加了一个子视图并隐藏了状态栏：

```
[[UIApplication sharedApplication] setStatusBarHidden:YES withAnimation:UIStatusBarAnimationSlide];
[myController.view addSubview:anotherController.view]; 
```

在这个视图中，有一个按钮可以切换状态栏的可见性，但是当我再次设置`statusBarHidden`时`NO`，视图控制器的视图不会自动调整大小以考虑状态栏，因此视图被按下并切断20 像素。我已经为视图设置了所有适当的调整大小蒙版，还尝试了自动布局，但似乎都不起作用。我希望我的视图在显示/隐藏状态栏时自动调整大小，而无需手动设置其框架。

**更新**

我没有将其添加到根视图控制器的视图中，而是将其推送到导航控制器的堆栈中，并隐藏了状态栏和导航栏。然后我让用户选择只切换状态栏。但是问题仍然存在，当状态栏重新出现时，视图被推送并切断了 20px。

但是当我旋转设备时，一切都在它的位置 - 只有当我在状态栏被隐藏后旋转设备时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T22:41:36.380

myController 是如何添加到窗口中的？假设 myController 是您窗口的 rootViewController，那么在显示/隐藏状态栏时，该控制器应该正确调整大小。anotherController 的视图应该以另一种方式添加，而不仅仅是添加它的视图。但是，如果您为该视图提供正确的调整大小标志，它也应该调整大小。但是如果你把那个控制器推到一个navigationController上，或者你把它设置为新的rootViewController，那就更好了。

# c# - c# Appsettings 给出错误：当前上下文中不存在名称“ConfigurationManager”

> ID：13370011
> 
> 赞同：3
> 
> 时间：2012-11-13T22:30:27.653
> 
> 标签：c#, .net, configurationmanager

在我的程序顶部，我有以下内容：

```
 using System.Configuration; 
```

在我的代码中，我有以下内容：

```
int  CompanyID = Convert.ToInt32(ConfigurationManager.AppSettings["CompanyId"]
    .ToString()); 
```

我收到以下*错误*：

```
The name 'ConfigurationManager' does not exist in the current context 
```

我不确定我错过了什么。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-13T22:35:04.853

要扩展一点，您需要添加一个引用以`System.Configuration.dll`使其工作。这有点误导，因为`System.Configuration`命名空间也存在于 base`System.dll`中，并且包含一些使用较少的对象，例如[`SettingsContext`](http://msdn.microsoft.com/en-us/library/system.configuration.settingscontext.aspx). 结果，它似乎真的应该起作用，但事实并非如此。这真的很令人困惑，目前是 .NET 框架中的那些迟钝的陷阱之一。

好在`System.Configuration.dll`是在.NET基础框架中，所以你只需要`References`在你的项目中的文件夹上右击，点击`Add Reference`，然后`System.Configuration`在`.NET`选项卡下找到就可以添加引用了。

将其导入您的项目后，不要忘记添加`using System.Configuration`到您打算使用的代码文件的顶部`ConfigurationManager`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T22:31:35.520

您需要在项目中添加对 System.Configuration 的引用。

# ruby-on-rails - 使用集合时如何获取中间对象< After having defined a has_many :through relationship, @user = User.New(:name=>"Bob") @project = Project.New( :name=>"Marke 问问题 问问题 2012-11-13T22:30:42.260 386 次 This question shows research effort; it is useful and clear 2 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. After having defined a has_many :through relationship, @user = User.New(:name=>"Bob") @project = Project.New( :name=>"Market Survey") @user.projects << @project Is there an easy way to fetch the new intermediate object it creates? such as in the above example, if the intermediate table is `memberships' then I could use: @membership = @user.projects << @project I have this feeling that there must be a better way of doing this than what we do all the time, i.e @membership = Membership.where(:user_id=>x , :project_id=>y).first This should work in most browsers: var languageinfo = navigator.language ? navigator.language : navigator.userLanguage; if(languageinfo.split('-')[0] == 'es') { alert('hola') } else { alert('hi'); } ruby-on-railsruby-on-rails-3has-many-through 4 3 回答 3 This answer is useful 3 我知道没有“神奇”的方法可以做到这一点。如果您正在寻找比您迄今为止所做的更好的东西，我能想到的最好的方法是做这样的事情： class User < ActiveRecord::Base # ... other active record stuff here. def membership_for(project) memberships.where(:project_id => project.id).first end end # Somewhere else... @user = User.new(:name=>"Bob") @project = Project.new(:name=>"Market Survey") @user.projects << @project @user.save! membership = @user.membership_for(@project) 并不完美，并且需要额外的代码，但它确实比您当前的代码读起来更好，这在 Ruby 中很重要。 于 2012-11-14T07:01:02.550 回答 This answer is useful 0 您可以执行以下操作： @membership = @user.members.find_by_project_id(@project.id) 不确定它是否比你做的更容易/更好。 于 2012-11-13T22:35:11.633 回答 This answer is useful 0 我不确定我是否理解你的问题，如果一个用户有很多项目，我认为你可以使用这个： @user = User.create(:name=>"Bob") # Create project and membership with user_id of @user same time, return project. @project = @user.projects.create(:name=>"Market Survey") 如果您想找到会员，我认为还有另一种方法： @membership = Membership.find(:first, conditions: { user_id: x, project_id: y }) 于 2012-11-14T06:28:49.373 回答 Related 2 php - 如何使用 PHP 收集网站元素数据 1 c# - 负数二进制并改变它的LSB 1 sql - 从三个表中选择的存储过程 3 javascript - 如果未选中任何复选框，则显示 alert() 2 php - SQL：不明确的列解析，而不更改 where 子句 1 jquery - Jquery移动滑块事件未触发 2 popup - Richfaces 4 弹出编辑器问题 5 r - 如何在ggplot中绘制一个变量？ 2 actionscript-3 - 我的 AS3 hitTest 应该去哪里？ 1 ios - iOS SDK 中的 Facebook Places 无需身份验证 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：13370013
> 
> 赞同：2
> 
> 时间：
> 
> 标签：ruby-on-rails, ruby-on-rails-3, has-many-through

After having defined a has_many :through relationship,

```
@user = User.New(:name=>"Bob")
@project = Project.New( :name=>"Market Survey")
@user.projects << @project 
```

Is there an easy way to fetch the new intermediate object it creates? such as in the above example, if the intermediate table is `memberships' then I could use:

```
@membership = @user.projects << @project 
```

I have this feeling that there must be a better way of doing this than what we do all the time, i.e

```
@membership = Membership.where(:user_id=>x , :project_id=>y).first 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T07:01:02.550

我知道没有“神奇”的方法可以做到这一点。如果您正在寻找比您迄今为止所做的更好的东西，我能想到的最好的方法是做这样的事情：

```
class User < ActiveRecord::Base
  # ... other active record stuff here.

  def membership_for(project)
    memberships.where(:project_id => project.id).first
  end
end

# Somewhere else...
@user = User.new(:name=>"Bob")
@project = Project.new(:name=>"Market Survey")
@user.projects << @project
@user.save!

membership = @user.membership_for(@project) 
```

并不完美，并且需要额外的代码，但它确实比您当前的代码读起来更好，这在 Ruby 中很重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T22:35:11.633

您可以执行以下操作：

```
@membership = @user.members.find_by_project_id(@project.id) 
```

不确定它是否比你做的更容易/更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T06:28:49.373

我不确定我是否理解你的问题，如果一个用户有很多项目，我认为你可以使用这个：

```
@user = User.create(:name=>"Bob")

# Create project and membership with user_id of @user same time, return project.
@project = @user.projects.create(:name=>"Market Survey") 
```

如果您想找到会员，我认为还有另一种方法：

```
@membership = Membership.find(:first, conditions: { user_id: x, project_id: y }) 
```

# svn - 如何撤消颠覆滥用？

> ID：13370021
> 
> 赞同：1
> 
> 时间：2012-11-13T22:30:59.747
> 
> 标签：svn, version-control

我被要求解决由于不正确使用颠覆引起的问题（据我所知）。

这是历史，由于一段时间的流逝，用户的困惑等而受到损害，但这是我能弄清楚的最好的。预期目标是在给定时间点归档文件集（本质上是标记存储库，但用户不知道这一点）。

*   用户已签出工作目录
*   用户没有创建标签，而是通过 unix 复制命令（不是 SVN 移动或 SVN 复制）将文件复制到其工作副本中的子文件夹。
    *   例如，工作副本是 /var/tmp/working，他们将文件复制到 var/tmp/working/todays_date
*   用户注意到这个新目录中缺少一些 .svn 目录，因此他们将 .svn 文件夹从另一个目录（他们不确定在哪里）复制到带有“标签”的目录中。

## 这是修复它的最佳方法吗？

想我会尝试以下：

*   递归删除错误子目录中的所有 .svn 文件夹
*   将目录从 repo 复制到本地
*   在他们最后一次提交之前检查一个工作目录
*   用“导出”文件覆盖新工作目录的文件
*   完成正常的更新/提交过程
*   创建标签

这是有道理的，还是我对其他问题敞开心扉？

## 其他问题

*   它教育这个用户的最好方法是什么，这样他们就不会再这样做了？

## 更新：更多信息

从用户那里得到以下信息：

*   我做了这项工作，然后尝试做一个 svn add。
*   然后我做了 svn commit 这给了我一些错误。
*   那时我移动了 .svn 文件，然后它终于做了 svn add 和 commit 没有错误
*   但是 svn log 不显示提交的日志消息。

所以看起来用户复制了 .svn 文件夹以尝试进行提交，然后它显然确实添加并提交了，但我们不确定它是否这样做，因为我们在日志中找不到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T22:33:44.307

您应该只更新根 svn 文件夹。它将恢复已删除（移动）的文件，其他未被索引的文件将不会被触及。

然后可以使用 svn delete 命令清理，或者 svn move 或者 svn copy。但是，如果您这样做，您将丢失 ew“尚未编制索引的文件”和更改。所以也许，svn 删除更容易（但你会丢失历史，因为 svn 将无法知道新文件是从另一个文件移动）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T04:21:35.983

正如我所见，你必须解决 2 个任务

*   撤消主干中子目录周围的错误提交
*   恢复用户的 WC

是的？

1.  通过新提交撤消提交并反向合并错误提交
2.  将用户的工作副本更新为此提交

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T13:39:25.350

因此，在与小组协商后，我们能够执行以下操作来解决此问题：

*   备份文件夹
*   使用 rsync 创建了没有 .svn 文件夹的文件夹结构的干净副本：

> rsync -avr --exclude='.svn*' /originaldirectory /cleandirectory

*   更新了工作副本

    *   事先确认此用户的更改是结构的这一部分中唯一重要的更改
*   解决了优先使用用户的本地工作副本文件的冲突。
*   试图提交以查找不正确的目录结构
*   从文件结构中删除这些树并重新更新存储库以再次将它们拉下
*   为了更好地衡量，用干净的文件覆盖所有文件内容以确保它们是最新的
*   强制添加结构中的所有文件。
*   坚定的。
*   完成后创建一个标签。

不用说，我们很快就会和他们一起讨论 Subversion 的最佳实践。谢谢大家的指点！

# java - 创建线程对象后调用实现runnable的Java类的方法

> ID：13370022
> 
> 赞同：3
> 
> 时间：2012-11-13T22:31:07.160
> 
> 标签：java, multithreading, runnable, producer-consumer

我有一个java类

```
SomeClass implements Runnable 
```

其中有一个方法 display()。

当我创建这个类的线程时

```
Thread thread1 = new Thread(new SomeClass()); 
```

现在如何使用线程实例调用 display() 方法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-13T22:32:09.417

你最终会打电话`start()`给`thread1`.

`SomeClass`将覆盖`run()`方法，而该方法又需要调用`display()`方法。

这样，当您调用时，将调用对象`start()`的 run 方法并执行 display() 方法。`SomeClass()`

例子：

```
public class SomeClass implements Runnable {
    private List yourArrayList;
    public void run() {
        display();
    }

    public void display() {
        //Your display method implementation.
    }
   public List methodToGetArrayList()
   {
    return  yourArrayList;
   }
} 
```

更新：

```
SomeClass sc = new SomeClass()
Thread thread1 = new Thread(sc);
thread1.join();
sc.methodToGetArrayList(); 
```

注意：示例是为了说明概念，可能存在语法错误。

如果您不使用 join()，正如 Andrew 所评论的那样，结果可能会不一致。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-13T22:36:17.143

如果你想从你的新线程调用 display 那么它需要在你的 run 方法中。

如果你想从调用线程调用它然后创建一个新对象，将它传递给你的新线程，然后从你的下降线程调用 display

```
SomeClass sc = new SomeClass();
new Thread(sc).start();
sc.display() 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-13T22:33:35.247

简单委托：

```
public class SomeClass implements Runnable {

    @Override
    public void run() {
        display();
    }

    public void display() {
        //...
    }

} 
```

# ruby-on-rails - RSpec 未找到示例

> ID：13370024
> 
> 赞同：2
> 
> 时间：2012-11-13T22:31:24.773
> 
> 标签：ruby-on-rails, rspec

出于某种原因，RSpec 无法识别我的一个规范文件中的断言 - 而是围绕它运行打印语句。

要开始规范测试，请在终端上：

```
rspec spec/lib/slots_scheduler_spec.rb 
```

声明...的规范文件的一部分（是循环的一部分）

```
print "#{slots_result[0].date} #{slot.date}\n"
slots_result[0].date.should == slot.date 
```

而我在控制台上看到的...

```
....
2012-11-18 2012-11-11
2012-11-25 2012-11-11
No examples found.

Finished in 0.00005 seconds
0 examples, 0 failures 
```

如果出了什么问题，我希望得到除“0 个示例，0 个失败”之外的其他消息。为什么我的测试会被这样忽略？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T22:38:44.343

### 您尚未定义示例组

如上所述，您的代码没有示例组。[示例组](https://www.relishapp.com/rspec/rspec-core/v/2-0/docs/example-groups/basic-structure)需要一个*描述*或*上下文*块，以及每个测试的*指定*或*它*块才能工作。

您的打印语句有效，因为它们是有效的 Ruby。但是，RSpec DSL 需要您提供更多信息，然后才能执行实际测试。

# php - 转换为java时PHP SQL数组json编码错误

> ID：13370030
> 
> 赞同：0
> 
> 时间：2012-11-13T22:31:40.553
> 
> 标签：php, android, sql, json, encode

我将一组 json 结果回显给 android：

```
$result = mysql_query($query) or die(mysql_error());
    $resultNo = mysql_num_rows($result);

    // check for successful store
    if ($result != null) {

        $rows = array();
        while($r = mysql_fetch_assoc($result)) {
        $rows[] = $r;
}   
return json_encode($rows);

    } else {
        return false;
    }
} 
```

但是当我尝试在另一端将字符串转换为 JSONObject 时，我得到：

```
11-13 22:18:41.990: E/JSON(5330): "[{\"email\":\"fish\"}]"

11-13 22:18:41.990: E/JSON Parser(5330): Error parsing data org.json.JSONException: Value [{"email":"fish"}] of type java.lang.String cannot be converted to JSONObject 
```

我已经用更大的结果集尝试了这个，并认为这与空值有关，但是像上面那样尝试只使用一个值仍然会返回错误。

非常感谢任何帮助

编辑：

安卓方法...

```
public JSONObject searchPeople(String tower) {
    // Building Parameters
    List<NameValuePair> params = new ArrayList<NameValuePair>();
    params.add(new BasicNameValuePair("tag", search_tag));
    params.add(new BasicNameValuePair("tower", tower));

    // getting JSON Object
    JSONObject json = jsonParser.getJSONFromUrl(loginURL, params);
    // return json
    return json;
} 
```

JSON解析器类...

```
public JSONObject getJSONFromUrl(String url, List<NameValuePair> params) {

    // Making HTTP request
    try {
        // defaultHttpClient
        DefaultHttpClient httpClient = new DefaultHttpClient();
        HttpPost httpPost = new HttpPost(url);
        httpPost.setEntity(new UrlEncodedFormEntity(params));

        HttpResponse httpResponse = httpClient.execute(httpPost);
        HttpEntity httpEntity = httpResponse.getEntity();
        is = httpEntity.getContent();

    } catch (UnsupportedEncodingException e) {
        e.printStackTrace();
    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    try {
        BufferedReader reader = new BufferedReader(new InputStreamReader(
                is, "iso-8859-1"), 8);
        StringBuilder sb = new StringBuilder();
        String line = null;
        while ((line = reader.readLine()) != null) {
            sb.append(line + "\n");
        }
        is.close();
        json = sb.toString();
        Log.e("JSON", json);
    } catch (Exception e) {
        Log.e("Buffer Error", "Error converting result " + e.toString());
    }

    // try parse the string to a JSON object
    try {
        jObj = new JSONObject(json);            
    } catch (JSONException e) {
        Log.e("JSON Parser", "Error parsing data " + e.toString());
    }

    // return JSON String
    return jObj;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:44:00.723

正如上面提到的@MikeBrant，您需要先通过`JSONArray`。

替换这个：

```
//try parse the string to a JSON object
try {
    jObj = new JSONObject(json);            
} catch (JSONException e) {
    Log.e("JSON Parser", "Error parsing data " + e.toString());
} 
```

有了这个：

```
// try parse the string to a JSON object
try {
    JSONArray jArray = new JSONArray(json);        

    for(i=0; i < jArray.length(); i++) {
        JSONObject jObj = jArray.getJSONObject(i);
        Log.i("jObj", "" + jObj.toString());

        // Parsing example
        String email = jObj.getString("email");
        Log.i("email", email);
    }

} catch (JSONException e) {
    Log.e("JSON Parser", "Error parsing data " + e.toString());
} 
```

PHP w/ `str_replace`：

```
$result = mysql_query($query) or die(mysql_error());
    $resultNo = mysql_num_rows($result);

    // check for successful store
    if ($result != null) {

        $rows = array();
        while($r = mysql_fetch_assoc($result)) {
        $rows[] = $r;
}

$json_string = json_encode($rows);
$json_string = str_replace("\\", "", $json_string, $i);
return $json_string;

    } else {
        return false;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-27T16:35:06.140

您需要对 PHP 添加的某些字符进行转义，并为您的 json 字符串添加子字符串以删除返回字符串前面的附加字符。

一种方法是这样的：

安卓/JAVA代码

```
JSONObject response = new JSONObject(responseString.substring(responseString.indexOf('{'),responseString.indexOf('}') +1).replace("\\","")); 
```

你应该做得更整洁一点，但重点是你必须确保你传入的字符串没有隐藏字符，并且将第一个 """ 字符替换为空字符，因为它可能导致异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T22:37:51.600

```
 $result = mysql_query($query) or die(mysql_error());
    $resultNo = mysql_num_rows($result);

    // check for successful store
    if ($result != null) {

        $rows = array();
        while($r = mysql_fetch_assoc($result)) {
            $rows[] = $r;
        }   
        return json_encode($rows);

    } else {
        return false;
    } 
```

我想这只是你的牙套

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T22:38:07.667

您传递给`JSONObject`的实际上是一个包含单个对象的数组。

`JSONObject`期望语法仅代表包含键值对（即属性）的单个对象。

您无需传递数组即可使其正常工作，或者您需要使用它`JSONArray`来解码 JSON。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-13T22:45:31.537

当我需要将 json 数据从 php 传递到 java 应用程序时，我遇到了类似的问题，这解决了我的问题：

```
$serialliazedParams = addslashes(json_encode($parameters)); 
```

# c# - SPItemEventReceiver.ItemUpdated ：删除与 properties.ListItem 中相同的 SPListItem

> ID：13370034
> 
> 赞同：1
> 
> 时间：2012-11-13T22:31:57.890
> 
> 标签：c#, sharepoint-2010

所以，我有这个代码：

```
public override void ItemUpdated(SPItemEventProperties properties)
{
    base.ItemUpdated(properties);

    SPListItem newItem = AMethodWhichGetsANewListItem();   
    properties.ListItem.ParentList.GetItemById(properties.ListItemId).Delete();

    properties.Cancel = true;
    properties.InvalidateListItem();
    properties.Status = SPEventReceiverStatus.CancelWithRedirectUrl;
    properties.RedirectUrl = newItem.ParentList.DefaultDisplayFormUrl + "=" + newItem.ID;
} 
```

此事件的属性中现在有一个不可用的 ListItem。在此之后，我无法取消或重定向。

错误日志显示：

```
`System.ArgumentOutOfRangeException: Specified argument was out of the range of valid values.    at Microsoft.SharePoint.SPListItemCollection.get_Item(Int32 iIndex)     at Microsoft.SharePoint.SPListItem.EnsureItemIsValid()` 
```

添加`properties.InvalidateListItem()`不会做任何事情。ItemUpdated 块中的 try { } 捕获不会捕获异常。

我能做些什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T08:50:05.963

我已将代码更改为 ItemUpdating。在此覆盖中，一切正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T16:58:59.313

我猜你不见了

```
 SPWeb web = properties.Web;
    web.AllowUnsafeUpdates = true; 
```

# eclipse - Eclipse 正在用新的搜索选择替换编辑器窗口

> ID：13370040
> 
> 赞同：26
> 
> 时间：2012-11-13T22:32:25.110
> 
> 标签：eclipse

当我在 Eclipse（版本：Helios Service Release 1 Build id：20100917-0705）中搜索文本字符串（或在工作区中查找引用）时，我可以双击搜索结果以打开编辑器窗口并将我带到该行. 假设我这样做了，它会打开`MyClass.java`. 然后我想看看在我的 jsp 中哪里使用了一些代码。所以我打开（再次，使用搜索结果）`some_action.jsp`。

当我这样做时，首先打开的任何编辑器窗口（在本例中为我的 .java）都将替换为我第二次打开的编辑器窗口（.jsp）。我以前从未遇到过这种行为，最近也没有对我的工作区进行任何更改。（好吧，显然我已经做了一些事情，因为事情不会无缘无故地破裂......但我不知道有任何变化。）这只是在没有任何已知催化剂的情况下才刚刚开始发生。

是否有一个设置我必须切换以消除这种不良行为？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-11-13T22:41:16.913

这实际上是默认行为。要在两种模式之间切换，请使用首选项`Preferences > General > Search > Reuse editors to show matches`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-04-18T22:01:44.613

如果您只想偶尔这样做并且不想更改默认行为，则可以从 Package Explorer 打开搜索结果：

右键单击结果 > 显示 > 包资源管理器 > ENTER

或仅使用键盘：

选择结果 > shift+alt+W > DOWN > ENTER > ENTER

# jquery - 在不同页面上使用 datepicker altField。这可能吗？

> ID：13370044
> 
> 赞同：1
> 
> 时间：2012-11-13T22:32:46.670
> 
> 标签：jquery, html, datepicker

我的问题：甚至可以在另一个页面上使用 altField 并且（希望是的）有人可以告诉我正确的方向吗？

```
var opts = {
 dateFormat: "dd/mm/yy",
    dayNamesMin: ['Zo', 'Ma', 'Di', 'Wo', 'Do', 'Vr', 'Za'],
    minDate: '+0D',
    maxDate: '+2Y',
    numberOfMonths: 2,
    showOn: "both",
    buttonImage: "/img/datepicker-icon.png",
    buttonImageOnly: true,
    buttonText:"Selecteer datum",
};

//on homepage
$('#from').datepicker( $.extend({ altField: '#alt-from'}, opts));
$('#to').datepicker($.extend({altField: '#alt-to'}, opts));

//on contact page
$('#alt-from').datepicker( $.extend({ altField: '#from'}, opts));
$('#alt-to').datepicker($.extend({altField: '#to'}, opts)); 
```

# javascript - 这个正则表达式有什么问题？获取 url 的哈希部分

> ID：13370046
> 
> 赞同：3
> 
> 时间：2012-11-13T22:32:59.077
> 
> 标签：javascript, regex, url, hash

我正在尝试从 url 获取哈希的第一部分（# 和 /、a 之间的部分？或字符串的结尾

到目前为止，我提出了这个：

```
r = /#(.*)[\?|\/|$]/

// OK
r.exec('http://localhost/item.html#hash/sub')
["#hash/", "hash"]

// OK
r.exec('http://localhost/item.html#hash?sub')
["#hash?", "hash"]

// WAT?
r.exec('http://localhost/item.html#hash')
null 
```

我希望收到“哈希”

我追查到问题

```
/#(.*)[$]/
r2.exec('http://localhost/item.html#hash')
null 
```

知道有什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T22:36:49.550

```
r = /#(.*)[\?|\/|$]/ 
```

当 $ 出现在`[]`( 字符类中时，它是文字“$”字符，而不是输入/行的结尾。实际上，您的`[\?|\/|$]`部分相当于 just `[?/$|]`，它匹配4个特定字符（包括管道）。

改用这个（[JSFiddle](http://jsfiddle.net/dMBbX/)）

```
r = /#(.+?)(\?|\/|$)/ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T22:37:01.463

你不应该写`[$]`（在字符类中），除非你想匹配`$`字面而不是行尾。

```
/#(.*)$/ 
```

**代码**：

```
var regex = /\#(.*)$/;
regex.exec('http://localhost/item.html#hash'); 
```

**输出**：

```
["#hash", "hash"] 
```

* * *

```
Your regex: /#(.*)[\?|\/|$]/
  //<problem>-----^       ^-----<problem>

           | operator won't work within [], but within ()
           $ will be treated literally within  []
           .* will match as much as possible. .*? will be non-greedy 
```

进行上述更改后，您最终会得到`/#(.*?)(\?|\/|$)/`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T22:38:15.810

我使用[http://regexpal.com/](http://regexpal.com/)来测试我的正则表达式。您的问题是您的正则表达式需要一个`/`. 所以它不适用，`http://localhost/item.html#hash`但它适用于`http://localhost/item.html#hash/`

试试这个：

```
r = /#([^\?|\/|$]*)/ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-13T22:39:07.077

为什么是正则表达式？这样做[（几乎没有正则表达式）]：

```
var a = document.createElement('a');
a.href = 'http://localhost/item.html#hash/foo?bar';
console.log(a.hash.split(/[\/\?]/)[0]); // #hash 
```

只是为了方便，如果`node.js`您正在使用：

```
var hash = require('url').parse('http://localhost/item.html#hash').hash; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-13T22:50:09.917

您不能`$`在字符类中使用字符串结束标记。您最好只匹配不是`/`or的字符`?`，如下所示：

```
/#([^\?\/]*)/ 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-13T22:48:51.190

我发现这个似乎有效的正则表达式

```
r = /#([^\/\?]*)/

r.exec('http://localhost/item.html#hash/sub')
["#hash", "hash"]

r.exec('http://localhost/item.html#hash?sub')
["#hash", "hash"]

r.exec('http://localhost/item.html#hash')
["#hash", "hash"] 
```

无论如何，我仍然不明白为什么原来的不起作用

# jquery - 使用所有其他 div 常量在 div 中缩放图像

> ID：13370048
> 
> 赞同：1
> 
> 时间：2012-11-13T22:33:05.563
> 
> 标签：jquery, css, html, jquery-animate, zooming

我有一个带有图像的 div 和环境中的其他几个 div。现在，我正在对图像进行一点动画处理，但它取代了它下面的内容。有什么办法解决吗？

这是我[所做](http://comparenext.buyhatke.com/trytry.php)的演示。我希望在不影响下部 div 的情况下缩放移动图像。

我用于该效果的javascript是：-

```
<script>
$(document).ready(function() {
    $('.itemDisplay').mouseenter(function(e) {
        $(this).find('.itemimgWrap').children('img').animate({ height: '135', left: '-20', top: '-20'}, 100);
    }).mouseleave(function(e) {
        $(this).find('.itemimgWrap').children('img').animate({ height: '120', left: '0', top: '0'}, 100);
    });
});
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:01:08.097

您需要将图像容器设置为 120px，`overflow:hidden`如果您想避免图像超出文本；）

```
.itemimgWrap{
   overflow: hidden;
   height: 120px;
} 
```

您可以使用 CSS3 制作动画（但我仍然推荐 Jquery）：

```
.itemimgWrap img {
    transform: scale(1);
    transition-timing-function: ease-out;
    transition-duration: 500ms;
}
.itemimgWrap img:hover{
    transform: scale(1.5);
    transition-timing-function: ease-out;
    transition-duration: 500ms;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T22:45:23.913

设置包含图像的 div 的高度

```
 .itemimgWrap{
    height: 120px!important;
   } 
```

# postgresql - 不同机器上 Postgres 实例之间的排序差异（相同的语言环境）

> ID：13370051
> 
> 赞同：6
> 
> 时间：2012-11-13T22:33:14.197
> 
> 标签：postgresql, locale, postgresql-9.1

我有两个 Postgres 9.1 实例：一个是本地的，通过 OS X 上的 Postgres.app 安装，另一个是远程的 Heroku。我已经确保这`lc_collate`在`en_US.UTF-8`两台机器上，但我仍然看到两者之间的不同行为。

在我的本地实例上，`SELECT 'i' > 'N'`返回`t`，而远程返回`f`。鉴于我已经检查`lc_*`了这两个系统，是什么解释了我所看到的差异？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-13T23:37:23.690

从 Unicode 的角度来看，大小写排序是一种定制。摘自[http://www.unicode.org/reports/tr10](http://www.unicode.org/reports/tr10)：

> 案例订购。一些字典和作者在小写之前整理大写，而其他人则使用相反的顺序，因此需要可自定义偏好。有时案件排序是由政府强制执行的，例如在丹麦。通常它只是一个定制或用户偏好。

Mac OS X 的大小写顺序与 Heroku 使用的 OS 不同。在 Mac OS X 上：

```
$ LC_CTYPE=en_US.UTF-8 sort << EOF
> i
> N
> EOF 
```

产生：

> 尼
> _

Ubuntu 12.04 上完全相同的命令和相同的数据产生：

> 我
> N

这与 PostgreSQL 无关，只是它使用操作系统进行整理，因此不同操作系统之间的这些不幸差异会影响数据库。

## PostgreSQL 10 和 ICU

从版本 10 开始，PostgreSQL 可以使用[ICU 库提供的排序规则，用于使用](https://www.postgresql.org/docs/devel/static/collation.html)[ICU](http://site.icu-project.org/)编译的服务器。这些排序规则可以跨操作系统进行一致的排序。

# java - 如何使用扫描仪逐字符读取输入文件？

> ID：13370053
> 
> 赞同：8
> 
> 时间：2012-11-13T22:33:23.480
> 
> 标签：java, input, io

我必须使用`Scanner`，所以有没有可以使用的`nextChar()`替代`nextLine()`方法？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T22:36:44.303

如果您*必须*使用 a `Scanner`（如您在编辑中所述），请尝试以下操作：

```
myScanner.useDelimiter("(?<=.)"); 
```

现在`myScanner`应该逐字阅读。

* * *

您可能想改用 a [`BufferedReader`](http://docs.oracle.com/javase/1.5.0/docs/api/java/io/BufferedReader.html#read%28%29)（如果可以的话） - 它有一个[`read`](http://docs.oracle.com/javase/1.5.0/docs/api/java/io/BufferedReader.html#read%28%29)读取单个字符的方法。例如，这将读取并打印文件的第一个字符：

```
BufferedReader br = new BufferedReader(new FileReader("somefile.txt"));
System.out.println((char)br.read());
br.close(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T22:37:09.577

使用 将行拆分为字符`String.toCharArray()`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-13T22:40:36.233

您可以转换为字符数组。

```
import java.io.*;
import java.util.Scanner;

public class ScanXan {
    public static void main(String[] args) throws IOException {
        Scanner s = null;
        try {
            s = new Scanner(new BufferedReader(new FileReader("yourFile.txt")));
            while (s.hasNext())
            {
               String str = s.next(); 
                char[] myChar = str.toCharArray();
                // do something
            }
        } finally {
            if (s != null) {
                s.close();
            }
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T22:40:22.663

如果您致力于使用，`Scanner`那么您可以使用`next(String pattern)`.

```
String character = scanner.next("."); 
```

上面返回`String`长度为 1 的 a ——也就是说，你得到一个字符，但是作为一个字符串。

# powershell - 没有扩展名的 Powershell 中的文件输出

> ID：13370055
> 
> 赞同：17
> 
> 时间：2012-11-13T22:33:34.690
> 
> 标签：powershell, powershell-2.0

这是我到目前为止所拥有的：

```
Get-ChildItem "C:\Folder" | Foreach-Object {$_.Name} > C:\Folder\File.txt 
```

当您从上面打开输出 File.txt 时，您会看到：

```
file1.txt
file2.mpg
file3.avi
file4.txt 
```

如何获得输出，以便它删除扩展名并仅显示以下内容：

```
file1
file2
file3
file4 
```

提前致谢！

***编辑***

在我下面的伙伴的帮助下想通了。我最终使用：

```
Get-ChildItem "C:\Folder" | Foreach-Object {$_.BaseName} > C:\Folder\File.txt 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-11-13T22:39:11.947

```
Get-ChildItem "C:\Folder" | Select BaseName > C:\Folder\File.txt 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-13T22:38:28.877

将文件名传递给[`GetFileNameWithoutExtension`方法](http://msdn.microsoft.com/library/system.io.path.getfilenamewithoutextension.aspx)以删除扩展名：

```
Get-ChildItem "C:\Folder" | `
    ForEach-Object { [System.IO.Path]::GetFileNameWithoutExtension($_.Name) } `
    > C:\Folder\File.txt 
```

* * *

我想评论[@MatthewMartin 的答案](https://stackoverflow.com/a/13370345/150605)，它将传入的文件名拆分为`.`字符并返回结果数组的第一个元素。这将适用于零或一的名称`.`，但会产生不正确的结果：

*   `file.ext1.ext2`产量`file`
*   `powershell.exe is good for me. Let me explain to thee..doc`产量`powershell`

原因是它返回了*first* `.`之前的所有内容，而实际上它应该是*last* `.`之前的所有内容。为了解决这个问题，一旦我们将名称拆分为由 分隔的段`.`，我们将获取除最后一个以外的每个段，并将它们重新连接在一起，并由 分隔`.`。在名称不包含 a 的情况下，`.`我们返回整个名称。

```
ForEach-Object {
    $segments = $_.Name.Split('.')

    if ($segments.Length -gt 1) {
        $segmentsExceptLast = $segments | Select-Object -First ($segments.Length - 1)

        return $segmentsExceptLast -join '.'
    } else {
        return $_.Name
    }
} 
```

一种更有效的方法是逐个字符地向后遍历名称。如果当前字符是 a `.`，则返回名称直到但不包括当前字符。如果没有`.`找到，则返回整个名称。

```
ForEach-Object {
    $name = $_.Name;

    for ($i = $name.Length - 1; $i -ge 0; $i--) {
        if ($name[$i] -eq '.') {
            return $name.Substring(0, $i)
        }
    }

    return $name
} 
```

该类已经提供[了一个方法来做同样的事情](https://docs.microsoft.com/dotnet/api/system.string.lastindexof)[`[String]`，](https://docs.microsoft.com/dotnet/api/system.string)所以上面可以简化为......

```
ForEach-Object {
    $i = $_.Name.LastIndexOf([Char] '.');

    if ($i -lt 0) {
        return $_.Name
    } else {
        return $_.Name.Substring(0, $i)
    }
} 
```

所有这三种方法都适用于具有零个、一个或多个`.`字符的名称，但是，当然，它们也比其他答案更冗长。实际上，`LastIndexOf()`是[什么`GetFileNameWithoutExtension()`](https://referencesource.microsoft.com/#mscorlib/system/io/path.cs,e36b3edc1f3e2c8d)[在`BaseName`](https://github.com/PowerShell/PowerShell/blob/ceed73d7375cb98a199ceb19796bb2311b0b0002/src/System.Management.Automation/engine/Types_Ps1Xml.cs#L210)[内部使用](https://referencesource.microsoft.com/#mscorlib/system/io/path.cs,e36b3edc1f3e2c8d)，而[使用](https://github.com/PowerShell/PowerShell/blob/ceed73d7375cb98a199ceb19796bb2311b0b0002/src/System.Management.Automation/engine/Types_Ps1Xml.cs#L210)在功能上与调用相同，[`$_.Name.Substring()`](https://docs.microsoft.com/dotnet/api/system.string.substring)只是它利用了[已经计算的扩展](https://docs.microsoft.com/dotnet/api/system.io.filesysteminfo.extension)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-13T22:57:48.810

现在是 FileInfo 版本，因为其他人都比我打败了 Path.GetFileNameWithoutExtension 解决方案。

```
Get-ChildItem "C:\" | `
where { ! $_.PSIsContainer } | `
Foreach-Object {([System.IO.FileInfo]($_.Name)).Name.Split('.')[0]} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-13T22:39:28.433

使用 BaseName 属性而不是 Name 属性：

```
Get-ChildItem "C:\Folder" | Select-Object BaseName > C:\Folder\File.txt 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2022-01-14T07:53:20.573

```
(ls).BaseName > C:\Folder\File.txt 
```

# linux - 在 Linux 上设置 SMTP 服务器的最简单、最便宜的方法？

> ID：13370058
> 
> 赞同：1
> 
> 时间：2012-11-13T22:34:02.203
> 
> 标签：linux, email, smtp

过去，我曾尝试按照[本指南](https://help.ubuntu.com/community/MailServer)在 Ubuntu 上设置邮件服务器（与 Postfix、Dovecot 和 Squirrelmail 一起使用），但均未成功。我似乎做的一切都是正确的，但邮件没有通过。

无论如何，已经有一段时间了，我想从头开始。我可以在 Linux 上设置 SMTP 服务器的最简单、最便宜（如果我已经有域名 + 服务器最好免费）的方法是什么？

我的最终目标是能够向我的手机（从命令行）发送简单、简短的电子邮件作为提醒。这就是我真正需要的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T22:38:45.133

```
sudo apt-get install mailutils 
```

然后设置一个 gmail 帐户并使用它来发送电子邮件。工作真的很容易。我这样做是为了查看谁登录了我的 Minecraft 服务器，这样我儿子就可以在他的朋友上线时加入：http: [//dymitruk.com/blog/2012/07/20/scripting-for-fun/](http://dymitruk.com/blog/2012/07/20/scripting-for-fun/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T22:45:58.007

如果您遇到“中继访问被拒绝”之类的错误，则表明您的电子邮件提供商需要某种身份验证。这不是您可以通过使用不同的邮件程序来解决的问题。

您必须正确配置邮件程序的凭据。我的电子邮件提供商需要用户/密码验证。`/etc/exim4/passwd.client`对于我的配置（exim），这是在由冒号分隔的文件中的一行中配置的：

> 邮件中继主机：用户名：密码

您还可以查看[https://serverfault.com/](https://serverfault.com/)、[https://unix.stackexchange.com/](https://unix.stackexchange.com/)或[https://superuser.com/](https://superuser.com/)，例如[https://unix.stackexchange.com/q/1449 /26493](https://unix.stackexchange.com/q/1449/26493)

# python - scipy curve_fit 指数拟合失败

> ID：13370059
> 
> 赞同：3
> 
> 时间：2012-11-13T22:34:03.857
> 
> 标签：python, matplotlib, scipy

当我尝试使用 curve_fit 进行指数拟合时，scipy 返回错误。难道我做错了什么？从 np.exp(-b * t) 中删除负号允许 curve_fit 工作，但它返回的值是很远的。

```
#!/usr/bin/python                                                                   

import numpy as np                                                                  
import scipy as sp  
from scipy.optimize import curve_fit                                                                                                                                                                                                       
import scipy.optimize as opt                                                        
import matplotlib.pyplot as plt                                                     

x = [40,45,50,55,60]                                                                
y = [0.99358851674641158, 0.79779904306220106, 0.60200956937799055, 0.49521531100478472, 0.38842105263157894]

def model_func(t, a, b, c):                                                         
    return a * np.exp(-b * t) + c                                                   

opt_parms, parm_cov = sp.optimize.curve_fit(model_func, x, y, maxfev=1000)          
a,b,c = opt_parms                                                                   
print a,b,c                                                                         
print x                                                                             
print y                                                                             
print model_func(x, a,b,c) 
```

失败并出现错误：

```
 Traceback (most recent call last):
      File "asdf.py", line 18, in <module>
        opt_parms, parm_cov = sp.optimize.curve_fit(model_func, x, y, maxfev=1000)
      File "/usr/lib/python2.7/dist-packages/scipy/optimize/minpack.py", line 426, in curve_fit
        res = leastsq(func, p0, args=args, full_output=1, **kw)
      File "/usr/lib/python2.7/dist-packages/scipy/optimize/minpack.py", line 276, in leastsq
        m = _check_func('leastsq', 'func', func, x0, args, n)[0]
      File "/usr/lib/python2.7/dist-packages/scipy/optimize/minpack.py", line 13, in _check_func
        res = atleast_1d(thefunc(*((x0[:numinputs],) + args)))
      File "/usr/lib/python2.7/dist-packages/scipy/optimize/minpack.py", line 346, in _general_function
        return function(xdata, *params) - ydata
    ValueError: operands could not be broadcast together with shapes (0) (5) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T22:44:17.700

更改`x`并更改`y`为 numpy 数组

```
x = np.array([40,45,50,55,60])
y = np.array([0.99358851674641158, 0.79779904306220106, 0.60200956937799055, 0.49521531100478472, 0.38842105263157894]) 
```

那么我认为你很好，因为该函数需要矢量化计算，而列表是不够的。

# linux - RPM 规范需要特定的 RHEL 版本

> ID：13370063
> 
> 赞同：1
> 
> 时间：2012-11-13T22:34:19.587
> 
> 标签：linux, rpm-spec

在 RPM 规范文件中，要求最小 RHEL 分布的好方法是什么？我尝试使用以下方法将 RHEL 6.3 作为先决条件：

```
Requires: redhat-release-server-6Server >= 6.3 
```

这会阻止 6.2 和 6.3 上的安装：

```
error: Failed dependencies:
    redhat-release-server-6Server >= 6.3 is needed by my.package-1.2.0-0.x86_64 
```

我也试过：

```
Requires: redhat-release >= 6.3 
```

在 6.2 或 6.3 上的依赖检查都没有失败。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T19:08:28.533

redhat-release-server-6Server-6.3.0.3.el6.x86_64（在我的系统上）似乎是一个很好的先决条件。请参阅[http://rhn.redhat.com/errata/RHEA-2012-0971.html](http://rhn.redhat.com/errata/RHEA-2012-0971.html)。对于查看软件包名称的新手来说，不明显的是“6Server”实际上是软件包版本。但是，“rpm -q --info”可以清楚地说明这一点：

```
$ rpm -q redhat-release-server-6Server --info
Name        : redhat-release-server        Relocations: (not relocatable)
Version     : 6Server                           Vendor: Red Hat, Inc.
Release     : 6.3.0.3.el6                   Build Date: Wed 30 May 2012 11:19:03 AM PDT
Install Date: Tue 02 Oct 2012 09:48:26 AM PDT      Build Host: x86-003.build.bos.redhat.com
Group       : System Environment/Base       Source RPM: redhat-release-server-6Server-6.3.0.3.el6.src.rpm
Size        : 38585                            License: GPLv2
Signature   : RSA/8, Wed 30 May 2012 12:19:55 PM PDT, Key ID 199e2f91fd431d51
Packager    : Red Hat, Inc. <http://bugzilla.redhat.com/bugzilla>
Summary     : Red Hat Enterprise Linux Server release file
Description :
Red Hat Enterprise Linux Server release files 
```

所以正确的指令是：

```
Requires: redhat-release-server >= 6Server-6.3 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-28T04:01:16.470

我建议不要要求特定版本的 RHEL，而是要求仅出现在目标版本中的依赖项（例如 RHEL 6.3）

以下不仅会导致您提到的问题，还会阻止客户端和工作站用户（`6Client`和`6Workstation`）的安装

```
Requires: redhat-release-server-6Server >= 6.3 
```

# unix - 用于 Unix 的 CPLEX -线性优化程序？

> ID：13370070
> 
> 赞同：0
> 
> 时间：2012-11-13T22:34:56.993
> 
> 标签：unix, optimization, linear-programming, cplex

[线性优化课程 2.3140 需要 CPLEX，但使用起来很痛苦，因为当像here](https://stackoverflow.com/questions/13231528/how-can-i-do-functions-in-cplex)和[here](https://stackoverflow.com/questions/13291906/what-is-wrong-with-this-forall-statement-in-cplex)这样的砖墙时，文档记录不佳且难以获得任何信息，更不用说在本地没有软件了。

是否存在一些线性优化工具，我可以通过它使用 CPLEX 进行编程？由于我已经一年没有使用这个工具了，所以我忘记了很多琐碎的事情。现在试图找到一些我什至可以在我的 Debian comp 或 Apple -comp 中运行的工具，是否存在任何工具或库？

**试验 1：试图找到 GUI 工具来执行这样的[代码](https://stackoverflow.com/a/13285562/164148)**

> 试图从 IBM Academic Initiative 中了解 CPLEX 的工作原理。在 uni 中，我有某种 Eclipse CPLEX - 东西，但我只发现了这个 - 我在哪里可以获得某些 Unix 的 GUI 东西？图片[在这里](https://i.stack.imgur.com/r4d9b.png)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T05:58:42.667

[ibm](ftp://public.dhe.ibm.com/software/websphere/ilog/docs/optimization/cplex/)提供了大量文档。如果您想在本地计算机上安装该软件并且是学生，您可以通过[学术倡议](http://www-01.ibm.com/support/docview.wss?uid=swg21419058)获得它。如果你想尝试不同的东西并且是学生，你可以得到[gurobi](http://www.gurobi.com/?utm_expid=11945996-12)，它有一个你可能喜欢的 python 界面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T06:02:25.827

我建议您在这里查看 COIN-OR 网站：

[http://www.coin-or.org/](http://www.coin-or.org/)

他们提供了有据可查的库和求解器（我主要使用 CPLEX，所以我不怎么用，但它有据可查，看起来非常好）。

CPLEX 本身可以做很多事情，但是对于线性规划课程，您可能只需要一个工具来解决线性规划，并且可能需要解决混合整数问题 (MIP)。

看看coin from CMPL，这对你来说可能就够了；如果您需要编写“真正的”程序，则必须使用（C 或 C++）库。他们为 MIP 提供 CoinMP，为线性程序（单纯形、障碍算法）提供 Clp。

我也将 GLPK（来自 GNU 项目）用于线性程序，但它在 MIP 中表现不佳（默认的分支定界过程非常简单），尽管它可能对您的课程来说已经足够了：

[http://www.gnu.org/software/glpk/](http://www.gnu.org/software/glpk/)

但是，对于 CPLEX 文档很差这一事实，我并不同意您的看法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T22:34:56.993

**Python**

> 我还没有测试过 CVXOPT，但我的老师嘲笑它，显然有点错误，更多[在这里](http://abel.ee.ucla.edu/cvxopt/)。

# google-apps-script - Google Apps 脚本 - 脚本之间的通信

> ID：13370072
> 
> 赞同：2
> 
> 时间：2012-11-13T22:35:04.113
> 
> 标签：google-apps-script, google-calendar-api

您好
我的问题如下：我想创建一个小型网页，可以在其上在 Google 日历中创建活动，但有一些限制。就我而言，这个日历可以由我的室友编辑以预订洗衣机。此预订不能重叠，而且我们所有人都可以使用它的天数有限。
我创建了**私人日历**，并且创建了验证请求的脚本，如果一切正常，则将事件添加到日历中。该脚本**以我的身份执行**（因为只有我有权编辑此日历）。但是我在获取执行此脚本的用户（我或我的一个室友）的信息时遇到问题。会话类包含 2 个方法 getActiveUser() 和 getEffectiveUser() 但活动用户不起作用（我猜是因为隐私保护政策）。但是，如果我创建另一个以**访问网络的用户**身份执行的脚本，我可以获得活跃用户。
有谁知道是否可以在嵌入同一站点的这两个脚本之间以某种方式进行通信？我想将活动用户的电子邮件从一个脚本传递到另一个脚本。或者也许你知道如何解决这个问题的更好的解决方案？

问候亚当

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T01:03:33.257

正如您所注意到的，您需要将脚本设置为在用户访问它以获取他的电子邮件时运行。然后，您可以调用另一个已发布的脚本，而不是直接访问日历（您显然不能），但以您自己的身份运行允许匿名访问，该访问将从“查看”脚本接收此请求并为其创建日历事件。

发布此“背景”脚本后，获取它的 url 并在`UrlfetchApp.fetch`调用它时使用它。然后将参数作为 url 参数传递（如果您更喜欢使用`post`而不是，则在有效负载上传递`get`）。

后台脚本甚至可以使用[ContentService](https://developers.google.com/apps-script/content_service)为调用脚本提供良好的返回值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T00:31:58.200

当然，你可以这样做，但这并不像你想要的那么简单。让您的管理员级脚本运行响应其他脚本的 Web 服务。它可能会被黑客入侵，因为您无法验证用户身份，但常见的是，这是一台洗衣机！

# java - 从 java 程序中执行 .app 文件

> ID：13370076
> 
> 赞同：3
> 
> 时间：2012-11-13T22:35:12.483
> 
> 标签：java, macos, exe, .app

我需要从我的 java 应用程序中执行一个外部程序。我在 Mac 上编程并且有一个 .app 应用程序我想在用户选择它时运行。它使用以下命令在 Windows 上成功运行：

```
String cmd = "path_to_executable\program.exe\""; 
```

`Process p = Runtime.getRuntime().exec(cmd); ...`

但这不适用于 .app 文件。我打开了 .app 文件的内容，并找到了一个 Unix 可执行文件以及该应用程序的其他支持文件。unix 可执行文件是否等同于 .exe 文件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-13T23:43:44.937

`open`在 OS X 上从 Java 启动 Mac 应用程序只需使用 Application 作为参数调用内置命令。OS X 中的 open 命令行工具知道如何正确打开许多不同的文件类型，包括应用程序包。如果您尝试启动 TextEdit.app 应用程序，您将调用：

```
open /Applications/TextEdit.app 
```

在 Java 中，您将使用：

```
String cmd = "open /Application/TextEdit.app";
Process p = Runtime.getRuntime().exec(cmd); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T23:04:22.383

是的，您应该运行的可执行文件是位于 .app 包中的 unix 可执行文件。但它可能无法正常工作，您可能需要 cd 进入目录或其他东西。

大多数应用程序二进制文件位于 Contents/MacOS/App Name 中。您可以创建一个接收字符串名称并基于标准目录执行该二进制文件的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T23:19:19.930

.app 文件实际上只是一个文件夹。这是一种在 Mac 上自包含应用程序的方法。实际的二进制文件很可能是您找到的 Unix 可执行文件。这将有助于了解有关该应用程序的一些详细信息。

.app 的二进制文件位于 Application.app/Contents/MacOS

# java - 处理 2.0 中的枚举

> ID：13370090
> 
> 赞同：11
> 
> 时间：2012-11-13T22:36:18.750
> 
> 标签：java, enums, processing

[这个](https://stackoverflow.com/q/5811397/1263272)问题是指版本 1.2.1，它不会在不同的部分编译，所以它不是重复的。

我想在处理中使用枚举。我已经读过它们在单独的文件中工作得更好，所以我已经这样做了。此代码正确编译：

```
enum Status
{
    STOPPED,MOVING
}; 
```

但是当我有这个代码时

```
Status status; 
```

在另一个文件中，它给了我以下错误：

```
Unrecognized type:46 (ENUM_DEF) 
```

我知道早期版本的 Processing 不支持枚举，但 2.0 版是否支持它们？如果是这样，是什么导致了错误？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-13T23:08:48.880

当您为枚举创建一个新选项卡时，您是否附加了 .java？在您的情况下，您的新选项卡是否名为 Status.java？

您的代码在处理 2.0b6 中对我来说编译得很好，主要选项卡内容：

```
Status status; 
```

还有一个名为 Status.java 的新选项卡，其内容为：

```
enum Status
{
    STOPPED,MOVING
}; 
```

# php - PHP MYSQL PREPARE 语法问题（意外的 T_STRING）

> ID：13370091
> 
> 赞同：0
> 
> 时间：2012-11-13T22:36:19.517
> 
> 标签：php, sql, syntax-error, prepare

我是 sql 和 PHP 的新手。到目前为止已经能够解决问题，但是 PREPARE 语句给了我语法问题（可能是因为我试图一步完成几件事）。如果有人能让我知道我的语法在哪里搞砸了，那就太好了。

此外，我正在编写的代码正在尝试更新服务器上的保存文件，虽然我相信使用 prepare 语句执行此操作是正确的方法，但如果不是，我会很高兴听到。*注意*我计划更改 INSERT INTO -> 有条件的插入或更新。

我得到的错误是意外的 T_STRING。我已经在代码中标记了错误所在的行。

```
$sql='PREPARE statement FROM "INSERT INTO buildings VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?) WHERE id="$id" AND ind="$i""';
$result=mysql_query($sql);
for($i=0;$i<1600;$i+=1){
    if(isset($_POST['ind'.$i])){
        $bind=$_POST['bind'.$i];
        $time=$_POST['time'.$i];
        $level=$_POST['level'.$i];
        $p1ind=$_POST['p1ind'.$i];
        $p1state=$_POST['p1state'.$i];
        $p1time=$_POST['p1time'.$i];
        $p2ind=$_POST['p2ind'.$i];
        $p2state=$_POST['p2state'.$i];
        $p2time=$_POST['p2time'.$i];
        $p3ind=$_POST['p3ind'.$i];
        $p3state=$_POST['p3state'.$i];
        $p3time=$_POST['p3time'.$i];
        $p4ind=$_POST['p4ind'.$i];
        $p4state=$_POST['p4state'.$i];
        $p4time=$_POST['p4time'.$i];
        $p5ind=$_POST['p5ind'.$i];
        $p5state=$_POST['p5state'.$i];
        $p5time=$_POST['p5time'.$i];

        $sql = 'SET @bind="$bind",'. //<-line of error
        '@time="$time",'.
        '@level="$level",'.
        '@p1ind="$p1ind",'.
        '@p1state="$p1state",'.
        '@p1time="$p1time",'.
        '@p2ind="$p2ind",'.
        '@p2state="$p2state",'.
        '@p2time="$p2time",'.
        '@p3ind="$p3ind",'.
        '@p3state="$p3state",'.
        '@p3time="$p3time",'.
        '@p4ind="$p4ind",'.
        '@p4state="$p4state",'.
        '@p4time="$p4time",'.
        '@p5ind="$p5ind",'.
        '@p5state="$p5state",'.
        '@p5time="$p5time",'.
        '@id="$id",'.
        '@ind="$i"';
        $result=mysql_query($sql);
        $sql='EXECUTE statement USING @id,@time,@level,@p1ind,@p1state,@p1time,@p2ind,@p2state,@p2time,@p3ind,@p3state,@p3time,@p4ind,@p4state,@p4time,
        @p5ind,@p5state,@p5time,@ind,@bind';
        $result=mysql_query($sql);
        if(!$result){
            die("saveArry[0]=".mysql_error().";");
        }else{
            die("saveArry[0]='saved';");
        }
    }
}
$sql='DEALLOCA PREPARE statement';
$result=mysql_query($sql); 
```

*更新*我无法在我的主机服务器上安装 PDO，因此很遗憾 PDO 是一个不可接受的解决方案。我的回答（现在没有错误！）：

```
 if(isset($_POST['ind'])){
    $ind=sanitizeString($_POST['ind']);
    $bind=sanitizeString($_POST['bind']);
    $time=sanitizeString($_POST['time']);
    $level=sanitizeString($_POST['level']);
    $p1ind=sanitizeString($_POST['p1ind']);
    $p1state=sanitizeString($_POST['p1state']);
    $p1time=sanitizeString($_POST['p1time']);
    $p2ind=sanitizeString($_POST['p2ind']);
    $p2state=sanitizeString($_POST['p2state']);
    $p2time=sanitizeString($_POST['p2time']);
    $p3ind=sanitizeString($_POST['p3ind']);
    $p3state=sanitizeString($_POST['p3state']);
    $p3time=sanitizeString($_POST['p3time']);
    $p4ind=sanitizeString($_POST['p4ind']);
    $p4state=sanitizeString($_POST['p4state']);
    $p4time=sanitizeString($_POST['p4time']);
    $p5ind=sanitizeString($_POST['p5ind']);
    $p5state=sanitizeString($_POST['p5state']);
    $p5time=sanitizeString($_POST['p5time']);
    $rot=sanitizeString($_POST['rot']);
    $sql="INSERT INTO buildings (id,ind,bind,time,level,p1ind,p1state,p1time,p2ind,p2state,p2time,p3ind,p3state,p3time,p4ind,p4state,p4time,p5ind,
    p5state,p5time,rot) VALUES ('$id','$ind','$bind','$time','$level','$p1ind','$p1state','$p1time','$p2ind','$p2state','$p2time','$p3ind','$p3state',
    '$p3time','$p4ind','$p4state','$p4time','$p5ind','$p5state','$p5time','$rot') ON DUPLICATE KEY UPDATE bind='$bind',time='$time',level='$level',
    p1ind='$p1ind',p1state='$p1state',p1time='$p1time',p2ind='$p2ind',p2state='$p2state',p2time='$p2time',p3ind='$p3ind',p3state='$p3state',
    p3time='$p3time',p4ind='$p4ind',p4state='$p4state',p4time='$p4time',p5ind='$p5ind',p5state='$p5state',p5time='$p5time',rot='$rot'";
    $result=mysql_query($sql);
    if(!$result){
        die("saveArry[0]=".mysql_error().";");
    }else{
        die("saveArry[0]=saved;");
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T22:43:40.670

单引号和双引号在该行中互换，应该是，

```
 $sql = "SET @bind='$bind', 
    @time='$time',
    @level='$level',
    @p1ind='$p1ind',
    @p1state='$p1state',
    @p1time='$p1time',
    @p2ind='$p2ind',
    @p2state='$p2state',
    @p2time='$p2time',
    @p3ind='$p3ind',
    @p3state='$p3state',
    @p3time='$p3time',
    @p4ind='$p4ind',
    @p4state='$p4state',
    @p4time='$p4time',
    @p5ind='$p5ind',
    @p5state='$p5state',
    @p5time='$p5time',
    @id='$id',
    @ind='$i'"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T22:48:31.810

我强烈建议使用[PDO](http://php.net/manual/en/book.pdo.php)而不是已弃用的 mysql_* 函数。它以透明的方式为您准备好声明来完成艰苦的工作。

正如 EthanB 在评论中指出的那样，您的代码容易受到[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)的影响，因为您直接从用户输入（`$_POST`变量）插入值。

使用 PDO，您的代码将如下所示（简化）：

```
$statement = $pdo->prepare("INSERT INTO buildings VALUES(:ind, :bind, :time, :level, ...) WHERE id = :id AND ind = :ind");

for( ... ) {
    $statement->execute(array(
       ":ind" => $_POST["ind" . $i],
       ":bind" => $_POST["bind" . $i], ...
    ));
} 
```

PDO 将为您发送 PREPARE 和 EXECUTE 查询并转义所有参数以防止 SQL 注入。

# ruby-on-rails - GemNotFoundException

> ID：13370102
> 
> 赞同：3
> 
> 时间：2012-11-13T22:37:04.337
> 
> 标签：ruby-on-rails, ruby

尝试运行 rails 服务器时收到此错误：

```
$ rails server
/usr/local/Cellar/ruby/1.9.3-p286/lib/ruby/1.9.1/rubygems.rb:317:in `bin_path': can't find gem rails ([">= 0"]) with executable rails (Gem::GemNotFoundException)
    from /usr/local/bin/rails:19:in `<main>' 
```

为什么 1.9.3 使用 1.9.1 lib 文件夹？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T20:52:07.737

出于兼容性和历史打包原因，它使用 1.9.1。鉴于更改只是少数，一切正常。IMO 这个文件夹可以被称为../ruby/1.9。

# jquery - 如何获取 responseText 消息？

> ID：13370106
> 
> 赞同：-2
> 
> 时间：2012-11-13T22:37:11.540
> 
> 标签：jquery

我如何获得关于成功、失败等的各种 ajax 消息？我想向用户提醒成功和错误值。这是我下面的代码

我认为 200 代表成功.. 我如何访问成功和失败值，以便我可以提醒他们并基于此做一些事情

```
$(function () {
    $("#save").click(function () {

        $.ajax({
            type: "POST",
            url: "some.json",
            data: json_data,
            contentType: 'application/json',
            success: function () {

                //if success forward to landing page else return to form for correctiion
            }
        });

    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T22:40:04.967

示例：将 id 作为数据发送到服务器，将一些数据保存到服务器，并在完成后通知用户。如果请求失败，提醒用户。

```
var menuId = $("ul.nav").first().attr("id");
var request = $.ajax({
  url: "script.php",
  type: "POST",
  data: {id : menuId},
  dataType: "html"
});

request.done(function(msg) {
  $("#log").html( msg );
});

request.fail(function(jqXHR, textStatus) {
  alert( "Request failed: " + textStatus );
}); 
```

链接：[http ://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T22:42:02.527

```
$(function() {  
                 $("#save").click(function() {  

                    $.ajax({  
                        type: "POST",  
                          url: "some.json",  
                          data: json_data,  
                          contentType : 'application/json',
                          success: function(data, textStatus, jqXHR) {  
                          // get success or failure from here
                        alert(jqXHR.responseText)
                          } 
                        }); 

                  });  
                }); 
```

jqXHR onject 的更多选项：http: [//api.jquery.com/jQuery.ajax/#jqXHR](http://api.jquery.com/jQuery.ajax/#jqXHR)

# html - 3D 转换分辨率问题

> ID：13370110
> 
> 赞同：0
> 
> 时间：2012-11-13T22:37:31.063
> 
> 标签：html, css, 3d, transform

当我在父元素上设置透视图时在元素上使用 X 或 Y 旋转时，转换后的元素的分辨率似乎下降到原始元素的拉伸位图版本，而不是保持其自己的分辨率。

当 X/Y 旋转被移除时，这种扭曲不会发生。Z 旋转似乎可以很好地处理而不会降低分辨率。如果关闭透视，分辨率似乎也正常。

示例： [http ://dabblet.com/gist/4068590](http://dabblet.com/gist/4068590)

```
/* # Bug # */
/* Removing the perspective gets rid of the resolution drop */
body { perspective: 200px; }

/*/ 
 * X and Y rotations cause the resolution to drop
 * while the Z rotation doesn't 
/*/
#test {
    transform: scaleX(5) scaleY(5) rotateX(2deg);
} 
```

这似乎发生在 Firefox、Chrome 和 Safari (XP) 中。有没有办法解决这个问题？（除了增加原始元素的大小然后缩小它）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T04:22:51.953

我相信您遇到了 GPU 与非 GPU 的转换。当某些东西被交给 GPU 时，它会获取它所交给的任何东西的光栅化副本，然后拉伸、挤压和插入像素。由于由浏览器决定将什么交给 GPU，因此您必须绝地武断地欺骗浏览器使其不执行 GPU 卸载 (YMMV)。或者，按照您的建议，使用大元素/图像并将最大比例设置为 1。

# java - 在一台 PC 上模拟两个 Java SE 实例

> ID：13370111
> 
> 赞同：0
> 
> 时间：2012-11-13T22:37:30.090
> 
> 标签：java

我想在一台 PC 上测试我的中间件（用 Java 编写）。该中间件在一个虚拟设备（具有 JAVA SE）上运行，相同的中间件在第二个虚拟设备（具有 Java SE）上运行。我有一台带有单一操作系统的 PC。

是否可以在具有单个操作系统的单个 PC 上模拟两个 Java SE 实例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T22:40:51.803

设置这种类型的测试最简洁的方法是使用虚拟机。

根据您的操作系统，有多种选择。

VirtualBox 易于设置，适用于许多主机操作系统，并且是免费的。

# batch-file - 是否可以在批处理文件中逐行读取管道？

> ID：13370113
> 
> 赞同：9
> 
> 时间：2012-11-13T22:37:48.657
> 
> 标签：batch-file, cmd

我想知道是否可以从批处理文件中的管道读取。如果我写：

```
echo Test 
```

我明白了，不足为奇，`Test`. 那很好。但是如果我想管道输出，并从另一个命令中读取它呢？

```
echo Test | echo ??? 
```

如何通过管道获得与以前相同的结果？谢谢！

**编辑：**我真正追求的是这个。

我有一个文件列表，我需要用我在一个名为`filter.txt`. 所以我必须使用`findstr /g:filter.txt`.

但是我需要对匹配的列表文件做一些事情，因为`findstr`每个文件都返回一行，所以我必须逐行读取匹配项。

我就是这样做的：

```
dir /b | findstr /g:filter.txt | for /F "delims=" %a in ('more') do del "%a" 
```

**解决方案：**

看起来我想做的不是*从管道中读取，*而只是读取批处理文件*中另一个命令的输出。*

要进行单行读取，您可以使用以下命令：

```
echo Test | ( set /p line= & call echo %%line%%) 
```

或者您可以使用它，它也适用于多行输入：

```
echo Test | for /F "delims=" %a in ('more') do @echo %a 
```

（这种使用*更多*的技巧在某些情况下可能很有用）。但在我的特殊情况下，解决方案是这样的：

```
for /F "delims=" %a in ('echo Test') do @echo %a 
```

谢谢大家！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-13T22:59:47.653

基于这个答案[https://stackoverflow.com/a/6980605/1630171](https://stackoverflow.com/a/6980605/1630171)看起来回答我的问题的方法是这样的：

```
echo Test | for /F "delims=" %a in ('more') do @echo %a 
```

这有点奇怪，但它有效:)

对我来说没有本地解决方案只是看起来有点奇怪......但这正是我想要的！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-13T23:21:03.110

要读取单行，您也可以使用`set /p`，但这仅适用于一行。

```
echo test | ( set /p line= & call echo %%line%%) 
```

问题就在这里，管道为每一侧创建了两个新的 cmd.exe 上下文。
它们与父 cmd.exe 在同一窗口中运行，它们不能更改父 cmd 的任何变量，因为它们是唯一的子项。

这就是为什么这个失败的原因

```
echo test | set /p line=
echo %line% 
```

`line`将被设置，但当管道结束时它将被销毁。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-11-15T04:50:39.933

对不起，我认为这里有一个混乱......

你说你想*从管道中读取*。管道用于将一个命令的输出重定向到另一个命令的输入；第二个命令称为*filter*。例如，在

```
dir /b | findstr /g:filter.txt 
```

`dir`和`findstr`命令之间有一个管道。管道总是在两个进程之间建立。无法读取从`dir`命令流向`findstr`命令的数据（这是此处存在的唯一管道）。但是，您可以从命令*的输出*中读取`findstr`。

如果我们插入一个额外的过滤器，行为是相同的。例如，在

```
dir /b | findstr /g:filter.txt | more 
```

有两个管道，但无法从其中任何一个中读取。但是，您可以从最后一个命令的输出中读取（`more`在本例中）。读取一个命令*的输出*的本机批处理解决方案是什么？它是 FOR /F 命令。例如，获取`echo`命令输出的本机方式：

```
echo Test | for /F "delims=" %a in ('more') do @echo %a 
```

是：

```
for /F "delims=" %a in ('echo Test') do @echo %a 
```

请注意，在第一个示例中，%a 参数不是从存在于`echo`和`for`命令之间的管道中获取信息，而是从命令*的输出*中获取信息`more`。

同理，实现这个任务的自然方法：

```
dir /b | findstr /g:filter.txt | for /F "delims=" %a in ('more') do del "%a" 
```

是这样的：

```
for /F "delims=" %a in ('dir /b ^| findstr /g:filter.txt') do del "%a" 
```

处理命令的多行输出`findstr`。

第二种方法不仅比前者更快，而且更清晰，因为包含一个`more`实际上什么都不做的命令可能会导致不希望的误解或错误。

安东尼奥

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-03-16T14:54:46.777

基于我在其他地方看到的另一个答案，只要它是数字的，就可以非常简单地捕获命令的输出并将其存储在没有中间文件的变量中。

子进程，如管道内的那些不能共享它们的环境变量，但可以返回一个由 %errorlevel% 获取的值。%errorlevel% 虽然不是环境变量，但每次调用时都会由 shell 计算。也不能正常设置，必须使用子进程设置。例子：

```
@echo off
echo %errorlevel%
cmd /c exit 56
echo %errorlevel% 
```

回报：

```
0
56 
```

有趣的是，您还可以这样做：

```
@echo off
echo %errorlevel%
cmd /c exit 56 & echo hi
echo %errorlevel% 
```

回报：

```
0
hi
56 
```

我相信这是因为它`echo hi`是由另一个子进程依次运行的，它不会在打印之前等待退出语句完成。这可能会因竞争条件而改变，但如果打印的文本更长，我不确定作为打印“hi”的父进程的子进程（运行退出）是否会等待它的子进程退出（或任何随后的孩子）在它完成退出命令之前。我尝试使用运行时间较长的命令（如 Tree）对此进行测试，但我得到一个查询返回的 0 到 %errorlevel%，这可能是由于 Tree 通过返回 0 影响结果，可能在`exit 56`.

无论如何，回到最有用的东西：

```
@echo off
echo %errorlevel%
echo 456 | ( set /p line= & call exit %%line%% )
echo %errorlevel%
pause 
```

回报：

```
0
456 
```

在这里，echo 打印的 456 被后续查询捕获并返回给 %errorlevel%。您可以通过这种方式捕获任何命令的输出，尽管它仅限于一个数值。这仍然非常有用，但不幸的是不允许您存储文本输出，我也想不出一种方法让它适用于多行输出。（未探索）

我认为理论上你可以链接任意数量的命令，并且应该能够用来`&&`强制它们运行的​​顺序。我不知道如何或是否可以使用它来捕获多行输入或允许返回文本，但应该通过提供向下共享其环境并可能返回值的嵌套子进程在管道内提供一些额外的摆动空间。（再次未经测试，也许尝试多个退出语句或其他东西，如果我以后学到任何东西，我会尝试在这里发布）

# ios - 快门动画 AVFoundation iphone

> ID：13370114
> 
> 赞同：6
> 
> 时间：2012-11-13T22:37:50.030
> 
> 标签：ios, camera

我正在尝试复制 iPhone 相机应用程序的默认快门动画。

也许有人尝试过这样做并有一些提示可以分享？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-14T15:25:18.027

好吧，我在某个地方找到了这个：

```
 CATransition *shutterAnimation = [CATransition animation];
     [shutterAnimation setDelegate:self];
     [shutterAnimation setDuration:0.6];

     shutterAnimation.timingFunction = UIViewAnimationCurveEaseInOut;
     [shutterAnimation setType:@"cameraIris"];
     [shutterAnimation setValue:@"cameraIris" forKey:@"cameraIris"];
     CALayer *cameraShutter = [[CALayer alloc]init];
     [cameraShutter setBounds:CGRectMake(0.0, 0.0, 320.0, 425.0)];
     [self.layer addSublayer:cameraShutter];
     [self.layer addAnimation:shutterAnimation forKey:@"cameraIris"]; 
```

这是默认的 iPhone 相机快门动画。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-04-25T09:22:26.340

在 Swift 3.0 中...

```
let shutterAnimation = CATransition.init()
shutterAnimation.duration = 0.6
shutterAnimation.timingFunction = CAMediaTimingFunction.init(name: 
kCAMediaTimingFunctionEaseInEaseOut)
shutterAnimation.type = "cameraIris"
shutterAnimation.setValue("cameraIris", forKey: "cameraIris")

let shutterLayer = CALayer.init()
shutterLayer.bounds = self.view.bounds
self.view.layer.addSublayer(shutterLayer)
self.view.layer.add(shutterAnimation, forKey: "cameraIris") 
```

# facebook - 致命错误消息：未捕获的异常 102

> ID：13370116
> 
> 赞同：0
> 
> 时间：2012-11-13T22:37:56.670
> 
> 标签：facebook

我有一个 Facebook 应用程序。在我的应用程序中，它可以拉出您的朋友列表，您可以在其中按姓名搜索或漫步寻找朋友。当我在搜索框中键入查找朋友时，我不断收到错误消息 Fatal error: Uncaught Exception: 102: Requires user session throws in /home/chattabo/public_html/fbappdev/src/base_facebook.php 在第 123 行。这是什么意思有谁知道如何解决这个问题？

# php - 对所有查询使用 slaveOk

> ID：13370120
> 
> 赞同：0
> 
> 时间：2012-11-13T22:38:03.330
> 
> 标签：php, mongodb, lithium

我不确定将 slaveOK 与 Connections::add() 一起使用的正确方法。[这里](http://lithify.me/bot/logs/li3/2012-05-01#23)建议使用`Mongo::setSlaveOkay()`，但我希望它用于所有查询。

我不确定如何正确测试它，但我想这会起作用：

```
Connections::add('mongo', 
    array(
        'type' => 'MongoDb',
        'database' => 'my_app',
        'slaveOk' => true
    )
); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T22:48:05.123

对于测试 - 你总是可以启动[wireshark](http://www.wireshark.org/)并查看请求的去向，或者检查集合中辅助节点的日志以查看它们是否正在读取。

# ios - 如何将 NSCoder 与版本化类一起使用

> ID：13370123
> 
> 赞同：1
> 
> 时间：2012-11-13T22:38:06.830
> 
> 标签：ios, versioning, nscoder

当对象的属性在归档和取消归档过程之间发生变化时，我对 NSKeyedArchiver 和 NSKeyedUnarchiver 有点挣扎。这是一个具体的例子：

我有一个类，比方说`Task`，它有属性`name`and `desc`，两者都是 type `NSString`。现在，我使用存档`NSKeyedArchiver archivedDataWithRootObject`并将其写入文件。稍后我可以从文件中读取它并使用它`NSKeyedUnarchiver unarchiveObjectWithData(data)`来回到我想要的位置。当`Task`获得一项新财产并且为了使事情变得有趣而失去一项时，问题就来了。

所以现在，`Task`has `name`，这是一个`NSString`，但是`desc`不见了。此外，我添加了`dateDue`type的属性`NSDate`。然后启动模拟器。问题是未归档的是 old`Task`具有 old`desc`属性，而不是 new `dateDue`。

我`initFromCoder`实际上考虑了当前类中不存在属性并且不尝试对其进行解码的情况。

有没有办法向 NSCoder 方法解释不是像我序列化它时那样创建对象的精确副本（我意识到这是序列化/反序列化定义的一部分），而是允许我灵活地版本它？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T00:07:56.093

有一种简单的方法 - 将版本写入数据并将其作为`initFromCoder`. 如果版本比较失败，只需`nil`从初始化程序返回。

添加属性时，即使您尝试解码数据，也只会得到一个`nil`值。您可以随时检查`nil`值。

当您删除一个属性时，应该没有任何问题。

请注意，您是实现编码和解码的人，因此您可以以任何您想要的方式实现它。

# sql - 使用子查询和重复项更新表

> ID：13370128
> 
> 赞同：0
> 
> 时间：2012-11-13T22:38:17.623
> 
> 标签：sql, oracle

我需要根据另一个表更新一个表，所以我有以下语句：

```
update FAULTS
set FAULTS.FAULT_STATE = (
    select INCIDENTS.TICKET_STATE from INCIDENTS
    where INCIDENTS.CF_ID = FAULTS.CF_ID
) 
```

它给了我错误说：

```
ORA-01427: single-row subquery returns more than one row 
```

我尝试了 DISTINCT，但状态值也不同，所以 DISTINCT 不起作用。所以我也改了：

```
update FAULTS
set FAULTS.FAULT_STATE = (
    select INCIDENTS.TICKET_STATE from INCIDENTS
    where INCIDENTS.CF_ID = FAULTS.CF_ID and rownum = 1
) 
```

现在它不会给出错误。

问题是，如果子查询返回null，它也会更新行并清除内容。有什么解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T22:45:05.723

您可以确保只更新匹配的行，如下所示：

```
update FAULTS
set FAULTS.FAULT_STATE = (
    select INCIDENTS.TICKET_STATE from INCIDENTS
    where INCIDENTS.CF_ID = FAULTS.CF_ID and rownum = 1
)
where exists (
    select INCIDENTS.TICKET_STATE from INCIDENTS
    where INCIDENTS.CF_ID = FAULTS.CF_ID
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T00:18:22.743

合并变体（10g+）：

```
merge into faults
using (select cf_id, ticket_state from incidents) incidents
   on (incidents.cf_id = faults.cf_id)
when matched then update
 set fault_state=ticket_state; 
```

# ruby-on-rails - Ruby + HTML div 标签

> ID：13370129
> 
> 赞同：1
> 
> 时间：2012-11-13T22:38:25.680
> 
> 标签：ruby-on-rails, ruby, html

我想嵌入一些 ruby​​ 代码来调整我的 html 页面上 a 的宽度。

基本上我在 Html 页面中有一个循环，看起来像这样

```
<% pass_fail.each do |row| %>

<div class="bar bar-success" style="width: 70%;"></div>
<div class="bar bar-warning" style="width: 20%;"></div>
<div class="bar bar-danger" style="width: 10%;"></div>

<% end %> 
```

我希望 div 的宽度类似于

```
((row[1]/(row[1]+row[2]+row[3]))*100)%
((row[2]/(row[1]+row[2]+row[3]))*100)%
((row[3]/(row[1]+row[2]+row[3]))*100)% 
```

有人可以帮助我使用嵌入代码来设置 div 宽度的确切语法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T23:05:52.367

假设`row`是一个包含三个整数的数组，`<%= %>`用于输出：

```
<div style="width:<%= ((row[0].to_f / (row[0] + row[1] + row[2])) * 100) %>%">Div 1</div>
<div style="width:<%= ((row[1].to_f / (row[0] + row[1] + row[2])) * 100) %>%">Div 2</div>
<div style="width:<%= ((row[2].to_f / (row[0] + row[1] + row[2])) * 100) %>%">Div 3</div> 
```

`to_f`必须用于捕获结果，因为它介于 0 和 1 之间。可以通过使用 对数组求和来简化`inject`：

```
<div style="width:<%= ((row[0].to_f / row.inject(:+)) * 100) %>%">Div 1</div>
<div style="width:<%= ((row[1].to_f / row.inject(:+)) * 100) %>%">Div 2</div>
<div style="width:<%= ((row[2].to_f / row.inject(:+)) * 100) %>%">Div 3</div> 
```

不是很清楚你会用它做什么，但我知道它很壮观。

除非`row`每次迭代之间的总和发生变化，否则建议尽可能缓存总和以加快执行速度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T22:44:24.507

让 CSS 为您完成工作：

在您的样式表中：

```
.bar-success {
    width:70%
}
.bar-warning{
    width:20%
}
.bar-danger{
    width:10%
} 
```

您的 HTML：

```
<div class="bar bar-success"></div>
<div class="bar bar-warning"></div>
<div class="bar bar-danger"></div> 
```

# windows-8 - CreateWindowExA 在 Windows 8（Pro 64 位）上失败

> ID：13370132
> 
> 赞同：1
> 
> 时间：2012-11-13T22:38:36.847
> 
> 标签：windows-8, 64-bit, winapi, fox-toolkit

在 Windows 8（64 位）上为 64 位应用程序调用 CreateWindowExA 是否存在已知问题？

背景：我正在使用[FOX 工具包](http://www.fox-toolkit.org/)（FOX STABLE 1.6.46）。在编译和运行最简单的*Hello World*示例（“hello”）时，对`CreateWindowExA`文件 FXWindow.cpp:1345 中的调用返回零 HWND 句柄（但`GetLastError()`不报告错误）。这只发生在一种特定的配置中：

```
OS        | OS Platform | App compiled for | CreateWindowExA succeeds? |
Windows 7 |    32-bit   |      32-bit      |         YES               |
Windows 7 |    64-bit   |      32-bit      |         YES               |
Windows 7 |    64-bit   |      64-bit      |         YES               |
Windows 8 |    64-bit   |      32-bit      |         YES               |
Windows 8 |    64-bit   |      64-bit      | NO! (returns NULL)        | 
```

`CreateWindowExA`最后的配置有什么不同。请注意，窗口过程在所有情况下都是相同的，并且它接收到的消息按顺序如下：

*   `WM_GETMINMAXINFO`（转发给`DefWindowProc`）
*   `WM_NCCREATE`（转发给`DefWindowProc`）

在最后一个配置中，它继续，`WM_NCDESTROY`然后`CreateWindowExA`返回 NULL。

在所有其他配置中，`WM_NCCALCSIZE`被发送，最后被发送`WM_CREATE`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T09:19:40.590

我找到了根源问题：FOX 错误地将窗口过程的函数签名定义为

```
long CALLBACK wndproc(FXID hwnd,unsigned iMsg,unsigned int wParam,long lParam); 
```

（`FXID`typedef'd to `void*`），所以在 64 位 Windows 上，`wParam`只有`lParam`32 位宽，而它们应该是 64 位。正确的函数签名（使用 FOX 类型）是：

```
FXival CALLBACK wndproc(FXID hwnd,unsigned int iMsg,FXuval wParam,FXival lParam); 
```

那么为什么它可以在 64 位 Windows 到 Windows 7 中工作呢？正如[MSDN 所说](http://msdn.microsoft.com/en-us/library/windows/desktop/ms632635%28v=vs.85%29.aspx)：

> `lParam`of包含一个指向 CREATESTRUCT 结构的`WM_NCCREATE`指针，该结构包含有关正在创建的窗口的信息。CREATESTRUCT 的成员与 CreateWindowEx 函数的参数相同。

碰巧在 Windows 7（64 位）及更​​低版本上，该结构始终分配在 4GB 以下的内存中，即使指针值被截断为 32 位，它仍然指向正确的位置。从 Windows 8 开始，该结构被分配在 64 位内存范围内的任何位置，截断它可能会产生不正确的指针。

只有一件事我不确定：`CALLBACK`作为`__stdcall`，参数从右到左被推入堆栈。那么，鉴于 的 声明不正确`windproc`，它是否仍在检索正确的`iMsg`和`hwnd`参数？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-17T14:54:53.063

我有同样的问题。然后我使用没有“A”的 CreateWindowEx(..) 函数解决了它。这可能对应该使用此功能的其他人有益

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-12T01:04:57.430

确认：64 位 Windows 8.1 不调用 WM_CREATE（而 32 则调用 WM_CREATE，就像 32 位和 64 位 Windows 7 一样）。当消息循环还无关紧要时，问题发生在 CreateWindows*() 下。

32 位地址的注释是公平的。在以下代码中，SetWindowLongPtr(m_hWnd, GWLP_USERDATA, (LONG_PTR)this) LONG_PTR 可能被错误地替换为 Windows 7 允许但 Windows 8 不允许的 LONG。

幸运的是，仍然发送了 WM_NCCREATE。

拦截 WM_CREATE/WM_NCCREATE 后，必须“返回 DefWindowProc()”，而不是“返回 0”。

我使用这种机制将一个指针（CreateWindow() 的最后一个参数）传递给我的 WndProc，而 WndProc 又将这个指针与 hwnd 相关联。希望将所有与窗口相关的数据和函数打包到一个类中，并使代码结构更好。这个想法看起来很强大，但我最终拒绝了。原因是每次 WndProc 调用都会调用 GetWindowLongPtr() 的成本。在 32 位版本上大约有 100 条指令，在 64 位版本上大约有 70 条指令。另一种方法是指向动态对象的静态指针（或者如果 WndProc 服务于多个对象实例，则可能是哈希表）。也许不是那么好，但它工作得更快，即使 WM_NCCREATE 也会消失，它也会继续工作。

# string - J2ME 中的文本换行

> ID：13370133
> 
> 赞同：3
> 
> 时间：2012-11-13T22:38:39.150
> 
> 标签：string, java-me, midp, lcdui

我正在处理一个小型 J2ME 项目，我需要将显示在表单上的文本包装起来，因为它超出了视图。

我正在使用诺基亚 IDE

这是我下面的代码：

```
aboutScreen.append(new StringItem("QY is a simplified web application that enables people all over the world access...", null)); 
```

我该怎么做才能在它到达屏幕末尾时移动到下一行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T20:21:48.987

我认为您错误地使用了 API - 第一个参数是标签，而不是实际文本。

改为尝试`new StringItem(null, "QY is a simplified web application that enables people all over the world access...")`- 当文本空间用完时，文本应该自动换行。

您可以在 JavaDoc 中了解它 - 检查**项目大小**部分： [http ://docs.oracle.com/javame/config/cldc/ref-impl/midp2.0/jsr118/javax/microedition/lcdui/Item.html #尺寸](http://docs.oracle.com/javame/config/cldc/ref-impl/midp2.0/jsr118/javax/microedition/lcdui/Item.html#sizes)

# java - Java RSA 两次获得相同的代码

> ID：13370135
> 
> 赞同：2
> 
> 时间：2012-11-13T22:38:39.683
> 
> 标签：java, rsa

我有这个问题我正在尝试使用此代码对字符串进行两次加密：

```
KeySpec keySpec = new X509EncodedKeySpec(new BigInteger(publicKey, 36).toByteArray());
KeyFactory keyFactory = KeyFactory.getInstance("RSA");
Key decodedPublicKey = keyFactory.generatePublic(keySpec);
Cipher cipher = Cipher.getInstance("RSA/ECB/PKCS1Padding");
cipher.init(Cipher.ENCRYPT_MODE, decodedPublicKey);     
byte a1[] = cipher.doFinal(z.getBytes());

KeySpec keySpec2 = new X509EncodedKeySpec(new BigInteger(publicKey, 36).toByteArray());
KeyFactory keyFactory2 = KeyFactory.getInstance("RSA");
Key decodedPublicKey2 = keyFactory2.generatePublic(keySpec2);
Cipher cipher2 = Cipher.getInstance("RSA/ECB/PKCS1Padding");
cipher2.init(Cipher.ENCRYPT_MODE, decodedPublicKey2);
byte a2[] = cipher.doFinal(z.getBytes()); 
```

两者都使用相同`publicKey`和相同的输入`z`，但两个代码块中的每一个都创建一个不同的字节数组（`a1!=a2`）我希望它相等但我不知道该怎么做（试图查找它但找不到回答呢）。

如果有人可以帮助我，我将不胜感激。

谢谢

编辑 ：

好吧，我没有使用 AES 加密，因为我加密的数据非常小（只是一个密码）

我有一个客户端和一个服务器，当有人连接到客户端时，我想确认他的密码（他的加密密码在 android sdcard 上的文件中）所以我想将真实密码与用户输入的密码进行比较登录页面

我在客户端上没有私钥，所以我无法解密设备上已经存在的加密通行证，所以我尝试比较加密密码（我认为这与我现在知道的密码相同） )

也许你知道我能做什么？如何在我只有公钥的情况下比较密码和加密密码

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T00:07:39.113

PKCS#1 填充用于确保相同的纯文本不会加密为相同的密文。PKCS#1 是一种最佳非对称加密填充形式，[在 wikipedia 上有描述](http://en.wikipedia.org/wiki/OAEP)。对于相同的纯文本具有不同的密文是一件好事。

如果你想破坏一个好的密码，你可以指定“NoPadding”而不是“PCKS1Padding”。这样做的缺点是填充还负责指定消息的长度。使用“NoPadding”，您会发现当您解密密文时，您的消息会以大量零字节为前缀。

我还要评论说，这不是您使用 RSA 加密消息的方式。RSA 仅适用于短数据。例如，1024 位 RSA 密码只能加密 117 个字节。使用 RSA 加密消息的正确方法是生成一次性 AES 密码密钥，使用 RSA 加密 AES 密码密钥，并使用 AES 加密消息。这使您可以安全地发送任何长度的消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T23:40:49.237

您可能想看看[这个问题](https://stackoverflow.com/questions/2568335/why-rsa-encryption-can-return-different-results-with-c-sharp-and-java)的最佳答案。简短的版本是每次使用公钥加密时，生成的加密数据都会有所不同。如果使用私钥加密，每次都会得到相同的结果。

# processing - 用于处理的智能感知

> ID：13370139
> 
> 赞同：1
> 
> 时间：2012-11-13T22:38:55.543
> 
> 标签：processing, processing.js, processing-ide

我正在开发处理语言的代码并使其成为我正在使用 processing.js 的 Web 应用程序。

我想知道是否有任何用于处理 ide 的智能感知，或者是否有用于处理的 IDE 具有智能感知。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:51:20.740

如果你想要一个 Eclipse 风格的大纲，你可以试试 Processing 2.0 的 Sketch-Outline 工具：[http ://code.google.com/p/sketch-outline/](http://code.google.com/p/sketch-outline/)

我自己没有对此进行测试，但这里发布的屏幕截图看起来很有希望： [https ://forum.processing.org/topic/sketch-outline-new-processing-tool-announcement](https://forum.processing.org/topic/sketch-outline-new-processing-tool-announcement)

我个人使用 Eclipse 作为一个成熟的 IDE，为您提供自动完成、类大纲等。唯一的缺点是您必须丢失一些由处理预编译器完成的代码捏造，即“颜色”不存在作为变量类型（实际上是 int），浮点数需要以“f”为后缀 - Java 中的“2.0”是双精度数，“2.0f”是浮点数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T22:49:26.087

IntelliSense 只是微软对自动完成的实现。

我猜您正在寻找具有自动完成功能的处理 IDE（不是 Processing.JS IDE）。

这是一项建议： [http ://wiki.processing.org/w/JEdit_as_External_IDE](http://wiki.processing.org/w/JEdit_as_External_IDE)

如果您正在寻找 Processing.js IDE，这里列出了两个：

[http://processingjs.org/](http://processingjs.org/)

他们是：

[http://sketchpad.cc/](http://sketchpad.cc/)

[http://processingjs.org/tools/processing-helper.html](http://processingjs.org/tools/processing-helper.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T04:42:02.957

在 Mac 上，[Sublime Text](http://www.sublimetext.com/)（商业）为 .pde 处理草图提供部分自动完成功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T00:59:32.120

此外，您可以将[Eclipse](http://eclipse.org/)与跨平台且易于设置的[Proclipsing插件一起使用。](http://code.google.com/p/proclipsing/)

我认为您可以使用 NetBeans 或 IntelliJ Idea 等任何其他 Java IDE 自动完成，这是链接处理的 core.jar 和子类[化 PApplet](http://processing.googlecode.com/svn/trunk/processing/build/javadoc/core/processing/core/PApplet.html)的问题。

# c# - ASP.NET 表单身份验证到期

> ID：13370142
> 
> 赞同：8
> 
> 时间：2012-11-13T22:39:05.067
> 
> 标签：c#, asp.net

有人可以向我解释 ASP.NET 表单身份验证是如何工作的，因为我似乎没有得到它，而且我一直在退出。

就目前而言，我有用户名、密码和“保持登录”复选框。根据这些值，我正在创建票证和 cookie，如下所示：

```
 // Create ticket
    FormsAuthenticationTicket ticket = new FormsAuthenticationTicket(1,email,DateTime.UtcNow,DateTime.UtcNow.AddMinutes(30),remember,String.Empty);

    // Encrypt ticket
    string cookie_contents = FormsAuthentication.Encrypt(ticket);

    // Create cookie
    HttpCookie cookie = new HttpCookie(FormsAuthentication.FormsCookieName,cookie_contents);

    if (remember) {
        cookie.Expires = DateTime.UtcNow.AddDays(90);
    }

    cookie.Path = FormsAuthentication.FormsCookiePath;
    cookie.Secure = true;

    // Add cookie to response
    Response.Cookies.Add(cookie); 
```

我希望使用此代码可以登录我的网站并假设我选中“保持登录状态”以保持登录状态至少 90 天？

但是我看到的是我在首次登录后至少 30 分钟被注销（这是为票预留的时间？）。

cookie 过期和票证过期有什么区别，我如何让自己保持签名。我需要为 cookie 和票设置 90 天吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-13T22:49:11.297

如果可以避免，请不要直接操作 cookie。您可以使用`FormsAuthentication.SetAuthCookie(username, persistent)`来登录用户。这里的持久性意味着“不使用会话 cookie”。

然后，您应该在 web.config 中指定 cookie 到期时间

```
 <system.web>
   <authentication mode="Forms">
             <forms timeout="50000000" slidingExpiration="true"/>
   </authentication>
 </system.web> 
```

其中滑动到期意味着将为每个请求更新 cookie。超时以分钟为单位，所以这个例子相当高:)

看看这个问题和 Scott Gu 博客的链接：[Forms Authentication Cookie Expiration](https://stackoverflow.com/questions/2059261/forms-authentication-cookie-expiration/13358214#13358214)

# python - 如何在 Python 中加载文件

> ID：13370147
> 
> 赞同：1
> 
> 时间：2012-11-13T22:39:27.343
> 
> 标签：python, python-2.7

我对 Python 相当陌生，希望在正确加载单独的文件方面得到一些帮助。我的代码目的是打开给定文件，按州或州缩写搜索该文件的客户。但是，我有一个单独的功能来打开我拥有的单独文件`(name of state):(state abbreviation)`。

```
 def file_state_search(fileid, state):
        z=0
        indx = 0
        while z<25:
            line=fileid.readline()
            data_list = ("Name:", "Address:", "City:", "State:", "Zipcode:")
            line_split = line.split(":")
            if state in line:
                while indx<5:
                    print data_list[indx], line_split[indx]
                    indx = indx + 1
            elif state not in line:
                z = z + 1
    def state_convert(fileid, state):
        line2=in_file2.readline()
        while state in line2:
                print line2

    x=1
    while x==1:
        print "Choose an option:"
        print
        print "Option '1': Search Record By State"
        print
        option = raw_input("Enter an option:")
        print
        if option == "1":
            state = raw_input("Enter A State:")
            in_file = open("AdrData.txt", 'r')
            line=in_file.readline()
            print     
            in_file2 = open("States.txt", 'r')
            line2=in_file2.readline()
            converted_state = state_convert(in_file2, state)
            print converted_state
            state_find = file_state_search(in_file, state)
            print state_find
        x=raw_input("Enter '1' to continue, Enter '2' to stop: ")
        x=int(x) 
```

顺便说一句，我的第一个导入语句有效，无论出于何种原因，我的第二个没有。

**编辑：**我的问题是，我在我的`state_convert`功能中做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T01:04:20.820

首先，我建议您以更 Python 的方式（使用`with`和`for`语句）重写代码。这将使代码更容易理解。

我想这个问题看起来像这样

```
def state_convert(fileid, state):
    # here should be fileid, and not in_file2
    # you read only one line of text
    line2=in_file2.readline()
    # if state in this line it prints line, otherwise it does nothing
    while state in line2:
            print line2 
```

或者我们可以重写

```
def state_convert(fileid, state):
    line2 = fileid.readline()
    if state in line2:
        print line2
        return None
    else:
        return None 
```

顺便说一句，在每次迭代中，您都会越来越深入地进入文件，并且永远不会回到它的开头。要做到这一点，使用`file.seek`or `file.close`or `with open(..) as ..`（第三个是最好的）

我想你的程序应该是这样的：

```
def search_smth(filename,smth):
    with open(filename, 'r') as f:
        for line in f:
            if smth in line:
                # here is line with searched phrase
                data = line.split() # or anything else
                return 'anything'

 if __name__ == '__main__':
    while True:
        print '..'
        option = raw_input('..')

        if option == '..':
            with open("AdrData.txt", 'r') as f:
                header1 = f.readline()
                header2 = f.readline() # read a pair of lines
                for line in f: # iterator for every line
                    pass # do some with line content
        elif option == '..2':
            pass
        else:
            break 
```

*对不起我的英语不好*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T22:53:10.657

我认为问题出在这里：

```
line2=in_file2.readline() 
```

in_file2 未在该范围内声明

在你的 state_convert 定义中试试这个：

```
line2 = fileid.readline() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T23:50:35.417

因此，从您的代码中，我看到了一些错误：

```
line2=in_file2.readline() 
```

就像卡洛斯兰德提到你应该做的那样

```
line2 = fileid.readline() 
```

next 我不明白你想用 while 循环做什么。如果您尝试打印所有行。那么你的代码应该是这样的：

```
def state_convert(fileid, state):
    line2=fileid.readlines()
    for line in line2:
            lineval = line.split(":")
            if lineval[0] == state or lineval[1] == state:
               print line 
```

好的，根据您的评论，我已经修改了代码。我不知道您的文件是如何组织的细节（例如，它是否只有每行的状态名称或其他内容）。

另一方面，这一行是错误的：

```
converted_state = state_convert(in_file2, state) 
```

state_convert 不返回任何内容。您似乎正在使用 state_convert 函数为您打印。

# jenkins - CloudBees 的 buildhive 是否有 JDK 7

> ID：13370158
> 
> 赞同：1
> 
> 时间：2012-11-13T22:40:48.477
> 
> 标签：jenkins, cloudbees, buildhive

buildhive.cloudbees.com 上是否提供 JDK7 - 我在配置中的任何地方都没有看到它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T23:37:56.260

似乎这可以通过 Maven 配置文件完成，在您的代码中使用以下代码`pom.xml`并添加：

```
-Pbuildhive clean install 
```

作为 BuildHive 中的 Maven 目标。

```
<profile>
      <id>buildhive</id>
      <build>
        <plugins>
          <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>2.5.1</version>
            <configuration>
              <source>1.7</source>
              <target>1.7</target>
              <showDeprecation>true</showDeprecation>
              <showWarnings>true</showWarnings>
              <encoding>UTF-8</encoding>
              <executable>/opt/jdk/jdk1.7.0/bin/javac</executable>
              <fork>true</fork>
            </configuration>
          </plugin>
          <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-surefire-plugin</artifactId>
            <configuration>
              <jvm>/opt/jdk/jdk1.7.0/bin/java</jvm>
              <forkMode>once</forkMode>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </profile> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T22:40:48.477

是的，它是可用的，即使没有列出：

JDK 7 位于：/opt/jdk/jdk1.7.0

转到项目配置页面并在“Shell Script”中放置 JAVACMD=/opt/jdk/jdk1.7.0/bin/java ant tests - 例如

# c# - 等式和赋值运算符

> ID：13370163
> 
> 赞同：4
> 
> 时间：2012-11-13T22:40:56.480
> 
> 标签：c#, vb.net, operators

我有一个在 VB.NET 中编译的程序集，其中包含两个运算符：

```
Public Shared Operator =(quarterA As CalendarQuarter, quarterB As CalendarQuarter) As Boolean
    Return quarterA.StartDate = quarterB.StartDate AndAlso
        quarterA.EndDate = quarterB.EndDate AndAlso
        quarterA.Quarter = quarterB.Quarter
End Operator

Public Shared Operator <>(quarterA As CalendarQuarter, quarterB As CalendarQuarter) As Boolean
    Return Not (quarterA = quarterB)
End Operator 
```

但是，当使用 C# 中的程序集执行相等检查时`if (qtr != null)`，我收到错误：

`Cannot implicitly convert type 'object' to 'bool'`

在 C# MVC4、Razor 中的用法：

```
@{Html.BeginForm();}
    <div class="ui-form ui-form-horizontal form-width-narrow">
        <div class="title">
            Choose a Quarter</div>
        <div class="group">
            <label><strong>Control</strong></label>
            <div class="field">
                @Html.DropDownListFor(x => x.Quarter, new SelectList(Model.AvailableQuarters))
                <input value="Select" class="ui-button" type="submit" />
            </div>
        </div>
        @if (Model.Quarter != null) {
            // Error in the above statement 
        }           
    </div>
@{Html.EndForm();} 
```

**我需要做什么才能使相等运算符正常运行？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T22:51:46.643

当我按原样实现您的代码并将实例与 null 进行比较时，我`NullReferenceException`在您的相等运算符中得到一个。但是，如果我添加一个空检查它工作正常：

```
Public Shared Operator =(quarterA As CalendarQuarter, quarterB As CalendarQuarter) As Boolean

    If quarterA Is Nothing OrElse quarterB Is Nothing Then Return False

    Return quarterA.StartDate = quarterB.StartDate AndAlso
        quarterA.EndDate = quarterB.EndDate AndAlso
        quarterA.Quarter = quarterB.Quarter
End Operator 
```

我怀疑是其他原因导致了您遇到的错误。

`=`当您应该使用相等运算符 ( ) 时，您很可能正在使用赋值运算符 ( `==`)：

```
if (qtr = null)   // wrong  - assigning null to qtr
if (qtr == null)  // correct 
```

此外，我建议[覆盖`Equals`并`GetHashCode`](http://msdn.microsoft.com/en-us/library/336aedhh.aspx)与您的相等运算符保持一致。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T23:00:50.203

在 VB 或 C# 中都不能重载赋值运算符。

[http://msdn.microsoft.com/en-us/library/8edha89s.aspx](http://msdn.microsoft.com/en-us/library/8edha89s.aspx)

# r - 如何在ggplot的箱线图中显示中值？

> ID：13370164
> 
> 赞同：15
> 
> 时间：2012-11-13T22:41:11.763
> 
> 标签：r, ggplot2

我正在尝试使用 ggplot() 在箱形图中显示中值（即水平条）。R 不断要求指定 y 轴。我有点卡住了。

```
p <-structure(list(TYPE = structure(c(3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 2L, 3L, 3L, 3L, 3L, 2L, 
3L, 3L, 3L, 3L, 3L, 2L, 3L, 3L, 2L, 3L, 2L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 2L, 3L, 3L, 3L, 1L, 2L, 3L, 3L, 2L, 3L, 3L, 3L, 1L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 1L, 1L), .Label = c("PM BUSINESS", 
"PM CONSUMER", "PREPAY"), class = "factor"), TOTALREV = c(52.13, 
53.01, 396.49, 596.52, 0, 33.89, 183.43, 0, 174.67, 120.56, 619.29, 
171, 142.2, 77.14, 16.69, 176.86, 103.79, 799.8, 137.84, 187.84, 
201.05, 16.69, 154.95, 195.98, 17.07, 158.96, 166.86, 8.89, 434.59, 
34.55, 196.97, 783.74, 216.27, 1533.98, 137.6, 52.22, 88.61, 
69.52, 52.18, 368.22, 139.89, 214.22, 163.46, 295.49, 319.73, 
933.91, 199.19, 118.72, 0, 174.99, 141.72, 52.12, 115.25, 106.57, 
106.12, 153.84, 1.45, 4.32, 168.93, 34.76, 249.21, 101.25, 87.69, 
20.62, 0.87, 17.39, 0, 34.5, 131.36, 0, 106.43, 257.45, 0, 0, 
256.63, 466.93, 44.25, 339.15, 71.42, 270.81, 145.85, 670.52, 
187.06, 170.61, 153.59, 21.69, 166.14, 97, 104.4, 517.19, 230.78, 
14.11, 52.33, 398.61, 56.65, 0, 26.02, 0, 154.78, 154.78)), .Names = c("TYPE", 
"TOTALREV"), row.names = 23961:24060, class = "data.frame")

x6.3 <- qplot(TYPE, TOTALREV, data =p, geom = "boxplot")
x6.3+ stat_bin(geom="text",aes(x=TYPE,y=TOTALREV,label=TOTALREV),size = 3, hjust = 0.5, vjust = -1.5,position ="identity") 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-13T22:49:31.667

我不认为这`stat_bin`是要走的路：

```
library(plyr)
library(ggplot2)

p_meds <- ddply(p, .(TYPE), summarise, med = median(TOTALREV))

ggplot(p,aes(x = TYPE, y = TOTALREV)) + 
    geom_boxplot() + 
    geom_text(data = p_meds, aes(x = TYPE, y = med, label = med), 
              size = 3, vjust = -1.5) 
```

![在此处输入图像描述](../Images/9063efeb84e30e0d54075db096a0bf29.png)

作为旁注，我通常发现人们一旦学会停止使用 ggplot 就不会那么困惑了`qplot`。

# aspectj - 如何使用 AspectJ 修改返回对象的属性？

> ID：13370167
> 
> 赞同：1
> 
> 时间：2012-11-13T22:41:23.283
> 
> 标签：aspectj, spring-roo, pointcut

我有一个如下所示的类（来自 Spring Roo DataOnDemand），它返回一个新的瞬态（非持久）对象以用于单元测试。这是我们从 Spring Roo 的 ITD 中推入后代码的样子。

```
public class MyObjectOnDemand {
    public MyObjectOnDemand getNewTransientObject(int index) {
        MyObjectOnDemand obj = new MyObjectOnDemand();
        return obj;
    }
} 
```

我需要做的是对返回的对象引用进行额外调用，以设置 Spring Roo 的自动生成方法无法处理的其他字段。因此，在不修改上述代码（或从 Roo 的 ITD 中推入）的情况下，我想再打一个电话：

```
obj.setName("test_name_" + index); 
```

为此，我声明了一个新的方面，它具有正确的切入点，并且将建议具体的方法。

```
public aspect MyObjectDataOnDemandAdvise {
    pointcut pointcutGetNewTransientMyObject() : 
        execution(public MyObject MyObjectDataOnDemand.getNewTransientObject(int));

    after() returning(MyObject obj) : 
        pointcutGetNewTransientMyObject() {
         obj.setName("test_name_" + index);
    }
} 
```

现在，根据 Eclipse，切入点已正确编写并建议正确的方法。但它似乎并没有发生，因为持久化对象的集成测试仍然失败，因为 name 属性是必需的，但没有被设置。根据 Manning 的 AspectJ in Action（第 4.3.2 节），after 建议应该能够修改返回值。但也许我需要做一个 around() 建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-03T11:20:24.560

我会在 tgharold 回复中添加评论，但没有足够的声誉。（这是我的第一篇文章）

我知道这是旧的，但我认为它可以帮助其他正在寻找这里的人知道可以在 AspectJ 中使用`thisJoinPoint`.

例如：

```
after() : MyPointcut() {
    Object[] args = thisJoinPoint.getArgs();
    ... 
```

更多信息请访问：[http](http://eclipse.org/aspectj/doc/next/progguide/language-thisJoinPoint.html) ://eclipse.org/aspectj/doc/next/progguide/language-thisJoinPoint.html 。

希望它对某人有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:11:14.803

这是使用周围的示例：

```
pointcut methodToMonitor() : execution(@Monitor * *(..));

Object around() : methodToMonitor() {
    Object result=proceed();

    return result;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T02:35:44.043

所以，事实证明我被 Eclipse 中的一个错误所困扰，因为它没有正确地编织东西。在 Spring Roo shell 中运行“执行测试”使一切正常，但是将包作为 JUnit 测试用例运行却不起作用。

上面的代码使用“返回后”建议确实有效。但是您也可以使用“around”通知来实现它，它允许您访问传递给方法的参数。

```
 MyObject around(MyObjectDataOnDemand dod, int index) :
    pointcutGetNewTransientMyObject() 
    && target(dod) && args(index) {

     // First, we go ahead and call the normal getNewTransient() method
     MyObject obj = proceed(dod, index);

     /*
     * Then we set additional properties which are required, but which
     * Spring Roo's auto-created DataOnDemand method failed to set.
     */
     obj.setName("name_" + index);

     // Lastly, we return the object reference
     return obj;
 } 
```

对于我们的特殊情况，“返回后”建议更加简洁易读。但是了解如何使用“around”建议来访问参数也很有用。

# ruby-on-rails - Ruby动态创建中的正则表达式

> ID：13370170
> 
> 赞同：1
> 
> 时间：2012-11-13T22:41:37.020
> 
> 标签：ruby-on-rails, ruby, regex

我想在我的 Rails 应用程序中创建一个动态正则表达式。我的数据库中有一个名为的表`foo`。`foo`由两列组成，`id`这`phrase`只是 varchar(255)。我希望能够制作一个包含所有“短语”实例的巨型表达式，并查看传入参数是否与短语中的任何单词匹配。我认为像下面这样的东西可能会做到这一点，但它似乎不能正常工作。我究竟做错了什么？

```
# get all phrases
phrases = Foo.all.map(&:phrase)

regex = Regexp.new phrases.join('|')

if params[:some_text] =~ regex
  # something in params[:some_text] matched at least one phrase
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:55:02.270

你想使用[`Regexp.union`](https://ruby-doc.org/core/Regexp.html#method-c-union)：

> **union(pat1, pat2, ...) → new_regexp**
> **union(pats_ary) → new_regexp**
> 
> 返回一个`Regexp`对象，它是给定模式的联合，即，将匹配其任何部分。模式可以是`Regexp`对象，在这种情况下，它们的选项将被保留，或者`String`s.

所以就这样：

```
regex = Regexp.union(phrases) 
```

例如：

```
>> phrases = %w[pancakes egg$]
=> ["pancakes", "egg$"]
>> puts Regexp.new(phrases.join('|')).inspect
/pancakes|egg$/
>> puts Regexp.union(phrases).inspect
/pancakes|egg\$/ 
```

`$`注意版本中的转义`union`。如果您需要有选择地转义特定字符串，还有[`Regexp.quote`](https://ruby-doc.org/core/Regexp.html#method-c-quote)(AKA )。`Regexp.escape`通常，您不想只是将一堆随机字符串混合在一起来构建正则表达式，正则表达式语法字符每次都会让您受益；用于`Regex.union`大交替或`Regex.escape`在将它们放在一起之前将它们发送出去。

如果你想把它保存在数据库中，你也可以做一个 LIKE 查询：

```
Foo.where('phrase like ?', "%#{params[:some_text]}%") 
```

或完全跳过所有模式匹配的内容及其转义问题并进行简单的字符串位置检查：

```
Foo.where('position(? in phrase) != 0', params[:some_text]) 
```

这两个都将进行表扫描，但您的`Foo.all`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-13T23:37:12.367

```
1.8.7 > phrases = ['one', 'two', 'three']
 => ["one", "two", "three"] 
1.8.7 > regex = Regexp.new phrases.join('|')
 => /one|two|three/ 
1.8.7 > puts 'match' if "a one b" =~ regex
match 
```

也许还有其他事情发生？你所做的对我有用，从等式中删除 AR。

# solr - 如果用户查询仅包含停用词，是否可以从 Solr 返回所有结果？

> ID：13370173
> 
> 赞同：2
> 
> 时间：2012-11-13T22:42:00.063
> 
> 标签：solr, stop-words, solr-query-syntax

如果用户查询仅包含停用词，我希望 Solr 返回所有结果，例如 q=the，（默认情况下 Solr 返回 0 个结果）。我可以打开 Solr 配置中的任何标志，或者我可以使用任何 Solr 查询语法构造来实现此目的吗？

我真的不喜欢在客户端复制停用词逻辑并`q=*:*`在所有术语都是停用词时触发的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T04:39:32.243

查看[Edismax 查询解析器](http://lucidworks.lucidimagination.com/display/solr/The+Extended+DisMax+Query+Parser)，如果查询包含所有停用词，它会处理不同的查询。

> 包括高级停用词处理：查询的强制部分不需要停用词，但仍用于邻近提升部分。如果查询由所有停用词组成，例如“to be or not to be”，那么所有单词都是必需的

尽管它不能作为 all ( `*:*`) 结果查询工作，但肯定会匹配大多数结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T04:37:30.780

这个问题的一个 hacky 解决方案是设置`q=*:* AND _query_:"{! var=$userq}"`，并将用户查询发送到`userq`URL 参数而不是`q`.

这明确地将结果设置为所有文档和用户查询的交集（如果您不熟悉`_query_:"{!...}"`语法，请参阅[http://wiki.apache.org/solr/LocalParams](http://wiki.apache.org/solr/LocalParams)）。

请注意，与单独的用户查询相比，这将返回不同的分数，但顺序相同。

# axapta - 在查询中混合临时表和真实表

> ID：13370179
> 
> 赞同：0
> 
> 时间：2012-11-13T22:42:25.200
> 
> 标签：axapta, dynamics-ax-2009, x++

为什么其中一个查询有效而另一个查询无效？我编写了工作查询，然后将表设为临时表，并且必须对其进行重写以在外部放置临时表。

这是表中的数据：

**tmpTASItemQtyInventDim:**

```
|物品编号 | InventDimId | 库存数量 |
|-------|-------------|------------|
|73016 | 调暗 11542913 | 0 |

```

**销售热线：**

```
|销售编号 |行号 | 项目 ID | InventDimId | 销售数量 |
|------------|--------|--------|--------------|--- --------|
|SO120036796 | 1| 73016 | 调暗 11542913 | 2 |

```

**不工作：**

```
select firstonly tmpTASItemQtyInventDim
    join itemId, InventDimId, sum(salesQty) from salesLine
    group by itemId, InventDimId
    where salesLine.SalesId == 'SO120036796'  &&
          tmpTASItemQtyInventDim.ItemId == salesLine.ItemId     &&
          tmpTASItemQtyInventDim.InventDimId    == salesLine.InventDimId    &&
          tmpTASItemQtyInventDim.InventQty      < salesLine.SalesQty;

if (tmpTASItemQtyInventDim.ItemId)
    info("Insufficient Qty");
else
    info("Good qty"); 
```

**作品：**

```
select firstonly itemId, InventDimId, sum(salesQty) from salesLine
    group by itemId, InventDimId
    where salesLine.SalesId     == 'SO120036796'
    exists join tmpTASItemQtyInventDim
        where tmpTASItemQtyInventDim.ItemId == salesLine.ItemId     &&
              tmpTASItemQtyInventDim.InventDimId    == salesLine.InventDimId    &&
              tmpTASItemQtyInventDim.InventQty      < salesLine.SalesQty;

if (salesLine.ItemId)
    info("Insufficient Qty");
else
    info("Good Qty"); 
```

两者都应该输出`Insufficient Qty`，但第一个说`Good Qty`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T08:23:27.140

从记忆中，我认为您需要在第一张桌子上分组，请参阅 [http://axatluegisdorf.blogspot.co.uk/2010/07/select-group-by-and-join-order-by.html](http://axatluegisdorf.blogspot.co.uk/2010/07/select-group-by-and-join-order-by.html)

```
select firstonly ITEMID,InventDimId 
  FROM  tmpTASItemQtyInventDim
  GROUP BY ITEMID,InventDimId
join itemId, InventDimId, sum(salesQty) 
from salesLine
 group by itemId, InventDimId
where salesLine.SalesId == 'SO120036796'  &&
      tmpTASItemQtyInventDim.ItemId == salesLine.ItemId     &&
      tmpTASItemQtyInventDim.InventDimId    == salesLine.InventDimId    &&
      tmpTASItemQtyInventDim.InventQty      < salesLine.SalesQty;

if (tmpTASItemQtyInventDim.ItemId)
   info("Insufficient Qty");
else
   info("Good qty"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T09:57:07.333

混合临时表和真实表就像在鹅卵石路上骑自行车。你并不总是得到你想得到的东西，而且[性能有时很糟糕](http://mybhat.blogspot.dk/2012/05/joining-permanent-table-with-temp-table.html)。

在 AX 2012 中，您可以使用更可预测的 TempDB。

另见[Axaptapedia](http://www.axaptapedia.com/Temporary_tables)。

# facebook - 失败的 Facebook 页面刷新 onclick 按钮

> ID：13370181
> 
> 赞同：-1
> 
> 时间：2012-11-13T22:42:32.233
> 
> 标签：facebook, facebook-like, refresh

我创建了一个标签，其中有一个喜欢的按钮。和大家一样；）我想在订阅或取消订阅页面后刷新整个页面。

--------编辑------ 我修改了我的代码，添加了一些在互联网上找到的代码。下面的这段代码在 IE 和 Firefox 下工作，但取消订阅功能不起作用......你知道修复它的技巧吗？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>Document sans titre</title>
</head>

<body>
<div id="fb-root"></div>
<script>
  window.fbAsyncInit = function() {
    // init the FB JS SDK
    FB.init({
      appId      : 'My App ID', // App ID from the App Dashboard
      status     : true, // check the login status upon init?
      cookie     : true, // set sessions cookies to allow your server to access the session?
      xfbml      : true  // parse XFBML tags on this page?
    });

    // Additional initialization code such as adding Event Listeners goes here
    FB.Event.subscribe('edge.create',function () {
        top.location = "http://www.google.fr";
      });
        FB.Event.unsubscribe('edge.create',function () {
        top.location = "http://www.google.fr";
      });

  };

 // Load the SDK Asynchronously
    (function(d){
      var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
      if (d.getElementById(id)) {return;}
      js = d.createElement('script'); js.id = id; js.async = true;
      js.src = "//connect.facebook.net/fr_FR/all.js";
      ref.parentNode.insertBefore(js, ref);
   }(document));
</script>

<div style="overflow:hidden; width:60px">
        <div class="fb-like" data-href="my fan page" data-send="false" data-width="60" data-show-faces="false"></div>
</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-13T23:04:49.340

我想你在你的代码中留下了响应，

试试下面的代码

```
 FB.Event.subscribe('edge.create', function(response) {
            window.top.location = "http://google.com";
        }); 
```

# javascript - 无论 if 语句如何，都会加载 Ajax 内容

> ID：13370182
> 
> 赞同：0
> 
> 时间：2012-11-13T22:42:36.177
> 
> 标签：javascript, jquery, html, css, ajax

我有一个正在加载 ajax 的 div，但我想添加一个 if 语句来仅加载尚未加载的 ajax。[由于某种原因，这在我的网站](http://www.uvm.edu/~areid/homesite/)上不起作用（单击左眼查看错误。）。相反，ajax 内容滑入，然后通过 ajax 重新加载内容。

这是我的代码：

```
 <script type="text/javascript">
    $(window).load(function () {
        function SlideOut(element) {
            var opened = $(".opened"),
                div = $("#" + element),
                content = $("#content");
            opened.removeClass("opened");
            div.addClass("opened");
            content.removeClass().addClass(element);
        }
        $("#content div").click(
            function () {
                var move = $(this).attr('data-move'),
                    id   = $(this).attr("id");
                if( id == 'forehead')
                {
                    $('#resume img').css('display', 'block');
                }

                else if(id =='left-eye23')
                {   
                    var  leftcontent;
                    leftcontent = $("#left-content");                       
                    content = leftcontent.attr('class');
                    if( !leftcontent.hasClass('photos'))
                    {       
                      SlideOut(move);
                        $("#left").bind("webkitTransitionEnd mozTransitionEnd oTransitionEnd msTransitionEnd transitionend", 
                        function(){ 
                            $.ajax({
                            url:'photos.php',
                            beforeSend: function(){
                                leftcontent.html('<img src="loading.gif" /> Now loding...');
                            },
                            }).done(function(data){
                                leftcontent.html(data);
                                leftcontent.addClass("photos");
                            }); 
                            });
                        }                       
                    else if (leftcontent.hasClass('photos'))
                    {
                      SlideOut(move); 
                    }

                }... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T02:03:24.230

`if(leftcontent.length == 0)`应该做的伎俩。

所以它看起来像：

```
var leftcontent = $("#left-content");                       
if(leftcontent.length == 0)
{
     //Do stuff
} 
```

如果你 console.log 一个元素，它将返回一个长度。如果对象不存在，则长度为 0。仅当页面上没有 #left-content 时才会运行此 if。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T22:46:56.157

改变：

```
leftcontent.html(data); 
```

至：

```
$("#left-content").html(data) 
```

# python - 检查远程文件中的内容是否存在

> ID：13370183
> 
> 赞同：1
> 
> 时间：2012-11-13T22:42:37.597
> 
> 标签：python

我有一个 Python 应用程序需要通过 HTTP 检查远程文件中的文本内容是否存在。有没有一种有效的方法可以在不下载整个文件的情况下进行此检查？也许只读取前 X 个字节或查看文件中是否存在单词？我愿意接受所有建议。顺便说一句，我必须同时对多个文件执行此检查。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T22:55:58.360

[urlgrabber](http://urlgrabber.baseurl.org/)支持 keepalive（用于同一服务器上的多个文件）和范围（用于从文件中间读取）。不过，这两个功能都依赖于服务器支持。

# c++ - 验证整数输入 C++？

> ID：13370189
> 
> 赞同：3
> 
> 时间：2012-11-13T22:42:58.397
> 
> 标签：c++, validation, input, types

我`!(cin >> input)`用来验证整数输入，但它不捕获其他数据类型，例如浮点数。相反，它需要第一个整数。例如：

> 请输入一个数字：2.5。

我的错误消息出现在这里，假设循环，但它需要第一个数字。

输出“2”

如何让它忽略十进制输入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T22:50:30.497

输入流将任何以符号开头后跟至少一个十进制数字的内容视为有效的整数输入。如果您想在包含小数点的十进制输入上失败，您需要做一些不同的事情。处理此问题的一种方法是读取整数并查看成功读取整数之后的字符是否为小数点：

```
if (!(std::cin >> value)
    || std::cin.peek() == std::char_traits<char>::to_int_type('.')) {
    deal_with_invalid_input(std::cin);
} 
```

正如 Thomas Matthews 正确指出的那样，问题并不仅限于浮点数，而是任何带有数字前缀后跟非空格的东西（而不是 EOF：上述解决方案实际上会在末尾丢失一个有效整数一个文件，即后面没有任何东西，甚至没有换行符）。要仅读取后跟空格或文件末尾的整数，如下所示：

```
if (!(std:cin >> value)
    || (!std::isspace(std::cin.peek())
        && std::cin.peek() != std::char_traits<char>::eof())) {
    deal_with_invalid_input(std::cin);
} 
```

实际上没有任何方法可以返回已读取的字符。由于这在很多地方都不是很好用，因此将这个函数打包成一个合适的[`std::num_get<char>`](http://en.cppreference.com/w/cpp/locale/num_get)facet 和`imbue()`对应的流可能是合理的`std::locale`。尽管处理代码的表达式实际上更简单，但这有点高级。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T23:36:03.433

您正在尝试使用 cin 读取不同类型的值。

`istream`重载`>>`运算符以匹配您期望从输入中获得的数据类型，并且`cin`是`istream`该类的一个实例。

当期望的类型是整数时，它将消耗字符到一个可以转换为整数的字符串，并将剩余的字符留在流中以供以后解析。浮点值或其他简单类型也会发生同样的情况。有关运算符及其开箱即用支持的类型的更多详细信息，请参阅[此参考页面。](http://www.cplusplus.com/reference/iostream/istream/operator%3E%3E/)底线是，如果您想要一个整数值，但期望输入的浮点值，您必须使用要从输入解析的正确类型的值（此处为浮点），并在稍后进行任何需要的转换（此处使用`trunc`,`floor`或`ceil`任何符合您需要的舍入函数）。

这是一个简单的例子：

```
#include <iostream>
#include <string>

using namespace std;

int main() {

    float f;
    string str;

    cout << "please enter a float :";
    cin >> f;

    cout << "value entered : " << f << endl;

    cout << "stream error : " 
         << (cin.fail() ? "yes" : "no") 
         << endl;

    cin >> str;

    cout << "remaining data : " << str << endl;

} 
```

这个非常简单的程序演示了`>>`istream 上运算符的使用，特别是预期的浮点值。对于以下输入：“1.2345Z6789”（注意数字中间的**Z**），程序将解析值“1.2345”并将“Z6789”保留在输入缓冲区中，以供后续读取。

如果您替换`f`from `float`to的类型`int`，则程序在同一输入上将读取值“1”，并在输入缓冲区中保留“.2345Z6789”。

注意：在您的代码中，您使用`!`运算符来测试流的状态，这相当于`fail`我在示例中使用的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T22:50:03.697

您需要在验证之前阅读完整的输入。您可以使用`cin.getline()`or`getline()`来执行此操作，然后检查输入是否是您想要的。

# c# - 将网站项目转换为 Web 应用程序项目

> ID：13370191
> 
> 赞同：0
> 
> 时间：2012-11-13T22:43:26.680
> 
> 标签：c#, asp.net, .net, visual-studio-2010, .net-3.5

我正在将我的网站项目转换为网络应用项目。我正在按照以下步骤操作：http: [//msdn.microsoft.com/en-us/library/aa983476%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/aa983476%28v=vs.100%29.aspx)

但是当我去构建时，我得到命名空间找不到错误。我所有的命名空间代码都在我的 App_Code 文件夹中，并且在我的网站项目中运行良好。

我错过了什么？app_code 不是 Web 应用程序项目的一部分吗？

# php - 访问多维对象变量

> ID：13370194
> 
> 赞同：1
> 
> 时间：2012-11-13T22:44:03.930
> 
> 标签：php, object, multidimensional-array

我有一个看起来像这样的对象：

```
stdClass Object
(
[data] => stdClass Object
    (
        [users] => stdClass Object
            (
                [831C7119-FAEF-49AF-B95B-50FB492B4ACB] => stdClass Object
                    (
                        [lastName] => somename
                        [username] => email@email.com
                        [userExtId] => 831C7119-FAEF-49AF-B95B-50FB492B4ACB
                        [fullName] => somename somename
                        [firstName] => somename
                        [displayName] => bla bla bla
                        [extId] => 831C7119-FAEF-49AF-B95B-50FB492B4ACB
                        [password] => 12345678
                    ) 
```

是否可以访问说 $object->data->users->lastname ？

编辑：

```
function objectToArray($d) {
    if (is_object($d))
        $d = get_object_vars($d);
    return is_array($d) ? array_map(__METHOD__, $d) : $d;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T22:44:45.690

看看为此使用[变量变量](http://php.net/manual/language.variables.variable.php)语法：

```
$object->data->users->{'831C7119-FAEF-49AF-B95B-50FB492B4ACB'}->lastName 
```

如果您想将整个对象转换为数组（[source](http://www.if-not-true-then-false.com/2009/php-tip-convert-stdclass-object-to-multidimensional-array-and-convert-multidimensional-array-to-stdclass-object/)）：

```
function objectToArray($d) {
    if (is_object($d))
        $d = get_object_vars($d);
    return is_array($d) ? array_map(__METHOD__, $d) : $d;
} 
```

```
$arr = objectToArray($object);
$arr['data']['users']['831C7119-FAEF-49AF-B95B-50FB492B4ACB']['lastName'] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T22:45:43.570

尝试：

```
$object->data->users->{'831C7119-FAEF-49AF-B95B-50FB492B4ACB'}->lastName; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-07T17:07:47.860

`$user`在具有二维的多维关联数组中，您通常访问命名键，例如

```
echo $user[413]['name']; 
```

如果您有一个`$user`与上述数组具有相同结构的对象，您可以通过这种方式访问​​属性

```
echo $user[413]->name; 
```

# asp.net - ASP.NET Web Api HttpPost 任务返回 204 而不是 201

> ID：13370196
> 
> 赞同：0
> 
> 时间：2012-11-13T22:44:09.217
> 
> 标签：asp.net, asp.net-mvc, asp.net-web-api

我正在使用 ASP.NET Web Api，其中一种方法公开为 POST 操作。它工作正常，但它返回的 HTTP Result 为 204 而不是预期的 201。这是方法定义：

```
[HttpPost][ActionName("Save")]
public Task SaveGameState(Guid instanceId, [FromBody] ComparisonGameState state)
{
    return gameInstancesClient.SaveGameState(instanceId, state);
} 
```

它返回 Task 的事实是否会混淆 Web Api？

我可以改为执行以下操作，但这似乎有点矫枉过正：

```
[HttpPost][ActionName("Save")]
public async Task<HttpResponseMessage> SaveGameState(Guid instanceId, [FromBody] ComparisonGameState state)
{
    await gameInstancesClient.SaveGameState(instanceId, state);
    return new HttpResponseMessage { StatusCode = System.Net.HttpStatusCode.Created };
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T23:34:50.330

尝试将操作定义中的任务类型更改为 HttpResponseMessage 的任务。在内部，WebAPI 将非泛型任务视为返回 void，因此它会返回 204。如果您的任务返回 HttpResponseMessage，请确保将返回类型更改为 HttpResponseMessage 的 Task。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:15:57.840

除非进一步输入，这似乎是唯一可行的解​​决方案：

```
[HttpPost][ActionName("Save")]
public async Task<HttpResponseMessage> SaveGameState(Guid instanceId, [FromBody] ComparisonGameState state)
{
    await gameInstancesClient.SaveGameState(instanceId, state);
    return new HttpResponseMessage { StatusCode = System.Net.HttpStatusCode.Created };
} 
```

# java - ProcessBuilder 不会触发

> ID：13370202
> 
> 赞同：0
> 
> 时间：2012-11-13T22:44:26.723
> 
> 标签：java, process, environment-variables, processbuilder

我有一个流程构建器，但由于某种原因它不起作用..我有一个名为“test.jar”的 jar 文件它有一个类，带有这个代码..

```
package me.thefiscster510.debugger;

public class Main {
    public static void main(String[] args){
        System.out.print(System.getenv("APPDATA"));
        System.exit(0);
    }
} 
```

然后我有另一个有按钮的罐子，这是按钮事件处理程序..

```
public class buttonhandler implements ActionListener{

    @Override
    public void actionPerformed(ActionEvent arg0){
        // TODO Auto-generated method stub
        ProcessBuilder pb;
        try {
            pb = new ProcessBuilder("java", "-jar", "test.jar");
            pb.environment().put("APPDATA", textfield.getText() == null ? System.getenv("APPDATA") : textfield.getText());
            Process p = pb.start();
        }catch(IOException e){
            e.printStackTrace();
        }

    }

} 
```

代码没有做任何事情..就像，它只是坐在那里..没有在控制台中放任何东西，什么都没有..有人能告诉我发生了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-04T23:55:38.130

如果您使用的是 Java7，则应`pb.inheritIO()`在开始该过程之前调用。这会将进程的标准输出和错误重定向到父 java 进程的流。然后你应该看到它输出到控制台。

如果您不在 Java7 上，那么您需要通过调用来捕获子进程的标准输出，`p.getInputStream()` 然后您可以将该数据复制到您的标准输出。最简单的方法是使用[IOUtils.copy](http://commons.apache.org/proper/commons-io/javadocs/api-2.4/org/apache/commons/io/IOUtils.html#copy%28java.io.InputStream,%20java.io.Writer%29)

# google-chrome - 允许对我之前拒绝的网站使用地理位置

> ID：13370203
> 
> 赞同：13
> 
> 时间：2012-11-13T22:44:27.033
> 
> 标签：google-chrome, browser, geolocation

曾经我拒绝一个网站来获取我的地理位置信息，但现在我希望它这样做。我怎么能允许这个？

我试图在 webbrowser 设置中找到它，但没有成功。

基本上我需要这个用于 Chrome，但我会很高兴（对于其他用户）看到其他浏览器的解决方案。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-13T22:50:55.660

Chrome 版本 23.0.1271.64 应该会在地址栏右侧显示一个位置被拒绝图标，单击该图标会显示明确的选项。

或者，您可以在设置->高级->内容设置->位置->管理例外下找到设置

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-04T00:37:39.540

只需使用这个很酷的说明。我希望它会有用。

[https://support.google.com/chrome/answer/142065?hl=en](https://support.google.com/chrome/answer/142065?hl=en)

[![在此处输入图像描述](../Images/e05e57dcb6cf0e3218c1d5aa83aba66c.png)](https://i.stack.imgur.com/bUScx.png)

# c# - Linq to SQL 检查数据是否存在并更新/插入取决于

> ID：13370204
> 
> 赞同：1
> 
> 时间：2012-11-13T22:44:29.930
> 
> 标签：c#, sql, database, linq

**编辑：代码更新**

我有以下代码，但它不起作用，它会进行无限循环并添加数千行我想检查是否有任何行具有我指定的值，如果没有，则插入它，如果是，只需更新两列.

您将看到 Servicio.Value == "PAS" 的 IF 语句，这是因为，如果服务是 "PAS"，它在表 Umbrales 上有一个名为 modulo_id 的列（应该插入所有内容）以及要返回的查询值更改为 PAS 表而不是 Banksphere 表...如果您知道更好的方法来处理此问题，我们将不胜感激，因为我认为这太混乱了..

```
 checkcenterDBDataContext dc = new checkcenterDBDataContext();
        int intOkMas = Convert.ToInt32(txtUmbralOkMas.Text);
        int intOkMenos = Convert.ToInt32(txtUmbralOkMenos.Text);
        var days = GetDaysLikeMe(DateTime.Today).Take(50).Where(d => d.Date.Day < 28 && d.Date.Day > 1).Take(4);

        XDocument xDoc = XDocument.Load("Settings.xml");
        var Entidades =
            from ent in xDoc.Root.Elements("Entidad")
            select ent;
        foreach (var entidad in Entidades)
        {
            var Servicios =
                from serv in entidad.Element("Servicios").Elements("ServName")
                select serv;
            foreach (var servicio in Servicios)
            {
                if (servicio.Value == "PAS")
                {
                    Umbrales newUmbral = new Umbrales();
                    var Modulos =
                        from mod in entidad.Element("Servicios").Elements("ModName")
                        select mod;
                    foreach (var modulo in Modulos)
                    {
                        for (int i = 0; i <= 2; i++)
                        {
                            var valores =
                                from b in dc.PAS
                                where
                                b.Modulos.nombre == modulo.Value &&
                                b.Entidades.nombre == entidad.Element("Nombre").Value &&
                                b.peticion_id == i
                                && days.Contains(Convert.ToDateTime(b.fecha))
                                orderby b.id descending
                                select b;

                            var medias =
                                from b in valores
                                group b.valor by new { b.hora_id, b.dia_id, b.entidad_id, b.modulo_id, b.peticion_id } into hg
                                orderby hg.Key.hora_id descending
                                select new
                                {
                                    Hora = hg.Key.hora_id,
                                    Dia = hg.Key.dia_id,
                                    Entidad = hg.Key.entidad_id,
                                    Modulo = hg.Key.modulo_id,
                                    Peticion = hg.Key.peticion_id,
                                    Maximo = Math.Round(System.Convert.ToDouble(hg.Average() + ((hg.Average() * intOkMas) / 100)), 3, MidpointRounding.AwayFromZero),
                                    Minimo = Math.Round(System.Convert.ToDouble(hg.Average() - ((hg.Average() * intOkMenos) / 100)), 3, MidpointRounding.AwayFromZero)
                                };

                            foreach (var med in medias)
                            {
                                var update_medias =
                                    (from um in dc.Umbrales
                                     where
                                     um.hora_id == med.Hora
                                     && um.dia_id == med.Dia
                                     && um.entidad_id == med.Entidad
                                     && um.servicio_id == 3
                                     && um.peticion_id == med.Peticion
                                     && um.modulo_id == med.Modulo
                                     select um).ToList();
                                if (update_medias.Any())
                                {
                                    foreach (var ume in update_medias)
                                    {
                                        ume.maximo = Convert.ToDecimal(med.Maximo);
                                        ume.minimo = Convert.ToDecimal(med.Minimo);
                                        dc.SubmitChanges();
                                    }
                                }
                                else
                                {
                                    newUmbral.hora_id = med.Hora;
                                    newUmbral.dia_id = med.Dia;
                                    newUmbral.entidad_id = med.Entidad;
                                    newUmbral.servicio_id = 3;
                                    newUmbral.peticion_id = med.Peticion;
                                    newUmbral.modulo_id = med.Modulo;
                                    newUmbral.maximo = Convert.ToDecimal(med.Maximo);
                                    newUmbral.minimo = Convert.ToDecimal(med.Minimo);
                                    dc.Umbrales.InsertOnSubmit(newUmbral);
                                    dc.SubmitChanges();
                                }
                            }

                        }
                    }
                }
                else
                {
                    Umbrales newUmbral = new Umbrales();
                    for (int i = 0; i <= 2; i++)
                    {
                        var valores =
                            from b in dc.Banksphere
                            where
                            b.Servicios.nombre == servicio.Value &&
                            b.Entidades.nombre == entidad.Element("Nombre").Value &&
                            b.peticion_id == i
                            && days.Contains(Convert.ToDateTime(b.fecha))
                            orderby b.id descending
                            select b;

                        var medias =
                            from b in valores
                            group b.valor by new { b.hora_id, b.dia_id, b.entidad_id, b.servicio_id, b.peticion_id } into hg
                            orderby hg.Key.hora_id descending
                            select new
                            {
                                Hora = hg.Key.hora_id,
                                Dia = hg.Key.dia_id,
                                Entidad = hg.Key.entidad_id,
                                Servicio = hg.Key.servicio_id,
                                Peticion = hg.Key.peticion_id,
                                Maximo = Math.Round(System.Convert.ToDouble(hg.Average() + ((hg.Average() * intOkMas) / 100)), 3, MidpointRounding.AwayFromZero),
                                Minimo = Math.Round(System.Convert.ToDouble(hg.Average() - ((hg.Average() * intOkMenos) / 100)), 3, MidpointRounding.AwayFromZero)
                            };

                        foreach (var med in medias)
                        {
                            var update_medias =
                                (from um in dc.Umbrales
                                 where
                                 um.hora_id == med.Hora
                                 && um.dia_id == med.Dia
                                 && um.entidad_id == med.Entidad
                                 && um.servicio_id == med.Servicio
                                 && um.peticion_id == med.Peticion
                                 select um).ToList();
                            if (update_medias.Any())
                            {
                                foreach (var ume in update_medias)
                                {
                                    ume.maximo = Convert.ToDecimal(med.Maximo);
                                    ume.minimo = Convert.ToDecimal(med.Minimo);
                                    dc.SubmitChanges();
                                }
                            }
                            else
                            {
                                newUmbral.hora_id = med.Hora;
                                newUmbral.dia_id = med.Dia;
                                newUmbral.entidad_id = med.Entidad;
                                newUmbral.servicio_id = med.Servicio;
                                newUmbral.peticion_id = med.Peticion;
                                newUmbral.maximo = Convert.ToDecimal(med.Maximo);
                                newUmbral.minimo = Convert.ToDecimal(med.Minimo);
                                dc.Umbrales.InsertOnSubmit(newUmbral);
                                dc.SubmitChanges();
                            }
                        }

                    }
                }
            }
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T22:49:35.710

`update_medias`永远不会为空。试试这个：

```
var update_medias = (from um in dc.Umbrales
where
um.hora_id == med.Hora
&& um.dia_id == med.Dia
&& um.entidad_id == med.Entidad
&& um.servicio_id == med.Servicio
&& um.peticion_id == med.Peticion
select um).FirstOrDefault(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T22:49:43.147

`update_medias`永远不会为空 - 它始终是一个尚未执行的查询。将其更改为：

```
var update_medias =
    (from um in dc.Umbrales
    where
    um.hora_id == med.Hora
    && um.dia_id == med.Dia
    && um.entidad_id == med.Entidad
    && um.servicio_id == med.Servicio
    && um.peticion_id == med.Peticion
    select um).ToList(); 
```

然后用这个而不是空检查来检查它

```
if (update_medias.Any()) 
```

# visual-studio-2012 - 如果 Typescript 位于子文件夹中，则无法编译？

> ID：13370205
> 
> 赞同：5
> 
> 时间：2012-11-13T22:44:33.540
> 
> 标签：visual-studio-2012, typescript

我在 VS2012 中有两个项目。一个是作为“带有 Typescript 的 HTML 应用程序”创建的，另一个是（一个 DLL），其中我将 Typescript 文件添加到现有项目（我将 BeforeBuild Target 添加到现有项目）。

当我编译 HTML App 项目时，它将 TS 编译为 JS 并添加 JS 作为内容。

当我编译我的 DLL 时，我没有从 TSC 中得到任何结果......无论是在我放置 TS 文件的文件夹中，还是在根目录或任何其他文件夹中......我没有收到任何错误或其他提示可能有什么问题.

在两个项目的属性中，TS 文件显示为：

```
BuildAction: TypeScriptCompile
Copy to output....: Do not copy 
```

在 .csproj 文件中，项目组内的部分如下所示：

```
<ItemGroup>
...(Lots of other "EmbeddedResources" in this ItemGroup)
    <TypeScriptCompile Include="C-DCommunication\ClientBin\CDEHTML5\cdeUX5.ts" />
    <Content Include="C-DCommunication\ClientBin\CDEHTML5\cdeUX5.js">
      <DependentUpon>cdeUX5.ts</DependentUpon>
    </Content>
...(more files in my ItemGroup)
</ItemGroup> 
```

在我看来，TSC 编译器没有正确解析路径。有人可以验证吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T09:15:10.097

当我将 TypeScript 添加到现有项目时，我倾向于将以下内容添加到我的项目文件中：

```
 <ItemGroup>
    <AvailableItemName Include="TypeScriptCompile" />
  </ItemGroup>
  <ItemGroup>
    <TypeScriptCompile Include="$(ProjectDir)\**\*.ts" />
  </ItemGroup>
  <Target Name="BeforeBuild">
    <Exec Command="&quot;$(PROGRAMFILES)\Microsoft SDKs\TypeScript\0.8.0.0\tsc&quot; @(TypeScriptCompile ->'&quot;%(fullpath)&quot;', ' ')" />
  </Target> 
```

[资源](http://www.stevefenton.co.uk/Content/Blog/Date/201210/Blog/Adding-TypeScript-To-An-Existing-Visual-Studio-Project/)

但是，如果您使用 Web Essentials Visual Studio 扩展，它会在保存时将 TypeScript 编译为 JavaScript，我发现这为开发提供了更好的流程。

# buildr - buildr 如何正确处理 unicode pom 文件？

> ID：13370210
> 
> 赞同：1
> 
> 时间：2012-11-13T22:45:06.000
> 
> 标签：buildr

我一直在尝试用 buildr 代替 maven 在一个项目中。

当我请求给定包的瞬态依赖项时，我收到此错误：

```
$ buildr --trace=all
...
** Invoke /home/tcc/timd/.m2/repository/org/slf4j/slf4j-api/1.5.6/slf4j-api-1.5.6.pom (first_time, not_needed)
Loading m2 pom file from /home/tcc/timd/.m2/repository/org/slf4j/slf4j-api/1.5.6/slf4j-api-1.5.6.pom
** Invoke /home/tcc/timd/.m2/repository/org/slf4j/slf4j-parent/1.5.6/slf4j-parent-1.5.6.pom (first_time, not_needed)
Loading m2 pom file from /home/tcc/timd/.m2/repository/org/slf4j/slf4j-parent/1.5.6/slf4j-parent-1.5.6.pom
** Invoke /home/tcc/timd/.m2/repository/org/apache/commons/commons-exec/1.0/commons-exec-1.0.pom (first_time, not_needed)
Loading m2 pom file from /home/tcc/timd/.m2/repository/org/apache/commons/commons-exec/1.0/commons-exec-1.0.pom
Buildr aborted!
ArgumentError : invalid byte sequence in US-ASCII
...
$ 
```

我可以确认文件 commons-exec-1.0.pom 有非 US-ASCII 字符。但我相信它们是有效的 UTF-8。

麻烦的文件来自第三方，所以我不能轻易更改它。我可以做些什么来让 buildr 正确处理它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T04:38:04.413

我相信 buildr 在 Ruby 1.9（或兼容）红宝石上读取 POM 的方式存在错误。它假定 POM 的 XML 可以在 ruby​​ 的默认外部编码中读取。在我使用 ruby​​ 1.9.3-p194 的机器上，编码为 UTF-8（因此 commons-exec POM 可以正常读取），但在您的环境中，默认编码似乎是 US-ASCII（导致您的问题）。您可以通过在构建文件中放置`puts Encoding.default_external.inspect`某个位置并查看它为您提供的内容来确认这一点。

只要您希望构建器读取的所有文件都是 UTF-8（或 UTF-8 兼容，如 ASCII），您应该能够通过将以下内容放在构建文件的顶部来解决此问题：

```
Encoding.default_external = 'UTF-8' 
```

看看这是否有效。如果是这样，我鼓励您向 buildr 提交错误，以便他们了解问题。（一般来说，你不想被弄乱，`Encoding.default_external`因为它是一个全局设置。）

# .net - .NET 问题的 WebDAV 服务器引擎

> ID：13370214
> 
> 赞同：1
> 
> 时间：2012-11-13T22:45:21.693
> 
> 标签：.net, webdav

1.  在某些自定义文档状态适用的情况下，如何强制以只读模式打开文件？例如，一个文档可以经历不同的阶段：创建、审查、批准。一旦它被批准，任何人都不能修改它。

2.  如何通过适用于 .NET api 的 WebDAV 服务器引擎告诉客户端某些操作不受支持，例如移动和复制文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T00:01:28.480

> “如何强制以只读模式打开文件...”

如果您使用 Windows 资源管理器（Windows Shell/Miniredirector/WebFolders）和 MS Office，您可以实现[IMsItem](http://doc3.webdavsystem.com/ITHit.WebDAV.Server.MicrosoftExtensions.IMsItem.html)，它将返回项目的文件属性。在您的 IMsItem.GetFileAttributes 方法实现中添加只读标志：

```
/// <summary>
/// Returns Windows file attributes (readonly, hidden etc.) for this file/folder.
/// </summary>
/// <returns>Windows file attributes.</returns>
public FileAttributes GetFileAttributes()
{
    if (Name.StartsWith("."))
    {
        return fileSystemInfo.Attributes | FileAttributes.Hidden;
    }
    return fileSystemInfo.Attributes | FileAttributes.ReadOnly;
} 
```

但是，此代码实际上并不能保护您的文件不被其他用户/应用程序覆盖。要保护文件不被修改，您必须检查用户是否有足够的权限在您的[IFile.Write](http://doc3.webdavsystem.com/ITHit.WebDAV.Server.IContent.Write.html)实现中修改文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T18:54:51.107

如果您想在所有情况下都禁止复制和移动操作，请这样做：

```
public override void CopyTo(IItemCollection folder, string destName, bool deep, MultistatusException multistatus)
{
    throw new DavException("Cannot copy resource", DavStatus.NOT_ALLOWED);
}

public override void MoveTo(IItemCollection folder, string destName, MultistatusException multistatus)
{
    throw new DavException("Cannot move resource", DavStatus.NOT_ALLOWED);
} 
```

如果您想根据某些条件禁止复制/移动/更改资源，我建议您使用自定义处理程序：

```
public Service(ILogger logger, bool isApplication)
{
    ...
    MyCustomPutHandler handler = new MyCustomPutHandler();
    handler.OriginalHandler = engine.RegisterMethodHandler("PUT", handler);
}

internal class MyCustomPutHandler : IMethodHandler
{
    public IMethodHandler OriginalHandler { get; set; }

    public void ProcessRequest(DavContextBase context, IHierarchyItem item)
    {
        if(<check condition>)
        {
            throw new DavException("Cannot change resource", DavStatus.Conflict);
        }
        if (item is IFolder)
        {
            ...
        }
        else
        {
            OriginalHandler.ProcessRequest(context, item);
        }
    }
     ......
} 
```

希望这会帮助你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T21:00:41.983

> “我如何通过 WebDAV Server Engine for .NET api 告诉客户端某些操作不受支持，例如移动和复制文件。”

假设您可以从响应 OPTIONS 请求返回的 Allow 和 Public 标头中删除 remove COPY 和 MOVE 动词（参见下面的示例）。您需要致电：

```
engine.RegisterMethodHandler("COPY", null);
engine.RegisterMethodHandler("MOVE", null); 
```

但是，根据我的经验，Microsoft Miniredirector 和 Microsoft Office 之后可能会变得无法使用。Microsoft Office 可能会以只读方式打开文件。如果您需要支持 MS Office 和 Miniredirector，我建议将所有动词保留在 Allow 和 Public 标题中。正如塔拉斯在他的回答中建议的那样，只需在 CopyTo 和 MoveTo 实现中抛出 DavException 即可。

选项请求示例：

```
OPTIONS http://ajaxbrowser.com/Userb7d072f HTTP/1.1
translate: f
User-Agent: Microsoft-WebDAV-MiniRedir/6.0.6002
Host: ajaxbrowser.com
Content-Length: 0
Connection: Keep-Alive

HTTP/1.1 200 OK
Allow: COPY, DELETE, GET, HEAD, LOCK, MOVE, OPTIONS, POST, PROPFIND, PROPPATCH, PUT, REPORT, UNLOCK
Content-Length: 0
Accept-Ranges: bytes
Server: Microsoft-HTTPAPI/1.0
Access-Control-Allow-Origin: *
Access-Control-Allow-Credentials: true
Access-Control-Allow-Methods: ACL, CANCELUPLOAD, CHECKIN, CHECKOUT, COPY, DELETE, GET, HEAD, LOCK, MKCALENDAR, MKCOL, MOVE, OPTIONS, POST, PROPFIND, PROPPATCH, PUT, REPORT, UNCHECKOUT, UNLOCK, UPDATE, VERSION-CONTROL
Access-Control-Allow-Headers: Overwrite, Destination, Content-Type, Depth, User-Agent, Translate, Range, Timeout, X-File-Size, X-Requested-With, If-Modified-Since, X-File-Name, Cache-Control
Access-Control-Max-Age: 2147483647
X-Engine: IT Hit WebDAV Server .Net v3.0.556.0 (Evaluation License)
DAV: 1, 2, 3
Public: COPY, DELETE, GET, HEAD, LOCK, MOVE, OPTIONS, POST, PROPFIND, PROPPATCH, PUT, REPORT, UNLOCK
MS-Author-Via: DAV
Date: Fri, 23 Nov 2012 20:26:51 GMT 
```

# java - PersistentObjectException：分离的实体传递给 JPA 和 Hibernate 抛出的持久化

> ID：13370221
> 
> 赞同：296
> 
> 时间：2012-11-13T22:45:46.250
> 
> 标签：java, hibernate, jpa, entity, persist

我有一个包含多对一关系的 JPA 持久对象模型：一个`Account`有很多`Transactions`. A`Transaction`有一个`Account`。

这是代码片段：

```
@Entity
public class Transaction {
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;

    @ManyToOne(cascade = {CascadeType.ALL},fetch= FetchType.EAGER)
    private Account fromAccount;
....

@Entity
public class Account {
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;
    @OneToMany(cascade = {CascadeType.ALL},fetch= FetchType.EAGER, mappedBy = "fromAccount")
    private Set<Transaction> transactions; 
```

我能够创建一个`Account`对象，向它添加事务，并`Account`正确地保存该对象。但是，当我*使用现有的已持久化 Account*创建事务并持久*化 Transaction*时，出现异常：

> 引起：org.hibernate.PersistentObjectException：分离实体传递给持久化：com.paulsanwald.Account at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:141)

所以，我能够持久化一个`Account`包含事务的事务，但不能持久化一个具有`Account`. 我认为这是因为`Account`可能没有附加，但这段代码仍然给了我同样的异常：

```
if (account.getId()!=null) {
    account = entityManager.merge(account);
}
Transaction transaction = new Transaction(account,"other stuff");
 // the below fails with a "detached entity" message. why?
entityManager.persist(transaction); 
```

如何正确保存`Transaction`与已持久化`Account`对象关联的 , ？

* * *

## 回答 #1

> 赞同：348
> 
> 时间：2015-03-24T14:28:51.240

解决方案很简单，只需使用`CascadeType.MERGE`代替`CascadeType.PERSIST`or `CascadeType.ALL`。

我有同样的问题，`CascadeType.MERGE`并为我工作。

我希望你被排序。

* * *

## 回答 #2

> 赞同：145
> 
> 时间：2012-11-21T19:45:10.423

这是一个典型的双向一致性问题。在[此链接](http://meri-stuff.blogspot.com/2012/03/jpa-tutorial.html#RelationshipsBidirectionalOneToManyManyToOneConsistency)以及[此链接中对此进行了很好的讨论。](http://notesonjava.wordpress.com/2008/11/03/managing-the-bidirectional-relationship/)

根据前面 2 个链接中的文章，您需要在双向关系的两侧修复您的设置器。一侧的示例设置器在[此链接中。](https://github.com/SomMeri/org.meri.jpa.tutorial/blob/master/src/main/java/org/meri/jpa/relationships/entities/bestpractice/SafePerson.java)

许多方面的示例设置器在[此链接中。](https://github.com/SomMeri/org.meri.jpa.tutorial/blob/master/src/main/java/org/meri/jpa/relationships/entities/bestpractice/SafeTwitterAccount.java)

更正设置器后，您希望将实体访问类型声明为“属性”。声明“属性”访问类型的最佳实践是将所有注释从成员属性移动到相应的 getter。一个重要的词是不要在实体类中混合“字段”和“属性”访问类型，否则 JSR-317 规范未定义行为。

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2019-01-19T21:30:52.793

**从子实体中删除级联`Transaction`**，它应该只是：

```
@Entity class Transaction {
    @ManyToOne // no cascading here!
    private Account account;
} 
```

（`FetchType.EAGER`可以删除，它是默认的`@ManyToOne`）

**就这样！**

为什么？通过在子实体上说“全部级联”，`Transaction`您需要将每个数据库操作传播到父实体`Account`。如果你这样做`persist(transaction)`，`persist(account)`也会被调用。

但只有瞬态（新）实体可以传递给`persist`（`Transaction`在这种情况下）。分离的（或其他非瞬态状态）可能不会（`Account`在这种情况下，因为它已经在数据库中）。

因此，您会得到异常*“传递给持久化的分离实体”*。`Account`实体的意思！不是`Transaction`你呼吁`persist`的。

* * *

您通常不希望从孩子传播到父母。不幸的是，书籍（甚至是好书）和网络中有很多代码示例，它们正是这样做的。我不知道，为什么......也许有时只是一遍又一遍地复制而不加思考......

猜猜如果你`remove(transaction)`在那个@ManyToOne 中调用仍然有“cascade ALL”会发生什么？（`account`顺便说一句，所有其他事务！）也将从数据库中删除。但这不是你的本意，是吗？

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2017-12-15T13:33:18.920

不要将 id(pk) 传递给 persist 方法或尝试使用 save() 方法而不是 persist()。

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2019-09-15T06:02:06.247

## 删除子关联级联

因此，您需要`@CascadeType.ALL`从`@ManyToOne`关联中删除 。子实体不应级联到父关联。只有父实体应该级联到子实体。

```
@ManyToOne(fetch= FetchType.LAZY) 
```

请注意，我将`fetch`属性设置为，`FetchType.LAZY`因为急切获取对性能非常不利。

## 设置关联的双方

每当有双向关联时，都需要使用父实体中的`addChild`和方法同步双方：`removeChild`

```
public void addTransaction(Transaction transaction) {
    transcations.add(transaction);
    transaction.setAccount(this);
}

public void removeTransaction(Transaction transaction) {
    transcations.remove(transaction);
    transaction.setAccount(null);
} 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2015-07-13T13:15:09.080

使用合并既冒险又棘手，因此在您的情况下这是一个肮脏的解决方法。您至少需要记住，当您将实体对象传递给合并时，它会*停止*附加到事务，而是返回一个新的、现在附加的实体。这意味着如果任何人仍然拥有旧实体对象，则对其所做的更改将被静默忽略并在提交时被丢弃。

你没有在这里显示完整的代码，所以我不能仔细检查你的交易模式。解决这种情况的一种方法是，如果您在执行合并和持久化时没有活动的事务。在这种情况下，持久性提供程序应该为您执行的每个 JPA 操作打开一个新事务，并在调用返回之前立即提交和关闭它。如果是这种情况，合并将在第一个事务中运行，然后在合并方法返回后，事务完成并关闭，返回的实体现在被分离。然后，它下面的持久化将打开第二个事务，并尝试引用一个已分离的实体，从而给出异常。除非您非常清楚自己在做什么，否则请始终将您的代码包装在事务中。

使用容器管理的事务，它看起来像这样。请注意：这假定该方法位于会话 bean 内并通过本地或远程接口调用。

```
@TransactionAttribute(TransactionAttributeType.REQUIRED)
public void storeAccount(Account account) {
    ...

    if (account.getId()!=null) {
        account = entityManager.merge(account);
    }

    Transaction transaction = new Transaction(account,"other stuff");

    entityManager.persist(account);
} 
```

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2012-11-13T23:02:34.137

可能在这种情况下，您`account`使用合并逻辑获得了对象，并`persist`用于持久化新对象，如果层次结构具有已持久化的对象，它将抱怨。您应该`saveOrUpdate`在这种情况下使用，而不是`persist`.

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2019-10-22T21:09:38.390

我基于 Spring Data JPA 的答案：我只是`@Transactional`在我的外部方法中添加了一个注释。

### 为什么有效

由于没有活动的 Hibernate Session 上下文，子实体立即变得分离。提供 Spring (Data JPA) 事务可确保存在 Hibernate Session。

### 参考：

[https://vladmihalcea.com/a-beginners-guide-to-jpa-hibernate-entity-state-transitions/](https://vladmihalcea.com/a-beginners-guide-to-jpa-hibernate-entity-state-transitions/)

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2012-11-13T23:12:12.997

在您的实体定义中，您没有为连接到 a指定[@JoinColumn](http://docs.oracle.com/javaee/6/api/index.html?javax/persistence/Persistence.html)。你会想要这样的东西：`Account``Transaction`

```
@Entity
public class Transaction {
    @ManyToOne(cascade = {CascadeType.ALL},fetch= FetchType.EAGER)
    @JoinColumn(name = "accountId", referencedColumnName = "id")
    private Account fromAccount;
} 
```

编辑：好吧，我想如果你`@Table`在课堂上使用注释会很有用。呵呵。:)

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2016-08-04T23:03:43.230

如果没有任何帮助并且您仍然遇到此异常，请检查您的`equals()`方法 - 并且不要在其中包含子集合。尤其是如果您具有嵌入式集合的深层结构（例如 A 包含 Bs，B 包含 Cs 等）。

例如`Account -> Transactions`：

```
 public class Account {

    private Long id;
    private String accountName;
    private Set<Transaction> transactions;

    @Override
    public boolean equals(Object obj) {
      if (this == obj)
        return true;
      if (obj == null)
        return false;
      if (!(obj instanceof Account))
        return false;
      Account other = (Account) obj;
      return Objects.equals(this.id, other.id)
          && Objects.equals(this.accountName, other.accountName)
          && Objects.equals(this.transactions, other.transactions); // <--- REMOVE THIS!
    }
  } 
```

`equals()`在上面的示例中，从支票中删除交易。这是因为 hibernate 将暗示您不会尝试更新旧对象，而是在您更改子集合上的元素时传递一个新对象以持久保存。
当然，此解决方案并不适合所有应用程序，您应该仔细设计要包含在`equals`和`hashCode`方法中的内容。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2021-03-10T12:45:47.637

一个老问题，但最近遇到了同样的问题。在这里分享我的经验。

实体

```
@Data
@Entity
@Table(name = "COURSE")
public class Course  {

    @Id
    @GeneratedValue
    private Long id;
} 
```

保存实体 (JUnit)

```
Course course = new Course(10L, "testcourse", "DummyCourse");
testEntityManager.persist(course); 
```

使固定

```
Course course = new Course(null, "testcourse", "DummyCourse");
testEntityManager.persist(course); 
```

**结论：**如果实体类具有主键（id）的@GeneratedValue，则确保您没有传递主键（id）的值

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2016-06-17T13:17:34.987

即使您的注释被正确声明以正确管理一对多关系，您仍然可能会遇到这个精确的异常。向附加数据模型添加新的子对象时，`Transaction`您需要管理主键值 -*除非您不应该这样做*。如果在调用之前为声明如下的子实体提供主键值`persist(T)`，则会遇到此异常。

```
@Entity
public class Transaction {
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;
.... 
```

在这种情况下，注释声明数据库将在插入时管理实体主键值的生成。自己提供一个（例如通过 Id 的设置器）会导致此异常。

或者，但实际上相同，此注释声明导致相同的异常：

```
@Entity
public class Transaction {
    @Id
    @org.hibernate.annotations.GenericGenerator(name="system-uuid", strategy="uuid")
    @GeneratedValue(generator="system-uuid")
    private Long id;
.... 
```

因此，当它已经被管理时，不要`id`在应用程序代码中设置它。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-07-05T15:54:06.277

也许这是 OpenJPA 的错误，回滚时它会重置 @Version 字段，但 pcVersionInit 保持真实。我有一个 AbstraceEntity 声明了 @Version 字段。我可以通过重置 pcVersionInit 字段来解决它。但这不是一个好主意。我认为当有级联持久实体时它不起作用。

```
 private static Field PC_VERSION_INIT = null;
    static {
        try {
            PC_VERSION_INIT = AbstractEntity.class.getDeclaredField("pcVersionInit");
            PC_VERSION_INIT.setAccessible(true);
        } catch (NoSuchFieldException | SecurityException e) {
        }
    }

    public T call(final EntityManager em) {
                if (PC_VERSION_INIT != null && isDetached(entity)) {
                    try {
                        PC_VERSION_INIT.set(entity, false);
                    } catch (IllegalArgumentException | IllegalAccessException e) {
                    }
                }
                em.persist(entity);
                return entity;
            }

            /**
             * @param entity
             * @param detached
             * @return
             */
            private boolean isDetached(final Object entity) {
                if (entity instanceof PersistenceCapable) {
                    PersistenceCapable pc = (PersistenceCapable) entity;
                    if (pc.pcIsDetached() == Boolean.TRUE) {
                        return true;
                    }
                }
                return false;
            } 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-08-28T12:29:35.203

您需要为每个账户设置交易。

```
foreach(Account account : accounts){
    account.setTransaction(transactionObj);
} 
```

或者在许多方面将 ids 设置为 null 就足够了（如果合适的话）。

```
// list of existing accounts
List<Account> accounts = new ArrayList<>(transactionObj.getAccounts());

foreach(Account account : accounts){
    account.setId(null);
}

transactionObj.setAccounts(accounts);

// just persist transactionObj using EntityManager merge() method. 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-08-23T13:46:00.250

```
cascadeType.MERGE,fetch= FetchType.LAZY 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2020-03-30T11:17:28.770

通过在下一个之前保存依赖对象来解决。

这发生在我身上，因为我没有设置 Id（不是自动生成的）。并尝试保存关系@ManytoOne

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-03-05T13:36:47.773

在我的情况下，当使用**持久**方法时，我正在提交事务。在更改**持久****保存**方法时，它得到了解决。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-08-22T10:08:53.260

如果上述解决方案不起作用，只需注释一次实体类的 getter 和 setter 方法，并且不要设置 id.(Primary key) 的值，那么这将起作用。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-09-01T09:26:42.413

@OneToMany(mappedBy = "xxxx", cascade={CascadeType.MERGE, CascadeType.PERSIST, CascadeType.REMOVE}) 为我工作。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-06-14T03:26:38.943

这是我的修复。

下面是我的实体。标记 id 用 @GeneratedValue(strategy = GenerationType.AUTO) 注释，这意味着 id 将由 Hibernate 生成。**创建实体对象时不要设置**。**因为这将由 Hibernate 自动生成。** 请注意，如果实体 id 字段没有用@GeneratedValue 标记，那么不手动分配 id 值也是一种犯罪，这将遇到**IdentifierGenerationException：必须在调用 save() 之前手动分配此类的 id**

```
@Entity
@Data
@NamedQuery(name = "SimpleObject.findAll", query="Select s FROM SimpleObject s")
public class SimpleObject {

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;

    @Column
    private String key;

    @Column
    private String value;

} 
```

这是我的主要课程。

```
public class SimpleObjectMain {

    public static void main(String[] args) {

        System.out.println("Hello Hello From SimpleObjectMain");

        SimpleObject simpleObject = new SimpleObject();
        simpleObject.setId(420L); // Not right, when id is a generated value then no need to set this.
        simpleObject.setKey("Friend");
        simpleObject.setValue("Bani");

        EntityManager entityManager = EntityManagerUtil.getEntityManager();
        entityManager.getTransaction().begin();
        entityManager.persist(simpleObject);
        entityManager.getTransaction().commit();

        List<SimpleObject> simpleObjectList = entityManager.createNamedQuery("SimpleObject.findAll").getResultList();
        for(SimpleObject simple : simpleObjectList){
            System.out.println(simple);
        }

        entityManager.close();

    }
} 
```

当我尝试保存它时，它正在抛出那个

```
PersistentObjectException: detached entity passed to persist. 
```

我需要修复的只是删除 main 方法中 simpleObject 的 id 设置行。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-10-20T10:54:56.633

我遇到此问题的另一个原因是事务中的实体不是由 Hibernate 版本化的。

为所有映射实体添加`@Version`注释

```
@Entity
public class Customer {

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private UUID id;

    @Version
    private Integer version;

    @OneToMany(cascade = CascadeType.ALL)
    @JoinColumn(name = "orders")
    private CustomerOrders orders;

} 
```

```
@Entity
public class CustomerOrders {

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private UUID id;

    @Version
    private Integer version;

    private BigDecimal value;

} 
```

# php - 客户网站的 Twitter oAuth

> ID：13370223
> 
> 赞同：0
> 
> 时间：2012-11-13T22:45:56.530
> 
> 标签：php, wordpress, twitter, twitter-oauth

我需要为每个客户网站创建一个 oAuth 应用程序，还是可以创建一个并使用自己的？如果我需要为每个客户创建一个，我需要使用他们的登录信息还是可以只使用我的并在应用程序中定义他们的网站？

我正在尝试将我的所有客户更新到 Twitter API 1.1，但我希望已经通过一些建议完成了这个！我曾经在 WordPress 中使用 SimplePie，只是为了获取客户的 Twitter 状态或他们通过 v1 API 中的 ATOM 创建的列表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T22:51:15.623

您应该为每个客户端创建一个 oAuth 应用程序。无论技术可行性如何，这些应用程序在语义上并不相同，用户不应该无意中授予所有应用程序的权限，而他们只是想加入一个应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T03:01:37.053

最简单的方法是构建一个接受每个用户授权凭据作为参数的插件。这样，您将只有一个代码库，可以在您的所有站点上部署。唯一潜在的麻烦是让您的客户在他们的 Twitter 帐户中授权该应用程序。

# javascript - jQuery autoAnchors.js 插件发布到侧边栏

> ID：13370225
> 
> 赞同：2
> 
> 时间：2012-11-13T22:46:03.533
> 
> 标签：javascript, jquery, plugins

我正在使用[autoAnchors.js](http://fredibach.ch/jquery-plugins/autoanchors.php)

我希望这个脚本： 1\. 搜索 H1 标签 2\. 为这些创建锚点 3\. 将这些的 MENU 发布到另一个 div (#sidebar)

目前该脚本将执行[1](http://fredibach.ch/jquery-plugins/autoanchors.php)和 [2]，但会将菜单发布到相同 id/class 的顶部，而不是单独的。

看起来我需要更改：将其返回以将菜单发布到其他地方。

任何支持将不胜感激。

这是当前脚本：

```
(function($) {

    $.fn.autoAnchors=function(settings){
        var defaults = {
            anchor: 'h2',
            title: '',
            numbering: false
        };
        var s = $.extend(defaults, settings);

        var mcnt = 0;
        this.each( function() {
            mcnt++;

            var links = '<div class="autoanchors">';
            if (s.title){
                links += s.title;
            }
            links += '<ul>';

            var cnt = 0;
            $(this).find(s.anchor).each( function() {
                cnt++;

                var title = $(this).text();
                var filteredtitle = title.replace(/[^a-zA-Z0-9\s]+/g,'').replace(/\s/g,'_');

                if (s.numbering){
                    title = '<span class="numbering">'+cnt+'</span>'+title;
                    $(this).html('<span class="numbering">'+cnt+'</span>'+$(this).html());
                }

                links += '<li><a href="#'+mcnt+'.'+cnt+'.'+filteredtitle+'">'+title+'</a></li>';
                $(this).attr("id",mcnt+'.'+cnt+'.'+filteredtitle);
            });

            links += '</ul></div>';

            if (cnt > 0){
                $(this).prepend(links);
            }
        });

        return this;
    };

})(jQuery); 
```

我目前正在使用以下方法调用它：

```
$(".pageMainContent").autoAnchors( 
  {
    anchor: 'h1',
    title: '',
    numbering: false
  }
); 
```

# facebook-c#-sdk - 将照片发布到 Facebook 页面 c# sdk 仅对发布照片的用户可见

> ID：13370226
> 
> 赞同：1
> 
> 时间：2012-11-13T22:46:10.160
> 
> 标签：facebook-c#-sdk

再会，

在将照片发布到页面时遇到一个奇怪的问题，我可以使用预定的日期和时间发布带有评论的照片而不会出现问题。当我首先走到页面的墙上时，我看到这张照片坐在活动日志中等待发布。时间一到，照片就会出现在页面的墙上，我可以看到并评论照片。如果我找到其他人或通过非 Facebook 用户访问该页面，则图片不存在。我也尝试以另一个页面管理员身份登录，结果相同。

```
 var accessToken = Session["AccessToken"].ToString();
    var client = new FacebookClient(accessToken);
    dynamic result = client.Get("me", new { fields = "first_name,last_name,email,id" });

    string diplaymessage = string.Empty;
    diplaymessage = "Message";

    dynamic accounts = client.Get("me/accounts", new { limit = "25", offset = "0" });

    foreach (dynamic account in accounts.data) {
      if (account.category != "Application") {
        var pageclient = new FacebookClient(account.access_token);
        if (account.id == page.ID) {
          dynamic post = null;

          //if (product.Targeting != null) {
          dynamic parameters = new ExpandoObject();
          parameters.source = new FacebookMediaObject {
            ContentType = "image/" + product.Extension,
            FileName = path + filename
          }.SetValue(File.ReadAllBytes(path + filename));
          parameters.message = diplaymessage;
          if (product.DateScheduled < DateTime.Now) {
            parameters.scheduled_publish_time = Facebook.DateTimeConvertor.ToUnixTime(DateTime.Now.AddMinutes(15));
          } else {
            parameters.scheduled_publish_time = Facebook.DateTimeConvertor.ToUnixTime(product.DateScheduled);
          }
          parameters.published = false;
          try {
            post = pageclient.Post("/" + account.id + "/photos", parameters);

          } catch (Exception ex) {
            //error
          }
        }
      }
    } 
```

是否需要传递其他参数才能使其“公开”，即使在通过 facebook 检查照片的权限时它们似乎都是公开的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-07T19:35:51.063

终于找到了解决这个问题的办法。不再有“沙盒模式”的概念，您需要将应用程序设置为“实时”，这样可以确保它发布的任何帖子也可以公开，见下面的截图。

![应用程序设置 > 状态和审查 >](../Images/32f43c64f4331257d5d088afffa4e258.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-21T09:20:06.267

禁用 facebook 应用程序的沙盒模式。这将有助于将帖子展示给其他用户，而不仅仅是开发人员。

# android - Android - requestFocus 在 EditText 中不起作用

> ID：13370227
> 
> 赞同：1
> 
> 时间：2012-11-13T22:46:13.437
> 
> 标签：android

我面临着一个奇怪的情况。考虑下一段代码：
（XML）：

```
<EditText
    android:id="@+vistoria/CNPJTomador"
    android:inputType="number"
    android:maxLength="18"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" /> 
```

爪哇：

```
CNPJTomador = (EditText) findViewById(R.vistoria.CNPJTomador);
CNPJTomador.setOnFocusChangeListener(new View.OnFocusChangeListener() {
    public void onFocusChange(View v, boolean hasFocus) {
    if(!hasFocus && !Validation.isCNPJ(CNPJTomador.getText().toString())) {
        Toast.makeText(Checklist.this, "CNPJ inválido!", Toast.LENGTH_SHORT).show();
        CNPJTomador.requestFocus(); 
    }
    else if (!hasFocus && Validation.isCNPJ(CNPJTomador.getText().toString())) 
        CNPJTomador.setText(Validation.printCNPJ(CNPJTomador.getText().toString()));
    }
}); 
```

当用户转到另一个字段时，它应该进行数据验证并将焦点放回，以防出现任何错误。然而，此时系统变得疯狂。无法恢复焦点。如果我单击另一个 EditText，两者都会闪烁光标指示器，如下图所示：

[![图片](../Images/4631880932e13942bb39bf474d020276.png)](https://i.stack.imgur.com/t9ZC0.png)
[（来源：[painelflex.com.br](http://painelflex.com.br/rcfchecklist/screen.png)）]

如果我单击 EditText，它会触发其他 EditText 的事件......这完全是疯了。

以前有人遇到过这种情况吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T22:53:56.403

部分问题是您没有*阻止*当前事件将焦点传递给另一个视图，而是创建*另一个*事件以再次更改焦点......

无论如何，我建议不要将用户锁定到您的 EditText 中。如果数据不正确，只需用粗体、红色字体标记或在附近添加错误图标即可。不要试图劫持焦点或光标，这会造成糟糕的用户体验。

# matlab - 直方图之间的 Kullback-Leibler (KL) 距离 - matlab

> ID：13370229
> 
> 赞同：5
> 
> 时间：2012-11-13T22:46:27.937
> 
> 标签：matlab, image-processing

```
function [ d ] = hcompare_KL( h1,h2 )
%This routine evaluates the Kullback-Leibler (KL) distance between histograms. 
%             Input:      h1, h2 - histograms
%             Output:    d – the distance between the histograms.
%             Method:    KL is defined as: 
%             Note, KL is not symmetric, so compute both sides.
%             Take care not to divide by zero or log zero: disregard entries of the sum      for which with H2(i) == 0.

temp = sum(h1 .* log(h1 ./ h2));
temp( isinf(temp) ) = 0; % this resloves where h1(i) == 0 
d1 = sum(temp);

temp = sum(h2 .* log(h2 ./ h1)); % other direction of compare since it's not symetric
temp( isinf(temp) ) = 0;
d2 = sum(temp);

d = d1 + d2;

end 
```

我的问题是，每当 h1(i) 或 h2(i) == 0 时，我都会得到预期的 inf。但是在 KL 距离中，我假设每当他们 h1 或 h2 ==0 时返回 0 我怎么能在不使用循环的情况下做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T15:32:08.027

为避免在任何计数为 0 时出现问题，我建议您创建一个标记“好”数据点的索引：

```
%# you may want to do some input testing, such as whether h1 and h2 are
%# of the same size

%# preassign the output
d = zeros(size(h1));

%# create an index of the "good" data points
goodIdx = h1>0 & h2>0; %# bin counts <0 are not good, either

d1 = sum(h1(goodIdx) .* log(h1(goodIdx) . /h2(goodIdx)));
d2 = sum(h2(goodIdx) .* log(h2(goodIdx) . /h1(goodIdx)));

%# overwrite d only where we have actual data
%# the rest remains zero
d(goodIdx) = d1 + d2; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-20T10:22:12.373

我在您的实施中看到了一些错误。请按 log2 编辑日志

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-01T09:40:14.957

尝试使用

```
 d=sum(h1.*log2(h1+eps)-h1.*log2(h2+eps)) 
```

请注意，KL(h1,h2) 与 KL(h2,h1) 不同。你的情况是KL（h1，h2），对吗？我认为你的实现是错误的。它不是 h1 和 h2 之间的距离。定义了 h1 和 h2 之间的 KL 距离

```
KL(h1,h2)=sum(h1.log(h1/h2))=sum(h1.logh1-h2.logh2). 
```

所以正确的实现必须是

```
 d=sum(h1.*log2(h1+eps)-h1.*log2(h2+eps)) %KL(h1,h2) 
```

或者

```
 d=sum(h2.*log2(h2+eps)-h2.*log2(h1+eps)) %KL(h2,h1) 
```

# css - div 的 JSF/XHTML/CSS 'tableview'

> ID：13370230
> 
> 赞同：1
> 
> 时间：2012-11-13T22:46:41.100
> 
> 标签：css, jsf, jsf-2

我目前正在尝试迭代一个列表，该列表将为`<div>(...)</div>`每个值生成一个。这些 div 将表示为“块”（如下图所示）。问题是，我需要它们像一行一样对齐（所以新行从前一行的最低点开始）。

![在此处输入图像描述](../Images/b82cbb0b301b8a75e17d85ddd2e54a30.png)

当每行使用一个容器 div 时，这不会有问题，如下所示：

```
<div>
    <div>(...)</div>
    <div>(...)</div>
    <div>(...)</div>
</div>
<div>
    <div>(...)</div>
    <div>(...)</div>
    <div>(...)</div>
</div> 
```

虽然我不想使用容器 div，因为我需要在我的内部使用某些逻辑`<ui:repeat>(...)</ui:repeat>`来添加`</div><div>`每三个条目。

我也在 JSF 下发布这个，因为我希望**JSF**（或**PrimeFaces**或**Tomahawk**）有一个合适的解决方案。不过，如果**一个简单的 CSS 技巧**就足够了，那就完美了。

希望你能帮助我解决这个问题。

**注意：**使用表格的解决方案对我没有帮助，因为我会遇到`<tr>(...)</tr>`与上面描述的容器 div 相同的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:28:31.407

是否有不使用表格的语义原因？这很容易通过 和 的组合来`<h:panelGrid>`实现`<c:forEach>`。

```
<h:panelGrid columns="3">
    <c:forEach items="#{bean.items}" var="item">
        <h:panelGroup>#{item}</h:panelGroup>
    </c:forEach>
</h:panelGrid> 
```

它之所以这样工作，是因为`<c:forEach>`在视图构建期间运行并有效地生成物理上的多个`<h:panelGroup>`组件，以便它们正确地以每个作为`<h:panelGrid>`. 使用时它不会起作用，因为它仅在视图渲染期间运行，并且有效地作为视图构建期间`<ui:repeat>`的单个单元格结束。`<h:panelGrid>`

如果有不使用表的强大且有效的语义理由，那么您真的不能很好地绕过容器`<div>`来表示一行。

```
<div>
    <ui:repeat value="#{bean.items}" var="item" varStatus="loop">
        <h:outputText value="&lt;/div&gt;&lt;div&gt;" escape="false" rendered="#{not loop.first and loop.index % 3 == 0}" />
        <div>#{item}</div>
    </ui:repeat>
</div> 
```

### 也可以看看：

*   [JSF2 Facelets 中的 JSTL...有意义吗？](https://stackoverflow.com/questions/3342984/jstl-in-jsf2-facelets-makes-sense)
*   [JSF 2 ui:repeat: 对 div 中的每 n 个项目进行分组](https://stackoverflow.com/questions/10481742/jsf-2-uirepeat-group-every-n-items-inside-a-div)

# facebook - Facebook Like Button - appid 打破它

> ID：13370232
> 
> 赞同：0
> 
> 时间：2012-11-13T22:46:46.717
> 
> 标签：facebook, facebook-graph-api, facebook-like

我正在使用来自 facebook 的标准代码创建一个类似 facebook 的按钮。一切正常。

当我添加我的 appid 时，它会中断并且 facebook 之类的按钮消失了。

我正在添加应用程序 ID，如下所示，其中 111222333 是应用程序 ID：

```
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=111222333";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script> 
```

这有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T09:24:55.490

当您可以从此处生成具有应用程序 ID 的类似按钮代码时，为什么要单独附加应用程序 ID：

[https://developers.facebook.com/docs/reference/plugins/like/](https://developers.facebook.com/docs/reference/plugins/like/)

因此，没有任何权限问题，例如域不匹配或其他任何问题。它只允许给定 url 的正确应用程序。

# android - 从按钮单击开始的滑动动画

> ID：13370238
> 
> 赞同：0
> 
> 时间：2012-11-13T22:47:27.600
> 
> 标签：android, android-animation

我需要在android中实现滑动动画。我看过[这个](http://android-developers.blogspot.ru/2011/08/horizontal-view-swiping-with-viewpager.html)例子，但问题是我需要在按钮点击时开始动画并且在滑动时什么也不做。是否可以以某种简单的方式实施？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:28:05.850

你的问题很笼统。看看我对这篇文章的回答：[Problems an Animation an Android layout; 元素快速回到起始位置](https://stackoverflow.com/questions/13352534/problems-animating-an-android-layout-elements-snap-back-to-start-position/13353471#13353471)

您可以在按钮“OnClick()”中调用我作为示例给出的方法。

问候。

# xpages - 必须按两次按钮才能使部分刷新工作

> ID：13370241
> 
> 赞同：1
> 
> 时间：2012-11-13T22:48:08.817
> 
> 标签：xpages

背景：具有多个数据源的 Xpage。选项卡式表格的每一行都包含一个编辑面板，该面板绑定到与主页不同的数据源。每个页面都包含一个用于输入新文档的表格。这些文档是主文档的子文档。有一个视图控件可以立即显示用户创建的文档。表格中的按钮除了添加一些控制字段外，还保存了文档。它对editPanel 进行部分刷新。

最近我向条目表中的字段添加了验证。我使用一个功能，并防止从按钮以外的任何东西进行更新。我正在使用这篇博文中的 Tommy Valand 的方法：http: [//dontpanic82.blogspot.com/2010/03/xpages-making-validation-behave.html](http://dontpanic82.blogspot.com/2010/03/xpages-making-validation-behave.html)。如果我不使用 Tommy 的方法，那么验证器会在切换选项卡时触发，并且无用。

所有这些都有效，但我遇到了以下问题。1）我必须按两次按钮才能触发部分刷新。不仅如此，验证消息在按下按钮两次之前不会触发。在添加验证之前，第一部分仍然是一个问题。2) 刷新确实发生后表值不清除。这曾经在添加验证之前起作用。现在清除这些值的唯一方法是完全刷新 (F5)。

我真的只需要部分刷新才能表现得像它应该的那样。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:15:59.920

我正在回答我自己的问题，因为我认为我可能已经发现了为什么部分刷新表现如此不稳定。这是我解决问题的方法：每个选项卡都有一个编辑面板。如果我让编辑面板对其自身进行部分刷新，那么该面板上的按钮的行为似乎与您期望的一样。

当我新建一个核心控制面板时，默认在No submit。我不知道这个问题是否仅在使用多个数据源和/或选项卡表时才会出现。希望此修复程序对以后的人有用。如果您在部分刷新正常工作时遇到问题，值得一试。

# ruby-on-rails - 每个方法传入的变量都被视为模型的属性

> ID：13370248
> 
> 赞同：0
> 
> 时间：2012-11-13T22:48:57.193
> 
> 标签：ruby-on-rails, ruby, rspec

我正在编写一个 rspec 测试，在其中循环遍历模型的各种属性以测试是否存在。但是，每当我将变量`attr`插入循环代码时，它会将 attr 作为属性本身而不是变量读取。我该如何解决？我知道这是可以做到的。

```
describe "testing the presence" do

  ["title", "url", "post_id"].each do |attr|

    it "tests presence for #{attr}" do
    #attr being recognized as actual model attribute
    link = Link.new(attr: "")
    link.should be_invalid
    link.errors.should_not be_nil

    end

  end

end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:03:14.087

您可以修改它以使用 symb=>value 的旧语法，例如

```
describe "testing the presence" do

  ["title", "url", "post_id"].each do |attr|

    it "tests presence for #{attr}" do
    #attr being recognized as actual model attribute
    **link = Link.new(attr.to_sym => "")**
    link.should be_invalid
    link.errors.should_not be_nil
    end
  end
end 
```

您也可能只想向它发送一个方法，例如

```
link = Link.new
link.send attr.to_sym, "" 
```

# objective-c - 尝试将页面添加到 UIPageViewController

> ID：13370250
> 
> 赞同：0
> 
> 时间：2012-11-13T22:49:03.540
> 
> 标签：objective-c, ios, uiimageview, uipageviewcontroller

这是我的 SlidesViewController.m 文件。我正在尝试将一堆图像加载到 a`UIPageViewController`但没有运气。除了底部的两个点外，屏幕是黑色的。没有图像，据我所知，我无法在两个视图之间切换。

我从我的`NSLog`线路得到的输出是

```
2012-11-13 20:25:10.535 [17680:c07] Slide show guid: ab7718c9-3495-4882-a1e3-71f39530963b
2012-11-13 20:25:10.536 [17680:c07] Loading image: /Users/Me/Library/Application Support/iPhone Simulator/6.0/Applications/667EF28E-4E5F-4452-BF0E-336730C2D3FE/Documents/media/dh1.jpg
2012-11-13 20:25:10.536 [17680:c07] Loading image: /Users/Me/Library/Application Support/iPhone Simulator/6.0/Applications/667EF28E-4E5F-4452-BF0E-336730C2D3FE/Documents/media/dh2.jpg
2012-11-13 20:25:10.538 [17680:c07] presentationCountForPageViewController: 2
2012-11-13 20:25:10.538 [17680:c07] presentationIndexForPageViewController: 0 
```

不太确定从这里去哪里。

```
#import "SlidesViewController.h"
#import "SQLiteManager.h"

@interface SlidesViewController ()
@property (nonatomic, strong) NSMutableArray *imageViews;
@end

@implementation SlidesViewController
@synthesize guid = _guid;
@synthesize imageViews = _imageViews;

- (void)viewDidLoad
{
    [super viewDidLoad];
    NSLog(@"Slide show guid: %@", self.guid);

    self.dataSource = self;

    // Get the system paths
    NSArray *dirPaths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *docsDir = [dirPaths objectAtIndex:0];
    NSString *mediaDir = [docsDir stringByAppendingPathComponent:@"media"];

    // Grab the images from the database
    SQLiteManager *db = [[SQLiteManager alloc] initWithDatabaseNamed:@"local.db"];
    [db openDatabase];
    NSString *sql = [NSString stringWithFormat:@"select * from pictures where point='%@' order by rank", self.guid];
    NSArray *pictures = [db getRowsForQuery:sql];

    // Create the views
    self.imageViews = [[NSMutableArray alloc] initWithCapacity:[pictures count]];
    for (NSDictionary *picture in pictures)
    {
        NSString *filename = [mediaDir stringByAppendingPathComponent:[picture objectForKey:@"imagename"]];
        NSLog(@"Loading image: %@", filename);
        UIImage *img = [[UIImage alloc] initWithContentsOfFile:filename];
        UIImageView *iv = [[UIImageView alloc] initWithImage:img];
        UIViewController *ivc = [[UIViewController alloc] init];
        ivc.view = iv;
        [self.imageViews addObject:ivc];
    }
}

- (NSUInteger)indexOfViewController:(UIView *)view
{
    return [self.imageViews indexOfObject:view];
}

- (UIViewController *)pageViewController:(UIPageViewController *)pageViewController viewControllerBeforeViewController:(UIViewController *)viewController
{
    NSLog(@"viewControllerBeforeViewController");
    int index = [self.imageViews indexOfObject:viewController] - 1;
    if (index >= 0)
        return [self.imageViews objectAtIndex:index];
    return nil;    
}

- (UIViewController *)pageViewController:(UIPageViewController *)pageViewController viewControllerAfterViewController:(UIViewController *)viewController
{
    NSLog(@"viewControllerAfterViewController");
    int index = [self.imageViews indexOfObject:viewController] + 1;
    if (index < [self.imageViews count])
        return [self.imageViews objectAtIndex:index];
    return nil;
}

- (NSInteger)presentationIndexForPageViewController:(UIPageViewController *)pageViewController
{
    NSLog(@"presentationIndexForPageViewController: %d", 0);
    return 0;
}

- (NSInteger)presentationCountForPageViewController:(UIPageViewController *)pageViewController
{
    NSLog(@"presentationCountForPageViewController: %d", [self.imageViews count]);
    return [self.imageViews count];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

-(BOOL) gestureRecognizerShouldBegin:(UIGestureRecognizer *)gestureRecognizer {

    if (index==0) {

        if ([(UIPanGestureRecognizer*)gestureRecognizer isKindOfClass:[UIPanGestureRecognizer class]] &&
            [(UIPanGestureRecognizer*)gestureRecognizer velocityInView:gestureRecognizer.view].x > 0.0f) {
            NSLog(@"DENIED SWIPE PREVIOUS ON FIRST PAGE");
            return NO;
        }
        if ([(UITapGestureRecognizer*)gestureRecognizer isKindOfClass:[UITapGestureRecognizer class]] &&
            [(UITapGestureRecognizer*)gestureRecognizer locationInView:gestureRecognizer.view].x < self.view.frame.size.width/2) {
            NSLog(@"DENIED TAP PREVIOUS ON FIRST PAGE");
            return NO;
        }
    }

    return YES;
}
@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T05:46:57.430

在 pageviewcontroller.m 中试试这个

在 .h 中使用 UIGestureRecognizerDelegate

```
- (BOOL)gestureRecognizerShouldBegin:(UIGestureRecognizer *)gestureRecognizer
{
    if (index==0) {
        if ([(UIPanGestureRecognizer*)gestureRecognizer isKindOfClass:[UIPanGestureRecognizer class]] &&
            [(UIPanGestureRecognizer*)gestureRecognizer velocityInView:gestureRecognizer.view].x > 0.0f) {
            NSLog(@"DENIED SWIPE PREVIOUS ON FIRST PAGE");
            return NO;
        }
        if ([(UITapGestureRecognizer*)gestureRecognizer isKindOfClass:[UITapGestureRecognizer class]] &&
            [(UITapGestureRecognizer*)gestureRecognizer locationInView:gestureRecognizer.view].x < self.view.frame.size.width/2) {
            NSLog(@"DENIED TAP PREVIOUS ON FIRST PAGE");
            return NO;
        }
    }
    return YES;
} 
```

# mysql - mySQL REGEXP 逗号之间的匹配值

> ID：13370263
> 
> 赞同：1
> 
> 时间：2012-11-13T22:49:43.307
> 
> 标签：mysql, sql, regex

在过滤我的数据库中的条目时，我一直在研究 REGEXP。我有一个用逗号分隔的值的列，如下所示：
id col A
|---|------------------------|
| 1 | P:1,P:2,P:5,P:7 |
| 2 | P:6,P:8,P:10,P:11 |
| 3 | P:4,P:3,P1,P:0 |
| 4 | P:2,P:1 |
|---|-------------|

假设我想要包含值 P:1 的行，我该如何设计 REGEXP 的形式：

```
SELECT * FROM `table` WHERE `col A` REGEXP '?' 
```

这样我得到第 1 3 和 4 行？我以前的方法是简单地使用：

```
SELECT * FROM `table` WHERE `col A` LIKE 'P:1' 
```

但是，这自然也会返回第 2 行，因为它在技术上包含 P:1 ...
任何帮助将不胜感激，我认为这个问题对于正则表达式专家来说相当简单！

干杯，
安德烈亚斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T22:53:40.867

您需要阅读[单词边界](http://dev.mysql.com/doc/refman/5.1/en/regexp.html)。

> [[:<:]], [[:>:]]
> 
> 这些标记代表单词边界。它们分别匹配单词的开头和结尾。单词是前面或后面没有单词字符的单词字符序列。单词字符是 alnum 类中的字母数字字符或下划线 (_)。

# c# - 使用 Ajax.ActionLink 将数据传递给控制器

> ID：13370265
> 
> 赞同：3
> 
> 时间：2012-11-13T22:49:44.400
> 
> 标签：c#, ajax, asp.net-mvc-3

我正在尝试在同一页面上编写指向部分视图的链接。一切正常，除了我无法通过我的 ajax.actionlink 语法传入所需的月份参数。我试过使用 ViewDataDictionary，但无济于事。此外，RouteValueParameter 是我的一个想法，但我试图传递一个字符串，而不是整数 id。

下面是我在视图中的代码，然后是控制器中的方法：

```
<td>@Ajax.ActionLink("January", "ControllerMethod", new ViewDataDictionary{{"month", "January"}}, new AjaxOptions { UpdateTargetId = "view-month" })</td>

public ActionResult ViewMonths(string month)
    {
        //some code here
        return PartialView("ViewMonths", schedule);
    } 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-13T23:01:48.737

试试这个方法

```
@Ajax.ActionLink("Link Text", "MyAction", "MyController", new { month = "January",  plum = "2", moreparams = "U can do this all day"}, new AjaxOptions{ UpdateTargetId = "view-month" } ) 
```

伟大的

# file - 如何将文件夹复制到新位置并给它一个时间戳

> ID：13370271
> 
> 赞同：-1
> 
> 时间：2012-11-13T22:50:09.683
> 
> 标签：file, batch-file

所以我想复制一个名为“batchOS”的文件夹，然后将复制的版本移动到 AppData Roaming 并给它一个时间戳。我看了其他类似的问题，但没有一个像我想要的那样起作用。

所以基本上在 AppData Roaming 文件夹中应该出现一个名为 batchOS-11-13-2012 的文件夹（示例）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T23:24:32.837

把它放在一个批处理文件中它应该可以工作：

```
@Echo Off
@For /F "tokens=1,2,3 delims=/ " %%A in ('Date /t') do @( 
    Set Day=%%A
    Set Month=%%B
    Set Year=%%C
    Set All=%%C%%B%%A
    )
echo d | xcopy /f /y "Directory\BatchOS" "DestinationDirectory\BatchOS%ALL%" /E 
```

将 Directory 替换为文件夹的目录。以及您想要的目标目录。

编辑：在这部分添加，所以它不会提示你。测试它有效。回声 d | xcopy /f /y

# scala - 当收到特定消息时，我们从哪里获得发送者演员？

> ID：13370277
> 
> 赞同：6
> 
> 时间：2012-11-13T22:51:04.767
> 
> 标签：scala, actor, remote-actors

每当一个actor在scala中接收到消息时，我们可以通过使用关键字'sender'来访问actor的发送者，它是一个特征AbstractActor的对象。

我的问题是，每当收到消息时，如何才能访问此“发件人”。？

而且，我们是否可以覆盖这个实现，与发送者一起，其他一些数据也可以访问，例如 ipaddress，数据来自的端口。

据我所知，您无法从消息的来源处获取 IP 地址和端口。有什么方法可以从这个“发件人”对象中获取发件人的 IP 地址和端口号？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-15T09:51:13.930

（您并没有真正说出哪些演员，所以我假设 Akka 的答案也可以）

该`sender`方法为您提供`ActorRef`了在发送站点隐式或显式拾取的内容：如果您`!`在演员中使用，`implicit val self: ActorRef`则会找到并使用它。如果该发件人与收件人居住在不同`ActorSystem`的地方，即它是远程消息发送，则`sender`ref 将包含回复所需的所有信息，只需查看其路径：

```
val s = sender    // Actor[akka://<system>@<host>:<port>/user/path/to/actor]
val p = s.path    // akka://<system>@<host>:<port>/user/path/to/actor
val a = p.address // akka://<system>@<host>:<port>
val host = a.host // Some(<host>), where <host> is the listen address as configured for the remote system
val port = a.port // Some(<port>), where <port> is the actual listen port of the remote system 
```

所以，简而言之，`sender.path.address.host`（和端口的模拟）应该给你你需要的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T10:26:33.607

在 AKKA 演员系统中，！被重载为 def !(message : scala.Any)(implicit sender : akka.actor.ActorRef) 其中 sender 是发送消息的参与者。之后，您可以在 ActorRef 上调用 path 方法，但我认为您无法从那里获得真实的 IP 地址。

# iphone - 在 sql 调用处循环

> ID：13370279
> 
> 赞同：-1
> 
> 时间：2012-11-13T22:51:16.240
> 
> 标签：iphone, ios, sql, sqlite

非常感谢你。

我遇到了一个循环，不知道如何在这里摆脱它。

这是代码：

```
- (BOOL) next {

int rc;
BOOL retry;
int numberOfRetries = 0;
do {
    retry = NO;

    rc = sqlite3_step(statement.statement);

    if (SQLITE_BUSY == rc) {
        // this will happen if the db is locked, like if we are doing an update or insert.
        // in that case, retry the step... and maybe wait just 10 milliseconds.
        retry = YES;
        usleep(20);

        if ([parentDB busyRetryTimeout] && (numberOfRetries++ > [parentDB busyRetryTimeout])) {

            NSLog(@"%s:%d Database busy (%@)", __FUNCTION__, __LINE__, [parentDB databasePath]);
            NSLog(@"Database busy");
            break;
        }
    }
    else if (SQLITE_DONE == rc || SQLITE_ROW == rc) {
        // all is well, let's return.
    }
    else if (SQLITE_ERROR == rc) {
        NSLog(@"Error calling sqlite3_step (%d: %s) rs", rc, sqlite3_errmsg([parentDB sqliteHandle]));
        break;
    } 
    else if (SQLITE_MISUSE == rc) {
        // uh oh.
        NSLog(@"Error calling sqlite3_step (%d: %s) rs", rc, sqlite3_errmsg([parentDB sqliteHandle]));
        break;
    }
    else {
        // wtf?
        NSLog(@"Unknown error calling sqlite3_step (%d: %s) rs", rc, sqlite3_errmsg([parentDB sqliteHandle]));
        break;
    }

} while (retry); 
```

错误发生在`rc = sqlite3_step(statement.statement);`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T00:40:00.460

1.  返回什么值`sqlite3_step`？在你的前面写一个`NSLog`声明`sqlite3_step`（并显示`numberOfRetries`）。你后来暗示它挂在`sqlite3_step`函数调用上，这似乎不太可能。

2.  更有可能的是，这个例程被重复调用`sqlite3_step`（例如，如果数据库很忙并且`[parentDB busyRetryTimeout]`为 0，这个函数将永远不会结束（或者至少在数据库争用得到解决之前）。这是唯一一个让我跳出来的明显问题，但它需要多种因素的汇合。

3.  为什么你的数据库很忙？试图在后台队列中使用它？就我个人而言，对于需要后台数据库操作的应用程序，我在[GCD队列中为我的数据库操作创建了一个单独的](https://developer.apple.com/library/mac/#documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html)[串行队列](https://developer.apple.com/library/mac/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationQueues/OperationQueues.html#//apple_ref/doc/uid/TP40008091-CH102-SW1)，因为它是串行的，因此可以确保没有数据库争用。顺便说一句，如果你想摆脱 SQLite 编程的杂草，[FMDB](https://github.com/ccgus/fmdb)是一个很棒的包装器，它可以为你处理所有这些。如果我对第 2 点的猜想是正确的，则需要先解决这个问题，但总的来说，FMDB 简化了对数据库的后台操作。`FMDatabaseQueue`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T04:45:24.783

我认为问题在于`statement.statement`它应该只是`rc = sqlite3_step(statement);`

我建议在 step 语句之前检查 db，在 prepare 语句本身进行检查。

```
 rc      = sqlite3_prepare(db, [sql UTF8String], -1, &statement, 0); 
```

# css - div填充可用高度

> ID：13370280
> 
> 赞同：0
> 
> 时间：2012-11-13T22:51:18.087
> 
> 标签：css, html, height, vertical-alignment

我有个问题。从代码中可以看出，在名为“div1”的 div 中，我有 3 个 div。我希望第一个（黄色）div 位于顶部，第三个（黄色）位于底部，第二个 div（粉红色）填充剩余空间。唯一固定的高度是黄色 div 的高度。你能帮我吗，如何让粉红色的 div 填充剩余的空间？这是我的代码：

```
<div style="width:100%;background-color: lime;display: table;border-collapse: collapse;">
<div style="display: table-row;">
    <div id=div1 style="display: table-cell;background-color: #0f0;">

        <div style="background-color:yellow;width:100%;height:20px;">s</div>
        <div style="background-color:pink; width:100%;">
            Lorem  dsadsad dsa d sad dsa Lorem  dsadsad dsa d sad dsa Lorem  dsadsad dsa d sad dsa Lorem  dsadsad dsa d sad dsa Lorem  dsadsad dsa d sad dsa Lorem  dsadsad dsa d sad dsa Lorem  dsadsad dsa    
        </div>
        <div style="background-color:yellow;width:100%;height:20px;">s</div>
    </div>
    <div style="background-color: #f00;display: table-cell;width:250px">
        Lorem ipsum dolor sit amet, consectetur adipiscing elit.Lorem ipsum dolor sit amet, consectetur adipiscing elit.Lorem ipsum
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T23:22:35.243

使用一点 javascript，您可以做一些数学运算并计算出粉红色 div 的高度。

```
var rightD = document.getElementById('rightDiv');
var yellowD = document.getElementById('yellowD');
var middleD = document.getElementById('middleDiv');
var height = rightD.clientHeight - (yellowD.clientHeight * 2);

middleD.style.height = height + 'px'; 
```

[http://jsfiddle.net/kX4UB/1/](http://jsfiddle.net/kX4UB/1/)

您不需要声明这么多变量，但我这样做只是为了方便显示。我只是将高度设置为红色 div 的高度减去黄色 div 的高度 x2。请注意，此代码应放在文档中这些 div 之后的 js 标记中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T23:17:14.803

有点技巧可以做到这一点：
右侧单元格中的文本更高： http: [//jsfiddle.net/UQgXM/2/](http://jsfiddle.net/UQgXM/2/)
左侧单元格中的文本更高：http: [//jsfiddle.net/UQgXM/3/](http://jsfiddle.net/UQgXM/3/)

我已将 CSS 与 HTML 分开。主要变化：

*   给桌子一个高度。这是使单元格中的 div 响应高度设置所必需的。表格高度被忽略。我将其设置为 1%，但表格想要更大。
*   给定粉红色 div 的高度为 100% 以及一个边距和内边距以正确定位内容。
*   给定黄色 div（尤其是顶部 div）的 z-index 为 1 和 position: relative 以使其响应 z-index。否则它会落在粉红色的 div 后面。

    ```
     <div class="top">s</div>
        <div class="middle">
            Lorem  dsadsad dsa d sad dsa Lorem  dsadsad dsa d sad dsa Lorem  dsadsad dsa d sad dsa Lorem  dsadsad dsa d sad dsa Lorem  dsadsad dsa d sad dsa Lorem  dsadsad dsa d sad dsa Lorem  dsadsad dsa    
        </div>
        <div class="bottom">s</div>
    </div>
    <div class="rightcell">
        Lorem ipsum dolor sit amet, consectetur adipiscing elit.Lorem ipsum dolor sit amet, consectetur adipiscing elit.Lorem ipsum
        Lorem ipsum dolor sit amet, consectetur adipiscing elit.Lorem ipsum dolor sit amet, consectetur adipiscing elit.Lorem ipsum
        Lorem ipsum dolor sit amet, consectetur adipiscing elit.Lorem ipsum dolor sit amet, consectetur adipiscing elit.Lorem ipsum
        Lorem ipsum dolor sit amet, consectetur adipiscing elit.Lorem ipsum dolor sit amet, consectetur adipiscing elit.Lorem ipsum
        Lorem ipsum dolor sit amet, consectetur adipiscing elit.Lorem ipsum dolor sit amet, consectetur adipiscing elit.Lorem ipsum
    </div> 
    ```

    ​</p>

和CSS：

```
.table {
    width:100%;
    height: 1%;
    background-color: lime;
    display: table;
    border-collapse: collapse;
}

.row {
    display: table-row;
}
#div1 {
    display: table-cell;
    background-color: #0f0;
}
.top,
.bottom{
    background-color:yellow;
    width:100%;
    height:20px;
    z-index: 1;
    position: relative;
}
.middle {
    background-color:pink; 
    width:100%;
    height: 100%;
    margin: -20px 0;
    position: relative;
    padding: 20px 0;
}
.rightcell {
    background-color: #f00;
    display: table-cell;
    width:250px;
}
​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T22:59:49.070

必须将其发布为答案才能包含图形。在 Firefox、Chrome 和 IE 中，您的页面看起来就像我认为您所描述的那样： ![在此处输入图像描述](../Images/fd0601d63c3672b4a960367340290fa0.png)

这是它应该出现的样子吗？

# matlab - 图像处理学习/原型设计 Mathematica 或 Matlab 哪个更好？

> ID：13370286
> 
> 赞同：2
> 
> 时间：2012-11-13T22:51:50.497
> 
> 标签：matlab, image-processing, wolfram-mathematica

我正在学习图像处理/模式识别。我的背景是 C++ 和 OpenCV 的基础知识。我正在寻找一种工具来学习如何更轻松地测试我的图像上的所有过滤器和算法。Matlab 和 Mathematica 适合这个吗？如果是这样，哪个更好？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T23:02:33.293

您可以用两种语言进行出色的图像处理，因此这个问题没有一般性的答案。

在您的特定情况下，假设您可以访问这两个包的所有相关工具箱，我推荐 Matlab，因为它的语法比 Mathematica 的函数语法更类似于 C++。因此，Matlab 可能更容易上手。请注意，许多过滤器已经在 Matlab 中实现，我假设也在 Mathematica 中。

一个 Matlab 博客刚刚开始了关于[图像过滤器](http://blogs.mathworks.com/steve/2012/11/13/image-effects-part-1/)的系列文章。此外，您可以尝试从 File Exchange 调整[MorphTool](http://www.mathworks.com/matlabcentral/fileexchange/23697-morphtool)，以便能够使用您感兴趣的过滤器。

# python - sklearn.gaussian_process fit() 不适用于大于 100 的数组大小

> ID：13370287
> 
> 赞同：0
> 
> 时间：2012-11-13T22:51:50.947
> 
> 标签：python, scikit-learn

我正在生成一个`random.uniform(low=0.0, high=100.0, size=(150,150))`数组。
我将其输入到生成 、 和 的`X`函数`x`中`y`。

但是，如果随机测试矩阵大于 100，则会出现以下错误。
我尝试过使用 theta 值。

有人遇到过这个问题吗？这是一个错误吗？
我正在使用*python2.6*和*scikit-learn-0.10*。我应该尝试*python3*吗？

欢迎任何建议或意见。

谢谢你。

```
gp.fit( XKrn, yKrn )
  File "/usr/lib/python2.6/scikit_learn-0.10_git-py2.6-linux-x86_64.egg/sklearn/gaussian_process/gaussian_process.py", line 258, in fit
    raise ValueError("X and y must have the same number of rows.")
ValueError: X and y must have the same number of rows. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T23:16:12.377

`ValueError: X and y must have the same number of rows.`意味着在您的情况下`XKrn.shape[0]`应该等于`yKrn.shape[0]`. 您可能在生成数据集的代码中有错误。

这是一个工作示例：

```
In [1]: from sklearn.gaussian_process import GaussianProcess

In [2]: import numpy as np

In [3]: X, y = np.random.randn(150, 10), np.random.randn(150)

In [4]: GaussianProcess().fit(X, y)
Out[4]: 
GaussianProcess(beta0=None,
        corr=<function squared_exponential at 0x10d42aaa0>, normalize=True,
        nugget=array(2.220446049250313e-15), optimizer='fmin_cobyla',
        random_start=1,
        random_state=<mtrand.RandomState object at 0x10b4c8360>,
        regr=<function constant at 0x10d42a488>, storage_mode='full',
        theta0=array([[ 0.1]]), thetaL=None, thetaU=None, verbose=False) 
```

目前还不支持 Python 3，scikit-learn 的最新发布版本是 0.12.1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T20:10:05.810

我原来的帖子被删了。谢谢，柔印。

我有同样的问题，我传入的行数在我的 X 和 y 中是相同的。

就我而言，问题实际上是我传递了许多功能以适应我的输出。高斯过程适合单个输出特征。

“行数”错误具有误导性，原因是我没有正确使用该包。要适应这样的多个输出功能，您需要为每个功能配备一个 GP。

# python - 在 amazon ec2 或 picloud 中并行运行相同的 python 脚本涉及哪些步骤

> ID：13370289
> 
> 赞同：4
> 
> 时间：2012-11-13T22:52:00.130
> 
> 标签：python, parallel-processing, amazon-ec2, cloud

我需要一些关于我试图尽快完成的并行处理任务的帮助。

它只涉及将较大的数据帧拆分为较小的块并在每个块上运行相同的脚本。

我认为这被称为令人尴尬的并行。

如果有人可以建议使用亚马逊云服务或 picloud 完成此任务的模板，我将不胜感激。

我已经对亚马逊 ec2 和 picloud 进行了初步尝试（我将在每个数据块上运行的脚本在 python 中），但我意识到如果没有一些帮助，我可能无法弄清楚如何做到这一点。

因此，任何指针将不胜感激。我只是在寻找基本帮助（对于那些知道的人），例如使用 ec2 或 picloud 或其他任何东西设置并行内核或 cpus 所涉及的主要步骤，并行运行脚本，并保存脚本输出，即脚本将其计算结果写入 csv 文件。

我正在运行 ubuntu 12.04，我的 python 2.7 脚本不涉及非标准库，只涉及 os 和 csv。脚本并不复杂，只是数据对于我的机器和时间框架来说太大了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T10:03:38.447

该脚本使用来自 PiCloud 的 Python 云库，应该在本地运行。

```
# chunks is a list of filenames (you'll need to define generate_chunk_files)
chunks = generate_chunk_files('large_dataframe')
for chunk in chunks:
    # stores each chunk in your PiCloud bucket
    cloud.bucket.put(chunk)

def process_chunk(chunk):
    """Runs on PiCloud"""

    # saves chunk object locally
    cloud.bucket.get(chunk)
    f = open(chunk, 'r')
    # process the data however you want

# asynchronously runs process_chunk on the cloud for all chunks
job_ids = cloud.map(process_chunk, chunks) 
```

使用[实时核心](http://docs.picloud.com/realtime_cores.html)功能分配特定数量的核心。

# php - PHP 5.4.8-1 未命中 Eclipse-Juno 断点

> ID：13370290
> 
> 赞同：3
> 
> 时间：2012-11-13T22:52:05.527
> 
> 标签：php, breakpoints, eclipse-juno

刚刚从 org.eclipse.php.sdk.feature.group 安装了 Eclipse-Juno 和相关的 PHP 开发工具 (PDT) SDK。

```
php --version yields:
    PHP 5.4.8-1~precise+1 (cli) (built: Oct 29 2012 14:58:46) 
    Copyright (c) 1997-2012 The PHP Group
    Zend Engine v2.4.0, Copyright (c) 1998-2012 Zend Technologies
    with Xdebug v2.2.0, Copyright (c) 2002-2012, by Derick Rethans

Php -m indicates that xdebug is loaded.
    [Zend Modules]
    Xdebug 
```

在eclipse中，Windows->Preferences->Php->Debug->PHP Debubber就是Xdebug。

但是，我的断点都没有命中。

我应该检查什么才能使调试断点在 Eclipse-Juno 上对 PHP 起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-14T10:47:01.640

我想，你是从网络浏览器调用你的脚本。您需要告诉 xdebug 实际上在断点处停止。如果您使用的是 Firefox，则可以使用[easyXdebug](https://addons.mozilla.org/en-US/firefox/addon/easy-xdebug/)。确保在您的 xdebug.ini 中启用远程调试（在扩展首选项中解释）以及在 eclipse 中（Windows->Preferences->Php->Debug->PHP Debugger->Config）。然后，您可以通过单击浏览器状态栏中的小图标为下一个请求启用调试。

对于其他浏览器也应该有插件，但我没有使用任何插件。

# php - 使用 PHP 将生成的 .wav 文件保存到服务器

> ID：13370291
> 
> 赞同：0
> 
> 时间：2012-11-13T22:52:05.923
> 
> 标签：php, javascript, wav

> **可能重复：**
> [如何流式传输 WAV 文件？](https://stackoverflow.com/questions/2551943/how-to-stream-a-wav-file)

我正在开发一个网站，用户可以在其中创作自己的音乐，该网站将为他们的创作生成一个 .wav 文件。这工作正常（因为我可以在页面上播放它）。但是，我想将此文件保存到服务器以供以后收听/下载，并且该文件的保存版本无法再通过 HTML 音频标签打开和播放。

除了原始数据之外，我还必须在文件中放入什么（如果有的话）？而不是将音频标签的 src 属性设置为文件的位置，我真的需要打开它并生成一个 URI 吗？

目前，我正在播放 wav 文件的操作如下所示：

```
wav = [headerChunk, fmtChunk, dataChunk].join(''); 
var URI = "data:audio/wav;base64," + escape(btoa(wav));
document.getElementById("player").setAttribute("src", URI); 
```

为了保存它，我只是将“wav”直接写入文件；然后我尝试通过将音频标签的 src 设置为该文件在服务器上的位置来播放它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T22:58:16.387

我讨厌成为坏消息的承担者，在理想的世界中，您需要使用 JQuery 发布文件，但我不认为您拥有您认为的文件，（您可能会这样做，但这不太可能，周围有太多的安全墙）你更有可能a）有一个带有文件的Java对象，或者b）（**更有**可能）一个带有音乐的flash对象。

在这种情况下，需要告知发布它的是这个“技巧框”：即，如果您在浏览器客户端中将音乐文件作为物理文件，那么您可能下载了它，如果您在浏览器不知何故你可能有一个闪存对象在内存中 - 在这种情况下，让闪存发布它是你唯一的方法

# ruby-on-rails - 理解为什么 ruby 进程阻塞在 100% CPU 的方法

> ID：13370295
> 
> 赞同：8
> 
> 时间：2012-11-13T22:52:27.823
> 
> 标签：ruby-on-rails, ruby, passenger

我们有一个大的 Rails 应用程序，几天后，我们的 ruby​​ 进程似乎一个接一个地阻塞在一个循环中并占用 100% 的 CPU，直到乘客服务器死亡并引发 502 错误。

您知道找出原因的最佳方法吗？

我尝试过 New Relic，但它只是性能方面的东西，而且我们的错误太多，无法猜测问题出在哪里。（我们每天有很多请求和很多 UTF-8 BSON 错误，因为我们使用的是 UTF-8 url）

使用：

*   带有 Ruby 1.9.2p290 的 Rails 3.2.6
*   乘客 3.0.13
*   MongoDB 2.0.1 与 Mongoid 2.4.11
*   Nginx
*   FreeBSD 8.2

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-13T23:09:12.867

找出 ruby​​ 卡在哪里的一种方便方法是附加[`gdb`](http://linux.die.net/man/1/gdb)到正在运行的进程和`call rb_backtrace()`. 这会将当前堆栈跟踪打印到 stderr，这很可能被定向到日志文件。这是我在博客上找到的[简短介绍。](http://isotope11.com/blog/getting-a-ruby-backtrace-from-gnu-debugger)堆栈跟踪应该可以帮助您定位您的进程卡在哪里，并允许您通过代码检查或通过在关键代码路径周围添加日志工具来弄清楚发生了什么。

Aman Gupta 有一个 gdb 到 ruby​​ 钩子库[gdb.rb](https://github.com/tmm1/gdb.rb)我发现有时很方便。

# c# - NAudio：WaveInEvent 处理程序不在其自己的线程上工作

> ID：13370297
> 
> 赞同：1
> 
> 时间：2012-11-13T22:52:46.283
> 
> 标签：c#, naudio

我有一个名为 AudioInput 的类：

```
class AudioInput
{
    private WaveIn waveIn;
    public delegate void DataAvailableEventHandler(byte[] data, int size);
    private DataAvailableEventHandler dataAvailableProc;

    public AudioInput(DataAvailableEventHandler dataHandlerProc)
    {
        dataAvailableProc = dataHandlerProc;
    }
    private void initWaveInMic()
    {
        Console.WriteLine("initWaveInMic");
        waveIn = new WaveIn();
        waveIn.BufferMilliseconds = 50;
        waveIn.DeviceNumber = 0;
        waveIn.WaveFormat = new WaveFormat(8000, 1);
        waveIn.DataAvailable += new EventHandler<WaveInEventArgs>(waveIn_DataAvailable);
        waveIn.StartRecording();
    }
    void waveIn_DataAvailable(object sender, WaveInEventArgs e)
    {
        Console.WriteLine("waveIn_DataAvailable e.buffer length: {0}", e.Buffer.Length);
        dataAvailableProc(e.Buffer, e.Buffer.Length);
    }
     public void startNAudio()
    {
        this.initWaveInMic();  //start mic wavein
    }
} 
```

从调用类：

```
public partial class AudioTest : Form
{
    Thread audioInputThread;
    AudioInput audioInput;

    private void audioInputCreateThread()
    {
        audioInput = new AudioInput(audioDataToSend);
        audioInput.startNAudio();
        Console.WriteLine("audioInputCreateThread at the end");
    }

    private void AudioTest_Load(object sender, EventArgs e)
    {
        // this will work
        //audioInputCreateThread();

        //this will not work
        audioInputThread = new Thread(audioInputCreateThread);
        audioInputThread.Start();
    }

    private void audioDataToSend(byte[] data, int size)
    {
        Console.WriteLine("audioDataToSend size: {0}", size);
    }
} 
```

AudioInput 类中的 waveIn_DataAvailable 回调没有被调用。任何建议我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T06:50:53.717

在这种`WaveInEvent`情况下应该使用该类。它将创建自己的后台线程，并尽可能使用 SyncContext 将回调编组到 GUI 线程上。

# php - 输入html标签在php中没有正确解析

> ID：13370299
> 
> 赞同：-4
> 
> 时间：2012-11-13T22:53:04.573
> 
> 标签：php, html, mysql

> **可能重复：**
> [解析错误：语法错误，意外的 T_STRING 59](https://stackoverflow.com/questions/13060013/parse-error-syntax-error-unexpected-t-string-59)

我有一个数据库，其名称希望以带有复选框的表格形式显示。一切正常，直到我尝试将 html 标记放入我的 php 代码中。当我将输入标签放入其中时，会出现错误：

解析错误：语法错误，意外的 T_STRING，期待 ',' 或 ';'

我看不到在哪里放置逗号或分号。

```
<form>
    <?php
    $name = $_POST['name'];

    $host = "mysql16.000webhost.com";
    $user_name = "a1611480_akaash";
    $pwd = "****";
    $database_name = "a1611480_akaash";
    $db = mysql_connect($host, $user_name, $pwd);

    mysql_select_db($database_name);

    $result = mysql_query("SELECT name FROM Sort");

    $var = array();
    while ($row = mysql_fetch_array($result)) {
        $var[] = $row['name'];
    }

    $unique = array_unique($var);

    foreach ($unique as $value) {

        echo "<p class = Body_text><label>$value</label> <input type="checkbox" name="name" value="$value" /> </p>\n";
    }
    ?>
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T22:55:00.110

在您的回声线上，整个内容必须用双引号括起来。您在复选框之前打开双引号，因此它会将*复选框*视为未知的 PHP 调用。使用单引号和双引号的组合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T22:55:07.773

改变这一行..你必须逃避双引号

```
echo "<p class = Body_text><label>$value</label> <input type=\"checkbox\" name=\"name\" value=\"$value\" /> </p>\n"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T22:55:20.590

替换这个：

```
echo "<p class = Body_text><label>$value</label> <input type="checkbox" name="name" value="$value" /> </p>\n" 
```

有了这个：

```
echo <<<EOD
<p class = Body_text><label>$value</label> <input type="checkbox" name="name" value="$value" /> </p>
EOD; 
```

... 这使用[HEREDOC 语法](http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.heredoc)，可以轻松绕过您的大部分报价问题。但是，它有一个重要的警告：该行`EOD;` **不能**缩进，并且该行上不能有任何其他内容（例如尾随空格）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T22:55:06.150

将“回声”行替换为

```
echo "<p class = Body_text><label>$value</label> <input type='checkbox' name='name' value='$value' /> </p>\n"; 
```

因为您使用双引号作为字符串分隔符以及复选框本身，所以它有点脱离了 php 字符串。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-13T22:55:37.663

您需要转义反斜杠，或者使用heredoc 语法。请参阅下面的几个示例，其中您正在破坏您的 PHP 代码：

```
echo "<p class = Body_text><label>$value</label> <input type="checkbox" name="name" value="$value" /> </p>\n";
                                                            ^^^      ^^^ 
```

# c++ - 如何插入 LLVM 指令？

> ID：13370306
> 
> 赞同：12
> 
> 时间：2012-11-13T22:53:54.273
> 
> 标签：c++, llvm, llvm-ir

我一直在寻找几个小时，我找不到任何可以帮助我的东西。我正在做一个涉及 FunctionPass 的项目。我已经实现了一个 runOnFunction(Function &f) 方法，并且工作正常。基本上它需要：

1）检测存储指令

2）将store指令的内存地址转换为Integer

3) 使用按位与运算 (0000FFFF) 更改整数

4) 将整数转换回指针

到目前为止，我有以下内容：

```
 virtual bool runOnFunction(Function &F) {
  for (Function::iterator bb = F.begin(), bbe = F.end(); bb != bbe; ++bb) {
    BasicBlock& b = *bb;
    for (BasicBlock::iterator i = b.begin(), ie = b.end(); i != ie; ++i) {
      if(StoreInst *si = dyn_cast<StoreInst>(&*i)) {
        PtrToIntInst* ptrToInt = new PtrToIntInst(si->getPointerOperand(), IntegerType::get(si->getContext(), 32), "", si);
      }
    }
  }
  return true;
} 
```

我一生都无法弄清楚如何实际插入指令，甚至无法找到创建 AND 指令的方法。如果有人能指出我正确的方向，那就太好了。

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-14T13:01:57.590

我建议看一下[程序员手册](http://llvm.org/docs/ProgrammersManual.html)——它对基础知识的覆盖面相当不错。

特别是，有[一个关于创建和插入新指令的部分](http://llvm.org/docs/ProgrammersManual.html#creating-and-inserting-new-instructions)。最简单的方法是提供一条现有指令作为新指令的构造函数的最后一个参数，然后它将在现有指令之前立即插入该指令。

或者，如果您只想添加到它的末尾，您可以传递封闭的基本块（但请记住，您需要照顾终结者！）。最后，您可以只调用`getInstList()`封闭的基本块，然后`insert`或`push_back`在那里插入新指令。

顺便说一句，您不必遍历所有块，然后遍历每个块中的所有指令，您可以直接遍历指令；请参阅[程序员手册中有关指令迭代器的部分](http://llvm.org/docs/ProgrammersManual.html#iterate_institer)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-09T09:36:23.183

```
 virtual bool runOnFunction(Function &F) {
  for (Function::iterator bb = F.begin(), bbe = F.end(); bb != bbe; ++bb) {
    BasicBlock &b = *bb;
    for (BasicBlock::iterator i = b.begin(), ie = b.end(); i != ie; ++i) {
      if (StoreInst *si = dyn_cast<StoreInst>(&*i)) {
        IRBuilder Builder(si);
        Value *StoreAddr = Builder.CreatePtrToInt(si->getPointerOperand(), Builder.getInt32Ty());
        Value *Masked = Builder.CreateAnd(StoreAddr, 0xffff);
        Value *AlignedAddr = Builder.CreateIntToPtr(Masked, si->getPointerOperand()->getType());
        // ...
      }
    }
  }
  return true;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-02-15T17:34:25.233

您可以使用 an`IRBuilder`在另一条指令之前或基本块的末尾轻松插入新指令。

或者，如果您需要在另一条指令**之后**`instruction list`插入一条指令，则需要在包含基本块中使用：

```
BasicBlock *pb = ...; 
Instruction *pi = ...; 
Instruction *newInst = new Instruction(...); 

pb->getInstList().insertAfter(pi, newInst); 
```

取自[此处](https://groups.google.com/forum/#!topic/llvm-dev/z-Sl8fu_IDo)的代码和解决方案。

# mysql - 我必须填写外键值吗？

> ID：13370308
> 
> 赞同：1
> 
> 时间：2012-11-13T22:53:58.150
> 
> 标签：mysql, database, foreign-keys

我是否必须在 MySQL 或任何其他数据库管理器中填写外键字段？

我正在写一个表的数据，当我从另一个表到达作为 FK 的字段时，我必须写一些东西，这有必要吗？

我知道该 FK 中的值存储在它来自的父表中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T22:57:13.443

您必须提供一个值，除非外键列可以为空。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T22:59:17.557

这取决于 是否实际上是一个外键约束（仅在 InnoDB 中可用）。在某些情况下，框架、应用程序或数据库管理工具会创建仅存在于应用程序中而不实际存在于数据库中的“假”外键。此外，关于如何插入/更新/删除与外键相关的数据的限制可能会因现有约束的类型而异。

以下是 MYSQL 文档以获得明确的信息：

[http://dev.mysql.com/doc/refman/5.5/en/innodb-foreign-key-constraints.html](http://dev.mysql.com/doc/refman/5.5/en/innodb-foreign-key-constraints.html)

具体来说，请查看“参考操作”部分以获取有关表之间行为的评论。

# android - getChildAt(0) 会返回 null 吗？

> ID：13370309
> 
> 赞同：2
> 
> 时间：2012-11-13T22:54:08.540
> 
> 标签：android, android-layout

给定一个非空 ViewGroup 对象`v`，我们可以说它`v.getChildAt(0)`永远不会返回空吗？

如果它可以返回 null，那么该视图层次结构会是什么样子？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-13T22:57:34.667

是的，根据文档，[它说它](http://developer.android.com/reference/android/view/ViewGroup.html#getChildAt%28int%29)返回：

> 指定位置的视图；如果组中不存在该位置，则返回 null

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T23:24:40.450

是的，它可以返回 null。

我认为您真正的问题是这是否会发生以及发生时意味着什么。这意味着视图组没有任何孩子。为什么视图组可能没有孩子？我不知道。也许视图层次结构在您尝试获取对第一个孩子的引用之前已更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T23:42:00.620

如果你有类似的东西

```
<ListView
    android:id="@+id/listview"
    android:layout_width="match_parent"
    android:layout_height="wrap_content">
</ListView> 
```

在您的布局中，然后执行

```
ListView v = (ListView) findViewById(R.id.listview);
View view = v.getChildAt(0);
// view is null 
```

你有一个`ViewGroup`对象`v`where `v.getChildAt(0)`is `null`。因为`ListView`在你给它数据显示之前不会有任何孩子。

此外，您可以`LinearLayout`为动态内容创建一个空白作为占位符或框架。

如果它没有明确声明它不能返回 null，那么你最好期待一下，否则墨菲定律会打击你。

# sql - 使用派生表按 ALIAS 分组

> ID：13370310
> 
> 赞同：1
> 
> 时间：2012-11-13T22:54:08.993
> 
> 标签：sql, sql-server, sql-server-2008

我需要帮助重写以下查询，因为我需要按别名分组，派生表似乎是对我开放的唯一路径。由于出现无效列错误，我无法按类型和 SalesDatabase 分组。

```
SELECT    'Transactions'        AS Type,  
          'SalesDb'             AS SalesDatabase,  
          COUNT (B.Id)          AS Total,  
          CASE 
              WHEN SB.name LIKE '%Online%'      THEN 'Online'   
              WHEN SB.name LIKE '%RetailSale%'  THEN 'Retail'   
              ELSE 'Bricks'   
          END AS SalesType,    
          ISNULL( SUM( CASE WHEN datediff( d, b.Inserted, getDate() ) <  1 THEN 1 ELSE 0 END ), 0 ) AS SalesPeriod0,          
          ISNULL( SUM( CASE WHEN datediff( d, b.Inserted, getDate() ) >=  1 and datediff( d, b.Inserted, getDate() ) < 8 THEN 1 ELSE 0 END ), 0 ) AS SalesPeriod1to7 ,         
          ISNULL( SUM( CASE WHEN datediff( d, b.Inserted, getDate() ) >= 8 THEN 1 ELSE 0 END ), 0 ) AS SalesPeriod8p  
FROM SalesItem B WITH (NOLOCK)  
INNER JOIN SalesBatch SB WITH (NOLOCK) ON SB.Id  = B.BatchId    
GROUP BY SB.NAME 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:09:50.377

如果您打算为每个 SB.NAME 生成一行，那么您编写的查询是正确的。这意味着你可以拥有

```
SB.NAME    | SalesType   | ...
ABC        | Online      | ...
DEF        | Online      | ...
XYZ        | Retail      | ...
DEF1       | Retail      | ... 
```

但是，如果要按 SalesType 分组，请使用此 GROUP BY

```
GROUP BY CASE 
          WHEN SB.name LIKE '%Online%'      THEN 'Online'   
          WHEN SB.name LIKE '%RetailSale%'  THEN 'Retail'   
          ELSE 'Bricks'   
      END 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T23:03:54.010

不需要对常量 Type 和 SalesDatabase 进行分组。

```
GROUP BY SB.NAME,  
          CASE 
              WHEN SB.name LIKE '%Online%'      THEN 'Online'   
              WHEN SB.name LIKE '%RetailSale%'  THEN 'Retail'   
              ELSE 'Bricks'   
          END 
```

# php - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册

> ID：13370311
> 
> 赞同：-5
> 
> 时间：2012-11-13T22:54:21.183
> 
> 标签：php, mysql, variables

嗨，当我在 php 中运行我的代码时，我不断收到 SQL 语法错误，但是当我删除变量并在 MYSQL 中手动执行时，这不是问题。我已经尝试了 2 个不同版本的查询，一个是 (')，另一个是 (")，什么都没有。你能帮忙吗？

谢谢你。

```
 $produpdateid = $_GET ['id'];
        $varcat = $_POST['category'];
        $vartitle = strip_tags($_POST['title']);
        $varoverview = strip_tags($_POST['overview']);
        $varfeatures = strip_tags($_POST['features']);
        $varspecification = strip_tags($_POST['specification']);
        $varmaker = strip_tags($_POST['maker']);
        $varsize = $_POST['size'];
        $varprice = $_POST['price'];
        $varstock = $_POST['stock'];
        $vartype = $_POST['stock'];

$q = 'UPDATE products SET products_category_id=' . $varcat . ', title=' . $vartitle . ', overview=' . $varoverview . ', features=' . $varfeatures . ', specification=' . $varspecification . ', size=' . $varsize . ', size_type=' . $vartype . ', maker=' . $varmaker . ', image=' . $varimg . ', price=' . $varprice . ', stock=' . $varstock .' WHERE id=' .$produpdateid;

/*$test = "UPDATE products SET products_category_id=" . $varcat . ", title=" . $vartitle . ", overview=" . $varoverview . ", features=" . $varfeatures . ", specification=" . $varspecification . ", size=" . $varsize . ", size_type=" . $vartype . ", maker=" . $varmaker . ", image=" . $varimg . ", price=" . $varprice . ", stock=" . $varstock ." WHERE id=" .$produpdateid;*/

$updateresult = mysqli_query($dbc,$q); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T22:56:51.260

在文本周围使用双引号。

```
'UPDATE products SET products_category_id="' . $varcat . '", title="' . $vartitle . '", 
```

ETC..

# html - CSS左右文本碰撞时停止下拉。

> ID：13370313
> 
> 赞同：0
> 
> 时间：2012-11-13T22:54:51.673
> 
> 标签：html, css

我有一个链接密集的网站，当有人使浏览器变小并且链接冲突时，我在左右两侧都有链接，右侧的链接低于左侧的链接。当它靠近左边的那个时，我怎样才能让右边的那个停止移动。附件是一个基本的例子。

[关联](http://css-tricks.com/examples/leftandright/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T23:19:28.387

容器上的A`min-width`将防止链接换行。基于示例：

```
#textbox {
    min-width: 270px; /* adjust to the needed width */
} 
```

# math - 将整数值转换为函数的亚十进制值

> ID：13370314
> 
> 赞同：0
> 
> 时间：2012-11-13T22:54:53.243
> 
> 标签：math, easing

我有一个函数可以简化 0 到 1 范围内的值。真实世界的值是 0 到 230 和 230 到 0 如何使用正确的“亚小数转换”值调用函数并将输出转换回整数？时间也在函数之外处理

```
x=0
timer=0 /milliseconds/

while x < 230
<convert x to something the function can use, probably distance / time?)
x=function(x)
<convert x back to the real world pixel value>
object.moveto(x,100)
end while 
```

这种转换的正确术语是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T23:06:47.183

除非我有误解，否则您是否只想将 0..230 的值**缩放**为 0..1？

*线性*缩放使用

```
x = function(x/230.0) * 230.0 
```

并在必要时四舍五入以转换为整数（您没有说明您使用的是什么语言）

如果您需要以其他方式（指数、对数等）缩放，则公式会有所不同。

# python - SQLAlchemy 默认日期时间

> ID：13370317
> 
> 赞同：247
> 
> 时间：2012-11-13T22:55:02.980
> 
> 标签：python, date, sqlalchemy

这是我的声明模型：

```
import datetime
from sqlalchemy import Column, Integer, DateTime
from sqlalchemy.ext.declarative import declarative_base

Base = declarative_base()

class Test(Base):
    __tablename__ = 'test'

    id = Column(Integer, primary_key=True)
    created_date = DateTime(default=datetime.datetime.utcnow) 
```

但是，当我尝试导入此模块时，出现此错误：

```
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "orm/models2.py", line 37, in <module>
    class Test(Base):
  File "orm/models2.py", line 41, in Test
    created_date = sqlalchemy.DateTime(default=datetime.datetime.utcnow)
TypeError: __init__() got an unexpected keyword argument 'default' 
```

如果我使用整数类型，我可以设置一个默认值。这是怎么回事？

* * *

## 回答 #1

> 赞同：566
> 
> 时间：2015-11-04T21:15:47.380

### 计算您的数据库中的时间戳，而不是您的客户

出于理智，您可能希望全部`datetimes`由您的数据库服务器计算，而不是应用程序服务器。在应用程序中计算时间戳可能会导致问题，因为网络延迟是可变的，客户端会遇到稍微不同的时钟漂移，并且不同的编程语言有时会稍微不同地计算时间。

SQLAlchemy 允许您通过传递[`func.now()`](http://docs.sqlalchemy.org/en/latest/core/functions.html#sqlalchemy.sql.functions.now)或[`func.current_timestamp()`](http://docs.sqlalchemy.org/en/latest/core/functions.html#sqlalchemy.sql.functions.current_timestamp)（它们是彼此的别名）来执行此操作，它告诉数据库自己计算时间戳。

### 使用 SQLALchemy 的`server_default`

此外，对于您已经告诉数据库计算值的默认值，通常最好使用[`server_default`](http://docs.sqlalchemy.org/en/latest/core/defaults.html#server-side-defaults)而不是`default`. 这告诉 SQLAlchemy 将默认值作为`CREATE TABLE`语句的一部分传递。

例如，如果您针对此表编写一个临时脚本，则使用`server_default`意味着您无需担心手动将时间戳调用添加到您的脚本——数据库会自动设置它。

### 了解 SQLAlchemy 的`onupdate`/`server_onupdate`

SQLAlchemy 还支持`onupdate`这样每当行更新时，它都会插入一个新的时间戳。同样，最好告诉数据库自己计算时间戳：

```
from sqlalchemy.sql import func

time_created = Column(DateTime(timezone=True), server_default=func.now())
time_updated = Column(DateTime(timezone=True), onupdate=func.now()) 
```

有一个[`server_onupdate`](http://docs.sqlalchemy.org/en/latest/core/metadata.html#sqlalchemy.schema.Column.params.server_onupdate)参数，但与 不同的是`server_default`，它实际上并没有在服务器端设置任何东西。它只是告诉 SQLalchemy，当更新发生时，您的数据库将更改列（也许您在[列上创建了触发器](http://docs.sqlalchemy.org/en/latest/core/defaults.html#triggered-columns)），因此 SQLAlchemy 将要求返回值，以便它可以更新相应的对象。

### 另一个潜在的陷阱：

您可能会惊讶地发现，如果您在单个事务中进行大量更改，它们都具有相同的时间戳。这是因为 SQL 标准指定`CURRENT_TIMESTAMP`根据事务的开始返回值。

PostgreSQL 提供了非 SQL 标准`statement_timestamp()`，并且在事务`clock_timestamp()`中*会发生变化。*此处的文档：[https ://www.postgresql.org/docs/current/static/functions-datetime.html#FUNCTIONS-DATETIME-CURRENT](https://www.postgresql.org/docs/current/static/functions-datetime.html#FUNCTIONS-DATETIME-CURRENT)

### UTC 时间戳

如果你想使用 UTC 时间戳，[SQLAlchemy 文档](http://docs.sqlalchemy.org/en/latest/core/compiler.html#utc-timestamp-function)`func.utcnow()`中提供了一个实现的存根。不过，您需要自己提供适当的驱动程序特定功能。

* * *

## 回答 #2

> 赞同：246
> 
> 时间：2012-11-13T23:01:29.300

`DateTime`没有默认键作为输入。默认键应该是`Column`函数的输入。试试这个：

```
import datetime
from sqlalchemy import Column, Integer, DateTime
from sqlalchemy.ext.declarative import declarative_base

Base = declarative_base()

class Test(Base):
    __tablename__ = 'test'

    id = Column(Integer, primary_key=True)
    created_date = Column(DateTime, default=datetime.datetime.utcnow) 
```

* * *

## 回答 #3

> 赞同：76
> 
> 时间：2015-05-06T17:17:25.300

您还可以默认使用 sqlalchemy 内置函数`DateTime`

```
from sqlalchemy.sql import func

DT = Column(DateTime(timezone=True), default=func.now()) 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2015-07-17T21:24:01.330

您可能希望使用`onupdate=datetime.now`UPDATE 来更改`last_updated`字段。

SQLAlchemy 有两个 python 执行函数的默认值。

*   `default`在 INSERT 上设置值，仅一次
*   `onupdate`也将值设置为 UPDATE 上的*可调用*结果。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-11-13T23:01:17.677

`default`应将关键字参数提供给 Column 对象。

例子：

```
Column(u'timestamp', TIMESTAMP(timezone=True), primary_key=False, nullable=False, default=time_now), 
```

默认值可以是可调用的，我在这里定义如下。

```
from pytz import timezone
from datetime import datetime

UTC = timezone('UTC')

def time_now():
    return datetime.now(UTC) 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2021-05-07T06:09:50.720

使用`default`参数`datetime.now`：

```
from datetime import datetime
class Test(Base):
     __tablename__ = 'test'
     id = Column(Integer, primary_key=True)
     created_at = Column(DateTime, default=datetime.now)
     updated_at = Column(DateTime, default=datetime.now, onupdate=datetime.now) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-02-19T13:12:29.243

根据[PostgreSQL 文档](https://www.postgresql.org/docs/9.6/static/functions-datetime.html)：

`now`, `CURRENT_TIMESTAMP`,`LOCALTIMESTAMP`返回交易时间

> 这被认为是一个特性：目的是允许单个事务具有一致的“当前”时间概念，以便同一事务中的多个修改具有相同的时间戳。

您可能想要使用**`statement_timestamp`**或者**`clock_timestamp`**如果您不想要事务时间戳。

`statement_timestamp()`

> 返回当前语句的开始时间（更具体地说，从客户端收到最新命令消息的时间）。statement_timestamp

`clock_timestamp()`

> 返回实际的当前时间，因此即使在单个 SQL 命令中，它的值也会发生变化。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-09-26T20:00:32.637

对于 mariadb 那对我有用：

```
from sqlalchemy import Column, Integer, String, DateTime, TIMESTAMP, text
from sqlalchemy.sql import func
from sqlalchemy.ext.declarative import declarative_base

Base = declarative_base()

class Test(Base):
  __tablename__ = "test"

  id              = Column(Integer, primary_key=True, autoincrement=True)
  name            = Column(String(255), nullable=False)
  email           = Column(String(255), nullable=False)
  created_at      = Column(TIMESTAMP, nullable=False, server_default=func.now())
  updated_at      = Column(DateTime, server_default=text("CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP")) 
```

在mariadb 的 sqlalchemy[文档](https://docs.sqlalchemy.org/en/14/dialects/mysql.html#timestamp-datetime-issues)中，建议`text`从 sqlalchemy 本身导入并设置`server_default`，`text`插入自定义命令。

```
updated_at=Column(DateTime, server_default=text("CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP")) 
```

要了解[`func.now`](https://docs.sqlalchemy.org/en/14/core/functions.html#sqlalchemy.sql.functions.now)，您可以阅读 sql alchemy 文档。

希望我在某种程度上有所帮助。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-07-30T09:27:08.263

Jeff Widman 在[他的回答](https://stackoverflow.com/a/33532154/5193682)中说，您需要创建自己的 UTC 时间戳实现`func.utcnow()`

由于我不想自己实现它，所以我搜索并找到了一个已经完成这项工作并由许多人维护的 python 包。

包名称是[spoqa/sqlalchemy-ut](https://pypi.org/project/SQLAlchemy-Utc/)。

包的作用总结是：长话短说，UtcDateTime 做了：

只接受有意识`datetime.datetime`，只返回有意识`datetime.datetime`，从不接受或返回 naive `datetime.datetime`，确保数据库中的时间戳始终以 UTC 编码，并按预期工作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-09-29T15:49:26.733

请注意 for`server_default=func.now()`和`func.now()`to 工作：

```
Local_modified = Column(DateTime, server_default=func.now(), onupdate=func.now()) 
```

你需要`DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP`在你的表中设置 DDL。

例如

```
create table test
(
    id int auto_increment
        primary key,
    source varchar(50) null,
    Local_modified datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
)
collate=utf8mb4_bin; 
```

否则，`server_default=func.now(), onupdate=func.now()`不会产生任何影响。

# bash - Bash：将'times'内置的输出分配给一个变量

> ID：13370318
> 
> 赞同：8
> 
> 时间：2012-11-13T22:55:02.967
> 
> 标签：bash

在一个`bash`脚本中，我想将`times`内置函数的输出分配给一个数组变量，但我发现没有比这更好的方法了

```
tempnam=/tmp/aaa_$$_$RANDOM
times > ${tempnam}
mapfile -t times_a < ${tempnam} 
```

我将输出写入临时文件并在数组 times_a 中读回它，因为管道或`$(times)`将在子外壳中执行并返回错误的值。

没有临时文件有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-14T01:20:09.207

您需要解决的基本问题是如何`time`在同一个 shell 中同时执行和分配变量，而不需要临时文件。几乎 Bash 提供的将一个事物的输出通过管道传输到另一个事物或捕获命令输出的每一种方法，都有一面在子 shell 中工作。

这是一种无需临时文件即可完成的方法，但我会警告您，它并不漂亮，它不能移植到其他 shell，而且它至少需要 Bash 4：

```
coproc co { cat; }; times 1>&${co[1]}; eval "exec ${co[1]}>&-"; mapfile -tu ${co[0]} times_a 
```

我会为你分解这个：

```
coproc co { cat; } 
```

这会创建一个协同进程；一个在后台运行的进程，但是你有管道来与它的标准输入和标准输出通信，它们是 FD `${co[0]}`(standard out of `cat`) 和`${co[1]}`(standard in of `cat`)。命令在子shell中执行，因此我们不能在其中执行任何一个目标（运行`times`或读取变量），但我们可以使用`cat`简单地将输入传递到输出，然后使用该管道进行对话到`times`并`mapfile`在当前 shell 中。

```
times >&${co[1]}; 
```

运行`times`，将其标准输出重定向到`cat`命令的标准输入。

```
eval "exec ${co[1]}>&-" 
```

关闭命令的输入端`cat`。如果我们不这样做，`cat`将继续等待输入，保持其输出打开，并`mapfile`继续等待，导致您的 shell 挂起。`exec`，当不传递任何命令时，只需将其重定向应用到当前 shell；重定向到`-`关闭 FD。我们需要使用`eval`，因为 Bash 似乎有问题`exec ${co[1]}>&-`，将 FD 解释为命令而不是重定向的一部分；using`eval`允许先替换该变量，然后再执行。

```
mapfile -tu ${co[0]} times_a 
```

最后，我们实际上从协程中读取了标准中的数据。我们已经设法在这个 shell 中同时运行`times`和`mapfile`命令，并且没有使用临时文件，尽管我们确实使用了一个临时进程作为两个命令之间的管道。

请注意，这有一个微妙的比赛。如果你一个一个地执行这些命令，而不是全部作为一个命令，最后一个失败；因为当您关闭`cat`s 标准时，它会退出，导致协进程退出并关闭 FD。看起来，当全部在一行上执行时，`mapfile`执行速度足够快，以至于协同进程在运行时仍然处于打开状态，因此它可以从管道中读取；但我可能会走运。我还没有想出解决这个问题的好方法。

总而言之，写出临时文件要简单得多。我会`mktemp`用来生成一个文件名，如果你在一个脚本中，添加一个陷阱以确保你在退出之前清理你的临时文件：

```
tempnam=$(mktemp)
trap "rm '$tempnam'" EXIT
times > ${tempnam}
mapfile -t times_a < ${tempnam} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-07-25T07:55:21.423

[Brian 的回答](https://stackoverflow.com/a/13371702/6232717)让我对这个问题非常感兴趣，导致这个解决方案没有竞争条件：

```
coproc cat;
times >&${COPROC[1]};
{
  exec {COPROC[1]}>&-;
  mapfile -t times_a;
} <&${COPROC[0]}; 
```

* * *

这在底层结构上与 Brian 的解决方案非常相似，但有一些关键区别确保不会因时间问题而发生有趣的事情。正如 Brian 所说，他的解决方案通常有效，因为 bash 解释器`mapfile`在协进程的文件描述符完全关闭和清理之前开始运行命令，因此之前或期间的任何意外延迟`mapfile`都会破坏它。

* * *

本质上，`stdout`在我们关闭协同进程的`stdin`文件描述符后，协同进程的文件描述符就会关闭。我们需要一种方法来保存协同进程' `stdout`。

在[pipe 的手册页中](https://man7.org/linux/man-pages/man7/pipe.7.html)，我们发现：

> 如果所有引用管道读取端的文件描述符都已关闭，则 write(2) 将导致为调用进程生成 SIGPIPE 信号。

因此，我们必须为协进程保留至少一个文件描述符`stdout`。[使用Redirections](https://www.gnu.org/software/bash/manual/html_node/Redirections.html#Moving-File-Descriptors)很容易做到这一点。我们可以做一些事情，比如`exec 3<&${COPROC[0]}-`将协同进程的`stdout`文件描述符移动到新创建的`fd 3`^([1](https://stackoverflow.com/a/13371702/6232717))。当协同进程终止时，我们仍然拥有它的文件描述符`stdout`并能够从中读取。

* * *

现在，我们可以执行以下操作：

1.  创建一个除了`cat`.

    ```
    coproc cat; 
    ```

2.  重定向到协同`times`进程。`stdout``stdin`

    ```
    times >&${COPROC[1]}; 
    ```

3.  `stdout`获取协同进程文件描述符的临时副本。

4.  关闭协同进程的`stdin`文件描述符。^(（如果使用 Bash-4.3 之前的版本，您可以使用`eval`Brian 使用的技巧。）)

    ```
    exec 3<&${COPROC[0]} {COPROC[1]}>&-; 
    ```

5.  从我们的临时文件描述符中读取到一个变量中。

    ```
    mapfile -tu 3 times_a; 
    ```

6.  关闭我们的临时文件描述符（不是必需的，但很好的做法）。

    ```
    exec 3<&-; 
    ```

* * *

我们完成了！但是，我们仍然有一些机会进行重组以使事情更整洁。由于重定向语法的性质，这段代码：

```
coproc cat;
times >&${COPROC[1]};
exec 3<&${COPROC[0]} {COPROC[1]}>&-;
mapfile -tu 3 times_a;
exec 3<&-; 
```

行为与此代码相同：

```
coproc cat;
times >&${COPROC[1]};
{  
  exec {COPROC[1]}>&-;
  mapfile -tu 3 times_a;
} 3<&${COPROC[0]}; 
```

* * *

从这里，我们可以完全删除临时文件描述符，从而得到我们的解决方案：

重击 4.3+：

```
coproc cat; times >&${COPROC[1]}; { exec {COPROC[1]}>&-; mapfile -t times_a; } <&${COPROC[0]} 
```

重击 4.0+：

```
coproc cat; times >&${COPROC[1]}; { eval "exec ${COPROC[1]}>&-"; mapfile -t times_a; } <&${COPROC[0]} 
```

* * *

^([1](https://stackoverflow.com/a/13371702/6232717)^(我们不需要在此处关闭原始文件描述符，只需复制它即可，因为当标准输入描述符关闭时，原始文件描述符也会关闭))

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T00:55:44.060

哇，好问题。

一个改进是使用 mktemp，这样您就不必依赖随机性来保持文件的唯一性。

```
TMPFILE=$(mktemp aaa_XXXXXXXXXX)
times > "$TMPFILE"
mapfile -t times_a < ${tempnam}
rm "$TMPFILE" 
```

另外，我使用 for 而不是 mapfile（因为我没有 mapfile）。

```
a=0; for var in $(cat "$TMPFILE"); do ((a++)); TIMES_A[$a]=$var; done 
```

但是，是的，我看不出没有文件或命名管道如何做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T23:50:28.240

做类似事情的一种可能性是

```
times > >(other_command) 
```

它是与进程替换相结合的输出重定向。这种方式`times`在当前 shell 中执行，输出重定向到一个新的子进程。因此，这样做`mapfile`并没有多大意义，因为该命令不会在同一个 shell 中执行，这可能不是您想要的。这种情况有点棘手，因为您不能调用在子shell中执行的shell内置函数。

# iphone - MKMapView 没有缩放到区域

> ID：13370328
> 
> 赞同：0
> 
> 时间：2012-11-13T22:56:00.173
> 
> 标签：iphone, ios, ipad, mkmapview

我有一个 MKMapView，我正在尝试设置地图，这样当您第一次加载应用程序时，它会转到用户设置的位置，如果用户没有设置，则转到默认位置。问题是它似乎总是去 0 纬度，0 经度。

```
-(void) viewDidLoad {

  [worldView setShowsUserLocation:YES];

  double longitude = [[NSUserDefaults standardUserDefaults] doubleForKey:WhereamiNewLongPrefKey];

  double latitude = [[NSUserDefaults standardUserDefaults] doubleForKey:WhereamiNewLatPrefKey];

  CLLocationCoordinate2D savedLoc = CLLocationCoordinate2DMake(latitude, longitude);

  MKCoordinateRegion region = MKCoordinateRegionMakeWithDistance(savedLoc, 250, 250);

  NSLog(@"latitude :%f", region.center.latitude);      
  NSLog(@"longitude :%f", region.center.longitude);

  [worldView setRegion:region animated:YES];
} 
```

我尝试设置`setShowUserLocation`为`NO`，但这不起作用。我知道它正在读取正确的区域，因为它`NSLog`正在输出默认纬度，但地图坚持要去中国的某个地方......

我也尝试将区域设置为`mapView:didUpdateUserLocation:`，但结果仍然相同。

我究竟做错了什么？

编辑：我也添加了`NSLog`输出经度。输出是：

```
2012-11-14 09:50:30.699 Whereami[34256:13d03] latitude :20.516700
2012-11-14 09:50:30.699 Whereami[34256:13d03] longitude :99.900000 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T16:41:15.567

```
CLLocationCoordinate2D theCoordinate;
theCoordinate.latitude = 20.516700;
theCoordinate.longitude = 99.900000;

MKCoordinateRegion viewRegion = MKCoordinateRegionMakeWithDistance(theCoordinate, 1000, 1000);
MKCoordinateRegion adjustedRegion = [self.mapView regionThatFits:viewRegion];  
[self.mapView setRegion:adjustedRegion animated:YES]; 
```

# net-use - 从 Windows 到 Linux 的幻影映射网络驱动器号

> ID：13370329
> 
> 赞同：6
> 
> 时间：2012-11-13T22:56:06.840
> 
> 标签：net-use

我一直在使用 robocopy 和映射网络驱动器将不受信任的 Windows 域中的备份复制到一个中心位置，然后将它们推送到 Ubuntu 存储设备，我遇到了很多异常情况。我现在看到的一个是映射的网络驱动器，它似乎在任何用户上下文中都不存在。这些都是以我个人身份执行的，或者“以管理员身份运行”，两者都有相同的结果。

*请注意，这在 Powershell 中有效，但在 CMD 中无效。*

*删除所有映射的驱动器：*

```
Z:\Scripts>net use * /delete
There are no entries in the list. 
```

*尝试明确删除 W: drive*

```
Z:\Scripts>net use w: /delete /y
The network connection could not be found.

More help is available by typing NET HELPMSG 2250. 
```

*尝试将目录更改为映射驱动器，注意登录失败*

```
Z:\Scripts>w:
Logon failure: unknown user name or bad password. 
```

*再次尝试删除*

```
Z:\Scripts>net use W: /delete /y
The network connection could not be found.

More help is available by typing NET HELPMSG 2250. 
```

*没有显示连接*

```
Z:\Scripts>net use
New connections will not be remembered.

There are no entries in the list. 
```

*W：驱动器不存在*

```
Z:\Scripts>net use W: /delete /Y
The network connection could not be found.

More help is available by typing NET HELPMSG 2250. 
```

*尝试将驱动器映射到它*

```
Z:\Scripts>NET use W: \\servername\sharename PASSWORD /user:domain\username
System error 85 has occurred.

The local device name is already in use. 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2017-06-19T14:52:59.770

[我在这里](https://social.technet.microsoft.com/Forums/windows/en-US/b611f1e0-2364-455c-b2ae-e6bd0c73bb86/mapped-drive-will-not-disconnect?forum=w7itpronetworking)找到了一个在相同情况下对我有帮助的答案。基本上，如果网络驱动器是由系统自动创建的，那么它是由用户完成的，`nt authority\system`即使`administrator`. 要删除它，`nt authority\system`可以使用[PsExec](https://technet.microsoft.com/en-us/sysinternals/bb897553.aspx)例如：

```
psexec -s -i cmd
net use W: /delete 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-12T15:51:51.107

尝试重新启动系统，使您没有幻像驱动器，然后再次映射它

```
net use W: \\servername\sharename pass /domain\username /persistent:yes 
```

以便它记住您的凭据，然后查看问题是否再次出现。我曾经遇到过类似的问题，在 1-2 次地图/断开连接后出现幻影驱动器，这对我有用。

如果这不起作用，请尝试仅使用

```
net use /persistent:no 
```

以便它完全不记得任何连接并再次检查。

# c++ - C++Math 计算不正确

> ID：13370330
> 
> 赞同：0
> 
> 时间：2012-11-13T22:56:07.300
> 
> 标签：c++

我想我可以通过制作一个返回平均值抽样分布结果的小程序（带有标准误差）来使数据统计的生活变得更轻松。它成功地完成了这部分，但为了尝试使用我在[此处](http://www.onlinemathlearning.com/image-files/normal-distribution_4.gif)找到的公式返回 z 分数，它返回`-1#IND`. 我对该公式的解释是：

```
((1 / (sqrt(2 * pi) * stdev)) * pow(e, (normalpow)) 
```

在哪里

```
double normalpow = -0.5 * ((mean - popmean) * (mean-popmean) / stdev) 
```

我做了更多调查，发现无论如何都`(mean - popmean) * (mean - popmean)`在评估。`0`我怎样才能解决这个`normalpow`评估到的问题`0`。

```
#include <iostream>
#include <string>
#include <sstream>
#include <math.h>

using namespace std;

double number  ;
double mean ;
double popmean ;
double stdev ;
double square = 2;
double e = 2.71828182845904523536;
double pi = 3.14159265358979323846;
double normalpow = -0.5*((mean-popmean)*(mean-popmean)/stdev);
int main ()
{
    string continuer ;
    do
    {
        cout << "Enter Sample Mean: " << endl;
        cin >> mean;
        cout << "Enter Population Mean: " << endl;
        cin >> popmean;
        cout << "Enter Standard Deviation: " << endl;
        cin >> stdev;
        cout << "Enter Sample Size: " << endl;
        cin >> number;
        if (stdev == 0)
            cout << ((mean-popmean)/(number))<< endl;
        else
        {
            cout << ((mean-popmean)/((stdev)/(sqrt(number))))<< endl;
            cout << ((1/(sqrt(2*pi)*stdev))*pow(e, (normalpow)))<< endl;
        }
        cout << "If you want to continue, Press Y" << endl ;
        cin >> continuer;
    } while (continuer == "Y" || continuer == "y") ;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T23:17:53.663

你的问题在这里：

```
double normalpow = -0.5*((mean-popmean)*(mean-popmean)/stdev); 
```

此时`mean`，`popmean`和`stdev`具有垃圾值，因为它们尚未初始化。听起来你想要的是一个函数。

```
double normalPow(double mean, double popmean, double stddev)
{
  return -0.5*((mean-popmean)*(mean-popmean)/stdev);
} 
```

然后在你的 main 中调用它：

```
double normalpow = normalPow(mean, popmean, stdev); 
```

当然，您应该在函数中检查`stdev`相等或接近`0.`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T23:18:09.383

```
using namespace std;

double number  ;
double mean ;
double popmean ;
double stdev ;
double square = 2;
double e = 2.71828182845904523536;
double pi = 3.14159265358979323846;
double normalpow = -0.5*((mean-popmean)*(mean-popmean)/stdev); 
```

这些都是具有静态存储持续时间的变量，因此那些没有显式初始化器的变量被初始化为 0。

因此`mean`，`popmean`和在初始化`stdev`时都是 0 `normalpow`，并且初始化导致

```
double normalpow = -0.5*(0.0*0.0/0.0); 
```

这给出了一个 NaN。

之后您永远不会更改`normalpow`，因此任何涉及它的计算都会导致 NaN。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T23:01:58.187

这取决于如何计算`mean`和`popmean`计算。`mean - popmean`如果它们相同，则计算为零：`mean == popmean`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T23:12:10.173

而且您使用的公式不正确，因为您没有计算标准偏差的平方。

# javascript - 如何在jquery中突出显示匹配术语的文本？

> ID：13370331
> 
> 赞同：0
> 
> 时间：2012-11-13T22:56:28.953
> 
> 标签：javascript, jquery

我有项目列表和一个搜索框。如果在搜索框中输入了搜索词，则匹配的文本应在列表中以粗体字母显示，无论大小写如何（不区分大小写）。我已经做到了一定程度，但后来我不知道该怎么做，因为我是 jquery 的新手。

```
<html>
<head>
    <script type="text/javascript" 
          src="http://code.jquery.com/jquery-1.8.2.js"></script>
    <script type="text/javascript">
       $(document).ready(function(){
          $(".SearchElement").keyup(function(){
            keyword = $(".SearchElement").val();
            if(keyword.length>=3){
                 var content = $(".wrapperbox ul li").text();
                 test = content.match(/keyword/gi)
                 if(test){
                     //alert(test);
                 }
            }
          });
        });
    </script>
</head>
<body>
    <form action="">
        <label>SearchTerm:</label> <input type="text" 
        name="SearchBox" value="" class="SearchElement" />
    </form>
    <div class="wrapperbox">
        <ul>
            <li>TestString</li>
            <li>testString</li>
            <li>Kanigiri</li>
            <li>KANIGIRI</li>
        </ul>
    </div>
</body>
</html> 
```

我该怎么做，任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:08:39.093

```
<html>
<head>
    <script type="text/javascript" 
          src="http://code.jquery.com/jquery-1.8.2.js"></script>
    <script type="text/javascript">
       $(document).ready(function(){
          $("#SearchElement").keyup(function(){
            keyword = $("#SearchElement").val();
            if(keyword.length>=3){
                 $(".wrapperbox ul li").each(function(index) {
                      var content =  = $(this).text());
                      test = content.match(/keyword/gi);
                      if (test){
                           $(this).replaceWith( "<li><b>" + $(this).text() + "</b></li>" );
                      }                      
                 });

            }
          });
        });
    </script>
</head>
<body>
    <form action="">
        <label>SearchTerm:</label> <input type="text" 
        name="SearchBox" id="SearchBox" value="" class="SearchElement" />
    </form>
    <div class="wrapperbox">
        <ul>
            <li>TestString</li>
            <li>testString</li>
            <li>Kanigiri</li>
            <li>KANIGIRI</li>
        </ul>
    </div>
</body>
</html> 
```

1.  使用 ID 引用您的表单输入
2.  使用 each() 循环
3.  基本上在那个循环中摆弄并找到替换（我做了一个弱版本 - 未经测试，并根据你的代码来帮助你）但希望你能看到我要去哪里

# php - 删除功能并上传

> ID：13370332
> 
> 赞同：-1
> 
> 时间：2012-11-13T22:56:49.003
> 
> 标签：php, mysqli

**必须说我下载了数据库，我的所有功能都在课堂上。**

这就是我令人难以置信的高兴功能并认为它们很好..

这就是我要建立一个画廊的方式，如果上传到网站的 id 与 id_session 相符，则它是登录页面，您可以选择删除它。因此，当它从文件夹和数据库中删除它时，它必须返回到/最新图片/。但它出现了一个错误，正如您在此处看到的那样；

致命错误：在 /home/jesperbo/public_html/mebe.dk/function/function.php 中的非对象上调用成员函数 bind_param() 第 411 行

正是这样，我也在构建一个上传系统的过程中，其中底层数据库并在我现在设置它之后将其缩小，当它完成时，这两件事必须将我送回 / latest-images / 但它确实没有到达服务器上唯一可用的图片并使用图片执行此操作，但它根本不会以某种方式返回。所以到/最新图像/

删除有什么问题等等。我就躺在这里，

```
$stm1->bind_param('i', $id_gallery);

function img_slet_indhold(){
        if($_SESSION["logged_in"] = true && $_SESSION["rank"] == '1' || $_SESSION["rank"] == 2)
        {
            if($stmt = $this->mysqli->prepare('SELECT `title` FROM `gallery` WHERE `id_gallery` = ?'))
            {
                $stm1->bind_param('i', $id_gallery);
                $id_gallery = $_GET["id_gallery"];

                $stm1->execute();
                $stm1->store_result();
                $stm1->bind_result($title);

                $UploadDir = "/gallery/";
                //ligger i toppen af documentet, evt som en define

                if($stm1->fetch())
                {
                    $tmpfile = $UploadDir . "" . $title;
                    if(file_exists($tmpfile))
                    {
                        unlink($tmpfile);
                    }
                    $tmpfile = $UploadDir . "lille/" . $title;
                    if(file_exists($tmpfile))
                    {
                        unlink($tmpfile);
                    }
                    $tmpfile = $UploadDir . "store/" . $title;
                    if(file_exists($tmpfile))
                    {
                        unlink($tmpfile);
                    }
                }
                $stm1->close();
            }
            else
            {
                /* Der er opstået en fejl */
                echo 'Der opstod en fejl i erklæringen: ' . $mysqli->error;
            }
        }

        if($stmt = $this->mysqli->prepare('DELETE FROM `gallery` WHERE `id_gallery` = ?' ))
        {
            $stmt->bind_param('i', $id);
            $id = $_GET["id_gallery"];

            $stmt->execute();

            header('Location: /nyeste-billeder/');

            $stmt->close();

        }
        else
        {
            /* Der er opstået en fejl */
            echo 'Der opstod en fejl i erklæringen: ' . $mysqli->error;
        }
    } 
```

所以进入应该删除的文件，我选择在这里这样做；

```
<?php 
session_start();
require_once ("function/function.php");
$mebe = new mebe;
$db = $mebe->db_c();
error_reporting(E_ERROR);

$img_slet_indhold = $mebe->img_slet_indhold();

?> 
```

所以当我将图像上传到文件夹和数据库时，上传时可以返回

```
function img_indhold(){
        if($_SESSION["logged_in"] = true && $_SESSION["rank"] == '1' || $_SESSION["rank"] == 2)
        {
            include "function/class.upload.php";
            $handle = new Upload($_FILES["filename"]);

            if($handle->uploaded)
            {
                //lidt mere store billeder
                $handle->image_resize = true;
                $handle->image_ratio_y = true;
                $handle->image_x = 220;
                $handle->Process("gallery/store");

                //til profil billede lign..
                $handle->image_resize = true;
                $handle->image_ratio_crop = true;
                $handle->image_y = 115;
                $handle->image_x = 100;
                $handle->Process("gallery");

                //til profil billede lign..
                $handle->image_resize = true;
                $handle->image_ratio_crop = true;
                $handle->image_y = 75;
                $handle->image_x = 75;
                $handle->Process("gallery/lille");
                $pb = $handle->file_dst_name;

            }
            if($stmt = $this->mysqli->prepare('INSERT INTO `gallery` (`title`, `id_bruger`) VALUES (?, ?)'))
            {

                $stmt->bind_param('si', $title, $id_bruger);
                $title = $pb;
                $id_bruger = $_SESSION["id"];

                $stmt->execute();

                header('Location: /nyeste-billeder/');

                $stmt->close();

            }
        }
     } 
```

因此，当我需要在页面上调用它时，请这样做；

```
<?php 
session_start();
require_once ("function/function.php");
$mebe = new mebe;
$db = $mebe->db_c();
error_reporting(E_ERROR);

$img_slet_indhold = $mebe->img_slet_indhold();

?> 
```

关于我何时上传到网站并在页面上显示画廊/图片的信息就在这里

```
function vise_img(){
        if ($stmt = $this->mysqli->prepare('SELECT `id_gallery`, `title`, `id_bruger` FROM `gallery` ORDER BY `gallery`.`id_gallery` DESC')) { 
            $stmt->execute();
            $stmt->store_result();
            $stmt->bind_result($id_gallery, $title, $id_bruger);

            while ($stmt->fetch()) {
                echo "<div id=\"gallery_box\">";
                echo "<a href=\"/profil/$id_bruger/\"><img src=\"/gallery/$title\" alt=\"\" height=\"115\" width=\"100\" border=\"0\"></a>";
                if($_SESSION["logged_in"])
                {
                    if($id_bruger == $_SESSION["id"])
                    {
                        echo "<ul>";
                        echo "<li><a href=\"/nyeste-billeder-slet/$id_gallery/\">Slet</a></li>";
                        echo "</ul>";
                    }
                }
                echo "</div>";
            }

            /* Luk statement */
            $stmt->close();

        } else {
            /* Der er opstået en fejl */
            echo 'Der opstod en fejl i erklæringen: ' . $mysqli->error;
        }
    }

   function upload_img(){
        if($_SESSION["logged_in"] = true && $_SESSION["rank"] == '1' || $_SESSION["rank"] == 2)
        {           
        ?>
        <form name="opslag" method="post" action="/nyeste-ok/" enctype="multipart/form-data">
            <input type="file" name="filename" id="filename" onchange="checkFileExt(this)">        
            <input name="upload" value="Upload" id="background_indhold" onclick="return check()" type="submit">
        </form>
        <?php
        }
        elseif ($_SESSION["logged_in"] != true && $_SESSION["rank"] != '1' || $_SESSION["rank"] != 2)
        {
            echo "<p>Du har ingen mulighed for at upload billeder på siden</p>";
        }

    } 
```

**真的希望你能进一步帮助我！**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T23:05:58.637

我很难理解您的问题（我知道英语不是您的第一语言），所以我将根据您提供的错误消息进行。在第一个函数中，`img_slet_indhold()`您的变量`$stmt`在 if 语句中被调用，但您随后将其称为`$stm1`; 这似乎是您的错误的原因。

# cmake - 如何在 BUILD_COMMAND 中为 ExternalProject_Add() 传递 SOME_LIB="-lmylib -lmylib2"？

> ID：13370334
> 
> 赞同：4
> 
> 时间：2012-11-13T22:56:55.253
> 
> 标签：cmake

我正在尝试通过 ExternalProject_Add() 中的 BUILD_COMMAND 传递一个带引号的字符串，并且我尝试的每一种方式都被破坏了。代码是这样的：

```
set (mylibs "-lmylib -lmylib2")
ExternalProject_Add(Foo
    URL             http://foo
    BUILD_COMMAND   make SOME_LIB=${mylibs}
    BUILD_IN_SOURCE 1
    ...) 
```

我尝试过使用反斜杠引号、双引号、内联整个内容，但每次，要么整个 SOME_LIB=... 部分被引用，要么我注入的引号被转义。是否无法通过命令行获取引号，以便它们仅涵盖参数？

即使我无法使生成的调用看起来像`make SOMELIB="-lmylib -lmylib2"`，您也可以调用`make "SOMELIB=-lmylib -lmylib2"`它似乎做同样的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T20:46:39.310

你试过这样引用吗？

```
ExternalProject_Add(
  ...
  BUILD_COMMAND make "SOME_LIB=\"${mylibs}\""
  ...
) 
```

外面的一对双引号表示“这只是一个参数”，而内部的一对转义双引号表示“这些都嵌入在参数中”。

不过，它可能需要额外的转义。我还没有尝试过，我不确定它是否会起作用。但是应该有一种方法可以添加转义字符，直到它确实起作用......或者，最坏的情况是，您可以编写一个脚本文件（bash .sh 或批处理 .bat），该文件具有适当的 shell 语法，可以像您想要的那样调用 make然后调用执行脚本文件作为 BUILD_COMMAND。

# c# - 更新 JSON 文件 C# W8 开发

> ID：13370337
> 
> 赞同：0
> 
> 时间：2012-11-13T22:57:18.350
> 
> 标签：c#, windows-8, visual-studio-2012

目前，我有一个 JSON 文件，其内容如下所示：

```
{
"username": "test", 
"someNumber": 100
} 
```

我正在使用 JSON.Net 从网络服务器获取 .JSON 文件 - C#：

```
 var http = new HttpClient();
        http.MaxResponseContentBufferSize = Int32.MaxValue;
        var response = await http.GetStringAsync(URI);

        var result = JsonConvert.DeserializeObject<DatClass.Result>(response); 
```

这与获取/设置属性的类一起工作得很好。但是，我想知道的是用户是否有一种通过文本框 UI 更新 .JSON 文件的好方法？如：

[文本框 - 更新用户名] [更新按钮] -> 发送到服务器的用户名 -> 更新的 .JSON 文件 -> [文本块 - 在 UI 中显示更新的用户名]。

我不是在寻找确切的代码解决方案，而是在寻找好的解决方案，和/或如果这是一个简单数据库的糟糕想法（？）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T08:41:35.640

行。现在我懂了 ：）

所以你想要一个数据库。然后读这个。3种方法

1.  你的方式。您想使用 JSON 文件。好的，它会起作用，但这是一个糟糕的方式。如果你有 1 MB 的文件（它不是那么大），那么每次你必须读取它、反序列化、更新数据、序列化并再次写入它。这不是一个好办法。

2.  SQLite。如果您想要本地数据库，请使用 SQLite。我正处于测试阶段，它看起来不错。缺点是形式不佳。你需要自己管理一些事情，但它工作得很好。这是一个本地数据库，所以这不是一个坏方法

3.  天蓝色数据库。主要缺点是您的应用程序依赖于互联网连接，您需要创建一个 API 来提供与数据库的连接，因为 Windows 应用商店应用程序无法自行连接到它们。您还需要考虑创建缓存引擎，因为每次都要求这样做是没有意义的。您可以获取数据并为某些视图缓存它们。这样应用程序将运行得更快

// 编辑

在您更新的情况下，您有 2 个解决方案

1.  使用 SQLite 作为 Web 数据的较小本地缓存。这将使您的应用程序更加独立于互联网连接
2.  只是去互联网依赖的应用程序

在所有这些情况下，您需要一个 web 中的 db 和一些 api 来连接它

# javascript - javascript window.onbeforeunload 无法正常工作

> ID：13370355
> 
> 赞同：0
> 
> 时间：2012-11-13T22:58:56.963
> 
> 标签：javascript, onbeforeunload

**更新：*我试图让 onbeforeunload 工作的页面发生了一些事情。我在布局中设置了它，除了那个页面之外的每个页面都会弹出它......所以必须有一些损坏的javascript，或者重新定义onbeforeunload的javascript文件。因为它只能定义一次***

我正在开发一个 Rails 项目，我正在设置一个弹出窗口来提醒用户如果他们离开页面而不保存，他们的数据将会丢失。所以我正在使用 window.onbeforeunload

我通过将此脚本代码添加到视图文件的顶部来将其设置在一个页面上

```
var saving = false;

window.onbeforeunload = function(){
    if(!saving)
      return 'Are you sure you don\'t want to save before you leave?';
}; 
```

如果用户点击保存按钮，则保存设置为 true，这会将他们重定向到单独的页面。

当我尝试在单独的视图文件上设置完全相同的东西时，问题就出现了，它也需要相同的功能。

除非我将上面的代码放入文件中，否则根本不会弹出任何内容......在任何时候。因此，我查看了其他可用选项来设置 onbeforeunload 功能。

所以我目前将其设置为：

```
var saving = false;

window.onbeforeunload = displayConfirm();

function displayConfirm(){
    if(!saving){
      if(confirm('If you leave without saving, your changes will be lost. Press cancel to go back to save')){
        confirmExit();
      }
    }
} 
```

在第二页。我的问题是这里的弹出窗口与第一个实现不同。更奇怪的是，弹出窗口出现在窗口加载...而不是在窗口卸载之前。

几个小时以来，我一直在四处寻找和解决这个问题。我开始变得非常恼火，因为这应该是一个简单的补充。看看它是如何在单独的页面上设置的，并且工作正常。任何关于可能出现问题的见解，或者如果我犯了一个愚蠢的错误，将不胜感激。

谢谢，

-艾伦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:02:20.797

尝试

```
window.onbeforeunload = displayConfirm; 
```

您实际上是立即调用该函数并将其返回值分配`displayConfirm()`给 window.onbeforeunload。

**更新**`return`但是您的 onbeforeunload 函数 中仅限于一个语句，请参见[此处](https://developer.mozilla.org/en-US/docs/DOM/window.onbeforeunload)。所以调用“确认”或其他一些自定义函数不起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T23:04:15.093

1) `window.onbeforeunload = displayConfirm();`-- 你正在触发函数，而不是分配它

2)`onbeforeunload`很棒，但在很多方面都不受支持。有些浏览器甚至没有它，期间（例如，除了最新的 Opera 之外的所有浏览器），所以如果你是为广大观众做这个，或者你需要它来 100% 跨浏览器工作，`onbeforeunload`遗憾的是还不够在其自己的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-27T09:51:42.687

Recently i was working on a project using this event, so i did do some search on the net. There are few thing need to be taken into consideration when using the onbeforeunload event.

1.  It is not supported by all browser. Opera, especially older version. Some support it partially, such as not firing when refresh button is pressed.
2.  Using this event will cause the page will not be cached.

Here is an article that is more thorough about the onbeforeonload event by [Patrick Hunlock](http://www.hunlock.com/blogs/Mastering_The_Back_Button_With_Javascript).

# java - java regex 中有没有办法定义一组要查找的字母？

> ID：13370357
> 
> 赞同：2
> 
> 时间：2012-11-13T22:59:21.643
> 
> 标签：java, regex

换句话说，我想确保用户输入的是 A、a、L 或 l。到目前为止，我的解决方案是这样，但我没有得到正确的正则表达式。

```
while(!qtype.hasNext("A| L") || !qtype.hasNext("a| l")){
    System.out.print("Please enter 'A' or 'L':");
    qtype.next().toUpperCase();
}
qal = qtype.next().toUpperCase(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T23:01:36.990

要确定字符串`str`是`"A"`,`"a"`还是您`"L"`可以`"l"`使用

```
str.matches("[AaLl]") 
```

如果您不想使用正则表达式：

```
str.equalsIgnoreCase("A") || str.equalsIgnoreCase("L") 
```

* * *

尝试这样的事情：

```
while (! (qal = qtype.next()).matches("[AaLl]"))
    System.out.print("Please enter 'A' or 'L': "); 
```

# jquery - 覆盖 Web Essentials 2012 中的缩小行为

> ID：13370359
> 
> 赞同：2
> 
> 时间：2012-11-13T22:59:45.563
> 
> 标签：jquery, asp.net-mvc, asp.net-mvc-4, web-essentials

我安装了带有 Web Essentials 2012 的 Visual Studio 2012，我正在使用它来缩小我的 javascript 文件。然后我使用 Telerik ScriptRegistrar 即时创建捆绑包。

在部署测试时，我们发现了一个问题，即 Web Essentials 会从每个文件中删除最后一个分号，从而导致 javascript 无效。存在最后一个分号的原因是，当文件被捆绑时，浏览器不会将任何 jquery 插件的第一行解释为前一个文件最后一行的一部分。这通常发生在前一个文件以 document.ready 的 jQuery 简写结尾时，如下所示：

```
$(function () {
    alert('This bloody code will break if the next file contains a plug in');
}); 
```

每当这种情况发生在包中时，浏览器会在页面生命周期的早期抛出异常，并且页面上的任何 javascript 都不会被加载。

有谁知道阻止 Web Essentials 2012 删除最后一个分号的任何方法？或者，我们可以对我们的脚本做些什么来防止它们相互破坏？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T17:48:31.230

这将在 Web Essentials 1.9 中修复，但您现在可以从最新版本中获得修复：http: //madskristensen.net/custom/webessentials2012.vsix? [1.8.9.1](http://madskristensen.net/custom/webessentials2012.vsix?1.8.9.1)

# playframework - 使用 Play 2.0 框架的动态域和子域

> ID：13370363
> 
> 赞同：3
> 
> 时间：2012-11-13T22:59:51.080
> 
> 标签：playframework, playframework-2.0, netty

我正在使用 Play 2.0 框架，我知道它默认使用 Netty HTTP 服务器。如何设置虚拟主机以便 www.domain1.com 重定向到 www.maindomain.com/sites/domain1.com/？

自 Play 2.0 以来，路由更加克制，似乎没有人在任何地方回答这个问题。

在 Play 1.0 中，可以在路由文件中执行此操作，但现在不可能:(

我也在使用 jar 生产文件（带有 dist），只是为了清楚起见，我知道 Netty 在那里，但我不知道如何添加虚拟主机。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-14T02:03:24.610

似乎我已经找到了自己问题的答案。有大量的PHP背景，没有Web应用背景，对Play 2.0的前后端原理没有正确理解。

我需要做的是让 Play 在 9000 上运行并拥有一个前端 Apache 服务器（一个不同的服务器！）。然后，虚拟主机就像以前一样简单。我不需要接触 Netty HTTP 服务器。

```
<VirtualHost *:80>
  ProxyPreserveHost On
  ServerName www.domain1.com
  ProxyPass  /excluded !
  ProxyPass / http://127.0.0.1:9000/sites/domain1.com/
  ProxyPassReverse / http://127.0.0.1:9000/sites/domain1.com/
</VirtualHost> 
```

[您可以在http://www.playframework.org/documentation/2.0.4/HTTPServer](http://www.playframework.org/documentation/2.0.4/HTTPServer)获得更多信息

# ruby - Rails 3.2.8 / Carrierwave - 图像上传接收多部分不是正常形式

> ID：13370365
> 
> 赞同：0
> 
> 时间：2012-11-13T23:00:02.750
> 
> 标签：ruby, ruby-on-rails-3, file-upload, carrierwave

我有一个 api，我需要从移动设备或其他设备接收图像文件，但没有表单的服务器。我想根据 mac_address 变量检查哪个用户。

该模型具有以下代码：

```
class Image < ActiveRecord::Base

  attr_accessible :mac_address, :superclass_id, :user_id, :file_path, :file_size

  belongs_to :mac_address

  mount_uploader :file_path, FileUploader

end 
```

文件上传器只是：

```
class FileUploader < CarrierWave::Uploader::Base

  storage :fog

  include CarrierWave::MimeTypes
  process :set_content_type

  def store_dir
    "uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}"
  end

end 
```

如果我将文件保存为 JSON base64 base，它已经可以工作了。但是我的同事想以多部分的形式发送。

我尝试了以下建议，但它不起作用：[Uploading a raw file to Rails using Carrierwave](https://stackoverflow.com/questions/6415895/uploading-a-raw-file-to-rails-using-carrierwave)

理想情况下，我希望我的同事将图像发送到：

```
http://localhost:3000/api/v1/images/MAC_ADDRESS?filename=something.png 
```

那么我应该在他的控制器中做什么来接收该文件？从rails做一个表格很容易，但这种方式似乎是不可能的。

我应该如何进行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:18:11.913

如果图像托管在远程服务器上，并且该服务器可从您尝试保存图像的位置获得。你可以试试这个[https://stackoverflow.com/a/5007665/1822298](https://stackoverflow.com/a/5007665/1822298)。

# matlab - 在 MATLAB 中使用 for 循环从 .mat 表中提取行

> ID：13370366
> 
> 赞同：1
> 
> 时间：2012-11-13T23:00:05.587
> 
> 标签：matlab, indexing

我所拥有的是一个变量`X`，它以 9 列和大约 100 行的表格的形式分配给它的值。这是一个例子：

```
X =

  Columns 1 through 7

   -2.2869   -1.1168    0.1430   -4.0753    1.7620   -6.3229   -3.1997
   -2.2504   -1.1022    0.2046   -3.9865    1.7423   -6.2172   -3.1231
   -2.2138   -1.0876    0.2663   -3.8977    1.7226   -6.1115   -3.0465
   -2.1772   -1.0730    0.3279   -3.8089    1.7029   -6.0058   -2.9700 
```

我需要创建一个 for 循环来提取第`r`一个“p”列的第一行。例如`r=3`和`p=4`。

关于我该怎么做的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:04:18.780

我建议你不要使用 for 循环，而是直接索引到矩阵中：

```
out = X(1:r,1:p) 
```

返回 的第一`r`行和第一`p`列`X`。

# c# - 如何对小部件的异步处理进行编程？

> ID：13370372
> 
> 赞同：0
> 
> 时间：2012-11-13T23:00:32.357
> 
> 标签：c#, .net, multithreading

我有我需要做一些工作的文件（小部件）列表。我想以异步方式执行此操作，以便我的界面保持响应。我想用进度更新 UI。这是我的原型代码。我该如何做到这一点？我假设我需要使用线程，但我也不想同时跨越所有线程，一个接一个就可以了。

```
void Process()
{
    var documents = GetDocuments();
    foreach(document in documents)
    {
        ProcessDocument(
        document,
        status => this.TextBox.Text += status); 
    }
}

void ProcessDocument(Document document, Action<string> onCompleted)
{
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:04:35.313

您可以使用[BackgroundWorker 类](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)来处理 Windows 窗体项目中的异步操作。

```
BackgroundWorker worker = new BackgroundWorker();
worker.WorkerReportsProgress = true;
worker.DoWork += (sender, args) => {
    var documents = GetDocuments();
    foreach(var document in documents)
    {
        ProcessDocument(document);
        worker.ReportProgress(0, status);
    }
};
worker.ProgressChanged += (sender, args) => {
    this.TextBox.Text += args.UserState.ToString();
};
worker.RunWorkerAsync(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T23:08:20.763

您可以使用**System.Threading.Thread**类

请记住，您将需要使用委托来安全地更新 UI 上的控件，当在主 UI 线程之外运行时，您无法修改控件。

如果你想在没有委托的情况下轻松完成，因为你认为你可以控制它，你可以设置属性

```
Control.CheckForIllegalCrossThreadCalls=false 
```

因此，您将被允许在没有非法跨线程检查的情况下更新控件

如果您更喜欢使用 BackgroundWorker 类，这允许您绑定一个名为 ProgressChanged 的​​事件，它也允许您更新 UI

```
public void backgroundWorker_DoWork(object sender, DoWorkEventArgs e)
    {
     //thread work
    }

    // This event handler updates the UI
    private void backgroundWorker_ProgressChanged(object sender, ProgressChangedEventArgs e)
    {
        // Update the UI here

    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T23:39:36.543

Framework 4.5 引入了简化异步 .NET 编程的[async/await](http://msdn.microsoft.com/en-us/library/vstudio/hh191443.aspx)关键字。

如果您使用的是 Framework 4，请查看[TPL 。](http://msdn.microsoft.com/en-us/library/dd460717.aspx)

另一方面，如果您使用的是早期版本的 .NET（3.5 和更早版本），那么您应该看看[APM](http://msdn.microsoft.com/en-us/library/ms228963.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T23:14:49.973

还要考虑[反应式扩展](http://msdn.microsoft.com/en-us/data/gg577609.aspx)，尤其是`IObservable<T>`。

# php - PHP money_format 填充数字分组

> ID：13370376
> 
> 赞同：0
> 
> 时间：2012-11-13T23:00:58.527
> 
> 标签：php, formatting, numbers

基本上，我试图在一个排列良好的列中输出一堆数字，格式如下：

```
$##,###.##
$##,###.## 
```

使用以下代码

```
setlocale(LC_MONETARY, 'en_US.utf8');
money_format('%=0(#5.2n',$sum) 
```

它在 $sum 小于 1000 时除外。例如，使用

```
$sum=1550.00; 
```

（如预期）上述代码输出

```
$01,550.00 
```

然而，随着

```
$sum=167.00; 
```

上面的片段输出

```
$000167.00 
```

显然，这不是我需要的。根据[文档](http://php.net/manual/de/function.money-format.php)

> 即使填充字符是数字，分组分隔符也不会应用于填充字符。

因此，这是该函数的预期行为。似乎没有意义，但这就是它的工作原理。

任何有关如何为填充数字获得正确格式的建议将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-12T10:30:26.800

您可以构建自己的格式化功能。[localeconv()](http://se2.php.net/manual/en/function.localeconv.php)将为您提供分隔符等数据以及货币符号的位置。这是我使用的，适合我的需求：

```
function my_number_format($amount) {
    // Get separators
    $l = localeconv();

    $str = number_format($amount, 2, $l['decimal_point'], $l['thousands_sep']);

    // manual padding
    while (strlen(preg_replace('/[^0-9]/', '', $str)) < 10) {
        $init = preg_replace('/[^0-9].*/', '', $str); // initial all-digit sequence
        $str = '0' . (strlen($init) == 3 ? $l['thousands_sep'] : '') . $str; 
    }

    return $amount;
} 
```

# c# - Silverlight 中文本框的可编辑列表框

> ID：13370381
> 
> 赞同：0
> 
> 时间：2012-11-13T23:01:21.330
> 
> 标签：c#, silverlight

我的目标是能够向列表框添加/编辑/删除项目。我通过以下方式创建了一个文本框列表框。我可以显示数据，但无法编辑数据。有人可以帮我修改代码，以便我可以实现此功能。

```
<ListBox Name="lbDemoBox" ItemsSource="{Binding testList}" Grid.Column="0" Grid.Row="0" SelectionChanged="lbDemoBox_SelectionChanged">
        <ListBox.ItemTemplate>
            <DataTemplate>
                <StackPanel Orientation="Vertical">
                    <TextBox Text="{Binding Path=.}"  KeyDown="TextBox_KeyDown" KeyUp="TextBox_KeyUp" GotFocus="TextBox_GotFocus"/>
                </StackPanel>
            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox> 
```

这是后面的代码

```
public partial class MainPage : UserControl
{
    private string focusedString { get; set; }

    public MainPage()
    {
        InitializeComponent();
    }

    private void Window_Loaded(object sender, RoutedEventArgs e)
    {
        LayoutRoot.DataContext = new ViewModel();
    }

    private void TextBox_KeyDown(object sender, KeyEventArgs e)
    {
        if (e.Key == Key.Enter && (Keyboard.Modifiers & (ModifierKeys.Shift)) == ModifierKeys.Shift)
        {
            (lbDemoBox.ItemsSource as ObservableCollection<string>).Add(string.Empty);
        }

    }

    private void TextBox_KeyUp(object sender, KeyEventArgs e)
    {

        if (e.Key == Key.Delete)
        {
            int index = (lbDemoBox.ItemsSource as ObservableCollection<string>).IndexOf(focusedString);

            (lbDemoBox.ItemsSource as ObservableCollection<string>).RemoveAt(index);

        }
    }

    private void TextBox_GotFocus(object sender, RoutedEventArgs e)
    {
        focusedString = (sender as TextBox).Text;
    }

    private void lbDemoBox_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {

    }

}

public class ViewModel
{
    public ObservableCollection<string> testList
    {
        get { return new ObservableCollection<string> { "Item1", "Item2", "Item3" }; }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T10:03:43.940

尝试这个：

```
<TextBox Text="{Binding Path=YourProperty, Mode=TwoWay}" /> 
```

# java - Char 不能被取消引用错误

> ID：13370386
> 
> 赞同：1
> 
> 时间：2012-11-13T23:01:38.267
> 
> 标签：java

我正在寻求解决两个问题的帮助。一个是像这样取消引用 char 的错误：

```
while (c.length() != 1) 
```

我试图让它循环，而`char c`长度不是 1。

`char`第二个错误是由于在用户输入时 尝试读取下一个错误。

```
c = kb.nextChar(); 
```

我不确定这是否是正确的方法，或者它是否返回一个字符串或其他东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T23:02:40.700

`char`类型（原始）没有`length()`方法（假设 c 是 char 类型）

其次，根据 Scanner [javadoc](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Scanner.html)，没有`nextChar()`方法。您可能需要更改为 next();

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T23:06:37.743

你可能必须通过填充一个字符数组（char []）然后获取它的大小来做到这一点......

# java - 在 Java 中过滤列表

> ID：13370390
> 
> 赞同：0
> 
> 时间：2012-11-13T23:01:53.793
> 
> 标签：java, collections, functional-programming

在 Haskell 中，我可以做到

```
filter pred list 
```

`list`使用函数`pred`为真的元素创建一个新列表。Java API 是否有类似的 for`java.util.List`或其他集合？我无法在 API 文档中找到任何内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T23:04:12.630

核心 API 没有，但[Guava](http://code.google.com/p/guava-libraries/)有[`Collections2.filter`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Collections2.html#filter%28java.util.Collection,%20com.google.common.base.Predicate%29)，它接受一个`Collection`and[`Predicate`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/base/Predicate.html)并返回过滤元素的*视图*（您可以自由地将其复制到一个新的 中`List`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T23:08:58.097

[正如您可能从Java 文档中](http://docs.oracle.com/javase/6/docs/api/java/util/List.html)看到的那样 List 。核心 API 没有过滤器。

我只会遍历列表并将您需要的任何内容拉入新列表。

# php - 客户端-服务器架构决策

> ID：13370395
> 
> 赞同：2
> 
> 时间：2012-11-13T23:02:29.247
> 
> 标签：php, ajax, curl, architecture, client-server

这与其说是故障排除问题，不如说是行业标准问题。

我正处于需要解决和实施架构标准的十字路口。这些标准之一涉及客户端应用程序（基于 AngularJS，因此具有多个视图的单页持久性）和第三方信息源之间的通信路径。

对我来说，通过我的后端路由对第三方库和数据的所有请求，然后通过`CURL`.

这样，我的服务器就充当了客户端和外部世界之间的网关（很像手机塔路由器和手机之间的关系）。

我很好奇行业标准对此有何看法，以及潜在的陷阱。对我来说，从长远来看，它似乎会创造更多的秩序、组织和安全。

请让我知道您对此有何想法，因为我需要外部观点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T21:52:34.373

不确定这是否重要，因为我不了解任何行业标准-但我将其解释为您真正要求的是一般的外部观点。所以这里是：

我的简短回答是，我认为你在正确的轨道上。

我认为它更干净，因为它使数据路径保持简单，因为您的客户端总是向您的服务器发送请求 - 所以基本上您的客户端和其他所有东西之间的耦合非常松散（除了服务器上的控制器，这很好，甚至是必要的国际海事组织）。想稍后更改数据源？客户端不受影响（除非格式当然不同）。如果您可以想象自己将来出于某种原因想要将原始数据存储在数据库中，这也是有益的。根据您要连接的服务以及您想对数据执行的操作，通过您自己的服务器可以带来安全优势（例如，如果您需要使用私钥对 3rd 方服务进行身份验证，就像必须使用万事达卡提供的 API）。

但是，性能会受到影响，因为除了产生额外的请求和 DNS 查找之外，它还为您的服务器提供了更多的工作并需要更多的内存。再说一次，您将控制缓存，因此在某些情况下您可以使服务更加健壮。

所以除非性能是最重要的，否则我会走你想的路。究竟如何在您的服务器上完成路由是一个不同的问题，可能需要进行一些测试。只要确保您使用的方法可以让您优雅地处理可能弹出的任何错误:)

# asp.net - 使用数据表和作为 ArrayList 的数据源对网格视图进行排序

> ID：13370398
> 
> 赞同：0
> 
> 时间：2012-11-13T23:02:35.023
> 
> 标签：asp.net, sorting, gridview, datatable, postback

[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.sorting.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.sorting.aspx)

本文首先处理创建一个数据表，然后从中创建一个网格视图，以帮助进行排序。我的困境略有不同。

我有一个 Gridview，在 Page_Load 上，我将数据源设置为 ArrayList，然后绑定。

```
 protected void Page_Load(object sender, EventArgs e)
    {
        if (!Page.IsPostBack)
        {
            this.GridView1.DataSource = RequestManager.Instance.GetAllRequests();
            this.GridView1.DataBind();
        }
    } 
```

现在我想对这个 GridView 进行排序，所以在 aspx 页面上，我设置了 AllowSorting="true" 和 OnSorting="GridView1_Sorting"。到目前为止，一切都很好。我在 BoundFields 中设置了 SortExpressions，当我点击它时，我知道触发了 _Sorting 事件。

现在，由于这是一个回发操作，我不能简单地将 gridview 的数据源转换为 DataTable 进行排序。保存到 ViewState 是一种选择，但我不知道该怎么做。

我想使用[此页面](http://weblogs.asp.net/vikram/archive/2008/04/15/manually-sorting-and-paging-gridview-without-using-datasource-control.aspx)上的简单解决方案，但 DataTable 对我不可用。感谢您的关注。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T02:20:32.093

如果您能够以 .NET v3.5 为目标，我建议您使用 Linq。在您的 _Sorting 事件处理程序中，获取您在 Page_Load 中所做的数组列表并重新绑定它。

例如，如果数组列表中包含的类型是`MyType`具有名为 Default 和 SomeField 的属性的实例：

```
protected void Grid_Sorting(object sender, GridViewSortEventArgs e)
{
  Func<MyType, object> keySelector;
  if(e.SortExpresion == "SomeField")
  {
    keySelector = dataItem => dataItem.SomeField;
  }
  else
  {
    keySelector = dataItem => dataItem.Default;
  }
  ArrayList dataItems = RequestManager.Instance.GetAllRequests();
  this.GridView1.DataSource = dataItems.OfType<MyType>().OrderBy(keySelector);
  this.GridView1.DataBind();
} 
```

这将使您开始，然后检查排序表达式以查看它是否以 ASC 或 DESC 结尾并有条件地调用`.OrderByDescending(keySelector)`.

最后，我不建议将列表存储在 ViewState 中，因为`ObjectStateFormatter`它仅针对少数类型进行了优化。[http://msdn.microsoft.com/en-us/library/system.web.ui.objectstateformatter.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.objectstateformatter.aspx)

也许可以考虑使用 ASP.NET 缓存。

# sql - 获取具有 max(timestamp) 的行

> ID：13370407
> 
> 赞同：2
> 
> 时间：2012-11-13T23:03:11.183
> 
> 标签：sql, postgresql, distinct, greatest-n-per-group, window-functions

我需要选择最近评论的文章，​​以及每篇文章的最后评论，即包含以下内容的行的其他列`max(c.created)`：

```
SELECT a.id, a.title, a.text, max(c.created) AS cid, c.text?
FROM subscriptions s
JOIN articles a ON a.id=s.article_id
JOIN comments c ON c.article_id=a.id
WHERE s.user_id=%d
GROUP BY a.id, a.title, a.text
ORDER BY max(c.created) DESC LIMIT 10; 
```

Postgres 告诉我必须将 c.text 放入 GROUP BY。显然，我不想这样做。最小值/最大值也不合适。我不知道如何选择这个。

请指教。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T23:54:58.857

在 PostgreSQL 中，[**`DISTINCT ON`**](http://www.postgresql.org/docs/current/interactive/sql-select.html#SQL-DISTINCT)可能是这种查询的最佳解决方案：

```
SELECT DISTINCT ON (a.id)
       a.id, a.title, a.text, c.created, c.text
FROM   subscriptions s
JOIN   articles      a ON a.id = s.article_id
JOIN   comments      c ON c.article_id = a.id
WHERE  s.user_id = %d
ORDER  BY a.id, c.created DESC 
```

这将检索具有最新评论和相关附加列的文章。[这个密切相关的答案](https://stackoverflow.com/a/7630564/939860)
中的解释、链接和基准。

要获取最新的 10 个，请将其包装在子查询中：

```
SELECT *
FROM  (
    SELECT DISTINCT ON (a.id)
             a.id, a.title, a.text, c.created, c.text
    FROM   subscriptions s
    JOIN   articles      a ON a.id = s.article_id
    JOIN   comments      c ON c.article_id = a.id
    WHERE  s.user_id = 12
    ORDER  BY a.id, c.created DESC
    ) x
ORDER  BY created DESC
LIMIT  10; 
```

或者，您可以结合使用[**窗口函数**](http://www.postgresql.org/docs/current/interactive/functions-window.html)和标准**`DISTINCT`**：

```
SELECT DISTINCT
       a.id, a.title, a.text, c.created, c.text
      ,first_value(c.created) OVER w AS c_created
      ,first_value(c.text)    OVER w AS c_text
FROM   subscriptions s
JOIN   articles      a ON a.id = s.article_id
JOIN   comments      c ON c.article_id = a.id
WHERE  s.user_id = 12
WINDOW w AS (PARTITION BY c.article_id ORDER BY c.created DESC)
ORDER  BY c_created DESC
LIMIT  10; 
```

这是可行的，因为`DISTINCT`（与聚合函数不同）应用了`after`窗口函数。
您必须测试哪个更快。估计最后一个比较慢。

# ms-access - MS Access 从前端创建新的后端

> ID：13370410
> 
> 赞同：0
> 
> 时间：2012-11-13T23:03:17.393
> 
> 标签：ms-access

我有一个访问前端，旨在查看和修改后端数据库。它被设置为允许通过前端登录的用户通过打开的对话窗口选择现有的后端。

但是，我将如何允许用户从前端创建新的后端？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T23:14:01.733

使用 ADOX 目录

```
Dim cat
Set cat = CreateObject("ADOX.Catalog")

With cat
    .create "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=z:\docs\new.accdb"

    With .ActiveConnection
        sSQL = "CREATE TABLE T1 (ID Counter Primary Key, AText Text(20))"
        .Execute sSQL
    End With
End With 
```

基于现有数据库的新数据库。

```
Dim fs As Object 'FileSystemObject
Set fs = CreateObject("Scripting.FileSystemObject")
FileName = CurrentProject.Path & "\New.accdb"
If Not fs.FileExists(FileName) Then
    fs.copyfile CurrentProject.FullName, FileName, False
End If 
```

# android - 浏览器地理位置 - Android 2.3.4 忽略 GPS 卫星。怎么修？

> ID：13370414
> 
> 赞同：1
> 
> 时间：2012-11-13T23:03:33.417
> 
> 标签：android, geolocation

通过 Android 2.3.4 Gingerbread 中的默认浏览器进行地理定位是否存在公认的问题？

在 HTC G2 android 2.3.4 上，默认浏览器似乎不使用 GPS 卫星来确定位置。结果，浏览器发送到应用程序的位置偏离了一英里左右。是的，手机里的 GPS 和 wi-fi 都打开了。我们关闭了 wi-fi 并得到了相同的（坏的）结果。

是否有一些巫术可以让 2.3.4 中的默认浏览器进行正确的地理定位？

在 iPhone 3s 上​​，使用相同的浏览器应用程序可以完美运行。以下链接启动 Gmap4 应用程序（我是开发人员）并在 Google“混合”地图上显示您的位置： [http ://www.mappingsupport.com/p/gmap4.php?mylocation=on](http://www.mappingsupport.com/p/gmap4.php?mylocation=on)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:23:32.883

我相信这不是浏览器问题，而是手机特定问题。如果您的位置偏离一英里，请确保该位置是从 wifi 获取的。

当您启动地图时，它会尝试获取`LastKnownLocation`，如果它太旧，它会恢复到 wifi 位置。现在，如果您关闭 wifi，使用 wi-fi 获取的位置将保持为最近可用`LastKnownLocation`，并将用于再次定位地图。

在您从 GPS 获得更好的位置之前，将使用这个位置。

`LastKnownLocation`当您重新启动它们时，至少有些手机会丢弃它们。您可以在关闭 wifi 的情况下尝试一下，看看会发生什么。

问候。

# java - 如何为刽子手游戏添加标签

> ID：13370415
> 
> 赞同：1
> 
> 时间：2012-11-13T23:03:51.820
> 
> 标签：java, user-interface

这些是我的代码当我从文本文件中读取行时，我遇到了标签问题，我可以添加标签“_”，它们等于之前程序道路的单词的大小。我在创建标签时遇到问题，希望您能理解我的问题，如果可以的话，请给我一个解决方案吗？

```
 public class HangGame extends JFrame {

     JLabel lbl;
    JLabel word ;
    private  String[]myword = new String [20];
   Game() {

}
    void readfile () {
Properties prob = new Properties();

try{

    for(int x=0; x<n; x++){
    }
    }}
    private void initLabelPanel() {
    //craete array of labels the size of the word
        letterHolderPanel = new JPanel();
        int count =0; 
```

//如果你运行我的代码我对这个数组有问题 [myword.length()] 编译器找不到它。

```
wordToFindLabels = new JLabel[myword.length()];
    //Initiate each labels text         add tp array and to letter holder panel
    for (int i = 0; ih; i++) {JLabel lbl = new JLabel("_");

    letterHolderPanel.add(lbl);
    lbl.setBounds();
    }
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T23:09:57.177

`myword`是一个数组`Strings`，而不是一个数组，`String`因此您需要替换：

```
wordToFindLabels = new JLabel[myword.length()]; 
```

和

```
wordToFindLabels = new JLabel[myword.length]; 
```

您可以将变量重命名为，例如`mywordArray`，以避免混淆。

也使用布局管理器而不是使用绝对定位（空布局）。

请参阅：[不使用布局管理器（绝对定位）](http://docs.oracle.com/javase/tutorial/uiswing/layout/none.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T23:10:10.820

长度是属性而不是方法相应地更改代码

```
wordToFindLabels = new JLabel[myword.length];  
```

现在你的代码将是

```
 for (int i = 0; i < wordToFindLabels.length; i++) {
String labelValue="";
if(myword[i] != null) {
for (int j = 0; j < myword[i].length(); j++){
  labelValue+="_"
}
}
JLabel lbl = new JLabel(labelValue);
    wordToFindLabels[i] = lbl;

    letterHolderPanel.add(lbl);
    lbl.setBounds(30, 60, 20, 20);
    } 

```

# php - 如何使用 PHP 使用 GeoNames Web 服务

> ID：13370421
> 
> 赞同：0
> 
> 时间：2012-11-13T23:04:27.463
> 
> 标签：php, html, json, geolocation, geonames

我读过这篇[文章](https://stackoverflow.com/questions/4497728/get-country-from-latitude-longitude?lq=1)，看起来很有希望。但是，答案并没有详细说明实施。

**基本上，给定纬度和经度，我如何使用[GeoNames](http://www.geonames.org/) Web Service 来获取国家/地区。我希望将返回的结果存储在一个变量中，以便我可以继续使用它。**

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T23:14:12.623

你必须为此使用javascript吗？Geonames 似乎没有提供用于进行精确查询的 javascript api（请参见此处：[http](http://www.geonames.org/export/JSON-webservices.html) ://www.geonames.org/export/JSON-webservices.html ）。并且通过 javascript 获取远程文件并不令人愉快。

如果您可以为此使用php，那将像

```
$country = file_get_contents("http://ws.geonames.org/countryCode?lat=49.03&lng=10.2"); 
```

# ruby-on-rails - 设计 after_sign_in_path 重定向循环

> ID：13370425
> 
> 赞同：1
> 
> 时间：2012-11-13T23:04:50.200
> 
> 标签：ruby-on-rails, devise

我在登录后尝试重定向，除了一些路径。

```
def after_sign_in_path_for(user)
  if request.fullpath =~ /some_path/
    request.fullpath
  elsif # redirect accordingly
    # ...
  else ...
    ...
  end
end 
```

它正在做一个重定向循环。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T19:40:06.537

弄清楚了。它与 /users/password/edit 路径的奇怪和未记录的行为有关，该路径仅用于未经身份验证的密码重置。使用 /users/edit 解决了这个问题。

必须深入挖掘设计源代码才能理解这一点。

# ruby-on-rails - 为什么在从不同的控制器重新渲染部分时，Rails 中的 url_for 助手会失败？

> ID：13370427
> 
> 赞同：1
> 
> 时间：2012-11-13T23:05:02.423
> 
> 标签：ruby-on-rails, partial-views, renderpartial, url-for

我有一个包含一堆小部件的页面，这些小部件的内容主要由 CustomerController 呈现。但是，还有另一个称为 DigitalItemController 的控制器，用于处理有关客户项目更改的业务逻辑。我有一个表单，用于上传要由 DigitalItemController 中的方法通过 POST 处理的文件。该表单位于名为 :customer_assets 的部分中，因为它包含他们已上传的客户文件。同样的小部件有一个已上传文件的表格，其中包含指向它们的链接。

我遇到的问题是，由于 CustomerController 通常会进行渲染，因此它可以很好地渲染我的部分，没有任何抱怨。但是，当我让用户提交要上传的文件时，它会调用我的 DigitalItemController 中的一个方法，其中最后一行表示要渲染部分。当它到达那条线时，我得到一个 ActionController::RoutingError 因为它试图呈现部分。它不喜欢的行是：

```
%td= link_to(item_file.storage_info.s3_key,
          url_for(:controller => :data, 
            :action => :get_storage_information_link,
            :digital_item_id => item.digital_item_id, 
            :digital_storage_id => item_file.digital_storage_id)) 
```

我认为不会有问题，因为这里明确使用了 DataController。它应该知道我只想像以前一样重新渲染部分。但是，我得到了这个：

```
No route matches {:digital_storage_id=>#####, :action=>"get_storage_information_link", :digital_item_id=>#######, :controller=>"data"} 
```

显然，这里的身份证号码已被删除，以防万一。我需要做的就是让 DigitalItemController 中的该方法处理文件上传，然后重新渲染部分，以便小部件显示正确和最新的数据。对我来说，它在正常渲染时渲染得很好，但是一旦提交文件，它就会引发路由错误，这对我来说似乎很奇怪。

解决这个问题的方法是什么？

# python - io.UnsupportedOperation：不可读

> ID：13370428
> 
> 赞同：4
> 
> 时间：2012-11-13T23:05:08.027
> 
> 标签：python, python-3.x

我正在解决一个问题，该问题说要制作一个程序来获取文件的用户输入，然后在文件中删除用户指定的字符串。我不确定如何从我所拥有的（下面）到问题所要求的。一如既往，非常感谢任何和所有帮助。

```
def main():
    outfile = open(input("Enter a file name: "), "a")
    string = input("Enter the string to be removed: ")
    for string in outfile.readlines():
        string = string.replace(string, "")
    outfile.close()
    print("Done")

main() 
```

我接受了其中一个建议并试图让它工作，但正如我在下面的评论中所说，下面的代码不会返回错误，它会创建一个空文件。为了使新文件成为删除字符串的旧文件，我缺少什么？

```
def main():
    inpath = input("Enter an input file: ")
    line = input("Enter what you want to remove: ")
    outpath = input("Enter an output file: ")
    with open(inpath, "r") as infile, open(outpath, "w") as outfile:
        for line in infile:
            outfile.write(line.replace(line, "") + "\n")
    print("Done.")

main() 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-13T23:17:16.347

在进入细节之前有几点说明：当你调用 时`string.replace(string, "")`，你是在告诉字符串用空字符串替换它的整个自身——你也可以这样做`string = ""`。大概第一个`string`是要替换的搜索字符串，所以给它一个不同的名称，然后将其用作，例如，`string.replace(searchString, "")`。此外，您不想命名变量`string`，因为它是标准库模块的名称。您将输入文件称为“outfile”，这很容易造成混淆。您可能希望使用`with`语句而不是显式关闭。最后，您可以使用`for line in f:`; 来迭代文件中的行。你不需要`for line in f.readlines()`（而且，如果你需要处理 Python 2.x，你会更乐意避免`readlines()`，因为它会将整个文件读入内存，然后在内存中创建一个巨大的行列表）。

正如 JBernardo 所指出的，第一个问题是您以“a”模式打开文件，这意味着“只写，追加到末尾”。如果要读写，可以使用“a+”或“r+”。

但是，这并不能真正帮助你。毕竟，您不能在读取文件的过程中写入文件。

有一些常见的方法可以解决这个问题。

首先，只需写入标准输出，然后让用户对结果做任何他想做的事——例如，将其重定向到一个文件。（在这种情况下，您已将提示、“完成”消息等打印到标准错误中，因此它们不会被重定向到文件。）这是许多 Unix 工具喜欢`sed`或`sort`做的事情，因此如果您这样做是合适的'正在构建一个 Unix 风格的工具，但可能不适用于其他目的。

```
def stderrinput(prompt):
    sys.stderr.write(prompt)
    sys.stderr.flush()
    return input()

def main():
    with open(stderrinput("Enter a file name: "), "r") as infile:
        searchString = stderrinput("Enter the string to be removed: ")
        for line in infile:
            print(infile.replace(searchString, ""))
    sys.stderr.write("Done\n") 
```

其次，写入另一个文件。在“r”模式下打开输入文件，在“w”模式下打开输出文件，然后你只是复制行：

```
def main():
    inpath = input("Enter an input file: ")
    outpath = input("Enter an output file: ")
    with open(inpath, "r") as infile, open("outpath", "w") as outfile:
        for line in infile:
            outfile.write(line.replace(searchString, "") + "\n") 
```

三、读取并处理内存中的整个文件，然后截断并重写整个文件：

```
def main():
    path = input("Enter an input/output file: ")
    with open(path, "r+") as inoutfile:
        lines = [line.replace(searchString, "") for line in inoutfile]
        inoutfile.seek(0)
        inoutfile.truncate()
        inoutfile.writelines(lines) 
```

最后，写入一个临时文件（与第二个选项一样），然后将该临时文件移动到原始输入文件的顶部。像这样的东西：

```
def main():
    path = input("Enter an input/output file: ")
    with open(path, "r") as infile, tempfile.NamedTemporaryFile("w", delete=False) as outfile:
        for line in infile:
            outfile.write(line.replace(searchString, ""))
        shutil.move(outfile.name, pathname) 
```

由于 POSIX 和 Windows 之间的差异，最后一个有点棘手。但是，它有一些很大的优势。（例如，如果您的程序在运行过程中被杀死，无论它是如何发生的，都保证您拥有原始文件或新文件，而不是一些写一半的混乱。）

# java - 为什么我在 Java 中的 PriorityBlockingQueue 不能正确排序？

> ID：13370431
> 
> 赞同：1
> 
> 时间：2012-11-13T23:05:49.570
> 
> 标签：java, sorting, priority-queue

出于某种原因，当我添加到优先级队列时，它不会完全按字母顺序对我的字符串进行排序，我不明白为什么。

这是添加到 PriorityBlockingQueue 的代码：

```
String toAdd = String.format("%s/%s", directory, s);
outputData.add(toAdd); 
```

但我得到的输出没有完全排序（只有前几行，但你可以看到它没有排序）：

```
../StartingTree/files/abknl/apfmpohgyh/a.class
../StartingTree/files/abknl/apfmpohgyh/a.java
../StartingTree/files/abknl/aqybc/aeph.java
../StartingTree/files/abknl/apfmpohgyh/bnjuxxdi.class
../StartingTree/files/abknl/bbxudleuf/jlffhq/y/xwjj/dyetqhsch/bpg.class
../StartingTree/files/abknl/bbxudleuf/mxb/fe/ndmg/axapxuco.html
../StartingTree/files/abknl/aqybc/atyuojdu.txt 
```

这是预期输出文件中排序输出的真实（第一部分）：

```
../StartingTree/files/abknl/apfmpohgyh/a.class
../StartingTree/files/abknl/apfmpohgyh/a.java
../StartingTree/files/abknl/apfmpohgyh/bnjuxxdi.class
../StartingTree/files/abknl/apfmpohgyh/bnjuxxdi.java
../StartingTree/files/abknl/apfmpohgyh/bsqsq.class
../StartingTree/files/abknl/apfmpohgyh/bsqsq.java
../StartingTree/files/abknl/apfmpohgyh/ds.class
../StartingTree/files/abknl/apfmpohgyh/ds.java 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T23:08:18.847

我怀疑您正在尝试迭代`PriorityBlockingQueue`并打印元素。

请注意，优先队列数据结构（AKA [heap](http://en.wikipedia.org/wiki/Heap_%28data_structure%29)）不保证排序 - 它保证头部是最小的，但在以下任何节点上都没有顺序保证。

如果您希望您的数据保持排序 - 我建议使用类似的东西[`ConcurrentSkipListSet`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ConcurrentSkipListSet.html)（注意它是一个集合 - 因此它不允许重复的主菜），或维护一个排序的[`List`](http://docs.oracle.com/javase/6/docs/api/java/util/List.html).

如果您想使用 a 获取已排序的元素`PriorityBlockingQueue`- 您应该迭代地删除头部并输出新的头部 - 直到优先级队列耗尽。它将保证有序的输出。

# c# - 使用我的网站上的 HtmlAgilityPack 获取日期和时间以实现统一

> ID：13370433
> 
> 赞同：0
> 
> 时间：2012-11-13T23:05:53.490
> 
> 标签：c#, parsing, xpath, unity3d, html-agility-pack

我正在尝试使用此处的代码从我的网站[http://www.thisisnotaballgame.com/time获取日期和时间。](http://www.thisisnotaballgame.com/time)问题是我在它变成日期和时间之前得到了这条线，它是一个 iframe。有什么方法可以将我从网站上获取的 html 翻译成日期和时间，还是我以错误的方式处理这个问题？我也在使用unity3d。

```
public string url = "http://www.thisisnotaballgame.com/time";

IEnumerator Start ()
{
    url = "http://www.thisisnotaballgame.com/time";
    WWW www = new WWW ( url );
    yield return www;
    //renderer.material.mainTexture = www.texture;
    ExtractTimeFromBytes ( www.bytes );
}

void ExtractTimeFromBytes ( byte[] websiteBytes )
{
    MemoryStream stream = new MemoryStream ( websiteBytes );

    HtmlDocument doc = new HtmlDocument ();
    doc.Load ( stream );
    foreach ( HtmlNode link in doc.DocumentNode.SelectNodes("//iframe") )
    {
        string linkTxt = link.OuterHtml;
    }
    doc.Save ( "file.txt" );
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:53:38.597

你想得到什么`DateTime.UtcNow`没有提供的日期？

无论如何，iframe 的 URL 是[http://free.timeanddate.com/clock/i3dcvasg/n1440/tt0/tw0/tm2/th1/tb1](http://free.timeanddate.com/clock/i3dcvasg/n1440/tt0/tw0/tm2/th1/tb1)，这就是您应该从中获取源代码的 URL。

# c# - 在 msbuild 和 ClickOnce 中使用版本信息

> ID：13370434
> 
> 赞同：2
> 
> 时间：2012-11-13T23:05:54.997
> 
> 标签：c#, msbuild, clickonce

我有一个用于自动安装 ClickOnce 的 msbuild 脚本。尝试将版本信息添加到发布目录时，尝试使用该版本构建路径字符串时出现错误。

```
<Target Name="GetVersion">
   <Message Text="Getting version info..."/>
   <GetAssemblyIdentity AssemblyFiles="@(GetVersionAssembly)">
      <Output TaskParameter="Assemblies"
              ItemName="GetVersionAssemblyInfo"/>
   </GetAssemblyIdentity>
   <Message Text="%(GetVersionAssemblyInfo.Version)..."/>
</Target>

<Target Name="CopyFilesToVirtualRoot" DependsOnTargets="PrepareClickOnceDeployment;DeleteVirtualRootFiles;GetVersion">
   <Message Text="Copying files to $(ClickOnceVirtualRootDir)..."/>
   <Copy  SourceFiles="@(ClickOnceInstallationFiles)"
         DestinationFiles="@(ClickOnceInstallationFiles->'$(ClickOnceVirtualRootDir)\%(Filename)%(Extension)')"/>
   <Copy  SourceFiles="@(AppManifestContents)"
           DestinationFiles="@(AppManifestContents->'$(ClickOnceVirtualRootDir)\Application Files\Version_%(GetVersionAssemblyInfo.Version)\%(RecursiveDir)%(Filename)%(Extension).deploy')"/>
</Target> 
```

运行时出现以下错误

```
error MSB4043: The item metadata reference "%(GetVersionAssemblyInfo.Version)" is invalid
because it is qualified with an item name. Item metadata referenced in transforms do not 
need to be qualified, because the item name is automatically deduced from the items being
transformed. Change "%(GetVersionAssemblyInfo.Version)" to "%(Version)". 
```

如果我将其更改为 %(Version) 我得到的只是一个空白。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T23:37:45.230

尝试使用目标批处理，以便 MSBuild`CopyFilesToVirtualRoot`每个程序集版本运行一次目标。然后您可以将版本填充到一个属性中并在您的项目转换中引用它。

```
<Target Name="CopyFilesToVirtualRoot"
    DependsOnTargets="PrepareClickOnceDeployment;DeleteVirtualRootFiles;GetVersion"
    Outputs="%(GetVersionAssemblyInfo.Version)">
    <PropertyGroup>
        <AppVersion>%(GetVersionAssemblyInfo.Version)</AppVersion>
    </PropertyGroup>
    <Message Text="Copying files to $(ClickOnceVirtualRootDir)..."/>
    <Copy
        SourceFiles="@(ClickOnceInstallationFiles)"
        DestinationFiles="@(ClickOnceInstallationFiles->'$(ClickOnceVirtualRootDir)\%(Filename)%(Extension)')"/>
    <Copy
        SourceFiles="@(AppManifestContents)"
        DestinationFiles="@(AppManifestContents->'$(ClickOnceVirtualRootDir)\Application Files\Version_$(AppVersion)\%(RecursiveDir)%(Filename)%(Extension).deploy')"/>
</Target> 
```

我想这很奇怪，因为如果您的任何程序集有不同的版本，您将拥有清单内容的多个副本。

也就是说，您可以只使用项目元数据创建一个属性。

```
<Target Name="CopyFilesToVirtualRoot"
    DependsOnTargets="PrepareClickOnceDeployment;DeleteVirtualRootFiles;GetVersion"
    Outputs="%(GetVersionAssemblyInfo.Version)">
    <CreateProperty
        Value="%(GetVersionAssemblyInfo.Version)">
        <Output PropertyName="AppVersion" TaskParameter="Value" />
    </CreateProperty>
    <Message Text="Copying files to $(ClickOnceVirtualRootDir)..."/>
    <Copy
        SourceFiles="@(ClickOnceInstallationFiles)"
        DestinationFiles="@(ClickOnceInstallationFiles->'$(ClickOnceVirtualRootDir)\%(Filename)%(Extension)')"/>
    <Copy
        SourceFiles="@(AppManifestContents)"
        DestinationFiles="@(AppManifestContents->'$(ClickOnceVirtualRootDir)\Application Files\Version_$(AppVersion)\%(RecursiveDir)%(Filename)%(Extension).deploy')"/>
</Target> 
```

我认为两者都可以为您提供所需的东西。

# java - Java 文件 I/O：如果找不到“硬编码”文件，我如何提示用户输入该文件？

> ID：13370437
> 
> 赞同：1
> 
> 时间：2012-11-13T23:05:58.400
> 
> 标签：java, io, try-catch, bufferedreader

所以我的问题是标题如何。下面是我的代码片段。我知道我应该使用 try/catch，但在我的 catch 中，我不知道该怎么做。我收到一个错误 / *HERE* / 说 BufferedReader 不能接收 InputStream。我想继续使用 BufferedReader，那么是否有任何其他类可以在我的新 BufferedReader 中实例化，以便我的编译器满意？任何帮助将不胜感激，谢谢！

```
 //reads in 'dictionary' file
    BufferedReader bReader;
    try
    {
        bReader = new BufferedReader
                (new FileReader("unsortedWords.txt"));
    }
    catch (FileNotFoundException e)
    {
        System.out.print("Enter name of dictionary file: ");
        bReader = new BufferedReader
                (new FileReader(System.in)); /*HERE*/
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T23:09:01.153

也许是这样：

```
File file = new File("unsortedWords.txt");
if(file.exists())
{
 // do something
}
else
{
 // prompt for file
 // if command line you can use Scanner or an InputStreamReader
 // if GUI you can use a File Chooser.
} 
```

如果您不确定如何执行命令行或 GUI 操作，请询问我，我将发布其余代码。

[编辑]：我看到你正在做命令行，所以你可以试试这个：

```
InputStreamReader isr = new InputStreamReader(System.in);
BufferedReader br = new BufferedReader(isr);
String line = br.readLine(); 
```

[编辑]：示例类（是的，它的设计很糟糕，但我写得很快）：

```
import java.io.*;

public class Temp
{

    public static void main(String[] args) throws IOException
    {
        InputStreamReader isr = new InputStreamReader(System.in);
        BufferedReader br = new BufferedReader(isr);
        System.out.println("Hello World!");
        String temp = br.readLine();
        System.out.println("Your line : \"" + temp + "\"");
    }
} 
```

[编辑]：这是我制作的课程，应该适合您。

```
import java.io.*;

public class Temp
{

    public static void main(String[] args) throws IOException
    {
        String fileName = "RandomFileThatDoesntExist";
        File file = new File(fileName);

        if(file.exists())
        {
            FileReader fr = new FileReader(fileName);
            BufferedReader br = new BufferedReader(fr);
            String line;
            while((line = br.readLine()) != null)
            {
                System.out.println(line);
            }
        }
        else
        {
            InputStreamReader isr = new InputStreamReader(System.in);
            BufferedReader br = new BufferedReader(isr);
            System.out.println("Enter file Name:");
            String line;
            while(true)
            {
                line = br.readLine();
                File myFile = new File(line);
                if(myFile.exists())
                    break;
                else
                    System.out.println("Error, file doesn't exist!");
            }
            FileReader fr = new FileReader(line);
            BufferedReader br2 = new BufferedReader(fr);
            System.out.println("File contents:");
            while((line = br2.readLine()) != null)
            {
                System.out.println(line);
            }
        }
    }
} 
```

截屏：

![命令行截图](../Images/34da1778c036ab575bb5933865f980ff.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T23:16:49.350

我认为您没有发布使用中的代码，您的错误应该与`FileReader`从`ImputStream`.

使用[`InputStreamReader`](http://docs.oracle.com/javase/7/docs/api/index.html?java/io/InputStreamReader.html)：

```
BufferedReader in
   = new BufferedReader(new InputStreamReader(System.in)); 
```

完全按照文档中给出的:)

# ios - ObjectMapping 中的 KeyPath 和 forResourcePathPattern

> ID：13370438
> 
> 赞同：0
> 
> 时间：2012-11-13T23:06:00.227
> 
> 标签：ios, rest, restkit, tastypie

大家下午好，

目前，我的 REST API 以 {"meta":{}, "objects":{}} 的形式返回 JSON。（这是使用 TastyPie 完成的）。我想回到 iOS，只抓取对象。在我使用这条线之前：

```
[omp setMapping:userMapping forKeyPath:@"objects"]; 
```

它工作得很好。然而，现在我添加了更多的映射，最终我做了这样的事情：

```
RKObjectMappingProvider *omp = [[RKObjectManager sharedManager] mappingProvider];

RKObjectMapping *cellMapping = [Cell mapping];
[omp addObjectMapping:cellMapping];
[omp setObjectMapping:cellMapping forResourcePathPattern:@"/cells/?format=json"];
[cellMapping setRootKeyPath:@"objects"];

RKObjectMapping *userMapping = [User mapping];
[omp addObjectMapping:userMapping];
[omp setObjectMapping:userMapping forResourcePathPattern:@"/users/?format=json"];
[omp setMapping:userMapping forKeyPath:@"objects"]; 
```

我一直在使用这个[http://kalapun.com/blog/2012/05/17/how-i-restkit/](http://kalapun.com/blog/2012/05/17/how-i-restkit/)。但正如您可以猜到的，如果我加载一个单元并尝试获取它的属性，这将不起作用，因为“用户”采用了“对象”映射。我可以将这两个字段 forResourcePathPattern 和 forKeyPath 结合起来吗？！

另外，在 AddObjectMapping 之后做 SetObjectMapping 的目的是什么？我两个都需要吗？！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T19:57:38.890

在 RestKit 0.2 中修复！我们将能够直接插入一个 KeyPath，这太棒了！

# php - 为什么我的表单会在我发送的数据中添加选项卡？

> ID：13370439
> 
> 赞同：0
> 
> 时间：2012-11-13T23:06:08.320
> 
> 标签：php, javascript, html

这是我的代码：

```
<?php
    $view="Mickey Mouse";
?>
<script type="text/javascript">
    function doOne(){
        document.getElementById("xyz").submit();
        }
    function doTwo(){
        document.getElementById("xyz").submit();
        }
</script>
<form class="xyz" id="xyz" method='POST' accept-charset="UTF-8" action='index.php'>
    <textarea rows="4" cols="60" name='article' id='article' WRAP=SOFT>
        <?php echo $view;?>
    </textarea>
<p>
    <button type="button" name='do1' id='do1' value="do 1" onclick="doOne()">do 1</button>
    <button type="button" name='do2' id='do2' value="do 2" onclick="doTwo()">do 2</button>
</p>
</form>

<?php
    var_dump("POST :",$_POST);
?> 
```

当我运行它时，表单显示`[tab][tab]Mickey Mouse[tab]`而不是简单的`Mickey Mouse`. 这是为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T23:07:46.883

关闭 < ? php回显$视图；?>

```
<textarea rows="4" cols="60" name='article' id='article' WRAP=SOFT><?php echo $view;?></textarea> 
```

textarea 无法知道这些换行符和空格是否应该是 textarea 内容的一部分，所以它当然包括它们。

# c# - 以最快的方式逐个字符写入控制台字符

> ID：13370440
> 
> 赞同：7
> 
> 时间：2012-11-13T23:06:13.827
> 
> 标签：c#, console

在我当前的项目中，我必须解析一个字符串，并将其中的一部分写入控制台。在测试如何在没有太多开销的情况下执行此操作时，我发现我测试的一种方法实际上比 Console.WriteLine 更快，这让我有点困惑。

我知道这不是对东西进行基准测试*的*正确方法，但我通常可以粗略地接受“这比这更快”，我可以在运行几次后告诉我。

```
static void Main(string[] args)
{
    var timer = new Stopwatch();

    timer.Restart();
    Test1("just a little test string.");
    timer.Stop();
    Console.WriteLine(timer.Elapsed);

    timer.Restart();
    Test2("just a little test string.");
    timer.Stop();
    Console.WriteLine(timer.Elapsed);

    timer.Restart();
    Test3("just a little test string.");
    timer.Stop();
    Console.WriteLine(timer.Elapsed);
}

static void Test1(string str)
{
    Console.WriteLine(str);
}

static void Test2(string str)
{
    foreach (var c in str)
        Console.Write(c);
    Console.Write('\n');
}

static void Test3(string str)
{
    using (var stream = new StreamWriter(Console.OpenStandardOutput()))
    {
        foreach (var c in str)
            stream.Write(c);
        stream.Write('\n');
    }
} 
```

如您所见，Test1 正在使用 Console.WriteLine。我的第一个想法是简单地为每个字符调用 Write，参见 Test2。但这导致花费了大约两倍的时间。我的猜测是它在每次写入后都会刷新，这会使其变慢。所以我尝试了 Test3，使用 StreamWriter（AutoFlush 关闭），它比 Test1*快*了大约 25% ，我真的很好奇为什么会这样。还是无法正确地对控制台进行写入？（在添加更多测试用例时注意到一些奇怪的数据......）

有人可以启发我吗？

此外，如果有更好的方法来做到这一点（通过一个字符串并只将它的一部分写入控制台），请随时对此发表评论。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-14T00:22:08.080

首先，我同意其他评论，即您的测试工具还有一些不足之处......我重写了它并将其包含在下面。重写后的结果是明显的赢家：

```
//Test 1 = 00:00:03.7066514
//Test 2 = 00:00:24.6765818
//Test 3 = 00:00:00.8609692 
```

从这里你是正确的，缓冲流写入器的速度要快 25%。它更快只是因为它被缓冲了。在内部，StreamWriter 实现使用大约 1~4kb 的默认缓冲区大小（取决于流类型）。如果您使用 8 字节缓冲区（允许的最小缓冲区）构建 StreamWriter，您将看到大部分性能改进都消失了。您还可以通过在每次写入后使用 Flush() 调用来查看这一点。

这是为获得上述数字而重写的测试：

```
 private static StreamWriter stdout = new StreamWriter(Console.OpenStandardOutput());
    static void Main(string[] args)
    {
        Action<string>[] tests = new Action<string>[] { Test1, Test2, Test3 };
        TimeSpan[] timming = new TimeSpan[tests.Length];

        // Repeat the entire sequence of tests many times to accumulate the result
        for (int i = 0; i < 100; i++)
        {
            for( int itest =0; itest < tests.Length; itest++)
            {
                string text = String.Format("just a little test string, test = {0}, iteration = {1}", itest, i);
                Action<string> thisTest = tests[itest];

                //Clear the console so that each test begins from the same state
                Console.Clear();
                var timer = Stopwatch.StartNew();
                //Repeat the test many times, if this was not using the console 
                //I would use a much higher number, say 10,000
                for (int j = 0; j < 100; j++)
                    thisTest(text);
                timer.Stop();
                //Accumulate the result, but ignore the first run
                if (i != 0)
                    timming[itest] += timer.Elapsed;

                //Depending on what you are benchmarking you may need to force GC here
            }
        }

        //Now print the results we have collected
        Console.Clear();
        for (int itest = 0; itest < tests.Length; itest++)
            Console.WriteLine("Test {0} = {1}", itest + 1, timming[itest]);
        Console.ReadLine();
    }

    static void Test1(string str)
    {
        Console.WriteLine(str);
    }

    static void Test2(string str)
    {
        foreach (var c in str)
            Console.Write(c);
        Console.Write('\n');
    }

    static void Test3(string str)
    {
        foreach (var c in str)
            stdout.Write(c);
        stdout.Write('\n');
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T23:19:35.237

我已经对你的测试进行了 10000 次测试，结果在我的机器上如下：

```
test1 - 0.6164241  
test2 - 8.8143273    
test3 - 0.9537039 
```

这是我使用的脚本：

```
 static void Main(string[] args)
        {
            Test1("just a little test string.");     // warm up
            GC.Collect();  // compact Heap
            GC.WaitForPendingFinalizers(); // and wait for the finalizer queue to empty
            Stopwatch timer = new Stopwatch();
            timer.Start();
            for (int i = 0; i < 10000; i++)
            {
                Test1("just a little test string.");
            }
            timer.Stop();
            Console.WriteLine(timer.Elapsed);
        } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-13T23:39:13.650

我也运行了这个 10000 次并得到了这些结果：

```
00:00:00.6947374
00:00:09.6185047
00:00:00.8006468 
```

这似乎与其他人观察到的一致。我很好奇为什么`Test3`比 慢`Test1`，所以写了第四个测试：

```
timer.Start();
using (var stream = new StreamWriter(Console.OpenStandardOutput()))
{
    for (int i = 0; i < testSize; i++)
    {
        Test4("just a little test string.", stream);
    }
}
timer.Stop(); 
```

这个为每个测试重用流，从而避免每次重新创建它的开销。结果：

```
00:00:00.4090399 
```

虽然这是最快的，但它会将所有输出写入块的末尾`using`，这可能不是您所追求的。我想这种方法也会消耗更多的内存。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-13T23:27:25.263

我更改了代码以运行每个测试 1000 次。

```
 static void Main(string[] args) {
        var timer = new Stopwatch();

        timer.Restart();
        for (int i = 0; i < 1000; i++)
            Test1("just a little test string.");
        timer.Stop();
        TimeSpan elapsed1 = timer.Elapsed;

        timer.Restart();
        for (int i = 0; i < 1000; i++)
            Test2("just a little test string.");
        timer.Stop();
        TimeSpan elapsed2 = timer.Elapsed;

        timer.Restart();
        for (int i = 0; i < 1000; i++)
            Test3("just a little test string.");
        timer.Stop();
        TimeSpan elapsed3 = timer.Elapsed;

        Console.WriteLine(elapsed1);
        Console.WriteLine(elapsed2);
        Console.WriteLine(elapsed3);

        Console.Read();
    } 
```

我的输出：

```
00:00:05.2172738
00:00:09.3893525
00:00:05.9624869 
```

# java - 交叉编译java应用程序

> ID：13370441
> 
> 赞同：1
> 
> 时间：2012-11-13T23:06:16.903
> 
> 标签：java, openwrt, cross-compiling

我正在开发一个带有 openwrt 根文件系统和 linux 内核的嵌入式系统。

我已经编译了主干，没有问题。`/usr/bin`我已经在,`/usr/lib`和中安装了 Java 资源`/usr/share`，但是我无法编译一些我在 Eclipse 中完成的简单程序。我曾经`javac`编译过一个 hello world 并获得了 .class 文件，但是当我尝试在我的嵌入式系统中执行 helloworld.class 文件时：

```
java helloworld.class 
```

它什么也不做，它只是说：

```
/usr/bin/java: line 1: syntax error: unexpected word (expecting ")") 
```

当我在我的计算机上执行它时，它会运行，所以我想这是因为我必须交叉编译 java 文件，所以我该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T23:10:04.350

问题不在于您的课程，而在于 /usr/bin/java 脚本中的语法错误 - 尝试 cat /usr/bin/java

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T23:18:31.517

只需尝试没有 .class 扩展名的 java 命令，例如

```
java helloworld 
```

# jpa - 将 JTA 事务与 EJB 和 JPA 一起使用

> ID：13370443
> 
> 赞同：3
> 
> 时间：2012-11-13T23:06:32.177
> 
> 标签：jpa, transactions, ejb, rollback, jta

大家好，我正在寻找下一个问题的帮助：我有一个运行良好的 jpa/无状态 ejb 项目，它只是执行简单的查询和持久化操作，但现在我需要执行一组持久化操作，如果有的话他们失败了，我必须执行回滚，所以我发现 JTA 可以完成这项工作，但使用这段源代码：

```
@Stateless
public class ProjectBean implements IProject {

@Resource
javax.transaction.UserTransaction utx;
@PersistenceContext(unitName = "JPADB")
private EntityManager entityManager;
  ...
 //more code

//this is part of a method
try{
utx.begin();
entityManager.joinTransaction();
    for(Project p:projectResultList){
                entityManager.persist(p);
            }
            utx.commit();
        }catch(Exception e){
            e.printStackTrace();
            if(utx != null)
                try {
                    utx.rollback();
                } catch (IllegalStateException e1) {
                    // TODO Auto-generated catch block
                    e1.printStackTrace();
                } catch (SecurityException e1) {
                    // TODO Auto-generated catch block
                    e1.printStackTrace();
                } catch (SystemException e1) {
                    // TODO Auto-generated catch block
                    e1.printStackTrace();
                }
                //tx.rollback();
        } 
```

根本不起作用，这就是 persistence.xml 的样子：

```
<persistence-unit name="JPADB">
<jta-data-source>java:jboss/datasources/OracleBic</jta-data-source>
    <properties>
        <property name="hibernate.show_sql" value ="true" />
        <property name="hibernate.dialect"  value="org.hibernate.dialect.Oracle10gDialect" />
    </properties>
</persistence-unit> 
```

真的希望任何人都可以给我一个提示或建议，我是一个 jpa/jta 概念的新手，我尝试了很多我在网上找到的代码，但我总是得到不同的错误（线程上的错误 tx：预期的 TransactionImple usertransaction 开始，不能在使用 JTA 时使用 EntityTransaction）。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T18:20:39.613

您是否指示您的 AS 将在方法级别使用 @TransactionManagement(TransactionManagementType.BEAN) 手动处理事务？我没有看到班级级别的注释。可能您在方法级别上有它，但是您的代码被剪断不足以做出任何猜测。否则所有事务都由容器管理，您的代码将无法正常工作。因此，您必须根据要求将 @TransactionManagement(TransactionManagementType.BEAN) 放在方法或类级别上，或者您可能希望允许容器为您管理事务，而不是您必须进行 @remigio 建议的更改。在您的情况下，第二种方法似乎更好

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T15:05:17.157

remigio 的评论是正确的，@Stateless 会话 bean 使用 javax.ejb.@TransactionAttribute 控制事务边界，如果没有注释，所有公共方法都是 TransactionAttribute.REQUIRED。有关详细信息，请参阅[http://download.oracle.com/otndocs/jcp/ejb-3_0-fr-eval-oth-JSpec/](http://download.oracle.com/otndocs/jcp/ejb-3_0-fr-eval-oth-JSpec/) (ejb-3_0-fr-spec-ejbcore.pdf)。

UserTransaction 从未在@Stateless 会话 bean 中使用，而是由调用 bean 的客户端使用，以划分比方法调用本身更宽的事务窗口。

# node.js - 如何使用 Node.js 保存图像

> ID：13370445
> 
> 赞同：-1
> 
> 时间：2012-11-13T23:06:40.110
> 
> 标签：node.js

我的博客越深入，我遇到的问题就越多：) 谁能告诉我保存图像的最佳方法是什么。我将数据存储在 mongodb 中，我应该在其中保存图像还是应该使用本地文件系统？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:13:18.803

使用文件系统存储图像，释放数据库资源来服务数据。对于更大的站点图像，应该真正使用 CDN。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T23:13:59.880

[使用GridFS](http://www.mongodb.org/display/DOCS/GridFS)将它们存储在 MongoDB 中。这样您就不受文件大小的限制，图像可以在多个应用服务器之间轻松共享，并且图像自然会与您的 MongoDB 数据的其余部分一起备份。

# php - 如何在 CodeIgniter 项目中存储 Report 的描述？

> ID：13370447
> 
> 赞同：0
> 
> 时间：2012-11-13T23:06:47.260
> 
> 标签：php, codeigniter, codeigniter-2, data-storage

我正在编写由具有不同类型报告的布局页面组成的 Web 项目。我正在使用**工具提示 ui**，因此客户可以在悬停时阅读每个报告的描述，其中包含 6-8 个句子。所有报告的名称都存储在一个表中`reports`，作为`'report name'`带有 column 的列`'description'`。每个报告都是我结构中的一个功能。将报告的描述与报告的数据分开是否正确？有什么我应该注意的好的做法吗？这是我的代码：

在控制器中：

```
function my_report_name() 
    {
        $data['report_name']=$this->Reports_model->getMyReportNameSummary();
        $data['description_report_name']=$this->Reports_model->getReportDescription('my_report_name');

        //view in 'view/report' folder to use
        //name of view always the same as name of function
        $data['main'] = "report/my_report_name";

        $this->load->vars($data);
        //load template
        $this->load->view('template/t_main_full', $data);
    } 
```

在布局页面中：

```
 <tr>
 <a title="$description_report_name" href="<?= site_url('/reports/my_report_name') ?>">My Report Name</a> 
</tr> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T16:57:11.987

**Reports_model**方法**getReportDescription()**接受什么作为参数？您发送的“my_report_name”对我来说看起来不正确。

```
$data['description_report_name']=$this->Reports_model->getReportDescription(my_report_name); 
```

无论如何，检查什么

```
Reports_model->getReportDescription() 
```

回报将是一个很好的第一步。

# android - 销毁后重新启动活动时未调用onCreate

> ID：13370449
> 
> 赞同：1
> 
> 时间：2012-11-13T23:06:51.613
> 
> 标签：android

当我退出我的应用程序（通过按返回或主页按钮）时，将调用`Activity`s`onDestroy()`方法（我在其中使用位图进行大量清理）。

当我重新打开应用程序时，`onCreate()`没有被调用...它直接进入`onStart()`，尽管`Activity`已经完成。这会导致“尝试使用回收的位图”错误。

有没有办法确保在销毁`onCreate()`后总是调用它？`Activity`

编辑：我错了。onCreate() 正在被调用。但是，我仍然收到“尝试使用回收的位图”错误。如果 onCreate() 正在执行所有步骤，是否不会重新加载任何回收的位图？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T23:14:14.297

您的应用程序必须采取措施强制确保调用 onDestroy，因为如果您查看 Activity 生命周期，则无法从不包含 onCreate 的 onDestroy 返回到 onStart。实际上，Activity 通过反向回调来展开其初始化，使其进入恢复状态。看看[这里](http://developer.android.com/reference/android/app/Activity.html)的官方文档也许你在某个地方调用了 finish() 方法来强制 Activity？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T00:29:46.023

问题在于我如何设置 ImageView 图像。我从 /res 加载图像的原始方法是：

```
 image.setImageDrawable(getResources().getDrawable(R.drawable.myImage)); //WRONG!!!! 
```

显然，如果您回收了位图，上述代码将不会为位图重新分配内存，并且您的程序在尝试绘制该 ImageView 时会崩溃。

加载已回收的位图的正确方法（或至少解决我的问题的方法）是：

```
 image.setImageDrawable(new BitmapDrawable(BitmapFactory.decodeResource(getResources(), R.drawable.myImage))); //correct! 
```

它仍然没有回答我的问题，为什么在退出应用程序并调用 onDestroy 后，当我重新进入应用程序时，它正在寻找一个回收的位图。理论上，应用程序应该从头开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T23:14:53.803

当你按下home键时，activity不会被销毁，它只是被发送到后台，并`onPause()`调用该方法，当你再次启动它时，该方法`onResume()`将被执行，`onDestroy()`当你按下返回键时该方法被执行或当您调用该方法`finish()`强制销毁活动，然后当您尝试重新启动活动时，`onCreate()`将执行。

参考[这个](http://developer.android.com/training/basics/activity-lifecycle/index.html)

# apache-flex - 对齐 Flex 轴，以便区分正值和负值

> ID：13370450
> 
> 赞同：0
> 
> 时间：2012-11-13T23:06:58.990
> 
> 标签：apache-flex, charts, mxml, axes

我正在尝试设置一个包含正值和负值的简单折线图，但我无法设置正确的属性，以便 x 轴呈现在 y 轴的中间；我现在得到的只是 x 轴位于图表的底部。

```
<mx:Stroke id="stroke" color="0x000000" weight="1"/>

<mx:horizonalAxisRenderers>
    <mx:AxisRenderer axis="{xAxis}" axisStroke="{stroke}"/>
</mx:horizonalAxisRenderers>
<mx:verticalAxisRenderers>
    <mx:AxisRenderer axis="{yAxis}" axisStroke="{stroke}"/>
</mx:verticalAxisRenderers>

<mx:horizontalAxis>
    <mx:LinearAxis id="xAxis"/>
</mx:horizontalAxis>
<mx:verticalAxis>
    <mx:LinearAxis id="yAxis"/>
</mx:verticalAxis> 
```

我应该向轴添加什么属性/样式，以便将 x 轴显示在 y 轴的中间？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T00:13:02.820

`minimum`我相信你需要`maximum`使用`LinearAxis`. 通过给它这些提示，它应该将轴呈现在一个合理的位置。我很久以前就这样做了，所以有点模糊，但我发布了一个关于[在图表上呈现负值](http://blog.sunild.com/2008/08/inverting-chart-series.html)的简单示例（包括源）。

# javascript - 没有调用函数的类的函数工作

> ID：13370452
> 
> 赞同：2
> 
> 时间：2012-11-13T23:07:08.837
> 
> 标签：javascript, jquery, class, function

我有两个类和一个与其中一个一起使用的函数

```
$('.div-image').click(function(){                    // image zoom 
    $('#image').attr("src",img_src);

    $('.div-image').attr('class','div-image-big');

}); 
```

和html类似：

`<div class="div-image">`
`<div id="wrapper">`
`<img id="image" src="image.jpg">`
`</div>`
`</div>`

为什么在第一次单击图像或（div .div-image）后，我的类 div-image 更改为 div-image-big。但是如果我们再次单击函数 $('.div-image').click(function(){...} 将再次执行。问题是为什么会这样？我不需要这种行为。我想要这个仅当类为 div-image 而不是 div-image-big 时，该功能才起作用。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T23:15:35.600

事件处理程序绑定在元素上，而不是类上。它绑定到哪些元素是根据它们在绑定事件时所具有的类来决定的，因此稍后更改类不会更改哪些元素具有事件处理程序。

如果您希望事件处理程序对类做出反应，您应该将委托绑定到父元素。这样，事件就会冒泡到父元素，并且委托处理程序将在那一刻检查该类。例子：

HTML：

```
<div class="image-container">
  <div class="div-image">
    <div id="wrapper">
      <img id="image" src="image.jpg">
    </div>
  </div>
</div> 
```

Javascript：

```
$('.image-container').on('click', '.div-image' ,function(){                    // image zoom 
  $('#image').attr("src",img_src);
  $('.div-image').attr('class','div-image-big');
}); 
```

# struts2 - 包含 Jar 后无法加载配置

> ID：13370453
> 
> 赞同：1
> 
> 时间：2012-11-13T23:07:09.473
> 
> 标签：struts2, jar, struts

我正在尝试在我的 struts2 项目中包含一个 jar，以便在我的主项目中可以使用它的操作。添加行后

`struts.convention.action.includeJars=.*?survey.*?`

到我的 struts.properties 并尝试使用 Maven 重新部署到 Tomcat，我收到错误：

```
WARN  InterceptorBuilder 14 Nov 2012 09:58:09: Unable to load config class com.googlecode.scopeplugin.ScopeInterceptor at interceptor - jar:file:/other/dev/survey/webapp/target/survey-4.4-RC11-SNAPSHOT/WEB-INF/lib/survey-controller-4.4-RC11-SNAPSHOT.jar!/struts.xml:12:91 probably due to a missing jar, which might be fine if you never plan to use the bean-scope interceptor
ERROR InterceptorBuilder 14 Nov 2012 09:58:09: Actual exception
Caught Exception while registering Interceptor class com.googlecode.scopeplugin.ScopeInterceptor - interceptor - jar:file:/other/dev/survey/webapp/target/survey-4.4-RC11-SNAPSHOT/WEB-INF/lib/survey-controller-4.4-RC11-SNAPSHOT.jar!/struts.xml:12:91
    at com.opensymphony.xwork2.ObjectFactory.buildInterceptor(ObjectFactory.java:214)
    at com.opensymphony.xwork2.config.providers.InterceptorBuilder.constructInterceptorReference(InterceptorBuilder.java:70)
    at org.apache.struts2.convention.DefaultInterceptorMapBuilder.buildInterceptorList(DefaultInterceptorMapBuilder.java:99) 
```

再往下走一点：

```
ERROR Dispatcher 13 Nov 2012 17:37:13: Dispatcher initialization failed
Unable to load configuration. - [unknown location]
    at com.opensymphony.xwork2.config.ConfigurationManager.getConfiguration(ConfigurationManager.java:69)
    at org.apache.struts2.dispatcher.Dispatcher.init_PreloadConfiguration(Dispatcher.java:390)
    at org.apache.struts2.dispatcher.Dispatcher.init(Dispatcher.java:436)
    at org.apache.struts2.dispatcher.ng.InitOperations.initDispatcher(InitOperations.java:74) 
```

我在其他帖子中看到这是因为它找不到 struts.xml，因为有两个 struts.xml 文件 - 一个在我的主项目中，另一个在我包含的 jar 中。如果这是问题，有什么方法可以排除依赖 struts.xml 吗？或者这完全与其他事情有关？

删除 includeJars 行允许我部署我的应用程序，但我无法访问正在包含的 jar 中的操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T16:54:26.933

确保你的 struts.xml 中有 bean-scope 拦截器，并且作为 pom.xml 中的依赖项。

# usb - 如何将消息从 USBSniffer 映射到 PyUSB？

> ID：13370455
> 
> 赞同：1
> 
> 时间：2012-11-13T23:07:36.163
> 
> 标签：usb, pyusb

我试图弄清楚如何为 Microsoft LifeCam 打开“TrueColor”。我有几个来自 USBSniffer 的大 USB 日志，以及当我单击 Microsoft 软件中的复选框时始终显示的一些序列。这是启用序列开头的请求和设备响应（如果我误解了此数据，请纠正我）：

```
[156918643 ms] UsbSnoop - FilterDispatchAny(ac56afd2) : IRP_MJ_INTERNAL_DEVICE_CONTROL
[156918643 ms] UsbSnoop - FdoHookDispatchInternalIoctl(ac56b1ea) : fdo=88b25448, Irp=889911d8, IRQL=0
[156918643 ms]  >>>  URB 1482 going down  >>> 
-- URB_FUNCTION_CLASS_INTERFACE:
  TransferFlags          = 00000001 (USBD_TRANSFER_DIRECTION_IN, ~USBD_SHORT_TRANSFER_OK)
  TransferBufferLength = 00000002
  TransferBuffer       = abb04b86
  TransferBufferMDL    = 00000000
  UrbLink                 = 00000000
  RequestTypeReservedBits = 00000000
  Request                 = 00000085
  Value                   = 00001600
  Index                   = 00000500
[156918644 ms] UsbSnoop - MyInternalIOCTLCompletion(ac56b126) : fido=00000000, Irp=889911d8, Context=894d6c98, IRQL=2
[156918644 ms]  <<<  URB 1482 coming back  <<< 
-- URB_FUNCTION_CONTROL_TRANSFER:
  PipeHandle           = 885639a0
  TransferFlags        = 0000000b (USBD_TRANSFER_DIRECTION_IN, USBD_SHORT_TRANSFER_OK)
  TransferBufferLength = 00000002
  TransferBuffer       = abb04b86
  TransferBufferMDL    = 8837fee0
    00000000: 40 00
  UrbLink              = 00000000
  SetupPacket          =
    00000000: a1 85 00 16 00 05 02 00 
```

现在，我想通过 PyUSB 发送我看到的请求序列，但是当我发送第一个请求时，我得到：

```
>>> ret = dev.ctrl_transfer(0x80, 0x85, 0x1600, 0x0500, 8)
Traceback (most recent call last):
  File "<stdin>", line 1, in ?
  File "c:\Python24\Lib\site-packages\usb\core.py", line 702, in ctrl_transfer
    self.__get_timeout(timeout)
  File "c:\Python24\Lib\site-packages\usb\backend\libusb0.py", line 539, in ctrl_transfer
    timeout
  File "c:\Python24\Lib\site-packages\usb\backend\libusb0.py", line 387, in _check
    raise USBError(errmsg, ret)
usb.core.USBError: (None, 'usb_control_msg: invalid request 0x85') 
```

对于它的价值，一个简单的 GET_STATUS 似乎工作：

```
>>> ret = dev.ctrl_transfer(0x80, 0, 0, 0, 8)
>>> print ret
array('B', [0, 0]) 
```

为什么在一种情况下得到答复的请求在另一种情况下无效？句法？设备状态？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T05:40:35.023

从非常有用的[USB Made Simple](http://www.usbmadesimple.co.uk/ums_4.htm)中，请求类型的最高 3 位格式如下：

```
D7 Data direction
0 - Host-to-device
1 - Device-to-host
D6:5 Type
0 = Standard
1 = Class
2 = Vendor
3 = Reserved 
```

日志说我正在使用 USB 的类接口（参见“URB_FUNCTION_CLASS_INTERFACE”），因此 RequestType 特定于设备类（音频、物理......在这种情况下是视频）。GET_STATUS 命令有效，因为它是标准类型。

所以更正确的命令是

```
ret = dev.ctrl_transfer(0xa0, 0x85, 0x1600, 0x0500, 8) 
```

我说的*更*正确，因为命令返回数据，但它仍然不是我期望的数据！

编辑：为了完全逼真，我需要根据 USB Made Simple 的请求类型表的其余部分将接收者指定为接口：

```
D4:0 Recipient
0 = Device
1 = Interface
2 = Endpoint
3 = Other
4-31 = Reserved 
```

...并将长度设置为与嗅探请求相同，因此该命令的真实版本是：

```
ret = dev.ctrl_transfer(0xa1, 0x85, 0x1600, 0x0500, 2) 
```

# c - 如何将整数转换为字符串以在 UART 上打印整数

> ID：13370456
> 
> 赞同：0
> 
> 时间：2012-11-13T23:07:41.110
> 
> 标签：c, integer, char

我想在 uart 屏幕上打印出程序中计算的整数值。我基本上是在创建一个数据记录系统。用户必须能够查看角色到达的时间。

我无法使用 printf 或 snprintf 或 sprint，因为我正在创建一个时间触发系统并且 printf 需要一些时间来执行。我搜索了stackoverflow并找到了一些想法，但是它们似乎不起作用。例如 itoa, char c int i = 26; c = (char) i ( 不起作用但给出奇怪的字符)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T00:40:57.167

在您的示例中，您尝试打印 26 十进制。这不是 ASCII 字符集中的可打印字符。您必须将 2 转换为 ASCII（十进制 50），然后将 6 转换为 ASCII（十进制 54）才能打印 26。换句话说，它一次必须是一个数字。

您可以通过迭代地将十进制 48 添加到变量中的每个数字（ASCII 零的偏移量）并将 ASCII 数字从最高有效数字加载到缓冲区中的最低数字并传输它来做到这一点。

# c++ - .txt 文件中的结构数组

> ID：13370459
> 
> 赞同：2
> 
> 时间：2012-11-13T23:07:50.240
> 
> 标签：c++

有一个项目，我应该要求用户输入文件名，然后获取该文件并制作一个结构数组。我完全迷路了！这是我到目前为止所拥有的

```
#include <iostream>
#include <fstream>
#include <string>
#include <iomanip>

using namespace std;

string filename;
ifstream inFile;

struct ftballPlayer
{
    int NO;
    string first;
    string last;
    char POS;
    char clas;
    int height;
    char ds;
    int iheight;
    string hometown;
};

int counter=0;
const int MAX_PLAYER=50;
void printList(const ftballPlayer list[],  int listSize);
void printOne ( ftballPlayer two);
void getData(ifstream& inFile, ftballPlayer list[], int& listSize);

int main ()
{
    ftballPlayer list[MAX_PLAYER] ;
    cout << "Enter the name of the input file:  " ;
    cin >> filename;

    inFile.open(filename.c_str ()  );

    if (!inFile)
    {
        cout<<"Cannot Open Input File."<<endl;
        cout<< "Program Terminates!"<<endl;
        return 1;
    }

    inFile.ignore (200,'\n');
    getData (inFile,  list, counter);

    for ( counter = 0;counter < 50;counter++)
    {
        printOne (list[ counter] ) ;
        cout  <<endl;
    }

    return 0;
}

void getData(ifstream& inFile, ftballPlayer list[], int& listSize)
{
    ftballPlayer item ;
    listSize = 0;

    inFile >> item.NO >> item.first >> item.last
           >> item.POS >> item.clas >> item.height
           >> item.ds >> item.iheight >> item.hometown;

    while (inFile )
    {
        list [listSize ] = item ;
        listSize++;

        inFile >> item.NO >> item.first >> item.last
               >> item.POS >> item.clas >> item.height 
               >> item.ds >> item.iheight >> item.hometown;
    }

    inFile.close () ;

}

void printList(const ftballPlayer list[],  int listSize)
{
    int looper;

    for ( looper = 0; looper <  listSize ; looper++)
    {
        printOne ( list [looper]  );
        cout << endl ;
    }
}

void printOne ( ftballPlayer one)
{  
    cout << fixed << showpoint << setprecision (2);
    cout << "NO " << one.NO;
    cout << setw(5) << left << "  Name: " << one.first << " " << one.last;

    cout << "  POS " << one.POS << setw(5);
    cout << "Class "<<one.clas<<setw (5);
    cout << "Height "<<one.height<<" "<<one.ds<<" "<<one.iheight<<setw(5);
    cout << "Hometown " << one.hometown << endl;
} 
```

有人能告诉我我是否走在正确的轨道上吗？我得到的打印输出甚至不接近文本文件。

> 姓名 职位 班级 身高体重 家乡/高中/上一所大学
> 60 Josh Mann OL SO 6-4 300 Virginia Beach, Va./Ocean Lakes
> 64 Ricky Segers K/P FR 5-11 185 Glen Allen, Va./Henrico
> 70 Brandon Carr OL RS_SR 6-2 305 Chesapeake, Va./Western Branch/Fork Union Military Academy
> 53 Calvert Cook LB FR 6-0 250 Norfolk, Va./Booker T. Washington
> 51 Michael Colbert DE RS_SR 6-1 230 Fayetteville, NC/ EE Smith
> 22 TJ Cowart CB RS_JR 5-9 190 Virginia Beach, Va./Ocean Lakes
> 1 Jakwail Bailey WR SO 5-11 185 Haddonfield, NJ/Paul VI
> 25 Andre Simmons S JR 6-0 205 Lorton, Va./South County /范德比尔特
> 34 Johnel Anderson RB FR 5-8 180 Sicklerville, NJ/保罗六世

这是用户可以输入的三个之一，但它们都具有相同类型的信息。我查看了我的教科书，并且已经在网上搜索了几个小时，当用户输入文件而不是从文件开始时，我找不到任何关于这样做的信息。任何帮助或方向将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T23:11:49.103

有几件事我马上就看错了。

```
struct ftballPlayer
{
       int NO;
       string first;
       string last;
       char POS; // Should be multiple characters
       char clas; // Should be multiple characters
       int height;
       char ds;
       int iheight;
       string hometown;
}; 
```

我怀疑如果你的 POS/class 尺寸合适，它会更好地工作。为什么不让它们成为字符串？

此外，读取最后一位存在一些问题。看起来你必须寻找 / 来区分各个部分，但我看不到你这样做。

总体而言，如果您可以更改输入格式，那么阅读此内容会更清晰，但我怀疑您无法做到。逗号分隔的值非常容易阅读，就像任何其他分隔符一样。

# teamcity - 如何防止团队城市清理nuget工件

> ID：13370462
> 
> 赞同：16
> 
> 时间：2012-11-13T23:08:17.363
> 
> 标签：teamcity, nuget

我们将团队城市用作 nuget 服务器，并且工件清理正在删除旧的 nuget 包。不幸的是，我们的一些包不是经常构建的，当它们被清理时，其他构建就会中断。

我尝试将清理规则更改为 exclude `*.nupkg`，但这似乎不起作用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-08T17:21:40.010

我不知道您在发布此内容时使用的 TC 版本，但在版本 7 及更高版本中，有一个地方可以设置清理规则。

通过设置`-:*.nupkg`，您可以从清理过程中排除 NuGet 包。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:28:33.877

在 TeamCity 的 Build History Clean-up 选项中，您会在底部附近找到一个 Dependencies 类别，其中包含一个选项以防止清理其他构建配置所依赖的构建。我认为这将解决您的问题。

# facebook - FQL - 获取用户墙上的所有帖子

> ID：13370472
> 
> 赞同：3
> 
> 时间：2012-11-13T23:09:02.650
> 
> 标签：facebook, facebook-graph-api, facebook-fql

我需要获取所有 me() 墙贴。我正在使用以下 FQL：

```
SELECT post_id, comments, message 
FROM stream
WHERE source_id = me() 
AND created_time > 946684800 AND created_time < now() 
```

但这仅返回 7 个条目，实际上必须有更多.. (NB 946684800 = Sat, 01 Jan 2000 00:00:00 GMT)

我还尝试使用以下查询：

```
SELECT post_id, actor_id, target_id, message, comments 
FROM stream 
WHERE source_id = me() 
AND is_hidden = 0
ORDER BY created_time 
DESC LIMIT 1000000 
```

虽然它返回 394 个条目，但最早的数据是 2012 年 4 月 30 日星期一 12:56:04 GMT，因为它必须返回更多。

我需要拥有用户提交的整个墙帖。

在我更加沮丧之前有什么想法:)？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T10:23:42.303

对您的问题的简单回答是……您无法仅通过一个查询就将所有帖子都放在墙上，您必须循环并提出更多请求才能获得更多帖子。您还可以查看 Facebook 页面上的这篇[博客文章](https://developers.facebook.com/blog/post/478/)，以更清楚地了解 Facebook 如何发送结果。还请记住，在 Facebook 对其进行可见性检查之前，您可以获得的最大结果是 5000，如帖子中所述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T14:36:15.463

请注意，正如 facebook 宣布的那样，从 2013 年 2 月 6 日起，搜索帖子时不再允许偏移。使用 'since' 和 'until' 来进行分页。

# java - RichFaces 4 中的 ExtendedDataTable：数据模型处理

> ID：13370478
> 
> 赞同：2
> 
> 时间：2012-11-13T23:09:58.343
> 
> 标签：java, jsf-2, richfaces

我还有一个问题，与我在一月份发布的问题有些相关。我有一个列表，它是丰富的：extendedDataTable 组件，它会即时更新，因为用户在单独的文本框中键入他的搜索条件（即用户键入前 4 个字符，并且当他继续键入时，结果列表更改）。最后它工作正常，当我使用 RichFaces 3 时，但当我升级到 RichFaces 4 时，我遇到了各种编译问题。以下类不再可访问，并且似乎没有合适的替代品：

```
org.richfaces.model.DataProvider
org.richfaces.model.ExtendedTableDataModel
org.richfaces.model.selection.Selection
org.richfaces.model.selection.SimpleSelection 
```

这是以前的情况：

这是应该触发搜索逻辑的输入文本：

```
<h:inputText id="firmname" value="#{ExtendedTableBean.searchValue}">
   <a4j:support ajaxSingle="true" eventsQueue="firmListUpdate"  
                reRender="resultsTable" 
                actionListener="#{ExtendedTableBean.searchForResults}" event="onkeyup" />
</h:inputText> 
```

动作监听器应该更新列表。这是扩展数据表，就在 inputText 的正下方：

```
<rich:extendedDataTable tableState="#{ExtendedTableBean.tableState}" var="item"
                       id="resultsTable" value="#{ExtendedTableBean.dataModel}">

        ... <%-- I'm listing columns here --%>

</rich:extendedDataTable> 
```

这是后端代码，我在其中使用我的数据模型处理：

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

package com.beans;

import java.io.FileInputStream;
import java.util.ArrayList;
import java.util.Collections;
import java.util.ConcurrentModificationException;
import java.util.List;
import java.util.Properties;
import java.util.concurrent.CopyOnWriteArrayList;
import javax.faces.context.FacesContext;
import javax.faces.event.ActionEvent;
import org.richfaces.model.DataProvider;
import org.richfaces.model.ExtendedTableDataModel;

public class ExtendedTableBean {      
    private String sortMode="single";
    private ExtendedTableDataModel<ResultObject> dataModel;
    //ResultObject is a simple pojo and getResultsPerValue is a method that 
    //read the data from the properties file, assigns it to this pojo, and
    //adds a pojo to the list 

    private Object tableState;
    private List<ResultObject> results = new CopyOnWriteArrayList<ResultObject>();
    private List<ResultObject> selectedResults = 
                                      new CopyOnWriteArrayList<ResultObject>();

    private String searchValue;

    /**
     * This is the action listener that the user triggers, by typing the search value
     */
    public void searchForResults(ActionEvent e) {
       synchronized(results) {
           results.clear();
       }        

       //I don't think it's necessary to clear results list all the time, but here
       //I also make sure that we start searching if the value is at least 4 
       //characters long
       if (this.searchValue.length() > 3) {
           results.clear();
           updateTableList();
       } else {
           results.clear();
       }

       dataModel = null; // to force the dataModel to be updated.
    }

    public List<ResultObject> getResultsPerValue(String searchValue) {
        List<ResultObject> resultsList = new CopyOnWriteArrayList<ResultObject>();

        //Logic for reading data from the properties file, populating ResultObject
        //and adding it to the list

        return resultsList;
    }

    /**
     * This method updates a firm list, based on a search value
     */
    public void updateTableList() {
        try {              
            List<ResultObject> searchedResults = getResultsPerValue(searchValue);

            //Once the results have been retrieved from the properties, empty 
            //current firm list and replace it with what was found.

            synchronized(firms) {
                firms.clear();
                firms.addAll(searchedFirms);
            }
        } catch(Throwable xcpt) {
            //Exception handling
        }
    }

    /**
     * This is a recursive method, that's used to constantly keep updating the 
     * table list.
     */
    public synchronized ExtendedTableDataModel<ResultObject> getDataModel() {
        try {
            if (dataModel == null) {
                dataModel = new ExtendedTableDataModel<ResultObject>(
                               new DataProvider<ResultObject>() {
                                   public ResultObject getItemByKey(Object key) {
                                       try {
                                           for(ResultObject c : results) {
                                               if (key.equals(getKey(c))){
                                                   return c;
                                               }
                                           }
                                       } catch (Exception ex) {
                                           //Exception handling
                                       }
                                       return null;
                                   }

                                   public List<ResultObject> getItemsByRange(
                                                 int firstRow, int endRow) {
                                       return Collections.unmodifiableList(results.subList(firstRow, endRow));
                                   }

                                   public Object getKey(ResultObject item) {
                                       return item.getResultName();
                                   }

                                   public int getRowCount() {
                                       return results.size();
                                   }
                              });
            }
        } catch (Exception ex) {
            //Exception handling    
        }

        return dataModel;
    }

    //Getters and setters 

} 
```

现在类 ExtendedTableDataModel 和 DataProvider 不再可用，我应该改用什么？RichFaces 论坛声称实际上什么都没有，开发人员在那里几乎是靠自己的（这意味着他们必须自己实现）。有没有人有任何其他想法或建议？

再次感谢您的所有帮助，再次抱歉，很抱歉提出了一个冗长的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T04:45:36.033

您可以转换您的数据模型以扩展抽象`org.ajax4jsf.model.ExtendedDataModel`，而不是它实际上是一个更健壮且性能更佳的数据模型，可用于`<rich:extendedDataTable/>`. 将您现有的模型粗略翻译成下面的新模型（我决定使用您现有的`ExtendedDataModel<ResultObject>`作为基础数据源而不是`results`列表来演示翻译）：

```
 public class MyDataModel<ResultObject> extends ExtendedDataModel<ResultObject>{

    String currentKey; //current row in the model
    Map<String, ResultObject> cachedResults = new HashMap<String, ResultObject>(); // a local cache of search/pagination results
    List<String> cachedRowKeys; // a local cache of key values for cached items
    int rowCount;
    ExtendedTableDataModel<ResultObject> dataModel; // the underlying data source. can be anything

    public void setRowKey(Object item){
     this.currentKey = (ResultObject)item.getResultName();   
    }

    public void walk(FacesContext context, DataVisitor visitor, Range range, Object argument) throws IOException {
    int firstRow = ((SequenceRange)range).getFirstRow();
    int numberOfRows = ((SequenceRange)range).getRows();
    cachedRowkeys = new ArrayList<String>();
    for (ResultObject result : dataModel.getItemsByRange(firstRow,numberOfRows)) {
       cachedRowKeys.add(result.getResultName());
       cachedResults.put(result.getResultName(), result); //populate cache. This is strongly advised as you'll see later.
       visitor.process(context, result.getResultName(), argument);
      }
    }

   }

 public Object getRowData() {
   if (currentKey==null) {
       return null;
   } else {
       ResultObject selectedRowObject = cachedResults.get(currentKey); // return result from internal cache without making the trip to the database or other underlying datasource
       if (selectedRowObject==null) {  //if the desired row is not within the range of the cache

           selectedRowObject = dataModel.getItemByKey(currentKey);
           cachedResults.put(currentKey, selectedRowObject);
           return selectedRowObject;
       } else {
           return selectedRowObject;
       }
   }

 public int getRowCount(){
 if(rowCount == 0){
    rowCount = dataModel.getRowCount(); //cache row count
    return  rowCount;
  }
  return rowCount

 } 
```

这些是该类中最重要的 3 个方法。还有很多其他方法，基本上是从您不需要担心的旧版本继承而来的。如果您将 JSF 状态保存到客户端，您可能会对`org.ajax4jsf.model.SerializableDataModel`用于序列化的目的感兴趣。请参阅[此处](http://gochev.blogspot.com/2009/08/richfaces-server-side-paging-with.html)的示例。这是一个旧博客，但逻辑仍然适用。

与此无关，您当前的实现`getRowData`将在生产级应用程序中表现不佳。必须遍历每个元素才能返回结果？尝试更好的搜索算法。

# cordova - navigator.notification.alert 窗口的宽度是否会因设备而异

> ID：13370484
> 
> 赞同：0
> 
> 时间：2012-11-13T23:10:27.887
> 
> 标签：cordova

我对我刚刚注意到的东西很好奇。

我正在使用 XCode 4.5.1 和 PhoneGap 1.9。

当我在 iPad 和 iPhone 模拟器之间切换时，navigator.notification.window 的大小不会改变。当应用程序在更大的设备上运行时，我会认为窗口会更大。

谢谢罗伯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T09:25:59.707

根据[科尔多瓦文档](http://docs.phonegap.com/en/edge/cordova_notification_notification.md.html#Notification)：

> notification.alert: [... ] 大多数 Cordova 实现为此功能使用本机对话框

这包括 iOS，这意味着 Cordova 只是显示一个本机警报框。无论设备的屏幕尺寸如何，这些在所有设备上都是相同的“尺寸”。您可以在模拟器中自己尝试一下，例如，如果您在 Safari 中输入了无效的协议（“qqq://test”）。无论设备如何，出现的警报窗口都完全相同！

# c# - 控制台应用程序没有参数时不执行默认方法

> ID：13370490
> 
> 赞同：0
> 
> 时间：2012-11-13T23:11:16.480
> 
> 标签：c#, ndesk.options

下面的默认功能在我执行时没有被执行`myExe.exe`，但是在我运行时它正在执行`myExe.exe -launch`。关于为什么此应用程序默认不执行的任何想法？根据[文档](http://www.ndesk.org/doc/ndesk-options/NDesk.Options/OptionSet.html)，这应该可以

文档摘录：

```
As a fallback, a default handler may be registered which will handle all arguments which are not handled by any of the above matching algorithms. The default handler is designated by the name <> (which may be an alias for another named NDesk.Options.Option). 
```

我的代码：

```
public static void Main (string[] args)
{
    bool showHelp = false;
    var options = new OptionSet() {
        {
            "h", "Show help",
            v => showHelp = true
        }, {
            "config", "Reconfigure the launcher with different settings",
            v => PromptConfig()
        }, {
            "v", "Show current version",
            v => ShowVersion()
        }, {
            "launch",
            v => LaunchApplication()
        }, {
            "<>", //default
            v => LaunchApplication()
        }
    };

    //handle arguments
    List<string> extra;
    try {
        extra = options.Parse (args);
    }
    catch (OptionException e) {
        Console.Write("MyApp:");
        Console.WriteLine(e.Message);
        Console.WriteLine("Try `MyApp--help' for more information");
        return;
    }

    if (showHelp) {
        ShowHelp(options);
        return;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:21:55.807

默认处理程序旨在处理您没有为其提供特定处理程序的任何参数。

在您的情况下，运行`MyExe.exe`不应调用默认处理程序，因为没有要处理的参数。如果您运行命令行，`MyExe.exe -someUnknownArgument` *那么*默认处理程序应该启动。

无论如何，我相信该`Parse`方法的目的是帮助您解析命令行并初始化您自己的表示参数的模型，然后对其进行操作。

因此，例如，您的代码可能如下所示：

```
public enum Action
{
    ShowHelp,
    ShowVersion,
    PromptConfig,
    LaunchApplication
}

public static void Main (string[] args)
{
    var action = Action.LaunchApplication;

    var options = new OptionSet() {
        {
            "h", "Show help",
            v => action = Action.ShowHelp
        },
        {
            "config", "Reconfigure the launcher with different settings",
            v => action = Action.PromptConfig
        },
        {
            "v", "Show current version",
            v => action = Action.ShowVersion
        }, 
        {
            "launch",
            v => action = Action.LaunchApplication
        }
    }

    try 
    {
        // parse arguments
        var extra = options.Parse(args);

        // act
        switch (action)
        {
            // ... cases here to do the actual work ...
        }
    }
    catch (OptionException e) 
    {
        Console.WriteLine("MyApp: {0}", e.Message);
        Console.WriteLine("Try `MyApp --help' for more information");
    }
} 
```

# c# - 根据条件过滤查询

> ID：13370491
> 
> 赞同：0
> 
> 时间：2012-11-13T23:11:28.167
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, linq, linq-to-entities

我正在尝试根据查询结果是否包含字符串“baby”来过滤查询结果。

```
IEnumerable<ICD.ViewModels.HomeSearchViewModel> query =
                ICDUnitOfWork.AlphaGroups.Find().GroupJoin(ICDUnitOfWork.Alphas.Find(),
                                                           a => a.AlphaGroupID,
                                                           g => g.AlphaGroupID,
                                                           (alphaGroups, alphas) =>
                                                           new ICD.ViewModels.
                                                               HomeSearchViewModel
                                                               {
                                                                   AlphaGroups =
                                                                       alphaGroups,
                                                                   Alphas = alphas
                                                               })
                    .Where(row =>
                           row.AlphaGroups.Title.Contains("baby")
                           || row.Alphas.Any(alpha => alpha.Title.Contains("baby"))
                    ); 
```

问题是当 Alpha.Title 包含字符串“baby”时，它应该只显示包含“baby”的 Alpha，而不是 AlphaGroup 中的每个 alpha。如果 AlphaGroup.Title 包含“婴儿”，它应该继续显示组中的每个 alpha。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T08:52:47.093

您可以尝试以下方法：

```
IEnumerable<ICD.ViewModels.HomeSearchViewModel> query =
                ICDUnitOfWork.AlphaGroups.Find()
                             .GroupJoin(
                                   ICDUnitOfWork.Alphas.Find()
                                                .GroupBy(a => new 
                                                                {
                                                                  BabyIndicator = a.Title.Contains("baby"),
                                                                  GroupID = a.AlphaGroupID
                                                                }),
                                   a => a.AlphaGroupID,
                                   g => g.Key.GroupID,
                                   (alphaGroups, alphas) =>
                                      new ICD.ViewModels.HomeSearchViewModel()
                                        {
                                          AlphaGroups = alphaGroups,
                                          Alphas = alphaGroups.Title.Contains("baby") ?
                                            alphas.Select(g => g.AsEnumerable()).Aggregate((g1,g2) => g1.Concat(g2)) :
                                            alphas.Aggregate(
                                            (g1,g2) => g1.Key.BabyIndicator ?
                                                       g1 :
                                                       g2).AsEnumerable()
                                        }) 
```

逻辑：

> 问题是当 Alpha.Title 包含字符串“baby”时，它应该只显示包含“baby”的 Alpha，而不是 AlphaGroup 中的每个 alpha。

Here we group the alphas by groupID and whether they have babies, we then group join this onto the alphGroups. So we have four possibilities, no groups, one group without baby, one group with only babies and one of each. To pull this all together we aggregate. If there are no groups it returns no groups, if there is one group it returns that group, if there are two groups it returns only the one with babies.

> If the AlphaGroup.Title contains "baby" it should continue to show each alpha in the group.

Here we check whether an alphaGroup has a title baby, if it does return the whole grouping, if not apply alpha title logic

# optimization - 有没有办法在 x86 中将 8 位值添加到 32 位寄存器？

> ID：13370492
> 
> 赞同：1
> 
> 时间：2012-11-13T23:11:41.007
> 
> 标签：optimization, assembly, x86

有没有办法在 x86 中将 8 位值添加到 32 位寄存器？

例如，如果您执行“ADD EAX,8”，则 8 将被编码为 32 位值，因此您的二进制文件中将包含“08000000”。如果您要加一个，您显然可以使用 INC 指令，但是有没有办法在 x86 汇编中添加一个通用的 8 位值？

请注意，我认为您不能执行“ADD AL,8”，因为如果 AL 已经包含 xFE，那么它就不会进行进位。但是，“ADC AL,8”会带来价值吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T02:18:41.460

有一种使用 8 位符号扩展立即数的编码，它被列为`ADD r/m32, imm8`opcode `83 /0`。您如何表示您想要该编码取决于您的汇编程序，但您忘记提及您使用的是哪一个。`nasm`例如，如果您打开优化或您像这样明确要求它，则自动使用此编码：`add eax, byte 8`. GNU 汇编器似乎也使用较短的编码，实际上我不知道如何将其强制为 32 位（与您的问题相反）。

# sql - PL/SQL 帮助检查特定表中的特定值

> ID：13370494
> 
> 赞同：1
> 
> 时间：2012-11-13T23:11:50.980
> 
> 标签：sql, sql-server

我有疑问。我有 1 列`user_auto`有价值`234`。我想找出哪个表正在使用此列并具有特定值。

我已经完成了有多少表正在使用该列。

```
SELECT t.name AS table_name
FROM sys.tables AS t
INNER JOIN sys.columns c ON t.OBJECT_ID = c.OBJECT_ID
WHERE c.name LIKE '%user_auto%'
ORDER BY  table_name; 
```

现在我想要这张表`user_auto = 234`改变值。表示 User_auto 的值为 234。想要有关此用户的所有详细信息吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T00:03:02.283

你想要这样的东西吗？

```
SQL> desc foo1
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 USER_AUTO                                          NUMBER

SQL> desc foo2
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 USER_AUTO                                          NUMBER

SQL> select * From foo1;

 USER_AUTO
----------
       123
      1234

SQL> select * From foo2;

 USER_AUTO
----------
       234

SQL> set serverout on
SQL> declare
  2    v_val varchar2(3) := '234';
  3    v_cnt pls_integer;
  4  begin
  5    for r_tab in (select table_name, column_name
  6                    from all_tab_columns
  7                   where column_name = 'USER_AUTO'
  8                   order by 1)
  9    loop
 10      dbms_output.put_line('Found table ' || r_tab.table_name || ' with column '||r_tab.column_name);
 11      execute immediate 'begin select count(*) into :b0 from '
 12                        || r_tab.table_name
 13                        || ' where rownum = 1 and ' || r_tab.column_name || ' = :b1;'
 14                        || 'end;' using out v_cnt, v_val;
 15      if (v_cnt = 1)
 16      then
 17        dbms_output.put_line(chr(9)||'row found for ' || v_val);
 18      else
 19        dbms_output.put_line(chr(9)||'no row found for ' || v_val);
 20      end if;
 21    end loop;
 22  end;
 23  /
Found table FOO1 with column USER_AUTO
        no row found for 234
Found table FOO2 with column USER_AUTO
        row found for 234

PL/SQL procedure successfully completed. 
```

# ajax - 未捕获的类型错误：对象# has no method 'apply' jQuery is throwing the following error: Uncaught TypeError: Object # has no method 'apply' f.event.dispatch h.handle.i I've found these rel 问问题 问问题 2012-11-13T23:11:53.380 6897 次 This question shows research effort; it is useful and clear 2 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. jQuery is throwing the following error: Uncaught TypeError: Object # has no method 'apply' f.event.dispatch h.handle.i I've found these related posts, but couldn't solve the problem using them: This, this and this. Here's the troublesome code: $(document).ready(function(){ $('form.rating').click({ cancelShow:true, callback: function(ui, type, new_value) { var values = ui.$form.serializeArray(); values.push({ 'name': 'rating', 'value': new_value }); values = jQuery.param(values); var msg = ui.$form.attr('update-msg'); $(msg).removeClass('hidden'); $(msg).show(); $(msg).find('div.msg-default').show(); $(msg).find('div.msg-result').hide(); $.ajax({ 'type': 'POST', 'dataType': 'json', 'url': ui.$form.attr('action'), 'data': values }).done(function(data) { var overall_rating = ui.$form.attr('update-overall'); if(overall_rating && data['overall_rating']){ $(overall_rating).html(data['overall_rating']); } if(msg){ $(msg).find('div.msg-default').hide(); if(data['msg']) { $(msg).find('div.msg-result').show(); $(msg).find('div.msg-result').html(data['msg']); window.setTimeout(function() { $(msg).addClass('hidden'); }, 2000); } else { $(msg).addClass('hidden'); } } if(data['user_rating'] && data['user_rating']>0) { ui.select(parseInt(data['user_rating'])); } }); } }); }); Any ideas? Edit: Okay, so I stripped it down to: $(document).ready(function(){ $('form.rating').click({ }); }); And it is still showing the same error. Could this have something to do with my jQuery script? The only other info it shows is this line, but I don't think it helps much, since the file has 3 lines in total: jquery-1.7.2.min.js:3 The jquery click handler expects an anonymous function, like this: $(document).ready(function(){ $('form.rating').click(function() { // go for it! }); }); ajaxjquery 4 2 回答 2 This answer is useful 5 jquery click 处理程序需要一个匿名函数，如下所示： $(document).ready(function(){ $('form.rating').click(function() { // go for it! }); }); 于 2013-03-20T14:38:06.877 回答 This answer is useful 2 @Ludder is close, but off by just a little. He's right that you need to be passing a function as the argument to click, but it doesn't have to be anonymous. a = {myFun: function(){console.log("a");}} $(document).ready(function(){ $('body').click(a.myFun); }); and b = function(){console.log("b");} $(document).ready(function(){ $('body').click(b); }); and function c () {console.log("c");} $(document).ready(function(){ $('body').click(c); }); All log their bit of the alphabet. You were passing an empty object to click, give it a function instead. 于 2013-05-27T18:54:01.020 回答 Related 2 c++ - C++ 类设计“辅助函数” 1 r - R 包，试图将函数应用于 Biostring 视图？ 1 excel - VBA Copy & paste chart in excel 1 android - 从一个轴opengl旋转3D模型 2 wordpress - Nivo 滑块未加载 0 post - FQL - 流量限制 1 session - 经典 ASP / IIS6 - 会话 Cookie 不断堆积 1 css - 热点在“鼠标按下”的左侧和右侧创建两条彩色线条 1 html - How to save rounded corner Image using todataUrl? 1 css - Replace table with td and tr with div Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：13370495
> 
> 赞同：2
> 
> 时间：
> 
> 标签：ajax, jquery

jQuery is throwing the following error:

> Uncaught TypeError: Object # has no method 'apply'
> 
> f.event.dispatch
> 
> h.handle.i

I've found these related posts, but couldn't solve the problem using them: [This](https://stackoverflow.com/questions/11032659/uncaught-typeerror-object-object-object-has-no-method-apply), [this](https://stackoverflow.com/questions/11032659/uncaught-typeerror-object-object-object-has-no-method-apply) and [this](https://stackoverflow.com/questions/10741588/uncaught-typeerror-object-functionarg1-arg2-has-no-method-apply).

Here's the troublesome code:

```
$(document).ready(function(){
$('form.rating').click({
    cancelShow:true,
    callback: function(ui, type, new_value) {
        var values = ui.$form.serializeArray();
        values.push({
            'name': 'rating',
            'value': new_value
        });
        values = jQuery.param(values);
        var msg = ui.$form.attr('update-msg');
        $(msg).removeClass('hidden');
        $(msg).show();
        $(msg).find('div.msg-default').show();
        $(msg).find('div.msg-result').hide();
        $.ajax({
            'type': 'POST',
            'dataType': 'json',
            'url': ui.$form.attr('action'),
            'data': values
        }).done(function(data) { 
            var overall_rating = ui.$form.attr('update-overall');
            if(overall_rating && data['overall_rating']){
                $(overall_rating).html(data['overall_rating']);
            }
            if(msg){
                $(msg).find('div.msg-default').hide();
                if(data['msg']) {
                    $(msg).find('div.msg-result').show();
                    $(msg).find('div.msg-result').html(data['msg']);
                    window.setTimeout(function() {
                        $(msg).addClass('hidden');
                    }, 2000);
                } else {
                    $(msg).addClass('hidden');
                }
            }
            if(data['user_rating'] && data['user_rating']>0) {
                ui.select(parseInt(data['user_rating']));
            }
        });
    }
});
}); 
```

Any ideas?

**Edit:** Okay, so I stripped it down to:

```
$(document).ready(function(){
    $('form.rating').click({
    });
}); 
```

And it is still showing the same error. Could this have something to do with my jQuery script? The only other info it shows is this line, but I don't think it helps much, since the file has 3 lines in total: jquery-1.7.2.min.js:3

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T14:38:06.877

jquery click 处理程序需要一个匿名函数，如下所示：

```
$(document).ready(function(){
    $('form.rating').click(function() {
        // go for it!
    });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-27T18:54:01.020

@Ludder is close, but off by just a little. He's right that you need to be passing a function as the argument to `click`, but it doesn't have to be anonymous.

```
a = {myFun: function(){console.log("a");}}
$(document).ready(function(){
    $('body').click(a.myFun);
}); 
```

and

```
b = function(){console.log("b");}
$(document).ready(function(){
    $('body').click(b);
}); 
```

and

```
function c () {console.log("c");}
$(document).ready(function(){
    $('body').click(c);
}); 
```

All log their bit of the alphabet. You were passing an empty object to click, give it a function instead.

# php - 正则表达式在 PHP 中的大括号之间查找 html

> ID：13370496
> 
> 赞同：1
> 
> 时间：2012-11-13T23:12:02.360
> 
> 标签：php, regex

我是正则表达式的新手，我遇到了一些麻烦。我正在尝试获取 {{#user_data?}} 和 {{/user_data?}} 之间的所有内容

```
$content = '
{{#user_data?}}
<span class="hello">
Hello, {{username}}!
</span>
{{/user_data?}}';

$key = 'user_data?';
$regex = '/\{\{#'.$key.'\}\}(.*?)\{\{\/'.$key.'\}\}/';
if (preg_match_all($regex, $content, $matches))
{
print_r($matches);
}
else
echo 'no match found'; 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T03:42:24.450

除了注释的“不转义`?`符号”之外，您还需要适当的修饰符：

```
$content = <<<STR
{{#user_data?}}
<span class="hello">
Hello, {{username}}!
</span>
{{/user_data?}}
STR;

$key = 'user_data\?';
$regex = '/\{\{#'.$key.'\}\}(.*?)\{\{\/'.$key.'\}\}/sim';
preg_match_all($regex, $content, $matches,PREG_SET_ORDER);
print_r($matches); 
```

这将输出：

```
Array
(
    [0] => Array
        (
            [0] => {{#user_data?}}
<span class="hello">
Hello, {{username}}!
</span>
{{/user_data?}}
            [1] => 
<span class="hello">
Hello, {{username}}!
</span>

        )

) 
```

`i`不是必需的，如果您需要区分大小写的模板，则应将其删除；

`m`根据[关于 PCRE 修饰符的 PHP 文档](http://www.php.net/manual/en/reference.pcre.pattern.modifiers.php)，也可能是不必要的；

`s`是必须的，因此您可以将多行字符串与点匹配。

# ruby-on-rails - 您可以检查 ruby on rails 中同一行上的多个值是否相同吗？

> ID：13370497
> 
> 赞同：6
> 
> 时间：2012-11-13T23:12:08.223
> 
> 标签：ruby-on-rails, ruby

基本上，我正在尝试检查我的 6 个值是否相同。我试着把它们串起来：

```
if val1 == val2 == val3 == val4 == val5 == val6
  #...
end 
```

但这会出错。这可以使用另一种方法吗？谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-13T23:14:18.910

尝试这个：

```
if [val1, val2, val3, val4, val5, val6].uniq.count == 1
  #...
end 
```

如果你想变漂亮，你可以试试这个

```
unless [val2, val3, val4, val5, val6].find{ |x| x != val1 }
  # ...
end 
```

一旦找到不等于 的元素，上述将立即停止`val1`，否则将执行该块。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T23:16:42.657

一个可爱的方式：

```
[val1,val2,val3,valN].uniq.size == 1 
```

一种更平淡的方式：

```
[val2,val3,valN].all?{ |x| x == val1 } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-14T00:05:44.703

如果值是Fixnum，这条性感的线会起作用：

```
if val1 == val2 & val3 & val4 & val5 & val6
  # ...
end 
```

如果不是，那么这种脂肪适用于任何类型

```
if [val1] == [val2] & [val3] & [val4] & [val5] & [val6]
   # ...
end 
```

# xcode - 无法在 Mac OS X Lion 10.7 上的 XCode 4.5 中构建文本 IRC 客户端

> ID：13370501
> 
> 赞同：1
> 
> 时间：2012-11-13T23:12:16.180
> 
> 标签：xcode, macos, build, osx-lion, xcode4.5

我正在尝试从[source构建](https://github.com/Codeux/Textual/)[Textual IRC Client](http://www.codeux.com/textual/)。

它在 4 月份对我有用，使用当时最新的源代码和最新的 XCode，在同一台 OS X 10.7 计算机上。现在它不起作用。

示例错误消息

> *   在“NSArray *”类型的对象上未找到读取数组元素的预期方法
>     
>     
> *   在“NSDictionary *”类型的对象上找不到读取字典元素的预期方法
>     
>     
> *   在“NSMutableDictionary *”类型的对象上找不到写入字典元素的预期方法

我已经关闭了所有项目和目标的构建设置中的代码签名（通过设置`Code Signing Identity`为`Don't Code Sign`），否则源代码是干净的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:12:16.180

这些错误是由于 Mac OS X 10.8 SDK 中引入的新功能造成的。其中许多仍然[向后兼容 Mac OS X Snow Leopard 10.6](http://developer.apple.com/library/ios/#releasenotes/ObjectiveC/ObjCAvailabilityIndex/_index.html)。

Textual 的`Base SDK`构建设置设置为`Current OS X`. 假设其他开发人员使用的是 Mac OS X Mountain Lion 10.8，他们将自动使用（当前最新的）10.8 SDK。即使 10.8 SDK 安装在 10.7 机器上，编译器也会选择 10.7 SDK，因为此 OS 相关设置。

修复：在 Textual 的构建设置中，更改`Base SDK`为`OS X 10.8`或`Latest OS X (OS X 10.8)`能够使用新功能。
更改所有项目的设置并确认该设置已应用于各自的目标：*Main Project (Textual)*、*Blowfish Encryption Framework*、*Hyperlink Processor Framework*、*Blowfish Key Control Extension*、*Brag Spam Extension*，最后是*System Profiler Extension*。构建*文本（标准版本）*现在应该可以工作了。

相关提交：[转换为](https://github.com/Codeux/Textual/commit/a9dcfadbc7c52f6c5e862ae51b469b8df6212941)引入 10.8 SDK 功能的现代 Objective-C。

# sql-server - CREATE TRIGGER 必须是批处理中的第一条语句

> ID：13370505
> 
> 赞同：25
> 
> 时间：2012-11-13T23:12:52.173
> 
> 标签：sql-server, tsql, triggers

我有以下触发器：

```
 CREATE Trigger enroll_limit on Enrollments
 Instead of Insert
 As
 Declare @Count int
 Declare @Capacity int
 Select @Count = COUNT(*) From Enrollments
 Select @Capacity = Capacity From CourseSections
 If @Count < @Capacity
 Begin 
      Insert Into Enrollments Select * From Inserted
 End
 GO 
```

我收到一条错误消息：

> 'CREATE TRIGGER' 必须是查询批处理中的第一条语句。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-11-14T04:55:01.167

错误消息“'CREATE TRIGGER' 必须是查询批处理中的第一条语句。” 通常发生在前面的一组（批）语句没有终止时`GO`

`GO`所以，我建议在前一批语句的末尾添加一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-17T18:55:11.723

如果您从 SQL Server Management Studio 尝试此操作，这里有另一个对我有用的选项：

在左窗格中，右键单击数据库并选择“新建查询”。

这会将您连接到特定的数据库。现在您可以在打开的查询窗口中输入您的创建触发器语句作为第一条语句。不需要“使用”命令。

[![在此处输入图像描述](../Images/32fcfdf9c77dddfd14f5ef00b9d94aab.png)](https://i.stack.imgur.com/i6ht4.png)

# java - 如何添加反序列化器以使用 Jackson 反序列化具有特定名称的字符串类型字段的值？

> ID：13370506
> 
> 赞同：0
> 
> 时间：2012-11-13T23:12:56.500
> 
> 标签：java, json, jackson

1-有没有办法将反序列化器添加到模块或被`ObjectMapper`拾取以反序列化具有特定名称或正则表达式模式的所有字段？（例如，与模式匹配的所有字段`.*url.*`？

2-还可以注册一个反序列化器，用于反序列化所有具有与特定正则表达式模式匹配的值的字段？（例如`http://.+`）。

3-或者是否有一个我可以在一个类上使用的注释，而不是用一个`ObjectMapper`可以用来代替 1 和 2 的注释来注册它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T01:08:59.927

对于（1）和（2），没有。

对于 3，您可以覆盖指定的 Serializer 或 Deserializer 以用于属性，其中：

```
public class POJO {
  @JsonSerialize(using=MySerializer.class)
  public String text;
} 
```

您可以为 (1) 做的只是为 注册一个自定义序列化程序`String.class`，并将其定义为`ContextualSerializer`. 当它的`createContextual()`方法被调用时，你可以检查它用于哪个属性；如果名称与您的正则表达式匹配，您可以构造替代字符串序列化程序；如果没有，那么简单的只是调用`JsonGenerator.writeString()`.

对于 (2)，您只需定义自定义字符串序列化程序并在序列化期间比较值，采取适当的措施。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T23:20:09.070

您可以注册一个 bean 序列化定制器来检查 bean 的属性，应用您的正则表达式，并根据需要安装您的定制序列化器。

引用大图的话：

> 扩展点是添加一个 BeanSerializerModifier，您可以通过 Module 实现来完成。SimpleModule 没有为此添加便捷方法，因此您需要实现 Module#setupModule()，调用 'addBeanSerializerModifier'。

反序列化端有一个并行结构。

# java - 将通用 ArrayList 设置为零

> ID：13370507
> 
> 赞同：0
> 
> 时间：2012-11-13T23:12:59.250
> 
> 标签：java, generics

我有一个数组列表。我想将它的每个元素设置为 0。现在我有：

```
ArrayList <T extends Number> arr = new ArrayList();

for(int i = 0; i < some_other_array.size(); i++)
{
    arr.add(0)
} 
```

编译器抱怨说

```
error: no suitable method found for set(int,int)
            arr.add(0);
               ^
    method ArrayList.set(int,T) is not applicable
      (actual argument int cannot be converted to T by method invocation conversion)
  where T is a type-variable:
    T extends Number 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T23:30:33.143

这是不可能的。的方法签名是

```
 public T ArrayList<T>.set(int index, T element) 
```

尽管对它的约束`T`是它`extends Number`，但这并不意味着它可以*由一个数字构成*。

例如，考虑

```
class FortyTwo extends Number {
      public byteValue() { return 42; }
      public intValue()  { return 42; }
      // etc
} 
```

您希望初始化例程对 a 做`ArrayList<FortyTwo>`什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T23:16:34.393

只需将您的列表声明更改为

```
ArrayList<Number> arr = new ArrayList<Number>(); 
```

`arr`将能够容纳任何扩展的东西[`Number`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Number.html)（我假设这是你想要的）。

现在，当你这样做时

```
arr.set(i, 0) 
```

这`0`将被自动装箱为`Integer`. （自己看，添加`0`和打印`arr.get(0) instanceof Integer`。）

例如，如果您想添加`double`s 或`long`s，您可以分别使用文字`0d`和`0L`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T23:24:25.563

尝试将 ArrayList 的声明更改为

```
ArrayList<Integer> arr = new ArrayList<Integer>(); 
```

Integer 类支持自动装箱，而 Number 类不支持。此外，该`add()`方法可能更适用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T23:17:48.777

这应该适用于您的情况：`arr.set(i, Integer.valueof(0));`

或者您可以重用这个方便的标准 API：`Collections.fill(arr, Integer.valueof(0));`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-13T23:27:11.390

为什么要将值设置为 0，它将自动为零，因为 ArrayList 对象将被实例化。因此代码将无用，因为此时大小将为零，因此不会执行循环。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-13T23:30:25.237

好吧，我认为您对`ArrayList`实际工作方式有点困惑。当你创建一个`ArrayList`时，它总是空的。即使您指定了大小：

```
ArrayList<Integer> arr = new ArrayList<Integer>(20); 
```

这`20`只是意味着“初始容量”，而不是“元素的起始数量”。结果，`set`将永远不会工作，因为根本没有元素。即使您像这样修复编译器问题：

```
arr.set(i, Integer.valueOf(0)); 
```

或者像这样：

```
ArrayList<Number> arr = new ArrayList<Number>(); 
```

它甚至不会做任何事情，因为`arr.size()`它为零，所以`for`循环甚至不会运行。

这里的关键是它`ArrayList` **不是**一个实际的数组。它包装了一个数组，当它有太多元素时会扩展它的内部数组。换句话说，我不能这样做：

```
ArrayList<Integer> arr = new ArrayList<Integer>(20);
arr.get(0); // Throws an out of bounds exception 
```

现在，话虽这么说，如果你*想*在你的 20 个零开始，你可以在你的循环`ArrayList`中使用该方法，而不是：`add``i < 20`

```
for(int i = 0; i < 20; i++) {
    arr.add(Integer.valueOf(0));
} 
```

这将为 . 添加 20 个零`arr`。您的代码，即使在修复错误之后，也不会。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-11-13T23:15:09.807

你可以试试这个（据我所知，你不能将原始类型添​​加到 ArrayList）：

```
ArrayList<Integer> arr = new ArrayList<Integer>();

for(int i = 0; i < someNumber; i++)
{
   arr.add(0);
} 
```

请记住，当 size 为 0 时，因为它没有任何默认值，并且您应该查看容量（您可以在构造函数中设置容量。）

# objective-c - 在 UIWebView 中预加载 JavaScript

> ID：13370509
> 
> 赞同：0
> 
> 时间：2012-11-13T23:13:14.650
> 
> 标签：objective-c, ios, xcode, ipad, cocoa

因此，我目前正在开发一个 iPad 应用程序 (iOS 6)，该应用程序显示了位于我公司内部网上的网页。来自 Internet 的访问是通过反向代理实现的，效果很好。

问题是这个网页引用了一个 JavaScript 文件，该文件是在网页在客户端上呈现*后*加载的，这导致一些 jQuery 脚本在加载时没有运行。有效的是：

*   通过反向代理打开网站
*   等待调用 webViewDidFinishLoad 委托方法
*   然后做[webView重新加载]；

在此之后，javascript代码被成功执行。但是，该解决方案并不漂亮，并且会导致等待时间延长。

是否有任何解决方案可以确保在渲染之前加载所有引用的文件？

谢谢！克里斯托夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:41:05.733

您必须修复网页，以便在文件实际加载之前它不会尝试运行 javascript。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T15:14:07.843

问题是我让 UIWebViewer 与反向代理交互的方式。在不涉及我的 webviewer 对象的情况下通过代理获取 HTML 代码会导致 JavaScript 加载延迟。但是，通过反向代理授权类进行一​​次测试连接后，我可以使用此方法加载所有后续网页而没有任何问题： [webView loadRequest:request];

感谢大家的想法和反馈！克里斯托夫

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T01:20:01.023

查找`UIWebView`在 iOS 6 中添加的名为`suppressesIncrementalRendering`-- 我认为这将完全符合您的要求。

# c++ - 无法访问 CreateDirectory 创建的目录

> ID：13370513
> 
> 赞同：3
> 
> 时间：2012-11-13T23:13:30.660
> 
> 标签：c++, winapi, createfile

我对以下情况感到困惑。我的应用程序尝试查找指定目录：

```
HANDLE _dh, _fh; // Handles for a files
_dh = CreateFile(_ddn, GENERIC_READ, FILE_SHARE_READ | FILE_SHARE_WRITE, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_DIRECTORY, NULL); 
```

如果目录不存在应用程序创建它：

```
if( _dh == INVALID_HANDLE_VALUE ) {
    if( GetLastError() == ERROR_FILE_NOT_FOUND){
        CreateDirectory( _ddn , NULL ); }
    else { 
        CStringW _err;
        DWORD _ed = GetLastError();
        _err.Format( L" ERROR# %u", _ed );
        MessageBox ( NULL , _err , L"123" , MB_OK );
        PostQuitMessage(0);
        return FALSE; 
    } 
}
CloseHandle(_dh); 
```

这有效，但只是第一次。当目录已经存在`CreateFile`失败并出现错误 #5: ACCESS DENIED 即使应用程序重新启动。

我的错误在哪里？

**更新**

刚刚尝试手动创建目标文件夹 - 同样的问题。

```
CreateFile( _ddn , GENERIC_READ , FILE_SHARE_READ | FILE_SHARE_WRITE , NULL , OPEN_EXISTING , FILE_ATTRIBUTE_DIRECTORY , NULL ); 
```

此调用始终调用`ERROR_ACCESS_DENIED`错误消息（0x5 错误代码）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T23:26:35.510

来自[MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363858%28v=vs.85%29.aspx)：

> 要使用 CreateFile 打开目录，请将 FILE_FLAG_BACKUP_SEMANTICS 标志指定为 dwFlagsAndAttributes 的一部分。

所以改为：

```
_dh = CreateFile( _ddn , GENERIC_READ , FILE_SHARE_READ | FILE_SHARE_WRITE , NULL , OPEN_EXISTING , FILE_FLAG_BACKUP_SEMANTICS , NULL ); 
```

反而。

不要使用`FILE_ATTRIBUTE_DIRECTORY`，它甚至没有记录。

# html - HTML5 Localstorage 在移动应用程序中存储离线数据的可靠性

> ID：13370514
> 
> 赞同：2
> 
> 时间：2012-11-13T23:13:37.147
> 
> 标签：html, sencha-touch-2, local-storage

我正在使用 Sencha Touch 开发一个移动应用程序。我的应用程序需要在设备本身中存储一些数据（来自数据库，采用 JSON 格式），以便应用程序在关闭并重新运行时保留其先前的状态。

HTML 5 localstorage 是最好的解决方案吗？

它的局限性/缺点是什么？

如果我删除浏览器 cookie，我是否也会丢失本地保存的数据？

除了保存在网络浏览器的缓存中，我还有什么选择？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T15:06:27.933

LocalStorage 和 IndexedDB 是一个可行的解决方案。更多浏览器支持 LocalStorage，但仅支持存储名称/值对中的字符串。以下是支持表：

*   [本地存储支持](http://caniuse.com/#feat=namevalue-storage)
*   [索引数据库支持](http://caniuse.com/indexeddb)

另一种选择是 SequelSphere，这是一个 HTML5 关系数据库引擎，它使用 LocalStorage 和 IndexedDB 来存储其数据。它还有一个 Ext JS 4（Sencha 的老大哥）的扩展，还有一个正在开发中的 Sencha 扩展。即使没有扩展，它也可以将您的数据存储在本地，提供 SQL 访问，并将数据放入表单中，以便 Sencha 使用。作为免责声明：我为 SequelSphere 工作。这就是我知道 Sencha 扩展正在开发中的方式。

在可靠性方面，所有形式的客户端数据存储都依赖于最终用户不从浏览器中清除数据。请注意：这通常与清除浏览器的 cookie 不同。

# asp.net-mvc - mvc json请求生命周期

> ID：13370518
> 
> 赞同：0
> 
> 时间：2012-11-13T23:14:06.533
> 
> 标签：asp.net-mvc, json

我对asp.net 和MVC 很陌生。

我试图使用 json 请求并填充一些文本框。

但我注意到当我使用 json 时，我无法访问视图中其他文本框的值。例如

```
string s2 = Request.Form["selectedTestCategory"]; 
```

当我调试时会生成 s2 = null。但是如果我在页面上放了一个提交按钮，则该值不为空。（到目前为止，我知道我只能将一个参数传递给控制器​​中的 JSON 方法）

我的问题是当我开始一个 json 请求时会发生什么？以及为什么我无法从 Request.Form[...]

谢谢，

更新：

这是我的 json

```
<script>
$(document).ready(function() {
    $('select#testStationUniqueId').change(function() {
        var testStation = $(this).val();
        $.ajaxSetup({ cache: false });

        $.ajax({
            url: "TestInput/getTestStationInformation/" + testStation,

            type: 'post',
            success: function(data) {
                $('#driveDetailDiv').empty();
                for (var i = 0; i < data.length; i++) {
                    $.post('TestInput/Details/', { id: data[i] }, function(data2) {
                        $('#driveDetailDiv').append(data2);
                    });
                }
            }
        });
    });
}); 
```

这是在我的控制器中

```
public PartialViewResult Details(string id)
    {
        //DriveDetails t = new DriveDetails(id);
        //return PartialView("DriveDetailsPartial", t);

        test_instance_input_model ti = new test_instance_input_model();
        string s2 = Request.Form["selectedTestCategory"];
        repository.setTestInstanceAttributes(ti, id);

        return PartialView("TestInstancePartial", ti);
    } 
```

s2 在详细信息中为空，但如果我使用提交按钮，它将具有正确的值。

所以我试图弄清楚为什么当我发送一个json请求时它是空的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T03:24:14.547

在您的 JavaScript 中，您不包括 jQuery ajax 请求中的任何数据（请参阅[jQuery ajax](http://api.jquery.com/jQuery.ajax/)）。因此 jQuery 没有添加任何请求参数。您需要包含一个数据对象，jQuery 会将其转换为参数，即数据对象中的属性越多，请求中的参数就越多。

```
$.ajax({
    url: '',
    data: { selectedTestCategory: 'category' },
    dataType: 'post',
    success: function() {}
}); 
```

此外，在您的控制器中，您可以快捷方式访问请求参数。

```
string s2 = Request["selectedTestCategory"]; 
```

# javascript - 如何在单击按钮时使用 Java Script 显示/隐藏 div

> ID：13370521
> 
> 赞同：0
> 
> 时间：2012-11-13T23:14:13.320
> 
> 标签：javascript, onclick, show-hide, forms, buttonclick

我正在尝试编写 PHP Java 脚本，但在这部分编码中难以编写。

我正在尝试在打开的表单中制作一个按钮

到目前为止我写的代码是

```
function display(e){
    if (e.clicked)
        document.getElementById('2').style.display = 'none';
    else
        document.getElementById('2').style.display = 'block'; 
```

表格代码是；

```
 <input type="button" value=" Book Now " onClick="display(this)"/></input> 
```

指出我明显错误的任何帮助都会很棒，可以在 [http://affordablecleaners.co.uk/quote/看到实时代码](http://affordablecleaners.co.uk/quote/)

谢谢，

亨利

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T23:16:01.503

尝试类似于以下内容

```
var i = 0;
var display = function() {
    document.getElementById('2').style.display = (i++ % 2) ? "none" : "block";
}; 
```

本质上，我们正在创建一个变量`i`，并在每次调用该函数时将其加一。如果在调用函数时，`i`是偶数，那么我们将其设置为`display: block`。否则，将其设置为`display: none`。

此解决方案的最大缺点是使全局范围混乱。如果这是一个问题，您还可以执行以下操作。

```
var display = function() {
    document.getElementById('2').style.display = (document.getElementById('2').style.display == "none") ? "block" : "none";
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T23:36:16.730

这是（未经测试的）逻辑......

```
function display(state, which){

if (state==1) {document.getElementById(which).style.display ='none';}

    else

    {document.getElementById(which).style.display = 'block';}
} 
```

然后在你的按钮...

打开

```
onclick="display('1',someDIV)" 
```

把关掉

```
onclick="display('0',someDIV)" 
```

# python - 从稀疏数据帧填充连续的熊猫数据帧

> ID：13370525
> 
> 赞同：17
> 
> 时间：2012-11-13T23:14:28.873
> 
> 标签：python, python-2.7, pandas

我有一个字典名称 date_dict ，由 datetime 日期键控，其值对应于观察的整数计数。我将其转换为带有审查观察的稀疏系列/数据框，我想加入或转换为具有连续日期的系列/数据框。讨厌的列表理解是我绕过熊猫显然不会自动将 datetime 日期对象转换为适当的 DateTime 索引这一事实的技巧。

```
df1 = pd.DataFrame(data=date_dict.values(),
                   index=[datetime.datetime.combine(i, datetime.time()) 
                          for i in date_dict.keys()],
                   columns=['Name'])
df1 = df1.sort(axis=0) 
```

此示例有 1258 个观测值，DateTime 索引从 2003 年 6 月 24 日到 2012 年 11 月 7 日运行。

```
df1.head()
             Name
Date
2003-06-24   2
2003-08-13   1
2003-08-19   2
2003-08-22   1
2003-08-24   5 
```

我可以创建一个带有连续 DateTime 索引的空数据框，但这会引入一个不需要的列并且看起来很笨重。我觉得好像我错过了一个涉及加入的更优雅的解决方案。

```
df2 = pd.DataFrame(data=None,columns=['Empty'],
                   index=pd.DateRange(min(date_dict.keys()),
                                      max(date_dict.keys())))
df3 = df1.join(df2,how='right')
df3.head()
            Name    Empty
2003-06-24   2   NaN
2003-06-25  NaN  NaN
2003-06-26  NaN  NaN
2003-06-27  NaN  NaN
2003-06-30  NaN  NaN 
```

是否有更简单或更优雅的方法从稀疏数据帧填充连续数据帧，以便有（1）连续索引，（2）NaN 为 0，以及（3）没有剩余的空列数据框？

```
 Name
2003-06-24   2
2003-06-25   0
2003-06-26   0
2003-06-27   0
2003-06-30   0 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-11-14T00:10:23.060

您可以使用您的日期范围对时间序列使用重新索引。此外，看起来您最好使用 TimeSeries 而不是 DataFrame（请参阅[文档](http://pandas.pydata.org/pandas-docs/stable/timeseries.html)），尽管重新索引也是将缺失的索引值添加到 DataFrame 的正确方法。

例如，从以下开始：

```
date_index = pd.DatetimeIndex([pd.datetime(2003,6,24), pd.datetime(2003,8,13),
        pd.datetime(2003,8,19), pd.datetime(2003,8,22), pd.datetime(2003,8,24)])

ts = pd.Series([2,1,2,1,5], index=date_index) 
```

为您提供一个时间序列，例如您的示例数据框的头部：

```
2003-06-24    2
2003-08-13    1
2003-08-19    2
2003-08-22    1
2003-08-24    5 
```

简单地做

```
ts.reindex(pd.date_range(min(date_index), max(date_index))) 
```

然后为您提供一个完整的索引，其中您的缺失值带有 NaN（`fillna`如果您想用其他一些值填充缺失值，您可以使用 - 请参见[此处](http://pandas.pydata.org/pandas-docs/stable/missing_data.html#missing-data-fillna)）：

```
2003-06-24     2
2003-06-25   NaN
2003-06-26   NaN
2003-06-27   NaN
2003-06-28   NaN
2003-06-29   NaN
2003-06-30   NaN
2003-07-01   NaN
2003-07-02   NaN
2003-07-03   NaN
2003-07-04   NaN
2003-07-05   NaN
2003-07-06   NaN
2003-07-07   NaN
2003-07-08   NaN
2003-07-09   NaN
2003-07-10   NaN
2003-07-11   NaN
2003-07-12   NaN
2003-07-13   NaN
2003-07-14   NaN
2003-07-15   NaN
2003-07-16   NaN
2003-07-17   NaN
2003-07-18   NaN
2003-07-19   NaN
2003-07-20   NaN
2003-07-21   NaN
2003-07-22   NaN
2003-07-23   NaN
2003-07-24   NaN
2003-07-25   NaN
2003-07-26   NaN
2003-07-27   NaN
2003-07-28   NaN
2003-07-29   NaN
2003-07-30   NaN
2003-07-31   NaN
2003-08-01   NaN
2003-08-02   NaN
2003-08-03   NaN
2003-08-04   NaN
2003-08-05   NaN
2003-08-06   NaN
2003-08-07   NaN
2003-08-08   NaN
2003-08-09   NaN
2003-08-10   NaN
2003-08-11   NaN
2003-08-12   NaN
2003-08-13     1
2003-08-14   NaN
2003-08-15   NaN
2003-08-16   NaN
2003-08-17   NaN
2003-08-18   NaN
2003-08-19     2
2003-08-20   NaN
2003-08-21   NaN
2003-08-22     1
2003-08-23   NaN
2003-08-24     5
Freq: D, Length: 62 
```

# sql - SQL - 选择除一行外相同的行

> ID：13370528
> 
> 赞同：0
> 
> 时间：2012-11-13T23:14:53.213
> 
> 标签：sql

我是 SQL n00b，我似乎无法弄清楚这一点，所以希望得到一些帮助（它非常简单！）。

我有一张从网站上抓取的数据生成的数据表。数据只是随着新信息的到达和旧信息的消失而经常变化，数据抓取每分钟都会运行一次。

列：`TimeStamp, User, RowA, RowB, RowC`

第一列是一个`timestamp`值，如果在那一分钟内网页上没有生成新内容，则其余行通常相同。

我想要做的是弄清楚新数据到达页面和消失之间的时间。

为此，我认为我可以执行一个 select 语句来检查除时间戳值外 ABC 都相同的行，然后比较第一个结果和最后一个结果之间的时间差。

例子：

```
10:00AM, James, Apples, Oranges, Pears
10:01AM, James, Apples, Oranges, Pears
10:02AM, James, Apples, Oranges, Pears 
10:03AM, James, Apples, Watermelon 
```

我想知道的是，该行`James, Apples, Oranges, Pears`从上午 10:00 到上午 10:03 之间存在，并且能够计算出它存在 3 分钟。

非常感谢任何帮助。

**更新**：
为了进一步澄清这一点，这不是一个已知值的查询——它需要查看从查询中收到的值并比较它们是否相同（时间戳除外）——感谢回复的数量，我真的很感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T23:17:48.770

根据 sql 的种类，您可能需要使用日期函数来减去时间戳。如果你去掉 where 子句，你会看到分组。

```
Select
  RowA, -- Calling columns "Row" isn't confusing at all
  RowB,
  RowC,
  Min(timestamp),
  Max(timestamp),
  Max(timestamp) - Min(timestamp)
From
  Scrape
Where
  RowA = 'James' And
  RowB = 'Apples' And 
  RowC = 'Oranges'
Group By
  RowA,
  RowB,
  RowC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T23:20:32.163

您可以计算最大和最小时间的差异：

```
select `user`, rowa, rowb, rowc,
       min(`timestamp`), max(`timestamp`),
       timediff(min(`timestamp`), max(`timestamp`))
from mytable
group by `user`, rowa, rowb, rowc; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T23:21:16.670

据推测，您的数据值可以重复。在您的示例中，James、Apples、Oranges、Pears 可能会在上午 11:00 重新出现，这将是一个新序列。

查询背后的想法是查找每个组的结束时间。这期待下一条数据值不同，时间戳更大的记录。事实上，最小的此类时间戳标识了该组。您实际上可以向后看做类似的事情，但我更喜欢向前看。

在标准 SQL 中执行此操作的方法是使用相关子查询（或非等值连接），如下所示：

```
select user, RowA, RowB, RowC, min(TimeStamp) as StartTimeStamp,
       EndTimeStamp
from (select User, RowA, RowB, RowC, TimeStamp,
             (select Min(timeStamp)
              from t t2
              where t2.TimeStamp > t1.TimeStamp and
                    (t2.user <> t.user or
                     t2.RowA <> t.rowA or
                     t2.RowB <> t.RowB or
                     t2.RowC <> t.RowC
                    )
             ) as EndTimeStampe
      from t
     ) t
group by user, RowA, RowB, RowC, EndTimeStamp 
```

请注意，这假定这些值不是 NULL，因为即使“相等”，NULL 也会自动使比较失败。您可以通过以下两种方式解决此问题：

```
(coalesce(t2.user, '<null>') <> coalesce(t.user, '<null'>) or . . . 
```

或者

```
(t2.user <> t.user and ((t2.user is not null and t.user is null) or (t2.user is null and t.user is not null)) 
```

SQL 的一些方言（如 SQL Server 2012 和 Oracle）提供了更广泛的窗口函数，也可以帮助解决这个问题。

此外，如果您有非常大的表，这将是相当低效的。如果您在（TimeStamp、user、RowA、RowB、RowC）上有一个索引，它会有所帮助。

# c# - 对 Visual Studio 2012 VSIX 扩展进行数字签名

> ID：13370533
> 
> 赞同：3
> 
> 时间：2012-11-13T23:15:05.733
> 
> 标签：c#, visual-studio-2010, visual-studio-2012, digital-signature, vsix

我正在尝试签署一个`Visual Studio 2012 extension`打包为文件的`VSIX`文件。

我已按照[http://www.jeff.wilcox.name/2010/03/vsixcodesigning/](http://www.jeff.wilcox.name/2010/03/vsixcodesigning/)的说明进行操作；但是，我有兴趣在不指定 pfx 文件和密码的情况下执行签名。

例如，如果我要调用“signtool.exe”，我的命令行将是：

```
"signtool.exe" sign /n MySubjectName /t 'http://timestamp.verisign.com/scripts/timstamp.dll' /d "MyDescription" MyPackage.vsix 
```

我了解此命令不适用于`VSIX`文件，但它确实适用于`MSI`存档。

使用此命令，我在调用signtool 时无需指定密码或pfx 文件。使用指定的主题选择最佳安装的证书`MySubjectName`。

按照[Jeff's Blog](http://www.jeff.wilcox.name/2010/03/vsixcodesigning/)上的代码，签名步骤需要定义 pfx 文件名和密码以创建`X509Certificate2`用于签名的文件：

```
 private static void SignAllParts(Package package, string pfx, string password, string timestamp){
  var signatureManager = new PackageDigitalSignatureManager(package);
  signatureManager.CertificateOption = CertificateEmbeddingOption.InSignaturePart;

  /*...*/

  signatureManager.Sign(toSign, new System.Security.Cryptography.X509Certificates.X509Certificate2(pfx, password));
} 
```

是否有任何涉及`PackageDigitalSignatureManager`的 API 可以让我找到一个`X509Certificate`基础，`MySubjectName`以便我可以签署反对？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-03-16T09:25:45.667

我通过遍历当前用户商店中的证书解决了这个问题。我按颁发者名称过滤并仅获取有效证书，然后循环匹配的证书并返回第一个与主题名称匹配的证书：

```
public static X509Certificate2 Find(string issuer, string subject)
{
    var certStore = new X509Store (StoreName.My, StoreLocation.CurrentUser);
    certStore.Open (OpenFlags.ReadOnly);
    var certCollection = certStore.Certificates.Find (X509FindType.FindByIssuerName, issuer, true);

    foreach (var cert in certCollection)
    {
        if (cert.FriendlyName == subject)
        {
            return cert;
        }
    }

    return null;
} 
```

# ajax - ajax滚动位置

> ID：13370540
> 
> 赞同：0
> 
> 时间：2012-11-13T23:15:43.007
> 
> 标签：ajax, scroll-position

我一直在我的网站上实现一段代码，我在 phpacademy.org 教程中发现了该教程是“如何创建类似按钮”。iv 按钮可以正常工作，但我需要额外的功能。问题是当我点击like按钮时页面弹回顶部

```
function like_add(id){
$.post('like_add.php', {id:id}, function(data){
    if(data == 'success'){
        like_get(id);
    } else {
        alert(data);
    }
});
function like_get(id){
$.post('like_get.php', {id:id}, function(data){
    $('#article_'+id+'_likes').text(data);
});
function delete_like(id){
$.post('delete_like.php', {id:id}, function(data){
    if(data == 'success'){
        like_get(id);
    } else {
        alert(data);
    }
});
} 
```

有什么我可以应用到这个脚本来保存滚动位置？？？...我已经将保存滚动位置应用到我网站上的链接，但我不知道这个:(

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:20:23.220

您可以使用以下内容查找当前页面滚动位置。

```
var scrollPosition = $(document).scrollTop(); 
```

这将返回页面的当前滚动位置。

# php - PHP在css文件中搜索样式

> ID：13370541
> 
> 赞同：0
> 
> 时间：2012-11-13T23:15:47.537
> 
> 标签：php, css, regex

> **可能重复：**
> [使用 PHP 解析 CSS 文件](https://stackoverflow.com/questions/3618381/parse-a-css-file-with-php)

我希望能够通过 css 文件搜索找到类或 id 并恢复其样式。

IE..css文件布局

```
body {
margin:0;
padding:0; 
}
span {
margin:0;
padding:0; 
} #input { font:12px arial; }
a { color:#0000FF;
text-decoration:none; 
}
.logout a:hover { text-decoration:underline; } 
```

我想在文件中找到说ID“#input”并将其带回样式。

```
font:12px arial; 
```

或 #input{ 字体：12px arial；}

如果有更多的话，很可能会把它带回来，但要保持这个小样。

我尝试了自己，但没有运气，因为我在正则表达式方面不太好。

```
if(file_exists("css/style.css") && filesize("css/style.css") > 0){
$filesize = filesize("css/style.css");
$handle = fopen("css/style.css", "r");
$contents = fread($handle, $filesize);
fclose($handle);
}
preg_match('@^(?:#input{)?([^}]+)@i', $contents, $matches);
echo "style: {$matches[0]} <br>";
print_r($matches2); 
```

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:35:23.883

您的特定正则表达式失败有几个原因：

```
 @^(?:#input{)?([^}]+)@i 
```

*   标记表示主题的`^`开始。由于您的`#input {`CSS 选择器不在正则表达式的开头，所以这总是会失败。

*   其次，您将其标记为可选`(...)?`。`#input`所以正则表达式无论如何都会忽略寻找。

*   那么你也没有`{`逃脱。

*   并且您的实际 CSS 包含一个空格`#input`，`{`您的正则表达式不考虑该空格。

更正确的是：

```
@(?:#input\s*\{)([^}]+)@i 
```

另请参阅[开源 RegexBuddy 替代品](https://stackoverflow.com/questions/89718/is-there)和[在线正则表达式测试](https://stackoverflow.com/questions/32282/regex-testing)以获取一些有用的工具，或[RegExp.info](http://regular-expressions.info/)获取更好的教程。

# ruby-on-rails - nil:NilClass IN FIREFOX 的未定义方法“user_model”

> ID：13370542
> 
> 赞同：0
> 
> 时间：2012-11-13T23:15:55.227
> 
> 标签：ruby-on-rails, firefox

我在使用 Firefox 时遇到了一个奇怪的问题。我的应用程序在 rspec、Safari 和 Chrome 中运行，但在 Firefox 中异常终止

```
undefined method `user_model' for nil:NilClass 
```

为什么会根据正在呈现的浏览器发生应用程序级错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T23:26:38.657

我的猜测是您的会话 cookie 正在缓存对已在数据库中删除的对象的引用。（现在为 nil，但您正在尝试获取其 user_model。）如果您正在使用您的应用程序，删除您的数据库，然后尝试返回使用您的应用程序，则可能会发生这种情况。

清除 cookie 应该可以解决问题（如果这是问题所在）。

ETA：（您可能只需要删除默认的 rails session cookie，通常命名为 _appname_session。）

# mysql - 将jmeter测试结果导出到mysql数据库

> ID：13370546
> 
> 赞同：-1
> 
> 时间：2012-11-13T23:16:17.473
> 
> 标签：mysql, jmeter

我需要将我保存为 csv 文件的 jmeter 测试结果导出到 mysql 数据库中。
我要导出的列是`response time (t), timestamp (ts), average, throughput, latency, in and max`.

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T23:31:44.860

您可以使用

```
LOAD DATA INFILE 'fred.txt' INTO TABLE my_table; 
```

或者

```
LOAD DATA INFILE fred.csv
INTO table my_table
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n'
(
  response,
  timest,
  avg,
  thru,
  lat,
  in,
  max
)
SET
  response= @var1,
  timest = @var2,
  etc 
```

# java - 在反序列化方法中，如何找到当前正在反序列化的字段（令牌）的父级？

> ID：13370552
> 
> 赞同：1
> 
> 时间：2012-11-13T23:16:45.787
> 
> 标签：java, json, jackson

在`JsonDeserializer#deserialize(JsonParser jp, DeserializationContext ctx)`方法中，如何找到当前正在反序列化的字段（令牌）的父级？

父母，我的意思是当前字段的祖先中最接近的标记类型`START_OBJECT`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T01:04:04.527

你不能；当父反序列化器使用信息时，它不会被传递或维护，以最大限度地减少开销。

# python - 是否可以使用bulkloader 进行增量导出？

> ID：13370554
> 
> 赞同：1
> 
> 时间：2012-11-13T23:17:07.313
> 
> 标签：python, google-app-engine, bulkloader

有没有办法增量使用批量加载器？

我想在一夜之间导出所有 X 类型的实体，然后在一天后导出任何可能已创建的新实体。

（我很有希望，因为批量加载程序会创建进度和结果 sql 文件，这可能是可能的。但我在文档中没有看到它 - 不太希望。）

# widget - Corona SDK 在小部件上分层内容

> ID：13370559
> 
> 赞同：0
> 
> 时间：2012-11-13T23:17:25.287
> 
> 标签：widget, scrollview, layer, coronasdk

我正在使用 Corona 构建带有游戏元素的交互式电子书。我遇到的问题是放置这本书的文本是一个滚动小部件，然后被屏蔽。由于小部件文本覆盖了按钮，因此当前无法按下菜单按钮。我需要能够对按钮进行分层，以便它们位于小部件的“顶部”。请帮忙。

非常感谢，

用户

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T12:59:46.403

显示文本后，执行以下操作：

按钮：前（）；

或者更好的是，将按钮放在一个组中，并将该组（根据需要起诉 toFront() ）放在其他东西的前面。

toFront() 将一个对象带到它自己的组的前面，因此如果按钮与文本在同一组中，它们将跳转到前面。

如果您将多个按钮放在一个组中，toFront() 只会在它们之间对按钮进行排序，那么您需要在组本身中执行 toFront()。

一切都有一个“默认”组（使用 display.getCurrentStage() 找到）

# c# - Sitecore '无法从查询字符串中找到项目'

> ID：13370565
> 
> 赞同：1
> 
> 时间：2012-11-13T23:18:03.750
> 
> 标签：c#, asp.net, content-management-system, sitecore, sitecore6

我有一个网站，我正在尝试使用页面编辑器，并且在大多数情况下它都可以工作，除了某些工作流程状态。我不确定连接是什么，但是只要创建了一个项目，并且它处于草稿模式，就无法对其进行页面编辑-我会看到一个转到站点根目录的屏幕。如果我将工作流状态更改为最终的工作流状态，那么它工作正常。我不确定问题出在哪里，所以我进入了工作流程的“草稿”模式，并选中了“最终状态”复选框，然后页面编辑器开始工作了！我不确定问题出在哪里——我认为是我们已经实施的问题，因为它在全新的 sitecore 解决方案上运行良好。

日志指出：

4860 17:15:15 错误无法从查询字符串中找到项目。[ID 为“{40D668D8-4A60-44D8-B6FC-3FF6CBA0B3CC}”。]

但是该项目显然在那里，并且当切换到任何已检查“最终”的工作流程步骤时，它可以工作..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T17:31:10.497

找到了修复 - 我选择了错误的升级路径，因此 web.config 不正确。为了解决这个问题，我从我拥有的修订版中获取了一份原版 web.config 的副本，并将我的更改合并到其中，从而修复了它。

# file - 无法删除脚本中的文件

> ID：13370569
> 
> 赞同：0
> 
> 时间：2012-11-13T23:18:16.280
> 
> 标签：file, powershell, file-io, delete-file

到这里就想不通了。我有一个脚本，我在其中解析一个充满 tif 的文件夹，并将文件分解为子文件夹，以将每个文件夹的页数限制在 60 左右。如果文档非常大，它会有自己的文件夹。

问题是该进程正在锁定文件，因此无法删除它们。不过，并非每个文件，它们中的大多数都可以正常工作，并且脚本的最后清理部分摆脱了其他所有文件。

我在我的代码中写了很多变通部分来解决这个问题，现在看起来很糟糕

```
 #Large Documents
Get-ChildItem -Path "$directory" -recurse -filter "*.tif" | foreach {
    $file = [System.Drawing.Bitmap]::FromFile($_.Fullname);
    $pagecount = $file.GetFrameCount($file.FrameDimensionsList[0]); 
    if ($pagecount -gt $MaxSize){
        $total = $total + $pagecount;
        $name = $_.Basename;
        New-Item $name -ItemType directory;
        Copy-Item $_.fullname -Destination $name;
        #Copy-Item $name".DS" -Destination $processingDir;
        Write-Host "Sleeping in large doc loop";
        $file.Dispose;
        Write-Host "Dispose file object";
        Write-Host $_.Fullname
        $storename = $_.Fullname
        $largeFiles = $largeFiles + $storename      
        Write-Host "Storing to array: " $largeFiles[$index];
        $index = $index + 1;
        sleep(15);
    }
}
while ($delInd -lt $largeFiles.Count){
    Write-Host "Deleting: " $largeFiles[$delInd];
    Remove-Item $largeFiles[$delInd] -Force;
    $delInd = $delInd + 1;
} 
```

我对此感到非常困惑。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T04:18:49.280

据我了解，`$file.Dispose`不要强制底层对象关闭文件。`Dispose`是一种方法，并且在 PowerShell（如在 C# 中）中，要调用您必须使用的方法`()`。所以试试`$file.Dispose()`。

一条建议：你可以避免`;`在行尾

# python - python/numpy中的优雅网格搜索

> ID：13370570
> 
> 赞同：31
> 
> 时间：2012-11-13T23:18:17.383
> 
> 标签：python, numpy

我有一个有一堆参数的函数。我不想手动设置所有参数，而是执行网格搜索。我有每个参数的可能值列表。对于每个可能的参数组合，我想运行我的函数来报告我的算法在这些参数上的性能。我想将这个结果存储在一个多维矩阵中，这样我就可以找到最大性能的索引，这反过来又会给我最好的参数。下面是现在的代码编写方式：

```
param1_list = [p11, p12, p13,...]
param2_list = [p21, p22, p23,...] # not necessarily the same number of values
...

results_size = (len(param1_list), len(param2_list),...)
results = np.zeros(results_size, dtype = np.float)

for param1_idx in range(len(param1_list)):
  for param2_idx in range(len(param2_list)):
    ...
    param1 = param1_list[param1_idx]
    param2 = param2_list[param2_idx]
    ...
    results[param1_idx, param2_idx, ...] = my_func(param1, param2, ...)

max_index = np.argmax(results) # indices of best parameters! 
```

我想保留第一部分，我按原样定义列表，因为我希望能够轻松地操纵我搜索的值。

我还想按原样得到结果矩阵，因为我将可视化更改不同参数如何影响算法的性能。

不过，中间的那部分是相当重复和庞大的（特别是因为我有很多参数，我可能想添加或删除参数），我觉得应该有一种更简洁/优雅的方式来初始化结果矩阵，遍历所有索引，并设置适当的参数。

那么，有吗？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2015-01-22T15:16:52.163

您可以使用 sklearn 模块中的 ParameterGrid

[http://scikit-learn.org/stable/modules/generated/sklearn.grid_search.ParameterGrid.html](http://scikit-learn.org/stable/modules/generated/sklearn.grid_search.ParameterGrid.html)

例子

```
from sklearn.grid_search import ParameterGrid
param_grid = {'param1': [value1, value2, value3], 'paramN' : [value1, value2, valueM]}

grid = ParameterGrid(param_grid)

for params in grid:
    your_function(params['param1'], params['param2']) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-11-13T23:33:07.030

我想[`scipy.optimize.brute`](http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.brute.html#scipy.optimize.brute)这就是你所追求的。

```
>>> from scipy.optimize import brute
>>> a,f,g,j = brute(my_func,[param1_list,param2_list,...],full_output = True) 
```

请注意，如果`full_output`参数为`True`，则将返回评估网格。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-11-14T01:48:03.940

[John Vinyard](https://stackoverflow.com/a/13370723/577088)和[Sibelius Seraphini](https://stackoverflow.com/a/28092298/577088)的解决方案是很好的内置选项，但如果您正在寻找更大的灵活性，您可以使用广播 + `vectorize`。用于`ix_`生成一组可广播的参数，然后将它们传递给函数的矢量化版本（但请参阅下面的警告）：

```
a, b, c = range(3), range(3), range(3)
def my_func(x, y, z):
    return (x + y + z) / 3.0, x * y * z, max(x, y, z)

grids = numpy.vectorize(my_func)(*numpy.ix_(a, b, c))
mean_grid, product_grid, max_grid = grids 
```

具有以下结果`mean_grid`：

```
array([[[ 0\.        ,  0.33333333,  0.66666667],
        [ 0.33333333,  0.66666667,  1\.        ],
        [ 0.66666667,  1\.        ,  1.33333333]],

       [[ 0.33333333,  0.66666667,  1\.        ],
        [ 0.66666667,  1\.        ,  1.33333333],
        [ 1\.        ,  1.33333333,  1.66666667]],

       [[ 0.66666667,  1\.        ,  1.33333333],
        [ 1\.        ,  1.33333333,  1.66666667],
        [ 1.33333333,  1.66666667,  2\.        ]]]) 
```

`product grid`：

```
array([[[0, 0, 0],
        [0, 0, 0],
        [0, 0, 0]],

       [[0, 0, 0],
        [0, 1, 2],
        [0, 2, 4]],

       [[0, 0, 0],
        [0, 2, 4],
        [0, 4, 8]]]) 
```

和`max grid`：

```
array([[[0, 1, 2],
        [1, 1, 2],
        [2, 2, 2]],

       [[1, 1, 2],
        [1, 1, 2],
        [2, 2, 2]],

       [[2, 2, 2],
        [2, 2, 2],
        [2, 2, 2]]]) 
```

请注意，这可能不是最快的方法。`vectorize`很方便，但是受限于传递给它的函数的速度，python函数很慢。如果您可以重写`my_func`以使用 numpy [ufuncs](http://docs.scipy.org/doc/numpy/reference/ufuncs.html)，如果您愿意，您可以更快地获得网格。像这样的东西：

```
>>> def mean(a, b, c):
...     return (a + b + c) / 3.0
... 
>>> mean(*numpy.ix_(a, b, c))
array([[[ 0\.        ,  0.33333333,  0.66666667],
        [ 0.33333333,  0.66666667,  1\.        ],
        [ 0.66666667,  1\.        ,  1.33333333]],

       [[ 0.33333333,  0.66666667,  1\.        ],
        [ 0.66666667,  1\.        ,  1.33333333],
        [ 1\.        ,  1.33333333,  1.66666667]],

       [[ 0.66666667,  1\.        ,  1.33333333],
        [ 1\.        ,  1.33333333,  1.66666667],
        [ 1.33333333,  1.66666667,  2\.        ]]]) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-22T15:31:15.787

[`meshgrid`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.meshgrid.html#numpy.meshgrid)您可以为此使用 numpy ：

```
import numpy as np

x = range(1, 5)
y = range(10)

xx, yy = np.meshgrid(x, y)
results = my_func(xx, yy) 
```

请注意，您的函数必须能够与`numpy.array`s 一起使用。

# file - htaccess 各种重写需求

> ID：13370573
> 
> 赞同：0
> 
> 时间：2012-11-13T23:18:35.950
> 
> 标签：file, .htaccess, url, rewrite, directory

我有一个网站，比如说[http://myweb.com](http://myweb.com)，我想将它迁移到根目录[http://myweb.com/subfolder/的子文件夹中](http://myweb.com/subfolder/)

我需要以下东西，我想使用 htaccess 文件：

1）将所有非www重定向到www 2）将根目录下的所有文件重定向到子文件夹中的等效文件同时将所有htm扩展名更改为html，即根文件中的文件.htm必须重写为文件在 subfolder/file.html 之类的子文件夹中 3）我希望在地址中仍然显示 www.myweb.com 而不是 www.myweb.com/subfolder

这一切都有可能吗？如何？感谢您的任何回答

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T08:19:18.920

将这些规则添加到文档根目录中的 htaccess：

```
RewriteEngine On

# 1) Redirect all non-www to www
RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteCond %{HTTP_HOST} !^$
RewriteRule ^(.*)$ http://www.%{HTTP_HOST}/$1 [L,R=301]

# 2) Redirect all files in the root to equivalent files in the subfolder
#    at the same time changing all htm extension to html
RewriteCond %{REQUEST_URI} !^/subfolder/
RewriteRule ^(.*)\.htm$ /subfolder/$1.html [L]
RewriteCond %{REQUEST_URI} !^/subfolder/
RewriteRule ^(.*)$ /subfolder/$1 [L] 
```

最后一条规则没有`R`标志，因此它们不会导致外部重定向（从而更改浏览器 URL 地址栏中的内容）。

# html - 启用 GPS 后禁用它

> ID：13370577
> 
> 赞同：0
> 
> 时间：2012-11-13T23:18:52.070
> 
> 标签：html, gps

我有这个代码来启用设备上的 GPS。

```
if(navigator.geolocation) {
navigator.geolocation.getCurrentPosition(
    displayPosition,
    displayError,
    { enableHighAccuracy: true, maximumAge: 0 }
);
} else {
alert('Geolocation is not supported by this browser');
}

function displayPosition(position) {
var dc_latlong = new google.maps.LatLng(position.coords.latitude.toFixed(6), position.coords.longitude.toFixed(6));
var gps_accuracy = position.coords.accuracy;

var dc_options = {
    minZoom: 4,
    maxZoom: 20,
    center: dc_latlong,
    mapTypeId: google.maps.MapTypeId.ROADMAP,
    streetViewControl: false
}

var dc_map = new google.maps.Map(document.getElementById('google-maps-distance'), dc_options);

var dc_marker = new google.maps.Marker({
    position: dc_latlong,
    draggable: false,
    map: dc_map
});

var dc_circle = new google.maps.Circle({
    center: dc_latlong,
    radius: gps_accuracy,
    map: dc_map,
    fillColor: '#3333ff',
    fillOpacity: 0.2,
    strokeColor: '#3333ff',
    strokeOpacity: 0.5,
    strokeWeight: 1
});

google.maps.event.trigger(dc_map, 'resize');
dc_map.fitBounds(dc_circle.getBounds());

$('#gps-information').show();
$('#gps-accuracy').html(number_format(gps_accuracy) + ' meters');
}

function displayError(error) {
var errors = { 
    1: 'Permission denied',
    2: 'Position unavailable',
    3: 'Request timeout'
};

alert('Error: ' + errors[error.code]);
} 
```

我现在想知道如何禁用设备上的 GPS，这样网站就不会一直获取访问者的位置？

提前致谢。

# c++ - 为什么 CWnd::CreateEx 无法创建我的窗口？

> ID：13370578
> 
> 赞同：1
> 
> 时间：2012-11-13T23:18:56.110
> 
> 标签：c++, mfc, visual-studio-2010, cwnd

我正在处理我们的 32 位 MFC VC2010 应用程序中发生的零星生产问题。该应用程序在 Windows Server 2008 R2 Standard SP1 64 位上运行。

该问题是由未能创建 CWnd 派生类引起的。发生故障时，AfxUnhookWindowCreate 方法在 CWnd::CreateEx 内返回 false。这是因为 pThreadState->m_pWndInit 变量不为 NULL。看起来 _AfxCbtFilterHook 应该在 HCBT_CREATEWND 被挂钩时将其设置为 NULL，但似乎这没有发生。我已经注销了 CREATESTRUCT 并将其与发生故障的时间与不发生故障的时间进行了比较，并且参数基本相同。

是否有人对可能导致此问题的原因或我如何确定原因有任何想法？谢谢！

```
BOOL CWnd::CreateEx(DWORD dwExStyle, LPCTSTR lpszClassName,
LPCTSTR lpszWindowName, DWORD dwStyle,
int x, int y, int nWidth, int nHeight,
HWND hWndParent, HMENU nIDorHMenu, LPVOID lpParam)
{
...
if (!PreCreateWindow(cs))
{
    PostNcDestroy();
    return FALSE;
}

AfxHookWindowCreate(this);
HWND hWnd = ::AfxCtxCreateWindowEx(cs.dwExStyle, cs.lpszClass,
        cs.lpszName, cs.style, cs.x, cs.y, cs.cx, cs.cy,
        cs.hwndParent, cs.hMenu, cs.hInstance, cs.lpCreateParams);
...
if (!AfxUnhookWindowCreate())
    PostNcDestroy();        // cleanup if CreateWindowEx fails too soon
...

BOOL AFXAPI AfxUnhookWindowCreate()
{
_AFX_THREAD_STATE* pThreadState = _afxThreadState.GetData();
  #ifndef _AFXDLL
if (afxContextIsDLL && pThreadState->m_hHookOldCbtFilter != NULL)
{
    ::UnhookWindowsHookEx(pThreadState->m_hHookOldCbtFilter);
    pThreadState->m_hHookOldCbtFilter = NULL;
}
  #endif
if (pThreadState->m_pWndInit != NULL)
{
    pThreadState->m_pWndInit = NULL;
    return FALSE;   // was not successfully hooked
}
return TRUE;
}

LRESULT CALLBACK
_AfxCbtFilterHook(int code, WPARAM wParam, LPARAM lParam)
{
_AFX_THREAD_STATE* pThreadState = _afxThreadState.GetData();
if (code != HCBT_CREATEWND)
{
    // wait for HCBT_CREATEWND just pass others on...
    return CallNextHookEx(pThreadState->m_hHookOldCbtFilter, code,
        wParam, lParam);
}

 ...
        pThreadState->m_pWndInit = NULL; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:32:39.980

我将问题追溯到此时不应该执行的窗口过程挂钩。

# javascript - 如何在 JS 中编辑 html 节点的子节点？

> ID：13370583
> 
> 赞同：0
> 
> 时间：2012-11-13T23:19:21.460
> 
> 标签：javascript, jquery

不知道如何表达这个问题，但我需要修改 node 的子节点：

```
<a id="page_number">1 / 1</a> 
```

我正在使用 JS 和 JQuery。到目前为止，我得到这样的节点：

```
$("#page_number")[0] 
```

我可以不用方括号（getElementById？）就可以得到这个。那么如何修改值'1 / 1'？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:20:32.233

```
$("#page_number").html("this is the new content"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T23:28:59.510

`$("#page_number")[0]`正在为您提供从 jQuery 对象返回的原始 dom 节点（相当于`$("#page_number").get(0)`- 请注意，如果您使用 jQuery，我在选择器中添加了您需要的“#”。

所以你有两个选择：

**原始 DOM**

```
//get
var myvar = document.getElementById("page_number").innerHTML;
//set
document.getElementById("page_number").innerHTML = "New Content"; 
```

**jQuery**

```
//get
$("#page_number").html();
//set
$("#page_number").html("New content"); 
```

# jquery - jQuery“自动完成”不起作用

> ID：13370588
> 
> 赞同：0
> 
> 时间：2012-11-13T23:19:50.007
> 
> 标签：jquery, jquery-ui, jsf-2, autocomplete

JQuery 自动完成代码似乎正确，但不起作用。

代码看起来很简单，我没有看到任何使用 IE8 中的“开发者工具”或 FireFox 中的“firebug”工具的 javascript 错误...

但是，当在输入字段中输入字母（例如，“a”）时，列表框中没有任何内容“下拉”...

如果您发现有什么不对劲，请告诉我。在这一点上，我显然不是“只见树木不见森林”。

**这是JSF“复合组件”定义中的片段......**

 `````
 <!-- INTERFACE -->
<cc:interface>
    <cc:attribute name="idpref" required="true"/>
    <cc:attribute name="items" required="true"/>
</cc:interface>

<!-- IMPLEMENTATION -->
<cc:implementation>

    <!-- here is the input field -->
    <h:inputText type="text" id="#{cc.attrs.idpref}"/>

    <!-- here is the javascript -->
    <h:outputScript     library="js"        name="jquery-1.7.2.js" />
    <h:outputScript     library="js"        name="jquery-ui-1.8.21.custom.js" />
    <script type="text/javascript" >
        var jq = jQuery.noConflict();
        jq(document).ready(function()
        {
            jq(function()
            {
                var list = #{cc.attrs.items};
                var id = "#{cc.attrs.idpref}";
                var prependedid = jq('input[id$="' + id + '"]').attr("id");
                var comboid = "#" + prependedid;

                jq(comboid).autocomplete({
                    source: list
                });
            });

        });
    </script>
</cc:implementation> 
````  `**这是使用上述复合组件的页面中的视图标记内容片段...**

```
<!DOCTYPE html PUBLIC
"-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:util="http://java.sun.com/jsf/composite/util"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
    <f:view contentType="text/html">
        <h:head>
            <title>testx</title>
            <meta charset="utf-8" />
        </h:head>
        <h:body prependid="false">
            <h:form id="form1" prependId="false">
                <util:autoComplete prependId="false"
                                   idpref="aaa"
                                   items="#{refDataController.data}" />
            </h:form>
        </h:body>
    </f:view>
</html> 
```

**这是后端Java片段...**

```
 package aaa.bbb.ccc.war;

    import java.util.Arrays;
    import java.util.List;
    import org.springframework.context.annotation.Scope;
    import org.springframework.stereotype.Component;

    @Component("refDataController")
    @Scope("request")
        public class RefDataController
        {
            public RefDataController()
            {
            }
            private List data = Arrays.asList    ("\"Aman\"", "\"Albela\"", "\"Ali\"", "\"Ankit\"", "\"Azam\"", "\"Aryan\"");
            public List getData()
            {
                return data;
            }
        } 
```

感谢您的任何帮助！

sd

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T23:25:02.773

是否调用了该代码？这段代码似乎有点多余。我怀疑传递给内部的函数`jq`是否被调用过。如果确实不是，则永远不会初始化自动完成功能。您可以通过添加断点来验证，或者只是在调用之前和之后放置一个警报`jq(comboid).autocomplete`如果您收到两个警报，那么该行也将被执行（可能是错误的元素）。

```
jq(document).ready(function()
{
   jq(function()
   .... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T16:27:36.967

**似乎有两个问题的组合（即，作为一个 jquery newby）......**

**问题#1**。有点令人尴尬的疏忽（ala，“*你的电脑插上了吗？* ”）...我将自动完成功能的“minLength”参数值设置为 3，并且没有输入至少 3 个字符，所以最初测试时没有显示列表（我删除了这个参数，现在使用默认的最小长度 1）

**问题#2**。然而，主要问题是我不理解 jquery 选择器与 JSF 冒号 (":") 字符的问题。我通过使用两种解决方法之一解决了这个问题（在谷歌搜索信息等之后）：

（注意：在这些片段中，“ ***#{cc.attrs.idpref}*** ”是用于指定元素 ID 的 JSF“***复合组件***”属性... FWIW，在这种情况下，该值恰好是“ ***aaa*** ”）

***解决方法#1***：

```
//get the full id value of the element whose "id ends with" aaa...
var id = jq('input[id$="' + "#{cc.attrs.idpref}" + '"]').attr("id");
//"escape" the colon character so that jquery will not be confused...
id = id.replace(/:/g,"\\:");
//used escaped id value in the selector...
jq("input#" + id).autocomplete({
   source: list
}); 
```

***解决方法#2***：

```
//start with the **unprepended** id value specified in the composite component  attribute...
var id = "#{cc.attrs.idpref}";
// use the "id ends with" aaa selector with the autocomplete function... 
jq('input[id$="' + "#{cc.attrs.idpref}" + '"]').autocomplete({
   source: list
}); 
```

感谢大家的集体回复！

sd``

# c# - 如何在 Silverlight 中验证 UI？

> ID：13370590
> 
> 赞同：1
> 
> 时间：2012-11-13T23:20:07.847
> 
> 标签：c#, silverlight, validation, mvvm, silverlight-5.0

我的用户界面很简单。在 Silverlight 5.0 应用程序中，我使用 MVVM，我让用户添加许多文本框，因为他想在 a`ObservableCollection<Model>`和 a中添加`Button`。

`Model`只有一个属性，它的数据类型是`integer`.

该模型的数据模板只是一个简单的文本框。

```
<TextBox Text="{Binding Number}" /> 
```

所以想法是，当所有文本框都没有任何错误时，启用该命令，但如果任何模型有错误，则应禁用该命令。

如何实施此验证？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T06:03:28.610

您可以简单地在适当的属性设置器中抛出异常：

```
public int Number
{
    get {//...}
    set {
           if(value >= 10)
             throw new Exception("Number should be less than 10");
           _number = number;
        }

} 
```

你的绑定应该是：

```
<TextBox Text="{Binding Number, Mode="TwoWay" ValidateOnExceptions="True"}" /> 
```

FrameworkElement 具有[BindingValidationErrorEvent](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.bindingvalidationerror%28v=vs.95%29.aspx)，可用于实现启用/禁用命令逻辑。请记住为您的绑定设置`NotifyOnValidationError`为。`True`

ps另外，我建议您阅读有关[INotifyDataErrorInfo](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifydataerrorinfo%28v=vs.95%29.aspx)

# jquery - 延迟鼠标事件的悬停

> ID：13370592
> 
> 赞同：1
> 
> 时间：2012-11-13T23:20:12.863
> 
> 标签：jquery, hover

我有一个带有一些文本的 DIV，当用户将鼠标悬停在文本上时，我希望一些链接出现在该 div 下彼此相邻。但是，在我的 Div 带有文本的鼠标移出时，我不希望链接立即消失。现在我已经阅读了一些关于 CSS 延迟的内容，但 IE 似乎不支持这一点。我还准备了一些关于 HoverIntent 的东西，但在 Jquery 方面我并不是一个真正的天才。任何可以帮助我或开始认识的人？我的 HTML：

```
 <div id="text"><a href="" class="hoverlink">My text</a></div>

 <a href="">Link1</a>
 <a href="">Link2</a> 
```

我希望这两个链接出现在“我的文字”上悬停并在 mousout 上消失，但有延迟？帮助？！

非常感谢！桑德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T00:01:16.080

随着一些变化

**HTML**

```
<div><a href="" class="hoverlink">My text 1</a></div>
<div class="links">
    <a href="">Link-1</a>
    <a href="">Link-2</a>
</div> 
```

**JS**

```
​$(function(){
    var timeOut=0;
    $('.hoverlink').on({
        'mouseenter':function(){
            $(this).parent().next('.links').show();
        },
        'mouseleave':function(){
            var next=$(this).parent().next('.links');
            timeOut=setTimeout(function(){
                next.hide();
            }, 1000);
        },
    });

    $('.links').on({
        'mouseenter':function(){
            clearTimeout(timeOut);
        },
        'mouseleave':function(){
            $(this).hide();
        }
    });
});​ 
```

[**演示**](http://jsfiddle.net/Vm7FT/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T23:45:53.990

我会让你开始：

1.  [jQuery 入门](http://docs.jquery.com/How_jQuery_Works)
2.  [jQuery 选择器](http://api.jquery.com/category/selectors/)
3.  [jQuery 事件](http://api.jquery.com/category/events/)
4.  [jQuery 切换](http://api.jquery.com/toggle/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T23:48:47.217

我找到了一个很棒的教程，它实际上解释了我想要什么：

[http://www.thatsquality.com/articles/creating-delayed-drop-down-menus-in-jquery-without-losing-accessibility](http://www.thatsquality.com/articles/creating-delayed-drop-down-menus-in-jquery-without-losing-accessibility)

问题可以关闭！谢谢，桑德

# php - 在php中迭代多级数组时如何获取导致给定值的所有键

> ID：13370595
> 
> 赞同：1
> 
> 时间：2012-11-13T23:20:27.837
> 
> 标签：php, arrays, multidimensional-array

例子：

```
$arr = array(array("name"=>"Bob","species"=>"human","children"=>array(array("name"=>"Alice","age"=>10),array("name"=>"Jane","age"=>13)),array("name"=>"Sparky","species"=>"dog")));
print_r($arr);

array_walk_recursive($arr, function($v,$k) {
    echo "key: $k\n";
}); 
```

这里的问题是我只得到最后一个键，但我无法参考我所在的位置，即存储一个特定的键并在我离开函数后更改值或在另一个相同的数组中更改相同的放置值。

我必须得到的不是字符串，而是一个数组，它的所有键都会导致给定值，例如`[0,"children",1,"age"]`.

编辑：这个数组只是例子。我问过是否有通用的方法可以在 PHP 中迭代嵌套数组并获得完整的位置路径，而不仅仅是最后一个键。而且我知道有一种方法可以通过创建反映数组结构的嵌套循环来做到这一点。但我再说一遍：我事先并不知道数组结构。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T10:34:05.273

要解决您的问题，您将需要递归。下面的代码会做你想做的事，如果它们存在，它也会找到多个路径：

```
$arr = array(
    array(
        "name"=>"Bob",
        "species"=>"human",
        "children"=>array(
            array(
                "name"=>"Alice",
                "age"=>10
            ),
            array(
                "name"=>"Jane",
                "age"=>13
            )
        ),
        array(
            "name"=>"Sparky",
            "species"=>"dog"
        )
    )
);

function getPaths($array, $search, &$paths, $currentPath = array()) {
    foreach ($array as $key => $value) {
        if (is_array($value)) {
            $currentPath[] = $key;
            if (true !== getPaths($value, $search, $paths, $currentPath)) {
                array_pop($currentPath);
            }
        } else {
            if ($search == $value) {
                $currentPath[] = $key;
                $paths[] = $currentPath;
                return true;
            }
        }
    }
}

$paths = array();
getPaths($arr, 13, $paths);
print_r($paths); 
```

# javascript - chrome.extension.onMessage.addListener 并不总是收到消息

> ID：13370600
> 
> 赞同：2
> 
> 时间：2012-11-13T23:20:39.867
> 
> 标签：javascript, google-chrome

我正在尝试将节点 ID 从从弹出页面运行的脚本发送到从标签页运行的脚本。有时有效，有时无效；我还没有找到任何押韵或理由来解释它为什么这样做或不这样做。

这是我发送消息的弹出代码：

```
$(".node-list-item").click( function()
        {
            nodeid = $(this).attr("nid");
            chrome.tabs.create({ url: "tab.html"}, function(tab)
            {
                console.log("Sending nid: " + nodeid);
                chrome.tabs.sendMessage(tab.id, { nid: nodeid});
            });
        }); 
```

这是接收它的代码：

```
chrome.extension.onMessage.addListener(function(message, sender, response)
        {
            console.log(message);
            add_notice("Received node: " + message.nid);
            show_node(message.nid);
        }); 
```

为什么这有时会起作用，但不是一直起作用？我确实知道发送函数总是发送一个值，或者至少 console.log 函数正在运行。

# ios - 为什么 UIKit 代表是“分配”而不是“弱”？

> ID：13370601
> 
> 赞同：6
> 
> 时间：2012-11-13T23:20:40.747
> 
> 标签：ios, xcode, cocoa, uikit

正如标题所述，为什么`UIKit`代表`(assign)`而不是`(weak)`？

参见`UIPopovercontroller.h`例如：

`@property (nonatomic, assign) id <UIPopoverControllerDelegate> delegate;`

据我所知，这对弱保留属性没有任何好处，但代表需要管理自己作为代表的生命周期存在很多问题。这是向后兼容性问题吗？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-13T23:27:16.057

因为大多数这些属性在 iOS SDK 支持弱属性之前就已经存在。该`weak`属性仅在 iOS 5.0 及更高版本上受支持。

我不得不猜测，一旦 iOS 4.x 及更早版本成为历史，它们都将更新为`weak`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-04T17:33:56.993

UIKit 仍然是在没有 ARC 的情况下构建的，因此没有一个 UIKit 类可以使用弱引用。出于这个原因，甚至像 UICollectionView 这样较新的类也将 assign 用于其委托属性。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-11-13T23:26:49.357

永远不应保留代表。这是保持循环的简单途径。

# jquery - 如果选中元素，则添加类，但在加载时不单击

> ID：13370605
> 
> 赞同：1
> 
> 时间：2012-11-13T23:21:05.083
> 
> 标签：jquery, find, parent, checked

所以我有这个html代码：

```
<div class="panel-radioimage">
<div class="radio-image-wrapper">
<label for="1"><img src="http://127.0.0.1/wordpress/wp-content/themes/bluestudio5/images/patterns/1.png" alt="image" class="admin-patterns">
<div class="check-list"></div></label>
<input class="farm_img_pattern" type="radio" name="farm_img_pattern" value="1.png" checked>
</div> 
```

我页面上的这些元素很少，我想在页面加载时检查输入时将类“checked-list”添加到类“check-list”中。所以我尝试了这个在点击事件之前有效的方法：

```
 if(jQuery('.farm_img_pattern').is(':checked')){
        jQuery(this).parent().find(".check-list").addClass("checked-list");
    } 
```

但它不工作。问题出在“这个”上有人知道在页面加载时获取检查元素的解决方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T23:28:15.967

我想你想要更像这样的东西：

```
jQuery('.farm_img_pattern').filter(':checked').each(function(index) {
    jQuery(this).parent().find(".check-list").addClass("checked-list");
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T23:31:43.097

在`click`事件中，`this`将被单击的元素。只需使用元素的选择器：

```
if(jQuery('.farm_img_pattern').is(':checked')){
  jQuery('.farm_img_pattern').parent().find(".check-list").addClass("checked-list");
} 
```

# java - 从数组列表中删除具有给定字符的元素

> ID：13370606
> 
> 赞同：-1
> 
> 时间：2012-11-13T23:21:06.663
> 
> 标签：java, arraylist

我一直在寻找一种方法来搜索数组列表元素中的给定字符。但是我找不到任何东西。你能帮帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T23:24:09.137

也许是一个for循环？还是增强的 for : each 循环？或者也许是一个迭代器？

我最喜欢使用 for 循环：

```
for(int i = 0; i < arraylist.size(); i++)
{
    if(arraylist.get(i).equals(your item here))
        do something
    else
        do something else
} 
```

此外，您确定要查找字符或字符串吗？怎么可能有一个字符数组列表？请发布 arraylist 声明代码。

[编辑]：

由于我们正在字符串数组列表中查找字符，因此这是新代码：

```
for(int i = 0; i < arraylist.size(); i++)
    {
        if(arraylist.get(i).indexOf(character) > -1)
            do something
        else
            do something else
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T23:27:04.077

尝试这个：

```
ArrayList<String> listCopy = yourList.clone();
Iterator<String> it = listCopy.iterator();
while(it.hasNext()){
    String element = it.next();
    if(element.contains(Character.toString(yourChar)){
        yourList.remove(element);
    }
} 
```

# java - 检测对 RequestDispatcher.include() 的调用

> ID：13370607
> 
> 赞同：1
> 
> 时间：2012-11-13T23:21:09.497
> 
> 标签：java, servlets, servlet-filters, jspinclude

我正在编写一个 Servlet-Filter，它包装响应并分析对包装响应的 addHeader() 的调用。在将响应提交给客户端之前，它会在适当的情况下使用一些有用的标头（缓存、压缩等）来装饰它。

当在包装的响应上调用 ServletResponse.flushBuffer() 或达到缓冲区大小时，此装饰就完成了。但是，如果包装的 Servlet（或 JSP-Page）此时正在处理包含，则不能将标头添加到响应中，因为禁止包含这样做。

因此，我需要检测包含，以便我能够在包含资源之前装饰响应。

我能想到的唯一方法是包装请求，捕获对 ServletRequest.getRequestDispatcher() 的调用并返回一个包装好的 RequestDispatcher 实例，它会在调用 include 方法时通知我。但是从 Servlet 3.0 开始，还有 ServletContext.getRequestDispatcher() 和 ServletContext.getNamedDispatcher() 方法。我无法捕捉到这些方法，因为我的过滤器无法包装 ServletContext。

还有其他方法可以检测对 RequestDispatcher.include() 的调用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:43:38.117

添加

```
<dispatcher>INCLUDE</dispatcher> 
```

过滤映射似乎工作[参考](https://stackoverflow.com/questions/6330651/can-jspinclude-pages-pass-through-filters)

# opengl - 如何从 openGL 应用程序的深处引用“全局”变量和对象？

> ID：13370610
> 
> 赞同：0
> 
> 时间：2012-11-13T23:21:14.363
> 
> 标签：opengl, static, size, viewport, dimensions

我正在编写一个面向对象的 openGL 应用程序，它呈现一些 3D 模型（这些模型存储在我自己的类中，具有多个属性和方法）。其中一种对象类型（使用体积渲染着色器）要求我首先将输出渲染为固定大小的纹理（例如 256*256），然后恢复之前的视口大小并在屏幕上以 2D 形式拉伸此纹理。

实际的问题是我无法从这个对象内部获得实际的视口大小，除非（我猜）我存储了对 GLEventListener 的 GLU 对象的引用，我显然不希望我创建的每个模型都使用它。

但我也不想在 GLEventListener 中有静态变量（如果我想要一个有 2 个画布的应用程序怎么办？）

最重要的是视口尺寸，但我认为我还需要引用我的自定义 Camera 对象。我怎样才能做到这一点而不以某种方式使用*静态*？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:29:10.400

首先，请阅读[http://www.opengl.org/wiki/Common_Mistakes#The_Object_Oriented_Language_Problem](http://www.opengl.org/wiki/Common_Mistakes#The_Object_Oriented_Language_Problem)

接下来，我将指向[`glGetIntegerv`](http://www.opengl.org/sdk/docs/man/xhtml/glGet.xml)标记 GL_VIEWPORT 上的函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T23:33:24.087

我会将视口信息和任何其他不会更改每个画布（等）的数据存储在单个结构中，然后只为每个对象存储一个指针

# android - 从 Uri 打开图像，调整大小并返回 Base64

> ID：13370613
> 
> 赞同：1
> 
> 时间：2012-11-13T23:21:40.277
> 
> 标签：android, image, resize, base64, uri

我正在尝试从特定 uri 打开图像，检查该图像是否太大而无法调整大小，并将其返回为 Base64。我的问题是我必须调整图像大小的代码从不调整图像大小（从不表示图像太大）。我寻找其他类似的问题，但我没有得到任何答案。我不知道为什么这两个代码行中的值总是-1：

```
 final int height = options.outHeight; // Always -1 WHY?
    final int width = options.outWidth; // Always -1 WHY? 
```

我附上我的代码：

```
private class WriteImage extends AsyncTask<Object, Void, String>{
            private static Bitmap decodeSampledBitmapFromStream(InputStream is,
                                                    int reqWidth,
                                                    int reqHeight) {

    // First decode with inJustDecodeBounds=true to check dimensions
    final BitmapFactory.Options options = new BitmapFactory.Options();
    options.inJustDecodeBounds = true;
    InputStream aux = inputStreamCopy(is);
    BitmapFactory.decodeStream(is, null, options);  // SkImageDecoder::Factory returned null
    try {
        is.close();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    // Calculate inSampleSize
    options.inSampleSize = calculateInSampleSize(options, reqWidth, reqHeight);

    // Decode bitmap with inSampleSize set
    options.inJustDecodeBounds = false;
    return BitmapFactory.decodeStream(aux, null, options);
}

private static InputStream inputStreamCopy(InputStream is) {
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    int len;
    byte[] buffer = new byte[1024];

    try {
        while ((len = is.read(buffer)) > -1) baos.write(buffer, 0, len);
    } catch (IOException e) {
        e.printStackTrace();
    }
    return new ByteArrayInputStream(baos.toByteArray());
}

private static int calculateInSampleSize(
        BitmapFactory.Options options, int reqWidth, int reqHeight) {
    // Raw height and width of image
    final int height = options.outHeight; // Always -1 WHY?
    final int width = options.outWidth; // Always -1 WHY?
    int inSampleSize = 1;

    if (height > reqHeight || width > reqWidth) {
        if (width > height)
            inSampleSize = Math.round((float)height / (float)reqHeight);
        else
            inSampleSize = Math.round((float)width / (float)reqWidth);

        // This offers some additional logic in case the image has a strange
        // aspect ratio. For example, a panorama may have a much larger
        // width than height. In these cases the total pixels might still
        // end up being too large to fit comfortably in memory, so we should
        // be more aggressive with sample down the image (=larger
        // inSampleSize).
        final float totalPixels = width * height;

        // Anything more than 2x the requested pixels we'll sample down
        // further.
        final float totalReqPixelsCap = reqWidth * reqHeight * 2;

        while (totalPixels / (inSampleSize * inSampleSize) > totalReqPixelsCap)
            inSampleSize++;
    }
    for (int i=5; i>0; i--){
        if (Math.pow(2, i)<=inSampleSize){
            inSampleSize = (int) Math.pow(2, i);
            break;
        }
    }
    return inSampleSize;
}

    @Override
    protected void onPreExecute(){  
    }

    @Override
    protected void onProgressUpdate(Void... values){
    }

    @Override
    protected String doInBackground(Object... params) {
        try {
            InputStream is = ((android.app.Activity) params[1]).getContentResolver().openInputStream((Uri) params[0]);

            Bitmap bitmap = decodeSampledBitmapFromStream(is, 300, 300);
            int bytes = bitmap.getWidth()*bitmap.getHeight()*4;
            ByteBuffer buffer = ByteBuffer.allocate(bytes);
            bitmap.copyPixelsToBuffer(buffer);
            return Base64.encodeToString(buffer.array(), Base64.DEFAULT);
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return null;
    }

    @Override
    protected void onPostExecute(String result){
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T22:02:39.887

解决方案是这样的！替换以下内容：

在**decodeSampledBitmapFromStream**函数中：

```
 private Bitmap decodeSampledBitmapFromStream(InputStream is,
                                                    int reqWidth,
                                                    int reqHeight) {

    // First decode with inJustDecodeBounds=true to check dimensions
    final BitmapFactory.Options options = new BitmapFactory.Options();
    options.inJustDecodeBounds = true;

    InputStream aux = inputStreamCopy(is);
    BitmapFactory.decodeStream(aux, null, options);  // SkImageDecoder::Factory returned null
    try {
        aux.reset();
    } catch (IOException e) {
        e.printStackTrace();
    }

    // Calculate inSampleSize
    options.inSampleSize = calculateInSampleSize(options, reqWidth, reqHeight);

    // Decode bitmap with inSampleSize set
    options.inJustDecodeBounds = false;
    return BitmapFactory.decodeStream(aux, null, options);
} 
```

在**doInBackground**方法中：

```
 @Override
    protected String doInBackground(Object... params) {
        try {
            InputStream is = ((android.app.Activity) params[1]).getContentResolver().openInputStream((Uri) params[0]);
            Bitmap bitmap = decodeSampledBitmapFromStream(is, 300, 300);
            System.gc();
            int bytes = bitmap.getWidth()*bitmap.getHeight()*2;
            ByteBuffer buffer = ByteBuffer.allocate(bytes);
            bitmap.copyPixelsToBuffer(buffer);
            return Base64.encodeToString(buffer.array(), Base64.DEFAULT);
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return null;
    } 
```

:)

# php - 如何从 Magento 删除意外创建的货件？

> ID：13370617
> 
> 赞同：3
> 
> 时间：2012-11-13T23:22:12.430
> 
> 标签：php, mysql, magento

如何删除意外创建的货件？我知道没有办法通过管理员来完成，但我正在尝试弄清楚我需要做些什么才能将订单连同所有旧的发货信息一起恢复到“处理中”状态，以便可以发货晚些时候。我希望这可以通过 PHP 以编程方式完成，甚至直接在 MySQL 中完成。

仅供参考，我使用的是 Magento 1.1.8 版。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-08-15T16:27:43.137

尝试

```
require_once  'app/Mage.php';

Varien_Profiler::enable();
Mage::setIsDeveloperMode(true);
ini_set('display_errors', 1);
umask(0);
Mage::app('default');
Mage::register('isSecureArea', 1);

//Update Order id
$orderId = xyz;

$order = Mage::getModel('sales/order')->load($orderId);

// check if has shipments
if(!$order->hasShipments()){
    die('No Shipments');
}

//delete shipment
$shipments = $order->getShipmentsCollection();
foreach ($shipments as $shipment){
    $shipment->delete();
}

// Reset item shipment qty
// see Mage_Sales_Model_Order_Item::getSimpleQtyToShip()
$items = $order->getAllVisibleItems();
foreach($items as $i){
   $i->setQtyShipped(0);
   $i->save();
}

//Reset order state
$order->setState(Mage_Sales_Model_Order::STATE_PROCESSING, true, 'Undo Shipment');
$order->save();

echo 'Done'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T04:37:12.287

```
$shipment = Mage::getModel('sales/order_shipment')->load($shippingOrderId);
$shipment->delete(); 
```

我认为这可行。我没试过。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T15:18:49.693

我最终购买了下面的扩展，它做得很好。尽管它没有说它支持 1.3 之前的版本，但它在我的 v1.1.8 设置上完美运行。

[http://www.magentocommerce.com/magento-connect/delete-shipment-6498.html](http://www.magentocommerce.com/magento-connect/delete-shipment-6498.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-28T16:00:11.803

假设您已将订单全部发货，但并非有意。只需删除 INVOICE。它将删除发票和任何货物......SHIPMENTS 复数！

因此，您必须小心，如果您有其他货物，则需要重新创建它们。然后重新开具发票。然后就像您从未运送过任何东西一样，然后您可以运送您最初需要的任何数量。

# javascript - 我做错了什么？

> ID：13370628
> 
> 赞同：0
> 
> 时间：2012-11-13T23:23:26.140
> 
> 标签：javascript, cookies

我正在使用这个 cookie 的 javascript 代码，我想实现这一点：当访问者点击关闭时，div 将隐藏在网站的所有页面上。

```
<script type="text/javascript">
var $j = jQuery.noConflict();
$j(document).ready(function()
{
if(getCookie('show_cookie_message') != 'no')
{
    $j('#cookie_box').show();
}

$j('.cookie_box_close').click(function()
{
    $j('#cookie_box').animate({opacity:0 }, "slow");
    setCookie('show_cookie_message','no');
    return false;
});
});

function setCookie(cookie_name, value)
{
document.cookie = cookie_name+ "=" + escape(value);
}

function getCookie(cookie_name)
{
if (document.cookie.length>0)
{
    cookie_start = document.cookie.indexOf(cookie_name + "=");
    if (cookie_start != -1)
    {
        cookie_start = cookie_start + cookie_name.length+1;
        cookie_end = document.cookie.indexOf(";",cookie_start);
        if (cookie_end == -1)
        {
            cookie_end = document.cookie.length;
        }
        return unescape(document.cookie.substring(cookie_start,cookie_end));
    }
}
return "";
}
</script> 
```

和

```
#cookie_box
{ 
position: fixed;
display: none;
bottom: 0px;
font-size: 0.8em;
z-index: 1000;
background:#393939;
padding:5px;
text-align:center;
width:99%;
color:#ffffff;
}
#cookie_box a:hover
{ 
    color:#ffffff;
    text-decoration: underline
}

<div id="cookie_box">Our site requires cookies to function, <a href="/cookies">click here</a> for more information <a href="#" class="cookie_box_close">Close [X]</a></div> 
```

如果我单击“关闭”，它将关闭 cookie_box div，但仅在该页面上。如果我浏览到另一个页面，该 div 将再次可见。任何帮助都会很棒，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T23:31:24.480

如果 cookie 获取和设置正确，您可以使用以下内容：

```
if (getCookie('show_cookie_message') != 'no') {
    $j('#cookie_box').show();
} else {
   $j('#cookie_box').hide();
} 
```

这样，它可以确保显示或隐藏它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T23:35:18.697

为确保正确设置和检查 cookie，我在多年经验后使用这些 JS cookie 代码……有时捷径并不可靠。

```
function getCookie(c_name){
 var i,x,y,ARRcookies=document.cookie.split(";");
 var ARRcookies_length=ARRcookies.length;
 for (i=0;i<ARRcookies_length;i++)
 {
   x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("="));
   y=ARRcookies[i].substr(ARRcookies[i].indexOf("=")+1);
   x=x.replace(/^\s+|\s+$/g,"");
   if (x==c_name)
     {
     return unescape(y);
     }
   }
 }

function checkCookie(cookie_name){
 var the_cookie=getCookie(cookie_name);
   if (the_cookie!=null && cookie_name!=""){
   return true
   }
   else {
   return false;
   }
}

function setCookie(c_name,value,exdays){
 var exdate=new Date();
 exdate.setDate(exdate.getDate() + exdays);
 var c_value=escape(value) + ((exdays==null) ? "" : "; expires="+exdate.toUTCString());
 document.cookie=c_name + "=" + c_value;
 } 
```

# python - 减少Python中reduce的集合

> ID：13370631
> 
> 赞同：0
> 
> 时间：2012-11-13T23:23:50.357
> 
> 标签：python, reduce

如果我在 Python 中减少一个集合，那么获取集合的其余部分（未访问的项目）的最有效方法是什么？我经常需要对一个集合进行归约，但我希望我的归约函数能够获取我正在归约的集合中未访问的项目。

编辑-澄清一下，我想要类似的东西：

```
reduce(lambda to-return, item, rest: (code here), collection, initial) 
```

rest 是我的 lambda 尚未看到的项目

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:43:35.050

这是我能做的最好的。它期望“集合”是可切片的：

```
def myreduce(func,collection,*args):
    """func takes 3 parameters.  The previous value,
       the current value, and the rest of the collection"""
    def new_func(x,y):
        try:
            return func(x[1],y[1],collection[y[0]:])
        except TypeError:
            return func(x,y[1],collection[y[0]:])
    return reduce(new_func,enumerate(collection),*args)

print myreduce(lambda x,y,rest:x+y+sum(rest),range(30)) 
```

请注意，这是*非常糟糕的*测试。在您尝试在任何实际代码中使用它之前，请彻底测试。如果您真的希望它适用于任何可迭代对象，您可以`collection = tuple(collection)`在顶部放一个我想（假设您有足够的内存可以一次将整个可迭代对象存储在内存中）

# php - PHP：使用 Unicode 上传文件

> ID：13370633
> 
> 赞同：0
> 
> 时间：2012-11-13T23:24:17.467
> 
> 标签：php, file-upload, unicode

当我尝试`$_FILES`在 PHP 中循环遍历数组时出现错误，因为文件名都是 unicode。是否有可能仍然接受具有 unicode 文件名的文件？

示例代码：

```
foreach ($_FILES["files"]["error"] as $key => $error)
{

    $tmp_name = $_FILES["files"]["tmp_name"][$key];
    $name = $_FILES["files"]["name"][$key];

    logz( "$tmp_name AND $path/$name" );

    if ( $error == UPLOAD_ERR_OK )
    {
        move_uploaded_file($tmp_name, "$path/$name");

        logz( "$tmp_name -> $path/$name" );

    }
    else
    {
        logz( "upload error" );
    }

} 
```

注意log参数；输出是：

> / -> 路径/%7B

文件名不完整且`$_FILES['files']['name']`为空。

# iis - 使用 VS2012/网站（不是 WAP）创建 IIS Express 虚拟目录

> ID：13370639
> 
> 赞同：0
> 
> 时间：2012-11-13T23:24:49.120
> 
> 标签：iis, visual-studio-2012, iis-express, virtual-directory

我继承了一个网站项目，该项目是用用户控件的虚拟目录构建的（仍然想知道为什么有人这样做）。当然，当我将 src 标签加载到 Visual Studio 2012 中时，它会爆炸，因为这些文件实际上并不存在。

因此，使用 vs2012 和 iis express（内置浏览器）如何轻松创建虚拟目录并在我的 Visual Studio 开发经验中解决它。

谢谢！-彼得

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T00:25:36.567

原来网站菜单下有一个选项，上面写着“创建虚拟目录”。我希望这正是我想要的。

# git - 列出两个日期之间（由任何人）添加的新文件

> ID：13370644
> 
> 赞同：5
> 
> 时间：2012-11-13T23:25:03.893
> 
> 标签：git

如何列出两个日期之间（或两次提交之间）提交中新添加的文件？我倒要看看

1.  文件路径
2.  提交者/提交消息
3.  提交参考

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-10-30T20:35:28.077

这就是我使用的：

```
git log --diff-filter=A --name-only --pretty=oneline --abbrev-commit ref1..ref2 
```

此外，输出很容易解析。删除`--abbrev-commit`允许您将 SHA-1 用于某些工作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-13T23:36:29.310

`git log --stat`提供了一个很好的提交摘要，其中包含更改的文件的详细信息：

```
commit bde0ce475144ec85a1cb4ffeba04815412a07119
Author: Stephen Holdaway <xxxxx@xxxxx.com>
Date:   Thu Sep 20 13:55:12 2012 +1200

    fix default rotation issue

 Menus/MainMenuViewController.m   |   17 +++++++++++++----
 Menus/PostGameViewController.m   |   14 +++++++++++++-
 Menus/StatsMenuController.m      |   10 +++++-----
 4 files changed, 31 insertions(+), 11 deletions(-) 
```

您可以在两个日期之间尝试此操作：

```
git log --since "10 Sep 2012" --until "12 Nov 2012" --stat 
```

这在两次提交之间：

```
git log --stat xxxxxxx..xxxxxxx 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-14T00:03:15.367

您也可以使用`git show`. 它类似于`git log`但有一个`--name-status`参数，可以一次性为您提供路径名和添加/修改/删除标志（请注意，`git log`如第一个答案中所述，不限于新文件并且不显示状态指示器） .

```
$ git show --pretty=fuller --name-status HEAD^..HEAD
commit 3c92149119e69b4520b4ea317f221aade9f41b0e
Author: John Doe <xxxx@xxxxxx>
AuthorDate: Fri Nov 9 15:46:05 2012 -0600
Commit: John Doe <xxxx@xxxxxx>
CommitDate: Fri Nov 9 15:46:05 2012 -0600

Added some files, modified some other files

A       src/main/java/com/test/app/NewFile1.java
A       src/main/java/com/test/app/NewFile2.java
M       src/main/java/com/test/app/OldFile1.java
M       src/main/java/com/test/app/OldFile2.java 
```

可能有可能获得此信息`git log`（他们可能在后台使用相同的基本信息），但我还没有弄清楚。

# php - PHP：函数参数中的参数声明

> ID：13370645
> 
> 赞同：0
> 
> 时间：2012-11-13T23:25:09.973
> 
> 标签：php, function, scope, predefined-variables

首先，我不记得这个过程的名称，但它看起来像这样：

```
function test($alter = FALSE){
    //do stuff
    return $alter;
} 
```

在函数声明中使 $alter = FALSE 正确

那叫什么？这是如何运作的？在下列情况下会发生什么？

$结果 = 测试（）；

$结果 = 测试（真）；

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T23:26:59.047

`FALSE`如果没有传递其他值，则将其定义为默认值。

在您的示例中，结果（按顺序）将是：

```
FALSE
TRUE 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T23:28:32.407

方法头中定义的 FALSE 是默认值（如果在调用时没有向参数添加任何内容） -`test()`否则它的行为就像一个普通参数..所以如果你调用`test(TRUE)`value 将为 TRUE

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T23:32:43.443

除了：您可能还记得的术语是“函数重载”，但这并不是它的**真实**体现（它只是 PHP 的“默认参数”可能*类似*）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-13T23:45:33.230

```
"<?php
echo"welcome";
function a($b=false){
echo"<br /> b: ".$b;
}

a(true);
a();
a("some text");
a(false); 
```

?> 结果：
欢迎
b：1
b：
b：一些文本
b：
“

似乎如果它的 false/null/empty 它不打印任何东西.. 并且无论你传递给该方法 string/boolean 的内容，只要不是 null/empty 它就会打印。

# ruby-on-rails - Rails omniauth-facebook 未定义方法“https://graph.facebook.com”的“路径”：字符串

> ID：13370648
> 
> 赞同：2
> 
> 时间：2012-11-13T23:25:27.697
> 
> 标签：ruby-on-rails, ruby, facebook, authentication, omniauth

我正在使用omniauth-facebook gem，去的时候`/auth/facebook`我得到：

```
undefined method `path' for "https://graph.facebook.com":String 
```

它让我发疯。

配置/初始化程序/omniauth.rb

```
Rails.application.config.middleware.use OmniAuth::Builder do
  provider :facebook, [xxx], [xxx]
end 
```

配置/路由.rb

```
match 'auth/:provider/callback', to: 'sessions#create'
match 'auth/failure', to: redirect('/') 
```

我正在使用 1.9.2

完整的堆栈跟踪：

```
faraday (0.8.4) lib/faraday/connection.rb:191:in `url_prefix='
faraday (0.8.4) lib/faraday/connection.rb:40:in `initialize'
faraday (0.8.4) lib/faraday.rb:11:in `new'
faraday (0.8.4) lib/faraday.rb:11:in `new'
oauth2 (0.8.0) lib/oauth2/client.rb:51:in `connection'
oauth2 (0.8.0) lib/oauth2/client.rb:63:in `authorize_url'
oauth2 (0.8.0) lib/oauth2/strategy/auth_code.rb:18:in `authorize_url'
omniauth-oauth2 (1.1.1) lib/omniauth/strategies/oauth2.rb:48:in `request_phase'
omniauth-facebook (1.4.1) lib/omniauth/strategies/facebook.rb:94:in `request_phase'
omniauth (1.1.1) lib/omniauth/strategy.rb:207:in `request_call'
omniauth (1.1.1) lib/omniauth/strategy.rb:174:in `call!'
omniauth (1.1.1) lib/omniauth/strategy.rb:157:in `call'
omniauth (1.1.1) lib/omniauth/builder.rb:48:in `call' 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T12:11:47.520

我已经通过将`faraday`gem 降级到版本来解决这个问题`0.7.6`

# linq - 不同 LINQ 语法之间的性能差异

> ID：13370649
> 
> 赞同：0
> 
> 时间：2012-11-13T23:25:50.263
> 
> 标签：linq

> **可能重复：**
> [.NET LINQ 查询语法与方法链](https://stackoverflow.com/questions/3776577/net-linq-query-syntax-vs-method-chain)

编写这样的 LINQ 语句之间是否存在性能差异：

```
var result = (
from u in Users 
where u.Searchable.Contains(searchString) 
select u); 
```

与这样的对比：

```
var result = 
Users.Where(u=>u.Searchable.Contains(searchString)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:50:01.053

没有性能差异，因为第一个查询只是第二个查询的语法糖。

# java - 这个 preg_split 的 Java 等价物是什么？

> ID：13370650
> 
> 赞同：3
> 
> 时间：2012-11-13T23:25:50.677
> 
> 标签：java, regex

我必须将此 preg_split 代码“翻译”成 Java 等效代码。我已经尝试了一些没有成功的事情。这是我试图翻译的 PHP 代码：

```
$str="1 [3 4 5] 6 7 [8 9] 4";
$chars = preg_split("^\[(.*?)\]||/ /^", $str, -1, PREG_SPLIT_DELIM_CAPTURE);

foreach ($chars as $key => $value) {
    if(ord($value)!=0 && $value!=" "){
        $res[]=$value;
    }
}
print_r($res); 
```

如您所见，我的 String 输入可以由任何数字字符序列组成，其中一些用 [ ] 括号括起来：

```
1 [3 4 5] 6 7 [8 9] 4 
```

括号可以在字符串的开头或结尾，对此没有限制。

按照上面的示例，结果将如下所示：

```
[0] = "1"
[1] => "3 4 5"
[2] => "6"
[3] => "7"
[4] => "8 9"
[5] => "4" 
```

我在尝试翻译正则表达式时发现了一些问题（看起来像“\”因为无效的转义序列而失败）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T23:52:29.767

我不会将问题视为“拆分”，而是尝试提出一个与您正在寻找的表单的任何单个子字符串匹配的正则表达式，然后收集该表达式的所有匹配项，例如：

```
Pattern p = Pattern.compile("(?<=\\[)[^\\]]+|\\d+");
Matcher m = p.matcher(inputStr);
List<String> matches = new ArrayList<String>();
while(m.find()) matches.add(m.group()); 
```

左边的位`|`匹配方括号之间的任何内容，右边的位匹配任何其他数字序列。

请注意，当您想在 Java 字符串文字中编写正则表达式时，您需要将反斜杠加倍 - 文字`"\\"`表示包含一个反斜杠的单个字符串。

# ios - ios：故事板+标签栏+更多按钮（设计）

> ID：13370651
> 
> 赞同：1
> 
> 时间：2012-11-13T23:25:57.963
> 
> 标签：ios, storyboard

我有一个显示 dvd 列表的小应用程序，然后您可以从表格视图中向下钻取并获取一些详细信息。它的底部还有一个标签栏，您可以从 dvds 切换到 Bluray 作为标签按钮。这一切都很好。

在阅读标签栏应用程序时，我看到了一个演示，一旦您添加了超过 5 个标签栏按钮，“更多”就会出现，然后您可以像在 Apple 的音乐应用程序中一样拖放按钮，这很酷！我还注意到每个标签栏按钮控制一个单独的导航控制器，这对我来说是一种新技术。

当我创建我的应用程序时，它有一个导航控制器，我添加了一个视图控制器，视图的顶部是一个表格视图，视图的底部是一个标签栏。然后我将按钮拖到按钮栏，可以添加超过 5 个按钮，并且“更多”不显示。

所以，我认为，它需要是一个不同的导航控制器设计。

我很困惑我是否可以使用我的应用程序并嵌入标签视图控制器，或者我是否可以调整我拥有的东西。

现在，由于所有选项卡基本相同（一个深入到详细视图的表），我只是在切换选项卡时从不同的文件重新加载数据。干净整洁。

如果我切换到选项卡视图控制器的概念，那么创建 5 个导航控制器和 5 个表视图（向下钻取到 5 个详细视图）似乎很浪费。另外，如果我想要 7 怎么办？还是 9？（我确实意识到（或猜测）我可以为每 5 个视图赋予相同的类名，但 UI 仍然有很多故事板......）

这是一个设计问题，可以更好地了解我的选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T23:33:59.723

标签栏控制器必须始终是应用程序的根控制器。（除非它在拆分视图中，在这种情况下拆分的不同侧可以是标签栏控制器 - 但它仍然必须是根。）

因此，您的应用程序的正确设计是：标签栏控制器作为根，每个标签包含一个导航控制器，每个导航控制器都将您的表格视图控制器作为第一个视图控制器。这可能看起来很浪费，但如果你仔细想想，每个选项卡确实需要有自己的控制器堆栈，所以没有其他合理的方法可以做到这一点。如果选项卡 1 上的用户在导航堆栈中的深度为 2，但选项卡 2 的深度为 7，则您不想在选项卡之间切换并失去位置。

# c - 我将如何使用递归来生成所有可能性？

> ID：13370656
> 
> 赞同：-2
> 
> 时间：2012-11-13T23:26:42.180
> 
> 标签：c, combinatorics

假设输入是 4，那么输出应该是所有可能的 4 字母单词，字母 a 到 f。一路从aaaa到ffff。我将如何通过使用递归来做到这一点？

我很抱歉在我最初的问题中没有包括我对这个问题的尝试。有些人想知道为什么我使用递归而不是使用更简单的方法（例如 for 循环），原因是我的教授希望我们使用 for 循环来解决这个问题。

这是我这样做的尝试：

```
void allPossiblilities(int n)
{
     char*result;
     if(Done(result))/*since the last possibility will be all f I am using that as my base case*/
     {
       printf("%s",result);
       return;
     }

 /*This is where the recursive part should go but I am totally lost as to what it should be*/
}

bool Done(result)/*This function just returns true if all the array's index are f*/
{
     int i;
     bool a=true;
     for(i=0;i<=n-1;i++)
        if(result[i]!='f')
           a=false;
}
     return a;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T23:38:24.960

我会给你一个提示，让你思考：

4 位数字和 10 个可能的数字（0-9）有多少种可能性 base^digits = 10^4 = 10000 个可能的输出 0000-9999，在您的情况下，它们将 base = 6（AF）和 exp = 4（4 个位置） 6^4 = 1296 种组合。

递归函数是如何产生的？他们有两个步骤：

*   基本步骤：它是函数不调用自身时的条件或条件（最终条件）。

*   Recursive Step：是函数调用自身的条件或条件，其结果应该更接近Basic Step。

比如著名的阶乘函数，基本步骤是返回1，递归步骤是第二个。

PD：我试图让你自己分析问题并得到解决方案，并给你一些工具。

![递归示例](../Images/395d368f5173298b8ee1dcf32ee98387.png)

编码：

```
#include <stdio.h>
#include <stdlib.h>

void recurs( int * s );
void print( int * s );

int main( void )
{
    int a[] = { 0, 0, 0, 0 };
    print( a );
    recurs( a );

}

void recurs( int * s )
{
    int i;

    /*Basic Case*/
    if( s[ 3 ] == 5 && s[ 2 ] == 5 && s[ 1 ] == 5 && s[ 0 ] == 5 ){
        print( s );
        printf( "\nAccomplisshed!\n" );
    }

    else{
        s[ 0 ] += 1;
        for( i = 0; i < 3; i++ ){
            if( s[ i ] == 6 ){
                s[ i ] = 0;
                s[ i + 1 ] += 1;
            }
        }
        print( s );
        recurs( s );
    }
}

/* This only prints. */
void print( int * s )
{
    int i; 
    printf( "    " );
    for( i = 3; i >= 0; i-- ){
        printf( "%c", ( s[ i ] + 65 ) );
    }
} 
```

部分输出： ![在此处输入图像描述](../Images/a253278d3acbdb0240103dc6aeb43a4f.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T00:42:59.693

```
 int inc(char *c,char begin, char end){
    if(c[0]==0) return 0;
    if(c[0] == end){   // This make the algorithm to stop at char 'f'
        c[0]=begin;     // but you can put any other char            
        return inc(c+sizeof(char));
    }   
    c[0]++;
    return 1;
}

int all(int a, int n,char begin, char end){
    int i,j;
    char *c = malloc((n+1)*sizeof(char));
    for(i=a;i<=n;i++){
        for(j=0;j<i;j++) c[j]=begin;
        c[i]=0;
        do {
            printf("%s\n",c);
        } while(inc(c,begin,end));
    }
    free(c);
}

int main(void){
    all(4,4,'a','f'); // Generates from 4 letters words starting in aaaa to ffff
} 
```

如果你调用 all(1,4,'a','f') 它将生成 a,b,c,d...ffff

如果你调用 all(4,4,'a','z') 它将从 aaaa 生成到 zzzz

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-14T00:27:36.313

只是为了使用十六进制表示法生成`a-f`字符：

```
#include <stdio.h>
int v(unsigned char* i, unsigned short n) {
  return !n || (*i>=0xa0 && (*i&0xf)>=10 && v(i+1,n-1));
}
void f(unsigned short i) {
  if(i) f(i-1);
  if(v((char*)&i,2)) printf("%x\n",i);
}
int main(){ f((1<<16)-1);} 
```

# ascii - 在没有 ctype.h 的情况下转换小写/大写字母

> ID：13370660
> 
> 赞同：2
> 
> 时间：2012-11-13T23:27:00.330
> 
> 标签：ascii, ctype, tolower, toupper

我刚刚看到这在技术上可以工作，我无法解决的唯一错误是每次测试时都会打印的最后一个 ASCII 字符，我也在不使用***name***变量的情况下进行了测试，我的意思是减去 32 ASCII 中的任何小写字母都应该给我他们的大写字母，但我很好奇为什么我会得到一个额外的字符，从我在屏幕上看到的显然是**Û**。

```
#include <stdio.h>
 main()
{
char name[22];
int i;

fputs("Type your name ",stdout);
fgets(name,22,stdin);

for (i = 0; name[i] != '\0'; i = i + 1)
printf("%c",(name[i])-32);  /*This will convert lower case to upper */
                            /* using as reference the ASCII table*/   
fflush(stdin);
getchar();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T23:48:01.700

也许在字符串的末尾有一个换行符。

您可以检查字符代码，以便只转换实际上是小写字母的字符：

```
for (i = 0; name[i] != '\0'; i = i + 1) {
  char c = name[i];
  if (c => 97 && c <= 122) {
    c -= 32;
  }
  printf("%c", c);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-08T04:50:41.473

```
void read_chararray(char in_array[], int* Length)
{
    int Indx = 0, Indx2 = 0, Indx3 = 0;  // int declarations for indexs of some loops
    char cinput = { 0 }, word[255] = { 0 }, word2[255] = { 0 }; // declaration of cinput and first char array before punctiation removed

    for (Indx = 0; (cinput = getchar()) != '\n'; Indx++) { // Loop for getting characters from user stop at <enter>
        word[Indx] = cinput;                    // Placing char into array while changing to lowercase
    }   

    Indx2 = Indx;                               // Set Indx2 to Indx for loop operation
    for (Indx = 0; Indx < Indx2; Indx++) {      // Loop to check and replace upper characters with lower
        cinput = word[Indx];
        if (cinput >= 65 && cinput <= 90) {     // If cinput is within the ASCII range 65 and 90, this indicates upper characters
            cinput += 32;                       // Add 32 to cinput to shift to the lower character range within the ASCII table
            in_array[Indx] = cinput;            // Input new value into array pointer
        }
        else if (cinput >= 97 && cinput <= 122) // scans if character are lower ASCII, places them in array irraticating punctuation and whitespce
            in_array[Indx] = cinput;            // Input remaining lower case into array pointer
    }

    *Length = Indx;                              // final size of array set to Length variable for future use
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-08-15T10:48:20.133

```
#include<stdio.h>

void upper(char);

void main()
{
    char ch;
    printf("\nEnter the character in lower case");
    scanf("%c", &ch);
    upper(ch);
}

void upper( char c)
{
    printf("\nUpper Case: %c", c-32);
} 
```

# ruby-on-rails - 为什么我不能执行本地 Net::HTTP 获取请求？

> ID：13370661
> 
> 赞同：1
> 
> 时间：2012-11-13T23:27:01.830
> 
> 标签：ruby-on-rails, ruby, net-http

所以我有一个呈现 json 的控制器操作。我可以访问浏览器中的 url 并查看 json 数据，验证路由是否正常工作...

然而，如果我这样做：

```
uri = URI("#{request.protocol}#{request.host_with_port}/my_controller/action")
Net::HTTP.get(uri) 
```

我得到“超时::错误：超时::错误”

... ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T00:41:25.470

您正在使用单线程 HTTP 服务器，即 Webrick。这意味着它一次只能处理一个请求。您正在尝试从网络服务器本身向网络服务器发出请求。由于现在希望显而易见的原因，它将无法完成此操作。

使用允许此操作的其他 Web 服务器（例如 Thin），或选择其他方式来执行此操作。

# c++ - boost.python：从嵌入式解释器调用 c++ 实例的成员函数

> ID：13370664
> 
> 赞同：1
> 
> 时间：2012-11-13T23:27:09.740
> 
> 标签：c++, python, boost-python

我正在尝试使用`boost.python`. 我想做的是使用 Python 在我的 C++ 应用程序中分配的特定 C++ 类实例上评估简单表达式。

我为 C++ 中的一个简单类编写了 Python 包装器：

```
class pyTest1
{
public: 
    pyTest1():i(1),f(3.14){}

    int getint() { return i; }
    void setint(int val) { i = val; }

    float getfloat() { return f; }
    void setfloat(float val) { f = val; }

private:
    int i;
    float f;
};

BOOST_PYTHON_MODULE(pyTestSpace)
{
    class_<pyTest1>("pyTest1", init<>())
        .def("getint", &pyTest1::getint)
        .def("setint", &pyTest1::setint)
        .def("getfloat", &pyTest1::getfloat)
        .def("setfloat", &pyTest1::setfloat)
    ;
} 
```

给定一个实例`pyTest1`：

```
pyTest1 *testInstance = new pyTest1; 
```

我想使用嵌入式 Python 评估这样的表达式：

```
result = math.cos(testInstance->getfloat()) 
```

假设类实例和表达式（作为字符串）被传递给 C++ 函数，如下所示：

```
#include <string>
#include <boost/python.hpp>
#include <graminit.h>

void UseEmbedPython(std::string exp, pyTest1* obj)
{
    Py_Initialize();

    initpyTestSpace();

    PyObject *pDictionary = PyDict_New();

    PyDict_SetItemString(pDictionary, "__builtins__", PyEval_GetBuiltins() );
    PyRun_String("import math", file_input, pDictionary, pDictionary );

    //Need help here!
    //Assuming exp is something like "result = math.cos(obj->getfloat())"
    //How do I make obj's functions accessible to Python interpretter?

    PyRun_String(exp.c_str(), file_input, pDictionary, pDictionary ); 

    PyObject *pResult = PyDict_GetItemString(pDictionary, "result" );

    double result;
    PyArg_Parse(pResult, "d", &result );

    Py_Finalize();
} 
```

# maven - Maven 存储库是否具有标准格式？

> ID：13370666
> 
> 赞同：14
> 
> 时间：2012-11-13T23:27:11.667
> 
> 标签：maven, repository, nexus

回购是如何布局的？他们是一样的吗？如果是，谁指定格式。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-14T01:08:51.813

Maven 的存储库布局定义非常严格。Maven 本身就是完全处理存储库的工具。

```
/$groupIdWithSlashes/$artifactId/$version/$artifactId-$version.$extension
/$groupIdWithSlashes/$artifactId/$version/$artifactId-$version-$classifier.$extension 
```

在此处阅读更多[关于布局的详细信息](https://cwiki.apache.org/confluence/display/MAVENOLD/Repository+Layout+-+Final)，以及[在此处了解元数据文件的详细信息](https://cwiki.apache.org/confluence/display/MAVENOLD/Repository+Metadata)。

请注意，[Nexus](http://www.sonatype.org/nexus/)在其存储中具有相似的布局，但（在某些情况下）metadata.xml 文件的格式略有不同。

[其他存储库管理器可以在其内部存储（如Artifactory](https://sourceforge.net/projects/artifactory/)）中具有完全不同的布局。无论如何，URL 结构必须（并且是）相同。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-10-17T02:13:04.537

只是为了更新上面 Petr 给出的链接...... Maven 文档似乎已移至 [Maven Repository Layout](https://cwiki.apache.org/confluence/display/MAVENOLD/Repository+Layout+-+Final)和 [Maven Repository Metadata](https://cwiki.apache.org/confluence/display/MAVENOLD/Repository+Metadata)

# jquery - 砌体或我的滚动脚本会在一段时间后冻结 Firefox

> ID：13370668
> 
> 赞同：1
> 
> 时间：2012-11-13T23:27:19.263
> 
> 标签：jquery, scroll, jquery-masonry

我写了一个小的无休止的滚动脚本，布局砌体，在一些 ajax 调用之后，浏览器变得越来越慢（冻结）......

```
var $container = jQuery('#container');

    $container.masonry({
      itemSelector: '.box',
      columnWidth: 100,

      isAnimated : true,
      isFitWidth : false

    }).imagesLoaded(function() {
   $container.masonry('reload');
  });

var isLoading = false;
var endofdata = false;
var page=1;
$(window).scroll(function() {

    if ( $(window).scrollTop()+1 >= ( $(document).height() - $(window).height() ) )
    {
        if ( endofdata )
            return false;

        if (isLoading) {

            return false; // don't make another request, let the current one complete, or
            // ajax.abort(); // stop the current request, let it run again
        }
        isLoading =true;
        ajaxLoadActivity('bottom', true);
    }

});
var box;
function ajaxLoadActivity(one, two) {
     page=page+1;

     $.post('api.php', {'action' : "next", 'next' : page },
        function(data){
                 if(data == null)
                     endofdata=true;

                 jQuery.each(data, function(index, value){                        
                     box+="<div class=\"box\"><a href=\"page/"+value.id +"\">#" +value.id + "</a> " +value.data+"</div>";

                 });
                 boxes = $(box);
                 $container.append(boxes);
                 var $newElems = $( boxes ).css({ opacity: 0 });
                 $newElems.imagesLoaded(function(){
                     $newElems.animate({ opacity: 1 });
                     $container.masonry( 'appended', $newElems, true );

                 });

                 box="";
                 isLoading=false;

                }
            );
} 
```

工作示例 [http://www.dasmerkendienie.com/](http://www.dasmerkendienie.com/) （滚动一段时间后发生错误）

任何形式的帮助将不胜感激

最好的问候安德烈亚斯

顺便说一句：Firefox 发生错误，而不是谷歌浏览器

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T04:31:48.530

问题是 isAnimated 标志，当我加载超过 50 个元素时，我的浏览器卡住了。我不确定它是否是我的滚动脚本、砌体或 jquery 中的错误。但至少它解决了我的问题。

```
var $container = jQuery('#container');

$container.masonry({
  itemSelector: '.box',
  columnWidth: 100,

  isAnimated : false,
  isFitWidth : false

}).imagesLoaded(function() {   $container.masonry('reload');  }); 
```

# java - osmdroid 上的多个瓦片层

> ID：13370671
> 
> 赞同：6
> 
> 时间：2012-11-13T23:27:34.187
> 
> 标签：java, android, osmdroid

目前我正在使用 OSMdroid 底图加载一个瓦片数据层

```
final MapTileProviderBasic tileProvider = 
    new MapTileProviderBasic(getApplicationContext());
final ITileSource tileSource = 
    new XYTileSource("MyCustomTiles", null, 1, 16, 256, ".png",
            "http://a.url.to/custom-tiles/");
tileProvider.setTileSource(tileSource);
final TilesOverlay tilesOverlay = 
    new TilesOverlay(tileProvider, this.getBaseContext());
tilesOverlay.setLoadingBackgroundColor(Color.TRANSPARENT);
osmv.getOverlays().add(tilesOverlay); 
```

是否可以在 BaseMap 上渲染多个数据层，或者我一次只能显示一个数据层？我[为 GoogleMaps 找到了这个示例](http://jsfiddle.net/doktormolle/NNJRn/)，但没有找到一些一次处理 multipe`tileSources`的示例 OSMdroid 代码。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-10T10:35:21.107

是的，当然可以。您只需将另一个 TilesOverlay 添加到地图中。叠加层（也是tilesOverlays）从列表的最低索引（= 0）开始连续绘制。这是一个例子：

```
//create the first tilesOverlay
final MapTileProviderBasic tileProvider = new MapTileProviderBasic(getApplicationContext());
final ITileSource tileSource = new XYTileSource("MyCustomTiles", null, 1, 16, 256, ".png",
        "http://a.url.to/custom-tiles/");
tileProvider.setTileSource(tileSource);
final TilesOverlay tilesOverlay = new TilesOverlay(tileProvider, this.getBaseContext());
tilesOverlay.setLoadingBackgroundColor(Color.TRANSPARENT);

//create the second one
final MapTileProviderBasic anotherTileProvider = new MapTileProviderBasic(getApplicationContext());
final ITileSource anotherTileSource = new XYTileSource("MyCustomTiles", null, 1, 16, 256, ".png",
        "http://a.secondurl.to/custom-tiles/");
anotherTileProvider.setTileSource(anotherTileSource);
final TilesOverlay secondTilesOverlay = new TilesOverlay(anotherTileProvider, this.getBaseContext());
secondTilesOverlay.setLoadingBackgroundColor(Color.TRANSPARENT);

// add the first tilesOverlay to the list
osmv.getOverlays().add(tilesOverlay);

// add the second tilesOverlay to the list
osmv.getOverlays().add(secondTilesOverlay); 
```

# model-view-controller - 在 Zend_Registry 与类属性中存储数据

> ID：13370672
> 
> 赞同：2
> 
> 时间：2012-11-13T23:27:57.850
> 
> 标签：model-view-controller, zend-framework

我正在构建一个 Zend Framework 应用程序，其中模型层分为服务和模型。控制器动作调用服务方法，服务方法又调用模型方法。

例如： LanguagesController::addAction() 检查表单是否已提交且有效。如果是这样，它将表单数据传递给 Service_Language::add()，在调用 Model_Language::add() 之前将一些业务逻辑应用于数据，这有效地将记录添加到数据库中。

这意味着大多数控制器操作都需要一个服务类的实例，而服务类中的大多数方法都需要一个模型类的实例。

我曾经这样做（服务类的示例）

```
class Service_Language
{
    public function add()
    {
        $languageModel = new Model_Language;

        // perform some business logic and add record
    }

    public function edit()
    {
        $languageModel = new Model_Language;

        // perform some business logic and edit record
    }

    public function delete()
    {
        $languageModel = new Model_Language;

        // perform some business logic and delete record
    }
} 
```

它不仅变得麻烦，而且在控制器操作调用多个 Service 方法的更复杂的应用程序中，同一个 Model 类将有多个实例，这是不必要的。

一位同事告诉我研究两种选择：

*   将模型实例保存在服务的属性中
*   在 Zend_Registry 中保留一个 Model 实例

我认为最好的解决方案是第一个选择。原因是 Zend_Registry 充当全局容器。我们不希望我们的模型实例在我们的控制器操作中可用，这是一个糟糕的架构。您对此有何看法？

第一个选项可以按如下方式实现：

```
class Service_Language
{

    protected $_model = null;

    function setModel()
    {
        $this->_model = new Model_Language();
    }

    function getModel()
    {
        if($this->_model == null)
        {
            $this->setModel();
        }

        return $this->_model;
    }
    public function add()
    {
        $languageModel = $this->getModel();

        // perform some business logic and add
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T04:17:38.053

从您的解释看来，您的服务类需要紧密耦合的模型。

在这种情况下，我认为不需要为您的模型公开一个公共 getter/setter - 实际上是否存在您需要为服务设置另一个模型的情况？

在这种情况下，将模型分配给属性是有意义的——为什么不在构造函数中这样做呢？

```
class Service_Language
{
    protected $_model = null;

    public function __construct()
    {
        $this->_model = new Model_Language();
    }

    public function add()
    {
        // perform some business logic and add
        $this->_model->add($data);
    }

    public function edit()
    {
        // perform some business logic and add
        $this->_model->edit($data);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T00:56:31.673

构造函数本来是一个不错的选择，但并不是服务层中的每个方法都需要一个模型实例来完成它的工作，所以我最终这样做了。我对 OOP 编程比较陌生，所以我想知道这是否是一个好的解决方案。任何想法都非常受欢迎。

```
class Service_Language
{

    protected $_model = null;

    protected function setModel()
    {
        $this->_model = new Model_Language();
    }

    protected function getModel()
    {
        if($this->_model == null)
        {
            $this->setModel();
        }

        return $this->_model;
    }

    // Function where model is needed
    public function add($data)
    {
        // Perform some business logic

        $this->getModel()->add($data);

        // return something
    }

    // Function where no model is needed
    public function add($data)
    {
        // Perform some business logic

        // return something
    }
} 
```

# javascript - 使用 javascript sort() 对表进行排序

> ID：13370678
> 
> 赞同：1
> 
> 时间：2012-11-13T23:28:21.487
> 
> 标签：javascript

我正在尝试对表格进行排序。我见过几个 jQuery 和 JavaScript 解决方案，它们通过各种方式做到这一点，但是，还没有看到任何使用 JavaScript 的本机 sort() 方法的解决方案。也许我错了，但在我看来，使用 sort() 会更快。

以下是我的尝试，但是，我肯定遗漏了一些东西。我正在尝试做的事情是否可行，或者我应该放弃它吗？理想情况下，我想远离 innerHTML 和 jQuery。谢谢

```
var index = 0; //Index to sort on.
var a = document.getElementById('myTable').rows;

//sort() doesn't work on collection
var b = [];
for (var i = a.length >>> 0; i--;) {
    b[i] = a[i];
}

var x_td, y_td;

b.sort(function(x, y) {
    //Having to use getElementsByTagName is probably wrong
    x_td = x.getElementsByTagName('td')[index].data;
    y_td = y.getElementsByTagName('td')[index].data;
    return x_td == y_td ? 0 : (x_td < y_td ? -1 : 1);
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T11:25:22.473

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
        <title>All Sorting Techniques</title>
        <script type="text/javascript">

var a = [21,5,7,318,3,4,9,1,34,67,33,109,23,156,283];
function bubbleSort(a)
{
    var change;
    do {
        change = false;
        for (var i=0; i < a.length-1; i++) {
            if (a[i] > a[i+1]) {
                var temp = a[i];
                a[i] = a[i+1];
                a[i+1] = temp;
                change = true;
            }
        } 
    } while (change);
    document.getElementById("bublsrt").innerHTML = "Bubble Sort Result is:  "+a;
}
var b = [1,3,4,5,7,9,21,23,33,34,67,109,156,283,318];
function binarySearch(b, elem){
    var left = 0;
    var right = b.length - 1;
    while (left <= right){
    var mid = parseInt((left + right)/2);
    if (b[mid] == elem)
    return mid;
    else if (b[mid] < elem)
    left = mid + 1;
    else
    right = mid - 1;
    }
    return b.length;
}
function searchbinary(){
    var x = document.getElementById("binarysearchtb").value;
    var element= binarySearch(b,x);
    if(element==b.length)
    {
        alert("no. not found");
    }
    else
    {
        alert("Element is at the index number: "+ element);     
    }
}
function quicksort(a)
{
    if (a.length == 0)
        return [];
    var left = new Array();
    var right = new Array();
    var pivot = a[0];
     for (var i = 1; i < a.length; i++) {
        if (a[i] < pivot) {
           left.push(a[i]);
        } else {
           right.push(a[i]);
        }
    }
    return quicksort(left).concat(pivot, quicksort(right));
}
function quicksortresult()
{
    quicksort(a);
    document.getElementById("qcksrt").innerHTML = "Quick Sort Result is:  "+quicksort(a);
}
function numeric(evt){
    var theEvent = evt || window.event;
    var key = theEvent.keyCode || theEvent.which;
    key = String.fromCharCode(key);
    var regex = /[0-9]|\./;
    if (!regex.test(key)) {
        theEvent.returnValue = false;
        if (theEvent.preventDefault) 
            theEvent.preventDefault();
    }
}
function insertionsorting(a)
{
    var len = a.length;     
    var temp;                     
    var i;
    var j;
        for (i=0; i < len; i++) {
        temp = a[i];
        for (j=i-1; j > -1 && a[j] > temp; j--) {
            a[j+1] = a[j];
        }
        a[j+1] = temp;
    }
    document.getElementById("insrtsrt").innerHTML = "Insertion Sort Result is:  "+a;
}
function hiddendiv()
{
    document.getElementById("binarytbdiv").style.display = "none";
    document.getElementById("Insertnotbdiv").style.display = "none";
}
function binarydivshow()
{
    document.getElementById("binarytbdiv").style.display = "block";
}
function insertnodivshow()
{
    document.getElementById("Insertnotbdiv").style.display = "block";
}
function insertno(a)
{
    var extrano = document.getElementById("Insertnotb").value;
    var b= a.push(extrano);
    var change;
    do {
        change = false;
        for (var i=0; i < a.length-1; i++) {
            if (a[i] > a[i+1]) {
                var temp = a[i];
                a[i] = a[i+1];
                a[i+1] = temp;
                change = true;
            }
        }
    } while (change);
    document.getElementById("insrtnosearch").innerHTML = "Sorted List is:  "+a;
    alert("Index of "+extrano +" is " +a.indexOf(extrano));
}

</script>
    </head>
    <body onload="hiddendiv()">
        <h1 align="center">All Type Of Sorting</h1>
        <p align="center">Your Array is : 21,5,7,318,3,4,9,1,34,67,33,109,23,156,283</p>
        <div id="main_div" align="center">
            <div id="bubblesort">
                <input type="button" id="bubblesortbutton" onclick="bubbleSort(a)" value="Bubble Sort">
                <p id="bublsrt"></p>
            </div><br>
            <div id="quicksort">
                <input type="button" id="quicksortbutton" onclick="quicksortresult()" value="Quick Sort">
                <p id="qcksrt"></p>
            </div><br>
            <div id="insertionsort">
                <input type="button" id="insertionsortbutton" onclick="insertionsorting(a)" value="Insertion Sort">
                <p id="insrtsrt"></p>
            </div><br>
            <div id="binarysearch">
                <input type="button" id="binarysearchbutton" onclick="binarydivshow();" value="Binary Search">
                <div id="binarytbdiv">
                    <input type="text" id="binarysearchtb" placeholder="Enter a Number" onkeypress="numeric(event)"><br>
                    <input type="button" id="binarysearchtbbutton" value="Submit" onclick="searchbinary()">
                    <p id="binarysrch">Sorted List is : 1,3,4,5,7,9,21,23,33,34,67,109,156,283,318</p>
                </div>
            </div><br>
            <div id="Insertno">
                <input type="button" id="insertno" onclick="insertnodivshow()" value="Insert A Number">
                <div id="Insertnotbdiv">
                    <input type="text" id="Insertnotb" placeholder="Enter a Number" onkeypress="numeric(event);"><br>
                    <input type="button" id="Insertnotbbutton" value="Submit" onclick="insertno(a)">
                    <p id="insrtnosearch"></p>
                </div>
            </div>
        </div>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T23:32:32.140

`td`元素没有属性`.data`。

如果您想要元素的文本内容，并且只有一个文本节点，请使用`.firstChild`before `.data`。

然后，完成后，您需要将元素附加到 DOM。对 JavaScript 元素数组进行排序对 DOM 没有任何影响。

此外，`getElementsByTagName("td")`您可以只使用`.cells`.

```
b.sort(function(rowx, rowy) {
    x_td = rowx.cells[index].firstChild.data;
    y_td = rowy.cells[index].firstChild.data;
    return x_td == y_td ? 0 : (x_td < y_td ? -1 : 1);
});

var parent = b[0].parentNode;

b.forEach(function(row) {
    parent.appendChild(row);
}); 
```

如果您要比较的内容是数字，则应将字符串转换为数字。

如果它们是文本字符串，那么您应该使用`.localeCompare()`.

```
return x_td.localeCompare(y_td); 
```

# ios - 改变场景时如何摆脱 UISwitch

> ID：13370681
> 
> 赞同：0
> 
> 时间：2012-11-13T23:28:29.280
> 
> 标签：ios, cocos2d-iphone, switch-statement, uiswitch

我正在制作的 Cocos2d 游戏的菜单中使用 UISwitch。

更改场景后（用户单击任何按钮并转到不同的场景/图层，开关仍在屏幕上

我已经尝试在我的 dealloc 中设置`switch1 = nil;`和`switch2 = nil;`，但这不起作用。我该怎么做？

编辑：也试过了`[switch1 release]`；这也不起作用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T23:42:02.207

您通常通过以下方式从视图中删除控件：

```
[switch1 removeFromSuperview]; 
```

如果您在其他地方对该控件有任何强引用，那么您可以执行适当的内存管理以在该点释放开关（例如，将其设置为`nil`或释放它，视情况而定）。您必须告诉我们它是如何定义的（`strong`或`weak`，财产或 ivar，`IBOutlet`或以编程方式创建等），以便我们在那里提供咨询，但您可能已经涵盖了这一点。

# linux - Linux 3.2 /dev/shm 性能变量？

> ID：13370683
> 
> 赞同：3
> 
> 时间：2012-11-13T23:28:40.540
> 
> 标签：linux, performance, fwrite

我正在使用`/dev/shm`tmpfs 编写大量临时文件。

一组 8-10 个文件/秒，每组包含的文件范围为 70kB .. 750kB。这些文件集的大小都大致相同，并且大约每秒定期写入一次。

编写这些文件的代码是 python 调用一个用于`fwrite()`编写的库。

应用程序启动时，写入时间从 30 毫秒到超过 400 毫秒不等。通常它是最大的（700k）文件，可能需要 400 毫秒才能写入，但它会有所不同。

这是一组 8 的示例，以 ms 为单位给出：42,30,320,76,66,72,102,440。

看来写到的标准偏差`/dev/shm`是相当大的。

应用程序运行几分钟后，写入时间直线下降，方差小得多（例如 7、8、15、23、24、32、51、71）——这种行为是稳定的，我已经运行了应用程序几个小时。

没有其他后果应用程序同时运行，并且有足够的空间`/dev/shm`。

*似乎 Linux 内核正在动态调整应用程序对* `/dev/shm`. **我的问题是：我对 linux 内核的怀疑是否正确？**如果是这样，是否有任何方法可以提前配置或通知内核以在我的应用程序启动时使用所需的行为？（更快的写入`/dev/shm`）

我正在使用 Ubuntu 12.04 LTS

```
$ uname -a
Linux devsb02 3.2.0-24-generic #39-Ubuntu SMP Mon May 21 16:52:17 UTC 2012 x86_64 x86_64 
x86_64 GNU/Linux
$ ls -l /dev/shm
lrwxrwxrwx 1 root root 8 Aug 23 12:19 /dev/shm -> /run/shm
$ mount
....
none on /run/shm type tmpfs (rw,nosuid,nodev) 
```

# java - GATE：在 ANNIE 中，运行 Pronominal Coreference 模块后提取命名实体

> ID：13370684
> 
> 赞同：1
> 
> 时间：2012-11-13T23:28:45.020
> 
> 标签：java, nlp, named-entity-recognition, gate

**摘要：** 在 GATE 网站上有这个例子。[http://gate.ac.uk/wiki/jape-repository/coordinated-annotations.html#section-3](http://gate.ac.uk/wiki/jape-repository/coordinated-annotations.html#section-3)。

此规则引用仅在运行共同引用模块后才会出现的结果。有没有办法在共同参考模块之后无需再次运行 NE 转换器来提取实体？

**我的具体问题：** 目前我有一个规则可以提取一个我用“对象”注释标记的名词短语。此规则不匹配以代词结尾的短语，因此它不匹配“it”。但是，我正在尝试使用 ANNIE 中的 Pronominal Coreference 模块将“它”的实例链接到它可能共同引用的其他“对象”。

问题是，由于我的“对象”注释与“它”的实例不匹配，我使用“对象”注释的其他规则不会匹配名词短语是单词“it”但它确实引用的句子另一个“对象”。所以实际上，我的规则应该匹配这句话。

如果我在 Pronominal Coreference 模块之后再次运行 NE 换能器，则可以解决此问题，但这当然会很昂贵且多余。

有一个更好的方法吗？显而易见的事情是改变我的规则以匹配“它”的实例，但如果有更好的方法，我想尝试一下。

# java - 将对象数组作为数据成员放入其类中是不是一个坏主意？

> ID：13370686
> 
> 赞同：-1
> 
> 时间：2012-11-13T23:28:58.853
> 
> 标签：java, c++, oop

我的意思是，我有一个 A 类，并且我有一个 A 数组作为 A 类的静态数据成员。这是一种不好的做法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:30:49.697

在 Java 中，它会导致内存泄漏......除非你用终结器或`Reference`对象做一些混乱和复杂的事情。

如果您的目标是保留所有已创建实例的集合，则需要*非常小心！* 无论您如何实现它，创建的所有实例的集合都会泄漏内存。（只有当泄漏是有界的，或者小到在整个应用程序的上下文中无关紧要时，这才是真正可以接受的。）

如果您的目标是保留现有实例的缓存以（例如）以抵消一些特别大的对象创建/初始化开销，那么您应该使用一个`WeakHashMap`或现有的 3rd-party 缓存类，而不是尝试使用数组从头开始实现它.

# objective-c - IOS：是否可以将一个故事板视图控制器绑定到几个不同的类？

> ID：13370692
> 
> 赞同：4
> 
> 时间：2012-11-13T23:30:05.830
> 
> 标签：objective-c, ios, xcode, storyboard

我知道可以将自定义视图控制器类附加到情节提要上的几个不同的视图控制器，但可以在另一个方向上完成吗？也就是说，根据情况，我想将不同的自定义类绑定到情节提要上的单个视图控制器，该控制器将使用以下方式实例化：

```
[self.storyboard instantiateViewControllerWithIdentifier:] 
```

背景：我的故事板上曾经有几个几乎相同的视图控制器。事实上，它们各自绑定的自定义类也非常相似。为了解决这个问题，我将自定义类重构为一个基类和几个子类。然后我从情节提要中删除了所有类似的视图控制器，只留下一个绑定到我的基类的视图控制器。然后我打电话给：

```
MySubclass* mySubclass = [self.storyboard instantiateViewControllerWithIdentifier:@"StoryboardControllerBoundToBaseClass"]; 
```

不幸的是，我的子类代码被忽略了，只运行了基类代码。有谁知道如何在不复制情节提要上的视图控制器并将每个视图控制器绑定到不同的子类的情况下使其工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T23:39:58.463

这是不可能的。仅仅因为您说 MySubclass *object = something 并不会神奇地将 object 转换为 MySubclass 对象。它存储在情节提要中，并在情节提要编译时分配了任何类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T01:24:55.327

我认为我可以通过使用委托/代理模型在情节提要上重用视图控制器，而不是使用子类化。更具体地说，我可以将故事板的视图控制器绑定到一个自定义类，该类将其所有方法/事件委托给其他类来处理。这不像子类化那么优雅，但至少我可以让我的故事板更精简，而不必保留几乎相同的视图控制器的多个副本。另外，我不需要复制这些控制器的每个副本的未来更改来启动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-19T19:10:06.160

正如盖伊传奇所写。苹果不支持这样做的方式。有很多解决方法，例如与代表，但我终于找到了答案并在另一个主题中回答。希望能帮助到你！ [https://stackoverflow.com/a/32103618/1943053](https://stackoverflow.com/a/32103618/1943053)

# scala - 使用 Play2 scala 的 Heroku 内存泄漏

> ID：13370694
> 
> 赞同：10
> 
> 时间：2012-11-13T23:30:09.540
> 
> 标签：scala, heroku, playframework-2.0, squeryl

正在对我的 1 heroku dyno 和 dev 数据库进行一些拉伸（ab）测试，连接数限制为 20。

在调用期间（使用 squeryl 访问数据库的堆分配正在增加，导致 R14（内存超过 512MB））

我似乎无法重现该问题（至少在该级别上）。

有没有办法让heroku堆转储并分析它以获得一些线索？

play2、scala、squeryl 和 heroku 内存泄漏是否存在任何已知问题？

**更新**

如果我在控制器末尾执行 System.gc，一切似乎都很好，而且速度较慢...我在该调用中创建了很多对象，但 heroku 的 JVM 不应该处理 gc 吗？另外，如果我定期安排 gc 调用，请不要释放内存

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T20:52:11.793

有一篇很棒的文章可以解决 Heroku 上的内存问题： [https ://devcenter.heroku.com/articles/java-memory-issues](https://devcenter.heroku.com/articles/java-memory-issues)

在您的情况下，您可以将 GC 标志添加到 JAVA_OPTS 以查看内存详细信息。我建议以下标志：

`heroku config:add JAVA_OPTS="-Xmx384m -Xss512k -XX:+UseCompressedOops -XX:+PrintGCDetails -XX:+PrintHeapAtGC -XX:+PrintGCDateStamps"`

如果您想从 JMX 获得更多关于您的内存的信息，还可以将其添加到您的进程中，还有一个简单的 java 代理。如果您想更深入地了解，您还可以查看像 New Relic 这样的监控插件，但我认为您应该对标志和 java 代理没问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-29T02:19:37.110

我也有这个问题，[在这里](https://stackoverflow.com/questions/15555108/heroku-jvm-tuning/23354321#23354321)回答了。

> 我遇到过同样的问题。Heroku 告诉您机器内存不足，而不是 Java VM。Heroku Play 2.2 部署实际上有一个 bug，启动脚本读取的是 java_opts，而不是 JAVA_OPTS。
> 
> 我通过设置两者来修复它：
> 
> ```
> heroku config:add java_opts='-Xmx384m -Xms384m -Xss512k -XX:+UseCompressedOops'
> heroku config:add JAVA_OPTS='-Xmx384m -Xms384m -Xss512k -XX:+UseCompressedOops' 
> ```
> 
> 我还必须设置 -Xms 否则我得到一个错误，说最小值和最大值不兼容。我猜 Play2.2 使用的默认值高于 384m。

# objective-c - 核心数据关系：弹出按钮可以选择关系但不显示名称

> ID：13370700
> 
> 赞同：0
> 
> 时间：2012-11-13T23:30:54.553
> 
> 标签：objective-c, cocoa, core-data, osx-mountain-lion, xcode4.5

由于核心数据关系错误而浪费了大量时间后，现在我可以将弹出按钮单元格绑定到实体关系。
现在唯一的问题是，当我选择并浏览所有选项时，会显示名称，但是当我选择关系并单击它时，名称就会消失。
实体非常简单：

![实体](../Images/3463e5baf0b9f5b004274503cd8eb4b0.png)

所以一个人可以有 0 个或 1 个家，一个家可以有 0 到 N 个人（反向关系）。
我有一个名为“people”的数组控制器，它处于实体模式，与托管对象上下文的 people 对象绑定。对于“homes”，它与 home 对象绑定。表视图中的所有名称都正确显示，除了弹出按钮。这是我在选择它时看到的：

![弹出按钮](../Images/e99f6db64a82472f08d82a5a3503f00d.png)

这就是我在未选择时看到的：

![弹出按钮](../Images/2f3c76783f14be780189994914488dfb.png)

所以就像你看到的单元格是空的。弹出按钮的绑定是：

**1.**内容：“家园”排列的对象；
**2.**内容值：“homes”排列的objects.name；
**3.**选定对象：“人” selection.home 。

那么问题来了：为什么弹出按钮在未选中时不显示关系名称？

PS：表格视图是基于单元格的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T13:33:23.727

这对我来说一直很痛苦，最后我解决了它，所以解释了谁会发现我的同样问题：我正在混合基于视图的表格视图和基于单元格的表格视图。如果你想绑定基于单元格的表格视图，请执行不将表视图内容绑定到托管对象上下文，而是绑定它的列。对于弹出按钮，我取消了所有绑定并以这种方式绑定它的列：

1.  内容：“家园”排列的物件；
2.  内容值：“homes”排列的objects.name；
3.  选定对象：“人” selection.home 。

所以这可能看起来一样，但现在是具有这些绑定的表格列，而不是按钮单元格。现在一切正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-20T20:44:48.143

感谢您的回答！我试图解决这个问题几个小时，问题是我已将表格内容绑定到控制器。现在我只是将列绑定到控制器，一切都按预期工作。

# javascript - 为什么不切换（style.display）

> ID：13370701
> 
> 赞同：0
> 
> 时间：2012-11-13T23:30:58.460
> 
> 标签：javascript, html, toggle

我想知道为什么在这里涉及此代码时会出现“显示未定义”。这是我正在谈论的页面部分的模型。我在标头中有 javascript，在 PHP 回显中有 html。

```
<?php
error_reporting(E_ALL ^ E_NOTICE);
session_start();
$userid = $_SESSION['userid'];
$username = $_SESSION['username'];

?>

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org   /TR/html4/loose.dtd">

<html>

<head>

<script type="text/javascript">

function display(id) {
var e = document.getElementById(id);
alert(e.style.display);
if (e.style.display == 'block') {
e.style.display = 'none';
}
else {
e.style.display = 'block';

}
}
</script>
</head>

<body>
<?php
   if ($username && $userid) {
    echo "<a href=\"javascript: display('menuLinksAdmin');\">MenuLinks</a>
        <div id='menuLinksAdmin' style='display: none;'>
<form action='insert.php' method='post'>
    linktitle:          <input type='text' name='linktitle' />
    linkdescription:    <input type='text' name='linkdescription' />
                        <input type='submit' />
</form>
</div>";

}

else
echo 'somethin up homie';

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:37:37.413

**更新**

这个问题似乎与范围相关。[默认情况下， jsfiddle](http://jsfiddle.net/xu4S9/)将脚本代码包装在 mootols onload 事件中，这会混淆对`display`函数的调用。

When selected "no wrap (head"), it works fine.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T23:43:14.797

您的代码在此处测试为我工作：http: [//jsfiddle.net/pu3wQ/1/](http://jsfiddle.net/pu3wQ/1/)

```
<a id='menuLinks' href="javascript:display('menuLinksAdmin');">MenuLinks</a>
<div id='menuLinksAdmin' style='display:none;'>
<form action='insert.php' method='post'>
    linktitle: <input type='text' name='linktitle' />
    linkdescription: <input type='text' name='linkdescription' />
    <input type='submit' />
</form>
</div>

<script>
function display(id) {
var e = document.getElementById(id);
if (e.style.display == 'block') {
    e.style.display = 'none';
}
else {
    e.style.display = 'block';

    }
}
</script> 
```

我认为你的问题是范围界定。尝试将 JS 代码放在 HTML 文件的头部并将标记放在正文中。

如果您对 jQuery 感到满意，这里的版本会像您期望的那样工作。 [http://jsfiddle.net/pu3wQ/8/](http://jsfiddle.net/pu3wQ/8/)

这是一个更短的 jQuery 版本：http: [//jsfiddle.net/pu3wQ/11/](http://jsfiddle.net/pu3wQ/11/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T23:50:25.230

我会更改函数的名称以更能描述它的作用。另外，在尝试使用它之前检查你是否获得了一个元素。在切换显示属性时，最好在“无”和“”之间切换（见下文）：

```
function toggleDisplay(id) {

  var element = document.getElementById(id);

  // Only proceed if an element was found
  if (element && element.style) {

    if (element.style.display == 'none') {
        element.style.display = '';  // empty string

    } else {
        element.style.display = 'none';
    }
  }
} 
```

将 display 设置为 '' 允许它返回到其默认值（或它可能继承或由 CSS 设置的任何值），这可能不是阻塞的。此外，如果该属性没有被显式设置，即使计算的值是“块”（或内联块或表或内联表或其他许多值之一），它也会是 ''。

上式可以简写为：

```
element.style.display = element.style.display == 'none'? '' : 'none'; 
```

此外，当其他一些元素（如按钮或样式跨度）更适合这项工作时，不要使用 A 元素和假 href。A 元素具有使其不适合的默认行为。

最后，我将更改函数的名称，使其更符合函数的实际功能，因此：

```
<span id='menuLinks' onclick="toggleDisplay('menuLinksAdmin');">MenuLinks</span> 
```

然后添加 CSS 以按照您想要的方式设置跨度样式，也许：

```
#menuLinks {
  cursor: pointer;
  text-decoration: underline;
} 
```

# jquery - jQuery contextMenu 通过 Ajax 调用加载项目

> ID：13370705
> 
> 赞同：1
> 
> 时间：2012-11-13T23:31:37.303
> 
> 标签：jquery, ajax, contextmenu

我正在为 jQuery 1.8.11.js 使用下面的上下文菜单插件，并使用“build”回调在每次点击时动态创建菜单。

[http://medialize.github.com/jQuery-contextMenu/index.html](http://medialize.github.com/jQuery-contextMenu/index.html)

我希望能够在单击项目时动态加载菜单选项（调用控制器方法，根据项目的 ID 确定可用选项）

我的问题是这个上下文菜单库似乎不支持 ajax 调用，如果我尝试在“build”回调中进行 ajax 调用，它显然不会等到 ajax 调用完成。

这是我正在尝试做的精简片段：

```
$.contextMenu({
    selector: '" + contextMenuSelector + @"',
    build: function ($trigger, e) {
    menuOptionsArray = [];
        //Ajax START
        $.ajax({
             type: "POST",
             url: <myurl>,
             //async: false, //**IF I UN-COMMENT THIS, IT WORKS**
             context: $(this),
             success: function (data) {
                   //BUILD THE OPTIONS ARRAY
                   menuOptionsArray...
                }
            });
         //Ajax END

         //This returns before the ajax call finishes               
         return {
            items: menuOptionsArray
        };
    } 
```

在上面，设置 async = false 有效，但由于已弃用，我不想使用它。

有没有其他方法可以异步加载项目，或者这需要修改插件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-17T10:47:08.840

我有同样的问题，我切换到 jQuery UI 菜单小部件并使用了焦点事件和刷新功能。

这是一个小提琴：http: [//jsfiddle.net/3r5FX/](http://jsfiddle.net/3r5FX/)

在这里我写了一些关于它的内容：http: [//imnotsmartjustlucky.blogspot.se/2013/06/jquery-context-menu-asynchronousajax.html](http://imnotsmartjustlucky.blogspot.se/2013/06/jquery-context-menu-asynchronousajax.html)

代码摘录：HTML：

```
<ul id="menu" style="width:300px">
 <li class="ui-state-disabled"><a href="#">Aberdeen</a></li>
 <li>
  <a href="#">Delphi</a>
  <ul>
                 <li><a href="#"><img src="http://cdn-3.nikon-cdn.com/static/images/icons/icon_loading.gif"/></a></li>
  </ul>
 </li>
 <li><a href="#">Saarland</a></li>
 <li class="ui-state-disabled"><a href="#">Amesville</a></li>
</ul> 
```

JS：

```
$(function(){
    $("#menu").menu({
        focus: function( event, ui ) {
            if(ui.item.children("ul").children("li").children("a").children("img").length > 0){
                $.get("http://fiddle.jshell.net", function(data){
                    ui.item.children("ul").html("<li><a href='#'>Viktor</a></li><li><a href='#'>Sweden</a></li><li><a href='#'>Luleå</a></li>")
                    $("#menu").menu("refresh")
                })
            }
        }
    });

}); 
```

# java - java - 如何使用java中的计时器每5秒更改一次对象运动？

> ID：13370708
> 
> 赞同：-3
> 
> 时间：2012-11-13T23:31:45.533
> 
> 标签：java, timer

我有一个物体根据某种算法移动，我想让它每 5 秒以不同的方式移动。我如何使用计时器来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T23:35:13.940

[看到这个](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Timer.html)

```
Timer time = new Timer();
time.scheduleAtFixedRate(new TimerTask(){
    public void run(){
        //Do Stuff
    }
}, 0, 1000 * 5); 
```

# xml - 将文件上传到 box.net

> ID：13370711
> 
> 赞同：1
> 
> 时间：2012-11-13T23:32:17.130
> 
> 标签：xml, ajax, box-api

我正在尝试将文件上传到我在 box.net 上的帐户中的文件夹。我正在使用 1.0 api 版本并使用 AJAX 中的帖子进行上传。这是我的代码。

```
var fd = new FormData();

$('#files').change( function() {    
    fd.append( 'file', $('#files')[0].files[0]);
});

$( 'form' ).submit(function() {
    $.ajax({
        url: 'https://upload.box.net/api/1.0/upload/myauth/myfolderid?share=1', 
        type: 'POST',
        data: fd,
        contentType: false,
        processData: false,
        success: function(result){
            alert(result);
        },
        error: function(result){
            console.log(result);
            alert(result);      
        }
    });
}); 
```

例如，我想使用返回的 XML 来存储文件 ID。问题是，它永远不会成功！我不知道为什么！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T08:27:54.643

使用 API 的 2.0 版。api已经改变。

# c++ - C++ 内存对齐是正确的还是低效的？

> ID：13370718
> 
> 赞同：6
> 
> 时间：2012-11-13T23:32:37.723
> 
> 标签：c++, memory, alignment

我测试了这段代码，只是想找出 C++ 实际为 new 运算符保留了多少内存。

```
#include<iostream>
using namespace std;
int main() {

  cout << "alignment of " << alignof(int) << endl;
  int *intP1 = new int;
  *intP1 = 100;
  cout << "address of intP1 " << intP1 << endl;
  int *intP2 = new int;
  *intP2 = 999;
  cout << "address of intP2 " << intP2 << endl;
  int *intP3 = new int;
  cout << "address of intP3 " << intP3 << endl;
  *intP3 = 333;

  cout << endl;
  cout << (reinterpret_cast<char *>(intP3)-reinterpret_cast<char *>(intP2)) << endl;
  cout << intP3-intP2 << endl;
  cout << endl;

  cout << *(intP1) << endl;
  cout << *(intP1+4) << endl;
  cout << *(intP1+8) << endl;
  cout << *(intP1+16) << endl;
  delete intP1;
  delete intP2;
  delete intP3;
  return 0;
} 
```

在使用 -std=c++11 标志编译代码并运行它之后，这是我从 x86_64 机器上得到的。

```
 alignment of int4
    address of intP1 = 0xa59010
    address of intP2 = 0xa59030
    address of intP3 = 0xa59050

    the distance of intP3 and intP2 = 32

    intP1 value = 100
    is this a padding value = 0
    intP2 value = 999
    intP3 value = 333 
```

似乎在使用 new 为整数分配 4 字节内存时，它实际上保留了 32 字节块，即 8 个整数的总空间。根据c++对齐的解释，对于64位机器，内存是按16字节对齐的，为什么这里的距离是32字节呢？

有人可以帮我解决这个问题吗？提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T23:40:51.827

它与对齐无关——它是内部内存分配器工作方式的额外开销。通常，每个内存块在其前面和/或后面都有额外的隐藏信息，用于维护堆的结构。确切的开销会因平台和实施而异。

例如，[Doug Lea`malloc`](http://g.oswego.edu/dl/html/malloc.html)每次分配的额外开销为 4-8 字节（32 位指针）或 8-16 字节（64 位指针），最小分配大小为 16 字节（32 位）或 32 字节（ 64 位）。这意味着即使是 1 字节的分配，内存分配器也需要总共 16 字节的跟踪开销。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T23:42:43.023

32 字节的差异*不仅仅是*为了对齐。实际上，请注意地址`0xa59010`不是 32 对齐的，它只是 16 对齐的。因此，如果它们仅相隔 16 个字节而不是 32 个字节，则地址的对齐不会更糟。

相反，32 字节的差异是内存分配器的开销/效率低下。我怀疑分配器：

*   有助于为您提供 16 个对齐的地址。这是 128 位 SSE 类型所需要的，所以它对你很有用，但我不知道这是否是分配器是 16 对齐的主要原因，或者它是否只是对分配器方便。
*   在分配簿记信息之前需要一些空间，这可能是 16 个字节（2 个指针或一个指针和一个大小），但即使不是，它也被舍入到 16 个字节。
*   实际数据只需要 4 个字节，但由于 16 个字节的簿记和 16 个字节的对齐，分配之间的最小距离为 32 个字节。因此，当您进行 4 字节分配时，会有 12 字节的“松弛空间”/“内部碎片”/“浪费”。

但这只是一个猜测，我没有调查过你使用的任何分配器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T23:48:47.240

的调试版本`new`可以添加相当多的填充以提供保护空间，以便可以检测到一些堆损坏。您应该使用调试版本和发布版本运行它，看看是否有区别。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T23:37:37.123

你有一个指针和一个内存值。这分配了 2 个内存块，您已经说过每个内存块 16 个字节。2x16=32。

我相信这会给你你想要的结果。

```
 cout << "alignment of " << alignof(int) << endl;
  int intP1 = 100;
  cout << "address of intP1 " << &intP1 << endl;
  int intP2 = 999;
  cout << "address of intP2 " << &intP2 << endl;
  int intP3 = 333;
  cout << "address of intP3 " << &intP3 << endl; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-13T23:38:52.690

`int4`表示它占用 4 个字节，而不是 4 位。编译器向您显示的所有内容实际上都是准确的！[这](http://www.cplusplus.com/doc/tutorial/variables/)是一些关于原语的文档以及`int`原语的含义。

[这](http://www.cplusplus.com/forum/general/51911/)是有关如何定义 4 位整数的教程。

让我提一下，这`alignof`取决于架构。在某些架构`int`中意味着 16 位 int 或 2 个字节而不是 4 个。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-13T23:48:56.037

绝对没有什么需要操作系统来分配三个指针`intP1`，`intP2`并且`intP3`彼此相邻。您的代码*可能*会检测分配中的开销（当然，有一些开销是合理的假设），但不足以证明间距必然是所有分配器开销。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-13T23:52:33.480

C++ 标准不保证每个堆分配有多少开销。无论对齐方式如何，分配器通常都会增加额外的开销。分配器从预定大小的桶中完成小分配是很常见的。在这里，最小的存储桶似乎是每次分配 32 个字节，这并不罕见。您很少会在野外发现桶小于 16 字节的分配器。

如果您要分配超过 1 个 int，比如说 int[2]，您可能会注意到所占用的内存大小是相同的：32 字节。

另请注意，C++ 标准或分配器不保证 2 个相同大小的分配是连续的。这在大多数情况下可能会受到尊重，但不应依赖。

# android - 移除 android 默认操作栏

> ID：13370719
> 
> 赞同：25
> 
> 时间：2012-11-13T23:32:42.833
> 
> 标签：android, android-actionbar

> **可能重复：**
> [如何使用现有自定义主题在 XML 中隐藏 Activity 的标题栏](https://stackoverflow.com/questions/2591036/how-to-hide-the-title-bar-for-an-activity-in-xml-with-existing-custom-theme)

我通过 requestWindowFeature(Window.FEATURE_NO_TITLE) 删除操作栏；但是，当应用程序启动时，操作栏会在很短的时间内出现，然后才会执行上述语句。我怎样才能让它完全消失？谢谢

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-11-13T23:44:35.263

我注意到，如果您在 AndroidManifest 中设置主题，它似乎摆脱了您可以看到操作栏的短时间。因此，请尝试将其添加到您的清单中：

```
<android:theme="@android:style/Theme.NoTitleBar"> 
```

只需将其添加到您的`application`标签即可在应用程序范围内应用它。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-11-13T23:43:10.710

您可以在 AndroidManifest 中的活动 xml 中将其设置为无标题栏主题

```
 <activity 
        android:name=".AnActivity"
        android:label="@string/a_string"
        android:theme="@android:style/Theme.NoTitleBar">
    </activity> 
```

# windows-8 - windows8 - 将对象数据输出为表格

> ID：13370721
> 
> 赞同：0
> 
> 时间：2012-11-13T23:33:04.217
> 
> 标签：windows-8, windows-store-apps

我有一个包含成员名称和值的 C1 类。我有一个 ObservableCollection C1Coll，它将有大约 10 到 20 个项目。当用户单击电子邮件选项时，我需要将此数据作为表格写在电子邮件中。有任何想法吗？

# ruby-on-rails - Rails 为两步表单获取 id

> ID：13370726
> 
> 赞同：0
> 
> 时间：2012-11-13T23:33:13.597
> 
> 标签：ruby-on-rails

我正在创建一个使用元问题模型来创建报告的报告系统。基本上我有一张桌子，上面有很多问题，如下所示：

变量表：

`id | name | variable_type | description | breakpoint | time_frequency`

现在系统根据报告的时间频率等因素构建报告问题。

现在我有两个表来保存报告：

报告机构表：

`variable_id | report_id | value`

report_heads 表

`id | email | name`

使用此方法，我需要创建报告，然后使用该 ID 保存该报告问题的答案。

我在report_heads 控制器中做了一个after_filter，以某种方式将刚刚创建的id 传递给下一个函数。

`after_filter :go_to_report, :only => :create`

最后是我的空 go_to_report 函数

```
def go_to_report 
    #what to do here?
end 
```

先感谢您。

## 更新

所以，我发现我可以直接从report_head的创建中调用report_bodies的新函数：

```
 format.html { redirect_to :new_report_body, notice: 'Report head was successfully created.', :parameter => @report_head.id } 
```

report_bodies 的新功能是：

```
 def new
    @report_head_id = :parameter
    @report_questions = getDailyVariables
    @report_body = ReportBody.new

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @report_body }
    end
  end 
```

但是，当在视图中我没有收到 report_head 的 id 而是一个简单的字符串

```
<!-- code from the view (_form.html.erg): -->
<%= builder.hidden_field :report_id, :value => @report_head_id %>

<!-- rendered view: -->
<input id="report_bodies_report_id" name="report_bodies[report_id]" value="parameter" type="hidden"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T15:45:27.370

It looks like you're receiving the simple string `"parameter"` because you're setting `@report_head_id` to a symbol `:parameter` in your `new` action.

In the `new` action, try using `@report_head_id = params[:parameter]` instead.

# google-chrome - Chrome 输入[type=submit] 缩放错误

> ID：13370735
> 
> 赞同：0
> 
> 时间：2012-11-13T23:34:20.840
> 
> 标签：google-chrome, button, zooming

因此，当我在 Chrome (23.0.1271.64) 中放大一个无样式的按钮时，按钮文本开始从按钮溢出。这是一个错误吗？存在于所有/早期版本的 Chrome 中？任何简单/快速的解决方法？有关示例，请参见此处：[http ://www.w3schools.com/tags/tryit.asp?filename=tryhtml5_input_type](http://www.w3schools.com/tags/tryit.asp?filename=tryhtml5_input_type)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T23:41:56.403

同样的问题，OSX 10.7.5 上的 Chrome 23.0.1271.95

所有`<input type="submit" />`，`<button />`看起来令人毛骨悚然。文本在元素之外。当我点击“放大”两次时，一切看起来都很好。

我的临时解决方案是使用

```
input[type="submit"], button { -webkit-appearance: square-button } 
```

现在按钮看起来是方形的，但至少文本在里面。

# php - javascript & php not returning proper values to DIV

> ID：13370743
> 
> 赞同：0
> 
> 时间：2012-11-13T23:35:02.030
> 
> 标签：php, javascript, jquery, wamp

I'm using WAMP on a project and am having some difficulties. Basically, I want to click a form submit button which calls a function which requests some data in php. My functions

```
/**********************************************************************************/
//USER LOG IN
$('#cSignIn').click(function(){
    //Get User name and password

    var uname = $('#uName').val();
    var pword = $('#pWord').val();

    loginRequest(uname, pword);

    $('.formList').hide();
    $('#information').show();
    return false;   
});

//LOGIN REQUEST
function loginRequest(uName, pWord){
    if (window.XMLHttpRequest)
        {// code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp=new XMLHttpRequest();
        }
        else
        {// code for IE6, IE5
             xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
        }
    xmlhttp.onreadystatechange=function(){
        if (xmlhttp.readyState==4 && xmlhttp.status==200){
            document.getElementById("rText").innerHTML=xmlhttp.responseText;
        }
    }
    xmlhttp.open("GET","login.php?Username=" + uName +"&Password=" + pWord ,true);
    xmlhttp.send();

    return false;
} 
```

When I try to return the value of rText (my div) using $('#rText').val(); OR $('#rText').text(); it is not what I'm expecting it to be. The php code echos a number, the code for login.php is follows

```
<?php
$con = mysql_connect("localhost:3306","root","");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }
mysql_select_db("Library", $con);

$username=$_GET["Username"];
$password=$_GET["Password"];
$result = mysql_query("SELECT * FROM Customers");
$success = 0;

while($row = mysql_fetch_array($result))
  {
    if($username==$row['Username']) 
        if($password==$row['Password']) 
            if($row['Admin'] == true)
            {
                $success = 1;
            }
            else
            {
                $success = $row['Id'];
            }

  }
echo $success;

mysql_close($con);
?> 
```

Again, when I check the value of rText in either of the functions involved, the value is not expected. However, when I exit the function the value is valid.

How can I have the correct value in rText right after the return from function loginRequest?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T00:45:01.813

First, you can not use $('#rText').val() for a Div, only Form inputs, you should use $('#rText').html() instead

Second, to make your life easier...you can widdle down your Login Request function quite a bit using ajax. Trust me, its not hard to get a grasp of. Here all you need to make an ajax request.

```
//LOGIN REQUEST
function loginRequest(uName, pWord) {

    $.ajax({
        type: "POST", //Post or Get
        url: "/login.php", //PHP page to post to
        data: "Username=" + uName +"&Password=" + pWord, // The values you want to send along to PHP Page
        dataType: "script", // This allows your PHP echo to be actual Javascript / Jquery

     });        
} 
```

And your PHP success functions would be this

```
while($row = mysql_fetch_array($result))
  {
    if($username==$row['Username'])
        if($password==$row['Password'])
            if($row['Admin'] == true)
            {
                $success = "$('#rText').html('1')"; //Echo as Jquery
            }
            else
            {
                $success = "$('#rText').html('" + $row['Id'] + "')"; // Echo as Jquery
            }

  }
echo $success; 
```

Easy enough right??

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T06:38:47.853

First of all you shouldn't be using mysql api anymore, its also discouraged in the php.net website: [http://www.php.net/manual/en/intro.mysql.php](http://www.php.net/manual/en/intro.mysql.php)

While I do not discourage using plain JavaScript to do things, its always good to have some time-savers like jQuery to make life easier. This is how I would rewrite your code in jQuery;

```
function loginRequest(username, password){
  var code = 0;
  $.post('login.php', {'uname' : username, 'pword' : password},
  function(response){
    code = response;
  });
  return code;
} 
```

In your php code you can use prepared statements in mysqli to avoid sql injections:

```
$db = new Mysqli("localhost", "root", "pword", "db"); 
$username = $_POST['uname'];
$password = $_POST['pword'];

if($query = $db->prepare("SELECT COUNT(username) AS usercount FROM Customers WHERE username = ? AND password = ?")){
  $query->bind_para('ss', $username, $password);
  $query->execute();
  $query->bind_result($usercount);
  $query->fetch();
  echo $usercount; 
} 
```

# java - 正则表达式，一句话匹配两个序列

> ID：13370751
> 
> 赞同：0
> 
> 时间：2012-11-13T23:36:11.047
> 
> 标签：java, regex

说有一句话

> 那个山姆-我-是

两个单词以相同的序列“am”结尾，其中第二个序列是最后一个单词。

我需要编写一个正则表达式来匹配这样一个句子，其中的序列可以是任何字母串。

语言是Java。我不太明白的是如何在一个句子中匹配某些内容而忽略其余部分。

这是 Java 测试的准备问题。

谢谢你。

这是我用来测试的代码

```
public static void doMatching(){

    BufferedReader in = new BufferedReader(new InputStreamReader(System.in));

    try {

        String pattern, s;
        System.out.print("Pattern: ");
        pattern = in.readLine();
        while (!pattern.equals("quit")){
            System.out.print("String: ");
            s = in.readLine();
            System.out.println(Pattern.matches(pattern, s));
            System.out.print("Pattern: ");
            pattern = in.readLine();
        }
        } catch (IOException e){
            System.out.println("Error!");
    } catch (Exception e2){
        System.out.println("Unknown!");
    }

}

public static void main(String[] args) {
    // TODO code application logic here

    doMatching();
} 
```

这是结果

```
Pattern: (\\w+\\b).*\\b\\1$
String: that sam-i-am
false 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T23:45:59.500

您正在搜索的正则表达式是：

```
(\w+\b).*\b\1$ 
```

这也包括一个下划线作为一个字母，如果你需要排除你可以使用`[a-zA-Z]`

`\w`匹配任何字母
`+`与前一个表达式匹配 1 次或多次，以贪婪的方式
`\b`匹配单词边界。这是一个零宽度匹配。
`()`分组并保存结果，以便您以后可以使用它作为反向引用
`.`匹配除换行符之外的任何内容
`*`与前一个表达式匹配 0 次或多次，以贪婪的方式
`\1`是第一个反向引用，它匹配捕获的第一件事`()`
`$`是零宽度匹配在字符串的末尾。

零宽度匹配是实际上不包含任何字符的匹配。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T23:46:51.533

```
"(\\w+\\b).*\\b\\1$" 
```

这将匹配单词末尾的一些重要的单词字符，`(\\w+\\b)`并确保它们在字符串末尾匹配为一个完整的单词。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T00:04:38.100

这里还有其他很好的答案，但我认为这仍然更合适：

```
([a-zA-Z]+)\b.+\b\1$ 
```

也许会让人费解，但对于 RegEx，尽可能简洁和深思熟虑是个好主意。

这里的字符范围似乎比`\w`问题的性质要好。我认为最好将第一个单词边界移到捕获组之外。和`.+`vs.`.*`因为*必须*至少存在一个非单词字符（尽管`.*`结合单词边界几乎肯定也会匹配）。

# c# - 为 LocalMessageReceiver 清除 Mac Silverlight 资源

> ID：13370756
> 
> 赞同：3
> 
> 时间：2012-11-13T23:36:29.660
> 
> 标签：c#, macos, silverlight

我有一个用 Silverlight 编写的应用程序，可在 Mac 和 Windows 平台上使用。作为其功能的一部分，它必须只允许运行一个。我们使用[LocalMessageReceiver 方法](http://www.tozon.info/blog/post/2009/11/01/Detecting-duplicate-instances-of-a-running-Silverlight-application.aspx)实现了这一点，它按预期工作。

但是，我们在 Mac 上遇到了问题。如果应用程序崩溃或强制退出，则无法重新启动应用程序，因为单实例代码报告应用程序已在运行。到目前为止，我们发现的唯一办法是重新启动计算机。然而，这充其量是不方便的。

Mac OS X 上有没有办法清除 LocalMessageReceiver 使用的资源而无需重新启动计算机？我假设系统中某处有共享资源，但我没有找到任何文档讨论这些资源是什么或如何重置它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-30T15:48:58.167

嗯......因为没有其他人回答......这是我的解决方法；我无法明确设置代码，但我可以让您了解：

如果您无法在 LocalMessageReceiver() 上收听，可能有两个原因

1.  因为有一个真正的其他 silverlight 实例正在运行
2.  因为发生了崩溃并且资源没有被正确清除

区分原因的技巧是尝试与 LocalMessageReceiver 通信。设置一个 LocalmessageSender，为响应添加一个句柄并尝试发送消息。

“真正的”其他 silverlight 实例会回复。崩溃剩余没有。所以你可以等待一个合理的超时来回复。

如果没有（所以这是崩溃），你有一些策略：例如，你可以设置一个新的 LocalMessageReceiver （带有“后备”名称）来检查其他实例或类似的东西。

# c# - 'LogManager' 是 .LogManagers 之间的模棱两可的引用

> ID：13370757
> 
> 赞同：1
> 
> 时间：2012-11-13T23:36:30.787
> 
> 标签：c#, logging, nlog, common.logging

我收到错误消息，“错误 19 'LogManager' 是 'Common.Logging.LogManager' 和 'NLog.LogManager' 之间的模糊引用”。

在 C# 2008 应用程序中，我试图将 nlog 开源日志记录工具添加到已经使用从以下位置获得的 common.logging 的应用程序：http: [//netcommon.sourceforge.net](http://netcommon.sourceforge.net)。

我添加了对 NLog 文件的引用，并将 Nlog 添加到 using 语句中。

问题是这两个工具都使用了一个名为“LogManager”的对象。

因此，您能告诉我如何解决我的问题，以便我可以同时使用这两个 Logmanager。

以下是我在下面列出的代码： xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

```
 using System;
     using System.Collections.Generic;
     using System.Linq;
     using System.Text;
     using Common.Logging;
     using sample;
     using System.Configuration;
     using System.Xml.Linq;  
     using NLog;

namespace sample
{
  public class Etest
  {
    private static Logger logger = LogManager.GetCurrentClassLogger(); 
    private static ILog log = LogManager.GetCurrentClassLogger();
  }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T23:41:15.910

你只需要确保*调用*是合格的。

```
public class Etest
{
   private static Logger logger = NLog.LogManager.GetCurrentClassLogger(); 
   private static ILog log = Common.Logging.LogManager.GetCurrentClassLogger();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T23:42:41.773

`using`您可以通过指令为其中之一定义别名，或使用全名。

但如果您使用 Common.Logging，我认为您不需要参考 NLog。因为 Common.Logging 库引入了一个简单的抽象，允许您在运行时选择特定的日志记录实现。因此，**您的代码应该只依赖于 Common.Logging 库**，而不是其他一些日志系统，如 log4net 或 NLog：

```
using Common.Logging; // only this library is used
...
ILog log = LogManager.GetCurrentClassLogger(); 
```

并配置 Common.Logging 以使用 NLog ：

```
<configuration>
  <configSections>
    <sectionGroup name="common">
      <section name="logging" 
               type="Common.Logging.ConfigurationSectionHandler, Common.Logging" />
    </sectionGroup>    
    <section name="nlog" 
             type="NLog.Config.ConfigSectionHandler, NLog"/>
  </configSections>

  <common>
    <logging>
      <factoryAdapter type="Common.Logging.NLog.NLogLoggerFactoryAdapter, Common.Logging.NLog">
        <arg key="configType" value="INLINE" />
      </factoryAdapter>
    </logging>
  </common>

  <nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <targets>
      <target name="console" xsi:type="Console" 
              layout="${date:format=HH\:MM\:ss} ${logger} ${message}" />
    </targets>
    <rules>
      <logger name="*" minlevel="Debug" writeTo="console" />
    </rules>
  </nlog>
</configuration> 
```

# html - 得到 元素填充父div中的剩余高度？

> ID：13370759
> 
> 赞同：3
> 
> 时间：2012-11-13T23:36:55.680
> 
> 标签：html, css

我有一个画布，我想在一段文字下显示它。包含文本和画布的父 div 的显式高度为 200 像素。我希望画布只填充文本 div 下方剩余的任何高度，例如：

```
----------------------------
|  label div               |
----------------------------
|                          |
|  canvas                  |  entire height of parent
|  fill in rest of height  |  div should be 200px.
|  (height = 100%)         |
|                          |
---------------------------- 
```

这是我尝试过的：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
   <head>
      <style type="text/css">
         html, body {
           margin: 0px;
           padding: 0px;
         }
         canvas {
           width:50px;
           height:100%;
         }
      </style>
   </head>
   <body>
      <div style="background-color: rgb(255, 200, 0); width:100%; height: 200px;">
         <div>hello</div>
         <canvas style="background-color: rgb(0,255,128);">
         </canvas>
      </div>
   </body>
</html> 
```

但请注意画布元素如何溢出父 div 的底部：

![在此处输入图像描述](../Images/b6a5c10fe8af02c08532b1d449cb1718.png)

有没有办法让画布填充剩余空间而不会溢出？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T23:46:53.383

您可以为容器上方的 div 创建一个标签类，并为其指定高度百分比并将画布设置为剩余高度。我用你的代码做了一个例子：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
   <head>
      <style type="text/css">
         html, body {
           margin: 0px;
           padding: 0px;
         }
         canvas {
           width:50px;
           height:90%;
         }
         .label {
        height: 10%;
         }
      </style>
   </head>
   <body>
      <div style="background-color: rgb(255, 200, 0); width:100%; height: 200px;">
         <div class="label">hello</div>
         <canvas style="background-color: rgb(0,255,128);">
         </canvas>
      </div>
   </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T01:58:13.990

也许尝试这样的事情：

```
 ... 
 <div style="background-color: rgb(255, 200, 0); width:100%; height: 200px; overflow: hidden">
 ... 
```

注意添加的 css 规则溢出：隐藏

这是 css 规则溢出的完整使用文档 [http://www.w3.org/TR/CSS21/visufx.html](http://www.w3.org/TR/CSS21/visufx.html)

# jpa - Spring Data Repository + JPA + Date + Oracle

> ID：13370761
> 
> 赞同：1
> 
> 时间：2012-11-13T23:37:13.347
> 
> 标签：jpa, spring-data, spring-data-jpa

我在实体类中有一个 java.util.Date 类型的 lastUpdated 字段。我在存储库接口中定义了方法 findByLastUpdated(Date date, Pageable pageable) 和 findByLastUpdatedGreaterThan(Date date, Pageable pageable)，但它们不能正常工作。检查日志我注意到使用了字符串比较：

```
where table0_.LAST_UPDATED>'2012-03-26 03:03:08.0' 
```

使用的数据库是 Oracle，所以我认为更好的比较方法是使用 to_date 函数。我也许可以使用本机查询选项来做到这一点，但这不支持分页。关于如何让方法 findByLastUpdated 和 findByLastUpdatedGreaterThan 正常工作的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T11:18:55.323

使用 @Query 注释自己编写查询

[http://static.springsource.org/spring-data/data-jpa/docs/current/reference/html/#jpa.query-methods.at-query](http://static.springsource.org/spring-data/data-jpa/docs/current/reference/html/#jpa.query-methods.at-query)

会议 2.2.4

# r - 在 R 中估计多项概率模型

> ID：13370767
> 
> 赞同：3
> 
> 时间：2012-11-13T23:37:39.193
> 
> 标签：r

我在估计 R 中的多项概率模型时遇到了麻烦。我找到了两个包，但我都没有得到令人满意的结果。我的代码中有错误吗？我是否错误地使用了这些软件包？

一个小例子：

消费者面临 3 个选择，以及不选择任何选择的外部选择。外部选项的效用归一化为零：

```
u_i0 = 0
u_i1 = -20 + 1*age_i + epsilon_i1
u_i2 = 0             + epsilon_i2
u_i3 =  15 - 1*age_i + epsilon_i3 
```

（这里我索引消费者。）

代码，其中（假设没有错误）年龄在 11:50 是统一的，并且 epsilon 是 iid Normal(0, 1)，与年龄无关：

```
library(MNP)  # Multinomial probit
library(mlogit)  # Has a probit option

n <- 1000
df <- data.frame(age=sample(11:50, replace=TRUE, size=n))
constant <- c(-20, 0, 15)
coefficients <- rbind(c(1, 0, -1))
epsilon <- matrix(rnorm(n*3), nrow=n, ncol=3)
utility <- (matrix(rep(constant, n), nrow=1000, ncol=3, byrow=TRUE) +
            as.matrix(df) %*% coefficients + epsilon)
isTRUE(all.equal(utility[1, ], as.vector(constant + coefficients * df$age[1] +
                                         epsilon[1, ])))  # True as expected
df$choice <- max.col(utility)
max.utility <- apply(utility, 1, max)
df$choice[max.utility < 0] <- 0  # Take outside option when all product utilities < 0
df$choice <- factor(df$choice)
table(df$choice)

model.mnp <- mnp(choice ~ age, data=df, burnin=100)
summary(model.mnp)  # Many of the 95% intervals don't contain the true value

model.mlogit <- mlogit(choice ~ 0 | age, data=df,
                       varying=NULL, shape="wide", probit=TRUE)
summary(model.mlogit) 
```

我希望模型能够恢复系数，但 mnp 的估计似乎不正确（或者它们只是非常嘈杂？），并且 mlogit 给我一个错误，说系统在计算上是奇异的。

我应该尝试什么？

编辑：这确实有效（probit=FALSE）：

```
model.mlogit <- mlogit(choice ~ 0 | age, data=df, varying=NULL, shape="wide", probit=FALSE)
summary(model.mlogit) 
```

它给出了大约 -30、0、22 的常数和 1.5、0、-1.4 的年龄系数。代码运行并给出了合理的估计——但它们并不完全正确，因为生成的数据带有正常错误，而要正确指定 logit，错误必须是极值（参见[http://en .wikipedia.org/wiki/Logistic_regression#As_a_latent-variable_model](http://en.wikipedia.org/wiki/Logistic_regression#As_a_latent-variable_model)）

# google-fusion-tables - 每个单元格具有多个值的 Google Fusion Tables 挑战

> ID：13370768
> 
> 赞同：0
> 
> 时间：2012-11-13T23:37:44.083
> 
> 标签：google-fusion-tables

在兜了一圈圈之后，我几乎已经确定了我的工作项目，最终我开始涉足 Google Maps 和 Fusion 表格示例，使用[Derek Eder 的可搜索模板示例](http://derekeder.com/searchable_map_template/demo/index.html). 我的挑战在于复选框，更重要的是融合表和查询中的数据。Derek 的示例（参见链接）仅依赖于名为“Type”的列，该列在任何给定行中都包含一个数字。现在我有相同的列，但我的挑战在于它可以包含多个单个数字。所以'1,3'或'2,3'或'1,2,4,5'。在我的情况下，表明商店销售这些类型的产品，其中 1 可能是包，3 可能是网球拍等。现在我今晚无法确定这个查询和代码，时间紧迫，所以我不得不来到 StackOverflow 并向您寻求帮助。目前，它没有

从数据布局来看，将其输出为带有 1 或 0 的单独列相对简单，但我严格遵循 Derek 的示例，因为他甚至在代码中添加了注释。

好吧，无论如何，希望你们已经掌握了它。如果您需要链接，请告诉我，但目前我几乎没有离开 Derek 的示例，尽管我不需要这样做。

在此先感谢，理查德。

* * *

感谢您的回复。在这种情况下，数据库是导入到 Fusion Tables 的标准电子表格。我很欣赏你所说的，但这不是一个选项，因为这是我们在这里讨论的 Excel，并且该文件是从营销部门传递下来的。

我拥有的融合表的当前格式是沿着这些线

```
accountid | add1 | add2 | add3 | poastcode | prodtype1 | prodtype2 | prodtype3 |     prodtype4 
==========================================================================================
 123456     blah   blah   blah   SG18 1DF      1             1          0           0
 234567     blah   blah   blah   SG18 2DF      0             0          1           0 
```

我只是看看是否可以使用 Derek Eder 的搜索模板示例将上述内容翻译为使用他的特定过滤说明。所以下面是一个想法。

```
accountid | add1 | add2 | add3 | poastcode | type |
===================================================
 123456     blah   blah   blah   SG18 1DF    1,2,4 
```

或者如果这不起作用，

```
accountid | add1 | add2 | add3 | poastcode | type |
===================================================
 123456     blah   blah   blah   SG18 1DF    1 2 4 
```

我对实施您的建议有很大的担忧，因为它实际上超出了该项目的范围，并且连接表也不会简单地增加总记录数，从而错误地增加记录数。我不想解决一个挑战然后再创造另一个挑战。

希望你欣赏我在哪里。我只需要将它保存在电子表格世界中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T09:51:42.223

如果你从数据库的角度来看你的问题，你不应该使用单个单元格来包含多个值，因为它只会给你带来麻烦和麻烦。有时提高性能可能是个好主意，但只有在你知道自己在做什么的情况下才会出现这种情况:-)

您的问题可以通过两张表轻松解决。您的第一个表包含您当前的数据，第二个表用于将您的数据映射到一个或多个类型。

1.  数据

    ```
    data_id | data | location
    ===========================
       1    |  xy  | somethere 
       2    |  az  | moon
      31    |  bla | elm street 
    ```

2.  映射到类型

    ```
    data_id | type
    ================
       1    |  1
       1    |  3
       1    |  4
      31    |  2 
    ```

3.  然后你可以[JOIN 两个表](http://en.wikipedia.org/wiki/Join_%28SQL%29)来得到想要的结果：

    ```
    data_id | data | location   | type
    ===================================
       1    |  xy  | somethere  | 1
       1    |  xy  | somethere  | 3
       1    |  xy  | somethere  | 4
       2    |  az  | moon       |
      31    |  bla | elm street | 2 
    ```

在 Google Fusion Tables 中，您可以[通过合并两个表来连接它们](http://support.google.com/fusiontables//answer/171254)，这等于 a `LEFT OUTER JOIN`。

After that you have again the *old* setting with only one type per cell, but you're able to express that one row has multiple types.

# html - 内联 SVG - 通常用于 < img > SEO 的“alt”标签的最佳替代品？

> ID：13370770
> 
> 赞同：16
> 
> 时间：2012-11-13T23:37:47.307
> 
> 标签：html, optimization, seo, search-engine

假设我要在我的主站点标题中换出一个`<img>`来使用 SVG。通常我会依赖`<img>`'s alt 标签。

SVG`<title>`是这种类型转换的“alt”的最佳替代方法吗？

```
<svg role="img" aria-label="title + description here]">
  <title>[title here]</title>
  <desc>[long description here]</desc>
  ...
</svg> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-03-25T17:25:21.237

这些年来我研究了很多508。对于极少的开销，您将花费您为 svg 图像创建替代文本属性，它真的不值得跳过它。请记住，所有屏幕阅读器都是不同的，它们的用户也是如此。SVG 有很多可以利用的能力，但我们还没有。是的，Google 会为您图片中的文字编制索引，但如果您关心视力不佳的用户能够全面访问您的内容，您应该添加一个 alt 标签。它实际上是辅助功能的底层。让低垂的果实在藤上腐烂是没有意义的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-30T00:22:32.607

根据[SVG Open](http://www.svgopen.org/2004/papers/SVGOpen2004MakingGraphicsAccessible/)，`<title>`必须由例如盲人的屏幕阅读器支持，但[StackOverflow](https://stackoverflow.com/questions/4697100/accessibility-recommended-alt-text-convention-for-svg-and-mathml)上已经讨论了一些解决方法<--这**是您的答案**，这个主题可能是重复的？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-30T00:10:56.347

我对这个问题也很感兴趣。到目前为止，我最好的猜测是`<img>`在页面代码中使用带有 alt 标记的 an，然后使用 javascript 将 img 替换为内联的实际 svg 代码。您可以检查[此答案](https://stackoverflow.com/a/11978996/1262357)以获取将 img 替换为 svg 内联内容的小脚本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-12-01T17:34:45.823

绝对最好从 SVG 中提取 SVG`<img src="" alt="">`以获得 SVG + 简单 SEO 的所有好处。谷歌蜘蛛很可能知道 SVG 的标题*应该*是 alt 标签，但不能保证，我敢肯定他们有很多不知道的爬虫。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-13T23:50:26.627

如果 SEO 是您主要关心的问题，为什么不从 img 元素的 src 属性中引用 SVG？它肯定比内联 SVG 实现得更广泛，所以在这种情况下它可能是更好的选择。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-08T11:00:51.567

这行得通吗？

```
<svg role="img" id="my-svg-img">

  ...
</svg>

<img src="#my-svg-img" alt="Hey hey, kids!" > 
```

（或者，如果您发现您的`<title>`方法有效，那么您是否可以很好地发布作为答案？我现在有点在黑暗中摸索着同样的问题）

# eclipse-emf - Eclipse EMF：如何按名称访问 EAttribute？

> ID：13370773
> 
> 赞同：4
> 
> 时间：2012-11-13T23:38:05.407
> 
> 标签：eclipse-emf, emf

我有一个传递字符串和 EMF EObject 的 Java 方法。String 是 EObject 属性的名称。例如，如果传递了“foo”和 EObject eobj，则需要访问 eobj.getFoo()。我知道如何从其 featureID 中获取 EAttibute 的值，但似乎无法找到通过属性名称获取它的方法。这甚至可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T03:38:05.610

以下应该可以解决问题，但它一点*也不优雅*。它获取`eClass`your 的`eObject`，按名称查找匹配的属性定义并访问它。这里`getEAllAttributes()`使用的还包括父类定义的属性。

```
 EObject eObject = null;
    String attributeName = "";
    EDataType resultingDataType = null;
    EList<EAttribute> eAllAttributes = eObject.eClass().getEAllAttributes();
    for (EAttribute eAttribute : eAllAttributes) {
        if (eAttribute.getName().equals(attributeName)) {
            resultingDataType = (EDataType) eObject.eGet(eAttribute);
        }           
    }
    System.out.println(resultingDataType); 
```

# c++ - 使用 angelscript 编译错误

> ID：13370774
> 
> 赞同：1
> 
> 时间：2012-11-13T23:38:10.430
> 
> 标签：c++, angelscript

我正在尝试使用 angelscript 2.25.1 使用 gcc 4.7.1

我编译 angelscript 没有问题。

但是，当我尝试编译使用 angelscript 的项目时，出现此错误：

```
jarrett@jarrett-g74s:~/projects/myproject$ scons
scons: Reading SConscript files ...
scons: done reading SConscript files.
scons: Building targets ...
g++ -o build/common/as_wrapper/AngelScript.o -c -I"../lwis/src/engine" -I"../ice_engine/src/engine" src/common/as_wrapper/AngelScript.cpp
src/common/as_wrapper/AngelScript.cpp: In member function ‘void as_wrapper::AngelScript::loadScripts()’:
src/common/as_wrapper/AngelScript.cpp:85:33: warning: deprecated conversion from string constant to ‘char*’ [-Wwrite-strings]
src/common/as_wrapper/AngelScript.cpp:87:30: warning: deprecated conversion from string constant to ‘char*’ [-Wwrite-strings]
src/common/as_wrapper/AngelScript.cpp:88:31: warning: deprecated conversion from string constant to ‘char*’ [-Wwrite-strings]
src/common/as_wrapper/AngelScript.cpp: In member function ‘int as_wrapper::AngelScript::initContext(char*, char*)’:
src/common/as_wrapper/AngelScript.cpp:242:20: error: ‘class asIScriptModule’ has no member named ‘GetFunctionIdByDecl’
src/common/as_wrapper/AngelScript.cpp:258:22: error: invalid conversion from ‘int’ to ‘asIScriptFunction*’ [-fpermissive]
In file included from src/common/as_wrapper/AngelScript.h:11:0,
                                 from src/common/as_wrapper/AngelScript.cpp:8:
/usr/local/include/angelscript/angelscript.h:734:26: error:   initializing argument 1 of ‘virtual int asIScriptContext::Prepare(asIScriptFunction*)’ [-fpermissive]
scons: *** [build/common/as_wrapper/AngelScript.o] Error 1
scons: building terminated because of errors. 
```

所以基本上，它（我猜是编译器）`GetFunctionIdByDecl`在`asIScriptModule`. 我很确定它应该在那里。

此外，lin 242 上的代码是：

```
int funcId = mod->GetFunctionIdByDecl(function); 
```

where`function`之前声明为 a`char*`并且`mod`是 类型`asIScriptModule *mod`。

我认为这可能是 gcc 4.7.1 的问题......但我不确定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T00:30:43.907

感谢@chris 的回答。

> 根据来源（angelscript.h 第 664 行），GetFunctionIdByDecl 已被弃用，因此您需要 #define AS_DEPRECATED 才能使用它。

# c# - Windows XP 的 .NET 进程问题

> ID：13370777
> 
> 赞同：4
> 
> 时间：2012-11-13T23:38:23.537
> 
> 标签：c#, .net, process, windows-xp

首先，我使用自己的 Process Wrapper 来保存进程的起始路径。

```
public class MCProcess()
{
       public Process Process { get; set;}
       public string  StartingPath { get; set;}

       public MCProcess(string start, Process p)
       {
             Process = p;
             StartingPath = start;
       }
} 
```

现在，我一直有一个`List<MCProcces>`名为 runningProcesses，我用它来跟踪我的程序已启动的每个进程的所有进程和启动路径。

例如：

```
string path = "C:\\Windows\\System32\\notepad.exe";
Process temp = Process.Start(path);
runningProcesses.Add(new MCProcess(path, temp)); 
```

现在，有时，我想关闭我已经运行的进程。我没有查看任务管理器并试图找到我启动的每个进程的 MainModuleName，而是出于某种原因包含了 StartingPath。

如果我想关闭记事本，我只需遍历我的运行进程，找出哪个进程具有记事本的起始路径，然后使用 Process.Kill 终止该进程。

```
string path = "C:\\Windows\\System32\\notepad.exe";
for (int i = 0; i < runningProcesses.Count; i++)
{
     if (runningProcesses[i].StartingPath == path)
     {
          runningProcesses[i].Process.Kill();
          runningProcesses.RemoveAt(i);
     }
} 
```

此代码在 Windows 7 上运行良好，我完全没有问题。但是，在 Windows XP 上使用它时，我得到一个带有 Process.Kill 的 ArgumentNullException。

Process 类有什么东西不能让它在 Windows XP 上正常工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T13:24:44.307

很惊讶这在 win 7 中是如何工作的。您正在修改一个集合，同时在循环中使用它。您应该维护要删除的进程的索引，然后在循环完成后，删除所有进程

尝试类似的东西

```
var processesToRemove = runningProcesses.Where (p => String.Equals(p.StartingPath, path);
foreach(var process in processToRemove)
{
  process.Process.Kill();
  runningProcesses.Remove(process);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T12:58:38.377

尝试公开您的属性：

```
Public Process Process { get; set;}
Public string  StartingPath { get; set;} 
```

然后像这样杀死你的进程：

```
for (int i = 0; i < runningProcesses.Count; i++)
{
    if (runningProcesses[i].StartingPath == path)
    {
          runningProcesses[i].Process.Kill();
    }
} 
```

# ros - 如何在不影响其功能的情况下更改 ROS 文件夹的路径？

> ID：13370782
> 
> 赞同：2
> 
> 时间：2012-11-13T23:39:23.407
> 
> 标签：ros

我想更改 ROS 文件夹位置。

当前目录为：root/opt/ros

但如果我只是移动它（剪切、粘贴），ROS 就不起作用

如何将它移动到我的桌面（让 ROS 仍在工作）？

（我有 ROS Diamondback）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-20T16:43:58.790

ros 写入安装 ros 的 .bashrc 中，以便在需要时查看此文件夹。您可以更改 .bashrc 并将 ROS_PACKAGE_PATH 设置为要设置为 ros 文件夹的新路径，或者在 ros 文件夹中更改 setup.bash。也许，在 .bashrc 中，调用该文件来设置 ros 变量，您可以编辑该文件并将 ROS_PACKAGE_PATH 更改为您将放置 ros 目录的路径。

另一个提示，如果你想向 ros 添加更多文件夹（更多可以查找包的文件夹），只需设置 ROS_PACKAGE_PATH=$ROS_PACKAGE_PATH:new/directories/you/want

我希望它有帮助！

# java - 跨组 (XG) 事务中超过 5 个实体组

> ID：13370783
> 
> 赞同：1
> 
> 时间：2012-11-13T23:39:24.787
> 
> 标签：java, google-app-engine, jdo, datanucleus

背景：

我最近在 GAE SDK 1.7.3 中更新到 JDO 2.0 / Datanucleus 3.1.1。我有二级缓存到 memcache，我发现当我对子实体执行某些操作时，我在缓存中看到了陈旧的数据。例如，当我从一个集合中删除一些孩子时，稍后再添加新的孩子，然后它会更新数据存储区，但不会更新缓存，因此后续读取会发回陈旧的数据。

无论如何，这是一个单独的问题 - 我的解决方法是将更新放入事务中，以便缓存条目无效并删除（事务不会将更改写入内存缓存）。

这行得通。但是，我有很多无主关系，所以有时我会更新超过 5 个实体组 - 例如，我执行批量标记操作，将整个行负载标记为“完成”。奇怪的是 IT WORKS，尽管它在 Google 文档中明确指出 XG 交易仅限于 5 个实体组。我在这里错过了什么吗？

我还应该提到，我没有明确地为 JDO 启用 XG 事务 - 再次，它似乎工作。日志表明它实际上是在进行交易。

我只是有点困惑。这可能会在未来停止工作吗？JDO 是否以某种方式管理事务的大小？XG 事务是由最新的 JDO 自动管理，还是默认打开？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T01:10:08.200

我不确定这是否是一个答案，但我可以告诉你，5 个实体组的限制肯定是强制执行的（或者至少从 SDK 1.7.1 开始），因为我已经多次与之抗争。

首先，您确定您的 jdoconfig.xml 中没有以下内容：

```
<property name="datanucleus.appengine.datastoreEnableXGTransactions" value="true"/> 
```

我的模型中还有许多无主关系，我绕过实体组限制的解决方案是将多个对象放在同一个实体组中。基本上我有一些类似的东西：

```
X -- has a -- A
  \- has a -- B
  \- has a -- C 
```

但是 A 也是 B 的父级，B 是 C 的父级 - 因此只有 2 个实体组，即使与 X 的所有关系都标记为 @Unowned。

顺便说一句，这也意味着你只需要坚持 A。

由于您没有分享您的对象模型的任何细节，我不能说这是否与您所拥有的一样......

# matlab - 绘制多个图

> ID：13370788
> 
> 赞同：2
> 
> 时间：2012-11-13T23:39:47.697
> 
> 标签：matlab, plot, gnuplot, octave

我有一些在 Octave 中运行的代码（但在 matlab 下运行得非常好），它为我生成了我正在运行的物理实验的图。我已经决定，如果我可以通过使用我的旧代码但每次读取不同的数据文件（我用不同的程序生成这些）来生成数百个这样的图，那将是一件好事。

所以我拿了我的旧代码：

```
for u=1:2

f=num2str(u)

xdim=801;
ydim=801;

%ask matlab to create a figure

figure;

filename=strcat('data',f,'.txt')

field=load(filename);

xx=field(:,1); 
yy=field(:,2); 
zz=field(:,3); 

for i=1:xdim
    x1p(i)=xx((i-1)*ydim+1); 
    for j=1:ydim
      z1p(j,i)=(zz((i-1)*ydim+j));
    end
end 

for k=1:ydim
  y1p(k)=yy(k);
end

grid off; 
axis on; 
axis equal; 

%--------------------
% surface plots
%-------------------

surf(x1p,y1p,z1p);

colorbar(); %put a colorbar showing mapping 
                  %between colors and values

title_str=strcat("A map of the Electric Field Strength: m=-5 to 5 eps=100 wa/c=",f)
title(title_str); 
xlabel("x");
ylabel("y"); 

shading interp;   %gives usually best view interpolates between grids
colormap('jet');  %choose the colormap other options hsv,cool,hot e.t.c.

jpg_str=strcat('surf_',f,'.jpg')

print -djpeg jpg_str
end 
```

只需将其全部放在最初的 for 循环中即可。不幸的是，这个错误，返回：

```
multiplot> unset view;
^
line 0: Unrecognized option.  See 'help unset'. 
```

我不知道如何解决这个问题，因为我不希望在一个图像中有多个图，这就是 multiplot 的用途。我该如何解决这个问题？

谢谢你的帮助！

# java - GetServletContext 在扩展 HttpServlet 的类中返回 null

> ID：13370789
> 
> 赞同：0
> 
> 时间：2012-11-13T23:39:55.550
> 
> 标签：java, servlets

所以我有一个扩展 HttpServlet 的类，我试图访问在不同类中设置的变量，这些类已经实现了 ServletContextListener。

但是，扩展 HttpServlet 的类中的以下代码行给了我 NullPOinterException：

```
SomeObject x =  getServletContext().getAttribute("x"); 
```

我不明白为什么会这样。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T00:17:12.157

可能，您已经覆盖了 Servlet 类中的 init(ServletConfig cfg) 方法，并且没有调用 super.init(cfg) 来执行标准设置，从而导致上下文为空。

# ios - UIMarkupTextPrintFormatter 打印额外的空白页

> ID：13370794
> 
> 赞同：11
> 
> 时间：2012-11-13T23:40:23.387
> 
> 标签：ios, printing

当使用 UIMarkupTextPrintFormatter 打印几行简单的 HTML 时，它首先输出一个空白页，然后是带有文本的页面。代码如下，非常简单：

```
- (void) printSomething;
{
    if (![UIPrintInteractionController isPrintingAvailable])
        return;

    NSString* markupText =@"<html><body>THIS IS A TEST</body></html>";

    UIMarkupTextPrintFormatter* printFormatter =[ [ [UIMarkupTextPrintFormatter alloc] initWithMarkupText:markupText] autorelease];

    UIPrintInteractionController* printInteractionController =[UIPrintInteractionController sharedPrintController];
    printInteractionController.printFormatter =printFormatter;
    printInteractionController.delegate =self;  
    //printInteractionController.showsPageRange =YES;       

    [printInteractionController presentAnimated:YES completionHandler:nil];                                 
} 
```

现在，如果我取消注释*showsPageRange =YES*，将按预期打印单页，但 UIPrintInteractionController 需要几秒钟才能出现。足以让用户怀疑应用程序是否冻结。

UIMarkupTextPrintFormatter 文档的第一行声明“ *UIMarkupTextPrintFormatter 类的实例为多页打印作业布置 HTML 标记文本*”。如果格式化程序打印多页，不管内容如何，​​这会有点疯狂......

知道这里有什么问题吗？其他应用程序这样做没有任何问题。提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-11-27T09:08:42.847

我通过拥有正确的 HTML 框架解决了这个问题：

```
NSString *htmlString = "<!DOCTYPE html><html><head><meta charset='UTF-8'><title>Title</title></head><body>Hello!</body></html>" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-01T15:36:15.573

我在出现第二个空白页时遇到了同样的问题，并在[此处](http://developer.apple.com/library/ios/documentation/2ddrawing/conceptual/drawingprintingios/drawingprintingios.pdf "Drawing and Printing Guide for iOS")`printInteractionController.showsPageRange = NO;`找到了 Apple 示例（第 67 页）。就这个：

```
- (IBAction)printContent:(id)sender {
    UIPrintInteractionController *pic = [UIPrintInteractionController
                                         sharedPrintController];
    pic.delegate = self;
    UIPrintInfo *printInfo = [UIPrintInfo printInfo];
    printInfo.outputType = UIPrintInfoOutputGeneral;
    printInfo.jobName = self.documentName;
    pic.printInfo = printInfo;
    UIMarkupTextPrintFormatter *htmlFormatter = [[UIMarkupTextPrintFormatter alloc] initWithMarkupText:self.htmlString];
    htmlFormatter.startPage = 0;
    htmlFormatter.contentInsets = UIEdgeInsetsMake(72.0, 72.0, 72.0, 72.0); // 1 inch margins
    pic.printFormatter = htmlFormatter;
    pic.showsPageRange = YES;
    void (^completionHandler)(UIPrintInteractionController *, BOOL, NSError *) =
    ^(UIPrintInteractionController *printController, BOOL completed, NSError
      *error) {
        if (!completed && error) {
            NSLog(@"Printing could not complete because of error: %@", error);
        } };
    if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad) {
        [pic presentFromBarButtonItem:sender animated:YES
                    completionHandler:completionHandler];
    } else {
        [pic presentAnimated:YES completionHandler:completionHandler];
    }
} 
```

此示例使用`printInteractionController.showsPageRange = YES;`, 并且工作正常，但如果将此行替换为

`printInteractionController.showsPageRange = NO;`，它会打印额外的第二个空白页。

所以它似乎`UIMarkupTextPrintFormatter`隐含地打算与 一起使用`printInteractionController.showsPageRange = YES;`，或者它只是一个 API 错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-22T07:37:49.117

我遇到了同样的问题，我发现它是由 html 代码引起的

```
style='page-break-after:always; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-12-16T16:40:08.203

正如@Hassy 在他的回答中提到的那样，问题可能出在 html/css 代码上。

就我而言，我的设置`html, body {min-height: 100%;}`可能与一些边距/填充效果不佳，但问题可能与 css 相关。
将 a 设置`background-color`为`body`将有助于检查这是否确实是问题（如果颜色在“空白”页面上重叠，则问题出在样式上）。

# jquery - 使用 jquery 连接动态下拉列表中的选定值

> ID：13370795
> 
> 赞同：0
> 
> 时间：2012-11-13T23:40:42.660
> 
> 标签：jquery, asp.net-mvc-3, drop-down-menu

问题：

如何从每个下拉列表中获取值并将它们连接起来以从这些值创建字符串？这些下拉列表是动态生成的，因此我无法通过 ID 等选择它们。

细节：

根据所选产品，我有一个关于 n 个下拉列表的列表。每个下拉列表都与零件编号中的一个字符相关，因此无论选择哪个都会将字符串构建到变量中以创建零件编号，即“B119”编辑（包括代码）：

```
 <dt>
    <dd>
        <select class="ddlmain" name="product_attribute_180_3_17" id="product_attribute_180_3_17">
            <option value="0">---</option>
            <option value="B">Blue</option>
            <option value="G">Green</option>
            <option value="R">Red</option>
        </select>
    </dd>
</dt>
<dt>
    <dd>
        <select class="ddlmain" name="product_attribute_180_1_18" id="product_attribute_180_1_18">
            <option value="0">---</option>
            <option value="119">Left</option>
            <option value="120">Right</option>
            <option value="121">Center</option>
        </select>
    </dd>
</dt> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T00:17:58.520

1.  您可以为下拉列表组指定一个特定的类名。
2.  使用类名作为选择器。迭代它们并获得它的价值。将值连接到变量。

在我看来，你的 html 会是这样的：

```
<select class="dropdownCode code_1" id="code_1">
    <option value="">select</option>
    <option value="1">one</option>
    <option value="2">two</option>
    <option value="3">tiga</option>
</select>    

<select class="dropdownCode code_2" id="code_2">
    <option value="">select</option>
    <option value="alpha">alpha</option>
    <option value="omega">omega</option>    
</select>    

<select class="dropdownCode code_3" id="code_3">
    <option value="">select</option>
    <option value="X">X</option>
    <option value="Y">Y</option>
    <option value="Z">Z</option>
</select>    

<button class="create">Create</button> 
```

jquery是这样的：

```
var returnVal = '';
$('.create').click(function() {
   $('.dropdownCode').each(function() {
       returnVal += $(this).val();
   });                    
   alert(returnVal);
}); 
```

# web-applications - 制作网页供研究人员编辑和发表论文的框架或技巧

> ID：13370796
> 
> 赞同：1
> 
> 时间：2012-11-13T23:40:48.433
> 
> 标签：web-applications, web

现在，我正在为一组研究人员创建一个网站，用于编辑他们的论文，评论其他人的论文，并在论文准备好时发表论文

我想知道是否有任何框架可以使其更容易构建，或者为此使用什么语言。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T14:34:38.993

我只能推荐简单的东西，比如 Sinatra (Ruby) 或 Node.js (Javascript)。

有许多预先构建的 gems/modules 可以帮助处理用户、数据库等问题。

# visual-studio - Visual Studio 工具 - 按指定标记对解决方案文件进行分组

> ID：13370804
> 
> 赞同：0
> 
> 时间：2012-11-13T23:41:37.700
> 
> 标签：visual-studio

我正要在我正在开发的 crud 系统中添加另一个实体。在我正在使用的架构中，一个实体将有几个共同的元素。实体本身、nHibernate 映射、写入服务、读取服务、控制器、crud 视图（列表、编辑）。

所有这些文件都变得有点痛苦。它们位于不同的命名空间、不同的程序集中，要找到它们，我必须在解决方案资源管理器中浏览其他所有内容。我在想，如果我可以标记这些文件（通过道具窗口），然后有一个类似于解决方案资源管理器的项目视图，我可以将其过滤为仅具有指定标记的文件，这将是非常棒的。这将使我在实现实体时跳过这些文件成为一种不那么令人不快的体验。

有谁知道可以解决这个问题的现有扩展？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T13:47:39.543

像[vstags codeplex这样的东西怎么样](http://vstags.codeplex.com/)

这就是你的想法吗？

# windows-7 - AIR 本机进程不会启动可执行文件错误 #3214 或错误 #3219

> ID：13370805
> 
> 赞同：0
> 
> 时间：2012-11-13T23:41:41.893
> 
> 标签：windows-7, air, air-native-extension

把我的头发拉出来。我正在使用

```
<supportedProfiles>extendedDesktop </supportedProfiles> 
```

在应用程序描述符中

我的路径对可执行文件是正确的（检查代码中是否存在）

还要确保我对我的可执行文件授予完全权限，但我仍然收到以下错误之一，并且可执行文件不会启动！

```
Error #3214 or Error #3219 
```

此外，当我收到错误 #3219 时，有时会收到

```
Error #3219: The NativeProcess could not be started. 'The requested operation requires elevation. 
```

如果我从桌面双击可执行文件，它当然可以工作。

```
>>>>>>Arrgh!! 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T23:52:06.473

试试这样：

```
<supportedProfiles>desktop extendedDesktop</supportedProfiles> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T16:13:25.923

我的可执行文件是一个打包的 perl 文件，它运行一个 CHDK 被黑的相机。

需要将 ptpcam.exe 添加为包含文件，即使这不是我的目标可执行文件

# c# - 是否允许空间 一个URI？

> ID：13370806
> 
> 赞同：1
> 
> 时间：2012-11-13T23:41:49.713
> 
> 标签：c#

根据维基百科，URI被定义为

```
<scheme name> : <hierarchical part> [ ? <query> ] [ # <fragment> ] 
```

我试图将“http://some site/page”传递给`Uri.IsWellFormedUriString`它，它返回false。然后我尝试了 "http://some%20site/page" ，对空格进行了编码。而且还是假的。

但是，“http://somesite/page%20Zero”会给我 True。

我可以得出结论，在 URI 的“根级别”中。空间不允许？或者还有其他我错过的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T23:49:35.433

您对 URI 的分解过于简化。“分层部分”包含`authority`和`path`。`authority`进一步细分为可选的用户名/密码、主机名和端口详细信息。

URI将`http://some site/page`“某个站点”作为主机名组件，这是无效的。

URI以`http://somesite/page zero`“somesite”作为主机名，这是有效的，“page zero”作为路径组件，也是有效的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T23:50:25.297

不可以，URL 的域名部分不允许有空格。在此处查看详细信息

[http://www.thesitewizard.com/domain/domain-name-with-spaces-or-dots.shtml](http://www.thesitewizard.com/domain/domain-name-with-spaces-or-dots.shtml)

[http://www.netregister.biz/faqit.htm#1](http://www.netregister.biz/faqit.htm#1)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T23:59:15.100

URI的`hierarchical`部分实际上包括`authority`和`path`组件；有关详细信息，请参阅[RFC 3986](https://www.rfc-editor.org/rfc/rfc3986#section-3.3)。

特别是，您将看到`path`组件本质上是由`pchars`（除其他外）“pct 编码”字符构成的，在[本节](https://www.rfc-editor.org/rfc/rfc3986#section-2)中定义，这`%20`是一个示例。

* * *

我在这里发布了一个解决 URI 验证问题的 PHP 解决方案，这可能很有趣：

[如何让这个 PHP URL 解析功能近乎完美？](https://stackoverflow.com/questions/3277449/how-to-make-this-php-url-parsing-function-nearly-perfect/3277522#3277522)

该代码*粗略*地根据 RFC 3986 进行验证，但有一些例外。

# objective-c - 如何使 -sendSynchronousRequest 更快？

> ID：13370807
> 
> 赞同：1
> 
> 时间：2012-11-13T23:41:57.607
> 
> 标签：objective-c, ios, asynchronous, nsurlconnection, synchronous

在我的应用程序中，我在不同的线程上执行多种不同的方法，这些方法从请求中下载数据，解析它并将其添加到数组中。这些方法中的大多数都从一个请求中下载数据，但这些方法使用`for`循环并下载 30 多个翻译。

但是，这会带来糟糕的用户体验，用户必须观看旋转的轮子并阅读一些愚蠢的随机生成的停顿文本。

所以我想知道的是如何使同步请求（`NSURLConnection`）更快，这是最好的技术？既然我提出了这么多请求，我应该立即切换到异步吗？异步甚至意味着/做什么，在这种情况下会有所帮助吗？

要完成所有操作，该应用程序在 wifi 上最多需要 7 秒，在 3G 上最慢需要 30 秒（在新加坡，带宽最差！）

那么，如何改进呢？任何方法，技术，api，请帮助！

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T23:54:18.277

解决此问题的最佳方法是对我们进行异步调用。除了速度之外，您应该尽可能避免使用同步请求。基本上，如果您使用的是同步但在单独的线程上，您正在做的工作已经用异步完成。设置它会做更多的工作，但您可以同时发送所有同步请求，并且它们可以在不同时间完成。可以同时进行多少个 http 请求是有限制的，但 iOS 会为您限制这一点，您仍然应该看到巨大的性能改进。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-14T00:21:17.533

使用同步与异步不会以任何方式影响速度。无论哪种方式，互联网速度都是相同的。

问题是您绝不能在主线程上进行同步网络调用。这样做会锁定用户界面。最好的情况是您的应用似乎对用户锁定（错误）。更糟糕的情况是，操作系统会因为你的应用程序没有响应（坏的）而杀死你的应用程序。

所有网络都应该在后台完成。

如果您的应用程序在所有网络访问完成之前无法真正继续，至少您可以设置一个“忙碌”屏幕让用户知道发生了什么。也许使用进度条让用户知道该过程有多远，或者显示文件数量的“x of y”计数。什么都适合您的应用程序。

但同样，网络访问的速度不会改变。您将提供更好的用户体验。

这里有很多关于如何进行异步文件下载的问题。许多人使用`NSURLConnection`和其他人使用 3rd 方库，这可能会使其更容易，具体取决于您在做什么。搜索了一下。有几个被列为与这一问题相关的问题。

# sql - T-SQL 开发人员插入和合并存储过程能够修改为 NULL

> ID：13370810
> 
> 赞同：1
> 
> 时间：2012-11-13T23:42:05.117
> 
> 标签：sql, tsql, vba, stored-procedures, sql-server-2008-r2

是否有更好的 SQL Server 2008 R2 技术来编码以下允许 NULL的组合`INSERT`&过程？`UPDATE``INSERT`

我很想看看其他开发人员如何编写`INSERT`和`UPDATE`处理 NULL 插入的程序（想象一个用户想要撤消一个条目）。我很欣赏将有更复杂和优雅的解决方案使用`MERGE`或我有兴趣看到的一些事务回滚技术，但是，我确实要求您从第一原则建立您的示例，因为这可能会导致帖子具有更广泛的吸引力什么读者的T-SQL水平。

这个简单示例的基础是`Orders`跟踪股票购买的表格。该程序应仅在 相同或增加`UPDATES`时允许..`OrderStatus`

```
OrderStatus  Explanation
-------------------------
     0       Creation
     1       Checking
     2       Placement
     3       Execution
     ...
     8       Settlement 
```

表结构：

```
CREATE TABLE Orders(
    OrderID INT IDENTITY,
    Ticker VARCHAR(20) NOT NULL,
    Size DECIMAL(31,15) NULL,
    Price DECIMAL(31,15) NULL,
    OrderStatus TINYINT NOT NULL) 
```

此外，假设我们有以下数据，以便我们可以测试修改数据：

```
SET IDENTITY_INSERT [dbo].[Orders] ON
INSERT INTO [dbo].[Orders] ([OrderID], [Ticker], [Size], [Price], [OrderStatus]) 
VALUES  (1, N'MSFT', CAST(1 AS Decimal(31, 15)), NULL, 0)
        ,(2, N'GOOG', CAST(2 AS Decimal(31, 15)), CAST(523 AS Decimal(31, 15)), 5)
        ,(3, N'AAPL', CAST(1 AS Decimal(31, 15)), NULL, 0)
SET IDENTITY_INSERT [dbo].[Orders] OFF 
```

你应该有以下数据：

```
OrderID Ticker  Size    Price   OrderStatus
-----------------------------------------------
1       MSFT    1.000   NULL    0
2       GOOG    2.000   523.000 5
3       AAPL    1.000   NULL    0 
```

现在是有趣的部分。这是我设计一个可以处理 NULL 插入（即允许用户撤消条目）的组合`INSERT`&过程的最大努力。`UPDATE`请注意，我需要一个输入参数来区分 NULL 的输入值是否是有意的，是否需要写入表中，而 NULL 显示为缺少的输入参数。希望很清楚我为什么要问这个问题，因为我发现我的技术非常冗长。

```
CREATE PROCEDURE [dbo].[Upsert_Orders] @isNullInsert BIT = 0
    ,@OrderID INT = NULL
    ,@Ticker VARCHAR(20) = NULL
    ,@Size VARCHAR(100) = NULL
    ,@Price VARCHAR(100) = NULL
    ,@OrderStatus TINYINT = NULL
AS
BEGIN
    IF (@OrderID IS NOT NULL)
        -- First check if @OrderID exists
        IF (
                SELECT OrderID
                FROM dbo.Orders
                WHERE OrderID = @OrderID
                ) IS NULL
        BEGIN
            -- @OrderID does not exist therefore replace with NULL
            SET @OrderID = NULL
            PRINT 'spUO. Replaced OrderID ' + CAST(@OrderID AS VARCHAR) + ' input parameter with NULL.'
        END

    IF @OrderID IS NULL
    BEGIN
        -- @OrderID IS NULL so INSERT a new record
        PRINT 'spUO Inserting a new record into the Orders'

        INSERT INTO Orders (
            -- OrderID not needed as IDENTITY new record.
            Ticker
            ,Size
            ,Price
            ,OrderStatus
            )
        VALUES (
            -- @OrderID not needed as IDENTITY new record
            @Ticker
            ,@Size
            ,@Price
            ,@OrderStatus
            )
    END
    ELSE
    BEGIN
        -- @OrderID IS NOT NULL therefore UPDATE the record @OrderID
        PRINT 'spUO Modifying existing record with OrderID ' + CAST(@OrderID AS VARCHAR)

        -- Declare CurrentVariables for @OrderID
        DECLARE -- @CurrentOrderID INT not needed as @OrderID Found
            @CurrentTicker VARCHAR(20)
            ,@CurrentSize DECIMAL(31, 15)
            ,@CurrentPrice DECIMAL(31, 15)
            ,@CurrentOrderStatus TINYINT

        -- Populate Current Variables from Table Orders
        SELECT -- @CurrentOrderID = OrderID not needed as @OrderID Found
            @CurrentTicker = Ticker
            ,@CurrentSize = Size
            ,@CurrentPrice = Price
            ,@CurrentOrderStatus = OrderStatus
        FROM Orders
        WHERE OrderID = @OrderID

        IF ISNULL(@OrderStatus, @CurrentOrderStatus) >= @CurrentOrderStatus
        BEGIN
            -- Update @OrderID if not moving backwards
            IF @isNullInsert = 0
            BEGIN
                -- We are not updating the record with NULL
                PRINT 'spUO NULL Parameter Input Values get replaced with the existing entries'

                UPDATE Orders
                SET -- OrderID = ISNULL(@OrderID, @CurrentOrderID)  not needed as @OrderID Found
                    Ticker = ISNULL(@Ticker, @CurrentTicker)
                    ,Size = ISNULL(@Size, @CurrentSize)
                    ,Price = ISNULL(@Price, @CurrentPrice)
                    ,OrderStatus = ISNULL(@OrderStatus, @CurrentOrderStatus)
                WHERE OrderID = @OrderID
            END
            ELSE
            BEGIN
                -- We are potentially overwritting the record with NULL
                PRINT 'spUO Old entries may be overwritten with NULL'

                UPDATE Orders
                SET -- OrderID = ISNULL(@OrderID, @CurrentOrderID)  not needed as @OrderID Found
                    Ticker = @Ticker
                    ,Size = @Size
                    ,Price = @Price
                    ,OrderStatus = @OrderStatus
                WHERE OrderID = @OrderID
            END
        END
        ELSE
            -- User is trying to re-write hostory. Do Nothing
            PRINT 'spUO You do not have permissions to roll back the OrderStatus.' 
    END
END 
```

现在我们有了一个 UPSERT 过程，让我来说明它的用法：

第 1 步：插入新行以显示购买部分福特股票的意向：

```
EXEC dbo.Upsert_Orders  @Ticker = 'F',
                        @Size = 1,
                        @Price = 10,
                        @OrderStatus = 2 
```

第 2 步：让我们证明`OrderStatus`无法回卷

```
EXEC dbo.Upsert_Orders  @OrderID = 4,
                        @Ticker = 'F',
                        @Size = 1,
                        @Price = 10,
                        @OrderStatus = 1 
```

这会产生所需的输出：

```
spUO Modifying existing record with OrderID 4 
spUO You do not have permissions to roll back the OrderStatus. 
```

数据现在看起来像：

```
OrderID Ticker  Size    Price   OrderStatus
-----------------------------------------------
1       MSFT    1.000   NULL    0
2       GOOG    2.000   523.000 5
3       AAPL    1.000   NULL    0
4       F       1.000   10.000  2 
```

第三步：最后，假设用户要删除第一笔订单的股份，那么我的程序下的不幸方法需要传递其他默认参数，并且`@isNULLInsert BIT`需要设置为1。

```
EXEC dbo.Upsert_Orders  @isNullInsert = 1,
                        @OrderID = 1,
                        @Ticker = 'MSFT',
                        @Size = NULL,
                        @Price = NULL,
                        @OrderStatus = 0 
```

希望这个完整的示例说明了添加新记录、更新现有记录和删除记​​录字段的概念。为这篇文章的长度道歉，但这是我能够产生的最简洁的代码！

最终数据：

```
OrderID Ticker  Size    Price   OrderStatus
------------------------------------------------
1       MSFT    NULL    NULL    0
2       GOOG    2.000   523.000 5
3       AAPL    1.000   NULL    0
4       F       1.000   10.000  2 
```

谢谢大家，

伯蒂。

ps 这将从 Excel VBA 中调用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-15T22:43:51.920

这是使用合并的答案。

```
Create Procedure [dbo].[Upsert_Orders2] 
    @IsNullInsert Bit = 0,
    @OrderID Int = Null,
    @Ticker Varchar(20) = Null,
    @Size Decimal(31,15) = Null,
    @Price Decimal(31,15) = Null,
    @OrderStatus Tinyint = Null
As

Declare @OrderStatusChange Table(Oldstatus int, NewStatus int)

Begin Transaction

Merge
  dbo.Orders As target
Using
  (Select @OrderID As OrderID) As source
On 
  (target.OrderID = source.OrderID)
When Matched Then
  Update Set
    Ticker = Case When @IsNullInsert = 0 Then IsNull(@Ticker, target.Ticker) Else @Ticker End,
    Size = Case When @IsNullInsert = 0 Then IsNull(@Size, target.Size) Else @Size End,
    Price = Case When @IsNullInsert = 0 Then IsNull(@Price, target.Price) Else @Price End,
    OrderStatus = Case When @IsNullInsert = 0 Then IsNull(@OrderStatus, target.OrderStatus) Else @OrderStatus End
When Not Matched Then
  Insert 
    (Ticker, Size, Price, OrderStatus)
  Values
    (@Ticker, @Size, @Price, @OrderStatus)
Output
  deleted.OrderStatus, inserted.OrderStatus into @OrderStatusChange;

If Exists (Select 'x' From @OrderStatusChange Where NewStatus < OldStatus)
  -- Evil History Changer!
  Rollback Transaction
Else
  Commit Transaction 
```

# python - 在 ipython 解释器中执行文件

> ID：13370811
> 
> 赞同：6
> 
> 时间：2012-11-13T23:42:07.877
> 
> 标签：python, file, interpreter, ipython

我正在尝试在 ipython 解释器中运行一个文件。文档使这听起来像`ipython file.py`在 shell 或`%run file.py`解释器本身中一样简单。但是，我想读取一个包含 ipython“系统外壳”命令的文件。这是一个例子：

```
files= !ls
print files 
```

对于这种类型的命令，调用上述解释器会导致 SyntaxError，就好像它是由`/usr/bin/python`.

**是否可以从系统 shell**运行文件，就好像它在 ipython shell 解释器中执行一样？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T00:46:00.093

如果您使用 .ipy 扩展名命名您的文件，您似乎可以执行此操作。

```
sam@blackbird-debian:~
$ cat tmp.ipy
me = !whoami
print me
sam@blackbird-debian:~
$ ipython tmp.ipy
['sam'] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-14T00:08:37.610

我假设您想从已经运行的 IPython 会话中执行此操作。可能有一些**更**简单的东西，但我现在能想到的就是：

```
get_ipython().shell.run_cell(open('path/to/commands').read()) 
```

另一个疯狂的想法 - 将 IPython 启动为`EDITOR=cat ipython`. 现在您可以从文件中加载命令：

```
%edit -r path/to/commands 
```

不过，您的用例可能应该有真正的魔力。

* * *

或者你可以非交互地做同样的事情（添加`-i`到交互模式）：

```
ipython -c 'get_ipython().shell.run_cell(open("path/to/commands").read())' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T00:05:15.447

根据您到底想要做什么，运行可能就足够了

```
ipython < file 
```

来自 bash。也就是说，只需将标准输入从您的文件重定向到 ipython，以便 ipython 认为它获取的命令来自您的键盘。

# c++ - 我是在使用仪表例程（pin）得到错误的 ebp，还是我在这里遗漏了什么？

> ID：13370812
> 
> 赞同：0
> 
> 时间：2012-11-13T23:42:08.950
> 
> 标签：c++, debugging, elf, instrumentation, dwarf

所以这是交易。我正在使用 pin 工具和我附加到的进程中的 dwarf 信息来开发调试器。Pin 是一个框架，可让您为已经运行的进程创建检测工具，我附加到该进程，然后从中解析 DWARF 信息。

显然，pin 让我可以在我附加到程序的精确时刻抓住寄存器。我能够得到`ebp`,`esp`和`eip`. 但是堆栈中的信息与 DWARF 信息中的信息不匹配。

例如：

Pin 告诉我`ebp`：`bfe0abe8`我假设这是寄存器的实际地址，而不是其中的值。

如果我去堆栈，我有这个：

```
bfe0abb5 -> 00000020   \\this is esp
bfe0abb6 -> 0804855d
bfe0abb7 -> 08048720
bfe0abb8 -> 0000000a
bfe0abb9 -> bfe0abe8    \\this is what I think is ebp, but according to pin is not
bfe0abba -> 0015711f
bfe0abbb -> bfe0ac28
bfe0abbc -> 4236b852     \\this is a local float variable named jos
bfe0abbd -> 42c0947b     \\this is a local float variable named tib
bfe0abbe -> 0000000a
bfe0abbf -> 08048724
bfe0abc0 -> bfe0abf8
bfe0abc1 -> bfe0ac28
bfe0abc2 -> 08048612
bfe0abc3 -> 00000000
bfe0abc4 -> 0000000a
bfe0abc5 -> 00006680
bfe0abc6 -> 08048689
bfe0abc7 -> 00266324
bfe0abc8 -> 00265ff4
bfe0abc9 -> 936498a8
bfe0abca -> 4072464d
bfe0abcb -> 0013f4a5
bfe0abcc -> 424ab852    \\this is another local variable
bfe0abcd -> 42bc947b    \\this is another local variable
bfe0abce -> 0000000a
bfe0abcf -> 08048670
bfe0abd0 -> 00000000
bfe0abd1 -> bfe0aca8 
```

还有很多，我不知道堆栈的底部实际上是什么，所以我只展示了一点。

如果我转到 DWARF 信息，这是堆栈顶部当前所在的函数，并且 ebp 应该指向：

```
<1><  962>  DW_TAG_subprogram
    DW_AT_external              yes(1)
    DW_AT_name                  add
    DW_AT_decl_line             36
    DW_AT_prototyped            yes(1)
    DW_AT_low_pc                0x8048513
    DW_AT_high_pc               0x804855f
    DW_AT_frame_base            <loclist with 3 entries follows>
        [ 0]<lowpc=0x2f><highpc=0x30>DW_OP_breg4+4
        [ 1]<lowpc=0x30><highpc=0x32>DW_OP_breg4+8
        [ 2]<lowpc=0x32><highpc=0x7b>DW_OP_breg5+8 
```

我知道这一点，因为我在堆栈上看到的局部变量在这个函数内部。这些局部变量是：

```
 <2>< 1029> DW_TAG_variable
    DW_AT_name                  tib
    DW_AT_decl_line             38
    DW_AT_type                  <837>
    DW_AT_location              DW_OP_fbreg -24
 <2>< 1043> DW_TAG_variable
    DW_AT_name                  jos
    DW_AT_decl_line             39
    DW_AT_type                  <837>
    DW_AT_location              DW_OP_fbreg -28 
```

我知道根据 DWARF（以及这个：[如何使用 GDB 查看存储在堆栈上的变量](https://stackoverflow.com/questions/10198018/how-to-see-variables-stored-on-the-stack-with-gdb?answertab=active#tab-top)），此函数中的 ebp 应该是当前的 ebp + 8（因为我正在使用 DWORD 应该是 +2）。然后我应该将 -24 减去 8，使其成为 ebp-16（实际上是 ebp-4）。在纸上这应该可以工作，但是在进入堆栈时我遇到了很多问题：

*   我什至没有在堆栈顶部附近看到该引脚返回给我的当前 ebp 的地址。
*   假设这`bfe0abb9`是当前的 ebp 并且该引脚实际上返回的是寄存器的值，而不是地址，如果我从该寄存器中减去 4，我将不会得到 tib 的值，因为根据我对堆栈的理解，我会上升而不是下降。即使我在尝试获取 jos ( `ebp-28+8 = ebp -20 = ebp -5`) 时会失败，但我绝对不会得到 jos `000000a`。

我在这里错过了什么吗？我对堆栈和/或寄存器或 DWARF 信息有错误的理解吗？还是 Pin 搞砸了我并提供了错误的信息？

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T10:53:12.110

我将忽略堆栈转储，因为我不确定您要在此处显示什么。

您引用的 DWARF 说该函数的框架基数最初是`$esp + 4`，然后更改为`$esp + 8`，然后更改为`$ebp + 8`。这是打开大多数 i386 功能的标准“ `push $ebp; mov $esp, $ebp`”指令序列。在函数入口处，帧基数是`esp`加 4 的值。一旦我们将调用者的`ebp`寄存器保存在堆栈中，帧基数现在是`esp`加 8，`esp`因为`push`. 最后将 in 的值`esp`复制到`ebp`其中，并且该值将在函数的其余部分保持不变（`esp`通常会进一步调整）。

您在此处看到的内容——“帧基”——在 debug_frame 部分中也称为规范帧地址或 CFA。CFA 是堆栈上的一个地址，在函数的整个持续时间内都是相同的。在 i386 上，CFA 地址是调用者在执行指令以调用您正在查看的函数`esp`之前的值。`call`

DWARF 说该变量`tib`位于帧基数 -24 处。您的函数的帧基是`ebp + 8`肯定的，`ebp`寄存器的值，负 16，是堆栈上的地址。变量存储在该地址。

如果 DWARF 不清楚，我经常发现阅读函数的实际汇编代码会很有帮助，前提是您对汇编语言有合理的理解。您还可以单步执行程序，在执行过程中检查寄存器和堆栈地址。对真实代码进行少量动手实验几乎总能回答任何问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T08:20:48.530

这很奇怪，因为它不像堆栈寻址，`bfe0abb5`, `bfe0abb6`, `bfe0abb7`, `bfe0abb8`, `bfe0abb9`, `bfe0abba`, ....
在 32 位机器中它应该是 4 字节对齐的。根据您提供的堆栈地址，即使您提供了正确的 DWARF 信息，我也无法计算出真实地址。

# ruby-on-rails - 在 RoR 中为 open-uri 设置新的 DNS

> ID：13370814
> 
> 赞同：3
> 
> 时间：2012-11-13T23:42:16.457
> 
> 标签：ruby-on-rails, dns, open-uri

我在使用 open-uri 从 RoR 访问网站时遇到问题。

在我的本地机器上我没有问题，但在服务器上，服务器 DNS 无法解析 uri。

有没有办法在 open-uri 调用之前设置谷歌 DNS？

谢谢。

```
require 'open-uri'
open("fuel-prices-europe.info") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T01:57:48.503

你能把解决方案放在 /etc/hosts 中吗？还是只使用ip？

# java - 在 if 语句中返回导致无法访问的代码错误

> ID：13370816
> 
> 赞同：1
> 
> 时间：2012-11-13T23:42:24.673
> 
> 标签：java, if-statement, compiler-errors, return, unreachable-statement

以下代码：

```
public static void print(ListNode p)
{
    System.out.print("[");
    if(p==null);
    {
        System.out.println("]");
        return;
    }
    ListNode k = p.getNext();
    //more code
} 
```

导致以下编译错误：

```
 ----jGRASP exec: javac -g Josephus_5_Rajolu.java

Josephus_5_Rajolu.java:53: error: unreachable statement
            ListNode k = p.getNext();
                     ^
1 error

 ----jGRASP wedge2: exit code for process is 1.
 ----jGRASP: operation complete. 
```

为什么会这样？我只在 p = null 时返回。如果 p!=null，我想做我的其他代码。为什么无法到达？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-13T23:43:54.513

`if`你的陈述后面有一个分号。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T23:45:19.797

有 ; 在 if 语句将其删除后它将起作用:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-13T23:44:18.883

`if(p==null);`<-- 去掉末尾的分号

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-13T23:44:39.367

也许';' 在：
if(p==null) **;**

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-13T23:47:43.167

删除 if 后的分号

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-13T23:50:22.410

你在哪里实例化 ListNode K？

在我看来，问题是 ListNode k 没有被实例化。

我想你需要这样的东西。ListNode k = new ListNode();

你是在课堂上创造这个吗？

你还有一个 ; 如果（p==null）之后；那需要被删除。

# xcode4.5 - 视图控制器中的搜索栏（uitableview）

> ID：13370844
> 
> 赞同：1
> 
> 时间：2012-11-13T23:45:50.527
> 
> 标签：xcode4.5

我尝试为 iPhone 创建一个简单的应用程序。

在其中我有一个 tableview 和一个 tableview 的 detailview，最后一个搜索栏来过滤 tableview。

tableview 和 detailview 工作正常，但 searchhbar 不能正常工作。

当我输入搜索词时，它会显示整个表格视图，而详细视图不工作搜索模式。

当我取消搜索模式时，详细视图再次工作。

所以很明显我的过滤器代码是错误的，我的过滤器代码中没有我的详细视图，但我现在不知道如何正确地做到这一点。

希望有人可以帮助我，我的代码如下所示：

我的 *.h 文件：

```
#import <UIKit/UIKit.h>

@class DetailViewController;

@interface MasterViewController : UITableViewController <UISearchBarDelegate, UISearchDisplayDelegate>

{
    NSArray *originalData;
    NSMutableArray *searchData;

    UISearchBar *searchBar;
    UISearchDisplayController *searchDisplayController;

}

@property (strong, nonatomic) DetailViewController *detailViewController;

@end 
```

我的 *.m 文件：

```
#import "MasterViewController.h"

#import "DetailViewController.h"

@interface MasterViewController () {
    NSMutableArray *_objects;
}
@end

@implementation MasterViewController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        self.title = NSLocalizedString(@"Opslag", @"Opslag");
        _objects = [[NSMutableArray alloc] init];

        //title
        //detail

        NSDictionary * obj1 = [[NSDictionary alloc] initWithObjectsAndKeys:@"this_title", @"title", @"this_detail", @"detail", nil];
        NSDictionary * obj2 = [[NSDictionary alloc] initWithObjectsAndKeys:@"some_title2", @"title", @"some_detail2", @"detail", nil];
        NSDictionary * obj3 = [[NSDictionary alloc] initWithObjectsAndKeys:@"some_title3", @"title", @"some_detail3", @"detail", nil];
        NSDictionary * obj4 = [[NSDictionary alloc] initWithObjectsAndKeys:@"some_title4", @"title", @"some_detail4", @"detail", nil];

        [_objects addObject:obj1];
        [_objects addObject:obj2];
        [_objects addObject:obj3];
        [_objects addObject:obj4];

        originalData = [[NSArray alloc] initWithObjects:obj1, obj2, obj3, nil];
        searchData = [[NSMutableArray alloc] init];

    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    searchBar = [[UISearchBar alloc] initWithFrame:CGRectMake(0, 0, 160, 44)];
    searchDisplayController = [[UISearchDisplayController alloc] initWithSearchBar:searchBar contentsController:self];

    searchDisplayController.delegate = self;
    searchDisplayController.searchResultsDataSource = self;

    self.tableView.tableHeaderView = searchBar;

}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

#pragma mark - Table View

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return _objects.count;
}

// Customize the appearance of table view cells.
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier];
        cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
    }

    cell.textLabel.text = [[_objects objectAtIndex:indexPath.row] objectForKey:@"title"];

    cell.detailTextLabel.text = [[_objects objectAtIndex:indexPath.row] objectForKey:@"detail"];

    return cell;
}

#pragma mark - searchDisplayControllerDelegate

- (BOOL)searchDisplayController:(UISearchDisplayController *)controller shouldReloadTableForSearchString:(NSString *)searchString
{
    [searchData removeAllObjects];

    NSArray *group;

    for(group in originalData)
    {
        NSMutableArray *newGroup = [[NSMutableArray alloc] init];
        NSString *element;

        for(element in group)
        {
            NSRange range = [element rangeOfString:searchString options:NSCaseInsensitiveSearch];

            if (range.length > 0) {
                [newGroup addObject:element];
            }
        }

        if ([newGroup count] > 0) {
            [searchData addObject:newGroup];
        }

    }

    return YES;
}

- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Return NO if you do not want the specified item to be editable.
    return YES;
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (!self.detailViewController) {
        self.detailViewController = [[DetailViewController alloc] initWithNibName:@"DetailViewController" bundle:nil];
    }
    NSDictionary *object = _objects[indexPath.row];
    self.detailViewController.detailItem = [object objectForKey:@"detail"];
    self.detailViewController.titleItem = [object objectForKey:@"title"];
    [self.navigationController pushViewController:self.detailViewController animated:YES];
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T23:53:42.523

您的`cellForRowAtIndexPath`方法总是从您的`_objects`数组中挑选，在执行搜索时您永远不会更改。当`shouldReloadTableForSearchString`被调用时，您只会填充`searchData`，它永远不会反馈到`cellForRowAtIndexPath`并`numberOfRowsInSection`显示过滤后的结果。

处理这个问题的一种方法是在你的`cellForRowAtIndexPath`：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier];
        cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
    }

    NSArray* sourceArray = tableView == self.searchDisplayController.searchResultsTableView ? searchData : _objects;

    cell.textLabel.text = [[sourceArray objectAtIndex:indexPath.row] objectForKey:@"title"];

    cell.detailTextLabel.text = [[sourceArray objectAtIndex:indexPath.row] objectForKey:@"detail"];

    return cell;
} 
```

还有在你的`numberOfRowsInSection`

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    if (tableView == self.searchDisplayController.searchResultsTableView){
        return searchData.count;
    }else
    {
       return _objects.count;
    }

} 
```

# .net - 使用 Jquery Mobile 使用 WCF 服务返回 400 错误请求

> ID：13370850
> 
> 赞同：2
> 
> 时间：2012-11-13T23:46:37.040
> 
> 标签：.net, ajax, wcf, jquery

我已经搜索过这个，但我找不到对我有帮助的东西，所以我很抱歉，如果这个已经发布并且我只是找不到它。

我创建了一个托管在 IIS 中的 WCF 服务应用程序。目前它非常基本，只有一个 hello world 方法，基本上将国家名称及其代码作为 json 对象返回。

我还编写了一些 jquery，它将远程调用该方法，目的是填充列表对象。

目前，当我调用该方法时，它会命中 ajax 调用的成功参数并用“未定义”提醒我，我不知道是什么导致了这种情况，但很可能我犯了一个愚蠢的错误。

这是服务和jquery的代码

网络配置：

```
<configuration>

<system.web>
<compilation debug="true" targetFramework="4.0" />
<authentication mode="None" />
</system.web>
<system.webServer>
<modules runAllManagedModulesForAllRequests="true"/>
</system.webServer>
<system.serviceModel>
<serviceHostingEnvironment aspNetCompatibilityEnabled="true"/>
<standardEndpoints>
  <webScriptEndpoint>
    <standardEndpoint crossDomainScriptAccessEnabled="true"/>
  </webScriptEndpoint>
 </standardEndpoints>

</system.serviceModel>

</configuration> 
```

服务1.svc

```
<%@ ServiceHost Language="C#" Debug="true" Service="RestfulFlightWCF.Service1" codeBehind="Service1.svc.cs" Factory="System.ServiceModel.Activation.WebScriptServiceHostFactory"  %> 
```

service1.svc.cs { // 注意：您可以使用“重构”菜单上的“重命名”命令将代码、svc 和配置文件中的类名“Service1”一起更改。

```
[ServiceContract(Namespace = "JsonpAjaxService")]
[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)]
public class Service1 
{
    [WebGet(ResponseFormat = WebMessageFormat.Json)]
    public Country GetCountry(string id)
    {

       Country county = new Country();
        county.Name = "United Kingdom";
        county.Id = "gb";
        return county;
    }

    [DataContract]
    public class Country
    {
        [DataMember]
        public string Id { get; set; }

        [DataMember]
        public string Name { get; set; }
    }

} 
```

jQuery

```
 $(document).ready(
     function () {
        $.ajax({
            type:"GET",
            Data:'gb',
            Url:"http://192.168.1.6:80/FlightServices.svc/GetCountry",
            DataType:"jsonp",
            method:"GetCountry",
            success: function(msg){
                debugger;
                    alert(msg.responseText);
                        if (msg.responseText) {
                            var err = msg.responseText;
                            if (err)
                                error(err);
                            else
                                error({ Message: "Unknown server error." })
                        }
            },
            failure: function(){
                alert("something went wrong");
            },
            error: function(){
                alert("something happned");
            }
        });
         }); 
```

很抱歉这篇文章很长，但我认为如果我包含我的代码会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T23:58:16.103

如何将其寄回的小样本

```
public string GetCountry(string id)
    {
        string json = string.Empty;
        Country county = new Country();
        county.Name = "United Kingdom";
        county.Id = "gb";
        json = "{ \"name\" : \"" + county.Name + "\", \"id\" : \"" + county.Id + "\" }"
        return json;
    }​ 
```

硬编码是一种不好的做法。最好序列化数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T14:43:27.160

看起来您可能缺少 xml 配置中的一些配置，包括：

```
<system.serviceModel>
  <behaviors>
    <serviceBehaviors>
      <behavior>
        <serviceMetadata httpGetEnabled="true" />
      </behavior>  
    </serviceBehaviors>
  </behaviors> 
<system.serviceModel> 
```

我自己并不真正使用 WCF，但通过本教程运行它应该涵盖缺少的内容：http: [//www.codeproject.com/Articles/417629/Support-for-JSONP-in-WCF-REST-services](http://www.codeproject.com/Articles/417629/Support-for-JSONP-in-WCF-REST-services)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T23:36:45.430

好的，所以在摆弄了一段时间后，我今晚得到了这个工作，所以我想我会发布一些我在寻找修复程序时发现的东西。

1.  在被调用的方法上以响应格式添加到 WebGet。

    ```
    [WebGet(ResponseFormat= WebMessageFormat.Json, RequestFormat = WebMessageFormat.Json)] 
    ```

2.  将我的 jQuery 更改为以下内容：

    ```
    var Type;
    var Url;
    var Data;
    var ContentType;
    var DataType;
    var ProcessData;
    var method;
    //Generic function to call WCF  Service
    function CallService() {
        $.ajax({
            type: Type, //GET or POST or PUT or DELETE verb
            url: Url, // Location of the service
            data: Data, //Data sent to server
            contentType: ContentType, // content type sent to server
            dataType: DataType, //Expected data format from server
            processdata: ProcessData, //True or False
            success: function (msg) {//On Successful service call
                ServiceSucceeded(msg);
            },
            error: ServiceFailed// When Service call fails
        });
    }

    function ServiceFailed(xhr) {
        alert(xhr.responseText);
        if (xhr.responseText) {
            var err = xhr.responseText;
            if (err)
                error(err);
            else
                error({ Message: "Unknown server error." })
        }
        return;
    }

    function ServiceSucceeded(result) {
        if (DataType == "jsonp") {

                debugger;
                resultObject = result.GetEmployeeResult;
                var string = result.Name + " \n " + result.Id ;
                alert(string); 
        }
    }

    function GetCountry() {
        Data = {id : "us"};
        Type = "GET";
        Url = "http://192.168.1.6:80/FlightService.svc/GetCountry"; 
        DataType = "jsonp";
        ContentType = "application/json; charset=utf-8";
        ProcessData = false;
        method = "GetCountry";
        CallService();
    }

    $(document).ready(
     function () {

         GetCountry();
     } 
    ```

我发现的关键点是将参数传递给 webGet 方法

```
data: {id : "gb"} 
```

# ruby - 我导出 csvs 的方法有什么问题？

> ID：13370851
> 
> 赞同：0
> 
> 时间：2012-11-13T23:46:42.820
> 
> 标签：ruby, csv

我正在尝试将控制台中的一些数据导出到我桌面上的 csv 文件中。我在模型中创建了一个 export_csv 方法以从控制台运行

```
def export_csv

  csv_string = CSV.generate do |csv|
    csv << [
      'Animal', 'Subanimal'
    ]
    Animal.all.each do |animal|
      subanimals = animal.children
      unless subanimals.blank?
        subanimals.each do |subanimal|
          csv << [
            animal.name, subanimal.name
          ]
        end
      end
    end
  end

  filename = "animals_and_subanimals.csv"
  CSV.open(filename, 'w') do |csv|
    csv << csv_string
  end
end 
```

但它正在打破并给我这个错误

```
NoMethodError: undefined method `map' for #<String:0x007f90ce247000> 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:50:36.110

`csv_string`已经是 CSV 格式的字符串。只需将其写入磁盘，如下所示：

```
File.open(filename, 'w') {|f| f.puts csv_string} 
```

你最后一个 CSV 块是什么让你失望。

或者，您可以随时创建文件，而不是在内存中构建（可能？）大字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T00:58:51.300

在这里，让我尝试为您清理它：

```
def export_csv
  filename = "animals_and_subanimals.csv"

  CSV.open(filename, 'w') do |csv|
    csv << ['Animal', 'Subanimal']
    Animal.all.each do |animal|
      subanimals = animal.children
      unless subanimals.blank?
        subanimals.each do |subanimal|
          csv << [animal.name, subanimal.name]
        end
      end
    end
  end
end 
```

# entity-framework - 实体框架“未定义键”显然是？

> ID：13370853
> 
> 赞同：0
> 
> 时间：2012-11-13T23:46:47.937
> 
> 标签：entity-framework, asp.net-mvc-4

我在我的实体框架代码第一个应用程序中收到此错误，我不知道为什么，因为密钥已明确定义：

> 在模型生成期间检测到一个或多个验证错误：System.Data.Entity.Edm.EdmEntityType: : EntityType 'Image' has no key defined。定义此 EntityType 的键。

这是我的图像模型。

```
using System;
using System.ComponentModel.DataAnnotations;
using System.Runtime.Serialization;

namespace Locabal.Model
{
    [DataContract]
    public class Image : IIndexable<Uri>
    {
        [DataMember] public Uri UrlBase { get { return Id; } set { Id = value; } }
        [Key][DataMember] public Uri Id { get; set; }

        [DataMember] public string Description { get; set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T00:35:53.737

`Uri`EF 不支持该数据类型。使用另一种适当的数据类型。

# objective-c - NSPredicate predicateWithFormat：变量替换

> ID：13370858
> 
> 赞同：0
> 
> 时间：2012-11-13T23:47:04.380
> 
> 标签：objective-c, cocoa, nspredicate

鉴于：

```
MyObject *object1 = [MyObject createWithName:@"name1"];
MyObject *object2 = [MyObject createWithName:@"name2"];
MyObject *object3 = [MyObject createWithName:@"name3"];

NSArray *myArray = @[object1, object2, object3];
NSString *name = @"name1"; 
```

正在做

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"name == '%@'", name];
NSArray *filtered = [myArray filteredArrayUsingPredicate:predicate]; 
```

留给我

```
filtered.count == 0 
```

但

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:
                               [NSString stringWithFormat:"name == '%@'",name]];
NSArray *filtered = [myArray filteredArrayUsingPredicate:predicate]; 
```

留给我

```
[filtered objectAtIndex:0] == object1 
```

为什么？对于 predicateWithFormat 来说，这似乎是一种奇怪的行为。NSPredicate 对格式的定义是否与 NSLog/NSString 不同？[我在文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Predicates/predicates.html#//apple_ref/doc/uid/TP40001789)中找不到任何明显的东西。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T04:38:27.133

我不知道为什么第二个版本有效，但您的第一个版本无效的原因是 @ 周围的单引号。这使 @ 成为文字，因此您实际上是在过滤 name == @，这不是您想要的。只需删除单引号，它就会起作用。

# c# - 在 .NET Web 应用程序中，以下内容有什么区别？

> ID：13370860
> 
> 赞同：0
> 
> 时间：2012-11-13T23:47:09.737
> 
> 标签：c#, asp.net, .net, web-applications, ashx

我主要是想理解这一点。.NET 应用程序中所有这些具有相似名称的类的目的是什么？

另外，我会在哪些中看到更多的实现细节？我假设 .ASPX 是实际的网站？

![在此处输入图像描述](../Images/c7d99ddd15b3b773b5dd40a7cddb6064.png)

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T23:54:50.590

该`.aspx`文件包含页面的标记，即混合了服务器标签的 HTML 代码。

该`.aspx.cs`文件是文件背后的代码，其中包含页面类的 C# 代码。

该`.aspx.designer.cs`文件包含自动生成的 C# 代码，该代码将标记文件中的控件声明为页面类中的属性，以便您可以轻松访问它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T23:52:47.300

这基本上是同一类。它被拆分只是为了您的舒适。您可能想看看[http://msdn.microsoft.com/en-us/library/ms178138(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/ms178138(v=vs.100).aspx) 或阅读其他一些关于 Web 表单的论文。但实际上您可以将所有这些放在同一个文件中。所以所有的代码人员，比如事件处理程序都应该在 PageName.aspx.cs 文件中。在 PageName.aspx 你应该有 html 标记。并且您可能对生成的文件不太感兴趣，因为它包含为您生成的内容，因此您将在下次重新生成时丢失此文件中的所有代码。

# java - java接口构造函数？

> ID：13370861
> 
> 赞同：0
> 
> 时间：2012-11-13T23:47:11.030
> 
> 标签：java, interface, constructor

我有一个基类、一个子类、一个接口和一个实现此接口的子类

-base 抽象类 Seq

```
public abstract class Seq {...some functions...} 
```

-class For 扩展 Seq

```
public class For extends Seq{
    int first, last, step;
    public For( int a, int b, int c)
      {...some work on a,b,c }
} 
```

到目前为止，一切都很好！我测试了它。

```
public interface SeqIt {
    public boolean function1();
    public int function2();
} 
```

-实现 SeqIt（接口）的 ForIt 类问题是子类构造函数

```
public class ForIt implements SeqIt{
      public void ForIt( For x ) //here is the problem//
              {...the work i wanna do...}
          } 
```

我必须使用这个语句从主调用它`ForIt fi = new ForIt(new For(3, 8, 2));`

那么我应该如何编写构造函数呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T23:52:57.957

您的问题不是很清楚，但看起来您的问题是`void`您的构造函数签名中有问题。

你想要的是：

```
public ForIt( ... ) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T23:52:46.690

你可能不想要那个`void`- 你只是想要`public ForIt(For x)`.

# php - 如何使用 Laravel 事件？

> ID：13370865
> 
> 赞同：9
> 
> 时间：2012-11-13T23:47:33.513
> 
> 标签：php, laravel

我想在新用户注册时收到通知。在我的控制器中，我触发一个事件，如下所示。

```
Event::fire('myapp.new_user', array($this->data['user']->email)); 
```

我在哪里定义`listener`？

```
Event::listen('myapp.new_user', function ($uid) {
    Message::to("myemail@example.com")
                ->from("myemail@example.com", "My App")
                ->subject('New User')
                ->body("new user")
                ->html(true)
                ->send();
}); 
```

怎么`listener`知道一个事件被触发了？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-11-13T23:56:50.147

您需要确保在执行应用程序逻辑之前定义您的侦听器，当引发事件时，它们只能被已注册的侦听器捕获，它不会寻找新的侦听器。

在小型项目中，我只是将我的听众放在`application/start.php`文件的底部。这个文件在你的路由运行之前发生，它作为一个应用程序配置文件，有一些逻辑。您需要将这些事件放在文件的底部，至少在注册自动加载器映射之后。

在较大的项目中，我将在其中创建`application/listeners.php`并要求该文件`application/start.php`以提高可读性。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-26T00:45:38.263

尝试 ：

```
Event::listen('myapp.new_user', function ($uid) {
Message::to("myemail@example.com")
            ->from("myemail@example.com", "My App")
            ->subject('New User')
            ->body("new user")
            ->html(true)
            ->send();
return 'test my event';
}); 
```

[http://laravel.com/docs/events](http://laravel.com/docs/events)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-12T19:24:50.820

您还可以定义类来处理特定事件，然后使用服务提供者来注册它们。

下面是一个基本示例：

**应用程序/NewUserListener.php**

触发事件时调用的侦听器：

```
class NewUserListener
{
    public function handle($uid)
    {
        // Send an email here
    }
} 
```

**应用程序/ListenerServiceProvider.php**

ServiceProvider - 记住并将其添加到 L4 Config 中的 Service Providers 列表中。

```
use Illuminate\Support\ServiceProvider;

class ListenerServiceProvider extends ServiceProvider
{
        public function register()
        {
            Event::listen('myapp.new_user', 'NewUserListener');
            // Register more events here...
        }
} 
```

如果您将侦听器等组织到适当命名的文件夹中，那么如果您以后有一堆侦听器，最终维护起来会容易得多。如果您以这种方式编写侦听器，还可以实例化和测试侦听器。

# java - 将文本和图片附加到图像

> ID：13370866
> 
> 赞同：1
> 
> 时间：2012-11-13T23:47:39.130
> 
> 标签：java, image, image-processing, image-manipulation

我想问一个关于Java图像处理的问题。

我想要实现的是将文本放在现有图像下方。不是在现有图像上，而是附加到图像底部。我已经用谷歌搜索过了，但所有的答案都是关于如何做后者的建议——如何在图像上放置文字。

下面是示例图片，我希望得到什么结果。原始图片为Leena图像，图像处理后的结果与红色虚线下方一起。

![期望的结果](../Images/3344cb92209afe7e5cfe07ab96ecbf3b.png)

实现这一目标的最快方法是什么 - 在图像下方写一些文字并附加另一张较小的图片？

我想做的是在我现有的 BufferedImage 底部 30 像素高度的白色背景上附加，然后在该位置写入文本并添加徽标。这可能是最有效的方法吗？是否有一些库可以为我工作，或者有比我提到的更好的方法吗？

编辑：为了更清楚，我希望结果为单张图片

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T00:34:26.000

我需要一些时间来通读

*   [执行自定义绘画](http://docs.oracle.com/javase/tutorial/uiswing/painting/)
*   [2D 图形](http://docs.oracle.com/javase/tutorial/2d/index.html)
*   [使用图像](http://docs.oracle.com/javase/tutorial/2d/images/index.html)

这是一个非常基本的例子。我没有费心添加代码来实际渲染徽标，您可以阅读建议的阅读列表，并且应该能够弄清楚如何实现；）

![在此处输入图像描述](../Images/c23e5961726850ff65b312a47e18bedd.png)

```
public class AppendImage {

    public static void main(String[] args) {
        new AppendImage();
    }

    public AppendImage() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new ImagePane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class ImagePane extends JPanel {

        private BufferedImage sourceImage;
        private BufferedImage labeledImage;

        public ImagePane() {

            try {
                sourceImage = ImageIO.read(getClass().getResource("/source.jpg"));
                labeledImage = addLabel("Hello", sourceImage);
            } catch (IOException exp) {
                exp.printStackTrace();
            }

        }

        @Override
        public Dimension getPreferredSize() {
            int width = sourceImage.getWidth() + labeledImage.getWidth();
            int height = labeledImage.getHeight();

            return new Dimension(width, height);
        }

        protected BufferedImage addLabel(String label, BufferedImage sourceImage) {

            Font font = UIManager.getFont("Label.font");
            FontMetrics fm = getFontMetrics(font);
            int width = sourceImage.getWidth() + 2;
            int height = sourceImage.getHeight() + 4 + fm.getHeight() + 4;

            BufferedImage image = new BufferedImage(width, height, BufferedImage.TYPE_INT_RGB);
            Graphics2D g2d = image.createGraphics();
            g2d.setColor(Color.WHITE);
            g2d.fillRect(0, 0, width, height);
            g2d.setColor(Color.BLACK);
            g2d.setStroke(new BasicStroke(2, BasicStroke.CAP_ROUND, BasicStroke.JOIN_ROUND));
            g2d.drawRect(0, 0, width - 1, height - 1);
            g2d.drawImage(sourceImage, 1, 1, this);
            g2d.setColor(Color.RED);
            g2d.setStroke(new BasicStroke(2f, BasicStroke.CAP_ROUND, BasicStroke.JOIN_ROUND, 10f, new float[]{10f}, 0f));
            g2d.drawLine(0, sourceImage.getHeight() + 2, image.getWidth(), sourceImage.getHeight() + 2);

            int y = sourceImage.getHeight() + (((image.getHeight() - sourceImage.getHeight()) - fm.getHeight()) / 2) + 2;
            g2d.drawString(label, 2, y + fm.getAscent());

            String logo = "Logo here";
            int x = image.getWidth() - fm.stringWidth(logo) - 12;
            g2d.drawString(logo, x, y + fm.getAscent());

            g2d.dispose();

            return image;

        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            int x = 0;
            g.drawImage(sourceImage, x, 0, this);
            x += sourceImage.getWidth();
            g.drawImage(labeledImage, x, 0, this);
        }
    }
} 
```

# google-app-engine - 为整个应用设置 Python27 Google AppEngine 默认编码

> ID：13370867
> 
> 赞同：4
> 
> 时间：2012-11-13T23:47:42.280
> 
> 标签：google-app-engine, encoding, python-2.7

我想为我的 python27 appengine 站点设置默认编码为 utf-8。默认为 ascii。

[http://code.google.com/p/googleappengine/issues/detail?id=5923](http://code.google.com/p/googleappengine/issues/detail?id=5923)回答了一个类似的问题。它说在设置默认编码后不要使用 sys.reload ，否则您将丢失请求。

如何为我的整个 python appengine 站点设置 utf-8 编码，而不必像上面的链接建议的那样专门编码字符串？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T00:45:27.567

您可以使用以下命令启动您的 python 27 代码（每个 Python 文件）：

```
#!/usr/bin/python
# -*- coding: utf-8 -*-
from __future__ import unicode_literals 
```

但有时你必须使用 .encode('ascii') 如果你使用 HMAC 或者你必须设置 http 标头。或者您可以使用：

```
self.response.headers[str('Content-Type')] = str(content_type) 
```

或者

```
 self.response.headers[b'Content-Type'] = str(content_type) 
```

并确保：

*   您所有的 HTML 文件都使用 UTF-8
*   您的编辑器默认使用 UTF-8

# visual-studio-2012 - 如何避免 TFS 和 nuget 升级错误

> ID：13370871
> 
> 赞同：2
> 
> 时间：2012-11-13T23:47:55.217
> 
> 标签：visual-studio-2012, nuget

我有一个 nuget 包，其中包含我们所有 Web 项目通用的一堆工件，css、png、layout.cshtml。

一切都很好，直到我需要通过升级我的 nuget 包来将更改应用于项目

对于要替换的每个项目，都会出现此对话框。

* * *

微软视觉工作室

* * *

错误

尝试对 1 个项目执行添加操作时遇到 1 个错误遇到的第一个错误：

TF14092: 项目 $/ITEM.BEING.UPGRADED.* 无法更改。此项目的父项有一个挂起的删除，必须首先签入。

有关任何其他错误的信息，请参见输出工具窗口。

* * *

所以基本上它是说nuget删除了旧项目然后TFS对它们设置了一个删除标志，nuget尝试复制与已删除项目同名的新项目，并且TFS有一个嘶嘶声，因为之前的删除没有被检查还在。

我该如何解决这个问题？

我可以通过仅将具有不同名称的文件放入其中来了解 jquery 包的工作原理，例如 jquery-1.0.js 被删除 jquery-1.1.js 被复制，因此没有冲突。这对我来说并不实用，因为我想使用相同的图像等，而且我不会在每次进行更改时都重命名它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-29T21:29:59.853

这是一个与 NuGet 和 TFS 相关的经过验证的错误，目前正在 NuGet 上进行修复周期。

[http://nuget.codeplex.com/workitem/4037](http://nuget.codeplex.com/workitem/4037)

我多次遇到同样的错误。我有一个包含一些 Dll 和一堆其他内容文件（css、js、图像等）的 MVC 项目。在尝试了许多不同的事情之后，我发现了以下解决问题的方法。

将所有 Dll 打包在一个单独的 NuGet 包中，没有任何内容。将任何其他文件打包到单独的包中。适当地标记两个包，以便用户可以轻松地找到两个包并相互关联。

您还可以在 Dll 包中创建对内容包的依赖项（如果您愿意），以便安装 Dll 包会自动触发安装内容包。

这对我有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T22:42:24.617

您是否尝试在 nuget.config 文件中设置“DisableSourceControlIntegration”键？更多细节可以在这里找到@ [http://docs.nuget.org/docs/workflows/using-nuget-without-committing-packages](http://docs.nuget.org/docs/workflows/using-nuget-without-committing-packages)

请注意，这是特定于解决方案的，因此必须添加到解决方案中 .\nuget 文件夹下的 nuget.config 文件中。“启用包还原”自动添加此文件。

谢谢

布瓦

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-27T19:57:18.503

此缺陷被认为已在早​​期版本的 NuGet 中得到修复。但是，直到 2.8 版本才真正修复它，该版本目前处于测试阶段，应该很快就会发布。

在此处查看问题：

[https://nuget.codeplex.com/workitem/2606](https://nuget.codeplex.com/workitem/2606)

[https://nuget.codeplex.com/workitem/1690](https://nuget.codeplex.com/workitem/1690)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-07T14:41:00.373

我过去遇到过这种情况，我怀疑您使用的是本地工作区？尝试将您的工作区转换为服务器工作区，或者您可以创建第二个工作区并将其用于 NuGet 更新。

道格

# java - 如何让一种方法接收一个可以是字符串或字符数组的参数？

> ID：13370875
> 
> 赞同：1
> 
> 时间：2012-11-13T23:48:08.440
> 
> 标签：java

用户必须能够向`MyString`对象传递一个 char 数组`arr = {'g','o','o','d','b','y','e' }`，或者一个字符串，比如“hello”。我不知道从哪里开始，因为我不知道如何制作一个可以接收双重类型的方法。 .

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T23:51:43.277

只需重载您的方法：

```
public static String foo(String s) {
    // do something 
}

public static String foo(char[] s) {
    return foo(new String(s));
} 
```

* * *

***编辑***在您的标题中，您说的是*方法*，但在您的示例中，您显示了*构造函数*。无论如何，相同的想法可以应用于两者。

```
public MyString(String s) {
    // do something
}

public MyString(char[] s) {
    this(new String(s));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T23:56:42.523

我认为这样的事情会起作用

```
public class MyString {

    private char[] val

    public MyString(String s) {
        val = s.toCharArray();
    }

    public MyString(char[] c) {
        val = c;
    }

    public String toString() {
        return new String(val);
    }

    public char charAt(int i) {
        return val[i];
    }
} 
```

这是相当骨架化的，但这是我处理它的方式。希望能帮助到你 ：）

# ios - 在钛中如何截取完整的滚动视图？

> ID：13370876
> 
> 赞同：0
> 
> 时间：2012-11-13T23:48:12.660
> 
> 标签：ios, titanium, titanium-mobile

我正在使用 Titanium Appcelerator 为 IOS 开发

我想截取比屏幕高的完整滚动视图的屏幕截图

以下代码将只截取设备上可见 UI 的屏幕截图

```
Ti.Media.takeScreenshot(function(e){
    Ti.Media.saveToPhotoGallery(e.media);
}); 
```

我的问题是如何为整个滚动视图截屏

此致

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T04:48:56.173

这很容易！你可以通过简单地调用 toImage 方法来做到这一点

```
 Ti.Media.saveToPhotoGallery(myView.toImage()); 
```

**注意：myView 是 myScrollView 的子元素**

**我从Hakim Messaoud** 那里得到了答案[http://developer.appcelerator.com/question/144683/how-to-take-a-screenshot-of-full-scrollview#comment-146883](http://developer.appcelerator.com/question/144683/how-to-take-a-screenshot-of-full-scrollview#comment-146883)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-04T05:55:42.263

您还可以执行以下操作：

```
Ti.Media.takeScreenshot(function(e) {
    scrollView.toBlob();
    Ti.Media.saveToPhotoGallery(e.media);
}); 
```

# python - 使用 Python 从批处理文件实时输出

> ID：13370877
> 
> 赞同：1
> 
> 时间：2012-11-13T23:48:13.277
> 
> 标签：python, batch-file, python-3.x

我正在尝试从批处理文件 LIVE 运行时获取输出。我希望批处理文件的控制台在运行时也显示出来。我尝试过使用`os.popen`，`subprocess.Popen`但问题是它不会在后台实时运行程序并不断显示正在打印到控制台的内容。

正是我想要的，是有一个字符串，它会使用正在运行的批处理文件的控制台中的数据不断更新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T00:00:30.110

你不能用`os.system`吗？

# android - Android使用变量添加外部JAR

> ID：13370878
> 
> 赞同：1
> 
> 时间：2012-11-13T23:48:17.693
> 
> 标签：android, eclipse

我有一个 android 项目，其中外部 JAR 是使用 eclipse 外部变量配置的，用于在设备和模拟器中构建/运行时可以正常工作。

我已经更新到最新的 Android eclipse 插件和 SDK 工具，如果我将我的 jar 文件复制到 libs 子目录并将其添加到它可以工作的构建路径（构建/运行），这将不再有效。

当我将变量与外部 JAR 一起使用时，它构建得很好，但是在尝试运行时缺少类。

我想使用带有变量的外部 JAR 并避免将文件复制到 libs//

这仍然可能吗，任何想法为什么这对我的情况不起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T15:43:00.497

现在需要将库标记为已导出，我在这里找到了信息[http://tools.android.com/recent/dealingwithdependenciesinandroidprojects](http://tools.android.com/recent/dealingwithdependenciesinandroidprojects)

# java - JBoss 在展开的部署目录上重新部署更改

> ID：13370879
> 
> 赞同：1
> 
> 时间：2012-11-13T23:48:22.647
> 
> 标签：java, jboss, jboss-4.2.x

寻找一种在不重新启动 JBoss 的情况下部署新更改的方法导致我这样做：

[https://community.jboss.org/wiki/RedeployAnApplicationWhenChangeAFileInAnExplodedDeploymentDirectory](https://community.jboss.org/wiki/RedeployAnApplicationWhenChangeAFileInAnExplodedDeploymentDirectory)

起初，我以为我刚刚找到了圣杯，触摸爆炸目录上的顶级描述符将重新部署新的更改，但随后奇怪的行为和错误开始了。

事实证明 servlet 和 Java 类没有被重新部署，在阅读了许多否定的答案之后，我放弃了这个，但至少我想知道，在触及顶级描述符后重新部署了什么？

如果你们需要知道，我正在部署一个 Java EE 项目作为对 JBoss 4x 的战争。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T08:28:23.620

虽然应用程序确实重新部署了工作目录，但默认情况下并没有真正删除（它是 JBoss 保存已编译 jsp 的地方），因此在重新部署后它可能会保留以前编译的 jsp 类。

在 JBoss 5.1 中（我不能 100% 确定它是否在 JBoss 4.x 中可用）有一个选项可以强制 JBoss 在应用程序未部署 - 重新部署时删除它的工作目录。您可以在以下位置找到此选项：$JBOSS_HOME/server/yourInstance/deployers/jbossweb.deployer/META-INF/war-deployers-jboss-beans.xml，在此文件中查找属性：

```
<property name="deleteWorkDirOnContextDestroy">true</property> 
```

默认情况下它设置为 false，所以设置为 true。也许在重新部署时它可能有助于解决您的问题，尽管热部署的成功可能取决于对其他类的依赖等。另一方面，在热部署或重新部署应用程序时，使用移动命令（mv），但不要复制(cp) 一，因为 mv 是原子的，但不是 cp（使用 cp 可以在文件仍在复制时激活热部署扫描器）。

热重新部署的另一个解决方案是手动删除它，（仅推荐用于开发环境）我们使用以下命令链（记住您已经在部署目录中）：

```
rm yourapp.war; rm -rf ../work/jboss.web/localhost/yourapp;mv <newappversiondir>/yourapp.war . 
```

但请记住，**强烈建议不要**在生产环境和关键环境中进行热部署。

# jquery - 来自 IE9 的非常奇怪的 JSON ajax 响应

> ID：13370880
> 
> 赞同：0
> 
> 时间：2012-11-13T23:48:36.577
> 
> 标签：jquery, ajax, json, internet-explorer-9, cross-domain

**我在网上搜索了许多针对 IE9 ajax 跨域问题的解决方案，但找不到任何解决方案。**

我用于 ajax 调用的 url 看起来像这样（这是跨域，因为我的域看起来像 www.domain.com）：

```
"http://some.domain.com/folder//api/12c63101-5d02-ab70-6e2a-4519ed75a0fd/rename?accept=json" 
```

ajax 调用看起来像这样：（我尝试添加/删除 crossDomain/type 以及我能想到的任何东西）

```
$.ajax({
        url:url,
        dataType:'json',
        type: 'POST',
        crossDomain: true,
        success:function(data){}
        complete : function(data) {}}) 
```

这是来自 chrome 的一个可爱的响应（这次请求应该失败了）：

```
 {errorCode: -3997, errorDescription: "[runtime][RECOVERABLE] failed, name [] taken", success: false, payload: null} 
```

**但这是来自 IE9 的奇怪反应**

```
LOG: {
readyState : 0,
setRequestHeader : function(a,b){if(!s){var c=a.toLowerCase();a=m[c]=m[c]||a,l[a]=b}return this},
getAllResponseHeaders : function(){return s===2?n:null},
getResponseHeader : function(a){var c;if(s===2){if(!o){o={};while(c=bH.exec(n))o[c[1].toLowerCase()]=c[2]}c=o[a.toLowerCase()]}return c===b?null:c},
overrideMimeType : function(a){s||(d.mimeType=a);return this},
abort : function(a){a=a||"abort",p&&p.abort(a),w(0,a);return this},
done : function(){if(c){var a=c.length;m(arguments),i?k=c.length:e&&e!==!0&&(j=a,n(e[0],e[1]))}return this},
fail : function(){if(c){var a=c.length;m(arguments),i?k=c.length:e&&e!==!0&&(j=a,n(e[0],e[1]))}return this},
progress : function(){if(c){var a=c.length;m(arguments),i?k=c.length:e&&e!==!0&&(j=a,n(e[0],e[1]))}return this},
state : function(){return e},
isResolved : function(){return!!e},
isRejected : function(){return!!e},
then : function(a,b,c){i.done(a).fail(b).progress(c);return this},
always : function(){i.done.apply(i,arguments).fail.apply(i,arguments);return this},
pipe : function(a,b,c){return f.Deferred(function(d){f.each({done:[a,"resolve"],fail:[b,"reject"],progress:[c,"notify"]},function(a,b){var c=b[0],e=b[1],g;f.isFunction(c)?i[a](function(){g=c.apply(this,arguments),g&&f.isFunction(g.promise)?g.promise().then(d.re,
promise : function(a){if(a==null)a=h;else for(var b in h)a[b]=h[b];return a},
success : function(){if(c){var a=c.length;m(arguments),i?k=c.length:e&&e!==!0&&(j=a,n(e[0],e[1]))}return this},
error : function(){if(c){var a=c.length;m(arguments),i?k=c.length:e&&e!==!0&&(j=a,n(e[0],e[1]))}return this},
complete : function(){if(c){var a=c.length;m(arguments),i?k=c.length:e&&e!==!0&&(j=a,n(e[0],e[1]))}return this},
statusCode : function(a){if(a){var b;if(s<2)for(b in a)j[b]=[j[b],a[b]];else b=a[v.status],v.then(b,b)}return this},
status : 0,
statusText : "No Transport" 
```

}

（当我尝试将其解析为 JSON 时，IE9 响应在代码中触发`SCRIPT1014: Invalid character`，因为它显然不是 JSON……）

与“无运输”有关吗？有跨域问题？

UTF-8？（已经声明`$.ajaxSetup({ scriptCharset: "utf-8" , contentType: "application/json; charset=utf-8"});`

我绝望了-有人可以建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T02:06:32.460

尝试设置：

```
jQuery.support.cors = true; // force cross-site scripting (as of jQuery 1.5) 
```

看看它是否有帮助。

# c++ - 并行程序中的多图或排序向量

> ID：13370887
> 
> 赞同：1
> 
> 时间：2012-11-13T23:48:59.510
> 
> 标签：c++, multithreading, vector, parallel-processing, multimap

我有一个必须并行化的程序。它可能包含大量数据。这些数据可以通过一个 id 来标识，并且更多的数据可以具有相同的 id。我的程序的每个线程都会恢复具有特定 id 的所有数据并对其进行处理。

我的问题是对于并行程序，最好的解决方案是使用按数据 id 排序的多图或向量？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T23:53:01.360

抽象数据类型并实现通用解决方案。然后替换这两种数据类型，看看哪一种表现更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T00:01:10.120

这取决于数据的大小。例如，如果您有数据`A` `B` `C`并且`D`大小为 2、10、20、30，并且使用 4 个线程运行，那么您将遇到负载平衡问题。线程 A 将比其余线程做更少的工作。不幸的是，对数据进行排序对您没有帮助。

将数据存储在堆栈中（例如）并让线程独立于 id 从堆栈中完成工作可能会更好。但是，您必须同步堆栈。

如果您事先知道每个 id 数据包含的大小，则可以将它们分组为由数据 id 组成的块。这些块将具有大致相同的大小。

然后你可以制作一个映射`<K,V>`，其中`V`将是块和`K`将计算这些块的线程的 id。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T00:12:37.910

unordered_map 可能是一个很好的解决方案。由于它是作为散列实现的，相同的 id 最终会出现在相同的桶中。
此外，哈希表在处理大型数据集时也很好，因为它们提供了一种将数据分组到可以单独处理的存储桶中的机制。

# c++ - 动态对象指针数组 C++

> ID：13370889
> 
> 赞同：0
> 
> 时间：2012-11-13T23:49:12.923
> 
> 标签：c++, pointers, inheritance

我想创建一个指针数组来保存该类实例的地址，所以当我调用我的`scanner`函数时，它将搜索具有相同的对象`pcode`并打印它们。我有点这样做，但现在当我尝试使用不同的继承类对象时，我得到一个“内存访问冲突”，我无法通过基本静态扫描函数访问继承的类函数。

抱歉这里的混乱是我的代码

```
using namespace std;
class product{
    public:
        product();
        product(long&,string&);
        void const printer();
        void setCode();
        void getCode(long);

        void static scanner();
        static product *point; //when this was static did compile but not now
        static  int a;
    private:
        string pname;
        long pcode;

};
class PrepackedFood:public product{
    //snip
private:
    double uPrice;
};
class FreshFood:public product{
    //snip
private:
    double weight;
    double pricepk;
}; 
```

产品.cpp

```
product *product::point=new product [15];  //when i use try to use dynamic cant
int product::a(0);   

product::product(){
    pcode=0;
    pname="unknown";            
    point[a]= this;                            //here works for normal arrays not now
    a++;
}
product::product(long& c,string&n){
    pcode=c;
    pname=n;
}
void product::scanner(){
    long a;
    int i=0;
    while(i<3){
        if (point[i]->pcode==a){
            point[i]->printer();
            break;
        }
        i++;    
    }
}
void product::setCode(){ 
    cout<<"enter product name\n  ";
    cin>>pname;
    cout<<"enter product code _____\b\b\b\b\b\a";
    cin>>pcode;
}

//blah blah for other members 
```

主文件

```
#include "product.h"
#include <iostream>
int main(){
    int i=0;
    cout<<"enter fresh foods"<<endl;
    FreshFood f[3];

    for(int a=0;a<3;a++)
        f[i].setCode();
    product::scanner();

    return 0;
} 
```

是内存地址问题还是完全不同的问题？为什么`scan{this->print()}`调用基函数？有没有办法调用继承的`print()`函数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T00:44:43.457

好吧，既然我终于简化了您的问题文本，那么答案如下：

*   `void const printer();`这不编译。如果您希望调用函数以调用最派生类型的函数，则必须标记该函数`virtual`。此外，在`const`名称*之后*。
*   `void setCode();`商店产品直接从控制台读取通常不是一个好主意。它的工作是成为一个项目，项目不解析数字。外部函数应该解析输入。
*   `static product *point;`这可能应该替换为`std::vector<product*>`. 这是一个指向单个产品的动态指针数组。指向每个产品的指针允许`virtual`函数的多态性以您希望的方式工作。
*   `product *product::point=new product [15];``product`创建一个包含 15 个对象的数组。Not`PrepackedFood`或任何其他类型的对象，这些*只是* `products`. 不多也不少。此外，您正在泄漏此内存。用一个`vector`
*   `point[a]= this;`这甚至不能编译，因为`point[a]`is a`product`和`this`是一个指针。
*   `product::product(long& c,string&n)`此功能不注册产品。使用此制作的任何产品都未在您的阵列中注册，因此无法找到。幸运的是，您没有使用它。
*   `void getCode(long) {`我什至不确定这段代码做了什么，这太糟糕了。
*   `void product::scanner(){`使用 for 循环而不是 while 循环，这只是令人困惑。此外，您只扫描制作的前三个项目，它可能应该扫描所有制作的项目。在这里使用 a`vector`会有所帮助。
*   如果 a`product`被破坏（这是非常常见的），那么整个设计将失败并且修复将非常复杂。我不知道你在做什么，但我建议你现在停下来。

我得到了这一切吗？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-14T00:07:36.750

我认为您需要尝试使用容器来实现您的“数组”。std::list 将是一个好的开始。看看[这篇文章](http://www.cprogramming.com/tutorial/stl/stllist.html)，向下滚动到带有 for 循环的示例，这应该可以帮助您清理代码并修复内存访问问题。请记住，您可以将整个对象存储在列表中，而不仅仅是指向它们的指针。
此外，您可以尝试将数据与代码分离。尝试为您的数据使用结构。

# jquery - 滑动切换 Jquery 有时会卡住我不知道为什么

> ID：13370894
> 
> 赞同：4
> 
> 时间：2012-11-13T23:49:59.223
> 
> 标签：jquery, html, css

嗨，基本上我有一个元素，当我将鼠标悬停在它上面时，我有一个从底部向上滑动的 div，当我停止将鼠标悬停在元素上时，div 会向下滑动。

目前我有它的工作，但在奇怪的情况下，上下滑动的 div 会卡住，上下滑动是相反的，我不知道为什么。反转是指当我不悬停时显示 div 元素，然后当我悬停时它会向下滑动。

使元素暂时停止这样做的唯一方法是刷新。

谁能指导我解决这个问题？

非常感谢

代码：JAVA 脚本

```
 $(document).ready(function () 
       {
        $("div.small_info_container").hover(function () 
        {  
          $(this).parent().find('div.small_slide_info_container').slideToggle("fast");
        });
      }); 
```

CSS：

```
.elem {
width: 248px;
height: 238px;
margin: 10px 0 0 5px;
float: left;
border: 1px solid #ACACAC;
background: white;
box-shadow: 3px 4px 2px -2px #CACACA;
-webkit-border-radius: 3px;
-moz-border-radius: 3px;
border-radius: 3px;

}

.small_info_container {
position: absolute;
width: 248px;
height: 238px;
background:transparent;
}

.small_slide_info_container {
position: absolute;
width: 248px;
height: 45px;
background: rgba(173, 173, 173, 0.36);
display: none;
bottom: 0;
} 
```

HTML

```
<div class="elem">
    <div class="small_info_container">
        <div class="small_slide_info_container">
        </div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T00:00:49.863

尝试这个....

```
 $(document).ready(function () 
           {
            $("div.small_info_container").mouseover(function () {  
     $(this).parent().find('div.small_slide_info_container').stop().slideDown("fast");
                }).mouseleave(function(){
        $(this).parent().find('div.small_slide_info_container').stop().slideUp("fast");
            })    
          });​ 
```

演示：http: [//jsfiddle.net/mSWP8/7/](http://jsfiddle.net/mSWP8/7/)

# asp.net - 如何调用 IsOneWay WCF 服务并正确关闭客户端

> ID：13370896
> 
> 赞同：0
> 
> 时间：2012-11-13T23:50:07.557
> 
> 标签：asp.net, wcf, isoneway

我对 WCF 很陌生，我已经设置了一个测试网站和服务。我正在尝试两个完成两件事：

1.  在不阻塞用户的情况下调用服务
2.  正确关闭客户端

我创建了一个 web 服务并给它 isoneway 属性。我设法在不阻止用户的情况下调用它，但我担心我没有关闭客户端。如何在不阻止用户的情况下调用此服务并仍然正确关闭客户端？我应该使用异步方法（TestServiceAsync）吗？我应该使用 BeginXX、EndXX 方法吗？

客户：

```
Dim callservice As New WCFEmailServices.EmailServiceClient()
callservice.TestService()
callservice.Close() 
```

网络服务：

```
 <ServiceContract()> _
    Public Interface IEmailService

        <OperationContract(IsOneWay:=True)> _
        Sub TestService()

    End Interface

    Public Class EmailService
    Implements IEmailService

    Public Sub TestService() Implements IEmailService.TestService

        Dim srvBody As String = ""
        srvBody = "START: " + DateTime.Now.ToLongTimeString() + System.Environment.NewLine
        Thread.Sleep(10000)
        srvBody += "END: " + DateTime.Now.ToLongTimeString() + System.Environment.NewLine

        Me.SendEmail("test@gmail.com", "test", srvBody, Nothing)

    End Sub

    Function SendEmail(ByVal srpTo As String, ByVal srpSubject As String, ByVal srpBody As String, ByVal srpAttachmentPath As String) As Boolean

        Dim MailMsg As New MailMessage(New MailAddress("No_Reply@test.com"), New MailAddress(srpTo))
        MailMsg.BodyEncoding = Encoding.UTF8
        MailMsg.Subject = srpSubject
        MailMsg.Body = srpBody
        MailMsg.IsBodyHtml = True

        If srpAttachmentPath IsNot Nothing Then
            Dim srvAttachment As New Attachment(srpAttachmentPath)
            MailMsg.Attachments.Add(srvAttachment)
        End If

        Dim SmtpMail As New SmtpClient("smtp.gmail.com", 587)
        SmtpMail.UseDefaultCredentials = False
        SmtpMail.EnableSsl = True
        SmtpMail.Credentials = New System.Net.NetworkCredential("No_Reply@test", "password")

        Try
            SmtpMail.Send(MailMsg)
        Catch
            Return False
        End Try
        Return True
    End Function

End Class 
```

网络配置：

```
 <system.serviceModel>
        <bindings>
   <wsHttpBinding>
    <binding name="WSHttpBinding_IEmailService" closeTimeout="00:01:00"
     openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
     bypassProxyOnLocal="false" transactionFlow="false" hostNameComparisonMode="StrongWildcard"
     maxBufferPoolSize="524288" maxReceivedMessageSize="65536" messageEncoding="Text"
     textEncoding="utf-8" useDefaultWebProxy="true" allowCookies="false">
     <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
      maxBytesPerRead="4096" maxNameTableCharCount="16384" />
     <reliableSession ordered="true" inactivityTimeout="00:10:00"
      enabled="false" />
     <security mode="Message">
      <transport clientCredentialType="Windows" proxyCredentialType="None"
       realm="" />
      <message clientCredentialType="Windows" negotiateServiceCredential="true"
       algorithmSuite="Default" establishSecurityContext="true" />
     </security>
    </binding>
   </wsHttpBinding>
  </bindings>
  <client>
   <endpoint address="http://localhost:61450/EmailService.svc" binding="wsHttpBinding"
    bindingConfiguration="WSHttpBinding_IEmailService" contract="WCFEmailServices.IEmailService"
    name="WSHttpBinding_IEmailService">
    <identity>
     <servicePrincipalName value="host/localhost" />
    </identity>
   </endpoint>
  </client>
  <services>
   <service behaviorConfiguration="WCFService.Service1Behavior"
    name="WCFService.Service1">
    <endpoint address="" binding="wsHttpBinding" contract="WCFService.IService1">
     <identity>
         <servicePrincipalName value="host/localhost" />
     </identity>
    </endpoint>
    <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
   </service>
   <service behaviorConfiguration="ClientWebApp.EmailServiceBehavior"
    name="ClientWebApp.EmailService">
    <endpoint address="" binding="wsHttpBinding" contract="ClientWebApp.IEmailService">
     <identity>
         <servicePrincipalName value="host/localhost" />
     </identity>
    </endpoint>
    <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
   </service>
  </services>
        <behaviors>
   <serviceBehaviors>
    <behavior name="WCFService.Service1Behavior">
     <serviceMetadata httpGetEnabled="true" />
     <serviceDebug includeExceptionDetailInFaults="false" />
    </behavior>
    <behavior name="ClientWebApp.EmailServiceBehavior">
     <serviceMetadata httpGetEnabled="true" />
     <serviceDebug includeExceptionDetailInFaults="false" />
    </behavior>
   </serviceBehaviors>
  </behaviors>
    </system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T02:06:31.300

您在 IsOneWay 调用后正确关闭了客户端。根据您的绑定， close() 会阻塞，直到 IsOneWay 完成。

您可以在此处找到更多信息：[在 One Way WCF 调用后调用服务代理块上的 Close()](https://stackoverflow.com/questions/3398630/calling-close-on-service-proxy-blocks-after-one-way-wcf-call)

并从这个博客中得到答案：[WCF Best Practice #5](http://bloggingabout.net/blogs/gerben/archive/2010/02/01/wcf-best-practice-5-one-way-is-not-always-really-one-way.aspx)

# image-processing - 在位图中可视化 ASCII 文本

> ID：13370897
> 
> 赞同：4
> 
> 时间：2012-11-13T23:50:14.737
> 
> 标签：image-processing, bitmap, ascii, ascii-art

我有一个巨大的 ASCII 文本，表示像 ASCII-art 这样的位图。现在我正在寻找类似倒置 ASCII-art 生成器的东西。我喜欢将每个字符转换为彩色像素。

有没有免费的工具可以做这样的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T09:45:03.883

您没有使用特定编程语言的标签。因此，Mathematica 去..

我`Rasterize`用来将字母转换为字母的图像。然后我可以提取像素矩阵`ImageData`。的`Mean`所有像素是计算字母的最终像素值的一种可能性。将其放入一个存储像素值的函数中，这样我们就不必一遍又一遍地计算：

```
toPixel[c_String] := toPixel[c] = Mean[Flatten[ImageData[Rasterize[
 Style[c, 30, FontFamily -> "Courier"], "Image", ColorSpace -> "Grayscale"]]]] 
```

现在您可以将字符串拆分为行，然后将其应用于每个字符。填充结果列表以再次获得完整矩阵后，您将获得图像

```
data = toPixel /@ Characters[#] & /@ StringSplit[text, "\n"];
Image@(PadRight[#, 40, 1] & /@ data) // ImageAdjust 
```

对于本文

```
 ,i!!!!!!;,
      .,;i!!!!!'`,uu,o$$bo.
    !!!!!!!'.e$$$$$$$$$$$$$$.
   !!!!!!! $$$$$$$$$$$$$$$$$P
   !!!!!!!,`$$$$$$$$P""`,,`"
  i!!!!!!!!,$$$$",oed$$$$$$
 !!!!!!!!!'P".,e$$$$$$$$"'?
 `!!!!!!!! z$'J$$$$$'.,$bd$b,
  `!!!!!!f;$'d$$$$$$$$$$$$$P',c,.
   !!!!!! $B,"?$$$$$P',uggg$$$$$P"
   !!!!!!.$$$$be."'zd$$$P".,uooe$$r
   `!!!',$$$$$$$$$c,"",ud$$$$$$$$$L
    !! $$$$$$$$$$$$$$$$$$$$$$$$$$$$$
    !'j$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  d@@,?$$$$$$$$$$$$$$$$$$$$$$$$$$$$P
  ?@@f:$$$$$$$$$$$$$$$$$$$$$$$$$$$'
   "" `$$$$$$$$$$$$$$$$$$$$$$$$$$F
       `3$$$$$$$$$$$$$$$$$$$$$$F
          `"$$$$$P?$$$$$$$"`
                    `"" 
```

我们得到

![数学图形](../Images/56354e687e7cf5f7f14e6c563b1e7808.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-07-02T02:50:12.693

### 使用 Java 从 ASCII 艺术作品中恢复图像

假设我们有组成 ASCII 图像的字符的密度比例，因此我们可以从中恢复灰度位图。并且我们假设每个字符占据一个`21×8`像素区域，所以在还原的时候，我们要对图片进行放大。

ASCII 文本 (image.txt)：

```
***************************************
***************************************
*************o/xiz|{,/1ctx*************
************77L*```````*_1{j***********
**********?i```````````````FZ**********
**********l`````````````````7**********
**********x`````````````````L**********
**********m?i`````````````iz1**********
************]x```````````\x{***********
********?1w]c>```````````La{]}r********
******jSF~```````````````````^xv>******
*****l1,```````````````````````*Sj*****
****7t```````````````````````````v7****
***uL`````````````````````````````t]*** 
```

ASCII图片（截图）：

![ASCII图片](../Images/069287e7cb23376fb26d08a46955c8f3.png)

还原图片：

![恢复图片](../Images/b59a2c4771ae2210f2fa0622bd1dcbcc.png)

* * *

此代码读取一个文本文件，从字符密度获取亮度值，从中创建灰度颜色，将这些颜色中的每一种重复 21 次高度和 8 次宽度，然后将图片保存为灰度位图。

没有缩放`scH=1`和`scW=1`，像素数等于原始文本文件中的字符数。

字符密度比例应与构建 ASCII 图像所用的相同。

```
class ASCIIArtToImage {
  int width = 0, height = 0;
  ArrayList<String> text;
  BufferedImage image;

  public static void main(String[] args) throws IOException {
    ASCIIArtToImage converter = new ASCIIArtToImage();
    converter.readText("/tmp/image.txt");
    converter.restoreImage(21, 8);
    ImageIO.write(converter.image, "jpg", new File("/tmp/image.jpg"));
  }

  public void readText(String path) throws IOException {
    BufferedReader bufferedReader = new BufferedReader(new FileReader(path));
    this.text = new ArrayList<>();
    String line;
    while ((line = bufferedReader.readLine()) != null) {
      this.width = Math.max(this.width, line.length());
      this.text.add(line);
    }
    this.height = this.text.size();
  }

  public void restoreImage(int scH, int scW) {
    this.image = new BufferedImage( // BufferedImage.TYPE_BYTE_GRAY
            this.width * scW, this.height * scH, BufferedImage.TYPE_INT_RGB);
    for (int i = 0; i < this.height; i++) {
      for (int j = 0; j < this.width; j++) {
        // obtaining a brightness value depending on the character density
        int val = getBrightness(this.text.get(i).charAt(j));
        Color color = new Color(val, val, val);
        // scaling up the image
        for (int k = 0; k < scH; k++)
          for (int p = 0; p < scW; p++)
            this.image.setRGB(j * scW + p, i * scH + k, color.getRGB());
      }
    }
  }

  static final String DENSITY =
        "@QB#NgWM8RDHdOKq9$6khEPXwmeZaoS2yjufF]}{tx1zv7lciL/\\|?*>r^;:_\"~,'.-`";

  static int getBrightness(char ch) {
    // Since we don't have 255 characters, we have to use percentages
    int val = (int) Math.round(DENSITY.indexOf(ch) * 255.0 / DENSITY.length());
    val = Math.max(val, 0);
    val = Math.min(val, 255);
    return val;
  }
} 
```

* * *

^(另请参阅：[从图像中绘制 ASCII 艺术](https://stackoverflow.com/a/68186829/16314724)•[将图像转换为 ASCII 艺术](https://stackoverflow.com/a/68279251/16314724))

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T22:35:48.490

我刚刚使用 image-gd 库编写了一个非常简单的 php 脚本。它从 textarea 公式中读取文本，并使用 ASCII 值和一些乘法器函数为字符分配颜色，以使“a”和“b”等近邻 ASCII 之间的颜色差异可见。目前它只适用于已知的文本大小。

```
<?php

if(isset($_POST['text'])){
    //in my case known size of text is 204*204, add your own size here:
    asciiToPng(204,204,$_POST['text']);
}else{
    $out  = "<form name ='textform' action='' method='post'>";
    $out .= "<textarea type='textarea' cols='100' rows='100' name='text' value='' placeholder='Asciitext here'></textarea><br/>";
    $out .= "<input type='submit' name='submit' value='create image'>";
    $out .= "</form>";
    echo $out;
}

function asciiToPng($image_width, $image_height, $text)
{
    // first: lets type cast;
    $image_width = (integer)$image_width;
    $image_height = (integer)$image_height;
    $text = (string)$text;
    // create a image
    $image  = imagecreatetruecolor($image_width, $image_height);

    $black = imagecolorallocate($image, 0, 0, 0);
    $x = 0;
    $y = 0;
    for ($i = 0; $i < strlen($text)-1; $i++) {
        //assign some more or less random colors, math functions are just to make a visible difference e.g. between "a" and "b"
        $r = pow(ord($text{$i}),4) % 255;
        $g = pow(ord($text{$i}),3) % 255;
        $b = ord($text{$i})*2 % 255;
        $color = ImageColorAllocate($image, $r, $g, $b);
        //assign random color or predefined color to special chars ans draw pixel
        if($text{$i}!='#'){
            imagesetpixel($image, $x, $y, $color);
        }else{
            imagesetpixel($image, $x, $y, $black);
        }
        $x++;
        if($text{$i}=="\n"){
            $x = 0;
            $y++;
        }
    }
    // show image, free memory
    header('Content-type: image/png');
    ImagePNG($image);
    imagedestroy($image);
}
?> 
```

# c++ - 程序只读取第一行！C++

> ID：13370906
> 
> 赞同：3
> 
> 时间：2012-11-13T23:50:31.733
> 
> 标签：c++, arrays, function, arraylist, line

我的程序应该使用 .txt 文件作为输入（时间以 1 到 10 秒为单位）来计算坠落物体的距离。文本文件内容如下：

1 2 3 4 5 6 7 8 9 10

到目前为止，这是我的代码。

```
#include <iostream>
#include <fstream>
#include <cmath>
#include <cstdlib>
using namespace std;

//function prototype
double fallingDistance (int);

void main()
{
    ifstream inputFile;
    int time;
    double distance;

    //open the file
    inputFile.open("05.txt");
    inputFile >> time;

    {
        distance = fallingDistance (time);
        cout << time << "\t\t" << distance << endl;
    }
}
double fallingDistance (int time)
{
    double distance, gravity=9.8;
    distance = static_cast<double>(0.5 * gravity * pow(time,2));
    return distance;
} 
```

这就是我的程序编译的内容：

> `1 4.9` `press any key to continue...`

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T23:53:17.040

```
cout << time << "\t\t" << distance << endl; 
```

您首先`int`从输入文件中读取一个。接下来，您`distance`使用`time`. 然后你要打印 的值`time`，两个制表符，最后是 的值`distance`。

此行执行后`main`返回并且您的程序退出。你为什么期望它打印其他东西？

如果您需要从文件中获取更多值，那么您需要使用循环，将整个过程包装在一个循环中，该循环从文件中读取，直到它完成整个过程。就像是：

```
inputFile.open("05.txt");
int time;
while(inputFile >> time) {     
    distance = fallingDistance (time);
    cout << time << "\t\t" << distance << endl;
} 
```

* * *

在旁注中，`main`标准将其定义为返回类型为`int`，而不是`void`。像您所做的那样省略参数 (`int argc`和) 很好。`char *argv[]`

# java - 不断收到我的程序的错误代码，有人可以看看吗？

> ID：13370909
> 
> 赞同：0
> 
> 时间：2012-11-13T23:50:35.703
> 
> 标签：java

运行我的程序时，出现以下错误：

```
Exception in thread "main" java.lang.Error: Unresolved compilation problem: 

at CylinderTest.main(Cylinder.java:42) 
```

我确信有一个简单的解决方案，但我是一个没有经验的程序员，对我来说它似乎应该工作。

程序说明：编写一个名为 CylinderTest.java 的类，并声明一个由三个 Cylinder 对象组成的数组，以调用您在 Cylinder 类中声明的方法。确保从 main() 调用所有类方法。让 main() 显示 volume() 返回的值，并通过手动计算（纸/铅笔）验证返回的值。提示用户输入数组中每个 Cylinder 对象的半径和高度值。

```
public class Cylinder 
{
  private double radius;
  private double height;
  public Cylinder(double radius, double height)
  {
      this.radius = radius;
      this.height = height;
  }
  public double getRadius()
  {
      return radius;
  }
  public double getHeight()
  {
      return height;
  }
  public double volume()
  {
      return radius*radius*height*3.1416;
  }

}

public class CylinderTest
{

public static void main(String[] args) 
{

    Cylinder[] myCylinder = new Cylinder[3];
    myCylinder [0] = new Cylinder (2,7);
    myCylinder [1] = new Cylinder (9,3);
    myCylinder [2] = new Cylinder (12,4);
    for (Cylinder c: myCylinder)
    {
        System.out.println("*******");
        System.out.println("Radius: " + c.getRadius());
        System.out.println("Height: " + c.getHeight());
        System.out.println("Volume: " + c.volume());
        System.out.println("*******");
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:52:10.330

> 线程“main”java.lang.Error 中的异常：未解决的编译问题：
> 
> 在 CylinderTest.main(Cylinder.java:42)

由于文件第 42 行存在错误，您的类`Cylinder`无法编译`Cylinder.java`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T00:07:17.260

这是因为您在一个文件中有两个单独的公共类。将 CylinderTest 拆分为自己的文件。一般来说，有一个分隔测试类的目录结构是有用的：

```
src
   main
      java
   test
      java 
```

您还应该为 Cylinder (say) org.me 创建一个包名

在这种情况下，两个类都应该有

```
package org.me; 
```

在顶部。

您应该使用 IDE（例如 Eclipse 或 Netbeans），这会在您尝试运行它之前告诉您存在编译错误。通常运行有错误的程序是一个糟糕的主意，而且通常很难判断发生的位置和情况。但是 Eclipse 通常会提供一个堆栈跟踪，该堆栈跟踪将链接到有问题的行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T00:12:46.757

Woot4Moo 已经解释了异常的直接原因。基本上，您不能运行使用具有编译错误的类的程序。在尝试运行程序之前修复所有编译错误：

*   如果您在 Eclipse 中访问该文件，编译错误应标记为红色。

*   如果工作区中存在编译错误，您可以将 Eclipse 配置为不允许您运行代码。

由于我们看不到实际的编译错误，我无法确定这一点。但是，我*怀疑*根本问题是您在一个文件中有两个顶级`public`类（称为“Cylinder.java”）。你不能在 Java 中做到这一点。非嵌套`public`类必须位于单独的源文件中。（您可以使用“包私有”类来避免这样做，但这是不好的做法。）

解决方法是将 Cylinder 和 CylinderTest 类放在单独的源文件中。

（理想情况下，您还应该添加包声明，但我猜您的讲师尚未向您解释这些内容。）

# mysql - 如何在 phpmyadmin 中删除或替换数据库上的 mySQL 转储文件？

> ID：13370911
> 
> 赞同：0
> 
> 时间：2012-11-13T23:51:00.193
> 
> 标签：mysql, wordpress, phpmyadmin

我刚刚从另一个数据库导入了一个数据库上的 mySQL 转储文件。

原因是我正在按照[这些步骤](http://dan.doezema.com/2010/04/wordpress-domain-change/comment-page-1/#comment-9160)将网站从一台服务器转移到另一台服务器。我认为我做的不对，因为我没有得到我应该在第 8 步得到的东西：`in a web browser go to: http://www.yourNewDomain.com/wp-change-domain.php`。

如何在 phpmyadmin 中删除或替换数据库上的 mySQL 转储文件？我将尝试再次导入我的数据库以查看第 8 步是否有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T00:11:28.087

由于您没有提供任何数据，因此很难判断教程的第 8 步有什么问题。但是，为了回答你的问题，我想你已经导入了整个 wordpress 数据库：如果转储不正确并且你想再次导入它，你应该先删除它：

```
DROP DATABASE db_name; 
```

然后重新导入它。要非常小心，如果您不确定自己在做什么，请不要这样做，您可能会丢失数据！

# java - Java Rmi UnknownHostException

> ID：13370912
> 
> 赞同：4
> 
> 时间：2012-11-13T23:51:03.123
> 
> 标签：java, rmi

我正在尝试编写一个简单的 RMI 文件，但由于某种原因，它给了我一个*未知的主机名*异常。在实际提出问题之前，我已经尝试了一切。这是该项目的代码。

RMI接口类：

```
import java.rmi.Remote;
import java.rmi.RemoteException;

public interface Hello extends Remote {
    String sayHello() throws RemoteException;
} 
```

服务器类：

```
import java.rmi.registry.Registry;
import java.rmi.registry.LocateRegistry;
import java.rmi.RemoteException;
import java.rmi.server.UnicastRemoteObject;

public class Server implements Hello {

    public Server() {}

    public String sayHello() {
        return "Hello, world!";
    }

    public static void main(String args[]) {

        try {
            Server obj = new Server();
            Hello stub = (Hello) UnicastRemoteObject.exportObject(obj, 0);

            // Bind the remote object's stub in the registry
            Registry registry = LocateRegistry.getRegistry();
            registry.bind("Hello", stub);

            System.err.println("Server ready");
        } catch (Exception e) {
            System.err.println("Server exception: " + e.toString());
            e.printStackTrace();
        }
    }
} 
```

客户端类：

```
import java.rmi.registry.LocateRegistry;
import java.rmi.registry.Registry;

public class Client {

    private Client() {}

    public static void main(String[] args) {

        String host = (args.length < 1) ? null : args[0];
        try {
            Registry registry = LocateRegistry.getRegistry(host);
            Hello stub = (Hello) registry.lookup("Hello");
            String response = stub.sayHello();
            System.out.println("response: " + response);
        } catch (Exception e) {
            System.err.println("Client exception: " + e.toString());
            e.printStackTrace();
        }
    }
} 
```

当我在 localhost 上运行它时，它运行得很好，但是对于我的生活，我无法让它在两台机器上通过网络运行。我试过了：

*   通过 Wifi 连接机器。
*   通过以太网连接，因此它们分别具有类似`192.168.1.1`和的地址`192.168.1.2`。两台机器可以互相ping通。如果我`nma -PN`是来自客户端的服务器，我可以看到该端口`1099`已打开并且`rmiregistry`正在运行。但无论我尝试哪种主机名组合，它仍然无法将客户端连接到服务器。

我尝试在客户端作为主机名输入的组合：

```
rmi://192.168.1.1
rmi://192.168.1.1:1099 
```

也许还有几十个，所有可能的斜杠等。仍然不知道为什么这不起作用（即使它在 localhost 上完美运行）。任何想法都会受到欢迎。

为了完整起见，这是我得到的实际错误：

```
 java -classpath classes/ Client
Client exception: java.rmi.UnknownHostException: Unknown host: rmi://192.168.1.1; nested exception is:
    java.net.UnknownHostException: rmi://192.168.1.1
java.rmi.UnknownHostException: Unknown host: rmi://192.168.1.1; nested exception is:
    java.net.UnknownHostException: rmi://192.168.1.1
    at sun.rmi.transport.tcp.TCPEndpoint.newSocket(TCPEndpoint.java:598)
    at sun.rmi.transport.tcp.TCPChannel.createConnection(TCPChannel.java:198)
    at sun.rmi.transport.tcp.TCPChannel.newConnection(TCPChannel.java:184)
    at sun.rmi.server.UnicastRef.newCall(UnicastRef.java:322)
    at sun.rmi.registry.RegistryImpl_Stub.lookup(Unknown Source)
    at Client.main(Client.java:14)
Caused by: java.net.UnknownHostException: rmi://192.168.1.1
    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:195)
    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366)
    at java.net.Socket.connect(Socket.java:529)
    at java.net.Socket.connect(Socket.java:478)
    at java.net.Socket.<init>(Socket.java:375)
    at java.net.Socket.<init>(Socket.java:189)
    at sun.rmi.transport.proxy.RMIDirectSocketFactory.createSocket(RMIDirectSocketFactory.java:22)
    at sun.rmi.transport.proxy.RMIMasterSocketFactory.createSocket(RMIMasterSocketFactory.java:128)
    at sun.rmi.transport.tcp.TCPEndpoint.newSocket(TCPEndpoint.java:595)
    ... 5 more 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T08:29:12.533

这已解决。我只会发布我自己的解决方案。显然像这样运行服务器是有效的：java -Djava.rmi.server.hostname=192.168.1.1 Server.The 问题是当客户端调用服务器并取回一个存根时，这个存根包含这个属性，而 java 将此属性设置为默认情况下为 localhost，即使您在创建注册表时将服务器绑定到 ip。这就是为什么即使您的客户端正在连接到远程主机，它也会崩溃，说本地主机上的连接被拒绝，因为它的存根包含本地主机。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-23T23:59:56.753

Just a comment on the mapping between host name and IP: you can name you locator whatever you like but then you will have to insert an entry in your hosts file (C:\Windows\system32...\hosts), e.g.

```
127.0.0.1  rmihost1 
```

Then you can rmihost1 in the call:

```
LocateRegistry.getRegistry(host, port); 
```

# javascript - 全局范围内的 this

> ID：13370913
> 
> 赞同：1
> 
> 时间：2012-11-13T23:51:07.570
> 
> 标签：javascript, node.js

该声明：

```
for( var item in this){
    console.log( item );
} 
```

在全球范围内是一个 noop。然而在一个函数中

```
function foo(){
    for( var item in this){
        console.log( item );
    }
}
foo(); 
```

这会产生全局环境对象。这种行为的原因是什么？

如第一个示例所示，访问当前范围内的对象的语法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T11:53:32.103

在 JavaScript 中，“this”不是当前对象，而是当前方法的运行上下文。

例如 ：

```
function foo(){ 
   console.log(this);
} 
```

在全球范围内：

*   如果我调用*foo()*，控制台日志是*全局的*
*   如果我调用*setTimeout(foo, 0)*，控制台会记录 Timer 对象，因为 foo 是由计时器调用的。

调用方法的最佳方式是在调用方法时使用 Function 对象的 call 方法绑定自己的运行上下文。

```
foo.call(this); 
```

* * *

*对不起，我的英语不好。^-^*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T00:05:06.257

看看[MDN 对`this`关键字](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this)的介绍。

在全局范围内，`this`指的是全局对象。

在严格模式下（您似乎没有启用），一个简单的函数调用会导致一个`undefined`this 值。

对于非严格函数（比如你的`foo`），一个简单的调用会导致`this`再次成为全局对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T00:10:37.160

`this`可能指向节点的导出对象。

所以在第一种情况下，`this`不指向`window`对象是正确的。在第二种情况下，the`this`位于函数内部（它不是对象的方法），因此，正如您所料，它指向`window`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-14T00:15:01.317

[ECMA-262 §10.4.1.1](http://www.ecma-international.org/ecma-262/5.1/#sec-10.4.1.1)表明当进入全局执行上下文时，`this`设置为全局对象。所以如果第一个代码示例是在全局上下文中执行的，`this`应该引用全局对象。

我没有`node.js`，但如果那是主机环境，您应该`node.js`在问题中添加一个标签以吸引了解`node.js`.

在第二个例子中，函数`this`不是由调用设置的，所以它默认为全局对象。在严格模式下，它将是未定义的，尝试访问`this`将引发错误。

# web-services - UEFA/FIFA 分数 API

> ID：13370914
> 
> 赞同：72
> 
> 时间：2012-11-13T23:51:12.927
> 
> 标签：web-services, api, rss

有人知道[欧足联](http://www.uefa.com/)或[国际足联](http://www.fifa.com/)是否为足球比赛、官方球员名单、转会等提供分数 api 吗？

我找到[了footytube api](http://www.footytube.com/openfooty/api_overview.php)，但不确定它的稳定性和完整性..

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2013-07-21T07:15:08.047

UEFA 或 FIFA 似乎没有提供任何 API 来获取您想要的信息。但是，有一些第三方服务支持：

*   [OPTA](http://www.optasports.com/) - 商业和免费。他们拥有令人难以置信的比赛数据库。Whoscored.com 目前使用它。

*   其他：记分牌，xmlsoccer，...

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2015-02-15T10:00:40.130

[http://api.football-data.org/index](http://api.football-data.org/index)是免费且有用的。该 API 正在积极开发中，稳定，最近第一个版本发布，称为 alpha 已上线。检查博客部分以跟踪更新和更改。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-07-16T06:40:07.890

UEFA 在内部为其广播合作伙伴提供自己的***LIVEX*** Api。那一个足够完美，可以由他们的合作伙伴自己开发应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-07-23T11:00:00.857

您可以找到 stats-dot-com - 我个人认为它们比 opta 更好。ESPN 似乎没有提供完整的数据，也没有提供实时数据馈送（不幸的是）。

我们一直在为我们的奇幻游戏（solutionsforfantasysport.com）寻找官方数据源，并且仍然主要使用 stats-com（使用 opta，datafactory 以及）

# spring - Spring Mongo Repository 保存失败？

> ID：13370915
> 
> 赞同：2
> 
> 时间：2012-11-13T23:51:13.323
> 
> 标签：spring, mongodb, repository

我无法通过我的 spring 存储库保存一个简单的文档。这是文件：包com.foundry.domain；

```
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

import javax.persistence.Temporal;
import javax.persistence.TemporalType;
import javax.validation.constraints.NotNull;

import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.index.GeoSpatialIndexed;
import org.springframework.data.mongodb.core.index.Indexed;
import org.springframework.format.annotation.DateTimeFormat;
import org.springframework.roo.addon.javabean.RooJavaBean;
import org.springframework.roo.addon.layers.repository.mongo.RooMongoEntity;
import org.springframework.roo.addon.tostring.RooToString;

import com.foundry.domain.location.Location;

@RooJavaBean
@RooToString
@RooMongoEntity
public class Sensor {
    @Id
    String id;

    @Indexed(unique=true)
    String name;

    @NotNull
    String typeRef;

    @NotNull
    @Indexed
    private List<String> tags = new ArrayList<String>();

    @GeoSpatialIndexed
    Location location;

    @Temporal(TemporalType.TIMESTAMP)
    @DateTimeFormat(style = "M-")
    private Date creationDate = new Date();

} 
```

在我的测试课中，我正在执行以下操作：

```
@Test
    public void testSaveSingleSensor(){
        Sensor s = new Sensor();
        s.setName("Test");
        s.setLocation(new Location());
        s.getLocation().setX(12);
        s.getLocation().setY(13);
        s.getLocation().setZ(14);
        s.setTypeRef("blah");
        s = iSensorRepository.save(s);
        s = iSensorRepository.findOne(s.getId());
        Assert.assertNotNull(s);
        Assert.assertTrue(s.getId() != null);
    } 
```

我基本上创建了一个传感器，尝试存储它，然后尝试立即检索它。我所知道的是 Location 对象导致它不被保存。如果我注释掉位置对象的设置，它就可以工作。这是位置对象：

```
package com.foundry.domain.location;

import java.util.Date;

import javax.persistence.Temporal;
import javax.persistence.TemporalType;

import org.springframework.format.annotation.DateTimeFormat;
import org.springframework.roo.addon.javabean.RooJavaBean;
import org.springframework.roo.addon.tostring.RooToString;

@RooJavaBean
@RooToString
public class Location {
    double x=0;
    double y=0;
    double z=0;

    @Temporal(TemporalType.TIMESTAMP)
    @DateTimeFormat(style = "M-")
    private Date lastUpdate;

} 
```

我相信这与我对 GeoSpatial Index 的误解有关。我假设我们可以有其他数据（z 和 lastUpdate），但也许我错了。我没有发现任何其他指示。更多测试即将到来，但感谢所有帮助。

# spss - 如何在SPSS中计算组均值差异和效应大小？

> ID：13370918
> 
> 赞同：2
> 
> 时间：2012-11-13T23:51:58.443
> 
> 标签：spss

我想使用学生的治疗总分和对照组总分，并衡量“分数之间的差异”。然后我想测量每个“差异”分数的效果大小和显着性。如何在 SPSS 中执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T09:57:52.597

我假设您有两组仅在一个时间点进行测量。

您可以使用`Analyze - GLM - Univariate`并将组放入固定因子并将治疗得分放入因变量。这是一个更通用的工具，也可用于因子设计。

您也可以`Analyze - Compare means - Independent Groups T-test`在您的情况下使用。

在计算效果大小方面，我想你会想要计算标准化组平均差（即 Cohen's d）。最简单的方法是采用组均值和标准差，并将值手动插入公式或在线计算器。例如，请参见此处的[此计算器](http://www.uccs.edu/~lbecker/)或此处[讨论的组平均效应大小公式](http://en.wikipedia.org/wiki/Effect_size#Effect_sizes_based_on_means_or_distances_between.2Famong_means)之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T15:23:55.347

请检查 GLM（很可能是 GLM1 ANOVA）。SPSS 帮助中也有一个示例。您也可以查看以下来源： http: [//www.cob.unt.edu/itds/faculty/evangelopoulos/busi6480/BUSI6480_HW4_solutions_Spring2009.pdf](http://www.cob.unt.edu/itds/faculty/evangelopoulos/busi6480/BUSI6480_HW4_solutions_Spring2009.pdf)

# php - 如何使用带有 php 日期的时区？

> ID：13370921
> 
> 赞同：1
> 
> 时间：2012-11-13T23:52:06.963
> 
> 标签：php, mysql, timezone, utc

我有一个`PHP`页面正在拉入日期字符串。

```
eg. 2012-11-10 11:37:06 
```

我知道这个时间是在一个特定的时区。

我想将此日期`UTC`及时存储在`MySQL`日期字段中，以便以后可以将其转换为客户的本地时间。

我怎样才能做到这一点`PHP`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T00:00:57.523

要转换时区，请使用 DateTime 类[http://www.php.net/manual/en/class.datetime.php](http://www.php.net/manual/en/class.datetime.php)

```
// Create a DateTime object with your local time and local timezone.
$d = new DateTime('2012-11-10 11:37:06', new DateTimeZone('Pacific/Auckland'));

// Convert to UTC
$d->setTimeZone(new DateTimeZone('UTC'));

// outputs 2012-11-09 22:37:06
echo $d->format('Y-m-d H:i:s'); 
```

# php - 从两个表中提取

> ID：13370928
> 
> 赞同：1
> 
> 时间：2012-11-13T23:52:45.443
> 
> 标签：php, android, mysql, api

我有两个正在使用的表示例 我正在使用输出来构建数组，所以我的输出需要是单列

第一个表是产品列表

```
 PRODUCT ID    PRODUCT_NAME
    01            product1
    02            product2
    03            product3
    04            product4
    05            product5
    06            product6
    07            product7
    08            product8
    09            product9
    10            product10
    11            product11
    12            product12 
```

表二是采购清单

```
 SALESID       PRODUCT_NAME       USERID       DATE
    01            product1           001ABC       11-10-2012
    02            product5           001ABC       11-11-2012
    03            product1           002XYZ       11-11-2012
    04            product12          001ABC       11-13-2012
    05            product7           001ABC       11-13-2012
    06            product3           002XYZ       11-14-2012
    07            product11          002XYZ       11-14-2012 
```

现在我需要的是，如果我提供像 001ABC 这样的 USERID，我需要输出为 1，如果 USERID 与我提供的匹配并且（它应该自动）它出现在产品表中并且我需要它显示 0 如果它只出现在产品表中

所以上面两个表的两个例子和这两个 USERID 看起来像这样

USERID 001ABC 提供的产量

```
 OUTPUT
  1
  0
  0
  0
  1
  0
  1
  0
  0
  0
  0
  1 
```

USERID 002XYZ 提供的产量

```
 OUTPUT
  1
  0
  1
  0
  0
  0
  0
  0
  0
  0
  1
  0 
```

使用 CASE 语句失败或我没有得到正确的语法我正在使用 PHP 和 MYSQL

只要我有一个 USERID，我当前的查询就可以正常工作，但是当我尝试按 userID 过滤时也失败了

PHP/MYSQL 查询：

```
 SELECT (PURCHASES.PRODUCT_NAME IS NOT NULL) AS purchased 
    FROM PRODUCTS 
      LEFT JOIN PURCHASES 
      ON PRODUCT_NAME = PRODUCT_NAME ORDER BY 1 
```

我不确定我做错了什么。

当我添加另一个购买两次的用户时，结果似乎只是在输出中添加了两行，因此输出将有 14 行，而不是我展示的示例中的原始 12 行。

我怎样才能获得单列输出，其记录总数等于每行设置为零的产品总数，除非在由产品名称标识的购买表中找到匹配项，然后在 1 中而不是零输出。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T00:25:45.617

这是您想要的查询。您需要按产品 ID 对结果进行排序；您按输出列中的 0/1 值对它们进行排序，这当然会破坏该列的有用性。

您还需要对过滤后的购买表进行汇总，以确定是否有任何特定产品的购买。那是子查询“b”。

最后，您离开了从产品到购买的连接，因为您希望每个产品的输出结果集中只有一行。

```
 select ifnull(b.number>0,0) output
       from products a
  left join (
              select count(*) number,
                     product_name
                from purchases
               where userid = '001ABC'
            group by product_name
           ) b on a.product_name = b.product_name
  order by a.product_id 
```

例如，请参阅此 SQL Fiddle。[http://sqlfiddle.com/#!2/6e985/12/0](http://sqlfiddle.com/#!2/6e985/12/0)

# ruby - Ruby 中的 Alnum 类

> ID：13370932
> 
> 赞同：4
> 
> 时间：2012-11-13T23:52:55.480
> 
> 标签：ruby, regex

`\p{Alnum}`Ruby 语言的正则表达式中的类是什么？它包含哪些字符，它与 有何不同`[:alnum:]`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-14T01:32:41.270

基于[rdoc](http://www.ruby-doc.org/core-1.9.3/Regexp.html)和本[教程](http://www.regular-expressions.info/posixbrackets.html)，这两个表达式是等价的。

它们包含字母和数字字符。如果只使用 ASCII 字符，则相当于`[a-zA-Z0-9]`. 如果有非 ASCII 字符，则两者都`[:alnum:]`包括`p{Alnum}`重音字符之类的内容。

# c++ - C++ 放置新

> ID：13370935
> 
> 赞同：6
> 
> 时间：2012-11-13T23:52:59.887
> 
> 标签：c++

抱歉，如果这个问题听起来很愚蠢，但我刚刚开始学习 C++，而且我对新的位置感到困惑

我一直在阅读 C++ Primer（我发现这是一本非常好的学习 C++ 的书），并且在安置新部分中给出了一个示例。该示例使用 char 数组为放置 new 提供内存空间

```
const int BUF = 512;
const int N = 5;
char buffer[BUF];
double * pd1;
pd1 = new (buffer) double[N]; 
```

我的问题是为什么它使用 char 数组来为放置 new 提供内存空间？上面代码中的最后一行也是为 double 数组分配内存，当原始内存空间包含 char 数组时，这怎么可能？如果放置 new 正在使用 char 数组的内存空间，这是否意味着当我们分配 double 数组时它会覆盖该内存中的 char 数组？

如果问题很奇怪，再次抱歉，但希望我已经说得很清楚了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-13T23:58:40.033

> 为什么它使用 char 数组来为放置 new 提供内存空间？

为什么不？`char`是 C++ 定义的最小类型，几乎在每个实现中，它的大小都是一个字节。因此，当您需要分配一定大小的内存块时，它是一种很好的类型。

C++ 也有关于如何分配数组`char`(并且*只* `char`分配) 的非常具体的机制。`new char[*]`例如， A 不会与 的对齐方式对齐`char`。它将与任何类型的最大法线对齐方式对齐。因此，您可以使用它来分配内存，然后将任何类型构造到该内存中。

> 上面代码中的最后一行也是为 double 数组分配内存，当原始内存空间包含 char 数组时，这怎么可能？

它没有分配任何东西。它正在使用您给它的内存*构造一个数组。*这就是placement new 所做的，它在提供的内存中构造一个对象。

> 如果放置 new 正在使用 char 数组的内存空间，这是否意味着当我们分配 double 数组时它会覆盖该内存中的 char 数组？

是的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T23:57:54.373

是的，char 数组和 double 数组会重叠，更具体地说，它们会从内存中的相同地址开始，即`(long)buffer`相同`(long)pd1`。我们可以通过使字节大小匹配（假设`sizeof(char) == 1`）来更加强调重叠：

```
const int N = 5;
char buffer[N * sizeof(double)];
double *pd1 = new (buffer) double[N]; 
```

是的，如果您修改数据`pd1`点，那么数据`buffer`点也会被修改。反之亦然。（另请参阅 GCC 标志`-fstrict-aliasing`以了解编译器优化如何处理这种重叠。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-13T23:57:06.523

没有愚蠢的问题。

它使用 char 可能是因为它让您考虑原始字节（char 通常为 1 个字节长）。代码的最后一行没有分配内存，它只是在提到的缓冲区上放置一个双精度数组。如果它是一个对象，它也会调用构造函数。是的，char 数组被覆盖。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-13T23:57:27.577

记忆就是记忆。机器不关心存储在那里的数据类型，这取决于定义和执行的语言。“为什么”的答案是“因为 C++ 旨在让你”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-14T00:00:44.093

`char buffer[BUF];`只是一些记忆。字节组成缓冲区没有附加类型信息。只有编译器知道，这个内存区域应该保存字符。你可以使用任何类型，甚至是双精度：

```
double buffer[BUF];
double *pd1 = new (buffer) double[N]; 
```

# php - 根据社交网络的 id 加载唯一页面

> ID：13370939
> 
> 赞同：0
> 
> 时间：2012-11-13T23:53:22.790
> 
> 标签：php

我正在创建一个社交网络。我创建了一个个人资料页面和一个新闻源类型的页面，可将您导航到个人资料页面。

我正在尝试根据您在另一个脚本中输入的数据轻松创建独特的基本配置文件布局。我有一个会话变量（$_SESSION['id']），我试图抓取它，将用户移动到基于它的页面，并加载与 MySQL 表中的 id 匹配的结果。但是，依赖于 id 的数据似乎不起作用。以下是关键脚本的摘录：

*导航菜单到配置文件*

```
<?

         function fetch_new_users()
        {
            $result = mysql_query("SELECT `id`, `username` FROM `users` WHERE username='{$_SESSION['user_login']}'");
            $mysql = mysql_fetch_assoc($result);

            return $mysql;
        }

        $users = fetch_new_users();
        ?>
        <?
        if (isset($_SESSION["user_login"])) {

        echo '

        <div class="fnav">

                 <?php foreach($users as $user): ?>
                            <p>
                                <a href="profile.php?id=<?php echo $user[\'id\']; ?>" >Profile</a>
                            </p>
                        <?php endforeach; ?>

        </div><!-- end fnav --> 
```

*登录时创建会话变量*

```
if(isset($_POST["user_login"]) && isset($_POST["password_login"]))
{
    $user_login = preg_replace('#[^A-Za-z0-9]#i', '', $_POST["user_login"]); // filter everything but numbers and letters
    $password_login = preg_replace('#[^A-Za-z0-9]#i', '', $_POST["password_login"]); // filter everything but numbers and letters
    $md5password_login = md5($password_login);
    $sql = mysql_query("SELECT id FROM users WHERE username='$user_login' AND password='$md5password_login' LIMIT 1"); // query the person
    //Check for their existance
    $userCount = mysql_num_rows($sql); //Count the number of rows returned
    if($userCount == 1)
    {
        while($row = mysql_fetch_array($sql))
        {
            $id = $row["id"];
        }
        $_SESSION["id"] = $id;
        $_SESSION["user_login"] = $user_login;
        $_SESSION["password_login"] = $password_login;
        exit("<meta http-equiv=\"refresh\" content=\"0\">");
    }
    else
    {
        echo 'That information is incorrect, try again';
        exit();
    } 
```

*从 MySQL 表中实际抓取数据*

```
 $id1 = $_GET['id'];
//check user exists
$check = mysql_query("SELECT * FROM `users` WHERE id='$id1'");
$get = mysql_fetch_assoc($check);
$username = $get['username'];
$firstname = $get['first_name']; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T00:32:02.440

这里的根本问题是使用/滥用 PHP 在自身和 HTML 之间随意跳转的能力。虽然它被广泛吹捧为一项功能，但对于任何不平凡的事情，它通常会导致服务器端代码、标记和客户端脚本的可怕意大利面条，所有这些都嵌入并相互交织在一起。解决方案**不是那样编写代码。**

现在，这很容易说，但这*意味着*什么？这意味着将 PHP 视为真正的独立语言。这也意味着拥抱 HTTP 请求周期并预先完成所有数据处理/处理。

因此，当您收到一个请求（GET 或 POST）时，不要马上跳起来编写一些 HTML 来向用户展示一些东西，而是停下来。根本不要写任何标记。相反，首先处理请求。

在您的情况下，您希望显示指向用户个人资料页面的链接。这意味着：

1.  确定用户是谁
2.  根据该信息生成正确的链接

你已经对你的函数有了正确的认识（编辑使它更容易阅读（双引号字符串是你的朋友）），所以从那个开始：

```
function fetch_new_users()
{
    $result = mysql_query("SELECT `id`, `username` FROM `users` WHERE username={$_SESSION['user_login']");
    $mysql = mysql_fetch_assoc($result);
    $newresult = $mysql;

    return $newresult;
}

$users = fetch_new_users(); 
```

现在，不要立即重复所有内容，而是继续进行您可能需要的任何处理。您已经在`$users`变量中获得了函数的结果，因此无需立即将其吐出。只需处理您的数据并将结果存储在变量中即可。

当您准备好实际显示信息时，创建整个模板：

```
<!doctype html>
<html>
    <!-- stuff -->

    <body>
        <!-- more stuff -->

        <?php foreach($users as $user): ?>
            <p>
                <a href="profile.php?id=<?php echo $user['id']; ?>" >Profile</a>
            </p>
        <?php endforeach; ?>
    </body>
</html> 
```

您的模板（可以是`include()`-ed）应该只包含最少的 PHP。 `echo`, `if/else`, `while()`, `for()`, 和`foreach()`应该是它们包含的限制。处理表单数据、查询数据库或任何其他此类有趣的东西不是模板的工作。

像这样拆分脚本是**Separation of Concerns**的一个示例，它基本上表示应用程序应该根据它们的功能拆分为组件。因此，就像 CSS 应该如何与 HTML 分开（一个是格式，另一个是结构）一样，PHP 也应该与 HTML 分开，但显示内容除外。

TLDR：更好地构建您的应用程序，不要遵循任何建议在 PHP 和 HTML 之间跳转的资源。你最终只会学习错误的方式来编写 PHP 应用程序。

# ruby-on-rails - 如何关联 3 个模型

> ID：13370946
> 
> 赞同：0
> 
> 时间：2012-11-13T23:54:12.463
> 
> 标签：ruby-on-rails, ruby, railstutorial.org

我目前有三个模型，用户、属性、租户。当我创建一个属性时，user_id 通过关联传递给该属性：

```
class User
  has_many :properties
end

class Property
  belongs_to :user
  has_many :tenants
end

class Tenant
  belongs_to :property
end 
```

我在尝试将 property_id 传递给租户时遇到了问题。我尝试了几种关联组合，但似乎没有任何效果。

我的租户数据库有一个 property_id 列，我可以手动向它添加一个 property_id，一切正常。但是我想做的是从一个属性中单击“新租户”，然后该租户与该属性相关联，但它没有发生。

我什至尝试通过以下方式将 property_id 传递到租户表单中的隐藏字段：

```
<%= render :partial => 'shared/new_tenant', :locals => { :tenant => Tenant.new(:property_id => @property.id) } %> 
```

但这也没有奏效。

任何建议都会挽救我剩下的理智。

谢谢，托尼。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T00:16:59.360

在模型中添加`belongs_to`,`has_many`等不足以在数据库中创建关系。他们所做的是通过查看`*_id`数据库中已经存在的字段来告诉 Rails 要建立哪些关联。

您需要确保您的租户表上有一个`property_id`类型。`Integer`如果您没有，您可以通过生成迁移来添加它：

```
rails g migration add_property_id_to_tenants property_id:integer 
```

然后运行`rake db:migrate`（如果其他模型也缺少这些列，则类似）

# java - 线程“主”java.lang.NoClassDefFoundError 中的异常：com/ibm/mq/MQException

> ID：13370947
> 
> 赞同：3
> 
> 时间：2012-11-13T23:54:17.077
> 
> 标签：java, ibm-mq

当我如下运行我的程序时，我遇到了异常，

> java -jar MQprogram.jar

我已经正确设置了类路径，它引用了所有必需的 jar，“com.ibm.mq.jmqi.jar”也在具有 MQException 的类路径中引用。

```
`线程“主”java.lang.NoClassDefFoundError 中的异常：com/ibm/mq/MQException
引起：java.lang.ClassNotFoundException：com.ibm.mq.MQException
        在 java.net.URLClassLoader$1.run（未知来源）
        在 java.security.AccessController.doPrivileged（本机方法）
        在 java.net.URLClassLoader.findClass（未知来源）
        在 java.lang.ClassLoader.loadClass（未知来源）
        在 sun.misc.Launcher$AppClassLoader.loadClass（未知来源）
        在 java.lang.ClassLoader.loadClass（未知来源）
        在 java.lang.ClassLoader.loadClassInternal（未知来源）
找不到主类：com.test.bo.MQprogram。程序将会退出。
`

```

我仍然不清楚错误在哪里。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T04:13:28.220

这几乎总是由不完整的客户端安装和/或 CLASSPATH 问题共同引起的。许多人获取 jar 文件而不是执行完整的安装，并且不一定获得所有这些文件。有时他们只是继续查找 jar 文件并抓取它们，而不考虑不同的版本。从 V7.0 开始，IBM 对 Java/JMS 类进行了重大重构，并从那时起也进行了一些更新。从 V7.0.1 开始，WMQ 可以安装到任意目录路径并在服务器上进行多次安装。这意味着现在可以有多个 JRE/s、多个客户端安装等。这并没有对 CLASSPATH 产生太大影响，但确实改变了依赖关系，例如 NLS 支持、跟踪以及 Java 类依赖/交互的其他事物。

建议安装完整的 WMQ 客户端并将 CLASSPATH 指向安装目录。如果这是不可能的，那么在*某个地方*安装一个完整的客户端并从已知良好的安装中获取完整的 jar 集。然后至少你知道你有所有相同的版本，等等。

如果您决定从 IBM 的分发媒体安装完整的客户端，您将获得一些附加功能，例如诊断和低级跟踪。它还确保可以应用维护。例如，您有一个在 Fix Pack 中得到纠正的问题，您只需在现有客户端安装之上安装 Fix Pack。如果您只有 jar 文件，则不会安装 Fix Pack。

WMQ 客户端以[SupportPacs](http://ibm.co/SupptPacs)的形式提供。您可以下载以下内容之一：

*   WMQ V7.0 客户端 == [SupportPac MQC7](http://ibm.co/SupptPacMQC7)
*   WMQ V7.1 客户端 == [SupportPac MQC71](http://ibm.co/SupptPacMQC71)
*   WMQ V7.5 客户端 == [SupportPac MQC75](http://ibm.co/SupptPacMQC75)

请务必将信息中心用于您正在使用的客户端版本！

*   [WMQ V7.0 信息中心](http://publib.boulder.ibm.com/infocenter/wmqv7/v7r0/index.jsp)
*   [WMQ V7.1 信息中心](http://publib.boulder.ibm.com/infocenter/wmqv7/v7r1/index.jsp)
*   [WMQ V7.5 信息中心](http://pic.dhe.ibm.com/infocenter/wmqv7/v7r5/index.jsp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T23:57:26.373

这意味着您的 CLASSPATH 中没有包含 .class 文件的 JAR `com.ibm.mq.MQException`。

这是 Java 101。

[这](http://www-01.ibm.com/support/docview.wss?uid=swg21316673)解释了如何处理它。

找到这个链接是谷歌 101。

# c++ - 以编程方式为 Windows 简化调度任务

> ID：13370949
> 
> 赞同：2
> 
> 时间：2012-11-13T23:54:22.287
> 
> 标签：c++, windows, scheduled-tasks

我正在为我的 c++/qt 应用程序寻找一些可以在 Windows 上提供编程/调度任务的项目/库/解决方案。我读过一些关于 Windows Task Schedulers 1.0 和 2.0 API-s 的文章，但我真的不喜欢它的 COM 接口。这次我需要与完整功能相反的简单性和可靠性。

下面附上的可能是一个模型解决方案，但它仅适用于 .NET。
[http://taskscheduler.codeplex.com/](http://taskscheduler.codeplex.com/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T05:37:46.157

请参阅Task Scheduler 1.0 的[这个](http://www.codeproject.com/Articles/75/Basic-class-for-using-the-Microsoft-Task-Scheduler)漂亮的包装器。它适用于所有版本的 Windows，包括 Windows 7/server 2008。但是，使用此包装器创建的任务将无法通过 Windows 7 控制面板显示。我增强了该类并添加了对 Task Scheduler 2.0 的支持。如果有兴趣，我可以提供一个例子。

# html - 使用 Groovy/Grails 以编程方式使用 html 模板

> ID：13370950
> 
> 赞同：2
> 
> 时间：2012-11-13T23:54:22.740
> 
> 标签：html, grails, groovy

我正在尝试使用带有 Grails 应用程序的 html 模板。我得到了一个 URL，需要在运行时将 html 动态加载到我的 Grails 视图中。在 HTML 代码中有一个 {title} 和一个 {content} 标记，我的 Grails 代码将被注入其中。

在 PHP 中，它类似于 include("url"); 现在我们如何在 Grails 中做到这一点，或者有可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T16:48:55.893

如果没有缓存，也没有真正诱人的解决方案，您的代码可能如下所示：

```
def template = new Url('http://example.com').getText()
def html
html = html.replaceAll('{title}','my Title')
html = html.replaceAll('{content}','my Content') 
```

[但 Raphael 绝对正确：如果您需要更复杂的解决方案（ http://groovy.codehaus.org/Groovy+Templates](http://groovy.codehaus.org/Groovy+Templates)），您应该看看 groovy 模板框架。

使用模板框架，您将首先准备模板

```
import groovy.text.SimpleTemplateEngine
def template = new Url('http://example.com').getText()
template = template.replaceAll('{title}','${title}')
template = tamplate.replaceAll('{content}','${content}') 
```

并将其作为缓存保存到数据库中。当您必须扩大您的 HTML 页面时，您将获取模板并让 groovy 替换占位符：

```
def binding = [title:"my Title", content:"my Content"]
def engine = new SimpleTemplateEngine()
html = engine.createTemplate(template).make(binding) 
```

就是这样。

# java - Hadoop map-reduce 输出包含奇怪的字符

> ID：13370960
> 
> 赞同：0
> 
> 时间：2012-11-13T23:55:44.007
> 
> 标签：java, hadoop

我正在运行地图缩减作业。当我在作为单节点集群的机器上运行它时，输出如图所示

```
hduser@nikhil-VirtualBox:/usr/local/hadoop/hadoop-1.0.4$ bin/hadoop dfs -text /user/hduser/output16/part-r-00000
0   Required Genotype column (s), Must not contain NULLS for required fields, failed, 5, 1: GENE_NAME; 2: GENE_NAME; 4: GENE_NAME; 5: GENE_NAME; 9: GENE_NAME 
```

但是，当我在更大的数据集上运行相同的 Amazon EMR 时，我会得到以下所有奇怪字符。可能是什么原因？

```
SEQorg.apache.hadoop.io.Textorg.apache.hadoop.io.Text\00\00\00\00\00\00\968\D6\FA\E1>X(.q\8B!\ABQ\00\00-\00\00\00
1537044153\8ERequired Genotype column (s), Must not contain NULLS for required fields, failed, 1, 1: VARIANT_START_POSITION; 2: VARIANT_START_POSITION; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T06:28:47.677

标头 (SEQTextText) 告诉您这是`SequenceFile`a`org.apache.hadoop.io.Text`作为键和值。

所以这是二进制而不是纯文本，你可以用`SequenceFile.Reader`.

# spring - NoSuchBeanDefinitionException 至少 1 个 bean 有资格作为此依赖项的自动装配候选者

> ID：13370961
> 
> 赞同：4
> 
> 时间：2012-11-13T23:55:57.187
> 
> 标签：spring, exception, spring-mvc, throw

我对 Spring 框架有问题，我一直在寻找解决方案，但没有任何结果。

当我部署应用程序时，出现异常：

```
14.11.2012 0:37:23 org.apache.catalina.core.ApplicationContext log
INFO: No Spring WebApplicationInitializer types detected on classpath
14.11.2012 0:37:23 org.apache.catalina.core.ApplicationContext log
INFO: Initializing Spring root WebApplicationContext
14.11.2012 0:37:24 org.apache.catalina.core.StandardContext listenerStart
SEVERE: Exception sending context initialized event to listener instance of class org.springframework.web.context.ContextLoaderListener
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userController': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private sk.peterjurkovic.moro.service.UserService sk.peterjurkovic.moro.controller.UserController.userService; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userServiceImpl': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private sk.peterjurkovic.moro.dao.UserDao sk.peterjurkovic.moro.service.UserServiceImpl.userDao; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userDaoImpl': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire method: public void sk.peterjurkovic.moro.dao.UserDaoImpl.setDataSource(javax.sql.DataSource); nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [javax.sql.DataSource] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {}
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:287)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1106)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:585)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:913)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:464)
    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:384)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:283)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4791)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5285)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:633)
    at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:655)
    at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:536)
    at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1453)
    at sun.reflect.GeneratedMethodAccessor31.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:301)
    at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:836)
    at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:761)
    at org.apache.catalina.manager.ManagerServlet.check(ManagerServlet.java:1445)
    at org.apache.catalina.manager.ManagerServlet.deploy(ManagerServlet.java:860)
    at org.apache.catalina.manager.ManagerServlet.doGet(ManagerServlet.java:357)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.filters.SetCharacterEncodingFilter.doFilter(SetCharacterEncodingFilter.java:108)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:581)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1002)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)
    at org.apache.tomcat.util.net.AprEndpoint$SocketProcessor.run(AprEndpoint.java:1813)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:662)
Caused by: org.springframework.beans.factory.BeanCreationException: Could not autowire field: private sk.peterjurkovic.moro.service.UserService sk.peterjurkovic.moro.controller.UserController.userService; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userServiceImpl': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private sk.peterjurkovic.moro.dao.UserDao sk.peterjurkovic.moro.service.UserServiceImpl.userDao; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userDaoImpl': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire method: public void sk.peterjurkovic.moro.dao.UserDaoImpl.setDataSource(javax.sql.DataSource); nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [javax.sql.DataSource] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {}
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:506)
    at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:87)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:284)
    ... 52 more
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userServiceImpl': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private sk.peterjurkovic.moro.dao.UserDao sk.peterjurkovic.moro.service.UserServiceImpl.userDao; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userDaoImpl': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire method: public void sk.peterjurkovic.moro.dao.UserDaoImpl.setDataSource(javax.sql.DataSource); nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [javax.sql.DataSource] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {}
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:287)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1106)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:848)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:790)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:707)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:478)
    ... 54 more
Caused by: org.springframework.beans.factory.BeanCreationException: Could not autowire field: private sk.peterjurkovic.moro.dao.UserDao sk.peterjurkovic.moro.service.UserServiceImpl.userDao; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userDaoImpl': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire method: public void sk.peterjurkovic.moro.dao.UserDaoImpl.setDataSource(javax.sql.DataSource); nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [javax.sql.DataSource] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {}
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:506)
    at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:87)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:284)
    ... 65 more
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userDaoImpl': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire method: public void sk.peterjurkovic.moro.dao.UserDaoImpl.setDataSource(javax.sql.DataSource); nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [javax.sql.DataSource] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {}
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:287)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1106)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:848)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:790)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:707)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:478)
    ... 67 more
Caused by: org.springframework.beans.factory.BeanCreationException: Could not autowire method: public void sk.peterjurkovic.moro.dao.UserDaoImpl.setDataSource(javax.sql.DataSource); nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [javax.sql.DataSource] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {}
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredMethodElement.inject(AutowiredAnnotationBeanPostProcessor.java:593)
    at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:87)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:284)
    ... 78 more
Caused by: org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [javax.sql.DataSource] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {}
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.raiseNoSuchBeanDefinitionException(DefaultListableBeanFactory.java:924)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:793)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:707)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredMethodElement.inject(AutowiredAnnotationBeanPostProcessor.java:551)
    ... 80 more
14.11.2012 0:37:24 org.apache.catalina.core.ApplicationContext log
INFO: Closing Spring root WebApplicationContext 
```

**这是 UserDaoImpl**，其中注入了 DataSource

```
@Component
public class UserDaoImpl implements UserDao {

    private JdbcTemplate template;

    @Override
    public List&lt;User&gt; findAll(){
        return template.query(Sql.SQL_QUERY_FIND_ALL ,new UserRowMapper&lt;User&gt;());
    }

    @Override
    public User fintById(long id){
        return template.queryForObject(Sql.SQL_QUERY_FIND_BY_ID,  new Object[]{id}, new UserRowMapper&lt;User&gt;());
    }

    @Override
    public void create(final User user){
        KeyHolder keyHolder = new GeneratedKeyHolder();
        PreparedStatementCreator psCreator = new PreparedStatementCreator() {
            @Override
            public PreparedStatement createPreparedStatement(Connection connection) throws SQLException {
                PreparedStatement stmt = connection.prepareStatement(
                Sql.SQL_QUERY_SAVE, Statement.RETURN_GENERATED_KEYS);
                stmt.setString(1, user.getFirstName());
                stmt.setString(2, user.getLastName());
                stmt.setString(3, user.getEmail());
                return stmt;
            }
        };

        template.update(psCreator, keyHolder);
        user.setId(keyHolder.getKey().longValue());
    }

    @Override
    public void delete(User user){
        template.update(Sql.SQL_QUERY_DELETE, new Object[]{ user.getId() });
    }

    @Autowired
    @Qualifier("dataSource")
    public void setDataSource(DataSource dataSource){
        template = new JdbcTemplate(dataSource);
    }        
} 
```

**应用程序上下文**

```
<?xml version="1.0" encoding="UTF-8" ?>
<beans xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:cache="http://www.springframework.org/schema/cache"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns="http://www.springframework.org/schema/beans"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans.xsd
                           http://www.springframework.org/schema/cache
                           http://www.springframework.org/schema/cache/spring-cache.xsd
                           http://www.springframework.org/schema/aop
                           http://www.springframework.org/schema/aop/spring-aop.xsd
                           http://www.springframework.org/schema/context
                           http://www.springframework.org/schema/context/spring-context.xsd">
    <mvc:annotation-driven/>
    <context:component-scan base-package="sk.peterjurkovic.moro" />
    <bean class="org.springframework.web.servlet.view.InternalResourceViewResolver" id="jspViewResolver">
        <property name="prefix" value="/WEB-INF/views/" />
        <property name="suffix" value=".jsp" />
    </bean>
    <import resource="db-config.xml" />
    <bean class="org.springframework.beans.factory.annotation.RequiredAnnotationBeanPostProcessor" />
    <aop:aspectj-autoproxy/>
    <bean class="sk.peterjurkovic.moro.dao.UserDaoImpl">
        <property name="dataSource" ref="dataSource" />
    </bean>
    <bean class="sk.peterjurkovic.moro.service.UserServiceImpl" />
</beans> 
```

数据库配置文件

```
<?xml version="1.0" encoding="UTF-8" ?>
<beans xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:jdbc="http://www.springframework.org/schema/jdbc"
       xmlns:jpa="http://www.springframework.org/schema/data/jpa"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns="http://www.springframework.org/schema/beans"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans.xsd
                           http://www.springframework.org/schema/jdbc
                           http://www.springframework.org/schema/jdbc/spring-jdbc.xsd
                           http://www.springframework.org/schema/data/jpa
                           http://www.springframework.org/schema/data/jpa/spring-jpa.xsd
                           http://www.springframework.org/schema/tx
                           http://www.springframework.org/schema/tx/spring-tx.xsd">
    <jdbc:embedded-database id="dataSource" type="DERBY">
        <jdbc:script location="classpath:create-schema.sql" />
    </jdbc:embedded-database>
    <bean class="org.springframework.jdbc.datasource.DataSourceTransactionManager" id="transactionManager">
        <constructor-arg ref="dataSource" />
    </bean>
</beans> 
```

使用 Tomcat 7、Java 6、Spring 版本 3.1.0.RELEASE

**编辑** 谢谢你的帮助，它只移动到 JdbcTemplate

```
Caused by: org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [org.springframework.jdbc.core.JdbcTemplate] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}
        at org.springframework.beans.factory.support.DefaultListableBeanFactory.raiseNoSuchBeanDefinitionException(DefaultListableBeanFactory.java:952)
        at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:821)
        at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:735)
        at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:478) 
```

**编辑**

问题解决了。我必须将 beans.xml 包含到 xx-servlet.xml 配置中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T02:26:06.323

设置器注入未正确应用。在春天，你不能打电话给新的运营商。查看 setter 和构造函数注入。这是一个setter注入的例子......试试这个：

```
@Repository
public class UserDaoImpl implements UserDao {

@Autowired
private JdbcTemplate template;

public void setJdbcTemplate(JdbcTemplate jdbcTemplate) {
      this.jdbcTemplate = jdbcTemplate;
}

@Override
public List<User> findAll(){
    return this.template.query(Sql.SQL_QUERY_FIND_ALL ,new UserRowMapper&lt;User&gt;());
}

@Override
public User fintById(long id){
    return this.template.queryForObject(Sql.SQL_QUERY_FIND_BY_ID,  new Object[]{id}, new UserRowMapper&lt;User&gt;());

}

@Override
public void create(final User user){
  ...
}

@Override
public void delete(User user){
    this.template.update(Sql.SQL_QUERY_DELETE, new Object[]{ user.getId() });
} 
```

**数据库上下文：**

```
<jdbc:embedded-database id="dataSource" type="DERBY">
    <jdbc:script location="classpath:create-schema.sql"/>
</jdbc:embedded-database>

 <!--JDBC Template Bean...-->
<bean id="reportJdbcTemplate" class="org.springframework.jdbc.core.JdbcTemplate">
    <property name="dataSource" ref="dataSource" />
</bean> 
```

对于存储库/DAO 类使用**@Respository**注解，而不是@Component。确保为 DAO 类启用基本扫描，以便 Spring 可以找到并注入它们。您不必使用@Service、@Repository 和@Controller 注释显式定义要注入到xml 文件中的bean。

```
<context:component-scan base-package="com.something.dao"/> 
```

希望有帮助。

# java - JTable 和构造函数参数

> ID：13370962
> 
> 赞同：1
> 
> 时间：2012-11-13T23:55:59.370
> 
> 标签：java, swing, jtable, defaulttablemodel

我正在学习如何在 Swing 中使用 JTables。我已经想出连接到数据库并检索结果集。我还可以使用第一个选项显示数据（见下文）。

a) 我想确保我理解使用/传递 TableModel 与直接传递行和列的想法是能够使用 AbstractTableModel 中可用的内置方法；DefaultTableModel 和 ListTableModel 类。

b) 什么是自定义 TableModel？

到目前为止，我遇到了 4 种方式：

1.  将列和行作为对象直接传递给 JTable 构造函数。

前任：

```
JTable tab = new JTable(Object [][] rows, Object[] cols); 
```

2\. 从实现 AbstractTableModel 的类创建表模型。

前任：

```
MyModel model = new MyModel(Object[][] obj1, String[] header);

//MyModel is a class that extends AbstractTableModel. 
//MyModel has an ArrayList<Object[]> to store obj1[]
//MyModel implements getRowCount(), getColumnCount() and 
getValueAt(int rowIndex, int columnIndex) and also getColumnName(int index)

JTable tab = new JTable(model); 
```

3.从实现 DefaultTableModel 的类创建表模型。

前任：

```
DefaultTableModel model = new DefaultTableModel(String data[][],String col[]);
(or)
DefaultTableModel model = DefaultTableModel(Vector data, Vector columnNames) 

JTable table = new JTable(model); 
```

4.ListTableModel

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T00:03:40.447

当您直接传递数据时，JTable 将在内部创建一个 DefaultTableModel，您可以通过调用`table.getModel()`.

不同的 TableModel 具有不同的功能，您可以通过创建实现 TableModel 或扩展 AbstractTableModel（或 DefaultTableModel）的类来实现自己的功能。这背后的想法是，您有时需要的不仅仅是原始表数据。

例如，如果您想将一个对象附加到每一行：您可以编写一个 TableModel，它每行保存一个对象并提供类似`Object getObject(int rowIndex)`和的方法`void setObject(int rowIndex, Object object)`。为此，您将在 TableModel 中保存一个额外的数组或列表，其中包含对象并且始终与行数具有相同的大小。

另一个原因可能是表格模型在您滚动时加载行数据，或者您希望动态显示来自多个数据源的数据。

TableModel 不一定要*保存*数据，它只是将数据提供给 JTable。

# c# - 使用 VB.NET 向新的 Fusion Table API v1.0 发布请求

> ID：13370963
> 
> 赞同：1
> 
> 时间：2012-11-13T23:56:16.187
> 
> 标签：c#, vb.net, google-fusion-tables

一段时间以来，我们一直在使用现已弃用的 Fusion Tables SQL API 来更新我们的 Google Fusion Table。我们创建了一个 VB.NET 应用程序来验证请求并执行必要的任务并且没有任何问题。我们正在尝试迁移到新的 v1.0 API，但遇到了多个问题。

我能够检索授权令牌，但我的问题在于创建一个 HTTP 请求以成功验证并发布请求。在此示例中，我正在尝试创建一个新表：

```
 Dim auth As OAuth2Authenticator(Of NativeApplicationClient) = GetAuthorization()
    Dim sURL As New StringBuilder
    Dim sRequest As New StringBuilder
    Dim encoding As New ASCIIEncoding()
    Dim data As Byte() = Nothing

    sURL.Append("https://www.googleapis.com/fusiontables/v1/tables")

    sRequest.Append("{")
    sRequest.Append(" ""name"": ""Insects"",")
    sRequest.Append(" ""columns"": [")
    sRequest.Append("  {")
    sRequest.Append("   ""name"": ""Species"",")
    sRequest.Append("   ""type"": ""STRING""")
    sRequest.Append("  },")
    sRequest.Append("  {")
    sRequest.Append("   ""name"": ""Elevation"",")
    sRequest.Append("   ""type"": ""NUMBER""")
    sRequest.Append("  },")
    sRequest.Append("  {")
    sRequest.Append("   ""name"": ""Year"",")
    sRequest.Append("   ""type"": ""DATETIME""")
    sRequest.Append("  }")
    sRequest.Append(" ],")
    sRequest.Append(" ""description"": ""Insect Tracking Information."",")
    sRequest.Append(" ""isExportable"": true")
    sRequest.Append("}")

    ' Create the request
    data = encoding.GetBytes(sRequest.ToString)
    Dim req As HttpWebRequest = DirectCast(WebRequest.Create(sURL.ToString), HttpWebRequest)
    req.Method = "POST"
    req.ContentType = "application/json"
    req.ContentLength = data.Length

    ' Add the authentication header
    req.Headers.Add("Authorization: " & gCode)

    ' Send the body of the request
    Dim st As Stream = req.GetRequestStream()
    st.Write(data, 0, data.Length)
    st.Close()

    Try
        Dim res As HttpWebResponse = DirectCast(req.GetResponse(), HttpWebResponse)
        Dim sr As New StreamReader(res.GetResponseStream())
        Dim sOutput As String = sr.ReadToEnd()
        Console.WriteLine(sOutput)
    Catch ex As Exception
        Debug.Print(ex.Message)
    End Try 
```

当我尝试创建 HttpWebResponse 时出现此错误：“远程服务器返回错误：(401) 未经授权。” 我想我正在寻找的是向 API 发布经过身份验证的请求以插入/更新/删除数据所需的代码。C# 中的示例也很好。

我已经查看了 .NET 的 Google API 客户端库，但我也无法实现它。

谢谢！

# python - GAE Expando 动态设置属性类型

> ID：13370964
> 
> 赞同：2
> 
> 时间：2012-11-13T23:56:20.713
> 
> 标签：python, google-app-engine

我正在使用 NDB 和一个名为 MBObject 的 Expando 模型，因为我在没有固定方案的情况下动态创建对象。我从字典创建对象：

```
dic = {"groupName" : "my group",
       "members" : [{"memberId" : "1"}, {"memberId" : "2"}]} 
```

所以我想做的是创建一个组对象，它有一个名为 members 的属性，其中 members 是 MBObjects 的 LocalStructuredProperty。（所有对象都是 MBObject 的，ndb.Expando 的子类）

但是，似乎没有办法动态指定第二部分，并且出现错误：

```
def config_obj_from_dic(dictionary):
    object = MBObject()
    for key, value in dictionary.iteritems():
        if isinstance(value, list):
            objects = list()
            for dic in value:
                objects.append(config_obj_from_dic(dic))
            value = objects
        setattr(object, key, value)
    return object 
```

所以基本上我最终得到了一个成员列表，并尝试将其设置为对象的属性，并希望它自动意识到我想要一个重复的 LocalStructuredProperty。所以很明显我看到了问题所在，它不够聪明，无法自己处理。问题是，我将如何让它处理它？

如果它不能与 LocalStructuredProperty 一起使用，那么我也可以使用 ndb.JsonProperty，但它仍然是同一个问题：我如何动态地告诉它我希望它成为某种类型的属性？

**tl;dr：**如果我有一个 Expando 模型，并且我有`setattr(object, key, a_list)`，我将一个属性设置为一个列表，我怎样才能让它知道我想要 a`LocalStructuredProperty`或 a `JsonProperty`，因为现在它不知道如何处理该列表.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T10:36:51.493

The NDB expando model uses [GenericProperty](https://developers.google.com/appengine/docs/python/ndb/properties#types) to set data, which only supports the following types: int, long, float, bool, str, unicode, datetime, Key, BlobKey, GeoPt, User, None.

To solve this problem: if you know all the properties and names of `members`, then you can use an expando model with predefined properties (described in the docs) as `LocalStructuredProperty`. However, if you don't know this (which would make sense since you're using expando), then the best options may be to serialize these members to JSON manually and save them in an expando property as a string.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T16:52:08.357

This issue may be realted: [http://code.google.com/p/appengine-ndb-experiment/issues/detail?id=216](http://code.google.com/p/appengine-ndb-experiment/issues/detail?id=216)

The fix will be in the next release of the AppEngine SDK. Looks like you'd do this by first storing Expando models inside the Expando model (taken from the issues page):

```
def test_expando_in_expando_with_lists(self):
        """Passes"""
        class B(ndb.Expando):
            pass
        class A(ndb.Expando):
            pass
        a = A(a1 = [B(b1 = [0,1,2,3]),B(b2='b2test')])
        new_a = A(**a.to_dict())
        self.assertEqual(a, new_a) 
```

I would take a look at the structure of `a.to_dict()` in the example above and verify how the dictionary object looks in comparison to your own. Also, I believe this will make a StructuredProperty, not a LocalStructuredProperty.

If you can pre-define the property type, this issue fixed a similar bug: [http://code.google.com/p/appengine-ndb-experiment/issues/detail?id=207](http://code.google.com/p/appengine-ndb-experiment/issues/detail?id=207)

# javascript - jquery 选择框插件无法通过选项卡导航

> ID：13370965
> 
> 赞同：0
> 
> 时间：2012-11-13T23:56:28.650
> 
> 标签：javascript, jquery

我正在使用一个插件，它将选择下拉框变成更好看的版本。但是，我刚刚注意到，当您尝试通过表单输入进行制表符时，一旦您到达这些样式选择框之一，通过制表符的能力就会停止。

这真的很糟糕，因为我在我的网站上使用了很多这样的选择框，而我只注意到了这个问题。有谁知道这是否容易解决？

该插件的代码在这里：

[http://code.google.com/p/select-box/issues/list](http://code.google.com/p/select-box/issues/list)

示例：http: [//jsfiddle.net/UgYU4/](http://jsfiddle.net/UgYU4/)

代码：

```
<label class="inputLabel" for="postcode">Post/Zip Code:</label>
<input type="text" name="postcode" size = "11" maxlength = "10" id="postcode" class="loginformInput" />

<label class="inputLabel" for="country">Country:&nbsp;<span class="alert">*</span></label>
<div id="logincountry">
<select name="zone_country_id" id="country" onchange="update_zone(this.form);">
  <option value="">Please Choose Your Country</option>
  <option value="222" selected="selected">United Kingdom</option>
  <option value="103">ROI Republic of Ireland</option>
  <option value="223">United States</option>
  <option value="13">Australia</option>
</select>
</div><script type="text/javascript">
$(function () {
    $("#country").selectbox();
});
</script>

<label class="inputLabel" for="email-address">Email Address:&nbsp;<span class="alert">*    </span></label>
<input type="text" name="email_address" size = "41" maxlength= "96" id="email-address" class="loginformInput" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T16:16:41.167

如果您担心键盘/导航支持，您应该改用我的 jQuery 插件[SelectBoxIt](http://www.selectboxit.com)。此外，关于选项卡索引，SelectBoxIt 开箱即用地支持这一点。

# javascript - 用于查找从点到多边形的最小距离的 Javascript 代码（由 html 区域定义）

> ID：13370969
> 
> 赞同：5
> 
> 时间：2012-11-13T23:56:54.737
> 
> 标签：javascript, html, distance, imagemap

我有一个定义了多个区域的图像地图，所有区域都是多边形

我想计算从图像上的一个点（通常由用户单击图像给出）到给定区域外边缘的关闭点的距离。

对于我的情况，可以假设多边形的所有边都不相交，从而使任务更容易一些

检测点是否在区域/多边形内部、之上或外部也很有趣，例如，如果点在多边形内部，则距离为负，如果在边缘上，则为 0。

但这对我来说并不是那么重要，因为考虑到用户点击图像给出的点，很容易检测到这一点。

* * *

[这里](https://stackoverflow.com/questions/10983872/distance-from-a-point-to-a-polygon)给出了这个问题的通用解决方案- 但我想知道是否有人已经**在 javascript**中实现了用图像地图和区域解决这个问题

我想做类似的事情：

```
var distance = calculateDistancePointToArea( xCoord, yCoord, areaId ); 
```

如果这适用于一个区域的所有可能形状，那将是一个额外的好处：矩形、圆形和多边形

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T07:46:16.437

这是在javascript中计算两个坐标之间距离的函数。

```
function(calculateDistancePointToArea(x2, y2, areaId))
{
    var el1 = document.getElementById(areaId);
    var off1 = getOffset(el1);
    // center
    var x1 = off1.left;
    var y1 = off1.top;
    // distance
    var length = Math.sqrt(((x2-x1) * (x2-x1)) + ((y2-y1) * (y2-y1)));       
}

function getOffset( el ) {
    var _x = 0;
    var _y = 0;
    var _w = el.offsetWidth|0;
    var _h = el.offsetHeight|0;
    while( el && !isNaN( el.offsetLeft ) && !isNaN( el.offsetTop ) ) {
        _x += el.offsetLeft - el.scrollLeft;
        _y += el.offsetTop - el.scrollTop;
        el = el.offsetParent;
    }
    return {
        top: _y,
        left: _x,
        width: _w,
        height: _h
    };
} 
```

希望它能给你一个想法和帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-14T05:50:32.943

我为通用坐标编写了一个函数，如果需要，可以将其转换为与 HTML 多边形一起使用。

一个非常简单的解决方案：为每对多边形顶点求解一个方程。

*具有点a*和*b*的多边形的一段（图中的灰色）的算法：

[![在此处输入图像描述](../Images/0be3d88cdaf029e3a656bb2eb43116ef.png)](https://i.stack.imgur.com/QIneB.png)

*   向量 A 只是点一个坐标
*   向量 S(egment) = b - a
*   向量 N 垂直于 S (-ys, xs)
*   矢量 P 是点的坐标

您要检查从*点*到*Segment*的法线长度，并确保目标点在*Segment*内。

这是您要解决的等式：

[![在此处输入图像描述](../Images/e837eee2652adab6a8f242749603bffb.png)](https://i.stack.imgur.com/oaI2W.png)

在解中，*i*必须在 0 和 1 之间。如果是，则距离为*|iN|* 并且该点是*P + iN*，否则它是顶点（a＆b）之间最近的点。然后你可以找到每条边的最近点。

这是一个搜索最近距离的 Javascript 代码，但它应该很容易修改最近点：

```
function vlen(vector) {
  return Math.sqrt(vector[0]*vector[0] + vector[1] * vector[1]);
}

function vsub(v1, v2) {
  return [v1[0] - v2[0], v1[1] - v2[1]];
}

function vscale(vector, factor) {
  return [vector[0] * factor, vector[1] * factor];
}

function vnorm(v) {
  return [-v[1], v[0]];
}

function distance_to_poly(point, poly) {
  var dists = $.map(poly, function(p1, i) {
    var prev = (i == 0 ? poly.length : i) - 1,
        p2 = poly[prev],
        line = vsub(p2, p1);

    if (vlen(line) == 0)
      return vlen(vsub(point, p1));

    var norm = vnorm(line),
        x1 = point[0],
        x2 = norm[0],
        x3 = p1[0],
        x4 = line[0],
        y1 = point[1],
        y2 = norm[1],
        y3 = p1[1],
        y4 = line[1],

        j = (x3 - x1 - x2 * y3 / y2 + x2 * y1 / y2) / (x2 * y4 / y2 - x4),
        i;

      if (j < 0 || j > 1)
        return Math.min(
          vlen(vsub(point, p1)),
          vlen(vsub(point, p2)));

      i = (y3 + j * y4 - y1) / y2;

      return vlen(vscale(norm, i));
  });

  return Math.min.apply(null, dists);
} 
```

# c# - 在编译时动态更改应用程序图标？（。网）

> ID：13370974
> 
> 赞同：0
> 
> 时间：2012-11-13T23:57:25.827
> 
> 标签：c#, .net, visual-studio-2010, compilation, icons

我从一个代码库创建了两个应用程序，从而生成了两个可执行文件。有没有办法根据编译标志（或类似性质的东西）动态更改可执行文件的图标？

我正在使用 VS2010，如果重要的话，代码是 C#。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-12T13:17:52.523

我发现的唯一方法是替换我用于编译的批处理文件中的图标

```
copy \Resources\%VENDOR%.ico \icon.ico 
```

# perl - 如何从其中一个子例程中获取 Perl 模块的名称？

> ID：13370982
> 
> 赞同：2
> 
> 时间：2012-11-13T23:58:04.493
> 
> 标签：perl, perl-module

假设我有一个 Perl 模块`My::Module`：

```
package My::Module;

sub foo {
   return $module_name;
} 
```

我会`$module_name`用什么来代替`My::Module`？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-14T00:14:32.410

```
package My::Module;

sub foo {
   return __PACKAGE__;
} 
```

[更新]以下可能是您正在寻找的内容：

```
package My::Module;

sub new {
    my $self = {};
    bless $self;
    return $self;
}

sub foo {
    my $self = shift;
    return (caller(0))[3];
}

1;

# test 1: calling foo directly.
print "1: ", My::Module::foo, "\n";
# test 2:  instantiating object, then calling method of object instance.
my $x = My::Module->new;
print "2: ", $x->foo(), "\n"; 
```

输出：

```
$ perl test.pl
1: My::Module::foo
2: My::Module::foo 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-14T00:18:42.650

看看特殊常量__PACKAGE__。这可能是您正在寻找的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-14T00:04:46.490

如果您只想获取您所在的脚本的名称：

```
my $bname=`basename $0`;

print "\n".$bname; 
```

# sql - 复制一条记录，另一个表中的相关记录也被复制

> ID：13370983
> 
> 赞同：0
> 
> 时间：2012-11-13T23:58:07.660
> 
> 标签：sql, ms-access, vba

我有一个数据库（Access 2010），其中包含与 1 个主表相关的大约 6 个表，我想从主表中复制一条记录，并从其他表中获取相关表。有没有比我目前的方法更简单的方法，它涉及：

*   查找下一个主 ID 号

*   将具有新 ID 的旧记录插入到主表中。

*   使用新的 ID 号插入到每个相关表中。

我目前正在使用 VBA 查找新 ID 并运行 SQL。我更愿意运行这个 1 SQL 查询，并且我通过按下按钮运行它，所以 VBA 不是不可能的。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T00:14:40.553

不，这听起来是关于你必须如何做的，据我所知。尝试`UPDATE`当然不会留下任何东西......

您当前的解决方案（使用 VBA）老实说可能是您最好的选择；当然，您可以使用另一种语言，或者将其包装在存储过程中，但您仍然坚持这些确切的步骤。它几乎是语言 (SQL) 和系统（通常是 RDBMS）设计的一个特性。

# c# - 将 Web 应用程序项目转换为单独的 DLL

> ID：13370985
> 
> 赞同：0
> 
> 时间：2012-11-13T23:58:17.570
> 
> 标签：c#, asp.net, .net, visual-studio-2010, .net-3.5

我将我的网站项目转换为 Web 应用程序项目，但现在当我想将它发布到服务器时，我如何让它构建单独的 DLL？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T00:04:14.200

对于 Web 应用程序项目，您只会获得一个 dll。你不能像网站那样做单独的 dll。

要使用所需的最少文件发布项目，请右键单击项目 > 发布。您可以将其导出到本地目录，然后从那里将其传输到服务器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T00:19:10.617

您可以使用 Web 部署项目 2010 ( [http://www.microsoft.com/en-us/download/details.aspx?id=24509](http://www.microsoft.com/en-us/download/details.aspx?id=24509) )。有了它，在编译 Web 应用程序时，您将拥有以下选项：

1.  整个网站的单个程序集。
2.  每个内容文件夹一个程序集。
3.  所有 UI 组件的单个程序集。
4.  网站中每个已编译文件的程序集。

我认为选项 #2 和 #4 可以满足您的需求。

有关详细信息，请阅读[http://msdn.microsoft.com/en-us/library/aa479568.aspx](http://msdn.microsoft.com/en-us/library/aa479568.aspx)。

# python - SQLAlchemy 查询和_/或_问题

> ID：13370993
> 
> 赞同：3
> 
> 时间：2012-11-14T00:00:03.743
> 
> 标签：python, sql, sqlalchemy

我有一个正在尝试构建的查询。该查询似乎部分工作，查询的两个单独部分都返回正确数量的元素。但是，组合查询返回一个空结果集，这是不正确的。

注意：我知道查询 1 和 2 不需要 and_，但我想确保 and_ 按我的预期工作。

**查询 1**：

*   SQLAlchemy 查询

    ```
    session.query(Lobby).filter(
        and_(
            Lobby.id == spectator_table.c.lobby_id,
            spectator_table.c.player_id == player.steamid
        )
    ).all() 
    ```

*   生成的 SQL

    ```
    SELECT lobby.id AS lobby_id, lobby.name AS lobby_name, lobby.owner_id AS lobby_owner_id
    FROM lobby, spectator
    WHERE lobby.id = spectator.lobby_id AND spectator.player_id = ? 
    ```

**查询 2**：

*   SQLAlchemy 查询

    ```
    session.query(Lobby).filter(
        and_(
            Lobby.id == Team.lobby_id,
            LobbyPlayer.team_id == Team.id,
            LobbyPlayer.player_id == player.steamid
        )
    ).all() 
    ```

*   生成的 SQL

    ```
    SELECT lobby.id AS lobby_id, lobby.name AS lobby_name, lobby.owner_id AS lobby_owner_id
    FROM lobby, team, lobby_player
    WHERE lobby.id = team.lobby_id AND lobby_player.team_id = team.id AND lobby_player.player_id = ? 
    ```

**组合查询**：

*   SQLAlchemy 查询

    ```
    session.query(Lobby).filter(
        or_(
            and_(
                Lobby.id == Team.lobby_id,
                LobbyPlayer.team_id == Team.id,
                LobbyPlayer.player_id == player.steamid
            ), and_(
                Lobby.id == spectator_table.c.lobby_id,
                spectator_table.c.player_id == player.steamid
            )
        )
    ).all() 
    ```

*   生成的 SQL

    ```
    SELECT lobby.id AS lobby_id, lobby.name AS lobby_name, lobby.owner_id AS lobby_owner_id
    FROM lobby, team, lobby_player, spectator
    WHERE lobby.id = team.lobby_id AND lobby_player.team_id = team.id AND lobby_player.player_id = ? OR lobby.id = spectator.lobby_id AND spectator.player_id = ? 
    ```

* * *

**模型**

```
spectator_table = Table('spectator', Base.metadata,
    Column('lobby_id', Integer, ForeignKey('lobby.id'), primary_key=True),
    Column('player_id', Integer, ForeignKey('player.steamid'),
        primary_key=True
    ),
)

class Lobby(Base):
    __tablename__ = 'lobby'
    id = Column(Integer, primary_key=True)
    name = Column(String, nullable=False)
    owner_id = Column(Integer, ForeignKey('player.steamid'), nullable=False,
        unique=True
    )
    teams = relationship("Team", backref="lobby",
        cascade='save-update,merge,delete'
    )
    spectators = relationship("Player", secondary=spectator_table)

class Team(Base):
    __tablename__ = 'team'
    id = Column(Integer, primary_key=True)
    name = Column(String, nullable=False)
    lobby_id = Column(Integer, ForeignKey('lobby.id'), nullable=False)
    players = relationship("LobbyPlayer", backref="team",
        cascade='save-update,merge,delete,delete-orphan'
    )

class LobbyPlayer(Base):
    __tablename__ = 'lobby_player'
    team_id = Column(Integer, ForeignKey('team.id'), primary_key=True)
    player_id = Column(Integer, ForeignKey('player.steamid'), primary_key=True)
    player = relationship("Player", uselist=False)
    cls = Column(Integer)

class Player(Base):
    __tablename__ = 'player'
    steamid = Column(Integer, primary_key=True) 
```

* * *

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-14T01:05:08.340

我在 SA 0.7.9 上看到了同样的问题

似乎正在发生的事情是括号没有按照您想要的方式正确应用。我使用了 self_group() 来完成这项工作，但问题是你不应该使用它。这是 [self_group](http://docs.sqlalchemy.org/en/latest/core/schema.html?highlight=self_group#sqlalchemy.schema.Column.self_group)的文档。我认为应该有比我更好的答案，但是，这应该可以让您继续前进。

```
query = session.query(Lobby).filter(
    ((Lobby.id == Team.lobby_id) &
    (LobbyPlayer.team_id == Team.id) &
    (LobbyPlayer.player_id == player.steamid)).self_group() |
    ((Lobby.id == spectator_table.c.lobby_id) &
    (spectator_table.c.player_id == player.steamid)).self_group()).all() 
```

生成的 sql 如下，我相信这就是你所追求的。

```
SELECT lobby.id AS lobby_id, lobby.name AS lobby_name, lobby.owner_id AS lobby_owner_id 
FROM lobby, team, lobby_player, spectator 
WHERE (lobby.id = team.lobby_id AND lobby_player.team_id = team.id AND lobby_player.player_id = ?) OR (lobby.id = spectator.lobby_id AND spectator.player_id = ?) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-27T18:50:14.377

托尼，我从来不知道 self_group()，最棒的！

TronPaul，您可以使用 self_group() 在周围添加括号和 ClauseElements，例如：

```
query = session.query(Invoice).join(CustomerQuote).reset_joinpoint()

selections = [1,2,3,4,5,6]
select_ids = Invoice.invoice_id.in_(selections).self_group()
ands = and_(CustomerQuote.customer_id==33,  
       CustomerQuote.invoice_date>=low_date,
       CustomerQuote.invoice_date<=hi_date).self_group()

query = query.filter(or_(select_ors, ands))

SELECT invoice.invoice_id AS invoice_invoice_id, [etc etc....]
FROM invoice INNER JOIN customer_quote ON 
customer_quote.customer_quote_id = invoice.customer_quote_id 
WHERE (invoice.invoice_id IN (1,2,3,4,5)) OR 
      (customer_quote.customer_id = 33 AND 
       invoice.invoice_date >= '2012-01-01' AND 
       invoice.invoice_date <= '2012-12-31') 
```

详细说明 Tony 的回答：self_group() 对于对“二进制”表达式以外的子句进行分组很有用，它适用于任何 ClauseElement。

# ios - 视图控制器上的多个 UISwitch

> ID：13370995
> 
> 赞同：0
> 
> 时间：2012-11-14T00:00:16.593
> 
> 标签：ios, uiswitch

我有两个`UISwitch`，都在点击事件上调用相同的方法，所以在那个方法中我需要区分这两个开关才能知道谁发送了事件。为此，我`tag`只分配了其中一个：

```
switch1.tag=0; 
```

在单击其中一个时触发的方法中`UISwitch`，我进行了该测试：

```
-(void)switchValueGetsChanged:(UISwitch*)sender{

    if (sender.tag==0) {
        NSLog(@"It's switch 1");
    }else{

        NSLog(@"It's switch 2");
    } 
```

现在，当我运行代码时，我注意到我总是收到第一条消息：

```
 NSLog(@"It's switch 1"); 
```

即使我点击第二个`UISwitch`。我也通过为第二个分配标签解决了这个问题`UISwitch`：

```
switch1.tag=0;
switch2.tag=1; 
```

现在，问题解决了，所以我的问题是：如果你得到多个`UISwitch`，并且你想判断`tag`值，是否必须`tag`为所有对象分配属性`UISwitch`？提前谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T00:14:50.637

您询问：

> 如果你得到多个`UISwitch`，并且你想判断`tag`价值，是否必须`tag`为所有对象分配属性`UISwitch`？

如果您想根据其`tag`属性区分任何视图，那么是的，您必须设置其`tag`属性。`tag`如果你不设置，你还能如何检查`tag`？

顺便说一句 - 不要`0`用作您的标签值之一。这是所有视图的默认设置，因此将其设置为`0`并没有任何帮助。

# javascript - 停止 Firefox 重定向到所有 JavaScript 中的特殊 URL

> ID：13370996
> 
> 赞同：0
> 
> 时间：2012-11-14T00:00:20.250
> 
> 标签：javascript, firefox

我相信我的 ISP 对其服务器进行了恶意配置，有时当我请求一个页面时，例如[http://www.somesite.org/ajax.htm](http://www.somesite.org/ajax.htm)，我收到的响应被一些不属于 www 的代码替换。 somesite.org。这不会发生在每个 HTTP 请求中，只是随机发生（早上可能有更高的概率）。HTTPS 不受影响。

被替换的代码包括重定向脚本，因此会导致一个烦人的情况：想象您正在向下滚动 FaceBook 并注意到一个有趣的帖子，然后突然一切都消失了，浏览器重定向到您的 ISP 提供的广告页面。您可以单击“后退”按钮，但浏览器会再次重定向到新页面。

典型的恶意响应如下所示：

```
<html>
<script language=javascript type="text/javascript">
    window.location.replace("http://bjdnserror2.wo.com.cn:8080?HOST=" 
        + location.hostname + "&R="
        + location.pathname + "&" + location.search.substr(location.search.indexOf("\?")+1));
</script>

<noscript>
<meta   http-equiv="refresh"   content="0;URL=http://bjdnserror2.wo.com.cn:8080">
</noscript>
<head>
<title>Redirect</title>
</head>
<body bgcolor="white" text="black">
</body>
</html> 
```

这是使用 HTTPFox 捕获的： ![关于我如何捕获上述代码的屏幕截图](../Images/17b7792d0e5c196b7e5e4904a606ce0a.png)

上述情况发生在对 adsupport.renren.com 的回复中*，*我最终被重定向到*bjdnserror2.wo.com.cn*。

**与 XSS 劫持不同**，恶意代码来自另一个域并且可以很容易地被浏览器伪装，这些代码来自中断正常请求/响应的拦截，它们只显示在您正在访问的同一域下。我想出的解决方案是停止我的 Firefox 跟随脚本倾向于将我重定向到 <*.wo.com.cn>。但这似乎没有被任何附加组件实现。现有的附加组件（NoScript、脚本管理器）可能会简单地停止所有 JavaScript 或对`window.location`. 但是他们会破坏正常的用户体验。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T11:09:36.237

Firefox 有一个名为 NoRedirect 的附加组件。需要“正则表达式”知识才能使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-17T07:54:36.833

您的 PC 上可能存在某些 PUP 或广告软件。您是否运行过反间谍软件程序来扫描 PC？有时，防病毒软件可以删除恶意软件并[停止浏览器重定向](http://www.fixmalwareissues.com/how-to-get-rid-of-baseflash-ads-virus-removal-guide/)。