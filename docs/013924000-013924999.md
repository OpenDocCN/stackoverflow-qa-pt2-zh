# StackOverflow 问答 13924000-13924999

# javascript - 使用 Django 进行 Jquery 表单验证

> ID：13924000
> 
> 赞同：0
> 
> 时间：2012-12-17T23:27:06.687
> 
> 标签：javascript, jquery, django

在我的 django 应用程序中，我有一个表单，要求用户输入电子邮件地址和用户名。

我希望能够检查用户名或电子邮件地址是否已经存在并引发错误。但我想在不重新加载页面的情况下执行此操作，因此使用 javascript 或 Jquery。

我的第一个想法是这样的（对于用户名）：

html:

```
 <form  method="post" onsubmit="return validateForm();">
    {% csrf_token %}

        <div id='error_message'></div>
        <input class='username' type="text" name="username" value=""/>

    <button type="submit">Valider</button>

  </form> 
```

在我的views.py中：

```
 def myview(request):
      users = User.objects.all()
      return render_to_response('mytemplate.html', 'users':users, context_instance=RequestContext(request)) 
```

然后在我的模板中：

```
 <div class='search'>
   {% for user in users %}
    <input type='hidden' value='{{user.username}}'
   {% endfor %}
    </div> 
```

然后，在 js 中：

```
 function validateForm() { 
   var value = $('.username').val()

   if( // find 'value' in all the <input type='hidden'>  ) { 
    var error = 'Username already exists';
    $("#error_message").html(error);
    return false;
  } 
 }; 
```

我认为这很复杂。有没有更简单的方法来做到这一点？

感谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-17T23:44:20.277

很抱歉，但您的方法在安全性和效率方面非常糟糕。您正在披露用户的所有用户名（无论是否隐藏输入）。您应该检查一些已经构建的身份验证应用程序，例如[django-usernea](http://www.django-userena.org/) [django-allauth](https://github.com/pennersr/django-allauth)

我会使用 ajax 验证：

首先给你的表格一个ID，例如`my_form`

```
<script>
    $('#my_form').submit(function(){
      var username = $('#username').val();
      if (username == ''){
         alert('please enter username');
         return false;
      }

      $.ajax({
               type: "POST",
               url: "{% url auth_validate %}",
               data: {'username': $('#username').val(), 'csrfmiddlewaretoken': '{{csrf_token}}'},
               dataType: "text",
               success: function(response) {
                      var response = $.parseJSON( response );
                      if (response.success){
                          return true;
                      }
                      else{
                          alert(response.error);
                      }
                },
                error: function(rs, e) {
                       alert(rs.responseText);
                }
          }); 
    })
</script> 
```

在`urls.py`添加`auth_validate`网址：

```
url(r'^auth_validate/$', 'myapp.views.auth_validate', name='auth_validate'), 
```

现在在`myapp.views`：

```
from django.http import HttpResponse
from django.utils import simplejson
from django.utils.translation import ugettext_lazy as _

def auth_validate(request):
    error = ''
    success = False
    if request.method == 'POST':
        username = request.POST.get('username', None)
        if not username:
            error = _('Please enter username')
        elif User.objects.filter(username__exact=username).exists():
            error = _('Sorry this username is already taken')
        else:
            success = True

    ajax_vars = {'success': success, 'error': error}
    return HttpResponse(simplejson.dumps(ajax_vars),
                    mimetype='application/javascript') 
```

# java - Java中的二维列表/集合

> ID：13924001
> 
> 赞同：0
> 
> 时间：2012-12-17T23:27:13.783
> 
> 标签：java

我正在寻找的是字符串的二维数组。同一行中的字符串应该是唯一的，但允许行重复。

我正在使用一个列表，其中每一行都是一组：

```
List<Set<String>> bridges = new ArrayList<Set<String>>(); 
```

我有一个返回一组字符串的方法：

```
Set<String> getBridges(){
    Set<String> temp = new HashSet<String>();
    // Add some data to temp
    temp.add("test1");
    temp.add("test2");
    temp.add("test3");
    return temp;
} 
```

现在在 main 方法中，我将调用 getBridges() 来填充我拥有的列表：

```
List<Set<String>> bridges = new ArrayList<Set<String>>();

Set<String> tempBridge = new HashSet<String>();

for(int j=0;j<5;j++){
            for(int k=0;k<8;k++){
                        // I call the method and store the set in a temporary storage
                tempBridge = getBridges();
                        // I add the the set to the list of sets
                bridges.add(tempBridge);
                        // I expect to have the list contains only 5 rows, each row with the size of the set returned from the method
                System.out.println(bridges.size());
            }
} 
```

为什么我将列表作为大小为 5*8 的一维数组？如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-17T23:29:49.000

您的`for`循环看起来组织不正确。您应该每行只添加`bridges`一次，而现在您每次都通过*内部* `for`循环添加它，该循环运行 5*8 次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T00:04:51.143

你需要修复你的循环：

```
List<Set<String>> bridges = new ArrayList<Set<String>>();

Set<String> tempBridge = new HashSet<String>();

for(int j=0;j<5;j++){    
    tempBridge = getBridges();
    bridges.add(tempBridge);
    System.out.println(bridges.size());
}    

Set<String> getBridges(){
    Set<String> temp = new HashSet<String>();
    for(int k=0;k<8;k++){
        // Add some data to temp
        temp.add("test" + Integer.toString(k));
    }
    return temp;
} 
```

# python - Python 列表元组

> ID：13924002
> 
> 赞同：2
> 
> 时间：2012-12-17T23:27:19.027
> 
> 标签：python, list, dictionary, tuples

说，

```
data = { 123: 1, 234: 2, 241: 4 }
a = list(sorted(data.items())) 
```

列表不是不必要的吗？我想，自己`sorted(data.items())`会回归吗？为什么有人会专门使用列表功能？`list``tuples`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-17T23:30:51.177

在这种情况下，`list`调用是不必要的——你是对的。

一些 Python 方法返回迭代器而不是列表。该`list`函数可用于**强制迭代器成为列表**（例如，以便对其进行索引）。

以函数[`reversed`](http://docs.python.org/2/library/functions.html#reversed)为例，它返回一个迭代器：

```
In [1]: type(reversed([3,1,2]))
Out[1]: listreverseiterator

In [2]: reversed([3,1,2])[1]
---------------------------------------------------------------------------
TypeError: 'listreverseiterator' object has no attribute '__getitem__' 
```

我们可以使用`list`迭代器并在列表中使用它的结果：

```
In [3]: list(reversed([3,1,2]))[1]
Out[3]: 1 
```

`list`可用于**强制其他类似列表的类型成为具体列表**：

```
In [4]: (1,2,3).append(4)
---------------------------------------------------------------------------
AttributeError: 'tuple' object has no attribute 'append'

In [5]: list((1,2,3)).append(4) # => [1, 2, 3, 4] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-17T23:30:56.867

是的，`sorted`返回 a`list`本身。因此，调用数据结构是没有用的`list()`。`list`调用`list()`它相当于`sorted(data.items())[:]`.

```
In [7]: print sorted.__doc__
sorted(iterable, cmp=None, key=None, reverse=False) --> new sorted list

In [8]: lis=[1,2,3]

In [9]: lis
Out[9]: [1, 2, 3]

In [10]: list(lis)    #same result, but different object. (A shallow copy)
Out[10]: [1, 2, 3] 
```

`list()`如果您想获取 an 的所有值，这可能会很有用`iterator`：

```
In [11]: y=xrange(5)

In [12]: y
Out[12]: xrange(5)

In [13]: list(y)
Out[13]: [0, 1, 2, 3, 4] 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-17T23:30:06.980

是的，在这种情况下是不必要的:-)

# .htaccess - .htaccess RewriteRule 帮助（提供代码）

> ID：13924006
> 
> 赞同：-1
> 
> 时间：2012-12-17T23:27:26.437
> 
> 标签：.htaccess, mod-rewrite

我有一个 .htaccess 文件，想知道如何将 /home 重写为 / （根目录）

我通过另一个 StackOverflow 问题找到了以下代码：

```
RewriteEngine On

RewriteCond %{REQUEST_URI} !^/home/.*$
RewriteRule ^(.*)$ /$1 [L] 
```

这是我用来重写 /home 目录以显示为根目录的正确代码吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T23:38:20.827

您不能重定向到文档根目录之外的文件夹。如果您**真的**打算`/`通过网络访问您的盒子，那么您应该创建一个名为`/root`指向`/`first 的 apache 别名。将以下行添加到您的 apache 配置中：

```
Alias /root /
<Directory "/">
    Options Indexes FollowSymLinks MultiViews
    AllowOverride All 
    Order allow,deny
    Allow from all
</Directory> 
```

然后你应该编辑你的网络服务器根目录中的 .htaccess - 也许`/var/www/.htacess`- 像这样简单：

```
RewriteEngine On
RewriteRule ^home/(.*) root/$1 
```

此外，您必须确保 Web 服务器用户有权访问`/`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T04:55:55.917

将您的 .htaccess 代码更改为：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteRule ^home/(.*)$ /$1 [L,NC] 
```

# mysql - 是否有任何工具或脚本可以从 MySQL 数据库中导出单个记录以及所有记录引用/外部约束？

> ID：13924007
> 
> 赞同：2
> 
> 时间：2012-12-17T23:27:36.123
> 
> 标签：mysql, database, stored-procedures, database-administration

是否有任何工具或脚本或简单方法（无需编写自定义脚本）可以从表中导出单个记录及其所有引用？

即说我有一个Users表，我想导出id = 1的用户，然后工具/脚本将查看哪些表引用Users.id，并导出引用userID = 1的表。所以说地址表有userID = 1，它将导出该地址。如果有任何东西引用了 userID = 1 的地址，它也会导出它，并继续递归地执行此操作。

通过使用 information_schema db，使用一些 SQL 脚本绝对是可能的，执行以下操作：

```
SELECT * FROM KEY_COLUMN_USAGE WHERE REFERENCED_TABLE_NAME = 'Users' AND REFERENCED_COLUMN_NAME = 'id' AND TABLE_SCHEMA='database'; 
```

然后查看该查询的结果并查看所有这些表，然后为每个表重新运行相同的查询，依此类推。然后根据 ID 从指定的表中进行选择。

只是想知道是否有一些东西已经做到了这一点？

谢谢

# python - 使用 Python 进行数据采集

> ID：13924015
> 
> 赞同：3
> 
> 时间：2012-12-17T23:28:23.993
> 
> 标签：python, user-interface, nidaqmx

我正在使用 National Instruments 板进行数据采集的项目。我有用于执行任务的功能 C 代码，但想使用 Python，因此 GUI 编程不那么痛苦。在我的 C 代码中，我使用 API 调用 setTimer，它定期引发 WM_TIMER 事件。Tk 循环中是否有类似的机制？我尝试使用以下代码。

```
def DAQ(self):
    if self.do_DAQ:
        result = self.myDAQ.getData()
        currTime = time.time() - self.start_time
        self.time_label.config(text="{:.1f} seconds".format(currTime))
        self.volt_label.config(text="{:.4f} volts".format(result))
        self.time_data[self.i] = currTime
        self.volt_data[self.i] = result
        self.i += 1
        self.after(1962, self.DAQ) 
```

after() 中的神奇“1962”是通过反复试验确定的，以提供大约 2 秒的延迟，但时间片会根据队列中的其他内容而漂移。有没有办法让我的时间片更准确？具体来说，我可以强制 Tk 在队列中的其他事情之前执行我的 DAQ 事件吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T00:13:37.333

这是我在评论中所说的一个快速示例：

```
import Tkinter as tk
import threading
import random
import time
from Queue import Queue, Empty

root = tk.Tk()
time_label = tk.Label(root, text='<unknown> seconds')
volt_label = tk.Label(root, text='<unknown> volts')
time_label.pack()
volt_label.pack()

def DAQ(q):
    while True:
        q.put((time.time(), random.randrange(100)))
        time.sleep(2)

def update_data(queue, root):
    try:
        timestamp, volts = queue.get_nowait()
    except Empty:
        pass
    else:
        time_label.config(text='{:.1f} seconds'.format(timestamp))
        volt_label.config(text='{:.4f} volts'.format(volts))
    root.after(100, update_data, queue, root)

data_queue = Queue()
t = threading.Thread(target=DAQ, args=(data_queue,))
t.daemon = True
t.start()
update_data(data_queue, root)
root.mainloop() 
```

显然，上面的 DAQ() 函数只是真实事物的替身。关键是，正如@ballsdotballs 在他们的回答中所建议的那样，您可以在 DAQ 线程中以您想要的任何速率进行采样，将值添加到队列中，然后以更合适的速率更新 GUI。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T00:04:12.973

我实际上使用 PyDAQmx 用 Python 做 NIDAQmx。我们以 20kHz 的频率获取数据（通过在 NI 板上设置时钟定时器，并将数据以 10Hz 的 2000 块为单位流式传输到文件中）。

如果时间精度很重要，我强烈建议将您的 GUI 过程与数据采集过程分开。

如果您只想每 2 秒记录一次数据，您可以将 NIDAQ 上的采样时钟设置为 1000，缓冲区大小为 1000，并使用[AutoRegisterEveryNSamplesEvent](http://zone.ni.com/reference/en-XX/help/370471W-01/daqmxcfunc/daqmxregistereverynsamplesevent/)回调为每个其他缓冲区写入最后一个数据索引（应该每两秒）到一个文件或将其通过管道传输到您的 GUI 进程。这将确保您的 GUI 处理队列不会影响数据采样的精度。

# php - 查询一年内关系状态变化

> ID：13924019
> 
> 赞同：1
> 
> 时间：2012-12-17T23:29:24.927
> 
> 标签：php, facebook, facebook-graph-api

我需要查询`open graph`或`fql`了解用户在一年内更改了他/她的关系状态的次数？

我可以在[图形资源管理](https://developers.facebook.com/tools/explorer)器中查询以查找当前的关系状态，但我也对以前的关系状态感兴趣。就像在一个时间范围内。那可能吗？

我如何查询 fql 或打开图表以获取该信息？

或者说我想查询一年内的关系状态变化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T00:18:02.010

You are currently unable to do this and the previous answers are correct. We found a bug within FB and it is detailed here.

[Facebook Timeline - Activity Log - Graph API - FQL Query All Return Data Based Only on Current Value (Major Bug?)](http://facebook.stackoverflow.com/q/13570652/1090148)

If you have any suggestions we'd love to hear them.

# windows - 如何让一个bat文件并行运行两个jar？

> ID：13924021
> 
> 赞同：1
> 
> 时间：2012-12-17T23:29:31.230
> 
> 标签：windows, batch-file, window, parallels

> **可能重复：**
> [如何从另一个 bat 文件在后台运行 bat 文件？](https://stackoverflow.com/questions/649634/how-do-i-run-a-bat-file-in-the-background-from-another-bat-file)

我想制作一个运行本地服务器（Seleneium grid2 *.jar）的bat文件，然后执行命令为其分配节点。我的问题是当我打电话给这个时

```
java -jar selenium-server-standalone-2.28.0.jar -role hub
call assign-node.bat 
```

bat 文件运行服务器并继续监听而不运行第二个命令（调用）！

最好的方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T23:33:11.913

您可以使用两个单独的批处理文件。或者

```
start java -jar selenium-server-standalone-2.28.0.jar -role hub
call assign-node.bat 
```

*start*命令应该在后台模式下运行它。没有测试它。

查看：

[如何使用带有路径的“开始”和带有空格的命令在 Windows 中创建批处理文件](https://stackoverflow.com/questions/72671/how-to-create-batch-file-in-windows-using-start-with-a-path-and-command-with-s)

# vb.net - 匿名类型和 LINQ 和强制转换

> ID：13924026
> 
> 赞同：0
> 
> 时间：2012-12-17T23:30:09.100
> 
> 标签：vb.net, linq, entity-framework-5, anonymous

我很喜欢这种来自 LINQ 业务的匿名类型。这是解决上一个问题的答案的结果，但遗憾的是，我根本没有脑力来解决这个问题。

我将返回与每个人相关的有限事件列表。来源是实体框架，我仍在努力从导航属性中获取标准受限的结果。下面的代码是我从 Nicholas Butler 的回答中翻译过来的。但是，我找不到任何方法来适应匿名类型。演员表似乎不起作用 - 或者我只是没有线索（可能）。有人可以帮忙吗？

```
Dim test = context.persons.Where(Function (r) r.personActive).Select(Function (o) New With { _
                 .person = o, _
                 .events = o.events.Where( Function(e) e.eventDateTime > startdate) _
            })

            Dim Res = New ObservableCollection(Of person )

            For Each person In test
                Res.Add(person)
            Next 
```

给我：

> 错误 2 类型“<匿名类型>（第 53 行）”的值无法转换为“PersonEntity.person”。E:\Dropbox\Work Experimental\PersonEntity- Copy\PersonEntity\personRepository.vb 61 29 PersonEntity

我已经对这段代码进行了进一步的处理，但我仍然无法获得附加的事件，因为我在这次事件的转换中遇到了另一个错误。通用列表到 ObservableList 显然没有转换。回答我原来的问题似乎是一种不可思议的方式！

```
Dim test = context.persons.Where(Function(r) r.personActive).Select(Function(o) New With { _
                 .person = o, _
                 .events = o.events.Where(Function(e) e.eventDateTime > startdate) _
            })

            Dim Res = New ObservableCollection(Of person)

            For Each t In test
                Dim r As New person
                r = t.person
                r.events = t.events
                Res.Add(r)
            Next

            Return Res 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T23:35:11.480

```
Function(o) New With { _
         .person = o, _
         .events = o.events.Where(Function(e) e.eventDateTime > startdate) _
    } 
```

这将返回一个匿名类型，而不是`Person`. 你的意思是`Add`它的`person`财产*？

```
For Each o In test
    Res.Add(o.person)
Next 
```

# android-listview - 以编程方式更改列表视图，使其可检查

> ID：13924027
> 
> 赞同：0
> 
> 时间：2012-12-17T23:30:10.187
> 
> 标签：android-listview

我已经做出了相当大的努力来找到一个类似的问题并且失败了，所以如果这是多余的污染，请原谅我。

我在与我的 Activity 对应的 xml 文件“my_layout”中定义了一个 ListView 和一个 ImageButton，如下所示：

```
<ListView
  android:id="@+id/listViewItems"
  android:layout_width="fill_parent"
  android:layout_height="wrap_content"
  android:layout_weight="1"
  ></ListView> 
```

和

```
<ImageButton
    android:layout_width="wrap_content" 
    android:layout_height="wrap_content"
    android:src="@drawable/btn_delete_dark"
    android:id="@+id/buttonDelete"
    android:layout_weight="1">     
</ImageButton> 
```

然后，我在我的 Activity 的 onCreate() 方法中以编程方式填充 ListView，如下所示：

公共类 ViewItemsActivity 扩展 Activity 实现 OnClickListener、OnItemClickListener{

```
ImageButton buttonDelete;
ListView listViewItems;
DatabaseHandler dbHandler;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.my_layout);

    buttonDeleteQuestion = (ImageButton) findViewById(R.id.buttonDelete);
    listViewQuestions = (ListView) findViewById(R.id.listViewItems);
    buttonDelete.setOnClickListener(this);

    //get data from sql table containing items
    dbHandler = new DatabaseHandler(this);

    String [] items = dbHandler.getItems();        //get data to populate ListView

    CustomAdapter adapter = new CustomAdapter(this,
              android.R.layout.simple_list_item_1, items);
    listViewItems.setAdapter(adapter);
    listViewItems.setOnItemClickListener(this);
}

@Override
public void onClick(View v) {

        switch (v.getId()) {        
        case R.id.buttonDelete:         
        listViewItems.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE);
        listViewItems.setItemChecked(0, true);
        break;
        //other cases are irrelevant
        }   

}

@Override
public void onItemClick(AdapterView<?> parent, View v, int pos, long id) {
    // TODO Auto-generated method stub  

    //non relevant code
} 
```

}

一切正常，除了我希望 ListView 在外观和功能上发生变化，因为单击 buttonDelete，以便它在每行的右侧显示复选标记，可以通过单击它们进行检查。

我的理解是 setChoiceMode(ListView.MULTIPLE_CHOICE) 和 setItemChecked(i,true) 会产生这种效果，但显然我错过了一些东西，因为它没有。

我对android很陌生，所以我可能在琐事上浪费了别人的时间，对此我深表歉意。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T17:40:47.597

解决方案非常简单，如下所示：

在 buttonDelete 对应的 onClick 事件中，我简单地创建了一个布局 id 为 *simple_list_item_multiple_choice* 的新适配器，并将其分配给 ListView

```
CustomAdapter adapter = new CustomAdapter(this,
          android.R.layout.simple_list_item_multiple_choice, items);
listViewItems.setAdapter(adapter); 
```

这成功了。

# oracle - 为 nvl() 编写 isnull() 包装器

> ID：13924030
> 
> 赞同：1
> 
> 时间：2012-12-17T23:30:16.957
> 
> 标签：oracle, plsql

我们正在将数据库从 Oracle 迁移到 SQL Server。我的查询广泛使用了 Oracle 的 nvl 函数。在 SQL Server 中，要使用的函数是 isnull()。如果可能的话，我想通过将它们更改为使用 isnull() 来开始准备我的查询，同时仍在 Oracle 上。我的想法是在我的模式中创建一个包装函数 isnull() 并更改我的查询以使用该函数。这样，当我们切换数据库平台时，我的查询已经在使用新功能。

有没有一种方法可以在 Oracle 中创建一个名为 isnull() 的包装函数，它接受并返回任何数据类型？还是我只需要有多个 isnull() 声明，为所有预期的数据类型重载？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-18T00:15:11.597

另一种方法可能是使用`COALESCE`而不是`NVL`，因为 for 的语法`COALESCE`在 Oracle 和 SQL Server 中是相同的。尽管如此，让相同的 SQL 在 Oracle 和 SQL Server 中高效运行（甚至完全运行）的目标（如果这是您的目标）可能并不现实。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-17T23:37:35.820

在 PL/SQL 中为同一函数具有多个重载的唯一方法是在包中创建它们。您可以创建一个包，其中包含许多不同的重载`IsNull`函数，这些函数接受和返回不同的数据类型并在查询中使用这些函数。当然，这确实意味着您必须在代码中包含包名称。当您迁移到 SQL Server 时，删除包名称可能很容易，但它不会是精确的迁移。

# php - 如何在 PHP 中将一组 KeyValuePairs 发布到 WCF 服务？

> ID：13924031
> 
> 赞同：1
> 
> 时间：2012-12-17T23:30:21.447
> 
> 标签：php, wcf

这是 WCF 服务签名：

```
[OperationContract]
DataResponse PostData(string transactionKey, KeyValuePair<string, string>[] customFields); 
```

我正在使用 nusoap，但我相信我可以自由使用任何 PHP 库。我想知道如何以 JSON 或 XML 格式发布数组。如果可行，我不介意渲染实际字符串并发布字符串。

仅供参考：我正在从 Input 元素及其值中收集 KeyValue 对，因此我没有要序列化的自定义 KeyValuePair 对象或类。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T23:56:48.913

如果您想以 json 形式发布，只需使用`json_encode();`：

```
$some_array = array();
$some_array['first_name'] = 'john';
$some_array['last_name'] = 'doe';

echo json_encode($some_array); //send this out. 
```

# css - 在标题和链接之间垂直重复的图像填充空间

> ID：13924032
> 
> 赞同：-1
> 
> 时间：2012-12-17T23:30:22.677
> 
> 标签：css, stylesheet, frontend

我被这个难住了。实现这一目标的最优雅/最有效的方法是什么？我`h3`在左边有一个重复的符号/图像（“::::::”），然后是一个链接。这发生在`h3`整个站点的几个 /link 区域之间。

另请注意，我使用的是十二列模式，特别是 Foundation。

![例子](../Images/e71bf59211a266c384b98d92d4de49ea.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T23:58:33.213

设置一个带有重复符号且宽度为 100% 的背景元素，然后为文本设置一个白色背景并将其置于背景之上。

```
<div id="wrapper">
   <div id="text1">Featured Courses</div>
   <div id="text2">See All Courses</div>
</div> 
```

和 CSS：

```
#wrapper{
   width:100%;
   background:url(image.png) repeat-x;
   height:20px;
}
#text1, #text2{
   background-color:#fff
   padding:5px
   height:10px;
}
#text1{
   float:left
}
#text2{
   float:right
} 
```

这可能不是您所需要的，但您明白了*。*

# html - 如何使用 DropKick 设置选项文本样式

> ID：13924033
> 
> 赞同：1
> 
> 时间：2012-12-17T23:30:43.163
> 
> 标签：html, css, jquery-dropkick

我正在使用[DropKick](http://jamielottering.github.com/DropKick/)来设置选择字段的样式。我需要将选项中的文本分开，以便一个单词向右浮动。

我试过这个，但我`span`的被剥夺了：

```
<select>
    <option>opt1</option>
    <option>opt2</option>
    <option>opt3<div class="right">I need to be to the right</div></option>
</select> 
```

我可以做些什么来使用 DropKick 来定位选项的某些部分？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T23:35:18.877

```
 <select>
    <option>opt1</option>
    <option style="text-align: right;">opt2</option>
    <option>opt3<div class="right">I need to be to the right</div></option>
  </select> 
```

通过使用 CSS text-align: right;

这是什么意思？

丑陋的替代品：

```
 <select>
    <option>opt1</option>
    <option>opt2</option>
    <option style="text-align: right;">Foo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Bar&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</option>
  </select> 
```

它会“或多或少地”使空格之间的字母变得模糊，甚至不知道该怎么称呼它。:)

# java - Binder getService() 的公共定义可以吗？

> ID：13924038
> 
> 赞同：1
> 
> 时间：2012-12-17T23:31:10.023
> 
> 标签：java, android, scope, android-service

[Bound](http://developer.android.com/guide/components/bound-services.html) [Services](http://developer.android.com/reference/android/app/Service.html)上的 android 文档显示“无访问[修饰符](https://stackoverflow.com/questions/215497/in-java-whats-the-difference-between-public-default-protected-and-private)”，导致在定义`getService()`. 例如：

```
<!-- language: lang-java  -->
public class LocalBinder extends Binder {
    LocalService getService() {
        return LocalService.this;
    }
} 
```

我正在努力将我的代码重构为包，因此我可以在另一个应用程序中重新使用它，但遇到编译错误，说明“foo.LocalBinder 类型的方法 getService() 不可见”。

我一直无法找到`getService()`. 如果我打开范围，我是否有遇到问题的风险，例如：

```
<!-- language: lang-java  -->
public LocalService getService() {
... 
```

我只在我自己的应用程序中本地使用该服务，并且我已经`android:exported="false"`在我的`AndroidManifest.xml`.

# ios - ios - NSRangeException

> ID：13924044
> 
> 赞同：0
> 
> 时间：2012-12-17T23:31:50.067
> 
> 标签：ios, ios5, nsrangeexception

我在我的 Crashalytics 中遇到了这个异常：

```
0    CoreFoundation 
__exceptionPreprocess + 162
1    libobjc.A.dylib    
objc_exception_throw + 30
2    CoreFoundation 
-[NSException initWithCoder:]
3    CoreFoundation 
-[__NSCFArray objectAtIndex:] + 136
4    BusinessPlan ✭  BusinessController.m line 167
-[BusinessController tableView:didSelectRowAtIndexPath:] + 167
5    UIKit  
-[UITableView _selectRowAtIndexPath:animated:scrollPosition:notifyDelegate:] + 876
6    UIKit  
-[UITableView _userSelectRowAtPendingSelectionIndexPath:] + 156
7    Foundation 
__NSFireDelayedPerform + 450
8    CoreFoundation 
__CFRUNLOOP_IS_CALLING_OUT_TO_A_TIMER_CALLBACK_FUNCTION__ + 14
9    CoreFoundation 
__CFRunLoopDoTimer + 272
10   CoreFoundation 
__CFRunLoopRun + 1232
11   CoreFoundation 
CFRunLoopRunSpecific + 356
12   CoreFoundation 
CFRunLoopRunInMode + 104
13   GraphicsServices   
GSEventRunModal + 74
14   UIKit  
UIApplicationMain + 1120
15   BusinessPlan    main.m line 16
main + 16
16   BusinessPlan   
start 
```

它被称为：

```
Exception Type: NSRangeException
Reason: -[__NSCFArray objectAtIndex:]: index (14) beyond bounds (14) 
```

它只发生过一次，所以我不知道如何重现它。但它发生在这段代码中：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{        
    NSDictionary *info = [topics_array objectAtIndex:indexPath.row]; 
    NSString *section_name = [info objectForKey:@"section_name"];
    NSString *solution_section_id = [info objectForKey:@"solution_section_id"];

    // PUT THESE ITEMS INTO THE SESSION
    NSUserDefaults *standardUserDefaults = [NSUserDefaults standardUserDefaults];

    [standardUserDefaults setObject:section_name forKey:@"section_name"];
    [standardUserDefaults setObject:solution_section_id forKey:@"solution_section_id"];

    [standardUserDefaults synchronize];

    [self performSegueWithIdentifier:@"BusinessToTopic" sender:self];
} 
```

有谁知道如何防止这种情况在未来发生以及为什么会发生？

编辑：

这是 tableView numberOfRowsInSection 的代码

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section 
{    
    return [tableLabels count]; 
} 
```

谢谢！

# python - NumPy：3D 数组的 1D 插值

> ID：13924047
> 
> 赞同：2
> 
> 时间：2012-12-17T23:32:07.430
> 
> 标签：python, multidimensional-array, numpy, interpolation

我对 NumPy 比较陌生。任何人都有让这段代码更紧凑/更高效的想法，尤其是嵌套循环？顺便说一句， dist 和 data 是三维 numpy 数组。

```
def interpolate_to_distance(self,distance):

    interpolated_data=np.ndarray(self.dist.shape[1:])
    for j in range(interpolated_data.shape[1]):
        for i in range(interpolated_data.shape[0]):
            interpolated_data[i,j]=np.interp(
                                  distance,self.dist[:,i,j],self.data[:,i,j])

    return(interpolated_data) 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T04:37:39.763

好吧，我会用这个来打个招呼：

```
def interpolate_to_distance(self, distance):
    dshape = self.dist.shape
    dist = self.dist.T.reshape(-1, dshape[-1])
    data = self.data.T.reshape(-1, dshape[-1])
    intdata = np.array([np.interp(distance, di, da)
                        for di, da in zip(dist, data)])
    return intdata.reshape(dshape[0:2]).T 
```

它至少删除了一个循环（以及那些嵌套索引），但它并没有比原来的快多少，根据`%timeit`IPython 快 20%。另一方面，有很多（最终可能是不必要的）转置和重塑。

作为记录，我将它包装在一个虚拟类中，并用随机数填充了一些 3 x 3 x 3 数组以进行测试：

```
import numpy as np

class TestClass(object):
    def interpolate_to_distance(self, distance):
        dshape = self.dist.shape
        dist = self.dist.T.reshape(-1, dshape[-1])
        data = self.data.T.reshape(-1, dshape[-1])
        intdata = np.array([np.interp(distance, di, da)
                            for di, da in zip(dist, data)])
        return intdata.reshape(dshape[0:2]).T

    def interpolate_to_distance_old(self, distance):
        interpolated_data=np.ndarray(self.dist.shape[1:])
        for j in range(interpolated_data.shape[1]):
            for i in range(interpolated_data.shape[0]):
                interpolated_data[i,j]=np.interp(
                           distance,self.dist[:,i,j],self.data[:,i,j])
        return(interpolated_data)

if __name__ == '__main__':
    testobj = TestClass()

    testobj.dist = np.random.randn(3, 3, 3)
    testobj.data = np.random.randn(3, 3, 3)

    distance = 0
    print 'Old:\n', testobj.interpolate_to_distance_old(distance)
    print 'New:\n', testobj.interpolate_to_distance(distance) 
```

哪个打印（对于我的特定随机数）：

```
Old:
[[-0.59557042 -0.42706077  0.94629049]
 [ 0.55509032 -0.67808257 -0.74214045]
 [ 1.03779189 -1.17605275  0.00317679]]
New:
[[-0.59557042 -0.42706077  0.94629049]
 [ 0.55509032 -0.67808257 -0.74214045]
 [ 1.03779189 -1.17605275  0.00317679]] 
```

我也尝试过`np.vectorize(np.interp)`，但无法让它发挥作用。我怀疑如果它确实有效，那会快得多。

我也无法开始`np.fromfunction`工作，因为它将 (2) 3 x 3（在这种情况下）索引数组传递给`np.interp`，与您从`np.mgrid`.

另一个注意事项：根据文档`np.interp`，

> `np.interp`不检查 x 坐标序列`xp`是否在增加。如果 `xp`不增加，结果是无稽之谈。一个简单的增长检查是：
> 
> ```
> np.all(np.diff(xp) > 0) 
> ```

显然，我的随机数违反了“不断增加”的规则，但您必须更加小心。

# spring - SpringSecurity + JSF 自定义认证

> ID：13924049
> 
> 赞同：0
> 
> 时间：2012-12-17T23:32:12.470
> 
> 标签：spring, authentication, spring-mvc, spring-security

我试图找到解决方案，但没有人工作。我有一些用 JSF 编写的 spring 安全配置和前端。我在意图中找到了一些配置，但他们一起不想工作

```
<http>
     <intercept-url pattern="/index*" access="IS_AUTHENTICATED_ANONYMOUSLY" />
     <intercept-url pattern="/javax.faces.resource/**"
        access="IS_AUTHENTICATED_ANONYMOUSLY" />
     <intercept-url pattern="/**" access="ROLE_USER" />
     <intercept-url pattern="/admin/*" access="ROLE_SUPERVISOR" />
     <form-login login-page="/index.html" default-target-url="/home.html"
        always-use-default-target="true" authentication-failure-url="/index.xhtml?login_error=1" />
     <logout logout-url="/logout.html" />
</http> 
```

和：

```
 <authentication-manager>
    <authentication-provider>               
        <user-service>
            <user name="admin" password="admin" authorities="ROLE_USER, ROLE_SUPERVISOR" />
            <user name="anonim" password="anonim" authorities="" />
            <user name="user" password="user" authorities="ROLE_USER" />
        </user-service>
    </authentication-provider>
</authentication-manager> 
```

我想做一些自定义类，就像自定义记录器一样，我找到了类似于这些的解决方案：

```
public class LoginBeenController {
    private static final Logger LOGGER = Logger.getLogger(LoginBeenController.class);

    private String login;
    private String password;
    @Autowired
    private AuthenticationManager authenticationManager;

    public LoginBeenController() {

    }

    public String getLogin() {
        return login;
    }

    public String getPassword() {
        return password;
    }

    public void setLogin(String login) {
        this.login = login;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    public String login(){
        Authentication authentication = authenticationManager
                .authenticate(new UsernamePasswordAuthenticationToken(
                        this.login, this.password));
        if (authentication.isAuthenticated()) {
            SecurityContextHolder.getContext().setAuthentication(
                    authentication);
        }
        return new String();
    }

} 
```

这是主要形式：

```
<h:form>    
    <h:panelGrid columns="2" cellpadding="5">  
        <h:outputLabel for="username" name='j_username' value="Username:" />  
        <p:inputText id="username" value="#{loginBeenController.login}" required="true" label="username" />  

        <h:outputLabel for="password" value="Password:" />  
        <h:inputSecret id="password" value='#{loginBeenController.password}' required="true" label="password" />  

        <f:facet name="footer">  
            <p:commandButton ajax='false' id="loginButton" value="Login" action="#{loginBeenController.login()}" />  
        </f:facet>  
    </h:panelGrid>            
</h:form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T12:57:00.537

好的，我找到了我只需要添加的解决方案：

```
 @Autowired
@Qualifier("authenticationManager")
AuthenticationManager authenticationManager; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T02:20:44.490

You should be forwarding to Spring Security authentication URL instead of using the AuthenticationManager. Try this:

```
public String doLogin() throws ServletException, IOException {

    FacesContext context = FacesContext.getCurrentInstance();

        String springCheckUrl = this.buildSpringSecurityCheckUrl();

        HttpServletRequest request = (HttpServletRequest) context
                .getExternalContext().getRequest();

        RequestDispatcher dispatcher = request
                .getRequestDispatcher(springCheckUrl);

        dispatcher.forward((ServletRequest) request,
                (ServletResponse) context.getExternalContext.getResponse());

        context.responseComplete();

        return null;
    }

    private String buildSpringSecurityCheckUrl() {
        StringBuilder springCheckUrl = new StringBuilder(
                "/j_spring_security_check").append("?").append("j_username")
                .append("=").append(this.userName.trim()).append("&")
                .append("j_password").append("=")
                .append(this.userPassword.trim());
        return springCheckUrl.toString();
    }
} 
```

# android - ListView.setSelectionFromTop() 不工作

> ID：13924062
> 
> 赞同：0
> 
> 时间：2012-12-17T23:33:30.980
> 
> 标签：android, listview

我有一个由字符串数组填充的 ListView。我想动态选择一个项目，但 .setSelection(1) 和 .setSelectionFromTop(1,100) 不起作用。

```
list.setSelection(2);
Log.i(TAG, "my pos: "+ list.getSelectedItemPosition()); 
```

这可以追溯到“我的位置：-1”

有没有人有任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T23:38:28.757

`setSelection()`并`getSelectedItemPosition()`指代两个不同的事物。

“选择”是指第一个可见行，如`getFirstVisiblePosition()`.
“选定”是指选定的视图，如`View#setSelected()`.

你想要哪一个？

# android - 无法从内部或外部存储发送 HTML 文件作为邮件的附件

> ID：13924067
> 
> 赞同：0
> 
> 时间：2012-12-17T23:34:13.643
> 
> 标签：android, email, android-intent, storage, attachment

我一直在阅读，所以（令人惊讶的是）不可能将文件作为邮件附件发送到内部存储中（即使在 MODE_WORLD_READABLE 中）。

因此，我使用（脏）代码在发送邮件之前将文件复制到外部存储。

问题是，当我收到邮件时，附件不存在（虽然发送时显示为附件）！

然而，当我使用 Root Explorer 通过邮件手动发送文件时，一切正常......

这是我的代码：

```
File sdDir = Environment.getExternalStorageDirectory();
File dir = getDir("MyApp", MODE_WORLD_READABLE);
copyFile(new File(dir.getAbsolutePath()+File.separator+Ref+"-"+Name+".html"), new File(sdDir+File.separator+Ref+"-"+Name+".html"));
emailIntent.setType("text/html");
emailIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, subject);
emailIntent.putExtra(android.content.Intent.EXTRA_TEXT, emailtext);
emailIntent.putExtra(Intent.EXTRA_STREAM, Uri.parse(sdDir+File.separator+ReservationReference+"-"+LastName+".html")); //"file://"+dir.getAbsolutePath()+File.separator+ReservationReference+"-"+LastName+".html"));
this.startActivity(Intent.createChooser(emailIntent, "Send by mail")); 
```

提前谢谢你。

# git - Git - 我的分支基于错误的不需要的提交，如何修复

> ID：13924068
> 
> 赞同：1
> 
> 时间：2012-12-17T23:34:36.613
> 
> 标签：git, rebase

所以我分叉了一个开源项目，并在上周发送了一个错误修复，但没有被拉入他们的主人。我在一个单独的分支上创建了该修复程序，将其重新建立在上游的 master 之上，并从该分支发出了拉取请求。然而，我随后开始处理一个新问题，但错误地从我为原始错误修复创建的分支创建了这个新问题的分支。

所以现在我在我想要推送并发出拉取请求的分支中直接在我的下方提交了该提交。我将所有对 upstream/master 的更新获取并合并到我的 master 分支中，我想在顶部重新提交这个新提交并将其发送，但由于那个较旧的错误修复提交，尝试重新设置会产生冲突。

处理这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T00:21:59.383

（如我的评论中所述，）解决方案是软重置提交（`git reset --soft HEAD^`），将其隐藏，`git stash save`然后切换到正确的`HEAD`via `rebase`，`checkout`或者您喜欢或必须使用的任何方式。

在此之后，一个简单的`git stash apply`应该从存储中恢复您的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T00:37:48.913

您可以将第二个分支重新设置为 master，将第一个分支设置为上游：

```
git rebase --onto master bad-branch second-bug-fix 
```

# c - 从文件创建 1 和 0 的矩阵 NxN 的 C 程序中的分段错误

> ID：13924070
> 
> 赞同：1
> 
> 时间：2012-12-17T23:34:47.093
> 
> 标签：c, multidimensional-array, matrix, segmentation-fault

我有以下问题：我有一个文件，假设**file1.dat**包含以下数据：

```
1 2
3 1
2 1
1 3
3 2 
```

我想用 C 编写一个程序，从这个文件中读取并在一个新文件中创建一个 NxN 矩阵，如果矩阵的第 i 个和第 j 个元素都包含在**file1.dat**中，则为 1，否则为 0 . 在这种情况下，我将有一个 3x3 矩阵，例如

```
0 1 1
1 0 0
1 1 0 
```

对我来说，困难是要让计算机清楚地知道**file1.dat**中的数字是矩阵元素的坐标，它应该在其中放置 1，而在其他站点中放置 0。

根据其中一位用户的建议，我尝试了以下代码：

```
#include <stdio.h>
#define N 131827

int main(void){
int x,y;
int matrix[N][N];
FILE *ifp = fopen("file1.dat", "r");
FILE *ofp = fopen("matrice_A_1.dat", "w");
while(fscanf(ifp, "%d %d", &x, &y) != EOF){
x--;
y--;
matrix[x][y] = 1;
}
fclose(ifp);
for(x=0; x<N; x++){
  for(y=0; y<N; y++){
fprintf(ofp, "%d ", matrix[x][y]);
  }
  fprintf(ofp, "\n");
}
fclose(ofp);
return(0);
} 
```

但我使用了另一个131827 行（和 2 个列）的 file1.dat，但它给了我一个分段错误错误**。**有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T23:53:34.040

```
#include <stdio.h>
//Create NxN matrix with input coordinates used to set element val=1; rest 0
void doStuff(int N){
    int x,y;
    int matrix[N][N] = {{0}};
    FILE *ifp = fopen("file1.dat", "r");
    FILE *ofp = fopen("out.dat", "w");
    while(fscanf(ifp, "%d %d", &x, &y) != EOF){
        x--;
        y--;
        matrix[x][y] = 1;
    }
    fclose(ifp);
    for(x=0; x<N; x++){
        for(y=0; y<N; y++){
            fprintf(ofp, "%d ", matrix[x][y]);
        }
        fprintf(ofp, "\n");
    }
    fclose(ofp);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-17T23:42:00.100

可以这么简单：

```
// Define static matrix containing all zeroes.
const int ROWS = 3;
const int COLS = 3;
int m[ROWS][COLS] = {0}; 
```

然后去读...

```
int i, j;
FILE * fp = fopen( "file1.dat", "rt" );
if( fp != NULL ) {
    while( 2 == fscanf( fp, "%d%d", &i, &j ) {
        if( i < 1 || i > ROWS || j < 1 || j > COLS ) {
             printf( "Bad address: %d, %d\n", i, j );
             continue;
        }
        m[i-1][j-1] = 1;
    }
    fclose(fp);
} 
```

# ruby - File.open 是如何在 Ruby 中实现的？

> ID：13924071
> 
> 赞同：0
> 
> 时间：2012-12-17T23:35:02.040
> 
> 标签：ruby, file, file-io

我试图找到它是如何实现的，但是在我从[https://github.com/ruby/ruby](https://github.com/ruby/ruby)`File.open()`获得的代码中四处寻找时找不到它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T23:52:14.880

该类`File`是 C 模块，而不是 Ruby 模块。所以，你不会找到它的 Ruby 代码。

看起来它`file.c`位于根文件夹中。该模块包括该`IO`模块，该模块是另一个 C 模块，`io.c`位于同一位置。在其中查找名称以 . 开头的函数`rb_file_open`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T05:16:31.937

没有`File::open`，它是继承自`IO`。所以，你需要寻找`IO::open`.

一般来说，我建议为此使用 Rubinius 源代码。它比 YARV 的源代码组织得更好，文档记录也更好，最重要的是：它主要是用 Ruby 编写的，而在 YARV 中，整个语言、整个核心库和标准库的重要部分都是用 C 编写的。

话虽如此，[的实现`IO::open`是完全无聊](https://GitHub.Com/Rubinius/Rubinius/blob/master/kernel/common/io.rb#L211-225)的。它只是做了显而易见的事情：

```
def self.open(*args)
  io = new(*args)

  return io unless block_given?

  begin
    yield io
  ensure
    begin
      io.close unless io.closed?
    rescue StandardError
      # nothing, just swallow them.
    end
  end
end 
```

# java - jpl.dll：找不到依赖库

> ID：13924081
> 
> 赞同：1
> 
> 时间：2012-12-17T23:35:59.737
> 
> 标签：java, prolog, jpl

我正在使用 java netbeans 并想在其中使用 prolog api，但我不断收到错误

```
Exception in thread "main" java.lang.UnsatisfiedLinkError: C:\Program Files\swipl\bin\jpl.dll: Can't find dependent libraries
at java.lang.ClassLoader$NativeLibrary.load(Native Method)
at java.lang.ClassLoader.loadLibrary1(ClassLoader.java:1939)
at java.lang.ClassLoader.loadLibrary0(ClassLoader.java:1864)
at java.lang.ClassLoader.loadLibrary(ClassLoader.java:1825)
at java.lang.Runtime.load0(Runtime.java:792)
at java.lang.System.load(System.java:1059)
at contacteditor.Advisory.<init>(Advisory.java:18)
at contacteditor.ContactEditor.main(ContactEditor.java:21) 
```

谁能帮帮我？

# c# - 如何使用 XMLReader 迭代 XML 中的 XML 元素并绕过空格？

> ID：13924082
> 
> 赞同：1
> 
> 时间：2012-12-17T23:36:00.893
> 
> 标签：c#, xml, xmlreader

假设您有一个这样的 XML：

```
 <?xml version="1.0" encoding="utf-8"?>
<Class HashCode="307960707">
  <Person>
    <Class HashCode="-2020100801">
      <FullName>
        <FirstName>Dan</FirstName>
        <LastName>K</LastName>
      </FullName>
    </Class>
    <Age>20</Age>
    <Class HashCode="-439631396">
      <Address>
        <Street>abc</Street>
        <City>new york</City>
        <ZipCode>30500</ZipCode>
        <PhoneNumber>1245</PhoneNumber>
      </Address>
    </Class>
    <Class HashCode="-1436395737">
      <Person>
        <Class HashCode="-1303968324">
          <FullName>
            <FirstName>katty</FirstName>
            <LastName>G</LastName>
          </FullName>
        </Class>
        <Age>18</Age>
        <Class HashCode="-439631396">
          <Address />
        </Class>
        <Class HashCode="307960707">
          <Person />
        </Class>
      </Person>
    </Class> 
```

我希望能够仅按元素`XMLReader`出现的顺序迭代元素，这意味着 class->Person-> class->FullName 等。
我试图使用类似的方法进行导航，`XMLReader.ReadStartElement()`但它不起作用，尤其是当我阅读时类似的空格`"\n"`似乎也是一个元素。：/
我试图绕过那个空白的方法`XMLReader.Read()`没有成功。

请帮助我了解我应该如何导航。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T23:48:26.650

`XmlReader`构造函数有一个接受`XmlReaderSettings`对象的重载。该`XmlReaderSettings`对象具有`IgnoreWhitespace`属性。

为了只读取下一个元素，您可以在 XmlReader 上实现扩展方法。

这是一个例子：

```
public static class ExtensionMethods
{
    public static bool ReadNextElement(this XmlReader reader)
    {
        while (reader.Read())
            if (reader.NodeType == XmlNodeType.Element)
                return true;

        return false;
    }
} 
```

这是一个小控制台应用程序，将演示这一点：

```
public class Program
{
    public static void Main(string[] args)
    {
        var settings = new XmlReaderSettings();
        settings.IgnoreWhitespace = true;
        settings.IgnoreComments = true;
        settings.IgnoreProcessingInstructions = true;

        var reader = XmlReader.Create("XMLFile1.xml", settings);
        while (reader.ReadNextElement())
            Console.WriteLine(reader.Name);
    }
} 
```

# c++ - enum 在 Windows 上具有意想不到的价值，但在 Linux 上没有

> ID：13924084
> 
> 赞同：-1
> 
> 时间：2012-12-17T23:36:42.790
> 
> 标签：c++, windows, gcc, enums

我无法让枚举在 Windows 上正常工作。在 linux 上编译时它返回预期值，但在 windows 上它返回一些随机数。

```
typedef enum wezly {
    elektrownie1,
    konwencjonalne1,
    niekonwencjonalne1,
    weglowa1,
    jadrowa1,
    sloneczna1,
    wiatrowa1,
    geotermiczna1,
    gazowa1,
    wodna1,
    maremotoryczna1,
    maretermiczna1
};

wezly wybor_wezla(string opcja)
{
    string bb;
    bb = opcja;

    if ((bb.compare("[elektrownie]")==0)||(bb.compare("[ELEKTROWNIE]")==0))
        return elektrownie1;
    else if ((bb.compare("[konwencjonalne]")==0)||(bb.compare("[KONWENCJONALNE]")==0))
        return konwencjonalne1;
    else if ((bb.compare("[gazowa]")==0)||(bb.compare("[GAZOWA]")==0))
        return gazowa1;
    else if ((bb.compare("[wodna]")==0)||(bb.compare("[WODNA]")==0))
        return wodna1;
    // (and so on...)
}

int main()
{

    cout << wybor_wezla("[gazowa]");
} 
```

在linux上我得到7，在windows上它是一些随机数......

为什么会这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-17T23:49:47.723

它实际上在这里坏了（在查看[了您在评论中提供的链接](http://ideone.com/O7bDJO)之后）：

```
 bb=opcja.substr((opcja.find_first_of("[")),(opcja.find_first_of("]"))-1); 
```

如果输入是“... [whatever] ...”，这将导致提取像“[whateve”这样的字符串。

我认为你的意思是：

```
 bb=opcja.substr((opcja.find_first_of("[")),(opcja.find_first_of("]"))-opcja.find_first_of("[")+1); 
```

这导致从输入中提取像“[whatever]”这样的字符串。

给定输入“[gazowa]”的原始代码会将“[gazow”与各种字符串进行比较，没有一个匹配，并且在没有命中`return`语句的情况下到达函数的末尾。

这会导致未定义的行为。因此，你在 linux 上的结果是 7，而在 windows 上的结果`[gazowa]`应该是 8。

您还需要做一些更明智的事情来处理您的字符串都不匹配的情况，即如果到达结尾`wybor_wezla`。在这种情况下你做什么取决于你，但作为开始，我至少会在其中放置一个打印语句，这样你就知道什么时候没有匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-17T23:59:33.470

您的代码缺少最后一个`else`子句：

```
wezly wybor_wezla(string opcja)
{
    if(...)
        return ...;
    else if(...)
        return ...;
    else if(...)
        return ...;
    // No final else!
} 
```

当没有任何`if`子句为真时，它会从函数的末尾落下而不返回一个值，即*Undefined Behavior*。在这种情况下，它返回一个垃圾值，但可能会发生更糟糕的事情。

您的第一个操作应该是添加最后一个`else`子句。这可以返回默认值、错误代码、抛出异常`abort()`等，但它*不能什么都不做*。如果您知道该值必须是一组有限的事物中的一个，您可以将 final 更改`else if`为只是 an`else`并假设如果它不是第一`N-1`件事，那就是`Nth`事情。

完成此操作后，您需要弄清楚为什么您的数据没有落入预期的情况之一并修复它。

# reporting-services - Reporting Services - 列表列表

> ID：13924092
> 
> 赞同：0
> 
> 时间：2012-12-17T23:37:29.647
> 
> 标签：reporting-services, ssrs-2008, reporting

我有一个显示该区域的报告，该区域的诊断列表，每个诊断的诊断数量以及百分比。这很好用，但是我想选择并显示许多区域的数据。

目前，我对该区域有一个选择，它在表格中显示了所选区域的所有诊断。本质上，我想列出这些表格，以便可以根据需要对尽可能多的区域进行重复。

我认为这可以通过将表格放入列表框中并将 tablix 设置为过滤每个区域来执行，但如果我尝试这个，我会得到：

```
Error 1 [rsInvalidDetailDataGrouping] The tablix ‘Tablix1’ has a detail member
with inner members. Detail members can only contain static inner members. 
```

很难准确地解释我需要什么。目前，所有的诊断都显示出来了，但它们都被列为来自同一区域。我需要一个区域 1 的诊断列表，然后是区域 2 的列表，然后是区域 3 等。百分比需要是该*区域*的百分比，目前它们是所有区域的百分比。

做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T02:52:49.840

不要将表格放在列表中 - 只需在表格上使用分组。

假设您现在想要一个调用多个 vaue 参数`@Areas`来选择区域，然后将它们全部打印出来，比如说用分页符分隔。我假设您有一个用于诊断的表和一个用于诊断中执行的项目的表 DiagnosisItems。所以你的 SQL 看起来像这样：

```
SELECT Diagnoses.Area, Diagnoses.DiagnosisDate, Diagnoses.Description, 
    COUNT(*) AS TotalDiagnoses
FROM Diagnoses 
INNER JOIN DiagnosisItems ON Diagnoses.DiagnosisId = DiagnosisItems.DiagnosisId
WHERE Diagnoses.Area IN @Areas
GROUP BY Diagnoses.Area, Diagnoses.DiagnosisDate, Diagnoses.Description
ORDER BY Diagnoses.Area, Diagnoses.DiagnosisDate, Diagnoses.Description 
```

单击您的表格，然后右键单击“详细信息”行左侧显示的灰色手柄。选择`Add Group`并分组`Area`。添加组页眉和组页脚。在表中，将`Area`组标题和组页脚放入`Area`该区域的总诊断数：

```
=SUM(Fields!TotalDiagnoses.Value) 
```

现在，在百分比的详细信息行中，您将使用如下表达式：

```
=Fields!TotalDiagnoses.Value / SUM(Fields!TotalDiagnoses.Value, "table1_Group1") 
```

右键单击组句柄，选择`Row Group-Group Properties-Page Breaks`并检查组的每个实例之间的分页符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T23:42:46.683

我认为您不需要在 tablix 上放置过滤器。只需在列表上设置分组并添加 tablix。

# vim - 使用鼠标进行 Gvim 折叠切换

> ID：13924093
> 
> 赞同：6
> 
> 时间：2012-12-17T23:37:31.997
> 
> 标签：vim, mouse, folding

是否可以使用鼠标单击在 Gvim 中打开和关闭折叠？

说双击打开和关闭折叠？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-18T01:25:23.210

在折叠栏（例如`:set foldcolumn=4`）中，您可以通过（单击）标志打开/关闭折叠；这是开箱即用的。

我使用的映射类似于您的答案中的映射，它只是打开折叠，但在其他方面保持默认的双击行为：

```
" <2-LeftMouse>     Open fold, or select word or % match.
nnoremap <expr> <2-LeftMouse> foldclosed(line('.')) == -1 ? "\<2-LeftMouse>" : 'zo' 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-18T00:14:40.907

这就是我要找的

```
:noremap <2-LeftMouse> za 
```

通过鼠标双击切换折叠

或者可能是三次点击以避免与vim的文本选择命令冲突

```
:noremap <3-LeftMouse> za 
```

# mediawiki - 维基百科上给定页面的完整图片网址（仅限我在页面上看到的图片）

> ID：13924097
> 
> 赞同：2
> 
> 时间：2012-12-17T23:38:14.220
> 
> 标签：mediawiki, wikipedia, wikipedia-api, wikimedia-commons

我想提取维基百科上“谷歌”页面的所有完整图片网址

我尝试过：

```
http://en.wikipedia.org/w/api.php?action=query&titles=Google&generator=images&gimlimit=10&prop=imageinfo&iiprop=url|dimensions|mime&format=json 
```

但是，通过这种方式，我也得到了与谷歌无关的图片，例如：

```
http://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg
http://upload.wikimedia.org/wikipedia/en/4/4a/Commons-logo.svg
http://upload.wikimedia.org/wikipedia/en/4/4a/Commons-logo.svg
http://upload.wikimedia.org/wikipedia/commons/f/fe/Crystal_Clear_app_browser.png 
```

如何仅提取我在[Google 页面上看到的图像](http://en.wikipedia.org/wiki/Google)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T19:33:47.893

1.  检索页面源代码，[https://en.wikipedia.org/w/index.php?title=Google&action=raw](https://en.wikipedia.org/w/index.php?title=Google&action=raw)
2.  扫描它以查找子字符串，例如`[[File:Google web search.png|thumb|left|On February 14, 2012, Google updated its homepage with a minor twist. There are no red lines above the options in the black bar, and there is a tab space before the "+You". The sign-in button has also changed, it is no longer in the black bar, instead under it as a button.]]`
3.  请求 API 获取页面上的所有图片，[http ://en.wikipedia.org/w/api.php?action=query&titles=Google&generator=images&gimlimit=10&prop=imageinfo&iiprop=url|dimensions|mime&format=json](http://en.wikipedia.org/w/api.php?action=query&titles=Google&generator=images&gimlimit=10&prop=imageinfo&iiprop=url|dimensions|mime&format=json)
4.  过滤掉与步骤 2 中找到的图片名称匹配的网址。

步骤 2 和 4 需要更多解释。

@2。正则表达式`/\b(File|Image):[^]|\n\r]+/`应该足够了。在 Ruby 的正则表达式中，`\b`表示您选择的语言可能不支持的单词边界。我提出的正则表达式将匹配我想到的所有案例：`[[File:something.jpg]]`、画廊标签：`<gallery>\nFile:one.jpg\nFile:two.jpg\n</gallery>`、模板：`{{Infobox|pic = File:something.jpg}}`。但是，它不会匹配包含`]`. 我不确定它们是否合法，但如果是，它们一定非常罕见，应该没什么大不了的。

如果你只想匹配这样的结构: `[[File:something.jpg|thumb|description]]`，下面的正则表达式会更好：`/\[\[(File|Image):[^]|]+/`

@4。我会从匹配的名称中删除所有字符`/[^A-Za-z0-9]/`。这比逃避它们更容易，而且在大多数情况下，就足够了。

图标最常附加在模板中，而与文章主题相关的图片通常直接附加（`[[File:…]]`）。但也有例外，例如在某些文章中，图片附有 {{Gallery}} 模板。还有一个`<gallery>`标签为画廊引入了特殊的语法。您必须根据您的需求调整我的解决方案，即使那样它也不会是完美的，但它应该足够好。

# java - 根据子字符串获取唯一的 List 元素

> ID：13924104
> 
> 赞同：2
> 
> 时间：2012-12-17T23:39:01.113
> 
> 标签：java, android

我有一个 ArrayList(String) ，其中包含一个格式化日期列表，如下所示：

```
element 1: "2012-5-1"
element 2: "2012-8-10"
element 3: "2012-12-5"
element 4: "2013-12-21"
element 5: "2013-12-13"
element 6: "2014-5-8" 
```

创建另一个包含唯一年份条目的列表或普通原始数组的最有效/框架方法是什么？例如，我的新列表将包含：

```
element 1: "2012"
element 2: "2013"
element 3: "2014" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T00:50:13.030

试试这个

```
ArrayList<String> yearsOnlylist = new ArrayList<String> ();
for(String s : elements) {
    String yearExtracted = s.substring(0,4);
    yearsOnlylist.add(yearExtracted);
} 
```

其中*elements*是扩展表单中日期列表的名称。

用作目的地列表

```
 LinkedList<String> yearsOnlylist = new LinkedList<String> (); 
```

而不是*ArrayList*可以明显提高转换效率（因为在 LinkedList 中添加是*O(1)*）但是第二次访问特定位置，效率较低（*O(n)* vs *O(1)*）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-17T23:40:58.383

只需将它们添加到 Set 并将其转换为列表：

```
Set<String> unique = new HashSet<String>();
for (String element : elements) {
    set.put(element.substring(0,4));
}
List<String> uniqueList = new ArrayList<String>();
uniqueList.addAll(unique); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-17T23:42:20.973

遍历您的数组列表并获取数组列表每个成员的前 4 个字符的子字符串。

将该子字符串添加到 HashSet 之类的集合实现中，这将为您提供所需的内容。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-09-18T08:59:31.350

```
public List<String> trimmer(List<String> x) {
    Log.e("", Integer.toString(x.size()));
    for (int i = 0; i < x.size(); i++) {
        String s = x.get(i).toString(); 
        String a = s.substring(6);
        Log.e("after trim is?", a);
        x.remove(i);
        x.add(i, a);
    }
    // check if the element got added back
    Log.e("Trimmer function", x.get(1));

    return x;
} 
```

希望这会对您有所帮助！

# objective-c - 用户关闭时如何避免释放 NSPanel

> ID：13924105
> 
> 赞同：1
> 
> 时间：2012-12-17T23:39:04.100
> 
> 标签：objective-c, cocoa, nspanel

我正在开发一个小而简单的状态菜单应用程序。
有一个菜单，当用户单击它时，应该会出现一个 HUD 窗口（NSPanel）。这就是我显示面板的方式：

```
[hudWindow makeKeyAndOrderFront: self]; 
```

这就是我关闭窗口的方式：

```
[hudWindow orderOut: nil]; 
```

这就是事件链：

1.  当应用程序启动时，我关闭窗口；
2.  然后用户（就是我:-)）点击菜单项并使面板出现；
3.  然后我点击 x 并关闭面板；
4.  然后我再次单击菜单项，窗口不再出现。

它不再出现可能是因为它被释放了，而且我放了一个弱存储，否则使用 __unsafe_unretained 它会在第二次启动时崩溃。
所以我猜是否有办法避免在用户点击它时释放窗口。
我尝试过使用强大的存储，但是在第二次启动时我无法再次关闭它，这是一个问题。
有许多菜单状态应用程序能够显示一个窗口，而用户可以“杀死”它，我会做类似的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T05:35:44.427

您应该取消选中 IB 中的“关闭时释放”复选框（或在代码中完成等效操作）。该框默认为面板选中。

使用强指针可能不起作用，因为releasedWhenClosed 设置会覆盖它。拥有一个强指针仅仅意味着保留计数将至少为 1，但这并不妨碍系统显式地向面板发送释放消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T00:05:59.680

你不能把你的属性从弱变强吗？

# ruby - 如何在 Ruby 中使用 Where 子句 (PostgreSQL) 中的变量编写查询

> ID：13924108
> 
> 赞同：0
> 
> 时间：2012-12-17T23:39:12.117
> 
> 标签：ruby, postgresql-9.2

这就是我希望在不使用 gem 的情况下实现的目标。我在我的一个视图中有一个搜索功能，我希望允许人们在单个字段中输入名字和姓氏，让我的类方法搜索名字和姓氏并生成一个列表。我目前有以下丑陋的代码，它将在两个字段上进行全文搜索。怜悯我 :) 我是 SQL 和 PostgreSQL 的新手。我只做了基本的查询。

```
 def self.text_search(query)
    if query.present?
      q1, q2, q3, q4 = query.split(' ')
      case
      when q4 != nil
        where('first_name @@ :q1 OR first_name @@ :q2 OR first_name @@ :q3 OR first_name @@ :q4 OR last_name @@ :q1 OR last_name @@ :q2 OR last_name @@ :q3 OR last_name @@ :q4', q1: q1, q2: q2, q3: q3, q4: q4)
      when q3 != nil
        where('first_name @@ :q1 OR first_name @@ :q2 OR first_name @@ :q3 OR last_name @@ :q1 OR last_name @@ :q2 OR last_name @@ :q3', q1: q1, q2: q2, q3: q3)
      when q2 != nil
        where('first_name @@ :q1 OR first_name @@ :q2 OR last_name @@ :q1 OR last_name @@ :q2', q1: q1, q2: q2)
      else
        where('first_name @@ :q1 OR last_name @@ :q1', q1: q1)
      end
    else
      scoped
    end
  end 
```

此代码适用于它在两个字段中搜索整个单词并生成所有匹配的记录。但是，我想做的是能够搜索以在搜索框中输入的值开头的列。例如，如果有人输入“Pat”，则查询将选择 Pat、Patrick、Patrice、Patricia 等。我确信有更好的方法来编写我包含的代码，我可以在其中列出我想要的所有值检查 first_name 和 last_name （或者至少我希望有）。

我今天一直在做很多关于这个的网络搜索。我发现了很多关于这方面的各个方面的信息。我看到了如何使用变量创建正则表达式。这对我来说很明显。我的问题是弄清楚如何将这些信息传递到我的 where 子句中。例如，我为所有四个字段尝试了以下代码。

```
qr1 = /^#{q1}/ 
```

然后我做了一个类似的 where 子句，我检查了 first_name 和 last_name 的所有四个值。我的查询没有返回任何行。

```
where ('first_name ~ :qr1', qr1: qr1) 
```

我还看到了有关检查子字符串与数组进行比较的解决方案。我在该解决方案中看到的问题是，您必须知道输入的值需要多长时间才能成功。这是一个带有示例的 Stack Overflow 帖子：

[选择范围内的第一个字母（PostgreSQL）](https://stackoverflow.com/questions/8085651/select-where-first-letter-in-a-range-postgresql)

我还观看了 RailsCasts #343 (Pro)，其中讨论了 to_tsvector 和 plainto_tsquery，但坦率地说我迷路了。也许这是我的答案，但我可以肯定需要一些帮助。这对我来说就像泥巴一样清晰。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T18:40:17.027

```
def self.text_search(query)
  if query.present?
    arr = query.split(' ').map { |q| "%#{q}" }

    where('first_name ~~* ANY(ARRAY[:arr]) OR last_name ~~* ANY(ARRAY[:arr])', arr: arr)
  else
    scoped
  end
end 
```

# java - 这是什么意思'解析文本文件或数据流'，它是否适用于可序列化

> ID：13924111
> 
> 赞同：5
> 
> 时间：2012-12-17T23:39:43.630
> 
> 标签：java, serialization, text-parsing, singly-linked-list, data-stream

这是我的第二篇文章，我现在已经习惯了这里的东西的功能！这更像是计算机科学的理论问题，但是，我的问题是这意味着什么？

> '解析文本文件或数据流'

这是一项作业，我查阅过的书籍和网络资源都是旧的或模糊的。我已经在 SinglyLinkedList 上实现了一个可序列化的接口，它将文件保存/加载到磁盘/从磁盘加载，以便以后可以传输/编辑和访问它。这是否足以满足相当模糊的要求？

考虑这个问题时要注意的事项：

*   这个要求是我正在做的一个项目的众多要求之一
*   我使用的单链表是定制的——我知道，预制的 Java 更好，但我必须展示我的技能
*   所有的方法都有效——我已经测试过了——这只是文档的问题
*   我正在使用 ObjectOutputStream、FileOutputStream、ObjectInputStream 和 FileInputStream 以及各自的方法来读/写单链表对象

我会很感激反馈

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-18T00:38:43.717

“解析”的过程可以描述为读取某种数据流并构建内存模型或该数据语义内容的表示，以便于对数据执行某种转换。

一些例子：

1.  编译器解析您的源代码以（通常）构建代码的抽象语法树，目的是生成对象（或字节）代码以供机器执行。
2.  解释器做同样的事情，但语法树直接用于控制执行（一些解释器是字节码生成器和虚拟机的混搭，可能会生成中间字节码）。
3.  CSV 解析器读取根据 CSV 规则（逗号、引号等）结构化的流，以提取文件中每一行表示的数据项。
4.  JSON 或 XML 解析器对 JSON 或 XML 编码的数据执行类似的操作，构建数据项的语义值及其分层相互关系的内存表示。

# git - 如何在子分支中选择一个提交并将其合并到主分支中？

> ID：13924115
> 
> 赞同：1
> 
> 时间：2012-12-17T23:39:49.707
> 
> 标签：git, merge, branch, commit, git-cherry-pick

所以我有：

```
master
+commit1
+commit2
+commit3

myBranch
+commitA
+commitB
+commitC 
```

我想在 myBranch 中选择 commitB 并将其合并到 master 分支，我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-17T23:44:02.563

```
git checkout master
git cherry-pick commitB 
```

或者甚至更好，`git help cherry-pick`并阅读它。

# objective-c - 从 nsstring iOS 中删除空字符

> ID：13924118
> 
> 赞同：1
> 
> 时间：2012-12-17T23:40:12.040
> 
> 标签：objective-c, ios, nsstring

我有这行代码导致我的应用程序崩溃。

```
 trimmedtext=[NSString stringWithCString:[mycharstring cStringUsingEncoding:[ NSString defaultCStringEncoding ] ] encoding:NSUTF8StringEncoding]; 
```

错误是：*** 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“*** + [NSString stringWithCString:encoding:]: NULL cString”

它崩溃是因为我认为我的 NSString 中有 NULL 字符。

NSLog 给了我这个 'friendXx' ，字符串中有一个表情符号！

我该如何克服这个问题？

任何帮助表示赞赏。

**正确答案：text=[NSString stringWithCString:[mycharstring UTF8String] encoding:NSUTF8StringEncoding];**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-17T23:45:29.290

> 它崩溃是因为我的 NSString 中有 NULL 字符。

除了它没有。

问题是 C 字符串（类型为`const char *`）是一个指针，其值为`NULL`，即它是无效指针。其主要原因可能是，例如，`mycharstring`变量是`nil`。

编辑：所以字符串中有一些默认C字符串编码无法处理的符号，这就是它返回NULL的原因。尝试`[mycharstring UTF8String]`改用。

# html - 简单的 HTML 没有填充其内容的宽度

> ID：13924119
> 
> 赞同：0
> 
> 时间：2012-12-17T23:40:12.643
> 
> 标签：html, css, google-app-engine

我有一个可能很简单的问题，但我对 HTML 开发还很陌生（我知道我在这方面迟到了 20 年），而且我遇到了一个问题。

我有以下代码：

```
<div style="padding:10px; background-color:#b0c4de;">   
  <img src="SOME_IMAGE_URL_HERE">
</div> 
```

现在，my是在运行时通过**Python**（在 Google AppEngine 上）`SOME_IMAGE_URL_HERE`插入的 URL 字符串，并且图像本身的大小可能会有所不同。我希望我用填充围绕图像，有点像在图像周围提供一个框。**`div``10px`**

 **上面的代码`10px`在顶部和底部提供了一个填充，但它`div`延伸到了屏幕的整个宽度。如何将`div`宽度设置为图像的宽度？请记住，图像大小会发生变化。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-17T23:42:45.823

给它一个`display`属性`inline-block`. [这是一个演示。](http://jsfiddle.net/minitech/7mt6h/)

（您也可以`float`将其用于`left`其他一些事情，但`inline-block`最不可能引起其他问题。）**

# c++ - 使用自定义比较功能对静态多维数组进行排序

> ID：13924120
> 
> 赞同：0
> 
> 时间：2012-12-17T23:40:57.103
> 
> 标签：c++, stl, sorting

有排序向量或动态分配数组的示例，但我找不到关于静态数组的任何帮助。假设我有一个数组

```
int array[10][10]; 
```

和比较功能，

```
bool compare(const int (*a)[10], const int (*b)[10]); 
```

当我这样称呼它时，

```
std::sort(array, array + 10, compare); 
```

我有编译错误：`error: cannot convert 'int*' to 'const int (*)[10]' in argument passing`

我尝试了很多方法，将数组转换`(void**)`为排序函数，但随后出现分段错误。我猜我的问题是使用数组作为函数参数，但我不知道如何使用这个 std::sort。否则，我将不得不编写自己的排序函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T01:11:15.360

当`std::sort`在类型元素的容器上调用时`T`，比较函数需要接收类型为`T`or的参数`const T&`。在这种情况下，您有一个二维数组，因此元素的类型是一维数组`int[10]`。由于一维数组衰减为指针，`compare`可以是：

```
bool compare(int a[10], int b[10]); 
```

或等效地：

```
bool compare(int *a, int *b); 
```

这将解决您遇到的错误，但您的代码仍然无法工作：`std::sort`需要容器元素可分配（或在 C++11 中可移动），但数组不可分配。

您可以`std::vector<std::vector<int> >`按照人们的建议使用。请注意，您对性能问题的担心是错误的：即使可以对二维数组进行排序，也需要大量复制一维数组，这将花费很长时间。另一方面，交换向量是通过简单地交换更快的指针来完成的。一般来说，如果您没有先测试过性能，您不应该对性能做出假设。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T00:32:47.233

我说，如果我们要使用 STL 和 C++ .. 让我们以现代风格编写它并真正使用 STL。

我尝试使用现代 c++11 解决这个问题：

```
#include <vector>
#include <iostream>
#include <algorithm>

typedef std::vector<int> ArrayInt;
typedef std::vector< std::vector<int> > ArrayData;

bool compare(const ArrayInt& a, const ArrayInt& b) {
    std::cout << &(a) << ' ' << &(b) << std::endl;
    int sumA = std::accumulate(a.begin(), a.end(), 0);
    int sumB = std::accumulate(b.begin(), b.end(), 0);
    return sumA < sumB;
}

int main(int argc, char** argv) {
    ArrayData array = {
        {1,2,4,0,3,7,6,8,3,3},
        {13,2,4,0,3,7,6,8,3,3},
        {10,2,4,0,3,7,6,8,3,3},
        {1,2,4,0,3,7,6,8,3,3},
        {16,2,4,0,3,7,6,8,3,3},
        {1,2,400,0,3,7,6,8,3,3},
        {1,2,4,0,3,7,6,8,3,3},
        {120,2,4,0,3,7,6,8,3,3},
        {1,2,4,0,3,7,6,8,3,3},
        {1,2,4,0,3,7,6,8,3,3}
    };
    std::sort(array.begin(), array.end(), compare);
    for (auto row : array) {
        for (int num : row)
            std::cout << num << ' ';
        std::cout << std::endl;
    }
} 
```

它使用累积来对每个子数组求和，并对总和进行排序.. 它的效率非常低，因为它必须多次对同一行求和.. 但它只是为了展示自定义比较函数。

* * *

作为练习，我编写了这个版本，它使用异步将求和部分分配到任何可用的内核上，以便在排序之前进行求和。很抱歉，话题有点跑题了。我希望它对某些人仍然有用：

```
#include <vector>
#include <iostream>
#include <algorithm>
#include <future>

typedef std::vector<int> IntRow;
typedef std::pair<int, IntRow> DataRow;
typedef std::vector<DataRow> DataTable;

int main(int argc, char** argv) {
    // Holds the sum of each row, plus the data itself
    DataTable array = {
        {0, {1,2,4,0,3,7,6,8,3,3}},
        {0, {13,2,4,0,3,7,6,8,3,3}},
        {0, {10,2,4,0,3,7,6,8,3,3}},
        {0, {1,2,4,0,3,7,6,8,3,3}},
        {0, {16,2,4,0,3,7,6,8,3,3}},
        {0, {1,2,400,0,3,7,6,8,3,3}},
        {0, {1,2,4,0,3,7,6,8,3,3}},
        {0, {120,2,4,0,3,7,6,8,3,3}},
        {0, {1,2,4,0,3,7,6,8,3,3}},
        {0, {1,2,4,0,3,7,6,8,3,3}}
    };
    // Make use of multiple cores if it's efficient enough
    // get the sum of each data row
    std::vector<std::future<int>> sums(array.size());
    auto next = sums.begin();
    for (auto& row : array)
        *next++ = std::async([](const IntRow& row) { return std::accumulate(row.begin(), row.end(), 0); }, row.second);
    // Get the results
    auto nextRow = array.begin();
    for (auto& sum: sums)
        (*nextRow++).first = sum.get();
    // Sort it 
    std::sort(array.begin(), array.end(),
              [](const DataRow& a, const DataRow& b) { return a.first < b.first; });
    // Print it
    for (auto row : array) {
        for (int num : row.second)
            std::cout << num << ' ';
        std::cout << std::endl;
    }
} 
```

它需要使用 pthread 库或类似库进行编译：

`g++ -O6 sort.cpp --std=c++11 -g -lpthread`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T01:11:55.867

比较函数没有得到传递的元素的迭代器，而是解引用的迭代器，即值类型。因此，您的比较函数需要声明如下：

```
bool compare(int (&a0)[10], int (&a1)[10]); 
```

您可以验证您是否可以使用数组迭代器实际调用它：

```
compare(*(std::begin(array) + 0), *(std::begin(array) + 1)); 
```

但是，这将无法对数组进行排序：内置数组不可复制分配。对静态大小的数组（外部维度灵活）进行排序的最简单方法是使用`std::array<T, N>`：

```
std::array<int, 10> array[10];
std::sort(std::begin(array), std::end(array)); 
```

# sql - Rails / SQL：过去两周内的每一天分组并求和

> ID：13924122
> 
> 赞同：1
> 
> 时间：2012-12-17T23:41:00.313
> 
> 标签：sql, ruby-on-rails, ruby, arrays, group-by

我试图总结过去两周的每一天。

这段代码：

```
Invoice.group('date(filled_at)').sum(:lines_price).to_a 
```

返回：

```
[["2012-12-15", #<BigDecimal:ac40068,'0.19275E4',18(45)>], ["2012-12-17", #<BigDecimal:a759234,'0.764235E3',18(45)>]] 
```

这是正确的，但我需要它返回过去两周的值，即使值是`0.0`.

所以结果应该是：

```
[["2012-12-03", 0.0], ... , ["2012-12-17", #<BigDecimal:a759234,'0.764235E3',18(45)>]] 
```

谢谢你。

**更新**

```
having("date(filled_at) > ?", Date.today - 14) 
```

解决了过去 14 天的问题。但我仍然不知道如何显示`0.0`价值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T06:20:35.807

您将很难在 SQL 中执行此操作，因为您试图强制数据库返回不存在的值。在 ruby​​ 中执行此操作要容易得多。这是一个简洁的方法：

```
summary = Invoice.group('date(filled_at)').sum(:lines_price).to_a
past_two_weeks = ((Date.today - 14).. Date.today)

final_result =Hash[*past_two_weeks.map(&:to_s).product([0.0]).flatten].merge Hash[*summary.flatten]

final_result.to_a 
```

# python - 在python中为unix时间戳添加小时

> ID：13924124
> 
> 赞同：10
> 
> 时间：2012-12-17T23:41:03.243
> 
> 标签：python, python-2.7

我需要将 5 小时添加到某个 unix 时间戳。它就像游戏的开始和停止时间。所以我知道开始时间和比赛的持续时间。我需要输入结束时间。如何在 python 中做到这一点？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-17T23:42:59.990

UNIX 时间戳以秒为单位。

```
end_timestamp = start_timestamp + 5 * 60 * 60 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-17T23:50:37.047

可以是明确的并使用以下内容：

```
>>> from datetime import timedelta, datetime
>>> a = datetime.fromtimestamp(0)
>>> b = a + timedelta(hours=5)
>>> c = time.mktime(b.timetuple())
>>> c
18000.0
>>> datetime.fromtimestamp(c)
datetime.datetime(1970, 1, 1, 6, 0) 
```

# mongodb - 扫描文档数量少的慢 mongodb 查询

> ID：13924125
> 
> 赞同：0
> 
> 时间：2012-12-17T23:41:03.297
> 
> 标签：mongodb

我有一个包含 3 个 MongoDB 实例的副本集。这些实例具有 8GB 的​​ RAM 和双核 2.27 GHz CPU。所有实例都运行 2.2.2 版（我在 2.0.1 中看到了相同的行为）。

这是我的问题：我们的主实例（副本集的主实例）最近养成了每 2 天爬到 100% CPU 的习惯。追查原因，我决定运行 MongoDB 分析器。我发现了数百个非常慢的查询。这是一个例子：

```
> db.system.profile.find()
{ 
    "ts" : ISODate("2012-12-16T20:31:39.078Z"), 
    "op" : "command", 
    "ns" : "stylesaint.$cmd", 
    "command" : { 
        "count" : "tears", 
        "query" : { 
            "_id" : { "$gt" : ObjectId("50cdeadeaf58d3de96000294") }, 
            "active" : true, 
            "is_image_processed" : true, 
            "hidden_from_feed" : false, 
            "hidden_from_public_feeds" : false
        }, 
        "fields" : null 
    }, 
    "ntoreturn" : 1, 
    "responseLength" : 48, 
    "millis" : 13930, 
    "client" : "#########"
} 
```

根据我对 mongodb 的了解，在这些情况下，自然的下一步是尝试对这些查询进行解释（）。但是，explain() 并没有解释查询的缓慢：

```
> db.tears.find({ "_id" : { "$gt" : ObjectId("50cdeadeaf58d3de96000294") }, "active" : true, "is_image_processed" : true, "hidden_from_feed" : false, "hidden_from_public_feeds" : false }).explain()
{
    "cursor" : "BtreeCursor id",
    "isMultiKey" : false,
    "n" : 4,
    "nscannedObjects" : 5,
    "nscanned" : 5,
    "nscannedObjectsAllPlans" : 23,
    "nscannedAllPlans" : 25,
    "scanAndOrder" : false,
    "indexOnly" : false,
    "nYields" : 0,
    "nChunkSkips" : 0,
    "millis" : 0,
    "indexBounds" : { 
        "_id" : [ 
            [ 
                ObjectId("50cdeadeaf58d3de96000294"), 
                ObjectId("ffffffffffffffffffffffff")
            ]
        ]
    },
    "server" : "#########"
} 
```

扫描 5 个文档不应花费 13 秒。正在发生的其他事情正在减慢查询速度。也许其他一些查询正在耗尽服务器的资源？但是，我不知道在哪里看。感谢您提供任何建议。

**MongoDB 日志**

我在启动过程中找不到任何警告：

```
***** SERVER RESTARTED *****

Sun Dec 16 21:02:56 [initandlisten] MongoDB starting : pid=...
Sun Dec 16 21:02:56 [initandlisten] db version v2.2.2, pdfile version 4.5
Sun Dec 16 21:02:56 [initandlisten] git version: ...   
Sun Dec 16 21:02:56 [initandlisten] build info: Linux 2.6.21.7-2 ...
Sun Dec 16 21:02:56 [initandlisten] options: { config: "/etc/mongodb.conf", dbpath: "/data/mongodb", logappend: "true", logpath: "/var/log/mongodb/mongodb.log", replSet: "...", rest: "true" }
Sun Dec 16 21:02:56 [initandlisten] journal dir=/data/mongodb/journal
Sun Dec 16 21:02:56 [initandlisten] recover : no journal files present, no recovery needed
Sun Dec 16 21:02:56 [initandlisten] waiting for connections on port ...
Sun Dec 16 21:02:56 [websvr] admin web console waiting for connections on port ...
Sun Dec 16 21:02:56 [initandlisten] connection accepted from ...
Sun Dec 16 21:02:56 [conn1] end connection ... (0 connections now open)
Sun Dec 16 21:02:56 [initandlisten] connection accepted from ... #2 (1 connection now open)
Sun Dec 16 21:02:56 [rsStart] replSet I am ...
Sun Dec 16 21:02:56 [rsStart] replSet STARTUP2
Sun Dec 16 21:02:56 [rsHealthPoll] replSet member ... is up
Sun Dec 16 21:02:56 [rsHealthPoll] replSet member ... is now in state SECONDARY
Sun Dec 16 21:02:57 [initandlisten] connection accepted from ... #3 (2 connections now open)
Sun Dec 16 21:02:57 [rsSync] replSet SECONDARY
Sun Dec 16 21:02:58 [initandlisten] connection accepted from ... #4 (3 connections now open)
Sun Dec 16 21:02:58 [initandlisten] connection accepted from ... #5 (4 connections now open)
Sun Dec 16 21:02:58 [conn5] end connection ... (3 connections now open)
Sun Dec 16 21:02:58 [rsHealthPoll] replSet member ... is up
Sun Dec 16 21:02:58 [rsHealthPoll] replSet member ... is now in state PRIMARY
Sun Dec 16 21:02:59 [initandlisten] connection accepted from ... #6 (4 connections now open)
Sun Dec 16 21:03:00 [initandlisten] connection accepted from ... #7 (5 connections now open)
Sun Dec 16 21:03:02 [conn7] end connection ... (4 connections now open)
Sun Dec 16 21:03:03 [rsBackgroundSync] replSet syncing to: ...
Sun Dec 16 21:03:04 [rsSyncNotifier] replset setting oplog notifier to ...
Sun Dec 16 21:03:06 [conn2] end connection ... (3 connections now open)
Sun Dec 16 21:03:06 [initandlisten] connection accepted from ... #8 (4 connections now open)
Sun Dec 16 21:03:08 [initandlisten] connection accepted from ... #9 (5 connections now open)
Sun Dec 16 21:03:13 [initandlisten] connection accepted from ... #10 (6 connections now open)
Sun Dec 16 21:03:13 [conn10] end connection ... (5 connections now open)
Sun Dec 16 21:03:13 [initandlisten] connection accepted from ... #11 (6 connections now open)
Sun Dec 16 21:03:15 [conn3] end connection ... (5 connections now open)
Sun Dec 16 21:03:16 [rsHealthPoll] replSet member .... is now in state SECONDARY
Sun Dec 16 21:03:16 [rsMgr] replSet info electSelf 1
Sun Dec 16 21:03:16 [rsMgr] replSet PRIMARY 
```

**回复：请求更多信息**

目前，MongoDB运行正常；没有超过 100 毫秒的查询。一旦 100% CPU 再次发生，我将发布有关系统资源的更多信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T00:33:24.313

首先，我认为这些查询可能是一个红鲱鱼。您是否在 NUMA 架构下运行这些服务器？您可以阅读[Mongo 文档以了解在 NUMA 系统上的用法](http://www.mongodb.org/display/DOCS/NUMA)。

如果您在 NUMA 系统上运行，那么使用 numactl 使用交错策略运行守护程序可能会解决您的问题。

您可以检查是否有任何启动警告。它们会在您启动守护程序时出现在您的日志中，并且您可以在守护程序运行时找到它们，尽管我不记得我是怎么想的。

如果做不到这一点，您可能会在进行这些查询时检查您的 IO 操作。如果我不得不猜测，您正在访问您的磁盘并且没有使用内存中的工作集进行操作。您的内存使用统计信息（free -h 和 mongo 控制台内部的内存使用指标）是什么样的？

# c++ - wxWidgets - 单线程多任务处理

> ID：13924126
> 
> 赞同：1
> 
> 时间：2012-12-17T23:41:05.920
> 
> 标签：c++, multithreading, background, wxwidgets, multitasking

我有一个使用 wxWidgets 创建的 GUI 应用程序。作为功​​能的一部分，我必须在操作 GUI 窗口的同时运行“任务”。例如，我可以运行代码：

```
long currentTime = wxGetLocalTime();
long stopTime = wxGetLocalTime() + 3;
while (wxGetLocalTime() != stopTime) {}
wxMessageBox("DONE IN APP"); 
```

在这 3 秒的持续时间内，我的应用程序基本上会被冻结，直到显示 wxMessageBox。有没有办法在不使用多个线程的情况下在后台运行？它给我正在开发的应用程序带来了问题。

我想知道是否可以使用某些类型的事件处理。非常感谢任何形式的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-18T13:51:53.190

在 GUI wx 应用程序中运行耗时任务有 3 种方法：

1.  到目前为止，最优选的是使用不同的线程。应用程序“非常 GUI 密集型”的解释对我来说真的没有任何意义，我认为如果它的 GUI 强度（无论是什么）阻止您使用后台工作线程，您应该认真重新考虑您的程序设计。如果您确实使用这种方法，它非常简单，但要特别注意线程/程序终止问题。特别是，您需要等待线程完成（如果不需要很长时间运行，则可以接受）或在退出程序之前显式取消它。

2.  `EVT_IDLE`只要没有其他要处理的事件，就使用事件来执行您的任务。这对于可以分解成足够小块的小任务来说并不算太糟糕，因为您需要能够在处理程序中恢复处理。`event.RequestMore()`即使没有发生任何事情，也不要忘记调用以继续获取空闲事件。

3.  最糟糕和最危险的是`wxYield()`按照另一个答案的建议打电话。起初这看起来很简单，但您**稍后会**后悔这样做，因为这会在您的代码中创建极其难以调试的重入问题。如果您确实使用它，您需要自己防止任何地方的重入，并且您应该真正了解此功能的确切作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-17T23:47:27.313

试试这个：

```
long currentTime = wxGetLocalTime();
long stopTime = wxGetLocalTime() + 3;
while (wxGetLocalTime() != stopTime) {
   wxYield();
}
wxMessageBox("DONE IN APP"); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-11-18T14:55:04.047

我知道这对游戏来说已经晚了，但是......

我已经成功地使用了 YEARS 的 EVT_IDLE 方法（最初是在 90 年代使用 Motif）。主要思想是将你的任务分解成小块，每块都调用下一块（想想链表）。执行此操作的机制是使用 CallAfter() 方法（当然是使用 C++）。您只需将“CallAfter()”作为该部分的最后一步，这将允许 GUI 主循环运行另一个迭代，并可能在调用您的下一个部分之前更新 GUI 元素等。只要记住保持碎片小。

使用后台线程真的很好，但可能比你想象的要复杂......最终。只要您知道您在后台处理的数据不会被其他任何东西触及/查看，就可以了。如果你知道是这种情况，那么这就是要走的路。此方法允许 GUI 在后台计算期间保持完全响应（调整窗口大小/移动窗口等）

在任何一种情况下，都不要忘记将适当的 GUI 元素脱敏作为第一步，这样您就不会意外地多次启动相同的后台任务（例如，不小心连续多次单击启动后台线程的按钮） .

# sql - 如何将日期时间转换为 int？

> ID：13924129
> 
> 赞同：0
> 
> 时间：2012-12-17T23:41:12.963
> 
> 标签：sql, sql-server, sql-server-2008, tsql

> **可能重复：**
> [从 DateTime 转换为 INT](https://stackoverflow.com/questions/5505935/convert-from-datetime-to-int)

出于性能原因，我想在我的表中添加一个计算列。

我正在做很多这样的查询：

```
select * from mytable where mydate between @start_date and @end_date 
```

而不是上面的查询，我想这样做：

```
select * from mytable where my_computed_column between number1 and number2 
```

`datetime`转换为的最佳方法是`int`什么？

# iphone - 如果在添加注释时缩放，MKMapView 会崩溃

> ID：13924130
> 
> 赞同：1
> 
> 时间：2012-12-17T23:41:23.087
> 
> 标签：iphone, ios, mkmapview, mapkit

看起来我遇到了一个问题，`MKMapView`如果我在更改地图的可见区域时添加注释，我可以可靠地导致崩溃。我已经将导致它的代码简化为一个非常简单的实现，我在这里复制它：

```
NSMutableArray *pointAnnotationArray = [[NSMutableArray alloc] init];
MKCoordinateRegion coordRegion = [mapViewOutlet region];
float randMax = 0.1;

for (int i = 0; i < 100; i++){
    float randomDeviation1 =  (((float) (arc4random() % ((unsigned)RAND_MAX + 1)) / RAND_MAX) * randMax) - (randMax / 2);
    float randomDeviation2 =  (((float) (arc4random() % ((unsigned)RAND_MAX + 1)) / RAND_MAX) * randMax) - (randMax / 2);

    MKPointAnnotation *point = [[MKPointAnnotation alloc] init];        
    CLLocationCoordinate2D pointLocation = CLLocationCoordinate2DMake(coordRegion.center.latitude + randomDeviation1, coordRegion.center.longitude + randomDeviation2);
    [point setCoordinate:pointLocation];    
    [pointAnnotationArray addObject: point];
}

[mapViewOutlet addAnnotations:[NSArray arrayWithArray:pointAnnotationArray]]; 
```

我在上面所做的是在地图上添加 100 个点，这些点随机（足够）分布在 MKMapView 的可见区域内和周围。重现这一点的最简单方法是将此代码设置为在计时器上运行（例如 5 秒后），然后抓取地图并开始放大和缩小一点，直到计时器运行。一旦你感觉到它，你每次都可能会崩溃。`mapViewOutlet`在通话之前禁用用户交互`addAnnotations`似乎没有帮助。（也许它无法在用户处于中间手势时禁用用户交互，我想这是可以理解的。）

我的另一个问题是我没有太多的运气来追踪崩溃——我没有很多经验导致我自己的代码中没有直接发生的崩溃，所以我可能会错过一些明显的追踪方式它，但我目前`return UIApplicationMain`在`main.m`. 我最好的猜测是，我们在`MKMapView`唯一如何绘制可见注释方面造成了一些问题——缩放导致可见区域发生变化，而注释正在被添加并且地图正在尝试确定要绘制哪些点。

有没有其他人看过这个？关于如何避免它的任何建议，而不会在我的注释添加的任一端将我的地图与用户交互锁定一段相当长的时间？

*编辑：*忘记包含调用堆栈：

```
#0  0x3752a944 in objc_exception_throw ()
#1  0x3869dec0 in __NSFastEnumerationMutationHandler ()
#2  0x31929d46 in -[MKAnnotationContainerView _updateAnnotationViewPerspective] ()
#3  0x3192981a in -[MKMapView _updateScrollContainerView:] ()
#4  0x3192ff66 in -[MKMapView mapViewDidDraw:] ()
#5  0x391560b4 in -[VKMapCanvas didDrawView] ()
#6  0x3914d4a8 in -[VKScreenCanvas onTimerFired:] ()
#7  0x3914b4a8 in -[VKMapCanvas onTimerFired:] ()
#8  0x3914a346 in -[VKMainLoop displayTimerFired:] ()
#9  0x35ebe780 in CA::Display::DisplayLink::dispatch(unsigned long long, unsigned long long) ()
#10 0x35ebe6d8 in CA::Display::IOMFBDisplayLink::callback(__IOMobileFramebuffer*, unsigned long long, unsigned long long, unsigned long long, void*) ()
#11 0x34815fd6 in IOMobileFramebufferVsyncNotifyFunc ()
#12 0x370315ac in IODispatchCalloutFromCFMessage ()
#13 0x3866888a in __CFMachPortPerform ()
#14 0x386733e6 in __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__ ()
#15 0x3867338a in __CFRunLoopDoSource1 ()
#16 0x3867220e in __CFRunLoopRun ()
#17 0x385e523c in CFRunLoopRunSpecific ()
#18 0x385e50c8 in CFRunLoopRunInMode ()
#19 0x3591e33a in GSEventRunModal ()
#20 0x379d5290 in UIApplicationMain ()
#21 0x0005aff4 in main at /Users/Sydin/App/main.m:16 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T00:17:24.887

在添加新注释时，对可见注释的更改看起来像是某种问题 - 可能是 中的问题`MKMapView`，因为它可能在辅助线程中进行更新（就像那样挑剔）。我要做的是响应以下两种`MKMapViewDelegate`方法：

*   `mapView:regionWillChangeAnimated:`
*   `mapView:regionDidChangeAnimated:`

首先，设置一个标志，将地图指定为由用户移动到`YES`。在第二个中，将标志设置为`NO`。然后，每当您想添加新注释时，请检查该标志。如果是`NO`，那么您可以立即更新。如果是`YES`，请将您的注释添加到可变集。在`mapView:regionDidChangeAnimated:`中，在清空集合之前将该集合中的任何注释添加到地图视图。

这应该可以解决问题，即使它不是一个优雅的解决方案。您可以在 Xcode 中打开断点窗格并单击添加按钮，然后选择“异常断点”，这样当您的应用程序崩溃时，您会得到准确的行而不是`main.m`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-22T06:35:26.887

我有一个类似的问题，我正在添加一组从我的服务器获取的注释并将它们从 json 转换为 nsarray 但是因为这是在后台线程中完成的，当添加和删除到 mapview 我有 NSGenericException ，我的解决方案是添加删除操作在像下面这样的主线程上并且一切正常，即使用户放大您也可以添加删除注释。但是添加时会有轻微的延迟，因为我正在尝试像 1k 到 2k 大小的数组。对于较小的东西应该没问题。

```
 dispatch_async(dispatch_get_main_queue(),
 ^{
        [self.mapView removeAnnotations:self.mapView.annotations];
        [self.mapView addAnnotations:tempNSArray];

    }); 
```

# javascript - 如何在 Jade 中创建可重复使用的标记

> ID：13924133
> 
> 赞同：5
> 
> 时间：2012-12-17T23:41:58.467
> 
> 标签：javascript, node.js, view, express, pug

## 我正在努力完成的事情。

我正在尝试做的实际上非常简单，Jade 模板引擎应该能够帮助我很多，但我遇到了一些障碍。

我正在构建一个使用许多半透明元素的站点，例如这个 jsFiddle 中的那个：http: [//jsfiddle.net/Chevex/UfKnM/](http://jsfiddle.net/Chevex/UfKnM/)
为了使容器背景是半透明的，但保持文本不透明这涉及3个要素：

*   一个容器 DIV`position: relative`
*   具有`position: absolute`、背景颜色、高度/宽度设置为 100% 且不透明度设置为所需级别的子 DIV。
*   没有特殊定位的内容的另一个子 DIV。

它非常简单，我在[CodeTunnel.com](http://www.codetunnel.com)上相当有效地使用它。

## 我想如何简化它。

我正在用 node.js 重写 CodeTunnel.com，Jade 模板引擎似乎可以大大简化我一遍又一遍地重复使用的这段标记。Jade mixins 看起来很有希望，所以这就是我所做的：

1.  我定义了一个 mixin，所以我可以在任何需要的地方使用它。

    ```
    mixin container
        .container(id=attributes.id) // attributes is an implicit argument that contains any attributes passed in.
            .translucentFrame
            .contentFrame
                block // block is an implicit argument that contains all content from the block passed into the mixin. 
    ```

2.  使用 mixin，传入一个内容块：

    ```
    +container#myContainer
        h1 Some test content 
    ```

    生成：

    ```
    <div id="myContainer" class="container">
        <div class="translucentFrame"></div>
        <div class="contentFrame">
            <h1>Some test content</h1>
        </div>
    </div> 
    ```

到目前为止，一切都很好！只有一个问题。我想在 layout.jade 模板中使用这个 mixin，并且我希望子模板能够使用块继承。我的 layout.jade 文件如下所示：

```
doctype 5
mixin container
    .container(id=attributes.id)
        .translucentFrame
        .contentFrame
            block
html
    head
        title Container mixin text
    body
        +container#bodyContent
            block bodyContent 
```

然后在另一个玉文件（index.jade）中我扩展了 layout.jade：

```
extends layout

block bodyContent
    h1 Some test Content 
```

一切看起来都井井有条，但玉解析器失败了：

[![](../Images/ab82da3705e0e407cc7602c2d4afa186.png)](https://i.imgur.com/X39Fy.png)

我认为这与`block`关键字冲突有关。在 mixin 内部`block`是一个隐含的参数，其中包含传递给 mixin 的块，但是当扩展一个翡翠模板块时，它是一个关键字，用于标识要在父模板中的等效块中替换的标记块。

如果我`block bodyContent`用任何其他标记替换我传递给 mixin 的那个，那么一切正常。只有当我尝试传入一个块定义时，它才会感到不安。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-18T00:52:53.797

我怀疑，因为[mixins 定义了它们自己的函数](https://github.com/visionmedia/jade#a14)，所以`block bodyContent`被定义在不同的范围内，无法从`index.jade`.

您可以尝试将 mixin 的使用移至继承视图，因为[mixin 是“提升的”](https://github.com/visionmedia/jade/pull/624)：

`layout.jade`：

```
doctype 5

mixin container
    .container(id=attributes.id)
        .translucentFrame
        .contentFrame
            block

html
    head
        title Container mixin text
    body
        block bodyContent 
```

`index.jade`：

```
extends layout

block bodyContent
    +container#myContainer
        h1 Some test content 
```

# ruby - ActiveRecord 迁移：unique => true 被忽略？

> ID：13924135
> 
> 赞同：2
> 
> 时间：2012-12-17T23:42:17.960
> 
> 标签：ruby, activerecord

我正在创建一个表并指定：

```
t.integer   :random_id, :unique => true 
```

它不会向 random_id 添加唯一索引。但如果我这样做：

```
ActiveRecord::Migration.add_index :test, :random_id, :unique => true 
```

然后它工作。第一种方法有什么问题？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T00:05:23.753

我想你已经在你的两个例子中自己解释过了。
t.integer 是列定义，而 add_index 添加索引。
:unique 是一个索引选项，索引与列分开定义：http:
[//api.rubyonrails.org/classes/ActiveRecord/Migration.html](http://api.rubyonrails.org/classes/ActiveRecord/Migration.html)

这使您不仅可以将单个列定义为唯一列，还可以将列组合定义为唯一列。如果您只想要特定范围内的唯一值，这将特别有用，例如在部分中对内容进行排序：

```
add_index(:post_position_within_section, [:position, :sections_id], :unique => true) 
```

从这里稍微修改：http: [//apidock.com/rails/ActiveRecord/ConnectionAdapters/SchemaStatements/add_index](http://apidock.com/rails/ActiveRecord/ConnectionAdapters/SchemaStatements/add_index)

# llvm - 在clang中为-O4做了哪些优化？

> ID：13924136
> 
> 赞同：5
> 
> 时间：2012-12-17T23:42:18.430
> 
> 标签：llvm, clang, llvm-clang

我们正在尝试实现一个 jit 编译器，其性能应该与使用 clang -o4 相同。有没有一个地方我可以很容易地获得指定了 -o4 的 clang 调用的优化通道列表？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-18T00:26:14.857

据我所知，-O4 与 -O3 + 启用 LTO（链接时间优化）的含义相同。请参阅以下代码片段：

*   [工具.cpp](https://github.com/llvm-mirror/clang/blob/master/lib/Driver/Tools.cpp#L2291) `// Manually translate -O to -O2 and -O4 to -O3;`
*   [驱动程序.cpp](https://github.com/llvm-mirror/clang/blob/master/lib/Driver/Driver.cpp#L1175) `// Check for -O4.`

另见[此处](http://llvm.org/docs/GoldPlugin.html)：

> 您可以使用 -emit-llvm 或 -flto 或与 -O3 -flto 同义的 -O4 标志从 clang 生成位码文件。

有关与 -O3 标志一起使用的优化，请参阅此[PassManagerBuilder.cpp](https://github.com/llvm-mirror/llvm/blob/master/lib/Transforms/IPO/PassManagerBuilder.cpp#L118)文件（查找 OptLevel 变量 - 它的值为 3）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-03-10T22:24:15.230

请注意，从 LLVM 5.1 版开始，-O4 不再暗示链接时间优化。如果你想要，你需要通过 -flto。请参阅[Xcode 5 发行说明](https://developer.apple.com/library/mac/releasenotes/DeveloperTools/RN-Xcode/xc5_release_notes/xc5_release_notes.html#//apple_ref/doc/uid/TP40001051-CH2-SW12)。

# objective-c - 存储从 Core Data (iOS) 获取的数据的首选方法

> ID：13924143
> 
> 赞同：0
> 
> 时间：2012-12-17T23:42:57.790
> 
> 标签：objective-c, ios, core-data, nsmanagedobject

假设我正在构建一个显示联系人 UITableView 的应用程序。用户的联系人存储在远程服务器上。我从服务器获取用户的联系人并将它们存储在 Core Data 中。

我的 UITableViewController 加载并从 Core Data 中获取一组 NSManagedObject 子类（名为 ContactVO）。我使用这个 ContactVO 数组来填充我的 UITableView。然后我向服务器发出请求，以提取用户的最新联系人列表。当我收到来自服务器的响应时，我会从我的 Core Data 存储中删除所有联系人，然后插入从服务器数据创建的联系人。此时，我通知我的 UITableViewController 数据已更改，并通过委托方法将新联系人传递给它。

**问题：**一旦我从 Core Data 中删除联系人，对存储在 UITableViewController 中的 ContactVO 的引用就是垃圾。

这里的想法是让表格视图始终允许用户交互，但始终显示可用的最新联系人。

**我尝试过的事情：**

*   创建一个与 ContactVO 具有所有相同属性的类（Contact），并使用从 Core Data 获取的数据填充此类的实例，然后将 Contact 对象数组返回到我的 UITableViewController

*   为获取的每个 ContactVO 创建一个 NSDictionary 并将一个字典数组返回到我的 UITableViewController

必须有比这两种方法更好的方法。存储 fetch 请求结果的首选方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-17T23:50:38.773

你应该阅读[NSFetchedResultsController](http://developer.apple.com/library/ios/#documentation/CoreData/Reference/NSFetchedResultsController_Class/Reference/Reference.html)和它的[delegate](http://developer.apple.com/library/ios/#documentation/CoreData/Reference/NSFetchedResultsControllerDelegate_Protocol/Reference/Reference.html)。它可以帮助您在模型发生更改（删除、添加、修改对象）时刷新表中显示的数据。你也可以在 Xcode 中找到一个示例项目，我相信它叫做 Core Recipes。

希望这可以帮助！

# python - GAE 用户服务对象 - 是否创建局部变量？

> ID：13924145
> 
> 赞同：0
> 
> 时间：2012-12-17T23:43:17.010
> 
> 标签：python, performance, google-app-engine, optimization

所以...使用 Google App Engine 用户服务。

我应该创建一个**本地**用户对象：

```
my_user = users.get_current_user()
if not my_user:
    self.redirect(users.create_login_url(self.request.uri), abort=True)
    return
person = Person.get_current(my_user.user_id()) #Here 
```

或随时从用户服务访问用户对象？：

```
my_user = users.get_current_user()
if not my_user:
    self.redirect(users.create_login_url(self.request.uri), abort=True)
    return
#...  code ...
person = Person.get_current(users.get_current_user().user_id()) #And here 
```

或者是其他东西？：

```
helping useres :-) 
```

当然，为什么。使用用户服务的资源成本高吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:58:41.313

对于每个请求，本地范围的用户对象应该没问题。

确保 my_user 对于您的线程和当前请求是本地的：

*   如果它在不同的请求之间共享，则不能保证它确实是同一用户发出请求，除非您有一些单独的会话验证。

*   不同的线程可以处理不同的请求，在这种情况下你会遇到上述问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T16:25:25.793

本地调用总是比触发许多方法调用的调用更好。效率增益取决于您的代码调用它的频率。打2个电话没问题。

# c++ - Cygwin 编译器：未定义的参考

> ID：13924146
> 
> 赞同：0
> 
> 时间：2012-12-17T23:43:25.517
> 
> 标签：c++, cygwin

当我尝试在 Code:Blocks 中编译一个随机项目时，Cygwin 编译器会抛出一个关于自己的库文件的未定义引用错误：

```
/usr/lib/gcc/i686-pc-cygwin/3.4.4/../../../libcygwin.a(_cygwin_crt0_common.o):_cygwin_crt0_common.cc:(.data+0x0):
undefined reference to `___real__Znwj'
/usr/lib/gcc/i686-pc-cygwin/3.4.4/../../../libcygwin.a(_cygwin_crt0_common.o):_cygwin_crt0_common.cc:(.data+0x8):
undefined reference to `___real__ZdlPv' 
```

我正在链接 netlink 库以及 WS2_32.lib

那是编译器问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T09:33:54.697

其他提示，它来自`_cygwin_crt0_common.cc`. 因此，显然缺少核心的东西。您使用的是 Cygwin 版本的 gcc，对吗？你试过了`-lcygwin`吗？你也可以试试`-mno-cygwin`。

我的建议通常是使用 vanilla MinGW，创建干净的 Windows 二进制文件（失去 POSIX 功能）..

# python - Photobucket API python oAuth错误

> ID：13924147
> 
> 赞同：1
> 
> 时间：2012-12-17T23:43:28.990
> 
> 标签：python, oauth, photobucket

我需要使用 Python 的 API 包装器将图像上传到 Photobucket。我可以得到 request_token 和 request_token_secret，但不能得到最终的 access_token 和 access_token_secret。相反，我收到以下错误消息：

pbapi.error.PbApiError: (): Token 和 Token Secret 没有响应

我得到的响应如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<response>
    <status>Exception</status>
    <message>Authentication failed no token</message>
    <code>7</code>
    <format>xml</format>
    <method>POST</method>
    <timestamp>1355787388</timestamp>
</response>
<!-- phx1api05 @ Mon, 17 Dec 2012 16:36:28 -0700 --> 
```

这是我的代码：

```
api = pbapi.PbApi(API_KEY, API_SECRET)
api.pb_request.connection.cache = None

# Getting request token
api.reset().login().request().post().load_token_from_response()

# Requesting user permission (you have to login with your account)
webbrowser.open_new_tab(api.login_url)
raw_input("Press Enter when you finished access permission. ")

#Getting oAuth token
#api.reset().login().access().post().load_token_from_response()
print api.reset().login().access().post().response_string 
```

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T22:49:37.193

Photobucket 是一个极其困难的提供者，因为它们重定向端点的方式。但是我有点惊讶他们自己的包装不起作用。我会推荐[rauth](https://github.com/litl/rauth)，但它不会开箱即用：您必须将签名对象子类化，该对象手动重载要签名的 URL，即将其设置为`'api.photobucket.com'`然后将您的自定义签名对象传递给会话构造函数。这是可行的，但有点混乱。我在工作中为一个项目工作，但我现在没有可以为您提供的示例。

# jquery - jquery slideDown/slideUp 将所有单选按钮值视为相同

> ID：13924148
> 
> 赞同：1
> 
> 时间：2012-12-17T23:43:37.743
> 
> 标签：jquery

我已经使用了几次，通常效果很好。然而，在我最近的使用中，隐藏的 div 会很好地向下滑动，但不会重新向上。单击“是”单选按钮时应该向下滑动，单击“否”时应该向后滑动。这时候无论点击单选按钮它都会向下滑动，不会向上滑动。我认为它总是看到一个“是”的价值..

这是html：

```
 <div id="AliasSectionTop">
        Have you ever been known by another name (maiden name, name change, etc)?
        <input type="radio" value="Yes" name="aliasName" />Yes
        <input type="radio" value="No" name="aliasName" />No
    </div>

    <div id="AliasSectionBottom" class="hidden">

        @for (var i = 0; i < 5; i++)
        {
            <div class="formGroup">
                <div class="editor-label">
                    @Html.Label("First Name")
                </div>
                <div class="editor-field">
                    @Html.TextBoxFor(model => model.PersonAliasModel[i].FirstNameAlias)
                </div>
            </div>

            <div class="formGroup">
                <div class="editor-label">
                    @Html.Label("Last Name")
                </div>
                <div class="editor-field">
                    @Html.TextBoxFor(model => model.PersonAliasModel[i].LastNameAlias)
                </div>
            </div>
        }

    </div> 
```

这是jQuery：

```
 // SHow full form once the waiver checkboix is checked.
    $(document).ready(function () {
        $("input[name=aliasName]").click(function () {
            if ($("input[name=aliasName]").val() == "Yes") {
                $("#AliasSectionBottom").slideDown(800);
            } else {
                $("#AliasSectionBottom").slideUp("fast");
            }
        });
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T23:47:52.830

问题在这里：

```
if ($("input[name=aliasName]").val() == "Yes") 
```

集合中有 2 个元素`$("input[name='aliasName']")`。jQuery 只能返回一个值，因此它将始终是集合中的第一个值，因此您的`if`值始终为 true。

您可以使用选择器过滤选择`:checked`器：

```
if ($("input[name='aliasName']:checked").val() == "Yes") 
```

# mysql - 混合 LEFT JOIN 结果 MySQL Doctrine

> ID：13924149
> 
> 赞同：0
> 
> 时间：2012-12-17T23:43:46.330
> 
> 标签：mysql, symfony, doctrine, left-join

我有一个基于学说的应用程序，我想从两个单独的表中选择行并按创​​建日期对它们进行排序。我现在（有点）以这种方式完成它：

```
$query = $em->createQueryBuilder()
  ->from('Embed', 'e')
  ->select("e")
  ->leftJoin("User", "u", "WITH", "e.uid=u.id")
  ->leftJoin("Product", "p", "WITH", "e.pid=p.id")
  ->where("u.image > 0 OR p.image > 0")
  ->addOrderBy("u.timeCreated + p.timeCreated", "DESC")
  ->setMaxResults(28)
  ->getQuery(); 
```

我想混合产品和用户数据，按创建日期排序，但排序不正确。我还尝试使用两个 addOrderBy 语句，它们正确地对用户和产品进行排序，但将所有用户放在结果中的首位，而不是混合它们。

编辑：Rufo 爵士采用了正确的方法 - 这是工作代码：

```
$query = $em->createQueryBuilder()
  ->from('Embed', 'e')
  ->select("e")
  ->leftJoin("User", "u", "WITH", "e.uid=u.id")
  ->leftJoin("Product", "p", "WITH", "e.pid=p.id")
  ->addSelect('COALESCE( u.timeCreated, p.timeCreated ) as timeCreated')
  ->where("u.image > 0 OR p.image > 0")
  ->orderBy("timeCreated", "DESC")
  ->setMaxResults(28)
  ->getQuery(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-17T23:58:40.403

你应该试试这个

```
$query = $em->createQueryBuilder()
  ->from('Embed', 'e')
  ->select("e")
  ->leftJoin("User", "u", "WITH", "e.uid=u.id")
  ->leftJoin("Product", "p", "WITH", "e.pid=p.id")
  ->where("u.image > 0 OR p.image > 0")
  ->addOrderBy("COALESCE( u.timeCreated, p.timeCreated )", "DESC")
  ->setMaxResults(28)
  ->getQuery(); 
```

# git - 从现有存储库中的指定提交开始创建新的 git 存储库

> ID：13924153
> 
> 赞同：2
> 
> 时间：2012-12-17T23:44:06.900
> 
> 标签：git, repository

我最近通过替换具有冲突许可协议的代码部分，将商业许可代码转换为 BSD 许可。我在一个私有的 bitbucket git 存储库中完成了所有这些工作。现在我准备在 github 公共 git 存储库中向公众发布它。所以，我需要通过忘记早期的存储库历史（包含专有代码）来创建新的存储库。换句话说，我有

```
M1 - M2 - ... - Mgood - Mgood+1 - ... - Mtip
                                   \ B1 - B2 - ... - Btip 
```

我在新回购中想要的是：

```
Mgood - Mgood+1 - ... - Mtip                   
                   \ B1 - B2 - ... - Btip 
```

完全忘记了 Mgood 之前的存储库历史记录（评论、更改等）。作为 git 的新手，这听起来很容易，但我还没有找到最干净的方法来做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T00:53:54.220

你可以使用`git rebase -i`

您只需要将 olds 提交压缩为一个：

```
s M1
s M2
p Mgood+1
p Mtip 
```

所以在这里你标记`M1`并`M2`成为壁球（`s`标志）并保留所有其他提交（`c`标志）

但如果你有相当大的历史，这可能是很多手工工作。

# php - If 语句：如果 MYSQL 值 = Null？

> ID：13924159
> 
> 赞同：-1
> 
> 时间：2012-12-17T23:44:26.140
> 
> 标签：php, mysql, if-statement

嗨，我有一个查询可以提取用户照片。

有一个功能，如果用户已登录，他们可以查看大照片，另一个功能是如果用户已注销，他们无法查看大照片。

我现在正在尝试添加另一个函数来表示：如果用户没有任何照片并且它们在表 'ptb_photos' 中没有条目，则回显图像模板。

目前使用 'if($photos == null)' 我正在让用户显示照片图像，但空白模板图像也显示在多行中，这些空白模板应该只显示在那些没有照片的用户身上.

有人可以让我知道我要去哪里错了吗？

```
<?php
$get_photos_set = get_photos();
while ($photos = mysql_fetch_array($get_photos_set)) {
    if (logged_in()) {
        echo "<li><a href=\"data/photos/{$photos['user_id']}/{$photos['file_name']}\" rel=\"prettyPhoto[pp_gal]\"><img src=\"data/photos/{$photos['user_id']}/thumb_{$photos['file_name']}\" alt=\"{$profile[2]}'s Photos\"  /></a></li>";
    }

    if (!logged_in()) {
        echo "<li><a href=\"login.php\"><img src=\"data/photos/{$photos['user_id']}/thumb_{$photos['file_name']}\" alt=\"{$profile[2]}'s Photos\"  /></a></li>";
    }

    if($photos = null) {
        echo "<li><a href=\"login.php\"><img src=\"assets/img/icons/usertemplate.png\" /></a></li>";
        echo "<li><a href=\"login.php\"><img src=\"assets/img/icons/usertemplate.png\" /></a></li>";
        echo "<li><a href=\"login.php\"><img src=\"assets/img/icons/usertemplate.png\" /></a></li>";
        echo "<li><a href=\"login.php\"><img src=\"assets/img/icons/usertemplate.png\" /></a></li>";
        echo "<li><a href=\"login.php\"><img src=\"assets/img/icons/usertemplate.png\" /></a></li>";
        echo "<li><a href=\"login.php\"><img src=\"assets/img/icons/usertemplate.png\" /></a></li>";
        echo "<li><a href=\"login.php\"><img src=\"assets/img/icons/usertemplate.png\" /></a></li>";
        echo "<li><a href=\"login.php\"><img src=\"assets/img/icons/usertemplate.png\" /></a></li>";
    }
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T23:46:32.243

改变

```
if($photos = null) 
```

至

```
 if($photos == null) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T23:54:27.497

代替

```
if($photos = null) 
```

你可能想试试

```
if(mysql_num_rows($get_photo_set) == 0) {
...
} 
```

# c# - 如何在 MVC Razor 中上传和显示图像？

> ID：13924162
> 
> 赞同：1
> 
> 时间：2012-12-17T23:44:44.310
> 
> 标签：c#, asp.net-mvc, razor

我正在尝试编写简单的 MVC Razor 应用程序，它将图像从文件加载到视图模型中并显示它。我找不到简单的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T23:56:12.273

为什么要将其加载到视图模型中？只需链接到它。

如果使用剃刀 1

```
<img src="@Html.Content("~/Content/images/myimage.jpg")" /> 
```

如果使用 Razor 2

```
<img src="~/images/myimage.jpg" /> 
```

如果这不是你想要的，那么你需要更清楚你到底想要做什么。

# css - 水平菜单/列表对齐问题

> ID：13924164
> 
> 赞同：0
> 
> 时间：2012-12-17T23:44:50.447
> 
> 标签：css, list, menu, alignment, styling

这是我在 stackoverflow 上的第一篇文章，但我一直在使用你们的知识，所以谢谢！

我遇到了菜单对齐问题。我有一个 wordpress 菜单，我在 li 元素中添加了 div，这样我就可以为每个菜单设置一个第一个/中间/最后一个组件。这样我就可以提升当前菜单状态，第一个和最后一个项目是“endcaps”。很难解释，你可以在这里看到：[http ://clarksvillevet.com/new/](http://clarksvillevet.com/new/)

注意当前菜单项的中间是如何“下沉”的？我无法弄清楚我在这里缺少什么。我认为这是行高，但这只会移动一点。我猜有些东西在css上重叠（如果你知道我的意思，有点叫它两次），但同样，不知道。这是生成的 HTML：

```
<div id="main-menu">
<ul id="menu-main-menu" class="menu">
<li id="menu-item-8" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8">
<li id="menu-item-23" class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-9 current_page_item menu-item-23">
<div class="first"></div>
<div class="middle">
<a href="http://clarksvillevet.com/new/about-southside-va-veterinary-hospital/" title="About Southside Virginia’s Best Veterinary Hospital">About</a>
</div>
<div class="last"></div>
</li>
<li id="menu-item-20" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-20">
<li id="menu-item-50" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50">
<li id="menu-item-56" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-56">
<li id="menu-item-62" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-62">
</ul>
</div> 
```

和 CSS

```
#main-menu{
width: 598px;
height: 51px;
margin: -6px 0px 0px;
z-index:401;
float: left;
background:url('images/BG-Menu.png') no-repeat top left transparent;
}

.menu {
list-style-type:none;
list-style-position:outside;
list-style-image:none;
position:relative;
z-index:300;
width: 598px;
height: 51px;
float: left;
line-height: 57px;
}

.menu ul{
position:absolute;
line-height: 57px;
overflow:hidden;
margin:0px;
padding:0px;
top: 51px;
left:0px;
display: none;
list-style-position:outside;
}

.menu a {
display:block;
display:inline-block;
padding:0px;
text-decoration:none;
letter-spacing: 1px;
font-size: 13px;
color: #dddddd;
margin: 0px;
}

.menu .first, .menu .middle, .menu .last {
position: relative;
padding:0px;
display: inline-block
}

.menu .first, .menu .last{
width: 11px;
height: 51px;
margin: 0px;
padding: 0px;
}

.menu .middle {
height:51px;
margin: 0px;
padding: 0px;
}

.menu a:hover {
color:#ffffff;
background-color:transparent;
}

.menu li {
float:left;
position:relative;
}

.menu ul a:hover {
color:#ffffff;
}

.menu li ul a {
width: 250px;
height: 32px;
float:left;
line-height: 30px;
background: url('images/BG-Drop-Menu.png') no-repeat top left transparent;
padding: 0px 0px 0px 20px;
color: #ffffff;
}

.menu li ul a:hover{
background: url('images/BG-Drop-Menu-Hover.png') no-repeat top left transparent;
}

.menu li ul ul {
left:0em;
margin:0px 0 0 10px;
}

.menu li:hover ul ul, .menu li:hover ul ul ul, .menu li:hover ul ul ul ul {
display:none;
}

.menu li:hover ul, .menu li li:hover ul, .menu li li li:hover ul, .menu li li li li:hover ul{
display:block;
}

.current-menu-item .first{
background:url('images/BG-Menu-Current-A.png') no-repeat top left transparent;
}

.current-menu-item .middle{
background:url('images/BG-Menu-Current-B.png') repeat-x top left transparent;
}

.current-menu-item .last{
background:url('images/BG-Menu-Current-C.png') no-repeat top left transparent;
}

.current-menu-item{
line-height: 51px;
} 
```

还有一个下拉菜单，所以当您看到 .menu ul display:none 时，这就是它的用途...随时纠正您可能看到的任何疯狂！谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T00:19:02.233

所有的孩子`divs`都是内联块。发生这种情况时，如果 line-height 包含文本，则将应用它。要解决这个问题，您需要`divs`像下面那样浮动。

```
.menu ul > div { float: left } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T00:22:58.653

如果将 .first 和 .middle 都向左浮动（float: left;），这将解决当前的问题。

但我觉得你的菜单切割不仅仅是这个问题。这里有几件事要看：

*   你有一个 .first .middle 和 .last。为什么不只是有一个 .first 和 .last，而您的 .last 有一个 .middle 和 .last 组合的背景图像？容纳您的其他菜单项需要更长的时间，但这意味着只加载了 2 张图像。

*   尽量避免空 div，尤其是在您的菜单中。这是可访问性和 SEO 的重要部分。您应该花时间（可能）比网站的任何其他部分更多地改进该部分的标记。

*   不要使用行高（尝试跨浏览器时可能会感到困惑），而是尝试填充和边距。

# javascript - 附加 div，嵌套还是在下面？

> ID：13924165
> 
> 赞同：0
> 
> 时间：2012-12-17T23:44:53.660
> 
> 标签：javascript

我正在阅读一本关于将 div 附加到其他 div 的 JavaScript 书籍，我只是想了解它的实际外观。ie 是包含在它附加到的那个 div 中的附加 div，或者它只是添加到它下面。无论如何，为了解决这个问题，我创建了这个不起作用的小提琴[http://jsfiddle.net/mjmitche/S4e4r/](http://jsfiddle.net/mjmitche/S4e4r/)，我尝试将一个 div 附加到另一个已经存在的 div 上。你能解释一下为什么我不能在 id 'dad' 后面加上 class 'son' 吗？

JavaScript

```
var element = document.createElement('div');
element.className = 'son';
var dad = getElementById('dad');
dad.appendChild(tit); 
```

html

```
<div id="dad">

</div> 
```

css

```
.son{

    background-color: red;
    width: 100px;
    height: 100px;

}

#dad{

    width: 100px;
    height: 100px;
    background-color: green;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T23:46:20.277

方法`getElementById()`存在于`document`对象中：

```
var dad = document.getElementById("dad");
dad.appendChild(element);  // use 'element' instead of undefined 'tit` 
```

​演示 **：http:** [//jsfiddle.net/S4e4r/1/](http://jsfiddle.net/S4e4r/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-17T23:47:15.300

是什么`tit`？您正在尝试使用尚未初始化的变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-17T23:47:41.020

`getElementById`是 的一个方法`document`，所以需要通过它来访问：

```
var dad = document.getElementById("dad") 
```

# xslt-1.0 - 可以使用模板参数设置禁用输出转义吗？

> ID：13924168
> 
> 赞同：3
> 
> 时间：2012-12-17T23:45:20.773
> 
> 标签：xslt-1.0

为什么以下在 XSLT1.0 中不起作用？

```
<xsl:template name="GenerateSummaryOld">
  <xsl:param name="Content" />
  <xsl:param name="Length" />
  <xsl:param name="DisableOutputEscaping" />

  <xsl:value-of select="substring($Content, 1, $Length)" disable-output-escaping="$DisableOutputEscaping" />
  <xsl:if test="string-length($Content) &gt; $Length"><i>...text has been shortened</i></xsl:if>
</xsl:template> 
```

我在调用模板时使用以下内容：

```
<xsl:with-param name="DisableOutputEscaping">no</xsl:with-param> 
```

我正在 SharePoint 内容查询 WebPart 中尝试此操作，但出现 Web 部件错误。如果我在模板中将禁用输出转义硬编码为“是”或“否”，则不会出现错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T02:16:25.957

**简短的回答：**`disable-output-escaping`必须在 XSLT 样式表中按字面意思指定 的值；它不能在样式表执行时计算。

也就是说，您所观察到的行为是语言定义所规定的行为。

**更长的答案：** XSLT [1.0 规范](http://www.w3.org/TR/xslt#dt-attribute-value-template)显示了这样的语法`xsl:value-of`（或多或少）：

```
  <!-- 分类：指令 -->
  <xsl:value-of
       选择 =*字符串表达式*
       禁用输出转义=“是”| “没有” />

```

注意这里的“string-expression”是斜体的；这意味着该`select`属性的值不是字符串“ `string-expression`”，而是任何可以评估并强制转换为字符串的 XPath 表达式。但是其中的“是”和“否”`disable-output-escaping`没有斜体，没有描述为表达式，也没有描述为属性值模板。“是”或“否”值必须按字面意思给出。

最接近规范明确说明（我能找到）的是第 7.6.2 节中关于属性值模板的注释：

> **注意：**并非所有属性都被解释为属性值模板。值为表达式或模式的属性、顶级元素的属性和引用命名 XSLT 对象的属性不会被解释为属性值模板。...

这是 XSLT 中的许多早期绑定约束之一，旨在确保样式表可以被编译而不仅仅是解释。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T04:53:36.137

CM Sperberg-McQueen 在很好的回答中提供了解释。

这是一种解决方法：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:variable name="vAmp">&amp;</xsl:variable>
 <xsl:variable name="vYesNo" select="'yes'"/>

 <xsl:template match="/">
   <xsl:choose>
    <xsl:when test="$vYesNo = 'yes'">
      <xsl:value-of select="$vAmp" disable-output-escaping="yes"/>
    </xsl:when>
    <xsl:when test="$vYesNo = 'no'">
      <xsl:value-of select="$vAmp" disable-output-escaping="no"/>
    </xsl:when>
   </xsl:choose>
 </xsl:template>
</xsl:stylesheet> 
```

**当将此转换应用于任何 XML 文档（未使用）时，结果是：**

```
& 
```

**如果我们更换**：

```
 <xsl:variable name="vYesNo" select="'yes'"/> 
```

**与**：

```
 <xsl:variable name="vYesNo" select="'no'"/> 
```

**现在修改后的转换结果是**：

```
&amp; 
```

# c# - 如何区分两个列表并获得净变化

> ID：13924169
> 
> 赞同：2
> 
> 时间：2012-12-17T23:45:22.197
> 
> 标签：c#, algorithm, list

我有一个对象和两个列表，如下所示：

```
 public class MyObject
    {
        public int Key;
        public DateTime Day;
        public decimal Value;
    }        

    List<MyObject> listA = new List<MyObject>()
    {
        new MyObject() { Key = 1, Day = new DateTime(2012, 12, 17), Value = 8 },
        new MyObject() { Key = 1, Day = new DateTime(2012, 12, 18), Value = 8 },
        new MyObject() { Key = 2, Day = new DateTime(2012, 12, 17), Value = 8 },
        new MyObject() { Key = 3, Day = new DateTime(2012, 12, 17), Value = 4 },
        new MyObject() { Key = 4, Day = new DateTime(2012, 12, 17), Value = 4 }
    };

    List<MyObject> listB = new List<MyObject>()
    {
        new MyObject() { Key = 1, Day = new DateTime(2012, 12, 17), Value = 2 },
        new MyObject() { Key = 1, Day = new DateTime(2012, 12, 18), Value = 8 },
        new MyObject() { Key = 3, Day = new DateTime(2012, 12, 17), Value = 8 },
        new MyObject() { Key = 4, Day = new DateTime(2012, 12, 17), Value = 4 },
        new MyObject() { Key = 5, Day = new DateTime(2012, 12, 17), Value = 10 }
    }; 
```

我正在寻找的结果是：

```
 List<MyObject> listChanges = new List<MyObject>()
    {
        new MyObject() { Key = 1, Day = new DateTime(2012, 12, 17), Value = -6 },
        new MyObject() { Key = 2, Day = new DateTime(2012, 12, 17), Value = -8 },
        new MyObject() { Key = 3, Day = new DateTime(2012, 12, 17), Value = 4 },
        new MyObject() { Key = 5, Day = new DateTime(2012, 12, 17), Value = 10 }
    }; 
```

本质上，我正在尝试创建一个列表，其中包含将 listA 变为 listB 所需的更改。因此，虽然可以使用 LINQ 中的 except 和 Intersect，但我认为它们不会有最好的性能来完成这样的任务，因为您仍然需要另一个比较来获得值的差异。

我的一个想法是：如果我遍历 listA，我可以从 listA 和 listB 中删除该项目（如果找到它，此时我可以确定 +/- 差异）。一旦我完成了 listA，listB 将只包含添加。

**如何获得更改结果？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T16:54:55.013

首先，我将实现一个`IEqualityComparer<T>`基于`Key`和`Day`属性检查相等性的方法。然后你可以使用 linq 如下：

```
var notInA = listB.Except(listA, myEqualityComparer);
var notInB = listA.Except(listB, myEqualityComparer)
                   .Select(o => {
                      return new MyObject {
                         Key = item.Key,
                         Day = item.Day,
                         Value = item.Value * -1
                      };
                   });
var listA2 = listA.Intersect(listB, myEqualityComparer)
                  .OrderBy(o => o.Key)
                  .ThenBy(o => o.Day);
var listB2 = listB.Intersect(listA, myEqualityComparer)
                  .OrderBy(o => o.Key)
                  .ThenBy(o => o.Day);
var diff = listA2.Zip(listB2, (first,second) => {
   return new MyObject {
     Key = first.Key,
     Day = first.Day,
     Value = second.Value - first.Value
});
diff = diff.Concat(notInA).Concat(notInB); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T16:55:21.503

这应该这样做。`Key`如果您的任何/`Day`组合在您的任何一个输入中都不是唯一的，它将引发异常。

```
public static IEnumerable<MyObject> GetChanges(
    IEnumerable<MyObject> from, IEnumerable<MyObject> to)
{
    var dict = to.ToDictionary(mo => new { mo.Key, mo.Day });

    // Check that keys are distinct in from, too:
    var throwaway = from.ToDictionary(mo => new { mo.Key, mo.Day });

    // Adjustments of items found in "from"
    foreach (MyObject mo in from)
    {
        var key = new { mo.Key, mo.Day };
        MyObject newVal;
        if (dict.TryGetValue(key, out newVal))
        {
            // Return item indicating adjustment
            yield return new MyObject { 
                Key = mo.Key, Day = mo.Day, Value = newVal.Value - mo.Value };
            dict.Remove(key);
        }
        else
        {
            // Return item indicating removal
            yield return new MyObject {
                Key = mo.Key, Day = mo.Day, Value = -mo.Value };
        }
    }

    // Creation of new items found in "to"
    foreach (MyObject mo in dict.Values)
    {
        // Return item indicating addition
        // (Clone as all our other yields are new objects)
        yield return new MyObject {
            Key = mo.Key, Day = mo.Day, Value = mo.Value };
    }
} 
```

您*可以*`from`通过删除唯一性检查或即时执行（尝试将每个项目的关键部分添加到 a ）来加快这一速度`HashSet`，但我认为您不能避免循环`to`两次的一部分 - 一次构建字典，一次返回余数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T16:38:40.267

这个怎么样 ：

```
 List<MyObject> listA = new List<MyObject>(){
            new MyObject() { Key = 1, Day = new DateTime(2012, 12, 17), Value = 8 },
            new MyObject() { Key = 2, Day = new DateTime(2012, 12, 17), Value = 8 },
            new MyObject() { Key = 1, Day = new DateTime(2012, 12, 18), Value = 8 },
            new MyObject() { Key = 4, Day = new DateTime(2012, 12, 17), Value = 4 },
            new MyObject() { Key = 3, Day = new DateTime(2012, 12, 17), Value = 4 }
        };

        List<MyObject> listB = new List<MyObject>(){
            new MyObject() { Key = 1, Day = new DateTime(2012, 12, 17), Value = 2 },
            new MyObject() { Key = 3, Day = new DateTime(2012, 12, 17), Value = 8 },
            new MyObject() { Key = 4, Day = new DateTime(2012, 12, 17), Value = 4 },
            new MyObject() { Key = 1, Day = new DateTime(2012, 12, 18), Value = 8 },
            new MyObject() { Key = 5, Day = new DateTime(2012, 12, 17), Value = 10 }
        };
        List<MyObject> listChanges = Comparer(listA, listB);
        MyObject[] hasil = listChanges.ToArray();
        for (int a = 0; a < hasil.Length;a++ ) {
            Console.WriteLine(hasil[a].Key+" "+hasil[a].Day+" "+hasil[a].Value);
        } 
```

和功能：

```
 private MyObject[] sort(List<MyObject> input) {
        //sort input with it's key
        MyObject[] gg = input.ToArray();
        for (int a = 0; a < input.Count; a++) {
            for (int b = a + 1; b < input.Count; b++) {
                if (gg[a].Key > gg[b].Key) {
                    MyObject temp = gg[a];
                    gg[a] = gg[b];
                    gg[b] = temp;
                }
            }
        }
        //sort input, if key is same => sort the date
        for (int a = 0; a < input.Count; a++) {
            int indStart = a;
            int indEnd = a;
            for (int b = a + 1; b < input.Count; b++) {
                if (gg[a].Key == gg[b].Key) {
                    indEnd++;
                } else {
                    b = input.Count;
                }
            }
            a = indEnd;
            for (int c = indStart; c <= indEnd; c++) {
                for (int d = c + 1; d <= indEnd; d++) {
                    if (gg[c].Day > gg[d].Day) {
                        MyObject temp = gg[c];
                        gg[c] = gg[d];
                        gg[d] = temp;
                    }
                }
            }
        }
        return gg;
    }
    private List<MyObject> Comparer(List<MyObject> listA, List<MyObject> listB) {
        List<MyObject> output = new List<MyObject>();
        //if you sure that the list was sorted, u just remove the sort function
        MyObject[] ff = sort(listA);
        MyObject[] gg = sort(listB);
        Boolean[] masuk = new Boolean[gg.Length];
        //foreach element in listA, search the changes in input
        for (int a = 0; a < listA.Count;a++ ) {
            //find element in input which contains the changes of element in listA
            Boolean ins = false;
            for (int b = 0; b < listB.Count;b++ ) {
                if (masuk[b])
                    continue;
                if (ff[a].Key >= gg[b].Key) {
                    if (ff[a].Key == gg[b].Key && ff[a].Day == gg[b].Day){
                        masuk[b] = true;
                        if (gg[b].Value != ff[a].Value) {
                            output.Add(new MyObject() { Key = gg[b].Key, Day = gg[b].Day, Value = gg[b].Value - ff[a].Value });
                            b = listB.Count;
                        }
                        ins = true;
                    }
                } else {
                    b = listB.Count;
                }
            }
            if (!ins) {
                output.Add(new MyObject() { Key = ff[a].Key, Day = ff[a].Day, Value = -ff[a].Value });
            }
        }
        for (int a = 0; a < gg.Length;a++ ) {
            if(!masuk[a]){
                output.Add(new MyObject() { Key = gg[a].Key, Day = gg[a].Day, Value = gg[a].Value });
            }
        }
        return output;
    } 
```

和输出：

```
 1 12/17/2012 12:00:00 AM -6
    2 12/17/2012 12:00:00 AM -8
    3 12/17/2012 12:00:00 AM 4
    5 12/17/2012 12:00:00 AM 10 
```

# image - codeigniter更新图像不重新上传

> ID：13924172
> 
> 赞同：0
> 
> 时间：2012-12-17T23:45:36.440
> 
> 标签：image, codeigniter, upload

我正在解决这个问题，在过去的几个小时里我一直在尝试上传图片，其中包含一些要存储在数据库中的细节。

我存储详细信息和图像路径，像魅力一样工作。现在是编辑部分。我正在尝试检查输入文件是否为空，如果是则仅更新详细信息，否则删除图像并重新上传新图像。问题是这样的：

如果输入文件为空，则更新所有内容没问题，如果不为空，则更新详细信息，但图像相同，不会被删除或重新上传。这是代码

```
$image_input = $this->input->post('image');
    if(isset($image_input) && !empty($image_input))
    {
        $this->db->where('id', $id);
        $img = $this->db->get('menus_category', 1);
        if($img->num_rows() > 0)
        {
            $row = $img->row();
            $original_image = $row->image;
            $desktop_image = $row->desk_img;
            $mobile_image = $row->mob_img;
            $thumb_image = $row->thumb;
            $unlink_image = unlink('./uploads/menus/' . $original_image);
            $unlink_desk = unlink('./uploads/menus/desk/' . $desktop_image);
            $unlink_mob = unlink('./uploads/menus/mobile/' . $mobile_image);
            $unlink_thumb = unlink('./uploads/menus/thumbs/' . $thumb_image);
            if($unlink_desk && $unlink_image && $unlink_mob && $unlink_thumb)
            {
                $config = array(
                'upload_path' => './uploads/menus',
                'allowed_types' => 'gif|jpg|jpeg|png',
                'max_size' => '15000'
                );
                $this->upload->initialize($config);

                if ($this->upload->do_upload('image'))
                {

                    $image_data = $this->upload->data();

                    $this->load->library('image_lib');
                    // thumb resize
                    $thumbnail = 'thumb_' . $image_data['file_name'];
                    $thumb = array(
                        'image_library' => 'GD2',
                        'source_image' => $image_data['full_path'],
                        'new_image' => $image_data['file_path'] . 'thumbs/' . $thumbnail,
                        'maintain_ratio' => TRUE,
                        'width' => '90',
                        'height' => '90'
                    );
                    $this->image_lib->initialize($thumb);
                    $this->image_lib->resize();
                    $this->image_lib->clear();

                    // mobile resize
                    $mob = 'mob_' . $image_data['file_name'];
                    $thumb_mob = array(
                        'image_library' => 'GD2',
                        'source_image' => $image_data['full_path'],
                        'new_image' => $image_data['file_path'] . 'mobile/' . $mob,
                        'maintain_ratio' => FALSE,
                        'width' => '290',
                        'height' => '83'
                    );
                    $this->image_lib->initialize($thumb_mob);
                    $this->image_lib->resize();
                    $this->image_lib->clear();

                    // desktop resize

                    $desk = 'desk_' . $image_data['file_name'];
                    $thumb_desk = array(
                        'image_library' => 'GD2',
                        'source_image' => $image_data['full_path'],
                        'new_image' =>  $image_data['file_path'] . 'desk/' . $desk,
                        'maintain_ratio' => FALSE,
                        'width' => '700',
                        'height' => '200'
                    );
                    $this->image_lib->initialize($thumb_desk);
                    $this->image_lib->resize();
                    $this->image_lib->clear();

                    // insert path and details to database
                    $data = array(
                        'title' => $input['title'],
                        'slug' => $this->_check_slug($input['title']),
                        'description' => $input['description'],
                        'image' => $image_data['file_name'],
                        'desk_img' => $desk,
                        'mob_img' => $mob,
                        'thumb' => $thumbnail
                    );
                    $this->db->where('id', $id);
                    return $this->db->update('menus_category', $data);
                }
                else 
                {
                    echo $this->image_lib->display_errors();
                }
            }
        }
    }

    else
    {
        $data2 = array(
            'title' => $input['title'],
            'slug' => $this->_check_slug($input['slug']),
            'description' => $input['description']
        );
        $this->db->where('id', $id);
        return $this->db->update('menus_category', $data2);
    } 
```

注意： else 语句工作正常，但第一个 if 有问题。现在我将 if 更改为 if(isset($image_input)) ... 如果文件输入不为空，则重新上传图片并更新详细信息，但如果我只更新没有图片的详细信息，则会删除已上传且未更新的图片。（我认为这是问题，但我不知道如何解决它）。

如果您愿意给我一些帮助或让我走上正确的方向，我将不胜感激。多谢你们

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T22:13:03.703

首先，这将是一条提出问题的评论，但我还没有足够的声誉添加一个...如果您可以发布您的 HTML 表单，那会很有帮助，但如果没有...

1）我假设您提交的表单在开始标记中有 enctype="multipart/form-data" 。2) 在您的代码的第 2 行*$this->input->post('image')*中，'image' 是来自文件类型的表单输入吗？如果是这样，您的语句将不起作用，因为 'image' 是 $_FILES 数组的一部分，而不是 $_POST 了。这意味着当你去检查它时，它总是空的（或不存在）。

要验证您的表单是否按照您认为的方式提交，请在您帖子中代码的第一行之前执行此操作：

```
var_dump($_POST);
var_dump($_FILES);
exit; // don't let anything run after the dumps. 
```

让我知道这是否使您朝着正确的方向前进。

# c++ - 从队列中编辑元素而不删除它

> ID：13924173
> 
> 赞同：3
> 
> 时间：2012-12-17T23:45:46.777
> 
> 标签：c++, queue

我正在使用 C++ 中的队列库，我需要从队列中选择最前面的元素并编辑该元素而不将其从队列中删除。有什么办法可以做到这一点？我需要做这样的事情：

```
queue<int> myQueue;
myQueue.push(1);
myQueue.push(2);
cout << myQueue.front(); // 2
int a = myQueue.front();
a = 3;
cout << myQueue.front(); // 3 
```

显然这不起作用=D。有谁知道该怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-17T23:50:32.120

`front()`返回一个参考，

```
int &a = queue.front();

a = 3; 
```

# python - Python Bottle 应用程序中的类实例，它是否在线程/进程之间共享？

> ID：13924179
> 
> 赞同：1
> 
> 时间：2012-12-17T23:46:13.333
> 
> 标签：python, multithreading, class, process, bottle

我在 Bottle 应用程序中创建了一个类，它处理和存储 URL 信息，并在每次发出 http 请求时创建：

```
@route('/<fullurl:path>')
    def page_req(fullurl=''):
        urlData = urlReq(request.urlparts[1], fullurl) 
```

urlData 是实例名，urlReq 是类名。

显然 urlData 实例将包含从一个请求生成的信息。我只是想知道如果在第一个请求的周期完成并发送其输出之前另一个请求进入会发生什么。第二个请求会更改 urlData 中的数据，还是会有两个单独的进程，每个进程都有自己的 urlData 版本？

我整个下午都在阅读 WSGI 进程/线程信息和 Bottle 文档，但还不是很清楚。我曾尝试编写一个小型自动化脚本，在开发服务器上触发多个请求，但它似乎会阻止多余的请求，直到一个完成。希望我已经足够清楚了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T18:15:28.143

`bottle.request`是 的线程安全实例`LocalRequest()`。如果从请求回调中访问，此实例始终引用**当前**请求（即使在多线程服务器上）。

见[http://bottlepy.org/docs/dev/api.html#bottle.request](http://bottlepy.org/docs/dev/api.html#bottle.request)

# java - 如何在android中更改gif图片大小

> ID：13924183
> 
> 赞同：7
> 
> 时间：2012-12-17T23:46:24.157
> 
> 标签：java, android, android-canvas, animated-gif

现在我知道如何在android中绘制GIF图片了，代码如下：

```
public class GIFView extends View{        
private Movie movie;  
private InputStream is;  
private long moviestart;  
public GIFView(Context context) {  
    super(context);
    is=getResources().openRawResource(R.drawable.anim_cerca);  
    movie=Movie.decodeStream(is);
}  

@Override  
protected void onDraw(Canvas canvas) {
    super.onDraw(canvas);
    long now=android.os.SystemClock.uptimeMillis();  

    if (moviestart == 0) 
        moviestart = now;  

    int relTime = (int)((now - moviestart) % movie.duration());
    movie.setTime(relTime);
    movie.draw(canvas,10,10);
    this.invalidate();
} 
```

}

最后是`movie.draw(canvas,x,y)`代码，其中x和y是gif图片的坐标（x=left，y=top）。但是我怎么能改变电影的宽度和高度呢？也许给出右边和底部的坐标，但是如何，在哪里？谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-12-13T20:50:18.403

我有同样的问题这是我的解决方案，在movie.draw之前的ondraw方法中添加这个代码

```
 canvas.scale((float)this.getWidth() / (float)movie.width(),(float)this.getHeight() /      (float)movie.height()); 
```

或者

```
canvas.scale(1.9f, 1.21f);//this changes according to screen size 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-19T01:16:44.847

你可以使用

```
 implementation 'pl.droidsonroids.gif:android-gif-drawable:1.2.4' 
```

库然后将其添加到 xml

```
 android:scaleType="fitXY" 
```

# android - 将 C 程序迁移到 Android NDK

> ID：13924184
> 
> 赞同：4
> 
> 时间：2012-12-17T23:46:28.390
> 
> 标签：android, c, android-ndk

我是 C/C++ 和 Android NDK 的初学者，在尝试创建本机库时遇到问题。我的代码在 CDT 上使用 MinGW 进行编译，但是当我在 JNI 文件上编写相同的代码时，出现错误。

我的代码是：

```
int n = 7;
int positions[n];   
int final_order[n];

memcpy(positions, final_order,sizeof(final_order)); 
```

该插件向我展示了：

```
Invalid arguments 'Candidates are: void * memcpy(void *, const void *, ?)' 
```

这是 CDT 上 MinGW 的标头：

```
_CRTIMP void* __cdecl __MINGW_NOTHROW   memcpy (void*, const void*, size_t); 
```

这是来自 Android NDK 的标头：

```
extern void*  memcpy(void *, const void *, size_t); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-08-16T15:42:48.290

使用 Eclipse 进行 NDK 开发时存在一个已知的索引问题。

在这里阅读：[https ://code.google.com/p/android/issues/detail?id=33788](https://code.google.com/p/android/issues/detail?id=33788)

在底部附近有一个我自己使用的合理解决方法：

> 我们想要的是使用 Android GCC 工具链，但更改实际工具并修改发现选项，以使包含路径和符号正确。
> 
> 进入 C/C++ Buid \ 工具链编辑器
> 
> 确保 Android GCC 是选定的工具链，并且 Android Builder 是选定的构建器。
> 
> 单击“选择工具” 选择“允许所有更改” 删除 Android GCC 编译器 添加“GCC C 编译器”和“GCC C++ 编译器”，以便我们可以索引 c 和 cpp 标头。
> 
> 如果您查看“路径和符号”，您会发现我们同时拥有 GNU C 和 GNU C++ 语言，但当然内置的包含路径是错误的。幸运的是，有一个解决方法。
> 
> 进入 C/C++ Build \ Discovery Options 将发现配置文件范围更改为“配置范围”确保发现配置文件使用“AndroidPerProjectProfile”并确保选中两个复选框。

然后我必须手动添加我自己的包含目录和定义`Project Properties -> C/C++ General -> Paths and Symbols`

值得注意的是，您的代码**编译**良好。如果您愿意，您可以关闭索引，但如果您仍然想要索引的优势，您将不得不解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-07T11:49:38.067

另一种解决方法是：

打开`android native`视角，

右键单击您的项目`project navigator`，

并单击`index`选项以重建索引。

# javascript - 调整大小时水平居中图像

> ID：13924187
> 
> 赞同：1
> 
> 时间：2012-12-17T23:46:32.397
> 
> 标签：javascript, css, slideshow

我被困住了...

我有一个 1920 像素 X 400 像素图像的幻灯片。照原样，仅当我在 1920px+ 浏览器窗口中全屏显示时，图像才会居中。如果我将窗口的大小重新调整为 1600 像素，图像会从中心向右移动，并且与网站的其他部分不对齐。

我希望幻灯片在我缩放浏览器窗口的宽度时保持居中，并根据浏览器的宽度向左和向右显示/隐藏图像区域。我不想缩放图像比例，也不能使用背景图像，这两者都很容易解决。

我假设一个 JS 侦听器计算图像宽度和浏览器窗口的宽度，以将其持续显示在中心。

演示站点在这里：[http ://bit.ly/YdMZDO](http://bit.ly/YdMZDO)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-17T23:54:59.410

在 .slides-wrapper 上添加这些样式：

```
left: 50%;
margin-left: -960px; // half the width of your image block 
```

# ruby-on-rails - 从 shell 运行 Rails 控制器方法？

> ID：13924198
> 
> 赞同：1
> 
> 时间：2012-12-17T23:47:36.650
> 
> 标签：ruby-on-rails, unix

在我拥有的 rails 项目的控制器中，有一个帮助函数，它发送一封电子邮件，其中包含过去一周对数据库所做的所有更改。我在 Unix 上还有一个 cron 作业，每个周末都会运行许多与我的 Web 应用程序相关的 bash 脚本。是否有一种简单的方法可以从独立的 .rb 文件或 bash 脚本运行控制器的辅助函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-17T23:54:51.867

如果您真的想从您的 crontab 中发出 Web 请求，您可以调用`wget`或`curl`在目标 URL 上。

```
0 * * * * wget http://yourdomain.com/path/to/request -o /dev/null 
```

如果您想在 Web 请求的上下文之外执行此邮件程序，那么这种行为不应该出现在您的控制器中。这是`lib/`为了什么。

您可以创建一个文件，例如`lib/my_helpers.rb`包含

```
module MyHelpers
  extend self

  def your_mailer(some, params, here)
    # runthe mailer
  end
end 
```

您可以将其包含在您想要的任何控制器中，甚至`ApplicationController`

```
include ::MyHelpers 
```

无论它包含在哪里，您都可以简单地调用`your_mailer(param1, param2, param3)`来执行它。

然后，您将在 rake 任务中包含此内容，并从您的 crontab 中执行 rake 任务。`lib/tasks/your_mailer.rake`用这样的东西创建一个文件

```
include MyHelpers

namespace :myapp do
  desc "Runs your_mailer"
    task :mailer => :environment do
    your_mailer(param1, param2, param3)
  end
end 
```

# django - Django：使用链或新的订单号字段对大量项目进行排序？

> ID：13924207
> 
> 赞同：1
> 
> 时间：2012-12-17T23:48:50.607
> 
> 标签：django, django-models

我有一组项目是系统中的人到期的，有些项目在清单中，而其他项目仅用于显示。我想获取要显示的项目列表和项目列表，以便检查清单报告显示仍未完成的项目。我希望对订购商品的性能和选项有所了解。我可以 a）将字段“订单”添加为正整数并按该订单号对其进行排序，或者 b）创建一个链对象，其中一个项目具有指向链中下一个项目的下一个链接，以便我可以快速迭代。

我猜第二个选项需要更多的数据库开销，因为每次调用 item.next 时都需要一个 SQL 调用，对吧？制作链条的好处是在我需要更改订单时重新使用这些物品。

关于性能和可维护性的任何想法我应该朝哪个方向发展？这是一个普遍的案例问题，通常是使用 SQL 来获取排序还是创建一个像链一样的数据结构来迭代更好？

# youtube - 在第一个完成播放后播放第二个 youtube 视频

> ID：13924209
> 
> 赞同：0
> 
> 时间：2012-12-17T23:49:08.043
> 
> 标签：youtube, youtube-api

我在我的网站上嵌入了 youtube 视频。嵌入视频播放完毕后，我想立即自动播放另一个 youtube 视频。我怎么能那样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T22:21:44.210

当你初始化你的 youtube 播放器时，添加 onStateChange 事件。然后查看事件是什么，如果它是 PlayerState.Ended 然后加载下一个视频。像这样的东西

```
 this.player = new YT.Player('player', {
      height: pxHeight,
      width: pxWidth,
      playerVars: {
                                'rel': 0,
                                'controls': 0,
                                'fs':0
      },
      events: {
        'onReady': onPlayerReady,
        'onStateChange': onPlayerStateChange,
        'onError': onError
      }
    });

  function onPlayerStateChange(event) {
    if (event.data == YT.PlayerState.PLAYING) {
        LOG("Youtube Playing");
    } else if (event.data == YT.PlayerState.ENDED) {
        LOG(">>>Youtube Ended");
        this.player.loadVideoById(ID, 0, "default");
    } else if (event.data == YT.PlayerState.PAUSED) {
        LOG("Youtube Paused");
    } else if (event.data == YT.PlayerState.BUFFERING) {
        LOG("Youtube Buffering");
    } else if (event.data == YT.PlayerState.CUED) {
        LOG("Youtube Cued");
    }
  } 
```

# c - C中的LCM和GCD使用递归或普通方法

> ID：13924215
> 
> 赞同：2
> 
> 时间：2012-12-17T23:49:41.747
> 
> 标签：c

在尝试从简化的编程中执行 GCD 和 LCM 程序时……我遇到了结果问题。我做的一切都是正确的（根据我），甚至逐字检查，但问题仍然存在......我只粘贴正常方法的代码。

```
#include <stdio.h>

int main()
{
    int a, b, x, y, t, gcd, lcm;

    printf("Enter first number :");
    scanf("%d", &a);
    printf("Enter first number :");
    scanf("%d", &b);

    a = x;
    b = y;

    while (b != 0)
    {
        t = b;
        b = a % b;
        a = t;
    }

    gcd = a;
    lcm = (x * y)/gcd;

    printf("Greatest common divisior of %d and %d = %d\n", x, y, gcd);
    printf("Lowest common divisior of %d and %d = %d\n", x, y, lcm);

    getch();    
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-17T23:52:13.887

至少这部分是根本错误的：

```
int a, b, x, y, t, gcd, lcm;

printf("Enter first number :");
scanf("%d", &a);
printf("Enter first number :");
scanf("%d", &b);

a = x;
b = y; 
```

因此，您正在声明`x`和`y`未初始化，然后将它们分配给- 现在`a`并且不包含用户输入的值，而是一些垃圾。你可能想要`b``a``b`

```
x = a;
y = b; 
```

反而。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-21T10:57:26.190

最好试试这个。这更容易运行。

```
#include<stdio.h>
int GCD(int,int); 
void main(){
int p,q;
printf("Enter the two numbers: ");
scanf("%d %d",&p,&q);
printf("\nThe GCD is %d",GCD(p,q));
printf("\nThe LCM is %d",(p*q)/(GCD(p,q)));
}
int GCD(int x,int y){
if(x<y)
GCD(y,x);
if(x%y==0)
return y;
else{
GCD(y,x%y);
 }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-06T15:36:25.317

尝试一下

```
#include<stdio.h>
int main(){
int a,b,lcm,gcd;
printf("enter two value:\n");
scanf("%d%d",&a,&b);
gcd=GCD(a,b);
lcm=LCM(a,b);
printf("LCM=%d and GCD=%d",lcm,gcd);
return 0;
}
int GCD(int a, int b){

while(a!=b){
    if(a>b){
        a=a-b;
    }else{
    b=b-a;
    }
    }
  return a;
}
int LCM(int a, int b){
return (a*b)/GCD(a,b);
} 
```

# sql-server - SQL Server 中的字符串构建

> ID：13924217
> 
> 赞同：1
> 
> 时间：2012-12-17T23:50:01.360
> 
> 标签：sql-server, parsing, csv, sp-send-dbmail, string-building

根据[Microsoft 文档](http://msdn.microsoft.com/en-us/library/ms190307%28v=sql.90%29.aspx) `sp_send_dbmail`，列表必须是分号分隔的。但是，在我的许多应用程序中，我无法保证此列表是干净的。我需要一种强大的方法来确保**语法上有效**的电子邮件列表，这样我的应用程序就不会中断。

我一直在研究`XML PATH`,`STUFF`和其他方法，但语法非常混乱。有没有人在他们的技巧包中有一个方便的方法（请不要存储过程或函数，我想要一个开箱即用的解决方案）？

从概念上讲，我认为最好将 CSV 列表分成一个临时表，分别处理每封电子邮件，然后使用分号分隔符重新组合列表。我怀疑有更好的方法。

同样，如果可能的话，我想要一个**开箱即用的解决方案**。:)

# android - 如何在 Android 中稳健地比较电话号码？

> ID：13924223
> 
> 赞同：1
> 
> 时间：2012-12-17T23:50:39.920
> 
> 标签：android, contacts, android-contacts

在我正在开发的 Android 应用程序中，我有一个用于映射的数据库：

> <联系人 ID，联系人查找键> --> <**与联系人关联的我的自定义数据**>

当收到 SMS 消息时，我希望能够查找与发送 SMS 消息的联系人关联的**联系人关联的自定义数据。**我想以尽可能少的步骤进行查找。

我可以从 SMS 消息中获取的唯一数据是**电话号码**，所以问题基本上是在尽可能少的步骤中将**电话号码**映射到**与联系人关联的我的自定义数据。**

[现在，我知道我可以使用ContactsContract.PhoneLookup](http://developer.android.com/reference/android/provider/ContactsContract.PhoneLookup.html)从电话号码中查找联系人，如此[处](https://stackoverflow.com/questions/4729551/contactscontract-lookup-phone-number-by-contact-id)所述。但是，这并没有让我得到我想要的结果，因为联系人 ID 和联系人查找密钥都可能发生变化。因此，如果我保存到数据库中的任何联系人的 ID 或查找键发生了变化，我基本上必须加载我的整个数据库并刷新每一行的 ID/查找键，然后才能测试它们是否代表相同的联系人ContactsContract.PhoneLookup 返回的那个。这是一个非常残酷的解决方案，我宁愿避免。

我想做的是保留一个表格，将电话号码映射到我的自定义数据（在 N:1 关系中）。

> <电话号码> --> <**与联系人关联的我的自定义数据**>

这样，至少在理论上，我可以索引电话号码列并一步查找数据。但是，电话号码有多种格式。只有当我可以创建给定电话号码的规范表示时，我的解决方案才有效。我的计划是使用[PhoneNumberUtils.getStrippedReversed](http://developer.android.com/reference/android/telephony/PhoneNumberUtils.html#getStrippedReversed(java.lang.String))来生成一个有效的可索引规范电话号码，但这在一个微不足道的情况下会失败，例如：

> PhoneNumberUtils.getStrippedReversed("+1(306)6656320") --> 02365566031 PhoneNumberUtils.getStrippedReversed("(306)6656320") --> 0236556603

他们不是同一个数字！

因此，通过冗长的解释，我的问题是：*任何人都可以想出一种将电话号码转换为规范电话号码的方法，以便我可以对号码执行索引数据库查找*，或任何其他解决方案我上面描述的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T10:30:43.893

您可以将以下方法与 getStrippedReversed 一起使用

```
public static String toCallerIDMinMatch (String phoneNumber) 
```

*以***相反*****的顺序返回网络部分中最右边的 MIN_MATCH (5) 个字符这可用于对存储 getStrippedReversed() 的列进行数据库查找 如果 phoneNumber == null 则返回 null ***

 *然后你的比较会给你想要的结果*

# xml - Google AdWords：RelatedToKeywordSearchParameter 已被弃用 - 我用什么替换它？

> ID：13924232
> 
> 赞同：0
> 
> 时间：2012-12-17T23:52:08.520
> 
> 标签：xml, soap, google-ads-api

我的 AdWords iOS 应用使用 google AdWords API 生成一个获取相关关键字列表的请求。

它使用的是 TargetingIdeaService API。[https://developers.google.com/adwords/api/docs/reference/latest/TargetingIdeaService](https://developers.google.com/adwords/api/docs/reference/latest/TargetingIdeaService)

它工作正常，使用 v201109 API。现在已被替换。当前（在撰写本文时）版本是 v201209。

使用 RelatedToKeywordSearchParameter 现在会返回错误。

请求网址： [https ://adwords.google.com/api/adwords/o/v201209/TargetingIdeaService](https://adwords.google.com/api/adwords/o/v201209/TargetingIdeaService)

正文（搜索与香蕉相关的词）：

```
<env:Body>
    <get xmlns="https://adwords.google.com/api/adwords/o/v201209">
        <selector>
            <searchParameters xsi:type="RelatedToKeywordSearchParameter">
                <wsdl:keywords>
                    <cm:text>banana</cm:text>
                    <cm:matchType>EXACT</cm:matchType>
                </wsdl:keywords>
            </searchParameters>

            <ideaType>KEYWORD</ideaType>
            <requestType>IDEAS</requestType>
            <requestedAttributeTypes>COMPETITION</requestedAttributeTypes>
            <requestedAttributeTypes>CRITERION</requestedAttributeTypes>
            <wsdl:paging>
                <cm:startIndex>0</cm:startIndex>
                <cm:numberResults>50</cm:numberResults>
            </wsdl:paging>
        </selector>
    </get>
</env:Body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T02:01:09.010

根据迁移文件：[https ://developers.google.com/adwords/api/docs/guides/migration-v201206](https://developers.google.com/adwords/api/docs/guides/migration-v201206)

将关键字数组作为参数的 RelatedToKeywordSearchParameter 替换为采用精确关键字匹配查询字符串数组的 RelatedToQuerySearchParameter。

# linq - LinQ：？：选择查询中的运算符

> ID：13924237
> 
> 赞同：-1
> 
> 时间：2012-12-17T23:52:43.777
> 
> 标签：linq, c#-4.0

我有一个如下查询。任何人都知道为什么**?:**部分总是返回错误值，尽管 LIST 中有项目包含。或者任何人有更好的想法来编写此查询，请随时在此处回复。谢谢。

```
List EList = new List();
EList.Add(new EmployeeInfo(1, "a1", "b1"));
EList.Add(new EmployeeInfo(2, "a2", "b2"));
List OList = new List();
OList.Add(new EmployeeInfo(1, "a1", "b1"));
OList.Add(new EmployeeInfo(2, "a2", "b2"));
OList.Add(new EmployeeInfo(3, "aa2", "bb2"));

var results = (
    from e in b
    select new
    {
        Id = e.ID,
        Name = e.Name,
        Email = e.Email,
        IS_Elist = (EList.Contains(e))?true:false,
        IS_Olist = (OList.Contains(e)) ? true : false,
    }
    ).ToList(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T00:03:57.417

首先，您可以简化您的查询 -`expression ? : true : false`相当于`expression`我们得到以下内容。

```
var results = b.Select(e => new
                            {
                                Id = e.ID,
                                Name = e.Name,
                                Email = e.Email,
                                IS_Elist = EList.Contains(e),
                                IS_Olist = OList.Contains(e)
                             })
               .ToList(); 
```

`true`如果来自的项目`b`包含在`EList`or中，这应该并且肯定会产生`OList`。如果你总是得到`false`这意味着`EList`并且`OList`不包含来自`b`. 请记住，您可能正在比较参考文献，因此

```
new EmployeeInfo(1, "a", "b") == new EmployeeInfo(1, "a", "b") 
```

通常会产生`false`.

我猜你实际上打算通过`ID`.

```
var results = b.Select(e => new
                            {
                                Id = e.ID,
                                Name = e.Name,
                                Email = e.Email,
                                IS_Elist = EList.Any(x => x.ID == e.ID),
                                IS_Olist = OList.Any(x => x.ID == e.ID)
                             })
               .ToList(); 
```

另一种解决方案是实现[`IEquatable<T>`](http://msdn.microsoft.com/en-us/library/ms131187.aspx)on`EmployeeInfo`或覆盖[`Equals()`，`GetHashCode()`以及相等运算符](http://msdn.microsoft.com/en-us/library/7h9bszxx.aspx)。你应该注意你的所有实现都会产生一致的结果，否则你会以很多困惑结束，例如为什么`Object.Equals()`和相等运算符会产生不同的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T00:00:47.067

您对 EmployeeInfo 的相等性检查可能与您期望的不同。为了确认，在您上面发布的代码段的底部，试试这个，看看它是否返回 true。

```
var is_olist = OList.Contains(new EmployeeInfo(1, "a1", "b1")); 
```

如果这返回 false，您需要考虑使用更简单但仍然唯一的东西来比较实例（例如 ID 成员），或者自己在 EmployeeInfo 中实现 equals。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T00:01:01.523

在 EmployeeInfo 类中实现 Equals 和 Equality == 运算符。

[实现 Equals 方法](http://msdn.microsoft.com/en-us/library/7h9bszxx%28v=vs.100%29.aspx)

[实现等式和等式运算符 (==) 的指南](http://msdn.microsoft.com/en-us/library/336aedhh%28v=vs.100%29.aspx)

# sql - MERGE - 有条件的“当匹配然后更新”

> ID：13924238
> 
> 赞同：20
> 
> 时间：2012-12-17T23:52:59.013
> 
> 标签：sql, sql-server, tsql, merge, data-warehouse

下图中的高亮部分显示了我想要实现的逻辑。我意识到语法不正确。

只有当目标表中的一个列的值为 NULL 并且源表中的相应值不为空时，有没有办法有条件地更新 MERGE 语句中的记录？

你会如何建议重写这个？

```
MERGE dbo.input_311 AS [t]
USING dbo.input_311_staging AS [s]
ON ([t].[unique key] = [s].[unique key])
WHEN NOT MATCHED BY TARGET
    THEN INSERT(t.[Created Date]) VALUES(s.[Created Date])
WHEN MATCHED
    THEN UPDATE SET(t.[Created Date] = s.[Created Date]
                WHERE s.[Created Date] IS NOT NULL
                AND t.[Created Date] IS NULL)
OUTPUT deleted.*, $action, inserted.*;
GO 
```

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-12-17T23:59:51.563

您也许可以使用`When Matched And (s.[Created Date] Is Not Null And t.[Created Date] Is Null) Then Update ...`.

# git - git 添加包含 X 的文件

> ID：13924241
> 
> 赞同：0
> 
> 时间：2012-12-17T23:53:29.983
> 
> 标签：git

在 git 中，如何将所有文件添加到 diff 包含指定字符串的下一个提交中？

我正在寻找类似的东西：`git add search('changes')`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T00:07:11.983

看看`grep -Rl`（递归 grep，列出匹配的文件）和`xargs`（将文件列表作为参数传递给另一个程序）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T00:14:48.987

你可以这样做：

```
git diff -S "regex" --name-only | xargs git add 
```

请注意，上面的命令会将*所有*更改添加到匹配文件中。如果您想要更多地控制添加哪些大块，我强烈建议您使用`git add -p`（不仅适用于这种情况，而且始终适用）。

如果要减少要查看的文件，可以将其与提到的第一个命令结合使用。

```
git diff -S "regex" --name-only | xargs git add -p 
```

# java - 当实例变量的名称与参数变量相同时调用实例变量

> ID：13924242
> 
> 赞同：3
> 
> 时间：2012-12-17T23:53:30.780
> 
> 标签：java, static, naming-conventions

我有这个代码：

```
class Foo {
 int x = 12;

public static void go(final int x) {

    System.out.println(x);

}
} 
```

参数 final x 和实例 x 具有相同的名称。如果我想在 go() 方法中使用实例变量 x = 12 ，考虑到它的名称与参数变量相同，我将如何引用它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-17T23:56:29.840

您需要将其设为静态才能在静态方法中使用它：

```
static int x = 12; 
```

然后你可以通过类名获得对它的引用：

```
public static void go(final int x)
{
    System.out.println(Foo.x);
} 
```

* * *

或者，创建一个实例并在本地使用它：

```
int x = 12;

public static void go(final int x)
{
    Foo f = new Foo();
    System.out.println(f.x);
} 
```

* * *

`x`或者使用实例方法，并使用关键字引用实例`this`：

```
int x = 12;

public void go(final int x)
{
    System.out.println(this.x);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-17T23:55:01.777

`this.x`指向实例变量。

为了引用一个*实例*变量，你必须在一个真实的实例中：你的方法不应该是`static`then。

# python - 为 csv 文件中的每个元素添加引号和选项卡

> ID：13924249
> 
> 赞同：2
> 
> 时间：2012-12-17T23:54:32.287
> 
> 标签：python, csv

如何使用 python 为 csv 文件中的每个元素添加引号和选项卡？

例如，我想制作这个 csv 样本：

```
TitleA,TitleB,TitleC,TitleD,TitleE,....
Data1,Data2,<null>,Data4,<null>,....
DataX,<null>,<null>,DataY,<null>,.... 
```

看起来像这样：

```
"TitleA"    "TitleB"    "TitleC"    "TitleD"    "TitleE"   ....
"Data1"    "Data2"    "<null>"    "Data4"    "<null>"    ....
"DataX"    "<null>"    "<null>"    "DataY"    "<null>"    .... 
```

我本质上是将一个 csv 文件转换为一个制表符分隔的文件，其中所有元素都用单引号括起来......

有没有快速的方法来做到这一点？

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-17T23:57:06.300

您正在做的是从一种 CSV 方言转换为另一种方言，对吗？

因此，您可以通过定义两种 CSV 方言并为其中一种方言创建读取器和为另一种方言创建写入器来做到这一点。

幸运的是，这些方言都很简单（输入甚至是默认的），你不需要做任何花哨的事情：

```
with open('in.csv', 'r') as infile, open('out.csv', 'w') as outfile:
    reader = csv.reader(infile)
    writer = csv.writer(outfile, delimiter='\t', quoting=csv.QUOTE_ALL)
    writer.writerows(reader) 
```

在非常旧的 Python 版本中，您可能必须将最后一行替换为两行：

```
 for line in reader:
        writer.writerow(line) 
```

有关详细信息，请参阅[方言和格式参数](http://docs.python.org/library/csv.html#csv-fmt-params)。

# .net - 在 Windows 任务栏中对单独的进程进行分组

> ID：13924264
> 
> 赞同：6
> 
> 时间：2012-12-17T23:55:25.313
> 
> 标签：.net, winapi, taskbar

我有许多在逻辑上相关的独立进程（但所有进程都是单独启动的——没有共同的“父”进程）。

是否可以让它们在 Windows 任务栏中显示为一组？

# 工作样本

这是一些受雷米回答启发的工作代码

```
using System;
using System.Runtime.InteropServices;
using System.Security;

namespace ConsoleApplication1
{
    [SuppressUnmanagedCodeSecurity]
    internal static class SafeNativeMethods
    {
        [DllImport("shell32.dll")]
        public static extern int SetCurrentProcessExplicitAppUserModelID([MarshalAs(UnmanagedType.LPWStr)] string AppID);

        [DllImport("kernel32.dll")]
        public static extern bool AllocConsole();

        [DllImport("kernel32.dll")]
        public static extern bool FreeConsole();
    }

    internal class Program
    {
        public static int SetApplicationUserModelId(string appId)
        {
            // check for Windows 7
            Version version = Environment.OSVersion.Version;
            if ((version.Major > 6) || (version.Major == 6 && version.Minor >= 1))
                return SafeNativeMethods.SetCurrentProcessExplicitAppUserModelID(appId);
            return -1;
        }

        [STAThread]
        public static void Main(string[] args)
        {
            int result = SetApplicationUserModelId("Gardiner.Sample1");

            SafeNativeMethods.AllocConsole();

            // Now we have a console, we can write to it
            Console.Title = "Sample 1";

            Console.WriteLine("Sample 1 {0}", result);
            Console.ReadLine();
            SafeNativeMethods.FreeConsole();
        }
    }
} 
```

要使其工作，必须将可执行文件设置为将“输出类型”设置为“Windows 应用程序”，并将“启动对象”配置为“ConsoleApplication1.Program”（对于上面的代码示例）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T01:02:41.747

是的，但仅限于 Windows 7 及更高版本。如果分配给它们的[应用程序用户模型 ID](http://msdn.microsoft.com/en-us/library/dd378459%28VS.85%29.aspx)相同，则多个进程和窗口将在任务栏上组合在一起。

# java - 发生异常时记录？

> ID：13924266
> 
> 赞同：2
> 
> 时间：2012-12-17T23:55:32.767
> 
> 标签：java, design-patterns

我有一个关于如何设计错误处理的通用问题。我想在我的代码中使用一些第三方服务。通常我将服务包装在客户端类中。然后我的其余代码只处理我的客户端类，对真正的服务视而不见。我的客户端类有一些记录错误的机制。但它不想捕获和处理服务中的任何异常。理想情况下，它应该忽略异常处理并让异常传播到外部。但是，如果我想记录异常，我必须这样做：

```
try{
    .... // call 3rd party service;
}catch(Exception e){ // e is triggered from the service;
    Log.error("Oops, an error: " + e); // shall I log the exception??
    throw e; // don't swallow the exception;
} 
```

一方面，我不想这样做。我可以忽略异常的处理和记录。让我的客户端类的调用者处理异常或记录错误。问题是，什么时候应该记录异常，什么时候不应该记录？我想听听一些常见的做法和原则。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T23:58:35.923

不要在每个级别记录异常。仅在“顶级”级别记录它。在不记录它会导致错过异常的地方记录它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T23:57:32.423

这取决于你。我的建议是在它们表明确实出乎意料的情况下记录异常。当然，“例外”这个名称似乎表明情况总是如此，但不一定。

有时，代码会针对非异常情况返回异常。

有时，代码调用其他代码，知道它会在某些情况下调用异常，但异常集是“OK”的。

有时，异常表明确实发生了意想不到的事情，这通常是一件坏事。那是你应该记录它的时候，或者更好的是，确保你的代码大声抱怨。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-17T23:59:50.340

如果触发异常的可能性相当低，我认为没有真正的理由*不*记录它。不记录异常以帮助调试的唯一原因是它是否不断触发。如果您有具有此特征的异常，那么我建议您编写代码，以免不断触发异常。

tl; dr：例外情况（希望）很少见，因此请记录它们。

# java - OpenGL ES 中的旋转

> ID：13924267
> 
> 赞同：2
> 
> 时间：2012-12-17T23:55:58.643
> 
> 标签：java, android, opengl-es, libgdx

我正在尝试使用以下代码在给定轴上连续旋转球体：

```
gl.glRotatef(axisX, 0, 1, 0);
gl.glRotatef(axisY, 0, 0, 1);

axisX = (axisX+1)%360;
axisY = (axisY+1)%360; 
```

变量`axisX`和`axisY`现在都加一，这将使旋转沿对角线方向向右移动。物体旋转了大约 45 度，然后开始转动并开始以另一种方式旋转。我怎样才能让它在除了 x 和 y 之外的轴上连续旋转？

注意：我正在尝试连接一个虚拟操纵杆来控制`axisX`和`axisY`值并使球体在操纵杆所代表的轴上旋转。如果有人对此有任何建议，那也很好。

**编辑：** 我已经改变了它，如果我使用`gl.glRotatef(angle, axisX, axisY, axisZ);`它，它可以工作并保持旋转，但旋转不平滑，看起来当我切换旋转轴时旋转会重新开始。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T07:01:43.593

```
glLoadIdentity(); // Reset rotation and give a new one
glRotatef(theta[0],1.0,0.0,0.0);
glRotatef(theta[1],0.0,1.0,0.0); 
```

第一个参数是角度，然后是您要围绕的轴。

关于您的编辑：看起来您在这里混合了轴和角度。轴应该是单位长度向量，角度从 0 到 2*PI。

另一种方法是使用四元数，然后将四元数转换为矩阵并将矩阵加载为当前的模型视图矩阵。

希望有帮助。

# haskell - Happstack 中间件缺乏？

> ID：13924273
> 
> 赞同：2
> 
> 时间：2012-12-17T23:56:15.787
> 
> 标签：haskell, middleware, happstack

我有通常的 happstack 案例，其中我们有`ServerPart Response` `MonadPlus`列表和。然后`msum`选择没有失败并且响应生成并返回的那个。

我认为应该在任何传入请求中完成一些操作——比如检查 cookie——准备连接上下文（授权经过身份验证的用户、实现计数等）——甚至还没有定义任何路径信息。

也许还有一些我还不知道的流行词，特别是针对这类员工。有人可以建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T04:41:32.537

如果您想对每个请求执行某些操作，您可以在路由代码之前的 do 语句中添加它们。例如：

```
module Main where

import Happstack.Server

main = simpleHTTP nullConf $ do incCounter
                                mUser <- checkUserAuth
                                resp <- msum [ part1
                                             , part2
                                             , part3 mUser
                                             ]
                                logResponse resp
                                return resp 
```

那将始终运行`incCounter`并且`checkUserAuth`. 然后它将尝试各种路线。

如果其中一条路由匹配，它将调用`logResponse`，最后返回`resp`将发送给用户的路由。

请注意，while`incCounter`和`checkUserAuth`will 始终运行，`logResponse`只有在其中一个部分匹配时才会运行。如果没有，那么我很确定代码会转义并返回 404。如果您想`logResponse`始终运行，那么您可以向`msum`始终匹配的处理程序添加一个处理程序。例如：

```
 resp <- msum [ part1
                              , part2
                              , part3 mUser
                              , notFound $ toResponse "Sorry, page not found."
                              ] 
```

那几乎总是会运行。如果其中一个部分匹配，但明确调用“escape”，那么我很确定`logResponse`仍然不会运行。也有处理这种情况的方法。

但是，简短的回答是，如果您希望某些事情发生在时间上，只需将其放在您的`msum`代码之前。

# ruby - 正则表达式 - 在某些字符之后匹配文本

> ID：13924274
> 
> 赞同：12
> 
> 时间：2012-12-17T23:56:20.427
> 
> 标签：ruby, regex

我想从一些文本中抓取数据并将其转储到一个数组中。考虑以下文本作为示例数据：

```
| Example Data
| Title: This is a sample title
| Content: This is sample content
| Date: 12/21/2012 
```

我目前正在使用以下正则表达式来抓取“冒号”字符后指定的数据：

```
/((?=:).+)/ 
```

不幸的是，这个正则表达式也抓住了冒号和冒号后面的空格。我如何只获取数据？

另外，我不确定我是否做对了。但看起来好像外部括号会导致匹配返回一个数组。这是parens的功能吗？

编辑：我正在使用 Rubular 来测试我的正则表达式

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-17T23:58:23.027

您可以将其更改为：

```
/: (.+)/ 
```

并获取第 1 组的内容。不过，后视也可以工作，并且可以满足您的要求：

```
/(?<=: ).+/ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-18T01:45:17.010

除了@minitech 的回答，您还可以进行第三种变化：

```
/(?<=: ?)(.+)/ 
```

这里的不同之处在于，您使用后视来创建/获取组。

如果您仍然更喜欢前瞻而不是后视概念。. .

```
/(?=: ?(.+))/ 
```

这将围绕您现有的正则表达式进行分组，它将在一个组中捕获它。

是的，代码中的外括号*会*匹配。将其与我给出的后一个示例进行比较，其中整个前瞻是“分组”的，而不是不必要地使用`/( ... )/`没有 的a `/(?= ... )/`，因为大多数正则表达式引擎中的第一个结果返回整个匹配的字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-28T12:46:16.743

我知道您要使用正则表达式，但我刚刚看到了正则表达式解决方案，发现对于不熟悉正则表达式的人来说很难阅读。

我也在使用 Ruby，我决定这样做：

```
line_as_string.split(": ")[-1] 
```

这可以满足您的要求，恕我直言，它更具可读性。对于很长的字符串，它可能效率低下。但不是为了这个目的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-07-10T16:08:06.633

在 Ruby 中，与 PCRE 和 Boost 一样，您可以使用`\K` [*匹配重置运算符*](https://www.regular-expressions.info/keep.html)：

> `\K`将匹配的文本保持在整体正则表达式匹配之外。`h\Kd`仅匹配 中的第二`d`个`adhd`。

所以，你可以使用

```
/:[[:blank:]]*\K.+/     # To only match horizontal whitespaces with `[[:blank:]]`
/:\s*\K.+/              # To match any whitespace with `\s` 
```

请参阅[Rubular 演示 #1](https://rubular.com/r/B6kmhQAPwwt1wL)和[Rubular 演示 #2](https://rubular.com/r/9VMytb4e2cHoni)和

**细节**

*   `:`- 一个冒号
*   `[[:blank:]]*`- 0 个或多个水平空白字符
*   `\K`- 匹配重置运算符从整体匹配内存缓冲区中丢弃到目前为止匹配的文本
*   `.+`- 匹配并使用除换行符以外的任何 1 个或多个字符（使用`/m`修饰符匹配任何字符，包括换行符）。

# jquery - 根据选择框选择显示/隐藏文本字段

> ID：13924277
> 
> 赞同：1
> 
> 时间：2012-12-17T23:56:47.920
> 
> 标签：jquery, ruby-on-rails, ruby-on-rails-3

以简单的形式：

```
<%= form_for @user do |f| %>
  <%= f.label :source, "How did you find out about us?", :class => "control-label" %>
  <%= f.select(:source, options_for_select([['--  Please select  --',nil],['Source 1','Source 1'], ['Source 2','Source 2'], ['Other','Other']])) %>

  <%= f.label :source_other, "Specify Other Source" %>
  <%= f.text_field :source_other %>
<% end %> 
```

我正在尝试学习如何使用 JQuery 仅在从“源”字段中选择值“其他”时显示“source_other”文本字段。从我在网上看到的，看来我需要使用这样的东西：

```
$("#source").change(function() {
  if ($("#source").val()=="Other")
    $("#source_other").show();
  else
    $("#source_other").hide();
}); 
```

但是，我不太了解如何将 JQuery 与我的表单集成。有人可以指出我正确的方向吗？

**更新：**

这是生成的 html 片段：

```
<form accept-charset="UTF-8" action="/users" class="new_user" id="new_user" method="post">
  <label class="control-label" for="user_lead_source">How did you find out about us?</label>
  <select id="user_source" name="user[source]"><option value="">--  Please select  --</option>
    <option value="Source 1">Source 1</option>
    <option value="Source 2">Source 2</option>
    <option value="Other">Other</option>
  </select>

  <label for="user_source_other">Specify Other Source</label>
  <input id="user_source_other" name="user[source_other]" size="30" type="text" />
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T00:03:43.220

我怀疑您的服务器代码没有为元素生成 ID，在这种情况下，您的选择器正在寻找 ID 不存在的元素

如果是这种情况，请在您的服务器代码中添加一个 ID，以便您的 jQuery ID 选择器可以工作或使用`name=`选择器

```
$(function(){
    $('input[name="source"]').change(function() {
      $('input[name="source_other"]').toggle(  $(this).val()=="Other" );

    });
}); 
```

只要 jQuery 代码被包裹在其中`$(document).ready()`或者`$(function(){});`是相同的简写，你可以将它放在页面中的任何地方，只要它是在 jQuery 库加载之后。或者你可以把它放在 jQuery 之后加载的外部文件中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T10:56:05.230

代替

```
 $("#source") with $("#user_source") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T15:31:44.470

应该`$("#user_source")`改为！

Rails 在属性之前添加模型名称。然后它应该隐藏/显示`$("#user_source_other")`元素。

此外，您必须将此 jQuery JS 代码包装在之前回答`$(document).ready()`的`$(function(){});`charlietfl 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-22T18:53:10.080

```
 $(document).on("change", "#user_source", function(){
    var value = $(this).val();
    if (value === "Other"){
      $("#source_other").show();
    }else{
      $("#source_other").hide();
    }
  }) 
```

# javascript - 居中的javascript弹出窗口

> ID：13924279
> 
> 赞同：0
> 
> 时间：2012-12-17T23:56:53.930
> 
> 标签：javascript, popup, centering

这是我的 JavaScript 代码。

```
<SCRIPT TYPE="text/javascript">
<!--
function popup(mylink, windowname) {
    if (! window.focus) return true;
    var href;
    if (typeof mylink  == 'string')
        href=mylink;
    else
        href = mylink.href;
    window.open(href, windowname, 'width=500,height=500,scrollbars=yes');
    return false;
}
//-->
</SCRIPT> 
```

仅使用上面的代码，弹出窗口完全符合我的要求，但它似乎紧贴在左上角。我希望弹出窗口居中。

我在这个网站上尝试了几个建议（例如：

```
var left = screen.width / 2 - w / 2;
var top = screen.height / 2 - h / 2; 
```

但是将其他任何内容插入我已经拥有的代码中会使弹出窗口在同一浏览器的新选项卡中打开（忽略弹出功能）。

这就是我来这里要解决的问题。

此外，我想淡化背景以将读者的注意力吸引到弹出窗口上。有没有我可以扔进去的javascript片段？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T00:06:05.350

试试这个：

```
function popupW(mylink, windowname) {
    var href;
    var w = h = 500;
    var left = (screen.width/2) - (w/2);
    var top = (screen.height/2) - (h/2);

    if(!window.focus) {
        return true;
    }

    if(typeof mylink == 'string') {
        href = mylink;
    } else {
        href = mylink.href;
    }

    window.open(href, windowname, 'width='+w+', height='+h+', scrollbars=yes, top='+top+', left='+left);
    return false;
}
popupW('http://google.com', 'google'); 
```

背景窗口的淡化可以通过创建叠加来完成。

```
var overlay = document.createElement('div');
overlay.setAttribute('id', 'overlay');
document.body.appendChild(overlay); 
```

使用以下 CSS 样式：

```
#overlay {
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    background: rgba(0,0,0,0.5);
    z-index: 99999;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T00:08:30.990

你可以试试这个

```
function popup(mylink, windowname)
{
    if (typeof(mylink) !== 'string') mylink=mylink.href;
    var l=(screen.width-500)/2, t=(screen.height-500)/2;
    window.open(mylink, windowname, 'width=500,height=500,scrollbars=1,left='+l+',top='+t);
    return false;
}

popup('http://heera.it', 'hit'); 
```

[**例子。**](http://jsfiddle.net/4VXY9/3/)

# php - Symfony2 - 用户通过 id 引用角色实体，但登录时无法检索用户角色

> ID：13924280
> 
> 赞同：0
> 
> 时间：2012-12-17T23:57:03.160
> 
> 标签：php, symfony, doctrine-orm, user-roles

这是我的用户实体

```
<?php

namespace Monse\UsuariosBundle\Entity;

use Symfony\Component\Security\Core\User\UserInterface;
use Doctrine\ORM\Mapping as ORM;

/**
 * Monse\UsuariosBundle\Entity\Usuario
 *
 * @ORM\Table(name="users")
 * @ORM\Entity
 */
class Usuario implements UserInterface
{
    /**
     * @var integer $id
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    protected $id;

    /** 
 * @ORM\OneToOne(targetEntity="Monse\ClientesBundle\Entity\Cliente")
 * @ORM\JoinColumn(name="cliente_id", referencedColumnName="id",nullable=true)
*/
    protected $cliente;

    /**
     * @var string $usuario
     *
     * @ORM\Column(name="usuario", type="string", length=255, unique=true)
     */
    protected $usuario;

    /**
     * @var string $email
     *
     * @ORM\Column(name="email", type="string", length=255, unique=true)
     */
    protected $email;

    /**
     * @var string $password
     *
     * @ORM\Column(name="password", type="string", length=255)
     */
    protected $password;

    /**
     * @var string $salt
     *
     * @ORM\Column(name="salt", type="string", length=255)
     */
    protected $salt;

    /**
     * @var date $ultimo_ingreso
     *
     * @ORM\Column(name="ultimo_ingreso", type="date")
     */
    protected $ultimo_ingreso;

    /**
     * @var date $fecha_alta
     *
     * @ORM\Column(name="fecha_alta", type="date")
     */
    protected $fecha_alta;

     /**
* @ORM\ManyToOne(targetEntity="Monse\UsuariosBundle\Entity\Rol")
* @ORM\JoinColumn(name="rol", referencedColumnName="id",nullable=false)
*/
    protected $rol;

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

public function setCliente(\Monse\ClientesBundle\Entity\Cliente $cliente)
    {
        $this->cliente = $cliente;
    }

    /**
     * Get cliente
     *
     * @return integer 
     */
    public function getCliente()
    {
        return $this->cliente;
    }

    /**
     * Set usuario
     *
     * @param string $usuario
     */
    public function setUsuario($usuario)
    {
        $this->usuario = $usuario;
    }

    /**
     * Get usuario
     *
     * @return string 
     */
    public function getUsuario()
    {
        return $this->usuario;
    }

    /**
     * Set email
     *
     * @param string $email
     */
    public function setEmail($email)
    {
        $this->email = $email;
    }

    /**
     * Get email
     *
     * @return string 
     */
    public function getEmail()
    {
        return $this->email;
    }

    /**
     * Set contrasena
     *
     * @param string $contrasena
     */
    public function setPassword($password)
    {
        $this->password = $password;
    }

    /**
     * Get contrasena
     *
     * @return string 
     */
    public function getPassword()
    {
        return $this->password;
    }

    /**
     * Set salt
     *
     * @param string $salt
     */
    public function setSalt($salt)
    {
        $this->salt = $salt;
    }

    /**
     * Get salt
     *
     * @return string 
     */
    public function getSalt()
    {
        return $this->salt;
    }

    /**
     * Set ultimo_ingreso
     *
     * @param date $ultimoIngreso
     */
    public function setUltimoIngreso($ultimoIngreso)
    {
        $this->ultimo_ingreso = $ultimoIngreso;
    }

    /**
     * Get ultimo_ingreso
     *
     * @return date 
     */
    public function getUltimoIngreso()
    {
        return $this->ultimo_ingreso;
    }

    /**
     * Set fecha_alta
     *
     * @param date $fechaAlta
     */
    public function setFechaAlta($fechaAlta)
    {
        $this->fecha_alta = $fechaAlta;
    }

    /**
     * Get fecha_alta
     *
     * @return date 
     */
    public function getFechaAlta()
    {
        return $this->fecha_alta;
    }

    /**
     * Set rol
     *
     * @param integer $rol
     */
    public function setRol(\Monse\UsuariosBundle\Entity\Rol $rol)
    {
        $this->rol = $rol;
    }

    /**
     * Get rol
     *
     * @return integer 
     */
    public function getRol()
    {
        return $this->rol;
    }

    public function __construct()
    {
        $this->fecha_alta = new \DateTime();
    }

    function equals(\Symfony\Component\Security\Core\User\UserInterface $usuario)
    {
        return $this->getUsuario() == $usuario->getUsername();
    }

    function eraseCredentials()
    {
    }

    function getRoles()
    {
    }

    function getUsername()
    {
        return $this->getUsuario();
    }
} 
```

这是我的角色实体

```
 <?php

namespace Monse\UsuariosBundle\Entity;

use Symfony\Component\Security\Core\Role\RoleInterface;
use Doctrine\ORM\Mapping as ORM;
/**
 * Monse\UsuariosBundle\Entity\Rol
 *
 * @ORM\Table(name="roles")
 * @ORM\Entity
 */
class Rol implements RoleInterface
{
    /**
     * @var integer $id
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    protected $id;

    /**
     * @var string $role
     *
     * @ORM\Column(name="rol", type="string", length=255)
     */
    protected $role;

    /**
     * @var string $denominacion
     *
     * @ORM\Column(name="denominacion", type="string", length=255)
     */
    protected $denominacion;

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set rol
     *
     * @param string $rol
     */
    public function setRole($role)
    {
        $this->role = $role;
    }

    /**
     * Get rol
     *
     * @return string 
     */
    public function getRole()
    {
        return $this->role;
    }
     public function setDenominacion($denominacion)
    {
        $this->denominacion = $denominacion;
    }

    /**
     * Get denominacion
     *
     * @return string 
     */
    public function getDenominacion()
    {
        return $this->denominacion;
    }

    public function __toString() {
        return $this->denominacion;
    }
} 
```

请帮忙，我不知道我做错了什么？

我需要管理角色，这就是我拥有实体的原因。

在角色实体中

rol 有 ROLE_ADMIN、ROLE_USER ......面额是超级管理员、管理员、用户等......我需要检索 ROL

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T04:11:08.633

函数`getRoles()`in`Usuario`应该返回一个`array`角色名称。为什么你的是空的？

```
public function getRoles()
{
    return $this->roles->map(function($r) { return $r->getRole(); })
        ->toArray();
} 
```

`Usuario`与角色具有多对一的关系。你确定这是正确的吗？上面的示例假设您有一个角色集合。

# django - 如何在 django 中实现沙盒 python 解释器以允许用户上传和运行具有有限文件系统访问权限的代码

> ID：13924284
> 
> 赞同：2
> 
> 时间：2012-12-17T23:57:09.460
> 
> 标签：django, sandbox, pypy, empythoned

我正在考虑为基于 Python 的生物信息学编程构建一个基于 Web 的学习环境。我的目标是结合[***Codeacademy 的***](http://www.codecademy.com/courses/python-intermediate-en-OGNHh?curriculum_id=4f89dab3d788890003000096)界面和[***Rosalind***](http://rosalind.info/problems/list-view/)风格的问题，最好在 Django 中实现。

我需要提供一些有限的文件系统访问（用于上传、下载和解释器访问），因为生物信息学问题通常涉及大型生物数据集，同时仍要确保服务器安全。

据我目前了解，有两种可能的方法：

*   客户端解释器，例如[***empythoned***](https://github.com/replit/empythoned)（在[***repl.it***](http://www.replit.com/Fir/1)中使用，我相信在 Codeacademy 中使用）
*   服务器端沙盒解释器，例如[***PyPy 沙盒***](http://doc.pypy.org/en/latest/sandbox.html)

有没有人对最好的方式有任何建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-27T03:16:11.860

根据Codeacademy的[这篇博文，他们确实使用了客户端解释器，但遇到了一些问题。](http://www.codecademy.com/blog/25-announcing-python)因此，他们决定将其更改为服务器端方法。

我会推荐服务器端的方法，因为它看起来更可靠和灵活。

# android-pay - 谷歌钱包 OpenID

> ID：13924287
> 
> 赞同：0
> 
> 时间：2012-12-17T23:57:53.480
> 
> 标签：android-pay

我正在为 Chrome 商店开发 HTML5 应用程序，并打算使用谷歌钱包进行微交易。实施看起来很简单，除了我不确定如何在成功交易后在帖子消息中识别用户。我假设我需要使用开放 ID 流来获取用户信息，以便我可以在我的数据库中记录交易，但希望我遗漏了一些东西，并且钱包 SDK 有一种简单的方法来发布用户谷歌开放身份？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T13:46:30.423

看起来应用程序需要请求 openid 本身，因为似乎没有返回有关当前 openid 的会话信息

# ruby-on-rails - 显示评论创建者的删除链接

> ID：13924288
> 
> 赞同：0
> 
> 时间：2012-12-17T23:58:09.363
> 
> 标签：ruby-on-rails

我让我的应用程序正常工作，因此用户只能删除他们自己的评论，但现在我试图添加指向该网站的链接，但我只希望评论的创建者能够看到该链接。

我试着做

```
<% if current_user %> 
```

但是当我这样做时，它会显示在所有评论上，而不仅仅是用户。我可以

```
<% if current_user.admin %> 
```

这限制了只有管理员才能看到删除链接。我也试过

```
 <% if @comment.user_id == current_user.id %> 
```

那也不起作用。我该怎么做才能让评论创建者只能看到评论？

这是我的看法

_comments.html.erb

```
 <div class="container">
  <% @comments.each do |comment| %>
  <div class="comment">
<div class="gravatar_border">
  <%= gravatar_for comment.user, size: '49' %>
</div>

<div class="user_info_comments">
  <b><%= comment.user.name %></b>
  <%= comment.created_at.strftime("%b. %d  %Y") %>
</div>

<div class="user_comments">
  <%= simple_format comment.content %> 
  <%= pluralize comment.reputation_value_for(:votes).to_i, "vote" %>
  <%= link_to "", vote_comment_path(comment, type: 'up'), method: "post", class: ' icon-thumbs-up' %>
  <%= link_to "", vote_comment_path(comment, type: 'down'), method: "post", class: ' icon-thumbs-down' %>
  <% if @comment.user_id == current_user.id %>
  <%= link_to 'delete', comment, method: :delete, confirm: 'you sure?' %>
  <% end %>
   </div>
  </div>
 <% end %>
 <br />
</div> 
```

这是我的控制器

评论控制器.rb

```
 def destroy
      @comment = Comment.find(params[:id])
      if @comment.user_id == current_user.id
        @comment.destroy
        flash[:notice] = "comment deleted!"
      else
        flash[:error] = "not allowed"
      end
   redirect_to :back
 end 
```

这是该网站的链接[http://www.batman-fansite.com](http://www.batman-fansite.com)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T00:11:52.600

在您看来更改`@comment`为`comment`。

```
<% if comment.user_id == current_user.id %> 
```

`@comment`在您的`destroy`操作中定义，但是当您在视图中设置这样的块时

```
<% @comments.each do |comment| %> 
```

`@comment`没有价值，只有`comment`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T00:12:02.917

```
<% if comment.user_id == current_user.id %> 
```

并且应该工作）

# performance - 高效光线追踪的数据结构/方法

> ID：13924296
> 
> 赞同：7
> 
> 时间：2012-12-17T23:58:57.730
> 
> 标签：performance, algorithm, data-structures, 3d, raytracing

我正在编写一个 3D 光线跟踪器作为个人学习项目 ( [Enlight](https://github.com/mikera/enlight) )，并且遇到了一个与在光线和对象场景之间进行交叉测试相关的有趣问题。

情况是：

*   我有许多可以与光线相交的基元（球体、盒子、平面等）及其组。我统称为这些场景对象。
*   我希望能够通过将对象图元包装在一个`Transform`对象中来对具有任意仿射变换的对象图元进行场景化（重要的是，这将使同一图元的多个实例能够在场景中的不同位置使用，因为图元是不可变的）
*   场景对象可以存储在包围体层次结构中（即我正在做空间分区）
*   我的相交测试适用于`Ray`表示部分射线段的对象（起始向量、归一化方向向量、起始距离、结束距离）

问题是，当光线射中 Transform 对象的边界框时，看起来与包含在其中的已转换图元进行交集测试的唯一方法是将 转换`Ray`为已转换的坐标空间。这很容易，但是如果光线没有击中任何变换的对象，我需要回退到原始对象`Ray`以继续跟踪。由于 Transforms 可能是嵌套的，这意味着我必须为`Ray`完成的每个交集跟踪维护一整堆 s。

这当然是在整个应用程序的内部循环中，也是主要的性能瓶颈。它将每秒调用数百万次，因此我热衷于最大限度地降低复杂性/避免不必要的内存分配。

有没有一种聪明的方法可以避免分配新`Ray`的/保留`Ray`堆栈？

还是有更聪明的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T23:04:49.520

大多数时候，在光线追踪中，您有几个（十、千）个物体和更多的光线。可能有数百万条光线。在这种情况下，看看您可以在对象上花费什么样的计算以使其更快/更容易让光线与它们交互是有意义的。

正如boyfarrell 建议的那样，缓存将非常有用。不仅对将它们移入或移出全局框架的对象创建正向和反向变换，而且在全局框架中保留对象的副本，这可能是有意义的。它使创建对象或移动对象变得更加昂贵（因为变换发生变化，缓存的全局帧副本也发生变化），但这可能没关系。

如果你投射 N 条射线并有 M 个对象，并且 N >> M，那么每个对象都会有多条射线击中它是理所当然的。如果我们假设每条射线都撞击一个物体，那么每个物体都有 N/M 条射线撞击它。这意味着将 N/M 射线转换到每个物体，命中测试，并可能将其反转回来。或者每个对象至少 N/M 次变换。但是，如果我们缓存转换后的对象，我们可以对每个对象执行一次转换以到达全局框架，然后不需要任何额外的操作。至少对于命中测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T09:53:07.533

以基本形式定义您的图元（统一比例，以 0,0,0 为中心，不旋转），然后仅使用变换在场景中移动它们。在每个对象中缓存完整的正向和反向转换的结果。（不要忘记法线向量，您将需要它们进行反射）

这将使您能够使用简化的数学来测试命中（您将光线反向转换到对象空间并使用基本形式对象计算命中），然后使用另一个将命中点和可能的反射向量转换回现实世界空间转换。

您将需要计算与场景中所有对象的交点，并选择最接近光线原点（但不是负距离）的命中。为了进一步加快速度，将多个对象封闭在“边界框”中，这将非常简单地计算命中，并且如果命中则将真实世界的光线传递给封闭的对象（但所有对象仍将使用其预先计算的矩阵）。

# java - 如何在带有防火墙的 Windows 主机中使用 InetAddress

> ID：13924297
> 
> 赞同：0
> 
> 时间：2012-12-17T23:58:58.890
> 
> 标签：java, network-programming, inetaddress

我想获得有关如何在防火墙处于活动状态的 Windows 系统中使用 InetAddress 的示例或建议。我不知道防火墙阻止了哪些不允许 Windows 中的此类工作。

当我尝试在禁用防火墙的 Windows 中使用此代码时，我得到主机名并`isReachable`设置为 true：

```
InetAddress addrs = null;
try {
    addrs = InetAddress.getByName("192.168.1.1");
    System.out.println(addrs.getHostName());
    System.out.println(addrs.isReachable(100));
} catch (UnknownHostException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} 
```

但是我得到了激活防火墙`false`，我可以为此使用策略吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T00:01:56.703

您必须配置防火墙以允许 JVM ( `java.exe`) 打开连接。java代码不需要更改，是配置问题。

# ruby - 将类添加到菜单中的活动 li

> ID：13924300
> 
> 赞同：1
> 
> 时间：2012-12-17T23:59:25.730
> 
> 标签：ruby, templates, sinatra, haml

这是我的haml代码：

```
%li.active
  %a{ :href => "#" } Home
%li
  %a{ :href => "#" } About
%li
  %a{ :href => "#" } Sign up
%li
  %a{ :href => "#" } Log in 
```

将`.active`属性添加到代表当前页面的元素的最简洁方法是什么？我曾想过将一个字符串传递给模板并循环遍历所有元素，从哈希构建菜单，但似乎必须有一种更清洁的方式。

有这样做的“正确”方法吗？我不得不假设这是一个非常常见的操作。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T00:01:41.783

如果您没有太多导航项，则可以执行以下操作：

```
%li{ :class => @selected == :home ? "active" : nil } 
```

# c# - C# MysqlConnector 可以在我的一台计算机上运行， 但不能在另一台计算机上运行

> ID：13924304
> 
> 赞同：0
> 
> 时间：2012-12-17T23:59:38.697
> 
> 标签：c#, mysql, connection

我决定拓宽视野，将 C#（免费版）用于小程序。该程序打开一个 mysql 表并在列表视图中显示它的内容。我在我的开发人员机器上编译并运行它，一切正常。然后把它移到我女朋友的电脑上。应用程序启动并出现窗口，但列表为空。如果免费版本在另一台机器上运行，是否有任何限制会阻止连接？这是我正在尝试运行的发布编译的 exe。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T00:39:00.610

据我所知，没有任何限制。你是如何处理异常的？更有可能是环境不匹配，这意味着您没有 MySQL 或连接字符串对于另一台计算机不正确。

如果您正在捕获异常并抑制错误，那么您很容易忽略与连接有关的异常。

# jenkins - 促进构建不运行其他项目

> ID：13924308
> 
> 赞同：0
> 
> 时间：2012-12-17T23:59:56.193
> 
> 标签：jenkins, cloudbees

我正在寻找一种使用 cloudbees 构建持续交付的方法，因此每次提交时，我的代码都会被编译、单元测试并部署到登台（在 run@cloud 上运行）。

为简单起见，我们称其为“staging-build”。然后在对暂存环境进行一些手动测试之后，我希望有一个选项来提升特定的（不是最后一个）“暂存构建”，因此所产生的提升构建的工件应该通过“prod-build”作业部署到生产环境。

基本思想是为“staging-build”作业配置“promote build”，并将构建“prod-build”作为促进操作。然而，点击promote-build 不会触发启动“prod-build”。我也从另一边尝试过：删除构建“prod-build”作为提升操作，并在“prod-build”配置中启用“提升另一个项目时构建”。仍然没有成功。谷歌搜索了一段时间后，我找到了 [http://blog.cloudbees.com/2012/10/continuous-integration-for-mobile-apps.html](http://blog.cloudbees.com/2012/10/continuous-integration-for-mobile-apps.html)。尽管如此，博客条目以及 jenkins 配置屏幕截图并未反映[https://partnerdemo.ci.cloudbees.com上的配置](https://partnerdemo.ci.cloudbees.com)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T18:17:47.650

我终于找到了问题的根源：要在促销时运行的作业必须以文件夹名称为前缀（显然是在文件夹中的情况下）。在其他情况下，他们的运行会被默默地跳过——甚至升级日志也没有“为...计划构建”条目。恕我直言，Jenkins Web 控制台在这种情况下应该显示某种警告，就像输入无效作业名称时一样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T22:37:58.207

配置促销以触发您的产品构建工作是可行的方法。可能有一些配置问题在您的问题中不可见。请给我您的帐户 ID，以便我仔细检查您的配置

# php - 用php提交ajax表单

> ID：13924309
> 
> 赞同：0
> 
> 时间：2012-12-17T23:59:57.783
> 
> 标签：php, ajax, forms, submission

我在发送电子邮件时遇到问题，我确信这是因为 php，但这里也是 js ajax ..它显示了我未正确填写的表单字段的错误消息，然后它显示了我的处理栏一次提交但我在提交后收到错误消息..任何帮助将不胜感激。

html

```
<form method="post" action="feedback.php" id="contactform">
            <fieldset class="first">

            <div id="response"></div>  

            <div id="name_input">

            <input id="name" name="name" placeholder="Name" class="required" type="text" maxlength="128" />

            </div>

            <div id="email_input">

            <input id="email" name="name" placeholder="Email"  class="required" type="text"  maxlength="128" />

            </div>

            <div id="budget_input">
            <label for="budget">Budget</label>
            <select id="mydropdown">
            <option value="none" selected=“”&gt; -- choose one --</option>
            <option value="firstchoice">$0 - $1,000</option>
            <option value="secondchoice">$1,000 - $2,000</option>
            <option value="thirdchoice">$3,000 +</option>
            </select>
            </div>

            <div id="button">

            <input type="submit" class="button" name="Submit" value="" />
            </div>

            </fieldset>

        </form> 
```

更新：

```
<?php 

$name = trim(stripslashes(htmlspecialchars($_POST['name'])));           
$email = trim(stripslashes(htmlspecialchars($_POST['email'])));
$mydropdown = trim(stripslashes(htmlspecialchars($_POST['mydropdown'])));  
$recipient = "blake.harrison1@cox.net";  
$humancheck = $_POST['humancheck'];
$honeypot = $_POST['honeypot'];

    if ($honeypot == 'http://' && empty($humancheck)) { 

    //Validate data and return success or error message
    $error_message = '';    
    $reg_exp = "/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9-]+\.[a-zA-Z.]{2,4}$/";

    if (!preg_match($reg_exp, $email)) {

                $error_message .= "<p>A valid email address is required.</p>";             
    }
    if (empty($name)) {

                $error_message .= "<p>Please provide your name.</p>";              
    }

    if (empty($mydropdown)) {

                $error_message .= "<p>Please select an item from the list.</p>";
    }               

    if (!empty($error_message)) {
                $return['error'] = true;
                $return['msg'] = "<h3>Oops! The request was successful but your form is not filled out correctly.</h3>".$error_message;                 
                echo json_encode($return);
                exit();
        } else {

        //send to  an email

        $emailSubject = 'Top Contact Form';
        $webMaster = 'blake.harrison1@cox.net';

 $body="
 <br><hr><br>
 <strong>Name:</stong> $name <br>
 <br>
 <strong>Email:</stong> $email <br>
 <br>
 <strong>Budget:</strong> $mydropdown <br>
 <br>
 ";      

        $headers = "From: $email\r\n";
        $headers .= "Content-type: text/html\r\n";

        //send email and return to user
        if(mail($webMaster, $emailSubject, $body, $headers)) {

            $return['error'] = false;
            $return['msg'] = "<p>Message sent successfully. Thank you for your interest " .$name .".</p>"; 
            echo json_encode($return);
        }
    }   
 } else {

$return['error'] = true;
$return['msg'] = "<h3>Oops! There was a problem with your submission. Please try again.</h3>";  
echo json_encode($return);
 }

?> 

$(document).ready(function() {

$('form #response').hide();

$('#submit').click(function(e) {

    // prevent forms default action until
    // error check has been performed
    e.preventDefault();

    // grab form field values
    var valid = '';
    var required = ' is required.';
    var name = $('form #name').val();
    var email = $('form #email').val();
    var mydropdown = $('form #mydropdown').val();
    var honeypot = $('form #honeypot').val();
    var humancheck = $('form #humancheck').val();

    // perform error checking
    if (name == '' || name.length <= 2) {
        valid = '<p>Your name' + required +'</p>';  
    }

    if (!email.match(/^([a-z0-9._-]+@[a-z0-9._-]+\.[a-z]{2,4}$)/i)) {
        valid += '<p>Your email' + required +'</p>';                                                  
    }

    if (mydropdown == '') {
        valid += '<p>An item from the list' + required +'</p>';

    }

    if (honeypot != 'http://') {
        valid += '<p>Spambots are not allowed.</p>';    
    }

    if (humancheck != '') {
        valid += '<p>A human user' + required + '</p>'; 
    }

    // let the user know if there are erros with the form
    if (valid != '') {

        $('form #response').removeClass().addClass('error')
            .html('<strong>Please correct the errors below.</strong>' +valid).fadeIn('fast');           
    }
    // let the user know something is happening behind the scenes
    // serialize the form data and send to our ajax function
    else {

        $('form #response').removeClass().addClass('processing').html('Processing...').fadeIn('slow');                                      

        var formData = $('form').serialize();
        submitForm(formData);           
    }           

});
});

function submitForm(formData) {

$.ajax({    
    type: 'POST',
    url: 'send.php',        
    data: formData,
    dataType: 'json',
    cache: false,
    timeout: 12000,
    success: function(data) {           

        $('form #response').removeClass().addClass((data.error === true) ? 'error' : 'success')
                    .html(data.msg).fadeIn('fast'); 

        if ($('form #response').hasClass('success')) {

            setTimeout("$('form #response').fadeOut('fast')", 12000);
        }

    },
    error: function(XMLHttpRequest, textStatus, errorThrown) {

        $('form #response').removeClass().addClass('error')
                    .html('<p>There was an<strong> ' + errorThrown +
                          '</strong> error due to a<strong> ' + textStatus +
                          '</strong> condition.</p>').fadeIn('fast');           
    },              
    complete: function(XMLHttpRequest, status) {            

        $('form')[0].reset();
    }
}); 
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T00:08:29.837

你能试试 $.post 而不是 $.ajax

```
$.post(url, {argument_name: value, ...} , function(data){

// callback function..

}, 'json'} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T00:26:15.253

使用 php 页面执行此操作...

```
 sleep(2);
  //Sanitize incoming data and store in variable
  $name = trim(stripslashes(htmlspecialchars($_POST['name'])));           
  $email = trim(stripslashes(htmlspecialchars($_POST['email'])));
  $message = trim(stripslashes(htmlspecialchars($_POST['message']))); 
  $recipient = "info@internetmarketingtrio.com";

//Validate data and return success or error message
$errors = array();   
$reg_exp = "/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9-]+\.[a-zA-Z.]{2,4}$/";

if (!preg_match($reg_exp, $email)) {

            $errors[] = "<p>A valid email address is required.</p>";             
}
if (empty($name) || $name == '') {

            $errors[] = "<p>Please provide your name.</p>";              
}           
if (empty($message) || $message == '') {

            $errors[] = "<p>A message is required.</p>";
}
if(empty($errors)) {
    $return['success'] = true;
    $return['message'] = "<p>Thanks for your feedback " .$name. ".</p>";
} else {
    $return['success'] = false;
    $return['message'] = "<h3>Oops! The request was successful but your form is not filled out correctly.</h3>";
    foreach($errors as $error) {
        $return['message'] .= $error ."<br />";
    }
} 
```

然后在您调用此页面时... ajax 调用...

```
$.ajax({    
type: 'POST',
url: 'feedback.php',        
data: formData,
dataType: 'json',
cache: false,
success: function(data) { 
    if(data.success) {
        $("form#response").removeClass().addClass('success').html(data.message).fadeIn('fast');
        removeResponse(5000);
    } else {
        $("form#response").removeClass().addClass('error').html(data.message).fadeIn('fast'); 
    }
}        
}); 

function removeResponse(time) {
    setTimeout(function() {
        $("form#response").fadeOut('fast');
    }, time);
} 
```

那应该可以

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T23:06:44.343

如果有人读到这个，将它添加到我的 php 底部最终解决了我的问题

```
 $emailSubject = 'Contact Form';
        $webMaster = 'blake.harrison1@cox.net';

$body="
<br><hr><br>
<strong>Name:</stong> $name <br>
<br>
 <strong>Email:</stong> $email <br>
 <br>
 <strong>Message:</stong> $message 
";      

        $headers = "From: $email\r\n";
        $headers .= "Content-type: text/html\r\n";

        //send email and return to user
        if(mail($webMaster, $emailSubject, $body, $headers)) {

            $return['error'] = false;
            $return['msg'] = "<p>Message sent successfully. Thank you for your intrest " .$name .".</p>"; 
            echo json_encode($return);
        }
    }   
} else {

$return['error'] = true;
$return['msg'] = "<h3>Oops! There was a problem with your submission. Please try again.</h3>";  
echo json_encode($return);
 }

 ?> 
```

# html - HTML5 是什么造就了这项技术？浏览器？

> ID：13924310
> 
> 赞同：0
> 
> 时间：2012-12-18T00:00:18.250
> 
> 标签：html

作为一个新手网络开发人员，我问；是什么让 html5 是什么？如果我们现在不需要flash、java或其他第三方软件来增强我们的网页浏览体验，这是否意味着我们的新浏览器必须支持这些功能？HTML(5) 的新进展是否只是与我们的浏览器签订合同以提供它们作为本机支持功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T00:07:26.000

是的，浏览器必须支持 HTML5 的特性才能实现和呈现它们。通常一些浏览器供应商，如 Mozilla、Google 或 Opera 会提出一些新功能，创建一些演示，然后当它被广泛使用时，它会被其他浏览器实现或进入 w3c 草案。

您可以在以下网址查看官方草案：[http](http://www.w3.org/TR/html5/) ://www.w3.org/TR/html5/ 。

# google-maps - 从 supportmapfragment 返回的空映射

> ID：13924311
> 
> 赞同：2
> 
> 时间：2012-12-18T00:00:23.790
> 
> 标签：google-maps

我正在尝试在我的 Android 应用程序中使用 Google Maps API v2。我已经使用以下代码以编程方式添加了地图片段，然后我尝试从我的 SupportMapFragment 获取 GoogleMap，但即使地图显示在屏幕上，我总是得到空结果...任何帮助都非常感谢！！！！！！ ！！

谢谢

```
public class MapActivity extends BaseFragmentActivity {

    private SchoolType mSchoolType=SchoolType.ALL;
    private GoogleMap mMap;
    private UiSettings mUiSettings;
    private SupportMapFragment mMapFragment;
    private static final String MAP_FRAGMENT_TAG = "map";
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        try{
            setContentView(R.layout.map_activity);
            mMapFragment = (SupportMapFragment) getSupportFragmentManager()
                    .findFragmentByTag(MAP_FRAGMENT_TAG);
            if(mMapFragment==null)
                addMapFragment();
            setUpMapIfNeeded();

        }
        catch(Exception ex){
            System.err.println("Exception: " + ex.getMessage());

        }

    }

    private void addMapFragment(){
        try{

            GoogleMapOptions options = new GoogleMapOptions();
            options.mapType(GoogleMap.MAP_TYPE_NORMAL)
                    .zoomControlsEnabled(true) ;

            mMapFragment =  SupportMapFragment.newInstance(options);
            FragmentTransaction transaction = getSupportFragmentManager().beginTransaction();
            transaction.add(R.id.fragment_map_content, mMapFragment,MAP_FRAGMENT_TAG);
            //transaction.addToBackStack(null);
            transaction.commit();
        }
        catch(Exception ex){
            System.err.println("Exception: " + ex.getMessage());
        }

    }

private void setUpMapIfNeeded() {
        // Do a null check to confirm that we have not already instantiated the map.
        if (mMap == null) {
            // Try to obtain the map from the SupportMapFragment.
            mMap =  mMapFragment.getMap(); ***//ALWAYS RETUN NULL***
            //mMap = ((SupportMapFragment) getSupportFragmentManager().findFragmentById(R.id.map))

            // Check if we were successful in obtaining the map.
            if (mMap != null) {
                setUpMap();
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T18:55:33.573

call setUpMapIfNeeded in onResume(), like this.

```
@Override
protected void onResume() {
    super.onResume();

    // In case Google Play services has since become available.
    setUpMapIfNeeded();
} 
```

# ruby - 如何在不需要 sudo 访问的情况下在 Ruby Mac OSX 应用程序中安装 gems？

> ID：13924315
> 
> 赞同：0
> 
> 时间：2012-12-18T00:01:06.723
> 
> 标签：ruby, macos

我正在尝试在 Ruby Mac OSX 应用程序中安装 gems。我有：

导出 GEM_HOME=/usr/local/...

但是，这需要我试图避免的 sudo 访问。你在哪里安装它，所以它安装在应用程序的目录中？在资源文件夹或其他地方？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T00:41:42.430

通常不希望应用程序修改它们自己的包（它们的应用程序目录）。除非您打算将这些 gem 作为应用程序的一部分发布，否则您可能应该在应用程序的“应用程序支持”目录中为它们创建一个 gem 主目录。

请参阅[https://developer.apple.com/library/mac/documentation/General/Conceptual/MOSXAppProgrammingGuide/AppRuntime/AppRuntime.html#//apple_ref/doc/uid/TP40010543-CH2-SW9](https://developer.apple.com/library/mac/documentation/General/Conceptual/MOSXAppProgrammingGuide/AppRuntime/AppRuntime.html#//apple_ref/doc/uid/TP40010543-CH2-SW9)

> 应用程序支持目录是您的应用程序存储支持该应用程序但不是应用程序运行所必需的任何类型文件的位置，例如文档模板或配置文件。这些文件应该是特定于应用程序的，但绝不应该存储用户数据。该目录位于 Library 目录中。
> 
> 切勿将文件存储在此目录的顶层：始终将它们放在以您的应用程序或公司命名的子目录中。
> 
> 如果资源适用于系统上的所有用户，例如文档模板，请将它们放在 /Library/Application Support 中。要获取此目录的路径，请使用带有 NSLocalDomainMask 域的 NSApplicationSupportDirectory 搜索路径键。如果资源是特定于用户的，例如工作区配置文件，请将它们放在当前用户的 ~/Library/Application Support 目录中。要获取此目录的路径，请使用带有 NSUserDomainMask 域的 NSApplicationSupportDirectory 搜索路径键。

# c# - Json.net反序列化错误

> ID：13924316
> 
> 赞同：1
> 
> 时间：2012-12-18T00:01:08.653
> 
> 标签：c#, .net

我正在将 JSON 字符串解析为 ObservableCollection，但是当我这样做时，Json.net 会抛出此错误：

> Newtonsoft.Json.JsonSerializationException：无法将当前 JSON 数组（例如 [1,2,3]）反序列化为类型“MVPTracker.ViewModels.DataModels+League+Position”，因为该类型需要 JSON 对象（例如 {"name":" value"}) 以正确反序列化。要修复此错误，请将 JSON 更改为 JSON 对象（例如 {"name":"value"}）或将反序列化类型更改为数组或实现集合接口的类型（例如 ICollection、IList），例如可以从 JSON 数组反序列化。JsonArrayAttribute 也可以添加到类型中以强制它从 JSON 数组反序列化。

我的数据模型、视图模型和加载如下：

数据模型：

```
public class League
    {
        public string name { get; set; }
        public string code { get; set; }
        public string imageUrl { get; set; }
        public Position positions = new Position();

        public class Position
        {
            public string name { get; set; }
            public string code { get; set; }
            public string imageUrl { get; set; }
            public string[] statistics { get; set; }
        }
    } 
```

加载/视图模型：

```
private ObservableCollection<DataModels.League> _leagues = new ObservableCollection<DataModels.League>();
    public ObservableCollection<DataModels.League> Leagues
    {
        get { return _leagues; }
        set { _leagues = value; NotifyPropertyChanged("Leagues"); }
    }

    public async void Load()
    {
        string leaguesJSON = await ServerConnector.LoadOrganizations();

        Leagues.Clear();
        Leagues = JsonConvert.DeserializeObject<ObservableCollection<DataModels.League>>(leaguesJSON);
    } 
```

我尝试将 ObservableCollection 设置为 IList/ICollection 无济于事。

编辑：这是我正在解析的 json：http: [//pastebin.com/QVnikitV](http://pastebin.com/QVnikitV)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T00:14:39.810

您`positions`在 C# 代码中的字段表示类型的单个对象`Position`。您的 JSON 对象的`positions`字段代表一个数组。

因此，您的 C# 代码需要更改为数组以匹配：

```
public Position[] positions { get; set; } 
```

# g++ - 如何将 libsndfile 编译到项目中？

> ID：13924318
> 
> 赞同：1
> 
> 时间：2012-12-18T00:01:16.880
> 
> 标签：g++, libsndfile

我正在尝试使用 libsndfile。我对 g++ 也不是很好。安装 libsndfile 的方法似乎是使用“make install”。我真的可以做到，所以我将它编译到一个目录中。

我试图在这里编译教程：http:
[//parumi.wordpress.com/2007/12/16/how-to-write-wav-files-in-c-using-libsndfile/](http://parumi.wordpress.com/2007/12/16/how-to-write-wav-files-in-c-using-libsndfile/)

当我尝试以下操作时：

```
g++  -Isrc/ test.c 
```

我得到：

```
/tmp/ccq5fhbT.o: In function SndfileHandle::SndfileHandle(char const*, int, int, int, int)':
test.c:(.text._ZN13SndfileHandleC1EPKciiii[SndfileHandle::SndfileHandle(char const*, int, int, int, int)]+0xf4): undefined reference to sf_open'
/tmp/ccq5fhbT.o: In function SndfileHandle::write(float const*, long)':
test.c:(.text._ZN13SndfileHandle5writeEPKfl[SndfileHandle::write(float const*, long)]+0x27): undefined reference to sf_write_float'
/tmp/ccq5fhbT.o: In function SndfileHandle::SNDFILE_ref::~SNDFILE_ref()':
test.c:(.text._ZN13SndfileHandle11SNDFILE_refD1Ev[SndfileHandle::SNDFILE_ref::~SNDFILE_ref()]+0x20): undefined reference to sf_close'
collect2: ld returned 1 exit status 
```

当我尝试执行以下操作时：

```
g++ -lsndfile -Isrc/ test.c 
```

我明白了

```
/usr/bin/ld: cannot find -lsndfile
collect2: ld returned 1 exit status 
```

我不确定我需要给 g++ 哪些开关。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-18T04:05:12.827

如果您使用以下命令配置和安装 libsndfile：

```
./configure --prefix=$HOME/local
make
make install 
```

然后你应该设置/修改你的 LD_LIBRARY_PATH 变量：

```
export $LD_LIBRARY_PATH=$HOME/local/lib 
```

然后编译

```
g++ -I $HOME/local/include -L $HOME/local/lib -lsndfile testsnd.c -o  testsnd 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T00:14:40.827

在 GNU/Linux Debian 挤压中，我安装了 libsndfile1 库，程序编译没有问题。

```
# apt-get install libsndfile1-dev
$ g++ -w -o testsnd testsnd.c -lsndfile 
```

您需要使用包管理器或从源代码安装库。

# iphone - 链接 iOS 胖库后出现“_OBJC_CLASS_$_NgnEngine”错误

> ID：13924319
> 
> 赞同：0
> 
> 时间：2012-12-18T00:01:34.437
> 
> 标签：iphone, ios

为什么即使在链接胖库后我仍然收到此错误

```
Undefined symbols for architecture i386:
  "_OBJC_CLASS_$_NgnEngine", referenced from:
      objc-class-ref in ViewController.o
ld: symbol(s) not found for architecture i386
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

并链接“用户定义”中的所有内容

![在此处输入图像描述](../Images/12727059d0e0492a679a3f2b02cc51fa.png)

![在此处输入图像描述](../Images/a7450136c8a5a51cf08bdea2b56161a6.png)

![在此处输入图像描述](../Images/e3e2d3c7c9c7729cffc4473c5161b8de.png)

![在此处输入图像描述](../Images/8a1028020849d7901c0fdf164dd6f7c0.png)

我正在按照此处编写的说明将[ios-ngn-stak 链接到您的应用程序](http://code.google.com/p/idoubs/wiki/Building_iDoubs_v2_x) ，请提供任何帮助，这让我很累，这是我的高级项目

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T04:52:01.850

如果您的问题，请参考这两个链接以获得解决方案：-

[错误：“_OBJC_CLASS_$_NgnEngine”](https://stackoverflow.com/questions/13886753/error-objc-class-ngnengine)

[Xcode with iOS - 以易于在调试模式下运行、分发、迭代的方式创建库](https://stackoverflow.com/questions/13264847/xcode-with-ios-creating-a-library-in-a-way-that-is-easy-to-run-in-debug-mode)

# perforce - 右键菜单不显示在 perforce

> ID：13924323
> 
> 赞同：1
> 
> 时间：2012-12-18T00:02:03.593
> 
> 标签：perforce

我正在通过 VPN 网络工作并连接到 perforce。有时，当我右键单击“仓库”旁边的“工作区”选项卡下的顶部节点时，不会出现下拉菜单。当这种情况经常发生时，文件 > 操作淹没主菜单也会变灰。这最终恢复了生命，右键菜单也是如此，但现在我等待了一个多小时，但右键菜单仍然显示。有没有人看到这个问题并且有解决方法吗？

# c# - 向 WP8 应用程序添加宽磁贴

> ID：13924325
> 
> 赞同：0
> 
> 时间：2012-12-18T00:02:12.603
> 
> 标签：c#, windows, windows-phone-7, windows-phone-7.1, windows-phone-8

如何向我的 WP8 应用程序添加宽磁贴（从 wp 7.1 升级）？

我尝试遵循以下指南：

[http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj720574(v=vs.105).aspx](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj720574(v=vs.105).aspx)

但我无法让它工作。WMAppManifest.xml 也没有 Wide Tile 选项。我可以添加的唯一图像是小、中和大

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T00:58:54.093

您参考的文章是关于从 Windows Phone 7.1 项目中启用 Windows Phone 8 设备上的宽磁贴。您的 7.1 应用程序仍然可以安装在 WP8 上。如果您的应用程序已升级到 Windows Phone 8 项目，则使用[Flip Tile 模板](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj206971%28v=vs.105%29.aspx)设置 WideBackContent 和 WideBackground 图像。

```
FlipTileData TileData = new FlipTileData()
{
   Title = "[title]",
   BackTitle = "[back of Tile title]",
   BackContent = "[back of medium Tile size content]",
   WideBackContent = "[back of wide Tile size content]",
   Count = [count],
   SmallBackgroundImage = [small Tile size URI],
   BackgroundImage = [front of medium Tile size URI],
   BackBackgroundImage = [back of medium Tile size URI],
   WideBackgroundImage = [front of wide Tile size URI],
   WideBackBackgroundImage = [back of wide Tile size URI],
}; 
```

否则，如果你真的有 7.1 的项目，我推荐[Mangopollo 项目](http://mangopollo.codeplex.com/)以简化流程。Thomas Fennel的[//Build/ 会议](http://channel9.msdn.com/Events/Build/2012/2-019)可能会有所帮助。

# c++ - 空基类构造开销？

> ID：13924326
> 
> 赞同：2
> 
> 时间：2012-12-18T00:02:13.333
> 
> 标签：c++, optimization, inheritance, c++11, compiler-optimization

考虑以下代码：

```
#include <iostream>
#include <type_traits>

class Base
{
    public: static int f() {return 42;}
};

class Derived : public Base
{
    protected: int x;
};

class NotDerived
{
    protected: int x;
};

int main()
{
    std::cout<<sizeof(Base)<<std::endl;
    std::cout<<sizeof(Derived)<<std::endl;
    std::cout<<sizeof(NotDerived)<<std::endl;
    return 0;
} 
```

使用 g++ 4.7 -O3，它会打印：

```
1
4
4 
```

如果我理解得很好，这意味着启用了空基类优化。

但是我的问题涉及运行时开销：由于应该构造/销毁相应的对象，`Derived`与对象相比是否有任何开销创建（和销毁）对象？`NotDerived``Derived``Base`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T00:15:09.843

虽然该标准不保证在那里我会考虑一个编译器在这些情况下做一些不同的事情略有缺陷。

从字面上看，不需要做任何事情来初始化基础：不需要初始化内存，不需要设置虚拟调用机制。不应为其生成任何代码。

但是，如果这对您来说真的很重要，您应该始终在非平凡的设置中检查某些程序集。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T00:13:39.903

对此的任何答案都将取决于实现，因为标准仅指定语义。

但是，打开任何现代编译器和优化，我希望完全没有区别。

没有要分配的额外内存，没有要运行的额外代码，在构造过程中没有要更改的 vtable 指针，因为额外的基础不是虚拟的。您`Derrived`和`NotDerrived`构造函数很可能是指令对指令相同的。

关闭所有优化后，您可能会在某些平台上调用空`Base::Base()`函数，但您真的不应该担心未优化构建的性能。

* * *

我在 gcc.godbolt.org 上做了一个小演示：http: [//tinyurl.com/cg8ogym](http://tinyurl.com/cg8ogym)

简而言之

```
 extern void marker______________________________________();
    // ... 
    marker______________________________________();
    new NotDerived;
    marker______________________________________();
    new Derived;
    marker______________________________________(); 
```

编译为

```
call    marker______________________________________()@PLT
movl    $4, %edi
call    operator new(unsigned long)@PLT
call    marker______________________________________()@PLT
movl    $4, %edi
call    operator new(unsigned long)@PLT
call    marker______________________________________()@PLT 
```

如果你把它切换到clang，它甚至会优化内存分配

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T10:12:04.143

```
#include <type_traits>
#include <unistd.h>

class SlowBase
{
    SlowBase() { ::sleep(5); }

    public: static int f() {return 42;}
};
static_assert( std::is_empty<SlowBase>::value , "SlowBase is empty" ); 
```

类`Base`需要**五秒钟来构建**！

```
#include <type_traits>

class FatBase
{
    FatBase() = default;
    int data[1024*1024];    
    public: static int f() {return 42;}
};
static_assert( !std::is_empty<FatBase>::value , "FatBase is not empty" ); 
```

但这一个不需要时间！

我的观点是，构造开销与类的大小无关，它与构造函数的*作用*有关。 `SlowBase`是一个空类，但构造起来很慢。`FatBase`大小为兆字节，但甚至不会将数组元素归零，因此无关紧要。

在您的`Base`示例中，有一个隐式声明的微不足道的默认构造函数，因此它无关紧要。

# jquery - 点击两次返回上一页

> ID：13924329
> 
> 赞同：1
> 
> 时间：2012-12-18T00:03:06.010
> 
> 标签：jquery

我有这个脚本

```
$('#verder').click(function(){
    if(document.referrer.indexOf(window.location.hostname) != -1){
        parent.history.back();
        return false;
    }
}); 
```

所以点击#verder它会像你在浏览器的后退按钮上点击一样返回。

所以现在我的问题我需要让它回去 2 次。

我怎样才能解决这个问题？

先感谢您！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-18T00:05:08.713

[`History.go`](https://developer.mozilla.org/en-US/docs/DOM/window.history#go)可以这样做：

```
parent.history.go(-2); 
```

# javascript - 使用航点从顶部窗口偏移的粘性 div

> ID：13924330
> 
> 赞同：1
> 
> 时间：2012-12-18T00:03:06.163
> 
> 标签：javascript, jquery, offset, sticky

我希望有人可以提供帮助。我绝不是程序员，我正在尝试学习如何创建与正常情况略有不同的粘性 div。这就是我想要实现的目标：

*   当 div #projectwrapper 向上滚动屏幕并且距离窗口顶部 150px 时，它应该在页面的其余部分滚动时停留并停留在那里
*   向下滚动页面时，div 应返回到页面中的正常位置。

我一直在尝试演示和示例，我几乎可以让它工作。但它只会在它到达窗口的最顶部时被激活，并且它会粘在最顶部。但是我需要激活并坚持从顶部开始 150 像素。

这就是我到目前为止所拥有的。

```
$(document).ready(function() {
$('#projectwrapper').waypoint(function(event, direction) {
}, {
    offset: 150
}).find('#projectdescription').waypoint(function(event, direction){
    $(this).parent().toggleClass('sticky', direction === "down");
    event.stopPropagation();
});
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T11:34:42.293

我没用过航点。您可以使用一些简单的 jQuery：

```
 var projectWrapperPosition = $('#projectwrapper').position().top; //div position
  $(window).scroll(function() { //when window scrolls
    if($(window).scrollTop() > (projectWrapperPosition - 150)) //check if position of the window is 150px or smaller than the position of specified div has
     $('#projectwrapper').addClass('change-position'); //.change-position position fixed the div
     else
      $('#projectwrapper').removeClass('change-position');

  }); 
```

CSS：

```
.change-position {
  top:150px;
  position:fixed;
  width:100%;
  background:red;
} 
```

**查看demo： http:** [//jsbin.com/uxizab/2/](http://jsbin.com/uxizab/2/)（滚动查看效果）

# c++ - C ++：将矩阵类的元素复制到数组

> ID：13924331
> 
> 赞同：0
> 
> 时间：2012-12-18T00:03:09.580
> 
> 标签：c++

我有这个方法（Matrix::WriteToArray(double &CopyOfArray)），我想将Matrix 对象中的一个数组的副本写入一个双精度数组（即CopyOfArray）。我在编译时遇到了麻烦。

任何帮助表示赞赏。谢谢

错误：

```
$ make
g++ -g -Wall -c main.cpp
main.cpp: In function ‘int mrstart(double, double*, Matrix&, Matrix&)’:
main.cpp:459:13: error: ‘cff’ declared as reference but not initialized
main.cpp:465:45: error: invalid type argument of unary ‘*’
main.cpp:467:73: error: invalid type argument of unary ‘*’
main.cpp:470:77: error: invalid type argument of unary ‘*’
Makefile:20: recipe for target `main.o' failed
make: *** [main.o] Error 1 
```

以下是支持文件： Main.cpp

```
int mrstart(double hcen, double mr[],  Matrix &a,  Matrix &HT)
{
    double *cff;
    a.WriteToArray(&cff);
    /*...*/
} 
```

矩阵.cc

```
int Matrix::WriteToArray(double &CopyOfArray){
    int i;
    for(i=0;i<n_rows;i++){
        CopyOfArray[i]=array[i*n_cols];
        i++;
    }
    return *CopyOfArray;
} 
```

矩阵.hh

```
#ifndef MATRIX_H
#define MATRIX_H
// Matrix class of variable size
class Matrix {

private:
    int n_rows;
    int n_cols;
    double *array;

public:
    // Constructors
    Matrix(); // default constructor
    Matrix(int rows, int cols); // two-argument constructor
//  Matrix(const Matrix &arr); // copy constructor

    // Destructor
    ~Matrix();

    // Mutators
//  void add(Matrix m2);
//  void subtract(Matrix m2);
    void setelem(int r, int c, double val);

    // Accessors
//  void add(Matrix m2);
//  void subtract(Matrix m2);
    int getrows();
    int getcols();
    double getelem(int r, int c);
    bool equals(Matrix m2);
    char display();
    int WriteToArray(double &CopyOfArray);

};
#endif 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T00:25:34.093

你要

```
int Matrix::WriteToArray(double CopyOfArray[], const int size){
    //make sure size >= n_rows then copy
} 
```

并这样称呼它

```
double cff[MAX_SIZE] = {};
a.WriteToArray(cff); 
```

您应该真正使用 std::vector 而不必担心动态分配。

编辑：好的，如果你真的想要，你可以手动分配，但要小心释放它：

```
double* cff = 0;
a.WriteToArray(cff);
//do stuff with cff
delete [] cff; 
```

在你里面写函数

```
int Matrix::WriteToArray(double *dest){
 dest = new double[n_rows];
 //copy data into dest
} 
```

最主要的是确保在 main 中使用完 dest 后删除它，这样就不会出现内存泄漏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T00:49:57.843

```
double *cff;
a.WriteToArray(&cff); 
```

您正在声明一个指针，然后在初始化它之前使用它。您正在向函数传递一个不指向任何内容的指针。如果您在编译时知道数组的大小，您应该静态声明数组

```
double cff[16]; // 4x4 array, for example
a.WriteToArray(cff); 
```

或在调用函数之前适当调整大小。

```
double * cff = new double[n_rows * n_cols];
a.WriteToArray(cff); 
```

其他一些批评：您的函数期望引用 double 作为参数。如果你想接收一个数组，通常的方法是请求一个指针。更好的方法是根本不使用它们并使用某种方式的智能指针。

方法本身也坏了。

```
CopyOfArray[i]=array[i*n_cols];
i++; 
```

这将导致您写入数组中每一行的第一个元素，并在它们之间留出一个空格。

你需要一个嵌套循环。你也不应该返回任何东西，你已经在写入参数数组，所以返回值是多余的。您也不应该将指针作为 int 返回，而应将其作为指针返回。不过，更好的是，您可以在方法中初始化指针，然后返回指针并在调用它的地方捕获它。

您还假设数组的大小正确，正如您自己的示例所证明的那样，这是不正确的。您应该始终初始化指针。至少将它们指向 0，如下所示：

```
double *cff = NULL; // = 0 also works, but I like pointing pointers to NULL 
```

该方法，尽可能多地修复，如下：

```
double * Matrix::WriteToArray(){
    double * CopyOfArray = NULL;
    CopyOfArray = new double[n_rows*n_cols];
    int i, j;
    for(i=0;i<n_rows;i++){
        for(j=0;j<n_cols;j++){
        CopyOfArray[i*n_rows+j]=array[i*n_rows+j];
        i++;
        }
    }
    return CopyOfArray;
} 
```

然后像这样调用它：

```
double *cff = NULL;
cff = a.WriteToArray(); 
```

警告：如果您在不存储返回值的情况下调用该方法，您将泄漏内存。不要使用指针，了解智能指针。

# java - 如何优化 AppEngine Java/JDO 数据存储 put() 以使用更少的写入

> ID：13924333
> 
> 赞同：5
> 
> 时间：2012-12-18T00:03:25.990
> 
> 标签：java, google-app-engine, jdo

我正在调整我们在 App Engine 上运行的应用程序，最大的成本之一是数据存储读取和写入。我注意到写入的最大违规者之一是当我们坚持订单时。

基本数据是 Order 有很多项目 - 我们分别存储并将它们关联起来，如下所示：

```
@PersistenceCapable
public class Order implements Serializable {

     @Persistent(mappedBy="order")
     @Element(dependent = "true")
     private List<Item> orderItems;

     // other fields too obviously
}

@PersistenceCapable
public class Item implements Serializable {

     @Persistent(dependent = "true")
     @JsonIgnore
     private Order order;

     // more fields...

} 
```

appstats 显示了针对单个项目的订单的两个数据存储放置 - 但两者都使用大量写入。我想从任何有经验的人那里了解优化这一点的最佳方法。

AppStats 数据：

> 真实=34ms api=1695ms 成本=6400 billed_ops=[DATASTORE_WRITE:64]
> 
> 实际=42ms api=995ms 成本=3600 billed_ops=[DATASTORE_WRITE:36]

![appstats 请求信息](../Images/25740bea5508d8b8c50b5ea6cec9bac7.png)

我知道的一些领域可能会有所帮助：

1.  更少的索引 - 我可以告诉 appengine 不要索引的一些订单和项目属性的隐含索引，例如 item.quantity 不是我需要查询的东西。但这就是所有这些写作的目的吗？
2.  取消关联项目和订单，这样我就只有一个实体 OrderItem，完全不需要关系（但需要用额外的存储空间付费）。
3.  就显式索引而言，我在订单表上只有 1 个，按订单日期，一个在订单项上，按 SKU/日期，隐含一个关系。
4.  如果这些项目是一个集合，而不是一个列表，那会完全消除对子 _IDX 索引的需要吗？

所以，我的问题是，上述任何项目是否预示着重大胜利，还是我错过了其他一些更好的选择？

加分点：某处是否有很好*的“减少数据存储写入指南”文章？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T07:23:20.480

[计费文档](https://developers.google.com/appengine/docs/billing#Billable_Resource_Unit_Costs)明确指出：

*   新实体放置（每个实体，无论实体大小）：2 次写入 + 每个索引属性值 2 次写入 + 每个复合索引值 1 次写入

*   现有实体放置（每个实体）：1 次写入 + 每个修改的索引属性值 4 次写入 + 每个修改的复合索引值 2 次写入

*   同样相关：[App Engine 为实体的每个属性预定义了一个简单的索引。](https://developers.google.com/appengine/docs/java/datastore/indexes)

关于问题：

1.  是的，写入操作的数量与索引属性的数量有关。使它们[未编入索引以保存写入操作](https://developers.google.com/appengine/docs/java/datastore/indexes#Unindexed_Properties)。
2.  将两个实体组合在一起将为您节省 1 次写入（如果是新实体，则为 2 次）。
3.  您不需要仅为一个属性设置“显式”索引。这些是由 appengine 自动生成的。您只需要显式配置复合索引，涵盖更多属性。
4.  不。集合或列表（= 有顺序的集合）只是 Java 表示，Datastore API 始终在内部使用列表（= 添加的项目保留其顺序）。

**更新：**

索引数量会影响写入成本，但不会影响速度。[写入分两个阶段完成](https://developers.google.com/appengine/articles/life_of_write)：保存实体数据的提交阶段和构建索引的应用阶段。操作在提交阶段后返回，`put`不受索引数量的影响。

在您的情况下，您一个接一个地跟注两个看跌期权。正如您从 AppStats 图表中看到的那样，它们是连续发生的。您可能希望将它们作为[异步操作](https://developers.google.com/appengine/docs/java/datastore/async)并行执行（不确定在 JDO 中是​​否可用）。

# c++ - 平衡KD树

> ID：13924334
> 
> 赞同：3
> 
> 时间：2012-12-18T00:03:30.237
> 
> 标签：c++, tree, median, kdtree, tree-balancing

因此，在平衡 KD 树时，您应该找到中位数，然后将所有较小的元素放在左子树上，将较大的元素放在右边。但是，如果您有多个元素的值与中位数相同，会发生什么？它们进入左子树，右子树还是丢弃它们？

我问是因为我尝试过做多件事，它会影响我最近邻搜索算法的结果，并且在某些情况下，树的给定部分的所有元素都将具有完全相同的值，所以我不知道在这种情况下如何将它们分开。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T23:12:02.077

你把它们放在哪里并不重要。最好保持你的树平衡。因此，根据需要在左侧放置尽可能多的位置以保持最佳平衡！

如果您当前的搜索半径*触及*中位数，您将不得不检查另一部分，这就是您在另一侧处理捆绑对象所需的全部内容。这通常比在任何地方附加多个元素的复杂处理便宜。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T00:59:30.667

在进行搜索风格算法时，将等于中位数的元素放在中位数的两侧通常是一个好主意。

一种方法是将中值相等的元素放在与分区之前相同的位置。另一种方法是将第一个放在左侧，将第二个放在右侧，依此类推。

另一种解决方案是拥有一个集群数据结构，它只是“计算”相等的事物，而不是单独存储每个事物。（如果他们有额外的状态，那么你可以存储额外的状态而不仅仅是一个计数）

不知道哪个适合你的情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-23T19:37:35.027

这取决于你的目的。

对于精确匹配或范围搜索等问题，在两边重复相同值的可能性会使查询复杂化，并且在两个叶子上重复相同值会增加时间复杂度。

一个解决方案是在节点上存储所有的中位数（等于中位数的值），既不左也不右。kd 树的大多数变体都将中值存储在内部节点上。如果它们碰巧很多，您可以考虑使用另一棵 (k-1)d 树作为中位数。

# c# - C# 在使用大量 CPU 的线程上运行服务器

> ID：13924340
> 
> 赞同：2
> 
> 时间：2012-12-18T00:04:25.993
> 
> 标签：c#, tcpserver

我正在尝试编写一个投票服务器和客户端，因此您启动程序并显示投票表格，您可以对各种项目进行投票。对于服务器部分，我让服务器在单独的线程中运行，但它使用了大量 CPU，如何减少它使用的 CPU 量？

这是我的服务器：

```
 Form1 main = new Form1();

        try
        {
            IPAddress ipAd = IPAddress.Parse(main.ipAddress); //use local m/c IP address, and use the same in the client

            /* Initializes the Listener */
            TcpListener myList = new TcpListener(ipAd, 55548);

            /* Start Listeneting at the specified port */
            myList.Start();

            while (true)
            {
                string message = "";
                Socket s = myList.AcceptSocket();

                if (main.users.Contains(s.RemoteEndPoint.ToString()) == false)
                    main.users.Add(s.RemoteEndPoint.ToString());

                byte[] b = new byte[500];
                int k = s.Receive(b);

                for (int i = 0; i < k; i++)
                {
                    message += (Convert.ToString(b[i]));
                }

                string[] messageArray = message.Split('/');

                MessageBox.Show("help");

                if (messageArray[0].CompareTo("vote") == 0)
                {

                    if (main.votes.ContainsKey(messageArray[1]) != true) main.votes.Add(messageArray[1], 1);
                    else main.votes[messageArray[1]]++;

                    string[] temp = main.textBox1.Text.Split(' ');
                    int numVotes = Convert.ToInt32(temp[1]);
                    numVotes++;
                    main.textBox1.Text = temp[0] + " " + Convert.ToString(numVotes);

                }
                if (messageArray[0].CompareTo("start") == 0)
                {
                    main.updateEverything();
                }
                if(messageArray[0].CompareTo("withdraw") == 0)
                {
                    main.votes[messageArray[1]]--;

                    string[] temp = main.textBox1.Text.Split(' ');
                    int numVotes = Convert.ToInt32(temp[1]);
                    numVotes--;
                    main.textBox1.Text = temp[0] + " " + Convert.ToString(numVotes);
                }

                /* clean up */
                s.Close();
                myList.Stop();
            }
        }
        catch (Exception e)
        {
            Console.WriteLine("Error..... " + e.StackTrace);
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T00:19:05.510

您正在使用阻塞类型的连接。由于 TcpListener.AcceptConnection()，您创建的循环会导致 CPU 开销。您的解决方案是接受非阻塞套接字连接，这是通过从套接字异步接收数据来完成的。

这是解释其工作原理的 msdn 链接。 [http://msdn.microsoft.com/en-us/library/dxkwh6zw.aspx](http://msdn.microsoft.com/en-us/library/dxkwh6zw.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T00:14:21.497

我看到您的字符串连接基本上会影响性能；尝试使用 StringBuilder - message 变量应该是 StringBuilder 类型。

# actionscript-3 - 使用 localToGlobal 切换图像位置

> ID：13924344
> 
> 赞同：1
> 
> 时间：2012-12-18T00:05:00.230
> 
> 标签：actionscript-3

我正在尝试将父容器的坐标转换为全局舞台坐标。这是对象和容器：

```
 imgSprite.addChild(imgInstance); //imgInstance is imported from class
 imageContainer.addChild(last); 
 imageContainer.addChild(imgSprite); // imgSprite and last are to be replaced 
```

基本上，我想在`imageContainer`.

我应用了该`localToGlobal()`功能，但没有任何效果。我做错了什么？

这是我替换它们的功能。注意：此代码属于 class `main`，容器的父级是 stage ，并且 each`imgSprite`只是添加`imgContainer`和移动 via `obj.x`，`obj.y`（不在代码中）。

```
function click(e:MouseEvent):void {     
    var p1:Point = e.currentTarget.localToGlobal(newPoint(e.currentTarget.x, e.currentTarget.y));
    var p2:Point = last.localToGlobal(new Point(last.x, last.y));
    e.currentTarget.x = globalToLocal(p2).x; 
    e.currentTarget.y = globalToLocal(p2).y;
    last.x = globalToLocal(p1).x;
    last.y = globalToLocal(p1).y;
} 
```

据我了解，每个对象都有本地和全局位置。因此，在这里我将本地位置转换为全局位置，然后当将另一个对象移动到该位置时，我再次将其转换为本地位置，因为它们属于同一个父级，它应该导致匹配的坐标，但是我的图像开始四处乱飞在各个方向，我开始拉我的头发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T16:08:31.430

```
var p2:Point = last.localToGlobal(new Point(last.x, last.y)); 
```

应该

```
var p2:Point = last.localToGlobal(new Point(0, 0)); 
```

内的`Point`参数`localToGlobal()`是`DisplayObject`您要全球化的点。因此，如果`last`位于其父容器内的 (50,50) 处，则您的代码实际上是在请求 (50,50) 内的全局坐标`last`。在这种情况下，(0,0)*是*( `last.x`, `last.y`)。

# php - 无法更新mysql数据库

> ID：13924345
> 
> 赞同：0
> 
> 时间：2012-12-18T00:05:02.300
> 
> 标签：php, mysql, database, login

我正在构建一个登录系统（PHP）。我正在尝试根据随机代码和它们的到期日期制作密码恢复脚本。当我尝试将生成的随机代码添加到数据库时，没有任何反应。这是我的代码：

忘记密码.php

```
function procForgotPass(){
  global $database, $session, $mailer, $form;

  $subuser = $_POST['user'];

     //$expdate=Date('y:m:d', strtotime("+1 day"));
    $password_token= urlencode($this->nonce());
    $database->addkey($subuser, $password_token, "2012-12-19 13:37:14");
} //THE CODE IS LONGER, JUST MAKING IT SIMPLE

function nonce($size=32){//256 bit == 32byte. 
$ret="";
for($x=0;$x<$size;$x++){
    $ret.=chr(mt_rand(0,255));
}
return base64_encode($ret); } 
```

数据库.php

```
function addkey($username, $key, $date){
  $w = "INSERT INTO ".TBL_CODES." (username, Key, expDate) VALUES ('$username', '$key', '$date')";
  return mysql_query($w, $this->connection); } 
```

我不会发布 connection() 因为它正在工作（我可以注册用户等）。会是什么？

我可以执行这样的代码来创建用户，但这一个不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T00:07:57.997

您需要输入：

```
`key` 
```

不是

```
key 
```

Word`key`在 MySQL 中是保留的。

# php - 是否可以将 unicode 数字与 mysql int 列进行比较？

> ID：13924347
> 
> 赞同：1
> 
> 时间：2012-12-18T00:05:11.803
> 
> 标签：php, mysql, internationalization

我有一个带有整数值的表。在我的应用程序中有一个文本字段，用户可以输入他想要的号码进行搜索。如果用户输入英文数字没有问题。但是如果他的键盘不是英文并且输入了一个存在于表 mysql 中的数字，则找不到它。***我无法更改应用程序以将用户输入转换为英文数字***。有没有办法在mysql（配置，表结构等）中解决这个问题？

例如我在数据库中有这条记录：

`Order_number = 112, ...`

如果用户用英文搜索 112，mysql 返回上面的行。但是如果用户输入 112 例如在 persian(112) mysql 将返回一个空集。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T01:10:30.797

不是直接的。

```
mysql> SELECT CAST(112 AS CHAR) = '۱۱۲' COLLATE utf8_unicode_ci;
+------------------------------------------------------+
| CAST(112 AS CHAR) = '۱۱۲' COLLATE utf8_unicode_ci    |
+------------------------------------------------------+
|                                                    1 |
+------------------------------------------------------+
1 row in set (0.00 sec) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T01:13:50.640

最坏的情况，你可以做类似的事情

```
... where 112 = replace('۱', 1, replace('۲', 2, 'user input here')); 
```

我假设所有输入在其数字表示中都有 10 个不同的数字，只是它们使用不同的字符来表示数字。

# excel - VBA 查找 - 无法获取 WorkSheet 函数类的 Vlookup 属性

> ID：13924349
> 
> 赞同：1
> 
> 时间：2012-12-18T00:05:45.237
> 
> 标签：excel, vba

我知道这里已经讨论过一个类似的问题：[为什么 VBA 中的 VLookup 失败并出现运行时错误 1004？](https://stackoverflow.com/questions/11055687/why-is-vlookup-in-vba-failing-with-runtime-error-1004)

但似乎没有解决我的问题。快速解释我想在这里做什么 - 这是我的第一篇 VBA 帖子，所以如果有任何问题清晰等问题，请告诉我。

我正在尝试构建一张发票表，该发票表基于

*   项目编号（在本例中为 1）
*   所有项目数据的数据集

每个项目活动都显示为一个单独的行项目，并由一个唯一标识符标识，由项目编号和行项目编号组成（因此对于项目一中的第三个行项目，它将是“1/3”）。标识符被格式化为字符串。所有输入数据都在名为“输入”的工作表上。

第二张表是称为“发票”的实际发票表。这个想法是根据每个项目的行项目数（仍在处理这部分）自动获得正确数量的空白行，并自动填写表格。最后一部分是当我尝试`vlookup`在第 80 行运行时产生错误的部分：错误消息是

> 无法获取 WorksheetFunction 类的 Vlookup 属性。

我想知道这是否是由查找值（标识符）引起的，因为我没有正确创建它？到目前为止，我已经查看了此处讨论的解决方案，但找不到答案:(

在此先感谢您的帮助！下面的代码：

```
Option Explicit

Sub Count_Line_Items()

'Counts the number of line items of a consulting project to determine the space needed on the invoice form

     Dim Cell As Range
     Dim PosCnt As Integer
     Dim ServCnt As Integer
     Dim ExpCnt As Integer

     PosCnt = 0
     ServCnt = 0
     ExpCnt = 0

    'Counting all project positions for the chosen project number
    For Each Cell In Range("ProjectList")
       If Cell.Value = Range("IdSelect") Then
           PosCnt = PosCnt + 1
        End If
    Next Cell

    MsgBox "Total number of line items: " & PosCnt

    'Counting all positions of that project that are consulting services
    For Each Cell In Range("ProjectList")
       If Cell.Value = Range("IdSelect").Value And Cell.Offset(0, 3).Value = "Service" Then
        ServCnt = ServCnt + 1
       End If
    Next Cell

    MsgBox "Total number of consulting services: " & ServCnt

    'Calculating number of expense items
    ExpCnt = PosCnt - ServCnt

    MsgBox "Total number of expenses: " & ExpCnt

End Sub

Sub Count_Total_Rows()

    Dim Current_RowCnt As Integer
    Dim Target_RowCnt As Integer
    Dim Diff_Rows As Integer

    Target_RowCnt = 62

    'Counting the rows in the print area and calculating difference to target
    Range("Print_Area").Select
    Current_RowCnt = Selection.Rows.Count
    Diff_Rows = Target_RowCnt - Current_RowCnt
        If Diff_Rows > 0 Then
            MsgBox "We need to add " & Diff_Rows & " rows!"
        ElseIf Diff_Rows < 0 Then
            MsgBox "We need to delete " & -Diff_Rows & " rows!"
        Else
            MsgBox "Nothing needs to be done; all good!"
        End If
End Sub

Sub Write_Services()
'Looks up services on data sheet and writes them to invoice sheet
    Dim Cnt As Integer
    Dim ServCnt As Integer
    Dim PosIdent As String
    Dim Data As Range

    Cnt = 0
    'Building position identifier
    PosIdent = "IdSelect" & "/" & Cnt + 1
    Sheets("Input").Select
    ActiveSheet.Range("D26:AD151").Select
    Set Data = Selection

    Sheets("Invoice").Select
    ActiveSheet.Range("Service_Title").Offset(1, 0).Activate
    'There is still an issue with the counter (line number won't increment by 1 if cnt range is incremented by 1
    For Cnt = 0 To ServCnt + 1
        ActiveCell.Value = Application.WorksheetFunction.VLookup(PosIdent, Data, 15, False)
        ActiveCell.Offset(1, 0).Activate
        Cnt = Cnt + 1
    Next Cnt
End Sub 
```

**更新：**我现在已将最后一个过程中的代码更改为：

```
Sub Write_Services()
'Looks up services on data sheet and writes them to invoice sheet
Dim Cnt As Integer
Dim ServCnt As Integer
Dim PosIdent As String
Dim Data As Range

Cnt = 0
'Building position identifier

Sheets("Input").Select
ActiveSheet.Range("D26:AD151").Select
Set Data = Selection

Sheets("Invoice").Select
ActiveSheet.Range("Service_Title").Offset(1, 0).Activate
'There is still an issue with the counter (line number won't increment by 1 if cnt range is incremented by 1
For Cnt = 0 To ServCnt + 1
    PosIdent = Range("IdSelect").Value & "/" & Cnt + 1
    ActiveCell.Value = Application.WorksheetFunction.VLookup(PosIdent, Data, 15, False)
    ActiveCell.Offset(1, 0).Activate
    Cnt = Cnt + 1
Next Cnt
End Sub 
```

但是错误消息仍然相同。感谢您对代码的改进（它确实解决了 PosIdent 没有被循环更新的问题） - 还有其他想法吗？

**更新 2：**

我现在已经根据迄今为止收到的有用答案/评论更新了我的代码（非常感谢！），现在它创建了一条新的错误消息（不确定旧的错误消息现在是否已解决，因为新的错误消息出现在代码的前面第 59 行）。新错误是“1004：对象'_GLobal'的方法'Range'失败。我真的不知道是什么触发了它，因为我刚刚创建了一个新的子调用`Main`，它调用所有其他子，然后将变量`ServCnt`作为参数传递给最后一个sub. 有人可以帮忙吗？

新代码如下：

`Option Explicit`

 `Sub Main()

Dim ServCnt As Integer

Call Count_Line_Items Call Count_Total_Rows Call Write_Services(ServCnt)

End Sub

Sub Count_Line_Items()

'Counts the number of line items of a consulting project to determine the space needed on the invoice form

```
 Dim Cell As Range
 Dim PosCnt As Integer
 Dim ServCnt As Integer
 Dim ExpCnt As Integer

 PosCnt = 0
 ServCnt = 0
 ExpCnt = 0

'Counting all project positions for the chosen project number
For Each Cell In Range("ProjectList")
   If Cell.Value = Range("IdSelect") Then
       PosCnt = PosCnt + 1
    End If
Next Cell

MsgBox "Total number of line items: " & PosCnt

'Counting all positions of that project that are consulting services
For Each Cell In Range("ProjectList")
   If Cell.Value = Range("IdSelect").Value And Cell.Offset(0, 3).Value = "Service" Then
    ServCnt = ServCnt + 1
   End If
Next Cell

MsgBox "Total number of consulting services: " & ServCnt

'Calculating number of expense items
ExpCnt = PosCnt - ServCnt

MsgBox "Total number of expenses: " & ExpCnt 
```

End Sub

Sub Count_Total_Rows()

```
Dim Current_RowCnt As Integer
Dim Target_RowCnt As Integer
Dim Diff_Rows As Integer

Target_RowCnt = 62

'Counting the rows in the print area and calculating difference to target
Range("Print_Area").Select
Current_RowCnt = Selection.Rows.Count
Diff_Rows = Target_RowCnt - Current_RowCnt
    If Diff_Rows > 0 Then
        MsgBox "We need to add " & Diff_Rows & " rows!"
    ElseIf Diff_Rows < 0 Then
        MsgBox "We need to delete " & -Diff_Rows & " rows!"
    Else
        MsgBox "Nothing needs to be done; all good!"
    End If 
```

End Sub

Sub Write_Services(ServCnt) 'Looks up services on data sheet and writes them to invoice sheet Dim Cnt As Integer Dim PosIdent As String Dim Data As Range

```
Cnt = 0
'Building position identifier

Sheets("Input").Select
ActiveSheet.Range("D26:AD151").Select
Set Data = Selection
PosIdent = Range("IdSelect").Value & "/" & Cnt + 1

Sheets("Invoice").Select
ActiveSheet.Range("Service_Title").Offset(1, 0).Activate
'There is still an issue with the counter (line number won't increment by 1 if cnt range is incremented by 1
For Cnt = 0 To ServCnt + 1
    ActiveCell.Value = Application.WorksheetFunction.VLookup(PosIdent, Data, 15, False)
    ActiveCell.Offset(1, 0).Activate
    Cnt = Cnt + 1
Next Cnt 
```` 

`End Sub`

**更新 3：**

修复了最后的错误 - 有关详细信息，请参阅下面的评论。下面的工作代码：

`Option Explicit Public ServCnt As Integer`

 `Sub Main()

Call Count_Line_Items Call Count_Total_Rows Call Write_Services(ServCnt)

End Sub

Sub Count_Line_Items()

'Counts the number of line items of a consulting project to determine the space needed on the invoice form

```
 Dim Cell As Range
 Dim PosCnt As Integer
 Dim ExpCnt As Integer

 PosCnt = 0
 ServCnt = 0
 ExpCnt = 0

'Counting all project positions for the chosen project number
For Each Cell In Range("ProjectList")
   If Cell.Value = Range("IdSelect") Then
       PosCnt = PosCnt + 1
    End If
Next Cell

MsgBox "Total number of line items: " & PosCnt

'Counting all positions of that project that are consulting services
For Each Cell In Range("ProjectList")
   If Cell.Value = Range("IdSelect").Value And Cell.Offset(0, 3).Value = "Service" Then
    ServCnt = ServCnt + 1
   End If
Next Cell

MsgBox "Total number of consulting services: " & ServCnt

'Calculating number of expense items
ExpCnt = PosCnt - ServCnt

MsgBox "Total number of expenses: " & ExpCnt 
```

End Sub

Sub Count_Total_Rows()

```
Dim Current_RowCnt As Integer
Dim Target_RowCnt As Integer
Dim Diff_Rows As Integer

Target_RowCnt = 62

'Counting the rows in the print area and calculating difference to target
Sheets("Invoice").Activate
Range("Print_Area").Select
Current_RowCnt = Selection.Rows.Count
Diff_Rows = Target_RowCnt - Current_RowCnt
    If Diff_Rows > 0 Then
        MsgBox "We need to add " & Diff_Rows & " rows!"
    ElseIf Diff_Rows < 0 Then
        MsgBox "We need to delete " & -Diff_Rows & " rows!"
    Else
        MsgBox "Nothing needs to be done; all good!"
    End If 
```

End Sub

Sub Write_Services(ServCnt) 'Looks up services on data sheet and writes them to invoice sheet Dim Cnt As Integer Dim PosIdent As String Dim Data As Range

```
Cnt = 0
'Building position identifier

Sheets("Input").Select
ActiveSheet.Range("D26:AD151").Select
Set Data = Selection
PosIdent = Range("IdSelect").Value & "/" & Cnt + 1

Sheets("Invoice").Select
ActiveSheet.Range("Service_Title").Offset(1, 0).Activate
'There is still an issue with the counter (line number won't increment by 1 if cnt range is incremented by 1
For Cnt = 0 To ServCnt + 1
    ActiveCell.Value = Application.WorksheetFunction.VLookup(PosIdent, Data, 15, False)
    ActiveCell.Offset(1, 0).Activate
    Cnt = Cnt + 1
Next Cnt 
```` 

`End Sub`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T00:39:28.363

这可能是在黑暗中拍摄，但我相信你的错误就在这里

```
PosIdent = "IdSelect" & "/" & Cnt + 1 
```

那应该是

```
PosIdent = Range("IdSelect").Value & "/" & Cnt + 1 
```

另外我注意到你只定义了一次，这就是为什么当你的范围改变时它不会改变，我会把这段代码移到这里

```
For Cnt = 0 To ServCnt + 1
    PosIdent = Range("IdSelect").Value & "/" & Cnt + 1
    ActiveCell.Value = Application.WorksheetFunction.VLookup(PosIdent, Data, 15, False)
    ActiveCell.Offset(1, 0).Activate
Next Cnt 
```

希望有帮助

**更新**

试试这个：

```
Option Explicit
Public ServCnt As Integer
Sub Main()

Call Count_Line_Items
Call Count_Total_Rows
Call Write_Services

End Sub
Sub Count_Line_Items()

'Counts the number of line items of a consulting project to determine the space needed on the invoice form

 Dim Cell As Range
 Dim PosCnt As Integer
 Dim ExpCnt As Integer

 PosCnt = 0
 ServCnt = 0
 ExpCnt = 0

'Counting all project positions for the chosen project number
For Each Cell In Range("ProjectList")
   If Cell.Value = Range("IdSelect") Then
       PosCnt = PosCnt + 1
    End If
Next Cell

MsgBox "Total number of line items: " & PosCnt

'Counting all positions of that project that are consulting services
For Each Cell In Range("ProjectList")
   If Cell.Value = Range("IdSelect").Value And Cell.Offset(0, 3).Value = "Service" Then
    ServCnt = ServCnt + 1
   End If
Next Cell

MsgBox "Total number of consulting services: " & ServCnt

'Calculating number of expense items
ExpCnt = PosCnt - ServCnt

MsgBox "Total number of expenses: " & ExpCnt
End Sub

Sub Count_Total_Rows()

Dim Current_RowCnt As Integer
Dim Target_RowCnt As Integer
Dim Diff_Rows As Integer

Target_RowCnt = 62

'Counting the rows in the print area and calculating difference to target
Range("Print_Area").Select
Current_RowCnt = Selection.Rows.Count
Diff_Rows = Target_RowCnt - Current_RowCnt
    If Diff_Rows > 0 Then
        MsgBox "We need to add " & Diff_Rows & " rows!"
    ElseIf Diff_Rows < 0 Then
        MsgBox "We need to delete " & -Diff_Rows & " rows!"
    Else
        MsgBox "Nothing needs to be done; all good!"
    End If
End Sub

Sub Write_Services() 'Looks up services on data sheet and writes them to invoice sheet Dim Cnt As Integer Dim PosIdent As String Dim Data As Range

Cnt = 0
'Building position identifier

Sheets("Input").Select
ActiveSheet.Range("D26:AD151").Select
Set Data = Selection
PosIdent = Range("IdSelect").Value & "/" & Cnt + 1

Sheets("Invoice").Select
ActiveSheet.Range("Service_Title").Offset(1, 0).Activate
'There is still an issue with the counter (line number won't increment by 1 if cnt range is incremented by 1
For Cnt = 0 To ServCnt + 1
    ActiveCell.Value = Application.WorksheetFunction.VLookup(PosIdent, Data, 15, False)
    ActiveCell.Offset(1, 0).Activate
    Cnt = Cnt + 1
Next Cnt
End Sub 
```

# php - PHP：MVC 路由功能解析请求视图的好解决方案？

> ID：13924352
> 
> 赞同：1
> 
> 时间：2012-12-18T00:06:19.180
> 
> 标签：php, model-view-controller, design-patterns

> **可能重复：**
> [MVC 中的 CMS 路由](https://stackoverflow.com/questions/11770104/cms-routing-in-mvc)

我想实现 MVC 设计结构，目前正在努力寻找解析请求视图的好解决方案。

在我的路由文件中，我有以下代码：

```
public function parseRequestedView() {

   $this->ressource_requested = explode('/', trim($_GET['view'], '/'));

   // e.g.: http://www.foo.com/article/{id}/comments/show
   if (!empty($this->ressource_requested[3])) {

      // Format: [0] viewpoint (article), [1] child (comments), [2] action (show), [3] reference ({id}),
      //         [4] additional information (from $_POST)
      return array($this->ressource_requested[0], $this->ressource_requested[2], $this->ressource_requested[3],
                   $this->ressource_requested[1], $_POST);

   // e.g.: http://www.foo.com/article/{id}/show
   } elseif (!empty($this->ressource_requested[2])) {

      return array($this->ressource_requested[0], NULL, $this->ressource_requested[2], $this->ressource_requested[1],
                   $_POST);

   // e.g.: http://www.foo.com/archive/show
   } else {

      return array($this->ressource_requested[0], NULL, $this->ressource_requested[1], NULL, NULL);

   }

} 
```

这个想法是，无论访问者在浏览器中输入什么，该函数都会解析请求并始终返回相同的格式化数组/输出。主机名后面的 URL 的第一段始终是主要观点（例如：文章）。最后，我通过另一个名为 includeTemplateFile() 的函数来包含视图。这些文件具有以下命名约定：

```
viewpoint.child.action.template.php
e.g.: article.comments.show.template.php 
```

我现在的问题是：有更优雅的解决方案吗？我阅读了一些关于这个主题的教程/文章（例如：http://johnsquibb.com/tutorials/mvc-framework-in-1-hour-part-one [）](http://johnsquibb.com/tutorials/mvc-framework-in-1-hour-part-one)，但我不喜欢大多数解决方案，因为它们不是精心设计。

这是 .htaccess 文件的内容：

```
RewriteEngine on

RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

RewriteRule ^(.*)$ index.php?view=$1 [L,QSA] 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T02:01:26.693

好的，我首先要说我不是 PHP 专家，我建议使用诸如 symphony 之类的框架来进行路由，但这里有一个您可以使用的可能解决方案。

```
function regexPath($path)
{
    return '#' . str_replace([":int:", ":string:"], ["\d+", ".+"], $path) . '#';
}

function parseRequestedView($url)
{
    $ressource_requested = explode('/', trim($url, '/'));

    // define our routes, and the indices that each route will use (from the exploded url)
    // this could be defined as another parameter or as a member of the class
    $routes = [
        regexPath("article/:int:/comments/show") => [0,  2, 3,  1], // will return array(resource[0], resource[2], resource[3], resource[1]), etc
        regexPath("article/:int:/show")          => [0, -1, 2,  1], // -1 will return a null
        regexPath("archive/show")                => [0, -1, 1, -1]
    ];

    // go through each route, checking to see if we have a match
    foreach ($routes as $regex => $indices)
    {
        if (preg_match($regex, $url))
        {
            // it matched, so go over the index's provided and put that data into our route array to be returned
            foreach ($indices as $index)
            {
                $route[] = $index > -1 ? $ressource_requested[$index] : null;
            }

            // include the post data (not really nessesary)
            $route[] = $_POST; // unnessesary to pass $_POST data through function, because it is global

            return $route;
        }
    }

    return null; // or some default route maybe?
}

$route = parseRequestedView("article/13/comments/show");

echo '<pre>';
print_r($route);
echo '</pre>';

/* returns:
Array
(
    [0] => article
    [1] => comments
    [2] => show
    [3] => 13
    [4] => Array // this is our $_POST data
        (
        )

)
*/ 
```

# java - 快速高效的数组计算

> ID：13924353
> 
> 赞同：6
> 
> 时间：2012-12-18T00:06:24.703
> 
> 标签：java, algorithm, search, string-matching

我想计算文档中特定短语的出现次数。例如“stackoverflow 论坛”。假设*D*表示文档集，其中包含两个术语的文档。

现在，假设我有以下数据结构：

```
A[numTerms][numMatchedDocuments][numOccurInADocument] 
```

其中 numMatchedDocuments 是 D 的大小，numOccurInADocument 是特定术语在特定文档中出现的次数，例如：

```
A[stackoverflow][document1][occurance1]=3; 
```

意思是，术语“stackoverflow”出现在文档“document1”中，它的第一次出现在位置“3”。

然后我选择出现最少的术语并遍历其所有位置以查找“论坛”是否出现在当前术语“stackoverflow”位置的位置+1。换句话说，如果我在位置 4 找到“论坛”，那么这是一个短语，我已经找到了一个匹配项。

每个文档的匹配很简单，并且运行速度相当快，但是当文档数量超过 2,000,000 时，它会变得非常慢。我已经将它分布在核心上，它当然会变得更快，但想知道是否有算法上更好的方法来做到这一点。

谢谢，

伪代码：

```
boolean docPhrase=true;
int numOfTerms=2;
// 0 for "stackoverflow" and 1 for "forums"
for (int d=0;d<D.size();d++){
 //D is a set containing the matched documents
 int minId=getTheLeastOccuringTerm();
 for (int i=0; i<A[minId][d].length;i++){ // For every position for LeastOccuringTerm
   for( int t=0;t<numOfTerms;t++){ // For every terms
      int id=BinarySearch(A[t][d], A[minId][d][i] - minId + t);
      if (id<0) docPhrase=false;
   }
 }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T01:24:52.177

正如我在评论中提到的，[后缀数组](http://en.wikipedia.org/wiki/Suffix_array)可以解决这类问题。我用后缀数组的简单 c# 实现回答了一个类似的问题（[Fastest way to search a list of names in C# ）。](https://stackoverflow.com/questions/10606728/fastest-way-to-search-a-list-of-names-in-c-sharp)

基本思想是你有一个索引对数组，它们指向一个文档索引，以及该文档中的一个位置。索引对表示从文档中的该点开始并一直到文档末尾的字符串。但实际文档及其内容仅在您的原始存储中存在一次。后缀数组只是这些索引对的数组，每个文档中的每个位置都有一对。然后按照它们指向的文本的顺序对 Suffix Array 进行排序。排序后，您现在可以通过对 Suffix Array 进行简单的二分搜索，非常快速地在任何文档中找到任何短语。构建（主要是排序）后缀数组可能很耗时。但是一旦构建，搜索速度非常快。由于实际文档内容仅存在一次，因此在内存上相当容易。

将其扩展到返回每个文档中的短语匹配计数将是微不足道的。

这与 Suffix Array 的经典描述略有不同，他们通常谈论 Suffix Array 在单个非常大的字符串上运行。但是使其适用于字符串/文档数组的更改并没有那么大，尽管它可以增加 Suffix Array 消耗的内存量，具体取决于最大文档数和最大文档长度，以及您如何编码索引对。

# python - Python中一个令人困惑的案例

> ID：13924354
> 
> 赞同：1
> 
> 时间：2012-12-18T00:06:59.027
> 
> 标签：python, pyqt4

我是 pyqt 的新手，有一些我没有得到的东西。我使用 hashlib 制作了一个应用程序，当然还有使用 pyqt 的 gui。

```
 self.pushButton.connect(self.pushButton,QtCore.SIGNAL("clicked()"),self.clickedButton) 
```

并点击按钮：

```
def clickedButton(self):
        if self.comboBox.currentText() == "MD5":
            self.MD5(self.lineEdit.text()) 
```

和MD5：

```
 def MD5(self,text):
        self.hash = hashlib.md5(text).hexdigest()
        self.textEdit.setText(self.hash) 
```

“你好”的结果：a6f145a01ad0127e555c051d15806eb5

没有错误。看起来没问题。但是在 python shell 上尝试同样的事情：

```
 >>> print hashlib.md5("hello").hexdigest()
 5d41402abc4b2a76b9719d911017c592
 >>> 
```

这是一个错误还是为什么我得到不同的结果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T00:24:35.117

问题是您传递给`md5`一个`QString`，而不是一个常规的 Python 字符串。通过一些实验，我可以看到 Python 中的常规字符串和 unicode 字符串都会产生相同的结果 - 从[这里](https://stackoverflow.com/questions/5292273/hash-unicode-string-in-python)我可以看出它尝试使用`ascii`编解码器将 unicode 版本转换为“窄”字符序列。

```
>>> print hashlib.md5("hello").hexdigest()
5d41402abc4b2a76b9719d911017c592
>>> print hashlib.md5(u"hello").hexdigest()
5d41402abc4b2a76b9719d911017c592 
```

相反，像在您的`QString`程序中一样，散列的方式不同：

```
>>> a=PyQt4.QtCore.QString("hello")
>>> print hashlib.md5(a).hexdigest()
a6f145a01ad0127e555c051d15806eb5 
```

尽管它的 UTF-8 或 Latin 1 表示（两者都与`ascii`编解码器的输出相同，因为我们只处理字母字符）与 Python 字符串的散列方式相同：

```
>>> print hashlib.md5(a.toUtf8()).hexdigest()
5d41402abc4b2a76b9719d911017c592
>>> print hashlib.md5(a.toLatin1()).hexdigest()
5d41402abc4b2a76b9719d911017c592 
```

可能这里发生的事情是散列算法正在处理 的内部表示`QString`，即 UTF-16，它明显不同于 UTF-8 表示，产生不同的输出。

因此，这里的教训是，在对文本执行任何散列之前，您必须在将其传递给散列函数之前明确选择其编码 - 它仅适用于字节 - 因为[没有纯文本之类的东西](http://www.codinghorror.com/blog/2005/01/there-aint-no-such-thing-as-plain-text.html)。

* * *

***编辑***：它不适用于 UTF-16 表示（否则你会得到相同的结果

```
>>> print hashlib.md5(u'hello'.encode('utf_16')).hexdigest()
25af7f84a93a6cf5cb00967c60910c7d 
```

) 但在其他方面；尽管如此，关键是它`hashlib`不被认为可以与 一起使用`QString`，因此它会产生一些“奇怪”的输出。同样，在使用它之前，将其转换为`QString`适当编码的窄字符串。

# javascript - JavaScript 模板，为什么这么棒？

> ID：13924359
> 
> 赞同：0
> 
> 时间：2012-12-18T00:07:41.303
> 
> 标签：javascript, dust.js, canjs

我一直在研究 JavaScript 模板库，如dust.js 和其他更广泛的库，如 canJS

在我工作的地方，我们在客户端完成了近 99% 的任何应用程序/站点。目前我只是构建html字符串，注入dom，监听点击/动作，做ajax，从结果中构建更多的html字符串并注入dom等等。

如果你举这个简单的[例子](http://jsfiddle.net/W6QZ6/2/)。

```
//stringbuilder
function StringBuilder(e){this.strings=new Array("");this.append(e)}StringBuilder.prototype.append=function(e){if(e){this.strings.push(e)}};StringBuilder.prototype.clear=function(){this.strings.length=1};StringBuilder.prototype.toString=function(){return this.strings.join("")}

var data = {
    fname: "Joe",
    lname: "Doe",
    occupation: "Developer",
    things: ["some", "list", "of", "things"]
}

var sb = new StringBuilder();

sb.append("<h1>" + data.fname + " " + data.lname + "</h1>");
sb.append("<p>Occupation: " + data.occupation + "</p>");
sb.append("<h3>A list of things</h3>");
sb.append("<ul>");
for (var i = 0; i < data.things.length; i++) {
    sb.append("<li>" + data.things[i] + "</li>");
}
sb.append("</ul>");

$("#output").html(sb.toString()); 
```

通过模板可以通过什么方式改进？从我所见，我将不得不适应一种特定的模板语法，这种语法并不比上述更容易阅读或维护。复杂的布局，或者你有递归的场景（列表中的列表不知道它可能有多少层）呢？我觉得模板语法/引擎在某些情况下可能是一个限制因素。

我想将 html 完全从 JS 中提取出来是很好的，但是可以说在 HTML 中使用带有模板语法的脚本标签是不可能的，我并不特别希望模板作为外部文件，我需要执行额外的请求读。

请教育我！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-18T00:20:20.503

好吧，只是比较：

```
sb.append("<h1>" + data.fname + " " + data.lname + "</h1>");
sb.append("<p>Occupation: " + data.occupation + "</p>");
sb.append("<h3>A list of things</h3>");
sb.append("<ul>");
for (var i = 0; i < data.things.length; i++) {
    sb.append("<li>" + data.things[i] + "</li>");
}
sb.append("</ul>"); 
```

到

```
<h1>@fname @lname</h1>
<p>Occupation: @occupation</p>
<h3>A list of things</h3>
<ul>
    @foreach( thing in things ) {
        <li>@thing</li>
    }
</ul> 
```

哪个看起来更易于维护？

[演示](http://jsfiddle.net/aXXeF/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T08:58:34.210

通过使用dust.js，您可以创建一个如下所示的模板文件：

```
<h1>{fname} {lname}</h1>
<p>Occupation: {occupation}</p>
<h3>Friends list:</h3>
<ul>
  {#friends}
  <li>{name} {age}</li>
  {/friends}
</ul> 
```

您的 JSON 数据：

```
var data = {
  fname: "Joe",
  lname: "Doe",
  occupation: "Developer",
  friends: [
    {
      name: "Moe",
      age: 37 
    },
    { 
      name: "Larry",
      age: 39
    },
    {
      name: "Curly",
      age: 35
    }
  ]
} 
```

要渲染您的模板，只需调用dust.render 并将template_name 与JSON 对象和回调函数一起传递：

```
dust.render('template_name', data, function(err, out){
  $("#output").html(out);
}); 
```

另一个有用且相关的问题：[如何使用dustjs-linkedin 作为客户端模板？](https://stackoverflow.com/questions/13736462/how-to-use-dustjs-linkedin-as-client-side-templating)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T00:23:36.637

在[Mustache.js](https://github.com/janl/mustache.js)这个模板中：

```
sb.append("<h1>" + data.fname + " " + data.lname + "</h1>");
sb.append("<p>Occupation: " + data.occupation + "</p>");
sb.append("<h3>A list of things</h3>");
sb.append("<ul>");
for (var i = 0; i < data.things.length; i++) {
    sb.append("<li>" + data.things[i] + "</li>");
}
sb.append("</ul>"); 
```

被移动到 DOM 并且在你的 IDE 中看起来像这样：

```
<script id="sb">
    <h1>{{fname}} {{lname}}</h1>
    <p>Occupation: {{occupation}}</p>
    <h3>A list of things</h3>
    <ul>
    {{#things}}
        <li>{{.}}</li>
    {{/things}}
    </ul>

</script> 
```

它将保持您的代码在 IDE 中突出显示，并且在没有`"<div>"`s 的情况下更容易阅读

您可以使用以下方法渲染它：

```
var output = Mustache.render($("sb").html(), data);
$("#destination").html(output); 
```

# couchdb - 对于集群的 CouchDB 设置，我应该继续使用 BigCouch 吗？

> ID：13924362
> 
> 赞同：5
> 
> 时间：2012-12-18T00:07:57.100
> 
> 标签：couchdb, cluster-computing, bigcouch

我一直在研究`CouchDB`的附件功能。基本上，CouchDB 允许您将二进制文件数据存储在数据库记录中。类似于 MongoDB 的 GridFS。我想要构建的项目主要围绕文件上传展开，我计划将其存储在 CouchDB 中。因此，这导致我研究 CouchDB 如何对数据进行集群化，以便随着我的数据库的增长，由于文件附件的存在，我可以将其集群到多个服务器上。我很失望地发现 CouchDB 没有能力做到这一点，开箱即用。`couchdb-lounge`CouchDB 指南说要在 Github 上使用名为. 我不认为我会觉得以此为基础。

我发现`BigCouch`，它似乎是一个经过修改的 CouchDB，具有我需要的确切集群功能，除了它看起来落后于当前稳定的 CouchDB 版本。我确实在一年前的新闻稿中读到，他们正在努力将 BigCouch 合并到官方的 CouchDB 中，但我不知道时间表是什么样的。

作为第三种选择，看起来 Couchbase Server 2 也基于 CouchDB，但具有构建的集群以及其他功能。我也在辩论这是一个可行的选择。但是，它不支持文件附件。

BigCouch 最终将登陆 CouchDB 的事实让我有信心继续使用 BigCouch。

我应该使用 BigCouch 吗？如果只是 CouchDB + 集群，为什么不是每个人都使用 BigCouch？一定有一些不利的一面，对吧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T05:11:54.207

在我的工作中，我的需求与您的需求有些不同，但我已经完成了 Couchbase、CouchDB 和 BigCouch 的工作。我发现 BigCouch 很容易在云中设置，并且只用了一天就成功创建了一个集群。我们正在投资 BigCouch，并在尽职调查后致力于一项重大的移动计划。

原因：

1.  BigCouch 在云环境中设置起来相当容易。文档很简单，但我能够快速启动并运行一个简单的集群。我建议密切关注云环境中机器的私有主机名。（如果有帮助，我可以发送我在云中创建机器的详细说明。）

2.  BigCouch 由 Cloudant 维护，当然它是开源的，这很好。Cloudant 的 CTO 告诉我，他们已经将相当多的代码合并到 Apache CouchDB 项目中。此外，Cloudant 看起来相当稳定，因此我们指望他们让项目保持最新。这似乎是一个很好的社区（不像 TouchDB 之类的东西）。

3.  据我所知，BigCouch 主要围绕核心 CouchDB 代码/API 进行包装。这很好，因为这让我觉得他们以 CouchDB 为基础开始，并没有尝试在此基础上做太多事情。例如，CouchDB 的复制已经非常好，BigCouch 并没有尝试重新发明轮子。他们只是添加了一些 Couch 缺少的东西。

4.  与 Cloudant 相比，“原始”运行 BigCouch 的一个缺点是 Cloudant 维护自己的具有更多功能的内部分支。我们的评估发现，虽然这些功能是不需要的。他们对我们来说有点矫枉过正。

5.  Couchbase 特别似乎落后了一步。到达 Couchbase 2.0 花了很长时间，我对 2.0 之前的 Couchbase 感到失望。我听说 2.0 很棒，但还没有机会使用它。由于各种原因，我对 2.0 之前的版本感到有点厌烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T11:48:08.910

不是每个人都需要集群。CouchDB 团队打算在几乎准备好的 1.3 版本发布后不久合并 BigCouch，因此开始研究 BigCouch 肯定是有道理的（我个人肯定会选择 BigCouch 而不是 CouchBase 或 couchdb-lounge —— 许多 BigCouch 的贡献者都是 CouchDB无论如何，提交者）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T14:51:36.780

集群的缺点是它的额外复杂性。我会争辩说，除非您已经是一位经验丰富的 CouchDB 用户，否则从第一天开始使用 BigCouch 可能有点过头了。

作为学习如何设置和维护 BigCouch 部署的替代方法，您可以选择像 Cloudant 这样的在线 CouchDB 主机，让他们处理管理机器集群的复杂性。您所处理的只是看起来仍然像您本地 CouchDB 实例的东西。

关于在 CouchDB 中存储文件，为什么不将它们存储在 S3 中？（顺便说一句，比 Cloudant 便宜很多）

# php - ModX：在 Wayfinder 中使用 PHP var？

> ID：13924364
> 
> 赞同：1
> 
> 时间：2012-12-18T00:08:00.787
> 
> 标签：php, variables, content-management-system, modx, modx-revolution

我有一个从数据库获取文档 ID 的片段。

我想把这些放在 Wayfinder 的菜单中，但无法让它工作。有谁知道在 Wayfinder 中放置 PHP var 的正确方法？试过这个但没有运气：

```
echo '[[Wayfinder? &includeDocs=`' . $docid . '`]]'; 
```

（PS：使用Revo）

编辑：添加了更多代码

简而言之，我的代码从会话中获取登录用户 ID 并找到他们的访问组。最终目标是显示访问组内资源的链接。这是片段的后半部分，我在其中获得了适当的资源 ID，只需将它们输出即可。

```
//RETRIEVE DOCUMENT GROUPS RELATED TO ACCESS GROUPS
          $docgroups = "SELECT * FROM `modx_document_groups` WHERE `document_group` = '$target' ";

          $docstmt = $modx->query($docgroups );              

          while ($docrow = $docstmt->fetch(PDO::FETCH_ASSOC)) {
          $docid = $docrow['document'];            

          echo '[[Wayfinder? &startId=`0` &includeDocs=`' . $docid . '`]]';

          }//END 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T00:15:14.607

在 modx 中，您的片段必须返回一个值才能以块/模板等方式访问它。这是一种方法：

```
//MySnippet
<?php
// logic
$docIDs = array(1, 2, 23, 17);
return implode(',', $docIDs); 
```

然后你的寻路器调用使用代码段：

```
 // wayfinder call
[[!Wayfinder? &includeDocs=`[[!MySnippet]]`]]

// is the same as:
[[!Wayfinder? &includeDocs=`1,2,23,17`]] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T12:15:19.360

在 Modx Revolution 做到这一点的正确方法：

```
$c = $modx->newQuery('modResourceGroupResource');
$c->where(array( 'document_group' => $target ));
$docs = $modx->getCollection('modResourceGroupResource', $c);

$docids = array();
foreach($docs as $doc) {
    $docids[] = $doc->get('document');
}

$output = $modx->runSnippet('Wayfinder',array(
    'startId' => 0,
    'includeDocs' => implode(',', $docids);
));

return $output; 
```

# ruby-on-rails - 搜索 tmux 输出缓冲区时 Rails 冻结

> ID：13924365
> 
> 赞同：28
> 
> 时间：2012-12-18T00:08:11.833
> 
> 标签：ruby-on-rails, screen, tmux

我正在使用 tmux 在开发模式下运行 Rails 3.2.6。当我使用 tmux 滚动浏览 Rails 服务器的输出缓冲区（使用 rails s 运行）时，服务器冻结并且不处理任何请求。当我退出回滚模式时，服务器再次开始正常工作。

在查看输出缓冲区时，如何设置服务器以继续处理请求？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-01-28T19:11:25.543

If you want to pause and examine at some particular sequence of log messages while your server continues processing requests, it is probably best to directly view the log files instead; you might use `less -R log/development.log`.

While a *tmux* pane is in “copy mode” (the mode used to view a pane’s history), *tmux* does not read any output from the processes running in the pane’s tty. If the processes continue to write output to the tty, then the OS’s tty buffer will eventually fill. When a program writes to a tty with a full buffer, it causes the process to block so that the buffer does not overflow; this is what causes your server to temporarily stop processing requests.

The timeline looks like this:

1.  You enter copy mode to view some old output.
    *tmux* stops reading from the tty.
2.  Your Rails server continues to write to the tty as it handles ongoing requests.
    The OS absorbs these writes into a tty buffer of some limited size.
3.  Eventually, the OS tty buffer fills up and causes further writes to the tty to block.
    This is where the Rails server “freezes”; it is stuck waiting for the OS to return from (e.g.) a *write(2)* call it made to display a log message.
4.  You exit copy mode.
    *tmux* resumes reading from the tty, draining the buffered output and accepting new output.

# mongodb - mongoimport 失败 - 内存不足

> ID：13924366
> 
> 赞同：0
> 
> 时间：2012-12-18T00:08:14.533
> 
> 标签：mongodb, import

在带有 mongod 的 Windows 机器上导入 json（来自 unix 机器的 mongoexport）会破坏我的本地数据库。

日期：1 upsert：1 keyUpdates：0锁（微）w：117382 117ms

12 月 18 日星期二 01:00:02 [conn2] C:/xampp/mongo/data/test.9 的 MapViewOfFileEx 失败，出现 errno:8 可用内存不足。（文件大小为 536608768）在 MemoryMappedFile::map

12 月 18 日星期二 01:00:02 [conn2] test.gmd 致命断言 16166

12 月 18 日星期二 01:00:02 [conn2] mongod.exe ???

...

***在 fassert() 失败后中止

任何提示，如何使用 mongoimport 导入此 json 约 5-GB 而不会使 Windows 上的 mongo 服务器崩溃？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T04:35:47.643

服务器必须在 32 位 windows 平台上托管 32 位 mongod，这将虚拟地址空间限制为 2GB。这就是mongodb内存不足的原因。64 位系统将解决此问题。

# matlab - 在 MATLAB 中计算数据的正态分布的 Nan 值？

> ID：13924369
> 
> 赞同：1
> 
> 时间：2012-12-18T00:09:03.377
> 
> 标签：matlab, gaussian, pattern-recognition

我正在使用高斯混合进行 EM 算法，但问题是我的数据非常空闲，因此这些值的值非常小，接近于零。

这是有问题的部分

```
for i=1:ncomp,
  **logdenom = -log((2*pi)^(dim/2)*sqrt(abs(det(Cov(:,:,i)))));**  
  dist = mahalan(X,Mean(:,i),Cov(:,:,i));
  y(i,:) = logdenom-0.5*dist;
end 
```

星号线是问题所在。在计算时，它在结果 NAN 值之后返回“inf”值。我该如何处理这个问题。我也计算它没有对数函数

```
for i=1:ncomp,
  dist = mahalan(X,Mean(:,i),Cov(:,:,i));
  y(i,:) = exp(-0.5*dist)/sqrt((2*pi)^dim*det(Cov(:,:,i))); % problem
end 
```

但问题是一样的，因为 Cov 的值太小了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T00:16:35.667

在这种情况下防止`inf`s 的一种方法是简单地使用

```
 logdenom = -log( eps + (2*pi)^...  ) 
```

我发现这个 v 对于最大似然估计中的稀疏数据很有用。我不知道它在 EM 中是否有用！基本上，零项变成类似`+36`，所以不会太大，但它仍然允许放大您需要的小概率`log`。

# android - 可绘制资源 ID

> ID：13924370
> 
> 赞同：0
> 
> 时间：2012-12-18T00:09:14.003
> 
> 标签：android, drawable

我能够在列表视图中获取已安装应用程序名称的列表，但在添加图标时遇到问题。我创建了一个新的 xml 布局并包含了一个 imageview。

我正在使用以下内容来检索图标

```
appInfo.icon = p.applicationInfo.loadIcon(getPackageManager()); 
```

要加载我正在使用的应用程序信息

```
HashMap<String,String>. 
```

据我了解，我可以使用

```
HashMap<String,Integer> 
```

然后只需将可绘制资源 ID 发送到 Imageview 即可。

如何获取可绘制对象的资源 ID？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T00:36:34.357

在您的应用程序中获取可绘制对象的 int：

```
int yourInt = getResources().getIdentifier(fileName, "drawable", getPackageName()); 
```

从另一个应用程序获取图标：

[Android - 如何获取应用程序的图标？](https://stackoverflow.com/questions/5612233/android-how-to-get-an-icon-of-an-app)

# javascript - 允许包含和排除范围的 JavaScript / jQuery 日期选择器？

> ID：13924371
> 
> 赞同：0
> 
> 时间：2012-12-18T00:09:18.963
> 
> 标签：javascript, jquery, datepicker, daterangepicker

我一直在为一个项目寻找一些 js/jQuery 日期范围选择器。

到目前为止，我还没有找到任何专门声称仅适用于包含性或排除性日期范围的内容，或者我真正想要的，它允许我设置一个范围是包含性的还是排除性的。

*   包含日期范围从第一天开始，包括最后一天。例如，这些对假期很有用。我有十天的假期，我想在小部件上准确地指出这十天。

*   独家日期范围从第一天开始，到最后一天结束。也就是说，最后一天不包括在内。这是不在范围内的第一天。这些对于预订和预订很有用。我预订了 1 月 7 日入住酒店并于 1 月 19 日退房。我不会在退房日入住，但当我考虑我的预订时，我会想到退房日期，而不是我的最终日期过夜。

是否有支持这两个概念的 JavaScript 或 jQuery 日期选择器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T00:28:26.897

我也没找到。但是我从 jquery 自定义了 datepicker——你需要处理[beforeShowDay](http://docs.jquery.com/UI/API/1.8/Datepicker#event-beforeShowDay)事件；您所要做的就是验证那一天是否在您的范围内并返回一个有意义的 css 类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T00:31:33.530

我认为处理这个问题不是日期选择器的工作。范围是范围是范围。拿走它，然后在您使用它时（例如，将它传递给数据库查询时）以包含或独占方式处理结束日期。

# mysql - 在 perl 中处理表单并将结果写入数据库

> ID：13924372
> 
> 赞同：1
> 
> 时间：2012-12-18T00:09:19.937
> 
> 标签：mysql, perl

这是我第一次同时使用 perl 和数据库进行编程，我在确定如何准确编写将 html 表单的结果输入 mysql 数据库的 perl 脚本时遇到了一些问题。

这个特定的片段是导致我问题的原因：

```
 # CONFIG VARIABLES
    $platform = "mysql";
    $database = "*****";
    $host = "localhost";
    $port = "3306";
    $user = "*****";
    $pw = "*****";

    # DATA SOURCE NAME
    $dsn = "dbi:$platform:$database:$host:$port";

    # PERL DBI CONNECT
    $connect = DBI->connect($dsn, $user, $pw);

    # PREPARE THE QUERY
    $query = "INSERT INTO result (name, console, character, series, bday, steam) VALUES (fname, favConsole, fCharacter, favSeries, birthday, steamAcc)";
    $query_handle = $connect->prepare($query);

    # EXECUTE THE QUERY
    #$query_handle->execute(); 
```

我用星号替换了数据库名称、用户名和密码，但真实代码具有真实值。

我不确定为什么连接和执行线会给我带来问题。

另外，一旦用户点击提交按钮，我将把提示放在哪里以便写入信息？我尝试将执行添加为表单操作，但这不起作用。

这是我到目前为止的工作：

```
 #!/usr/bin/perl

    use CGI qw( :standard );
    use DBI;
    use DBD::mysql;

    # CONFIG VARIABLES
    $platform = "mysql";
    $database = "*****";
    $host = "localhost";
    $port = "3306";
    $user = "*****";
    $pw = "*****";

    # DATA SOURCE NAME
    $dsn = "dbi:$platform:$database:$host:$port";

    # PERL DBI CONNECT
    $connect = DBI->connect($dsn, $user, $pw);

    # PREPARE THE QUERY
    $query = "INSERT INTO result (name, console, character, series, bday, steam) VALUES (fname, favConsole, fCharacter, favSeries, birthday, steamAcc)";
    $query_handle = $connect->prepare($query);

    # EXECUTE THE QUERY
    #$query_handle->execute();

    $dtd =
    "-//W3C//DTD XHTML 1.0 Transitional//EN\"
       \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd";

    print( header() );

    print( start_html( { dtd => $dtd,
      title => "~Video Game Survey~" } 
      #style=>{"background-image:url(/images/blue_line_background.jpg) ";
      #}
      ) );
    #print( " <body style="background-image:url(/images/blue_line_background.jpg)">\n " );

    print( "<body>\n" );
    print(     "<div style = \"font-size: 14pt; font-weight: bold\">\n" );
    print(      "Please let us know a bit more about yourself.\n" );
    print(     "</div>\n" );
    print( "</body>\n" );

    print( "<br />\n " );

    #Start of the form.
    print( "<form method = \"post\" > \n" );

    #First question, asking the visitor's name.  Name will be stored in the database         but not displayed on the
    #survey results.
    print( "<p>\n" );
    print(      "First of all, what is your name?\n" );
    print(      "<input type = \"text\" name = \"fname\" placeholder = \"John Doe\" required />\n" );
    print( "</p>\n" );

    print( "<br /><br />\n" );

    #Second question, type dropdown list.
    print( "<img src = \"/images/favConsole.png\" />\n");
    print( "<p>\n" );
    print(      "Gaming comes in all sorts of shapes and sizes.  What is your favorite console?\n" );
    print( "</p>\n" );
    print( "<dd>\n" );
    print(      "<input type = \"text\" name = \"favConsole\" placeholder = \"Select a console\"
                   list = \"consoles\" required/>\n" );
    print(              "<datalist id = \"consoles\">\n" );
    print(                  "<option value= \"PC\">\n" );
    print(                  "<option value= \"Playstation 3\">\n" );
    print(                  "<option value= \"Xbox 360\">\n" );
    print(                  "<option value= \"Wii\">\n" );
    print(              "</datalist>\n" );
    print( "</dd>\n");

    print( "<br /><br />\n" );

    #Third question, type radio.  Default value: Mario
    print( "<img src = \"/images/favCharacter.png\" />\n" );
    print( "<p>\n" );
    print(      "Out of the following list, who is your favorite video game character?\n" );
    print( "</p>\n" );
    print(      "<dd><input name = \"fCharacter\" type = \"radio\" value = \"Mario\" checked><label>Mario</label></dd>\n" ); 
    print(      "<dd><input name = \"fCharacter\" type = \"radio\" value = \"Sephiroth\" ><label>Sephiroth</label></dd>\n" );
    print(      "<dd><input name = \"fCharacter\" type = \"radio\" value = \"Sonic\" ><label>Sonic</label></dd>\n" );
    print(      "<dd><input name = \"fCharacter\" type = \"radio\" value = \"Thrall\" ><label>Thrall</label></dd>\n" );
    print(      "<dd><input name = \"fCharacter\" type = \"radio\" value = \"Pacman\" ><label>Pacman</label></dd>\n" );
    print(      "<dd><input name = \"fCharacter\" type = \"radio\" value = \"Cloud\" ><label>Cloud</label></dd>\n" );
    print(      "<dd><input name = \"fCharacter\" type = \"radio\" value = \"Sylvanas\" ><label>Sylvanas</label></dd>\n ");
    print(      "<dd><input name = \"fCharacter\" type = \"radio\" value = \"Kerrigan\" ><label>Kerrigan</label></dd>\n ");
    print( "</dd>\n" );

    print( "<br /><br />\n" );

    #Fourth question, type dropdown.  Required.
    #Dropdown options will not appear unless the window is maximized in terms of height.
    print( "<img src = \"/images/favSeries.png\" />\n" );
    print( "<p>\n" );
    print(      "Which of the following series is your favorite?\n" );
    print( "</p>\n" );
    print(      "<input type = \"text\" name = \"favSeries\" placeholder = \"Select a series\"
                   list = \"series\" required/>\n" );
    print(              "<datalist id = \"series\">\n" );
    print(                  "<option value= \"Legend of Zelda\">\n" );
    print(                  "<option value= \"Halo\">\n" );
    print(                  "<option value= \"Bioshock\">\n" );
    print(                  "<option value= \"Resident Evil\">\n" );
    print(                  "<option value= \"Mario Party\">\n" );
    print(                  "<option value= \"Angry Birds\">\n" );
    print(                  "<option value= \"The Sims\">\n" );
    print(                  "<option value= \"Mass Effect\">\n" );
    print(                  "<option value= \"Half-Life\">\n" );
    print(                  "<option value= \"Warcraft\">\n" );
    print(                  "<option value= \"Starcraft\">\n" );
    print(                  "<option value= \"Borderlands\">\n" );
    print(              "</datalist>\n" );

    print( "<br /><br />\n" );

    #Fifth question, type date.  No default value, but still required.
    print( "<img src = \"/images/bday.png\" />\n" );
    print( "<p>\n" );
    print(      "What is your cake day?\n" );
    print( "</p>\n" );
    print(      "<input type = \"date\" name = \"birthday\" required />(yyyy-mm-dd)\n" );

    print( "<br /><br />\n" );

    #Sixth question, type radio.  Default value: no.
    print( "<p>\n" );
    print(      "Last but not least, do you have a Steam account?\n" );
    print(      "<input name = \"steamAcc\" type = \"radio\" value = \"Y\" >        <label>Yes</label>\n" );
    print(      "<input name = \"steamAcc\" type = \"radio\" value = \"N\" checked>        <label>No</label>\n" );
    print( "</p>\n" );

    print( "<p>\n" );
    print(      "<input type = \"submit\" value = \"Submit\" />\n" );
    print(      "<input type = \"reset\" value = \"Clear\" /></p>\n" );
    print( "</p>\n" );

    #End of the form
    print( "</form>\n" );

    print( end_html() ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T03:49:45.800

从以下几点开始：

1.  将这些行添加到脚本的顶部以确保代码安全。

    ```
    use strict;
    use warnings; 
    ```

2.  上述步骤意味着您需要使用 声明所有变量`my`，例如

    ```
    my $dsn = ... 
    ```

3.  如果连接或执行有任何问题，告诉 DBI 抛出一个错误（默认情况下它不会这样做）。从错误消息中，您可以获得更多线索来弄清楚发生了什么。

    ```
    my $dbh = DBI->connect($dsn, $user, $pw, {RaiseError => 1}); 
    ```

4.  为您的 SQL 使用占位符（这可以防止 SQL 注入，并自动在 SQL 中添加您的插入值）

    ```
    my $query = 'insert into (name, console) values (?, ?)';
    my $sth = $connect->prepare($query);
    $sth->execute('fname', 'favConsole');
    # this is equivalent to:
    # "insert into (name, console) values ('fname', 'favConsole')" 
    ```

5.  您的值需要从 CGI 参数中提取（我猜您还没有达到那个阶段）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T00:26:15.497

```
$query_handle = $connect->prepare($query) 
```

应该

```
$query_handle = $dbh->prepare($query) 
```

`$something`是变量的名称。你没有一个名为 的变量`$connect`，所以这显然是不对的。该行接受数据库连接和查询字符串，并返回一个查询句柄，一个包含运行查询所需的所有信息的对象。

# css - 宽度为 100% 的框不在页面中心

> ID：13924373
> 
> 赞同：0
> 
> 时间：2012-12-18T00:09:31.030
> 
> 标签：css, centering

我正在尝试在屏幕上居中放置我的内容。问题是当我`top`在`50%`该框设置时不会 100% 居中在页面上。这就像顶部的 60% 和底部的 40%。

这是HTML代码：

```
​&lt;div class="content">
    test
</div>​ 
```

这是样式表：

```
body, html {
    color: #eaeaea;
    font-family: Arial;
    font-size: 12px;
    margin: 0;
    padding: 0;
    width: 100%;
}

.content {
    background-color: #000000;
    padding: 10px 15px;
    position: fixed;
    top: 50%;
    width: 100%;
}​ 
```

演示：http: [//jsfiddle.net/edgren/cceSw/](http://jsfiddle.net/edgren/cceSw/)

我错过了什么？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T00:13:20.170

您也必须减去 div 的高度`top`。这可以通过在`margin-top`.

看看这里 - 这是你的小提琴的更新：

[http://jsfiddle.net/cceSw/3/](http://jsfiddle.net/cceSw/3/)

我添加了一个`height`and`margin-top`到你的`.content`

```
.content {
background-color: #000000;
padding: 10px 15px;
position: fixed;
top: 50%;
width: 100%;
height:50%;
margin-top:-25%; 
```

}​</p>

如果您的内容可能会有不同的大小，那么您可以使用 JQuery 计算其高度并动态设置其边距。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T00:13:39.967

您需要设置一个负上边距，它应该是 div 高度的 50%。

# windows - 使用 Windows SDK v7.1 从 Windows 7 上的源代码编译 OpenJDK 6

> ID：13924376
> 
> 赞同：1
> 
> 时间：2012-12-18T00:10:01.133
> 
> 标签：windows, openjdk, winsock2

我正在尝试使用 Windows SDK v7.1 从 Windows 7 机器上的源代码编译 OpenJDK 6。

经过一些调整，我达到了一个我真的不知道什么是正确的做法的地步。

这是文件 - [http://hg.openjdk.java.net/jdk6/jdk6/jdk/file/tip/src/windows/native/sun/nio/ch/WindowsSelectorImpl.c](http://hg.openjdk.java.net/jdk6/jdk6/jdk/file/tip/src/windows/native/sun/nio/ch/WindowsSelectorImpl.c)

第 47 和 49 行：

```
 static int POLLIN   = 1;  // line 47
   static int POLLCONN = 2;
   static int POLLOUT  = 4;  // line 49 
```

问题是包含的文件 winsock2.h 有以下代码：

```
#if(_WIN32_WINNT >= 0x0600)

/* Event flag definitions for WSAPoll(). */

#define POLLRDNORM  0x0100
#define POLLRDBAND  0x0200
#define POLLIN      (POLLRDNORM | POLLRDBAND)
#define POLLPRI     0x0400

#define POLLWRNORM  0x0010
#define POLLOUT     (POLLWRNORM)
#define POLLWRBAND  0x0020

#define POLLERR     0x0001
#define POLLHUP     0x0002
#define POLLNVAL    0x0004

typedef struct pollfd {

    SOCKET  fd;
    SHORT   events;
    SHORT   revents;

} WSAPOLLFD, *PWSAPOLLFD, FAR *LPWSAPOLLFD;

#endif // (_WIN32_WINNT >= 0x0600) 
```

注意 winsock2 #defines`POLLIN`和是如何定义的`POLLOUT`，而 WindowsSelectorImpl.c 将它们声明为 const。更糟糕的是，两者都给出不同的值：

**OpenJDK：**

```
POLLIN = 1
POLLOUT = 4 
```

WinSock2 (Windows SDK v7.1):

```
POLLIN = 0x300
POLLOUT = 0x10 
```

显然，OpenJDK 代码不应该在 Windows 7 上编译。

但是，我确实想在 Windows 7 上编译它。

一种选择是安装较旧的 Windows SDK。另外就是改文件WindowsSelectorImpl.c，问题是怎么做？我的意图是重命名常量，但我不禁想知道 WinSock2 #defining 常量名称完全相同，但值不同......

有什么建议吗？

**编辑1**

再想一想，也许我最好有条件地使用 WinSock2 中的值？我的意思是值的变化可能意味着 API 的变化。

WinSock2.h 像这样定义 pollfd：

```
typedef struct pollfd {
    SOCKET  fd;
    SHORT   events;
    SHORT   revents;
} WSAPOLLFD, *PWSAPOLLFD, FAR *LPWSAPOLLFD; 
```

与 WindowsSelectorImpl.c：

```
typedef struct {
    jint fd;
    jshort events;
} pollfd; 
```

前者向后兼容后者（或多或少，对齐除外）。

所以，WinSock2 常量有可能是适用于 Windows 7 的常量，但那该怎么办`POLLCONN`呢？代码将如何在 Windows 2003 或 XP 上运行？

**编辑2**

情况更糟，因为 C 实现在 java 中有一个匹配的对应物 - [http://hg.openjdk.java.net/jdk6/jdk6/jdk/file/tip/src/windows/classes/sun/nio/ch/ WindowsSelectorImpl.java](http://hg.openjdk.java.net/jdk6/jdk6/jdk/file/tip/src/windows/classes/sun/nio/ch/WindowsSelectorImpl.java)，它使用与 C 代码相同的常量。

我不明白这一点。Windows 7 上的 winsock2 是否会破坏为 Windows 2003 SP1 上的 winsock2 编写的任何代码？

**编辑3**

检查 jdk7u 源（[WindowsSelectorImpl.c](http://hg.openjdk.java.net/jdk7u/jdk7u/jdk/file/tip/src/windows/native/sun/nio/ch/WindowsSelectorImpl.c)和[AbstractPollArrayWrapper.java](http://hg.openjdk.java.net/jdk7u/jdk7u/jdk/file/tip/src/share/classes/sun/nio/ch/AbstractPollArrayWrapper.java)）。它使用重命名方法，这意味着即使 Windows SDK v7.1 使用不同的值声明 POLLIN 和 POLLOUT，jdk7 仍坚持 jdk6 的实现。

我真的不知道这是什么意思，但我在这里不会比教皇更天主教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T17:40:33.200

解决方案很简单，虽然很烦人 - 获取 Visual Studio 2003 并使用它来编译 OpenJDK。最难的部分是自己拿到VS2003，剩下的就很容易了。

# c# - 访问资源文件中的全局变量

> ID：13924378
> 
> 赞同：0
> 
> 时间：2012-12-18T00:10:23.780
> 
> 标签：c#, asp.net-mvc, embedded-resource

我有一个 MVC 项目，其中有一个返回 url 的全局函数。这是其中之一：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;

namespace Account.Models
{
    public class ApplicationStrings
    {

        public static string ApplicationString(){

            return "http://localhost11234/Studentbook";

    }

    }

} 
```

我有资源文件，用于存储不同电子邮件的电子邮件正文。这是一个嵌入式资源。

如何从资源文件中的全局函数访问 URL？

我尝试以下方式，但没有看到链接：

```
<html>
<body> 
<br> Student ID :  <a href= ApplicationStrings.ApplicationString() + ?id=JD1123>JD1123</a><br>       
</body>
</html> 
```

我看到以下内容：

```
Student ID : JD1123 
```

这里 JD1123 是一个链接，该链接将我带到**“ApplicationStrings.ApplicationString()”**而不是**“http://localhost11234/Studentbook?id=JD1123”**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T00:18:00.597

你不能做你想做的事，至少不能直接做。资源字符串是静态项目，在您访问它们时不会自动更改。所以基本上，你得到的正是你输入的内容。计算机不够聪明，不知道它应该调用一个方法来让你的配置字符串卡在那里。

相反，您需要编写一段中间代码来搜索您的资源字符串以查找要替换的特定项目（可能用 <% %> 或其他东西标记它们），然后使用 Regex.Replace 插入正确的文本。这是相当微不足道的。

[http://www.codeguru.com/cpp/cpp/string/regex/article.php/c2791/Using-Regular-Expressions-for-SearchReplace.htm](http://www.codeguru.com/cpp/cpp/string/regex/article.php/c2791/Using-Regular-Expressions-for-SearchReplace.htm)

# java - Java Applet Key（显然）在触发后失去焦点

> ID：13924388
> 
> 赞同：0
> 
> 时间：2012-12-18T00:11:52.443
> 
> 标签：java, swing, applet, focus, keylistener

我有一个在 Eclipse 中运行良好的 Java Applet，但是当我将它导出到 jar 文件中，将其嵌入 HTML 并使用 Opera 或 Firefox 打开它时，Key Listener 无法正常工作。我试图提取适当的代码。小程序是一个游戏，玩家在按下“D”时向前移动，当他们释放它时停止：

```
public class World extends JPanel
{
...
public World()
{
...
   seyFocusable(true);
   addKeyBinding();
...
}
private AbstractAction forward = new AbstractAction()
{
    public void actionPerformed(ActionEvent e)
    {
        if(!keys.contains(39))
            keys.add(39);
        requestFocusInWindow();
    }
};
private AbstractAction r_forward = new AbstractAction()
{
    public void actionPerformed(ActionEvent e)
    {
        keys.remove(new Integer(39));
        requestFocusInWindow();
    }
};
 public void addKeyBinding()
{
    int c = JComponent.WHEN_IN_FOCUSED_WINDOW;
    InputMap inputMap = getInputMap(c);
    ActionMap actionMap = getActionMap();
    inputMap.put(KeyStroke.getKeyStroke("D"), "for");
    actionMap.put("for", forward);
    inputMap.put(KeyStroke.getKeyStroke("released D"), "r_for");
    actionMap.put("r_for", r_forward);
} 
```

Applet 类只不过是“add(new World())”。正如我所说，小程序在 Eclipse 中运行时运行良好，但在 Firefox/Opera 中运行时，播放器在按下“D”键后开始运行，然后小程序失去焦点，而播放器继续运行。有时我可以通过单击鼠标强制小程序保持焦点，但即使这样我也无法阻止播放器运行。似乎 KeyEvent 一直在触发。此外，如果我在 java 首选项下显示了 java 控制台（似乎控制台要求所有 keyevents），我什至无法获得 KeyEvent，即使我在控制台弹出后关闭控制台也是如此。我尝试使用 KeyListener 而不是 KeyBinding，结果完全相同。我还有一个 Mouselistener，它在所有场景中都能正常工作。如果相关的话，我正在 Mac 上运行。

我可以强制小程序不失去输入焦点吗？（为什么会失去焦点？）为什么事件会一直触发？即使显示了控制台，是否可以给小程序焦点？

# php - API 接口的最佳实践：传递要使用的数组或对象？

> ID：13924390
> 
> 赞同：2
> 
> 时间：2012-12-18T00:12:22.993
> 
> 标签：php, api, oop, architecture

我正在开发一个支付库，它允许我通过相同的接口实现任何支付处理器。我现在遇到的问题是我想改进向处理器提供数据的方式。现在它是一个数组，我对那个数组不满意。问题是，如果您事先不知道所有字段，您最终会收到通知，或者处理器代码本身将需要大量检查。这个想法是能够采用任何类型的数据结构，因为它在应用程序之间有所不同，并使其与处理器一起工作，同时确保处理器获得所需的数据馈送。

我现在的想法是将其更改为对象。该对象将带有一组有限的字段，所有处理器都需要并且通常具有共同点，但可以扩展该对象以获取其他字段。

这样做的好处是我可以在处理器中验证它是否传递了一个支付对象，并且它可以验证它是否实现了所有必需的字段，如果没有抛出异常。

所以现在的问题是，这是否是一种好方法，或者是否有更好的失败保存方法来确保所有处理器都可以依赖传递的数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T00:20:55.980

在您的情况下，我可能会使用类似于以下的架构：

类`payment_data`-> 此类将具有所有通用字段并可能提供一些通用数据验证，您还可以使用特定处理器特定实现对其进行子类化，其中某些处理器可以接受特定处理器逻辑的附加数据。如果无法根据您的验证规则成功构造此对象，则甚至无需将此对象传递给支付处理逻辑。

接口`payment_processor`-> 此接口将定义任何特定于处理器的实现类都需要能够处理基础`payment_data`对象的通用方法。

特定于处理器的类实现`payment_processor`-> 这些类都能够处理一个基本`payment_data`对象，但可以选择传递一个特定于处理器的子类，该子类`payment_data`实现该处理器的附加功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T00:22:07.027

我已经完成了您正在做的事情，并且坚持使用数组。数组可以非常快速地检查是否缺少任何必需的“字段”。如果数组键是字段名称，则创建一个必填字段数组并使用它来测试是否存在必填字段。

```
function loadData($data) {
     static $rqd_fields = array('field1','field2','field3');
     $passed_fields = array_keys($data);
     $missing_fields = array_diff($rqd_fields, $passed_fields);
     if ( count($missing_fields)>0 ) {
         // error, return $missing_fields
     } else {
         // ok, continue
     }
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T00:15:05.540

一个对象是一个好方法；它足够通用，可以为您提供相当多的灵活性。一定要对接口进行编码，以最大限度地提高灵活性。

当然，您如何设计对象很重要...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-18T00:18:09.067

你有正确的想法。我建议您使用具有 __construct 的所有所需元素的模型，并根据需要在其他任何地方注入模型（这当然是一个对象）。通过这种方式，您可以非常轻松地在界面中使用各种模型。

# ruby - Getter、Setter 和实例变量

> ID：13924392
> 
> 赞同：0
> 
> 时间：2012-12-18T00:12:50.250
> 
> 标签：ruby, getter-setter

[这是尝试学习/理解 Ruby setter 和 getter 方法](https://stackoverflow.com/questions/8737421/trying-to-learn-understand-ruby-setter-and-getter-methods)的引述：

> 您的示例中发生的情况是您正在初始化一个新对象（Human.new），然后使用恰好定义实例变量（即，仅用于该实例的变量），然后最终使用另一个方法调用检索该实例变量。

问题：为什么需要用另一个方法调用来检索实例变量？我在某个地方读到了 Ruby 中的所有实例变量都是私有的。这是否意味着当焦点传递到另一个实例/对象时，实例变量被破坏和/或不可访问，因此需要方法调用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T01:09:42.810

它不是真的。设置某些内容时，将返回新值。例如：

```
foo = 'bar' #=> "bar" 
```

还：

```
class Foo
  def bar=(obj)
    @bar = obj
  end
  def bar
    @bar
  end
end

f = Foo.new
f.bar = "FOO" # returns "FOO"
f.bar         # Now also returns "FOO" 
```

使用另一种方法的目的只是当您想稍后访问该变量时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T18:19:37.763

如果您愿意，您可以选择公开实例变量，ruby 提供以下语法：

```
class Foo
  attr_reader :bar

  def initialize(bar)
    @bar = bar
  end
end

foo_instance = Foo.new('some_value')
puts foo_instance.bar # => 'some_value' 
```

您将在 class Foo 行下看到 attr_reader，这使得 @bar 的任何值都是可检索的。

您还可以打开实例变量以进行修改：

```
 class Foo
    attr_accessor :bar

    def initialize(bar)
      @bar = bar
    end
  end

 foo_instance = Foo.new('some_value')
 puts foo_instance.bar # => 'some_value'
 foo_instance.bar = 'another_value'
 puts foo_instance.bar # => 'another_value' 
```

这是使用 attr_accessor 完成的，让您可以查看 @bar 内容并对其进行更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T01:15:31.623

私有实例变量无法从其实例外部访问。

这通常很有用，因为它允许您的类跟踪其他对象不应该看到的内部状态。但是，如果您希望允许其他对象从您的类的实例中检索值，您可以提供一个 getter 方法来公开该值。

从 getter 访问值的对象通常与最初设置这些值的对象不同。例如，我们可以将这个问题表示为一个对象。德鲁设置了问题的文本。现在这个问题不是很有用，除非我们其他人也有办法获得问题的文本以便我们阅读它。如果没有 getter，我们不太可能创建有用的答案对象。甚至 Drew 也可能想使用那个 getter，因为 Andrew 出现并编辑了问题，而 Drew 可能想知道下一个文本是什么样的。

# python - heapq.heapify 不适用于子类列表

> ID：13924393
> 
> 赞同：3
> 
> 时间：2012-12-18T00:12:52.090
> 
> 标签：python, list, heap, subclass

我希望每次`heapq.heapify`函数更改堆列表中的元素时都收到回调通知（顺便说一句，需要跟踪列表中的对象以及它们的索引如何更改）。

我的计划是继承`list`并覆盖`__setitem__`我将跟踪列表中更改的方法。所以这是子类：

```
class List2(list):

    def __setitem__(self, key, value):
        print 'setitem: key=',key,' value=',value
        list.__setitem__(self, key, value)

    def __getitem__(self, key):
        print 'getitem: key=',key
        return list.__getitem__(self, key) 
```

然后我创建一个实例`List2`并为它调用 heapify：

```
h = List2([12, -3, 0, 5, 1, 7])
heapq.heapify(h) 
```

问题是覆盖`__setitem__`的不是从内部调用的`heapq.heapify`。看起来`heapq.heapify`将 List2 的实例视为默认列表。我想这与`heapq.heapify`内置函数的事实有关，但我仍然不明白。

为什么`__setitem__`不调用被覆盖的对象`heapq.heapify`？

这里有趣的是，如果我将 heapq 的代码复制粘贴到我的本地模块中（因此它不再是内置函数），那么它会按预期工作并且我会调用`List2.__settiem__`，但它不适用于默认 (内置）`heapq`。

Python 2.7 如果重要的话

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T02:21:51.133

作为 Python 3.0 项目的一部分，同样对于 3.3，他们通过文档更明确地说明了当某事采用 a`list`与一般`sequence type`or `mutable sequence type`or`iterable`时，并且在 3.3 中[`heapq`](http://docs.python.org/3/library/heapq.html)明确表示`list`，这意味着在 2.7 中也是如此。

如果您跟踪代码，如果您有 C 实现， in[`_heapqmodule.c`](http://hg.python.org/cpython/file/2.7/Modules/_heapqmodule.c)显`heapify`式调用`PyList_Check`以验证该类型是真实的`list`而不是类似`list`的序列。这不会捕获 的子类`list`，但您可以看到它直接调用`PyList_GETSIZE`and （在 内`_siftup`） `PyList_GET_ITEM`and `PyList_SET_ITEM`，因此它将`list`子类视为基础`list`对象。（从当前的主干开始，这并没有改变。）

所以，有几种方法可以解决这个问题。

首先，正如@FogleBird 建议的那样，您可以只 fork 的纯 Python 实现——[`heapq`](http://hg.python.org/cpython/file/2.7/Lib/heapq.py)只需将完全相同的东西复制到您的项目中，给它一个不同的名称，然后删除第`from _heapq import *`318-321 行的位。

但是，这可能会慢很多。

从 CPython 切换到[PyPy](http://pypy.org)可能会自动解决这个问题（这也意味着无论您是否愿意，您都将获得纯 Python 实现）。

事实上，我对包含 1,000,000 个项目的列表进行了快速测试。在验证 PyPy 确实使用`List2`该类之后，我对其进行了修改，而不是打印，而是将字符串存储到全局变量中。（否则，在 Mac 上打印的时间是实际工作的 3 倍，在 Windows 上是 40 倍……）然后我用各种不同的 Python 运行它：

*   CPython 2.7.2 64 位 Mac：2.079s
*   CPython 3.3.0 64 位 Mac：1.997s
*   CPython 3.3.0 32 位 Mac：2.197s
*   PyPy 2.7.2/1.9.0 64 位 Mac：1.619s

*   CPython 2.7.3 32 位 Win：3.997s

*   PyPy 2.7.21.9.0 32 位 Win：2.334s

因此，尽管实际上调用了我的 Python 列表覆盖，PyPy 还是把其他所有东西都吹走了。（我没有测试 Jython 或 IronPython——部分原因是 JVM 或 .NET 的启动和预热时间太长，以至于您需要更长的测试才能完全公平……但它们也必须使用纯 Python`heapq`模块.)

但这可能是一个比你想要的更剧烈的变化。另一种选择也是分叉`_heapqmodule.c`。即使您根本不了解 C API，这实际上也只是一个搜索和替换的工作。对于每个`PyList_FOO`函数，将其替换为相应的[`PySequence_Foo`](http://docs.python.org/2/c-api/sequence.html)函数（`PyList_SIZE`-> `PySequence_Size`、`PyList_GETITEM`->`PySequence->GetItem`等）。并在它出现的两个地方替换模块名称。就是这样。然后构建模块，并让你的 fork`myheapq.py`尝试`import _myheapq`代替`import _heapq`. 这仍然不会像内置实现那么快，但这只是因为它会多次调用你的`__getitem__`and`__setitem__`方法，这正是你想要的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T00:47:45.390

`heapq``_heapq`如果可用，则使用 C 实现。

当您将`heapq`模块复制到本地包时，`_heapq`找不到，并且`Python implementation`get 使用了，它确实使用了`__setitem__`并且`__getitem__`您可以找到类似`heap[pos] = heap[childpos]`in 的语句`_siftup`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T00:44:37.697

heapq 使用本机代码（如果您的平台上可用），我认为这是问题所在，尽管我不完全理解原因。

也许您可以采用不同的方法，并跟踪列表项的原始索引。

```
>>> n = [12, -3, 0, 5, 1, 7]
>>> m = [(v, i) for i, v in enumerate(x)]
>>> heapq.heapify(m)
>>> m
[(-3, 1), (1, 4), (0, 2), (5, 3), (12, 0), (7, 5)] 
```

然后你可以在 heapify 之后提取值和索引......

```
>>> values, indicies = zip(*m)
>>> values
(-3, 1, 0, 5, 12, 7)
>>> indicies
(1, 4, 2, 3, 0, 5) 
```

**编辑**：我试图通过提供一个不是从列表派生的类的实例来“欺骗”heapq。它不起作用，它需要列表，大概是因为本机代码出于性能原因将其用作假设。

```
>>> class List(object):
...     def __init__(self, data):
...         self.data = data
...     def __getitem__(self, key):
...         print 'getitem', key
...         return self.data[key]
...     def __setitem__(self, key, value):
...         print 'setitem', key, value
...         self.data[key] = value
... 
>>> x = List([12, -3, 0, 5, 1, 7])
>>> heapq.heapify(x)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: heap argument must be a list 
```

**编辑 2**：注意 heapq.py 中的这段代码。这会覆盖 Python 实现。

```
# If available, use C implementation
try:
    from _heapq import *
except ImportError:
    pass 
```

**编辑 3**：Python 文档讨论了您的根本问题。即“如果一个待处理的任务需要被删除，你如何找到它并从队列中移除它？”

[http://docs.python.org/2/library/heapq.html#priority-queue-implementation-notes](http://docs.python.org/2/library/heapq.html#priority-queue-implementation-notes)

这个想法是简单地将条目标记为已删除。当您在优先级队列的顶部看到这些项目时，您会忽略它们。该文档有示例代码。

# sql - 记录对 SQL 数据库所做的更改

> ID：13924394
> 
> 赞同：1
> 
> 时间：2012-12-18T00:13:00.770
> 
> 标签：sql, database, triggers, ddl-trigger

我有一个包含表、字段和索引的 sql 数据库，它会不断地进行修改和修改。我希望能够在每次对内容进行任何更改时记录下来，包括被操作的特定表/字段数据的旧版本、新版本、日期和进行这些更改的用户。在表格视图中拥有一个输出格式，其中每一个都作为列是理想的。

在研究了如何做到这一点之后，似乎使用触发器是一个不错的方法。但是，我之前没有写过触发器或使用过 SQL。我将如何实施呢？

我正在使用 VS2008，C#。显然，我现在的问题非常广泛，因为我脑子里只有这个概念，不知道如何编写代码来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T00:19:54.437

[假设 Sql Server - 这是一个基于本文](http://www.sqlteam.com/article/using-ddl-triggers-in-sql-server-2005-to-capture-schema-changes)创建 DDL 触发器的示例。

首先，创建一个表来保存日志...

```
CREATE TABLE [dbo].[ChangeLog](
    [LogId] [int] IDENTITY(1,1) NOT NULL,
    [DatabaseName] [varchar](256) NOT NULL,
    [EventType] [varchar](50) NOT NULL,
    [ObjectName] [varchar](256) NOT NULL,
    [ObjectType] [varchar](25) NOT NULL,
    [SqlCommand] [varchar](max) NOT NULL,
    [EventDate] [datetime] NOT NULL CONSTRAINT 
        [DF_EventsLog_EventDate]  DEFAULT (getdate()),
    [LoginName] [varchar](256) NOT NULL,
    [UserName] [varchar](256) NULL,
    CONSTRAINT [PK_ChangeLog] PRIMARY KEY CLUSTERED ([LogId] ASC)
) 
```

接下来，创建触发器...

```
CREATE TRIGGER [TrgDDLChangeLog]
ON DATABASE
FOR  

    CREATE_PROCEDURE, ALTER_PROCEDURE, DROP_PROCEDURE,
    CREATE_TABLE, ALTER_TABLE, DROP_TABLE,
    CREATE_FUNCTION, ALTER_FUNCTION, DROP_FUNCTION,
    CREATE_VIEW, ALTER_VIEW, DROP_VIEW,
    CREATE_TRIGGER, ALTER_TRIGGER, DROP_TRIGGER,
    CREATE_INDEX, ALTER_INDEX, DROP_INDEX

AS

DECLARE @Event XML
SET @Event = EVENTDATA()

INSERT INTO dbo.ChangeLog
(
    DatabaseName, 
    EventType, 
    ObjectName, 
    ObjectType, 
    SQLCommand, 
    LoginName,
    UserName
)
VALUES
(
    @Event.value('(/EVENT_INSTANCE/DatabaseName)[1]', 'VARCHAR(256)'),
    @Event.value('(/EVENT_INSTANCE/EventType)[1]', 'VARCHAR(50)'), 
    @Event.value('(/EVENT_INSTANCE/ObjectName)[1]', 'VARCHAR(256)'), 
    @Event.value('(/EVENT_INSTANCE/ObjectType)[1]', 'VARCHAR(25)'), 
    @Event.value('(/EVENT_INSTANCE/TSQLCommand)[1]', 'VARCHAR(max)'), 
    @Event.value('(/EVENT_INSTANCE/LoginName)[1]', 'VARCHAR(256)'),
    @Event.value('(/EVENT_INSTANCE/UserName)[1]', 'VARCHAR(256)')
) 
```

# objective-c - 在 Xcode for iOS 中使用依赖静态库的问题

> ID：13924395
> 
> 赞同：2
> 
> 时间：2012-12-18T00:13:07.493
> 
> 标签：objective-c, xcode, static-libraries

我正在为 iOS 开发一个应用程序。我创建了一个静态库，它自己编译没有问题。

我按照这些说明设置了我的静态库。 [http://www.blog.montgomerie.net/easy-xcode-static-library-subprojects-and-submodules](http://www.blog.montgomerie.net/easy-xcode-static-library-subprojects-and-submodules)

我还添加了一个“复制标头”构建阶段，然后将所有标头添加为公共的，因为这与注释链接中描述的完全不一样。

然后我将它推送到 Git 存储库。

按照链接文章中的所有说明进行操作后，当我尝试构建时，我收到 150 个 Apple Mach-O 链接器错误。这是输出日志[http://pastebin.com/Ma2tCK1w](http://pastebin.com/Ma2tCK1w)

只有在我开始在应用程序项目中使用静态库后才会出现错误 - 只需添加静态库不会导致任何问题。

有没有其他人遇到过这个？我包含了所有正确的框架，并且所有源文件都被编译到静态库中。在这一点上我没有想法，我基本上遵循了我在任何论坛、SO等上找到的所有指南或答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T00:43:10.807

在那篇博文中创建的示例静态库非常基础，只需要链接到基本的 3 个 iOS 框架`UIKit.framework`：`Foundation.framework`和`CoreGraphics.framework`. 因为 iOS 应用程序项目模板都包含使用这 3 个框架的“链接二进制文件与库”构建阶段步骤，所以他能够在他的 iOS 应用程序中包含静态库，而无需额外的步骤。

根据您的构建输出，您的静态库使用许多其他框架的功能，例如`AddressBook.framework`, `AddressBookUI.framework`, `CFNetwork.framework`, `CoreData.framework`, `EventKit.framework`, `EventKitUI.framework`, `MediaPlayer.framework`, `MessageUI.framework`, `OpenGLES.framework`, `QuartzCore.framework`, `SystemConfiguration.framework`,`libxml2.dylib`以及可能的其他框架。您需要确保将所有这些框架/dylib 添加到您的主 iOS 应用程序项目中，并将它们包含在“Link Binary with Libraries”构建阶段，就像它们包含在静态库的链接构建阶段一样。

# javascript - 我可以在 IOS Webkit Copy/Define 弹出菜单中添加菜单项吗？

> ID：13924404
> 
> 赞同：5
> 
> 时间：2012-12-18T00:13:51.853
> 
> 标签：javascript, ios, css, html, webkit

我正在开发一个基于 webkit 的应用程序，用于在 iPad 上使用。当用户选择一些文本时，默认情况下会弹出复制/定义（如果选择了短语，则仅复制）。我希望能够将菜单项附加到此菜单或将其关闭并保留突出显示功能。

我的最终目标是，当用户选择一些文本时，我可以在突出显示的文本旁边设置一个“创建突出显示”按钮，然后调用一个 JavaScript 函数来保存突出显示并将文本包围在 span 标签中。

拥有 Copy 菜单加上我自己的菜单是合理的，但不是最好的主意，因为它看起来有点笨重。我可以关闭 Copy 菜单，但这也会禁用 webkit/iOS 中的突出显示功能。

有什么建议么？我需要完全用 JavaScript(jQuery)、CSS 或 HTML5 来编程。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-26T13:32:49.803

我不太了解 iOS 的 Webkit / Webview 接口，但如果它是 MacOS，是的，可以使用以下方法，
1 -- 你需要实现[WebUIDelegate](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/WebKit/Protocols/WebUIDelegate_Protocol/Reference/Reference.html#//apple_ref/doc/uid/20001915)
2 -- 实现[ContextMenu 方法](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/WebKit/Protocols/WebUIDelegate_Protocol/Reference/Reference.html#//apple_ref/doc/uid/20001915)

希望有帮助...

# java - 如何始终将双精度值的精度设置为 ##.## 形式？

> ID：13924409
> 
> 赞同：1
> 
> 时间：2012-12-18T00:14:24.133
> 
> 标签：java, formatting, double, precision

我目前正在尝试为始终具有 ##.## 形式的 android 游戏创建计时器。

我遇到的问题是，如果我的计时器达到 23.50，它将设置为 23.5

所以，我试图将我的双精度值的精度设置为小数点后 2 位。到目前为止，这是我的代码，它不起作用。任何建议都非常感谢，谢谢。

```
public void onTick(long millisUntilFinished) {
    double time1 = (double) millisUntilFinished/1000;
    DecimalFormat df = new DecimalFormat("##.##");
    timerDisplay.setText(df.format(time1));
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T00:16:10.203

您可以使用：

```
DecimalFormat df = new DecimalFormat("#0.00"); 
```

# oauth - 使用 OAuth 保护我的 Google 网站

> ID：13924410
> 
> 赞同：0
> 
> 时间：2012-12-18T00:14:33.943
> 
> 标签：oauth, google-sites

我已经使用 Google 协作平台建立了一个新站点。我很确定有一些选项可以通过登录保护我的网站并与 OAuth 集成，但我找不到正确的设置页面。此外，我缺少可以设置邮件列表的“组”选项卡。我是否需要特殊的 Google 帐户才能访问这些功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T18:20:00.397

您可以从 google 站点内进行站点级别和页面级别的保护。您不需要 OAuth 来执行此操作。访问者不需要为您的站点做单独的登录保护。

在编辑模式下进入站点时 ->**更多**->**管理站点**
**共享和权限**

从这里您可以设置：
- 如果该站点是公开可见的，或者仅对您希望他们访问该站点的人可见。
- 如果您打开页面级别的权限*，*您可以对每个单独的页面执行相同的操作。

用户无权访问的页面，根本不会出现在菜单中。

# twitter-bootstrap - WebSphere - 资源解释为样式表/脚本，但使用 MIME 类型 text/html 传输

> ID：13924415
> 
> 赞同：1
> 
> 时间：2012-12-18T00:14:52.683
> 
> 标签：twitter-bootstrap, websphere, websphere-liberty

这是一个非常令人沮丧的问题。我的 Web 应用程序有一个登录页面，HTML 如下所示。如您所见，我使用的是 WebSphere Application Server 提供的基于表单的身份验证*(auth-method=FORM)*，因此使用了表单 action="j_security_check"。

这在我的本地 WAS Liberty Edition Server v8.5 上本地运行良好，所有 CSS 都正确呈现。但是当我将它部署到远程服务器（IBM WAS v8.0.0.5）并使用 Chrome/FF/IE8 打开应用程序时，会发生以下情况，a。未应用样式表 b. 我在 Chrome 网络工具中看到以下错误——资源被解释为样式表，但使用 MIME 类型 text/html 传输：“ [http://example.com:9081/PSSU/login2.html](http://example.com:9081/PSSU/login2.html) ”。login2.html：c。即使我尝试登录，浏览器显示的也是 bootstrap.css 文件 b。其他 HTML 页面使用 stlying 渲染得很好

我检查了服务器 VirtualHosts 中的 MIME 类型，我可以看到 application/javascript（对于 .js）和 text/css（对于 .css）的定义。

**我在这里错过了什么吗？任何指针/帮助将不胜感激。**

*PS：在Tomcat容器中的行为也是一样的*

```
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Sign in ...</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="assets/css/bootstrap.css" rel="stylesheet">
    <style type="text/css">
      body {
        padding-top: 40px;
        padding-bottom: 40px;
        background-color: #f5f5f5;
      }

      .form-signin {
        max-width: 300px;
        padding: 19px 29px 29px;
        margin: 0 auto 20px;
        background-color: #fff;
        border: 1px solid #e5e5e5;
        -webkit-border-radius: 5px;
           -moz-border-radius: 5px;
                border-radius: 5px;
        -webkit-box-shadow: 0 1px 2px rgba(0,0,0,.05);
           -moz-box-shadow: 0 1px 2px rgba(0,0,0,.05);
                box-shadow: 0 1px 2px rgba(0,0,0,.05);
      }
      .form-signin .form-signin-heading,
      .form-signin .checkbox {
        margin-bottom: 10px;
      }
      .form-signin input[type="text"],
      .form-signin input[type="password"] {
        font-size: 16px;
        height: auto;
        margin-bottom: 15px;
        padding: 7px 9px;
      }

    </style>
    <link href="assets/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>

  <body>
    <div class="container">
      <form class="form-signin" action="j_security_check" method="post">
        <h2 class="form-signin-heading">Please sign in</h2>
        <input id="j_username" name="j_username" type="text" class="input-block-level" placeholder="Email address">
        <input id="j_password" name="j_password" type="password" class="input-block-level" placeholder="Password">
        <button class="btn btn-large btn-primary" type="submit">Sign in</button>
      </form>
    </div> <!-- /container -->

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="assets/js/jquery-1.8.3.js"></script>
    <script src="assets/js/bootstrap-transition.js"></script>
    <script src="assets/js/bootstrap-alert.js"></script>
    <script src="assets/js/bootstrap-modal.js"></script>
    <script src="assets/js/bootstrap-dropdown.js"></script>
    <script src="assets/js/bootstrap-scrollspy.js"></script>
    <script src="assets/js/bootstrap-tab.js"></script>
    <script src="assets/js/bootstrap-tooltip.js"></script>
    <script src="assets/js/bootstrap-popover.js"></script>
    <script src="assets/js/bootstrap-button.js"></script>
    <script src="assets/js/bootstrap-collapse.js"></script>
    <script src="assets/js/bootstrap-carousel.js"></script>
    <script src="assets/js/bootstrap-typeahead.js"></script>
  </body>
</html> 
```

# java - 简单的java聊天室

> ID：13924421
> 
> 赞同：0
> 
> 时间：2012-12-18T00:15:37.677
> 
> 标签：java, client, chatroom, java-server

很简单，我想创建一个接受多个客户端的聊天室，所有这些客户端都可以分配自己的 ID。每当他们输入任何内容时，它都会发送给所有用户。目前我有一个回显客户端服务器，客户端输入一些内容并回显。我的第一个问题是如何允许用户给自己一个用户名？显然我需要一个变量来接受名称你建议我把它放在什么类中？以及我将如何获得名称本身类似于 `if (theInput.equalsIgnoreCase("username" : "`“））

然后我需要做的就是回应客户对所有客户所说的话。我不知道如何做到这一点，所以任何建议都将不胜感激。虽然我在网上找到了一些教程和示例代码，但我不理解它，如果我不理解它，即使它确实有效，我也会感到不舒服。谢谢

这是我的代码：EchoClient

```
'// echo client
import java.util.Scanner;
import java.io.*;
import java.net.*;
public class EchoClient {
public static void main(String[] args) throws IOException { 
    Socket echoSocket = null;
    //PrintWriter socketOut = null;
    try {
        echoSocket = new Socket("127.0.0.1", 4444); // connect to self at port 4444
        System.out.println("Connected OK");
        Scanner socketIn = new Scanner(echoSocket.getInputStream());  // set up input from socket
        PrintWriter socketOut = new PrintWriter(echoSocket.getOutputStream(), true);    // set up output to socket
        Scanner kbdIn = new Scanner(System.in);     // Scanner to pick up keyboard input
        String serverResp = "";
        String userInput = kbdIn.nextLine();        // get input from the user

        while (true) {
            socketOut.println(userInput);                   // send user input to the socket
            serverResp =  socketIn.nextLine();     // get the response from the socket
            System.out.println("echoed back: " + serverResp);   // print it out
            if (serverResp.equals("Closing connection")) { break; } //break if we're done
            userInput = kbdIn.nextLine();   // get next user input
        }
        socketOut.close();
        kbdIn.close();
        socketIn.close();
    }
    catch (ConnectException e) {
        System.err.println("Could not connect to host");
        System.exit(1);
    }
    catch (IOException e) {
        System.err.println("Couldn't get I/O for connection");
        System.exit(1);
    }
    echoSocket.close();
} 
```

}'

回声服务器

```
// multiple (threaded) server
import java.net.ServerSocket;
import java.net.Socket;
public class EchoServerMult {
public static void main(String[] args) throws Exception {
    ServerSocket serverSocket = new ServerSocket(4444);   // create server socket on this machine
    System.err.println("Started server listening on port 4444");
    while (true) {        // as each connection is made, pass it to a thread
        //new EchoThread(serverSocket.accept()).start();  // this is same as next 3 lines
        Socket x = serverSocket.accept();   // block until next connection
        EchoThread et = new EchoThread(x);
        et.start();  
        System.err.println("Accepted connection from client");
    }
} 
```

}

回声线

```
// thread to handle one echo connection
import java.net.*;
import java.io.*;
import java.util.Scanner;
public class EchoThread extends Thread {
private Socket mySocket = null;

public EchoThread(Socket socket) {       // constructor method
    mySocket = socket;
}
public void run() {
    try {
        PrintWriter out = new PrintWriter(mySocket.getOutputStream(), true);
        Scanner in = new Scanner(mySocket.getInputStream());
        String inputLine;
        while (true) {
            inputLine = in.nextLine();      
            if (inputLine.equalsIgnoreCase("Bye")) {
                out.println("Closing connection");
                break;      
            } else {
                out.println(inputLine);
            }
        }
        out.close();
        in.close();
        mySocket.close(); 
    } catch (Exception e) {
        System.err.println("Connection reset");   // bad error (client died?)
    }
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T08:19:02.807

最简单的可能是拥有一个所有客户端都使用[观察者模式](http://en.wikipedia.org/wiki/Observer_pattern)连接到的公共类（当它们被创建时） 。该链接甚至提供了一些 java 代码。

要让客户端拥有用户名，最简单的方法就是让服务器发送的第一条消息是“输入您想要的用户名：”，然后按原样获取返回值。否则，您可以只使用`inputLine.substring(int)`从 获取用户名`username:{username}`。您可以将用户名存储在 EchoThread 中。避免重复的用户名需要您在 EchoServer 中存储一组用户名。然后，您可以将用户名与消息一起传递给 Observable 类。

目前，您的程序使用顺序消息传递，因为客户端和服务器交替发送消息（更具体地说，客户端发送一条消息，然后服务器发送回相同的消息）。您需要更改此设置，以便客户端可以随时接收消息。您可以通过在客户端创建一个仅发送或仅接收的线程来执行此操作（并在客户端本身执行另一个）。在客户端：

```
...
System.out.println("Connected OK");
PrintWriter socketOut = new PrintWriter(echoSocket.getOutputStream(), true);    // set up output to socket
new ReceiverThread(echoSocket).start();
while (true)
{
   String userInput = kbdIn.nextLine();        // get input from the user
   socketOut.println(userInput);                   // send user input to the socket
}
... 
```

ReceiverThread 内部运行方法`try ... catch`：（其余看起来与 EchoThread 相同）

```
Scanner in = new Scanner(mySocket.getInputStream());
while (true)
{
   String inputLine = in.nextLine();      
   if (inputLine.equalsIgnoreCase("Bye"))
   {
      out.println("Closing connection");
      System.exit(0);      
   }
   else
   {
      out.println(inputLine);
   }
} 
```

System.exit() 可能不是最好的主意，但这只是为了让您知道该怎么做。

# deflate - DeflateStream 压缩/解压缩不一致

> ID：13924422
> 
> 赞同：0
> 
> 时间：2012-12-18T00:15:52.253
> 
> 标签：deflate, dotnetzip, deflatestream

我从使用 zip 压缩 (RFC1951) 的 Photoshop 文件中获得以下数据：

```
250, 255, 159, 1, 47, 248, 63, 42, 63, 172, 229, 1, 2, 12, 0, 209, 255, 31, 225 
```

解压缩为以下 x16：

```
255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
```

重新压缩这给了我：

```
251, 255, 159, 1, 47, 248, 63, 42, 63, 172, 229, 1 
```

为什么这与原始输入不完全相同？

（最初发布在 codeplex 但没有得到答案：[http](http://dotnetzip.codeplex.com/discussions/406943) ://dotnetzip.codeplex.com/discussions/406943 ）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T03:46:31.410

首先，为了正确使用术语，RFC 1951 是 deflate 格式（您的数据是），而不是“zip-compression”。zip 可以使用 deflate，但 deflate 数据随后会使用 zip 标头、预告片和目录进行包装。

其次，一般来说，没有任何保证减压-压缩总是会给你同样的东西。大多数压缩器具有不同的压缩级别和其他选项，可以为相同的输入提供不同的压缩输出。无损压缩器唯一保证的是压缩-解压缩会给你同样的东西。

对于您的特定示例，第一个压缩器放入了一些无关的空块（其中两个）。那个放气流被反汇编了：

```
static
literal 255 255 0
match 29 1
literal 255
match 258 32
match 221 32
end
!
static
end
!
last
static
end 
```

第二个压缩器不包括无关的空块：

```
last
static
literal 255 255 0
match 29 1
literal 255
match 258 32
match 221 32
end 
```

# firewall - 如何使用 scapy 检测防火墙

> ID：13924423
> 
> 赞同：0
> 
> 时间：2012-12-18T00:15:55.357
> 
> 标签：firewall, scapy

我在计算机 A 上打开一个端口 4000 并从另一台远程计算机 B 发送一个数据包，但 A 没有收到数据包，我想可能是企业防火墙过滤了数据包，我该如何检测到呢？scapy 或其他工具中是否有任何 traceroute 功能可以检测到这一点？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T13:35:10.140

您在 scapy 中使用的功能是什么，您是如何打开端口的？防火墙的检测取决于防火墙的类型和网络期限。

scapy 中的 traceroute ==> traceroute("www.google.com", maxttl=10)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-15T20:02:49.533

首先使用 nmap 通过不同的 tcp 扫描类型（例如：-sS/-sT）探测端口以检查它是否打开，如果它有效，然后制作一个类似于此的数据包：

"ans,unans=sr(IP(dst="rhost here"/TCP(flags="S",sport=RandShort(), dport=4000, verbose=0, timeout=2" then -> ans.show()

如果您收到 SA(SYN/ACK) 响应，则端口打开并且在此端口上禁用过滤，否则当您收到 RA(RST/ACK) 或如果没有响应（SYN 标志设置）时过滤它会关闭

# java - 回文中的forloop

> ID：13924424
> 
> 赞同：1
> 
> 时间：2012-12-18T00:15:58.037
> 
> 标签：java, loops, for-loop

我正在练习字符串回文。我的 for 循环中的代码对吗？

```
public static void main (String args[]) 
{
    String word = JOptionPane.showInputDialog("Input a String:");
    String finalword = word.replaceAll(" ","").toLowerCase();

    for (int x = word.length(); x >= word.length()-1; x--) 
    {
        finalword.charAt(x);
    }

    if(word.equals(finalword)) 
    {
        JOptionPane.showMessageDialog(null, "Palindrome");
    }
    else 
    {
        JOptionPane.showMessageDialog(null, "Not a Palindrome");
    }
} 
```

感谢你并致以真诚的问候。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T00:20:46.917

当您启动 x 时，该值将是单词的长度。它应该是

int x = word.length() -1

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T01:17:09.060

1.  您需要处理的实际字符串是 finalword，因为它的长度对您很重要。

2.  为简单起见，取两个临时数组，如 tempStart 和 tempLast，两者的长度必须与 (finalword.length /2) 相同，不要担心字符串有偶数或奇数个字符。

3.  使用带有两个变量的 for 循环，如下所示。

    ```
     for(int x = 0, y=finalword.length(); x<finalword.length() / 2; x++,y--){
       // check tempStart and tempLast has same chars.
       // I hope you know rule for palindrome.
     } 
    ```

4.  如果这两个数组（tempStart 和 tempLast）匹配，则它的回文不匹配。

我希望这能帮到您。如果不让我知道您在执行此操作时需要更多帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T00:21:14.343

int x = word.length(); 会给你字符数组的长度，即

```
"Racecar".length();
// 7 
```

然后在数组中是数组 [7]，但你真的想要 6

# java - 在父 Java 类中注入样板代码

> ID：13924426
> 
> 赞同：3
> 
> 时间：2012-12-18T00:16:06.507
> 
> 标签：java, api, oop, service, abstract

我正在尝试编写一个客户端库，`HttpClient`用于向/从 Web 服务器发送和接收信息。这个库的核心是一个`WebClient`类：

```
public class WebClient {
    public String send(String apiUrl) {
        // Use HttpClient to send a message to 'apiUrl', such as:
        // http://example.com?a=1&response=xml
        //
        // Wait for a response, and extract the HTTP response's body out
        // as raw text string. Return the body as a string.
    }
} 
```

再说一次，这是我正在编写的*库*`mylib.jar`（ ）。一个由各种不同*服务*组成的库，其中每个服务都有 1+ 方法，API 开发人员可以使用这些方法将数据读/写到服务器。所以服务如下：

```
WidgetService
    getAllWidgets
    getMostExpensiveWidget
    getLastWidgetUpdated
    etc...
FizzService
    getFizzById
    getFizziestFizz
    etc...
BuzzService
    etc...
... 
```

每个服务方法将采用 1+ Java 原语或 1+ 模型实例（实体、值对象等）。**每个**服务方法都会返回一个这样的模型对象。例如：

```
public class FizzService {
    public Fizz getFizzById(Long fizzId) {
        // ...
    }

    public Fizz getFizzByBuzz(Buzz buzz) {
        // ...
    }
} 
```

这一点很重要，因为这意味着`WebClient#send()`最终需要将接收到的 HTTP 响应正文映射回 Java 对象。

从 API 开发人员的角度来看，我只希望开发人员实例化每个服务实例，将其传递给`WebClient`后台使用，然后让服务完成参数和 api url 之间以及 HTTP 响应主体和模型/实体之间的所有映射。

例如：

```
public class FizzService {
    private WebClient webClient;
    private FizzApiBuilder fizzApiBuilder;

    // Getters & setters for all properties...

    public Fizz getFizzByBuzz(Buzz buzz) {
        // apiCall == "http://example.com/fizz-service/getFizzByBuzz?buzz_id=93ud94i49&response=json"
        String apiCall = fizzApiBuilder.build(buzz).toString();

        // We asked API to send back a Fizz as JSON, so responseBody is a JSON String representing
        // the correct Fizz.
        String responseBody = webClient.send(apiCall);

        if(apiCall.contains("json"))
            return JsonFizzMapper.toFizz(reponseBody);
        else
            return XmlFizzMapper.toFizz(responseBody);
    }
}

// What the API developer writes:
WebClient webClient = WebClientFactory.newWebClient();
FizzService fizzSvc = new FizzService(webClient);

Buzz b = getBuzz();

Fizz f = fizzSvc.getFizzByBuzz(b); 
```

到目前为止，我喜欢这个设置。但是，对于所有服务中的*每个**服务*方法，我都需要**相同的“样板”代码**：

 **```
String apiCall = someBuilder.build(...)
String responseBody = webClient.send(apiCall)
if(apiCall.contains("json"))
    return JsonMapper.toSomething(responseBody)
else
    return XmlMapper.toSomething(responseBody) 
```

这开始闻起来像是抽象的主要用例。理想情况下，我希望将所有这些样板代码放在一个 中`AbstractService`，并让每个服务扩展该抽象类。只有一个问题：

```
public abstract class AbstractService {
    private WebClient webClient;
    private ServiceApiBuilder apiBuilder;

    // Getters & setters for all properties...

    public Object invoke(Object... params) {
        // apiCall == "http://example.com/fizz-service/getFizzByBuzz?buzz_id=93ud94i49&response=json"
        // The injected apiBuilder knows how to validate params and use them to build the api url.
        String apiCall = apiBuilder.build(params).toString();

        String responseBody = webClient.send(apiCall);

        if(apiCall.contains("json"))
            return jsonMapper.to???(reponseBody);
        else
            return xmlMapper.to???(responseBody);
    }
}

public class FizzService extends AbstractService { ... } 
```

问题是，将功能抽象为一个使构建 API 调用的`AbstractService`事情*变得尴尬（但并非不可能），但更糟糕的是，***我完全不知道**如何创建和注入一组 JSON/XML 映射器，这些映射器将知道什么模型/要映射到的实体`responseBody`。

这一切都开始发臭了。当我的代码发臭时，我会寻找解决方案，如果找不到，我会来这里。所以我问：*我是否采取了根本错误的方法，如果是，我的方法应该是什么？如果我很接近，那么我如何注入正确的映射器并让这段代码闻起来更好？*请记住我的代码片段显示了我希望 API 开发人员如何实际使用模型/服务 - 这是这里的最终目标。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T17:22:20.127

正如评论中提到的，我们在编译时知道我们想要发出的请求类型和响应类型，所以我不会让代码在运行时简单地处理这些事情，以便可以将其提取到一个基类。您必须为其编写额外的代码才能做出这些决定，这只会为细微的错误留下空间。此外，让 API 构建器仅根据参数计算出要进行的调用将使您陷入困境；例如`getMostExpensiveWidget`，`getLastWidgetUpdated`两者听起来都像无参数方法，那么 API 构建器类如何知道要做什么？

因此，假设我们将为 API 构建器类提供用于不同 API 调用的单独方法。还假设映射器类上的方法不是静态的。然后该`getFizzByBuzz`方法可能如下所示：

```
public Fizz getFizzByBuzz(Buzz buzz) {
    String apiCall = fizzApiBuilder.buildForBuzz(buzz).toString();
    String responseBody = webClient.send(apiCall);
    return jsonFizzMapper.toFizz(reponseBody);
} 
```

同样，该`getFizzById`方法可能如下所示：

```
public Fizz getFizzById(Long fizzId) {
    String apiCall = fizzApiBuilder.buildForId(fizzId).toString();
    String responseBody = webClient.send(apiCall);
    return xmlFizzMapper.toFizz(reponseBody);
} 
```

这两种方法都遵循相同的模式，并且它们的不同之处在于特定的 API 构建器方法（例如`buildForBuzz`vs `buildForId`）和特定的响应映射器（`jsonFizzMapper`vs `xmlFizzMapper`），因为我们不想在运行时做出这些决定。因此，唯一真正的冗余是对 Web 客户端的调用。假设`JsonFizzMapper`并`XmlFizzMapper`实现一些`FizzMapper`接口，我的下一步是在`FizzService`类中创建以下私有方法：

```
private Fizz sendRequest(String apiCall, FizzMapper responseMapper) {
    String responseBody = webClient.send(apiCall);
    return responseMapper.toFizz(reponseBody);
} 
```

`getFizzByBuzz`现在`getFizzById`看起来像这样：

```
public Fizz getFizzByBuzz(Buzz buzz) {
    String apiCall = fizzApiBuilder.buildForBuzz(buzz).toString();
    return sendRequest(apiCall, jsonFizzMapper);
}

public Fizz getFizzById(Long fizzId) {
    String apiCall = fizzApiBuilder.buildForId(fizzId).toString();
    return sendRequest(apiCall, xmlFizzMapper);
} 
```

我认为这是纯粹和实用主义之间的一个很好的平衡。理想情况下，您只需将 sendRequest 方法传递给构建器方法（例如`buildForBuzz`），但是您必须跳过接口和匿名类方面的障碍似乎并不值得。

如果您想更进一步，您可以使 sendRequest 方法通用，然后将其放入抽象基类中（或者最好支持[组合而不是继承](http://en.wikipedia.org/wiki/Composition_over_inheritance)并将其放入完全独立的类中），然后您需要使您的映射器接口通用. 但是，由于该类仅包含一个两行方法，因此在我看来，这可能不值得。因此，我认为为每个服务类创建相应的私有方法应该没问题，但是如果您认为它可能会变得更复杂，请在其他地方提取功能。**

# zend-framework2 - ZF2 内景

> ID：13924429
> 
> 赞同：0
> 
> 时间：2012-12-18T00:16:30.970
> 
> 标签：zend-framework2

我想制作一个具有以下行为的界面：

```
HTML output for /a/.
<ul>
<li>html output for /a/1/</li>
<li>html output for /a/2/</li>
<li>html output for /a/3/</li>
</ul> 
```

因此，猜测 /a/ 的视图将运行一个函数，该函数获取 /a/1/、/a/2/ 等每个的 html。

显然，我的路由器将包含两个单独的控制器函数，用于 /a/ 和 /a/[:number]，而我的 /a/[:number] 控制器函数将返回带有 setTerminal(true) 的 ViewModel。

页面加载后，我可以使用 ajax 调用每个 URL，我这样做的原因是我想稍后单独更新这些 html 片段，但在第一次调用时，渲染速度应该更快调用 /a/ 时的那些 HTML 部分。

如我所见，我需要一个返回 /a/[:number]/ 的 HTML 的函数，所以我的**问题**是，我该怎么做？我可以使用什么功能？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T07:21:17.577

您将编写一个视图助手（扩展 Zend\View\Helper\AbstractHelper）。视图助手需要以下信息：

*   渲染路线
*   允许渲染的参数（即 1-10）

在您的视图中，您会调用视图助手，例如：

```
$this->linkGenerator('a', array(1, 10)); //render all from /a/1 to /a/10 
```

您的视图助手看起来像这样：

```
namespace Mynamespace\View\Helper;

use Zend\View\Helper\AbstractHelper;

class LinkGenerator extends AbstractHelper
{
    public function __invoke($routeName, array $range)
    {
        return $this->getView()->render('mynamespace/view/helper/linkgenerator.phtml', array(
            'route' => $routeName,
            'range' => $range
        ));
    }
} 
```

最后你`linkgenerator.phtml`看起来像这样：

```
<ul>
    <?php foreach($this->range as $value) : ?>
    <li>
         <a href="<?php echo $this->url($this->route, array('id', $value));?>">
             ####RouteLabel!?
         </a>
    </li>
    <?php endforeach; ?>
</ul> 
```

现在路线标签将是更棘手的事情之一。由于 ID 将具有不同的标签（假设），您可能需要从 viewhelper 调用导航配置或数据库并相应地获取标签。

tableGateway/Mapper/EntityRepository 的注入将在`__construct()`函数内完成。

您将通过注册视图助手时分配的工厂注入所需的东西，如下所示：

```
 public function getViewHelperConfig()
    {
        return array(
            'factories' => array(
                'linkGenerator' => function ($sm) {
                    $someDependency= $sm->getServiceLocator()->get('some-dependency');

                    return new \Mynamespace\View\Helper\LinkGenerator($someDependency); //<- this is for __construct() ;)
                }
            )
        );
    } 
```

希望这涵盖了您的问题。我想其他一切都会归结为javascript。

# android - 如何进行静默安装（从根植的 android 设备内部）

> ID：13924431
> 
> 赞同：0
> 
> 时间：2012-12-18T00:16:41.780
> 
> 标签：android, apk, root, silent-installer

我目前正在尝试找到某种方法，以实用的方式将更新安装到使用 Android 的设备上：

*   没有用户输入的手段
*   没有互联网或网络
*   正在运行 Android 4.0

这就是为什么我希望默默地做到这一点。最坏的情况是每次我想更新时都将它连接到 PC 上，但这正是我想要避免的。

输入来自外部 SD 卡。

从我到目前为止发现的情况来看，似乎有几种方法可以奏效：

*   [Root 在 /data/app 上将 chmod 设置为 777 （并且不关心安全性）](https://stackoverflow.com/questions/5803999/install-apps-silently-with-granted-install-packages-permission)
*   网络上的appbrain（对我没用）
*   编写/重写操作系统（过去我的专业知识）

所以我的问题如下：

我需要什么程序才能做到这一点，我该如何去做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T00:29:31.297

这就是我为有同样问题的人使用的方法和方法。

*   首先我安装了busybox（似乎我需要这个来安装，因为pm和adb调用都不起作用）
*   安装终端模拟器（这样我就可以检查命令是否有效并在手机上使用 chmod）

*   运行终端并输入 su -s

现在终端显示 # 而不是 $ 我现在可以授予我安装所需的权限。

现在从我的应用程序中，我可以使用busybox 调用安装。

```
Runtime.getRuntime().exec("/system/bin/busybox install " + ToInstall.getAbsolutePath() + " /system/app"); 
```

就我而言，ToInstall 是我从设备中找到的文件。

**笔记：**

这安装很奇怪我必须使用以下内容来删除

```
rm /system/app/AppName 
```

它看起来也很奇怪，但没关系，因为我没有屏幕

可能需要设置繁忙箱路径的权限才能使其正常工作。我可以从终端以 su 模式执行此操作。据说702可以工作，尽管我使用777并不担心安全性。

```
 chmod 702 system/bin/busybox 
```

# ruby-on-rails - Heroku 的 Rails 模板错误

> ID：13924432
> 
> 赞同：1
> 
> 时间：2012-12-18T00:16:55.180
> 
> 标签：ruby-on-rails, heroku

当我部署到 heroku 时，当我尝试创建一个嵌套在蓝图中的新评论时，我抛出并出错。我已经尝试了很多，以至于我什至不记得把它全部写在这里。如果我遗漏了一些明显的东西，请告诉我。谢谢！

```
2012-12-18T00:07:26+00:00 app[web.1]: Processing by CommentsController#new as HTML
2012-12-18T00:07:26+00:00 app[web.1]:   Parameters: {"blueprint_id"=>"1"}
2012-12-18T00:07:26+00:00 heroku[router]: at=info method=GET path=/blueprints/1/comments/new host=aeh.herokuapp.com fwd=68.200.131.243 dyno=web.1 queue=0 wait=0ms connect=3ms service=44ms status=500 bytes=643
2012-12-18T00:07:26+00:00 app[web.1]: Completed 500 Internal Server Error in 8ms
2012-12-18T00:07:26+00:00 app[web.1]: 
2012-12-18T00:07:26+00:00 app[web.1]:   app/views/comments/_form.html.erb:29:in `block in _app_views_comments__form_html_erb___740426380689644965_39997500'
2012-12-18T00:07:26+00:00 app[web.1]: 
2012-12-18T00:07:26+00:00 app[web.1]: ActionView::Template::Error (undefined method `category' for #<Comment:0x00000005109730>):
2012-12-18T00:07:26+00:00 app[web.1]:     30:     </div>
2012-12-18T00:07:26+00:00 app[web.1]:   Rendered comments/new.html.erb within layouts/application (5.4ms)
2012-12-18T00:07:26+00:00 app[web.1]:   Rendered comments/_form.html.erb (3.1ms)
2012-12-18T00:07:26+00:00 app[web.1]:     28:     <div class="controls">
2012-12-18T00:07:26+00:00 app[web.1]:     27:     <%= f.label :category, :class => 'control-label' %>
2012-12-18T00:07:26+00:00 app[web.1]:   app/views/comments/new.html.erb:6:in `_app_views_comments_new_html_erb___765962496684666744_33764340'
2012-12-18T00:07:26+00:00 app[web.1]:     26:   <div class="control-group">
2012-12-18T00:07:26+00:00 app[web.1]:   app/views/comments/_form.html.erb:1:in `_app_views_comments__form_html_erb___740426380689644965_39997500'
2012-12-18T00:07:26+00:00 app[web.1]: 
2012-12-18T00:07:26+00:00 app[web.1]:     32: 
2012-12-18T00:07:26+00:00 app[web.1]:     29:       <%= f.text_field :category, :class => 'text_field' %>
2012-12-18T00:07:26+00:00 app[web.1]:     31:   </div>
2012-12-18T00:07:26+00:00 app[web.1]:   app/controllers/comments_controller.rb:35:in `new'
2012-12-18T00:07:27+00:00 heroku[web.1]: Stopping all processes with SIGTERM
2012-12-18T00:07:27+00:00 app[web.1]: [2012-12-18 00:07:27] ERROR SignalException: SIGTERM
2012-12-18T00:07:27+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/webrick/server.rb:90:in `select'
2012-12-18T00:07:28+00:00 heroku[web.1]: Starting process with command `bundle exec     rails server -p 46647` 
```

_form 部分如下

```
<%= form_for [@blueprint, @comment], :html => { :class => 'form-horizontal' } do |f| %>
 <div class="control-group">
<%= f.label :comment, :class => 'control-label' %>
<div class="controls">
  <%= f.text_area :comment, :class => 'text_area' %>
</div>
</div> 
<div class="control-group">
 <%= f.label :blueprint_id, :class => 'control-label' %>
  <div class="controls">
   <%= f.number_field :blueprint_id, :class => 'number_field' %>
 </div>
 </div>
 <div class="control-group">
 <%= f.label :user_id, :class => 'control-label' %>
  <div class="controls">
  <%= f.number_field :user_id, :class => 'number_field' %> 
  </div>
 </div>
 <div class="control-group">
<%= f.label :project_id, :class => 'control-label' %>
<div class="controls">
   <%= f.number_field :project_id, :class => 'number_field' %>
 </div>
  </div>
 <div class="control-group">
 <%= f.label :category, :class => 'control-label' %>
  <div class="controls">
   <%= f.text_field :category, :class => 'text_field' %>
 </div>
 </div>

 <div class="form-actions">
   <%= f.submit nil, :class => 'btn btn-primary' %>
    <%= link_to t('.cancel', :default => t("helpers.links.cancel")),
              blueprint_comments_path(@blueprint), :class => 'btn' %>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T21:55:17.607

“通过将迁移添加到本地端并再次推送到 heroku 来修复。”

# javascript - 添加和删 除唯一的 jQuery 事件（onUnique/offUnique？）

> ID：13924439
> 
> 赞同：1
> 
> 时间：2012-12-18T00:18:01.720
> 
> 标签：javascript, events, jquery

我想要一些方法来向元素添加和删除唯一的命名事件，这样我就可以确保事件不会被添加超过一次。当您将事件添加到元素时，它们会相互堆叠，即使其中两个是同一个事件。对于一个简单但抽象的示例：

```
$('a').on("click", function(e){ console.log("Hi One"); }); // 1
$('a').on("click", function(e){ console.log("Hi One"); }); // duplicate
$('a').on("click", function(e){ console.log("Hi Two"); }); // 2
// Output will be: Hi One, Hi One, Hi Two 
```

我尝试使用 .off().on() 之类的方法，但一次只允许一个事件。

```
$('a').off("click").on("click", function(e){ console.log("Hi One"); }); 
$('a').off("click").on("click", function(e){ console.log("Hi One"); }); 
$('a').off("click").on("click", function(e){ console.log("Hi Two"); });
// Output will be: Hi Two 
```

所以我想出了这个jQuery扩展：

```
$.fn.onUnique = function (
    /* uniqueEventName, events [,selector] [,data], handler(eventObject) */
) {
    var uniqueEventNameArray    = this.data("uniqueEvents") || [];
    var uniqueEventName         = arguments[0];
    if ($.inArray(uniqueEventName, uniqueEventNameArray) == -1) {
        uniqueEventNameArray.push(uniqueEventName);
        this.data("uniqueEvents", uniqueEventNameArray);
        this.on(arguments[1], arguments[2], arguments[3], arguments[4]);
    }
}; 
```

这样就可以得到我想要的效果了...

```
$('a').onUnique("Hi1", "click", function(e){ console.log("Hi One"); }); 
$('a').onUnique("Hi1", "click", function(e){ console.log("Hi One"); }); 
$('a').onUnique("Hi2", "click", function(e){ console.log("Hi Two"); });
// Output will be: Hi One, Hi Two 
```

我的问题有两个：

1.  有一个更好的方法吗？
2.  我将如何做相当于 .offUnique() 的操作，它只会删除指定的事件（按名称）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T00:21:01.410

查看命名空间事件：[`event.namespace`](http://api.jquery.com/event.namespace/)

```
$('a').off('click.hi1').on('click.hi1', function(e){ console.log("Hi One"); });
$('a').off('click.hi1').on('click.hi1', function(e){ console.log("Hi One"); });
$('a').off('click.hi2').on('click.hi2', function(e){ console.log("Hi Two"); }); 
```

演示[http://jsfiddle.net/gaby/378rP/](http://jsfiddle.net/gaby/378rP/)

* * *

但是，您可能应该尝试更好地组织您的代码，这样您就不会两次应用相同的事件..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T00:35:05.353

.on() 支持您正在寻找的一切。您不仅可以使用唯一的事件名称，还可以通过链接或事件映射映射多个事件：

```
$('a').on('click.h1', function(){console.log('Hi One')}).on('click.h2', function(){console.log('Hi Two')}); 
```

或者

```
$('a').on({
    'click.h1' : function(){console.log('Hi One')},
    'click.h2' : function(){console.log('Hi Two')}
});
$('a').off('click.h1');
//Output is 'Hi Two' 
```

# python - 为什么我会收到错误：ValueError：int() 的无效文字，基数为 10：'1 -3 10 6 5 0 3 -5 2'

> ID：13924440
> 
> 赞同：-3
> 
> 时间：2012-12-18T00:18:07.197
> 
> 标签：python, integer

我试图通过说使字符串成为整数

```
file = open(input("Please enter the name of the file you wish to open:" ))
while True:
    A = file.readline() 
    if(A):
        array.append(int(A[0:len(A)-1]))
    else:
        break
print("The numbers in the file are:", A)
file.close() 
```

我创建的文件有数字：`1 -3 10 6 5 0 3 -5 20`

这是错误：

```
ValueError: invalid literal for int() with base 10: '1 -3 10 6 5 0 3 -5 2' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T00:20:30.300

阅读错误 -`'1 -3 10 6 5 0 3 -5 2'`不是一个数字。这是一个`list`数字。你需要先把它变成一个字符串列表。

另外，您不应该真正使用`.close()`. 改为使用`with`。

```
fname = input("Please enter the name of the file you wish to open:" )
with open(fname) as f:
    for line in f:
        a = [int(num) for num in line.split()]
        print a 
```

# java - grails 命名约定

> ID：13924443
> 
> 赞同：1
> 
> 时间：2012-12-18T00:18:09.940
> 
> 标签：java, grails, groovy

作为 Grails、Groovy 甚至 Java 的新手，我想知道为什么许多 Grails 开发人员使用命名约定，例如

**com.{projectName}.{className}**

首先按 com 组织它们有什么意义（这甚至意味着什么？），然后是项目名称（当它已经在项目文件夹中时）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-18T00:19:43.017

更多的是 Java 标准。请参阅[http://docs.oracle.com/javase/tutorial/java/package/namingpkgs.html](http://docs.oracle.com/javase/tutorial/java/package/namingpkgs.html)

> 公司使用他们的反向 Internet 域名来开始他们的包名——例如，com.example.mypackage 表示由 example.com 的程序员创建的名为 mypackage 的包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T01:02:57.263

在 Java 中，目的是让代码在可能有不同公司的不同作者时能够很好地发挥作用。例如，我编写了一个具有用户概念的应用程序，并将其分配给默认包。我需要使用您的框架/库，它也具有分配给默认包的用户的概念。应该加载哪个用户以及何时使用？通过基于一个公司的反向域名进行打包，我们可以根据每个公司的定义和使用来组织User对象，我们的代码可以共存。

# ruby-on-rails - Rails 在设定的时间后导致动作发生

> ID：13924444
> 
> 赞同：2
> 
> 时间：2012-12-18T00:18:13.203
> 
> 标签：ruby-on-rails, ruby, cron

我正在开发一个可以比作拍卖网站的应用程序。

“拍卖”有一个固定的截止日期，所以我的问题是，当那个时间发生时，如何将这个拍卖设置为“结束”。

例如

拍卖 A：2012 年 12 月 25 日上午 9:00 结束。

我如何确保它此时“关闭”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T02:04:22.093

我会简单地使用时间戳，以及方法和范围。

1.  为您的模型添加时间戳，也许可以调用它`open_until`
2.  在您的模型中定义一个`closed?`（也许是`open?`）方法来检查时间戳`Time.now`
3.  为您的模型添加一个`closed`（也许是`open`）[范围。](http://guides.rubyonrails.org/active_record_querying.html#working-with-times)也许将其中之一设置为 `default_scope` [参考](http://guides.rubyonrails.org/active_record_querying.html#applying-a-default-scope)

使用此设置，您可以即时检查拍卖是打开还是关闭。

```
Auction.open.all      #=> all open auctions
Auction.closed.all    #=> all closed auctions
Auction.first.closed? #=> true if 'open_until' is in the past, false otherwise
Auction.first.open?   #=> true if 'open_until' is in the future, false otherwise 
```

如果您使用`default_scope`（例如`open`），并且需要找到另一个状态的拍卖（例如`closed)`，请确保调用`Auction.unscoped.closed` [reference](http://guides.rubyonrails.org/active_record_querying.html#removing-all-scoping)。

当您需要即时关闭拍卖的选项时（即无需等待`open_until`通过），您可以简单地，无需额外的布尔标志，执行以下操作：

```
def close!
  self.update_attribute(:open_until, 1.second.ago)
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T00:25:03.833

例如，如果`:closed`您的模型上有一个属性`Auction`要在某个时间设置为 true，则需要运行 cron 以定期运行 rake 任务以检查`Auction`要关闭的新 s。

例如，您可以在其中创建一个文件，`lib/tasks/close_auctions.rake`其中包含以下内容

```
namespace :myapp do
  task "close-auctions" => :environment do
    Auctions.where("closes_at < ? and closed = ?", Time.zone.now, false).update_all(closed: true)
  end
end 
```

这可以通过`rake`运行来调用

```
rake myapp:close-auctions 
```

然后，您可以在 crontab 中的 cron 上运行此 rake 任务。每分钟你都会在你的 crontab 中添加这样的东西

```
* * * * * RAILS_ENV=production rake myapp:close-auctions > /dev/null 2>&1 
```

这意味着每一分钟，Rails 都会找到任何`Auction`仍然打开但具有`:closes_at`过去新值的实例，将这些实例标记为关闭。

# python - python函数和类

> ID：13924445
> 
> 赞同：-6
> 
> 时间：2012-12-18T00:18:15.167
> 
> 标签：python, python-3.x

**问题 1：**编写一个名为“Marquee”的函数，它接受一个字符串，并将每个单词的第一个字母大写。
**问题 2：**编写一个完成问题 2 中相同操作的类。我对此并不陌生。如果有人可以指导我完成此操作，将不胜感激。

这是我到目前为止

```
def Marquee (str.capitalize())
    str="this is string example!"
print str.capitalize() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T00:42:50.323

好的，这是一个开始。. .

例如，如果我们使用一个词，比如说。. .

```
word1 = "this" 
```

所以你知道调用 word1.capitalize()，你会得到 . . .

```
This 
```

这就是你如何为一个单词做的，现在你必须将它应用于一个句子。做到这一点的方法是你可能不得不使用基于空格的分割函数来分解句子，比如

```
str.split(" ") 
```

这将返回一个单词列表。遍历列表并创建一个新字符串以将单词连接成一个新句子。例如，你能预测这段代码的输出吗？

```
word1 = "this"
word2 = "is"
word3 = "string"
sentence = (word1.capitalize()+ " " + word2.capitalize() + " " + word3.capitalize())
print sentence 
```

我不知道任何python，但我猜它可能看起来像这样。. .

```
newSentence = ""
for word in str.split(" ")
    newSentence += (word.capitalized() + " ")
print newSentence 
```

现在我们必须将它放在一个函数中，以允许我们输入任何句子并获取它的大写版本。所以我们需要知道如何定义一个函数。. . 这是基本思想，我们首先使用*def*声明一个，然后是函数的*名称*，然后是*参数*：**def name (paramters)**。如果我们没有参数，我们将其留空并使用括号**def name ()**。我们通过返回来结束函数定义。它看起来像这样。. .

```
def Marquee(str):
. . . .
Insert python code to capitalize beginning of every word.
. . . .
return 
```

str 是用户调用的输入，所以如果我说

```
aSentence = "this is string example"
print Marquee(aSentence) 
```

我应该得到

```
This Is String Example 
```

你能弄清楚剩下的吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T01:42:29.713

```
def Marquee (the_string):
    return the_string.title() 
```

你这样调用函数

```
>>> Marquee("this is string example!")
'This Is String Example!' 
```

不确定问题 2 的要求是什么，也许他们希望您将 str 子类化

```
class Question2(str):
    marquee = str.title

print(Question2("this is string example!").marquee()) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T01:44:07.353

```
Marquee = str.title 
```

或者，为了向后兼容旧版本的 Python：

```
import string
Marquee = string.capwords 
```

对于做同样事情的类：

```
class Mar:
    quee = str.title
Marquee = Mar.quee 
```

或者，稍微严重一点：

```
class MarqueeClass(object):
    def __call__(self, s):
        return s.title()
Marquee = MarqueeClass() 
```

实际上，我注意到问题 2 实际上是：

> 问题 2：编写一个完成问题 2 中相同动作的类。

这是一个循环定义，或者可能是一个没有基本情况的递归定义。解释这一点的一种方法是*任何事情*都是允许的。但我认为更严格的解释是，任何实例化类的尝试都会导致无限递归：

```
class MarqueeClass(object):
    def __init__(self):
        self.__init__() 
```

另一方面，“问题 2”也有可能是完成操作的上下文。虽然这不是一个有效的标识符名称，但您仍然可以间接查找它。例如：

```
context = globals()['Question 2']
with context:
    Marquee = str.title 
```

我还要添加一个注释，提醒老师`Marquee`根据 PEP 8 不是一个好的函数名称，以确保老师知道你是个聪明人，而他是个笨蛋。:)

# android - Android 应用程序在启动时崩溃我在哪里可以找到设备日志？

> ID：13924450
> 
> 赞同：-3
> 
> 时间：2012-12-18T00:18:40.147
> 
> 标签：android

我的应用程序在 Android 4.2 中启动应用程序时直接崩溃。如果我在 2.3 上启动它，它可以正常工作。

找出此崩溃原因的最佳做法是什么？安卓设备日志在哪里？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T00:20:18.400

对于 Eclipse：转到 Window -> Show View -> Android -> LogCat。

除此之外，我认为如果您的应用程序在 JB 上崩溃，但在 GB 上没有崩溃，那么我会检查`NetworkOnMainThreadException`.

编辑：您正在主 UI 线程中执行（可能很慢）网络操作。如果您的目标 SDK 是 11 (Honeycomb) 或更高版本，则会抛出 a `NetworkOnMainThreadException` ，因为此行为可能会阻塞 UI 并导致应用程序无响应。

您可以使用 AsyncTask 通过将数据加载到其 doInBackground(..) 中来解决此问题。

# ios - IOS轮换的主要问题

> ID：13924451
> 
> 赞同：0
> 
> 时间：2012-12-18T00:18:44.657
> 
> 标签：ios, rotation, categories, landscape, portrait

我现在已经被这个问题困住了超过 2 周！在我的项目中，我有 1 个 ViewController(slide) 我想同时启用横向和纵向。其余的所有控制器/视图(幻灯片)我只想启用纵向模式。

棘手的部分是，我所指的“ViewController”同时连接到 NavigationControllers 和 TabBarControllers。请参阅下面的方案，其中我要启用横向/纵向的 ViewController 被命名为：***ReferredViewController***。

**TabBarController ----> NavigationController ----> FristViewController --(push event)--> *ReferredViewController***

到目前为止，我已经尝试为 NavigationControllers 和 TabBarControllers创建一个**CATEGORY 。**但是由于我的 NavigationControllers 和 TabBarControllers 放置在项目的最开始，这将为整个项目设置规则。我的 ReferredViewController 放置在项目“故事板”的末尾或中间。我也尝试通过代码为单个 ReferredViewController 设置规则，但没有成功。

到目前为止，我最好的方法是将 FirstViewController 和***ReferredViewController***之间的事件从“推送”更改为“模态”。然后，ReferredViewController 可以同时旋转纵向/横向，并且项目的其余部分被锁定为纵向。但是，正如您可能知道的那样，所有导航都将丢失，用户将被卡在单张幻灯片上。

我还想知道一件事，是否可以在 ModalViewController 中显示 NavigationControllers？我没有尝试/测试过这种情况所有可能的方式，但我们将不胜感激。

如果您对上述方案有任何聪明的提示或动作，请我需要我能得到的所有帮助，我对无法解决这个问题感到非常沮丧！/问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T00:40:20.430

问题是您正在做苹果设计不支持的事情。标签栏旋转的问题是众所周知的，您可以在 stackoverflow 找到许多关于该主题的帖子。
在苹果设计策略中，最顶层的控制器必须允许两种旋转，只有子控制器可以将其减少到一个方向。
如果你想要它的另一种方式，最支持的肖像，和孩子们两者，你是你自己的。
苹果不支持的这些东西非常耗时。
我处于这种情况，没有调用 didRotate..() 。我最终通过使用 CGtransform 自动旋转视图来解决它...，这是我在stackoverflow 中获得的信息。

为了解决这个问题，使用两个视图控制器，一个允许两个方向，一个只允许一个方向。为避免重复代码，您可以从继承的类中调用公共代码。

# php - 简单的递归函数不起作用

> ID：13924456
> 
> 赞同：2
> 
> 时间：2012-12-18T00:19:15.390
> 
> 标签：php, function, recursion, scope

我正在尝试运行递归函数，但它无法正常工作。我在我的代码中看不到任何错误，所以也许这对 PHP 来说是不可能的？

```
<?php

$herpNum = 0;

function herp() {
    if ($herpNum == 22) {
        echo "done";
    } else {
        $herpNum = $herpNum+1;
        echo $herpNum."<br/>";
        herp();
    }
}

herp();

?> 
```

当我运行它时，结果只是一长串 1。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T00:22:41.630

因为 $herpNum 与函数不在同一个范围内，所以它在函数内部创建了一个新的 $herpNum，默认为 0，然后将其加 1。

您可以将其作为参数传入，也可以将其作为全局变量。

```
$herpNum = 0;

function herp($herpNum) {
    if ($herpNum == 22) {
        echo "done";
    } else {
        $herpNum = $herpNum+1;
        echo $herpNum."<br/>";
        herp($herpNum);
    }
}

herp($herpNum); 
```

或者

```
$herpNum = 0;

function herp() {
    global $herpNum;

    if ($herpNum == 22) {
        echo "done";
    } else {
        $herpNum = $herpNum+1;
        echo $herpNum."<br/>";
        herp();
    }
}

herp(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T00:24:13.940

这是因为您没有将参数传递`$herpnum`给函数。

```
<?php

$herpNum = 0;

function herp($herpNum) {
    if ($herpNum == 22) {
        echo "done";
    } else {
        $herpNum = $herpNum+1;
        echo $herpNum."<br/>";
        herp($herpNum);
    }
}

herp($herpNum);

?> 
```

那应该工作

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-18T00:23:49.823

问题是，每次都`$herpNum`被重新定义为一个局部变量的范围内被调用。这将导致递归循环，直到抛出“最大函数嵌套级别'100'达到......”错误。（当您将 php ini 值 'display_errors' 设置为 'On' 时，您可以看到错误）`herp()``herp()`

将上面的代码更改为：

```
$herpNum = 0;

function herp() {
    global $herpNum;
    if ($herpNum == 22) {
        echo "done";
    } else {
        $herpNum = $herpNum+1;
        echo $herpNum."<br/>";
        herp();
    }   
}

herp(); 
```

请注意， if`$herpNum`仅由`herp()`它使用可能会更好地将其声明为`herp()`.

```
function herp() {
    static $herpNum = 0;
    // ... 
```

static 关键字告诉 PHP 解释器它应该只在第一次调用函数时初始化变量一次。这应该完全符合您的设计需求；）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-18T00:25:27.837

尝试 ：

```
$herpNum = 0;

function herp() {
    global $herpNum;
    if ($herpNum == 22) {
        echo "done";
    } else {
        $herpNum = $herpNum+1;
        echo $herpNum."<br/>";
        herp();
    }
}
herp(); 
```

但出于安全原因，不建议这样做。

这是一个例子：

```
...
if( $admin == true ) {
  echo 'yeah! You are the admin!';
}
... 
```

如果`$admin`被声明为全局且未正确验证，则只需键入`http://mysite.com/?admin=true`以使测试通过。

顺便说一句...对于递归，最好将“环境”（一个或多个参数）作为参数注入：

```
herp($herpNum=0); // if nothing is given, $herpNum is set to 0 
```

# filepicker.io - Filepicker.io on iOS doesn't allow picking from Picasa

> ID：13924458
> 
> 赞同：0
> 
> 时间：2012-12-18T00:19:23.050
> 
> 标签：filepicker.io

However an image can be *saved* to Picasa. Is this a limitation of Picasa, or a bug in the SDK? Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T00:30:58.963

Liyan is right, the Picasa option was "below the fold" (*slaps forehead*)

# ruby - 使用 Ruby 按位置将二维数组中的所有元素相加的最清晰方法是什么？

> ID：13924460
> 
> 赞同：1
> 
> 时间：2012-12-18T00:19:29.213
> 
> 标签：ruby, arrays, algorithm

通过它们在Ruby中的位置来添加二维数组中的所有元素的最清晰和最有效的方法是什么。例子：

```
2darray = [[1,2,3],[1,2,3]]
result = [2,4,6] 
```

我有以下代码

```
def sum_elements_by_position(array)
 total_elements = array.length
 result = []

 for i in 0...array.first.length
   n = 0
   array.each { |subarray| n += subarray[i] }
   result << n
 end
 result
end 
```

假设：所有主要元素的长度相同

对于奖励积分，很高兴看到一个适用于任意长度的主要元素的解决方案

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T00:30:32.733

您可以`zip`将第一行与其余行放在一起，然后求和：

```
def sum_elements_by_position(array)
    array[0].zip(*array[1..-1]).map do |col|
        col.inject(:+)
    end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T07:31:46.077

这是行长度不同时的解决方案。

```
def sum_cols arr
  arr.reduce( [] ) do |res,row| 
    row.each_with_index { |e,i| res[i] ||= 0; res[i] += e }
    res
  end
end

irb> sum_cols [ [0,1,2], [3,4], [5,6,7,8] ]
=> [8, 11, 9, 8] 
```

@oldergod 建议根据最长的行使用 zip，但找到最长的行并拒绝 nil 是有代价的。我使用上面的示例数组对上述方法进行了以下基准测试，发现 reduce+each_with_index 方法快了 30% 以上：

```
def sum_cols_using_zip arr
  max_len = arr.map(&:size).max
  ([0] * max_len).zip(*arr).map do |col|
    col.compact.inject(:+)
  end
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T04:43:36.710

我会这样做：

```
a.transpose.map {|x| x.reduce(:+)} 
```

干净、简单、灵活。`.transpose`转这个

```
[[1,2,3,4],[2,3,4,5],[3,4,5,6]] 
```

进入这个

```
[[1, 2, 3], [2, 3, 4], [3, 4, 5], [4, 5, 6]] 
```

然后`.map`应用于`.reduce`每个子数组。`.reduce`反过来，通过添加子值来聚合子值。或者，更准确地说，通过将`+`方法应用于它们。

我强烈建议您阅读这些函数的文档，直到您完全理解这个示例，因为它非常简洁地演示了如何以 Ruby 方式思考！

# php - 用 mysqldump 排除表的语法

> ID：13924461
> 
> 赞同：1
> 
> 时间：2012-12-18T00:19:39.557
> 
> 标签：php, mysql

快疯了。我没有找到这条确切的线，并使用 MySQL 参考中的示例，我显然在这里交叉眼！

这是错误的语法，但我不确定在哪里放置选项 --ignore-table=search_index 并且尝试了许多变体，除了正确的变体！

```
$cmd = "mysqldump -u --ignore-table=search_index " . $prod_db_user . " -p" . $prod_db_pass . " " . $prod_db_1 . " > " . $qa_backup_name; 
```

我只是想转储数据库并排除名为 search_index 的表。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T00:21:45.937

将`$prod_db_user`用户名放在 之后`-u`，因为那是用户名标志。

```
$cmd = "mysqldump -u{$prod_db_user} --ignore-table=search_index  -p{$prod_db_pass} $prod_db_1  > $qa_backup_name"; 
```

由于这是一个双引号字符串，所有 PHP 变量都可以直接进入该字符串。但是，请务必先逃脱他们[`escapeshellarg()`](http://us3.php.net/manual/en/function.escapeshellarg.php)！

```
$prod_db_user = escapeshellarg($prod_db_user);
$prod_db_pass = escapeshellarg($prod_db_pass);
// etc... 
```

最后，根据执行环境，可能需要指定完整路径（如果在(or ) 环境变量`mysqldump`中没有找到）。`$PATH``%PATH%`

```
$cmd = "/path/to/mysqldump -u{$prod_db_user} ...."; 
```

# php - 关闭处理程序和相对路径

> ID：13924465
> 
> 赞同：2
> 
> 时间：2012-12-18T00:19:59.693
> 
> 标签：php, apache, relative-path

创建一个包含 2 个文件的 PHP 项目 -`index.php`其中包含下面的代码和另一个名为`example.png`.

```
echo file_exists('example.png')
    ? 'outside the handler - exists'
    : 'outside the handler - does not exist';

register_shutdown_function('handle_shutdown');

function handle_shutdown()
{
    echo file_exists('example.png')
        ? 'inside the handler - exists'
        : 'inside the handler - does not exist';
}

foo(); 
```

运行`index.php`。

这就是你会得到的：

```
outside the handler - exists
Fatal error: Call to undefined function foo() in /path/to/project/index.php on line 16
inside the handler - does not exist 
```

这是我的问题。

为什么内部`file_exists`（处理程序中的那个）找不到文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T00:27:29.097

我不完全确定原因，但 PHP 文档在注释中确实警告了这一点，`register_shutdown_function()`其中指出：

```
Note:

Working directory of the script can change inside the shutdown function under some web servers, e.g. Apache. 
```

您可以尝试呼应`getcwd()`以了解实际发生的情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T00:27:24.240

请参阅该功能的文档，

[http://php.net/manual/en/function.register-shutdown-function.php](http://php.net/manual/en/function.register-shutdown-function.php)

有一条说明，

```
Working directory of the script can change inside the shutdown function under some web servers, e.g. Apache. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T00:26:32.760

在 PHP 的某些 SAPI 上，在关闭函数中，工作目录可以更改。请参阅手册页上的此注释[`register_shutdown_function`](http://php.net/register_shutdown_function)：

> 脚本的工作目录可以在某些 Web 服务器（例如 Apache）下的关闭功能内更改。

相对路径取决于工作目录。更改后，不再找到该文件。

如果您改用绝对路径，则不会遇到该问题：

```
$file = __DIR__ . '/' . 'example.png';

echo file_exists($file)
    ? 'outside the handler - exists'
    : 'outside the handler - does not exist';

$handle_shutdown = function() use ($file)
{
    echo file_exists($file)
        ? 'inside the handler - exists'
        : 'inside the handler - does not exist';
}

register_shutdown_function($handle_shutdown); 
```

# dapper - 使用 Dapper 映射 Uri 字段

> ID：13924467
> 
> 赞同：2
> 
> 时间：2012-12-18T00:20:06.310
> 
> 标签：dapper

使用 Dapper 将字符串列映射到 Uri 属性的最简洁方法是什么？

这是迄今为止我能想到的最干净的（使用[ITypeMap 功能](https://stackoverflow.com/a/12615036/444917 "ITypeMap")）：

询问：

```
SELECT * FROM TableWithAStringAddressColumn 
```

POCO：

```
public class MyPoco
{   
    [ColumnSetter("DapperAddress")]
    public Uri Address { get; set; }
    private string DapperAddress { set { this.Address = new Uri(value); } }
} 
```

扩展：

```
partial class SqlMapper
{
    public static void InitializeTypeMaps()
    {
        SqlMapper.SetTypeMap(
            typeof(MyPoco),
            new CustomPropertyTypeMap(typeof(MyPoco), SqlMapper.CustomSetterMapper));

        // call out every other class that needs this kind of mapping
    }

    public static Func<Type, string, PropertyInfo> CustomSetterMapper =
        (type, columnName) =>
        {
            PropertyInfo prop = type
                .GetProperties()
                .FirstOrDefault(p => string.Equals(columnName, p.Name, StringComparison.OrdinalIgnoreCase));

            if (prop != null)
            {
                // find out if we need to use a different setter
                ColumnSetterAttribute setterAttribute = prop.GetCustomAttributes(false).OfType<ColumnSetterAttribute>().LastOrDefault();
                if (setterAttribute != null)
                {
                    PropertyInfo setterProp = type
                        .GetProperties(BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance)
                        .FirstOrDefault(p => string.Equals(setterAttribute.Setter, p.Name, StringComparison.OrdinalIgnoreCase));
                    if (setterProp == null)
                    {
                        throw new InvalidOperationException(string.Format("Setter property misconfigured (Property={0}, Setter={1})", prop.Name, setterAttribute.Setter));
                    }
                    else
                    {
                        prop = setterProp;
                    }
                }
            }
            return prop;
        };
} 
```

自定义属性：

```
public class ColumnSetterAttribute : Attribute
{
    public string Setter { get; set; }

    public ColumnSetterAttribute(string setter)
    {
        this.Setter = setter;
    }
} 
```

**[编辑]**我正在寻找一个我可以使用的解决方案，而无需在我的所有查询中调用所有列（我想找到一个我可以使用的解决方案`SELECT *`）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T21:37:13.817

好像工作量很大...

这不就好了吗？

```
public class MyPoco
{
    private string _uriMapper;

    public Uri SomeUri
    {
        get { return new Uri(_uriMapper); }
    }

    public string Mapper { set { _uriMapper = value; } }
} 
```

## 编辑：

```
public class UriContainer
{
    private string _uriMapper;

    public string UriMapper { set { _uriMapper = value; } }

    public int Id { get; set; }

    public Uri SomeUri { get {return new Uri(_uriMapper);} }
}

public class DbTests
{
    [Test]
    public void Can_Get_A_Uri()
    {
        using (var c = new SqlConnection("hello"))
        {
            c.Open();

            var uri = c.Query<UriContainer>("select *, someuri as urimapper from uris where id = 3").Single();

            Console.WriteLine(uri.SomeUri);
        }
    }
} 
```

# xamarin.android - 无法使用 System.XML.Linq

> ID：13924474
> 
> 赞同：3
> 
> 时间：2012-12-18T00:20:43.703
> 
> 标签：xamarin.android, monodevelop

我正在开发一个使用 Mono for Android 的项目。使用 Xamarin 阅读跨平台文档后。我将我的数据层放在一个单独的项目中，并将其移动到我的 Mono for Android 项目，然后将这些文件链接到我的 Mono Touch 项目，有一天可能是 Windows Phone 8 项目。

当我移动代码时，由于 System.Xml.Linq 引用，我现在无法编译。该参考显示在 Mono for Android 项目中，但我无法使用它。我认为瞄准 Froyo 可能是问题所在，但将项目升级到 Gingerbread 或 Ice Cream Sandwich 并没有帮助。

有人知道我做错了什么吗？我是一位经验丰富的 .NET 开发人员，并且非常了解引用在项目中的工作方式，但是这个让我很难过。

原始代码正在处理的项目是针对 Mono/.NET 4 框架

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T01:37:41.227

您对 System.Xml.Linq 的引用是指向 .Net 版本还是 Mono 版本？Mono 的版本为 2.0.5.0。

![Mono System.Xml.Linq 参考](../Images/d2b2f1d546254772b71c359c71e555a5.png)

此外，是在 Android 类库/应用程序或常规 .Net 类库中对 System.Xml.Linq 的引用。如果它是一个 .Net 类库，我会尝试将您的 Android 应用程序中的库作为已编译（dll）引用而不是项目引用来引用。这不是一个完美的解决方案，但我发现当我需要引用跨多个解决方案使用的库时，这很有效。该参考通常可以正常工作，但如果 Mono 版本不支持任何内容，则可能会导致问题。

假设您的代码在类库中，最好的选择可能是创建库项目的 Mono 特定版本。您可以导入和使用相同的类文件，但只需添加一些条件编译符号即可使其为 Mono 正确编译。如果您对此不熟悉，请查看[Json.Net](https://json.codeplex.com/SourceControl/changeset/view/69709)或[ServiceStack](https://github.com/ServiceStack/ServiceStack/tree/master/src)如何管理多个平台的代码。

# css - Extjs 消息框居中对齐

> ID：13924475
> 
> 赞同：0
> 
> 时间：2012-12-18T00:20:46.463
> 
> 标签：css, extjs, extjs4, messagebox, text-align

正如标题所说，我希望 Ext.Msg.alert() 的消息居中对齐。我试过这个：

```
 Ext.Msg.alert({
        title: 'Success',
        msg: 'Deleted',
        buttons: Ext.Msg.OK,
        baseCls: 'msgbox'
    }); 
```

CSS：

```
 .msgbox {
      text-align: center;
  } 
```

它仍然在左对齐。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T04:21:45.237

显示的文本是一个显示字段组件，其大小与其文本相同，即使它居中，您也无法看到它按照您的意愿对齐。

因此，解决方案是使其更大。在我的示例中，我使用 css 类来完成。看看它：

```
var w = Ext.Msg.alert({
        title: 'Success',
        msg: 'Deleted',
        buttons: Ext.Msg.OK,
        autoShow: false,
        cls: 'msgbox'    
});

w.down('.displayfield' ).addCls('displayfield-fullsize'); 
```

正如您可以想象的那样，课程是：

```
.displayfield-fullsize{
       width: 100% !important;
} 
```

在这里看到它的工作：http: [//jsfiddle.net/lontivero/F7HE3/3/](http://jsfiddle.net/lontivero/F7HE3/3/) ​</p>

# java - 使用 CXF 从 java 使用 web 服务会导致 com.sun.xml.ws.client.ClientTransportException: The server sent HTTP status code 200: OK

> ID：13924477
> 
> 赞同：0
> 
> 时间：2012-12-18T00:20:51.520
> 
> 标签：java, soap, wsdl, cxf

我使用 WSDL 编辑器在 Eclipse 中制作了 wsdl 文件。我使用 CXF（maven 插件方式）制作了服务器。我从 C# 成功调用了一个简单的函数 getCities()。但是我无法从 Java 客户端调用它。

```
@WebResult(name = "out", targetNamespace = "")
@RequestWrapper(localName = "getCities", targetNamespace = "http://www.example.org/BookingServer/", className = "org.example.bookingserver.GetCities")
@ResponseWrapper(localName = "getCitiesResponse", targetNamespace = "http://www.example.org/BookingServer/", className = "org.example.bookingserver.GetCitiesResponse")
@WebMethod(action = "http://www.example.org/BookingServer/getCities")
public java.util.List<org.example.bookingserver.Cities> getCities(); 
```

这就是我调用该服务的方式（再次使用 Apache-cxf）：

```
QName SERVICE_NAME = new QName("http://www.example.org/BookingServer/", "BookingServer");
URL wsdlURL = BookingServer_Service.WSDL_LOCATION;
BookingServer_Service ss = new BookingServer_Service(wsdlURL, SERVICE_NAME);
BookingServer port = ss.getBookingServerSOAP();  
java.util.List<org.example.bookingserver.Cities> result = port.getCities(); 
```

但我明白了`javax.ejb.EJBException ... Caused by: com.sun.xml.ws.client.ClientTransportException: The server sent HTTP status code 200: OK`

我无法搜索与此异常相关的任何内容。

我也尝试使用 NetBeans webservice 客户端 GUI，但异常是相同的。当我在服务器中放置断点时，它永远不会中断。所以问题出在客户端。

有人知道我在做什么错吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T17:44:02.090

我不得不更改soap：address，然后主要问题是我使用GUI向导时为Webservice生成的@WebService注释覆盖了CXF生成的接口的@WebService注释。因此webservice的位置是不同的。

# r - 有效地在列表中找到唯一的向量元素

> ID：13924479
> 
> 赞同：9
> 
> 时间：2012-12-18T00:21:00.643
> 
> 标签：r, list, vector

我有一个数字向量列表，我需要创建一个列表，其中只包含每个向量的一个副本。相同的函数没有列表方法，所以我编写了一个函数来应用来检查每个向量。

```
F1 <- function(x){

    to_remove <- c()
    for(i in 1:length(x)){
        for(j in 1:length(x)){
            if(i!=j && identical(x[[i]], x[[j]]) to_remove <- c(to_remove,j)
        }
    }
    if(is.null(to_remove)) x else x[-c(to_remove)] 
} 
```

问题是随着输入列表 x 大小的增加，这个函数变得非常慢，部分原因是 for 循环分配了两个大向量。我希望有一种方法可以在一分钟内运行一个长度为 150 万且向量长度为​​ 15 的列表，但这可能是乐观的。

有谁知道将列表中的每个向量与其他所有向量进行比较的更有效方法？向量本身保证长度相等。

示例输出如下所示。

```
x = list(1:4, 1:4, 2:5, 3:6)
F1(x)
> list(1:4, 2:5, 3:6) 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-18T01:42:52.030

根据@JoshuaUlrich 和@thelatemail，`ll[!duplicated(ll)]` 工作得很好。
因此，`unique(ll)` 我之前是否应该建议一种使用 sapply 的方法，其想法是不检查列表中的每个元素（我删除了那个答案，因为我认为使用`unique`更有意义）

## 由于效率是一个目标，我们应该对这些进行基准测试。

```
# Let's create some sample data
xx <- lapply(rep(100,15), sample)
ll <- as.list(sample(xx, 1000, T))
ll 
```

### 将其与一些指标相提并论

```
fun1 <- function(ll) {
  ll[c(TRUE, !sapply(2:length(ll), function(i) ll[i] %in% ll[1:(i-1)]))]
}

fun2 <- function(ll) {
  ll[!duplicated(sapply(ll, digest))]
}

fun3 <- function(ll)  {
  ll[!duplicated(ll)]
}

fun4 <- function(ll)  {
  unique(ll)
}

#Make sure all the same
all(identical(fun1(ll), fun2(ll)), identical(fun2(ll), fun3(ll)), 
    identical(fun3(ll), fun4(ll)), identical(fun4(ll), fun1(ll)))
# [1] TRUE

library(rbenchmark)

benchmark(digest=fun2(ll), duplicated=fun3(ll), unique=fun4(ll), replications=100, order="relative")[, c(1, 3:6)]

        test elapsed relative user.self sys.self
3     unique   0.048    1.000     0.049    0.000
2 duplicated   0.050    1.042     0.050    0.000
1     digest   8.427  175.563     8.415    0.038
# I took out fun1, since when ll is large, it ran extremely slow 
```

## 最快的选择：

```
unique(ll) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-18T00:27:40.517

您可以散列每个向量，然后用于`!duplicated()`识别结果字符向量的唯一元素：

```
library(digest)  

## Some example data
x <- 1:44
y <- 2:10
z <- rnorm(10)
ll <- list(x,y,x,x,x,z,y)

ll[!duplicated(sapply(ll, digest))]
# [[1]]
#  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
# [26] 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44
# 
# [[2]]
# [1]  2  3  4  5  6  7  8  9 10
# 
# [[3]]
#  [1]  1.24573610 -0.48894189 -0.18799758 -1.30696395 -0.05052373  0.94088670
#  [7] -0.20254574 -1.08275938 -0.32937153  0.49454570 
```

为了一目了然地了解它的工作原理，下面是哈希的样子：

```
sapply(ll, digest)
[1] "efe1bc7b6eca82ad78ac732d6f1507e7" "fd61b0fff79f76586ad840c9c0f497d1"
[3] "efe1bc7b6eca82ad78ac732d6f1507e7" "efe1bc7b6eca82ad78ac732d6f1507e7"
[5] "efe1bc7b6eca82ad78ac732d6f1507e7" "592e2e533582b2bbaf0bb460e558d0a5"
[7] "fd61b0fff79f76586ad840c9c0f497d1" 
```

# javascript - Backbone 的 trigger() 是同步的还是异步的？

> ID：13924482
> 
> 赞同：11
> 
> 时间：2012-12-18T00:21:18.277
> 
> 标签：javascript, backbone.js

我正在构建一个通用的主干视图来管理多个子视图。我有时需要在渲染这些视图之前执行逻辑来准备它们。我正在考虑使用 Backbone 事件来启用 pre_render 钩子，如下所示：

```
view = new (this.child_view);
this.trigger('pre_render', view);
view.render(); 
```

调用的事件`trigger()`是否会同步执行，从而保证在`render()`调用该行之前全部完成？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-18T00:30:25.467

基本上，是的，它是同步的。

以下是来源的相关部分：

```
trigger: function(name) {
  if (!this._events) return this;
  var args = slice.call(arguments, 1);
  if (!eventsApi(this, 'trigger', name, args)) return this;
  var events = this._events[name];
  var allEvents = this._events.all;
  if (events) triggerEvents(this, events, args);
  if (allEvents) triggerEvents(this, allEvents, arguments);
  return this;
}, 
```

导入函数是`triggerEvents`，它实际上调用了处理程序。根据[评论](http://backbonejs.org/docs/backbone.html#section-17)，它只是一个优化的调度程序。请注意，它们都在调用`.call()`and `.apply()`，因此回调将在控制权交还给调用者之前完成。

```
var triggerEvents = function(obj, events, args) {
    var ev, i = -1, l = events.length;
    switch (args.length) {
    case 0: while (++i < l) (ev = events[i]).callback.call(ev.ctx);
    return;
    case 1: while (++i < l) (ev = events[i]).callback.call(ev.ctx, args[0]);
    return;
    case 2: while (++i < l) (ev = events[i]).callback.call(ev.ctx, args[0], args[1]);
    return;
    case 3: while (++i < l) (ev = events[i]).callback.call(ev.ctx, args[0], args[1], args[2]);
    return;
    default: while (++i < l) (ev = events[i]).callback.apply(ev.ctx, args);
    }
}; 
```

但是，正如其他人所提到的，如果触发器处理程序愿意，他们可以自由地安排自己的回调。因此，处理程序在返回之前是否完成工作取决于处理程序代码本身。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T00:30:36.937

是的，它们是同步的。但是，由该事件触发的函数可以自由使用或发出 ajax 请求，如果是这样，则在调用返回并且代码继续调用`setTimeout`时这些请求还没有完成。所以是的，每个绑定的事件处理程序都将被**调用**`trigger``render`**但不一定完成它的整套处理。因为触发器 API 本身不使用回调或承诺，所以没有直接的方法可以知道所有事件处理程序何时完成。如有必要，您必须自己实现这样的 API，并在一切完成时触发不同的事件，包括任何异步处理。然而，在日常编程中，大多数这些事件处理程序都是同步的，如果不是，代码通常是结构化的，以便继续进行不会导致应用程序行为异常。如果您需要更改此合同，您的应用程序设计无法和谐地使用事件系统是一种代码味道，您可能需要考虑不同的方法来解决您的问题。**

 *** * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T00:30:46.723

根据源代码，触发器是同步的，但这并不意味着所有监听“pre_render”事件的函数都会进行同步操作。PS：源代码真的很容易阅读，你应该看看它：

[http://backbonejs.org/docs/backbone.html](http://backbonejs.org/docs/backbone.html)**

# wolfram-mathematica - 欧拉计划 #23 Mathematica

> ID：13924483
> 
> 赞同：1
> 
> 时间：2012-12-18T00:21:27.010
> 
> 标签：wolfram-mathematica

我正在使用 Mathematica解决[Project Euler 的问题 23 ：](http://projecteuler.net/problem=23)

> 找出所有不能写成两个丰富数之和的正整数之和。

回想一下，丰富的数字`#`是这样的`Total[Divisors[#]] - # > #`。这是我的代码：

```
list1 = Table[i, {i, 1, 28123}];
list2 = Select[list1, Total[Divisors[#]] - # > # && 2 * # < 28123 &];
list3 = {};
l = Length[list2];
For[i = 1, i <= l, i++, 
 For[j = i, j <= l, j++, 
  list3 = Append[list3, list2[[i]] + list2[[j]]]]];
Total[Complement[list1, list3]] 
```

它非常慢；嵌套`For`循环需要花费大量时间来评估。

我是否正确地解决了这个问题？有没有办法让它更快？

**编辑：**背后的原因`28123`是任何大于它的数字都可以写成两个丰富数字的总和。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T05:04:44.990

用这个替换你制作 list3 的循环。

```
list3 = (list2[[#]] + list2[[# ;; -1]]) & /@ Range[Length[list2]] // Flatten; 
```

在我的旧电脑上计时为 0.49 秒

**更新**

回答我的答案中构造的 list3 给出错误解决方案的抱怨。

出色地。它提供与使用原始代码构建的 list3 相同的内容。这种方法只是更快。如果原始方法中的构造是错误的，那么我真的无能为力，因为问题是关于如何使它更快，而不是纠正算法本身的任何错误，我不熟悉。假设发布的算法是正确的，但速度很慢。

```
(*28123  replaced with smaller value to check, else will take forevever*)
(*for original algorithm to finish *)

n = 200;
list1 = Table[i, {i, 1, n}];
list2 = Select[list1, Total[Divisors[#]] - # > # && 2*# < n &];
list3 = {};
l = Length[list2];
For[i = 1, i <= l, i++, 
  For[j = i, j <= l, j++, 
   list3 = Append[list3, list2[[i]] + list2[[j]]]]];

mylist3 = (list2[[#]] + list2[[# ;; -1]]) & /@ Range[Length[list2]] //Flatten; 
```

相比

```
list3 - mylist3 
```

![数学图形](../Images/b9467b1d68f34d1939e83b221b33bb6f.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-12-22T17:53:16.133

> （*28123 替换为较小的值来检查，否则将永远花费*）

除非您别无选择，否则我会避免在 Mathematica 中使用 for 循环。我用上述解决方案杀死了内核，因为它似乎需要很长时间才能完成。

下面的解决方案在我的 Macbook 上大约需要 6 秒。正如其他人在欧拉论坛中指出的那样，您可以将上限设置为 20161。

```
Total[Complement[Range[20161], 
      Plus @@ # & /@ 
         Tuples[Select[Range[20161], ((DivisorSigma[1, #] - #) > #) &], 2]]] 
```

**更新：**

阅读其他一些关于优化的线程，我发现替换

`Plus @@ # &``Total[#]&`再刮一秒。

此版本耗时 4.9 秒

```
Total[Complement[Range[20161], 
      Total[#] & /@ 
         Tuples[Select[Range[20161], ((DivisorSigma[1, #] - #) > #) &], 2]]] 
```

# python - PySide：创建自定义 QCursor

> ID：13924485
> 
> 赞同：2
> 
> 时间：2012-12-18T00:21:41.407
> 
> 标签：python, pyside, custom-cursor

我正在尝试**在 PySide中****设置自定义`QCursor`**，但上面没有可用的代码示例。据我了解，有像素图和像素图的掩码，设置为`QPixmap.setMask()`.

我正在做这两个：

```
 open_hand_px = QtGui.QPixmap('open_hand.png')
    open_hand_px.setMask(open_hand_px.mask())
    open_hand_cursor = QtGui.QCursor(pixmap=open_hand_px)
    self.setCursor(open_hand_cursor) 
```

我正在使用的图像加载正常，没有错误，但光标拒绝更改。我不知道我做错了什么。

感谢您的回复！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T08:14:05.087

从[文档](http://srinikom.github.com/pyside-docs/)：

> **关于关键字参数**
> 
> 只有可选参数可以用作关键字参数。

所以，删除`pixmap=`：

```
open_hand_px = QtGui.QPixmap('open_hand.png')
open_hand_px.setMask(open_hand_px.mask())
open_hand_cursor = QtGui.QCursor(open_hand_px)
self.setCursor(open_hand_cursor) 
```

# ruby-on-rails - 在模型导轨中设置嵌套属性

> ID：13924487
> 
> 赞同：0
> 
> 时间：2012-12-18T00:21:45.807
> 
> 标签：ruby-on-rails

我有一个属于用户和公司的日志模型。为了进行设置，我在 logs_controller 的创建操作中有此代码。

```
 def create
     @log = Log.new(params[:log])
     @log.user = current_user
     @log.firm = current_firm
     @log.save
   end 
```

current_user 和 current_firm 是 application_helper.rb 中的辅助方法

虽然这有效，但它会使控制器变胖。我怎样才能把它移到模型上？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T00:32:42.847

我相信这种功能属于`lib/`. 我的操作方法可能看起来像

```
def create
  @log = LogWorker.create(params[:log], current_user, current_firm)
end 
```

然后我会有一个`lib/log_worker.rb`模块

```
module LogWorker
  extend self

  def create(params, user, firm)
    log      = Log.new(params)
    log.user = user
    log.firm = firm

    log.save
  end
end 
```

这是一个简化的例子；我通常命名所有东西，所以我的方法实际上可能在`MyApp::Log::Manager.create(...)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T00:32:34.123

没有区别：您可以重构代码：

```
def create
  @log = Log.new(params[:log].merge(:user => current_user, :firm => current_firm)
  @log.save
end 
```

你的日志必须：

```
attr_accessible :user, :firm 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T00:39:16.150

不会短很多，但是处理 current_user 的责任落在了 MVC 中的控制器身上

```
def create
 @log = Log.create(params[:log].merge(
   :user => current_user,
   :firm => current_firm))
end 
```

*编辑*

如果您不介意稍微违反 MVC，可以使用以下方法：

```
# application_controller.rb
before_filter :set_current
def set_current
  User.current = current_user
  Firm.current = current_firm
end

# app/models/user.rb
cattr_accessor :current

# app/models/firm.rb
cattr_accessor :current

# app/models/log.rb
before_save :set_current
def set_current
  self.firm = Firm.current
  self.user = User.current
end

# app/controllers/log_controller.rb
def create
  @log = Log.create(params[:log])
end 
```

# android - 在android中制作多活动应用程序的最佳方法

> ID：13924489
> 
> 赞同：0
> 
> 时间：2012-12-18T00:21:54.453
> 
> 标签：android, performance, list, android-activity, usability

我正在尝试为 android 制作一个包含多个选项的应用程序，每个选项都取决于前一个选项。

首先，显示一个包含一些选项的列表，在选择一个之后，我向网络服务器数据库发送请愿书并发送回新选项并使用新选项创建一个新活动，依此类推，直到最后一个选项列表。

我使用 asynctask 发送请求并使用 putExtra 在活动之间发送信息。

问题是我不喜欢这种方法。Too many activities and cycling through them is a pain, and when the last option is chosen, I would like to go back to the main screen but I have a bunch of activities to handle first and I dunno how to do it.

我对如何解决这个问题有任何想法吗？是否可以重复使用相同的活动？由于数据库查询不同，每个选项的打包方式也不同。

欢迎任何帮助:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-25T13:19:04.147

从您的 FirstActivity 调用 SecondActivity 使用 startActivityForResult() 方法

例如：

```
Intent i = new Intent(this, SecondActivity.class);
startActivityForResult(i, 1); 
```

在您的 SecondActivity 中设置要返回给 FirstActivity 的数据，如果您不想返回，请不要设置任何数据。

例如：在 secondActivity 如果你想发回数据：

```
 Intent returnIntent = new Intent();
 returnIntent.putExtra("result",result);
 setResult(RESULT_OK,returnIntent);     
 finish(); 
```

如果您不想返回数据：

```
Intent returnIntent = new Intent();
setResult(RESULT_CANCELED, returnIntent);        
finish(); 
```

现在在您的 FirstActivity 类中为 onActivityResult() 方法编写以下代码

```
protected void onActivityResult(int requestCode, int resultCode, Intent data) {

  if (requestCode == 1) {

     if(resultCode == RESULT_OK){      
         String result=data.getStringExtra("result");          
     }
     if (resultCode == RESULT_CANCELED) {    
         //Write your code if there's no result
     }
  }
}//onActivityResult 
```

通过调用 finish() 来销毁一个活动；在上面。它通过 onDestroy(); 或者通过将 good 标志添加到 StartActivity() 中使用的意图；

# twitter-bootstrap - 如何使 Bootstrap 响应式布局在 IE8 上工作

> ID：13924493
> 
> 赞同：19
> 
> 时间：2012-12-18T00:22:11.647
> 
> 标签：twitter-bootstrap, internet-explorer-8, responsive-design, media-queries, fluid-layout

我已经搜索了一段时间，发现有些人让它工作了，但他们都没有提供任何代码示例。

我尝试了他们的建议，但对我没有用。根据建议，我尝试添加`<meta http-equiv="X-UA-Compatible" content="IE=edge" />`,`respond.js`或`css3-mediaqueries-js`，但它们都没有帮助。

这是一个[jsfiddle](http://jsfiddle.net/QnDaM/1/)，如果您使用 IE8 查看它，无论您的浏览器宽度如何，您都会看到两者`a`并且`b`位于同一行。

但是如果您使用 Chrome、FF 或 IE9 或更高版本查看，您会在不同的行或单行上看到它们，具体取决于浏览器的宽度。

**更新**

我试图一次取消注释其中一个（css3-mediaquery、html5shiv 和响应），但其中任何一个都没有运气。

```
<!DOCTYPE html>
<html lang="en">
<head>
    <title></title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/latest/css/bootstrap-combined.min.css" rel="stylesheet">
</head>

<body>

    <div class="container">
        <div class="row">
            <div class="span4">
                Lorem ipsum dolor sit amet, consectetur adipiscing elit.
            </div>
            <div class="span8">
                LOREM IPSUM DOLOR SIT AMET, CONSECTETUR ADIPISCING ELIT.
            </div>
        </div>
    </div>

    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
    <script type="text/javascript" src="http://netdna.bootstrapcdn.com/twitter-bootstrap/latest/js/bootstrap.min.js"></script>

    <%--<script type="text/javascript" src="js/css3-mediaqueries.js"></script>--%>
    <%--<script type="text/javascript" src="js/html5shiv.js"></script>--%>
    <%--<script type="text/javascript" src="js/respond.js"></script>--%>

    </script>
</body>

</html> 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-12-18T17:21:47.933

IE 8 不支持开箱即用的媒体查询。

基于[这个问题](https://stackoverflow.com/questions/5769493/ie8-support-for-css-media-query)和[这个问题](https://stackoverflow.com/questions/10998877/twitter-bootstrap-responsive-layout-does-not-work-in-ie8-or-lower)，你会想要使用像[css3-mediaqueries-js](http://code.google.com/p/css3-mediaqueries-js/)或[Respond](https://github.com/scottjehl/Respond)这样的扩展。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-25T19:07:42.070

尝试使用[html5shiv](https://code.google.com/p/html5shiv/)，它基本上是一个 HTML5 IE 启用脚本，应该可以在 IE 6,7 和 8 中启动引导程序。这也可以像这样直接热链接：

```
<!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]--> 
```

它必须包含在 <body> 元素之前（即在 <head> 中）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-02-19T04:22:27.003

您的问题是尝试将 respond.js 与外部域上的 CSS 样式表一起使用。Respond.js 将修复 IE6-IE8 的媒体查询。

[https://github.com/scottjehl/Respond#cdnx-domain-setup](https://github.com/scottjehl/Respond#cdnx-domain-setup)

Respond.js 通过 AJAX 请求 CSS 的原始副本来工作，因此如果您将样式表托管在 CDN（或子域）上，则需要上传代理页面以启用跨域通信。

有关演示，请参见 cross-domain/example.html：

```
Upload cross-domain/respond-proxy.html to your external domain
Upload cross-domain/respond.proxy.gif to your origin domain
Reference the file(s) via <link /> element(s):

<!-- Respond.js proxy on external server -->
<link href="http://externalcdn.com/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />

<!-- Respond.js redirect location on local server -->
<link href="/path/to/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />

<!-- Respond.js proxy script on local server -->
<script src="/path/to/respond.proxy.js"></script> 
```

如果您在跨域设置时遇到问题，请确保 respond-proxy.html 没有附加查询字符串。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-02-05T10:39:18.743

根据：[https ://drupal.org/node/2173441](https://drupal.org/node/2173441)

要让您的 Bootstrap 站点在 IE8 上运行，您必须按照以下步骤操作：

1.  [使用Respond.js 模块](https://drupal.org/project/respondjs)安装 Respond.js 文件。
2.  禁用任何 CDN 以加载引导文件。
3.  [使用Bootstrap Library Module](https://drupal.org/project/bootstrap_library)在本地安装 Bootstrap 文件。
4.  聚合和压缩 CSS 文件`/admin/config/development/performance`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-06-03T06:41:14.143

是的，在 Internet Explorer 8 或更低的“容器”类宽度为 940 像素。但在 Internet Explorer9+、Firefox、Google Chrome 等中，'contianer' 类的宽度调用为 1170px。

Zurb 基金会也存在同样的问题。

如果假设我们的客户要求不考虑在 IE8< 中查看的网站，那么我们开始实现 bootstrap 或 zurb 基础 RWD 功能

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-09-27T05:42:49.863

这是我一直在研究的一个适用于 Bones 框架的解决方案。它可以很容易地与引导程序一起使用。

[https://github.com/gamsim/ieresponsify](https://github.com/gamsim/ieresponsify)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-10-27T10:53:06.037

在所有样式表“链接”标签之后尝试或遵循这个，就在头标签关闭（）之前，它意味着在“头”标签内的末尾。这种格式在所有网站中都有效 99%。但是在某些drupal bootstrap 主题中不起作用。

请记住将所有内容保存在网站本地文件夹中，不要使用 CDN。

```
 <!--[if lt IE 9]>
 <script type='text/javascript' src="/sites/all/themes/bootstrap_subtheme/js/css3-mediaqueries.js"></script> 
 <script type='text/javascript' src="/sites/all/themes/bootstrap_subtheme/js/html5.js"></script>
 <script type='text/javascript' src="/sites/all/themes/bootstrap_subtheme/js/respond.min.js"></script>
 <![endif]--> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-05-23T07:35:03.300

*正如@Akshay Raje*和*@Craig London*所建议的那样，IE 8 中的 CROSS DOMAIN css 加载问题已得到解决。

只是为了添加它，必须在*respond.proxy.js***之前添加***respond.js*或*respond.min.js*才能使设置正常工作。

 **** * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-04-23T14:48:26.160

人们经常使用来自内容交付网络（**CDN**，如 oss.maxcdn.com 或 cdnjs.cloudflare.com）的媒体查询（引导程序和其他文件）加载 CSS。Respond.js 不适用于外部加载的 CSS，因此您必须从服务器加载 Bootstrap CSS（或其他带有媒体查询的 CSS）。

* * *

## 回答 #10

> 赞同：-7
> 
> 时间：2013-03-06T06:55:27.740

yeah it doesn't support IE. i am not anti bootstrap but, I review the css codes of bootstrap framework. and found out that, the other widths are not define as %, i read in other blog article that you should use % for the widths so it will responsive which is true.

and when it comes to ipad, the css code that is using for this by bootstrap is not came from media query, its just a normal css codes that was not declare inside of media queries. and it is fixed width which is you must use for ie7 & 8\. (so think about it first if you want to use bootsrap.)

in future(or maybe now) when there is a new gadget that the bootstrap not supported. your client might go back to fix that issue.

we all know that the ie7 & 8 are still existing,so it should have worked on those two old browsers as well.

so if I were you, create your own framework to meet all the requirements of your site/project.

but I am not an anti bootstrap, just a thoughts... because I'm developing sites too..***

# c# - 第三方类的 TypeConverter 属性

> ID：13924494
> 
> 赞同：16
> 
> 时间：2012-12-18T00:22:23.533
> 
> 标签：c#, .net, type-conversion, typeconverter, sealed

创建类时，可以使用 TypeDescriptor.GetConverter(typeof(T)) 将 TypeConverter 属性应用于它，返回自定义类型转换器。例如：

```
[TypeConverter(typeof(FooConverter))]
public class Foo
{...}

public class FooConverter: TypeConverter
{...}

var tc = TypeDescriptor.GetConverter(typeof(T)); //returns a FooConverter instance. 
```

只要课程是我们制作的，这就会起作用。但是如何为我们无法修改源代码的类提供自定义 TypeConverter 呢？例如，如何为 System.Version 类（没有一个）提供自定义 TypeConverter？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-18T00:33:56.160

您可以在运行时执行此操作。使用这些课程：

```
class MyConverter : TypeConverter
{
}

sealed class MyClass
{   
} 
```

您可以使用：

```
TypeDescriptor.AddAttributes(typeof(MyClass), new TypeConverterAttribute(typeof(MyConverter))); 
```

# android - 使用异步任务在 postExecute 上的 LIstView 中显示数据

> ID：13924498
> 
> 赞同：0
> 
> 时间：2012-12-18T00:23:00.057
> 
> 标签：android

我遇到的问题有点奇怪 JSON 的 printstack 正确显示表中的所有元素的方式应该与方法 String doInBackground(String... args) 相同那是在列表视图的所有元素中显示相同的元素“确切地说，表格行中的最后一个元素可以有人告诉我我做错了什么”谢谢你的时间，你会发现我正在谈论的课程谢谢你

```
class LoadAllProducts extends AsyncTask<String, String, String> {

        /**
         * Before starting background thread Show Progress Dialog
         * */
        @Override
        protected void onPreExecute() {
            super.onPreExecute();
            pDialog = new ProgressDialog(ProDentActivity.this);
            pDialog.setMessage("Loading Balance. Please wait...");
            pDialog.setIndeterminate(false);
            pDialog.setCancelable(false);
            pDialog.show();
        }

        /**
         * getting All products from url
         * */
        protected String doInBackground(String... args) {
            // Building Parameters
            List<NameValuePair> params = new ArrayList<NameValuePair>();
            // getting JSON string from URL
            JSONObject json = jParser.getJSONFromUrl(balanceURL, "GET", params);
            // Check your log cat for JSON reponse
            Log.d("All Products: ", json.toString());

            try {
                // Checking for SUCCESS TAG
                int success = json.getInt(TAG_SUCCESS);

                if (success == 1) {
                    // products found
                    // Getting Array of Products
                    amount = json.getJSONArray(TAG_BALANCE);

                    // looping through All Products
                    for (int i = 0; i < amount.length(); i++) {
                        JSONObject c = amount.getJSONObject(i);

                        // Storing each json item in variable
                        String amount = c.getString(TAG_AMOUNT);
                        String createdat = c.getString(TAG_CREATEDAT);
                        //String userid = c.getString(TAG_USERID);
                        // adding each child node to HashMap key => value
                        map.put(TAG_AMOUNT, amount);
                        map.put(TAG_CREATEDAT, createdat);
                        //map.put(TAG_USERID , userid);
                        // adding HashList to ArrayList
                        amountlist.add(map);

                    }
                } else {
                    // no balance found
                    // Launch Add New balance Activity
                    Intent i = new Intent(getApplicationContext(),
                            ProDentActivity.class);
                    // Closing all previous activities
                    i.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                    startActivity(i);
                }
            } catch (JSONException e) {
                e.printStackTrace();
            }

            return null;
        }

        protected void onPostExecute(String file_url) {
            // dismiss the dialog after getting all products
            pDialog.dismiss();
            // updating UI from Background Thread
            runOnUiThread(new Runnable() {
                public void run() {

                    ListAdapter adapter = new SimpleAdapter(
                            ProDentActivity.this, amountlist,
                            R.layout.list_item, new String[] { TAG_AMOUNT,TAG_CREATEDAT},
                            new int[] { R.id.amount, R.id.createdat });
                    // updating listview
                    setListAdapter(adapter);

                }
            });

        }

    } 
```

JSON：

```
{"balance":[{"amount":"50000","created_at":"2012-12-15 02:39:13"},{"amount":"50000","created_at":"2012-12-16 15:29:03"},{"amount":"30000","created_at":"2012-12-17 19:38:07"}],"success":1} 
```

...然后方法返回

```
12-18 02:29:05.797: D/All Products:(885): {"success":1,"balance":[{"amount":"50000","created_at":"2012-12-15 02:39:13"},{"amount":"50000","created_at":"2012-12-16 15:29:03"},{"amount":"30000","created_at":"2012-12-17 19:38:07"}]} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T19:39:05.847

问题已解决我发现我做错了什么。问题是我没有在方法 protected String doInBackground(String... args) 中定义我的哈希映射

我在 listactivity 中定义它，感谢您抽出宝贵的时间并帮助将下面的代码替换为旧的 try { // 检查 SUCCESS TAG int success = json.getInt(TAG_SUCCESS);

```
 if (success == 1) {
                // products found
                // Getting Array of Products
                amount = json.getJSONArray(TAG_BALANCE);

                // looping through All Products
                for (int i = 0; i < amount.length(); i++) {
                    JSONObject c = amount.getJSONObject(i);

                    // Storing each json item in variable
                    String amount = c.getString(TAG_AMOUNT);
                    String createdat = c.getString(TAG_CREATEDAT);
                    //String userid = c.getString(TAG_USERID);
                    // adding each child node to HashMap key => value

                   HashMap<String, String> map = new HashMap<String, String>();

                    map.put(TAG_AMOUNT, amount);
                    map.put(TAG_CREATEDAT, createdat);
                    //map.put(TAG_USERID , userid);
                    // adding HashList to ArrayList
                    amountlist.add(map);

                }
            } else {
                // no balance found
                // Launch Add New balance Activity
                Intent i = new Intent(getApplicationContext(),
                        ProDentActivity.class);
                // Closing all previous activities
                i.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                startActivity(i);
            }
        } catch (JSONException e) {
            e.printStackTrace();
        }

        return null;
    } 
```

# objective-c - SBJSON，检查数据是否加载完成

> ID：13924500
> 
> 赞同：1
> 
> 时间：2012-12-18T00:23:02.170
> 
> 标签：objective-c, ios, sbjson

我正在使用 SBJSON 来解析数据，我想知道是否有一种方法可以在数据完成加载/检索时进行通知。

例如，当我启动应用程序时，我想在解析数据时显示一个启动画面，当它完成后，我想显示一个新视图。

我正在为 ios 4 及更高版本构建一个应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:00:50.557

您可以使用流解析器 API 执行此操作。或者只是在后台线程上进行解析并在完成后通知主线程。GCD 是你的朋友。

# objective-c - 与 NSFetchedResultsController 的多对多关系

> ID：13924511
> 
> 赞同：2
> 
> 时间：2012-12-18T00:24:51.973
> 
> 标签：objective-c, ios, core-data, nspredicate, nsfetchedresultscontroller

我有一个看起来像这样的模型：

![核心数据模型](../Images/1145e91c35b1a4b171a6dad2ef754a66.png)

并希望`UITableView`使用`NSFetchedResultsController`. 我想列出`Object`给定的所有 s `Owner`，按`Group`. 例如，如果我们要查看某个所有者`Owner A`的组，表格视图可能如下所示：

```
Group A
  Object A
  Object B
  Object C
Group B
  Object A
  Object D
Group C
Group D
  Object C
  Object E 
```

同样重要的是，组按其`name`属性排序（上面的架构中未显示），并且`NSFetchedResultsController`每当对象被修改或从组中添加/删除时，都会调用委托方法。

鉴于这些要求，我设置了s`NSFetchedResultsController`来获取一堆`Object`带有谓词 like 的 s `[NSPredicate predicateWithFormat:@"ANY groups.owner = %@", someOwner]`，这会引发`NSInvalidArgumentException`异常：“此处不允许使用多键”。我尝试了其他一些谓词，但被卡住了。

有什么建议么？这不是我应该使用的东西`NSFetchedResultsController`吗？或者有没有更好的方法来建模我的数据？

谢谢！

**编辑：**我实际上得到了使用上述代码的谓词，我的错误在于我的`sectionNameKeyPath`论点。我试图通过`groups.name`，这是产生错误的原因。我明白为什么这种方式行不通，但我正在努力寻找一种不同的方式来达到预期的效果。也许是一个连接对象？

**编辑 2：**这对于像这样的连接对象有点效果：

![带有连接对象的模型](../Images/67abdfa9753d887fbb13cf517fddcc0d.png)

我现在看到有两个缺点。首先是我必须自己使用代码强制执行唯一性。这很容易，但有点麻烦。第二个缺点，我还没有看到解决方法，是`NSFetchedResultsController`不会再调用它的委托来更新`Objects`。我现在可以忍受这个缺点，但很高兴听到更好的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T01:40:40.587

我认为您将看到的问题是，如果您有一个搜索对象的获取结果控制器，那么它将只找到每个对象一次。因此，每个对象将在您的表中出现一次。而您想要做的是反转事物并找到所有组，然后显示所有相关的包含对象。就获取的结果控制器而言，而不是查找行，从而能够划分为您想要查找部分的部分，从而找出作为行提供的内容。

我认为，最简单的事情是在 Group 上创建一个获取的结果控制器，并添加一个您自己的中间对象，将这些对象重新映射到部分并提供 group.objects（应用了适当的确定性排序）作为每个部分的行。

如果您希望行是动态的，那么我想最简单的方法是根据 Group 控制器的反馈为每个部分创建一个获取的结果控制器。

如果这一切都变得有点痛苦，并且您只想编写自己的集合逻辑，那么您可能希望`NSManagedObjectContextDidSaveNotification`在发生这种情况时捕获并重新运行您的逻辑。出于内存效率的原因，您可能只想保留s 并仅在表视图通过上下文上`objectID`的方法请求它们时才获取适当的对象。`existingObjectWithID:error:`Core Data 有一个内置的缓存机制，可以适当地响应内存警告，所以这一切都是为你编写的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-03T21:34:28.607

您不需要连接对象来获取多对多关系中的数据

请参阅此答案：[如何处理与 NSFetchedResultsController 的多对多关系？](https://stackoverflow.com/questions/2670900/how-to-deal-with-many-to-many-relationships-with-nsfetchedresultscontroller?rq=1)

以及示例项目：[https ://github.com/dmathewwws/Many-to-Many-CoreData](https://github.com/dmathewwws/Many-to-Many-CoreData)

# coldfusion - CF Web 服务数组与 .Net Web 服务数组

> ID：13924519
> 
> 赞同：0
> 
> 时间：2012-12-18T00:25:45.157
> 
> 标签：coldfusion

MethodCRM api在.Net中有这个例子

```
Dim arrUpdateFieldsArray(1) As String
Dim arrUpdateValueArray(1) As String

arrUpdateFieldsArray(0) = Me.txtUpdateField1.Text
arrUpdateValueArray(0) = Me.txtUpdateValue1.Text
arrUpdateFieldsArray(1) = Me.txtUpdateField12Text
arrUpdateValueArray(1) = Me.txtUpdateValue2.Text

'Call the MethodAPI to update the record
sResult = wbsMethodAPI.MethodAPIUpdateV2(sCompanyAccount, sUserName, sPassword, "", _sUpdateTable, arrUpdateFrieldsArray, arrUpdateValueArray, intRecordID)
wbsMethodAPI = Nothing 
```

我试图建立这个等价物但没有成功，这就是我尝试过的

```
<CFSCRIPT>
    s = "salesRep,CustomerType";
    array1 = s.split(",");
    s = "#Signature_RepName#,#Payment_CompanyType#";
    array2 = s.split(",");

    string = CreateObject("java", "java.lang.String");
    array = CreateObject("java", "java.lang.reflect.Array");
    cookies = array.newInstance(string.getClass(), 3);
    array.set(cookies, 0, "salesRep");
    array.set(cookies, 1, "CustomerType");

    string2 = CreateObject("java", "java.lang.String");
    array2 = CreateObject("java", "java.lang.reflect.Array");
    cookies2 = array2.newInstance(string.getClass(), 3);
    array2.set(cookies2, 0, "#Signature_RepName#");
    array2.set(cookies2, 1, "#Payment_CompanyType#");
</CFSCRIPT>

<cfhttp url="https://www.methodintegration.com/MethodAPI/service.asmx/MethodAPIUpdateV2" method="GET"> 
    <cfhttpparam type="URL" name="strCompanyAccount" value="xxxx"/>
    <cfhttpparam type="URL" name="strLogin" value="xxxx"/>
    <cfhttpparam type="URL" name="strPassword" value="xxxx"/>
    <cfhttpparam type="URL" name="strSessionID" value=""/>
    <cfhttpparam type="URL" name="strTable" value="Customer"/>
    <cfhttpparam type="URL" name="arrUpdateFieldsArray" value=#cookies#/>
    <cfhttpparam type="URL" name="arrUpdateValueArray" value=#cookies2#/>
    <cfhttpparam type="URL" name="intRecordID" value="#customerid#"/>
</cfhttp> 
```

请让我知道我做错了什么。TIA

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T00:41:02.740

我相信这些是根据[http://www.methodintegration.com/Method-API-for-QuickBooks-CRM.aspx](http://www.methodintegration.com/Method-API-for-QuickBooks-CRM.aspx)的 SOAP Web 服务。证明：[https ://www.methodintegration.com/MethodAPI/service.asmx?wsdl](https://www.methodintegration.com/MethodAPI/service.asmx?wsdl)

因此，用于`cfinvoke`消耗它们。

```
<cfinvoke 
     webservice="https://www.methodintegration.com/MethodAPI/service.asmx?wsdl" 
     method="MethodAPIUpdateV2" 
     returnVariable="ws" >
    <cfinvokeargument name="strCompanyAccount" value="" />
    <cfinvokeargument name="strLogin" value="" />
    <cfinvokeargument name="strPassword" value="" />
    <cfinvokeargument name="strSessionID" value="" />
    <cfinvokeargument name="strTable" value="" />
    <cfinvokeargument name="arrUpdateFieldsArray" value="" />
    <cfinvokeargument name="arrUpdateValueArray" value="" />
    <cfinvokeargument name="intRecordID" value="" />
</cfinvoke> 
```

或者

```
<cfset wbsMethodAPI 
   = createObject("webservice",
                  "https://www.methodintegration.com/MethodAPI/service.asmx?wsdl")>
<cfset ws = wbsMethodAPI.MethodAPIUpdateV2(
  strLogin="", strCompanyAccount="", strTable="", arrUpdateValueArray="", 
  arrUpdateFieldsArray="", intRecordID="", strPassword="", strSessionID="")> 
```

请参阅：[http ://help.adobe.com/en_US/ColdFusion/9.0/Developing/WSc3ff6d0ea77859461172e0811cbec22c24-78b4.html](http://help.adobe.com/en_US/ColdFusion/9.0/Developing/WSc3ff6d0ea77859461172e0811cbec22c24-78b4.html)

2 个数组的类型为`tns:ArrayOfString`，请参阅：[http ://forums.adobe.com/message/4337438](http://forums.adobe.com/message/4337438)

# javascript - 如何检测 iFrame 是否被重定向到另一个 url？

> ID：13924520
> 
> 赞同：2
> 
> 时间：2012-12-18T00:26:01.160
> 
> 标签：javascript, redirect, iframe

我想列出一个包含分类广告的 iframe。有时，当商品不再可用时，供应商会将页面重定向到他们的主页。我希望能够识别这一点，这样我就可以在假设它已售出的情况下取消索引该项目。实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T00:30:54.777

您可以使用触发 onload 或 reload 的 jQuery 加载函数。

[http://api.jquery.com/load/](http://api.jquery.com/load/)

您将需要存储 iframe 重新加载的次数。

就像是，

```
var reloaded = 0;
$("#iframe_id").load(function(){
    reloaded++;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T00:30:30.810

当 iframe 在不同的域中时，您无法检测到 iframe 的位置，除非它们为[CORS](https://developer.mozilla.org/en-US/docs/HTTP/Access_control_CORS?redirectlocale=en-US&redirectslug=HTTP_access_control)设置了正确的标头。

唯一不用担心其他域的方法是让您的服务器端代码在页面上运行检查并查看它是否重定向。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T00:31:54.143

在帧加载时，检测 URL 是什么：

```
var frameLoadCount = 0;
var firstURL;

$('iframe').load(function() {
    if (frameLoadCount === 0) {
        firstURL = $(this).attr('src');
    } else {
        if (firstURL !== $(this).attr('src')) {
            // The iframe has been redirected.
        }
    } 
}); 
```

基本上，上面的代码每次 iframe 加载时都会运行，检查它是否是第一次，如果是，则将 URL 分配给一个变量。如果它已加载多次，请检查原始 url 是否与当前 url 匹配。

这得益于仅检查它是否被多次加载，因为您可以定位特定的来源等。

# activemq - 容错/高可用生产者

> ID：13924526
> 
> 赞同：0
> 
> 时间：2012-12-18T00:26:36.380
> 
> 标签：activemq, rabbitmq

我正在使用消息队列开发分布式生产者/消费者系统。我对并行化感兴趣的部分是它的消费者方面，我对此感到满意。

但是，我不确定如何处理制作人。我一次只需要一个生产者运行，因为我的系统生产部分的负载不是太高，但我想要一种可靠的方式来管理它，比如启动、停止、重新启动，主要是监控它，以便如果生产者主机出现故障，另一台可以接机。

如果它有帮助，我对我的消费者算法感到满意，即排队作业的算法，因为它可以容错一段时间停机并拾取停机期间发生的事情。

我确信有工具或至少已知的模式可以做到这一点，而不是重新发明轮子。

我正在使用rabbitmq，但可以使用activemq，如果需要，甚至可以重构为storm或类似的东西，到目前为止我的代码并不复杂。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T17:12:03.393

经过几周的思考，我想到了最简单的解决方案，我实际上对此非常满意，所以我会分享它以防你觉得它有用，或者如果你认为有任何缺点，请指出，它到目前为止似乎工作正常。

我在我的数据库中创建了最简单的表，称为 heartbeat，带有一个名为 ts 的时间戳字段，并且始终只有一行。

我每 5 分钟（石英）启动所有潜在的生产者，如果 ts 字段早于 now() - 5 分钟，他们会更新表。因为更新调用是阻塞的，所以我不会有数据库线程问题。现在，如果更新返回 > 0，则意味着它实际上修改了 ts 的值，然后我执行实际的生产代码（队列作业）。如果更新返回 0，它没有修改表，因为其他人在不到 5 分钟前做了，因此这个生产者不会做任何事情，直到它在 5 分钟内再次检查。

显然，5 分钟的值是可配置的，如果我有需要的话，这允许通过小的更改进行非常简洁的升级，以便能够同时执行多个生产者。

# c - 将字符串中的字符转换为整数以进行乘法运算

> ID：13924537
> 
> 赞同：1
> 
> 时间：2012-12-18T00:28:17.457
> 
> 标签：c

我无法让这个工作。我想要做的是获取用户输入示例`1 2 3`，然后将每个字符乘以 2，因此输出将是`2 4 6`. 最终，我将取一长串数字，并将字符串中的每个其他字符乘以 2，其余的保持不变。

我现在遇到的问题是我认为它将 ASCII 值乘以 2 而不是实际整数乘以 2。下面是我到目前为止的代码我还没有添加任何错误检查以确保用户输入只有数字，不超过 16 个等。我是 C 编程的新手，我这样做只是为了学习。

```
#include <stdio.h>

int main(void){

char numbers[17];
int i;
    printf("Please enter number\n");
    scanf("%s", &numbers);

    for(int i=0;i<strlen(numbers);i++){
        printf("%c\n",numbers[i] * 2);
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T00:35:08.747

您的程序中有 2 个问题

1)

```
scanf("%s", numbers); 
```

2)

```
printf("%d\n",(numbers[i] - '0') * 2); 
```

这是一个修改后的程序

```
#include <stdio.h>
#include <string.h>

int main()
{
    char numbers[17];
    int i, len;
    printf("Please enter number\n");
    scanf("%s", numbers);

    len = strlen(numbers);

    for(int i=0;i<len;i++)
    {
        printf("%d\n",(numbers[i] - '0') * 2);
    }

} 
```

此外，最好避免`scanf`- [http://c-faq.com/stdio/scanfprobs.html](http://c-faq.com/stdio/scanfprobs.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T00:30:15.147

尝试使用这样的`atoi`功能：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main(void){

char numbers[17];
int i;
    printf("Please enter number\n");
    scanf("%s", numbers);

    for(i=0;i<strlen(numbers);i++){
        printf("%c\n", atoi(numbers[i]) * 2);
    }
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T00:30:59.663

像下面这样的东西*可能*是你所追求的。它假定`numbers[i]`包含一个 ASCII 数字，将其转换为相应的整数（通过减去零的 ASCII 值），乘以 2，然后将 ASCII 零的值添加到该结果。

```
printf( "%c\n", ( numbers[i] - '0' ) * 2 + '0' ); 
```

这将适用于字符 0-4。从我对 OP 的阅读中不清楚数字 5-9 需要什么。

# wordpress - 从前端发布到自定义元框

> ID：13924542
> 
> 赞同：1
> 
> 时间：2012-12-18T00:29:28.210
> 
> 标签：wordpress

我在自定义帖子类型中有一个自定义元框。我正在使用前端发布页面。用户在表单中添加的信息应显示在帖子中，并出现在自定义元框的后端元​​框中。

```
if( 'POST' == $_SERVER['REQUEST_METHOD'] && !empty( $_POST['submitted'] ) &&  $_POST['submitted'] == "new_post") {

    // Do some minor form validation to make sure there is content
    if (isset ($_POST['postTitle'])) {
        $title =  $_POST['postTitle'];
    } else {
        echo 'Please enter the wine name';
    }
    if (isset ($_POST['postContent'])) {
        $description = $_POST['postContent'];
    } else {
        echo 'Please enter some notes';
    }

    // ADD THE FORM INPUT TO $new_post ARRAY
    $new_post = array(
    'post_title'    =>  $title,
    'post_content'  =>  $description,
    'post_status'   =>  'pending',           // Choose: publish, preview, future, draft, etc.
    'post_type' =>  'portfolio'  //'post',page' or use a custom post type if you want to
    );

    //SAVE THE POST
    $pid = wp_insert_post($new_post);

    wp_redirect( home_url() );

} // END THE IF STATEMENT THAT STARTED THE WHOLE FORM

//POST THE POST YO
do_action('wp_insert_post', 'wp_insert_post');

get_header(); 
```

这是表格

```
<input type="text" id="short_description" name="short_description" style="padding: 7px; width: 100%;" value="<?php echo $short_description_no_html; ?>" /> 
```

# php - 如果存在两个值，则 PHP/SQL 不插入

> ID：13924547
> 
> 赞同：0
> 
> 时间：2012-12-18T00:30:11.963
> 
> 标签：php, sql

如果没有“名称”和“电子邮件”同时存在的条目，我只想插入。

因此，如果“名称”存在于不同的电子邮件中，反之亦然。

```
mysql_query("INSERT INTO list (name,email) VALUES ('$name','$email') "); 
```

我希望在一个 SQL 语句中完成此操作以获得更好的性能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T00:32:54.953

使您的主键成为一对（姓名，电子邮件）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T00:36:08.337

将两个列（名称，电子邮件）设为复合主键并使用 ON DUPLICATE KEY UPDATE 来防止 php 错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T00:36:18.053

如果您不能将 [name, email] 作为主键，请将其设置为唯一约束。这样就不会插入两个值都匹配的记录。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-18T00:36:40.707

在姓名和电子邮件上有一个主键，然后执行以下操作：

`REPLACE INTO list (name,email) VALUES ('$name','$email')`

replace 与 insert 相同，除非值已经存在，否则它将覆盖它们。

# javascript - 设置javascript弹出框的宽度

> ID：13924550
> 
> 赞同：0
> 
> 时间：2012-12-18T00:30:18.720
> 
> 标签：javascript, popup, width

> **可能重复：**
> [如何在 Javascript 中换行](https://stackoverflow.com/questions/4768118/how-to-break-line-in-javascript)

我正在使用下面的 javascript 在客户端网站的页面加载时显示弹出消息。我是 js 的真正新手，只能复制/粘贴我在网上找到的示例。需要知道如何设置弹出框的宽度。我希望文本跨越两行，而不仅仅是跨越页面的宽度。这是它的外观示例 www.manageourwebsite.com.au

```
<body onload="WelcomeMSG()">
    <script language="JavaScript">

<!--
function WelcomeMSG () 
{
alert("Our Retail shop front will be closed from Friday 21st December 2012 thru to Monday 21st January 2013\. The Online store will be open 24/7 as usual  with all online orders being processed as normal.")

}

 -->
    </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T00:58:00.540

我会用一点 CSS（*根据自己的喜好设置样式*）和一行 javascript

```
<style type="text/css">
    #holiday-overlay{
        position:fixed;
        top:0; left:0; right:0; bottom:0;
        background: rgba(255,255,255,0.7);
        z-index:9999;
    }
    #holiday-message{
        width:400px;
        padding:30px;
        background-color: black;
        left:50%;
        top:40%;
        margin-left:-200px; /*half of width*/
        border-radius:5px;
        color:white;
        position:relative;
    }
    #holiday-close{
       paddding:5px;
       position:absolute;
       right:10px;
       top:10px;
       cursor:pointer;
       font-weight:bold;
       color:white;
    }
</style>
<div id="holiday-overlay">
    <div id="holiday-message">
        <a onclick="var el = document.getElementById('holiday-overlay'); el.parentNode.removeChild(el)" id="holiday-close">&times;</a>
        Our Retail shop front will be closed from Friday 21st December 2012 thru to Monday 21st January 2013.<br/>
        The Online store will be open 24/7 as usual  with all online orders being processed as normal.
    </div>
</div> 
```

演示在[http://jsfiddle.net/gaby/NgvCj/embedded/result/](http://jsfiddle.net/gaby/NgvCj/embedded/result/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T01:01:03.857

Well for starters you can't really edit the `alert` box's width. See here for a similar question about this:

[how to change the style of alert box](https://stackoverflow.com/questions/7853130/how-to-change-the-style-of-alert-box)

Sure you can do some hackish things like `\n` but that still doesn't give you the customization you COULD have. I would highly suggest making your own alertbox using a `div` that you style on your own and write the javascript manually so it pops up like an alert. **Take a look @Gaby aka G. Petrioli answer below. He has a very good example.** You can also try using some APIs that do it for you.

[jQuery dialog](http://jqueryui.com/dialog/) is one of many but to give you a sense of how it works (since it seems you are new) jQuery does most of the work for you -- all you really have to do is `src` their javascript file into your code and then call on it accordingly. You can check out some of the functions they provide for you [here](http://api.jqueryui.com/dialog/#option-minWidth). Specifically I linked you to the minWidth section because I believe that is something you are looking for.

If you have questions on how to use jQuery or get confused, feel free to comment here. We like to see people trying to code on Stackoverflow so don't be shy to ask questions (just make sure you are asking good ones and researching before you post). We were all novices once -- the way we become experts is through application and experimentation.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T00:38:02.673

如果您希望将文本包装成两行，我建议您在文本的所需位置添加 \n 换行符：

```
alert("Hello\nWorld") 
```

# java - 如何轻松监控伊甸园和幸存者空间的使用情况

> ID：13924565
> 
> 赞同：2
> 
> 时间：2012-12-18T00:32:03.903
> 
> 标签：java, garbage-collection

如何监控**Eden**和**Survivor**堆空间的使用情况的最佳方法是什么？

我打开了所有**GC 日志记录选项**，但我只能看到 YoungGen 职业：

> -XX:+PrintTenuringDistribution -XX:+UnlockDiagnosticVMOptions -XX:+LogVMOutput -XX:LogFile=jvm.log -server -XX:+HeapDumpOnOutOfMemoryError -XX:+DisableExplicitGC -Xloggc:gc.log -XX:+PrintGCTimeStamps -XX:+ PrintGCDetails -showversion -XX:+PrintClassHistogramBeforeFullGC -XX:+PrintClassHistogramAfterFullGC -XX:+UseParallelOldGC -XX:ParallelGCThreads=4 -XX:MaxTenuringThreshold=15

我会使用[VisualGC](https://blogs.oracle.com/klc/entry/visualgc_plugin_for_visualvm)，但在任何地方都找不到它的分布。JDK 自带的 VisualVM 默认发行版没有 VisualGC。指向 VisualGC 站点的[VisualGC 插件链接](http://visualvm.java.net/plugins.html)已损坏。

**更新：** `jstat`是我一直在寻找的，特别是：

```
 jstat -gcutil -t <pid> <interval> <number_of_samples> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T00:35:41.323

如果我理解正确，我认为您可以使用[JVisualVM](http://docs.oracle.com/javase/6/docs/technotes/guides/visualvm/intro.html)来监控您的 Java 应用程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T01:01:45.080

根据“监视器”的含义，您可能只需要[jstat](http://docs.oracle.com/javase/7/docs/technotes/tools/share/jstat.html)。查看 -gc* 选项。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-18T01:03:23.243

根据[此页面](http://visualvm.java.net/pluginscenters.html)，您可以下载相关插件中心的“updates.xml”文件，并按照说明进行安装。然后就可以安装 VisualGC 插件了。

但是该页面还说您应该能够使用“工具|插件|可用插件”安装插件。

根据我的经验，项目的链接`java.net`经常被破坏。您通常必须更加努力地寻找托管在那里的东西。

# java - Anchorpane javafx上的鼠标按下事件

> ID：13924566
> 
> 赞同：0
> 
> 时间：2012-12-18T00:32:24.490
> 
> 标签：java, mouseevent, javafx

我正在尝试使鼠标事件在我的 javaFx 中工作。我希望能够将鼠标事件添加到我的锚窗格，但我似乎无法使其工作。

```
 room = new AnchorPane();
    room.setId("AnchorPane");
    room.setOnMouseClicked(new EventHandler<MouseEvent>() {

        @Override
        public void handle(MouseEvent e) {
            // TODO Auto-generated method stub

        }
    }); 
```

谁能告诉我问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T02:34:25.013

我用以下代码解决了这个问题：

```
 room.addEventHandler(MouseEvent.MOUSE_PRESSED,
            new EventHandler<MouseEvent>()

   public void handle(MouseEvent e) {
        // TODO Auto-generated method stub

    }
}); 
```

# php - 解压缩文件更改所有者，php

> ID：13924570
> 
> 赞同：2
> 
> 时间：2012-12-18T00:32:40.537
> 
> 标签：php, unzip, ziparchive, file-ownership

我有一个 zip 文件到这样的目录中：

```
drwxr-xr-x 2 salome  salome  4096 Dec 16 17:41 staff.zip 
```

当我使用[ZipArchive](http://php.net/manual/en/class.ziparchive.php)类解压缩文件时，所有压缩文件都是`nobody`用户所有者。有没有办法避免这种所有者变更？

1.  如果需要，我可以使用 ftp（仅作为 salome 用户）。
2.  该脚本最终将在多个主机上共享，因此我们的想法是使其尽可能通用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T00:37:56.230

您可能会考虑扩展`zipArchive`该类并覆盖该`extractTo`方法以对目录中的文件也执行 a `chown()`。

根据您在评论中讨论的用例，您可能还需要考虑使用 Phar 存档格式。php.net/manual/en/intro.phar.php

Phar 将允许您的模块提交者提交您根本不需要提取的可执行 PHP 代码的文件文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T16:53:03.810

好的，我已经解决了`nobody`用户的问题。我将尝试解释我所有的解决方法。

### @迈克布兰特的回答

Mike 建议我使用[chown()](http://php.net/manual/en/function.chown.php)函数覆盖`extractTo()`方法。好吧，在愿意使用它之前，我`chown()`不断地测试了独立的功能，它打印了错误：

> 未能创建流：权限被拒绝...

看起来 chown 不适用于主要的共享主机

### FTP功能

因此，尽管`FTP functions`我制作了一个运行良好的脚本，但至少现在 xD 继续前进。这是脚本对一个压缩文件所做的简历：

1.  使用`tmpfile()`.
2.  用于将`ftp_fput()`临时文件与压缩文件一起放在当前目录中。
3.  `ftp_site`使用和授予写入权限`CHMOD 0777`。
4.  使用 .读取压缩文件内容`$content = $zip->getFromName('zipped-file.txt');`。
5.  使用 . 将内容放入新文件`fputs($fp, $content);`。
6.  关闭连接

下面的代码说明了完整的过程

```
$zip = new ZipArchive;
$ftp_path_to_unzip = '/public_html/ejemplos/php/ftp/upload/';
$local_path_to_unzip = '/home/user/public_html/ejemplos/php/ftp/upload/';

if ($zip->open('test.zip') == TRUE) {

    //connect to the ftp server
    $conn_id = ftp_connect('ftp.example.com');
    $login_result = ftp_login($conn_id, 'user', 'password');    

    //if the connection is ok, then...
    if ($login_result) {

        //iterate each zipped file
        for ($i = 0; $i < $zip->numFiles; $i++) {
            $filename = $zip->getNameIndex($i);

            //create a "local" temp file in order to put it "remotely" in the same machine
            $temp = tmpfile();

            //create the new file with the same name from the extracted file in question
            ftp_fput($conn_id, $ftp_path_to_unzip . $filename, $temp, FTP_ASCII);

            //set write permissions, eventually we will put its content
            ftp_site($conn_id, "CHMOD 0777 " . $ftp_path_to_unzip . $filename);

            //open the new file that we have created
            $fp = fopen($local_path_to_unzip . $filename, 'w');

            //put the content from zipped file
            $content = $zip->getFromName($filename);
            fputs($fp, $content);

            //close the file
            fclose($fp);

            //now only the owner can write the file
            ftp_site($conn_id, "CHMOD 0644 " . $ftp_path_to_unzip . $filename);

        }
    }

    // close the connection and the file handler
    ftp_close($conn_id);

    //close the zip file
    $zip->close();
} 
```

这是开始更复杂的自定义的第一步，因为上面的代码无法知道压缩文件是“目录”还是“文件”。

# perl - 使用 perl（IE8 浏览器）从路径中提取文件名

> ID：13924575
> 
> 赞同：1
> 
> 时间：2012-12-18T00:33:13.350
> 
> 标签：perl, internet-explorer-8

我正在使用 perl 将文件上传到服务器，然后对其进行解析以从中获取信息。该页面在 cgi 脚本中，我正在使用 perl 模块

```
use File::Basename; 
```

我的服务器端代码是：

```
my $path = $cgi->param('filename');
my $filename = basename($path);
if ($filename) {
  if ($filename =~ /.csv/i) {do nothing;}
  else {
    $error = 'please upload a csv file';
    push @error, $error;
  }
} 
```

我已经尝试了一切，代码在 Chrome、Safari、Firefox 上运行良好，但是当我在 IE8 上测试它时。文件名更改为完整路径名。因此，例如 C:/meetup/sf/perl.csv 是完整路径。在 CSF 中，文件名显示为 perl.csv，但在 IE8 中：显示为 C:/meetup/sf/perl.csv

有人可以帮我找出获取文件名的正确方法，以便它在所有浏览器中正确显示。

谢谢，
帕里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T03:23:05.343

另一种方法是使用[Path::Class](https://metacpan.org/module/Path%3a%3aClass)，它明确用于跨平台路径处理。

```
use Path::Class 'file';
my $filename = file($path)->basename; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T10:53:25.703

问题是 unix / windows 路径分隔符。而不是通常的 / 来分隔组件 IE8 正在传递可能将它作为 \ 传递。

您可以通过执行以下操作来实现通用解决方案：

```
 my $path = $cgi->param('filename');
    # replace all occurences of \ with / chrome/firefox etc won't be affected 
    #because they wont have any \ delimiters
    $path =~ s/\\/\//g;  

    my ($name,$parsed_path,$suffix) = fileparse($path,@suffixlist);
    print "name $name \n"; # this should carry the name of the file eg perl.csv 
```

# jquery - HTML5 视频应在结束时淡出

> ID：13924576
> 
> 赞同：0
> 
> 时间：2012-12-18T00:33:19.803
> 
> 标签：jquery, html, video

问题是视频不会在几个装有 Firefox 的 Windows 机器上淡出。我知道我已经实现了 2 种方法，所以它应该可以工作......但遗憾的是它没有。在那些它不起作用的机器上，DivX-Logo 和 DivX-Player 时间线会显示。可能这就是为什么它不起作用的问题？

我的代码：

> ```
>  <div id="video">
>     <video id="vid" autoplay preload="auto">
>      <source src="http://clips.vorwaerts-gmbh.de/VfE_html5.mp4" width="100%"type="video/mp4" ></source>
>   </video> 
> </div> 
> ```

```
video.addEventListener('ended', function () {
                    $('#vid').addClass('hide');
                    $('video').delay(100).fadeOut();

                }, false);
                video.play(); 
```

我有一个小 jsfiddle 给你： [这里](http://jsfiddle.net/DSteinel/4YGqJ/2/)

提前致谢！

# javascript - 骨干关系：删除事件未触发

> ID：13924579
> 
> 赞同：0
> 
> 时间：2012-12-18T00:33:34.227
> 
> 标签：javascript, backbone.js, model, backbone-relational

我正在尝试使用 Backbone Relational 设置一对模型，但我不明白删除事件是如何触发的。

这是我的模型代码：

```
var Car = Backbone.RelationalModel.extend({
    idAttribute: "id"
});

var Cars = Backbone.Collection.extend({
    model: Car
});

var CarCollection = new Cars();

var User = Backbone.RelationalModel.extend({

    idAttribute: 'id',
    relations: [{
        type: Backbone.HasMany,
        key: 'model',
        relatedModel: Car,
        collectionType: Cars,
        includeInJSON: 'model',
        reverseRelation: {
            key: 'ownedBy',
            includeinJSON: 'name'
        }
    }]

  });

var Users = Backbone.Collection.extend({
    model: User
});

var UserCollection = new Users();

//Bootstrap data and put it in the collections

var carsData = [
    {id:1, model:'500',ownedBy:1},
    {id:2, model:'Corsa',ownedBy:2},
    {id:3, model:'Civic',ownedBy:2}
];

var usersData = [
    {id:1,name:'Dude'},
    {id:2,name:'Mark'}
];

CarCollection.add(carsData);
UserCollection.add(usersData); 
```

在 JSON 中，我得到的是：

```
UserCollection = {"id":1,"name":"Dude","model":["500"]}{"id":2,"name":"Mark","model":["Corsa","Civic"]}

CarCollection = {"id":1,"model":"500","ownedBy":"Dude"}{"id":2,"model":"Corsa","ownedBy":"Mark"}{"id":3,"model":"Civic","ownedBy":"Mark"} 
```

现在，如果我像这样向 CarCollection 添加一个元素：

```
CarCollection.add({id:4,model:'Prius',ownedBy:1};); 
```

'add' 事件被触发，但如果我从集合中删除一个元素：

```
var el = CarCollection.get(1);
CarCollection.remove(el); 
```

没有事件被触发。

我已经通过一些解决方法解决了它，例如：

```
var el = CarCollection.get(1);
el.destroy(); 
```

或者直接在 Backbone.store 中取消注册：

```
Backbone.Relational.store.unregister(el); 
```

或者只是将ownedBy设置为null：

```
var el = CarCollection.get(1);
el.set("ownedBy",null); 
```

这是插件的正确行为吗？或者我以错误的方式配置了我的模型？感谢您的每一个答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T14:07:59.340

您必须将模型传递给`remove`索引

```
Collection.remove(model) 
```

您可以执行以下操作：

```
CarCollection.remove(CarCollection.at(0)); 
```

删除索引为 0 的模型或...

```
CarCollection.remove(CarCollection.get(4)); 
```

删除 id 为 4 的模型

# android - 如何在 Android 上获取 C++ 回溯

> ID：13924582
> 
> 赞同：2
> 
> 时间：2012-12-18T00:33:49.663
> 
> 标签：android, gdb, backtrace

我正在使用原生 C++ 和 NDK（使用 Eclipse）在 android 上开发游戏来构建它。我发现在遇到崩溃时使用 eclipse 和 NDK 调试本机 C++ 代码非常困难，有没有办法在程序崩溃时获得 C++ 回溯？请指教。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T00:36:10.507

您可以使用`ndk-stack`位于 NDK 根目录中的可执行文件来执行此操作。在文件中阅读有关它的`docs/NDK-STACK.html`文档。

# android - ViewPager 中的android.widget.Gallery？

> ID：13924587
> 
> 赞同：0
> 
> 时间：2012-12-18T00:34:14.647
> 
> 标签：android, android-layout, android-widget

我需要在底部的视图寻呼机中放置一个 android.widget.Gallery。用户将一直阅读并滚动到底部，然后在底部的图库中查看更多图片。我希望能够在没有切换页面的情况下水平滚动图库。因此，当用户与 Gallery 交互时，我不希望 ViewPager 的水平滑动接管并切换页面。如何才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T00:45:40.977

我不建议在水平滚动查看器中使用水平滚动项。

要尝试这个，你有几个选项，很多项目：1.）搜索水平列表视图。更少的项目：2.）水平滚动视图。我猜选项 3.) 即使折旧也使用画廊。

但是，我鼓励您尝试一下，它在两个项目以相同方式滚动时效果不佳。

出于同样的原因，在另一个垂直滚动中放置一个垂直滚动也不是一个好主意。

唯一可行的方法是，如果您为用户提供一个单独的全屏非水平滚动窗口和您的水平滚动项目。

# ruby-on-rails - 在 Ruby on Rails 中从控制台更新模型

> ID：13924593
> 
> 赞同：-1
> 
> 时间：2012-12-18T00:35:08.520
> 
> 标签：ruby-on-rails, attributes, console

我环顾四周，这似乎很简单，但我找不到答案。我是 RoR 的新手（就像今天刚开始学习一样），所以如果我的术语有误，请告诉我！

如何从 RoR 控制台修改模型的属性？

我在哪里：

*   创建了新应用
*   创建了新的控制器（$ rails 生成控制器教科书）
*   添加路由（将“资源：教科书”添加到 routes.rb）
*   创建具有一个属性的模型（$ rails 生成模型教科书标题：字符串）
*   添加到数据库（$ rake db:migrate）

如何从控制台添加新属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T00:43:53.550

好的，你快到了 :) 现在你应该启动 rails 控制台：在你的项目目录中输入：

```
rails c 
```

（c 代表控制台）

然后你输入：

```
first_textbook = Textbook.new(:name => "My first textbook") 
```

接着

```
first_textbook.save 
```

# null - Arduino中的空字符问题

> ID：13924595
> 
> 赞同：0
> 
> 时间：2012-12-18T00:35:10.663
> 
> 标签：null, serial-port, arduino

我正在尝试编写一个 Arduino 程序，它将通过串行监视器传输的文本字符串转换为摩尔斯电码。这是有问题的功能：

```
void serialEvent() {
  while (Serial.available()){
    char inChar = Serial.read();
    input += inChar;
    if (inChar == '\0'){  
      Serial.print("END!");
      stringComplete = true;
    }
  }
} 
```

它应该一个接一个地从串行输入中获取字符，将它们添加到输入字符串中，直到它到达串行输入的末尾（即空字符）。由于某种原因，“if”语句不会执行

```
inChar == '\0' 
```

但是如果我用任意字符替换 '\0'

`inChar == 'g'`

它执行得很好。我是否以某种方式将空字符 '\0' 称为错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T01:24:43.307

我认为您认为您在 while 循环中读取了所有字符，对吗？事实上，每次调用该`loop()`方法只读取一个字符，因此，您可以设置`stringComplete = true`when `Serial.available() == 0`。

# position - 使 1 张图像介于其他两张图像之间？

> ID：13924596
> 
> 赞同：0
> 
> 时间：2012-12-18T00:35:38.203
> 
> 标签：position, z-index, background-image

在我的[网站](http://mmd3e12dae42.keaweb.dk/test/index.html)首页上，我有两张图片放在一起，所以看起来像日落。我想让我的标志像太阳一样在它们之间下降，但我无法做到这一点。该徽标目前位于该网站的第二页，这是 html：

```
<div id="intro">
     <div id="introbaggrundbagved"></div>
     <a name="section1" class="section">SECTION 1</a>
     <div id="logo">
     </div>
</div> <!--#intro--> 
```

和CSS：

```
#intro{
  background: url('images/introforan.png') no-repeat center;
  height: 900px;
  margin: 0;
  position: relative;
  z-index: 3;
}

#introbaggrundbagved{
    background: url('images/introbagved.png') no-repeat center;
    height: 900px;
    width: 1440;
    margin:0;   
    position: relative;
}

#logo{
    background: transparent url('images/logo.png') no-repeat center;
    width: 600px;
    height: 600px;
    position: relative;
    margin-left: 420px;
    margin-top: 100px;
    z-index: 2;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T00:56:12.300

您需要将`#logo`div 从其父元素中取出，`#intro`并为其提供一个大于其两个兄弟元素的 z-index——然后将所有`header`元素包装到一个`#intro-wrapper`div 中。此外，我将使用, 而不是`position`的`#logo`元素，这将使您对其位置进行更精细的控制，而不会干扰周围元素的文档流。`position: absolute``relative`

此外，您似乎具有`parallaxScroll`更新 的`top`属性的功能`#logo`，这将防止将元素放置在您的两个图像之间。

```
 function parallaxScroll(){
      var scrolledY = $(window).scrollTop();
      $('#logo').css('top','+'+((scrolledY*.376))+'px');
        ....
      } 
```

# jquery - jquery div定位

> ID：13924597
> 
> 赞同：0
> 
> 时间：2012-12-18T00:35:39.637
> 
> 标签：jquery, html, positioning

有人可以帮忙解决这个jsfiddle吗？

[http://jsfiddle.net/4Ns44/](http://jsfiddle.net/4Ns44/)

预期目的：当页面向下滚动时，链接在视口中展开，这很好用。但是当我们向上滚动时，我希望展开窗口在它开始的地方停止。即，在标题 div 下方。现在， position:fixed 导致它保持在顶部，即使在标题 div 变得可见之后也是如此。

一些帮助`position:fixed`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T01:42:58.707

如果我了解您要执行的操作，我认为您想检查 scrollTop 何时小于`#expand`. 尤其：

```
var minY = $('#header').height(); 
```

在`scroll`处理程序中：

```
// this will reset to the original position
if (top < minY) {
    $expand.css({position: "absolute", top: ''});
} 
```

结果是：http: [//jsfiddle.net/4Ns44/3/](http://jsfiddle.net/4Ns44/3/)

```
var minY = $('#header').height();
var $expand = $("#expand");

$(window).scroll(function () {

    var top = $(window).scrollTop();

    if($expand.css("position") === "fixed") {

        if(top > expandY) {
            $expand.css({position: "absolute", top: expandY});
        } else if (top < minY) {
            $expand.css({position: "absolute", top: ''});
        }
    }
    else {
        if (top < minY) {
            $expand.css({position: "absolute", top: ''});
        } else if(top < expandY) {
            $expand.css({position: "fixed", top: 0});
        }
    }
}); 
```

这是如果我明白你想要做什么...

# hadoop - Hadoop Mapreduce 详细任务状态查询

> ID：13924599
> 
> 赞同：1
> 
> 时间：2012-12-18T00:35:42.337
> 
> 标签：hadoop, visualization

我想为 hadoop mapreduce 编写一个第 3 方前端，它需要查询 mapreduce 的一些信息和统计信息。

现在，我可以使用`hadoop job`计数器来查询作业和地图并降低完成百分比，例如：

```
# hadoop job -status job_201212170023_0127

Job: job_201212170023_0127
map() completion: 0.6342382
reduce() completion: 0.0

Counters: 28
    Job Counters 
        SLOTS_MILLIS_MAPS=4537
... 
```

我还想要的是工作跟踪器中的可视化所使用的每个任务的数量，即：

![工作跟踪图表](../Images/9e2d8f51f06ee8d160388dd5d20a5198.png)

我能够列出所有映射器...

```
# hadoop job -list-attempt-ids job_201212170023_0127 map running
attempt_201212170023_0127_m_000000_0
attempt_201212170023_0127_m_000001_0
attempt_201212170023_0127_m_000002_0
... 
```

..但是我将如何获得这些任务的百分比？理想情况下，我想要这样的东西：

```
# hadoop job -task-status attempt_201212170023_0127_m_000000_0
completion: 0.6342382
start: 2012-12-18T12:23:34Z
... etc. 
```

当前的解决方案是抓取 Web 界面，但如果完全可以使用命令行输出，我不喜欢这个。

# ruby - getter 真的不会修改实例变量吗？

> ID：13924600
> 
> 赞同：2
> 
> 时间：2012-12-18T00:35:53.407
> 
> 标签：ruby, getter-setter

[在另一页](https://stackoverflow.com/questions/8737421/trying-to-learn-understand-ruby-setter-and-getter-methods)看到这个：

“使用 getter，无需修改即可获得 @a 的当前值。”

“使用setter，修改@a，并将其新值作为返回值。”

但是，从[cancan wiki](https://github.com/ryanb/cancan/wiki/role-based-authorization)查看这段代码，我发现 setter 和 getter 实际上都在对其中的变量做一些事情。

```
def roles=(roles)
  self.roles_mask = (roles & ROLES).map { |r| 2**ROLES.index(r) }.inject(0, :+)
end

def roles
  ROLES.reject do |r|
    ((roles_mask || 0) & 2**ROLES.index(r)).zero?
  end
end 
```

看起来 getter 实际上正在返回一个真值，如果不是这样，至少是某种转换。那么这个“getter get without modifying, setter set with modified”规则真的是真的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-18T00:38:11.110

这是思考“getter”和“setter”的错误方式。相反，请这样想：

setter*改变*对象的状态。它可能会设置一个简单的实例变量。它可能会设置几个实例变量。与发布的代码一样，它可能会在保存信息之前对其进行转换。

getter*检索*有关对象状态的一些信息。这是什么无关紧要；它可以是直接存储在实例变量中的值。或者它可能是基于对象当前状态的其他值，如帖子中所示。

通常建议 getter 和 setter 获取/返回相同*类型*的值并以一致的方式影响/报告对象状态。在上面公开的类型是一个“角色数组”，它表示与对象关联的角色。

* * *

使用额外的命名方法可以更清楚地显示发布代码的意图，因为可以提取出复杂的[位掩码构建/使用表达式；](http://en.wikipedia.org/wiki/Mask_%28computing%29#Common_bitmask_functions)注意对称性：

```
def toMaskFromArray (roles)
  (roles & ROLES).map { |r| 2**ROLES.index(r) }.inject(0, :+)
end

def toArrayFromMask (mask)
  ROLES.reject do |r|
    ((mask || 0) & 2**ROLES.index(r)).zero?
  end
end

def roles=(roles)
  self.roles_mask = toMaskFromArray(roles)
end

def roles
  toArrayFromMask(self.roles_mask)
end 
```

# firebase - setPriority() 删除优先级

> ID：13924601
> 
> 赞同：0
> 
> 时间：2012-12-18T00:35:58.607
> 
> 标签：firebase

我正在处理有序数据并遇到了这个问题：

我使用 push() 将项目添加到一个位置，并将它们的优先级设置为以毫秒为单位的创建日期，因此它们按日期排序。当我尝试更改项目的顺序时，我找到下一个或上一个（如果没有下一个）项目并获得它的优先级，然后我添加或减去一个并将移动项目的优先级设置为结果。我获取了优先级，但是当我调用 setPriority() 时，该项目失去了优先级。使用图形调试器导出项目不会为每个移动的项目返回优先级。为未移动的项目返回正确的优先级。

一些代码：

```
/* id 是被移动的 div 的 id
使用 jquery ui 的可排序
div id 的组成类似于 "item_" + firebaseref.name()
*/
名称 = id.substr(id.indexOf('_') + 1);
id2 = $('#' + id).next().attr('id');
如果（id2）{
    name2 = id2.substr(id2.indexOf('_') + 1);
    itemRef = rootRef.child('path/to/my/items/'+name2);
    itemRef.once('value', function (dataSnapshot){
        var pr = Number(dataSnapshot.getPriority()),
        myRef = rootRef.child('path/to/my/items/'+name);
        myRef.setPriority(pr - 1); // 尝试 this 或 toString 如下
    });
} 别的 {
// 尝试上一项
    id2 = $('#' + id).prev().attr('id');
    如果（id2）{
        name2 = id2.substr(id2.indexOf('_') + 1);
        itemRef = rootRef.child('path/to/my/items/'+name2);
        itemRef.once('value', function (dataSnapshot){
            var pr = Number(dataSnapshot.getPriority()) + 1,
            myRef = rootRef.child('path/to/my/items/'+name);
            myRef.setPriority(pr.toString());
        });
    }
}

```

我有一个“child_moved”监听器，但我现在没有使用它。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T19:07:12.623

这是 Firebase 中的一个错误。目前我不确定原因，但似乎大于一定大小的数字没有被正确保存。完成后，我们将调查并更新此答案。

**更新**：此错误已解决。再试一次！

# javascript - 使用 jquery 从 POST 方法取回数据在 Firefox 上不起作用

> ID：13924607
> 
> 赞同：1
> 
> 时间：2012-12-18T00:36:19.690
> 
> 标签：javascript, jquery, jsp, post

我有这个 HTML 网络，这个 jquery 脚本在 Chrome 中运行良好：

```
 $.post("Login", $("#log").serialize(),
            function(data){
            $("#response").css("visibility","visible");
            $("#response").empty();
            $("#response").append(data);
        });
        event.preventDefault(); 
```

“登录”它是一个带有 JSP 的 servlet。

正如我所说，在 chrome 中工作得很好，但在 Firefox 中根本不行：登录部分工作正常（它实际上调用 post 方法并登录）但使用函数（数据）获取“数据”的部分没有有效。我无法从服务器获取数据响应以将其附加到网络中！

响应是 html 消息，例如：

```
<html><head></head><body>ERROR AT LOGIN or LOGIN CORRECT, ETC</body></html> 
```

我一直在关注[这个](http://api.jquery.com/jQuery.post/)。

任何想法？

**编辑**
我发现了错误，但没有找到解决方案：问题是在 firefox`event.preventDefault`中无法正常工作，因此在我提交表单后它会重新加载网络！我需要使用防止提交，我该怎么办？这是表单代码：

```
form class="login" method="post" action="Login" id="log" onsubmit="validate()" 
```

validate 函数是我写的第一个代码。

我能做些什么来防止 Firefox 中的事件？

# mysql - MySQL游标获取不起作用

> ID：13924611
> 
> 赞同：1
> 
> 时间：2012-12-18T00:36:55.497
> 
> 标签：mysql, stored-procedures

我有以下存储过程，旨在实现 Dijkstra 的最短路径算法：

```
CREATE PROCEDURE `Dijkstras`(IN `pids` VARCHAR(512), IN `startP` VARCHAR(8), IN `endP` VARCHAR(8), OUT `dist` DECIMAL(20,10), OUT `eset` VARCHAR(1024))
BEGIN
DECLARE currentP VARCHAR(4);
DECLARE finished INT DEFAULT 0;
DECLARE pt_from, pt_to int;
DECLARE pt_dist decimal(20,10);
DECLARE done INT DEFAULT 0;

DECLARE cur2 CURSOR FOR 
    select F.id as `from`, T.id as `to`, dist(F.lat, F.lng, T.lat, T.lng) 
      as dist
    from   sampledata F, sampledata T
    where  F.id < T.id and 
           find_in_set(convert(F.id, char(10)), pids) and
           find_in_set(convert(T.id, char(10)), pids) 
    order by dist;
  DECLARE CONTINUE HANDLER FOR not found SET done = 1; 

    SET currentP= startP;
  SET eset = '';
  SET dist = 0;

  SET done=0;
  OPEN cur2; -- this finds pariwise distances in miles.
  REPEAT 
    FETCH cur2 INTO pt_from, pt_to, pt_dist; 
    SET dist= dist+pt_dist;
        SET eset= CONCAT(eset, ',');
    IF(currentP=pt_from OR currentP=pt_to) AND 
    (IN_SET(pt_from,pids) AND IN_SET(pt_to,pids))  THEN
        BEGIN
            SET dist= dist+ pt_dist;
            SET pids= REMOVE_MEMBER(currentP, pids);
            SET eset = concat(eset, ',', concat(pt_from, ':', pt_to));
                IF left(eset, 1) = ',' then 
                    SET eset = substring(eset, 2); -- remove extra comma.
                END IF;
            IF currentP=pt_from THEN
                SET currentP=pt_to;
            ELSE 
                SET currentP=pt_from; 
            END IF;
            IF currentP= endP THEN
            SET finished= 1;
            END IF;
     END;
      END IF;
         UNTIL done 

  END REPEAT; 
  CLOSE cur2;

END 
```

我的问题是光标无法正常工作。当我获取当前行时`pt_from, pt_to,`，`pt_dist`我得到的只是`NULL`值。该`sampledata`表已正确存储在数据库中，并且其中的所有点 id`pids`也在`sampledata`表中。另外，这个 EXACT 代码适用于另一个过程，但在这里重用它是行不通的。

有人知道我在做什么错吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T13:34:38.527

错误是我传入了这样的点 id `'12, 15, 18'`，中间有空格。MySQL 在解析字符串时会计算空格，并且表中的 id 列出时没有空格。传入字符串集的正确方法是`'12,15,18'`.

# javascript - 当我滚动网页时，Chrome 扩展的 Background.js 不会加载。这里有什么问题？

> ID：13924618
> 
> 赞同：0
> 
> 时间：2012-12-18T00:37:25.703
> 
> 标签：javascript, google-chrome-extension

这是调用 insertText() 函数的 background.js 条目。

```
 $(document).ready(function() {
      // Handler for .ready() called.

    InsertText();
    }); 
```

此函数调用仅在网站第一次加载时发生。我当前正在滚动的网页中的任何后续加载/更改，都不会被调用。我哪里错了？我是否必须为此编写一个选项卡更改侦听器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T00:42:31.013

您绑定到错误的事件。`ready`在加载DOM时触发，如果你想在页面滚动时做一些事情，那么绑定到`scroll`：

```
$(window).scroll(function(){
    // code here    
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T00:45:12.157

这种行为是正确的。`$(document).ready`当 DOM 准备好时被调用，并在函数中执行代码：http: [//api.jquery.com/ready/](http://api.jquery.com/ready/)

当页面准备好并构造 DOM 时（大多数情况下，在大多数浏览器中），这只会在每个页面触发一次。

您可以对特定事件触发操作，包括加载。因此，如果您知道应该加载哪些内容并且想要在其上触发某些内容，您可以试试这个 (http://api.jquery.com/load/)：

```
$("#imageID").load(function() {
    // image has loaded
}); 
```

如果您专门针对滚动，可以使用 jQuery 滚动方法：[http ://api.jquery.com/scroll/](http://api.jquery.com/scroll/)

但请注意调用滚动的频率，您可能希望在用户停止滚动后延迟事件触发 x 毫秒:)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T07:11:24.463

[背景页面](https://developer.chrome.com/extensions/overview.html#background_page)执行和[内容脚本](https://developer.chrome.com/extensions/overview.html#contentScripts)执行环境是两种不同的变体，因此必须使用某种[通信机制](https://developer.chrome.com/extensions/messaging.html)

实现您的用例的示例脚本

### 清单.json

*使用清单文件注册 chrome 扩展元素的所有部分*

```
{
"name":"Content to Background Script",
"description":"This Extension invokes background Script function whenever there is a scroll event",
"version":"1",
"manifest_version":2,
"background":{
    "scripts":["background.js"]
},
"content_scripts": [
    {
      "matches": ["<all_urls>"],
      "js": ["myscript.js"]
    }
  ],
"permissions":["<all_urls>"] 
} 
```

### 背景.js

*在此处注册事件侦听器和函数*

```
//Some trivial Function
function _someFunction() {
    console.log("I am invoked ...");
}

//Handler when message is sent from Content Scripts
chrome.extension.onMessage.addListener(function (message, caller, handler) {
    if (message["callTo"] == "_someFunction") _someFunction();
}); 
```

### myscript.js

*这是一个简单的示例内容脚本*

```
//Look for scroll event
document.addEventListener("scroll", function () {
    console.log("Page is Scrolled hence requesting background page to execute my function");
    //Request Background page for execution of a function
    chrome.extension.sendMessage({
        "callTo": "_someFunction"
    });
}); 
```

如果您需要更多信息，请与我们联系。

# html - CSS 背景尺寸封面和背景位置

> ID：13924626
> 
> 赞同：37
> 
> 时间：2012-12-18T00:38:07.930
> 
> 标签：html, css, background-image

HTML：

```
#backgroundproduct {
  position: fixed;
  top: 5%;
  left: 5%;
  width: 90%;
  height: 90%;
  z-index: 12;
  -webkit-background-size: cover;
  -moz-background-size: cover;
  -o-background-size: cover;
  background-size: cover;
  background-position: top;
}
```

```
<div id="backgroundproduct" style="background-image: url(http://example.com/example.jpg)">
```

我使用图像作为背景图像，只有图像的下部比顶部更重要。

我怎样才能让背景上升一点？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-12-18T00:40:02.870

如果底部更重要：`background-position: bottom;`

`background-position`还允许百分比值：`0% 0%;`默认情况下。

> 第一个值是水平位置，第二个值是垂直位置。左上角是 0% 0%。右下角是 100% 100%。如果您只指定一个值，则另一个值为 50%。

你应该试试`background-position: 0% -10%;`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-18T00:40:20.800

您可以使用：

```
background-position: center bottom; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-10T13:35:43.093

为了清楚起见，背景位置百分比是根据图像和背景容器计算的。所以，背景位置：25% 25%；将在背景容器上找到 X 和 Y 的 25% 点，并将图像的 25%、25% 点对齐在该点之上。

# asp.net-mvc - json字符串中对象数量和类型未知的自定义类

> ID：13924634
> 
> 赞同：0
> 
> 时间：2012-12-18T00:39:20.377
> 
> 标签：asp.net-mvc, c#-4.0, jqgrid-asp.net

我创建了以下公共类`colModelClass`，因此我可以为我的 colModel 字符串反序列化`jqgrid`

```
public class colModelClass
{
    public string name { get; set; }
    public string index { get; set; }
    public string jsonmap { get; set; }
    public bool editable { get; set; }
    public bool sortable { get; set; }
    public int width { get; set; }
    public string align { get; set; }
    public bool hidden { get; set; }
    public string sorttype { get; set; }
    public string formatter { get; set; }
    public string formatoptions { get; set; }
} 
```

问题是，`formatoptions`不是字符串。它是一个`json`具有无限数量的可能项目的对象。它不仅可以包含`formatoptions`随附的每个标准项目，`jqgrid`还可以包含自定义选项。

`Type`我使用哪个`formatoptions`将允许这样的对象：

```
{ "srcformat": "m/d/Y", "newformat": "m/d/Y" } 
```

或这个

```
{ "decimalSeparator":".","thousandsSeparator":"," } 
```

或任何其他数量的选项和组合（如果我添加其他选项，则不需要我更新我的课程）？

或者，我如何创建一个`formatoptionsClass`可以接受任何字符串、bool、int 等的类，以便它可以动态构建该类？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T04:44:31.543

对于未知类型，尤其是 JSON 对象，您必须将数据类型指定为“对象”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T06:17:10.943

就像我在评论中说的 - 把它作为对象。

# php - 在上传时创建另一个大小不同的缩略图？

> ID：13924635
> 
> 赞同：-1
> 
> 时间：2012-12-18T00:39:22.997
> 
> 标签：php, image, upload

我有这个将图像存储到目录中的上传脚本。我想知道如何在上传第一张图片的同时创建具有不同名称和大小的第二张图片以存储在同一目录中。

第一个图像将保持其原始大小并重命名为 pic1.jpg，我希望第二个图像的大小为 90px x 90px 并保存为“thumb_pic1.jpg”

有人可以帮忙吗。谢谢。

```
<?php
session_start()
?>
<?
$filename = addslashes($filename);

$sql=mysql_query('INSERT INTO ptb_photos SET file_name ="$filename",id="$_SESSION[user_id]", user_id="$_SESSION[user_id]"');

// LOG
$log = '=== ' . @date('Y-m-d H:i:s') . ' ===============================' . "\n"
        . 'FILES:' . print_r($_FILES, 1) . "\n"
        . 'POST:' . print_r($_POST, 1) . "\n";
$fp = fopen('upload-log.txt', 'a');
fwrite($fp, $log);
fclose($fp);

// Result object
$r = new stdClass();
// Result content type
header('content-type: application/json');

// Maximum file size
$maxsize = 10; //Mb
// File size control
if ($_FILES['xfile']['size'] > ($maxsize * 1048576)) {
    $r->error = "Max file size: $maxsize Kb";
}

// Uploading folder
$folder = 'files/';
if (!is_dir($folder))
    mkdir($folder);

// If specifics folder 
$folder .= $_POST['folder'] ? $_POST['folder'] . '/' : '';
if (!is_dir($folder))
    mkdir($folder);

// PASS USER_ID HERE
$folder2 = '../'. '../'. 'data/'. 'photos/'. $_SESSION['user_id'] . '/';
if (!is_dir($folder2))
    mkdir($folder2);

// New directory with 'files/USER_SESSION_ID/'
$folder = $newDir . $folder2;

// If the file is an image
if (preg_match('/image/i', $_FILES['xfile']['type'])) {

    $filename = $_POST['value'] ? $_POST['value'] :
            $folder . 'pic1.jpg';

} else {

    $tld = split(',', $_FILES['xfile']['name']);
    $tld = $tld[count($tld) - 1];
    $filename = $_POST['value'] ? $_POST['value'] :
            $folder . sha1(@microtime() . '-' . $_FILES['xfile']['name']) . $tld;
}

// Supporting image file types
$types = Array('image/png', 'image/gif', 'image/jpeg');
// File type control
if (in_array($_FILES['xfile']['type'], $types)) {
    // Create an unique file name    
    // Uploaded file source
    $source = file_get_contents($_FILES["xfile"]["tmp_name"]);
    // Image resize
    imageresize($source, $filename, $_POST['width'], $_POST['height'], $_POST['crop'], $_POST['quality']);
} else
// If the file is not an image
if (in_array($_FILES['xfile']['type'], $types)) 
    move_uploaded_file($_FILES["xfile"]["tmp_name"], $filename);

// File path
$path = str_replace('upload_image_1.php', '', $_SERVER['SCRIPT_NAME']);

// Result data
$r->filename = $filename;
$r->path = $path;
$r->img = '<img src="' . $path . $filename . '" alt="image" />';

// Return to JSON
echo json_encode($r);

// Image resize function with php + gd2 lib
function imageresize($source, $destination, $width = 0, $height = 0, $crop = false, $quality = 80) {
    $quality = $quality ? $quality : 80;
    $image = imagecreatefromstring($source);
    if ($image) {
        // Get dimensions
        $w = imagesx($image);
        $h = imagesy($image);
        if (($width && $w > $width) || ($height && $h > $height)) {
            $ratio = $w / $h;
            if (($ratio >= 1 || $height == 0) && $width && !$crop) {
                $new_height = $width / $ratio;
                $new_width = $width;
            } elseif ($crop && $ratio <= ($width / $height)) {
                $new_height = $width / $ratio;
                $new_width = $width;
            } else {
                $new_width = $height * $ratio;
                $new_height = $height;
            }
        } else {
            $new_width = $w;
            $new_height = $h;
        }
        $x_mid = $new_width * .5;  //horizontal middle
        $y_mid = $new_height * .5; //vertical middle
        // Resample
        error_log('height: ' . $new_height . ' - width: ' . $new_width);
        $new = imagecreatetruecolor(round($new_width), round($new_height));
        imagecopyresampled($new, $image, 0, 0, 0, 0, $new_width, $new_height, $w, $h);
        // Crop
        if ($crop) {
            $crop = imagecreatetruecolor($width ? $width : $new_width, $height ? $height : $new_height);
            imagecopyresampled($crop, $new, 0, 0, ($x_mid - ($width * .5)), 0, $width, $height, $width, $height);
            //($y_mid - ($height * .5))
        }
        // Output
        // Enable interlancing [for progressive JPEG]
        imageinterlace($crop ? $crop : $new, true);

        $dext = strtolower(pathinfo($destination, PATHINFO_EXTENSION));
        if ($dext == '') {
            $dext = $ext;
            $destination .= '.' . $ext;
        }
        switch ($dext) {
            case 'jpeg':
            case 'jpg':
                imagejpeg($crop ? $crop : $new, $destination, $quality);
                break;
            case 'png':
                $pngQuality = ($quality - 100) / 11.111111;
                $pngQuality = round(abs($pngQuality));
                imagepng($crop ? $crop : $new, $destination, $pngQuality);
                break;
            case 'gif':
                imagegif($crop ? $crop : $new, $destination);
                break;
        }
        @imagedestroy($image);
        @imagedestroy($new);
        @imagedestroy($crop);

    }
}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T00:42:50.700

我建议不要自己调整大小，而是使用 Imagick。它具有大量用于在 PHP 中修改图像的好功能，包括调整大小。

[http://php.net/manual/en/book.imagick.php](http://php.net/manual/en/book.imagick.php)

# android - Android DatePickerDialog CalendarView 的标题不一致

> ID：13924644
> 
> 赞同：2
> 
> 时间：2012-12-18T00:40:17.537
> 
> 标签：android, android-datepicker, datepickerdialog, calendarview

我正在创建一个`DatePickerDialog`，就像它在[文档](http://developer.android.com/guide/topics/ui/controls/pickers.html#DatePicker)中所做的那样。但是，我注意到`CalendarView`当年份设置在`Spinner`s. 我看到周已正确更改，并且我可以根据`onSelectedDayChange`带有适当日期（月、月日、年、工作日）的回调在对话框上设置标题。`Spinner`此外，如果在s中更改月份，则`CalendarView`立即更新。这包括，如果年份在月份更改之前更改，则正确显示所选年份。如果`CalendarView`滚动到其他月份，年份也会被调整以显示正确的年份。

这似乎意味着在`CalendarView`设置日期时根本没有重绘标题（可能是优化？）。我做错了什么吗？有针对这个的解决方法吗？或者它是实现中的错误？

这是我的代码：

```
public class DatePickerFragment extends DialogFragment
    implements DatePickerDialog.OnDateSetListener {
    /** Name of the date stored in a {@link Bundle} */
    public static final String KEY_DATE = "key.DatePickerFragment.DATE";

    @Override
    public Dialog onCreateDialog(Bundle icicle) {
        final Bundle arguments = getArguments();
        Time date = arguments == null
                ? TimeMachine.getTimeFromArray(getArguments().getIntArray(KEY_DATE))
                : null;

        if (date == null)
            date = TimeMachine.getToday();

        _dialog_window = new DatePickerDialog(getActivity(), this, date.year, date.month, date.monthDay);
        final CalendarView calendar_view = _dialog_window.getDatePicker().getCalendarView();
        calendar_view.setOnDateChangeListener(
                new CalendarView.OnDateChangeListener() {
                    @Override
                    public void onSelectedDayChange(CalendarView _, int year, int month, int day) {
                        updateTitle(TimeMachine.getTimeFromArray(new int[]{ year, month, day }));
                    }
                }
        );

        // Sets the title
        updateTitle(date);

        // Create a new instance of DatePickerDialog and return it
        return _dialog_window;
    }

    @Override
    public void onDateSet(DatePicker _, int year, int month, int day) {
        final Time date = new Time();
        date.set(day, month, year);
    }

    private void updateTitle(Time date) {        
        _dialog_window.setTitle(date.format(" %A,  %B %e, %Y"));
    }

    /** The Dialog window */
    private DatePickerDialog _dialog_window;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T19:36:52.030

我遇到了同样的问题并提交了错误报告：[http ://code.google.com/p/android/issues/detail?id=53875](http://code.google.com/p/android/issues/detail?id=53875)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T16:43:18.843

看到没有其他人提出任何其他答案，我通过不启用`CalendarView`on解决了这个问题`DatePicker`，而是制作了一个`DialogFragment`具有数字日期选择器和单独的自定义`CalendarView`（实际上是我自己的基于真实的重新`CalendarView`实现允许调整它的显示和 Otto 事件总线）。然后我可以确保`CalendarView`每次设置数字日期选择器时都设置了 。

# ruby-on-rails - render error messages with js form rails

> ID：13924650
> 
> 赞同：10
> 
> 时间：2012-12-18T00:40:57.083
> 
> 标签：ruby-on-rails, ajax, ruby-on-rails-3, forms, error-handling

I changed my form to remote, and while the form now works, the error messages are no longer displaying if there's an error.

```
<%= render 'shared/error_messages' %> 
```

is there a good wear to get the messages to show again?

below is my controller...

thank you.

```
respond_to do |format|
  if @post.save
    format.js { render :js => "window.location = '#{edit_post_path @post}'" }
    format.html { redirect_to [:edit, @post] }
  else
    format.js { render :js => @post.errors }
    format.html { redirect_to '/', :error => "Could not save comment" }      
  end
end 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-18T01:01:29.557

```
respond_to do |format|
  if @post.save
    format.js { render :js => "window.location = '#{edit_post_path @post}'" }
    format.html { redirect_to [:edit, @post] }
  else
    format.js { }
    format.html { redirect_to '/', :error => "Could not save comment" }      
  end
end

# update.js.erb

$(document).find("form").prepend('<%= escape_javascript(render("shared/error_messages", :formats => [:html])) %>'); 
```

# linux - amd64 psABI 在哪里？

> ID：13924652
> 
> 赞同：19
> 
> 时间：2012-12-18T00:41:02.647
> 
> 标签：linux, macos, x86-64, calling-convention, abi

AMD64 psABI 曾经托管在 x86-64.org。

我有一份 pdf 文件的副本，它明确表示：

> 架构规范可在网站 [http://www.x86-64.org/documentation](http://www.x86-64.org/documentation)上获得。

但是[http://www.x86-64.org](http://www.x86-64.org)已经关闭了很长时间。至少几个月。

有谁知道可以从哪里获取最新的 psABI？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-18T07:07:29.663

见[http://refspecs.linuxfoundation.org/](http://refspecs.linuxfoundation.org/)

用于 x86_64 架构的 System V psABI：[http ://refspecs.linuxfoundation.org/elf/x86_64-abi-0.95.pdf](http://refspecs.linuxfoundation.org/elf/x86_64-abi-0.95.pdf)

编辑：0.99.6 似乎是最新的，从[https://www.google.com/search?q=System+V+Application+Binary+Interface+AMD64+0.99.6中选择任何一个](https://www.google.com/search?q=System+V+Application+Binary+Interface+AMD64+0.99.6)

# c - gdk_screen_get_default() 和 get_width()/height() 段错误

> ID：13924654
> 
> 赞同：0
> 
> 时间：2012-12-18T00:41:11.647
> 
> 标签：c, gtk

我刚刚破解了 GTK 开发的开放基础，并试图做一些对我正在开发的应用程序的未来有用的创意。

具体来说，

```
int main(int argc, char *argv[])
{
    GtkWidget *window = NULL, *label = NULL;
    GdkScreen *screen = NULL;
    gint width = 0, height = 0;
    char *resolution = NULL;

    gtk_init(&argc, &argv);

    if((screen = gdk_screen_get_default()) != NULL)
    {
        width  = gdk_screen_get_width(screen);
        height = gdk_screen_get_height(screen);
    }

    sprintf(resolution, "%d x %d", width, height);

    ... 
```

执行时会导致段错误。我确信我犯了一个菜鸟错误，最终我会认识到错误是什么，但目前我无法弄清楚。我能够生成的 Google 结果也不是很有用。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T00:43:37.153

一个问题是变量`resolution`指向 NULL，因此 sprintf 肯定会导致未定义的行为（可能是崩溃）。代码应该为该变量分配内存（例如，`resolution = malloc(somesize);`）或在堆栈上声明它（例如，`char resolution[somesize];`）

# java - struts2 使用 jquery 进行长轮询

> ID：13924655
> 
> 赞同：2
> 
> 时间：2012-12-18T00:41:15.877
> 
> 标签：java, jquery, struts2, long-polling

我以前有使用 PHP 和 jQuery 进行长轮询以检查新聊天消息的经验。

想法是有一个 while 循环来检查是否有新消息，如果有，则返回新消息，如果没有，则休眠 5 秒并再次检查。

我想使用 java struts2 框架做同样的事情。我创建了一个具有 while 循环的操作类，执行相同操作，并使用 Thread.sleep() 进行等待。

但是，我遇到了一些非常高的 CPU 使用率。我做对了吗？很抱歉，我现在没有任何示例代码，因为我使用一种使用客户端轮询的简单方法重新编写了它。

帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T09:18:09.673

为什么不使用 BlockingQueue？我不明白为什么这与 jQuery 和长轮询有关。这是一个服务器内部设计问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T13:37:10.943

如果（尽管标题说 jQuery），你想用 Java 做这个（*“我想用 java struts2 框架做同样的事情。”*），那么[while 循环不是一个好的解决方案](https://stackoverflow.com/questions/390242/java-while-loop-and-threads)；

相反，您应该使用[java.util.Timer](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Timer.html) ( / [TimerTask](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/TimerTask.html) )。

请注意，在 Struts2 中，每个请求都会实例化一个 Action，因此如果您在 Action 中创建一个 Timer，并且您有 100 个并发用户，那么您就有 100 个计时器在运行。最好[从 EJB 使用它](https://pic.dhe.ibm.com/infocenter/wasinfo/v8r5/index.jsp?topic=/com.ibm.websphere.nd.doc/ae/tejb_timerserviceejb_enh.html)。

也看看这个 SO 答案：

1) [Timer & TimerTask 与 Java 中的 Thread + sleep](https://stackoverflow.com/questions/1453295/timer-timertask-versus-thread-sleep-in-java)

2）[如何在java中设置定时器](https://stackoverflow.com/questions/4044726/how-to-set-a-timer-in-java)

并在 Javadoc： [Java EE 5 教程 - 使用计时器服务](http://docs.oracle.com/javaee/5/tutorial/doc/bnboy.html)

我的2美分...

# vba - MS Access：您如何为选择科目的学生设计数据库

> ID：13924662
> 
> 赞同：0
> 
> 时间：2012-12-18T00:42:09.357
> 
> 标签：vba, ms-access, database-design, relational-database

我目前正在尝试设计一个数据库，其中有一个学生表、可用科目表以及包含哪些学生将根据他们填写的表格选择哪些科目的表。类似于订单系统。

我认为我的设计相当简单且不可靠。

我目前有三个表：

```
TableModule: 
  ModuleID(PK), 
  ModuleName, 
  Semester, 
  Credits 

TableModuleForm: 
  ID(PK), 
  StudentID, 
  ModuleID 

TableStudent: 
  StudentID(PK), 
  Username, 
  Password, 
  Lastname, 
  Firstname, 
  Email,
  Course,
  StudyYear 
```

不太确定使用 3 个表是否是正确的方法。我只是MS的初学者

*   设计一个数据库的好方法是什么，学生可以在一个表格中选择他们想要学习的多个科目？*他们应该有什么样的关系？

我目前已经实现了一个登录表单，在他们根据学生表中的信息使用正确的用户名和密码登录后，它将允许访问主题选择表单。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T00:52:24.293

```
Student
  id
  name
  username
  password

Subject
  id
  name

StudentSubject
  id
  subject_id
  student_id 
```

# php - PHP 在运行时公开受保护的属性

> ID：13924663
> 
> 赞同：0
> 
> 时间：2012-12-18T00:42:17.713
> 
> 标签：php, reflection, public, protected

问题：我不想暴露`$myProperty`，那是不应该的`public`，但我需要它`public`只是为了`__toString()`：

```
class A
{
    protected $myProperty;

    public function __toString()
    {
        return json_encode($this);
    }
} 
```

我知道`ReflectionProperty`该类有一个名为 的方法`setAccessible()`，但是在返回字符串之前我应该​​如何使用它？

**编辑**：根据评论，我需要与 PHP 5.3.x 兼容，这不是`JSonSerializable`类。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T00:51:52.280

根据 PHP 5.3在方法[`get_object_vars`](http://php.net/get_object_vars)内部使用`__toString()`：

```
public function __toString()
{
    return json_encode(get_object_vars($this));
} 
```

使用[演示](http://eval.in/4897)：

```
class A
{
    protected $myProperty = 'hello';

    public function __toString()
    {
        return json_encode(get_object_vars($this));
    }
}

echo new A; 
```

输出：

```
{"myProperty":"hello"} 
```

提示：创建自己的[`JsonSerializable`](http://php.net/JsonSerializable)接口并实现自己的`jsonSerialize()`方法以向上兼容。在需要时调用该函数和/或在内部调用它`__toString()`：

```
public function __toString()
{
    return json_encode($this->jsonSerialize());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T00:51:05.013

为什么不简单地构建一个 PHP`stdClass`对象，然后将其序列化为 JSON，因为当您从 JSON 反序列化时，这正是您所得到的。

也许是这样的：

```
public function __toString() {
   $return = new stdClass();
   $properties = get_object_vars($this);
   foreach ($properties as $key => $value) {
       $return->$key = $value;
   }
   return json_encode($return);
} 
```

# c# - 地址已知时如何获取坐标？

> ID：13924674
> 
> 赞同：12
> 
> 时间：2012-12-18T00:43:41.507
> 
> 标签：c#, geolocation, geocoding, windows-store-apps, openstreetmap

我从 Adam Freeman 的书“Metro Revealed：使用 XAML 和 C# 构建 Windows 8 应用程序”中派生/改编了以下代码，以便在已知坐标时获取地址：

```
public static async Task<string> GetAddressForCoordinates(double latitude, double longitude)
{
    HttpClient httpClient = new HttpClient {BaseAddress = new Uri("http://nominatim.openstreetmap.org")};
    HttpResponseMessage httpResult = await httpClient.GetAsync(
        String.Format("reverse?format=json&lat={0}&lon={1}", latitude, longitude));
JsonObject jsonObject = JsonObject.Parse(await httpResult.Content.ReadAsStringAsync());

return jsonObject.GetNamedObject("address").GetNamedString("road"); 
```

}

我怎样才能得到相反的结果（如果地址已知，则为坐标）？

## 更新

我正在为此增加赏金；我已经得到的（如上所示）是反向地理编码（获取坐标的地址）；我需要的是地理编码（获取地址的坐标）。

根据我上面的反向地理编码代码，我猜它可能是这样的：

```
public static async Task<string> GetCoordinatesForAddress(string address)
{
    HttpClient httpClient = new HttpClient {BaseAddress = new Uri("http://nominatim.openstreetmap.org")};
    HttpResponseMessage httpResult = await httpClient.GetAsync(
        String.Format("format=json&address={0}", address));

    JsonObject jsonObject = JsonObject.Parse(await httpResult.Content.ReadAsStringAsync());

    return jsonObject.GetNamedObject("address").GetNamedString("lat"); // <-- what about "lon"?
} 
```

...但我不知道如何组合两个坐标（经度和纬度）值（假设这是正确的，或者接近正确）。任何人都可以验证、清理或提供更好的示例（使用 nominatim 或其他方式）吗？

## 更新 2

要在下面回答 Peter Ritchie 的问题/评论：

在原始（反向地理编码代码）中，我有：

```
return jsonObject.GetNamedObject("address").GetNamedString("road"); 
```

它只是返回道路；所以我假设像“157 Riverside Avenue”之类的东西。

但是对于地理编码（需要两个值，一个经度和一个纬度），我有这个伪代码：

```
return jsonObject.GetNamedObject("address").GetNamedString("lat"); // <-- what about "lon"? 
```

所以我不知道是否需要将返回值从 Task `<string`> 更改为 Task`<List`并调用（详细伪代码）[注意：我很难用字符串列表转义 Task 的尖括号]：

```
var latitude jsonObject.GetNamedObject("address").GetNamedString("lat");
var longitude jsonObject.GetNamedObject("address").GetNamedString("lat");
List<string> listCoordinates = new List<string>();
listCoordinates.Add(latitude);
listCoordinates.Add(longitude);
return listCoordinates; 
```

...或者像这样：

```
string latitude jsonObject.GetNamedObject("address").GetNamedString("lat");
string longtude jsonObject.GetNamedObject("address").GetNamedString("long");
return string.Format("{0};{1}", latitude, longitude); 
```

...或者 ？？？

## 更新 3

响应提供的用于地理编码的 Json 代码：

基于原始的反向地理编码代码，调用不应该更像这样：

```
HttpClient httpClient = new HttpClient { BaseAddress = new Uri("http://nominatim.openstreetmap.org/") };
var httpResult = await httpClient.GetAsync(
    String.Format("search?format=json&addressdetails={0}", address); 
```

...但无论如何： JArray 类型无法识别，尽管 JsonArray 是。JValue 类型无法识别，但 JsonValue 可以。JsonConverter 类型无法识别；也许是 Json.Net 的一部分？

我能得到的最接近的编译代码是：

```
var result = await httpResult.Content.ReadAsStringAsync();
var r = (JsonArray)JsonConverter.DeserializeObject(result);//<-- JsonConvert[er] not recognized; part of Json.NET?
var latString = ((JsonValue)r[0]["lat"]).ValueType as string;
var longString = ((JsonValue)r[0]["lon"]).ValueType as string; 
```

...但即使这样（关闭但没有 Bob Seger），也无法识别 JsonConvert 和 JsonConverter。

## 更新 4

在通过[http://wiki.openstreetmap.org/wiki/Nominatim#Search](http://wiki.openstreetmap.org/wiki/Nominatim#Search)上的文档更加一致地苦苦挣扎之后，我认为我的原始（反向地理编码）方法可能会更好：

```
public static async Task`<string`> GetAddressForCoordinates(double latitude, double longitude)
{
    HttpClient httpClient = new HttpClient {BaseAddress = new Uri("http://nominatim.openstreetmap.org/")};
    HttpResponseMessage httpResult = await httpClient.GetAsync(
        String.Format("reverse?format=json&lat={0}&lon={1}", latitude, longitude));

    JsonObject jsonObject = JsonObject.Parse(await httpResult.Content.ReadAsStringAsync());

    string house = jsonObject.GetNamedObject("addressparts").GetNamedString("house");
    string road = jsonObject.GetNamedObject("addressparts").GetNamedString("road");
    string city = jsonObject.GetNamedObject("addressparts").GetNamedString("city");
    string state = jsonObject.GetNamedObject("addressparts").GetNamedString("state");
    string postcode = jsonObject.GetNamedObject("addressparts").GetNamedString("postcode");
    string country = jsonObject.GetNamedObject("addressparts").GetNamedString("country");
    return string.Format("{0} {1}, {2}, {3} {4} ({5})", house, road, city, state, postcode, country);
} 
```

对于传入的相应坐标 args，这将返回类似于：“ *157 Riverside Avenue, Champaign, IL 55555 (USA)* ”

我对文档感到奇怪的是地址部分中没有“状态”元素。如果这是真的，而不仅仅是文档疏忽，我上面的代码将在调用 GetNamedString("state") 时失败。

我仍然不确定相反的（地理编码）方法应该是什么正确的语法等，在传入地址后获取坐标。

## 更新 5

好的，我下载了 Json.NET 并进行了编译。我还没有测试过，但我已将 Peter Ritchie 的答案标记为 THE（50 分）答案。

这是我正在使用的代码：

```
public static async Task<string> GetCoordinatesForAddress(string address)
{
    HttpClient httpClient = new HttpClient { BaseAddress = new Uri("http://nominatim.openstreetmap.org/") };
    HttpResponseMessage httpResult = await httpClient.GetAsync(
        String.Format("search?q={0}&format=json&addressdetails=1", Pluggify(address))); // In my Pluggify() method, I replace spaces with + and then lowercase it all

    var result = await httpResult.Content.ReadAsStringAsync();
    var r = (JArray)JsonConvert.DeserializeObject(result);
    var latString = ((JValue)r[0]["lat"]).Value as string;
    var longString = ((JValue)r[0]["lon"]).Value as string;
    return string.Format("{0};{1}", latString, longString);
} 
```

另外：在返回这个论坛的路上发生了一件有趣的事情：在通过 NuGet 安装 Json.NET 时，我还看到了“.NET 的 ServiceStack 的最快 JSON 序列化程序”，它声称比 Json.NET 快 3 倍。FIWW，它比 Json.NET 更新得更晚。想法/反应？

## 更新 6

我有这个代码来实现这个（应用程序 ID 和代码已更改以保护半无辜者（我））：

```
// If address has not been explicitly entered, try to suss it out:
                    address = textBoxAddress1.Text.Trim();
                    lat = textBoxLatitude1.Text.Trim();
                    lng = textBoxLongitude1.Text.Trim();
                    if (string.IsNullOrWhiteSpace(address))
                    {
                        address = await SOs_Classes.SOs_Utils.GetAddressForCoordinates(lat, lng);
                    }

. . .

        public async static Task<string> GetAddressForCoordinates(string latitude, string longitude)
        {
            string currentgeoLoc = string.Format("{0},{1}", latitude, longitude);
            string queryString = string.Empty;
            string nokiaAppID = "j;dsfj;fasdkdf";
            object nokiaAppCode = "-14-14-1-7-47-178-78-4";
            var hereNetUrl = string.Format(
                "http://demo.places.nlp.nokia.com/places/v1/discover/search?at={0}&q={1}&app_id={2}    
&app_code={3}&accept=application/json",
                    currentgeoLoc, queryString, nokiaAppID, nokiaAppCode);    
            // get data from HERE.net REST API
            var httpClient = new HttpClient();
            var hereNetResponse = await httpClient.GetStringAsync(hereNetUrl);    
            // deseralize JSON from Here.net 
            using (var tr = new StringReader(hereNetResponse))
            using (var jr = new JsonTextReader(tr))
            {
                var rootObjectResponse = new JsonSerializer    
().Deserialize<JsonDOTNetHelperClasses.RootObject>(jr);    
                var firstplace = rootObjectResponse.results.items.First();
                return HtmlUtilities.ConvertToText(firstplace.vicinity);
                // NOTE: There is also a title (such as "Donut Shop", "Fire stations", etc.?) and type (such as "residence" or "business", etc.?)
            }
        } 
```

...但在 GetAddressForCoordinates() 中的这一行：

```
 var firstplace = rootObjectResponse.results.items.First(); 
```

...我收到此错误消息：“*System.InvalidOperationException 未由用户代码 HResult=-2146233079 处理消息=序列不包含元素 Source=System.Core StackTrace：在 System.Linq.Enumerable.First[TSource](IEnumerable` 1 来源）在 SpaceOverlays.SOs_Classes.SOs_Utils.d__12.MoveNext() 在 c:...*"

hereNetResponse 的值为：

```
{"results":{"items":[]},"search":{"context":{"location":{"position":[38.804967,-90.113183],"address":
{"postalCode":"62048","city":"Hartford","stateCode":"IL","county":"Madison","countryCode":"USA","country":"
USA","text":"Hartford IL 62048
USA"}},"type":"urn:nlp-types:place","href":"http://demo.places.nlp.nokia.com/places/v1/places/loc-
dmVyc2lvbj0xO3RpdGxlPUhhcnRmb3JkO2xhdD0zOC44MDQ5Njc7bG9uPS05MC4xMTMxODM7Y2l0eT1IY
XJ0Zm9yZDtwb3N0YWxDb2RlPTYyMDQ4O2NvdW50cnk9VVNBO3N0YXRlQ29kZT1JTDtjb3VudHk9TWFka
XNvbjtjYXRlZ29yeUlkPWNpdHktdG93bi12aWxsYWdl;context=Zmxvdy1pZD02YmUzZDM4Yi0wNGVhLTUyM
jgtOWZmNy1kNWNkZGM0ODI5OThfMTM1NzQyMDI1NTg1M18wXzE2MA?
app_id=F6zpNc3TjnkiCLwl_Xmh&app_code=QoAM_5BaVDZvkE2jRvc0mw"}}} 
```

...所以看起来里面有有效的信息，例如应该返回“哈特福德，伊利诺伊州”

无论如何，一个空白的返回值不应该抛出异常，我认为......

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-23T17:05:09.343

您要问的只是“地理编码”。如果您想专门使用 Nominatim，他们将其称为“搜索”。这在一定程度上是地址验证；但“验证”的一部分包括坐标（边界框、纬度/经度等；取决于搜索的内容和结果的类型）。有很多关于结果的细节，在这里简单地发布太多了；但是可以在此处找到此详细信息：[http](http://wiki.openstreetmap.org/wiki/Nominatim#Search) ://wiki.openstreetmap.org/wiki/Nominatim#Search（包括示例）。

您必须解析结果（XML、JSON 或 HTML）以获取您感兴趣的字段。

# 更新1：

至于如何处理实际值：这取决于。如果您想在表单中查看坐标，您可以简单地将经纬度字符串放入单独的控件中。如果你想把它放在一个单独的控件中，可以使用`string.Format("{0}, {1}", latString, longString)`. 如果您想为 Windows 应用商店应用程序使用各种方法/类型的坐标，您可能需要使用`Microsoft.Maps.MapControl.Location`该类。例如：

```
 Double latNumber;
  Double longNumber;
  if(false == Double.TryParse(latString, out latNumber)) throw new InvalidOperationException();
  if(false == Double.TryParse(longString, out longNumber)) throw new InvalidOperationException();
  var location = new Location(latNumber, longNumber); 
```

以上假设您已从响应中提取 lat 和 long 并将它们`latString`分别放入 中`longString`。

某些接口可能需要 lat/long 作为单独的双精度值，在这种情况下只需使用`latNumber`及`longNumber`以上。

除此之外，它实际上具体取决于您要使用的接口。但是，以上内容应该足以让您使用大多数接口。

# 更新 2：

如果问题不是“如何获取坐标”而是“如何解析 json 对象”，那么我建议使用 JSon.Net 来获取 json 结果中的 lat/long 字符串。例如：

```
 var httpClient = new HttpClient();
    var httpResult = await httpClient.GetAsync(
        "http://nominatim.openstreetmap.org/search?q=135+pilkington+avenue,+birmingham&format=json&polygon=1&addressdetails=1");

    var result = await httpResult.Content.ReadAsStringAsync();
    var r = (JArray) JsonConvert.DeserializeObject(result);
    var latString = ((JValue) r[0]["lat"]).Value as string;
    var longString = ((JValue)r[0]["lon"]).Value as string; 
```

......见上文关于如何处理`latString`和`longString`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T07:12:43.420

如果您正在寻找谷歌地图地理编码，您可以在这里找到它：
[https ://developers.google.com/maps/documentation/geocoding/](https://developers.google.com/maps/documentation/geocoding/)

示例用法是：
[http ://maps.googleapis.com/maps/api/geocode/json?address=1600+Amphitheatre+Parkway,+Mountain+View,+CA&sensor=false](http://maps.googleapis.com/maps/api/geocode/json?address=1600+Amphitheatre+Parkway,+Mountain+View,+CA&sensor=false)

转换为 Json，并获取 Geometry 对象。

关于如何从一个函数中返回两个值，在 C# 中你有 4 个选项：

1.  将两个对象转换为相同类型的单个对象（在字符串的情况下，您只需将它们用分隔符分隔，就像您所做的那样），然后将它们解析出来。
2.  返回一个列表 - 在这种情况下是一个任务（或数组）。
3.  创建一个包含两者的新类/对象（例如，在这种情况下，您可以将其称为 Geometry）。
4.  通过要求将它们作为对函数的引用传递来返回一个或两个对象。在异步函数中，这肯定会非常棘手，但取决于谁调用函数以及谁处理结果，这可能是可能的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-23T17:32:27.977

Microsoft Mappoint 还包含一个您可以使用的 API。它能够返回地理坐标。

# java - CMake - 安装后设置文件权限（java）

> ID：13924678
> 
> 赞同：1
> 
> 时间：2012-12-18T00:44:29.860
> 
> 标签：java, cmake

我有一个涉及使用 CMake 设置权限的问题。现在我正在修改使用 Ant 脚本构建 Java 代码的 CMake 文件。我们想将我们的 Java 代码转换为 CMake，以便我们可以使用 Build Avoidance。阅读 CMake 文档后，我们似乎可以编译和安装我们的 Java 包，但是 install_jar() 命令不允许我们像 install 命令那样设置权限。

我假设我们要使用 install_jar 命令，以便在针对依赖项进行编译时可以使用 find_jar 命令，所以我想保留 install_jar 命令。是否有某种用于 CMake 的 chmod 命令，或者在安装后设置已安装文件权限的一些最佳实践方法？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T03:37:15.543

基本上，`install_jar()`定义是，只需`install()`调用：

```
function(INSTALL_JAR _TARGET_NAME _DESTINATION)
    get_property(__FILES
        TARGET ${_TARGET_NAME}
        PROPERTY INSTALL_FILES
    )

    if (__FILES)
        install(FILES ${__FILES}
                DESTINATION ${_DESTINATION}
        )
    else (__FILES)
        message(SEND_ERROR "The target ${_TARGET_NAME} is not known in this scope.")
    endif (__FILES)
endfunction(INSTALL_JAR _TARGET_NAME _DESTINATION) 
```

因此，您可以编写自己的`install_jar_with_args()`并将`PERMISSIONS`关键字添加到`install()`调用中。

可能需要将此问题报告给 CMake 开发人员。

# node.js - 在 arm board（cubieboard 或 raspberry pi）上编译 nodejs 的最佳方法是什么？

> ID：13924679
> 
> 赞同：3
> 
> 时间：2012-12-18T00:44:30.460
> 
> 标签：node.js, arm, raspberry-pi

在阅读了所有类型的东西（大部分是过时的）之后，我现在迷失了在 raspberry [pi](http://www.raspberrypi.org/)或cubieboard 上运行[nodejs](http://cubieboard.org/)的最佳方法是什么？

我在两块板上都尝试了以下操作，并且可以正常工作（从 node.js 0.8.10 开始）。

```
sudo apt-get install build-essential libssl-dev
export NODE_VER=0.8.16
cd ~
curl http://nodejs.org/dist/v$NODE_VER/node-v$NODE_VER.tar.gz | tar xz
cd node-v$NODE_VER
./configure --shared-openssl --without-snapshot
time make CFLAGS+=-O2 CXXFLAGS+=-O2
sudo make install 
```

但是，由于我在硬件相关编译方面完全是菜鸟，我什至不知道我是否正确！

所以我的问题是（是）以下：

*   这个程序看起来可以吗？没有隐藏的问题？
*   shared-openssl 和 without-snapshot 是什么意思？（从功能上讲）
*   `CFLAGS`这些是什么鬼`CXXFLAGS`？

**更新**

感谢各位亲爱的朋友们的评论，我深入研究了代码。所以它似乎`shared-openssl`代表：

> 链接到共享 OpenSSl DLL 而不是静态链接（[此处](https://github.com/joyent/node/blob/master/configure#L64)）

并`without-snapshot`代表：

> 无需快照 V8 库即可构建。您可能希望将其设置为交叉编译。[默认：假]（[这里](https://github.com/joyent/node/blob/master/configure#L38)）

但是我没有交叉编译，所以看起来没什么用，不是吗？

然后我试图查看`CFLAGS`和`CXXFLAGS`默认值，但我发现没有任何相关。任何想法？

问候

# c++ - 迭代器指向“find_if”匹配后的第一个元素，为什么？

> ID：13924687
> 
> 赞同：3
> 
> 时间：2012-12-18T00:45:32.487
> 
> 标签：c++

我现在正在自学 C++，所以我很新。我正在学习的书中的一个问题要求一个比较两个字符串的二元谓词。下面我复制了我写的东西。我确定这是那些非常简单的解决方案之一，但我自己无法弄清楚。基本上，我的错误出现在 if 语句中。当有匹配时，它总是打印出第一个元素而不是匹配的元素。你能帮忙解释为什么会这样吗？我究竟做错了什么？另外，作为新手，如果您看到任何“丑陋的代码”并且可以识别出您会以不同的方式编写的内容，我将不胜感激，以便我对其进行清理。谢谢！

```
#include "stdafx.h"
#include <iostream>
#include <vector>
#include <algorithm>
#include <string>

using namespace std;

//my comparison predicate starts here

struct comparison{
    string deststring1;
    string deststring2;

comparison (const string& whattheyenter){
    deststring1.resize(whattheyenter.size());
    transform(whattheyenter.begin(),whattheyenter.end(),deststring1.begin(),tolower);
    }

bool operator () (const string& string2) {
    deststring2.resize(string2.size());
    transform(string2.begin(),string2.end(),deststring2.begin(),tolower);
    return (deststring1<deststring2);
    }
};

  //program begins here

int main(){
    string comparethisstring;

    cout<<"enter string to compare: "<<endl;
    cin>>comparethisstring;

    vector<string> listofstrings;

    listofstrings.push_back("my fiRst string");
    listofstrings.push_back("mY sEcond striNg");
    listofstrings.push_back("My ThIrD StRiNg");

    auto ielement = find_if(listofstrings.begin(),listofstrings.end(),comparison(comparethisstring));

    if (ielement!=listofstrings.end()){
          // when there is a match this always prints "my fiRst string" instead of 
          // pointing to the element where the match is.
        cout<<"matched:" <<*ielement; 
    }
    else {
        cout<<"no match found!";
    }

return 0;
} 
```

编辑：只想说问题是首先，我使用了小于运算符，这对于比较相等性没有用。其次，我使用 cin 而不是 getline。结果，当我输入“我的第一个字符串”时，cin 只分配了“我的”来比较这个字符串。感谢大家的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T00:53:43.343

`find_if`找到预测为 的第一个元素`true`。您的预测是“它是否早于字母顺序。当且仅当您等于（或）时，`comparethisstring`您可能希望返回 true 。`comparethisstring``deststring1==deststring2`

我还建议`deststring2`为该`operator()`方法创建一个本地变量。

# sql - 使用 DISTINCT COUNT 的性能

> ID：13924688
> 
> 赞同：12
> 
> 时间：2012-12-18T00:45:37.120
> 
> 标签：sql, sql-server, performance, tsql, indexing

我正在运行 SQL Server 2012。

我有一个查询，当条带化为最基本的形式时，如下所示：

```
SELECT COUNT(DISTINCT fullAddress) as quickCount 
FROM leads
WHERE yearID >=12 AND yearID <=21 
```

潜在客户表中有大约 1.49 亿条记录。在leadID 上有一个聚集索引，在YearID 上有一个非聚集索引，并且包含fullAddress。

这个查询需要大约 40 秒才能运行。我意识到这还不错，但在这种情况下还不够快。

我查看了执行计划，据我所知，大约 60% 的成本是 DISTINCT COUNT。

当我像这样运行没有 DISTINCT COUNT 的相同查询时：

```
SELECT COUNT(*) as quickCount 
FROM leads
WHERE yearID >=12 AND yearID <=21 
```

运行仅需 1 秒。

不幸的是，我需要计算不同的完整地址。所以我想弄清楚是否有什么办法可以让第一个查询运行得更快。

这是两个查询的执行计划的屏幕截图：

![在此处输入图像描述](../Images/33601f1a59c8cc7739b0a044d7cfada3.png)

这是一个更大的链接 - [http://www.sequenzia.com/execPlan.jpg](http://www.sequenzia.com/execPlan.jpg)

据我所知，我的主要问题是 Distinct Sort (52%)。

对此的任何帮助或反馈都会很棒。

谢谢！

**更新**

我接受了 Thilo 的建议并应用了这个索引：

```
 CREATE INDEX IDX_X ON LEADS(FULLADDRESS, YEARID); 
```

我实际上创建了 2 个新的测试表，每个表都有完全相同的 100 万条记录。我将相同的原始索引应用于两者，然后将上述索引应用于其中一个。现在，当我比较同一执行计划上的 2 个表时，具有上述索引的表要好一些，为 48% 到 52%。这是新的执行计划 - [http://www.sequenzia.com/execPlan2.jpg](http://www.sequenzia.com/execPlan2.jpg)

这对一些人有帮助，但我真的需要更多的性能。还有其他想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T00:51:43.623

要尝试的一件事是通过对索引进行排序来摆脱排序`fullAddress`（这也包括`yearID`列，以便您也可以满足 where 子句）。

```
CREATE INDEX IDX_X ON LEADS(FULLADDRESS, YEARID); 
```

这样，您应该获得快速全索引扫描（可能仍然比您对非明确计数的索引范围扫描慢，但希望比您的 40 秒排序更快）。

但是为什么需要这么快呢？这不是你需要一直做的事情，对吧？如果这是一个公共网站，我想你可以摆脱一个稍微过时的缓存结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-07-17T19:12:59.443

此答案无助于解决原始问题（SQL Server 2012）。它适用于 Azure SQL DB 和 SQL Server 2019+。

> ## [Approximate Count Distinct 在 Azure SQL 数据库中进入公共预览版](https://blogs.msdn.microsoft.com/sqlserverstorageengine/2018/07/16/approximate-count-distinct-enters-public-preview-in-azure-sql-database/)

> 近似查询处理是一个新的功能系列，旨在提供跨非常大的数据集的聚合，其中响应能力比绝对精度更重要。...

> **新的 APPROX_COUNT_DISTINCT 聚合函数返回组中唯一非空值的大致数量。**

> ＃＃优点

> 与详尽的精确 COUNT DISTINCT 相比，APPROX_COUNT_DISTINCT 使用更少的内存来计算不同的计数。由于这个原因，即使数据集中有数十亿行，计算也更有可能在内存中完成而不会溢出到磁盘。如果 COUNT DISTINCT 会耗尽内存并将数据溢出到 TempDB 从而导致非常大的性能损失，APPROX_COUNT_DISTINCT 通常不会溢出。

> 部分是由于没有将大型数据集溢出到 TempDB，部分是由于内部算法的结果，**对于非常大的数据集，APPROX_COUNT_DISTINCT 将比 COUNT DISTINCT 执行得快得多。**

> 更多在[APPROX_COUNT_DISTINCT 文档](https://docs.microsoft.com/en-us/sql/t-sql/functions/approx-count-distinct-transact-sql?view=sql-server-2017)

```
SELECT APPROX_COUNT_DISTINCT(fullAddress) as quickCount 
FROM leads
WHERE yearID >=12 AND yearID <=21 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T04:44:59.483

如果您不经常更新此表，您可以查看使用正在运行的查询创建索引视图 [http://msdn.microsoft.com/en-us/library/aa933148(v=sql.80).aspx](http://msdn.microsoft.com/en-us/library/aa933148(v=sql.80).aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-03T22:25:54.017

在进行不同计数之前，我会尝试使用子查询进行过滤

```
WITH cte as (SELECT ID
FROM leads
WHERE yearID >=12 AND yearID <=21)
SELECT COUNT(DISTINCT fullAddress) as quickCount 
FROM leads
JOIN cte on cte.ID = leads.ID 
```

这并不总是在每种情况下都执行得更快，但据我所知，当您在没有执行不同操作的列上有 where 子句时，它会更快。

# php - 通过 PHP / PDO 使用用户定义的名称和数据类型将 MySQL 列添加/删除到现有表

> ID：13924689
> 
> 赞同：3
> 
> 时间：2012-12-18T00:45:39.497
> 
> 标签：php, mysql, pdo, alter-table, alter

我希望我的 PHP Web 应用程序的用户能够将列插入到某些表中，而无需具备 SQL 知识的人。最好的方法是什么，显然 SQL 注入和 id-10-t 错误是一个问题。

我可以用吗

```
sql = 'ALTER TABLE table_name ADD ? ?' 
```

然后将“new_col”和“varchar(100)”作为字符串传入？或者这超出了 PDO 的能力范围吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T02:11:42.570

不幸的是，您不能将`ALTER TABLE`语句中的列名或属性与 PDO 参数绑定。相反，为了防止 SQL 注入，我建议根据只允许字母、数字和下划线的正则表达式验证列名，并确保在语句中反引用列名。

```
if (!preg_match('/^[a-z0-9_]+$/i', $column_name)) {
  // Fail!!! submitted column name doesn't match regex
} 
```

*   `^`= 字符串的开头
*   `[a-z0-9_]+`= 一个或多个字母、数字、下划线
*   `$`= 字符串结尾
*   `/i`= 不区分大小写

接下来，要验证列的数据类型，您应该只允许一组特定的选项，并使用数组验证它们。这称为*白名单*。

```
// Allowed types:
$acceptable_types = array('VARCHAR(200)', 'VARCHAR(10)', 'INT', 'FLOAT', 'etc...');
if (!in_array($column_data_type, $acceptable_types)) {
  // Fail!!! Invalid type submitted
} 
```

上述选项最好通过`<select>`列表之类的方式提供。您还可以指定其他选项，例如`NULL / NOT NULL`复选框输入来构造`ALTER TABLE`语句。

```
// Only after everything is successfully validated:
$sql = "ALTER TABLE `tablename` ADD `$valid_column_name` $valid_column_datatype $NULL_option"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-04T21:16:37.350

您可能需要考虑附加列的元表。

如果您为每种汽车设置了数据（如整备重量、高度等），然后是用户添加的其他专门信息，但不适用于每辆汽车，您可以将其存储在单独的表中，如下所示：

CAR TABLE: id name 路边重量身高 ...

META TABLE: id (主键) car_id (外键) data_name data_value

Meta 表与 Car 表是一对多的关系。如果用户想要为 2 辆特定汽车添加一列以记录“镜子大小”或其他内容，则 Meta 表将获得两条记录，其中包含自动 id、汽车 id、“镜子大小”和大小。

如果您想要一组数据名称列表，您可以使用第三个表，并让元表存储 id、car_id 和 data_id。

只是一个想法！

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-12-18T05:34:06.710

最好的方法显然是**不允许**用户能够将列插入某些表中。特别是不需要具有 SQL 知识的人。
这是违反所有规则的。

这样一个相当基本的问题与极其不寻常的目标相结合总是有一种糟糕的设计的味道。

所以，正确的答案是：

1.  放弃这种用户添加列的想法。这真的很奇怪。
2.  开始另一个问题，解释你的总体目标，描述用例并寻求适当的解决方案。

# php - onClick 在值中输入 php

> ID：13924691
> 
> 赞同：0
> 
> 时间：2012-12-18T00:45:58.743
> 
> 标签：php, html, forms, input, onclick

我在我的网页中嵌入了一个提交搜索的按钮。此表单的搜索值`txt`由`php code`. 我遇到的问题是`php code`它仅在网页加载时加载一次。这是一个问题，因为`txt`文件在不断变化，并且它的内容在第一次时才被读取。所以我想要的是在单击提交按钮时输入搜索值。换句话说，我正在寻找`php code`运行并填充搜索值 onClick。

这是表格：

```
<form id="search" action="http://www.example.com/search.php" method="get" target="_blank">
<input type="hidden" name="search" value="<?php $file = "http://www.clavederock.com.ar/zararadio/CurrentSong.txt";
   $f = fopen($file, "r");
   while ( $line = fgets($f, 1000) ) {
   $line = preg_replace("/-(.*?)-/", "", $line);
   print $line;}?>"/>  
<input type="hidden" name="language" value="es"/>
<input type="image" src="img/psue.png">
</form> 
```

任何建议或帮助将不胜感激！！谢谢！

编辑：我看到 php 在页面交付之前被执行，因为它是服务器端脚本。为了解决这个问题，有没有办法让`php code`每 x 秒运行一次？就像你在 div 中所做的那样：

```
 setInterval(function(){
 $('#ID').load('example.php');
 }, 10000); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T00:51:35.153

您将不得不以不同的方式解决这个问题，PHP 是服务器端脚本（它在页面交付之前执行），而 JS 是客户端，这意味着它从页面交付到它的任何时间执行被陈列。

您可以尝试使用 AJAX，并查询文件并更改回调中的内容。

EDIT: I think I understand your question better. You are going to have to use AJAX, and have the PHP code in the file that gets actioned. You can post the input value as a get variable, i.e. ?input=value and then get that in your PHP file. Then use AJAX to get the response back, without reloading the page.

# class - 具有任意类型属性的 Scala 类

> ID：13924700
> 
> 赞同：1
> 
> 时间：2012-12-18T00:48:36.703
> 
> 标签：class, scala, types

我有一个类代表我们系统中的帖子。帖子可能代表问题、文档、图像等。 Post 类可以代表大约 7 种不同类型的对象。我们拥有的 7 种不同类型的对象中的每一种都有自己的元数据类来存储额外的对象特定信息。

目前，我的 Post 类有 7 个可选属性，其中一个根据对象的类型填充。但是由于 Post 类只会填充这 7 个属性中的一个，有没有办法将它们合并为具有任意类型的单个属性？然后我可以使用 match case 语句在运行时生成正确的元数据对象。或者考虑到语言的强类型特性，这在 Scala 中是不可能的。

代码如下：

```
 case class Post (
      id       : Long,
      typ      : String,
      name     : String,
      fileInfo : Option[FileInfo],
      imageInfo : Option[FileImageInfo],
      videoInfo : Option[FileVideoInfo],
      audioInfo : Option[FileAudioInfo],
      eventInfo: Option[EventInfo],
      lectureInfo: Option[LectureInfo],
      drawingInfo: Option[DrawingInfo]
    )

    object Post {

      val simple = {
        get[Long]("object_view.id") ~
        get[String]("object_view.type") ~
        get[String]("object_view.name") map {
          case id~typ~name =>
            Post(
                 id, 
                 typ, 
                 name, 
                 FileInfo.getById(id),
                 FileImageInfo.getById(id),
                 FileVideoInfo.getById(id),
                 FileAudioInfo.getById(id),
                 EventInfo.getFirst(id),
                 LectureInfo.getById(id),
                 DrawingInfo.getById(id)
          )
       }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T19:23:10.847

为什么不将 Post 抽象化，然后为每种不同类型的 post 实现一个子类？就像是：

```
 abstract class Post { val id:Long; val typ:String; val name:String; }
  case class FilePost(
      id       : Long,
      typ      : String,
      name     : String,
      fileInfo : Option[FileInfo
  );
  case class ImagePost(
      id       : Long,
      typ      : String,
      name     : String,
      imageInfo : FileImageInfo
  );
  ...

  def doSomething( post:Post ):Unit = post match {
      case fp:FilePost => ...
    } 
```

嗬！- 看起来早先的回应说同样的话......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T02:22:59.330

```
class FileInfo(val name: String)
abstract trait CanGet[T] { val value: Option[T]; def get = value.get }
case class PostFileInfo(val id: Long, val typ: String, val name: String) extends 
  { val value = Some(new FileInfo(name)) } with CanGet[FileInfo]

...

(1L, "FileInfo", "FileName") match { 
  case (id, typ @ "FileInfo", name) => new PostFileInfo(1, typ, name)
} 
```

# spring - Spring MVC + Hibernate 4 + Spring Security

> ID：13924701
> 
> 赞同：0
> 
> 时间：2012-12-18T00:49:12.123
> 
> 标签：spring, hibernate, spring-mvc, spring-security

从现在开始，我一直在努力完成所有这些工作，不知道该怎么做。我相信我在 SO 上浏览了关于该主题的每一篇文章，并浏览了数十个教程......

这是我此时收到的信息：

```
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'fruitController': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire method: public void com.controller.FruitController.setFruitManager(com.service.FruitManager); nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [com.service.FruitManager] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {} 
```

我过去已经能够解决这个错误，但只是有一个新的“没有为当前线程找到会话”。当没有这个时，我的 Assembler 和 UserDetailsS​​erviceImpl bean 在我的 spring-security.xml 文件中没有被识别出一些问题......

我不认为问题来自我的代码，我只是无法正确设置我的配置文件，我可能在这里遗漏了一些东西。

以下是配置文件：

网页.xml：

```
<web-app id="WebApp_ID" version="2.4"
    xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee 
    http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd">

    <display-name>Spring MVC Application</display-name>

    <!-- Spring MVC -->
    <servlet>
        <servlet-name>mvc-dispatcher</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>mvc-dispatcher</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>

    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>
            /WEB-INF/mvc-dispatcher-servlet.xml,
            /WEB-INF/spring-security.xml
        </param-value>
    </context-param>

    <!-- Spring Security -->
    <filter>
        <filter-name>springSecurityFilterChain</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    </filter>

    <filter-mapping>
        <filter-name>springSecurityFilterChain</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

</web-app> 
```

应用程序上下文.xml：

```
<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xsi:schemaLocation="http://www.springframework.org/schema/beans 
           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
           http://www.springframework.org/schema/aop 
           http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
           http://www.springframework.org/schema/tx 
           http://www.springframework.org/schema/tx/spring-tx-3.0.xsd">

    <context:annotation-config/>
    <!-- Load everything except @Controllers -->
    <context:component-scan base-package="com">
        <context:exclude-filter expression="org.springframework.stereotype.Controller"
            type="annotation" />
    </context:component-scan>

    <tx:annotation-driven transaction-manager="transactionManager" />

    <tx:advice id="txAdvice">
        <tx:attributes>
            <tx:method name="save*" />
            <tx:method name="*" read-only="false" />
        </tx:attributes>
    </tx:advice>

    <bean id="transactionManager"
        class="org.springframework.orm.hibernate4.HibernateTransactionManager">
        <property name="sessionFactory" ref="sessionFactory" />
    </bean>

    <bean id="sessionFactory"
        class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
        <property name="dataSource" ref="dataSource" />
        <property name="annotatedClasses">
            <list>
                <value>com.dao.HibernateFruitDAO</value>
            </list>
        </property>
        <property name="packagesToScan">
            <list>
                <value>com.service</value>
                <value>com.controller</value>
            </list>
        </property>
        <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect">org.hibernate.dialect.MySQL5Dialect</prop>
                <prop key="hibernate.hbm2ddl.auto">update</prop>
                <prop key="hibernate.show_sql">true</prop>
            </props>
        </property>
    </bean>

    <bean id="dataSource"
        class="org.springframework.jdbc.datasource.DriverManagerDataSource">
        <property name="driverClassName" value="com.mysql.jdbc.Driver" />
        <property name="url" value="jdbc:mysql://localhost:3306/basename" />
        <property name="username" value="xxx" />
        <property name="password" value="yyy" />
    </bean>

</beans> 
```

mvc-调度程序-servlet.xml：

```
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:aop="http://www.springframework.org/schema/aop" xmlns:tx="http://www.springframework.org/schema/tx"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xsi:schemaLocation="
        http://www.springframework.org/schema/beans     
        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context 
        http://www.springframework.org/schema/context/spring-context-3.0.xsd
        http://www.springframework.org/schema/mvc 
        http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd">

    <context:annotation-config />

    <context:property-placeholder location="classpath:hibernate.properties" />

    <!-- Load @Controllers only -->
    <context:component-scan base-package="com.controller"
        use-default-filters="false">
        <context:include-filter expression="org.springframework.stereotype.Controller"
            type="annotation" />
    </context:component-scan>

    <bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter"></bean>
    <bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping"></bean>

    <bean
        class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="prefix">
            <value>/WEB-INF/pages/</value>
        </property>
        <property name="suffix">
            <value>.jsp</value>
        </property>
    </bean>

    <bean id="messageSource"
        class="org.springframework.context.support.ResourceBundleMessageSource">
        <property name="basenames">
            <list>
                <value>mymessages</value>
            </list>
        </property>
    </bean>

    <bean id="propertyConfigurer"
        class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="locations">
            <list>
                <value>classpath:jdbc.properties</value>
            </list>
        </property>
    </bean>

</beans> 
```

spring-security.xml http://www.springframework.org/schema/beans/spring-beans-3.0.xsd [http://www.springframework.org/schema/context](http://www.springframework.org/schema/context) http://www.springframework.org/schema /context/spring-context.xsd [http://www.springframework.org/schema/security](http://www.springframework.org/schema/security) http://www.springframework.org/schema/security/spring-security-3.1.xsd">

```
 <beans:bean id="userDetailsService" class="com.service.UserDetailsServiceImpl">
    </beans:bean>

    <beans:bean id="assembler" class="com.service.Assembler">
    </beans:bean>

    <http auto-config='true' use-expressions='true'>
        <intercept-url pattern="/login*" access="isAnonymous()" />
        <intercept-url pattern="/secure/**" access="hasRole('ROLE_Admin')" />
            <logout logout-success-url="/listing.htm" />
        <form-login login-page="/login.htm" login-processing-url="/j_spring_security_check"
            authentication-failure-url="/login_error.htm" default-target-url="/listing.htm"
            always-use-default-target="true" />
    </http>

    <beans:bean id="com.daoAuthenticationProvider"
        class="org.springframework.security.authentication.dao.DaoAuthenticationProvider">
        <beans:property name="userDetailsService" ref="userDetailsService" />
    </beans:bean>

    <beans:bean id="authenticationManager"
        class="org.springframework.security.authentication.ProviderManager">
        <beans:property name="providers">
            <beans:list>
                <beans:ref local="com.daoAuthenticationProvider" />
            </beans:list>
        </beans:property>
    </beans:bean>

    <authentication-manager>
        <authentication-provider user-service-ref="userDetailsService">
            <password-encoder hash="plaintext" />
        </authentication-provider>
    </authentication-manager>
</beans:beans> 
```

水果控制器：

```
package com.controller;

@Controller
public class FruitController{

    protected final Log logger = LogFactory.getLog(getClass());

    private FruitManager fruitManager;

    @Autowired
    public void setFruitManager(FruitManager FruitManager) {
        this.fruitManager = fruitManager;
    }

    @RequestMapping(value = "/listing", method = RequestMethod.GET)
    public String getFruits(ModelMap model) {
        model.addAttribute("fruits", this.fruitManager.getFruits());
        return "listing";
    }
} 
```

FruitDAO：公共接口 FruitDAO {

```
public List<Fruit> getFruitList();

public List<Fruit> getFruitListByUserId(String userId);

public void saveFruit(Fruitprod);

public void updateFruit(Fruitprod);

public void deleteFruit(int id);

public Fruit getFruitById(int id); 
```

}

HibernateFruitDAO

```
package com.dao;

@Repository("fruitDao")
public class HibernateFruitDAO implements FruitDAO {

private SessionFactory sessionFactory;

        @Autowired
        public void setSessionFactory(SessionFactory sessionFactory) {
            this.sessionFactory = sessionFactory;
        }

    public List<Fruit> getList() {
        return (List<Fruit>) getSession().createCriteria ( Fruit.class ).list();
    }

    public List<Fruit> getFruitListByUserId(String userId) {
        return (List<Fruit>)sessionFactory.getCurrentSession().createCriteria("from Fruit where userId =?", userId).list();
    }

    public void saveFruit(Fruit fruit) {
        sessionFactory.getCurrentSession().save(fruit);
    }

    public void updateFruit(Fruit fruit) {
        sessionFactory.getCurrentSession().update(fruit);
    }

    public void deleteFruit(int id) {
        Fruit fruit = (Fruit) sessionFactory.getCurrentSession().load(Fruit.class, id);
        if (null != fruit) {
            sessionFactory.getCurrentSession().delete(fruit);
        }
    }

    public Fruit getFruitById(int id) {
        return (Fruit)sessionFactory.getCurrentSession().load(Fruit.class, id);
    }

    private Session getSession(){
            return sessionFactory.getCurrentSession();
        }
} 
```

接口水果管理器：

```
package com.service;

import java.io.Serializable;
import java.util.List;

import com.domain.Fruit;

public interface FruitManager extends Serializable{

    public List<Fruit> getFruits();

    public List<Fruit> getFruitsByUserId(String userId);

    public void addFruit(Fruit fruit);

    public void removeFruit(int id);

    public Fruit getFruitById(int id);

    public void updateFruit(Fruit fruit);
} 
```

FruitManager 的实现：

```
package com.service;

@Repository("fruitManager")
@Transactional
public class SimpleFruitManager implements FruitManager {

    /**
     * 
     */
    private static final long serialVersionUID = ...;

    @Autowired
    private FruitDAO fruitDao;

    public List<Fruit> getFruits() {
        return fruitDao.getFruitList();
    }

    public List<Fruit> getFruitsByUserId(String userId){
        return fruitDao.getFruitListByUserId(userId);
    }

    public void setFruitDao(FruitDAO fruitDao) {
        this.fruitDao = fruitDao;
    }

    public void addFruit(Fruit fruit) {
        fruitDao.saveFruit(fruit);
    }

    public void removeFruit(int id) {
        fruitDao.deleteFruit(id);
    }

    public  getFruitById(int id) {
        return fruitDao.getFruitById(id);
    }

    public void updateFruit(Fruit fruit) {
        fruitDao.updateFruit(fruit);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T02:22:45.057

乍一看，您似乎遇到了一个常见问题，即不了解 Spring ApplicationContexts 如何组合在一起以构建 Web 应用程序。请参阅我对完全相同问题的其他答案，看看它是否可以解决问题：

[在父上下文与子上下文中声明 Spring Bean](https://stackoverflow.com/questions/7746633/declaring-spring-bean-in-parent-context-vs-child-context/7748108#7748108)

您也可能会被这个关于类似主题的答案所启发，该主题链接到我之前提到的答案以及另一个答案：

[Spring XML 文件配置层次结构帮助/说明](https://stackoverflow.com/questions/7774295/spring-xml-file-configuration-hierarchy-help-explanation/7774597#7774597)

几个简短的提示可以让你朝着正确的方向前进……

按照惯例，Spring 的 ContextLoaderListener 从中加载 bean`WEB-INF/applicationContext.xml`以创建根应用程序上下文。当您覆盖默认值时，正如您所做的那样，该文件不再加载。

*提示＃1：坚持常规行为。它会让你的生活更简单。*

同样按照惯例，启动 Spring DispatcherServlet 会从中加载 bean`WEB-INF/<servlet name>-context.xml`以创建用于配置调度程序 servlet 的上下文。该上下文成为根上下文的子上下文。

*提示 #2：见提示 #1*

所以你看，你现在过度配置了东西。阅读链接的答案和其中链接的参考资料。学习使用 Spring 而不是反对它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T01:51:10.623

在您的 web.xml 文件中，`applicationContext.xml`永远不会加载。你应该把它的位置放在`context-param`. 将`mvc-dispatcher-servlet.xml`（包含与控制器相关的 bean）的位置作为 DispatcherServlet 的 init-param 代替：

```
<init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>/WEB-INF/mvc-dispatcher-servlet.xml</param-value>
        </init-param> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T16:47:29.273

我认为您必须在 DaoImpl 中使用它来获取会话：

```
@Autowired
private SessionFactory sessionFactory; 
```

# php - .htaccess 重写规则错误

> ID：13924703
> 
> 赞同：1
> 
> 时间：2012-12-18T00:49:46.017
> 
> 标签：php, .htaccess, yii

我在 .htaccess 中有这些行。

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . index.php 
```

现在，我想将以下内容添加到 .htaccess 中，这样我就可以将所有用户重定向到[http://www.mydomain.com](http://www.mydomain.com)

```
RewriteCond %{HTTP_HOST} ^mydomain.com
RewriteRule ^(.*)$ http://www.mydomain.com/$1 [R=301,L] 
```

所以，我只是在现有的 .htaccess 文件中添加了上面的代码。

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{HTTP_HOST} ^mydomain.com
RewriteRule ^(.*)$ http://www.mydomain.com/$1 [R=301,L]
RewriteRule . index.php 
```

但是，它不像我预期的那样工作。

请教我在这种情况下应该如何写作。

提前非常感谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T03:28:15.063

您应该首先重定向到 www 子域，然后将请求转发到您的 index.php 文件。尝试这个：

```
<IfModule mod_rewrite.c>
    RewriteEngine on
    RewriteCond %{HTTP_HOST} !^(www\.).+$ [NC]
    RewriteRule ^(.*)$ http://www.%1/$1 [R=301,L]

    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !-l
    RewriteRule ^(.*)$ index.php?/$1 [L]
</IfModule> 
```

# javascript - 读入文件然后创建该文件的 Blob

> ID：13924704
> 
> 赞同：0
> 
> 时间：2012-12-18T00:49:52.137
> 
> 标签：javascript, ajax, blob

如果我想读入一个文件（比如：audio.mp3）并且我知道它的位置，并且我想通过 Blob 中的 javascript 重新创建该文件，以便我可以将它附加到 FormData 中，这可能吗？

```
 $.ajax({
                'type': 'GET',
                'url': sounds/audio.mp3
            }).done(function(body) {
                var blob = new Blob([body], {'type': 'audio/mpeg'});
                var formdata = new FormData();

                //Set other things then...
                data.append('audio.mp3', blob);
            }).fail(function(jqXHR, textStatus) {
                alert('failed');
            }); 
```

它正确地提交到另一个我需要将它发送到的 Web 服务器，并且我得到一个返回到该文件的 URL，该文件由 Blob 重新创建，但我无法再听声音了。这是可能的还是我只是在抓空气？

是否有可能我只是忘记放入一些东西以使数据结构对音频正确？

# xml - 将 xml 数据从 Web 导入 MS-Access 2007

> ID：13924706
> 
> 赞同：2
> 
> 时间：2012-12-18T00:50:01.410
> 
> 标签：xml, ms-access-2007

> **可能重复：**
> [MS Access XMLImport 从文本或流而不是文件？](https://stackoverflow.com/questions/5757740/ms-access-xmlimport-from-text-or-stream-instead-of-file)

这似乎是一件很简单的事情（至少在 Excel 中），但是如何将网络上的 xml 源中的数据导入 Access 中呢？我已经进行了几次搜索，但我没有得到任何地方，所以我开始认为它无法完成，但也许我没有问正确的问题。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T03:30:30.630

如果将 XML 保存为本地文件，则可以使用 Access 的[Application.ImportXML 方法](http://msdn.microsoft.com/en-us/library/office/bb237973%28v=office.12%29.aspx)。不幸的是，它不允许您直接从远程 XML 源的 URL 导入。这一点在之前的 Stack Overflow 问题中得到了解决：[MS Access XMLImport from text or stream instead of file?](https://stackoverflow.com/questions/5757740/ms-access-xmlimport-from-text-or-stream-instead-of-file) AFAIK，没有人找到办法做到这一点。

另一个陷阱是`ImportXML`复杂的 XML 模式失败。试试你的，看看它是否被接受。

或者，您可以将 XML 作为 a 打开`MSXML DOMDocument`并使用其方法仅提取您想要的值，然后将它们存储在您的表中。该方法适用于 URL 或本地文件。您可以在此 SO 答案中找到该方法的一些提示：[https ://stackoverflow.com/a/3398999/77335](https://stackoverflow.com/a/3398999/77335)

# python - 三元和打印组合给出奇怪的结果

> ID：13924709
> 
> 赞同：2
> 
> 时间：2012-12-18T00:50:46.630
> 
> 标签：python, printing, ternary

如果某件事是真的，我试图使用一个三元来打印一个字符串，如果不是的话（足够简单，对吧？）。它没有给出任何错误，并且似乎不会造成任何麻烦。然而，跑步时...

```
print('[',dr+1,']\t',d[dr] if fullpath else '[',dr+1,']\t',d[dr].split("/")[len(d[dr].split("/"))-2], sep='') 
```

...打印出来

```
'[',dr+1,']\t' 
```

两次。例如，它打印以下内容：

```
[1] [1] Accoustic
[2] [2] Classical
[3] [3] Epic
[4] [4] Rock
[5] [5] Spoof
[6] [6] Techno & Electronic 
```

如果您愿意，为了查看变量是什么（这无关紧要，因为这只是一个概念问题），您可以在[此处查看其余代码](http://ubuntuone.com/3uIi7bdHZq525eaZLYt9tu)

考虑到它可能是变量，我尝试单独打印语句（没有三元）并且它们按我的预期出现（即没有奇怪的重复）。知道变量没问题，我尝试用括号括起来字符串（以防止字符串混合），但是，由于 python 逐字解释它们，它们以数组而不是字符串的形式出现。此外，+ 符号（代替逗号）不起作用，因为 python 无法组合数据类型。我最终将声明更改为

```
print('[',dr+1,']\t',d[dr]) if fullpath else print('[',dr+1,']\t',d[dr].split("/")[len(d[dr].split("/"))-2], sep='') 
```

它工作正常。

除了不是很好的编码，为什么第一个字符串被打印两次？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T00:57:10.383

请允许我为你分解它...

```
print(('['), (dr+1), (']\t'), (d[dr] if fullpath else '['), (dr+1), (']\t'), (d[dr].split("/")[len(d[dr].split("/"))-2]), sep='') 
```

看到问题了吗？

```
print(*(('[',dr+1,']\t', d[dr]) if fullpath else ('[',dr+1,']\t', d[dr].split("/")[len(d[dr].split("/"))-2])), sep='') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T00:57:21.893

我不确定为什么它不会打印两次：

```
print('[',dr+1,']\t',       #first one
      d[dr] if fullpath else '[',
      dr+1,']\t',           #second one (most of it anyway)
      d[dr].split("/")[len(d[dr].split("/"))-2],
      sep='') 
```

取决于`fullpath`，您的陈述可能看起来像

```
print('[',dr+1,']\t',       #first one
      d[dr],dr+1,']\t',     #second one (more or less)
      d[dr].split("/")[len(d[dr].split("/"))-2], 
      sep='') 
```

或者它可能看起来像：

```
print('[',dr+1,']\t',
      '[',dr+1,']\t',
      d[dr].split("/")[len(d[dr].split("/"))-2], 
      sep='') 
```

# iphone - 故事板中标签栏的菜单

> ID：13924714
> 
> 赞同：16
> 
> 时间：2012-12-18T00:51:28.210
> 
> 标签：iphone, ios, xcode, uitabbar

目前我有一个标准的标签栏，点击后会转到相应的视图控制器。But I want to make a menu pop out from tab bar when more tab is selected, as shown in below image.

![在此处输入图像描述](../Images/70d80c944e29f96671ded9604376fd84.png)

有什么建议可以实施吗？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2018-02-20T21:12:05.473

我建议你这样做：

首先，您应该考虑标签栏中可能存在的所有标签类型。在您的屏幕截图上有显示控制器的选项卡和显示菜单的选项卡。所以我们可以创建所有这些类型的枚举：

```
enum TabType {
    case controller
    case menu
} 
```

之后，您可以存储选项卡类型的数组，以便它们在选项卡栏中显示，对于您的屏幕截图，如下所示

```
let tabTypes: [TabType] = [.controller, .controller, .controller, .controller, .menu] 
```

然后你应该实现`UITabBarControllerDelegate`'s`func tabBarController(_:, shouldSelect:) -> Bool`方法，`true`如果允许标签栏选择传递的控制器，则返回，`false`否则返回。

如果您返回`true`所有其他工作（例如呈现视图控制器和其他东西），标签栏控制器将为您完成。

在您的情况下，您想在选项卡单击时执行自定义操作，因此您应该返回`false`. 在返回之前，您应该出示您的菜单。

```
func tabBarController(_ tabBarController: UITabBarController, shouldSelect viewController: UIViewController) -> Bool {
    if let index = tabBarController.viewControllers?.index(of: viewController),
        index < tabBarTypes.count {
        let type = tabBarTypes[index]
        switch type {
        case .menu:
            // perform your menu presenting here
            return false
        case .controller:
            // do nothing, just return true, tab bar will do all work for you
            return true
        }
    }
    return true
} 
```

在这个实现中，您可以轻松更改选项卡类型的顺序或添加一些其他选项卡类型并进行适当的处​​理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-27T07:47:19.807

根据我的理解，您想要的是，选择选项卡 1 并且用户转到选项卡 5，然后背景将是选项卡 1，反之亦然选项卡 2、3 和 4，并且应该弹出像您的图像所示的按钮. 如果我错了，请纠正我。

为此，您必须在用户浏览选项卡时捕获图像。

**请在AppDelegate**中找到以下代码，

`var currentImage: UIImage! //It will be public variable`

标签栏委托方法，

```
func tabBarController(_ tabBarController: UITabBarController, didSelect viewController: UIViewController) {
    if tabBarController.selectedIndex == 4 {
        let moreVC = tabBarController.selectedViewController as! MoreVC
        moreVC.currentImage = currentImage
    }
}

func tabBarController(_ tabBarController: UITabBarController, shouldSelect viewController: UIViewController) -> Bool {
    if tabBarController.selectedIndex != 4 {
        let navController = tabBarController.selectedViewController as! UINavigationController
        let viewController = navController.viewControllers.last
        currentImage = Common.imageWithView(inView: (viewController?.navigationController?.view)!) //UIImage(view: (viewController?.navigationController?.view)!)
    }

    return true
} 
```

在这里，我将静态 4 作为最后一个选项卡索引，而 MoreVC 将是选项卡索引 4 的关联 ViewController。

从视图中获取图像的通用类，

```
class Common {
    static func imageWithView(inView: UIView) -> UIImage? {
        UIGraphicsBeginImageContextWithOptions(inView.bounds.size, inView.isOpaque, 0.0)
        defer { UIGraphicsEndImageContext() }
        if let context = UIGraphicsGetCurrentContext() {
            inView.layer.render(in: context)
            let image = UIGraphicsGetImageFromCurrentImageContext()
            return image
        }
        return nil
    }
} 
```

请找MoreVC,

```
@IBOutlet weak var imageView: UIImageView!

var currentImage: UIImage! {
    didSet {
        imageView.image = currentImage
    }
} 
```

请在下面找到 MoreVC 故事板的图片。看起来它不像所有其他 ViewController 那样包含 NavigationController。

[![在此处输入图像描述](../Images/52316d7521ea5d473e8a20f8ae53b9fb.png)](https://i.stack.imgur.com/k0CLP.png)

如有任何疑问，请告诉我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-23T15:49:38.163

这是对 Apples HIG 中 UI 模式布局的滥用。具体来说：

> 严格使用标签栏进行导航。不应使用标签栏按钮来执行操作。如果您需要提供作用于当前视图中的元素的控件，请改用工具栏。

此控件应用于扁平化您的应用层次结构。在这种情况下，您似乎正在混合按钮的功能。有时它会选择一个单独的视图控制器，有时它会显示一个动作列表。这对用户来说是一个令人困惑的情况，应该避免。

实现此目的并仍坚持 HIG 的一种方法是使用导航栏或工具栏。将此控件嵌入工具栏按钮中。最简单的情况是调用 a`UIActionController`并`.actionSheet`选择样式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-23T12:03:17.887

您可以使用可滚动的选项卡视图来获得更好的 UI，而不是显示菜单。如果您更喜欢使用库，[这里](https://github.com/raihan/ZRScrollableTabBar)有一个简单的可滚动标签栏，您可以实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-02-27T13:25:45.587

**1）** 创建一个“Tab5ViewController”并使用它：

```
static func takeScreenshot(bottomPadding padding: CGFloat = 0) -> UIImage? {
        let layer = UIApplication.shared.keyWindow!.layer
        let scale = UIScreen.main.scale
        UIGraphicsBeginImageContextWithOptions(CGSize(width: layer.frame.size.width, height: layer.frame.size.height - padding), false, scale)

        guard let context = UIGraphicsGetCurrentContext() else { return nil }
        layer.render(in: context)
        let screenshot = UIGraphicsGetImageFromCurrentImageContext()
        UIGraphicsEndImageContext()
        return screenshot
    } 
```

使用屏幕截图作为“Tab5ViewController”的背景图片

**2）**在您的“Tab5ViewController”中，您可以拥有堆栈组件（附加选项卡），然后根据选择添加/删除子视图控制器

**3）** 修复边缘情况（如选项卡选择突出显示等......）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-02-20T17:08:34.183

它的用户界面不好，但如果你愿意的话。

首先，您必须实现 UITabbarControllerDelegate 的委托方法，如下所示

```
func tabBarController(_ tabBarController: UITabBarController, shouldSelect 
 viewController: UIViewController) -> Bool {

    if viewController.classForCoder == moreViewController.self
    {   
        let popvc = MoreSubMenuViews(nibName: "MoreSubMenuViews", bundle: Bundle.main)
        self.addChildViewController(popvc)

        let tabbarHeight = tabBar.frame.height
        let estimatedWidth:CGFloat = 200.0
        let estimatedHeight:CGFloat = 300.0
        popvc.view.frame = CGRect(x:self.view.frame.width - estimatedWidth, y: self.view.frame.height - estimatedHeight - tabbarHeight, width: estimatedWidth, height: estimatedHeight)

        self.view.addSubview(popvc.view)

        popvc.didMove(toParentViewController: self)

        print("sorry stop here")
        return true // if you want not to select return false here

    }else{

        //remove popup logic here if opened
        return true
    }
} 
```

这里**moreViewController**是最后一个选项卡控制器，**而 MoreSubMenuViews**是 nib/xib 文件，其中包含图像中显示的按钮。

# jquery - jQuery 选项卡 - 从 URL 直接转到特定选项卡

> ID：13924718
> 
> 赞同：2
> 
> 时间：2012-12-18T00:51:49.380
> 
> 标签：jquery, tabs

我正在使用 jQuery 选项卡实现并且一切正常，但是我希望能够链接到一个 URL，例如[http://www.mydomain.com/tabs.html#tab2](http://www.mydomain.com/tabs.html#tab2)并在选项卡 2 上自动打开页面，到目前为止我在哪里[http://jsfiddle.net/Jmx7k/](http://jsfiddle.net/Jmx7k/)

```
<script>
jQuery(document).ready(function() {
    jQuery('#tabs2 li a:not(:first)').addClass('inactive');
    jQuery('.container:not(:first)').hide();

    jQuery('#tabs2 li a').click(function() {
        var t = jQuery(this).attr('href');
        if (jQuery(this).hasClass('inactive')) { //added to not animate when active
            jQuery('#tabs2 li a').addClass('inactive');
            jQuery(this).removeClass('inactive');
            jQuery('.container').hide();
            jQuery(t).fadeIn('slow');
         }
    return false;
}) //end click
});​
</script>
    <div id="tabs2holder">
        <ul id="tabs2">
        <li><a href="#tab1">Test Tab 1</a></li>
        <li><a href="#tab2">Test Tab 2</a></li>
    </ul>
</div>

<div class="container" id="tab1">
    This is test content for tab1
</div>

<div class="container" id="tab2">
     This is test content for tab2
</div> 
```

有人能指出我添加此功能的正确方向，并解释为什么它目前不这样做吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T09:27:08.810

好的，如果你想创建一个带有散列部分（例如'#tab2'）的url，你可以得到这个值

```
var hash = location.hash; // hash = '#tab2' 
```

像这样更改您的代码

```
jQuery(document).ready(function() {
    jQuery('#tabs2 li a:not(:first)').addClass('inactive');
    jQuery('.container:not(:first)').hide();

    jQuery('#tabs2 li a').click(function() {
        var t = jQuery(this).attr('href');
        if (jQuery(this).hasClass('inactive')) { //added to not animate when active
            jQuery('#tabs2 li a').addClass('inactive');
            jQuery(this).removeClass('inactive');
            jQuery('.container').hide();
            jQuery(t).fadeIn('slow');
        }
        return false;
    }); //end click

    if (location.hash == '#tab2') {
        // don't forget to put id-attributes to your li-elements
        jQuery('#tablink2 a').trigger('click');
    }
});​ 
```

另请参见此处： http: [//jsfiddle.net/Jmx7k/8/](http://jsfiddle.net/Jmx7k/8/) 由 jsfiddle 哈希属性不影响 javascript 区域 :-( 在正常上下文中尝试。

# javascript - 如何将半透明背景图像应用于 Google 地图多边形？

> ID：13924720
> 
> 赞同：1
> 
> 时间：2012-12-18T00:51:55.120
> 
> 标签：javascript, google-maps, kml

我有一张带有一些未填充多边形的地图。这些多边形的形状是从 KML 文件中导入的：

```
$(function() {
    var mapOptions = {
      center: new google.maps.LatLng(50.845188, -0.130463),
      zoom: 12,
      mapTypeId: google.maps.MapTypeId.HYBRID
    };
    map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);

    var wardsLayer = new google.maps.KmlLayer('someKMLfile.kml', {
        suppressInfoWindows: true ,
        preserveViewport: true
    });
    wardsLayer.setMap(map);
}); 
```

我想要做的是用图像文件填充 KML 文件中定义的多边形。这可能吗？如何？

额外问题：是否可以控制这些背景图像的不透明度？

# c# - 具有不同名称的相同类

> ID：13924735
> 
> 赞同：-4
> 
> 时间：2012-12-18T00:53:48.233
> 
> 标签：c#, class

我想在我的班级名称中更具描述性。我有三个相同的类，如下所示：

```
 public class Dog   
    {
        public string name;  
        public int id;  

        public Dog(){}
        public Dog(DataRow dr)
        {
            name = dr["Name"];
            id = dr["Id"];
        }   
    }    
    public class Cat
    {
        public string name;  
        public int id;  

        public Cat(){}
        public Cat(DataRow dr)
        {
            name = dr["Name"];
            id = dr["Id"];
        }   
    }
    public class Horse
    {
        public string name;  
        public int horseId;  

        public Horse(){}
        public Horse(DataRow dr)
        {
            name = dr["Name"];
            horseId= dr["horseId"];
        }   
    } 
```

如何通过使用基类来避免代码重复？什么是最佳实践？请注意，马有一个名为 HorseId 而不是 Id 的属性。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T01:00:17.640

使用继承。

```
public class Animal 
{
    public string name;  
    public int id;  

    public Animal() {}
    public Animal(DataRow dr)
    {
        name = (string)dr["Name"];
        id = (int)dr["Id"];
    }   
}

// unfortunately, constructors aren't inherited automatically in C#.
public class Cat : Animal 
{
   public Cat() : base() {}
   public Cat(DataRow dr) : base(dr) {}
} 

public class Dog : Animal 
{     
   public Dog() : base() {}
   public Dog(DataRow dr) : base(dr) {}
}

public class Horse: Animal 
{
   public int horseId { get { return id; } set { id = value; } }
   public Horse() : base() {}
   public Horse(DataRow dr) : base(dr) {}    
} 
```

**编辑：**正如 Blorgbeard 所说，您可以根据需要创建`Animal`一个`abstract`类 - 这将阻止实例化（`new Animal()`将是非法的；客户端代码必须选择一个特定的子类）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T02:19:43.340

As far as some good examples on object oriented design, I'd recommend two books.

1.  The Object Oriented Thought Process
2.  Agile Principles, Patterns and Practices in C# by Robert C. Martin. This book is just awesome at explaining great principles of OOP.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T00:59:08.070

我会创建一个名为的接口`IAnimal`，它具有属性`name`，`id`并且上面的所有 3 个类都实现了这个接口。注意与您在此处所拥有的略有不同，因为您在此处所拥有的是公共变量，而不是公共属性。如果你想维护变量，那么我会使用一个`Animal`带有公共变量的基类`name`，`id`并转换`horseId`为一个属性，它可以`id`像这样获取和设置基本属性`public int horseId { get { return base.id; } set { base.id = value; } }`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-18T01:00:36.830

我会做这样的事情 - 一个抽象基类。

```
public abstract class Animal {
   public string name;
   public int id;
   protected Animal() {}
   protected Animal(DataRow dr) {
      name = (string)dr["Name"];
      id = (int)dr["Id"];
   }
}

public class Cat : Animal {
   public Cat() : base() {}
   public Cat(DataRow dr) : base(dr) {}
} 
```

然后只需向 Horse 添加一个属性（仍然离开`id`）

```
public class Horse : Animal {
   public int horseid { get { return id; } set { id = value; } }
   public Horse() : base() {}
   public Horse(DataRow dr) : base(dr) {}
} 
```

此方法不允许您`id`在`Horse`类中删除/隐藏，因此您将同时拥有`id`and `horseid`，但它们将在下面使用相同的变量。

# php - PHP 更新大型数据库

> ID：13924739
> 
> 赞同：1
> 
> 时间：2012-12-18T00:54:01.110
> 
> 标签：php, database, pdo

我有一个大型数据库（这个特定表中有 28k 个条目），我需要在表中每一列的前面和后面附加一些 HTML 标记。

这是我的代码：

```
try
{
    $conn = new PDO("mysql:host=$host;dbname=$dbname", $username, $password);
    if(!$conn)
    {
        echo "Error in connecting to the database.";
    }
    $conn->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_WARNING );  

    $query = $conn->query("SELECT `id`, `introtext` FROM *TABLE* WHERE id >= 41155");
    $query->setFetchMode(PDO::FETCH_OBJ);

    //For each row in the table
    while($row = $query->fetch())
    {
        $introtext = '<span class="*SPAN CLASS*">' . $row->introtext . '</span>';
        $update_query = $conn->prepare("UPDATE *TABLE* SET introtext = ? WHERE id = ?");

        if ($query->execute(array($introtext, $row->id))) 
            echo $row->id . " Done <br>";
        else 
            echo $row->id . " Err<br>";
    }

} catch(PDOexception $e) {
    echo $e->getMessage();
}

$conn = null; 
```

当我运行脚本时，它输出`41155 Done`4132 次。我不确定这里的逻辑，但感谢任何帮助使其正常工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T01:04:56.997

我同意 Dagon 的观点，即数据库不是那个地方（如果明天你决定`<span>`应该包装另一个 HTML 标签怎么办？）。

无论如何，这听起来像是一次性操作，所以我不会使用 PHP。只需运行 MySQL 客户端（命令行 `mysql`或 Workbench，并使用如下查询：

```
UPDATE *TABLE* 
SET introtext = CONCAT('<span class="*SPAN CLASS*">', introtext, '</span>') 
WHERE id >= 41155 
```

关于您当前代码的一个注释：您永远不会执行`UPDATE`查询！您只是`prepare`语句，然后`$update_query`您不再执行，而是`$query`再次执行！这就是为什么您总是打印相同的 id。

# codeigniter - 如何通过 Knockout postJson 函数调用避免“不允许您请求的操作”错误

> ID：13924740
> 
> 赞同：1
> 
> 时间：2012-12-18T00:54:17.727
> 
> 标签：codeigniter, post, knockout.js, csrf-protection, codeigniter-form-helper

CodeIgniter 给出错误“不允许您请求的操作”。当它未能通过 CSRF 检查时。据我了解，这意味着 POST 缺少表单中的隐藏令牌，证明没有进行攻击。

令牌是通过调用 CI form_open 函数自动生成的。

就我而言，我使用 Knockout 发布 ViewModel 的内容以进行保存，如下所示：

```
ko.utils.postJson($("form")[0], self.pages); 
```

我在其他地方找到了简单地关闭特定页面的 CSRF 设置的解决方案，但这似乎不是一个好的解决方案。

大概是因为没有收到令牌，所以 postJson 调用没有提交现有的表单。有没有办法将所需的令牌与 JSON 数据一起提交，或者将 JSON 数据与现有表单一起提交？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-25T19:05:38.407

尝试使用`form_open()`和`form_close`

所有有帮助的表单辅助函数。

或者：我认为这是来自时区差异，因为`Security`课程取决于散列时间。

# c - 如何遍历一个数组（提示）并在继续循环之前一次回答每个提示？

> ID：13924741
> 
> 赞同：-1
> 
> 时间：2012-12-18T00:54:24.060
> 
> 标签：c, loops, logic

您好，我显然是 C 的新手，但我正在寻找有关我想做的事情背后的逻辑的帮助或建议。也就是说，我将提出一系列问题，并且我想遍历它并一次打印出一个问题。问题是，在打印出一个问题后，程序或函数会等待，直到它被回答为“Y”或“N”，然后循环继续。回答完所有问题后，打印结果并结束程序。

我只需要一些关于这种事情背后的逻辑的建议。也许在这种情况下使用循环是不可行的，我需要尝试一些不同的东西，感谢任何建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T03:16:18.040

好吧，这是众多可能的选项之一（您要求使用 C，所以，这里有一些 C 代码；在 C++ 中，这可能完全不同）：

1.  您需要定义一个结构来保存您的问题，可能是这样的：

    ```
    #define QUESTION_SZ 128 /* adjust to your needs, or use dynamic memory allocation */
    #define ANSWER_SZ 128 /* ditto */
    struct question
    {
        char question_text[QUESTION_SZ]; 
        char answer[ANSWER_SZ];
    }; 
    ```

2.  然后，您可以创建一系列问题并对其进行初始化：

    ```
    struct question my_poll[32]; 
    ```

3.  接下来，您可以遍历您的一系列问题并处理它们：

    ```
    int i = 0;
    char *p = NULL;
    int oops_we_failed = 0;
    for(i = 0; i < 32; i++)
    {
        printf("Question %d: %s. Your answer?\n", i, my_poll[i].question);

        /* fgets() will block until user enters an answer */
        p = fgets(my_poll[i].answer, ANSWER_SZ, stdin);

        if(NULL == p)
        {
            /* nothing was read, an error could have happened */
            oops_we_failed = 1;
            break;
        }
        else
        {
            /* now we have a possible answer stored in poll[i].answer */
        }
    } 
    ```

4.  现在您有一系列问题和相应的答案。

您可能需要研究链表以动态创建任意长度的轮询。

# python - Python初学者级别的Cesar Cipher

> ID：13924743
> 
> 赞同：0
> 
> 时间：2012-12-18T00:54:34.673
> 
> 标签：python, python-2.7

```
''' Cesar Cipher '''
def encrypt(word, shift):

    word = word.lower()

    for i in word:
        r = chr(ord(i)+shift)
        if r > "z":
            r = chr(ord(i) - 26 + shift)
        word = word.replace(i, r)

    return word

if __name__ == "__main__": print encrypt("programming", 3) 
```

这在高于 1 的班次和超过 2 的单词上给了我错误的答案。我不知道为什么。请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T01:36:10.140

Thilo 准确地解释了这个问题。让我们一步一步来：

```
''' Cesar Cipher '''
def encrypt(word, shift):

    word = word.lower()

    for i in word:
        r = chr(ord(i)+shift)
        if r > "z":
            r = chr(ord(i) - 26 + shift)
        word = word.replace(i, r)

    return word 
```

试试看`encrypt('abc', 1)`会发生什么：

```
First loop:
    i = 'a'
    r = chr(ord('a')+1) = 'b'
    word = 'abc'.replace('a', 'b') = 'bbc'
Second loop:
    i = 'b'
    r = chr(ord('b')+1) = 'c'
    word = 'bbc'.replace('b', 'c') = 'ccc'
Third loop:
    i = 'c'
    r = chr(ord('c')+1) = 'd'
    word = 'ccc'.replace('c', 'd') = 'ddd' 
```

您不想替换with的*每个*实例，只是这个。你会怎么做？好吧，如果您跟踪索引，则可以在该索引处进行替换。内置函数可让您同时获取每个索引和每个对应值。`i``r``enumerate`

```
for index, ch in enumerate(word):
    r = chr(ord(ch)+shift)
    if r > "z":
        r = chr(ord(ch) - 26 + shift)
    word = new_word_replacing_one_char(index, r) 
```

现在你只需要编写那个`new_word_replacing_one_char`函数，如果你知道切片，这很容易。（如果你还没有学过切片，你可能想把字符串转换成一个`list`字符，所以你可以说`word[index] = r`，然后在最后再转换回一个字符串。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T00:58:50.393

我不知道 Python 喜欢在您迭代单词时如何替换单词中的字符，但似乎肯定会出现问题的一件事是重复的字母，因为`replace`它将替换*所有*出现的字母，而不仅仅是您的那个目前正在查看，因此您最终会多次移动这些重复的字母（当您在以后的迭代中再次点击它们时）。

想一想，不重复的字母也会发生这种情况。例如，在您的三个迭代中，将 ABC 移动 1 将变为 -> BBC -> CCC -> DDD。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T01:48:31.963

在 Python 中，字符串是不可变的——也就是说它们不能被改变。但是，列表可以。因此，要使用您的算法，请改用列表：

```
''' Cesar Cipher '''
def encrypt(word, shift):

    word = word.lower()
    # Convert the word to a list
    word = list(word)

    # Iterate over the word by index
    for i in xrange(len(word)):
        # Get the character at i
        c = word[i]
        # Apply shift algorithm
        r = chr(ord(c)+shift)
        if r > "z":
            r = chr(ord(c) - 26 + shift)
        # Replace the character at i
        word[i] = r

    # Convert the list back to a string
    return ''.join(word)

if __name__ == "__main__": print encrypt("programming", 3) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-18T01:11:26.913

我也有这个任务。提示是您必须跟踪值的包装位置，并将其用于您的优势。我还建议使用`upper`函数调用，这样一切都是一样的，减少了检查的次数。

# android - Android 谷歌地图错误 (nControl = mapView.getController();)

> ID：13924746
> 
> 赞同：1
> 
> 时间：2012-12-18T00:54:58.307
> 
> 标签：android

我已经加载
了 Google API 16 使用 Google API 16 进行编译

此行的错误是“mapView 无法解析”

```
 <nControl = mapView.getController();> 
```

已删除 gen 文件夹，清理干净
已重新启动 Eclipse
任何帮助将不胜感激，因为我是新手并试图为非营利组织制作地图

**Activity_main.xml**

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".MainActivity" >

<com.google.android.maps.MapView
android:id="@+id/mapView"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:apiKey="AIzaSyC1r4MzsV6jc2J-g335UlIN8WYS6D3hJks"
/> 
```

**GoogleMaps3.manifest**

```
<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="16" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name="net.example.googlemaps3.MainActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
     <user-library android:name="com.google.android.maps" />
</application> 
```

**MainActivity.java**

```
 package net.example.googlemaps3;

import android.app.Activity;
import android.os.Bundle;
import android.view.Menu;

import com.google.android.maps.GeoPoint;
import com.google.android.maps.MapController;
import com.google.android.maps.MapView;

public class MainActivity extends Activity {
MapController nControl;
GeoPoint GeoP;
MapView mapV;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
     mapV = (MapView) findViewById(R.id.mapView);
     mapV.displayZoomControls(true);
        mapV.setBuiltInZoomControls(true);

        double lat=44.3;
        double Longi=-79.8;
        GeoP= new GeoPoint((int)(lat*1E6),(int)(Longi*1E6));            
        nControl = mapView.getController();
        nControl.animateTo(GeoP);
        nControl.setZoom(12);   
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T00:59:12.733

由于您的变量 is`mapV`和 not `mapView`，您应该继续沿着该路径并重写

```
nControl = mapView.getController(); 
```

作为

```
nControl = mapV.getController(); 
```

# iphone - MPMoviePlayerController 自动旋转？

> ID：13924747
> 
> 赞同：1
> 
> 时间：2012-12-18T00:55:31.023
> 
> 标签：iphone, objective-c, orientation, mpmovieplayercontroller

我`MPMoviePlayerController`在我的应用程序中使用。我没有将它作为视图控制器呈现，而是将其添加`view`到我自己的视图控制器中。视频播放得很好，我可以全屏播放。

但是，因为总的来说，当我在观看视频时全屏显示时，我的应用程序仅支持纵向，所以我无法旋转。

那么，我怎样才能让它在我`MPMoviePlayerController`进入全屏时自动旋转（支持横向和纵向），但在全屏模式之外时，保持纵向模式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T02:47:06.290

> 因为总的来说我的应用程序只支持纵向

但那里有你的答案。在 iOS 6 上，无论您的应用程序作为一个整体做什么（如 Info.plist 设置中给出的）就是您的应用程序可以做什么的全部。如果您的应用程序作为一个整体不支持横向，那么您的应用程序中的任何视图控制器都不能支持横向。

假设该应用程序支持所有方向。然后每个*不*`supportedInterfaceOrientations`支持所有方向的视图控制器都可以在其实现中说“不，我只支持纵向” 。

但是这个控制器不会这么说，所以它会旋转。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-18T02:37:10.653

您是否尝试过扩展 MPMoviePlayerViewController 的类？所以你的类可以响应 shouldAutorotateToInterfaceOrientation 的方法。

# objective-c - 在现有的 XIB 项目中添加情节提要

> ID：13924748
> 
> 赞同：0
> 
> 时间：2012-12-18T00:55:41.100
> 
> 标签：objective-c, ios, xcode

我在我的项目中只使用 xib 文件。现在我需要一个静态表视图来设置视图。我想结合 xib 和一个故事板（用于表格视图）。

我在我的项目中添加了一个带有一个视图控制器的故事板。之后，我为此视图控制器添加了一个标识符（SettingsView）。按下按钮时执行以下代码：

```
SettingsView *CustomViewController = [[UIStoryboard storyboardWithName:@"Storyboard" bundle:[NSBundle mainBundle]] instantiateViewControllerWithIdentifier:@"SettingsView"];
[self presentModalViewController:CustomViewController animated:YES]; 
```

当我按下设置按钮时，我的应用程序崩溃了：

> ***由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“Storyboard () 不包含标识符为“SettingsView”的视图控制器”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T02:19:45.673

请确保您在所附图片中添加了 StoryBoard ID，如下所示。

![在此处输入图像描述](../Images/710bf033d9afb954c0748026f620a040.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T01:35:52.173

您尝试实例化的情节提要和单个视图控制器的名称完全匹配。否则，从我所见，你正在做的其他事情是正确的。

# php - 基本 PHP / MVC 变量问题

> ID：13924749
> 
> 赞同：0
> 
> 时间：2012-12-18T00:55:50.050
> 
> 标签：php, flourishlib

这里非常初学者，请放轻松:)

在我们的数据库中，我们有一个`tinyint`字段`secondary_phone_number`，要么是要么`0`值`1`。我们使用`flourish MVC`.

0 = 假，1 = 真。

我正在尝试`secondary_phone_number`使用以下代码显示一个复选框，指示是否为真：

```
if ($company->setSecondaryPhoneNumber(fRequest::get("secondary_phone_number")) == TRUE) 
{
      $company->setSecondaryPhoneNumber == TRUE;
} else {
      $company->setSecondaryPhoneNumber == FALSE;
} 
```

然后，显示它：

```
$data['secondaryphonenumber'] = $company->getSecondaryPhoneNumber(); 
```

最后，在 .tpl 中渲染它：

```
<h5>Enable Secondary phone numbers?</h5>
<label>
    <input type="checkbox" name="secondary_phone_number" value="0" {{^secondaryphonenumber}}checked="checked"{{/secondaryphonenumber}}/>
    Yes
</label><br> 
```

问题是，它总是显示为 Checked....即使数据库中的值为 0...对这个新手有什么帮助？？？！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T01:45:55.627

正如罗斯在他的评论中指出的那样，您的错误在于您的分配（您使用条件`==`而不是分配`=`）：

```
if ($company->setSecondaryPhoneNumber(fRequest::get("secondary_phone_number")) == TRUE) 
{
      $company->setSecondaryPhoneNumber = TRUE;
} else {
      $company->setSecondaryPhoneNumber = FALSE;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T01:55:28.760

这是一个 HTML 问题。`checked="checked"` 当您包含我自己尝试过的复选框时，该复选框将始终显示为选中状态。如果没有该行，复选框应该仍然可以正常工作。我不确定你的框架是什么，所以我不确定你将如何从你的数据库动态地为这个框分配值，但应该可以通过在 value 属性中回显一条语句来分配一个值您的检查输入标签。

如果您想了解更多详细信息，请查看此链接：http: [//www.w3schools.com/jsref/dom_obj_checkbox.asp](http://www.w3schools.com/jsref/dom_obj_checkbox.asp)

# java - 从 WatchEvent 确定已删除文件的类型

> ID：13924754
> 
> 赞同：5
> 
> 时间：2012-12-18T00:56:22.510
> 
> 标签：java, io, nio, watchservice

我有一个监视, AND事件`WatchService`的目录树。问题是 a 的上下文只给出了一个 Path 对象。在删除事件中，我不确定路径是否引用了常规文件的目录。`ENTRY_CREATE``ENTRY_DELETE``ENTRY-MODIFY``WatchEvent<?>`

```
WatchKey key = null;

try {
    key = watcher.take();
} catch (InterruptedException e) {
    e.printStackTrace();
}

for (WatchEvent<?> event : key.pollEvents()) {
    if (event.kind() == StandardWatchEventKinds.OVERFLOW) {
        continue;
    }

    Path parent = (Path) key.watchable();
    Path p = parent.resolve((Path) event.context());

    for (DirectoryModifiedListener listener : listeners) {
        if (event.kind() == StandardWatchEventKinds.ENTRY_DELETE) {
            // only do this if p referred to a file, not a directory
            listener.onFileCreated(p);
        }
    }
} 
```

我的问题是如何确定路径是否`p`引用了已删除的文件或目录？API公开的内容甚至可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-06T00:02:35.897

Files.isDirectory(path) 顾名思义是实时检查。

Path 对象（分别是实现 WindowsPath）本身没有状态（或缓存的历史记录）。它只不过是路径的占位符。

因此，可悲的答案是：您无法确定 Path 在删除后是否引用了目录。

一种解决方案是记住 Path 对象的种类，只要它们存在。这意味着在开始观看之前收集一份清单：

```
Path parent = Paths.get("/my/hotfolder");

Set<String> subdirs = new HashSet<String>();

for (Path p : Files.newDirectoryStream(parent)) {
    if (Files.isDirectory(p))
        subdirs.add(p.getFileName().toString());
} 
```

注册 ENTRY_CREATE 以使列表保持最新

```
WatchKey key = hotfolder.register(watcher, ENTRY_CREATE, ENTRY_DELETE); 
```

现在您可以确定子对象是否是目录：

```
for (WatchEvent<?> event : key.pollEvents())
{
    if (event.kind() == StandardWatchEventKinds.OVERFLOW)
        continue;

    Path p = ((Path) key.watchable()).resolve((Path) event.context());

    String filename = p.getFileName().toString();

    if (event.kind() == StandardWatchEventKinds.ENTRY_CREATE && Files.isDirectory(p))
        subdirs.add(filename);

    if (event.kind() == StandardWatchEventKinds.ENTRY_DELETE)
    {
        if (subdirs.contains(filename))
        {
            for (DirectoryModifiedListener listener : listeners)
                listener.onFileDeleted(p);

            subdirs.remove(filename);
        }
    }
} 
```

# excel-2010 - Excel 2010，如何使用键盘快捷键过滤下拉复选框？

> ID：13924755
> 
> 赞同：10
> 
> 时间：2012-12-18T00:56:31.810
> 
> 标签：excel-2010

对于 Excel 2010，当我打开过滤器下拉菜单时

![Excel 截图](../Images/619a85d69968be0544431068eb6a002d.png)

...如何通过键盘快捷键进入过滤器复选框部分？跳过从“从 A 到 Z 排序”到“搜索”框的所有内容，一直到复选框。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-06T09:23:05.180

## 最快的选择：`e` ` ↓&nbsp; `

在 Excel 2010（英文）中，您只需按下`e`即可进入过滤器文本框；从那里您可以使用向下箭头键` ↓&nbsp; `转到第一个复选框：

![按压效果截图](../Images/8cc6df03f2470ae4511a5c7db0360d12.png)

## 替代选项

`Shift`+`Tab`

`Shift`+`Tab`

`Shift`+`Tab`

（正如@Sean_Cheshire 所提到的） - 这从“取消”和“确定”的第一个条目“向后”到第一个（原文如此！）复选框。

## 相关问题：如何*打开*过滤器下拉菜单

上面的问题是关于如何*在*过滤器下拉列表中移动。要*打开*过滤器下拉菜单，您有一个或两个选项：

*   **对于任何过滤器**`Alt`：正如@Juhi 和@Josh 所指出的，当通过键入+选择列标题单元格（您可以单击以打开下拉列表）时，您可以使用键盘打开所述菜单` ↓&nbsp; `。

*   **对于表格**：如果您使用[表格对象](http://office.microsoft.com/en-us/excel-help/quick-start-create-an-excel-table-HA010359200.aspx)`Alt`而不是数据透视表或常规过滤范围，您可以在表格的任何行中并使用+ `Shift`+打开过滤器下拉菜单` ↓&nbsp; `

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-02-11T15:01:52.593

ALT+DOWN 箭头键打开选择框。使用箭头键选择一个选项，使用空格键“选中”或“取消选中”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-26T13:39:03.517

尝试 ALT+向下。它还会在过滤器和单元格中打开下拉列表。

# c# - 在数据表中选择多个行和列，其中值出现多次

> ID：13924757
> 
> 赞同：0
> 
> 时间：2012-12-18T00:56:54.827
> 
> 标签：c#, linq, datatable

我有一张如下图所示的表格：

![在此处输入图像描述](../Images/9647b777860538b9d9dc90868654266e.png)

我正在尝试返回一个结果，该结果将返回产品代码相同的所有行（和列）

我以前没有真正使用过 linq 并且玩过一些 group by 子句，但是除了返回每个单独的部分代码之外，我还没有真正得到任何地方

```
var GetProductsRows = from DataRow dr in table.Rows
    group dr by dr.Field<string>("Product Code") into g
    select g; 
```

不知何故，我觉得我的水有点超出了我的深度

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T01:45:54.373

嵌套的 linq 查询应该可以解决问题：

```
var GetProductsRows = from DataRow dr in table.Rows
    group dr by dr.Field<string>("Product Code") into gp
    from rows in gp where gp.Count() > 1 select rows; 
```

基本上，这将选择属于计数大于一的组的所有行。

# java - 使用while循环时间java

> ID：13924761
> 
> 赞同：0
> 
> 时间：2012-12-18T00:57:28.883
> 
> 标签：java, loops, while-loop

我想在每次设置提前分钟时获取时间值，如果分钟为六十，则必须自动添加一小时，然后分钟为零。这是我在课堂上的代码。

```
public class time {
  private int hours;
  private int minutes;
  private String amPm;

  public time() {
  }

  public time(int hours, int minutes, String amPm) {
    this.hours = hours;
    this.minutes = minutes;
    this.amPm = amPm;
  }

  public void advance(int aminutes){
    if(minutes > 0){
      minutes = minutes + aminutes;
      while(hours < 0){

      }
    }
  }

  @Override
  public String toString() {
    String time = hours + " " + minutes + " " + amPm + ".";
    return time;
  }
} 
```

我的代码中缺少什么，因为它显示错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T01:15:35.003

它相对简单。

添加`advance`到`minutes`，如果`minutes`大于 59，除以`minutes`60，这将给出已开始添加的小时数。接下来你修改`minutes`60 以获得剩余分钟数......

```
public void advance(int aminutes) {
    minutes = minutes + aminutes;
    if (minutes > 59) {
        int moreHours = Math.round(minutes / 60);
        minutes = minutes % 60;
        hours += moreHours;
    }
} 
```

现在，问题是。为什么不只使用 a`Calendar`代替？

```
public class Time {

    public static void main(String[] args) {
        Time time = new Time();
        time.advance(90);

        System.out.println(time);
    }

    private Calendar cal;

    public Time() {
        cal = Calendar.getInstance();
        cal.set(Calendar.HOUR_OF_DAY, 0);
        cal.set(Calendar.MINUTE, 0);
    }

    public Time(int hours, int minutes) {
        this();
        cal.set(Calendar.HOUR, hours);
        cal.set(Calendar.MINUTE, minutes);
    }

    public void advance(int aminutes) {
        cal.add(Calendar.MINUTE, aminutes);
    }

    @Override
    public String toString() {
        String time = cal.get(Calendar.HOUR_OF_DAY) + " " + cal.get(Calendar.MINUTE);
        return time;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T04:39:03.850

@MadProgrammer 非常正确使用**java.util.Calendar**类。这个类比 Date 更聪明。

下面是示例代码：

```
Calendar cal = Calendar.getInstance();

System.out.println(cal.get(Calendar.HOUR)+" :: "+cal.get(Calendar.MINUTE));

cal.add(Calendar.MINUTE, 80);

System.out.println(cal.get(Calendar.HOUR)+" :: "+cal.get(Calendar.MINUTE)); 
```

如果分钟增加超过 60，它将自动添加到小时字段。

# matlab - Matlab：将char的单元格转换为双打向量的单元格

> ID：13924762
> 
> 赞同：7
> 
> 时间：2012-12-18T00:57:32.160
> 
> 标签：matlab

我想转换 <1 x 8 cell> 的字符

```
'111001'    '00'    '111000'    '01'    '1111'  '10'    '11101' '110' 
```

到 <1 x (length bitcode)> 的 <1 x 8 cell> 双打

```
[111001]    [00]    [111000]    [01]    [1111]  [10]    [11101] [110] 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-18T05:09:33.730

这是一个单线解决方案：

```
 a=num2cell(str2double(s)) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-18T03:09:58.060

```
s = {'111001', '00', '111000', '01', '1111', '10', '11101', '110'};
d = cellfun(@(c_) c_ - '0', s, 'UniformOutput', false); 
```

`'01234' - '0'`将给出 1 x 5 双矩阵`[0, 1, 2, 3, 4]`，因为`'01234'`实际上是`char(['0', '1', '2', '3', '4'])`，字符之间的减号运算将给出它们的 ASCII 码之间的运算。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-18T04:15:44.350

试试这个：

```
 s = {'111001','00','111000','01','1111','10','11101','110'}
    num = str2num(str2mat(s)); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-18T03:03:14.810

尝试使用`str2num`将 char 数组（字符串）转换为数字。

如果要将数字解释为二进制（以 2 为底）数字，请尝试使用`bin2dec`.

# css - 分区错误。只是漂浮在不应该的地方

> ID：13924767
> 
> 赞同：-1
> 
> 时间：2012-12-18T00:58:09.353
> 
> 标签：css, html

好的，所以昨天我发布了我遇到的网格错误，但是现在当我尝试在网格方块之后放置一个 div 时。他们的CSS是：

但是在这里查看所有代码：http: [//jsfiddle.net/W2tBa/1/](http://jsfiddle.net/W2tBa/1/)

我希望页脚像页眉一样扩展，但顶部也有 3px 的缓冲。jsfiddle 也显示正确，所以我不确定发生了什么。

出于某种原因，jsfiddle 正在工作，但在我的计算机上却没有。我在我的 MacBook 上运行 XAMPP。我会尽快尝试，看看我的网站上会发生什么。在我的网站上看到它是一样的：http: [//harrisonbh.com/new/](http://harrisonbh.com/new/)它仍然不起作用。

```
//Ignore this StackOverflow is making me put this here 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T01:14:31.470

`clear: both`在div 上使用可以`footer`修复它。

# mysql - SQL查询，从table1 order by table2 rows select

> ID：13924775
> 
> 赞同：1
> 
> 时间：2012-12-18T00:58:58.163
> 
> 标签：mysql, sql, database

我正在尝试从表格中选择朋友列表，这很好。但是现在我试图通过另一个表来排序结果，这是用户在线状态/最近的在线活动。

我尝试使用的查询是（错误是：'where 子句'中的未知列'friendID'）：

```
SELECT
    CASE WHEN f.userID=$session 
    THEN f.userID2 ELSE f.userID 
    END AS friendID
FROM friends f, usersStatus u
WHERE 
    (
           f.userID=$session OR f.userID2=$session
    ) 
    AND friendID=u.userID
    AND f.state='1' 
ORDER BY u.periodicDate DESC, u.setStatus ASC
LIMIT 5 
```

现在只返回用户朋友的查询是这样的：

```
SELECT
    CASE WHEN f.userID=$session 
    THEN f.userID2 ELSE f.userID 
    END AS friendID
FROM friends f
WHERE 
    (
           f.userID=$session OR f.userID2=$session
    ) 
    AND f.state='1' 
LIMIT 5 
```

应该匹配 usersStatus.userID，然后`friendID`我想以上面示例中的方式对它们进行排序。我还想补充一点，如果`friendID`不是 IN usersStatus 表，它应该在最后自动对这些行进行排序。

`u.periodicDate`只是用户设置的最近日期，所以这将指示用户上次活动的时间，所以我希望最近活动的用户排在第一位。 `u.setStatus`设置取决于我的脚本确定他是什么，所以它可以是`1`, `2`, 或`3`. `1`存在`Online`、`2`存在`Away`和`3`存在`Offline`。

所以就像我上面说的，应该自动给这个表中还没有一行的用户一个`offline`状态。

**编辑**

我有一个查询可以按我的意愿工作，但是它非常混乱，必须极大地浪费它的资源，因为我必须按朋友 ID 分组才能让它只返回一次用户。（因为我的朋友数据库保留每一行，所以如果一个人取消了某人的朋友，如果他们返回朋友等，它只会创建一个新行。）

```
SELECT * FROM usersStatus,

(SELECT
    CASE WHEN friends.userID=$session 
    THEN friends.userID2 ELSE friends.userID 
    END AS friendID
FROM friends, usersStatus
WHERE 
(
     friends.userID=$session OR friends.userID2=$session
)

AND friends.state='1'
) t
WHERE t.friendID=usersStatus.userID 
GROUP BY t.friendID 
ORDER BY usersStatus.periodicDate ASC, usersStatus.setStatus ASC 
LIMIT 5 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T03:34:42.557

而不是写

```
AND friendID=u.userID 
```

使用别名的实际值：

```
AND CASE WHEN f.userID=$session 
    THEN f.userID2 ELSE f.userID 
    END = u.userID 
```

# python - 错误超过 1 个要解压的值

> ID：13924778
> 
> 赞同：1
> 
> 时间：2012-12-18T00:59:18.917
> 
> 标签：python

我什至不确定这个错误到底是什么问题。任何信息都会非常有帮助。

到目前为止我所拥有的：

```
def equations(specie,elements):
vectors=[]
for x in specie: 
    vector=extracting_columns(x,elements)
    vectors.append(vector) 
```

当我运行时：

```
 equations(['OH', 'CO2','c3o3','H2O3','CO','C3H1'], 
 ['H', 'C', 'O']) 
```

我收到以下错误：

```
 Traceback (most recent call last):
File "<stdin>", line 1, in <module> 
```

文件“_sage_input_77.py”，第 10 行，在 exec compile(u'print *support* .syseval(python, u"equations([\'OH\', \'CO2\',\'c3o3\',\'H2O3\ ',\'CO\',\'C3H1\'], unel)", **SAGE_TMP_DIR** ) 文件“”，第 1 行，在

syseval 中的文件“/sagenb/sage_install/sage-5.4-sage.math.washington.edu-x86_64-Linux/devel/sageb-git/sageb/misc/support.py”，第 479 行，返回 system.eval(cmd, sage_globals, locals = sage_globals) 文件“/sageb/sage_install/sage-5.4-sage.math.washington.edu-x86_64-Linux/local/lib/python2.7/site-packages/sage/misc/python.py”,第 56 行，在 eval eval(z, globals) 文件 ""，第 1 行，在

文件“”，第 4 行，在方程式中

文件“”，第 3 行，在 extracting_columns

ValueError：需要超过 1 个值才能解压

如果需要，我以前的函数： import re def parse_formula(formula): '''给定一个简单的化学公式，返回一个（元素，多重性）元组列表。

```
Example:
'H2SO4' --> [('H', 2.0), ('S', 1.0), ('O', 4.0)]

'''

return [ (elem, float(mul) if mul else 1.) for (elem, mul) in re.findall(r'([A-Z][a-z]*)(\d*)', formula) ] 
```

def unique_element(group): c=[] for element in group: piece=parse_formula(element) for x in piece: c.append(x[0])

```
return list(set(c)) 
```

def extracting_columns(specie, elements): species_vector=zeros(len(elements)) for (el,mul) in specie: species_vector[elements.index(el)]=mul

```
return species_vector 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T01:14:15.853

问题是您使用`extracting_columns`像第一个参数这样的字符串`'OH'`进行调用，因此当您尝试这样做时，`for (el,mul) in specie:`它会尝试`'O'`将`(el, mul)`.

一个简单的调试方法是在有问题`print`的行之前插入一个权利：

```
def extracting_columns(specie, elements):
  species_vector=zeros(len(elements))
  print(specie)
  for (el,mul) in specie:
    species_vector[elements.index(el)]=mul
  return species_vector 
```

那么，如何`extracting_columns`获取`'OH'`？好吧，让我们看看它在哪里被调用，还有几个`print`s：

```
def equations(specie,elements):
  vectors=[]
  print(specie)
  for x in specie:
    print(x)
    vector=extracting_columns(x,elements)
    vectors.append(vector) 
```

现在，当你运行它时，你会看到`specie`是`['OH', 'CO2', 'c3o3', 'H2O3', 'CO', 'C3H1']`，所以它的第一个元素显然是`'OH'`。

至于如何解决这个问题……好吧，在不知道你实际上想要做什么的情况下，很难告诉你如何去做。但很明显，如果您想遍历第一个参数`extracting_columns`并将每个项目视为一对，则必须将其传递给一对序列而不是字符串。

但看起来你`parse_formula`是专门为将字符串 like`'OH'`转换为 like 对列表而设计的`[('O', 1.0), ('H', 1.0)]`。所以大概问题在于你只是忘记在某个地方调用它。也许你想`equations`看起来像这样？

```
def equations(specie, elements):
  vectors=[]
  for x in specie:
    formula = parse_formula(x)
    vector=extracting_columns(formula, elements)
    vectors.append(vector) 
```

这会做一些事情，没有任何例外。是不是你真正想要的，我不知道。

无论如何，学习如何查看代码中实际发生的情况并调试琐碎的问题可能比立即在这里获得正确答案更重要。

# mysql - 与 MySQL 重叠的时间间隔

> ID：13924779
> 
> 赞同：-2
> 
> 时间：2012-12-18T00:59:21.897
> 
> 标签：mysql, intervals, date-range

我正在尝试创建**具有多个资源的预订系统**：Calendar#1 和 Calendar#2。日历本身不包含重叠范围。一个日历中的范围可以跨越另一个日历中的多个范围。

请参阅下面或[sqlfiddle上的架构和数据](http://www.sqlfiddle.com/#!2/444be/2)

```
 Events on Calendar #1
        ID  startDate               endDate
        -----------------------------------------------
        1   2012-01-01 02:00:00     2012-01-01 03:00:00
        2   2012-01-01 05:00:00     2012-01-01 07:00:00
        3   2012-01-01 09:00:00     2012-01-01 11:00:00
        4   2012-01-01 16:00:00     2012-01-01 18:00:00
        5   2012-01-01 19:00:00     2012-01-01 22:00:00

        6   2012-02-02 10:00:00     2012-02-02 20:00:00

        7   2012-03-03 05:00:00     2012-03-03 07:00:00
        8   2012-03-03 09:00:00     2012-03-03 11:00:00
        9   2012-03-03 12:00:00     2012-03-03 14:00:00
        10  2012-03-03 15:00:00     2012-03-03 17:00:00
        11  2012-03-03 19:00:00     2012-03-03 21:00:00
        12  2012-03-03 22:00:00     2012-03-03 23:00:00

    Events on Calendar #2
        ID  startDate               endDate
        -----------------------------------------------
        1   2012-01-01 01:00:00     2012-01-01 04:00:00
        2   2012-01-01 06:00:00     2012-01-01 08:00:00
        3   2012-01-01 12:00:00     2012-01-01 14:00:00
        4   2012-01-01 15:00:00     2012-01-01 17:00:00
        5   2012-01-01 20:00:00     2012-01-01 21:00:00

        6   2012-02-02 05:00:00     2012-02-02 07:00:00
        7   2012-02-02 09:00:00     2012-02-02 11:00:00
        8   2012-02-02 12:00:00     2012-02-02 14:00:00
        9   2012-02-02 15:00:00     2012-02-02 17:00:00
        10  2012-02-02 19:00:00     2012-02-02 21:00:00
        11  2012-02-02 22:00:00     2012-02-02 23:00:00

        12  2012-03-03 10:00:00     2012-03-03 20:00:00

2012-01-01:
            0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5  6  7  8  9  0  1  2  3 
    Cal#1         |--|     |-----|     |-----|              |-----|  |--------|
    Cal#2      |--------|     |-----|           |-----|  |-----|        |--|

2012-02-02:
            0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5  6  7  8  9  0  1  2  3 
    Cal#1                                 |-----------------------------|
    Cal#2                  |-----|     |-----|  |-----|  |-----|     |-----|  |--|

2012-03-03:
            0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5  6  7  8  9  0  1  2  3 
    Cal#1                  |-----|     |-----|  |-----|  |-----|     |-----|  |--|
    Cal#2                                 |-----------------------------| 
```

**a）如何在两个日历中**找到间隔：

```
 startDate               endDate
             -----------------------------------------------
             2012-01-01 02:00:00     2012-01-01 03:00:00
             2012-01-01 06:00:00     2012-01-01 07:00:00
             2012-01-01 16:00:00     2012-01-01 17:00:00
             2012-01-01 20:00:00     2012-01-01 21:00:00

             2012-02-02 10:00:00     2012-02-02 11:00:00
             2012-02-02 12:00:00     2012-02-02 14:00:00
             2012-02-02 15:00:00     2012-02-02 17:00:00
             2012-02-02 19:00:00     2012-02-02 20:00:00

             2012-02-03 10:00:00     2012-02-03 11:00:00
             2012-02-03 12:00:00     2012-02-03 14:00:00
             2012-02-03 15:00:00     2012-02-03 17:00:00
             2012-02-03 19:00:00     2012-02-03 20:00:00

            0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5  6  7  8  9  0  1  2  3 
01  Cal#1&2       |--|        |--|                          |--|        |--|
02  Cal#1&2                               |--|  |-----|  |-----|     |--|
03  Cal#1&2                               |--|  |-----|  |-----|     |--| 
```

b）如何获得**在 #1 但不在 #2 中**找到的间隔：

```
 startDate               endDate
             -----------------------------------------------
             2012-01-01 05:00:00     2012-01-01 06:00:00
             2012-01-01 09:00:00     2012-01-01 11:00:00
             2012-01-01 17:00:00     2012-01-01 18:00:00
             2012-01-01 19:00:00     2012-01-01 20:00:00
             2012-01-01 21:00:00     2012-01-01 22:00:00

             2012-02-02 11:00:00     2012-02-02 12:00:00
             2012-02-02 14:00:00     2012-02-02 15:00:00
             2012-02-02 17:00:00     2012-02-02 19:00:00

             2012-03-03 05:00:00     2012-03-03 07:00:00
             2012-03-03 09:00:00     2012-03-03 10:00:00
             2012-03-03 20:00:00     2012-03-03 21:00:00
             2012-03-03 22:00:00     2012-03-03 23:00:00

            0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5  6  7  8  9  0  1  2  3 
01  Cal#1-2                |--|        |-----|                 |--|  |--|  |--|
02  Cal#1-2                                  |--|     |--|     |-----| 
03  Cal#1-2                |-----|     |--|                             |--|  |--| 
```

c）如何在日历/间隔范围内或之外的任何地方获取在 START 和 END 之间的任何**日历中都找不到的间隔。**

```
 startDate               endDate
             -----------------------------------------------
       START:2012-01-01 04:30:00     2012-01-01 05:00:00
             2012-01-01 08:00:00     2012-01-01 09:00:00
             2012-01-01 11:00:00     2012-01-01 12:00:00
             2012-01-01 14:00:00     2012-01-01 15:00:00
             2012-01-01 18:00:00     2012-01-01 19:00:00
             2012-01-01 22:00:00     2012-02-02 05:00:00
             2012-02-02 07:00:00     2012-02-02 09:00:00
             2012-02-02 21:00:00     2012-02-02 22:00:00
             2012-02-02 23:00:00     2012-03-03 05:00:00
             2012-03-03 07:00:00 END:2012-03-03 07:30:00

            0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5  6  7  8  9  0  1  2  3 
01  Cal-1-2              |-|        |--|     |--|     |--|        |--|        |------
02  Cal-1-2 ---------------|     |-----|                                   |--|  |---
03  Cal-1-2 ---------------|     |-END 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T03:26:24.407

1.  > **如何在两个日历中**找到间隔：

    ```
    SELECT GREATEST(Cal1.startDate, Cal2.startDate) AS startDate,
              LEAST(Cal1.endDate  , Cal2.endDate  ) AS   endDate
    FROM   Cal1 JOIN Cal2
        ON Cal2.startDate BETWEEN Cal1.startDate AND Cal1.endDate
        OR Cal1.startDate BETWEEN Cal2.startDate AND Cal2.endDate 
    ```

2.  > 如何获得**在 #1 但不在 #2 中**找到的间隔：

    ```
     SELECT Cal1.startDate, Cal2.startDate AS endDate
      FROM   Cal1 JOIN Cal2
          ON Cal2.startDate BETWEEN Cal1.startDate AND Cal1.endDate
    UNION ALL
      SELECT Cal2.endDate AS startDate, Cal1.endDate
      FROM   Cal1 JOIN Cal2
          ON Cal2.endDate   BETWEEN Cal1.startDate AND Cal1.endDate
    UNION ALL
      SELECT Cal1.startDate, Cal1.endDate
      FROM   Cal1 LEFT JOIN Cal2
          ON Cal2.startDate BETWEEN Cal1.startDate AND Cal1.endDate
          OR Cal1.startDate BETWEEN Cal2.startDate AND Cal2.endDate
      WHERE  Cal2.ID IS NULL
    ORDER BY startDate 
    ```

3.  > 如何在 START 和 END 之间的**任何日历中都找不到间隔：**

    ```
    SELECT   starts.d AS startDate, MIN(ends.d) AS endDate
    FROM (
      SELECT @start AS d
    UNION
      SELECT Cal1.endDate
      FROM   Cal1 LEFT JOIN Cal2
          ON Cal1.endDate BETWEEN Cal2.startDate AND Cal2.endDate
      WHERE  Cal1.endDate BETWEEN @start AND @end
         AND Cal2.ID IS NULL
    UNION
      SELECT Cal2.endDate
      FROM   Cal1 RIGHT JOIN Cal2
          ON Cal2.endDate BETWEEN Cal1.startDate AND Cal1.endDate
      WHERE  Cal2.endDate BETWEEN @start AND @end
         AND Cal1.ID IS NULL
    ) starts JOIN (
      SELECT @end AS d
    UNION
      SELECT Cal1.startDate
      FROM   Cal1 LEFT JOIN Cal2
          ON Cal1.startDate BETWEEN Cal2.startDate AND Cal2.endDate
      WHERE  Cal1.startDate BETWEEN @start AND @end
         AND Cal2.ID IS NULL
    UNION
      SELECT Cal2.startDate
      FROM   Cal1 RIGHT JOIN Cal2
          ON Cal2.startDate BETWEEN Cal1.startDate AND Cal1.endDate
      WHERE  Cal2.startDate BETWEEN @start AND @end
         AND Cal1.ID IS NULL
    ) ends ON starts.d < ends.d
    GROUP BY startDate 
    ```

[在sqlfiddle](http://sqlfiddle.com/#!2/40ec2/1)上查看它们。

# scala - 如何为 Scala 应用程序提供基本配置？

> ID：13924785
> 
> 赞同：8
> 
> 时间：2012-12-18T00:59:36.763
> 
> 标签：scala

我正在开发一个用 Scala 编写的小型 GUI 应用程序。用户将在 GUI 中设置一些设置，我希望它们在程序执行之间保持不变。基本上我想要一个 scala.collections.mutable.Map 在修改时自动保存到文件中。

这似乎一定是一个普遍的问题，但我一直无法找到一个轻量级的解决方案。这个问题通常是如何解决的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-18T02:58:44.140

我做了很多这样的事情，并且我使用 .properties 文件（它在 Java 领域是惯用的）。不过，我在设计上保持我的配置非常简单。如果您有嵌套的配置结构，您可能需要不同的格式，例如 YAML（如果人类是主要作者）或 JSON 或 XML（如果机器是作者）。

下面是一些示例代码，用于加载道具、操作为 Scala Map，然后再次保存为 .properties：

```
import java.io._
import java.util._
import scala.collection.JavaConverters._

val f = new File("test.properties")
// test.properties:
//   foo=bar
//   baz=123

val props = new Properties

// Note: in real code make sure all these streams are 
// closed carefully in try/finally
val fis = new InputStreamReader(new FileInputStream(f), "UTF-8")
props.load(fis)
fis.close()

println(props) // {baz=123, foo=bar}

val map = props.asScala // Get to Scala Map via JavaConverters
map("foo") = "42"
map("quux") = "newvalue"

println(map)   // Map(baz -> 123, quux -> newvalue, foo -> 42)
println(props) // {baz=123, quux=newvalue, foo=42}

val fos = new OutputStreamWriter(new FileOutputStream(f), "UTF-8")
props.store(fos, "")
fos.close() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T11:35:51.247

由于这一切都归结为将映射/对象序列化为文件，因此您的选择是：

*   字节码的经典序列化
*   序列化为 XML
*   序列化为 JSON（使用 Jackson 或 Lift-JSON 很容易）
*   使用属性文件（丑陋，不支持 utf-8）
*   序列化为专有格式（丑陋，为什么要重新发明轮子）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T06:43:12.187

这是一个使用 XML 和案例类来读取配置的示例。真正的班级可能比地图更好。（您也可以做 sbt 和至少一个项目所做的事情，将配置作为 Scala 源并编译进去；保存它的自动化程度较低。或者作为 repl 脚本。我没有用谷歌搜索，但一定有人这样做了。 )

[这是更简单的代码。](https://github.com/scala/scala/blob/master/src/compiler/scala/tools/nsc/plugins/PluginDescription.scala)

此版本使用案例类：

```
case class PluginDescription(name: String, classname: String) {
  def toXML: Node = {
    <plugin>
      <name>{name}</name>
      <classname>{classname}</classname>
    </plugin>
  }
}
object PluginDescription {

  def fromXML(xml: Node): PluginDescription = {
    // extract one field
    def getField(field: String): Option[String] = {
      val text = (xml \\ field).text.trim
      if (text == "") None else Some(text)
    }
    def extracted = {
      val name = "name"
      val claas = "classname"
      val vs = Map(name -> getField(name), claas -> getField(claas))
      if (vs.values exists (_.isEmpty)) fail()
      else PluginDescription(name = vs(name).get, classname = vs(claas).get)
    }
    def fail() = throw new RuntimeException("Bad plugin descriptor.")
    // check the top-level tag
    xml match {
      case <plugin>{_*}</plugin>  => extracted
      case _                      => fail()
    }
  }
} 
```

此代码反射性地调用案例类的应用。用例是配置中缺少的字段可以由默认参数提供。这里没有类型转换。例如，`case class Config(foo: String = "bar")`。

```
// isn't it easier to write a quick loop to reflect the field names?
import scala.reflect.runtime.{currentMirror => cm, universe => ru}
import ru._

def fromXML(xml: Node): Option[PluginDescription] = {
  def extract[A]()(implicit tt: TypeTag[A]): Option[A] = {
    // extract one field
    def getField(field: String): Option[String] = {
      val text = (xml \\ field).text.trim
      if (text == "") None else Some(text)
    } 

    val apply = ru.newTermName("apply")
    val module = ru.typeOf[A].typeSymbol.companionSymbol.asModule
    val ts = module.moduleClass.typeSignature
    val m = (ts member apply).asMethod
    val im = cm reflect (cm reflectModule module).instance
    val mm = im reflectMethod m

    def getDefault(i: Int): Option[Any] = {
      val n = ru.newTermName("apply$default$" + (i+1))
      val m = ts member n
      if (m == NoSymbol) None
      else Some((im reflectMethod m.asMethod)())
    } 
    def extractArgs(pss: List[List[Symbol]]): List[Option[Any]] =
      pss.flatten.zipWithIndex map (p => getField(p._1.name.encoded) orElse getDefault(p._2))
    val args = extractArgs(m.paramss)
    if (args exists (!_.isDefined)) None
    else Some(mm(args.flatten: _*).asInstanceOf[A])
  } 
  // check the top-level tag
  xml match {
    case <plugin>{_*}</plugin>  => extract[PluginDescription]()
    case _                      => None
  } 
} 
```

XML 有`loadFile`，而且`save`，太糟糕了，似乎没有针对`Properties`.

```
$ scala
Welcome to Scala version 2.10.0-RC5 (Java HotSpot(TM) 64-Bit Server VM, Java 1.7.0_06).
Type in expressions to have them evaluated.
Type :help for more information.

scala> import reflect.io._
import reflect.io._

scala> import java.util._
import java.util._

scala> import java.io.{StringReader, File=>JFile}
import java.io.{StringReader, File=>JFile}

scala> import scala.collection.JavaConverters._
import scala.collection.JavaConverters._

scala> val p = new Properties
p: java.util.Properties = {}

scala> p load new StringReader(
     | (new File(new JFile("t.properties"))).slurp)

scala> p.asScala
res2: scala.collection.mutable.Map[String,String] = Map(foo -> bar) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-18T02:20:42.477

I suggest to convert Map to Properties and vice versa. "*.properties" files are standard for storing configuration in Java world, why not use it for Scala?

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-18T02:38:27.337

常见的方式是*。属性，*.xml，因为 scala 本身支持 xml，所以使用 xml 配置比在 java 中更容易。

# macos - 如何在 Mac OS 10.7.5 上安装 ruby 1.9.3？

> ID：13924787
> 
> 赞同：0
> 
> 时间：2012-12-18T01:00:14.143
> 
> 标签：macos, osx-lion, ruby-1.9.3

我已经安装了 XCode 4.5 和命令行工具。然后我安装最新的 RVM。当我尝试安装 ruby​​1.9.3 时，出现以下错误。似乎无法执行C编译器。

克里斯$`rvm install ruby`

没有可用的二进制红宝石：downloads/ruby-1.9.3-p327。继续编译。请阅读“rvm mount”以获取有关二进制红宝石的更多信息。将 yaml-0.1.4.tar.gz 提取到 /Users/chris/.rvm/archives 将 yaml 提取到 /Users/chris/.rvm/src/yaml-0.1.4 在 /Users/chris/.rvm/src 中配置 yaml /yaml-0.1.4。错误运行 'env LDFLAGS=-L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active/include ./configure --prefix =/Users/chris/.rvm/usr'，请阅读/Users/chris/.rvm/log/ruby-1.9.3-p327/yaml/configure.log 在/Users/chris/.rvm/src/中编译yaml yaml-0.1.4。将 yaml 安装到 /Users/chris/.rvm/usr 从源安装 Ruby 到：/Users/chris/.rvm/rubies/ruby-1.9.3-p327，这可能需要一段时间，具体取决于您的 CPU。 . ruby​​-1.9.3-p327 - #downloading ruby​​-1.9.3-p327, 这可能需要一段时间，具体取决于您的连接... ruby​​-1.9.3-p327 - #extracted to /Users/chris/.rvm/src/ruby-1.9.3-p327（已提取） ruby​​-1.9.3- p327 - #configuring Error running 'env LDFLAGS=-L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active/include ./配置 --enable-shared --disable-install-doc --prefix=/Users/chris/.rvm/rubies/ruby-1.9.3-p327 --with-opt-dir=/Users/chris/.rvm/ usr'，请阅读 /Users/chris/.rvm/log/ruby-1.9.3-p327/configure.log 运行配置时出错。停止安装。/configure --enable-shared --disable-install-doc --prefix=/Users/chris/.rvm/rubies/ruby-1.9.3-p327 --with-opt-dir=/Users/chris/.rvm /usr'，请阅读 /Users/chris/.rvm/log/ruby-1.9.3-p327/configure.log 运行配置时出错。停止安装。/configure --enable-shared --disable-install-doc --prefix=/Users/chris/.rvm/rubies/ruby-1.9.3-p327 --with-opt-dir=/Users/chris/.rvm /usr'，请阅读 /Users/chris/.rvm/log/ruby-1.9.3-p327/configure.log 运行配置时出错。停止安装。

日志文件中的内容：

2012-12-17 21:46:44] env LDFLAGS=-L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active /include ./configure --enable-shared --disable-install-doc --prefix=/Users/chris/.rvm/rubies/ruby-1.9.3-p327 --with-opt-dir=/Users/chris /.rvm/usr 检查构建系统类型... x86_64-apple-darwin11.4.2 检查主机系统类型... x86_64-apple-darwin11.4.2 检查目标系统类型... x86_64-apple-darwin11.4.2 检查是否C 编译器工作...没有配置：错误：在 /Users/chris/.rvm/src/ruby-1.9.3-p327'：配置：错误：C 编译器无法创建可执行文件有关详细信息，请参阅config.log'

然后我尝试在[https://github.com/kennethreitz/osx-gcc-installer](https://github.com/kennethreitz/osx-gcc-installer)上安装 GCC 。错误仍然出现。

我也尝试将 cmd 更改为`rvm install 1.9.3 --with-gcc=clang`，但遇到了同样的错误。

我需要设置一些环境变量吗？还是我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T01:10:32.037

是否安装了 XCode 命令行工具？我也使用自制软件，但已经能够在 Lion 和（现在）Mountain Lion 上从 rvm 构建 ruby​​-1.9.3。

# javascript - Coffeescript：使用moment js和coffeescript动态更新时间

> ID：13924789
> 
> 赞同：1
> 
> 时间：2012-12-18T01:00:28.163
> 
> 标签：javascript, coffeescript, momentjs

我无法使用时刻 js 动态查看时间更新。它显示了正确的时间，但我必须刷新浏览器才能获得时间更新。我希望它能够实时更新。就像 momentjs.com 主页一样。

我试过使用 setInterval 和 setTimeout 但由于某种原因，我得到了以下甚至没有更新的数字。

到目前为止，这是我在代码方面所拥有的。就时刻而言，这很简单，我想要的只是秒数……

```
update = ->
  time = moment().format('hh:mm:ss a')

clock = setInterval update, 1000
console.log(clock) //output: 53296 
```

任何想法都非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T01:59:40.640

您应该将输出放在更新方法中，一切都会按预期工作。方法 setInterval 不会返回重复调用方法的结果，而是一个标识符，可以与 clearInterval 一起使用以停止执行。

只是一个小的工作示例，每秒钟打印一次时间并在 10 秒后停止：

```
update = ->
    console.log(moment().format('hh:mm:ss a'))
x = setInterval update, 1000;
setTimeout (-> clearInterval(x)), 10000 
```

如果您想将该时间用作某些 DOM-Element 的内容，您可以在更新函数中使用以下代码（假设您有一个 id 为“time”的元素（例如 div））：

*查询*：

```
$("#time").text(moment().format('hh:mm:ss a')) 
```

*纯JS：*

```
document.getElementById("time").firstChild.data = moment().format('hh:mm:ss a') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-10T12:02:29.643

尝试这个。如果你不必使用 meomentJS。 [https://github.com/furkankaynak/countdown](https://github.com/furkankaynak/countdown)

# asp.net - 将用户迁移到 Universal Membership Provider

> ID：13924790
> 
> 赞同：0
> 
> 时间：2012-12-18T01:00:29.217
> 
> 标签：asp.net, asp.net-membership

我正在尝试迁移到新的 Universal Membership 提供商（从自制解决方案）。我已将旧的 User 表迁移到 Users/Memberships 表。

当我运行时`Membership.ValidateUser(txtUsername.Text.Trim(), txtPassword.Text.Trim())`，它总是返回 false，即使我知道用户名/密码是正确的。

以下是我生成密码、哈希和盐的方式：

```
var salt = Crypto.GenerateSalt();
var hashedPassword = this.GenerateHashWithSalt(password, salt); 
```

这是我正在使用的 GenerateHashWithSalt 方法

```
private string GenerateHashWithSalt(string password, string salt)
{
    string hashWithSalt = password + salt;
    byte[] saltedHashBytes = Encoding.UTF8.GetBytes(hashWithSalt);

    HashAlgorithm algo = HashAlgorithm.Create(Membership.HashAlgorithmType);

    byte[] hash = algo.ComputeHash(saltedHashBytes);

    return Convert.ToBase64String(hash);
} 
```

我也去了：

```
var salt = Crypto.GenerateSalt();
var saltedPassword = password + salt;
var hashedPassword = Crypto.HashPassword(saltedPassword); 
```

这些似乎都不起作用。我错过了什么？

斯科特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T18:23:51.167

呸，回复了。

因此，所有这一切的第一步是将用户从我们的 2 路加密密码迁移到 1 路哈希。

我看到的每个例子都包括手动散列密码。结果是`Membership.CreateUser(username,password);`对密码（和盐）进行哈希处理，所以我正在对哈希密码进行哈希处理，这就是身份验证失败的原因。

我只需要调用 Membership.CreateUser，传入用户名和纯文本通道，它就可以工作了。哇！

# symfony - 在 Symfony2 中，是否有一个 gettable 服务会返回已注册的 Doctrine 实体类列表？

> ID：13924793
> 
> 赞同：0
> 
> 时间：2012-12-18T01:00:47.800
> 
> 标签：symfony, service, doctrine

在我的配置中，我`doctrine.orm.auto_mapping`设置为 true。所以 Doctrine Bridge 代码会自动在我的包的实体目录中查找。是否有可返回注册实体类列表的 gettable 服务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T06:33:14.260

Try:

```
$entityManager = $this->getDoctrine()->getEntityManager();
$metaData = $entityManager->getMetadataFactory()->getAllMetadata();
var_dump($metaData); 
```

# php - Wordpress 中的 jQuery.post()

> ID：13924797
> 
> 赞同：0
> 
> 时间：2012-12-18T01:01:04.333
> 
> 标签：php, jquery, wordpress, post

我目前正在为 Wordpress 编写一个聊天框插件。
该插件使用 jQuery.post() 方法将数据发送到 php 文件，以便将输出写入 html 文件，然后使用 jQuery 将其加载到聊天窗口。

在我用来将聊天日志写入 html 文件的 php 文件中，我需要使用 Wordpress API 函数，但这个 php 文件不包含在 Wordpress 中，因此无法访问 Wordpress API。

有没有办法将此聊天数据发送到 Wordpress 包含的 php 文件，以便我可以使用 Wordpress API？解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T01:15:48.483

您可以`wp_localize_script`用于将 JavaScript 对象中的 ajax url 发送到页面：

```
function my_localized_vars() { 
    return array(
      'site_url' => get_bloginfo('url'), 
      'ajax_url' => admin_url('admin-ajax.php')
    );
} 
wp_localize_script('needle', 'object_name', my_localized_vars()); 
```

然后您可以添加操作并处理请求。 [http://codex.wordpress.org/Plugin_API/Action_Reference/wp_ajax_%28action%29](http://codex.wordpress.org/Plugin_API/Action_Reference/wp_ajax_%28action%29)

要使用 JavaScript 获取 url，您可以编写以下代码：

```
var url = object_name.ajax_url; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T01:15:33.050

与其使用单独的 PHP 文件，不如将其包装在 WordPress 插件中。WordPress Codex 将告诉您如何[编写插件](http://codex.wordpress.org/Writing_a_Plugin)以及如何连接它来[处理您的 ajax 请求](http://codex.wordpress.org/AJAX_in_Plugins)。

一旦您将它作为插件工作，您将能够访问所有 WordPress API。

# paypal - PayPal IPN 折扣变量

> ID：13924799
> 
> 赞同：4
> 
> 时间：2012-12-18T01:01:32.153
> 
> 标签：paypal, paypal-ipn, paypal-sandbox

我正在使用 PayPal IPN 在我的网站上处理付款。我希望用户能够输入折扣代码和传递给 PayPal 并计算的值（金额或百分比）。

我一直在网上寻找，但似乎只能找到以下内容：

```
Use discount_amount_cart to charge a single discount amount for the entire cart.

Use discount_amount_x to set a discount amount associated with item x

Use discount_rate_cart to charge a single discount percentage for the entire cart.

discount_rate_cart - Applies to entire cart however, this variable will only work with the "Upload" Method. Not the standard Add to Cart variables. 
```

在我的请求字符串中测试了这些之后：

`...&discount_amount_cart=10&...`

PayPal 似乎不承认这个折扣。这在 PayPal IPN 中是否真的存在？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-10T16:39:50.190

是的你可以！！！

这是 Paypal 变量的完整列表以及相关文档。

我自己刚刚使用了 discount_amount_cart！

[https://developer.paypal.com/webapps/developer/docs/classic/paypal-payments-standard/integration-guide/Appx_websitestandard_htmlvariables/#id08A6HH0D0TA](https://developer.paypal.com/webapps/developer/docs/classic/paypal-payments-standard/integration-guide/Appx_websitestandard_htmlvariables/#id08A6HH0D0TA)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-12-27T10:38:12.503

不 ！PayPal 不提供任何折扣，您需要在应用程序中手动计算折扣并将其发送到 paypal。我开发了一个 Ruby on Rails 应用程序，它使用 Stripe 和 PayPal 计算帐单信息。顺便问一下，您使用哪种语言进行编程？这样我就可以帮助您更多地了解如何去做。

# java - 限制小数位

> ID：13924800
> 
> 赞同：2
> 
> 时间：2012-12-18T01:01:37.027
> 
> 标签：java, swing, jtextfield, number-formatting, decimal

我有一个基本问题。我真的不擅长编程。我试图在我的答案字段中显示小数点后 2 位的答案。我有我的 JTextFields 和我的 JRadioBtn 集。当答案针对我的面积或周长时，会有很多小数位。我只需要它来四舍五入小数点后 2 位。这是我到目前为止的代码：

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import static java.lang.Math.*;

public class Triangle extends JFrame
{
private GridBagLayout layout = new GridBagLayout();
private GridBagConstraints constraints = new GridBagConstraints();
JTextField firstNumberTxt, secondNumberTxt, thirdNumberTxt, answerTxt;
JRadioButton addBtn, subBtn, multBtn, divBtn;
JButton calculateBtn, exitBtn;

public ExamQuestion2()
{
    super( "A Simple Calculator Form." );
    firstNumberTxt = new JTextField( 5 );
    secondNumberTxt = new JTextField( 5 );
    answerTxt = new JTextField( 5 );
    addBtn = new JRadioButton( "area", true );
    subBtn = new JRadioButton( "perimeter", false );

    calculateBtn = new JButton( "cal" +
                "calculate" );
    exitBtn = new JButton( "exit" );

    JLabel firstNumberLbl = new JLabel( "Base: "),
            operationLbl = new JLabel( "Operation "),
            secondNumberLbl = new JLabel( "Height: "),
            answerLbl =new JLabel( "Answer: ");

    setLayout( layout );
    addComponent( firstNumberLbl, 0, 0, 1, 1, GridBagConstraints.EAST );
    addComponent( firstNumberTxt, 0, 1, 1, 1, GridBagConstraints.WEST );
    addComponent( operationLbl, 1, 0, 1, 4, GridBagConstraints.CENTER );
    addComponent( addBtn, 1, 1, 1, 1, GridBagConstraints.WEST );
    addComponent( subBtn, 2, 1, 1, 1, GridBagConstraints.WEST );
    addComponent( secondNumberLbl, 5, 0, 1, 1, GridBagConstraints.EAST );
    addComponent( secondNumberTxt, 5, 1, 1, 1, GridBagConstraints.WEST );
    addComponent( answerLbl, 6, 0, 1, 1, GridBagConstraints.EAST );
    addComponent( answerTxt, 6, 1, 1, 1, GridBagConstraints.WEST );
    addComponent( calculateBtn, 7, 0, 1, 1, GridBagConstraints.EAST );
    addComponent( exitBtn, 7, 1, 1, 1, GridBagConstraints.WEST );

    calculateBtn.addActionListener( new Calculator() );
    exitBtn.addActionListener( new Exiter() );
}

private void addComponent( Component component, int row, int column, int width, int height, int anch )
{
    constraints.gridx = column;
    constraints.gridy = row;
    constraints.gridwidth = width;
    constraints.gridheight = height;
    constraints.anchor = anch;
    constraints.weighty = 5;
    add( component );
    layout.setConstraints( component, constraints );
}

private class Calculator implements ActionListener
{
    public void actionPerformed( ActionEvent event )
    {
        String firstString, secondString;
        int choice;
        int firstNumber, secondNumber;

        firstString = firstNumberTxt.getText();
        secondString = secondNumberTxt.getText();
        if( firstString.length() < 1 || secondString.length() < 1)
        {
            answerTxt.setText( " INVALID" );
            return;
        }
        firstNumber = Integer.parseInt( firstString );
        secondNumber = Integer.parseInt( secondString );

        if( addBtn.isSelected() )
        {
            choice = 0;
            subBtn.setSelected( false );
        }
        if( addBtn.isSelected() ) choice = 0;
        else if( subBtn.isSelected() ) choice = 1;
        else if( multBtn.isSelected() ) choice = 2;
        else choice = 3;

        switch ( choice )
        {
        case 0: answerTxt.setText( ( (firstNumber * secondNumber) / 2 ) +     "" ); break;
        case 1: answerTxt.setText( ( firstNumber + secondNumber + sqrt(     (firstNumber * firstNumber) + 
                (secondNumber * secondNumber))) + "" ); break;
        default: if ( secondNumber != 0 )
                {
                    answerTxt.setText( ( firstNumber /     secondNumber ) + "" ); break;
                }
        else answerTxt.setText( " INVALID " ); break;

        }
    }
}

public static void main(String[] args) 
{
    Triangle MyCalculator= new Triangle();
    MyCalculator.setDefaultCloseOperation( JFrame.EXIT_ON_CLOSE );
    MyCalculator.setSize( 300, 300 );
    MyCalculator.setLocationRelativeTo(null);
    MyCalculator.setVisible( true );
}

private class Exiter implements ActionListener
{
    public void actionPerformed( ActionEvent event)
    {
        System.exit(0);
    }
}
} 
```

我已经查看并尝试了一些我在网上找到的东西，但似乎无法让任何东西正常工作。有人帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T01:33:13.480

试试`NumberFormat.getCurrencyInstance()`；[这里](https://stackoverflow.com/a/13903307/230513)有一个相关的例子。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T01:27:24.900

尝试使用：

```
String.format("%.2f", numberToBeRounded); 
```

例如，您可以将包含的行替换为`case 0`：

```
case 0: answerTxt.setText( String.format("%.2f", (firstNumber * secondNumber) / 2 ) ); break; 
```

格式说明符将显示一个四舍五入到小数点后两位的`%.2f`浮点数。有关格式化字符串的更多详细信息，请参阅[Formatter](http://docs.oracle.com/javase/7/docs/api/java/util/Formatter.html#syntax)文档。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T01:40:29.423

除了`NumberFormat`显示您的数字之外，我建议您从代码中退后一步，并查看[`BigDecimal`](http://docs.oracle.com/javase/6/docs/api/java/math/BigDecimal.html)该类以满足您的数字计算需求。您可以设置比例`BigDecimal(BigInteger unscaledVal, int scale)`并有效（正确读取）执行数字计算。

# python - 在矩阵运算期间忽略层次索引

> ID：13924801
> 
> 赞同：1
> 
> 时间：2012-12-18T01:01:44.490
> 
> 标签：python, pandas

在这个例程的最后一条语句中，我得到一个 TypeError

```
data = {'state': ['Ohio', 'Ohio', 'Ohio', 'Nevada', 'Missouri'],
        'year': [2000, 2001, 2002, 2001, 2002],
        'items': [5, 12, 6, 45, 0]}
frame = DataFrame(data)

def summary_pivot(df, row=['state'],column=['year'],value=['items'],func=len):
    return df.pivot_table(value, rows=row,cols=column,
                   margins=True, aggfunc=func, fill_value=0)

test = summary_pivot(frame)

In [545]: test
Out[545]: 
          items                 
year       2000  2001  2002  All
state                           
Missouri      0     0     1    1
Nevada        0     1     0    1
Ohio          1     1     1    3
All           1     2     2    5

price = DataFrame(index=['Missouri', 'Ohio'], columns = ['price'], data = [200, 250])

In [546]: price
Out[546]: 
          price
Missouri    200
Ohio        250

test * price 
```

**TypeError：只能与其他分层索引对象一起调用**

我怎样才能克服这个错误，所以我可以正确地将每个州的商品数量乘以相应的价格？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T03:04:50.860

```
In [659]: price = Series(index = ['Missouri', 'Ohio'], data = [200, 250])

In [660]: test1 = test.items

In [661]: test1.mul(price, axis='index')
Out[661]: 
year      2000  2001  2002  All
All        NaN   NaN   NaN  NaN
Missouri     0     0   200  200
Nevada     NaN   NaN   NaN  NaN
Ohio       250   250   250  750 
```

# visual-studio - Visual Studio Pro 2012 在打开解决方案后立即崩溃并出现 MissingFieldException

> ID：13924804
> 
> 赞同：4
> 
> 时间：2012-12-18T01:01:58.173
> 
> 标签：visual-studio, visual-studio-2012

我从我们的 TFS 下载了一些源代码，我的设置是通过 VPN 进行的。我在家里的机器和办公室的机器上安装了相同的 VS2012 安装程序。

一旦我打开解决方案，Visual Studio 2012 就会崩溃。我尝试卸载，运行 CCleaner，然后重新安装，但仍然有错误。

以下事实是相关的：

*   我有这台电脑的管理员权限
*   它确实安装了其他版本的 Visual Studio
*   我有最新的 Windows 7 和 Visual Studio 2012 补丁

以下来自崩溃报告：

> 问题签名：问题事件名称：CLR20r3
> 问题签名 01：devenv.exe
> 问题签名 02：11.0.50727.1 问题签名 03：5011ecaa 问题签名 04：Microsoft.VisualStudio.Progression.LanguageService.CSharp
> 问题签名 05：11.0.50727.1
> 问题签名 06 ：5011cc19
> 问题签名 07：131
> 问题签名08：43 问题
> 签名 09：System.MissingFieldException
> 操作系统版本：6.1.7601.2.1.0.256.1
> 区域设置 ID：1033 附加信息 1：0a9e
> 附加信息 2：0a9e372d3b4ad19135b953a78882e789
> 附加信息 3：
> 附加信息 4：0a9e372d3b4ad19135b953a78882e789
> 在线阅读我们的隐私声明：http: [//go.microsoft.com/fwlink/](http://go.microsoft.com/fwlink/?linkid=104288&clcid=0x0409) ?linkid=104288&clcid=0x0409如果在线隐私声明不可用，请离线阅读我们的隐私声明：C:\Windows\ system32\en-US\erofflps.txt

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-14T13:30:19.363

**我的解决方案是从官方下载页面下载并应用第[一个更新。](http://www.microsoft.com/visualstudio/eng/downloads#d-additional-software)**

我对 VS 2012 Ultimate 也有同样的问题。

问题似乎是至少 3 个官方下载的 ISO 下载与您的版本相同，过时的版本，每次打开解决方案时我都会遇到完全相同的异常。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-25T21:57:17.630

嘿重命名了 %localappdata%\microsoft\visualstudio\11.0\ 中的“ComponentModelCache”文件夹

这解决了这个问题。

# javascript - 如何引用方法javascript？

> ID：13924805
> 
> 赞同：0
> 
> 时间：2012-12-18T01:02:10.740
> 
> 标签：javascript, function, methods

是否可以使用函数调用来引用方法？

我想我可以尝试这样的事情：

```
function map(f,lst) {
// calling map method directly is fine.
    return lst.map(f)
}

function mapm(m,lst) {
// where m is a passed method
    return map( function(x) { return x.m() }, lst)
}

var list_a = [ [1,9],[2,8],[3,7],[4,6] ]
var list_b = mapm(pop,list_a)

>Uncaught ReferenceError: pop is not defined 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T01:04:49.823

尝试：

```
mapm( 'pop', list_a )
...
return x[ m ](); 
```

如果你真的想引用函数本身：

```
mapm( list_a.pop, list_a ); // or Array.prototype.pop
...
return m.apply( x ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T01:07:50.073

您可以使用`Function.prototype.call.bind`创建方法的功能版本。这被称为“uncurrying `this`”。

```
function map(f, lst) {
// calling map method directly is fine.
    return lst.map(f)
}

function mapm(m,lst) {
// where m is a passed method
    return map( function(x) { return m(x) }, lst)
}

var pop = Function.prototype.call.bind(Array.prototype.pop);

var list_a = [ [1,9],[2,8],[3,7],[4,6] ]
var list_b = mapm(pop, list_a) 
```

* * *

如果您需要它在古代浏览器中工作，您需要填充`bind`：

```
if (!Function.prototype.bind) {
  Function.prototype.bind = function (oThis) {
    if (typeof this !== "function") {
      // closest thing possible to the ECMAScript 5 internal IsCallable function
      throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");
    }

    var aArgs = Array.prototype.slice.call(arguments, 1), 
        fToBind = this, 
        fNOP = function () {},
        fBound = function () {
          return fToBind.apply(this instanceof fNOP && oThis
                                 ? this
                                 : oThis,
                               aArgs.concat(Array.prototype.slice.call(arguments)));
        };

    fNOP.prototype = this.prototype;
    fBound.prototype = new fNOP();

    return fBound;
  };
} 
```

# java - 检查路径在java中是否有效或合法

> ID：13924808
> 
> 赞同：4
> 
> 时间：2012-12-18T01:02:46.690
> 
> 标签：java

> **可能重复：**
> [Java 中有没有办法在不尝试创建文件的情况下确定路径是否有效？](https://stackoverflow.com/questions/468789/is-there-a-way-in-java-to-determine-if-a-path-is-valid-without-attempting-to-cre)

我想检查一个字符串是否是文件夹或文件的有效路径名。有效路径名可以是 C:\Games\WarCraft，无效路径是 c:[][]Games\\WarCraft。我如何检查这是否正确？

我对检查该文件或文件夹是否存在不感兴趣。我不想使用任何像 Apache Commons 这样的外部库来做到这一点，只是普通的旧 java。

另外，我想让我的代码系统独立 -虽然没有必要**更新**

请提供线索！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T01:11:52.947

您不能以独立于系统的方式执行此操作，而且我认为没有任何用于路径名验证的标准 API。

我能想到的最好的建议是使用正则表达式来匹配路径名。确切的细节将取决于您希望限制路径名的松散或紧密程度。例如，在 Linux 上，您可能希望在路径名中禁止空格，因为虽然它们是有效的，但它们也会导致编写不佳的 shell 脚本出现问题。或者您可能想要坚持使用绝对（或相对）路径名。

但在进行正则表达式匹配之前，最好使用`File.getCanonicalFile()`. 这将执行诸如检查符号链接，摆脱多余的“。”之类的事情。和“..”，并将驱动器号转换为标准格式......这应该简化你的正则表达式。

# java - 在java数组中查找重复单词并返回具有唯一重复单词的数组 - 使用方法

> ID：13924812
> 
> 赞同：0
> 
> 时间：2012-12-18T01:03:36.160
> 
> 标签：java, arrays, duplicates

我是java新手，对这个问题感到困惑。这就是我到目前为止提出的。我还在努力，如果我有任何进展，我会在这里发布。

```
public class charArray {

public static void main(String[] args) {

    String[] strArray = new String[] {"apple", "ball", "cat", "apple", "ball", "apple"};
    //output should be ["apple", "ball"]

    checkDuplicate(strArray);
}
public static String[] checkDuplicate(String[] strArray){
    String[] newArray = new String[]{};
    for(int i = 0; i < strArray.length; i++){

        for(int j = 0; j < i; j++){
            if (strArray[i].equals(srtArray[j])){
                newArray = strArray[i];
            }
        }

    }
    return newArray[];

} 
```

}

* * *

新进展：好的，我平庸的头脑已经走到了这一步：（并且解决方案有效）它打印出独特的重复元素数组。但是现在我需要通过调用一个方法来实现相同的代码。任何帮助表示赞赏。

```
import java.util.*;

public class setChar {

public static void main(String[] args) {
    String[] strArray = new String[] {"apple", "ball", "cat", "apple", "ball", "apple"};
    Set set = new HashSet();
    Set uniqueSet = new HashSet();
    for(int i = 0; i < strArray.length ; i++ ){
        boolean b = set.add(strArray[i]);
        if(b == false){
            uniqueSet.add(strArray[i]);
        }
    }
    Iterator it = uniqueSet.iterator();
    while (it.hasNext()){
        System.out.println(it.next());
    }
}

} 
```

输出是： **球苹果**

* * *

最后用方法实现，具有正确的返回类型。请让我知道，如果这可以进一步优化。谢谢大家的建议。这是工作代码：

```
public class retUnique {

public static void main(String[] args) {
    String[] strArray = new String[] {"apple", "ball", "cat", "apple", "ball", "apple"};

    System.out.println(printUnique(strArray));
}

public static Set<String> printUnique(String[] strArray){
    Set<String> set = new HashSet<String>();
    Set<String> uniqueSet = new HashSet<String>();
    for(int i = 0; i < strArray.length ; i++ ){
        boolean b = set.add(strArray[i]);
        if(b == false){
            uniqueSet.add(strArray[i]);
        }
    }
    return(uniqueSet);
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T01:05:23.943

一个简单的选择是使用[`Set`类似容器](http://docs.oracle.com/javase/6/docs/api/java/util/Set.html)而不是数组。它将自动确保仅存在唯一值。

您可以查看[TreeSet](http://www.easywayserver.com/blog/java-set-example/)和[HashSet](http://www.java-samples.com/showtutorial.php?tutorialid=348)的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T01:15:09.720

我相信这样的事情应该有效。自从我用 Java 编码以来已经有一段时间了，所以如果有人想进行编辑，请做。

```
public String[] returnDups(String[] strArray) {
    Set<String> set = new HashSet<String>(strArray);
    return set.toArray(new String[0]);
} 
```

但大家一直在建议的是正确的想法。集合使删除重复项变得非常容易，因此您应该利用它们。让我们不要重新发明轮子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T01:08:37.750

要检测重复项，如果这是您的问题，请将数组的所有元素添加到 Set，如果 set.add() 返回 false，则它是重复项，因此您可以将此元素添加到重复项的结果列表中。
或者，如果您的问题是要返回没有重复的值，那么您可以重新设置集合，或者在返回之前将集合转换为列表。

# java - 如何在 netbeans 平台应用程序的菜单栏中插入标签和图像图标

> ID：13924815
> 
> 赞同：0
> 
> 时间：2012-12-18T01:04:09.393
> 
> 标签：java, swing, netbeans-platform

在我的基于 netbeans 平台的应用程序中，我需要在菜单栏中添加一个显示用户名和图像图标的标签。菜单项在 xml 文件中定义，动作类用于定义菜单动作。如何自定义菜单栏以便在菜单栏的右上角放置标签和图像图标？这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T16:48:12.540

论坛帖子中给出了解决方案： [http ://forums.netbeans.org/post-140363.html](https://web.archive.org/web/20151019040537/http://forums.netbeans.org:80/post-140363.html)

# php - 试图在网页中打印数据库但无法获得表格的计数器

> ID：13924816
> 
> 赞同：-1
> 
> 时间：2012-12-18T01:04:40.540
> 
> 标签：php, html, mysql

我正在尝试创建一个页面，在网页上显示来自 mysql 数据库的 rpg 排名

我进入数据库并按级别组织数据，因此首先显示级别最高的人，依此类推，但是数据库不包含排名表

我正在尝试在 Dreamweaver 中手动执行此操作，但我不知道如何，我可以创建一个计数器并将其显示在表格中吗？

我设法得到以下信息： [http ://slayersgaming.com/rpgranks2.php](http://slayersgaming.com/rpgranks2.php)

```
<?php
$dbh=mysql_connect("********", "**********", "*********") or die('Cannot connect to the database because: '. mysql_error());
mysql_select_db("C368969_thcrpgCSGO");

$rpgranks_sql = "SELECT * FROM `thc_rpg` ORDER BY `thc_rpg`.`level` DESC LIMIT 0, 30 ";

$rpgranks_query = mysql_query($rpgranks_sql) or die(mysql_error());

$rsrpgranks = mysql_fetch_assoc($rpgranks_query);

?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
</head>

<body>

<p>
<table width="501" height="58" border="0">
  <tr>
    <td width="240"><h2><strong>Name</strong></h2></td>
    <td width="70"><strong>Level</strong></td>
    <td width="70"><strong>XP</strong></td>
    <td width="70"><strong>Credits</strong></td>
    <td width="70"><strong>Rank</strong></td>
  </tr>
</table>
  <?php do{ ?>
<table width="501" height="58" border="0">
  <tr>
    <td width="240"><?php echo $rsrpgranks['name'];?></td>
    <td width="70"><?php echo $rsrpgranks['level'];?></td>
    <td width="70"><?php echo $rsrpgranks['xp'];?></td>
    <td width="70"><?php echo $rsrpgranks['credits'];?></td>
    <td width="70">&nbsp;</td>
  </tr>
</table>
  <?php } while ($rsrpgranks = mysql_fetch_assoc($rpgranks_query)) ?>

</p>
<p>&nbsp;       </p>
</body>
</html> 
```

屏幕截图：http: [//oi47.tinypic.com/21exdfs.jpg](http://oi47.tinypic.com/21exdfs.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T01:08:42.150

这实际上很容易做到。你只需要在你的 do-while 循环中有一个计数器，如下所示：

```
<?php
$counter = 1;
do{
?>
<table width="501" height="58" border="0">
  <tr>
    <td><?php echo $counter; ?></td>
    <td width="240"><?php echo $rsrpgranks['name'];?></td>
    <td width="70"><?php echo $rsrpgranks['level'];?></td>
    <td width="70"><?php echo $rsrpgranks['xp'];?></td>
    <td width="70"><?php echo $rsrpgranks['credits'];?></td>
    <td width="70">&nbsp;</td>
  </tr>
</table>
<?php
    $counter++;
} while ($rsrpgranks = mysql_fetch_assoc($rpgranks_query))
?> 
```

# unit-testing - Gallio 单元测试启动代码

> ID：13924822
> 
> 赞同：0
> 
> 时间：2012-12-18T01:05:12.493
> 
> 标签：unit-testing, mbunit

这将是一个业余水平的问题。有没有办法将启动代码添加到使用 MBUnit 3.4.0.0 的测试项目中？我尝试将 [TestFixture] 和 [FixtureSetUp] 属性添加到我想首先运行的代码中，但不幸的是这没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T12:45:10.730

[FixtureSetUp] 应在 [TestFixture] 中包含的测试的任何测试之前执行一次，但两者不能互换使用。

这是一个简单的例子。诚然，该类不必使用 [TestFixture] 属性进行修饰，但这是一种很好的做法。

```
[TestFixture]
public class SimpelTest
{
    private string value = "1";

    [FixtureSetUp]
    public void FixtureSetUp()
    {
        // Will run once before any test case is executed.
        value = "2";
    }

    [SetUp]
    public void SetUp()
    {
        // Will run before each test
    }

    [Test]
    public void Test()
    {
        // Test code here
        Assert.AreEqual("2", value);
    }

    [TearDown]
    public void TearDown()
    {
        // Will run after the execution of each test
    }

    [FixtureTearDown]
    public void FixtureTearDown()
    {
        // Will run once after every test has been executed
    }
} 
```

# javascript - 将 VTD-XML 与 node.js 一起使用

> ID：13924823
> 
> 赞同：0
> 
> 时间：2012-12-18T01:05:21.040
> 
> 标签：javascript, xml, node.js, vtd-xml

VTD-XML 看起来是解决我长期以来遇到的一个问题的完美解决方案，随机访问非常大的 XML 文件（在我的例子中，MediaWiki 转储文件，如维基词典的那些文件）。

问题是，有没有办法从 node.js 使用 VTD-XML？我找不到任何人在我的互联网搜索中提到这两个主题。

VTD-XML 正式可用于 Java、C#、C++ 和 C。但在他们的网站上没有提及任何脚本语言，包括 JavaScript 和 node.js。

有没有我还没有找到将它们一起使用的解决方案，或者如果我要自己动手，我应该从哪里开始？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T04:45:34.223

不是这个时候。您是否尝试在客户端的浏览器窗口中处理巨大的 XML？通常这种大小的 XML 在服务器环境中处理，这就是为什么到目前为止它只移植到流行的服务器编程语言。

# java - 安全转换为哈希映射

> ID：13924825
> 
> 赞同：17
> 
> 时间：2012-12-18T01:05:39.653
> 
> 标签：java, collections, map, hashmap

如何安全地将 Map 转换为哈希 Map？

我想避免类转换异常

```
HashMap<String, String> hMap;

public void setHashMap(Map map){
    hMap = (HashMap<String, String>) map;
} 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-12-18T01:12:14.177

您可以制作（浅）副本：

```
HashMap<String, String> copy = new HashMap<String, String>(map); 
```

或者如果它还不是 HashMap 则将其强制转换：

```
HashMap<String, String> hashMap = 
   (map instanceof HashMap) 
      ? (HashMap) map 
      : new HashMap<String, String>(map); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-18T01:22:48.107

通常，您不能将 a 类型转换`Map`为 a`HashMap`而不会有类转换异常的风险。如果`Map`是 a`TreeMap`那么演员将（并且必须）失败。

您可以通过在强制转换之前使用检查类型来*避免*异常`instanceof`，但如果测试显示“不是 HashMap”，您就会被卡住。你将无法使演员工作。

实际的解决方案是：

*   声明`hMap`为 a `Map`not a `HashMap`,
*   将条目复制`Map`到新创建的`HashMap`，或
*   （恶心）创建一个包装真实地图的自定义 HashMap 子类。

（这些方法都不适用于所有情况......但如果没有更多关于地图用途的详细信息，我无法提出具体建议。）

* * *

当你这样做时，向有问题的库的提供者提交错误报告可能是合适的。强迫您使用特定的 Map 实现（从表面上看）是个坏主意。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-18T01:21:00.237

您的函数应如下所示以避免任何类型的异常，例如`ClassCastException`or `NullPointerException`。在这里，任何类型的`Map`对象都将被分配`HashMap`到您的类字段中。

```
public void setHashMap(Map<String, String> map) {

    if (map != null && map instanceof HashMap<?, ?>) {
        hMap = (HashMap<String, String>) map;
    } else if (map != null) {
        hMap.putAll(map);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-18T01:17:44.657

您不应该转换为 HashMap！投射到地图！
如果你真的有你的问题的理由，那么，你必须创建一个新的 HashMap，以防 Map 不是 Map 的实例。
但这是个坏主意。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-18T01:13:21.017

你可以做：

```
if (map instanceof HashMap) {
   hMap = (HashMap<String, String>) map;
} else {
  //do whatever you want instead of throwing an exception
} 
```

或者只是用 try/catch 包围演员表，并在异常发生时捕获它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-18T01:22:41.877

如果你总是假设它是 a `HashMap<String, String>`，为什么不这样做呢？

```
HashMap<String, String> hMap;

public void setHashMap(HashMap<String, String> map){
    hMap = map;
} 
```

如果您想要更通用的东西，可以接受任何`Map`：

```
public void setHashMap(Map<String, String> map){
    if (map != null)
        hMap = new HashMap<String, String>(map);
    else
        hMap = new HashMap<String, String>();
} 
```

无需铸造。此外，您的示例缺少返回类型。我假设你的意思是把`void`.

# java - 使用数组的石板剪程序 Joption

> ID：13924826
> 
> 赞同：0
> 
> 时间：2012-12-18T01:05:54.847
> 
> 标签：java, arrays, swing, user-interface, joptionpane

我应该做一个石头，床单和剪刀游戏的程序。它涉及来自 Math.random() 的人类游戏和计算机游戏。它实际上是有效的，但我必须在我喜欢玩的时候一次又一次地重新运行它。所以我决定让它无限，直到输入 4。

这里'它是如何工作的：

想玩？打败电脑！

1.  结石
2.  床单
3.  剪
4.  退出

意思是说当我输入 4 时它会退出，但只要输入 1、2 或 3，它就应该连续运行。我怎样才能做到这一点。这是我当前的代码。我知道错误是 while player != 4 的位置

```
import javax.swing.*;

public class StoneSheetShears
{
    public static void main(String[] args)
    {
          String consoleStr;
          int player = 0;    
              int[] numChoices = {1,2,3,4};
              String[] strChoices = {"Stone", "Sheet", "Shears", "Quit"};
              String playerChoice = "";
              String compChoice = "";

              int computer = (int)(Math.random() * 3);
              String output = "";

             while(true)
             {
               do
               {
                  try
                  {
                      consoleStr = JOptionPane.showInputDialog("Beat the computer\n1\. Rock\n2\. Paper" +
                                        "\n3\. Scissors\n4\. Quit ");
                      player = Integer.parseInt(consoleStr);

                      for(int x = 0; x <numChoices.length; x++)
                      {
                          if(player == numChoices[x])
                          {
                             playerChoice = strChoices[x];
                          }
                      }

                      for(int y = 0; y <numChoices.length; y++)
                      {
                          if(computer == numChoices[y])
                          {
                             compChoice = strChoices[y];
                          }
                      }
                 }

             }while(player!=4)

          catch (NumberFormatException err)
          {
              JOptionPane.showMessageDialog(null, "There is an error on entry",
                  "Error Message", JOptionPane.WARNING_MESSAGE);
              continue;
          }
          break;
      } 

      if (player == computer)
      {
          output = "Both are " + compChoice;
          JOptionPane.showMessageDialog(null, output, "DRAW!", JOptionPane.INFORMATION_MESSAGE);
      }

      else if (player == 1)
      {
          if (computer == 2)
          {
              output = "Computer move is " + compChoice +
                      "\nYour move is " + playerChoice;
              JOptionPane.showMessageDialog(null,output, "You Lose!",
                            JOptionPane.INFORMATION_MESSAGE);
          }
          else if (computer == 3)
          {
              output = "Computer move is " + compChoice +
                      "\nYour move is " + playerChoice;
              JOptionPane.showMessageDialog(null,output, "You Win!",
                            JOptionPane.INFORMATION_MESSAGE);
          } 
      }

      else if (player == 2)
      {
          if (computer == 3)
          {
              output = "Computer move is " + compChoice +
                      "\nYour move is " + playerChoice;
              JOptionPane.showMessageDialog(null,output, "You Lose!",
                            JOptionPane.INFORMATION_MESSAGE);
          }
          else if (computer == 1)
          {
              output = "Computer move is " + compChoice +
                      "\nYour move is " + playerChoice;
              JOptionPane.showMessageDialog(null,output, "You Win!",
                            JOptionPane.INFORMATION_MESSAGE);
          }
      }

      else if (player == 3)
      {
          if (computer == 1)
          {
              output = "Computer move is " + compChoice +
                      "\nYour move is " + playerChoice;
              JOptionPane.showMessageDialog(null,output, "You Lose!",
                            JOptionPane.INFORMATION_MESSAGE);
          }
          else if (computer == 2)
          {
              output = "Computer move is " + compChoice +
                      "\nYour move is " + playerChoice;
              JOptionPane.showMessageDialog(null,output, "You Win!",
                            JOptionPane.INFORMATION_MESSAGE);
          }         
      }
}
} 
```

这基本上是一个游戏，其中石板和剪刀是选择。

1.  人类玩家将从 1（石头）、2（薄片）、3（剪刀）、4（退出）中进行选择
2.  电脑播放器是基于数学随机的。~~我使用数组来定义人类玩家和计算机的动作。~~（数组是 Java 语法的一部分，不适合这样的描述。）
3.  如果两人的动作相同，那就是平局。
4.  如果人类选择纸张，而电脑玩家是剪刀，显然电脑赢了。这同样适用于其他选择。
5.  ~~玩家将输入另一个数字 1 2 或 3。~~（这只是重复步骤 1，因此没有必要）。输入 4 即停止游戏，即按提示退出

我唯一的问题是如何让它连续工作，直到输入 4。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T02:19:22.060

This loop

```
do
{
    // Your choices...
}while (player != 4); 
```

Will only exit if the user selects option `4`. You game logic should be contained within this loop (meaning you can lose the `while(true)` loop).

This is also a horrible way to present this type of application to a user. Swing is a event driven environment, meaning you present you UI to the user and react to there interactions to it. From the looks of you code, you've taken a basic command line program and tried to convert. This is never a good idea.

Graphical user interfaces should rarely contain loops that control flow like this.

A better choice (IMHO), would be to create your own frame/dialog and present the options to the user. Each option would trigger a sequence of events by which the game would either be played or terminated.

This prevents the user being bombarded with multiple popup windows, which is just annoying.

![enter image description here](../Images/caa2f7019151284364f60f602d492b08.png)

(This is just one possible interface design)

```
public class RockPaperScissors {

    public static void main(String[] args) {
        new RockPaperScissors();
    }

    public RockPaperScissors() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new GamePane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class GamePane extends JPanel {

        public static final int STONE = 0;
        public static final int SHEET = 1;
        public static final int SHEARS = 2;

        private JButton stoneButton;
        private JButton sheetButton;
        private JButton shearsButton;
        private JButton quitButton;

        private JLabel player;
        private JLabel computer;
        private JLabel winner;

        public GamePane() {

            winner = new JLabel("Come play", JLabel.CENTER);
            player = new JLabel("Player", JLabel.CENTER);
            computer = new JLabel("computer", JLabel.CENTER);

            stoneButton = new JButton(new GameAction("Stone", STONE));
            sheetButton = new JButton(new GameAction("Sheet", SHEET));
            shearsButton = new JButton(new GameAction("Shear", SHEARS));
            quitButton = new JButton("Quit");

            setLayout(new GridBagLayout());
            GridBagConstraints gbc = new GridBagConstraints();
            gbc.anchor = GridBagConstraints.CENTER;
            gbc.gridx = 0;
            gbc.gridy = 0;
            gbc.gridwidth = 4;
            gbc.fill = GridBagConstraints.HORIZONTAL;
            add(winner, gbc);

            gbc.anchor = GridBagConstraints.WEST;
            gbc.gridy++;
            gbc.gridwidth = 2;
            add(player, gbc);

            gbc.anchor = GridBagConstraints.EAST;
            gbc.gridx = 2;
            add(computer, gbc);

            gbc.anchor = GridBagConstraints.CENTER;
            gbc.gridy++;
            gbc.gridwidth = 1;
            gbc.gridx = 0;
            add(stoneButton, gbc);

            gbc.gridx++;
            add(sheetButton, gbc);

            gbc.gridx++;
            add(shearsButton, gbc);

            gbc.gridx++;
            add(quitButton, gbc);

            quitButton.addActionListener(new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    System.exit(0);
                }
            });

        }

        protected void play(int action) {

            int ai = (int)Math.round((Math.random() * 2));
            updateChoice("Computer", computer, ai);
            updateChoice("Player", player, action);

            if (ai == action) {
                winner.setText("Draw!");
            } else if (action == STONE) {
                if (ai == SHEET) {
                    winner.setText("Computer Wins");
                } else if (ai == SHEARS) {
                    winner.setText("Player Wins");
                }
            } else if (action == SHEET) {
                if (ai == STONE) {
                    winner.setText("Player Wins");
                } else if (ai == SHEARS) {
                    winner.setText("Computer Wins");
                }
            } else if (action == SHEARS) {
                if (ai == STONE) {
                    winner.setText("Computer Wins");
                } else if (ai == SHEET) {
                    winner.setText("Player Wins");
                }
            }
        }

        protected void updateChoice(String prefix, JLabel label, int action) {

            switch (action) {
                case STONE:
                    label.setText(prefix + " chose STONE");
                    break;
                case SHEET:
                    label.setText(prefix + " chose SHEET");
                    break;
                case SHEARS:
                    label.setText(prefix + " chose SHEARS");
                    break;
            }

        }

        public class GameAction extends AbstractAction {

            private int action;

            public GameAction(String text, int action) {
                this.action = action;
                putValue(NAME, text);
            }

            @Override
            public void actionPerformed(ActionEvent e) {
                play(action);
            }

        }

    }

} 
```

**UPDATE**

As stated in the first part of the answer:

You don't need two loops. You inner loop is preventing the outter loop from running UNTIL the user selects option `4`.

You game logic belongs in the `do-while` loop.

```
public class StoneSheetShears {

    public static void main(String[] args) {
        String consoleStr;
        int player = 0;
        int[] numChoices = {1, 2, 3, 4};
        String[] strChoices = {"Stone", "Sheet", "Shears", "Quit"};
        String playerChoice = "";
        String compChoice = "";

        int computer = -1; //(int) (Math.random() * 3);
        String output = "";

        do {

            try {

                consoleStr = JOptionPane.showInputDialog("Beat the computer\n1\. Rock\n2\. Paper"
                        + "\n3\. Scissors\n4\. Quit ");

                player = Integer.parseInt(consoleStr);

                for (int x = 0; x < numChoices.length; x++) {
                    if (player == numChoices[x]) {
                        playerChoice = strChoices[x];
                    }
                }

                computer = (int) Math.round(Math.random() * 3);
                compChoice = strChoices[computer];

                if (player == computer) {
                    output = "Both are " + compChoice;
                    JOptionPane.showMessageDialog(null, output, "DRAW!", JOptionPane.INFORMATION_MESSAGE);
                } else if (player == 1) {
                    if (computer == 2) {
                        output = "Computer move is " + compChoice
                                + "\nYour move is " + playerChoice;
                        JOptionPane.showMessageDialog(null, output, "You Lose!",
                                JOptionPane.INFORMATION_MESSAGE);
                    } else if (computer == 3) {
                        output = "Computer move is " + compChoice
                                + "\nYour move is " + playerChoice;
                        JOptionPane.showMessageDialog(null, output, "You Win!",
                                JOptionPane.INFORMATION_MESSAGE);
                    }
                } else if (player == 2) {
                    if (computer == 3) {
                        output = "Computer move is " + compChoice
                                + "\nYour move is " + playerChoice;
                        JOptionPane.showMessageDialog(null, output, "You Lose!",
                                JOptionPane.INFORMATION_MESSAGE);
                    } else if (computer == 1) {
                        output = "Computer move is " + compChoice
                                + "\nYour move is " + playerChoice;
                        JOptionPane.showMessageDialog(null, output, "You Win!",
                                JOptionPane.INFORMATION_MESSAGE);
                    }
                } else if (player == 3) {
                    if (computer == 1) {
                        output = "Computer move is " + compChoice
                                + "\nYour move is " + playerChoice;
                        JOptionPane.showMessageDialog(null, output, "You Lose!",
                                JOptionPane.INFORMATION_MESSAGE);
                    } else if (computer == 2) {
                        output = "Computer move is " + compChoice
                                + "\nYour move is " + playerChoice;
                        JOptionPane.showMessageDialog(null, output, "You Win!",
                                JOptionPane.INFORMATION_MESSAGE);
                    }
                }

            } catch (NumberFormatException exp) {

                JOptionPane.showMessageDialog(null, "Bad choice", "Bad Choice", JOptionPane.ERROR_MESSAGE);

            }

        } while (player != 4);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T19:27:20.917

您给出的步骤是了解如何修复代码的一个很好的开端（如有必要，甚至可以从头开始）。到目前为止，在我们在评论中的讨论中，我们一直专注于用英语解释这些步骤。让我们通过介绍一些计算机编程概念来稍微完善这些步骤。特别是，我们需要某种循环。但是，为了强调一个重点，我们仍然没有过度关注 Java 语法。只要我们写了一些我们可以理解的东西，编译器是否能理解它并不重要。话虽如此，这是我对您的描述的建议修改：

```
Continue while human input is not 4
    Human player will choose from 1 (stone), 2 (sheet), 3(shears), 4(to quit)
    Computer player is based on math random.
    Determine the winner (or if it's a draw). 
```

请注意，我使用缩进来指示循环中重复了哪些步骤。另外，我没有详细介绍最后一步，因为我相信您了解如何执行该部分。

这个简短的描述现在可以翻译成 Java。请注意，只有一个循环。您可以将其实现为 while 或 do...while 循环。

# actionscript-3 - Flex FocusManager - 在多版本应用程序中按 Tab 导致堆栈溢出

> ID：13924827
> 
> 赞同：0
> 
> 时间：2012-12-18T01:06:03.957
> 
> 标签：actionscript-3, apache-flex, focus, flex4.6, focusmanager

我有一个加载子应用程序（使用 4.1 SDK 构建）的顶级应用程序（使用 4.6 SDK 构建）。在应用程序的这种状态下，大部分内容都包含在子应用程序中，顶部应用程序中的一些 UI 元素形成了围绕子应用程序内容的框架（或“HUD”）。

在没有文本输入字段接收焦点的地方，按 Tab 会导致 Flash Player 严重崩溃，并出现*错误 #1023: Stack overflow occurred*。

这是一个示例堆栈跟踪：

```
Error: Error #1023: Stack overflow occurred.
at mx.managers.systemClasses::MarshallingSupport/get swfBridgeGroup()
at mx.managers.systemClasses::MarshallingSupport/getSWFBridgeOfDisplayObject()
at mx.managers.systemClasses::MarshallingSupport/isDisplayObjectInABridgedApplication()
at mx.managers.marshalClasses::FocusManagerMarshalMixin/keyDownHandler()
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.managers::FocusManager/http://www.adobe.com/2006/flex/mx/internal::keyDownHandler()
at mx.managers.marshalClasses::FocusManagerMarshalMixin/moveFocus()
at mx.managers.marshalClasses::FocusManagerMarshalMixin/focusRequestMoveHandler()
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.managers.marshalClasses::FocusManagerMarshalMixin/moveFocusToParent()
at mx.managers.marshalClasses::FocusManagerMarshalMixin/focusRequestMoveHandler()
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.managers.marshalClasses::FocusManagerMarshalMixin/setFocusToComponentHandler()
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.managers::FocusManager/setFocusToComponent()
at mx.managers::FocusManager/setFocusToNextObject()
at mx.managers::FocusManager/http://www.adobe.com/2006/flex/mx/internal::keyFocusChangeHandler()
at mx.managers.marshalClasses::FocusManagerMarshalMixin/moveFocus()
at mx.managers.marshalClasses::FocusManagerMarshalMixin/focusRequestMoveHandler()
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.managers.marshalClasses::FocusManagerMarshalMixin/moveFocusToParent()
at mx.managers.marshalClasses::FocusManagerMarshalMixin/focusRequestMoveHandler()
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.managers.marshalClasses::FocusManagerMarshalMixin/setFocusToComponentHandler()
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.managers::FocusManager/setFocusToComponent()
at mx.managers::FocusManager/setFocusToNextObject()
at mx.managers::FocusManager/http://www.adobe.com/2006/flex/mx/internal::keyFocusChangeHandler()
at mx.managers.marshalClasses::FocusManagerMarshalMixin/moveFocus()
at mx.managers.marshalClasses::FocusManagerMarshalMixin/focusRequestMoveHandler()
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.managers.marshalClasses::FocusManagerMarshalMixin/moveFocusToParent()
at mx.managers.marshalClasses::FocusManagerMarshalMixin/focusRequestMoveHandler()
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.managers.marshalClasses::FocusManagerMarshalMixin/setFocusToComponentHandler()
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.managers::FocusManager/setFocusToComponent()
at mx.managers::FocusManager/setFocusToNextObject()
at mx.managers::FocusManager/http://www.adobe.com/2006/flex/mx/internal::keyFocusChangeHandler()
at mx.managers.marshalClasses::FocusManagerMarshalMixin/moveFocus()
at mx.managers.marshalClasses::FocusManagerMarshalMixin/focusRequestMoveHandler()
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.managers.marshalClasses::FocusManagerMarshalMixin/moveFocusToParent()
at mx.managers.marshalClasses::FocusManagerMarshalMixin/focusRequestMoveHandler()
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.managers.marshalClasses::FocusManagerMarshalMixin/setFocusToComponentHandler()
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.managers::FocusManager/setFocusToComponent()
at mx.managers::FocusManager/setFocusToNextObject()
at mx.managers::FocusManager/http://www.adobe.com/2006/flex/mx/internal::keyFocusChangeHandler()
at mx.managers.marshalClasses::FocusManagerMarshalMixin/moveFocus() 
```

根据 Adob​​e 的“[开发沙盒应用程序](http://help.adobe.com/en_US/flex/using/WS2db454920e96a9e51e63e3d11c0bf69084-7f0d.html#WS2db454920e96a9e51e63e3d11c0bf619ab-7feb)”指南，FocusManager 应该可以正常工作，即使跨沙盒、多版本应用程序也是如此。

有人见过这个吗？知道我可能会错过什么吗？

值得注意的是：

*   子应用程序正在加载到 SWFLoader 中，该 SWFLoader 设置为使用单独的 ApplicationDomain
*   我根本不需要在顶级应用程序中支持选项卡，但是当子应用程序中有可编辑的文本字段时，选项卡必须工作。当有文本字段可供选择时，它工作*正常。*

欢迎任何和所有建议。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T14:13:38.110

首先，您的堆栈跟踪似乎不包含在应用程序的 scriptRecursionLimit="1000" 中设置的默认 1000 行。我不知道您的代码限制是否以某种方式或沙盒可以在默认情况下以更严格的方式限制这一点。如我所见，有些行没有重复，因此可能意味着默认行为是正确的，但由于某些限制而无法完成。

其次，如果您找不到修复它的好方法，您可以使用一些解决方法：

```
try{
    dispatchTabPressEventThatCausesProblems();
}catch(e:Error){
    stage.focus = null;
} 
```

# ios - 如何在 Apple Maps 或 Google Maps 中打开链接？

> ID：13924829
> 
> 赞同：23
> 
> 时间：2012-12-18T01:06:10.747
> 
> 标签：ios, google-maps, url-scheme, apple-maps

网站上的链接如何首先指向新的 Google Maps for iOS 应用程序中的位置，如果不可用，则返回到 Apple Maps？

目前，默认功能是`maps.apple.com`在 iOS 上的 Apple Maps 和其他设备上的 Google Maps 中打开一个链接。

最好在 iOS 上扭转这种情况，因为大多数用户似乎更喜欢谷歌地图。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-12-19T03:58:32.170

我认为单个 URL 无法做到这一点。

iOS 版 Google 地图使用以下`comgooglemaps://`架构：

[https://developers.google.com/maps/documentation/ios/urlscheme](https://developers.google.com/maps/documentation/ios/urlscheme)

Apple Maps 应用程序使用`http://maps.apple.com`：

[https://developer.apple.com/library/ios/featuredarticles/iPhoneURLScheme_Reference/MapLinks/MapLinks.html#//apple_ref/doc/uid/TP40007899-CH5-SW1](https://developer.apple.com/library/ios/featuredarticles/iPhoneURLScheme_Reference/MapLinks/MapLinks.html#//apple_ref/doc/uid/TP40007899-CH5-SW1)

我认为你能做的最好的事情就是让用户选择，或者只是使用 Apple 地图运行，因为你会知道它在那里（如果用户代理是 iOS 6）。

# python - 我在哪里可以找到 `lib-dynload` 中的模块源代码？

> ID：13924830
> 
> 赞同：3
> 
> 时间：2012-12-18T01:06:37.987
> 
> 标签：python

许多内置库尽可能使用 C 实现。

例如，在可用时`heapq`使用`lib-dynload/_heapq.so`。

我在哪里可以找到模块的源代码`_heapq`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T01:10:40.810

3.3 版本中许多 C 模块的代码：http:
[//hg.python.org/cpython/file/3.3/Modules](http://hg.python.org/cpython/file/3.3/Modules)

直接链接到 heapq 源：
[http ://hg.python.org/cpython/file/3.3/Modules/_heapqmodule.c](http://hg.python.org/cpython/file/3.3/Modules/_heapqmodule.c)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T01:23:16.533

要查看任何 CPython 版本的代码，请访问：

*   [http://hg.python.org/cpython/file/3.3/](http://hg.python.org/cpython/file/3.3/)

用 3.2、2.3 替换 3.3，不管是旧版本。如果您知道要查找的内容，也可以显式输入 hg 修订号而不是 major.minor 版本。

C 模块大多位于`Modules`子目录中，每个模块通常命名为`foo.c`or `foomodule.c`，而 Python 库位于`Lib`子目录中，命名为`foo.py`。

在 的情况下`heapq`，实际`heapq`模块在 Python ( `Lib/heapq.py`) 中，但它使用名为`_heapq`( `Modules/_heapqmodule.c`) 的 C 模块。

当然你也可以下载源码。[在http://python.org](http://python.org)的首页上，有最新的 2.x 和 3.x 版本的“源代码分发”的“快速链接”，或者您可以单击下载所有其他版本。[如您所料，该结构与您在http://hg.python.org](http://hg.python.org)看到的相同。

# objective-c - 在编译时将选择器转换为其 class_addMethod() 编码

> ID：13924831
> 
> 赞同：3
> 
> 时间：2012-12-18T01:06:38.170
> 
> 标签：objective-c, encode

我在测试工具中有以下 Objective-C 代码，用于一些疯狂的低级代码（不要问）：

```
/* This category is declared here but not defined anywhere.
 * It lets me write
 *   id MyNewClass = objc_lookUpClass("MyNewClass");
 *   [MyNewClass class_method];
 * without spurious compiler warnings.
 */
@interface NSObject (MyNewClass)
+(void) class_method;
+(void) class_method_taking_int: (int) f;
-(int) method_returning_int: (int) i;
@end

...
{
    Class MyNewClass = objc_allocateClassPair([NSObject class], "MyNewClass", 0);
    Class MyNewClass_meta = object_getClass(cls);
    class_addMethod(MyNewClass_meta, @selector(class_method),
        (IMP)..., "v@:");
    class_addMethod(MyNewClass_meta, @selector(class_method_taking_int:),
        (IMP)..., "v@:i");
    class_addMethod(MyNewClass, @selector(method_returning_int:),
        (IMP)..., "i@:i");
    objc_registerClassPair(MyNewClass);
} 
```

我希望能够消除所有这些文字`"v@:i"`等。毕竟，这些应该只是`NSObject (MyNewClass)`类别中列出的方法签名的编码。所以我觉得我应该能够写出类似的东西

```
 class_addMethod(MyNewClass_meta, @selector(class_method_taking_int:),
        (IMP)..., @encode(__typeof__(+[NSObject class_method_taking_int:]))); 
```

当然上面的语法是幻想，但在Objective-C中不应该有这样的*东西吗？*然后我可以把整个事情隐藏在一个简单的宏后面，代码就会很漂亮。

请注意，我*不能*使用`methodSignatureForSelector`，因为它假定我有一个响应给定选择器的对象，而我没有，因为我还没有注册我的类。

另请注意，预期的字符串`class_addMethod`格式与返回的字符串格式不同`@encode(foo)`，实际上`@encode(foo)`根本无法编码函数类型——它只是返回`"?"`或`"^?"`。所以我想我不能从字面上使用`@encode`.

但是有什么我*可以*做的吗？

# javascript - 在 Node Express 路由中包含 Javascript 库

> ID：13924832
> 
> 赞同：0
> 
> 时间：2012-12-18T01:06:41.130
> 
> 标签：javascript, node.js, express

我正在尝试在我的 Express 应用程序中使用 Sanford 加密库（sjcl）。我在我的 app.js 文件中尝试了以下操作：

```
var sjcl = require('.lib/sjcl.js'); 
```

接下来，我尝试在我的 routes/journal.js 文件中调用 sjcl.encrypt，但得到一个未定义的错误。

接下来我尝试在开始时在我的 journal.js 文件中要求该库，但是找不到模块 ./lib/sjcl.js。

sjcl.js 库确实导出了 sjcl 对象，所以这似乎不是它。

关于如何从我的路由器文件中访问 sjcl 库的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T01:13:12.087

> 接下来，我尝试在我的 routes/journal.js 文件中调用 sjcl.encrypt，但得到一个未定义的错误。

`require()`只返回一个表示该模块的对象。
`var x = require(...)`将该对象分配给**局部**变量。
它不会影响其他`.js`文件。

> 接下来我尝试在开始时在我的 journal.js 文件中要求该库，但是找不到模块 ./lib/sjcl.js。

如果您的相对路径错误，就会发生这种情况。

# get - 如何获取写字板或 Microsoft Word 2010 功能区的图标？

> ID：13924833
> 
> 赞同：0
> 
> 时间：2012-12-18T01:07:25.933
> 
> 标签：get, ms-word, icons, ribbon, wordpad

我正在使用 Windows 8 和 Microsoft Office 2010。
您能帮我获取写字板或 Microsoft Word 2010 功能区的图标（粗体、斜体图标等）作为独立图像吗？
非常感谢！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-10-02T07:52:54.773

如果您想获取 MS Office 2010 的独立映像，请使用以下链接：

[http://www.iconarchive.com/tag/office-ribbon](http://www.iconarchive.com/tag/office-ribbon)

并下载相应的图标

# wcf - 如果不再推荐自我跟踪实体，那么变更跟踪复杂实体关系的前进方向是什么？

> ID：13924836
> 
> 赞同：5
> 
> 时间：2012-12-18T01:07:58.687
> 
> 标签：wcf, entity-framework, self-tracking-entities

自从 EF 刚问世以来，我就一直在使用它。曾经在 3.5 中手动构建 POCO，很高兴在 EF4.0 中看到自跟踪实体（STE）。

我在几个非常大的项目（500 多个实体，一些具有多个模型）中使用了 STE。在这些项目中，我使用通用存储库和通用工作单元来保存实体，即 2 个没有映射的小型通用类。通过选择一个核心实体作为“聚合根”，在客户端添加和更新其他实体，包含这些更改的核心实体图被发送到 WCF 服务并在创建存储库的逻辑层中使用<[核心实体]> 并使用 UnitOfWork<[core entity]>.Save(Repository<[core entity]>) 将 STE 及其子项持久保存到数据库中。

现在 Microsoft 建议我们不要使用 STE。[看这篇文章](http://visualstudiogallery.msdn.microsoft.com/a3ac10a5-9365-4096-bb58-d9a1ba71db8f "看这篇文章")

所以我的问题是，微软现在为使用 EF 的 WCF 服务持续客户端更改的应用程序推荐的模式是什么？

我创建了一个 EF5 模型并检查了生成的代码。WCF 服务没有属性，即 DataContract、DataMember 等

EF4 有一个“支持 WCF 的 ADO.NET DbContext Generator”模板，但没有等效的 EF5。

一个站点建议我应该使用部分类文件并使用这些属性装饰该文件中的相同属性。但除非 .net 4.5 引入了部分属性，否则我看不到如何做到这一点。

另一个 [博客](http://www.dotnetconsult.co.uk/weblog2/PermaLink,guid,b9c1ff65-8823-4a5e-ae07-7531c258a5ac.aspx "博客") 建议使用 DTO 和 Automapper，这意味着更多的映射容易出错；特别是当实体字段更改类型时。

所以现在 DBContext 生成的代码类没有启用服务，这是否意味着我们需要编写另一组类（POCO）：

*   查询数据库后需要从 DBContext 生成的代码类进行映射。
*   保存 WCF 服务客户端的数据状态
*   可由该客户端更新
*   由客户端映射
*   具有保持更改状态的能力，因此可以将其发送回 WCF 服务
*   需要映射到 DBContext 生成的代码类进行持久化

**看来我们刚刚向 EF3 迈出了一大步。**

如果您同时编写在硬件上运行的客户端和服务，则无需担心客户端的数据结构，因为它们属于您。

如果您还需要向非.NET 客户端公开一些服务方法，则无论如何都应该为这些服务执行上述 5 点，并在这些情况下使用 DTO 和 Automapper。这些应该在不同的 WCF 服务中，但针对相同的逻辑实现图层，映射后。

但是，在大多数软件团队的 Web 应用程序的日常构建中，会创建多少此类非 .NET 客户端服务？

这个最新的建议令人困惑，因为它没有解释为什么 STE 总是构思不当，以及现在推荐的模式是用于将客户端更改持久化到使用 EF 的 WCF 服务。

谁能告诉我在哪里可以找到解决这个架构设计问题的好资源？

附言

请不要推荐 WCF 数据服务或 WCF RIA，因为我们需要对客户端如何检索和保存数据进行大量控制。

请不要推荐 Code First，因为我们使用 Database First，因为我们希望拥有并且需要控制该数据库的结构，而不必为我们生成。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T06:12:43.373

好的，所以当我第一次阅读这篇文章时，我也有同样的想法，像这样弃用 EF 的整个分支似乎有点奇怪，而且意图并没有很好地传达 (IMO)。我认为这里有几件事很重要：

*   本文中提到的 STE 指的是基于对象上下文的自我跟踪实体（其行为有点像自主上下文）
*   ObjectContext 通常被移走，转而使用更简洁的 DbContext 结构（这适用于 DB first 和 Code First）
*   STEs != DB 第一代，您仍然可以在 EF 中使用 EDMX 模型，这不太可能改变。
*   当我最初看到这篇文章时，我将 STE 误认为是仍然可用的 POCO 代理实体，并且 AFAIK 没有弃用的计划。（这些实现了对变更检测问题的类似技术解决方案，但界面更好。查看这篇文章以了解差异[EF4：POCO 之间的差异，自我跟踪实体，POCO 代理](https://stackoverflow.com/questions/3966797/ef4-difference-between-poco-self-tracking-entities-poco-proxies)

那么，这意味着什么

基本上，就变更跟踪器的旧实现而言，STE 已被弃用，取而代之的是更新形式的变更跟踪（[快照](http://blogs.msdn.com/b/adonet/archive/2009/06/10/poco-in-the-entity-framework-part-3-change-tracking-with-poco.aspx)或[POCO 代理](http://blogs.msdn.com/b/adonet/archive/2009/12/22/poco-proxies-part-1.aspx)）。这意味着如果快照跟踪不适合您，您应该查看类似于旧 STE 的 POCO 代理。

您仍然可以使用所有以前的技术来生成上下文（DB First、Model First、Code First 和 DB-> Code）

# shell - sed 到特定行之后的 grep 行以进行进一步处理

> ID：13924840
> 
> 赞同：0
> 
> 时间：2012-12-18T01:08:30.757
> 
> 标签：shell, sed, tcl

我正在使用一个脚本，该脚本在特定行之后查找文件行并处理它们以从中获取数据。

让我用一个例子来说明，如果文件“sample.log”有类似的行

```
qwerty asdf foo bar
foo 
time: 1:00 PM
foo1 bar1
foo foo fooo copying file abc/def/ghi/foo.txt
bar bar1 bar2 copying file efg/qwe/bar.txt
foo 
```

我的脚本应该在以下时间搜索内容：下午 1:00。找到这些行后，它必须查找与“复制”模式匹配的行并获取该行中指定的路径。

在这种情况下，写入另一个文件的输出应该是

```
abc/def/ghi/foo.txt
efg/qwe/bar.txt 
```

我使用以下命令尝试了此操作，但将空字符串作为输出。请指导我

```
 sed -n '/^time: 1:00 PM/{/^(.*)copying file/s/^(.*)copying file //p}' ../../sample.log 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T03:37:08.767

如果您已经在 Tcl 中，您可以在 Tcl 中编写代码：

```
set fid [open "FILE" r]
set have_time false
while {[gets $fid line] != -1} {
    if {$have_time && [regexp {copying file (.*)} $line -> filename]} {
        puts $filename
    } elseif {[string first "time:" $line] > -1} {
        set have_time true
    }
}
close $fid 
```

如果您的文件很大，`exec sed`可能会更快，但您必须自己查看。

注意，如果你打算`exec sed`，请记住，在 Tcl 内部，单引号没有特殊含义：使用大括号来引用 sed 程序。

```
exec sed -e {do stuff here} FILE 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T01:25:47.857

```
sed '/1:00 PM/,$ {/copying/s:.*file \(.*\):\1:p};d' FILE 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T07:42:46.447

这可能对您有用（GNU sed）：

```
sed -ne '/1:00 PM/,$!b' -e 's/.*copying.* //w copy' file 
```

# arrays - 将 Clojure 协议扩展为原始数组

> ID：13924842
> 
> 赞同：7
> 
> 时间：2012-12-18T01:08:38.337
> 
> 标签：arrays, clojure, protocols, primitive-types

我想扩展一个 Clojure 协议来处理 Java 原始数组。

```
(defprotocol PVectorisable
  (to-vector [a]))

(extend-protocol PVectorisable
  ??????
    (to-vector [coll]
      (Vectorz/create ^doubles coll))
  java.util.List
    ... other implementations......) 
```

这可能吗，如果可以，上面的扩展协议定义中需要做什么（代替“??????”）？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-18T02:01:55.360

最简单的解决方案可能是通过反射以编程方式获取类。

```
(defprotocol do-a-thing
 (print-thing [thing]))

(extend-protocol do-a-thing
 (class (float-array 0))
  (print-thing [_]
   (println "it's a float array"))) 
```

Java 的数组有一些奇怪的名字。例如，浮点数组是`[F`. 如果你尝试直接在 REPL 中使用它，它会阻塞在 unmatched 上`[`。但是，您仍然可以将此名称与例如`Class/forName`.

```
(defprotocol do-another-thing
 (print-another-thing [thing]))

(extend-protocol do-another-thing
 (Class/forName "[F")
  (print-another-thing [_]
   (println "it's still a float array"))) 
```

[本文](http://tutorials.jenkov.com/java-reflection/arrays.html#class)更详细地介绍了数组类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-13T03:11:22.243

正如 hadronzoo 所指出的，Class/forName 解决方案仅在它是 defprotocol 的第一个定义时才有效，这将解决方案限制为每个协议只有一个数组类型（或必须进行多个 defprotocol 定义）。这可以通过宏与多种数组类型一起使用，以避免读取器无法解析数组符号的问题：

```
(defprotocol ISample
  (sample [_]))

(defmacro extend-protocol-arrays []
  (let [ba (symbol "[B")
        ia (symbol "[I")
        oa (symbol "[Ljava.lang.Object;")]
  `(extend-protocol ISample
     ~ba
     (sample [this#] (println "Byte Array"))
     ~ia
     (sample [this#] (println "Int Array"))
     ~oa
     (sample [this#] (println "Object Array")))))

(extend-protocol-arrays)

(sample (byte-array 0))

(sample (int-array 0))

(sample (make-array Object 0)) 
```

# java-me - 如何在 CodeNameOne 中为 Canvas.KEY_NUM2 设置 KeyListener

> ID：13924845
> 
> 赞同：2
> 
> 时间：2012-12-18T01:09:04.723
> 
> 标签：java-me, lwuit, codenameone

我在 LWUIT 中有这段代码，但现在我已经迁移到 CodeNameOne，Canvas 类没有常量 KEY_NUM1、KEY_NUM2 等。而且我无法添加 Key Listener。

form.addKeyListener (Canvas.KEY_NUM1, bListener);

在 CodeNameOne 中哪里可以找到这些常量？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T10:12:11.703

只需使用`'0'`而不是 num1 常量。

# android - 如何更新媒体播放器以播放新文件

> ID：13924848
> 
> 赞同：2
> 
> 时间：2012-12-18T01:09:15.127
> 
> 标签：android, media-player, updates

我有一段代码如下所示，用于获取存储在内容提供程序数据库中的 mp3 音频文件的路径名。接下来，它使用此路径名加载 mp3 文件并开始播放。问题是，如果我得到不同的路径名并点击暂停或播放，它会继续播放相同的旧音频文件，而不是新文件。解决此问题的最佳方法是什么？

```
 String pathName; // pathname of audio file stored in SD card
      String selection = MediaStore.Images.Media.DATA + "='" + pathName +"'";
      String[] projection = { MediaStore.Images.Media.LATITUDE };
      cursor = getContentResolver().query(MediaStore.Images.Media.EXTERNAL_CONTENT_URI, projection, selection, null, null);

      if(cursor!=null){
         cursor.moveToFirst();
        }
        musicName = (String) cursor.getString(cursor.getColumnIndex(MediaStore.Images.Media.LATITUDE));

         Toast.makeText(AudioService.this, "from　AUDIOSERVICE CLASS music name: " + musicName, Toast.LENGTH_SHORT).show();

         cursor.close();    

         player.setDataSource(musicName);

        player.prepare();

        player.start();

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T01:30:17.353

检查路径是否相同，然后再次播放相同的文件，如果文件路径不同，则首先重置媒体播放器，然后播放新文件，将代码更改为：

```
 String pathName=""; // pathname of audio file stored in SD card
       public static String musicName="";
      String selection = MediaStore.Images.Media.DATA + "='" + pathName +"'";
      String[] projection = { MediaStore.Images.Media.LATITUDE };
      cursor = getContentResolver().query(MediaStore.Images.
             Media.EXTERNAL_CONTENT_URI, projection, selection, null, null);

      if(cursor!=null){
         cursor.moveToFirst();
        }

if(musicName.length()==0){
         musicName = (String) cursor.getString(cursor.getColumnIndex(
                                      MediaStore.Images.Media.LATITUDE));

         Toast.makeText(AudioService.this, 
                                    "from　AUDIOSERVICE CLASS music name:
                                      " + musicName, Toast.LENGTH_SHORT).show();

         cursor.close();    

         player.setDataSource(musicName);

        player.prepare();

        player.start();

  }
else{
 String musicNametemp = (String) cursor.getString(cursor.getColumnIndex(
                                          MediaStore.Images.Media.LATITUDE));

if(musicNametemp.equals(musicName)){

///play old music here
}

else{
//reset mediaplayer here

if(player !=null){
 player.reset();
 player.release();
 player = new MediaPlayer();

}
cursor.close();    
musicName=musicNametemp;
player.setDataSource(musicName);

player.prepare();

player.start();
}

} 
```

# php - 为什么我的画廊查看页面会出现错误？

> ID：13924849
> 
> 赞同：-2
> 
> 时间：2012-12-18T01:09:19.740
> 
> 标签：php, codeigniter, gallery

我目前正在使用 codeigniter 在交互式配置文件中开发一个画廊，每个用户都可以上传他们自己的图像部分。目前我的视图页面正在抛出一条消息：未定义的变量：图像。尽管我的模型中已经有一个 get_images 函数，但我的视图中还有一个 if 语句，因此如果尚未上传任何图像，它将理解不要尝试显示图像。我该如何解决这个问题？我还尝试将上传的任何图像存储在图库数据库中，以便在每个用户的名称旁边显示他们上传的任何图像。到目前为止，这是我的代码：

控制器：

```
class Gallery extends CI_Controller {

function __construct()
{
    // Call the parent construct
    parent::__construct();

    $this->load->model("profiles");
    $this->load->model("gal_model");
    $this->load->helper(array('form', 'url'));

    $this->gallery_path = 'web-project-jb/assets/gallery';
    $this->gallery_path_url = base_url().'web-project-jb/assets/gallery/';

}

function upload()
{

    $config = array(

            'allowed_types' =>'gif|jpg|jpeg|png',
            'upload_path' => $this->gallery_path,
            'max_size' => 10000,
            'max_width' => 1024,
            'max_height' => 768);

    $this->load->library('upload', $config);

    $image_data = $this->upload->data();

    $config = array(
            'source_image'  => $image_data["full_path"],
            'new_image'     => $this->gallery_path. '/thumbs',
            'maintain_ration'   => true,
            'width' => 150,
            'height' => 100

    );

    $this->load->library("image_lib", $config);
    $this->image_lib->resize();

    $username = $this->session->userdata('username');

    if ( ! $this->upload->do_upload())
    {
        $error = array('error' => $this->upload->display_errors());

        $username = $this->session->userdata('username');

        $viewData['username'] = $username;

        $this->load->view('shared/header');
        $this->load->view('gallery/galtitle', $viewData);
        $this->load->view('shared/nav');
        $this->load->view('gallery/galview', $error, $viewData, array('error' => ' ' ));
        $this->load->view('shared/footer');

    }
    else
    {
        $file_data  = $this->upload->data();

        $image = $this->gallery_path.$file_data['file_name'];

        $data['image'] = $this->gallery_path.$file_data['file_name'];

        $this->username = $this->session->userdata('username');

        $this->gal_model->putGalleryImage($username, $image);

        $this->session->set_userdata($image);

        $viewData['username'] = $username;
        $data['gal_model'] = $this->gal_model->get_images($username);

        $username = $this->session->userdata('username');

        $this->load->view('shared/header');
        $this->load->view('gallery/galtitle', $viewData);
        $this->load->view('shared/nav');
        $this->load->view('gallery/galview', $data, $viewData);
        $this->load->view('shared/footer');

    }
}

function index()
{

    $username = $this->session->userdata('username');

    $this->load->library('upload');

    $data['profileimages'] = $this->gal_model->get_images($username);

    $file_data = $this->upload->data();

    $file_data['file_name'] = $this->gal_model->get_images($username);

    $image = $this->gallery_path.$file_data['file_name'];

    $data['image'] = $file_data['file_name'];

    $viewData['username'] = $username;

    $this->load->view('shared/header');
    $this->load->view('gallery/galtitle', $viewData);
    $this->load->view('shared/nav');
    $this->load->view('gallery/galview', $viewData, $data, array('error' => ' ' ));
    $this->load->view('shared/footer');

}

 } 
```

模型：

```
 class Gal_model extends CI_Model
{
var $gallery_path;
var $gallery_path_url;

function Gal_model()
{
    parent::__construct();

    $this->gallery_path = 'web-project-jb/assets/gallery';
    $this->gallery_path_url = base_url().'web-project-jb/assets/gallery/';
}   

function exists($username)
{
    $this->db->select('*')->from("gallery")->where('user', $username);
    $query = $this->db->get();

    if ($query->num_rows() > 0)
    {

        return true;
        /*
         echo "user $user exists!";
        $row = $query->row();
        echo " and his profileimage is $row->profileimage";
        */
    }

    else

    {

        return false;
        //echo "no such user as $user!";
    }

}

function putGalleryImage($username, $image)
{

    $record = array('user' => $username, 'galleryimage' => $image);
    $this->session->set_userdata($image);
    if ($this->exists($username))
    {
        $this->db->where('user', $username)->update('gallery', $record);

    }
    else
    {
        $this->db->where('user', $username)->insert('gallery', $record);

    }

}

function get_images($username)
{

    $this->db->select('*')->from('gal_model')->where('user', $username);

    $files = scandir($this->gallery_path);
    $files = array_diff($files, array('.', '..', 'thumbs'));

    $images = array();

    foreach ($files as $file){
        $images[] = array(
            'url'   => $this->gallery_path_url.$file,
            'thumb_url' => $this->gallery_path_url.'thumbs/'.$file

                );

    }

    return $images;
}

  } 
```

看法：

```
 <?php if ( is_array($images) && (count($images)>0) ):
   foreach($images as $image): ?>
   <div class="thumb">
       <a href="<?php echo $image['url']; ?>">
          <img src ="<?php echo $image['thumb_url']; ?>"/>
       </a>  
       <br>
   </div>
<?php endforeach; else:  ?>
    <div id = "blank_gallery">Please upload an Image</div>
<?php endif; ?> 
```

再次感谢所有的帮助家伙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T01:15:20.833

如果我在这里错了，请纠正我，但似乎您从未将 $images 分配给视图。你分配`$image`和`$profileimages`，`index()`但我没有看到`$images`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T01:17:47.970

您应该将您的 if 在您的视图中更改为

```
if(isset($images) && is_array($images)) 
```

这样，如果 $images in undefined 它不会抛出一个错误，它只会一起跳过它

# arrays - 在 EXCEL 中使用多个表的条件 SUM

> ID：13924851
> 
> 赞同：3
> 
> 时间：2012-12-18T01:09:47.500
> 
> 标签：arrays, excel, lookup

我有一个表，我试图根据两个参考表的值来填充。

我有各种不同的项目“类型 1”、“类型 2”等，每个项目运行 4 个月，并且根据其生命周期中的时间不同花费不同的金额。这些成本计算显示在 中`Ref Table 1`。

参考表 1

```
Month    |  a  |  b  |  c  |  d
---------------------------------
Type 1   |  1  |  2  |  3  |  4
Type 2   |  10 | 20  |  30 |  40
Type 3   | 100 | 200 | 300 | 400 
```

`Ref Table 2`显示我未来 3 个月的项目计划。1 月份开始有 2 个新的，一个是 a `Type 1`，另一个是 a `Type 2`。2 月，我将有 4 个项目，前两个项目进入第二个月，两个新项目开始，但这次是 Type 1 和 Type 3。

参考表 2

```
Date    | Jan | Feb | Mar
--------------------------
Type 1  |  a  |  b  |  c
Type 1  |     |  a  |  b
Type 2  |  a  |  b  |  c
Type 2  |     |     |  a
Type 3  |     |  a  |  b 
```

我想创建一个表格来计算每个项目类型每月花费的总成本。示例结果如下`Results`表所示。

结果

```
Date    | Jan | Feb | Mar
-------------------------------
Type 1  |  1  |  3  |  5
Type 2  |  10 |  20 |  40
Type 3  |  0  | 100 | 200 
```

我试着用一个数组公式来做：

```
Res!b2 = {sum(if((Res!A2 = Ref2!A2:A6) * (Res!A2 = Ref1!A2:A4) * (Ref2!B2:D6 = Ref1!B1:D1), Ref!B2:E4))} 
```

但是它不起作用，我相信这是因为第三个条件试图将一个向量与另一个向量而不是单个值进行比较。

有谁知道我该怎么做？乐于使用数组、索引、匹配、向量、查找，但不是 VBA。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T10:49:25.010

假设结果表标题中的月份与参考表 2 的顺序相同（根据您的示例），然后在 Res!B2 中尝试此公式

`=SUM(SUMIF(Ref1!$B$1:$E$1,IF(Ref2!$A$2:$A$6=Res!$A2,Ref2!B$2:B$6),INDEX(Ref1!$B$2:$E$4,MATCH(Res!$A2,Ref1!$A$2:$A$4,0),0)))`

确认`CTRL+SHIFT+ENTER`并向下复制

这给了我与您在结果表中获得的结果相同的结果

如果月份的顺序可能不同，那么您也可以添加一些东西来检查 - 我假设结果表行标签中的类型可能与参考表 1 的顺序不同，但如果它们也总是顺序相同（根据您的示例）然后`INDEX/MATCH`可以将末尾的部分简化为单个范围

# android - Android Proguard Mongodb

> ID：13924855
> 
> 赞同：1
> 
> 时间：2012-12-18T01:10:06.060
> 
> 标签：android, mongodb, proguard, bson

当我尝试导出我的 Android 项目时，Proguard 会抱怨。这是我遇到的错误。

```
[2012-12-17 16:52:46] Proguard returned with error code 1\. See console

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class java.lang.management.ManagementFactory

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.remote.JMXServiceURL

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.remote.JMXServiceURL

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.remote.JMXConnectorFactory

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.remote.JMXConnector

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.remote.JMXConnector

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.ObjectName

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.ObjectName

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.MBeanServerConnection

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.ObjectName

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.MBeanServerConnection

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.openmbean.CompositeData

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.openmbean.CompositeData

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.openmbean.CompositeData

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.JMException

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.InstanceNotFoundException

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.ReflectionException

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.AttributeNotFoundException

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.MBeanException

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class java.lang.management.ManagementFactory

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.remote.JMXConnectorFactory

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.remote.JMXConnector

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.MBeanServerConnection

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.MBeanServerConnection

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.MBeanServerConnection

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.MBeanServerConnection

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.remote.JMXServiceURL

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.remote.JMXConnector

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.MBeanServerConnection

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.ObjectName

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.ObjectName

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.ObjectName

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.ObjectName

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.openmbean.CompositeData

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.openmbean.CompositeData

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.openmbean.CompositeData

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.openmbean.CompositeData

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.openmbean.CompositeData

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.openmbean.CompositeData

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.openmbean.CompositeData

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.openmbean.CompositeData

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.openmbean.CompositeData

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.openmbean.CompositeData

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.openmbean.CompositeData

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.openmbean.CompositeData

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.openmbean.CompositeData

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.openmbean.CompositeData

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.openmbean.CompositeData

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.ObjectName

[2012-12-17 16:52:46] Warning: com.mongodb.tools.ConnectionPoolStat: can't find referenced class javax.management.ObjectName

[2012-12-17 16:52:46] Warning: com.mongodb.util.management.jmx.JMXMBeanServer: can't find referenced class java.lang.management.ManagementFactory

[2012-12-17 16:52:46] Warning: com.mongodb.util.management.jmx.JMXMBeanServer: can't find referenced class javax.management.MBeanServer

[2012-12-17 16:52:46] Warning: com.mongodb.util.management.jmx.JMXMBeanServer: can't find referenced class javax.management.MBeanServer

[2012-12-17 16:52:46] Warning: com.mongodb.util.management.jmx.JMXMBeanServer: can't find referenced class javax.management.InstanceNotFoundException

[2012-12-17 16:52:46] Warning: com.mongodb.util.management.jmx.JMXMBeanServer: can't find referenced class javax.management.MBeanRegistrationException

[2012-12-17 16:52:46] Warning: com.mongodb.util.management.jmx.JMXMBeanServer: can't find referenced class javax.management.MBeanServer

[2012-12-17 16:52:46] Warning: com.mongodb.util.management.jmx.JMXMBeanServer: can't find referenced class javax.management.InstanceAlreadyExistsException

[2012-12-17 16:52:46] Warning: com.mongodb.util.management.jmx.JMXMBeanServer: can't find referenced class javax.management.NotCompliantMBeanException

[2012-12-17 16:52:46] Warning: com.mongodb.util.management.jmx.JMXMBeanServer: can't find referenced class javax.management.ObjectName

[2012-12-17 16:52:46] Warning: com.mongodb.util.management.jmx.JMXMBeanServer: can't find referenced class javax.management.ObjectName

[2012-12-17 16:52:46] Warning: com.mongodb.util.management.jmx.JMXMBeanServer: can't find referenced class javax.management.MalformedObjectNameException

[2012-12-17 16:52:46] Warning: com.mongodb.util.management.jmx.JMXMBeanServer: can't find referenced class java.lang.management.ManagementFactory

[2012-12-17 16:52:46] Warning: com.mongodb.util.management.jmx.JMXMBeanServer: can't find referenced class javax.management.MBeanServer

[2012-12-17 16:52:46] Warning: com.mongodb.util.management.jmx.JMXMBeanServer: can't find referenced class javax.management.MBeanServer

[2012-12-17 16:52:46] Warning: com.mongodb.util.management.jmx.JMXMBeanServer: can't find referenced class javax.management.InstanceNotFoundException

[2012-12-17 16:52:46] Warning: com.mongodb.util.management.jmx.JMXMBeanServer: can't find referenced class javax.management.MBeanRegistrationException

[2012-12-17 16:52:46] Warning: com.mongodb.util.management.jmx.JMXMBeanServer: can't find referenced class javax.management.InstanceAlreadyExistsException

[2012-12-17 16:52:46] Warning: com.mongodb.util.management.jmx.JMXMBeanServer: can't find referenced class javax.management.MBeanRegistrationException

[2012-12-17 16:52:46] Warning: com.mongodb.util.management.jmx.JMXMBeanServer: can't find referenced class javax.management.NotCompliantMBeanException

[2012-12-17 16:52:46] Warning: com.mongodb.util.management.jmx.JMXMBeanServer: can't find referenced class javax.management.ObjectName

[2012-12-17 16:52:46] Warning: com.mongodb.util.management.jmx.JMXMBeanServer: can't find referenced class javax.management.MalformedObjectNameException

[2012-12-17 16:52:46] Warning: org.bson.types.ObjectId: can't find referenced class java.lang.management.ManagementFactory

[2012-12-17 16:52:46] Warning: org.bson.types.ObjectId: can't find referenced class java.lang.management.RuntimeMXBean

[2012-12-17 16:52:46] Warning: org.bson.types.ObjectId: can't find referenced class java.lang.management.ManagementFactory

[2012-12-17 16:52:46] Warning: org.bson.types.ObjectId: can't find referenced class java.lang.management.RuntimeMXBean

[2012-12-17 16:52:46]       You should check if you need to specify additional program jars.

[2012-12-17 16:52:46] Warning: there were 75 unresolved references to classes or interfaces.

[2012-12-17 16:52:46]          You may need to specify additional library jars (using '-libraryjars').

[2012-12-17 16:52:46] java.io.IOException: Please correct the above warnings first.

[2012-12-17 16:52:46] at proguard.Initializer.execute(Initializer.java:321)

[2012-12-17 16:52:46] at proguard.ProGuard.initialize(ProGuard.java:211)

[2012-12-17 16:52:46] at proguard.ProGuard.execute(ProGuard.java:86)

[2012-12-17 16:52:46] at proguard.ProGuard.main(ProGuard.java:492) 
```

解决这些错误的必要 Proguard 说明是什么？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T04:35:15.420

由 Chartboost 引起。

```
-dontwarn javax.**
-dontwarn java.lang.management.**

-keep class javax.** { *; }
-keep class java.lang.management.** { *; } 
```

# shell - Unix tar：不保留完整路径名

> ID：13924856
> 
> 赞同：22
> 
> 时间：2012-12-18T01:10:09.713
> 
> 标签：shell, unix, tar

当我尝试`tar`使用绝对路径压缩文件和目录时，绝对路径会保留在生成的压缩文件中。我需要使用绝对路径来告诉`tar`我要压缩的文件夹的位置，但我只希望它压缩那个文件夹——而不是整个路径。

比如`tar -cvzf test.tar.gz /home/path/test`——我要压缩文件夹的地方`test`。但是，我实际上最终压缩的是`/home/path/test`. 有什么办法可以避免这种情况吗？我试过玩 -C 操作数无济于事。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2014-09-19T11:11:29.217

这很难看……但它有效……

我遇到了同样的问题，但是有多个文件夹，我只想将每个文件都展平。您可以使用选项“transform”来传递 sed 表达式，并且......它按预期工作。

这是表达式：

`'s/.*\///g'` （删除“/”之前的所有内容）

这是最后的命令：

```
tar --transform 's/.*\///g' -zcvf tarballName.tgz */*/*.info 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2012-12-18T01:17:04.183

用于`-C`指定*文件看起来像您想要*的目录，然后*指定从该目录看到的文件*：

```
tar -cvzf test.tar.gz -C /home/path test 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-09-18T19:32:08.367

多目录示例

tar cvzf my.tar.gz example.zip -C dir1 files_under_dir1 -C dir2 files_under_dir2

dir 1/2 下的文件不应该有路径。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-20T16:01:26.173

tar 可以在进出存档的过程中对文件名执行转换。考虑这个将一堆文件存储在平面 tar 文件中的示例：

# 在根 ~/ 目录中

```
find logger -name \*.sh | tar -cvf test.tar -T - --xform='s|^.*/||' --show-transformed 
```

该`-T -`选项告诉 tar 从标准输入读取文件列表，`--xform='s|^.*/||'`将 sed 表达式应用于所有文件名，就像它们被读取之后和存储之前一样。--show-transformed 只是在转换后向您显示文件名的好处，默认是在读取时显示名称。除了使用 find 指定要归档的文件之外，毫无疑问还有其他方法。例如，如果您已`dotglob`在 bash 中设置，则可以使用 ** 模式来通配任意数量的目录，将前面的缩短为：

```
tar -cvf test.tar --xform='s|^.*/||' --show-transformed logger/**/*.sh 
```

鉴于您所追求的文件，您必须判断什么最适合您的情况。

# php - 设计我自己的 PHP 框架.....我怎样才能让它开源并让其他人构建它？

> ID：13924859
> 
> 赞同：0
> 
> 时间：2012-12-18T01:10:26.507
> 
> 标签：php, frameworks, open-source

所以我设计了我自己的自定义 PHP 框架，它现在比 YII 快 10 倍。显然它没有 YII 那么多的花里胡哨，但它是一个非常快速的 MVC 框架，仅依赖于数据库来存储用户内容而没有其他任何东西。我不知道在哪里发布我的代码，以便其他人可以使用它并做出贡献。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T01:18:53.907

我会选择 Sourceforge，它是一个很棒的开源社区/存储库。Sourceforge - [http://sourceforge.net/](http://sourceforge.net/)

# random - 极少数数字的顽固随机数测试器

> ID：13924874
> 
> 赞同：0
> 
> 时间：2012-12-18T01:12:09.293
> 
> 标签：random

我正在尝试测试 100 个不同的 100 个随机人类生成的数字的随机性，与 100 个不同的 100 个计算机生成的随机数字的随机性进行比较，但是顽固的程序想要一组大约 100000 个数字。我想知道是否可以通过使用人类数字作为伪数生成器的种子，并使用输出作为数字来测试顽固程序，将人类集合组合成一个 100000 个数字的块。我会对具有相同伪随机发生器的计算机组做同样的事情。如果我要证明的只是计算机生成的数字比人类生成的数字更随机，这实际上会改变随机性的结果吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T15:04:09.373

您可以尝试仅连接数字。我认为任何组合都不会始终比其他组合好很多。任何组合数字的方式都会导致它们失去一些属性（可能包括通过某些测试对“随机”的分类），无论如何（在某些情况下某些组合比其他组合更多，但如果我们正在处理随机数，你可以' t真的预测很多）。

我不确定您为什么要将这些数字用作另一个随机数生成器的种子（如果我理解正确的话）。这不会产生任何有用的适用结果。如果您使用随机数生成器，您将从伪随机集中获得一系列数字，种子将仅确定您从该集合中的哪个位置开始，从任何种子开始都应该像从任何其他种子开始一样产生随机结果。

任何所谓的随机性测试充其量只能说某些集合可能是随机的。没有测试可以准确地测量真正的随机性，这可能与随机性的定义相矛盾。

# python - Python 构造左手系数矩阵：

> ID：13924877
> 
> 赞同：-3
> 
> 时间：2012-12-18T01:12:50.757
> 
> 标签：python

构造左侧系数矩阵：编写一个函数，当给定化学物质列表和元素列表时，将返回一个二维数组，表示 (3) 或 (7) 中的右侧系数矩阵 A . 示例：使用 ['CO', 'H2O', 'CO2'] 和 ['C', 'H', 'O'] 的输入调用您的函数应该返回 array([[1, 0, 1]，[0,2,0]，[1,1,2]]）。提示：列向量 c1, c2, c3 和 c4 在 SciPy 中可以用 c [c1, c2, c3, c4] 组装成一个矩阵。

所以我在考虑 import scipy 但我不知道如何开始......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T01:22:28.623

不要导入任何模块来解决此任务。这太容易了。但由于这是一个如此基本的问题，我只会给你一些你可以使用的简单想法。据我所知，问题是返回一个二维列表，其中每个原子的数量在适当的索引中表示。鉴于此，任务实际上只是迭代每个元素中的每个字符，以查看是否有匹配项。随后，使用 isdigit() 方法检查下一个字符是否为数字。

# html - 如何摆脱选择输入边框

> ID：13924881
> 
> 赞同：0
> 
> 时间：2012-12-18T01:13:18.360
> 
> 标签：html, css

![带边框选择](../Images/05d8d9a8e5f4666651270be8db9a81e4.png)

如何摆脱图像后面的白色背景？

CSS：我认为 webkit 可以解决问题，但事实并非如此

```
 <style>
 .qq {
    background-image: url('../images/select-category.png');
    width: 148px;
    height:34px;
    -webkit-appearance: none;
  }
 </style> 
```

HTML：

```
 <div style="float:left;">
      <form>
          <select id="basic" class="qq" onchange="showFolders(this.value)">
              <?php
                  foreach ($folder as $t)
                  {
                      echo '<option value="'.$t['folder_id'].'">'.$t['name'].'</option>';
                  }
              ?>  
          </select>
      </form>
  </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T01:22:07.763

我能想到的唯一问题是你的形象另一方面你可以试试

```
 img{
       background-color:transparent;
       border:none;
    } 
```

*并制作一个纯 css3 按钮[http://www.cssbuttongenerator.com/](http://www.cssbuttongenerator.com/)*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T01:16:26.830

该白色背景*可能*存在于您的图像文件 select-category.png 中。要删除它，您需要编辑图像文件本身。

如果不是，那么它来自*其他地方*。请提供一个独立的小示例，其中包含足够的代码来演示问题，没有任何额外内容。将此代码发布到问题中，或在 JSFiddle (jsfiddle.net) 中。确保此示例具有 HTML（不是 PHP）并包含您的图像文件。

# java - 在 ImageIcon Java Swing 上放置“标记”的最佳方式？

> ID：13924884
> 
> 赞同：0
> 
> 时间：2012-12-18T01:13:32.177
> 
> 标签：java, swing, imageicon

我有一个 Java swing 应用程序，我在其中创建了`ImageIcon`一张图片并将其显示到屏幕上。我通过将 URL 加载为 an`ImageIcon`并将其作为标签放置在 Java Swing 窗口中来做到这一点。

现在我需要用其他图像在图像上放置“标记”。在上下文中：将眼睛的照片放在某人的脸上，放在他们的眼睛上。

我很感激任何能指出我正确方向或给我一些 SSCCE 代码的人。

`ImageIcon`在Java Swing上放置“标记”的最佳方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T01:51:31.600

基本概念是，您需要一个临时图像，您可以在其上绘制主/基本图像和标记。

1.  创建一个新的`BufferedImage`. 这通常与主图像大小相同，但并非必须如此。
2.  将主图像绘制到`BufferedImage`
3.  将记号笔涂在`BufferedImage`
4.  使用创建一个新`ImageIcon`的`BufferedImage`
5.  应用`ImageIcon`到标签...

![在此处输入图像描述](../Images/17fcfed5c3c0018dfe93997f506f9d60.png)![在此处输入图像描述](../Images/d732e3769992a13c446add8b1079630e.png)![在此处输入图像描述](../Images/615a24e78f67c85667aafd672d70d872.png)

```
public class PaintIcon {

    public static void main(String[] args) {
        new PaintIcon();
    }

    public PaintIcon() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new PaintPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class PaintPane extends JPanel {

        private JLabel label;
        private int state = 0;

        private BufferedImage disk;
        private BufferedImage play;
        private BufferedImage pause;
        private BufferedImage stop;

        public PaintPane() {

            setLayout(new GridBagLayout());
            add((label = new JLabel()));

            try {
                disk = ImageIO.read(getClass().getResource("/cd.png"));
                play = ImageIO.read(getClass().getResource("/media_play.png"));
                pause = ImageIO.read(getClass().getResource("/media_pause.png"));
                stop = ImageIO.read(getClass().getResource("/media_stop.png"));
            } catch (Exception e) {
                e.printStackTrace();
            }

            updateState();

            label.addMouseListener(new MouseAdapter() {
                @Override
                public void mouseClicked(MouseEvent e) {
                    state++;
                    if (state > 2) {
                        state = 0;
                    }
                    updateState();
                }
            });
        }

        protected void updateState() {
            BufferedImage base = new BufferedImage(disk.getWidth(), disk.getHeight(), BufferedImage.TYPE_INT_ARGB);
            Graphics2D g2d = base.createGraphics();
            g2d.drawImage(disk, 0, 0, this);
            BufferedImage marker = null;
            switch (state) {
                case 0:
                    marker = stop;
                    break;
                case 1:
                    marker = play;
                    break;
                case 2:
                    marker = pause;
                    break;
            }
            int x = disk.getWidth() - marker.getWidth();
            int y = disk.getHeight() - marker.getHeight();
            g2d.drawImage(marker, x, y, this);
            g2d.dispose();

            label.setIcon(new ImageIcon(base));
        }
    }
} 
```

# visual-studio-2010 - 通过 EnvDTE 插件从 C++ 解决方案中删除项目时，Visual Studio 崩溃

> ID：13924891
> 
> 赞同：0
> 
> 时间：2012-12-18T01:14:24.033
> 
> 标签：visual-studio-2010, access-violation, envdte

我编写了一个插件来修改（C++，最有可能，但可能是包含 C++ 的点网）解决方案。

加载项似乎运行成功。

有时，在保存后，甚至在成功构建使用插件修改的解决方案后，VisualStudio 崩溃。如果我不保存它也会崩溃，如果我尝试关闭而不保存它会崩溃。只是……不是每次。

该代码在确定它不需要解决方案中的某些项目后，会尝试删除它们， http: [//msdn.microsoft.com/en-us/library/envdte._solution.remove(v=vs.100) .aspx](http://msdn.microsoft.com/en-us/library/envdte._solution.remove(v=vs.100).aspx) - 在 try-catch 中 - 并且删除成功。

就像我说的，我可以保存，然后，解决方案保存并正确构建......

唯一的问题是，当我尝试关闭解决方案或 Visual Studio 时，它崩溃了——严重。它也可能在插件完成后崩溃，稍后……未确定。

为了排除故障，我最终添加了

```
try
{
  solution.Close(false);
}
catch (System.Exception e)
{
  MessageBox.Show(e.Message);
} 
```

我得到一个错误：

```
System.AccessViolationException: Attempted to read or write protected memory. This is often an indication that other memory is corrupt. 
```

我不想通过代码关闭解决方案，我只是不想让 Visual Studio 崩溃。

现在，我已经用`solution.Remove(projectToRemove)`MessageBox 替换了 - 我的代码很开心 - 并且无法执行它的工作。

谢谢你的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T16:30:47.060

答案 - 虽然不令人满意：我的代码受源代码控制 - 我有 VisualHg - 并且在代码完成后 - 从 AddIn 返回后 - VisualHg 是引发异常的那个。

据我所知 - 并通过放弃解决了问题 - 我的 AddIn 最终会告诉用户他应该删除哪些项目 - 但不会自己删除它们。

或许有一天……

# iphone - 在 iOS 的自定义视图中以编程方式创建的按钮未触发事件

> ID：13924900
> 
> 赞同：3
> 
> 时间：2012-12-18T01:15:37.267
> 
> 标签：iphone, objective-c, ios, uibutton

在 iOS 上，我以编程方式创建了一个按钮，但事件没有触发。

```
UIButton * anyButton = [UIButton buttonWithType:UIButtonTypeRoundedRect];
[anyButton addTarget:self action:@selector(handleAnyButton:) forControlEvents:UIControlEventTouchUpInside];
anyButton.frame = CGRectMake(150, 350, 22, 22);
[self addSubview:anyButton]; 
```

代码放置在自定义视图（不是自定义视图控制器）中，但我不能让它触发事件。没有显示新闻动画。自定义视图启用了 userInteractionEnabled。我还尝试使用情节提要在同一视图上创建另一个按钮，并且该按钮正在工作。按钮代码在 initWithFrame 中完成。一定是一些我没有发现的简单错误，我已经为此苦苦思索了好几个小时。

编辑：

事件处理程序：

```
-(void) handleAnyButton:(UIButton *)button
{
    NSLog(@"handleAnybutton called");
} 
```

EDIT2：上述按钮代码在 PKLocationsSelectionView 类的 [self setup] 中完成。

```
- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
        [self setup];
    }
    return self;
} 
```

这个视图是在负责这个层次结构的视图控制器（PKLocSelectionViewController）中以编程方式创建的：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.

    CGFloat fieldsHeight = 88;
    UIView * view = [[PKLocationsSelectionView alloc] initWithFrame:CGRectMake(0, 0, self.view.bounds.size.width, fieldsHeight)];

    [self.view addSubview:view];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T03:50:32.700

It looks like your button frame

```
anyButton.frame = CGRectMake(150, 350, 22, 22); 
```

is outside of parent bounds

```
CGFloat fieldsHeight = 88;
UIView * view = [[PKLocationsSelectionView alloc] initWithFrame:CGRectMake(0, 0, self.view.bounds.size.width, fieldsHeight)]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T03:51:21.183

尝试更改您的 View 初始化代码`viewDidLoad`，以提供静态框架并查看它是否有效。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.

    CGFloat fieldsHeight = 88;
    //See the change in below line.. instead of using self.view.bounds.size.width
    // I used a static width.. 320 pixel for the moment..
    UIView * view = [[PKLocationsSelectionView alloc] initWithFrame:CGRectMake(0, 0, 320.0, fieldsHeight)];

    [self.view addSubview:view];
} 
```

在`viewDidLoad`视图中，控制器的层次结构不会完全绘制出来`self.view.bounds.size.width`。所以可能会给出不正确的值。要访问`self.view.frame`and `self.view.bounds`，您至少应该等到`viewWillAppear`被调用。

此外，您的按钮 origin.y 位于 350 处，在最大高度仅为 88 的视图中。父框架之外的任何控件都不会收到触摸。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T03:37:07.220

这是对我有用的代码：

```
MyCustomView.m: 

#import "MyCustomView.h"

@implementation MyCustomView

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code

        UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
        button.frame = CGRectMake(0, 0, 100, 100);
        [button addTarget:self action:@selector(greet:) forControlEvents:UIControlEventTouchUpInside];
        [button setTitle:@"Greet" forState:UIControlStateNormal];

        [self addSubview:button];

        self.backgroundColor = [UIColor greenColor];

    }
    return self;
}

-(void) greet:(id) sender
{
    NSLog(@"greet!");
} 
```

这是 ViewController.m：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    MyCustomView *view = [[MyCustomView alloc] init];
    view.frame = CGRectMake(0, 0, 100, 100);
    [self.view addSubview:view];

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-18T01:25:30.793

EDIT2：可能是按钮没有完全封闭在容器（PKLocationsSelectionView）视图的坐标中吗？

PKLocationsSelectionView 的高度是您的代码中的 88，并且按钮的位置似乎在此之外。我认为如果按钮没有包含在超级视图的框架内，那么它将不会收到触摸。

# php - 我可以在数据库中显示热链接图像吗？

> ID：13924905
> 
> 赞同：-3
> 
> 时间：2012-12-18T01:15:59.990
> 
> 标签：php, mysql, database, hotlinking

我想知道是否可以使用数据库在我的网站上显示来自像 imageshack 之类的网站的图像，例如，我在数据库中的某个位置使用 URL，当我显示该数据时，图片也会显示。

是否有可能做到这一点，如果可以，我应该怎么做？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-18T01:24:01.953

这里的其他评论者是正确的。只需将带有正确链接的标签作为文本存储在数据库中。

您可以存储它，但是不能在数据库中显示它，因为数据库只保存数据。这将需要另一种语言，例如 Java、Python、PHP 或任何具有数据库访问器类的语言。

# android - 如何实现更改监听器

> ID：13924909
> 
> 赞同：0
> 
> 时间：2012-12-18T01:16:36.747
> 
> 标签：android, listener

如果我有一个变量，字符串 X；我如何为它实现一个changelistener？我想在另一个活动中拥有变量并监视服务中变量值的任何变化。如果发生变化，可能通过发送广播意图。

这是我正在寻找的价值变化。如果字符串是相同的字符串，或者字符串已被替换为不同的字符串。并能够以布尔方式表达这一点。相同值不变时为真，值改变时为假。

# xorg - X 在 X 中的窗口中

> ID：13924914
> 
> 赞同：0
> 
> 时间：2012-12-18T01:17:11.883
> 
> 标签：xorg

如何在旧 X 的窗口中创建新 X？新X的定制`.xinitrc`会很好。我打算将它用于 WM 修补，所以我不会破坏我当前正在运行的 WM。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T01:28:20.227

~~使用[Xnest](http://www.xfree86.org/4.2.0/Xnest.1.html)。~~

使用[Xephyr](http://www.freedesktop.org/wiki/Software/Xephyr)。它是一个 X 服务器，其后端是一个 X 窗口。

* * *

来自 packages.debian.org 的推荐：

> 建议使用 Xephyr X 服务器而不是 Xnest。

— [https://packages.debian.org/wheezy/xnest](https://packages.debian.org/wheezy/xnest)

> Xephyr 是一个 X 服务器，可以在另一个 X 服务器中运行，很像 Xnest。它基于 kdrive X 服务器，因此它支持比 Xnest 更新的扩展，包括渲染和合成。

— [https://packages.debian.org/wheezy/xserver-xephyr](https://packages.debian.org/wheezy/xserver-xephyr)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T02:10:12.363

[您可以使用VirtualBox](https://www.virtualbox.org)运行虚拟机。

这样做的好处是你几乎可以修改任何东西。如果你把自己弄成一个洞，没问题；只需恢复到快照或重新安装虚拟机。

# java - 每秒 Java 鼠标输入

> ID：13924915
> 
> 赞同：-2
> 
> 时间：2012-12-18T01:17:14.233
> 
> 标签：java, button, mouseevent

我正在编写一个使用鼠标操作的 Java 游戏。我在我的主课上有一个观点`msc`——每当我按下鼠标时它就会改变，`(0, 0)`每当我释放鼠标时它就会被设置为。对于按钮，他们检查是否`msc`在其矩形内，如果是，则调用`click`.

其中一个按钮应该切换布尔值；但是，当我单击它时，它会非常快速地切换真假，因为`msc`每次`paintComponent`调用都会更新。

这是按钮单击方法的代码：

```
if (button.contains(Screen.msc)) {
    beenClicked = true;
    this.width = this.width - 2;
    this.height = this.height - 2;
    this.x = this.x + 1;
    this.y = this.y + 1;
    g.setColor(currColor);
    textColor = Color.YELLOW;
} 
```

但这不是我认为的问题所在。这是更改的代码`msc`：

```
public void mouseReleased(MouseEvent e) {
    Screen.msc = new Point(0, 0);
}

public void mousePressed(MouseEvent e) {
    Screen.msc = new Point((e.getX()) - ((Frame.size.width - Screen.myWidth) / 2), e.getY() - ((Frame.size.height - (Screen.myHeight)) - (Frame.size.width - Screen.myWidth) / 2));
} 
```

以及单击特定切换按钮时发生的情况的代码：

```
if (toggleToolTips.clicked()) {
    if (Screen.canDrawTooltip) {
        Screen.canDrawTooltip = false;
    } else if(!Screen.canDrawTooltip){
        Screen.canDrawTooltip = true;
    }
} 
```

问题是每次我点击按钮时，布尔值都会快速来回切换。当我握住它时，它会快速而不断地切换。我想这样做，以便我单击一次并切换一次。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T05:31:43.157

您设置了布尔值`beenClicked`，但没有在任何地方检查它。我建议尝试

```
if (!beenClicked && toggleToolTips.clicked()) 
{   
    Screen.canDrawTooltip = !Screen.canDrawTooltip);
} 
```

`beenClicked`并在某个地方（例如 mouseReleased）设置回 false。

# java - 带有 jlabels 的表，每个 jlabel 里面都会有一个图像（java）

> ID：13924919
> 
> 赞同：-3
> 
> 时间：2012-12-18T01:17:50.970
> 
> 标签：java, swing, jtable

我是java新手。

我想在 Eclipse 中做一个项目，它由一个`JTable`包含 10 列和 7 行的表（带有 ）组成。并在此表的每个单元格中创建一个`JLabel`我将放置图像的位置。

我已经在互联网上搜索过，我已经能够收取一些图像的费用，仅此而已。

你能帮我做点什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T04:39:57.710

首先欢迎来到SO。在尝试解决您的问题之前，您需要了解，

*   [如何使用表格。](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html)
*   [如何使用表模型](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#data)
*   [如何使用渲染和编辑](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#editrender)

在完成上述主题和示例后，您将能够解决您的问题，即，

> ..这张桌子的每个盒子都是`JLabel`我放一张图片的地方。

SO上有很多[帖子](https://stackoverflow.com/questions/4941372/how-to-insert-image-into-jtable-cell)（camickr的一个例子）可以在SO上找到如何`render`在单元格中绘制图像`JTable`。请通过它们。

# version-control - 我怎样才能获得可以按线性顺序干净应用的 mercurial 补丁列表？

> ID：13924922
> 
> 赞同：1
> 
> 时间：2012-12-18T01:18:20.170
> 
> 标签：version-control, mercurial, revision-history

我正在寻找一个命令，该命令将输出一个顺序补丁列表，如果存储库处于特定的已知早期状态，这些补丁将干净地应用。这是一个`hg glog`包含我遇到的一些问题的存储库（如果您想使用自己的克隆，也可以从[https://bitbucket.org/dusty/funny_repo/获得）：](https://bitbucket.org/dusty/funny_repo/)

```
@  changeset:   8:ffd749c92f3b
|  tag:         tip
|  summary:     h
|
o    changeset:   7:bc959885f6aa
|\   parent:      6:dfe021fa52a4
| |  parent:      5:4d8bc738f0ab
| |  summary:     MERGE
| |
| o  changeset:   6:dfe021fa52a4
| |  parent:      3:1374ea53e7b7
| |  summary:     e
| |
o |  changeset:   5:4d8bc738f0ab
| |  branch:      branch2
| |  summary:     g
| |
o |  changeset:   4:e46fa4632d36
|/   branch:      branch2
|    summary:     f
|
o  changeset:   3:1374ea53e7b7
|  summary:     d
|
o  changeset:   2:59712a781f0c
|  branch:      branch1
|  summary:     c
|
o  changeset:   1:ff7f8724ad17
|  branch:      branch1
|  summary:     b
|
o  changeset:   0:a3b3a87aa422
   summary:     a 
```

本质上，我想知道要传递什么 revset 以`hg export`输出变更集 0、1、2、3、6、7 和 8。我不想要变更集 4 和 5，因为应用了这些变更集的“效果”在变更集 6 的合并提交中。

`ancestors(default)`输出所有变更集，但`branch('default')`忽略变更集 1 和 2，虽然它们在不同的分支上，但补丁需要干净地应用。

显然，对于这种情况，我可以使用`hg log -r "0..default and not branch(branch2)"`，但我正在寻找一个更通用的命令 revset，它适用于所有情况。

为了测试，我使用命令`hg export -r "0..default and not branch(branch2)" -o ../%R.patch`和以下 for 循环来应用生成的补丁：

```
cd ../
mkdir patched
cd patched
for n in ../*.patch ; do
    patch -p1 <$n
done 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T23:01:15.757

更一般的尝试：

*   仍然需要一项初步的人工检查和配置操作；
*   仅适用于相对较新的 Mercurial，其中 p(1|2) 函数添加到 revsets

预检查：对于带有合并集的存储库，您必须定义要使用合并集的哪个父行，p1(MERGESET) 和 p2(MERGESET) 将显示“谁是谁”；并记住合并集的修订。为您测试用例

```
hg log -r "p1(7)"
changeset:   6:dfe021fa52a4
parent:      3:1374ea53e7b7
user:        Dusty Phillips <dusty@buchuki.com>
date:        Mon Dec 17 17:54:01 2012 -0700
summary:     e

hg log -r "p2(7)"
changeset:   5:4d8bc738f0ab
branch:      branch2
user:        Dusty Phillips <dusty@buchuki.com>
date:        Mon Dec 17 17:53:55 2012 -0700
summary:     g 
```

请注意：p1 线必须生存。

*   排除某些东西是“x - y”（或“x and ！y”，但第一种形式是可读的）

*   x 在我们的例子中是完整的历史

( `0:tip`),

y - p1(7) 的所有*间接亲属*

`! (ancestors(p1(7)) | descendants(p1(7)))`

*   最终修订成为`"0:tip - ! (ancestors(p1(7)) | descendants(p1(7)))"`

在您的存储库上试运行 revset

```
hg log -r "0:tip - ! (ancestors(p1(7)) | descendants(p1(7)))"
changeset:   0:a3b3a87aa422
user:        Dusty Phillips <dusty@buchuki.com>
date:        Mon Dec 17 17:51:43 2012 -0700
summary:     a

changeset:   1:ff7f8724ad17
branch:      branch1
user:        Dusty Phillips <dusty@buchuki.com>
date:        Mon Dec 17 17:52:25 2012 -0700
summary:     b

changeset:   2:59712a781f0c
branch:      branch1
user:        Dusty Phillips <dusty@buchuki.com>
date:        Mon Dec 17 17:52:27 2012 -0700
summary:     c

changeset:   3:1374ea53e7b7
user:        Dusty Phillips <dusty@buchuki.com>
date:        Mon Dec 17 17:52:36 2012 -0700
summary:     d

changeset:   6:dfe021fa52a4
parent:      3:1374ea53e7b7
user:        Dusty Phillips <dusty@buchuki.com>
date:        Mon Dec 17 17:54:01 2012 -0700
summary:     e

changeset:   7:bc959885f6aa
parent:      6:dfe021fa52a4
parent:      5:4d8bc738f0ab
user:        Dusty Phillips <dusty@buchuki.com>
date:        Mon Dec 17 17:54:20 2012 -0700
summary:     MERGE

changeset:   8:ffd749c92f3b
tag:         tip
user:        Dusty Phillips <dusty@buchuki.com>
date:        Mon Dec 17 17:54:25 2012 -0700
summary:     h 
```

## 最终编辑

我记得形式逻辑的教训：我在表达式中双重否定 "x - ! SET" （在 x 但不是在未设置中）**只是 SET**。Purified revset 简洁明了

```
"ancestors(p1(7)) | descendants(p1(7))" 
```

（它最初也是尾随`| p1(7)`，但*现在*// `Mercurial Distributed SCM (version 2.4.2)`，由于我不知道的原因，变更集是他自己的祖先和后代：`hg log -r "ancestors(p1(7)) & descendants(p1(7))"`返回变更集 6）

# linux - 删除 linux 中包含符号链接的目录

> ID：13924923
> 
> 赞同：0
> 
> 时间：2012-12-18T01:18:24.950
> 
> 标签：linux, shell

我想删除 linux 中的一个非空目录，它里面有一个目录结构，里面有一堆符号链接。当我跑

```
rm -rf /direcory 
```

它不仅会删除所有符号链接和目录，还会删除这些符号链接指向的所有目录。是否有仅包含符号链接的目录的命令？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T01:30:43.647

反例：

```
$ mkdir directory
$ cd directory
$ mkdir to-be-removed to-be-left-behind
$ cd to-be-left-behind
$ mkdir a b c
$ cd ../to-be-removed
$ ln -s ../to-be-left-behind/* .
$ cd ..
$ ls -lR
total 0
drwxr-xr-x  5 jleffler  staff  170 Dec 17 17:25 to-be-left-behind
drwxr-xr-x  5 jleffler  staff  170 Dec 17 17:25 to-be-removed

./to-be-left-behind:
total 0
drwxr-xr-x  2 jleffler  staff  68 Dec 17 17:25 a
drwxr-xr-x  2 jleffler  staff  68 Dec 17 17:25 b
drwxr-xr-x  2 jleffler  staff  68 Dec 17 17:25 c

./to-be-left-behind/a:

./to-be-left-behind/b:

./to-be-left-behind/c:

./to-be-removed:
total 24
lrwxr-xr-x  1 jleffler  staff  22 Dec 17 17:25 a -> ../to-be-left-behind/a
lrwxr-xr-x  1 jleffler  staff  22 Dec 17 17:25 b -> ../to-be-left-behind/b
lrwxr-xr-x  1 jleffler  staff  22 Dec 17 17:25 c -> ../to-be-left-behind/c
$ rm -fr to-be-removed
$ ls -lR
total 0
drwxr-xr-x  5 jleffler  staff  170 Dec 17 17:25 to-be-left-behind

./to-be-left-behind:
total 0
drwxr-xr-x  2 jleffler  staff  68 Dec 17 17:25 a
drwxr-xr-x  2 jleffler  staff  68 Dec 17 17:25 b
drwxr-xr-x  2 jleffler  staff  68 Dec 17 17:25 c

./to-be-left-behind/a:

./to-be-left-behind/b:

./to-be-left-behind/c:
$ 
```

符号链接被删除，但它们指向的目录没有被删除。

因此，您的示例中还有其他内容在起作用。例如，如果符号链接指向 下的文件或目录`to-be-removed`，则符号链接和目标都将被删除，但这只是因为目标无论如何都在火线上。

# django - 在同一台服务器上运行多个 Django Celery 网站

> ID：13924926
> 
> 赞同：8
> 
> 时间：2012-12-18T01:18:58.867
> 
> 标签：django, celery, django-celery, supervisord, celeryd

我使用 apache2 虚拟服务器在同一台服务器上运行多个 Django/apache/wsgi 网站。而且我想使用 celery，但是如果我为多个网站启动 celeryd，所有网站都将使用我启动的最后一个 celeryd 实例的配置（日志、数据库等）。

有没有办法使用多个 Celeryd（每个网站一个）或一个 Celeryd 用于所有这些？似乎它应该是可行的，但我不知道如何。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-09-25T12:02:15.633

这个问题很头疼，我刚来的时候没有注意到@Crazyshezy 的评论。我刚刚通过更改**settings.py**中每个 Web 应用程序的代理 URL 来完成此操作。

**app1.settings.py**

```
BROKER_URL = 'redis://localhost:6379/0' 
```

**app2.settings.py**

```
BROKER_URL = 'redis://localhost:6379/1' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T08:23:01.603

是的，有办法。我们使用主管为我们需要的每个项目启动 celery 守护进程。

主管配置文件如下所示：

```
[program:PROJECTNAME]
command=python manage.py celeryd --loglevel=INFO --beat
environment=PATH=/home/www-data/projects/PROJECTNAME/env/bin:/usr/bin:/bin
directory=/home/www-data/projects/PROJECTNAME/
user=www-data
numprocs=1
umask=022
stdout_logfile=/home/www-data/logs/%(program_name)s.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=10
stderr_logfile=/home/www-data/logs/%(program_name)s.error.log
stderr_logfile_maxbytes=50MB
stderr_logfile_backups=10
autorestart=true
autostart=True
startsecs=10
stopwaitsecs = 60
priority=998 
```

如果你使用这个设置还有另一个好处：celery 守护进程完全在用户空间中运行。

请记住为您的项目使用不同的代理后端。如果您使用相同的rabbitmq 虚拟主机或为每个项目使用相同的redis 数据库，它将无法正常工作。

# java - 将 Java 代码翻译成 C

> ID：13924929
> 
> 赞同：-6
> 
> 时间：2012-12-18T01:19:09.047
> 
> 标签：java, c, pointers, translation

我是 C 的新手，显然我在理解所有内存和指针方面遇到了一些问题。所以我有以下Java代码：

```
public class Question_10
{
   public static void sortInt(int[] array)
   {
      int top = 0;
      while (top < array.length - 1)
      {
         if (array[top] < array[top + 1])
         {
            top++;
         }
         else
         {
            int temp = array[top];
            array[top] = array[top + 1];
            array[top + 1] = temp;
            if (top > 0)
            {
               top--;
            }
         }
         System.out.println(top);
      }
   }

   public static void main(String[] args)
   {
      int[] arr = {5, 6, 10, 1, 45, 3};

      sortInt(arr);
      System.out.println();
   }

} 
```

Aaand，我做了以下事情：

```
#include <stdio.h>

void sortInt(int arrayInput[])
{
    int top = 0;
    int arrLen = sizeof(arrayInput)/(sizeof(int);
    while(top < arrLen - 1)
    {
        if(arrayInput[top] < arrayInput[top+1])
        {
            top++;
        }
        else
        {
            int temp = arrayInput[top];
            arrayInput[top] = arrayInput[top + 1];
            arrayInput[top + 1] = temp;
            if(top > 0)
            {
                top--;
            }
        }
        printf("%i", top);
    }
}
void main()
{

    int array[] = {5, 6, 10, 1, 45, 3};
    sortInt(array);
    return 0;
} 
```

当然我得到了很多错误：

```
$ gcc Question10.c
Question10.c: In function `sortInt':
Question10.c:6: error: parse error before ';' token
Question10.c: At top level:
Question10.c:16: error: `top' undeclared here (not in a function)
Question10.c:16: warning: data definition has no type or storage class
Question10.c:17: error: `temp' undeclared here (not in a function)
Question10.c:17: warning: data definition has no type or storage class
Question10.c:18: error: parse error before "if"
Question10.c:23: error: parse error before string constant
Question10.c:23: error: conflicting types for 'printf'
Question10.c:23: note: a parameter list with an ellipsis can't match an empty parameter name list declaration
Question10.c:23: error: conflicting types for 'printf'
Question10.c:23: note: a parameter list with an ellipsis can't match an empty parameter name list declaration
Question10.c:23: warning: data definition has no type or storage class
Question10.c: In function `main':
Question10.c:30: warning: `return' with a value, in function returning void
Question10.c:27: warning: return type of 'main' is not `int'
Question10.c:31:2: warning: no newline at end of file
Question10.c: At top level:
Question10.c:16: error: storage size of `arrayInput' isn't known
Question10.c:17: error: storage size of `arrayInput' isn't known 
```

也许您可以就问题所在给我任何建议，并且一些一般性指导会有所帮助，因为我真的迷失在 C 中的这些“对象”事物中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T01:20:51.137

此行存在语法错误：

`int arrLen = sizeof(arrayInput)/(sizeof(int);`

尝试使用： `int arrLen = sizeof(arrayInput)/sizeof(int);`

如果你从修复它开始，那么你可能会解决你遇到的其他一些问题。如果没有，一次拿一个。

我可以看到的另一个错误是您将 main 方法声明为`void main()`并调用`return 0;`. 根据 C 标准， main() 方法应该返回`int`，所以更改声明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T01:28:21.880

我让它工作。

```
 void sortInt(int arrayInput[], int arrLen)
    {
        int top = 0;
        while(top < arrLen - 1)
        {
            if(arrayInput[top] < arrayInput[top+1])
            {
                top++;
            }
            else
            {
                int temp = arrayInput[top];
                arrayInput[top] = arrayInput[top + 1];
                arrayInput[top + 1] = temp;
                if(top > 0)
                {
                    top--;
                }
            }
            printf("%i", top);
        }
    }

    int main()
    {
        int array[] = {5, 6, 10, 1, 45, 3};
        sortInt(array, sizeof(array)/sizeof(int));
        return 0;
    } 
```

# sql - 是否有充分的理由将相关数据集拆分为不同的 SQL 数据库而不仅仅是表？

> ID：13924930
> 
> 赞同：1
> 
> 时间：2012-12-18T01:19:25.217
> 
> 标签：sql, sql-server, sql-server-express

这个问题是由我的一个朋友正在使用的一些商业软件的最近更新引起的。到目前为止，他们的架构是基于 Access 数据库的，速度非常慢。他们将数据集拆分为多个 mdb 文件（sales.mdb、products.mdb、stock.mdb、...）。他们现在转向 SQL Server Express 并保持这种结构。他们没有为每个数据集使用一个表，而是在同一个 SQL Server 2008 Express 实例上创建了不同的数据库。

从我对 SQL Server 的（诚然有限的）理解来看，这似乎并不明智，因为它可以防止不同表之间的 JOIN，并且需要一个需要销售和库存数据的程序来维护两个数据库连接，而不仅仅是一个。

一位软件供应商的顾问声称，这将绕过 SQL Express 的 1GB 物理内存的 RAM 限制——他说这是每个数据库的，但从我从 MSDN 收集的信息来看，它实际上是每个实例的，所以他们在这里一无所获。

是否有充分的理由将同一业务域中的数据拆分为数据库而不是表？（我能想到的一个是您可以限制每个数据库的访问，但不能限制每个表的访问——但这在这种特殊情况下无关紧要，程序的所有模块都可以访问所有数据库。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T05:59:04.723

您可以跨数据库编写联接，因此这不是主要问题。一般来说，我建议将所有内容都保存在一个数据库中，除非有充分的理由将其拆分，并且这些原因可能与兼容性有关，比如您有一个应用程序必须在兼容模式 80 或数据库上运行某些东西 - 您可能会选择在该兼容性级别将一些数据分离到单独的数据库中。或者，如果您希望能够轻松移动到另一台服务器的主要功能块 - 例如数据迁移或 ETL。

听起来限制在应用程序中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T08:03:12.477

根据您的 SQL Server Express 版本，拆分数据库可以允许更多的数据存储（2005 有 4GB 数据库限制，2008 是 10GB）。

除了每个实例 1GB RAM 的限制之外，我相信 SQL Server Express 也被限制为每个实例 1 个 CPU。

我同意HABO的评论。您不能跨数据库强制执行参照完整性，所有这些都必须在应用程序中进行管理。

# python - setup.py：限制python解释器的允许版本

> ID：13924931
> 
> 赞同：36
> 
> 时间：2012-12-18T01:19:27.230
> 
> 标签：python, pip, easy-install, setup.py

我有一个 Python 库。不幸的是，我还没有更新它以使用 Python 3。

在其中`setup.py`，我添加了

```
install_requires=['python<3'], 
```

我的意图是不允许在 Python 3 下安装/使用这个包，因为我知道它（还）不起作用。我认为这不是正确的方法，因为`pip`然后尝试下载并安装 python 2.7.3（这已经是已安装的版本！）。

我应该如何指定我的库依赖于特定范围的 Python 解释器版本？我应该添加`Programming Language :: Python :: 2 :: Only`标签吗？这实际上会阻止在 Python 3 下安装吗？如果我还想将最低版本限制为 Python 2.6，该怎么办？

我更喜欢一种适用于任何地方的解决方案，但会满足于只适用于`pip`（并且希望不会导致`easy_install`窒息）的解决方案。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2017-07-27T23:10:26.353

从[9.0.1 版本](http://setuptools.readthedocs.io/en/latest/setuptools.html#new-and-changed-setup-keywords)开始， pip 将接受一个新`python_requires`字符串，指定安装所需的 Python 版本，例如，如果希望强制执行 3.3 的最低 Python 版本：

```
setup(
    ...,
    python_requires=">=3.3"
) 
```

有关更多详细信息，请参见[此处](http://www.python3statement.org/practicalities/)。另请参阅 SO 上的这个[答案](https://stackoverflow.com/a/42792413/28035)。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-12-18T01:53:06.047

一个可能的解决方案是*测试*Python 版本，因为除了当前运行的版本（它安装在当前 Python 环境中）之外，`pip`不能*满足Python 版本：*

```
import sys
if not sys.version_info[0] == 2:
    sys.exit("Sorry, Python 3 is not supported (yet)")

setup(... 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-10-16T09:20:04.943

在上面的答案中发表评论并收到反馈后，我想将我的评论变成答案。请注意，上面的答案都很好，但是根据我的经验，我发现这些答案中“缺少”一件事，需要指出，所以在这里我将说明这个问题。

为了说明的简单性和完整性，我编写了一个非常简单的 Python 3 项目。它使用的唯一第 3 方包是著名的 SSH 客户端包`paramiko`（它的官方 PyPi 页面可以在[这里](https://pypi.org/project/paramiko/)找到）。

我项目虚拟环境中的Python解释器是**3.6.9版本**

现在，为了检查`python_requires`“in action”属性，我将其添加到项目的`setup.py`脚本中，如下所示：

```
from setuptools import setup, find_packages

setup(name='mySampleProject',
      version='1.0',
      description='Sample project in Python 3',
      author='Guy Avraham',
      license='MIT',
      packages=find_packages(),
      include_package_data=True,
      python_requires='>=3.8',
      install_requires=['paramiko']) 
```

请注意，我“要求”Python 版本为**3.8+**。这当然不应该**与**项目虚拟环境中的当前 Python 版本（即 3.6.9）一起使用。

现在，当我使用 中的“正常”用法构建项目时`setup.py`，意味着运行：`python3 setup.py install`，项目已成功构建。`pip3 list`运行命令后查看命令输出如下`python3 setup.py install`：

```
(mySampleProject_env) guya@ubuntu:~/mySampleProject$ pip3 list
DEPRECATION: The default format will switch to columns in the future. You can use -- 
format=(legacy|columns) (or define a format=(legacy|columns) in your pip.conf under the [list] section) to disable this warning.
bcrypt (3.2.0)
cffi (1.14.3)
cryptography (3.1.1)
mySampleProject (1.0)
paramiko (2.7.2)
pip (9.0.1)
pkg-resources (0.0.0)
pycparser (2.20)
PyNaCl (1.4.0)
setuptools (39.0.1)
six (1.15.0) 
```

如您所见，即使我没想到会安装该项目及其所有“子依赖项”。

**另一方面**，当我使用命令安装项目时：（`pip3 install -e .`注意`.`表示“当前工作目录”），我得到以下输出：

```
(mySampleProject_env) guya@ubuntu:~/mySampleProject$ pip3 install -e .
Obtaining file:///home/guya/mySampleProject
mySampleProject requires Python '>=3.8' but the running Python is 3.6.9 
```

现在，确实“考虑”了该`python_requires`属性，从而“失败”了项目的构建。

[在本页](https://python3statement.org/practicalities/)教程的第一段以及[本视频](https://www.youtube.com/watch?v=2DkfPzWWC2Q) 中的分钟 ~09:00 - 11:00 中有详细说明

**注意：**我没有**为**Python 2（或`pip`Python 2）检查以上所有内容。

# javascript - 编码包含 Node.js 缓冲区的 MessagePack 对象

> ID：13924936
> 
> 赞同：5
> 
> 时间：2012-12-18T01:20:29.943
> 
> 标签：javascript, node.js, msgpack

我正在使用[node-msgpack](https://github.com/pgriess/node-msgpack)对机器之间传递的消息进行编码和解码。我想做的一件事是将原始缓冲区数据包装在一个对象中并使用 Messagepack 对其进行编码。

```
msgpack = require('msgpack')
buf = <Buffer 89 50 4e 47 0d 0a 1a 0a 00 00 00 0d 49 48 44 52 00 00 ...>
obj = {foo: buf}
packed = msgpack.pack(obj) 
```

在上面的示例中，我想对嵌套在对象中的缓冲区的原始字节进行一致性检查。所以`buf`是这样获得的：

```
var buf = fs.readFileSync('some_image.png'); 
```

在一个完美的世界里，我会得到：

```
new Buffer(msgpack.unpack(packed).foo);

#> <Buffer 89 50 4e 47 0d 0a 1a 0a 00 00 00 0d 49 48 44 52 00 00 ...> 
```

相反，我最终得到了一些随机数。再深入一点，我最终会产生以下好奇心：

```
enc = 'ascii'
new Buffer(buf.toString(enc), enc)
#> <Buffer *ef bf bd* 50 4e 47 0d 0a 1a 0a 00 00 00 0d 49 48 44 52 00 00 ...>

buf
#> <Buffer *89* 50 4e 47 0d 0a 1a 0a 00 00 00 0d 49 48 44 52 00 00 02 00 ...> 
```

第一个字节是问题所在。我尝试使用不同的编码但没有运气。这里发生了什么，我能做些什么来规避这个问题？

### 编辑：

最初，这`buf`是我使用 msgpack 本身生成的缓冲区，因此对数据进行了双重打包。为避免混淆，我将其替换为通过读取图像获得的另一个缓冲区，这引发了同样的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T01:46:28.250

`base64`当使用除和之外的任何编码文本解码二进制数据时，会出现缓冲区损坏问题`hex`。似乎没有被[node-msgpack 拾取](https://github.com/pgriess/node-msgpack)。它似乎会自动尝试使用“utf-8”，这会不可逆转地破坏缓冲区。他们必须做类似的事情，所以我们最终不会得到一堆缓冲区对象而不是普通字符串，这主要是我们的 msgpack 对象通常由什么组成的。

* * *

**编辑**：

上面显示的有问题的三个字节代表 UTF-8 [Replacement Character](http://en.wikipedia.org/wiki/Specials_(Unicode_block)#Replacement_character)。快速测试表明，这个字符是用来替换`0x89`开头无法识别的字节：

```
new Buffer((new Buffer('89', 'hex')).toString('utf-8'), 'utf-8')
//> <Buffer ef bf bd> 
```

[这行](https://github.com/pgriess/node-msgpack/blob/master/src/msgpack.cc#L266)来自[node-msgpack](https://github.com/pgriess/node-msgpack)的 C++ 代码负责此行为。当截取`Buffer`给编码器的数据结构中的实例时，它只是将其绑定转换为 a `String`，相当于执行`buffer.toString()`默认假设`UTF-8`编码，用上面的替换每个无法识别的字符。

下面建议的替代模块通过将缓冲区保留为原始字节来解决此问题，而不是尝试将其转换为字符串，但这样做与其他 MessagePack 实现不兼容。如果兼容性是一个问题，解决这个问题的方法是`UTF-8`使用二进制安全编码提前对非缓冲区进行编码，如`binary`,`base64`或`hex`. `base64`或者`hex`将不可避免地显着增加数据的大小，但会保持一致并且在通过 HTTP 传输数据时使用起来最安全。如果大小也是一个问题，那么通过像[Snappy](https://github.com/Skomski/node-snappy)这样的流压缩算法传送 MessagePack 结果可能是一个不错的选择。

* * *

结果是另一个模块[msgpack-js](https://github.com/creationix/msgpack-js)（它是一个用 javascript 编写的 msgpack 编码器/解码器），保留原始二进制数据，从而解决了上述问题。他是这样做的：

> *我稍微扩展了格式以允许对未定义和 Buffer 实例进行编码和解码。*
> 
> *这需要三个以前标记为“保留”的新类型代码。此更改意味着使用这些新类型将使您的序列化数据与其他没有相同扩展名的消息包实现不兼容。*

作为奖励，它也比前面提到的基于 C++ 扩展的模块性能更高。它也更年轻，所以可能没有经过彻底的测试。时间会证明一切。这是我做的快速基准测试的结果，基于[node-msgpack 中包含的基准](https://github.com/pgriess/node-msgpack/blob/master/bench.js)，比较了两个库（以及本机 JSON 解析器）：

```
node-msgpack pack:   3793 ms
node-msgpack unpack: 1340 ms

msgpack-js pack:   3132 ms
msgpack-js unpack: 983 ms

json pack:   1223 ms
json unpack: 483 ms 
```

因此，虽然我们看到原生 javascript msgpack 解码器的性能有所提高，但 JSON 的性能仍然更高。

# c - allegro5 - 如何在 Linux 上运行？

> ID：13924937
> 
> 赞同：4
> 
> 时间：2012-12-18T01:20:37.940
> 
> 标签：c, linux, allegro, allegro5

我设置了 Allegro 5，并且可以成功编译以下代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <errno.h>
#include <allegro5/allegro.h>
void error(char *msg)
{
   fprintf(stderr,"%s : %s\n", msg, strerror(errno));
   exit(1);
}
int main(int argc, char **argv)
{
ALLEGRO_DISPLAY *display = NULL;

if(!al_init())
   error("Could not initailize allegro");

display = al_create_display(640, 480);
if(!display)
   error("fail to display");

al_clear_to_color(al_map_rgb(0,0,0));
al_flip_display();
al_rest(10.0);
al_destroy_display(display);
return 0;
} 
```

但是运行它之后，它失败并显示错误消息：

> 无法初始化 allegro：没有这样的文件或目录。

我不知道出了什么问题。我的操作系统是 Ubuntu，我已经成功编译了代码：

```
gcc try.c -lallegro 
```

但无法运行它：

```
./a.out 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:41:40.990

Allegro 需要一个配置文件和可能的其他文件才能运行。从您的评论来看，这可能就是它不起作用的原因。从自述文件：

"

> 通常，安装程序和 allegro.cfg 将与它们控制的 Allegro 程序位于同一目录中。这对最终用户来说很好，但对于使用 Allegro 的程序员来说可能会很痛苦，因为您可能在不同的目录中有多个程序，并且希望对所有程序都使用一个 allegro.cfg。如果是这种情况，您可以将环境变量 ALLEGRO 设置为包含 allegro.cfg 的目录，如果当前目录中没有 allegro.cfg，Allegro 将在那里查找。

...

> 在 Unix、BeOS 和 MacOS X 下，配置文件例程还会依次检查 ~/allegro.cfg、~/.allegrorc、/etc/allegro.cfg 和 /etc/allegrorc，键盘和语言文件可以存储在您的主目录或 /etc/ 中。

看更多：

[http://alleg.sourceforge.net/stabledocs/en/readme.html#configuration](http://alleg.sourceforge.net/stabledocs/en/readme.html#configuration)

# ruby-on-rails - 如何重构实现类似方法的模型类？

> ID：13924938
> 
> 赞同：0
> 
> 时间：2012-12-18T01:20:38.953
> 
> 标签：ruby-on-rails, ruby, interface, refactoring

我正在使用 Ruby on Rails 3.2.9 和 Ruby 1.9.3。我有许多实现类似方法的模型类，如下所示：

```
class ClassName_1 < ActiveRecord::Base
  def great_method
    self.method_1
  end

  def method_1 ... end
end

class ClassName_2 < ActiveRecord::Base
  def great_method
    result_1 = self.method_1
    result_2 = self.method_2

    result_1 && result_2
  end

  def method_1 ... end
  def method_2 ... end
end

...

class ClassName_N < ActiveRecord::Base
  def great_method
    result_1 = self.method_1
    result_2 = self.method_2
    ...
    result_N = self.method_N

    result_1 && result_2 && ... && result_N
  end

  def method_1 ... end
  def method_2 ... end
  ...
  def method_N ... end      
end 
```

这些模型类的行为几乎相同（*不*一样），因为其中一些具有带有一些或多或少方法的接口。所有方法都有不同的命名（例如，`method_1`可以命名`bar`和`method_2`可以命名`foo`），所有返回`true`或`false`，在每个类中总是相同的，它们之间没有关系。

重构这些类的正确方法是什么？

* * *

*注意*：此时我正在考虑通过在每个模块中包含以下模块来重构类：

```
module MyModule
  def great_method
    result_1 = self.respond_to?(:method_1) ? self.method_1 : true
    result_2 = self.respond_to?(:method_2) ? self.method_2 : true
    ...
    result_N = self.respond_to?(:method_N) ? self.method_N : true

    result_1 && result_2 && ... && result_N
  end
end 
```

但我不知道这是否是完成我正在寻找的正确方法。此外，我不确定相关的优点和缺点......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T01:48:34.353

看起来你在正确的轨道上。如果 method_n 方法对您的类是唯一的，那么只需将您已经拥有的模块构建到每个 ClassNameN 继承自的超类中：

```
class SuperClassName < ActiveRecord::Base
  def great_method
    #... what you have in your module
  end
end

class ClassNameN < SuperClassName
  def method_1 ... end
  def method_2 ... end
end 
```

根据您的 method_n 方法中发生的情况，您可能还有其他方法可以分解代码，但如果没有更多细节，就不可能说出来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T05:53:04.670

我会使用元编程解决方案来稍微清理一下。

```
module BetterCode
  extend ActiveSupport::Concern

  module ClassMethods
    def boolean_method(name, *components)
      define_method name do
        components.all? { |c| send c }
      end
    end
  end
end 
```

在你的模型中：

```
class MyModel < ActiveRecord::Base
  include BetterCode

  boolean_method :great_method, :foo, :bar, :baz, :quux
end 
```

的实例`MyModel`随后将响应一个布尔值，`great_method`指示`foo`、和是否都为真。`bar``baz``quux`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T01:56:08.720

`great_method`你可以用这样的东西抽象出来：

```
require 'active_support/concern'

module Greatest
  extend ActiveSupport::Concern

  module ClassMethods
    attr_accessor :num_great_methods

    def has_great_methods(n)
      @num_great_methods = n
    end
  end

  def great_method
    (1..self.class.num_great_methods).each do |n|
      return false unless self.__send__("method_#{n}")
    end
    true
  end
end

class ClassName_3
  include Greatest

  has_great_method 3

  # stub out the "method_*" methods
  (1..3).each do |n|
    define_method "method_#{n}" do
      puts "method_#{n}"
      true
    end
  end
end

puts ClassName_1.new.greatest 
```

# scala - 如何过滤输入到 Scala swing TextField

> ID：13924941
> 
> 赞同：1
> 
> 时间：2012-12-18T01:20:57.740
> 
> 标签：scala

有没有一种方便的方法来添加过滤器以输入到 scala.swing.TextComponent，以便用户只能输入整数/浮点数/其他？特别是，有没有办法将粘贴过滤到文本字段中？在 Java 中，我使用了 DocumentFilter 来做到这一点。我已经尝试了一些变化：

```
object inputField extends TextField{

   peer.getDocument.asInstanceOf[AbstractDocument].setDocumentFilter(new DocumentFilter{

      def insertString(fb: FilterBypass, offs: Integer, str: String, a: AttributeSet){
         if(str.forall((c)=>c.isDigit)) super.insertString(fb, offs, str, a)
      }

      def replace(fb: FilterBypass, offs: Integer, l: Integer, str: String, a: AttributeSet){
         if(str.forall((c)=>c.isDigit)) super.replace(fb, offs, l, str, a)
      }
   })
} 
```

这是行不通的。我做错了吗，还是 Scala 忽略了文档过滤器？还有另一种方法可以做到这一点吗？如果需要的话，我可能完全可以使用 java.swing GUI。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T06:01:16.827

您可以使用反应来实现这一点：

```
import swing._
import swing.event._

object SwingApp extends SimpleSwingApplication {
  def top = new MainFrame {
    contents = new TextField {
      listenTo(keys)
      reactions += { case e: KeyTyped =>
        if (!e.char.isDigit) e.consume
      }
    }
  }
} 
```

**更新**：哦，我同意，这仅适用于相对琐碎的情况。我发现您的原始解决方案存在问题：您在需要 Ints 的地方使用整数，因此您的方法只是新方法，而不是抽象类方法的实现。这是它对我的工作方式：

```
contents = new TextField {
  object IntegralFilter extends DocumentFilter {
    override def insertString(fb: FilterBypass, offs: Int, str: String, a: AttributeSet){
       if(str.forall((c)=>c.isDigit)) super.insertString(fb, offs, str, a)
    }    
    override def replace(fb: FilterBypass, offs: Int, l: Int, str: String, a: AttributeSet){
       if(str.forall((c)=>c.isDigit)) super.replace(fb, offs, l, str, a)
    }
  }

  peer.getDocument().asInstanceOf[AbstractDocument].setDocumentFilter(IntegralFilter)
} 
```

注意“覆盖”的使用。这就是我得到编译器错误和相应 IDE 提示的方式，如果我真的想用这个覆盖某些东西，我必须更改签名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-19T15:38:13.090

这个类可以正确处理除指数之外的所有有效数字：

```
class NumberField(initialValue: Double) extends TextField(initialValue.toString) {
  // Note: exponents are not allowed
  val numberFormatException = new NumberFormatException
  listenTo(keys)
  reactions += {
    case event: KeyTyped => {
      try {
        // Don't allow "d" or "f" in the string even though it parses, e.g. 3.5d
        if (event.char.isLetter)
          throw numberFormatException
        // Don't allow string that doesn't parse to a double
        (text.substring(0, caret.position) +
          event.char +
          text.substring(caret.position)).toDouble
      } catch {
        case exception: NumberFormatException => event.consume()
      }
    }
  }

  def value : Double = text.toDouble
} 
```

# objective-c - Cocoa：将局部变量指向对象属性（双精度）

> ID：13924942
> 
> 赞同：0
> 
> 时间：2012-12-18T01:20:57.813
> 
> 标签：objective-c, ios, cocoa

每隔几个月我就会尝试重新学习 Cocoa，因为除了作为一种爱好之外，我对 iOS 编程没有任何实际用途。我将回顾基础知识并查看点符号的不同之处；例如，查看 API 是如何更新为默认执行常见任务的。

有很多文档，这很好，但当您想快速启动和运行时，这也可能是一件坏事。虽然它正在慢慢恢复，但我认为自己是该主题的重生新手，因此不胜感激。

* * *

头文件：

```
@interface FooClass : NSObject
{
@private
    double foo;
}
@property (nonatomic) double foo;
@end 
```

实现文件：

```
@implementation FooClass
@synthesize foo = _foo;
- (void) doSomething
{

}
@end 
```

在 doSomething 实现中，是否有可能拥有`bar`一个指向类的指针的局部变量（例如 ），`foo`以便何时更新`bar`get/set `foo`（本地别名）？我尝试了以下变化：

```
double bar = *self.foo;
double *bar = self.foo;
double *bar = *self.foo;
double *bar = &self.foo;

bar=5; 
```

如果是这样，正确的语法是什么？另外，有些东西告诉我这是一个坏主意，那为什么会这样呢？

* * *

编辑：看起来经过更多搜索后，我发现了类似的东西：[objective-c: double pointers to property not allowed?](https://stackoverflow.com/questions/7616147/objective-c-double-pointers-to-property-not-allowed) 现在，我将尝试理解它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T01:53:09.330

您的示例包含一个错误：

```
@interface FooClass : NSObject
{
@private
    double foo;
}
@property (nonatomic) double foo;
@end 
```

这声明了一个属性`foo`。它还声明了一个 ivar（实例变量）`foo`，人们可能会认为它是与同名属性关联的 ivar。

```
@implementation FooClass
@synthesize foo = _foo;
@end 
```

不幸的是，`@synthesize`声明说“合成 foo 属性并创建一个调用`_foo`它的 ivar”。因此，您现在有两个 ivar，`foo`（您在`{}`中的之间创建`@interface`）和`_foo`，您刚刚将其合成为与`foo`属性关联的 ivar。有 ivar 漂浮在外面是不好的`foo`，它是显式声明的，导致读者假设它会与同名的属性相关联，但事实并非如此，因为`_foo`是。

很久以前，您会被建议修复您的显式 ivar 声明，例如

```
@interface FooClass : NSObject
{
@private
    double _foo;
}
@property (nonatomic) double foo;
@end 
```

但现在更好的是，建议您**完全省略属性的显式 ivar 定义**，并让`@synthesize`语句为您创建该 ivar，从而消除我们上面描述的问题的任何可能性，例如，简单地：

```
@interface FooClass : NSObject
@property (nonatomic) double foo;
@end 
```

此外，该`@synthesize`语句现在是可选的，如果省略，它将完全按照您的建议执行`@synthesize foo = _foo;`。

在回答您关于使用变量访问您的属性的问题时，这就是`_foo`实例变量。为什么需要另一个变量？此外，您通常应该使用 getter。

通常建议[不要使用 ivar 来设置属性](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmPractical.html#//apple_ref/doc/uid/TP40004447-SW5)，而是使用属性的访问器。该建议也适用于通过局部变量更改属性值的任何尝试。您绝对应该使用 ivar 的唯一一次是在您的[初始化程序和 dealloc 方法](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmPractical.html#//apple_ref/doc/uid/TP40004447-SW6)中。

顺便说一句，对[“使用访问器方法设置属性值”](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmPractical.html#//apple_ref/doc/uid/TP40004447-SW5)的引用是对您的主要问题的迂回回答（至少如果您曾经试图使用该局部变量来更改属性的值）。您应该只使用对象设置器访问器来更改属性的值。setter 做了重要的事情，绕过它是不明智的。实际上，要回答您的最后一个问题，就是指导您如何以一种不会产生编译器警告的方式做错事，因此我犹豫是否要去那里。

一些相关的参考资料包括：

*   [使用 Objective-C 编程](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/Introduction/Introduction.html#//apple_ref/doc/uid/TP40011210)

*   *高级内存管理编程指南*中的[实用内存管理](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmPractical.html)。

# javascript - 在 .js 函数中包含 JavaScript/jQuery 库

> ID：13924947
> 
> 赞同：0
> 
> 时间：2012-12-18T01:22:08.127
> 
> 标签：javascript, jquery, parsing, video

我正在尝试生成用于视频聊天应用程序的令牌（具有特定格式的部分随机 base 64 编码字符串）。为此，我在后端使用 Parse Cloud Code。我基本上部署了一个运行我的服务器端脚本的 .js 文件。我现在拥有的代码如下。我一直收到错误代码 141：“未捕获的 ReferenceError：文档未定义”和另一个错误说“$”未定义。我怀疑我正在做一些像错误的 jQuery 之类的事情——可能是非常愚蠢的事情。有任何想法吗？

```
Parse.Cloud.define("generateToken", function(request, response) {
    var script1 = document.createElement('script');
    script1.src = 'http://code.jquery.com/jquery-1.8.3.min.js';
    script1.type = "text/javascript";
    document.getElementsByTagName('head')[0].appendChild(script1);
    var script2 = document.createElement('script');
    script2.src = 'https://raw.github.com/carlo/jquery-base64/master/   jquery.base64.min.js';
    script2.type = "text/javascript";
    document.getElementsByTagName('head')[0].appendChild(script2);
    var script3 = document.createElement('script');
    script3.src = 'http://crypto-js.googlecode.com/svn/tags/3.0.2/build/rollups/hmac-sha1.js';
    script3.type = "text/javascript";
    document.getElementsByTagName('head')[0].appendChild(script3);
    var secondsInDay = 86400;

    // Credentials - leaving these out for security purposes
    var apiKey = <apiKey>;
    var secret = <secret>;
    var sessionId = request.params.sid;

    // Token Params
    var timeNow = Math.floor(Date.now()/1000);
    var expire = timeNow+secondsInDay;
    var role = "publisher";
    var data = "whatever";

    // Calculation
    data = escape(data);
    var rand = Math.floor(Math.random()*999999);
    var dataString = "session_id="+sessionId+"&create_time="+timeNow+"&expire_time="+expire+"&role="+role+"&connection_data="+data+"&nonce="+rand;

    // Encryption
    var hmac = CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA1, secret);
    hmac.update( dataString );
    hash = hmac.finalize();

    preCoded = "partner_id="+apiKey+"&sig="+hash+":"+dataString;
    token = "T1=="+$.base64.encode( preCoded );
    // Token Achieved. The End

    response.success(token);
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T06:20:13.383

“文档未定义”通常是运行网络工作者的典型标志。如果您想访问该文档，请不要使用网络工作者。这是因为应该只有一个线程访问文档，以免造成冲突。

# c# - 通过 C#(VSTO)/VBA 访问 Excel 2010 公式编辑器

> ID：13924959
> 
> 赞同：2
> 
> 时间：2012-12-18T01:23:40.337
> 
> 标签：c#, excel, vba, editor, equation

我需要访问内置在 Excel 2010 中的公式编辑器。在 Word2010 中，它非常简单，因为它提供了 OMath 接口来通过 C# 或 VBA 访问它。尽管可以以这种方式插入方程式，但 Excel 中没有这样的东西。有没有人解决这个问题？我需要以文本方式从方程对象中提取方程（如果它是 Latex、MATHML 或任何其他语言，则无所谓。它必须是单个字符串）

当然，我可以使用 MathType 来执行此操作（实际上我已经使用 MathType 完成了此操作），但我不想强迫用户购买 MathType，因为 Excel 具有可以解决问题的内置功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T14:42:07.593

您是否尝试过首先添加 OLE 对象，如此链接中所述？

[http://www.techyv.com/questions/it-possible-equation-editor-vba-excel-2010](http://www.techyv.com/questions/it-possible-equation-editor-vba-excel-2010)

我对 Excel 的方程式行为没有大量经验，但似乎 Excel 不使用 OMath 对象。据我所理解：

您可以添加一个新的方程式：

```
ActiveSheet.OLEObjects.Add(ClassType:="Equation.3", Link:=False, DisplayAsIcon:=False) 
```

随后，您可以使用 OLEObjects 集合访问这些对象：

```
ActiveSheet.OLEObjects.Item(1) 
```

# c++ - glTexCoordPointer 不起作用

> ID：13924963
> 
> 赞同：0
> 
> 时间：2012-12-18T01:24:00.273
> 
> 标签：c++, opengl, textures

我正在尝试使用 渲染带有纹理的立方体`glTexCoordPointer`，但纹理没有显示，但其他一切都工作正常（顶点和法线）。

启用纹理的代码片段是这样的：

```
 glBindTexture(GL_TEXTURE_2D, material.texture()->id());
    glEnableClientState(GL_TEXTURE_COORD_ARRAY);
    glTexCoordPointer(2, GL_FLOAT, 0, mesh.texcoords().data());

    glDrawArrays(GL_TRIANGLES, 0, mesh.vertices().size()); 
```

我错过了什么？这需要着色器支持吗？

问候。

编辑：

我设法通过调用`glEnable(GL_TEXTURE_2D)`and使纹理工作`glClientActiveTexture(GL_TEXTURE0)`，但现在我遇到了另一个问题。当我移动相机时，纹理随机闪烁/闪烁。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T02:28:30.967

我解决了这个问题，实际上我分心加载纹理不止一次......

# jquery - 获取未选择的数据网格行jquery easyui

> ID：13924964
> 
> 赞同：1
> 
> 时间：2012-12-18T01:23:59.570
> 
> 标签：jquery, jquery-easyui

我正在使用[jQuery EasyUI 数据网格](http://www.jeasyui.com/documentation/datagrid.php)向我的用户呈现一些数据。我知道如何使用以下方法获取在数据网格中选择的行的数据：

```
var selectedRow = $('#my_datagrid_id').datagrid('getSelected'); 
```

但是有人知道我如何通过它的 id 或其他东西（没有选择行）在我的数据网格中获取特定的行吗？

我似乎无法在任何地方找到如何做到这一点

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T00:51:33.603

```
Try this one, then I think you will know what to do next :)

var myData = $('#my_datagrid_id').datagrid('getData');
alert('myData : ' + JSON.stringify(myData)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T10:24:07.440

你能试一下吗，

如果您想获取 ID 为“01”的行，

```
var row=$('#my_datagrid_id').datagrid('getRows')[$('#my_datagrid_id').datagrid('getRowIndex','01')]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T10:28:53.150

您可以使用...`getRows`获取所有行并循环遍历这些行..

```
 var rows=$('#my_datagrid_id').datagrid('getRows');
 if(rows.length == 0)
 {
     alert('no row present');
 }else{
    for(i=0;i<rows.length;i++)
    {
       //do your stuff here.. if your want particular row then u can use if condition 
    }
 } 
```

**或者**

如果你知道你想要的行的索引，那么你可以使用`getRowIndex`方法

[在此处](http://jeasyui.com/documentation/index.php)浏览文档

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-10T09:41:05.443

如您所知，要查找所有行，您应该尝试以下操作：

```
var allRows = $('#my_datagrid_id').datagrid('getRows'); 
```

要获取选定的行：

```
var selectedRows = $('#my_datagrid_id').datagrid('getSelections'); 
```

假设您知道您的特定行的索引，我们假设该索引为 5。要查找此特殊行是否被选中：

```
var specialRow= $.grep(selectedRows , function (e) {
   return e == allRows[5];
});
if(specialRow.length>0)
alert('Voila! The Row is selected');
else
alert('Nope! The Row is not selected'); 
```

通过`$.grep`您可以在数组中搜索（在我们的上下文中，在选定的行中），如果您的特定行在数组（选定的行）内，您将返回一个填充的 specialRow 数组。

# css-float - CSS 对齐问题（float vs text-align）

> ID：13924968
> 
> 赞同：2
> 
> 时间：2012-12-18T01:24:33.713
> 
> 标签：css-float

我试图在我的论坛上展示三件事：左上角的一堆媒体链接，右上角的菜单栏和它们下方的徽标居中。

使用这种方法，它在我的 localhost 设置中完全符合我的要求。但是，当我将它们上传到我的实时网站时，它看起来会有所不同吗？不同之处在于徽标似乎将媒体框“视为”其左边距，而离线则忽略它并以页面为中心。同样的浏览器，一切都是一样的，这就是为什么它如此莫名其妙。

```
#logo{
    display: block;
    text-align: center;
    margin-left: auto;
    margin-right: auto;
    }

#brdmenu {
    display: inline-block;
    float: right;
}

#media {
    display: inline-block;
    float: left;
    padding: 10px 10px 0px 10px;
} 
```

我希望这不是垃圾邮件，但可以在这里看到完整的 CSS（以及它看起来如何实时）：www.strengthandfitness.co.uk

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T01:32:54.523

问题可能是#logo 缺少宽度。更新的代码，在 Chrome/FF 中对我有用：

```
#logo {
    display: block;
    text-align: center;
    margin: 0 auto;
    width: 650px;
} 
```

# android - 提交后未触发表单验证

> ID：13924970
> 
> 赞同：-1
> 
> 时间：2012-12-18T01:24:43.473
> 
> 标签：android, jquery, cordova, jquery-mobile

我使用 Jquery mobile、Phonegap 和 jquery 验证来验证联系表单。所以当我使用索引页面中的链接从索引页面转到我的联系表单页面时会出现问题。然后当我尝试使用提交按钮验证我的表单时，即使表单无效，我的表单也已提交。但是，当我将我的联系表单设为我的索引页面时，这意味着我不会在页面之间导航，我的表单验证效果很好。这是我的联系页面的代码：

```
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Plane</title>
<script type="text/javascript" charset="utf-8" src="cordova-2.2.0.js"></script>
<link rel="stylesheet" type="text/css" href="jquery/css/jquery.mobile-1.2.0.min.css"/>
<link rel="stylesheet" type="text/css" href="css/inscription.css"/>
<script type="text/javascript" charset="utf-8" src="jquery/jquery-1.8.3.min.js"></script>
<script type="text/javascript" charset="utf-8" src="jquery/jquery.mobile-1.2.0.min.js"></script>
<script type="text/javascript" charset="utf-8" src="jquery/jquery.validate.min.js"></script>
<script type="text/javascript" charset="utf-8">
$(document).on("pageinit", "#main", function() {

    $("#add").validate({

    rules:
     {
      "name":{required:true},
      "comment":{required:true}
      }

    });

}); 
</script>
</head>
<body>

<div  data-theme="b" data-role="page" id="main">
<div  data-theme="b" data-role="header"  >
<a href="index.html">index</a>
<h1>Inscription</h1>
</div>
<div data-role="content">
     <form id="add" action="">
                    <div data-role="fieldcontain">
                        <fieldset data-role="controlgroup" data-mini="true">
                            <label for="nom">
                                Nom
                            </label>
                            <input name="name" id="name" placeholder="name" value="" type="text" />
                        </fieldset>
                    </div>
                    <div data-role="fieldcontain">
                        <fieldset data-role="controlgroup" data-mini="true">
                            <label for="prenom">
                                Prénom
                            </label>
                            <input name="comment" id="comment" placeholder="comment" value="" type="text" />
                        </fieldset>
                    </div>

                        <input id="submit" data-theme="c" type="submit" data-inline="true" value="submit">
                        <input  id="reset" type="reset" data-inline="true" value="reset" />

      </form>

</div>
</div>
</body>
</html> 
```

这是我的索引页：

```
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>plane</title>
<script type="text/javascript" charset="utf-8" src="cordova-2.2.0.js"></script>
<link rel="stylesheet" type="text/css" href="jquery/css/jquery.mobile-1.2.0.min.css"/>
<script type="text/javascript" charset="utf-8" src="jquery/jquery-1.8.3.min.js"></script>
<script type="text/javascript" charset="utf-8" src="jquery/jquery.mobile-1.2.0.min.js"></script>
<script type="text/javascript" charset="utf-8">
//*********************************************************
// Wait for Cordova to Load
//*********************************************************

document.addEventListener("deviceready", onDeviceReady, false);

function onDeviceReady() {

}
</script>
</head>
<body>
<div data-theme="b" data-role="page" id="main">
<div  data-theme="b" data-role="header">
<h1>plane</h1>
</div>
<div data-role="content">
some content
<a href="contact.html" data-role="button">begin</a>
</div>
</div>
</body>
</html> 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T10:11:06.280

尝试这些 url 进行验证 [http://ajax.aspnetcdn.com/ajax/jquery.validate/1.10.0/jquery.validate.min.js](http://ajax.aspnetcdn.com/ajax/jquery.validate/1.10.0/jquery.validate.min.js)

```
 <html>

  <head>

 <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
 <title>Gestion des tests</title>
 <script type="text/javascript" charset="utf-8" src="cordova-2.2.0.js"></script>
  <link rel="stylesheet" type="text/css" href="jquery/css/jquery.mobile-1.2.0.min.css"/>
  <link rel="stylesheet" type="text/css" href="css/inscription.css"/>
   <script type="text/javascript" charset="utf-8" src="jquery/jquery-1.8.3.min.js">        </script>
    <script type="text/javascript" charset="utf-8" src="jquery/jquery.mobile-1.2.0.min.js">      </script>
            <script type="text/javascript" charset="utf-8"      src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.10.0/jquery.validate.min.js"></script>
             <script type="text/javascript" charset="utf-8">
           $(document).on("pageshow", "#main", function() {

          $("#add").validate({

         rules:
              {
                 "name":{required:true},
                 "comment":{required:true}
             }

         });
     }); 
 </script>
 </head>
<body>

     <div  data-theme="b" data-role="page" id="main">
     <div  data-theme="b" data-role="header"  >
         <a href="index.html">index</a>
          <h1>Inscription</h1>
     </div>
     <div data-role="content">
            <form id="add" action="">
                <div data-role="fieldcontain">
                    <fieldset data-role="controlgroup" data-mini="true">
                        <label for="nom">
                            Nom
                        </label>
                        <input name="name" id="name" placeholder="name" value="" type="text" />
                    </fieldset>
                </div>
                       <div data-role="fieldcontain">
                    <fieldset data-role="controlgroup" data-mini="true">
                        <label for="prenom">
                            Prénom
                        </label>
                        <input name="comment" id="comment" placeholder="comment" value="" type="text" />
                    </fieldset>
                </div>

                    <input id="submit" data-theme="c" type="submit" data-inline="true"    value="submit">
                    <input  id="reset" type="reset" data-inline="true" value="reset" />

        </form>

    </div>
  </div>
  </body>
  </html>​ 
```

# python - 按键更新 pandas DataFrame

> ID：13924972
> 
> 赞同：6
> 
> 时间：2012-12-18T01:24:53.393
> 
> 标签：python, pandas

我有一个历史股票交易的数据框。该框架具有 ['ticker'、'date'、'cusip'、'profit'、'security_type'] 等列。最初：

```
trades['cusip'] = np.nan
trades['security_type'] = np.nan 
```

我有历史配置文件，我可以将它们加载到具有 ['ticker'、'cusip'、'date'、'name'、'security_type'、'primary_exchange'] 等列的框架中。

我想使用配置中的 cusip 和 security_type 更新交易框架，但仅限于代码和日期匹配的地方。

我以为我可以做类似的事情：

```
pd.merge(trades, config, on=['ticker', 'date'], how='left') 
```

但这不会更新列，它只是将配置列添加到交易中。

以下工作，但我认为必须有更好的方法。如果没有，我可能会在熊猫之外做。

```
for date in trades['date'].unique():
    config = get_config_file_as_df(date)
    ## config['date'] == date
    for ticker in trades['ticker'][trades['date'] == date]:
        trades['cusip'][ 
                           (trades['ticker'] == ticker)
                         & (trades['date']   == date)
                       ] \
            = config['cusip'][config['ticker'] == ticker].values[0]

        trades['security_type'][ 
                           (trades['ticker'] == ticker)
                         & (trades['date']   == date)
                       ] \
            = config['security_type'][config['ticker'] == ticker].values[0] 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-18T01:49:55.733

假设你有这个设置：

```
import pandas as pd
import numpy as np
import datetime as DT

nan = np.nan

trades = pd.DataFrame({'ticker' : ['IBM', 'MSFT', 'GOOG', 'AAPL'],
                       'date' : pd.date_range('1/1/2000', periods = 4), 
                       'cusip' : [nan, nan, 100, nan]
                       })
trades = trades.set_index(['ticker', 'date'])
print(trades)
#                    cusip
# ticker date             
# IBM    2000-01-01    NaN
# MSFT   2000-01-02    NaN
# GOOG   2000-01-03    100  # <-- We do not want to overwrite this
# AAPL   2000-01-04    NaN

config = pd.DataFrame({'ticker' : ['IBM', 'MSFT', 'GOOG', 'AAPL'],
                       'date' : pd.date_range('1/1/2000', periods = 4),
                       'cusip' : [1,2,3,nan]})
config = config.set_index(['ticker', 'date'])

# Let's permute the index to show `DataFrame.update` correctly matches rows based on the index, not on the order of the rows.
new_index = sorted(config.index)
config = config.reindex(new_index)    
print(config)
#                    cusip
# ticker date             
# AAPL   2000-01-04    NaN
# GOOG   2000-01-03      3
# IBM    2000-01-01      1
# MSFT   2000-01-02      2 
```

然后，您可以使用该方法`trades`的值更新 NaN​​ 值。请注意，根据索引匹配行（这就是上面调用的原因）。`config``DataFrame.update``DataFrame.update``set_index`

```
trades.update(config, join = 'left', overwrite = False)
print(trades)

#                    cusip
# ticker date             
# IBM    2000-01-01      1
# MSFT   2000-01-02      2
# GOOG   2000-01-03    100 # If overwrite = True, then 100 is overwritten by 3.
# AAPL   2000-01-04    NaN 
```

# sql - MERGE - 根据 WHEN MATCHED 块中的逻辑单独更新列值

> ID：13924973
> 
> 赞同：-1
> 
> 时间：2012-12-18T01:25:18.460
> 
> 标签：sql, sql-server, tsql, merge, data-warehouse

今天早些时候，我问了[这个问题](https://i.stack.imgur.com/VLA70.jpg)并得到了我正在寻找的答案。现在我有一个后续问题：

**我想要的是：**

我希望 MERGE 将目标表中的每一列值、每行值与源表中的相应值进行比较，并根据块中分隔的逻辑进行任何`OR`更新`WHEN MATCHED AND`。

如果块中分隔的任何逻辑为**真**，我担心我编写的代码（如下图所示）会在`THEN UPDATE SET`块中列出更新。**`OR``WHEN MATCHED AND`**

 **如果我的预感是正确的，您对如何重写代码以使其表现得像我希望的那样有什么建议吗？

![在此处输入图像描述](../Images/9c95fae4f0f03e3ecf5fa5a4ee4eafb1.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-18T15:25:35.083

没有您的数据，也不想从图像中重新输入您的查询，我创建了一个示例，我认为该示例演示了您想要什么：

```
create table t (ID int not null,Col1 int null,Col2 int null)
create table s (ID int not null,Col1 int null,Col2 int null)

insert into t(ID,Col1,Col2) values (1,1,null),(2,null,2)
insert into s(ID,Col1,Col2) values (1,3,4),(2,5,6),(3,7,8)

;merge into t
using s
on t.ID = s.ID
when not matched then insert (ID,Col1,Col2) values (s.ID,s.Col1,s.Col2)
when matched then update
set Col1 = COALESCE(t.Col1,s.Col1),
Col2 = COALESCE(t.Col2,s.Col2)
;
select * from t 
```

结果：

```
ID          Col1        Col2
----------- ----------- -----------
1           1           4
2           5           2
3           7           8 
```

如果它已经有一个列值，那么关键是用来`COALESCE`避免更新一个列值（我认为这是你想要实现的）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T05:43:54.160

我不确定我是否理解这个问题 - 你的意思是......好吧，我不确定你的意思。减去额外的尾随 OR，您有两个条件。如果其中一个（或两者）评估为 TRUE，则目标表将由 THEN UPDATE 更新

但是，您在 unique_key 上进行 MATCHing，第一个条件（s.unique_key IS NOT NULL AND t.unique_key IS NULL）永远不会为真，因为如果它为真，那么记录将不会匹配。所以 OR 的第一部分可以忽略。

此外，由于记录在 unique_key 上匹配，因此使用 unique_key 的源值更新目标是完全多余的——它们已经相同。

因此，正如目前所写，您的 MERGE 是：

```
MERGE dbo.input311 AS T
USING dbo.input311staging AS S
ON S.unique_key = S.unique_key
WHEN NOT MATCHED BY TARGET THEN
   INSERT
     -- insert statement I'm too lazy to type
WHEN MATCHED AND s.created_date IS NOT NULL AND t.created_date IS NULL THEN
   UPDATE SET t.created_date = s.created_date 
```**

# python - Qt：获取父母区域内的所有孩子

> ID：13924980
> 
> 赞同：3
> 
> 时间：2012-12-18T01:26:13.127
> 
> 标签：python, qt, pyqt

这是我的第一个问题，请耐心等待！

目前在我的程序中，我有一个作为画布的父小部件。用户可以在运行时向父级添加或删除小部件。然后给这些小部件一个绝对位置，也就是说，它们不是由布局定位的。添加后，用户可以任意移动小部件。

我希望用户能够通过在它们周围拖动一个框来选择一组小部件。我已经编写了在用户拖动时显示矩形的部分。现在，我希望能够检索该矩形（区域）内的所有小部件。

我知道 findChild() 和 findChildren() 函数，它们确实按预期返回了孩子。但我真正需要的是一种将搜索限制在区域边界的方法，因为“画布”中很可能会有很多小部件。（由于我正在做的事情的性质，可能有数千个小部件分布在一个非常大的区域！）

**这是我的问题：**什么是我最好的选择？我是否应该继续使用 findChildren() 并遍历列表以手动查找该区域内的孩子。还是应该使用 findChild(x, y) 遍历区域内的所有像素？或者也许有一个更简单的解决方案可以加快这个过程？类似于 findChildren(x, y, width, height) 的东西？

希望我的问题是有道理的。我试图尽可能地解释事情。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T07:58:08.177

如果您使用`QGraphicsScene`而不是自己滚动，您可以使用这些`items(..)`方法非常有效地在特定区域找到您的孩子。

之所以可能，`QGraphicsScene`是因为它使用了 BSP 空间加速结构，因此如果您无法`QGraphicsScene`在合理的时间内迁移到 - 您将自己编写。这并不像听起来那么难，我已经编写了许多*边界体积层次*结构，它们非常简单。

# linux - 如何在Linux中允许给定用户读/写的同时加密数据

> ID：13924982
> 
> 赞同：0
> 
> 时间：2012-12-18T01:26:45.330
> 
> 标签：linux, encryption, ecryptfs

我目前正在做一个Java搜索项目，该项目将分发到客户的本地服务器，该项目包含一些有价值的数据，我们希望它不能直接在机器上访问，而只能从项目服务/apis访问。数据将每天更新，并且需要可供 24/7 查询。我正在考虑eCryptFs，但经过一些测试，似乎一旦加密数据安装在服务用户下，比如'root1'，因为我必须将加密数据保持在安装状态以支持查询，所有其他登录用户无需密码即可访问解密后的数据。反正有支持我的方案吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T03:47:48.090

If your users don't have root access, you can simply store the encryption key in a file and deny read access to other users.

If your users do have root access, there is nothing you can do.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T01:38:18.367

编辑：在大多数情况下，拥有 root 帐户的人可以做其他用户可以做的任何事情。因此，即使您确实获得了文件的每个用户 r/w 权限，但仅针对某个用户（这很有可能），这也毫无意义。（具有 sudo/root 访问权限的人可以运行`sudo su USER`，其中 USER 是具有 r/w 权限的帐户。我认为解决此问题的更好方法是查看用户无法控制的选项。第一件事来要记住的是编译程序。虽然它们并不是真正用于保存安全信息，~~但您可以编译一个简单的程序以在一段时间延迟后输出一点信息（以防止它们只是连续运行它然后编译所有他们从中获得的数据。）~~实际上，修改 Java 程序可能更容易；只需让它将信息存储为一个巨大的字符串或其他东西。:D [这些开源 Java 混淆](http://java-source.net/open-source/obfuscators)器将使逆向工程变得更加困难（但肯定不是不可能），逆向工程以及随之而来的内部数据。

一个更安全的选择是编写一个 C 程序，对其进行编译，并让它输出信息（在时间延迟之后），然后 JAVA 文件可以管理这些信息。为了使其更难反编译，您可以在字符串中添加一些加密方法，这样如果反编译器弄乱了它的任何部分，它对他们来说仍然是毫无价值的信息。

最终判决：当它存储在别人的计算机上时，没有什么是真正 100% 安全的，但同样，它在您自己的服务器上也不是 100% 安全的。我建议考虑其他选项，但如果您没有其他选择并且您对信息有法律保护，这*可能*对您有用。

# python - Django：覆盖 get_FOO_display()

> ID：13924985
> 
> 赞同：11
> 
> 时间：2012-12-18T01:27:21.710
> 
> 标签：python, django

一般来说，我不熟悉 python 覆盖方法和使用 super() 的方式。

问题是：我可以覆盖`get_FOO_display()`吗？

```
class A(models.Model):
   unit = models.IntegerField(choices=something)

   def get_unit_display(self, value):
     ... use super(A, self).get_unit_display() 
```

我想覆盖 get_FOO_display() 因为我想复数我的显示。

但`super(A, self).get_unit_display()`不起作用。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-18T10:36:23.597

通常，您只需覆盖一个方法，如您所示。但这里的技巧是该`get_FOO_display`方法不存在于超类中，因此调用该`super`方法将什么都不做。该方法由元类添加到模型时由字段类动态添加 - 请参见[此处的源代码](https://github.com/django/django/blob/master/django/db/models/fields/__init__.py#L253)（编辑：过时链接为[永久链接](https://github.com/django/django/blob/8aad3321ed6f0b603361767a4fe00d046b5fdd34/django/db/models/fields/__init__.py#L742-L744)）。

您可以做的一件事是为您的`unit`字段定义一个自定义 Field 子类，并覆盖`contribute_to_class`，以便它构造您想要的方法。不幸的是，这有点棘手。

（我不明白你的第二个问题。你到底在问什么？）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-10-19T23:18:37.547

现在在 Django > [2.2.7](https://docs.djangoproject.com/en/3.1/releases/2.2.7/)：

> 恢复了覆盖 get_FOO_display() (#30931) 的能力。

您可以覆盖：

```
 class FooBar(models.Model):
        foo_bar = models.CharField(_("foo"),  choices=[(1, 'foo'), (2, 'bar')])

        def get_foo_bar_display(self):
            return "something" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-02-26T17:30:48.597

你可以这样做：

1.  覆盖 Django`IntegerField`以复制您的`get_FOO_display`函数：

    ```
    class MyIntegerField(models.IntegerField):
        def contribute_to_class(self, cls, name, private_only=False):
            super(MyIntegerField, self).contribute_to_class(cls, name, private_only)
            if self.choices is not None:
                display_override = getattr(cls, 'get_%s_display' % self.name)
                setattr(cls, 'get_%s_display_override' % self.name, display_override) 
    ```

2.  在您的班级中，将您的选择字段替换为`MyIntegerField`：

    ```
    class A(models.Model):
       unit = MyIntegerField(choices=something) 
    ```

3.  最后，使用复制函数返回超值：

    ```
     def get_unit_display(self, value):
           if your condition:
              return your value
           return self.get_unit_display_override() 
    ```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-12-18T01:42:04.013

您应该能够通过在子类上创建具有相同名称的方法来覆盖超类上的任何方法。不考虑参数签名。例如：

```
class A(object):
    def method(self, arg1):
        print "Method A", arg1

class B(A):
    def method(self):
        print "Method B"

A().method(True) # "Method A True"
B().method() # "Method B" 
```

在 get_unit_display() 的情况下，如果要更改显示值，则根本不必调用 super()，但如果要使用 super()，请确保使用正确的签名调用它， 例如：

```
class A(models.Model):
    unit = models.IntegerField(choices=something)

    def get_unit_display(self, value):
        display = super(A, self).get_unit_display(value)
        if value > 1:
            display = display + "s"
        return display 
```

请注意，我们将值传递给 super() 的 get_unit_display()。

# javascript - 加载 JS 文件两次但只解析一次对性能有何影响？

> ID：13924988
> 
> 赞同：0
> 
> 时间：2012-12-18T01:27:36.263
> 
> 标签：javascript, performance, browser, include

我正在使用经常多次加载相同的外部 javascript 文件的遗留代码。

我正在尝试决定是否需要找到所有**加载** `.js`文件的位置并阻止它们重新加载文件（如果文件已经存在），或者我是否可以简单地修改所有`.js`文件以防止它们被**解析**已经被解析了。

例如。假设我有一个`.js`名为`utils.js`.

```
if(!utils_Loaded){
   var utils_Loaded = true;
   var utils = function() {

     //javasript code here

   };
} else {
   console.log("utils.js was already loaded, so we skipped parsing it again.");
} 
```

但是，还有大约 500 个其他包含仍在加载`utils.js`中，所以实际上，HTML 看起来像这样：

```
<script src="/utils.js"></script> ...
<script src="/utils.js"></script> ...
<script src="/utils.js"></script> ...
<script src="/utils.js"></script> ...
<script src="/utils.js"></script> ...
<script src="/utils.js"></script> (... etc) 
```

所以我的问题是，现代浏览器将如何处理多重加载？我假设浏览器会缓存文件，但它仍然必须再次将其拉入内存，这可能很小，直到成倍增加，因为这在代码中**无处不**在，数百个文件都被多次加载。

在包含点检查会更好吗？

```
<script>if(!utils_Loaded){$.getScript("utils.js");}</script> ...
<script>if(!utils_Loaded){$.getScript("utils.js");}</script> ...
<script>if(!utils_Loaded){$.getScript("utils.js");}</script> ...
<script>if(!utils_Loaded){$.getScript("utils.js");}</script> ...
<script>if(!utils_Loaded){$.getScript("utils.js");}</script> ...
<script>if(!utils_Loaded){$.getScript("utils.js");}</script> (...etc) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T01:38:23.077

可能需要一些时间，但最好的办法就是把它清理干净。您可以使用页面加载 utils.js 一次（如果它被使用的次数与您所说的一样多，那么不这样做似乎很愚蠢）。您还可以将加载抽象到一个函数中，以帮助集中您的 utils_loaded 检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T01:50:36.653

只要您的网络服务器使用未修改响应，就会有一堆不必要的 GET 请求......

顺便说一句，如果您使用的是 ASP/PHP 或同等版本，我建议将该行放入文件中并替换为 include_once('tagline.js');

编辑：有趣的旁注，做了一些测试，似乎在 chrome(23) 和 Internet Explorer(9) 和 Opera(12.11) 中有一个错误，使它只加载一次；即使使用 HTTP 标头“Cache-Control: no-cache, must-revalidate”：p（但不是 firefox）

# security - 以组名作为用户名的 AIX mkuser

> ID：13924989
> 
> 赞同：0
> 
> 时间：2012-12-18T01:27:48.213
> 
> 标签：security, aix

我正在运行一堆 AIX 系统，我想改变创建用户的方式。

默认情况下，用户以组分配（主要和唯一组成员身份）为员工。我想将其设置为 $USERNAME。

我查看了 /etc/mkuser.default 文件，它通过执行 /home/$USER 设置主目录，所以我尝试为 pgrp 和组变量重用 $USER 变量，但是它返回说组不当我尝试创建用户时不存在。

有谁知道这是否可能？一个可行的解决方案是在创建用户时运行自定义脚本，但是 mkuser.default 似乎只读取用户节中的变量设置。

谢谢大家，

伊恩。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T06:47:04.783

您收到错误是因为在将用户添加到该组之前应该存在该组。因此，您可以尝试编写这样的 shell 脚本来创建用户：

```
#!/bin/ksh
user_name=$1
if [ -z "$user_name" ]
then
    echo "No Username specified"
    return 3
fi
mkgroup $user_name || {
    echo "mkgroup $user_name failed";
    return 4;
}
mkuser pgrp=$user_name $user_name || {
    echo "mkuser $user_name failed";
    return 5;
} 
```

并像这样执行它：

```
./create_user.sh red
./create_user.sh blue
./create_user.sh green 
```

**确保在删除用户时删除已创建的组**

因此删除用户的 shell 脚本可能如下所示：

```
#!/bin/ksh
user_name=$1
if [ -z "$user_name" ]
then
    echo "No Username specified"
    return 3
fi
rmuser $user_name || {
    echo "rmuser $user_name failed";
    return 4;
}
rmgroup $user_name || {
    echo "rmgroup $user_name failed";
    return 5;
} 
```

我正在研究 mkuser.default 文件。据我所知**，mkuser.default**是从AIX 7.1的**/usr/lib/security文件夹中获取的**

**另一件需要注意的事情：**当您删除用户和组时，主目录 /home/ 仍然存在。如果您要创建具有相同名称的用户名/组，请确保执行以下操作：

```
chown -R <username>:<groupname> /home/<username> 
```

再次创建用户后。

# eclipse - 如何让 Eclipse 和 mvn appengine:devserver 相互通信？

> ID：13924990
> 
> 赞同：31
> 
> 时间：2012-12-18T01:28:05.323
> 
> 标签：eclipse, google-app-engine, maven

我正在从[Google Plugin for Eclipse](https://developers.google.com/eclipse/)切换到官方的 Google [App Engine Maven Plugin](https://developers.google.com/appengine/docs/java/tools/maven)。我希望，我无法弄清楚的最后一件事是如何设置良好的调试工作流程。当我使用 GPE 时，我只是设置了断点，调试器会自动停在那里，但是当我通过 运行开发服务器时`mvn appengine:devserver`，我认为开发服务器和 eclipse 不知道彼此。

我如何让他们互相交谈？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-01-03T16:03:06.880

第一个选项是将您的项目设置为使用 @ [https://cloud.google.com/appengine/docs/java/webtoolsplatform](https://cloud.google.com/appengine/docs/java/webtoolsplatform)中记录的 WTP 。这是我切换到的方法。

第二个选项是使用两个调试配置。

第一个调试配置将运行您的 Maven 目标，即`appengine:devserver`. ![在此处输入图像描述](../Images/b93f6957890ea2c53d71ab529732348f.png)

第二个是`Remote Java Application`配置，将调试客户端连接到 devserver jvm。
![在此处输入图像描述](../Images/96537f906e29ab84c00b1c6a632892a0.png)

这也需要将一些 jvm 参数传递给 maven 目标。

```
<!-- GAE plugin -->
<plugin>
    <groupId>com.google.appengine</groupId>
    <artifactId>appengine-maven-plugin</artifactId>
    <version>1.7.5-SNAPSHOT</version>
    <configuration>
        <jvmFlags>
            <jvmFlag>-Xdebug</jvmFlag>
            <jvmFlag>-Xrunjdwp:transport=dt_socket,address=1044,server=y,suspend=y
            </jvmFlag>
        </jvmFlags>
        <disableUpdateCheck>true</disableUpdateCheck>
    </configuration>
</plugin> 
```

一旦这 3 件事到位，运行 maven 调试配置，然后运行调试客户端配置，然后运行您的应用程序。

尚不支持热插拔，因此如果您更改任何非资源文件（任何 java 源），开发服务器将看不到它们。资源文件将被部署（静态文件：html、js）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T03:53:07.713

您应该在**调试模式下**从**eclipse执行****mvn**。

 ****![在此处输入图像描述](../Images/b4cd6e9721ac9358c47a23f2af6ae071.png)

在 Eclipse 中，您可以从 Eclipse 顶部工具栏**“运行”->“调试配置”->“Maven 构建”配置此类 Maven 构建命令**

一旦在 Maven 中以 Eclipse 调试模式启动，您应该能够命中断点。

**编辑**- 另一种选择是设置远程调试，即**“运行”->“调试配置”->“远程 Java 应用程序”**并监听远程调试端口，即您应该确保 appengine:devserver 使用远程调试端口参数启动 - 参考 -[远程在eclipse中调试](https://stackoverflow.com/questions/4346018/remote-debugging-in-eclipse)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T20:54:15.307

这个[问题](https://stackoverflow.com/questions/13915341/appengine-maven-plugin-configuration-options-like-jvm-flags)可能会给你一个问题的提示。Maven appengine:devserver 在单独的进程中启动开发服务器。然而，Eclipse 只知道 Maven 进程本身（这是您在调试视图中看到的）。此外，由于无法使用调试端口等参数启动开发服务器，因此它可能永远无法连接到调试器。

链接的问题表明有一个非官方的 Maven GAE 插件需要参数。还有一张增强官方插件的新票，插件开发人员承诺很快实现此功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-02T22:40:08.853

我会看看我还能做些什么来使 eclipse 集成更容易，但现在有更新到 appengine-maven-plugin 项目的问题：[http ://code.google.com/p/appengine-maven -plugin/issues/detail?id=3&can=1](http://code.google.com/p/appengine-maven-plugin/issues/detail?id=3&can=1)所以看看是否支持 jvm 参数可以帮助你。

请让我知道你的经历，我总是支持很棒的事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-11-25T07:48:55.037

# 2015年相关答案

我在 2015 年 9 月创建了一个 GAE (Java) 项目，以下内容适用于这个项目和类似项目。

我首先使用 Skeleton 原型在普通 GAE maven 项目上创建我的项目，只需遵循[使用 Apache Maven-Java — Google Cloud Platform](https://cloud.google.com/appengine/docs/java/tools/maven)中的相关步骤。从[需求](https://cloud.google.com/appengine/docs/java/tools/maven#requirements)一直到[使用开发服务器测试您的应用程序](https://cloud.google.com/appengine/docs/java/tools/maven#testing_your_app_with_the_development_server)。

之后，我使用“导入现有的 Maven 项目”将该项目导入 Eclipse JEE (Mars)。开始开发。

当我需要调试时，我只需要执行下面解释的几个步骤。

### 创建调试配置

转到**Run -> Debug Configurations**，单击*Remote Java Application*并通过单击**New**按钮创建一个新配置（参见屏幕截图，过滤器文本框上方的左上角）。

[![为远程 Java 应用程序创建新的调试配置](../Images/886904a7b1605206536a8400b5dccfb0.png)](https://i.stack.imgur.com/53EsL.png)

通过选择您的特定项目并为配置指定一个合适的名称来填写详细信息，如下所示（让端口为 8000），然后单击**Apply**：

[![调试配置的设置](../Images/b5bdd616ec282f2fdad9c914b090d732.png)](https://i.stack.imgur.com/Mbaz9.png)

### 取消注释 pom.xml 中的某些行

在项目的 pom.xml 中，找到插件的配置`appengine-maven-plugin`并取消注释以下行：

```
 <jvmFlags>
                    <jvmFlag>-agentlib:jdwp=transport=dt_socket,address=8000,server=y,suspend=n</jvmFlag>
                </jvmFlags> 
```

### `mvn appengine:devserver`从命令行运行命令

正如标题所说...

### 从 Eclipse 中附加调试器

**单击Debug**按钮旁边的小三角形，然后选择您刚刚设置的调试配置的名称（在我的示例中为“HelloWorldServlet”）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-07-22T14:26:00.107

我大致按照@ [developers.google.com](http://developers.google.com/appengine/docs/java/webtoolsplatform) /appengine/docs/java/webtoolsplatform 的步骤来支持我以前的方法。****

# three.js - Three.js 水着色器从 r48 迁移到 r52

> ID：13924991
> 
> 赞同：0
> 
> 时间：2012-12-18T01:28:10.397
> 
> 标签：three.js

我正在开发一个化学模拟项目。我正在寻找水模拟。我已经从这个例子[http://waterstretch.ecoulon.com/中提取了代码](http://waterstretch.ecoulon.com/)

它使用 Three.js r48 并且提取的代码完美运行。现在我尝试将我的项目的工作代码升级到 Three.js r52。该示例显示没有任何控制台错误的黑屏：OI 测试了 Three.js r49 和更新版本但没有帮助，我在更改日志中找不到任何有用的信息。 [https://github.com/mrdoob/three.js#change-log](https://github.com/mrdoob/three.js#change-log)。

和迁移说明 [https://github.com/mrdoob/three.js/wiki/Migration](https://github.com/mrdoob/three.js/wiki/Migration)

这是代码

水.html

```
 <!DOCTYPE html>
<html lang="en">
<head>
    <title>WaterStretch</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

</head>
<body >

<!--<script src="../../js/libs/three.js/three-52.js"></script>-->
<!--<script src="./lib/three-48.js"></script>-->
<script src="./lib/three-49.js"></script>

<script src="./lib/shaders/BasicShader.js"></script>
<script src="./lib/shaders/BleachBypassShader.js"></script>
<script src="./lib/shaders/BlendShader.js"></script>
<script src="./lib/shaders/BokehShader.js"></script>
<script src="./lib/shaders/BrightnessContrastShader.js"></script>
<script src="./lib/shaders/ColorCorrectionShader.js"></script>
<script src="./lib/shaders/ColorifyShader.js"></script>
<script src="./lib/shaders/ConvolutionShader.js"></script>
<script src="./lib/shaders/CopyShader.js"></script>
<script src="./lib/shaders/DOFMipMapShader.js"></script>
<script src="./lib/shaders/DotScreenShader.js"></script>
<script src="./lib/shaders/FilmShader.js"></script>
<script src="./lib/shaders/FocusShader.js"></script>
<script src="./lib/shaders/FXAAShader.js"></script>
<script src="./lib/shaders/HorizontalBlurShader.js"></script>
<script src="./lib/shaders/HorizontalTiltShiftShader.js"></script>
<script src="./lib/shaders/HueSaturationShader.js"></script>
<script src="./lib/shaders/LuminosityShader.js"></script>
<script src="./lib/shaders/NormalMapShader.js"></script>
<script src="./lib/shaders/SepiaShader.js"></script>
<script src="./lib/shaders/SSAOShader.js"></script>
<script src="./lib/shaders/TriangleBlurShader.js"></script>
<script src="./lib/shaders/UnpackDepthRGBAShader.js"></script>
<script src="./lib/shaders/VerticalBlurShader.js"></script>
<script src="./lib/shaders/VerticalTiltShiftShader.js"></script>
<script src="./lib/shaders/VignetteShader.js"></script>

<script src="../../js/libs/DAT.GUI.min.js"></script>
<script src="../../js/libs/stats.min.js"></script>
<script src="../../js/libs/Detector.js"></script>
<script src="../../js/libs/RequestAnimationFrame.js"></script>

<script src="./water.js"></script>

<div id="error"></div>
<script>

    window.Stats = Stats;
    window.DAT.GUI = DAT.GUI;

    init();
    animate();
</script>

</body>
</html> 
```

和 water.js

```
 THREE.HeightMapShader = {
    uniforms:{
        tData:{
            type:"t",
            value:0,
            texture:null
        },
        mousePoint:{
            type:"v2",
            value:new THREE.Vector2(-1, -1)
        },
        mouseActive:{
            type:"i",
            value:0
        },
        texelSize:{
            type:"v2",
            value:new THREE.Vector2(0, 0)
        },
        radius:{
            type:"f", value:0.01
        },
        strength:{
            type:"f",
            value:0.1
        }
    },
    vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1\. - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",
    fragmentShader:"const float v=3.14159;uniform sampler2D tData;uniform vec2 texelSize,mousePoint;uniform int mouseActive;uniform float radius,strength;varying vec2 vUv;void main(){vec4 t=texture2D(tData,vUv);if(mouseActive>=1){float m=max(0.,1.-length(mousePoint-vUv)/radius);m=.5-cos(m*v)*.5;t.r-=m*strength;}vec2 m=vec2(texelSize.r,0.),r=vec2(0.,texelSize.g);float f=(texture2D(tData,vUv-m).r+texture2D(tData,vUv-r).r+texture2D(tData,vUv+m).r+texture2D(tData,vUv+r).r)*.25;t.g+=(f-t.r)*2.;t.g*=.995;t.r+=t.g;t.r*=.995;gl_FragColor=vec4(t.r,t.g,t.b,1.);}"
};

THREE.NormalMapShader = {
    uniforms:{
        tData:{
            type:"t",
            value:0,
            texture:null
        },
        texelSize:{
            type:"v2",
            value:new THREE.Vector2(0, 0)
        }
    },
    vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x,  1\. - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",
    fragmentShader:"uniform sampler2D tData;uniform float deltaNormal;uniform vec2 texelSize;varying vec2 vUv;void main(){vec3 t=vec3(2.,max(texture2D(tData,vUv+vec2(texelSize.r,0.)).r,texture2D(tData,vUv+vec2(texelSize.r,0.)).b)-max(texture2D(tData,vUv-vec2(texelSize.r,0.)).r,texture2D(tData,vUv-vec2(texelSize.r,0.)).b),0.),v=vec3(0.,max(texture2D(tData,vUv+vec2(0.,texelSize.g)).r,texture2D(tData,vUv+vec2(0.,texelSize.g)).b)-max(texture2D(tData,vUv-vec2(0.,texelSize.g)).r,texture2D(tData,vUv-vec2(0.,texelSize.g)).b),2.),r=cross(t,v);gl_FragColor=vec4(r,1.);}"
};

THREE.Pass2Shader = {
    uniforms:{
        tDataSampler:{
            type:"t",
            value:0,
            texture:null
        },
        texelSize:{
            type:"v2",
            value:new THREE.Vector2(0, 0)
        },
        divCaustic:{
            type:"f", value:3550
        }
    },
    vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x,  1\. - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",
    fragmentShader:"uniform sampler2D tDataSampler;uniform float divCaustic;uniform vec2 texelSize;varying vec2 vUv;void main(){float v=0.;v+=mod(texture2D(tDataSampler,vUv+vec2(0.,-3.*texelSize.g)).r,1000.)/255.;v+=mod(texture2D(tDataSampler,vUv+vec2(0.,-2.*texelSize.g)).g,1000.)/255.;v+=mod(texture2D(tDataSampler,vUv+vec2(0.,-1.*texelSize.g)).b,1000.)/255.;v+=floor(texture2D(tDataSampler,vUv).r/1e+06)/255.;v+=floor(texture2D(tDataSampler,vUv+vec2(0.,texelSize.g)).r/1000.)/255.;v+=floor(texture2D(tDataSampler,vUv+vec2(0.,2.*texelSize.g)).g/1000.)/255.;v+=floor(texture2D(tDataSampler,vUv+vec2(0.,3.*texelSize.g)).b/1000.)/255.;v/=divCaustic;gl_FragColor=vec4(v,v,v,1.);}"
};

THREE.Pass1Shader = {
    uniforms:{
        tData:{
            type:"t",
            value:0,
            texture:null
        },
        tNormalMap:{
            type:"t",
            value:1,
            texture:null
        },
        texelSize:{
            type:"v2",
            value:new THREE.Vector2(0, 0)
        },
        P_G:{
            type:"v2",
            value:new THREE.Vector2(0.5, 0.5)
        }
    },
    vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1\. - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",
    fragmentShader:"#define N 7\n#define N_HALF 3\nvec2 getIntersection(sampler2D normalMap,sampler2D heightMap,vec2 uvCoord,vec2 texelSize){vec3 normal=texture2D(normalMap,uvCoord).rgb;float P_Y=texture2D(heightMap,uvCoord).r,k=P_Y*normal.g*64.;return vec2(normal.r*k*texelSize.r,normal.b*k*texelSize.g);}uniform sampler2D tData,tNormalMap;uniform vec2 texelSize,P_G;varying vec2 vUv;void main(){vec2 P_C=vUv,P_G=vec2(.5,.5);float intensity[N];for(int ii=0;ii<N;ii++)intensity[ii]=0.;float P_Gy[N];for(int iii=-N_HALF;iii<=N_HALF;iii++)P_Gy[iii+N_HALF]=P_G.g+float(iii)*texelSize.g;for(int i=0;i<N;i++){vec2 pN=P_C+float(i-N_HALF)*texelSize,intersection=getIntersection(tNormalMap,tData,pN,texelSize);float ax=max(0.,1.-abs(P_G.r-intersection.r));for(int j=0;j<N;j++){float ay=max(0.,1.-abs(P_Gy[j]-intersection.g));intensity[j]+=ax*ay;}}float rChannel=floor(intensity[3]*255.)*1e+06+floor(intensity[4]*255.)*1000.+floor(intensity[0]*255.),gChannel=floor(intensity[5]*255.)*1000.+floor(min(intensity[1],3.9)*255.),bChannel=floor(intensity[6]*255.)*1000.+floor(min(intensity[2],3.9)*255.);gl_FragColor=vec4(rChannel,gChannel,bChannel,1.);}"
};

THREE.FresnelShader = {
    uniforms:{
        tData:{
            type:"t",
            value:0,
            texture:null
        },
        tGround:{
            type:"t",
            value:3,
            texture:null
        },
        tSky:{
            type:"t",
            value:4,
            texture:null
        },
        tCaustic:{
            type:"t",
            value:2,
            texture:null
        },
        tNormalMap:{
            type:"t",
            value:1,
            texture:null
        },
        uGroundRepeat:{
            type:"v2",
            value:new THREE.Vector2(1, 1)
        },
        texelSize:{
            type:"v2",
            value:new THREE.Vector2(1, 1)
        },
        lightDir:{
            type:"v3",
            value:new THREE.Vector3(0, 1, 1)
        },
        heightMapFactor:{
            type:"v3",
            value:new THREE.Vector3(256, 64, 256)
        },
        viewPosition:{
            type:"v3",
            value:new THREE.Vector3(0, 256, 0)
        },
        caustics:{
            type:"i",
            value:1
        },
        dirLight:{
            type:"i",
            value:1
        }
    },
    vertexShader:"varying vec2 vUv;\nvarying mat4 mvm;\nvoid main() {\nvUv = vec2( uv.x,  uv.y );\nmvm = modelViewMatrix;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",
    fragmentShader:"uniform float causticRatio;uniform vec2 uGroundRepeat;uniform vec3 viewPosition,heightMapFactor,lightDir;uniform sampler2D tData,tNormalMap,tGround,tSky,tCaustic;uniform int caustics,dirLight;uniform vec2 texelSize;varying vec2 vUv;varying mat4 mvm;void main(){vec3 v=vec3(vUv.r*heightMapFactor.r,texture2D(tData,vUv).r*heightMapFactor.g,vUv.g*heightMapFactor.b),t=vec3(vUv.r*256.-128.,texture2D(tData,vUv).r*heightMapFactor.g,vUv.g*256.-128.),r=-normalize(texture2D(tNormalMap,vUv).rgb),b=v-vec3(heightMapFactor.r/2.,256.,heightMapFactor.b/2.),n=t-vec3(0.,300.,0.),h=reflect(-normalize(b),r),u;u=refract(normalize(b),r,1.);vec3 m=refract(normalize(n),r,1.);vec4 a=texture2D(tSky,vec2(h.r,h.b)),g=texture2D(tGround,vec2(u.r,u.b)/u.g*uGroundRepeat+.5);if(caustics==1)g*=pow(max(texture2D(tCaustic,vec2(m.r,m.b)+.5).r,.35)+.5,4.);g.a=1.;gl_FragColor=mix(g,a,.2);if(dirLight==1){float d=pow(max(dot(r,normalize(lightDir))+.2,1.),8.);vec3 c=vec3(d,d,d);gl_FragColor.rgb*=c;}}"
};

THREE.WaterComposer = function (a) {
    this.renderer = a;
    this.renderTargetNearestFloatParams = {
        minFilter:THREE.NearestFilter,
        magFilter:THREE.NearestFilter,
        wrapS:THREE.RenderTargetWrapping,
        wrapT:THREE.RenderTargetWrapping,
        format:THREE.RGBFormat,
        stencilBuffer:!1,
        depthBuffer:!1,
        type:THREE.FloatType
    };
    this.renderTargetLinearParams = {
        minFilter:THREE.LinearFilter,
        magFilter:THREE.LinearFilter,
        wrapS:THREE.RenderTargetWrapping,
        wrapT:THREE.RenderTargetWrapping,
        format:THREE.RGBFormat,
        stencilBuffer:!1,
        depthBuffer:!1
    };

    this.renderTargetLinearFloatParams = {
        minFilter:THREE.LinearFilter,
        magFilter:THREE.LinearFilter,
        wrapS:THREE.RenderTargetWrapping,
        wrapT:THREE.RenderTargetWrapping,
        format:THREE.RGBFormat,
        stencilBuffer:!1,
        depthBuffer:!1,
        type:THREE.FloatType
    };

    if (!a.context.getExtension("OES_texture_float")) {
        throw document.getElementById("error").style.display = "block", document.getElementById("error").innerHTML = "Requires OES_texture_float extension<br/>", "Requires OES_texture_float extension";
    }
    if (!a.context.getParameter(a.context.MAX_VERTEX_TEXTURE_IMAGE_UNITS)) {
        document.getElementById("error").style.display = "block", document.getElementById("error").innerHTML += "Your graphic card doesn't support vertex shader textures.";
    }

    this.initShader()
};

THREE.WaterComposer.prototype = {

    render:function () {
        this.renderPassHeightMap();
        this.renderPassHeightMap();
        this.renderPassNormalMap();
        caustics && (this.renderPass1(), this.renderPass2())
    },

    swapHeightMapBuffers:function () {
        var a = this.renderTargetHeightMap;
        this.renderTargetHeightMap = this.renderTargetHeightMap2;
        this.renderTargetHeightMap2 = a
    },

    renderPassHeightMap:function () {
        this.heightMapMaterial.uniforms.tData.texture = this.renderTargetHeightMap;
        THREE.WaterComposer.quad.material = this.heightMapMaterial;
        this.renderer.render(THREE.WaterComposer.scene,
            THREE.WaterComposer.camera, this.renderTargetHeightMap2, !1);
        this.swapHeightMapBuffers();
        if (1 <= this.heightMapMaterial.uniforms.mouseActive.value)this.heightMapMaterial.uniforms.mouseActive.value = 0
    },

    renderPassNormalMap:function () {
        THREE.WaterComposer.quad.material = this.normalMapMaterial;
        this.renderer.render(THREE.WaterComposer.scene, THREE.WaterComposer.camera, this.renderTargetNormalMap, !1)
    },

    renderPass1:function () {
        THREE.WaterComposer.quad.material = this.material1;
        this.renderer.render(THREE.WaterComposer.scene,
            THREE.WaterComposer.camera, this.renderTargetPass1, !1)
    },

    renderPass2:function () {
        THREE.WaterComposer.quad.material = this.material2;
        this.renderer.render(THREE.WaterComposer.scene, THREE.WaterComposer.camera, this.renderTargetPass2, !1)
    },

    initRenderTargets:function (a, b) {
        this.renderTargetPass1 = new THREE.WebGLRenderTarget(a, b, this.renderTargetNearestFloatParams);
        this.renderTargetHeightMap = new THREE.WebGLRenderTarget(a, b, this.renderTargetLinearFloatParams);
        this.renderTargetHeightMap2 = this.renderTargetHeightMap.clone();
        this.renderTargetNormalMap = this.renderTargetHeightMap.clone();
        this.renderTargetPass2 = this.renderTargetHeightMap.clone();
        this.fresnelMaterial.uniforms.tData.texture = this.renderTargetHeightMap;
        this.fresnelMaterial.uniforms.tNormalMap.texture = this.renderTargetNormalMap;
        this.fresnelMaterial.uniforms.tCaustic.texture = this.renderTargetPass2;
        this.material2.uniforms.tDataSampler.texture = this.renderTargetPass1;
        this.material1.uniforms.tData.texture = this.renderTargetHeightMap;
        this.material1.uniforms.tNormalMap.texture =
            this.renderTargetNormalMap;
        this.normalMapMaterial.uniforms.tData.texture = this.renderTargetHeightMap;
        this.heightMapMaterial.uniforms.tData.texture = this.renderTargetHeightMap
    },

    initShader:function () {
        var a = THREE.HeightMapShader;
        var b = THREE.UniformsUtils.clone(a.uniforms);
        this.heightMapMaterial = new THREE.ShaderMaterial({
            uniforms:b,
            vertexShader:a.vertexShader,
            fragmentShader:a.fragmentShader
        });

        a = THREE.NormalMapShader;
        b = THREE.UniformsUtils.clone(a.uniforms);
        this.normalMapMaterial = new THREE.ShaderMaterial({
            uniforms:b,
            vertexShader:a.vertexShader,
            fragmentShader:a.fragmentShader
        });

        a = THREE.Pass1Shader;
        b = THREE.UniformsUtils.clone(a.uniforms);
        this.material1 = new THREE.ShaderMaterial({
            uniforms:b,
            vertexShader:a.vertexShader,
            fragmentShader:a.fragmentShader
        });

        a = THREE.Pass2Shader;
        b = THREE.UniformsUtils.clone(a.uniforms);
        this.material2 = new THREE.ShaderMaterial({
            uniforms:b,
            vertexShader:a.vertexShader,
            fragmentShader:a.fragmentShader
        });

        THREE.WaterComposer.quad.material = this.material1;

        a = THREE.FresnelShader;
        b = THREE.UniformsUtils.clone(a.uniforms);
        b.tGround.texture = THREE.ImageUtils.loadTexture("./textures/pebbles3.jpg");
        b.tGround.texture.wrapS = THREE.RepeatWrapping;
        b.tGround.texture.wrapT = THREE.RepeatWrapping;
        b.tSky.texture = THREE.ImageUtils.loadTexture("./textures/sky.jpg");
        b.tSky.texture.wrapS = THREE.RepeatWrapping;
        b.tSky.texture.wrapT = THREE.RepeatWrapping;
        this.fresnelMaterial = new THREE.ShaderMaterial({
            uniforms:b,
            vertexShader:a.vertexShader,
            fragmentShader:a.fragmentShader
        });
    }
};

THREE.WaterComposer.resolution = 256;
THREE.WaterComposer.geometry = new THREE.PlaneGeometry(1, 1);
THREE.WaterComposer.quad = new THREE.Mesh(THREE.WaterComposer.geometry, null);
THREE.WaterComposer.scene = new THREE.Scene();
THREE.WaterComposer.scene.add(THREE.WaterComposer.quad);

THREE.WaterComposer.camera = new THREE.OrthographicCamera(
    THREE.WaterComposer.resolution / -2,
    THREE.WaterComposer.resolution / 2,
    THREE.WaterComposer.resolution / 2,
    THREE.WaterComposer.resolution / -2,
    -1E4,
    1E4);
THREE.WaterComposer.scene.add(THREE.WaterComposer.camera);

var camera, scene, renderer;
var charCloud, WaterComposer;
var time, oldTime, delta, stats, quad, computeQuadWidth, computeQuadHeight;
var mouseDown = !1, rain = !0, caustics = !0;

var WaterUI = function () {
    this.RippleStrength = 0.12;
    this.Rain = this.DirectionnalLight = this.Caustics = !0
};

function init() {
    new THREE.PlaneGeometry(1, 1);
    quad = new THREE.Mesh(THREE.WaterComposer.geometry, null);
    quad.scale.set(window.innerWidth, window.innerHeight, 1);
    scene = new THREE.Scene;
    scene.add(quad);
    camera = new THREE.OrthographicCamera(window.innerWidth / -2, window.innerWidth / 2, window.innerHeight / 2, window.innerHeight / -2, -1E4, 1E4);
    scene.add(camera);
    renderer = new THREE.WebGLRenderer({clearColor:0});
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.domElement.width = window.innerWidth;
    renderer.domElement.height =
        window.innerHeight;
    renderer.autoClear = !1;
    stats = new window.Stats;
    stats.domElement.style.position = "absolute";
    stats.domElement.style.top = "0px";
    document.body.appendChild(stats.domElement);
    document.body.appendChild(renderer.domElement);
    WaterComposer = new THREE.WaterComposer(renderer);
    quad.material = WaterComposer.fresnelMaterial;
    window.onresize = resize;

    window.onload = function () {
        var a = new WaterUI,
            b = new window.DAT.GUI;

        b.add(a, "RippleStrength", 0.05, 0.5).onChange(function (a) {
            WaterComposer.heightMapMaterial.uniforms.strength.value =
                a
        });
        b.add(a, "Caustics").onChange(function (a) {
            caustics = a;
            WaterComposer.fresnelMaterial.uniforms.caustics.value = a
        });
        b.add(a, "DirectionnalLight").onChange(function (a) {
            WaterComposer.fresnelMaterial.uniforms.dirLight.value = a
        });
        b.add(a, "Rain").onChange(function (a) {
            rain = a
        });
        renderer.domElement.onmouseout = function () {
            mouseDown = !1;
            WaterComposer.heightMapMaterial.uniforms.mouseActive.value = 0
        };
        renderer.domElement.onmousedown = function () {
            mouseDown = !0
        };
        renderer.domElement.onmouseup = function () {
            mouseDown = !1;
            WaterComposer.heightMapMaterial.uniforms.mouseActive.value =
                0
        };
        renderer.domElement.onclick = function () {
            WaterComposer.heightMapMaterial.uniforms.mouseActive.value = 2
        };
        renderer.domElement.onmousemove = function (a) {
            WaterComposer.heightMapMaterial.uniforms.mousePoint.value.set(a.offsetX / window.innerWidth, a.offsetY / window.innerHeight);
            if (1 > Math.abs(WaterComposer.heightMapMaterial.uniforms.mousePoint.value.x) && 1 > Math.abs(WaterComposer.heightMapMaterial.uniforms.mousePoint.value.y))WaterComposer.heightMapMaterial.uniforms.mouseActive.value = mouseDown ? 2 : 1
        }
    };
    resize()
}

function resize() {
    quad.scale.set(window.innerWidth, window.innerHeight, 1);
    renderer.domElement.width = window.innerWidth;
    renderer.domElement.height = window.innerHeight;
    renderer.setSize(window.innerWidth, window.innerHeight);
    camera.left = -window.innerWidth / 2;
    camera.right = window.innerWidth / 2;
    camera.top = window.innerHeight / 2;
    camera.bottom = -window.innerHeight / 2;
    camera.updateProjectionMatrix();
    window.innerWidth > window.innerHeight ? (computeQuadHeight = 256, computeQuadWidth = parseInt(256 * (window.innerWidth / window.innerHeight))) :
        (computeQuadWidth = 256, computeQuadHeight = parseInt(256 * (window.innerHeight / window.innerWidth)));
    WaterComposer.heightMapMaterial.uniforms.texelSize.value.set(1 / computeQuadWidth, 1 / computeQuadHeight);
    WaterComposer.normalMapMaterial.uniforms.texelSize.value.set(1 / computeQuadWidth, 1 / computeQuadHeight);
    WaterComposer.fresnelMaterial.uniforms.texelSize.value.set(1 / computeQuadWidth, 1 / computeQuadHeight);
    WaterComposer.material1.uniforms.texelSize.value.set(1 / computeQuadWidth, 1 / computeQuadHeight);
    WaterComposer.material2.uniforms.texelSize.value.set(1 /
        computeQuadWidth, 1 / computeQuadHeight);
    WaterComposer.fresnelMaterial.uniforms.heightMapFactor.value.x = computeQuadWidth;
    WaterComposer.fresnelMaterial.uniforms.heightMapFactor.value.z = computeQuadHeight;
    window.innerHeight > window.innerWidth ? WaterComposer.fresnelMaterial.uniforms.uGroundRepeat.value.set(window.innerWidth / 2048, window.innerWidth / (4096 / 3)) : WaterComposer.fresnelMaterial.uniforms.uGroundRepeat.value.set(window.innerHeight / 2048, window.innerHeight / (4096 / 3));
    THREE.WaterComposer.quad.scale.set(computeQuadWidth,
        computeQuadHeight, 1);
    THREE.WaterComposer.camera.left = -computeQuadWidth / 2;
    THREE.WaterComposer.camera.right = computeQuadWidth / 2;
    THREE.WaterComposer.camera.top = computeQuadHeight / 2;
    THREE.WaterComposer.camera.bottom = -computeQuadHeight / 2;
    THREE.WaterComposer.camera.updateProjectionMatrix();
    WaterComposer.initRenderTargets(computeQuadWidth, computeQuadHeight)
}
function animate() {
    requestAnimationFrame(animate);
    render();
    stats.update()
    renderer.render(scene, camera);
}

function render() {
    oldTime || (oldTime = (new Date).getTime());
    time = (new Date).getTime();
    delta = 0.1 * (time - oldTime);
    oldTime = time;

    var a = WaterComposer.heightMapMaterial.uniforms.strength.value;

    if (rain && 0 == time % 2) {
        WaterComposer.heightMapMaterial.uniforms.strength.value = 0.05;
        WaterComposer.heightMapMaterial.uniforms.mousePoint.value.set(Math.random(), Math.random());
        WaterComposer.heightMapMaterial.uniforms.mouseActive.value = 1;
    }

    WaterComposer.render(delta);
    WaterComposer.heightMapMaterial.uniforms.strength.value = a;
} 
```

有什么帮助可以将此代码迁移到 Three.js r52 吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T14:22:15.110

这似乎是纹理系统税变化的问题：

> 纹理统一更改：纹理单元现在自动分配，纹理对象转到值属性而不是纹理一 { type: "t", value: 0, texture: map } => { type: "t", value: map }

我想我在这个小提琴中解决了它：http: [//jsfiddle.net/gero3/UyGD8/9/](http://jsfiddle.net/gero3/UyGD8/9/)

```
{ type: "t", value: 0, texture: map } => { type: "t", value: map } 
```

# c# - 我正在为网站制作 JavaScript 扩展。我想改用 Java 或 C#。是否可以？

> ID：13924995
> 
> 赞同：0
> 
> 时间：2012-12-18T01:28:25.003
> 
> 标签：c#, java, javascript, sockets, bots

这对我来说很难解释，甚至更难以想象我将如何做到这一点，因为我不知道使用 Java 和 C# 与网站进行通信的界限，所以如果我在描述这个过程，我很抱歉。

基本上，我正在为[www.plug.dj](http://www.plug.dj)制作一个“机器人” 。这个机器人能够执行命令，例如踢用户、禁止用户、发送聊天消息、删除聊天消息、说随机的事情等。截至目前，它由一个简单的单文件 JavaScript 代码提供支持，拥有大量的听众以及使用 Plug.dj API 处理它们的回调。这都是由 JS 设计的——在后端，我认为 Plug.dj 是由 Python 驱动的，我可能是错的。

无论如何，我想做的是在 JS 以外的语言上创建这个机器人。它真的很基本，而且不是超级强大，并且有一些东西，比如与数据库通信，而我想实现这些东西是 JS 不可能/不方便的。我只想知道这是否可能，如果可以，我应该从哪里开始寻找？

我更喜欢Java或C#之类的语言。如果您需要了解更多信息才能回答此问题，请告诉我！我想开始研究这个，我认为学习如何使用 Java/C#/whatever 与网站进行通信会很有趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T01:44:18.763

如果`bot`javascript 在“他们的”服务器上运行，那么没有简单的解决方案。他们提供了一种在他们的服务器上运行“你的”javascript 的机制，但很可能他们不支持其他语言。（找出答案的唯一方法是问“他们”）。假设答案是“否”，您需要调查是否可以在客户端代码中实现“机器人”的功能；例如，您使用 Java 或 C# 或其他方式从头开始实现的自定义客户端。这是一个很大的“如果”……因为只有当他们在其外部 API 中公开您需要的服务器功能时，它才会起作用。

OTOH，如果`bot`javascript 在“您的”服务器上运行，那么您应该能够更改它以支持其他语言。（虽然这不一定很容易......）

* * *

我的建议是深呼吸……并坚持使用 Javascript。我们都必须使用我们认为不“有趣”的语言。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T01:37:37.900

老实说，如果您需要在客户端中运行它，我会将其保留在 javascript 中。

如果您需要进行数据库调用，您可以在其间引入一个 Web 服务层，您可以在该层之间进行与数据库交互的 AJAX 调用。

我认为您认为 javascript 是基本的并且不是很强大的看法并不是一个很好的看法。它们是当今仅使用 javascript 和 HTML5 构建的非常复杂的应用程序。您可能只需要开始查看诸如backbone.js、underscore.js 和类似的库，这些库可以帮助您提供更高级的代码组织功能。

但是，如果您正在考虑构建个人客户不会在其浏览器中安装的东西，而只是在自动管理中与网站交互，那么您当然可以用您喜欢的任何语言建立自己的 Web 服务交互使用他们的 API 并执行管理任务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T02:05:53.530

如果他们提供了一个运行客户端的 JavaScript 库，它似乎很可能会通过 HTTP 与服务器通信。因此，您应该可以分析该库及其调用以对服务器 API（这将是 HTTP 调用）进行逆向工程，并以您选择的语言重新实现它。

查看代码`bot.js`：

[https://github.com/backus/Plug.DJ-Javascript-Chatbot/blob/master/bin/bot.js](https://github.com/backus/Plug.DJ-Javascript-Chatbot/blob/master/bin/bot.js)

似乎一切都归结为对他们的 API 对象的调用，例如`API.getDJs()`，`API.getWaitList()`等等。如果你能确定这个 API 对象是如何工作的，那么你可能能够进行逆向工程和重新实现。

# iphone - 每当我的 plist 更新时尝试重新加载 UItableview？

> ID：13924998
> 
> 赞同：0
> 
> 时间：2012-12-18T01:28:51.757
> 
> 标签：iphone, objective-c, xcode, plist

我有一个由用户在我的应用程序中填充的 plist。我正在尝试在 UITableView 中显示该 plist 的内容，直到应用程序重新启动后才会显示，这意味着它不会更新。这是我所拥有的：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    // Uncomment the following line to preserve selection between presentations.
    // self.clearsSelectionOnViewWillAppear = NO;

    // Uncomment the following line to display an Edit button in the navigation bar for this view controller.
    // self.navigationItem.rightBarButtonItem = self.editButtonItem;

    NSString *path = [[NSBundle mainBundle] pathForResource:@"foodList" ofType:@"plist"];

    arrayFood = [[NSMutableArray alloc]initWithContentsOfFile:path];

}

- (void)viewWillAppear:(BOOL)animated {
    [super viewWillAppear:animated];
     [self.tableView reloadData];   
    NSString *path = [[NSBundle mainBundle] pathForResource:@"foodList" ofType:@"plist"];

    arrayFood = [[NSMutableArray alloc]initWithContentsOfFile:path];

} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T02:08:15.963

据我所知，你应该打电话

```
[self.tableView reloadData] 
```

将数据从 plist 加载到 viewDidAppear 中的 foodArray 后...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T03:23:37.467

每当您更新 pList 文件时，只需调用 self.tableView reloadData。此外，请确保您用于 UITableView 的数据源已更新。此数据源可以是 NSDictionary、NSArray、NSMutableArray 等。tableView 的 reloadData 方法将触发 cellforRowIndexPath 方法，您将在其中创建 UITableViewCell。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T05:42:10.553

用最新数据更新 UITableView 的最佳方法是覆盖数据数组的 setter 方法。例如，您的数据数组是 arrayFood，因此您可能将其属性设置为 strong 或保留

```
@property(nonanatomic,stron) NSMutableArray *arrayFood; 
```

那么你应该覆盖它的setter方法。

```
-(NSMutableArray *)setArrayFood:(NSMutableArray *)array
{
   //set your data array here and simply call reloadData
   [self.tableView reloadData];
} 
```

这样，每当您的数据数组更改时，您的 tableView 总是会得到更新。

还使用 NSNotifications 进行 plist 更改并在那里更新您的 arrayFood。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-22T01:06:20.227

在这里使用 NSNotificationCenter 可能会对您有所帮助。

在更新您的 plist 的 ViewController 中，在此更新发生时放置此代码：

```
[[NSNotificationCenter defaultCenter] postNotificationName:@"plistDidUpdate" object:self]; 
```

在 ViewController 中，您需要将此代码添加到 viewDidLoad：

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(plistDidUpdate:) name:@"plistDidUpdate" object:nil]; 
```

另外，在同一个 ViewController 中添加这个函数：

```
-(void)plistDidUpdate:(id)sender{
    [self.tableView reloadData];
} 
```