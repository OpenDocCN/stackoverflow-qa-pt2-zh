# StackOverflow 问答 15079000-15079999

# search - 搜索可以包含引号、双引号、括号、等号等的字符串的源代码的工具？

> ID：15079004
> 
> 赞同：0
> 
> 时间：2013-02-26T00:09:23.383
> 
> 标签：search, full-text-search

我使用 dtSearch 和 File Locator Lite 之类的工具来搜索我的本地源代码文件中的单词，它们工作正常。

但是有时我需要搜索像 'Session["cutid"] =' 之类的短语（不带单引号）并进行精确匹配，其中包括双引号、空格和等号，而我的搜索工具不返回任何内容即使我知道这句话的存在。

你能推荐一个可以找到上面短语的搜索工具，如果它需要一些特殊的语法，写下语法。谢谢。

补充：不喜欢使用正则表达式，因为我不擅长它们。只想匹配我在搜索词中输入的任何内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T00:18:59.687

我们的源代码搜索引擎可以做到这一点。它使用特定于语言的扫描器以完全语言准确的方式（例如，理解字符串中的转义序列！）将源代码分解为语言元素（标识符、字符串、数字、注释、关键字、空格等）。然后，您可以对这些语言原子制定查询。（我假设您的示例是 PHP ；SCSE 处理 PHP，包括字符串文字、Java 中的所有复杂内容……）

针对您的特定搜索的查询：

```
 I=Session '[' S=cutid ']' '=' 
```

查询的意思是，找到一个确切名称为“Session”的 I(dentifier)，后跟一个运算符 '['，后跟 S(tring)，其确切内容为 'cutid'，然后是运算符 ']'，然后'='。空格和交织注释被跳过，因此可以跨越多行边界。如果您想要任何包含“Sess”的标识符，您可以为该标识符编写一个通配符，例如，I=*Sess*。对于 I（例如 =\.*Sess.*\）或 S 约束，您可以使用正则表达式而不是通配符，或者如果您坚持，也可以仅使用正则表达式执行搜索。

SCSE 提供 GUI；任何找到的匹配项都显示为单行，单击即可调出包含匹配项的源代码文件。稍微配置一下，额外的点击会在点击时让你进入你最喜欢的编辑器。

SCSE 索引您的代码库，因此搜索速度非常快，即使对于庞大的代码库也是如此。它可以处理多种混合语言（例如，PHP、JavaScript 等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T00:11:34.710

我使用 NetBeans，他们在项目中的搜索功能允许您通过正则表达式进行搜索。我认为大多数其他 IDE 也支持这一点。或者您可以使用 grep 和其他 unix 工具。

# bash - 是否可以指定执行 getopts 条件的顺序？

> ID：15079009
> 
> 赞同：2
> 
> 时间：2013-02-26T00:09:37.393
> 
> 标签：bash, shell

在 bash 脚本中，我想从配置文件加载设置并使用命令行选项覆盖各个设置。如果在配置文件和命令行中都指定了设置，则命令行设置应优先。

您如何确保在其他 getopts 块之前加载配置文件？这是我所拥有的：

```
#!/bin/bash
# ...

while getopts “c:l:o:b:dehruwx” OPTION
do
   case $OPTION in
      c)  
         echo "load"
         CONFIG_FILE=$OPTARG
         # load_config is a function that sources the config file
         load_config $CONFIG_FILE
         ;;  
      l)  
         echo "set local"
         LOCAL_WAR_FILE=$OPTARG
         ;;  

# ...

   esac
done
shift $(($OPTIND - 1)) 
```

无论我为 -c 选项放置处理程序的顺序如何，它总是在设置其他选项之后加载配置文件。这使得将配置文件设置与命令行选项合并更加痛苦。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-26T18:20:23.340

每次调用`getopts`总是处理“下一个”选项（由检查确定`$OPTIND`），因此您的`while`-loop 必须按照它们出现的顺序处理选项。

由于您希望`-c`被其他选项部分取代，即使它出现在命令行之后，您也可以采取一些方法。

一种是循环*两次*选项：

```
#!/bin/bash
# ...

optstring='c:l:o:b:dehruwx'

while getopts "$optstring" OPTION
do
   case $OPTION in
      c)
         echo "load"
         CONFIG_FILE=$OPTARG
         # load_config is a function that sources the config file
         load_config $CONFIG_FILE
   esac
done

OPTIND=1

while getopts "$optstring" OPTION
do
   case $OPTION in
      l)  
         echo "set local"
         LOCAL_WAR_FILE=$OPTARG
         ;;
      # ...
   esac
done
shift $(($OPTIND - 1)) 
```

`-c` *另一种是将选项保存在不会*覆盖的变量中，然后将它们复制过来：

```
#!/bin/bash
# ...

while getopts c:l:o:b:dehruwx OPTION
do
   case $OPTION in
      c)
         echo "load"
         CONFIG_FILE=$OPTARG
         # load_config is a function that sources the config file
         load_config $CONFIG_FILE
         ;;  
      l)  
         echo "set local"
         LOCAL_WAR_FILE_OVERRIDE=$OPTARG
         ;;
      # ...
   esac
done
shift $(($OPTIND - 1))

LOCAL_WAR_FILE="${LOCAL_WAR_FILE_OVERRIDE-${LOCAL_WAR_FILE}}" 
```

（或者，相反，配置文件可以设置类似的选项`LOCAL_WAR_FILE_DEFAULT`，然后你会写`LOCAL_WAR_FILE="${LOCAL_WAR_FILE-${LOCAL_WAR_FILE_DEFAULT}}"`。）

另一种选择是要求`-c`，如果存在，*首先*来。您可以通过自己先处理它来做到这一点：

```
if [[ "$1" = -c ]] ; then
   echo "load"
   CONFIG_FILE="$2"
   # load_config is a function that sources the config file
   load_config "$CONFIG_FILE"
   shift 2
fi 
```

然后在您的主`while`循环中，只需`-c`打印一条错误消息即可。

另一个只是简单地记录您现有的行为并将其称为“功能”。很多 Unix 实用程序都有后面的选项取代早期的选项，所以这种行为并不是真正的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T00:29:17.227

假设您的配置文件包含程序的默认选项，您应该始终默认使用这些选项，除非它们被等效的命令行选项覆盖。这是合理的。在您的情况下，只需首先获取/加载配置文件，然后解析命令行选项 - 并`parseopts`根据需要在循环中为它们分配新值。

# javascript - 立即播放 JavaScript 声音文件

> ID：15079013
> 
> 赞同：7
> 
> 时间：2013-02-26T00:09:55.763
> 
> 标签：javascript, html, canvas, audio

我有一个带有声音的 HTML5 画布游戏，但我遇到的一个问题是，当声音播放时，所有其他动作都会停止，直到声音播放完毕。我用了这段代码

```
document.getElementById("music").innerHTML="<embed src=\""+surl+"\" hidden=\"true\" autostart=\"true\" loop=\"false\" />" 
```

其中 surl 是正在播放音乐的 span 元素的声音和音乐的 url。有谁知道如何在不延迟整个程序的情况下播放声音？

我尝试了一个相当大的文件，结果发现虽然它确实在后台播放，但在启动声音和继续游戏之间仍有相当长的延迟。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-26T00:31:12.497

尝试使用原生 HTML5 音频 API。首先，创建您需要的声音实例：

```
var ping = new Audio("ping.ogg"); 
```

**注意：**您不需要在任何时候将这些音频实例插入到 DOM 中。

当您准备好播放声音时，例如当有人点击时：

```
document.querySelector(".ping").addEventListener("click", function() {

    // ping clicked, play ping sound:
    ping.play()
}) 
```

因为 ping 实例是预加载的，所以播放声音应该没有延迟，您可以随意播放多次。

请记住，编解码器支持不是一致的跨浏览器，因此您必须有一个 ogg 源和一个 MP3 源，或其他组合（可以在此处找到支持表[http://en.wikipedia.org/wiki/HTML5_Audio #.3CAudio.3E_element_format_support](http://en.wikipedia.org/wiki/HTML5_Audio#.3CAudio.3E_element_format_support)）。

如果您想要一种更向后兼容的方法，我推荐 SoundManager2 作为具有简单 API 的完整解决方案：[http ://www.schillmania.com/projects/soundmanager2/](http://www.schillmania.com/projects/soundmanager2/)

否则，可以在此处找到本机 HTML5 音频 API 的文档： [https](https://developer.mozilla.org/en-US/docs/HTML/Element/audio) ://developer.mozilla.org/en-US/docs/HTML/Element/audio 和此处[https://developer.mozilla.org/en-美国/docs/DOM/HTMLAudioElement](https://developer.mozilla.org/en-US/docs/DOM/HTMLAudioElement)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T00:26:21.980

我使用这个框架取得了很好的成功：[http ://www.schillmania.com/projects/soundmanager2/](http://www.schillmania.com/projects/soundmanager2/)

它具有不错的跨浏览器支持，您可以使用 JavaScript 预加载/启动/停止声音。我已经在动画发生时使用它来播放声音并且没有看到任何延迟。你也可以让它等待你所有的声音资源被加载，然后再做一些事情，同时显示一个加载屏幕或其他东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T00:27:59.173

您依赖于用户可能必须使用的任何外部插件来播放音频`embed`，因此性能可能因用户而异。

我的建议是使用像**[howler.js](http://goldfirestudios.com/blog/104/howler.js-Modern-Web-Audio-Javascript-Library)**这样的库，它是为游戏而构建的。[正确处理 HTML5 音频可能会非常痛苦，尤其是对于游戏而言](https://stackoverflow.com/questions/9553415/how-did-scirra-get-html5-audio-so-perfect-in-construct-2)，因此您可以通过使用库而不是尝试自己摆弄 HTML5`audio`元素来避免很多麻烦。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T00:30:47.893

我在其他一些stackoverflow帖子上做了一些挖掘，我发现在HTML5中，你可以这样做

```
var sound=new Audio("hello.wav"); 
```

然后打电话

```
sound.play(); 
```

这似乎可以解决问题，并且没有延迟。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-11T07:33:12.790

Web Audio API 是这项工作的正确工具。有很多可用的库可以简化使用小复杂 API 的过程。您还可以[查看 musquito](https://github.com/vjai/musquito)我创建的一个小型库，该库管理 Web Audio API 的复杂性，并有助于创建和管理单个或一组声音。

# javascript - + 前缀在这种情况下有什么作用？

> ID：15079021
> 
> 赞同：3
> 
> 时间：2013-02-26T00:10:59.903
> 
> 标签：javascript

这是[下划线](http://underscorejs.org/)中的一行代码。这一行的加号前缀是什么？

```
if (obj.length === +obj.length) { // plus prefix? 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T00:15:29.933

添加`+`符号可以有效地将变量转换为数字，例如：

```
+"1" === 1; 
```

但是，请注意

```
+"1" === "1"; // FALSE
+"1" ==  "1"; // TRUE 
```

这是因为`==`会将其操作数转换为相同的类型，而`===`不会。

这意味着测试：

```
obj.length === +obj.length 
```

本质上是试图测试是否`obj.length`是数字。

在 Underscore 中，此代码试图确定未知类型的变量是否具有已调用的属性`length`以及它是否为数字。假设是，如果这两个都是真的，你可以迭代变量是如果它是一个数组。

## 编辑

请注意，OP 的代码中有许多错误，其中最重要的是这种检测某事物是否为数组（或类似数组）的方法。以下对象会导致问题：

```
var footballField = {
    covering: "astroturf",
    condition: "muddy",
    length: 100
}; 
```

我不提倡上述方法......只是解释别人的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-26T00:18:11.140

加号前缀将变量转换为数字。基本上，这`obj.length === +obj.length`是 obj.length 真的是一个数字的健全性检查。如果`obj.length`不是数字，例如 string `"foo"`，则`"foo" === +"foo"`等于 false ，因为`+"foo"`输出为`NaN`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T00:15:14.823

+ 前缀将值转换为数字。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-26T00:18:35.717

这迫使 的值为`obj.length`a `Number`。本质上，这样做是为了确保`length`类数组对象的默认值没有被覆盖，以便可以正确迭代。

`breaker`在这种情况下不会做任何事情，因为即使没有等价比较，即使是另一个空对象也会在与 .. 进行比较时进行`{}`评估。`false``breaker`

但是，`breaker`没有在该上下文中使用，因为它是在函数*之外*`.each`定义的，这看起来与您在此处显示的不同。相反，它用于从其他循环方法中强制“中断”：

```
_.every = _.all = function(obj, iterator, context) {
  /* snip */
  if (!(result = result && iterator.call(context, value, index, list)))
      return breaker; 
```

你可以看到，如果结果在“every”中不是真的，我们想立即打破。 `_.every`调用`_.each`，它会返回`breaker`与自身比较时为真，允许立即中断。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-26T00:15:04.823

如果对象没有`length`属性（是一个常规的`Object`，而不是一个`Array`），那么调用`obj.length`将返回`undefined`。对 undefined 的测试会更清楚，但实现者选择首先将其转换为数字（因此它将变为`NaN`），然后将其与原始值进行比较（使用严格比较，这将确保它会产生`false`）。

**更新：**正如其他人指出的那样，这段代码似乎不仅关注`Array`s，还关注“类数组”对象（即具有数字`length`属性和数字索引的对象）。在这种情况下，`instanceof Array`仅测试 for 是不够的（仅测试 for`undefined`可能不是最佳选择，因为可能存在`length`另一种类型的 but）。

# c++ - 添加到动态库中的函数指针映射

> ID：15079026
> 
> 赞同：2
> 
> 时间：2013-02-26T00:11:22.257
> 
> 标签：c++, map, function-pointers, shared-libraries

下面的两个代码部分显示了重要信息。真正的工作在第三个代码部分 main.cpp 中完成。

```
// For all files:
typedef void (*func_ptr)(Event&); // Event is a class with certain methods 
```

foo.cpp

```
extern "C" void init(std::map<std::string, func_ptr> *func_ptrs)
{
    std::cout<<std::endl<<"Initializing..."<<std::endl; // does appear in output, so function does execute
    (*func_ptrs)["test"] = stuff; // the stuff function below
}

// this is the function we are trying to add to the func_ptrs map
// It looks like it's added in main.cpp, but calling it in main.cpp seg faults
void stuff(Event &e)
{
    std::cout<<"In stuff..."<<std::endl; // seg faults before this line
    // do things with e
} 
```

主文件

```
// Excluding fluff for brevity, use comments to understand location of problem

// In main....

map<string, func_ptr> func_ptrs; // map of strings to func_ptrs
void (*init)(map<string, func_ptr>*);
// some other stuff

handle = dlopen("libfoo.so", RLTD_NOW);
// library opens successfully

*(void **) (&init) = dlsym(handle, "init"); // get the init function from the library
// No, I don't completely understand the above sequence of pointers and reference, but it does open successfully

(*init)(&func_ptrs);
// Executes successfully

// Iterating over func_ptrs shows that the new "test" mapping is in func_ptrs!!

// Next, this should call the stuff function in foo.cpp that was assigned to func_ptrs["test"]
(func_ptrs["test"])(event); // seg fault 
```

所以回顾一下，

1.  libfoo.so 库正在正确加载
2.  libfoo.so 中的初始化符号正在被正确检索
3.  运行 libfoo 的 init() 后，映射键“test”在 main.cpp 中可见

**错误**：试图执行 libfoo 的东西，位于 main.cpp 的映射 func_ptrs，**seg 错误**

注意：另一个选项可能是给 main.cpp 一个“添加到映射”函数，libfoo.so 可以调用它来将映射添加到函数列表中。这看起来更容易/更好吗？

我能够找到很多类似的问题/答案，但没有一个与我正在处理的情况密切相关。非常感谢你们的帮助，我还没有失望。希望我没有搞砸缩短代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T00:34:39.993

此代码适用于 gcc 版本 4.7.2 20121109：

d_a.cc：

```
#include <iostream>
#include <map>
#include <string>
#include <dlfcn.h>

class Event { 
  public: 
    void method1() { std::cout << "method1: " << name << std::endl; }
    Event(std::string& n):name(n) {}
  private: std::string name;
};
typedef void (*func_ptr)(Event&); 

int main(int argc, const char **argv) {
  std::string name = "Some";
  Event ev(name);
  std::map<std::string, func_ptr> func_ptrs; 
  void (*init)(std::map<std::string, func_ptr>*);
  void *handle = dlopen("./d_l.so", RTLD_NOW);
  *(void **) (&init) = dlsym(handle, "init");
  (*init)(&func_ptrs);
  (func_ptrs["test"])(ev);
  return 0;
} 
```

d_l.cc：

```
#include <map>
#include <string>
#include <iostream>

void stuff(Event& e)
{ 
  e.method1();
  std::cout<<"In stuff..."<<std::endl; 
}

extern "C" void init(std::map<std::string, func_ptr> *func_ptrs)
{ 
  std::cout<<std::endl<<"Initializing..."<<std::endl; 
  (*func_ptrs)["test"] = stuff; 
} 
```

编译：

```
g++ d_a.cc -ldl
g++ d_l.cc -fPIC -shared -o d_l.so 
```

执行：

```
./a.out 
```

输出：

```
Initializing...
method1: Some
In stuff... 
```

# java - 将文件发送到服务器android

> ID：15079031
> 
> 赞同：1
> 
> 时间：2013-02-26T00:12:05.473
> 
> 标签：java, android, web-services, rest, soa

我已经开发了我的 android 应用程序，该应用程序每 10 分钟记录一次用户的 GPS 位置和时间，并将其保存到 .txt 文件中。现在我需要将此文件发送到服务器。我现在用 FTP 来做，但这似乎不正确，因为我计划将其扩展到大约 10.000 个用户或更多，所以 FTP 方法似乎不太好。我可以使用什么其他方式将文件发送到服务器？我需要这个相对安全。谢谢你的时间

编辑：所有答案对我来说都很好，但据我所知，唯一提供安全连接并且只允许客户端为什么密码是 FTP 的解决方案。是否可以发出 Web 请求并仅接受具有正确密码的客户端？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T01:12:57.243

您可以尝试在 sftp 模式下通过 Intent 使用[andFTP](http://www.lysesoft.com/products/andftp/index.html)，请参阅他们的常见问题解答，了解如何将该应用用作 Intent。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T01:18:17.697

我知道它没有回答您的问题，或者至少没有回答您的问题，但是您是否考虑过使用批处理 HTTP 请求？

这就是谷歌分析的工作方式，它记录几个事件（在你的情况下是位置数据），然后定期向服务器发送一批。

这将比弄乱文件容易得多。

如果您想积极节省用户的电池寿命，您还可以考虑仅在其他人启动网络时发送请求。Reto Meier 在这方面有一个很棒的 Google I/O 2012 会议。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T01:29:30.617

这样做的一种方法是让客户端调用远程服务器上的 Web 服务，将数据与请求一起发送（通常在 JSON 中，但实际上可以是任何东西）。然后，Web 服务将获取此数据，对其进行处理并将响应发送回客户端。响应将是成功或失败，或者您想要的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T01:55:02.890

我发现以下代码（主要取自[Funf](https://code.google.com/p/funf-open-sensing-framework/)）适用于此目的：

```
public static boolean uploadFile(File file, String uploadurl) {
    HttpURLConnection conn = null;
    DataOutputStream dos = null;
    String lineEnd = "\r\n";
    String twoHyphens = "--";
    String boundary = "*****";
    int bytesRead, bytesAvailable, bufferSize;
    byte[] buffer;
    int maxBufferSize = 64 * 1024;
    FileInputStream fileInputStream = null;
    boolean isSuccess = true;
    try {
        // ------------------ CLIENT REQUEST
        try {
            fileInputStream = new FileInputStream(file);
        } catch (FileNotFoundException e) {}
        URL url = new URL(uploadurl);
        conn = (HttpURLConnection) url.openConnection();
        conn.setDoInput(true);
        conn.setDoOutput(true);
        conn.setUseCaches(false);
        conn.setConnectTimeout(60000);
        conn.setReadTimeout(60000);
        conn.setRequestMethod("POST");
        conn.setRequestProperty("Connection", "Keep-Alive");
        conn.setRequestProperty("Content-Type",
            "multipart/form-data;boundary=" + boundary);
        dos = new DataOutputStream(conn.getOutputStream());
        dos.writeBytes(twoHyphens + boundary + lineEnd);
        dos.writeBytes("Content-Disposition: form-data; "
            + "name=\"uploadedfile\";filename=\""
            + file.getName() + "\"" + lineEnd);
        dos.writeBytes(lineEnd);
        bytesAvailable = fileInputStream.available();
        bufferSize = Math.min(bytesAvailable, maxBufferSize);
        buffer = new byte[bufferSize];
        bytesRead = fileInputStream.read(buffer, 0, bufferSize);
        while (bytesRead > 0) {
            dos.write(buffer, 0, bufferSize);
            bytesAvailable = fileInputStream.available();
            bufferSize = Math.min(bytesAvailable, maxBufferSize);
            bytesRead = fileInputStream.read(buffer, 0, bufferSize);
        }
        dos.writeBytes(lineEnd);
        dos.writeBytes(twoHyphens + boundary + twoHyphens + lineEnd);
    } catch (Exception e) {
        isSuccess = false;
    } finally {
        if (dos != null) {
            try {
                dos.close();
            } catch (IOException e) {
                // do something
            }
        }
        if (fileInputStream != null) {
            try {
                fileInputStream.close();
            } catch (IOException e) {
                // do something
            }
        }
    }
    // ------------------ read the SERVER RESPONSE
    try {
        if (conn.getResponseCode() != 200) {
            isSuccess = false;
        }
    } catch (IOException e) {
        isSuccess = false;
    }
    return isSuccess;
} 
```

# javascript - 从左到右自动滚动Div？

> ID：15079035
> 
> 赞同：0
> 
> 时间：2013-02-26T00:12:14.647
> 
> 标签：javascript, html, css

我正在尝试自动滚动 Div，但不是从上到下或从下到上，我需要它从左到右！

我找到了一个完全符合我需要的代码，但它只是从下到上。

这是代码：

```
<script type="text/javascript">

/***********************************************
* IFRAME Scroller script- © Dynamic Drive DHTML code library (www.dynamicdrive.com)
* This notice MUST stay intact for legal use
* Visit Dynamic Drive at http://www.dynamicdrive.com/ for full source code
***********************************************/

//Specify speed of scroll. Larger=faster (ie: 5)
var scrollspeed=cache=2

//Specify intial delay before scroller starts scrolling (in miliseconds):
var initialdelay=500

function initializeScroller() {
   dataobj = document.all? document.all.datacontainer :  
                           document.getElementById("datacontainer")
   dataobj.style.top = "5px"
   setTimeout("getdataheight()", initialdelay)
}

function getdataheight() {
   thelength=dataobj.offsetHeight
   if ( thelength == 0 )
       setTimeout("getdataheight()",10)
   else
       scrollDiv()
}

function scrollDiv() {
   dataobj.style.top=parseInt(dataobj.style.top)-scrollspeed+"px"
   if (parseInt( dataobj.style.top ) < thelength*( -1 ) )
       dataobj.style.top = "5px"
   setTimeout("scrollDiv()",40)
}

if (window.addEventListener)
   window.addEventListener("load", initializeScroller, false)
else if (window.attachEvent)
   window.attachEvent("onload", initializeScroller)
else
   window.onload=initializeScroller

</script> 
```

任何人都知道如何使这个脚本从左到右而不是从下到上移动 Div？

顺便说一句，我对 javascript 很陌生，所以请温柔一点。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T00:16:21.440

您有两行代码说`dataobj.style.top="5px"`尝试将它们更改为`dataobj.style.left="5px"`并查看是否可以修复它。

**编辑：** `dataobj.style.top=parseInt(dataobj.style.top)-scrollspeed+"px"`还需要将“top”更改为“left”。基本上，您的问题是，您更改了错误的 CSS 属性。

# android - 没有完整路径无法解析Android R.java

> ID：15079042
> 
> 赞同：1
> 
> 时间：2013-02-26T00:12:52.447
> 
> 标签：android, eclipse, r.java-file

从捕获中可以看出。如果我不导入我的完整路径，我的**所有**项目的`R.java`文件将无法解析，`R.java`但昨天当我正在做某事时，仅`android.R`足以解决。问题是什么？我清理了我的项目 5-6 次。重启电脑和Eclipse。问题是一样的。这会导致什么？

`android.R`-> 无法解决

`com.example.helloWorld.R`效果很好

![在此处输入图像描述](../Images/61e55ccfc0d6e497f1ab2a69e578eb7d.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T00:24:10.770

`android.R`-> Android 内部资源文件。你不想导入那个。

R.java 文件用于存储资源 ID。`android.R`就像说的那样，存储框架资源。`com.example.helloWorld.R`是您的资源 ID 的 R.java 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T00:23:01.743

只有`android.R`在有意使用时才应显式使用。通常，您想要的类是在您第一个项目时`R`从子目录中的文件生成的类。`res`您应该删除 import 语句`android.R`，然后编译您的代码。这应该可以解决问题。如果没有，请回来告诉我们下一个问题是什么。

# sql - 从新创建的 row rails 3 中获取 ID

> ID：15079043
> 
> 赞同：0
> 
> 时间：2013-02-26T00:13:00.903
> 
> 标签：sql, ruby-on-rails, ruby-on-rails-3

您如何获得 rails 中新创建的行的 id？

例如，

```
Session.create(:user_id => user_id, :email => email ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T00:16:33.693

我希望有更多关于 Rails 的文档......哦，好吧，为了未来

```
session = Session.create(:user_id => user_id, :email => email )
puts session.id 
```

# java - 将python dict之类的字符串转换为java hashmap

> ID：15079047
> 
> 赞同：1
> 
> 时间：2013-02-26T00:13:36.177
> 
> 标签：java, python, text-parsing

我正在开发一个项目，该项目有一个围绕 java 代码的 python 包装器。因此，python 和 java 代码之间存在通信。（我知道 jython，但我们希望将每个实现分开。）

要从 python 到 java，我们传递一个字符串，如

```
{
    "1-1": {
        "Max Capacity (MB)": "393216",
        "Current Capacity (MB)": "24576",
        "Max Devices": "12",
        "Populated": "12"
    },
    "1-3": {
        "Max Capacity (MB)": "262144",
        "Current Capacity (MB)": "8192",
        "Max Devices": "32",
        "Populated": "2"
    },
    "1-2": {
        "Max Capacity (MB)": "393216",
        "Current Capacity (MB)": "4096",
        "Max Devices": "12",
        "Populated": "1"
    }
} 
```

这是python中的一个dict，我们作为字符串传递给java代码。

java中是否有I库可以将python dict之类的字符串解析为java hash-map或等效的以便于遍历？

**解决方案：**

json解决方案有效。在 python 中使用 simplejson 将 dict 转换为 json 格式和 java gson 库。这是java部分：

```
import java.util.Map;
import java.lang.reflect.Type;
import com.google.gson.Gson;
import com.google.gson.reflect.TypeToken;

public class ReadFromJson {
    public static void main(String args[]) {
        Type mapOfStringObjectType = new TypeToken<Map<String, Map<String,String>>>() {}.getType();
        Gson gson = new Gson();
        Map<String, Map<String,String>> obj = gson.fromJson(jsonStringToBeRead, mapOfStringObjectType);
        System.out.println(obj);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T00:33:50.397

> 我试过了，但我正在做类似的事情`java -dname="TheAboveString"`并通过 System.getProperty("name") 检索它，所以无法传递格式良好的 json .. – kmad 15 分钟前

...为什么将它作为系统属性传递？

只需管道输入 JSON`echo "TheAboveString" | java`并将其从标准输入转储到 JSON 解析器。[使用subprocess](http://docs.python.org/3/library/subprocess.html)模块应该更容易，*更*安全。

# javascript - Javascript变量在表更改后动态更改

> ID：15079048
> 
> 赞同：1
> 
> 时间：2013-02-26T00:13:39.823
> 
> 标签：javascript, jquery, html, filter

我的表格使用文本过滤器删除我不感兴趣的行。基本上我想要做的是动态获取该表的行数，每次我更改表上的过滤器时，这个数字都会改变。到目前为止，我已经尝试过这段代码但没有成功，我得到了表更改之前的行数。

我想获得显示在 div 中的最终值，现在我正在使用警报进行测试。

```
<h2><span id="cantidad_tabla"></span>Servicios en Tabla</h2> 
```

在 DOM 全部设置后是否有提醒行数？

```
$(window).load(function () {
  $('#avaluos_table_filter_0').on("change", function () {
    var rowCount = $('#avaluos_table tr:visible').length - 2;
    alert(rowCount);
  });
}); 
```

# c - write vs fprintf - 为什么不同，哪个更好？

> ID：15079049
> 
> 赞同：10
> 
> 时间：2013-02-26T00:13:40.590
> 
> 标签：c, pthreads, printf

我最近开始根据 POSIX 1003.1c 学习 pthreads 的奇妙之处。

PThreads 可能看起来很复杂，但它们基本上是我们在类中用来创建并行行为的简单线程：[https ://computing.llnl.gov/tutorials/pthreads/](https://computing.llnl.gov/tutorials/pthreads/)

在我还在学习的时候，我的老师给了我们一个 C 代码来玩弄：

```
/* Creates two threads, one printing 10000 "a"s, the other printing
   10000 "b"s.
   Illustrates: thread creation, thread joining. */

#include <stddef.h>
#include <stdio.h>
#include <unistd.h>
#include "pthread.h"

void * process(void * arg)
{
  int i;
  fprintf(stderr, "Starting process %s\n", (char *) arg);
  for (i = 0; i < 100; i++) {
       write(1, (char *) arg, 1);
//      fprintf(stdout, (char *) arg, 1);
  }
  return NULL;
}

int main()
{
  int retcode;
  pthread_t th_a, th_b;
  void * retval;

  retcode = pthread_create(&th_a, NULL, process, "a");
  if (retcode != 0) fprintf(stderr, "create a failed %d\n", retcode);

  retcode = pthread_create(&th_b, NULL, process, "b");
  if (retcode != 0) fprintf(stderr, "create b failed %d\n", retcode);

  retcode = pthread_join(th_a, &retval);
  if (retcode != 0) fprintf(stderr, "join a failed %d\n", retcode);

  retcode = pthread_join(th_b, &retval);
  if (retcode != 0) fprintf(stderr, "join b failed %d\n", retcode);

  return 0;
} 
```

*   运行命令：`sudo apt-get install build-essential`
*   下载此代码（显然 xD）
*   使用以下命令编译：`gcc -D_REENTRANT filenName.c -lpthread`
*   使用命令运行结果：`./a.out`

一切正常，但我不明白为什么我的输出顺序因使用`write`or不同而不同`fprintf`。

当我使用时，`write`我得到如下字母的随机输出：

```
Starting process a
aaaaaaaaaaaaaaaaaaaaaaaaaaaaStarting process b
aaababababababababababababababababababababababababababababababababababababababababababababababababababababababababababababababababababababababbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb 
```

但是当我使用时，`fprintf`我总是得到类似于以下内容的输出：

```
Starting process a
Starting process b
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaababbabaabaabaababbabbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb 
```

在这种情况下，文本“Starting process”总是首先出现，并且不会与输出的其余部分混合。为什么会这样？是因为`write`非常快而且`fprintf`比较慢吗？

作为一名 C 程序员，我应该使用哪一个，为什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-26T00:17:58.383

`write`是一个系统调用：它将给定的字符直接发送到操作系统，操作系统（在理论上，并且通常在实践中）立即将它们发送到输出设备，例如屏幕或磁盘。

`fprintf`（以及`fwrite`任何带`FILE *`参数的东西）是一个库调用，它在发送之前缓冲或收集程序内部的数据。这允许它发送更大、更统一的数据块，从而提高效率。

您看到的`write`是，每次调用都会导致线程切换，因为程序等待操作系统确认写入是否成功。当一个线程等待时，另一个线程获得时间。

有了`fprintf`，它永远不会做如此特别的事情。它实际上只是一个用 's 填充数组的线程，`a`直到完成。操作系统在接收到已填充的缓冲区（通过`write`）之前并不明智。然后由于第一个线程没有更多的工作，它运行第二个。如果您打印更多字符，您还会看到`fprintf`interleave `a`'s 和`b`'s 块被发送到操作系统。

至于“快”和“慢”，`write`在发送输出时更直接，但`fprintf`在几乎所有其他方式上都更快，并且是一般正确的选择（或者`fwrite`更类似于`write`）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-26T00:21:38.240

写入包装内核调用，并且它没有被缓冲。它只是将 n 个字节从缓冲区复制到文件描述符。

fprintf 是缓冲的，它也是用来进行字符串处理并用参数替换各种 %d、%s 的，因此执行起来要复杂得多，必须解析它接收到的字符串。

# php - 我应该使用什么样的数据结构来存储文件库..？

> ID：15079050
> 
> 赞同：-1
> 
> 时间：2013-02-26T00:13:46.220
> 
> 标签：php, jquery, html, xml, json

我打算有一个上传文件的数据库，我只是要把文件放在我的服务器上，但有一个单独的类似文本的文档（json、xml 等），其中包含所有信息，如名称、描述、标签和学校科目。我知道我可以使用 mysql 数据库，但实际上我只是通过 PHP 的 json_encode() 将结果发送到我的 jquery ajax 调用中。我想继续，如果我已经以 xml 或 json 格式存储名称、描述和其他重要（快速访问）信息会更快...

不同结构对我的意图有什么好处？

如果我不是很清楚，请告诉我。我确定我很模棱两可。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T00:17:43.207

您可能会考虑研究 NoSQL 数据库，如 MongoDb、DynamoDB 等。它们的设计基本上考虑了存储无模式数据（包括 JSON 结构）的想法。

NoSQL 存储解决方案可能是理想的情况包括：

*   您尝试存储的数据不适合传统的键值或关系数据库结构（即树层次结构、数据在结构上高度可变等）
*   您需要能够对数据结构执行详细的搜索/过滤。如果您只是使用键值存储或关系数据库来存储序列化数据结构，这可能会非常困难。
*   您需要能够强制执行读/写锁定或具有事务支持（即，您无法使用典型的平面文件数据序列化方法获得的项目）。

# .net - 找不到对象 DisplayFor 模板

> ID：15079052
> 
> 赞同：0
> 
> 时间：2013-02-26T00:14:03.827
> 
> 标签：.net, asp.net-mvc, templates

调用时是否有理由`/Views/Shared/DisplayTemplates/Object.cshtml`没有被视图接收`@Html.DisplayFor(x => x.Date)`？

如果我命名文件`DateTime.cshtml`，它会按原样由属性拾取`DateTime`，但我不想为每种类型创建一个模板。不应该`Object.cshtml`只用于所有事情吗？

我没有用任何属性装饰这些属性。

视图的代码：

```
@model Object

<div>
    <strong>@Model</strong>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T00:43:07.037

DisplayTemplates 不打算这样使用。`partial view`您应该使用以下内容创建一个：

```
@model Object

<div>
    <strong>@Model</strong>
</div> 
```

而不是这个：`@Html.DisplayFor(x => x.Date)`

你写这个：`@Html.Partial("YourPartialView", Model.Date)`

有了这个，你就可以达到你想要的结果。A`DisplayTemplate`是一个更具体的东西。

# c++ - 数组与向量：介绍性异同

> ID：15079057
> 
> 赞同：127
> 
> 时间：2013-02-26T00:14:46.517
> 
> 标签：c++, arrays, vector

C ++中的数组和向量有什么区别？差异的一个例子可能包括图书馆、象征、能力等。

### 大批

> 数组包含特定类型的特定数量的元素。为了使编译器在编译程序时可以保留所需的空间量，您必须指定数组在定义时将包含的元素的类型和数量。编译器必须能够在编译程序时确定该值。一旦定义了数组，就可以使用数组的标识符和索引来访问数组的特定元素。[...] 数组是零索引的；也就是说，第一个元素在索引 0 处。这种索引方案表明 C++ 中指针和数组之间的密切关系以及语言为指针算术定义的规则。
> 
> — C++ 袖珍参考

### 向量

> 向量是动态大小的对象序列，提供数组样式的`operator[]`随机访问。成员函数`push_back`通过复制构造函数复制其参数，将该副本添加为向量中的最后一项，并将其大小增加一。`pop_back`通过删除最后一个元素来做完全相反的事情。从向量末尾插入或删除项目需要摊销常数时间，从任何其他位置插入或删除需要线性时间。这些是向量的基础知识。他们还有很多。在大多数情况下，向量应该是 C 样式数组的首选。首先，它们是动态大小的，这意味着它们可以根据需要增长。您不必像 C 数组那样进行各种研究来确定最佳静态大小；矢量会根据需要增长，如果需要，可以手动将其大小调整为更大或更小。其次，向量提供使用`at`成员函数的边界检查（但不使用`operator[]`)，这样您就可以在引用不存在的索引时做一些事情，而不是简单地看着程序崩溃或更糟糕的是，继续使用损坏的数据执行。
> 
> — C++ 食谱

* * *

## 回答 #1

> 赞同：162
> 
> 时间：2013-02-26T00:55:17.393

数组：

*   是一种内置的语言结构；
*   几乎没有从 C89 修改；
*   ***只提供一个连续的、可索引的元素序列***；没有花里胡哨的东西；
*   大小固定；你不能在 C++ 中调整数组的大小（除非它是一个 POD 数组并且它是用 分配的`malloc`）；
*   它们的大小必须是编译时常量，除非它们是动态分配的；
*   它们根据您声明它们的范围占用存储空间；
*   如果是动态分配的，则必须显式释放它们；
*   如果它们是动态分配的，你只是得到一个指针，你不能确定它们的大小；否则，您可以使用`sizeof`（因此常见的成语`sizeof(arr)/sizeof(*arr)`，但是当无意中在指针上使用时会静默失败）；
*   在大多数情况下自动衰减到指针；特别是在将它们传递给函数时会发生这种情况，这通常需要为它们的大小传递一个单独的参数；
*   不能从函数返回；（除非它是 std::array）
*   不能直接复制/分配；
*   对象的动态数组需要一个默认构造函数，因为必须首先构造它们的所有元素；

`std::vector`：

*   是一个模板类；
*   是仅 C++ 的构造；
*   被实现为*动态数组*；
*   动态增长和收缩；
*   自动管理它们的内存，这些内存在销毁时被释放；
*   可以传递给函数/从函数返回（按值）；
*   可以复制/分配（这将执行所有存储元素的深层复制）；
*   不会衰减到指针，但您*可以*显式获取指向其数据的指针（`&vec[0]`保证按预期工作）；
*   总是与内部动态数组一起带来它的*大小*（当前存储了多少元素）和*容量（当前分配的块**中可以存储*多少元素）；
*   内部动态数组不是在对象本身内部分配的（它只包含一些“簿记”字段），而是由相关模板参数中指定的分配器动态分配；默认从freestore（所谓的堆）获取内存，与实际对象的分配方式无关；
*   出于这个原因，对于小型、短暂的本地数组，它们可能不如“常规”数组有效；
*   重新分配时，对象被*复制*（移动，在 C++11 中）；
*   不需要存储对象的默认构造函数；
*   更好地与所谓的 STL 的其余部分集成（它提供`begin()`/`end()`方法，通常的 STL `typedef`，...）

还要考虑数组的“现代替代方案” - `std::array`; 我已经在[另一个答案](https://stackoverflow.com/questions/4424579/stdvector-versus-stdarray-in-c/4424658#4424658)`std::vector`中描述了和之间的区别`std::array`，您可能想看看它。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-02-26T00:28:09.940

我要补充一点，数组是 C++ 中非常低级的构造，在“学习绳索”时，你应该尽量远离它们——甚至 Bjarne Stroustrup 也推荐这一点（他是 C++ 的设计者）。

向量非常接近与阵列相同的性能，但具有许多便利和安全特性。在与处理原始数组的 API 交互时，或者在构建自己的集合时，您可能会开始使用数组。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-02-26T00:21:53.377

这些参考几乎回答了你的问题。简而言之，向量的长度是动态的，而数组的大小是固定的。使用数组时，在声明时指定其大小：

```
int myArray[100];
myArray[0]=1;
myArray[1]=2;
myArray[2]=3; 
```

对于向量，您只需声明它并添加元素

```
vector<int> myVector;
myVector.push_back(1);
myVector.push_back(2);
myVector.push_back(3);
... 
```

有时您不知道所需的元素数量，因此向量将是这种情况的理想选择。

# ruby-on-rails - Rails 3.2.x ajax 和非 ajax 形式的双重请求

> ID：15079058
> 
> 赞同：2
> 
> 时间：2013-02-26T00:14:52.603
> 
> 标签：ruby-on-rails, ajax, ruby-on-rails-3.2, asset-pipeline

当我在生产环境中启动我的应用程序时，我的所有表单都会向服务器发出双重请求，即使它们没有`:remote => true`. 直到知道我发现的关于此问题的所有内容都与自 Rails 3.1 以来包含的资产管道有关，问题是资产中的某些文件正在复制某些内容，但我认为不是我的情况，因为它也以正常形式发生（没有 ajax ）。

对于网络服务器，应用程序使用的是默认配置的瘦，

这是我对 application.js 清单的要求

```
//= require jquery
//= require jquery_ujs
//= require jquery.cycle.all
//= require jquery.alphanumeric
//= require jquery.pageless
//= require jquery.ui.min.js
//= require jquery.fastLiveFilter.js
//= require_tree . 
```

这些文件中没有一个在 require_tree 搜索的不同路径中重复。

这是我的生产.rb

```
Web::Application.configure do
  # Settings specified here will take precedence over those in config/application.rb

  # Code is not reloaded between requests
  config.cache_classes = true

  # Full error reports are disabled and caching is turned on
  config.consider_all_requests_local       = false
  config.action_controller.perform_caching = true

  # Disable Rails's static asset server (Apache or nginx will already do this)
  config.serve_static_assets = true

  # Compress JavaScripts and CSS
  config.assets.compress = true

  # Don't fallback to assets pipeline if a precompiled asset is missed
  config.assets.compile = false

  # Generate digests for assets URLs
  config.assets.digest = true

  # Enable locale fallbacks for I18n (makes lookups for any locale fall back to
  # the I18n.default_locale when a translation can not be found)
  config.i18n.fallbacks = true

  # Send deprecation notices to registered listeners
  config.active_support.deprecation = :notify

  # Amazon SES
  config.action_mailer.delivery_method = :ses
end 
```

这是我的应用程序.rb

```
require File.expand_path('../boot', __FILE__)

#require 'rails/all'

#require "active_record/railtie"
require "action_controller/railtie"
require "action_mailer/railtie"
require "active_resource/railtie"
require "rails/test_unit/railtie"
require "sprockets/railtie"

if defined?(Bundler)
  # If you precompile assets before deploying to production, use this line
  Bundler.require(*Rails.groups(:assets => %w(development test)))
  # If you want your assets lazily compiled in production, use this line
  # Bundler.require(:default, :assets, Rails.env)
end

module Web
  class Application < Rails::Application

    # Custom directories with classes and modules you want to be autoloadable.
    # config.autoload_paths += %W(#{config.root}/extras)
    #config.autoload_paths += %W(#{config.root}/lib)
    config.autoload_paths += Dir["#{config.root}/lib", "#{config.root}/lib/**/"]

    # Configure the default encoding used in templates for Ruby 1.9.
    config.encoding = "utf-8"

    # Configure sensitive parameters which will be filtered from the log file.
    config.filter_parameters += [:password]

    # Enable escaping HTML in JSON.
    config.active_support.escape_html_entities_in_json = true

    # Commented because we don't use AR nor DB
    #config.active_record.whitelist_attributes = true

    # Enable the asset pipeline
    config.assets.enabled = true

    # Version of your assets, change this if you want to expire all your assets
    config.assets.version = '1.0'
  end
end 
```

# biztalk - BizTalk Schema 开发 - 十六进制值 0x19，是无效字符

> ID：15079059
> 
> 赞同：1
> 
> 时间：2013-02-26T00:15:00.167
> 
> 标签：biztalk, biztalk-2010, schema-design

我有一个架构元素节点，如下所示

`<MESSAGE>Employees eligibility for a benefit granted by a banking department agency of security.</MESSAGE>`

在为此节点开发架构时，我发现警告为

> 警告 BEC2004：''，十六进制值 0x19，是无效字符。第 20 行，第 26 位。

请问有人可以帮我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T11:57:14.463

[这个 StackOverflow 问题](https://stackoverflow.com/questions/1325379/hexadecimal-0x19-is-an-invalid-character "这个 Stackover Flow 问题")似乎很适合您的问题。

简而言之，十六进制字符 0x19 在 XML 中无效（请参阅[http://www.w3.org/TR/REC-xml/#charsets](http://www.w3.org/TR/REC-xml/#charsets)上的 Xml 规范），因此出现错误。因此，您需要将其从输入消息中删除 - 或要求生成消息的系统删除该字符。

要查看导致实际问题的字符（0x19 是“em”系统字符，可能不会出现），请在十六进制查看器中查看有问题的文件，您可以在线获取该文件。

如果 Xml 是从平面文件模式生成的，您可能需要考虑在平面文件反汇编程序解析消息之前，在接收管道的解码阶段从输入平面文件消息中去除违规字符。

# python - 如何使用美丽的汤4在内部获取文本

> ID：15079061
> 
> 赞同：0
> 
> 时间：2013-02-26T00:15:09.777
> 
> 标签：python, beautifulsoup

当它无法识别时，它应该如何用漂亮的汤 4 解析它`td.font.unwrap()`？我应该更换它还是什么？或打开它？

```
<td align="CENTER">
    <font size="+2">横&lt;/font>(F
    <font size="+2">橫&lt;/font>)
</td> 
```

我只想得到我现在得到的字符串`横(F橫)` 是：横（F�）

我可以很好地调用 td 字段，但无法获得最后一个字符......这就是我现在所说的 `y = cols[1].text`

`cols`是`<td>`字段，这是该行中的第二个字段`<tr>`....

完整代码如下：

```
 # coding: utf8
from pysqlite2 import dbapi2 as sqlite3
import urllib2
from bs4 import BeautifulSoup
from string import *

conn = sqlite3.connect(':memory:')
cursor = conn.cursor()

# # create a table
def createTable():
    cursor.execute("""CREATE TABLE characters
                      (rank INTEGER, word TEXT, definition TEXT) 
                   """)

def insertChar(rank,word,definition):
    cursor.execute("""INSERT INTO characters (rank,word,definition)
                        VALUES (?,?,?)""",(rank,word,definition))

def main():
    createTable()

    # u = unicode("辣", "utf-8")

    # insertChar(1,u,"123123123")

    # content = "\n".join(response.readlines()[1:])
    soup = BeautifulSoup(urllib2.urlopen('http://www.zein.se/patrick/3000char.html').read())

    # print (html_doc.prettify())   

    tables = soup.blockquote.table

    # print tables

    rows = tables.find_all('tr')[1:]
    result=[]
    for tr in rows:
        # print tr
        cols = tr.find_all('td')
        character = []
        # col = cols.fonts.unwrap()
        # x = int (cols[0].string)
        x = 0
        y = cols[1].text
        # chars = y.find_all('font') 

        z = "11"
        print y
        # y = cols[1].string
        # z = cols[2].string

        # xx = unicode(x, "utf-8")
        # yy = unicode(y , "utf-8")
        # zz = unicode(z , "utf-8")
        insertChar(x,y,z)

    conn.commit() 

main() 
```

感谢您的帮助！谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T00:25:21.207

该网站声称在 gb2312 中，但事实并非如此。这应该解决它：

```
url = 'http://www.zein.se/patrick/3000char.html'
soup = bs4.BeautifulSoup(urllib2.urlopen(url).read(), from_encoding='gb18030') 
```

要不就

```
soup = bs4.BeautifulSoup(urllib2.urlopen(url).read(), from_encoding='gbk') 
```

您的浏览器可以理解，但 BeautifulSoup 需要提示。

# rest - 如何在 elasticsearch 中设置分词器

> ID：15079064
> 
> 赞同：16
> 
> 时间：2013-02-26T00:15:14.280
> 
> 标签：rest, elasticsearch, config

我有一个使用 elasticsearch-jetty 项目的嵌入式弹性搜索，我需要设置为使用比默认值更好的标记器。我想使用关键字标记器。

我一生都无法弄清楚如何通过配置文件来做到这一点。谁能指出我通过配置文件做到这一点的方法？

顺便说一句，是否可以在索引启动并运行时通过对索引执行 POST 来调整索引？我真的很想了解如何使用它，谢谢。

编辑/更新：我在运行 curl -XPUT 或 -XPOST 到 localhost:9200 以尝试从我在此处搜索帮助时看到的一些示例/论坛调整设置时遇到问题，我得到的结果是“否” uri [] 和方法 [PUT]/[POST] 的处理程序。

编辑 2：更新，对索引执行 XPUT 工作，但我收到有关“索引已存在”的错误。我知道它存在，我想更新它。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-02-26T01:17:48.303

您可以在配置文件中定义映射，但在大多数情况下，通过 API 进行配置更容易/更灵活。例如，此命令将向索引添加关键字/小写分析器`test`：

```
$ curl -XPUT localhost:9200/testindex/ -d '
{
  "settings":{
     "index":{
        "analysis":{
           "analyzer":{
              "analyzer_keyword":{
                 "tokenizer":"keyword",
                 "filter":"lowercase"
              }
           }
        }
     }
  },
  "mappings":{
     "test":{
        "properties":{
           "title":{
              "analyzer":"analyzer_keyword",
              "type":"string"
           }
        }
     }
  }
}' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-19T18:58:27.737

要更新现有索引，请使用

```
$ curl -XPUT localhost:9200/testindex/_settings -d '
{
..........
} 
```

但是，您不能更新非动态设置。

# c++ - 确保具有全局范围的静态变量无处不在

> ID：15079065
> 
> 赞同：2
> 
> 时间：2013-02-26T00:15:17.470
> 
> 标签：c++, variables, dll, static-linking

我有一个情况，我有一个标题/实现对（x.hpp/x.cpp）。在 x.cpp 中定义了一个全局范围的静态变量。

标头 x.hpp 用于相关应用程序中的许多不同位置。并且还打算由应用程序将使用的 dll 使用，无论是自动加载还是通过 dlopen/LoadLibrary 等。

```
--- x.hpp ---
int foo();
void boo();

class fooboo
{ public: void boofoo() {} };
-------------

--- x.cpp ---
static fooboo global_var;
fooboo foo() { return global_var; }
void boo() { global_var.boofoo(); }
------------- 
```

.

**我的问题：**在 C++ 中，是否有一种方法可以保证在如何调用和使用 TU(x.hpp/x.cpp) 的所有各种用例下，只存在一个 global_var 实例？

请考虑多线程和 dll 的情况。除了确保代码库中使用 extern 引用 global_var 的每个实例之外，还有什么可以做的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T00:39:56.893

实际上，该变量仅在 x.cpp 翻译单元中创建和可见；只能有一个，假设 x.cpp 只编译一次。将它包含在 .dll 和 .exe 中会导致 2 个变量实例，但除此之外你是安全的。请注意，尽管 foo() 不会返回对 fooboo 的引用，但它会返回它的副本（顺便说一下，它也与标头声明不匹配）。

# python - 计算笛卡尔积的线性时间算法

> ID：15079069
> 
> 赞同：2
> 
> 时间：2013-02-26T00:15:50.957
> 
> 标签：python, algorithm, cartesian-product

我在一次采访中被要求为笛卡尔积提出一个线性时间的解决方案。我做了迭代方式 O(mn) 和递归解决方案也是 O(mn)。但我无法进一步降低复杂性。有没有人知道如何改善这种复杂性？也有人可以提出一种有效的递归方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T01:05:04.010

有`mn`结果；您要做的最少工作是将每个结果写入输出。所以你不能做得比`O(mn)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-23T19:00:25.883

读到这里，我想到的问题是，“关于什么是线性的？” 请记住，在数学中，所有变量都必须定义为有意义。Big-O 表示法也不例外。如果 n 没有定义，简单地说算法是 O(n) 是没有意义的。

假设这个问题是有意义的，而不是一个错误，我猜他们希望你要求澄清。另一种可能性是，他们想看看你在遇到不可能的情况时会如何反应。

# spring - 暴露 Spring-WS

> ID：15079074
> 
> 赞同：2
> 
> 时间：2013-02-26T00:16:32.723
> 
> 标签：spring, jax-ws

ws。我正在使用 tomcat7 部署我的应用程序，它是用 spring3 制作的。我已经让我的 ws 工作了，但是现在我需要它在 tomcat 的同一端口上运行，每次我使用 tomcat 的相同端口设置 simpleJaxWsServiceExporter 的基地址时，应用程序和 Web 服务都会崩溃我得到一个 404 错误代码。

到目前为止，这是我的 ws 代码

```
@Bean
public SimpleJaxWsServiceExporter simpleJaxWsServiceExporter() {
    SimpleJaxWsServiceExporter bean = new SimpleJaxWsServiceExporter();
    bean.setBaseAddress("http://mydomain:5900/");       
    return bean;
}

@Component 
```

@WebService(serviceName = "ProblemService") 公共类 ProblemService{

```
@Autowired
private ProblemDAO problemDAO;

@WebMethod
public String getProblemByAbb(@WebParam(name = "abb")String name){
    return "Hola "+name;
} 
```

}

# javascript - 这个 jQuery 代码是如何工作的（即变量中的内容是什么）？

> ID：15079079
> 
> 赞同：-1
> 
> 时间：2013-02-26T00:17:07.763
> 
> 标签：javascript, jquery, reporting-services

我正在研究这个 jQuery 代码，它获取 SSRS Report Viewer 生成的网页，然后用 datepicker（标准 jQuery）覆盖它。

在这里，我们寻找接受日期的输入文本框：

```
var span = innerTable.find("span:contains('Date')");
if (span) {
    var innerRow = $(span).parent().parent();
    var innerCell =  innerRow.find("td").eq(1);
    var textFrom = innerCell.find("input[type=text]");
    innerCell = innerRow.find("td").eq(4);
    var textTo = innerCell.find("input[type=text]"); 
} 
```

所以我很好奇变量中有什么样的值`textTo`。那是因为在后面的代码中，我们说：

```
$(textTo).focus(function () {
    $(textTo).datepicker("show");   
}); 
```

另外，有什么作用`focus(function ()`？

任何提示表示赞赏，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T00:27:13.387

它将是代表节点的[jQuery 对象。](http://api.jquery.com/Types/#jQuery)`input[type=text]`（注意：在您的场景中，可能只有一个这样的节点，但您应该知道它会[`find`](http://api.jquery.com/find/)返回与选择器匹配的*所有*节点。）它基本上是 jQuery 对表示*特定 DOM 对象*的所有信息的包装。您可以使用该对象来获取有关`input`元素的各种信息——例如它的`value`、CSS 样式、父级等——还可以使用它来操作元素——删除它，在它之前添加一些东西，或者添加一个事件侦听器。

这是一个代码演练：

```
var innerRow = $(span).parent().parent(); // the grandparent of the `span` node
var innerCell =  innerRow.find("td").eq(1); // the second (index 1) table cell inside the row we just found in the previous line
var textFrom = innerCell.find("input[type=text]"); // the input elements inside that cell
innerCell = innerRow.find("td").eq(4); // the fifth (index 4) table cell inside the row from line 1
var textTo = innerCell.find("input[type=text]"); // the input elements inside the cell found in the previous line 
```

至于问题的第二部分，当元素获得焦点时，[`focus`侦听](http://api.jquery.com/focus/)器将执行一个函数`input`- 即光标在其中移动。当用户直接在元素内部单击或从表单中的另一个元素中单击它时，可能会发生这种情况。具体来说，您的代码说：当这`input`获得焦点时，显示日期选择器。

# c# - 如何在 Windows Installer 中调用 URL？

> ID：15079080
> 
> 赞同：0
> 
> 时间：2013-02-26T00:17:17.887
> 
> 标签：c#, windows-installer

在继续安装之前，我需要检查 URL 是否发送响应。我一直在搜索，但找不到有关如何在安装项目中执行某些代码的任何信息。任何能让我朝着正确方向前进的帮助都会非常有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T00:26:40.953

您需要的称为[自定义操作](http://msdn.microsoft.com/en-us/library/windows/desktop/aa368066.aspx)。打包自定义操作有多种选择——dll 和 exe 是最便携的。在您的情况下，我建议使用托管 exe 自定义操作来接收要检查的 URL 和命令行上的任何其他参数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T15:56:17.673

如果用户没有互联网连接怎么办？如果安装是由诸如 SCCM 之类的工具在没有代理权限的系统上下文中完成的，该怎么办？如果用户对安装人员每次打电话回家都有隐私问题怎么办？

这真的属于安装还是您可以在应用程序中处理它？这只会降低安装的稳健性。

# matplotlib - 在 Matplotlib 中更改框/小提琴图的轴标签

> ID：15079081
> 
> 赞同：3
> 
> 时间：2013-02-26T00:17:25.623
> 
> 标签：matplotlib

稍微修改一下这里的代码：http: [//pyinsci.blogspot.com/2009/09/violin-plot-with-matplotlib.html](http://pyinsci.blogspot.com/2009/09/violin-plot-with-matplotlib.html)如下，我可以得到一个用 Python 制作的小提琴图，如下所示：

```
# Import modules
import pylab as pl
from scipy import stats
import numpy as np

# Function for Violin Plot

def violin_plot(ax,data,groups,bp=False):
    '''Create violin plot along an axis'''
    dist = max(groups) - min(groups)
    w = min(0.15*max(dist,1.0),0.5)
    for d,p in zip(data,groups):
        k = stats.gaussian_kde(d) #calculates the kernel density
        m = k.dataset.min() #lower bound of violin
        M = k.dataset.max() #upper bound of violin
        x = np.arange(m,M,(M-m)/100.) # support for violin
        v = k.evaluate(x) #violin profile (density curve)
        v = v/v.max()*w #scaling the violin to the available space
        ax.fill_betweenx(x,p,v+p,facecolor='y',alpha=0.3)
        ax.fill_betweenx(x,p,-v+p,facecolor='y',alpha=0.3)
    if bp:
        ax.boxplot(data,notch=1,positions=pos,vert=1)

groups = range(3)
a = np.random.normal(size=100)
b = np.random.normal(size=100)
c = np.random.normal(size=100)

data = np.vstack((a,b,c))
fig = pl.figure()
ax = fig.add_subplot(111)
violin_plot(ax,data,groups,bp=0)
pl.show() 
```

这会产生一个像这样的图形：

![在此处输入图像描述](../Images/2166bd38b64518881d77e972eb2eca3c.png)

我想做的是更改刻度线的标签，这样就不是-0.5到2.5乘0.5个数字，只有一个“A”，0.0是，一个“B”是1.0，一个“C”是2.0。

是否有捷径可寻？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T05:39:31.770

在调用之前`pl.show`，请使用：

```
ax.set_xticks([0, 1, 2])
ax.set_xticklabels(['A', 'B', 'C']) 
```

# c++ - 精确确定程序中的执行次数

> ID：15079082
> 
> 赞同：-1
> 
> 时间：2013-02-26T00:17:42.223
> 
> 标签：c++, math

有人可以帮我确定该语句将在最内层循环中执行多少次吗？

```
for(int i = 1; i <= n; i++)
    for(int j = 1; j <= n; j++)
        for(int k = j; k <= n; k++)
            //statement 
```

我不太确定如何处理这种形式的问题，我认为如果有人可以概述解决此类问题可能经历的思维过程，这将是一个有用的练习。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T00:22:40.763

因此，第一个循环（使用`i`）在 the`i <= n`为真时进行迭代 - 这意味着如果`n >= 1`，它将迭代`n`次数。`j`循环也一样。到目前为止，我们有`n * n`迭代。

第三个`k`循环有点棘手，因为它从 开始`j`，所以第一次，它将从`1`to运行`n`，但下一次它从 2 开始，以此类推，直到`j == n`，它只运行一次。平均而言，这是`n/2`迭代。

所以这使得`n * n * (n+1)/2`总迭代。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T00:24:34.713

答案是 n*n*(n+1)/2

为什么留给读者作为练习

# c++ - 我究竟做错了什么？（C++ 字符串）

> ID：15079084
> 
> 赞同：2
> 
> 时间：2013-02-26T00:17:50.017
> 
> 标签：c++, arrays, string

```
#include <iostream>
#include <cstring>

using namespace std;

int main()
{
    int n;
    cin >> n;

    string a;
    cin >> a;

    int index;

    for(int i=0;i<strlen(a);i++)
    {
        if(a[i]=="?")
        {
            index=i;
        }
    }

    cout << index;

    return 0;
} 
```

我想找到“？” 如果有的话，在字符串中，但我得到错误：“ISO C++ 禁止指针和整数之间的比较”

有什么帮助吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-26T00:19:04.223

在 '?' 周围使用单引号 字符来指示字符而不是字符串。这就是你的比较失败的原因。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-26T00:19:47.557

A：在你的 for 循环中混合 C++ 字符串和旧的 C 风格 (strlen) 函数（`a.length()`改用）

B：将 C 字符串与字符进行比较`if(a[i]=="?")`应该是`if(a[i]=='?')`（使用单引号来比较字符 - 双引号使其成为字符串比较，实际上是指针比较，并且不会按照您的预期进行）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-26T00:29:37.833

除了其他答案之外，您的程序可以使用一些方便的内置函数简化为以下内容：

```
#include <iostream>
#include <string>

int main()
{
    std::string a;
    std::getline(std::cin, a);

    int index;

    auto pos = a.find("?");

    if (pos != std::string::npos)
      index = pos;
   else
      index = -1;

    std::cout << index;
} 
```

### 建议：

*   使用`<string>`代替`<cstring>`,
*   处理输入和字符串时，使用[`std::getline`](http://en.cppreference.com/w/cpp/string/basic_string/getline)而不是`std::cin`消耗整行，
*   [`std::string::find`](http://en.cppreference.com/w/cpp/string/basic_string/find)是比手动循环更好的选择。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-26T00:25:05.013

> 有什么帮助吗？

1.  您不能在对象 std::string 的实例上调用 c 函数 strlen() 而是使用 std::string::length()
2.  std::string 的 operator[] 返回您试图与类型为 const char * 的字符串常量进行比较的 char 类型
3.  您使用未初始化的变量索引，如果您的条件从未成功（假设您最终修复它），您将无法找到它
4.  std::string 具有 find() 方法，如果找不到则返回字符串中的位置或常量 std::string::npos

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-26T00:31:25.803

内嵌评论...

```
#include <iostream>
//#include <cstring> // You don't need this
#include <string> // You do need this

// using namespace std; // You don't need this

int main()
{
    // int n; // This is not used
    // cin >> n; // Nor is this

    std::string user_input; // Use std:: and meaningful variable names
    std::cin >> user_input; // "

    int index = user_input.find('?'); // This is the simplest way to find a character

    // for(int i=0;i<strlen(a);i++) // strlen() does not work here
    // {
    //  if(a[i]=="?") // chars are quoted with single quotes, as above. This is {'a', '\0'}
        //{
            // index=i; You could break here, too, otherwise you'll reurn the last '?'
        //}
    // }

    std::cout << index;

    // return 0; // This is unnecessary
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-26T00:38:45.683

`"?"`在内存中创建一个字符串。一个常量字符串 like`"?"`将指向内存中地址的开始。因此它是一个指针。

`'?'`就地创建单个字符，并且不创建指针。因此，当与另一个字符或整数进行比较时，ISO C++ 禁止您尝试将整数（或字符）与指针（例如字符串）进行比较。

所以应该是

```
 if(a[i]=='?')
    {
        index=i;
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-26T01:05:41.063

在这里，我将演示如何从 std::string 中找到一个*问号（'？'）：请务必阅读评论！

```
int main( void )
{
    // DECLARE LOCAL VARIABLES
    // Declare strA as std::string
    std::string strA = "";
    // Declare nIndex as int. We set the value of it to -1 to let us know
    // if there were any '?' within strA
    int nIndex = -1;

    // INITIALIZE
    // Set the value of strA to the line that was inputted
    // You might want to loop this until the length of strA
    // is greater than 0
    std::getline( std::cin, strA );

    // SEARCH FOR THE FIRST '?'
    // if std::string::find returns -1, then no '?' was found within strA
    nIndex = strA.find( '?' );

    // CHECKING AND PRINTING nIndex
    // Remember why strA is -1?
    if( nIndex == -1 )
        std::cout << "The inputted string does not contain any '?'...\n";
    else std::cout << "The first '?' is found at: " << nIndex;

    // DONE

#ifdef DEBUG
    std::cout << "\nDebugging > Paused! Enter any key to continue...\n";
    ::getchar( );
#endif // DEBUG
    return( 0 );
}; 
```

# ruby-on-rails - 如何找出哪个 gem 具有特定的依赖关系？

> ID：15079090
> 
> 赞同：81
> 
> 时间：2013-02-26T00:18:12.933
> 
> 标签：ruby-on-rails, ruby, gem, bundler

我注释掉了一个 gem，但“捆绑安装”仍然无法运行。如何找出哪个 gem 依赖于 sys-proctable？

```
$ bundle install
Fetching gem metadata from https://rubygems.org/.........
Fetching gem metadata from https://rubygems.org/..
Resolving dependencies...
Could not find sys-proctable-0.9.2 in any of the sources

$ grep proctable Gemfile
  #gem 'sys-proctable', '0.9.2', :path => "vendor/gems"

$ bundle list
Resolving dependencies...
Could not find gem 'rspec-rails (= 2.11.0) ruby' in the gems available on this machine.

$ bundle viz
Resolving dependencies...
Could not find gem 'rspec-rails (= 2.11.0) ruby' in the gems available on this machine.

$ bundle -v
Bundler version 1.3.0

$ ruby -v
ruby 1.9.3p385 (2013-02-06 revision 39114) [i386-cygwin] 
```

[宝石文件： http](http://pastebin.com/9WWMfKtv) ://pastebin.com/9WWMfKtv

我已经尝试过这些故障排除步骤：[https ://github.com/carlhuda/bundler/blob/1-2-stable/ISSUES.md](https://github.com/carlhuda/bundler/blob/1-2-stable/ISSUES.md)

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2013-02-26T00:24:04.840

在 bash shell 中，您可以执行以下操作：

`gem dependency name_of_the_gem --reverse-dependencies`

例如：

```
$ gem dependency activesupport --reverse-dependencies                        
Gem activesupport-2.3.14
Used by
actionpack-2.3.14 (activesupport (= 2.3.14))
activerecord-2.3.14 (activesupport (= 2.3.14))
activeresource-2.3.14 (activesupport (= 2.3.14)) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2018-08-08T09:34:41.873

**我知道这个答案包含一个链接，但这不是一个链接特定的答案**

您始终可以在[ruby​​gems.org](https://rubygems.org)上检查 gem 的反向依赖关系。网站右侧面板上有一个链接。

[![在此处输入图像描述](../Images/b88e97b89ba6afefad98cff7ca6997ed.png)](https://i.stack.imgur.com/ooq7V.png)

或者您可以访问该网站

> `https://rubygems.org/gems/{gem_name}/reverse_dependencies`

所以，在你的情况下

[https://rubygems.org/gems/sys-proctable/reverse_dependencies](https://rubygems.org/gems/sys-proctable/reverse_dependencies)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-05-07T17:25:03.213

> 如何找出哪个 gem 依赖于 sys-proctable？

试试[bundler-why](https://github.com/jaredbeck/bundler-why)插件（灵感来自[`yarn why`](https://classic.yarnpkg.com/en/docs/cli/why)）

```
bundler plugin install bundler-why
bundle why tzinfo
# ransack -> activesupport -> tzinfo
# rspec-rails -> activesupport -> tzinfo
# business_time -> tzinfo 
```

`gem dependency --reverse-dependencies`[将遍历路径](https://en.wikipedia.org/wiki/Path_(graph_theory))的单个[边缘](https://en.wikipedia.org/wiki/Graph_(discrete_mathematics))。相比之下，将遍历所有边。`bundle why`

# python - 在 Django 中通过管理员上传图片

> ID：15079105
> 
> 赞同：0
> 
> 时间：2013-02-26T00:19:46.313
> 
> 标签：python, django, django-admin, django-models

我正在尝试通过 Django 管理面板上传图像。我在 Google App Engine 上运行并使用文件传输插件（不确定是否与我遇到的问题有关）。

从我的modelys.py：

```
from django.db import models

# Create your models here.
class CarouselItem (models.Model):
    caption = models.CharField(max_length=200,blank=True)
    order = models.IntegerField()
    carousel_image = models.ImageField(upload_to='uploads/carousel_image/%Y/%m/%d/')
    def __unicode__(self):
        return self.caption 
```

来自 admin.py：

```
from carousel.models import CarouselItem
from django.contrib import admin
from imperavi.admin import ImperaviAdmin

class carouselAdmin(ImperaviAdmin):
    list_display = ('caption','order')

admin.site.register(CarouselItem, carouselAdmin) 
```

我得到的错误是“没有名为 Image 的模块”。我没有安装 PIL。我是否需要安装它才能启用此功能？

更新：这是导致错误的回溯：

```
Environment:

Request Method: POST
Request URL: http://127.0.0.1:8000/admin/carousel/carouselitem/add/

Django Version: 1.3.1
Python Version: 2.7.2
Installed Applications:
['django.contrib.admin',
 'django.contrib.contenttypes',
 'django.contrib.auth',
 'django.contrib.sessions',
 'djangotoolbox',
 'autoload',
 'dbindexer',
 'django.contrib.staticfiles',
 'portfolio',
 'EBoardMembers',
 'Calendar',
 'filetransfers',
 'positions',
 'imperavi',
 'chunks',
 'carousel',
 'djangoappengine']
Installed Middleware:
('autoload.middleware.AutoloadMiddleware',
 'django.middleware.common.CommonMiddleware',
 'django.contrib.sessions.middleware.SessionMiddleware',
 'django.contrib.auth.middleware.AuthenticationMiddleware')

Traceback:
File "/Users/Zach/Documents/Cornell/Activities/MICC/new_website/MICC_app_engine/django/core/handlers/base.py" in get_response
  111\.                         response = callback(request, *callback_args, **callback_kwargs)
File "/Users/Zach/Documents/Cornell/Activities/MICC/new_website/MICC_app_engine/django/contrib/admin/options.py" in wrapper
  307\.                 return self.admin_site.admin_view(view)(*args, **kwargs)
File "/Users/Zach/Documents/Cornell/Activities/MICC/new_website/MICC_app_engine/django/utils/decorators.py" in _wrapped_view
  93\.                     response = view_func(request, *args, **kwargs)
File "/Users/Zach/Documents/Cornell/Activities/MICC/new_website/MICC_app_engine/django/views/decorators/cache.py" in _wrapped_view_func
  79\.         response = view_func(request, *args, **kwargs)
File "/Users/Zach/Documents/Cornell/Activities/MICC/new_website/MICC_app_engine/django/contrib/admin/sites.py" in inner
  197\.             return view(request, *args, **kwargs)
File "/Users/Zach/Documents/Cornell/Activities/MICC/new_website/MICC_app_engine/django/utils/decorators.py" in _wrapper
  28\.             return bound_func(*args, **kwargs)
File "/Users/Zach/Documents/Cornell/Activities/MICC/new_website/MICC_app_engine/django/utils/decorators.py" in _wrapped_view
  93\.                     response = view_func(request, *args, **kwargs)
File "/Users/Zach/Documents/Cornell/Activities/MICC/new_website/MICC_app_engine/django/utils/decorators.py" in bound_func
  24\.                 return func(self, *args2, **kwargs2)
File "/Users/Zach/Documents/Cornell/Activities/MICC/new_website/MICC_app_engine/django/db/transaction.py" in inner
  217\.                 res = func(*args, **kwargs)
File "/Users/Zach/Documents/Cornell/Activities/MICC/new_website/MICC_app_engine/django/contrib/admin/options.py" in add_view
  864\.             if form.is_valid():
File "/Users/Zach/Documents/Cornell/Activities/MICC/new_website/MICC_app_engine/django/forms/forms.py" in is_valid
  121\.         return self.is_bound and not bool(self.errors)
File "/Users/Zach/Documents/Cornell/Activities/MICC/new_website/MICC_app_engine/django/forms/forms.py" in _get_errors
  112\.             self.full_clean()
File "/Users/Zach/Documents/Cornell/Activities/MICC/new_website/MICC_app_engine/django/forms/forms.py" in full_clean
  267\.         self._clean_fields()
File "/Users/Zach/Documents/Cornell/Activities/MICC/new_website/MICC_app_engine/django/forms/forms.py" in _clean_fields
  282\.                     value = field.clean(value, initial)
File "/Users/Zach/Documents/Cornell/Activities/MICC/new_website/MICC_app_engine/django/forms/fields.py" in clean
  503\.         return super(FileField, self).clean(data)
File "/Users/Zach/Documents/Cornell/Activities/MICC/new_website/MICC_app_engine/django/forms/fields.py" in clean
  163\.         value = self.to_python(value)
File "/Users/Zach/Documents/Cornell/Activities/MICC/new_website/MICC_app_engine/django/forms/fields.py" in to_python
  528\.             import Image

Exception Type: ImportError at /admin/carousel/carouselitem/add/
Exception Value: No module named Image 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-12T14:03:13.653

您需要安装 PIL 或同等产品。在 python 3.x 的情况下枕头。如果您在安装时遇到问题，请告诉我，我有一些并且很容易修复，您只需将路径添加到您的 python.h 即可。也许现在已经修复了......在models.py中没有添加

[关联](https://pypi.python.org/pypi/Pillow/2.0.0#downloads)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-06T22:49:16.390

是的，您需要安装 Pil。但在此之前，您需要将 jpeglib 安装到您的服务器（没有此 PIL 无法使用 jpeg 文件）

另外，您可以包括

```
from django.db.models import ImageField 
```

在你的models.py

# mysql - 添加两列的简单 SQL 测试

> ID：15079112
> 
> 赞同：1
> 
> 时间：2013-02-26T00:20:08.700
> 
> 标签：mysql, sql, web

遇到问题 13 时遇到问题，我如何在运行查询后将两个总数相加？ [问题图片](http://i.stack.imgur.com/s1ZZo.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T00:23:35.680

也许尝试删除“ `GROUP BY Cause`”...？

# python - 来自熊猫的 JS 数据表

> ID：15079118
> 
> 赞同：13
> 
> 时间：2013-02-26T00:20:22.273
> 
> 标签：python, datatables, pandas

我想将熊猫数据帧与数据表一起使用。我无法弄清楚如何在没有 id 的情况下初始化表。

当我调用 df.to_html() 时，有什么方法可以在 table 标签中设置 id？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2015-05-06T21:04:21.433

你可以试试这个：

```
df.to_html(classes = 'my_class" id = "my_id') 
```

这基本上就像一个 SQL 注入。
Pandas 的 to_html 函数在类周围使用双引号。您可以使用单引号来定义 classes 参数，并将双引号放在其中以结束 pandas 的类。然后在您的 id 名称周围加上双引号，但让 pandas 为您关闭这些双引号。输出将如下：

```
'<table border="1" class="dataframe my_class" id = "my_id">...' 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-26T00:29:01.983

我认为这种行为在 中不可用`to_html`，但一种方法是手动将其插入：

```
In [11]: df = pd.DataFrame([1])

In [12]: s = df.to_html()

In [13]: print (s[:7] + 'id="my_dfs_id" ' + s[7:])
<table id="my_df_id" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>0</strong></td>
      <td> 1</td>
    </tr>
  </tbody>
</table> 
```

您可以将此行为放入一个函数中：

```
def df_to_html_with_id(df, id):
    s = df.to_html()
    return s[:7] + 'id="%s" ' % id + s[7:] 
```

示例用法：`df_to_html_with_id(df, "hello")`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-01-08T19:30:39.693

我采用了一种稍微不同的方法，并决定通过 CSS 类进行初始化，这样的好处是所有的 pandas 表都变成了 DataTables。如果您想要一个具有不同选项的更精细的控件，您可以添加另一个类

```
$(document).ready(function(){
    $('.dataframe').DataTable();
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-03-07T17:20:14.747

尽管接受的答案非常有效，但这是我将 id 和一些类应用于表格标题的方法。

```
html = df.to_html().replace('<table','<table class="tableBoot" id="myTable"') 
```

这是有效的，因为 to_html 只返回一个字符串，我们可以使用字符串对象的 python 替换方法将任何部分替换为其他任何部分（请注意，我只使用了开头的 '<'）。我用它来包含样式到`<thead>`ie。表的标题部分！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-29T19:22:11.910

[pandas.to_html](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.to_html.html)现在有一个参数`table_id`，可用于直接设置表 ID。

```
import pandas as pd

df = pd.DataFrame({
    'A': [1, 2],
    'B': [3, 4]
})

s = df.to_html(table_id='my_df_id')
print(s) 
```

`s`：

```
<table border="1" class="dataframe" id="my_df_id">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
```

# c - 使用 fork() 在 C 中创建两个子进程时遇到问题（在 Debian 中）

> ID：15079122
> 
> 赞同：0
> 
> 时间：2013-02-26T00:20:40.370
> 
> 标签：c, process, debian, fork

试图将父进程拆分为两个子进程。第一个将计算给定数字的阶乘。第二个只会说`I'm child 2!`完成后，第一个孩子将输出计算阶乘所需的时间。让第一个孩子分裂并完成它的工作就很好。但是，我看不到让第二个孩子做任何事情。知道我做错了什么吗？

```
#include <stdio.h>
#include <time.h>
//#include </sts/types.h>
#include <unistd.h>

//prototypes
int rfact(int n);
int temp = 0;

main()
{
    int n = 0;
    long i = 0;
    double result = 0.0;
    clock_t t;
    printf("Enter a value for n: ");
    scanf("%i", &n);

    pid_t pID = fork();
    if (pID ==0)//child
    {
        //get current time
        t = clock();

        //process factorial 2 million times
        for(i=0; i<2000000; i++)
        {
            rfact(n);
        }

        //get total time spent in the loop
        result = ((double)(clock() - t))/CLOCKS_PER_SEC;

        //print result
        printf("runtime=%.2f seconds\n", result);
    }
    else if(pID < 0)
    {
        printf("fork() has failed");
    }
    else //parent
    {
        //second fork for child 2
        pid_t pID2 = fork();
        if (pID2 == 0)
        {
            execl("child2.o","child2", 20, NULL);
        }
        else if (pID2 < 0)
        {
            printf("fork() has failed");
        }
        else
        {
            waitpid(0);
        }
        waitpid(0);
    }
}

//factorial calculation
int rfact(int n)
{
    if (n<=0)
    {
        return 1;
    }
    return n * rfact(n-1);
} 
```

这是child2.c：

```
#include <stdio.h>

void main()
{
    printf("I'm child 2!");
} 
```

好吧，所以，我遇到了eclipse的问题。我删除了它并重新编译了两个 .c 文件。我用execl指向child2.o，但它仍然没有做任何事情

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T00:24:52.560

您不能执行 .c 源文件！您需要编译它并执行生成的二进制文件。

使用脚本语言，您通常可以在开头添加*#!/usr/bin/whatever*行，它们将使用该解释器执行，但 C 需要编译，无法解释。

# ruby - Ruby 中字符串的自定义 to_html 方法

> ID：15079123
> 
> 赞同：1
> 
> 时间：2013-02-26T00:20:42.697
> 
> 标签：ruby, string, parsing

我有这样的字符串：#_ 大家好 _# 我需要创建这样的输出：

```
<strong>Hi All</strong> 
```

我一直在用谷歌搜索 Ruby 中的解析器，但我找不到一些小而简单的东西来学习如何做这种事情。

任何人都可以帮助我提供文档或想法来做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T01:33:09.803

小而简单：

```
text = "#_ Hi all _#"

html = text.gsub(/#_ /,'<strong>').gsub(/ _#/,'</strong>') 
```

稍微高级一点：

```
tags = {
  '#_ ' => '<strong>', ' _#' => '</strong>',
  '#q ' => '<blockquote>', ' q#' => '</blockquote>'
}

html = text.gsub(/(#_ | _#|#q | q#)/){ tags[$1] } 
```

如果您愿意，一些关于更高级功能的想法：

*   启用标签转义，例如`\#_`表示“按原样显示此标签”

*   确保开始标签有相应的停止标签，例如“#_ ... _#”

*   启用嵌套，例如“#_ ... #_ ... _# ... _#

*   从标签哈希动态生成 gsub 正则表达式。

*   等等

你见过 Maruku Ruby Markdown 解析器吗？我喜欢它的代码库，它有很多评论可以指导你：[https ://github.com/bhollis/maruku](https://github.com/bhollis/maruku)

# c# - 从 C# 应用程序访问 mysql 远程服务器

> ID：15079128
> 
> 赞同：0
> 
> 时间：2013-02-26T00:21:41.820
> 
> 标签：c#, mysql

我已经完成了一个小型 C# Win Forms 应用程序，它使用 mySQLconnector 连接到 mySQL 数据库。这适用于我的本地主机。

```
String ConnectionString = "server=xx.xxx.xx.xxx;uid=myuserid;pwd=mypassword;database=dbname"; 
```

但是当我尝试连接到远程服务器时确实出现以下错误：无法连接到任何指定的 MySQL 主机。{“无法建立连接，因为目标机器主动拒绝 xx.xxx.xx.xxx:3306”}

我已从命令提示符 ping 服务器并得到响应。我还验证了远程服务器数据库中的 mySQL 服务器设置（正确的名称/IP，端口号：3306，跳过网络：OFF）

从运行 php 脚本并使用与我上面列出的连接字符串相同的设置的 Web 服务器可以毫无问题地访问远程服务器。

mySQL 服务器托管在外部共享托管公司 123reg.co.uk 上，我使用与连接字符串中相同的 uid/passwd 登录到 phpmyadmin。我不明白 webserver 访问 OK 之间有什么不同，但是我的 C# 应用程序遇到了问题？

有没有人可以帮忙...

在此先感谢山姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T00:28:20.957

您的 IP 地址将与 Web 服务器不同。[如果您的 IP 地址是静态的，您可以在 mysql 数据库 ( https://www.google.com.au/search?q=mysql+grant+access+to+user+from+host](https://www.google.com.au/search?q=mysql+grant+access+to+user+from+host) )中授予对您 IP 地址的访问权限。我建议使用服务器访问数据库并使用 ajax/json 调用让您的 c# 应用程序与您的网络服务器通信（[https://www.google.com.au/search?q=C%23+Win+Forms+ ajax+json](https://www.google.com.au/search?q=C%23+Win+Forms+ajax+json) ) - 这样你就不会被绑定到一个 IP 地址来访问。或者，如果远程 shell 访问可用，您可以查看设置到您的网络服务器的 ssh 隧道，以便您可以获得与您的网络服务器相同的访问权限。（[https://www.google.com.au/search?q=ssh+tunnels+example+mysql](https://www.google.com.au/search?q=ssh+tunnels+example+mysql)这就是我自己做的）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T00:28:57.483

我在服务器设置方面遇到了问题，所以他们不会接受远程连接。这主要是出于安全原因。有些地方会让你在 CP 中启用它，但如果你可以直接访问服务器，你应该可以按照这些步骤操作。

[http://www.rackspace.com/knowledge_center/article/mysql-connect-to-your-database-remotely](http://www.rackspace.com/knowledge_center/article/mysql-connect-to-your-database-remotely)

# python - 如何使用 Python 3.3 在 Windows 中不断更新我的 MouseSpeed？

> ID：15079132
> 
> 赞同：1
> 
> 时间：2013-02-26T00:21:58.350
> 
> 标签：python, registry, ctypes, pywin32

我正在开发一个 python 脚本来驱动我正在开发的原型，而我目前的绊脚石是试图不断地写入 Windows 中的 MouseSensitivity 寄存器。为了具体起见，我使用的是 Windows 7。

不幸的是，我遇到了一些死胡同。

我尝试使用 pywin32 写入注册表，但没有成功。经过一番搜索，我遇到了 SystemParametersInfo 函数，但也没有任何成功。

本质上，为了解决这个危机，我已经安装了 pyserial、pywin32 和 ctypes（看来可能不需要 pywin32）。假设我有一个介于（包括）1 到 20 之间的整数变量。

下面列出了我现在拥有的代码。大部分内容已从[此处](http://pydoc.net/Python/jaraco.windows/2.2.1/jaraco.windows.xmouse/)修改，因为作者似乎使用了 python、ctypes、user32.dll 和 SystemParametersInfo 函数。但是，当我运行下面的代码时，shell 进入一个循环，其中下一行有两个空格，光标一直闪烁，直到我键盘中断。有任何想法吗？

```
import sys
import ctypes
import ctypes.wintypes

num = 12 # Between 1 and 20

SystemParametersInfo = ctypes.windll.user32.SystemParametersInfoW

SystemParametersInfo.argtypes = (
    ctypes.wintypes.UINT,
    ctypes.wintypes.UINT,
    ctypes.c_void_p,
    ctypes.wintypes.UINT,
    )

SPI_SETMOUSESPEED = 0x0071

SystemParametersInfo(SPI_SETMOUSESPEED, 0, ctypes.cast(num, ctypes.c_void_p, 0) 
```

# math - Simple Formula for float algorithm

> ID：15079136
> 
> 赞同：-2
> 
> 时间：2013-02-26T00:22:05.863
> 
> 标签：math, modulo

I need to set an alpha value, which is derived of a float value.

I list the pairs of float:alpha below, and I hope you guys can give me a simple correlation:

```
Float:Alpha
0:0
6:0.5
12:1
18:0.5
24:0 
```

The maximum float value is 24, alpha can't be more than 1. Inbetween values should be something parabolic/sine-like, with high resolution.

I suspect that this all involves a modulo. Please help me!

It would be helpful if you could express the formula in Objective-C syntax.

Thanks

Edit: to make myself clear: The left column is the input value, the right column is the output value.

Paraphrasing David:

"Hi, here is my input: 0, 6, 12, 18,24 and here is my output: 0, 0.5, 1, 0.5, 0\. I need to generalize a solution. Halp."

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T00:31:36.553

If you want a sine-wave the formula you're looking for is:

```
-(cos(n * pi / 12) - 1) / 2 
```

Where n is the value from 0 to 24.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T00:47:17.170

The formula I would use is:

```
CGFloat alpha = sin(radius / 24.0 * M_PI); 
```

This gives 0 for 0 and 24, 1 for 12, and a proper sine wave for values in between.

Please note that 0.5 for 6 and 18 are not valid values for a proper sine wave. 0.707 is proper for a sine wave for 6 and 18.

# sql - 显示包含建筑物质心的地块的空间 SQL 查询

> ID：15079142
> 
> 赞同：3
> 
> 时间：2013-02-26T00:22:51.230
> 
> 标签：sql, spatial-query, parcel, oracle-spatial, centroid

我正在尝试编写一个查询来选择*包含*某个建筑代码（bldg_code = 3）的质心的地块。

宗地列在“city.zoning”表中，并包含一个用于每个宗地的 PIN、几何和面积的列。表“buildings”包含 bldg_type 和 bldg_code 列，指示建筑物类型及其对应的代码。此查询感兴趣的建筑物类型的 bldg_code 为 3。

到目前为止，我已经开发了一个查询来显示与感兴趣的建筑物类型*交互的地块：*

```
select a.*
from city.zoning a, username.buildings b
where b.bldg_code = 3 and sdo_anyinteract(a.geom,b.geom) = 'TRUE'; 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T09:18:36.957

您可以使用`SDO_GEOM.SDO_CENTROID`（[文档](http://docs.oracle.com/cd/B19306_01/appdev.102/b14255/sdo_objgeom.htm#i860848)）找到几何的质心。

请注意，此函数提供的质心只是数学质心，可能并不总是位于几何图形*内*，例如，如果您的多边形是 L 形的。SpatialDB Adviser 对此有[一篇很好的文章](http://www.spatialdbadvisor.com/oracle_spatial_tips_tricks/71/oracle-spatial-centroid-shootout)，但这里有一个简单的说明：

![位于其父几何体之外的质心](../Images/318343b2fffec49d45be4e0c45bbb2de.png)

如果这对您来说不是问题并且您不需要那种级别的准确性，只需使用内置的，但如果您确实认为这是一个问题（就像我过去所做的那样），那么 SpatialDB Adviser 有[一个独立的 PL/SQL 包，可以正确计算 centroids](http://www.spatialdbadvisor.com/oracle_spatial_tips_tricks/228/standalone-centroid-package-now-available-for-download)。

根据您的性能需求，您可以即时计算质心并直接在查询中使用它们，或者，将质心列添加到表中并使用应用程序代码（最佳情况）或触发器计算和缓存值（最差的情况）。

您的查询将如下所示：

```
SELECT a.*
FROM city.zoning a
JOIN username.buildings b ON sdo_contains(a.geom, b.centroid) = 'TRUE'
WHERE b.bldg_code = 3 
```

请注意，这是`SDO_CONTAINS`基于`a.geom`被空间索引的列和`b.centroid`已添加和填充的新列（注意 - 未测试查询）。如果分区几何没有空间索引，那么您需要使用`SDO_GEOM.RELATE`或索引质心列并反转要使用的逻辑`SDO_INSIDE`。

# java - 如果没有任何实例变量，我将如何为我的类编写构造函数？

> ID：15079156
> 
> 赞同：1
> 
> 时间：2013-02-26T00:24:54.120
> 
> 标签：java

我想编写一个不接受任何参数的构造函数，那么如果我没有实例变量，我将如何做到这一点，我习惯于在我有实例变量的情况下创建一个构造函数，我知道如果我没有，java会创建一个默认构造函数但有人告诉我这是一种糟糕的编程习惯？？？（课程新手）

```
public class Validator {
    public Validator() {
    }

    public String getString(Scanner sc, String prompt) {
        System.out.print(prompt);
        String s = sc.next(); // read user entry
        sc.nextLine(); // discard any other data entered on the line
        return s;
    }

    public int getInt(Scanner sc, String prompt) {
        int i = 0;
        boolean isValid = false;
        while (isValid == false) {
            System.out.print(prompt);
            if (sc.hasNextInt()) {
                i = sc.nextInt();
                isValid = true;
            } else {
                System.out.println("Error! Invalid integer value. Try again.");
            }
            sc.nextLine(); // discard any other data entered on the line
        }
        return i;
    }

    public int getInt(Scanner sc, String prompt, int min, int max) {
        int i = 0;
        boolean isValid = false;
        while (isValid == false) {
            i = getInt(sc, prompt);
            if (i <= min)
                System.out.println("Error! Number must be greater than " + min
                        + ".");
            else if (i >= max)
                System.out.println("Error! Number must be less than " + max
                        + ".");
            else
                isValid = true;
        }
        return i;
    }

    public double getDouble(Scanner sc, String prompt) {
        double d = 0;
        boolean isValid = false;
        while (isValid == false) {
            System.out.print(prompt);
            if (sc.hasNextDouble()) {
                d = sc.nextDouble();
                isValid = true;
            } else {
                System.out.println("Error! Invalid decimal value. Try again.");
            }
            sc.nextLine(); // discard any other data entered on the line
        }
        return d;
    }

    public double getDouble(Scanner sc, String prompt, double min, double max) {
        double d = 0;
        boolean isValid = false;
        while (isValid == false) {
            d = getDouble(sc, prompt);
            if (d <= min)
                System.out.println("Error! Number must be greater than " + min
                        + ".");
            else if (d >= max)
                System.out.println("Error! Number must be less than " + max
                        + ".");
            else
                isValid = true;
        }
        return d;
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-26T00:27:48.793

构造函数用于“构建”一个对象。如果您没有需要设置的值，则不需要构造函数。您可能还想考虑使您的类成为[静态](http://dadicy.wordpress.com/2007/10/29/what-do-you-mean-by-static-in-java/)的。静态意味着您不需要创建它的实例来访问它的方法。当类的实例不包含特定值时，这通常很有用，就像你的一样！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-26T00:26:18.937

如果没有实例变量并且没有其他必需的任务来初始化您的类的对象，您可以省略构造函数。Java 编译器将为您提供一个默认编译器。通常，当我确切知道我需要它做什么时，我才包含一个显式构造函数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-26T00:27:22.100

您不必显式定义构造函数。已经有一个默认构造函数。使用该构造函数根本不是一个糟糕的编程习惯。

# java - java中具有不可变类的单例

> ID：15079161
> 
> 赞同：3
> 
> 时间：2013-02-26T00:25:16.480
> 
> 标签：java, concurrency

```
class MyClass
{
  private static volatile Resource resource;

  public static Resource getInstance()
  {
            if(resource == null)
                      resource = new Resource();
            return resource;
  }
} 
```

这里如果Resource是一个不可变的类，那么写上面的代码安全吗？正如在实践中的 java 并发中提到的那样，“初始化安全允许正确构造的不可变对象在线程之间安全地共享。所以上面的代码可以安全地编写。” （在第 349 16.3 页）。但是有了这个，如果两个线程检查空值并且它们可以继续创建对象，这是可能的，这违反了类的不变量（单例）。请解释。[链接](https://stackoverflow.com/questions/15077910/singleton-with-volatile-in-java)中问题的延续

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-26T00:32:16.990

不，这不是线程安全代码。在这种情况下，`Resource`可能是线程安全的，但您的`getInstance`方法不是。

想象一下这一系列事件

```
Thread1 calls getInstance and checks "if resource == null" and then stops (because the OS said it was time for it to be done) before initializing the resources.

Thread2 calls getInstance and checks "if resource == null" and then initializes the instance

Now Thread1 starts again and it also initializes the instance. 
```

它现在已经被初始化了两次并且不是一个单例。

您有几个选项可以使其线程安全。

1.  使`getInstance`方法同步

2.  在声明时（或在静态初始化器中）初始化实例，并且`getInstance`可以返回它。

您也不需要使变量易变。在情况 #1 中，同步方法无论如何都会刷新变量，因此所有变量都会看到更新的副本。在情况 #2 中，保证对象在构造后对所有对象可见。

# firebase - 如何使用 Firebase 在特定群组内安全地共享状态数据？

> ID：15079163
> 
> 赞同：11
> 
> 时间：2013-02-26T00:25:26.790
> 
> 标签：firebase, firebase-security

在我的应用程序中，我有许多不同的用户组，例如聊天室和特定项目。

如何允许这些组中的用户共享他们的存在数据，并查看组中每个其他用户的存在，但保持该数据对外界不公开？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-26T00:25:26.790

首先，您需要使用一种受支持的 Firebase 身份验证机制开始对您的用户进行身份验证。有关 Firebase 身份验证的更多信息，请访问[https://www.firebase.com/docs/security/authentication.html](https://www.firebase.com/docs/security/authentication.html)。

一旦您开始对用户进行身份验证，您的用户的安全、经过验证的用户数据将通过`auth`变量在您的安全规则中提供给您。假设您有经过身份验证的用户，并且每个用户都有一个唯一的 id，可以通过`auth.uid`.

对于共享组存在，我建议使用以下结构存储您的数据：

`/groups/<group-id>/users/<user-id>/<presence-status>`

使用这种结构，您可以编写安全规则，使呈现数据全局私有，而用户只能查看他们被允许访问的组中每个用户的呈现状态，并且只能编辑他们自己用户的状态。下面是一个实施这些限制的示例安全规则集：

```
{
  "groups": {
    "$groupid": {
      // Users can view the presence state of users in this group if they
      // are authenticated and listed in the group themselves.
      ".read": "auth != null && data.child('users').hasChild(auth.uid)"
      "users": {
        "$userid": {
          // Users can update only their individual account data.
          ".write": "auth != null && $userid == auth.uid && newData.val() != null"
        }
      }
    }
  }
} 
```

在上面的示例中，只有用户`/groups/<group-id>/users/`有权查看组的状态数据，并且每个用户只能修改其个人数据。用户只能读取/写入其个人用户节点。

为了进一步扩展这一点，假设您有一类特殊的用户，它们是唯一允许创建组的用户。您可以在生成身份验证令牌时包含用户的权限级别（对于下面的示例，我们将设置`isAdmin=true`），并使用更新的安全规则授予该特殊级别的访问权限。例如，如果只允许某些用户创建组，您可以更新 $groupid 下的 .write 规则，如下所示：

```
"$groupid": {
  // Only admins can create new groups.
  ".write": "auth != null && auth.isAdmin === true"
  //...
} 
```

# php - php mysql insert在包含特定文本时不起作用

> ID：15079165
> 
> 赞同：-1
> 
> 时间：2013-02-26T00:25:33.343
> 
> 标签：php, mysql

我有一个如下所示的文本文件：

```
<http://dbpedia.org/resource/Autism> <http://www.w3.org/2000/01/rdf-schema#comment> "Autism is a disorder of neural development characterized by impaired social interaction and communication, and by restricted and repetitive behavior. The diagnostic criteria require that symptoms become apparent before a child is three years old. Autism affects information processing in the brain by altering how nerve cells and their synapses connect and organize; how this occurs is not well understood."@en .
<http://dbpedia.org/resource/Anarchism> <http://www.w3.org/2000/01/rdf-schema#comment> "Anarchism is generally defined as the political philosophy which holds the state to be undesirable, unnecessary, and harmful, or alternatively as opposing authority and hierarchical organization in the conduct of human relations. Proponents of anarchism, known as \"anarchists\", advocate stateless societies based on non-hierarchical voluntary associations. There are many types and traditions of anarchism, not all of which are mutually exclusive."@en .
<http://dbpedia.org/resource/Achilles> <http://www.w3.org/2000/01/rdf-schema#comment> "In Greek mythology, Achilles was a Greek hero of the Trojan War, the central character and the greatest warrior of Homer's Iliad. Plato named Achilles the most handsome of the heroes assembled against Troy. Later legends (beginning with a poem by Statius in the 1st century AD) state that Achilles was invulnerable in all of his body except for his heel. As he died because of a small wound on his heel, the term Achilles' heel has come to mean a person's principal weakness."@en . 
```

我正在使用代码（此处不相关）来提取每行第一个 url 中的文章名称。然后我提取引号之间描述的第一句。问题是当我尝试将第一个句子字符串插入到我的表中时，插入失败（回显工作正常）。只需插入没有描述的标题就可以了。有谁知道为什么描述会导致插入失败？

这是我用来获取第一句话的代码：

```
 $data = fgets($handle); //get line

 $data = str_replace("> ", "-!-", $data);

 dataArr = explode("-!-", $data);

 //Get last part of uri from 1st element in array
  $title = getLastPartOfUrl($dataArr[0]);   
  $desc=preg_replace('/(.*?[?!.](?=\s|$)).*/', '\\1', escape(substr($dataArr[2],1)));

  $db->query("insert into mytable SET title = '".$title."', desc ='".$desc."'");

  function escape($str)
    {
            $search=array("\\","\0","\n","\r","\x1a","'",'"');
            $replace=array("\\\\","\\0","\\n","\\r","\Z","\'",'\"');
            return str_replace($search,$replace,$str);
    } 
```

编辑：我尝试了 urlencode 和 addlashes 都无济于事，在这两种情况下，包括 $desc 字符串都会使插入失败。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T00:27:45.647

你逃不掉的`title`。

我也不相信你的`escape`功能。我不确定是什么`$db`，但你应该使用正确的参数化查询和 PDO/mysqli

编辑：`DESC`是 MySQL 中的保留字。您需要在查询中用反引号将其括起来（用作列名时）。

# javascript - 不安全的 JavaScript 尝试使用 Facebook 插件在 Chrome 中访问

> ID：15079166
> 
> 赞同：1
> 
> 时间：2013-02-26T00:25:46.573
> 
> 标签：javascript, google-chrome, facebook-graph-api

使用一些 Facebook 插件（包括 LIKE 按钮和 LIKE Box）时，我在 Chrome 中遇到错误。这是我得到的错误：

```
Unsafe JavaScript attempt to access frame with URL http://samplewebsite.com/ from frame with URL http://static.ak.facebook.com/connect/xd_arbiter.php?version=18#channel=f3c….com&channel_path=%2Fchannel.html%3Ffb_xd_fragment%23xd_sig%3Df105c9419%26\. The frame requesting access set 'document.domain' to 'facebook.com', but the frame being accessed did not. Both must set 'document.domain' to the same value to allow access. 
```

*我将站点域替换为其他域

我尝试了不同的按钮变体，包括 XFBML、iframe、HTML5，但似乎没有什么能解决这个问题。我还使用了一个 channel.html 文件。

我的 Javascript 代码初始化：

```
<script type="text/javascript">
  window.fbAsyncInit = function () {
    FB.init({
      appId: 'some_app_id',
      status: true,
      cookie: true,
      channelUrl: '//samplewebsite.com/channel.html',
      xfbml: true
    });
  };
  (function (d) {
    var e = document.createElement('script');
    e.async = true;
    e.src = document.location.protocol + '//connect.facebook.net/en_US/all.js';
    document.getElementById('fb-root').appendChild(e);
  }());
</script> 
```

fb-root div 位于脚本正上方的页面上。

我的文档类型适用于 HTML5：

```
<!DOCTYPE html>

<html
lang="en"
prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"
xmlns="http://www.w3.org/1999/xhtml"> 
```

我也尝试使用不带前缀的常规属性，但仍然得到相同的错误。

有没有解决方案。我可以提供任何需要的信息。谢谢！

# vba - 是否可以在尚不存在的工作表上命名一个范围？

> ID：15079169
> 
> 赞同：0
> 
> 时间：2013-02-26T00:26:02.090
> 
> 标签：vba, excel

我正在尝试为工作簿中尚不存在的工作表创建命名范围。我将使用宏来导入用户定义的文本文件作为源。

导入工作表后，我是否仅限于定义这些命名范围，还是可以在尚不存在的工作表上命名未来范围？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T01:14:26.973

我假设将在导入数据时创建名称。我还假设在导入数据之前您的未命名范围返回错误是可以的。您可以使用`IFERR`或`IFERROR`函数来管理它。

在新工作表的单元格中输入以下内容：

```
=notyetnamed 
```

然后选择另一个单元格，输入任何旧值，并将其命名为`notyetnamed`。

我希望这回答了你的问题。如果没有，欢迎您澄清，我会尽力提供帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T03:44:02.723

在 指：

```
=INDIRECT("NotYetASheet!$A$1") 
```

# python - Python：当多个子节点引用回父节点时，如何在递归循环中找到多个路径？

> ID：15079170
> 
> 赞同：2
> 
> 时间：2013-02-26T00:26:03.243
> 
> 标签：python, recursion

我正在使用递归来查找从某个点 A 到某个点 D 的路径。我正在遍历一个图来查找路径。

让我们说：

图 = {'A':['route1','route2'],'B':['route1','route2','route3','route4'],'C':['route3','route4 '], 'D':['route4'] }

可通过以下方式访问：

A -> 路线 1，路线 2

B -> 路线 2、路线 3、路线 4

C -> 路线 3，路线 4

从 A -> D 的这条路径有两种解决方案：

路线1->路线2->路线4

路线1 -> 路线2 -> 路线3 -> 路线4

由于 B 点和 A 点都有路线 1 和路线 2。有一个无限循环，所以每当我访问节点（0 或 1 个值）时，我都会添加一个检查。

但是通过检查，我只得到一个解决方案：route1 -> route2 -> route4，而不是其他可能的解决方案。

这是实际的编码：路由将被反应取代。

```
def find_all_paths(graph,start, end, addReaction, passed = {}, reaction = [] ,path=[]):

    passOver =  passed 

    path = path + [start]   
    reaction = reaction + [addReaction]
    if start == end:
        return [reaction] 
    if not graph.has_key(start):
        return []

    paths=[]
    reactions=[]

    for x in range (len(graph[start])):    
        for y in range (len(graph)):
            for z in range (len(graph.values()[y])):
                if (graph[start][x] == graph.values()[y][z]): 
                    if passOver.values()[y][z] < 161 :
                        passOver.values()[y][z] = passOver.values()[y][z] + 1
                            if (graph.keys()[y] not in path):
                                newpaths = find_all_paths(graph, (graph.keys()[y]), end, graph.values()[y][z], passOver , reaction, path)
                            for newpath in newpaths:
                                reactions.append(newpath)
    return reactions 
```

这是方法调用： dic_passOver 是一个字典，用于跟踪节点是否被访问

```
solution = (find_all_paths( graph, "M_glc_DASH_D_c', 'M_pyr_c', 'begin', dic_passOver )) 
```

我的问题似乎是，一旦访问了一条路线，就无法再访问了，所以其他可能的解决方案是不可能的。我通过在 161 处添加最大递归量来解决此问题，在该处为我的特定代码找到所有可能的路线。

```
if passOver.values()[y][z] < 161 :
                        passOver.values()[y][z] = passOver.values()[y][z] + 1 
```

但是，这似乎效率很低，而且我的大部分数据都是带有数千个索引的图表。此外，我不知道允许的节点访问量以找到所有路线。数字 161 是手动计算出来的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T00:58:29.163

好吧，我无法理解您对图表的表示。但这是一种通用算法，可用于查找所有避免无限循环的路径。

首先，您需要将您的图形表示为一个字典，它将节点映射到它们所连接的一组节点。例子：

```
graph = {'A':{'B','C'}, 'B':{'D'}, 'C':{'D'}} 
```

这意味着 from`A`你可以去`B`and `C`。从`B`你可以去`D`，从`C`你可以去`D`。我们假设链接是单向的。如果您希望它们是双向的，只需添加双向链接。

如果您以这种方式表示您的图表，您可以使用以下函数查找所有路径：

```
def find_all_paths(start, end, graph, visited=None):
    if visited is None:
        visited = set()

    visited |= {start}
    for node in graph[start]:
        if node in visited:
            continue
        if node == end:
            yield [start,end]
        else:
            for path in find_all_paths(node, end, graph, visited):
                yield [start] + path 
```

示例用法：

```
>>> graph = {'A':{'B','C'}, 'B':{'D'}, 'C':{'D'}}
>>> for path in find_all_paths('A','D', graph):
...   print path
... 
['A', 'C', 'D']
['A', 'B', 'D']
>>> 
```

**编辑以考虑澄清图形表示的注释**

下面是将您的图形表示（假设我理解正确并且路由是双向的）转换为上述算法中使用的函数

```
def change_graph_representation(graph):
    reverse_graph = {}
    for node, links in graph.items():
        for link in links:
            if link not in reverse_graph:
                reverse_graph[link] = set()
            reverse_graph[link].add(node)

    result = {}
    for node,links in graph.items():
        adj = set()
        for link in links:
            adj |= reverse_graph[link]
        adj -= {node}
        result[node] = adj
    return result 
```

如果根据链接而不是遍历的节点找到路径很重要，则可以像这样保留此信息：

```
def change_graph_representation(graph):
    reverse_graph = {}
    for node, links in graph.items():
        for link in links:
            if link not in reverse_graph:
                reverse_graph[link] = set()
            reverse_graph[link].add(node)

    result = {}
    for node,links in graph.items():
        adj = {}
        for link in links:
            for n in reverse_graph[link]:
                adj[n] = link
        del(adj[node])
        result[node] = adj
    return result 
```

并使用此修改后的搜索：

```
def find_all_paths(start, end, graph, visited=None):
    if visited is None:
        visited = set()

    visited |= {start}
    for node,link in graph[start].items():
        if node in visited:
            continue
        if node == end:
            yield [link]
        else:
            for path in find_all_paths(node, end, graph, visited):
                yield [link] + path 
```

这将为您提供要遵循的链接而不是要遍历的节点的路径。希望这可以帮助 ：）

# python - django 模型对象实例是否应该传递给 celery？

> ID：15079176
> 
> 赞同：25
> 
> 时间：2013-02-26T00:26:30.170
> 
> 标签：python, django, celery

```
# models.py
from django.db import models

class Person(models.Model):
    first_name = models.CharField(max_length=30)
    last_name = models.CharField(max_length=30)
    text_blob = models.CharField(max_length=50000)

# tasks.py
import celery
@celery.task
def my_task(person):
    # example operation: does something to person 
    # needs only a few of the attributes of person
    # and not the entire bulky record
    person.first_name = person.first_name.title()
    person.last_name = person.last_name.title()
    person.save() 
```

在我的应用程序中，我有类似的东西：

```
from models import Person
from tasks import my_task
import celery
g = celery.group([my_task.s(p) for p in Person.objects.all()])
g.apply_async() 
```

*   芹菜泡菜 p 发给工人吧？
*   如果工作人员在多台机器上运行，整个 person 对象（以及主要不需要的庞大的 text_blob）是否会通过网络传输？有没有办法避免它？
*   如何有效且均匀地将 Person 记录分配给在多台机器上运行的工作人员？

*   这可能是一个更好的主意吗？如果 Person 有几百万条记录，它不会压倒数据库吗？

    ```
    # tasks.py

    import celery
    from models import Person
    @celery.task
    def my_task(person_pk):
        # example operation that does not need text_blob
        person = Person.objects.get(pk=person_pk)
        person.first_name = person.first_name.title()
        person.last_name = person.last_name.title()
        person.save()

    #In my application somewhere
    from models import Person
    from tasks import my_task
    import celery
    g = celery.group([my_task.s(p.pk) for p in Person.objects.all()])
    g.apply_async() 
    ```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2014-05-24T16:28:16.913

我相信传递 PK 比传递整个模型对象更好、更安全。由于 PK 只是一个数字，因此序列化也简单得多。最重要的是，您可以使用更安全的 sarializer（json/yaml 而不是 pickle），并且可以放心，序列化模型不会有任何问题。

正如[这篇](http://www.turnkeylinux.org/blog/django-celery-rabbitmq)文章所说：

> 由于 Celery 是一个分布式系统，你无法知道任务将在哪个进程中运行，甚至在哪台机器上运行。因此，您不应该将 Django 模型对象作为参数传递给任务，从数据库中重新获取对象几乎总是更好，因为可能涉及竞争条件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T00:36:10.750

是的。如果数据库中有数百万条记录，那么这可能不是最好的方法，但是由于您必须遍历所有数百万条记录，那么无论您做什么，您的数据库都会受到相当大的打击难的。

这里有一些替代方案，我称之为“更好”，只是不同。

1.  为您的 Person 类实现一个 pre_save 信号处理程序，该处理程序执行 .title() 内容。这样，您的 first_name/last_names 将始终正确存储在数据库中，您不必再次执行此操作。
2.  使用带有某种分页参数的管理命令......也许使用姓氏的第一个字母来分割人员。因此，运行`./manage.py my_task a`将更新姓氏以“a”开头的所有记录。显然你必须运行几次才能通过整个数据库
3.  也许你可以用一些有创意的 sql 来做到这一点。我什至不打算在这里尝试，但它可能值得研究。

请记住，.save() 对数据库的“打击”将比实际选择数百万条记录更难。

# ios - NSMutableArray replaceObjectAtIndex:withObject 循环泄漏

> ID：15079177
> 
> 赞同：4
> 
> 时间：2013-02-26T00:26:40.100
> 
> 标签：ios, objective-c, memory

为了方便起见，我用一些工作代码编辑了上一篇文章。

以下代码（ARC'ed）似乎会泄漏，并且会在运行一小段时间后使 sim 卡或设备崩溃：

```
#define kROWS 100
#define kCols 34

void run();

static ViewController *instance;

@interface ViewController ()
@property (nonatomic, strong) NSMutableArray *nsBackColor;
@end

@implementation ViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    self.nsBackColor = [NSMutableArray arrayWithCapacity:1];
    instance = self;

    // set up a '2D array'
    for (int x = 0; x < kROWS; x++) {
        [self.nsBackColor addObject:[NSMutableArray arrayWithCapacity:1]];
        for (int y = 0; y < kCols; y++) {
            [[self.nsBackColor objectAtIndex:x] addObject:[UIColor whiteColor]];
        }
    }

    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
        run();
    });
}

- (void)plotColor:(UIColor *)color atX:(short)x andY:(short)y {
    [[self.nsBackColor objectAtIndex:x] replaceObjectAtIndex:y withObject:color];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

@end

void plot(short xLoc, short yLoc,
              short backRed, short backGreen, short backBlue) {

    @autoreleasepool {
        [instance plotColor:[UIColor colorWithRed:((float)backRed/100)
                                            green:((float)backGreen/100)
                                             blue:((float)backBlue/100)
                                            alpha:(float)1]
                        atX:xLoc andY:yLoc];
    }
}

void run() {
    short x = 0;
    short y = 0;
    short backRed = 0;
    short backGreen = 0;
    short backBlue = 0;

    while (true) {
        x++;
        if (x >= kROWS) {
            x = 0;
        }

        y++;
        if (y >= kCols) {
            y = 0;
        }

        backRed = arc4random() % 255;
        backBlue = arc4random() % 255;
        backGreen = arc4random() % 255;

        plot(x, y, backRed, backGreen, backBlue);

        usleep(1000);
    }
} 
```

如果我让它在设备或模拟器上运行足够长的时间（几分钟），我将收到 mmap malloc 错误（sim）或内存警告（设备）并崩溃。

通过 Instruments Allocations 我可以看到 +[UIColor colorWithRed:green:blue:alpha:] 开始膨胀，直到最终撞到内存墙。

我可以将 UIColor 分配给一个属性（直接或通过复制），比如 self.myColor = color，并且没有这样的泄漏。

我也可以这样做：

```
[[self.nsBackColor objectAtIndex:x] replaceObjectAtIndex:y withObject:[self description]]; 
```

我得到了同样的泄漏。

在我看来，在数组中替换的对象（是的，这最初是作为 2D c 数组开始的，但我认为这是问题所在）永远丢失并泄漏并且没有正确释放。

这将是运行一小段时间后的 Instruments->Allocations：

[![仪器](../Images/2bad9f7a0378cd13e01b05972492a324.png)](https://i.stack.imgur.com/RHjde.png)

任何帮助将不胜感激，并且可以提供更多信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T10:03:33.410

正在发生的事情是您在每次迭代时都创建了一个自动释放池。因此，每次都会使用新的自动释放池运行以下行：

```
[[self.nsBackColor objectAtIndex:x] replaceObjectAtIndex:y withObject:color]; 
```

因此`color`将其在本地池中的引用计数增加一，同时`[[self.nsBackColor objectAtIndex:x] objectAtIndex:y]`将其在本地池中的引用计数减少一。但这里有一个问题：该项目`color`在上一个迭代中，它的引用计数由您之前排空/释放的上一个池管理。

所以应该发生的是，在上一次迭代中释放了上一个池，该对象被释放了。它的引用计数为 2（一个用于`[UIColor colorWith...]`，一个用于添加到数组中），因此它应该在池耗尽后立即收到 2 个释放消息，并且指针 in`[[self.nsBackColor objectAtIndex:x] objectAtIndex:y]`应该悬空，直到您在当前迭代中将其替换为指向的指针`color`。

显然，这并没有完全按照它应该的方式发生，或者我理解的方式。但是，该`@autoreleasepool {}`指令显然是错误的。它应该在`while (true)`循环周围，或者完全删除以支持线程池。

# ruby-on-rails - 意外运行 $ gem update --system 后无法运行 rails server

> ID：15079182
> 
> 赞同：16
> 
> 时间：2013-02-26T00:27:20.857
> 
> 标签：ruby-on-rails, rubygems, rvm

我以为它会解决我遇到`gem update --system`的问题，但现在我无法运行`rails server`。它不会加载，相反，我不断收到以下内容。有人可以告诉我如何撤消此操作并恢复到运行更新之前的状态吗？

我已经跑了`git checkout`，但问题仍然存在......

```
/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.5/lib/bundler/rubygems_integration.rb:187:in `stub_source_index170': uninitialized constant Gem::SourceIndex (NameError)
from /usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.5/lib/bundler/rubygems_integration.rb:353:in `stub_rubygems'
from /usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.5/lib/bundler/rubygems_integration.rb:250:in `replace_entrypoints'
from /usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.5/lib/bundler/runtime.rb:14:in `setup'
from /usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.5/lib/bundler.rb:107:in `setup'
from /usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rubygems-bundler-1.0.7/lib/rubygems-bundler/noexec.rb:66:in `setup'
from /usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rubygems-bundler-1.0.7/lib/rubygems-bundler/noexec.rb:78:in `<top (required)>'
from /usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/core_ext/kernel_require.rb:110:in `require'
from /usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/core_ext/kernel_require.rb:110:in `rescue in require'
from /usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/core_ext/kernel_require.rb:35:in `require'
from /usr/local/rvm/gems/ruby-1.9.3-p194/bin/ruby_noexec_wrapper:9:in `<main>' 
```

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-03-06T13:49:46.353

我今天有同样的问题。将 bundler 更新到最新版本解决了这个问题：

```
gem update bundler 
```

如果你正在运行 rbenv

```
rbenv rehash 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-02-26T13:36:08.863

似乎最新版本的 Rubygems 有问题。

您只需使用以下命令恢复到旧版本，一切都应该正常：

```
gem update --system 1.8.24 
```

# python - Python，Numpy，多维数组相加的方法（广播）

> ID：15079186
> 
> 赞同：4
> 
> 时间：2013-02-26T00:27:37.940
> 
> 标签：python, numpy, array-broadcasting

我有许多具有共同索引的不同大小的数组。

例如，

```
Arr1 = np.arange(0, 1000, 1).reshape(100, 10)
Arr2 = np.arange(0, 500, 1).reshape(100,5)

Arr1.shape = (100, 10)
Arr2.shape = (100, 5) 
```

我想将它们一起添加到一个新的数组中，Arr3 是三维的。例如

```
Arr3 = Arr1 + Arr2
Arr3.shape = (100, 10, 5) 
```

请注意，在这种情况下，值应该对齐，例如

```
Arr3[10, 3, 2] =  Arr1[10, 3] + Arr2[10, 2] 
```

我一直在尝试使用以下方法

```
test = Arr1.copy()
test = test[:, np.newaxis] + Arr2 
```

现在，当将两个方阵相加时，我已经能够完成这项工作。

```
m = np.arange(0, 100, 1)
[x, y] = np.meshgrid(x, y)
x.shape = (100, 100)

test44 = x.copy()
test44 = test44[:, np.newaxis] + x
test44.shape = (100, 100, 100)
test44[4, 3, 2] = 4
x[4, 2] = 2
x[3, 2] = 2 
```

但是，在我的实际程序中，我不会有这个问题的方阵。此外，当您开始按如下方式向上移动维数时，此方法会占用大量内存。

```
test44 = test44[:, :, np.newaxis] + x
test44.shape = (100, 100, 100, 100)

# Note this next command will fail with a memory error on my computer.
test44 = test44[:, :, :, np.newaxis] + x 
```

所以我的问题有两个部分：

1.  是否可以从具有共同“共享”轴的两个不同形状的 2D 阵列创建 3D 阵列。
2.  这种方法可以在高阶维度上扩展吗？

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T00:31:34.447

是的，您正在尝试做的事情称为广播，如果输入具有正确的形状，它会由 numpy 自动完成。试试这个：

```
Arr1 = Arr1.reshape((100, 10, 1))
Arr2 = Arr2.reshape((100, 1, 5))
Arr3 = Arr1 + Arr2 
```

我发现[这](https://scipy.github.io/old-wiki/pages/EricsBroadcastingDoc)是对广播的非常好的介绍，它应该向您展示如何将这种行为扩展到 n 维。

# netsuite - NetSuite 上的自定义 Web 服务

> ID：15079189
> 
> 赞同：0
> 
> 时间：2013-02-26T00:27:50.737
> 
> 标签：netsuite

有没有办法上传自定义web服务到netsuite平台，添加自定义业务处理逻辑？查看 SuiteApp/SuiteBundles，它们提供的只是一种扩展现有记录/表单/列表、添加自定义脚本等的方法。还没有找到有关集成外部 Web 服务的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T19:19:19.467

您可以使用 Restlet 在特定的 Netsuite 帐户中创建自定义功能，然后可以从外部访问 restlet。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-30T13:49:26.343

如果您想要用 Java / .Net 编写 Web 服务的逻辑，那么您可以使用[SuiteTalk](http://www.netsuite.com/portal/platform/developer/suitetalk.shtml)与 NetSuite 进行通信。所有处理都在您的服务中完成，您使用 API 从 NetSuite 获取/设置数据。

但另一方面，您必须在自己的终端上托管此服务。NetSuite 只能托管以 RestLet / SuiteLet 形式编写的 Web 服务。

# javascript - 访问 2D javascript 数组

> ID：15079195
> 
> 赞同：0
> 
> 时间：2013-02-26T00:28:11.310
> 
> 标签：javascript

我正在尝试编写一段简单的 javascript 代码，它读取 CSV（粘贴到网页上的 textarea 中）并生成 SQL 插入语句，但是当我引用 2D 数组时，我不断得到未定义的值。

请帮忙！

```
var ret = "";
//alert("called");
//split the textarea into rows of text
var lines = text.split("\n");           
//the first line of text is the table name
var table = lines[0];                   

//the second line of text is an array of the attribute names
var attrnames = lines[1].split(",");        
var values = new Array();

//create a new array for each attribute
for (var i = 0; i < attrnames.length; i++) {
    //the length of each array is the total number of rows 
    //of text - 2 (title row and attr row)
    values.push(new Array(lines.length - 2));       
} 

//for each subsequent row, push the values to the appropriate arrays
for (var i = 2; i < lines.length; i++) {
    //get the current row (value, value, value, value)
    var thisrow = lines[i].split(",");          
    for (var j = 0; j < attrnames.length; j++) {
        //add the j-th attribute (thisrow[j]) to its array (values[j])
        values[j].push(thisrow[j]);             
    }   
}

var insertIntoTable = "";
var tableName = "";
var attrList = "";
var valueList = "";
var lead = "";

//loop through each row
for (var k = 2; k < lines.length; k++) {

    // --- ONE STATEMENT ---
    //create the statements
    insertIntoTable = "insert into table `";
    tableName = table;
    attrList = "` (";
    valueList = "(";
    for (var i = 0; i < attrnames.length; i++){
        attrList += "`" + attrnames[i] + "`,";
    }

    //trim the last comma, then add the closing parenthesis.
    attrList = attrList.substring(0, attrList.length-1) + ") ";
    lead = insertIntoTable + tableName + attrList;      

    for (var i = 0; i < attrnames.length; i++) {
        //this always points to undefined
        valueList += "'" + values[i][k-2] + "', "; 
    }   

    lead += (" values " + valueList);
    lead = lead.substring(0, lead.length-2) + ");\n";   

    ret += lead;

}

alert(ret); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T00:40:47.370

在 JavaScript 中，您不需要设置数组的长度。它们更像是 ArrayLists 什么的；[在MDN 的文档](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array)中阅读更多内容。

当你这样做

```
var x = new Array(10); // array with "length" set to 10
x.push("somevalue"); 
```

然后该值将插入`x[10]`到列表末尾的 - 处。将其登录到控制台以自己查看。

因此，要么放弃`push()`并使用绝对 indizes，要么将数组初始化为空 - 最好使用[数组文字语法](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Values,_variables,_and_literals#Array_literals): `[]`。您的代码的相关区域应如下所示：

```
//create a new empty array for each attribute
for(var i = 0; i<attrnames.length; i++){
    values.push([]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T00:41:36.967

您正在制作一个长度数组`n`，其中`n`是行数，**然后**您将推送`n`更多数据元素。从 0 长度数组开始，你会没事的：

```
//create a new array for each attribute
for(var i = 0; i<attrnames.length; i++){
    values.push(new Array(0));   // or '[]' -> the length of each array **will be** the total number of rows of text-2 (title row and attr row)
} 
```

我要注意的是，粘贴的数据容易出现大量错误和潜在的安全问题，例如 SQL 注入攻击。除此之外，如果`\n`数据末尾有多余的 s 会怎样？您最终会得到更多未定义的数据。

# c# - 轨道碰撞角

> ID：15079196
> 
> 赞同：0
> 
> 时间：2013-02-26T00:28:15.070
> 
> 标签：c#, unity3d, game-physics

我正在开发一款游戏，我目前有物体以固定距离连续围绕球体运行。我需要让物体相互反弹。有谁知道我该怎么做？

我有碰撞检测工作，每个对象都有一个边界球。我能够获得碰撞点，我只需要从每个对象中获取当前的旋转向量并获得由此产生的“反弹”角度（要旋转的向量）并让每个对象继续围绕它的新向量运行。

让我知道这是否没有意义或您是否需要其他任何东西！我应该提到这是使用 Unity3D 完成的（出于性能原因，我没有使用刚体或内置物理引擎）

**编辑：**

这是我尝试过的：

```
public void OnTriggerEnter(Collider collider)
{
    // Determine resultant rotation axis
    Vector3 collisionNormal = collider.ClosestPointOnBounds(thisTransform.position);
    rotationAxis = Vector3.Reflect(rotationAxis, collisionNormal);
} 
```

这是 Unity3D 文档中 Vector3.Reflect() 方法的链接：[Vector3.Reflect()](http://docs.unity3d.com/Documentation/ScriptReference/Vector3.Reflect.html)

在这一点上，物体不会开始向新的方向移动，它们会发生碰撞，然后不会反弹。当碰撞发生时，它们似乎停止了。

# c# - 无法获取相关的父实体对象并将其添加到 ObjectContext

> ID：15079206
> 
> 赞同：0
> 
> 时间：2013-02-26T00:29:29.503
> 
> 标签：c#, entity-framework-4, parent-child, observablecollection, savechanges

在成功添加其相关子项后，我目前难以跟踪父实体对象并将其添加到我的上下文中。

我有两个 SQL 表映射到通过外键关联的实体：

```
 MasterPartNumber (parent, one) --> MasterPartsList (children, many)
  (PK) pn <--short for PartNumber     (PK) listID
       pnDesc                         (FK) pn
       docNum                              parentAssyPN <-- if null, means it is the "top level assembly"
                                           findNum
                                           qty
                                           isAssy 
```

在我的视图的左侧，我有一个 ListBox，它显示了`ObservableCollection`所有*程序集*或*父*实体对象中的一个。看起来像：

```
 public ObservableCollection<MasterPartNumber> AssyPns
    {
        get
        {
                var enumerable = this._context.MasterPartNumbers.Where(x => x.isAssy == true);

                return this._assyPns = new ObservableCollection<MasterPartNumber>(enumerable);
        }
        set 
        {
            this._assyPns = value;
            RaisePropertyChanged("AssyPns");  
        }
    } 
```

选定的父组件由 viewmodel 属性定义：

```
 public MasterPartNumber SelectedTopLevelAssyPN 
 {
      get { return this._selectedTopLevelAssyPN; }
      set
      {
          this._selectedTopLevelAssyPN = value;
          RaisePropertyChanged("SelectedTopLevelAssyPN");
          RaisePropertyChanged("SelectedAssyBOMLineItems");
      }
  } 
```

当用户单击其中一个选定的父程序集 ( `SelectedTopLevelAssyPN`) 时，DataGrid 将显示绑定到其父（由属性给出）为 的`ObservableCollection`所有子实体的绑定。`parentAssyPN``SelectedTopLevelAssyPN`

```
 public ObservableCollection<MasterPartsList> SelectedAssyBOMLineItems
    {
        get
        {
            if (this._selectedTopLevelAssyPN != null)
            {
                var children = _context.MasterPartsLists.Where(lineItem => lineItem.parentAssyPN == this._selectedTopLevelAssyPN.pn);
                return this._selectedAssyBOMLineItems = new ObservableCollection<MasterPartsList>(children);

            }
            return this._selectedAssyBOMLineItems;
        }
        set
        {
            this._selectedAssyBOMLineItems = value;
            RaisePropertyChanged("SelectedAssyBOMLineItems");
        }
    } 
```

请注意我如何能够通过集合属性导航到包含外键的实体（这是我的 xaml）：

```
 <DataGrid x:Name="lineItemDataEntryGrid" Grid.Row="0"
                  Margin="15,15,15,0"
                  AutoGenerateColumns="False"
                  EnableRowVirtualization="True"
                  Width="Auto"
                  ItemsSource="{Binding SelectedAssyBOMLineItems, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                  >
            <DataGrid.Columns>
                <DataGridTextColumn x:Name="qtyReadColumn" 
                                    Binding="{Binding qty, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                    Width="SizeToHeader"
                                    Header="QTY REQ'D"/>
                <DataGridTextColumn x:Name="partOrIDNumColumn" 
                                    Binding="{Binding pn, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                    Width="SizeToHeader"
                                    Header="PART OR IDENTIFYING NUMBER"/>

                <DataGridTextColumn x:Name="partNumDescColumn" 
                                    Binding="{Binding MasterPartNumber.pnDesc, Mode= TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                    Width="SizeToHeader"
                                    Header="NOMENCALTURE OR DESCRIPTION"/>
                <DataGridTextColumn x:Name="docNumColumn" 
                                    Binding="{Binding MasterPartNumber.docNum, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                    Width="SizeToHeader"
                                    Header="INTERNAL DOCUMENTATION"/>
                <DataGridTemplateColumn x:Name="isAssyColumn" 
                                        Header="IS ASSEMBLY? "
                                        Width="30"
                                        >
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <CheckBox IsChecked="{Binding isAssy}" IsThreeState="False" />
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

            </DataGrid.Columns>

        </DataGrid> 
```

一切都正确显示。这意味着我有效地将父实体向下导航到子实体。

现在我的问题：我完全能够将新项目添加`MasterPartsList`到 中`context`，但不能添加`MasterPartNumber`对象。

我的 SaveCommand（中继命令）中的代码如下所示：

```
 private void SaveLineItems()
    {
        //update the parts list if any Object properties have been edited

        foreach (MasterPartsList item in this._selectedAssyBOMLineItems)
        {
            this._context.DetectChanges();
            this._context.MasterPartsLists.AddObject(item);
          //  this._context.MasterPartNumbers.AddObject(item.MasterPartNumber); //Doesn't work: pnMatch.MasterPartNumber is null & Throws NullReferenceException
            this._context.SaveChanges();
        }
    } 
```

看来这实际上会保存我的 MasterPartsList 数据，如果不是因为`MasterPartNumber.pn`不能为空的强制外键约束。

我已经坚持了好几天了。当我只使用一张表时，我很容易实现 .SaveChanges。有没有人能明白为什么我无法添加`item.MasterPartNumber`（或者甚至得到一个非空对象，就此而言？）

提前致谢。请让我知道我需要进一步澄清的地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T02:00:01.060

首先，我不建议将数据加载到那里的属性 getter 中。

其次，添加时不应该将实体引用例如`item.MasterPartNumber`自动添加到上下文中`item`吗？我确信这是 EF 的常见工作方式。

您还提到了强制外键约束……那部分不是很清楚。你能提供异常消息吗？另外，您使用的是什么版本/风格 - DbContext 或 ObjectContext？先码字？自我跟踪实体？问题是外键还是主键？主键是否在数据库和 EDMX 中自动递增并标记为这样？

作为一般建议，请确保您尝试了解实体框架在幕后所做的事情；否则你会在没有真正理解原因的情况下最终讨厌它（并不是没有充分的理由）。尝试可视化您在内存中的对象图以及 EF 如何尝试跟踪所有内容的连接方式；当您保存更改并尝试找出保存所有内容所需的顺序时，它会这样做，以免违反约束。啊，但我会停止写诗，而我仍然可以保持严肃的外表。

# debian - debhelper 已弃用选项 --until?

> ID：15079207
> 
> 赞同：1
> 
> 时间：2013-02-26T00:29:29.780
> 
> 标签：debian, packaging, buildbot

在构建机器人上构建包时，我目前有一个构建步骤

```
dpkg-buildpackage ... 
```

这很好用，但所有输出都集中在瀑布中的一个步骤中，这使得很难一眼看出故障是在配置期间、构建期间还是在打包期间。所以我想要一种更细粒度的构建方式。

碰巧我知道我想使用 dh 构建的所有包。这意味着我可以配置、构建、测试和打包构建步骤，每个构建步骤都运行以下命令之一：

```
dh build --until dh_auto_configure
dh build --until dh_auto_build
dh build --until dh_auto_test
dpkg-buildpackage -nc ... 
```

（我使用 dh 来调用这些，因此如果包使用任何内容，它就可以进行覆盖。我不希望 buildbot 必须知道相关包是否使用覆盖。）

到目前为止，一切都很好。问题是，dh 不希望我使用 --until 选项。它说

“dh：不推荐使用 --until 选项。改用覆盖目标。”

这让我很难过……听起来 dh 没有预料到这个用例。

所以，现在的问题：

这些事情应该在哪里讨论？

dh 是否真的以其他方式处理我的用例，而我只是错过了备忘录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T19:30:03.073

这可能不是一个伟大的工作`dh`。通常，它实际上只是为了从`debian/rules`makefile 中使用。`--until`即使它没有被弃用，这种方法可能对你来说也很成问题。

但是，您*可以*通过执行您自己的脚本中的所有步骤来拆分构建过程`dpkg-buildpackage`（手册页顶部的摘要应该告诉您所需的一切）。

但即便如此，也不一定能让您拆分流程的`configure`各个`build`部分。[不需要](http://www.debian.org/doc/debian-policy/ch-source.html#s-debianrules)`debian/rules`文件来分隔这些步骤或使用户可以轻松地执行此操作。许多人会，有些人不会。

我的建议是`dpkg-buildpackage`在每个阶段都尽可能多地去做，以避免在构建环境、依赖检查、树准备、fakeroot 调用或其他东西上弄乱一些微妙的东西。只需`-nc`在第一个阶段之后传递阶段，以避免清理树并重新开始。`dh`足够聪明，当阶段重叠（如`build*`和`binary*`）时，可以跳过您已经完成的部分。

您可以通过以下方式为大多数软件包获得正确的配置/构建分离：

```
set -e
# check build deps, clean tree, make source debs
dpkg-buildpackage -S -us -uc

if grep '^configure:' debian/rules; then
    debian/rules configure
elif grep '^override_dh_auto_configure:' debian/rules; then
    debian/rules override_dh_auto_configure
elif grep '^%:' debian/rules; then
    dh_auto_configure
else
    : # oh well, it'll get done during the build phase if necessary
fi

# prepare environment, perform build
dpkg-buildpackage -nc -T build

# install stuff into temp dir, tar it up, make the deb file
dpkg-buildpackage -nc -b -us -uc

# remake the changes file, if you care, since right now it only
# includes the binaries
dpkg-genchanges > ../$whatever.changes 
```

至少，这应该总是正确的包。

# git - 为什么“git log --name-only”显示一个文件更改，但“git diff”显示更多？

> ID：15079209
> 
> 赞同：2
> 
> 时间：2013-02-26T00:30:04.147
> 
> 标签：git, git-diff, git-log

当我跑

```
git log --name-only 
```

它将 sha1 和 sha2 显示为连续提交，并且只有一个文件是 sha2 中的更改。

但是，当我跑步时

```
git diff sha1 sha2 
```

它显示了许多文件的差异。为什么是这样？sha1 和 sha2 是我从 git log --name-only 获得的连续提交 ID。sha1 是较早的提交。

我认为这`git diff`只会显示由`git log --name-only`.

`sha1`和是同一分支中的`sha2`连续提交。

`sha1`是从樱桃采摘的`B1`，`sha2`是从樱桃采摘的`B2`。

我发现一个未列出的文件`git log --name-only`被修改了，基本上我的更改`B1`被`B1`提交覆盖了，即使它没有被列为已修改。

在不知不觉中拾取变化的樱桃采摘是否存在问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T07:34:31.613

您需要将`git-log`呼叫更改为

```
git log --name-only sha1..sha2 
```

# sql-server-2008 - 如何使用 LIKE 执行区分大小写的搜索？

> ID：15079210
> 
> 赞同：35
> 
> 时间：2013-02-26T00:30:11.103
> 
> 标签：sql-server-2008, pattern-matching, sql-like, collate

我正在尝试查找包含 6 个或更多大写字母数字字符的字符串的记录。一些例子：

```
PENDING  3RDPARTY  CODE27 
```

我正在使用以下语句：

```
SELECT Details
FROM MyTable
WHERE Details LIKE '%[0-9A-Z][0-9A-Z][0-9A-Z][0-9A-Z][0-9A-Z][0-9A-Z]%'; 
```

这将返回包含任何 6 个或更多字母单词的所有记录，无论大小写。

我添加了一个`COLLATE`声明：

```
SELECT Details
FROM MyTable
WHERE Details COLLATE Latin1_General_CS_AS LIKE '%[0-9A-Z][0-9A-Z][0-9A-Z][0-9A-Z][0-9A-Z][0-9A-Z]%'; 
```

这没有任何改变。无论大小写如何，它仍会返回包含 6 个或更多字母单词的记录。

就像测试一样，我尝试了：

```
SELECT Details
FROM MyTable
WHERE Details COLLATE Latin1_General_CS_AS LIKE '%pending%';

SELECT Details
FROM MyTable
WHERE Details COLLATE Latin1_General_CS_AS LIKE '%PENDING%'; 
```

这两种方法都有效，分别返回包含“pending”和“PENDING”的记录。所以问题似乎出在`LIKE`克劳斯的模式匹配上。

我可以做些什么来执行这个区分大小写的搜索？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-02-26T01:11:09.200

尝试使用`COLLATE Latin1_General_BIN`而不是`COLLATE Latin1_General_CS_AS`

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-02-26T00:32:29.407

**由于@GeraldSv 更新**：使用排序规则`Latin1_General_BIN`

```
SELECT Details
FROM MyTable
WHERE Details 
LIKE '%[0-9A-Z][0-9A-Z][0-9A-Z][0-9A-Z][0-9A-Z][0-9A-Z]%' 
COLLATE Latin1_General_BIN; 
```

您需要将排序规则说明符放在要匹配的字符串而不是列*之后：*

```
SELECT Details
FROM MyTable
WHERE Details 
LIKE '%[0-9A-Z][0-9A-Z][0-9A-Z][0-9A-Z][0-9A-Z][0-9A-Z]%' 
COLLATE Latin1_General_CS_AS; 
```

更新：虽然我上面的回答是正确的，但在 Connect 中提交了一个错误：使用Microsoft 标记为“按设计”的[COLLATE Latin1_General_CS_AS 的范围时，Case-SENSITIVITY 不起作用。](https://connect.microsoft.com/SQLServer/feedback/details/725949/case-sensitivity-doesnt-work-when-using-a-range-in-like-with-collate-latin1-general-cs-as)

我通过使用 AdventureWorks2008R2（不区分大小写，默认开箱即用）进行验证，在 Person.Person 表中，我将 3 个以“n”结尾的姓氏更改为“N”，然后运行以下查询：

```
SELECT COUNT(*)
FROM Person.Person
WHERE LastName LIKE '%N' COLLATE Latin1_General_CS_AS 
```

成功。按预期返回 3 行。

```
SELECT COUNT(*)
FROM Person.Person
WHERE LastName LIKE '%[N]' COLLATE Latin1_General_CS_AS 
```

成功。按预期返回 3 行。

```
SELECT COUNT(*)
FROM Person.Person
WHERE LastName LIKE '%[N-N]' COLLATE Latin1_General_CS_AS 
```

成功。按预期返回 3 行。

```
SELECT COUNT(*)
FROM Person.Person
WHERE LastName LIKE '%[M-N]' COLLATE Latin1_General_CS_AS 
```

失败。返回 3334 行（所有姓氏以 'n' 和 'N' 结尾）

更新：感谢@GeraldSv，这有效：

```
SELECT COUNT(*)
FROM Person.Person
WHERE LastName LIKE '%[M-N]' COLLATE Latin1_General_BIN 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-02T10:35:08.380

我使用以下内容：

```
SELECT COUNT(*)
FROM Person.Person
WHERE LastName COLLATE Latin1_General_CS_AS != upper(LastName) COLLATE Latin1_General_CS_AS 
```

# android - Android 4.2.2 设备离线

> ID：15079211
> 
> 赞同：20
> 
> 时间：2013-02-26T00:30:13.417
> 
> 标签：android, adb, offline, device

我读过几个有类似问题的用户，但我找到的解决方案都没有解决我的问题。

我有几台运行 Android 4.2.2 的 Nexus 设备，它们都显示为离线，当我插入它们时，它们都没有显示提示。

我已经尝试过：

*   拔下/插入它们
*   关闭/打开 USB 调试
*   重新启动计算机、nexus 设备和 adb 服务器
*   重新安装驱动程序，甚至将驱动程序切换到三星 ADB 驱动程序
*   确认我正在运行 adb 1.0.31
*   确保我的路径指向 adb.exe
*   删除了我整个计算机上的所有旧 adb.exe 文件

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-04-08T02:49:53.413

如果您已正确安装 adb 并且您尝试了上面提到的所有补救措施，请听我的补救措施：

在 android 4.2.2 中出现“设备脱机”的原因是 android 在 4.2.2 中有一个安全功能，可以创建一个可用作调试端口的 USB 端口白名单。

将设备插入 USB 并输入命令“adb devices”后，您的设备中将弹出一个窗口并要求您接受连接：

![弹出窗口接受您的 USB 的 RSA 指纹](../Images/2956dca4781cec6b58761fddbb63f987.png)

接受您 USB 的 RSA 指纹后，您现在可以再次发出“adb devices”并看到设备不再离线，

如果您没有看到弹窗，原因是您的 adb 版本太旧，您的 adb 版本必须至少为 1.0.31（您可以使用命令“adb version”查看版本）。如果版本早于 1.0.31，则使用 google 的最新更新更新您的平台工具包。[您可以在sdk-repository](https://dl-ssl.google.com/android/repository/repository-8.xml)中找到最新版本。找到与您的操作系统相关联的**platform-tools*.zip**并从 `https://dl-ssl.google.com/android/repository/platform-tools*.zip`.

例如，可以使用以下链接下载 19.0.1 版平台工具：

对于 linux：[https ://dl-ssl.google.com/android/repository/platform-tools_r19.0.1-linux.zip](https://dl-ssl.google.com/android/repository/platform-tools_r19.0.1-linux.zip)

对于 Windows：[https ://dl-ssl.google.com/android/repository/platform-tools_r19.0.1-windows.zip](https://dl-ssl.google.com/android/repository/platform-tools_r19.0.1-windows.zip)

对于 MacOSx：[https ://dl-ssl.google.com/android/repository/platform-tools_r19.0.1-macosx.zip](https://dl-ssl.google.com/android/repository/platform-tools_r19.0.1-macosx.zip)

而已

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-26T00:34:47.787

终于找到了答案。我已经安装了“SnapPea”，它显然带有自己的 ADB.exe。它以某种方式妨碍了。卸载这个写得不好的软件并重新启动解决了这个问题。

作为一个 Android 开发者，这种事情是很可怕的。是否将我所做的一切都发送到某处的家庭服务器？为什么任何软件都应该在客户的计算机上安装 ADB？

这可能是谷歌必须首先添加此安全措施的原因......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T16:22:39.380

我遇到了同样的问题，只是我的 ADT Eclipse 插件已经过时了。我安装了所有更新，一切正常。我不知道您是否也一样，有时我们只是忘记了更新...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-06-29T19:07:20.123

对我来说它正在工作，但一分钟后（重新连接 USB 电缆后）该设备“离线”。我通过在设备的开发人员设置中禁用然后重新启用 USB 调试选项再次使其“联机”。

# php - 检查用户是否从浏览器访问

> ID：15079213
> 
> 赞同：0
> 
> 时间：2013-02-26T00:30:42.557
> 
> 标签：php, browser

最近，我的一个朋友使用该`mailto`标签发布了他们的电子邮件地址，并因此收到了很多垃圾邮件机器人。

我只是想知道是否可以检测一个人是否使用“正确”浏览器访问网页，如果是，则显示电子邮件地址，如果不是，则不显示他们的电子邮件地址？

我知道你可以得到某人的电子邮件地址正在使用什么，`HTTP_USER_AGENT`但我真的不想编译一个有能力的浏览器数组，只是想知道 PHP 中是否有预定义的函数。

任何帮助将不胜感激。

PS我不是要求特定的代码，参考就可以了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T00:31:21.867

不，解析数组或离开它

E：关于你的垃圾邮件机器人，用javascript为mailto组装emailadresse，对我来说很好，我从来没有收到垃圾邮件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T00:47:44.240

虽然您可以通过 UserAgent 从诸如[user-agents.org之类的列表中过滤浏览器，或者通过](http://www.user-agents.org)[get-browser 方法](http://php.net/manual/en/function.get-browser.php)使用内置检测，但如果您的地址显示在原始 html 中，您仍然可能会被蜘蛛获取，由于 UserAgent 欺骗。您最好使用 javascript 来显示 mailto 链接，使用`window.open("mailto:example@example.com")`您想要包含的任何其他参数，并使用`<a onclick="jsfunction" href="javascript:void(0);">`.

编辑：或者在页面加载时使用脚本动态形成链接。

# c# - 如何用不同的默认值初始化多维数组

> ID：15079215
> 
> 赞同：13
> 
> 时间：2013-02-26T00:30:55.970
> 
> 标签：c#, .net, arrays, multidimensional-array, default-value

我正在尝试用-1初始化整数值的二维数组。当我创建一个新数组时，它会自动填充 0。我知道我可以用 2 来循环，但我想在构建数组时应该有一些方法（所以我不必通过它两次），以便插入提供的值而不是 0。可能吗？如果不是在阵列的初始构建期间，是否有其他时间或代码节省方式，或者我是否坚持使用 2 个周期？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-26T00:36:37.590

尝试这样的事情：`int[,] array2D = new int[,] { { -1 }, { -1 }, { -1 }, { -1} };`

或有尺寸`int[,] array2D = new int[4,2] { { -1,-1 }, { -1,-1 }, { -1,-1 }, {-1,-1} };`

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-02-26T00:36:24.760

对于多维数组，循环很可能是最好的方法，除非数组小到可以直接在代码中初始化。

如果您使用的是[锯齿状数组](http://msdn.microsoft.com/en-us/library/2s05feca.aspx)，则可以初始化第一个子数组，然后使用[Array.Copy](http://msdn.microsoft.com/en-us/library/system.array.copy.aspx)将这些值复制到彼此的子数组中。这仍然需要通过第一个子数组进行一次迭代，并通过 N-1 个外部数组进行一次循环，但复制操作将比循环更快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-03-29T04:02:58.833

在 Python 中，这种二维数组初始化是错误的：

```
mat = [[0] * 5] * 5  # wrong
mat = [[0] * 5] for _ in range(5)]  # correct 
```

因为您正在多次复制内部数组的引用，并且更改其中一个最终会更改所有内容。

```
mat[0][0] = 1
print(mat)
# 1 0 0 0 0
# 1 0 0 0 0
# 1 0 0 0 0
# 1 0 0 0 0
# 1 0 0 0 0 
```

在 C# 中，我们有类似的问题。

```
var mat = Enumerable.Repeat(Enumerable.Repeat(0, 5).ToArray(), 5).ToArray(); 
```

由于数组是引用类型，所以外部的 Repeat() 实际上是在复制内部数组的引用。

然后，如果您确实需要在不使用 for 循环的情况下创建和初始化多维数组，那么自定义帮助程序类可能会有所帮助：

```
static class HelperFunctions
{
    public static T[][] Repeat<T>(this T[] arr, int count)
    {
        var res = new T[count][];
        for (int i = 0; i < count; i++)
        {
            //arr.CopyTo(res[i], 0);
            res[i] = (T[])arr.Clone();
        }
        return res;
    }
} 
```

那么如果你想使用它：

```
using static HelperFunctions;

var mat = Enumerable.Repeat(0, 5).ToArray().Repeat(5); 
```

这会做。

# objective-c - TableView backgroundColor 没有改变

> ID：15079216
> 
> 赞同：3
> 
> 时间：2013-02-26T00:30:56.897
> 
> 标签：objective-c, uitableview, background-color

我有一个分组的 tableView，我正在尝试将默认背景更改为自定义颜色。我已经看过了，最接近工作的是：

```
- (void)viewDidLoad {
    UIColor *backgroundColor = [UIColor colorWithRed:181 green:293 blue:223 alpha:0];
    self.tableView.backgroundView = [[UIView alloc]initWithFrame:self.tableView.bounds];
    self.tableView.backgroundView.backgroundColor = backgroundColor;
} 
```

此代码将背景更改为白色，但我无法将其更改为自定义颜色。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-26T01:08:58.643

您正在错误地创建颜色。RGBA 值需要在 0.0 - 1.0 范围内。`UIColor`将任何超过 1.0 的内容视为 1.0。所以你的颜色被设置为白色，因为所有三个 RGB 值都将被视为 1.0。另请注意，alpha 为 0 表示完全透明。您希望 1.0 表示完全可见。

```
- (void)viewDidLoad {
    UIColor *backgroundColor = [UIColor colorWithRed:181/255.0 green:293/255.0 blue:223/255.0 alpha:1.0];
    self.tableView.backgroundView = [[UIView alloc]initWithFrame:self.tableView.bounds];
    self.tableView.backgroundView.backgroundColor = backgroundColor;
} 
```

请注意，您的绿色值是 293。需要将其更改为 0 到 255 之间的值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-26T01:24:14.990

您的 RGBA 值应为 0.0 - 1.0。

**确保 alpha 值不应为 0.0，以查看颜色效果**

```
UIColor *backgroundColor = [UIColor colorWithRed:0.7 green:1.0 blue:0.85 alpha:1.0];
self.tableView.backgroundView = [[UIView alloc]initWithFrame:self.tableView.bounds];
self.tableView.backgroundView.backgroundColor = backgroundColor; 
```

# windows-phone - 在 WP 7 中阻止来电

> ID：15079218
> 
> 赞同：0
> 
> 时间：2013-02-26T00:31:21.450
> 
> 标签：windows-phone, call, block

我想知道是否有任何方法可以阻止 WP 7.x 中的来电或消息

我看到一些谣言说这根本不可能，但这些信息已经过时了。

现在怎么样？有什么办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T01:17:13.280

在 Windows Phone 7 和 Windows Phone 8 中，无法以编程方式拦截或阻止呼叫和消息。

# ruby - 需要一个支持 ruby 的副本集和 eventmachine 的 mongo 驱动程序

> ID：15079221
> 
> 赞同：2
> 
> 时间：2013-02-26T00:31:31.060
> 
> 标签：ruby, mongodb, eventmachine

我正在尝试找到一个基于 ruby​​ 的 mongo 驱动程序以在我的项目中使用。它必须支持副本集和事件机。我知道 em-mongo，但它不支持副本集。目前似乎没有一个好的选择，但我想看看在我探索 mongo 替代品之前是否有人知道...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T23:06:56.847

我是 10gen Ruby 驱动程序的维护者。请稍等，我们将在不久的将来对此提供支持。

我不相信目前有任何东西（来自 10gen 或其他）可以做到这一点，但我们正在积极开发支持异步读写的驱动程序版本。

所有官方 10gen 驱动程序的目标是在今年年中到年底之前支持这一点，而 ruby​​ 驱动程序团队已经在努力。希望我们能比这更早地为您提供一些东西（可能在我们的 2.0 版本中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T21:40:42.693

你可以试试[我的 fork](https://github.com/fl00r/em-mongo) of `em-mongo`Replica Set 支持。

我也在研究 gem [Monga](https://github.com/fl00r/monga)，它应该支持 MongoDB 的一些现代特性。但它现在完全没有准备好生产。

# xcode - XCode 4.5 - 向左缩进代码

> ID：15079225
> 
> 赞同：2
> 
> 时间：2013-02-26T00:31:39.437
> 
> 标签：xcode, xcode4.5

我正在使用 XCode 4.5，我需要将大约 50 行代码向左缩进 1 个制表符。我该怎么做（不逐行做）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T00:33:35.630

使用 Cmd-[。这将使选定的行向左缩进一个选项卡。您可以在 Editor->Structure->Shift Left 中找到菜单命令

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T00:33:59.200

选择所有文本，然后按 Option + ] 向右移动或按 Option + [ 向左移动。

# c# - 枚举和字符串匹配

> ID：15079227
> 
> 赞同：6
> 
> 时间：2013-02-26T00:31:42.150
> 
> 标签：c#, enums

我本质上是在尝试读取 xml 文件。其中一个值具有后缀，例如“ `30d`”。这意味着“30 天”。所以我正在尝试将其转换为`DateTime.Now.AddDays(30)`. 为了在 XML 中读取这个字段，我决定使用 Enum：

```
enum DurationType { Min = "m", Hours = "h", Days = "d" } 
```

现在我不完全确定如何有效地解决这个问题（在枚举方面我有点愚蠢）。我是否应该先将后缀（在本例中为“d”）从字符串中分离出来，然后尝试在`enum`using`switch`语句中匹配它？

我想如果你把我的问题弄糊涂了，那就是：从`30d`, 到的最佳方式是什么`DateTime.Now.AddDays(30)`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-26T00:48:45.557

您可以制作一个 ExtensionMethod 来解析字符串并返回您想要的 DateTime

就像是：

```
 public static DateTime AddDuration(this DateTime datetime, string str)
    {
        int value = 0;
        int mutiplier = str.EndsWith("d") ? 1440 : str.EndsWith("h") ?  60 : 1;
        if (int.TryParse(str.TrimEnd(new char[]{'m','h','d'}), out value))
        {
            return datetime.AddMinutes(value * mutiplier);
        }
        return datetime;
    } 
```

用法：

```
 var date = DateTime.Now.AddDuration("2d"); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-26T00:50:49.167

这似乎是使用正则表达式的好地方；具体来说，捕获组。

下面是一个工作示例：

```
using System;
using System.Text.RegularExpressions;

namespace RegexCaptureGroups
{
    class Program
    {
        // Below is a breakdown of this regular expression:
        // First, one or more digits followed by "d" or "D" to represent days.
        // Second, one or more digits followed by "h" or "H" to represent hours.
        // Third, one or more digits followed by "m" or "M" to represent minutes.
        // Each component can be separated by any number of spaces, or none.
        private static readonly Regex DurationRegex = new Regex(@"((?<Days>\d+)d)?\s*((?<Hours>\d+)h)?\s*((?<Minutes>\d+)m)?", RegexOptions.IgnoreCase);

        public static TimeSpan ParseDuration(string input)
        {
            var match = DurationRegex.Match(input);

            var days = match.Groups["Days"].Value;
            var hours = match.Groups["Hours"].Value;
            var minutes = match.Groups["Minutes"].Value;

            int daysAsInt32, hoursAsInt32, minutesAsInt32;

            if (!int.TryParse(days, out daysAsInt32))
                daysAsInt32 = 0;

            if (!int.TryParse(hours, out hoursAsInt32))
                hoursAsInt32 = 0;

            if (!int.TryParse(minutes, out minutesAsInt32))
                minutesAsInt32 = 0;

            return new TimeSpan(daysAsInt32, hoursAsInt32, minutesAsInt32, 0);
        }

        static void Main(string[] args)
        {
            Console.WriteLine(ParseDuration("30d"));
            Console.WriteLine(ParseDuration("12h"));
            Console.WriteLine(ParseDuration("20m"));
            Console.WriteLine(ParseDuration("1d 12h"));
            Console.WriteLine(ParseDuration("5d 30m"));
            Console.WriteLine(ParseDuration("1d 12h 20m"));

            Console.WriteLine("Press any key to exit.");
            Console.ReadKey();
        }
    }
} 
```

编辑：下面是上面的另一种更精简的版本，尽管我不确定我更喜欢哪一个。我通常不喜欢过于密集的代码。我调整了正则表达式，将每个数字限制为 10 位。这使我可以安全地使用该`int.Parse`函数，因为我知道输入由至少一个数字和最多十个数字组成（除非它根本没有捕获，在这种情况下它将是空字符串：因此， ParseInt32ZeroIfNullOrEmpty 方法）。

```
 // Below is a breakdown of this regular expression:
        // First, one to ten digits followed by "d" or "D" to represent days.
        // Second, one to ten digits followed by "h" or "H" to represent hours.
        // Third, one to ten digits followed by "m" or "M" to represent minutes.
        // Each component can be separated by any number of spaces, or none.
        private static readonly Regex DurationRegex = new Regex(@"((?<Days>\d{1,10})d)?\s*((?<Hours>\d{1,10})h)?\s*((?<Minutes>\d{1,10})m)?", RegexOptions.IgnoreCase);

        private static int ParseInt32ZeroIfNullOrEmpty(string input)
        {
            return string.IsNullOrEmpty(input) ? 0 : int.Parse(input);
        }

        public static TimeSpan ParseDuration(string input)
        {
            var match = DurationRegex.Match(input);

            return new TimeSpan(
                ParseInt32ZeroIfNullOrEmpty(match.Groups["Days"].Value),
                ParseInt32ZeroIfNullOrEmpty(match.Groups["Hours"].Value),
                ParseInt32ZeroIfNullOrEmpty(match.Groups["Minutes"].Value),
                0);
        } 
```

编辑：为了再迈出这一步，我在下面添加了另一个版本，它处理天、小时、分钟、秒和毫秒，每个都有各种缩写。为了便于阅读，我将正则表达式拆分为多行。请注意，我还必须通过`(\b|(?=[^a-z]))`在每个组件的末尾使用来调整表达式：这是因为“ms”单位被捕获为“m”单位。与“[^az]”一起使用的“?=”的特殊语法表示匹配字符，而不是“使用”它。

```
 // Below is a breakdown of this regular expression:
    // First, one to ten digits followed by "d", "dy", "dys", "day", or "days".
    // Second, one to ten digits followed by "h", "hr", "hrs", "hour", or "hours".
    // Third, one to ten digits followed by "m", "min", "minute", or "minutes".
    // Fourth, one to ten digits followed by "s", "sec", "second", or "seconds".
    // Fifth, one to ten digits followed by "ms", "msec", "millisec", "millisecond", or "milliseconds".
    // Each component may be separated by any number of spaces, or none.
    // The expression is case-insensitive.
    private static readonly Regex DurationRegex = new Regex(@"
        ((?<Days>\d{1,10})(d|dy|dys|day|days)(\b|(?=[^a-z])))?\s*
        ((?<Hours>\d{1,10})(h|hr|hrs|hour|hours)(\b|(?=[^a-z])))?\s*
        ((?<Minutes>\d{1,10})(m|min|minute|minutes)(\b|(?=[^a-z])))?\s*
        ((?<Seconds>\d{1,10})(s|sec|second|seconds)(\b|(?=[^a-z])))?\s*
        ((?<Milliseconds>\d{1,10})(ms|msec|millisec|millisecond|milliseconds)(\b|(?=[^a-z])))?",
        RegexOptions.IgnoreCase | RegexOptions.IgnorePatternWhitespace);

    private static int ParseInt32ZeroIfNullOrEmpty(string input)
    {
        return string.IsNullOrEmpty(input) ? 0 : int.Parse(input);
    }

    public static TimeSpan ParseDuration(string input)
    {
        var match = DurationRegex.Match(input);

        return new TimeSpan(
            ParseInt32ZeroIfNullOrEmpty(match.Groups["Days"].Value),
            ParseInt32ZeroIfNullOrEmpty(match.Groups["Hours"].Value),
            ParseInt32ZeroIfNullOrEmpty(match.Groups["Minutes"].Value),
            ParseInt32ZeroIfNullOrEmpty(match.Groups["Seconds"].Value),
            ParseInt32ZeroIfNullOrEmpty(match.Groups["Milliseconds"].Value));
    } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-26T00:37:38.317

**更新：** 不要为此投票。我离开它只是因为它是一种替代方法。相反，请查看 sa_ddam213 和 Dr. Wily's Apprentice 的答案。

> 我是否应该先将后缀（在这种情况下为“d”）从字符串中分离出来，然后尝试使用 switch 语句在枚举中匹配它？

是的。

对于一个完整的工作示例：

```
private void button1_Click( object sender, EventArgs e ) {
    String value = "30d";

    Duration d = (Duration)Enum.Parse(typeof(Duration), value.Substring(value.Length - 1, 1).ToUpper());
    DateTime result = d.From(new DateTime(), value);

    MessageBox.Show(result.ToString());
}

enum Duration { D, W, M, Y };

static class DurationExtensions {
    public static DateTime From( this Duration duration, DateTime dateTime, Int32 period ) {
        switch (duration)
        {
          case Duration.D: return dateTime.AddDays(period);
          case Duration.W: return dateTime.AddDays((period*7));
          case Duration.M: return dateTime.AddMonths(period);
          case Duration.Y: return dateTime.AddYears(period);

          default: throw new ArgumentOutOfRangeException("duration");
        }
     }
    public static DateTime From( this Duration duration, DateTime dateTime, String fullValue ) {
        Int32 period = Convert.ToInt32(fullValue.ToUpper().Replace(duration.ToString(), String.Empty));
        return From(duration, dateTime, period);
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-26T00:49:25.733

我真的不明白如何`enum`在这里使用帮助。

以下是我可能会如何处理它。

```
string s = "30d";

int typeIndex = s.IndexOfAny(new char[] { 'd', 'w', 'm' });
if (typeIndex > 0)
{
    int value = int.Parse(s.Substring(0, typeIndex));
    switch (s[typeIndex])
    {
        case 'd':
            result = DateTime.Now.AddDays(value);
            break;
        case 'w':
            result = DateTime.Now.AddDays(value * 7);
            break;
        case 'm':
            result = DateTime.Now.AddMonths(value);
            break;
    }
} 
```

根据输入数据的可靠性，您可能需要使用`int.TryParse()`而不是`int.Parse()`. 否则，这应该就是您所需要的。

注意：我还`sscanf()`为 .NET 编写了一个替代品，可以很容易地处理这个问题。您可以在文章[A sscanf() Replacement for .NET](http://www.blackbeltcoder.com/Articles/strings/a-sscanf-replacement-for-net)中查看代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-26T00:42:52.883

试试下面的代码，假设像“30d”这样的值在字符串“val”中。

```
DateTime ConvertValue(string val) {
    if (val.Length > 0) {
        int prefix = Convert.ToInt32(val.Length.Remove(val.Length-1));
        switch (val[val.Length-1]) {
        case 'd': return DateTime.Now.AddDays(prefix);
        case 'm': return DateTime.Now.AddMonths(prefix);
        // etc.
    }
    throw new ArgumentException("string in unexpected format.");
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-26T01:25:42.800

控制台应用程序示例/教程示例：

```
enum DurationType
{
    [DisplayName("m")]
    Min = 1,
    [DisplayName("h")]
    Hours = 1 * 60,
    [DisplayName("d")]
    Days = 1 * 60 * 24
}

internal class Program
{
    private static void Main(string[] args)
    {

        string input1 = "10h";
        string input2 = "1d10h3m";

        var x = GetOffsetFromDate(DateTime.Now, input1);
        var y = GetOffsetFromDate(DateTime.Now, input2);

    }

    private static Dictionary<string, DurationType> suffixDictionary
    {
        get
        {
            return Enum
                .GetValues(typeof (DurationType))
                .Cast<DurationType>()
                .ToDictionary(duration => duration.GetDisplayName(), duration => duration);
        }
    }

    public static DateTime GetOffsetFromDate(DateTime date, string input)
    {
        MatchCollection matches = Regex.Matches(input, @"(\d+)([a-zA-Z]+)");
        foreach (Match match in matches)
        {
            int numberPart = Int32.Parse(match.Groups[1].Value);
            string suffix = match.Groups[2].Value;
            date = date.AddMinutes((int)suffixDictionary[suffix]);
        }
        return date;
    }

}

[AttributeUsage(AttributeTargets.Field)]
public class DisplayNameAttribute : Attribute
{
    public DisplayNameAttribute(String name)
    {
        this.name = name;
    }
    protected String name;
    public String Name { get { return this.name; } }
}

public static class ExtensionClass
{
    public static string GetDisplayName<TValue>(this TValue value) where TValue : struct, IConvertible
    {
        FieldInfo fi = typeof(TValue).GetField(value.ToString());
        DisplayNameAttribute attribute = (DisplayNameAttribute)fi.GetCustomAttributes(typeof(DisplayNameAttribute), false).FirstOrDefault();
        if (attribute != null)
            return attribute.Name;
        return value.ToString();
    }
} 
```

使用属性来定义你的后缀，使用枚举值来定义你的偏移量。

要求：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Reflection;
using System.Text.RegularExpressions; 
```

使用枚举整数值可能被认为是一种 hack，但是这个示例仍然可以让您解析所有枚举（用于任何其他用途，如 switch case），只需稍作调整。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-26T00:43:45.653

我建议先使用正则表达式去除数字，然后执行[Enum.Parse 方法](http://msdn.microsoft.com/en-us/library/essfb559.aspx)来评估枚举的值。您可以使用开关（请参阅 Corylulu 的答案）根据解析的数字和枚举值获得正确的偏移量。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-26T00:38:40.437

枚举不能支持非数字类型，因此基于字符串的枚举不可用。你可能想多了。在不了解问题的情况下，最直接的解决方案似乎是将最后一个字符拆分，将其余字符转换为 int，然后将每个最终字符作为单独的案例处理。

# javascript - 将信息表单内容脚本放入 popout.html-Chrome 扩展

> ID：15079230
> 
> 赞同：0
> 
> 时间：2013-02-26T00:32:10.500
> 
> 标签：javascript, google-chrome, google-chrome-extension

我为 chrome 扩展编写了一个内容脚本，它解析来自网站的信息并将它们显示给用户。如果我控制台记录它，我可以看到此信息，因此我知道脚本正在获取我想要的信息，但我不知道如何将其发送回我制作的弹出窗口。

因此，例如，我有一条线从用户所在的网站中提取标题

```
titlearea = document.getElementById("titlelarge").innerText; 
```

但是，当我尝试将 popout.html 文件中的 title 元素设置为 titlearea 时，什么也没有发生。显然信息没有到达那里。如何传输我收集的所有数据？

-谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T02:37:42.727

[在您的内容脚本中，使用sendMessage API](https://developer.chrome.com/extensions/messaging.html)将您想要显示的数据发送到弹出页面

然后就可以显示数据了：）

# ios - UIViewController presentViewController:animated:completion - 启动需要 4 到 6 秒

> ID：15079232
> 
> 赞同：2
> 
> 时间：2013-02-26T00:32:16.047
> 
> 标签：ios, objective-c, uiviewcontroller

我正在构建一个登录模块，用户输入的凭据在后端系统中得到验证。我正在使用异步调用来验证凭据，并且在用户通过身份验证后，我使用该方法进入下一个屏幕`presentViewController:animated:completion`。问题是该`presentViewController`方法启动在呈现下一个屏幕之前需要一段时间。恐怕我之前对 的调用会以`sendAsynchronousRequest:request queue:queue completionHandler:` 某种方式产生副作用。

只是为了确保我说的 4 – 6 秒是在命令`presentViewController:animated:completion`启动之后。我这么说是因为我正在调试代码并监视调用该方法的那一刻。

第一：`NSURLConnection`方法被调用：

```
NSMutableURLRequest *request = [[NSMutableURLRequest alloc] initWithURL:url cachePolicy:NSURLRequestUseProtocolCachePolicy timeoutInterval:10.0];

NSOperationQueue *queue = [[NSOperationQueue alloc] init];

[NSURLConnection sendAsynchronousRequest:request queue:queue completionHandler:^(NSURLResponse *response, NSData *data, NSError *error) 
```

二：`UIViewController`方法调用异常耗时

```
UIViewController *firstViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"FirstView"];

[self presentViewController:firstViewController animated:YES completion:nil]; 
```

任何帮助表示赞赏。

谢谢，马科斯。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-26T00:40:29.443

这是从后台线程操作 UI 的典型症状。您需要确保只调用`UIKit`主线程上的方法。不能保证在任何特定线程上调用完成处理程序，因此您必须执行以下操作：

```
[NSURLConnection sendAsynchronousRequest:request queue:queue completionHandler:^(NSURLResponse *response, NSData *data, NSError *error) {
    dispatch_async(dispatch_get_main_queue(), ^{
        UIViewController *firstViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"FirstView"];
        [self presentViewController:firstViewController animated:YES completion:nil];
    });
} 
```

这保证了您的代码在主线程上运行。

# javascript - 上一次单击绑定完成时如何执行.click（）代码

> ID：15079237
> 
> 赞同：4
> 
> 时间：2013-02-26T00:32:36.310
> 
> 标签：javascript, jquery, twitter-bootstrap

我正在尝试`data-toggle="buttons-radio"`在我的网站中使用 Twitter Bootstrap 按钮组。引导标记如下。

```
<div class="btn-group program-status" data-toggle="buttons-radio">
    <button class="btn">All</button>
    <button class="btn">Active</button>
    <button class="btn">Planning</button>
    <button class="btn">End of Life</button>
    <button class="btn">Cancelled</button>
</div> 
```

我需要根据按下的按钮重定向到带有查询的同一页面。我尝试使用以下 jQuery 代码来实现这一点。

```
<script>
    var sParamStr = '';

    function addToParamStr(str) {
        sParamStr += str;
    }

    function redirectToUpdatedLocation() { 

        $('.program-status > .btn.active').each(function () {
            addToParamStr( '?status=' + $(this).text());
        });

        console.log(sParamStr);
        window.location.href = "program" + sParamStr;
    }

    $document.ready(function () {
        $('.program-status > .btn').on('click', function (e) {
            redirectToUpdatedLocation();
        });
    });
</script> 
```

但是浏览器总是重定向到 {site}/program 没有查询字符串。通过注释掉`window.location.href = "program" + sParamStr;`一行，我设法观察到第二次点击，并`sParamStr`正确附加。

看来，我的代码之前尝试读取按下按钮的文本，`.button('toggle')`方法表单 bootstrap.js 完成。当我按如下更改功能时，代码按预期工作。

```
$document.ready(function () {
    $( '.program-status > .btn').on('click', function (e) {
        $(this).addClass('active');
        redirectToUpdatedLocation();
    });
}); 
```

虽然这种方法现在对我有用，但我想知道实现这一目标的正确方法。即如何在之前的点击绑定完成后执行我的代码？

更新：

我在 Twitter Bootstrap 论坛中找到了这个链接。似乎这是一个已知问题。 [https://github.com/twitter/bootstrap/issues/2380](https://github.com/twitter/bootstrap/issues/2380)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T00:40:18.570

我不确定 Bootstrap`.toggle`到底在做什么，但它似乎做了某种与`active`类的设置一起完成的动画。您可以尝试将您的代码加入队列：

```
$( '.program-status > .btn').on('click', function (e){
    $(this).queue(function (next) {
        redirectToUpdatedLocation();
        next();
    });
}); 
```

例如，在切换 div 时单击它：http: [//jsfiddle.net/9HwYy/](http://jsfiddle.net/9HwYy/)

* * *

*对我来说，更新每一个* `href`而不是仅仅更新你点击的那个似乎也有点傻，因为无论如何你都在改变窗口位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T00:36:16.777

尝试

```
$('.program-status > .btn.active').each(function(i,v){
  v = $(v);
  addToParamStr( '?status=' + v.text());
}); 
```

因为我不确定“这个”是否适用于您的情况。

# android - android simplecursoradapter 每次都会出错

> ID：15079244
> 
> 赞同：0
> 
> 时间：2013-02-26T00:33:12.247
> 
> 标签：android, simplecursoradapter

我一直在尝试创建一个简单的光标适配器。我检查了我能找到的每个网站，以及这里的所有线程，我只是看不出有什么问题。

```
gcDBAssist dbHelper;
SQLiteDatabase db;
Cursor cursor;
String display;
String TAG = "Listing the database";
ListView listTimeline;
SimpleCursorAdapter adapter;

static final String[] FROM = { gcDBAssist.C_ID, gcDBAssist.C_TIME, gcDBAssist.C_SCORE, gcDBAssist.C_LEVEL, gcDBAssist.C_POSTED, gcDBAssist.C_USER };
static final int[] TO = { R.id.textID, R.id.textTime, R.id.textScore, R.id.textLevel, R.id.textPosted, R.id.textUser };

@Override
protected void onCreate(Bundle savedInstanceState) {

  super.onCreate(savedInstanceState);
  setContentView(R.layout.time_list);
  listTimeline = (ListView) findViewById(R.id.listTimeline);

  dbHelper = new gcDBAssist(this);
  db = dbHelper.getReadableDatabase();

}

@Override
protected void onResume() {

  super.onResume();

  //get the data
  cursor = db.rawQuery("SELECT * from " +gcDBAssist.TABLE, null);       
  adapter = new SimpleCursorAdapter(this, R.layout.row, cursor, FROM, TO, 0);
  listTimeline.setAdapter(adapter); 
```

我已经进行了一些检查，并且可以使用`while(cursor.moveToNext())`.

# java - 尝试通过 Maven 构建过程写入时，Manifest.mf 仍然为空

> ID：15079250
> 
> 赞同：1
> 
> 时间：2013-02-26T00:34:06.390
> 
> 标签：java, maven, pom.xml, manifest.mf

我正在尝试通过 pom.xml 将一些额外的数据写入我的 manifest.mf，但由于某种原因它仍然是空白的....我是 java 的一个完整的新手，所以我要在这里写下我的所有步骤.. 不不管这让我看起来多么愚蠢，因为我不知道我在做什么，所以任何指针都会很棒......

这是我的 pom.xml 的构建部分

```
<build>
<plugins>
    <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-jar-plugin</artifactId>
        <version>2.4</version>
        <configuration>
            <archive>
                <manifestFile>
                    ${basedir}/src/main/resources/META-INF/MANIFEST.MF
                </manifestFile>
                <manifest>
                    <addDefaultImplementationEntries>true</addDefaultImplementationEntries>
                    <addDefaultSpecificationEntries>true</addDefaultSpecificationEntries>
                </manifest>
                <manifestEntries>
                    <Test>I am a test</Test>
                </manifestEntries>
            </archive>
        </configuration>
    </plugin>
  </plugins>
</build> 
```

我在 src/main/resources/META-INF 文件中手动创建了文件 MANIFEST.MF 并将其留空，期待它在构建期间写入。

我运行 mvn clean package

我进入 target/resources/classes/META-INF 目录并打开 MANIFEST.MF 其空白。当我去目标/做

java -jar myTest.jar

结果是

myTest.jar 中没有主清单属性

谁能告诉我（非常温和地）我做错了什么

:D

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T04:06:09.507

maven pom.xml 部分对我来说看起来不错。您可能想使用 winzip 或 winrar 打开 myTest.jar 并检查目标文件夹下 jar 文件中的 MANIFEST.MF 文件。您的 MANIFEST.MF 文件很可能已经与项目的 Implementation-Version 等条目合并。target/resources/classes/META-INF/MANIFEST.MF 为空白的原因是因为尚未发生合并。当时的 Maven 只是简单地将您提供的 MANIFEST.MF 文件复制到目标文件夹中。当您运行 java -jar myTest.jar 时，您会得到“无主清单属性”的结果。那是因为您没有`<mainClass/>`在该`<manifest>`部分中指定。如果这样做，它将在 MANIFEST.MF 文件中添加一个**Main-Class**条目，这将是您执行时要执行的主类`java -jar myTest.jar`

# python - 如何在 Django 中重用自定义验证？

> ID：15079255
> 
> 赞同：3
> 
> 时间：2013-02-26T00:34:42.173
> 
> 标签：python, django, django-forms

我需要以多种形式使用相同的自定义验证。在其他框架中，我会创建一个新的“验证器”类，但我不确定 Django/Python 的最佳选择。

以下是我所做的，有没有更好的方法（下面的解决方案）？

任何**形式**：

```
 def clean_image(self):
        image = self.cleaned_data.get("image")

        return validate_image_with_dimensions(
            image,
            expected_width=965,
            expected_height=142
        ) 
```

在**验证**模块中

```
def validate_image_with_dimensions(image, expected_width, expected_height):
    from django.core.files.images import get_image_dimensions

    # the validation code...

    return image 
```

* * *

**以下是解决方案：**

**形式**：_

```
 image = forms.ImageField(
        max_length=250,
        label=mark_safe('Image<br /><small>(must be 1100 x 316px)</small>'),
        required=True,
        validators=[
            ImageDimensionsValidator(
                expected_width=1100,
                expected_height=316
            )
        ]
    ) 
```

在**验证**模块中：

```
class ImageDimensionsValidator(object):

    def __init__(self, expected_width, expected_height):
        self.expected_width = expected_width
        self.expected_height = expected_height

    def __call__(self, image):
        """
        Validates that the image entered have the good dimensions
        """
        from django.core.files.images import get_image_dimensions

        if not image:
            pass
        else:
            width, height = get_image_dimensions(image)
            if width != self.expected_width or height != self.expected_height:
                raise ValidationError(
                    "The image dimensions are: " + str(width) + "x" + str(height) + ". "
                    "It's supposed to be " + str(self.expected_width) + "x" + str(self.expected_height)
                ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T00:38:19.063

表单和模型字段[接受验证器列表](https://docs.djangoproject.com/en/dev/ref/validators/#writing-validators)：

```
class YourForm(forms.Form):
   ...
   image = forms.ImageField(validators=[validate_image_with_dimensions]) 
```

验证器是任何类型的可调用对象，请随意编写可调用类（django 内部验证器是基于类的）。

如需灵感，请查看[django.core.validators source](https://github.com/django/django/blob/master/django/core/validators.py)。

# iphone - 如何将 GIF 保存到我的相册？

> ID：15079262
> 
> 赞同：4
> 
> 时间：2013-02-26T00:35:05.797
> 
> 标签：iphone, ios, objective-c

我尝试使用 UIImageWriteToSavedPhotosAlbum 和 ALAssetsLibrary 将我的 gif 保存到相册。但是当我尝试通过电子邮件发送 gif 时，它没有动画。我很确定元数据在保存时会丢失。有谁知道我如何保存 gif 元数据？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-07-27T22:58:24.037

一个很老的问题，但它可能对某人有帮助！

我使用此代码将 GIF 保存在相册中，它工作正常，通过在 MailViewComposer 和 iMessage 中打开 GIF 进行测试。

```
ALAssetsLibrary *library = [[ALAssetsLibrary alloc] init];

NSData *data = [NSData dataWithContentsOfFile:tempPath]; // Your GIF file path which you might have saved in NSDocumentDir or NSTempDir

[library writeImageDataToSavedPhotosAlbum:data metadata:nil completionBlock:^(NSURL *assetURL, NSError *error) {
    if (error) {
        NSLog(@"Error Saving GIF to Photo Album: %@", error);
    } else {
        // TODO: success handling
        NSLog(@"GIF Saved to %@", assetURL);

        success(tempPath);
    }
}]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-08-11T15:50:16.527

**GIF 可以很容易地从 URL 保存到相册**

```
let url = FileManager.default.urlForFile("lion.gif") // Document Directory or Bundle url path 

PHPhotoLibrary.shared().performChanges ({
    PHAssetChangeRequest.creationRequestForAssetFromImage(atFileURL: url)
}) { saved, error in
    if saved {
        print("Your image was successfully saved")
    }
} 
```

# android - 面向中间件开发人员的 Android 规范？

> ID：15079264
> 
> 赞同：0
> 
> 时间：2013-02-26T00:35:29.093
> 
> 标签：android, specifications

Android 是否为硬件供应商提供了任何规范文档。我的问题是

例如，如果我有自己的蓝牙设备和堆栈，我的 bt 堆栈如何连接到 android API。

谷歌是否有任何类似于 micorsoft DDI 规范的规范文档。这不仅适用于Bluettoh。任何设备堆栈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T00:43:20.973

如果您有自己的蓝牙设备和堆栈，很可能您是按照 RFC 标准开发的。如果您没有使用 RFC 标准，该设备如何与其他设备通信？

Android 使用**RFC**标准，因此消除了混淆。

如果我们谈论**NFC**标准，您可以阅读[Android Developers的内容](http://developer.android.com/guide/topics/connectivity/index.html)

# html - CSS 选择器：几乎是空的？

> ID：15079265
> 
> 赞同：8
> 
> 时间：2013-02-26T00:35:29.610
> 
> 标签：html, css, pseudo-class

我知道`:empty`伪类将选择所有没有子元素的元素，但我只想选择带有文本节点的元素作为子元素。

我的超链接上有一个与文本颜色不同的下边框，但这是一个问题，因为超链接的图像也有这个下划线。

我试图`a *:not(*){ border-bottom-width: 0; }`解决这个问题，但没有奏效。有没有办法`a`为孩子选择只有文本节点的标签？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T00:50:04.013

如果我正确理解您的问题，您正试图避免您的超链接图像被加下划线。如果是这样，为什么不做类似的事情：`a img { text-decoration:none }`？

**编辑：**如果您不想在 img 标签上添加下划线，请将类应用于这些链接`text-decoration:none`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T00:51:11.290

**新答案：**

如果您想要图像下方的边框，而不是文本，请执行以下操作：

```
一个 img { 边框底部：1px 实心 #000; }
a:emtpy { 边框：无；}
```

如果你想要相反的（文本下的边框但不是图像下的边框），请执行以下操作：

```
a:empty {border-bottom:1px solid #000; }
一个 img { 边框：无；}
```

**旧答案：**

如果这只是包装在标签中的图像的问题，请尝试：

```
一个 img { 边界底部：无；}
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T01:06:05.653

为什么不使用负边距隐藏边框，而不是疯狂的选择器：

```
a img {
  margin-bottom: -6px;
} 
```

[演示](http://codepen.io/anon/pen/utBzh)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T01:03:18.990

当**唯一**`<a>`的孩子不是`img`...

```
a:only-child:not(img)
{
    border-bottom-width: 1;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-26T03:53:24.023

这无法实现，因为`border`属性在锚的最顶部框之外应用和呈现的方式 - 实际上，使用边框实现这种效果的唯一方法是否定属性。有时，使用背景颜色的底部边框覆盖锚点的底部边框在视觉上是可以接受的——这是一种不可靠的做法，令人不悦。也许可以使用过滤器来模拟效果，但我不会指望它得到足够好的跨浏览器支持。

我的建议是回到`text-decoration`属性 *同时仍然保持不同的、独立的下划线颜色 - 总体上是一种简洁的方法，但并非没有额外元素的开销：

```
<style>
.fancy-underline { color:blue; text-decoration:underline; } 
.fancy-underline a { color:black; text-decoration:none; }
</style>
<span class="fancy-underline"><a href="#">I am a fancy link
  <img src="//placekitten.com/30/30/" /> with an image in the middle of it
</a></span> 
```

[http://jsfiddle.net/ovfiddle/TwmmF/3/](http://jsfiddle.net/ovfiddle/TwmmF/3/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-26T18:53:05.260

我最终只使用了 jQuery。我不相信现在只有 CSS 是可能的。

```
jQuery('document').ready(function(){
    jQuery("a").each(function(){
        if(this.children.length !== 0)
            this.style.borderBottomWidth='0';
    });
}); 
```

# java - Java - 无法实例化类型 One2OneChannel

> ID：15079266
> 
> 赞同：0
> 
> 时间：2013-02-26T00:35:44.917
> 
> 标签：java, instantiation

当尝试启动一个非常简单的程序时，我在第 6 行收到错误“无法实例化 One2OneChannel 类型”。

```
import org.jcsp.lang.*;

public class main {
public static void main(String[] args)
{
    One2OneChannel chan = new One2OneChannel();
} 
```

我在其他程序中看到过，例如这里的[http://www.di.unipi.it/didadoc/labIII/ONLINE/jcsp-docs/jcsp/plugNplay/Merge.html](http://www.di.unipi.it/didadoc/labIII/ONLINE/jcsp-docs/jcsp/plugNplay/Merge.html)人们已经使用相同的代码成功创建了新的 One2OneChannels我正在尝试使用。

我可能做错了什么？

谢谢

亚历克斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T00:41:25.050

通常这是因为类的构造函数已设置为私有/受保护——或者类型是接口，而不是类。根据此文档：[http](http://www.cs.kent.ac.uk/projects/ofa/jcsp/jcsp-1.1-rc4/jcsp-doc/org/jcsp/lang/Channel.html) ://www.cs.kent.ac.uk/projects/ofa/jcsp/jcsp-1.1-rc4/jcsp-doc/org/jcsp/lang/Channel.html您可以通过以下方式创建 One2OneChannel代码：

```
One2OneChannel channel = Channel.createOne2One(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T00:40:19.860

您尝试实例化的[类](http://www.di.unipi.it/didadoc/labIII/ONLINE/jcsp-docs/jcsp/lang/One2OneChannel.html)`jcsp.lang`属于包。您需要相应地修改导入语句。

# python - 如何在 cx_freeze 中包含一个文件夹？

> ID：15079268
> 
> 赞同：21
> 
> 时间：2013-02-26T00:36:06.507
> 
> 标签：python, cx-freeze

我正在使用 cx_freeze 来部署我的应用程序。我想包含整个目录，因为包含单个文件不会将它们放在文件夹中。如何包含文件夹？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-03-15T10:23:57.913

您必须为构建选项设置一个包含文件参数。您可以通过不同的方式执行此操作，但我将展示我的配置的一部分。我在这里描述的是一个特定的文件和一个特定的目的地。我想你也可以设置这样的路径，但我还没有测试过。

**编辑：**对此进行了测试，因此为您的项目选择正确的方法。

```
buildOptions = dict(include_files = [(absolute_path_to_your_file,'final_filename')]) #single file, absolute path.

buildOptions = dict(include_files = ['your_folder/']) #folder,relative path. Use tuple like in the single file to set a absolute path.

setup(
         name = "appname",
         version = "1.0",
         description = "description",
         author = "your name",
         options = dict(build_exe = buildOptions),
         executables = executables) 
```

也看看这个话题。它解决了同样的问题：[使用 cx_freeze 时如何捆绑其他文件？](https://stackoverflow.com/questions/2553886/how-can-i-bundle-other-files-when-using-cx-freeze)

# c++ - 将单个数组复制到多维数组

> ID：15079270
> 
> 赞同：2
> 
> 时间：2013-02-26T00:36:16.030
> 
> 标签：c++, .net, arrays, command-line-interface, sorting

我已经声明了以下两个数组。一个是 4 个元素的单个数组，另一个是 5 行 4 列的多维数组（见下图）。

```
array<String^> ^single_row = {"E1", "E2", "E3", "E4"};
array<String^,2>^ multi_row=gcnew array<String^,2>(5,4); 
```

是否有内置函数可以用来复制第一个数组，比如说第二个数组的第三行，而无需手动复制每个元素？
注意：我尝试了数组-> 复制，但遇到了错误 C3262：无效数组索引：为 2 维“cli::array ^”指定了 1 个维度

我附上了一个图表以帮助实现可视化目的。 ![阵列图](../Images/1632452d99d69d6c0556e0733c15ccf3.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T21:42:54.847

我没有找到任何功能来做到这一点。我发现的唯一一件事是您也可以将第一个数组创建为多维数组。

```
array<String^,2> ^single_row = {{"E1", "E2", "E3", "E4"}};
array<String^,2>^ multi_row=gcnew array<String^,2>(5,4); 
```

然后使用：

```
Array::Copy(single_row,0,multi_row,2*4,4); 
```

我希望这有帮助。

最亲切的问候

咕咕

# redis - 将所有排序集分数归零

> ID：15079278
> 
> 赞同：0
> 
> 时间：2013-02-26T00:36:55.133
> 
> 标签：redis

我正在使用 Redis 存储一组校验和。我在解析大型数据集时增加我看到的每个成员，并使用分数来确定我多次“访问”过哪些成员。但是，由于此操作是定期进行的，因此我想之后将所有成员的分数重置为零。有没有这样做的好方法？

我知道 ZRANGEBYSCORE，也许可以将它返回的内容“复制”到新密钥中，但是对于大量数据，这是不太可取的。我也可以在过程开始时取最低分数，然后 ZREMRANGEBYSCORE 一切都等于或低于该分数，但这似乎也是不可取的，因为我的分数会继续无限上升。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-07T17:29:06.237

您可以使用[WEIGHTS](http://redis.io/commands/ZUNIONSTORE)值为零的 ZUNIONSTORE 来复制集合并将所有分数归零，例如

```
ZUNIONSTORE myZeroedSet 1 myInitialSet WEIGHTS 0
RENAME myZeroedSet myInitialSet 
```

权重为零将导致 myInitialSet 中的所有分数都乘以零，从而重置它们。RENAME 将成功，而无需您先明确删除 myInitialSet。

这样做的好处是它发生在 Redis 内部（您不必通过网络传输整个集合并返回），而且速度很快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-01T10:07:56.510

最好和最快的方法是使用一个简单的 LUA 脚本：

```
eval "local z=redis.call('ZRANGE', KEYS[1], 0, -1) for i=1, #z, 1 do redis.call('ZADD', KEYS[1], 0, z[i]) end" 1 myInitialSet 
```

它是原子的，一切都发生在 Redis 内部。

# css - 在 SASS 中访问数组键

> ID：15079280
> 
> 赞同：29
> 
> 时间：2013-02-26T00:37:00.630
> 
> 标签：css, sass

我在 SASS 中有一个列表，我正在尝试使用括号表示法访问这些项目：

```
$collection[1]; 
```

但这给了我一个错误。

有没有其他方法可以做到这一点？

* * *

**我为什么要这样做？**

我有一个必须根据服务器分配给它们的颜色在不同元素上设置的颜色列表。标记有编号的类（`color-0`、`color-1`等）。这是我的目标CSS：

```
.color-0 { color: red }
.color-1 { color: orange }
.color-2 { color: green }
.color-3 { color: blue }
/* many more, with more complex colors... */ 
```

我想我可以使用带有循环的 SASS 集合，而不是全部手动编写：

```
$color-collection: ('red', 'orange', 'green', 'blue');
$color-count: length($color-collection);

@for $i from 0 to $color-count {
    .color-#{$i} {
        color: $color-collection[ $i ];
    }
} 
```

但这只是给了我以下错误：

> 语法错误：“...color-collection”后的 CSS 无效：预期为“;”，为“[ $i ];”

* * *

**我怎样才能做到这一点？**

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-02-26T00:47:51.293

```
$color-collection: ('red', 'orange', 'green', 'blue');

@for $i from 0 to length($color-collection) {
    .color-#{$i} {
        color: unquote(nth($color-collection, $i+1));
    }
} 
```

使用[`nth()`](http://sass-lang.com/docs/yardoc/Sass/Script/Functions.html#nth-instance_method),`unquote()`如果你想传递带引号的字符串。

虽然，我个人不会：

```
$color-collection: (red, rgba(50,50,80, .5), darken(green, 50%), rgba(blue, .5));

@for $i from 0 to length($color-collection) {
    .color-#{$i} {
        color: nth($color-collection, $i+1);
    }
} 
```

因为那时你可以传递任何颜色对象。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-12-09T16:36:22.603

您可以使用`@each`rule 代替`@for`，这更语义化，更快，并且使代码更短：

```
$color-collection: (red, orange, green, blue);

@each $color in $color-collection {
    .color-#{$color} {
        color: $color;
    }
} 
```

或者，如果您愿意，可以`$color-collection`直接在`@each`指令中使用 list ：

```
@each $color in red, orange, green, blue {
    .color-#{$color} {
        color: $color;
    }
} 
```

正如@bookcasey 所说，最好使用不*带引号的字符串*，因为这样您就可以传递任何颜色对象或函数

[@each 指令的 Sass 参考](http://sass-lang.com/documentation/file.SASS_REFERENCE.html#each-directive)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-12-08T05:54:18.140

刚刚遇到这个并测试了 bookcasey 的答案，效果很好，但我想使用颜色名称作为类；我发现这段代码可以按我的需要工作。

```
$colors: ( 'black', 'white', 'red', 'green', 'blue' );

@for $i from 0 to length($colors) {
    $thisColor: unquote(nth($colors, $i+1));
    .color-#{$thisColor} {
        color: $thisColor;
    }
} 
```

使用 #{...} 还允许您使用函数，因此如果您需要使用可能无法在规则中直接使用的任意名称，您可以使用

```
@for $i from 0 to length($colors) {
    .color-#{unquote(nth($colors, $i+1))} {
        // some rules that don't actually use the var
        // so there's no need to cache the var
    }
} 
```

输出：

```
.color-black { color: black; }
.color-white { color: white; }
.color-red { color: red; }
// etc.. 
```

希望这对其他人有帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-10-20T15:58:14.230

我有类似的问题并尝试了 Alex Guerrero 解决方案。对我不起作用，因为输出就像`.color-gray:{gray};`而不是 .`.color-1:{gray};`所以我对其进行了一些修改，它看起来像这样：

```
$color-pallete: (gray, white, red, purple)

$i: 0
@each $color in $color-pallete
    .color-#{$i}
        color: $color
    $i: $i + 1 
```

哦，是的。我使用 SASS，而不是 SCSS。

# kml - 在哪里可以找到北海的 KML 文件？

> ID：15079282
> 
> 赞同：0
> 
> 时间：2013-02-26T00:37:07.567
> 
> 标签：kml

我需要北海的 KML 文件（或类似的文件）。在一个项目组中，我们需要知道导航浮标的放置位置，以便计算海上风电场服务船的路线。

在[http://map.openseamap.org/map/](http://map.openseamap.org/map/)我只发现名为“ONC-NorthSea_GermanCoast12”的地图只能作为图片使用。

而且网站[http://www.freietonne.de/seekarte/](http://www.freietonne.de/seekarte/)似乎没有 OpenSeaMap 的地图那么多的海标。

但我们需要每个浮标的位置作为 WGS84 坐标，例如。是否有任何其他来源或方式来获取这些信息？

**编辑：**

以一条航线为例：

从 53.34N,7.20E 埃姆登港

至 54.01N,6.60E 海上风电场“alpha ventus”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T14:41:33.100

有几种方法可以找到浮标站的位置和标识符。对于互联网用户，显示浮标位置的地图在[http://www.ndbc.noaa.gov/](http://www.ndbc.noaa.gov/)上给出。这提供了一个包括北海的谷歌地图，但页面底部有链接，可以获取 KML 格式的观测数据，其中包括世界范围内一些浮标的列表。这是一个很好的起点。

提供了已部署浮标的[更新列表](http://www.ndbc.noaa.gov/stndesc.shtml)。描述中包括它们的确切纬度/经度位置、水深和系泊的观察半径。

[每周平台状态报告](http://www.ndbc.noaa.gov/wstat.shtml)中提供了 NDBC 系泊浮标和船体配置的更新列表。

还有[http://www.nodc.noaa.gov/BUOY/](http://www.nodc.noaa.gov/BUOY/)

# html - Raphael JS：无法遮盖对象。选择？

> ID：15079284
> 
> 赞同：2
> 
> 时间：2013-02-26T00:37:32.050
> 
> 标签：html, canvas, svg, raphael

我认为 HTML5 的 SVG 会做到这一点。所以我玩了Raphael JS。

我想要的是类似于有一个相框，掩盖底层图片。它需要可扩展。

所以我想用 svg 或类似的东西定义“相框”。然后定义遮罩区域。然后最后根据对象定义下面的图片。

最后，我要为我认为是图片的对象设置动画。

除了使用 Raphael 之外，还有什么类似的方法可以做到这一点？我发现我无法在 Raphael 中定义一个掩码来使用它。我只需要它在 Firefox 和 Chrome 中工作，并且库越简单越好。总的来说，我只希望绘制大约 50 个元素，那么适合的方法呢？（我认为 SVG 是比 2d Canvas 更好的选择）。我不需要鼠标与对象交互。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T10:28:56.057

[SVG 可以做到这一点](http://commons.oreilly.com/wiki/index.php/SVG_Essentials/Clipping_and_Masking)，但 Raphaël 不支持掩码（可能是一些 VML 限制）。但是，支持简单的矩形剪裁，请参阅[Raphaël 文档](http://raphaeljs.com/reference.html#Element.attr)（您想要`clip-rect`，这是 Raphaël 的 svg 的抽象/有限版本`clip-path`）。

可以在[此处](http://xn--dahlstrm-t4a.net/svg/masking/)和[此处](http://xn--dahlstrm-t4a.net/svg/clippath/)找到一些 SVG 中的剪切和遮罩示例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-26T05:08:04.567

Canvas can do what you’re asking.

Just put 2 canvas’ on top of each other. The bottom canvas is the frame. The top canvas (which is smaller than the frame) is the picture. Then you can animate all you want on the picture. If your animation is simple, you might not even need a canvas library to keep track of your drawn elements. Excellent performance too since you’re not having the DOM track your elements as with SVG.

BTW, you could do the same with 1 canvas drawn on top of an SVG frame if you already have your frame drawn in SVG. Actually, you could even use an image for the frame if you wanted.

Here is code and a Fiddle: [http://jsfiddle.net/m1erickson/9Tj3s/](http://jsfiddle.net/m1erickson/9Tj3s/)

```
<!doctype html>
<html>
<head>
<link rel="stylesheet" type="text/css" media="all" href="css/reset.css" /> <!-- reset css -->
<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>

<style>
    body{ background-color: ivory; }
    #container{
      position:relative;
      border:1px solid green;
      width:1380px;
      height:1315px;
    }
    #frame{
      position:absolute;
      top:0px;
      left:0px;
      border:1px solid red;
    }
    #picture{
      position:absolute;
      top:66px;
      left:67px;
      border:1px solid blue;
    }
</style>

<script>
    $(function(){

        var frame=document.getElementById("frame");
        var ctxFrame=frame.getContext("2d");
        var picture=document.getElementById("picture");
        var ctxPicture=picture.getContext("2d");

        var img=new Image();
        img.onload=function(){
            ctxFrame.drawImage(this,0,0,frame.width,frame.height);
        } 
        img.src="http://www.themezoom-neuroeconomics.com/images/5/5e/Golden-frame.jpg";

        var dx= 4;
        var dy=4;
        var y=150;
        var x=10;
        function draw(){
            ctxPicture.clearRect(0,0,243,182);
            ctxPicture.beginPath();
            ctxPicture.fillStyle="#0000ff";
            ctxPicture.arc(x,y,20,0,Math.PI*2,true);
            ctxPicture.closePath();
            ctxPicture.fill();
            if( x<10 || x>225)  dx=-dx;
            if( y<10 || y>160)  dy=-dy;
            x+=dx;
            y+=dy;
          }
        setInterval(draw,60); 

    }); // end $(function(){});
</script>

</head>

<body>
    <div id="container">
        <canvas id="frame" width=380 height=315></canvas>
        <canvas id="picture" width=243 height=182></canvas>
    </div>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-11T11:31:18.847

您可以在这里找到解决方案：http: [//www.codeproject.com/Tips/611648/Applying-a-Custom-Mask-on-an-Image-using-Raphael](http://www.codeproject.com/Tips/611648/Applying-a-Custom-Mask-on-an-Image-using-Raphael)

主要障碍是 img url/atts 作为数据参数传递给“canvas”元素，这是一个糟糕的可访问性问题，因为图像被视为形状填充。它很专业，接受 SVG 样式和过滤器，甚至可以在 IE8++ 中使用！！

不幸的是，需要登录才能下载代码，但 FB/G+ 连接会很快完成这项工作！

# eclipse - Grails / Groovy / GGTS：运行应用程序上的模块版本冲突

> ID：15079286
> 
> 赞同：20
> 
> 时间：2013-02-26T00:37:42.993
> 
> 标签：eclipse, grails

将 Grails 应用程序从 2.2.0 升级到 2.2.1 后，尝试通过 Debug as... -> Grails Command (run-app) 从 GGTS 调试 Grails 应用程序时，我不断收到以下错误：

```
Error starting Grails: nulljava.lang.ExceptionInInitializerError
at org.codehaus.groovy.runtime.InvokerHelper.<clinit>(InvokerHelper.java:62)
at groovy.lang.GroovyObjectSupport.<init>(GroovyObjectSupport.java:32)
at groovy.lang.Closure.<init>(Closure.java:221)
at groovy.lang.Closure.<init>(Closure.java:238)
at groovy.lang.Closure$1.<init>(Closure.java:205)
at groovy.lang.Closure.<clinit>(Closure.java:205)
at org.codehaus.groovy.grails.cli.GrailsScriptRunner.<clinit>(GrailsScriptRunner.java:84)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:601)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.groovy.grails.cli.support.GrailsStarter.rootLoader(GrailsStarter.java:234)
at org.codehaus.groovy.grails.cli.support.GrailsStarter.main(GrailsStarter.java:262)
Caused by: groovy.lang.GroovyRuntimeException: Conflicting module versions. Module [groovy-all is loaded in version 2.0.5 and you are trying to load version 2.0.7
at org.codehaus.groovy.runtime.metaclass.MetaClassRegistryImpl.registerExtensionModuleFromProperties(MetaClassRegistryImpl.java:186)
at org.codehaus.groovy.runtime.metaclass.MetaClassRegistryImpl.registerExtensionModuleFromMetaInf(MetaClassRegistryImpl.java:174)
at org.codehaus.groovy.runtime.metaclass.MetaClassRegistryImpl.registerClasspathModules(MetaClassRegistryImpl.java:156)
at org.codehaus.groovy.runtime.metaclass.MetaClassRegistryImpl.<init>(MetaClassRegistryImpl.java:111)
at org.codehaus.groovy.runtime.metaclass.MetaClassRegistryImpl.<init>(MetaClassRegistryImpl.java:73)
at groovy.lang.GroovySystem.<clinit>(GroovySystem.java:33)
... 14 more 
```

我正在使用 Groovy Compiler 2.0 Feature 2.7.1.xx-20120921-2000-e42RELEASE 和 Groovy/Grails Tool Suite 3.1.0.201210061306-RELEASE-e42 运行 GGTS 3.1.0.RELEASE。该项目已配置 Groovy 编译器级别 2.0。Eclipse 首选项说“您当前使用的是 Groovy 编译器版本 2.0.4.xx-20120921-2000-e42RELEASE”。

有什么提示吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-12-25T14:15:24.420

我在 Ubuntu 机器上的 Grails 2.2.0 上遇到了这个问题，我通过以下步骤修复了它：

1.  打开 Eclipse 转到“运行为”“运行配置”
2.  选择“环境”选项卡，然后选择“用指定环境替换本机环境”

为我解决了这个问题..希望这有帮助

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2013-09-16T07:33:50.617

我遇到了同样的问题，我从 GGTS 中选择了 groovy-all 2.0.7，从我的 grails 项目中选择了 2.0.8。为了解决这个问题，我从 eclipse 项目中删除了“Groovy Dependencies”库。

右键单击项目-> 属性-> Java 构建路径-> 库（选项卡）-> Groovy 依赖项-> 删除

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-01-12T01:45:18.393

手动删除 run-app 运行配置，以便重新创建它。这在 2013 年 8 月 1 日被报告为错误。错误报告：[https ://issuetracker.springsource.com/browse/STS-3501](https://issuetracker.springsource.com/browse/STS-3501)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-06-13T01:52:02.677

我删除了 GGTS 工作区中的 .metadata 并重新导入项目。它有效，我可以再次运行应用程序。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-01-31T15:19:26.810

我遇到了同样的问题，我通过以下方式解决了它：

1.  对于您的项目：打开**运行方式**->**运行配置**
2.  转到**刷新选项卡**
3.  **完成后**检查刷新资源
***   按**运行****

 **这对我有用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-10-15T08:27:25.393

我通过删除在运行配置中手动加载类路径的选项来解决它。它使用了错误的 Grails 版本（2.5.0 而不是 2.5.1）。

基本上使用了错误的类路径。

也许这会让某人走上正确的道路:)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-03-07T13:49:21.833

我有同样的例外，当我试图仅在 Eclipse 中对我的 Spring 引导项目运行 JUnit 测试时，mvn 可以很好地执行它们。我没有使用**Gradle 或 Groovy**。确实在调试时检查测试的类路径，显示了两个版本的 groovy.jar。groovy.jar 的工作版本是从 Eclipse 工作区中的其他项目中挑选出来的。我能够通过从项目属性中的 Workspace 项目中删除**Resolve 依赖项来修复它****- > Maven** [![解决来自 Workspace 项目的依赖关系](../Images/4db5d4b27145260c4b2febe4dfc67ab0.png)](https://i.stack.imgur.com/fqy1P.png)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-27T00:16:29.930

我没有解释为什么它不起作用，但我找到了解决方法。

我为同一个应用程序配置了另一个运行目标，但有一个`-Dgrails.env=...`设置，我可以毫无问题地启动它。我只是复制了这个配置并删除了参数。这样，我基本上重新创建了以前一直失败的简单启动配置。

问题消失了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-22T08:40:14.743

对我来说，从 grails 命令窗口编译就可以了

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-03-22T23:55:03.933

通过 eclipse 运行它时我遇到了同样的问题，对我有用的是进行以下更改 Go to Project properties -> Groovy Compiler ->configure workspace settings 。取消选中复选框“启用检查项目和工作区 groovy 编译器级别之间的不匹配”

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-05-15T22:09:46.757

当我更改 grails 项目的名称时，它可以正常工作。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-09-19T19:34:11.433

当 Eclipse 停止运行我的项目并出现“groovy-all 已加载版本......并且您正在尝试加载版本”错误时，另一个解决方案对我有用。

从 .classpath 中手动删除 groovy-all 行已修复它。

```
<classpathentry kind="lib" path="Libraries/groovy-all-2.1.2.jar"/> 
```

我[在这篇博](http://blog.pdark.de/2014/12/08/groovy-lang-groovyruntimeexception-conflicting-module-versions-module-groovy-all-is-loaded-in-version-2-1-8-and-you-are-trying-to-load-version-2-1-9/)文中找到了解决方案。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-09-30T12:49:39.397

我遇到了同样的问题，我去了`Project properties -> Groovy Compiler ->configure workspace settings`并单击了与错误消息中两个版本之一相对应的“切换到”按钮。我希望这个能帮上忙

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-01-12T18:01:13.673

我知道这是一个 GGTS 问题，但谷歌把我带到了这里，即使几年后这似乎也是一个常见问题，所以我在这里发布这个答案。希望它可以帮助同样登陆这里的其他 STS 用户。

我在使用 Spring Boot 版本 1.3.3.RELEASE 和 gradle 版本 2.14 时遇到了 Spring Tool Suite 的这个问题。对 groovy 2.4.6 和 groovy-all 2.4.6 有一些内部依赖，但我的 Eclipse 工作区 Groovy 库是 2.4.7 版。从 Spring/Gradle 项目属性中删除 Groovy 库适用于运行这些项目，但对于工作区中的其他 Groovy 项目，您将陷入困境。如果在“项目中存在错误。仍然运行？”时单击“是”，它们将运行。如果您从属性构建路径中删除 Groovy 库，或者如果您将 Groovy 库放在属性构建路径中，它们将不会出现项目错误。

通过在工作区中的 Gradle 项目的 groovy 2.4.7 和 groovy-all 2.4.7 上的 build.gradle 中添加显式依赖项来解决

```
compile('org.codehaus.groovy:groovy:2.4.7')
compile('org.codehaus.groovy:groovy-all:2.4.7') 
```

和（关闭 Eclipse STS）然后从 .gradle 缓存中删除 2.4.6 文件夹

```
<path to>\.gradle\caches\modules-2\files-2.1\org.codehaus.groovy\groovy\2.4.6
<path to>\.gradle\caches\modules-2\files-2.1\org.codehaus.groovy\groovy-all\2.4.6 
```

和（打开 STS）然后右键单击 gradle project(s)>gradle>refresh gradle project

现在工作区中的其他 Groovy 项目运行时不会出现 2.4.6 与 2.4.7 的冲突。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-06-30T09:36:34.767

使用 mvn denpendency:tree 检查您的依赖关系，可能存在版本冲突。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-08-04T12:32:10.560

目前（使用 Eclipse 2020-06, 4.16.0）以上解决方案都不再起作用。

1.  打开 groovy 脚本的运行配置
2.  从 Classpath 选项卡中删除所有用户条目
3.  按“恢复默认条目”

这应该将包含您指定的 Groovy 版本的默认类路径添加为用户条目。**

# macos - 目录 bb101repo-practice 在哪里

> ID：15079287
> 
> 赞同：4
> 
> 时间：2013-02-26T00:37:50.970
> 
> 标签：macos, git

我正在按照 Atlassian 教程配置我的本地系统和 Gitbucket 以协同工作。On`Step 7`指令显示`"[Go] to a terminal on your local system and navigate to your bb101repo-pratice repo. Then, do the following for Git and Mercurial:"`

的路径是`bb101repo-pratice repo`什么？我没有跳过任何步骤，所以我知道我没有错过任何关于如何创建这样一个目录的说明。我进行了搜索`This Mac`，但没有任何显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T08:09:32.230

该存储库最初称为“ **`bb101repo`**”，在“[创建帐户和 Git 存储库](https://confluence.atlassian.com/display/BITBUCKET/Create+an+Account+and+a+Git+Repo)”帮助页面中有描述。

> 单击页面上的`Repositories > Create repository`或`Create a repo`按钮。
> 系统显示`Create new repository`页面。
> 花一些时间查看对话框的内容。除了存储库类型之外，您在此页面上输入的所有内容都可以稍后更改。
> 
> 在名称字段中输入 bb101repo。

克隆[帮助页面](https://confluence.atlassian.com/display/BITBUCKET/Clone+Your+Git+Repo+and+Add+Source+Files)或[SSH 设置页面](https://confluence.atlassian.com/display/BITBUCKET/Set+up+SSH+for+Git)显示其 GUI：

![bb101回购](../Images/07b925479816c414378da41dde99e523.png)

您会发现它被其他名称引用，例如**`bb101practice`**（在[分支页面](https://confluence.atlassian.com/display/BITBUCKET/Branching+a+Repository)中）。

这个想法是让您获取您最初在 101 个步骤中创建的存储库（使用您当时给它的任何名称）

# canvas - 调用画布不起作用

> ID：15079288
> 
> 赞同：-1
> 
> 时间：2013-02-26T00:38:03.643
> 
> 标签：canvas, html5-canvas

你好我正在尝试制作一个简单的画布

```
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <script type="text/javascript" src="java.js">
    </script>

</head>

<body >
    <section id="main">
        <canvas id="myCanvas" width="578" height="200"></canvas>
    </section>

</body>
</html> 
```

java.js：

```
function doFirst(){
      var canvas = document.getElementById('myCanvas');
      var context = canvas.getContext('2d');
      context.rect(188, 50, 200, 100);
      context.stroke(); 

} 
```

如果它`onload="First()"`在 body 属性中被调用，它会起作用，但如果它 `window.addEventListener("load", doFirst, false);`在 JS 中被调用，它就不起作用。为什么 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T00:40:48.723

我想你的意思是

```
window.addEventListener("load", doFirst, false); 
```

您正在执行的方式`doFirst`是立即调用该函数，并将其结果 ( `undefined`) 作为`addEventListener`.

# three.js - Three.js 中 Object3D.updateMatrix() 的逆？

> ID：15079294
> 
> 赞同：0
> 
> 时间：2013-02-26T00:38:46.520
> 
> 标签：three.js

如果我做对了：an`Object3D`一方面具有一组属性`(position, scale, rotation)`[*]，另一方面具有`matrix`- 这稍后包含基本上相同的信息，它是从其他信息中计算出来的，`Object3D.updateMatrix()`并且是渲染器计算在内部真正使用的信息. 相反，该集合`(position, scale, rotation)`是通常由程序员操作的集合（平移、旋转……）。

然而，有时，人们直接操作`matrix`，并且，更进一步，而不是设置`matrixAutoUpdate=false`和忘记`(position, scale, rotation)`，人们希望保持属性同步，即做做`Object3D.updateMatrix()`但在另一个方向上做的事情。是否有一些实施/有效/推荐的程序来完成此任务？

[*] 注意事项： 1) 如果使用`useQuaternion=true`,`quaternion`代替`rotation` 2)`rotation`补充`eulerOrder` 3) 我不确定`up`在这张图片中扮演什么角色，我想这在这里并不重要。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T01:28:37.000

`applyMatrix(matrix)`您可以在 3D 对象上调用该方法。要查看它的作用，请参见[此处](https://github.com/mrdoob/three.js/blob/master/src/core/Object3D.js)。

任何一个：

1）你可以给它一个单位矩阵，或者

2）你可以复制函数的作用：

```
this.scale.getScaleFromMatrix( this.matrix );
var mat = new THREE.Matrix4().extractRotation( this.matrix );
this.rotation.setEulerFromRotationMatrix( mat, this.eulerOrder );
this.position.getPositionFromMatrix( this.matrix ); 
```

如果您执行上述操作，我不确定四元数的相关性，我不知道 useQuaternion 标志设置为 true 的情况。但在 Object3D 对象中默认为 false。我有一种感觉，它仅在计算某些旋转时才使用四元数，以避免万向节锁定。

我认为从该`lookAt()`方法中获取的以下代码将更新四元数：

```
this.quaternion.copy( this.matrix.decompose()[ 1 ] ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T01:38:31.857

例行公事

```
Matrix4.decompose( position, quaternion, scale ) // revision 57dev 
```

将从矩阵计算`position`、`quaternion`和`scale`向量。

（不幸的是，在 r.56 中，arg 名称被错误地命名，这已在 r.57dev 中得到修复。）

如果您想要`rotation`向量，则必须从刚刚计算的数据中计算它，`quaternion`如下所示：

```
rotation.setEulerFromQuaternion( quaternion, eulerOrder ); 
```

该`up`向量与您的问题无关。

# actionscript-3 - Actionscript3 中的文本字段

> ID：15079296
> 
> 赞同：0
> 
> 时间：2013-02-26T00:38:57.383
> 
> 标签：actionscript-3, text

我正在尝试仅从动作脚本手动创建一个文本字段。我得到了它的一部分，但现在我不知道如何给出字体大小和不同的字体有人可以告诉我该怎么做吗？

```
for (var i:Number = 0; i < weekdaystringArray.length ; i++) 
{
weekdaystring.text = weekdaystringArray [i];
weekdaystring.x = 150;
weekdaystring.y = 994;
addChild (weekdaystring);
weekdaystring.textColor = 0xFFFFFF;

} 
```

这是我目前所拥有的......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T00:58:49.833

您需要使用[setTextFormat()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/text/TextField.html#setTextFormat%28%29)方法将[TextFormat](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/text/TextFormat.html)应用于 TextField 。

```
var format:TextFormat = new TextFormat();
format.font = "Courier";
format.size = 24;
// then inside your loop:
weekdaystring.setTextFormat(format); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-21T02:17:06.963

它需要将 TextFormat 应用于 TextFiled

```
var format:TextFormat = weekdaystring.defaultTextFormat;
format.font = "courier";
format.size = 24
weekdaystring.defaultTextFormat = format; 
```

# installation - 安装 WSO2 Developer Studio 失败

> ID：15079300
> 
> 赞同：0
> 
> 时间：2013-02-26T00:39:25.327
> 
> 标签：installation, wso2, wso2developerstudio

我使用离线步骤集完成了安装 WSO2 Developer studio 的安装步骤。我完成了安装，但是当我尝试在 eclipse 中打开任何 wso2 透视图时，我收到如下错误：

```
eclipse.buildId=I20110613-1736
java.version=1.6.0_29
java.vendor=Apple Inc.
BootLoader constants: OS=macosx, ARCH=x86_64, WS=cocoa, NL=en_US
Framework arguments:  -product org.eclipse.epp.package.javascript.product -keyring /Users/sowens/.eclipse_keyring -showlocation
Command-line arguments:  -os macosx -ws cocoa -arch x86_64 -product org.eclipse.epp.package.javascript.product -keyring /Users/sowens/.eclipse_keyring -showlocation

Error
Mon Feb 25 16:30:26 PST 2013
Unable to create view ID org.eclipse.ui.navigator.ProjectExplorer: An unexpected exception was thrown.

java.lang.NullPointerException
    at org.wso2.developerstudio.eclipse.platform.ui.provider.FilterNestedProjects.getPathList(FilterNestedProjects.java:54)
    at org.wso2.developerstudio.eclipse.platform.ui.provider.FilterNestedProjects.select(FilterNestedProjects.java:35)
    at org.eclipse.jface.viewers.ViewerFilter.filter(ViewerFilter.java:51)
    at org.eclipse.jface.viewers.StructuredViewer.getFilteredChildren(StructuredViewer.java:921)
    at org.eclipse.jface.viewers.AbstractTreeViewer.getSortedChildren(AbstractTreeViewer.java:605)
    at org.eclipse.jface.viewers.AbstractTreeViewer$1.run(AbstractTreeViewer.java:805)
    at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70)
    at org.eclipse.jface.viewers.AbstractTreeViewer.createChildren(AbstractTreeViewer.java:782)
    at org.eclipse.jface.viewers.TreeViewer.createChildren(TreeViewer.java:644)
    at org.eclipse.jface.viewers.AbstractTreeViewer.createChildren(AbstractTreeViewer.java:753)
    at org.eclipse.jface.viewers.AbstractTreeViewer.internalInitializeTree(AbstractTreeViewer.java:1533)
    at org.eclipse.jface.viewers.TreeViewer.internalInitializeTree(TreeViewer.java:833)
    at org.eclipse.jface.viewers.AbstractTreeViewer$5.run(AbstractTreeViewer.java:1517)
    at org.eclipse.jface.viewers.StructuredViewer.preservingSelection(StructuredViewer.java:1443)
    at org.eclipse.jface.viewers.TreeViewer.preservingSelection(TreeViewer.java:403)
    at org.eclipse.jface.viewers.StructuredViewer.preservingSelection(StructuredViewer.java:1404)
    at org.eclipse.jface.viewers.AbstractTreeViewer.inputChanged(AbstractTreeViewer.java:1510)
    at org.eclipse.jface.viewers.ContentViewer.setInput(ContentViewer.java:280)
    at org.eclipse.jface.viewers.StructuredViewer.setInput(StructuredViewer.java:1690)
    at org.eclipse.ui.navigator.CommonNavigator.createPartControl(CommonNavigator.java:212)
    at org.eclipse.ui.navigator.resources.ProjectExplorer.createPartControl(ProjectExplorer.java:75)
    at org.eclipse.ui.internal.ViewReference.createPartHelper(ViewReference.java:375)
    at org.eclipse.ui.internal.ViewReference.createPart(ViewReference.java:229)
    at org.eclipse.ui.internal.WorkbenchPartReference.getPart(WorkbenchPartReference.java:595)
    at org.eclipse.ui.internal.PartPane.setVisible(PartPane.java:313)
    at org.eclipse.ui.internal.ViewPane.setVisible(ViewPane.java:534)
    at org.eclipse.ui.internal.presentations.PresentablePart.setVisible(PresentablePart.java:180)
    at org.eclipse.ui.internal.presentations.util.PresentablePartFolder.select(PresentablePartFolder.java:270)
    at org.eclipse.ui.internal.presentations.util.LeftToRightTabOrder.select(LeftToRightTabOrder.java:65)
    at org.eclipse.ui.internal.presentations.util.TabbedStackPresentation.selectPart(TabbedStackPresentation.java:473)
    at org.eclipse.ui.internal.PartStack.refreshPresentationSelection(PartStack.java:1245)
    at org.eclipse.ui.internal.PartStack.setSelection(PartStack.java:1198)
    at org.eclipse.ui.internal.PartStack.showPart(PartStack.java:1597)
    at org.eclipse.ui.internal.PartStack.createControl(PartStack.java:643)
    at org.eclipse.ui.internal.PartStack.createControl(PartStack.java:570)
    at org.eclipse.ui.internal.PartSashContainer.createControl(PartSashContainer.java:568)
    at org.eclipse.ui.internal.PerspectiveHelper.activate(PerspectiveHelper.java:272)
    at org.eclipse.ui.internal.Perspective.onActivate(Perspective.java:981)
    at org.eclipse.ui.internal.WorkbenchPage.setPerspective(WorkbenchPage.java:3713)
    at org.eclipse.ui.internal.WorkbenchPage.busySetPerspective(WorkbenchPage.java:1115)
    at org.eclipse.ui.internal.WorkbenchPage.access$16(WorkbenchPage.java:1099)
    at org.eclipse.ui.internal.WorkbenchPage$19.run(WorkbenchPage.java:3814)
    at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70)
    at org.eclipse.ui.internal.WorkbenchPage.setPerspective(WorkbenchPage.java:3812)
    at org.eclipse.ui.handlers.ShowPerspectiveHandler.openPerspective(ShowPerspectiveHandler.java:146)
    at org.eclipse.ui.handlers.ShowPerspectiveHandler.openOther(ShowPerspectiveHandler.java:118)
    at org.eclipse.ui.handlers.ShowPerspectiveHandler.execute(ShowPerspectiveHandler.java:57)
    at org.eclipse.ui.internal.handlers.HandlerProxy.execute(HandlerProxy.java:293)
    at org.eclipse.core.commands.Command.executeWithChecks(Command.java:476)
    at org.eclipse.ui.internal.handlers.HandlerService.executeCommand(HandlerService.java:178)
    at org.eclipse.ui.internal.handlers.SlaveHandlerService.executeCommand(SlaveHandlerService.java:247)
    at org.eclipse.ui.actions.PerspectiveMenu.runOther(PerspectiveMenu.java:376)
    at org.eclipse.ui.actions.PerspectiveMenu$3.runWithEvent(PerspectiveMenu.java:130)
    at org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:584)
    at org.eclipse.jface.action.ActionContributionItem.access$2(ActionContributionItem.java:501)
    at org.eclipse.jface.action.ActionContributionItem$5.handleEvent(ActionContributionItem.java:411)
    at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)
    at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4125)
    at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1457)
    at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1480)
    at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1465)
    at org.eclipse.swt.widgets.Widget.notifyListeners(Widget.java:1270)
    at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3971)
    at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3610)
    at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2696)
    at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2660)
    at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2494)
    at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:674)
    at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)
    at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:667)
    at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)
    at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:123)
    at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:344)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:622)
    at org.eclipse.equinox.launcher.Main.basicRun(Main.java:577)
    at org.eclipse.equinox.launcher.Main.run(Main.java:1410) 
```

对出了什么问题有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T10:17:32.520

我们已经分析了这个特定的代码段，但它似乎没有能力从那里生成 NPE。

因此，我们相信这个 NPE 可能隐藏了真正的原因并抛出了这个异常。

但是，对于即将发布的 Developer Studio 3.0.0 版本，我们已经对这个特定类进行了一些性能改进。

[您可以从此处](http://builder1.us1.wso2.org/~developerstudio/developer-studio/3.0.0/RC1/wso2-developer-studio_3.0.0.zip)下载 Developer Studio 3.0.0 RC1 预览版 P2 存储库，看看您的问题是否仍然存在。

在启动 Eclipse 实例之前，请确保您的 Eclipse 工作区位置具有必要的文件系统权限。

/哈莎娜

# java - 使用 Java 加快对 MySQL 的查询调用

> ID：15079301
> 
> 赞同：1
> 
> 时间：2013-02-26T00:39:28.530
> 
> 标签：java, mysql, database, jdbc

我正在解析一个由 ~600K 行组成的 XML 文件。解析 XML 中的数据并将其插入数据库不是问题，因为我使用 SAX 解析并使用 LOAD DATA INFILE（来自 .txt 文件）插入数据库。txt 文件使用 JDBC 在 Java 中填充。所有这些都需要 5 秒钟才能填充到数据库中。

我的瓶颈现在正在执行多个 SELECT 查询。基本上，每次我点击某个 XML 标记时，我都会调用 SELECT 查询从另一个数据库表中获取数据。添加这些 SELECT 查询使我的填充时间达到 2 分钟。

例如：

1.  我正在解析一个由书籍、文章、论文等组成的 XML。
2.  每本书/文章都有子元素，例如 isbn、标题、作者、编辑、出版商。
3.  在每个作者/编辑/出版商处，我需要查询数据库中的一个表。
4.  假设我遇到了价值托尔金的作者标签。
5.  我需要查询数据库中已经存在的名为 author_table 的表
6.  查询是 [select author_id from author_table where name = 'Tolkien']

这就是瓶颈发生的地方。

现在我的问题是：有没有办法加快速度？

顺便说一句，我认为 2 分钟很长的原因是因为这是一个家庭作业，我还没有完成填充数据库。我估计整个数据库人口需要 5 分钟。因此，我寻求性能优化建议的原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T01:17:42.053

您可以考虑以下几点：

*   使用[连接池](http://docs.oracle.com/javaee/6/tutorial/doc/bncjj.html)，这样您就不会在每次执行查询时创建/关闭新连接。这样做很昂贵
*   缓存您通过 SELECT 查询获得的任何数据。是否可以预先预取所有数据，这样您就不必在现场查询它们？
*   如果您的 SELECT 很慢，请确保查询已优化并且您有适当的索引以避免扫描整个表
*   确保[在 Java 中使用缓冲 IO](http://docs.oracle.com/javase/tutorial/essential/io/buffers.html)
*   你能把工作细分成多个线程吗？如果是这样，请创建多个工作线程以并行执行您的工作的多个实例

# google-apps-script - 按登录帐户过滤电子表格 Google Apps 脚本

> ID：15079302
> 
> 赞同：0
> 
> 时间：2013-02-26T00:39:30.313
> 
> 标签：google-apps-script, google-sheets

我想创建一个脚本以在 Ui SplitLayoutPanel 中显示基于登录 Google 的用户的电子表格中的数据。直到现在我写了这样的东西：

```
function doGet() {
  var app = UiApp.createApplication();
  var sPanel = app.createSplitLayoutPanel();
  sPanel.addWest(app.createLabel('Hierarchy'), 100);
  var handler=app.createClientHandler("MyHierarchy");
  handler
  sPanel.addNorth(app.createLabel('List of my Hierarchy'), 200);
  sPanel.add(app.createLabel('Timesheet'));
  sPanel.setHeight('100%').setWidth('100%');
  app.add(sPanel);
  return app;
}

function MyHierarchy() {
  var app = UiApp.createApplication();
  var ss=SpreadsheetApp.openById("id_of_the_Spreadsheet")
  var user=Session.getActiveUser().getEmail();
  return app;
} 
```

在电子表格中，我将列出员工及其各自的经理（以及他们的 Google Apps 电子邮件帐户）。我想根据该经理的电子邮件过滤数据。关于我该如何继续的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:34:22.930

好吧，这只是一个简单的查找，你会想把它写在一个单独的函数中。我将向您抛出一些模拟代码以帮助您入门。

```
function getEmployeesUnder(manager) {
  var employees = [];
  var sheet = SpreadsheetApp.openById("YOUR SHEET ID").getSheetByName("Your sheet name");
  var values = sheet.getDataRange().getValues();
  for (var i in values) {
    if (values[i][1] == manager) {
      employees.push(values[i][0]);
    }
  }
  return employees;
} 
```

这假设经理在第二列，员工在第一列。

如何显示这些数据完全由您决定。

# ruby-on-rails - 无法在 Rails 应用程序上创建 ruby

> ID：15079306
> 
> 赞同：1
> 
> 时间：2013-02-26T00:39:54.140
> 
> 标签：ruby-on-rails

我只是按照这里所说的在rails上安装ruby的每一步[http://rubyonrails.org/download](http://rubyonrails.org/download)但是我不能成功地创建一个rails项目。这正是我所做的：

1.  使用 windows installer v2.0.0-p0 x64 安装 ruby​​（我正在运行 W8 pro）
2.  使用以下过程安装 RubyGems：
    1.  从网页下载了你的 .zip 文件
    2.  将文件夹解压缩到 C 中的 Ruby200-x64 文件夹中：
    3.  执行“setup.rb”文件
3.  按照以下步骤安装 Rails：
    1.  打开一个CMD并放`gem install rails`

但是当我尝试通过命令“创建应用程序骨架”时

```
rails new C:\Users\Andrés\Desktop\Mediplan 
```

我得到以下信息：

```
C:/Ruby200-x64/lib/ruby/gems/2.0.0/gems/railties-3.2.12/lib/rails/generators/app_base-rb:100:in 'expand_path' : incompatible character encodings: CP850 and UTF-8 <Encoding::CompatibilityError> 
```

有人知道解决这个问题吗？（如果需要更多信息，请告诉我）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T02:31:36.797

可能是由于`é`在`Andrés`. 尝试将路径更改为`Desktop`第一个，然后创建 Rails 应用程序。试试这个：

```
cd C:\Users\Andrés\Desktop
rails new Mediplan 
```

# php - 在这种情况下如何使用 PHP (http://my_host_here.com/publications.php/"> alert(1)) 防止 javascript？

> ID：15079308
> 
> 赞同：-1
> 
> 时间：2013-02-26T00:40:00.567
> 
> 标签：php, javascript, sql-injection

我已经尝试了下面的代码，但似乎在将 http 请求发送到服务器之前运行了 javascript。

谢谢

```
<?php

class secure
{
    function secureSuperGlobalGET(&$value, $key)
    {
        $_GET[$key] = htmlspecialchars(stripslashes($_GET[$key]));
        $_GET[$key] = str_ireplace("script", "blocked", $_GET[$key]);
        $_GET[$key] = mysql_escape_string($_GET[$key]);
        return $_GET[$key];
    }

    function secureSuperGlobalPOST(&$value, $key)
    {
        $_POST[$key] = htmlspecialchars(stripslashes($_POST[$key]));
        $_POST[$key] = str_ireplace("script", "blocked", $_POST[$key]);
        $_POST[$key] = mysql_escape_string($_POST[$key]);
        return $_POST[$key];
    }

    function secureGlobals()
    {
        echo "in here";
        array_walk($_GET, array($this, 'secureSuperGlobalGET'));
        array_walk($_POST, array($this, 'secureSuperGlobalPOST'));
    }
}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T03:27:29.810

如果 Javascript 在代码返回服务器之前运行，那么这很可能是某种形式的基于 DOM 的 XSS。Javascript 可能会提取 的值`/"><script>alert(1)</script>`并将其直接放入 DOM。您可能必须更改在客户端处理此问题的方式。

OWASP 对如何防御基于 DOM 的跨站点脚本攻击进行了精彩的概述，例如：[https ://www.owasp.org/index.php/DOM_based_XSS_Prevention_Cheat_Sheet](https://www.owasp.org/index.php/DOM_based_XSS_Prevention_Cheat_Sheet)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T09:07:20.843

1.  摆脱你的班级“安全”
2.  `mysql_[real_]escape_string` **仅**用于**作为带引号的字符串**进入 SQL 查询的值
***   其他任何 SQL 部分都必须根据它们的角色进行格式化。*   在组装查询之前格式化 SQL 部分，而不是在其他任何地方。*   或更好地为此使用占位符**

 **最后，回答您的问题：在回显用户提交的值时使用 htmlspecialchars() 。**

# php - 在实现其主要功能之后在 Web 应用程序中实现安全性是否合理？

> ID：15079309
> 
> 赞同：2
> 
> 时间：2013-02-26T00:40:01.440
> 
> 标签：php, security, xss, csrf, methodology

如果这看起来太模糊而无法在 Stackoverflow 上发布，请原谅。

我的公司聘请了三位开发人员来实施分类广告系统，使用 PHP 和 MySQL。他们已经工作了一个多月，没有使用框架（他们反对使用框架），并且已经实现了基本功能（用户注册和身份验证、广告列表和过滤等）。然而，粗略的测试表明，该系统容易受到常见恶意攻击（CSRF、XSS、本地文件包含）的攻击。

在检查了代码之后，我意识到他们没有在服务器端实现数据验证程序（他们只是使用正则表达式来验证邮件地址，并使用 mysqli_real_escape_string() 来清理字符串以防止 SQL 注入）。他们实现了一些验证例程，但在客户端，使用 JavaScript。显然，这是 UI 的一部分，不提供任何针对恶意用户的安全措施。

他们争辩说，由于三个开发人员不足以从头开始开发一个完整的 web 应用程序（我同意），他们将首先实现功能，然后正确地保护它们，以满足某些期限。无论如何，我都不是经验丰富的程序员，但我相信实现安全性需要更长*的*时间。此外，如果他们设法以某种方式做到这一点，与从一开始就实施的数据清理例程相比，这将是低于标准的。

所以，我的问题是：（i）在实现功能之后实现安全性（即，至少实现适当的清理程序）是否合理？(ii) 如果 (i) 的答案是“否”，您会推荐哪些参考书目、安全框架（但我猜它们本身就嵌入在 Web 框架中）等来管理安全处理不当的项目？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T00:45:53.493

以后再实施安全确实不合理。

它可能不需要更长的时间或低于标准，它可能会更快更好。问题是它可能根本不会完成，因为项目会延迟并且超出预算。

我对不使用框架的决定感到惊讶，这看起来像是使用 Rails、Symfony 或 Django 完成的 1 人周工作，而且安全性会被考虑在内。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-26T01:17:31.263

不，由于多种原因，在项目完成后实施安全性是不可接受的。首先，正如已经提到的，当他们已经拥有他们想要的产品时，无论是谁买单，都不太可能继续支付实施安全功能的费用。第二个原因是，与第一次正确编码并在编写代码时实施任何安全措施相比，他们将花费更长的时间来尝试找到所有安全漏洞。这样做也更容易，因为您可以编写安全库来为您执行诸如转义数据之类的事情，以便通过对转义函数/方法的简单调用来编写代码变得流畅。第三个原因是因为他们绝对不可能通过回顾代码找到所有漏洞。编写没有安全漏洞的代码已经足够困难（几乎不可能），更不用说回过头来找到所有这些安全漏洞了。

至于建议的框架，我真的没有，因为我也从未使用过框架，只有我过去编写的库可以使用。然而，这归结为只是找到优秀的开发人员，而不是那些说他们可以以超低的价格完成它的人。PHP 开发人员池充满了这些半途而废的开发人员，我想说他们中的相当一部分人更喜欢预制框架。诀窍是从一开始就找到一些好的。要保护这样写得不好的应用程序，您真正拥有的唯一选择是获取 WAF（Web 应用程序防火墙）并让它过滤任何发送到服务器的恶意内容。尽管对于编写不佳的代码来说，这不是灵丹妙药。我什至不会称它为创可贴，更像是冰雹。

最后一件事是我非常不同意他们写这篇文章的人手不足。4 年前我自己在不到 3 个月的时间里写了类似的东西（好吧，有一个 html 人）。这 3 个月中的两个完全重写了部分，因为一旦完成，客户就会改变主意，加上写一些侧面功能，使其更像是一个社交网络，而不是一个分类网站。如果我能在这段时间内自己完成大部分工作，他们应该可以在 3 个人的一个半月内轻松完成（并确保安全）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-26T00:51:32.880

在开发阶段应始终考虑安全性，如果它被过度观察/忽视，则应在第一个可用实例上构建对开发中 API 的改进。

您要做的最后一件事是向公众发布一个脚本，该脚本在其代码结构中存在许多安全/恶意漏洞。

因此，我建议通知这些开发人员检查他们的工作并对已经制作的 API 进行适当的更改以提高安全性。

如果安全方面被忽视并且没有修改，该项目可能会延迟完成并且超出预算。最好在为时已晚之前解决这个问题（当您已经发布到公共交通并且面临比预期更长的停机时间时）

总体点..在它成为一个严重的问题之前把它钉在屁股上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T01:30:15.873

在开发的后期处理安全问题并没有什么不合理，只要只是实现的问题，而不是设计的根本缺陷。没有“更安全”或“更不安全”之类的东西。系统要么是安全的，要么不是。必须将应用程序的行为作为一个整体来考虑。因此，在代码库仍在不断变化时处理安全性并不是那么有利可图。虽然说安全应该是整个开发过程不可或缺的一部分是一种时髦的说法，但在资源有限的世界中，这种方法更多的是学术而非实用。在交付之前有足够的时间进行质量保证很可能会产生更好的回报。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-26T13:37:07.543

只是为了添加其他人的建议，您必须从第一天开始就接受安全性。

不这样做只会容易出现代码中的错误和错误。

查看 Microsoft 安全开发生命周期：

[http://www.microsoft.com/security/sdl/default.aspx](http://www.microsoft.com/security/sdl/default.aspx)

另外，我建议您查看代码/对其进行渗透测试以识别任何潜在问题。

谢谢法比奥@fcerullo

# mysql - 3张桌子的总数量

> ID：15079310
> 
> 赞同：0
> 
> 时间：2013-02-26T00:40:12.163
> 
> 标签：mysql

下面的视图没有返回正确的结果。我正在尝试获取按 Plan_Id 和 PartNum 分组的 Picked、Printed 和 Scanned 的总和。无论子表中是否有相应的记录，我都需要返回正确的总数。如果我使用三个不同的视图并加入它们，我知道该怎么做，但是我如何在一个视图中完成所有操作？任何帮助表示赞赏。

```
SELECT
    `prod_plan`.`Prp_ProdPlanId` AS `PlanId`,
    `prod_plan`.`Prp_PartNum` AS `PartNum`,
    sum(`prod_plan`.`Prp_Picked`) AS `Picked`,
    sum(`printed`.`PtQty`) AS `Printed`,
    sum(`scanned`.`PtQty`) AS `Scanned`
FROM
    (
        (
            `prod_plan`
            LEFT JOIN `product_trans` `printed` ON (
                (
                    (
                        `printed`.`PtPlanId` = `prod_plan`.`Prp_ProdPlanId`
                    )
                    AND (
                        `printed`.`PtPartNum` = `prod_plan`.`Prp_PartNum`
                    )
                )
            )
        )
            LEFT JOIN `product_trans` `scanned` ON (
            (
            (
                `scanned`.`PtPlanId` = `prod_plan`.`Prp_ProdPlanId`
            )
            AND (
                `scanned`.`PtPartNum` = `prod_plan`.`Prp_PartNum`
            )
        )
    )
)
WHERE
    (
        (
            `printed`.`PtPart` = 'Barcode Print'
        )
        AND (
            `scanned`.`PtPart` = 'Barcode Scan'
        )
    )
GROUP BY
    `prod_plan`.`Prp_ProdPlanId`,
    `prod_plan`.`Prp_PartNum` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T01:01:04.777

您需要检查`PtPart`条款`ON`。否则，您将不会在子表中获得不匹配的行，因为这些列将是`NULL`.

```
SELECT
    `prod_plan`.`Prp_ProdPlanId` AS `PlanId`,
    `prod_plan`.`Prp_PartNum` AS `PartNum`,
    sum(`prod_plan`.`Prp_Picked`) AS `Picked`,
    sum(`printed`.`PtQty`) AS `Printed`,
    sum(`scanned`.`PtQty`) AS `Scanned`
FROM `prod_plan`
LEFT JOIN `product_trans` `printed`
ON `printed`.`PtPlanId` = `prod_plan`.`Prp_ProdPlanId`
    AND `printed`.`PtPartNum` = `prod_plan`.`Prp_PartNum`
    AND `printed`.`PtPart` = 'Barcode Print'
LEFT JOIN `product_trans` `scanned`
ON `scanned`.`PtPlanId` = `prod_plan`.`Prp_ProdPlanId`
    AND `scanned`.`PtPartNum` = `prod_plan`.`Prp_PartNum`
    AND `scanned`.`PtPart` = 'Barcode Scan'
GROUP BY
    `prod_plan`.`Prp_ProdPlanId`,
    `prod_plan`.`Prp_PartNum` 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T15:44:34.857

这是我所做的。以下是正常工作的 3 个视图。

v_trans_printed：

```
SELECT
product_trans.PtPlanId AS PlanId,
product_trans.PtLot AS Lot,
product_trans.PtPartNum AS PartNum,
Sum(product_trans.PtQty) AS Printed
FROM
product_trans
WHERE
product_trans.PtPart = 'Barcode Print'
GROUP BY
product_trans.PtPlanId,
product_trans.PtLot,
product_trans.PtPartNum 
```

v_trans_scanned：

```
SELECT
product_trans.PtPlanId AS PlanId,
product_trans.PtLot AS Lot,
product_trans.PtPartNum AS PartNum,
Sum(product_trans.PtQty) AS Scanned
FROM
product_trans
WHERE
product_trans.PtPart = 'Barcode Scan'
GROUP BY
product_trans.PtPlanId,
product_trans.PtLot,
product_trans.PtPartNum 
```

在这里，我把它们放在一起。这将返回正确的结果：

```
vSELECT
prod_plan.Prp_ProdPlanId AS PlanId,
prod_plan.Prp_Lot AS Lot,
prod_plan.Prp_PartNum AS PartNum,
Sum(prod_plan.Prp_Picked) AS Picked,
Printed.Printed AS Printed,
Scanned.Scanned AS Scanned
FROM
prod_plan
LEFT JOIN v_trans_printed AS Printed ON Printed.PlanId = prod_plan.Prp_ProdPlanId AND Printed.Lot = prod_plan.Prp_Lot AND Printed.PartNum = prod_plan.Prp_PartNum
LEFT JOIN v_trans_scanned AS Scanned ON Scanned.PlanId = prod_plan.Prp_ProdPlanId AND Scanned.Lot = prod_plan.Prp_Lot AND Scanned.PartNum = prod_plan.Prp_PartNum
GROUP BY
prod_plan.Prp_ProdPlanId,
prod_plan.Prp_Lot,
prod_plan.Prp_PartNum 
```

## 但如果我可以使用一种视图会更好。

注意：我最初无意中遗漏了Lot。但这并不影响结果w。样本数据集。

# json - 如何通过带有身份验证和自签名 SSL 的 HTTP 使用 RCurl 或 RMongo 来读取 JSON 数据

> ID：15079321
> 
> 赞同：0
> 
> 时间：2013-02-26T00:40:55.387
> 
> 标签：json, r, mongodb, rcurl, rmongo

我正在使用 R 编写程序并执行一些分析。数据由外部供应商使用 MongoDB 以 JSON 格式捕获。他们通过端口 443 上的 URI 向我提供它，他们希望我使用 cURL 进行查询。他们有适当的身份验证和自签名 SSL。

我可以在 Windows 中通过 curl 进行身份验证和转储数据，但是要创建一个长期可持续的解决方案，这一切都需要在 R 中完成。

供应商说 RCurl“应该”工作，但他们没有提供任何支持，他们基本上只是不喜欢使用 RMongo 的想法并且没有对此发表评论（但如果我们能让它工作，那就太棒了，在我的意见）。

我加载了以下包 - ggplot2 - DBI - rjson - RJSONIO（如果我使用 rjson，有时我不会加载这个包，反之亦然） - RMongo - rstudio - RCurl

即使使用 curl，自签名证书也会导致问题，但通过在 Ruby 中编辑设置，然后使用 Ruby 启动 cmd shell 并以这种方式使用 curl 来解决这些问题。我不确定 R 中的问题是否相关。

当尝试走 RCurl 路线时，我最终会遇到如下命令/错误：

```
 x <- getURL("https://xxx.xx.xxx.xxx:443/db/_authenticate", userpwd="xxxx:xxxxx") }{Error in function (type, msg, asError = TRUE)  : couldn't connect to host 
```

当尝试使用 RMongo 时，我更加一无所知......

```
> mongo <- mongoDbConnect("xxx.xx.xxx.xxx") 
```

> username = "xxxx" password="xxxxxxxxxxxxx" 已通过身份验证 <- dbAuthenticate(mongo, username, password) 2013 年 2 月 25 日下午 4:00:09 com.mongodb.DBTCPConnector fetchMaxBsonObjectSize 警告：使用 0 java.io.IOException 确定 maxBSON 大小的异常：无法连接到 [/127.0.0.1:27017] bc:java.net.ConnectException：连接被拒绝：在 com.mongodb.DBPort 处连接。*在 com.mongodb.DBPort.go(DBPort.java:101) 在 com.mongodb.DBPort.go(DBPort.java:82) 在 com.mongodb.DBPort.findOne(DBPort.java) 打开(DBPort.java:224) :142) 在 com.mongodb.DBPort.runCommand(DBPort.java:151) 在 com.mongodb.DBTCPConnector.fetchMaxBsonObjectSize(DBTCPConnector.java:429) 在 com.mongodb.DBTCPConnector.checkMaster(DBTCPConnector.java:416) 在 com .mongodb.DBTCPConnector.call(DBTCPConnector.java:193) 在 com.mongodb.DBApiLayer$MyCollection。*_find(DBApiLayer.java:303) 在 com.mongodb.DB.command(DB.java:159) 在 com.mongodb.DB.command(DB.java:144) 在 com.mongodb.DB._doauth(DB.java :503) 在 com.mongodb.DB.authenticate(DB.java:440) 在 rmongo.RMongo.dbAuthenticate(RMongo.scala:24)

```
Error in .jcall(rmongo.object@javaMongo, "Z", "dbAuthenticate", username,  : 
com.mongodb.MongoException$Network: can't call something
Feb 25, 2013 4:00:10 PM com.mongodb.DBPortPool gotError
WARNING: emptying DBPortPool to 127.0.0.1:27017 b/c of error
java.io.IOException: couldn't connect to [/127.0.0.1:27017]     bc:java.net.ConnectException: Connection refused: connect
at com.mongodb.DBPort._open(DBPort.java:224)
at com.mongodb.DBPort.go(DBPort.java:101)
at com.mongodb.DBPort.go(DBPort.java:82)
at com.mongodb.DBPort.call(DBPort.java:72)
at com.mongodb.DBTCPConnector.call(DBTCPConnector.java:202)
at com.mongodb.DBApiLayer$MyCollection.__find(DBApiLayer.java:303)
at com.mongodb.DB.command(DB.java:159)
at com.mongodb.DB.command(DB.java:144)
at com.mongodb.DB._doauth(DB.java:503)
at com.mongodb.DB.authenticate(DB.java:440)
at rmongo.RMongo.dbAuthenticate(RMongo.scala:24) 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T15:02:01.250

过去我在使用 RCurl 时遇到过问题，我需要明确地将其指向安全证书以使其正常工作。我最终需要这样的东西：

```
out <- postForm("https://url.org/api/",
                 token="IMATOKEN",
                 .opts=curlOptions(cainfo="C:/path/aaa.crt")) 
```

我已经手动导出了我需要让它工作的证书。

此外，看起来你应该在给定 URI 的情况下执行 POST 请求，而不是 GET。试试这个`postForm()`命令，也许？

编辑添加：

好的，我想如果我们退后一步，事情可能会更清楚一点。您的目标是从特定的 URL 获取一些文件（基本上是从 R 中执行 wget）？或者您的目标是提交随后返回所需数据的表单？

如果您只是想获得基本（而且相当不安全）HTTP身份验证背后的东西，您应该做两件事：

*   告诉您的数据提供商使用更安全的选项
*   如图所示使用 getURL() 选项（使用您发布的 www.omegahat.org 示例）：

代码：

```
getURL("http://www.omegahat.org/RCurl/testPassword/",.opts=list(userpwd="bob:welcome"))
OR
getURL("http://bob:welcome@www.omegahat.org/RCurl/testPassword/") 
```

现在，如果您需要提交表单来获取数据，您通常会将身份验证令牌等作为参数传递（因此，在上面的示例中，`token='.

# android - 为什么 TalkBack 会忽略等于零的货币值？

> ID：15079323
> 
> 赞同：2
> 
> 时间：2013-02-26T00:41:10.153
> 
> 标签：android, accessibility, talkback

有谁知道为什么 TalkBack 将文本“余额：0.00 美元”读取为简单的“余额”？它似乎忽略了等于零的值。我希望它被解读为“余额：零美元”。

```
view.announceForAccessibility("Total: $0.00"); // Reads "Total"
view.announceForAccessibility("Total: $0"); // Reads "Total"
view.announceForAccessibility("Total: 0"); // Reads "Total: Zero" 
```

我在 Android 项目上[提交了一个错误](https://code.google.com/p/android/issues/detail?id=52027)，但想知道这里是否有人有一些见解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:35:19.943

这是文本转语音引擎中的一个错误，应该在引擎的更高版本中修复。

要解决此问题，您可以使用不同的 TTS 引擎（例如 SVOX Classic），或者在您知道价值为零时将公告指定为“总计：零美元”。

# algorithm - 外行人的摊销复杂性？

> ID：15079327
> 
> 赞同：79
> 
> 时间：2013-02-26T00:41:26.320
> 
> 标签：algorithm, amortized-analysis

有人可以用外行的术语解释摊销的复杂性吗？我一直很难在网上找到一个精确的定义，我不知道它与算法分析有什么关系。任何有用的东西，即使是外部引用的，都会受到高度赞赏。

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2013-02-26T01:18:43.543

> **摊销复杂度是**每个操作的总费用，在一系列操作中评估。

这个想法是保证整个序列的总费用，同时允许单个操作比摊销成本高得多。

**示例：**
C++ 的行为`std::vector<>`。当`push_back()`向量大小增加到超过其预先分配的值时，它会加倍分配的长度。

所以单个`push_back()`可能需要`O(N)`时间来执行（因为数组的内容被复制到新的内存分配中）。

但是，由于分配的大小增加了一倍，下一次`N-1`调用`push_back()`will 每次都需要`O(1)`时间来执行。所以，总的`N`操作还是需要`O(N)`时间的；从而给出每次操作`push_back()`的摊销成本。`O(1)`

* * *

除非另有说明，否则摊销复杂度是任何操作序列的渐近最坏情况保证。这表示：

*   与非摊销复杂性一样，用于摊销复杂性的大 O 表示法忽略了固定的初始开销和恒定的性能因素。因此，为了评估 big-O 摊销性能，您通常可以假设任何摊销操作序列将“足够长”以摊销固定的启动费用。具体来说，对于这个`std::vector<>`例子，这就是为什么你不需要担心你是否真的会遇到`N`额外的操作：分析的渐近性质已经假设你会遇到。

*   除了任意长度之外，摊销分析不会对您正在测量其成本的操作序列做出假设——它是对*任何可能*的操作序列的最坏情况保证。无论操作选择得多么糟糕（例如，被恶意对手！），摊销分析必须保证足够长的操作序列的成本可能不会始终超过其摊销成本的总和。这就是为什么（除非作为限定词特别提到）“概率”和“平均情况”与摊销分析无关——就像它们与普通的最坏情况大 O 分析无关一样！

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2013-02-26T01:28:25.343

> 在摊销分析中，执行一系列数据结构操作所需的时间是所有执行操作的平均值……摊销分析与平均情况分析的不同之处在于不涉及概率。摊销分析保证了在最坏情况下每个操作的平均性能。

（来自 Cormen 等人，“算法简介”）

这可能有点令人困惑，因为它既说时间是平均的，也不是平均情况分析。所以让我试着用一个金融类比来解释这一点（事实上，“摊销”是一个最常与银行和会计相关的词。）

假设您正在经营彩票。（不是购买彩票，我们稍后会谈到，而是自己操作彩票。）您打印 100,000 张彩票，每张以 1 个货币单位出售。其中一张门票将使购买者有权获得 40,000 个货币单位。

现在，假设您可以出售所有门票，您将获得 60,000 个货币单位：100,000 个货币单位的销售额，减去 40,000 个货币单位的奖金。对您来说，每张票的价值是 0.60 个货币单位，摊销在所有票上。这是一个可靠的值；你可以依靠它。如果您厌倦了自己卖票，而有人过来并提出以每张 0.30 货币单位的价格出售，那么您确切地知道自己的立场。

对于彩票购买者来说，情况就不同了。购买者在购买彩票时预期损失 0.60 个货币单位。但这是概率性的：购买者可能会在 30 年内每天购买 10 张彩票（略多于 100,000 张）而从未中奖。或者他们可能有一天会自发地购买一张票，并赢得 39,999 个货币单位。

应用于数据结构分析，我们谈论的是第一种情况，我们将某些数据结构操作（例如插入）的成本摊销到所有此类操作中。平均案例分析处理随机操作（例如搜索）的预期值，我们无法计算所有操作的总成本，但我们可以提供单个操作的预期成本的概率分析。

人们经常说，摊销分析适用于高成本操作很少见的情况，而且情况经常如此。但不总是。例如，考虑所谓的“银行家队列”，它是一个先进先出 (FIFO) 队列，由两个堆栈组成。（这是一个经典的函数式数据结构；你可以用不可变的单链接节点构建廉价的 LIFO 堆栈，但廉价的 FIFO 并不那么明显）。操作实现如下：

```
put(x):  Push x on the right-hand stack.
y=get(): If the left-hand stack is empty:
           Pop each element off the right-hand stack and
             push it onto the left-hand stack. This effectively
             reverses the right-hand stack onto the left-hand stack.
         Pop and return the top element of the left-hand stack. 
```

现在，我声称 和 的摊销成本`put`是`get`，`O(1)`假设我以空队列开始和结束。分析很简单：我总是`put`进右手边的栈，然后`get`从左手边的栈中。因此，除了`If`子句之外， each`put`是 a `push`， each`get`是 a `pop`，两者都是`O(1)`。我不知道我会执行多少次`If`子句——它取决于`put`s 和`get`s 的模式——但我知道每个元素从右侧堆栈移动到左侧堆栈恰好一次。`put`因此，整个 n s 和 n s序列的总成本`get`为： n `push`es、n `pop`s 和 n `move`s，其中 a`move`是 a`pop`后跟 a `push`：换句话说，2n 次操作（n `put`s 和 n `get`s）导致 2n `push`es 和 2n `pop`s。所以单的摊销成本`put`还是`get`一`push`加一`pop`。

请注意，银行家队列之所以被称为正是因为摊销复杂性分析（以及“摊销”一词与金融的关联）。银行家的队列是过去常见面试问题的答案，尽管我认为它现在被认为太知名了：想出一个在摊销 O(1) 时间内实现以下三个操作的队列：

1) 获取并移除队列中最旧的元素，

2）将一个新元素放入队列中，

3) 求当前最大元素的值。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2013-02-26T00:45:48.650

“摊销复杂性”的原则是，虽然做某事时可能相当复杂，但由于不经常做，所以被认为是“不复杂”。例如，如果您创建一棵不时需要平衡的二叉树 - 比如说每次`2^n`插入一次 - 因为虽然平衡树非常复杂，但它只会在每 n 次插入中发生一次（例如，在插入编号 256 处发生一次，然后在第 512、1024 等）。在所有其他插入中，复杂度为 O(1) - 是的，每 n 次插入需要 O(n) 一次，但这只是`1/n`概率 - 所以我们将 O(n) 乘以 1/n 并得到 O(1)。所以这被称为“O(1) 的摊销复杂度”——因为当你添加更多元素时，重新平衡树所消耗的时间是最少的。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-02-26T00:47:07.690

摊销意味着在重复运行中分配。保证最坏情况的行为不会频繁发生。例如，如果最慢的情况是 O(N)，但发生这种情况的机会只有 O(1/N)，否则过程是 O(1)，那么算法仍然有摊销常数 O(1) 时间. 只需考虑将每个 O(N) 运行的工作分配给其他 N 运行。

这个概念取决于有足够的运行来划分总时间。如果算法只运行一次，或者每次运行都必须在最后期限内完成，那么最坏情况的复杂性就更重要了。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-06-21T07:26:53.727

假设您正在尝试查找未排序数组的第 k 个最小元素。对数组进行排序将是 O(n logn)。因此，找到第 k 个最小的数字只是定位索引，所以 O(1)。

由于数组已经排序，我们再也不需要排序了。我们永远不会多次遇到最坏的情况。

如果我们执行 n 次尝试定位第 k 个最小的查询，它仍然是 O(n logn)，因为它优于 O(1)。如果我们平均每个操作的时间，它将是：

(n logn)/n 或 O(logn)。因此，时间复杂度/操作次数。

这是摊销的复杂性。

我觉得是这样的，我也在学习。。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-02-26T00:47:10.670

它有点类似于将算法中不同分支的最坏情况复杂度乘以执行该分支的概率，然后将结果相加。因此，如果某个分支不太可能被采用，那么它对复杂性的贡献就较小。

# c++ - C++模具对计算问题

> ID：15079328
> 
> 赞同：1
> 
> 时间：2013-02-26T00:41:29.600
> 
> 标签：c++, arrays, loops, visual-c++

这是我正在尝试编写的一个简单游戏，但结果却并非如预期的那样高效……这是我的目标。阵列工作不正常，整体逻辑不完整。目标是：如果第一次掷骰子的总和是 2、3 或 12，则您告诉玩家他/她输了；如果总和是 7 或 11，您告诉玩家他/她赢了；如果第一次滚动是任何其他数字（4,5,6,8,9,10），玩家被告知他/她必须再次滚动。现在扩展该程序如下 - 如果玩家被告知在第一次滚动后再次滚动（如果它是 4、5、6、8、9、10），则保存该数字，称其为“点”。现在继续滚动，直到发生以下两种情况之一——如果玩家在再次滚动“点”数字之前掷出 7，则玩家输掉并且回合结束；如果玩家在掷出 7 之前匹配“点”，则玩家获胜并且转牌结束。如果掷出 7 或“点”以外的任何数字，则什么都不会发生，玩家只会继续滚动。告诉玩家他们是赢还是输，每次掷骰的结果，以及需要多少次才能得到结果。

![在此处输入图像描述](../Images/4e94e37a4947b91b70ce7d33f208618e.png)

```
#include <iostream>
#include <ctime>

using namespace std;

int main()
{
    int die1, 
        die2, 
        sum, 
        point,
        rollChoice;
    static int rollCount;

    int *rolls = new int[];

    rollCount=1;
    point=0;

    srand(time(0));

    cout<<"Enter 1 to roll: ";
    cin>>rollChoice;

    if(rollChoice==1)
    {

        for (int i=0; i<INT_MAX; i++)
        {
            die1=rand()%10;
            die2=rand()%10;

            sum=die1+die2;

            rolls[sum];

            if(rolls[i] == 2 || rolls[i] == 3 || rolls[i] == 12)
            {
                cout<<"\nYou have lost!"<<endl;

                rollCount++;

                cout<<"\n";
                cin>>rollChoice;
            }

            else if(rolls[i] == 7 || rolls[i] == 11)
            {
                cout<<"\nYou have won!"<<endl;

                rollCount++;

                cout<<"\n";
                cin>>rollChoice;
            }
            else if(rolls[i] == 4 || rolls[i] == 5 || rolls[i] == 6 || rolls[i] == 8 || rolls[i] == 9 || rolls[i] == 10)
            {
                cout<<"\nYou have lost, roll again.";

                point=rolls[i];

                cout<<"\n";
                cin>>rollChoice;

                rollCount++;

                if(rollCount==7)
                {
                    for(int i=0; i<7; i++)
                    {
                        cout<<"\nRoll "<<i<<". "<<rolls[i];
                    }
                }
            }
        }
    }

    cin.get();
    cin.get();

    return 0;
} 
```

￼￼￼￼￼￼

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-26T00:47:07.160

*   `rolls`是一个没有大小的数组，但您尝试在其中粘贴东西。
*   你期待`for (int i=0; i<INT_MAX; i++)`做什么？
*   `rolls[sum]`? 这是一个 NoOP
*   `i`在循环内部重新定义使用`i`是令人震惊的做法。

我建议你翻出你的 C/C++ 书，重新审视一些基础知识，然后在遇到问题时提出一些具体问题！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T08:00:23.143

您没有提供有关您的代码的任何或足够的解释（例如第一个 for 循环）。因此，我无法帮助解决您的主要问题。但是，我能够指出其中的一些错误。就像您没有设置动态数组的大小一样：roll。完成后不要忘记删除它！

但是，至少你解释了你的目标。因此，我能够为它编写一个类。基本上，您正在尝试开发自己的“一对骰子”游戏。因此，如果我仔细正确地阅读了您的目标，那么我为您的目标编写的课程应该可以正常工作。它在下面提供。不要忘记阅读那些有用的评论！我希望你能从中学到一些有用的东西。随意使用和调整您的需求。

**APairOfDice.h**

```
#ifndef APAIROFDICE_H
#define APAIROFDICE_H

#include <string>
#include <iostream>
#include <ctime>

#define A_PAIR_OF_DICE_LOST     0
#define A_PAIR_OF_DICE_WON      1
#define A_PAIR_OF_DICE_RETRY    2

class APairOfDice
{
public:
    void Play( void );
private:
    ::UINT Roll( void );
    void Reset( void );
    void PrintHistory( void );
private:
    ::UINT m_nCount;
    ::UINT m_nValue;
    ::UINT m_nPoint;
    std::vector< ::UINT >m_vnHistory;
    bool bWin;
public:
    APairOfDice( void ) : m_nCount( 0 ), m_nValue( 0 ), m_nPoint( 0 ), bWin( false ) { }
    ~APairOfDice( void ) { }
};

#endif // APAIROFDICE_H 
```

**APairOfDice.cpp**

```
void APairOfDice::Play( void )
{
    // DECLARATION
    ::UINT nRollResult = Roll( );

    // DO WHATEVER
    // *This is the main loop of the game:
    while( true )
    {
        //* Is this is first roll? If so, do this:
        if( m_nCount == 1 )
        {
            // *If m_nValue is equal to either of the following
            // values: 2, 3, and 12, the player has lost.
            // So, bWin is set to false and the loop will break.
            if( nRollResult == A_PAIR_OF_DICE_LOST ) {
                bWin = false;
                break;
            }

            // *Else if m_nValue is equal to either 7 or 11,
            // the player has won. Therefore, bWin is set as
            // true and the loop will break.
            else if( nRollResult == A_PAIR_OF_DICE_WON ) {
                bWin = true;
                break;
            }

            // *Else m_nValue is equal to either of the following
            // numbers: 1, 4, 5, 6, 8, 9, 10
            // change the value of m_nPoint to m_nValue (saved it).
            else
                m_nPoint = m_nValue;
        }
        //* If not, do this:
        else
        {
            // *If m_nValue is equal to 7, the player will
            // lose. If so, set bWin as false and break
            // the loop. Game over.
            if( m_nValue == 7 ) {
                bWin = false;
                break;
            }

            // *Else if m_nValue is equal to m_nPoint, the player
            // will win. If so, set bWin as true and break
            // the loop. Game over. Good game.          
            else if( m_nValue == m_nPoint ) {
                bWin = true;
                break;
            }
        }

        //* Remove the next two lines to prevent the loop from pausing.
        std::cout << "Enter any key to roll again!\n";
        ::getchar( );

        // Roll again.
        Roll( );
    }

    // PRINT
    PrintHistory( );

    // ASK FOR REPLAY
    std::cout << "Would you like to play again? Enter 'y' for yes and any other key is for no.\n";
    if( ::getchar( ) == 'y' || ::getchar( ) == 'Y' )
    {
        Reset( );
        Play( );
    }
};
::UINT APairOfDice::Roll( void )
{
    // DECLARATION

    // INITIALIZATION
    // *Increase the value of m_nCount.
    m_nCount ++;

    // *Initialize random number generator
    // with std::time as the seed.
    std::srand( ( ::UINT )std::time( 0 ) );

    // *Set the value of m_nValue as the result of
    // std::rand % highest value + lowest value.
    // *This isn't the best way to generate a value.
    m_nValue = std::rand( ) % 12 + 1;

    // *Save the old m_nValue.
    m_vnHistory.push_back( m_nValue );

    // *Check and return values.
    if( m_nValue == 2 || m_nValue == 3 || m_nValue == 12 )
        return( A_PAIR_OF_DICE_LOST );
    else if( m_nValue == 7 || m_nValue == 11 )
        return( A_PAIR_OF_DICE_WON );
    else
        return( A_PAIR_OF_DICE_RETRY );
};

void APairOfDice::Reset( void )
{
    //* Reset all class variables and members.
    this->m_nCount = 0;
    this->m_nValue = 0;
    this->m_nPoint = 0;
    this->m_vnHistory.clear( );
    this->bWin = false;
};

void APairOfDice::PrintHistory( void )
{
    // DECLARATION
    ::UINT nRollCount = 2;

    // *Print win or lose message.
    if( bWin )
        std::cout << "Yay! You've won!!!\n";
    else
        std::cout << "Aw! You've lost...\n";

    // *Print the value of m_nPoint.
    std::cout << "Roll 1 - " << "your \"point\" is " << m_nPoint << std::endl;

    // *Print each value within m_vnHistory except for the first one
    // why not the first one? Well, because thats the value of m_nPoint.
    for( std::vector< ::UINT >::const_iterator nIndex = m_vnHistory.begin( ) + 1;
         nIndex != m_vnHistory.end( );
         ++ nIndex, ++ nRollCount )
    {
        std::cout << "Roll " << nRollCount << ". " << "\tRolled: " << *nIndex << std::endl;
    }
}; 
```

**测试：**

```
Enter any key to roll again!

Enter any key to roll again!

Enter any key to roll again!

Enter any key to roll again!

Enter any key to roll again!

Enter any key to roll again!

Enter any key to roll again!

Enter any key to roll again!

Enter any key to roll again!

Aw! You've lost...
Roll 1 - your "point" is 6
Roll 2\.         Rolled: 10
Roll 3\.         Rolled: 10
Roll 4\.         Rolled: 10
Roll 5\.         Rolled: 1
Roll 6\.         Rolled: 1
Roll 7\.         Rolled: 1
Roll 8\.         Rolled: 4
Roll 9\.         Rolled: 4
Roll 10\.        Rolled: 7
Would you like to play again? Enter 'y' for yes and any other key is for no. 
```

如果有任何错误，请通知我。反馈和建议不容忽视！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T01:29:35.277

您似乎忘记设置卷的大小。您可能忘记的另一项任务是在您完全完成后删除卷。打扫卫生总是一个好习惯！

这部分看起来很可怕：

```
else if(rolls[i] == 4 || rolls[i] == 5 || rolls[i] == 6 || rolls[i] == 8 || rolls[i] == 9 || rolls[i] == 10)
{
    // ...
} 
```

将该部分更改为：

```
else if( rolls[ i ] => 4 && rolls[ i ] <= 10 && rolls[ i ] != 7 )
{
    // ...
} 
```

您应该在声明时明确分配局部变量的值。改变这个：

```
int die1, 
        die2, 
        sum, 
        point,
        rollChoice;
    static int rollCount;

    // Why initialize the value of rollCount and point now?
    rollCount=1;
    point=0; 
```

对此：

```
int die1 = 0;
int die2 = 0;
int sum = 0;
int point = 0;
int rollChoice = 0;
static int rollCount = 1; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T00:46:43.773

它们真的是 10 面骰子吗？您没有将任何数据放入卷中`rolls[sum]`；你的意思是`rolls[i]=sum;`？

# scala - 在 Scala 中通过 Deflater 往返失败

> ID：15079332
> 
> 赞同：1
> 
> 时间：2013-02-26T00:41:53.020
> 
> 标签：scala, compression, deflate

我正在寻找通过 java 的 Deflater 往返字节并遇到问题。首先是输出，然后是代码。我在这里做错了什么，我怎样才能正确地往返这些流？

**输出：**

```
scala> new String(decompress(compress("face".getBytes)))
(crazy output string of length 20) 
```

**代码：**

```
 def compress(bytes: Array[Byte]): Array[Byte] = {
    val deflater = new java.util.zip.Deflater
    val baos = new ByteArrayOutputStream
    val dos = new DeflaterOutputStream(baos, deflater)
    dos.write(bytes)
    baos.close
    dos.finish
    dos.close
    baos.toByteArray
  }

  def decompress(bytes: Array[Byte]): Array[Byte] = {
    val deflater = new java.util.zip.Deflater
    val baos = new ByteArrayOutputStream(512)
    val bytesIn = new ByteArrayInputStream(bytes)
    val in = new DeflaterInputStream(bytesIn, deflater)
    var go = true
    while (go) {
      val b = in.read
      if (b == -1)
        go = false
      else
        baos.write(b)
    }
    baos.close
    in.close
    baos.toByteArray
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T03:08:30.613

`Deflater`当你应该-ing 它时，你正在 (re-) -ing 原始通货紧缩的结果`Inflater`......

# python - Python 导入文件 mac

> ID：15079339
> 
> 赞同：0
> 
> 时间：2013-02-26T00:42:50.413
> 
> 标签：python, python-2.7

我有一个必须完成的 Python 课程练习。我已经将我的方法/定义保存在一个文件中，只需要弄清楚如何运行它。我希望你能向我解释如何导入文件（我知道语法“导入文件名”）。每当我这样做时，我都会遇到错误。如何将导入的文件路径更改为桌面上的文件？我正在使用 mac 并运行 IDLE 2.7.3

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T00:47:13.227

如果文件与该文件位于同一目录中，则可以使用

```
import <filename> #(without the <>) 
```

但是，如果您指的是单独目录中的文件，请使用 imp

```
import imp

module = imp.load_source('module.name', '/path/to/file.py')
module.SomeClass() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T02:14:55.737

在 Mac OS X 上，有两种启动 IDLE 的基本方法。一种是在 Finder 的 Applications 文件夹中双击一个 IDLE 图标。（我称之为`IDLE.app`）第二个是从终端会话 shell 启动 IDLE，如下所示：

```
 idle2.7 
```

我会这样称呼它，`bin/idle`因为它指的是系统`bin`目录之一中的文件。

启动时`bin/idle`，IDLE 将继承 shell 的当前工作目录，并将该目录添加到 Python 搜索导入的目录列表的前面。您可以在 IDLE shell 窗口中检查该目录列表：

```
 import sys
 sys.path 
```

但是，当您启动`IDLE.app`时，它不与任何 shell 关联，因此没有机会告诉 IDLE 使用哪个工作目录。在这种情况下，`IDLE.app`使用您的`Documents`文件夹/目录作为其工作目录：在 shell 表示法中`~/Documents`，也拼写为`/Users/your_login_name/Documents`.

您可以在 Python 程序中手动操作`sys.path`以添加另一个用于导入的目录：

```
 import sys
 sys.path.insert(0, '/path/to/directory') 
```

另一种操作方法`sys.path`是使用`PYTHONPATH`环境变量。但是，同样，在使用 时`IDLE.app`，没有（简单的）方法可以将环境变量传递给它，这与`bin/idle`

因此，如果您想使用，最简单的方法是将您希望能够导入的所有文件和包目录`IDLE.app`放入您的目录中。`Documents`否则，使用终端会话，设置所需的工作目录和/或`PYTHONPATH`变量并启动`bin/idle`。所以像：

```
cd ~/MyProject
export PYTHONPATH=~/"AnotherPackageDirectory"
idle2.7 
```

另一种方法是将模块安装在 Python 搜索并使用 Distutils`easy_install`或`pip`. 但是当你有一个完成的项目时，这是需要学习的东西。

# php - 这是对多个站点的简单爬网，但它失败了

> ID：15079340
> 
> 赞同：0
> 
> 时间：2013-02-26T00:42:51.240
> 
> 标签：php, arrays, curl

我是一个 n00b，所以请忍受这些愚蠢的问题 - 我知道我的 curl 命令有效，我可以一次执行一个，但是当我添加这个数组并反击时，它就不起作用了。我知道这是基础知识，但我尝试过寻找东西，这看起来应该可以。当然我错了帮助，

```
<?php
$proxy = '127.0.0.1:8118';
$proxy = explode(':', $proxy);
$site[] = "http://site1.com";
$site[] = "http://site2.com";
$site[] = "http://site3.com";
$site[] = "http://site4.com";
// $site[] = explode(':', $site[]);
$maxsites = count($site);

// echo $site[];
echo $maxsites;

$counter ='1';

echo $counter;
echo "site count ".$site[$counter];

while  (  $counter <= 4);
{
echo "got to here";
    $url = $site[$counter];
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $site[$counter]);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_PROXYTYPE, CURLPROXY_HTTP);
    curl_setopt($ch, CURLOPT_PROXY, $proxy[0]);
    curl_setopt($ch, CURLOPT_PROXYPORT, $proxy[1]);
    curl_setopt($ch, CURLOPT_HEADER, 1);
    $exec = curl_exec($ch);
    echo curl_error($ch);
    print_r(curl_getinfo($ch));
    echo $exec;
    $counter++;
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T00:53:59.503

如果您可以提供一两个错误将非常棒，但乍一看，这个问题可能会让您感到困惑：

```
while  (  $counter <= 4);
{ 
```

应该

```
while($counter <= 4)
{ 
```

不需要那个分号

你也设置`$counter`等于字符 1，而不是它应该是的整数：

```
$counter = 1; 
```

# ruby - 如何为 textView 设置标记？

> ID：15079348
> 
> 赞同：0
> 
> 时间：2013-02-26T00:43:47.700
> 
> 标签：ruby, search, gtk, find

我正在为我的应用程序做“查找和替换按钮”。我正在使用 gtk 和 ruby​​。我可以找到多少字，如果有的话。我也想得到搜索词的选择词，我应该标记它们。我的一些代码：

```
def search(ent, txtvu)
start = txtvu.buffer.start_iter
first, last = start.forward_search(ent.text, Gtk::TextIter::SEARCH_TEXT_ONLY, nil)
count = 0
while (first)
mark = start.buffer.create_mark(nil, first, false)
txtvu.scroll_mark_onscreen(mark)
txtvu.buffer.delete_mark(mark)
txtvu.buffer.select_range(first, last)
start.forward_char
first, last = start.forward_search(ent.text, Gtk::TextIter::SEARCH_TEXT_ONLY, nil)
start = first
count += 1
end 
```

`count`说我有多少字涉及我的代码不起作用。:( 为什么？我想标记所有搜索过的单词。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T08:47:45.090

如果我理解正确，您想突出显示*所有*找到的单词，而不仅仅是一个。在那种情况下，`select_range`不是要调用的函数，因为它将选择更改为当前单词，并且`GtkTextView`选择是单一且连续的。

相反，创建一个突出显示标签并将其应用于所有搜索。例如：

```
# create the "highlight" tag (run this only once)
textvu.buffer.create_tag("highlight", {background => "yellow"})

# ... later, in the loop:
textvu.buffer.apply_tag("highlight", first, last) 
```

您的匹配项都将突出显示。

# google-apps-script - 如何使用谷歌应用脚 本向谷歌电子表格添加子子菜单

> ID：15079349
> 
> 赞同：4
> 
> 时间：2013-02-26T00:43:47.373
> 
> 标签：google-apps-script, google-sheets

是否可以在 Google 电子表格中添加二级子菜单（sub-sub-menu）？我知道如何添加带有子菜单的菜单，但我需要多添加一层。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-10-25T21:01:00.770

您现在可以添加子子菜单。我相信您应该能够继续嵌套​​多个菜单。

```
DocumentApp.getUi()
  .createMenu("TopMenu")
  .addItem('Top Item', 'topProgram')
  .addSeparator()
  .addSubMenu(DocumentApp.getUi().createMenu('SubMenu')
              .addItem('Sub Item', 'subProgram')
              .addSubMenu(DocumentApp.getUi().createMenu('Sub Sub Menu')
                          .addItem('SubSub Item', 'subSubProgram')))

  .addToUi(); 
```

上面的想法是您创建一个菜单并将其添加为“子菜单”。下面的示例创建了与上面相同的菜单，但更清晰地细分。

```
var subSubMenu = DocumentApp.getUi().createMenu('Sub Sub Menu')
                          .addItem('SubSub Item', 'subSubProgram');

var subMenu = DocumentApp.getUi().createMenu('Sub Menu')
                          .addItem('Sub Item', 'subProgram')
                          .addSubMenu(subSubMenu);

var topMenu = DocumentApp.getUi().createMenu('Top Menu')
                          .addItem('Top Item', 'topProgram')
                          .addSubMenu(subMenu);
topMenu.addToUi(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T01:44:42.107

看起来这是不可能的。大家可以看一下[Issue 317](http://code.google.com/p/google-apps-script-issues/issues/detail?id=317&q=sub%20menu&colspec=Stars%20Opened%20ID%20Type%20Status%20Summary%20Component%20Owner)，不过这2年好像没什么进展，不要太激动。无论如何，您可以关注它，看看是否有任何更新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T15:02:05.697

第二层下拉菜单，IMO，不是一个很好的设计模式。您将得到更好的使用，并且可以将每个父类别作为一个单独的菜单，每个菜单中都有简单的列表（当然，除非您正在寻找大量命令）。

我不想减少您的需求，但没有它是用户体验的胜利。

# node.js - 如何设置 socket.io 1.0（不稳定）？

> ID：15079350
> 
> 赞同：2
> 
> 时间：2013-02-26T00:43:50.187
> 
> 标签：node.js, socket.io

所以我花了几个小时在 ununtu 上尝试将我的 socket.io 0.8 升级到 socket.io 1.0

我试过测试我的应用程序，发现很多人无法连接。使用 1.0 我听说它可能会解决这个问题，因为它可以更好地处理传输升级。Socket.io 1.0 可能很快就会问世，但几个月来一直处于“几乎准备就绪”状态，我正在寻找一些关于如何在 ubuntu 中下载、构建和使用的详细说明。

我查看了 github + google 组上的论坛，包括这些线程： [https://groups.google.com/forum/#!topic/socket_io/JrL6cN6gTig](https://groups.google.com/forum/#!topic/socket_io/JrL6cN6gTig) [https://groups.google.com/forum/#!主题/socket_io/DC07mM2WpNk](https://groups.google.com/forum/#!topic/socket_io/DC07mM2WpNk)

但是我仍然没有运气。我得到的最接近的是让我的服务器没有抱怨，但是我的 socket.io/socket.io.js 文件提供给客户端，只是一个（几乎）空的 js 文件，其中一行只是 node_modules 中的一个相对目录到一个js文件。

我真的只是想问是否有任何详细的说明？任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-26T06:57:43.770

嗨，我正在使用带有 node.js 的 express web 应用程序框架。我的下面的代码在 socket.io 上运行良好我也在客户端中获取 socket.io.js 没有任何问题。

服务器.js

```
 var express = require('express')
                           , http = require('http');

           var app = express();
           app.configure(function(){
           app.use(express.static(__dirname + '/public'));
           });
           var server = http.createServer(app);
           var io = require('socket.io').listen(server);
           server.listen(8000); 
```

在 index.html 文件中，我添加了以下代码，因此它可以毫无问题地在客户端获取 socket.io。

```
 <script src='/socket.io/socket.io.js' type='text/javascript'></script> 
```

# c# - 在拖放操作期间禁用光标

> ID：15079351
> 
> 赞同：0
> 
> 时间：2013-02-26T00:43:59.930
> 
> 标签：c#, wpf, drag-and-drop

[我已经由 Jan Karger (2011) https://code.google.com/p/gong-wpf-dragdrop/](https://code.google.com/p/gong-wpf-dragdrop/)实现了这个 WPF 拖放框架

但是，我似乎无法更改[拖放操作期间出现的默认光标](http://i.stack.imgur.com/UGaN2.png)：

我知道该`DragDropEffects.Copy`方法会以某种方式影响光标，但是我似乎根本无法覆盖或更改它。

如果有人能对这个问题有所了解，将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T01:21:32.013

答案就在主文档页面上：如果您遵循与 ViewModel 实现接口的完全相同的模型，那么您需要一个 IDropTarget。当然，放置目标控制显示什么图标 - 不同的目标可能有不同的效果。

因此，在 DragOver 的处理程序中，您会收到一个 DropInfo - 只需将其 Effects 属性设置为您想要的值。

我曾经使用过那个库，我记得它非常简洁——一个简单的包装器，它可以将 MVVM 拖放到拖放中。我清楚地记得有不同的拖动图标（甚至更复杂的东西，比如被拖动的东西的半透明覆盖），所以我相信这是可能的。如果你确定你做的一切都是正确的，但它仍然不起作用，那么需要更多的细节......

# c++ - 使用 C++ 设置进程核心配额

> ID：15079355
> 
> 赞同：13
> 
> 时间：2013-02-26T00:44:37.457
> 
> 标签：c++, multicore, core

如果您编写软件时客户为软件使用的 CPU 内核数量付费，那么在您的 C++ 代码中实现这一目标的最佳方式是什么？到目前为止，我的研究使我能够`SetProcessAffinityMask`在 Windows 和`sched_setaffinity`POSIX 系统上使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T02:04:55.657

这是一个有趣的问题。我不认为我有完美的解决方案，但由于到目前为止还没有任何回应，让我提出以下建议：

如果您的程序中的主要工作块是由一种类型的线程完成的，那么不要产生超过客户许可允许的工作线程。由于不能将单个线程划分为在多个内核上运行，因此这施加了硬限制。

（我不认为设置进程 CPU 亲和力是可行的方法，因为它可以在运行时轻松更改。由于它不需要对系统进行任何逆向工程或永久性修改，我担心规避这一点不会感觉“糟糕”到足以阻止诚实的客户尝试它。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T15:39:33.170

我想你找到了最好的选择。如果您想利用多线程处理器的功能，那么限制线程数不是一个好主意。

# php - PHP - 超级快速地用值填充数组

> ID：15079360
> 
> 赞同：1
> 
> 时间：2013-02-26T00:45:10.790
> 
> 标签：php, arrays

好的，我需要一个像这样输出的数组：

```
$sections = array(
    5 => $americanFlag,
    6 => $americanFlag,
    22 => $russianFlag,
    23 => $russianFlag,
    24 => $russianFlag,
    25 => $russianFlag,
); 
```

当然，它比这要长得多。

所以，假设我有一个这样的数组：

```
$russian = array(22, 23, 24, 25);
$american = array(5, 6); 
```

和这样的数组：

```
$americanFlag = 'http://pathtomyAmericanFlag.png';
$russianFlag = 'http://pathtomyRussianFlag.png'; 
```

我怎样才能快速轻松地做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T00:55:56.520

可能有几种方法可以做到这一点。这是一个简单的：

```
$russian = array_fill_keys($russian, $russianFlag);
$american = array_fill_keys($american, $americanFlag);
$sections = ksort(array_merge($russian, $american)); 
```

假设您希望它们按键排序。如果没有，只需删除`ksort()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T00:50:10.300

```
$usFlags = array_combine($american, array_fill(0, count($american), $americanFlag);
$ruFlags = array_combine($russian, array_fill(0, count($russian), $russianFlag);
$sections = array_merge($usFlags, $ruFlags); 
```

应该这样做。但是，我不知道您想要实现什么，但似乎您想根据（我猜）某物的 ID 输出一个标志？

```
flags = array_merge(array_flip($russian), array_flip($american));
$helper = function ($id) use (flags) {
    return isset($flags[$id]) ? $flags[$id] : null;
}

echo 'http://pathtomy'. ucfirst($helper($id)) . 'Flag.png'; // returns 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T00:52:42.583

您可以使用多维数组：

```
array (
 american => array ( [0] => american, [1] american );
 russian => array  ( [0] => russian, [1] russian ); 
```

那是你想要的吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T00:53:37.533

可能与此类似。

```
 $countries = array($russian, $american);
   foreach($countries as $country){
     foreach($country as $flag) {
       echo $sections[$flag];
     }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-26T00:57:00.880

试试这个

```
<?php

$russian = array();
$american = array();

foreach($sections as $key=>$value){
   if($value == "http://pathtomyRussianFlag.png"){
      array_push($russian, $key);
   }
   elseif($value == "http://pathtomyAmericanFlag.png"){
      array_push($american, $key);
   }
}

?> 
```

# php - 如何访问放置在站点根目录之外的文件？

> ID：15079365
> 
> 赞同：3
> 
> 时间：2013-02-26T00:45:39.680
> 
> 标签：php, mysql, apache

我整天都在为此煎熬。研究 SO，直到我的眼睛变得模糊......我需要知道：如何访问放置在站点根目录之外的文件？

背景：运行 Linux 的 Apache 2.0 专用服务器。

代码：PHP 和 MySQL

原因：我希望保护文件不会在浏览器中输入文件路径和文件名。

这不会那么困难......但我的分裂头说不然。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T18:24:49.290

看看[这个问题的答案](https://stackoverflow.com/q/2581714/306084)，它们似乎或多或少地在做同样的事情。

快速总结：[`readfile()`](http://us3.php.net/manual/en/function.readfile.php)或者[`file_get_contents()`](http://us3.php.net/manual/en/function.file-get-contents.php)是你所追求的。这个例子来自`readfile()`页面：

```
<?php
$file = 'monkey.gif';

if (file_exists($file)) {
    header('Content-Description: File Transfer');
    header('Content-Type: application/octet-stream');
    header('Content-Disposition: attachment; filename='.basename($file));
    header('Content-Transfer-Encoding: binary');
    header('Expires: 0');
    header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
    header('Pragma: public');
    header('Content-Length: ' . filesize($file));
    ob_clean();
    flush();
    readfile($file);
    exit;
}
?> 
```

我不建议允许`$file`使用用户输入设置变量！在响应中任意返回文件之前，请考虑文件名的来源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T00:53:36.293

您是否尝试访问站点根目录之外的文件？[然后你可以在 stackoverflow](https://stackoverflow.com/questions/5570085/accessing-files-outside-the-document-root-with-apache)中查看这个链接。这是 Apache 的[官方文档](http://httpd.apache.org/docs/2.2/urlmapping.html#outside)。

否则，您不必进行特殊处理以防止其他人访问站点根目录之外的文件。

# ruby-on-rails - Rails：Rspec 视图

> ID：15079368
> 
> 赞同：0
> 
> 时间：2013-02-26T00:45:48.187
> 
> 标签：ruby-on-rails, rspec

我想为我的表单编写一个 rspec 文件。

我的表单看起来像这样，它有一个嵌套表单：

```
 <%= f.fields_for :uebungs do |builder| %>
  <%= render "uebung_fields", :f => builder %>
 <% end %>

 <div class="boxUebung">
   <div class="actions">
    <%= f.button "Hinzufügen" %>
   </div>

   <div class="actions">
    <%= f.submit %>
   </div>
</div> 
```

我这样做了，但是要在 it"" 循环中插入什么：

需要“spec_helper”

```
describe "gastplans/_form.html.erb" do
it "show all fields" do

end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T06:38:15.830

我宁愿建议你先阅读一些关于这个复杂主题的文章。我绝对应该阅读官方的[Rails 指南](http://guides.rubyonrails.org/testing.html)。

另一篇很棒的文章在这里： [http ://everydayrails.com/2012/04/24/testing-series-rspec-requests.html](http://everydayrails.com/2012/04/24/testing-series-rspec-requests.html)

当然，我不能忘记 RailsCasts 及其[关于这个主题的插曲](http://railscasts.com/episodes/257-request-specs-and-capybara?view=asciicast)。最后，为了进一步阅读，我建议您阅读[Rspec 书](https://rads.stackoverflow.com/amzn/click/com/1934356379)。随便搜一下，谷歌上满是与这个话题相关的文章。

# java - Java 运行和停止线程

> ID：15079372
> 
> 赞同：4
> 
> 时间：2013-02-26T00:46:12.677
> 
> 标签：java, multithreading

说我有：

```
class WriteThread extends Thread {
    char letter;
    boolean stop = false; 
    WriteThread(char letter) {
        this.letter = letter;
    }
    public void halt() { stop = true; }
    public void run() {
        while(!stop) { System.out.print(letter); }
    }
} 
```

和：

```
WriteThread a = new WriteThread('a');
WriteThread b = new WriteThread('b');
a.start(); 
b.start();
// do some other stuff
a.halt();
b.halt(); // (*) 
```

执行 (*) 时是否保证两个线程都停止？（停止是指在 (*) 之后不再有打印）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T00:48:23.140

您需要使“停止”变量易变。当线程看到 vale 为真时，它会停止循环，但可能存在输出缓冲，这会混淆问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T01:58:19.220

当然不是。它与volatile与否无关，它只是多线程的本质。

在你调用 a.halt() 之后，线程 a 可能没有机会继续执行，而你的主线程执行 b.halt()。在那之后，线程 a 可能仍然在您的 println 语句之前的位置。

只是一个简化版本将演示：

```
MAIN THREAD                THREAD A
                           while (!stop)
a.halt()
                           println(...) 
```

调用后`a.halt()`，`a`仍有机会继续打印，EVEN`stop`变量是 volatile。

为了确保线程在某个点之后完成，请使用 join()：

```
WriteThread a = new WriteThread('a');
WriteThread b = new WriteThread('b');
a.start(); 
b.start();
// do some other stuff
a.halt();
b.halt();
a.join();
b.join();
// a and b are guaranteed to have finished at this point 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T01:17:30.160

除了使“stop”变量易失之外，为了使您的代码更加“线程安全”，您应该为“stop”添加同步的 get/set 方法并使用它们（“get”在 while 循环中，“set”在“停止”方法）。

尽管如此，您无法保证线程会在“暂停”后停止，但您可能会看到更少的“打印”。

要获得这样的保证，您必须使用某种“线程同步”机制，例如[Semaphore](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/Semaphore.html)，以使调用“a.halt()”的线程向“a”线程发出信号以停止“while”循环并停止（内部停止），直到“while”循环有效结束并“释放”信号量（因此调用线程继续执行）。

# html - 为什么 div 不能从其父级获取高度属性？

> ID：15079373
> 
> 赞同：0
> 
> 时间：2013-02-26T00:46:15.367
> 
> 标签：html, css, height

我在 CSS 中给了#header 82px 的高度，但即使 #logo 是它的子元素，它也没有得到 82px 的高度。我也应该在 CSS 中给#logo 82px 高度吗？

代码：[HTML](http://i.imgur.com/zbO2nus.png) & [CSS](http://i.imgur.com/k0AsFNh.png) 而且，我猜 HTML 有问题。我使用 Sublime Text，虽然所有其他 div 看起来都是彩色的，但第 10 行的#header 看起来很苍白。他究竟怎么了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T00:51:25.337

默认情况下，元素的高度不是继承的，它是自动的。这意味着高度将根据其中的内容自动确定。

您*可以*将孩子的高度显式设置为继承 ( `height: inherit`)，它也将继承您在父项上指定的任何高度。请参阅[此 jsFiddle 示例](http://jsfiddle.net/cCHDR/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T00:48:15.677

除非您给子 div 一个高度，否则它将包装它的内容。如果你想和父母有相同的高度，请将孩子的高度设置为`height:100%`

# asp.net - PDF 表单生成

> ID：15079385
> 
> 赞同：2
> 
> 时间：2013-02-26T00:47:20.543
> 
> 标签：asp.net, pdf-generation

我有一个 ASP.NET 4.0 Web 应用程序，需要为保险创建申请表。基本上，该程序加载一个 PDF 模板，填充表单域，然后展平并关闭 PDF。当我从 Word 创建模板时，它们很小（5 页大约 156k），但通过 Adob​​e Acrobat 添加到模板的每个表单域都会使整个文件大小增加大约 5-10k。不幸的是，这些页面有很多表单域（200+），最终结果往往是每页大约半 MB 到 1 MB。

谁能建议一个替代应用程序，可以从 ASP.NET 网页动态使用，它可以做类似的工作但保持较小的文件大小？它不需要是免费组件，但它确实需要有一种方法让我从 word 文档创建模板，但不使用 Office 自动化来填充 word doc 并另存为 PDF。我的偏好也是它处理流而不是文件，但在这种情况下，这对我来说是一个次要的考虑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T12:12:04.037

可能值得一看[Docmosis](http://www.docmosis.com)。您可以使用 Word 文档作为模板来填充和生成 PDF 和其他输出。由于它的工作方式，文档大小不会像您所指出的那样“爆炸”，这是您当前方案中大量字段的问题。ASP.NET 可以根据应用程序的运行时环境以各种方式调用 Docmosis。Docmosis 提供在线网络服务，其对应用环境的占用空间/要求最小，并且提供可下载和可嵌入的选项。它是商业的（我为创建它的公司工作）并且没有办公自动化要求。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T15:24:32.843

您可以为此尝试[Docotic.Pdf 库](https://bitmiracle.com/pdf-library/)。

该库可用于从代码填充现有字段或通过导入 FDF 文件。

该库不能展平表单字段，但您可以将字段设置为只读或保护整个文档免受权限更改。

以下是一些可能有用的示例：

*   [填写现有表格](https://bitmiracle.com/pdf-library/help/fill-existing-form.aspx)
*   [导入 FDF 数据](https://bitmiracle.com/pdf-library/help/import-fdf-data.aspx)
*   [按名称查找控件](https://bitmiracle.com/pdf-library/help/find-control-by-name.aspx)
*   [权限](https://bitmiracle.com/pdf-library/help/permissions.aspx)

免责声明：我为图书馆的供应商工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T00:57:12.630

看看[ABCpdf](http://www.websupergoo.com/abcpdf-1.htm)，我很确定它可以处理你正在寻找的东西

# javascript - Javascript 冲突 - 灯箱和滑块

> ID：15079386
> 
> 赞同：0
> 
> 时间：2013-02-26T00:47:21.217
> 
> 标签：javascript, lightbox, dreamweaver, conflict

所以我对网页设计和 Dreamweaver 还很陌生，但我已经设法将一些相当可靠的东西放在一起。我遇到的唯一问题是我的两个主要图像 javascript - 一个滑块和一个灯箱库 - 正在相互抵消。如果一个工作，另一个不能。这是头部的代码。有什么建议吗？

```
<!-- Style sheets themes for the Nivo Slider -->
<link rel="stylesheet" href="nivo-slider/themes/default/default.css" type="text/css" media="screen" />
<link rel="stylesheet" href="nivo-slider/themes/pascal/pascal.css" type="text/css" media="screen" />
<link rel="stylesheet" href="nivo-slider/themes/orman/orman.css" type="text/css" media="screen" />
<!-- Main Styles Sheet for the Primento theme -->
<link rel="stylesheet" href="styles.css">
<!-- Google Webfonts - Other fonts can be installed - http://www.google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=Lobster+Two:400,400italic,700'     rel='stylesheet' type='text/css'>
<script src="js/jquery-1.7.1.min.js" type="text/javascript"></script>
<script type="text/javascript" src="js/smooth-scroll.js"></script>
<!--script src="js/jquery.prettyPhoto.js" type="text/javascript" charset="utf-8"></script-->
<!--script src="js/jquery.validate.js" type="text/javascript"></script-->

<!-- Nivo Slider -->
<script type="text/javascript" src="js/jquery.nivo.slider.pack.js"></script>
<script type="text/javascript">
$(window).load(function() {
    $('#slider').nivoSlider();
});
</script>  

<script src="engine/js/jquery.min.js" type="text/javascript"></script>
<script src="engine/js/visuallightbox.js" type="text/javascript"></script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T00:51:51.110

尝试删除 jquery 的第二个实例。这很可能是重新初始化 jQuery 对象，导致页面失败。

页面上只需要一个 jQuery 实例。看起来您使用的插件较旧（即 pre-1.9），因此您应该尝试使用旧版本的 jQuery。如果 1.7.x 不起作用，请尝试 1.8.x 版本。1.9 版删除了一些可能会阻止插件工作的功能。

# qt - Qt - 网络接口统计

> ID：15079390
> 
> 赞同：1
> 
> 时间：2013-02-26T00:47:47.393
> 
> 标签：qt, qt4, qtnetwork

有没有办法在 Windows 平台上使用 Qt 获取网络接口接收/发送的字节数？如果是跨平台的就更好了。

我在 QtNetwork 模块中找不到任何有用的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T10:23:11.043

Qt 可以管理的最低 OSI 模型层是传输层（可能是第 3 层，但我不认为）。您只能获取从/到给定端口的接收/发送字节数。

如果您想“嗅探”界面上的全部流量，您应该使用基于 pcap 的库（Windows 为 winpcap，GNU/Linux 为 libpcap）。

# jquery - 单击锚链接时淡入/淡出音乐

> ID：15079392
> 
> 赞同：3
> 
> 时间：2013-02-26T00:47:52.873
> 
> 标签：jquery, audio, anchor, fade

我有一个带有几个链接的网页，当点击这些链接时，它们会淡入页面，而不是加载不同的 .html 文件。这是我的代码：

```
<!--fade and show windows-->
<script type="text/javascript">

    $(document).ready(function() {

        $('.aboutbutton').click(function() {
            displayNone();
            showWindow("aboutpage");
        } );
        ....
        ....  
        function displayNone() {
            $('#homepage,#aboutpage,#blueprintpage,#budgetpage,#musicpage').fadeOut();
        }
        function showWindow(name) {
            $('#' + name).fadeIn();
        }

    });
</script>
...
...
<body>

    <a href="#aboutpage" class="aboutbutton">About</a>
    <a href="#blueprintpage" class="blueprintbutton">Blueprint</a>
    ...
    ...
    <div id="aboutpage">  
               //CONTENT OF THIS PAGE//
    </div>
    <div id="blueprintpage">              
               //CONTENT OF THIS PAGE//
    </div>
    ....
    ....
    <!--simple pause/play music button at bottom of page using flash-->
    <div class="backgroundmusic">
        <span class="whitetext backgroundmusictext">Background music </span>
        <object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="25" height="20"
        codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab">
        <param name="movie" value="../site/swf/singlemp3player.swf?file=../site/music/OST/wenqing.mp3&backColor=990000&frontColor=ddddff&repeatPlay=true&autoStart=true&songVolume=30" />
        <param name="wmode" value="transparent" />
        <embed wmode="transparent" width="25" height="20" src="../site/swf/singlemp3player.swf?file=../site/music/OST/wenqing.mp3&backColor=990000&frontColor=ddddff&repeatPlay=true&autoStart=true&songVolume=30"
        type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" />
        </object>
    </div>
</body> 
```

如您所见，每个页面都是通过锚链接访问的。我想为每个页面分配背景音乐。当点击任何链接（如“关于”“蓝图”等）时，我希望当前正在播放的任何音乐淡出，然后新的音乐淡入。

这是一个个人音乐网站，所有的音乐都是我的作品，没有一个是破坏耳膜的主流东西，都是平静的钢琴旋律，所以请不要评论“有背景音乐的想法很糟糕”之类的等等

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T00:58:42.420

如果您真的想播放背景音乐，我建议您使用一个名为[SoundManager](http://www.schillmania.com/projects/soundmanager2/)的基于 JavaScript 的音乐框架。您可以更轻松地控制音乐的播放，并为禁用 Flash 的人支持更新的 HTML5 播放。然后使用类似[GetSatisfaction 页面上发布的代码来解决同一问题](https://getsatisfaction.com/schillmania/topics/fade_in_out)：

```
function fadeInSound(soundID,amount) {
  var s = soundManager.getSoundById(soundID);
  var vol = s.volume;
  if (vol == 100) return false;
  s.setVolume(Math.min(100,vol+amount));
  setTimeout(function(){fadeInSound(soundID,amount)},20);
}

function fadeOutSound(soundID,amount) {
  var s = soundManager.getSoundById(soundID);
  var vol = s.volume;
  if (vol == 0) return false;
  s.setVolume(Math.max(0,vol+amount));
  setTimeout(function(){fadeOutSound(soundID,amount)},20);
} 
```

本质上，您只需在一定的时间间隔内将声音的音量降低/增加一个固定的量。

# websphere - websphere 多个类加载器修复类未找到异常

> ID：15079394
> 
> 赞同：1
> 
> 时间：2013-02-26T00:48:15.537
> 
> 标签：websphere, classloader, classnotfound

嗨，我们在我的公司使用 websphere

websphere安装有两个耳朵ear1和ear2

我们有一个单一类加载器的策略

当设置为 singleclassloader 时，我们从 ear2 spring-oxm3.1.0.RELEASE.jar org.springframework.oxm.MarshallingFailureException 找不到类未找到异常

但是通过启用“多个类加载器”，问题就消失了。

1.  为什么公司会有强制执行“单一类加载器”的政策？
2.  classnotfound 异常是否是因为在ear1 和ear2 中都定义了一个类的jar？
    例如 ear1:jar1 和 ear2:spring-oxm3.1.0.RELEASE.jar 而 X 是从 ear1:jar1 加载的，因此 spring-oxm3.1.0.RELEASE.jar 没有加载？当请求运行时它失败并抱怨没有找到 MarshallingFailureException？

这可以解释为什么找不到该课程吗？

那么找到ear1中导致spring-oxm3.1.0.Release.jar不加载的jar的解决方案是什么？并删除它？会是 xerces 还是 jaxb？（我们正在运行 java 1.5 版）

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:09:51.330

*   在那个旧版本的 Java 中，所有与 XML 相关的 jar 都有很多问题。
*   您的错误详细信息将告诉您为什么没有加载该类。最有可能的是，它是一个具有相同包/名称但在不同 jar 中的类
*   公司政策与所涉及的所有因素有关——开发、维护、依赖管理等等。

# asp.net - IIS 7 的最大默认 POST 请求大小 - 如何增加 64kB/65kB 限制？

> ID：15079397
> 
> 赞同：19
> 
> 时间：2013-02-26T00:48:33.447
> 
> 标签：asp.net, http, rest, iis, post

我在 ASp .net C# 中创建了一个 RESTful POST Web 服务，IIS 托管该服务。

我的服务接受 XML 文件作为输入，当大小超过 65KB 时，我收到以下错误消息：

**远程服务器返回错误：(400) 错误请求。**

我的问题是双重的，首先是 IIS 服务器为 POST 请求设置了默认限制，其次如何更新它？

非常感谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-26T01:59:19.960

John Källén 的回答是正确的，但在我的情况下，我定义了一个端点，因此设置 maxReceivedMessageSize 必须如下：

```
<standardEndpoints>
    <webHttpEndpoint>
        <standardEndpoint name="" 
                         helpEnabled="true" 
                         automaticFormatSelectionEnabled="true"                   
                         maxReceivedMessageSize="2147483647">
        </standardEndpoint>
    </webHttpEndpoint>
</standardEndpoints> 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-02-26T00:50:31.333

您是否尝试将以下内容添加到您的 web.config 中？

```
<system.webServer>
<security>
    <requestFiltering>
        <requestLimits maxAllowedContentLength="1000000" />
    </requestFiltering>
</security>
<system.webServer> 
```

这会将您允许的内容长度增加到一兆字节。此外，您可能希望将 WCF 绑定的 maxReceivedMessageSize 属性设置为大于默认的 64k：

```
<webHttpBinding>
    <binding name="MessageSizeWeb" maxReceivedMessageSize="2147483647" />
</webHttpBinding> 
```

# c++ - 如何进行 netstat 以查看 C++ 中是否正在使用端口？

> ID：15079403
> 
> 赞同：1
> 
> 时间：2013-02-26T00:49:35.577
> 
> 标签：c++, port, netstat

在命令提示符下，我可以运行 netstat 以查看单个端口是否已在机器上使用，如下所示：

```
netstat -nap | grep <port-num> 
```

我可以在 Linux 上调用 C++ 中的哪些函数来查看当前是否正在使用特定端口？我宁愿不对 netstat 本身进行系统调用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T00:57:22.800

如果你这样做：

```
strace netstat -nap 
```

您可以推断 netstat 正在做什么来获取该信息。

例如：

```
open directory: openat(AT_FDCWD, "/proc/2073/fd", ...) = 4)
get entries: getdents(4, /* 15 entries */, 32768)    = 360
read symbolic links: readlink("/proc/2073/fd/4", "socket:[48395]", 29) = 14 
that one was a socket connected on port 48395 
```

# android - Qt/Necessitas - 合理的 QFileDialog 替换/皮肤？

> ID：15079406
> 
> 赞同：6
> 
> 时间：2013-02-26T00:49:49.187
> 
> 标签：android, qt, qt4, qt-necessitas

我正在寻找一种将 Qt 应用程序移植到 Qt/Necessitas (Android) 的好方法。

一些 QtGUI 小部件非常糟糕——不幸的是，包括 QFileDialog。

你知道有什么外观和感觉合适的替代品吗？对于 Necessitas 开发人员来说，让 QFileDialog 可以在任何接近高优先级的地方使用吗？

```
#include <QApplication>

#include <QFileDialog>

int main(int argc, char* argv[]) {
    QApplication a(argc, argv);

    QString fileName = QFileDialog::getOpenFileName(NULL,
      QObject::tr("Open Image"), "/home/jana", QObject::tr("Image Files (*.png *.jpg *.bmp)"));

    a.exec();
} 
```

![QFileDialog](../Images/edc572ad15ff1133a50ed2e358f89136.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-05-27T16:12:09.197

Android 没有自己的原生文件对话框。我们可以使用 QtAndroidExtras 调用能够选择文件的外部应用程序：

![选择外部应用程序](../Images/8c47ad533e0fb7253f26769a0f476fb5.png)

我写了包装器，可以用来做这个。这是完整的代码：

androidfiledialog.h

```
#ifndef ANDROIDFILEDIALOG_H
#define ANDROIDFILEDIALOG_H

#include <QObject>
#include <QAndroidJniObject>
#include <QtAndroid>
#include <QAndroidActivityResultReceiver>

class AndroidFileDialog : public QObject
{
    Q_OBJECT

public:
    explicit AndroidFileDialog(QObject *parent = 0);
    virtual ~AndroidFileDialog();
    bool provideExistingFileName();

private:
    class ResultReceiver : public QAndroidActivityResultReceiver {
        AndroidFileDialog *_dialog;
    public:
        ResultReceiver(AndroidFileDialog *dialog);
        virtual ~ResultReceiver();
        void handleActivityResult(int receiverRequestCode, int resultCode, const QAndroidJniObject &data);
        QString uriToPath(QAndroidJniObject uri);
    };

    static const int EXISTING_FILE_NAME_REQUEST = 1;
    ResultReceiver *receiver;
    void emitExistingFileNameReady(QString result);

signals:
    void existingFileNameReady(QString result);
};

#endif // ANDROIDFILEDIALOG_H 
```

androidfiledialog.cpp

```
#include "androidfiledialog.h"

AndroidFileDialog::ResultReceiver::ResultReceiver(AndroidFileDialog *dialog) : _dialog(dialog) {}
AndroidFileDialog::ResultReceiver::~ResultReceiver() {}

void AndroidFileDialog::ResultReceiver::handleActivityResult(int receiverRequestCode, int resultCode, const QAndroidJniObject &data)
{
    jint RESULT_OK = QAndroidJniObject::getStaticField<jint>("android/app/Activity", "RESULT_OK");
    if (receiverRequestCode == EXISTING_FILE_NAME_REQUEST && resultCode == RESULT_OK) {
        QAndroidJniObject uri = data.callObjectMethod("getData", "()Landroid/net/Uri;");
        QString path = uriToPath(uri);
        _dialog->emitExistingFileNameReady(path);
    } else {
        _dialog->emitExistingFileNameReady(QString());
    }
}

QString AndroidFileDialog::ResultReceiver::uriToPath(QAndroidJniObject uri)
{
    if (uri.toString().startsWith("file:", Qt::CaseInsensitive)) {
        return uri.callObjectMethod("getPath", "()Ljava/lang/String;").toString();
    } else {
        QAndroidJniObject contentResolver = QtAndroid::androidActivity().callObjectMethod("getContentResolver", "()Landroid/content/ContentResolver;");
        QAndroidJniObject cursor = contentResolver.callObjectMethod("query", "(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;", uri.object<jobject>(), 0, 0, 0, 0);
        QAndroidJniObject DATA = QAndroidJniObject::fromString("_data");
        jint columnIndex = cursor.callMethod<jint>("getColumnIndexOrThrow", "(Ljava/lang/String;)I", DATA.object<jstring>());
        cursor.callMethod<jboolean>("moveToFirst", "()Z");
        QAndroidJniObject result = cursor.callObjectMethod("getString", "(I)Ljava/lang/String;", columnIndex);
        return result.isValid() ? result.toString() : QString();
    }
}

AndroidFileDialog::AndroidFileDialog(QObject *parent) : QObject(parent)
{
    receiver = new ResultReceiver(this);
}

AndroidFileDialog::~AndroidFileDialog()
{
    delete receiver;
}

bool AndroidFileDialog::provideExistingFileName()
{
    QAndroidJniObject ACTION_GET_CONTENT = QAndroidJniObject::fromString("android.intent.action.GET_CONTENT");
    QAndroidJniObject intent("android/content/Intent");
    if (ACTION_GET_CONTENT.isValid() && intent.isValid()) {
        intent.callObjectMethod("setAction", "(Ljava/lang/String;)Landroid/content/Intent;", ACTION_GET_CONTENT.object<jstring>());
        intent.callObjectMethod("setType", "(Ljava/lang/String;)Landroid/content/Intent;", QAndroidJniObject::fromString("file/*").object<jstring>());
        QtAndroid::startActivity(intent.object<jobject>(), EXISTING_FILE_NAME_REQUEST, receiver);
        return true;
    } else {
        return false;
    }
}

void AndroidFileDialog::emitExistingFileNameReady(QString result)
{
    emit existingFileNameReady(result);
} 
```

您必须添加到您的 *.pro 文件中：

```
QT += androidextras 
```

使用示例：

```
AndroidFileDialog *fileDialog = new AndroidFileDialog();
connect(fileDialog, SIGNAL(existingFileNameReady(QString)), this, SLOT(openFileNameReady(QString)));
bool success = fileDialog->provideExistingFileName();
if (!success) {
    qDebug() << "Problem with JNI or sth like that...";
    disconnect(fileDialog, SIGNAL(existingFileNameReady(QString)), this, SLOT(openFileNameReady(QString)));
    //or just delete fileDialog instead of disconnect
} 
```

插槽实现：

```
void MyClass::openFileNameReady(QString fileName)
{
    if (!fileName.isNull()) {
        qDebug() << "FileName: " << fileName;
    } else {
        qDebug() << "User did not choose file";
    }
} 
```

**请确认此解决方案在您的设备上正常工作。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-02T16:21:15.833

[通过使用开箱即用的QFileSystemModel](http://qt-project.org/doc/qt-4.8/qfilesystemmodel.html#details)类或[FolderListModel](https://doc.qt.io/qt-5/qml-qt-labs-folderlistmodel-folderlistmodel.html)元素，您可以使用 QtWidgets 或 QML 轻松构建自己的文件对话框。

至于是否优先，目前看来，Necessitas 将被 Digia 支持 Android 的努力所吸收。我怀疑适当地设置 QtWidgets 的样式会付出巨大的努力，因为该模块被标记为 DONE 并且 UI 的所有焦点都在 QML 上。所以，如果我是你，我不会屏住呼吸。再加上库存的 Qt 小部件在非桌面平台上看起来非常难看。

# favicon - Chrome 浏览器中的 j_security_check favicon 问题

> ID：15079408
> 
> 赞同：1
> 
> 时间：2013-02-26T00:49:53.070
> 
> 标签：favicon

我在 Glassfish 服务器中部署的 Web 应用程序使用 j_security_check 进行表单身份验证。我在成功登录后观察到，Chrome 浏览器将页面重定向到 /favicon.ico 而不是最初请求的页面。此行为仅在 Chrome 浏览器中观察到，并且是零星的。

任何帮助将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T12:19:03.600

这个问题现在已经解决了。我已将 favicon.ico 包含在 web.xml 文件的安全约束中。

# ios - 自动登录

> ID：15079412
> 
> 赞同：1
> 
> 时间：2013-02-26T00:50:02.960
> 
> 标签：ios, objective-c, simperium

我正在寻找一种加载 simperium 的方法，而无需在用户第一次输入他的信息后显示登录视图。

如果我在第一次之后不登录，这是我得到的：

> Simperium 错误：未加载存储桶列表。确保在获取任何对象之前启动 Simperium。

这是我用来初始化 Simperium 的：

```
self.simperium = [[Simperium alloc] initWithRootViewController:
                                    _window.rootViewController]; 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T01:10:39.540

考虑使用 OAuth。

OAuth 是一个系统，用户可以在其中为流行的服务（如 Google、Twitter、Facebook 或其他开放 ID 提供商）提供他们的凭据。

OAuth 不是在设备上缓存凭据，这将是不安全的，因为访问这些凭据将使用户可以访问大量系统，OAuth 获取主要的身份验证服务以提供令牌。

此令牌存储在设备上，可用于下次自动登录。

缺点是第一次设置可能非常棘手，因为有很多复杂性，更不用说标准是相当新的，所以规范中有一些演变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-19T20:14:36.563

Simperium 只需要用户凭据即可开始使用（应用程序 ID 和用户名/令牌）。如果您已经可以使用其他方式（例如使用 HTTP auth API：[https](https://simperium.com/docs/reference/http/#auth) ://simperium.com/docs/reference/http/#auth ）获取这些凭据，登录视图可以方便地为您获取这些凭据，那么您可以直接提供那些而不使用登录视图。请参阅[https://github.com/Simperium/simperium-ios/blob/develop/Simperium/SPAuthenticator.m中的方法](https://github.com/Simperium/simperium-ios/blob/develop/Simperium/SPAuthenticator.m)

# ruby-on-rails - 复杂的 Rails 排序

> ID：15079416
> 
> 赞同：0
> 
> 时间：2013-02-26T00:50:06.423
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在尝试从以下（简化）表中获取有序的结果列表：

```
create_table "evaluations", :force => true do |t|
  t.datetime "completed_at"
  t.datetime "created_at",          :null => false
end 
```

如果设置（非空），我想按`completed_at`（DESC）排序。`completed_at`如果`completed_at`为空，我想按`created_at`（DESC）排序。

有没有办法通过模型用 Rails 3 做到这一点？

我在本地机器上使用 sqlite，但在服务器上使用 pg（我将很快在两者上切换到 pg。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T00:57:09.530

我找到了我自己问题的答案，但我不确定它是否是最优雅的 Rails 3。如果有更好的方法很高兴！

```
Evaluations.order("CASE WHEN completed_at IS NULL OR THEN created_at ELSE completed_at END DESC") 
```

# ios - 如何将局部变量更改为实例变量？

> ID：15079419
> 
> 赞同：0
> 
> 时间：2013-02-26T00:50:21.977
> 
> 标签：ios, objective-c, cocoa

所以我对此完全陌生。我正在关注当地的天气教程

[http://www.icodeblog.com/2010/09/03/adding-local-weather-conditions-to-your-app-part-12-implementing-corelocation/](http://www.icodeblog.com/2010/09/03/adding-local-weather-conditions-to-your-app-part-12-implementing-corelocation/)

它没有按应有的方式工作。当我点击 RUN 时，会弹出一个窗口，提示您是否要允许此应用访问位置管理器。但是消息在我有机会点击它之前就消失了，然后应用程序什么也不做。

下面是我的代码......经过研究，我发现了这个信息

虽然很难追踪，但解决方案非常简单。

经过反复试验，我发现当您第一次尝试访问应用程序中的任何位置服务时会弹出位置访问对话框，如果`CLLocationManager`之前释放该对象，该对话框会自行消失（无需任何用户交互）用户响应对话框。

我正在我的方法中创建一个`CLLocationManager`实例。`viewDidLoad`由于这是该方法的本地实例，因此该实例`ARC`在方法执行完成后被释放。一旦实例被释放，对话框就消失了。解决方案相当简单。将`CLLocationManager`实例从方法级变量更改为类级实例变量。现在`CLLocationManager`实例只有在类被卸载后才会被释放。

这可能是答案，但我不知道如何从方法级别更改为类级别变量。

有人可以协助将其更改为类级别变量吗？

这是我的代码

```
#import <Foundation/Foundation.h>
#import <CoreLocation/CoreLocation.h>

@protocol LocationGetterDelegate <NSObject>
@required
- (void) newPhysicalLocation:(CLLocation *)location;
@end

@interface LocationGetter : NSObject
<CLLocationManagerDelegate>{
    CLLocationManager *locationManager;
    id delegate;
}

-(void)startUpdates;

@property (nonatomic, retain) CLLocationManager *locationManager;
@property (nonatomic, retain) id delegate;

@end

    #import "LocationGetter.h"
    #import <CoreLocation/CoreLocation.h>

@implementation LocationGetter

@synthesize locationManager,delegate;
BOOL didUpdate = NO;

- (void) startUpdates{
    NSLog(@"Starting Location Updates");

    if (locationManager == nil)
        locationManager = [[CLLocationManager alloc]init];
    locationManager.delegate = self;

    locationManager.desiredAccuracy = kCLLocationAccuracyKilometer;
    [locationManager startUpdatingLocation];
}

- (void)locationManager:(CLLocationManager *)manager didFailWithError:(NSError *)error
{
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Error" message:@"Your location could not be determined." delegate:nil cancelButtonTitle:@"OK" otherButtonTitles: nil];
    [alert show];
}

// Delegate method from the CLLocationManagerDelegate protocol.
- (void)locationManager:(CLLocationManager *)manage didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation
{
    if (didUpdate)
        return;

    didUpdate = YES;
    // Disable future updates to save power.
    [locationManager stopUpdatingLocation];

    // let our delegate know we're done
    [delegate newPhysicalLocation:newLocation];
}

@end

    #import <UIKit/UIKit.h>
    #import "LocationGetter.h"

@class ViewController;

@interface AppDelegate : UIResponder
    <UIApplicationDelegate, LocationGetterDelegate>
{
    UIWindow *window;
    ViewController *viewController;
    CLLocation *lastKnownLocation;

}

@property (retain, nonatomic) UIWindow *window;

@property (retain, nonatomic) ViewController *viewController;

@property (nonatomic, retain) CLLocation *lastKnownLocation;

@end

    #import "AppDelegate.h"
    #import "ViewController.h"
    #import "LocationGetter.h"

@implementation AppDelegate

@synthesize lastKnownLocation;
@synthesize viewController;
@synthesize window;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
//    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
//    // Override point for customization after application launch.
//    self.viewController = [[ViewController alloc] initWithNibName:@"ViewController" bundle:nil];
//    self.window.rootViewController = self.viewController;
//    [self.window makeKeyAndVisible];

    UIActivityIndicatorView *spinner = [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhiteLarge];
    spinner.center = CGPointMake(self.viewController.view.frame.size.width / 2, self.viewController.view.frame.size.height / 2);
    [spinner startAnimating];

    [viewController.view addSubview:spinner];

    // get our physical location
    LocationGetter *locationGetter = [[LocationGetter alloc] init];
    locationGetter.delegate = self;
    [locationGetter startUpdates];

    // Add the view controller's view to the window and display.
    [window addSubview:viewController.view];
    [window makeKeyAndVisible];

    return YES;
}

- (void)applicationWillResignActive:(UIApplication *)application
{
    // Sent when the application is about to move from active to inactive state. This can occur for certain types of temporary interruptions (such as an incoming phone call or SMS message) or when the user quits the application and it begins the transition to the background state.
    // Use this method to pause ongoing tasks, disable timers, and throttle down OpenGL ES frame rates. Games should use this method to pause the game.
}

- (void)applicationDidEnterBackground:(UIApplication *)application
{
    // Use this method to release shared resources, save user data, invalidate timers, and store enough application state information to restore your application to its current state in case it is terminated later. 
    // If your application supports background execution, this method is called instead of applicationWillTerminate: when the user quits.
}

- (void)applicationWillEnterForeground:(UIApplication *)application
{
    // Called as part of the transition from the background to the inactive state; here you can undo many of the changes made on entering the background.
}

- (void)applicationDidBecomeActive:(UIApplication *)application
{
    // Restart any tasks that were paused (or not yet started) while the application was inactive. If the application was previously in the background, optionally refresh the user interface.
}

- (void)applicationWillTerminate:(UIApplication *)application
{
    // Called when the application is about to terminate. Save data if appropriate. See also applicationDidEnterBackground:.
}

- (void)newPhysicalLocation:(CLLocation *)location {

    // Store for later use
    self.lastKnownLocation = location;

    // Remove spinner from view
    for (UIView *v in [self.viewController.view subviews])
    {
        if ([v class] == [UIActivityIndicatorView class])
        {
            [v removeFromSuperview];
            break;
        }
    }

    // Alert user
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Location Found" message:[NSString stringWithFormat:@"Found physical location.  %f %f", self.lastKnownLocation.coordinate.latitude, self.lastKnownLocation.coordinate.longitude] delegate:nil cancelButtonTitle:@"OK" otherButtonTitles: nil];
    [alert show];
}

@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T01:41:28.093

您需要解决一些问题。首先，你`locationManager`已经是一个实例变量。那里没有什么可以改变的。但是您声明`locationManager`了财产但从不使用它。摆脱财产或实际使用它。如果您保留该财产，则不需要公开它，因为没有外部班级使用它。

此外，您的`delegate`属性定义不正确。

您遇到的真正问题是由于您的应用程序委托实现。您创建一个本地实例，`LocationGetter`然后在方法结束时让它超出范围。您需要将`LocationGetter`实例变量添加到您的应用程序委托。这将允许实例比`didFinishLaunchingWithOptions:`方法保持更长时间。

以下是我将如何更新代码（假设启用了 ARC）：

LocationGetter.h：

```
#import <Foundation/Foundation.h>
#import <CoreLocation/CoreLocation.h>

@protocol LocationGetterDelegate <NSObject>
@required
- (void) newPhysicalLocation:(CLLocation *)location;
@end

@interface LocationGetter : NSObject

-(void)startUpdates;

@property (nonatomic, weak) id<LocationGetterDelegate> delegate;

@end 
```

LocationGetter.m:

```
#import "LocationGetter.h"
#import <CoreLocation/CoreLocation.h>

@interface LocationGetter () <CLLocationManagerDelegate>

@property (nonatomic, strong) CLLocationManager *locationManager;

@end

@implementation LocationGetter {
    BOOL didUpdate = NO;
}

- (void) startUpdates{
    NSLog(@"Starting Location Updates");

    if (self.locationManager == nil)
        self.locationManager = [[CLLocationManager alloc]init];
    self.locationManager.delegate = self;

    self.locationManager.desiredAccuracy = kCLLocationAccuracyKilometer;
    [self.locationManager startUpdatingLocation];
}

- (void)locationManager:(CLLocationManager *)manager didFailWithError:(NSError *)error
{
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Error" message:@"Your location could not be determined." delegate:nil cancelButtonTitle:@"OK" otherButtonTitles: nil];
    [alert show];
}

// Delegate method from the CLLocationManagerDelegate protocol.
- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation
{
    if (didUpdate)
        return;

    didUpdate = YES;
    // Disable future updates to save power.
    [manager stopUpdatingLocation];

    // let our delegate know we're done
    [self.delegate newPhysicalLocation:newLocation];
}

@end 
```

AppDelegate.h：

```
#import <UIKit/UIKit.h>

@class ViewController;

@interface AppDelegate : UIResponder <UIApplicationDelegate>

@property (strong, nonatomic) UIWindow *window;
@property (strong, nonatomic) ViewController *viewController;
@property (nonatomic, strong) CLLocation *lastKnownLocation;

@end 
```

AppDelegate.m:

```
#import "AppDelegate.h"
#import "ViewController.h"
#import "LocationGetter.h"

@interface AppDelegate () <LocationGetterDelegate>
@property (nonatomic, strong) LocationGetter *locationGetter;
@end

@implementation AppDelegate

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
//    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
//    // Override point for customization after application launch.
//    self.viewController = [[ViewController alloc] initWithNibName:@"ViewController" bundle:nil];
//    self.window.rootViewController = self.viewController;
//    [self.window makeKeyAndVisible];

    UIActivityIndicatorView *spinner = [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhiteLarge];
    spinner.center = CGPointMake(self.viewController.view.frame.size.width / 2, self.viewController.view.frame.size.height / 2);
    [spinner startAnimating];

    [viewController.view addSubview:spinner];

    // get our physical location
    self.locationGetter = [[LocationGetter alloc] init];
    self.locationGetter.delegate = self;
    [self.locationGetter startUpdates];

    // Add the view controller's view to the window and display.
    [window addSubview:viewController.view];
    [window makeKeyAndVisible];

    return YES;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T01:24:14.407

我认为您的意思是将其更改为*实例变量*而不是*类变量*（Objective-C 没有这样的概念）。好吧，你已经这样做了。住在这里的任何东西：

```
@interface Foo : SuperFoo
{
    //...
} 
```

或者在这里：

```
@implementation Foo
{
    //...
} 
```

是一个实例变量。

# java - Java API 中 LinkedList 类中的“标头”

> ID：15079428
> 
> 赞同：0
> 
> 时间：2013-02-26T00:51:18.383
> 
> 标签：java, linked-list

在阅读 LinkedList 文档时，我对“标题”的使用感到有些困惑。通常，标头是linkedList 中的第一个节点。但在这里看起来“标题”是列表中的一个虚拟节点，它指向列表的第一个和最后一个节点，从而使 LinkedList 成为一个循环节点。真的吗？

```
private transient Entry<E> header = new Entry<E>(null, null, null);
public LinkedList() {
    header.next = header.previous = header;
}

public E getFirst() {
    if (size==0)
        throw new NoSuchElementException();

    return header.next.element;
}

public E getLast()  {
    if (size==0)
        throw new NoSuchElementException();

    return header.previous.element;
}

public E removeFirst() {
    return remove(header.next);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T00:55:55.863

> 但在这里看起来“标题”是列表中的一个虚拟节点，它指向列表的第一个和最后一个节点

这是真的

> 从而使 LinkedList 成为循环列表。

这并不完全正确：从结构上讲，列表确实是循环的，因为标题“循环”了它。这只是一个实现细节，一个常见的技巧，可以让您避免声明两件事 (`header`和`tailPiece`) 而不是一个。同一条目本身用于两端的事实不足以使列表循环：您无法“从外部”围绕最后一个节点循环，因为这会`count`阻止您这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T00:57:09.190

你是对的。`header`存储对列表头部和尾部的引用。这有助于降低列表两端的删除/添加/查看操作成本。

随着对两端的引用的可用性，诸如`getFirst`, `getLast`, `removeFirst`, `removeLast`,`addFirst`等的`addLast`操作不需要列表遍历。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T00:55:16.783

循环列表是一种避免在顶层结构中同时存储头指针和尾指针的廉价方法。我不知道 Java 的`LinkedList`实现，但这肯定是一个技巧，例如`std::list`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T01:07:44.773

的实现`LinkedList`是使用所谓的 s *sentinel*节点。他们选择了对头部和尾部使用一个哨兵；其他实现将使用两个独立的哨兵。

在任何一种情况下，使用哨兵都允许其余的实现代码不处理 null 情况。例如，考虑添加一个节点。没有哨兵：

```
Node newNode = ...;
if (header == null) {
  header = newNode;
  tail = newNode;
} else {
  newNode.previous = tail;
  tail.next = newNode;
  tail = newNode;
} 
```

与哨兵：

```
Node newNode = ...;
newNode.previous = sentinel.previous;
newNode.next = sentinel;
sentinel.previous = newNode; 
```

这是[关于 Sentinel Nodes 的维基百科文章](http://en.wikipedia.org/wiki/Sentinel_node)。

# javascript - 函数退出后全局变量的值错误

> ID：15079433
> 
> 赞同：0
> 
> 时间：2013-02-26T00:51:54.127
> 
> 标签：javascript, dom-events, global-variables

我正在构建一个注册表单，并且当用户名可用、密码足够复杂且确认密码与第一个密码匹配时启用提交按钮的 JavaScript 部分有问题。由于某种原因`passwordStrong`总是错误的并且`passwordsMatch`总是未定义的。

```
userNameAvailable = false
passwordStrong = false
passwordsMatch = false
submitButton = null;

function checkAvailability(name, avalabilityDiv)
{
    if(name.length == 0)//this happens when a name is entered but backspaced OR the shift key is pressed (and nothing else)
    {
        avalabilityDiv.innerHTML = "Please enter a name"
        userNameAvailable = false
    }
    else
    {
        var xmlhttp, responseText
        if(window.XMLHttpRequest)
        {// code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp=new XMLHttpRequest();
        }
        else
        {// code for IE6, IE5
            xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
        }
        xmlhttp.onreadystatechange=function()
        {
            if(xmlhttp.readyState == 4 && xmlhttp.status == 200)
            {
                responseText = xmlhttp.responseText;
                avalabilityDiv.innerHTML = responseText//responseText is the property of XMLHttpRequest object that holds server's response
                if(responseText == "available")
                    userNameAvailable = true
                else
                    userNameAvailable = false
            }
        }
        xmlhttp.open("GET", "process.php?pName="+name,true);
        xmlhttp.send();
    }
}

/*
Checks if password contains at least two characters from at least two categories: letter, number, other
sets passwordStrong true if does, otherwise false
*/
function passwordStrength(pass, strengthDiv)
{
    if(pass.length < 8)//check passwords length
    {
        strengthDiv.innerHTML = "too short!"
        //passwordStrong = false
        return
    }
    var group = [0, 0, 0, 0]
    for(i = 0, c = pass.charAt(0); i < pass.length; ++i, c = pass.charAt(i))
        group[typeOfChar(c)]++

    var result = 0
    for(var i = 0; i < group.length; i++)
        if(group[i] >= 2)
            result++

    if(result >= 2)
    {
        var passwordStrong = true
        strengthDiv.innerHTML = "Good."
        alert("passwordStrong: "+passwordStrong)
    }
    else
    {
        //var passwordStrong = false
        strengthDiv.innerHTML = "too simple!"
    }
}

/*used by isPasswordStrong()*/
function typeOfChar(c)
{
    var ascii = c.charCodeAt(0)

    if(ascii >= 48 && ascii <= 57)//is a digit
        return 0
    else if(ascii >= 65 && ascii <= 90)//is upper case letter
        return 1
    else if(ascii >= 97 && ascii <= 122)//is lower case letter
        return 2
    else//is other character(e.g. grammar character)
        return 3
}

/*
Checks to see if confirmation password is same as first password
sets passwordsMatch true if same, otherwise false
*/
function matchPasswords(first, second, matchDiv)
{
    matchDiv.innerHTML = "first: "+first.value+" second: "+second.value+"<br />"+userNameAvailable+" "+passwordStrong+" "+passwordsMatch+" done"
    if(first.value == second.value)
        var passwordsMatch = true
    else
        var passwordsMatch = false
}

/*This always shows that passwordStrong is false*/
function output()
{
    alert("From output() passwordStrong: "+passwordStrong)
}

function toggleSubmit()
{
    alert("here1 passwordStrong: "+passwordStrong)
    if(submitButton == null)//may be cached
        submitButton = document.getElementById("submit")
    if(userNameAvailable && passwordStrong && passwordsMatch)
        submitButton.disabled = false
    else
        submitButton.disabled = true
} 
```

即使 HTML “好”。`passwordStrength()`在函数退出后显示，变量`passwordStrong`变为假。为什么？

我没有使用 JQuery。

编辑：是的，它修复了它。你们是怎么知道的？我所有的故障排除技术都没有找到这个来源。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T00:55:46.303

`var`当您在函数中引用这些变量时，请去掉关键字。

通过使用`var`，您正在制作与相对全局变量同名的**局部变量，因此全局变量被“隐藏”。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T00:56:11.723

`var`在您所在的任何地方的本地范围内创建一个变量（在您的情况下通常在函数内部）。这*会重载*更高范围内的任何变量，包括全局变量。相反，`var`在所有“全局”变量的开头使用，并且永远不要`var`在任何其他范围内再次使用它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T00:57:17.750

您已在 passwordStrength 函数的本地范围内声明了一个新变量 passwordStrong，因此 passwordStrength 函数永远不会触及全局变量“passwordStrong”。

```
if(result >= 2)
{
    var passwordStrong = true // i mean this one...
    strengthDiv.innerHTML = "Good."
    alert("passwordStrong: "+passwordStrong)
} 
```

应该如下替换

```
if(result >= 2)
{
    passwordStrong = true;
    strengthDiv.innerHTML = "Good."
    alert("passwordStrong: "+passwordStrong)
} 
```

# mysql - 在使用 Laravel 4 的 Eloquent ORM 时如何使用我自己的列名？

> ID：15079434
> 
> 赞同：0
> 
> 时间：2013-02-26T00:51:56.033
> 
> 标签：mysql, laravel, laravel-4, eloquent, columnname

假设我有以下 MySQL 表：

```
CREATE TABLE backend_users(
id INT NOT NULL AUTO_INCREMENT,
userName VARCHAR(30) UNIQUE NOT NULL,
password VARCHAR(40) NOT NULL,
salt VARCHAR(16) NOT NULL,
needsNewPassword TINYINT(1) UNSIGNED NOT NULL,
forgotPasswordKey VARCHAR(8) NULL,
fullName VARCHAR(50) NOT NULL,
email VARCHAR(255) NOT NULL,
roleType INT NOT NULL,
enabled TINYINT(1) UNSIGNED NOT NULL,
created_at DATETIME NOT NULL,
updated_at DATETIME NOT NULL,
PRIMARY KEY (id)
) CHARACTER SET utf8 COLLATE utf8_general_ci; 
```

如何使用 Eloquent 模型使用上面的列名将新行记录到表中？如果我按照文档中的说明尝试：

```
$user = User::create(
array(
'userName' => 'emmanuel',
'password' => $encryptedPassword,
'salt' => $salt,
'needsNewPassword' => 0,
'fullName' => 'Emmanuel Figuerola',
'email' => 'somemail@gmail.com',
'roleType' => 0,
'enabled' => 1
)
); 
```

我收到以下错误：

> 例外：SQLSTATE [42S22]：未找到列：1054 '字段列表'中的未知列 'user_name'（SQL：插入`backend_users` ( `user_name`, `password`, `salt`, `needs_new_password`, `full_name`, `email`, `role_type`, `enabled`, `updated_at`, `created_at`) 值 (?, ?, ?, ?, ?, ？，？，？，？，？ 5 => 'somemail@gmail.com', 6 => 0, 7 => 1, 8 => DateTime::__set_state(array('date' => '2013-02-26 00:20:03', ' timezone_type' => 3, 'timezone' => 'UTC', )), 9 => DateTime::__set_state(array( 'date' => '2013-02-26 00:20:03', 'timezone_type' => 3, 'timezone' => 'UTC', )), ))

如果您不想阅读所有这些内容，这仅意味着 Eloquent 正在使用它想要的任何列名，而不是我的列名，即使我明确指定了每个列的名称和值。

我该怎么办？如果可能，请不要说“重命名列”，因为这意味着重命名很多列（我有很多表）。此外，我没有阅读任何关于列名的特定命名约定的信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-12T05:01:36.037

`BaseModel`您可以在 Models 目录中创建一个并扩展`Eloquent`该类，然后将

```
public static $snakeAttributes = false; 
```

到`BaseModel`.

从现在开始，如果你扩展`BaseModel`而不是`Eloquent`你的模型将使用你自己的命名约定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T15:23:44.363

Laravel 假设列名使用的是 snake_case 约定。这是 Eloquent 本身内置的。Laravel 实际上并不提前知道你的列名和表名。

可以扩展 Eloquent 并覆盖动态创建表和列名的任何方法。由于 Laravel 4 仍处于测试阶段，你需要保持你的扩展版本与任何上游更改保持同步。更新数据库架构的时间可能会更少，然后沿着这条路冒险。

# firebase - 导出火力基地

> ID：15079436
> 
> 赞同：11
> 
> 时间：2013-02-26T00:52:01.663
> 
> 标签：firebase, rest-firebase

我想知道是否可以在频繁的“循环”中导出 firebase 数据（可能作为 JSON 对象）。我问这个的主要原因是因为我想在特定时间点捕获数据，以便对它们执行一系列分析/识别特定模式。我对属于 Firebase API 的任何操作/方法感兴趣——可能是某种网络钩子​​，或者其他能让我做到这一点的解决方法！

任何建议都将不胜感激，因为我在网络/文档上找不到任何东西（也许我已经读过它了？）。

谢谢，亚历克斯

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-26T01:08:57.140

Firebase 有一个功能齐全的 REST API，所以最简单的方法就是定期轮询 REST API。REST API 文档在这里：[https ://www.firebase.com/docs/rest-api-quickstart.html](https://www.firebase.com/docs/rest-api-quickstart.html)

您还可以使用 Node.js 客户端获得对 Firebase 数据的完全访问权限。这允许您将回调附加到您的数据，并在您自己的服务器发生更改时立即对它们采取行动：[https ://www.firebase.com/docs/nodejs-quickstart.html](https://www.firebase.com/docs/nodejs-quickstart.html)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-04-15T05:37:17.270

Firebase 现在提供私有备份选项。有关更多信息 ，请[查看 Firebase 数据的私人备份](https://www.firebase.com/blog/2015-03-05-private-backups-for-firebase-data.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-13T09:08:55.183

您可以在 Json 对象中导出 Firebase 数据，只需发出如下所示的 curl 请求：

```
curl 'https://MyBase.firebaseio.com/MyPoint.json?auth=MyAuth&print=pretty' 
```

在linux终端中，您将获得所有子结构

# templates - 使用 XSLT 有选择地复制和更新 xml 节点

> ID：15079437
> 
> 赞同：-1
> 
> 时间：2013-02-26T00:52:10.307
> 
> 标签：templates, xslt, replace, copy, nodes

我正在使用需要复制和更新以传递以进行进一步处理的 xml。我遇到的问题是我还没有找到一种有效的方法来做到这一点。本质上，我想有条件地更新一些数据，然后复制所有未更新的节点。为什么这具有挑战性是由于要复制的节点的数量和名称的数量和差异。我也不想复制没有文本值的节点。这是一个例子：

**输入 XML**

```
 <root>
     <PersonProfile xmlns:'namespace'>
        <ID>0001</ID>
        <Name>
           <FirstName>Jonathan</FirstName>
           <PreferredName>John</PreferredName>
           <MiddleName>A</MiddleName>
           <LastName>Doe</LastName>
        </Name>
        <Country>US</Country>
        <Biirthdate>01-01-1980</Birthdate>
        <BirthPlace>
           <City>Townsville</City>
           <State>OR</State>
           <Country>US</Country>
        </Birthplace>
        <Gender>Male</Gender>
        <HomeState>OR</HomeState>
        ...
        <nodeN>text</nodeN>
     </PersonProfile>
 </root> 
```

“PersonProfile”节点只是“根”元素中的几个节点集之一，每个节点集都有自己的数据子集。例如邮寄地址、紧急联系信息等。我试图做的是更新节点，如果变量对它们有新值，然后复制所有未更新的节点。

**这是我当前的 XSLT**

```
 <xsl:stylesheet version="2.0" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

 <xsl:variable name='updateData' select='document("report")'/>

 <!-- Identity Transform -->
 <xsl:template match='@* | node()'>
     <xsl:if test'. != ""'>
        <xsl:copy>
            <xsl:apply-templates select='@* | node()'/>
        </xsl:copy>
      </xsl:if>
  </xsl:template>

 <!-- Template to update Person Profile -->
  <xsl:template match='PersonProfile'>   
    <xsl:copy>
        <xsl:apply-templates select='*'/>    
        <xsl:element name='Name'>
            <xsl:if test='exists($updateData/Preferred)'>
               <xsl:element name='FirstName'>
                  <xsl:value-of select='$reportData/FirstName'/>
               </xsl:element>
            </xsl:if>            
            <xsl:if test='exists($updateData/Preferred)'>
               <xsl:element name='PreferredName'>
                   <xsl:value-of select='$updateData/Preferred'/>
               </xsl:element>
            </xsl:if>
            <xsl:if test='exists($updateData/Middle)'>
            <xsl:element name='MiddleName'>
                <xsl:value-of select='$updateData/Middle'/>
            </xsl:element>
            </xsl:if>
            <xsl:if test='exists($updateData/LastName)'>
               <xsl:element name='LastName'>
                   <xsl:value-of select='$updateData/wd:LastName'/>
               </xsl:element>
            </xsl:if> 
         </xsl:element>
         <xsl:if test='exists($updateData/Country)'>
            <xsl:element name='Country'>
               <xsl:value-of select='$updateData/Country'/>
            </xsl:element>
         </xsl:if> 
         ....
         <!-- follows same structure until end of template -->
    </xsl:copy>
  </xsl:template>

 <!-- More Templates to Update other Node sets -->

</xsl:stylesheet> 
```

现在发生的事情是它正在复制所有节点，然后添加更新值。使用 Saxon-PE 9.3.0.5，我会得到类似这样的输出：

**样本输出**

```
 <root>
     <PersonProfile xmlns:'namespace'>
        <ID>0001</ID>
        <Name>
           <FirstName>Jonathan</FirstName>
           <PreferredName>John</PreferredName>
           <MiddleName>A</MiddleName>
           <LastName>Doe</LastName>
        </Name>
        <Country>US</Country>
        <Biirthdate>01-01-1980</Birthdate>
        <BirthPlace>
           <City>Townsville</City>
           <State>OR</State>
           <Country>US</Country>
        </Birthplace>
        <Gender>Male</Gender>
        <HomeState>OR</HomeState>
        ...
        <nodeN>text</nodeN>
        <PreferredName>Jonathan</PreferredName>
        <HomeState>WA</HomeState>
     </PersonProfile>
 </root> 
```

我意识到这种情况正在发生，因为我将模板应用于 PersonProfile 中的所有节点，并且我可以指定要排除哪些节点，但我觉得这是一个非常糟糕的解决方案，因为节点的数量可能超过 30 个或更多，并且这将需要为每个人提供书面价值。我相信 XML 有一个比明确列出每个节点更优雅的解决方案。我想有一个这样的出局：

**期望的输出**

```
 <root>
     <PersonProfile xmlns:'namespace'>
        <ID>0001</ID>
        <Name>
           <FirstName>Jonathan</FirstName>
           <PreferredName>Jonathan</PreferredName>
           <MiddleName>A</MiddleName>
           <LastName>Doe</LastName>
        </Name>
        <Country>US</Country>
        <Biirthdate>01-01-1980</Birthdate>
        <BirthPlace>
           <City>Townsville</City>
           <State>OR</State>
           <Country>US</Country>
        </Birthplace>
        <Gender>Male</Gender>
        <HomeState>WA</HomeState>
        ...
        <nodeN>text</nodeN>
     </PersonProfile>
 </root> 
```

如果有人可以帮助我创建一个适用于 xml 结构的模板结构，我将不胜感激。它需要是“可重用的”，因为有类似的节点结构，比如我必须将其应用到的 Person Profile，但节点名称和元素数量等不同。

提前感谢您的帮助！

*   Ĵ

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T04:32:59.110

这应该适用于您的原始问题：

```
<xsl:stylesheet version="2.0" 
                xmlns:xs="http://www.w3.org/2001/XMLSchema" 
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

  <xsl:variable name='updateData' select='document("report")'/>

  <!-- Identity Transform -->
  <xsl:template match='@* | node()' name='copy'>
      <xsl:copy>
        <xsl:apply-templates select='@* | node()'/>
      </xsl:copy>
  </xsl:template>

  <xsl:template match='*[not(*)]'>
    <xsl:variable name='matchingValue' 
                  select='$updateData/*[name() = name(current())]'/>
    <xsl:choose>
      <xsl:when test='$matchingValue'>
        <xsl:copy>
          <xsl:apply-templates select='@*' />
          <xsl:value-of select='$matchingValue'/>
        </xsl:copy>
      </xsl:when>
      <xsl:when test='normalize-space()'>
        <xsl:call-template name='copy' />
      </xsl:when>
    </xsl:choose>
  </xsl:template>
</xsl:stylesheet> 
```

至于插入源 XML 中不存在的新元素，这就比较棘手了。你能为此打开一个单独的问题吗？我可能对如何解决这个问题有一些想法。

# solaris - gmake：目标完成但 $(realpath ...) 没有找到它

> ID：15079439
> 
> 赞同：0
> 
> 时间：2013-02-26T00:52:22.223
> 
> 标签：solaris, gnu-make, nfs, realpath

环境资料：

*   运行 NFS 3 的 Solaris NFS 文件服务器
*   Linux 或 Solaris 环境中出现错误
*   使用 GNU Make 3.82
*   使用 Sun Studio 编译器，如果这很重要

这是我正在查看的构建的一个非常简化的示例：

```
all: ${list of shared objects to build}
  @do whatever

lib1.so: ${1s objects}
lib2.so: ${2s objects}
lib3.so: ${3s objects}
#...

%.so:
  $(call CHECK_DEPENDENCIES_EXIST)
  @${LD} ${LDFLAGS} ${^} -o ${@}

%.o : %.c
  @do stuff

%.o : %.cc
  @do stuff

define CHECK_DEPENDENCIES_EXIST =
$(if $(realpath ${^}),,$(warning No dependencies specified for ${@})false)
endef 
```

short & sweet: `$(realpath x y z)`(x/y/z 如果它们存在则返回；返回一个绝对路径，不包括符号链接) 在某些情况下从列表中删除文件，我认为它与 NFS 有关。无法预测哪个目标会失败。有时，目标在最后 10 次成功时会失败。如果我`@false`退出宏，构建会继续进行而不会出错——也就是说，链接器不会抱怨所谓的丢失文件。

我就不给你冗长的解释了；可以说，宏有助于调试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T21:26:49.113

原来gmake中有一个错误。来自 GNU Make 3.82 源代码，`function.c`在 2026 行或附近：

```
while ((path = find_next_token (&p, &len)) != 0 ) {
/* ... */
    if (
#ifdef HAVE_REALPATH
         realpath (in, out)
#else
         abspath (in, out) && stat (out, &st) == 0
#endif
       )
    {
      /* ... */
    }
  }
}
/* ... */ 
```

偶尔，各种调用`realpath`会被打断（`EINTR`）；这段代码中没有任何检查`errno`，所以它只是默默地失败。

所以，不是文件不存在，而是被`$(realpath ...)`信号中断（可能是`gmake`信号完成的子实例或类似的东西），并且这个函数不是为了从那种事件中恢复而设计的.

要解决问题：

```
while ((path = find_next_token (&p, &len)) != 0 ) { 
```

...变成：

```
while ( errno == EINTR || (path = find_next_token (&p, &len)) != 0 ) { 
```

将`||`快捷方式并阻止它继续前进到下一个令牌。

# android - 任何通过网络在android上交换消息（发布/订阅）的库？

> ID：15079440
> 
> 赞同：1
> 
> 时间：2013-02-26T00:52:23.990
> 
> 标签：android, network-programming, message-queue, publish-subscribe

我正在android上构建一个服务器/客户端应用程序。有很多客户端会使用wifi连接到服务器，服务器会向客户端广播更新消息，客户端会向服务器发送查询消息。

我用线程和套接字实现了它，对我来说它看起来太复杂了。有没有我可以使用的库，所以我不需要关心低级别的东西（例如检查连接是否有效并在必要时重新连接）？

更新：部署环境只有局域网（WIFI），不能上网。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-02-26T01:03:48.930

你看过[谷歌云消息](http://developer.android.com/google/gcm/index.html)吗？

> Google Cloud Messaging for Android (GCM) 是一项服务，可让您将数据从服务器发送到用户的 Android 设备。这可能是一条轻量级消息，告诉您的应用程序要从服务器获取新数据（例如，朋友上传的电影），也可能是一条包含高达 4kb 有效负载数据的消息（因此即时消息等应用程序可以直接消费消息）。
> 
> GCM 服务处理消息排队和传递到目标设备上运行的目标 Android 应用程序的所有方面。无论您的消息传递需求有多大，GCM 都是完全免费的，并且没有配额。

# android - 片段在返回而不是方向更改时丢失数据

> ID：15079441
> 
> 赞同：0
> 
> 时间：2013-02-26T00:52:41.447
> 
> 标签：android, android-fragments, restore, android-listfragment, android-lifecycle

我有活动 A 和片段 A（ListFragment）。单击时，流程转到活动 B 和片段 B。

当在 Activity/Fragment A 上时，列表数据保存在`onSaveInstanceState`（使用 parcelable arraylist）中，并且适用于方向更改。转到 Activity/Fragment B 时，状态被保存，但是我不知道如何在返回时恢复状态。

似乎没有调用可以恢复状态的生命周期事件。

有什么建议么？

# python - 在 Python 中运行 Git 克隆命令

> ID：15079442
> 
> 赞同：5
> 
> 时间：2013-02-26T00:52:42.147
> 
> 标签：python, git

我是 Python 和 Git 的新手。我正在编写一个 Python 脚本，该脚本需要执行与通过在 Linux 服务器上的工作区运行以下 git 命令所完成的操作相同的操作。（即/local/mnt/workspace/）

```
git clone git://git.xyz.com/platform/manifest.git -b jb_2.5 
```

我尝试使用 Fab 库，但未安装模块 fabric.api，所以我无法继续。还，

```
import git
git.Git().clone("git://git.xyz.com/platform/manifest.git") 
```

没用。

还有其他解决方案吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-26T01:01:46.460

您可以定义一个允许您调用 git 的 git 函数。出于安全目的，限制用户使用 git 命令很重要；否则，请求 git url 并使用其他技术可能会导致数据丢失或其他恶意攻击。

```
import subprocess

def git(*args):
    return subprocess.check_call(['git'] + list(args))

# examples
git("status")
git("clone", "git://git.xyz.com/platform/manifest.git", "-b", "jb_2.5") 
```

将其更改为`subprocess.check_output`允许您查看输出 git 打印，而不是确定成功（例如`git("status")`，如果您不在 git repo 中，则会引发异常）。

* * *

旁注：看看旨在帮助安装常用软件包的[PIP 。](https://pypi.python.org/pypi/pip)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-26T01:00:41.160

您可以使用（通过`os.system`或`subprocess`）或使用[GitPython](https://gitpython.readthedocs.io/en/stable/)包。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T01:42:53.763

由于您没有显示超出“不起作用”的错误，因此很难猜测您的问题到底是什么。

但我猜问题是`import git`引发了`ImportError`，因为您从未安装过`git`您尝试使用的模块。

如果是这样，告诉您如何操作的完全相同的自述文件也`git.Git().clone("git://git.xyz.com/platform/manifest.git")`将告诉您如何安装它。

但最有可能的是，您所需要的只是类似`pip install pygit2`或`pip install GitPython`类似的东西。（您可能需要`sudo`，并且您可能需要先安装`pip`才能使用它，等等，但由于我们对您的平台或您的知识水平一无所知，因此无法准确猜测您需要什么。）

# scala - 如何深度复制混合了特征的类

> ID：15079444
> 
> 赞同：3
> 
> 时间：2013-02-26T00:52:42.397
> 
> 标签：scala, traits, deep-copy

这是一些示例 scala 代码。

```
abstract class A(val x: Any) {  
    abstract def copy(): A  
}  

class b(i: Int) extends A(i) {  
    override def copy() = new B(x)  
}  

class C(s: String) extends A(s) {  
    override def copy() = new C(x)  
}  

//here's the tricky part  
Trait t1 extends A {  
    var printCount = 0  

    def print = {  
        printCount = printCount + 1  
        println(x)  
    }  

    override def copy = ???  
}  

Trait t2 extends A {  
    var doubleCount = 0  

    def doubleIt = {  
        doubleCount = doubleCount + 1  
        x = x+x  
    }  

    override def copy = ???  
}  

val q1 = new C with T1 with T2  
val q2 = new B with T2 with T1 
```

好的，正如您可能已经猜到的那样，这就是问题所在。如何在 T1 和 T2 中实现复制方法，以便它们与 B、C 或 t2/t1 混合在一起，我得到整个蜡球的副本？例如，q2.copy 应该返回一个带有 T2 和 T1 的新 B，而 q1.copy 应该返回一个带有 T1 和 T2 的新 C

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T11:55:09.317

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T06:46:24.937

这就是为什么不推荐扩展案例类的原因之一。你应该得到一个编译器警告。中定义的复制方法应该如何`A`知道也可能存在 a`T`或其他？通过扩展 case 类，您打破了编译器在生成和等方法`equals`时所做的所有假设。`copy``toString`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-26T02:38:03.757

最简单和最简单的答案是将您的具体类型变成案例类。然后，您将获得编译器提供的`copy`方法，该方法接受所有类的构造函数参数的命名参数，因此您可以有选择地将新值与原始值区分开来。

# c++ - 在 C++ 中检查字符串的先前元素

> ID：15079446
> 
> 赞同：0
> 
> 时间：2013-02-26T00:53:00.367
> 
> 标签：c++, arrays, string, numbers

```
#include <iostream>
#include <string>

using namespace std;

int main()
{

    string a;
    cin >> a;

    int index = a.find('?');

    if(a[index]-1==3)
    {
        if(a[index]-2==3)
        {
            cout << "cool" << endl;
        }
    }

    return 0;
} 
```

我到目前为止的代码。我正在做一个在线挑战，这里是文本（由我自己翻译，因为它是我的母语）。

您输入一个给定的数字“N”您的数字将是多长时间。之后，您输入 N 个数字和一个“？” 在号码中。

所以，挑战在于找到我们是否可以形成一个“酷”的数字。如果一个幸运数字连续包含至少 2 个二（如“35225”）、连续至少三个三（如“353333”）、连续至少五个五（如“55555237”，则该幸运数字称为“酷” ”），至少连续 7 个七人制（如“777777777”），或以上任意组合（如“333522227”）。

我的工作是编写一个程序，它将读取由数字 2、3、5 和 7 和问号 (?) 组成的字符串 S，并输出 S 中的问号是否可以替换为数字 2， 3、5 和 7 以得到一个很酷的数字（每个问号只能用一位数字代替）。

如果输入字符串可以变成很酷的数字，程序应该输出“cool”，否则应该输出“boring”（为了清楚起见，引用）。

示例：输入

```
8
233?5757 
```

输出

```
cool 
```

输入

```
10
57?5?757?3 
```

输出

```
boring 
```

欢迎任何建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T00:55:20.770

`a[index - 1]`访问字符串中的前一个字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T01:43:36.300

许多事：

```
cin >> a; 
```

不检查您是否实际读取了变量...我建议：

```
if (cin >> a) 
{
    // use a...

} 
```

下一个...

```
int index = a.find('?');
if(a[index]-1==3) 
```

在这里，它应该是`a[index - 1]`，但只有在 时才有效`index > 0`。尝试访问 < 0 的元素具有未定义的行为 - 基本上这意味着您将得到垃圾结果或崩溃。如果你使用`a.at(index - 1)`编译器，如果你的代码创建了一个无效的索引，编译器会抛出一个异常——这更安全：然后你可以找出原因并修复你的代码。

其次，字符以 ASCII 表示形式存储。要获得 ASCII 数字 3，您需要在程序中编码“3” `a[index - 1] == '3'`：.

更一般地说，回答这个问题的最快方法是从右到左扫描：如果你看到一个数字，然后检查那个数字是否开始了相同数字或“？”的其他实例的“酷”序列。如果您扫描并无法完成一个很酷的序列，您可以考虑不匹配的字符，在字符串中向左后退时添加一个“？”的计数，然后一旦到达字符串的开头非-'？' 您可以向前扫描到新字符。这有点棘手，但将是最有效的解决方案....

# c# - 从哪里获得线程安全的 Ghostscript 编译？

> ID：15079448
> 
> 赞同：2
> 
> 时间：2013-02-26T00:53:19.090
> 
> 标签：c#, ghostscript

新版本的 Ghostscript (9.07) 具有线程支持（可以是线程安全的），但它表示必须使用特殊标志编译代码才能启用此功能。

我该怎么做呢？或者我在哪里可以获得已经构建的线程安全版本？

我试图下载源代码，在 VS 中打开，但无法构建。所以也许有人已经这样做了并且可以共享 DLL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T08:16:10.477

您对 Ghostscript 的线程安全版本或多个渲染线程感兴趣吗？

只有在生成高分辨率输出时才使用多个渲染线程，因为代码必须首先解释 PostScript 程序（或 PDF 文件）并为渲染线程创建一个显示列表以进行操作。除非您渲染到相当高的分辨率，否则这实际上会比使用页面模式（在内存中渲染整个页面）慢

您可以使用 -dNumRenderingThreads 开关在 Ghostscript 的预构建版本中创建多个渲染线程。

如果你想要一个线程安全的 Ghostscript 版本，那么你需要能够自己编译 Ghostscript。您使用的是什么版本的 Visual Studio？我正在使用 Visual Studio 2005 和 2008，并且提供的解决方案适用于我（经过适当的转换）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-06-13T11:59:21.720

我也在寻找这个问题的解决方案，最终我在 Linux 中解决了它。也许它会帮助来这里寻找解决方案的人。在源目录中打开终端并键入以下命令：

```
./configure --enable-threadsafe 
```

之后你可以做`make`或`make so`为lib。这是从源代码构建 ghostscript 的文档的链接：[https](https://www.ghostscript.com/doc/9.23/Make.htm#Makefile_overview) ://www.ghostscript.com/doc/9.23/Make.htm#Makefile_overview 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-28T05:36:08.530

看看[**Ghostscript.NET**](https://ghostscriptnet.codeplex.com/)托管的 Ghostscript 包装器，如果您需要同时处理多个 pdf，它允许您同时运行多个 Ghostscript 库实例。

# c# - 如何根据数据库中的 Date\Time 运行代码

> ID：15079449
> 
> 赞同：0
> 
> 时间：2013-02-26T00:53:34.640
> 
> 标签：c#, .net, asp.net-mvc-4

我正在为一所小型学校构建应用程序。他们正在使用交易模型进行支付。

基本上它是这样工作的：
学生带来 N 美元（500 美元）的付款。老师安排他上几节课。一旦每节课完成（假设他安排在每周一和周五的 11.30 - 1.30 上课）。一节课100美元，所以。每个星期一和星期五我想从余额中减去 100。

以下是我正在考虑的解决方案：
1\. 创建一个每 10 分钟运行一次的计划作业，查看是否有任何计划过期并提交新的付款。
- 难以实施 - 可能的
托管问题
2\. 每次用户进入支付页面时，检查尚未提交的内容。
- 效率不高？

我不确定什么是解决此问题的好方法。

**编辑**

我们确实参加了，现在它是如何运作的：
我们有三个选项出席，缺席，缺席 w/excuse。所以，如果一个学生的账户上有钱，我们会自动假设他在场。如果他/她通知他/她不会来，我们让她： 缺席 w\借口不收费，否则如果有人缺席但报名了课程，我们仍然会向他收费。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T04:39:20.300

好吧，显然学生必须到课堂上才能被收费。所以有人将不得不输入学生在课堂上出现的某种信息。从那里它将减去每个学生的余额。

我选择这种方式的原因有很多。首先，当人们说他们的帐户被多收时，您可能会在帐户上发生争议。他们会想要记录他们被收费的天数。这与学校里有午餐账户的孩子没有什么不同。他们的父母每个月给他们这么多钱，但在学校吃饭。孩子们准备好午餐，收银员打开电脑检查孩子们的账户，然后扣除他们当天的食物金额。

他们有每天买东西的记录，以防发生纠纷，父母可以在线访问交易。省去了很多法律问题。如果代码中存在潜在错误，应避免完全自动化。如果您的系统犯了一个错误，您不希望人们提起诉讼或感到被敲诈。一切都应该准备好审计。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T01:04:18.240

我会选择第一个选项。第二个选项没有管理员检查当前帐户情况的可能性，因为用户的帐户只会在用户访问页面时更改。我敢肯定，在未来的某个时候，您的客户会将管理员功能添加到他的愿望清单中。如果您选择了选项 2，那么您将不得不重构您的应用程序。

# winapi - MASM - 查找浏览器窗口标题？

> ID：15079452
> 
> 赞同：0
> 
> 时间：2013-02-26T00:53:53.550
> 
> 标签：winapi, assembly, masm, masm32

我在我的应用程序中实现了一个 Webbrowser，有没有办法在 Webbrowser 中找到当前加载的文档的标题？

我想要实现的是浏览器重新加载网站，直到文档达到特定标题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:57:56.817

您在应用程序中实现了 IE 浏览器 com 对象？如果是这样，您可以获取“IHTMLDocument2”接口指针并调用“get_title”来获取标题字符串。或者，您也可以从“IHTMLDocument3”界面获取 html 源代码并自行解析。

参考：[从 CHtmlView (visual studio 6) 中检索 HTML 源代码](https://stackoverflow.com/questions/14719345/retrieve-html-source-from-chtmlview-visual-studio-6)

# php - 如何使这个面向对象？

> ID：15079458
> 
> 赞同：0
> 
> 时间：2013-02-26T00:54:29.563
> 
> 标签：php, mysql, ajax, pdo, object-oriented-database

目前我有下面的代码注册用户。

它不检查用户名当前是否存在或类似的东西，这是我想要实现的东西。

我从来不知道如何一起使用 php 对象和表单。任何帮助都感激不尽。

`register.php`

该页面检查用户是否已经登录，无论哪种方式，表单仍然显示并提交给它自己。数据库访问详细信息`config.php`作为常量存储。

```
<?php
session_start();

include("includes/config.php");

if(isset($_SESSION['username'])) {
    echo "You are currently logged in as: " . $_SESSION['username'];
    echo "<br />";
    include("nav.php");
    echo "<hr />";
}
?>
<!DOCTYPE html>
<html>
<head>
    <title>Register</title>
</head>
<body>
<?php

$odb = new PDO("mysql:host=" . DB_SERVER . ";dbname=" . DB_NAME, DB_USER, DB_PASS);

if (isset($_POST['firstName'])) {
    $firstName = $_POST['firstName'];
    $lastName = $_POST['lastName'];
    $username = $_POST['username'];
    $password = $_POST['password'];
    $password = md5(DB_SALT.$password);
    $type = $_POST['type'];
    $date=date("Y-m-d");                
    $time=date("H:i:s");

    $sql = "INSERT INTO tblMembers (firstName, lastName, username, passwordHash, type, joinedDate, joinedTime, lastActiveDate, lastActiveTime) VALUES (:firstName, :lastName, :username, :passwordHash, :type, :joinedDate, :joinedTime, :lastActiveDate, :lastActiveTime);";
    $query = $odb->prepare($sql);
    $results = $query->execute(array(
        ":firstName" => $firstName,
        ":lastName" => $lastName,
        ":username" => $username,
        ":passwordHash" => $password,
        ":type" => $type,
        ":joinedDate" => $date,
        ":joinedTime" => $time,
        ":lastActiveDate" => $date,
        ":lastActiveTime" =>$time
        ));
}
?>
<form method="post" action="">
    Name: <input type="text" id="firstName" name="firstName" value="Michael" /><br />
    Last Name: <input type="text" id="lastName" name="lastName" value="Norris" /><br />
    Username: <input type="text" id="username" name="username" value="mstnorris" /><br />
    Password: <input type="password" id="password" name="password" value="password" /><br />
    Type: <input type="text" id="type" name="type" value="4" /><br />
    <input type="submit" value="Add" />
</form>
</body>
</html> 
```

我知道如何使用类编写 php 对象。这是我以前的做法，尽管有人告诉我我使用的方法已经过时了。如果有人可以阐明如何更新它，那肯定会有所帮助。

```
<?php

require_once("database.php");

class Member extends DatabaseObject {
    protected static $table_name = "tblMembers";
    var $firstName = "Mike"; // initiating the $firstName variable
    var $lastName = "Norris"; // initiating the $lastName variable
    var $username = "mstnorris"; // initiating the $username variable
    var $password = "password"; // initiating the $password variable
    var $reviews = "0"; // initiating the $reviews variable
    var $type = "4"; // initiating the $type variable

    function __construct($firstName, $lastName, $username, $password, $reviews, $type) {
        $this->firstName = $firstName;
        $this->lastName = $lastName;
        $this->username = $username;
        $this->password = $password;
        $this->reviews = $reviews;
        $this->type = $type;
        //$this->insert($firstName, $lastName, $username, $password, $type);
    }

    function set_firstName($firstName) {
        $this->firstName = $firstName;
    }

    function get_firstName() {
        return $this->firstName;
    }

    function set_lastName($lastName) {
        $this->lastName = $lastName;
    }

    function get_lastName() {
        return $this->lastName;
    }

    function get_fullName() {
        if (isset($this->firstName) && isset($this->lastName)) {
            return $this->firstName . " " . $this->lastName;    
        } else {
            return "";
        }
    }

    function set_username($username) {
        $this->username = $username;
    }

    function get_username() {
        return $this->username;
    }

    function set_password($password) {
        $this->password = md5(DB_SALT.$password);
    }

    function get_password() {
        return $this->password;
    }

    public static function authenticate($username="", $password="") { 
        global $database;
        $username = $database->escape_value($username);
        $password = $database->escape_value($password);
        $passwordHash = md5(DB_SALT.$password);

        $sql = "SELECT * FROM tblMembers ";
        $sql .= "WHERE username = '{$username}' ";
        $sql .= "AND passwordHash = '{$passwordHash}' ";
        $sql .= "LIMIT 1";

        $result_array = self::find_by_sql($sql);
        if (!empty($result_array)) {
            //echo "true";
            return array_shift($result_array); // Pulling first element from array
        } else {
            //echo "false";
            return false; // Ability to ask whether we return something
        }

    }

    public function insert($firstName, $lastName, $username, $password) {
        $database = new Database();
        $database->query("INSERT INTO tblMembers VALUES ('','{$firstName}','{$lastName}','{$username}','{$password}','4')");
    }

    // Common Database Methods

    private static function instantiate($record) {
        $object = new self;

        foreach ($record as $attribute=>$value) {
            if ($object->has_attribute($attribute)) {
                $object->$attribute = $value;
            }
        }
        return $object;
    }

    public static function find_all() {
        return self::find_by_sql("SELECT * FROM ".self::$table_name);
    }

    public static function find_by_id($id=0) {
        global $database;
        $result_array = self::find_by_sql("SELECT * FROM ".self::$table_name." WHERE userID={$id} LIMIT 1");
        if (!empty($result_array)) {
            return array_shift($result_array); // Pulling first element from array
        } else {
            return false; // Ability to ask whether we return something
        }
    }   

    public static function find_by_sql($sql="") {
        global $database;
        $result_set = $database->query($sql);
        $object_array = array();
        while ($row = $database->fetch_array($result_set)) {
            $object_array[] = self::instantiate($row);
        }
        return $object_array;
    }

    private function has_attribute($attribute) {
        $object_vars = get_object_vars($this);
        return array_key_exists($attribute, $object_vars);
    }
}

?> 
```

MVC 方法可以与 AJAX 一起使用吗？另外，考虑到这一点，我之前在其他项目中使用的 AJAX 代码使用 $_GET，这是否有任何问题，因为数据永远不会发送到地址栏？如果是这样，我如何将 $_POST 与 AJAX 一起使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T01:43:27.953

麦克风：

你设置了一个 getter 和一个像这样的 setter：

```
class Spam
{
    public $attr;
    public $var;
    public $arg;

    /* __construct, __set, and __get 
      these are all special functions
      we know this from the double underscore */

    function __construct () 
    {
           // construction code
    }

    function __set ( $arg0, $arg1 )
    {    
           $this->$arg0 = $arg1;
    }

    function __get ( $arg )
    {
           return $this->$arg;
    }
} 
```

你可以从你的代码中调用它，如下所示：

```
// this calls the __constructor function
$barney = new Spam();

// this calls the __set function
$barney->attr = "garnished with spam & eggs";

// this calls the __get function
$attrValue = $barney->attr; 
```

这减少了调用不同方法来设置/获取变量值的需要。这仅适用于公共变量，因为不能从您的类外部访问私有和受保护的变量。

此外，拥有单独的视图、模型和控制器也是一个好主意。你的控制器是表单提交的脚本，你的模型是被实例化的类，你的视图是用户发送信息的地方。这将使您的代码更易于理解，而不是将您的控制器和视图放在一起。

由于某种原因，您是否仅限于 PHP4？或者您是否下载了一些非常旧的代码并且您现在正试图让它工作？

<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<[ 2.27.2013 更新 ]>>>>>>>>>>>>> >>>>>>>>>>>>>>>>>>>>>>

***结合 JavaScript AJAX 技术的 OOP PHP 编程***

*模型-视图-控制器：*

> MVC 并不特定于 PHP。MVC 是一种软件设计模式，旨在解决代码中的可维护性问题，它将代码的独立组件组合在一起，使代码的可读性降低且难以维护，这最终也是一种安全风险。模型-视图-控制器通常通过框架实现。关于 PHP，有一些可用的框架，例如 Zend、CodeIgniter、CakePHP 等。这些框架通过文档树实现模型视图控制器，尽管您可以创建自己的 PHP 框架（考虑到您的新手，这不是一个好主意语言），最好使用已经存在的语言。这些框架也可以强制执行他们自己的标准，从而产生更好的代码。
> 
> ![模型-视图-控制器](../Images/8f8625459844665f076ce0519916841b.png)
> 
> 要了解可维护的 MVC 框架，您应该熟悉完全用 PHP 编写网站 > >。这意味着您应该使用 PHP 类 [modules|models] 来动态生成 HTML 页面 [视图]，具体取决于用户所做的 [ **控制器**文件控制模型]。
> 
> 您的问题非常模糊，很难说出您的要求，但是，我的印象是您无法弄清楚 MVC 是什么以及如何使用它。假设您刚刚为将要开发的网站创建了布局。由于无法预测用户屏幕的大小，因此您的布局是在浏览器中设计的。您的布局 [或模板，如果您愿意的话] 应该是符合标准的 HTML5 或 XHTML。它不应该用图像构建。有些人可能不同意我的观点，但除了您的徽标/标题（尽管有些人也为此使用文本），您不应该将任何标签作为模板的一部分（这是在编写任何内容之前，显然您'可能希望在您的内容中使用大量图像）。此时您的视图应该是 HTML 和 CSS - 属于您的布局一部分的任何图像（即图案、背景、任何特定布局）都应该在您网站的 CSS 中。这与我们使用 MVC 模式的原因是一样的——它分离了应该分离的内容。
> 
> 你把你的布局当作 HTML，你写一个 PHP 类[模块] 包含函数，例如我们将使用 $view->showLeadboard();, $view->showAds(); $view->showFooter(); $view->setTitle("Title");, $view->setDescription("Description");... 这假设你已经实例化了你的类。也许您不想实例化一个类并且您更喜欢使用静态方法，选择权在您手中，但您应该了解自己做得足够好，以便有充分的理由这样做。
> 
> 现在您的视图保存在 PHP 模块中，您可以担心您的内容。很有可能，如果您的网站是动态的，那么这些页面上会有多个页面和位置，其中包含来自数据库的动态内容，或者向控制器提交数据的表单（我们仍在视图中）。
> 
> 假设有人在您的网站上注册。转到您的域并根据对 **www.site.com**的请求生成视图，生成的视图是索引页面。来到您页面的此人已决定使用您的服务注册一个帐户。他们单击“注册”超链接并生成另一个视图，显示一个表单供他们创建登录凭据。他们填写表格点击提交。表单中提供的信息被提交给控制器（我们现在不是在谈论 ajax 或为我们的 javascript 代码实现 MVC 设计模式），我们会说视图 **site.com/register**提交给控制器**站点.com/engine/process.php**。 *进程.php*过滤/清理表单中的用户数据并实例化正确的类（模型，我们将称之为一个*新的* ***User***）然后将通过其方法之一或什至通过其构造函数进行数据库调用（您应该知道PHP 中可用的魔法方法），并且此查询的结果会根据控制器告诉模型的内容和模型告诉视图的内容而使视图略有不同。

我什至不知道我能对你关于 AJAX 的问题说些什么——鉴于你在 PHP 方面的立场，我猜你正在使用 JQuery 进行 ajax 调用。如果是这种情况，您不需要从您的 jquery 文件实现模型视图控制器，您只需创建一个 jquery 脚本，然后向视图添加一个调用该脚本并实现它的方法。

**总而言之，如果你很难理解像 MVC 这样的常见模式是什么以及如何使用它，你应该真正回到基础。如果您不理解作者为什么使用他们使用的解决方案并且很可能他们没有向您解释这一点，因为有时您应该这样做，所以我不能强调在线教程对您没有帮助只要您对 php 语言、其语法以及如何解决问题有基本的了解，就能够了解自己。这一切都来自于花时间学习这门语言，了解它的工作原理，了解它做得不好和做得好的地方。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T01:51:18.953

好的，您有几个问题包含在一个大问题中，但我会尽力回答它们。我将按重要性顺序回答它们。

1.  你如何更新你的课程。
2.  如何更好地构建表格。
3.  如何检查登录状态。

1.  大多数应用程序现在使用某种形式的 MVC 架构。模型、视图和控制器是一种将职责分离到类的方法。这是一个关于 PHP 的 MVC 架构的简短[教程](http://php-html.net/tutorials/model-view-controller-in-php/)。话虽如此，您可以使用许多开源框架，例如[Zend](http://framework.zend.com/)、[CakePHP](http://cakephp.org/)等等。

    尝试使用 MVC 的策略之一或尝试框架。

2.  尽量不要让表单自己提交给自己。而是将其路由到单独的页面并在那里处理逻辑。您还可以使用`[]`符号将输入包装到数组中。例如：`<input type="text" name="user[firstname]" />`

    但是，如果您只是在做一个登录表单，那么您所需要的只是一些独特的身份证明和凭证（例如用户名和密码）。

3.  持久化用户登录状态有多种方式，主要使用的是会话和cookies。通常不赞成将整个模型存储在会话或 cookie 中。而是尝试将用户名和唯一键存储在数据库中，以便进行比较。使用 cookie 可以让您更好地控制您希望会话持续多长时间。

# php - 如何使用 foreach 循环来获取与标准相关的整个信息块：“大于”？

> ID：15079459
> 
> 赞同：1
> 
> 时间：2013-02-26T00:54:39.567
> 
> 标签：php

有谁知道如何使用 FOREACH 循环来获取与标准相关的整个信息块：“大于”用户发布的数字（在本例中为 $metsq=$_POST['metersq'];）
例如，在我发布的代码，如果用户写**90**，它应该只输出
color - blue
msq - 100
city - Prague

我试过这段代码，但显然我没有太多经验。提前致谢！

```
<?php

if(isset($_POST['button'])){
    $houses = array(
        'house1'=>array(
        'color'=>'green',
        'msq'=>100,
        'city'=>'Prague'
    ),

        'house2'=>array(
        'color'=>'red',
        'msq'=>30,
        'city'=>'Belgrade'
    ),
        'house3'=>array(
        'color'=>'blue',
        'msq'=>50,
        'city'=>'London'
    ),
        'house4'=>array(
        'color'=>'blue',
        'msq'=>50,
        'city'=>'Belgrade'
    )
);

$col=$_POST['colors'];
$metsq=$_POST['metersq'];
$cit=$_POST['cities'];

foreach($houses as $house=>$data) {
    foreach($data as $key=>$value) {
        if($value>=$metsq) {
            echo "$key - $value </br>";
        }
    } 
} else {
    echo "Go, search";
}
?>

<form action="?" method="post">
<select name="colors" >

<option>green</option></br>
<option>blue</option></br>
<option>red</option></br>
</select>

<input type="number" name="metersq" id="metersq" maxlength="3" />m2</br>

<select name="cities">

<option>Prague</option></br>
<option>Belgrade</option></br>
<option>London</option></br>
</select>

<input type="submit" value="Find" name="button"id="button" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T01:00:35.027

无需遍历房屋数据，只需遍历“msq”键：

```
foreach($houses as $house){
    if($house['msq']>=intval($metsq)){
        echo "msq - {$house['msq']} </br>";
    }
} 
```

[此外，您可能需要使用intval](http://php.net/manual/en/function.intval.php)确保它们是整数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T01:03:16.927

看起来您想将整个输出`house1`作为一组键/值对。

你非常接近：

```
foreach($houses as $house=>$data){
    if( $data['msq'] >= $metsq ) {
        foreach( $data as $key=>$value ) {
            echo "$key - $value <br>";
        }
    }
} 
```

您遇到的问题是，您实际上只是在特定键满足您的条件时才输出数据。但是你正在做这样的比较`blue >= 90`，可能会产生意想不到的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T01:00:52.093

您不需要嵌套的 foreach 循环。您只需要`msq`像这样比较数组的每个房屋元素中的键：

```
foreach($houses as $house=>$data){
    if ($data['msq'] >= $metsq) {
        // found a matching house so do something with it
        var_dump($house, $data);
    }
} 
```

# c++ - 如何管理来自网络的双重字节序

> ID：15079463
> 
> 赞同：4
> 
> 时间：2013-02-26T00:55:18.557
> 
> 标签：c++, c, network-programming, endianness, libpq

我对这个问题的答案有一个很大的问题[在 c++ 中交换位以获得双倍](https://stackoverflow.com/questions/2673409/swap-bits-in-c-for-a-double)

然而，这个问题或多或少是我要寻找的：我从网络收到一个双精度，我想在我的机器中正确编码它。

在我收到的情况下，我`int`使用以下代码执行此代码`ntohl`：

```
int * piData = reinterpret_cast<int*>((void*)pData);

//manage endianness of incomming network data 
unsigned long ulValue = ntohl(*piData);
int iValue = static_cast<int>(ulValue); 
```

但是如果我收到一个`double`，我不知道该怎么做。

问题的答案建议这样做：

```
template <typename T>
void swap_endian(T& pX)
{
    char& raw = reinterpret_cast<char&>(pX);
    std::reverse(&raw, &raw + sizeof(T));
} 
```

但是，如果我引用[这个网站](http://forums.codeguru.com/showthread.php?298741-C-General-What-do-ntohl%28%29-and-htonl%28%29-actually-do)：

`The ntohl() function converts the unsigned integer netlong from network byte order to host byte order. When the two byte orders are different, this means the endian-ness of the data will be changed. When the two byte orders are the same, the data will not be changed.`

相反，@GManNickG 对问题的回答**总是**与`std::reverse`.

考虑到这个答案是错误的，我错了吗？（在字节序的网络管理范围内，`ntohl`尽管在 OP 问题的标题中没有准确地说明，但它的使用暗示了这一点）。

最后：我应该将我的`double`分成两部分，每部分 4 个字节，然后`ntohl`在这两部分上应用函数吗？还有更多规范的解决方案吗？

C 语言中还有一个有趣的问题，[主机到网络双倍？](https://stackoverflow.com/questions/6084279/host-to-network-double)，但它限制为 32 位值。答案说由于架构差异，双打应该转换为字符串......我还将使用音频样本，我是否真的应该考虑将所有样本转换为我的数据库中的字符串？（双打来自我通过网络查询的数据库）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T01:03:40.203

如果你的双打是 IEEE 754 格式，那你应该还可以。现在您必须将它们的 64 位分成两个 32 位的一半，然后以大端顺序（即网络顺序）传输它们；

怎么样：

```
void send_double(double d) {
    long int i64 = *((reinterpret_cast<int *>)(&d)); /* Ugly, but works */
    int hiword = htonl(static_cast<int>(i64 >> 32));
    send(hiword);
    int loword = htonl(static_cast<int>(i64));
    send(loword);
}

double recv_double() {
    int hiword = ntohl(recv_int());
    int loword = ntohl(recv_int());
    long int i64 = (((static_cast<long int>) hiword) << 32) | loword;
    return *((reinterpret_cast<double *>(&i64));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T01:03:59.190

假设您有一个编译时选项来确定字节顺序：

```
#if BIG_ENDIAN
template <typename T>
void swap_endian(T& pX)
{
   // Don't need to do anything here... 
}
#else
template <typename T>
void swap_endian(T& pX)
{
    char& raw = reinterpret_cast<char&>(pX);
    std::reverse(&raw, &raw + sizeof(T));
}
#endif 
```

当然，另一种选择是根本不`double`通过网络发送 - 考虑到它不能保证与 IEEE-754 兼容 - 有些机器使用其他浮点格式......例如使用字符串会更好...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-27T22:02:27.970

我无法让 John Källén 代码在我的机器上运行。此外，将双精度转换为字节（8 位，1 个字符）可能更有用：

```
template<typename T>
string to_byte_string(const T& v)
{
    char* begin_ = reinterpret_cast<char*>(v);
    return string(begin_, begin_ + sizeof(T));
}

template<typename T>
T from_byte_string(std::string& s)
{
    assert(s.size() == sizeof(T) && "Wrong Type Cast");
    return *(reinterpret_cast<T*>(&s[0]));
} 
```

此代码也适用于使用 POD 类型的结构。

如果你真的想要双作为两个整数

```
double d;
int* data = reinterpret_cast<int*>(&d);

int first = data[0];
int second = data[1]; 
```

最后，`long int`将不总是一个 64 位整数（我不得不`long long int`在我的机器上使用 64 位整数）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-12-08T02:09:14.837

如果你想了解系统无字节序

只要`#if __cplusplus > 201703L`

```
#include <bit>
#include <iostream>

using namespace std;

int main()
{
    if constexpr (endian::native == endian::big)
        cout << "big-endian";
    else if constexpr (endian::native == endian::little)
        cout << "little-endian";
    else
        cout << "mixed-endian";
} 
```

欲了解更多信息：[https ://en.cppreference.com/w/cpp/types/endian](https://en.cppreference.com/w/cpp/types/endian)

# c - 如何确定一个线程在哪里接触另一个线程的堆栈？

> ID：15079476
> 
> 赞同：1
> 
> 时间：2013-02-26T00:56:06.190
> 
> 标签：c, windows, winapi

我正在通过 Intel 的 Inspector XE 运行一个应用程序，它告诉我我的一个线程正在访问另一个线程的堆栈，但它无法告诉我涉及哪些线程或它发生在代码中的什么位置。

我在想可能有某种每线程`VirtualProtect`或某种方式在上下文切换期间调用代码，但我找不到任何东西。

有什么方法可以让我捕捉到行为中的线索，还是我不走运？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T02:55:39.540

从线程创建例程开始。确保传递的指针不指向堆栈。你应该能够使用 grep 来帮助解决这个问题。例如。假设您使用 pthreads，`grep -E pthread_create\([^,]+\,[^,]+\,[^,]+\,[^&]+\& *.c`或者类似的东西可能会给您带来罪魁祸首，如果指针是在 pthread_create 函数调用中使用 & 运算符创建的。

您可能会考虑构建一个数组标识符列表，使用`grep -E "[[:alnum:]_]+[[:space:]]+[[:alnum:]_]+\[[^]]+]" *.c`，并基于函数内部声明的任何数组构建一个模式列表。

否则，`grep -E pthread_create *.c`至少会给你创建一个线程的每一行，以及传递到入口点的指针的表达式。如果该指针指向 malloc 的结构或指针（例如`fubar **argument; argument = malloc(sizeof *argument);`），则查找该结构或指针的修改位置，并确保它没有被修改为指向堆栈。

# sql-server-2008 - sql server 2008 导入向导中的有限 odbc 连接

> ID：15079480
> 
> 赞同：0
> 
> 时间：2013-02-26T00:56:41.217
> 
> 标签：sql-server-2008, sql-server-2000, pervasive-sql, sql-import-wizard

问题：普遍的 odbc 驱动程序（（称为：“普遍的 ODBC 引擎接口”）在 ODBC(odbcad32.exe) 中可见。但是，相同的 odbc 驱动程序在 SQL Server 2008 导入向导中不可见，尽管我可以看到相同的 odbc 驱动程序在 SQL Server 2000 导入向导中。

我正在使用带有 SQL server 2008、SQL server 2000 和普遍 SQL v11 的 32 位 win 7 操作系统。任何解决方案都会非常有帮助......非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-07T18:54:46.783

我永远无法弄清楚如何使“导入/导出”向导在 Sql Server Management Studio 中工作。正如我在另一个响应中看到的那样，我什至尝试修改“ProviderResources.xml”文件。

我试图迁移使用专有的“Timberline Data”ODBC 驱动程序的 Sage Timberline Office 数据。当您在 .NET 中调用“GetSchema”函数时，该驱动程序缺少“ORDINAL_POSITION”列。因此 Sql Server Management Studio 中的“导入/导出”失败。

我最终不得不编写自己的应用程序来将数据复制到 SQL 服务器。唯一的缺点是它不知道主键、索引或其他约束。尽管如此，我还是在 MSSQL 中获得了数据，所以我很高兴。

我相信这段代码对其他人有用，所以你去吧。

**程序.cs**

```
using System;
using System.Data.Odbc;
using System.Data.SqlClient;
using System.Data;
using System.Collections.Generic;
using System.Diagnostics;

namespace TimberlineOdbcSync
{
    class Program
    {
        static string currentTableName;

        const string sourceOdbcDriver = "{Timberline Data}"; 
        const string sourceOdbcDsn = "timberline data source";
        const string sourceOdbcUid = "user1";
        const string sourceOdbcPwd = "user1a";

        const string destSqlServer = "SERVER5";
        const string destSqlDatabase = "TSData";
        const string destSqlUsername = "";
        const string destSqlPassword = "";
        const string destSqlOwner = "dbo";

        public static void Main(string[] args)
        {
            DateTime allStartDate = DateTime.Now;
            DateTime allEndDate;

            DateTime tableStartDate = DateTime.Now;
            DateTime tableEndDate;

            TimeSpan diff;

            string errMsg;

            int pCount; //pervasive record count
            int sCount; //sql server record count

            string sourceOdbcConnString =  
                "Dsn=" + sourceOdbcDsn + ";" +
                "Driver="+ sourceOdbcDriver +";" +
                    (!string.IsNullOrEmpty(sourceOdbcUid) ? "uid="+ sourceOdbcUid +";" : "") + 
                    (!string.IsNullOrEmpty(sourceOdbcUid) ? "pwd="+ sourceOdbcPwd +";" : "");

            string destSqlConnString = 
                "Server=" + destSqlServer + ";" + 
                "Database=" + destSqlDatabase+ ";" +
                (!string.IsNullOrEmpty(destSqlUsername) && !string.IsNullOrEmpty(destSqlPassword) ? 
                 "User Id=" + destSqlUsername + ";" + 
                 "Password=" + destSqlPassword + ";" 
                 :
                 "Trusted_Connection=true;");

            try{
                using(OdbcConnection pConn = new OdbcConnection(sourceOdbcConnString)){

                    pConn.Open();

                    List<string> tables = new List<string>();

                    //get a list of all tables
                    using(DataTable tableschema = pConn.GetSchema("TABLES"))
                        foreach(DataRow row in tableschema.Rows)
                            tables.Add(row["TABLE_NAME"].ToString());

                    foreach(string tableName in tables){

                        //set the current table name
                        currentTableName = tableName;

                        try{

                            //get the schema info for the table (from pervasive)
                            DataTable dtSchema = pConn.GetSchema("Columns", new string[]{null, null, tableName});

                            //if we could not get the schema
                            if(dtSchema == null || dtSchema.Rows.Count <= 0){
                                pConn.Close();
                                errMsg = "Error: Could not get column information for table " + tableName;
                                Trace.WriteLine(errMsg);
                                WriteErrorEvent(errMsg);
                                return;
                            }

                            //emit the table name
                            Trace.Write("[" + tableName + "]");

                            //get the number of records in this table
                            pCount = TableCount(tableName, pConn);

                            //emit the number of records in this table
                            Trace.Write(" = P:" + pCount);

                            //create a data reader to read the pervasive data
                            string sql = "select * from \""+ tableName + "\""; 
                            OdbcCommand cmd = new OdbcCommand(sql, pConn);
                            OdbcDataReader dr = cmd.ExecuteReader();

                            //create a connection to SQL Server
                            using (SqlConnection sConn = new SqlConnection(destSqlConnString)){

                                //open the connection
                                sConn.Open();

                                //if the table already exists
                                if(TableExists(tableName, sConn)){

                                    //get the record count for this table
                                    sCount = TableCount(tableName, sConn);

                                } else {

                                    //set the record count to zero
                                    sCount = 0;
                                }

                                //output the record count
                                Trace.Write(", S: " + sCount);

                                //if the record counts match
                                if( pCount == sCount ){

                                    //output an indicator that we are skipping this table
                                    Trace.WriteLine(" -- Skipping");

                                    //skip this table and go to the next
                                    continue;   

                                }

                                //output a blank line
                                Trace.WriteLine("");

                                //create the table in SQL Server using the schema info from Pervasive
                                CreateTableInDatabase(dtSchema, destSqlOwner, tableName, sConn);

                                // Copies all rows to the database from the data reader.
                                using (SqlBulkCopy bc = new SqlBulkCopy(sConn))
                                {
                                    // Destination table with owner - 
                                    // this example does not check the owner names! It uses dbo exclusively.
                                    bc.DestinationTableName = "[" + destSqlOwner + "].[" + tableName + "]";
                                    bc.BulkCopyTimeout = 30;
                                    bc.BatchSize = 3000;
                                    bc.BulkCopyTimeout = 12000;

                                    // User notification with the SqlRowsCopied event
                                    bc.NotifyAfter = 1000;
                                    bc.SqlRowsCopied += new SqlRowsCopiedEventHandler(OnSqlRowsCopied);

                                    //output the date and time so we know when we started
                                    tableStartDate = DateTime.Now;
                                    Trace.WriteLine("Copying " + pCount + " records to " + destSqlServer + " - " + tableStartDate.ToString("g"));

                                    // Starts the bulk copy.
                                    bc.WriteToServer(dr);

                                    tableEndDate = DateTime.Now;
                                    diff = tableEndDate - tableStartDate;

                                    Trace.WriteLine(String.Format(
                                        "Completed {4} at {0}\r\nDuration: {1}:{2}:{3}",
                                          tableEndDate.ToString("g"),
                                          diff.Hours.ToString(), diff.Minutes.ToString(), diff.Seconds.ToString(),
                                          tableName));

                                    // Closes the SqlBulkCopy instance
                                    bc.Close();
                                }

                                dr.Close();

                            }
                        }catch(Exception ex){
                            errMsg = "Error: " + ex.Message + Environment.NewLine + 
                                              "Stack: " + ex.StackTrace + Environment.NewLine;
                            Trace.WriteLine(errMsg);
                            WriteErrorEvent(errMsg);
                            if( !ReadBool("Do you want to continue? [y/n]") ){
                                break;
                            }
                        }//end try
                    }//end for
                }//end using

                allEndDate = DateTime.Now;
                diff = allEndDate - allStartDate;

                Trace.WriteLine(
                    "Bulk copy operation complete" + Environment.NewLine +
                    "Started: " + allStartDate.ToString("g") +  Environment.NewLine + 
                    "Current: " + allEndDate.ToString("g") + Environment.NewLine +
                    String.Format("Duration: {0}:{1}:{2}", 
                        diff.Hours.ToString(), 
                        diff.Minutes.ToString(), 
                        diff.Seconds.ToString()));

            }catch(Exception ex){

                errMsg = 
                    "Error: " + ex.Message + Environment.NewLine +
                    "Stack: " + ex.StackTrace;

                Trace.WriteLine(errMsg);
                WriteErrorEvent(errMsg);

            }//end try

            Console.Write("Press any key to continue . . . ");
            Console.ReadKey(true);
        }

        static bool TableExists(string tableName, SqlConnection sqlConn){
            int retVal = 0;
            try{
                using(SqlCommand command = sqlConn.CreateCommand()){
                    command.CommandText = "IF OBJECT_ID('dbo." + tableName + "', 'U') IS NOT NULL SELECT 1 as res ELSE SELECT 0 as res";
                    retVal = Convert.ToInt32(command.ExecuteScalar());
                }
            }catch(Exception ex){
                string errMsg = 
                    "Error: Could not determine if table " + tableName + " exists."+ Environment.NewLine +
                    "Reason: " + ex.Message + Environment.NewLine + 
                    "Stack: " + ex.StackTrace;
                Trace.WriteLine(errMsg);
                WriteErrorEvent(errMsg);
                retVal = 0;
            }//end try
            return (retVal==1);
        }

        static int TableCount(string tableName, IDbConnection anyConn){
            int retVal = 0;
            try{
                using(IDbCommand command = anyConn.CreateCommand()){
                    command.CommandText = "SELECT count(*) FROM \"" + tableName + "\"";
                    retVal = Convert.ToInt32(command.ExecuteScalar());
                }
            }catch(Exception ex){
                string errMsg = 
                    "Error: Could not get table count for " + tableName + "." + Environment.NewLine +
                    "Reason: " + ex.Message + Environment.NewLine + 
                    "Stack: " + ex.StackTrace;
                Trace.WriteLine(errMsg);
                WriteErrorEvent(errMsg);
                retVal = 0;
            }//end try
            return (retVal);
        }

        static bool ReadBool(String question) {
            while (true) {
                Console.WriteLine(question);
                String r = (Console.ReadLine() ?? "").ToLower();
                if (r == "y" || r == "yes" || r == "1")
                    return true;
                if (r == "n" || r == "no" || r=="0")
                    return false;
                Console.WriteLine("Please Select a Valid Option!!");
            }//end while
        }

        static void OnSqlRowsCopied(object sender, SqlRowsCopiedEventArgs e) { 
            Trace.WriteLine(String.Format("-- [{1}] Copied {0} rows.", e.RowsCopied, currentTableName));
        }

        private static string s(object o){
            return (Convert.IsDBNull(o) ? "" : Convert.ToString(o));
        }

        private static string _drToColSql(DataRow dr){
            string colName = s(dr["COLUMN_NAME"]);
            string ret = "[" + colName + "] ";
            string typeName = ((string)s(dr["TYPE_NAME"])).ToLower();
            switch(typeName){
                case "char":
                    ret += "CHAR(" + s(dr["LENGTH"]) + ")";
                    break;
                case "byte":
                    ret += "CHAR(" + s(dr["PRECISION"]) + ")";
                    break;
                case "text":
                    ret += "VARCHAR(" + s(dr["PRECISION"]) + ")";
                    break;
                case "date":
                    ret += "DATE";
                    break;
                case "time":
                    ret += "TIME(7)";
                    break;
                case "double":
                    ret += "DECIMAL(16,2)"; // + c(dr["PRECISION"]) + "," + c(dr["LENGTH"]) + ")";
                    break;
                case "usmallint":
                case "smallint":
                    ret += "SMALLINT";
                    break;
                case "utinyint":
                case "tinyint":
                    ret += "TINYINT";
                    break;
                case "identity":
                case "integer":
                    ret += "BIGINT";
                    break;
                case "smallidentity":
                case "short":
                    ret += "INT";
                    break;
                case "longvarchar":
                case "memo":
                    ret += "TEXT";
                    break;
                case "checkbox":
                    ret += "BIT";
                    break;
                case "real":
                    ret += "REAL";
                    break;
                default:
                    //this was an unexpected column, figure out what happened
                    Trace.WriteLine("ERROR - Column '" + colName + "' Details: ");
                    Trace.WriteLine("\tCOLUMN_NAME: " + s(dr["COLUMN_NAME"]));
                    Trace.WriteLine("\tTYPE_NAME: " + s(dr["TYPE_NAME"]));
                    Trace.WriteLine("\tDATA_TYPE: " + s(dr["DATA_TYPE"]));
                    Trace.WriteLine("\tLENGTH: " + s(dr["LENGTH"]));
                    Trace.WriteLine("\tPRECISION: " + s(dr["PRECISION"]));
                    Trace.WriteLine("\tSCALE: " + s(dr["SCALE"]));
                    Trace.WriteLine("\tNULLABLE: " + s(dr["NULLABLE"]));
                    throw new Exception("Unexpected data type: " + typeName);
            }

            if(s(dr["NULLABLE"])=="1"){
                ret += " NULL"; 
            }

            return ret;
        }

        private static bool CreateTableInDatabase(DataTable dtSchemaTable, string tableOwner, string tableName, SqlConnection sqlConn) {
            // Generates the create table command.
            string ctStr = "CREATE TABLE [" + tableOwner + "].[" + tableName + "](\r\n";
            for (int i = 0; i < dtSchemaTable.Rows.Count; i++)
            {
                ctStr += _drToColSql(dtSchemaTable.Rows[i]);
                if (i < dtSchemaTable.Rows.Count)
                    ctStr += ",";
                ctStr += "\r\n";
            }
            ctStr += ")";

            // Emit SQL statement
            Trace.WriteLine("-".PadLeft(30, '-'));
            Trace.WriteLine(ctStr + Environment.NewLine);

            // Runs the SQL command to make the destination table.      
            using(SqlCommand command = sqlConn.CreateCommand()){
                command.CommandText = "IF OBJECT_ID('dbo." + tableName + "', 'U') IS NOT NULL DROP TABLE dbo." + tableName;
                command.ExecuteNonQuery();
                command.CommandText = ctStr;
                command.ExecuteNonQuery();
            }
            return true;
        }

        private static bool WriteErrorEvent(string errMsg){
            const string sSource = "PervasiveOdbcSync";
            const string sLog = "Application";
            try{
                if (!EventLog.SourceExists(sSource))
                    EventLog.CreateEventSource(sSource,sLog);
                EventLog.WriteEntry(sSource, errMsg);
                EventLog.WriteEntry(sSource, errMsg, EventLogEntryType.Error, 128);
                return true;
            }catch(Exception ex){
                Trace.WriteLine("Unable to write error to event log. Reason: " + ex.Message);
                return false;
            }
        }

    }
} 
```

* * *

您需要将 System.Diagnostics.ConsoleTraceListener 添加到 app.config 文件中。这样您就可以看到正在输出的所有内容。如果您还添加了 System.Diagnostics.TextWriterTraceListener，您可以使应用程序也将所有内容输出到日志文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T01:31:28.617

在我也安装了 SQL Server 2008 R2 的 PSQL v11 机器上，我没有在 SQL Server 导入和导出向导的“数据源”对话框中看到“普遍的 ODBC 引擎接口”。我确实看到了“Pervasive PSQL OLEDB Provider”和“Pervasive Provider, release v4.0”（以及 3.5 和 3.2）。The Pervasive Provider 是一个 ADO.NET 提供程序。我确实看到了“.Net Framework Data Provider for ODBC”，如果我为 Pervasive DSN（如 DEMODATA）输入了 DSN 名称，它就可以工作。

# java - 文件输入/输出，存储数据

> ID：15079481
> 
> 赞同：-1
> 
> 时间：2013-02-26T00:56:57.683
> 
> 标签：java

好吧，让我们再试一次，对不起，我不知道该怎么称呼这个糟糕的标题。我以前没有做过很多文件 I/O，我个人认为 Java 在这方面绝对是糟糕的，但我还是必须这样做。

一些背景信息，这是我的 Conway 的生命游戏项目，我所有的其他代码都可以正常工作，我现在只需要进行 I/O。

我正在从一个看起来像[这样](http://gyazo.com/5f1e90acf0478668121c2598ebdce6d6.png?1361839710)的文本文件中读取。

所以它的作用是前两个数字是数组需要的大小，它们后面的字符串是无关紧要的。之后是本例中单元格排列的数组，它是滑翔机的排列。现在我的问题是我不知道如何将第一行存储在字符串中，其余的存储在数组中。以下是我所做的，并为 n^∞ 的大 O 做好准备。

```
 public char[][] fileIO(){
    ArrayList<String> list = new ArrayList<String>();
    char[][] newArray;
    String[] tokens;
    BufferedReader reader;
    String inputLine;

    try{
        reader = new BufferedReader(new FileReader("untitled.txt"));
        while((inputLine = reader.readLine()) != null){
            list.add(inputLine);
        }
        reader.close();
    }catch (IOException e){
        System.out.println(e);
    }

    tokens = list.get(0).trim().split("\\s+");
    newArray = new char[Integer.parseInt(tokens[0])][Integer.parseInt(tokens[1])];

    for(int row = 0; row < newArray.length; row++){
        for(int col = 0; col < newArray[row].length; col++){
            for(int line = 1; line < list.size(); line++){
                for(int Char = 0; Char < list.get(line).length(); Char++){
                    newArray[row][col] = list.get(line).charAt(Char);
                }
            }
        }
    }
    return newArray;
} 
```

我知道缺少评论，所以我将尝试解释我现在尝试做的事情；

*   我从文件中读取并将其全部存储在 ArrayList

*   得到第一个like的标记（10 20 Glider），并创建了一个实例化的数组，其值为10和20

*   然后继续循环遍历数组的行和列，然后是输入数组的每一行，然后循环遍历该行的每个字符，以在其相应位置添加到数组中。

但是，这似乎不起作用，我相信有一种更简单有效的方法可以做到这一点。所以我再问一次，谁能告诉我做这个 I/O 的更简单的方法？我不需要代码，只是解释如何这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T01:10:18.270

在这：

```
for(int row = 0; row < newArray.length; row++){
        for(int col = 0; col < newArray[row].length; col++){
            for(int line = 1; line < list.size(); line++){
                for(int Char = 0; Char < list.get(line).length(); Char++){
                    newArray[row][col] = list.get(line).charAt(Char);
                }
            }
        }
    } 
```

您有两个正在浏览`newArray`网格的外部循环，以及两个正在浏览文件行的内部循环。通过这样做，您实际上是将文件每一行的每个字符一个接一个地写入网格的每个单元格中。最后，您将在所有单元格中拥有文件最后一行的最后一个字符`newArray`。这可能不是您想要做的。

**编辑：**如果我理解正确，文件开头的数字是后面数据的行数和列数。然后你只需要使用两个外部循环，并使用`row`and`col`分别访问行中的行`list`和行中的字符。

# c++ - 矢量超出范围/范围检查

> ID：15079487
> 
> 赞同：6
> 
> 时间：2013-02-26T00:57:16.027
> 
> 标签：c++, vector

新用户在这里。我一直在编写这段代码，它创建一个带有节点的网络并使用随机数在它们之间创建边。我将整个图作为一个向量来跟踪，每个条目都是一个向量，表示一个节点，其元素是它的邻居。然后它使用深度优先搜索来查找组件的数量，这些组件是图形的独立部分（我的计数变量）。然后我将节点和它连接到的邻居的数量输出到一个 txt 文件中。代码编译，但命令提示符给我一个错误：

在抛出 'std::out_of_range' what(): vector::_M_range_check 的实例后调用终止

此应用程序已请求运行时以不寻常的方式终止它。请联系支持...

那么...这是什么意思，我该如何解决？

另外，我需要跟踪每个组件中有多少个节点，有什么想法吗？

在此先感谢，这是我的代码：

```
#include <iostream>
#include <fstream>
#include <stdlib.h>
#include <vector>
using namespace std;

void gengraph(int v, float p, vector <vector <int> >& G);
void DFS(vector <vector <int> > G, int v, vector<int>& M);

int main()
{
    int a = 1000;
    float b = 0.004;
    vector <vector <int> > G;
    gengraph(a,b,G);
    vector <int> M (1000);
    int count = 0;
    int i;
    for (i = 0; i < a; i++)
    {
        if (M[i]==0)
        {
            DFS(G, i, M);
            count += 1;
        }
    }
    ofstream myfile;
    myfile.open ("data.txt");
    for (int l=0; l<1000; l++)
    {
        myfile << "v   len(G[v])\n";
    }
    myfile.close();
}
void gengraph(int v, float p, vector <vector <int> >& G)
{
    for (int i = 0; i<1000; i++)
    {  
        for (int j = 0; j<1000; j++)
        {
            int y = rand();
            bool Prob = (y <= p);
            if (i == j)
                continue;
            else
            {
                if(Prob == true)
                {
                    G.at(i).push_back (j);
                    G.at(j).push_back (i);
                }
            }
        }
    }
}
void DFS(vector <vector <int> >& G, int v, vector<int>& M)
{
    M[v]=1;
    for(unsigned int j = 0; j < G[v].size(); j++)
    {
        if (M[j]==0)
        {
            DFS(G, j, M);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T01:11:23.400

您创建了向量 > 但它的初始大小为 0。

现在，当您使用 M.at() 访问它时，它会检查此索引是否超出范围，如果是这种情况则抛出异常。

将向量定义为：

```
vector<vector<int> > M(1000); 
```

应该可以解决您的问题。

您还应该使用 gdb 或其他调试器。它会让你的生活更轻松

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T01:24:24.580

```
vector <vector <int> > G; 
```

这会创建一个整数向量向量，但最初没有整数向量元素。尽管如此，您调用`G.at(i)...`which - 对于 的任何值`i`，都会立即访问一个不存在的元素。

另外，`rand()`返回一个随机的 32 位整数，因此几乎总是大于您的 0.004 `float`。您可能想要使用类似`(rand() % 1000000 / 1000000.0)`. 随机数子系统应使用调用 ala 进行初始化`srand(time(NULL));`

更一般地说，你最好使用一些`std::cerr << "x is now " << x << '\n';`——打印变量、矢量大小等——分散在你的代码中，这样你就可以看到它在做什么以及哪里出了问题。或者，看看您是否可以获得交互式调试器并逐行执行您的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T01:01:40.803

这意味着您索引了超出其范围的向量。

[`vector::at()`](http://en.cppreference.com/w/cpp/container/vector/at)执行范围检查。所以这可能是因为你没有预先分配足够的元素到`G`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T01:07:13.607

第一个错误：在函数 gengraph() 你使用空向量：

```
G.at(i) ...
G.at(j) ... 
```

是的，您调用了 push_back，但是您调用了 at() 返回的方法。但是 at() 不能返回任何值 i 和 j 因为你的向量是空的。解决方案之一将此行放在 gengraph() 的开头

```
G.resize( 1000 ); 
```

第二个建议：尽可能避免使用幻数。放一些类似的东西：

```
const int size = 1000; 
```

在文件的开头并使用大小而不是幻数 1000。尤其是这个：

```
int a = 1000;
float b = 0.004;
vector <vector <int> > G;
gengraph(a,b,G);
vector <int> M (1000); // use a here and better call it something more meaningfulness than a
int count = 0;
int i;
for (i = 0; i < a; i++) { // or use M.size() here or both
} 
```

# javascript - 修改了 railscast 的 rails 轮询更改

> ID：15079493
> 
> 赞同：0
> 
> 时间：2013-02-26T00:57:47.733
> 
> 标签：javascript, jquery, ruby-on-rails, ruby-on-rails-3

我正在尝试跟踪更改轮询，但出现以下错误

```
Uncaught TypeError: Object [object global] has no method CommentPoller 
```

这是我的comment.js.coffee 文件中的代码

```
# Place all the behaviors and hooks related to the matching controller here.
# All this logic will automatically be available in application.js.
# You can use CoffeeScript in this file: http://jashkenas.github.com/coffee-script/

@CommentPoller ->
  poll: ->
    setTimeout @request, 5000

  request: ->
    $.get($('#comments').data('url'))

jQuery ->
  if $('#comments').length > 0
    CommentPoller.poll() 
```

我做错了什么？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T01:08:07.523

尝试将第一行从

```
@CommentPoller -> 
```

到

```
CommentPoller = 
```

# php - 函数 php in_array 不要将数组作为大海捞针

> ID：15079500
> 
> 赞同：1
> 
> 时间：2013-02-26T00:58:30.310
> 
> 标签：php, arrays

我怀疑 in_array 函数有问题。我已经阅读了很多次文档，对其进行了测试，并且总是附加相同的内容

这是一个工作代码：

```
$tohide = '141'; 
$objterm = wp_get_object_terms($post->ID, 'product_cat');
global $catlist;
$catlist = array();
foreach ($objterm as $singleterm) {
    array_push($catlist, $singleterm->term_id);
}
if (!in_array($tohide,$catlist)) {
    woocommerce_get_template_part( 'content', 'product' );
} 
```

那段代码输出所有项目但类别 141...酷，工作正常...现在，我想获得一个数组作为要隐藏的项目

```
$tohide = array('141','134'); 
$objterm = wp_get_object_terms($post->ID, 'product_cat');
global $catlist;
$catlist = array();
foreach ($objterm as $singleterm) {
    array_push($catlist, $singleterm->term_id);
}
if (!in_array($tohide,$catlist)) {
    woocommerce_get_template_part( 'content', 'product' );
} 
```

这不工作......它输出一切......不要过滤我试图隐藏的任何项目。

现在的问题是......如何显示不在数组中隐藏的每个项目......我不知道！也许另一个 php 函数可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T01:01:42.030

您可以使用[`array_intersect`](http://php.net/manual/en/function.array-intersect.php)：

```
if(!array_intersect($tohide, $catlist)){
  ...
} 
```

您将获得一个包含其中`$tohide`存在的任何项目的数组`$catlist`（空数组将评估为假）

# r - 递归列表的组合

> ID：15079503
> 
> 赞同：1
> 
> 时间：2013-02-26T00:58:50.037
> 
> 标签：r

假设我有三个词`"blue"`：`"red"`和`"pink"`。

我希望生成所有字母组合，其中我从“蓝色”中取出两个字母，然后从“红色”中添加两个字母，然后从“粉红色”中添加两个字母，例如

`blrdpk`

`uerdin`

ETC...

在 R 中，我通过将每个单词的字符分配到一个列表元素中来编码我的三个单词

```
words <- list( list("b","l","u","e"),  list("r","e","d"),  list("p","i","n","k") ) 
```

我知道我可以使用`lapply`with`combn(words[[i]],m=2)`从每个单词中获取 2 个字母的所有组合。

我有两个问题：

1.  是否有更高级的 combn() 版本，它允许您从使用递归列表给出的不同“桶”中选择和连接组合？

2.  如果没有 combn() 的高级版本，连接三个单词中每个单独的 2 个字母组合的最佳方法是什么？

3.  如果我想从每个单词中获得不同数量的字母，有没有一种简单的方法可以做到这一点？[从答案之一中的用户评论中添加]

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T01:32:41.877

可能有更高级的版本`combn`，但它已经相当先进了。例如，您可以通过指定`FUN`参数将函数应用于每个组合。将它与 expand.grid 和 Reduce 结合起来，你会得到类似的东西

```
Reduce(paste0, expand.grid(lapply(words, function(x) {
  combn(x, m=2, FUN=paste0, collapse="")
}))) 
```

**编辑：** 如果要从每个单词中选择的字母数量不同，则可以将此数字添加为单词列表中每个元素的属性，然后将该属性`m`用作`combn`. 例如，要为第一个单词选择一个字母，从第二个单词中选择两个字母，从第三个单词中选择三个字母：

```
for(i in seq_along(words)) {
  attr(words[[i]], "n") <- i
}

Reduce(paste0, expand.grid(lapply(words, function(x) {
  combn(x, m=attr(x, "n"), FUN=paste0, collapse="")}))) 
```

或者，您可以在 geektrader 的回答中使用 mapply。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T02:13:19.830

这是从单词列表和要从每个单词中选择的字符数列表到所需结果的解决方案

```
> words
[1] "blue" "red"  "pink"
> wordsplit <- strsplit(words, split="")
> wordsplit
[[1]]
[1] "b" "l" "u" "e"

[[2]]
[1] "r" "e" "d"

[[3]]
[1] "p" "i" "n" "k"

> lengths <- c(2, 1, 3)
> combos <- expand.grid(mapply(function(word, n) combn(word,m=n, FUN=paste0, collapse=""), wordsplit, lengths))
> head(combos)
  Var1 Var2 Var3
1   bl    r  pin
2   bu    r  pin
3   be    r  pin
4   lu    r  pin
5   le    r  pin
6   ue    r  pin

> do.call('paste0', combos)
 [1] "blrpin" "burpin" "berpin" "lurpin" "lerpin" "uerpin" "blepin" "buepin" "beepin" "luepin" "leepin" "ueepin" "bldpin" "budpin" "bedpin" "ludpin"
[17] "ledpin" "uedpin" "blrpik" "burpik" "berpik" "lurpik" "lerpik" "uerpik" "blepik" "buepik" "beepik" "luepik" "leepik" "ueepik" "bldpik" "budpik"
[33] "bedpik" "ludpik" "ledpik" "uedpik" "blrpnk" "burpnk" "berpnk" "lurpnk" "lerpnk" "uerpnk" "blepnk" "buepnk" "beepnk" "luepnk" "leepnk" "ueepnk"
[49] "bldpnk" "budpnk" "bedpnk" "ludpnk" "ledpnk" "uedpnk" "blrink" "burink" "berink" "lurink" "lerink" "uerink" "bleink" "bueink" "beeink" "lueink"
[65] "leeink" "ueeink" "bldink" "budink" "bedink" "ludink" "ledink" "uedink" 
```

# c# - 有没有办法在 C# 中内联委托？

> ID：15079504
> 
> 赞同：3
> 
> 时间：2013-02-26T00:59:07.797
> 
> 标签：c#, delegates, inline

这是我正在处理的简化场景。循环结构有多种方法。

```
for (int i=0; i<I; i++) {
    // Do something
    for (int j=0; j<J; j++) {
        // Do something
        for (int k=0; k<K; k++) {
            // Do something
            Update(a,b,c);
        }
    }
} 
```

在一种方法中，Update(a,b,c) 是

```
a[i] += b[j] * c[k] 
```

在另一种方法中，它是

```
b[j] += a[i] * c[k] 
```

而在另一种方法中，它是

```
c[k] += a[i] * b[j] 
```

目前，我的代码到处都是重复的。C# 中是否有一种模式，这样我就不会重复代码？我很想使用委托，但似乎委托会降低性能（这在我的情况下至关重要）。

有没有办法为这种情况编写宏或内联委托函数？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-26T01:14:53.390

像这样的东西？

```
void DoUpdates(Action<int, int, int> update)
{
  for (int i=0; i<I; i++) {
    // Do something
    for (int j=0; j<J; j++) {
      // Do something
      for (int k=0; k<K; k++) {
        // Do something
        update(i, j, k);
      }
    }
  }
} 
```

然后在调用者中

```
DoUpdates((int i, int j, int k) => { a[i] += b[j] * c[k]; }); 
```

那是你要找的吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-26T01:05:27.477

```
void Update<T>(T[] x, T[] y, T[] z, int i, int j, int k)
{
    x[i] += y[j] * z[k];
} 
```

用法：

```
Update(a, b, c, i, j, k);
Update(b, a, c, j, i, k);
Update(c, a, b, k, i, j); 
```

我看到它`a`总是被`i`（等等 - `b`by `j`，`c`by `k`）访问。您可以尝试使用这个事实来优化代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-26T01:49:23.907

如果性能很关键，您可以避免在内部循环中调用方法，如下所示：

```
void Update(int[]x, int[]y, int[]z, int I, int J, int K)
{
    for (int i = 0; i < I; i++)
    {
        // Do something
        for (int j = 0; j < J; j++)
        {
            // Do something
            for (int k = 0; k < K; k++)
            {
                // Do something
                x[i] += y[j] * z[k];
            }
        }
    }
} 
```

和调用代码：

```
Update(a, b, c, I, J, K);
Update(b, a, c, J, I, K);
Update(c, a, b, K, I, J); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T05:38:11.060

您可能正在实现诸如大数乘法或向量的其他线性组合之类的东西。您需要您描述为*内联委托*的方法的原因很可能是因为在计算期间存储结果的位置不同，也因为嵌套的 for 循环是硬编码的。因此，我建议修改您的代码，如下所示：

```
public void Update(int destinationIndex, int[][] arrays, int[] indices) {
    var product=1;

    for(var i=indices.Length; i-->0; )
        if(destinationIndex!=i)
            product*=arrays[i][indices[i]];

    arrays[destinationIndex][indices[destinationIndex]]+=product;
}

public void PerformUpdate(
    int destinationIndex, int[] counts, int[][] arrays, Action<int, int>[] actions,
    List<int> indices=null, int level=0
    ) {
    if(level==counts.Length)
        Update(destinationIndex, arrays, (indices??new List<int>()).ToArray());
    else
        for(int count=counts[level], i=0; i<count; i++) {
            if(null!=actions&&level<actions.Length)
                actions[level](i, count); // do something according to nesting level

            (indices=indices??new List<int>()).Add(i);
            PerformUpdate(destinationIndex, counts, arrays, actions, indices, 1+level);
            indices.RemoveAt(indices.Count-1);
        }
} 
```

此代码以递归方式实现。`int[][] array`只要您要定义 and 的计算，而不是定义 and 中的方法名称，就可以将`operator *`替换为`operator +`通用`MutiplyScalar`数组`AddScalar`。

因此，我们不会使用委托`Update`来控制目的地。相反，我们只是使用`destinationIndex`来完成。下面是一个测试用例：

```
int[] a=new[] { 1, 2 }, b=new[] { 3, 4, 5 }, c=new[] { 6 };
Action<int, int> m=(index, count) => Debug.Print("index={0}; count={1}", index, count);
PerformUpdate(2, new[] { a.Length, b.Length, c.Length }, new[] { a, b, c }, new[] { m, m, m }); 
```

我们仍然有内联委托，它们[`Lambda Expressions`](http://msdn.microsoft.com/en-us/library/bb397687.aspx)在 c# 中调用。根据您提供的原始代码，`Do something`嵌套的 for 循环之间有 s 。但是，我们找不到太多非全球已知的信息`Update`；我们可以看到的最显着的区别是**迭代索引和结束数字**，它们`i, I`是`j, J`和`k, K`。因此，我们只是将这些作为参数传递给`Action<int, int>`for 做某事，并且它们对于每个级别的 for 循环都是可变的。

执行很大程度上取决于`indices`. 它存储当前for循环的迭代索引并传递给下一级递归调用。此外，如果您传递的`arrays`计数小于其`Length`in `indices`，它将被视为具有您传递给的计数长度的数组。**不要传递负数，也不要传递更大的数。**它可以是缺乏`Action<int, int>`，那只是意味着*什么都不做*而不是*做某事*。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-26T05:47:52.993

这可能会内联它。

```
interface IFunc<T>
{
    void Invoke(ref T a, ref T b, ref T c);
}

void DoUpdates<TFunc>(TFunc update)
    where TFunc : IFunc<int>
{
    for (int i = 0; i < I; i++)
        for (int j = 0; j < J; j++)
            for (int k = 0; k < K; k++)
                update.Invoke(ref i, ref j, ref k);
} 
```

# javascript - 这个 JavaScript 对象是如何为这个小书签创建的？

> ID：15079509
> 
> 赞同：0
> 
> 时间：2013-02-26T00:59:20.760
> 
> 标签：javascript, object, bookmarklet, casperjs

我正在尝试对使用 CasperJS 的书签进行逆向工程。

它创建了一个对象`__utils__`，我可以使用它来执行控制台命令。

小书签的链接在这里：-

[http://casperjs.org/api.html#bookmarklet](http://casperjs.org/api.html#bookmarklet)

其中引用了这个 JavaScript 文件：-

[https://raw.github.com/n1k0/casperjs/master/modules/clientutils.js](https://raw.github.com/n1k0/casperjs/master/modules/clientutils.js)

我已经搜索了整个源代码，但找不到有关如何创建该对象的参考。

任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T01:16:59.950

看源码`api.html`。之后`Just drag this link`查看`href`属性中的JS。接近尾声时，它包含：

```
window.__utils__=new%20window.clientUtils(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T01:23:18.863

小书签只运行一小段 JavaScript 代码，将指向 clientutils.js 的链接附加到文档的末尾。之后，它将每 50 毫秒运行一个匿名函数，检查脚本是否已加载（并使该`ClientUtils`函数可用），如果已加载，它将停止运行该函数并创建`window.__utils__`，从而使其在控制台中可用。这是更易读格式的实际书签代码。应该很容易理解：

```
(function () {
  void(function () {
    if (!document.getElementById('CasperUtils')) {
      var CasperUtils = document.createElement('script');
      CasperUtils.id = 'CasperUtils';
      CasperUtils.src = 'https://raw.github.com/n1k0/casperjs/master/modules/clientutils.js';
      document.documentElement.appendChild(CasperUtils);
      var interval = setInterval(function () {
        if (typeof ClientUtils === 'function') {
          window.__utils__ = new window.ClientUtils();
          clearInterval(interval);
        }
      }, 50);
    }
  }());
})(); 
```

# maven-2 - Maven 在我的 Ubuntu 安装中无法识别 javac

> ID：15079516
> 
> 赞同：2
> 
> 时间：2013-02-26T00:59:55.980
> 
> 标签：maven-2, javac, ubuntu-11.10

我收到了这个错误：

```
Compilation failure
Unable to locate the Javac Compiler in:
  /usr/lib/jvm/java-7-openjdk-amd64/jre/../lib/tools.jar
Please ensure you are using JDK 1.4 or above and
not a JRE (the com.sun.tools.javac.Main class is required).
In most cases you can change the location of your Java
installation by setting the JAVA_HOME environment variable. 
```

现在我在我的`.bashrc`文件中设置了一些信息，如下所示`export PATH=$PATH:/usr/lib/jvm/java-6-openjdk/bin`：我也在我的 /etc/profile 文件中做到了。但它仍然失败。但我注意到上述错误仍在进入`jre`而不是`jvm`. 我真的不明白为什么要这样做。当我这样做时`which javac`，它会指示我`/usr/bin/javac`。那个文件到底是什么？似乎 Ubuntu 默认使用 JRE 而不是 SDK。无论哪种方式，我都对如何解决这个问题感到困惑。任何帮助，将不胜感激！

# python - Django 循环通过 unicode 表单输入和引用元组

> ID：15079529
> 
> 赞同：0
> 
> 时间：2013-02-26T01:01:44.830
> 
> 标签：python, django

我有一个复选框表单，用户可以在提交之前进行多项选择。当我的视图得到这个输入时，它是 unicode 格式的，我对处理这个的正确方法有点困惑。

复选框将代表预定义的元组，我将根据选择和提交的内容进行处理。

这是我整理的一个例子，试图解决这个问题，

```
>>> b = ('mike', 'fred', 'paul')
>>> g = ('sally', 'sara', 'heather')
>>>
>>> selection = [u'b']
>>> type(selection[0]) 
<type 'unicode'>
>>> for name in selection:
...     print name
...
b
>>> 
```

这个比较近

```
>>> selection = [b]
>>> for name in selection:
...     print name
...
('mike', 'fred', 'paul') 
```

试图将 unicode 转换为 ascii 但那不起作用，

```
>>> for i in selection[0].encode('ascii', 'ignore'):
...     print i
...
b
>>> 
```

这就是我想处理表单数据的方式，

```
>>> for i in b:
...     print i
...
mike
fred
paul
>>> 
```

这更像是一个 Python 问题，而不是 Django 问题，即如何引用包含 unicode 元组名称的变量并能够遍历这些对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T01:31:40.710

您可以使用[`locals()`](http://docs.python.org/2/library/functions.html#locals)：

```
b = ('mike', 'fred', 'paul')
selection = [u'b']
for name in locals()[selection[0]]:
    print name
# mike
# fred
# paul 
```

# c++ - 将 boost::fusion::for_each 应用于带有可变函数对象的 boost::fusion::vector

> ID：15079530
> 
> 赞同：2
> 
> 时间：2013-02-26T01:01:44.760
> 
> 标签：c++, boost, boost-fusion

我正在尝试使用 boost::fusion::vector。但是，我遇到了一个非常简单的问题。

```
#include <iostream>
#include <string>

#include <boost/fusion/container/vector.hpp>
#include <boost/fusion/algorithm.hpp>

using namespace std;

struct A{
    template <class T>
    void operator()(const T& t) {
        x++;
        cout << t << endl;
    }

    int x = 0;
};

int main(){
    A a;
    boost::fusion::vector<int, int, int> tuple{3,4,5};
    boost::fusion::for_each(tuple, a);
} 
```

请注意，`operator()`of`struct A`修改`x`为`struct A`。gcc 4.7.2 警告 ...\include\boost\fusion\algorithm\iteration\detail\for_each.hpp:77: 错误：将 'const A' 作为 'void A::operator()( const T&) [with T = int]' 丢弃限定符 [-fpermissive]

有解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-25T03:59:20.890

一个更简单、更好的方法是使用 fusion::fold:

```
#include <iostream>

#include <boost/fusion/algorithm/iteration/fold.hpp>
#include <boost/fusion/include/fold.hpp>

namespace detail {
  struct A {
    typedef int result_type;
    template<typename T1, typename T2>
    int operator()( const T1& t1, const T2& t2 ) const {
      std::cout << t1 << "," << t2 << std::endl;
      return t1 + 1;
    }
  };
}

int main() {
  boost::fusion::vector<int, int, int> tuple{3,4,5};
  boost::fusion::fold(tuple, 0, detail::A());
} 
```

没有任何语法错误，这应该产生：

0,3
1,4
2,5

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T06:20:48.750

好吧，我没有使用 boost::fusion，但是从错误消息和[docs 示例来看](http://www.boost.org/doc/libs/1_53_0/libs/fusion/doc/html/fusion/algorithm/iteration/functions/for_each.html)，似乎`for_each`需要 const 对象。即`operator()`也应该是 const 。但是，您将无法改变对象。

试试这个：

```
void operator()(const T& t) const {
    cout << t << endl;
} 
```

**编辑：**

我检查了来源（v. 1.53）并且声明是`for_each(Sequence& seq, F const& f)`. 所以真的没有办法修改对象本身。我看到的唯一选择是

要么使用静态变量：`static int x;`

或使用指针：

```
struct A {
    template <class T>
    void operator()(const T& t) const {
        (*x)++;
        std::cout << t << std::endl;
    }

    int* x;
};

int main()
{
    A a;
    a.x = new int;
    *(a.x) = 0;
    //... 
```

在这种情况下要小心应对`A`实例，因为指针都指向同一个位置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-24T03:55:11.697

boost::phoenix::lambda 文档中介绍了该解决方案。

秘诀是在仿函数之外的 lambda 函数中进行各种计算。

```
#include <iostream>

#include <boost/fusion/algorithm/iteration/for_each.hpp>
#include <boost/fusion/include/for_each.hpp>

#include <boost/phoenix/core.hpp>
#include <boost/phoenix/operator.hpp>
#include <boost/phoenix/operator/arithmetic.hpp> 
#include <boost/phoenix/scope/lambda.hpp>
#include <boost/phoenix/scope/local_variable.hpp>
#include <boost/phoenix/function.hpp>
#include <boost/phoenix/fusion.hpp>

namespace detail {
  struct A_impl {
    template<typename T1, typename T2>
    void operator()( const T1& t1, const T2& t2 ) const {
      std::cout << t2 << "," << t1 << std::endl;
    }
  };
  boost::phoenix::function<A_impl> const A = A_impl();
}

int main() {
  namespace phx = boost::phoenix;
  using boost::phoenix::arg_names::arg1;
  using boost::phoenix::local_names::_a;
  boost::fusion::vector<int, int, int> tuple{3,4,5};
  boost::fusion::for_each(tuple, phx::lambda( _a = 0 )[detail::A(arg1,_a++)]);
} 
```

没有任何语法错误，这应该产生：

0,3
1,4
2,5

# javascript - 将数值从像素更改为 perctange

> ID：15079538
> 
> 赞同：0
> 
> 时间：2013-02-26T01:03:14.793
> 
> 标签：javascript, jquery, wordpress

我在 Wordpress 中有这个音频播放器。播放器的一个方面是歌曲长度播放栏。它是一个浅灰色的条，然后用另一个条显示当前播放歌曲的实际长度。所以说一首歌的长度是2分钟。如果歌曲播放到一半（1 分钟），则当前歌曲长度条将是总长度条的一半。对我来说听起来很简单！

那么这就是我的问题所在.. 默认情况下，总歌曲长度栏是 180px，这是在 jquery / javascript minifed 代码中设置的，而不是 CSS 或类似的任何东西。这是一些缩小的代码。

```
a.fn.fullwidthAudioPlayer.defaults,t),u,x,n,m, r,q=null,B,s,X,y=0,P=-1,K=180,Q=50,k=-1,C=100,
D,F,M=!1,G=!1,L=!1,R=!1,J=!1,E=!1,S="d2be7a47322c293cdaffc039a26e05d1",j=[];
a.fullwidthAudioPlayer.play=function(){0<j.length&&(s.playState?s.resume()
:s.play(),m.find("#fap-play-pause") 
```

`k=180`设置总长度条的宽度，我知道这一点，因为我已将值从 180 更改为 80，然后条从 180px 变为 80px。

这一切都很好，但我希望长度条是一个百分比，而不是像素。我已经尝试了明显的方法`k=80%`，但这只是破坏了我的代码。

那么我如何使音频长度条变为 80% 而不是 180px，或者换句话说，将“k”的值更改为百分比而不是像素。

# ios - 如何只清除 iOS 中的通知

> ID：15079545
> 
> 赞同：1
> 
> 时间：2013-02-26T01:03:50.283
> 
> 标签：ios, objective-c, push-notification

如果用户将警报样式设置为横幅。他们可以收到超过 1 条通知，而不会被提示清除。然后他们去使用他们的手机，他们说存储了 3 个。如果点击最新的它会打开应用程序，我只想清除这一个通知，我也需要去`badgeCount--;`

如何使用下面的代码实现它？（目前它设置为清除所有我不想要的......）我还注意到有时它确实会更新徽章编号。但是，如果我切换回 iOS 主屏幕，然后拉下通知菜单，它仍然存在！

```
- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo
{
    if([[userInfo valueForKey:@"aps"] valueForKey:@"alert"] != nil) {
        NSString *message = [[userInfo valueForKey:@"aps"] valueForKey:@"alert"];
        if(message != nil) {
            UIAlertView *alertView = [[UIAlertView alloc] initWithTitle:@"Usage Alert"
            message:message  delegate:self cancelButtonTitle:@"Cancel" otherButtonTitles:@"Ok", nil];
            [alertView show];
            [[UIApplication sharedApplication] setApplicationIconBadgeNumber: 0];
            [[UIApplication sharedApplication] cancelAllLocalNotifications];

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T04:42:33.867

```
-(void)application:(UIApplication *)application didReceiveLocalNotification:(UILocalNotification *)notification
{

 UIApplication *app = [UIApplication sharedApplication];
 NSInteger badgeNumber = [app applicationIconBadgeNumber];// Take the current badge number
 badgeNumber--;    // decrement by one 
 [app setApplicationIconBadgeNumber:badgeNumber];  // set ne badge number
 [app cancelLocalNotification:notification];    // cancel the received notification. It will clear the notification from banner alos
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T03:03:27.220

你可以加

```
- (void)application:(UIApplication *)application didReceiveLocalNotification:(UILocalNotification *)notification 
```

给您的应用委托。这将被调用，您可以在那里使用

```
[[UIApplication sharedApplication] cancelLocalNotification:notification]; 
```

删除特定通知并减少徽章计数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-22T21:12:22.677

我想警告不要打电话

```
[[UIApplication sharedApplication] setApplicationIconBadgeNumber:bg_NUM] 
```

从

```
- (void)application:(UIApplication *)application didReceiveLocalNotification:(UILocalNotification *)notification 
```

方法！

如果您计划的本地通知带有一些徽章编号，那么徽章将在进入 -didReceiveLocalNotification**后**的几毫秒内**异步设置**

 **样品：

```
-(void)application:(UIApplication *)application didReceiveLocalNotification:(UILocalNotification *)notification {
    [[UIApplication sharedApplication] setApplicationIconBadgeNumber:0];
    // ^^^ maybe not reset badge to 0!! ^^^
} 
```

另一个代码：

```
-(void)application:(UIApplication *)application didReceiveLocalNotification:(UILocalNotification *)notification {
    sleep(1); //waiting for system is set our scheduled badge
    [[UIApplication sharedApplication] setApplicationIconBadgeNumber:0];
    // ^^^ most chances for reset badge to 0 ^^^
} 
```

**测试代码，屏幕触摸安排本地通知并计算系统真实设置徽章之前的延迟：**

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    [[UIApplication sharedApplication] setApplicationIconBadgeNumber:0];
    UILocalNotification *localNotif = [[[UILocalNotification alloc] init] autorelease];
    localNotif.applicationIconBadgeNumber = rand()%100+1;
    localNotif.fireDate = [NSDate dateWithTimeIntervalSinceNow:1];
    [[UIApplication sharedApplication] scheduleLocalNotification:localNotif];
}
[...]
- (void)application:(UIApplication *)application didReceiveLocalNotification:(UILocalNotification *)notification {
    CFAbsoluteTime startTime = CFAbsoluteTimeGetCurrent();
    while ([UIApplication sharedApplication].applicationIconBadgeNumber == 0) sleep(0);
        NSLog(@"badge set: %d   after %f sec.", [UIApplication sharedApplication].applicationIconBadgeNumber, CFAbsoluteTimeGetCurrent()-startTime);
} 
```

输出：

```
badge set: 41   after 0.000839 sec.
badge set: 9   after 0.000754 sec.
badge set: 56   after 0.076026 sec.
badge set: 17   after 0.069889 sec.
badge set: 8   after 0.056245 sec.
badge set: 71   after 0.120729 sec.
badge set: 28   after 0.122720 sec.
badge set: 17   after 0.000758 sec. 
```

此测试在不同设备上的 iOS 4.2/4.3/5.0/6.1

***在 -didReceiveLocalNotification 消息中重置徽章编号时要小心！*** （这仅适用于 LocalNotification /不是远程推送/并且仅当应用程序在接收时刻处于活动状态时）**

# type-conversion - Ada - 将 File_Size 转换为整数

> ID：15079554
> 
> 赞同：1
> 
> 时间：2013-02-26T01:04:38.537
> 
> 标签：type-conversion, ada

我正在使用 Ada 的目录库和 Command_Line 库，并读取命令行中给出的文本文件的字符数（大小），然后将其分配给一个整数。

```
Character_Count := Size(Argument(1)); 
```

编译器告诉我 Integer 和 File_Size 不匹配，即使 File_Size 是 Integer 的子类型，我很确定。我怎样才能转换它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T01:19:05.760

`Ada.Directories.File_Size`不是*的*子类型`Integer`。

它在语言参考手册中定义为：

```
type File_Size is range 0 .. *implementation-defined*; 
```

如果您考虑一下，将其作为子类型没有多大意义。`Integer`可以窄到 16 位，这几乎不足以容纳任意文件的大小。

您可以使用转换来转换为整数：

```
Character_Count := Integer(Size(Argument(1))); 
```

`Character_Count`但首先声明为 a可能会好得多`File_Size`。

# html - CSS：通过调整窗口大小来缩小 div 宽度但保持最大宽度？

> ID：15079555
> 
> 赞同：2
> 
> 时间：2013-02-26T01:04:46.087
> 
> 标签：html, css, positioning

我有一个大 div，宽度为 1000px，我想修复它以扩展和收缩，如下所示：

如果用户将浏览器窗口的宽度调整为小于 1000 像素，我想相应地调整该 div 的大小（就像您使用 width:100%; 时一样）。

但是，如果用户将浏览器窗口的宽度扩大到大于 1000 像素，我希望 div 在达到 1000 像素时停止增长。

我认为最好的方法是使用 and 的组合，`width: 100%`但这`max-width: 1000px;`对我不起作用。

任何人都可以提出一种方法来实现这一目标吗？

我对该 div 的完整 CSS 是：

```
#panel
{
  position: absolute;
  margin-left: 342px;
  max-width: 1000px;
  width: 100%;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T01:07:37.033

你考虑过媒体查询吗？就像是：

```
#panel {
    /* ... */
    width: 100%;
}
@media all and (min-width: 1000px) {
   #panel {
     width: 1000px;
   }
} 
```

这将对小于 1000 像素的屏幕应用 100% 的宽度，对至少 1000 像素宽的屏幕应用 1000 像素的固定宽度。

# c# - 将私钥存储在 Web 服务器上

> ID：15079556
> 
> 赞同：3
> 
> 时间：2013-02-26T01:04:47.347
> 
> 标签：c#, cryptography

在我当前的项目中，我正在开发一个 SAML 实现，其中“有效负载”被加密。

身份提供者获得了我们的公钥，然后我们使用您的私钥进行解密。

我的问题是我应该如何保护我在服务器上的私钥。

面向公众的网站设置在 DMZ 中，Web 服务位于物理上不同的服务器上的防火墙后面。通信是通过 WCF 完成的。

我想利用拥有单独服务器的优势，这样我就不必将 .pfx 文件放在可以访问它的 Web 服务器上。但是，将 .pfx 文件简单地放在 Web 服务文件系统上，我觉得不舒服。

从“证书存储”访问私钥是否更有意义？有没有办法将 pfx 文件的内容嵌入到我的应用程序的二进制文件中？

感谢任何输入！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T01:41:15.277

我绝不是安全专家，所以我对我说的话持保留态度。但是你能用 XXTEA 或河豚等对称算法加密你的 pfx 文件吗？然后在需要之前解密它？这将提供合理的安全性并允许您将其放置在 Web 服务器文件系统上。这只是一个想法，我相信有更多知识的人能够给你一个更好的答案。

# android - Android垂直布局为孩子分配相等的权重（高度）

> ID：15079559
> 
> 赞同：2
> 
> 时间：2013-02-26T01:05:20.733
> 
> 标签：android, xml, android-linearlayout

我在垂直布局中有三个水平布局。我希望这三个水平子布局占据相同的空间，所以我为每个布局添加了权重（0.33）。

我将三个子布局组件的布局高度分配给 0dp，因为父布局是垂直的，但子布局没有像预期的那样占据相同的高度。

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@drawable/paper"
    android:paddingLeft="4dp"
    android:paddingRight="8dp"
    tools:context=".TestActivity" >

         <LinearLayout
            android:id="@+id/scratchLayout"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:orientation="vertical" >

             <LinearLayout
                android:id="@+id/topLayout"
                android:layout_width="wrap_content"
                android:layout_height="0dp"
                android:layout_weight="0.33"
                android:layout_marginLeft="3dp"
                android:layout_marginRight="3dp" 
                android:orientation="horizontal" >

                <TextView
                    android:id="@+id/topArea1"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_weight="1"
                    android:background="@android:color/transparent"
                    android:paddingRight="3dp"
                    android:text="Top Area 2"
                    android:textSize="15dp" />

                <TextView
                    android:id="@+id/topArea2"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_weight="1"
                    android:background="@android:color/transparent"
                    android:paddingRight="3dp"
                    android:text="Top Area 1"
                    android:textSize="15dp" />
             </LinearLayout>

             <LinearLayout
                android:id="@+id/centerLayout"
                android:layout_width="wrap_content"
                android:layout_height="0dp"
                android:layout_weight="0.33"
                android:layout_marginLeft="3dp"
                android:layout_marginRight="3dp" 
                android:orientation="horizontal" >

                 <TextView
                 android:id="@+id/centerArea1"
                 android:layout_width="fill_parent"
                 android:layout_height="wrap_content"
                 android:layout_marginRight="3dp"
                 android:text="Center Area 1" />

                 <TextView
                 android:id="@+id/centerArea2"
                 android:layout_width="fill_parent"
                 android:layout_height="wrap_content"
                 android:layout_marginRight="3dp"
                 android:text="Center Area 2" />

            </LinearLayout>

             <LinearLayout
                android:id="@+id/BottomLayout"
                android:layout_width="wrap_content"
                android:layout_height="0dp"
                android:layout_weight="0.33"
                android:layout_marginLeft="3dp"
                android:layout_marginRight="3dp" 
                android:orientation="horizontal" >

                 <TextView
                 android:id="@+id/bottomArea1"
                 android:layout_width="fill_parent"
                 android:layout_height="wrap_content"
                 android:layout_marginRight="3dp"
                 android:text="Bottom Area 1" />

                 <TextView
                 android:id="@+id/bottomArea2"
                 android:layout_width="fill_parent"
                 android:layout_height="wrap_content"
                 android:layout_marginRight="3dp"
                 android:text="Bottom Area 2" />

            </LinearLayout>

         </LinearLayout>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T01:16:02.340

快速说明：嵌套权重会导致性能不佳，尽可能避免。不要混用`match_parent`和`fill_parent`。只需使用`match_parent`.

你的主要问题是你有`layout_height="wrap_content"`你的外层`LinearLayout`，但你有重量。您将每个子布局指定为总数的 1/3，然后说总数应该是其子布局的总和。每个子布局应该是 1dp 吗？100dp？如果您希望每个都占整个屏幕的 1/3，则应设置`layout_height="match_parent"`为外部`LinearLayout`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T01:22:33.250

我同意 Kabuko，但是请将所有的 fill_parent 更改为 match_parent。

我建议您将高度更改为 0dp，但将所有 LinearLayout 的权重设置为 1。

权重值是“因素”而不是百分比。

请参考这篇[android:layout_weight 是什么意思？](https://stackoverflow.com/questions/3995825/what-does-androidlayout-weight-mean)有关如何使用 layout_weight 的清晰示例

# quickblox - 如何在聊天功能中更改用户 ID 的注册要求

> ID：15079567
> 
> 赞同：1
> 
> 时间：2013-02-26T01:05:41.620
> 
> 标签：quickblox

嗨，当我运行 quickblox 提供的示例聊天功能时，它包含一些用户名注册的内置限制，例如，我需要有一定数量的字符或字符类型才能注册。我想知道哪些文件包含错误消息的注册和显示（我只在 SignUpViewController 中找到了一个名为“errors”的类）以及如何更改这些限制？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T15:51:52.970

有2种方式：

*   注册然后使用电子邮件登录
*   注册并使用登录名登录 - 登录字段应仅包含字母数字和标点字符

可以吗？或者您对其他用户的字段有疑问？

# asp.net-mvc-2 - Windows Azure 中员工角色的重要性？

> ID：15079568
> 
> 赞同：0
> 
> 时间：2013-02-26T01:05:46.100
> 
> 标签：asp.net-mvc-2, azure

在我的云应用程序中，我只使用一个角色，即不使用工作角色的网络角色。我在网络角色和工作角色之间有点混淆。

1）两者是否相同？

2）在我们的应用程序中，工作者角色的重要性是什么？

3）如果我想在我的云应用程序中添加工作者角色，那么如何添加到我的应用程序中。请建议我？

提前致谢，

PCSSCP。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T01:13:27.367

你会在几个地方找到这个答案，比如[这里](https://stackoverflow.com/a/11579428/272109)。它们都是 Windows 服务器，但 Web 角色启用了 IIS。您可以在 Web 和 Worker 角色中执行相同的操作。例如，如果您将 Tomcat 用于 Web 服务器，最好使用 Worker 角色，因为您不需要 IIS。

当您有不同的扩展需求时，您可以使用不同的角色。例如，您可能希望网站使用小型（单核）Web 角色，根据流量运行 2-5 个实例。然后可能是具有 2-10 个实例的中型（2 核）工作器，具体取决于 Azure 队列中的工作负载。只是一个虚构的场景，但希望这能说明为什么您可能希望定义多个角色。您可以自由地以单一角色运行所有代码

# erlang - 是否有适用于 Erlang 的支持向量机模块？

> ID：15079571
> 
> 赞同：2
> 
> 时间：2013-02-26T01:06:06.570
> 
> 标签：erlang, libraries, svm, libsvm

是否有任何可用的 Erlang 兼容的 SVM 实现，或者可以与[libsvm 库](http://www.csie.ntu.edu.tw/~cjlin/libsvm/)一起使用的 Erlang 绑定？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T15:23:15.167

目前我在 Erlang 中找不到任何 SVM 的实现。您可能必须编写自己的接口。有几种方法可以做到这一点。您可以在[Erlang 互操作性教程中查看这些内容](http://www.erlang.org/doc/tutorial/overview.html)

1.  [NIF 驱动程序](http://www.erlang.org/doc/tutorial/nif.html)

2.  [端口驱动程序](http://www.erlang.org/doc/tutorial/c_portdriver.html)

3.  端口

4.  Erl接口

5.  C节点

您还可以检查 stackoverflow 链接[Integrating Erlang with C++](https://stackoverflow.com/questions/1811516/integrating-erlang-with-c)。

# java - 使用java rmi协议将文本文件内容解析到客户端窗口？

> ID：15079577
> 
> 赞同：0
> 
> 时间：2013-02-26T01:07:03.310
> 
> 标签：java, rmi

我是 RMI 技术的新手，在用户连接到 RMI 服务器后，正在努力将文件内容解析到客户端命令窗口。

问题是我可以读取文件，但它只读取第一行而不是文件内容的其余部分。有人可以查看我的代码，看看哪里错了。

## 界面

```
/**
 * The purpose of this interface is to declare a set of remote methods 
 * and each remote method must declare RemoteException in its throws clause 
 * Here we are simple making this available to remote accesseser 
 * 
 * A remote interface defines a remote service.
 * The interface java.rmi.remote extend not interface or methods,
 * it is a marker interface which distinguishes remote interfaces from non-remote interfaces.*/

 import java.rmi.Remote;
 import java.rmi.RemoteException;

 public interface RemoteInterface extends Remote {

    /**
     * method returns a String message to its caller
     * @param str :value of String*/
     public String sayHello(String str) throws RemoteException;
     public String displayQuestions() throws RemoteException;
 } 
```

## 远程对象

```
import java.io.BufferedReader;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;
import java.rmi.RemoteException;

 //remote object
 public class HelloImpl implements RemoteInterface {

@Override
public String sayHello(String str) throws RemoteException {
    return "Hello: " + str;
}

@Override
public String displayQuestions() throws RemoteException {

    try {
        BufferedReader br = new BufferedReader(new FileReader("questions.txt"));
        while(true){
            String line = br.readLine();
            if(line == null) break;
        return line;
        }
    } catch (FileNotFoundException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    return null;
    }
} 
```

## RMI 服务器

```
 /**
 * The purpose of this class is to implement the server. 
 * This class will have a main() method that:-
 * 1- creates an instance(object of remote object) of the remote object implementation,
 * 2- then exports the remote object
 * 3- then register the remote object with a Java RMI registry
 * */

    import java.rmi.registry.LocateRegistry;
    import java.rmi.registry.Registry;
    import java.rmi.server.UnicastRemoteObject;

//RMI Server
public class HelloServer {

public HelloServer() {
}

public static void main(String[] args) {
    try {

        //Create an instance of the remote object
        //here remoteObj is an instance of remote object 'HelloImpl'
        HelloImpl remoteObj = new HelloImpl();

        //To Export the remote object, we will use 'UnicastRe...exportObject(remoteObj, TCPPortNo)' method
        //When you export a remote object, you make that object available to accept incoming calls from clients
        //If you pass a zero to the method, the default TCP port number 1099 is used.
        //Note that the exportObject() method will return a stub, which is a term used to describe a proxy class
        //The stub class is a key to make remote object available for remote invocation
        RemoteInterface stub = (RemoteInterface) UnicastRemoteObject
                .exportObject(remoteObj, 0);
        // Bind the remote object's stub in the registry
        // create a registry instance, this will get me the handle to the registry
        Registry registry = LocateRegistry.getRegistry();
        registry.rebind("nameOfRObj", stub); // here we bind an instance of the object in the registry 
        System.out.println("Hello Server is ready to listen...");

    } catch (Exception e) {
        System.err.println("Server exception thrown" + e.toString());
        e.printStackTrace();
    }
}

  } 
```

## RMI 客户端

```
 import java.rmi.registry.LocateRegistry;
 import java.rmi.registry.Registry;
 import java.util.ArrayList;
 import java.util.List;

 public class HelloClient {

public HelloClient(){}

public static void main(String[] args){

    //String mood = inProfit() ? "happy" : "sad";
    //if args length is lessthan 1, then assign the value localHost to field hostName
    //otherwise, assign args[0] thats passed to hostName
    String hostName = (args.length < 1) ? "localHost" : args[0];
    try {
        //Locate a host from the registry mechanism.
        Registry registry = LocateRegistry.getRegistry(hostName);
        //look up the remote object by its name
        RemoteInterface stub = (RemoteInterface) registry.lookup("nameOfRObj"); 

        String name = stub.sayHello("Betty");
        System.out.println("Got info from server: " + " " + name);

        List<String> list =  new ArrayList<String>();
        list.add(stub.displayQuestions());

        for(String line : list)
        System.out.println("Content" + line);

    } catch (Exception e) {
        System.out.println("Client exception thrown: " + e.toString());
        e.printStackTrace();
    }
}

} 
```

## 文本文件内容

```
Questions database:
Q1: (A + B)*(A+B)
1\. A*A + B*B
2\. A*A +A*B + B*B
3\. A*A +2*A*B + B*B  
Q2: (A + B)*(A - B)
1\. A*A + 2*B*B
2\. A*A - B*B 
3\. A*A -2*A*B + B*B
Q3: sin(x)*sin(x) + cos(x)*cos(x)
1\. 1 
2\. 2
3\. 3 
```

## 当前结果

```
D:\rmi>java HelloClient
Got info from server:  Hello: Betty
ContentQuestions database: 
```

## 预期结果

客户窗口一次应该出现一个问题，当他/她回答第一个问题时，会出现第二个问题，然后是第三个问题，最后是回答正确问题的分数。

例如在客户端窗口：
请选择正确答案
Q1：blalalala？
1：A
2：b
3：c
输入：a

请选择正确答案
Q2：blalalala？
1：A
2：b
3：c
输入：b
....

最终得分 2 出可能 3 Q
再见！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T01:17:42.827

您的 while 循环中有一个返回 - 确保只会以这种方式处理一次迭代......试试这个：

```
String content = "";
while(true){
   String line = br.readLine();
    if(line == null) break;
    content += line;
}
return content; 
```

# c++ - 带有模板实例化的模板静态库

> ID：15079578
> 
> 赞同：8
> 
> 时间：2013-02-26T01:07:06.257
> 
> 标签：c++, templates

我正在开发一个静态库，该库有多个类模板和函数模板。我了解为了使用静态库中的模板，所有内容（声明/定义）都需要在头文件中。但是，在这种特殊情况下，因为我知道专业化类型，我认为我可以使用前向声明专业化。

这个技巧与类模板（及其函数）配合得很好，我可以使用我的应用程序代码中的所有库函数。但是，一旦我在库中引入免费函数模板并尝试使用我的应用程序代码中的免费模板函数，它就会给我链接器错误：

> 错误 LNK2019：函数 _main 1>C:\src\cpp 中引用的未解析的外部符号“class TemplatedStaticLib __cdecl HelpingRegistration(int)”(??$HelpingRegistration@H@@YA?AV?$TemplatedStaticLib@H@@H@Z) \vs2008\StaticLibExample\MathFuncsLib\Debug\TemplatedStaticLibApp.exe : 致命错误 LNK1120: 1 unresolved externals" 我正在使用 VS2008，这是代码

//静态库头文件（.h）

```
#ifndef _TEMPLATED_STATIC_LIB_
#define _TEMPLATED_STATIC_LIB_

#include <iostream>

template<typename T>
class TemplatedStaticLib
{
public:
    TemplatedStaticLib(){};
    ~TemplatedStaticLib(){};

    void print(T t);

};

template<typename T>
TemplatedStaticLib<T> HelpingRegistration(T);

#endif 
```

//静态库类文件（.cpp）

```
#include "TemplatedStaticLib.h"

//Specialization
template class TemplatedStaticLib<double>;
template class TemplatedStaticLib<int>;
template class TemplatedStaticLib<std::string>;

template<typename T>
void TemplatedStaticLib<T>::print(T t)
{
    std::cout << "Templated Print "  << typeid(t).name() << std::endl;
}

void HelpingRegistration(void)
{
}

//Specialization of free function
template<> TemplatedStaticLib<int> HelpingRegistration<int>(int);
template<> TemplatedStaticLib<double> HelpingRegistration<double>(double);
template<> TemplatedStaticLib<std::string> HelpingRegistration<std::string>(std::string);

template<typename T>
TemplatedStaticLib<T> HelpingRegistration(T t)
{
       std::cout << "Function Templated Print "  << typeid(t).name() << std::endl;
       return t;
} 
```

//应用代码

```
#include "TemplatedStaticLib.h"

int main(int argc, char* argv[])
{
    int anInt = 99;
    TemplatedStaticLib<int> test; 
    test.print(anInt);//works

    double aDouble = 3.9;
    TemplatedStaticLib<double> double_test; 
    double_test.print(aDouble); //works

    std::string aString = "James";

    TemplatedStaticLib<std::string> string_test; 
    string_test.print(aString);//works

    //The following lines gives linker error
    HelpingRegistration(anInt);
    HelpingRegistration(aDouble);
    HelpingRegistration(aString);

    return 0;
} 
```

我不确定为什么会有所不同以及如何解决此问题。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-26T01:24:52.887

请注意，这些**不是**前向声明，而是类模板的*显式实例化。*这就是允许您将定义放在`.cpp`文件中并且链接器不会获得未解决的引用错误的原因，只要在其他翻译单元中您只使用这些模板实例。

另一方面，这些：

```
template<> TemplatedStaticLib<int> HelpingRegistration<int>(int);
template<> TemplatedStaticLib<double> HelpingRegistration<double>(double);
template<> TemplatedStaticLib<std::string> HelpingRegistration<std::string>(std::string); 
```

是函数模板的*显式特*化的声明。相反，您最可能打算做的是提供**显式实例化**。这样做的语法如下：

```
template TemplatedStaticLib<int> HelpingRegistration<>(int);
template TemplatedStaticLib<double> HelpingRegistration<>(double);
template TemplatedStaticLib<std::string> HelpingRegistration<>(std::string); 
```

一旦你解决了这个问题，你会看到编译器实际上会*实例化*你的`HelpingRegistration<>()`函数模板，并且它也会在这样做时发出错误，因为你试图将`int`(resp. a `double`or `string`) 转换为类型`TemplatedStaticLib<int>`(resp .`TemplatedStaticLib<double>`或`TemplatedStaticLib<string>`)，没有提供转换（或至少未在您发布的代码中显示）：

```
template<typename T>
TemplatedStaticLib<T> HelpingRegistration(T t)
{
    std::cout << "Function Templated Print "  << typeid(t).name() << std::endl;
    return t; // CANNOT BE CONVERTED!
} 
```

修复这个错误（例如通过做`return TemplateStaticLib<T>();`）将使程序编译*和*链接。

# google-apps-script - 如何为域部署 Google Apps 脚本？

> ID：15079581
> 
> 赞同：7
> 
> 时间：2013-02-26T01:07:23.823
> 
> 标签：google-apps-script

我有一个脚本，我想向我们 Google Apps 域的所有用户提供，但我不想将它发布到 Chrome 商店。我们希望避免从单个用户帐户部署它。这通常是如何完成的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T08:18:45.293

这实际上取决于您的用例，但是可以通过多种方式来实现这一点，包括发布[代码库](https://developers.google.com/apps-script/guide_libraries)（并限制链接的共享）、将其托管在[Google 站点](https://developers.google.com/apps-script/execution_gadgets)中以及将其发布为[url 触发的 webservice](https://developers.google.com/apps-script/execution_web_apps)。

这取决于您是想将功能分享给其他人还是直接分享代码。

# javascript - JQuery-Javascript 循环问题

> ID：15079588
> 
> 赞同：0
> 
> 时间：2013-02-26T01:07:56.363
> 
> 标签：javascript, jquery, xml, ajax

我正在为网站制作横幅，我需要它来循环浏览图像。我的问题是它播放图像一次然后停止。我已经尝试了我能想到的一切，但没有运气。我敢肯定这比我做的要简单，但我们将不胜感激。最新版本如下。

```
$(document).ready(function(){

    // Variables required by script
    var currentimage;

    // Load Gallery XML file
    $.ajax({
        url: 'banner.xml',
        type: 'GET',
        dataType: 'xml',
        error: function(){
            alert('Error loading XML document');
        },
        success: function(xmlData){
            // do something with xml
            setupImages(xmlData);
        }
    });

    // Display images
    function setupImages(xmlData) {
        // read xml and use it to populate page 
        //get first image
        currentimage = $(xmlData).find("image:first");

        // Fade in image after countdown
        var t = setTimeout(function(){showNewImage()}, 1000);
    }

    // Display the image, caption, rating and label 
    function showNewImage() {
        var image = $(currentimage).find("path").text();
        var caption = $(currentimage).find("caption").text();

        $("#imagelabel").removeClass("active");
        // Fade out current image and fade in new image
        $("#bannerimgholder").animate({opacity:0},500, 
            function(){
                $(this).css({"backgroundImage":"url("+image+")"}).animate({opacity:1},1000, 
                function(){
                    $("#imagelabel").addClass("active");
                });
            });
        // Add caption
        $("#imagelabel").text(caption); 

        var to = setTimeout(function(){getNextImage()}, 5000);
    }

    function getNextImage(){
        var tmp = $(currentimage).next();                                               
        if ($(tmp).find("path").text()=="") {
            currentimage = $(xmlData).find("image:first");
        } else {
            currentimage = tmp;
        }
        showNewImage();
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:18:44.613

这是我想出的一个解决方案。

首先，我在 xml 文件的末尾添加了一个元素，其中只有“last”的“path”属性。

接下来，我添加以下变量来保存第一个元素的路径名：

```
var imagepathtext; 
```

然后，在 setupImages(xmlData) 函数中，我添加了以下内容：

```
imagepathtext = $(currentimage).find("path").text(); 
```

最后，我将 getNextImage() 函数从

```
function getNextImage(){
    var tmp = $(currentimage).next();                                               
    if ($(tmp).find("path").text()=="") {
        currentimage = $(xmlData).find("image:first");
    } else {
        currentimage = tmp;
    }
    showNewImage();
} 
```

至

```
function getNextImage(){
                var tmp = $(currentimage).next();                                               
                if ($(tmp).find("path").text()=="last") {
                    while ($(tmp).find("path").text()!=firstimagepath)
                    {
                        var tmp1 = $(tmp).prev();
                        tmp = tmp1;
                    }
                    currentimage = tmp;
                } else {
                    currentimage = tmp;
                }               
                showNewImage();
            } 
```

就像魔术一样，它现在可以正确循环了！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T01:16:14.223

您的代码正在使用`next()`，一旦您到达最后一张图像，它将不返回任何内容。

您需要使用不同的测试来关闭循环，例如：

```
tmp.length==0 
```

请注意，tmp 已经是一个 jQuery 对象，因此您不需要将其包装在 $() 中。

[此页面](http://www.mattvanandel.com/999/jquery-nextorfirst-function-guarantees-a-selection/)提供了一个 nextOrFirst() 函数的示例，它可以满足您的需求。

# html - 如何在 colgroup 上获得轮廓边框？

> ID：15079589
> 
> 赞同：14
> 
> 时间：2013-02-26T01:08:07.303
> 
> 标签：html, css, css-tables

我有一个 17 列的表，分为 3 个列组。我可以使用 CSS 设置背景颜色，这表明我的 CSS 选择器很好。但是，我不能在每个 colgroup 的外部设置边框。

首先我尝试了这个 CSS：

```
colgroup.inbound, colgroup.outbound {
    background-color: #eeeeee;
    border: 1px solid red;
} 
```

并以这种方式定义列组：

```
<colgroup span="2"></colgroup>
<colgroup span="12" class="inbound"></colgroup>
<colgroup span="3" class="outbound"></colgroup> 
```

接下来我尝试了这个 CSS：

```
col.inbound, col.outbound {
    background-color: #eeeeee;
    border: 1px solid red;
} 
```

并以这种方式定义组：

```
<colgroup
    <col span="2">
    <col span="12" class="inbound">
    <col span="3" class="outbound">            
</colgroup> 
```

在这两种情况下，我的背景颜色都会生效，但我的边框不会。我能看到的唯一边界是所有单元格之间的一条细白线（而不是整个组周围）。

我知道 table`rules`属性，但是我不想使用它。我认为 CSS 会给我更多的灵活性，如果我能弄清楚如何使用它！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-26T02:05:05.663

为了在使用表格时使边框正常工作，您应该为表格设置以下规则

```
table.collapsed{
  border-collapse:collapse;
} 
```

当你假装时，你会得到你的边界

![在此处输入图像描述](../Images/3deb8c61ccfa7e2e3b7ae413e441bbee.png)

```
col.inbound, col.outbound {
    background-color: #eeeeee;
    border: 1px solid red;
} 
```

这个[JsBin中的一个简单示例](http://jsbin.com/ubapih/4/edit)

**选项** 整个组的边框，而不是每列的边框

![在此处输入图像描述](../Images/de2c04b868e378fb183b560b747d2f28.png)

那么你应该像这样统治 colgroup 而不是 cols ..

```
colgroup.inbound  {
  border: 1px solid #ff0000;
} 
```

记住总是使用边框折叠！这可以在这个[JsBin中看到](http://jsbin.com/ubofen/3/edit)

# c# - 在窗口内自动拉伸数据网格？

> ID：15079591
> 
> 赞同：0
> 
> 时间：2013-02-26T01:08:08.313
> 
> 标签：c#, wpf, xaml, datagrid

我创建了一个数据网格并将其放置在 WPF 表单中的某个位置。

现在我要做的是让数据网格改变它的大小，使其保持与原始位置相同的比例，同时 WPF 窗口改变大小（希望这是有道理的）。

我尝试将 autostretch 设置为 true，但这并没有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T01:19:50.143

在我的办公室里有我的电脑和 Visual Studio，所以无法测试它:) 但如果你将对齐设置为拉伸，这不应该工作吗？

datagridObj.Horizo​​ntalAlignment = System.Windows.Horizo​​ntalAlignment.Stretch; datagridObj.VerticalAlignment = System.Windows.VerticalAlignment.Stretch;

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T01:35:50.403

当然这是有道理的，但听起来您并不真正了解 WPF 布局系统是如何工作的，除非您这样做，否则前进将非常痛苦。简而言之，您需要有一个合适的容器——我推荐使用 Grid——并将 DataGrid 放置在该容器中。然后，您可以为 DataGrid 设置边距等，以随心所欲地放置它，并且如果它的 Width 和 Height 设置为 Auto，它将与它的父容器保持一致。

现在，如果您在图片中还有其他几个控件，当然它会涉及更多，但我仍然建议保留网格并将它们分成您需要的任意多行和多列，然后分别为它们的高度/宽度设置适当的值 -您可以使某些列的宽度固定，或其他列的倍数，或者将它们保留为 Auto，它们将占用剩余的空间。

当然，该主题涉及更多，但您可以在 MSDN 上找到快速入门：http: [//msdn.microsoft.com/en-us/library/ms745058.aspx](http://msdn.microsoft.com/en-us/library/ms745058.aspx)

如果您只记得一件事，应该是这样的：网格表示 WPF 中的流体布局，尽可能多地使用它们而不是画布。当然 StackPanel 和 DockPanel 等都有自己的特定用途。

PS Visual Studio 设计师通常会做一些乱七八糟的事情，通过设置边距等让拖放更直观，你应该密切关注它修改的属性，看看你是否更好地定位东西绘制布局后，通过手动修改 XAML（通常是这样）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T15:35:02.490

举个例子

```
<Window x:Class=""
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <Grid>
        <DataGrid Margin="162,57,141,54"/>
    </Grid>
</Window> 
```

默认情况下 a`DataGrid`是

```
HorizontalAlignment="Stretch" 
VerticalAlignment="Stretch" 
```

所以你只需要像**Arno Saxena**告诉你的那样的保证金

# three.js - 如何在three.js中为球体添加标签

> ID：15079592
> 
> 赞同：1
> 
> 时间：2013-02-26T01:08:20.110
> 
> 标签：three.js

我是three.js 的新手，但这是我想要做的。

我有一个球体..我想在它的表面上添加一个距离（比如）2 个单位的 id 标签。

所以

```
var geometry = new THREE.SphereGeometry( 50, 25, 25 );
 var draw_object = new THREE.Mesh( geometry, [ new THREE.MeshBasicMaterial( {  color: Math.random() * 0xffffff, opacity: 0.5 } ) ] ); 
```

现在我想给它起一个名字“sphere 1”

然后在距离球体表面“x”单位的距离处..为其分配一个标签。问题是这个球体在空间中移动......所以标签必须留在它上面。

从过去两天开始，我一直在尝试，但没有任何运气。

帮助任何

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T22:00:14.450

您可能希望使用上面引用的示例中的 Sprite（[如何将 Label 添加到 THREE.Mesh？](https://stackoverflow.com/questions/11447821/how-to-add-label-to-a-three-mesh)）但是，不是将位置设置为鼠标坐标，而是计算球体的偏移量 - 说它是，例如， (3,4,5) - 并执行类似的操作

```
label.position.set( sphere.position.add( new THREE.Vector3(3,4,5) ) ); 
```

这样，标签的位置存储了对球体位置的引用，并且随着球体的移动，标签将随之移动。

# string - 从具有重复结构的字符串中提取值

> ID：15079594
> 
> 赞同：3
> 
> 时间：2013-02-26T01:08:44.493
> 
> 标签：string, r

假设我有一个字符串向量，如下所示：

```
vectorOfStrings <- c("Name: Andrew, College: Bradford",
                     "Name: Charlie Daniels, College: Easton College",
                     "Name: Frank Gehry, III, College: Highlands University") 
```

其中有明显重复的“姓名：”、“学院：”模式。

我想生成一个如下所示的列表（或 data.frame）：

```
listOfValues <- list(c("Andrew", "Charlie Daniels", "Frank Gehry, III"),
                     c("Bradford", "Easton College", "Highlands University")) 
```

从`vectorOfStrings`to最直接的方法是`listOfValues`什么？我相当熟悉`base`字符串操作函数以及`stringr`，但我想这是一种相对常见的情况，并希望有一个相对完善的解决方案。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T01:50:23.673

以下是两种可能的解决方案：

**(1) strapplyc**该`mat`语句创建一个矩阵，其第一列包含名称，第二列包含学院。然后我们在最后一条语句中将其转换为未命名列表：

```
library(gsubfn)

pat <- "Name: (.*), College: (.*)"
mat <- strapplyc(vectorOfStrings, pat, simplify = rbind)

unname(as.list(as.data.frame(mat, stringsAsFactors = FALSE))) 
```

**(2) gsub/read.table** 一个只使用纯 R 的变体是使用上面的`gsub`with`pat`将每个输入字符串转换为包含数据但不包含标签的管道分隔字符串。读取它`read.table`会给出一个数据框，`DF`. 最后，我们转换`DF`为一个无名列表：

```
g <- gsub(pat, "\\1|\\2", vectorOfStrings)
DF <- read.table(text = g, sep = "|", as.is = TRUE)

unname(as.list(DF)) 
```

添加：第二种解决方案

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-26T01:30:46.607

我喜欢数学咖啡的想法，但既然我已经写好了，这里还有另一种可能性：

```
X <- strsplit(vectorOfStrings, ",\\s*(?=College:)", perl=TRUE)
do.call(rbind, lapply(X, function(X) gsub("(Name|College):\\s*", "", X)))
#      [,1]               [,2]                  
# [1,] "Andrew"           "Bradford"            
# [2,] "Charlie Daniels"  "Easton College"      
# [3,] "Frank Gehry, III" "Highlands University" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-26T05:18:58.450

```
 do.call(rbind, strsplit(unlist(
            strsplit(vectorOfStrings, "Name: ")), ", College: "))

       [,1]               [,2]                  
  [1,] "Andrew"           "Bradford"            
  [2,] "Charlie Daniels"  "Easton College"      
  [3,] "Frank Gehry, III" "Highlands University" 
```

* * *

似乎已经有很多好的答案了。与@Josh O'Brien 类似，我会使用 strsplit。

由于您没有保留`"Name"`and `"College"`，因此您可以直接拆分它。然后，您只需将其包装在 a`do.call(rbind, ___)` 中，它将自动删除拆分创建的任何空字符串。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-26T01:23:51.917

`regexp`我用,做这种事情`perl=T`) （还没有找到提取捕获组的好方法）：

```
m <- regexpr('^Name: *(.+), *College: (.+) *$',
             vectorOfStrings, perl=T)
# m looks like this:
# [1] 1 1 1
# attr(,"match.length")
# [1] 31 46 53
# attr(,"useBytes")
# [1] TRUE
# attr(,"capture.start")  # one column per capturing bracket,   
# [1,] 7 24               # one row per entry in vectorOfStrings
# [2,] 7 33
# [3,] 7 34
# attr(,"capture.length")    
# [1,]  6  8
# [2,] 15 14
# [3,] 16 20
# attr(,"capture.names")
# [1] "" ""

# laziness
st <- attr(m, 'capture.start')
en <- st + attr(m, 'capture.length') - 1
numCaptures <- ncol(st)

matches <- sapply(1:numCaptures, function (i) {
    return(substr(vectorOfStrings, st[, i], en[, i]))
})

# matches
#     [,1]               [,2]                  
# [1,] "Andrew"           "Bradford"            
# [2,] "Charlie Daniels"  "Easton College"      
# [3,] "Frank Gehry, III" "Highlands University" 
```

现在按摩`matches`成您想要的形式。我通常将它包装在一个函数中，因为我经常使用它。

你甚至可以像这样使用 Perl 命名正则表达式：

```
m <- regexpr('^Name: *(?<name>.+), *College: (?<college>.+) *$',
             vectorOfStrings, perl=T) 
```

然后`attr(m, 'capture.names')`将是`c('name', 'college')`，`colnames(attr(m, 'capture.(start or length)'))`也是`c('name', 'college')`。

无论如何，密钥似乎正在使用`perl=T`，否则`regexpr`不会为每个捕获括号返回一组起点/终点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-26T01:36:32.117

使用反向引用可能更简单

```
> vectorOfStrings
[1] "Name: Andrew, College: Bradford"                       "Name: Charlie Daniels, College: Easton College"       
[3] "Name: Frank Gehry, III, College: Highlands University"
> list(gsub('^Name:(.*), College:(.*)$',"\\1", vectorOfStrings) , gsub('^Name:(.*), College:(.*)$',"\\2", vectorOfStrings))
[[1]]
[1] " Andrew"           " Charlie Daniels"  " Frank Gehry, III"

[[2]]
[1] " Bradford"             " Easton College"       " Highlands University" 
```

# ios6 - [UICollectionViewCell imageCell]：发送到实例的无法识别的选择器

> ID：15079597
> 
> 赞同：1
> 
> 时间：2013-02-26T01:08:52.073
> 
> 标签：ios6, selector, uicollectionviewcell

我用这个标题阅读了所有问题。FavoritosViewController.m 我有：

```
- (UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath {
favcolCell *cell = [collectionView dequeueReusableCellWithReuseIdentifier:@"fav" forIndexPath:indexPath];
[[cell imageCell]setImage:[UIImage imageNamed:[arrayimages objectAtIndex:indexPath.item]]];
return cell;
} 
```

在 favcolCell.h 我有：

```
@property (retain, nonatomic) IBOutlet UIImageView *imageCell; 
```

在 favcolCell.m 我有：

```
 @synthesize imageCell; 
```

(...)

```
- (void)dealloc {
    [imageCell release];
    [super dealloc];
} 
```

我错过了什么？

编辑：

解决方案：进行正确的班级注册。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-10T16:03:27.687

我错过了这个：

```
[self.collectionView registerClass:[FavoritosRestViewCell class] forCellWithReuseIdentifier:@"fav"]; 
```

关于`ViewDidLoad`方法。我注册了错误的课程。感谢用户 HotLicks。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-15T07:01:46.007

对我来说，这是解决方案..

我在单元格内拍摄了一个集合视图和 imageView。但我忘了在界面（故事板）文件中设置标签。

故事板-> 集合视图-> 图像视图-> 属性检查器-> 在此处设置标签。

我希望它可以帮助某人。

# jquery - jQuery调整旋转元素的大小

> ID：15079598
> 
> 赞同：6
> 
> 时间：2013-02-26T01:08:56.883
> 
> 标签：jquery, jquery-ui, rotation

我已经四处寻找这个问题，但还没有真正找到一个明确的解决方案或示例来解决它。使用 jQuery，当我旋转可调整大小时，句柄和随后的调整大小操作都会出错。我该如何解决或解决这个问题？这是我正在谈论的一个例子：http: [//jsfiddle.net/LVU7c/](http://jsfiddle.net/LVU7c/)

小提琴中的代码是：

```
$('#widget').resizable({ handles: 'n, e, s, w' }); 
```

和 CSS 将一个简单的 div 标签旋转 90 度。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-26T21:30:03.043

对此的基本概念是由[Linus Gudn Jokela](https://stackoverflow.com/users/1693931/linus-gudn-jokela)发布的，他删除了他的答案，尽管我提出了要求，但他没有恢复它。

您可以为您的内容使用旋转的内部包装，然后将调整大小的手柄附加到保持未旋转的外部元素。

就高度和宽度而言，需要一些 JS 代码来使内容与容器保持同步。这是一个完整的演示：http: [//jsfiddle.net/fXthv/](http://jsfiddle.net/fXthv/)

**JS：**

```
$('#widget').resizable({
    handles: 'n, e, s, w',
    resize: function(){
        correct(this);
    }
});

function correct(el) {
    var widget = $('#widget_content'),
        deg = widget.data("rotate");
    if (typeof deg == "number") {
        widget.css({
            width: (function () {
                if (deg % 180 == 0) return $(el).outerWidth()
                else return $(el).outerHeight()
            })(),
            height: (function () {
                if (deg % 180 == 0) return $(el).outerHeight()
                else return $(el).outerWidth()
            })(),
            marginLeft: (function () {
                if (deg % 360 == 90) return $(el).outerWidth();
                else if (deg % 360 == 180) return $(el).outerWidth();
                else return 0;
                //else if (deg % 360 == 270) return $(el).outerWidth();
            })(),
            marginTop: (function () {
                if (deg % 360 == 270) return $(el).outerHeight();
                else if (deg % 360 == 180) return $(el).outerHeight();
                else return 0;
                //else if (deg % 360 == 270) return $(el).outerWidth();
            })()
        });
    }
} 
```

**CSS：**

```
#widget {
    width: 100px;
    height: 100px;
    background-color: #cecece;
}
#widget_content {
    margin-left:100px;
    width: 100px;
    height: 100px;
    background-image: url(http://aux.iconpedia.net/uploads/2106003206.png);
    background-size: 100% 100%;
    /* removing the styles below will make the image appear as expected */
    -webkit-transform-origin: 0 0;
    -moz-transform-origin: 0 0;
    -ms-transform-origin: 0 0;
    -o-transform-origin: 0 0;
    transform:rotate(90deg);
    -ms-transform:rotate(90deg);
    /* IE 9 */
    -moz-transform:rotate(90deg);
    /* Firefox */
    -webkit-transform:rotate(90deg);
    /* Safari and Chrome */
    -o-transform:rotate(90deg);
    /* Opera */
} 
```

**HTML：**

```
<div id="widget">
    <div id="widget_content"></div>
</div> 
```

# python - 在 Django 查询集 order by 子句中使用绝对函数

> ID：15079603
> 
> 赞同：3
> 
> 时间：2013-02-26T01:09:25.150
> 
> 标签：python, django, sql-order-by

我有一个使用以下模型的简单查询集：

```
class question(models.Model):
question_id = models.AutoField(primary_key=True) # Field name made lowercase.
question = models.TextField() # Field name made lowercase.
type = models.IntegerField() # Field name made lowercase.    
difficulty = models.DecimalField(max_digits=12, decimal_places=10) 
```

查询集定义为：

```
...
theta=10
q=question.object.filter(type=1).order_by(abs('difficulty'-theta)) 
```

我收到一个 TypeError: cannot concatenate 'str' and 'int' objects

等效的 SQL 有效。但是，如果可以的话，我想使用标准的 django ORM。

```
select * from quiz_question where type=1 order by abs(difficulty-10) 
```

我已经尝试使用该`extra()`方法。特别是指定方程的选择参数，以及`order_by`进行排序的参数。

```
...
theta=10
q=question.object.filter(type=1).extra(select={'diff': abs('difficulty-10')}).extra(order_by=['diff']) 
```

我得到一个错误的操作数类型错误。有什么好主意吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-26T01:24:25.440

```
q = question.object.filter(type=1).extra(
    select={"diff": "abs(difficulty-10)"}).order_by("diff") 
```

# build-process - TeamCity - 禁止将工件发送回构建服务器

> ID：15079604
> 
> 赞同：0
> 
> 时间：2013-02-26T01:09:39.753
> 
> 标签：build-process, teamcity, build-automation, teamcity-7.0

在 TeamCity 构建结束时，它将工件发送回 TC 服务器。我不需要发生这种情况，因为我的构建脚本将它们推送到 S3，我们的 Web 服务器从中提取有效负载。有没有办法可以禁止它们被发回，因为文件太大了，所以这一步需要 1 分 30 秒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T21:40:31.853

这可以通过清除构建配置的*常规设置*`Artifact paths`中的字段来最容易地完成。TeamCity 应该只保存其中包含的内容（除了一些内部报告项目之外。）

# java - KeyListener 仅有时有效

> ID：15079612
> 
> 赞同：0
> 
> 时间：2013-02-26T01:10:33.927
> 
> 标签：java, awt, keylistener

我正在写一个游戏，我刚刚尝试添加 KeyListener。我有使用包括 KeyListeners 在内的 java 经验，但由于某种原因，我无法弄清楚为什么这段代码只在某些时候有效。

这是我的监听器功能：

```
public void Listener() { 
    System.out.println("[INFO] Listener() Ran.");

    KeyListener kl = new KeyListener() {
        public void keyPressed(KeyEvent e) {
            if(e.getKeyChar()=='a'){
                System.out.println("[DEBUG] A Pressed.");
            }
        }

        public void keyReleased(KeyEvent e) {
        }

        public void keyTyped(KeyEvent e) {
        }
    };
    panel.addKeyListener(kl);
    System.out.println("[DEBUG] panel added KeyListener.");
} 
```

这段代码在我运行它的 10 次中可能只有 1 次有效。甚至可能更少。关于为什么会这样的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T07:23:00.603

getKeyChar 应该在 keyTyped 中调用。在`getKeyCode() == KeyEvent.VK_A`其他两种方法中。

# chef-infra - 使用应用程序和 supervisor_service 的厨师食谱

> ID：15079614
> 
> 赞同：2
> 
> 时间：2013-02-26T01:10:48.933
> 
> 标签：chef-infra

我一直在尝试运行以下食谱食谱——它使用 opscode 应用程序和主管食谱来安装东西。

问题是我不想总是运行主管和 pip 安装位，当我改变周围的东西以使用代码示例中注释掉的行时，通知永远不会被执行。它们应该被推迟到运行配方之后，但会丢失。

在删除注释行的情况下，“supervisor_service”上的操作是`action :nothing`.

```
application "testing" do
  repository "git@github.com:..."
  path "/opt/somewhere/testing"

  revision "master"
  notifies :run, "execute[pip-ingestion]", :immediately
  #notifies :enable, "supervisor_service[s3batcher]"
  #notifies :restart, "supervisor_service[s3batcher]"

  deploy_key <<EOF
-----BEGIN RSA PRIVATE KEY-----
....
EOF
end

execute "pip-ingestion" do
  command "pip install -r #{root}/requirements.txt"
  action :run
end

supervisor_service "s3batcher" do
    command "python #{root}/manage.py batch_s3 --settings=#{root}/settings.yaml"
    process_name "s3batcher-%(process_num)s"
    action [:enable, :restart]
    autostart true
    user "root"
    numprocs 1
end 
```

# sql - SQLite - 从多个表中删除所有内容

> ID：15079615
> 
> 赞同：4
> 
> 时间：2013-02-26T01:10:53.667
> 
> 标签：sql, sqlite

该声明：

`DELETE from users;`

将从表用户中删除所有内容。但是如何从三个表用户、inactiveUsers、activeUsers 中删除所有内容

我在 Firefox SQLite 管理器中尝试了这个查询：

`DELETE from users, inactiveUsers, activeUsers;`

它给出了错误消息 -

SQLiteManager：可能的 SQL 语法错误：DELETE from users、inactiveUsers、activeUsers；[靠近“，”：语法错误]异常名称：NS_ERROR_FAILURE异常消息：组件返回失败代码：0x80004005（NS_ERROR_FAILURE）[mozIStorageConnection.createStatement]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T01:14:30.420

你不能运行三个查询吗？

```
DELETE from users;
DELETE from inactiveUsers;
DELETE from activeUsers; 
```

如果这对您来说是一个大问题，那么您需要考虑创建外键。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T01:14:23.643

使用 3 个查询 - 每个表一个。

# asp.net - DataReader 工作在浏览器关闭之间

> ID：15079621
> 
> 赞同：0
> 
> 时间：2013-02-26T01:11:25.727
> 
> 标签：asp.net, .net, ado.net

用户使用 ADO.NET Datareader 从具有 1000 行的数据库表中提取数据。他在这期间关闭了浏览器。

那是在仅获取 50 条记录之后。数据阅读器会发生什么？它会保持连接吗？

并且会获取 1000 条记录，然后呢？垃圾收集器会很快收集和处理吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T01:22:31.270

尽管 mdmullinax 是正确的，您应该将所有内容都包含在`using`语句中以确保正确清理连接，但您的问题与 DataReader 的实现方式无关。

一般来说，即使浏览器断开连接，页面也会继续执行。

因此，如果 DataReader 正在从服务器读取响应的中途，它将在 DataReader 发出信号返回其处理已完成之前继续提取其余记录。

然后页面的其余代码完成执行并将响应刷新到浏览器。当然，此时浏览器早已不复存在，因此这些数据包最终会被丢弃......除非有东西正在检查 Response.IsClientConnected 属性。请记住，IsClientConnected 属性并不能完全证明，因为另一端的浏览器可能会在不通知服务器的情况下以多种方式消失。

有关更多信息，请查看此处：[如果我在处理过程中关闭浏览器，asp.net 生命周期是否会继续？](https://stackoverflow.com/questions/11301104/does-asp-net-lifecycle-continue-if-i-close-the-browser-in-the-middle-of-processi)

# eclipse - 在我的开发环境中设置 XDEBUG

> ID：15079624
> 
> 赞同：0
> 
> 时间：2013-02-26T01:12:05.893
> 
> 标签：eclipse, xdebug, php

在我的公司，我们的 PHP 文件没有配置为使用 XDEBUG。这让我在尝试修复错误时感觉自己像个盲人，我绝对需要调试器来理解代码流。我们远程开发，我们的服务器设置在其他地方。我想将 php.ini 文件配置为具有 xdebug，但更重要的是我想专门为我的开发环境执行此操作。本质上，我打算更改的 php.ini 文件位于

```
/etc folder. (needs root access, I have root access) 
```

我们的 dev 文件夹更像：

```
developer1 developer2 developer3 developer4 developer5 myDevelopmentEnvironment 
```

所以从技术上讲，我想编辑这个 php.ini 文件，但只更改了**myDevelopmentEnvironment**的设置，基本上覆盖了我文件夹中的主 php.ini 文件。

其他感兴趣的细节：

```
 Development machine : Windows
    Server : linux (I putty in)
    Editor: Eclipse (may move to NetBeans) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T01:28:41.240

您可以从 .htaccess 文件启用 XDEBUG，

例如。

```
php_value  zend_extension=/usr/lib/php/modules/xdebug.so
php_flag   xdebug.remote_enable on
php_value  xdebug.remote_port 9000
php_value  xdebug.idekey PHPSTORM-XDEBUG
php_flag   xdebug.remote_connect_back on 
```

# javascript - 如何在 Express.js 中正确使用 node-mysql？

> ID：15079628
> 
> 赞同：0
> 
> 时间：2013-02-26T01:13:24.503
> 
> 标签：javascript, mysql, node.js

我想知道如何`node-mysql`在 Node.js 中正确使用该模块（使用 Express.js）。我有一个主路由器：

```
var Post = require('./models/post.js');    

app.get('/archives', function (req, res) {
    Post.findArchives(function(posts, err) {
        if(err)
            res.send('404 Not found', 404);
        else
            res.render('archives', { posts: posts});
    });
}); 
```

这是文件的内容`post.js`：

```
var mysql = require('mysql');
var dbURL = 'mysql://root@localhost/mydatabase';

exports.findArchives = function(callback) {
    var connection = mysql.createConnection(dbURL);
    connection.query('SELECT * FROM blog_posts_view WHERE status != 0 ORDER BY date DESC', function(err, rows) {
        if(err) throw err
        callback(rows, err);
        connection.end();
    });
}; 
```

我该如何改进它？改进错误处理？此外，`handleDisconnect(connection);`他们的 Github ( [https://github.com/felixge/node-mysql](https://github.com/felixge/node-mysql) ) 上有一个功能，我不确定如何集成以确保在数据库没有响应时应用程序不会崩溃。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T07:55:15.857

看看[mysql-simple](https://github.com/jhurliman/node-mysql-simple)库。它结合了 node-mysql 和一个池化库来创建一个连接池，并且还包括处理断开连接的代码。

如果你想让它变得超级简单，你可以使用那个模块。

# python - TypeError：'Route' 对象不可下标 Python

> ID：15079631
> 
> 赞同：0
> 
> 时间：2013-02-26T01:13:37.833
> 
> 标签：python, python-3.x, typeerror

这是我拥有的一个脚本，它读取 JSON 文件并将路由添加到图表

```
 for route in data['routes']:
        route = Route(route['ports'][0], route['ports'][1], route['distance'])
        self.add_route(route)
        route_2 = Route (route['ports'][1], route['ports'][0], route['distance'])
        self.add_route(route_2) 
```

它给了我这个错误：

```
Traceback (most recent call last):
  File "C:\workspace\Assignment2.1\src\Main.py", line 75, in <module>
    graph.build_from_file()
  File "C:\workspace\Assignment2.1\src\Graph.py", line 195, in build_from_file
    route_2 = Route (route['ports'][1], route['ports'][0], route['distance'])
TypeError: 'Route' object is not subscriptable 
```

请注意，它在第二次调用 Route 构造函数时出现错误，而不是第一次。谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T01:16:21.013

你命名了两个不同的东西`route`。

创建第一个 后`Route`，`route`变量指向它而不是您的数据。

固定代码：

```
for route in data['routes']:
    route_1 = Route(route['ports'][0], route['ports'][1], route['distance'])
    self.add_route(route_1)
    route_2 = Route(route['ports'][1], route['ports'][0], route['distance'])
    self.add_route(route_2) 
```

# silverstripe - SilverStripe 3：在模板中的循环内调用的控制器中的函数

> ID：15079633
> 
> 赞同：1
> 
> 时间：2013-02-26T01:13:50.013
> 
> 标签：silverstripe

我编写了一个简单的自定义函数来处理超过 (>) 这工作正常并返回 1 或 0。

当我通过循环调用它时将 $Pos 传递给函数时，它停止工作。

银条第 3 版

控制器

```
 function MoreThen($pos, $value) {
if($pos > $value) {
  return TRUE;
} else {
  return FALSE;
} 
```

}

模板.ss

```
<% loop GalleryObjects %>
 <% if Top.MoreThen($Pos,2)  %>
$Pos
<% end_if %> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T01:47:06.257

AFAIK不可能将变量用作函数调用的参数，只能使用具体值。根据您想要执行的操作，您可能希望查看在模板中使用 GalleryObjects.limit()，或者编写一个特定的 getter，它只返回偏移量大于 2 的 GalleryObjects。希望这会有所帮助

# ios - 如何使用蒙版保存 UIImage

> ID：15079634
> 
> 赞同：0
> 
> 时间：2013-02-26T01:14:00.433
> 
> 标签：ios, uiimageview, uiimage, masking, cgimage

我有一个`UIImageView`可以移动/缩放的 ( `self.imageForEditing`)。在这个图像视图的顶部，我有一个带孔的覆盖层，它是静态的，不能移动。我只需要保存按下按钮时通过孔可见的底层图像的一部分。我目前的尝试：

```
- (IBAction)saveImage
{

    UIImage *image = self.imageForEditing.image;

    CGImageRef originalMask = [UIImage imageNamed:@"picOverlay"].CGImage;
    CGImageRef mask = CGImageMaskCreate(CGImageGetWidth(originalMask),
                                        CGImageGetHeight(originalMask),
                                        CGImageGetBitsPerComponent(originalMask),
                                        CGImageGetBitsPerPixel(originalMask),
                                        CGImageGetBytesPerRow(originalMask),
                                        CGImageGetDataProvider(originalMask), nil, YES);

    CGImageRef maskedImageRef = CGImageCreateWithMask(image.CGImage, mask);

    UIImage *maskedImage = [UIImage imageWithCGImage:maskedImageRef scale:image.scale orientation:image.imageOrientation];

    CGImageRelease(mask);
    CGImageRelease(maskedImageRef);

    UIImageView *test = [[UIImageView alloc] initWithImage:maskedImage];
    [self.view addSubview:test];
} 
```

作为测试，我只是想将新创建的图像添加到屏幕的左上角。理论上它应该是一个小的圆形图像（通过覆盖可见的部分）。但我只是重新创建了整个图像。我究竟做错了什么？我如何解释`self.imageForEditing`可以移动的事实？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:20:23.317

`CGImageCreateWithMask`返回与原始图像大小相同的图像。这就是为什么你会得到带有蒙版的原始图像（我假设）。

您可以应用蒙版，然后删除不可见的边框。使用这个问题的建议：[iOS：如何将图像修剪到有用的部分（删除透明边框）](https://stackoverflow.com/questions/7625089/ios-how-to-trim-an-image-to-the-useful-parts-remove-transparent-border)

找到图像不透明部分的边界并将其重新绘制成新图像。

# php - MySQL/PHP 按位置排序

> ID：15079636
> 
> 赞同：0
> 
> 时间：2013-02-26T01:14:13.080
> 
> 标签：php, mysql, sql-order-by

我有以下查询 -

```
$query = mysql_query("SELECT * FROM test where admin = 'Yes' order by name = '$_GET[name]' DESC");

while($row = mysql_fetch_array($query))
{
   $id.=$row[id];
}

echo $id; 
```

我想要一个从 $_GET[name] 的 id 开始的 id 列表，但是它返回的列表是下面行的起始名称？有任何想法吗？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T01:16:07.517

1.  使用数组

2.  您需要在列名称周围使用引号

```
$query = mysql_query("SELECT * FROM test where admin = 'Yes' order by name = '$_GET[name]' DESC");

$ids = array();
while($row = mysql_fetch_array($query))
{
   $ids[] =$row['id'];
}

// Your IDs are now in an array which is easier to work with
print_r($ids); 
```

仅供参考，[您不应该`mysql_*`在新代码中使用函数](https://stackoverflow.com/q/12859942/)。它们不再被维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。看到[**红框**](https://www.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](https://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

您也对[SQL 注入持开放态度](https://stackoverflow.com/q/60174)

# java - 一个很好的 Java 堆监控工具

> ID：15079638
> 
> 赞同：0
> 
> 时间：2013-02-26T01:14:16.400
> 
> 标签：java, memory, jvm, windows-server-2008

我一直在搜索，发现有Jstat，VisualJVM，甚至Eclipse mat工具，但它们似乎都有需要安装的JDK。

我的 .NET 应用程序（单独的服务器实例）中使用了第三方工具，该工具安装了 JRE。我没有 JDK 或任何 Java 代码，但似乎找不到工具（如 Windows 任务管理器）来监视 Java 堆。

任何好的（和免费的）建议，以及为什么它很棒的详细信息，都会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-30T02:06:41.923

eG Innovations Java 监控工具 - [http://www.eginnovations.com/web/java-monitoring.htm](http://www.eginnovations.com/web/java-monitoring.htm)

# javascript - Jquery检查'select option'元素是否具有类'treeroot'，如果为真：阻止它被选择

> ID：15079640
> 
> 赞同：-1
> 
> 时间：2013-02-26T01:14:24.080
> 
> 标签：javascript, jquery

我如何检查`select option`元素是否具有类 'treeroot' ，如果为真：阻止它从用户中选择？

```
<select  name="_groups_id_assign" size="1" class="valid">
    <optgroup label="Entité racine" style="display: none; ">
        <option value="6" class="treeroot" 
            title="Production - ">Production</option>//this one
        <option value="8" class="tree" 
            title="Production &gt; Accident du travail Agent - "
        >   »Accident du travail Agent</option>
        <option value="4" class="treeroot" 
            title="Production Automobile - "
        >Production  Automobile</option>//this one
        <option value="5" class="tree" 
            title="Production Automobile &gt; Automobile - "
        >   »Automobile</option>
    </optgroup>
</select> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T01:16:34.343

```
$("option.treerot").prop('disabled', true) 
```

用户不能选择“禁用”选项，但如果第一个选项被禁用，它在折叠时仍会出现在下拉列表中。

# ruby-on-rails - 没有显示 Rails 3 的 Kaminari

> ID：15079647
> 
> 赞同：3
> 
> 时间：2013-02-26T01:15:12.203
> 
> 标签：ruby-on-rails, ruby-on-rails-3, kaminari

我意识到用 Kaminari 分页应该很简单，但我似乎遗漏了一些东西......

我的guidelines_controller.rb 索引操作是

```
def index
    if params[:search].present?
    @search = Sunspot.search(Guideline) do  
      fulltext params[:search]
    end
    @guidelines = @search.results
  else

    @guidelines = Guideline.order(:title).page(params[:page])
  end 
```

我已经添加到views/guidelines/index.html.erb

```
<%= paginate @guidelines %> 
```

但是我的索引页面上没有显示任何内容（Kaminari 已成功捆绑）。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T14:04:19.750

根据 Sergey Kishenin - 我的本地数据库没有足够的 kaminari 指南。添加 per(1) 范围使一切变得不同。

# java - 小型 Java 应用程序的数据库建议

> ID：15079648
> 
> 赞同：1
> 
> 时间：2013-02-26T01:15:17.600
> 
> 标签：java, database

我正在开展一个项目（4 人团队），我们将创建一个应用程序，医生可以使用它来维护他们的患者信息，例如生命体征、体重等。我们决定使用 Java，我的问题是你会使用什么数据库建议使用？团队中有人建议使用文本文件，但我仍然更喜欢使用数据库，因为我对它们没有太多经验。

听说MongoDB很好，但听说主要用于大型项目。那么你建议我们使用什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T01:17:53.440

绝对使用数据库。您将要编写查询，并且针对文本文件执行此操作会发现您重新发明了轮子。

将 MySQL 用于关系数据，Mongo 确实适用于文档数据。

阅读文档（非规范化数据）和关系数据（规范化）之间的差异。

Mongo 绝对可以在单个服务器上用于小型项目。它周围有一个非常强大的社区，启动和运行只需要很少的时间。

最重要的决定是*如何*存储/建模数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T01:27:46.467

看看[sqllite](http://www.sqlite.org/)是否会在本地存储。[sqllite4java](http://code.google.com/p/sqlite4java/)可以用作 java 包装器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T01:33:46.147

使用数据库是不错的选择！！！如果你决定使用Java开发app，建议你使用java orm hibernate和mysql，使用orm，让你团队感觉使用sql和数据库并不复杂！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T01:41:10.763

如果您熟悉 OODBMS 并且您的表很小，请考虑使用[DB4o](http://www.db4o.com/DownloadNow.aspx)。关系数据库，我建议[Apache Derby](http://db.apache.org/derby/derby_downloads.html)。两者都很轻，非常易于使用，而且体积更小。

# asp.net-mvc-4 - 具有两个导航属性的延迟加载

> ID：15079652
> 
> 赞同：1
> 
> 时间：2013-02-26T01:15:38.080
> 
> 标签：asp.net-mvc-4, entity-framework-5

## 设置

我有一个相当简单的 3 类设置如下。当然还有很多其他属性，但它们在这里不相关。

**楷模**

```
public class Employee {
   public int EmployeeId { get; set; }
   public string UserName { get; set; }
   public string Name { get; set; }

   public ICollection<Position> Positions { get; set; }
}

public class Position {
   public int PositionId { get; set; }
   public int EmployeeId { get; set; }
   [ForeignKey("EmployeeId")]
   public Employee Employee { get; set; }

   public int location { get; set; }
   [ForeignKey("location")]
   public Location Location { get; set; }
}

public class Location {
   public int LocationId { get; set; }
   public string Name { get; set; }
} 
```

**控制器**

```
public ActionResult Index() {
   string username = User.Identity.Name;
   Employee emp = context.Employees.Include(e => e.Positions).FirstOrDefault(e => e.UserName == username);
   return View(emp); 
```

**看法**

```
@model Employee

<h1>Hi @Model.Name</h1>
<ul>
@foreach (var position in @Model.Positions) {
  <li>@position.Name - @position.Location.Name</li>
}
</ul> 
```

## 问题

现在的问题是因为延迟加载。我在通话中收到*NullReferenceException 。*`@item.Location.Name`它正在加载位置很好（foreach 中的项目）。

我尝试将我的包含更改为：

```
context.Employees.Include("Positions.Location").FirstOrDefault(e => e.UserName == username); 
```

但后来我得到了错误：*元数据集合中的多个项目与身份“位置”匹配。*

如果我将`Location`属性更改`Position`为，`PositionLocation`那么我得到：*System.Reflection.AmbiguousMatchException: Ambiguous match found。*

我是否应该使用一个 ViewModel 来加载多个查询到我的控制器中的上下文？这似乎需要维护更多的代码，如果我不需要，我宁愿不要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T19:01:51.833

原来这是因为 EF 不喜欢它，当你有一个导航属性和它的外键只因大小写而不同时。如果您的模型中有一个 ANYWHERE，即使您在当前请求中没有引用此属性，您也会收到此错误。

将导致 AmbiguousMatchException 的示例：

```
public int location {get;set;}
[ForeignKey("location")]
public Location Location {get;set;} 
```

运行良好的示例：

```
public int locationid {get;set;}
[ForeignKey("locationid")]
public Location Location {get;set;} 
```

# vim - 将 vim 文件语法扩展到另一个文件类型不起作用

> ID：15079653
> 
> 赞同：1
> 
> 时间：2013-02-26T01:15:50.550
> 
> 标签：vim, vim-plugin

我想扩展文件类型语法并突出显示现有文件类型。我的新文件语法的基本结构如下：

```
" Some local (new) syntax that I want to match
syn match   upfOperator "[&|~><!)(*#%@+/=?:;}{,.\^\-\[\]]"
syn match   upfDefines  "\$\S\+"
syn match   upfDefines  "\${\S\+}"
syn match   upfParens   "[)(}{\[\]]"

" load syntax that I want to extend.  This contains it's own highlight commands
runtime syntax/dtcl.vim

" New highlight statements
hi link upfOperator          Statement
hi link upfDefines           Constant
hi link upfParens            Constant 
```

问题是 dtcl.vim 文件中包含的所有语法都没有突出显示。我能够打开一个 dctl 文件并且突出显示工作。但是，当我打开其他文件类型 (*.upf) 时，会加载 upf.vim，但不会加载 dtcl.vim。

dctl.vim 没有任何会导致文件无法加载的“if syntax defined”类型的命令。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T09:00:17.757

如果*dctl.vim*是正确的 Vim 语法脚本，它会清除任何现有的语法项 ( `:syntax clear`)，因为所有语法都应该如此。因此，您必须将自己的`upf...`定义移到`:runtime`.

要正确加载现有语法，您应该使用以下命令：

```
runtime! syntax/dctl.vim syntax/dctl/*.vim 
```

您`:runtime syntax/dctl.vim`只考虑第一次出现而不考虑语法扩展。

除此之外，我认为您的方法没有问题，只要您只添加一些尚未涵盖的新语法元素（如果是，您可能需要`containedin=...`在您的方法中使用）。您可以使用该`:syn list`命令检查实际定义的内容。

# forms - 如果我在 Form_Terminate 而不是 Form_Unload 的控件上调用destroy，表单是否会重新加载？

> ID：15079658
> 
> 赞同：0
> 
> 时间：2013-02-26T01:16:14.847
> 
> 标签：forms, memory-leaks, vb6

当我在 Form_Terminate 事件而不是 Form_Unload 中调用销毁控件时会发生什么，如下所示？
这会导致内存泄漏吗？
如果有，多少钱？是整个表单本身的记忆还是控件的记忆。

```
Private Sub Form_Terminate()
  Set ParentForm = Nothing
  Set ParentFormCtrl = Nothing
End Sub

Private Sub Form_Unload()

End Sub 
```

这里的“ParentForm”是加载上面“Form”的表单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T04:14:20.000

`Form_Terminate`之后执行，`Form_Unload`但`destroy()`不是任何控件的标准 VB6 函数/子，为此，我们无法判断它是否会导致内存泄漏。如果您自己定义了这个函数，那么发布代码将有助于我们更多地了解您的情况。

# android - 多个片段同时访问同一个数据库

> ID：15079661
> 
> 赞同：2
> 
> 时间：2013-02-26T01:16:36.277
> 
> 标签：android, android-fragments, android-contentprovider, android-cursorloader

我的活动中碰巧有多个片段，所有片段都与 CursorLoaders 绑定以从 Content Providers 获取数据。所有片段碰巧查询同一个表，但显示该表中的不同数据集。因此，当我的活动开始时，将在同一个数据库上运行多个 SQL 查询。

不确定查询是否会在内部排队或同时访问会减慢进程，但这是处理这种情况**的有效方法吗？**是否有任何性能影响，或者在单个查询中获取所有数据更好？

请注意，所有查询仅用于 READ 访问。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T06:37:15.810

如果多个片段从同一个表中读取数据，则没有问题。

快乐的编码..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T13:07:04.097

sqlite 甚至可以处理来自不同程序或不同线程的多个同时读取。sqlite 仅在您需要编写时才执行独占锁。

# android - 从 action.view 意图获取 url

> ID：15079662
> 
> 赞同：0
> 
> 时间：2013-02-26T01:16:39.833
> 
> 标签：android, android-intent

我的 android 应用程序在点击时显示以下异常。

```
 android.content.ActivityNotFoundException: No Activity found to handle 
Intent { act=android.intent.action.VIEW dat=www.google.com (has extras) } 
```

谁能告诉我如何从意图中获取数据“www.google.com”？如果我能够获得该数据，**我可以通过打开 web 视图并加载我从意图中获得的 URI 来处理下一个活动。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T01:39:35.790

您的 url 应该以 开头`http//`，如果您设置“www.google.com”，它将无法识别该 url。你的网址应该是这样 `http://www.google.com` 的，希望对你有帮助。

# java - NullPointer 试图导出 Google Doc

> ID：15079663
> 
> 赞同：0
> 
> 时间：2013-02-26T01:16:40.377
> 
> 标签：java, google-drive-api

使用 Google 的 Google Drive SDK (v2-rev57-1.13.2-beta)，我正在尝试导出 Google 的专有格式。我能够下载非专有格式就好了。

要获取文件的路径，[文档](https://developers.google.com/drive/manage-downloads#downloading_google_documents)说要调用：

```
com.google.api.services.drive.model.File.getExportLinks("application/vnd.openxmlformats-officedocument.wordprocessingml.document") 
```

将（例如）Google 文档导出为 MS Word 文档。这样做会产生一个明显有效的 URL。（我也用“text/plain”试过这个，结果相同）。

但是，当我尝试从该路径下载时，Google Drive SDK 会在内部引发 NullPointerException：

```
java.lang.NullPointerException
at com.google.api.client.googleapis.media.MediaHttpDownloader.download(MediaHttpDownloader.java:194)
at com.google.api.client.googleapis.media.MediaHttpDownloader.download(MediaHttpDownloader.java:150)
at com.redacted.mycode.GoogleDocsConnection.download(GoogleDocsConnection.java:182)
... 
```

有其他人遇到这种情况吗？我正在考虑自己修改 Google 的 SDK，但我想看看是否有人已经遇到过这个问题（也许找到了解决方案）。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T21:55:11.367

**更新答案：**

我没有仔细阅读最初的问题，也没有注意到这只发生在 Google 原生格式的文档中。

获得文档的有效导出链接后，您必须构建授权的 GET 请求。执行此操作的代码类似于`files.get`以下代码段中的代码，您只需将下载 url 替换为导出 url：

```
private static InputStream downloadFile(Drive service, String exportUrl) {
  try {
    HttpResponse resp =
        service.getRequestFactory()
            .buildGetRequest(new GenericUrl(exportUrl))
            .execute();
    return resp.getContent();
  } catch (IOException e) {
    // An error occurred.
    e.printStackTrace();
    return null;
  }
} 
```

**旧答案（请忽略）：**

NullPointer 异常可能是由未经授权的初始下载请求引起的。以下代码显示了如何从云端硬盘下载文件：

```
private static InputStream downloadFile(Drive service, File file) {
  if (file.getDownloadUrl() != null && file.getDownloadUrl().length() > 0) {
    try {
      HttpResponse resp =
          service.getRequestFactory()
              .buildGetRequest(new GenericUrl(file.getDownloadUrl()))
              .execute();
      return resp.getContent();
    } catch (IOException e) {
      // An error occurred.
      e.printStackTrace();
      return null;
    }
  } else {
    // The file doesn't have any content stored on Drive.
    return null;
  }
} 
```

只需确保`service`您传递给的实例`downloadFile`已正确授权。

如果您正在使用此代码并且您确定您的服务已正确授权，请显示您的应用发送的 HTTP 请求和相应的响应。

# c# - 如何使用 mongdb 创建基本用户登录/注册

> ID：15079664
> 
> 赞同：0
> 
> 时间：2013-02-26T01:16:45.200
> 
> 标签：c#, asp.net, asp.net-mvc, mongodb

我使用 MVC3 已经有一段时间了，我刚刚开始接触 mongoDB。到目前为止，我一直在使用您在 Visual Studio 中创建基本 Web 应用程序时提供的基本 MembershipProvider 系统。我以前没有建立自己的。我知道这会为您生成架构（dbo.aspnet_Users 和 dbo.aspnet_Membership），但其中很多是无关的。是否有一个教程来获得一个直接从 mongodb 读取的基本登录/注册系统。这甚至是一个好主意吗？还是我会将我的用户保存在单独的 sql 数据库中，而我的所有其他数据都保存在 mongodb 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T03:57:42.063

我会让用户知道你所有的其他数据。如果您有用户集合，我认为示例文档将如下所示：

用户：

```
 {
   "_id" : ObjectId("507f1f77bcf86cd799439011"),
   "username" : "bob123",
   "password" : "ABC122939232DEFEFE",
   "status" : "active", // could be "pending" or whatever
   "email" : "bob@gmail.com"
} 
```

您为用户提供了一个注册屏幕，他们可以在其中创建登录名和密码。您可能会考虑让他们使用他们的电子邮件作为登录名 - 这些天非常标准。

确保*不要*以纯文本形式存储他们的密码。相反，您通过哈希函数运行它并存储该结果（[http://en.wikipedia.org/wiki/Cryptographic_hash_function](http://en.wikipedia.org/wiki/Cryptographic_hash_function)）。当他们登录时，您输入输入的密码并对其进行哈希处理，然后将其与数据库中的值进行比较。总是必须为有人窃取您的数据库的不幸情况做好准备。=(

然后，您还可以使用用户文档中的标志来管理他们的状态。您可以通过向他们发送链接并让他们访问它来让人们确认他们的电子邮件。

只是我过去通过简单登录所做的一些想法。

# javascript - iOS6 WebApp 不会退出

> ID：15079674
> 
> 赞同：1
> 
> 时间：2013-02-26T01:17:48.257
> 
> 标签：javascript, jquery, html, ios6, socket.io

我正在开发一个 HTML5 游戏，主要用于 iOS。它有一个 Node.js 后端并使用多种技术，包括 jQuery、Socket.IO 和 Web Audio API。游戏运行良好。但是，有时设备会锁定（而不是冻结）。我可以正常玩游戏，但是电源键和home键都没有反应，虽然屏幕会变暗，但永远不会完全熄灭。或者，有时当我按下主页按钮时，苹果标志会在屏幕上闪烁。

我无法定期重现错误，因此很难调试。如果我将设备单独放置几分钟，它似乎会更频繁地发生，但有时它很好，有时它不会退出。

我已经尝试追踪这个错误好几个星期了。我已经尝试过互联网搜索，产生了一些可能性，但没有一个修复成功。我不记得我尝试过的所有修复，但有一些如下：

1.  向 io.connect 命令添加 2 秒延迟，以确保页面已完成加载，而不仅仅是“准备就绪”。
2.  禁用“引导访问”（症状与激活引导访问非常相似，我发现的一个错误说它有时会激活）。
3.  用 Date.now() 替换 "+new Date" 的实例

我无法发布该程序的完整源代码，并且不确定哪些特定部分有助于调试它。如果您可以让我知道要共享代码的哪些部分，我可以这样做。

非常感谢任何帮助！

克里斯托弗

# android - hellodropbox 错误

> ID：15079680
> 
> 赞同：-1
> 
> 时间：2013-02-26T01:18:56.663
> 
> 标签：android, mobile, dropbox

我正在尝试开发一个使用 Dropbox API 的 Android 应用程序。

我已经完全按照[Dropbox 教程](https://www.dropbox.com/developers/sync/tutorial/android)中的显示方式完成了，但是当我启动应用程序时，应用程序崩溃并且 Eclipse 中的 LogCat 向我返回了这些错误：

```
02-26 01:08:13.271: E/AndroidRuntime(1210): FATAL EXCEPTION: main
02-26 01:08:13.271: E/AndroidRuntime(1210): java.lang.NoClassDefFoundError: com.dropbox.sync.android.DbxAccountManager
02-26 01:08:13.271: E/AndroidRuntime(1210): at com.dropbox.sample.hellodropbox.HelloDropboxActivity.onCreate(HelloDropboxActivity.java:35)
02-26 01:08:13.271: E/AndroidRuntime(1210): at android.app.Activity.performCreate(Activity.java:4465)
02-26 01:08:13.271: E/AndroidRuntime(1210): at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
02-26 01:08:13.271: E/AndroidRuntime(1210): at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1919)
02-26 01:08:13.271: E/AndroidRuntime(1210): at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1980)
02-26 01:08:13.271: E/AndroidRuntime(1210): at android.app.ActivityThread.access$600(ActivityThread.java:122)
02-26 01:08:13.271: E/AndroidRuntime(1210): at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1146)
02-26 01:08:13.271: E/AndroidRuntime(1210): at android.os.Handler.dispatchMessage(Handler.java:99)
02-26 01:08:13.271: E/AndroidRuntime(1210): at android.os.Looper.loop(Looper.java:137)
02-26 01:08:13.271: E/AndroidRuntime(1210): at android.app.ActivityThread.main(ActivityThread.java:4340)
02-26 01:08:13.271: E/AndroidRuntime(1210): at java.lang.reflect.Method.invokeNative(Native Method)
02-26 01:08:13.271: E/AndroidRuntime(1210): at java.lang.reflect.Method.invoke(Method.java:511)
02-26 01:08:13.271: E/AndroidRuntime(1210): at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
02-26 01:08:13.271: E/AndroidRuntime(1210): at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
02-26 01:08:13.271: E/AndroidRuntime(1210): at dalvik.system.NativeStart.main(Native Method) 
```

关于发生了什么的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T01:40:10.873

确保 jar 正确链接到项目。为此，请将其放在项目根目录下的 libs 文件夹中，然后：

1) 在 Eclipse 中右键单击您的项目 2) 选择*Build Path* > *Configure Build Path* ... 3) 确保选择 Libraries 选项卡并单击*Add JARs...*按钮。4) 导航到项目中的 libs 子文件夹并选择要添加的库。5) 选择*OK*按钮，然后再次选择*OK*，直到您回到主 Eclipse 透视图。该库现在应该正确链接到您的项目。6）最后，对项目进行清理，事情应该正确构建。

# database - 如何将订单与产品匹配？

> ID：15079681
> 
> 赞同：2
> 
> 时间：2013-02-26T01:18:59.240
> 
> 标签：database, vb.net, linq, list, dataset

我有一组订单，每个都有所需的重量，还有一组火鸡，每个都有一个重量，都包含在数据库和数据集中，但通过对象访问（这使得它更复杂，但对象在那里增加项目的复杂性，而不是因为这是一个好主意）。

如何匹配它们，然后更新数据库和数据集？我正在尝试使用列表和 LINQ 来实现，但效果不佳。不幸的是，我看不出哪里出错了。编辑：该行 `For Count = 0 To Max - 1 Orders.UpdateOrder(Count, Count + 1, Orders.OrderDetail(Count, "CustomerID"), TurkeyList(Count)(0), Orders.OrderDetail(Count, "ApproxWeight")) Next`的索引超出范围错误。我知道这意味着什么，但我不明白我为什么会得到它，以及如何解决它。

我已经完成了我的研究——事实上，我目前的尝试使用了列表（在我读到我可以在 StackOverflow 上使用它们之前我从未听说过）但是，tbh，这不是我被教过的东西，而且我可以使用一些指导。我最初尝试使用二维数组，但没有成功。我认为我当前的实现应该可以工作 - 所以我很有可能只是错过了一些愚蠢的东西。以下是我的代码的相关部分。

```
Imports System.Linq
# <summary>
#  SortForm is a public class which handles the events and controls of a single form.
#  </summary>
#  <remarks></remarks>
Public Class SortForm
    Dim Turkeys As New TurkeyDBInteract
    Dim Orders As New OrderDBInteract
    Dim Customers As New CustomerDBInteract
    Public TurkeyList As New List(Of Integer())
    Public OrderList As New List(Of Integer())
    #  <summary>
    #  The FillLists subroutine fills the two lists with data from the dataset.
    #  </summary>
    #  <remarks></remarks>
    Public Sub FillLists()
        For Count = 0 To Orders.OrderNum - 1
            OrderList.Add(New Integer() {Count, Orders.OrderDetail(Count, "ApproxWeight")})
        Next
        For Count = 0 To Turkeys.TurkeyNum - 1
            TurkeyList.Add(New Integer() {Count, Turkeys.TurkeyDetail(Count, "Weight")})
        Next
    End Sub
    #  <summary>
    #  The SortList subroutine takes a List of 1-dimensional integer and sorts it using LINQ to Objects.
    #  </summary>
    #  <param name="List"></param>
    #  <remarks></remarks>
    Public Sub SortList(ByRef List As List(Of Integer()))
        Dim SortedList As New List(Of Integer())
        SortedList = List.OrderBy(Function(Weight) Weight(1)).ToList()
        List = SortedList
    End Sub
    #  <summary>
    #  This is the SortButton click event. This calls the <see cref="FillLists"/> and <see cref="SortList"/> subroutines to process order and turkey data, then matches the lists and uses this to update the dataset and database.
    #  </summary>
    #  <param name="sender"></param>
    #  <param name="e"></param>
    #  <remarks></remarks>
    Private Sub SortButton_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles SortButton.Click
        FillLists()
        SortList(TurkeyList)
        SortList(OrderList)
        Dim Max As Integer
        If TurkeyList.Count > OrderList.Count Then
            Max = OrderList.Count
        Else
            Max = TurkeyList.Count
        End If
        For Count = 0 To Max - 1
            Orders.UpdateOrder(Count, Count + 1, Orders.OrderDetail(Count, "CustomerID"), TurkeyList(Count)(0), Orders.OrderDetail(Count, "ApproxWeight"))
        Next
   End Sub
End Class 
```

这是 OrderDBInteract 类中 OrderUpdate 方法的代码

```
 # <summary>
    # Subroutine UpdateOrder updates every value of a specific record of the OrderTbl dataset table and then updates the database.
    # </summary>
    # <param name="Row">Row passes the row of the record to be updated.</param>
    # <param name="OrderID">OrderID passes the new primary key value of the record to be updated.</param>
    # <param name="CustomerID">CustomerID passes the new foreign key field value of the record to be updated.</param>
    # <param name="ApproxWeight">ApproxWeight passes a new field value of the record to be updated.</param>
    # <remarks></remarks>
    Public Sub UpdateOrder(ByVal Row, ByVal OrderID, ByVal CustomerID, ByVal TurkeyID, ByVal ApproxWeight)
        Data.Tables("OrderTbl").Rows(Row).Item("OrderID") = OrderID
        Data.Tables("OrderTbl").Rows(Row).Item("CustomerID") = CustomerID
        Data.Tables("OrderTbl").Rows(Row).Item("TurkeyID") = TurkeyID
        Data.Tables("OrderTbl").Rows(Row).Item("ApproxWeight") = ApproxWeight
    End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T00:55:38.690

尝试根据键对值进行排序的[sortedlist 。](http://msdn.microsoft.com/en-us/library/system.collections.sortedlist.aspx)例如：

```
Dim OrderList As New SortedList
    For Count = 0 To Orders.OrderNum - 1
        OrderList.Add(Orders.OrderDetail(Count, "ApproxWeight"), Count)
    Next 
```

将根据 Orders.OrderDetail 的结果对值（计数）进行排序。这样您就不需要调用 SortList 方法。

虽然，这

```
Data.Tables("OrderTbl").Rows(Row).Item("OrderID") = OrderID 
```

确实更改了数据集表中行的 OrderID 列值，这些更改不会提交到数据库。看看这个 关于将数据保存到数据库的[msdn 演练。](http://msdn.microsoft.com/en-us/library/xzb1zw3x%28v=vs.80%29.aspx?cs-save-lang=1&cs-lang=vb#code-snippet-1)基本上，您需要一个具有适当 UpdateCommand 设置的 DataAdapter 来使用数据集的更改来更新数据库表。如果您在程序中使用类型化的数据集，那么将更改提交到数据库就变得更容易了。

# mysql - 如何在 MySQL 中编写 If 语句？

> ID：15079687
> 
> 赞同：-2
> 
> 时间：2013-02-26T01:19:42.127
> 
> 标签：mysql

我想要与此等效的 MySQL：

```
If ( (SELECT COUNT(*) FROM TestTable) > 5) Then
   SELECT * FROM TestTable
ELSE
   SELECT * FROM OtherTable
END IF 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T01:25:45.497

抱歉，如果在 mysql 中有两个，我会立即出错一个 :) 这是正确的一个

[http://dev.mysql.com/doc/refman/5.0/en/control-flow-functions.html#function_if](http://dev.mysql.com/doc/refman/5.0/en/control-flow-functions.html#function_if)

选择如果（1>2,2,3）；将给出 3 作为答案，因此

SELECT IF((SELECT COUNT(*) FROM TestTable) > 5, SELECT * FROM TestTable, SELECT * FROM OtherTable);

应该做的伎俩...

我之前发布的链接，因为您已将其评论为您所需要的：D

[http://dev.mysql.com/doc/refman/5.0/en/if.html](http://dev.mysql.com/doc/refman/5.0/en/if.html)

# objective-c - 测量单位的 BNF 语法

> ID：15079691
> 
> 赞同：1
> 
> 时间：2013-02-26T01:20:41.363
> 
> 标签：objective-c, grammar, units-of-measurement, bnf, parsekit

我正在使用[ParseKit](https://github.com/itod/parsekit)来解析度量单位。为了做到这一点，我必须提供一个语法。我尝试使用谷歌搜索，但这并没有让我走得太远。虽然这对我自己来说是一个有趣的练习，但我想确保我做对了。ParseKit 期待这样的 BNF 语法：

```
@start  = number units;
units = unit+ | unit+ / unit+;
unit = prefix baseUnit | baseUnit;
prefix = '' | 'milli' | 'micro' | 'pico';
baseUnit = 'm' | 'meter' | 'g' | 'gram' 
```

我希望支持输入，例如：

```
25 m²
25 m^-3
25 m**-5/kg**-2
25 m/s squared
25 mm² per second
25 m/s
5 kg meters per second squared
3 m-kg/s^2
3 m kilograms 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T04:08:47.867

我在 unidata.ucar.edu 上找到的[这个语法看起来很正式，虽然笨拙，并且不包含前缀或单位。](http://www.unidata.ucar.edu/software/udunits/udunits-2/udunits2lib.html#Grammar)

Unit-Spec：一无所有的 Shift-Spec

```
 Shift-Spec: one of
         Product-Spec
         Product-Spec SHIFT REAL
         Product-Spec SHIFT INT
         Product-Spec SHIFT Timestamp

 Product-Spec: one of
         Power-Spec
         Product-Spec Power-Spec
         Product-Spec MULTIPLY Power-Spec
         Product-Spec DIVIDE Power-Spec

 Power-Spec: one of
         Basic-Spec
         Basic-Spec INT
         Basic-Spec EXPONENT
         Basic-Spec RAISE INT

 Basic-Spec: one of
         ID
         "(" Shift-Spec ")"
         LOGREF Product_Spec ")"
         Number

 Number: one of
         INT
         REAL

 Timestamp: one of
         DATE
         DATE CLOCK
         DATE CLOCK CLOCK
         DATE CLOCK INT
         DATE CLOCK ID
         TIMESTAMP
         TIMESTAMP INT
         TIMESTAMP ID

 SHIFT:
         <space>* <shift_op> <space>*

 <shift_op>: one of
         "@"
         "after"
         "from"
         "since"
         "ref"

 REAL:
         the usual floating-point format

 INT:
         the usual integer format

 MULTIPLY: one of
         "-"
         "."
         "*"
         <space>+
         <centered middot>

 DIVIDE:
         <space>* <divide_op> <space>*

 <divide_op>: one of
         per
         PER
         "/"

 EXPONENT:
         ISO-8859-9 or UTF-8 encoded exponent characters

 RAISE: one of
         "^"
         "**"

 ID: one of
         <id>
         "%"
         "'"
         "\""
         degree sign
         greek mu character

 <id>:
         <alpha> <alphanum>*

 <alpha>:
         [A-Za-z_]
         ISO-8859-1 alphabetic characters
         non-breaking space

 <alphanum>: one of
         <alpha>
         <digit>

 <digit>:
         [0-9]

 LOGREF:
         <log> <space>* <logref>

 <log>: one of
         "log"
         "lg"
         "ln"
         "lb"

 <logref>:
         "(" <space>* <re> ":"? <space>*

 DATE:
         <year> "-" <month> ("-" <day>)?

 <year>:
         [+-]?[0-9]{1,4}

 <month>:
         "0"?[1-9]|1[0-2]

 <day>:
         "0"?[1-9]|[1-2][0-9]|"30"|"31"

 CLOCK:
         <hour> ":" <minute> (":" <second>)?

 TIMSTAMP:
         <year> (<month> <day>?)? "T" <hour> (<minute> <second>?)?

 <hour>:
         [+-]?[0-1]?[0-9]|2[0-3]

 <minute>:
         [0-5]?[0-9]

 <second>:
         (<minute>|60) (\.[0-9]*)? 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T22:49:42.207

[ParseKit](http://parsekit.com)的开发者在这里。

我没有仔细查看您的示例输入以确定您的语法在语义上是否正确。

但是，我*确实*看到您现有语法的两个重要句法问题。

* * *

首先，此行包含 Left Recursion （以及未引用的语法错误`/`）：

```
units = unit+ | unit+ / unit+;  // Incorrect. Will not work. 
```

您必须更改此行以将左递归删除为以下内容：

```
units = unit ('/' unit)*; 
```

[有关在 ParseKit 语法中消除左递归的更多信息，](https://stackoverflow.com/a/14597848/34934)请参阅我之前的答案。

* * *

其次，我相信这条线试图通过使用来允许“空”匹配`''`：

```
prefix = '' | 'milli' | 'micro' | 'pico';   // Incorrect. Will not work. 
```

ParseKit 语法中不支持这种语法。完全支持此功能，但语法`Empty`如下：

```
prefix = Empty | 'milli' | 'micro' | 'pico'; 
```

希望有帮助。

# javascript - 使用 javascript 隐藏然后禁用 div

> ID：15079693
> 
> 赞同：0
> 
> 时间：2013-02-26T01:20:46.840
> 
> 标签：javascript, jquery, animation, hide, opacity

我想隐藏 div 将其不透明度更改为 0*动画*，并在禁用它时将显示属性更改为*'none'*。这两个功能都应该通过 onclick 或至少一个单一的操作来启动，因此 div 变得不可见（如淡出）然后消失。

* * *

我正在使用此代码执行动画：

```
function animateStyle(divID) {
    $("#" + divID).css({ "opacity": "1" }).animate({ "opacity": "0" }, 900);
};

<span onclick="return animateStyle('alert-background');" 
class="close">&#10008;</span> 
```

我尝试使用*.hide*禁用 div，但不能让两者一起工作——如果动画有效，那么 div 不会消失，只会保持不可见。如果 div 消失了，那么动画就不起作用了。这个想法可能有更好的解决方案吗？

* * *

**更新：** 我已经找到了做我想做的事情的方法，但这更像是一个技巧而不是解决方案：

```
function animateStyle(divID) {
    $("#" + divID).css({ "opacity": "1" })
                  .animate({ "opacity": "0" }, 900)
                  .delay(1100)
                  .css({ "margin-top": "0" })
                  .animate({ "margin-top": "-100000px" }, 1);
}; 
```

但是，尽管这可以正常工作，但我想完全删除 div 而不是将其移到屏幕外。希望有办法解决...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T01:22:40.843

您可以使用`fadeOut`：

```
$("#" + divID).fadeOut(900); 
```

它应该是以下内容的简写，更接近您已有的内容：

```
$("#" + divID).css({ "opacity": "1" }).animate({ "opacity": "0" }, {
    duration: 900,
    complete: function() { $(this).hide(); }
}); 
```

# ruby-on-rails - 我们什么时候需要创建一个新的控制器？

> ID：15079697
> 
> 赞同：-1
> 
> 时间：2013-02-26T01:21:17.743
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

目前，对于我的 GET REST 服务，我有一个控制器可以从我需要的六个表中获取 JSON。例如：

```
class MySampleController < ApplicationController

respond_to :json

def show
  @organization = Organization.includes([:ThoseSixTables])
  respond_with(@organization)
end 
```

然后在我的路线中，我会有类似的东西：

```
resources :my_sample, only: [:show] 
```

因此，当客户端在 url 中调用我的服务时，`/my_sample/1.json` 它会将 JSON 返回给它。

我正在为其编写这些服务的网页上有几个导航链接，比如选项卡，所以现在如果他们点击副总裁链接，我们应该调用一个新的 GET REST 服务并向他们返回一组全新的数据.

那么我需要为它创建一个新的控制器吗？或者我可以使用相同的控制器并在路由中添加嵌套资源？例如，能够从类似的 URI 中获取新的 JSON`/my_sample/1/vpview`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T02:22:06.317

设计自己喜欢的 url 并查看任何可以组合在一起的模式完全取决于您（就像很多人的个人资料页面将具有相同的结构 json 文件）。

对我来说，我猜你的应用程序只显示一个组织，而不是多个。这可能意味着它是一次性页面。我通常只是将这些一次性页面作为方法放在 abouts-controller 中。

您的副总裁页面听起来像是一个人员资源，这意味着您将来可能会为 CEO 等添加另一个页面。因此，拥有一个人员控制器感觉很自然。这允许未来的可重用性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T01:33:00.297

这里有一些不错的读物给你。[http://guides.rubyonrails.org/routing.html](http://guides.rubyonrails.org/routing.html)

我会为每个资源制作一个新的控制器。还要小心嵌套你真的不想太深的资源。

# php - 如何在文章中随机显示特定关键字

> ID：15079699
> 
> 赞同：0
> 
> 时间：2013-02-26T01:21:28.190
> 
> 标签：php

我有一个关键字“Keyword1”，我有一篇文章中多次出现“keyword1”。文章中的每个“Keyword1”都是指向不同网站的链接。所以我试图在每次刷新页面时随机显示一个“keyword1”。

到目前为止，我已经尝试过像这样使用 stripos() 。

```
$needle = "keyword1";
$haystack = 'this is an article with [keyword1] appearing seral times with different links. [Keyword1] blahblah [keyword1]' ;

if(stripos($haystack, $needle) !== false){

$links = $haystack;
$links_to_array = explode(" ", $links);
$randomize = array_rand($links_to_array, 1);
echo ($links_to_array[$randomize]);
} 
```

所以当我这样做时......它不会选择一个关键字1，它还会在文章中随机显示一个单词。您可以复制代码并通过刷新页面自己尝试。

我只希望显示一个随机关键字 1。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T01:35:45.813

我不太确定你要做什么。但是下面的代码可能会有所帮助。我正在使用该函数[`preg_match_all`](http://php.net/manual/de/function.preg-match-all.php)查找关键字 1 的所有出现 - 不区分大小写：`/i`

```
<?php

$needle = "keyword1";
$haystack = 'this is an article with [keyword1] appearing seral times with different links. [Keyword1] blahblah [keyword1]' ;

if(stripos($haystack, $needle) !== false){
    preg_match_all('/\[keyword1\]/i', $haystack, $matches);
    $links_to_array = $matches[0];
    $randomize = array_rand($links_to_array, 1);
    echo ($links_to_array[$randomize]);
} 
```

# hadoop - 与 Cloudera 和 Hortonworks 相比，Hadoop 发行版 MapR 的缺点是什么？

> ID：15079701
> 
> 赞同：6
> 
> 时间：2013-02-26T01:21:39.663
> 
> 标签：hadoop, hdfs, cloudera, mapr

Cloudera 和 Hortonworks 使用 HDFS，这是 Apache Hadoop 的基本概念之一。MapR 使用自己的概念/实现。您直接使用本机文件系统而不是 HDFS。您可以在 MapR 的网站上找到使用这种方法的许多优势。

我想知道这种方法的缺点是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T06:43:29.123

我会稍微不同地定义 MapR。它不使用 HDFS，而是提供自己的带有 NFS 接口的分布式文件系统。其中，与 HDFS 一样，都是基于本地 FS 的。
主要区别在于 HDFS 不是 Posix 和其他设计选择这一事实。
1\. HDFS 不可变，而 MapR 可变。它可以被视为优势，特别是如果您需要它。
2\. HDFS 不可挂载，而 MapR 可挂载。您可以使用与 Linux FS 一起使用的任何现有工具。

与 posix 无关：MapR 具有小块大小且没有单点故障 (NameNode)。MapR 具有多站点复制。

让我们也看看黑暗的一面：a）拥有可变数据（而不是不可变的 HDFS）使系统更加复杂。
b) 不知道（至少对我而言）在大型集群上工作。（我听说大约有数百个节点）。
c）从架构角度（有小块）我不确定如何实现良好的数据局部性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-21T15:10:01.597

在一些公正的来源对 Apache Hadoop 与 MapR 版本进行广泛的基准测试（在不同的工作负载下）之前，我认为我们不能断然地说一个比另一个更快。如果记录将决定您的意见，那么您现在应该知道当前的 terasort 记录由 Yahoo 和 Apache Hadoop 持有。[此处](http://sortbenchmark.org/)和[此处](http://developer.yahoo.com/blogs/ydn/hadoop-yahoo-sets-gray-sort-record-yellow-elephant-092704088.html)的详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-03T04:31:27.620

大卫，分钟排序记录是由 MapR 在 2013 年 1 月 30 日在谷歌云中的谷歌计算引擎上创造的。请参阅我们的博客[http://www.mapr.com/blog/hadoop-minutesort-record](http://www.mapr.com/blog/hadoop-minutesort-record)。该记录是在 2103 个节点的集群上创造的，1.5 TB 的数据在 59 秒内被排序。

另请参阅有关通过 MapR 在 54 秒内对 1 TB 数据进行排序的 Terasort 记录的早期博客。它设置在 Google Cloud 中 Google Compute Engine 上的 1003 节点集群上。该博客发布在[http://www.mapr.com/blog/record-setting-hadoop-in-the-cloud](http://www.mapr.com/blog/record-setting-hadoop-in-the-cloud)。

另请参阅 answers.mapr.com 以获取有关此主题的许多问题/答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-16T22:54:18.367

MapR 和 Hortonworks/Cloudera 之间的主要缺点是 MapRFS（文件系统）和 MapR-DB（NOSQL 数据库）是专有的（不是开源的）。如果 MapR 不再存在，则假定这些产品将停止开发和支持。

由于 Hortonworks、Cloudera 和其他 Hadoop 发行版与开源社区一起使用/支持 HDFS/HBase，因此 HDFS/HBase 不被开发和支持的风险较小。

# java - SMPP GENERIC_nack：消息无效的opensmpp逻辑

> ID：15079704
> 
> 赞同：0
> 
> 时间：2013-02-26T01:21:56.760
> 
> 标签：java, smpp

我已经开发了 smpp 客户端...但是在交付报告方面...它总是自动发送 generic_nack，我使用的是 opensmpp logica，似乎它总是从服务器获取无效 pdu，如何禁用它通用 nack，或者是否有任何其他方法可以从服务器获取 pdu 响应而不自动发送通用 nack，低于 tcp 转储

![tcpdump generic_nack](../Images/a268fe69c75d78a9b57d00980506da1c.png)

谢谢

问候

丹兹

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:03:51.343

您不能禁用此 (ESME_RINVMSGLEN/0x00000001) 或任何通用 nack；发送它的是 SMSC。

您可以尝试创建一个场景，以便 SMCS 不发送 ESME_RINVMSGLEN nack。只有两种可能：

*   假设 SMSC 行为正常，
    *   SMPP 客户端发送错误，而 ESME_RINVMSGLEN 是正确的响应。
    *   您可能想要调查客户端是否在 command_status 字段中设置了正确的值。根据 command_id，可能需要特定的最小字节数。
*   假设 SMSC 行为不正常，
    *   这可能是 SMSC 特定的行为。此时您需要查阅 SMSC 文档。
    *   可能有很多原因。可能是 SMSC 报告 ESME_RINVMSGLEN 以解决它在 PDU 中发现的任何其他问题。

# javascript - jQuery 为什么 :hover 只工作一次？

> ID：15079708
> 
> 赞同：5
> 
> 时间：2013-02-26T01:22:32.313
> 
> 标签：javascript, jquery, css, hover, mouseevent

我一直在使用以下代码段在 Chrome/Safari 和 FF 中确定用户是否将鼠标悬停在锚点上。

```
var isURL = $("a", obj).is(":hover"); 
```

我看过关于 :hover 是 CSS 选择器的各种帖子，但我无法理解的是为什么如果 obj 中有 1 个链接，代码返回*true* ，但如果有 2 个或更多链接，则会引发*javascript 无法识别的表达式悬停*错误.

这是：悬停工作的小提琴：-http: [//jsfiddle.net/2kyaJ/122/](http://jsfiddle.net/2kyaJ/122/)

相同但多个元素（不工作）： - [http://jsfiddle.net/2kyaJ/121/](http://jsfiddle.net/2kyaJ/121/)

谁能给我解释一下？

顺便说一句，我已经看到了...[如何检查鼠标是否在 jQuery 中的元素上？](https://stackoverflow.com/questions/1273566/how-do-i-check-if-the-mouse-is-over-an-element-in-jquery)

4 年过去了，这仍然是确定用户是否悬停在某个元素上的最佳且看似**唯一的方法吗？**如果是的话，任何人都可以提供一个例子吗？

**编辑：**必须去钓鱼以获得我需要的东西，但事实证明这很简单，因为它真的很好用。

我目前在一个带有 jQ​​uery 1.9.1 的插件中使用它，我在父元素（obj）的鼠标悬停时触发动画。希望其他人在将来发现它有用。使用 .length 而不是 .size，因为 .size 从 1.8 版开始已被弃用。

```
 function isMouseOver() {
            if ($('a:hover', obj).length != 0) {
                return true;
            } else {
                return false;
            }                           
        } 
```

用法：

```
var isURL = isMouseOver(); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T01:35:00.067

`:hover`在[http://api.jquery.com/](http://api.jquery.com/)上没有记录——因此我不相信它以任何特定的方式工作。问题似乎是当集合中有多个元素要迭代时，Sizzle 被这个伪选择器弄糊涂了，尽管我不能通过查看代码来真正分辨乳清。

它甚至在你的第一个例子中工作的事实似乎是一个错误：http: [//jsfiddle.net/2kyaJ/122/——](http://jsfiddle.net/2kyaJ/122/)它不适用于 jQuery 1.9

至于如何判断一个元素是否悬停——我不确定你需要在什么情况下这样做。相反，最好在触发悬停时采取行动。`mouseover`您可以使用和绑定到“类似悬停”的事件`mouseenter`。当然，还有 CSS 伪选择器`:hover`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-26T01:31:18.337

试试这个小提琴[http://jsfiddle.net/2rU4U/](http://jsfiddle.net/2rU4U/)：

```
setInterval(function(){
    var $sample = $(".sample");

    $sample.each(function(index) {
        if($(this).is(":hover")) {
           $(this).css("background", "yellow");
        }
        else {
           $(this).css("background", "");
        }
    });  
}, 200); 
```

正如上面评论中提到的，这尊重了一个元素集合可能被返回的事实，而不仅仅是一个元素。当然，有很多元素可能会导致相当多的开销......！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T18:54:09.650

至于*为什么*它不能按你的方式工作，我想说它可能是一个错误，也可能是它没有记录。我真的不知道。

但是，这里有一个适用于 jQuery 1.7.1、1.9 和 2.0.0b1 的示例：http: [//jsfiddle.net/2kyaJ/125/](http://jsfiddle.net/2kyaJ/125/)

基本上，`.is()`您可以查询所有悬停的元素，然后检查是否至少有一个匹配项（`$(".sample:hover").length`而不是`$(".sample").is(":hover")`），而不是使用。

我得到的印象是，当其中任何一个元素悬停时，您想要突出显示所有`.sample`元素，因此是第一个 jsfiddle。但是，如果您只想突出显示悬停的元素，您可以尝试这样的操作：http: [//jsfiddle.net/2kyaJ/126/](http://jsfiddle.net/2kyaJ/126/)

此外，如果您只是想将某些内容绑定到悬停事件，而不是每 0.2 秒或多或少检查一次，您可以使用以下[`.hover()`](http://api.jquery.com/hover/)功能：http: [//jsfiddle.net/2kyaJ/127/](http://jsfiddle.net/2kyaJ/127/)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-02-26T03:08:46.157

老实说，设置间隔是一个糟糕的主意......

只需设置一个悬停侦听器。

```
$('.sample').hover(function() {
    console.log($this) // $(this) is the currently hovered element
}) 
```

JSFiddle：http: [//jsfiddle.net/jeffshaver/2kyaJ/124/](http://jsfiddle.net/jeffshaver/2kyaJ/124/)

# visual-studio-2010 - “按钮”类型上不存在属性“命令”

> ID：15079712
> 
> 赞同：0
> 
> 时间：2013-02-26T01:22:53.900
> 
> 标签：visual-studio-2010, silverlight, mvvm, mvvm-light

[错误 1 ​​XML 命名空间“ http://schemas.microsoft.com/winfx/2006/xaml/presentation](http://schemas.microsoft.com/winfx/2006/xaml/presentation) ”中的“按钮”类型上不存在属性“命令” 。C:\Users\Admin\documents\visual studio 2010\Projects\MvvmLight2\Sample\MainPage.xaml 33 21 示例

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T01:29:40.663

您需要`Command`在 XAML 中大写：

```
<Button Command="{Binding SomeCommand}"> 
```

# encryption - 访问实现加密和解密的应用程序是否更容易破解？

> ID：15079714
> 
> 赞同：2
> 
> 时间：2013-02-26T01:23:12.027
> 
> 标签：encryption, hash, aes, sha, cracking

假设我有一个应用程序来读取和写入受哈希保护的文件（以检测篡改和损坏），并且可以选择使用用户密钥进行加密。应用程序必须包含编译后的代码来散列、加密和解密数据。

假设我们使用的是严格的算法，例如加盐和拉伸的 AES-256 和 SHA-256，那么用户拥有已编译形式的应用程序（并且通过一些努力可能会计算出正在使用的算法），这对他们来说更容易破解加密，或生成假哈希？

如果这实际上是一个严重的漏洞，那么有人会建议采取什么措施来减轻漏洞？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T01:36:51.990

应用程序源存在漏洞的唯一情况是应用程序本身存在严重缺陷，例如

*   [*通过隐蔽*](http://en.wikipedia.org/wiki/Security_through_obscurity)技术使用安全性，
*   在程序主体中嵌入一个秘密，
*   在实现一个众所周知的算法时犯了一个错误，该算法使该实现容易受到攻击。

从本质上讲，当攻击者知道其来源时，您的产品会变得更容易受到攻击，因为攻击者可以更容易地发现您的编码错误。但是，使您的应用程序可破解的是编码错误，而不是攻击者拥有您的源代码这一事实。

# java - 如何通过谷歌电子表格 API（gdata）从谷歌电子表格中仅获取重新计算的单元格

> ID：15079715
> 
> 赞同：1
> 
> 时间：2013-02-26T01:23:12.807
> 
> 标签：java, gdata, google-spreadsheet-api

Gdata 提供了一种方法，可以根据时间戳从 google 电子表格中仅获取更改的单元格。我应该如何为 Gdata 调用创建时间戳？

即“仅返回发布时间等于或晚于指定时间戳的条目。” setPublishedMax() [https://developers.google.com/gdata/javadoc/com/google/gdata/client/Query#setPublishedMax(com.google.gdata.data.DateTime)](https://developers.google.com/gdata/javadoc/com/google/gdata/client/Query#setPublishedMax(com.google.gdata.data.DateTime))

有没有办法从服务器中提取当前时间？如果我创建本地时间戳，如何同步它，什么时区？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T04:39:52.100

不可能，它会产生：

com.google.gdata.util.ServiceForbiddenException: OK 此服务不支持更新的分钟

问题在这里：[https ://code.google.com/a/google.com/p/apps-api-issues/issues/detail?id=1388](https://code.google.com/a/google.com/p/apps-api-issues/issues/detail?id=1388)

# javascript - 在 Windows 8 媒体控件中显示专辑封面

> ID：15079727
> 
> 赞同：0
> 
> 时间：2013-02-26T01:24:28.203
> 
> 标签：javascript, windows-8, uri, media

我正在尝试在 JS 中为 Windows 8 媒体控件添加专辑封面

我有以下代码不起作用：

```
Windows.Media.MediaControl.albumArt = "http://www.someimagesite.com/image1.jpg"; 
```

我知道 MediaControl.albumArt 不支持字符串，而是支持 URI，但我对 JS 和 URI 缺乏经验，想知道是否有人知道我是否可以轻松地将 URI 从 url 字符串输入到 about 情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T01:33:46.040

您可以使用[Windows.Foundation.Uri 类](http://msdn.microsoft.com/en-us/library/windows/apps/windows.foundation.uri.aspx)。例如 ...

```
var uri = new Windows.Foundation.Uri("ms-appdata:///mycontent/" + fileName); 
mediaControls.albumArt = uri; 
```

看看[这个样本](http://code.msdn.microsoft.com/windowsapps/Media-Buttons-ea57d8e2)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T01:36:30.907

[直接从马嘴里说](http://msdn.microsoft.com/en-us/library/windows/apps/windows.media.mediacontrol.albumart)：

> 如果您为专辑封面属性提供了无效路径，则会引发异常。唯一有效的 URI 格式是 ms-appx:// 和 ms-appdata://。

本质上，您不能指向位于网络上的图像。您应该将专辑封面作为应用程序包的一部分提供，或者您应该从网络加载图像，将其保存到应用程序的本地存储中，然后将专辑封面分配给类似的东西`ms-appdata://mylocalimage.jpg`

# utc - 值的数据格式不正确 - UTCDate

> ID：15079732
> 
> 赞同：0
> 
> 时间：2013-02-26T01:24:57.920
> 
> 标签：utc, quickfix

使用 Fix 4.2，我收到如下消息：

```
8=FIX.4.29=15135=W49=aSERVER56=myNAME34=84823052=20130226-00:43:05.53755=USD/JPY268=1269=2270=92.699271=0272=20130226273=19:43:04274=210=251 
```

但我的 QuickFix 实现抛出此错误：

```
8=FIX.4.29=13935=334=949=myNAME52=20130226-00:43:05.66556=aSERVER45=84823058=Incorrect data format for value371=272372=W373=610=225 
```

表示标签 272 的格式不正确。

标签 272 在数据字典中定义如下：

```
<field number="272" name="MDEntryDate" type="UTCDATE"/> 
```

所以看起来格式对我来说是正确的。“20130226”。

有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T02:46:07.383

看来这是一个已知的错误，将在 QuickFix/N 的下一个版本中发布（很可能是 2013 年 3 月）：

[https://github.com/connamara/quickfixn/issues/135#issuecomment-14089433](https://github.com/connamara/quickfixn/issues/135#issuecomment-14089433)

# c# - 构造函数部分是什么意思？

> ID：15079733
> 
> 赞同：0
> 
> 时间：2013-02-26T01:24:57.983
> 
> 标签：c#, .net, c#-4.0, c#-3.0

有人可以解释一下这段代码的作用吗？

```
Kartenstapel stapel1 = new Kartenstapel(new Karte[] { }); 
```

*Kartenstapel 和 Karte 是类。

我只有一个猜测，但不确定。它是一个创建的空对象吗？

谢谢你的笔记。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T01:26:27.667

这意味着`Karte`创建一个空数组并将其作为参数提供给`Kartenstapel`构造函数，而构造函数又会创建一个`Kartenstapel`对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T01:26:50.130

您正在创建一个 KartenStapel 对象，传入一个包含零元素的 Kartes 数组。

# variables - bash 检查值是整数并且在范围内

> ID：15079738
> 
> 赞同：3
> 
> 时间：2013-02-26T01:25:52.193
> 
> 标签：variables, integer, busybox

我读了这个stackoverflow问题......

[Bash：检查用户输入是否正确](https://stackoverflow.com/questions/848342/bash-check-user-input-is-correct)

它完成了我想要的大部分操作，而不是检查它只是一个整数，我需要检查它是一个变量范围内的整数....

该脚本在目录中查找文件，然后为它们分配一个编号...

1.  文件 1
2.  文件 2
3.  文件 3 等....

用户选择数字，然后脚本对该文件执行命令......变量 $FILELIST 是文件的总数。

以我之前尝试过的stackoverflow为例......

```
FILENUM=""
while [[ ! ($FILENUM =~ ^[0-$FILELIST]+$) ]]; do
    echo " "
    echo "Please enter the file number: "
    read -p "1 - $FILELIST" FILENUM < /dev/tty
done

echo "$FILENUM" 
```

但是，这会引发语法错误：while 行中出现意外的“（”（期望“do”），我不确定为什么，我怀疑 $FILELIST 必须以某种方式括起来，但解释为什么上述工作会有所帮助我明白这个问题。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T02:28:53.450

特定于 bash 的答案：

您不需要重新发明轮子：使用`select`内置：

```
cd /path/to/directory
PS3="Select a file: "
select file in *; do
    if [[ $file ]]; then break; fi
done
echo "You selected '$file'"
echo "You selected file number $REPLY" 
```

要检查一个数字是否在一定范围内，我会写：

```
if (( 0 <= $number && $number <= $max )); then echo "in range"; fi 
```

* * *

由于您使用的是 ash，您可以将其用作参考：[http ://manpages.debian.net/cgi-bin/man.cgi?query=dash](http://manpages.debian.net/cgi-bin/man.cgi?query=dash)

```
while true; do
    FILENUM=""
    echo 
    echo "Please enter the file number: "
    read -p "1 - $FILELIST" FILENUM < /dev/tty
    if expr "$FILENUM" : '[0-9]\+$' &&
       [ $FILENUM -gt 0 ] && 
       [ $FILENUM -le $FILELIST ]
    then
        break
    fi
done
echo "$FILENUM" 
```

# javascript - 将数据传递到 JQuery 然后 HTML（多步骤）

> ID：15079743
> 
> 赞同：0
> 
> 时间：2013-02-26T01:26:42.690
> 
> 标签：javascript, jquery, variables, slidedown

我试图允许调用全局函数并将文本传递到设置在页面顶部的警报框。

我的代码是：

```
<script>
  $(document).ready(function () {
    $('.fadehelper').fadeIn('slow');

    function msg(data, type) {
      $('.warning').slideDown("slow").delay(1500).slideUp("slow");
    }
  });
</script> 
```

消息框是：

```
<div class="warning">Help me!</div> 
```

我真的不知道该怎么做..

我想传递一个类型和一个消息。类将是类型，消息将在“警告”所在的位置进行。

所以如果我在页面的某个地方去 msg(warning, "help me!"); 我希望像上面那样翻译。

你能帮我吗？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T01:47:33.977

```
function msg(type, data){
   var box=document.getElementById('alertbox');
    box.setAttribute('class',type);
    box.innerHTML=data;
    $('#alertbox').slideDown("slow").delay(1500).slideUp("slow");
} 
```

知道了！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T01:35:49.853

首先，在 div 上放一个 id 属性，以便于查找。我将假设您在以下函数中使用 alertbox 作为 id

将以下内容添加到 msg 函数的末尾：

```
var box=document.getElementById('alertbox');
box.setAttribute('class',type);
box.innerHTML=data; 
```

它可能在 jquery 中可以做得更短，但我不使用 jquery

# opencv - 使用 Mat 类型的条件表达式

> ID：15079748
> 
> 赞同：0
> 
> 时间：2013-02-26T01:27:07.370
> 
> 标签：opencv

以前，我使用 C API，现在我正在迁移到 C++ API opencv。下面是一些没有经过的事情。它表示 Mat 中的条件表达式存在某种错误。使用 C API 一切似乎都很好。

```
/// Initialize (C API)
vector<IplImage*> storeImg;

storeImg.pushback(...);

if( storeImg.at(i) == storeImg.at(0) )//no error

/// Initialize (C++ API)
vector<Mat> storeImg;

storeImg.pushback(...);

/// To use it
if( storeImg.at(i) == storeImg.at(0) )//error: conditional expression is illegal 
```

有没有其他解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T04:38:12.663

您需要像这样访问 storeImg 的索引

```
storeImg[i] 
```

如果您希望随后访问存储在索引中的 Mat 元素，您可以调用

```
storeImg[i].at<float>(j) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T08:33:33.030

我不确定这一点，但只是经过测试，顺便说一下它可以工作和验证。

```
if(storeImg[i].data == storeImg[0].data) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T10:47:54.950

请澄清，你打算什么样的比较。

如果你有`vector<IplImage*> storeImg`,`( storeImg[0]==storeImg[7] )`将只比较 POINTERS。

因为`vector<Mat> storeImg`相同的表达式会尝试比较整个结构，这实际上是非法的。

你想检查一下，内容（像素）是否相等？

那将是：`sum( storeImg[0] - storeImg[7] ) == 0`

如果您仍想比较指针，`( storeImg[0].data == storeImg[7].data )`则可能适用于 cv:Mat 情况，但如果您在那里有其他垫子的 clone()，它将失败

# gwt - 如何使 GWT 与 CORS 和 cookie 一起工作

> ID：15079750
> 
> 赞同：0
> 
> 时间：2013-02-26T01:27:22.970
> 
> 标签：gwt, cookies, csrf, cors

我分离了 GWT - 静态代码在 CDN 上，而动态代码在不同的服务器上。我在 Tomcat7 上配置了这个 CORS 过滤器，它工作正常：

[http://software.dzhuvinov.com/cors-filter-installation.html](http://software.dzhuvinov.com/cors-filter-installation.html)

但是，我仍在努力让 Cookie 与 GWT 和 CORS 一起使用。

我主要需要它来保护 XSRF（以及其他一些东西）：

[https://developers.google.com/web-toolkit/doc/latest/DevGuideSecurityRpcXsrf](https://developers.google.com/web-toolkit/doc/latest/DevGuideSecurityRpcXsrf)

看起来我必须在 XMLHttpRequest 中设置 withcredentials=true。

有谁知道如何在 GWT 中做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T07:10:12.160

默认情况下，Cookie 不与 CORS 一起发送。如果需要它们，则必须将属性设置为GWT 使用`withCredentials`的低级别。`XMLHttpRequest`不幸的是，无法从您的 java 代码中设置它。

`XMLHttpRequest.java`一个简单的技巧是您在源代码树中维护自己的版本（使用相同的命名空间），并`create()`以这种方式修改方法：

```
private static native XMLHttpRequest create(String responseType) /*-{
  [...]
  xhr.withCredentials = true;
  return xhr;
}-*/; 
```

注意：从服务器端您也必须发送此标头：

```
Access-Control-Allow-Credentials: true 
```

否则，在 GWT 中处理身份验证的常规方法是使用带有身份验证信息的特殊标头并在服务器端读取它。

```
builder.setHeader("X-My-Authenticated-Header", "whatever"); 
```

编辑：正如 t.broyer 在下面的评论中指出的那样，`RequestBuilder.setIncludeCredentials`2.5.1-rc1 中有一个方法。因此，如果您使用此版本，请在创建构建器时调用此方法。

# c - 冒泡排序 C - 链表

> ID：15079751
> 
> 赞同：1
> 
> 时间：2013-02-26T01:27:25.123
> 
> 标签：c, bubble-sort

所以这是我的小冒泡排序功能遇到的问题。我可以对值进行排序，但是我总是在 3 个节点之后得到一个截止值。一个例子是：

对以下内容进行排序：

3 2 54 5 4

我总是得到（从最小的头部）：

2 3 4

仅此而已，仅此而已。

```
 void sortByLine (struct lnode** head) {
      int count = 1;
  while(count){
      struct lnode *temp =*head;
    count = 0;
    while(temp != NULL){
        struct lnode *next = nodeGetNext(temp);
        if(next != NULL){           
           if((lineCmp(temp,next)) > 0 ){
            swap(head, next,temp);
            count = 1;
           }
        }
        temp = nodeGetNext(temp);
    }
} 
```

}

线路 Cmp 功能：

```
int lineCmp (struct lnode* n1, struct lnode* n2) {
  int node1 = nodeGetLine(n1);
  int node2 = nodeGetLine(n2);

  if(node1 == node2){
      return 0;
  }
  else if(node1 > node2){
      return 1;
  }
  else
      return -1; 
```

}

交换功能：

```
 void swap (struct lnode** head, struct lnode* n1, struct lnode* n2) {
    struct lnode *prevn1 = nodeGetPrev(*head, n1);   
    struct lnode *prevn2 = nodeGetPrev(*head, n2);

  struct lnode *nextn1 = nodeGetNext(n1);
  struct lnode *nextn2 = nodeGetNext(n2);   

  if(prevn2 == n1 && prevn1 == NULL){
      evictNode(head, n2);
      pushNode(head, n2);
  }
  else if(prevn1 == n2 && prevn2 == NULL){
      evictNode(head, n1);
      pushNode(head, n1);
  }
  else if(prevn1 == n2 && nextn1 == NULL){
      evictNode(head, n1);
      insertNode(head, prevn2 , n1);   
  }
  else if(prevn2 == n1 && nextn2 == NULL){
      evictNode(head, n2);
      insertNode(head, prevn1, n2);
  }   
  else{
  evictNode(head, n1);
  evictNode(head, n2);   
  insertNode(head, prevn2 , n1);   
  insertNode(head, prevn1 , n2);
  } 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T10:34:54.543

您的问题出在交换函数中：删除节点会使之前计算的节点无效

```
 void swap (struct lnode** head, struct lnode* n1, struct lnode* n2) {
    struct lnode *prevn1 = nodeGetPrev(*head, n1);   
    struct lnode *prevn2 = nodeGetPrev(*head, n2);

  struct lnode *nextn1 = nodeGetNext(n1);
  struct lnode *nextn2 = nodeGetNext(n2);   

  if(prevn2 == n1 && prevn1 == NULL){
      evictNode(head, n2);
      pushNode(head, n2);
  }
  else if(prevn1 == n2 && prevn2 == NULL){
      evictNode(head, n1);
      pushNode(head, n1);
  }
  else if(prevn1 == n2 && nextn1 == NULL){
      evictNode(head, n1);
      insertNode(head, prevn2 , n1);   
  }
  else if(prevn2 == n1 && nextn2 == NULL){
      evictNode(head, n2);
      insertNode(head, prevn1, n2);
  }   
  else if (n1==prevn2)
  {
       evictNode (head, n1);
       insertNode(head, n2, n1);  
  }
  else if (n2==prevn1)
   {
       evictNode (head, n2);
       insertNode(head, n1, n2);  
   } 
  else {
   evictNode(head, n1);
   evictNode(head, n2);   
   insertNode(head, prevn1, n2);
   insertNode(head, prevn2, n1);
  }
} 
```

# multilingual - 多区域网站

> ID：15079753
> 
> 赞同：0
> 
> 时间：2013-02-26T01:27:42.240
> 
> 标签：multilingual, subdomain

我想做一个多区域网站，但我遇到了一些困难。我使用 cPanel 并将域布局为：

*   ca.example.com
*   usa.example.com
*   fr.example.com

我想知道如何添加子域，并能够使用我的一个自定义 php 脚本通过 .htaccess 或任何形式运行这些网站。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T01:34:15.347

您应该使用 cPanel 的**停放域**功能。当您在 cPanel 中停放一个域时，您可以将其指向与您的主域相同的根。在 cPanel 的 Parked Domains 界面中，添加您的语言子域（例如`ca.example.com`）。然后，您的所有语言子域将重定向到同一个主域 ( `example.com`)。

然后，您可以使用 PHP 的`$_SERVER['SERVER_NAME']`属性解析出用户用于访问页面的服务器名称，进而以正确的语言呈现页面。

# ios - IOS Map Kit Annotation标注到tableview

> ID：15079755
> 
> 赞同：0
> 
> 时间：2013-02-26T01:28:01.690
> 
> 标签：ios, uinavigationcontroller, mapkit, callout

在地图应用程序上工作，当我单击注释标注时，我希望它移动到详细视图控制器并在左上角有后退按钮以返回地图。如果可能的话，它应该就像一个带有表格视图的导航控制器，但是标注按钮代替了单击表格视图单元格，并且带有地图的视图是导航控制器的根。我已经看到它完成了，但根本找不到任何有意义的东西。我唯一可以工作的是模态视图控制器，而不是“推”segue。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T02:03:00.697

您将需要实现标注附件委托方法，然后从那里推送您的新视图控制器。

```
- (void)mapView:(MKMapView *)mapView annotationView:(MKAnnotationView *)view calloutAccessoryControlTapped:(UIControl *)control{
    YourViewController *viewController=[YourViewController initializer];
    [self.navigationController pushViewController:yourViewController animated:YES];
} 
```

# java - Java - 芳香数字 - 输入

> ID：15079757
> 
> 赞同：2
> 
> 时间：2013-02-26T01:28:26.590
> 
> 标签：java, arrays, input

芳香数的形式为 AR，其中每个 A 是阿拉伯数字，每个 R 是罗马数字。

每对 AR 贡献一个如下所述的值，通过将这些值相加或相减，我们得到整个芳香数的值。阿拉伯数字 A 可以是 0、1、2、3、4、5、6、7、8 或 9。罗马数字 R 是七个字母 I、V、X、L、C、D 或 M 之一. 每个罗马数字都有一个基值：

* * *

该程序旨在获取同一行上的 AR 值（例如 3V 输入），并将其相乘。3V 将是 3 x 5 = 15。因为 V 是 5。

**我的问题是我不能接受用户输入的内容并将整数乘以字符串。这使它变得乏味。我尝试将字符串转换为 int 但程序给了我一个*nullformatException*。**

A也将在第一个单元格[0]中，R（数字）在单元格[1]中

```
import java.io.*;
import java.util.*;
import java.text.*;

public class AromaticNumerals
{
    public static int decode (String x)  // since input is direct the program doesnt require validation
    {
        if (x.equals ("I"))
            return 1;
        else if (x.equals ("V"))
            return 5;
        else if (x.equals ("X"))
            return 10;
        else if (x.equals ("L"))
            return 50;
        else if (x.equals ("C"))
            return 100;
        else if (x.equals ("D"))
            return 500;
        else
            return 1000;
    }

    public static void main (String str[])
        throws IOException
    {
        BufferedReader stdin = new BufferedReader (new InputStreamReader (System.in));

        int Output;

        int MAX = 20;
        String[] x = new String [MAX]; // by picking an array we can separate the A-R

        System.out.println ("Please input an aromatic number. (AR)");

        x [0] = (stdin.readLine ());

        int y = Integer.parseInt (x [0]);

        Output = ( y * decode (x [1]));

        System.out.println (Output);

    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T01:35:32.297

```
 int MAX = 20;
    String[] x = new String [MAX]; // by picking an array we can separate the A-R 
```

不正确。您的所有输入都将进入数组的第一个元素`x[0]`. 您将字符串数组与字符数组混淆了。最简单的解决方案是消除`String[]`并使用普通字符，然后使用or`String`提取单个字符。`charAt()``substring()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T01:34:15.413

`stdin.readLine()`将从控制台获取所有字符并将它们存储在找到的字符串中`x[0]`。然后，您尝试从完整字符串中解析一个整数，而不仅仅是第一个字符，这就是您对 parseInt 的调用失败的原因。相反，在第一个字符 via 上调用 parseInt`parseInt(x[0].substring(0,1))`并将字符串的第二个字符传递给 decode 方法 via `decode(x[0].substring(1,2))`。此外，如果您不需要字符串数组，请不要使用一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T01:38:57.993

你是偶然来自C背景的吗？或者任何其他语言，其中字符串是指向字符数组第一个元素的指针？Java 在这方面的工作方式不同，Java 字符串是第一类对象，因此`x [0] = (stdin.readLine ());`将整行读入第一个字符串，因此`int y = Integer.parseInt (x [0]);`将尝试解析 A 和 R。相反，您可能想要`x[0].charAt(0)`x[0].charAt(1)，您也可以不需要 x 是一个数组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T01:40:04.500

**为什么会出现错误：**

当您在此处阅读用户输入时

```
x [0] = (stdin.readLine ()); 
```

...您正在阅读*整个芳香数*，例如 4V 或其他什么，并且您将其放在数组的第一个索引中`x`。然后，

```
int y = Integer.parseInt (x [0]); 
```

在这里，您尝试将*的第一个元素* `x`解析为整数。但是你不只是把芳香数的整数部分放在那里，你把整个东西放在那里。您将在那里获得 NumberFormatException，因为 Integer 类无法解析您与数字一起传递的字母字符。然后，

```
Output = ( y * decode (x [1])); 
```

...您尝试将*第二个元素*传递`x`给 decode 方法，但那里什么也没有，因为您将整个字符串放在 x[0] 中。那是您的 NullFormatException，因为 x[1] 为空。

**要解决这个问题：**

```
String line = stdin.readLine();
int y = Integer.parseInt(line.charAt(0));
int output = y * decode(line.charAt(1)); 
```

管他呢。

# c# - 3d 到 2d 点转换

> ID：15079764
> 
> 赞同：1
> 
> 时间：2013-02-26T01:28:49.803
> 
> 标签：c#, 3d, 2d, point, projection

我正在尝试将 3D 点绘制到 2D 表面上（我目前正在使用 SDL.NET 作为我的“游戏引擎”）。表面大小为 800x400 像素，3d 坐标范围为 -4000 到 4000。我的视图将始终是自上而下的视图，并且不会有任何相机移动。有人可以提供一些本机 c#、伪代码或简单的解释来将 3-D 空间中的坐标转换为 2-D 表面吗？

与此同时，我订购[了这本书](https://rads.stackoverflow.com/amzn/click/com/1556229119)，人们告诉我它会解决我的许多数学缺点……希望 :)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-26T02:35:36.643

注意：这是一堵巨大的文字墙，我完全忽略了很多重要的东西——但我在这里的意图只是一个概述……希望这里的一些术语/概念将引导你更好地在谷歌上搜索适当的块网。

如果您通过“生活作为一个点”走自己的路，它会有所帮助：

这是一个不错的 3 维小点：

```
var happyPoint = new Point(0, 0, 0); 
```

这是它的伙伴，根据他的朋友定义：

```
var friendlyPoint = new Point(1, 0, 0); 
```

现在，让我们将这两个点称为“模型”——我们将使用“模型空间”一词来讨论单个 3 维结构（如房子、怪物等）*内的点。*

然而，模型并不存在于真空中……通常更容易将“模型空间”和“世界空间”分开，以使模型调整更容易（否则，您的所有模型都需要具有相同的比例，具有相同的方向等，等等，再加上尝试在 3D 建模程序中对它们进行处理将是不可能的）

所以我们将为我们的“模型”定义一个“世界变换”（好的，2 点是一个蹩脚的模型，但它仍然是一个模型）。

什么是“世界变换”？简单的说：

*   一个世界的转变`W = T X R X S`，在哪里
*   T =*平移*- 即沿 X、Y 或 Z 轴滑动
*   R =*旋转*- 相对于轴转动模型
*   S =*缩放*- 沿轴调整模型的大小（保留其中的所有相对点）

我们将在这里放轻松，只需将我们的世界变换定义为**单位**矩阵 - 基本上，这意味着我们不希望它平移、旋转或缩放：

```
world = [
          1 0 0 0
          0 1 0 0
          0 0 1 0
          0 0 0 1
        ]; 
```

我强烈建议您复习一下您的矩阵数学，尤其是乘法和向量-> 矩阵运算，它*一直*在 3D 图形中使用。

如此巧妙地跳过了实际的矩阵乘法，我只想告诉你，将我们的“世界变换”和我们的模型点相乘最终会再次得到我们的模型点（尽管在这个有趣的新 4 维向量表示中，我赢了'触摸这里）。

所以我们得到了我们的观点，我们已经将它们完全定位在“空间”中......现在呢？

那么，我们从哪里看呢？这导致了`View Transformations`or的概念`Camera Projection`——基本上，它只是另一个矩阵乘法——观察：

假设我们有一个点 X，在...哦，(4 2) 左右：

```
 |
 |
 |
 |    
 |    X
 |
 ------------------------ 
```

从原点 (0 0) 的角度来看，X*位于*(4 2) - 但是假设我们将相机放在右侧？

```
 |
 |
 |
 |    
 |    X         >-camera
 |
 ------------------------ 
```

X 相对于相机的“位置”是什么？可能更接近 (0 9) 或 (9 0)，具体取决于相机的“向上”和“正确”方向。这就是视图转换 - 将一组 3D 点映射到另一组 3D 点，以便从观察者的角度来看它们是“正确的”。在您使用自上而下的固定相机的情况下，您的观察者将位于天空中的某个固定位置，并且所有模型都会相应地进行转换。

所以让我们画画吧！

不幸的是，我们的屏幕还不是 3D 的，所以首先我们需要将这个点“投影”到 2D 表面上。投影是……嗯，它基本上是一个如下所示的映射：

```
(x, y, z) => (x, y) 
```

可能的投影数量几乎是无限的：例如，我们可以将`X`和`Y`坐标移动`Z`：

```
func(x, y, z) => new point2d(x + z, y + z); 
```

通常，您希望此投影模拟人类视网膜在查看 3D 场景时所做的投影，因此我们引入了**View Projection**的概念。有几种不同的视图投影，例如**Orthographic**、**YawPitchRoll-defined**和**Perspective/FOV-defined**；其中每一个都有一些关键数据，您需要正确构建投影。

例如，基于 Perspective/FOV 的投影需要：

*   你的“眼球”的位置（即屏幕）
*   您的“眼球”能够聚焦多远（“远剪裁平面”）
*   你的视野角（即，伸出你的手臂，就在你的周边视觉的边缘）
*   您正在查看的“镜头”的宽高比（通常是您的屏幕分辨率）

一旦你得到了这些数字，你就可以创建一个叫做“边界平截头体”的东西，它看起来有点像一个顶部被截断的金字塔：

```
\-----------------/
 \               /
  \             /
   \           /
    \         /
     \-------/ 
```

或者从前面：

```
 ___________________
|   _____________   |
|  |             |  |
|  |             |  |
|  |             |  |
|  |             |  |
|  |             |  |
|  |_____________|  |
|___________________| 
```

我不会在这里进行矩阵计算，因为这在其他地方都有很好的定义——事实上，大多数库都有帮助方法，可以为你生成相应的矩阵——但大致是它的工作原理：

假设您的快乐小点在于这个截锥体：

```
\-----------------/
 \               /
  \ o<-pt       /
   \           /
    \         /
     \-------/

 ___________________
|   _____________   |
|  |             |  |
|  |             |  |
|o |             |  |
|^---- pt        |  |
|  |             |  |
|  |_____________|  |
|___________________| 
```

请注意，它偏向一边，以至于它超出了“近剪切平面”矩形 - 如果您“查看”金字塔的较小端会是什么样子？

就像观察棱镜（或镜头）一样，这一点将被“弯曲”到视野中：

```
 ___________________
|   _____________   |
|  |             |  |
|  |             |  |
|>>>o <- pt is   |  |
|  |    shifted  |  |
|  |             |  |
|  |_____________|  |
|___________________| 
```

换句话说，如果你在截锥体**后面**有一盏明亮的灯，你的点的阴影会在哪里“投射”到附近的剪裁场上？（较小的矩形）这就是所有投影 - 一个点到另一个点的映射，在这种情况下，移除 Z 分量并相应地改变 X 和 Y 以对我们的眼睛“有意义”的方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T01:35:31.820

你需要考虑视角。根据您的观点，情节点会有所不同。如果你想要一个正交透视（本质上没有透视），你可以像这样运行它的矩阵变换：

![在此处输入图像描述](../Images/6ee88947d73bd2213af33259097fe5ec.png)

其中**a**代表您的 3D 点，**b**代表您的 2D 点结果。向量**s**是任意比例因子，**c**是任意偏移量

这是另一个与此类似的帖子，答案很好：

> [使用相机将 3D 透视投影基本渲染到 2D 屏幕（无 opengl）](https://stackoverflow.com/questions/8633034/basic-render-3d-perspective-projection-onto-2d-screen-with-camera-without-openg)

这是更多信息

> [http://en.wikipedia.org/wiki/3D_projection](http://en.wikipedia.org/wiki/3D_projection)

# cocoa-touch - 处理后台位置更新和核心数据文件保护

> ID：15079765
> 
> 赞同：10
> 
> 时间：2013-02-26T01:29:13.590
> 
> 标签：cocoa-touch, core-data, cllocationmanager

我一直在尝试使用`CLLocationManager`'s `startMonitoringSignificantLocationChanges`，但在使用 Core Data 时遇到了一些问题。事实证明，从 iOS 5.0 开始，Core Data 默认使用`NSFileProtectionCompleteUntilFirstUserAuthentication`. 这意味着如果设置了密码，则从设备打开到首次输入密码时，持久存储不可用。如果您使用位置更新，您的应用程序可能会在此期间启动，Core Data 会在尝试加载持久存储时出错。

显然切换到`NSFileProtectionNone`将是解决这个问题的最简单方法。不过我不想这样做——我不会在数据库中存储任何超级敏感的东西，但这些位置更新也不是超级关键的。

我知道我可以用它`[[UIApplication sharedApplication] isProtectedDataAvailable]`来检查数据是否已经解锁，并且我可以`applicationProtectedDataWillBecomeUnavailable:`在我的应用程序委托中使用它来在它解锁后做出适当的响应。不过，这对我来说似乎很混乱——我必须添加一堆额外的检查，以确保如果持久存储不可用时不会出现任何问题，一旦它变得可用就重新设置一堆东西，等等。而且这些额外的代码并没有带来太多好处——如果应用程序在这种状态下启动，它仍然无法做任何事情。

所以我想我只是不确定哪种是更“正确”的处理方式：

1.  切换到`NSFileProtectionNone`。
2.  如果商店不可用，请添加额外的检查以跳过某些内容，并在它可用`applicationProtectedDataWillBecomeUnavailable:`后重新设置。
3.  如果应用程序在后台启动 ( `[[UIApplication sharedApplication] applicationState] == UIApplicationStateBackground`) 并且受保护的数据不可用 ( `[[UIApplication sharedApplication] isProtectedDataAvailable] == NO)`) 只需调用`exit(0)`（或类似的方法）退出应用程序。一方面，这似乎是最简单的解决方案，我并没有真正看到任何缺点。但它也似乎……“错了”？我想我无法决定这是一个干净的解决方案还是一个懒惰的解决方案。
4.  还有什么我没有想到的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T20:37:46.793

在考虑了一段时间后，我想出了一个我满意的解决方案。该选项需要考虑的一件事`exit(0)`是，如果用户需要一段时间来解锁设备，应用程序可能会不断加载、退出和重新加载。而如果你只是阻止应用程序做很多事情，它可能只需要加载一次，并且很可能会更有效。所以我决定尝试我的选项 3，看看它到底有多乱。结果比我想象的要简单。

首先，我`BOOL setupComplete`向我的应用程序委托添加了一个属性。这为我提供了一种简单的方法来检查应用程序是否在各个时间点完全启动。然后`application:didFinishLaunchingWithOptions:`我尝试初始化托管对象上下文，然后执行以下操作：

```
NSManagedObjectContext *moc = [self managedObjectContext];
if (moc) {
    self.setupComplete = YES;
    [self setupWithManagedObjectContext:moc];
} else {
    UIApplication *app = [UIApplication sharedApplication];
    if ([app applicationState] == UIApplicationStateBackground && ![app isProtectedDataAvailable]) {
        [app beginIgnoringInteractionEvents];
    } else [self presentErrorWithTitle:@"There was an error opening the database."];
} 
```

`setupWithManagedObjectContext:`只是一个完成设置的自定义方法。我不确定这`beginIgnoringInteractionEvents`是必要的，但我添加它是为了安全起见。这样，当应用程序被带到前面时，我可以确定界面被冻结，直到设置完成。如果急切的用户焦急地敲击，它可能会避免崩溃。

然后在`applicationProtectedDataDidBecomeAvailable:`我调用这样的东西：

```
if (!self.setupComplete) {
    NSManagedObjectContext *moc = [self managedObjectContext];
    if (moc) {
        self.setupComplete = YES;
        [self setupWithManagedObjectContext:moc];
        UIApplication *app = [UIApplication sharedApplication];
        if ([app isIgnoringInteractionEvents]) [app endIgnoringInteractionEvents];
    } else [self presentErrorWithTitle:@"There was an error opening the database."];
} 
```

这样就完成了设置并重新启用了界面。这是大部分工作，但您还需要检查您的其他代码，以确保在您的持久存储可用之前没有调用任何依赖 Core Data 的内容。需要注意的一件事是，如果用户从这个后台状态启动应用程序，它`applicationWillEnterForeground`可能`applicationDidBecomeActive`会在之前被调用。`applicationProtectedDataDidBecomeAvailable`所以在不同的地方我已经添加`if (self.setupComplete) { … }`以确保在它准备好之前没有任何东西运行。加载数据库后，我还有几个地方需要刷新界面。

为了（部分）在不开车的情况下进行测试，我临时修改`application:didFinishLaunchingWithOptions:`为不设置数据库：

```
NSManagedObjectContext *moc = nil; // [self managedObjectContext];
if (moc) {
    self.setupComplete = YES;
    [self setupWithManagedObjectContext:moc];
} else {
    UIApplication *app = [UIApplication sharedApplication];
    // if ([app applicationState] == UIApplicationStateBackground && ![app isProtectedDataAvailable]) {
        [app beginIgnoringInteractionEvents];
    // } else [self presentErrorWithTitle:@"There was an error opening the database."];
} 
```

然后我把我的代码`applicationProtectedDataDidBecomeAvailable:`移到了`applicationWillEnterForeground:`. 这样我就可以启动应用程序，确保没有意外发生，按下主页按钮，再次打开应用程序，并确保一切正常。由于实际代码需要移动很长的距离并每次等待五分钟，这给了我一个很好的方法来估计正在发生的事情。

最后一件让我绊倒的事情是我执着的商店协调员。典型的实现可能如下所示：

```
- (NSPersistentStoreCoordinator *)persistentStoreCoordinator {
    if (_persistentStoreCoordinator != nil) return _persistentStoreCoordinator;

    NSURL *storeURL = [[self applicationDocumentsDirectory] URLByAppendingPathComponent:@"Test.sqlite"];

    NSError *error = nil;
    _persistentStoreCoordinator = [[NSPersistentStoreCoordinator alloc] initWithManagedObjectModel:[self managedObjectModel]];
    if (![_persistentStoreCoordinator addPersistentStoreWithType:NSSQLiteStoreType configuration:nil URL:storeURL options:nil error:&error]) {
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
    }    

    return _persistentStoreCoordinator;
} 
```

这大致基于 Apple 的示例代码，它在注释中解释了您需要适当地处理错误。我自己的代码比这多一点，但我没有考虑过的一件事是，如果加载持久存储时出错，这将返回一个非零结果！这允许我所有其他代码继续运行，就好像它工作正常一样。即使persistentStoreCoordinator 被再次调用，它也只会返回相同的协调器，没有有效的存储，而不是尝试再次加载存储。有多种方法可以解决这个问题，但对我来说，最好不要设置 _persistentStoreCoordinator，除非它能够添加商店：

```
- (NSPersistentStoreCoordinator *)persistentStoreCoordinator {
    if (_persistentStoreCoordinator != nil) return _persistentStoreCoordinator;

    NSURL *storeURL = [[self applicationDocumentsDirectory] URLByAppendingPathComponent:@"Test.sqlite"];

    NSError *error = nil;
    NSPersistentStoreCoordinator *coordinator = [[NSPersistentStoreCoordinator alloc] initWithManagedObjectModel:[self managedObjectModel]];
    if ([coordinator addPersistentStoreWithType:NSSQLiteStoreType configuration:nil URL:storeURL options:nil error:&error]) {
        _persistentStoreCoordinator = coordinator;
    } else {
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
    }    

    return _persistentStoreCoordinator;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-07T09:39:47.413

我经历过，你必须检查

```
[[UIApplication sharedApplication] isProtectedDataAvailable] 
```

并处理

```
applicationProtectedDataWillBecomeUnavailable 
```

确保您不访问受保护的文件。检查

```
managedObjectContext 
```

对我不起作用。

# android - 让 Google Maps API 在没有 Google API 构建的情况下在 Android 上运行

> ID：15079768
> 
> 赞同：1
> 
> 时间：2013-02-26T01:29:32.473
> 
> 标签：android, google-maps, android-maps, android-maps-v2

即使我使用 API 8 而不是 Google API + Android API 8 构建我的应用程序，我也可以让我的 android 应用程序让 google maps api v2 正常工作

所以问题是，如果我可以让谷歌地图在我的 android 应用程序中正常工作而无需使用 Google Api+Android 8 进行编译/构建，那么 Google API 构建用于什么？

这是一件非常令人困惑的事情

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T02:45:38.787

Google Maps Android API v1 需要 Google API 的插件。V2 不需要附加组件，并通过[Google Play Services](http://developer.android.com/google/play-services/index.html)获得支持。这是 Google 允许开发人员访问其 API 的新方式。这样做的好处是可以通过 Google Play 商店更新 Google Play 服务。我认为谷歌更新插件要困难得多。您可以在此处查看附加组件还支持什么：[https](https://developers.google.com/android/add-ons/google-apis/) ://developers.google.com/android/add-ons/google-apis/ 。主要是地图 API 和一些 USB API。

# javascript - javascript随机报价生成器不打印

> ID：15079772
> 
> 赞同：0
> 
> 时间：2013-02-26T01:30:07.980
> 
> 标签：javascript

我试图在每次刷新时从列表中生成新的报价。出于某种原因，我无法在 div 中显示引号，我不知道为什么。

任何帮助将不胜感激！

```
<div id="quotes">

<script>
var quotes = new Array();
quotes[0] = "<i>Quote 1</i><br><b>Author</b>";
quotes[1] = "<i>Quote 2</i><br><b>Author</b>";

var random = Math.ceil (Math.random() * quotes.length) - 1;
$('quotes').set('html', quotes[random]);
</script>

</div> 
```

感谢大家对此的帮助，我已经更新了我的代码-

```
<div id="quotes"></div>

<script>
var quotes = [
"<i>"Some people feel the rain. Others just get wet."</i><br><b>Bob Marley/b>",
"<i>“Do not pray for an easy life, pray for the strength to endure a                    difficult one.”&lt;/i><br><b>Bruce Lee</b>",
"<i>“Success is not final, failure is not fatal: it is the courage to continue that counts.”&lt;/i><br><b>Winston
Churchill</b>",
"<i>If your dreams don’t scare you they’re not big enough.</i><br><b></b>",
"<i>“It takes courage to grow up and become who you really are.”&lt;/i><br><b>E.E. Cummings</b>",
"<i>All endings are also beginnings, we just don’t know it yet.</i><br><b></b>",
"<i>There are three kinds of people: Those who make it happen, those who watch it happen, and
those who wonder what the heck happened.</i><br><b></b>",
"<i>There are people so poor, that the only thing they have is money.</i><br><b></b>",
"<i>“Things do not happen. Things are made to happen.”&lt;/i><br><b>John F. Kennedy</b>",
"<i>“Destiny is a name often given in retrospect to choices that had dramatic consequences.”&lt;/i><br><b>J.K. Rowling</b>",
"<i>“When I was 5 years old, my mother always told me that happiness was the key to life.
When I went to school, they asked me what I wanted to be when I grew up. I wrote
down ‘happy’. They told me I didn’t understand the assignment, and I told them they didn’t
understand life.”&lt;/i><br><b>John Lennon</b>",
"<i>“Not all those who wander are lost”&lt;/i><br><b>JRR Tolkien</b>",
"<i>We all die. The goal isn’t to live forever, the goal is to create something that will.</i><br><b></b>",
"<i>Strive for progress, not perfection.</i><br><b></b>",
"<i>What defines us is how well we rise after falling.</i><br><b></b>",
"<i>“It’s not hard to make decisions once you know what your values are.”&lt;/i><br><b>Roy E. Disney</b>",
"<i>Sorry’s not good enough.</i><br><b></b>",
"<i>I may not be there yet, but I’m closer than I was yesterday.
Every day is a new beginning. Stay away from what might have been and look at what can
be.</i><br><b></b>",
"<i>Who inspires you?</i><br><b></b>",
"<i>“If you play by the rules long enough, then you can change the game.”&lt;/i><br><b>Enders Game</b>"
];

document.getElementById('quotes').innerHTML = quotes[Math.floor(Math.random() * quotes.length)];
</script> 
```

出于某种原因，div 仍在加载而没有考虑任何内容。

是我的报价里面的报价搞砸了。谢谢大家的帮助！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T01:43:08.617

消除对任何库的需求使代码更容易不出错。

```
<div id="quotes"></div>
<script>
var quotes = [
    "<i>Quote 1</i><br><b>Author</b>",
    "<i>Quote 2</i><br><b>Author</b>"
];

document.getElementById('quotes').innerHTML =
                                   quotes[Math.floor(Math.random() * quotes.length)];
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T01:34:23.107

**编辑：**没关系，在 MooTools 中似乎`$`确实应该返回带有 id 的元素`quotes`。如果你想在没有框架的情况下做同样的事情，你可以使用`document.getElementById('quotes').innerHTML = quotes[random]`.

您`$`正在尝试查找名为 的元素`<quotes>`，而不是 ID 为“quotes”的元素（假设它使用像 jQuery 这样的 CSS 选择器）。使用`$('#quotes')`应该修复它。

其他一些事情：您可以以更简洁的方式编写数组：

```
quotes = [
  "<i>Quote 1</i><br><b>Author</b>",
  "<i>Quote 2</i><br><b>Author</b>"
]; 
```

此外，您可以只使用`Math.floor`而不是`Math.ceil`您的随机值，那么最后就不需要了`- 1`。

# javascript - this.src.replace img src 用于多个图像

> ID：15079775
> 
> 赞同：0
> 
> 时间：2013-02-26T01:30:30.410
> 
> 标签：javascript, replace, image

将鼠标悬停在图像上时，我想更改图像的来源。

我已经设法为一张图片做到了，通过

```
<img id="image1" src="image1-grey.png" onmouseover=colorImage(this) />" 
```

和：

```
function colorImage(x){
document.getElementById("image1").src = x.src.replace("grey", "color");
} 
```

我有十几张图片——都有两个版本，灰色和彩色。

现在我想我可以对所有图像单独重复上述功能，但必须有一种更清洁的方法。

这是我想的，但它不起作用：

```
<img id="image1" src="image1-grey.png" onmouseover=colorImage(image1) />" 
```

和：

```
function colorImage(x){
document.getElementById(x).src = this.src.replace("grey", "color");
} 
```

这样，我想，我对所有图像只有一个功能。但不是。为什么不？

提前非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T01:34:10.193

由于您将图像的引用作为参数传递，因此您不需要使用 document.getElementById ...您已经拥有它！

```
function colorImage(x){
  x.src = x.src.replace("grey", "color");
} 
```

您可以继续使用第一种方式调用该函数：

```
<img id="image1" src="image1-grey.png" onmouseover=colorImage(this) /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T01:36:57.840

看起来您的问题出`image1`在下面的行中

```
onmouseover=colorImage(image1) 
```

它需要像您传递字符串一样用引号引起来（如下所示）

```
onmouseover=colorImage('image1') 
```

您现在传递它的方式是发送一个名为`image1`（将是`undefined`）的 javascript 变量，而不是您想要的字符串名称`"image1"`

# algorithm - 如何在图形函数上的任意两点之间画一条线？

> ID：15079778
> 
> 赞同：0
> 
> 时间：2013-02-26T01:30:56.620
> 
> 标签：algorithm, line, newline, gnuplot

我想在 gnplot 中上一个图中的两个任意点（已知和未知）之间画一条线，我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T14:23:18.627

您可以执行以下操作：

```
set arrow from X1,Y1 to X2,Y2 nohead 
```

`linecolor`当然，您也可以通过添加( `lc`)、`linetype`( `lt`) 和`linestyle`( )来指定颜色和线型和样式`ls`。例如：

```
set arrow from X1,Y1 to X2,Y2 lc rgb "green" nohead 
```

或者

```
set arrow from X1,Y1 to X2,Y2 lc rgb "#00ff00" nohead 
```

*当您说要向未知*点绘制箭头时，很难说出您想要什么。也许这是您想要的数据文件中的某些功能。如果是这种情况，您也许可以使用以下方法来获取它`stats`：

```
stats 'datafile' u 1:2
set arrow from X1,Y1 to STATS_pos_min_x,STATS_min_y nohead 
```

这将绘制一条从您定义的 X1,Y1 到最小 y 图上的点的线。

# angularjs - 如何从 Angular JS 清除文件输入

> ID：15079779
> 
> 赞同：29
> 
> 时间：2013-02-26T01:30:57.203
> 
> 标签：angularjs

在 AngularJS 中，我使用此处描述的方法来处理输入类型=文件。

*   [https://groups.google.com/forum/?fromgroups=#!topic/angular/-OpgmLjFR_U](https://groups.google.com/forum/?fromgroups=#!topic/angular/-OpgmLjFR_U)
*   [http://jsfiddle.net/marcenuc/ADukg/89/](http://jsfiddle.net/marcenuc/ADukg/89/)

标记：

```
<div ng-controller="MyCtrl">
    <input type="file" onchange="angular.element(this).scope().setFile(this)">
    {{theFile.name}}
</div> 
```

控制器：

```
var myApp = angular.module('myApp', []);

myApp.controller('MyCtrl', function($scope) {
    $scope.setFile = function(element) {
        $scope.$apply(function($scope) {
            $scope.theFile = element.files[0];
        });
    };
}); 
```

如前所述，这有点像 hack，但它主要适用于我的目的。然而，我需要的是一种在上传完成后清除文件输入的方法 - 即：从控制器。

我可以完全破解它并使用 jQuery 或其他东西来查找输入元素并清除它，但希望有一些更优雅的东西。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-06-18T20:17:16.583

成功上传后，我从控制器中明确清除输入类型文件元素，如下所示：

```
 angular.forEach(
    angular.element("input[type='file']"),
    function(inputElem) {
      angular.element(inputElem).val(null);
    }); 
```

选择`input[type='file']`器需要 jQuery，但其他一切都是普通的 Angular。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-26T01:56:02.090

我肯定会为这类任务使用指令。

[http://plnkr.co/edit/xLM9VX](http://plnkr.co/edit/xLM9VX)

```
app.directive('fileSelect', function() {
  var template = '<input type="file" name="files"/>';
  return function( scope, elem, attrs ) {
    var selector = $( template );
    elem.append(selector);
    selector.bind('change', function( event ) {
      scope.$apply(function() {
        scope[ attrs.fileSelect ] = event.originalEvent.target.files;
      });
    });
    scope.$watch(attrs.fileSelect, function(file) {
      selector.val(file);
    });
  };
}); 
```

注意：它使用 jquery 来创建元素。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-11-25T22:20:24.577

我的解决方案不使用 $scope。

```
app.directive('fileChange',['UploadService',function (UploadService) {
    var linker = function (element, attrs) {
        element.bind('change', function (event) {
            var files = event.target.files;
            UploadService.upload({'name':attrs['name'],'file':files[0]});
            element.val(null);  // clear input
        });
    };
    return {
        restrict: 'A',
        link: linker
    };
}]); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-01-28T06:02:19.050

它可能会帮助你！

HTML 代码示例

```
 <input type="file" id="fileMobile" file-model="myFile">
 <button type="button" class="btn btn-danger" id="i-agree" ng-click="uploadFile()"> Upload </button> 
```

AngularJs 代码示例

```
$scope.uploadFile = function () {
    var file = $scope.myFile;
    mobileService.uploadBulkFile(file).then(function (resp) {
        if (resp !== undefined) {
            $('#fileMobile').val('');
        }
    });
}; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-11-20T05:37:09.580

您可以使用 ID 来重置文件字段。

```
<div class="col-md-8">  
    <label for="files">Select File</label>
    <input type="file" id="file_upload" class="form-control">
</div> 
```

上传后清除。

```
var fileElement = angular.element('#file_upload');
angular.element(fileElement).val(null); 
```

上面的例子对我有用。也会为你工作。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-04-11T19:35:55.737

就我而言，我会在文件上传成功时广播事件。所以我的指令监视广播，并清除选择。

```
app.directive("fileInput", function( APP_EVENTS ){
    return{
        require: "ngModel",
        link: function postLink( scope, elem, attrs, ngModel ){

            elem.on("change", function( e ){
                var files=elem[0].files;
                ngModel.$setViewValue( files );
            });

            scope.$on( APP_EVENTS.FILE_UPLOAD_SUCCESS, function( event ){
                elem.val( null );
            });
        }
    }
}); 
```

它是这样使用的：

```
<input type="file" name="myFieldName" ng-model="myModel" file-input/> 
```

# hibernate - 使用 InheritanceType.JOINED 解决 Hibernate 对遗留数据库缺乏鉴别器支持的问题

> ID：15079780
> 
> 赞同：1
> 
> 时间：2013-02-26T01:30:58.083
> 
> 标签：hibernate, inheritance, jpa

[此处](https://stackoverflow.com/q/4275517)和[此处](https://stackoverflow.com/q/7988756)的答案中链接的许多响应和各种 Hibernate open JIRA 票证 都表明尝试使用带有and的`InheritanceType.JOINED`策略（如下图所示）将不起作用。具体参见：[https](https://hibernate.onjira.com/browse/HHH-6911) ://hibernate.onjira.com/browse/HHH-6911 。`@DiscriminatorColumn``@DiscriminatorValue`

我的场景是我有一个遗留数据库，它使用标准的“类型”表来区分抽象类型的多个具体类型，并具有强制对齐的引用完整性约束。它似乎需要正确设置抽象类型上的鉴别器字段，以便 JPA 模型忠实地表示数据库模型的意图。表格的简化版本如下：

```
CREATE TABLE CONTACT_INFORMATION (
    CONTACT_INFORMATION_ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
    FK_STND_CONTACT_INFO_TYPE_ID INTEGER UNSIGNED NOT NULL,
    -- more here...
    PRIMARY KEY (CONTACT_INFORMATION_ID)
);

CREATE TABLE STND_CONTACT_INFO_TYPE (
    STND_CONTACT_INFO_TYPE_ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
    CONTACT_INFO_TYPE_CD CHAR(5) NOT NULL,
    DESCRIPTION_TX VARCHAR(30),
    PRIMARY KEY (STND_CONTACT_INFO_TYPE_ID)
);

CREATE TABLE POSTAL_ADDRESS (
    FK_CONTACT_INFORMATION_ID INTEGER UNSIGNED NOT NULL,
    -- more here...
    PRIMARY KEY (FK_CONTACT_INFORMATION_ID)
);

CREATE TABLE ELECTRONIC_ADDRESS (
    FK_CONTACT_INFORMATION_ID INTEGER UNSIGNED NOT NULL,
    -- more here...
    PRIMARY KEY (FK_CONTACT_INFORMATION_ID)
); 
```

存在 from`ELECTRONIC_ADDRESS`和`POSTAL_ADDRESS`to的参照完整性约束`CONTACT_INFORMATION`，以及一个 from `CONTACT_INFORMATION`to `STND_CONTACT_INFORMATION_TYPE`。

尝试创建可以让我使用此模型的 JPA 注释实体，我想出了以下内容：

```
@Entity
@Table(name = "CONTACT_INFORMATION")
@Inheritance(strategy = InheritanceType.JOINED)
@DiscriminatorColumn(name = "FK_STND_CONTACT_INFO_TYPE_ID", discriminatorType = DiscriminatorType.INTEGER)
public abstract class ContactInformation {
    @Id
    @GeneratedValue(strategy = IDENTITY)
    @Column(name = "CONTACT_INFORMATION_ID", unique = true, nullable = false)
    private Integer id;

    @ManyToOne
    @JoinColumn(name = "FK_STND_CONTACT_INFO_TYPE_ID", nullable = false)
    private StandardContractInformationType contactInformationType;
}

@Entity
@Table(name = "STND_CONTACT_INFO_TYPE")
public class StandardContractInformationType  {
    @Id
    @GeneratedValue(strategy = IDENTITY)
    @Column(name = "STND_CONTACT_INFO_TYPE_ID", unique = true, nullable = false)
    private Integer id;

    @Column(name = "CONTACT_INFO_TYPE_CD", nullable = false)
    private String typeCode;

    @Column(name = "DESCRIPTION_TX", length = 30)
    private String description;
}

@Entity
@Table(name = "POSTAL_ADDRESS")
@PrimaryKeyJoinColumn(name = "FK_CONTACT_INFORMATION_ID")
@DiscriminatorValue(value = "1")
public class PostalAddress extends ContactInformation { /*...*/ }

@Entity
@Table(name = "ELECTRONIC_ADDRESS")
@PrimaryKeyJoinColumn(name = "FK_CONTACT_INFORMATION_ID")
@DiscriminatorValue(value = "2")
public class ElectronicAddress extends ContactInformation { /*...*/ } 
```

`STND_CONTACT_INFO_TYPE`请注意，即使此实现也需要硬编码鉴别器值“1”和“2”，这些值对应于为两个子类型预加载到表中的参考数据。

使用此实现并使用 Hibernate 4，插入 PostalAddress 或 ElectronicAddress 的记录不会正确设置抽象基表的 FK_STND_CONTACT_INFO_TYPE_ID 字段，正如前面问题中确定的问题。

所以，毕竟，问题是：有哪些选择可以继续使用一个好的 JPA 模型，同时仍然试图忠实于原始数据库模型的意图？尝试不同的提供商？查找标准类型信息并在存储库或服务层中添加强制执行？试着眯起眼睛，把它看作一个组合问题而不是继承问题？

# java - 为什么故障安全迭代器不抛出 ConcurrentModificationException？

> ID：15079781
> 
> 赞同：-2
> 
> 时间：2013-02-26T01:31:08.910
> 
> 标签：java, iterator

在什么情况下应该将迭代器设计为在 Java 中快速失败？有什么见解吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T02:08:37.400

故障安全意味着迭代器只有在时机恰到好处时才会失败，因为它会导致数据损坏。这并不意味着您有时不会逃脱惩罚。换句话说，如果你的代码做错了什么，它可能会也可能不会出现异常。这与 fail-fast 形成对比，当你做错事时总是抛出异常。

迭代器很可能是故障安全的，因为故障安全实现更快（在同步代码中需要更少的时间），并且由于在 Java 代码中的许多地方都使用了迭代器，因此性能是一个问题。

# java - 如何让我的应用程序图标在 Mac Dock 中反弹

> ID：15079783
> 
> 赞同：1
> 
> 时间：2013-02-26T01:31:20.147
> 
> 标签：java, macos

好吧，我正在用 Java 编写一个 IRC 客户端，我想知道是否有办法让我的应用程序的图标在触发 nickalert（或任何其他相关通知）时在 Dock 中反弹。

如果 Windows 也有某种通知系统，我也想知道它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T01:50:11.630

在 MacOS 下，尝试使用类似[Application#requestUserAttention(boolean)](http://developer.apple.com/library/mac/documentation/Java/Reference/JavaSE6_AppleExtensionsRef/api/com/apple/eawt/Application.html#requestUserAttention%28boolean%29)

```
import com.apple.eawt.Application;
...
Application application = Application.getApplication();
application.requestUserAttention(false); 
```

nb-我自己没有尝试过-对不起。

**更新了示例**

来自[JavaDocs](https://developer.apple.com/library/mac/documentation/Java/Reference/JavaSE6_AppleExtensionsRef/api/com/apple/eawt/Application.html#requestUserAttention%28boolean%29)

> 请求用户注意此应用程序（通常通过弹跳 Dock 图标）。关键请求将继续弹跳 Dock 图标，直到应用程序被激活。请求关注的已经处于活动状态的应用程序什么也不做。

这意味着，如果应用程序有焦点，那么该方法将什么也不做。

在 Mac OSX 10.7.5、Java 1.7.0_07 上测试

```
import com.apple.eawt.Application;
import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.io.IOException;
import javax.imageio.ImageIO;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;
import javax.swing.Timer;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;

public class TestMacIcon {

    public static void main(String[] args) {
        new TestMacIcon();
    }

    public TestMacIcon() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame("Test");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new TestPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }

        });
    }

    public class TestPane extends JPanel {

        public TestPane() {
            final Application application = Application.getApplication();
            addMouseListener(new MouseAdapter() {
                @Override
                public void mouseClicked(MouseEvent e) {
                    try {
                        System.out.println("clicked");
                        application.requestUserAttention(true);
                        application.setDockIconImage(ImageIO.read(getClass().getResource("/Java.png")));
                        application.setDockIconBadge("Blah");
                        application.requestUserAttention(true);
                    } catch (IOException ex) {
                        ex.printStackTrace();
                    }
                }
            });
            Timer time = new Timer(2000, new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    if (!SwingUtilities.getWindowAncestor(TestPane.this).hasFocus()) {
                        ((Timer)e.getSource()).stop();
                        System.out.println("Pay attention!!");
                        application.requestUserAttention(true);
                    }
                }
            });
            time.setRepeats(true);
            time.setCoalesce(true);
            time.start();
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(200, 200);
        }

    }

} 
```

Ps 确保您专注于应用程序；）

# php - 将 Javascript 加载到 AJAX 生成的 div 中

> ID：15079788
> 
> 赞同：1
> 
> 时间：2013-02-26T01:31:44.220
> 
> 标签：php, jquery, ajax, dynamic

我正在尝试将 Javascript 加载到通过 AJAX 生成并填充了外部 PHP 文件的 div 中。

这是我用来加载 AJAX div 和我的 PHP 内容的导航：

```
<div id="portfolioContent">
  <div id="portfoliotabContainer">
    <ul id="portfolioTabs">
      <li><a id="dashboardTab" href="./portfolio/portfoliocontent/dashboard.php">Dashboard</a></li>
      <li><a id="casedetailsTab" href="./portfolio/portfoliocontent/casedetails.php">Case Details</a></li>
      <li><a id="correspondenceTab" href="./portfolio/portfoliocontent/correspondence.php">Correspondence</a></li>
      <li><a id="pleadingTab" href="./portfolio/portfoliocontent/pleading.php">Pleading</a></li>
      <li><a id="discoveryTab" href="./portfolio/portfoliocontent/discovery.php">Discovery</a></li>
      <li><a id="expensesTab" href="./portfolio/portfoliocontent/expenses.php">Expenses</a></li>
      <li><a id="indexTab" href="./portfolio/portfoliocontent/docindex.php">Document Index</a></li>
    </ul>
  </div> 
```

我需要超链接来加载和填充生成的 div，还需要调用外部 Javascript 文件，以便我的脚本在生成的 div 中工作。

这是我的脚本：

```
$(function () {
  $("#portfolioTabs li a").live("click", function () {
    var pagecontent = $(document.createElement("div"));
    pagecontent.load(
    $(this).attr("href"));
    $(".insideContent").html(pagecontent);
    $(".portfolioContent").animate({
      height: "110%"
    });
    $(".insideContent").animate({
      bottom: "0px"
    });
    return false;
  });
}); 
```

我已经研究过了，我知道我可以动态加载，但我不确定实现这一目标的最简单方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T01:36:47.857

问题似乎是您在尚未加载内容时将内容分配给另一个元素。

您可以为此使用回调函数[`load`](http://api.jquery.com/load/)：

```
pagecontent.load($(this).attr("href"), function() {
        // this gets executed when the `load` is complete
        $(".insideContent").html(pagecontent);      

        $(".portfolioContent").animate({                    
            height: "110%"                               
        });                                                
        $(".insideContent").animate({
            bottom: "0px"
        });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T01:37:59.303

你应该使用类似的东西`$.ajax`。这使您可以在不重新加载页面的情况下将内容异步加载到页面中，这听起来就像您想要的那样。

在您的事件处理程序中，您可能想要类似的东西

```
var url = $(this).attr("href");
$.ajax({
    url: url,
    success: function(data) {
        $(".insideContent").html(data);
    }
}); 
```

请注意，依赖于数据加载的所有内容都必须放在**我**更新 html 的匿名函数中。

# ruby-on-rails - 尝试将收藏夹模型添加到我的应用程序...出现路由错误

> ID：15079789
> 
> 赞同：0
> 
> 时间：2013-02-26T01:31:45.667
> 
> 标签：ruby-on-rails

我有一个应用程序，其中有一个用户可以查看的预定义饮料列表。我试图让用户能够喜欢/不喜欢饮料。

出于某种原因，当我单击收藏链接时出现 AssociationMismatch 错误。显然代码不喜欢我的 current_user.favorite_drinks << @drink 部分代码

*CONTROLLER* Drinks_controller.rb

```
def favorite
  type = params[:type]
  if type == "favorite"
    @drink = Drink.find params[:drink_id]
    current_user.drinks << @drink
      redirect_to :back, notice: 'You favorites #{@drink.name}'
    elsif type == "unfavorite"
      current_user.drinks.delete(@drink)
      redirect_to :back, notice: 'You unfavorited #{@drink.name}'
    else
    redirect_to :back, notice: 'Nothing happened'
  end
end 
```

控制器收藏夹_controller.rb

```
def show
  @user = User.find(params[:id])
  if @user
    @drinks = @user.favorite_drinks.all
    render action: :show
  else
    render file: 'public/404', status: 404, formats: [:html]
  end
end 
```

路线路线.rb

匹配 'auth/:provider/callback', to: 'sessions#create' match 'auth/failure', to: redirect('/') match 'signout', to: 'sessions#destroy', as: 'signout'

根到：“drinks#index”资源：眼镜资源：成分资源：内阁资源：饮料确实得到“最喜欢的”，：on =>：收集结束资源：最喜欢的

获取“收藏夹/节目”

模型用户.rb

```
 has_one :cabinet
     has_many :favorite_drinks
     has_many :drinks, through: :favorite_drinks 
```

模型 favourite_drink.rb

```
 attr_accessible :drink_id, :user_id

    belongs_to :user
    belongs_to :drink 
```

查看_results.html.haml

```
 %td= link_to "favorite", favorite_drinks_path(drink_id: drink.id, type: "favorite"), method: "get"
   %td= link_to "unfavorite", favorite_drinks_path(drink, type: "unfavorite"), method: "get" 
```

查看收藏夹/show.html.haml

```
 %table.table.table-striped
     %thead
       %tr
         %th Name
     %tbody
       - if @drinks.each do |drink|
         %tr
           %td= link_to drink.name, drink 
```

*我的更新代码*

迁移 create_favorite_drinks.rb

```
 class CreateFavoriteDrinks < ActiveRecord::Migration
     def change
       create_table :favorite_drinks do |t|
         t.integer :drink_id
         t.integer :user_id

         t.timestamps
       end
     end
   end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T01:44:26.803

导致错误的那部分代码的 2 件事

1.  @drink 是一个数组，因此您需要遍历每个数组，然后再将它们添加到用户最喜欢的饮料列表中`<<`
2.  current_user.favorite_drinks << @drink - 你正在将一个`Drink`对象推到一张`favorite_drinks`桌子上，这就是你不匹配的原因

最好的解决方案是像这样设置你的模型

```
# user.rb
has_many :favorite_drinks
has_many :drinks, through: :favorite_drinks

# favorite_drink.rb
belongs_to :user
belongs_to :drink

# drink.rb
has_many :favorite_drinks
has_many :users, through: :favorite_drinks 
```

这是假设你有一个`user_id`and`drink_id`在`favorites_drinks`桌子上。然后你可以使用`current_user.drink_ids = params[:drink_ids]`

更新：

我刚刚注意到您正在使用`params[:drink_id]`. 所以将控制器代码更改为

```
@drink = Drink.find params[:drink_id]
current_user.drinks << @drink 
```

你应该没事

更新：将@drink 移出 if 块，以便在不喜欢类型时仍然可以访问它

```
@drink = Drink.find params[:drink_id]

if type == "favorite"
  current_user.drinks << @drink
  redirect_to :back, notice: 'You favorites #{@drink.name}'
elsif type == "unfavorite"
  current_user.drinks.delete(@drink)
  redirect_to :back, notice: 'You unfavorited #{@drink.name}'
else
  redirect_to :back, notice: 'Nothing happened'
end 
```

# python - Python：file.readline 在行尾添加一个空格

> ID：15079800
> 
> 赞同：1
> 
> 时间：2013-02-26T01:32:53.500
> 
> 标签：python

我正在使用 python 来读取一个平面空格填充的文本文件。文本文件验证的一部分是文本文件中的每一行都应该是一个特定的文件长度，包括空格填充。

当我使用下面的代码时，python 最终给了我一行额外的空间。例如，我希望 fileX 中的所有行都有 143 个字符。虽然 Python 会将其读取为 144 个字符，因此会说该文件无效。如果我在 VB.NET 中做同样的事情，我会得到正确的 143 个字符。

为什么**Python 的**readline 函数要添加一个额外的字符？（使用python 3.2）

```
import io
myfile = open("file_path", "r")
while True:
    line = myfile.readline()
    if not line:
            break
    print(len(line))  #This prints 144 characters 
```

**VB.NET**给出了 143 个字符的正确长度。

```
Using objStreamReader As StreamReader = New StreamReader(myFilePath)
    While objStreamReader.EndOfStream = False
            line = objStreamReader.ReadLine
            len(line)   'This returns the correct length of 143. 
```

使用 line.strip 将不是正确的机制，因为我可能会摆脱有用的空间。请记住，文件被空格填充到最大给定长度。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T01:37:43.517

`objStreamReader.ReadLine` [砍掉终止的换行符](http://msdn.microsoft.com/en-us/library/system.io.streamreader.readline.aspx)，而 Python`file.readline` [保留它](http://docs.python.org/2/tutorial/inputoutput.html#methods-of-file-objects)。

如果您的文件是在文本模式下打开的（除非您明确指定，否则它是），行结尾将始终为空（仅最后一行）或恰好是一个`\n`，您可以使用`rstrip('\n')`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T01:38:36.053

第 144 个字符是换行符。

```
with open("file_path") as file:
    for line in file:
        line = line.rstrip("\n") # strip newline
        print(len(line)) # should print 143 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-14T21:14:11.943

使用列表推导，您可以执行以下操作：

```
def readfile():
    with open(filename, 'r') as fh:
        lines = [line.rstrip('\n') for line in fh.readlines()]
        for line in lines:
            print (line) 
```

# c++ - C++ 错误：错误 LNK2019：未解析的外部符号

> ID：15079802
> 
> 赞同：-1
> 
> 时间：2013-02-26T01:33:04.157
> 
> 标签：c++, class, linker

我查看了也包含这些错误的其他问题。我无法从这些问题中找到解决方案。一些答案说某些功能没有实现，但我的功能是。当我尝试从 VS2012 命令行运行程序时，我只收到标题错误。当我从 IDE 运行程序时，我没有错误，一切都很好。

## Visual Studio 2012 项目

*   [TTH.zip](https://www.dropbox.com/s/3ukgkhbglkvyv81/TTH.zip)

## 伊姆古尔

*   [Capture_CMD.png](http://i.imgur.com/X6FzpKD.png)

## 使用TTH.cpp

```
#include <iostream>
#include <string>
#include "tth.h"
using namespace std;

int main()
{
    string message;
    string choice;

    do
    {
        cout << "Please enter a message: ";
        getline(cin, message);

        tth tthObject;
        tthObject.getMessage(message);
        tthObject.encryptMessageOnlyLetters();

        cout << endl;
        cout << "Encrypt another message? (Yes/No)" << endl;
        cout << "> ";
        getline(cin, choice);
        cout << endl;
    }
    while(choice.substr(0, 1) == "Y" || choice.substr(0, 1) == "y");

    system("PAUSE");
    return 0;
} 
```

## th.h

```
#include <string>
#include <vector>
using namespace std;

class tth
{
    public:
        tth();
        void getMessage(string messageP);
        void setMessageOnlyLettersNumberOf16Blocks();
        void encryptMessageOnlyLetters();
        void messageOnlyLettersToFourByFourLetters();
        void matchLetterToNumber();
        void calculateAndShowRunningTotalFourByFourNumbers();
        void shiftRowsAccordingly();
        void calculateAndShowRunningTotalTemp();
        void matchNumberToLetter();
        void showFourLetterHashNumbers();

    private:
        string message;
        vector<char> messageOnlyLetters;
        int runningTotal[4];
        char fourLetterHash[4];
        int messageLength;
        int messageOnlyLettersNumberOf16Blocks;
        char fourByFourLetters[4][4];
        int fourByFourNumbers[4][4];
        int temp[4][4];
}; 
```

## tth.cpp

```
#include <iostream>
#include <string>
#include <cctype>
#include "tth.h"

//--------------------------------------------------------------------------------------------------------------
// tth()
//--------------------------------------------------------------------------------------------------------------
// Constructor for the tth class.
// Initializes the elements of the private integer array 'runningTotal' to 0.
// Initializes the elements of the private char array 'fourLetterHash' to 'A'.
//--------------------------------------------------------------------------------------------------------------
tth::tth()
{
    for(int i = 0; i < 4; i++)
    {
        runningTotal[i] = 0;
        fourLetterHash[i] = 'A';
    }
}

//--------------------------------------------------------------------------------------------------------------
// getMessage(string messageP)
//--------------------------------------------------------------------------------------------------------------
// A public function of the tth class.
// Sets the value of the private string variable 'message' to the value of the string 'messageP' parameter.
// Gives the private char vector 'messageOnlyLetters' only letter elements of the 'message' variable. 
//--------------------------------------------------------------------------------------------------------------
void tth::getMessage(string messageP)
{
    message = messageP;
    messageLength = message.length();

    for(int i = 0; i < messageLength; i++)
    {
        if(isalpha(message[i]))
        {
            messageOnlyLetters.push_back(message[i]);
        }
    }
}

//--------------------------------------------------------------------------------------------------------------
// setMessageOnlyLettersNumberOf16Blocks()
//--------------------------------------------------------------------------------------------------------------
// A public function of the tth class.
// Pads the messageOnlyLetters vector with a number 'A' elements equal to modulo 16 of the size of the vector.
// Sets the private int variable 'messageOnlyLettersNumberOf16Blocks' to the quotient of the vector size and 16.
//--------------------------------------------------------------------------------------------------------------
void tth::setMessageOnlyLettersNumberOf16Blocks()
{
    int messageOnlyLettersModulo = messageOnlyLetters.size() % 16;

    while(messageOnlyLettersModulo != 0)
    {
        messageOnlyLetters.push_back('A');
        messageOnlyLettersModulo = messageOnlyLetters.size() % 16;
    }

    messageOnlyLettersNumberOf16Blocks = messageOnlyLetters.size() / 16;
}

//--------------------------------------------------------------------------------------------------------------
// encryptMessageOnlyLetters()
//--------------------------------------------------------------------------------------------------------------
// A public function of the tth class.
// Executes the 'setMessageOnlyLettersNumberOf16Blocks()' once.
// Executes other functions of the tth class a number of times equal to 'messageOnlyLettersNumberOf16Blocks'.
//--------------------------------------------------------------------------------------------------------------
void tth::encryptMessageOnlyLetters()
{
    setMessageOnlyLettersNumberOf16Blocks();

    for (int i = 0; i < messageOnlyLettersNumberOf16Blocks; i++)
    {
        messageOnlyLettersToFourByFourLetters();
        matchLetterToNumber();
        calculateAndShowRunningTotalFourByFourNumbers();
        cout << endl;
        shiftRowsAccordingly();
        calculateAndShowRunningTotalTemp();
        cout << endl;
        matchNumberToLetter();
        showFourLetterHashNumbers();
        cout << endl;
    }
}

//--------------------------------------------------------------------------------------------------------------
// messageOnlyLettersToFourByFourLetters()
//--------------------------------------------------------------------------------------------------------------
// A public function of the tth class.
// Sets the elements of the private char 2D array 'fourByFourLetters' to the elements of 'messageOnlyLetters'.
// Reduces the size of a non-empty messageOnlyLetters by 16 elements.
//--------------------------------------------------------------------------------------------------------------
void tth::messageOnlyLettersToFourByFourLetters()
{
    int count = 0;

    for(int i = 0; i < 4; i++)
    {
        for(int j = 0; j < 4; j++)
        {
            fourByFourLetters[i][j] = messageOnlyLetters[count];
            count++;
        }
    }

    if(!(messageOnlyLetters.empty()))
    {
        messageOnlyLetters.erase(messageOnlyLetters.begin(), messageOnlyLetters.begin() + 16);
    }
}

//--------------------------------------------------------------------------------------------------------------
// matchLetterToNumber()
//--------------------------------------------------------------------------------------------------------------
// A public function of the tth class.
// Sets the elements of the private int 2D array 'fourByFourNumbers' to a number 0 - 25.
// The number is determined by the ASCII value of a 'fourByFourLetters' element.
//--------------------------------------------------------------------------------------------------------------
void tth::matchLetterToNumber()
{
    for(int i = 0; i < 4; i++)
    {
        for(int j = 0; j < 4; j++)
        {
            switch(static_cast<int>(fourByFourLetters[i][j]))
            {
                case 65:
                case 97:
                    fourByFourNumbers[i][j] = 0;
                    break;
                case 66:
                case 98:
                    fourByFourNumbers[i][j] = 1;
                    break;
                case 67:
                case 99:
                    fourByFourNumbers[i][j] = 2;
                    break;
                case 68:
                case 100:
                    fourByFourNumbers[i][j] = 3;
                    break;
                case 69:
                case 101:
                    fourByFourNumbers[i][j] = 4;
                    break;
                case 70:
                case 102:
                    fourByFourNumbers[i][j] = 5;
                    break;
                case 71:
                case 103:
                    fourByFourNumbers[i][j] = 6;
                    break;
                case 72:
                case 104:
                    fourByFourNumbers[i][j] = 7;
                    break;
                case 73:
                case 105:
                    fourByFourNumbers[i][j] = 8;
                    break;
                case 74:
                case 106:
                    fourByFourNumbers[i][j] = 9;
                    break;
                case 75:
                case 107:
                    fourByFourNumbers[i][j] = 10;
                    break;
                case 76:
                case 108:
                    fourByFourNumbers[i][j] = 11;
                    break;
                case 77:
                case 109:
                    fourByFourNumbers[i][j] = 12;
                    break;
                case 78:
                case 110:
                    fourByFourNumbers[i][j] = 13;
                    break;
                case 79:
                case 111:
                    fourByFourNumbers[i][j] = 14;
                    break;
                case 80:
                case 112:
                    fourByFourNumbers[i][j] = 15;
                    break;
                case 81:
                case 113:
                    fourByFourNumbers[i][j] = 16;
                    break;
                case 82:
                case 114:
                    fourByFourNumbers[i][j] = 17;
                    break;
                case 83:
                case 115:
                    fourByFourNumbers[i][j] = 18;
                    break;
                case 84:
                case 116:
                    fourByFourNumbers[i][j] = 19;
                    break;
                case 85:
                case 117:
                    fourByFourNumbers[i][j] = 20;
                    break;
                case 86:
                case 118:
                    fourByFourNumbers[i][j] = 21;
                    break;
                case 87:
                case 119:
                    fourByFourNumbers[i][j] = 22;
                    break;
                case 88:
                case 120:
                    fourByFourNumbers[i][j] = 23;
                    break;
                case 89:
                case 121:
                    fourByFourNumbers[i][j] = 24;
                    break;
                case 90:
                case 122:
                    fourByFourNumbers[i][j] = 25;
                    break;
                default:
                    cout << "Hmmmm";
            }
        }
    }
}

//--------------------------------------------------------------------------------------------------------------
// calculateAndShowRunningTotalFourByFourNumbers()
//--------------------------------------------------------------------------------------------------------------
// A public function of the tth class.
// Calculates and sets the elements of 'runningTotal' using an accumulator with 'fourByFourNumbers'.
// Displays a command line message with each element of 'runningTotal'.
//--------------------------------------------------------------------------------------------------------------
void tth::calculateAndShowRunningTotalFourByFourNumbers()
{
    cout << endl;
    for(int i = 0; i < 4; i++)
    {
        for(int j = 0; j < 4; j++)
        {
            runningTotal[i] = runningTotal[i] + fourByFourNumbers[j][i];
        }

        runningTotal[i] = runningTotal[i] % 26;
        cout << runningTotal[i] << " ";
    }
}

//--------------------------------------------------------------------------------------------------------------
// shiftRowsAccordingly()
//--------------------------------------------------------------------------------------------------------------
// A public function of the tth class.
// Sets the elements of the private int 2D array 'temp' to a rearranged version of 'fourByFourNumbers'.
// Elements of rows 1 - 3 are shifted in a circular pattern.
// Row 1 elements are shifted to the left by 1 index. Row 2 elements are shifted to the left by 2 indicies.
// Row 3 elements are shifted to the left by 3 indicies. Row 4 elements are swapped: 1 <> 4 and 2 <> 3.
//--------------------------------------------------------------------------------------------------------------
void tth::shiftRowsAccordingly()
{
    for(int i = 0; i < 4; i++)
    {
        for(int j = 0; j < 4; j++)
        {
            if(i == 0)
            {
                if(j == 3)
                {
                    temp[i][j] = fourByFourNumbers[i][j - 3];
                }
                else
                {
                    temp[i][j] = fourByFourNumbers[i][j + 1];
                }
            }
            else if(i == 1)
            {
                if(j == 2)
                {
                    temp[i][j] = fourByFourNumbers[i][j - 2];
                }
                else if(j == 3)
                {
                    temp[i][j] = fourByFourNumbers[i][j - 2];
                }
                else
                {
                    temp[i][j] = fourByFourNumbers[i][j + 2];
                }
            }
            else if(i == 2)
            {
                if(j == 1)
                {
                    temp[i][j] = fourByFourNumbers[i][j - 1];
                }
                else if(j == 2)
                {
                    temp[i][j] = fourByFourNumbers[i][j - 1];
                }
                else if(j == 3)
                {
                    temp[i][j] = fourByFourNumbers[i][j - 1];
                }
                else
                {
                    temp[i][j] = fourByFourNumbers[i][j + 3];
                }
            }
            else
            {
                if(j == 1)
                {
                    temp[i][j] = fourByFourNumbers[i][j + 1];
                }
                else if(j == 2)
                {
                    temp[i][j] = fourByFourNumbers[i][j - 1];
                }
                else if(j == 3)
                {
                    temp[i][j] = fourByFourNumbers[i][j - 3];
                }
                else
                {
                    temp[i][j] = fourByFourNumbers[i][j + 3];
                }
            }
        }
    }
}

//--------------------------------------------------------------------------------------------------------------
// calculateAndShowRunningTotalTemp()
//--------------------------------------------------------------------------------------------------------------
// A public function of the tth class.
// Calculates and sets the elements of 'runningTotal' using an accumulator with 'temp'.
// Displays a command line message with each element of 'runningTotal'.
//--------------------------------------------------------------------------------------------------------------
void tth::calculateAndShowRunningTotalTemp()
{
    for(int i = 0; i < 4; i++)
    {
        for(int j = 0; j < 4; j++)
        {
            runningTotal[i] = runningTotal[i] + temp[j][i];
        }

        runningTotal[i] = runningTotal[i] % 26;
        cout << runningTotal[i] << " ";
    }
}

//--------------------------------------------------------------------------------------------------------------
// matchNumberToLetter()
//--------------------------------------------------------------------------------------------------------------
// A public function of the tth class.
// Sets the elements of the private char 2D array 'fourLetterHash' to a letter A - Z.
// The letter is determined by the value of a 'runningTotal' element.
//--------------------------------------------------------------------------------------------------------------
void tth::matchNumberToLetter()
{
    for(int i = 0; i < 4; i++)
    {
        switch(runningTotal[i])
        {
            case 0:
                fourLetterHash[i] = 'A';
                break;
            case 1:
                fourLetterHash[i] = 'B';
                break;
            case 2:
                fourLetterHash[i] = 'C';
                break;
            case 3:
                fourLetterHash[i] = 'D';
                break;
            case 4:
                fourLetterHash[i] = 'E';
                break;
            case 5:
                fourLetterHash[i] = 'F';
                break;
            case 6:
                fourLetterHash[i] = 'G';
                break;
            case 7:
                fourLetterHash[i] = 'H';
                break;
            case 8:
                fourLetterHash[i] = 'I';
                break;
            case 9:
                fourLetterHash[i] = 'J';
                break;
            case 10:
                fourLetterHash[i] = 'K';
                break;
            case 11:
                fourLetterHash[i] = 'L';
                break;
            case 12:
                fourLetterHash[i] = 'M';
                break;
            case 13:
                fourLetterHash[i] = 'N';
                break;
            case 14:
                fourLetterHash[i] = 'O';
                break;
            case 15:
                fourLetterHash[i] = 'P';
                break;
            case 16:
                fourLetterHash[i] = 'Q';
                break;
            case 17:
                fourLetterHash[i] = 'R';
                break;
            case 18:
                fourLetterHash[i] = 'S';
                break;
            case 19:
                fourLetterHash[i] = 'T';
                break;
            case 20:
                fourLetterHash[i] = 'U';
                break;
            case 21:
                fourLetterHash[i] = 'V';
                break;
            case 22:
                fourLetterHash[i] = 'W';
                break;
            case 23:
                fourLetterHash[i] = 'X';
                break;
            case 24:
                fourLetterHash[i] = 'Y';
                break;
            case 25:
                fourLetterHash[i] = 'Z';
                break;
            default:
                cout << "Hmmmm";
        }
    }
}

//--------------------------------------------------------------------------------------------------------------
// showFourLetterHashNumbers()
//--------------------------------------------------------------------------------------------------------------
// A public function of the tth class.
// Displays a command line message with each element of 'fourLetterHash'.
//--------------------------------------------------------------------------------------------------------------
void tth::showFourLetterHashNumbers()
{
    for(int i = 0; i < 4; i++)
    {
        cout << fourLetterHash[i] << " ";
    }
} 
```

# 编辑

嘎。我在这篇文章中付出了很多努力，只是为了发现这是一个简单的命令行编译问题。感谢您的回答。

## 回答

使用下面的命令编译定义文件和主程序文件。

```
cl tth.cpp useTTH.cpp 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T01:35:50.903

您忘记在编译器命令中包含所有源文件。由于`tth.cpp`不包括在内，它找不到与那里定义的函数/变量对应的符号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T01:39:26.787

![在此处输入图像描述](../Images/b68db7ede4db120069f41a0b774409d4.png)您应该同时编译`tth.cpp`和`useTTH.cpp`

使用命令行：

`cl tth.cpp useTTH.cpp`

# doctrine-orm - 学说 2 多对一关系中的单表继承

> ID：15079808
> 
> 赞同：2
> 
> 时间：2013-02-26T01:33:37.227
> 
> 标签：doctrine-orm

我正在使用一个遗留数据库（基于 osCommerce 并且受到严重黑客攻击），其中包含一个名为 orders_total 的表，定义如下：

```
CREATE TABLE `orders_total` (
  `orders_total_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `orders_id` int(11) unsigned NOT NULL DEFAULT '0',
  `title` varchar(255) NOT NULL,
  `text` varchar(255) NOT NULL,
  `value` decimal(15,4) NOT NULL DEFAULT '0.0000',
  `class` varchar(40) NOT NULL,
  `sort_order` int(11) NOT NULL DEFAULT '0',
  PRIMARY KEY (`orders_total_id`),
  KEY `idx_order_id` (`orders_id`)
); 
```

“类”列定义了该行所代表的“总计”类型。有点乱，有些“总数”根本不是总数，而是附加费，有些是折扣。一个例子：

```
+-----------------+-----------+--------------+----------+-----------+----------------------+------------+
| orders_total_id | orders_id | title        | text     | value     | class                | sort_order |
+-----------------+-----------+--------------+----------+-----------+----------------------+------------+
| 781797          | 190000    | Sub-Total:   | $1427.29 | 1427.2916 | ot_subtotal          | 1          |
| 781798          | 190000    | Courier:     | $172.05  | 172.0500  | ot_shipping          | 2          |
| 781799          | 190000    | Insurance:   | $47.62   | 47.6200   | ot_insurance         | 3          |
| 781800          | 190000    | Visa/MC Fee: | $41.80   | 41.8000   | ot_surcharge_visa_mc | 4          |
| 781801          | 190000    | <b>Total:</b>| $1688.76 | 1688.7616 | ot_total             | 10         |
+-----------------+-----------+--------------+----------+-----------+----------------------+------------+ 
```

我想做的是使用单表继承将表类拆分为 OrderTotal、OrderCharge 和 OrderDiscount 实体，然后通过与 Order 实体的一对多关系能够提取每个集合。我尝试了以下方法：

```
<?php

namespace Shop\Entity;

use Application\Entity\BaseEntity;
use Doctrine\ORM\Mapping as ORM;

/**
 * @ORM\InheritanceType("SINGLE_TABLE")
 * @ORM\DiscriminatorColumn(name="class", type="string")
 * @ORM\DiscriminatorMap({
 * "ot_cc_surcharge" = "OrderCharge",
 * "ot_coupon" = "OrderDiscount", 
 * "ot_insurance" = "OrderCharge",
 * "ot_payment_surcharge" = "OrderCharge",
 * "ot_paypal_surcharge" = "OrderCharge",
 * "ot_shipping" = "OrderCharge",
 * "ot_subtotal" = "OrderTotal", 
 * "ot_surcharge" = "OrderCharge", 
 * "ot_surcharge_amex" = "OrderCharge", 
 * "ot_surcharge_paypal" = "OrderCharge", 
 * "ot_surcharge_visa_mc" = "OrderCharge",
 * "ot_total" = "OrderTotal"
 * })
 * @ORM\Table(name="orders_total")
 * 
 */
class OrderTotalBase extends BaseEntity {
/*....*/
}

/**
 * @ORM\Entity
 * @ORM\Table(name="orders_total")
 */
class OrderCharge extends OrderTotalBase {
}

/**
 * @ORM\Entity
 * @ORM\Table(name="orders_total")
 */
class OrderTotal extends OrderTotalBase {
}

/**
 * @ORM\Entity
 * @ORM\Table(name="orders_total")
 */
class OrderDiscount extends OrderTotalBase {
}

/*....*/
class Order {
/*....*/
    /**
     * @ORM\OneToMany(targetEntity="OrderTotal", mappedBy="order", fetch="EAGER")
     * @var PersistentCollection
     */
    protected $orderTotals;

    /**
     * @ORM\OneToMany(targetEntity="OrderCharge", mappedBy="order", fetch="EAGER")
     * @var PersistentCollection
     */
    protected $orderCharges;

    /**
     * @ORM\OneToMany(targetEntity="OrderDiscount", mappedBy="order", fetch="EAGER")
     * @var PersistentCollection
     */
    protected $orderDiscounts;
} 
```

然后将各自的 getter 和 setter 添加到 Order 类中。

问题是，当我调用 时`$order->getOrderCharges()`，它首先将整个记录列表作为`OrderCharge`对象返回。当我打电话时，`$order->getOrderTotals()`我得到完全相同的结果，但有`OrderTotal`对象。

STI 是否允许我仅根据 @DiscriminatorMap 获取正确的对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T09:14:04.593

虽然（如上所述）您的映射无效，但有一种方法可以根据 DQL 中的鉴别器列获取继承中的所有实体：

```
SELECT r FROM RootEntity r WHERE r INSTANCE OF SubType 
```

或者只需使用 DQL 选择正确的类型：

```
SELECT e FROM SubType e 
```

对于您的`OrderTotal`情况，该关联应该是

```
/**
 * @ORM\OneToMany(targetEntity="OrderTotal", mappedBy="totalOrder")
 * @var \Doctrine\Common\Collections\Collection
 */
protected $orderTotals; 
```

一旦你修复了你的映射并且 CLI 验证器确认它（`orm:validate-schema`），该集合将被正确过滤

# shake-build-system - 将抖动扩展到作为配置工具是否也可行？

> ID：15079810
> 
> 赞同：4
> 
> 时间：2013-02-26T01:33:43.047
> 
> 标签：shake-build-system

在木偶/厨师的脉络中；我真的很想将 Shake 用于本地构建之外。我认为 Shake 的原理足够抽象（虽然我没有深入了解），它可以用作更大的配置构建工具的基础。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T08:05:40.077

*免责声明：除了快速阅读项目网站和维基百科之外，我对 Chef/Puppet 了解不多。*

我认为依赖原则足够抽象，甚至没有内置文件规则之类的东西。您可能希望为配置类型创建许多自定义规则实例。

然而，除了依赖系统之外，Puppet/Chef 似乎还有很多需要重新实现的部分。Shake 可以作为构建工具的基础，但仍有相当多的代码需要编写。

# php - 留言簿中回复的多个表情符号

> ID：15079816
> 
> 赞同：1
> 
> 时间：2013-02-26T01:34:12.390
> 
> 标签：php, javascript, database, forms

我为回复留言簿中的评论添加了表情符号

当我想用此代码回复 1 条评论时，它工作正常：

```
if (isset($_GET['action']) && $_GET["action"] == "reply" ) {
    $commentrpl = substr(stripEmails(strip_tags($_POST["txtreply"])), 0, 250);

    $rpl_arr = array(
        "O:-)" => "<img src=\"".DOC_ROOT."images/sml/aa.gif\"\/>",
        ":-)"  => "<img src=\"".DOC_ROOT."images/sml/ab.gif\"\/>",
        ":-("  => "<img src=\"".DOC_ROOT."images/sml/ac.gif\"\/>",
    );

    $commentrpl  = strtr($commentrpl, $rpl_arr);
    $osDB->query('UPDATE ! SET reply = ? WHERE id = ?', array( 
        COMMENTS_TABLE, 
        $commentrpl, 
        $_REQUEST["commentid"] 
    ));
} 
```

但是，一旦有更多需要回复的评论，表情符号将不再起作用。（不可点击）我需要更改什么，以便对于每个回复我都可以使用表情符号。

这也是可能是问题的一段javascript。

```
function smile4( txt ) {
    doInsert(" " + txt + " ", "", false, document.getElementById('txtreply'));
} 
```

形式：

```
<form name="reply" method="post" action="showprofile.php?id={$profileid}&amp;commentid={$item.id}&amp;action=reply">
    <textarea id="txtreply" name="txtreply" cols="50" rows="5"></textarea>
    <img src="images/sml/aa.gif" onclick="smile4('O:-)');" alt="O:-)">
    <input type="submit" name="btnAdd" value="{lang mkey='send'}" /> 
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T16:45:26.237

而不是 strstr 使用 str_replace 像这样的东西：

```
$smiles = array(
    ':-)' => '<img ...>',
    ...
);

$comment = str_replace(array_keys($smiles), array_values($smiles), $comment); 
```

除此之外，最好在显示评论/回复时进行替换，而不是在将其保存到数据库时进行替换。

# windows - 当我使用 QEMU 在我的 MAC 计算机上由 virtualbox 创建的 Ubuntu 来宾中打开 Windows XP 来宾时看不到鼠标

> ID：15079822
> 
> 赞同：1
> 
> 时间：2013-02-26T01:34:37.070
> 
> 标签：windows, qemu

首先在我的 MAC(OSX) 上，我使用 virtualbox 创建一个 Ubuntu 来宾。然后在 Ubuntu 中，我使用 root 使用命令创建一个 Windows XP 来宾：

```
./qemy-system-i386 -monitor stdio -m 512 -netdev user,id=mynet -device rtl8139,netdev=mynet <Windows Image file> 
```

但是在我进入Windows之后，我几乎看不到我的鼠标！但是，在QEMU窗口中，我看到了“QEMU Press Ctl-Alt to exit mouse grab”，所以看起来应该已经正确地抓住了鼠标。但我看不到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T02:03:03.123

我自己找到了答案。解决方案是在 VirtualBox 中禁用鼠标集成：>

# macos - 在 Xcode 中使用 FreeImage

> ID：15079823
> 
> 赞同：1
> 
> 时间：2013-02-26T01:34:43.403
> 
> 标签：macos, compiler-errors, dylib, freeimage

我正在编写一个应用程序，我想在其中使用免费图像来加载文件。我在 MacOSX 10.8.2 上，并且正在使用免费映像的 mac 端口版本。我让它工作，但是当我尝试将它放在另一台没有端口的计算机上时，它不会运行，因为它没有文件。macports版本自带dylib，不下载port可以用它来运行吗？如果可以的话，我将如何将它与项目一起编译，因为我已尝试将其链接为二进制库，但我无法包含这些文件。任何帮助将不胜感激，因为我已经在这几个小时了。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-12T03:16:58.067

您实际上可以将 FreeImage 库构建为静态库。不幸的是，来自[http://freeimage.sourceforge.net/download.html](http://freeimage.sourceforge.net/download.html)网站的可下载源使用了预期使用旧版 Xcode3 SDK 的 makefile。

我实际上使用 10.7 SDK 更新了 Makefile.osx 以使用 Xcode4 构建并将更改发布到[https://gist.github.com/AhiyaHiya/5105571](https://gist.github.com/AhiyaHiya/5105571)

您应该能够从 Terminal.app 运行此 make 并根据需要创建 .dylib 和 .a 文件。

# wcf - 为什么 WCF 在使用安全性时会导致通道出错？

> ID：15079826
> 
> 赞同：4
> 
> 时间：2013-02-26T01:35:07.553
> 
> 标签：wcf, wcf-binding, wcf-faults

**背景：**

我注意到在我的 WCF 服务中，当我抛出一个异常（一个普通的旧异常）时，客户端通道进入故障状态并且必须中止并重新创建，然后我才能在该通道上进行另一个调用。没关系。这就是它的意图。我得到它。因此，如果需要再次调用，我只需调用 abort() 并重新创建。

但是，仅当我使用启用了安全性的绑定时才会发生客户端通道故障。当我使用 basicHttpBinding 时，我可以在客户端上得到一个异常，然后继续使用 ServiceClient 对象而不告诉我它处于“故障状态”。

此外，当我关闭 wsHttpBinding 或 netTcpBinding 的安全性时，我可以在出现异常后重新使用通道。

**问题：**

绑定的安全性是什么导致通道出错，因此无法使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T21:01:09.980

这是因为使用 Security，您正在设置一个安全**会话**。当您退出该会话时，通道将进入故障状态，您必须中止它并创建一个新状态。使用 BasicHttpBinding，不会进行任何会话。

# ruby-on-rails - Rails 嵌套资源创建 - 传递用户 ID

> ID：15079827
> 
> 赞同：0
> 
> 时间：2013-02-26T01:35:13.217
> 
> 标签：ruby-on-rails

我有一组由*用户*、*书籍*和*章节*组成的嵌套资源。这是它的外观。

**楷模**

```
class User
  has_many :books, dependent: :destroy
  accepts_nested_attributes_for :books, allow_destroy: true
end

class Book
  belongs_to :user
  has_many :chapters, dependent: :destroy
  accepts_nested_attributes_for :chapters, allow_destroy: true
end

class Chapter
  belongs_to :book
end 
```

**章节控制器**

```
def create
    @chapter = @book.chapters.build(params[:chapter])
    if @chapter.save
        flash[:success] = "A new chapter created!"
        redirect_to blah blah
    else
        render 'new'
    end
end

protected

    def get_book
        @book = Book.find(params[:chapter][:book_id]) || 
                         Book.find(params[:book_id])
    end 
```

你可能想知道为什么我有那个受保护的方法。我试图让用户在单独的页面中创建章节和书籍，并且仍然可以方便地使用嵌套资源。因此，用户可以在章节创建页面上创建章节，并通过关联表单将章节与正确的书关联起来。

目前我被卡住了，因为章节资源没有获得它需要的用户 ID。我对 Web 开发非常陌生，所以我可能会在这里做一些疯狂的事情。任何帮助将不胜感激。我真的很想让这个工作。

编辑：为了更详细地说明我所说的“章节资源没有获得它需要的用户 ID” - 在章节模型中我写了 *validates ：user_id，presence：true*。当我在章节创建页面上按下提交按钮时，它会给出一个错误，提示 user_id 不能为空。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T02:55:44.843

我认为`Chapter`模型不应该检查`user_id`是否存在。相反，控制器应该有一个 before_filter 来检查该操作是否对当前用户授权。

像这样的东西：

```
class ChaptersController < ApplicationController
  before_filter :authorized?, only: [:create]

  def create
    ...
  end

  private
    def authorized?
      current_user && current_user.owns? Chapter.find(params[:id])
    end
end 
```

`owns?`然后将在 User 模型上`current_user`实现，并将在`ApplicationController`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T03:25:37.620

为了确保当前用户拥有该章，因此拥有这本书，将`get_book`方法更改为

```
def get_book
  @book = current_user.books.find(params.fetch(:chapter, {})[:book_id] || params[:book_id])
end 
```

`params.fetch`确保您不会在何时出现`params[:chapter]`异常`nil`

# c++ - c ++向量的预期主要表达式错误

> ID：15079828
> 
> 赞同：0
> 
> 时间：2013-02-26T01:35:16.510
> 
> 标签：c++, vector

我很难调试这小段代码。我得到的错误是：'错误：'='令牌之前的预期主表达式。有人可以指出我正确的方向吗？谢谢。

```
for(int i = 1+a.size(); i> =1; i=i+2)   // should be i>=1;
    {
        out_stream_dob << a[i] << endl;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T01:36:27.933

看到 和 之间的空间了`>`吗`=`？你不想要那个空间：

```
for (int i = a.size() - 1; i >= 1; i = i - 2) // Also mind your initialization and step!
{
    out_stream_dob << a[i] << endl;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T01:36:15.220

您的运算符`> =`位于中间表达式中，因此它被解析为两个单独的运算符。应该是`>=`。

# asp.net-mvc - 使用 AWS .NET SDK 的示例 SNS 订阅确认

> ID：15079829
> 
> 赞同：8
> 
> 时间：2013-02-26T01:35:20.557
> 
> 标签：asp.net-mvc, vb.net, amazon-web-services, amazon-sns

我试图弄清楚如何使用 AWS .NET SDK 来确认订阅 SNS 主题。

订阅是通过 HTTP

端点将位于 .net mvc 网站中。

我在任何地方都找不到任何 .net 示例？

一个工作的例子会很棒。

我正在尝试这样的事情

```
 Dim snsclient As New Amazon.SimpleNotificationService.AmazonSimpleNotificationServiceClient(ConfigurationSettings.AppSettings("AWSAccessKey"), ConfigurationSettings.AppSettings("AWSSecretKey"))

    Dim TopicArn As String = "arn:aws:sns:us-east-1:991924819628:post-delivery"

    If Request.Headers("x-amz-sns-message-type") = "SubscriptionConfirmation" Then

        Request.InputStream.Seek(0, 0)
        Dim reader As New System.IO.StreamReader(Request.InputStream)
        Dim inputString As String = reader.ReadToEnd()

        Dim jsSerializer As New System.Web.Script.Serialization.JavaScriptSerializer
        Dim message As Dictionary(Of String, String) = jsSerializer.Deserialize(Of Dictionary(Of String, String))(inputString)

        snsclient.ConfirmSubscription(New Amazon.SimpleNotificationService.Model.ConfirmSubscriptionRequest With {.AuthenticateOnUnsubscribe = False, .Token = message("Token"), .TopicArn = TopicArn})

   End If 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2015-05-27T18:16:55.527

这是一个使用 MVC WebApi 2 和最新 AWS .NET SDK 的工作示例。

```
var jsonData = Request.Content.ReadAsStringAsync().Result;
var snsMessage = Amazon.SimpleNotificationService.Util.Message.ParseMessage(jsonData);

//verify the signaure using AWS method
if(!snsMessage.IsMessageSignatureValid())
    throw new Exception("Invalid signature");

if(snsMessage.Type == Amazon.SimpleNotificationService.Util.Message.MESSAGE_TYPE_SUBSCRIPTION_CONFIRMATION)
{
    var subscribeUrl = snsMessage.SubscribeURL;
    var webClient = new WebClient();
    webClient.DownloadString(subscribeUrl);
    return "Successfully subscribed to: " + subscribeUrl;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-05-18T01:35:44.937

基于上面@Craig 的回答（这对我有很大帮助），下面是一个用于消费和自动订阅SNS 主题的ASP.NET MVC WebAPI 控制器。#WebHooksFTW

```
using RestSharp;
using System;
using System.Net;
using System.Net.Http;
using System.Reflection;
using System.Web.Http;
using System.Web.Http.Description;

namespace sb.web.Controllers.api {
  [System.Web.Mvc.HandleError]
  [AllowAnonymous]
  [ApiExplorerSettings(IgnoreApi = true)]
  public class SnsController : ApiController {
    private static string className = MethodBase.GetCurrentMethod().DeclaringType.Name;

    [HttpPost]
    public HttpResponseMessage Post(string id = "") {
      try {
        var jsonData = Request.Content.ReadAsStringAsync().Result;
        var sm = Amazon.SimpleNotificationService.Util.Message.ParseMessage(jsonData);
        //LogIt.D(jsonData);
        //LogIt.D(sm);

        if (!string.IsNullOrEmpty(sm.SubscribeURL)) {
          var uri = new Uri(sm.SubscribeURL);
          var baseUrl = uri.GetLeftPart(System.UriPartial.Authority);
          var resource = sm.SubscribeURL.Replace(baseUrl, "");
          var response = new RestClient {
            BaseUrl = new Uri(baseUrl),
          }.Execute(new RestRequest {
            Resource = resource,
            Method = Method.GET,
            RequestFormat = RestSharp.DataFormat.Xml
          });
          if (response.StatusCode != System.Net.HttpStatusCode.OK) {
            //LogIt.W(response.StatusCode);
          } else {
            //LogIt.I(response.Content);
          }
        }

        //read for topic: sm.TopicArn
        //read for data: dynamic json = JObject.Parse(sm.MessageText);
        //extract value: var s3OrigUrlSnippet = json.input.key.Value as string;

        //do stuff
        return Request.CreateResponse(HttpStatusCode.OK, new { });
      } catch (Exception ex) {
        //LogIt.E(ex);
        return Request.CreateResponse(HttpStatusCode.InternalServerError, new { status = "unexpected error" });
      }
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-02-22T10:42:27.883

我不知道最近这种情况发生了怎样的变化，但我发现 AWS SNS 现在提供了一种非常简单的订阅方法，它不涉及使用 RESTSharp 提取 url 或构建请求.....这是简化的 WebApi POST 方法：

```
 [HttpPost]
    public HttpResponseMessage Post(string id = "")
    {
        try
        {
            var jsonData = Request.Content.ReadAsStringAsync().Result;
            var sm = Amazon.SimpleNotificationService.Util.Message.ParseMessage(jsonData);

            if (sm.IsSubscriptionType)
            {
                sm.SubscribeToTopic(); // CONFIRM THE SUBSCRIPTION
            }
            if (sm.IsNotificationType) // PROCESS NOTIFICATIONS
            {
                //read for topic: sm.TopicArn
                //read for data: dynamic json = JObject.Parse(sm.MessageText);
                //extract value: var s3OrigUrlSnippet = json.input.key.Value as string;
            }

            //do stuff
            return Request.CreateResponse(HttpStatusCode.OK, new { });
        }
        catch (Exception ex)
        {
            //LogIt.E(ex);
            return Request.CreateResponse(HttpStatusCode.InternalServerError, new { status = "unexpected error" });
        }
    } 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-26T14:13:04.323

以下示例帮助我使用 SNS。它经历了使用主题的所有步骤。在这种情况下，订阅请求是一个电子邮件地址，但是可以将其更改为 HTTP。

[Pavel 的 SNS 示例](https://stackoverflow.com/a/13016803/1742975)
[文档](http://docs.aws.amazon.com/sns/latest/gsg/SendMessageToHttp.html)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-28T01:57:04.950

我最终使用显示的代码让它工作。我在开发服务器上捕获异常时遇到问题，结果告诉我服务器的时间与 SNS 消息中的时间戳不匹配。

一旦服务器的时间确定（顺便说一句亚马逊服务器），确认工作。

# signal-processing - 为什么在 1Hz 正弦波的 FFT 输出中，1Hz 幅度表现得像正弦波？

> ID：15079839
> 
> 赞同：1
> 
> 时间：2013-02-26T01:36:19.730
> 
> 标签：signal-processing, fft, frequency, spectrum

我一直在 .NET 中开发一个小软件，它实时从传感器获取信号并获取该信号的 FFT，该信号也实时显示。

我已将 alglib 库用于 FFT 函数。现在我的目的是及时观察某个特定频率的强度。

为了检查软件，我为其输入提供了一个频率为 1 Hz 的正弦波。下图显示了软件的屏幕截图。上图显示了在 1 Hz 处显示峰值的频谱。然而，当及时观察到这个峰值时，如下图所示，强度表现为正弦波。

![在此处输入图像描述](../Images/a776656ab2ed49f5cedbafd4e903d3db.png)

我的采样频率是 30kHz。我不明白的是我是如何得到这个正弦信号的，为什么频率的幅度会这样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T17:49:29.627

这是[Windowing](https://en.wikipedia.org/wiki/Window_function)效果的一个示例。它源于这样一个事实，即除了处理完美的周期性信号外， FFT*不是一种精确的操作。*当您将信号窗口化时，您会将其变成可能*无法*完美重复的较小块。FFT 算法计算*这块*音频的频谱，无限重复。由于它不是完美的正弦波，因此您无法获得结果的准确值。此外，我们可以看到，如果您的窗口不能与您的信号频率的倍数完美对齐，那么它将相对于您的信号发生相移，窗口会捕获稍微不同的信号块，并且 FFT 会计算*不同*的光谱*无限重复的信号。如果你仔细想想，这个相位差自然也是周期性的，因为窗口会*赶上*你信号的下一个周期。*

 *然而，这只能解释强度的较小变化。假设您在底部图表的轴上使用了正确的标签（您应该仔细检查），那么还有其他问题。您的窗口可能太小（尽管我希望不会，因为那样您会看到更多的光谱出血）。我刚刚想到的另一种可能性是，您可能只是在绘制 FFT 的*实*部，而不是*幅度*。随着相位的变化，实际和复杂的部分可能会有所不同，但您希望*幅度*保持大致相同。*

# python - os.path.isfile 替代

> ID：15079840
> 
> 赞同：0
> 
> 时间：2013-02-26T01:36:24.007
> 
> 标签：python, python-2.7

我遇到了 os.path.isfile 的问题，例如，以下代码是我程序的一部分：

```
for a in args:
    if not os.path.isfile(a):
        print _("Error: File not found: %(name)s  Ignoring...") % {'name': a}
    else:
        self.isup.queue(a) 
```

如果我运行，我的主文件夹中有名为“box9.png”的文件：

```
% echo $PWD
/home/<username>
% /usr/bin/program-name box9.png
Error: File not found: box9.png  Ignoring... 
```

但以下工作：

```
% echo $PWD
/home/<username>
% /usr/bin/program-name ~/box9.png
[program continue...] 
```

有人能帮我吗 ？

我正在使用 Python 2.7

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T20:47:40.817

在@JF Sebastian 的帮助下，我解决了我的问题......

/usr/bin/pyis-uploader 是一个 shell 脚本，它包含：

```
#!/bin/sh
cd /usr/lib/pyis-uploader/
python2 pyis_uploader.py $@ 
```

我替换为：

```
#!/bin/sh
python2 /usr/lib/pyis-uploader/pyis_uploader.py $@ 
```

现在按预期工作！

谢谢，对不起我糟糕的英语。

# zend-framework2 - MVC 路由和 url 查看助手

> ID：15079843
> 
> 赞同：0
> 
> 时间：2013-02-26T01:36:24.183
> 
> 标签：zend-framework2

我有一个关于 MVC 路由的问题。

我在 module.config.php 中设置了我的路由，如下所示：

```
'router' => array(
'routes' => array(
    'album' => array(
        'type'    => 'segment',
        'options' => array(
            'route'    => '/album[/page/:page]',
            'constraints' => array(
                'page'   => '[0-9]+',
            ),
            'defaults' => array(
                'controller' => 'Trade\Controller\Album',                                       
                'action'     => 'index',
                'page'       => 1,
            ),
        ),
        'may_terminate' => true,
        'child_routes' => array(
            'default' => array(
                'type'    => 'segment',
                'options' => array(
                    'route'    => '[/:action][/:id]',
                    'constraints' => array(
                        'action' => '[a-zA-Z][a-zA-Z0-9_-]*',
                        'id'     => '[0-9]+',
                    ),
                ),
            ),
        ),
    ), 
```

有如下路线：

```
/album
/album/page/2
/album/edit/3
/album/add 
```

在视图脚本中，我使用：

```
<a href="<?php echo $this->url('album/default', array('action'=>'edit', 'id' => $album->id));?>">Edit</a> 
```

这导致

```
/album/page/1/edit/2 
```

这不是我希望 url 看起来的样子。我希望网址看起来像 /album/edit/3

并且由于我没有在 url 参数数组中提供页码，因此我没想到会选择默认页面。

我确信有一种更智能的方法来设置所需的路由，并且会感谢任何指针。

彼得

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T17:47:51.567

**在module.config.php**中更改您的路由，如下所示

```
'router' => array(
    'routes' => array(
        'album' => array(
            'type'    => 'Literal',
            'options' => array(
                'route'    => '/album',
                'defaults' => array(
                    'controller' => 'Trade\Controller\Album',
                    'action' => 'index',
                ),
            ),
            'may_terminate' => true,
            'child_routes' => array(
                'add' => array(
                    'type' => 'Literal',
                    'options' => array(
                        'route' => '/add',
                        'defaults' => array(
                            'action' => 'addalbum',
                        ),
                    ),
                ),
                'edit' => array(
                    'type' => 'Segment',
                    'options' => array(
                        'route' => '/edit[/:id]',
                        'constraints' => array(
                            'id' => '[0-9]+',
                        ),
                        'defaults' => array(
                            'action' => 'editalbum',
                        ),
                    ),
                ),
                'page' => array(
                    'type' => 'Segment',
                    'options' => array(
                        'route' => '/page[/:id]',
                        'constraints' => array(
                            'id' => '[0-9]+',
                        ),
                        'defaults' => array(
                            'action' => 'pagealbum',
                        ),
                    ),
                ),
            ),
        ),
    ),
), 
```

现在将视图脚本中的链接更改为

```
<a href="<?php echo $this->url('album/edit', array('id'=>$album->id)); ?>">Edit</a> 
```

你的路线现在没问题了。

# javascript - knockoutjs 绑定问题

> ID：15079845
> 
> 赞同：0
> 
> 时间：2013-02-26T01:36:30.080
> 
> 标签：javascript, internet-explorer, knockout.js, knockout-2.0, knockout-mvc

我的 knockoutjs 实现存在问题。似乎在 Chrome 和 Safari 上运行良好 IE 和 FF 都非常适合。

我遇到的消息如下：

> 无法解析绑定。消息：TypeError：'AccountName' 未定义；绑定值：值：AccountName

该问题发生在用作淘汰模板的脚本标记中：

```
<div id="newAccountDialog" class="dialog" data-bind="dialog: { autoOpen: false, resizable: false, modal: true, width: 350, title: 'Exchange Account'}, template: { name: 'dialogFormTemplate', data: CurrentAccount }, openDialog: IsNew"></div>

<script id="dialogFormTemplate" type="text/html">
    <form id="dialogForm">
        <h1>Exchange Account Manager</h1>
        <p>Add new or edit an existing exchange account settings.</p>
        <label for="AccountName">
            Account
        </label>
        <input id="AccountName" name="AccountName" type="text" data-bind="value: AccountName, valueUpdate: 'afterkeydown'" class="ui-widget-content ui-corner-all" />
        <div class="buttonsContainer floatRight">
            <button id="Save" data-bind="click: $root.SaveAccount, dialogcmd: { id: 'newAccountDialog', cmd: 'close'}, jqButton: { icons: { primary: 'ui-icon-disk' } }">Save & Close</button>
        </div>
    </form>
</script> 
```

我假设在模板上触发了某种早期绑定

> 数据：当前帐户

其中一个 undefined / null 被传递到 CurrentAccount。我在脚本标签之外看到了这个问题，但前提是未定义可观察对象或为空。

我的视图模型如下所示：

```
 var AccountModel = function () {
    var self = this;

    self.Accounts = ko.observableArray([]);
    self.CurrentAccount = ko.observable(null);
    self.IsNew = ko.observable(false);

    self.LoadAccounts = function () {
        $account.invoke("GetAccounts", {}, function (data) {
            var mapped = $.map(data, function (item) {
                var account = new Account(item);
                var innerMapped = $.map(item.Mailboxes, function (mailbox) {
                    return new Mailbox(mailbox);
                });
                account.Mailboxes(innerMapped);
                return account;
            });
            self.Accounts(mapped);
        });
    }

    self.EditAccount = function (data) {
        self.CurrentAccount(data);
        self.IsNew(true);
    }

    self.SaveAccount = function () {
        if (self.CurrentAccount().Id() <= 0) {
            $account.invoke('AddAccount', ko.toJS(self.CurrentAccount()), function (data) {
                self.Accounts.push(new Account(data));
                self.CurrentAccount(new Account(data));
                self.IsNew(true);
            });
        } else {
            $account.invoke('UpdateAccount', ko.toJS(self.CurrentAccount()), function (data) {
                //self.CurrentAccount(new Account(data));
            });
        }
    }

    self.CreateAccount = function () {
        self.IsNew(true);
        var account = { Id: 0, AccountName: '', IsNTLM: -1, Email: '', Password: '', Domain: 'mydomain', ExchangeVersion: 1, Mailboxes: [] };
        self.CurrentAccount(new Account(account));
    }
}; 
```

我的对话框 bindingHandler 定义如下：

```
ko.bindingHandlers.dialog = {
    init: function (element, valueAccessor) {
        var options = ko.utils.unwrapObservable(valueAccessor()) || {};
        ko.utils.domNodeDisposal.addDisposeCallback(element, function () {
            $(element).dialog('destroy');
        });
        $(element).dialog(options);
    }
}; 
```

我省略了 Account 对象，因为在这种情况下可能不需要它。

我将不胜感激任何帮助。

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T02:33:29.237

Knockout 中没有“早期”绑定。当你调用时，一切都被绑定了`ko.applyBindings`。但是某些绑定可以停止或延迟其后代元素的绑定。`template`当您使用`if`or`ifnot`选项时是其中之一。在您的情况下，您可以使用如下`if`选项：

```
template: { name: 'dialogFormTemplate', data: CurrentAccount, 'if': CurrentAccount } 
```

`if`注意：在一些较旧的浏览器中需要引号。

# matlab - gmdistribution.fit 和 .mat 文件

> ID：15079846
> 
> 赞同：1
> 
> 时间：2013-02-26T01:36:30.393
> 
> 标签：matlab, mat-file

我有一个非常大的 .mat 文件，其中包含我需要可视化的大量数据。.mat 文件包含 5 行，每行包含 1x5 矩阵 - 其中包含数据。我需要将特定行连接在一起，然后对其应用 gmdistribution.fit。我不确定我如何准确访问 .mat 文件的特定元素以将它们连接在一起。

假设我希望将第一行 - > 第一行与第二行 - > 第一行连接起来。我该怎么做呢？我是 matlab 新手，很难掌握它。

另外，您能解释一下 gmdistribution.fit 吗？我阅读了他们网站上的文档，但是，我仍然不确定参数。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T02:15:04.353

要访问第一行：

```
matrix(1); 
```

要访问第二行：

```
matrix(2); 
```

要将第一行和第二行垂直连接成一个新矩阵：

```
newMatrix = [matrix(1) ; matrix(2)]; 
```

您可以对矩阵中的任何行执行此操作。

至于 gmdistribution.fit，它只是试图将您的矩阵拟合到高斯分布。如果没有更具体的问题，我所能做的就是将您指向[文档](http://www.mathworks.com/help/stats/gmdistribution.fit.html)，其中包含并解释了所有参数。

# java - JGraphX 中的 JTree

> ID：15079851
> 
> 赞同：0
> 
> 时间：2013-02-26T01:36:56.553
> 
> 标签：java, jgraphx

在 EditorPalette 中，模板使用 JLabels 表示，可以在 mxGraphComponent 中拖放，对吧？

但是，我想通过JTree使用层次结构将这些模板添加到EditorPalette中，并且节点不能像普通模板那样在GraphComponents中拖放

您能否通过提供添加模板的功能来帮助我，以便在组件左侧添加 JTree 并在 mxGraphComponent 上拖放？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-30T18:34:49.390

好的，我明白了。我的错误是，我必须创建一个 mxCell 提供几何信息，所以而不是

```
mxCell cell = new mxCell(component); 
```

在上面的代码中我必须写

```
mxCell cell = new mxCell(component, new mxGeometry(), ""); 
```

添加拖动功能的完整方法如下所示：

```
public void addComponentTabListeners() {
    final JTree componentTree = view.componentTree;

    DragGestureListener dragGestureListener = new DragGestureListener() {
        @Override
        public void dragGestureRecognized(DragGestureEvent arg0) {
            TreePath path = componentTree.getSelectionPath();
            if ((path == null) || (path.getPathCount() <= 1)) {
                return;
            }
            DefaultMutableTreeNode componentsNode = (DefaultMutableTreeNode) path.getLastPathComponent();
            I_Component component = null;
            try {
                component = ComponentHandler_KonsensApplication.getInstance().createInstance(
                        componentsNode.toString(), "need unique Name here");
            } catch (ClassNotFoundException e) {
                e.printStackTrace();
            } catch (InstantiationException e) {
                e.printStackTrace();
            } catch (IllegalAccessException e) {
                e.printStackTrace();
            }
            mxCell cell = new mxCell(component, new mxGeometry(), "");

            cell.setVertex(true);
            mxRectangle bounds = new mxRectangle();
            bounds.setHeight(80);
            bounds.setWidth(80);
            mxGraphTransferable t = new mxGraphTransferable(new Object[] { cell }, bounds);
            arg0.startDrag(null, mxSwingConstants.EMPTY_IMAGE, new Point(), t, null);
        }
    };

    DragSource dragSource = new DragSource();
    dragSource.createDefaultDragGestureRecognizer(componentTree, DnDConstants.ACTION_COPY,
            dragGestureListener);
} 
```

# ios - 在 obj-c 中使用参数初始化

> ID：15079855
> 
> 赞同：2
> 
> 时间：2013-02-26T01:37:32.280
> 
> 标签：ios, objective-c, cocoa-touch

我处于必须`init`使用参数创建的情况。

```
- (id) initWithSomeParameter:(id)parameter; 
```

`init`不应调用Normal 。所以，我有两个选择来完成这个。当有人调用`init`or return时，我实际上可以抛出异常`nil`。

应该做什么，为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T01:46:38.250

您应该有一个**指定的初始化程序**，所有其他`init`方法都会调用它。

在您的示例中，指定的初始化程序可能是

```
- (id)initWithSomeParameter:(id)something; 
```

如果另一个程序员调用`-(id)init`而不是指定的初始化程序，您可能会执行以下操作：

```
- (id)init
{
    return [self initWithSomeParameter:nil];
} 
```

如果您绝对**必须**为 提供一个值`someParameter`，那么您可以选择引发异常，但这种做法会随着实例对象初始化时获取值的重要性而有所不同。

以下是 Apple 关于使用指定初始化程序的意见：

[http://developer.apple.com/library/ios/#documentation/general/conceptual/DevPedia-CocoaCore/MultipleInitializers.html](http://developer.apple.com/library/ios/#documentation/general/conceptual/DevPedia-CocoaCore/MultipleInitializers.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-26T01:53:35.590

在不了解您的用例的情况下很难说。但是，也许您对 API 过于严格。

`UIKit`本身充满了需要一些数据来操作的类，但在初始化时不需要它。举个`UIImageView`例子。你可能会认为“一个*图像*视图需要一个*图像*来做任何事情，因此我应该在初始化时需要一个*图像！”。*然而，这里的这个片段是一个完全有效的用例：

```
UIImageView *foo = [[UINavigationController alloc] init];
foo.image = [UIImage imageNamed:@"bar"]; 
```

在这里，我们创建一个图像视图，并在第二步中分配图像本身。因此，当您尝试以需要数据的方式使用对象时，如果该数据不存在，则会引发异常。

* * *

此外，您指定的初始化程序通常是通常采用最多参数的初始化程序，其余的则调用该初始化程序。像这样的东西可能是你想要的更多。

```
- (id)init {
    // call this class's designated initializer
    return [self initWithSomething:nil];
}

// this class's designated initializer
- (id)initWithSomething:(NSString*)something {
    self = [super init]; // call superclass's designated initializer
    if (self) {
        // this class's setup code goes here, saving any arguments
        somethingInstanceVar = something;
    }
    return self;
}

// some other method.
- (NSString*)doSomething {
  if (somethingInstanceVar) {
    // all is well, do stuff
    return somethingInstanceVar;
  } else {
    // never got a "something" raise an exception
    [NSException raise:@"Missing data" format:@"Something is required!"];
  }
} 
```

# php - PHP $_GET 不适合我

> ID：15079858
> 
> 赞同：0
> 
> 时间：2013-02-26T01:37:44.423
> 
> 标签：php

我有如下代码：

```
<?php 
require 'database/db.php';
if($_SERVER["REQUEST_METHOD"] == "POST") {
   $name = $_POST["userid"];
   $password = $_POST["password"];
   if (empty($name) || empty($password)) {
      header("Location : AdminLogin.php?status=failure");
       exit();
    }
   $count = verifyUser($name, $password);
    if($count == 1 )
     {
        header("Location : AdminLogin.php?status=success");
      }
    else {
        header("Location : AdminLogin.php?status=failure");
      }

   exit;
}
?>
<?php include('inc/header.php'); ?>
  <div class = "section page">
    <div class ="wrapper">
      <div class="page-header">
        <b>Admin Login </b>
      </div>
      <?php if(isset($_GET["status"]) AND $_GET["status"]=="success") { ?>
        <p> Your login was a success .. I will redirect you to another page.</p>
      <?php } else {?>
      <form method="post" class="form-signin" action="AdminLogin.php">
        <h2 class="form-signin-heading">Sign In</h2>
        <input type="text" name ="userid" class="input-block-level" placeholder="UserID...">
        <input type="password" name ="password" class="input-block-level" placeholder="Password...">
        <button class="btn btn-large btn-primary" type="submit">Sign in</button>
      </form>
        <?php } ?>
    </div>
  </div>

<?php include('inc/footer.php'); ?> 
```

一旦我点击登录按钮，我就会在服务器端对用户进行验证，并返回一个 int（应该是 bool，我同意）登录是否成功。

我正在重定向到同一页面。

发现 ...

我已验证 $count 已正确返回。即如果用户名和密码匹配 count = 1 否则 count !=1 。到目前为止，一切都很好。我也注意到它在那之后失败了。

谢谢加根

编辑：验证用户（这只是一个存根）

```
function verifyUser($username, $password)
{
    return  strcmp ( $username , $password )
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T01:45:29.267

尝试删除之后的多余空间`Location`：

```
... header("Location : ...
                    ^ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T01:47:17.550

您没有显示 verifyUser()，它是否返回“真实”的机会？因为您正在测试它是否为真/布尔值。

# android - 在 UrlImageViewHelper 库中投射异常，同时尝试投射 BitmapDrawable

> ID：15079860
> 
> 赞同：0
> 
> 时间：2013-02-26T01:37:48.667
> 
> 标签：android, urlimageviewhelper

我正在使用由 Koushik Dutta (Koush) 开发的 UrlImageViewHelper 库。这是我正在做的

1.  将图像从 url 加载到位于 gridview 内的 imageview 中。
2.  图像加载工作完美，速度非常快。

我正在尝试将加载在 imageview 中的图像保存为墙纸，但它崩溃并引发了投射异常。

**编码**

```
UrlViewImageHelper.setURLDrawable(imageView,"some url here");
Bitmap bitmap = ((BitmapDrawable)imageView.getDrawable()).getBitmap(); 
```

**上面的行抛出了这个异常**

```
02-26 06:54:07.987: E/AndroidRuntime(19659): java.lang.ClassCastException: com.koushikdutta.urlimageviewhelper.UrlImageViewHelper$ZombieDrawable 
```

如何将 imageView 中的图像作为位图获取？我究竟做错了什么？

我知道我可以使用其他一些库，例如 Android Universal Image Loader（尚未尝试过）、SmartImageView（好但慢），但 koush 的库非常快速且易于使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T07:05:18.623

URLViewImageHelper downloads the image in separate thread asynchronously, hence at the point you call imageView.getDrawable(), the image not loaded yet.

What u can try is to register a callback object to be notified when image finished loading:

```
UrlViewImageHelper.setURLDrawable(imageView,url, defaultResource, new UrlImageViewCallback() {
    @Override
    public void onLoaded(ImageView imageView, Bitmap loadedBitmap, String url, boolean loadedFromCache) {
        // your method here
        Bitmap bitmap = ((BitmapDrawable)imageView.getDrawable()).getBitmap();

    }
}) ; 
```

# python - 我的 def 函数有什么问题？如何解决？

> ID：15079862
> 
> 赞同：1
> 
> 时间：2013-02-26T01:37:57.933
> 
> 标签：python, string, list, function

数据为：[('1985-08', '15.00'), ('1985-08', '14.88'), ('1985-08', '15.25'), ('1985-08', '15.25 '), ('1985-08', '15.13'), ('1985-08', '14.75'), ('1985-08', '14.88'), ('1985-08', '15.25') , ('1985-08', '15.25'), ('1985-08', '15.00'), ('1985-08', '14.63'), ('1985-08', '14.50'), ( '1985-08', '14.63'), ('1985-08', '15.25'), ('1985-08', '15.00'), ('1985-08', '15.25'), ('1985 -08', '15.13'), ('1985-08', '14.88'), ('1985-08', '15.25'), ('1985-08', '15.38'), ('1985-08' ', '15.75'), ('1985-08', '15.88'), ('1985-07', '15.88'), ('1985-07', '16.25'), ('1985-07', '16.00'), ('1985-07', '16.62'), ('1985- 07', '16.62'), ('1985-07', '16.25'), ('1985-07', '16.50'), ('1985-07', '16.87'), ('1985-07' , '17.37'), ('1985-07', '17.25'), ('1985-07', '17.62'), ('1985-07', '17.50'), ('1985-07', ' 17.75'), ('1985-07', '17.87'), ('1985-07', '18.00'), ('1985-07', '18.00'), ('1985-07', '17.62' ), ('1985-07', '17.62'), ('1985-07', '17.62'), ('1985-07', '17.50'), ('1985-07', '17.25'), ('1985-07', '18.12')]('1985-07', '16.25'), ('1985-07', '16.00'), ('1985-07', '16.62'), ('1985-07', '16.62'), (' 1985-07', '16.25'), ('1985-07', '16.50'), ('1985-07', '16.87'), ('1985-07', '17.37'), ('1985- 07', '17.25'), ('1985-07', '17.62'), ('1985-07', '17.50'), ('1985-07', '17.75'), ('1985-07' , '17.87'), ('1985-07', '18.00'), ('1985-07', '18.00'), ('1985-07', '17.62'), ('1985-07', ' 17.62'), ('1985-07', '17.62'), ('1985-07', '17.50'), ('1985-07', '17.25'), ('1985-07', '18.12' )]('1985-07', '16.25'), ('1985-07', '16.00'), ('1985-07', '16.62'), ('1985-07', '16.62'), (' 1985-07', '16.25'), ('1985-07', '16.50'), ('1985-07', '16.87'), ('1985-07', '17.37'), ('1985- 07', '17.25'), ('1985-07', '17.62'), ('1985-07', '17.50'), ('1985-07', '17.75'), ('1985-07' , '17.87'), ('1985-07', '18.00'), ('1985-07', '18.00'), ('1985-07', '17.62'), ('1985-07', ' 17.62'), ('1985-07', '17.62'), ('1985-07', '17.50'), ('1985-07', '17.25'), ('1985-07', '18.12' )]16.00'), ('1985-07', '16.62'), ('1985-07', '16.62'), ('1985-07', '16.25'), ('1985-07', '16.50' ), ('1985-07', '16.87'), ('1985-07', '17.37'), ('1985-07', '17.25'), ('1985-07', '17.62'), ('1985-07', '17.50'), ('1985-07', '17.75'), ('1985-07', '17.87'), ('1985-07', '18.00'), (' 1985-07', '18.00'), ('1985-07', '17.62'), ('1985-07', '17.62'), ('1985-07', '17.62'), ('1985- 07', '17.50'), ('1985-07', '17.25'), ('1985-07', '18.12')]16.00'), ('1985-07', '16.62'), ('1985-07', '16.62'), ('1985-07', '16.25'), ('1985-07', '16.50' ), ('1985-07', '16.87'), ('1985-07', '17.37'), ('1985-07', '17.25'), ('1985-07', '17.62'), ('1985-07', '17.50'), ('1985-07', '17.75'), ('1985-07', '17.87'), ('1985-07', '18.00'), (' 1985-07', '18.00'), ('1985-07', '17.62'), ('1985-07', '17.62'), ('1985-07', '17.62'), ('1985- 07', '17.50'), ('1985-07', '17.25'), ('1985-07', '18.12')]('1985-07', '16.50'), ('1985-07', '16.87'), ('1985-07', '17.37'), ('1985-07', '17.25'), (' 1985-07', '17.62'), ('1985-07', '17.50'), ('1985-07', '17.75'), ('1985-07', '17.87'), ('1985- 07', '18.00'), ('1985-07', '18.00'), ('1985-07', '17.62'), ('1985-07', '17.62'), ('1985-07' , '17.62'), ('1985-07', '17.50'), ('1985-07', '17.25'), ('1985-07', '18.12')]('1985-07', '16.50'), ('1985-07', '16.87'), ('1985-07', '17.37'), ('1985-07', '17.25'), (' 1985-07', '17.62'), ('1985-07', '17.50'), ('1985-07', '17.75'), ('1985-07', '17.87'), ('1985- 07', '18.00'), ('1985-07', '18.00'), ('1985-07', '17.62'), ('1985-07', '17.62'), ('1985-07' , '17.62'), ('1985-07', '17.50'), ('1985-07', '17.25'), ('1985-07', '18.12')]17.75'), ('1985-07', '17.87'), ('1985-07', '18.00'), ('1985-07', '18.00'), ('1985-07', '17.62' ), ('1985-07', '17.62'), ('1985-07', '17.62'), ('1985-07', '17.50'), ('1985-07', '17.25'), ('1985-07', '18.12')]17.75'), ('1985-07', '17.87'), ('1985-07', '18.00'), ('1985-07', '18.00'), ('1985-07', '17.62' ), ('1985-07', '17.62'), ('1985-07', '17.62'), ('1985-07', '17.50'), ('1985-07', '17.25'), ('1985-07', '18.12')]

我的代码：

```
def average_data(list_of_tuples):
strMonth = []
counter = 0
addition = 0
while True:
    if (strMonth[counter])[0] == (strMonth[counter+1])[0]:    #line 31
        addition += float(strMonth[counter][1])
        result2 = addition
    else:
        continue
print(result2)
return result2
def main(): 
    file_obj = get_input_descriptor()
    column = int(input('What column:'))
    get_data_list(file_obj, column)
    result2 =get_data_list(file_obj, column)

average_data(result2)
file_obj.close()
main() 
```

Python Shell 的错误代码：

```
 File "C:\Users\admin\Desktop\proj.py", line 31, in average_data
if (strMonth[counter])[0] == (strMonth[counter+1])[0]:
IndexError: list index out of range 
```

它有什么问题？我想得到每个月的总数。有没有其他方法可以解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T01:39:19.043

`strMonth`是空的。它没有第 0 个元素，因此`strMonth[counter]`引发`IndexError`：

```
In [29]: strMonth = []

In [30]: counter = 0

In [31]: strMonth[counter]
IndexError: list index out of range 
```

* * *

您可以使用 a `dict`（或[collections.defaultdict](http://docs.python.org/2/library/collections.html#collections.defaultdict)）将 yearmonth 字符串映射到表示值总和的浮点数。

```
import collections
def average_data(strMonth):
    result = collections.defaultdict(float)
    for yearmonth, val in strMonth:
        result[yearmonth] += float(val)
    return dict(result)

def main(): 
    result2 = [('1985-08', '15.00'), ('1985-08', '14.88'), ('1985-08', '15.25'), ('1985-08', '15.25'), ('1985-08', '15.13'), ('1985-08', '14.75'), ('1985-08', '14.88'), ('1985-08', '15.25'), ('1985-08', '15.25'), ('1985-08', '15.00'), ('1985-08', '14.63'), ('1985-08', '14.50'), ('1985-08', '14.63'), ('1985-08', '15.25'), ('1985-08', '15.00'), ('1985-08', '15.25'), ('1985-08', '15.13'), ('1985-08', '14.88'), ('1985-08', '15.25'), ('1985-08', '15.38'), ('1985-08', '15.75'), ('1985-08', '15.88'), ('1985-07', '15.88'), ('1985-07', '16.25'), ('1985-07', '16.00'), ('1985-07', '16.62'), ('1985-07', '16.62'), ('1985-07', '16.25'), ('1985-07', '16.50'), ('1985-07', '16.87'), ('1985-07', '17.37'), ('1985-07', '17.25'), ('1985-07', '17.62'), ('1985-07', '17.50'), ('1985-07', '17.75'), ('1985-07', '17.87'), ('1985-07', '18.00'), ('1985-07', '18.00'), ('1985-07', '17.62'), ('1985-07', '17.62'), ('1985-07', '17.62'), ('1985-07', '17.50'), ('1985-07', '17.25'), ('1985-07', '18.12')]
    print(average_data(result2))
main() 
```

产量

```
{'1985-07': 378.08000000000004, '1985-08': 332.16999999999996} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T02:39:15.770

蟒蛇3.2

```
 M=List_of_tuples

  sum(int(m.split("-")[1]) for m,t in M) 
```

# ios - UIImageOrientation 到 CIDetectorImageOrientation

> ID：15079864
> 
> 赞同：4
> 
> 时间：2013-02-26T01:38:11.990
> 
> 标签：ios, orientation, face-detection

用于检测图像中的人脸，您需要根据`CIDetector`文档指定恰好在 TIFF 和 EXIF 规范中指定的图像方向，这意味着它不同于`UIImageOrientation`. 谷歌为我找到了下面的功能，我试过了，但发现它似乎不正确，或者我可能错过了其他东西，因为有时方向是关闭的。有谁知道发生了什么？似乎一旦从 iDevice 导出照片，然后将其导入另一个 iDevice，方向信息就会丢失/更改，从而导致一些方向不匹配。

```
- (int) metadataOrientationForUIImageOrientation:(UIImageOrientation)orientation
{
    switch (orientation) {
        case UIImageOrientationUp: // the picture was taken with the home button is placed right
            return 1;
        case UIImageOrientationRight: // bottom (portrait)
            return 6;
        case UIImageOrientationDown: // left
            return 3;
        case UIImageOrientationLeft: // top
            return 8;
        default:
            return 1;
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-03-24T18:46:24.217

为了涵盖所有这些，并且在没有幻数分配的情况下这样做（CGImagePropertyOrientation 的原始值*可能*会在未来发生变化，尽管这不太可能......仍然是一个好习惯），您应该包含 ImageIO 框架并使用实际常量：

```
#import <ImageIO/ImageIO.h>
- (CGImagePropertyOrientation)CGImagePropertyOrientation:(UIImageOrientation)orientation
{
    switch (orientation) {
        case UIImageOrientationUp:
            return kCGImagePropertyOrientationUp;
        case UIImageOrientationUpMirrored:
            return kCGImagePropertyOrientationUpMirrored;
        case UIImageOrientationDown:
            return kCGImagePropertyOrientationDown;
        case UIImageOrientationDownMirrored:
            return kCGImagePropertyOrientationDownMirrored;
        case UIImageOrientationLeftMirrored:
            return kCGImagePropertyOrientationLeftMirrored;
        case UIImageOrientationRight:
            return kCGImagePropertyOrientationRight;
        case UIImageOrientationRightMirrored:
            return kCGImagePropertyOrientationRightMirrored;
        case UIImageOrientationLeft:
            return kCGImagePropertyOrientationLeft;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-05-26T12:41:06.363

在斯威夫特 4

```
func inferOrientation(image: UIImage) -> CGImagePropertyOrientation {
  switch image.imageOrientation {
  case .up:
    return CGImagePropertyOrientation.up
  case .upMirrored:
    return CGImagePropertyOrientation.upMirrored
  case .down:
    return CGImagePropertyOrientation.down
  case .downMirrored:
    return CGImagePropertyOrientation.downMirrored
  case .left:
    return CGImagePropertyOrientation.left
  case .leftMirrored:
    return CGImagePropertyOrientation.leftMirrored
  case .right:
    return CGImagePropertyOrientation.right
  case .rightMirrored:
    return CGImagePropertyOrientation.rightMirrored
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-18T05:08:49.287

斯威夫特 4：

```
func convertImageOrientation(orientation: UIImageOrientation) -> CGImagePropertyOrientation  {
    let cgiOrientations : [ CGImagePropertyOrientation ] = [
        .up, .down, .left, .right, .upMirrored, .downMirrored, .leftMirrored, .rightMirrored
    ]

    return cgiOrientations[orientation.rawValue]
} 
```

# iis - IIS 可以记录 url 的子域部分吗？

> ID：15079865
> 
> 赞同：3
> 
> 时间：2013-02-26T01:38:15.377
> 
> 标签：iis, logging, iis-7

我有一个由 IIS 提供的网站。日志记录已打开，我得到如下信息：

`2013-02-26 00:23:16 ::1 GET /Test/TestPage.html <snip>`

但是我每个客户都有一个子域，因此 a.mydomain.com 和 b.mydomain.com 都指向（通过 CNAME）相同的安装并提供相同的文件（但我有显示不同数据的代码）。

我想要的是能够说客户 a 访问网站 x 次并下载了 y 但客户 b 访问了 z 次（等等）。

但是 a.mydomain.com 似乎没有被记录并且看起来我无法打开它。

是否有可能获得这些信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T02:45:34.887

是的，您可以通过打开 IIS 管理器，单击日志记录，然后单击“选择字段”按钮并选择主机 (cs-host) 来启用它。

如果你想要命令行版本看起来像：

```
%windir%\system32\inetsrv\appcmd.exe set config -section:system.applicationHost/sites /siteDefaults.logFile.logExtFileFlags:"Date, Time, ClientIP, UserName, SiteName, ServerIP, Method, UriStem, UriQuery, HttpStatus, Win32Status, TimeTaken, ServerPort, UserAgent, Referer, Host, HttpSubStatus" 
```

请注意，这将为所有站点更改它（因为它修改了 siteDefaults 部分），但如果需要，您可以使其仅应用于特定站点。

# java - java中的构造函数帮助

> ID：15079868
> 
> 赞同：-2
> 
> 时间：2013-02-26T01:38:38.953
> 
> 标签：java, constructor

处理一项任务，我在弄清楚如何正确制作构造函数并成功制作对象时遇到了问题。

```
public class CDAssignment {

    public CD(String artist, String title){
        artist = "Awesomeguy";
        title = "AwesomeCDName";
        tracklist myTracklist = new tracklist(100);
    }

    public static void main(String[] args) {
        CD myCD = new CD("Awesomeguy", "AwesomeCDName");
        String artist;
        String title;
    }
} 
```

我现在有一些其他方法，但它们无关紧要。我将为 tracklist 构造函数创建另一个类。我知道该怎么做。我的程序一直告诉我，我没有该方法的返回类型，但我没有尝试创建方法，而是尝试创建构造函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T01:39:46.407

构造函数必须与类本身具有相同的名称**编辑：并且您应该为成员分配参数**：

```
 public CDAssignment(String artist, String title){
        this.artist = artist;
        this.title = title;
        tracklist myTracklist = new tracklist(100);
    } 
```

然后主要是：

```
CDAssignment myCD = new CDAssignment("Awesomeguy", "AwesomeCDName"); 
```

此外，如果您想成为`artist`类`title`的成员变量，则需要从任何函数中声明它们。

```
public class CDAssignment {

    String artist;
    String title; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T01:40:19.190

您的构造函数需要与您的类具有相同的名称：

```
public class CDAssignment {

    public CDAssignment(String artist, String title){  // <-- note change
        artist = "Awesomeguy";
        title = "AwesomeCDName";
        tracklist myTracklist = new tracklist(100);
    }

    public static void main(String[] args) {
        CD myCD = new CD("Awesomeguy", "AwesomeCDName");
        String artist;
        String title;
    }
} 
```

# iphone - Objective C，如何将 M_PI (PI) 值获取到 8 个位置（即 3.14159265）？

> ID：15079869
> 
> 赞同：-1
> 
> 时间：2013-02-26T01:38:48.550
> 
> 标签：iphone, ios, objective-c

Objective C，如何将 M_PI (PI) 值获取到 8 个位置（即 3.14159265）？

```
double result = M_PI; // result value will be 3.14159 
```

结果需要是3.14159265，为什么它返回的派系很少？

**注意：**当我将 3.14159265 分配给双倍结果时，它会丢失最后 3 个派系，我需要将它们取回并传递有价值的结果。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-26T01:42:46.527

没那么难

```
double result = 3.14159265; 
```

# sorting - 对文本文件列中的多个值进行计数和排序

> ID：15079874
> 
> 赞同：0
> 
> 时间：2013-02-26T01:39:33.470
> 
> 标签：sorting, count, awk, grep, text-files

我想筛选文本文件以查找可疑活动。我有点熟悉 bash 脚本，包括 grep、sed 和 awk。我对 stackoverflow.com、tldp.org 等的研究以及与同事的交谈表明 perl 和 python 最适合我的任务，但我对这些脚本语言的经验为零。

欢迎使用各种脚本、编译或解释语言输入。由于我的限制，请在代码中添加注释，使我能够快速理解和学习语言。

好的，任务是对按列排序的项目进行排序和计数。我 / 可以 / 使用 grep、awk 和 sed 完成其中的一部分。不幸的是，递归方面（我认为这个问题）让我很难过。

输入文本已排序，两列 ip 地址（在下面的示例中进行了简化）和一列用于目标端口（所有可能的值）。这个文件的大小可能是几兆字节，但一次可能永远不会超过 250MB，因此不需要绝对的效率。简单是。

```
SIP        DIP        DPt
111.100    200.150    80
111.100    200.150    443
111.100    200.155    22
111.100    200.155    80
111.100    200.155    443
111.100    200.160    80
111.100    200.165    139
111.100    200.165    443
111.100    200.165    512
115.102    225.150    80
115.102    225.150    137
115.102    225.150    443
120.125    250.175    23
120.135    250.145    23
125.155    250.165    80
125.155    250.165    139
125.155    250.175    1023 
```

我正在工作的代码（从内存中起草......目前不在我的 linux 机器上）类似于这个......

```
#!/bin/bash

declare -i counter=0
SIP=null       # current source ip.
SIP_last=null  # for last ip address processed.
SIP_next=null  # not found a use for this, yet. 
               # sorting usually reqs three vars, so here it is.

for SIP in `zcat textfile.gz | awk '{ if ($3 <1024) print $1,$2,$3}'` do
# Ensure I count the first item.  This was problematic at first.
if [[ "$SIP_last" == null ]] then
SIP_last=$SIP
counter=counter+1  # counter=+ didn't work reliably.

# Do something useful.  As shown, it works.
if [[ "$SIP" == "$SIP_last" ]] then
counter=counter+1

if [[ "$SIP != "$SIP_last" ]] then
echo SIP: $SIP_last     Counter: $counter   # DIP code has not yet been added.
SIP_last=$SIP

# Ensure I always catch the last item.  Still working on this issue.
# XXX

done 
```

使用上面提供的输入，输出应该看起来像这样......

```
SIP      DIP Ct   Ports
         > 2      < 1024
111.100  200.150  80, 443
111.100  200.155  20, 80, 443
111.100  200.165  139, 443, 512
115.102  225.150  80, 137, 443 
```

查看输出，您可以看到问题的症结在于仅报告 DIP 计数 > 2 和端口 < 1024。使用提供的 awk 语句将端口限制为 < 1024 非常简单。它将 DIP 与 SIP 匹配，并保持 DPts 的运行记录，这是最重要的。

同样，这是来自记忆，所以请原谅编码错误。感谢你的协助。

艾伦。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T02:20:04.223

使用您发布的示例输入文件：

```
$ awk '
NR==1 { print; next }
$3 < 1024 {
   key = $1 "\t" $2
   if (!seen[key,$3]++) {
      cnt[key]++
      vals[key] = vals[key] sep[key] $3
      sep[key] = ", "
   }
}
END { for (key in cnt) if (cnt[key] > 1) print key "\t" vals[key] }
' file
SIP        DIP        DPt
111.100 200.155 22, 80, 443
111.100 200.165 139, 443, 512
125.155 250.165 80, 139
115.102 225.150 80, 137, 443
111.100 200.150 80, 443 
```

如果这不是你要找的，请澄清。

# algorithm - 从中心开始用较小的矩形填充大矩形的算法

> ID：15079877
> 
> 赞同：3
> 
> 时间：2013-02-26T01:40:00.537
> 
> 标签：algorithm, geometry, greedy, knapsack-problem

我有各种大小的矩形，我试图将它们从中心开始放入一个更大的矩形中。您将在下面找到我创建的动画，以直观地描述需要发生的事情。

我一直在努力想出一种方法来模拟这种行为。是否存在与此类似的东西？我只需要指出正确的方向。

![在此处输入图像描述](../Images/d4af572a1324ff5ad8a60c3bf40beb04.png)

下面是一个非常粗略的解释：

**初始化**

*   `n`从矩形开始
*   按密度排序（它们实际上是 3d 立方体*鸟瞰图*）
*   将第一个矩形放在中心

**剩余的矩形（尽可能多地适合）** 尝试将最高密度分组在中心并向外移动

```
Dimensions = { width: 400, height: 300 }
Boundries = {
  WEST = 0,
  EAST = Dimensions.width,
  NORTH = 0,
  SOUTH = Dimensions.height
}

// each rectangle has width, height, and other information
rectArr = Array of {width:60, height:40}

root = { x:EAST/2, y:SOUTH/2 }

foreach rect in rectArr {
  // I will always traverse from the root and try to go left and right. If I cannot, I move up and try the same thing. I then move down. The problem is if there are 5 or more rows. I will be starting from the root and going up, then down, then up-up, then down. It's like I have two parallel trees.

  // Try to branch left or right
  if rect.width <= (Boundries.EAST - ('rightmost rectangle'.x + 'rightmost rectangle'.width/2)) branch-right
  if rect.width <= (('leftmost rectangle'.x + 'leftmost rectangle'.width/2) - Boundries.WEST) branch-left
  // Try to branch up or down
  if rect.height <= ((root.x + root.height/2) - Boundries.NORTH) branch-up
  if rect.height <= (Boundries.SOUTH - (root.x + root.height/2)) branch-down
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T02:32:24.170

编辑：开始写这个太早了。此解决方案仅适用于用尽可能多的小矩形填充较大的矩形，假设较小的矩形的位置是静态的。

听起来动态编程解决方案在这里效果最好；如果您还没有研究过算法，我建议您研究贪婪算法的定义、动态规划算法的定义、每种类型的示例，以及在哪里使用一种而不是另一种。

这个问题与加权调度问题非常相似，但是是二维的。在加权调度中，给定一个区间和一组子区间，并要求确定总权重最大且范围不重叠的子区间集：

```
|--------------------------|
|{--a--}-------------------|
|----{------b-------}------|
|--------{----c----}-------|
|--------------------{-d-}-| 
```

如果我们将其扩展到二维，较大的区间将是边界矩形的 x/y 长度，子区间将是较小矩形的 x/y 长度，子区间的权重是较小矩形的面积.

在贪心算法中，我们会尝试用尽可能多的最大子矩形填充边界矩形，然后尝试填充尽可能多的第二大子矩形，然后是第三大矩形，依此类推，直到没有一个矩形适合. 问题在于，当使用 1 个最大的子矩形时，您最终填充的边界矩形可能比使用 4 个第二大的子矩形时要少（想想我们有一个边长为 6 的边界正方形的情况，最大的子正方形的边长为 5，第二大子正方形的边长为 3)。看起来您的初始解决方案可能会遇到同样的问题。

动态规划解决方案将较大的问题分解为重叠的子问题，然后根据子问题的结果构建解决方案。对于矩形，您想对集合中的每个矩形提出相同的问题：当我将它包含在我的解决方案中或不将它包含在我的解决方案中时，结果会更好吗？根据对这个问题的回答，您可以将该矩形添加到您的解决方案集中并删除与其重叠的所有其他矩形，或者您只删除该矩形并继续。我建议使用以下伪代码：

```
compute_opt ( set of rectangles ){
  if(set.size == 0)
    return 0
  return max (area of selected rectangle i +  
              compute_opt( rectangles that don't overlap with i) ,
              compute_opt( rectangles without rectangle i included) )
} 
```

我对记忆有点生疏，所以我不会在这里讨论它。但是有关加权调度的更多信息，请参阅[有关动态规划的普林斯顿讲座。](http://www.cs.princeton.edu/courses/archive/spr05/cos423/lectures/06dynamic-programming.pdf)鉴于区间问题的细节，您应该能够弄清楚矩形问题的细节。

# mysql - Rails Active Record重复条目mysql错误

> ID：15079878
> 
> 赞同：0
> 
> 时间：2013-02-26T01:40:03.167
> 
> 标签：mysql, ruby-on-rails-3, activerecord

我有一个几乎完成的 Rails 3.2.11 应用程序，我一直在用 SQLite3 开发它。它与 SQLite3 完美配合。现在我想切换到 MySQL 进行其余的开发，但是出了点问题。

我的“feed_entries”表的“guid”列上有一个唯一索引。该应用程序首先检查是否存在具有相同 'guid' 的记录，并且仅在没有具有相同 guid 的记录时才创建一个新记录。出于某种原因，guid 正在更改为特定数字，因此只保存了一条记录。

这是错误：

```
ActiveRecord::RecordNotUnique: Mysql::Error: Duplicate entry '2147483647' for key 'index_feed_entries_on_guid' 
```

以下是尝试保存的记录：

```
FeedEntry Exists (0.3ms)  SELECT 1 AS one FROM `feed_entries` WHERE `feed_entries`.`guid` = 3577996865 LIMIT 1
SQL (0.1ms)  BEGIN
FeedEntry Exists (0.3ms)  SELECT 1 AS one FROM `feed_entries` WHERE `feed_entries`.`guid` = BINARY 3577996865 LIMIT 1
SQL (1.0ms)  INSERT INTO `feed_entries` (`guid`) VALUES (?)  [["guid", 3577996865]]
(1.0ms)  COMMIT
FeedEntry Exists (0.2ms)  SELECT 1 AS one FROM `feed_entries` WHERE `feed_entries`.`guid` = 3643574649 LIMIT 1
SQL (0.1ms)  BEGIN
FeedEntry Exists (0.3ms)  SELECT 1 AS one FROM `feed_entries` WHERE `feed_entries`.`guid` = BINARY 3643574649 LIMIT 1
SQL (1.6ms)  INSERT INTO `feed_entries` (`guid`) VALUES (?)  [["guid", 3643574649]]
(0.8ms)  ROLLBACK 
```

我去掉了不重要的部分。该表有 20 多列，但 guid 是创建记录时唯一有意义的列，因此为了简洁和便于阅读，我删除了其余信息。

如您所见，它显示好像它正在使用正确的 guid 保存它们，但随后错误显示它正在尝试使用 guid 2147483647 保存。错误之后，该表只有一条记录，尽管它显示该记录已保存使用 guid 3577996865，当它从数据库中获取它时，它的 guid 显示在错误 (2147483647) 中。我不明白为什么它将指南转换为该数字。

也许它与在 guid 之前说 BINARY 的第二个 Exists 语句有关？当我将分支切换到仍然使用 SQLite 数据库的分支时，它尝试保存的每条记录只有一个 Exists 查询。

感谢您的阅读，非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T03:01:45.203

我想到了！guid 大于 4 字节的“int”字段类型。上限约为 21 亿（2147483647）。我的解决方案只是砍掉第一个数字，因为我不需要它。如果我这样做了，我可以将数据类型更改为“bigint”。

这是一个解释： [http ://www.idytise.com/blog/returning-2147483647-in-your-mysql-database-table/](http://www.idytise.com/blog/returning-2147483647-in-your-mysql-database-table/)

# facebook - 无需 Facebook 帐户或通过第三方应用程序即可登录 Facebook

> ID：15079880
> 
> 赞同：0
> 
> 时间：2013-02-26T01:40:05.500
> 
> 标签：facebook, plugins, login, social

有谁知道无需在社交媒体网站上创建帐户即可使用社交登录的方法？例如，我想在我的网站上使用 Facebook 的登录，但我不想创建 Facebook 帐户或应用程序只是为了使用他们的登录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T01:42:15.880

据我所知，它几乎需要（facebook）创建一个应用程序（在 facebook 的开发者网站上），以便通过网站使用服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T01:44:29.823

不幸的是，为了维护安全的开发环境并防止创建垃圾邮件应用程序，Facebook 必须管理其开发人员用户。这是为了允许他们阻止恶意行为的应用程序，并允许在其服务器上管理应用程序访问令牌的权限。有关更详细的答案，我将向您[推荐 Lix 的 StackOverflow 上的一个](https://stackoverflow.com/questions/9738831/developing-for-the-facebook-api-without-getting-a-facebook-account)。

# ruby - 保存和更新用户/首选项的 Ruby 命令行程序

> ID：15079885
> 
> 赞同：0
> 
> 时间：2013-02-26T01:40:54.570
> 
> 标签：ruby, file, parsing, command-line, stdin

我正在构建一个应用程序，它采用标准输入来保存用户及其偏好。我应该将标准输入写入文本文件并将用户输入保存在那里吗？

**命令行.rb**

```
class CommandLine
   def initialize(filename)
      @file = File.open(filename, 'w')   
   end

   def add_user(input)
      @file = File.open('new_accounts.txt', 'r+')
      @file.write(input)
      puts input
   end

   def run
      puts "Welcome to the Command Line Client!"
      command = ''
      while command != 'quit'
      printf "enter command: "
      input = gets.chomp
      parts = input.split
      command = parts[0]
      case command
          when 'quit' then puts 'Goodbye!'
          when '-a'   then add_user(parts[1..-1].join(" "))
          else
            puts 'Invalid command #{command}, please try again.'
          end
      end
   end
end

a = CommandLine.new('new_accounts.txt')
a.run 
```

假设我希望用户在命令行中输入“ **-a tommy like apples** ”，我希望它输出：

```
tommy likes apples 
```

同一个用户 tommy 也可以输入“ **-a tommy likes oranges** ”，然后更新他之前的偏好：

```
tommy likes oranges 
```

任何帮助/方向表示赞赏，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T02:29:14.973

如果您正在做一些简单的事情，我认为使用文本文件没有问题。替代方案很多，如果没有更多细节，恐怕我无法提出好的建议。

```
def add_user(input)
  File.open('new_accounts.txt', 'w') {|file| 
      file.write(input) 
  }
  puts input
end 
```

仅供参考：这将使您的文本文件更新。:-)

**编辑**：更改了 add_user 方法。

# iphone - 如何使用另一个 Apple ID 将已经在线的 iOS 应用提交到 App Store？

> ID：15079886
> 
> 赞同：4
> 
> 时间：2013-02-26T01:41:04.803
> 
> 标签：iphone, ios, app-store, appstore-approval

我的公司将 iOS 应用程序外包给了另一家公司，他们使用 Apple ID 在 App Store 上发布了该应用程序。该应用程序已经可供下载几个月，并拥有大量用户。现在我的公司开发了一个稍微更新的应用程序版本，并希望使用我们自己的 Apple ID 分发该应用程序。正确的方法是什么？我们的主要担忧是：

1.  我们应该在从 App Store 下架旧应用程序之前还是之后使用我们的 ID 提交更新版本。会不会因为苹果觉得这两个应用太相似而导致新应用被拒绝？（实际上它们非常相似，因为更新很小。）

2.  是否有一种优雅的方式来通知当前在线应用程序的用户他们应该切换到较新的应用程序？以及如何协调它，因为较新的应用程序可能需要一定的时间才能获得批准。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T01:55:26.990

这里有一些不同的场景，我将尝试解决其中的一些问题，看看哪一个对您最有帮助：

1-)您当前的应用程序不包含推送通知和应用内购买。这是最简单的一个。基本上，用户以前拥有什么版本并不重要。您可以从以前的开发者帐户中删除旧的，并将其添加到新的开发者帐户中。通过完全删除之前的应用程序（不仅从应用商店列表中，而且从开发者帐户中），您可以重复使用捆绑 ID。当用户重新安装应用程序时，用户将能够用新应用程序替换旧应用程序（注意新应用程序不会出现在用户的更新列表中）。

2-)您有推送通知。在这里，如果您希望维护推送通知证书，则必须保留旧应用程序，因此，新应用程序必须使用新的捆绑 ID，这意味着该应用程序将作为新应用程序出现在用户身上，并且用户将能够同时拥有这两个应用程序。

3-)您有应用内购买和订阅。您需要从旧的开发者帐户中删除旧的应用内购买条目，并将其添加到新帐户中（如果您希望重复使用产品 ID，则必须以任何一种方式创建它）。

如果您使用 iCloud 和/或其他服务，我不确定您需要采取何种措施。最好的做法是联系 Apple 开发人员支持。他们将为您提供一些关于如何处理您的具体案例的指导。此外，在提交时，请确保向审阅者指出您正在尝试将应用程序从一家公司转移到另一家公司。我认为他们可以访问从审查到上一次提交的审查注释（而不是将其作为新应用程序审查），并加快流程。

编辑：您不能使用 iTunes 连接在公司之间传输应用程序。更多信息在这里：[链接](https://developer.apple.com/news/index.php?id=6112013c)

# mysql - 用 RMySQL 写日期

> ID：15079891
> 
> 赞同：1
> 
> 时间：2013-02-26T01:41:18.057
> 
> 标签：mysql, r, rmysql

我在 R 中有一段时间，我想在 DATETIME 列中写入 MySQL 表。我怎样才能做到这一点？如果我将其格式化为字符串 SQL 将无法识别它；如果我使用`as.POSIXlt`SQL 仍然无法识别它。

我只是使用标准`dbConnect`和`dbWriteTable`语句，它们适用于非日期就好了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-26T03:21:53.213

据此：[_](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-literals.html)

> MySQL 识别以下格式的 DATETIME 和 TIMESTAMP 值： 作为 'YYYY-MM-DD HH:MM:SS' 或 'YY-MM-DD HH:MM:SS' 格式的字符串。

因此，一种解决方案是以正确的格式格式化您的日期：

```
now <- as.POSIXlt(Sys.time())
now.str <- format(now,'%Y-%m-%d %H:%M:%S')
now.str 
[1] "2013-02-26 04:12:24" 
```

或以这种格式

```
format(now,'%Y%m%d%H%M%S')
[1] "20130226041224" 
```

然后使用更新您的表`dbSendQuery`。这是为任何表和任何日期创建动态查询的示例。使其适应您的需求。

```
table.Name <- "MY_TABLE"
query <-  paste(paste('UPDATE ', table.Name,sep=''),
                paste('SET datetime_column =' ,"'",now.str,"'",sep=''),
                'WHERE id=1',sep='\n')

cat(query)
UPDATE MY_TABLE
SET datetime_column ='2013-02-26 04:12:24'
WHERE id=1

dbSendQuery(con, query) 
```

我还认为`dbWritetable`，一旦您以正确的格式格式化日期，这应该适用。但我没有安装 MySQL 来测试它。试试看，让我知道这是否有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-16T04:10:56.227

我一直在使用 agstudy 的解决方案，然后在使用 dbSendQuery 的 dbWriteTable 之后调用此 SQL。似乎运作良好。

```
ALTER TABLE TableName MODIFY DateFieldName datetime; 
```

# javascript - 基于父容器大小的响应式 iframe src 参数

> ID：15079894
> 
> 赞同：0
> 
> 时间：2013-02-26T01:41:39.100
> 
> 标签：javascript, jquery, iframe, autoresize, window-resize

我正在开发一个响应式页面，其中有一个嵌入的视频内容。

如何根据父容器的宽度更新 iframe src 中的参数宽度/高度以及 iframe 属性宽度/高度，以及在窗口/方向更改时更改？

我的标记：

```
<div class="content">
    <div class="video">
    <iframe src="http://www.foo.com/embeddedPlayer?id=4062930&width=672&height=377&autoPlay=false" width="672" height="377" border="0" frameborder="0" scrolling="no"></iframe>
    </div>
</div> 
```

这是我的JS：

```
var articleBodyWidth = $('.content').width(),
    videoUrl = $('.video'),    
    videoSrc = videoUrl.find('iframe').attr('src'),
    iframeWidth = videoUrl.find('iframe').attr('width'),
    iframeHeight = videoUrl.find('iframe').attr('height');

// function to get param in url
function getParam(name) {
  name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
  var regexS = "[\\?&]"+name+"=([^&#]*)";
  var regex = new RegExp(regexS);
  var results = regex.exec(videoSrc);
  if(results == null) {
    return "";
  } else {
    return results[1];
  }
}

var newWidth = articleBodyWidth,
    newHeight = Math.round( (iframeHeight / iframeWidth) * articleBodyWidth );

// update iframe width and height
videoUrl.find('iframe').attr({
   width: newWidth,
   height: newHeight
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T03:16:59.063

我认为这应该做

```
$('.video iframe').attr('src', 'http://www.foo.com/embeddedPlayer?id=4062930&width=' + newWidth+ ' &height='  + newHeight + ' &autoPlay=false').css({
   width: newWidth,
   height: newHeight
}) 
```

另一种解决方案是使用正则表达式替换 src 中的高度和宽度

```
function updateVideo() {
    var src = $('.video iframe').attr('src');
    src = src.replace(/&width=\d+&/, '&width=' + newWidth + '&');
    src = src.replace(/&height=\d+&/, '&height=' + newHeight + '&');
    $('.video iframe').attr('src', src).attr({
       width: newWidth,
       height: newHeight
    });
}

$(window).on('resize', updateVideo) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T03:38:33.893

@kcdwayne 是对的。您应该在响应式页面中控制 CSS。对于嵌入式视频，唯一的变量是“高度”，但如果您使用@media-queries，您可以根据布局更改为不同的屏幕尺寸设置高度。

以下是我尝试这样做的方法：http: [//tinyurl.com/a2cxfe6](http://tinyurl.com/a2cxfe6)

有关嵌入式 Flash 对象的更多信息： [http ://www.aleosoft.com/flashtutorial_autofit.html](http://www.aleosoft.com/flashtutorial_autofit.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T02:47:32.303

您需要做的是使用 CSS 控制大小。

`<iframe src="http://www.foo.com/embeddedPlayer?id=4062930&width=672&height=377&autoPlay=false" border="0" frameborder="0" scrolling="no" id="video"></iframe>`

```
<style type="text/css">
#video { width:100%; height:auto: }
</style> 
```

我去掉了宽度和高度，`<iframe>`以便 CSS 可以接管。

# jsf - 如果从渲染属性调用方法会被多次调用

> ID：15079899
> 
> 赞同：1
> 
> 时间：2013-02-26T01:42:23.187
> 
> 标签：jsf, jsf-2

我正在从渲染属性调用一个方法，我注意到该方法在 RENDER_RESPONSE 阶段被多次触发。

还注意到该方法在其他阶段（APPLY_REQUEST_VALUES、PROCESS_VALIDATIONS 等）也被多次触发。

我看到了一个相关的查询（[为什么 getter 被渲染属性调用了这么多次？](https://stackoverflow.com/questions/4281261/why-is-the-getter-called-so-many-times-by-the-rendered-attribute?answertab=active#tab-top)），其中告诉了这些调用背后的原因。

有没有一种方法可以控制这一点，以便该方法只被调用一次。

我的用法

```
<rich:panelMenuItem label="Menu1" actionListener="#{testMenuMB.panelMenuClickedAjax}" rendered="#{testMenuMB.checkForRendering('RoleA,RoleB')}"></rich:panelMenuItem>

public boolean checkForRendering(String rolesString){
System.out.println("Roles-->"+rolesString+FacesContext.getCurrentInstance().getCurrentPhaseId());
        boolean authorized = false;
        String [] rolesArray = rolesString.split(",");
        for (String string : rolesArray) {
            if(string!=null && accesibleRolesMap.containsKey(string)){
                authorized = true;
                break;
            }
        }
        return authorized;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T10:45:19.680

您无法控制调用该方法的次数，即其框架生命周期。您应该找到适当的位置来设置布尔值，例如在命令单击操作方法中，在渲染方法中使用此布尔值，以便在操作方法中执行一次逻辑并且只返回布尔值。

另一件事是，您可以通过探测当前生命周期阶段以获取渲染响应来保护带有 if 条件的逻辑。

```
 if(FacesContext.getCurrentInstance().getRenderResponse()){
    //logic
 } 
```

但我更喜欢第一个选项。

# ruby-on-rails - 使用 Rails 构建私有 API

> ID：15079904
> 
> 赞同：2
> 
> 时间：2013-02-26T01:42:48.937
> 
> 标签：ruby-on-rails, api, backend

你好，我和朋友们正计划进行一个大项目。我的两个朋友将构建 iOS 和 Android 应用程序，而我将构建服务器后端。我最近开始使用 RoR 进行开发并爱上了 Ruby。现在这是我的问题：

**更多背景信息：**
我只想要一个用于 android 和 iPhone 应用程序的私有 API。我不想要一个完整的 OAuth 身份验证过程。做一些研究，我想我会使用基本的 HTTP 身份验证。

**1\. 我的应用程序使用基于 cookie 的身份验证，这意味着每个后续请求都必须传递一个 cookie。那么我的朋友是否需要存储一个 cookie 并在对服务器的每个后续请求中将 cookie 连同它一起发送？**

**2\. 如何将 API 设为私有？我知道在 OAuth 中有消费者秘密和消费者密钥。我知道是否有人可以简单地找出他们将能够访问 API 的 URL 架构。如何保护我的后端免受来自未知用户的请求？（应用程序本身中的硬编码字符串？检查设备类型的标头？）**

**3\. 我应该现在只构建 API，然后再担心 Web 应用程序吗？或者回去构建一个网络应用程序会不会太可怕了（尽管我真的希望网络应用程序比移动应用程序更重要**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T21:57:07.393

这是一篇很棒的文章，准确地解释了您正在寻找的内容：在不设置完整的 OAUTH 提供程序的情况下保护 API：

[http://www.thebuzzmedia.com/designing-a-secure-rest-api-without-oauth-authentication/](http://www.thebuzzmedia.com/designing-a-secure-rest-api-without-oauth-authentication/)

效果很好（即使解决方案最终离 oauth 不远；）

# wikimedia - 如何编写维基媒体链接，使其在新选项卡或新窗口中打开

> ID：15079907
> 
> 赞同：5
> 
> 时间：2013-02-26T01:43:03.117
> 
> 标签：wikimedia

我正在使用基于 wikimedia 引擎的 wiki，即 wikipedia 使用的相同 wiki 技术。

如何使用 wiki 语言编写将在新窗口或选项卡中打开目标 URL 的链接。本质上，我想要 wiki 语言相当于：

```
<a href="http://www.google.com" target="new">Google</a> 
```

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-02-26T02:02:19.560

你的意思是这样 [ [http://www.example.org](http://www.example.org)链接名称]

# css - 在 Blackberry Jquery Mobile+Phonegap 应用中滑动页面时出现灰色边缘

> ID：15079910
> 
> 赞同：1
> 
> 时间：2013-02-26T01:43:30.010
> 
> 标签：css, cordova, jquery-mobile, blackberry, blackberry-webworks

我正在开发一个使用 PhoneGap 和 Jquery mobile 的 Blackberry 和 Android 应用程序。我对 android 版本没有任何问题，但是在使用 Blackberry 时，我遇到了一种我不想遇到的奇怪行为......

当我向上或向下滚动/滑动页面时，页面会移动到该方向，就好像它是一个可滚动的页面，但它不是，这会产生“弹性反弹效果”，使页面上下出现灰色边缘......

我想这个问题与一些 CSS 错误问题有关，但我无法弄清楚......

在这里，您有一些图片可以帮助更好地理解我的问题...

[图 1](http://imgur.com/3U5y5R6) [图 2](http://imgur.com/HNBzqlg)

我希望你能帮助我...对不起我的英语不好顺便说一句...

# apache - mod_rewrite 生成目录请求而不是请求页面

> ID：15079912
> 
> 赞同：0
> 
> 时间：2013-02-26T01:43:33.367
> 
> 标签：apache, .htaccess, mod-rewrite

我想向目录发出请求，例如

```
www.mysite.com/directory/itemname/ 
```

重定向到

```
www.mysite.com/directory/itemname/index.cfm 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T07:33:05.507

您可能只想使用 DirectoryIndex 来为 .htaccess 或 httpd.conf 指定默认索引页面

```
DirectoryIndex index.cfm 
```

# jaxb - 将外部 JAXB 绑定文件应用于从 WSDL 导入的模式元素

> ID：15079913
> 
> 赞同：16
> 
> 时间：2013-02-26T01:43:34.170
> 
> 标签：jaxb, jax-ws, xjc, wsimport

我的外部绑定文件中的 XPath 表达式不能针对导入到我的 WSDL 中的 XML 模式中的元素。

如果我进行内联绑定自定义，一切都会运行，但我真的希望拥有外部绑定文件，这样我就不会意外覆盖（刷新）包含我的自定义的文件。

我的绑定文件的开始：

```
<jaxb:bindings
    xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema"
    xmlns:xs="http://www.w3.org/2001/XMLSchema"
    xmlns:jaxb="http://java.sun.com/xml/ns/jaxb"
    xmlns:jaxws="http://java.sun.com/xml/ns/jaxws"
    version="2.1">
    <jaxb:bindings schemaLocation="../wsdl/localhost_7001/ExampleSessionBean/ExampleSessionBeanService.wsdl#types?schema1">
        <jaxb:bindings node="//xs:schema[@targetNamespace='urn:myExample']"> 
```

我的 WSDL 包含：

```
<types>
<xsd:schema>
<xsd:import namespace="urn:myExample" schemaLocation="http://localhost:7001/ExampleSessionBean/ExampleSessionBeanService?xsd=1"/>
</xsd:schema>
<xsd:schema>
<xsd:import namespace="http://ejbs/" schemaLocation="http://localhost:7001/ExampleSessionBean/ExampleSessionBeanService?xsd=2"/>
</xsd:schema>
</types> 
```

无论我做什么，XPath 在 xsd:import'ed 模式中都找不到任何东西。我得到的错误是：

```
[ERROR] XPath evaluation of "//xs:schema[@targetNamespace='urn:myExample']" results in empty target node 
```

我尝试通过索引号而不是命名空间访问 xs:schema，但这也不起作用。似乎我的 XPath 表达式无法从导入的模式中访问元素……有没有办法解决这个问题？

这是在 NetBean 7.2 下开发的 Java SE 7 项目。如果这很重要，我正在使用 NetBeans 来完成我所有的 wsimport 工作，但命令输出对于 RI/Metro 来说看起来相当标准。

编辑：我发现如果我使用 SCD，我可以让外部绑定文件工作。此 XPath 示例不起作用：

```
<bindings node="//xsd:schema[@targetNamespace='urn:myExample']">
    <bindings node="//xs:complexType[@name='myType']">
        <class name="MyClass"/>
    </bindings>
</bindings> 
```

但是这个 SCD 示例可以。

```
<bindings scd="x-schema::tns" xmlns:tns="urn:myExample">
    <bindings scd="~tns:myType">
        <class name="MyClass"/>
    </bindings>
</bindings> 
```

这是一个已知的事情，即使用 wsimport 时 XPath 在 xjb 文件中不起作用但 SCD 起作用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-22T15:56:19.527

你应该像这样使用它：

```
<jaxws:bindings node="wsdl:definitions/wsdl:types/xsd:schema[@targetNamespace='http://duke.example.org']">
    <jaxb:schemaBindings>
        <jaxb:package name="fromwsdl.server"/>
    </jaxb:schemaBindings>
</jaxws:bindings> 
```

小心命名空间

这一切都在这里解释： [https ://jax-ws.java.net/nonav/2.1.2/docs/customizations.html](https://jax-ws.java.net/nonav/2.1.2/docs/customizations.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-01T01:46:39.667

您可以将每个 XML 模式分别编译为 Java 类。然后，您可以利用情节文件，以便在编译导入该 XML 模式的模式时可以使用生成的类。

以下是如何制作剧集文件的示例。

```
xjc -b binding1.xml -episode common.episode common.xsd 
```

以下是您如何使用和剧集文件的示例。剧集文件只是一个 JAXB 外部绑定文件，因此使用`-b`标志指定。

```
xjc -d out main.xsd -extension -b common.episode 
```

**了解更多信息**

*   [http://blog.bdoughan.com/2011/12/reusing-generated-jaxb-classes.html](http://blog.bdoughan.com/2011/12/reusing-generated-jaxb-classes.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-27T15:05:18.520

对于新人，你可以简单地使用两个绑定文件，一个应用于 wsdl，另一个应用于 schema，通过使用 wsdl2java cxf 代码生成类的 -b 选项接受多个绑定文件：

```
<java classname="org.apache.cxf.tools.wsdlto.WSDLToJava" fork="true">
    <arg value="-d"/>
    <arg value="${src}"/>
    <arg value="-b"/>
    <arg value="${wsdl.home}\jaxws-bindings.xml"/>
    <arg value="-b"/>
    <arg value="${wsdl.home}\jaxb-bindings.xml"/>
    <arg value="${wsdl.home}\YOUR_WSDL.wsdl"/>
    <classpath>
        <path refid="cxf.classpath"/>
    </classpath>
</java> 
```

文件“jaxws-bindings.xml”的内容：

```
<jaxws:bindings wsdlLocation="YOUR_WSDL.wsdl"
                xmlns:jaxws="http://java.sun.com/xml/ns/jaxws"
                xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/"
                xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <jaxws:enableWrapperStyle>false</jaxws:enableWrapperStyle>
</jaxws:bindings> 
```

'jaxb-bindings.xml' 的内容：

```
<jaxb:bindings xmlns:jaxb="http://java.sun.com/xml/ns/jaxb"
               xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
               jaxb:version="2.0">
    <jaxb:bindings schemaLocation="ManagePartyCustomerDataManagement_PARTY_G7-IOP_In_1.0.xsd">
        <jaxb:bindings node="//xsd:element[@name='eventDate']">
            <jaxb:javaType name="java.util.Date" 
                       parseMethod="com.sofrecom.gaia.ebs.provider.utils.jaxb.StringDateAdapter.parseDate"
                       printMethod="com.sofrecom.gaia.ebs.provider.utils.jaxb.StringDateAdapter.printDate" />
  </jaxb:bindings> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-05-26T09:51:15.960

将此部分添加到我的 JAXB 配置有助于消除类似的错误：

```
<jaxws:bindings xmlns:jaxws="http://java.sun.com/xml/ns/jaxws">
   <jaxws:enableWrapperStyle>true</jaxws:enableWrapperStyle>
   <jaxws:enableAsyncMapping>false</jaxws:enableAsyncMapping>
</jaxws:bindings> 
```

完整配置：

```
<?xml version="1.0" encoding="UTF-8"?>
<jaxb:bindings version="2.1" 
                xmlns:jaxb="http://java.sun.com/xml/ns/jaxb" 
                xmlns:xjc="http://java.sun.com/xml/ns/jaxb/xjc"
                xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/"
                xmlns:xs="http://www.w3.org/2001/XMLSchema">

    <jaxws:bindings xmlns:jaxws="http://java.sun.com/xml/ns/jaxws">
        <jaxws:enableWrapperStyle>true</jaxws:enableWrapperStyle>
        <jaxws:enableAsyncMapping>false</jaxws:enableAsyncMapping>
    </jaxws:bindings>

    <jaxb:bindings schemaLocation="ContactService.wsdl" node="/wsdl:definitions/wsdl:types/xs:schema">
        <jaxb:schemaBindings>
            <jaxb:package name="za.org.kuali.kfs.sys.integration.iapi.contactservice"/>
        </jaxb:schemaBindings>
    </jaxb:bindings>

</jaxb:bindings> 
```

学分：

*   [https://stackoverflow.com/a/7890753/315385](https://stackoverflow.com/a/7890753/315385)
*   [https://stackoverflow.com/a/38077750/315385](https://stackoverflow.com/a/38077750/315385)

# io - Lua：读取数据的最快方式

> ID：15079914
> 
> 赞同：1
> 
> 时间：2013-02-26T01:43:33.570
> 
> 标签：io, lua, integer

这是我的程序。

```
local t = {}
local match = string.gmatch
local insert = table.insert
val = io.read("*a")

for num in match(val, "%d+") do
    insert(t, num)
end 
```

我想知道是否有比这更快的方法来加载大型（16MB+）整数数组。考虑到数据由单个数字的一​​行一行组成，这可以更快吗？我应该看 io.read("*n") 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T02:40:10.377

鉴于您的文件大小为 16MB，您的加载例程的性能将由文件 IO 主导。处理加载的数据需要多长时间通常与此无关。

就试一试吧; 分析加载文件需要多长时间（之后停止脚本`io.read`），然后分析整个脚本需要多长时间。后者会更长，但只会占相对较小的百分比，而不是大量。

以您正在做的方式一次加载整个文件几乎肯定会比零碎地加载更快。文件系统喜欢一次读取整个数据块，而不是一次读取位。除此之外，如何处理文本相对无关紧要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T03:15:15.623

我不确定它是否更快，但`read("*n")`更简单......

```
local t = { }
while true do
    local n = io.stdin:read("*n")
    if n == nil then break end
    table.insert ( t , n )
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T02:03:55.063

可能，这会更快：

```
local t = {}
local match = string.match
for line in io.lines() do
   t[#t+1] = match(line, '%d+')
end 
```

不要忘记将字符串转换为数字。

# haskell - Haskell：数据类型

> ID：15079916
> 
> 赞同：2
> 
> 时间：2013-02-26T01:43:44.477
> 
> 标签：haskell, types, instance, ghci

我声明我的数据是这样的：

```
data Op = Plus | Minus | Mul | Div | Pow
        deriving (Eq, Show)

type Name = String

data Variable a = Variable Name (Expression a)
            deriving (Eq, Show)

data Declaration a = Declaration (Variable a)
            deriving (Eq, Show)  

{- The core symbolic manipulation type -}
data Expression a = 
          Number a           -- Simple number, such as 5
        | Expression Op (Expression a) (Expression a)
          deriving (Eq, Show) 
```

在 GHCi 中，我想通过键入来创建声明的实例： `Declaration Variable "var1" 2+3` 但它不起作用，我想这只是一个错误的语法，但我不知道如何。

另外我想知道我们什么时候需要使用实例？这是我从书中得到的代码：

```
instance Num a => Num (Expression a) where
    a + b = Expression Plus a b
    a - b = Expression Minus a b
    a * b = Expression Mul a b
    negate a = Expression Mul (Number (-1)) a
    abs a = error "abs is unimplemented"
    signum _ = error "signum is unimplemented"
    fromInteger i = Number (fromInteger i) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T03:14:34.013

```
Declaration Variable "var1" 2+3 
```

相当于

```
(Declaration Variable "var1" 2) + 3 
```

. 也就是说，它尝试`Declaration`使用 3 个参数（`Variable`、`"var1"`、`2`）进行调用，然后将结果添加到`3`. 这是没有意义的。

你要

```
Declaration (Variable "var1" (2+3)) 
```

# php - 数据库连接类构造函数

> ID：15079917
> 
> 赞同：1
> 
> 时间：2013-02-26T01:43:51.103
> 
> 标签：php, oop, pdo, database-connection

我刚刚开始使用 OOP PHP，所有的信息都是关于一辆红色或蓝色的汽车……我很难理解数据库连接唯一的对象。

我有一个令人难以忘怀的怀疑，我的 __construct() 不应该在其中包含连接字符串，而是它在类中的自己的方法..但它的工作原理......

像下面这样定义我的连接类是否不正确。如果它是错误的 - 它应该如何？

```
class dbConnect {

    // Declare connection info for PDO
    private $dbType = 'mysql';
    private $dbHost = 'localhost';
    private $dbUser = 'user';
    private $dbPass = 'password';
    private $dbName = 'db';

    // Declare connection variable for object
    private $dbConn;

    // Construct object
    private function __construct() {

        // Create Database connection and assign it to object as dbConn
        $this -> dbConn = new PDO( $this -> dbType . ':' . 'host=' . $this -> dbHost . ';' . 'dbname=' . $this -> dbName , $this -> dbUser , $this -> dbPass );    
    } 
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-26T09:19:26.397

我不认为我认为你在做什么很有用。看起来您将拥有一个数据库类。我只是看不到这样做的好处，因为`PDO`已经是一个类，所以除非你有充分的理由这样做，否则没有必要扩展它。

恕我直言，一个更好的选择是`PDO`在引导阶段初始化实例并将连接注入需要它的类中；

```
$dbConnection = new PDO('mysql:host=localhost;dbname=db', 'user', 'password');

$someInstance = new ClassThatNeedsDatabase($dbConnection);
$someInstance->doSomething();

class ClassThatNeedsDatabase
{
    private $dbConnection ;

    public function __construct(PDO $dbConnection)
    {
        $this->dbCOnnection = $dbConnection;
    }

    public function doSomething()
    {
        $stmt = $this->dbConnection->prepare('UPDATE....');

        // etc
    }

} 
```

一般来说，您可能希望避免`new`在其他类中使用关键字，因为它们引入了紧密耦合。这会损害可维护性（通过查看类签名很难判断该类是否被使用），可测试性（您不能轻易交换类）等。如果您确实需要在其他类中构建新实例（在这种特定情况下是真的不需要 imo 如上所述）您可能想要实现工厂模式：

```
class Foo
{
    public function doSomething()
    {
    }
}

class FooFactory
{
    public function build()
    {
        return new Foo();
    }
}

class Bar
{
    private $fooFactory;

    public function __construct(FooFactory $fooFactory)
    {
        $this->fooFactory = $fooFactory;
    }

    public function soSomethingWhichNeedsToBuildAnInstance()
    {
        $foo = $this->fooFactory->build();
    }
} 
```

这也防止了代码的紧密耦合。

[[上面的命名很糟糕，但这只是为了说明这一点。:-)]]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T01:52:00.383

是的，你应该是`extending`现有的`PDO`对象。

这个作为你的基地怎么样：

```
define('DB_USER', 'username');
define('DB_PASS', 'password');
define('DB_DSN', 'dsn');

class dbConnect extends PDO {           
  public function __construct($user = DB_USER, $pass = DB_PASS, $dsn = DB_DSN) {
    parent::__construct($dsn, $user, $pass, $options);
  }
} 
```

# ruby-on-rails - Ruby On Rails 模型没有方法

> ID：15079918
> 
> 赞同：1
> 
> 时间：2013-02-26T01:43:58.653
> 
> 标签：ruby-on-rails

我有一个属于关系的模型。

```
class Product < ActiveRecord::Base
  attr_accessible :name, :price, :request_id, :url

  # Relationships
  belongs_to :request

end

class Request < ActiveRecord::Base
  attr_accessible :category, :keyword

  # Relationships
  has_many :products

end 
```

这是我的控制器功能 product = Product.where({ :asin => asin }).first 中的代码

```
 # See if the product exists
     begin
         #This throws a method not found error for where
        product = Product.where({ :name => name }).first

     rescue 
        Product.new
             # This throws a method not found error for request_id
        product.request_id = request.id
        product.save
     end 
```

我正在尝试创建一个新的产品对象，例如 product = Product.first(:conditions => { :name => name })

当我打电话给我时，我收到一条错误消息，说`undefined method 'first' for Product:Class` 我尝试做 Product.new 并且我无法访问任何属性。我为每个人得到这个`undefined method 'request_id=' for #<Product:0x007ffce89aa7f8>`

我已经能够保存请求对象。我对产品做错了什么？

编辑：

事实证明，正在导入的旧产品数据类型不是 ActiveRecord 类。它使用它而不是我的 Product::ActiveRecord。我删除了该导入，一切顺利。很抱歉浪费了大家的时间。

不确定这里有什么正确的协议来处理这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T15:04:28.950

您的`Product`课程是 ActiveRecord::Base 课程吗？你可以通过运行找到：

```
Product.ancestors.include?(ActiveRecord::Base) 
```

如果这返回 false，则它正在从其他地方加载类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T02:59:38.940

首先通过输入以下内容检查您的产品类是否设置正确：

```
rails c
# after console has loaded
Product 
```

如果这看起来正确，那么我们将尝试通过调用来实例化产品：

```
# Create a new product
product = Product.new(name: "first product", price: 100, url: "http://www.example.com")
# Persist this object to the database
product.save 
```

如果您缺少任何属性，请运行另一个迁移以将它们添加到 Product 表中。

如果这些建议都不起作用，请检查以确保您的项目中没有同名的现有类。这会导致各种错误，并会解释某些未找到的方法。

# mysql - SQL - 如何选择多行

> ID：15079919
> 
> 赞同：5
> 
> 时间：2013-02-26T01:44:00.667
> 
> 标签：mysql, sql

我有两个表，成员和捐赠由成员 ID 链接。成员有许多重复项。我想删除它们，但在此之前，我想将 Donations 中的成员条目更新为单个 ID——在 Sara Tam 的情况下可能是 MAX 值 (456)。

是否有一个查询可以选择 Sara 的所有成员（以及其他在 Donations 中有条目但没有 Fred 的成员？我如何关联 ID 123 和 456？

```
 members          donations
    -----------     -----------
    123 Sara Tam        123   20.00   
    456 Sara Tam        123   40.00 
    789 Sara Tam        333   10.00
     .                  444   30.00 
     .                  999   30.00 
    789 Fred Foo 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T02:02:56.343

如果我正确理解您的问题，您希望将 Donations 表更新为与成员关联的 MAX Id，并删除保留 MAX 的成员表中的重复记录。

如果是这样，那么这应该可以工作 - 但是，您不应该有 2 个具有相同 ID 的成员：

```
UPDATE Donations D
  JOIN Members M ON M.MemberId = D.MemberId
  JOIN (SELECT Max(MemberId) MaxId, Name
        FROM Members 
        GROUP BY Name
      ) M2 ON M.Name = M2.Name
SET D.MemberId = M2.MaxId;

DELETE M
FROM Members M
  JOIN Members M2 ON M.Name = M2.Name AND M.MemberId < M2.MemberId; 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!2/4a71d/1)

发表您的意见，也许您只是在寻找 SQL 语句来显示更新后的捐款 MAX(Id)。如果是这样，那么这应该工作：

```
SELECT M2.MaxId MemberId, D.Amount
FROM Donations D
  JOIN Members M ON M.MemberId = D.MemberId
  JOIN (SELECT Max(MemberId) MaxId, Name
        FROM Members 
        GROUP BY Name
      ) M2 ON M.Name = M2.Name; 
```

和[更新的小提琴](http://sqlfiddle.com/#!2/4a71d/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T01:52:07.657

试试`SELECT MEMBERS.* FROM MEMBERS, DONATIONS WHERE DONATIONS.ID != MEMBERS.ID`吧，它会为您提供 ID 不在捐赠中的成员中的所有行。我的语法可能有点偏离，但请参阅有关联接的文档，例如[informIT](http://www.informit.com/articles/article.aspx?p=30875&seqNum=5)的这篇文章以获取更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T01:58:41.457

这将找到所有额外重复 ID 的最大成员 ID：

```
select m1.member_id, max(m2.member_id) maxid
from members m1
join members m2 on m1.name = m2.name and m1.member_id < m2.member_id 
```

要将其限制为仅捐赠的用户：

```
select m1.member_id, max(m2.member_id) maxid, count(*) duplicates
from members m1
join (select distinct member_id from donations) d on m1.member_id = d.member_id
join members m2 on m1.name = m2.name and m1.member_id < m2.member_id
having duplicates > 1 
```

# html - 如何在excel单个单元格中粘贴格式化的html文本

> ID：15079920
> 
> 赞同：2
> 
> 时间：2013-02-26T01:44:10.450
> 
> 标签：html, excel, format

我的问题是如何将以下 html 代码粘贴到 excel 中的**单个单元格中而不会丢失格式**

```
<html><body>
<b>first line</b>
<br>
<b>second line</b>
<br>
<br>
<b>third line</b>
</body></html> 
```

如何在不丢失格式的情况下将上述内容粘贴到 excel**单个**单元格中，如下所示，但在单个单元格中

![在此处输入图像描述](../Images/b70ebe68f65b096cc9e9edbc27b1effc.png)

**编辑：**很抱歉，有一些关于如何将 HTML 数据粘贴到 excel 中的相关问题，但这里的问题是如何将数据粘贴到单个单元格中

我发现这些问题相关，但我的问题略有不同 [Excel 可以将单元格解释为 HTML 吗？](https://stackoverflow.com/questions/1842071/can-excel-interpret-a-cell-as-html)

# c - 在 c 中使用 system() 函数

> ID：15079921
> 
> 赞同：-2
> 
> 时间：2013-02-26T01:44:24.710
> 
> 标签：c, linux, windows, system

我想使用系统函数来获取 windows 和 linux 上的帐户数。我不知道在哪里看。请指出我正确的方向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T01:49:10.733

该`system()`函数运行一个程序。如果您知道执行所需操作的命令行，则可以使用`system()`该命令行来运行该命令行。

我不确定哪个命令行程序会给出 Windows 上的帐户数量。您可以通过查看主目录的数量来获得近似值。在 Windows 上，主目录在 `/home' 中，`\Users`而在 Linux 上，主目录在 `/home' 中。

该`system()`函数不捕获程序的输出。然后，您可能需要运行将程序输出重定向到文件的命令行，然后打开该文件并解析输出。

使用 Python 之类的语言可能会更轻松地解决这个问题。Python 程序非常便携，并且有一些系统内容的包装器。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T01:49:46.700

我不知道在 Linux 中，但在 Windows 上：

[NetUserEnum()](http://msdn.microsoft.com/en-us/library/aa370652%28VS.85%29.aspx)或[NetQueryDisplayInformation()](http://msdn.microsoft.com/en-us/library/aa370610%28VS.85%29.aspx)以及当然来自这里的注册表：`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList`

PS：`system(const char *command)`函数调用`command`在命令窗口/终端中执行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T01:50:03.957

我用谷歌找到了以下内容：

视窗： [http ://social.msdn.microsoft.com/Forums/en/vcgeneral/thread/8c72b948-d32c-4785-930e-0d6fdf032ecc](http://social.msdn.microsoft.com/Forums/en/vcgeneral/thread/8c72b948-d32c-4785-930e-0d6fdf032ecc)

Linux： [http ://www.linuxforums.org/forum/miscellaneous/29508-list-all-user-accounts-system.html](http://www.linuxforums.org/forum/miscellaneous/29508-list-all-user-accounts-system.html)

*（搜索字符串：“win32获取用户账号信息”、“linux获取用户账号信息”）*

Linux 页面提供了一个命令行，因此您可以将其放入您的`system()`调用中。但是，在 Windows 中，您不使用`system()`，而是使用 Win32 API。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T07:41:27.060

对于 Linux 系统，您可能希望计算文件中的行数`/etc/passwd`。此文件包含系统中每个用户的条目。

要在 Linux 下计算文本文件的行数，`wc`可以使用该命令。

无论如何，如果您在 C 程序中需要此信息，我建议您采用不同的方法：

您可以使用打开一个文本文件并使用直到告诉您没有更多行`fopen()`来读取每一行。这样做您将获得用户数量。`fgets()``fgets()`

# jquery - mouseover() 和 mouseout() 使覆盖和控制面板轻弹

> ID：15079926
> 
> 赞同：1
> 
> 时间：2013-02-26T01:44:40.653
> 
> 标签：jquery, mouseover, flicker, mouseout

我正在使用以下代码，但是当我将指针悬停在图像上时，覆盖层和控件会闪烁。我已经测试过了`mouseenter()`，`hover()`但它也随着这些闪烁。

```
$('.image-photo').mouseover(function() {
    $('.image-photo-overlay').show();
    $('.image-photo-controls').show();
});

$('.image-photo').mouseout(function() {
    $('.image-photo-overlay').hide();
    $('.image-photo-controls').hide();
}); 
```

现场演示：*链接被删除，因为我得到它的工作感谢用户 undefined*

我该如何解决这个问题？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T01:46:53.477

您可以选择包装元素，当元素显示时，`mouseout`触发事件。

```
$('.background').hover(function() {
    $('.image-photo-overlay, .image-photo-controls').toggle();
}); 
```

其他选项是使用 CSS`pointer-events`属性：

```
.image-photo-overlay, .image-photo-controls {
   pointer-events: none;
} 
```

```
$('.image-photo').hover(function() {
    $(this).siblings().toggle();
}); 
```

# python - 在导入的文件中提取 Django 项目标签

> ID：15079927
> 
> 赞同：0
> 
> 时间：2013-02-26T01:44:41.200
> 
> 标签：python, django

我正在实现一个元应用程序并遇到以下问题：

(根)/global.py

```
class Model(Base):
  def f(self):
    app_label = do_magic()
    return app_label 
```

(根)/project/(app_label)/model.py

```
from global import global

m = Model()
print m.f() 
```

例如`m.f()`，在文件 (root)/project/test/model.py 中调用应该返回`test`，而`project.test`被添加到`INSTALLED_APPS`.

有人有想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T02:34:54.463

而不是`do_magic`我命名它`get_app_name`。以下应该是您需要的。

```
import os
import inspect

def get_app_name():
    return os.path.dirname(
               os.path.abspath(
                   inspect.stack()[-1][1])).split(os.path.sep)[-1] 
```

# .htaccess - 没有 index.php，Codeigniter 不起作用

> ID：15079937
> 
> 赞同：0
> 
> 时间：2013-02-26T01:45:36.470
> 
> 标签：.htaccess, codeigniter, codeigniter-2, httpd.conf, codeigniter-url

我正在使用带有别名作品的 MAMP。Codeigniter 位于`localhost/works/project/web`

如果没有 index.php，控制器将无法工作 ( `localhost/works/project/web/index.php/auth/register`)

 `````
$config['base_url'] = 'localhost/works/project/web/'; //with http://

$config['index_page'] = '';

$config['uri_protocol'] = 'AUTO'; 
```` 

`（我为uri_protocol尝试了所有这些）`

 `我在 /User/me/works/project/web/ 创建并编辑了 .htaccess 文件，我厌倦了关于这个问题的所有 .htaccess 文件。

 `````
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /Users/me/works/project/web

#Removes access to the system folder by users.
#Additionally this will allow you to create a System.php controller,
#previously this would not have been possible.
#‘system’ can be replaced if you have renamed your system folder.
RewriteCond %{REQUEST_URI} ^system.*
RewriteRule ^(.*)$ /index.php/$1 [L]

#Checks to see if the user is attempting to access a valid file,
#such as an image or css document, if this isn’t true it sends the
#request to index.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
#This last condition enables access to the images and css folders, and the robots.txt file
#Submitted by Michael Radlmaier (mradlmaier)
RewriteCond $1 !^(index\.php|images|robots\.txt|css)
RewriteRule ^(.*)$ index.php/$1 [L]
</IfModule>

<IfModule !mod_rewrite.c>
# If we don’t have mod_rewrite installed, all 404’s
# can be sent to index.php, and everything works as normal.
# Submitted by: ElliotHaughin

ErrorDocument 404 /index.php
</IfModule> 
```` 

`创建错误，即： ``[error] [client ::1] File does not exist: /Users/me/works/project/web/auth```

 `当我使用 RewriteBase /

mod_rewrite 在 phpInfo 中处于活动状态。

我找不到解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T01:25:04.090

你`RewriteBase`错了。它不应该是您服务器的相对文件路径，它应该是您的重写规则等的相对 URL 路径。[更多信息在这里。](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritebase)

如果您曾经使用过 HTML 的`<base>`标签，那么原理几乎相同。如果您的主 localhost URL 是`http://localhost`，并且您的项目在子文件夹`http://localhost/my-project`中，那么您将使用`RewriteBase /my-project/`.

如果您没有使用 RewriteBase，并且您的项目位于子文件夹中，则必须将该子文件夹添加到您的每个 URL 和重写中，如下所示：

```
RewriteRule ^(.*)$ /my-project/index.php/$1 [L] 
```

* * *

深思熟虑：

*   **尽可能简单**地启动您的 .htaccess 文件。您立即投入的越多，出错的可能性就越大，调试起来就越困难。特别是如果您是 .htaccess 文件的菜鸟。不要盲目地复制和粘贴——弄清楚事情实际上做了什么。

*   系统文件夹访问部分现在是多余的——系统文件夹有自己的 .htaccess 来限制请求，就像应用程序文件夹一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T05:04:32.780

1.在 application/config.php 文件中进行以下更改

```
$config['base_url'] = 'http://'.$_SERVER['SERVER_NAME'].'/Your Ci folder_name';
$config['index_page'] = '';
$config['uri_protocol'] = 'AUTO'; 
```

2.在 .htaccess 文件中使用它：

```
RewriteEngine on
RewriteCond $1 !^(index\.php|resources|robots\.txt)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1 [L,QSA] 
```

并使用以下命令启用重写模式

```
 a2enmod rewrite 
```

并编辑文件 /etc/apache2/sites-enabled/000-default

```
change the AllowOverride None to AllowOverride All. 
```

最后重启你的服务器

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T16:35:45.693

您当然没有打开 mod_rewrite 或者您没有使用 MAMP 安装它

打开您的 httpd 配置文件并更改

```
# AllowOverride controls what directives may be placed in .htaccess files.
    # It can be "All", "None", or any combination of the keywords:
    #   Options FileInfo AuthConfig Limit
    #
    AllowOverride None 
```

至

```
AllowOverride All 
```

* * *

取消注释这一行：

```
#LoadModule rewrite_module libexec/apache2/mod_rewrite.so 
```

* * *

还要在此处对用户进行一些更改：/etc/apache2/users/username.conf

```
LoadModule php5_module        libexec/apache2/libphp5.so

DocumentRoot "/Users/username/where/ever/you/like"

<Directory "/Users/username/where/ever/you/like">
    Options Indexes MultiViews +FollowSymLinks
    AllowOverride All
    Order allow,deny
    Allow from all
</Directory> 
```

在此处获取更多信息[http://adam.merrifield.ca/2010/08/09/apache-mod_rewrite-php-and-os-x-10-6-snow-leopard/](http://adam.merrifield.ca/2010/08/09/apache-mod_rewrite-php-and-os-x-10-6-snow-leopard/)

* * *

重启 MAMP

* * *

要了解 mod_rewrite 是否打开，请按照 Stackoverflow 中的答案进行操作：

[如何检查是否在 php 中启用了 mod_rewrite？](https://stackoverflow.com/questions/9021425/how-to-check-if-mod-rewrite-is-enabled-in-php)

* * *

只是为了确保您的 .htaccess 不是问题，您可以试试这个。它已经过测试：

```
<IfModule mod_rewrite.c>

    RewriteEngine on
    RewriteBase /Users/me/works/project/web/

    # If the start of the URL doesn't match one of these...
    RewriteCond $1 !^(index\.php|robots\.txt|assets|cache|themes|uploads|css|images|js)

    # Route through index.php
    RewriteRule ^(.*)$ index.php/$1 [L]

</IfModule> 
```

上面授予了对某些文件夹的访问权限，并且 rewritebase 有一个尾部斜杠。

* * *

确保您有任何其他嵌套的 .htaccess 覆盖这个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-15T03:33:57.750

在您的虚拟主机上使用**AllowOverride All ：**

```
<Directory "/path/to/your/site">
    ....
    AllowOverride All
</Directory> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-02T12:34:13.923

我已经将 codeigniter 安装在如下格式的 url 中：http: [//11.12.34.45/~project/](http://11.12.34.45/~project/)

我尝试了不同的建议，最后这个以下网址提供了解决方案：

[https://ellislab.com/expressionengine/user-guide/urls/remove_index.php.html](https://ellislab.com/expressionengine/user-guide/urls/remove_index.php.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-27T09:52:56.210

我没有使用.htacces 解决了这个问题，而是将它们写入httpd.conf。我检查了 AllowOverride is All 但我不确定为什么 .htaccess 不起作用。因为我在这个问题上浪费了太多时间，所以我将使用这种方式。感谢您的回答。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-24T17:16:38.323

打开你的 httpd 配置文件 LoadModule **rewrite_module** modules/mod_rewrite.so 然后**AllowOverride All**

```
 <Directory "C:/xampp/htdocs"> //example for xampp
               Options Indexes FollowSymLinks Includes ExecCGI
               AllowOverride All
               Order allow,deny
               Allow from all
           </Directory> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-11-24T06:46:57.087

需要修改Apache的两个文件，httpd.conf httpd-vhosts.conf

在 httpd.conf 中改变它

```
<Files ".ht*">
Require all denied
</Files> 
```

至，

```
<Files ".ht*">
Require all granted
</Files> 
```

并在 httpd-vhosts.conf 中添加以下代码，

```
<VirtualHost *:8000>
ServerName localhost
DocumentRoot c:/wamp64/www
<Directory  "c:/wamp64/www/">
    Options +Indexes +Includes +FollowSymLinks +MultiViews
    AllowOverride All
    Allow from all
</Directory>
</VirtualHost> 
```````

# php - CakePHP - 我应该如何布局和命名我的表格

> ID：15079939
> 
> 赞同：1
> 
> 时间：2013-02-26T01:45:40.447
> 
> 标签：php, database, cakephp, foreign-keys

这是一个歌曲和歌词数据库。我正在尝试从我的数据库中烘焙一个应用程序，它看起来像这样：（每个表都有一个 ID，我只是把它省略了......）

```
songs
    song_name

artists
    artist_name

songs_singers
    artist_id (FOREIGN KEY artists.id)
    song_id (FOREIGN KEY songs.id)

songs_writers
    artist_id (FOREIGN KEY artists.id)
    song_id (FOREIGN KEY songs.id)

song_views
    song_id (FOREIGN KEY songs.id)

videos
    song_id (FOREIGN KEY songs.id)

video_views
    video_id (FOREIGN KEY videos.id) 
```

作家和歌手都是重叠的，即有的作家唱歌，有的歌手写作。

当我烘焙歌曲表时，我收到此错误： **错误：模型 Singer 的表歌手未在数据源默认值中找到。**

我认为问题在于 CakePHP 想要我为歌手创建一个新模型，所以我最终不得不在一个新的表歌手中复制作家和歌手的名字。我只想要存储在艺术家中的名称，并且将 song_singers 和 song_writers 都链接到具有外键 ID 的表。

歌曲有很多：

*   意见

*   视频

视频有很多：

*   意见

作家和歌手都有很多：

*   歌曲

我应该怎么办？

编辑：这是模型 SongsSinger。

* * *

```
class SongsSinger extends AppModel {

public $validate = array(
    'song_id' => array(
        'numeric' => array(
            'rule' => array('numeric'),
            //'message' => 'Your custom message here',
            //'allowEmpty' => false,
            //'required' => false,
            //'last' => false, // Stop validation after this rule
            //'on' => 'create', // Limit validation to 'create' or 'update' operations
        ),
    ),
    'artist_id' => array(
        'numeric' => array(
            'rule' => array('numeric'),
            //'message' => 'Your custom message here',
            //'allowEmpty' => false,
            //'required' => false,
            //'last' => false, // Stop validation after this rule
            //'on' => 'create', // Limit validation to 'create' or 'update' operations
        ),
    ),
);

public $belongsTo = array(
    'Song' => array(
        'className' => 'Song',
        'foreignKey' => 'song_id',
        'conditions' => '',
        'fields' => '',
        'order' => ''
    ),
    'Artist' => array(
        'className' => 'Artist',
        'foreignKey' => 'artist_id',
        'conditions' => '',
        'fields' => '',
        'order' => ''
    )
);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T18:12:33.747

你没有任何歌手（你称他们为艺术家）。

您的数据库应该是：

```
songs_artists
    artist_id (FOREIGN KEY artists.id)
    song_id (FOREIGN KEY songs.id) 
```

# python - ImportError：Mac 上没有名为 bs4 的模块

> ID：15079941
> 
> 赞同：3
> 
> 时间：2013-02-26T01:46:00.283
> 
> 标签：python, beautifulsoup, importerror

我今晚坐下来决定学习如何使用 python。受此网页抓取文章的启发。cam.ly/danesblog/2011/01/craigslist-arbitrage/

完成教程后，我：

1）下载并安装python： http: [//www.python.org/getit/](http://www.python.org/getit/) 先是3.3然后是2.7

2）下载bs4：www.crummy.com/software/BeautifulSoup/bs4/download/

3) 遵循 Brian Clapper 的说明： [如何在 Mac 上安装 Beautiful Soup 模块？](https://stackoverflow.com/questions/452283/how-can-i-install-the-beautiful-soup-module-on-the-mac)

*   尝试了 easy_install 和 python setup.py install 方法

我仍然收到“ImportError：没有名为 bs4 的模块”

Python安装在应用程序文件夹中，bs4包自动安装在库中这是问题吗？我尝试将文件夹复制并移动到 Python 应用程序中，但没有成功。

我也尝试了两种形式：

*   从 BeautifulSoup 导入 BeautifulSoup
*   从 bs4 导入 BeautifulSoup

谢谢你的支持。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2014-10-28T13:08:06.687

解决方案是设置安装包的路径。`.\~profile`EPD 或 Canopy 在和`.\~bash_profile`文件中创建他们的 VirtualEnv 设置。这些路径可能与 pip install 或 easy_install 尝试安装软件包的路径不同。如果您打开 bash_profile 或配置文件，则应该有一个类似于此的路径：

```
VIRTUAL_ENV_DISABLE_PROMPT=1 source /Users/test_user/Library/Enthought/Canopy_64bit/User/bin/activate 
```

我使用 Enthought 作为我的 python 编辑器，所以你的编辑器会是别的东西，但重要的是如果你使用 pip 或 easy_install，python 包的安装地址应该指向这里。或者换一种说法，您设置的活动虚拟环境就在这个地址中。

# macros - iMacros - 如何使用独特的周围 html 标记 URL？

> ID：15079942
> 
> 赞同：-1
> 
> 时间：2013-02-26T01:46:05.007
> 
> 标签：macros, web-scraping, imacros

我需要从下面的代码中提取“ [https://www.somesite.com/Some.Name.123 ”。](https://www.somesite.com/Some.Name.123)

该代码段重复了很多次，我需要 URL ..Some.Name.X。

我感兴趣的每个代码段之间还有其他代码段，周围的 html 非常不同。我不需要那些其他段中的 ..Some.Name.x URL。

以下是我需要的 URL 所独有的：`"<a class="-cx-PRIVATE-uiImageBlock__image"`

```
<div class="clearfix pvm">
<a class="-cx-PRIVATE-uiImageBlock__image -cx-PRIVATE-uiImageBlock__largeImage lfloat"
aria-hidden="true" tabindex="-1" href="https://www.somesite.com/Some.Name.123"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T16:13:20.910

我不知道如何用 iMacros 标记前面的 HTML，或者如何用 jQuery 来标记，因为每次结构都会有所不同，但你可以这样做。

使用 iMacros 保存网页。编写一个程序（c 等）来读取每个保存的文件，并将“cx-PRIVATE-uiImageBlock__image”后面的 URL 写入文件。将该 URL 列表添加到 iMacro，或让 iMacros 读取文件，然后处理来自 iMacro 的每个 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T17:33:45.683

您需要使用一些脚本。我的回答使用了 jQuery

```
var listoflinks = []; //array containing your links
$('a[href*="somesite.com"]').each(function () { // for each link that contains somesite.com in href
    var j = $(this).attr('href'); //put the whole href in a variable
    listoflinks.push(j); // put all values in an array
}); 
```

您最终会得到一个包含您要查找的所有 href 值的数组。

如果你想看一个例子和/或你想玩弄脚本，你可以去这里：http: [//jsfiddle.net/flish/rESjg/](http://jsfiddle.net/flish/HMXDk/)

已编辑您的代码仍然不够清晰，但希望这可能会有所帮助

```
<a class="sibling a" href="link">sibling a</a><br />
<div class="sibling div"><br />
    <a class="child a" href="start-with-link/correct-link">Child a</a><br />
</div><br /> 
```

以上是我使用的标记。这意味着我认为您具有以下元素： // 带有 sibking div

div // 有一个孩子 a

a // 并且它们都有适当的类

对于此标记，您可以使用以下代码（当然是 jQuery）

```
var listoflinks = []; //array containing your links
$('a[class="sibling a"]').siblings('div[class="sibling div"]').children('a[class="child a"]').each(function () {
    if ((($(this).attr("href")).substring(0,15))=="start-with-link"){
    var i = $(this).attr("href");
    listoflinks.push(i);
    }
    }); 
```

[在http://jsfiddle.net/flish/HMXDk/](http://jsfiddle.net/flish/HMXDk/)查看详细示例

尽管如此，您可以添加更多的兄弟元素和子元素，以防您忘记提及其他 html 实体

```
<a class="-cx-PRIVATE-uiImageBlock__image" ------------------ <div class="clearfix pvm"> <a class="-cx-PRIVATE-uiImageBlock__image -cx-PRIVATE-uiImageBlock__largeImage lfloat" aria-hidden="true" tabindex="-1" href="somesite.com/some.name.123"> 
```

例如，在上面的代码中 ------------------ 是什么意思？

# database - SPARQL 中的递归查询以浏览集合的集合

> ID：15079943
> 
> 赞同：8
> 
> 时间：2013-02-26T01:46:14.007
> 
> 标签：database, rdf, sparql

我正在尝试从 Mulgara RDF 存储创建 RDF 图，使用 Sparql 查询返回结果。我刚刚开始熟悉简单的查询，有效地询问“哪些对象是特定集合的成员？”

我的问题是，我非常感谢任何建议，我是否可以从这个简单的查询中获取结果并将它们重新路由回作为查询的对象？

例如，我有这个 sparql 查询：

```
SELECT ?x WHERE {?x  <fedora-rels-ext:isMemberOfCollection> <info:fedora/collection:ramsey>} 
```

有了这些结果：

```
"x"
info:fedora/ramsey:ThelifeandadventuresofRobinsonCrusoe 
info:fedora/ramsey:Jackanapes 
info:fedora/ramsey:SundayJournalvol01no0219951126 
info:fedora/ramsey:Ideologyandchange 
info:fedora/ramsey:theshepherdofthepyrenees 
info:fedora/ramsey:ScenesinAmerica
... 
```

我的目标是从原始查询中获取这些唯一标识符并替换对象 ,`<info:fedora/collection:ramsey>`并再次运行查询。

我正在想象一个场景，我将在初始查询中识别一个根元素，让结果返回所有成员对象，然后返回所有*这些*对象的成员对象，*无穷无尽......*

Sparql 查询可以做到这一点吗？具体来说，我相信我正在查询一个 Mulgara RDF 数据库。任何想法，即使它不可行，也非常感谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-26T02:22:37.110

假设您必须坚持使用 SPARQL 1.0。我相信 mulgara 对 SPARQL 1.1 的支持有限（如果有的话）。

使用 SPARQL 1.0，如果您可能知道要查询多少级别，您可以执行以下操作：

```
SELECT ?y WHERE {
        ?x  <fedora-rels-ext:isMemberOfCollection> <info:fedora/collection:ramsey>
        ?y  <fedora-rels-ext:isMemberOfCollection> ?x
} 
```

这里`?y`将与您的根目录中的 2 级元素绑定。使用 UNIONS，您可以一次查询多个级别。一个查询中从根开始的一级和二级的示例：

```
SELECT ?x WHERE {
     {
        ?x  <fedora-rels-ext:isMemberOfCollection> <info:fedora/collection:ramsey> .
     } UNION {
        ?zz  <fedora-rels-ext:isMemberOfCollection> <info:fedora/collection:ramsey>
        ?x  <fedora-rels-ext:isMemberOfCollection> ?zz .
     }
} 
```

这样做的问题是您并不真正知道在什么级别`?x`上受到约束。因此，您不能使用这种类型的查询绘制树。在 SPARQL 1.1 中，这可以通过[BIND AS解决](http://www.w3.org/TR/sparql11-query/#bind)

```
SELECT ?x ?level WHERE {
     {
        ?x  <fedora-rels-ext:isMemberOfCollection> <info:fedora/collection:ramsey> .
        BIND (1 AS ?level)
     } UNION {
        ?zz  <fedora-rels-ext:isMemberOfCollection> <info:fedora/collection:ramsey>
        ?x  <fedora-rels-ext:isMemberOfCollection> ?zz .
        BIND (2 AS ?level)
     }
} 
```

第二个查询将返回`?x`绑定的级别。您可以想象一些以编程方式生成的查询，其中有许多联合试图达到树的最大深度。如果您想完全支持 SPARQL 1.1，可以尝试使用[Jena/ARQ](http://jena.apache.org/documentation/query/index.html)。在 Jena 中，您还可以使用[属性路径](http://jena.sourceforge.net/ARQ/property_paths.html)和类似以下内容：

```
SELECT ?x WHERE {
    ?x  <fedora-rels-ext:isMemberOfCollection>+ <info:fedora/collection:ramsey> .
} 
```

您将绑定通过 predicate`?x`可访问的所有节点。`<info:fedora/collection:ramsey>``<fedora-rels-ext:isMemberOfCollection>`

# c++ - 显然模棱两可的调用不会导致 GCC 上的编译错误

> ID：15079947
> 
> 赞同：10
> 
> 时间：2013-02-26T01:46:44.520
> 
> 标签：c++, c++11, language-lawyer, diagnostics, ambiguous-call

令我惊讶的是，GCC 不**认为**`foo()`以下程序中的调用不明确：

```
#include <iostream>

struct B1 { bool foo(bool) { return true; } };
struct B2 { bool foo(bool) { return false; } };

struct C : public B1, public B2
{
    using B1::foo;
    using B2::foo;
};

int main()
{
    C c;

    // Compiles and prints `true` on GCC 4.7.2 and GCC 4.8.0 (beta);
    // does not compile on Clang 3.2 and ICC 13.0.1;
    std::cout << std::boolalpha << c.foo(true);
} 
```

上面的函数调用`true`在 GCC 4.7.2 和 GCC 4.8.0（beta）上编译并返回，而在 Clang 3.2 和 ICC 13.0.1 上它*不会编译*（如我所料）。

**这是“*不需要诊断*”的情况，还是 GCC 中的错误？**鼓励参考 C++11 标准。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T03:41:42.593

§7.3.3/3：

> 在用作成员声明的 using-declaration 中，nested-name-specifier 应命名正在定义的类的基类。如果这样的 using 声明命名了构造函数，则嵌套名称说明符应命名正在定义的类的直接基类；否则**它会引入由成员名称查找 (10.2, 3.4.3.1) 找到的声明集**。

¶14：

> ... [注意：两个 using 声明可能会引入具有相同名称和相同参数类型的函数。如果对于非限定函数名的调用，函数重载决议选择了由这种 using 声明引入的函数，则该函数调用格式错误。

¶16：

> 出于重载决议的目的，通过 using 声明引入派生类的函数将被视为派生类的成员。

因此，`using`声明是合法的，但是正如您所说，这些函数是同一个重载集中的对等体，并且程序格式不正确。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T02:05:53.393

`foo(true)`正如您所说，您的程序中的调用显然是模棱两可的；此外，根据§10.2 中提出的算法，它是模棱两可的，因此，它应该在使用时被标记。（标记`using`声明是不正确的；10.2(1) 明确指出，名称的模棱两可使用在查找时标记，而不是在声明时标记。）

将这个程序与一个类似的程序进行对比是很有趣的，它是[一个公认的 gcc 错误](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=46687)的主题（从那个错误报告稍微修改以使并行更清晰）：

```
#include <iostream>

struct A {
   static int foo() {return 1;}
   static int foo(char) { return 2;}
};

struct B1 : A {
//   using A::foo;
};
struct B2 : A {
//   using A::foo;
};

struct C : B1, B2 {
//   using B1::foo;
//   using B2::foo;
};

int main()
{
    std::cout << C::foo();
} 
```

上述程序是正确的；尽管菱形继承，`foo`是 的静态成员`A`，所以它不是模棱两可的。事实上，gcc 编译它没有问题。但是，取消注释 的两个实例（`using A::foo`这不会改变任何一个`foo`）会导致 gcc 产生错误报告中指出的奇怪的重复错误。取消注释里面的两个`using`声明`C`，这可能会触发另一个错误，这是这个问题的主题，然后掩盖`static function`错误并导致程序再次编译。

clang 似乎可以处理该程序的所有可能变体，因为它的价值。

最后，请注意，`foo(bool)`在`C`（在原始程序中）显式声明的内容将胜过任何通过声明`foo(bool)`带入`C`'s 范围的内容。`using`我怀疑这两个错误都是由于记账不当造成的，同时试图跟踪每个类范围内的各种函数声明及其各自的出处（作为`using`声明和函数声明的序列）。

# android - 在 Fragment 中选择 AsyncTaskLoader 和 AsyncTask 的指南

> ID：15079948
> 
> 赞同：30
> 
> 时间：2013-02-26T01:46:50.493
> 
> 标签：android

看[LoaderCustomSupport](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android-apps/4.0.1_r1/com/example/android/supportv4/app/LoaderCustomSupport.java)（使用AsyncTaskLoader）和[FragmentRetainInstanceSupport](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android-apps/4.0.1_r1/com/example/android/supportv4/app/FragmentRetainInstanceSupport.java)（使用Thread，几乎相当于AsyncTask）

这两个例子有以下相似之处。

*   加载数据时两者都不会阻塞 UI 线程
*   当用户执行屏幕旋转等配置更改时，数据获取线程不会被破坏。
*   当数据获取线程完成数据获取后，它可以更新到正确的 Fragment UI

但是，也有区别。

## 异步任务加载器

*   似乎没有简单的方法可以将中间进度更新到进度条对话框

## 异步任务

*   不确定这一点。但 Android 文档似乎推荐[AsyncTaskLoader](http://developer.android.com/reference/android/content/AsyncTaskLoader.html)用于**异步数据加载并将最终结果更新到 UI**？

是否有任何指南或清单可供查看，以决定是选择 AsyncTaskLoader 还是 AsyncTask，执行耗时的加载任务并将结果更新到 Fragment 的 UI？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-03-12T10:15:49.623

你的问题让我很感兴趣，并且有时会尝试研究其中的差异。我在这里写下我的观察。

1.  对于提前终止，使用 AsyncTask 的异步任务将继续在其线程中运行。结果的处理可能很快导致未请求的结果，而 AsyncTaskLoader 处理活动的过早终止

2.  AsyncTaskLoader 处理活动配置更改（即用户旋转屏幕时的 IE）。

3.  AsyncTaskLoader 旨在为 DataAdapter 加载数据，因此最好使用 AsyncTaskLoader 但是如果您需要在任务完成后更改 UI（特别是片段），最好使用 AsyncTask，因为您无法在 AsynTaskLoader 的 onLoadFinished 中更改片段。

所以对我来说，用法取决于你的任务。如果以上 3 点不打扰您，那么性能是相同的（虽然没有找到任何文档，但在这种情况下建议使用 asynctaskloader :S）

一些相关链接

[AsyncTaskLoader 与 AsyncTask](https://stackoverflow.com/questions/7120813/asynctaskloader-vs-asynctask)

[http://andreas-kluck.blogspot.com/2012/02/asynctask-and-asynctaskloader.html](http://andreas-kluck.blogspot.com/2012/02/asynctask-and-asynctaskloader.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T19:52:07.363

AsyncTaskLoaders 和所有的 Loader 一样，旨在解决旋转问题，即在 Activity 上创建 AsyncTask，然后在任务完成之前旋转设备，AsyncTask 将随着 Activity 的销毁而丢失。

确实，目前所有的加载器都不支持发布进度，所以如果这是您的情况的要求，那么您应该考虑替代方案。如果旋转或导致 Activity 被销毁的任何其他事件都不是问题，那么只需使用 AsyncTask，否则您可能想要使用服务，并注册一个活页夹来来回推送进度消息。

在我看来，Service 和 Binder 消息有点痛苦。我发现一个更简单的解决方案是使用[LocalBroadcastManager](https://developer.android.com/reference/android/support/v4/content/LocalBroadcastManager.html)从 IntentService（或 AsyncTaskLoader）发送进度广播，并让 Activity 中的 BroadcastReceiver 接收广播并显示进度。

# xcode - UIImageView：通过自动布局使用所有可用空间

> ID：15079950
> 
> 赞同：1
> 
> 时间：2013-02-26T01:47:02.973
> 
> 标签：xcode, ios6, autolayout

我正在尝试使用自动布局来最小化 a `UIImageView`（绿色）和 a `UICollectionView`（红色）之间的差距。在模拟器中（我假设它显示的是 iPhone 4 尺寸的屏幕），两个视图很好地排列在一起，它们之间只有很小的差距：

![iPhone 4 模拟器图片](../Images/5eb8bf36d3ce12cfae7d65f8f6dc3277.png)

然而在我的实际设备上，一个更大屏幕的 iPhone 5，有一个很大的差距：

![iPhone 5 实际设备图片](../Images/2ec4ad73d1c5efd975f1c98c6f908573.png)

如何指定自动布局约束，以便`UIImageView`（绿色框）占用尽可能多的空间，无论屏幕大小如何，同时保持`UICollectionView`固定到底部工具栏？

我尝试在 XCode 中调整约束、添加引脚等，但没有取得多大成功。我觉得我只是在胡思乱想，并没有真正理解它们是如何工作的，而且我还没有找到一个很好的教程来解释如何做一些事情，比如“扩展以占用尽可能多的垂直空间”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T23:56:16.497

所以需要指定两个view之间的间隙是固定的，底部view的高度也是固定的。在视觉格式语言中

```
"V:|[topView]-[bottomView(==150)]|" 
```

`V:`表示这是一个垂直约束

`|[topView]`意味着将顶部固定在`topView`尽可能靠近超级视图的顶部边缘的位置。

`-`意味着两个视图之间的空间是固定的

`[bottomView(==150)]`表示`bottomView` **必须**为 150 像素

`]|`表示的底边`bottomView`被固定到superview的底边

您还可以通过在底视图上设置固定高度以及顶视图和底视图之间的固定间隙来在 Interface Builder 中添加这些约束

# c - 如何在 C 中使用枚举

> ID：15079954
> 
> 赞同：17
> 
> 时间：2013-02-26T01:47:29.700
> 
> 标签：c, enums, linked-list

基本上我们必须为餐厅等待队列实现一个队列（链表）。

使用可以获得额外积分，`enum`但我以前从未使用过它。我想知道这看起来是否正确，我如何使用它？我已经查过了，但没有看到任何使用链表的例子。

这是我们结构的说明：

> 在编写代码时，您必须为等待列表的链表中的节点创建一个 C 结构。这些数据项必须包括以下内容（如果需要，还可以包括其他内容）。
> 
> *   组名
>     
>     
> *   指定组大小的整数变量（组中的人数）
>     
>     
> *   餐厅内状态（使用枚举的额外积分！）
>     
>     
> *   指向列表中下一个节点的指针
>     
>     
> 
> 餐厅状态为walk-in或call-in（提前致电以将姓名列入等候名单）

这是我的结构：

```
typedef struct restaurant
{
    char name[30];
    int groupSize;
    enum status{call, wait};
    struct restaurant *nextNode;
}list; 
```

我问是因为我在编译时收到了这个警告：

> ```
> lab6.c:11:28: warning: declaration does not declare anything [enabled by default] 
> ```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-26T01:56:57.553

您的 struct typedef 基本上是说“如果我的记录中有一个“状态”字段，它的值可能是“调用”或值“等待”。警告基本上是说“您从未分配过一个字段”。

可能的变化：

```
enum status {CALL, WAIT};

typedef struct restaurant
{
    char name[30];
    int groupSize;
    enum status my_status;
    struct restaurant *nextNode;
}list; 
```

这里有更多信息：

*   [如何在 C 中定义枚举类型（enum）？](https://stackoverflow.com/questions/1102542/how-to-define-an-enumerated-type-enum-in-c)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-26T02:01:26.060

您`enum`必须在结构之外声明：

```
enum Status {call, wait};

typedef struct restaurant
{
    char name[30];
    int groupSize;
    struct restaurant *nextNode;
} list; 
```

或者必须在结构中声明该类型的成员：

```
typedef struct restaurant
{
    char name[30];
    int groupSize;
    enum Status {call, wait} status;
    struct restaurant *nextNode;
} list; 
```

或两者：

```
enum Status {call, wait};

typedef struct restaurant
{
    char name[30];
    int groupSize;
    enum Status status;
    struct restaurant *nextNode;
} list; 
```

您也可以为 the 创建一个 typedef `enum Status`。由于标签（例如`Status`in `enum Status`）与结构成员位于不同的命名空间中，因此您实际上可以使用：

```
enum status {call, wait} status; 
```

并且编译器不会感到困惑，但您很可能会感到困惑。

很多时候，人们在 ALL_CAPS 中编写枚举常量。这部分是使用`#define WAIT 0`and`#define CALL 1`而不是`enum Status { WAIT, CALL };`.

# android - 如何为 ContactsContract 编辑器指定帐户

> ID：15079961
> 
> 赞同：1
> 
> 时间：2013-02-26T01:47:47.767
> 
> 标签：android, account, contactscontract

从我的应用程序中，我想调用联系人编辑器以允许用户添加新联系人。我想找到一种方法让应用程序将要使用的帐户传递给编辑器。如何才能做到这一点？

我还没有找到任何有关如何执行此操作的文档。我确实在 github 上找到了一些代码，它显示了一个联系人编辑器正在检索帐户信息（请参阅[ContactEditorActivity](https://raw.github.com/android/platform_packages_apps_contacts/master/src/com/android/contacts/activities/ContactEditorActivity.java)）。它调用

```
 getParcelable(Intents.Insert.ACCOUNT); 
```

我认为这必须是不推荐使用的代码，因为我在引用中的任何地方都找不到值 Intents.Insert.ACCOUNT。

总的来说，我调用编辑器的代码是有效的；这是一个摘录：

```
 Intent intent = new Intent();
  intent.setAction (Intent.ACTION_INSERT);
  intent.setData (ContactsContract.Contacts.CONTENT_URI);
  intent.putExtra (ContactsContract.Intents.Insert.NAME, name);
  ... "put" other values ...
  startActivityForResult (intent, ACTIVITY_REQUEST_FULL_EDIT); 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-06-08T03:46:06.583

我知道这是一个老问题，但这是我的解决方案，似乎对我有用，以防万一有人遇到同样的问题。

我在 Android 上使用 Xamarin，但 Java 代码几乎相同。

对于 API 23+，使用 ExtraAccount 字段 EG：

```
Android.Accounts.Account account = new Android.Accounts.Account(accountName, accountType);

...
intent.PutExtra(ContactsContract.Intents.Insert.ExtraAccount, account);
... 
```

对于较旧的 API，我使用了“com.android.contacts.extra.ACCOUNT”字段，例如：

```
Android.Accounts.Account account = new Android.Accounts.Account(accountName, accountType);

...
intent.PutExtra("com.android.contacts.extra.ACCOUNT", account);
... 
```

这打开了联系意图，默认为传入的帐户（绕过任何电话默认值）。这很方便，因为我正在设置一大堆信息，例如 url、职位等，并且由于联系意图默认为 SIM 卡而丢失了 - 它无法保存这些数据！

如果您想知道如何在手机上获取帐户，您可以使用：

```
AccountManager.Get(context).GetAccountsByType("com.google"); 
```

获取谷歌账户，或

```
AccountManager.Get(context).GetAccounts(); 
```

获取所有帐户。但是不包括电话帐户或 SIM 帐户，所以我使用此代码来获取这些：

```
 using Android.Accounts;

...

    public List<Account> GetAccounts()
    {
            if (CheckReadContactsPermission())
            {
                var accountList = new List<Account>();
                var uri = ContactsContract.Settings.ContentUri;

                string[] projection = { ContactsContract.Settings.InterfaceConsts.AccountName,
                                    ContactsContract.Settings.InterfaceConsts.AccountType };

                var loader = new CursorLoader(context, uri, projection, null, null, null);
                var cursor = (ICursor)loader.LoadInBackground();

                if (cursor.MoveToFirst())
                {
                    do
                    {
                        accountList.Add(new Account(cursor.GetString(cursor.GetColumnIndex(projection[0])),
                            cursor.GetString(cursor.GetColumnIndex(projection[1]))));
                    } while (cursor.MoveToNext());
                }

                return accountList;
            }

            return null;
        } 
```

# javascript - 我在 jquery/javascript 中的动态附加 td 有什么问题？

> ID：15079964
> 
> 赞同：0
> 
> 时间：2013-02-26T01:48:06.990
> 
> 标签：javascript, jquery

我有一个表，其中每一行包含两个元素：

```
<table>
<tr><td>A</td><td>B</td></tr>
<tr><td>C</td></tr>
</table> 
```

我正在尝试将带有“D”的单元格附加到最后一行（当前表中已经存在的第二行），但是遇到了困难。

我试图执行：

```
$("table").children().get(1).append("<td>D</td>"); 
```

和

```
var elem = $("<td/>", {
    text: 'D'
});

$("table").children().get(1).appendChild(elem); 
```

我得到了错误：

```
Uncaught Error: NotFoundError: DOM Exception 8 
```

将 tbody 放在那里也不起作用：

```
$("table tbody").children().get(1).appendChild(elem); 
```

什么是正确的方法来做到这一点？

我不想仅仅依赖于“最后一个 td”，因为假设我有另一个元素“E”，我希望它自己自动添加到第三行，而不是在末尾添加它作为第三列第 2 行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T01:50:22.237

尝试：

```
$("table td:last").after("<td>D</td>"); 
```

[**jsFiddle 示例**](http://jsfiddle.net/j08691/yeEgv/1/)

结构中的结果：

```
<table>
<tbody><tr><td>A</td><td>B</td></tr>
<tr><td>C</td><td>D</td></tr>
</tbody></table> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T01:58:39.757

试试这个：

```
$('<td>D</td>').appendTo('table tr:eq(1)'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T05:25:06.910

您可以通过从现有字母中查找下一个字母来动态附加。可能您需要根据您的要求进行修改。

HTML

```
<table>
    <tr>
        <td>A</td>
        <td>B</td>
    </tr>
    <tr>
        <td>C</td>
    </tr>
</table><button type="button" id="addanother" >Add</button> 
```

JS：

```
$('#addanother').on('click',function(){
    var length=$('table').find('td:last').parent().children().length;
    var text=$('table').find('td:last').text();
     var nextlet=nextLetter(text);
    if(length == 2){
         $('table').find('tr:last').after('<tr><td>'+nextlet+'</td></tr>');
    }else if(length == 1){
           $('table').find('td:last').after('<td>'+nextlet+'</td>');
    }
  });

// To get alphabets from A-Z from a-z
  function nextLetter(s){
return s.replace(/([a-zA-Z])[^a-zA-Z]*$/, function(a){
    var c= a.charCodeAt(0);
    switch(c){
        case 90: return 'A';
        case 122: return 'a';
        default: return String.fromCharCode(++c);
    }
}); 
```

}

提琴手：http: [//jsfiddle.net/j98H7/1/](http://jsfiddle.net/j98H7/1/)

# mysql - 为什么 information_schema.tables.data_free 总是 8388608？

> ID：15079965
> 
> 赞同：0
> 
> 时间：2013-02-26T01:48:10.217
> 
> 标签：mysql

任何人都知道为什么 InnoDB 中的 information_schema.tables.data_free 总是 8388608，无论表中有多少行；

```
table_schema    table_name  table_rows  data_free   engine

g33v1       appraise    0       8388608     InnoDB

g33v1       areatype    12403       8388608     InnoDB

g33v1       atype       581982      8388608     InnoDB

g33v1       atype2      579700      8388608     InnoDB 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T05:21:50.427

我认为这是为进行排序和其他需要硬盘空间的事情分配的临时表最大大小。因为在其他情况下也会出现同样的情况

```
mysql> show global variables like '%tmp%';
+----------------+-----------------------+
| Variable_name  | Value                 |
+----------------+-----------------------+
| bdb_tmpdir     | /usr/local/mysql/tmp/ |
| max_tmp_tables | 32                    |
| tmp_table_size | 8388608               |
| tmpdir         | /usr/local/mysql/tmp  |
+----------------+-----------------------+

mysql> show global variables like '%myisam%';
+---------------------------------+---------------+
| Variable_name                   | Value         |
+---------------------------------+---------------+
| myisam_data_pointer_size        | 4             |
| myisam_max_extra_sort_file_size | 2147483648    |
| myisam_max_sort_file_size       | 2147483647    |
| myisam_recover_options          | OFF           |
| myisam_repair_threads           | 1             |
| myisam_sort_buffer_size         | 4194304       |
| myisam_stats_method             | nulls_unequal |
+---------------------------------+--------------- 
```

# c++ - 在 C++ 中正确重新分配内存

> ID：15079966
> 
> 赞同：0
> 
> 时间：2013-02-26T01:48:10.417
> 
> 标签：c++, memory-management, realloc

```
#include <iostream>
#include <stdlib.h>

class circuitTypes{

protected:
    static int size;
    circuitTypes **Matrix;
    int input1,input2;
    int output1, output2;

public:

    circuitTypes() {};
    static int getSize() { return size; };
    static void upSize() { size++; };
    void ItemRegistry();
    virtual void setTruthTable()=0;
    void setInputAndCalculateOutput(int a, int b);
    int *getOutput();
};

int circuitTypes::size=0;

int *circuitTypes::getOutput(){
    int Output[2];
    Output[0]=output1;
    Output[1]=output2;
    return Output;
}
void circuitTypes::ItemRegistry(){

    circuitTypes::upSize();
    int circuitSize=circuitTypes::getSize();

    if(circuitSize==1)
        Matrix=(circuitTypes **)malloc(circuitSize*sizeof(circuitTypes *));
    else
        Matrix=(circuitTypes **)realloc(Matrix,circuitSize*sizeof(circuitTypes *));
    if(Matrix==0){
        std::cout <<"No available memory \n";
        exit(1);
    }
    Matrix[circuitSize-1]=this;
}

void circuitTypes::setInputAndCalculateOutput(int a, int b){
    input1=a;
    input2=b;
    setTruthTable();
}

class TypeA : private circuitTypes{

public:
    TypeA() { ItemRegistry(); };
    void setTruthTable();
};

void TypeA::setTruthTable(){
    if (input1==0){
        if (input2==0){
            output1=0;
            output2=0;
        }
        else{
            output1=0;
            output2=1;
        }
    }
    else{
        if (input2==0){
            output1=0;
            output2=1;
        }
        else{
            output1=1;
            output2=1;
        }
    }
}

class TypeB : private circuitTypes{
public:
    TypeB() { ItemRegistry(); };
    void setTruthTable();
};

void TypeB::setTruthTable(){
    if (input1==0){
        if (input2==0){
            output1=0;
            output2=0;
        }
        else{
            output1=0;
            output2=1;
        }
    }
    else{
        if (input2==0){
            output1=1;
            output2=1;
        }
        else{
            output1=0;
            output2=1;
        }
    }
}

void circuit (circuitTypes **Example, int a, int b){
    std::cout << "NIKKK";
    Example[0]->setInputAndCalculateOutput(a,b);
    int Size=Example[0]->getSize();
    for (int i=1;i<Size;i++){

        Example[i]->setInputAndCalculateOutput(Example[i-1]->getOutput()[0],Example[i-1]->getOutput()[1]);

    }
    std::cout << "For input a= " << a << " and b= " << b << " the result is c= " << Example[Size-1]->getOutput()[0] << " and d=" << Example[Size-1]->getOutput()[1] << "\n";
}

int main (){

    circuitTypes **Example;
    TypeA A1,A2,A3;
    TypeB B1,B2,B3;
    for (int i=0;i<2;i++){

        for (int j=0;j<2;j++){
            circuit (Example,i,j);
        }

    }

} 
```

我很抱歉代码的大小，但由于我不知道问题出在哪里，我决定发布整个程序。.cpp 文件在 Ubuntu 11.10（使用 g++）中编译没有任何问题，但是当我尝试执行 a.out 文件时出现此错误：

*** 检测到 glibc****./a.out: realloc(): 无效指针: 0x003c2ff4 ** **

 *======= 回溯：=========

/lib/i386-linux-gnu/libc.so.6(+0x721a2)[0x2b71a2]

/lib/i386-linux-gnu/libc.so.6(realloc+0x2a5)[0x2bb245]

./a.out[0x8048835]

./a.out[0x8048ca9]

./a.out[0x8048b2a]

/lib/i386-linux-gnu/libc.so.6(__libc_start_main+0xf3)[0x25e113]

./a.out[0x80486c1]

======= 内存映射：========

00110000-0012c000 r-xp 00000000 08:06 1311674 /lib/i386-linux-gnu/libgcc_s.so.1

0012c000-0012d000 r--p 0001b000 08:06 1311674 /lib/i386-linux-gnu/libgcc_s.so.1

等等

谁能帮我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T02:09:31.887

```
 if(circuitSize==1)
       Matrix=(circuitTypes **)malloc(circuitSize*sizeof(circuitTypes *));
   else
       Matrix=(circuitTypes **)realloc(Matrix,circuitSize*sizeof(circuitTypes *)); 
```

我不明白`if`这里的条件。应该是`if (Matrix == 0)`吧？否则，您将冒着尝试从一开始`realloc`就从未做过的事情的风险`malloc`。

但我同意@JerryCoffin 的观点，你应该把它扔掉并使用`std::vector`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T02:17:40.263

1.  设置 Matrix = realloc 是不好的，因为如果 realloc 失败，您将永远无法释放它。但是无论如何您都会立即退出，因此代码不会泄漏，但这仍然是不好的做法。
2.  您只是在声明 circuitTypes **Example 并在 circuit(Example, i, j) 中使用它，而不给它分配内存。您可能想为此使用 Matrix。
3.  这是一个纯粹的猜测：你的代码的结构方式让我认为你想让 Matrix 成为静态并使用它而不是 Example。*

# git - 使用 gmail 打开 Bitbucket 帐户后的 SourceTree 密码

> ID：15079971
> 
> 赞同：28
> 
> 时间：2013-02-26T01:48:23.507
> 
> 标签：git, atlassian-sourcetree

我使用我的 gmail 帐户创建并登录到我的 bitbucket 帐户（类似于我如何处理堆栈溢出）。现在我正在尝试通过 SourceTree 访问我的存储库。当它要求输入密码时，我不确定要输入什么。当我输入我的谷歌凭据时，它失败了。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-11-22T11:49:47.230

安装*SourceTree*时，安装向导会提示您输入*BitBucket的***用户名**和**密码**。 **这与您的 ssh 密钥无关，**因为稍后会出现。

 *****用户**名- 请参阅**Bitbucket.Manage Account.Change Username**以找到正确的用户名。这与您的 Google 帐户不同，或者如果值匹配，那么这是巧合。

**密码**- 这是您创建帐户时的密码。如果您忘记了，请参阅**Bitbucket.Manage Account.Change Password**。然后，您应该在安装向导中输入它。

最后，向导将询问 ssh 密钥，此时需要提供您的 ssh 密码，假设您有一个。

享受

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-08-19T07:47:47.543

您必须在 bitbucket 设置中为 Sourcetree 创建一个新的应用密码

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2014-03-11T04:02:12.197

我有一个类似的问题。

只使用小写的用户名解决了我***

# android - 应用内计费是否可以使用以前的 ID（包括版本更改）来将购买了以前版本的用户记入新版本？

> ID：15079972
> 
> 赞同：2
> 
> 时间：2013-02-26T01:48:32.837
> 
> 标签：android, in-app-billing, in-app

我们将弃用旧的 .apk，而新的 .apk 将具有不同的 ID。我们可以使用应用内结算来查询用户的 Google Play 帐户而不向他们收取新帐户的费用吗？我想我读到你可以通过列出以前的 ID 来做到这一点，然后当应用程序看到它们时，它不会向用户收费，然后让他们下载新版本。

即，旧的 .apk 具有以下与销售相关的 ID：

*   标识 v1：`com.yourname.here:1:1`
*   标识 v1：`com.yourname.here:1:2`
*   标识 v2：`com.yourname.here:1:3`
*   标识 v2：`com.yourname.here:1:4`

新的 .apk 将具有不同的 ID `com.myname.here`：.

我想确保购买旧版本的人在去 Play 商店获取最新版本时不会被收费。我只希望以前没有购买过它的人获得全额费用。

谁能告诉我如何使用 API 执行此操作，并可能展示一个小示例？

我在[此页面](http://developer.android.com/google/play/billing/api.html)上看到，Google 让我相信您可以使用捆绑包和 getPurchase 请求来做到这一点。以下来自上述 URL，步骤 #2。

> `2.`当您的应用程序启动或用户登录时，最好使用 Google Play 检查以确定用户拥有哪些项目。要查询用户的应用内购买，请发送 getPurchases 请求。如果请求成功，Google Play 会返回一个 Bundle，其中包含已购买项目的产品 ID 列表、单个购买详细信息列表以及购买签名列表。

谢谢！

# html - 表 TR onClick 与表上的链接

> ID：15079973
> 
> 赞同：1
> 
> 时间：2013-02-26T01:48:49.507
> 
> 标签：html, hyperlink, onclick, html-table

我有这个DEMO情况： [http ://carreradesign.com.br/teste/admin](http://carreradesign.com.br/teste/admin)

我在表格行（tr）上使用“onClick”，但我在 X 图像上还有第二个链接来删除该行......但是当我点击 X 链接时，我被重定向到 tr链接太...如何使用 X 上的链接而不重定向到行上的链接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T01:54:16.767

您也可以尝试对 X 按钮使用 jQuery 事件处理程序。在 X 按钮的事件处理程序中，调用`event.stopPropagation();`. 这会阻止事件冒泡，从而阻止父级处理事件。

一个例子：

```
$('.xbtn').click(function(event){
  event.stopPropagation();
  ...// do stuff
} 
```

# jquery - 最简单的 jQuery 插件，为什么这不起作用？

> ID：15079974
> 
> 赞同：0
> 
> 时间：2013-02-26T01:48:50.480
> 
> 标签：jquery, jquery-plugins

我一定错过了一些非常基本的东西，我认为我需要一个纸板伙伴。我已经向 jQuery 添加了一个新方法，但是，就像下面的 firebug 命令行体验一样，它只是不起作用，因为该方法不存在。

jQuery 教程都说要完全写这段代码，有什么问题吗？

> $.fn.bob = function() {alert('bob!');}

>函数（）

> $.bob()

>TypeError: $.bob 不是函数

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T01:56:20.127

`$.fn`指的是jQuery函数`$()`：

所以你的函数必须像这样调用：

```
$('anything').bob(); 
```

您也可以直接扩展 jQuery 对象，并按照您的意图调用该函数：

```
$.bob = function(){ alert('bob!') }
$.bob(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T01:55:14.747

您需要在 jquery 对象上使用它：

`$('body').bob()`

# vba - 从 =OFFSET 范围名称创建新范围名称

> ID：15079975
> 
> 赞同：1
> 
> 时间：2013-02-26T01:48:55.207
> 
> 标签：vba, excel

我正在尝试使用以下代码从旧的范围名称创建一个新的范围名称：

```
 Dim Range1 As Range
  Set Range1 = ActiveWorkbook.Sheets("SheetName").Range("OldRangeName")
  ActiveWorkbook.Names.Add Name:="NewRangeName", RefersTo:=Range1 
```

源范围（“OldRangeName”）定义为：

```
 =OFFSET('SheetName'!$B$3,0,0,COUNTA('SheetName'!$B:$B)-2,1) 
```

但是上面的代码导致 NewRangeEnds 不是用上面的 =OFFSET 定义的，而是用 =OFFSET 产生的范围定义的。

例如，新范围可能是：

```
 ='SheetName'!$B$3:$B$40 
```

我怎样才能让新范围成为像源一样的 =OFFSET 公式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T11:38:29.240

更改`RefersTo:=Range1`为`RefersTo:=Range1.RefersTo`

但这仅在您将范围更改为名称时才有效：

```
Dim Name1 As Name
Set Name1 = ActiveWorkbook.Names("OldRangeName")
ActiveWorkbook.Names.Add Name:="NewRangeName", RefersTo:=Name1.RefersTo 
```

# c - 如何在没有 wmi 的情况下在 C 或 asm 中获取硬盘序列号

> ID：15079976
> 
> 赞同：0
> 
> 时间：2013-02-26T01:48:56.993
> 
> 标签：c, windows, assembly, hardware-id

如何在没有 wmi 的情况下在 C 或 asm 中获取硬盘驱动器序列号（不是每次重新安装 Windows 时更改的卷号）（因为 wmi 需要管理员权限）。任何线索都会有所帮助，因为现在我在没有 wmi 的情况下在 C 的网络上找不到任何东西，在几天的搜索中......谢谢。编辑：对于 Windows 系统

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T21:58:22.177

请尝试我的开源工具 DiskId32，它的源代码位于 [http://www.winsim.com/diskid32/diskid32.html](http://www.winsim.com/diskid32/diskid32.html)。我目前只有一个 Win32 版本。也许有一天我会添加一个Win64版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T02:32:33.333

据我所知，硬盘驱动器序列号和有关硬盘驱动器的其他信息（如固件版本等）只能使用 SMART 获得，这需要块设备节点（/dev/sda 或 /dev/sdb）的特殊 ioctls普通用户通常无法使用。

我知道有一个名为 smartctl 的工具可以做到这一点：

```
sudo smartctl -i /dev/sda 
```

也存在类似的工具（hdparm、lshw 等）。

至于试图在不成为特权用户的情况下找出这些信息，只有当它通过 /proc 或 /sys 公开时才有可能，我非常怀疑当前的 SATA 块设备驱动程序正在执行此操作。

# ruby-on-rails-3.2 - Rails 3 中的良好实践路由方式

> ID：15079980
> 
> 赞同：0
> 
> 时间：2013-02-26T01:49:11.740
> 
> 标签：ruby-on-rails-3.2

在其他同事编写的路由文件中，我看到如下内容：

```
 match 'providers/:provider_id/scorecards', to: 'scorecard#show', via: :get
  match 'patients/:id/summary', to: 'patients#show', via: :get 
```

所以他们没有在路由文件中定义任何“资源”。就这样。

这样做真的正确吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T02:03:32.443

`resources`只是声明 RESTful 路由的一种简单方法。但是，它们遵循默认模式。对于您的同事，他们已经声明了一个自定义路由，因此 URL 看起来与正常的不同。这可能是因为他们正在执行的其他一些路由的一致性，或者是因为外部 API 或第 3 方应用程序请求他们必须适应的特定 URL。

第一条路线可以以不同的方式呈现，因为它看起来像一个嵌套资源

```
resources :providers do 
 resources :scorecards
end 
```

第二个`match`肯定看起来更加定制。

# spring - Spring-JPA：更新父实体无法持久化新的子实体，而是将它们解释为瞬态

> ID：15079981
> 
> 赞同：8
> 
> 时间：2013-02-26T01:49:12.973
> 
> 标签：spring, hibernate, jpa, transactional

我是 Spring/JPA/Hibernate 的新手，虽然这听起来很简单，但现实并非如此。我可以使用一些帮助。

我有一个包含子实体列表的父实体。我将使用这些来简化讨论：

```
@Entity
public class Parent {
    @Id
    @GeneratedValue(strategy=GenerationType.IDENTITY)
    private Long id;

    @OneToMany(fetch=FetchType.EAGER, cascade = CascadeType.ALL, mappedBy="parent")
    private List<Child> children= new ArrayList<Child>();

    etc...
}

@Entity
public class Child {
    @Id
    @GeneratedValue(strategy=GenerationType.IDENTITY)
    private Long id;

    @ManyToOne
    private Parent parent;

    etc...
}

@Repository
public interface ParentRepository extends JpaRepository<Parent, Long> {}; 
```

第 1 轮，我创建了一个新的父级和一个新的子级，将子级添加到父级列表中，并将父级设置在子级上。当我保存父母时，孩子也被保存了。

```
@Transactional(propagation=Propagation.REQUIRES_NEW)
void create() {
    Parent parent = new Parent();
    Child  child  = new Child();
    parent.add(child);
    child.setParent(parent);
    parent = repository.save(parent);
} 
```

现在，第 2 轮，我添加了一个新孩子：

```
@Transactional(propagation=Propagation.REQUIRES_NEW)
void update() {
    Parent parent = repository.findOne(parentID);
    Child newChild = new Child();
    newChild.setParent(parent);
    parent.add(newChild);
    parent = repository.save(parent);
} 
```

不过，这一次新来的孩子从来没有坚持过！

我已经尝试了 CascadeType、@GeneratedValue GenerationType、@Transactional Propagation 类型的几乎所有变体......

通过休眠（痛苦！）跟踪这一点，这就是我发现的：

*   第二次保存时，问题出在第二个（新）孩子身上。
*   问题似乎是，当需要持久化父级的子级列表时，新子级不在 EntityManager 中（尚未），因此被认为是瞬态的。
*   结果，它被有效地作为 null 向下传递，导致以下结果：

> ```
> org.springframework.transaction.TransactionSystemException: Could not commit JPA transaction; nested exception is
> javax.persistence.RollbackException: Error while committing thetransaction
>     at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:521)
> ...
> 
> Caused by: javax.persistence.RollbackException: Error while committing the transaction
>     at org.hibernate.ejb.TransactionImpl.commit(TransactionImpl.java:92)
>     at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:512)
> ...
> 
> Caused by: org.hibernate.AssertionFailure: collection [null] was not processed by flush()
>     at org.hibernate.engine.spi.CollectionEntry.postFlush(CollectionEntry.java:225)
> ... 
> ```

*   可能相关的是，在我的实际代码中，“Child”也有一个子实体的地图。这个“值”是由于“瞬态”盗用而作为空值传递的。
*   我一直在使用 repository.saveAndFlush() 来保持同步以进行调试。当我只使用 .save() 时，我的 @PreUpdate EntityListener 被调用，但 @PostUpdate 监听器永远不会被调用。
*   如果 Child 至少在坚持 Parent 之前被坚持或给定一个 Id，似乎不会有问题。但手动执行此操作似乎也会适得其反。不过，这是我能想到的唯一选择。

谢谢阅读。任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T23:52:51.370

我发现了问题，虽然我还没有一个完整的解决方案。

首先，一些额外的背景。除了 Parent 和 Child，我还有一个相关的类，我在这里称之为“House”。House 定义了一个 EntityListener，以便在保存/更新它时，创建/更新关联的父对象和子对象。因此，在 House 的 PostPersist/PostUpdate 期间，Parent 和 Child 对象被创建、链接、指向 House，然后被持久化。

所以问题似乎是在 House 交易完成之前完成的。只需在 House 活动完成之前退出 Parent/Child 活动，所有问题都消失了。

我能想到的唯一一件事（我会更深入地挖掘）是，由于 House 在那一刻还没有完全持久化，它会导致上面描述的瞬态条件。

**更新：**

把一个归结为无知。显然 EntityCallback 方法[“不应调用 EntityManager 或 Query 方法，并且不应访问任何其他实体对象。”](http://www.objectdb.com/java/jpa/persistence/event#Implementation_Restrictions_) 不知道。现在提出了一个问题，即我*应该*如何在另一个人的活动中触发实体的创建。但如有必要，我会为此启动另一个线程。谢谢大家！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-26T04:42:12.637

你所展示的一切似乎都很正常，所以问题可能出在你提到的那张地图上。我在 Github 上[有一个使用 Spring Data JPA 的双向一对多的工作示例。](https://github.com/zzantozz/testbed/blob/master/spring-data/src/main/java/rds/springdata/JpaBiDiOneToManyExample.java)您可以查看代码或克隆并使用以下命令运行它：

```
git clone git://github.com/zzantozz/testbed tmp
cd tmp/spring-data
mvn -q compile exec:java -D exec.mainClass=rds.springdata.JpaBiDiOneToManyExample 
```

# javascript - JavaScript if 语句总是返回 true

> ID：15079983
> 
> 赞同：1
> 
> 时间：2013-02-26T01:49:22.430
> 
> 标签：javascript, boolean-logic, boolean-expression

对应的html：

```
<html>
<title></title>
<head>

</head>
<body>
<FORM NAME="Calculator">
<TABLE BORDER=4>
<TR>
<TD>
<input type="text"   name="Input" Size="22" value="">
<input type="text" name="notepad" value="">
<br>
</TD>
</TR>
<TR>
<TD>
<INPUT TYPE="button" NAME="one"   VALUE="  1  " class ="digit" >
<INPUT TYPE="button" NAME="two"   VALUE="  2  " class ="digit" >
<INPUT TYPE="button" NAME="three" VALUE="  3  " class ="digit" >
<INPUT TYPE="button" NAME="plus"  VALUE="  +  " class ="operand">
<br>
<INPUT TYPE="button" NAME="four"  VALUE="  4  " class ="digit">
<INPUT TYPE="button" NAME="five"  VALUE="  5  " class ="digit">
<INPUT TYPE="button" NAME="six"   VALUE="  6  " class ="digit">
<INPUT TYPE="button" NAME="minus" VALUE="  -  " class="operand">
<br>
<INPUT TYPE="button" NAME="seven" VALUE="  7  " class ="digit">
<INPUT TYPE="button" NAME="eight" VALUE="  8  " class ="digit">
<INPUT TYPE="button" NAME="nine"  VALUE="  9  " class ="digit">
<INPUT TYPE="button" NAME="times" VALUE="  x  " class ="operand">
<br>
<INPUT TYPE="button" NAME="clear" VALUE="  c  " class ="special">
<INPUT TYPE="button" NAME="zero"  VALUE="  0  " class ="digit">
<INPUT TYPE="button" NAME="Execute"  VALUE="  = " class ="solve">
<INPUT TYPE="button" NAME="div"   VALUE="  /  " class ="operand">
<br>
</TD>
</TR>
</TABLE>
</FORM>

<script type = "text/javascript" src="C:\Users\Quonn\Desktop\QBJS\calculatorjs.js">
</script>
</body>
</html> 
```

javascript:

```
document.onclick = function(x) {
  var info = x.target;
  if (info.className === "digit" || "operand")
  {
    addDigit();
  }
  else {
    math();
  }
}

function addDigit() {
  alert("x");
}

function math() {
  alert("y");
} 
```

x 是通过单击计算器上的按钮传入的。即使 info.className 不是数字/操作数，if 语句也会返回 true。我需要在 if 语句中更改什么以使其返回 false？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T01:53:05.567

您没有`||`正确使用运算符。

`||`运算符用于***OR***两个值。它出现*在*两个值之间。

从你的例子：

**首先**它检查您的条件的左侧：

`info.className === "digit"`

如果为*true*，则`||`运算符返回*true*（它不评估右侧）。

否则，它会评估您的条件的右侧：

`"operand"`

这将**始终**评估为*true*，因为字符串“操作数”不**等于**false*[值](https://stackoverflow.com/q/3982663/778118)*。

要解决此问题，您需要在运算符的两侧使用正确的表达式`||`：

```
if (info.className === "digit" || info.className === "operand") {
    alert("Yay");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T01:53:09.987

```
if (info.className === "digit" || info.className === "operand") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T01:53:56.073

解释为布尔值的字符串将始终返回 true。

if (info.className === "digit" || "operand") 应该是 if (info.className == "digit" || info.className == "operand")

# asp.net - 正在使用向单个用户发送电子邮件所必需的受信任 SMTP 提供程序

> ID：15079989
> 
> 赞同：-1
> 
> 时间：2013-02-26T01:49:49.890
> 
> 标签：asp.net, azure, smtp

我听说最好使用第三方 SMTP 提供商来发送您的批量电子邮件，因为它们具有更高的信任率并且可以避免被列入黑名单的陷阱。

这仍然适用于发送给单个用户的电子邮件吗？IE 我需要 100% 保证我的：

注册、激活、忘记密码的电子邮件等（仅限个人发送）将送达收件人。我可以只使用自己服务器上的 SMTP 吗？

使用 Azure 托管和 ASP.NET

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T02:33:48.867

Azure 人员经常重复的假设是，Azure 最终将作为发送电子邮件的平台被列入黑名单，因为它有可能成为垃圾邮件平台。

由于垃圾邮件发送者可能会滥用它并将其列入全球电子邮件服务器的黑名单，因此 Azure 人员建议您使用比您自己的 SMTP 服务器“更好”的电子邮件发送系统。

您向多少人发送电子邮件并不重要。令人担心的是，微软没有采取任何措施阻止垃圾邮件发送者从 Azure 发送电子邮件，因此存在风险，即在几个月或几年后（或者可能已经发生），您向用户发送的注册电子邮件以及电子邮件在 Azure 上运行的任何其他人将直接进入收件人的垃圾邮件文件夹。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T02:34:11.613

电子邮件传递没有100% 的**保证**。每个电子邮件提供商都有自己的内部方法来决定是否发送电子邮件。

您的 SMTP 服务器的 IP 是一个标准，是的，您的声誉很重要……一旦您滥用该特权，就很难从中恢复。电子邮件提供商在决定是否将您的邮件标记为垃圾邮件时，还会使用许多其他标准。这可能包括您发送电子邮件的速度是否过快，或者您的电子邮件因地址无效而退回。域声誉和您的电子邮件收件人的活动也很重要（每个人都只是删除您的邮件而不打开，还是每个人都将您标记为垃圾邮件？）。

只要您过去没有参与过不良的电子邮件操作，从您自己的 SMTP 服务器发送电子邮件应该是安全的。我个人已经看到尝试从您自己的服务器发送大量电子邮件的负面影响，这甚至*会*影响您的网站可能生成的交易电子邮件。

根据您的第 3 方 SMTP 服务器，是的，他们可能比您更成功。但是，如果您过去没有做过任何不良的电子邮件做法，那么您自己的做法也应该没问题。尽管他们专注于电子邮件传递和维护您的发送声誉，但使用服务确实会有所帮助。无论哪种方式，都无法保证 100% 交付。

# c - 线程终止条件

> ID：15079991
> 
> 赞同：0
> 
> 时间：2013-02-26T01:50:06.607
> 
> 标签：c, pthreads

我正在用 C 编写一个生产者-消费者线程程序。我的程序中的所有内容都运行良好，但有一个主要例外。当我有多个消费者线程时（几乎总是如此），实际上只有第一个消费者线程会终止。我已经尝试了我能想到的一切，但问题仍然存在。这是我的代码，去掉了它的内脏，这样你就可以看到相关的部分。

我可以从我的输出中看到两个终止条件变量都变为零，这当然是第一个消费者线程终止的原因。但是为什么其他消费者线程也不终止呢？

谢谢！

```
sem_t full, empty, mutex;
int threads;
int to_consume;
FILE* inputfp[5];
FILE* outputfp = NULL;
char in[BUF];

void* p(void* inpFile) {

    while (fscanf(inpFile, FMTSTRING, in) > 0) {
        sem_wait(&empty);
        sem_wait(&mutex);
        // production code here
        to_consume++;
        sem_post(&mutex);
        sem_post(&full);
     }

    fclose (inpFile);

    sem_wait(&mutex);
    threads--;
    sem_post(&mutex);

    return NULL;
}

void* c() {

    int continuing = 1;

    while (continuing) {

        sem_wait(&full);
        sem_wait(&mutex);
        //consumption code here
        to_consume--;
        fprintf("%d %d\n", threads, to_consume); //these both go to zero by the end

        if ( (threads <= 0) && (to_consume <= 0) ) {
            continuing = 0;
        }

        sem_post(&mutex);
        sem_post(&empty);
    }

    return NULL;
}

int main (int argc, char* argv[]) {

    int i;
    int con_threads;
    con_threads = 3;
    to_consume = 0;

    pthread_t *pr_thread[argc-2];
    pthread_t *con_thread[2];

    sem_init(&full, 0, 0);
    sem_init(&empty, 0, 50);
    sem_init(&mutex, 0, 1);

    for (i = 0; i < (argc-2); i++) {
        pr_thread[i] = (pthread_t *) malloc(sizeof(pthread_t)); 
        inputfp[i] = fopen(argv[i+1], "r");
        int rc = pthread_create (pr_thread[i], NULL, p, inputfp[i]);
        sem_wait(&mutex);
        threads++;
        sem_post(&mutex);
    }

    outputfp = fopen(argv[(argc-1)], "wb");

    for (i = 0; i con_threads 3; i++) {
        con_thread[i] = (pthread_t *) malloc(sizeof(pthread_t));
        int rc = pthread_create (con_thread[i], NULL, c, NULL);
    }

    for (i = 0; i < (argc - 2); i++) {
        pthread_join(*pr_thread[i], 0);
        free(pr_thread[i]);
    }

    for (i = 0; i con_threads 3; i++) {
        fprintf(stderr, "About to close consumer thread %d.\n", i);
        pthread_join(*res_thread[i], 0);
        fprintf(stderr, "Consumer thread %d closed successfully.\n", i);
        free(res_thread[i]);
    }

    printf ("About to close the output file.\n");
    /* Close the output file */
    fclose (outputfp);

    return EXIT_SUCCESS;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T01:58:43.983

`full`我认为您的问题是当第一个消费者检测到没有线程剩余时您不会再次发布，因此第二个消费者正在等待`full`但信号永远不会到达。您可能需要对消费者进行计数，但对于第一次通过（概念证明），您可以留下`full`从未阅读过的帖子。

# c# - 交互式网格 WPF

> ID：15079996
> 
> 赞同：0
> 
> 时间：2013-02-26T01:50:28.247
> 
> 标签：c#, wpf, grid, interactive

我目前正在使用 C# WPF 4.5 并试图创建一个交互式网格。给定网格单元格的正方形大小（宽度 = 高度）、列数和行数，我想在屏幕上动态生成网格。

对于生成的网格，我希望网格线可见。我认为这可以通过在每个单元格内绘制一个边框来模拟，如果没有别的。最重要的是，我需要一个事件来确定用户单击的单元格（即单击返回网格列和行时），并且能够一次选择一个或多个单元格。

关于如何创建这样的东西的任何帮助或想法，或者有更好的方法吗？提前致谢！

编辑：所以这是我取得的一些进展：

1.  创建了一个自定义复选框：

    ```
     <Style x:Key="styleCustomCheckBox" TargetType="{x:Type CheckBox}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type CheckBox}">
                    <Grid x:Name="Background" Background="Transparent">
                        <Rectangle x:Name="fillCheckBox"/>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsChecked" Value="False">
                            <Setter TargetName="fillCheckBox" Property="Fill" Value="Transparent"/>
                        </Trigger>
                        <Trigger Property="IsChecked" Value="True">
                            <Setter TargetName="fillCheckBox" Property="Fill" Value="Red"/>
                            <Setter TargetName="fillCheckBox" Property="Opacity" Value=".3"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
    ```

然后只需使用该样式的自定义复选框填充网格：

```
<CheckBox Grid.Column="1" Grid.Row="1" Style="{StaticResource styleCustomCheckBox}" /> 
```

所以现在我想在网格中映射每个复选框，我可以在其中收集复选框是否被选中以及它在哪个网格行和列中，我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T17:49:33.133

我会使用[ItemsControl](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.aspx)并将其`ItemsPanelTemplate`设置为 a `UniformGrid`，并将其`ItemTemplate`设置为您的`CheckBox`

如果您可以将您绑定`ItemsControl.ItemsSource`到后面代码中的数据对象集合，那将是最简单的。例如：

```
<ItemsControl ItemsSource="{Binding MyCollection}">
    <!-- ItemsPanelTemplate -->
    <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
            <UniformGrid Rows="5" Columns="5" />
        </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>

    <!-- ItemTemplate -->
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <Border BorderBrush="Red" BorderThickness="1">
               <CheckBox Style="{StaticResource styleCustomCheckBox}" />
            </Border>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl> 
```

如果您需要指定选中项的行或列索引，您可以将其添加到您的数据项并使用常规`Grid`而不是 a `UniformGrid`，并应用`ItemContainerStyle`这样的：

```
<!-- ItemContainerStyle -->
<ItemsControl.ItemContainerStyle>
    <Style>
        <Setter Property="Grid.Column" Value="{Binding ColumnIndex}" />
        <Setter Property="Grid.Row" Value="{Binding RowIndex}" />
    </Style>
</ItemsControl.ItemContainerStyle> 
```

要确定点击的项目，这取决于您如何构建数据对象以及您在点击中实际想要执行的操作。

如果您想要正方形后面的数据项，您可以使用`DataContext`，例如

```
void MyCheckBox_Clicked(object sender, EventArgs e)
{
    var selectedItem = ((CheckBox)sender).DataContext;
} 
```

或者，如果您有类似具有以下`IsChecked`属性的数据项：

```
<CheckBox IsChecked="{Binding IsChecked}" 
          Style="{StaticResource styleCustomCheckBox}" /> 
```

您可以轻松地将事件附加到`PropertyChanged`数据项`IsChecked`属性的事件，并在那里运行一些代码。

作为第三种选择，您可以使用 a`Button`并将`ItemTemplate`所选项目作为`CommandParameter`

```
<Border BorderBrush="Red" BorderThickness="1">
    <Button CommandParameter="{Binding }" ... />
</Border> 
```

我不能给你一个明确的答案，因为我不知道你的代码库和你想要做什么，但我希望这能给你足够的信息给你一个粗略的开始，并为你指明正确的方向情况。

# c++ - 从程序集中调用 Win32 的 Sleep 函数会产生访问冲突错误

> ID：15079997
> 
> 赞同：1
> 
> 时间：2013-02-26T01:50:37.027
> 
> 标签：c++, winapi, assembly, x86, calling-convention

我正在使用 MASM 和 Visual C++，并且我正在使用 x64 进行编译。这是我的 C++ 代码：

```
// include directive
#include "stdafx.h"
// external functions
extern "C" int Asm();
// main function
int main()
{

    // call asm
    Asm();
    // get char, return success
    _getch();
    return EXIT_SUCCESS;
} 
```

和我的汇编代码：

```
extern Sleep : proc
; code segment
.code
    ; assembly procedure
    Asm proc
        ; sleep for 1 second
        mov ecx, 1000   ; ecx = sleep time
        sub rsp, 8      ; 8 bytes of shadow space
        call Sleep      ; call sleep
        add rsp, 8      ; get rid of shadow space
        ; return
        ret
    Asm endp
end 
```

使用断点，我已经确定了发生访问冲突的代码行：就`ret`在我的汇编代码中的语句之后。

额外信息：

*   我正在使用*fastcall*约定将我的参数传递到`Sleep`（即使它被声明为*stdcall*），因为[从我读过的内容来看](http://msdn.microsoft.com/en-us/library/ms235286.aspx)，x64 将始终使用*fastcall*约定。

*   `Asm`当我摆脱`Sleep`相关代码时，我的程序编译并执行没有错误。

*   即使我尝试`Sleep`使用*stdcall*约定进行调用，我仍然会收到访问冲突错误。

所以很明显，我的问题是，我如何摆脱访问冲突错误，我做错了什么？

**编辑：**

这是`Sleep(500);`在 C++ 中生成的程序集：

```
mov         ecx,1F4h  
call        qword ptr [__imp_Sleep (13F54B308h)] 
```

这个生成的程序集让我感到困惑......它看起来像 fastcall，因为它将参数移动到 ecx，但同时它不会创建任何阴影空间。而且我不知道这意味着什么：
`qword ptr [__imp_Sleep (13F54B308h)]`。

**再次编辑，完整的反汇编`main`。**

```
int main()
{
000000013F991020  push        rdi  
000000013F991022  sub         rsp,20h  
000000013F991026  mov         rdi,rsp  
000000013F991029  mov         ecx,8  
000000013F99102E  mov         eax,0CCCCCCCCh  
000000013F991033  rep stos    dword ptr [rdi]  
Sleep(500); // this here is the asm generated by the compiler!
000000013F991035  mov         ecx,1F4h  
000000013F99103A  call        qword ptr [__imp_Sleep (13F99B308h)]  
// call asm
Asm();
000000013F991040  call        @ILT+5(Asm) (13F99100Ah)  
// get char, return success
_getch();
000000013F991045  call        qword ptr [__imp__getch (13F99B540h)]  
return EXIT_SUCCESS;
000000013F99104B  xor         eax,eax  
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-26T02:56:38.600

如果`Asm()`是一个普通的 C/C++ 函数，例如：

```
void Asm()
{
    Sleep(1000);
} 
```

以下是我的 x64 编译器为其生成的内容：

```
Asm proc
    push rbp          ; re-aligns the stack to a 16-byte boundary (CALL pushed 8 bytes for the caller's return address) as well as prepares for setting up a stack frame
    sub rsp, 32       ; 32 bytes of shadow space
    mov rbp, rsp      ; finalizes the stack frame using the current stack pointer
    ; sleep for 1 second
    mov ecx, 1000     ; ecx = sleep time
    call Sleep        ; call sleep
    lea rsp, [rbp+32] ; get rid of shadow space
    pop rbp           ; clears the stack frame and sets the stack pointer back to the location of the caller's return address
    ret               ; return to caller
Asm endp 
```

[MSDN 说](http://msdn.microsoft.com/en-us/library/vstudio/ms235286.aspx)：

> 调用者负责为被调用者分配参数空间，并且**必须始终为 4 个寄存器参数分配足够的空间，即使被调用者没有那么多参数。**

有关 x64 如何使用堆栈的更多信息，请查看以下页面：

[堆栈分配](http://msdn.microsoft.com/en-us/library/ew5tede7.aspx)

# sql-server-2008 - OData 底层提供商定期打开失败

> ID：15079998
> 
> 赞同：0
> 
> 时间：2013-02-26T01:51:02.197
> 
> 标签：sql-server-2008, entity-framework-4, odata

我用 EF4 模型编写了 OData 服务。它目前功能齐全，并部署在至少 30 台不同的服务器上。该错误正在其中一台服务器上发生，但只是定期发生。

服务器已配置并正在运行。在某个随机点，它开始响应 500 个内部服务器错误。服务中实现的 HandleException 方法未处理错误。例外是直接转储到应用程序下的 Windows 事件日志中，作为来自 ASP.NET 4.0 的警告。警告的内容表明问题是由底层提供程序在打开时失败引起的（我将在问题末尾发布完整的异常详细信息）。发生错误时，我启动 SQL Server Management Studio 并可以毫无问题地连接到数据库。让服务再次运行的解决方案是简单地回收 IIS 中的应用程序池，但这每周发生 2 或 3 次，这让我的客户感到悲痛。谁能指出我可能导致这种情况的正确方向？服务器可能是运行该服务的动力最弱的系统，我建议增加 RAM 作为可能解决问题的起点，但我在这里盲目飞行。

完整的异常详细信息：

```
 Exception information: 
    Exception type: EntityException 
    Exception message: The underlying provider failed on Open.
   at System.Data.EntityClient.EntityConnection.OpenStoreConnectionIf(Boolean openCondition, DbConnection storeConnectionToOpen, DbConnection originalConnection, String exceptionCode, String attemptedOperation, Boolean& closeStoreConnectionOnFailure)
   at System.Data.EntityClient.EntityConnection.Open()
   at ColdFusion.Service.Authenticate.BasicAuthenticationProvider..cctor()

Timeout expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
   at System.Data.SqlClient.TdsParserStateObject.ReadSniError(TdsParserStateObject stateObj, UInt32 error)
   at System.Data.SqlClient.TdsParserStateObject.ReadSni(DbAsyncResult asyncResult, TdsParserStateObject stateObj)
   at System.Data.SqlClient.TdsParserStateObject.ReadNetworkPacket()
   at System.Data.SqlClient.TdsParserStateObject.ReadBuffer()
   at System.Data.SqlClient.TdsParserStateObject.ReadByte()
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlInternalConnectionTds.CompleteLogin(Boolean enlistOK)
   at System.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, SqlConnection owningObject)
   at System.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, Boolean redirectedUserInstance, SqlConnection owningObject, SqlConnectionString connectionOptions, TimeoutTimer timeout)
   at System.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(SqlConnection owningObject, TimeoutTimer timeout, SqlConnectionString connectionOptions, String newPassword, Boolean redirectedUserInstance)
   at System.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, Object providerInfo, String newPassword, SqlConnection owningObject, Boolean redirectedUserInstance)
   at System.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection)
   at System.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnection owningConnection, DbConnectionPool pool, DbConnectionOptions options)
   at System.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject)
   at System.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject)
   at System.Data.ProviderBase.DbConnectionPool.GetConnection(DbConnection owningObject)
   at System.Data.ProviderBase.DbConnectionFactory.GetConnection(DbConnection owningConnection)
   at System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory)
   at System.Data.SqlClient.SqlConnection.Open()
   at System.Data.EntityClient.EntityConnection.OpenStoreConnectionIf(Boolean openCondition, DbConnection storeConnectionToOpen, DbConnection originalConnection, String exceptionCode, String attemptedOperation, Boolean& closeStoreConnectionOnFailure) 
```