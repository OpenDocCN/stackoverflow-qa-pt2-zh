# StackOverflow 问答 13595000-13595999

# javascript - 在新窗口中打开更大版本的图片/w javascript

> ID：13595003
> 
> 赞同：1
> 
> 时间：2012-11-27T23:19:00.450
> 
> 标签：javascript, image

我已经设法使用以下代码将图片打开到新窗口中的图片：

```
<IMG SRC="pic_small.jpg" onClick="view();">

<script language="JavaScript">

function view() {
imgsrc = "pic_big.jpg";

viewwin = window.open(imgsrc,'viewwin', 'width=600,height=300');    
}
</script> 
```

我现在遇到的问题是我的网页上有更多图片，我不想为每个脚本编写另一个函数，而是为所有图片编写一个函数。换句话说，我希望有一个与上面做同样事情的脚本，但适用于所有这些（如果需要修改）HTML 行

```
<IMG SRC="pic1_small.jpg" onClick="view();">
<IMG SRC="pic2_small.jpg" onClick="view();">
<IMG SRC="pic3_small.jpg" onClick="view();">
<IMG SRC="pic4_small.jpg" onClick="view();"> 
```

我还想知道是否有某种方法可以使打开的窗口与大图片的大小相同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T23:22:24.290

对于你的第一个问题

```
<IMG SRC="pic_small.jpg" onClick="view(this);">

<script language="JavaScript">
   function view(img) {
      imgsrc = img.src.split("_")[0] + "_big.jpg";
      viewwin = window.open(imgsrc,'viewwin', 'width=600,height=300');    
   }
</script> 
```

**更新**

对于你的第二个问题，[可以做到](http://www.sitepoint.com/resize-popup-fit-images-size/)。

**更新 2**

这取决于您的图像名称保持相同的格式。或者，您可以这样做：

```
<img src="pic_small.jpg" onclick="view('pic_big.jpg')" />

<script type="text/javascript">
   function view(imgsrc) {
      viewwin = window.open(imgsrc,'viewwin', 'width=600,height=300'); 
   }
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:21:53.763

使用诸如 lightbox 之类的 js 库是一个不错的选择。它或多或少地满足您的要求。参见例如[Lightbox 2](http://lokeshdhakar.com/projects/lightbox2/)

通过在您的 html 中包含 lightbox 和 jquery，您可以创建一个带有标签的图像列表，该标签具有“lightbox”的“rel”属性。当您单击图像周围的链接时，灯箱将自动激活。这是一个例子。

```
<a href="images/image-1.jpg" rel="lightbox" title="my caption">image #1</a> 
```

在上述链接的“如何使用”部分中查看更多示例

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T23:24:42.647

看看[jQuery](http://jquery.com/)库，它几乎是 JS 的事实上的库。使用它你可以做类似的事情

```
$('img').click(function(){
  view($(this).attr('src'));
})

function view(small){
  var big = small.split("_")[0] + "_big.jpg";
  viewwin = window.open(imgsrc,'viewwin', 'width=600,height=300');    
} 
```

这样，您的所有图像都将具有相同的行为

# c++ - c ++中的构造函数和运算符 - 不起作用

> ID：13595005
> 
> 赞同：1
> 
> 时间：2012-11-27T23:19:04.180
> 
> 标签：c++

我正在尝试学习 C++，但我不明白为什么以下代码不起作用：

```
class String
{
public:
    String();
    String(const String& other);
    String& operator = (const String& other);
    String& operator = (const wchar_t* other);
    String& operator () (const wchar_t* other);
    ~String();
    operator const wchar_t* ();
            ... 
```

在 main 函数的某处：

```
wchar_t* x = L"A test string";
String y = (String)x; //not working
String z = x;  //not working 
```

VC++ 编译器告诉我这个：

```
Error   1   error C2440: 'type cast': cannot convert from 'wchar_t *' to 'String'   
Error   2   error C2440: 'initializing': cannot convert from 'wchar_t *' to 'String'    
IntelliSense: no suitable constructor exists to convert from "wchar_t *" to "String" 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T23:20:32.497

你需要一个构造函数`wchar_t*`。

```
String(const wchar_t*); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T23:24:33.323

“main 中某处”的三行都没有使用赋值，因此我们可以忽略您可能定义的任何赋值运算符。而且您还没有定义一个转换构造函数，它采用单个参数 (a `wchar_t const*`) 来转换您的`wchar_t const*`.

# css - 使用 webkit 关键帧动画时 iBooks 中出现意外的不透明度行为

> ID：13595006
> 
> 赞同：1
> 
> 时间：2012-11-27T23:19:20.663
> 
> 标签：css, webkit, ibooks, css-animations

我正在为 iBooks epub 制作动画插图。这是 XHTML 的简化版本。

```
<div id="parent">
    <img src="image-1.png" />
    <img src="image-2.png" />
    <img src="image-3.png" />
</div> 
```

我正在制作动画的角色是一个幽灵，因此我将不透明度 (0.7) 应用于容器 div。幽灵般的。

```
#parent {
    position: absolute;
    top: 178px;
    left: 335px;
    width: 589px;
    height: 1295px;
    z-index: 3;
    opacity: 0.7;
} 
```

在 Safari、Chrome 和 iBooks 中，我最初得到了想要的效果，即容器使所有内容作为一个整体看起来是半透明的。（就好像您在 Photoshop 中调低了一组图层的不透明度一样。）

但是，当我将 webkit 关键帧动画应用于任何子元素时，*仅在 iBooks*中，不透明度的行为会发生变化，因此所有子元素都变为半透明。（就好像您在 Photoshop 中调低了组内每一层的不透明度一样。）

这意味着您可以看到图像重叠的位置，这不是我希望的效果。

为什么我会得到这两个不同的结果？

# ruby - rake db：使用回形针迁移问题

> ID：13595007
> 
> 赞同：0
> 
> 时间：2012-11-27T23:19:30.343
> 
> 标签：ruby, ruby-on-rails-3, paperclip, image-uploading, dbmigrate

我使用 gem install 安装了回形针 2.7。我做了 rails 生成回形针用户照片。然后尝试迁移数据库。但它给了我一个错误。SQLite3::SQLException: 重复列名：photo_file_name: ALTER TABLE "users" ADD "photo_file_name" varchar(255)

我在某处读到我应该删除 development.rb 然后执行 db:create 并且它们再次迁移。但这也没有用。当我执行 db:create 时，它​​说已经存在。所以......我最终恢复到我的旧承诺，希望重新开始。但是当我做 db:reset. 它告诉我我还有两个迁移。这两个迁移都是从 rails 生成的回形针用户照片。现在我该怎么做？我该如何让它发挥作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:23:16.933

运行迁移删除`photo_file_name`，因此：

```
def change
  change_table :users do |t|
    t.remove :photo_file_name
  end
end 
```

并重新开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T04:25:43.387

如果您没有任何重要且需要保存的数据，您可以简单地删除数据库并将其一直迁移回来：

耙分贝：下降

耙分贝：创建

耙分贝：迁移

# python - 如何强制特定的 Yaml 列表类型

> ID：13595008
> 
> 赞同：2
> 
> 时间：2012-11-27T23:19:35.127
> 
> 标签：python, yaml

如何强制 Python 的 yaml 实现中的 dump() 方法使用每行一个元素的列表样式？

例如，当我做`yaml.dump([1,2,3])`我`"[1, 2, 3]\n"`真正想要的时候：

```
- 1
- 2
- 3 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:22:24.313

您可以使用[`default_flow_style`](http://pyyaml.org/wiki/PyYAMLDocumentation#DumpingYAML)：

```
>>> print yaml.dump([1,2,3], default_flow_style=False)
- 1
- 2
- 3 
```

# php - 从日期 y 获取帖子 x 类别的数量

> ID：13595011
> 
> 赞同：1
> 
> 时间：2012-11-27T23:19:39.837
> 
> 标签：php, mysql

我正在创建一个有点像城市词典的词典系统。我想获得今天/昨天/随机的帖子数量。我现在使用的表结构是这样的：

字：

```
|id|name  |lastupdate(unixstyle)
|1 |apple |today
|2 |potato|yesterday
|3 |pear  |today
|4 |php   |three days ago 
```

定义：

```
|id|wordid|date
|1 |1     |three days ago
|1 |4     |three days ago
|1 |1     |three days ago
|1 |2     |yesterday
|1 |2     |yesterday
|1 |1     |yesterday
|1 |4     |today
|1 |3     |today
|1 |1     |today 
```

有了这个表结构，我可以很容易地得到今天的定义数量。但我真正想做的是能够获得我想要的任何一天的帖子。

我想要的结果有点像这样：

```
today's words:
apple(1 definition)
pear(3 definitions)
php(4 definitions) 
```

这是我在 stackoverflow 上的第一篇文章 :) 我希望我清楚地说明了我想做什么。如果有人可以帮助我解决这个问题，我会很高兴。

提前致谢 ：）

* * *

**问题解决了**

经过数小时的研究，我找到了解决方案（我很傻）。我所要做的就是使用 INNER JOIN 来获得我想要的。解决方案是这样的：

```
SELECT words.name
FROM words
INNER JOIN definitions ON words.id = definitions.wordid
WHERE date > 1354053600 
```

我使用的日期当然是一个例子。您需要做的就是使用您想要的 unixdate 更改它:)

# java - 如何在 Apache wicket 中使用继承自 BasePage（继承自 WebPage）的 AdminBasePage

> ID：13595013
> 
> 赞同：0
> 
> 时间：2012-11-27T23:19:51.197
> 
> 标签：java, apache, wicket

我在我的 java web 应用程序项目中使用 Apache Wicket Framework。我有一个继承自 Apache Wicket 网页的 BasePage。

我需要一个从 BasePage 继承的 AdminBasePage 以在访问管理页面时对用户进行身份验证，但它给出了一个错误，即我无法呈现 html 标记，它说可能是我将代码添加到 java 类但忘记添加 html 标记。

这是我的基本页面：

html:

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:wicket="http://wicket.apache.org">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <title>BasePage</title>
        <link rel="stylesheet" type="text/css" href="style.css"/>
    </head>
    <body>
        <wicket:child>

        </wicket:child>
    </body>
</html> 
```

Java：包 com.myapp.wicket；

```
import org.apache.wicket.markup.html.WebPage;

public abstract class BasePage extends WebPage{

    public BasePage () {
        super();
    }
} 
```

* * *

这是我的 AdminBasePage：

html:

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:wicket="http://wicket.apache.org">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <title>AdminBasePage</title>
        <link rel="stylesheet" type="text/css" href="style.css"/>
    </head>
    <body>
    </body>
</html> 
```

Java：包 com.myapp.wicket.admin；

```
import com.myapp.wicket.BasePage;

public abstract class AdminBasePage extends BasePage {

    public AdminBasePage() {
        super();
    }
} 
```

我究竟做错了什么？我应该怎么办？你能建议我做什么吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T06:56:18.447

您在 AdminBasePage 的标记中缺少以下内容：

```
<wicket:extend>
</wicket:extend> 
```

...或者只是删除 AdminBasePage.html

在这里阅读更多：

[https://cwiki.apache.org/WICKET/markup-inheritance.html](https://cwiki.apache.org/WICKET/markup-inheritance.html)

# asp.net - ASP.net中HTML标签的随机介绍

> ID：13595016
> 
> 赞同：1
> 
> 时间：2012-11-27T23:20:14.997
> 
> 标签：asp.net, vb.net, visual-studio-2010, html

我讨厌就我知道的简单解决方法寻求帮助，但对于我的生活，我无法弄清楚我的问题出在哪里。

我的 ASP.net 项目中有一个 SQL 数据库，出于某种原因，我现在在我的字符串中提取 HTML 标记。

例如，这句话：

“附加设置”完全变灰。

会变成这样：

@quot;其他设置@quot; 完全变灰。

句子是手动输入的，所以它不能在那里，列被保存为 varchar(max) 所以我不认为它可能在那里。当我将它带入网格视图时，它看起来很好。当我使用它时：

```
 GridView1.Rows(0).Cells(5).Text 
```

我收到带有 HTML 标签的字符串。

当我没有使用 html 标签输入字符串并且没有使用 html 标签保存它们时，为什么我的 gridview 导出带有 html 标签的字符串？

谢谢你们的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:35:37.890

是的，我当然会在我阅读的下一个网页上找到答案 dohhh >_<

```
 HttpUtility.HtmlDecode(DefectsGrid.Rows(lines).Cells(5).Text) 
```

抱歉各位浪费了你们的时间

# haskell - haskell 中的自定义 concat (++) 运算符

> ID：13595020
> 
> 赞同：5
> 
> 时间：2012-11-27T23:20:36.790
> 
> 标签：haskell, operators

`++`是否可以在 Haskell 中为自定义数据类型定义我自己的运算符？

我有：

```
data MyType = MyType [String] 
```

我想将我自己的连接运算符定义为：

```
instance ? MyType where
    (MyType x) ++ (MyType y) = MyType (x ++ y) 
```

我似乎无法在任何地方找到实例类的名称。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-27T23:32:15.000

如果你不坚持打电话给接线员`(++)`，

```
import Data.Monoid

instance Monoid MyType where
    (MyType x) `mappend` (MyType y) = MyType (x ++ y)
    mempty = MyType [] 
```

然后你可以使用

```
(<>) :: Monoid m => m -> m -> m 
```

这是一个别名`mappend`（我认为它已经是一个类型类成员，但它不是：/）。列出一个`Monoid`实例 where `mappend`is `(++)`，这样就可以满足您的要求。该`Monoid`实例还为您提供

```
mconcat :: Monoid m => [m] -> m 
```

您可以使用它来连接`MyType`s 的列表。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-27T23:32:04.767

最简单的做法是

```
import Prelude hiding ((++))
import qualified Prelude as P

data MyType = MyType [String]

class PlusAble a where
    infixr 5 ++
    (++) :: a -> a -> a

instance PlusAble MyType where
    (MyType x) ++ (MyType y) = MyType (x P.++ y)

-- EDIT:
instance PlusAble [a] where
    x ++ y = x P.++ y 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-27T23:36:12.013

`(++)`运算符不属于任何类型类。您可以轻松检查：

```
$ ghci
Prelude> :info (++)
(++) :: [a] -> [a] -> [a]   -- Defined in `GHC.Base'
infixr 5 ++ 
```

所以，它只是在`GHC.Base`模块中定义的简单函数。您可以隐藏它并定义自己的：

```
import Prelude hiding ((++))
import qualified Prelude -- to get hidden (++) as Prelude.(++)

-- your brand new (++)
infixr 5 ++
(MyType x) ++ (MyType y) = MyType (x Prelude.++ y) 
```

# python - 在循环中打破循环外？

> ID：13595021
> 
> 赞同：-1
> 
> 时间：2012-11-27T23:20:38.690
> 
> 标签：python

当if 语句位于 if 语句中时，我的脚本返回一个错误，说明`break`它位于循环之外。`break`为什么？我该如何解决？用一本书写剧本，

```
if hook_address:
    hooks.add(dbg,hook_address,2,ssl_sniff,None)
    print "[*] nspr4.PR_Write hooked at: 0x%o8x" %hook_address
    break
else:
    print "[!] Error: Couldn't resolve hook address!"
    sys.exit(-1) 
```

> c:\0xic-zex\Python>sniffer.py 文件“C:\0xic-zex\Python\sniffer.py”，第 32 行 break SyntaxError: 'break' outside loop

怎么了？我`break`在`if`循环中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T23:21:58.397

`if`语句不是循环。你不需要`break`离开他们。

你会使用`break`提前离开`for`或`while`循环。

# python - 用于检索查询的 Google 点击次数的 Python 脚本

> ID：13595024
> 
> 赞同：2
> 
> 时间：2012-11-27T23:21:05.437
> 
> 标签：python

如何使用 Python 获取 Google 查询的点击次数？

我有一个包含甲壳虫乐队歌曲标题的列表：

```
 songs = ["Love Me Do", "P. S. I Love You", "Please Please Me"] 
```

当我在谷歌搜索时，我想检索谷歌点击次数：

```
 The Beatles Love Me Do
    The Beatles P. S. I Love You
    The Beatles Please Please Me 
```

并将这些命中存储到另一个列表中。所以最后我会得到：

```
 google_hits == [42400000, 2740000, 28200000] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T23:46:22.740

这是我实施的快速而肮脏的解决方案：

```
import urllib
import json

artist = "The Beatles"
songs = ["Love Me Do", "P. S. I Love You", "Please Please Me"]
query = "http://ajax.googleapis.com/ajax/services/search/web?v=1.0&q=%s"

google_hits = list()
for song in songs:
    results = urllib.urlopen(query % (artist + " " + song))
    json_res = json.loads(results.read())
    google_hits.append(int(json_res['responseData']['cursor']['estimatedResultCount']))

print google_hits 
```

我正在使用已**弃用的开放式**[Google Search API](https://developers.google.com/web-search/docs/)，但前提是您为新的[自定义搜索 API](https://developers.google.com/custom-search/v1/overview)获取 API 密钥，该过程应该类似。另外，关于文档中的快速说明：**`estimatedResultCount`**

 **> .estimatedResultCount - 提供与当前查询匹配的估计结果数。请注意，此值不一定与 Google.com 搜索属性中可见的类似值匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:24:54.137

您可能会发现 xgoogle 对编写此代码很有用：[https ://github.com/pkrumins/xgoogle](https://github.com/pkrumins/xgoogle)

下面是一些工作代码，展示了如何迭代和计算搜索结果：[如何使用 xgoogle](https://stackoverflow.com/questions/5227985/how-to-use-xgoogle)**

# php - 在 AppFog 上运行 PHP 工作者

> ID：13595025
> 
> 赞同：13
> 
> 时间：2012-11-27T23:21:06.303
> 
> 标签：php, cron, background-process, worker, appfog

我搜索，搜索和搜索，但没有找到任何资源。

**有什么方法可以在 AppFog 上的 PHP 应用程序中运行*工作者？***

我只找到了基于这些语言的框架运行 Ruby、Node.js 和 Python 工作者的说明。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-11-27T23:21:06.303

经过大量的修补自己，我找到了一个方法！

在您的 php 脚本中，您应该将超时限制设置为`0`，并有一个无限循环，如下所示：

```
<?php
    set_time_limit(0);

    while (true) {
        print "blah\n";
        sleep(120);
    } 
```

此代码将每 2 分钟打印一次“blah”。

要将其部署到 AppFog，您*必须*使用`af`控制台命令。这里最重要的是当它询问这是否是一个 PHP 应用程序时**说不。**

## 步骤

1.  `af push`在目录上
2.  如果它猜到你的应用程序的语言，就说**不**
3.  选择**独立**作为应用程序类型。
4.  现在选择 PHP
5.  输入`php index.php`或您为应用程序主文件提供的任何名称。

如下图所示：

```
D:\Users\Leonel\dev\app>af push
Would you like to deploy from the current directory? [Yn]:
Application Name: APP
Detected a PHP Application, is this correct? [Yn]: n
[...]
6: Standalone
[...]
Select Application Type: 6
Selected Standalone Application
[...]
5: php
[...]
Select Runtime: 5
Selected php
Start Command: php index.php
1: AWS US East - Virginia
[...]
Select Infrastructure: 1
Application Deployed URL [None]:
Memory reservation (128M, 256M, 512M, 1G, 2G) [128M]:
How many instances? [1]:
Bind existing services to 'APP'? [yN]:
Create services to bind to 'APP'? [yN]:
Would you like to save this configuration? [yN]:
Creating Application: OK
Uploading Application:
  Checking for available resources: OK
  Packing application: OK
  Uploading (0K): OK
Push Status: OK
Staging Application 'APP': OK
Starting Application 'APP': OK

D:\Users\Leonel\dev\APP>af logs APP
====> /logs/stdout.log <====

blah
blah 
```

## 一些笔记

*   例如，您需要创建一个*单独*的应用程序来执行后台任务，尽管此应用程序可以绑定到其他应用程序的相同服务（例如数据库），或者此应用程序可以绑定到`curl`您的其他应用程序。只要确保它在同一个可用区。
*   `af logs APP`将为您提供工作人员的输出，因此您可以调试并检查一切是否正常。

就是这样，希望对你有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-14T08:28:12.187

很好的解决方案。由于声誉不足，我无法发表评论，因此我正在修改原始答案。

要使 PHP 伪 crontab 在指定的秒数启动，请在脚本开头使用强制循环，如下所示：

```
<?php
    set_time_limit(0);

    // begin process at zero (00) second mark
    $cnt=0;
    while (true) {
      usleep(250000); // avoid excess looping
      if ( date('s',time()) == '00' ) {
        break;
      }
      if ( $cnt++ > 240 ) {
        break; // something has gone wrong...
      }
    }
    var_dump(date('s',time()));exit; // test/validate

    while (true) {
        print "blah\n";
        sleep(120);
    } 
```

# linux - Linux如何通过sysenter调用系统调用？

> ID：13595033
> 
> 赞同：1
> 
> 时间：2012-11-27T23:21:37.023
> 
> 标签：linux, assembly, nasm

我已经成功编译了 NASM 的汇编教程：

```
global _start            ; global entry point export for ld
section .text
_start:
    ; sys_write(stdout, message, length)
    mov eax, 4        ; sys_write syscall
    mov ebx, 1        ; stdout
    mov ecx, message    ; message address
    mov edx, length        ; message string length
    int 80h
    ; sys_exit(return_code)
    mov eax, 1        ; sys_exit syscall
    mov ebx, 0        ; return 0 (success)
    int 80h
section .data
    message: db 'Hello, world!',0x0A    ; message and newline
    length: equ $-message            ; NASM definition pseudo-instruction 
```

如何使用特殊的 SYSENTER 指令调用 sys_write 程序？

# sql - VB.Net Silverlight 5 SQL 实体搜索

> ID：13595035
> 
> 赞同：0
> 
> 时间：2012-11-27T23:21:37.817
> 
> 标签：sql, vb.net, silverlight, ria, entities

我正在制作一个 silverlight 5 应用程序并使用 RIA WCS 服务连接到 sql，我可以添加数据、删除数据、编辑数据并获取所有数据，但问题是我需要检索特定记录而不是整个实体，当我尝试以下代码时，什么也没发生：

Private Sub Button1_Click(sender As System.Object, e As System.Windows.RoutedEventArgs) Handles Button1.Click ' InitializeComponent() objctx = New BanksDomainContext Dim itemType = Branch_NameComboBox.SelectedItem.GetType Dim pi = itemType.GetProperty(Branch_NameComboBox.DisplayMemberPath) Dim cbi = pi.GetValue(Branch_NameComboBox.SelectedItem, Nothing).ToString() Dim BranchName As String = cbi

```
 '   Dim query As EntityQuery(Of Branches) = objctx.GetBranchesDetailsQuery(BranchName)

    '  Dim loadOp As LoadOperation(Of Branches) = Me.objctx.Load(query)
    '  DataGrid1.ItemsSource = loadOp.Entities
    '  objctx.Load(query, LoadData, Nothing)

    Dim loadOp = Me.objctx.Load(Me.objctx.GetBranchesDetailsQuery(BranchName))

    LoadData(loadOp)

End Sub
Private Sub LoadData(lo As LoadOperation)

    For Each br As Branches In lo.Entities

        AddressTextBlock.Text = br.Address
        CoordinatesTextBlock.Text = br.Coordinates
        ManagerTextBlock.Text = br.Manager
        PhoneTextBlock.Text = br.Phone
        FaxTextBlock.Text = br.Fax        
Next

End Sub 
```

有人可以指导我怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T10:10:31.830

以下是通过从列表框中选择搜索词来从 SQL 记录加载文本框的解决方案：

```
Private Sub Branch_NameComboBox_SelectionChanged(sender As System.Object, e As System.Windows.Controls.SelectionChangedEventArgs) Handles Branch_NameComboBox.SelectionChanged
    m_PushpinLayer.Children.Clear()
    objctx = New BanksDomain
    Dim itemType = Branch_NameComboBox.SelectedItem.[GetType]()
    Dim pi = itemType.GetProperty(Branch_NameComboBox.DisplayMemberPath)
    Dim cbi = pi.GetValue(Branch_NameComboBox.SelectedItem, Nothing).ToString()
    Dim BranchName As String = cbi
    Dim itemType2 = NameComboBox.SelectedItem.[GetType]()
    Dim pi2 = itemType2.GetProperty(NameComboBox.DisplayMemberPath)
    Dim cbi2 = pi2.GetValue(NameComboBox.SelectedItem, Nothing).ToString()
    Dim BankName As String = cbi2
    Dim bb As EntityQuery(Of Branches) = From b In objctx.GetBranchesDetailsQuery(BranchName) Where b.Bank = BankName Select b

    Dim res As LoadOperation(Of Branches) = objctx.Load(bb, New Action(Of LoadOperation(Of Branches))(AddressOf GetBeansCompleted), True)

End Sub
Private Sub GetBeansCompleted(args As LoadOperation(Of Branches))

    For Each bc As Branches In args.Entities
        ' 
        Dim Latitude As Double = bc.Lat
        Dim Longitude As Double = bc.Lon

        Dim CoO As Location = New Location

        CoO.Latitude = Decimal.Parse(Latitude)
        CoO.Longitude = Decimal.Parse(Longitude)

        Dim BName As String = bc.Branch_Name.ToString
        Dim MKColor As Color = GetThisColor(bc.MapKeyColor.ToString)

        AddPushPin(BName, CoO, MKColor)

        AddressTextBlock.Text = (bc.Address.ToString)
        LatTextBlock.Text = (Decimal.Parse(Latitude))
        LonTextBlock.Text = (Convert.ToDecimal(Longitude))
        ManagerTextBlock.Text = (bc.Manager.ToString)
        PhoneTextBlock.Text = (bc.Phone.ToString)
        FaxTextBlock.Text = (bc.Fax.ToString)

    Next

End Sub 
```

# android - 如何为 x86 编译 Android AOSP

> ID：13595041
> 
> 赞同：6
> 
> 时间：2012-11-27T23:22:02.813
> 
> 标签：android, x86, android-source

我已经看到有适用于 Android 的仿真器映像可以在 x86 虚拟机上运行。我想从源代码构建我自己的 x86 Android 映像，但我似乎无法在网上找到说明。目前是否可以构建自定义 x86“ROM”？（不确定“ROM”是否适合 x86 系统，无论如何）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T00:25:51.090

是的，这是可能的，但你仍然需要一台 Linux 机器来编译它（不会遇到很多麻烦）。

网上有很多关于将android移植到X86平台的资料。我建议你从这个开始：[Android-x86 - Porting Android to x86](http://www.android-x86.org/getsourcecode)。

你也可以看看`XDA forun`。他们在移植ROM方面做了很多工作。

问候。

# php - 通过 PHP 将 DKIM 签名的电子邮件发送到 Outlook.COM

> ID：13595042
> 
> 赞同：10
> 
> 时间：2012-11-27T23:22:03.563
> 
> 标签：php, email, outlook, smtp, dkim

我有一个邮件服务器，可以很好地配置 SPF、DKIM 和反向 DNS。我可以使用以下方式向 Outlook.com 发送电子邮件：

```
echo "This is only a test" | mail username@outlook.com 
```

当我尝试使用同一服务器通过 PHP 发送电子邮件时，会出现问题：

```
$header .= "Return-Path: Some User <mailsender@mydomain.com>\r\n";
$header .= "From: Some User <mailsender@mydomain.com>\r\n";
$header .= "Content-Type: text/plain; charset=iso-8859-1\r\n";
$header .= "MIME-Version: 1.0\r\n";
$header .= "User-Agent: Some User Mail Sender\r\n";
$header .= "Content-Transfer-Encoding: 7bit\r\n";

mail("usernama@outlook.com","My title", "Message body", $header); 
```

我尝试使用 appmaildev.com 验证我的消息，报告显示：

```
DKIM result: fail (wrong body hash: <*** body hash ***>) 
```

即使出现此错误，Outlook.com 仍表示它通过了 DKIM 验证，但 PHP 邮件功能发送的所有邮件都会进入垃圾文件夹。以下是通过 Bash 和 PHP 直接发送的消息示例：http: [//pastebin.com/ndXJszic](http://pastebin.com/ndXJszic)

谁能帮我？

谢谢。

**编辑**从标头中 删除*\r*后，DKIM 正文哈希错误消失了。但是我仍然无法向 Outlook 发送电子邮件...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T09:59:20.313

这可能是权限问题。

您的 Web 服务器通常以不同于您`mail`在命令行中使用的用户身份运行，因此设置`From:`标头将在外发电子邮件中创建额外的警告标头。

您可以在服务器上修改一个名为`/etc/mail/trusted-users`. 确保用户`apache`（或您的 php 脚本运行的任何用户）出现在该文件中；如果没有，请添加用户名，然后重新加载`sendmail`。

的示例内容`/etc/mail/trusted-users`：

```
# trusted-users - users that can send mail as others without a warning
# apache, mailman, majordomo, uucp, are good candidates
apache 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-14T18:37:47.800

首先是不可能确定一封电子邮件不会被标记为垃圾邮件，唯一的方法是接收电子邮件的人将发件人地址添加到白名单中。

SPF 和 DKIM 仅保证邮件来自该域或邮箱，但不保证不是垃圾邮件。

outlook.com 中的反垃圾邮件系统与许多其他系统一样检查很多东西，例如发件人 IP 地址、每小时来自该 IP 的电子邮件数量、电子邮件内容（文本、链接）、信誉等。

在您的示例中，您没有显示正文内容，可能是不同的，因此一封电子邮件被标记为垃圾邮件，而另一封则不是。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T14:41:55.603

在解决电子邮件传递问题时，我使用端口 25 的电子邮件检查。

它会告诉您什么通过/不通过以及 SpamAssasin 如何对您的消息进行排名。

网址是： [http ://www.port25.com/support/authentication-center/email-verification/](http://www.port25.com/support/authentication-center/email-verification/)

> 要将结果直接接收到任何地址，需要将该地址添加到 check-auth 地址。例如，要将结果发送至：jsmith@yourdomain.com，示例消息应发送至 check-auth-jsmith=yourdomain.com@verifier.port25.com。

使用它，您可以了解您的 DKIM 是否正常工作/经过验证，以及您的 SpamAssasin 分数是多少。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-22T23:23:08.150

尝试使用[Pear mail](http://pear.php.net/Mail)，并围绕它制作一个包装类。我正在将它与 DKIM 一起使用，并且没有问题。我应该提到我也在使用 SpamAssassin（如前所述）和 ClamAV。

```
<?php

// Include the Pear Mail header
require_once '/usr/share/php/Mail.php';

class MailWrapper {
    public static function Send($to, $subject, $body) {
        // Email details
        $from = 'No Reply <noreply@yourdomain.com>';
        $server = 'mail.yourdomain.com';
        $port = 25;
        $username = 'sending.account@yourdomain.com';
        $password = 'yourp4ssw0rd';
        // Formalize mail server connection info
        $headers = array('From' => $from,
                 'To' => $to,
                 'Subject' => $subject,
                 'Date' => date('r'),
                 'Return-Path' => $from,
                 'Content-Type' => 'text/html; charset=UTF-8',
                 'Content-Transfer-Encoding' => '7bit',
                 'Mime-Version' => '1.0',
                 'X-Mailer' => 'Your Company (https://yourdomain.com)',
                 'X-Accept-Language' => 'en',
                 'Message-ID' => sha1($body).'@yourdomain.com'
        );
        $connection = array('host' => $server,
                    'auth' => true,
                    'username' => $username,
                    'password' => $password
        );
        // Create the mail server connection 
        $smtp = Mail::factory('smtp', $connection);
        // Send the message
        $mail = $smtp->send($to, $headers, $body);
        // Check for errors
        if (PEAR::isError($mail)) {
            echo '! [email] ['.time().'] Failed sending mail to "'.$to.'"'.PHP_EOL;
            $result = false;
        } else {
            echo '  [email] ['.time().'] Mail sent to "'.$to.'"'.PHP_EOL;
            $result = true;
        }
        return $result;
    }
}

?> 
```

# visual-studio-2010 - 将 ASP.NET 基本模板中的更新合并到自定义网站中

> ID：13595051
> 
> 赞同：1
> 
> 时间：2012-11-27T23:22:58.367
> 
> 标签：visual-studio-2010, templates, versioning, visual-sourcesafe, branching-and-merging

我们有一个在线商店/电子商务网站，我们使用 Visual Studio 2010 在 ASP.NET 网络表单中开发，我们将其用作构建更多商店的模板。我们每个客户的要求都略有不同，因此我们需要对模板进行自定义，例如为产品添加字段，或者添加与产品相关的新数据库表。

我们希望能够对模板进行改进并将更改传播到基于它的定制网站，同时保持这些定制。

到目前为止，我有几个想法：

1.  从模板中对每个自定义网站进行“差异”，并将其存储为每个网站的补丁。更新模板时，只需将模板复制到所有自定义站点并重新应用补丁即可。但是，我不确定我们将如何处理版本控制，因为每个站点当前都作为单独的项目存储在 Visual SourceSafe 中。

2.  尝试以允许在不更改代码或数据库的情况下进行自定义的方式构建模板。但我觉得这将很难实现。

有没有人对实际实现有更好的想法或建议？

# kineticjs - 在 KineticJS 中 Shape 类的哪些属性是可转换的

> ID：13595052
> 
> 赞同：0
> 
> 时间：2012-11-27T23:23:01.813
> 
> 标签：kineticjs

我不太清楚`Shape`Class 中的哪些属性可以在`KineticJS`lib 中转换。任何关于主观的观点都会非常有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T05:49:28.800

最初我问这个问题是因为我意识到我不能补间 a`Shape`的`fill`属性，

然而，经过一番搜索，我发现了一个关于[snorkl](http://snorkl.tv/dev/kineticJS/)的快速实验，这让我看到了如何使用 greensock 著名的[TweenMax对其进行动画处理](http://www.greensock.com/gsap-js/)

所以这就是我能够设置的，我会为你们把它放在 jsfiddle 上，但我不会为找到 TweenMax 和 Kinetic 的 CDN 版本而烦恼。

```
var stage = new Kinetic.Stage({
    container: 'canvasContainer',   //Some div's id on your page
    width: 800,
    height: 600
});

var layer = new Kinetic.Layer();

var circle = new Kinetic.Circle({
    x: 0,
    y: 0,
    radius: 50,
    fill: "#FF0000",
});

layer.add(circle);

TweenMax.to(circle, 1, {
    setX: 100,      //notice the camelType
    setY: 100,      //tweenMax translates setProperty to, circle.Property(tweened value)

    colorProps:{    //if you want to tween colour use colorProps
        setFill: randomRGB()
    }
});

TweenLite.ticker.addEventListener("tick", go);

function go() {
  layer.draw(); //redraws after each calculation
} 
```

希望能帮助到你

# php - 如果使用一个查询而不是嵌套检查复选框，我可以向表中添加新行吗？PHP, MySQL

> ID：13595054
> 
> 赞同：0
> 
> 时间：2012-11-27T23:23:04.277
> 
> 标签：php, mysql

经过一番折腾，我让这个查询工作了——但它看起来很笨重，运行时感觉很慢。

我有一个名为 UserTable 的表，如果特定用户对该项目说“是”，则会填充一个名为“项目”的字段。我只想在该实例中将该项目的一行添加到 UserTable 中 - 换句话说，我不想在表中有很多 user_ID/Item/'no' 关系，只有 user_ID/Item/'yes'回应。

我已经构建了一些代码，向用户显示整个数据集，并允许他们更改他们的偏好，然后按更新。当它们更新时，会输出一个名为 $checkbox 的数组，其中包括它们已勾选为“是”的项目编号（例如“1”、“3”、“6”）。如果他们没有勾选任何内容，则 $checkbox 设置为 ""。

这是相关代码 - 正如我所说，它非常笨拙，在 FOREACH 中有一个 WHILE 以及两个验证 IF 语句。我可以摆脱一个（或两个！）循环并用 SELECT 类型命令替换吗？

```
foreach($checkbox as $value)
    {if($value!="") {
        $sql=   "SELECT count(Item) as row_exists 
                FROM UserTable
                WHERE Item = '$value' and 
                User_ID = '$current_user_id'";

        $result = mysqli_query($mysqli,$sql) or die(mysqli_error($mysqli));

        while ($iteminfo = mysqli_fetch_array($result)) {
            If ((int)$iteminfo['row_exists']==0) { 
                    $sql = "INSERT INTO UserTable 
                            (User_ID,Item,Date) VALUES
                            ('$current_user_id','$value',now() )";
            $add_new_row = mysqli_query($mysqli,$sql) or die(mysqli_error($mysqli));
            } 
        }
    }
} 
```

提前谢谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:47:47.053

因此，如果一个用户可以与多个项目相关联，那么您似乎应该对此进行规范化并可能拥有三个表 - 一个用于用户，一个用于项目，以及一个将用户与项目相关联的多对多表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:29:07.217

您可以消除两个 if 语句：

1.  在 != "" 上过滤您的复选框数组并遍历这些结果。如果检查！=“”，那将摆脱第一个。

2.  扩展您的初始查询以包含 row_exists = 0，并迭代这些结果。这摆脱了第二个如果。

事实上，您可以将两条 sql 语句合并为一个复合条件插入。您可以插入以下表格：

```
INSERT INTO table (SELECT ...) 
```

因此，您可以查看第一个查询并将其调整/替换为上面查询的 SELECT... 部分，然后进行第二次插入并调整/替换它来代替上面的 INSERT INTO...。

# asp.net - 如何在 ASP.NET 中绑定依赖下拉列表

> ID：13595055
> 
> 赞同：1
> 
> 时间：2012-11-27T23:23:05.447
> 
> 标签：asp.net, data-binding

我需要一种方法来绑定基于其父节点填充的多个下拉列表。

`RootDDL <- child <- grandchild[]`

代码看起来类似于

```
<FormView DataSoureceID="rootDatasource">
    <DropDownList ID="RootDLL" AutoPostBack="true">
        <!--items-->
    </DropDownList>
    <DropDownList ID="child" AutoPostBack="true" DataSourceID="ChildDataSource" />
    <SqlDataSource ID="ChildDataSource" />

    <DropDownList ID="grandchild" DataSourceID="GrandChildDataSource" SelectedValue='<%# Bind('SomeFieldInRootDatasource') %>' />
    <SqlDataSource ID="GrandChildDataSource">
        <SelectParameters>
            <ControlParameter ControlID="child" PropertyName="SelectedValue" />
        </SelectParameters>
    </SqlDataSource>
    <Button Command="Update" />
</FormView>
<SqlDataSource ID="rootDatasource">
    <InsertParameters>
        <asp:Parameter Name="SomeFieldInRootDatasource" />
    </InsertParameters>
    <UpdateParameters>
        <asp:Parameter Name="SomeFieldInRootDatasource" />
    </UpdateParamters>
</SqlDataSource> 
```

更改 rootDDL 是可行的，不幸的是，当 Child selectedvalue 更改时，大孩子`<%# Bind %>`尝试重新绑定但不能，因为 FormView 不再充当容器。

它失败了

> Eval()、XPath() 和 Bind() 等数据绑定方法只能在数据绑定控件的上下文中使用。

这个问题有没有不需要我添加事件（多个）处理程序的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:16:25.833

我最终`hiddenfield`为每个孩子创建了一个`dropdownlist`，然后将其绑定到我需要的值。我创建了一个泛型`indexchange handler`，然后`hiddenfeild`用所需的结果更新。这导致绑定字段不被数据源更新（避免首先导致问题的重新绑定系统调用）。

不确定这是否是最好的解决方案，但它应该适用于大多数情况。

# android - Android Textview 不更新

> ID：13595056
> 
> 赞同：1
> 
> 时间：2012-11-27T23:23:11.687
> 
> 标签：android, multithreading, timer, textview

每个人。我正在尝试为 Android 制作一个基本的大亨游戏，并且我正在尝试使用计时器每 5 秒增加一次文本视图的值，但文本视图不会更新。到目前为止，这是我的代码：

```
public class Town extends Activity implements OnClickListener {
Timer timer;
TimerTask task;
TextView goldTV;
TextView woodTV;
TextView foodTV;
TextView stoneTV;
TextView cashTV;
int gold = 20;
int wood = 20;
int food = 20;
int stone = 20;
int cash = 200;
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_town);
    goldTV = (TextView) findViewById(R.id.textView1);
    woodTV = (TextView) findViewById(R.id.TextView01);
    foodTV = (TextView) findViewById(R.id.TextView02);
    stoneTV = (TextView) findViewById(R.id.TextView03);
    cashTV = (TextView) findViewById(R.id.TextView04);
    timer = new Timer();
    task = new TimerTask() {

        @Override
        public void run() {
            gold++;
            goldTV.setText(gold);
            try {
                this.wait(2000);
            }
            catch (InterruptedException e){
            }
        }

    };
}
@Override
public void onClick(View arg0) {
    // TODO Auto-generated method stub

} 
```

}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T23:30:47.700

在你的`run()`方法中

```
@Override
public void run() {
          gold++;
          goldTV.setText(gold);

          try {
                this.wait(2000);
          }
          catch (InterruptedException e){

          }
} 
```

你打电话`setText(int resId)`而不是`setText(CharSequence c);`

要显示实际整数`gold`，请将其从 转换`int`为`String`

```
String goldStr = String.valueOf(gold);

goldTV.setText(goldStr); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T23:28:04.190

您的问题是您正在更改 UI 线程以外的其他内容上的文本。更好的是在 UI 线程上运行它。另外，您应该将您的数字转换为字符串，否则 Android 会认为您正在寻找资源 id。把它们放在一起，然后...

```
task = new TimerTask() {

    @Override
    public void run() {
        gold++;
        runOnUiThread(new Runnable(){
           public void run(){
            goldTV.setText(""+gold);
           }
        });
        try {
            this.wait(5000);
        }
        catch (InterruptedException e){
        }
    }

}; 
```

或者更好的是，您可以使用处理程序，如下所示：

```
Handler handler = new Handler();
Runnable task=new Runnable(){
   public void run(){
      handler.postDelayed(this,5000);
      goldTV.setText(""+gold);
   }
});
handler.postDelayed(task,5000); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T23:29:07.030

TimerTask 应该与 Timer 对象一起使用。在您的代码中，您永远不会运行任务。

**编辑：** 试试这个：

```
goldTV.postDelayed(new Runnable() {

            @Override
            public void run() {
                gold++;
                goldTV.setText(gold+"");
                goldTV.postDelayed(this,2000);
            }
        }, 2000); 
```

# symfony - Symfony2 / Doctrine - 修改所有查询

> ID：13595059
> 
> 赞同：4
> 
> 时间：2012-11-27T23:24:04.560
> 
> 标签：symfony, doctrine-orm

是否可以通过某种 walker 运行所有学说查询，以便我可以根据当前用户的凭据修改查询？理想情况下，我不必在每个查询中为自定义 walker 显式调用 setHint，因为这会限制我将当前 SecurityContext 传递给 walker 的能力。

另外，我不想使用 Doctrine 过滤器，因为我无法使用过滤器修改连接条件，并且我将被迫使用“IN”子句，这会严重影响性能

目前，我正在使用一项根据用户的凭据修改 QueryBuilder 的服务，但这变得乏味，因为我每次创建新的 QueryBuilder 时都需要调用该服务，而且当存储库发挥作用时更加痛苦（因为我需要将服务注入到需要修改查询的每个存储库中。

希望我已经足够清楚地解释了这一点。感谢任何反馈！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T15:49:33.190

我想我已经解决了我自己的问题。如果其他人有更优雅的方式来实现这些结果，请随时解释。为了修改我的所有查询，我创建了一个自定义 EntityManager 和自定义 EntityRepository。

在我的自定义 EntityManager 中，我覆盖了 2 个方法。create() 和 getRepository()

```
public static function create($conn, Configuration $config, EventManager $eventManager = null)
{
    if ( ! $config->getMetadataDriverImpl()) {
        throw ORMException::missingMappingDriverImpl();
    }

    switch (true) {
        case (is_array($conn)):
            $conn = \Doctrine\DBAL\DriverManager::getConnection(
                $conn, $config, ($eventManager ?: new EventManager())
            );
            break;

        case ($conn instanceof Connection):
            if ($eventManager !== null && $conn->getEventManager() !== $eventManager) {
                 throw ORMException::mismatchedEventManager();
            }
            break;

        default:
            throw new \InvalidArgumentException("Invalid argument: " . $conn);
    }

    return new MyCustomEntityManager($conn, $config, $conn->getEventManager());
} 
```

此方法中唯一改变的是我返回了我自己的 EntityManger( **MyCustomEntityManager** )。然后，我将 getRepository 方法覆盖如下：

```
public function getRepository($entityName)
{
    $entityName = ltrim($entityName, '\\');

    if (isset($this->repositories[$entityName])) {
        return $this->repositories[$entityName];
    }

    $metadata = $this->getClassMetadata($entityName);
    $repositoryClassName = $metadata->customRepositoryClassName;

    if ($repositoryClassName === null) {
        $repositoryClassName = "Acme\DemoBundle\Doctrine\ORM\MyCustomEntityRepository";
    }

    $repository = new $repositoryClassName($this, $metadata);

    $this->repositories[$entityName] = $repository;

    return $repository;
} 
```

在这里，我也只修改了一行。我没有依赖 DBAL 配置来检索默认的 $repositoryClassName，而是指定了我自己的默认存储库**Acme\DemoBundle\Doctrine\ORM\MyCustomEntityRepository**。

一旦你创建了你自己的自定义 EntityRepository，天空就是极限。您可以将服务注入存储库（我目前使用 JMS Di 注释，如下所述），或在 createQueryBuilder 方法中对 QueryBuilder 执行自定义操作，如下所示：

```
use JMS\DiExtraBundle\Annotation as DI;

class MyCustomEntityRepository extends EntityRepository
{
    private $myService;

    public function createQueryBuilder($alias)
    {
         $queryBuilder = parent::createQueryBuilder($alias);

          /** INSERT CUSTOM CODE HERE **/

          return $queryBuilder;
    }

    /**
    * @DI\InjectParams({
    *     "myService" = @DI\Inject("my_service_id")
    * })
    */
    public function setMyService(MyServiceInterface $myService)
    {
        $this->myService = $myService;
    }
} 
```

创建自己的 EntityRepository 后，您应该让所有需要此自定义功能的存储库扩展 MyCustomEntityRepository。您甚至可以更进一步，创建自己的 QueryBuilder 来进一步扩展它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-04T09:50:37.663

你可以编写一个[自定义的 AST Walker](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/cookbook/dql-custom-walkers.html)并设置你的应用程序使用这个 walker 来处理所有带有`defaultQueryHint`（Doctrine 2.5 新特性）配置选项的查询：

```
<?php
/** @var \Doctrine\ORM\EntityManager $em */
$em->getConfiguration()->setDefaultQueryHint(
    Query::HINT_CUSTOM_TREE_WALKERS,
    ['YourWalkerFQClassName']
) 
```

# java - 如何继续检查 EditText 是否为空（如果启用了空按钮，则禁用）：android/java

> ID：13595061
> 
> 赞同：0
> 
> 时间：2012-11-26T08:22:59.787
> 
> 标签：java, android, xml

我有两个 EditText 字段和一个按钮。

我想做以下事情：

```
if the EditText1 && EditText2 == empty
   then
      button is disabled
     else
      button is disabled 
```

仅当用户在两个字段中都写了一些东西时，才应启用该按钮，

简单来说：

```
 if the user write something in both fields, the button will be enabeld, 
```

如果他删除了他写的内容，然后再次禁用该按钮。

如果有人回答我，我会很遗憾。

安卓2.2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:39:17.677

你想要[TextWatcher](http://developer.android.com/reference/android/text/TextWatcher.html)。使用它来确定何时更改两者中的文本。每次更改文本时或在 while 循环中，您都可以执行“if else”。希望这可以帮助。我想你会感激不后悔的帮助:)

# c++ - std::chrono::high_resolution_clock 不准确？

> ID：13595062
> 
> 赞同：5
> 
> 时间：2012-11-27T23:24:21.587
> 
> 标签：c++, c++11, timing, chrono

所以我试图使用 std::chrono::high_resolution_clock 来计算执行需要多长时间。我想你可以找到开始时间和结束时间之间的差异......

为了检查我的方法是否有效，我编写了以下程序：

```
#include <iostream>
#include <chrono>
#include <vector>

void long_function();

int main()
{
    std::chrono::high_resolution_clock timer;
    auto start_time = timer.now();

    long_function();

    auto end_time = timer.now();
    auto diff_millis = std::chrono::duration_cast<std::chrono::duration<int, std::milli>>(end_time - start_time);

    std::cout << "It took " << diff_millis.count() << "ms" << std::endl;
    return 0;
}

void long_function()
{
    //Should take a while to execute.
    //This is calculating the first 100 million
    //fib numbers and storing them in a vector.
    //Well, it doesn't actually, because it
    //overflows very quickly, but the point is it
    //should take a few seconds to execute.
    std::vector<unsigned long> numbers;
    numbers.push_back(1);
    numbers.push_back(1);
    for(int i = 2; i < 100000000; i++)
    {
        numbers.push_back(numbers[i-2] + numbers[i-1]);
    }
} 
```

问题是，它只是精确地输出 3000 毫秒，而实际上显然不是这样。

在较短的问题上，它只输出 0ms ......我做错了什么？

编辑：如果有任何用处，我正在使用带有 -std=c++0x 标志的 GNU GCC 编译器

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T16:48:46.300

high_resolution_clock 的分辨率取决于平台。

打印以下内容将使您了解您使用的实现的解决方案

```
 std::cout << "It took " << std::chrono::nanoseconds(end_time - start_time).count() << std::endl; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-17T08:39:12.740

我在 window7 下的 g++ (rev5, Built by MinGW-W64 project) 4.8.1 遇到了类似的问题。

```
int main()
{
    auto start_time = std::chrono::high_resolution_clock::now();
    int temp(1);
    const int n(1e7);
    for (int i = 0; i < n; i++)
        temp += temp;
    auto end_time = std::chrono::high_resolution_clock::now();
    std::cout << std::chrono::duration_cast<std::chrono::nanoseconds>(end_time - start_time).count() << " ns.";
    return 0;
} 
```

如果 n=1e7 则显示 19999800 ns，但如果 n=1e6 则显示 0 ns。

精度似乎很弱。

# java - 如何修改 GridData 的 heightHint

> ID：13595071
> 
> 赞同：1
> 
> 时间：2012-11-27T23:25:15.997
> 
> 标签：java, swt, grid-layout

我有一个`Composite`一`GridLayout`列。在里面，我放了两个`Canvas` *C1*和*C2*。目前，我修复`heightHint`了*C1*`GridData`和*C2*的is `grabExcessVerticalSpace`。*`GridData``true`*

 *现在，在程序执行期间，我想改变*C1*的高度，我试图修改它`GridData` `heightHint`但没有结果。我也试图改变它`minimumHeight`，但没有成功。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T08:06:47.187

在运行时，如果您修改了布局数据，您还需要调用`Composite#layout()`其布局数据已修改的控件的父级。在您`layout()`的 C1 和 C2 的父组合的情况下，一旦修改布局数据以使更改生效，必须调用它。*

# javascript - 平移和缩放地图以适应 D3.js 中的视口

> ID：13595072
> 
> 赞同：0
> 
> 时间：2012-11-27T23:25:19.800
> 
> 标签：javascript, d3.js, gis, geojson

我正在尝试使用 D3js 在 GeoJson 中加载里约热内卢（巴西）的地图

代码和地图在这里： [https ://gist.github.com/4157853](https://gist.github.com/4157853)

我可以使用 Qgis 正常打开地图，但使用 d3js SVG 画布中不会出现任何内容。我的投影是 epsg4326，和谷歌地图一样。单位是纬度/经度。

我究竟做错了什么？

# java - 并发问题 - 从 Java 中的多线程服务器下载的相同文件的大小不同

> ID：13595073
> 
> 赞同：0
> 
> 时间：2012-11-27T23:25:20.140
> 
> 标签：java, multithreading, sockets

我已经用 Java 实现了一个用于下载文件的多线程客户端/服务器程序，其中服务器可以通过利用线程同时将文件提供给许多客户端。

当我使用单个客户端测试服务器时，它工作正常，但是当我使用 shell 脚本对十个或更多客户端进行测试时，下载的文件都有不同的大小，这与服务器端文件的实际大小不同。

谁能解释为什么会这样？

**服务器代码：**

```
public class FileSend implements Runnable {
   Socket sock;
   String pathname;

   FileSend(Socket s, String filename) {
      sock = s;
      pathname = System.getenv("HOME") + "/" + Main.spath + "/" + filename;
   }

   void send(String pathname) throws IOException, NoSuchAlgorithmException,
         NoSuchPaddingException, ParseException {

      try {
         byte[] buf = new byte[1024];
         OutputStream os = sock.getOutputStream();
         //PrintWriter writer = new PrintWriter(os);
         BufferedOutputStream out = new BufferedOutputStream(os, 1024);
         int i = 0;
         File fp = new File(pathname);
         RandomAccessFile ra = new RandomAccessFile(fp, "r");
         long bytecount = 1024;
         ////////////////

         while ((i = ra.read(buf, 0, 1024)) != -1) {

            bytecount += 1024;
            out.write(buf, 0, i);
            out.flush();
         }
         sock.shutdownOutput();
         out.close();
         ra.close();
         sock.close();
      } catch (IOException ex) {

      }
   }

   public void run() {
      try {
         try {
            try {
               try {
                  send(this.pathname);
               } catch (ParseException ex) {
                  Logger.getLogger(FileSend.class.getName()).log(Level.SEVERE,
                        null, ex);
               }
            } catch (NoSuchPaddingException ex) {
               Logger.getLogger(FileSend.class.getName()).log(Level.SEVERE,
                     null, ex);
            }
         } catch (NoSuchAlgorithmException ex) {
            Logger.getLogger(FileSend.class.getName()).log(Level.SEVERE, null,
                  ex);
         }
      } catch (IOException ex) {
         Logger.getLogger(FileSend.class.getName()).log(Level.SEVERE, null, ex);
      }
   }
} 
```

**客户代码：**

```
public class FileRecieve implements Runnable {
   Socket sock;
   String path;
   Date T;

   //private Date d2;
   FileRecieve(Socket s, String fname, Date d1) {
      sock = s;
      path = Main.Dpath + "/" + fname;
      T = d1;
   }

   public void run() {
      try {
         byte[] b = new byte[1024];
         int len = 0;
         long bytcount = 1024;

         File fp = new File(path);
         // RandomAccessFile ra = new RandomAccessFile(fp,"r");

         RandomAccessFile ra = new RandomAccessFile(fp, "rw");
         ra.seek(0);
         InputStream is = sock.getInputStream();
         BufferedReader reader = new BufferedReader(new InputStreamReader(is));
         while ((len = is.read(b, 0, 1024)) != -1) {
            bytcount = bytcount + 1024;

            //decrypt
            ra.write(b, 0, len);
         }

         is.close();
         ra.close();
         sock.close();
      } catch (IOException ex) {
         ex.printStackTrace();
      }
   }
} 
```

请帮助，非常感谢提前。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T15:38:44.730

I have made a similar attempt at a Mutithreaded Client-Server [file downloader](https://codereview.stackexchange.com/questions/19113/multithreaded-client-server-file-downloading-application) app. You can check it out at code review. I have used the [java.util.concurrent](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/package-summary.html) package classes for the multithreading bit.

# python - 为什么 os.kill(pid, 0) 尽管进程已终止但返回 None ？

> ID：13595076
> 
> 赞同：5
> 
> 时间：2012-11-27T23:25:32.127
> 
> 标签：python, django

这个问题与我的其他问题之一的[这个答案有关。](https://stackoverflow.com/a/13402639/1125413)我在这个答案中被告知可以`os.kill(pid, 0)`用来检查子进程是否已终止。如果它仍在运行，`None`则返回。如果它已终止，`OSError`则引发 an。到目前为止，这一直运行良好，但现在我处于一种`os.kill(pid, 0)`仍然返回的情况，`None`尽管子进程已经终止。进程 ID 为 82430，在 OSX 的活动监视器中，我再也找不到具有此 ID 的进程。但是，当我打开 Python shell 并输入`os.kill(82430, 0)`时，它仍然返回`None`. 我不明白。

准确地说，我通过 Ajax GET 请求在 Django 视图中定期检查子进程的状态，如上所示。

**服务器端的 Django 视图**

```
def monitor_process(request):
    response_data = {}

    try:
        os.kill(int(request.GET['process_id']), 0)
        response_data['process_status'] = 'running'
    except OSError:
        response_data['process_status'] = 'finished'

    return HttpResponse(json.dumps(response_data), mimetype='application/json') 
```

**客户端的 Ajax 调用**

```
var monitorProcess = function(processId) {

    $.ajax({
        dataType: 'json',
        type: 'GET',
        url: '/monitor_process/',
        data: {'process_id': processId},
        success: function(response) {

            if (response.process_status == 'running') {
                // Only this branch is always executed

                // ...
            }

            else if (response.process_status == 'finished') {
                // This branch never gets executed

                // Stop checking for process status
                // The periodic check was started by 
                // window.setInterval in a different Ajax call
                clearInterval(monitorProcessId);

                // ...

            }
        }
    });
}; 
```

尽管该过程在某些时候停止并在活动监视器中消失，但`os.kill()`显然无法识别它。为什么会这样？非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T23:37:41.963

这与 python 无关，更多的是关于进程本身：每个正在运行的进程可能会产生一些具有不同 PID 的线程。如果父母没有被正确杀死，他们会留在那里（“僵尸线程”）。它们与它们的父级在同一 ID 下分组在一起。这就是为什么，在 python 中，你可以使用

```
os.killpg(pgid, sig) 
```

杀死所有组。你可以检查下

```
/proc/<PID>/task/ 
```

（您的实际进程 ID 在哪里）用于生成的任何线程

# scala - 为什么函数头没有在List中实现

> ID：13595078
> 
> 赞同：3
> 
> 时间：2012-11-27T23:25:46.807
> 
> 标签：scala

我想知道是否有“函数式编程”的原因导致该函数`heads`不在 List （或更一般地在[TraversableLike](http://www.scala-lang.org/api/current/index.html#scala.collection.TraversableLike)）中实现。对我来说，`heads`这完全相反，`tails`但我必须错过一些东西。

由于 Scala 易于阅读，因此我将看到以下内容（针对该`List`案例）：

```
def heads[T](li:List[T]):List[List[T]] = li match {
  case Nil => Nil
  case head::tail => (Nil::heads(tail)).map(head::_)
} 
```

所以，这里是我想到的不实现这个功能的几种可能性：

1.  `head`表示 a 的第一个元素`List`，因此如果只有一个，则创建一个遍历所有头的函数是没有意义的。那为什么不是函数`prefixes`呢？
2.  不可能使这个函数尾递归，所以我们宁愿忽略它。
3.  它没用（是吗？）
4.  它与函数式编程的哲学不兼容（为什么？）

提前感谢您的回答。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-27T23:39:52.803

我想你正在寻找 inits。

head = 第一个元素
last = 最后一个元素
tail = 除了头部之外的所有元素
tails = 递归 tail
init = 除了最后一个元素之外的所有元素
= 递归初始化

[请参阅Collections API](http://www.scala-lang.org/docu/files/collections-api/collections.html)中 trait Traversable 下的描述。

# jquery - $(document).ready 在 IE 9 中调用了两次

> ID：13595080
> 
> 赞同：0
> 
> 时间：2012-11-27T23:25:51.747
> 
> 标签：jquery, internet-explorer, document-ready

这只发生在 IE9 中，我在 Firefox/Chrome 中没有看到这种行为。

有问题的网站是： [www.pocomaru.com](http://www.pocomaru.com)

如果你打开它，在 中设置一个断点`$(document).ready`，当页面加载时你会看到它进入那里两次，而第一次`dom`还没有准备好。`($("createPassLB")`返回无效。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:32:43.027

你用的是什么版本的jquery？版本 1.8.0 有一个类似于您描述的错误。[http://bugs.jquery.com/ticket/12282](http://bugs.jquery.com/ticket/12282)

# shell - 可以自动将命令别名添加到 DOS shell 中吗？

> ID：13595094
> 
> 赞同：1
> 
> 时间：2012-11-27T23:27:04.433
> 
> 标签：shell, powershell, dos

有没有办法让我的 Windows 7 系统上的所有 DOS shell 都有这个命令别名？

```
doskey h=doskey /history 
```

这是否可能，就像 Bash shell 可以加载 .bash_profile 一样？我正在寻找不需要 PowerShell 的答案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T00:25:00.707

好吧，DOS在这里并不是一个正确的词。在当前版本的 Windows 中，您拥有 CMD.exe shell，它具有许多与 DOS 相同的命令（dir、copy 等）。您可能还拥有 PowerShell。在 PowerShell 中，很容易将别名配置为始终可用。创建一个名为`$home\Documents\WindowsPowerShell\profile.ps1`并创建别名的文件，如下所示：

```
New-Alias h Get-History # Don't execute as it already exists 
```

但是，PowerShell 已经为您创建了这个特定的别名。只需打开 PowerShell，执行一些命令，然后执行`h`.

至于 CMD.exe，这篇[博](http://www.uberullu.com/alias-in-windows-command-line-ms-dos-how-to/)文描述了如何配置 CMD.exe 来做同样的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T23:54:15.293

简而言之：不。命令处理器（cmd.exe 和 command.com）不支持别名，因为您从 bash 和其他 shell 中知道它们。

更长的答案：您可以通过制作巧妙的批处理文件来创建一个“假”别名，这些文件采用参数（%1 等）并将它们传递给真正的命令。这有可能以许多光荣的方式崩溃，但它可能会在您的情况下提供有用的解决方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T18:22:53.357

根据 Keith Hills 的回答，这是我为此创建的批处理文件：

```
@ECHO OFF 
:: to install, place this dos_profile.bat script in the location you want 
:: it to reside and then run this batch script with the argument "register"
ECHO Commands defined by dos_profile.bat : F7, h, ls, cp, mv
IF "%1"=="register" (
  REG.exe ADD "HKCU\Software\Microsoft\Command Processor\Autorun" /ve /t REG_SZ /d "%CD%\dos_profile.bat" /f
  ECHO The DOS profile is registered.  Load a new command prompt and test a command.
)
@DOSKEY LS=DIR $* 
@DOSKEY CP=COPY $* 
@DOSKEY MV=MOVE $* 
@DOSKEY H=DOSKEY /HISTORY 
```

# dart - 如何在 Dart 中触发键盘事件

> ID：13595098
> 
> 赞同：4
> 
> 时间：2012-11-27T23:27:20.923
> 
> 标签：dart

就像我在标题中说的，我想在 Dart 中模拟一个 keyup 事件。问题是我还没有找到如何创建一个新的 KeyboardEvent 对象。

我发现的唯一方法是使用 Event(String type) 构造函数，然后在窗口对象上调度它。但这不起作用，因为我的“keyup”处理程序在参数中接受了一个 KeyboardEvent。例子：

```
window.on.keyUp.add((KeyboardEvent e){
 print('keyUp handler');
});
KeyboardEvent e = new Event("KeyboardEvent");
window.on.keyUp.dispatch(e); 
```

有没有办法创建和调度 KeyBoardEvent 来模拟 Dart 中的“keyup”？

另外，我应该提到我也尝试在 JavaScript 中触发事件，这要归功于 js-interop 库，但它只触发 JS 处理程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T03:44:17.780

试试下面的代码：

```
window.on.keyUp.add((Event event){
    print('keyUp handler');

    if(event is KeyboardEvent)
    {
      KeyboardEvent keyEvent = event as KeyboardEvent;
      //do stuff with keyEvent if needed
    }  
});

window.on.keyUp.dispatch(new Event("keyup")); 
```

我认为 Event 构造函数上的参数必须是事件的类型。此外，您可以检查事件是否是键盘事件，例如，您可以处理 KeyIdentifier。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T17:11:40.973

现在可以从窗口调度 KeyBoardEvent，请参阅 Google Group 上的讨论以获取更多信息：[https ://groups.google.com/a/dartlang.org/d/topic/misc/mgnd1TUGn68/discussion](https://groups.google.com/a/dartlang.org/d/topic/misc/mgnd1TUGn68/discussion)

# html - 带有边框图像和动态宽度的 h1 是否可能？

> ID：13595099
> 
> 赞同：0
> 
> 时间：2012-11-27T23:27:26.347
> 
> 标签：html, css

我正在尝试使用以下方法动态创建此功能区效果`h1`：

![在此处输入图像描述](../Images/b53c82a1117b0352d5d18ce601b11288.png)

我有这两张图片：

![在此处输入图像描述](../Images/60dbb6fe69c7364bc948fbf6e1994b97.png)

![在此处输入图像描述](../Images/ace7257a725d93a071432573fd171d41.png)

我的目标是将这些粘贴在`h1`标签的每一端，使用该`display: inline;`属性添加动态宽度。有什么“正确的方法”可以做到这一点并让它跨浏览器工作吗？

出于我的测试目的，色带末端高 40 像素，宽 18 像素。我还不确定我要对阴影做什么，但如果你们能帮我弄清楚如何让它工作，我可以让它看起来不错。（希望）

为澄清起见，这是我到目前为止的（非工作）css：

```
h1 {
display: inline;
height: 40px;
background-image: url(images/ribbon/left.png), url(images/ribbon/right.png);
background-position: left, right;
padding: 0 18x;
background-color: #ECECEC;
} 
```

上面的 css 导致`#ECECEC`颜色在色带末端后面渗出。有任何想法吗？

**更新：** 如果有帮助，这里是我当前 css 带给我的屏幕截图。这有点耸人听闻，以使结果更容易看到。我添加了红色背景而不是`#ECECEC`.

![在此处输入图像描述](../Images/f015e8a1c69722c8850c663b036f82ac.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:31:53.097

第一次尝试

```
overflow: hidden 
```

也可能是浏览器问题： [Border Radius = Background Bleed](https://stackoverflow.com/questions/4401442/border-radius-background-bleed)

编辑：你有没有想过不要一起使用图像而只使用纯 css [http://css-tricks.com/snippets/css/ribbon/](http://css-tricks.com/snippets/css/ribbon/)

可能看起来不像你想要的，但搞乱 css 会解决这个问题。

# facebook - 我不明白这封来自 Facebook 的关于我的应用的电子邮件

> ID：13595101
> 
> 赞同：3
> 
> 时间：2012-11-27T23:27:33.887
> 
> 标签：facebook, rules

> **可能重复：**
> [12 月 5 日发生变化 - facebook 表示应用程序将生效](https://stackoverflow.com/questions/13587728/dec-5th-beaking-changes-facebook-says-app-will-be-effect)

我收到一封电子邮件，说我的应用正在影响一些新规则。不幸的是，英语不是我的母语，我发现无法询问 facebook 支持 - 我不确定我是否正确理解了这封电子邮件。我希望你能帮帮我：

> 您主要在 Facebook 之外托管的桌面网络游戏目前在进行身份验证和/或请求年龄、电子邮件和发布权限之外的其他权限时访问用户连接。Facebook 平台政策 I.13a 不再允许这样做：
> 
> Facebook.com 以外的桌面网页游戏只能使用 Facebook 登录（身份验证，不包括朋友列表等用户连接）、社交插件和发布（例如，Feed Dialog、Stream Publish 或 Open Graph）。在进行身份验证时，这些游戏可能不会请求除年龄、电子邮件和我们的发布权限之外的其他权限。
> 
> 如果您的应用程序正在访问用户连接 ( [https://developers.facebook.com/docs/reference/api/user/](https://developers.facebook.com/docs/reference/api/user/) ) 或要求超出年龄、电子邮件和我们的发布权限的其他权限，请删除这些请求。12 月 5 日之后，如果您的应用继续访问用户连接或请求除“user_birthday”、“电子邮件”或我们的发布权限（例如“publish_actions”或“publish_stream”）之外的其他权限，我们将对您的应用设置限制。

我是否理解这一点，我可以要求获得额外的许可，如电子邮件或发布流，但仅此而已？

我将登录 URL 从“scope=email,publish_stream,read_stream,user_games_activity”更改为：“scope=email,publish_stream”现在可以了吗？

我也使用 $facebook->api('/'.$FacebookID.'/friends'); 获取朋友列表并构建一个表单，用户可以在其中向他的朋友发送邀请。这不再被允许了吗？

> • 您的画布/手机游戏目前与 Facebook.com 上的桌面网页游戏共享相同的应用程序 ID，根据 Facebook 平台政策 I.13b 不再允许这样做：
> 
> （Facebook.com 和移动设备上的游戏不得与 Facebook.com 之外的桌面网页游戏共享相同的应用 ID。您不得使用 Canvas 应用程序来宣传或链接到 Facebook 之外的游戏网站，也不得使用从我们那里获得的电子邮件推广或链接到 Facebook.com 以外的桌面网络游戏）。
> 
> 请为您的 Facebook Connect 集成创建一个单独的应用 ID。12 月 5 日之后，如果您的 Connect 应用程序继续与其 Canvas/移动应用程序共享应用程序 ID，则将无法再访问它。
> 
> 您收到此消息是因为您的应用程序使用了 Connect 集成。如果您认为这是一个错误，请参考开发者文档以确保您的应用被正确分类。

这个我完全看不懂。我在哪里可以做到这一点？我的应用在 facebook 有一个自己的 URL 和一个画布页面。删除画布页面并仅保留直接 URL 就足够了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:42:50.960

> 我将登录 URL 从“scope=email,publish_stream,read_stream,user_games_activity”更改为：“scope=email,publish_stream”现在可以了吗？

是的，现在应该可以了，因为根据重大更改“这些游戏可能不会请求除年龄、电子邮件和我们的发布权限之外的其他权限。” 所以你应该没问题。

> 我也使用 $facebook->api('/'.$FacebookID.'/friends'); 获取朋友列表并构建一个表单，用户可以在其中向他的朋友发送邀请。这不再被允许了吗？

`/friends`不需要任何额外的权限，所以我*认为*应该没问题。

> 我在哪里可以做到这一点？我的应用在 facebook 有一个自己的 URL 和一个画布页面。删除画布页面并仅保留直接 URL 就足够了吗？

是的，您需要将您的画布/手机游戏与桌面网页游戏分开。目前，它们都具有相同的应用 ID，您可以选择完全删除画布页面或为画布/移动游戏创建新应用并使用该新应用 ID。无论如何，最终结果是只有您的一款游戏可以使用您现有的应用 ID。

# jquery - jQuery热键调用函数

> ID：13595103
> 
> 赞同：2
> 
> 时间：2012-11-27T23:28:00.807
> 
> 标签：jquery, hotkeys

我使用这个 jquery [https://github.com/tzuryby/jquery.hotkeys](https://github.com/tzuryby/jquery.hotkeys)作为热键。

请，我怎么能称之为“添加”功能：

```
<script type = "text/javascript" >
    function add(int) {
        if (window.XMLHttpRequest) {
            xmlhttp = new XMLHttpRequest();
        } else {
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }
        xmlhttp.onreadystatechange = function() {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                document.getElementById("add").innerHTML = xmlhttp.responseText;
            }
        }
        xmlhttp.open("GET", "method.php?a=" + int, true);
        xmlhttp.send();
    } 
</script> 
```

例如，我需要调用添加 javasctipt，而不是警报：

```
<script src="jquery-1.4.2.js"></script>
<script src="jquery.hotkeys.js"></script >

<script> 
    $(document).bind('keydown', 'ctrl + k', function() {
       alert('Teskt hotkey!'); 
       // I need processing javasctipt named "add", not alert
    });
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T04:02:53.193

I suggest you use jquery 1.8.3 ([can download here](http://jquery.com/)), since version 1.4.2 is depreciated. This is how you should call the function:

JAVASCRIPT:

```
<script src="jquery-1.4.2.js"></script>
<script src="jquery.hotkeys.js"></script>
<script type="text/javascript">
//here you are declaring the function
function add(int) {
    if (window.XMLHttpRequest) {
        xmlhttp = new XMLHttpRequest();
    } else {
        xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange = function() {
        if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
            document.getElementById("add").innerHTML = xmlhttp.responseText;
        }
    }
    xmlhttp.open("GET", "method.php?a=" + int, true);
    xmlhttp.send();
} 

$(document).ready(function(){ 
//when you use jquery, 
//it is good practice to wait until the document is ready.
    $(document).bind('keydown', 'ctrl + k', function() {
    //the add function requires an argument, so make sure to provide one.
        add(1);
    });
});
</script> 
```

Hope this helps and let me know if you have any questions. Happy coding!

# c++ - 在 C++ GMP 中使用 ceil

> ID：13595107
> 
> 赞同：0
> 
> 时间：2012-11-27T23:28:38.647
> 
> 标签：c++, gmp

```
 L=ceil((sqrt(v-4*N)-1)/4)-1 
```

其中 V 和 N 是 mpz_class 变量。

出于某种原因，这会引发一个错误，打开 gmpxx.h 并且有问题

```
inline void __gmp_set_expr(mpz_ptr z, const __gmp_expr<mpz_t, T> &expr)
{
  expr.eval(z);
} 
```

我该如何正确地做这个天花板？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T06:35:55.770

我不熟悉 C++ 接口，但我认为 mpz_class 变量的 sqrt() 将返回 mpz_class 结果。将 ceil() 应用于整数是没有意义的。您将需要使用 mpf_class 从 sqrt() 获取浮点结果，然后 ceil() 应该可以工作（但返回一个 mpf_class）。

# r - 如何在循环中填充部分 URL

> ID：13595112
> 
> 赞同：0
> 
> 时间：2012-11-27T23:29:06.053
> 
> 标签：r

> **可能重复：**
> [将多个 CSV 文件读入单独的数据帧](https://stackoverflow.com/questions/5319839/read-multiple-csv-files-into-separate-data-frames)

如何用 for 循环填充部分 URL，我尝试了一个有效的 URL，例如：

```
data <- read.table("http://somelink.php?station=2&start=2012-01-01&etc", header=T,sep="|") 
```

但是当我将代码更改为循环时，它失败了：

```
station <- c(1:10)
Year <- format(Sys.time(), "%Y")

for (i in station){
data <- read.table("http://somelink.php?station=i&start=Year-01-01&etc", header=T,sep="|")
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T00:23:14.123

问题是您的迭代器`i`在引号内，因此没有按预期进行评估。采用`paste0(.)`

* * *

此外，您可能希望您的变量`data`类似于列表。而且也许不叫`data`。

```
myData <- list(length = length(station))
for (i in station){
  urli <- paste0("http://somelink.php?station=", i, "&start=Year-01-01&etc")
  myData[[i]] <- read.table(urli, header=T,sep="|")
} 
```

* * *

## 编辑（mnel）

或更惯用的说法

```
urls <-paste0("http://somelink.php?station=",station, "&start=", Year, "01-01&etc")
myData <- lapply(urls, read.table, header = TRUE, sep = '|') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T00:58:42.230

我偏爱这个`sprintf`函数，因为很容易看到最终字符串的样子：

```
station_data <- list()
for (i in station) {
  station_data[[i]] <- read.table(sprintf("http://somelink.php?station=%s&start=Year-01-01&etc", i), 
    header=TRUE, sep="|")
} 
```

# javascript - 如何遍历本地（服务器端）文件夹的所有元素？

> ID：13595113
> 
> 赞同：5
> 
> 时间：2012-11-27T23:29:10.010
> 
> 标签：javascript, html, file-io, directory

基本上，我有一个非常简单的网站，其根目录如下所示：

```
/images/
index.html
stuff.js 
```

我想要某种方法来递归遍历 /images/ 目录中的每个文件，并在我网站的一部分中按顺序显示它们。例如，如果 /images/ 包含：

```
images/a/a.png
images/b.png
images/c.jpg
.... 
```

那么 index.html 中的某处将包含：

```
<img src="images/a/a.png" />
<img src="images/b.png" />
<img src="images/c.jpg" />
.... 
```

我的第一个想法是使用 stuff.js 中的 document.write() 函数来执行此操作，但我找不到在 Javascript 中遍历本地文件目录的好方法。我看到了一些关于 AJAX 的东西，但是所有这些示例都涉及编辑现有文件，我显然不想这样做。

我目前的解决方案是手动创建一个包含 /images/ 中所有文件的字符串数组，但这样做让我觉得“必须有更好的方法！”

如果我不清楚，请告诉我。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T23:35:04.570

也许最好的方法是使用服务器端语言为您完成，并使用异步 Javascript 请求来显示数据。

此示例使用 PHP 列出指定目录中的所有文件，并`xmlhttprequest`加载此输出并将结果转换为图像标签：

* * *

**获取图像.php：**

```
<?php

    //The directory (relative to this file) that holds the images
    $dir = "Images";

    //This array will hold all the image addresses
    $result = array();

    //Get all the files in the specified directory
    $files = scandir($dir);

    foreach($files as $file) {

        switch(ltrim(strstr($file, '.'), '.')) {

            //If the file is an image, add it to the array
            case "jpg": case "jpeg":case "png":case "gif":

                $result[] = $dir . "/" . $file;

        }
    }

    //Convert the array into JSON
    $resultJson = json_encode($result);

    //Output the JSON object
    //This is what the AJAX request will see
    echo($resultJson);

?> 
```

* * *

**index.html（与 getimages.php 相同的目录）：**

```
<!DOCTYPE html>
<html>
    <head>
        <title>Image List Thing</title>
    </head>
    <body>

        <div id="images"></div>
        <input type="button" onclick="callForImages()" value="Load" />

        <script>

            //The div element that will contain the images
            var imageContainer = document.getElementById("images");

            //Makes an asynch request, loading the getimages.php file
            function callForImages() {

                //Create the request object
                var httpReq = (window.XMLHttpRequest)?new XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP");

                //When it loads,
                httpReq.onload = function() {

                    //Convert the result back into JSON
                    var result = JSON.parse(httpReq.responseText);

                    //Show the images
                    loadImages(result);
                }

                //Request the page
                try {
                    httpReq.open("GET", "getimages.php", true);
                    httpReq.send(null);
                } catch(e) {
                    console.log(e);
                }

            }

            //Generates the images and sticks them in the container
            function loadImages(images) {

                //For each image,
                for(var i = 0; i < images.length; i++) {

                    //Make a new image element, setting the source to the source in the array
                    var newImage = document.createElement("img");
                    newImage.setAttribute("src", images[i]);

                    //Add it to the container
                    imageContainer.appendChild(newImage);

                }

            }

            </script>

    </body>
</html> 
```

请注意，这只是一个示例。您可能希望确保 AJAX 调用成功，并且 JSON 转换在服务器代码和客户端都有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-02T07:16:22.113

我偶然发现了这篇文章，因为我正在寻找同样的东西，如何遍历“资源”文件夹中的文件列表，并显示一个网页，其中每个文件都有可点击的快捷方式。

这是我最终得到的网页剪辑：

![在此处输入图像描述](../Images/1a20e4e406d725e7ee0a8836b60f52ed.png)

这就是我的做法。

我添加了一个非常简单的 ASP.Net 服务，以遍历此文件夹中的文件...

```
List<OneResourceFile> listOfFilenames = new List<OneResourceFile>();

string Icon = "";
string localFolder = Server.MapPath("../Resources");
string[] fileEntries = Directory.GetFiles(localFolder);
foreach (string fileName in fileEntries)
{
    string filename = System.IO.Path.GetFileName(fileName);
    switch (Path.GetExtension(filename).ToLower())
    {
        case ".pptx":
        case ".ppt":
            Icon = "cssPowerPoint";
            break;
        case ".doc":
        case ".docx":
            Icon = "cssWord";
            break;
        case ".xlsx":
        case ".xlsm":
        case ".xls":
            Icon = "cssExcel";
            break;
        default:
            Icon = "cssUnknown";
            break;
    }
    OneResourceFile oneFile = new OneResourceFile()
    {
        Filename = filename,
        IconClass = Icon,
        URL = "../Resources/" + filename
    };
    listOfFilenames.Add(oneFile);
}

string JSON = JsonConvert.SerializeObject(listOfFilenames);
return JSON; 
```

..它建立了一个`OneResouceFile`记录列表，每个记录都有一个文件名、一个应用于该快捷方式的 CSS 类（例如，它会给它一个 Excel 图标、一个 PDF 图标等）和该项目的完整 URL。

```
public class OneResourceFile
{
    public string Filename { get; set; }
    public string IconClass { get; set; }
    public string URL { get; set; }
} 
```

..它返回了一组这样的JSON结果......

```
[
    {
        Filename: "Mikes Presentation.pptx",
        IconClass: "cssPowerPoint",
        URL: "~/Resources/Mikes Presentation.pptx"
    },
    {
        Filename: "Mikes Accounts.xlsx",
        IconClass: "cssExcel",
        URL: "~/Resources/Mikes Accounts.xlsx""
    }
] 
```

然后，我刚刚得到一些 JQuery 来调用这个 Web 服务，并`a href`为结果中的每个项目创建一个：

```
<script type="text/javascript">
    var URL = "/GetListOfResourceFiles.aspx";   //  This is my web service
    $.ajax({
        url: URL,
        type: 'GET',
        cache: false,
        dataType: "json",
        success: function (JSON) {
            // We've successfully loaded our JSON data
            $.each(JSON.Results, function (inx) {

                // Create one <a href> per JSON record, and append it to our list.
                var thelink = $('<a>', {
                    text: this.Filename,
                    title: this.Filename,
                    href: this.URL,
                    class: this.IconClass
                }).appendTo('#ListOfResources');
            });
        },
        error: function (xhr, ajaxOptions, thrownError) {
            alert("$.ajax error: " + xhr.status + " " + thrownError);
        }  
    });
</script>

<p id="ListOfResources"> 
```

然后，您需要为 、 等添加一些 CSS 样式`cssPowerPoint`，`cssExcel`以提供与`a href`sa 相关的图标，例如：

```
.cssPowerpoint
{
    vertical-align: top;
    text-align: center;
    background-repeat: no-repeat;
    background-position: center 5px;
    background-image: url(/Images/Icons/icnPowerPoint.png);
    width: 100px;
    height: 60px;
    padding-top: 60px;
    text-decoration: none;
    display:inline-block;
    color: #666;
    margin-left: 20px;
} 
```

就是这样。酷，嘿？

# python - 在 TextCtrl 中验证 URL - Python/wxPython

> ID：13595117
> 
> 赞同：0
> 
> 时间：2012-11-27T23:29:32.443
> 
> 标签：python, validation, wxpython, urllib, textctrl

我正在创建一个简单的应用程序，其中一部分我想从 TextCtrl 获取用户的输入并检查它是否是有效的 URL。我在没有 GUI 的情况下制作了这个程序并使用了以下代码：（我已将其更改为使用 wxPython 错误对话框，但在我刚刚打印出错误语句之前）

```
try:
    if url[:7] != 'http://':
        urllib.urlopen('http://' + url)
    else:
        urllib.urlopen(url)
except IOError:
    error = wx.MessageDialog(None, 'Please enter a valid URL!', 'URL Error', wx.OK | wx.ICON_ERROR)
    error.ShowModal() 
```

当我单击按钮运行此代码时，程序冻结并崩溃。我认为这是因为它中断了 GUI 的主循环。我想我可以尝试通过 if 语句验证 URL，但我正在寻找更有效的东西……可能是正则表达式（尽管我从未学过正则表达式）。

任何帮助将不胜感激。

编辑：这个问题已经解决了。我最终使用了 Django 使用的正则表达式：

```
def is_valid_url(url):
    import re
    regex = re.compile(
        r'^https?://'  # http:// or https://
        r'(?:(?:[A-Z0-9](?:[A-Z0-9-]{0,61}[A-Z0-9])?\.)+[A-Z]{2,6}\.?|'  # domain...
        r'localhost|'  # localhost...
        r'\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})' # ...or ip
        r'(?::\d+)?'  # optional port
        r'(?:/?|[/?]\S+)$', re.IGNORECASE)
    return url is not None and regex.search(url) 
```

虽然它并不完美，但它适用于我的情况。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T14:27:11.897

That should work, but if you want to go the regex route, see the following answer: [How do you validate a URL with a regular expression in Python?](https://stackoverflow.com/questions/827557/how-do-you-validate-a-url-with-a-regular-expression-in-python)

I think you could combine that information with a MaskedEditControl. The wxPython demo has lots of examples.

# python - 使用Python查找字符串中列表的出现次数

> ID：13595118
> 
> 赞同：2
> 
> 时间：2012-11-27T23:29:32.067
> 
> 标签：python, string, list

我有一个包含数千个短字符串的列表和一个包含数十万个短字符串的 .csv 文件。所有列表元素都是唯一的。对于 .csv 文件中的每个字符串，我需要检查它是否包含多个列表元素。

例如。我有一个字符串：

```
example_string = "mermaids have braids and tails" 
```

和一个清单：

```
example_list = ["me", "ve", "az"] 
```

显然，示例字符串包含多个列表项；我和我。我的代码需要指出这一点。但是，如果列表是

```
example_list = ["ai", "az", "nr"] 
```

仅包含一个列表元素。

我认为以下代码将检查我的 .csv 文件中的每一行是否包含至少一个列表元素。但是，这并不能告诉我它是否包含多个不同的列表元素。

```
data = file("my_file_of_strings.csv", "r").readlines()
for line in data:       
    if any(item in my_list for i in line):
        #Do something# 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:34:19.503

```
with open("my_file_of_strings.csv", "r") as data:
    for line in data:       
        if any(item in i for i in line.split() for item in my_list):
            ... 
```

如果您需要计算它们，请使用`sum()`

```
with open("my_file_of_strings.csv", "r") as data:
    for line in data:       
        result = sum(item in i for i in line.split() for item in my_list): 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T23:34:22.057

```
def contains_multiple(string, substrings):
    count = 0

    for substring in substrings:
        if substring in string:
            count += 1
            if count > 1:
                return True

    return False

for line in data:
    if contains_multiple(line, my_list):
        ... 
```

不短，但一旦找到第二场比赛，它就会提前退出。这可能是也可能不是重要的优化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T23:57:19.920

我认为其他解决方案更适合您的目的，但如果您想跟踪点击次数以及点击次数，您可以试试这个：

```
In [14]: from collections import defaultdict

In [15]: example_list = ["me", "ve", "az"]

In [16]: example_string = "mermaids have braids and tails"

In [17]: d = defaultdict(int)

In [18]: for i in example_list:
   ....:     d[i] += example_string.count(i)
   ....:

In [19]: d
Out[19]: defaultdict(<type 'int'>, {'me': 1, 'az': 0, 've': 1}) 
```

然后得到唯一匹配的总数：

```
In [20]: matches = sum(1 for v in d.values() if v)

In [21]: matches
Out[21]: 2 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T23:35:23.150

就像是：

```
data = file("my_file_of_strings.csv", "r").readlines()
for line in data:       
    if len(set(item for item in my_list if item in line)) > 1:
        #Do something# 
```

# rspec - Capybara 为什么不会在选择菜单中选择正确的项目？

> ID：13595121
> 
> 赞同：1
> 
> 时间：2012-11-27T23:29:46.543
> 
> 标签：rspec, capybara

当 you 时`save_and_open_page`，您可以看到我的表单包含：

```
<label class="select optional control-label" for="assignment_role_id">Role</label>
  <select class="select optional" id="assignment_role_id" name="assignment[role_id]">
    <option value="819">admin</option>
    <option value="820">customer</option>
</select> 
```

那么，为什么 Capybara 不会在下拉菜单中选择正确的项目呢？我得到：

```
Failure/Error: select("customer", :from => :Role)
     Capybara::ElementNotFound:
       cannot select option, no option with text 'customer' in select box 'Role' 
```

...和...

```
Failure/Error: select("customer", :from => :assignment_role_id)
     Capybara::ElementNotFound:
       cannot select option, no option with text 'customer' in select box 'assignment_role_id' 
```

...和...

```
Failure/Error: select("customer", :from => :role_id)
     Capybara::ElementNotFound:
       cannot select option, no option with text 'customer' in select box 'role_id' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T23:47:58.440

解决方案是：

```
select("customer", :from => "assignment[role_id]") 
```

# asp-classic - Mailchimp 经典 ASP 端点错误

> ID：13595122
> 
> 赞同：0
> 
> 时间：2012-11-27T23:29:55.187
> 
> 标签：asp-classic, mailchimp

我正在使用此处说明的方法：

[http://apidocs.mailchimp.com/api/downloads/serialized_xml_listsubscribe.asps](http://apidocs.mailchimp.com/api/downloads/serialized_xml_listsubscribe.asps)

我正在使用正确的 API 密钥和 ListID - 但是，在运行脚本时，我收到以下响应：

**“您必须为 listSubscribe 方法指定 email_address 值 -90”**

我已经搜索并邮寄了他们的支持，但还没有回复。有没有人遇到过类似的问题 - 有什么想法缺少参数吗？

干杯。

下面是 Mailchimp 示例中的代码：

```
Dim email
Dim apikey
Dim listId
Dim resp

email = Trim(Request.Form("Email"))
list_id = "xxxxxx"
apikey = "zzzzzzzzzzzzzzzzzzzzzz"

Dim xmlhttp
Set xmlhttp = Server.Createobject("MSXML2.ServerXMLHTTP")
xmlhttp.Open "GET","http://<my-dc>.api.mailchimp.com/1.3/?method=listSubscribe&output=xml&apikey=" & apikey & "&id=" & list_id & "&email=" & Server.URLEncode(email) & "&merge_vars=",false
xmlhttp.send
resp = xmlhttp.responsetext
Set xmlhttp = Nothing 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T06:47:05.230

尝试`email_address`代替`email`

```
xmlhttp.Open "GET","http://<my-dc>.api.mailchimp.com/1.3/?method=listSubscribe&output=xml&apikey=" & apikey & "&id=" & list_id & "&email_address=" & Server.URLEncode(email) & "&merge_vars=",false 
```

# java - 如何将面板/框架保存到文件中然后读取它？

> ID：13595123
> 
> 赞同：0
> 
> 时间：2012-11-27T23:29:55.973
> 
> 标签：java, file, serialization, panel

这是我的问题：

我正在构建 2 个应用程序：

1.  一个是“编辑器”，我会放置一些面板、按钮、文本区域等。
2.  第二个是“应用程序”，我可以在其中与这些组件进行交互

我在想是否可以将编辑器的主面板（其中包含其他组件）保存到`File`using 中`FileOutputStream`，然后在其他应用程序上读取它。

我试过了。现在我有一个包含很多字节的文件，但是我将如何读取它并将其重新构建到组件中？

我不确定如何执行此操作，也找不到正确的术语来进行搜索。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:34:02.307

您正在寻找的术语称为[序列化](http://docs.oracle.com/javase/7/docs/platform/serialization/spec/serialTOC.html)。这是一个[使用 Java Swing 的示例](http://java-demos.blogspot.com/2012/10/store-jframe-size-location-using-serialization.html)。

# php - 使用 Jquery submithandler 提交表单

> ID：13595124
> 
> 赞同：1
> 
> 时间：2012-11-27T23:29:58.477
> 
> 标签：php, ajax

我可以让 Ajax 成功发送请求，但我希望它也重定向到新页面并且它没有重定向。任何人都可以建议一种替代方法或正确的重定向方式吗？

```
submitHandler: function(form) {
    $("div.error").hide();
    $.ajax({
        type: "POST",
        url: '<?php echo base_url().'subscribe/process_payment/'?>',
        data: $(form).serialize(),
        success: function(msg){
            console.log( "Data Saved: " + msg );

        },          

        error: function(msg){
            console.log( "Error: " + msg);
        } 
    });
    return true;
        }, 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:34:02.360

通常你可以简单地在成功函数中进行重定向

```
success: function(msg){
        console.log( "Data Saved: " + msg );
        window.location = "mysite.com/newURL";
}, 
```

或返回网址

```
success: function(url){
        window.location = url;
}, 
```

# java - Java RMI 同步

> ID：13595125
> 
> 赞同：0
> 
> 时间：2012-11-27T23:30:04.003
> 
> 标签：java, synchronization, rmi

我知道下面的代码的各个部分都丢失了，我的问题是关于 RemoteImplemntation 中的同步机制。我也了解这个网站和其他关于 RMI 和同步的问题；在这里，我正在寻找明确的确认/矛盾。

我的问题是：当我有多个客户端同时运行时，这是一种同步调用 add 方法的合理方法吗？即，假设所有的 id 都不同，那么在 20 个客户端在同时启动的不同机器上完成执行后，树集的大小会是 20,000 吗？

```
public interface RemoteInterface extends Remote {
    void add(String id) throws RemoteException;
}

public class RemoteImplemenation implements RemoteInterface{    
    TreeSet<String> ids = new TreeSet<String>();
    final Object lock = new Object();
    public void add(String id) {
        synchronized(lock) {
            ids.add(id);
        }
    }
}

public class Client {
    public static void main(String[] args) {
        RemoteInterface remote = (RemoteInterface)Naming.lookup(...);
        for (int i=0;i<1000;i++) {
            remote.add(ipaddress+"_"+i);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:36:20.733

`synchronized`关键字将使显示的服务器代码以线程安全的方式执行，因此`ids`将包含 20000 个项目（除非输入中有重复项，尽管这不太可能）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T01:19:58.397

那可行。您实际上并不需要锁定对象，您可以直接在`ids`.

# php - PHP，交通捕手

> ID：13595126
> 
> 赞同：0
> 
> 时间：2012-11-27T23:30:09.540
> 
> 标签：php, html, css, traffic

我正在启动一个图片托管网站，该网站还提供按次付费的服务，例如上传一张图片，它会获得 1000 次浏览，您可以获得 2.00 美元的费用。我唯一的问题是我希望能够查看每个图像的流量以及用于查看图像的 IP 地址。

因此，有人访问我的网站，他们使用文件表单输入字段上传图像，然后返回一个链接，例如 - domain.com/image.png 我可以在我的代码中添加什么，以便为每个上传的新图像添加某种跟踪.

我会很感激我得到的任何想法！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:34:29.420

简而言之，您可以提供指向您制作的 php 脚本的链接，如下所示：

```
domain.com/image.php?file=image.png 
```

在您的 image.php 脚本中，您应该使用 $_SERVER 环境变量跟踪 IP，将命中保存在您的数据库中，最后重定向到图像：

```
header ("Location: " . $_REQUEST['file'] ): 
```

这是一种策略。还有很多其他方法可以解决这个问题（也许比这个更好）。刚开始工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:35:21.070

您可以配置一个*.htaccess*文件，这样您就可以捕获所有请求并对其进行管理。

1.  捕获所有图像请求
2.  确定要显示的图像
3.  增加关于该图像的数据
4.  显示图像

或者您基本上可以创建一个**show.php**文件。并给你的用户**show.php?id=IMAGEID**。现在您可以跟踪有关该图像的所有数据。

# ios - systemSound 不再适用于使用 ARC 升级的 Xcode 4.5.2

> ID：13595130
> 
> 赞同：0
> 
> 时间：2012-11-27T23:30:24.660
> 
> 标签：ios, xcode

对于播放快速声音，我更喜欢 SystemSound 而不是 AudioPlayer，因为加载时间更快。但是现在我已经升级到 Xcode 4.5.2 并且使用 ARC 我的代码播放音频片段不再有效。请参阅下面的完整代码。我得到的错误来自以下行： AudioServicesCreateSystemSoundID((CFURLRef)filePath, &soundID); 我收到带有以下错误消息的红色错误：Cast of Objective type NSURL to C pointer type CFURL (aka const dtruct)。有什么想法可以替换这条线吗？？

```
NSString *path = [NSString stringWithFormat:@"%@%@", [[NSBundle mainBundle] resourcePath],   @"/click.mp3"];

SystemSoundID soundID;

NSURL *filePath = [NSURL fileURLWithPath:path isDirectory:NO];

// here is the problem line 
     AudioServicesCreateSystemSoundID((CFURLRef)filePath, &soundID);

AudioServicesPlaySystemSound(soundID); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:37:16.100

使用 ARC，您需要使用 __bridge 在 Foundation 和 Core Foundation 之间进行免费桥接。

试试这个：

```
CFURLRef url = (__bridge CFURLRef)filePath;
AudioServicesCreateSystemSoundID(url, &soundID); 
```

# ruby-on-rails - 在创建用户时分配默认权限

> ID：13595131
> 
> 赞同：0
> 
> 时间：2012-11-27T23:30:38.143
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise, cancan

我正在使用 devise 和 cancan 进行用户身份验证和权限。我只需要为任何新用户创建一组默认权限。我不想弄乱设计代码，所以它应该在我的用户模型中。最好的方法是什么。

好的，这是我在模型中尝试的：

```
before_create :setup_permissions

    def setup_permissions 
    permissions = []
        @roles = Role.where('subject_id is null and permissions = ?', 'Read')
            @roles.each do |role|
            permissions << {:role_id => role.id}
            end
        self.role_assignments_attributes = permissions  
    end 
```

但是上面的代码给出了一个错误。

有趣的是，我在控制台中逐行运行代码以从上面构建权限。它产生正确的数组，如下所示。

```
permissions =  [{:role_id=>15}, {:role_id=>17}, {:role_id=>19}, {:role_id=>21}, {:role_id=>23}, {:role_id=>25}, {:role_id=>27}] 
```

当我将权限数组直接粘贴到模型中而不是构建它时，它可以工作，如下所示：

```
def setup_permissions 
permissions =  [{:role_id=>15}, {:role_id=>17}, {:role_id=>19}, {:role_id=>21}, {:role_id=>23}, {:role_id=>25}, {:role_id=>27}]

    @roles = Role.where('subject_id is null and permissions = ?', 'Read')
        @roles.each do |role|
        permissions << {:role_id => role.id}
        end
    self.role_assignments_attributes = permissions  
   end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:34:47.393

`after_create`为您的用户模型添加一个钩子。

```
after_create :setup_permissions

def setup_permissions
  #Do what you need to do here
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T02:19:21.940

我通过在 Model.where() 末尾添加 .to_a 将其转换为数组来使其工作。当您使用 Model.where() 子句而不是在 Model.find(id) 的情况下使用 Array 时，Rails 返回一个 ActiveRecord::Relationship。这应该在这两种情况下更正并使其相似。

```
before_create :setup_permissions
    def setup_permissions 
    permissions = []
        @roles = Role.where('subject_id is null and permissions = ?', 'Read').to_a
            @roles.each do |role|
            permissions << {:role_id => role.id}
            end         
       end 
```

# c++ - 在多文件项目中调用基类构造函数

> ID：13595137
> 
> 赞同：0
> 
> 时间：2012-11-27T23:31:22.720
> 
> 标签：c++, oop

如何使用多文件程序从派生类中的基类调用构造函数。

IE：我如何将其拆分为一个有四个文件的结构。Person.h、Person.cpp、Student.h 和 Student.cpp。

```
class Person
{
protected:
    string name;
public:
    Person() { setName(""); }
    Person(string pName) { setName(pName); }
    void setName(string pName) { name = pName; }
    string getName() { return name; }
};
class Student:public Person
{
private:
    Discipline major;
    Person *advisor;
public:
    Student(string sname, Discipline d, Person *adv)
    : Person(sname)
    {
        major = d;
        advisor = adv;
    }
    void setMajor(Discipline d) { major = d; }
    Discipline getMajor() { return major; }
    void setAdvisor(Person *p) { advisor = p; }
    Person *getAdvisor() { return advisor; }
}; 
```

我希望它看起来像这样：Person.h

```
class Person
{
protected:
    string name;
public:
    Person(); 
    Person(string);
    void setName(string)
    string getName()
}; 
```

个人.cpp

```
#include "Person.h"
Person::Person() { setName(""); }
Person::Person(string pName) { setName(pName); }
void Person::setName(string pName) { name = pName; }
string Person::getName() { return name; } 
```

学生.h

```
class Student:public Person
{
private:
    Discipline major;
    Person *advisor;
public:
    Student(string, Discipline, Person)//call Base class constructor here or .cpp?

    void setMajor(Discipline d) ;
    Discipline getMajor() ;
    void setAdvisor(Person *p) ;
    Person *getAdvisor() ;
}; 
```

学生.cpp

```
#include "Student.h"
#include "Person.h"
Student::Student(string sname, Discipline d, Person *adv)//Call Base class construcotr
{
    major = d;
    advisor = adv;
}
void Student::setMajor(Discipline d) { major = d; }
Discipline Student::getMajor() { return major; }
void Student::setAdvisor(Person *p) { advisor = p; }
Person* Student::getAdvisor() { return advisor; }
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:40:16.840

`constructor`定义时在 Student.cpp 中调用您的基础`Student::Student()`

```
Student::Student(string sname, Discipline d, Person *adv)//Call Base class construcotr
: Person(sname)  // <<<<< here
{
    major = d;
    advisor = adv;
} 
```

# java - G722 Java 或 C++ 实施

> ID：13595138
> 
> 赞同：-1
> 
> 时间：2012-11-27T23:31:26.153
> 
> 标签：java, c++

我正在开发一个 VoIP 应用程序，并且需要知道 G722 语音编解码器是否有任何开源实现。？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:36:42.777

我相信 Linform 是非常跨平台的：

*   [http://www.linphone.org/](http://www.linphone.org/)

您可能还想查看 OPAL：

*   [http://www.opalvoip.org/](http://www.opalvoip.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-22T20:57:41.047

使用**jitsi**开源网络电话的g722实现，主要基于**spanDSP**（C/C++），jitsi使用JNI调用本机代码。

libjitsi JNI：[https](https://github.com/jitsi/libjitsi/tree/master/src/net/java/sip/communicator/impl/neomedia/codec/audio/g722)
://github.com/jitsi/libjitsi/tree/master/src/net/java/sip/communicator/impl/neomedia/codec/audio/g722 从 JNI 调用的本机代码：[https://github。 com/jitsi/libjitsi/tree/master/src/native/g722](https://github.com/jitsi/libjitsi/tree/master/src/native/g722)

有 2 个类：
**JNIDecoder.java**：从 g722 字节缓冲区解码原始 PCM 数据
**JNIEncoder.java**：将原始 PCM 数据编码到 g722 字节缓冲区

# css - CSS 3 PIE：悬停不工作

> ID：13595141
> 
> 赞同：0
> 
> 时间：2012-11-27T23:31:48.430
> 
> 标签：css, css3pie

IE 不显示圆角。如果我拿出来就可以了`:hover`。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
        <title>Untitled Document</title>
        <style type="text/css">
            .tooltip {
                position:absolute;
                text-decoration: none;
                display:inline-block;
            }
            .tooltip span {
                margin-left:-999em;             
            }
            .tooltip:hover span {
                background-color: black;
                border-radius: 5px;
                -moz-border-radius: 5px;
                -webkit-border-radius: 5px;
                color: #fff;
                display: inline-block;
                position: relative;
                left: 30px;
                padding: 10px;
                top:0px;
                z-index:1;
                behavior:url(PIE.htc);
                margin-left:0;
            }
        </style>
    </head>
    <body>
        <label>This is a label
            <a href="#" class="tooltip">
                <img src="img/help.jpg" style="border:1px solid black;width:15px;height:15px;position:absolute;left:5px;top:5px;"/>
                <span>This is a test</span>
            </a>
        </label>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-25T14:48:02.060

您必须设置跨度以观察悬停元素（在您的情况下为“工具提示”元素）的行为变化。通过添加以下内容来设置跨度以观察“工具提示”行为变化：

```
.tooltip span {
    -pie-watch-ancestors: 1;
} 
```

'1' 表示与圆角边框元素相关的祖先级别。

更多信息在这里： [http ://css3pie.com/documentation/supported-css3-features/#pie-watch-ancestors](http://css3pie.com/documentation/supported-css3-features/#pie-watch-ancestors)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-14T08:47:06.593

*是的，您可以这样做，但您必须将行为声明放在不包含 :hover 选择器的样式规则中。您可以将其余样式保留在 :hover 块中。*[在悬停问题上](http://css3pie.com/forum/viewtopic.php?f=3&t=329) 关注此IE

试着把你的*行为：url(PIE.htc);* 在 .tooltip{} 中。它对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T13:41:27.637

尝试将行为应用于没有 :hover 伪类的元素：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
        <title>Untitled Document</title>
        <style type="text/css">
            .tooltip {
                position:absolute;
                text-decoration: none;
                display:inline-block;
            }
            .tooltip span {
                margin-left:-999em;
                behavior:url(PIE.htc);          
            }
            .tooltip:hover span {
                background-color: black;
                border-radius: 5px;
                -moz-border-radius: 5px;
                -webkit-border-radius: 5px;
                color: #fff;
                display: inline-block;
                position: relative;
                left: 30px;
                padding: 10px;
                top:0px;
                z-index:1;
                margin-left:0;
            }
        </style>
    </head>
    <body>
        <label>This is a label
            <a href="#" class="tooltip">
                <img src="img/help.jpg" style="border:1px solid black;width:15px;height:15px;position:absolute;left:5px;top:5px;"/>
                <span>This is a test</span>
            </a>
        </label>
    </body>
</html> 
```

而且您应该隐藏具有负边距的元素：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
        <title>Untitled Document</title>
        <style type="text/css">
            .tooltip {
                position:absolute;
                text-decoration: none;
                display:inline-block;
            }
            .tooltip span {
                left: 30px;
                top:0px;
                background-color: black;
                color: #fff;
                padding: 10px;
                display: none;
                border-radius: 5px;
                -moz-border-radius: 5px;
                -webkit-border-radius: 5px;
                behavior:url(PIE.htc);     
                z-index:1;
                position: relative;
            }
            .tooltip:hover span {
                display: inline-block;
            }
        </style>
    </head>
    <body>
        <label>This is a label
            <a href="#" class="tooltip">
                <img src="img/help.jpg" style="border:1px solid black;width:15px;height:15px;position:absolute;left:5px;top:5px;"/>
                <span>This is a test</span>
            </a>
        </label>
    </body>
</html> 
```

# r - 覆盖另一个包继承的包函数

> ID：13595145
> 
> 赞同：5
> 
> 时间：2012-11-27T23:32:19.733
> 
> 标签：r, namespaces, packages, knitr

我正在尝试覆盖包的`tidy.source`功能`knitr`。问题是`tidy.source`在包中定义的`formatR`，它是由包导入的`knitr`。如果我运行：

`get("tidy.source", envir=asNamespace("knitr"))`

我得到了原始代码。所以我很想覆盖`tidy.source`：

`assignInNamespace ("tidy.source", function()print("My tidy.source"), "knitr")`,

但我得到：

`Error in bindingIsLocked(x, ns) : no binding for "tidy.source"`.

实际上`tidy.source`是在 中定义`formatR`和继承的`knitr`。和：

`assignInNamespace ("tidy.source", function()print("My tidy.source"), "formatR")`

一切看似顺利，但再次检查`get("tidy.source", envir=asNamespace("knitr"))`表明内部`knitr`没有任何变化。

有什么帮助吗？

### 编辑：

由于*knitr/formatR*的新开发版本，此问题部分已过时。非常感谢 Yihui 注意到这个讨论并决定更新他的包。看：

[https://github.com/yihui/formatR/commit/6f70360f359caa8d2bb33190a1c89530defb0e98](https://github.com/yihui/formatR/commit/6f70360f359caa8d2bb33190a1c89530defb0e98)

我绝对可以从*Sweave*切换到*knitr*。

关于覆盖导入包函数的一般问题仍然悬而未决。由于它不再与*knitr/formatR*包相关，我用更笼统的术语重申它。

假设您有一个包*main*导入包*imp*。如果加载前者，`"package:main"`则显示在附加包列表中，`"main"`并`"sub"`显示在加载的名称空间的名称中。

假设*main*导入导出的*子函数*exp.sub.func ，它依次调用未*导出**的**子函数*prv.sub.func 。如果您想使用 exp.sub.func.mod 更改/自定义*exp.sub.func* *，*您可能会考虑使用：

 ***```
assign("exp.sub.func", exp.sub.func.mod, asNamespace ("sub")) 
```

结果，通过运行，`sub::exp.sub.func`您将获得修补后的版本（即*exp.sub.func.mod*）。
不幸的是，就您的*exp.sub.func.mod*继续依赖*prv.sub.func 而言*，您会收到错误消息：

```
Error in [...] : object 'prv.sub.func' not found 
```

实际上：

```
environment(sub::exp.sub.func) 
```

现在返回：`<environment: R_GlobalEnv>`在`<environment: namespace:sub>`修补之前。

问题是：*如何将修补的函数移动到正确的命名空间*？

要解决上述问题，您当然可以使用任何软件包；在我的例子中，我使用*knitr*和*formatR*作为主要和导入的命名空间和*tidy.source()*作为修补函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T02:01:07.073

更改**formatR**命名空间中的函数不会更改**knitr**使用的内容，因为**knitr**已经加载。因此，您可以卸载并重新加载它。

```
assignInNamespace("tidy.source", function()print("My tidy.source"), "formatR")
detach('package:knitr', unload=TRUE)
library(knitr)
get("tidy.source", envir=asNamespace("knitr"))
#function()print("My tidy.source") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-30T21:47:37.280

如果你想要的只是函数参数后的注释，我已经在[开发版中](https://github.com/yihui/formatR/)[添加](https://github.com/yihui/formatR/commit/6f70360f359)了支持，你可以[从 Github 安装它](http://yihui.name/formatR/)。

`assignInNamespace()`如其文档所示，通常使用 修改包是一个坏主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T13:53:37.017

这是一个可能的错误尝试，允许在*formatR*包`tidy.source`中包含的函数的函数参数之后进行内联注释。

 *```
## ============ Possible (wrong?) ideas on inline comments ============

  tidy.source.mod=  function (source = "clipboard", keep.comment = getOption("keep.comment",
    TRUE), keep.blank.line = getOption("keep.blank.line", TRUE),
    keep.space = getOption("keep.space", FALSE), replace.assign = getOption("replace.assign",
        FALSE), left.brace.newline = getOption("left.brace.newline",
        FALSE), reindent.spaces = getOption("reindent.spaces",
        4), output = TRUE, text = NULL, width.cutoff = getOption("width"),
    ...)
{     
    if (is.null(text)) {
        if (source == "clipboard" && Sys.info()["sysname"] ==
            "Darwin") {
            source = pipe("pbpaste")
        }
        text = readLines(source, warn = FALSE)
    } 
    if (length(text) == 0L || all(grepl("^\\s*$", text))) {
        if (output)
            cat("\n", ...)
        return(list(text.tidy = "", text.mask = ""))
    } 
    text.lines = text
    if (keep.comment) {
        if (!keep.space)
            text.lines = gsub("^[[:space:]]+|[[:space:]]+$",
                "", text.lines)
        head.comment = grepl("^[[:space:]]*#", text.lines)
        if (any(head.comment)) {
            text.lines[head.comment] = gsub("\"", "'", text.lines[head.comment])
        }
        if (!keep.space) {
            head.comment = head.comment & !grepl("^\\s*#+'",
                text.lines)
            text.lines = reflow_comments(text.lines, head.comment,
                width.cutoff)
            head.comment = grepl("^[[:space:]]*#", text.lines)
        }
        text.lines[head.comment] = sprintf("invisible(\"%s%s%s\")",
            begin.comment, text.lines[head.comment], end.comment)
        blank.line = grepl("^[[:space:]]*$", text.lines)
        if (any(blank.line) && keep.blank.line) {
            else.line = grep("^[[:space:]]*else(\\W|)", text.lines)
            for (i in else.line) {
                j = i - 1
                while (blank.line[j]) {
                  blank.line[j] = FALSE
                  j = j - 1
                  warning("removed blank line ", j, " (you should not put an 'else' in a separate line!)")
                }
            }
            text.lines[blank.line] = sprintf("invisible(\"%s%s\")",
                begin.comment, end.comment)
        }
        text.lines = mask_inline(text.lines)
    } 
    #modified code
    ic=grepl( "%InLiNe_IdEnTiFiEr%", text.lines)
    text.lines[ic]=substr(text.lines[ic], 1, nchar(text.lines[ic])-1)
    text.lines[ic]=  paste0(text.lines[ic], "%InLiNe_IdEnTiFiEr_mod%\"")
    #end modified code
    text.mask = tidy_block(text.lines, width.cutoff, replace.assign)
    text.tidy = if (keep.comment)
        unmask.source(text.mask)
    else text.mask
    text.tidy = reindent_lines(text.tidy, reindent.spaces)
    if (left.brace.newline)
        text.tidy = move_leftbrace(text.tidy, reindent.spaces)
    #modified code
    text.tidy= unlist(sapply(text.tidy, strsplit, "%InLiNe_IdEnTiFiEr_mod%", USE.NAMES=FALSE))
    #end modified code
    if (output)
        cat(paste(text.tidy, collapse = "\n"), "\n", ...)
    invisible(list(text.tidy = text.tidy, text.mask = text.mask))
}     
## ====================================================

## ============ Implementation ============

## Clean-up
if("formatR" %in% loadedNamespaces() ) detach('package:formatR', unload=TRUE)
if(exists("tidy.source"))rm(tidy.source)
library("formatR")

## String with inline comments after arguments
text.input="paste(1 # comm
   ,7)
"     
## The same in vector format
text.input=strsplit(text.input, "\n")[[1]]

## Implementation without patch
tidy.source(text=text.input) #newline removed with  wrong result!
# paste(1  # comm, 7) 

# Tentative patch
unlockBinding("tidy.source", as.environment("package:formatR") )
assign("tidy.source", tidy.source.mod, pos="package:formatR")
environment(tidy.source)= asNamespace( "formatR" )

## Implementation with patch
tidy.source(text=text.input) # apparently ok:
# paste(1  # comm
# , 7) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-30T03:16:41.753

我可能*接近*解决方案，但我必须处理非导出的*formatR*函数。事实上，原始的*tidy.source*代码以及补丁版本调用了非导出的包函数，例如`reflow_comments`.

为了说明问题和我遵循的步骤，让我们从一个测试补丁的*tidy.source*开始，它调用一个私有 *formatR*函数。

```
### Listing 1 - Modified tidy.source             

tidy.source.mod=function (source, output, text){ 
  #Print body first line of reflow_comments      
  head(reflow_comments,1)                        
} 
```

`source, output, text` 参数是必需的，因为前面使用的*knit*传递。

现在我可以用*tidy.source.mod修补**tidy.source*：

 *```
### Listing 2 - Patch tidy.source                       

## General clean up                                     
if("knitr" %in% loadedNamespaces() ) detach('package:knitr', unload=TRUE)
if("formatR" %in% loadedNamespaces() ) detach('package:formatR', unload=TRUE)
if(exists("tidy.source"))rm(tidy.source)                
library("formatR")                                      

## Info                                                 
environment(tidy.source )                               
# <environment: namespace:formatR>                      
environment(formatR::tidy.source )                      
# <environment: namespace:formatR>                      

## Change tidy.source with tidy.source.mod              
unlockBinding("tidy.source", env=as.environment("package:formatR"))
assign("tidy.source", tidy.source.mod, envir=as.environment("package:formatR"))
lockBinding("tidy.source", env=as.environment("package:formatR"))
unlockBinding("tidy.source", env=asNamespace ("formatR"))
assign("tidy.source", tidy.source.mod, asNamespace ("formatR") )
environment(tidy.source)= asNamespace( "formatR" )      
lockBinding("tidy.source", env=asNamespace ("formatR")) 
```

我们可以检查结果：

```
### Listing 3 - Check results                                                  

getAnywhere(tidy.source)                                                       
# A single object matching 'tidy.source' was found                             
# It was found in the following places                                         
#   .GlobalEnv                                                                 
#   package:formatR                                                            
#   namespace:formatR                                                          
# with value                                                                   

# function (){                                                                 
#   head(reflow_comments,1)                                                    
# }                                                                            
# <environment: namespace:formatR>                                             

tidy.source()                                                                  
# 1 function (text, idx = grepl("^\\\\s*#+", text), width = getOption("width")) 
```

显然*tidy.source*已正确替换为*tidy.source.mod*；命名空间已更新，因此*tidy.source*可以访问（第一行）非导出 `reflow_comments`函数。

为了处理*knitr*，我们还需要一个文件来编织，为了简单起见，这里我使用了一个文本字符串。

```
### Listing 4 - Sample file/text to knit

library("knitr") 

text="           
\\documentclass{article}
\\begin{document}

<<comme, include=TRUE>>=
print('hello')   
@                

\\end{document}  
" 
```

*knitr*是否能够看到修补的*tidy.source*？*我们可以在 R debug*的帮助下进行检查。

```
debug(knit)                                   
knit(text=text) #will enter debug session (prompt s'd be like 'Browse[2]>')
# debugging in: knit(text = text)             
# debug: {                                    
# knit body, very long, omitted               
# }                                           
tidy.source #command given inside the debug session
# function (){                                
#   head(reflow_comments,1)                   
# }                                           
tidy.source() # :-( reflow_comments is not accessible
Q  #quit debug session                        

undebug(knit) 
```

不幸的是，从*knit*中可以看到修补的*tidy.source*，但它无法访问未导出的*formatR*函数，这对于*knit*通常可以通过未修补的*tidy.source 进行*。

这里的一些提示可能也`formatR::tidy.source()`不起作用：

```
formatR::tidy.source()
# Error in head(reflow_comments, 1) (from #2) : object 'reflow_comments' not found 
```

*namespace:formatR*的环境是：

```
environment(formatR::tidy.source )
# <environment: R_GlobalEnv> 
```

那是`<environment: namespace:formatR>`在打补丁之前（参见清单 2 中的信息）。虽然`environment(tidy.source )`在修补时很容易重置，但对于*namespace:formatR*我们得到一个错误：

```
environment(formatR::tidy.source )=asNamespace( "formatR" )
# Error in environment(formatR::tidy.source) = asNamespace("formatR") :
#  object 'formatR' not found 
```

我还在寻找......*****

# javascript - 正则表达式替换链接

> ID：13595146
> 
> 赞同：0
> 
> 时间：2012-11-27T23:32:25.713
> 
> 标签：javascript, regex

嗨，我有很好的旧替换纯 url 来链接问题。我正在使用 Jeff Roberson 的代码中的 linkify，但由于它不支持伪 url（www.），所以我试图用我找到的另一个正则表达式添加它。到目前为止，我坚持这个

```
 var replacePattern2 = /(^|[^\/])(www\.[\S]+(\b|$))/gim;
  text.replace(pseudoUrlPattern, '$1<a target="_blank" href="http://$2">$2</a>') 
```

文本可以是一个 html 标签，当链接有一个没有任何空格的关闭 p 标签时，它似乎包含在链接中！我试过向前看，但似乎我没有做对。一个示例文本是

```
 <p>www.something.here/something</p> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:01:12.700

像这样的东西怎么样：

```
var text = "<p>www.something.here/something</p>";
var replacePattern2 = /(.*?)(((([A-Za-z]{3,9}:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+))((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[\w]*))?)/gim;
text.replace(replacePattern2, '$1<a target="_blank" href="$4">$4</a>') 
```

基于这个正则表达式：[http](http://blog.mattheworiordan.com/post/13174566389/url-regular-expression-for-links-with-or-without-the) ://blog.mattheworiordan.com/post/13174566389/url-regular-expression-for-links-with-or-without-the 。

# django - 如何在 Django 中 order_by 泛型关系？

> ID：13595147
> 
> 赞同：3
> 
> 时间：2012-11-27T23:32:25.830
> 
> 标签：django, django-contenttypes

我基本上试图做与这个问题中描述的相反的事情：[Django: filtering order_by a generic relationship](https://stackoverflow.com/questions/10737546/django-filtering-order-by-a-generic-relation)

```
class Translation(models.Model):
    content_type = models.ForeignKey(ContentType)
    object_id = models.PositiveIntegerField()
    object = generic.GenericForeignKey('content_type', 'object_id')
    field = models.CharField(max_length=64) #field from the translated model
    language = models.CharField(max_length=8, choices=settings.LANGUAGES, verbose_name=_("language"))
    text = models.TextField() #translation

class Category(models.Model):
    translations = generic.GenericRelation(Translation)
    name = models.CharField(max_length=128, verbose_name=_("Name"))
    slug = models.SlugField(blank=True, default="", verbose_name=_("Slug")) 
```

我想检索所有翻译并按类别名称排序。像这样的东西：

```
Translation.objects.all().order_by('object__name') 
```

但这不起作用，因为`object`它不是数据库中的列。尝试订购`content_type__name`也不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:32:39.237

[这篇文章](https://stackoverflow.com/questions/3967574/django-order-by-generic-foreign-key)问了一个相同的问题，但发现这根本不可能。不幸的是，您似乎需要`raw()`手动构造 SQL 查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-29T22:44:02.843

在类别中，您需要创建一个相关的查询名称，例如...

```
class Category(models.Model):
    translations = generic.GenericRelation(Translation, related_query_name='category')
    name = models.CharField(max_length=128, verbose_name=_("Name"))
    slug = models.SlugField(blank=True, default="", verbose_name=_("Slug")) 
```

然后你可以进行如下查询 `Translation.objects.all().order_by('category__name')`

# magento - Magento 管理员添加/编辑评论 -> 删除评论字段的摘要需要验证

> ID：13595149
> 
> 赞同：0
> 
> 时间：2012-11-27T23:32:37.793
> 
> 标签：magento, magento-1.6

如何在管理面板中删除审核摘要字段的必填项？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T23:32:37.793

复制

```
/app/code/core/Mage/Adminhtml/Block/Review/Edit/Form.php 
```

至

```
/app/code/local/Mage/Adminhtml/Block/Review/Edit/Form.php 
```

并更改（第 125 或 131 行）

```
'required'  => true, 
```

至

```
'required'  => false, 
```

并刷新缓存！

# c++ - c++ 函数重载、表达式模板和命名空间

> ID：13595152
> 
> 赞同：0
> 
> 时间：2012-11-27T23:32:40.533
> 
> 标签：c++, namespaces, overloading, expression-templates

我正在开发一个基于表达式模板和运算符/函数重载的自动微分工具。例如，模板*std::max*函数已成功重载：

```
namespace ead {
    ...
    template<class A>
    struct ExprWrap
    {
        inline
        operator A const& () const
        { return *static_cast<A const*>(this);}
    };

    class adnumber : public ExprWrap<adnumber>
    { ..... };

    template<typename L, typename R>
    class MaxExpr : public ExprWrap<MaxExpr<L,R> >{ ...... };

    // overloading std::max
    template<typename L, typename R>
    MaxExpr<L,R>
    max (ExprWrap<L> const& l, ExprWrap<R> const& r)
    {
        return MaxExpr<L,R>(l,r); // return an expression
    }
    ...
} 
```

但在如下代码中

```
using namespace std;
using namespace ead;

adnumber x,y,z;
z = max(x,y);      // call std::max 
```

*如果命名空间被省略，则使用*std:: ，而对于某些其他函数，则使用**ead::*。是否有强制编译器始终选择 ead:: 命名空间的技巧，例如用于 max 函数？（请不要使用 C++11 功能）为什么编译器认为 std::max 更匹配？
好的，我知道在函数名称之前写*ead::*没什么大不了的，但我想避免用户打字。*

 ** * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:56:53.887

考虑`std::max`产量的实例化：

```
std::max(ead::adnumber, ead::number); 
```

这是比您的签名更好的匹配`max`（它是完全匹配）。因此它将被调用。你唯一的出路是限定调用，因为你`std::max`不能通过 SFINAE 实例化失败或使你`ead::max`的完全通用`ead::max(T, T)`。第二次尝试会使调用变得模棱两可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:56:32.373

假设在 namespace 中定义`adnumber`了一个用户定义类型（即**不是**a `typedef`）`ead`，则该函数`max()`应该在 namespaces`ead`和`std`. 当然，`std::max()`这是一个完美的匹配，即它赢得了重载决议，除非`adnumber`碰巧是某种类型的`typedef`for 。这是一个简化的示例，显示了不同的情况：`ExprWrap<T>``T`

```
#include <iostream>

namespace ead
{
    template <typename T> struct ExprWrap {};

    template <typename T>
    void max(ExprWrap<T> const&) { std::cout << "ead::max()\n"; }

    typedef int builtin;
    struct other {};
    typedef ExprWrap<int> instance;
    struct derived: ExprWrap<int> {};
}

namespace foo
{
    template <typename T>
    void max(T const&) { std::cout << "foo::max()\n"; }
}

int main()
{
    using namespace foo;
    using namespace ead;

    ead::builtin  b;
    ead::other    o;
    ead::instance i;
    ead::derived  d;

    max(b);
    max(o);
    max(i);
    max(d);
} 
```

这应该打印

```
foo::max()
foo::max()
ead::max()
foo::max() 
```*

# python - 在 Mac OS X 上的 IDE 中设置 Python 3 的路径

> ID：13595157
> 
> 赞同：4
> 
> 时间：2012-11-27T23:33:09.653
> 
> 标签：python, ide, path, python-3.x

我打算在 Mac OS X 上的 Ninja IDE 中编写一些 Python 3.2 脚本。但是，我很快发现 IDE 使用的是系统默认附带的 Python 2.7 解释器。

首选项当前指定的“Python 路径”只是“python”。我想一直使用 Python 3.2，我想这是一个编写或在首选项中找到正确路径的问题。在“终端”中，我通常只在文件名后面使用“python3”语句，但这和更长的路径都没有太大帮助。

我确信答案很简单，但我的谷歌技能和其他技术知识到目前为止还没有给我答案。任何帮助深表感谢 ：-）

编辑：这是首选项窗口的屏幕截图。 ![这是首选项屏幕的外观](../Images/1ea6e3fe8c6532a8eaf685b5ff37848c.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T22:52:50.480

Ninja IDE 与 python 3 不兼容要使用 python 3，你必须为 OSX 找到另一个 IDE 我建议使用带有 Pydev 插件的 eclipse，这里有一个关于如何安装 pydev 和 eclipse 的教程：[http://www.youtube。 com/watch?v=vHRRiBHI3to](http://www.youtube.com/watch?v=vHRRiBHI3to)

常见问题解答链接：[https ://github.com/ninja-ide/ninja-ide/wiki/FAQ](https://github.com/ninja-ide/ninja-ide/wiki/FAQ)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T23:07:06.273

通常是“/usr/bin/python3”，它是指向安装 Python 3 的任何位置的软链接。

由于 OS X 附带 2.7，因此您需要自己下载并安装 Python 3。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-09T16:47:32.880

[http://wolfpaulus.com/jounal/mac/installing_python_osx/](http://wolfpaulus.com/jounal/mac/installing_python_osx/)

我刚刚点击了那个链接，我的系统现在在 shell 中使用 python3.4。

# c# - 评估枚举参数

> ID：13595159
> 
> 赞同：1
> 
> 时间：2012-11-27T23:33:25.387
> 
> 标签：c#, asp.net, enums

我有两个枚举和一个将枚举作为参数的方法。它们称为 ABC 和 DEF，方法称为 TestMethod(Enum myEnum)。代码如下：

```
public enum ABC
{
    Zero = 0,
    One = 1,
    Two = 2
};

public enum DEF
{
    Three = 3,
    Four = 4,
    Five = 5
};

public int TestEnum(Enum myEnum)
{
    int returnValue = ??? // How do I get the value out of this enum that can be either ABC or DEF?
    bool randomTestBool = returnValue > 3;
    return returnValue
}

public void CallerFunction()
{
    int whatsMyInt = TestEnum(DEF.Four);
} 
```

从 CallerFunction() 我调用 TestEnum() 函数并传入两个（理想情况下更多）枚举之一。我需要了解如何获取整数格式的值，以便在函数中进行比较。现在，如果这是一个单一类型的枚举，即如果函数是 TestEnum(DEF myDefEnum) 那么这将很容易，但是，该函数需要处理多个 Enum 类型。感谢之前的回复，我了解到要获得一种枚举类型，我可以做以下两件事之一：

1) bool isThisDef = myEnum 是 DEF；但我很好奇是否有比为每种 Enum 类型创建场景更通用的方法。也许像这样

2) 键入 myEnumType = myEnum.GetType(); 但我现在不知道该怎么办。任何帮助是极大的赞赏。=) 顺便说一句，字符串 testString = myEnum.toString(); 产生错误：\

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T23:37:09.490

```
public int TestEnum(Enum myEnum)
{
    return (int)(object)myEnum;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T23:37:12.323

你只需写

```
int returnValue = (int)(object) myEnum; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T23:49:58.313

我猜这种行为不太可靠，因为它可能会在 .Net 的进一步版本中更改，但它也返回底层值：

```
int returnValue = myEnum.GetHashCode(); 
```

PS：[使用 GetHashCode 获取 Enum int value](https://stackoverflow.com/questions/4584627/using-gethashcode-for-getting-enum-int-value)，即不要这样做......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T02:02:51.037

你可以试试：

```
int returnValue = Convert.ToInt32(myEnum); 
```

在我看来，一个更好的选择是显式声明`ABC`和`DEF`作为整数类型：

```
public enum ABC : int
{
    Zero = 0,
    One = 1,
    Two = 2
};

public enum DEF : int
{
    Three = 3,
    Four = 4,
    Five = 5
}; 
```

然后只需使用`int returnValue = (int)myEnum;`.
为了安全起见，您必须检查所提供枚举的类型，因此如果有的话，性能提升会很小（除非您可以保证所有可以传入的枚举都基于整数类型，否则不需要检查） .

# php - PHP：从 URL 重写规则中排除 URL 路径

> ID：13595160
> 
> 赞同：0
> 
> 时间：2012-11-27T23:33:35.580
> 
> 标签：php, wordpress, url

我在wordpress中有以下重写规则：

`add_rewrite_rule('members/(.+)/?$', 'index.php?pagename=members&username=$matches[1]','top');`

这会重写 URL 地址中 www.mysite.com/members/ 之后的所有内容。

我的挑战是保留该功能但排除以下 URL 路径：www.mysite.com/members/info/。

有人可以帮我这样做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:13:49.523

只需在其他指令之前将其添加到 .htaccess 即可。

```
RewriteRule members/ - [L] 
```

# javascript - AngularJS 自定义指令

> ID：13595162
> 
> 赞同：1
> 
> 时间：2012-11-27T23:33:45.853
> 
> 标签：javascript, angularjs

我一直在关注以下网站上的教程，并且正在尝试创建他正在谈论的图标指令。

[http://blog.berylliumwork.com/2012/10/tutorials-on-angularjs-and-rails-7.html](http://blog.berylliumwork.com/2012/10/tutorials-on-angularjs-and-rails-7.html)

这是我所拥有的

任务.js

```
angular.module('momentum', ['momentumService'])
    .config(["$httpProvider", function(provider) {
        console.log("httpProvider");
        provider.defaults.headers.common['X-CSRF-Token'] = $('meta[name=csrf-token]').attr('content');
    }]);

angular.module('momentumService', ['ngResource']).
    factory('Task', function($resource) {
        console.log("Create resource action");
        return $resource('/tasks/:task_id/:action', {task_id:'@id'}, {
            update: { method: 'PUT' }
        });
    }).
    directive('icon', function() {
        return {
            restrict: 'A',      // attribute
            link: function(scope, element, attrs) { // Manipulate the DOM element
                element.prepend('<i class="icon-tasks"></i> ');
            }
        }
    }); 
```

索引.html

```
<h1>Listing tasks</h1>

<div ng-controller="TasksController" ng-init="index()">
  <a href="" ng-click="create({title: 'New task'})">Create</a>

  <span ng-hide="tasks">Loading</span>
  <table>
    <tr>
      <th>Title</th>
      <th>Finished</th>
    </tr>

    <tr ng-repeat="task in tasks" id="task_{{task.id}}">
      <td data-icon="tasks">{{ task.title }}</td>
      <td>{{ task.finished }}</td>

      <td><a href="" ng-click="action(task.id, 'action')">Action</a></td>
      <td><a href="" ng-click="show(task.id)">Show</a></td>
      <td><a href="" ng-click="edit(task.id)">Edit</a></td>
      <td><a href="" ng-click="destroy(task.id)">Delete</a></td>
    </tr>
  </table>
</div> 
```

如果我放入 index.html 我会得到一个图标。这里假设发生的是 data-icon 应该调用 tasks.js 中的指令图标函数并在每个任务上显示图标。为什么不调用这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:49:59.737

请注意，如果我将所有内容都放在一个模块中，它将起作用。

```
angular.module('momentum', ['momentumService'])
    .config(["$httpProvider", function(provider) {
        console.log("httpProvider");
        provider.defaults.headers.common['X-CSRF-Token'] = $('meta[name=csrf-token]').attr('content');
    }]).
    factory('Task', function($resource) {
        console.log("Create resource action");
        return $resource('/tasks/:task_id/:action', {task_id:'@id'}, {
            update: { method: 'PUT' }
        });
    }).
    directive('icon', function() {
        return {
            restrict: 'A',      // attribute
            link: function(scope, element, attrs) { // Manipulate the DOM element
                element.prepend('<i class="icon-tasks"></i> ');
            }
        }
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-14T06:32:24.773

```
app.controller('MainCtrl', function($scope) {
  $scope.name = 'World';
});

app.directive('simpleDemo',function(){
  var newtemplate = function(){
     var template = '<i class="glyphicon glyphicon-remove"><i>';
     return template;
  }
   return {
    restrict: 'E',
    template: newtemplate
  }
})

<body ng-controller="MainCtrl">
    <p>Hello {{name}}!</p>
    <button><simple-demo></simple-demo></button>
  </body> 
```

# cuda - 交叉编译到较旧的 CUDA 工具包版本？

> ID：13595167
> 
> 赞同：0
> 
> 时间：2012-11-27T23:34:10.487
> 
> 标签：cuda

我在共享机器上，没有root。

我的代码因以下 CUDA 错误而死

`CUDA driver version is insufficient for CUDA runtime version`

我想为旧的工具包构建我的程序。我认为这是可能的，因为商业应用程序的分发支持比最新的工具包（？）更早的东西。

我玩过`arch`国旗，但没有成功。

```
nvcc -arch=compute_13 fun.cu
nvcc -arch=compute_20 fun.cu 
```

编译到早期工具包版本的标志是什么？就我而言，我有一个版本`4`工具包，但我相信驱动程序只做 version `3`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:48:56.033

例如，我不知道命令行标志或类似选项告诉 CUDA 4.x 工具包的行为就像它是 CUDA 3.x 工具包一样。

正如您所发现的，对于特定版本的工具包，需要特定的驱动程序版本（或更新版本）。

一种方法是自行安装所需的工具包。您不需要 root 权限，但您的用户目录中需要一些磁盘空间。[从存档中](https://developer.nvidia.com/cuda-toolkit-archive)选择所需的工具包并将其安装到用户目录空间的本地目录中。（该工具包将提示您输入安装位置，并获取其他工具包安装选项，您可以执行以下操作：`sh <toolkit filename> --help`）。将工具包安装到本地目录后，例如 /home/user/cuda，然后修改 PATH 以包含 /home/user/cuda/bin（在任何其他 cuda 目录之前，例如 /usr/local/cuda/bin ) 和您的 LD_LIBRARY_PATH 以包括 /home/user/cuda/lib 和 /home/user/cuda/lib64 （在任何其他 cuda lib 目录之前。）如果您想使这些永久化，您可以编辑您的 .bashrc 文件或使用类似的文件方法，取决于发行版/外壳。然后您应该能够正常键入您的 nvcc 编译命令。如果您要链接到任何特定库（如 cublas 等），则需要像往常一样使用 -L 编译器/链接器开关指向本地目录中的 cublas 库。

驱动程序不受任何影响，cuda 工具包也不会安装在社区位置，例如 /usr/local/cuda。如果您恢复 PATH 和 LD_LIBRARY_PATH 环境变量，您应该恢复以前使用安装在社区位置的 cuda 工具包的功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T23:52:23.537

首先，您需要下载旧工具包并将其安装到您的主目录。

完成后，您可以执行以下操作。

在 .bashrc 中设置 CUDADIR=path/to/cuda/

一旦你有了它，如果你正在使用 Makefile，你可以将它`$(CUDADIR)/bin/nvcc`用作你的编译器，并`$(CUDADIR)/lib64`作为你的库路径，`$(CUDADIR)/include`作为你的包含路径。

如果您使用的是 shell 脚本或在命令行上编译，请使用`$CUDADIR/bin/nvcc`等等。

另一种选择是将 $CUDADIR/bin 预先添加到您的 $PATH 中，如下所示在您的 .bashrc 中。

```
CUDADIR=/home/username/cuda
export PATH=$CUDADIR/bin:$PATH
export LD_LIBRARY_PATH=$CUDADIR/lib64:$LD_LIBRARY_PATH 
```

更新系统后，您只需将 CUDADIR 指向的路径更改为新位置即可，无需更改任何其他内容。

`-arch`标志用于指定架构而不是工具包版本。

# javascript - 使用 D3 更新 SVG 元素 Z-Index

> ID：13595175
> 
> 赞同：89
> 
> 时间：2012-11-27T23:34:38.797
> 
> 标签：javascript, svg, d3.js

使用 D3 库将 SVG 元素置于 z 顺序顶部的有效方法是什么？

我的具体场景是一个饼图，当鼠标悬停在给定的部分时，它会突出显示（通过添加`stroke`到）。`path`生成我的图表的代码块如下：

```
svg.selectAll("path")
    .data(d)
  .enter().append("path")
    .attr("d", arc)
    .attr("class", "arc")
    .attr("fill", function(d) { return color(d.name); })
    .attr("stroke", "#fff")
    .attr("stroke-width", 0)
    .on("mouseover", function(d) {
        d3.select(this)
            .attr("stroke-width", 2)
            .classed("top", true);
            //.style("z-index", 1);
    })
    .on("mouseout", function(d) {
        d3.select(this)
            .attr("stroke-width", 0)
            .classed("top", false);
            //.style("z-index", -1);
    }); 
```

我尝试了几个选项，但到目前为止没有运气。使用`style("z-index")`和调用`classed`两者都不起作用。

“顶级”类在我的 CSS 中定义如下：

```
.top {
    fill: red;
    z-index: 100;
} 
```

该`fill`声明是为了确保我知道它正在正确打开/关闭。这是。

我听说 using`sort`是一个选项，但我不清楚如何实现将“选定”元素置于顶部。

**更新：**

我使用以下代码修复了我的特殊情况，该代码在`mouseover`事件中向 SVG 添加了一个新弧以显示突出显示。

```
svg.selectAll("path")
    .data(d)
  .enter().append("path")
    .attr("d", arc)
    .attr("class", "arc")
    .style("fill", function(d) { return color(d.name); })
    .style("stroke", "#fff")
    .style("stroke-width", 0)
    .on("mouseover", function(d) {
        svg.append("path")
          .attr("d", d3.select(this).attr("d"))
          .attr("id", "arcSelection")
          .style("fill", "none")
          .style("stroke", "#fff")
          .style("stroke-width", 2);
    })
    .on("mouseout", function(d) {
        d3.select("#arcSelection").remove();
    }); 
```

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2013-06-16T12:14:49.127

As explained in the other answers, SVG does not have a notion of a z-index. Instead, the order of elements in the document determines the order in the drawing.

Apart from reordering the elements manually, there is another way for certain situations:

Working with D3 you often have **certain types of elements that should always be drawn on top of other types of elements**.

For example, when laying out graphs, links should always be placed below nodes. More generally, some background elements usually need to be placed below everything else, while some highlights and overlays should be placed above.

If you have this kind of situation, I found that creating **parent group elements** for those groups of elements is the best way to go. In SVG, you can use the `g` element for that. For example, if you have links that should be always placed below nodes, do the following:

```
svg.append("g").attr("id", "links")
svg.append("g").attr("id", "nodes") 
```

Now, when you paint your links and nodes, select as follows (the selectors starting with `#` reference the element id):

```
svg.select("#links").selectAll(".link")
// add data, attach elements and so on

svg.select("#nodes").selectAll(".node")
// add data, attach elements and so on 
```

Now, all links will always be appended structurally before all node elements. Thus, the SVG will show all links below all nodes, no matter how often and in what order you add or remove elements. Of course, all elements of the same type (i.e. within the same container) will still be subject to the order in which they were added.

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2012-12-10T02:02:14.147

One of the solutions presented by the developer is: "use D3's sort operator to reorder the elements." (see [https://github.com/mbostock/d3/issues/252](https://github.com/mbostock/d3/issues/252))

In this light, one might sort the elements by comparing their data, or positions if they were dataless elements:

```
.on("mouseover", function(d) {
    svg.selectAll("path").sort(function (a, b) { // select the parent and sort the path's
      if (a.id != d.id) return -1;               // a is not the hovered element, send "a" to the back
      else return 1;                             // a is the hovered element, bring "a" to the front
  });
}) 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2013-06-29T23:22:12.497

Since SVG doesn't have Z-index but use the order of the DOM elements, you can bring it to front by:

```
this.parentNode.appendChild(this); 
```

You can then e.g. make use of [insertBefore](https://developer.mozilla.org/en-US/docs/Web/API/Node/insertBefore) to put it back on `mouseout`. This however requires you to be able to target the sibling-node your element should be inserted before.

**DEMO:** Take a look at this [JSFiddle](http://jsfiddle.net/Q5Jag/1194/)

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-11-28T06:14:00.050

SVG 不做 z-index。Z 顺序由 SVG DOM 元素在其容器中的顺序决定。

据我所知（过去我已经尝试过几次），D3 没有提供分离和重新连接单个元素的方法，以便将其放在前面或诸如此类。

有一种[`.order()`方法](https://github.com/mbostock/d3/wiki/Selections#wiki-order)可以重新排列节点以匹配它们在选择中出现的顺序。在您的情况下，您需要将单个元素放在前面。因此，从技术上讲，您可以使用所需元素在前面（或最后，不记得哪个是最上面的）来重新选择，然后调用`order()`它。

Or, you could skip d3 for this task and use plain JS (or jQuery) to re-insert that single DOM element.

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2017-02-02T10:54:11.817

The simple answer is to use d3 ordering methods. In addition to d3.select('g').order(), there is [.lower()](https://github.com/d3/d3-selection/tree/v1.4.1#selection_lower) and [.raise()](https://github.com/d3/d3-selection/tree/v1.4.1#selection_raise) in version 4\. This changes how your elements appear. Please consult the docs for more information - [https://github.com/d3/d3/blob/master/API.md#selections-d3-selection](https://github.com/d3/d3/blob/master/API.md#selections-d3-selection)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-06-21T23:04:59.037

I implemented futurend's solution in my code and it worked, but with the large number of elements I was using, it was very slow. Here's the alternative method using jQuery that worked faster for my particular visualization. It relies on the svgs you want on top having a class in common (in my example the class is noted in my data set as d.key). In my code there is a `<g>` with the class "locations" that contains all of the SVGs I'm re-organizing.

```
.on("mouseover", function(d) {
    var pts = $("." + d.key).detach();
    $(".locations").append(pts);
 }); 
```

So when you hover on a particular data point, the code finds all the other data points with SVG DOM elements with that particular class. Then it detaches and re-inserts the SVG DOM elements associated with those data points.

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-04-10T16:27:35.163

Wanted to expand on what @notan3xit answered rather than write out an entire new answer (but I don't have enough reputation).

Another way to solve the element order problem is to use 'insert' rather than 'append' when drawing . That way the paths will always be placed together before the other svg elements(this assumes your code already does the enter() for links before the enter() for the other svg elements).

d3 insert api: [https://github.com/mbostock/d3/wiki/Selections#insert](https://github.com/mbostock/d3/wiki/Selections#insert)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-10-11T02:31:19.310

It took me ages to find how to tweak the Z-order in an existing SVG. I really needed it in the context of d3.brush with tooltip behavior. In order to have the two features work nicely together ([http://wrobstory.github.io/2013/11/D3-brush-and-tooltip.html](http://wrobstory.github.io/2013/11/D3-brush-and-tooltip.html)), you need the d3.brush to be the first in Z-order (1st to be drawn on the canvas, then covered by the rest of the SVG elements) and it will capture all mouse events, no matter what is on top of it (with higher Z indices).

Most forum comments say that you should add the d3.brush first in your code, then your SVG "drawing" code. But for me it was not possible as I loaded an external SVG file. You can easily add the brush at any time and alter the Z-order later on with:

```
d3.select("svg").insert("g", ":first-child"); 
```

In the context of a d3.brush setup it will look like:

```
brush = d3.svg.brush()
    .x(d3.scale.identity().domain([1, width-1]))
    .y(d3.scale.identity().domain([1, height-1]))
    .clamp([true,true])
    .on("brush", function() {
      var extent = d3.event.target.extent();
      ...
    });
d3.select("svg").insert("g", ":first-child");
  .attr("class", "brush")
  .call(brush); 
```

d3.js insert() function API: [https://github.com/mbostock/d3/wiki/Selections#insert](https://github.com/mbostock/d3/wiki/Selections#insert)

Hope this helps!

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-03-24T11:10:34.323

You can Do like this On Mouse Over You can Pull it to top.

```
d3.selection.prototype.bringElementAsTopLayer = function() {
       return this.each(function(){
       this.parentNode.appendChild(this);
   });
};

d3.selection.prototype.pushElementAsBackLayer = function() { 
return this.each(function() { 
    var firstChild = this.parentNode.firstChild; 
    if (firstChild) { 
        this.parentNode.insertBefore(this, firstChild); 
    } 
}); 
```

};

```
nodes.on("mouseover",function(){
  d3.select(this).bringElementAsTopLayer();
}); 
```

If You want To Push To Back

```
nodes.on("mouseout",function(){
   d3.select(this).pushElementAsBackLayer();
}); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-03-31T20:44:58.290

## Version 1

In theory, the following should work fine.

### The CSS code :

```
path:hover {
    stroke: #fff;
    stroke-width : 2;
} 
```

This CSS code will add a stroke to the selected path.

### The JS code :

```
svg.selectAll("path").on("mouseover", function(d) {
    this.parentNode.appendChild(this);
}); 
```

This JS code first removes the path from the DOM tree and then adds it as the last child of its parent. This makes sure the path is drawn on top of all other children of the same parent.

In practice, this code works fine in Chrome but breaks in some other browsers. I tried it in Firefox 20 on my Linux Mint machine and couldn't get it to work. Somehow, Firefox fails to trigger the `:hover` styles and I haven't found a way to fix this.

* * *

## Version 2

So I came up with an alternative. It may be a bit 'dirty', but at least it works and it doesn't require looping over all elements (as some of the other answers).

### The CSS code :

```
path.hover {
    stroke: #fff;
    stroke-width : 2;
} 
```

Instead of using the `:hover` pseudoselector, I use a `.hover` class

### The JS code :

```
svg.selectAll(".path")
   .on("mouseover", function(d) {
       d3.select(this).classed('hover', true);
       this.parentNode.appendChild(this);
   })
   .on("mouseout", function(d) {
       d3.select(this).classed('hover', false);
   }) 
```

On mouseover, I add the `.hover` class to my path. On mouseout, I remove it. As in the first case, the code also removes the path from the DOM tree and then adds it as the last child of its parent.

# hibernate - 行计数投影的休眠奇怪行为

> ID：13595181
> 
> 赞同：2
> 
> 时间：2012-11-27T23:35:11.843
> 
> 标签：hibernate, count, row, criteria, projection

所以我有以下代码

```
 DetachedCriteria subquery = DetachedCriteria.forClass(Component.class);
    subquery.setResultTransformer(Criteria.DISTINCT_ROOT_ENTITY);
    subquery.createAlias("files", "files");
    subquery.createAlias("files.review", "review");
    subquery.createAlias("review.observers", "observer", Criteria.LEFT_JOIN);
    subquery.add(Restrictions.or(Restrictions.eq("review.owner", user), Restrictions.eq("observer.id", user.getId())));
    subquery.setProjection(Projections.groupProperty("review.id"));

    DetachedCriteria subquery2 = DetachedCriteria.forClass(ReviewNotification.class);
    subquery2.setResultTransformer(Criteria.DISTINCT_ROOT_ENTITY);
    subquery2.add(Subqueries.propertyIn("review", subquery));
    subquery2.add(Restrictions.eq("reviewer", user));
    subquery2.setProjection(Projections.groupProperty("review"));

    Criteria criteria = session.createCriteria(Component.class);
    criteria.setResultTransformer(Criteria.DISTINCT_ROOT_ENTITY);
    criteria.createAlias("files", "files");
    criteria.createAlias("files.review", "review");
    criteria.add(Subqueries.propertyIn("review.id", subquery2)); 
```

现在我的问题是，如果我执行以下操作，我会得到 2 作为返回值（这是正确的）

```
 List<Component> list = (List<Component>) criteria.list();
    for (Component reviewNotification : list) {
        System.out.println(reviewNotification);
    }
    return new Long(list.size()); 
```

但如果我这样做

```
 criteria.setProjection(Projections.rowCount());
    return (Long) criteria.uniqueResult(); 
```

我得到4。

任何人都知道为什么行数失败？

我刚刚尝试了别的东西

```
 criteria.setProjection(Projections.countDistinct("id")); 
```

这也有效。那么有人知道发生了什么吗？我想问题来自于 criteria.setResultTransformer(Criteria.DISTINCT_ROOT_ENTITY); 我错了吗？

感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T18:36:27.633

我似乎方法 setProjection 覆盖

```
criteria.setResultTransformer(Criteria.DISTINCT_ROOT_ENTITY); 
```

这可以解释为什么返回数据不是唯一的

# mysql - 需要将 SQL 列从 varchar(255) 转换为 bigint(20)

> ID：13595185
> 
> 赞同：2
> 
> 时间：2012-11-27T23:35:22.807
> 
> 标签：mysql, sql, casting

旧 Drupal 4.7 评论表中的“线程”列是 varchar(255)，我需要将其转换为 bigint(20) 以使其适用于 Wordpress wp_comments 表中的“comment_parent”列。

我尝试了各种我见过的 Cast 和 Convert 命令，但总是遇到语法错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:45:02.110

这适用于**SQL Server**：

```
create table Comments 
(
    [thread] nvarchar(255)
) 

insert comments 
select '1' 
union select '2' 
union select '3' 
union select '4' 
union select '5' 
union select 'x' 

select 
    case 
        when ISNUMERIC([thread]) > 0 
            then CAST([thread] as bigint) 
        else 
            null 
    end colAsBigInt 
    , [thread] colAsNvarChar 
from comments 
```

[http://sqlfiddle.com/#!6/337eb/1](http://sqlfiddle.com/#!6/337eb/1)

对于**MySQL**尝试：

```
create table if not exists Comments 
(
    thread varchar(255) character set UTF8 not null
);

insert comments(thread) values ('1');
insert comments(thread) values ('2');
insert comments(thread) values ('3');
insert comments(thread) values ('4');
insert comments(thread) values ('5');
insert comments(thread) values ('6.1');
insert comments(thread) values ('x');

select 
    case 
        when thread  REGEXP ('^(-|\\+)?([0-9]+\\.[0-9]*|[0-9]*\\.[0-9]+|[0-9]+)$') 
            then cast(thread as signed)
        else 
            null 
    end colAsBigInt 
    , thread colAsVarChar 
from comments

--regex trick from here: http://forums.mysql.com/read.php?60,1907,241284#msg-241284
--without the regex you'll get 0s instead of nulls for invalid values
--MySQL's cast only works on certain data types, given here http://www.roseindia.net/sql/mysql-example/mysql-cast.shtml 
```

此处可运行 MySQL 示例：[http ://sqlfiddle.com/#!2/6d848/9](http://sqlfiddle.com/#!2/6d848/9)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T04:34:07.377

当我运行您为 MySQL 提供的第二组代码时，它没有将该列转换为 BigInt。它确实提供了 colasBigInt 和 colasVarChar 的并排比较。无一例外，对于数千行，无论 colasVarChar 值如何，所有 colasBigInt 都读为 Null。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T23:38:07.820

您遇到什么语法错误？你用的是什么数据库？

您可以提供的信息越多，就越有可能有人可以帮助您。

# asp.net - JavaScript 到 StringBuilder

> ID：13595186
> 
> 赞同：2
> 
> 时间：2012-11-27T23:35:36.707
> 
> 标签：asp.net, asp.net-mvc, c#-4.0, asp.net-mvc-4

我在 c# 中有一个函数，我在其中使用 StringBuilder 并添加了 JavaScript 代码，这是我的助手：

```
public static string RegisterJS(this System.Web.Mvc.HtmlHelper helper, string scriptLib)
{
    StringBuilder JavaScript = new StringBuilder();
    JavaScript.AppendFormat(@"<script type= ""text/javascript"">{0}", Environment.NewLine);
    JavaScript.AppendFormat(@"var toolbar = new toolBarObject('toolbarObj');{0}", Environment.NewLine);
    JavaScript.AppendFormat(@"toolbar.disableElements('" + scriptLib + "', true);{0}", Environment.NewLine); 
```

... ... JavaScript.AppendFormat(@"{0}", Environment.NewLine);
返回 JavaScript.ToString(); }

调用此函数以在 Asp.Net MVC4 中的一个部分中加载应用程序：

如下：

```
@section ToolBar{
  <h2>aqui debo cargar mi javascript</h2>
   @Html.RegisterJS("Personal")
} 
```

我运行程序并显示我拥有的页面代码：

```
&lt;script type= &quot;text/javascript&quot;&gt; 
```

我应该有这个：

```
<script type= "text/javascript"> 
```

这发生在函数的所有行中

我该如何解决这个问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:44:11.057

我建议把它包起来 [`Html.Raw`](http://msdn.microsoft.com/en-us/library/gg480740(v=vs.98).aspx)

```
@section ToolBar
{
 <h2>aqui debo cargar mi javascript</h2>
 @Html.Raw(Html.RegisterJS("Personal"))
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T23:44:19.350

razor 语法中的`@`符号对结果进行 HTML 编码。

您可以通过从您的方法返回 an 来防止这种情况`IHtmlString`，该方法本质上与`@`符号通信，即您的文本不需要编码。

最简单的方法是将最后一行替换为：

```
return MvcHtmlString.Create(JavaScript.ToString()); 
```

但是，请小心您传入的内容！

# c++ - 将 Fortran 77 程序与 C++ dll 链接

> ID：13595188
> 
> 赞同：1
> 
> 时间：2012-11-27T23:35:52.353
> 
> 标签：c++, gcc, dllexport, fortran77

我正在阅读这个 SO 问题：[Linking fortran and c++ binaries using gcc](https://stackoverflow.com/questions/5663083/linking-fortran-and-c-binaries-using-gcc)。

有人可以解释一下是否可以用 C++ 用 fortran 77 做类似的事情？
我需要从 fortran 77 文件中提取一些子例程并将它们转换为 C++ dll。新创建的 dll 需要使用旧的 fortran 77 文件。

关于如何使用 c++ dll 链接和编译 fortran 77 文件的一些分步说明会很棒。我进行了很多搜索，并且是混合编程的新手。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T19:43:45.977

这是一个调用 C++ 的 fortran 程序。请注意，接口必须位于外部“C”中，否则链接器将找不到它们。

1) 创建一个名为 worker.cpp 的 C 例程。注意例程名称后面的下划线。

```
#include <iostream>
extern "C"
{
extern void __attribute__((stdcall)) worker_()
{
   std::cout << "Hey it works" << std::endl;
}
} 
```

2) 创建一个名为 boss.for 的 Fortran 程序。请注意，调用 C 例程时没有尾随下划线。

```
 program main
      external worker
      print *, 'Calling C'
      call worker
      print *, 'Back to F77'
      stop
      end 
```

3）编译C代码

```
g++ -c worker.cpp 
```

4）编译并链接Fortran代码

```
gfortran boss.for worker.o -o fboss -L/usr/lib -lstdc++ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T05:31:07.400

将 C++ 链接到 Fortran 程序几乎是不可能的，因为名称混淆，除非所有内容都位于外部“C”中。或者，您可以使接口 extern "C" 和实现 C++。

这是如何将现有的 Fortran 库与 C++ 程序链接，这是另一篇文章的内容。

1) 创建一个 Fortran 子程序，比如 worker.for。这是 F77 所以记住前 6 个空格

```
 subroutine printhi
      print *, 'it works'
      end subroutine 
```

2) 创建一个调用它的 C++ 程序，比如 boss.cpp。注意 Fortran 例程名称中的尾随下划线

```
#include <iostream>
// Avoid any name mangling
extern "C"
{
extern void __attribute__((stdcall)) printhi_(void);
}

int main()
{
   std::cout << "Calling fortran" << std::endl;
   printhi_();
   std::cout << "Returned to C++" << std::endl;
} 
```

3) 构建 F77 例程

```
gfortran -c worker.for 
```

4) 编译并链接 C++ 程序。添加 fortran 库以解析任何 fortran 特定位。

```
g++ boss.cpp worker.o -o cboss -L/usr/lib -lgfortran 
```

5) 运行程序

```
./a.out 
```

# android - 片段中的静态数组适配器。好的做法还是坏的做法？

> ID：13595194
> 
> 赞同：4
> 
> 时间：2012-11-27T23:36:31.127
> 
> 标签：android, memory, static, fragment, android-arrayadapter

我在 Java 中对静态对象进行了大量的 Google 搜索，我想我了解它们在 Android 中的工作原理。当应用程序的进程终止时，静态对象会被 GC，而不是在声明静态对象的 Activity 被销毁时（如果我错了，请纠正我）。我有一个带有 Tabhost 的应用程序，其中使用了 Fragments。声明对象的Fragment一直在ViewPager的右边（共有三个Fragment）。右侧的选项卡有一个显示用户数据的 ListView，我希望当用户滑过所有选项卡或导航离开应用程序时，这些数据仍然存在。这些数据不需要保存，只需要通过应用程序的正常使用保留在内存中。给我想要的结果的修复方法是为我的阵列适配器设置一个静态前缀。我的问题是，这被认为是好的做法吗？我知道错误地使用静态对象会导致内存问题，但是我没有得到任何广泛使用的 FC（横向到纵向一遍又一遍，快速浏览选项卡，向 ListView 添加大量数据等）。这是我正在使用的代码

```
static ArrayAdapter<String> arrayAdapter;

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) 
{

    View view = inflater.inflate(R.layout.fragment,
            container, false);      

        if (personList == null)
        {

            personList = new ArrayList<String>();

        }

        if (arrayAdapter == null)
        {

            arrayAdapter = new ArrayAdapter<String>
            (getActivity().getApplicationContext(), android.R.layout.simple_list_item_1, personList);

        } 
```

编辑：

这就是我实现这个想法的方式。我在我的主 Activity 中有这段代码（它是标签片段的父项。我把这段代码放在 Activity 的 onDestroy() 方法中，以尝试回收一些内存。

```
@Override
protected void onDestroy() {
    super.onDestroy();

    if (arrayAdapter != null)
    {

        arrayAdapter.clear();

        arrayAdapter = null;

        Log.i("Activity", "Adapter nulled!");

    }

    Log.i("Activity", "Activityhas been destroyed");
}

public ArrayAdapter<String> getArrayAdapter(ArrayList<String> personList)
{

    arrayAdapter = new ArrayAdapter<String>
    (getBaseContext(), android.R.layout.simple_list_item_1, personList);

    Log.i("Activity", "Adapter Created");

    return arrayAdapter;
} 
```

在我的片段中使用此代码

```
if (personList == null)
{

    personList = new ArrayList<String>();

}

if (arrayAdapter == null)
{

    arrayAdapter = ((ActivityMainScreen)getActivity()).getArrayAdapter(personList);

} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-27T23:55:07.197

记住！任何消耗对您的活动的引用`Context`并标记为*STATIC*的东西都容易发生内存泄漏。强烈不推荐。您可以使用某种**Observer/Observable**模式来保持您的数据在其他类中可用，或者通过 TabHost 活动中定义的公共方法简单地访问所需的对象。

有关更多信息，请阅读此[http://developer.android.com/training/basics/fragments/communicating.html](http://developer.android.com/training/basics/fragments/communicating.html)

关于内存泄漏，也许您应该在低端设备上测试您当前的实现，因为新型号设备在资源方面非常丰富。

* * *

**您的活动：**

```
private ArrayAdapter<String> arrayAdapter = null;

//initialize your adapter in onCreate

public ArrayAdapter<String> getListAdapter(){
    return arrayAdapter;
} 
```

**你的片段：**

```
@Override
public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);

    ArrayAdapter<String> adapter = ((YourActivityClass) getActivity()).getListAdapter();
    yourListView.setAdapter(adapter);
} 
```

# wpf - DrawingContext.DrawText 是否有内存泄漏？

> ID：13595199
> 
> 赞同：0
> 
> 时间：2012-11-27T23:37:02.243
> 
> 标签：wpf

我有一个 WPF 应用程序，它在特定模式下每 0.5 秒向 UI 显示一个文本字符串。我注意到，当这种情况发生时，内存使用量会缓慢但稳定地增加，并且永远不会释放，如果我让它运行足够长的时间，它将耗尽内存并崩溃。

绘图的代码如下：

```
public void DrawDisplay( DrawingContext dc, Size size )
{
    ...

    // Draw Text
    var fontSize = 46.0;
    FormattedText ft = new FormattedText(
        message,
        CultureInfo.GetCultureInfo( "en-us" ),
        FlowDirection.LeftToRight,
        new Typeface( "Franklin Book" ),
        fontSize,
        Brushes.Black );

    ft.MaxTextWidth = size.Width - 2;
    ft.TextAlignment = TextAlignment.Center;

    // don't draw outside of box
    ft.MaxTextHeight = size.Height;

    // Center
    var height = ( size.Height - ft.Height ) / 2;

    dc.DrawText( ft, new Point( 0, height ) );

    ...
} 
```

文本使用以下代码部分绘制在画布上：

```
DrawingVisual dv = new DrawingVisual();
var size = new Size( canvas.Width, canvas.Height );

using( DrawingContext dc = dv.RenderOpen() )
{
    // draw a transparent rect so the text doesn't stretch (fixes size)
    dc.DrawRectangle( Brushes.Transparent, null, new Rect( 0, 0, size.Width, size.Height ) );

    RadioInterface.DrawDisplay( dc, size );
}

canvas.Background = new VisualBrush( dv ); 
```

我可以通过仅注释掉“dc.DrawText(...”行。这样做，应用程序的内存使用是完全平坦的。除此之外，我不知道该尝试什么。我尝试搜索与 DrawText 相关的内存泄漏，但没有找到任何结果，并且我的函数中使用的代码几乎与 MSDN 站点上的 DrawText 示例相同。

有没有人看到这个或看到我做错了什么？

*   我尝试使用 CLRProfiler，但我对它不是很熟悉，而且内存泄漏太慢了，我无法从中获取任何有用的信息（可能是对工具缺乏了解）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T23:45:25.830

因此，经过更多阅读和重新阅读，我注意到这篇博客文章中的以下评论：[https ://blogs.msdn.com/b/jgoldb/archive/2008/02/04/finding-memory-leaks-in- wpf-based-applications.aspx?Redirected=true](https://blogs.msdn.com/b/jgoldb/archive/2008/02/04/finding-memory-leaks-in-wpf-based-applications.aspx?Redirected=true)

“这是仅存在于 3.5 SP1 版中的 WPF 中的一个泄漏。当在软件渲染模式下的 Viewport3D 中使用 VisualBrush、WriteableBitmap 或某些选择的其他类时，就会发生这种情况。”

我使用的是 Viewport，而不是 Viewport3D，但我使用的是软件渲染，如果我按照帖子中的建议将 VisualBrush 更改为 SolidColorBrush 以测试泄漏，它就会消失。此外，从 DrawingVisual 转换为 DrawingGroup 也修复了泄漏。

将第二个代码块更改为以下内容修复了泄漏：

```
DrawingVisual dg = new DrawingGroup();
var size = new Size( canvas.Width, canvas.Height );

using( DrawingContext dc = dg.Open() )
{
    // draw a transparent rect so the text doesn't stretch (fixes size)
    dc.DrawRectangle( Brushes.Transparent, null, new Rect( 0, 0, size.Width, size.Height ) );

    RadioInterface.DrawDisplay( dc, size );
}

canvas.Background = new DrawingBrush( dg ); 
```

我还尝试使用 DrawingVisual 类对象并一遍又一遍地重复使用它，而不是每次绘制时都创建一个新对象，这也修复了泄漏。

编辑：我使用 DrawingVisual 的最初原因是与我尝试的替代方案（包括 DrawingGroup）相比，它导致 cpu 使用率最低。差别不大，但基本一致。

# css - 溢出水平图像而不引起滚动

> ID：13595200
> 
> 赞同：0
> 
> 时间：2012-11-27T23:37:05.200
> 
> 标签：css

我试图让一个设计工作，它的图像水平溢出到某个点，但不会导致滚动条。最好用一张图片来解释：

```
 +-------------------------------------------+
         |                                           | <-- the window
+-------------------------------------------------------------+
|                                                             |
| the image that is really wide                               |
|                                                             |
+-------------------------------------------------------------+
         |                                           |
         |    +--------------------------------+     |
         |    |                                |     |
         |    |    content that should cause   |     |
         |    |    a horizontal scroll         |     |
         |    |                                |     |
         |    +--------------------------------+     |
         |                                           |
         +-------------------------------------------+ 
```

基本上，内容是960px。宽图像为 1800 像素。我希望水平滚动条低于 960 像素，但不高于，并且我希望所有内容在高于 960 像素时居中。

我知道我以前见过类似的设计。如果有人能指点我，那就太好了，或者如果你碰巧有它的 CSS :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:01:57.013

你可以试试`margin: auto`css文件。或者您可以绝对定位宽画面。然后将它的左边距设置为负值，使其居中。

```
.widePicture{
    position: absolute;
    left: 50%; (this places the left edge in the center)
    margin-left: -900px; (since the pic is 1800px wide, this will center it)
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T08:47:45.720

尝试将您的“非常宽的图像”放在 div 的背景中（无边距，宽度 100%），使用 css 将您的 bg 图像居中。它不会再导致水平滚动

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-27T23:46:23.910

对图片使用[溢出](https://developer.mozilla.org/en-US/docs/CSS/overflow)。使用[min-width](https://developer.mozilla.org/en-US/docs/CSS/min-width)作为内容。

# asp.net - GridView - 行点击 - 进入详细信息页面

> ID：13595204
> 
> 赞同：0
> 
> 时间：2012-11-27T23:37:20.363
> 
> 标签：asp.net, gridview

我将数据绑定到 GridView 控件。最后一列之一具有图像 URL 链接。

```
 <asp:GridView ID="gvSearchResults" runat="server" AutoGenerateColumns="False" Width="100%" OnRowCommand="gvccase_RowCommand" RowStyle-CssClass="rowHover">……..

<asp:TemplateField>
   <ItemTemplate>
   <asp:ImageButton ID="lnbEdit" AlternateText="edit" ImageUrl="~/images/edit_icon.gif"
                                                runat="server" CommandName="cmdEdit" />
                                        </ItemTemplate>
                                        <HeaderTemplate>
                                            Edit
                                        </HeaderTemplate>
                                    </asp:TemplateField> 
```

当用户单击最后一列时，将调用 OnRowCommnd 事件(protected void gvccase_RowCommand(object sender, System.Web.UI.WebControls.CommandEventArgs e))。

如何读取用户点击了哪一行？第一列有案例#。我想阅读“OnRowCommand”中的案例#。怎么做？

或者我想要完成的只是....当用户单击特定行时，我想将他们带到详细信息页面。

谢谢你，史密斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:14:10.703

为什么不做类似的事情：

```
<asp:GridView runat="server" ID="gvMajor" EmptyDataText="Your search terms did not match any records">
    <Columns>
        <asp:BoundField DataField="MajorCode" HeaderText="Major Code" />
        <asp:TemplateField>
            <ItemTemplate>
                <asp:ImageButton ID="lbModify" runat="server" CommandArgument='<%# Eval("MajorId") %>' OnClick="lbModify_Click" ImageUrl="~/Modify.png"   />
            </ItemTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView> 
```

然后在代码隐藏中：

```
protected void lbModify_Click(object sender, EventArgs e)
{
    var editLink = ((ImageButton)sender);
    //editLink.CommandArgument == MajorId
} 
```

只需确保将 gridview 绑定到正确的数据源，如下所示：

```
 DataTable dt = new DataTable();
    dt.Columns.Add("MajorId");
    dt.Columns.Add("MajorCode");

    //start loop here if needed
    DataRow dr = dt.NewRow();

    dr["MajorId"] = 1;
    dr["MajorCode"] = "MAJOR CODE 1";
    dt.Rows.Add(dr);
    //end loop

    gvMajor.DataSource = dt;
    gvMajor.DataBind(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:00:37.317

来自[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridviewcommandeventargs.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridviewcommandeventargs.aspx)：

```
 void ContactsGridView_RowCommand(Object sender, GridViewCommandEventArgs e)
  {
      // Convert the row index stored in the CommandArgument
      // property to an Integer.
      int index = Convert.ToInt32(e.CommandArgument);

  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T00:58:31.183

你可以试试这个。

**HTML**

```
 <asp:GridView ID="GridView1" AutoGenerateColumns="false" runat="server" OnRowCommand="GridView1_RowCommand">
      <Columns>
          <asp:TemplateField>
              <ItemTemplate>
                  <asp:Label ID="lblDatos" Text='<%#Eval("nombre")%>' runat="server" >
                  </asp:Label>
              </ItemTemplate>
          </asp:TemplateField>
          <asp:TemplateField>
              <ItemTemplate>
                  <asp:ImageButton ID="lnbEdit" AlternateText="edit" CommandArgument='<%#Eval("link")%>'
                                            runat="server" CommandName="cmdEdit" />
              </ItemTemplate>
          </asp:TemplateField>
      </Columns>
  </asp:GridView> 
```

**代码背后**

```
public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (!this.IsPostBack)
            this.llenar();

    }

    void llenar()
    {

        DataTable dt = new DataTable();
        dt.Columns.Add("nombre");
        dt.Columns.Add("link");
       DataRow dr= dt.NewRow();
       DataRow d1 = dt.NewRow();

       dr["nombre"] = "google";
       d1["nombre"] = "amazon";
       dr["link"]  = "http://google.com";
       d1["link"] = "http://amazon.com";
       dt.Rows.Add(dr);
       dt.Rows.Add(d1);

        this.GridView1.DataSource = dt;
        this.GridView1.DataBind();

    }

    protected void GridView1_RowCommand(object sender, GridViewCommandEventArgs e)
    {

        if (e.CommandName == "cmdEdit")
        {
            Response.Redirect(e.CommandArgument.ToString());

        }
    }
} 
```

# mysql - 无法通过给定的 varchar 列选择行，其中行的列中有句点 ('.')

> ID：13595205
> 
> 赞同：0
> 
> 时间：2012-11-27T23:37:22.170
> 
> 标签：mysql

我遇到了这个奇怪的问题，我可以将电子邮件“test@gmail.com”存储到我的数据库中，它是 varchar() 或 text()，但我无法根据电子邮件选择行。如果我通过另一个标识符（例如，名为“email_id”的主键）选择列，那么我可以显示带有句点的电子邮件。我还可以选择任何带有电子邮件列的行，其中包含没有句点的 varchar / 文本，例如“test@gmailcom”。

我已经在测试数据库和我的舞台数据库上复制了这个。这也不是代码问题，因为我在从查询面板直接插入数据库时​​已经测试并复制了这一点。

我试过用谷歌搜索它，但也无济于事。

编辑：

我是否正确使用了 varchar() 和/或 text() ？应该是别的吗？我看过一些 SO 帖子（找不到它们）说要使用 VarChar。

作为记录，我正在使用 mysql WorkBench 进行插入/选择，如果这有什么不同的话。

编辑2：

这里有两条记录：

```
client_id (PK, AI, INT, UNSIGNED), email (varchar(500), not null) 
```

的表中`client_login`。

```
client_id = 1, email = 'test@gmail.com' 
```

和

```
client_id = 2, email = 'test@gmailcom' 
```

以下选择

```
select * from client_login where email='test@gmail.com' 
```

返回 0 行

```
select * from client_login where email='test@gmailcom' 
```

返回 1 行

编辑 3：

我也可以

```
select * from client_login where client_id=1 
```

它会向我显示 所在的行`email = 'test@gmail.com'`，这很奇怪，因为就好像句号在行中，但实际上不是句号...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T01:36:57.000

坦率地说，我不相信问题是如上所述。

[这是您在 SQLFiddle 中运行](http://sqlfiddle.com/#!2/d020d/1)的“问题” ，表明它运行良好。

我认为电子邮件栏中的数据不是你想象的那样，尤其是“点”字符。
尝试使用手动输入的数据对其进行更新。

* * *

[`HEX()`](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_hex)为了帮助调试此问题，请尝试使用以下函数将列值输出为十六进制：

```
select HEX(email) 
```

并仔细检查输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:31:55.597

尝试更改服务器的SQL模式

[http://dev.mysql.com/doc/refman/5.0/en/server-sql-mode.html](http://dev.mysql.com/doc/refman/5.0/en/server-sql-mode.html)

# java - 小程序 - KeyListener 不工作

> ID：13595208
> 
> 赞同：0
> 
> 时间：2012-11-27T23:37:33.527
> 
> 标签：java, applet, awt, keylistener

当我启动我的小程序时，我没有得到关键监听器的响应。我该如何解决？下面是代码。

```
import java.applet.Applet;
import java.awt.Graphics;
import java.awt.event.KeyAdapter;
import java.awt.event.KeyEvent;
import java.util.Timer;
import java.util.TimerTask;

public class Main extends Applet {
private static final long serialVersionUID = 1L;
public String mode = "";
public Graphic gr;

public void init() {
    this.setSize(400, 400);
    gr = new Graphic();
    this.add(gr);
    gr.addKeyListener(new MyKeyListener());
    TimerTask timerTask = new TimerTask() {

        @Override
        public void run() {
                    gr.requestFocus();
            gr.repaint();
        }

    };
    new Timer().scheduleAtFixedRate(timerTask, 0, 1000 / 5);

}

public void paint(Graphics g) {

}

private class MyKeyListener extends KeyAdapter {
    public MyKeyListener(){
        System.out.println("HELLO");
    }
    public void keyPressed(KeyEvent e) {

        switch (e.getKeyCode()) {
        case KeyEvent.VK_UP:
            gr.direction = Graphic.Direction.up;
            gr.move();

            break;
        case KeyEvent.VK_DOWN:
            gr.direction = Graphic.Direction.down;
            gr.move();
            break;
        case KeyEvent.VK_LEFT:
            gr.direction = Graphic.Direction.left;
            gr.move();
            break;
        case KeyEvent.VK_RIGHT:
            gr.direction = Graphic.Direction.right;
            gr.move();
            break;
        }
    }

    public void keyReleased(KeyEvent e) {

    }
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:50:39.990

```
 import java.applet.Applet;
import java.awt.Graphics;
import java.awt.Shape;
import java.awt.event.KeyAdapter;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;

public class TTest extends Applet{
    @Override
    public void init() {
        // TODO Auto-generated method stub
        super.init();
        this.setSize(400, 400);
        addKeyListener(new KeyListener());

    }
    class KeyListener extends KeyAdapter{
        public KeyListener(){

        }

        @Override
        public void keyPressed(KeyEvent e) {
            // TODO Auto-generated method stub
            super.keyPressed(e);
            switch(e.getKeyCode()){
            case KeyEvent.VK_UP:
                System.out.println("Pressed up arrow!");
                break;
            case KeyEvent.VK_DOWN:
                System.out.println("Pressed down arrow!");
                break;
            default:
                System.out.println("You pressed: " + e.getKeyCode());
            }
        }

    }
} 
```

您必须将键事件侦听器添加到小程序本身而不是图形对象。但是，我认为可以将鼠标事件侦听器添加到小程序以外的对象

# php - Apache 始终提供 DocumentRoot index.php

> ID：13595215
> 
> 赞同：0
> 
> 时间：2012-11-27T23:38:01.230
> 
> 标签：php, apache

这可能是一个新手问题，但是......我在 Apache 中配置了一个 SSL 站点，如下所示：

```
NameVirtualHost *:443

<VirtualHost *:443>
    ServerName dev.wonnova.com
    DocumentRoot "/var/www/myapp/wwwroot"

    SSLEngine on

    SSLProtocol -all +TLSv1 +SSLv3
    SSLCipherSuite HIGH:MEDIUM:!aNULL:+SHA1:+MD5:+HIGH:+MEDIUM

    SSLCertificateFile /etc/apache2/ssl/mycert.crt
    SSLCertificateKeyFile /etc/apache2/ssl/mycert.key

    <IfModule mime.c>
        AddType application/x-x509-ca-cert      .crt
        AddType application/x-pkcs7-crl         .crl
    </IfModule>

    Alias /mydir/ "/var/www/myapp/mydir"

    <Directory "/var/www/myapp/mydir">
        SSLRequireSSL
        Options Indexes FollowSymLinks Includes ExecCGI
        AllowOverride all
        Order allow,deny
        Allow from all
    </Directory>
</VirtualHost> 
```

问题是，无论我请求哪个 URL，我总是得到 /var/www/myapp/wwwroot/index.php 的内容（即`DocumentRoot`目录中的 index.php）。例如，这些 URL 会发生这种情况：

```
 - https://mysite/index.php
 - https://mysite/mydir/index.php
 - https://mysite/mydir/style.css
 - https://mysite/mydir/script.js 
```

另一方面，如果我在 DocumentRoot 目录中创建一个 index2.php 文件，它会正确显示：

```
 - https://mysite/index2.php 
```

我想我的 Apache 配置有问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T22:40:08.727

我解决了这个问题，我必须删除 Alias 行第一部分的最后一个斜杠。

这是错误的：

```
Alias /mydir/ "/var/www/myapp/mydir" 
```

这是正确的：

```
Alias /mydir "/var/www/myapp/mydir" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:29:32.830

首先，您可以从别名中删除撇号（我认为您的做法是对的）。更改主站点的配置：

```
Alias /mydir/ "/var/www/myapp/mydir"

    <Directory "/var/www/myapp/mydir">
        SSLRequireSSL
        Options Indexes FollowSymLinks Includes ExecCGI
        AllowOverride all
        Order allow,deny
        Allow from all
    </Directory> 
```

至：

```
Alias  /mydir /var/www/myapp/mydir
    <Directory /var/www/myapp/mydir>
         SSLRequireSSL
         Allow From all
         Options +Indexes FollowSymLinks Includes ExecCGI
         AllowOverride all 

     </Directory> 
```

您还需要转到 /var/www/myapp/ 并编辑 .htaccess 并将其更改为：

```
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /mydir/
  RewriteRule ^index\.php$ - [L]
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule . /mydir/index.php [L]
</IfModule> 
```

我假设您在别名指向的 /var/www/myapp/mydir 中有一个 DirectoryIndex 文件（例如 index.php）。让我知道它是否有效

# javascript - 如何在动力学 js 中获得虚线边框？

> ID：13595217
> 
> 赞同：-1
> 
> 时间：2012-11-27T23:38:01.353
> 
> 标签：javascript, html, canvas, kineticjs

我只是在我的 Kinetic.Text() 对象周围寻找一个简单的虚线边框。我在[文档](http://www.html5canvastutorials.com/kineticjs/html5-canvas-kineticjs-line-tutorial/)中看到可以将线条设为破折号，但不清楚如何将其应用于另一个元素（如 Text）的边框。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T06:23:29.720

实际上这是很有可能的，只需将文本和与文本接壤的虚线组合在一起即可。有点像这样：

```
var group = new Kinetic.Group();
var text = new Kinetic.Text(...);
var border = new Kinetic.Line({
  dashArray: [...]
  points: [...]
});

group.add(text);
group.add(border); 
```

虚线示例：[http ://www.html5canvastutorials.com/kineticjs/html5-canvas-kineticjs-line-tutorial/](http://www.html5canvastutorials.com/kineticjs/html5-canvas-kineticjs-line-tutorial/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:07:25.463

git-hub 源在 text 类上没有显示 'dashArray' 属性，就像 line 类一样。所以我认为这是不可能的：/

[https://github.com/ericdrowell/KineticJS/blob/master/src/shapes/Line.js](https://github.com/ericdrowell/KineticJS/blob/master/src/shapes/Line.js)

[https://github.com/ericdrowell/KineticJS/blob/master/src/shapes/Text.js](https://github.com/ericdrowell/KineticJS/blob/master/src/shapes/Text.js)

# php - 这个 php switch 语句中的什么破坏了我的代码？

> ID：13595221
> 
> 赞同：0
> 
> 时间：2012-11-27T23:38:30.137
> 
> 标签：php, arrays, switch-statement

此代码片段只是较大 php 文件的一小部分。目前，该文件在运行时不产生任何结果（适合 PHP），但是当我注释掉本节（如下）时，该文件将执行。因此，我只能相信这段代码片段中的某些东西会阻止 PHP 正常运行。也许是嵌套的 switch 语句？

```
switch($interval)
{
    case "week":

        $active_date = date('N', $endTime);

        switch($active_date)
        {
            case 1:
                $categories = ["Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday","Monday"];
                break;
            case 2:
                $categories = ["Wednesday","Thursday","Friday","Saturday","Sunday","Monday","Tuesday"];
                break;
            case 3:
                $categories = ["Thursday","Friday","Saturday","Sunday","Monday","Tuesday","Wednesday"];
                break;
            case 4:
                $categories = ["Friday","Saturday","Sunday","Monday","Tuesday","Wednesday","Thursday"];
                break;
            case 5:
                $categories = ["Saturday","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday"];
                break;
            case 6:
                $categories = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
                break;
            case 7:
                $categories = ["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];
                break;
        }
        break;
    case "month":
        $categories = ["Three Weeks Ago","Two Weeks Ago","Last Week","This Week"];
        break;
    case "year":

        $active_date = date('n', $endTime);

        switch($active_date)
        {
            case 1:
                $categories = ["February","March","April","May","June","July","August","September","October","November","December","January"];
                break;
            case 2:
                $categories = ["March","April","May","June","July","August","September","October","November","December","January","February"];
                break;
            case 3:
                $categories = ["April","May","June","July","August","September","October","November","December","January","February","March"];
                break;
            case 4:
                $categories = ["May","June","July","August","September","October","November","December","January","February","March","April"];
                break;
            case 5:
                $categories = ["June","July","August","September","October","November","December","January","February","March","April","May"];
                break;
            case 6:
                $categories = ["July","August","September","October","November","December","January","February","March","April","May","June"];
                break;
            case 7:
                $categories = ["August","September","October","November","December","January","February","March","April","May","June","July"];
                break;
            case 8:
                $categories = ["September","October","November","December","January","February","March","April","May","June","July","August"];
                break;
            case 9:
                $categories = ["October","November","December","January","February","March","April","May","June","July","August","September"];
                break;
            case 10:
                $categories = ["November","December","January","February","March","April","May","June","July","August","September","October"];
                break;
            case 11:
                $categories = ["December","January","February","March","April","May","June","July","August","September","October","November"];
                break;
            case 12:
                $categories = ["January","February","March","April","May","June","July","August","September","October","November","December"];
                break;
        }
        break;
} 
```

知道这有什么不正确的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:52:28.260

感谢您的回复，有人提示我尝试使用 array() 语法而不是 [ ] 语法，这似乎使代码正常工作。所以我现在假设这是一个解决方案。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-11-27T23:42:44.953

删除每个案例的最后一个 Breaks：

```
switch($interval)
{case "week":

    $active_date = date('N', $endTime);

    switch($active_date)
    {
        case 1:
            $categories = ["Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday","Monday"];
            break;
        case 2:
            $categories = ["Wednesday","Thursday","Friday","Saturday","Sunday","Monday","Tuesday"];
            break;
        case 3:
            $categories = ["Thursday","Friday","Saturday","Sunday","Monday","Tuesday","Wednesday"];
            break;
        case 4:
            $categories = ["Friday","Saturday","Sunday","Monday","Tuesday","Wednesday","Thursday"];
            break;
        case 5:
            $categories = ["Saturday","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday"];
            break;
        case 6:
            $categories = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
            break;
        case 7:
            $categories = ["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];
    }
    break;
case "month":
    $categories = ["Three Weeks Ago","Two Weeks Ago","Last Week","This Week"];
    break;
case "year":

    $active_date = date('n', $endTime);

    switch($active_date)
    {
        case 1:
            $categories = ["February","March","April","May","June","July","August","September","October","November","December","January"];
            break;
        case 2:
            $categories = ["March","April","May","June","July","August","September","October","November","December","January","February"];
            break;
        case 3:
            $categories = ["April","May","June","July","August","September","October","November","December","January","February","March"];
            break;
        case 4:
            $categories = ["May","June","July","August","September","October","November","December","January","February","March","April"];
            break;
        case 5:
            $categories = ["June","July","August","September","October","November","December","January","February","March","April","May"];
            break;
        case 6:
            $categories = ["July","August","September","October","November","December","January","February","March","April","May","June"];
            break;
        case 7:
            $categories = ["August","September","October","November","December","January","February","March","April","May","June","July"];
            break;
        case 8:
            $categories = ["September","October","November","December","January","February","March","April","May","June","July","August"];
            break;
        case 9:
            $categories = ["October","November","December","January","February","March","April","May","June","July","August","September"];
            break;
        case 10:
            $categories = ["November","December","January","February","March","April","May","June","July","August","September","October"];
            break;
        case 11:
            $categories = ["December","January","February","March","April","May","June","July","August","September","October","November"];
            break;
        case 12:
            $categories = ["January","February","March","April","May","June","July","August","September","October","November","December"];
    }
} 
```

# html - 如何修复在实时浏览器中动画完成之前重新启动循环的 adobe edge html5 动画？

> ID：13595231
> 
> 赞同：1
> 
> 时间：2012-11-27T23:39:52.097
> 
> 标签：html, animation, loops, joomla, adobe-edge

我用 Edge Animate 制作了一个动画横幅广告，并将其嵌入到我的网站中。当循环广告播放时，它会提前结束，然后重新开始。每次广告播放时，都会播放更多的动画，然后再停止并重新开始。例如，第一次播放可能会到达 30 秒广告的 22 秒。然后第二次将达到 27 秒。最终整个广告可能会播放 4 次。

Edge 和浏览器中的预览始终正确循环。只有当广告嵌入网站时。

我使用的代码非常简单，我怀疑可能是问题所在（如果这是一个新手/显而易见的解决方案问题，我非常抱歉，我根本不是编码员）

sym.play(0);

该触发器位于时间轴上的 30 秒标记处，这是我希望广告明显循环的时间。

它在 joomla 网站上嵌入 iframe。我正在使用最新的 Edge Animate 版本。已发布广告的整个文件大小约为 512kb。

有没有人知道为什么它的循环不正确？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T20:28:48.267

由于它在预览和浏览器中按照您希望的方式工作，因此问题似乎与嵌入有关。

显然，将 adobe edge 与 joomla 一起使用时会出现很多问题。您可以按照此处的建议尝试无冲突模式：

[http://www.search-friendly-web-design.com/general/72-playing-with-adobe-edge-and-getting-the-output-into-a-joomla-site](http://www.search-friendly-web-design.com/general/72-playing-with-adobe-edge-and-getting-the-output-into-a-joomla-site)

另一种选择是手动将边缘组合的组件（包括 js 文件的链接）添加到 html 文件中。

# ruby - 红宝石双峰与指数比较

> ID：13595233
> 
> 赞同：2
> 
> 时间：2012-11-27T23:39:56.010
> 
> 标签：ruby, arrays, compare

谁能帮我完成这项工作？

```
array.each_with_index do |buffer,index|

    if array[index][8] == array[1..7][8]
      puts "match found"
    end
end 
```

我想比较是否有双峰，但是如何将搜索范围定义为我的数组索引值，从 1 到 7，除了索引？

只是为了说清楚我想比较`array[1][8],[2][8],[3][8]`等等，除了`[index][8]`

谢谢4你的帮助...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:06:14.480

```
ar =  [1,2,8,4,5,6,7,8]
last = ar.last
puts "match found" if ar[0..-2].any?{|el| el == last} # => match found 
```

困难的部分也许是`ar[0..-2]`位。`ar[1..-1]`会导致数组从第二个元素切到末尾；`ar[0..-2]`将所有内容从头到尾减去一。请注意，在找到一个匹配项后退出。以下代码计算匹配项：

```
ar =  [1,2,8,4,5,6,7,8]
puts "found #{ar[0..-2].count(ar.last)} matches." 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T01:36:01.540

你想数双胞胎吗？

```
array[0..-2].find_all{|el| el == array.last}.length 
```

或者你想要每个双峰的索引值？

```
hash = Hash.new { |h,k| h[k] = [] }

array[0..-2].each_with_index do |el, idx|
  hash[el] << idx if el == array.last
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T07:08:12.070

你有一个数组数组，不是吗？并且您想检查第 index 个数组的第 8 个值是否有双精度数？

```
array.map{|a| a[8]}.count(array[index][8]) > 1 
```

要检查最后一个元素是否在数组中重复，请执行以下操作：

```
array[0...-1].include? array.last 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T07:25:06.650

您可以使用`group_by`创建任何双峰组：

```
array.group_by {|v| v[8] } 
```

这会给你一个`{"group key" => ["group", "members"]}`.

要获取所有双峰的列表，只需选择具有多个成员的组：

```
array.group_by {|v| v[8] }.values.select {|g| g.length > 1 } 
```

此外，要从列表中消除任何双峰：

```
array.group_by {|v| v[8] }.values.map(&:first) 
```

这将返回一个新数组，其中消除了任何双峰，因此仅返回任何给定双峰中的第一项。

```
array = [
  %w(1 2 3 4 5 6 7 8 9),
  %w(1 2 3 4 5 6 7 8 9),
  %w(a b d e f g h i j),
  %w(a b d e f g h i j),
  %w(j k l m n o p q r)
]

pp array.group_by {|v| v[8] }.values.map(&:first)

# Output:
# [["1", "2", "3", "4", "5", "6", "7", "8", "9"],
# ["a", "b", "d", "e", "f", "g", "h", "i", "j"],
# ["j", "k", "l", "m", "n", "o", "p", "q", "r"]] 
```

# php - 如何使用 php 以编程方式创建 ssl 证书？

> ID：13595237
> 
> 赞同：1
> 
> 时间：2012-11-27T23:40:25.627
> 
> 标签：php, ssl, openssl

我正在寻找一种从 php 创建 ssl 证书的方法。

我在磁盘上有 openssl.cnf 和私钥并且可以访问。

一种选择是执行 shell 脚本，但我想知道是否有办法直接从 php.ini 执行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T23:50:52.170

[openssl_csr_new](http://php.net/manual/en/function.openssl-csr-new.php)

注意：作为要求，您必须拥有 openssl.cnf

# android - 在 Robotium 中按下一个或完成键

> ID：13595238
> 
> 赞同：2
> 
> 时间：2012-11-27T23:41:02.970
> 
> 标签：android, functional-testing, robotium

我刚刚遇到了 Robotium 的障碍，试图通过功能测试重现错误。在登录期间从用户名字段移动到密码字段时，我的活动未设置为正确处理“下一个”键。我在谷歌上搜索了一下，我无法找到解决方案。我在我的 Galaxy Nexus 上试过这个：

```
 solo.clearEditText(0);
    solo.enterText(0, Constants.TEST_ACCOUNT_1.getUsername());
    solo.clickOnEditText(0);
    solo.clickOnScreen(672,1132);
    solo.clickOnEditText(0);
    solo.sleep(15000);
    solo.enterText(1, Constants.TEST_ACCOUNT_1.getPassword()); 
```

这个想法是在文本字段中单击以提高键盘然后尝试单击下一个按钮但是在编辑文本字段中的单击不会提高键盘。我也尝试过发送回车键，并尝试使用 FLAG_EDITOR_ACTION 发送回车键，但它们都没有模拟“下一个”键。帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-14T18:49:55.200

Robotium 似乎没有显示键盘的方法。此外，键盘似乎超出了 Robotium 可以交互的范围，`clickOnText()`即使它是可见的，也不会按下软键盘按钮。因此，这个答案将是一个黑客攻击。

解决方案有两个重要部分。首先，虽然我们不能`dispatchKeyEvent`像使用其他键盘按钮那样直接单击 IME Next 按钮，但我们可以使用 触发它的回调`EditText.onEditorAction(EditorInfo.IME_ACTION_NEXT)`。这将允许我们跳到下一个 EditText。其次，触发这个回调属于“与UI交互”的范畴，所以我们必须从运行Robotium的线程移回主线程进行调用。我们将使用它`Activity.runOnUiThread()`来实现这一点。

这是它如何为我工作的示例：

```
public void testImeNext() throws Exception
{
    //Grab a reference to your EditText.  This code grabs the first Edit Text in the Activity
    //Alternatively, you can get the EditText by resource id or using a method like getCurrentEditTexts()
    //Make sure it's final, we'll need it in a nested block of code.
    final EditText editText = solo.getEditText(0);

    //Create a runnable which triggers the onEditorAction callback
    Runnable runnable = new Runnable() 
    {
        @Override
        public void run() 
        {
            editText.onEditorAction(EditorInfo.IME_ACTION_NEXT);
        }
    };

    //Use Solo to get the current activity, and pass our runnable to the UI thread.
    solo.getCurrentActivity().runOnUiThread(runnable);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-10-08T17:04:00.733

在另一个答案的基础上，我编写了一个模拟 IME 按钮按下的方法，并且在 UI 线程上的请求完成之前不会返回。

```
/**
 * This will send the NEXT action to simulate pressing next on the keyboard.
 * Because it has to be run on the UI thread we use a barrier to block and
 * stop this request returning until the action is complete.
 **/
private void sendIMENext(final EditText editText) throws Exception {
    final CyclicBarrier barrier = new CyclicBarrier(2);

    Runnable runnable = new Runnable() {
        @Override
        public void run() {
            editText.onEditorAction(EditorInfo.IME_ACTION_NEXT);

            try {
                barrier.await();
            }
            catch (Exception e) {
                Log.e("MainActivityTest", "Interupted on UI thread pressing IME next", e);
            }
        }
    };

    //Use Solo to get the current activity, and pass our runnable to the UI thread.
    solo.getCurrentActivity().runOnUiThread(runnable);
    // Waits until the barrier is met in the runnable
    barrier.await();
} 
```

这应该总是返回，但如果你愿意，你可以为第二个*等待*添加超时。

# ios - UILabel - 缩小文本而不是截断尾部

> ID：13595239
> 
> 赞同：6
> 
> 时间：2012-11-27T23:41:16.743
> 
> 标签：ios, uilabel

我有一个 UILabel 设置，字体为系统粗体 14.0，最小字体大小为 12。我希望标签填充 7 行，如果太大，将文本缩小到 12 像素，在这种情况下可能会更多超过 7 行，但仍然适合它的原始框架。

我尝试将行数设置为 7 和 0。无论哪种方式，文本都会以默认大小 (14) 填充 7 行并截断尾部。我怎样才能让文本缩小到 12px 以便我可以看到更多文本？

（我会发布更多代码，但其中大部分是在 IB 中设置的）。

编辑：我将 Autoshrink 选项设置为“最小字体大小”，大小为 12。即使我将其设置为明显的 8，也不会发生收缩。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T23:46:53.643

检查与

```
sizeWithFont:minFontSize:actualFontSize:forWidth:lineBreakMode:

[labelText sizeWithFont:labelFont 
                  minFontSize:12.0 
                  actualFontSize:&returnFontSize 
                  forWidth:frame.size.width 
                  lineBreakMode:UILineBreakModeWordWrap]; 
```

有关更多详细信息[，请查看 Apple 文档以获取`NSString`](http://developer.apple.com/library/ios/documentation/uikit/reference/NSString_UIKit_Additions/Reference/Reference.html#//apple_ref/occ/instm/NSString/sizeWithFont%3aminFontSize%3aactualFontSize%3aforWidth%3alineBreakMode%3a). 还有一些其他的便捷方法也可用于`NSString`.

**更新：** 根据您的编辑，解决您的问题的方法是设置以下属性，

```
label.adjustsFontSizeToFitWidth = YES; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-02-16T11:31:42.087

您可以使用`.adjustsFontSizeToFitWidth=YES`它来调整字体大小以适合标签的宽度。例如，如果您有一个标签，`numberOfLines=2`并且文本太长，则标签的字体大小将减小以适合所有文本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T00:32:08.483

所以显然自动收缩、最小字体大小等仅适用于 1 行 UILabel。我在[这里](http://www.11pixel.com/blog/28/resize-multi-line-text-to-fit-uilabel-on-iphone/)找到了一个解决方案，尽管如果你能在 IB 或 UILabel API 中处理这个问题会很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-10T16:38:14.187

对于仍在寻找的任何人，似乎字体大小不会缩放，除非`lineBreak = "Truncate Tail"` 我猜 UILabel 不知道它需要调整文本大小，直到它尝试截断。

因此，要达到预期的效果，请使用以下内容（使用您希望的任何字体大小和行数）：

```
Font Size: 14
Lines: 2
Automatically Adjusts Font Size: true
Auto Shrink: "Minimum font size"
Minimum Font Size: 8
Line Break: "Truncate Tail" 
```

[![在此处输入图像描述](../Images/08819a006c731f9b476b2d751a806b41.png)](https://i.stack.imgur.com/F8Xvp.png) [![在此处输入图像描述](../Images/91da9f964ba0288d23c7fcd10fa6d3dd.png)](https://i.stack.imgur.com/sr7X6.png)

请记住，如果使用这种方法，即使在最小字体大小的情况下视图的文本太多，它最终也会使尾部椭圆化。

# ios - 如何在主从 ios 应用程序中保存详细视图的状态？

> ID：13595240
> 
> 赞同：1
> 
> 时间：2012-11-27T23:41:16.847
> 
> 标签：ios, iphone, xcode, ipad

我有一个主细节应用程序，对于主视图中的每个单元格，我想要一个独特的细节视图。我认为我能做什么是在退出视图时保存详细视图的状态，然后选择其他单元格以某种方式访问​​保存的数据以供该视图访问并在详细信息视图上显示。详细视图上唯一的对象类型是文本视图和图像视图。我该怎么做呢？有没有更好的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:59:02.977

如果主详细信息视图类似于设置页面，那么您可以将该数据保存在`NSUserDefaults`

=> 设置值：

```
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
[defaults setValue: @"some_value" forKey: @"some_setting"];
[defaults synchronize]; 
```

=> 要检索值：

```
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
self.label1.text = [defaults stringForKey: @"some_setting"]; 
```

* * *

您可以使用`Model`以下类似：

```
Model - A common class that remembers all the settings/configurations
Master VC - Do some changes and store those changes in the Model
Detail VC - Access the Model and display cells accordingly 
```

# javascript - jquery 将脚本动态附加到 html 元素

> ID：13595250
> 
> 赞同：1
> 
> 时间：2012-11-27T23:42:16.030
> 
> 标签：javascript, jquery

我需要将更多项目（视频。以脚本形式）动态添加到 div。在下面的代码中， append 没有做任何事情。我也尝试以字符串形式附加脚本（即“”）。我感谢任何帮助！！！！

```
<!DOCTYPE html>
<html>
<head>
  <script src="http://code.jquery.com/jquery-latest.js"></script>
</head>
<body>

  <div>
      <script type="text/javascript" src="http://video.foxnews.com/v/embed.js?id=1993203907001&w=466&h=263"></script>
  </div>

<script>
$(document).ready(function() {
var script = document.createElement( 'script' );
script.type = 'text/javascript';
script.src = 'http://video.foxnews.com/v/embed.js?id=1993203907001&w=466&h=263';
  $("div").append(script);
});
</script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:57:35.010

jQuery`<script />`以特殊方式处理标签（[.append()](http://jsapi.info/jquery/1.8.0/jQuery.fn.append) -> [.domManip()](http://jsapi.info/jquery/1.8.0/jQuery.fn.domManip)）
只需使用 DOM 方法`.appendChild()`代替

```
document.getElementsByTagName('div')[0].appendChild(script);​ 
```

阅读[此答案](https://stackoverflow.com/a/3603496/402037)以更深入地了解*原因*？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T23:53:29.630

> [不安全的 JavaScript 尝试从 URL http://video.foxnews.com/v/video-embed.html?video_id](http://video.foxnews.com/v/video-embed.html?video_id=1993203907001&w=466&h=263&loc=)的框架访问具有 URL file:///C:/Users/###/Desktop/test.html 的框架[=1993203907001&w=466&h=263&loc=](http://video.foxnews.com/v/video-embed.html?video_id=1993203907001&w=466&h=263&loc=)。域、协议和端口必须匹配。

您尝试从不同的域访问某些内容 => XSS

[http://en.wikipedia.org/wiki/Cross-site_scripting](http://en.wikipedia.org/wiki/Cross-site_scripting)

并且

[https://support.ookla.com/entries/21097566-what-is-crossdomain-xml-and-why-do-i-need-it](https://support.ookla.com/entries/21097566-what-is-crossdomain-xml-and-why-do-i-need-it)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-27T23:52:00.887

尝试替换此行

```
$("div").append(script); 
```

有了这个

```
document.getElementsByTagName('div')[0].appendChild(script);​ 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/hLcVC/1/)**

本机`.appendChild`方法似乎正在工作，但 jQuery`.append()`由于某种原因似乎没有工作..

# mpmovieplayercontroller - mpmovieplayercontroller 从后台加载新的音频 url

> ID：13595252
> 
> 赞同：0
> 
> 时间：2012-11-27T23:42:28.527
> 
> 标签：mpmovieplayercontroller

我有一个 MPMoviePLayerController，它可以从解析为数组的 xml 播放列表中连续 http 流式传输音频文件。

问题是当一首歌曲正在播放时，手机被锁定，它继续播放歌曲，支持背景音频等等，直到歌曲结束....但是打电话时：

```
- (void) moviePlayBackDidFinish:(NSNotification*)notification {...} 
```

我调用函数来加载下一首曲目

```
- (void) LoadTrack:(int)indexToPlay {

    //use the generic APIContentObject.
    APIContentObject *currentTrack = [playlist objectAtIndex:indexToPlay];
    NSLog(@"%@",[currentTrack SluggedURL]);

    //get url
    NSURL *url=[NSURL URLWithString:[currentTrack FileURL]];

    //moviePlayer = [[MPMoviePlayerController alloc] initWithContentURL:url];
    if (!moviePlayer){

        moviePlayer = [[MPMoviePlayerController alloc] initWithContentURL:url];

    }else{

        //moviePlayer = nil;
        //moviePlayer = [[MPMoviePlayerController alloc] initWithContentURL:url];

        //moviePlayer = [[MPMoviePlayerController alloc] initWithContentURL:url];
        //[moviePlayer initWithContentURL:url];
        [moviePlayer setContentURL:url];        
        moviePlayer.shouldAutoplay = YES;
        [moviePlayer prepareToPlay];
        [moviePlayer play];
    }
    ... 
```

它不会加载曲目并在输出中为我提供以下信息：

```
[MPCloudAssetDownloadController] Prioritization requested for media item ID: 0 
```

正如您从注释行中看到的那样，我尝试了多种方法来解决这个问题。其中没有一个真正播放下一首歌曲。是因为背景音频需要恒定流吗？我不能这样做吗？

我们有一个 CMS，用户可以在其中更改他们的播放列表，因此它需要在后台进行 mp3->-mp3 桥接。

播放当前歌曲很好，但为什么不加载新歌曲？

还是网络请求不被视为“背景音频”的一部分？

非常欣赏它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T17:20:16.500

我终于意识到我无法在后台启动任何新的 URL 连接。我需要切换到 m3u 风格的播放列表并使用点播媒体服务器来完成我想做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T19:13:40.803

确保将 info.plist 文件中的 UIBackgroundModes 键设置为“音频”。这将允许您的应用程序在后台仍然执行代码。

这是文档以防万一。链接：[检查此链接并滚动到：“声明您的应用支持的后台任务”](http://developer.apple.com/library/ios/#documentation/iphone/conceptual/iphoneosprogrammingguide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html)

我对 mpmovieplayercontroller 有自己的问题，在寻求帮助时我找到了你的帖子。

我目前正在使用 mpmovieplayercontroller 播放音频，当歌曲结束时（moviePlayBackDidFinish），我向服务器询问下一首歌曲的 url。然后播放那首歌..冲洗并重复。当屏幕被锁定时它工作正常（这意味着当应用程序在后台并且屏幕被锁定时它*正在启动一个 url 连接）。*

# liferay - 为 Liferay 6.1.1 CE 创建 OpenXava 4.6 portlet

> ID：13595258
> 
> 赞同：1
> 
> 时间：2012-11-27T23:43:11.740
> 
> 标签：liferay, portlet, openxava

我在 OpenXava 4.6 中创建了一个 portlet。但是一旦部署在 Liferay 6.1.1 CE GA 下，它就不能正常运行。

这些是问题：

a.) OX 4.5.1 和 4.6 创建的 web.xml 无法被 Liferay 6.1 识别

```
15:23:28,665 INFO [com.liferay.portal.kernel.deploy.auto.AutoDeployScanner][AutoDeployDir:182] Processing <..>.war. This is attempt 2.
15:23:28,673 INFO [com.liferay.portal.kernel.deploy.auto.AutoDeployScanner][PortletAutoDeployListener:77] Copying portlets for ../liferay-portal-6.1.1-ce-ga2/deploy/<..>.war
15:23:28,676 INFO [com.liferay.portal.kernel.deploy.auto.AutoDeployScanner][BaseDeployer:1674] ../liferay-portal-6.1.1-ce-ga2/deploy/<..>.war does not have a WEB-INF/liferay-plugin-package.xml or WEB-INF/liferay-plugin-package.properties
15:23:28,677 INFO [com.liferay.portal.kernel.deploy.auto.AutoDeployScanner][BaseDeployer:763] Deploying <..>.war
15:23:33,110 ERROR [com.liferay.portal.kernel.deploy.auto.AutoDeployScanner][AutoDeployDir:210] com.liferay.portal.kernel.deploy.auto.AutoDeployException: com.liferay.portal.kernel.deploy.auto.AutoDeployException: web.xml must be updated to the Servlet 2.4 specification 
```

b.) web.xml 文件需要有这个头：

```
<?xml version="1.0" encoding="UTF-8"?>

<web-app id=".." version="2.4" xmlns="http://java.sun.com/xml/ns/j2ee"
<http://java.sun.com/xml/ns/j2ee%5C>" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance\
<http://www.w3.org/2001/XMLSchema-instance%5C>"
xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee
http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd\
<http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd%5C>">

<display-name>...</display-name>
... 
```

c.) 即使在按照上述修改“web.xml”文件（并创建一个新的 WAR 文件）之后，Liferay 也能够加载 portlet，并且它出现在可用 portlet 列表中。但是 portlet 不起作用：

```
15:35:01,457 INFO [com.liferay.portal.kernel.deploy.auto.AutoDeployScanner][PortletAutoDeployListener:87] Portlets for ../liferay-portal-6.1.1-ce-ga2/deploy/<..>.war copied successfully. Deployment will start in a few seconds.
15:35:04,651 INFO  [pool-2-thread-2][HotDeployImpl:178] Deploying <..> from queue
15:35:04,653 INFO  [pool-2-thread-2][PluginPackageUtil:1033] Reading plugin package for <..>
15:35:04,653 WARN  [pool-2-thread-2][PluginPackageUtil:1131] Plugin package on context <..> cannot be tracked because this WAR does not contain a liferay-plugin-package.xml file 
```

d.) 我手动将文件“liferay-plugin-package.xml”添加到 WAR 文件中，但 Liferay 仍然没有正确显示 portlet。

欢迎任何建议。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T10:39:18.683

听起来您不是在使用 Liferay IDE 来创建 portlet，我建议您这样做，因为它确实有助于开发！( [Liferay IDE 安装指南](http://www.liferay.com/community/wiki/-/wiki/Main/Liferay+IDE+Installation+Guide)& [Liferay IDE 入门指南](http://www.liferay.com/community/wiki/-/wiki/Main/Liferay+IDE+Getting+Started+Tutorial))

请注意，您需要包含 liferay-plugin-package。**属性**、liferay-portlet.xml、portlet.xml、liferay-display.xml 和 web.xml 在您的 portlets docroot/WEB-INF 文件夹中。

每个文件的内容应*类似于*以下内容：

**web.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app id="WebApp_ID" version="2.4" xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd">
     <display-name>my-portlet</display-name>
    <jsp-config>
        <taglib>
            <taglib-uri>http://java.sun.com/portlet_2_0</taglib-uri>
            <taglib-location>
                    /WEB-INF/tld/liferay-portlet.tld
            </taglib-location>
         </taglib>
         <taglib>
            <taglib-uri>http://liferay.com/tld/aui</taglib-uri>
            <taglib-location>/WEB-INF/tld/aui.tld</taglib-location>
            </taglib>
    </jsp-config>   
</web-app> 
```

**liferay-display.xml**

```
<?xml version="1.0"?>
<!DOCTYPE display PUBLIC "-//Liferay//DTD Display 6.1.0//EN" "http://www.liferay.com/dtd/liferay-display_6_1_0.dtd">
<display>
    <category name="category.sample">
        <portlet id="my-portlet" />
    </category>
</display> 
```

**liferay-plugin-package.properties**

```
name=My Portlet
module-group-id=liferay
module-incremental-version=1
tags= 
short-description=
change-log=
page-url=http://www.liferay.com
author=Liferay, Inc.
licenses=LGPL
liferay-versions=6.1.1 
```

**liferay-portlet.xml**

```
<?xml version="1.0"?>
<!DOCTYPE liferay-portlet-app PUBLIC "-//Liferay//DTD Portlet Application 6.1.0//EN" "http://www.liferay.com/dtd/liferay-portlet-app_6_1_0.dtd">
<liferay-portlet-app>
    <portlet>
        <portlet-name>my-portlet</portlet-name>
        <icon>/icon.png</icon>
        <instanceable>false</instanceable>
        <header-portlet-css>/css/main.css</header-portlet-css>
        <footer-portlet-javascript>/js/main.js</footer-portlet-javascript>
    <css-class-wrapper>my-portlet</css-class-wrapper>
</portlet>
<role-mapper>
    <role-name>administrator</role-name>
    <role-link>Administrator</role-link>
</role-mapper>
<role-mapper>
    <role-name>guest</role-name>
    <role-link>Guest</role-link>
</role-mapper>
<role-mapper>
        <role-name>power-user</role-name>
        <role-link>Power User</role-link>
    </role-mapper>
    <role-mapper>
        <role-name>user</role-name>
        <role-link>User</role-link>
    </role-mapper>
</liferay-portlet-app> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T16:53:34.880

OpenXava 还不支持 Liferay 6.1，我们将为未来的 OX 版本添加 Liferay 6.1 支持。

然而，一些 OX 用户已经实现在 Liferay 6.1 上部署 OX 应用程序，只需更新 web.xml，看看 OpenXava 论坛中的下一个主题：

[https://sourceforge.net/p/openxava/discussion/419690/thread/79695196/](https://sourceforge.net/p/openxava/discussion/419690/thread/79695196/)

[https://sourceforge.net/p/openxava/discussion/419690/thread/da118e74/](https://sourceforge.net/p/openxava/discussion/419690/thread/da118e74/)

因此，我认为您的问题 d) 与其他问题有关。您是否已将 jta.jar 和 ejb.jar 复制到 Liferay 的 lib 文件夹中？你能把堆栈跟踪产生的 portlet 放在这里吗？

# matlab - 如何在matlab矩阵中扫描所有行但只扫描第一列

> ID：13595259
> 
> 赞同：0
> 
> 时间：2012-11-27T23:43:12.237
> 
> 标签：matlab, matrix, octave

我想扫描矩阵的所有行。取所有第一列或 x 列并将它们放入另一个新矩阵中。我怎样才能做到这一点 ？

下面的示例矩阵

```
 input_matrix_training={
{0.645569620253164,0.443037974683544,0.177215189873418,0.0253164556962025};
{0.620253164556962,0.379746835443038,0.177215189873418,0.0253164556962025};
{0.594936708860759,0.405063291139241,0.164556962025316,0.0253164556962025};
} 
```

例如，让我们扫描行并制作只有第一列的新矩阵

结果 ：`0.645569620253164, 0.620253164556962, 0.594936708860759`

谢谢你

matlab,矩阵

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:48:27.643

首先，你拥有的是一个细胞，这使它变得更加困难。如果可以，请输入如下数据：

```
input_matrix_training=[
  0.645569620253164 0.443037974683544 0.177215189873418 0.0253164556962025
  0.620253164556962 0.379746835443038 0.177215189873418 0.0253164556962025
  0.594936708860759 0.405063291139241 0.164556962025316 0.0253164556962025]; 
```

一旦你有了它，这很容易。

```
input_matrix_training(:,1) 
```

或第一行：

```
input_matrix_training(1,:) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T23:52:58.343

使用冒号运算符。在下面的示例中，`(:,1)`表示**所有行，第 1 列**。

取第一列：

`first_column = input_matrix_training(:,1);`

取第 2 到 4 列：

`two_to_four = input_matrix_training(:,2:4);`

取前 x 列：

```
x = 3;
first_x = input_matrix_training(:,1:x); 
```

# actionscript-3 - AS3 TypeError：错误 #1009：无法访问空对象引用的属性或方法。（按钮和 gotoAndPlay）

> ID：13595262
> 
> 赞同：-1
> 
> 时间：2012-11-27T23:43:18.370
> 
> 标签：actionscript-3, flash, button

我有一个 4 帧的场景。在第一帧上有两个按钮，`Instructions`和`Start`。`Instructions`引导我到第 4 帧，那里是指令，并`Start`带我到第 2 帧，那里是游戏。游戏结束后，我被带到第 3 帧，那里有一个显示主菜单的按钮，它应该将我重定向到主菜单。但是，主菜单按钮不起作用，原因`Error #1009`如标题所示。我提前为任何愚蠢道歉，因为这是我第一次使用 AS3。这是代码：

```
public function projectFinal()

    {
        startBtn.addEventListener(MouseEvent.CLICK, startGame);
        instructionBtn.addEventListener(MouseEvent.CLICK, instructions);
        stage.addEventListener(KeyboardEvent.KEY_DOWN, keyboardDown);
        stage.addEventListener(KeyboardEvent.KEY_UP, keyboardUp);
        specialTimer.addEventListener(TimerEvent.TIMER, spawnBonus);
        monsterTimer.addEventListener(TimerEvent.TIMER, moveMonsters);
        mainBtn.addEventListener(MouseEvent.CLICK, endGame);
        backBtn.addEventListener(MouseEvent.CLICK, goBack);
    }

    function startGame(event:MouseEvent):void 
    {
        gotoAndPlay(2);
        gameStarted = true;
        specialTimer.start();
        monsterTimer.start();
        spaceShip.score = 0;
        //createMonsterRow(monsterRow);

    }

    function instructions(event:MouseEvent):void
    {
        gotoAndPlay(4);
        trace ("pressed ins");
    }

    function endGame(event:MouseEvent):void
    {
        gotoAndPlay(1);
        trace("pressed main");
    }

    function goBack(event:MouseEvent):void
    {
        gotoAndPlay(1);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T01:16:15.637

如果每一帧都有 ActionScript 并且没有 stop(); 在代码中每一帧的末尾，应用程序只会从一帧跳到下一帧。放一个 stop(); 在 goBack 函数之后和所有其他帧上，看看是否有效。

# php - 将 javascript 代码放在 HTML 代码行中不起作用

> ID：13595264
> 
> 赞同：0
> 
> 时间：2012-11-27T23:43:29.900
> 
> 标签：php, javascript, html

JavaScript 不接受下面的代码，怎么了？

```
<a href="#" <?php if ($tagOn) {echo 'id="tagOn"' } else {echo 'id="tagOff"'  } ?>
  onclick="addToSearch('xyz')">Xyz</a> 
```

`$tagOn`是一个布尔值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T23:46:06.230

我认为如果你先定义变量会更清楚。如果您将过多的逻辑内联，它会变得混乱。

```
<?php $id = $tagOn ? "tagOn" : "tagOff"; ?>

<a href="#" "<?php echo $id ?> onclick="addToSearch('xyz')">Xyz</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:47:03.143

您忘记了每条语句后的分号，请尝试以下操作：

```
<a href="#" <?php if ($tagOn) { echo 'id="tagOn"'; } else { echo 'id="tagOff"';  }  ?>
  onclick="addToSearch('xyz')">Xyz</a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T23:47:20.087

*可能*只是缺少分号

```
<a href="#" <?php if ($tagOn) { echo 'id="tagOn"'; } else { echo 'id="tagOff"';  }  ?>
  onclick="addToSearch('xyz')">Xyz</a> 
```

一种更简洁的方法是使用三元运算符：

```
<a href="#" id=<?php echo ($tagOn) ? '"tagOn"' : '"tagOff"'; ?>
  onclick="addToSearch('xyz')">Xyz</a> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T23:47:41.657

你忘了分号！

```
<a href="#" <?php if ($tagOn) { echo 'id="tagOn"'; } else { echo 'id="tagOff"';  }  ?>
  onclick="addToSearch('xyz')">Xyz</a> 
```

# java - JPA 如何知道何时必须抛出 OptimisticLockException？

> ID：13595267
> 
> 赞同：0
> 
> 时间：2012-11-27T23:43:52.120
> 
> 标签：java, jpa

我想确认以下内容：

```
public void test() {

   SomeEntity se = em.find(SomeEntity.class, 1);

   // Do something...

   se.setField = "test";

} 
```

这里 JPA 将只对`se`.

下一个 ：

```
public void test() {

   SomeEntity se = em.find(SomeEntity.class, 1);
   SomeOtherEntity soe = em.find(SomeOtherEntity.class, 1);
   em.lock(soe, LockModeType.OPTIMISTIC);

   // Do something...

   se.setField = "test";

} 
```

`se`如果自上次读取后OR`soe`已更改（数据库中的版本增加），JPA 将在此处抛出 OptimisticException 。

真的吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-02-12T16:31:12.703

**仅当事务提交到您调用的数据库时才会抛出**OptimisticLockException**`em.flush()` - 然后 JPA 提供程序将比较版本字段并确定它已被另一个事务更改。**

# locking - 由其他人突破 CONTENT LOCK

> ID：13595270
> 
> 赞同：1
> 
> 时间：2012-11-27T23:43:58.617
> 
> 标签：locking

我有一个著名的网站，我们称之为`www.mywebsite.com`

有人故意预订了一个类似的域名，其中有拼写错误；`www.mywebste.com`并设置内容锁定，迫使人们填写调查表才能访问我的网站。

人们愚蠢地认为这是要求他们这样做的原始网站。

到处搜索以尝试找到一个可以突破这些内容阻止程序但无法解决的脚本。只有那些可用于突破 iframe。

# objective-c - 没有使用 ViewDeck 调用editingStyleForRowAtIndexPath

> ID：13595273
> 
> 赞同：3
> 
> 时间：2012-11-27T23:44:11.067
> 
> 标签：objective-c, ios

我一直在努力将滑动删除功能添加到`UITableView`我的应用程序中的普通文本中，但没有成功。

我有一个`UIViewController`包含唯一的 a `UITableView`，它使用基本单元格和自定义单元格。这`UIViewController`是在 a `UINavigationController`which is `centerViewController`of a之上[`IIViewDeckController`](https://github.com/Inferis/ViewDeck)

的委托和数据源`UITableView`设置正确，这是当前代码：

```
-(BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSLog(@"canEditRowAtIndexPath");
    return YES;
}

-(void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSLog(@"commitEditingStyle");
}

-(UITableViewCellEditingStyle)tableView:(UITableView *)tableView editingStyleForRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSLog(@"editingStyleForRowAtIndexPath");
    return UITableViewCellEditingStyleDelete;
}

- (void)tableView:(UITableView *)tv didEndEditingRowAtIndexPath:(NSIndexPath *)indexPath {
    NSLog(@"didEndEditingRowAtIndexPath");
} 
```

其他委托方法`cellForRowAtIndexPath`，如`canEditRowAtIndexPath` 和`didSelectRowAtIndexPath`被正确调用，但`editingStyleForRowAtIndexPath`从未在任何单元格上被调用。

**更新**

当我这样做`[table setEditing:YES animated:YES];`时，它确实启用了编辑模式。

这里可能缺少什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-01T18:43:47.273

`IIViewDeckController`问题是为了打开侧边栏而捕获的滑动事件。

By setting the `IIViewDeckController` `panningMode` to `IIViewDeckNavigationBarPanning` it removes this feature and therefore fix the issue with the `UITableView`.

# javascript - javascript本地存储视觉工作室

> ID：13595274
> 
> 赞同：1
> 
> 时间：2012-11-27T23:44:11.523
> 
> 标签：javascript, visual-studio-2010, local-storage

我创建了一个库来使本地存储更像数据库。我正在使用 Visual Studio 来测试这个库，它工作得很好，但是当我从 Visual Studio 调试时，一旦我停止调试，本地存储不会通过 Visual Studio 的另一次运行持久化（我有 VS 使用 IE 10 来启动页面）。

**从 Visual Studio 执行此操作时，有什么方法可以使其持久化，以便我可以更好地测试使用它的应用程序？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:48:23.193

是的，简单的解决方案是设置一个 IIS 实例，而不是使用它创建的虚拟服务器。在项目属性中指向该实例并告诉它不要在每次调试时启动应用程序。

它还使调试更快:-)，因为您可以在运行时保持浏览器窗口打开并刷新页面。（请记住强制清除缓存）

# asp.net-web-api - 在 asp.net mvc4 WebApi beta 升级后无法使用 FirstDispositionNameOrDefault

> ID：13595275
> 
> 赞同：1
> 
> 时间：2012-11-27T23:44:13.743
> 
> 标签：asp.net-web-api, wcf-web-api

我刚刚从 WebApi beta 升级到 NuGet 的最新 WebApi 包。我使用的 Visual Studio 项目的目标是 .NET 4.0 而不是 4.5。

我已经能够解决除一个以外的所有问题。我正在通过以下代码使用 Multipart Form 上传文件：

```
 // Verify that this is an HTML Form file upload request
        if (!Request.Content.IsMimeMultipartContent("form-data"))
        {
            throw new HttpResponseException(HttpStatusCode.UnsupportedMediaType);
        }

        var task = Request.Content.ReadAsMultipartAsync();

        var dateField = task.Result.FirstDispositionNameOrDefault("expireby");

        if (dateField == null)
        {
            return this.SendResponse(HttpStatusCode.BadRequest, ":dateNotFound:");
        }

        var dateFieldValue = dateField.ReadAsStringAsync().Result;

        if (!DateTime.TryParse(dateFieldValue, out expireBy))
        {
            return this.SendResponse(HttpStatusCode.BadRequest, ":invalidDateFormat:");
        } 
```

方法 FirstDispositionNameOrDefault 不再编译，我收到以下错误：

> “System.Net.Http.MultipartMemoryStreamProvider”不包含“FirstDispositionNameOrDefault”的定义，并且没有扩展方法“FirstDispositionNameOrDefault”接受“System.Net.Http.MultipartMemoryStreamProvider”类型的第一个参数（您是否缺少 using 指令还是汇编参考？）

谷歌没有返回任何相关结果。有人可以提供有关此问题的见解吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T06:23:44.350

确实，您在代码中使用的 API 在 Beta 之后发生了更改。它旨在解决以下问题：[http ://aspnetwebstack.codeplex.com/workitem/53](http://aspnetwebstack.codeplex.com/workitem/53)

这是更改集[http://aspnetwebstack.codeplex.com/SourceControl/changeset/8fda60945d49](http://aspnetwebstack.codeplex.com/SourceControl/changeset/8fda60945d49)

如果一些额外的说明有帮助，这里是[http://www.asp.net/web-api/overview/working-with-http/sending-html-form-data,-part-2](http://www.asp.net/web-api/overview/working-with-http/sending-html-form-data,-part-2)

问候，特洛伊

# flyway - 输出 SQL 增量脚本

> ID：13595278
> 
> 赞同：2
> 
> 时间：2012-11-27T23:44:25.250
> 
> 标签：flyway

最新版本是否允许 flyway 将所有迁移 SQL 保存在 delta 脚本中，而不是在数据库中运行它们？这是许多其他工具（liquibase、dbdeploy 等）都有的有用功能。

有一个工具自动应用非生产数据库中的更改是非常好的，但我希望在生产环境中有更多的控制权。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T18:39:43.490

谢谢阿克塞尔。这应该在大多数情况下都有效。但是，一些公司可能要求将脚本交给发布工程师才能在生产中运行。因此，如果我们可以选择简单地将所有 SQL 重定向到 delta 脚本，那就太好了。

命令行工具是否支持所有功能？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T07:37:09.750

**不，它没有。**它也不会像其他工具那样相关，因为**输入格式**（带有可选占位符的 SQL）与输出格式（不带占位符**的 SQL）非常相似。**

要知道会发生什么，您还可以使用**flyway.info()**来显示**挂起的迁移**。

您还可以使用**flyway.target**来控制进程应该运行到哪个迁移。

# email - 检索 UCF id 失败

> ID：13595279
> 
> 赞同：0
> 
> 时间：2012-11-27T23:44:42.567
> 
> 标签：email, drag-and-drop, lotus-notes, documentum, emc

我最近遇到了我的 Lotus Documentum Integration (LDI) 问题。在尝试将一封电子邮件从 lotus notes 拖到 LDI 拖放窗口并将其放下后，我收到以下 Lotus Notes 错误：

```
=================
Error Information
=================
Program: Archive
Exception: Attempted 5 retries. Aborting.
FuncRef: saveItems

BaseType:
Emc.Documentum.FS.Runtime.ServiceInvocationException: Failed to retrieve UCF id.
   at EAIF.DataSource.EAIFWebServicesDataSource.CreateObject(String folderPath, String filePath, String objectType, String objectFormat, String objectName,     DocbaseAttributeCollection attrs)
   at LDIArchive.ArchiveForm.saveItems()

Stack Trace:
   at LDIArchive.ArchiveForm.saveItems()
   at LDIArchive.ArchiveForm.btnFinish_Click(Object sender, EventArgs e)

Inner Program: EAIFramework.NET
Inner Exception: Failed to retrieve UCF id.
Inner FuncRef: CreateObject

Inner BaseType:
Emc.Documentum.FS.Runtime.ServiceInvocationException: Failed to retrieve UCF id.
   at EAIF.DataSource.EAIFWebServicesDataSource.CreateObject(String folderPath, String filePath, String objectType, String objectFormat, String objectName, DocbaseAttributeCollection attrs)
   at LDIArchive.ArchiveForm.saveItems()

Inner Stack Trace:
   at EAIF.DataSource.EAIFWebServicesDataSource.CreateObject(String folderPath, String filePath, String objectType, String objectFormat, String objectName, DocbaseAttributeCollection attrs)
   at LDIArchive.ArchiveForm.saveItems() 
```

试图在网上做一些研究，但没有运气。非常感谢任何人都可以提供帮助。干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T01:15:48.637

我最近找到了上述问题的答案。基本上，我需要关闭 lotus notes，删除 c:/Document and Settings/<-my user id>/ 内 Documentum 文件夹下的 UCF 文件夹，然后重新启动 Notes。这将解决问题

# iphone - CGContextClipToMask 不剪裁

> ID：13595284
> 
> 赞同：0
> 
> 时间：2012-11-27T23:45:31.647
> 
> 标签：iphone, objective-c, ios, uikit, core-graphics

我试图通过使用剪贴蒙版剪掉路径的笔划，在圆角矩形内绘制嵌入阴影，只留下阴影。最终目标是近似通知中心中事物的嵌入外观。

我失败了。CGContextClipToMask 根本不起作用，这尤其令人抓狂，因为我在项目的其他地方使用了相同的技术，并且在那里工作正常。这是我的绘图代码：

```
const CGFloat cornerRadius = 5.0f;
CGContextRef context = UIGraphicsGetCurrentContext();

// Draw background color
[[UIColor colorWithWhite:0.2 alpha:0.5] setFill];
UIBezierPath* background = [UIBezierPath bezierPathWithRoundedRect:self.bounds cornerRadius:cornerRadius];
[background fill];

// Draw the inner shadow
UIImage* mask;
UIGraphicsBeginImageContext(self.bounds.size);
{{
    CGContextRef igc = UIGraphicsGetCurrentContext();
    [[UIColor blackColor] setFill];
    CGContextFillRect(igc, self.bounds);

    // Inset the mask by a ridiculous degree just to be sure that it's working
    UIBezierPath* insetMask = [UIBezierPath bezierPathWithRoundedRect:CGRectInset(self.bounds, 20, 20) cornerRadius:cornerRadius];
    [[UIColor whiteColor] setFill];
    [insetMask fill];

    mask = UIGraphicsGetImageFromCurrentImageContext();
}}
UIGraphicsEndImageContext();

CGContextSaveGState(context);
{{
    CGContextClipToMask(context, self.bounds, mask.CGImage);

    [[UIColor whiteColor] setStroke];
    CGContextSetShadow(context, CGSizeMake(0, 1), 1);
    [background stroke];
}}
CGContextRestoreGState(context); 
```

如果我猜测出了什么问题，我会说我以某种方式违反了文档中列出的先决条件：

> 如果`mask`是图像，则它必须在 DeviceGray 颜色空间中，可能没有 alpha 分量，并且可能不会被图像蒙版或蒙版颜色遮盖。

但是，我发现无法验证是否是这种情况，更不用说纠正了。

TIA 为您提供任何帮助！

（我在运行 iOS 6 的 iPhone 4S 上运行该应用程序。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T04:25:43.633

您不能使用`UIGraphicsBeginImageContext`. 你必须使用`CGBitmapContextCreate`. 您也没有通过使用`UIGraphicsBeginImageContext`而不是正确处理 Retina `UIGraphicsBeginImageContextWithOptions`。

让我向您展示一种可能更简单的方法来绘制不需要弄乱位图上下文和图像的内部阴影。当您有一条非自相交路径时，您可以通过用一个大矩形包围它并使用奇偶填充规则来反转它。

这是一个例子。我做了一个`InnerShadowView`. 这是它的`drawRect:`：

```
- (void)drawRect:(CGRect)rect {
    [self fillIfNeeded];
    [self drawShadowIfNeeded];
} 
```

该`fillIfNeeded`方法只绘制实心圆角矩形：

```
- (void)fillIfNeeded {
    UIColor *color = self.fillColor;
    if (!color)
        return;

    [color setFill];
    UIBezierPath *path = [UIBezierPath bezierPathWithRoundedRect:self.bounds
        cornerRadius:self.cornerRadius];
    [path fill];
} 
```

该`drawShadowIfNeeded`方法绘制内部阴影。首先，我剪辑到圆角矩形：

```
- (void)drawShadowIfNeeded {
    UIColor *color = self.shadowColor;
    if (!color)
        return;

    CGContextRef gc = UIGraphicsGetCurrentContext();
    CGContextSaveGState(gc); {
        [[UIBezierPath bezierPathWithRoundedRect:self.bounds
            cornerRadius:self.cornerRadius] addClip]; 
```

接下来，我构造圆角矩形的逆：包含**除**圆角矩形之外的所有内容的路径。我从一个非常大的矩形开始：

```
 UIBezierPath *invertedPath = [UIBezierPath bezierPathWithRect:CGRectInfinite]; 
```

然后我将圆角矩形附加到相同的路径：

```
 [invertedPath appendPath:[UIBezierPath bezierPathWithRoundedRect:CGRectInset(self.bounds, -1, -1) cornerRadius:self.cornerRadius]]; 
```

请注意，我正在稍微扩展圆角矩形。当拐角半径不为零时，这是必要的，以避免曲线周围出现一些伪影。

接下来，我将复合路径设置为使用偶数/奇数填充规则：

```
 invertedPath.usesEvenOddFillRule = YES; 
```

通过使用偶数/奇数填充规则，我确保无限矩形和圆角矩形内的任何点都被*排除*在填充区域之外，而圆角矩形外的任何点都被*包括在内*。

现在，当我填充这个倒置路径时，它会尝试填充圆角矩形之外的每个像素。它唯一可以投射阴影的地方是圆角矩形内。而且由于我已经剪裁到圆角矩形，它只会绘制阴影。

于是我设置了填充参数并填充了路径：

```
 CGContextSetShadowWithColor(UIGraphicsGetCurrentContext(),
            self.shadowOffset, self.shadowBlur, color.CGColor);
        [[UIColor blackColor] setFill];
        [invertedPath fill]; 
```

并清理：

```
 } CGContextRestoreGState(gc);
} 
```

使用红色阴影颜色，它看起来像这样：

![InnerShadowView 屏幕截图](../Images/068c2b30e543347dcb0db7bf93c51846.png)

[您可以在此 gist](https://gist.github.com/4159014)中找到所有代码，以便于下载。

# r - 在字幕中显示字符和变量值

> ID：13595287
> 
> 赞同：3
> 
> 时间：2012-11-27T23:46:12.400
> 
> 标签：r, plot

我尝试了几乎所有 paste()、bquote()、as.expression()、c()、...的组合

```
plot(d[,"y"], type="l",xlim=c(1,n), ylim=c(min(d[,"y"]),max(d[,"y"])), 
  ylab="Y", xlab="T", main="ARMA(1,1)",
   sub=c(as.expression(bquote(phi == .(coef_ar)), 
         as.expression(bquote(theta == .(coef_ma)))))) 
```

这只是绘制“phi = 0.5”（在这种情况下是希腊符号），而不是第二部分（theta）。谁能帮帮我！

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-27T23:53:49.110

您可以使用`substitute`. `~`将用空格连接表达式

```
plot(1, main = substitute(phi == Phi ~ theta == Theta, list(Phi = 1, Theta = 1))) 
```

![在此处输入图像描述](../Images/c69d672960b94019f06e68df99b6bd00.png)

或者您可以`bquote`以类似的方式使用

```
plot(1, main = bquote(phi == .(coef_ar)  ~ theta == .(coef_ma))) 
```

您的初始方法不起作用的原因是它创建了一个表达式向量，然后仅使用第一个元素作为字幕。

如果您想要`comma`分隔值，请使用`list()`,

例如

```
 plot(1, main = bquote(list(phi == .(coef_ar), theta == .(coef_ma)))) 
```

# video - 了解视频帧中的 PTS 和 DTS

> ID：13595288
> 
> 赞同：26
> 
> 时间：2012-11-27T23:46:15.407
> 
> 标签：video, ffmpeg, video-streaming, pts, avcodec

从 avi 转码为 mp4(x264) 时出现 fps 问题。最终问题出在 PTS 和 DTS 值中，因此在 av_interleaved_write_frame 函数之前添加了第 12-15 行：

```
1\.  AVFormatContext* outContainer = NULL;
2\.  avformat_alloc_output_context2(&outContainer, NULL, "mp4", "c:\\test.mp4";
3\.  AVCodec *encoder = avcodec_find_encoder(AV_CODEC_ID_H264);
4\.  AVStream *outStream = avformat_new_stream(outContainer, encoder);
5\.  // outStream->codec initiation
6\.  // ...
7\.  avformat_write_header(outContainer, NULL);

8\.  // reading and decoding packet
9\.  // ...
10\. avcodec_encode_video2(outStream->codec, &encodedPacket, decodedFrame, &got_frame)
11\. 
12\. if (encodedPacket.pts != AV_NOPTS_VALUE)
13\.     encodedPacket.pts =  av_rescale_q(encodedPacket.pts, outStream->codec->time_base, outStream->time_base);
14\. if (encodedPacket.dts != AV_NOPTS_VALUE)
15\.     encodedPacket.dts = av_rescale_q(encodedPacket.dts, outStream->codec->time_base, outStream->time_base);
16\. 
17\. av_interleaved_write_frame(outContainer, &encodedPacket) 
```

看了很多帖子还是不明白：

1.  `outStream->codec->time_base`= 1/25 和`outStream->time_base`= 1/12800。第一个是我设置的，但我不知道为什么以及谁设置了 12800？我注意到在第 (7) 行`outStream->time_base`= 1/90000 之前和之后它变为 1/12800，为什么？当我从 avi 转码为 avi 时，意味着将第 (2) 行更改为`avformat_alloc_output_context2(&outContainer, NULL, "avi", "c:\\test.avi";`，因此第 (7) 行之前和之后`outStream->time_base`始终保持 1/25，而不像在 mp4 情况下那样，为什么？
2.  `outStream->codec`time_base of和有什么区别`outStream`？
3.  要计算 pts `av_rescale_q`：需要 2 个 time_base，将它们的分数相乘，然后计算 pts。为什么会这样？正如我调试的那样，`encodedPacket.pts`它的值增加了 1，那么如果它确实有值，为什么要改变它呢？
4.  开始时 dts 值为 -2 并且在每次重新缩放后它仍然有负数，但尽管如此视频播放正确！不应该是积极的吗？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-11-30T13:32:41.590

1.  time_base 只是一个计量*单位*。可以使用不同的单位来表示相同的时间（如果它们不是精确的倍数，则为近似值）。在某些情况下，容器格式需要特定的时基，并且将由复用器设置为该时基。在其他情况下，容器*不需要*时基，但它具有您可能必须覆盖的默认值。我不确定 1/12800 具体是什么，我知道 1/600 是 mp4 规范中的一个特殊值。

2.  这两个时基是编解码器和容器的时间测量单位。如果使用恒定 fps，则编解码器的测量单位通常设置为每帧和下一帧之间的间隔（每帧显示的持续时间），因此帧时间是连续的整数。但是，它不必设置为 1/fps，只要 pts 时间在使用的任何单位中都是正确的。

3.  您所描述的只是从一个单位转换为另一种单位所需要做的事情。（即：乘以旧单位，除以新单位）。以 为单位的时间 t`a/b`可以转换为单位`c/d`为`t*(a*d)/(b*c)`。

4.  dts 序列可以从任何值开始，dts 0 没有特殊意义。在播放开始时，计算挂钟时间与起始 dts 之间的差，并使用该值将所有未来的 dts 转换为挂钟。dts=-10, -9, -8, ... 的视频流完全可以。连续 dts 之间的区别在于使用的是什么，绝对值无关紧要。

# c++ - 为什么没有用于引用数组的 std::string 构造函数？

> ID：13595292
> 
> 赞同：1
> 
> 时间：2012-11-27T23:46:34.153
> 
> 标签：c++

字符串文字是数组对象：

```
typeid("hello").name()   // char [6] 
```

这似乎很方便，因为字符串文字（=array）的大小在编译时是已知的。那么为什么没有构造函数来`std::string`引用数组呢？

```
// this would be great
template <int N>
std::string(const char (& array)[N]); 
```

`const char * s`相反，有些构造函数采用`const char * s, size_t n`或两个`InputIterator`s（例如。`const char * begin, const char * end`）。所有这些都有缺点；数组被隐式转换为指针并且大小信息丢失，因此使用各种方法将其取回。工作，但越来越疯狂的例子：

```
// std::string(const char * s) version:
std::string s1("hello");                      // calls std::strlen(s) internally

// std::string(const char * s, size_t n) version:
std::string s2("hello", 5);                   // programmer does std::strlen(s) mentally
std::string s3("hello", sizeof("hello"));     // have to repeat string literal

// macro helper to avoid repeating string literal (ugly and dangerous)
#define STRLIT(x) std::string(x, sizeof(x));  // could be a function I guess
std::string s4 = STRLIT("hello");             // not much improvement (and macros are evil)

// std::string(InputIterator begin, InputIterator end) version:
char tmp[] = "hello";                         // copy array
std::string s5(&tmp[0], &tmp[sizeof(tmp)]);   // so you can reference it twice

// or trust the compiler to return the same address for both literals
std::string s6(&"hello"[0], &"hello"[sizeof("hello")]);   // totally crazy 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:48:19.260

这样的模板化构造函数将为`N`. 这可能会导致不必要的代码膨胀。

[膨胀是可以避免的，但让我们将这个想法与常被引用的Raymond Chen](http://blogs.msdn.com/oldnewthing)的回答结合起来：

> “为什么不存在此功能？”的答案 通常是“默认情况下功能不存在。必须有人来实现它们。”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T00:03:36.590

因为有一个使用迭代器的通用构造函数：

```
std::string s7(std::begin(container), std::end(container)); 
```

注意：假设 std::begin/std::end 为 c++11，但您可以快速轻松地编写类似的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T00:04:00.583

考虑是否应该有一个构造函数采用 a `char const (&)[N]`（对于某些静态确定`N`的）时，关键问题是结果的内容`std::string`应该是什么。对于某些人来说，它应该是什么可能是显而易见的，但我不认为它是。考虑一下`std::string("abc\0def")`：

1.  它可以是一个包含 8 个元素的字符串，包括两个空字节。
2.  它可以是一个包含 7 个元素的字符串，不包括第二个空字节。
3.  它可以是一个包含 3 个元素的字符串，不包括从第一个空字节开始的所有内容。

如果你使用

```
std::cout << "string='" << "abc\0def" << "'\n"; 
```

你得到第三个选项。看来，这是唯一明智的选择...

# python - 用函数调用解析算术表达式

> ID：13595294
> 
> 赞同：3
> 
> 时间：2012-11-27T23:46:57.943
> 
> 标签：python, dsl, pyparsing

我正在使用 pyparsing，发现它非常适合开发一个简单的 DSL，它允许我从 MongoDB 中提取数据字段并对其进行简单的算术运算。我现在正在尝试扩展我的工具，以便我可以将 Rank[Person:Height] 形式的函数应用于字段，并可能包含简单的表达式作为函数调用的参数。我正在努力使解析语法正常工作。这是我到目前为止所拥有的：

```
# Define parser
expr = Forward()
integer = Word(nums).setParseAction(EvalConstant)
real = Combine(Word(nums) + "." + Word(nums)).setParseAction(EvalConstant)

# Handle database field references that are coming out of Mongo, 
# accounting for the fact that some fields contain whitespace
dbRef = Combine(Word(alphas) + ":" + Word(printables) + \
    Optional(" " + Word(alphas) + " " + Word(alphas)))
dbRef.setParseAction(EvalDBref)

# Handle function calls
functionCall = (Keyword("Rank") | Keyword("ZS") | Keyword("Ntile")) + "[" + expr + "]"
functionCall.setParseAction(EvalFunction)
operand =  functionCall | dbRef | (real | integer) 

signop = oneOf('+ -')
multop = oneOf('* /')
plusop = oneOf('+ -')

# Use parse actions to attach Eval constructors to sub-expressions
expr << operatorPrecedence(operand,
    [
     (signop, 1, opAssoc.RIGHT, EvalSignOp),
     (multop, 2, opAssoc.LEFT, EvalMultOp),
     (plusop, 2, opAssoc.LEFT, EvalAddOp),
    ]) 
```

我的问题是，当我测试像 Rank[Person:Height] 这样的简单表达式时，我遇到了解析异常：

```
ParseException: Expected "]" (at char 19), (line:1, col:20) 
```

如果我使用浮点数或算术表达式作为 Rank[3 + 1.1] 之类的参数，则解析工作正常，如果我简化 dbRef 语法使其只是 Word(alphas) 它也可以工作。我一生都无法弄清楚我的完整语法有什么问题。我尝试重新排列操作数的顺序以及简化 functionCall 语法无济于事。谁能看到我做错了什么？

一旦我得到这个工作，我想采取最后一步，并在表达式中引入对变量赋值的支持..

编辑：经过进一步测试，如果我从 dbRef 语法中删除可打印文件，一切正常：

```
 dbRef = Combine(Word(alphas) + OneOrMore(":") + Word(alphanums) + \
      Optional("_" + Word(alphas))) 
```

但是，如果我将字符“-”添加到 dbRef（我需要像“Class:SN”这样的 DB 字段），解析器将再次失败。我认为我的 operatorPrecedence 中的 signop 正在消耗“-”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:14:08.870

似乎发生的情况是，测试`]`字符串（不幸的是包括方括号字符）`Rank[Person:Height]``dbRef``:`

然后解析器尝试生成 a`functionCall`但缺少关闭`]`因此错误消息。

一个暂定的解决方法是使用不包含方括号的字符集，可能更明确，例如：

```
dbRef = Combine(Word(alphas) + ":" + Word(alphas, alphas+"-_./") + \
    Optional(" " + Word(alphas) + " " + Word(alphas))) 
```

**编辑**：
仔细一看，上面的内容大致正确，但是令牌层次结构是错误的（例如，解析器尝试将 a`functionCall`作为 an 的一个操作数`expr` 等）。此外，由于符号
的歧义，我建议的修复将不起作用`-`在 a 中应理解为普通字符，在 中应理解为`dbRef`plusOp `expr`。这种类型的问题在解析器中很常见，并且有一些方法可以解决这个问题，尽管我不确定 pyparsing 到底如何。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T01:06:52.310

找到解决方案 - 问题是我的 dbRef 语法正在消耗一些属于函数规范的字符。正确工作的新语法：

```
dbRef = Combine(Word(alphas) + OneOrMore(":") + Word(alphanums) + \
    Optional(oneOf("_ -") + Word(alphas))) 
```

# php - Magento 从 product_id（或 entity_id）获取 salesrule id

> ID：13595296
> 
> 赞同：0
> 
> 时间：2012-11-27T23:47:07.107
> 
> 标签：php, magento

我们正在使用 Magento Enterprise 1.10，我需要一种方法来获取类别页面和产品详细页面上每个产品的 salesrule_id。当您使用购物车时，这非常容易。

基本上我想做的就是这样 --> 伪查询

```
SELECT rule_id FROM salesrule WHERE entity_id = <entity_id) 
```

你知道在购物车之外有什么方法可以做到这一点吗？如果该产品存在，我可以使用返回 rule_id 的产品 ID 调用方法吗？

任何建议都会对我有很大帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:19:28.393

产品没有附加销售规则，也没有内置方法来加载给定产品的规则。在购物车页面上这很容易，因为该规则被应用于报价，并且在每个项目上，您都可以获得应用规则 ID，它为您提供当前应用于报价项目的任何匹配规则的 ID，这与产品对象不同。因此，例如，您可以有多个适用于同一个项目的销售规则，因此 applied_sales_rule_ids 将为您提供所有应用的规则，而不仅仅是一个。

您可以尝试加载销售规则集合并在 product_ids 列上添加过滤器，然后传入产品的实体 ID。[此处的这篇文章](https://stackoverflow.com/questions/9483072/display-collection-of-shopping-cart-rules-and-products-categories-associated-to)通过一些代码示例对此进行了探讨，可能会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T00:28:01.137

尝试使用`Mage_CatalogRule_Model_Resource_Rule::getRulesFromProduct()`.

# android - EditText 全部滑动，我想要部分滑动，我该怎么做

> ID：13595302
> 
> 赞同：0
> 
> 时间：2012-11-27T23:47:21.657
> 
> 标签：android, android-layout

我想要的只是在图片中显示。第一个是正常的，第二个是键盘出现时会发生什么，第三个是我想要的。

![问题图片](../Images/6e5df20c9dffed0e622cfbbe1b7b65cd.png)

对于一个非常相似的问题，你可以从这里得到提示：

[当键盘出现时，让我在 Android 中的表单上升](https://stackoverflow.com/questions/5400686/make-my-form-in-android-goes-up-when-keyboard-appear/5401170#5401170)

编辑：我的清单文件

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="main.asil"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
         android:minSdkVersion="10"
         android:targetSdkVersion="15" />
     <uses-permission android:name="android.permission.INTERNET"/>
     <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
     <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
     <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE"/>

     <application
         android:icon="@drawable/ic_launcher"
         android:label="@string/app_name"
         android:theme="@style/AppTheme" >
         <activity
             android:name=".MainActivity"
             android:theme="@android:style/Theme.NoTitleBar.Fullscreen" 
             android:label="@string/title_activity_main" 
             android:windowSoftInputMode="adjustResize">
             <intent-filter>
                 <action android:name="android.intent.action.MAIN" />
                 <category android:name="android.intent.category.LAUNCHER" />
             </intent-filter>
         </activity>
         <activity
             android:name="TextingActivity"
             android:theme="@android:style/Theme.NoTitleBar.Fullscreen">
         </activity>
     </application>

 </manifest> 
```

我的相关xml文件如下：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/label"
        android:layout_width="match_parent"
        android:layout_height="40dp"
        android:layout_gravity="right"
        android:layout_marginLeft="2dp"
        android:layout_marginRight="5dp"
        android:layout_marginTop="2dp"
        android:drawableLeft="@drawable/ic_launcher"
        android:gravity="center"
        android:scrollbars="vertical"
        android:text="@+id/label"
        android:textSize="30dp" >
    </TextView>

    <TextView
        android:id="@+id/chat_log"
        android:layout_width="fill_parent"
        android:layout_height="0dp"
        android:layout_marginTop="50dp"
        android:layout_weight="1"
        android:cacheColorHint="#00000000"
        android:clickable="false"
        android:gravity="bottom|left"
        android:scrollbars="vertical"
        android:stackFromBottom="true"
        android:transcriptMode="alwaysScroll" />

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal" >

        <EditText
            android:id="@+id/chat_input_text"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_gravity="bottom"
            android:layout_weight="1"
            android:inputType="text" />

        <Button
            android:id="@+id/chat_send_button"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/chat_send" />

        <Button
            android:id="@+id/add_file_button"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/add_file" />

    </LinearLayout>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T05:16:19.767

将以下代码行写入您的所有活动标记到 androidmanifest.xml 文件中，它将解决您的问题。

```
android:windowSoftInputMode="adjustPan" 
```

更改后，您的活动如下所示：-

```
<activity
    android:name=".Splash_Screen_Activity"
    android:label="@string/app_name"
    android:windowSoftInputMode="adjustPan" >
    <intent-filter>
        <action android:name="android.intent.action.MAIN" />

        <category android:name="android.intent.category.LAUNCHER" />
    </intent-filter>
</activity> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:55:29.567

查看官方 android 开发文档[http://developer.android.com/guide/topics/manifest/activity-element.html#wsoft](http://developer.android.com/guide/topics/manifest/activity-element.html#wsoft)并查找 adjustPan，这应该可以帮助您解决布局问题。

将清单文件中的活动更改为这样

```
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="main.asil"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
     android:minSdkVersion="10"
     android:targetSdkVersion="15" />
 <uses-permission android:name="android.permission.INTERNET"/>
 <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
 <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
 <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE"/>

 <application
     android:icon="@drawable/ic_launcher"
     android:label="@string/app_name"
     android:theme="@style/AppTheme" >
     <activity
         android:name=".MainActivity"
         android:theme="@android:style/Theme.NoTitleBar.Fullscreen" 
         android:label="@string/title_activity_main" 
         android:windowSoftInputMode="adjustPan">
         <intent-filter>
             <action android:name="android.intent.action.MAIN" />
             <category android:name="android.intent.category.LAUNCHER" />
         </intent-filter>
     </activity>
     <activity
         android:name="TextingActivity"
         android:theme="@android:style/Theme.NoTitleBar.Fullscreen">
     </activity>
 </application> 
```

# typescript - 继承 AMD 模块的内部类

> ID：13595310
> 
> 赞同：0
> 
> 时间：2012-11-27T23:47:48.050
> 
> 标签：typescript

在打字稿中，我有一个这样的模块：

```
export module ABC{
  export class classA {
  }
} 
```

我想从 B 类继承 A 类。

```
class classB {
} 
```

如果我做这样的事情

```
export module ABC{
  export class classA extends classB {
  }
} 
```

编译器告诉我 classB 必须是一个类。顺便说一句，classB 位于一个单独的文件中。

我怎样才能让它工作？？？提前致谢

* * *

行，

我决定不扩展内部类，而是定义一个模块和另一个模块的内部类的内部实例属性。就像这样：

**文件1.ts**

```
export module moduleA {

    export class classA {

      subscribed: bool;

      constructor () { }

      public unsubscribeLogOff(eventName) {
        this.subscribed = false;
      }
      public subscribeLogOff(eventName) {
        this.subscribed = true;
      }
    }
} 
```

**文件2.ts**

```
import m = module("moduleA"); 

export module moduleB {

    var instanceA: m.moduleA.classA = null;

    export function activate() {
      if( this.instanceA == null ) instanceA = new m.moduleA.classA();
      instanceA.subscribeLogOff(eventName);
    }

    export function deactivate() {
      if( instanceA == null ) return;
      instanceA.unsubscribeLogOff(eventName);
    }
} 
```

这里的问题是，我希望在调用**subscribeLogOff**之后，**classA的****subscribed**属性保持其值，因此在调用**unsubscribeLogOff时，** **subscribed**的值是 true。

 ********但是，当我调用unsubscribeLogOff**时，这不是真的**subscribed**的值是**undefined**。

我无法理解。你能帮助我吗 ？？？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T08:55:16.363

要使这项工作正常进行，您的代码应如下所示：

**文件1.ts**

```
export module ABC {
    export class classA {
    }
} 
```

**文件2.ts**

```
import otherFile = module('file1');

export module ABC {
    export class classA extends otherFile.ABC.classA {
    }
} 
```

请注意，如果您有一个标有 的顶级对象，则通常不需要`export`将您的内容更深一层地包装在块中。`module`******

# javascript - 从涉及 Google Maps API 的 Java Script 代码调用 Go 服务器

> ID：13595312
> 
> 赞同：5
> 
> 时间：2012-11-27T23:48:01.197
> 
> 标签：javascript, google-app-engine, google-maps, go

我正在为我的分布式系统类在 Go 中创建一个项目，演示分布式存储和容错。后端都在 GO 中 - 我在 GO 中基本上有 2 个主要函数 Add(Args) 和 Get(Args)。

我的前端是一个带有谷歌地图的网页。地图上的事件处理程序将是 Javascript 函数。我可以轻松地从 Google Maps API 中提取地图中心或地图框边界等信息。

我的问题是：我不知道如何使用来自我的 JavaScript 函数的信息“调用”后端的 GO 函数/程序。我对 Web 开发非常陌生，所以如果这很明显，我深表歉意。

在谷歌搜索中，我发现的唯一方法是将 GO 程序作为某种 http 服务器运行在谷歌应用引擎上。我不确定细节。

如果有人给我一些参考，或者指出我正确的方向，我会很高兴！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T02:08:16.017

以及一般的ajax通信方式，从map到服务器用GET/POST方法。

虽然有大量的库，但著名的库之一是 jQuery。

* * *

1) 从官方页面下载 jQuery 库。 [http://jquery.com/](http://jquery.com/)

2) 部署到应用引擎。

3）尝试一个简单的代码：

```
<script src="/js/jquery.min.js"></script>
<script>
jQuery.post("http://yourapp.appspot.com/test/", {
  message : "helloworld"
}, function(response){
  alert(response);
});
</script> 
```

4) 您还需要您的 GO 脚本来处理“http://yourapp.appspot.com/test/”的 POST 访问。（对不起，我还不熟悉 GO 语言）

5）谷歌搜索关键字“ajax jQuery”。

* * *

我希望这些步骤对您有所帮助。

# javascript - FireFox 与 Webkit/IE 不同的 onchange 行为

> ID：13595313
> 
> 赞同：3
> 
> 时间：2012-11-27T23:48:04.887
> 
> 标签：javascript, firefox

有人能解释一下吗？

基本上，当您在 Firefox 中并点击选项卡时，onchange 中的“console.log”会被调用，但不会在 Chrome/Safari（webkit）或 IE 中调用。

```
function initLookup(id) {
    var lookupElement = document.getElementById(id);
    var lookup = new Lookup(lookupElement);            
    lookupElement.lookup = lookup;
}

function Lookup(lookupElement) {
    this.doKeyDown = doKeyDown;
    this.setLookup = setLookup;        
    this.inputElement = lookupElement;
    this.inputElement.onkeydown = this.doKeyDown;
    var self = this;

    function setLookup() {
        self.inputElement.value = 'asdf';
    }
    function doKeyDown(event) {
        if(event.keyCode == 9) {
            setLookup();
        }            
    }
}
initLookup("one"); 
```

还有一个 JS fiddle 工作示例：​</p>

[http://jsfiddle.net/pj9Gf/5/](http://jsfiddle.net/pj9Gf/5/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T22:38:54.833

Gecko 与 IE（显然是 Webkit）的不同之处在于，`change`事件是在事件触发后`blur`触发的。

通过在按键上设置值`TAB`，您可以有效地防止应用更改，因为触发器是由 on和 on`change`检测到的值之间的差异定义的。`focus``blur`

### 参考

*   [`element.onchange`](https://developer.mozilla.org/en-US/docs/DOM/element.onchange)在 Mozilla 开发者网络上

# python - 为什么我不能将 range() 的输出输出到文件中？

> ID：13595315
> 
> 赞同：0
> 
> 时间：2012-11-27T23:48:08.643
> 
> 标签：python, file-io

```
for x in range(6):
  why = str(x+1)
  outf.write(why) 
```

其中 outf 是一个文件

给我：

```
why = str(x+1)
TypeError: expected a character buffer object 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:59:02.543

我不相信您已经发布了您正在运行的代码，但是还有其他编写它的方法可以避免显式调用`str`和 +1'ing（假设每行一个数字和 2.x）：

```
for i in xrange(1, 7): # save the +1
    print >> fout, i 

fout.writelines('{}\n'.format(i) for i in xrange(1, 7))

from itertools import islice, count
fout.writelines('{}\n'.format(i) for i in islice(count(1), 6)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:55:06.807

为我工作（在 ipython，python 2.7 中）：

```
In [1]: outf = open('/tmp/t', 'w')

In [2]: for x in range(6):
   ...:     why = str(x+1)
   ...:     outf.write(why)

In [3]: outf.close() 
```

文件内容：123456

你用的是什么python版本？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T23:57:54.460

这对我有用

```
outf = open('/temp/workfile', 'w')
for x in range(6):
    why = str(x+1)
    outf.write(why)
outf.flush()
outf.close() 
```

`/temp/workfile`包含`123456`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T00:02:37.130

假设您是 Python 新手...

```
new_File = open('mynewfile.txt', 'wr')
for x in range(6):
    new_File.write(str(x)+'\n')

new_File.close() 
```

将为您提供一个名为“mynewfile.txt”的文件的输出，该文件如下所示：

```
0 
1 
2
3
4
5 
```

就您粘贴的代码而言，您还没有告诉我们其他一些事情……这很好用。

```
for x in range(6):
  why = str(x+1)
  print why

1
2
3
4
5
6 
```

# php - 具有平均计数和用户发布的评分

> ID：13595316
> 
> 赞同：0
> 
> 时间：2012-11-27T23:48:16.340
> 
> 标签：php, mysql, sql, count, average

我知道如何在一个 SQL 中获取计数和平均值

SELECT COUNT(col) AS cnt, AVG(col) AS avg FROM tbl;

但是，您如何获得用户发布的结果呢？这一切可以一次性完成吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:56:55.833

```
select user, count(col), avg(col) group by user 
```

使用您的信息：

```
SELECT domains_ratings_domain
       , COUNT( * ) 
       , AVG( domains_ratings_rating ) 
       , (select domains_ratings_rating FROM domains_ratings T2 WHERE T2.user=T1.user)
FROM domains_ratings  T1
GROUP BY domains_ratings_domain 
```

# javascript - 追加动态创建的表 javascript

> ID：13595318
> 
> 赞同：0
> 
> 时间：2012-11-27T23:48:16.963
> 
> 标签：javascript, append, row, dynamic-tables

我提出了一个 xhr 请求，我得到了响应，然后我将一些值附加到了一个表中。然后我在另一个页面上发出第二个 xhr 请求，得到一些我想在先前插入的行下附加的其他结果..问题是我所做的每个下一个附加而不是“在”先前创建的行下，都在它之前..我想这是因为这些是动态创建的..但是有什么办法可以解决这个问题吗？无需向表或行添加类或 ID ..

这是我的代码..首先是html

```
<body>
    <table border="1">
        <tr>
        <th>first cell</th>
        <th>second cell</th>
        </tr>
    </table>
    <div id="div1">
</body> 
```

和我的 javascript

```
 function response(url, callback{
     //xhr request
  }

var url1 = "http://example1.com";
request(url1, function(response){
        var temp1 = document.getElementsByTagName("table")[0];
    var temp2create = document.createElement("tr");
    var temp3 = ("<td>" + someresponse + "</td><td>" + someotherresponse + "</td>");        
    temp2create.innerHTML = temp3;
    temp1.appendChild(temp2create);
 });
var url2 = "http://example1.com";
request(url2, function(response){
        var temp4 = document.getElementsByTagName("table")[0];
    var temp5create = document.createElement("tr");
    var temp6 = ("<td>" + someresponse + "</td><td>" + someotherresponse + "</td>");        
    temp5create.innerHTML = temp6;
    temp4.appendChild(temp5create);
 }); 
```

所以，不是在前一行之后添加新行，而是在..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:08:15.333

可能是第一个 xhr 请求比第二个请求花费的时间更长。因此，第二个在第一个接收并附加其响应之前附加其响应。如果会返回固定数量的请求，您可以在表中创建占位符行，例如：

```
<body>
    <table border="1">
        <tr>
            <th>first cell</th>
            <th>second cell</th>
        </tr>
        <tr id="tr1">

        </tr>
        <tr id="tr2">

        </tr>
    </table>
</body> 
```

和 javascript：

```
(url1,response())
{
    document.getElementById("tr1").innerHTML("someresponse");
}

(url2,response())
{
    document.getElementById("tr2").innerHTML("some other response");
} 
```

或者，如果时间不重要，您可以链接请求按顺序发生。

```
request(url1, function(response){
    var temp1 = document.getElementsByTagName("table")[0];
    var temp2create = document.createElement("tr");
    var temp3 = ("<td>" + someresponse + "</td><td>" + someotherresponse + "</td>");        
    temp2create.innerHTML = temp3;
    temp1.appendChild(temp2create);

    var url2 = "http://example1.com";
    request(url2, function(response){
        var temp4 = document.getElementsByTagName("table")[0];
        var temp5create = document.createElement("tr");
        var temp6 = ("<td>" + someresponse + "</td><td>" + someotherresponse + "</td>");        
        temp5create.innerHTML = temp6;
        temp4.appendChild(temp5create);
     });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T00:16:47.050

尼古拉斯，没有。调用是异步的，这意味着它们运行和完成的顺序是未定义的。您不能依赖与启动顺序匹配的完成顺序。如果您需要，那么要做的就是从第一个回调（链接）中调用第二个 xhr。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-08T17:13:04.647

这是我在最近的一个项目中使用的，必须将 JSON 附加到 HTML。

**定义表**

```
<table id="geoTable" border="1"></table> 
```

**填充**

```
appendTableRow('geoTable', "MPH", 70);
appendTableRow('geoTable', "KPH ", 112.654); 
```

**添加行的功能**

```
function appendTableRow(tableName,name,value)
{
    tableName = "#" + tableName;
   //<tr><td>name</td><td>value</td></tr>

   var tableRow = "<tr><td>$name</td><td>$value</td></tr>";
   tableRow = tableRow.replace("$name",name);
   tableRow = tableRow.replace("$value",value);        
   $(tableName).append(tableRow);
} 
```

# ruby-on-rails - 比较日期：“日期与 nil 的比较失败”

> ID：13595325
> 
> 赞同：0
> 
> 时间：2012-11-27T23:48:43.790
> 
> 标签：ruby-on-rails, validation, date

我有一个有很多项目的客户模型。在项目模型中，我想验证项目开始日期是否始终早于项目结束日期或与项目结束日期相同。这是我的项目模型：

```
class Project < ActiveRecord::Base
  attr_accessible :end_on, :start_on, :title

  validates_presence_of :client_id, :end_on, :start_on, :title
  validate :start_has_to_be_before_end

  belongs_to :clients

  def start_has_to_be_before_end
    if start_on > end_on
        errors[:start_on] << " must not be after end date."
        errors[:end_on] << " must not be before start date."
    end
  end
end 
```

我的应用程序按预期工作，并在验证失败时给我指定的错误。

但是，在我对项目的单元测试中，我试图涵盖这种情况，故意将开始日期设置在结束日期之后：

```
test "project must have a start date thats either on the same day or before the end date" do
    project = Project.new(client_id: 1, start_on: "2012-01-02", end_on: "2012-01-01", title: "Project title")
    assert !project.save, "Project could be saved although its start date was after its end date"
    assert !project.errors[:start_on].empty?
    assert !project.errors[:end_on].empty?
end 
```

奇怪的是，运行这个测试给了我三个错误，都指`if start_on > end_on`我验证方法中的这一行，说`undefined method '>' for nil:NilClass`两次`comparison of Date with nil failed`一次。

我该怎么做才能使测试通过？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:06:28.757

您正在创建一个项目，该项目具有 :start_on 和 :end_on 的字符串值。这不太可能奏效。Rails 可能会尝试变得聪明并解析这些，我不确定.. 我不会指望它。赔率是一些强制正在发生，并且值被设置为零。

我会这样做：

```
project = Project.new(client_id: 1, 
                      start_on: 2.days.from_now.to_date, 
                      end_on: Time.now.to_date, 
                      title: "Project title") 
```

# android - android在主要活动中获取选定的字符串

> ID：13595328
> 
> 赞同：0
> 
> 时间：2012-11-27T23:48:55.100
> 
> 标签：android

这是实现 AdapterView.OnItemSelectedListener 的嵌套类。这提供了一个回调方法，当从 Spinner 中选择了一个项目时通知我的应用程序。但我不知道如何将 Selected String 值传递给主要活动？

```
public class CustomOnItemSelectedListener implements OnItemSelectedListener {

  public void onItemSelected(AdapterView<?> parent, View view, int pos,long id) {
    String selected = parent.getItemAtPosition(pos).toString();
  }

  @Override
  public void onNothingSelected(AdapterView<?> arg0) {
        // Do nothing.
  }

} 
```

我像这样调用主要活动

```
 public void addListenerOnSpinnerItemSelection() {
    spinner1 = (Spinner) findViewById(R.id.spinner1);
    spinner1.setOnItemSelectedListener(new CustomOnItemSelectedListener());
     // I need the selected value here.........
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:05:31.580

如果您的侦听器是相关活动的嵌套子类，您应该能够直接从活动中简单地调用一个方法吗？

```
public void doSomething(String selected) {
    // do something here...
} 

public class YourItemSelectedListener implements OnItemSelectedListener {

    public void onItemSelected(AdapterView<?> parent, View view, int pos, long id) {
        String selected = parent.getItemAtPosition(pos).toString();
        doSomething(selected); // <=== THIS
    }

    public void onNothingSelected(AdapterView parent) {
        // Do nothing.
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:06:49.030

在您的自定义 SpinnerAdapter 中，您可以将字符串设置为视图上的标签

```
 myFirstView.setTag("First"); 
```

在 onItemSelected 回调中，您可以从视图中获取标签。

```
 String selectedContent = (String)view.getTag(); 
```

# android - 为什么我们的安卓游戏，特别是我们的弹珠，移动的这么慢？

> ID：13595330
> 
> 赞同：0
> 
> 时间：2012-11-27T23:49:03.540
> 
> 标签：android, performance, debugging, ondraw

我和我的朋友正在实现一个基于一些开源谷歌项目代码 accelerometerplay 的弹珠游戏。我们的目的是制作一个玩具程序来自学安卓开发。我们正在经历以下情况：

**问题：**

弹珠在屏幕上滚动的速度极慢。这就像看着某物以慢动作移动。太糟糕了。我们怎样才能让它更快/正常播放？

**我们所做的：**

1.  我们强制输入加速度计播放我们的代码，该代码从图块中绘制地图。虽然这会减慢速度。它仍然运行得很好。

2.  我们重写了我们的视图以更接近原始的加速度计播放，并且仍然存在完全相同的问题，即我们的弹珠运行太慢，因此这消除了对我们不同类方法和简化的怀疑。

3.  搜索了这个论坛。我们看到一些事情说 invalidate() 会使事情变慢，但我们不认为这是问题所在。它不应该杀死 onDraw() 来绘制一个弹珠以仅在屏幕上移动。

我们在下面包含我们的代码，用于程序的视图部分。其他类如活动或物理代码正在工作。我们 100% 确定问题发生在这个类中，它试图绘制弹珠来移动。

```
package com.example.marblez;
import com.example.marblez.R;
import android.app.Activity;
import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.BitmapFactory.Options;
import android.graphics.Canvas;

import android.hardware.Sensor;
import android.hardware.SensorEvent;
import android.hardware.SensorEventListener;
import android.hardware.SensorManager;
import android.util.Log;
import android.view.Display;
import android.view.KeyEvent;
import android.view.MotionEvent;
import android.view.Surface;
import android.view.View;
import android.view.WindowManager;

public class MarblezView extends View implements SensorEventListener{

//Sensor Stuff
private SensorManager mSensorManager;
private Display mDisplay;

//Accelerometer sensor stuff 
private Sensor mAccelerometer;
private float mSensorX;
private float mSensorY;

//Variables related to time 
private long mCpuTimeStamp;
private long mSensorTimeStamp;
private WindowManager mWindowManager;

//Create the canvas 
private Canvas mCanvas; 
private MarblezBackground background;

//Create the ball objects
private Bitmap mBall;
private Bitmap ball;

//Finally call marblez system 
private final MarblezSystem mMarblezSystem = new MarblezSystem();

//Constructor for Marblez View 
@SuppressWarnings("deprecation")
public MarblezView(Context context, Activity activity){
    super(context);

    //Setup sensor stuff
    mSensorManager = (SensorManager) context.getSystemService(Context.SENSOR_SERVICE);
    mAccelerometer = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
    mSensorManager.registerListener(this, mAccelerometer, SensorManager.SENSOR_DELAY_UI);

    mWindowManager = (WindowManager) context.getSystemService(Context.WINDOW_SERVICE);
    mDisplay = mWindowManager.getDefaultDisplay();

    //Set up Maze 
    background = new MarblezBackground(activity);

    //Create our rolling little friend :-) 
    Options opts = new Options();
    opts.inDither = true;
    opts.inPreferredConfig = Bitmap.Config.RGB_565;

    mBall = BitmapFactory.decodeResource(activity.getApplicationContext().getResources(), R.drawable.ball, opts);

    // Rescale the ball to be whatever size you wish it to be
    final int dstWidth = (int) 30;//(sBallDiameter * mMetersToPixelsX + 0.5f);
    final int dstHeight = (int) 30;//(sBallDiameter * mMetersToPixelsY + 0.5f);
    ball = Bitmap.createScaledBitmap(mBall, dstWidth, dstHeight, true);

}

 @Override
 public void onSensorChanged(SensorEvent event) {
    if (event.sensor.getType() != Sensor.TYPE_ACCELEROMETER)
         return;
     /*
      * record the accelerometer data, the event's timestamp as well as
      * the current time. The latter is needed so we can calculate the
      * "present" time during rendering. In this application, we need to
      * take into account how the screen is rotated with respect to the
      * sensors (which always return data in a coordinate space aligned
      * to with the screen in its native orientation).
      */
     mSensorX =  event.values[0];
     mSensorY = -event.values[1];

     mSensorTimeStamp = event.timestamp;
     mCpuTimeStamp = System.nanoTime();
 }

//Automatic call
@Override
public void onDraw(Canvas canvas){
    //mCanvas = canvas;

    //Draw the maze
    //background.drawMaze(canvas);

    //Update the position and then draw the marble 
    final MarblezSystem marblezSystem = mMarblezSystem;
    final long now = mSensorTimeStamp + (System.nanoTime() - mCpuTimeStamp);
    final float sx = mSensorX;
    final float sy = mSensorY;

    marblezSystem.updatePositions(sx, sy, now);
    final float x = marblezSystem.getPosX();
    final float y = marblezSystem.getPosY();
    canvas.drawBitmap(ball, x, y, null);

    //Invalidate so it draws again 
    invalidate();

}

@Override
public void onAccuracyChanged(Sensor sensor, int accuracy) {
}

} 
```

我们遇到了阻碍我们的大理石减速的问题。我们使用的是三星 Galaxy 平板电脑，我相信是 10.1。如果有人能看出是什么导致我们的大理石移动缓慢，请告诉我们。我们在 onDraw 方法中做些什么吗？所有的阅读，包括指南，似乎都表明这应该有效，但我们似乎无法理解为什么我们的大理石移动如此缓慢。

感谢您的考虑，GeekyOmega

编辑：

读者想看 updatePositions()，改编自 google 开源示例，所以这里是：

```
package com.example.marblez;

public class MarblezSystem {

  private long mLastT;
  private float mLastDeltaT;
  private Marblez ball;

  MarblezSystem() {
      /*
       * Initially our marble have no speed or acceleration
       */
          ball = new Marblez();
      }

  /*
   * Update the position of marble in the system using the
   * Verlet integrator.
   */
  public void updatePositions(float sx, float sy, long timestamp) {
      final long t = timestamp;
      if (mLastT != 0) {
          final float dT = (float) (t - mLastT) * (1.0f / 1000000000.0f);
          if (mLastDeltaT != 0) {
              final float dTC = dT / mLastDeltaT;
                  //Particle ball = mBalls[i];
                  ball.computePhysics(sx, sy, dT, dTC);

          }
          mLastDeltaT = dT;
      }
      mLastT = t;
  }

  public float getPosX() {
      return ball.mPosX;
  }

  public float getPosY() {
      return ball.mPosY;
  }

}//End of MarblezSystem 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T01:09:47.747

我认为您的问题与您的 FPS 设置有关。我在您的代码中没有看到它。
如果您不考虑 FPS 和当前帧速率，那么当 cpu 的负载变重时，事情会慢慢移动。
我记得遇到过类似的问题并完成了本[教程](http://www.edu4java.com/androidgame.html)，之后一切顺利。
如果您有时间，请尝试通过它。
希望这可以帮助。

# database - 如何将数据从一个数据库复制到不同服务器上的另一个数据库？

> ID：13595333
> 
> 赞同：1
> 
> 时间：2012-11-27T23:49:21.910
> 
> 标签：database, oracle, testing, backup, sqlplus

我在不同的服务器上有 2 个具有相同架构的数据库。我需要将数据从表 T 复制到不同服务器和网络的测试数据库中的同一个表 T。

最简单的方法是什么？我听说可以将数据转储到平面文件中，然后插入到数据库中。它是如何工作的？这可以使用sqlplus和oracle数据库来实现吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T00:52:40.253

使用Oracle导出将整个表导出到文件，将文件复制到服务器B并导入。

```
http://www.orafaq.com/wiki/Import_Export_FAQ 
```

您可以使用 rsync 将一个或多个 oracle .dbf 文件同步到另一台服务器。这有问题，并且同步所有文件更可靠。

对于记录组，编写一个查询来构建一个管道分隔（或任何适合您的数据的分隔符）文件，其中包含您需要移动的行。将该文件复制到 serverB。为 sqlldr 编写一个控制文件并使用 sqlldr 将行加载到表中。sqlldr 是 oracle 安装的一部分。

```
http://www.thegeekstuff.com/2012/06/oracle-sqlldr/ 
```

如果您在每台服务器上都有 db 侦听器并且 tnsnames 知道这两者，您可以直接：

```
insert into mytable@remote 
select * from mytable
  where somecolumn=somevalue; 
```

查看远程表部分：

```
http://docs.oracle.com/cd/B19306_01/server.102/b14200/statements_9014.htm 
```

如果这将是一个持续的事情，请创建一个从 instance@serverA 到 instance@serverB 的 db 链接。然后，您可以对一个实例或另一个实例或两者上的数据执行您有权执行的任何操作。

```
http://psoug.org/definition/CREATE_DATABASE_LINK.htm 
```

# java - 似乎我的接收方法没有在 java 中的多播套接字上获取数据包

> ID：13595335
> 
> 赞同：2
> 
> 时间：2012-11-27T23:49:36.943
> 
> 标签：java, multithreading, multicastsocket

在 java 中使用多播套接字时接收方法有问题。有一些主机希望使用多播套接字进行群聊。在每个主机上启动两个线程（读取和写入），并且它们都使用加入组 IP 的多播套接字。问题是当receive方法执行时，它没有返回之前从其他主机在它的写线程上发送的数据报包。这是什么问题？这是读取线程的运行方法中的一些代码：

```
byte buff[]=new byte[576];
DatagramPacket DataPkt=new DatagramPacket(buff, 576);
MultiReadSocket.receive(DataPkt);
System.out.println("Datagram Packet: " + DataPkt);
ByteArrayInputStream bais = new ByteArrayInputStream(buff);
ObjectInputStream ois = new ObjectInputStream(bais);
MyPkt = (MyPacket)ois.readObject(); 
```

写线程的run方法中的代码：

```
ByteArrayOutputStream baos = new ByteArrayOutputStream();
ObjectOutputStream oos = new ObjectOutputStream(baos);
oos.writeObject(MyPkt);
DatagramPacket DataPkt = new DatagramPacket(baos.toByteArray(),    baos.toByteArray().length,InetAddress.getByName("235.0.0.2"), 2020);
MultiWriteSocket.send(DataPkt); 
```

如果需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T22:35:46.500

正如我在评论中提到的，如果不查看所有代码，很难确定发生了什么，但似乎至少在“读取”场景中，您没有将多播套接字加入多播组。

有关更多信息，请参阅[MulticastSocket 的文档。](http://download.java.net/jdk7/archive/b123/docs/api/java/net/MulticastSocket.html#joinGroup%28java.net.InetAddress%29)在 JavaDoc 的顶部有一个很好的、简单的书写和阅读示例。

# php - 我们可以使用 PHP 重新格式化链接/url 结构吗？

> ID：13595339
> 
> 赞同：-1
> 
> 时间：2012-11-27T23:49:52.653
> 
> 标签：php, url, url-rewriting

我们如何 使用 PHP将链接结构从[http://mysite.com/my_page/6](http://mysite.com/my_page/6)重新格式化为[http://mysite.com/my_page/LittleThings ？](http://mysite.com/my_page/LittleThings)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:52:22.597

不，

因为这是服务器端的问题。服务器确定请求，解析它并决定应该执行哪个 php 文件。因此，如果要将请求转发到其他文件，则必须通过服务器设置来执行此操作。例如，您可以使用*.htaccess*文件执行此操作。

有一些例子： http: [//kb.mediatemple.net/questions/242/How+do+I+redirect+my+site+using+a+.htaccess+file%3F#all/-instructions--](http://kb.mediatemple.net/questions/242/How+do+I+redirect+my+site+using+a+.htaccess+file?#all/-instructions--)

# objective-c - 如何将视频添加到主从应用程序中？

> ID：13595346
> 
> 赞同：1
> 
> 时间：2012-11-27T23:50:35.580
> 
> 标签：objective-c, mpmovieplayercontroller, xcode4.5

我的应用程序包含一个带有表格视图单元格的主视图，单击该单元格时会转到详细视图。我目前正在使用最新版本的 xcode (4.5)，如果能帮助我将视频编码到我的应用程序中，我将不胜感激。该视频应独立于 wifi。

# javascript - 如何使用此代码段为检测到的每种语言执行不同的操作？

> ID：13595347
> 
> 赞同：-2
> 
> 时间：2012-11-27T23:50:37.677
> 
> 标签：javascript, jquery, wordpress

有人从[如何使用 javascript 获取浏览器当前区域设置首选项中向我引用了这个片段？](https://stackoverflow.com/questions/2678230)

```
 var l_lang;
 if (navigator.userLanguage) // Explorer
  l_lang = navigator.userLanguage;
 else if (navigator.language) // FF
  l_lang = navigator.language;
 else
  l_lang = "en"; 
```

我想知道如何添加它来为每种语言做一些事情。如何使用 if then 语句返回语言并为每个语言做一些事情？这就是我的想法。

```
 var l_lang;
 if (navigator.userLanguage) // Explorer
  l_lang = navigator.userLanguage;
 else if (navigator.language) // FF
  l_lang = navigator.language;
 else
  l_lang = "en"; 
  'do something
  l_lang = "fr"; 
  'do something
  l_lang = "ru"; 
  'do something
  l_lang = "de"; 
  'do something 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:04:45.893

尝试使用 javascript switch 语句（[文档](http://www.w3schools.com/js/js_switch.asp)）

```
switch(l_lang)
{
case 'en':
  //execute code block 1
  break;
case 'fr':
  //execute code block 2
  break;
default:
  //code to be executed if n is different from case 1 and 2
} 
```

# c# - 如何使用虚线边框或双线边框创建文本框

> ID：13595349
> 
> 赞同：6
> 
> 时间：2012-11-27T23:50:44.573
> 
> 标签：c#, wpf, xaml

如何在 XAML 或 C# 代码中创建以下两个文本框（不是矩形）

[![带边框的文本框](../Images/581b52ed280650a7fb28bae123497529.png)](https://i.stack.imgur.com/MCpWC.png)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-28T00:44:38.403

您可以使用矩形创建“破折号”样式

```
<Window x:Class="WpfApplication5.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <Grid>
        <TextBlock Width="200" Height="40" Name="Textblock1" Text="Hello World!" TextAlignment="Center" FontSize="20"/>
        <Rectangle Width="{Binding ElementName=Textblock1, Path=ActualWidth}" Height="{Binding ElementName=Textblock1, Path=ActualHeight}" StrokeDashArray="0.0 6.0 0.0" Stroke="Black" StrokeThickness="2"  />
    </Grid>
</Window> 
```

![在此处输入图像描述](../Images/fea411a8355b90142318938ee0e04606.png)

对于双线，您可能会创建 2 个边框

```
<Window x:Class="WpfApplication5.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <Grid>
        <Border BorderBrush="Black" Width="200" Height="40" BorderThickness="1">
            <Border BorderBrush="Black" Margin="2" BorderThickness="1">
                <TextBlock  Name="Textblock1" Text="Hello World!" TextAlignment="Center" FontSize="20"/>
            </Border>
        </Border>
    </Grid>
</Window> 
```

![在此处输入图像描述](../Images/de511d4419b5fafb62ab95e7bf549382.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-28T03:30:40.687

您应该使用 Blend 来编辑文本框的控件模板。我这样做是为了你的双重身份。

```
 <Style x:Key="DashedTextBoxStyle" BasedOn="{x:Null}" TargetType="{x:Type TextBox}">
        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
        <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Padding" Value="1"/>
        <Setter Property="AllowDrop" Value="true"/>
        <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
        <Setter Property="ScrollViewer.PanningMode" Value="VerticalFirst"/>
        <Setter Property="Stylus.IsFlicksEnabled" Value="False"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type TextBox}">
                    <Border BorderBrush="Black" BorderThickness=".5">
                         <Border BorderBrush="Black" Margin="1" BorderThickness=".5">
                                <ScrollViewer x:Name="PART_ContentHost" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                    </Border>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsEnabled" Value="false">
                            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsInactiveSelectionHighlightEnabled" Value="true"/>
                    <Condition Property="IsSelectionActive" Value="false"/>
                </MultiTrigger.Conditions>
                <Setter Property="SelectionBrush" Value="{DynamicResource {x:Static SystemColors.InactiveSelectionHighlightBrushKey}}"/>
            </MultiTrigger>
        </Style.Triggers>
    </Style> 
```

并将其应用于文本框之类的。

```
<TextBox Text="Hello world" Width="100" Height="30.667" Canvas.Left="150" Canvas.Top="90" Style="{DynamicResource DashedTextBoxStyle}"/> 
```

您可能需要对其进行自定义以获得更好的外观。我还从样式中删除了默认边框。

你可以为你的虚线做同样的事情。

希望能帮助到你。

# xml - 使用 XSL 从 XML 创建 XHTML - 具有预定义宽度的表格

> ID：13595350
> 
> 赞同：1
> 
> 时间：2012-11-27T23:50:45.620
> 
> 标签：xml, xslt, xhtml

想象一下下面的 XML

```
<?xml version="1.0" encoding="ISO-8859-1"?>

<bookstore>

<book>
  <title lang="eng">Harry Potter</title>
  <price>29.99</price>
</book>
<book>
  <title lang="eng">Learning XML</title>
  <price>39.95</price>
</book>
<book>
  <title lang="eng">A book</title>
  <price>39.95</price>
</book>
<book>
  <title lang="eng">Another Book</title>
  <price>39.95</price>
</book>

</bookstore> 
```

我需要创建一个 XSL 样式表，以 XHTML 格式显示这个 XML 文件，每行只有 2 本书。XML 文件中的书籍数量可能随时更改，因此 XSL 需要能够考虑到这一点。我认为解决此问题的一种方法是将数据放入表格中，但是我无法绞尽脑汁想出一种有效的方法来创建它。可能的想法是执行模 2 检查或将总账簿除以 2，但仍无法得出结论如何编写此代码以创建有效代码。以下是我在一个长列中一个接一个地显示所有书籍的初始解决方案。

```
 <?xml version="1.0" encoding="ISO-8859-1"?> 
```

```
<xsl:template match="/">
    <html>
        <head>
        <link rel="stylesheet" type="text/css" href="css/theStyle.css" />
        </head>
        <body onload="parent.alertsize(document.body.scrollHeight);">

            <div>

                <!--  <p><xsl:value-of select="count(//book)"/></p>-->
                <xsl:for-each select="/bookstore/book">

                        <h4><xsl:value-of select='title' /></h4>
                        <p><xsl:value-of select='price' /></p>

                    <!--<xsl:if test="postion() mod 2 = 0">
                        <p>a mod 0</p>
                    </xsl:if>-->
                </xsl:for-each>

            </div>

        </body>
    </html>
</xsl:template> 
```

非常感谢任何提示/指针/解决方案。（不一定需要表格作为解决方案，我只是认为这可能是一种选择）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:35:16.927

**解决方案**

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:template match="/">
    <html>
      <head>
        <link rel="stylesheet" type="text/css" href="css/theStyle.css" />
      </head>
      <body onload="parent.alertsize(document.body.scrollHeight);">
        <div>
          <xsl:apply-templates select="bookstore/book"/>
        </div>
      </body>
    </html>
  </xsl:template>
  <xsl:template match="book[position() mod 2 = 1]">
    <h4>
      <xsl:value-of select='title' />
    </h4>
    <p>
      <p>a mod 1</p>
      <xsl:value-of select='price' />
    </p>
  </xsl:template>
  <xsl:template match="book[position() mod 2 = 0]">
    <h4>
      <xsl:value-of select='title' />
    </h4>
    <p>
      <p>a mod 0</p>
      <xsl:value-of select='price' />
    </p>
  </xsl:template>

</xsl:stylesheet> 
```

**结果**

```
<html>
  <head>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" href="css/theStyle.css">
  </head>
  <body onload="parent.alertsize(document.body.scrollHeight);">
    <div>
      <h4>Harry Potter</h4>
      <p>
        <p>a mod 1</p>29.99</p>
      <h4>Learning XML</h4>
      <p>
        <p>a mod 0</p>39.95</p>
      <h4>A book</h4>
      <p>
        <p>a mod 1</p>39.95</p>
      <h4>Another Book</h4>
      <p>
        <p>a mod 0</p>39.95</p>
    </div>
  </body>
</html> 
```

**解释**

您可以使用循环`xsl:if`来实现相同的结果，但模板功能更强大。您可以将它们视为仅应用于匹配参数的函数。它肯定有助于减少代码的缩进，并将奇数和偶数书籍的模板彼此分开。

# json - 如何在 JSON 输出中排除某些 modelAttributes（使用 ContentNegotiatingViewResolver）

> ID：13595352
> 
> 赞同：0
> 
> 时间：2012-11-27T23:50:56.603
> 
> 标签：json, spring-mvc, jackson

我有一个 Spring MVC 3.1.0 项目，并且我已经配置了一个`ContentNegotiatingViewResolver`bean 来为给定的端点（使用`org.springframework.web.servlet.view.json.MappingJacksonJsonView`）自动生成 JSON 输出。

我有一些控制器方法将数据添加到 JSP 页面（通过`model.addAttribute("foo", fooService.getFoo());`），我不想出现在 JSON 输出中。

我尝试向我的服务方法（返回 a ）添加`@JsonIgnore`注释，但它不起作用。当我点击那个控制器时，我仍然看到 foo 对象在我的 JSON 输出中被编组。`getFoo()``Map<String, String>`

谁能提出另一种实现这一目标的方法或告诉我为什么`JsonIgnore`注释不起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:12:42.387

`MappingJacksonJsonView`将模型的所有内容序列化为 json - 您放置在模型对象中的所有对象，因此您是否使用 标记了服务方法之一并不重要`@JsonIgnore`，只要它最终出现在它所做的模型中因为对它的调用`model.addAttribute("foo"..`会被序列化。修复可能只是不添加模型属性，或者使用`@ResponseBody`它可以让您控制正在序列化的特定响应对象。

另一种选择是指定配置时将使用的确切键`MappingJacksonJsonView`：

```
<bean class="org.springframework.web.servlet.view.json.MappingJacksonJsonView" name="jsonView">
<property name="modelKeys">
   <set>
    <value>model1</value>
    <value>model2</value>
   </set>
</property>
</bean> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-14T19:02:16.540

扩展 MappingJackson2JsonView 类并覆盖 filterMap(Map model) 方法。在 filterMap 方法中，过滤掉您需要排除的名称为 modelAttributes 的键。

```
public class MappingJackson2JsonViewExt extends MappingJackson2JsonView {
    private static final Set<String> EXCLUDED_KEYS = new HashSet<>();

    public static void excludeModelKey(final String key) {
        EXCLUDED_KEYS.add(key);
    }

    @Override
    protected Object filterModel(final Map<String, Object> model) {
        final Map<String, Object> filteredModel = model.entrySet().stream()
                .filter(e -> {
                    final String key = e.getKey();
                    return !EXCLUDED_KEYS.contains(key);
                })
                .collect(Collectors.toMap(Map.Entry::getKey, Map.Entry::getValue));

        return super.filterModel(filteredModel);
    }
} 
```

# wordpress - 有没有替代 wp_list_categories

> ID：13595354
> 
> 赞同：0
> 
> 时间：2012-11-27T23:51:01.270
> 
> 标签：wordpress, categories, wp-list-categories

我想使用它们的层次结构显示所有类别的列表。我想在点击类别时使用jquery来操作其他对象，所以我需要删除默认添加的链接。

wp_list_categories 做得很好，自动添加子类别的层次结构并添加嵌套列表。我只是不想要默认添加的链接。

是否有替代 wp_list_categories 的替代方法，它不会为每个类别提供指向其各自页面的链接？

当我尝试 get_categories() 时，它不尊重类别的层次结构。

使用最新的 WP 版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:06:37.960

函数的输出`wp_list_categories()`通过过滤器传递，您可以使用它来修改生成的 HTML：

```
$output = apply_filters( 'wp_list_categories', $output, $args ); 
```

如果你想实际修改函数生成的 HTML，你可以扩展`Walker_Category`类，一个很好的解释可以在这里找到[http://scribu.net/wordpress/extending-the-category-walker.html](http://scribu.net/wordpress/extending-the-category-walker.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T20:38:24.650

Walker_Category 类最终对我有用。它具有我制作自定义列表所需的所有影响力。

但是，我只是想发布我的第一次尝试，这对于一个简单的列表来说效果很好。它使用嵌套循环。

```
 <div class="tab-row">
    <?php $args = array(
        'taxonomy' => 'taxonomyName',
        'parent' => 0
    );

    $categories = get_categories($args);
    $catid = array();
     foreach($categories as $category)  {

         echo '<ul class="parent-tab"><div class="parent-item">' . $category->name . '</div>';
         array_push($catid, $category->term_id);

        echo '</ul>';
    } ?>
</div>  
<div class="child-row">
    <?php 
    $countStop = count($categories);
    $i = 0;
    while ($i < $countStop) {
        echo "<ul class='child-list'>";
        $args = array(
                    'taxonomy' => 'taxonomyName',
                    'parent'   => $catid[$i]
                  );

        $categories = get_categories($args);      
             foreach($categories as $category) {
               echo '<li class="child-item">' . $category->name .'</li>';
             }
         echo "</ul>";
         $i++;  
    }

    ?>
</div> 
```

我使用 get_categories() 消除了链接，并通过仅在第一个循环和嵌套循环中显示父级来创建我的分类层次结构，通过检索父级 ID 拉出该父级的子级。

# c++ - glReadPixels() 设置 GL_INVALID_OPERATION 错误

> ID：13595355
> 
> 赞同：7
> 
> 时间：2012-11-27T23:51:21.020
> 
> 标签：c++, opengl, fbo

我正在尝试使用 FBO 实现颜色选择。我有用于渲染场景的多重采样 FBO (fbo[0])，我有用于颜色拾取的非多重采样 FBO (fbo[1])。

问题是：当我尝试从 fbo[1] 读取像素数据时，一切顺利，直到 glReadPixels 调用设置 GL_INVALID_OPERATION 标志。我查了手册，找不到原因。

创建 FBO 的代码：

```
glBindRenderbuffer(GL_RENDERBUFFER, rbo[0]);
glRenderbufferStorageMultisample(GL_RENDERBUFFER, numSamples, GL_RGBA8, resolution[0], resolution[1]);
glBindRenderbuffer(GL_RENDERBUFFER, rbo[1]);
glRenderbufferStorageMultisample(GL_RENDERBUFFER, numSamples, GL_DEPTH24_STENCIL8, resolution[0], resolution[1]);
glBindRenderbuffer(GL_RENDERBUFFER, rbo[2]);
glRenderbufferStorage(GL_RENDERBUFFER, GL_R32UI, resolution[0], resolution[1]);
glBindRenderbuffer(GL_RENDERBUFFER, rbo[3]);
glRenderbufferStorage(GL_RENDERBUFFER, GL_DEPTH24_STENCIL8, resolution[0], resolution[1]);

glBindFramebuffer(GL_DRAW_FRAMEBUFFER, fbo[1]);   
glFramebufferRenderbuffer(GL_DRAW_FRAMEBUFFER, GL_DEPTH_STENCIL_ATTACHMENT, GL_RENDERBUFFER, rbo[3]);
glFramebufferRenderbuffer(GL_DRAW_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_RENDERBUFFER, rbo[2]);
OGLChecker::checkFBO(GL_DRAW_FRAMEBUFFER);
glBindFramebuffer(GL_DRAW_FRAMEBUFFER, fbo[0]);
glFramebufferRenderbuffer(GL_DRAW_FRAMEBUFFER, GL_DEPTH_STENCIL_ATTACHMENT, GL_RENDERBUFFER, rbo[1]);
glFramebufferRenderbuffer(GL_DRAW_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_RENDERBUFFER, rbo[0]);
OGLChecker::checkFBO(GL_DRAW_FRAMEBUFFER); 
```

我的检查器保持沉默，因此 FBO 已完成。接下来是拣货代码

```
glBindFramebuffer(GL_DRAW_FRAMEBUFFER, fbo[1]);
glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT );
// bla, bla, bla
// do the rendering
unsigned int result;
glBindFramebuffer(GL_DRAW_FRAMEBUFFER, 0);
glBindFramebuffer(GL_READ_FRAMEBUFFER, fbo[1]);
int sb;
glReadBuffer(GL_COLOR_ATTACHMENT0);
glBindBuffer(GL_PIXEL_PACK_BUFFER, 0);
glGetIntegerv(GL_SAMPLE_BUFFERS, &sb);
//    glBindFramebuffer(GL_READ_FRAMEBUFFER, 0);
OGLChecker::getGlError();
std::cerr << "Sample buffers " << sb << std::endl;
glReadPixels(pos.x(), resolution.y() - pos.y(), 1, 1, GL_RED, GL_UNSIGNED_INT, &result);
OGLChecker::getGlError();
return result; 
```

输出：

```
Sample buffers 0
OpenGL Error : Invalid Operation 
```

有趣的事实是，如果我取消注释 glBindFramebuffer(GL_READ_FRAMEBUFFER, 0); 然后不会发生错误并且从屏幕读取像素（但我不需要这个）。

这里可能有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2019-03-13T12:24:35.660

你的问题是*格式*参数。对于具有单通道整数内部格式的纹理，正确的参数不是`GL_RED`，而是`GL_RED_INTEGER`：

```
glReadPixels(pos.x(), resolution.y() - pos.y(), 1, 1, GL_RED_INTEGER, GL_UNSIGNED_INT, &result); 
```

查看[OpenGL 文档 wiki](https://web.archive.org/web/20200626065105/https://www.khronos.org/opengl/wiki/GLAPI/glReadPixels)（重点是我的）：

> ...
> 
> **格式**
> 
> 指定像素数据的格式。对于深度、模板或深度/模板数据的传输，您必须在适当的情况下使用 GL_DEPTH_COMPONENT、GL_STENCIL_INDEX 或 GL_DEPTH_STENCIL。对于标准化整数或浮点彩色图像数据的传输，您必须使用以下之一：GL_RED、GL_GREEN、G​​L_BLUE、GL_RG、GL_RGB、GL_BGR、GL_RGBA 和 GL_BGRA。**对于非标准化整数数据的传输，您必须使用以下之一：GL_RED_INTEGER、GL_GREEN_INTEGER、GL_BLUE_INTEGER、GL_RG_INTEGER、GL_RGB_INTEGER、GL_BGR_INTEGER、GL_RGBA_INTEGER 和 GL_BGRA_INTEGER。**即使没有进行实际的像素传输（数据为 NULL 并且没有缓冲区绑定到 GL_PIXEL_UNPACK_BUFFER），您也必须为目标图像的内部格式正确设置此参数。
> 
> ...

* * *

注意：[官方参考页面](https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glReadPixels.xhtml)不完整/错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-20T22:03:36.667

如果您在 Linux 上使用 NVIDIA 的二进制驱动程序并已切换到非图形虚拟控制台（例如`CTRL`++ `ALT`）`F1`，那么任何尝试都`glReadPixels()`将返回 GL_INVALID_OPERATION (0x502)。

解决方案：切换回图形控制台（通常是`CTRL`+ `ALT`+ `F7`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T23:59:37.270

鉴于如果您取消注释该代码行，它是“固定的”，我想知道您的驱动程序是否对您撒谎说 GL_SAMPLE_BUFFERS 为 0。来自[http://www.opengl.org/sdk/docs/man/xhtml/glReadPixels.xml](http://www.opengl.org/sdk/docs/man/xhtml/glReadPixels.xml)：

```
GL_INVALID_OPERATION is generated if GL_READ_FRAMEBUFFER_BINDING is non-zero, the read framebuffer is complete, and the value of GL_SAMPLE_BUFFERS for the read framebuffer is greater than zero. 
```

# internet-explorer - 为什么 IE 会尝试打印无限页？

> ID：13595356
> 
> 赞同：0
> 
> 时间：2012-11-27T23:51:22.610
> 
> 标签：internet-explorer, printing, print-preview

当我在 IE 上点击“打印预览”时，如果它设置为“缩小以适合”，那么无限页开始添加到总页中。它从`Page 1 of 1`第二个数字开始并以每 10 秒约 100 个的速度快速增加，但速度会减慢。现在它说`Page 1 of 1272`并且每秒增加大约三倍，没有停止的迹象。

如果我将其更改为 100% 而不是“缩小以适应”，那么它会立即具有`1 of 2`并保持在那里。

我该如何开始调试呢？它只发生在这一页上。我无法在 jsFiddle 或其他任何地方复制它，因为它是一个非常复杂的站点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:04:34.827

如果您使用的是 Quirks 模式，则 IE9+ 中存在一个导致如下表达式的错误

```
expression(body.clientHeight - this.offsetTop) 
```

无限循环，因为它错误地计算了clientHeight 1px。然后它的大小继续增加。注意：我看到这种情况只是偶尔发生。

无论哪种方式，要调试它，我都会禁用所有 CSS，看看是否能解决无样式页面的问题，然后添加一些零碎的东西。

# html - a:div 周围的链接 - div 内部的样式

> ID：13595357
> 
> 赞同：0
> 
> 时间：2012-11-27T23:51:33.513
> 
> 标签：html, css

我有一个我希望可点击的 div，所以我在它周围包裹了一个“a”标签，因为它是有效的 HTML 5 并使 div 成为块级元素。

现在，我遇到的问题是在该 div 中设置内容样式，因为所有内容都显示为链接，尽管尝试了多种方法，但我还没有找到一个很好的解决方案来自定义 div 中的所有内容样式。

可以在此处查看简化的测试样本：

[http://codepen.io/anon/pen/aencq](http://codepen.io/anon/pen/aencq)

所以，我的问题基本上是，在块级 div 中设置 h2 和 p 等元素的最佳方式是什么，用 a:link 包裹。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:01:31.143

基本上发生在你身上的是 <a> 标签下的所有元素都**继承**了超链接的 css 属性（下划线、蓝色等）

为了解决这个问题，请在您的标签上创建一个 id 或类并删除/覆盖默认的锚属性。

例如要删除你做的下划线： text-decoration: none;

之后覆盖与链接相关的伪类：**:link**、**:visited**、**:hover**和**:active**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T00:05:32.657

您只需要：

```
a { color:black; text-decoration:none; } 
```

有时你会想要更具体，然后你可以像：

```
a h2 { color:red; } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T00:01:37.633

最好的方法是见仁见智。对我来说，最好的方法是尽可能使用最简洁的 CSS。仅使用您需要的[特异性](http://coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/)。例如，不要使用`a div h2`when `a h2`is all that's required。另外仅供参考，您可以执行类似的操作`a.block { display:block; }`，然后您就不需要标记中的 div 了。

# javascript - 将 var 分配给 temp var 不会阻止原始 var 更改

> ID：13595359
> 
> 赞同：0
> 
> 时间：2012-11-27T23:51:39.493
> 
> 标签：javascript, node.js

好的堆栈溢出，

我一直在努力解决 javascript 中的问题（在 NodeJS 服务器中编写），但我真的不明白。

这就是发生的事情：

```
var data = {x: 50};
var temp = data;
temp.x = 100;
console.log(data.x);
//logs 100 
```

我已经测试了这个确切的代码，它确实显示了`100`。

我的问题：

如何将 var 克隆为临时变量并更改临时变量而不改变原始变量。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T23:53:44.543

您必须克隆原始对象。这是因为将对象存储在另一个变量中不会创建具有与前一个相同属性的新对象。它只是创建对同一对象的引用。可悲的是，没有任何内置的解决方案可以解决这个问题，但有一些解决方案。这里想到了一些：

```
var temp = JSON.parse(JSON.stringify(data)); // clones the object using a hack 
```

或者：

```
var temp = {}; // creates a new object and gives it all the same properties as
               // the old one.
for(prop in data) {
    if(data.hasOwnProperty(prop)) {
        temp[prop] = data[prop];
    }
} 
```

不要自我推销，但我已经写了一篇关于这个主题的博客文章，其中更详细一点。你可以在[这里](http://heyjavascript.com/4-creative-ways-to-clone-objects/)找到。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T23:53:53.873

将对象分配给变量不会生成对象的副本。它只是创建对同一对象的另一个引用。然后，两个变量都将指向完全相同的对象，并且更改其中一个（在您的示例中）的属性`data`将`temp`更改完全相同的对象。

要制作对象的副本，必须通过将所有属性复制到新对象来实际制作对象的显式副本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T01:04:11.473

您可以使用[`clone`](http://documentcloud.github.com/underscore/#clone)下划线库的方法轻松克隆对象。

```
var temp = _.clone(data); 
```

# xcode - 尝试使用 SDL 在 Xcode 中编译时出错

> ID：13595363
> 
> 赞同：0
> 
> 时间：2012-11-27T23:51:58.583
> 
> 标签：xcode, sdl

我正在尝试在 Xcode 中使用 SDL 编译项目并得到错误：

```
Undefined symbols for architecture x86_64:
  "_main", referenced from:
     -u command line option 
```

我将 SDL.framework 与 Cocoa.framework 一起包含在 Link Binary with Libraries 中。我在项目中也有 SDLMain.h 和 SDLMain.m。

这是我的所有代码：

```
#include "SDLMain.h"
#include <SDL/SDL.h>

int main(int argc, const char * argv[])
{
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T13:43:50.957

int main 必须如下所示：

```
int main(int argc, char * argv[])
{
    return 0;
} 
```

摆脱 const

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:47:39.773

在我运行 SDL 和 Xcode 之前，它使用了很长时间。所以，别在意。:-)

我在这里为 Xcode 4.5 和 Mac OS X 10.7 和 10.8上传[了一个简单的 SDL 模板（也可以使用 OpenGL 3.2 Core Profile）。](http://www.michaeldorner.de/wp-content/uploads/2012/12/SDL_Template.zip)分步说明：

1.  下载[SDL](http://www.libsdl.org/release/SDL-1.2.15.dmg)（目前版本 1.2.15）
2.  打开下载的 .dmg 文件
3.  复制`SDL.framework`到`/Library/Frameworks/`
4.  完毕。您可以使用 Xcode 模板（您应该看到一个红色区域）： ![在此处输入图像描述](../Images/97527a7aa2727acdbaa1b88573dadf50.png)

更多细节和我[博客](http://www.michaeldorner.de/?p=2644)上的图片（仅限德语​​，抱歉）。

# popup - 如何将鼠标滚动限制为模态？

> ID：13595366
> 
> 赞同：1
> 
> 时间：2012-11-27T23:52:17.907
> 
> 标签：popup, scroll, modal-dialog, lightbox

我有一个带有可滚动内容的模式，可以使用 overflow-y: scroll;

问题是，当使用鼠标滚轮在模态框内滚动并到达内容末尾时，主页会滚动。我的客户要求我防止这种情况发生。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-15T08:39:27.420

To achieve this I used the "show" and "hide" events of the modal. I'm using Twitter Bootstrap modal so they have these events, but I guess any good modal plugin will have them. For the "show" event, I binded a function that removes scrolling on the body. For the "hide" event, I binded a function that reenables it. Here's how I did it:

```
modal = $('#myModal');
modal.on('show', function () {
    // disable background scrolling
    $('body').css('overflow', 'hidden');
});
modal.on('hide', function () {
    // enable background scrolling
    $('body').css('overflow', 'auto');
}); 
```

You can of course disable/enable scrolling on the container of your choice. Hope this helps.

# regex - 带有双引号的字符串的scala正则表达式

> ID：13595367
> 
> 赞同：0
> 
> 时间：2012-11-27T23:52:22.147
> 
> 标签：regex, scala, replace

我正在努力使用scala中的正则表达式将带有两个文本的消息连接成一个文本

```
original message = "part1 "+" part2"
original message = "part1 "   + " part2"
original message = "part 1 "+    " part2"

concatenated message = "part1 part2" 
```

我正在使用的是下面的代码（至少将 + 号替换为 null）

```
val line:String = """"text1"+"text2"""" //My original String which is "text1"+"text2"
val temp_line:String = line.replaceAll("\\+","")
println(temp_line) 
```

它工作正常并产生“text1”“text2”。有没有办法使用正则表达式获取输出“text1 text2”？

请帮忙。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T18:16:56.617

对于正则表达式来说，这确实不是一个理想的问题，但是可以：

```
val Part = """"([^"]*)"(.*$)""".r    // Quotes, non quotes, quotes, then the rest
val Plus = """\s*\+\s*(.*)""".r      // Plus with optional spaces, then the rest

def parts(s: String, found: List[String] = Nil): String = s match {
  case Part(p,rest) => rest match {
    case "" => (p :: found).map(_.filter(c => !c.isWhitespace)).reverse.mkString(" ")
    case Plus(more) => parts(more, p :: found)
    case x => throw new IllegalArgumentException(s"$p :$x:")
  }
  case x => throw new IllegalArgumentException(s"|$x|")
} 
```

这只是将输入字符串一块一块地分开；如果你想看看它是如何工作的，你可以添加 printlns。（请注意，这`+`是正则表达式中的特殊字符，因此您需要对其进行转义以匹配它。）

```
scala> parts(""""part1 "+" part2"""")
res1: String = part1 part2

scala> parts(""""part1 "   + " part2"""")
res2: String = part1 part2

scala> parts(""""part 1 "+    " part2"""")
res3: String = part1 part2 
```

# charts - Revmob 和 Chartboost 出现得太晚了（滞后？）

> ID：13595376
> 
> 赞同：1
> 
> 时间：2012-11-27T23:52:53.330
> 
> 标签：charts, popup, revmob

我正在制作一个 iPhone/iPad 应用程序，但遇到以下问题：我想在我的游戏屏幕上弹出一个 revmob 或 chartboost 广告，它有一个重启按钮。广告确实会弹出，但当它们出现时，玩家可能会按下重新启动并再次进入游戏。广告最终出现在游戏屏幕上（我不想要），而不是最终出现在游戏结束屏幕上。有什么方法可以确保在调用各自的广告显示功能后立即弹出 chartboost 和 revmob 广告？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T18:28:28.537

对于 Chartboost，我建议您在调用 showInterstitial 之前使用 cacheInterstitial 方法。通过缓存广告，您实际上是从服务器获取广告并将其临时加载到用户设备上。缓存广告后，等待大约 10 秒左右，然后调用 showInterstitial。这将加快展示广告的过程。

您还可以利用委托方法 shouldDisplayInterstitial。如果现在不是展示广告的合适时间，您可以将其设置为 NO。查看以下链接以获取帮助

[http://help.chartboost.com/documentation/ios](http://help.chartboost.com/documentation/ios) [https://github.com/ChartBoost/client-examples](https://github.com/ChartBoost/client-examples)

此外，如果您有任何其他问题，请发送电子邮件至 support@chartboost.com。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T19:42:29.660

使用 RevMob，您无法预加载弹出窗口，但您可以使用全屏进行预加载，这也能更好地获利！

您可以在一个地方创建和加载全屏并将其保留在一个属性中：

```
@property (nonatomic, retain) RevMobFullscreen *ad;

self.ad = [[RevMobAds session] fullscreen];
self.ad.delegate = self;
[self.ad loadAd]; 
```

然后在游戏结束屏幕上显示它：

```
[self.ad showAd]; 
```

他们有一个 API 文档[站点](http://sdk.revmob.com/ios-api/index.html)。

# javascript - 如何以懒惰的方式调用jquery的.find？

> ID：13595379
> 
> 赞同：0
> 
> 时间：2012-11-27T23:53:10.183
> 
> 标签：javascript, jquery, iteration, lazy-evaluation

使用 jquery 定位 XML DOM 结构中的一组元素时；

将 .find 与 CSS 查询一起使用将产生一个可以迭代的结果，但是 jquery 将返回当时的所有结果，这很慢并且会暂停我的 UI。

我如何以一种懒惰的方式迭代结果？

我观察到有一个 .first() 方法，但是我在文档中找不到 .next() ，我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T23:57:35.100

是的，您可以使用 a[`next()`](http://api.jquery.com/next/)和 a[`prev()`](http://api.jquery.com/prev/)转到 DOM 结构中的下一个或上一个兄弟姐妹。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T00:18:20.987

我最好的建议是包含您的搜索。永远不要运行全局查询。如果可能，从可以通过 ID 检索的元素开始搜索（以限制要遍历的节点数）

例如，而不是以下

```
var infoList = $("a.query span.info") 
```

采用

```
var container = $('#myCt');
var infoList = container.find('a.query span.info');
// OR more simply (but I'm not sure jQuery optimizes the query)
var infoList = container.find('#myCt a.query span.info') 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-11-27T23:56:43.653

```
$(".class").each(function() {
//do code here
}); 
```

# php - is_file() 在 Zend Framework 2 模型中返回 false

> ID：13595383
> 
> 赞同：0
> 
> 时间：2012-11-27T23:53:32.150
> 
> 标签：php, zend-framework2

我正在学习 Zend Framework 2，我正在尝试使用以下信息连接到 ldap：http: [//framework.zend.com/manual/2.0/en/modules/zend.authentication.adapter.ldap.html](http://framework.zend.com/manual/2.0/en/modules/zend.authentication.adapter.ldap.html)。

此行返回错误：$configReader->fromFile('foo.ini')

查看源 Zend\Config\Reader\Ini is_file() 返回 false。我已将整个应用程序更改为 777，因此权限不是问题。

我设置了一个测试，你可以在这里看到：

```
app/public/ldapconfig.ini
app/public/isfiletest.php
--- var_dump(is_file('ldapconfig.ini')); (true)

app/module/Foo/src/Foo/Model/ldapconfig.ini
app/module/Foo/src/Foo/Model/Bar.php
--- var_dump(is_file('ldapconfig.ini')); (false) 
```

上面代码的最后一行位于控制器调用的公共函数中。有什么想法为什么行为会有所不同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T09:13:26.337

为了澄清 Ards 的答案：

ZF2 中的所有内容都基于 Projects ROOT Path。这是在 public/index.php 使用`chdir(dirname(__DIR__));`. 这意味着每个未来的包含都基于项目`./`

此外，我建议遵循最佳实践并将配置文件放入配置文件夹`./module/Foo/config/ldapconfig.ini`。这比将配置文件放入模型源更有意义；）

最后一点：INI 解析（就像在 ZF1 中所做的那样）比 ZF2 样式（或者更确切地说是基本的 PHP）数组要慢得多；）您可能也想切换回基础。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:13:19.260

我不确定 Zend 框架是如何设置的，但我认为当你执行代码时，根路径是不同的

尝试

```
var_dump(is_file('../module/Foo/src/Foo/Model/ldapconfig.ini')); 
```

或者

```
var_dump(is_file('./ldapconfig.ini')); 
```

# xaml - 添加 Pivot 和其他 Microsoft.Phone 控件时，Visual Studio 2012 XAML UI 设计器引发异常

> ID：13595390
> 
> 赞同：2
> 
> 时间：2012-11-27T23:54:06.223
> 
> 标签：xaml, visual-studio-2012, designer, windows-phone-8

每当我向 Microsoft.Phone 命名空间（Pivot、Panorama 等）中的 Windows Phone 8 应用程序添加任何控件时，XAML 设计器都会抛出：

> 对 COM 组件的调用已返回错误 HRESULT E_FAIL。

堆栈跟踪似乎有所不同，这是在文档大纲中选择全景后的跟踪：

```
at Microsoft.Phone.Controls.Design.PanoramaItemAdorner.Activate(ModelItem item)
   at Microsoft.Windows.Design.Interaction.AdornerProvider.InvokeActivate(EditingContext context, ModelItem item)
   at MS.Internal.Features.AdornerProviderFeatureConnector.FeatureProvidersAdded(ModelItem item, IEnumerable`1 extensions)
   at Microsoft.Windows.Design.Policies.PolicyDrivenFeatureConnector`1.OnPolicyItemsChanged(Object sender, PolicyItemsChangedEventArgs e)
   at System.EventHandler`1.Invoke(Object sender, TEventArgs e)
   at Microsoft.Windows.Design.Policies.ItemPolicy.OnPolicyItemsChanged(PolicyItemsChangedEventArgs e)
   at Microsoft.Windows.Design.Policies.SelectionPolicy.OnSelectionChanged(Selection newSelection)
   at Microsoft.Windows.Design.ContextItemManager.SubscribeProxy`1.SubscribeContext(ContextItem item)
   at Microsoft.Windows.Design.SubscribeContextCallback.Invoke(ContextItem item)
   at Microsoft.Windows.Design.EditingContext.DefaultContextItemManager.OnItemChanged(ContextItem item)
   at Microsoft.Windows.Design.EditingContext.DefaultContextItemManager.SetValue(ContextItem value)
   at Microsoft.Expression.DesignSurface.ViewModel.Extensibility.ExtensibilityManager.SetSelection(Selection selection)
   at Microsoft.Expression.DesignSurface.ViewModel.Extensibility.ExtensibilityManager.OnViewModelEarlySceneUpdatePhase(Object sender, SceneUpdatePhaseEventArgs args)
   at Microsoft.Expression.DesignSurface.ViewModel.SceneUpdatePhaseEventHandler.Invoke(Object sender, SceneUpdatePhaseEventArgs args)
   at Microsoft.Expression.DesignSurface.ViewModel.SceneViewModel.FireEarlySceneUpdatePhase(SceneUpdatePhaseEventArgs args)
   at Microsoft.Expression.DesignSurface.Pipeline.SceneViewUpdateScheduleTask.UpdateEarly()
   at Microsoft.Expression.Utility.Scheduler.ScheduleTask.Update()
   at Microsoft.Expression.Utility.Scheduler.SchedulingService.DispatchTasksAtPriority(DispatcherPriority priority)
   at Microsoft.Expression.Utility.Scheduler.SchedulingService.DispatcherToken.Dispatch(Object arg)
   at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)
   at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler) 
```

如果文件与控件一起加载，则堆栈跟踪如下所示：

```
at MS.Internal.XcpImports.CheckHResult(UInt32 hr)
   at MS.Internal.XcpImports.Collection_InsertValue[T](PresentationFrameworkCollection`1 collection, UInt32 index, CValue value)
   at MS.Internal.XcpImports.Collection_InsertDependencyObject[T](PresentationFrameworkCollection`1 collection, UInt32 index, DependencyObject value)
   at System.Windows.PresentationFrameworkCollection`1.InsertDependencyObject(Int32 index, DependencyObject value)
   at System.Windows.Controls.UIElementCollection.InsertInternal(Int32 index, UIElement value 
```

相同的 .xaml 文件在 Blend 中工作得很好，一旦删除控件，设计器就会重新开始工作。

我尝试卸载/修复 Windows Phone 8 SDK、Visual Studio 以及 Silverlight SDK 和运行时。

还有其他想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T17:21:24.603

我遇到了同样的问题，并尝试了许多论坛上讨论的每个答案。

最后，我删除了我的“解决方案”文件 (.sln)，而不是项目，然后将我的所有项目重新添加到我的新解决方案中。

使用：VisualStudio Express 2012

脚步：

*   在 WindowsExplorer 中删除您的项目所在的解决方案 (.sln) 文件。
*   在 VisualStudio 中打开主项目文件 (.csproj)。
*   然后将所有其他“现有项目”添加回您的新解决方案。

现在效果很好......希望对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-15T06:02:08.740

当我添加参考 System.Windows.Controls.DataVisualization.Toolkit 时我遇到了同样的问题，我得到了这个错误。之后，我从路径中添加了参考 System.Windows.Controls.Toolkit：C:\Program Files\Microsoft SDKs\Silverlight\v3.0\Libraries\Client 或 C:\Program Files(x86)\Microsoft SDKs\Silverlight\ v3.0\Libraries\Client 和 VS 工作正常。也许它会帮助你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T15:26:20.233

两个想法也许相关也许不相关……

1.  检查正在使用的任何模板，也许设计师找不到它们并抛出该错误。如果模板在共享字典中，请尝试将它们移回页面/控件上的控件定义。
2.  查看您在 Xaml 中使用的任何转换器代码。由于设计时模式不处理正确的数据，您的转换器是否通过返回设计人员可以处理的有效数据来处理空情况或错误数据情况？例如 string.empty 与要转换的原始对象。换句话说，它是否正确处理了设计时模式所处的负面情况？

# java - 在类结构中找到正确的子类

> ID：13595391
> 
> 赞同：0
> 
> 时间：2012-11-27T23:54:11.450
> 
> 标签：java, class, polymorphism, subclass

我有一个类，我们称之为它`ClassA`，以及它的一堆子类，以及这些类的后续子类。`ClassA`，并且它下面的每个类都`String`在其构造函数中接受一个参数。我有一堆`String`对象需要“转换”为`ClassA`.

我目前使用的`isType(String)`方法是检查是否`String`是该子类的实例的方法，但是使用巨大的 if-else 或 switch-case 语句来查找正确的类型似乎是非常糟糕的编程`ClassA`技术`String`是。有一种常见的方法可以降低子类结构，还是我一直在做的方式好吗？

这样做的目的是我正在制作一种脚本语言（用于一个有趣的项目），并且我需要能够识别出什么是什么。（即数据类型）

示例代码：

```
public static boolean isType(String data) {
    data = data.trim();
    return edu.ata.script.data.Boolean.isType(data)
            || edu.ata.script.data.Integer.isType(data)
            || edu.ata.script.data.Double.isType(data)
            || DATA_STORAGE.contains(data)
            || ReturningMethod.isType(data)
            || edu.ata.script.data.String.isType(data);
}

public static Data get(String data) {
    data = data.trim();
    /*:)*/ if (edu.ata.script.data.Boolean.isType(data)) {
        return edu.ata.script.data.Boolean.get(data);
    } else if (edu.ata.script.data.Integer.isType(data)) {
        return edu.ata.script.data.Integer.get(data);
    } else if (edu.ata.script.data.Double.isType(data)) {
        return edu.ata.script.data.Double.get(data);
    } else if (DATA_STORAGE.contains(data)) {
        return (Data) DATA_STORAGE.get(data);
    } else if (ReturningMethod.isType(data)) {
        return ReturningMethods.getMethodValue(data);
    } else if (edu.ata.script.data.String.isType(data)) {
        // Last option because everything is accepted.
        return edu.ata.script.data.String.get(data);
    } else {
        throw new RuntimeException("Could not parse data - " + data);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:07:01.150

我确实理解了一些完全不同的东西，所以我正在重新编辑这个答案。

我怀疑您正在使用某种导入脚本或其他东西，并且`edu.ata.script.data.*`您正在编写的是 ClassB、ClassC 等，他们知道如何将内容从一种格式转换为另一种格式......（这只是猜测）

我建议摆脱方法中的所有 if then else`get(String data)`是你实现一个[责任链](http://en.wikipedia.org/wiki/Chain-of-responsibility_pattern)。这样，您可以拥有一个链，在 List 中注册几个 edu.ata.script.data.*，然后遍历该列表，直到其中一个为 isType(string) 返回 true，知道您要使用哪个子类处理字符串。

删除`isType(String data)`方法中的 OR 列表有点棘手，可能这有点过度设计，但您可以执行以下操作：

1.  在您的类路径中查找可分配的类从您的类

2.  然后，当您检索您自己可分配的所有类时，您必须通过反射调用每个类的 isType 才能知道结果

    我知道您可能会发现自己对第一点有些迷茫，最好的方法是查看Stripes Framework 中的[ResolverUtil](http://grepcode.com/file/repo1.maven.org/maven2/net.sourceforge.stripes/stripes/1.4.3/net/sourceforge/stripes/util/ResolverUtil.java#ResolverUtil.loadImplementationsFromContextClassloader%28java.lang.Class%29)类，他们在方法中执行此操作`loadImplementationsFromContextClassloader`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T01:46:52.360

看起来您正在尝试将字符串解析为正确子类的实例，方法是将其传递给每个子类的`isType`方法，直到有人说它可以处理它。我会让每个子类注册一个解析器对象，该对象可以检查字符串并在可能的情况下生成相应子类的初始化实例。

解析器接口：

```
package edu.ata.script.data;

interface ScriptParser {
    public boolean isType(String data);
    public Data    get(String data) throws UnparsableException;
} 
```

一个示例数据子类：

```
package edu.ata.script.data;

public class Boolean extends Data {

// Empty constructor for reflection purposes
public Boolean() {};

public Boolean(String data) {
    // Initialise from string
}

public ScriptParser getParser() {
    return new ScriptParser() {
        public boolean isType(String data) {
           return "true".equals(data) || "false".equals(data);
        }

        public Data get(String data) throws UnparsableException {
            if (isType(data)) {
                return new edu.ata.script.data.Boolean(data);
            } else {
                throw new UnparsableException(data);
            }
        }
    };
}

} 
```

然后，您可以在解析之前将类列表构建到集合中：

```
List<ScriptParser> parsers = new LinkedList<>();
parsers.add(new edu.ata.script.data.Boolean().getParser());
parsers.add(new edu.ata.script.data.Integer().getParser());
parsers.add(new edu.ata.script.data.Double().getParser());
... 
```

以上也可以通过反射来实现。

然后你可以用一个简单的循环解析数据，不管你最终支持多少数据类型：

```
public Data get(String data) throws SyntaxErrorException {
    for (ScriptParser sp:parsers) {
        if (sp.isType(data)) {
            try {
                return sp.get(data);
            } catch (UnparsableException e) {
                // This shouldn't happen, but better safe than sorry!
                e.printStackTrace();
            }
        }
    }
    throw new SyntaxErrorException(data);
} 
```

# ruby - ruby 正则表达式：如何获取组值

> ID：13595398
> 
> 赞同：1
> 
> 时间：2012-11-27T23:55:12.423
> 
> 标签：ruby, regex

这是我的正则表达式：

```
s = /(?<head>http|https):\/\/(?<host>[^\/]+)/.match("http://www.myhost.com") 
```

我如何获得`head`和`host`组？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T23:59:01.510

```
s['head'] => "http"
s['host'] => "www.myhost.com" 
```

你也可以使用URI ...

```
1.9.3p327 > require 'uri'
 => true 
1.9.3p327 > u = URI.parse("http://www.myhost.com")
 => #<URI::HTTP:0x007f8bca2239b0 URL:http://www.myhost.com> 
1.9.3p327 > u.scheme
 => "http" 
1.9.3p327 > u.host
 => "www.myhost.com" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T00:01:17.037

使用`captures`>>

```
string = ...
one, two, three = string.match(/pattern/).captures 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T04:22:20.973

您可能应该按照上面的建议将 uri 库用于此目的，但是每当您将字符串与正则表达式匹配时，您都可以使用特殊变量获取捕获的值：

> "foo bar baz" =~ /(bar)\s(baz)/
> 
> 1美元

=> '酒吧'

> 2美元

=> '巴兹'

等等...

# sql - 创建计算列的多个条件

> ID：13595399
> 
> 赞同：0
> 
> 时间：2012-11-27T23:55:14.617
> 
> 标签：sql, sas

我想在 SAS 企业指南中创建一个计算列，如果它满足某些条件，它将显示汽车项目。有 75 个汽车项目 (T.TS_Items)，例如挡风玻璃、轮胎、方向盘等。每个项目都有一个唯一的 ID (T.TS_NUM)，因此 T.TS_NUM =1 到 T.TS_NUM =75。然后我想给每个新车项目一个标签，例如 labelNo_01 到 labelNo_75。因此，如果车辆类型为本田 (T.TS_F_NUM = 2)，类型为日语 (T.TS_TYPE = I) 且 T.TS_NUM =1，则新列名称为 LabelName_01，其中包含挡风玻璃等项目。如果车辆类型是丰田 (T.TS_F_NUM = 1)，但其余的相同，它将给我丰田的 75 辆汽车项目。

以上内容非常简单且有效，但如果车辆类型为 Toyota (T.TS_F_NUM = 1)，我不确定如何添加 Else 语句

循环也会有所帮助，因此我不必为每种车辆类型重复该过程。希望这些信息有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:24:47.293

我想你想要：

```
Select TS_TYPE from (
    SELECT T.TS_TYPE,
    CASE T._vehicle_type = 'honda' THEN 2
       ELSE 1 
    as TS_F_NUM_Val,
    CASE TSI.TSI_DESC = 'damaged' THEN 'Not Allocated'
      ELSE TSI.TSI_DESC 
    as TSI_DESC_Val
    WHERE T.TS_TYPE = I
    AND TS_F_NUM_val=T.TS_F_NUM
    AND TSI_DESC _val=TSI.TSI_DESC 
) 
```

这样你就得到了你需要的列，并且可以有一个条件。

# java - Apache httpComponents HttpClient 4.2.2 无法通过 Webscarab 代理连接到网页

> ID：13595405
> 
> 赞同：0
> 
> 时间：2012-11-27T23:56:21.810
> 
> 标签：java, proxy, apache-httpclient-4.x

我有一个方法，它使用 Apache httpComponents HttpClient 类通过 Webscarab 代理连接到网页。[我在这里](http://hc.apache.org/httpcomponents-client-ga/httpclient/examples/org/apache/http/examples/client/ClientExecuteProxy.java)从 Apache Software Foundation 获得方法 。下面是我的打洞方法：

```
 public void HTTPGet(){
            //HttpHost proxy = new HttpHost("localhost", 8008);

            System.setProperty("http.proxyHost", "localhost");
            System.setProperty("http.proxyPort", "8008");

            HttpHost proxy = new HttpHost(System.getProperty("http.proxyHost", "localhost"),Integer.parseInt(System.getProperty("http.proxyPort", "8008")));

            DefaultHttpClient httpclient = new DefaultHttpClient();
            try {

                httpclient.getParams().setParameter(ConnRoutePNames.DEFAULT_PROXY,
                        proxy);

                HttpHost target = new HttpHost("www.google.gr/", 80);
                HttpGet req = new HttpGet("/");

                System.out.println("executing request to " + target + " via "
                        + proxy);
                HttpResponse rsp = httpclient.execute(target, req); //here I get the exception as below
                HttpEntity entity = rsp.getEntity();

                System.out.println("----------------------------------------");
                System.out.println(rsp.getStatusLine());
                Header[] headers = rsp.getAllHeaders();
                for (int i = 0; i < headers.length; i++) {
                    System.out.println(headers[i]);
                }
                System.out.println("----------------------------------------");

                if (entity != null) {
                    System.out.println(EntityUtils.toString(entity));
                }

            } catch (IOException ex) {
                Logger.getLogger(WebBrowser.class.getName()).log(Level.SEVERE, null, ex);
            } 
            finally {
                // When HttpClient instance is no longer needed,
                // shut down the connection manager to ensure
                // immediate deallocation of all system resources
                httpclient.getConnectionManager().shutdown();
            }
      } 
```

之前的 println `HttpResponse rsp = httpclient.execute(target, req);`，

返回这个：`executing request to http://www.google.gr/:80 via http://localhost:8008`

然后发生以下异常。

```
Nov 28, 2012 1:23:09 AM student.WebBrowser HTTPGet
SEVERE: null
org.apache.http.conn.HttpHostConnectException: Connection to http://localhost:8008 refused
at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:190)
at org.apache.http.impl.conn.ManagedClientConnectionImpl.open(ManagedClientConnectionImpl.java:294)
at org.apache.http.impl.client.DefaultRequestDirector.tryConnect(DefaultRequestDirector.java:640)
at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:479)
at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:906)
at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:827) 
```

当我尝试从其他浏览器（如 Firefox、Chrome 或 JavaFX webengine）访问页面时，Webcarab 会正确干扰。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T07:56:29.093

由于连接被拒绝，我只能假设 WebScarab 没有在您尝试连接的端口上侦听（在您尝试连接时）。

例如，WebScarab 没有运行，或者您已将其配置为在与默认 8008 不同的端口上侦听，或者在与 localhost (127.0.0.1) 不同的接口上进行侦听。

您的代码是否与 WebScarab 在同一台机器上运行？如果没有，您需要让 WebScarab 侦听可通过网络访问的实际网络接口，并更新您的代码以引用该 IP 地址而不是 localhost。

# ios - 我不知道对于objective-c中的文字范围我应该避免哪些块模式

> ID：13595406
> 
> 赞同：11
> 
> 时间：2012-11-27T23:56:29.653
> 
> 标签：ios, objective-c, block

在苹果的文档中说：块文字（即^{ ... }）是表示块的堆栈本地数据结构的地址。因此，堆栈本地数据结构的范围是封闭的复合语句，因此您应该避免以下示例中显示的模式：

```
void dontDoThis() {

    void (^blockArray[3])(void);  // an array of 3 block references

    for (int i = 0; i < 3; ++i) {

        blockArray[i] = ^{ printf("hello, %d\n", i); };

        // WRONG: The block literal scope is the "for" loop.
    }

    //for example I invoke the block here
    blockArray[1]();
  }

void dontDoThisEither() {

    void (^block)(void);

    int i = random():

    if (i > 1000) {

        block = ^{ printf("got i at: %d\n", i); };

        // WRONG: The block literal scope is the "then" clause.

    }

    // ...

  } 
```

我不知道我应该避免什么模式。似乎我可以调用与块定义具有相同文字范围的块，例如在“if”或“for”语句后面。你能帮我解释一下吗？

这是链接[https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/Blocks/Articles/bxUsing.html#//apple_ref/doc/uid/TP40007502-CH5-SW1](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/Blocks/Articles/bxUsing.html#//apple_ref/doc/uid/TP40007502-CH5-SW1)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-28T00:07:20.960

我认为指针的类比如下。

```
void foo() {
  int *block = NULL;
  {
    int a;
    block = &a;
  }
  // `block`, even though defined here, points to
  // an invalid memory address.
} 
```

通常，块文字本身只存在于它定义的块中，因此当离开该块时，文字会消失（就像`a`上面示例中的变量一样），并且留下一个悬空指针。

出于这个原因，块通常被复制到堆中以供将来使用。非ARC代码使用`block_copy`和朋友。复制到堆中还会捕获您的块使用的所有相关变量（这可能会创建保留周期）。

在实践中，所有这些都被 ARC、属性和类的使用完全避免了。您在类中定义一个`copy`属性，然后将块分配给它。如果您让编译器生成 getter/setter，您的块文字将自动复制到堆中。

```
@interface Bla : NSObject
@property (nonatomic, copy) void (^blockProperty)(int i);
@endf

...

Bla *bla = [[Bla alloc] init];
{
  bla.blockProperty = ^(int i) { printf("%d", i); };
}
// bla.blockProperty now points to a heap copy of the block literal from above,
// so it's not dangling. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-24T03:17:49.807

I was reading apple's documentation on blocks and did a little more research on this part. It looks to me with ARC the second example code is totally fine. I didn't try the first example. The general idea in the accepted answer is correct. However, with ARC, when you assign the literal block (NSStackBlock) to a local variable, the block is copied to heap, and if you inspect the block, you'll see it's indeed a NSMallocBlock. I also referenced this blog on this topic [https://www.cocoawithlove.com/2009/10/how-blocks-are-implemented-and.html](https://www.cocoawithlove.com/2009/10/how-blocks-are-implemented-and.html)

# sql - Rails Arel 相当于这个复杂的 sql 查询

> ID：13595413
> 
> 赞同：1
> 
> 时间：2012-11-27T23:57:19.037
> 
> 标签：sql, ruby-on-rails, arel

这是原始逻辑

```
(scrape_datas = ScrapeData.find(
  :all, :conditions => 
  "artist_status = 'NOT_FOUND' 
   AND blacklisted = 1 
   AND extracted = 0 
   and not EXISTS(
     SELECT * FROM artist_name_suggestions where original = artist_name
   ) 
```

我已经能够更好地分割第一部分

```
scrape_datas = ScrapeData.where(
  :artist_status => 'NOT_FOUND',
  :blacklisted   => 1,
  :extracted     => 0
) 
```

尽管在将“而不是 EXISTS”查询混入其中时遇到问题

```
and not EXISTS(
  SELECT * FROM artist_name_suggestions where original = artist_name
) 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T04:21:46.720

首先，您可以提取简单的范围：

```
scope :not_found, where(:artist_status => 'NOT_FOUND')
scope :blacklisted, where(:blacklisted => 1)
scope :extracted, where(:extracted => 0) 
```

然后添加一个查询方法（假设artist_name是scrape_datas的一列）：

```
def self.no_suggestions
  scrape_datas = ScrapeData.arel_table
  suggestions = ArtistNameSuggestion.arel_table
  where(ArtistNameSuggestion.where(
    suggestions[:original].eq(scrape_datas[:artist_name])
  ).exists.not)
end 
```

现在您可以执行以下操作：

```
ScrapeData.not_found.blacklisted.extracted.no_suggestions 
```

# objective-c - OSX 首选项文件 - removePersistentDomainForName 在 10.8 中具有不同的功能？

> ID：13595415
> 
> 赞同：1
> 
> 时间：2012-11-27T23:57:19.363
> 
> 标签：objective-c, xcode, macos, osx-mountain-lion

此代码适用于 10.7 上的一位开发人员，但不适用于 10.8 上的我

working = 它删除了包的首选项 .plist 文件。10.7 上的开发人员也有一个锁定文件，而我没有。这不是文件访问的问题 - 我尝试了 [resetStandardUserDefault] 并创建了一个新文件，但这并不是我们想要做的。

```
NSString *appDomain = [[NSBundle mainBundle] bundleIdentifier];        
        [[NSUserDefaults standardUserDefaults] removePersistentDomainForName:appDomain]; 
```

我无法找到有关 10.8 更改的任何信息 - 这听起来对任何人来说都很熟悉吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T13:25:14.617

我有同样的问题，确实似乎没有关于任何更改的信息，也没有收到任何错误或警告。`[NSUserDefaults resetStandardUserDefault]`对我没有任何作用。我目前所做的只是覆盖默认值以重置它们（提供`[[NSUserDefaults standardUserDefaults] setValuesForKeysWithDictionary: [NSDictionary dictionaryWithObjectsAndKeys:...]]`与最初提供给`[[NSUserDefaults standardUserDefaults] registerDefaults: [NSDictionary dictionaryWithObjectsAndKeys:...]]`.

不是真正的答案，但我没有足够的代表发表评论..

# ruby-on-rails - Rails：将局部变量从视图提交到另一个视图

> ID：13595422
> 
> 赞同：2
> 
> 时间：2012-11-27T23:57:53.653
> 
> 标签：ruby-on-rails, ruby, variables

我的观点：

```
<div class="field">

  <%= label :isbn_exist, 'ISBN' %>
  <%= text_field :isbn_exist,'ISBN' %>
</div>

<%= link_to 'Add new book', new_book_path(:isbn_exist => @isbn_exist), :class => "btn btn-warning"%> 
```

这个 ":isbn_exist" 变量不会发送到控制器。为什么？如果我输入一个数字而不是`@isbn_exist`发送这个值。我认为`text_field`没有保存`:isbn_exist`变量的值......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:18:18.753

你有一个`text_field`和一个链接。你真正想要的是一个`form`（包括这个`text_field`）和一个`submit`按钮。

您可以找到的每个 Rails 教程都包含此类内容。

# c# - 到达用户没有访问权限的文件/文件夹时 getFiles 和 getDirectories 的限制

> ID：13595425
> 
> 赞同：0
> 
> 时间：2012-11-27T23:57:59.360
> 
> 标签：c#, asp.net, .net, asp.net-mvc, asp.net-mvc-4

是否有任何解决方法来处理 getFiles 和 getDirectories 的限制以返回内容，即使它们到达拒绝访问的文件/文件夹？

我如何才能返回文件系统树，其中包含用户至少具有读取权限的所有文件/文件夹？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:13:10.307

有几个实现。基本上，您不能使用默认的，因为它会在用户权限不足时抛出异常并停止。我通常看到人们列出所有目录，然后尝试每个目录并捕获任何异常。

[.net 中的递归文件搜索](https://stackoverflow.com/questions/437728/recursive-file-search-in-net)

# image - 加载然后写入图像

> ID：13595426
> 
> 赞同：0
> 
> 时间：2012-11-27T23:58:09.190
> 
> 标签：image, opencv, load

我使用opencv读取图像并再次保存，但是当我稍后读取时数据不一样，我的意思是在我读取图像后保存它，然后复制保存的图像并读取该图像中的数据，但数据将与以前不同，我编写小代码来执行以下操作 1- 读取图像 2- 保存图像 3- 将图像数据保存到文本文件中 4- 从步骤 2 中读取保存的图像 5- 比较图像的值文本文件的值并将它们一起打印

我的代码是

```
 #include<stdio.h>
    #include<stdlib.h>
    #include<math.h>
    #include <time.h>
    #include <stdint.h>
    #include "highgui.h"

    IplImage *PlainImage=0,*CipherImage=0,*DecPlainImage=0;

    void func_printimage()
    {

    // create a window
    cvNamedWindow("Plain Image",CV_WINDOW_AUTOSIZE);
    cvMoveWindow("Plain Image", 800, 600);
    // show the image
    cvShowImage("Plain Image", PlainImage );

    // wait for a key
    cvNamedWindow("Cipher Image",CV_WINDOW_AUTOSIZE);
    cvMoveWindow("Cipher Image", 800, 600);

   // show the image
   cvShowImage("Cipher Image", CipherImage );
   cvSaveImage("CipherImage.jpg",CipherImage,0);

   cvWaitKey(0);

 }

  int main()
 {
                    //i j and k used as counters
                    int i,j,step,dep,k,ch,L,C,P,sum=0;
                    uchar *data_byte;
                    //Define CPU time parameters for each Layer
                    PlainImage=cvLoadImage("PlainImage.jpg",3);
                    CipherImage=cvLoadImage("PlainImage.jpg",3);
                    L    = PlainImage->height;
                    C     = PlainImage->width;
                    P  = PlainImage->nChannels;
                    step      = PlainImage->widthStep;
                    data_byte=CipherImage->imageData;
                    printf("Image Information are:\nL=%d\n",L);
                    printf("C=%d\n",C);
                    printf("P=%d\n",P);
                    system("pause");

                    FILE *f1;
                               f1 = fopen ("cipher1.txt", "wt");
                               fprintf(f1,"%d\t%d\t%d\t%d\t",L,C,P,CipherImage->depth);
                                    for(k=0;k<L*C*P;k++)
                                    {

                                    fprintf(f1,"%d\t",data_byte[k]);

                                    }
                                    fclose (f1);
                                    func_printimage();
                                    for(k=0;k<L*C*P;k++)
                                    {
                                    data_byte[k]=0;

                                    }

                            f1 = fopen ("cipher1.txt", "rt");

                            fscanf (f1,"%d", &L);
                            fscanf (f1,"%d", &C);
                            fscanf (f1,"%d", &P);
                            fscanf (f1,"%d", &dep);

                    CipherImage=cvLoadImage("CipherImage.jpg",3);
                    data_byte=CipherImage->imageData;
                    printf("Image Information are:\nL=%d\n",L);
                    printf("C=%d\n",C);
                    printf("P=%d\n",P);
                    system("pause");
                            for(k=0;k<L*C*P;k++)
                            {
                                fscanf (f1,"%d", &i);
                                sum+=abs(i-data_byte[k]);
                                printf("i=%d  data=%d\n",i,data_byte[k]);
                            }
                            printf("difference=%d\n",sum);
                            fclose (f1);

                            system("pause");
                     return 0;
} 
```

//主程序结束

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T22:24:42.373

在这篇文章中，我将向您展示如何从您选择的目录加载图像，然后将其转换为灰色，然后将新的（修改后的）图像存储在目录 C:\Images 中。

代码如下：

```
#include <cv.h>
#include <highgui.h>,
using namespace cv;
int main( )
 {

  Mat img;
  img = imread(“C:\\prado.jpg”, 1 );

 if( !img.data )
   {
     printf( ” No image data \n ” );
      return -1;
    }
   else
       prinf(“Your program is working well”);
 Mat gray_image;
 cvtColor( img, gray_image, CV_RGB2GRAY );
 imwrite( “C://images/Gray_Image.jpg”, gray_image);
 imshow( “real image”, img);
 imshow( “Gray image”, gray_image);
 waitKey(0); 
 return 0;
  } 
```

**解释：**

```
 Mat img = imread(“C:\\prado.jpg”, 1 ); 
```

这意味着从我的目录中获取图像并将其存储在此处为“img”的 Mat 对象中，实际上 Mat 对象存储任何图像的数据。

```
 cvtColor( img, gray_image, CV_RGB2GRAY ); 
```

此行将原始（RGB）转换为其他颜色图像（GRAY）

```
 imwrite( “C://images/Gray_Image.jpg”, gray_image); 
```

这个存储新修改的图像，这些图像已经存储在目录 C://images/ 中的 Mat 对象“gray_image”中，您可以选择自己的目录

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:23:32.860

jpg 图像使用[有损压缩](http://en.wikipedia.org/wiki/Lossy_compression)。您应该使用 png 图像。

# ruby-on-rails - RSpec和Capybara：如何确定选择控件是否选择了特定选项？

> ID：13595428
> 
> 赞同：3
> 
> 时间：2012-11-27T23:58:11.013
> 
> 标签：ruby-on-rails, rspec, capybara

给定一个选择控件，您希望在表单加载时选择适用的选项（显然通过在控制器中水合您的模型），您如何在 RSpec/Capybara 集成测试中确定是否实际选择了正确的选项？

例如，给定以下选择控件...

```
<select class="select optional" id="receiving_tally_po_id" name="receiving_tally[po_id]">        
    <option value="10020">PO-10020 - Schoen Inc</option>
    <option value="10018" selected="selected">PO-10018 - Senger, Eichmann and Murphy</option>
</select> 
```

...您将如何在值 10018 上测试 selected="selected" ？

```
describe "auto-populate with PO information" do
  let!(:po) { FactoryGirl.create(:po) }

  before { visit new_receiving_tally_path(:po => po) }
  # The following checks to see if the option is actually there, but not if it's selected.
  it { should have_xpath "//select[@id = '#receiving_tally_po_id']/option[@value = '#" + po.id.to_s + "' ]" }
end 
```

更新......另一个刺，但它似乎忽略了块项目（它说即使有错误的信息也很好 - 原因可能很明显）：

```
 it "should have the proper PO selected" do
    should have_selector("select#receiving_tally_po_id") do |content|
      content.should_not have_selector(:option, :value => po.id.to_s, :selected => 'selected')
    end
  end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-28T01:25:45.957

尝试如下

```
it " should have your_value when page loaded" do 
  find_field(field).value.should eq "your_value"
end 
```

希望它会有所帮助

为了适应上面的例子：

```
subject { page }
... 
    describe "auto-populate with PO information" do
      let!(:po) { FactoryGirl.create(:po) }
      before { visit new_receiving_tally_path(:po => po) }
      it { find_field('receiving_tally_po_id').value.should eq po.id.to_s }
    end 
```

# jpa - Eclipselink JPA 在使用生成的主键插入 Derby 表时出错

> ID：13595432
> 
> 赞同：3
> 
> 时间：2012-11-27T23:59:30.157
> 
> 标签：jpa, eclipselink, java-ee-6, netbeans-7, derby

EclipseLink 在使用生成的主键持久保存到表中时，似乎错误地将空主键值传递给 Derby。在这种情况下，Derby 返回**尝试修改标识列的错误。**Derby 需要一个排除 id 值的 SQL 语句。我的问题是如何强制 EclipseLink 发送正确的 SQL？详情如下...

我正在使用 Eclipselink 映射到最新的 Netbeans 7.3beta2 下的 Derby 数据库 (v10.8.1.2)。

数据库表主键是自动生成的：

```
CREATE TABLE STUDENT_BATCH ( 
    ID bigint PRIMARY KEY
        GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
    FILENAME varchar(200) NOT NULL,
    SCHOOLBOARD varchar(100) NOT NULL,
    CREATE_TS timestamp NOT NULL,
    CONTACT_INFO varchar(200),
    NOTES varchar(2000),
    BOARD_NAME varchar(100)
)
; 
```

对应的jpa类指定id是使用identity的策略生成的：

```
@Entity
@Table(name = "STUDENT_BATCH")
@XmlRootElement
@NamedQueries({
@NamedQuery(name = "StudentBatch.findAll", query = "SELECT s FROM StudentBatch s")})
public class StudentBatch implements Serializable {
    private static final long serialVersionUID = 1L;
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "ID")
    private Long id;
    @Basic(optional = false)
    @Column(name = "FILENAME")
    private String filename;
    @Basic(optional = false)
    @Column(name = "SCHOOLBOARD")
    private String schoolboard;
    @Basic(optional = false)
    @Column(name = "CREATE_TS")
    @Temporal(TemporalType.TIMESTAMP)
    private Date createTs;
    @Column(name = "CONTACT_INFO")
    private String contactInfo;
    @Column(name = "NOTES")
    private String notes;
    @Column(name = "BOARD_NAME")
    private String boardName;
    @OneToMany(cascade = CascadeType.ALL, mappedBy = "studentBatchId")
    private Collection<StudentRecord> studentRecordCollection;

    methods etc follow... 
```

当我去持久化课程时，我没有指定 id，以便 Derby 将提供 id。

```
 StudentBatch sb = new StudentBatch();
                sb.setBoardName(meta.get("BOARD NAME"));
                sb.setContactInfo(meta.get("CONTACT INFO"));
                sb.setCreateTs(new Date());
                sb.setFilename(event.getFile().getFileName());
                sb.setNotes(meta.get("NOTES"));
                sb.setSchoolboard(meta.get("SCHOOL BOARD"));
                _logger.debug("persisting batch");
                em.persist(sb);
                _logger.debug("flushing");
                em.flush();
                _logger.debug("flushed"); 
```

然而，Eclipselink 将 id 作为 null 传递给 derby，并且 Derby 给出错误*Attempt to modify an identity column*：

```
INFO: DEBUG  11710 27 Nov 2012 18:17:10,558 [http-thread-pool-8080(4)] (FileUploadController.java:75) - persisting batch
INFO: DEBUG  11713 27 Nov 2012 18:17:10,561 [http-thread-pool-8080(4)] (FileUploadController.java:77) - flushing
WARNING: Local Exception Stack: 
Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.DatabaseException
Internal Exception: java.sql.SQLSyntaxErrorException: Attempt to modify an identity column 'ID'. 
Error Code: -1
Call: INSERT INTO STUDENT_BATCH (ID, BOARD_NAME, CONTACT_INFO, CREATE_TS, FILENAME, NOTES, SCHOOLBOARD) VALUES (?, ?, ?, ?, ?, ?, ?)
bind => [7 parameters bound]
Query: InsertObjectQuery(ca.ontario.mhltc.studentupload.model.StudentBatch[ id=null ])
at org.eclipse.persistence.exceptions.DatabaseException.sqlException(DatabaseException.java:333) 
```

这对我来说很有意义，因为如果我尝试在指定 id 字段的 sql 命令行上执行插入，我也会收到错误消息。

```
INSERT INTO STUDENT_BATCH (id, BOARD_NAME, CONTACT_INFO, CREATE_TS, FILENAME, NOTES, SCHOOLBOARD)
VALUES (null, 'abc', 'def', current_timestamp, 'aaa', 'aabb', '1234'); 
```

给了我这个：

```
Error code -1, SQL state 42Z23: Attempt to modify an identity column 'ID'. 
Line 1, column 1

Execution finished after 0 s, 1 error(s) occurred. 
```

但是，此插入语句是成功的：

```
INSERT INTO STUDENT_BATCH (BOARD_NAME, CONTACT_INFO, CREATE_TS, FILENAME, NOTES, SCHOOLBOARD)
VALUES ('abc', 'def', current_timestamp, 'aaa', 'aabb', '1234'); 
```

返回

```
Executed successfully in 0.002 s, 1 rows affected.
Line 1, column 1

Execution finished after 0.002 s, 0 error(s) occurred. 
```

在我看来，Eclipselink 应该知道 Derby 如何处理标识列，并且根本不应该在插入语句中传递 id 列。是否有解决方法，或者我应该转储 Derby 并使用其他数据库？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T14:47:14.657

EclipseLink 没有在 Derby IDENTITY 的 INSERT 中包含 Id，因此您会遇到一些奇怪的事情。

您之前是否使用过另一种生成器策略并且没有正确重新编译/部署您的代码？

还可以尝试使用 persistence.xml 中的“eclipselink.target-database”="Derby" 设置您的平台。

# html-email - HTML 小填充问题我不太明白

> ID：13595433
> 
> 赞同：0
> 
> 时间：2012-11-27T23:59:31.183
> 
> 标签：html-email

我创建了一个电子邮件通讯。

它**完美地**显示在所有电子邮件客户端，包括 Outlook 2000 和 Outlook 2003。

Outlook 2007、2010 和 2013 是唯一有问题的版本。这就是问题所在。我能做些什么来修复它？:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:12:06.143

通过切掉一些底部的红色区域来缩短左列。

# javascript - 看似相等的字符串的奇怪问题

> ID：13595436
> 
> 赞同：1
> 
> 时间：2012-11-27T23:59:47.920
> 
> 标签：javascript

我知道这可能看起来很傻，但我仍然不知道为什么会发生这种情况（已经好几次了。）

```
alert(
"WWVhaCA6RCwgYSBsb3Qgb2YgcGVvcGxlIGRvbid0IGtub3cgdGhhdCB0aGlzIGlzIGVuY29kZWQgOkQ=" == 
"WWVhaCA6RCwgYSBsb3Qgb2YgcGVvcGxlIGRvbid0IGtub3cgdGhhdCB0aGlzIGlzIGVuY29kZWQgOkQ=")​ 
```

演示：http: [//jsfiddle.net/DerekL/b38Cn/](http://jsfiddle.net/DerekL/b38Cn/)

它应该返回`true`，但它返回`false`. 我查看了每个字符（在记事本中，因为它使用等宽字体），它们完全相同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T00:08:22.913

正如@ElliotBonneville 所说，文本中有一个隐藏的 unicode 字符。通过将字符串粘贴到命令提示符中可以看到：

![截屏](../Images/93cba7432bac6a2dbd4acef80da3dfbd.png)

注意`?`第一个字符串末尾的 。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-28T00:11:01.637

奇怪的是，当我将您的代码复制并粘贴到我的编辑器时，我得到了这样的结果：

> “WWVhaCA6RCwgYSBsb3Qgb2YgcGVvcGxlIGRvbid0IGtub3cgdGhhdCB0aGlzIGlzIGVuY29kZWQgOkQ= **？** ”

第二部分：

> "WWVhaCA6RCwgYSBsb3Qgb2YgcGVvcGxlIGRvbid0IGtub3cgdGhhdCB0aGlzIGlzIGVuY29kZWQgOkQ="

注意第一个字符串中多余的“ **？ ”？**在 jsFiddle 上视觉上它没有出现。我复制了你的字符串并删除了额外的**？**并在 jsFiddle 上运行它。它工作得很好。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-28T00:03:52.817

你是从 jsFiddle 复制这个字符串还是什么？有一个 Unicode 字符没有出现在记事本或我的浏览器（Chrome，如果您想知道的话）中并导致了问题。复制第一个字符串并将其粘贴到第二个字符串中（在确认两者*看起来*相同之后）导致问题消失。

我会粘贴一个指向更新的 jsFiddle 的链接，但我不允许这样做。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-28T00:13:20.467

[向零宽度非破坏空间](http://www.fileformat.info/info/unicode/char/feff/index.htm)问好！

您的第一个字符串末尾包含一个`0xfeff`字符。这不会出现在大多数现代编辑器中，这可能就是您甚至没有注意到它的原因。

> 零宽度不间断空格 (ZWNBSP) 不推荐使用代码点 U+FEFF 处的 Unicode 字符。字符 U+FEFF 旨在用作文件开头的字节顺序标记。但是，如果在其他地方遇到它，根据 Unicode，它应该被视为“零宽度不间断空间”。出于此目的故意使用 U+FEFF 现在已弃用，强烈推荐使用 U+2060 单词连接器（HTML：⁠）。

来源：[维基百科](http://en.wikipedia.org/wiki/Zero-width_non-breaking_space)

`.charCodeAt()`当您遇到看似相同的字符串时，您应该在循环内使用分解它们以查找任何“流氓”字符。

# java - 使用java将图像作为blob上传到sql数据库

> ID：13595437
> 
> 赞同：0
> 
> 时间：2012-11-27T23:59:50.017
> 
> 标签：java, html, sql

我有一个这样设置的数据库

```
 CREATE TABLE item (             
              ItemID int(11) NOT NULL auto_increment,  
              ItemName char(25),      
              YearManufactured int(11),   
              CopiesSold int(11),
              AmountInStock int(11),
              image blob,                         
              Description char(30),     
              PRIMARY KEY  (`ItemID`)                   
     ); 
```

该表工作正常，我已经能够很好地插入和删除它。我想组织我的代码有点不同，并使用 Java 而不是编写脚本来更新表。我想切换到这样做的最初原因是因为我希望能够更轻松地上传图像。这是我的代码：

这是最初打开的脚本。URL、UserID 和 Password 绝对正确。

```
<%  
    // Instantiating the connection to the database
    String mysJDBCDriver = "com.mysql.jdbc.Driver"; 
    String mysURL = "MY_ADDRESS"; 
    String mysUserID = "USERNAME"; 
    String mysPassword = "PASSWORD";

    java.sql.Connection conn=null; // a new connection
    try 
    {
        DB db = new DB();
        conn=db.dbConnect(mysJDBCDriver, mysURL,mysUserID,mysPassword);
        db.insertImage(conn,"c:/Users/DPiganell/image_launch_a5.jpg");
        db.getImageData(conn);
        System.out.println("Connected successfully to database using JConnect");
        session.setAttribute("connection", conn);

     }
    catch(Exception e)
    {
        e.printStackTrace();
        out.print(e.toString());
    }

%> 
```

这是我的数据库对象

```
package DBPackage;

import java.io.*;
import java.sql.*;

public class DB
{
        public DB() {}

        public Connection dbConnect(String db_driver, String db_connect_string,
           String db_userid, String db_password)
        {
                try
                {
                        Class.forName(db_driver);
                        Connection conn = DriverManager.getConnection(
                          db_connect_string, db_userid, db_password);

                        System.out.println("connected");
                        return conn;

                }
                catch (Exception e)
                {
                        e.printStackTrace();
                        return null;
                }
        }

        public void insertImage(Connection conn,String img)
        {
                int len;
                String query;
                PreparedStatement pstmt;

                try
                {
                        File file = new File(img);
                        FileInputStream fis = new FileInputStream(file);
                        len = (int)file.length();

//                        query = ("UPDATE item SET image = ? WHERE ItemID = ?");
                        query = ("INSERT INTO ITEM (ItemType, ItemName, YearManufactured, CopiesSold, AmountInStock, image, description) "
                    + "VALUES(?,?,?,?,?,?,?");
                        pstmt = conn.prepareStatement(query);
                        pstmt.setString(1, "DVD");
                        pstmt.setString(2, "fsd");
                        pstmt.setInt(3, 1991);
                        pstmt.setInt(4, 6);
                        pstmt.setInt(5, 7);
                        pstmt.setString(7, "works");

                        // Method used to insert a stream of bytes
                        pstmt.setBinaryStream(6, (InputStream)fis, len);
                        pstmt.executeUpdate();

                }
                catch (SQLException e)
                {
                        e.printStackTrace();
                }
                catch (Exception e)
                {
                        e.printStackTrace();
                }
        }

        public void getImageData(Connection conn)
        {

                 byte[] fileBytes;
                 String query;
                 try
                 {
                         query = "select image from item where ItemID=3";
                         Statement state = conn.createStatement();
                         ResultSet rs = state.executeQuery(query);
                         if (rs.next())
                        {
                                  fileBytes = rs.getBytes(1);
                                  OutputStream targetFile=  
                                  new FileOutputStream(
                                       "C:/Users/DPiganell/newImage.jpg");

                                  targetFile.write(fileBytes);
                                  targetFile.close();
                        }        

                 }
                 catch (Exception e)
                 {
                         e.printStackTrace();
                 }
        }
}; 
```

一旦程序到达executeUpdate，就会抛出异常。任何帮助表示赞赏。如果它更容易，我愿意采取不同的方法。

SQLException 堆栈跟踪：

```
SEVERE: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 1
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
    at com.mysql.jdbc.Util.getInstance(Util.java:386)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1053)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:4096)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:4028)
    at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2490)
    at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2651)
    at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2734)
    at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2155)
    at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2458)
    at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2375)
    at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2359)
    at DBPackage.DB.insertImage(DB.java:55)
    at org.apache.jsp.header_jsp._jspService(header_jsp.java:61)
    at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:111)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:847)
    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:403)
    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:492)
    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:378)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:847)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1539)
    at org.apache.catalina.core.ApplicationDispatcher.doInvoke(ApplicationDispatcher.java:787)
    at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:649)
    at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:604)
    at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:534)
    at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:1015)
    at org.apache.jsp.index_jsp._jspService(index_jsp.java:60)
    at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:111)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:847)
    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:403)
    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:492)
    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:378)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:847)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1539)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
    at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:98)
    at com.sun.enterprise.web.PESessionLockingStandardPipeline.invoke(PESessionLockingStandardPipeline.java:91)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:162)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:330)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:174)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:828)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:725)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1019)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:225)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722)

SEVERE:     at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
SEVERE:     at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
SEVERE:     at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
SEVERE:     at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
SEVERE:     at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
SEVERE:     at com.mysql.jdbc.Util.getInstance(Util.java:386)
SEVERE:     at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1053)
SEVERE:     at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:4096)
SEVERE:     at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:4028)
SEVERE:     at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2490)
SEVERE:     at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2651)
SEVERE:     at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2734)
SEVERE:     at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2155)
SEVERE:     at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2458)
SEVERE:     at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2375)
SEVERE:     at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2359)
SEVERE:     at DBPackage.DB.insertImage(DB.java:55)
SEVERE:     at org.apache.jsp.header_jsp._jspService(header_jsp.java:61)
SEVERE:     at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:111)
SEVERE:     at javax.servlet.http.HttpServlet.service(HttpServlet.java:847)
SEVERE:     at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:403)
SEVERE:     at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:492)
SEVERE:     at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:378)
SEVERE:     at javax.servlet.http.HttpServlet.service(HttpServlet.java:847)
SEVERE:     at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1539)
SEVERE:     at org.apache.catalina.core.ApplicationDispatcher.doInvoke(ApplicationDispatcher.java:787)
SEVERE:     at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:649)
SEVERE:     at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:604)
SEVERE:     at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:534)
SEVERE:     at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:1015)
SEVERE:     at org.apache.jsp.index_jsp._jspService(index_jsp.java:60)
SEVERE:     at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:111)
SEVERE:     at javax.servlet.http.HttpServlet.service(HttpServlet.java:847)
SEVERE:     at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:403)
SEVERE:     at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:492)
SEVERE:     at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:378)
SEVERE:     at javax.servlet.http.HttpServlet.service(HttpServlet.java:847)
SEVERE:     at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1539)
SEVERE:     at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
SEVERE:     at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
SEVERE:     at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
SEVERE:     at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
SEVERE:     at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:98)
SEVERE:     at com.sun.enterprise.web.PESessionLockingStandardPipeline.invoke(PESessionLockingStandardPipeline.java:91)
SEVERE:     at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:162)
SEVERE:     at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:330)
SEVERE:     at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
SEVERE:     at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:174)
SEVERE:     at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:828)
SEVERE:     at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:725)
SEVERE:     at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1019)
SEVERE:     at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:225)
SEVERE:     at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
SEVERE:     at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
SEVERE:     at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
SEVERE:     at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
SEVERE:     at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
SEVERE:     at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
SEVERE:     at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
SEVERE:     at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
SEVERE:     at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
SEVERE:     at java.lang.Thread.run(Thread.java:722) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T02:15:49.707

您的查询语法看起来错误，请检查左括号和右括号。

# c++ - [Editor(typeof(FolderNameEditor), typeof(UITypeEditor))] 的 C++/CLI 版本是什么？

> ID：13595441
> 
> 赞同：0
> 
> 时间：2012-11-28T00:00:03.397
> 
> 标签：c++, c++-cli, propertygrid

这是一个令人尴尬的问题，但我觉得我在过去的几个小时里尝试了一切。

我只想将以下属性添加到我的属性中

```
 #using <System.Drawing.dll>
 #using <System.Design.dll>
 ...
 using namespace System::Drawing::Design;
 using namespace System::Configuration;
 using namespace System::ComponentModel;
 using namespace System::Windows::Forms::Design;
 ...

[Editor(typeof(FolderNameEditor), typeof(UITypeEditor))]
 property System::String^           DefaultWorkingDirectory; 
```

首先，我按原样尝试，编译器说“非法使用类型（FolderNameEditor）。

现在我尝试了这个

```
 [Editor(Type::GetType("System.Windows.Form.Design.FolderNameEditor, System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"), 
        Type::GetType("System.Drawing.Design.UITypeEditor, System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"))] 
```

但它说非法属性参数。

如果我执行以下操作，C++/CLI 项目将编译

```
 [Editor("System.Windows.Form.Design.FolderNameEditor", "System.Drawing.Design.UITypeEditor")] 
```

但是，每当我尝试从 C# 项目中获取项目的引用时，都会收到一条错误消息，指出缺少命名空间。如果我注释掉上面的编辑器属性和#using 和 using 命名空间，一切都很好。

由于某种原因，我在 MSDN 中找不到相关资料，如果您能指出正确的文档，将不胜感激。

**更新：** C# 项目是 .NET 4 客户端配置文件，这就是为什么我收到错误指示缺少命名空间的原因，这是误导性的。将目标框架更改为 .NET 4 解决了这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T00:02:55.703

C++/CLI 等价于`typeof()`. `::typeid`试试这个：

```
[Editor(FolderNameEditor::typeid, UITypeEditor::typeid)] 
```

# html - Facebook Debugger 抱怨 Title 属性

> ID：13595443
> 
> 赞同：0
> 
> 时间：2012-11-28T00:00:23.107
> 
> 标签：html, facebook

我正在一个网站上工作，并试图纠正我从 Facebook 调试器看到的所有问题。它抱怨应该修复以下警告：

> 这种类型的对象不允许名为“http://purl.org/dc/terms/title”的属性。
> 
> 解析器不匹配元数据：此元数据的解析器结果与输入元数据不匹配。这可能是由于数据以一种意外的方式排序、为一个属性提供了多个值而只期望一个值、或者给定属性的属性值不匹配造成的。以下是解析结果中未显示的输入属性：'http://purl.org/dc/terms/title'

我不明白我做错了什么。这是我的临时开发站点的站点：http: [//drupal.inadaydevelopment.com/blog/blog.cfm/aid/631/Waikiki-goes-off-with-Town-and-Country-](http://drupal.inadaydevelopment.com/blog/blog.cfm/aid/631/Waikiki-goes-off-with-Town-and-Country-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-31T22:57:07.153

如果禁用模块 RDF，此错误将得到解决

# android - 用 Canvas 上的图形数字替换数字数字

> ID：13595444
> 
> 赞同：1
> 
> 时间：2012-11-28T00:00:29.163
> 
> 标签：android, graphics, android-canvas

我一直在开发一款小游戏以进一步学习 Android，我有一个关于用图形数字替换数字数字的问题。我厌倦了使用 Canvas.drawText ......

如果数字打印在png图像上，如何创建一个函数来了解在哪个帧之后写入？

好的，假设我的分数是 1240，我希望能够用 Canvas 上的图形数字替换这些数字。

我希望我把我的问题说清楚了，干杯！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T16:54:13.453

这不是很难，只需将一些drawables放在正确的位置即可。但是如果你想做一个健壮的小部件，你需要更多的考虑和计算。

```
public class MTextView extends View {
    public MTextView(Context context) {
        this(context, null);
    }

    public MTextView(Context context, AttributeSet attrs) {
        super(context, attrs);
        initDrawables();
    }

    private Drawable[] mDigitDrawables = new Drawable[10];
    private String mText = "123";

    private void initDrawables() {
        Resources res = getResources();
        mDigitDrawables[0] = res.getDrawable(R.drawable.digit_0);
        mDigitDrawables[1] = res.getDrawable(R.drawable.digit_1);
        mDigitDrawables[2] = res.getDrawable(R.drawable.digit_2);
        mDigitDrawables[3] = res.getDrawable(R.drawable.digit_3);
        mDigitDrawables[4] = res.getDrawable(R.drawable.digit_4);
        mDigitDrawables[5] = res.getDrawable(R.drawable.digit_5);
        mDigitDrawables[6] = res.getDrawable(R.drawable.digit_6);
        mDigitDrawables[7] = res.getDrawable(R.drawable.digit_7);
        mDigitDrawables[8] = res.getDrawable(R.drawable.digit_8);
        mDigitDrawables[9] = res.getDrawable(R.drawable.digit_9);

        for (int i = 0; i < 10; i++) {
            boundToLeftTop(mDigitDrawables[i]);
        }
    }

    private void boundToLeftTop(Drawable d) {
        d.setBounds(0, 0, d.getIntrinsicWidth(), d.getIntrinsicHeight());
    }

    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
        int dw = mDigitDrawables[0].getIntrinsicWidth();
        int dh = mDigitDrawables[0].getIntrinsicHeight();
        int width = dw * mText.length() + getPaddingLeft()
                + getPaddingRight();
        int height = dh + getPaddingTop() + getPaddingBottom();
        setMeasuredDimension(resolveSize(width, widthMeasureSpec),
                resolveSize(height, heightMeasureSpec));
    }

    @Override
    protected void onDraw(Canvas canvas) {
        canvas.save();
        canvas.translate(getPaddingLeft(), getPaddingTop());
        for (int i = 0; i < mText.length(); i++) {
            int number = Integer.valueOf(mText.charAt(i) - '0');
            Drawable d = mDigitDrawables[number];
            d.draw(canvas);
            canvas.translate(d.getBounds().width(), 0);
        }
        canvas.restore();
    }
} 
```

# ios - UIButton 隐藏属性的奇怪行为 - iOS

> ID：13595446
> 
> 赞同：-1
> 
> 时间：2012-11-28T00:00:42.437
> 
> 标签：ios, uibutton

如果我的数组不是 nil 使用以下代码，我想隐藏一个按钮，但是由于某种原因它不起作用。我在我的代码中看不到任何错误..请帮助我..谢谢..

```
- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section
{
    NSString *title = nil;

     HowtoUseButton = [[[CustomButton alloc] init] autorelease];

    [HowtoUseButton addTarget:self action:@selector(openLink) forControlEvents:UIControlEventTouchDown];

    HowtoUseButton.frame = CGRectMake(80.0, 140.0, 160.0, 70.0);

    [self.view addSubview:HowtoUseButton];

    if (document.count > 0){

        HowtoUseButton.hidden = YES;  // not working
        title = Title_Doc;

    }
    else if (self.documentURLs.count == 0){

        title = Title_No_Doc;
        HowtoUseButton.hidden = NO;

    }

    return title;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:23:08.480

由于您在 中使用它`titleForHeaderInSection`，它可能被多次调用。如果是这样的话，也许只有一些按钮是隐藏的。

尝试改变：

```
HowtoUseButton = [[[CustomButton alloc] init] autorelease];
[HowtoUseButton addTarget:self action:@selector(openLink) forControlEvents:UIControlEventTouchDown];
HowtoUseButton.frame = CGRectMake(80.0, 140.0, 160.0, 70.0);
[self.view addSubview:HowtoUseButton]; 
```

至：

```
if (!HowtoUseButton) {
    HowtoUseButton = [[[CustomButton alloc] init] autorelease];
    [HowtoUseButton addTarget:self action:@selector(openLink) forControlEvents:UIControlEventTouchDown];
    HowtoUseButton.frame = CGRectMake(80.0, 140.0, 160.0, 70.0);
    [self.view addSubview:HowtoUseButton];
} 
```

而且，正如其他已经回答的人所说，这本来就不应该在这里。在界面生成器中创建按钮，或者`viewDidLoad`一次创建按钮，只需在需要更改的地方设置隐藏属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:22:03.967

您需要从`titleForHeader`方法中删除按钮创建部分，将此代码保留在`viewDidLoad`您的类的方法中，

```
- (void)viewDidLoad {
   [super viewDidLoad];
   HowtoUseButton = [[[CustomButton alloc] init] autorelease];
   [HowtoUseButton addTarget:self action:@selector(openLink) forControlEvents:UIControlEventTouchDown];
   HowtoUseButton.frame = CGRectMake(80.0, 140.0, 160.0, 70.0);
   [self.view addSubview:HowtoUseButton]; 
```

由于您是在`titleForHeader`方法中创建它，因此它会被多次创建，一旦创建新的引用，您将失去对旧引用的引用。`titleForHeader`每当您滚动表格视图时，都会调用该方法。相反，您可以在您的`viewDidLoad`方法中创建一次并使用它。

如果您尝试将此按钮添加到表格视图标题，请`viewForHeaderInSection`按照其他答案中的说明使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T00:09:56.533

`hidden`为什么不直接将其从视图中移除，而不是使用该属性？

```
[HowtoUseButton removeFromSuperview]; 
```

顺便说一句，我会注意到您在这里所做的事情有些奇怪。如果您想在表格视图部分标题中添加一个按钮，最好的方法可能是实现：

```
- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section 
```

...在您的表视图委托中。这样，您可以完全自定义表头视图。

# email - 使用 cakephp 电子邮件组件循环发送邮件，将内容附加到下一个邮件内容

> ID：13595449
> 
> 赞同：1
> 
> 时间：2012-11-28T00:01:11.037
> 
> 标签：email, components, cakephp-1.3

CAKEPHP 控制器代码：

```
for($i=0;$i<2;$i++) {   
   $to = 'pretesting@gmail.com';

   $subject = 'Cloud Network Invitation';

   $template = "email/join";

   $activation_code = md5(uniqid($to, true));

   $this->Email->reset();

   $this->Email->delivery = 'debug';

   $this->Email->to = $to;

   $this->Email->from = 'pretesting2@gmail.com';

   $this->Email->subject = $subject;

   $this->Email->template = $template;

   $this->set(compact('activation_code','to'));     

   $this->Email->send();

} 
```

这是我第一次在我的“pretesting2@gmail.com”收件箱中收到这个

> 嗨，pretesting2@gmail.com

第二次，我在“pretesting2@gmail.com”收件箱中收到了这个

```
Hi, pretesting2@gmail.com
Hi, pretesting2@gmail.com 
```

不明白，为什么第一封邮件内容附加到第二封邮件内容..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T13:48:13.407

您需要在循环中使用 $this->Email->reset() 。你可以在这里阅读更多，[http://book.cakephp.org/1.3/en/The-Manual/Core-Components/Email.html](http://book.cakephp.org/1.3/en/The-Manual/Core-Components/Email.html)

如果您仍然遇到问题，请尝试使用 $this->Email->delivery = 'debug' 进行调试；

# scala - 为 CoffeeScript 声明不同的编译路径

> ID：13595453
> 
> 赞同：2
> 
> 时间：2012-11-28T00:01:18.030
> 
> 标签：scala, coffeescript, sbt, scalatra

我有一个使用[https://github.com/softprops/coffeescripted-sbt](https://github.com/softprops/coffeescripted-sbt)将 CoffeeScript 编译到默认位置的 Scalatra 应用程序`target/scala-2.9.1/resource_managed/main/js`。我想将生成的 javascripts 放在一个公开可用的地方，在一个名为 的文件夹中`src/main/webapp/coffee`，但给出的示例默认为 `/target/...'

```
resourceManaged in (Compile, CoffeeKeys.coffee)) <<= (crossTarget in Compile)(_ / "your_preference" / "js") 
```

我的 build.sbt：

```
seq(coffeeSettings: _*)

// doesn't work
//(resourceManaged in (Compile, CoffeeKeys.coffee)) <<= ("src" / "main" / "webapp" / "coffee") 
```

`build.sbt`如果是，我将如何引用我希望编译资产正确进入内部的路径`src/main/webapp/coffeee`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T07:26:51.530

添加到您的 build.sbt：

```
//compiles your CoffeeScript files to resource_managed/main/webapp/js/
(resourceManaged in (Compile, CoffeeKeys.coffee)) <<= (resourceManaged in Compile)(_ / "webapp" / "js")

//makes ALL files in resource_managed/main/webapp as static file available
com.github.siasia.PluginKeys.webappResources in Compile <+= (resourceManaged in Compile)(_ / "webapp" ) 
```

src/main/coffee/example.coffee 将在`http://localhost:8080/js/example.js`

# visual-studio-2010 - 模拟器不会在 Visual Studio 2010 中显示

> ID：13595455
> 
> 赞同：2
> 
> 时间：2012-11-28T00:01:26.247
> 
> 标签：visual-studio-2010, windows-phone-7.1, windows-phone-7-emulator

我已经遇到这个问题一周了，并在互联网上尝试了很多解决方法，但没有结果。

这是我的情况：我正在尝试在 Windows 8 x64 主机上安装 Windows Phone SDK 7.1。我遵循的步骤是：

1.  为 Marketplace 客户端安装的 Windows 游戏
2.  安装 Visual Studio 2010 并将其更新到 Visual Studio 2010 SP1
3.  已安装 Windows Phone SDK 7.1
4.  将 SDK 更新为 Windows Phone SDK 7.1.1
5.  我尝试使用以管理员身份运行打开

上面列出的步骤均未返回错误。但我似乎根本无法运行模拟器。模拟器列表在 Visual Studio 2010 中没有显示任何内容，当我尝试将模拟器作为独立应用程序运行时，模拟器根本不会运行。

有人遇到同样的问题或有解决方法吗？

提前致谢。

PS：在谷歌搜索并重新安装了 SDK 和 Visual Studio 至少 3 次后，我得到了上述步骤。如果这是问题所在（例如：安装后清理失败），请告知我如何进行。

更新：我尝试使用 Visual Studio 2012 安装 Windows Phone SDK 8.0，但模拟器仍未在设备列表中列出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-21T20:29:08.960

我在使用 Visual Studio 2012 for Windows Phone 时遇到了同样的问题。[解决方案](https://stackoverflow.com/a/18183280/311207)是删除位于以下位置的 Visual Studio 11.0 用户数据目录：

```
C:\Users\[user]\AppData\Local\Microsoft\Phone Tools\CoreCon\11.0 
```

之后，所有虚拟机都已正确重新创建。

* * *

*对于它的价值，我在 Mac 上的 Parallels 下的 Windows 8 上遇到了这个问题。当我让主机进入睡眠状态（没有关闭任何东西）时，我的 Visual Studio / Hyper-V 环境可能已经损坏。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T07:23:23.963

我仍然不知道导致此错误的原因是什么，但我确实为可能遇到相同问题的其他人提供了快速修复。

我的解决方法是使用新的 Windows 配置文件。（无需重新安装应用程序）只需创建一个新的 Windows 配置文件并使用该配置文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T06:36:28.840

为什么你使用 Visual Studio 2010 时 Visual Studio 2011 已经存在于 Windows Phone 8 sdk 中，包括所有 Windows Phone 7 功能。可能是某些 windows phone 7 sdk 的模拟器在 win 8 机器上不受支持。尝试重新安装 sdk ，它将解决问题。

# javascript - Javascript表单验证提交错误

> ID：13595460
> 
> 赞同：2
> 
> 时间：2012-11-28T00:01:38.630
> 
> 标签：javascript, forms, validation

从我在网上看到的所有内容来看，以下代码似乎应该执行以下操作（这是我的期望）：

*   如果电子邮件（“帮助”）与正则表达式不匹配，则显示警报消息并返回 false
*   如果密码（“pass”）为空，则显示警报消息并返回 false
*   如果两个条件都通过验证，则提交表单

Javascript如下：

```
function validate() {
var email = document.getElementById('aid').value;
var pass = document.getElementById('apw').value;        
var emailPattern = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;  
if (!emailPattern.test(email)) {
    alert("Not a valid email address");
    return false;
}
if (pass == null || pass == "") {
    alert("Password is blank");
    return false;   
}
return true;
} 
```

标签的开头如下：

```
<form action="choose.php" onsubmit="validate();" method="post"> 
```

我遇到的问题是，当单击提交按钮时，会弹出警报消息，但随后在浏览器中加载了 choose.php。如果触发了错误条件，我希望脚本保留在页面上，直到两个条件都通过。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T00:03:49.777

您需要将 onSubmit 更改为`onSubmit="return validate();"`. 这样，当它返回 false 时，表单不会被提交。现在它只是调用 validate() 函数并继续提交表单

# c++ - 此代码段如何验证整数输入？

> ID：13595461
> 
> 赞同：0
> 
> 时间：2012-11-28T00:01:50.207
> 
> 标签：c++, validation

我得到了循环，以及输入 int 类型的初始提示，但是......使用 !(cin >> [variable]) 检查的 while 循环是什么？我在 cplusplus.com 上查看了 cin 以获得解释，但我没有看到它持有任何值......看起来它只是检查输入数字的数值，如何检查有效的整数输入？

```
int number;
.
.
.
    cout<<"Please enter a number: ";
    while (!(cin >> number))
    {
        cin.clear();
        cin >> badinput;
        cout <<"Input " << badinput << " is invalid, please enter a number: ";
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T01:04:11.767

`operator >>`在输入流上返回对流的引用，而不是从流中读取的内容。读取的值放入参数引用的内容中，该值必须是左值。

iostream 上的`!`运算符测试流上的失败标志——如果流上出现任何类型的失败，它返回 true。对于输入流，如果您尝试读取整数（如此代码所做的那样）并且输入看起来不像整数，则会设置失败标志。

所以这段代码（试图）读入一个整数`number`，然后测试失败标志。如果它被设置，它会清除失败标志，读取`badinput`（可能是一个字符串），打印消息并循环，尝试读取另一个整数。

所以只要唯一的失败是格式化，它就会循环直到它得到一个整数。如果还有其他一些更持久的故障（例如，如果 cin 获得 EOF 或已关闭），它将永远循环。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-28T00:09:43.227

在我看来，它会检查是否输入了正数。正数将为真，导致`!number`为假并跳过循环。如果输入的不是正数，则为假，导致`!number`为真，进入循环。

# python - Python：递归地将 int 转换为二进制字符串

> ID：13595462
> 
> 赞同：0
> 
> 时间：2012-11-28T00:01:53.637
> 
> 标签：python

我正在尝试将 int 递归转换为二进制字符串，但我并不真正了解整个正整数到二进制字符串转换的工作原理。

还发现显然每个位置都代表了 2 的幂。

如上面的谷歌示例所示，任何关于如何将正整数转换为字符串表示的解释都非常有帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T00:06:30.907

这是将 int 转换为二进制字符串的递归实现，这是我认为这个问题所要求的：

```
def recursive_bin(i):
    if i == 0:
        return ''
    elif i < 0:
        return '-' + recursive_bin(-i)
    else:
        return recursive_bin(i>>1) + str(i&1) 
```

请注意，这仅作为递归练习有用，如果您只是想获取二进制字符串，请使用内置[`bin()`](http://docs.python.org/2/library/functions.html#bin)函数。

这是有效的，因为`i&1`会给你最后一位`i`（要么`0`或`1`），并将`i>>1`所有位`i`向右移动一位（相当于除以 2）。这是对 6 (110 [2] ) 的解释：

```
# 6 is 110 in binary
recursive_bin(6)
recursive_bin(6>>1) + str(6 & 1)        -> recursive_bin(3) + '0'
recursive_bin(3>>1) + str(3 & 1) + '0'  -> recursive_bin(1) + '1' + '0'
recursive_bin(1>>1) + str(1 & 1) + '10' -> recursive_bin(0) + '1' + '10'
recursive_bin(0) + '110'                -> '' + '110'
# Final result is '110', since the base case of 0 returns an empty string 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-28T00:06:09.827

Python 有一个内置函数：

```
>>> bin(6)
"0b110" 
```

反过来（有点）：

```
>>> 0b110
6 
```

# c++ - 删除数组时断言失败

> ID：13595466
> 
> 赞同：1
> 
> 时间：2012-11-28T00:02:15.040
> 
> 标签：c++

我的框架类中有一个析构函数：

```
delete this->frameMatrix; 
```

其中 framematrix 属于 Matrix 类，其中 this 作为构造函数和析构函数：

```
// Constructor: Initialize matrix & sizes
Matrix::Matrix(int width, int height)
{
        table = new double* [height];
        for(int i = 0; i < height; i++)
                table[i] = new double [width];

        // Set all values to zero
        for(int row = 0; row < height; row++)
        {
                for(int col = 0; col < width; col++)
                {
                        table[row][col] = 0;
                }
        }

        this->width = width;
        this->height = height;
}

// Destructor: delete matrix
Matrix::~Matrix()
{
        for(int row = 0; row < height; row++)
                delete [] table[row];
        delete [] table;

        this->width = 0;
        this->height = 0;
} 
```

当在 frameMatrix 上调用 delete 时，程序在矩阵的析构函数中给出了一个断言失败。

我做错了什么，因为我没有看到如何删除二维双数组的问题。

编辑：

复制构造函数：

```
Matrix::Matrix(const Matrix &m)
{
    this->height = m.getHeight();
    this->width = m.getWidth();

    this->table = new double* [height];
        for(int i = 0; i < height; i++)
                this->table[i] = new double [width];

        for(int row = 0; row < height; row++)
        {
                for(int col = 0; col < width; col++)
                {
                    this->table[row][col] = m.table[row][col];
                }
        }

} 
```

我的重载=

```
 Matrix &operator = (const Matrix &m)
    {
        this->height = m.getHeight();
        this->width = m.getWidth();

        this->table = new double* [height];
        for(int i = 0; i < height; i++)
            this->table[i] = new double [width];

        for(int row = 0; row < height; row++)
        {
            for(int col = 0; col < width; col++)
            {
                this->table[row][col] = m.table[row][col];
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:05:22.597

你有一个复制构造函数`operator=`吗？您需要覆盖这些方法的默认实现，因为您已经获得了动态分配的指针。

```
class Matrix
{
public:
    Matrix(const Matrix &);
    Matrix &operator = (const Matrix &);
}; 
```

如果没有它们，每当`Matrix`复制对象时，新对象将具有与原始对象相同的指针。析构函数最终`delete`会使数组加倍。

附带说明一下，无需重置`width`和`height`在析构函数中。在对象被销毁后，这些字段将无法访问。

 ~~~~```
this->width = 0;
this->height = 0; 
```~~  ~~* * *

赋值运算符的样板代码：

```
Matrix &operator = (const Matrix &m)
{
    // Don't do anything for `m = m;`.
    if (&m == this)
        return *this;

    // Delete existing contents.
    ...

    // Copy other matrix.
    ...

    return *this;
} 
```~~~~

# java - 我的 android 应用程序是安装在 SD 卡还是内置手机存储上

> ID：13595467
> 
> 赞同：1
> 
> 时间：2012-11-28T00:02:20.367
> 
> 标签：java, android

Java中是否有任何方法可以实际确定您的android应用程序是否安装在SD卡或内部电话存储上。

如果我的应用程序安装在内部电话存储中，并且我的应用程序创建了一个文本文件，那么该文本文件也存储在内部电话存储中，对吗？那么当将应用程序移动到 SD 卡时，文本文件也会移动到 SD 卡吗？

那有意义吗？=P

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:13:49.037

> Java中是否有任何方法可以实际确定您的android应用程序是否安装在SD卡或内部电话存储上。

查看[ApplicationInfo.FLAG_EXTERNAL_STORAGE](http://developer.android.com/reference/android/content/pm/ApplicationInfo.html#FLAG_EXTERNAL_STORAGE)

> 如果我的应用程序安装在内部电话存储中，并且我的应用程序创建了一个文本文件，那么该文本文件也存储在内部电话存储中，对吗？

不一定 - 这取决于您用于创建文件的方法。创建内部或外部文件通常使用完全不同的方法。

例如，创建内部文件的首选方法是使用..

```
openFileOutput(String name, int mode) 
```

同样，读取内部文件的首选方法是...

```
openFileInput(String name) 
```

如果将原始文件移至 SD 卡，则无法找到它，因为它`openFileInput(String name)`仅适用于内部存储。换句话说，如果移动过程移动了内部文件，它将“破坏”程序员的代码。

> 那么当将应用程序移动到 SD 卡时，文本文件也会移动到 SD 卡吗？

不，由于上述原因，数据文件的创建及其存储位置与实际应用程序的物理安装位置无关。

# javascript - 如何覆盖 $exceptionHandler 实现

> ID：13595469
> 
> 赞同：73
> 
> 时间：2012-11-28T00:02:33.470
> 
> 标签：javascript, exception-handling, angularjs

每当抛出 javascript 异常时，我们都想做一些额外的事情。

从上的文档`$exceptionHandler`：

> 角度表达式中任何未捕获的异常都将委托给此服务。默认实现只是委托给 $log.error 将其记录到浏览器控制台中。

它说“默认实现”的事实让我认为有一种方法可以为服务提供我们自己的实现，并在抛出异常时做我们想要的事情。我的问题是，你是怎么做到的？我们如何才能让所有异常都转到该服务，然后提供我们想要发生的功能？

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2013-06-05T14:46:15.173

我为此找到的另一个选择是`$exceptionHandler`通过[$provide.decorator](https://docs.angularjs.org/api/auto/service/$provide#decorator)函数“装饰”。如果您想将其用作自定义实现的一部分，这将为您提供对原始实现的引用。因此，您可以执行以下操作：

```
mod.config(function($provide) {
    $provide.decorator("$exceptionHandler", ['$delegate', function($delegate) {
        return function(exception, cause) {
            $delegate(exception, cause);
            alert(exception.message);
        };
    }]);
}); 
```

它将执行原始异常处理程序所做的事情，以及自定义功能。

看到这个[更新的小提琴](http://jsfiddle.net/Jq8KK/30/)。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2012-11-28T00:24:06.733

`$exceptionHandler`您可以通过创建具有相同名称的服务来覆盖该功能：

```
var mod = angular.module('testApp', []);

mod.factory('$exceptionHandler', function () {
    return function (exception, cause) {
        alert(exception.message);
    };
}); 
```

请参阅[此小提琴](http://jsfiddle.net/Jq8KK/)以获取示例。如果您注释掉工厂定义，`$exceptionHandler`您将看到错误将记录到控制台而不是警告它。

这是一个[组线程](https://groups.google.com/d/topic/angular/lbFY_14ZtnU/discussion)，其中有一个注入其他服务的示例，例如`$http`使用`$injector`.

**注意：**如果您不想覆盖`$exceptionHandler`（或其他内置服务）的现有功能，请参阅[此答案](https://stackoverflow.com/a/16942964/1207991)以获取有关如何装饰服务的信息。

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2013-07-13T15:44:54.710

您可以覆盖任何服务/工厂，甚至 $cookieStore。如果您想要一个成熟的、可配置的对象，这里是[一个非常好的示例](http://jsfiddle.net/pkozlowski_opensource/PxdSP/14/)：

```
var myApp = angular.module('myApp', []);

//provider style, full blown, configurable version     
myApp.provider('helloWorld', function() {

    this.name = 'Default';

    this.$get = function() {
        var name = this.name;
        return {
            sayHello: function() {
                return "Hello, " + name + "!"
            }
        }
    };

    this.setName = function(name) {
        this.name = name;
    };
});

//hey, we can configure a provider!            
myApp.config(function(helloWorldProvider){
    helloWorldProvider.setName('World');
});

function MyCtrl($scope, helloWorld, helloWorldFromFactory, helloWorldFromService) {

   helloWorld.sayHello(),
} 
```

# ruby-on-rails - rails中的has_many关联不返回子行

> ID：13595473
> 
> 赞同：1
> 
> 时间：2012-11-28T00:02:47.963
> 
> 标签：ruby-on-rails

```
class Department < ActiveRecord::Base

attr_accessible :Department_Id, :DepartmentName,:LocationID
set_primary_key :Department_Id 
has_many :Employee

end 
```

* * *

导轨控制台：

```
dept=Department.find(50)
dept.Employee 
SELECT `employees`.* FROM `employees` WHERE `employees`.`Department_Id` IS NULL 
```

为什么它在where子句中附加NULL，我期待看到50。我做错了什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:07:59.637

在 ruby​​ 中，以大写字母开头的变量是常量变量。您的代码应更改为：

```
class Department < ActiveRecord::Base

attr_accessible :department_id, :department_name,:location_id
has_many :employees

end 
```

更新：我只是举了一些例子。您需要相应地更改所有变量、数据库列名等。请确保一切都符合规则：常量变量以大写字母和局部变量开头，实例变量都是小写，其中单词用破折号分隔。

如果您的代码符合规则，则不必调用`set_primary_key`和设置`foreign_key`belongs_to 关联。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T01:30:47.333

您必须遵循适当的约定，大写字母的变量表示常量变量，请尝试如下

```
class Department < ActiveRecord::Base

  attr_accessible :Department_Id, :DepartmentName,:LocationID
  set_primary_key :Department_Id 
  has_many :employee

end 
```

如果你这样做，甚至会更好

```
class Department < ActiveRecord::Base

  attr_accessible :department_id, :department_name,:location_id
  set_primary_key :department_id 
  has_many :employee

end 
```

# java - 如何将数据发送到新的 Android 活动

> ID：13595476
> 
> 赞同：-4
> 
> 时间：2012-11-28T00:03:22.120
> 
> 标签：java, android, android-activity

我正在开发一个收集用户选择（来自复选框）并将其发送到新活动（按下按钮时）的应用程序。在新的活动中，将收集一个新的数据（editText），并将接收到的数据+新收集的数据合并并通过电子邮件发送。

当我按下第一个按钮将复选框数据发送到新活动时，出现错误：

> 应用程序意外停止

这是代码：

```
 public void onClick(View v) 
{

                   cakeDataformated();
                   // to convert the data (checkBox) to a string
                   String fianlformatedData = cakeDataformated();

                    Intent i = new Intent(this, PersonData.class);  
                    i.putExtra("cakedata", fianlformatedData);
                    startActivity(i);

    } 
```

复选框转换方法为：

```
 public String cakeDataformated () {
    // TODO Auto-generated method stub

    boolean checkyStatus1 = checky1.isChecked();
    boolean checkyStatus2 = checky2.isChecked();
    boolean checkyStatus3 = checky3.isChecked();
    boolean checkyStatus4 = checky4.isChecked();
            // to read the checkbox data
    String form = finalFormUsingFollowing (checkyStatus1 ,checkyStatus2 ,checkyStatus3 , checkyStatus4 );
        //  to convert the check box response into a message and save it as 
            //  a string called form
            // example : cakes selected are : cake1 , cake3 
    return form ;

} 
```

所以，如果有任何错误，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-27T01:31:29.540

```
RadioGroup radioGroup = (RadioGroup) this
            .findViewById(R.id.radio_group);
    radioGroup
            .setOnCheckedChangeListener(new RadioGroup.OnCheckedChangeListener() {

                @Override
                public void onCheckedChanged(RadioGroup radioGroup, int id) {
                    final RadioButton radioButton = (RadioButton) radioGroup
                            .findViewById(id);

                    String selectedText = radioButton.getText().toString();
                    Intent i = new Intent(this, PersonData.class);
                    i.putExtra("cakedata", selectedText);
                    startActivity(i);
                }

            }); 
```

# php - PHP在命名空间中声明常量

> ID：13595484
> 
> 赞同：4
> 
> 时间：2012-11-28T00:03:53.563
> 
> 标签：php, namespaces, constants

我想在命名空间内声明常量。我当然希望它们在它之外不可见。

使用 define() 将不起作用，因为它使常量全局化，而不管它在哪个名称空间中执行（如果我理解得很好）。

我可以这样做：

```
namespace paths;

const models  = 'Models/';
const views   = 'Views/';
const classes = 'Classes/'; 
```

在其他地方：

```
require_once(paths\models.'user.php'); // works
require_once(models.'user.php');       // fails 
```

另外，如果我这样做：

```
namespace ns;
namespace subNs; 
```

我在 ns\subNs 还是在 subNs 中？

PS：我知道做 require_once('Models/user.php'); 会更简单，但这只是一个例子。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T00:12:17.787

广告 1\. 是的，你可以。可以通过运行示例脚本来检查；（但您可能必须先使用`\paths\constant`or `use paths;`）

Ad 2\. subNs 可以通过以下方式检查`echo __NAMESPACE__;`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T00:14:44.953

你不能做你想做的事。

如果按照您声明的方式定义了您不想执行的操作，那么您可以在 require 函数中使用常量“模型”的唯一方法。

Why don't you write a class to do this?

```
<?php
class PATHS {

    public $models = null;
    public $views = null;
    public $classes = null;

    public function __construct($namespace) {

         switch ($namespace) {
            case 'path1' :
                $this->models = 'my_custom_path/models';
                $this->$views = 'my_custom_path/views';
                $this->classes = 'my_custom_path/classes';
             break;
             case 'path2' :
                $this->models = 'my_custom_path/models';
                $this->$views = 'my_custom_path/views';
                $this->classes = 'my_custom_path/classes';
             break;
             default :
                $this->models = 'my_custom_path/models';
                $this->$views = 'my_custom_path/views';
                $this->classes = 'my_custom_path/classes';
             break;
         }

    }

}

$paths =new PATHS('my_namespace');

echo $paths->models;
echo $paths->views;
echo $paths->classes;

?> 
```

I don't fully understand what your end-goal is, but I think I get the gist of it, and a similar class turned into an object should accomplish what you want.

You can simply include that class in your framework where necessary.

Hope that helps

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-09T14:21:13.963

You CAN use define to declare namespace constants, like so:

```
<?php namespace paths;
// Preferred way in a file that does not declare the namespace:
define('paths\\models', 'Models/');
define('paths\\views', 'Views/');
define('paths\\classes', 'Classes/');

// Preferred way in file with the namespace declared:
const models  = 'Models/';
const views   = 'Views/';
const classes = 'Classes/';
?> 
```

Coming in PHP 5.6, you will be able to auto load constants via the "use" keyword, see here: [http://php.net/manual/en/migration56.new-features.php](http://php.net/manual/en/migration56.new-features.php)

# fortran77 - 使用 gnu plot 从 fortran 77 程序中绘制线图

> ID：13595486
> 
> 赞同：0
> 
> 时间：2012-11-28T00:04:04.907
> 
> 标签：fortran77

我有以下代码：

```
 PROGRAM EULER
      REAL A,B,X,H
      INTEGER N
      PARAMETER (A=0.0,B=2.9884,N=10)
      EXTERNAL RHS
      REAL Y(0:N)
      H=(B-A)/N
      X=XIN+H

10    FORMAT(1X,G12.4,4X,G12.4)  
      Y(0)=0
      DO I=1,N
        CALL ESTEP(H,A+(I-1)*H,Y(I-1),RHS,Y(I))
        WRITE (*,FMT=10) A+(I*H),Y(I)
      END DO
      END

      SUBROUTINE ESTEP (H,XIN,YIN,RHS,YOUT)
      REAL H,XIN,YIN,YOUT
      CALL RHS(XIN,YIN,DYDX)
      YOUT=YIN + H*DYDX
      END

      SUBROUTINE RHS(X,Y,DYDX)
      REAL X,Y,DYDX 
      DYDX=2*X**3+Y**3
      END 
```

我需要让主程序在我的主目录中打开一个名为“data”的文件，并将 x 值及其相应的解决方案值写入 2 列排列的“data”中，其中 x 值在左列中，y在右边。我还需要创建“数据”文件的线图。当我在终端中运行代码时，代码会编译并给出正确的输出，但我认为它不会将其写入数据文件。那是我不确定该怎么做的部分。当我尝试使用 gnuplot 这就是我得到的：

```
gnuplot> set style data lines
gnuplot> set output 'data.ps'
gnuplot> set terminal postscript
Terminal type set to 'postscript'
Options are 'landscape noenhanced defaultplex \
leveldefault monochrome colortext \
dashed dashlength 1.0 linewidth 1.0 butt noclip \
nobackground \
palfuncparam 2000,0.003 \
"Helvetica" 14  fontscale 1.0 '
gnuplot> plot 'data'
     warning: Skipping unreadable file "data"
     No data in plot 
```

我认为这是因为数据文件没有在主程序中打开。如果是这种情况，我将如何编码？

# c++ - STL/标准 C++ 容器的最佳效率如何？

> ID：13595487
> 
> 赞同：0
> 
> 时间：2012-11-28T00:04:13.753
> 
> 标签：c++, c, boost, stl

我正在阅读这篇文章：

[https://stackoverflow.com/a/3183607/997112](https://stackoverflow.com/a/3183607/997112)

这是对 C++ 和 C# 之间性能问题的回答。海报来自高频交易背景，并说他为 HF 工作编写了自己的类库，因为他正在寻找纳秒级的节省。在他的帖子中，他提到他很少使用 C++ STL——这让我很吃惊。

我的问题是 - C++ STL 在性能方面是完全优化的，还是只针对普通用户进行了优化？用 C 语言在原生数组周围包装一些函数会比说 Vector 或 List 更快吗？boost 中有没有性能更好的容器？

我很欣赏这些课程对于 99% 的用户来说足够快——但我的问题是针对其他 1% 的用户。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T00:19:10.143

由于多种原因，这个问题不会得到任何说明“STL 是最佳的”的答案：

1.  至少有六种 STL 实现，其中肯定有一些未优化，而另一些则已优化（但请参阅下一项）。
2.  您所做的大多数优化都会对使用模式做出假设，并且会对某些使用模式感到悲观。要真正针对特定用例进行优化，需要了解如何使用某些东西。
3.  大多数 STL 用户以一种或另一种形式滥用组件，并且某些正确使用仅在 C++ 2011 中得到真正支持（例如，使用本地自定义分配器）。
4.  当人们谈论 STL 时，他们通常指的是使用算法运输的示例容器。虽然有用，但 STL 的重点是算法，这些算法有更好的优化机会。毕竟，STL 的全部意义在于您可以轻松地将算法与自定义创建的容器一起使用！为什么要费心优化容器？但是，请注意，项目 1 到 3 也适用于算法。
5.  STL 有一个很好的抽象，但不是很“有”。特别是，当组合多种算法时，存在比单独应用算法更好的方法，但 STL 接口并不真正支持这一点。

综上所述，要提出比典型的优化 STL 实现更好的东西需要相当多的努力。我会质疑任何人的断言，例如，`std::vector<T, A>`在一天内编写了一个替换 for 并声称对于典型用例`std::vector<T, A>`（指可以合理使用分配器的 C++ 2011 版本）更快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T00:34:22.210

从实际阅读帖子中，这一点很突出：

“*所有自定义同步类仅在空时同步，自定义分配器，自定义无锁队列和列表，偶尔的 STL（带有自定义分配器），但更常见的是自定义侵入式集合（其中我有一个重要的库）。* ”

STL 是为处理读取的多个线程而设置的，但当然需要锁和其他同步原语来处理多个写入者。如果作者真的编写了自定义的无锁队列和列表，那么它可能会比带锁的纯 STL 提供相当大的性能提升。同样几乎可以预期自定义分配器，默认值`std::allocator<T>`是已知的“中间道路”类型的解决方案。根据分配模式，使用带有内存池的分配器可以提供显着的加速。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-28T00:24:20.317

C++03 在复制方面有一个非常明显的性能问题，但在 C++11 中通过移动语义和完美转发解决了这个问题。

该规范定义了所有标准算法的复杂性，因此您可以期待所有实现的特定性能行为。

通常当人们抱怨 stdlib 性能时，他们使用了错误的工具来完成这项工作，只需要改进他们的算法。C++ 提供了很多东西，但它从不假装一件事适用于所有事情。

我发现 stdlib 集合缺少两件事：

当您想要从池或竞技场中分配集合时。分配器（甚至是有状态的）只是不够灵活，无法在所有情况下以零开销完成此操作。

此外，有时实现某些东西的最有效方法是合并两个集合。一个例子是缓存，您可能希望分别合并 an`unordered_map`和 a`list`用于查找和 LRU。标准集合并没有使这非常有效。

在这两种情况下，Boost Intrusive 都提供了所需的功能。

# entity-framework - 实体框架数据库优先 - 复合外键

> ID：13595494
> 
> 赞同：10
> 
> 时间：2012-11-28T00:04:58.850
> 
> 标签：entity-framework, entity-framework-5, composite-key, ef-database-first

我有一个包含几个复合外键的数据库。例如，这里是外键的生成脚本：

```
ALTER TABLE [dbo].[WorkingRosters]  WITH NOCHECK ADD  CONSTRAINT
[FK_WorkingRoster_ShiftLeaveCode] FOREIGN KEY([OrganizationID], [ShiftLeaveCode])
REFERENCES [dbo].[ShiftLeaveCodes] ([OrganizationID], [Code])
GO 
```

我正在尝试使用 Entity Framework 5 Database-First 从该数据库生成模型。但是，复合外键的关联并没有与所有表和其他简单外键一起生成。

我怎么能：

1.  在edmx后面的xml中手动创建这些复合外键（痛苦）
2.  让实体框架正确生成这些外键，以便我拥有映射

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-26T04:18:39.800

Entity Framework Database First 不会按照您的需要使用唯一键。如果您希望它们成为导航属性，则应将它们设置为外键。

现在，您必须选择：1）您只需要 NavPrs，2）您还需要连接表作为一个实体。

1）要实现这一点，只需将这些外键设置为复合主键。

2）要实现这一点，请将它们保留为外键，并为您的联结表声明一个身份类型 ID 列并将其设置为主键。

这应该适合你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-19T15:14:20.853

我在 EF6 中遇到了同样的问题，其中 Visual Studio 中的“从数据库更新模型”无法识别复合外键，该外键引用了另一个表中具有唯一索引但不是所引用的复合主键的列桌子。

在将引用列作为引用表中的复合 PK 并重做“从数据库更新模型”后，外键被识别为导航属性。

即使引用的列成为 PK 解决了我在 EF6 中的问题。

# java - 创建无序映射 在java中

> ID：13595497
> 
> 赞同：6
> 
> 时间：2012-11-28T00:05:12.033
> 
> 标签：java, collections, map, declaration

所以我需要某种多字符集，其中添加重复字符会使基数增加 1，并且字符的多样性不应大幅增加对象占用的内存。

这将通过某种映射来实现，其中字符是键，它保存一个值，该值表示该字符在集合中的数量。

但是，我正在努力找出最适合此的集合（我正在查看 hashmap）以及如何声明此数据类型。我正在做这样的事情

```
Map m = new HashMap(char, int); 
```

但以上是一个不正确的声明，我不确定如何准确地解决这个问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-28T00:09:24.600

试试这个声明：

```
Map<Character, Integer> m = new HashMap<Character, Integer>(); 
```

然后，您可以像这样添加字符：

```
char c = //...;
if (m.containsKey(c))
    m.put(c, m.get(c) + 1);
else
    m.put(c, 1); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-28T08:56:44.890

我会使用`int[]`（对于 ASCII）或`int[][]`unicode 来实现它。考虑到将装箱整数存储在哈希映射中的内存占用以及使用数字引入的所有哈希冲突，并且字符只不过是数字作为键。

```
public class CharacterBag {

    private int[][] data = new int[255][];

    public void add(char ch) {
        int[] bin = data[ch >> 8];
        if (bin == null) bin = data[ch >> 8] = new int[255];
        bin[ch & 0xFF]++;
    }

    public int frequency(char ch) {
        int[] bin = data[ch >> 8];
        if (bin == null) return 0;
        return bin[ch & 0xFF];
    }

} 
```

这从零内存占用开始，并为每个 unicode 页增加 2K。通常，文本使用一两个 unicode 页面中的字符。

相比之下，使用 HashMap 会产生将盒装原语存储在链表列表中的全部开销。对于每个字符，将有一个`Entry`类的对象，它有两个指向装箱键的指针和一个链表对象，它的所有字段都包含一个`Node`带有前向和后向指针的类对象，它有一个指向装箱整数的指针……我要继续吗？;)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T00:13:34.353

```
Map<Character, Integer> charCount = new HashMap<Character, Integer>();

public void addCharacter(char c) {
    Integer value = charCount.get(c);
    if (value == null) {
        charCount.put(c, 1);
    } else {
        charCount.put(c, value + 1);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T00:19:50.387

Java 集合不允许您创建原始类型的集合，而是应该使用它们各自的包装类（例如，int 的包装类是整数）。

```
Map<Character,Integer> hashMap = new HashMap<Character,Integer>(); 
```

这就是你声明地图的方式。有关更多示例和说明，请查看[此处](http://docs.oracle.com/javase/tutorial/collections/interfaces/map.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-03T15:06:54.393

根据我的最佳方法是使用构造函数：

```
Map<Key, Value> orgMap = new HashMap<Key, Value>();
Map<Key, Value> copyMap;
copyMap= new HashMap<Key, Value>(map); 
```

把事情简单化。

# c++ - 如何编译需要的 c++ 项目 ?

> ID：13595498
> 
> 赞同：0
> 
> 时间：2012-11-28T00:05:14.337
> 
> 标签：c++, winsock2

我下载了一个包含以下两行的项目：

```
#include <winsock2.h>
#include <Afxwin.h> 
```

我对如何编译它感到困惑，因为我的标准编译器找不到选定的文件。

为了成功编译它，我需​​要配置我的编译器的搜索路径吗？

我尝试使用的编译器是 Dev-C++。

编辑：我猜我必须配置某些库以在编译时使用（但是哪个？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:10:24.833

你是在 Windows 上构建的吗？

这些是 Microsoft 包含的文件。如果你有 Visual Studio，winsock 应该是可用的。但是对于 afx (MFC)，我相信你需要一个商业版。

如果您有一个商业 Visual Studio 并且它仍然找不到它们，那么只需配置编译器以包含正确的目录（但它应该是开箱即用的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:10:27.953

winsock2.h 是 Windows SDK 的一部分，Afxwin.h 是主要的 MFC/ATL 包含文件。

您应该能够从 Microsoft 站点下载当前的 Windows SDK，但这不包括 MFC 代码 - 我很确定您需要 Visual Studio 才能使用 MFC 和 ATL。

# batch-file - 用于确定正在使用的以太网接口的命令行

> ID：13595499
> 
> 赞同：3
> 
> 时间：2012-11-28T00:05:15.857
> 
> 标签：batch-file, cmd, netsh, ipconfig

我编写了一个脚本来帮助在部署计算机后对其进行配置。该脚本执行设置计算机名称、启用 BitLocker 等操作。我正在努力解决的一件事是 IP 地址的设置。我正在使用的计算机（具体是服务器）有 4 个 NIC 端口，它们被命名为 Local area connection 和 Local area connection 2-4。问题是部署这些服务器的技术人员并不总是插入同一个端口，此外，部署映像并不总是将以太网局域网连接分配给 NIC 端口 1。

这是我拥有的脚本的副本，如果只启用一个 NIC 端口，它就可以完美运行。我需要做的是将具有 IP 地址（因为 DHCP 已经存在）的本地连接名称的输出通过管道传输到我可以放入`netsh`命令中的变量中。

当前代码到位

```
:IPADDRESS
@echo Would you like static or DHCP?
@echo press 1 for static
@echo press 2 for dhcp
Choice /C:12 /N /M "?:"
IF ERRORLEVEL 2 GOTO IPDHCP
IF ERRORLEVEL 1 GOTO IPSTATIC

:IPSTATIC
set /P _IPADDR=Please enter IP address:
set /p _Subnet=Please enter Subnet:
set /p _DefaultGateway=Please Enter Default Gateway:

netsh interface ip set address name="Local Area Connection 2" static %_IPADDR% %_Subnet% %_DefaultGateway%
goto START

:IPDHCP
  netsh interface ip set address "Local Area Connection 2" dhcp
 goto START

 :disipaddr
  netsh interface ip show config name="Local Area Connection 2" 
```

名称“Local Area Connection 2”是随着构建而变化的部分。这就是我需要隔离的部分。我相当确定 for`/p`和使用它来对抗`ipconfig /all`或者 netsh interface ip show config 将是正确的方法。

预先感谢您提供的所有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-04T16:07:52.960

这将在 Windows 7 上运行和测试。

## 一个批处理.bat 文件：

```
@echo off

for /f "tokens=2 delims==" %%F in ('wmic nic where "NetConnectionStatus=2 and AdapterTypeId=0" get  NetConnectionID /format:list') do set interfaceName=%%F

echo Your Interface is %interfaceName%

pause 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T16:37:14.887

也许你可以用`wmic`它？类似于以下内容：

```
for /f "tokens=2 delims==" %F in ('wmic nic where "NetConnectionStatus=2 and AdapterTypeId=0" get  NetConnectionID /format:list') do set %activeNet%=%F 
```

它应该返回所有连接的 ( `NetConnectionStatus=2`) Eth/802.3 ( `AdapterTypeID=0`) 接口 - 即在您的实例中连接的接口。*（由于某种原因，它还在我的 XP 笔记本电脑上将 WiFi 报告为 802.3，但这对于服务器来说应该不是问题）*

您可以直接从命令行尝试它，看看它是否返回它应该返回的内容。如果批量使用，请替换`%F`为。`%%F`

请注意，可能需要检查已连接接口的返回值，因为不同操作系统的返回值不同。[Win32_NetworkAdapter 类的完整描述](http://msdn.microsoft.com/en-us/library/windows/desktop/aa394216%28v=vs.85%29.aspx)（这`nic`是它的别名）

如果您 100% 确定只想检查以“本地连接”开头的那些，则可以使用`where "netconnectionID like 'Local Area Connection%'"`（或将其与其他条件结合使用）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-11T18:08:35.457

您的意思是已连接，哪些正在使用中？

```
:_InterfaceConnected_
FOR /F "tokens=3,*" %%A IN ('netsh interface show interface^|find "Connected"') DO (
echo %%B
echo connected : %%B
)
@echo:

:_InterfaceDisconnected_
FOR /F "tokens=3,*" %%A IN ('netsh interface show interface^|find "Disconnected"') DO (
echo %%B
echo disconnected : %%B
) 
```

给出作为输出：

```
Ethernet
connected : Ethernet

Ethernet 3
disconnected : Ethernet 3 
```

完整的概述，通过命令

```
> netsh interface show interface 
```

输出 ：

```
Admin State    State          Type             Interface Name
-------------------------------------------------------------------------
Enabled        Disconnected   Dedicated        Ethernet 3
Enabled        Connected      Dedicated        Ethernet 
```

# javascript - 删除我没有设置的断点

> ID：13595506
> 
> 赞同：0
> 
> 时间：2012-11-28T00:05:34.797
> 
> 标签：javascript

当我在 chrome 控制台中使用代码时，似乎经常发生网页的执行被 jquery 文件中的断点停止，如下所示。如果我在运行页面时没有打开控制台，它不会停止，只有在控制台打开时才会停止。我也无法单击断点来禁用它。在这种情况和其他情况下，当我尝试使用自定义 javascript 访问文件时，它也不会出现在源代码中，这可能是因为事情已经停止加载。我单击 ||> 箭头推动断点，但带有 javascript 的文件永远不会加载到脚本中，因此我无法在我想要的位置设置断点。我告诉你的是否解释了我可能做错了什么？

![在此处输入图像描述](../Images/906792fa5682947ed3718b5937b5d1b1.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:10:52.210

您可能已将 Chrome 设置为在出现异常时暂停，这似乎是默认设置。悬停和/或单击开发工具源面板左下方带有暂停符号的小停止符号以更改设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:11:01.477

这可能来自“调试器”行。在代码中。如果是这种情况，除了删除代码之外，没有办法停止断点。

# c - 任务农场模式和mongrel2

> ID：13595507
> 
> 赞同：0
> 
> 时间：2012-11-28T00:05:45.227
> 
> 标签：c, zeromq, mongrel2

我正在考虑使用 mongrel2 处理 Web 服务请求。对于后端，我想使用任务农场模式，使用 C 绑定到 zeromq。

不过，在阅读了 mongrel2 手册之后，我不清楚如何实现这一点，因为后端处理程序会从 mongrel2 拉取消息并使用 ZMQ_PUB 套接字将消息发送到 mongrel2。

我想将消息从处理程序转发到后端的任务场，并在处理程序中接收响应，然后将其发布到 mongrel2。zeromq 客户端是否可以绑定到多个 (2) 输入和多个 (2) 输出？

FWIW，我在 ANSI C 中实现这个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T07:06:21.010

我觉得您正在寻找的内容接近 zeromq 指南中的呼吸机模式轮廓：http://zguide.zeromq.org/page:all#Divide-and- [Conquer](http://zguide.zeromq.org/page:all#Divide-and-Conquer)。

图中的通风器和接收器都将位于您的 Web 服务中（您可以在应用程序中创建多个套接字）。

PUSH 和 PULL 套接字可以将数据推送/拉取到任意数量的下游/上游套接字，因此您的 Web 服务对于任意数量的工作人员只需要两个套接字。

# spring - Sun JSTL taglib 声明因“找不到标记库描述符”而失败

> ID：13595511
> 
> 赞同：67
> 
> 时间：2012-11-28T00:06:10.170
> 
> 标签：spring, jsp, spring-mvc, jstl

我正在使用 JSP 页面来打印一组值。我正在尝试为此使用 JSTL `<c:forEach>`。

```
<c:forEach items="${objects}" var="object">
    <td>${object.name} </td>
</c:forEach> 
```

问题是我的 JSTL taglib 声明：

```
 <%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%> 
```

IDE 在此行显示错误

> 找不到标记库描述符。

许多论坛指向旧的 Sun 站点以下载 JSTL 库。现在所有这些链接都指向 Oracle 主页，而没有指向 JSTL 二进制文件的链接。这使我相信有一种更新的方法可以实现这一目标。

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2012-11-28T01:54:17.863

要解决此问题：

1.  `jstl jar`应该在您的类路径中。如果您使用的是*maven ，请使用*[此处](http://mvnrepository.com/artifact/jstl/jstl/1.2)`pom.xml`提供的代码段在您的 jstl 中添加一个依赖项。如果您不使用*maven ，请从*[此处](http://repo1.maven.org/maven2/jstl/jstl/1.2/jstl-1.2.jar)下载 jstl jar并将其部署到您的.*`WEB-INF/lib`*

**   确保您的顶部有以下 taglib 指令`jsp`：

    ```
     <%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%> 
    ```* 

 ** * *

## 回答 #2

> 赞同：35
> 
> 时间：2012-11-28T01:55:29.600

只需查看我们自己的[JSTL wiki 页面](https://stackoverflow.com/tags/jstl/info)，即可获得正确的下载链接和清晰的安装说明。

将鼠标放在您`[jstl]`自己放置在问题上的标签上方，直到出现一个黑框，然后单击其中的*信息*链接。

> ![在此处输入图像描述](../Images/4164ff20f70d6b02c22e3c3221d6788c.png)

然后向下滚动到 JSTL 版本信息，直到找到 JSTL 1.2（或 1.2.1）的下载链接。

> ![在此处输入图像描述](../Images/69b2509a21c11cbfcd1f5e62f3e3aa14.png)

最后，只需将该文件完全放入 webapp 的`/WEB-INF/lib`.

> ![在此处输入图像描述](../Images/78edda74721d74d810fadaf6445a22af.png)

这样，taglib 声明就不能再给出任何错误，并且[JSTL 标记和函数](http://docs.oracle.com/javaee/5/jstl/1.1/docs/tlddocs/)应该可以正常工作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-01-03T16:14:54.743

我只是想分享我的经验。我对使用 maven 的 jstl 有同样的问题。我通过添加两个依赖项来解决它。

```
 <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>servlet-api</artifactId>
        <version>2.5</version>
    </dependency>
    <dependency>
        <groupId>jstl</groupId>
        <artifactId>jstl</artifactId>
        <version>1.2</version>
    </dependency> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-11-11T06:34:30.927

如果您使用 Tomcat 服务器，我建议您将 JSTL .jar 文件放到 Tomcat lib 文件夹中。通过这样做，您将可以自动访问所有 Web 项目中的 JSTL（当然，在 .jsp 文件中使用 taglib 声明）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-28T01:15:39.443

您可以下载[Apache Standard Taglib](http://tomcat.apache.org/taglibs/standard/)并将 jar 包含在您的项目中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-07-04T08:06:39.073

这是对不使用 maven 的人的修复。您还需要将`standard.jar`核心标签库添加到您的 lib 文件夹中才能正常工作。适用于 jstl 1.1 版。

```
<%@taglib prefix="core" uri="http://java.sun.com/jsp/jstl/core"%> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-24T10:16:25.010

我在使用 eclipse IDE 的 maven 项目中遇到了这个问题。我在项目的构建路径中更改了“顺序和导出”，将 Maven 依赖项放在首位，错误消失了。我猜这是因为 Eclipse IDE 最初是在加载 Maven 库之前构建我的应用程序源。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-06-24T20:22:30.403

我在![在此处输入图像描述](../Images/0197001a3277a2d83fa34c57d2470655.png)Spring Tool Suite 3.2 上遇到了同样的问题，并在将 jstl 的版本添加到依赖项列表时手动将其更改为 1.2（从 1.1.2），并且错误消失了。*

# visual-studio - Wix 模板未显示在项目列表中

> ID：13595519
> 
> 赞同：2
> 
> 时间：2012-11-28T00:06:44.153
> 
> 标签：visual-studio, wix, votive

我下载并安装了 WiX 3.5，据我了解，当我尝试创建一个新项目时，应该安装并使用 WiX 项目的模板。

我在某个地方错过了一步吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-28T09:05:50.530

在新建项目对话框中，在已安装的模板中应该有一个名为 Windows Installer XML 的条目。项目的类型在下面列出。我没有做任何特别的事情，只是运行安装程序，如果他们不在那里尝试修复。Wix 3.6 现已推出，如果您可以继续使用的话。

更新：根据您最后的评论，我做了更多的挖掘，看来您是对的，Visual Studio Express 不支持 Votive，即 Wix 插件。

见[http://wix.sourceforge.net/votive.html](http://wix.sourceforge.net/votive.html)

它说：

> Votive 不适用于 Visual Studio 的 Express SKU

我想替代方案是使用命令行工具，这可能需要更长的时间。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-07-11T18:14:56.690

Wix 3.5 和 Wix 3.7 不会在 Visual Studio 2010 proffesional 中安装任何模板。一种可能的解决方案是：http: [//visualstudiogallery.msdn.microsoft.com/a3448085-d6f0-4569-a670-0a18c825169b](http://visualstudiogallery.msdn.microsoft.com/a3448085-d6f0-4569-a670-0a18c825169b)

# javascript - 在同一页面上安装多个 d3.js 示例：CSS classes with svg.append?

> ID：13595522
> 
> 赞同：1
> 
> 时间：2012-11-28T00:07:10.150
> 
> 标签：javascript, d3.js

我正在尝试将两个 d3.js 示例合并到一个 html 文件中，该文件已放入[dropbox](http://dl.dropbox.com/u/17949100/d3.html)。作为参考，这两个示例是[A](http://bl.ocks.org/1062544)和[B](http://bl.ocks.org/3846051)。

为了合并这两个文件，我不得不使用 CSS 类并从 javascript 中调用它们。CSS：

```
circle.a { stroke: #fff; }
circle.b { fill: none; stroke-width: 1.5px; } 
```

不幸的是，我无法从 D3 调用 CSS 类：

```
var svg = d3.select("body").append("svg:svg")
svg.append("svg:circle[class=a]")
...
var svg = d3.select("body").selectAll("svg")
svg.append("circle[class=b]") 
```

更实际地，我可能希望在同一页面上运行多个 d3 图像。它可能采用与上述不同的方式。

@Moderators：随意移动到可能更适合的 StackExchange 的不同部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:20:27.403

你试过了吗：

```
 svg.append("svg:circle").attr("class","circle.a") 
```

您还可以使用该函数定义特定于该操作的属性，`attr`而无需创建 CSS 文件（但它很容易变得凌乱

# ruby-on-rails - 使用 Capybara 和 Selenium Grid 的堆栈级别太深异常

> ID：13595523
> 
> 赞同：0
> 
> 时间：2012-11-28T00:07:10.783
> 
> 标签：ruby-on-rails, rspec, capybara, selenium-grid

我正在努力将一些 Selenium 测试转换为使用 Selenium 网格并且遇到了问题。

测试在本地机器上使用浏览器运行良好。

我创建了一个这样的新驱动程序（在 spec_helper.rb 中）：

```
Capybara.register_driver :selenium_remote do |app|
  caps = Selenium::WebDriver::Remote::Capabilities.chrome
  Selenium::WebDriver.for(:remote, 
    :url => 'http://gridhub:4444/grid/driver', 
    :desired_capabilities => caps)
end 
```

当我使用新驱动程序运行测试时，会联系集线器并且节点加载 Chrome 驱动程序，网格侧的一切看起来都正常。

问题是在启动测试的机器上我得到以下异常：

```
Failure/Error: Unable to find matching line from backtrace
     SystemStackError:
       stack level too deep
# /home/.rvm/gems/ruby-1.9.3-p194/gems/capybara-2.0.1/lib/capybara.rb:298 
```

我创建了这个最基本的测试，但运行它时仍然看到相同的异常：

```
Capybara.default_driver = :selenium_remote

describe 'I can' do
  it 'visit Google without throwing an error' do        
    visit 'http://www.google.com'
  end
end 
```

我正在使用 Selenium 服务器独立 2.26.0、Capybara 2.0.1 和 RSpec 2.9.0。

任何想法是什么原因造成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T18:19:55.823

好吧，在这篇博文（[http://www.softr.li/blog/2012/11/08/capybara-selenium-rspec-vagrant-remotely](http://www.softr.li/blog/2012/11/08/capybara-selenium-rspec-vagrant-remotely)）的帮助下，我得到了它的工作。

上述博文基于另一篇博文（[http://www.without-brains.net/blog/2012/08/01/capybara-and-selenium-with-vagrant](http://www.without-brains.net/blog/2012/08/01/capybara-and-selenium-with-vagrant/)）。

看起来我错误地注册了 Capybara Selenium Web 驱动程序。

以下是博客文章中正确注册驱动程序的代码。只需按原样使用它即可解决我的问题，然后我对其进行了修改以供自己使用。

该代码也在要点中（[https://gist.github.com/4038197#file-capybara_remote-rb](https://gist.github.com/4038197#file-capybara_remote-rb)）。

创建一个新的 Ruby 文件，添加此代码，并将其包含在您的 spec_helper.rb 文件中。

```
# SELENIUM_SERVER is the IP address or hostname of the system running Selenium
# Server, this is used to determine where to connect to when using one of the
# selenium_remote_* drivers
SELENIUM_SERVER = "10.10.11.1"

# SELENIUM_APP_HOST is the IP address or hostname of this system (where the
# tests run against) as reachable for the SELENIUM_SERVER. This is used to set
# the Capybara.app_host when using one of the selenium_remote_* drivers
SELENIUM_APP_HOST = "10.10.11.2"

# CAPYBARA_DRIVER is the Capybara driver to use, this defaults to Selenium with
# Firefox
CAPYBARA_DRIVER = "selenium_remote_firefox"

# At this point, Capybara.default_driver is :rack_test, and
# Capybara.javascript_driver is :selenium. We can't run :selenium in the Vagrant box,
# so we set the javascript driver to :selenium_remote_firefox which we're going to
# configure.
Capybara.javascript_driver = :selenium_remote_firefox

RSpec.configure do |config|

  config.before(:each) do
    if selenium_remote?
      Capybara.app_host = "http://#{SELENIUM_APP_HOST}:#{page.driver.rack_server.port}"
    end
  end

  config.after(:each) do
    Capybara.reset_sessions!
    Capybara.use_default_driver
    Capybara.app_host = nil
  end

  # Determines if a selenium_remote_* driver is being used
  def selenium_remote?
    !(Capybara.current_driver.to_s =~ /\Aselenium_remote/).nil?
  end
end

# CapybaraDriverRegistrar is a helper class that enables you to easily register
# Capybara drivers
class CapybaraDriverRegistrar

  # register a Selenium driver for the given browser to run on the localhost
  def self.register_selenium_local_driver(browser)
    Capybara.register_driver "selenium_#{browser}".to_sym do |app|
      Capybara::Selenium::Driver.new(app, browser: browser)
    end
  end

  # register a Selenium driver for the given browser to run with a Selenium
  # Server on another host
  def self.register_selenium_remote_driver(browser)
    Capybara.register_driver "selenium_remote_#{browser}".to_sym do |app|
      Capybara::Selenium::Driver.new(app, browser: :remote, url: "http://#{SELENIUM_SERVER}:4444/wd/hub", desired_capabilities: browser)
    end
  end
end

# Register various Selenium drivers
CapybaraDriverRegistrar.register_selenium_remote_driver(:firefox) 
```

现在，任何带有 :js => true 元数据的 RSpec 示例都将使用此驱动程序。

# entity-framework - EntityFramework.Extended Update - 尝试将一列设置为另一列

> ID：13595535
> 
> 赞同：0
> 
> 时间：2012-11-28T00:08:09.983
> 
> 标签：entity-framework

我正在使用[EntityFramework.Extended](http://www.loresoft.com/projects/entity-framework-batch-update-and-future-queries/default.aspx)库来尝试批量更新表。如果我分配的值是一个常量，它会很好用，但是当我尝试将一列分配给另一列时，它会引发异常。例如（这只是为了传达这个想法）

```
// This works fine    
Update<Client>( c => c.Active, c => new Client() { DatabaseId = 100 } );

// This throws an exception
Update<Client>( c => c.Active, c => new Client() { DatabaseId = c.ClientId } ); 
```

被抛出的异常是

*System.InvalidOperationException，从范围“”引用的“客户端”类型的变量“c”，但未定义*

有没有人成功做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T15:52:15.650

尝试这个

```
Update<Client>( c => c.Active, nc => new Client() { DatabaseId = c.ClientId } ); 
```

# c# - 有没有办法在 C# 中重构这个事件处理代码

> ID：13595540
> 
> 赞同：1
> 
> 时间：2012-11-28T00:08:23.057
> 
> 标签：c#, refactoring

我正在尝试重构一些看起来像这样的代码（还有其他几种情况）。

```
switch (input) {
    case "1":
         _service.getWCFStuff1Completed += new EventHandler<getWCFStuff1CompletedEventArgs>(method1);
         _service.getWCFStuff1Async(strSomething);
    case "2":
         _service.getWCFStuff2Completed += new EventHandler<getWCFStuff2CompletedEventArgs>(method2);
         _service.getWCFStuff2Async(strSomething);
    [etc...]
} 
```

我想将代码更改为这样的代码，但我看不到任何将模板化类型（即 EventArgs 事件处理程序）放入 Action 的方法。

```
var Map = new Dictionary<string, Action<???, string>> {
    { "1", method1},
    { "2", method2}
}; 
```

有没有办法做到这一点，或者我可以使用字典并能够编写类似代码的另一种方法：

```
Map[input](something-with-eventargs, strSomething); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:20:13.930

我没有找到让编译器推断`EventHandler`参数类型的方法，但这是我的想法：

假设我们有一个服务（只是为了测试）：

```
public class Service
{
    public event EventHandler<MouseEventArgs> fooEvent1 = delegate { };
    public event EventHandler<KeyEventArgs> fooEvent2 = delegate { };

    public void Fire()
    {
        fooEvent1(null, null);
        fooEvent2(null, null);
    }
} 
```

考虑这个通用类：

```
class Map<T> where T : EventArgs
{
    Dictionary<string, EventHandler<T>> map;

    public Map()
    {
        map = new Dictionary<string, EventHandler<T>>();
    }

    public EventHandler<T> this[string key]
    {
        get
        {
            return map[key];
        }
        set
        {
            map[key] = value;
        }
    }
} 
```

它将 a 映射`string`到 a `EventHandler<T>`。显然，我们将针对不同的`T`. 为了管理它们，让我们使用以下静态类：

```
static class Map
{
    static Dictionary<Type, object> maps = new Dictionary<Type, object>();
    public static Map<U> Get<U>() where U : EventArgs
    {
        Type t = typeof(U);
        if (!maps.ContainsKey(t))
            maps[t] = new Map<U>();
        Map<U> map = (Map<U>)maps[t];
        return map;
    }
} 
```

现在我们可以按如下方式使用它：

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();

        Map.Get<MouseEventArgs>()["1"] = Form1_fooEvent1;
        Map.Get<KeyEventArgs>()["2"] = Form1_fooEvent2;

        Service s = new Service();
        s.fooEvent1 += Map.Get<MouseEventArgs>()["1"];
        s.fooEvent2 += Map.Get<KeyEventArgs>()["2"];
        s.Fire();
    }

    void Form1_fooEvent2(object sender, KeyEventArgs e)
    {
        textBox2.Text = "Form1_fooEvent2";
    }

    void Form1_fooEvent1(object sender, MouseEventArgs e)
    {
        textBox1.Text = "Form1_fooEvent1";
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:13:34.283

你的 Action 甚至需要输入吗？你不能做这样的事情吗？

```
var map = new Dictionary<string, Action>();
map["1"] = () =>
{
    _service.getWCFStuff1Completed += 
        new EventHandler<getWCFStuff1CompletedEventArgs>(method1);
    _service.getWCFStuff1Async(strSomething);
};
map["2"] = () =>
{
    _service.getWCFStuff2Completed += 
        new EventHandler<getWCFStuff2CompletedEventArgs>(method2);
    _service.getWCFStuff2Async(strSomething);
}; 
```

# java - 从 Java 中的 Amazon 访问密钥获取用户名

> ID：13595541
> 
> 赞同：2
> 
> 时间：2012-11-28T00:08:23.567
> 
> 标签：java, amazon-iam, access-keys

有没有办法将**用户名**附加到您用于通过 Java 访问 AWS 的凭证的**访问密钥上？**我希望能够获取在**IAM 用户**部分中定义的用户名，以便我可以设置特定于用户的存储桶/文件夹，然后根据访问密钥的用户名动态地将脚本指向它们（这样我就可以更改未来访问密钥，如有必要，无需更改存储桶/文件夹名称）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T21:39:07.817

再一次我在回答我自己的问题......一旦我问别人怎么做，我似乎总是更擅长自己回答......

无论如何，您会发现下面的代码将允许您提取当前使用的访问凭据的用户名：

```
import com.amazonaws.auth.AWSCredentials;
import com.amazonaws.auth.PropertiesCredentials;
import com.amazonaws.services.identitymanagement.AmazonIdentityManagementClient;

public class test {

    private static AmazonIdentityManagementClient iamServ;

    private static void init() throws Exception {
        AWSCredentials credentials = new PropertiesCredentials(test.class.getResourceAsStream("AwsCredentials.properties"));        
        iamServ = new AmazonIdentityManagementClient(credentials);
    }

    public static void main(String[] args) throws Exception {
        init();
        String theUser = iamServ.getUser().toString().substring(27); 
        int userNameEnd = theUser.indexOf(",");
        String userName = theUser.substring(0, userNameEnd);
        System.out.println(userName);
    }
} 
```

执行很粗糙，但它有效；或者至少在我尝试过的情况下。如果您只使用`System.out.println(iamServ.getUser());`，则用户名将显示如下：

`{User: {Path: /, UserName: UserName, UserId: xxxxxxxxxxxxxxxxxxxxxx, Arn: arn:aws:iam::xxxxxxxxxxx:user/UserName, CreateDate: Day Mon DayNum hr:min:sec Tmz Year, }, }`

否则，显示的代码将返回**UserName**而不是字符串中所有额外的“垃圾”。无论如何，我希望这对可能正在寻找获取当前访问 ID 用户名的解决方案的其他人有所帮助。如果有人知道另一种更好的方法，请在评论中告诉我们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-14T07:30:01.437

我现在找到了一种从 Java 中的 AWS 访问凭证中获取用户名的更好方法。前面提到的答案是一个简单的解决方法，因为当时没有提供其他解决方案。这种新方法实际上是[适用于 Java 的 AWS 开发工具包的](http://aws.amazon.com/sdk-for-java/)一部分（在最初发布时可能还没有）。

无论如何，要获取用户名，只需使用以下行： `iamServ.getUser().getUser().getUserName();`

这将返回一个可以存储到变量的字符串。我不完全确定他们为什么设置它，所以你必须打电话`.getUser()`两次，但他们做到了。您可以在第二种方法之后使用的其他方法`.getUser()`包括：`.getUserID()`、`.getArn()`、`.getPath()`和`.getCreateDate()`。

注意：我将保留旧答案，因为它仍然有效，但现在这是更好的解决方案。

# java - 有没有办法找出我的 ImageView 是否在 Android 中显示某个资源？

> ID：13595543
> 
> 赞同：-1
> 
> 时间：2012-11-28T00:08:31.103
> 
> 标签：java, android, android-imageview, android-image

我的 XML 布局代码中有一个设置为 cam.jpg 的 ImageView：

```
 <ImageView
            android:id="@+id/imvCover"
            android:layout_width="130dp"
            android:layout_height="180dp"
            android:layout_marginLeft="10dp"
            android:layout_marginTop="15dp"
            android:layout_marginRight="15dp"
            android:scaleType="fitCenter"
            android:src="@drawable/cam"
             /> 
```

有没有办法在我的 Java 代码中找出我`imvCover`当前是否正在显示`@drawable/cam`或其他内容？像这样的东西：

```
if (imvCover.displayedImageResource == R.id.cam)
   // do something
else
   // do something else 
```

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T00:13:34.783

尝试使用`setTag()`和`getTag()`这样的方法：

将可绘制资源设置为您的操作时`imageView`，如下所示：

```
img.setBackgroundResource(R.id.img1);
img.setTag(R.id.img1); 
```

并找出哪个drawable设置为您的`imageview`，只需获取标签并对其进行测试：

```
if(((int)img.getTag() ) == R.id.img1) {
   //do stuff1 here 
}
if(((int)img.getTag() ) == R.id.img2) {
   //do stuff2 here 
} 
```

# php - 如何在 Wordpress 上为主页自定义 the_content()？

> ID：13595544
> 
> 赞同：0
> 
> 时间：2012-11-28T00:08:40.103
> 
> 标签：php, wordpress, function, customization

我正在尝试自定义 wordpress 主页，确切地说，the_content() 函数。我尝试使用的网站是[http://sportsponsorizzazioni.com/](http://sportsponsorizzazioni.com/)

如果在关于“循环”的文件中我使用函数“ **the_content()** ”，它会为我提供主页上完整文章的列表，*其中*包含我在帖子正文中包含的图像和我想要的文本格式。以另一种方式使用函数“the_excerpt()”，只显示摘录文本，如 5 行，*没有*任何图像。

我只想在我的主页上显示文章的第一部分，后面有“阅读更多”按钮和图像，但是我对 the_content('') 进行了子字符串操作，它只给了我前 X 个字符但没有图像......即使在我的帖子中标签位于帖子的开头。

我需要一些自动的东西，不能在每个帖子上添加“缩略图”或“特色图像”，有没有办法修改“the_content（''）”让我只拿前 30 个单词为例我的帖子有图片吗？或者（更好）有没有办法将我文章中编码的图像包含在“the_excerpt()”中？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:38:54.073

这个[插件](http://wordpress.org/extend/plugins/get-the-image/)正是你想要做的。有关从帖子内容中提取图像的信息，请参阅常见问题部分中的第[4 项。](http://wordpress.org/extend/plugins/get-the-image/faq/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T02:45:45.267

如果您不想使用插件解决方案，1\. 在帖子中添加自定义字段，例如帖子图像的名称和图像 url 的值（尝试对所有帖子使用自定义字段）。2\. 在您的 home.php 中包含类似于以下的代码

```
<?php if(have_post()):

  while(have_post()):
   the_post(); ?>

   <div id="<?php the_ID();?>" <?php post_class();?>>
      <!--output the excerpt-->
            <?php the_excerpt(); ?>
        <!--access the image source as below-->
         <?php $img_src=get_post_meta($post->ID,'post-image',$single=true); ?>

          <!--check if $img_src is not empty, in case there will be 
          a post without post-image custom field.
          -->
          <?php if($img_src !==''): ?>
          <img src="<?php $img_src;?>" alt="<?php the_title();?>"      class="home_image" />
                        <?php endif;?>
                          <!--whenever there is a post with no image, you may like 
                             to add else logic here and do something-->
     </div>

   <?php endwhile; else: ?>

   <!--some error message-->

   <?php endif; ?> 
```

# android - android错误解析包

> ID：13595545
> 
> 赞同：2
> 
> 时间：2012-11-28T00:08:49.797
> 
> 标签：android, parsing, package

我有以下问题：我的应用程序下载了最新版本的APK并将APK文件保存在/data/data/包名/升级。直到这里一切正常。然后应用程序执行以下代码开始安装：

```
String file = "/data/data/" + context.getApplicationContext().getPackageName() + "/upgrade/myapp.apk";

Intent intent = new Intent(Intent.ACTION_VIEW);

intent.setDataAndType(Uri.fromFile(f),"application/vnd.android.package-archive");

startActivity(intent); 
```

收到错误后：“解析包错误”。并且安装没有开始。如果我从浏览器下载相同的文件工作正常。

# sql-server - 从 weblogic 12c 连接到 sql server

> ID：13595549
> 
> 赞同：3
> 
> 时间：2012-11-28T00:09:24.800
> 
> 标签：sql-server, jdbc, weblogic, datasource, weblogic12c

我开发了一个公开 web 服务的应用程序，该应用程序部署在 weblogic 12c 中，我从 java web 客户端调用 web 服务，当我运行 java 客户端时抛出这个异常：

```
Exception in thread "main" javax.xml.ws.soap.SOAPFaultException: EJB Exception: ; nested exception is: 
    javax.persistence.PersistenceException: Exception [EclipseLink-7060] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.ValidationException
Exception Description: Cannot acquire data source [sqlServer].
Internal Exception: javax.naming.NameNotFoundException: Unable to resolve 'sqlServer'. Resolved ''; remaining name 'sqlServer'
    at com.sun.xml.internal.ws.fault.SOAP11Fault.getProtocolException(SOAP11Fault.java:178)
    at com.sun.xml.internal.ws.fault.SOAPFaultBuilder.createException(SOAPFaultBuilder.java:111)
    at com.sun.xml.internal.ws.client.sei.SyncMethodHandler.invoke(SyncMethodHandler.java:108)
    at com.sun.xml.internal.ws.client.sei.SyncMethodHandler.invoke(SyncMethodHandler.java:78)
    at com.sun.xml.internal.ws.client.sei.SEIStub.invoke(SEIStub.java:107)
    at $Proxy34.loginService(Unknown Source)
    at main.Main.loginService(Main.java:32)
    at main.Main.main(Main.java:22) 
```

我在 Weblogic 12c 的管理控制台中配置了一个 jdbc 资源，JNDI 被命名为 sqlServer... 在应用程序中也有一个持久性单元 xml 文件，如下所示：

```
<persistence-unit name="BancaSimulacionIBancariaPU" transaction-type="JTA">
    <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
    <jta-data-source>sqlServer</jta-data-source>
    <class>entities.Account</class>
    <class>entities.Bank</class>
    <class>entities.BeneficiaryBankItself</class>
    <class>entities.BeneficiaryThird</class>
    <class>entities.CreditCard</class>
    <class>entities.Movement</class>
    <class>entities.RuleType</class>
    <class>entities.ServiceBank</class>
    <class>entities.TransactionRule</class>
    <class>entities.UserApplication</class>
    <class>entities.Money</class>
    <properties>
      <property name="javax.persistence.jdbc.url" value="jdbc:sqlserver://servertb:1433;databaseName=BancaSimulacion"/>
      <property name="javax.persistence.jdbc.password" value="(*******)"/>
      <property name="javax.persistence.jdbc.driver" value="com.microsoft.sqlserver.jdbc.SQLServerDriver"/>
      <property name="javax.persistence.jdbc.user" value="sa"/>
    </properties> 
```

我将驱动程序`sqljdbc4.jar`放在`wl_server/lib`文件夹中并配置`commEnv.cmd`...我将for替换`64sqljdbc.dll`为`sqljdbc.dll`同一文件夹`wl_server/lib`中...

但我不知道哪些设置适合与我的数据库连接......我测试了我的数据库并且是正确的......有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-19T19:53:53.703

确保您的数据源有一个目标集 - 否则 WebLogic 不会知道它，它会抛出令人讨厌的 JNDI (NameNotFoundException) 错误。

基本上，您的数据源连接必须 100% 正确且功能正常，WebLogic 才能接受和使用它——这包括确保它具有有效的目标集。

# sql - 另一种处理动态排序的方法

> ID：13595551
> 
> 赞同：0
> 
> 时间：2012-11-28T00:09:27.140
> 
> 标签：sql, sql-server, sql-server-2008

鉴于：

您可以通过指示列的索引对结果集进行排序。

```
SELECT * FROM CUSTOMERS ORDERY BY 1 
```

我正在尝试在以下上下文中使用，但是，我收到错误消息：

> 消息 5308，级别 16，状态 1，第 8 行窗口函数不支持整数索引作为 ORDER BY 子句表达式。

```
EXEC ("
SELECT  *, 
        ROW_NUMBER() OVER ( ORDER BY 1 ) AS 'Seq'   
from dynamic_table"); 
```

你能想出一个变通办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:24:01.160

如果您知道列名，这应该可以：

```
Exec ("
select *, 
ROW_NUMBER() OVER ( ORDER BY " + columnName + " ) AS 'Seq'   
from dynamic_table"); 
```

如果列名未知：

```
DECLARE @table_name nvarchar(100) = 'test'
DECLARE @column_name nvarchar(100) 
SELECT 
    @column_name = columns.name
FROM sys.columns
inner join sys.tables ON tables.object_id = columns.object_id
WHERE tables.name = @table_name and column_id = 1

EXEC ('
select *, 
ROW_NUMBER() OVER ( ORDER BY ' + @column_name + ' ) AS ''Seq''   
from ' + @table_name); 
```

# java - 如何在 .jar 文件中包含音乐文件？

> ID：13595552
> 
> 赞同：1
> 
> 时间：2012-11-28T00:09:27.113
> 
> 标签：java, embedded-resource, javasound

我的netbeans有问题。我制作了一个只播放背景音乐的程序。当我从 netbeans IDE 运行程序时，它与音乐一起运行，没有任何错误。但是当我尝试运行 .jar 文件时，程序在没有音乐的情况下正常运行。我已经检查了数百次路径，但它不起作用。没有错误，没有任何问题，音乐不是从 .jar 文件中播放的。为什么这样？

```
public static synchronized void playSound(final String url) { 
  new Thread(new Runnable() { 
    public void run() { 
     try { 
        Clip clip = AudioSystem.getClip(); 
        AudioInputStream inputStream; 
        inputStream = AudioSystem.getAudioInputStream(
            this.getClass().getResource(url)); 
        clip.open(inputStream);
        clip.start(); 
     } catch (Exception e) { 
        System.err.println(e.getMessage()); 
     } 
    } 
   }).start(); } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T00:13:10.960

您应该使用[getResourceAsStream(String)](http://docs.oracle.com/javase/7/docs/api/java/lang/ClassLoader.html#getResourceAsStream%28java.lang.String%29)来访问这样的文件，您需要确保它们存在于类路径中。

没有任何代码可看，我猜您正在尝试使用 FileInputStream 或类似的，这是行不通的，因为 jar 文件没有传统文件系统的概念。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T00:38:08.613

如果您想运行 .jar ...并且希望在运行 .jar 时播放音乐...那么您真的应该将音乐文件*放入 JAR*中。正如 Paul Sanwald 已经告诉您的，[“getResourceAsStream()”](http://docs.oracle.com/javase/7/docs/api/java/lang/ClassLoader.html#getResourceAsStream%28java.lang.String%29) 是您要使用的 API。

它也适用于您的 IDE。

我碰巧更喜欢 Eclipse IDE，在 Eclipse 中，您可以将文件复制到项目中的“src”文件夹中（在这种情况下，当您导出 .jar 文件时，它会自动放在正确的位置）

此链接说明如何在 NetBeans 中执行此操作：

*   [http://wiki.netbeans.org/FaqSpecialJar](http://wiki.netbeans.org/FaqSpecialJar)

# mobile - 在 Jolla 的 Sailfish OS 上开发移动应用程序的技术堆栈是什么样的？

> ID：13595559
> 
> 赞同：8
> 
> 时间：2012-11-28T00:10:05.597
> 
> 标签：mobile, cordova, meego, mer, sailfish-os

对于 Jolla 宣布的新 Sailfish OS，移动应用程序（本机和 HTML5）的技术堆栈是什么样的？Sailfish OS 技术堆栈的一个中心位置几乎没有可用的信息，但 Sailfish OS 使用的开源产品的项目网站提供了以下信息：

*   基础操作系统：Sailfish OS 使用 Meego fork [Mer](http://merproject.org/)作为主要操作系统。Mer 以超便携的 Linux + HTML5/QML/JS Core 为中心。对于 Sailfish OS，Mer 项目作为核心 OS，提供了一个可以启动到屏幕的功能核心 Linux 堆栈，但没有任何 UI，也没有任何硬件适配
*   用户界面：Sailfish OS 使用了以前的 Meego UI - MeeGo Handset UX - 现在称为[Nemo Mobile](https://wiki.merproject.org/wiki/Nemo)的部分内容。
*   Sailfish SDK：Sailfish SDK 基于[QtCreator](http://qt.digia.com/Product/Developer-Tools/)，将在 Windows、Linux 和 OS X 中提供。SDK[二进制文件](https://sailfishos.org/wiki/Main_Page#SDK_Binaries)预计在 2012 年底或 2013 年初提供。SDK 由 Mer Core 的工具、Qt Creator、Jolla UI 组件组成, Sailfish UI 框架和 Salfish 手机应用界面。
*   HTML5 应用程序：Sailfish 开发团队正在研究使用[Apache Cordova](http://incubator.apache.org/cordova/)（以前称为 PhoneGap）[为 Qt](http://qt-project.org/wiki/PhoneGap-for-Qt-5)开发基于 HTML5 的移动应用程序。
*   Sailfish 上的 Android 应用程序：许多 Android 应用程序将在 Sailfish OS/Jolla 设备上运行，但不会发生变化。要利用 Sailfish OS 的所有 UI 和其他功能并使应用程序快速运行，可能必须将应用程序移植到本机 QT/QML。

基于以上信息，为 Sailfish OS 构建移动应用程序似乎将有三种方法：

*   本机应用程序使用 Mer 的核心 API、Jolla UI 组件、Sailfish UI 框架和手机应用程序界面。
*   重新使用现有的 Android 应用程序（尽管没有关于此类应用程序将支持哪些功能的详细信息）。
*   HTML5/JavaScript 基于使用 Apache Cordova API。

这意味着可以使用以下编程和标记语言：

*   C++ 和 QT
*   标记语言：[QML](http://qt-project.org/search/tag/qml)（本机应用程序）和 HTML（Cordova）
*   JavaScript、CSS（适用于基于 Cordova 的应用程序和 QT/QML）

有什么遗漏，还是我误解了某些信息？到目前为止，我还没有参与任何 QT/QML 开发，如果有更多经验的人可以为我提供一些意见，那将会很有帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T12:23:52.853

(1) 我认为您已经承诺：重新使用现有的 MeeGo 和 Tizen（尤其是来自诺基亚 N9 的 MeeGo Harmattan）应用程序（尽管它们将在使用 MeeGo 标准正确编写时运行，并且直到不会做与 Sailfish OS UI 或与Mer 使用的 MeeGo API 标准）。

MeeGo 和 Android 应用程序可能需要稍作调整才能获得 Sailfish UI 需求和全速。当它们用 Qt 编写时，会相对容易一些。

我将 Tizen 视为 MeeGo 分支，具有与遵循 MeeGo 标准一样多的向后兼容性，因此，对于上述“但是”，我在上述方面将 MeeGo 和 Tizen 应用程序一起对待。

(2) 您还忽略了 Sailfish OS 作为完整的 Linux 可以运行带有 Sailfish 使用的 RPM 包的 Linux 软件。它与 MeeGo Harmattan 一起工作（但仅使用 DEB），因此这是 Sailfish OS 使用的一个可能选项，例如。LibreOffice 或 OppenOffice，与 MeeGo Harmattan 一样，OpenOffice 正在运行，并且在功能上受到诺基亚 N9 设备的限制，但可以编写和编辑文本。这可以访问大型软件库，但设备尺寸在实践中会限制它。

这也是 Sailfish 设备中开发模式可用性的问题，现在无法验证。

(3) 正如在 slush 演示中所说的，SDK 将与 Mer 工具一起使用，但开放且有弹性，这意味着组织/组/用户将能够通过例如更改它。添加他们所需的特定工具，从而能够创建与特定开发人员的上下文或特定需求相关的环境，例如公司工具等。这将使开发/编码更容易、更快、更便宜。我认为这对开发人员和编码人员来说很重要。

# php - 从函数返回一个关联数组是未定义的

> ID：13595560
> 
> 赞同：0
> 
> 时间：2012-11-28T00:10:12.523
> 
> 标签：php, javascript, jquery, json

我有一个从 JSON 获取信息然后将其插入数组的函数。然后我让函数返回数组。

我希望代码像这样工作：

```
user = getUserInfo();
console.log(user["fname"]);

function getUserInfo(){
    userArray = new Array();
    var url =  "./php/getUserInfo.php";

    $.getJSON(url, function( data ) {
        userArray["fname"] = data[0].first_name;
        userArray["lname"] = data[0].last_name;
        userArray["username"] = data[0].username;

        console.log(userArray["fname"]);
    });

    return userArray;
} 
```

当我在函数中记录 userArray["fname"] 的值时，它工作得很好。

当我在调用函数后记录 userArray["fname"] 的值时，我得到“未定义”

为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:13:01.953

`getJSON`您正在回调之外返回数组。因为调用是异步的，你将无法“返回”传统意义上的数据，但你可以调用另一个方法，并在创建后将数组传递给它。

```
var user; // initialize global
getUserInfo();

function getUserInfo(){
    userArray = new Array();
    var url =  "./php/getUserInfo.php";

    $.getJSON(url, function( data ) {
        // set fields
        setUserInfo(userArray);
    });
}

function setUserInfo(userArray){
    user = userArray;
} 
```

一系列跟注后，`user`将投注设置到`userArray`数组中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:12:55.490

您的函数在设置其值之前返回 Array。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T00:15:16.847

您遇到的问题是 AJAX 调用是`getJSON()`异步发生的（AJAX 中的第一个 A）。

因此，`return userArray`当您仍在等待服务器对 AJAX 调用的响应时，就会发生这种情况。

您将需要在 .h 的回调函数中处理您想要对用户信息执行的任何操作（即更新页面上的某些元素、更新 javascript 全局范围内的变量等）`getJSON`。

# python - matplotlib qt imshow 动画

> ID：13595566
> 
> 赞同：4
> 
> 时间：2012-11-28T00:11:00.107
> 
> 标签：python, qt, matplotlib, animated

imshow 动画是否适用于 qt 后端？以下在非 qt 中工作正常，但不使用 qt 制作动画 - 仅显示最后一帧：

```
img = standard_normal((40,40))
image =imshow(img,interpolation='nearest',animated=True)
for k in range(1,10): 
     img = standard_normal((40,40)) 
     image.set_data(img) 
     draw() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T14:30:01.640

您要么需要`pause`在抽奖后在循环中添加 a ，要么使用`matplotlib.animation`模块[(doc)](http://matplotlib.org/api/animation_api.html) [(tutorial)](http://jakevdp.github.com/blog/2012/08/18/matplotlib-animation-tutorial/)。

可能相关[的 matplotlib.pyplot/pylab 在 isinteractive() 时未更新图形，使用 ipython -pylab](https://stackoverflow.com/questions/2604119/matplotlib-pyplot-pylab-not-updating-figure-while-isinteractive-using-ipython)：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T19:05:00.413

我会看一下，但它看起来像使用 qt 后端调用：

```
QApplication.ProcessEvents() 
```

更新 imshow 图。

# java - 简单的循环数组

> ID：13595572
> 
> 赞同：1
> 
> 时间：2012-11-28T00:11:44.503
> 
> 标签：java, arrays

以下是我的家庭作业解决方案的一部分，我不知道为什么他有两个 for 循环。如果是我，我会设置 if (carsParked[i] == c) 然后设置 carsParked[i]=null 我不明白为什么第二个 for 循环语句谁能解释？
顺便说一句，CarsParked 数组是一种 Car 类，它存储停放的汽车对象。

```
public void driveOut(Car c)
{
    for (int i=0; i<carsParked.length; i++) // Loop through the carParked array
    {
        if(carsParked[i] == c) // Find Car c at index i
        {
            //carsParked, remove(c);
            for (int j=i; j<carsIn-1; j++)
            {
                carsParked[j] = carsParked[j+1];
            }
            carsParked[carsIn-1] = null; 
            carsIn = carsIn - 1;
        }
    }
} 
```

汽车是这样停放的

```
public void driveIn(Car c)
{
    if(carsIn < carsParked.length)
    {
        carsParked[carsIn] = c;
        carsIn = carsIn + 1;
    }
    else // error message
    {
         System.out.println("Park " + location + " is full, for " + c);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T00:13:02.887

看起来您正在查看的解决方案旨在将所有非空值移到左侧，而不是将空值留在数组中间，这就是您的建议。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T00:27:34.300

假设您有一个包含 5 辆汽车的数组：`[Car1, Car2, Car3, Car4, Car5]`，然后调用方法`driveOut(Car3)`。

通过在找到它时将值设置为 null，您最终会得到`[Car1, Car2, null, Car4, Car5]`. 这种做法会导致`NullPointerException`类型错误，因为`null`值在数组的中间，并且数据没有被压缩。

解决方案基本上是通过从该点开始并将剩余的汽车向左移动来消除差距：

```
Inner loop rev 1: [Car1, Car2, Car4, Car4, Car5]
Inner loop rev 2: [Car1, Car2, Car4, Car5, Car5] 
```

然后在循环之外，最后一个条目设置为空，留下你`[Car1, Car2, Car4, Car5, null]`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T00:15:12.450

您正在做的事情称为嵌套循环。例如

```
for(num2 = 0; num2 <= 3;  num2++)
{
    for(num1 = 0; num1 <= 2; num1++)
    {
        System.out.println(num2 + "   " + num1);
    }
} 
```

# php - 数据库驱动程序 MySQLi 错误

> ID：13595579
> 
> 赞同：5
> 
> 时间：2012-11-28T00:12:19.140
> 
> 标签：php, mysql, database, mysqli

我在具有 PHP 5.2.10 和 MySQL 5.1.36-Community 的 Window Vista 上运行 Moodle 测试环境。当我从 Moodle 1.9.9 升级到 2.0 时，我收到以下错误。

```
Error: database driver problem detected

The site administrator should verify server configuration

PHP has not been properly configured with the MySQLi extension so that it can communicate with MySQL. Please check your php.ini file or recompile PHP. MySQLi extension is not available for PHP 4. 
```

我还尝试更改 config.ini 中的 dbtype='mysqli' 并且仍然看到相同的错误。

如果您能提供一些解决此错误的建议，我将不胜感激。

先感谢您。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T00:16:59.833

前段时间我也遇到了这个错误，我花了很长时间才找到解决这个问题的方法。基本上你需要做的就是为你的 php 环境添加一个扩展。以下解决方案适用于运行 Apache 和 MySQL 的 Microsoft Windows Server 2003：

*   找出您的 php 文件夹在运行 moodle 的服务器上的位置。它通常位于 c:\php。

*   打开 php.ini。在该文件中，您将找到 ;extension=php_mysqli.dll。删除分号。

*   保存文件。

*   重新启动 Apache 并转到您的 Moodle 网站。

我们开始吧，从现在开始你会没事的；）希望这有帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-06-05T08:48:07.350

对于我的情况：确保模块 a) 已安装 b) 在 php.ini 中启用

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-05-29T04:45:07.440

对于那些寻找 LINUX 答案的人

取消注释

;扩展名=mysqli.so

在位于 php 文件夹中的文件“php.ini”中的“动态扩展”部分（在我的情况下为“/etc/php/php.ini”）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-10-28T09:22:30.833

您需要安装以下软件包`php-mysql`，然后重新启动 Apache Web 服务器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-19T07:03:48.203

您需要安装以下软件包 php-mysql 然后重新启动 Apache Web 服务器。这解决了我的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-05-09T13:47:19.950

我也有同样的问题。通过删除 ';' 在 php.ini 中启用 mysqli 扩展后 从以下行：

```
;extension=mysqli 
```

到现在什么都没有改变。然后我在网上看到一个帖子说你必须安装 php-mysqlnd 包。使用以下命令安装后，问题解决：

```
sudo apt install php-mysqlnd 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-05-26T10:24:22.380

我正在使用 Xammp 并运行多个 PHP 版本，我发现我需要更新我的`php.ini`文件以指向正确的扩展目录。

找到关键行：

```
; extension_dir = "./"
; On windows:
extension_dir = "C:\xampp\php-5460\ext" ;<--- make sure this is correct 
```

# c# - 绘制多个矩形 c#

> ID：13595585
> 
> 赞同：2
> 
> 时间：2012-11-28T00:12:56.557
> 
> 标签：c#

在 c# 中绘制 25 个矩形（5 * 5）的最佳方法是什么？稍后我需要能够到达特定的矩形并更改其颜色，例如，如果用户输入了错误的单词，则将颜色更改为红色。在这种情况下创建一个矩形数组会更合适吗？

这就是我到目前为止所拥有的

```
Graphics g = pictureBox1.CreateGraphics();

int x =0;
int y= 0;
int width = 20;
int height = 20;
for (int i = 0; i < 25; i++)
{
    if (i <= 4)
    {
        g.FillRectangle(Brushes.Blue, x, y, width, height);
        x += 50;
    }
    else if (i > 4)
    {
        y = 50;
        g.FillRectangle(Brushes.Blue, x, y, width, height);
        x += 50;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:55:59.947

这应该让你开始，而不是完整的代码。您将需要添加一个 PictureBox 控件并使用默认名称 (picurebox1)。编辑：也需要添加一个按钮:)

```
public partial class Form1 : Form
{
    public List<Rectangle> listRec = new List<Rectangle>();
    Graphics g;

    public Form1()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, EventArgs e)
    {
        Rectangle rect = new Rectangle();
        rect.Size = new Size(100,20);
        for (int x = 0; x < 5; x++)
        {
            rect.X = x * rect.Width;
            for (int y = 0; y < 5; y++)
            {
                rect.Y = y * rect.Height;
                listRec.Add(rect);
            }
        }

        foreach (Rectangle rec in listRec)
        {
            g = pictureBox1.CreateGraphics();
            Pen p = new Pen(Color.Blue);
            g.DrawRectangle(p, rec);
        }
    }

    public void ChangeColor(Rectangle target, Color targetColor)
    {
        Pen p = new Pen(targetColor);
        g.DrawRectangle(p, target.X, target.Y, target.Width, target.Height);
    }

    private void Form1_KeyDown(object sender, KeyEventArgs e)
    {
        switch (e.KeyCode)
        {
            case Keys.D0: ChangeColor(listRec[0], Color.Red);
                break;
            case Keys.D1: ChangeColor(listRec[1], Color.Red);
                break;
            //..more code to handle all keys..
        }
    }    
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:54:44.343

如果您不关心性能或外观，那么最简单的方法是在您的 Form_Load 事件中创建一个面板列表列表作为评论提到的其中之一。

```
List<List<Panel>> panelGrid = new List<List<Panel>>();
for (var i = 0; i < 5; i++)
{  
    var panelRow = new List<Panel>();
    for (var j = 0; j < 5; j++)
    {
        panelRow.Add(new Panel());

        // add positioning logic here
    }

    panelGrid.Add(panelRow);
} 
```

然后，您将能够在稍后阶段引用每个单独的...

如果您必须使用 Graphics 类（这是更好的方法），那么您应该设置类似的东西，但是用您自己的类替换 Panel。然后在 Form_Paint 事件中，您将遍历对象列表并渲染它们。

```
class MyPanel
{
    public Size size;
    public Color color;
}

...

foreach (var myPanelRow in myPanelGrid)
    foreach (var myPanel in myPanelRow)
        g.FillRectangle(myPanel.color, myPanel.size); // this obviously won't work as is, but you get the idea 
```

然后，当您需要更改颜色时，您可以执行以下操作：

```
myPanelsGrid[0][0].color = Color.Blue;
myForm.Invalidate(); 
```

第二行将导致 Paint in 事件再次被调用。

# ruby-on-rails - to_json，这可能吗？

> ID：13595586
> 
> 赞同：0
> 
> 时间：2012-11-28T00:12:57.363
> 
> 标签：ruby-on-rails, ruby, json, activerecord

我有这样的模型：

```
class User < ActiveRecord::Base
    has_many :cookies
    has_many :fortunes, :through => :cookies

    def new_cookies
        cookies.all :include => :fortune, :conditions => {:opened => false}
    end
end

class Cookie < ActiveRecord::Base
    belongs_to :user
    belongs_to :fortune

    def self.find_by_shortened_id(shortened_id)
        find(shortened_id.alphadecimal)
    end

    def shortened_id
        self.id.alphadecimal
    end
end

class Fortune < ActiveRecord::Base
    serialize :rstatuses
    serialize :genders 

    has_many :cookies
    has_many :users, :through => :cookies
end 
```

我需要将一个`User`对象转换为 json，但我希望它包含所有`cookies`新的（通过 new_cookies 方法），并嵌入到它的`cookies`a)`shortened_id`和 b)中。`id``fortune`

to_json 可以吗？

到目前为止，我有以下内容，这给了我新的 cookie：

```
user.to_json :methods => :new_cookies 
```

但我一直在试图弄清楚如何在 cookie 对象中包含方法返回的值`shortened_id`和 cookie 的`id`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:28:41.930

`as_json`您可以在您的用户模型中覆盖。

```
class User < ActiveRecord::Base

  def as_json(options={})
    json_res = super
    json_res['cookies'] = ...
  end

end 
```

如果您的应用程序的多个地方需要这些类型的 JSON 自定义，您应该查看用于呈现 JSON的[jbuilder gem 。](https://github.com/rails/jbuilder)

# objective-c - 什么 iOS 3d 引擎用于非常简单的 3d 场景？

> ID：13595602
> 
> 赞同：2
> 
> 时间：2012-11-28T00:14:13.277
> 
> 标签：objective-c, ios, 3d

我正计划开发一个 iOS 应用程序，并希望有一些非常简单的 3d 对象，用户可以通过手势或陀螺仪进行交互。我不需要复杂的动画或游戏逻辑。我开发了简单的应用程序，但从未使用过 3d。哪些框架最适合此类任务，是否需要大量学习和实施？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T00:55:56.420

可可引擎。谷歌 cocos2D 但寻找 3D 信息。干杯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T18:19:22.407

我开始使用 NinevehGL ( [http://nineveh.gl](http://nineveh.gl) )。它是一个非常简单的框架，可以为 iOS 加载和处理 3D 对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T02:13:03.317

在这里，将 OpenGL 与 GLKit 一起使用似乎对您最有利。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T00:54:04.730

我猜[OpenGL](http://developer.apple.com/library/ios/#documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/Introduction/Introduction.html)可以满足你的需要。

# facebook-graph-api - 如何获取 Facebook 好友列表及其电子邮件、生日和关系状态

> ID：13595606
> 
> 赞同：0
> 
> 时间：2012-11-28T00:14:30.287
> 
> 标签：facebook-graph-api, facebook-javascript-sdk

我正在尝试获取朋友列表以及以下信息{电子邮件、生日、关系状态}

现在我只能用这个片段获取名称和 ID

```
FB.api('/me/friends', function(response) {
     ...
}); 
```

有什么方法可以获取这些信息还是仅限于姓名和身份证？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:29:11.163

```
$friendsIds = array(1,2,3);
$requestInfo = array(
'method' => 'users_getInfo',
'friends' => $friendsIds,
'user_info' => array('last_name', 'first_name', 'uid', 'birthday')
)
$userDetails = $facebook->api->($requestInfo);
print_r($userDetails); 
```

在js结帐中 [如何使用facebook API在javascript中获取朋友列表](https://stackoverflow.com/questions/9491457/how-to-use-facebook-api-getting-friends-list-in-javascript)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:39:56.663

或者，使用当前的 API

```
$facebook->api('me/friends?fields=name,birthday,relationship_status') 
```

这将适用于您可以检索的[用户对象的任何字段](https://developers.facebook.com/docs/reference/api/user/)

根本不可能检索朋友的电子邮件地址，其他字段可能需要您的用户首先授予您特定的[权限](https://developers.facebook.com/docs/authentication/permissions/)，但 API 调用的基本格式是相同的。

上面的例子需要friends_birthday和friends_relationship_status权限

# python - 使用 @property 装饰器时在属性的 setter 方法中使用 super() 会引发 AttributeError

> ID：13595607
> 
> 赞同：16
> 
> 时间：2012-11-28T00:14:38.660
> 
> 标签：python, python-2.7

尝试覆盖子类中的属性时，我对这种行为感到有些困惑。

第一个示例设置了两个类，`Parent`并且`Child`. `Parent`继承自`object`，而`Child`继承自`Parent`。该属性`a`是使用属性装饰器定义的。当`child.a`调用 's setter 方法时，`AttributeError`会引发 an 。

在第二个示例中，通过使用`property()`函数而不是装饰器，一切都按预期工作。

谁能解释为什么行为不同？另外，是的，我知道`__init__`不需要 Child 中的定义。

### 示例 1 - 使用`@property`

```
class Parent(object):
    def __init__(self):
        self._a = 'a'
    @property
    def a(self):
        return self._a
    @a.setter
    def a(self, val):
        self._a = val

class Child(Parent):
    def __init__(self):
        super(Child, self).__init__()
    @property
    def a(self):
        return super(Child, self).a
    @a.setter
    def a(self, val):
        val += 'Child'
        super(Child, self).a = val

p = Parent()
c = Child()
print p.a, c.a
p.a = 'b'
c.a = 'b'
print p.a, c.a 
```

### 示例 1 返回 - 引发属性错误

```
a a
Traceback (most recent call last):
  File "testsuper.py", line 26, in <module>
    c.a = 'b'
  File "testsuper.py", line 20, in a
    super(Child, self).a = val
AttributeError: 'super' object has no attribute 'a' 
```

### 示例 2 -`Using property()`

```
class Parent(object):
    def __init__(self):
        self._a = 'a'
    def _get_a(self):
        return self._a
    def _set_a(self, val):
        self._a = val
    a = property(_get_a, _set_a)

class Child(Parent):
    def __init__(self):
        super(Child, self).__init__()
    def _get_a(self):
        return super(Child, self)._get_a()
    def _set_a(self, val):
        val = val+'Child'
        super(Child, self)._set_a(val)
    a = property(_get_a, _set_a)

p = Parent()
c = Child()
print p.a, c.a
p.a = 'b'
c.a = 'b'
print p.a, c.a 
```

### 示例 2 返回 - 正常工作

```
a a
b bChild 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-28T06:46:55.790

`super()`返回一个代理对象，而不是超类，并且它不支持 function `__set__()`。

您可以在此处查看更多详细信息[Python super 和设置父类属性](https://stackoverflow.com/questions/10810369/python-super-and-setting-parent-class-property)以及此处[http://bugs.python.org/issue14965](http://bugs.python.org/issue14965)。

# iphone - 缩放时停止按钮交互

> ID：13595608
> 
> 赞同：0
> 
> 时间：2012-11-28T00:14:43.307
> 
> 标签：iphone, objective-c

我的屏幕几乎充满了按钮，这会干扰缩放。没有iOS模拟器我还没有测试过，所以我不知道问题是否和模拟器一样大。

当您想要缩放时，有没有办法停止停止按钮交互？

# build - 具有项目编译依赖项的 Gradle 嵌套多项目

> ID：13595610
> 
> 赞同：34
> 
> 时间：2012-11-28T00:14:47.763
> 
> 标签：build, dependencies, gradle, multi-project

我对此[Gradle Multi-Module Project Setup](https://stackoverflow.com/questions/9013597/gradle-multi-module-project-setup)有相同的问题，但我必须使用项目编译依赖项来构建并且不能使用在上述问题中作为解决方案给出的库（jar）依赖项解决方案。

```
Root
|__ P1
|   |_ PP1
|   |_ PP2
|
|__ P2
   |_PP3
   |_PP4 
```

PP1、PP2、PP3、PP4是子项目，每个都有自己的build.gradle文件；P1 和 P2 也有 build.gradle 和 settings.gradle 文件。

如何在 PP3 的 build.gradle 文件中将 PP1 声明为编译依赖项？

```
apply plugin: 'java' 
dependencies {
    compile('P1:PP1') //does not work
    compile group: 'P1', name: 'PP1', version: '0.1' // jar library dependency not an option

    compile('{ant_target}')? //follow up question - an ant target as a dependency
} 
```

我正在运行 Gradle v1.2

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-11-28T06:11:50.367

一个构建只能有一个`settings.gradle`文件。假设`settings.gradle`在根目录中并包含如下项目：

```
include "P1:PP1" 
```

您可以像这样添加编译依赖项：

```
dependencies {
    compile(project(":P1:PP1"))
} 
```

[有关详细信息，请参阅Gradle 用户指南](http://gradle.org/docs/current/userguide/userguide_single.html#javaMultiProject)中的“多项目构建”一章。

# selector - jQuery 选择器，IE 选择器行为

> ID：13595613
> 
> 赞同：2
> 
> 时间：2012-11-28T00:15:22.527
> 
> 标签：selector, jquery

如果您在 FORM 元素前加上 P 元素，则示例中 DIV 下方的元素将不会被选中！

```
<P><FORM id=f ...
<INPUT ...>
<DIV><INPUT (this element is not selectable)
</DIV>
</FORM> 
```

上面的第二个输入在 IE 中不会`$('#f INPUT').events`发生 在以下位置尝试测试用例：http: [//jsfiddle.net/jorese/Bzc7M/](http://jsfiddle.net/jorese/Bzc7M/)

在 IE 中，您将收到 alert=3，删除 FORM 元素前面的 P 元素，您将获得预期的 alert=5。在 Chrome|FF 中，您会得到 alert=5 的预期。

有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T01:20:39.547

您的 HTML 代码**无效**，它包含一些错误，某些浏览器呈现它的原因是它们通过尝试猜测开发人员最初想要编写的内容来在一定程度上*容忍无效代码。*

该`div`元素可用于将几乎任何元素组合在一起。事实上，它几乎可以包含任何其他元素，**不像`p`它只能包含内联元素**。

改用`div`：http: [//jsfiddle.net/mshMX/](http://jsfiddle.net/mshMX/)

站点参考：[http ://reference.sitepoint.com/html/p](http://reference.sitepoint.com/html/p)

W3 参考[http://www.w3.org/TR/html4/sgml/dtd.html](http://www.w3.org/TR/html4/sgml/dtd.html)

一个关于同一问题的前 StackOverflow 问题：[为什么 <p> 标签不能在其中包含 <div> 标签？](https://stackoverflow.com/questions/8397852/why-p-tag-cant-contain-div-tag-inside-it)

# python - Python原始套接字未接收ICMP数据包

> ID：13595614
> 
> 赞同：3
> 
> 时间：2012-11-28T00:15:25.697
> 
> 标签：python, sockets, udp, icmp

我正在尝试使用 Python 中的原始套接字将 UDP 数据包发送到主机，然后为数据包获取 ICMP 响应——基本上是重新实现 traceroute。

我已经成功地正确构建了我的 IP 和 UDP 标头并发送了数据包。我可以在 Wireshark 中看到它。我还看到 Wireshark 中的 ICMP 响应告诉我超过了 TTL。

我有以下代码：

```
me = gethostbyname(gethostname())
my_socket = socket(AF_INET, SOCK_RAW)
my_socket.setsockopt(IPPROTO_IP, IP_HDRINCL, 1)
my_socket.bind((me, 0))

hostname = 'www.google.com'
hostip = gethostbyname(hostname)

packet = create_packet(hostname)
send_socket.sendto(packet, (hostip , 0)) 
```

然后在发送数据包后，我调用另一个函数来侦听包含以下代码段的传入数据包：

```
while True:
    ready = select.select([my_socket], [], [], time_left)
    if ready[0] == []:
        print "timeout"
    time_now = time.time()
    rec_packet, addr = my_socket.recvfrom(5120)

    unpacked_ip = unpack('!BBHHHBBH4s4s', rec_packet[0:20]) #0-20 is IP header
    prot = unpacked_ip[6] #gives the protocol id
    if prot == 1:
        #this is ICMP , let's do things 
```

我能够成功解压 IP 标头并检查协议，但它始终是 6 或 17（TCP 或 UDP）。即使它出现在 Wireshark 中，我也从未收到包含 ICMP 有效负载的 IP 数据包。

我尝试将 Wireshark 中的 ICMP 数据包与我的程序确实看到的 Wireshark 中的其他数据包进行比较，并且 IP 标头几乎相同。我不知道出了什么问题。

谢谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T01:00:05.833

从[这个答案](https://stackoverflow.com/a/8245667/600110)来看，您似乎需要`IPPROTO_ICMP`在创建套接字时传递该选项。

你可以这样做：

```
my_socket = socket.socket(socket.AF_INET,socket.SOCK_RAW,socket.IPPROTO_ICMP) 
```

# string - 如何将字符串中的所有空格减少为单个空格？

> ID：13595616
> 
> 赞同：1
> 
> 时间：2012-11-28T00:15:29.897
> 
> 标签：string, vb6, whitespace, trim, removing-whitespace

使用 VB6*没有*任何额外的引用（如 Regex），如何转换字符串，以便将字符串中的所有空格减少为单个空格？

例如。

```
" A    B C D   E" 
```

将被转换为

```
"A B C D E" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-28T00:35:00.550

```
Function NormalizeSpaces(s As String) As String

    Do While InStr(s, String(2, " ")) > 0
        s = replace(s, String(2, " "), " ")
    Loop
    NormalizeSpaces = s

End Function 
```

（源自：[http](http://www.techrepublic.com/article/normalizing-spaces-in-vb6-strings/5890164) ://www.techrepublic.com/article/normalizing-spaces-in-vb6-strings/5890164 ）

# java - 针对 Active Directory 的 Java 身份验证，身份验证不匹配？

> ID：13595617
> 
> 赞同：12
> 
> 时间：2012-11-28T00:15:31.017
> 
> 标签：java, active-directory, kerberos, gssapi

所以我有一些我正在测试的代码，以确保它可以很好地用于身份验证。它对直接 kerberos 效果很好，所以我认为 AD 应该只有一些小问题。不幸的是，我无法绕过 KrbException：KDC 不支持加密类型 (14)。

我知道错误是加密类型不匹配。但是我可以很好地启动，它只是在我遇到问题的代码中。我没有设置任何东西，所以我认为它应该继承与 kinit 相同的默认值，但显然情况并非如此。

编码-

```
System.setProperty("sun.security.krb5.debug", "true");
System.setProperty("java.security.krb5.realm", "TEST.SQRRL.COM");
System.setProperty("java.security.krb5.kdc", "172.16.101.128");
System.setProperty("java.security.auth.login.config", "./conf/jaas.conf");
System.setProperty("javax.security.auth.useSubjectCredsOnly", "true");

// "Client" references the JAAS configuration in the jaas.conf file.
LoginContext loginCtx = null;
loginCtx = new LoginContext("Server", new LoginCallbackHandler("test".toCharArray()));
loginCtx.login();
subject = loginCtx.getSubject(); 
```

和 jaas.conf

```
Server {
com.sun.security.auth.module.Krb5LoginModule required
useKeyTab=false
storeKey=true
useTicketCache=true
principal="accumulo@test.SQRRL.COM";
}; 
```

而且，堆栈跟踪-

```
>>>KRBError:
     sTime is Tue Nov 27 18:16:36 EST 2012 1354058196000
     suSec is 257213
     error code is 14
     error Message is KDC has no support for encryption type
     realm is test.SQRRL.COM
     sname is krbtgt/test.SQRRL.COM
     msgType is 30
javax.security.auth.login.LoginException: KDC has no support for encryption type (14)
    at com.sun.security.auth.module.Krb5LoginModule.attemptAuthentication(Krb5LoginModule.java:696)
    at com.sun.security.auth.module.Krb5LoginModule.login(Krb5LoginModule.java:542)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at javax.security.auth.login.LoginContext.invoke(LoginContext.java:769)
    at javax.security.auth.login.LoginContext.access$000(LoginContext.java:186)
    at javax.security.auth.login.LoginContext$4.run(LoginContext.java:683)
    at java.security.AccessController.doPrivileged(Native Method)
    at javax.security.auth.login.LoginContext.invokePriv(LoginContext.java:680)
    at javax.security.auth.login.LoginContext.login(LoginContext.java:579)
    at authenticators.KerberosAuthenticator.<init>(KerberosAuthenticator.java:37)
    at main.ServerImpl.<init>(ServerImpl.java:91)
    at main.PlugServer.run(PlugServer.java:22)
    at main.PlugServer.main(PlugServer.java:42)
Caused by: KrbException: KDC has no support for encryption type (14)
    at sun.security.krb5.KrbAsRep.<init>(KrbAsRep.java:66)
    at sun.security.krb5.KrbAsReq.getReply(KrbAsReq.java:446)
    at sun.security.krb5.Credentials.sendASRequest(Credentials.java:401)
    at sun.security.krb5.Credentials.acquireTGT(Credentials.java:373)
    at com.sun.security.auth.module.Krb5LoginModule.attemptAuthentication(Krb5LoginModule.java:662)
    ... 15 more
Caused by: KrbException: Identifier doesn't match expected value (906)
    at sun.security.krb5.internal.KDCRep.init(KDCRep.java:133)
    at sun.security.krb5.internal.ASRep.init(ASRep.java:58)
    at sun.security.krb5.internal.ASRep.<init>(ASRep.java:53)
    at sun.security.krb5.KrbAsRep.<init>(KrbAsRep.java:50)
    ... 19 more
Exception in thread "main" java.lang.RuntimeException: javax.security.auth.login.LoginException: KDC has no support for encryption type (14)
    at main.PlugServer.run(PlugServer.java:36)
    at main.PlugServer.main(PlugServer.java:42)
Caused by: javax.security.auth.login.LoginException: KDC has no support for encryption type (14)
    at com.sun.security.auth.module.Krb5LoginModule.attemptAuthentication(Krb5LoginModule.java:696)
    at com.sun.security.auth.module.Krb5LoginModule.login(Krb5LoginModule.java:542)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at javax.security.auth.login.LoginContext.invoke(LoginContext.java:769)
    at javax.security.auth.login.LoginContext.access$000(LoginContext.java:186)
    at javax.security.auth.login.LoginContext$4.run(LoginContext.java:683)
    at java.security.AccessController.doPrivileged(Native Method)
    at javax.security.auth.login.LoginContext.invokePriv(LoginContext.java:680)
    at javax.security.auth.login.LoginContext.login(LoginContext.java:579)
    at authenticators.KerberosAuthenticator.<init>(KerberosAuthenticator.java:37)
    at main.ServerImpl.<init>(ServerImpl.java:91)
    at main.PlugServer.run(PlugServer.java:22)
    ... 1 more
Caused by: KrbException: KDC has no support for encryption type (14)
    at sun.security.krb5.KrbAsRep.<init>(KrbAsRep.java:66)
    at sun.security.krb5.KrbAsReq.getReply(KrbAsReq.java:446)
    at sun.security.krb5.Credentials.sendASRequest(Credentials.java:401)
    at sun.security.krb5.Credentials.acquireTGT(Credentials.java:373)
    at com.sun.security.auth.module.Krb5LoginModule.attemptAuthentication(Krb5LoginModule.java:662)
    ... 15 more
Caused by: KrbException: Identifier doesn't match expected value (906)
    at sun.security.krb5.internal.KDCRep.init(KDCRep.java:133)
    at sun.security.krb5.internal.ASRep.init(ASRep.java:58)
    at sun.security.krb5.internal.ASRep.<init>(ASRep.java:53)
    at sun.security.krb5.KrbAsRep.<init>(KrbAsRep.java:50)
    ... 19 more 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-12T23:03:56.497

所以，我已经过了这个阶段。我只能猜测 Windows Server 2012 的活动目录中的 DES 支持被破坏了，因为我最终调整了我的 krb5.conf 文件并将两个默认票证类型和允许的类型设置为 aes256-cts-hmac-sha1-96 和它适用于一个用户。在 AD 中为其他用户启用 aes256 后，它继续工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-04T15:42:45.487

您需要访问用户的帐户并选中“使用 kerberos DES 加密类型”复选框。

当然，您需要以管理员身份登录 DS 才能执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T13:40:34.783

~~查看[`init()`KDCRep.java](http://www.docjar.com/html/api/sun/security/krb5/internal/KDCRep.java.html#131)，唯一看起来可能会引发错误的部分是：~~

```
 ~~150 if ((subDer.getTag() & 0x1F) == 0x00) {
    151 pvno = subDer.getData().getBigInteger().intValue();
    152如果（pvno！= Krb5.PVNO）{
    153 抛出新的 KrbApErrException（Krb5.KRB_AP_ERR_BADVERSION）；
    154 }
    第155章
    156 抛出新的 Asn1Exception（Krb5.ASN1_BAD_ID）；
    第157章~~ 
```

~~~~错误被打印为 a 似乎有点奇怪`KrbException`，但它可以工作，因为它[`KrbApErrException`](http://www.docjar.com/html/api/sun/security/krb5/internal/KrbApErrException.java.html)是[`KrbException`](http://www.docjar.com/html/api/sun/security/krb5/KrbException.java.html). `init()`但是，不能抛出任何其他子类`KrbException`。~~~~

 ~~刮那个。更好的可能性是它是其中的`Asn1Exception`s 之一，因为[KrbAsRep.java 中的构造函数将](http://www.docjar.com/html/api/sun/security/krb5/KrbAsRep.java.html#51)这些错误捕获并重新抛出为s （使用与堆栈跟踪非常匹配`KrbException`的适当值）。`initCause`

`"Identifier doesn't match expected value (906)"`让我相信它在抛出 a `Asn1Exception(Krb5.ASN1_BAD_ID)`，[因为`Krb5.ASN1_BAD_ID`它的价值是 906](http://www.docjar.com/html/api/sun/security/krb5/internal/Krb5.java.html#281)。这并没有太大帮助，因为这似乎是`init()`.

看看您是否可以生成`DerValue`与您的配置相对应的配置并手动检查它，看看哪里`init()`会拒绝它，然后从那里退后一步，看看您的配置的哪一部分创建了错误位。

* * *

经过进一步检查，该消息`"KDC has no support for encryption type"`使我相信[`Krb5.KDC_ERR_ETYPE_NOSUPP`](http://www.docjar.com/html/api/sun/security/krb5/internal/Krb5.java.html#221)一定是使用过的。但是，由于这[仅用于 的默认实例`Etype`](http://www.docjar.com/html/api/sun/security/krb5/internal/crypto/EType.java.html#101)，因此可能意义不大。~~

# caching - Azure CDN 边缘节点和来自源服务器的动态内容

> ID：13595625
> 
> 赞同：1
> 
> 时间：2012-11-28T00:17:19.210
> 
> 标签：caching, azure, cdn, etag, azure-cdn

我有一个主要是静态站点，其中包含一个特定的动态页面，每次源服务器被新请求命中时，我都放置了一个 max-age=7200 的缓存标头和一个等于新 GUID 的 ETag。

我正在通过 Fiddler 检查此 .aspx 页面的响应，并注意到我通过 CDN 访问它的前几次 ETag 不断变化（这意味着尽管最大年龄为 7200，但源服务器被击中了 3-4 次）。然后我达到了一个点，我将在 2 小时（7200 秒）的过程中刷新，并且尊重 max-age 并且 ETag 保持不变。

在这 2 个小时过去后，我注意到一个带有年轻缓存年龄和新 ETag 的新响应（假设它是“12345678”。但是，随后的请求再次忽略了我的 max-age 并使用新的 ETag 从原点提取了一个更新的副本。我又提出了几个请求，只是为了每次都看到新的 ETag。

然后，我再次点击刷新，瞧，我从几个请求中显示了相同的响应和 ETag“12345678”。

发生这种情况是因为正在调用不同的边缘节点并且它们在缓存到期时独立地从源中填充？是否有时我可能会从不同的边缘节点获取内容，因此我得到不同的 ETag，但有时我会被锁定到一个特定的边缘节点，该节点尊重完整的 7200 秒的 max-age？

# javascript - 将可变 HTML 文件加载到 Javascript 对话框中

> ID：13595627
> 
> 赞同：0
> 
> 时间：2012-11-28T00:17:37.570
> 
> 标签：javascript, jquery, python, jquery-dialog

我有一个网页上显示的文件列表。（使用 Cherrypy 和 Jinja2 的基于浏览器的 Python 应用程序）我想要的是当用户单击列表中的一项时，会弹出一个漂亮的小 Jquery 对话框，并为他们提供有关他们单击的任何项目的附加信息。我已经设置并运行了对话框，减去了要进入的特定信息。这是我需要帮助的地方。

我编写了一个 Python 脚本来为页面上显示的列表中的每个项目创建 HTML 文件。例如，当用户单击显示列表中的 foo.pdf 时，如何加载 foo.html？

我有以下 Javascript 代码（@Sander Roes 提供）：

```
$(document).ready(function(){
  $("#selectable").children("li").each(function() {
      $(this).mouseover(function(){
          $(this).css("background-color","#FECA40");
      });
      $(this).mouseout(function(){
          $(this).css("background-color","white");
      });
      $(this).click(function(){
          if (!$(this).data('dialog')) {
              $(this).data('dialog', 
                  $('<div />')
                      .load('whatever.html')    // <-- This HTML file should  
                      .dialog({autoOpen: false, // coordinate with user selection
                   show: "slide",
                               hide: "fade",
                       width: 500,
               height: 500})
              );
          }
          var dlg = $(this).data('dialog');
          dlg.dialog( "open" );
          return false;
    });
  });
}); 
```

我的想法是为列表中的每个项目分配一个唯一的`id`然后基于该加载 .html 文件`id`，但我不确定如何在 Javascript 中执行它，或者我什至可以/应该在 Javascript 中执行它吗？谢谢！

**更新：**
@user1598086 提供的代码效果很好。我还投入了[HTML5shiv](http://code.google.com/p/html5shiv/)以取得好成绩。不确定它是否需要，但认为它不会受到伤害。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:52:10.220

您可以使用`data-`属性，而不是 id： [http ://ejohn.org/blog/html-5-data-attributes/](http://ejohn.org/blog/html-5-data-attributes/)

例如：

```
<li data-externalfile="whatever.html">Whatever</li> 
```

然后（从您的代码中假设您使用的是 jQuery），而不是`.load('whatever.html')`在您的示例中，使用

```
.load(($this).attr("data-externalfile")) 
```

# c - 使用 printf 将 int 转换为 char

> ID：13595628
> 
> 赞同：0
> 
> 时间：2012-11-28T00:17:39.207
> 
> 标签：c, printf, c99

我只是想知道以下是否是将 int 转换为 char 的正确方法

```
#include <stdio.h>

int main()
{
   int x = 500;
   printf("%hhd\n", x);
} 
```

另外，从上面我想知道是否应该执行以下操作来显示字符的值。

```
#include <stdio.h>

int main()
{
   char c = 'a';
   printf("%hhd\n", c);
} 
```

还是会`printf("%d\n", c);`很好？所以，基本上我试图通过 printf 输出整数的第一个字节而不进行任何转换。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-28T00:40:46.337

在您的第一个示例中使用`%hhd`强制 C99 兼容在打印之前将其`printf()`转换`int`为传递给它。`char`根据您的字符是有符号还是无符号，您可能会看到 244 或 -12 作为打印的值。这是否是“正确”的打印方式值得商榷。很可能不是。打印字符的正常方法是使用`%c`. 一个问题是`500`应该代表一个角色。它的值超出了`char`, `signed char`or`unsigned char`类型的范围（几乎在所有平台上）。如果它是 Unicode 字符或其他宽字符值，那么您可能需要使用宽字符格式化变体 - `wprintf()`.

您使用`%c`格式和普通`char`值`'a'`的第二个示例表现良好且传统。这将打印字母“a”。如果您使用`%hhd`，它也可以工作并且通常会打印 97 （您必须在不寻常的计算机上才能获得不同的值）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T18:53:46.317

```
#include <stdio.h>

int main()
{
   int x = 500;
   printf("%hhu\n", x);
} 
```

这将打印`244`。

500 = 00000001 **11110100**

244 = **11110100**

# java - 如何使用 JAXB 生成带有 xs:element 的 XSD？

> ID：13595629
> 
> 赞同：2
> 
> 时间：2012-11-28T00:17:42.750
> 
> 标签：java, jaxb, schema

我的模型对象看起来像这样：

```
@XmlRootElement(name = "appConfig")
@XmlType(propOrder = {})
public class Config implements Serializable {
...
private int advancedFooBar;
...
@XmlElement(name = "advancedfoobar")
public int getAdvancedFooBar() {
    return advancedFooBar;
}

public void setAdvancedFooBar(int advancedFooBar) {
    this.advancedFooBar = advancedFooBar ;
} 
```

当我针对此类 w/JXC 生成模式时，我最终得到以下属性：

```
<xs:element name="advancedfoobar" type="xs:int"/> 
```

我希望这是一个可选元素，所以我尝试更改

```
@XmlElement(name = "advancedfoobar") 
```

至

```
@XmlElement(name = "advancedfoobar", required=false) 
```

但是，这并没有导致生成的模式发生任何变化。我需要做什么才能在生成的架构中将“advancedfoobar”元素定义为可选？

我在 Windows 7 Ultimate x64 上使用 JDK 1.7.0_U3。

谢谢。

-诺亚

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T00:37:07.337

**JAVADOCS 说什么**

根据Javadoc `@XmlElement`（请参阅： [http](http://docs.oracle.com/javase/6/docs/api/javax/xml/bind/annotation/XmlElement.html#required%28%29) ://docs.oracle.com/javase/6/docs/api/javax/xml/bind/annotation/XmlElement.html#required%28%29 ）

> 如果 required() 为 false，则 Javabean 属性将映射到具有 minOccurs="0" 的 XML Schema 元素声明。maxOccurs 对于单值属性为“1”，对于多值属性为“无界”。

的架构定义`advancedfoobar`应该`minOccurs=0`用于以下映射：

```
@XmlElement(name = "advancedfoobar")
public int getAdvancedFooBar() {
    return advancedFooBar;
} 
```

和

```
@XmlElement(name = "advancedfoobar", required=false)
public int getAdvancedFooBar() {
    return advancedFooBar;
} 
```

* * *

**MOXy 和参考实现中的错误**

[**EclipseLink JAXB (MOXy)**](http://www.eclipse.org/eclipselink/moxy.php)和 JAXB 参考实现中似乎都存在关于原语和可选元素的错误。我已经针对 MOXy 打开了以下错误。

*   [http://bugs.eclipse.org/395301](http://bugs.eclipse.org/395301)

* * *

**解决方法**

您可以将属性设为 type`Integer`而不是`int`. 或者更好的是，只需将注释`type`上的属性设置为. 默认情况下，任何能够保存值的类型都是可选的。`@XmlElement``Integer``null`

**配置**

```
package forum13595629;

import java.io.Serializable;
import javax.xml.bind.annotation.*;

@XmlRootElement(name = "appConfig")
@XmlType(propOrder = {})
public class Config implements Serializable {

    private int advancedFooBar;

    @XmlElement(name = "advancedfoobar", type=Integer.class)
    public int getAdvancedFooBar() {
        return advancedFooBar;
    }

    public void setAdvancedFooBar(int advancedFooBar) {
        this.advancedFooBar = advancedFooBar;
    }

} 
```

**演示**

```
package forum13595629;

import java.io.IOException;

import javax.xml.bind.JAXBContext;
import javax.xml.bind.SchemaOutputResolver;
import javax.xml.transform.Result;
import javax.xml.transform.stream.StreamResult;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(Config.class);

        jc.generateSchema(new SchemaOutputResolver() {

            @Override
            public Result createOutput(String namespaceUri,
                    String suggestedFileName) throws IOException {
                StreamResult result = new StreamResult(System.out);
                result.setSystemId(suggestedFileName);
                return result;
            }

        });

    }

} 
```

**输出**

```
<?xml version="1.0" encoding="UTF-8"?>
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema">
   <xsd:complexType name="config">
      <xsd:all>
         <xsd:element name="advancedfoobar" type="xsd:int" minOccurs="0"/>
      </xsd:all>
   </xsd:complexType>
   <xsd:element name="appConfig" type="config"/>
</xsd:schema> 
```

# mysql - 将 2 列别名为同名

> ID：13595634
> 
> 赞同：2
> 
> 时间：2012-11-28T00:18:32.957
> 
> 标签：mysql, join, alias

我想知道是否可以将 2 个单独表中的 2 列别名为同名。

例如，我想将电子邮件表与用户表和管理员表连接起来，并让各自的“名称”列组合在同一列中。

```
Email Table: Email ID | Email Address

User Table: Username| Email ID

Admin Table: Username| Email ID

Result:

Username | Email Address 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:25:21.743

我相信这就是你想要得到的：

```
SELECT a.Username, a.Email_ID, b.Email_Address
FROM
    (SELECT Username, Email_ID FROM User
    UNION ALL
    SELECT Username, Email_ID FROM Admin) a
INNER JOIN Email b ON b.Email_ID = a.Email_ID 
```

这将堆叠`User`和`Admin`表，然后`JOIN`是`Email`表。

请注意，如果有重复项并且您想删除它们，您应该使用`UNION`而不是`UNION ALL`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T00:25:28.633

假设您的表具有以下列

```
Email: EmailId, EmailAddress
User:  UserName, EmailId
Admin: UserName, EmailId 
```

然后下面的联合应该将它们放入一个列表中。注意我使用 LEFT JOIN 来允许 User 或 Admin 表中的 EmailId 无效的情况

```
SELECT  u.UserName, e.EmailAddress
FROM USER u
LEFT JOIN Email e ON e.Id = u.EmailId

UNION

SELECT  a.UserName, e.EmailAddress
FROM Admin u
LEFT JOIN Email e ON e.Id = a.EmailId 
```

# applescript - 为什么我的 AppleScript 程序说 iTunes 正在播放曲目，而 iTunes 实际上并没有这样做？

> ID：13595638
> 
> 赞同：1
> 
> 时间：2012-11-28T00:18:58.630
> 
> 标签：applescript

我正在尝试制作一个告诉 iTunes 播放某个曲目的 AppleScript。这是我的代码。我很困惑，因为当我将“theCommand”设置为“播放 Shake Up Christmas by Artist Train”时，当我右键单击一封测试电子邮件并单击“应用规则”时，该脚本会起作用。但是，当我告诉它播放电子邮件告诉它播放的内容时，它不起作用。

```
using terms from application "Mail"
on perform mail action with messages messageList for rule aRule
    tell application "Mail"
        repeat with thisMessage in messageList
            try
                set theCommand to content of thisMessage as string
            on error errMsg
                display alert errMsg
            end try
        end repeat
    end tell
    tell application "iTunes"
        if theCommand contains "play" then
            if theCommand is equal to "play" then
                play
            else
                set prevTIDs to text item delimiters of AppleScript
                set text item delimiters of AppleScript to "play "
                set subject to text items of theCommand
                set text item delimiters of AppleScript to ""
                set subject to "" & subject
                set AppleScript's text item delimiters to " by artist "
                set delimitedList to every text item of subject
                set theTrack to the first item of delimitedList
                try
                    set theArtist to the second item of delimitedList
                    set artistIsDefined to true
                on error
                    set artistIsDefined to false
                end try
                set AppleScript's text item delimiters to prevTIDs
                if artistIsDefined is true then
                    try
                        play (every track in playlist 1 whose artist is theArtist and name is theTrack)
                        say "Playing " & theTrack
                    on error errMsg
                        say errMsg
                    end try
                else
                    play (every track in playlist 1 whose name is theTrack)
                end if
            end if
        else if theCommand is equal to "pause" then
            pause {}
        else if theCommand is equal to "stop" then
            stop {}
        end if
    end tell
end perform mail action with messages
end using terms from 
```

Mac 将通过说“正在播放（曲目）”来回复电子邮件，但它不会播放曲目。该文件位于 Time Capsule 上的事实并不重要，因为 iTunes 可以访问它。（如果不能，iTunes 会在曲目名称左侧显示一个感叹号。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T02:49:17.593

我的猜测是，您需要在此命令中将“every”一词更改为“first”...

```
play (every track in playlist 1 whose artist is theArtist and name is theTrack) 
```

我没有测试我的理论，但我认为通过使用“每个”这个词，您可以从该命令中获得曲目列表（即使列表中只有 1 首曲目）。iTunes 不知道如何播放列表。iTunes 可以播放曲目。因此，通过使用“first”，您将找到找到的第一首曲目，因此它应该可以工作。或者，您可以获取列表的第一项...播放（（每首曲目...）的第 1 项）。

# javascript - 选中复选框后更新价格

> ID：13595640
> 
> 赞同：0
> 
> 时间：2012-11-28T00:19:06.357
> 
> 标签：javascript, jquery, jquery-selectors

我有一个相当简单的问题（我认为），它涉及使用 jQuery 更新数字。我有一个 DIV，其中包含一个项目的价格。用户可以选择一个复选框以添加到总价中。我需要的是当有人点击一个复选框时，它会将正确的数量添加到 DIV。当用户取消选中复选框时，会减去该值。到目前为止，这是我的代码：

```
<div class="cell">
    <div class="check">
        <input id="check-0" type="checkbox" />
        <label for="check-0">$100</label>
        <div class="mask"></div>
    </div>
</div>

<div class="price">$347</div> 
```

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:36:29.623

希望这是您可以使用或帮助您的东西：

[http://jsfiddle.net/VWRAd/](http://jsfiddle.net/VWRAd/)

```
$(".cell").on("click", "input:checkbox", function () {
    var $this = $(this);
    var $total = $("#price");
    var $target = $("label[for='" + $this.attr("id") + "']");

    var item_value = +($target.html().replace("$", "") || 0);
    var cur_total = +($total.html().replace("$", "") || 0);

    if ($this.prop("checked") === true) {
        cur_total += item_value;
    } else {
        cur_total -= item_value;
    }

    $total.html("$" + cur_total);
}); 
```

尽管请注意我将带有`class`“价格”的元素更改为具有“价格”的元素**`id`**。这是有道理的，除非您期望有几个“价格”元素。

这是另一种可能的方法......不确定哪个更好：

[http://jsfiddle.net/VWRAd/1/](http://jsfiddle.net/VWRAd/1/)

```
$(".cell").on("click", "input:checkbox", function () {
    var $items = $(".cell").find("input:checkbox:checked");
    var $total = $("#price");
    var cur_total = 0;

    $items.each(function () {
        var $this = $(this);
        var $target = $("label[for='" + $this.attr("id") + "']");
        var item_value = +($target.html().replace("$", "") || 0);

        cur_total += item_value;
    });

    $total.html("$" + cur_total);
}); 
```

需要考虑的一些事项 - 在显示项目时将“$”与项目的实际值分开是有意义的......我确定您没有使用“$”存储值，因此您可能需要类似的结构到`<label for="whatever">$<span class="the-value">100</span></label>`. 它会稍微改变你的 jQuery 选择器逻辑，但它会阻止`.replace`经常使用的需要。此外，正如其他人已经指出的那样，将项目的价格存储在复选框的属性中并以这种方式检索它肯定会更容易`value`（而不是找到相应`<label>`的内容。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-28T00:40:48.917

```
var changePrice = function changePrice(amt, state){
    var curPrice = $('.price').text();
    curPrice = curPrice.substring(1, curPrice.length);
    if(state==true){
        curPrice = parseInt(curPrice) + parseInt(amt);
    }else{
        curPrice = parseInt(curPrice) - parseInt(amt);
    }
    curPrice = '$' + curPrice;
    $('.price').text(curPrice);
}
$(function(){
    $('#check-0').on('change', function(){
        var itemPrice = $('label[for="check-0"]').text();
        itemPrice = itemPrice.substring(1, itemPrice.length);
    changePrice(itemPrice, $('#check-0').is(':checked'));
    });
})​;​ 
```

演示：http: [//jsfiddle.net/pratik136/r2Snu/](http://jsfiddle.net/pratik136/r2Snu/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-28T00:36:21.777

即使这些可能不是旨在访问服务器的表单控件，我仍然会为每个输入放置 value 属性。

因此，对于“check-0”输入，我会输入一个`value`属性`100`（以表示 100 美元）。

然后，一些 javascript 逻辑应该可以很容易地更新价格值。

所以这样的事情应该这样做（[http://jsbin.com/orodow/1/edit](http://jsbin.com/orodow/1/edit)）：

```
<div class="cell">
    <div class="check">
        <input id="check-0" type="checkbox" value="100" />
        <label for="check-0">$100</label>
        <div class="mask"></div>
    </div>
</div>
<div class="cell">
    <div class="check">
        <input id="check-1" type="checkbox" value="50" />
        <label for="check-1">$50</label>
        <div class="mask"></div>
    </div>
</div>
<div class="cell">
    <div class="check">
        <input id="check-2" type="checkbox" value="20" />
        <label for="check-2">$20</label>
        <div class="mask"></div>
    </div>
</div>

<div class="price"></div>

<script>
    $(function(){
        var inputs = $('.check input:checkbox');
        function updatePrice(){
            var value = 0;
            inputs.filter(':checked').each(function(){
                value += parseInt($(this).val(), 10);
            });
            $('.price').html('$' + value);
        }
        inputs.change(updatePrice);
    });
</script> 
```

# java - Neo4j - 不推荐使用关系扩展器，使用最低共同祖先

> ID：13595646
> 
> 赞同：0
> 
> 时间：2012-11-28T00:19:36.463
> 
> 标签：java, neo4j, graph-theory, deprecated

我希望在这里使用最低的共同祖先方法：http: [//grepcode.com/file/repo1.maven.org/maven2/org.neo4j/neo4j-graph-algo/1.8.M03/org/neo4j/graphalgo /impl/ancestor/AncestorsUtil.java?av=f](http://grepcode.com/file/repo1.maven.org/maven2/org.neo4j/neo4j-graph-algo/1.8.M03/org/neo4j/graphalgo/impl/ancestor/AncestorsUtil.java?av=f)

我让它与RelationshipExpander一起使用，但不推荐使用该类以支持PathExpander，但是在这种情况下我看不到如何应用PathExpander。

此处示例： [http ://grepcode.com/file/repo1.maven.org/maven2/org.neo4j/neo4j-graph-algo/1.8.M03/org/neo4j/graphalgo/impl/ancestor/AncestorTestCase.java?av =f](http://grepcode.com/file/repo1.maven.org/maven2/org.neo4j/neo4j-graph-algo/1.8.M03/org/neo4j/graphalgo/impl/ancestor/AncestorTestCase.java?av=f)

任何指针？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T09:28:53.373

AncestorUtil 也将使用 PathExpander 方法进行更新（可能适用于 1.9），所以不用担心。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-16T16:36:19.213

I'm also looking for this. So far, I've seen that AncestorUtil has not changed.

From the following link: [http://api.neo4j.org/current/org/neo4j/graphdb/RelationshipExpander.html](http://api.neo4j.org/current/org/neo4j/graphdb/RelationshipExpander.html) I would expect that it might be possible to use it somehow.

There was also a usage example before, that we can see here. [http://grepcode.com/file/repo1.maven.org/maven2/org.neo4j/neo4j-graph-algo/1.9.4/org/neo4j/graphalgo/impl/ancestor/AncestorTestCase.java?av=f](http://grepcode.com/file/repo1.maven.org/maven2/org.neo4j/neo4j-graph-algo/1.9.4/org/neo4j/graphalgo/impl/ancestor/AncestorTestCase.java?av=f) Anyone knows how this could be adapted?

# sql-server-2008 - t-sql 查询中的 MAX 函数

> ID：13595648
> 
> 赞同：3
> 
> 时间：2012-11-28T00:20:00.440
> 
> 标签：sql-server-2008, tsql, sql-server-2008-r2

我正在尝试在几个表中获取最大列值。例如，在下面的代码段中（它不起作用），我试图从所有 3 个表 A、B 和 C 中的列名“tickvalue”中获取 MAX 值。不知道如何获取该值。

tickvalue 列的数据类型是时间戳。

```
select 
c.somkey
,MAX(a.tickvalue, b.tickvalue, c.tickvalue) as tickvalue
from A as a
join B as b
on a.key = b.key
join C as c
on b.somekey = c.somkey
where a.key = '<some key>' 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T01:46:15.860

这不是`MAX()`聚合函数在 TSQL 中的工作方式（参见此处：[TSQL MAX()](http://msdn.microsoft.com/en-us/library/ms187751.aspx "TSQL MAX()")） MAX 函数仅在单个列中获取最大值。

要在此处实现您想要的，您必须将三个值放入单个列中。这可以使用`UNPIVOT` [PIVOT/UNPIVOT来完成](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)

这个片段可能会帮助你。

```
CREATE TABLE #A (ID INT, tickvalue INT)
CREATE TABLE #B (ID INT, tickvalue INT)
CREATE TABLE #C (ID INT, tickvalue INT)

INSERT INTO #A VALUES (1,1)
INSERT INTO #A VALUES (2,4)
INSERT INTO #A VALUES (3,7)
INSERT INTO #A VALUES (4,2)
INSERT INTO #A VALUES (5,8)

INSERT INTO #B VALUES (1,8)
INSERT INTO #B VALUES (2,7)
INSERT INTO #B VALUES (3,2)
INSERT INTO #B VALUES (4,4)
INSERT INTO #B VALUES (5,1)

INSERT INTO #C VALUES (1,2)
INSERT INTO #C VALUES (2,1)
INSERT INTO #C VALUES (3,2)
INSERT INTO #C VALUES (4,15)
INSERT INTO #C VALUES (5,2)

SELECT ID, MAX(tickvalue)
FROM
(SELECT C.ID, A.tickvalue t1, B.tickvalue t2, C.tickvalue t3
FROM #A AS a
JOIN #B AS b ON a.ID = b.ID
JOIN #C AS c ON b.ID = c.ID) p
UNPIVOT (tickvalue FOR tsource IN (t1,t2,t3)) AS unpvt
GROUP BY ID

DROP TABLE #A
DROP TABLE #B
DROP TABLE #C 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T03:02:43.460

甲骨文有[最伟大](http://www.techonthenet.com/oracle/functions/greatest.php)的功能来做同样的事情。有时我在 Sql Server 中写了一个相同的版本，可以[在这里找到](http://beyondrelational.com/modules/2/blogs/80/posts/10694/day-16-greatest-and-least-function-in-oracle.aspx)。看看，我认为这将达到目的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T09:01:09.207

使用 UNPIVOTE 的替代方案

```
SELECT c.ID,
       CASE WHEN a.tickvalue >= b.tickvalue THEN
                                                 CASE WHEN a.tickvalue >= c.tickvalue THEN a.tickvalue ELSE c.tickvalue END
                                            ELSE CASE WHEN b.tickvalue >= c.tickvalue THEN b.tickvalue ELSE c.tickvalue END END
FROM A a JOIN B b ON a.ID = b.ID
         JOIN C c ON b.ID = c.ID 
```

# url - 重定向到子目录

> ID：13595649
> 
> 赞同：1
> 
> 时间：2012-11-28T00:20:02.003
> 
> 标签：url, redirect

谁能告诉我如何自动将访问者重定向到我网站的子目录（子目录包含 index.html，因此无需在 url 中输入 /index.html）？

例如我的文件结构是这样的：

public_html/index.html <-- 空文件，只包含到 /stageforduets 的 URL 重定向代码

public_html/stagefordues/index.html

我不希望访问者每次都必须输入 www.mywebsite.com/stageforduets。我希望访问者输入 www.mywebsite.com 然后自动重定向到 www.mywebsite.com/colorfulstage（不是 www.mywebsite.com/stageforduets/index.html）

我已经试过了

```
<meta http-equiv="REFRESH" content="0;url=http://www.mywebsite.com/stageforduets/index.html"> 
```

但它不起作用。它给了一个

"Forbidden You don't have permission to access /stageforduetsstageforduetsstageforduetsstageforduetsstageforduetsstageforduetsstageforduetsstageforduetsstageforduetsstageforduetsstageforduetsstageforduetsstageforduetsstageforduetsstageforduetsstageforduetsstageforduetsstageforduetsstageforduetsstageforduets on this server." 错误。o_o

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:22:41.273

也许你可以使用 php header 来解决这个问题？

# php - MySQL忽略查询请求

> ID：13595650
> 
> 赞同：0
> 
> 时间：2012-11-28T00:20:11.007
> 
> 标签：php, mysql, database, connection

你能注意到什么问题吗？到目前为止，在我的测试中，每当我有查询时，我都会得到一个 HTTP 500。我对 PHP 很陌生，可以得到尽可能多的帮助。

```
 <?php
require_once "dbConnect.php";
require "../www/showArticle.php";

$queryBodyCommand = "SELECT pbody FROM pages WHERE id='$pageid' LIMIT 1";
$queryBody = mysql_query($sqlConnect, $queryBodyCommand) or die (mysql_error()); 
while ($row = mysql_fetch_array($queryBody)) { 
    $body = $row["pbody"];
    $title = $row["title"];
}  
mysql_free_result($queryBody);

$queryLabelCommand = "SELECT id, label FROM pages WHERE showLabel ='1' AND enabled ='1' ORDER BY id ASC"; 
$queryLabel = mysql_query($sqlConnect, $queryLabelCommand) or die (mysql_error()); 
while ($row = mysql_fetch_array($queryLabel)) {
    $pid = $row["id"];
    $label = $row["label"];
    $menuList = '<a href="index.php?pid=' . $pid . '">' . $label . '</a><br />';
    } 
mysql_free_result($queryBody);

?> 
```

这是我的 showArticle.php：

```
<?php
require_once('../sub/dbConnect.php');
require('../sub/functions.php');
if (!$_GET['pid']) {
    $pageid = '1';
} else {
    $pageid = ereg_replace("[^0-9]", "", $_GET['pid']);
}
?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title><?php echo $title; ?></title>
</head>
<body>
<?php echo $title; ?>
Body:
<?php echo $body; ?>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:47:41.443

尝试：

```
require_once('dbConnect.php');
require('../www/showArticle.php'); 
```

# php - 回合制游戏得分记录

> ID：13595651
> 
> 赞同：2
> 
> 时间：2012-11-28T00:20:12.523
> 
> 标签：php, javascript, jquery

我正在开发一个非常非常基本的回合制游戏`php`，`jquery`并且我正在研究两种不同的方法来跟踪当前用户的分数：

1) `global javascript variables`- 例如`var currentScore`在 js 的开头。游戏动作和回合都是通过ajax控制的，所以我不必担心页面刷新会丢失变量数据。

2) - 使用,等`mysql`创建一行并访问它/每轮更新它。`currentScore``user`

我正在尝试平衡 a) 加载速度和 b) 使分数防篡改。我认为本地 javascript 会更快且加载时间更短，但 mysql 记录会更防篡改。有没有人对哪个更快，哪个更防篡改有任何建议，或者可能有我上面没有列出的另一种方法来完成这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T00:36:17.850

在 PHP 中运行您的游戏，而不是在 JS 中。

我的意思是不要让玩家的电脑控制动作，并将结果发送回服务器......

这允许人们劫持并向您的 PHP 发送消息，例如自动射击手枪......或爆头脚本......或速度黑客。

...或者更糟——发送诸如“我刚轮到我得 500 分”之类的消息，然后让您的 PHP 脚本运行：“好的！”。

因此，游戏引擎的核心应该运行在 PHP 中，客户端应该只说：“我的角色想要移动`X`方块。”，然后服务器可以说：“不，你是一个作弊工具，你只能移动 3 个方格。”，然后客户必须遵守这些规则。

在这方面，PHP 将 100% 控制记分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T00:34:25.687

任何未存储在服务器上的数据都将是可篡改的。任何发送到服务器的数据都可以被篡改。服务器不仅应该存储所有游戏数据，还应该验证来自客户端的所有传入数据。例如，规则是否真的允许该玩家使用他们告诉我他们正在使用的招式？否则，很容易作弊。再说一次，您的项目可能不需要那么多的审查。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T00:33:45.803

两者，永远不要相信游戏中的javascript。总会有一个聪明的玩家会弄乱它。使用 javascript 作为 gui 部分并控制游戏，但始终检查 PHP 中的所有结果，尤其是特定于玩家的值。检查合适的球员！否则一些失败者会扰乱你的游戏。不要担心速度，只需编写游戏脚本（当然要考虑速度和数据）并在遇到性能问题时进行调查。一个问题从一开始就很重要：考虑您的数据库表和查询​​。这很可能成为您的性能瓶颈，而不是糟糕的 php 脚本。

# asp-classic - 在excel中将数字格式化为文本

> ID：13595652
> 
> 赞同：0
> 
> 时间：2012-11-28T00:20:13.257
> 
> 标签：asp-classic, vbscript

建立一个excel电子表格是一个经典的asp应用程序。现在的问题是其中一列被excel自动格式化为数字，而它实际上应该是文本，因此它正在删除老板想要保留的前导零。我已经进行了一些网络搜索，您应该能够在字符串中预先附加一个撇号，强制 excel 将其显示为文本：

```
If isNumeric(val) Then
response.write "'" & val
Else
response.write val
End If 
```

太好了，但是 excel 现在显示这些列时带有前导撇号！从我所做的阅读中，前导撇号应该被隐藏并且只被excel用作格式，我做错了什么？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T01:41:37.833

经过一番摸索后，我发现这是可行的：

```
Response.Write "=""" & Trim(val) & """" 
```

正确显示并且没有显示格式字符，当然除非您单击单元格然后内容显示在标题中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T14:24:08.217

如果您使用 Microsoft 库创建 Excel，而不是创建 Excel 读取的 csv 文件。然后你基本上可以将列指定为文本。通过这样做，您不必将字符串字符添加到单元格中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-01T14:52:43.907

在 HTML中要在 Excel 单元格中插入的值之前添加一个**空格字符：**`&nbsp;`

```
If isNumeric(val) Then
    response.write "&nbsp;" & val
Else
    response.write val
End If 
```

# ruby - Sass 自定义导入器

> ID：13595657
> 
> 赞同：0
> 
> 时间：2012-11-28T00:20:37.247
> 
> 标签：ruby, sass

我有一段用于编译 .scss 代码的 ruby​​ 代码。我正在尝试构建一个自定义导入器来从数据库加载文件。

这是我的红宝石代码：

```
require 'rubygems'
require 'sass'
require 'sass/plugin'
require './eptimporter'  # my custom importer( code below )

Sass::Plugin.options[:load_paths] ||= []
Sass::Plugin.options[:load_paths] << Sass::Importers::Eptimporter.new("dummy")

puts Sass::Plugin.options[:load_paths]
puts Sass.compile_file("sass/sass.scss")  # scss file (code below) 
```

这是我的进口商：

```
module Sass
  module Importers
    class Eptimporter < Base

      attr_accessor :root

      def initialize(root)
        @root = root
      end

      # @see Base#find_relative
      def find_relative(name, base, options)
        nil
      end

      # @see Base#find
      def find(name, options)
        options[:syntax] = ":scss"
        options[:filename] = name
        options[:importer] = self
        Sass::Engine.new("p { color :blue; }", options)
      end

      # @see Base#mtime
      def mtime(name, options)
        Time.now
      end

      # @see Base#key
      def key(name, options)
        [self.class.name , name]
      end

      # @see Base#to_s
      def to_s
        @root
      end
    end
  end
end 
```

最后是我的 scss 文件：

```
@import "dummy.scss";
p { 
  color: red; 
  span { text-transform: uppercase; }
} 
```

`p { color :blue; }`无论导入字符串是什么，自定义导入器都只会返回一个静态 CSS 代码。我确实得到了一个`File to import not found or unreadable: dummy.scss. (Sass::SyntaxError)`错误。什么会导致此错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T17:47:55.067

Are you sure your Importer is being registered? Try registering like this: Sass.load_paths << Sass::Importers::Eptimporter.new('dummy')

You might also find a problem in the options[:syntax]. It should be :scss instead of ":scss"

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T21:12:49.987

使用哈希将您的选项传递给 compile_file。

```
load_paths = Sass::Plugin.options[:load_paths] || []
load_paths << Sass::Importers::Eptimporter.new("dummy")

Sass.compile_file("sass/sass.scss", {:load_paths => load_paths}) 
```

或者

```
Sass.compile_file("sass/sass.scss", {:importer => Sass::Importers::Eptimporter.new("dummy")}) 
```

# mysql - MYSQL 函数“错误代码：1242 子查询返回超过 1 行”但我没有子查询

> ID：13595661
> 
> 赞同：3
> 
> 时间：2012-11-28T00:20:54.717
> 
> 标签：mysql, sql, function, stored-procedures, stored-functions

我不知道是什么问题，为什么它在运行函数时给我错误

这是我的sql：

```
 CREATE FUNCTION `test`.`GetProcessorMethodID` (processor_id INT, method_id INT)
RETURNS INTEGER
BEGIN
    DECLARE id INT;
    SET @id := (SELECT `processor_method_id` FROM `processor_method` WHERE `processor_id` = processor_id AND `method_id` = method_id);
RETURN @id;
END 
```

![在此处输入图像描述](../Images/65387dec82a27ada8a76c3f0d8542182.png)

但是当我使用这行sql时

```
 SELECT processor_method_id FROM test.processor_method
WHERE processor_id = 1 AND method_id = 2; 
```

![在此处输入图像描述](../Images/f31ea17d9d97e22e7157cd80c07d1811.png)

它工作正常！它给出了我想要得到的期望值。但是在我的函数中它没有返回我的预期值并且总是给我错误而且我不知道出了什么问题

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-28T01:31:08.427

您的问题实际上很简单，您将来一定会记住它...更改您的参数名称...从 processor_id, method_id 到类似 parmProcessor, parmMethod

就目前而言，您当前的参数与您要查询的列名完全相同，因此

```
where `processor_id` = processor_id (same with method) 
```

都是指实际的列名，并且 1=1 整天和 2=2 相同，所以你得到了每条记录。

通过将它们更改为与上面的示例略有不同的东西，您将得到

```
where `processor_id` = parmProcessor and `method_id` = parmMethod 
```

这是查询中的明确不同的含义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T00:29:43.443

查询

```
SET @id := (SELECT `processor_method_id` FROM `processor_method` WHERE `processor_id` = processor_id AND `method_id` = method_id); 
```

可以想象为 processor_method_id 返回不止一条记录，这就是为什么它说子查询返回不止一行。根据您要如何选择数据，您可以使用该`LIMIT`子句。

所以它会变成：

```
SET @id := (SELECT `processor_method_id` FROM `processor_method` WHERE `processor_id` = processor_id AND `method_id` = method_id LIMIT 1); 
```

# c - 按特定字段对二维字符串数组进行排序

> ID：13595662
> 
> 赞同：1
> 
> 时间：2012-11-28T00:20:57.867
> 
> 标签：c, arrays, sorting, multidimensional-array, qsort

给定一个二维数组，如下所示：

```
char * Arr[4] = 
{
    {"124 -346  DATA...."},
    {"39479 -32 MOREDATA...."},
    {"12 -1 DATA2...."},
    {"100 -45 DATA4...."}
}; 
```

我正在尝试使用[qsort()](http://www.cplusplus.com/reference/cstdlib/qsort/)根据**SECOND**字段对该函数进行排序，这意味着将根据最低的第二个值（-1、-32、-45、-346）对字符串进行排序。如果每个值只有一个数字，我知道如何实现此功能，但程序中的数字可以任意长。这就是我所拥有的，但是程序崩溃了，如果有一种更有效的方法来对这些数据进行排序，我很想在这里（我知道我的方法效率不高）。

排序函数（qsort() 调用）：

```
inline void GetStr(char *ix, char* Result)  //call to get second number in function
{
    char *spacing;              //iterator to traverse
    spacing = ix;               //iterator = pos of ix
    int LEN = 0;                //length and offset
    int Offset = 0;

    while(*spacing != ' ')      //while not at end of first num
    {
        Offset++;               //offset is more
        spacing++;
    }
    spacing++;                  //go one ahead of the space
    Offset++;

    while(*spacing != ' ')      //while not end of second number
    {
        spacing++;
        Offset++;
        LEN++;                  //length of number
    }
    strncpy(Result, ix + (Offset - LEN),LEN);
}

int sort(const void* a, const void* b)
{
    char *ia = *(char**)a;
    char *ib = *(char**)b;

    char * Str;
    char * Str2;
    GetStr(ia, Str);                                    //getting some strange errors....... program just crashes
    GetStr(ib, Str2);
    printf("Str: %s Str2: %s", Str, Str2);
    int n1 = atoi(Str);
    int n2 = atoi(Str2);
    return (n1 > n2);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T22:16:22.873

你可以从这样的东西开始，你需要在某个地方实际调用 sort 。还需要考虑文件很大时会发生什么：

```
#include <stdio.h>

int
Sort(const void *a, const void *b)
{
    int *aa = a, *bb = b;
    return (aa[1] < bb[1]); //i need to sort by field, not a simple comparison. HOW?
}

int main(int argc, char **argv) {
  FILE *f = fopen(argv[1]);
  if (f) {
    char buffer[1024];
    int *v;
    int data[1024][5];
    int cnt = 0;
    while (fgets(buffer, sizeof(buffer), f)) {
        v = data[cnt++];
        sscanf(buffer, "%d %d %d %d %d", v, v+1, v+2, v+3, v+4);
    }
    fclose(f);
  }
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-30T22:19:34.830

我相信你在这里至少有一个问题：

```
strncpy(Result, ix + (Offset - LEN),LEN); 
```

如果您查看 的[文档`strncpy`](http://linux.die.net/man/3/strncpy)，您会发现如果您达到字符限制，它不会自动以空值终止复制的字符串。因此，您的`Result`字符串不是以空值结尾的。

尝试更改为：

```
strncpy(Result, ix + (Offset - LEN),LEN);
Result[LEN] = '\0'; 
```

当然，您仍然需要为 Result 字符串提供内存。当前，您正在将未初始化的指针传递给`GetStr()`：

```
char * Str;
char * Str2; 
```

由于这些是相当小的整数，您可以像这样使用静态分配的存储：

```
#define MAX_RESULT_LEN 64

/* ... */

char Str[MAX_RESULT_LEN]
char Str2[MAX_RESULT_LEN]

/* ... */

if (LEN > MAX_RESULT_LEN - 1) {
    LEN = MAX_RESULT_LEN - 1;
}

strncpy(Result, ix + (Offset - LEN),LEN);
Result[LEN] = '\0'; 
```

`sort()`最后，您的功能存在一些问题。如果您查看[qsort() 文档](http://linux.die.net/man/3/qsort)，您可以看到返回值应该是“如果第一个参数分别被认为小于、等于或大于零，则返回值应该是“小于、等于或大于零的整数第二”。实现这一点的最简单方法是使用逻辑`n1 - n2`而不是`n1 < n2`.

我还认为您的类型论点也`char **`很奇怪，但经过进一步思考，我意识到它们是正确的。来自 qsort 文档：“指向被比较对象的两个参数”。所以实际上它们将是指向 C 字符串或`char **`.

所以这是最终版本：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define MAX_RESULT_LEN 64

void GetStr(char *ix, char* Result)  //call to get second number in function
{
    char *spacing;              //iterator to traverse
    spacing = ix;               //iterator = pos of ix
    int LEN = 0;                //length and offset
    int Offset = 0;

    while(*spacing != ' ')      //while not at end of first num
    {
        Offset++;               //offset is more
        spacing++;
    }
    spacing++;                  //go one ahead of the space
    Offset++;

    while(*spacing != ' ')      //while not end of second number
    {
        spacing++;
        Offset++;
        LEN++;                  //length of number
    }

    if (LEN > MAX_RESULT_LEN - 1) {
        LEN = MAX_RESULT_LEN - 1;
    }

    strncpy(Result, ix + (Offset - LEN),LEN);
    Result[LEN] = '\0';
}

int sort(const void* a, const void* b)
{
    char *ia = *(char **)a;
    char *ib = *(char **)b;

    char Str[MAX_RESULT_LEN];
    char Str2[MAX_RESULT_LEN];

    GetStr(ia, Str);
    GetStr(ib, Str2);

    printf("Str: %s Str2: %s", Str, Str2);
    int n1 = atoi(Str);
    int n2 = atoi(Str2);
    return (n1 - n2);
}

int main(void) {
    char * Arr[4] = 
    {
        {"124 -346  DATA...."},
        {"39479 -32 MOREDATA...."},
        {"12 -1 DATA2...."},
        {"100 -45 DATA4...."}
    };

    qsort(Arr, 4, sizeof(char *), sort);
} 
```

# java - AsyncTaks HTTP 请求超时和异常处理

> ID：13595664
> 
> 赞同：3
> 
> 时间：2012-11-28T00:21:11.800
> 
> 标签：java, android

我正在向 Facebook 图形 API 发出 HTTP-get 请求。

在大约 1/5 次中，我的代码永远不会到达`Log.i("debug", "resp");`. 没有抛出异常。不应该吗？还是默认情况下它只是一个很长的超时？

如果我添加自定义超时（见下文），我会抛出异常。但即使我的代码包含在 try+catch 语句中，我的应用程序也会崩溃（就像任何未处理的异常一样），而不是让我处理`onPostExecute()`. 为什么我不使用该方法？

```
protected Map<String, Integer> doInBackground(Void... params) {

    Map<String, Integer> result = new HashMap<String, Integer>();

    try {

        HttpGet get = new HttpGet("https://graph.facebook.com/....etc");

        //final HttpParams httpParams = httpclient.getParams();
        //HttpConnectionParams.setConnectionTimeout(httpParams, 5000);
        //HttpConnectionParams.setSoTimeout(httpParams, 5000);

        HttpResponse response = httpclient.execute(get);
        Log.i("debug", "resp");  

        HttpEntity resEntityGet = response.getEntity();

        //do stuff with resEntityGet           

        return result;            

    } catch (Exception e) { 
        Toast.makeText(mainActivity, "Error: " + ex.getMessage(), Toast.LENGTH_LONG).show();
        return null;
    }
}

protected void onPostExecute(Map<String, Integer> result) {

    if(result != null){
        //use the result data
    } else {
        //exception occured
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:53:04.733

如果您将其发布到 UI 线程，则可以显示`Toast`来自该方法的方法。`doInBackground`有几种方法可以做到这一点，但这里有一种方法：

```
mainActivity.runOnUiThread( new Runnable() {

    @Override
    public void run() {
        Toast.makeText(mainActivity, "Error: " + ex.getMessage(), Toast.LENGTH_LONG).show();
    }
} ); 
```

你需要使`Exception`变量`final`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T06:28:11.640

```
catch (Exception ex) {
       // execep is here string variable u declare in globally
       execep=ex.getMessage();
      runOnUiThread( new Runnable() {
   @Override
public void run() {
  Toast.makeText(  getApplicationContext(), "Error: " +execep, Toast.LENGTH_LONG).show();
                                        }} );

                               }//catch 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-12T10:25:43.070

您的代码是正确的，但它并不清晰和安全。如果未设置超时，则将其设置为默认值 0。超时值为零被解释为无限超时。在这种情况下，当响应数据因任何原因出现问题时，您的客户端要么被中断，要么什么都不知道。在情况 2 - 更坏的情况下 - 客户端不会抛出任何异常，您的程序将永远存在。解决此问题，您应该在获取或发布所有内容到服务器时设置超时。它是安全的。我不完全知道客户永远活着的原因，没有任何例外。我认为这是服务器问题或网络问题。希望能帮到你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-08T06:06:55.233

当我以这种方式处理异常时，我也遇到了同样的问题

```
public class ServerCheckingActvity extends Activity{
    ProgressDialog  progress;
    static String constant="";
    Map<String, Integer> result;
    @Override
public void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
     new MyAsynchTask().execute();
}

private  class MyAsynchTask extends AsyncTask<Void,Void,String>{
    @Override
    protected void onPreExecute(){
           progress=new ProgressDialog(ServerCheckingActvity.this);
           // progress.setTitle(" DATA RETRIVEING");
            progress.setMessage("please wait........");
            progress.setProgressStyle(ProgressDialog.STYLE_SPINNER);
            progress.setCancelable(true);
            progress.show();
            super.onPreExecute();
    }

    @Override
    protected String doInBackground(Void... params) {
        String view="";

        try {
            DefaultHttpClient httpClient = new DefaultHttpClient();

            HttpGet get = new HttpGet("www.facebook .com/...........");

            //final HttpParams httpParams = httpclient.getParams();
            //HttpConnectionParams.setConnectionTimeout(httpParams, 5000);
            //HttpConnectionParams.setSoTimeout(httpParams, 5000);

            HttpResponse response =httpClient.execute(get);
            Log.i("debug", "resp");  

            HttpEntity resEntityGet = response.getEntity();

            //do stuff with resEntityGet           

           // assigen ur value to result map object here;    
            result = new HashMap<String, Integer>();

        } catch (Exception e) { 
            constant="Exception";
            //Toast.makeText(mainActivity, "Error: " + ex.getMessage(), Toast.LENGTH_LONG).show();
            //return null;
        }
        return view="from doing background";
    }
    @Override
    protected void onPostExecute(String view ){
        if(constant=="Exception"){
            constant="";
            Toast.makeText(getApplicationContext(), "server problem", Toast.LENGTH_LONG).show();

        }else if(result != null){
            //use the result data
        } else {
            //exception occured
        }
    }

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-05T18:59:01.183

Figured it out myself. Turns out that you can't create toasts in `doInBackground()`. Hope this helps someone else.

# c# - 调用 WCF 服务时 JSONP 自动完成失败

> ID：13595667
> 
> 赞同：1
> 
> 时间：2012-11-28T00:21:38.117
> 
> 标签：c#, jquery, wcf, jsonp

我需要为我们的一个网络表单提供 JSONP 自动完成功能，与此相同：http: [//jqueryui.com/autocomplete/#remote-jsonp](http://jqueryui.com/autocomplete/#remote-jsonp)。

本质上，我想使用从我的 WCF 服务返回的与用户输入的搜索词匹配的值动态填充下拉列表。

WCF服务成功命中，文本框内容作为搜索参数成功传入。网络服务返回，但我总是陷入 jQuery 中的“错误：”块。

这是调用我自己的 WCF 服务的重组 jQuery（取自上面链接的 AutoComplete 示例）：

```
$("#txtModels").autocomplete({
    source: function (request, response) {
        $.ajax({
            url: "http://localhost:12345/webapi/models",
            dataType: "jsonp",
            data: {
                search: request.term
            },
            success: function (data) {
                alert("Success");  //never reach here
                //response($.map(data.models, function (item) {
                //   return {
                //        label: item.model,
                //        value: item.model
                //    }
                //}));
            },
            error: function() {
                alert("Error");  //always an error
            }
        });
    },
    minLength: 2,
    select: function (event, ui) {
        //log(ui.item ?
        //    "Selected: " + ui.item.label :
        //    "Nothing selected, input was " + this.value);
    },
    open: function () {
        //$(this).removeClass("ui-corner-all").addClass("ui-corner-top");
    },
    close: function () {
        //$(this).removeClass("ui-corner-top").addClass("ui-corner-all");
    }
}); 
```

这是 WCF 服务。它确实被击中并返回而没有错误。

```
[OperationContract]
[WebInvoke(Method = "GET",
            BodyStyle = WebMessageBodyStyle.Wrapped,  //tried ".Bare" also
            ResponseFormat = WebMessageFormat.Json,
            UriTemplate = "models?search={search}")]
public string[] GetBoxSerialNums(string search)
{
    string[] models = new string[]{"Ford", "Chevy", "Honda"};
    return models;
} 
```

WCF 项目是使用内置 WCF 模板创建的，因此我的 web.config 没有端点配置，但无论如何都是这样：

```
<?xml version="1.0"?>
<configuration>
  <connectionStrings>
    <!--removed-->
  </connectionStrings>

  <system.web>
    <compilation debug="true" targetFramework="4.0" />
  </system.web>

  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true">
      <add name="UrlRoutingModule" type="System.Web.Routing.UrlRoutingModule, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
    </modules>
  </system.webServer>

  <system.serviceModel>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="true"/>
    <standardEndpoints>
      <webHttpEndpoint>
        <!-- 
            Configure the WCF REST service base address via the global.asax.cs file and the default endpoint 
                        via the attributes on the <standardEndpoint> element below
        -->
        <standardEndpoint name="" helpEnabled="true" automaticFormatSelectionEnabled="false" maxReceivedMessageSize="10240000" maxBufferSize="10240000" />
      </webHttpEndpoint>
    </standardEndpoints>
  </system.serviceModel>

  <appSettings>
    <!--removed-->
  </appSettings>

</configuration> 
```

我对 jQuery/JSON 非常陌生，尤其是 JSONP，但很明显 web 服务没有以 jQuery 调用所期望的格式返回数据。我需要做什么才能完成这项工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T05:14:47.830

`bindings`通过添加以下内容更改您的 web.config `system.serviceModel`：

```
<bindings>
  <webHttpBinding>
    <binding name="webHttpBindingWithJsonP" crossDomainScriptAccessEnabled="true" />
  </webHttpBinding>
</bindings> 
```

并添加`bindingConfiguration="webHttpBindingWithJsonP"`到您的`<endpoint>`标签中。

`BodyStyle`然后最后通过删除和更改您的网络方法`UriTemplate`：

```
[WebInvoke(Method = "GET",
           //BodyStyle = WebMessageBodyStyle.Wrapped,  //tried ".Bare" also
           ResponseFormat = WebMessageFormat.Json
           //UriTemplate = "models?search={search}"
           )]
public string[] GetBoxSerialNums(string search) 
```

现在 WCF 服务的响应应该是这样的：

```
jQuery16409075580490753055_1354078880656(["Ford","Chevy","Honda"]); 
```

这符合 JSONP 要求并且应该可以工作。

# ios - 如何将文本视图添加到图像视图？

> ID：13595671
> 
> 赞同：-4
> 
> 时间：2012-11-28T00:21:46.150
> 
> 标签：ios, iphone, xcode

我一直在研究这个问题，但我找到的答案不起作用。

```
[myImageView addSubview:myTextView]; 
```

我希望文本成为图像的一部分，所以如果我将 myImageView 保存到相机胶卷，文本将被包含在内。我做错了什么还是有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T01:19:13.983

假设你已经有了一个 UIImage img，然后使用下面的代码添加文本

```
-(void)drawText:(NSString *)text onImage:(UIImage *)img
{
   UIFont *font = yourTextViewFont;
   UIGraphicsBeginImageContext(img.size);
   [img drawAtPoint:CGPointZero];
   CGContextSetRGBFillColor(UIGraphicsGetCurrentContext(), 1.0, 1.0, 1.0, 1);
   [text drawAtPoint: CGPointMake(20, 20) withFont: font];

   UIImage *ret = UIGraphicsGetImageFromCurrentImageContext();
   UIGraphicsEndImageContext();

   return ret;
} 
```

# php - 在不使用 substr 的情况下删除字符串的一部分

> ID：13595672
> 
> 赞同：0
> 
> 时间：2012-11-28T00:21:55.083
> 
> 标签：php, string, substr

我有一个带有不同长度的不同字符串的字符串

**例子：**

```
/my-big-property/Residential/Sections-for-sale 

/my-big-property/Residential/for-sale 
```

我只想删除`/my-big-property/`但因为`substr`似乎不起作用我还有什么其他选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:26:52.670

你能通过`substr`不起作用进一步解释吗？这似乎是一个非常简单的问题。

```
<?php
$a = "/my-big-property/Residential/Sections-for-sale";
$b = substr($a, 17);
echo $b; 
```

如果第一个`/`和第二个之间的初始字符串`/`是可变的，那么像这样的正则表达式就足够了：

```
<?php
$a = "/my-big-property/Residential/Sections-for-sale";
preg_match("/\/\S+?\/(.*)/", $a, $matches);
print_r($matches); 
```

这将输出：

```
Array
(
    [0] => /my-big-property/Residential/Sections-for-sale
    [1] => Residential/Sections-for-sale
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T06:53:59.453

```
<?php
    $a = "/my-big-property/Residential/Sections-for-sale";
    $temp = explode('/my-big-property/',$a);
    $temp_ans = $temp[1];
    echo $temp_ans;
?> 
```

将有两个数组，一个为空白，另一个将具有所需的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T00:48:41.490

最重要的是，您可以简单地使用以下正确的建议解决方案：

```
$string="/my-big-property/Residential/Sections-for-sale";

$string = str_replace("/my-big-property/", "", $string); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T00:30:33.023

substr 工作正常，只是您没有正确使用它。它是一个函数而不是一个过程。它不会更改原始字符串，而是返回一个新的子字符串。

# c# - 在一个连接中执行多个 UPDATE 语句的最佳方法是什么？

> ID：13595673
> 
> 赞同：7
> 
> 时间：2012-11-28T00:21:58.277
> 
> 标签：c#, oracle, odp.net, update-statement

如何正确进行以下更新：

```
using (OracleConnection conn = new OracleConnection())
using (selCmd)
{

    string sql1 = "update Table1 set name = joe where id = 10;"
    string sql2 = "update Table2 set country = usa where region = americas;"
    string sql3 = "update Table3 set weather = sunny where state = CA;"
    string sql4 = "update Table4 set engine = v8 where maker = benz;"

    cmdUpdate.CommandText = sql(#);
    cmdUpdate.Connection = conn;
    recs = cmdUpdate.ExecuteNonQuery();
} 
```

如果这是一笔交易，我全都知道或一无所知，但我只是想看看它是如何以正确的方法工作的。

我正在考虑迭代一组项目 [sql1,sql2,sql3,sql4] 并在 CommandText 中传递 sql(#) 并每次执行 ExecuteNonQuery。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-28T00:42:48.387

如果我没记错的话，可以在一个字符串中连接多个 SQL 语句，用分号 (;) 分隔。否则，执行多个`ExecuteNonQuery()`调用没有任何问题。

```
string sql1 = "BEGIN update Table1 set name = 'joe' where id = 10;",
       sql2 = "update Table2 set country = 'usa' where region = 'americas';",
       sql3 = "update Table3 set weather = 'sunny' where state = 'CA';",
       sql4 = "update Table4 set engine = 'v8' where maker = 'benz'; END;";

string sql = string.Format("{0}{1}{2}{3}",sql1,sql2,sql3,sql4);

using (OracleConnection conn = new OracleConnection())
using (OracleCommand cmdUpdate = new OracleCommand(sql, conn))
{
    conn.Open();
    recs = cmdUpdate.ExecuteNonQuery();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-04-11T14:42:02.543

我最近在一些旧代码中遇到了这个问题。我们动态构建 SQL 调用链（支持 Oracle 和 Sql Server）。由于当前没有 Oracle 生产实施，因此没有人测试 Oracle 操作并且没有出现客户错误。我找到了一个构建命令链的代码，然后，对于它使用的 Oracle `String.Split(';')`。然后，它使用循环来执行事务中的每个语句：`rowsAffecter += ExecuteNonQuery....`

我不喜欢这个想法，因为没有参数化它是危险的方法，因为一些数据可以包含`;`. 但即使参数化到位......

...为 Oracle ( )制作**匿名块**的问题之一是不会返回行数（返回 -1），有时需要判断是否有更新。`"begin... end;"``ExecuteNonQuery`

为了解决这个问题，我已经这样做了

```
private string AppendOracleCountOrNothing(StringBuilder sql)
{
    if (_myProvider == Providers.Oracle)
        sql.AppendLine("rowCnt := rowCnt + SQL%ROWCOUNT;");
}

public void SomeMethod()
{
    var longSqlChain = new StringBuilder(2000);

    longSqlChain.Append("Insert into table...;");
    AppendOracleCountOrNothing(longSqlChain);
    if (someCondition)
    {
        longSqlChain.AppendLine("Update anotherTable...;");
        AppendOracleCountOrNothing(longSqlChain);
    } 

    // may be, add some more sql to longSqlChain here....

    int rowsAffected;
    if (_myProvider == Providers.Oracle)
    {
        longSqlChain.Insert(0, @"DECLARE
            rowCnt number(10) := 0
            BEGIN
            ").AppendLine(@":1 := rowCnt;
            END;");
        // Now, here we have some abstract wrappers that hide provider specific code. 
        // But the idea is to prepare provider specific output parameter and then parse its value
        IDataParameter p = ParameterWrapper.PrepareParameter(":1", 0, ParameterDirection.Output, myProvider); // note IDataParameter 
        SqlExecWrapper.ExecuteNonQuery(_myProvider, CommandType.Text, sql, new[]{p});
        rowsAffected = p.GetParameterValue(); // GetParameterValue is an extension on IDataParameter 
    }
    else // sql server
    {
        rowsAffected = SqlExecWrapper.ExecuteNonQuery(_myProvider, CommandType.Text, sql, null);
    }
} 
```

这样我们就可以访问 DB 并获取受此调用影响的返回行数。查询也可以参数化。同样，最好开发抽象层，因此，您可以调用类似的东西`parameterizer.CreateParameter(10)`，这将在您的 sql 语句中将参数添加到集合并生成`:1, :2, :3, etc.`（oracle）和`@1, @2, @3, etc.`（sql server）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-03T11:19:23.423

另一种方法是创建一个简单的扩展方法 (ExecuteMultipleNonQuery)，它简单地将字符串拆分为所有分号并在循环中执行每个语句：

```
public static class DbCommandExtensions {

    public static void ExecuteMultipleNonQuery(this IDbCommand dbCommand)
    {
        var sqlStatementArray = dbCommand.CommandText.Split(new string[] {";"}, StringSplitOptions.RemoveEmptyEntries);
        foreach (string sqlStatement in sqlStatementArray)
        {
            dbCommand.CommandText = sqlStatement;
            dbCommand.ExecuteNonQuery();
        }
    }

} 
```

# python - 如何将 Python ElemenTree 编写为 XML 文件？

> ID：13595674
> 
> 赞同：2
> 
> 时间：2012-11-28T00:22:00.383
> 
> 标签：python, xml, elementtree

我的代码

```
tree = ET.Element('e')
tree.attrib['u'] = 'F' + str(srh) + '_0'
if procedural_variables:
    pvs = ET.SubElement(tree, 'pvs')
    for procedural_variable in procedural_variables:
        pv = ET.SubElement(pvs, 'pv')

        n = ET.SubElement(pv, 'n')
        n.text = procedural_variable['name']

        v = ET.SubElement(pv, 'v')
        v.text = str(procedural_variable['value'])
ET.dump(tree) 
```

我怎么能把它`tree`写成一些`file.xml`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T00:24:39.227

看来您应该可以使用[`ET.tostring`](http://docs.python.org/2/library/xml.etree.elementtree.html#xml.etree.ElementTree.tostring). 或者，您可以使用类的[`.write`方法](http://docs.python.org/2/library/xml.etree.elementtree.html#xml.etree.ElementTree.ElementTree.write)`ElementTree`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T02:52:07.527

```
file_out=open('output.xml','wb',1000)
ElementTree(file_out).write(tree,encoding="ASCII")
file_out.close() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T04:16:18.493

只是向您推荐**lxml**。你可以谷歌它或点击[http://lxml.de](http://lxml.de)。

它非常易于使用且功能强大！该 API 与 ET 相当接近，如果不完全相同的话。

# java - 您可以动态创建对 JCheckBox 对象的引用吗？

> ID：13595677
> 
> 赞同：0
> 
> 时间：2012-11-28T00:22:19.373
> 
> 标签：java, arrays, swing, jcheckbox

我不知道怎么问这个。我正在处理的程序已经完成，但它似乎有过多的代码。以下是部分代码：

```
chkDef1 = new JCheckBox

if (chkDef1.isSelected()) {
            actual = chkDef1.getText();
        } 
else if (chkDef2.isSelected()) {
            actual = chkDef2.getText();
        } 
else if (chkDef3.isSelected()) {
            actual = chkDef3.getText();
        } 
else {
            actual = chkDef4.getText();
        } 
```

在其他区域，chkDef1 - 4 复选框存在大量重复代码。我想做的是在重复代码的区域使用循环，然后只使用 1 个赋值语句。

我试过： if(('chkDef' + counter).isSelected())

我还尝试将“'chkDef' + counter”分配给字符串变量，然后添加 isSelected。不幸的是，我不断收到错误消息。

我是一个新手程序员，所以我不知道我想做的事情是否可能或它叫什么。如果可能的话，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:25:27.067

只需创建一个列表`checkboxes`并遍历它。

```
ArrayList<JCheckBox> checkboxes  = new ArrayList<JCheckBox>();
//Init your checkboxes array. 

for(JCheckbox chkbox :checkboxes)
{
  if(chkbox.isSelected())
   {
    actual = chkbox.getText() ; break;
  }
} 
```

虽然，可能有一个 JCheckbox 组可以满足您的需求。

[看起来您可以使用 ButtonGroup](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/ButtonGroup.html)并让元素对其进行迭代。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T00:27:08.340

您可以创建一个包含所有复选框的数组，然后遍历该数组...

```
JCheckBox[] boxes = new JCheckBox[] {chkDef1,chkDef2,chkDef3,chkDef4}
for (JCheckBox box : boxes) {
    if (box.isSelected()) {
        actual = box.getText();
        break; // We don't want to loop unnecessarily
    }
} 
```

同样，您可以创建一个采用可变数量参数的简单方法...

```
public String getCheckedItem(JCheckBox... boxes) {
    String actual = null;
    for (JCheckBox box : boxes) {
        if (box.isSelected()) {
            actual = box.getText();
            break; // We don't want to loop unnecessarily
        }
    }
    return actual;
} 
```

并称它为...

```
String actual = getCheckItem(chkDef1, chkDef2, chkDef3, chkDef4); 
```

就个人而言，我会退回复选框，但这取决于你

如果您只对维护一个选中的复选框感兴趣（即不允许选中多个复选框），那么您应该认真考虑使用`JRadioButton`s and`ButtonGroup`来代替。

否则，您可以收集所有选定的复选框...

```
public JCheckBox[] getCheckedItem(JCheckBox... boxes) {
    List<JCheckBox> selected = new ArrayList<JCheckBox>(boxes.length);
    for (JCheckBox box : boxes) {
        if (box.isSelected()) {
            selected.add(box);
        }
    }
    return selected.toArray(new JCheckBox[selected.size]);
} 
```

# c++ - 无法输出任何东西。

> ID：13595678
> 
> 赞同：-6
> 
> 时间：2012-11-28T00:22:40.473
> 
> 标签：c++

我正在为我的 c++ 课程做最后的项目。说明不清楚，但在任何一种情况下，我都编译了我的代码，但它不会输出任何东西。您能否查看我的代码并让我知道我缺少什么？这是她的要求：

* * *

该程序将包括使用 try 和 catch 进行错误捕获。

在每个获取用户输入的函数中放置一个 throw，如果输入的 Major 为 0，则抛出一个字符串“Bad Major”。输入功能在下面的 2、4 和 7 中指定。

创建一个全局结构如下：

```
struct Student 
{ 
       char Name[30]; 
       float GPA; 
       int Major; 
}; 
```

1.  在主要创建该结构的 2 个实例。称它们为 S1 和 S2。

2.  创建并调用一个名为 StudentData 的函数： S2 = StudentData( S1 ); //这是对函数的调用该函数接收对结构的引用作为参数（原型将处理此）并将返回对结构的引用。使用 couts 和 cins 从用户那里获取数据。出于测试目的，更改 S1 中的数据，使 GPA 为 3.5，专业为 2。由于您要使用 cins 从用户那里获取数据，因此您是用户，只需输入这些值。调用该函数后，S1 和 S2 都将包含相同的数据。

3.  在主打印中，使用 cout 存储在结构 S1 和 S2 中的数据。

4.  使用指向 S2 的指针作为参数调用名为 ChangeData 的函数： ChangeData( &S2 ); //这是对函数的调用 更改 S2 中的数据，使 GPA 为 3.0，专业为 1。（使用这些值进行测试...）

5.  返回主打印使用 cout 存储在结构 S2 中的数据。

6.  现在在 main.js 中创建一个包含 2 个结构的数组。调用数组学生。

7.  创建一个函数 GetStudents，它将接收数组和一个表示元素数量的 int (2)。在函数中，遍历数据并使用 cin、cin.getline 和 cout 语句从用户那里获取所有三个字段。像这样组织：

for (...........) { cout 提示用户 cin.getline 名称 cout 提示用户 cin GPA cout 提示用户 cin 主要 cin.ignore(1); }

问题是数字值的 cin 会将 ENTER 键留在键盘缓冲区中，这可以用于 cin 和其他数字但不能用于字符串，因此我们必须自己删除它。cin.ignore 应该为我们处理这个问题。

1.  从 main 调用函数 GetStudents。

2.  创建一个函数 PrintStudents，它将接收与 GetStudents 相同的参数。它将在 2 行上打印出学生数组，每个学生 1 行。

现在这是我的代码：

```
#include<iostream>
#include<iomanip>

using namespace std;

//Global variable to determine size of name
const int Name_Size = 30;

//Structure
struct Student
{
    char Name[30];
    float GPA;
    int Major;
};

//Function Prototypes
Student* studentData(Student &S1);
Student* changeData(Student &S2);
Student getStudent(Student array[], int size);
Student printStudents(Student array[], int size);

int main()
{
    Student S1; // structure instance called S1.
    Student S2; // structure instance called S2.

    Student student[2]; //array of 2 structures.

    S2 = *studentData(S1); //Calls the studentData function.

    changeData(S2); //Calls the changeData function.

    getStudent(&S1, 2); //Calls the getStudent function.

    printStudents(&S1, 2); //Calls the printStudents function.

    system("pause");
    return 0;
}

//Function Definitions

//studentData function
Student* studentData(Student &S1)
{
        cout << "Student 1" << endl;
        cout << "_________" << endl;
        cout << "Name: " << S1.Name << endl;
        cout << "GPA: " << S1.GPA << endl;
        cout << "Major: " << S1.Major << endl;
        cout << endl;

    if (S1.Major == 0)
    {
        throw "Bad Major!\n";
    }
    else 
        return &S1;
}

Student* changeData(Student &S2)    // Changes the data.
{
        cout << "Name: " << S2.Name << endl;
        cout << "GPA: " << S2.GPA << endl;
        cout << "Major: " << S2.Major << endl;

    if (S2.Major == 0)
    {
        throw "Bad Major!\n";
    }
    else 
        return &S2;     
}

Student getStudent(Student array[], int size) //Function and loop to receive the array and an int representing the number of elements(2). 
{
    for (int index = 0; index < size; index++)
    {
        cout << "Please enter students full name: ";  
        cin.getline(array[index].Name, 30);
        cout << "Please enter students GPA: ";
        cin >> array[index].GPA;
        cout << "Please enter students major: ";
        cin >> array[index].Major;
        cin.ignore(1);
    }
    if (array[1].Major == 0 || array[2].Major == 0)
    {
        throw "Bad Major!\n";
    }
    else
        return array[size];
}

Student printStudents(Student array[], int size)
{
    for (int index = 0; index < size; index++)
    {
        cout << array[index].Name << "  " << array[index].GPA << "  " << array[index].Major << endl;
        return array[size];
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T01:32:45.303

~~查看调用函数的语法：~~

 ~~```
S2 = *studentData(S1); 
```~~ 

我相信在没有'*'的情况下调用函数：

```
S2 = studentData(S1); 
```

~~在你的程序中可能会有更多这样的情况。~~

## Edit1：通过引用传递，返回指向传递引用的指针

在进一步检查您的程序时，该函数`studentData`接收到一个**通过引用传递**`Student`的变量。这意味着可以直接修改传递给该函数的原始变量。在函数结束时，您返回一个指向该变量的指针。有点多余。

 **与`changeData()`.

此外，**根据要求 #2**，函数`StudentData`需要返回引用而不是指针。声明看起来像：

```
Student& StudentData(Student& any_student); 
```

**请注意每个要求的功能拼写。****

# azure - Azure 请求失败错误详细信息

> ID：13595682
> 
> 赞同：3
> 
> 时间：2012-11-28T00:23:08.103
> 
> 标签：azure

我已经启动并运行了一个 Azure 应用程序，但各种请求会生成 500 错误。没有从服务器返回的其他详细信息让我确切知道问题所在。没有堆栈跟踪，没有错误消息。我从服务器返回的唯一东西是表明我有错误的 http 标头。

我环顾四周，但似乎无法找到一种方法来检索我正在寻找的错误详细信息。我看过一些建议我启用日志记录的文章，但我不确定 1）如何做到这一点，2）这些日志文件将去哪里以及 3）如何访问所述日志文件。我看过帖子说要向我的应用程序添加一大堆代码以启用日志记录，但我正在寻找的只是一条错误消息和来自 500 错误的堆栈跟踪。我真的必须在我的应用程序中添加一堆代码才能看到这些信息吗？如果没有，我怎么能得到它？

谢谢！
克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T02:27:08.990

最好的长期解决方案是启用 Azure 诊断，我认为这就是您所指的。如果您想要一个快速而简单的解决方案，您可以将错误记录到文件中，然后将 RDP 记录到角色实例中以查看它们。这与您在自己的数据中心的服务器上执行的操作非常相似。

您可以随意创建日志。我已经成功使用了 log4net 和 RollingFileAppenders。将日志文件路径设置为“\logs\mylog.txt”之类的内容会将日志放置在 VM 的 E: 驱动器中。请注意，您仍然需要在应用程序中的某处编写代码来捕获错误并将其写入日志 - 通常 Global.asax 中的全局错误处理程序是一个很好的地方。

您还必须启用对您的角色实例的 RDP 访问。有很多文章详细说明了如何做到这一点。[这是一个](http://msdn.microsoft.com/en-us/library/windowsazure/gg443832.aspx)。

这不是一般推荐的方法，因为当角色回收或重新创建时日志可能会消失。登录以密切关注所有这些不同的服务器也是一种痛苦。

另一个警告 - 500 错误可能是由于您的 web.config 中的某些故障。如果是这种情况，那么世界上所有的应用程序级错误日志都不会对您有所帮助。因此，请确保您的 web.config 有效，并在 RDP 进入服务器时检查 Windows 事件日志。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T05:51:36.033

500 internal server error 最常见的原因是服务器无法理解传入请求或配置出现问题时出现问题。所以，尝试在本地运行应用程序，看看是否有问题。您可以在 catches/application_error 中记录数据库中的错误，也可以使用跟踪。相信我，它们非常有帮助，值得多写几行代码。

对于跟踪看看这里， http: [//msdn.microsoft.com/en-us/magazine/ff714589.aspx](http://msdn.microsoft.com/en-us/magazine/ff714589.aspx)

# c#-4.0 - C# Process.Start 在批处理文件中弄乱了 URI

> ID：13595684
> 
> 赞同：0
> 
> 时间：2012-11-28T00:23:22.040
> 
> 标签：c#-4.0, process, batch-file, uri, appdomain

这只是一个快速的问题，我相信有人能够快速回答，因为我很可能只是错过了一些东西。

假设我有以下目录布局

```
Folder1
  -> CurrentlyRunning.EXE
  -> Folder2
     ProcessToStart.Bat
     ApplicationToStartFromBat.exe 
```

这是应用程序内部的代码。

当前运行.EXE：

```
 var proc = new Process
            {
                StartInfo =
                    {
                        FileName = "Folder2/ProcessToStart.Bat",
                        WindowStyle = ProcessWindowStyle.Hidden,
                        CreateNoWindow = true,
                        UseShellExecute = false
                    }
            };

        proc.Start(); 
```

ProcessToStart.Bat：

```
START ApplicationToStartFromBat.exe 
```

现在，如果我通过双击运行 ProcessToStart.Bat，它将毫无问题地打开 ApplicationToStartFromBat.exe（这很好）。如果我运行 CurrentRunning.EXE（它将执行我上面发布的代码），BAT 文件会失败，说它找不到我的 EXE（这真的很奇怪）。

如果我将 BAT 文件更改为：

```
START Folder2/ApplicationToStartFromBat.exe 
```

然后运行CurrentlyRunning.EXE，bat就会正确打开ApplicationToStartFromBat.exe。我的问题是由于某种原因我无法更改 bat 中的代码。

为什么会`proc.Start()`导致 bat 文件搜索根目录发生更改，如何阻止这种情况发生？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T09:23:04.903

我认为这与您的 exe 文件的*工作*目录所在的位置有关。

尝试使用[ProcessStartInfo.WorkingDirectory](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.workingdirectory.aspx)为您的批处理文件设置正确的目录。

```
var proc = new Process
{
    StartInfo =
    {
        FileName = "Folder2/ProcessToStart.Bat",
        WorkingDirectory = "DirectoryPath";
        WindowStyle = ProcessWindowStyle.Hidden,
        CreateNoWindow = true,
        UseShellExecute = false
    }
};
proc.Start(); 
```

# c# - Html.EditorFor 用于带逗号的十进制字段

> ID：13595685
> 
> 赞同：3
> 
> 时间：2012-11-28T00:23:28.977
> 
> 标签：c#, asp.net-mvc-3, format, decimal, comma

嗨，我为价格定义了一个小数字段，如下所示：

```
[Required(ErrorMessage = "Asking Price/Rent is required.")]
[Display(Name = "Asking Price/Rent*")]
[DisplayFormat(DataFormatString = "{0:N0}", ApplyFormatInEditMode = true)]
public decimal Price {get; set;} 
```

在我看来，我有一个编辑器字段，如下所示：

```
<div class="editor-label">
    @Html.LabelFor(model => model.Property.Price)
    @Html.EditorFor(model => model.Property.Price)
</div> 
```

我在 web.config 中设置了以下全球化文化

```
<globalization uiCulture="en-GB" culture="en-GB" /> 
```

如果我不使用逗号，一切正常。IE

50.00 被保存并显示为 50 500000 被保存并显示为 500,000

但是，如果我尝试输入 500,000 即用逗号输入，则会出现以下错误：

```
The value '500,000' is not valid for Asking Price/Rent*. 
```

我希望编辑器字段能够使用逗号，因为我希望大多数用户在表单中输入价格时使用逗号。

如何在输入数字时允许使用逗号？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-10T13:39:36.800

我有一个可能适用于您的情况的解决方案，首先我们将使用一些 javascript 来帮助我们

保留上面实现的文本框并在其旁边添加标签空白标签

使用 javascript，我们解析在文本框中输入的数字，并将其转换为您希望显示的逗号新格式

通过这种方式，您可以获得添加数据注释验证的全部功能，并向用户显示格式化的数字

以下链接我也可以帮助您

[https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/toLocaleString](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/toLocaleString)

[http://weblogs.asp.net/scottgu/archive/2010/06/10/jquery-globalization-plugin-from-microsoft.aspx](http://weblogs.asp.net/scottgu/archive/2010/06/10/jquery-globalization-plugin-from-microsoft.aspx)

[http://yuilibrary.com/yui/docs/datatype/#formattingnumbers](http://yuilibrary.com/yui/docs/datatype/#formattingnumbers)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-15T15:11:14.887

你必须改变

```
[DisplayFormat(DataFormatString = "{0:N0}", ApplyFormatInEditMode = true)] 
```

至

```
 [DataType(DataType.Currency)] 
```

问题已经解决了！

# php - Ajax 计数器不起作用

> ID：13595687
> 
> 赞同：0
> 
> 时间：2012-11-28T00:23:36.563
> 
> 标签：php, ajax, arrays

全部，

我正在使用[这个 Ajax 教程](http://www.tizag.com/ajaxTutorial/ajax-javascript.php)，它基本上从数据库中提取一些记录并显示它们。我想用一个按钮来修改代码，该按钮将一个一个地显示记录，而不是一起显示。我想要实现的行为是每次用户单击`Show next`按钮时获取下一条记录。

为此，我在 Ajax 函数中构建了一个小计数器，用作决定打印哪个数组元素的索引。这行不通。**我的问题是：为什么我的柜台不工作？

这是html和Ajax代码：

```
<html>
<body>
<script type="text/javascript">
<!-- 
function createRequest() {
  //Returns HttpRequest
    return request;
  }

//My attempt at a counter.  This doesn't work.
var index=null;

function calcIndex(){
  if(index==null){
    index=0;
  }else{
    index += index;
  }
  return index;
}
(.....)

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:31:20.743

您的`calcIndex`函数声明已损坏，缺少`function`部分。你*确定*要设置`index += index`吗？那会有点奇怪。不仅如此，即使你修复它并保持原样，索引也永远不会超过零：

```
var index=null;

function calcIndex(){
  if(index==null){
    index=0;            // First call, now index = 0
  }else{
    index += index;     // Second, third, ... nth call: index = 0 + 0
  }
  return index;
} 
```

让我们简化一下：

```
var index = 0;
function calcIndex(){
    return index++;   // Returns zero first, then 1, then 2...
} 
```

但是等等，到那时你为什么还需要一个函数呢？相反，您可以简单地执行以下操作：

```
var index = 0;
...
//index = calcIndex();  No point here
var queryString = "?age=" + age + "&wpm=" + wpm + "&sex=" + sex + "&index=" + index++;
                                                                              ^^^^^^^^ 
```

干杯

# python - 在python中获取动态属性

> ID：13595690
> 
> 赞同：26
> 
> 时间：2012-11-28T00:23:49.327
> 
> 标签：python, getattr

我有一个可以用三种不同方式命名的*伪*或*特殊*属性的对象（注意：我不控制生成对象的代码）

属性中的值（取决于设置的值）完全相同，我需要获取它以进行进一步处理，因此根据数据源，我可以有类似的东西：

```
>>> obj.a
'value'
>>> obj.b
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: Obj instance has no attribute 'b'
>>> obj.c
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: Obj instance has no attribute 'c' 
```

或者

```
>>> obj.a
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: Obj instance has no attribute 'a'
>>> obj.b
'value'
>>> obj.c
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: Obj instance has no attribute 'c' 
```

或者

```
>>> obj.a
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: Obj instance has no attribute 'a'
>>> obj.b
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: Obj instance has no attribute 'b'
 >>> obj.c
'value' 
```

我有兴趣获取`'value'`，不幸`__dict__`的是该对象中不存在属性。所以我最终为获得这个价值所做的只是打了一堆`getattr`电话。假设可能性只有三种，代码如下所示：

```
>>> g = lambda o, l: getattr(o, l[0], getattr(o, l[1], getattr(o, l[2], None)))
>>> g(obj, ('a', 'b', 'c'))
'value' 
```

现在，我想知道是否有更好的方法？因为我 100% 相信我所做的 :)

提前致谢

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-11-28T00:30:28.153

怎么样：

```
for name in 'a', 'b', 'c':
    try:
        thing = getattr(obj, name)
    except AttributeError:
        pass
    else:
        break 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T00:32:23.310

这具有处理任意数量项目的优势：

```
 def getfirstattr(obj, *attrs):
     return next((getattr(obj, attr) for attr in attrs 
                  if hasattr(obj, attr)), None) 
```

这确实有一个*非常*小的缺点，它对最终值进行两次查找：一次检查属性是否存在，另一次实际获取值。这可以通过使用嵌套生成器表达式来避免：

```
 def getfirstattr(obj, *attrs):
     return next((val for val in (getattr(obj, attr, None) for attr in attrs)
                  if val is not None), None) 
```

但我真的不觉得这有什么大不了的。即使使用双重查找，生成器表达式也可能比普通的旧循环更快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T00:27:50.013

我认为使用 dir 会让你基本上做同样的事情`__dict__`......

```
targetValue = "value"
for k in dir(obj):
    if getattr(obj,k) == targetValue:
       print "%s=%s"%(k,targetValue) 
```

就像是

```
>>> class x:
...    a = "value"
...
>>> dir(x)
['__doc__', '__module__', 'a']
>>> X = x()
>>> dir(X)
['__doc__', '__module__', 'a']
>>> for k in dir(X):
...     if getattr(X,k) == "value":
...        print "%s=%s"%(k,getattr(X,k))
...
a=value
>>> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T00:32:30.630

根据您的对象的结构，可能有更好的方法来做到这一点，但不知道别的，这是一个递归解决方案，它与您当前的解决方案完全一样，除了它可以使用任意数量的参数：

```
g = lambda o, l: getattr(o, l[0], g(o, l[1:])) if l else None 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-11-28T00:45:58.793

还有一个：

```
reduce(lambda x, y:x or  getattr(obj, y, None),  "a b c".split(), None) 
```

（在 Python 3 中，您必须从 functools 导入 reduce。它是 Python 2 中的内置函数）

# azure - waIISHost 不会重新启动模拟的本地 azure

> ID：13595694
> 
> 赞同：1
> 
> 时间：2012-11-28T00:24:11.877
> 
> 标签：azure

我正在阅读 MSPRESS 书籍“Windows Azure Step by Step”。在第 55 页，作者建议将 Web 角色中的实例数增加到 5，然后运行该项目。他邀请读者杀死 WaIISHost 实例。

他建议应该有 10 个实例，尽管实例计数设置为 5。在我的机器上，只有 5 个 WaIISHost.EXE 进程实例。我认为配置实例的数量应该等于运行进程的数量，而不是作者所说的两倍，我错了吗？

如果我杀死一个进程，它不会重新启动。在 Compute Emulator UI 中，该编号实例的状态更改为问号，并且我在 UI 中看到被杀死的实例喷涌而出，说它不再知道自己的角色：

```
[fabric] Role state Destroyed
[fabric] Role state Unknown
[fabric] Role state Destroyed  
[fabric] Role state Unknown 
```

为什么计算模拟器不重新启动被杀死的进程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T08:58:54.617

几周前我在博客上写过这篇文章：[Controlling your instances in the Windows Azure Compute Emulator](http://fabriccontroller.net/blog/posts/controlling-your-instances-in-the-windows-azure-compute-emulator/)。尝试在没有调试器的情况下运行应用程序并杀死一个实例，这应该修复 Destroyed/Unknown 循环（尽管 1.8 sdk 应该与调试器一起使用）。

每个运行实例应该只有 1 个**WaIISHost.exe进程。**这意味着，启动 5 个实例将启动 5 个**WaIISHost.exe**进程。请注意，对于每个正在运行的实例，您还将拥有一个额外的**WaHostBootstrapper.exe**进程。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-28T02:46:23.717

如果 Azure 计算模拟器中只有 5 个实例，您的应用程序是否可以正常工作？

仔细检查项目引用的每个 Azure 程序集是否将复制到本地属性设置为 true。

希望这可以帮助。

# javascript - JavaScript - 仅解析部分 URL，而不是指定位置后的所有内容

> ID：13595699
> 
> 赞同：0
> 
> 时间：2012-11-28T00:24:47.967
> 
> 标签：javascript, jquery, regex, parsing, url

我有一个脚本 (JS) 可以解析 URL 后缀，然后从该数据中定义变量。

网址：**http ://www.example.com/somepage.html?bg=white&&accent=gray**

```
var PAGE = {
    bg: location.href.match(/bg=(.*)/)[1],
    accent: location.href.match(/accent=(.*)/)[1]
};

alert("Page Background: " + PAGE.bg + " \n Page Complements: " + PAGE.accent); 
```

请注意，url 从我创建的页面获取其参数，该页面在访问该页面之前进行（用户单击各种选项，然后单击“下一步”按钮）。
    一切都很好，除了return ，显然*在 之后*`PAGE.bg`返回了所有东西。我想知道如何*只*返回 BG，比如做一个 parseFloat或类似的东西，但作为 JavaScript 的初学者，我不知道该怎么做，这是一个详细的问题，所以我没有谷歌搜索它没有任何运气。有任何想法吗？任何帮助将非常感激。`white&&accent=gray` *`bg=`*`PAGE.bg`**

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:27:38.130

请尝试以下操作：

```
bg: location.href.match(/bg=([^&]*)/)[1], 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:28:48.613

为什么不使用现有的库？[URL.js](http://medialize.github.com/URI.js/)真是太棒了，并且完全符合您的要求。它可以从 URI 的查询参数创建散列。

有关使用搜索/查询字符串的确切文档，请参阅[此页面](http://medialize.github.com/URI.js/docs.html#accessors-search)。

```
var uri = new URI('http://www.example.com/somepage.html?bg=white&&accent=gray')
var PAGE = uri.search(true) 
```

这样，如果您稍后添加更多查询参数，您仍然会在对象表示中获取它们**

# c++ - 我做了什么？需要在模板类的方法中实例化派生类

> ID：13595702
> 
> 赞同：1
> 
> 时间：2012-11-28T00:25:01.713
> 
> 标签：c++, templates, inheritance

我有一堂课，说`A`

```
template <typename T> class A
{
} ; 
```

和一个派生自`A<T>`, 的类（保留类型通用性）

```
template <typename T> class B : public A<T>
{
} ; 
```

出现了一种情况，我需要`B<T>`在`A<T>`. 哦哦。

```
template <typename T> class A
{
    void go()
    {
        B<T> * newB = new B<T>() ; // oh boy, not working..
    }
} ; 
```

我应该怎么做以及如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:35:28.413

您需要打破两个类之间的循环依赖关系。在这种情况下微不足道：只需定义您的`go()`函数即可：

```
template <typename T> class A
{
public:
    void go();
} ;

template <typename T> class B : public A<T>
{
} ;

template <typename T>
void A<T>::go()
{
    B<T> * newB = new B<T>() ;
} 
```

我更喜欢行外定义，即使在内联函数时也是如此，因为它避免了不必要的细节使界面混乱。我也更喜欢没有循环依赖（当然不是在基数和派生数之间），但它不能总是避免。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T00:33:12.560

您可以在继承类模板`A`之前前向声明它——只要确保在同一个标​​题中遵循类`B`的定义和类`A`模板的定义：

```
template <typename T> class A;

template <typename T> class B : public A<T> {};

template <typename T> class A
{
    void go()
    {   
        B<T> * newB = new B<T>();
    }
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T00:39:12.597

另一种方法是编写一个全局函数，每个`template`类都[声明朋友](http://msdn.microsoft.com/en-us/library/h2x4fzdz%28v=vs.80%29.aspx)

```
void go( A<T> *a )
{
    // Can now make a B<T>
    B<T> *b = new B<T>() ;
    // access b's and a's privates if this function
    // is friend to A<T> and B<T>
} 
```

# c++ - 在没有库的情况下在 C 中解析 XML。

> ID：13595708
> 
> 赞同：2
> 
> 时间：2012-11-28T00:25:55.853
> 
> 标签：c++, c, xml, algorithm, parsing

谁能给我一个关于仅使用标准库在独立 C 中解析 xml 的过程的概述。

我想以此作为实践，因为这实际上是一个有用的项目。

我看到的大多数示例似乎都大量使用指针以及结构数组。因此，任何提示或大纲将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-28T00:29:43.997

好吧，你会看到两种不同的东西。首先是实现这一目标的高级策略。第二个是您用来完成它的数据结构和其他特定于语言的实现细节。

对于高级部分，一个好的起点是学习有限自动机。它们是一个非常强大的概念工具，用于规划解析和其他严重依赖状态的工作，并且很容易翻译成代码。

对于实现细节......好吧，有人已经指出了树结构。当您深入了解 XML 时，它基本上就是一棵树。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T02:18:09.563

它非常简单，您只需阅读文本并将其构建到对象树中。

如果您有以下简单的 XML：

```
<A>Hello<B x="1">World</B></A>
<A>Another Object A</A> 
```

你可以构建类似的东西：

```
Obj_1
  Name = "A"
  Text = "Hello"
  --> Obj_2
      Name = "B"
      Text = "World"
      Param_1 (Name = "x", Value = "1")
Obj_3
  Name = "A"
  Text = "Another Object A" 
```

使用像这样的简单类对象，您可以构建树（我意识到您询问过用常规 C 解析它，但您也将它标记为 C++，所以我的示例是用 C++ 编写的）：

```
class Obj
{
public:
  struct Param{
    std::string name;
    std::string value;
  };
  std::string      text;
  std::string      name;
  std::list<Param> params;
  std::list<Obj *> children;
}; 
```

然后你会想要添加一些帮助器来在值字符串（这就是 XML 是什么）之间转换为整数、双精度数、布尔值等，并清理额外的空白。您可能还想添加一些代码来获取所有名为“XYZ”的根对象，这样您就不必一直手动循环。

这应该让您知道从哪里开始。真的没那么难。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T04:25:34.473

扫描 xml 文件并检查到 ('>' 和 !='\n') 并开始将值存储到 '<'

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T03:14:42.210

If you don't want to use existing libraries, you will need to construct XML parser yourself. There's no way you can parse XML by hand efficiently.

I'd advise you to pick up basic concepts on:

1.  Regular Expressions
2.  DFA/NFA
3.  Lexer/Scanner
4.  Type of grammars (at least learn Regular Grammars & Context Free Grammars)
5.  BNF, EBNF
6.  Recursive Descent Parsing

Take this great course for free: [https://www.coursera.org/course/compilers](https://www.coursera.org/course/compilers)

If you are not constrained by time, take this as a learning opportunity.

Good luck!

# ruby - 从 Ruby 脚本开始 foreman

> ID：13595712
> 
> 赞同：0
> 
> 时间：2012-11-28T00:26:16.773
> 
> 标签：ruby, shell, foreman

我刚刚通过以下方式在我的项目中创建了一个脚本/运行：

```
#!/usr/bin/env ruby
# set some ENV variables..
`foreman start -f Procfile.dev` 
```

所以，我有一些问题：

1.  如果我`ENV["EMAIL_USERNAME"]`从 ruby​​ 脚本中设置 a，rails 可以读取它吗？
2.  以这种方式运行工头似乎不起作用。它只是卡住了。还有其他方法吗？

是的，我知道我不能将 ENV 变量导出到 PATH，但我希望我可以只将变量导出到应用程序。

PS：它也可以在 bash 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T10:43:08.403

好吧，我按照 glenn jackman 的链接让它工作了：[Spawn a background process in Ruby](https://stackoverflow.com/q/2504445/7552)

只需调用 exec 而不是将命令放在 ` 之间

谢谢。

# log4j - activemq 启动抑制 stdout/stderr

> ID：13595713
> 
> 赞同：1
> 
> 时间：2012-11-28T00:26:21.283
> 
> 标签：log4j, activemq, java-service-wrapper

当使用 AMQ 5.6 并使用`./activemq start`...启动代理时，stdout/stderr 去哪里了？

我希望它会出现在`/data/activemq.log`文件中，但它没有......是否有办法通过调整 log4j 或 JavaServiceWrapper 配置来解决这个问题？

当我使用 以控制台模式启动时`./activemq console`，stdout/stderr 消息按预期显示。特别是，`e.printStackTrace()`在此模式下运行时，我需要从中获取输出以显示在日志中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:50:48.387

它似乎只是被重定向到/ dev / null ...我将`/bin/activemq`脚本更改为重定向到`../data/start.log`，果然，stdout / err在那里...不知道为什么这不是诚实的默认行为.. .

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:39:53.293

如果我没记错的话，还有另一个名为 wrapper.log 的文件。在 wrapper.conf 所在的同一目录中查找它。

# java - 尽管类路径中有类，但 ClassNotFoundException

> ID：13595718
> 
> 赞同：0
> 
> 时间：2012-11-28T00:27:24.403
> 
> 标签：java, classnotfoundexception

ClassNotFoundException 问题是由 SO 上的几十个问题找到的，但即便如此，我在过去的答案中也没有找到我的问题的答案:( 基本上我在尝试使用命令提示符从命令行运行大型开源程序时得到 ClassNotFoundException项目文档中提供，提示如下：

```
java -cp "target/classes/*;../../Algotrader/code/target/classes/*;../../lib/*;../../target/*" -Dsimulation=true -DdataSource.dataSet=1year com.algoTrader.starter.SimulationStarter simulateWithCurrentParams 
```

（注意：原始命令实际上是 java.exe，但我将其更改为 java，因为 java.exe 在我的 Mac 上未被识别为命令）

**SimulationStarter**类抛出异常，如堆栈跟踪所示：

```
Exception in thread "main" java.lang.NoClassDefFoundError: com/algoTrader/starter/SimulationStarter
Caused by: java.lang.ClassNotFoundException: com.algoTrader.starter.SimulationStarter
    at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247) 
```

从 Eclipse 中我可以看到 SimulationStarter.class 在**AlgoTrader/code/target/classes/com/algoTrader/starter**中，它看起来与命令提示符中提供的路径一致。

所以我的问题是：除了类被错误地放置在类路径中之外，这个异常的原因可能是什么？

也不确定这有什么不同，但该项目保存在 svn 和 Maven 下，我在 Mac 上运行它。

**正确的类路径**

最后，命令提示符中给出的类路径有问题。正确的路径（至少是解决问题的路径）是：

java -cp "target/classes/:../../Algotrader/code/target/classes/:target/*" -Dsimulation=true -DdataSource.dataSet=1year com.algoTrader.starter.SimulationStarter simulationWithCurrentParams

与原始提示的主要区别是除去了星号，除了包含 jar 文件的文件夹和缩短基本类路径路径以仅捕获基本目录。还应使用“：”代替“；” 根据@reprogrammer 的回答，在 Mac 和 Linux 上

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T00:33:30.370

类路径语法取决于操作系统。Linux 和 Mac OS X 中的类路径分隔符`:`不是`;`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-28T00:37:44.530

你确定你需要那里的所有`*`东西吗？

通常，您需要提供类路径的*基本目录*，而不是子文件夹。

例如，当将您的应用程序构建到“bin”中时，您将使用`java -cp bin mainclass`，而不是`java -cp bin/*`！对的支持`*`通常有点不稳定，因为它是一个 shell 元字符，您需要正确引用。如果你有一个不正确的类路径，它*真的会搞砸你。*我见过人们因为添加`README.TXT`到类路径而遇到问题。

# javascript - jquery 查找任何具有 id 的孩子

> ID：13595721
> 
> 赞同：2
> 
> 时间：2012-11-28T00:27:34.580
> 
> 标签：javascript, jquery

我需要确定是否有一个 id 低于一组父级的 div。

条件1：

```
<div id="top">
<div></div>
<div></div>
<div></div>
</div> 
```

条件2：

```
<div id="top">
<div></div>
<div id="something"></div>
<div></div>
</div> 
```

我想知道元素顶部是否有任何具有指定 id 的 div 作为任何子元素。

我一直在尝试以下内容。

```
var test = $('#top').find('id'); 
```

但无论是否有一个带有 id 的 div，我都会得到相同的结果。

任何帮助都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T00:29:47.267

试试这个：

```
 var childrenWithId = $('#top [id]'); 
```

选择`[xx]`器测试属性 xx 的存在。您的代码所做的是寻找一个`<id>`元素。

编辑：您甚至可以具体说明您想要什么样的标签：

```
var divsWithId = $("#top div[id]"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:30:36.697

你的意思是`var test = $('#top').find('#id')?`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T00:33:11.430

尝试获取所有 div 并检查其 id 值，如下所示：

```
$("#top").find("div").each(function(){
    var id = $(this).attr("id")
    if(id.length > 0){
        alert("ID " + id + " is set.");
    }
}) 
```

# asp.net-mvc - AllowAnonymous 不使用自定义 AuthorizationAttribute

> ID：13595723
> 
> 赞同：59
> 
> 时间：2012-11-28T00:27:38.163
> 
> 标签：asp.net-mvc, authentication, attributes, asp.net-web-api

这让我难倒了一段时间。显然，常见的类似情况似乎都不适用于这里。我可能错过了一些明显的东西，但我看不到它。

在我的 Mvc Web 应用程序中，我使用 Authorize 和 AllowAnonymous 属性的方式是，您必须明确地将操作公开为公开可用，而不是锁定站点的安全区域。我更喜欢这种方法。但是，我无法在我的 WebAPI 中获得相同的行为。

我编写了一个继承自 System.Web.Http.AuthorizeAttribute 的自定义授权属性，其内容如下：

```
[AttributeUsage(AttributeTargets.Class | AttributeTargets.Method, Inherited = true, AllowMultiple = true)]
public class MyAuthorizationAttribute : System.Web.Http.AuthorizeAttribute 
```

我已将此注册为过滤器：

```
 public static void RegisterHttpFilters(HttpFilterCollection filters)
    {
        filters.Add(new MyAuthorizationAttribute());
    } 
```

这一切都按预期工作，没有凭据将不再可用。问题是现在以下方法将不允许 AllowAnonymous 属性执行此操作：

```
[System.Web.Http.AllowAnonymous]
public class HomeController : ApiController
{
    [GET("/"), System.Web.Http.HttpGet]
    public Link[] Index()
    {
        return new Link[] 
        { 
            new SelfLink(Request.RequestUri.AbsoluteUri, "api-root"),
            new Link(LinkRelConstants.AuthorizationEndpoint, "OAuth/Authorize/", "authenticate"),
            new Link(LinkRelConstants.AuthorizationTokenEndpoint , "OAuth/Tokens/", "auth-token-endpoint")
        };
    }
} 
```

最常见的情况似乎是混淆了两个 Authorize / AllowAnonymous 属性。System.Web.Mvc 用于 Web 应用程序，而 System.Web.Http 用于 WebAPI（无论如何我都理解）。

我使用的两个属性都来自同一个命名空间——System.Web.Http。我假设这只会继承基本功能并允许我在 OnAuthotize 方法中注入我需要的代码。

根据文档， AllowAnonymous 属性在我立即调用的 OnAuthorize 方法中起作用：

```
 public override void OnAuthorization(HttpActionContext actionContext)
    {
        base.OnAuthorization(actionContext); 
```

任何想法将不胜感激。

有没有人遇到过这个问题并找到了根本原因？

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2012-11-28T00:42:55.183

在 AuthorizeAttribute 中有以下代码：

```
private static bool SkipAuthorization(HttpActionContext actionContext)
{
    Contract.Assert(actionContext != null);

    return actionContext.ActionDescriptor.GetCustomAttributes<AllowAnonymousAttribute>().Any()
               || actionContext.ControllerContext.ControllerDescriptor.GetCustomAttributes<AllowAnonymousAttribute>().Any();
} 
```

将此方法包含在您的 AuthorizeAttribute 类中，然后将以下内容添加到 OnAuthorization 方法的顶部，以在找到任何 AllowAnonymous 属性时跳过授权：

```
if (SkipAuthorization(actionContext)) return; 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2014-12-01T10:52:20.100

**ASP.NET MVC 4：**

```
bool skipAuthorization = filterContext.ActionDescriptor.IsDefined(typeof(AllowAnonymousAttribute), true)
                         || filterContext.ActionDescriptor.ControllerDescriptor.IsDefined(typeof(AllowAnonymousAttribute), true); 
```

**或者**

```
 private static bool SkipAuthorization(AuthorizationContext filterContext)
    {
        Contract.Assert(filterContext != null);

        return filterContext.ActionDescriptor.GetCustomAttributes(typeof(AllowAnonymousAttribute), true).Any()
               || filterContext.ActionDescriptor.ControllerDescriptor.GetCustomAttributes(typeof(AllowAnonymousAttribute), true).Any();
    } 
```

来源：[http ://weblogs.asp.net/jongalloway/asp-net-mvc-authentication-global-authentication-and-allow-anonymous](http://weblogs.asp.net/jongalloway/asp-net-mvc-authentication-global-authentication-and-allow-anonymous)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2020-09-17T14:24:33.933

就我而言，上述解决方案均无效。我正在使用带有自定义功能的 .Net Core 3.1，`IAuthorizationFilter`我必须执行以下操作：

```
public void OnAuthorization(AuthorizationFilterContext context)
    {
        if (context.ActionDescriptor.EndpointMetadata.OfType<AllowAnonymousAttribute>().Any()) return; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-10-30T05:46:55.897

使用 MVC 5
步骤来克服这个问题：-
1\. 更新你的 WebAPI 项目的匿名属性，让它像

```
[System.Web.Mvc.AllowAnonymous] 
```

2.  现在转到您的自定义属性类并编写代码

    ```
     public override void OnAuthorization(System.Web.Http.Controllers.HttpActionContext filterContext)
    {
        if (filterContext == null)
        {
            throw new UnauthorizedAccessException("Access Token Required");
        }
        base.OnAuthorization(filterContext);
        if (filterContext.ActionDescriptor.GetCustomAttributes<AllowAnonymousAttribute>().Any())
        {
            return;
        }
        if (filterContext.Request.Headers.Authorization != null)
        {
            var response = 
     PTPRestClient.GetRequest(filterContext.Request.Headers.Authorization.ToString(), 
     "api/validate/validate-request");
            if (!response.IsSuccessStatusCode)
            {
                throw new UnauthorizedAccessException();
            }

        }
        else
        {
            throw new UnauthorizedAccessException("Access Token Required");
        }
    } 
    ```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-06-03T11:28:36.947

这是 ASP.NET Core 2+ 和 ASP.NET Core 3+ 的解决方案。将其添加到 IAsyncAuthorizationFilter 实现中：

```
private static bool HasAllowAnonymous(AuthorizationFilterContext context)
{
    var filters = context.Filters;
    return filters.OfType<IAllowAnonymousFilter>().Any();
} 
```

并像这样检查：

```
public async Task OnAuthorizationAsync(AuthorizationFilterContext context)
{
    if(HasAllowAnonymous(context))
        return;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-04-28T16:49:53.943

使用 C#6.0 创建一个扩展 ActionExecutingContext 的静态类。

```
public static class AuthorizationContextExtensions {
    public static bool SkipAuthorization(this ActionExecutingContext filterContext) {    
         Contract.Assert(filterContext != null);
         return filterContext.ActionDescriptor.GetCustomAttributes(typeof(AllowAnonymousAttribute), true).Any()|| filterContext.ActionDescriptor.ControllerDescriptor.GetCustomAttributes(typeof(AllowAnonymousAttribute), true).Any();
    }
} 
```

现在您的覆盖 filterContext 将能够调用扩展方法，只需确保它们在同一个命名空间中，或者包含正确的 using 语句。

```
[AttributeUsage(AttributeTargets.Class | AttributeTargets.Method, Inherited = true, AllowMultiple = true)]
public class AuthorizeCustomAttribute : ActionFilterAttribute {
    public override void OnActionExecuting(ActionExecutingContext filterContext) {
        if (filterContext.SkipAuthorization()) return;// CALL EXTENSION METHOD
         /*NOW DO YOUR LOGIC FOR NON ANON ACCESS*/
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-08-28T09:36:00.910

我必须使用不同版本的 .net 框架或 web api，但希望这可以帮助某人：

```
 bool skipAuthorization = actionContext.ActionDescriptor.GetCustomAttributes<AllowAnonymousAttribute>().Any() || actionContext.ActionDescriptor.ControllerDescriptor.GetCustomAttributes<AllowAnonymousAttribute>().Any();
        if (skipAuthorization)
        {
            return;
        } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-08-16T11:02:11.877

```
public class MyAuthorizationAuthorize : AuthorizeAttribute, IAuthorizationFilter
{
public override void OnAuthorization(AuthorizationContext filterContext)
        {
            if (filterContext.HttpContext.Request.IsAuthenticated)
            {
                bool skipAuthorization = filterContext.ActionDescriptor.IsDefined(typeof(AllowAnonymousAttribute), true) ||
                    filterContext.ActionDescriptor.ControllerDescriptor.IsDefined(typeof(AllowAnonymousAttribute), true);

                if (skipAuthorization) return;

            }
            else filterContext.Result = new HttpUnauthorizedResult();
        }
} 
```

# apache - Nginx、Apache 和 Plesk

> ID：13595727
> 
> 赞同：0
> 
> 时间：2012-11-28T00:28:11.033
> 
> 标签：apache, nginx, reverse-proxy, plesk

我目前正在尝试减轻我的 Apache Web 服务器的负载。这个想法是让 nginx 处理静态文件。

该程序是简单的 nginx pass-> 8080 到 Apache。只有一个问题。

服务器安装了 Plesk，Plesk 使用每个 vhost 文件夹/配置中的 .include 文件处理 vhost。

每个 vhost 在他自己的 .include 文件中都有不同的端口和设置，这使得在全局级别上将 Apache 端口更改为 8080 是不可能的。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T05:47:47.743

如前所述，最好使用最新的 plesk 11，因为它具有原生 nginx 支持并且现在实际上已经稳定了。

由于 Plesk 9.5 似乎能够通过[/usr/local/psa/admin/bin/websrvmng检查](ftp://download1.swsoft.com/Plesk/Panel9.5/Doc/en-US/plesk-9.5-unix-advanced-administration-guide.pdf)[此 pdf](ftp://download1.swsoft.com/Plesk/Panel9.5/Doc/en-US/plesk-9.5-unix-advanced-administration-guide.pdf)中的 --set-http-port 和 --get-http-port来更改 apache 端口

自 Plesk 10.2 起，可以通过 plesk 数据库[http://kb.parallels.com/11232在全局级别更改 apache 端口](http://kb.parallels.com/11232)

# c++ - 为什么一个循环需要 current->link !=NULL 和一个 current != NULL 用于我的链表？

> ID：13595729
> 
> 赞同：0
> 
> 时间：2012-11-28T00:28:38.027
> 
> 标签：c++, linked-list

我为一个学校项目写了几个函数，我让它们工作，但我不明白为什么。它们应该是相同的，但它们只有在一个检查 current->link 而另一个检查 current 本身时才有效。两个循环都不应该是当前的！= NULL吗？

**这两个函数在 main 中调用，如下所示：**

```
customerHead = fillCart(limit, lowLevelInv); //fills linked list
totCart(customerHead, lowLevelInv);                 
printCart(customerHead, lowLevelInv); 
```

**仅当 while 循环检查 current != NULL 时才有效**

```
int totCart(OrderPtr head, inventory lowLevelInv[])
{
OrderPtr current;
current = head;
int tot = 0;

while(current != NULL)
{
    tot += lowLevelInv[current->itemID].cost*current->qtyReceived;
    current = current->link;
}
cout<<"Cart total is: "<<tot<<endl;
return tot;
} 
```

**这个只有在 while 循环检查 current->link !=NULL 时才有效**

```
void printCart(OrderPtr head, inventory lowLevelInv[])
{
OrderPtr current;
current = head;

cout<<"you have ordered: \n";

while(current->link != NULL);
{
    cout<<current->orderID<<": "<<current->qtyReceived<<" "    <<lowLevelInv[current->itemID].name<<" for "<<lowLevelInv[current->itemID].cost*current->qtyReceived<<endl;
    current = current->link;
} 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:44:10.733

看起来问题在这里：

```
while(current->link != NULL);
{
    cout<<current->orderID<<": "<<current->qtyReceived<<" "    <<lowLevelInv[current->itemID].name<<" for "<<lowLevelInv[current->itemID].cost*current->qtyReceived<<endl;
    current = current->link;
} 
```

如果你仔细看，你会在“while”语句中的控制语句后面有一个虚假的分号。这意味着如果 current->link 不为空，您的程序将挂起，因为不会更改 current->link 或 current->link。

如果这实际上不是您的问题（例如，由于复制面食问题），您应该向我们展示您是如何构建您的列表的，以及“不起作用”的具体含义。

# macos - 如何在 Mac OS X Mountain Lion 上构建 mod_jk？

> ID：13595730
> 
> 赞同：6
> 
> 时间：2012-11-28T00:28:40.907
> 
> 标签：macos, apache, osx-mountain-lion, mod-jk

我按照`native`目录中BUILDING.txt中的说明执行了

```
./configure --with-apxs=/usr/sbin/apxs 
```

这是一些输出

```
building connector for "apache-2.0"
checking for gcc... /Applications/Xcode.app/Contents/Developer/Toolchains/OSX10.8.xctoolchain/usr/bin/cc
checking for C compiler default output file name... configure: error: C compiler cannot create executables
See `config.log' for more details. 
```

自然，我在 StackOverflow 上搜索了解决方案，因为 gcc 不在`/usr/bin`. 所以我打开了 XCode 并安装了命令行工具。GCC 现在在 /usr/bin ...但我不断收到同样的错误。

有任何想法吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-28T00:28:40.907

经过一个小时的挖掘，我终于遇到了[这篇文章](https://stackoverflow.com/questions/10357804/configure-error-c-compiler-cannot-create-executables/10358412#comment18636594_10358412)并添加了解决我问题的回复。

所以首先你需要从 XCode 安装命令行工具然后你必须通过执行创建这个符号链接

```
sudo ln -s /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain /Applications/Xcode.app/Contents/Developer/Toolchains/OSX10.8.xctoolchain 
```

这是苹果在 Mac OS X 10.8 中提供的 APXS 的问题。配置脚本尝试通过执行来查找 C 编译器`/usr/sbin/apxs -q CC`。路径输出不正确或 Apple 在安装 10.8 时忘记为您创建符号链接。

创建符号链接后，一切都会好起来的，您将能够编译 mod_jk

# ios5 - __NSCFString setHidden：无法识别的选择器发送到实例

> ID：13595737
> 
> 赞同：0
> 
> 时间：2012-11-28T00:28:57.957
> 
> 标签：ios5, hidden, nscfstring

我有一些 UILabel 已被声明为属性并合成。我将这些标签隐藏在`viewDidLoad`. 经过一些计算，当我尝试使用`hidden`属性取消隐藏它们时，应用程序崩溃并出现主题中提到的错误。我试图`NSLog`知道它是否已被释放，但它向我展示了标签的精细值。请有人可以帮助我，当我正常访问它时，内存管理问题在哪里。谢谢。

显示一些代码供参考：

在 .h 文件中：

```
@interface abc : UIViewController{
   UILabel *value;
}

@property(nonatomic,retain) IBOutlet UILabel *value; 
```

在 .m 文件中：

```
@synthesize value;

-(void) viewDidLoad
{
value.hidden = YES;
}

-(IBAction) calculate:(id)sender

//On some button click, assign some value to label and unhide it

NSLog(@"%@",value); //perfectly OK
value.hidden = NO; //throws exception here

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T02:12:36.633

该错误是因为标签被释放并被分配给`NSString`. 检查您如何为标签设置值。当在参数上调用 hidden 属性时，您应该分配一个`NSString`to `UILabel`which 导致它抛出此错误。`value`

# vba - VBA中的引号

> ID：13595741
> 
> 赞同：6
> 
> 时间：2012-11-28T00:29:29.557
> 
> 标签：vba, double-quotes

在我当前的 VBA 代码中，我有一个查询，用于在我的`Chr(34)`一些变量之间加上引号。

我想知道有什么替代方案。这是一个简单的问题，我知道，但我没有成功重复这样的引号

> `"`& 这里的变量字符串 &`"`

我的代码对一个人来说很乱，对于不熟悉 VBA 的人来说是无法理解的：

```
comboService = Chr(34) & Me.Combo8.Value & Chr(34) 
```

此外，这没有奏效：

```
comboService = """" & Me.Combo8.Value & """" 
```

你能告诉我为什么吗？

提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-28T01:09:15.233

这：

```
comboService = """ & Me.Combo8.Value & """ 
```

是您发布的内容，但您需要添加额外的引号才能添加文字引号：

```
comboService = """" & Me.Combo8.Value & """" 
```

字符串中的双引号是您要查找的内容。

```
aVar = "This: "" is a literal quotation mark" 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-02-13T19:29:36.123

不久前，我从 MS （旧`vbCRLF`）中获取了一个页面，并将我需要的任何“棘手”字符定义为代码顶部的字符串......

```
Dim vbDblQuote As String
vbDblQuote = Chr(34) 
```

现在您可以在构建字符串时使用该伪常量...

```
strMyString = "Just another string " & vbDblQuote & "with quotes" & vbDblQuote & "!" 
```

这使代码更具可读性，也有助于避免“错误引用错误”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-06T19:55:18.757

如果我使用 Write 命令输出到文件，我会发现相同的行为。任何双引号都会重复。

但是，如果您构造字符串，然后使用 Print 命令输出到文件，则不会发生这种情况，并且一切都按预期工作。

# c++ - 在 C++ 的函数调用中使用模板定义的变量

> ID：13595744
> 
> 赞同：0
> 
> 时间：2012-11-28T00:29:34.817
> 
> 标签：c++, function, templates, tree

我有一个函数，我要为其传递一个变量；但是，该变量是一个模板变量。我不知道我应该如何使用模板参数创建函数的细节。我什至不知道我问的问题是否正确，但是当我编译程序时，`main.cpp`文件中出现以下错误：

```
line 17   error: no matching function for call  to 'BSTree<int>::BSTinsert(TNode<int>&)'
line 49   error note: candidates are: void BSTree<T>::BSTinsert(const T&) [with T = int] 
```

我认为我做的一切都是正确的，但这是阻碍我继续前进的一个错误。欢迎和感谢任何和所有帮助！（我不认为需要显示其他两个文件 -`treeNode.h`和`treeNode.cpp`- ，但我以前错了。如果是，请让我知道，我很乐意发布它们。再次感谢您！

主.cpp：

```
#include <iostream>
#include <string>

#include "BSTree.cpp"

using namespace std;

int main()
{
    BSTree<int> bt;
    TNode<int> item;

    for(int i=0; i<13; i++)
    {
        cout << "Enter value of item: ";
        cin >> item;
        bt.BSTinsert(item); //this is the line with the error
    }

    cout << "Hello world!" << endl;
    return 0;
} 
```

BSTree.h：

```
#ifndef BSTREE_H_INCLUDED
#define BSTREE_H_INCLUDED

#include "treeNode.cpp"

template <typename T>
class BSTree
{
    TNode<T> *root;
    void insert(TNode<T> * & r, const T & item);
public:

    BSTree();
    TNode<T>* getRoot();
    void BSTinsert(const T & item);
};

#endif // BSTREE_H_INCLUDED 
```

BSTree.cpp：

```
#include <iostream>
#include <string>
#include "BSTree.h"

template <typename T>
void BSTree<T>::insert(TNode<T> * & r, const T & item)
{
    if(r == NULL)
        TNode<T> newNode = new TNode<T>(item);
    else if(r == item)
        return;

    else if(r->nodeValue > item)
        insert(r->leftChild, item);
    else if(r->nodeValue > item && r->leftChild == NULL)
    {
        TNode<T> newNode = new TNode<T>(item);
        r->leftChild = newNode;
        newNode->parent = r;
    }

    else if(r->nodeValue < item)
        insert(r->rightChild, item);
    else if(r->nodeValue < item && r->rightChild == NULL)
    {
        TNode<T> newNode = new TNode<T>(item);
        r->rightChild = newNode;
        newNode->parent = r;
    }
}

template <typename T>
BSTree<T>::BSTree()
{
    root = NULL;
}

template <typename T>
TNode<T>* BSTree<T>::getRoot()
{
    return root;
}

template <typename T>
void BSTree<T>::BSTinsert(const T& item) //this is the line the note is referring to
{
    TNode<T> tempRoot = getRoot();
    insert(tempRoot, item);
} 
```

树节点.cpp：

```
#include <string>
#include <iostream>
#include "treeNode.h"

using namespace std;

template <typename T>
TNode<T>::TNode()
{
    parent = NULL;
    leftChild = NULL;
    rightChild = NULL;
    nodeValue = 0;
}

template <typename T>
TNode<T>::TNode(const T&item, TNode<T> *left, TNode<T> *right, TNode<T> *par)
{
    parent = par;
    leftChild = left;
    rightChild = right;
    nodeValue = item;
}

template <typename T>
void TNode<T>::printNodeInfo()
{
    cout << "Value: " << nodeValue << endl;
    if(parent != NULL)
        cout << "Parent Value: " << parent << endl;
    if(leftChild != NULL)
        cout << "Left Child Value: " << leftChild << endl;
    if(rightChild != NULL)
        cout << "Right Child Value: " << rightChild << endl;
} 
```

树节点.h：

```
#ifndef TREENODE_H_INCLUDED
#define TREENODE_H_INCLUDED

template <typename T>
class TNode
{
public:
    T nodeValue;
    TNode<T> *leftChild, *rightChild, *parent;

    TNode();
    TNode(const T&item, TNode<T> *left = NULL, TNode<T> *right = NULL, TNode<T> *par = NULL);
    void printNodeInfo();

    friend std::istream& operator>>( std::istream& i, TNode<T>& item ){return i;}
};

#endif // TREENODE_H_INCLUDED 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:37:25.303

这能解决你的问题吗？

```
int main()
{
    BSTree<int> bt;
    int item;

    for(int i=0; i<13; i++)
    {
        cout << "Enter value of item: ";
        cin >> item;
        bt.BSTinsert(item); //this is the line with the error
    }

    cout << "Hello world!" << endl;
    return 0;
} 
```

# breeze - 防范恶意数据更改的策略

> ID：13595745
> 
> 赞同：3
> 
> 时间：2012-11-28T00:29:42.250
> 
> 标签：breeze

寻找防范恶意数据更改的想法：userA 操作（编辑或删除）属于 userB 的数据。由于我们在客户端上创建实体，我们需要将它们（或至少其中一些）分配给经过身份验证的用户。

例如：

```
var newItem = ds.createNewItem();
newItem.OwnerId(22); //this is the problem that I see.    
newItem.Name("New Item");
newItem.Description("I just changed your item!");
... //and so on
ds.saveChanges(); 
```

假设我们知道调用我们 API 的用户的身份，`SaveChanges`我们如何针对该用户验证我们的实体（新的或修改的）？

想到的第一个想法是根据我们用户的身份继承`EFContextProvider`、覆盖`BeforeSaveEntity`和检查实体属性。`OwnerId`例如：

```
if (entityInfo.Entity.GetType() == typeof(Item)
    && (entityInfo.EntityState == EntityState.Added 
    || entityInfo.EntityState == EntityState.Modified)
    && ((Item)entityInfo.Entity).OwnerId != _currentUserId) {
    return false
    ... //and so on 
```

`_currentUserId`如果使用这种方法，在我们的新类的构造函数中建立是否有意义`EFContextProvider`？

解决这个问题的想法或更好的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-28T09:37:29.850

我认为你在正确的轨道上。我自己一直在研究这个，并且走上了同样的道路。

假设您已经处理了身份验证并且有一个`IPrincipal`可用的。您也有自己的自定义`IIdentity`（称为它`AppIdentity`），您可以在其中`UserId`为经过身份验证的用户存储。

Web Api 的基类通过其属性`ApiController`使环境`IPrincipal`可用。`User`我们将在您的自定义 Breeze Web Api 控制器中利用它，它可能会像这样开始：

```
[授权]
[JsonFormatter，ODataActionFilter]
公共类 BreezeApiController : ApiController
{
    私有只读 AppContextProvider _context;

    公共 BreezeApiController() {
        // 将 'User' IPrincipal 传递给上下文 ctor
        _context = new AppContextProvider(User);
    }

    ...

    // 查询操作方法之一
    [HttpGet]
    公共 IQueryable<Foo> Foos() {
        返回 _context.Foos
    }

    ...

```

您的自定义`EFContextProvider`可能会像这样开始：

```
公共类 AppContextProvider : EFContextProvider<AppDbContext>
{
    公共 AppContextProvider（IPrincipal 用户）
    {
        UserId = ((AppIdentity) user.Identity).UserId;
    }

    公共 int 用户 ID { 获取；私人套装；}
    ...

```

现在您可能想要阻止 UserA 看到 UserB 的实体。因此，您的自定义可以相应地过滤，而不是让每个`Foo`人都出门。`EFContextProvider`

```
   公共 DbQuery Foos
   {
       得到
       {
           // 这里的 'Context' 是你的 EF DbContext
           返回 (DbQuery) Context.Foos
               .Where(f => f.UserId == UserId);
       }
   }

```

回头看控制器，我们看到它的`Foos`GET 操作方法忽略了过滤器......正如它应该的那样。我们希望我们的控制器是轻量级的，并将业务逻辑移至自定义`EFContextProvider`及其助手。

最后，高度简化的通用用途`BeforeSaveEntity`可能如下所示：

```
私有 bool BeforeSaveEntity（EntityInfo 信息）
{
    var entity = info.Entity;
    如果（info.EntityState == EntityState.Added）
    {
        实体.用户 ID = 用户 ID；
        返回真；
    }
    返回 UserId == entity.UserId || throwCannotSaveEntityForThisUser();
}

...

私人布尔 throwCannotSaveEntityForThisUser()
{
    throw new SecurityException("未经授权的用户");
}

```

请注意，服务器上的自定义上下文提供程序负责设置`UserId`添加的实体。无论如何，我们都不相信客户会这样做。当然，它负责验证`UserId`修改和删除的实体。

希望这可以帮助。**请记住，这只是一个草图**。真正的交易将更加复杂，并被重构为助手。

# c++ - 用 C/C++ 编写的通用代码完成框架

> ID：13595747
> 
> 赞同：4
> 
> 时间：2012-11-28T00:29:43.617
> 
> 标签：c++, c, parsing, code-completion

是否有任何用 C/C++/C++11 编写的框架来编写代码完成工具？或者也许有一些库允许 Java 或 C++ 的代码完成（也是用 C++ 编写的？）。我正在用 C++ 编写用于 Java（而不仅仅是 Java）开发的自定义 IDE，我想以最好的方式为其添加代码完成支持，而不是重新发明轮子；）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:37:09.620

clang_complete 是一个 vim 插件，用于准确完成 C、C++、Objective-C 和 Objective-C++ 代码：[https](https://github.com/Rip-Rip/clang_complete/) ://github.com/Rip-Rip/clang_complete/ 它使用 clang - 一个用 C++ 编写的开源 C++ 编译器来完成工作。我想你可能会发现它很有用。

# asp.net-mvc - MVC 4 Web API 路由

> ID：13595758
> 
> 赞同：0
> 
> 时间：2012-11-28T00:30:42.257
> 
> 标签：asp.net-mvc, asp.net-web-api, asp.net-mvc-routing

我正在寻找有关如何在 Web API 项目中设置路由的提示。我设置了一个名为 Resident 的控制器，其方法如下：

```
public ResidentModel GetResidentInfo(int resId)
{
    //code to return ResidentModel object 

} 
```

我尝试了以下方法来映射到 route.config 文件中的此方法。

```
 routes.MapRoute(
            name: "Resident",
            url: "{controller}/{action}/{id}",
            defaults: new {  id = UrlParameter.Optional }
            ); 
```

我正在尝试通过多种方式访问​​此方法：

```
http://localhost/resident/1 or 
http://localhost/resident/GetResidentInfo/1 etc... 
```

我正在寻找有关设置控制器然后映射到该控制器方法的过程的一些指导，因为当我尝试访问我创建的方法时它无法识别它们。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T00:48:16.267

首先，您的控制器类应该被调用`ResidentController`（不仅仅是`Resident`）并继承自`ApiController`（它确实需要实现`IHttpController`，但从该类继承是最简单的方法）。

其次，您应该使用`MapHttpRoute`而不是`MapRoute`用于 Web API 控制器。

接下来，`id`路由上的参数与您的操作中的参数不匹配。如果您有如下路线，您应该能够访问第二个 URL：

```
routes.MapHttpRoute(
    name: "WithAction",
    routeTemplate: "{controller}/{action}/{resId}"); 
```

这将匹配第一个：

```
routes.MapHttpRoute(
    name: "DefaultAction",
    routeTemplate: "{controller}/{resId}",
    defaults: new { action = "GetResidentInfo" }); 
```

# r - 确保在运行 .Rprofile 之前加载所有默认包

> ID：13595759
> 
> 赞同：7
> 
> 时间：2012-11-28T00:30:53.863
> 
> 标签：r, rstudio

我已经设置了几个 RStudio 项目来自动完成多项选择测试等任务。完成任务所需的功能只是保存在一个文本文件中，并确保它们可供我或其他用户使用，我一直在使用一个`.Rprofile`文件，该文件只是`source("MyFunctions.R")`在启动时运行。如果`.Rprofile`文件位于 RStudio 项目的基目录中，则在打开项目时会自动运行

但是，我偶尔会遇到错误，即在获取脚本之前未加载基本 R 包提供的函数，例如`read.csv`or之类的函数`installed.packages`：

```
Error in eval(expr, envir, enclos) : 
  could not find function "installed.packages" 
```

是否有某种方法可以在运行之前等待默认包加载`source()`，而不是`library()`为所有无法加载的默认包添加显式调用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-28T00:42:29.693

这`?Startup`似乎非常确定：

> 请注意，当站点和用户配置文件获取源时，仅加载“基本”包，因此**其他包中的对象需要通过例如“utils::dump.frames”或在显式加载相关包后引用**。

根据该明确建议，使用`library()`加载必要的包看起来是您最好的选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T00:59:25.553

乔希的回答指出了`?Startup`文档，看起来`.First.sys()`在顶部添加一个调用`.Rprofile`可能是一个选项，因为这似乎是处理所有默认包的加载的函数。它通常在 之后运行`.Rprofile`，这可以解释我遇到的错误。

# c# - 如何从 TabPage 集合中获取 PropertyGrid

> ID：13595760
> 
> 赞同：0
> 
> 时间：2012-11-28T00:31:02.737
> 
> 标签：c#, winforms, propertygrid, tabpage, generic-collections

我创建了**newPropertyGrid**并将其添加到**newTabPage**。我将所有 newTabPage 保存到 lstTankTabPages（通用集合）。我想在属性网格中的数据更改以更改主窗体上的自定义控件时引发一个事件。*我的问题，如何从**lstTankTabPages获取所有****newPropertyGrid*****？谢谢你。**

 **```
 for (int i = 0; i < Modules.tankQuantity; i++)
    {
        string name = string.Format("Tank{0}", i + 1);

        // create newTabPage
        TabPage newTabPage = new TabPage(name);
        newTabPage.Name = string.Format("tabPage{0}", name);

        // create newPropertyGrid 
        PropertyGrid newPropertyGrid = new PropertyGrid();
        newPropertyGrid.Name = string.Format("propertyGrid{0}", name);
        newPropertyGrid.BrowsableAttributes = new AttributeCollection(new DisplayModeAttribute("Ullage,Gross,Netto,Water,Temperature,Density,Capacity,Connection,Appearance"));
        newPropertyGrid.SelectedObject = new TankInventoryCustom();

        // add newPropertyGrid to newTabPage
        newTabPage.Controls.Add(newPropertyGrid);

        // add newTabPage to tabControl
        this.tabControlTankInventory.TabPages.Add(newTabPage);

        // add newTabPage to collection
        Modules.lstTankTabPages.Add(newTabPage);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:54:53.927

假设 Modules.lstTankTabPages 是

```
List<TabPage> 
```

那么这是获取您在该循环中创建的 PropertyGrids 的一种方法

```
foreach(TabPage page in Modules.lstTankTabPages) {
    PropertyGrid newPropertyGrid = (PropertyGrid)page.Controls[0];
    // do something with it
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T01:02:24.407

您可以使用“OfType”获取所有 PropertyGrid 项目

```
foreach (TabPage page in Modules.lstTankTabPages)
{
    PropertyGrid newPropertyGrid = page.Controls.OfType<PropertyGrid>().FirstOrDefault()
    if (newPropertyGrid != null)
    {
        // do something with it
    }
} 
```**

# c - 如何在我自己的自定义 shell 中实现连接到远程 shell？

> ID：13595761
> 
> 赞同：0
> 
> 时间：2012-11-28T00:31:12.390
> 
> 标签：c, linux, shell

我目前正在为操作系统类的项目编写自定义外壳。我有基本的功能，以及重定向、管道和其他东西。我正在使用*execvp()*命令来执行 PATH 变量中已经存在的命令。

此 shell 的要求之一是远程连接到另一台计算机，类似于在 linux 上执行的方式，如*ssh root@hostname*。当然，它不必是安全的或任何像 SSH 的东西，只是基本的远程功能。

我不知道如何解决这个问题。欢迎任何关于从哪里开始或如何解决问题的提示。

谢谢！

环境：Ubuntu 12.10 用 Clang 编译

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:40:28.537

传统的 shell 不参与远程处理；ssh 完成了所有这些，还有 sh/bash/ksh/etc。在建立连接后运行。

当您登录到用户帐户时，`/etc/passwd`将运行配置的 shell。您所要做的就是在您的用户条目中列出您的 shell。`chsh`您可以使用或`/etc/passwd`手动编辑来设置用户的外壳。

您可能还想将您的 shell 添加到`/etc/shells`.

# django - 名称错误 Django

> ID：13595764
> 
> 赞同：0
> 
> 时间：2012-11-28T00:31:20.127
> 
> 标签：django

尝试运行我的项目时出现名称错误，

网址.py

```
import os
from django.conf.urls.defaults import patterns, include, url
#from bookmarks.views import *
from django.views.generic.simple import direct_to_template
from preview.views import *
# Uncomment the next two lines to enable the admin:
# from django.contrib import admin
# admin.autodiscover()

urlpatterns = patterns('',

    (r'^catalog/$', home),
) 
```

视图.py

```
# Create your views here.
from django.shortcuts import render_to_response

def home(request):
    return render_to_response("index.html") 
```

索引.html

```
{% extends base.html %}
{% block content %}
    <h2>Welcome!</h2>
{% endblock %} 
```

设置.py

```
TEMPLATE_DIRS = (
    "C:/python27/Djangoprojects/ecomstore/preview",
    # Put strings here, like "/home/html/django_templates" or "C:/www/django/templates".
    # Always use forward slashes, even on Windows.
    # Don't forget to use absolute paths, not relative paths.
) 
```

错误

```
NameError at /catalog/
name 'home' is not defined
Request Method: GET
Request URL:    http://127.0.0.1:8000/catalog/
Django Version: 1.3.1
Exception Type: NameError
Exception Value:    
name 'home' is not defined
Exception Location: C:\Python27\Djangoprojects\ecomstore\..\ecomstore\urls.py in <module>, line 12
Python Executable:  C:\Python27\python.exe
Python Version: 2.7.2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:44:34.617

`home`在你的`preview/views.py`档案里吗？不知何故，您`from preview.views import *`没有将其导入。

在这种情况下，你可以尝试做

```
urlpatterns = patterns('preview.views',

    (r'^catalog/$', 'home'),
) 
```

反而？

并仔细检查该`preview`应用程序是否包含在文件的`INSTALLED_APPS`元组中`settings.py`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:43:38.297

这是一个非常直接的错误。“家”没有定义。

你还没有导入它。

想想当你打开一个 python 终端并输入时会发生什么

```
> foobar
> # NameError 
```

将其导入您的 urls.py 或使用字符串表示法`'myapp.views.myfunc'`

# html - 在html中显示xml？

> ID：13595766
> 
> 赞同：0
> 
> 时间：2012-11-28T00:31:41.960
> 
> 标签：html, xml

我从 jQuery ajax 获取 xml，发现您可以使用以下内容来显示 xml：

```
$.ajax.({...
...
success: function(xml, textStatus, jqXHR) {    
$("#mydiv").text(jqXHR.responseText); 
```

是否可以在树结构中显示格式良好的 xml，在 Chrome 或 Firefox 中仅使用 jQuery 和 HTML？

你知道如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:36:43.983

```
<!-- HTML -->
<pre id="display"></pre>

// JS
var xmlStr = (new window.XMLSerializer()).serializeToString(xmlNode);
document.getElementById('display').innerText = xmlStr; 
```

# arrays - 为什么哈希表在存储桶的数组上使用链表？

> ID：13595767
> 
> 赞同：8
> 
> 时间：2012-11-28T00:31:46.580
> 
> 标签：arrays, linked-list, hashtable

当一个值被哈希到相同的值时，它被添加到哈希值引用的链表中。为什么哈希表的实现使用数组上的链表作为存储桶？

是因为数组在初始化时具有预定的大小，因此当向存储桶中添加太多元素时需要调整大小？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-28T00:53:50.857

是的：通常，这是因为数组具有预定的大小。桶不需要使用链表或数组；一些狡猾的实现使用另一个哈希表，*然后*使用链表或数组作为它的桶！

如果使用数组，则哈希表对每个数组元素都有一个预先确定的大小。每个可能的存储桶都已分配，您的哈希表可能非常大。如果你有很多内存，或者你期望一个非常完整的哈希表，那可能没问题。您可以通过持有指向数组的指针并根据需要分配它来缓解这种情况。

数组可以被索引，所以你可以保持数组排序。然后，如果它变大，您可以进行二进制搜索以找到您想要的密钥。

如果使用链表，则必须遍历链表以线性查找所需的匹配项。这不是太有效，但它最大限度地减少了内存使用。

与所有数据结构问题一样，您必须考虑您将拥有哪些访问模式以及如何使用和填充结构；您想赢得哪些权衡，哪些是您不太关心的权衡？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-28T00:58:25.113

他们没有。

声称“哈希表的实现”使用链表是一种过度概括。Java 可以。许多其他语言没有。例如，Python 使用开放散列，请参阅此问题的答案，[如何实现 Python 的内置字典](https://stackoverflow.com/q/327311)

通常，通用 API 的设计者面临着一个非常艰难的选择，因为他们不了解用户的用例。有不同的实现选择和不同的权衡，例如，如果你只添加元素但从不删除，则与经常变异的 hashmap 不同的选择适用。等等。

# map - 在自己的服务器上解决地理位置

> ID：13595768
> 
> 赞同：2
> 
> 时间：2012-11-28T00:31:52.677
> 
> 标签：map, geolocation, coordinates, geocoding, openstreetmap

> **免责声明：**任何**API**对我来说都是**没有选择**的，因为我想要处理**大量的地方。**我知道那里有很多服务，但我想有**自己的解决方案**

好的，在这里说完我的问题之后:)

有像[OpenStreetMap](http://www.openstreetmap.org/)这样的平台，也许还有其他平台在将地图世界带入​​开源社区方面做得很好。

**我需要的**

我有一个位于世界任何地方的地址，我想计算纬度和经度，海拔会很好，但并不重要。

我已经看到围绕 OpenStreetMap 提供的大量解决方案来生成自定义地图、为“类似 Google”的网络地图体验生成地图图块等。

我无法想象数据看起来如何能够从中创建详细的地图，但如果我能够生成地图，甚至将指针放在特定的 POI 或地址或坐标上 - 也必须可以反过来做.

**那里的地图大师**为我指明了正确的方向:) 任何在 linux 上运行的任何工具、任何免费可用的数据库以及任何一段代码或算法来计算我的地址中的 11.12345、44.12425 样式的点都会有所帮助 - 只要它不依赖股票公司或网络服务。

到目前为止，谷歌在这项工作上做得很好，但他们最近变得贪婪了 :)

如果这也有助于我理解如何渲染漂亮的地图，我绝对不会拒绝

**我可以做什么**

我非常擅长处理规范化和匹配，所以这不是问题。但我需要一些提示和数据源从哪里开始挖掘。

**编辑1：**

当然，可能的分辨率取决于可用的数据质量。我希望至少能够在全球范围内保持准确。有些地区在谷歌上甚至没有街道，所以这些丛林当然对于 100m 精度无关紧要

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T10:30:58.563

OpenStreetMap 使用[Nominatim](http://wiki.openstreetmap.org/wiki/Nominatim)进行地址查找和反向地理编码。您可以在服务器上[安装](http://wiki.openstreetmap.org/wiki/Nominatim/Installation)本地实例，[导入 OSM 数据库](http://wiki.openstreetmap.org/wiki/Nominatim/Installation#Import_and_index_OSM_data)，然后在其上运行您自己的查询。

# haskell - 使用 GHCi 扩展类型同义词、类型族

> ID：13595773
> 
> 赞同：24
> 
> 时间：2012-11-28T00:32:19.753
> 
> 标签：haskell, ghci, type-families

我想知道 GHCi（或其他地方）中是否存在从任意类型表达式中扩展类型同义词和族的功能。

例如，如果我有这些类型，

```
data A = A
data B = B

data F a = F a
data G a = G a
data H a b = H a b

type S a b = H (F a) (G b)
type T a = S (a) (H B a)

type family R a :: *
type instance R (H a b) = H b a 
```

那么我希望能够在 ghci 会话中获得这种输出。

```
> :t undefined :: T (S B A)
undefined :: T (S B A) :: T (S B A)

> :texpand undefined :: T (S B A)
undefined :: T (S B A) :: H (F ((H (F B) (G A)))) (G (H B (H (F B) (G A))))

> :texpand undefined :: R (T (S B A))
undefined :: R (T (S B A)) :: H (G (H B (H (F B) (G A)))) (F ((H (F B) (G A)))) 
```

据我所知，GHCi 实际上并没有提供任何类似`:texpand`命令的东西，而且我不确定它是否是该信息的最佳接口。但是，似乎可以以某种方式从 GHC 中提取扩展类型，我真的希望能够以交互方式查看它们。

黑客、文档链接、关于 GHCi 未来添加的推测性讨论都欢迎。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-28T03:12:28.120

`:kind!` will do that:

```
λ> :kind! T (S B A)
T (S B A) :: *
= H (F (H (F B) (G A))) (G (H B (H (F B) (G A))))
λ> :kind! R (T (S B A))
R (T (S B A)) :: *
= H (G (H B (H (F B) (G A)))) (F (H (F B) (G A))) 
```

(For convenience, you can put something like `:def k! \x -> return (":kind! " ++ x)` in your `.ghci`.)

# javascript - Javascript 在 HTML 中设置 ID 的值

> ID：13595785
> 
> 赞同：1
> 
> 时间：2012-11-28T00:33:38.207
> 
> 标签：javascript, html

您是否允许动态设置 HTML 元素的 ID - 即作为一个简单的示例，我可以这样做：

```
<a href="#" id="onOrOff()">Jazz</a> 
```

和：

```
function onOrOff()
{
 document.write("someIDSetInMyCSSFile");    
} 
```

我已经尝试过了，但它不起作用，所以只想检查我是否遗漏了其他一点。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:35:10.577

是的，但不是那样的。您将需要其他方式来访问它，例如：

```
var a = document.getElementsByTagName('a')[0]; 
```

然后：

```
a.id = "myDynamicID"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T00:39:38.703

更新：为此解决方案创建了一个 jsFiddle：http: [//jsfiddle.net/SdvA2/3/](http://jsfiddle.net/SdvA2/3/) 随意尝试！

假设你的 CSS 引用了#coolLink（和/或#uncoolLink），你可以尝试这样的事情：

```
<a href="#" id="uncoolLink" onclick="makeCool()">Jazz</a> 
```

要动态打开 coolLink id 格式，您可以尝试使用以下函数：

```
<script>
function makeCool() {
  var element = document.getElementById("uncoolLink");
  element.id ="coolLink";
}
</script> 
```

在此处查看更多信息：[https ://developer.mozilla.org/en-US/docs/DOM/document.getElementById](https://developer.mozilla.org/en-US/docs/DOM/document.getElementById)

但是，我强烈建议保持 id 不变并简单地更改类（并相应地调整你的 css）。

更进一步，我建议使用 jQuery，因为这将打开一个充满可能性的世界，改变你处理事情的方式，让生活变得更轻松，并保护你免受浏览器不兼容的影响。

# mysql - MySql 会自动锁定行还是我需要添加“锁定共享模式”？

> ID：13595788
> 
> 赞同：0
> 
> 时间：2012-11-28T00:34:13.797
> 
> 标签：mysql, database, jdbc

我们是初学者，我们的 java 软件使用 select * 等从数据库中获取查询。

我的问题是我们是否需要在共享模式和“FOR UPDATE”中添加锁来强制执行锁，或者表和行锁是自动的吗？

我们有一张要强制并发的表，我可以将 LOCK TABLE 添加到我需要锁定的表中，然后更新值，然后解锁它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T01:06:24.330

我认为根据您对我的评论的回答，您真的不必担心手动处理表锁。InnoDB 支持行级锁定并启用自动提交（默认情况下）所有单个查询实际上都以事务方式处理。

现在，如果您有多个 SQL 查询需要作为单个事务处理（即更新一个表，然后更新另一个表 - 要么都成功，要么都回滚），那么您需要专门启动一个事务并提交它或在临时查询执行后回滚。

如果需要更改事务隔离级别，也可以使用`SET TRANSACTION`语句（默认为 `REPEATABLE READ1）。

有关更多信息，请查看[MySQL 文档](http://dev.mysql.com/doc/refman/5.5/en/innodb-transaction-model.html "MySQL 文档")

# javascript - 用户脚本，如何替换 HTML 标记和属性

> ID：13595791
> 
> 赞同：1
> 
> 时间：2012-11-28T00:34:25.107
> 
> 标签：javascript, replace, userscripts

我正在尝试更改 HTML 标记并删除标记后的类/样式属性。如果我事先创建代码并替换，我已经知道如何做到这一点，现在我想知道如何在已经加载的页面上找到标签并用我的 js 替换它们。

```
var s = "<h2 class=\"title\" style=\"font-color: red;\">Blog Post</h2>";
s = s.replace("<h2 class=\"title\" style=\"font-color: red;\">","<p>");
s = s.replace(/<\/h2>/g, "</p>"); 
```

*从...开始* `<h2 class="title" style="font-color: red;">Blog Post</h2>`

*结束于* `<p>Blog Post</p>`

所以问题是如何`var s`使用现有的 HTML 创建？如何`h2.title`在页面上找到并将其提供给`var s`？

**编辑**除了我找到并调整的这个脚本之外，我没有任何 javascript 经验。请解释我如何从现有文档中获取文本，并使其成为 s.replace 操作的 var。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:50:42.090

不要试图用正则表达式来做，你应该使用 DOM 操作将有问题的文本节点移动到`p`你创建的标签。这里有一些代码可以满足您的需要。

[http://jsfiddle.net/jWRh5/](http://jsfiddle.net/jWRh5/)

```
// Find the h2
var h2 = document.querySelector("h2");
// Create the p element you need
var p = document.createElement("p");
// Move the text node into the p element
p.appendChild(h2.firstChild);
// Insert the p element before the h2
h2.parentNode.insertBefore(p, h2);
// Get rid of the h2
h2.parentNode.removeChild(h2); 
```

如果你想违背其他人的建议，这里有一种使用 RegExp 来实现你需要的方法[http://jsfiddle.net/jWRh5/1/](http://jsfiddle.net/jWRh5/1/)

它使用了一个不太受支持的功能，`outerHTML`（它在主要浏览器的最新版本中工作）

```
var h2 = document.querySelector("h2.title");
var s = h2.outerHTML;
s = s.replace("<h2 class=\"title\" style=\"font-color: red;\">","<p>");
s = s.replace(/<\/h2>/g, "</p>");
h2.outerHTML = s; 
```

以下是如何为页面上的所有 h2.titles 执行此操作（不使用 RegExp 方式，因为这是一种非常糟糕的方式，但如果您真的打算使用它，您可以将其用作指南）

```
var h2s = document.querySelectorAll("h2.title");
// Loop backwards since we're modifying the list
for (var i = h2s.length -1 ; i >=0; i--) {
    var h2 = h2s[i];
    var p = document.createElement("p");
    p.appendChild(h2.firstChild);
    h2.parentNode.insertBefore(p, h2);
    h2.parentNode.removeChild(h2);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T01:34:11.187

对于这种事情，[jQuery](http://jquery.com/)付出了红利，真正的快速。

做你想做的代码就是：

```
$("h2").replaceWith ( function () {
    return '<p>' + this.textContent + '</p>';
} ); 
```

或者，如果您想更具体：

```
$("h2.title").replaceWith ( function () {
    return '<p>' + this.textContent + '</p>';
} ); 
```

请注意，**该代码修复了所有**元素`<h2>`（第一个块），或者只是所有`<h2>`具有类的元素`title`（第二个块）。

* * *

有关如何在用户脚本中包含 jQuery 的信息，[请参阅此答案以了解跨浏览器方法。](https://stackoverflow.com/a/12751531/331508)

[`.replaceWith()`关于函数的文档。](http://www.jqapi.com/#p=replaceWith)

# java - 在 Tomcat 中启用 Context reload="true" 时，JDBC 连接池连接不足

> ID：13595794
> 
> 赞同：29
> 
> 时间：2012-11-28T00:34:47.987
> 
> 标签：java, eclipse, tomcat, jdbc, connection-pooling

我正在 Eclipse Juno 中开发 Java EE Web 应用程序。我已将 Tomcat 配置为使用 JDBC 连接池 (org.apache.tomcat.jdbc.pool) 和 PostgreSQL 数据库。以下是我项目的 META-INF/context.xml 中的配置：

```
<?xml version="1.0" encoding="UTF-8"?>
<Context>
    <!-- Configuration for the Tomcat JDBC Connection Pool -->
    <Resource name="jdbc/someDB"
        type="javax.sql.DataSource"
        auth="Container"
        factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"
        driverClassName="org.postgresql.Driver"
        url="jdbc:postgresql://localhost:5432/somedb"
        username="postgres"
        password="12345"
        maxActive="100"
        minIdle="10"
        initialSize="10"
        validationQuery="SELECT 1"
        validationInterval="30000"
        removeAbandoned="true"
        removeAbandonedTimeout="60"
        abandonWhenPercentageFull="50" />
</Context> 
```

我的应用程序使用 Eclipse 部署到 Tomcat，并且在 Tomcat 的 context.xml 中，属性 reloadable 设置为“true”，以便在检测到更改时自动重新加载 Web 应用程序：

`<Context reloadable="true">`

我注意到，每次发生上述自动重新加载时，都会保留 10 个与 PostgreSQL 数据库的连接（因为在 webapp 的 context.xml 中 initialSize="10"）。因此，在 10 次更改后会抛出 PSQLException：

```
org.postgresql.util.PSQLException: FATAL: sorry, too many clients already
... 
```

如果我手动重新启动 Tomcat - 一切都很好，只保留了 10 个连接。

有没有人知道解决这个问题的方法，所以可以在 reloadable 设置为“true”的情况下进行开发，并且每次重新加载上下文时都不会导致池化更多连接？

将不胜感激任何帮助。

PS Apache Tomcat 版本 7.0.32

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-11-29T17:21:29.157

# 解决方案（tl;dr）

为了解决这个问题，向 context.xml 文件中的*Resource*元素添加一个值为“ *close* ”的属性`closeMethod`（[在此处记录）。](http://tomcat.apache.org/tomcat-7.0-doc/config/context.html#Resource_Definitions)

 **这是我的 /META-INF/context.xml 文件的正确内容：

```
<Context>
    <!-- Configuration for the Tomcat JDBC Connection Pool -->
    <Resource name="jdbc/someDB"
        type="javax.sql.DataSource"
        auth="Container"
        factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"
        driverClassName="org.postgresql.Driver"
        url="jdbc:postgresql://localhost:5432/somedb"
        username="postgres"
        password="12345"
        maxActive="100"
        minIdle="10"
        initialSize="10"
        validationQuery="SELECT 1"
        validationInterval="30000"
        removeAbandoned="true"
        removeAbandonedTimeout="60"
        abandonWhenPercentageFull="50"
        closeMethod="close" />
</Context> 
```

注意属性*closeMethod*。*我对其进行了测试，现在连接数严格按照context.xml*文件中的定义保持！

**注意**
有一个时刻（与 JNDI 相关）需要注意。有关完整说明，请参阅更新 3。

* * *

# 长答案

好的，感谢 Apache Tomcat 提交者[Konstantin Kolinko](https://issues.apache.org/bugzilla/show_bug.cgi?id=54217#c1) ，我找到了上述解决方案。我[将此问题](https://issues.apache.org/bugzilla/show_bug.cgi?id=54217)报告为 ASF Bugzilla 上的 Apache Tomcat 错误，~~结果证明这不是错误~~（请参阅更新 1）。

===**更新 1 (2012-12-03) 又名“新希望”** ===

好吧，它仍然是一个**错误**。Apache Tomcat 7 发布经理[Mark Thomas](https://stackoverflow.com/users/1299005/mark-thomas)[证实](https://issues.apache.org/bugzilla/show_bug.cgi?id=54217#c5)（引用）：

> “这是 jdbc-pool 中的内存泄漏错误。PoolCleaner 实例保留对 ConnectionPool 的引用，以防止它被 GC'd
> ......
> 这已在主干和 7.0.x 中修复，并将包含在 7.0.34 及以后的版本中。”

因此，如果您的 Tomcat 版本较旧（低于 7.0.34），请使用上述解决方案，否则，~~从 Apache Tomcat 版本 7.0.34 开始，应该不会出现我描述的问题。~~（见更新2）

===**更新 2 (2014-01-13) 又名“问题反击”** ===

[即使对于当前最新的 Apache Tomcat 版本 7.0.50，我的错误报告](https://issues.apache.org/bugzilla/show_bug.cgi?id=54217)中最初描述的问题似乎仍然存在，并且我还使用 Tomcat 7.0.47 重现了它（感谢[Miklos Krivan](https://stackoverflow.com/questions/13595794/jdbc-connection-pool-runs-out-of-connections-when-context-reload-true-is-enabl#comment31678254_13631242)指出）。虽然现在 Tomcat 有时会在重新加载后设法关闭额外的连接，有时重新加载后连接数会增加然后保持稳定，但最终这种行为仍然不可靠。

**我仍然可以重现**最初描述的问题（尽管又不是那么容易：它可能与连续重新加载的频率有关）。似乎这只是时间问题，即如果 Tomcat 在重新加载后有足够的时间，它会或多或少地管理连接池。正如 Mark Thomas 在他的[评论](https://issues.apache.org/bugzilla/show_bug.cgi?id=54217#c9)（引用）中提到的那样：“根据 closeMethod 的文档，该方法的存在仅仅是为了加速释放资源，否则这些资源会被 GC 释放。” （引用结束），看起来速度是决定性因素。

当使用 Konstantin Kolinko 提出的解决方案（使用 closeMethod="close"）时，一切正常，并且保留的连接数严格按照 context.xml 文件中的定义保持。因此，使用 closeMethod="close" 似乎是（目前）避免在上下文重新加载后耗尽连接的唯一正确方法。

===**更新 3 (2014-01-13) 又名“Tomcat 发布管理器的回归”** ===

UPDATE 2 中描述的行为背后的谜团已解开。在我收到Mark Thomas（Tomcat 发布经理）的[回复](https://issues.apache.org/bugzilla/show_bug.cgi?id=54217#c11)后，现在已经清除了更多细节。我希望这是最后一次更新。因此，正如更新 1 中提到的那样，该错误**确实已修复**。我将 Mark 的回复中的重要部分作为引用发布在这里（强调我的）：

> 根据评论 #4 到 #6，在调查此错误时发现的实际内存泄漏已在 7.0.34 及更高版本中修复。
> 
> 重新加载时连接未关闭的问题是 JNDI 资源的 J2EE 规范的结果，因此这部分错误报告是无效的。我正在将此错误的状态恢复为已修复，以反映确实存在的内存泄漏已得到修复。
> 
> 为了解释为什么在重新加载后立即关闭连接失败是无效的，J2EE 规范没有提供容器告诉资源不再需要它的机制。因此，容器所能做的就是清除对资源的引用并等待垃圾回收（这将触发池​​和相关连接的关闭）。垃圾收集发生在 JVM 确定的时间，因此**这就是为什么在上下文重新加载后关闭连接需要不确定的时间，**因为垃圾收集可能在一段时间内不会发生。
> 
> Tomcat 添加了 Tomcat 特定的 JNDI 属性 closeMethod，可用于在上下文停止时触发 JNDI 资源的显式关闭。**如果等待 GC 清理资源是不可接受的，那么只需使用此参数**。Tomcat 默认不使用它，因为**它可能对某些 JNDI 资源产生意外和不想要的副作用**。
> 
> 如果您希望看到提供一种标准机制来告诉 JNDI 资源不再需要它们，那么您需要游说 J2EE 专家组。

# 结论

只需使用本文开头提出的解决方案（但以防万一，请记住*理论上*可能因使用它而产生的 JNDI 相关问题）。

* * *

# 替代解决方案

[Michael Osipov](https://stackoverflow.com/users/696632/michael-o)建议使用他的[*CloseableResourceListener*](http://mo-tomcat-ext.sourceforge.net/user-guide.html#CloseableResourceListener)，它可以防止在取消部署 Web 应用程序期间由未打开的资源导致的内存泄漏。所以你也可以试一试。

* * *

*免责声明
UPDATES 的别名受到[星球大战](http://en.wikipedia.org/wiki/Star_Wars)电影系列的启发。所有权利均属于其各自所有者。***

# java - 在Java中构造一个优先级队列，在O（n）时间内具有相反的顺序

> ID：13595797
> 
> 赞同：0
> 
> 时间：2012-11-28T00:35:01.897
> 
> 标签：java, sorting, priority-queue

在Java中，有没有一种简单的方法可以在O（n）时间内从无序的数字集合中创建一个PriorityQueue，但是顺序相反？PriorityQueue 的构造函数中没有一个同时接受集合和比较器来指定排序。我知道你可以创建一个 PriorityQueue 指定一个比较器，然后调用 addAll 来添加所有无序的数字。但是，我认为 addAll 会单独添加每个值，而不是堆积无序的集合，所以我认为这不会是 O(n) 时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T01:00:38.923

一种解决方法是首先否定您的数字，然后在 O(n) 中从它们中创建一个堆。稍后，您只需要记住在从堆中检索这些数字后将其取反即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:48:49.513

addAll 具有 O(n*log(n)) 复杂度，所以这并不可怕。

我不知道你从哪里得到的想法是从无序的数字集合中创建一个 PriorityQueue 具有 O(n)，我认为它与 addAll 相同。

# database - Oracle 是否使用窃取/不强制方法？

> ID：13595799
> 
> 赞同：2
> 
> 时间：2012-11-28T00:35:06.077
> 
> 标签：database, oracle, undo, redo

我已经在谷歌上搜索了他的时间，但我找不到任何关于此的信息。它到处都说窃取/不强制是数据库系统最常见的方法，但没有证据我不能确定。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-28T00:49:44.390

Oracle 使用窃取/不强制的方法。可以在提交这些块中的更改之前将块写入磁盘（因为更改受 UNDO 保护）。并且在提交事务之前不需要将更改的块写入磁盘（因为更改受 REDO 保护）。

# .htaccess - RewriteRule 正在重定向到绝对路径，而不是正确的 URL

> ID：13595803
> 
> 赞同：4
> 
> 时间：2012-11-28T00:35:16.747
> 
> 标签：.htaccess, mod-rewrite

我为我的网站创建了一堆 RewriteRules，并且在我的本地设置中没有遇到任何问题。这是我的 .htaccess 中的一个片段：

```
Options +FollowSymLinks -MultiViews
RewriteEngine On
RewriteRule ^news/?$ news.php [L] 
```

在本地，当我访问 127.0.0.1/news 时，它会正确重定向到 news.php 并屏蔽 URL。我刚刚更新了远程服务器上的 .htaccess 文件并在尝试访问上述示例时收到此错误：

*在此服务器上未找到请求的 URL /mnt/target02/123456/123456/www.mywebsite.com/web/content/news.php。*

我尝试将规则更改为：

```
RewriteRule ^news/?$ http://www.mywebsite.com/news.php [L] 
```

并且页面正确加载。但是，地址栏显示的是 news.php，而不是 news。有什么我遗漏的东西，还是我被丑陋（而且不太安全）的地址困住了？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-07-02T19:25:57.640

如果您像我一样，您会尝试避免在替换 URL（新目标）中添加前导斜杠，以便您的同一个`.htaccess`文件可以同时用于测试和生产服务器。我遇到了同样的问题，只需要设置：

```
RewriteBase / 
```

这告诉 mod_rewrite 将替换 URL 基于 Web 根目录而不是文件根目录。另一个提示，如果您需要重定向到目的地的顶层，请使用`./`而不是仅`/`. 我的测试服务器有一个端口（8080）并且不在根（所以它有一个非空`RewriteBase`的`/site1/`），并且网络上的大多数重写规则示例都没有考虑这种情况。如果您的替换从未以斜杠开头，您可以`.htaccess`在测试服务器和实时服务器上使用相同的文件，您可能需要更改的只是 的值`RewriteBase`，而不是更新每条规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-23T13:27:42.767

您是否尝试过在目标 URL 中添加前导斜杠，例如

RewriteRule ^news/?$ /news.php [L]

# opengl - 在 OpenGL 中创建完整的 1D 纹理时出现问题

> ID：13595804
> 
> 赞同：1
> 
> 时间：2012-11-28T00:35:19.803
> 
> 标签：opengl, textures

为什么会生成以下代码`GL_INVALID_OPERATION`？

```
int8_t  bytes[256];
for (int i = 0; i < 256; i++)
  bytes[i] = (int8_t) i;
glGenTextures(1, &texture);
glBindTexture(GL_TEXTURE_1D, texture);
glTexParameteri(GL_TEXTURE_1D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
glTexParameteri(GL_TEXTURE_1D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
glTexImage1D(GL_TEXTURE_1D, 0, GL_R8I, 256, 0, GL_RED, GL_BYTE, bytes);
/* Here I get GL_INVALID_OPERATION */
glBindTexture(GL_TEXTURE_1D, 0); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:50:10.187

我自己找到了答案！显然，当使用整数格式将像素传输到纹理时，必须使用`_INTEGER`格式说明符 ( ) 的后缀。`GL_RED_INTEGER`更多信息：[像素转移](http://www.opengl.org/wiki/Pixel_Transfer)

# java - 如何从第二堂课的摇摆班中检索所有字段？

> ID：13595807
> 
> 赞同：0
> 
> 时间：2012-11-28T00:35:32.873
> 
> 标签：java, swing

我不太确定该怎么做，而且我认为我的方向不正确。

我有一个包含大量字段的摇摆表单，当用户按下保存按钮时，我想将这些字段保存在辅助保存类中。

有没有办法可以将 Swing 表单的全部内容传递给 Save 类？

```
btnSave.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent arg0) {
            SaveMap.MapSave(???);
        }
    }); 
```

然后：

```
public class SaveMap {  
    public static boolean MapSave(???) {
      // save stuff
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T00:50:32.880

不容易。这还取决于您要保存的内容。

差异控制将提供不同的数据。

基本上，我会创建某种“构建器”，它可以是字段的“名称”以及控件本身或其值......

```
Savable savable = new SaveBuilder.add("userName", userNameField).add("password", passwordField);
SaveMap.MapSave(savable); 
```

这样做的好处是允许以您需要的方式提取您需要的信息......

或者

```
Savable savable = new SaveBuilder.add("userName", userNameField.getText()).add("password", passwordField.getPassword());
SaveMap.MapSave(savable); 
```

显然，`SaveMap`需要能够提取属性名称和值。

# assembly - 汇编 (NASM) 如何进行数值运算

> ID：13595808
> 
> 赞同：2
> 
> 时间：2012-11-28T00:35:35.080
> 
> 标签：assembly, x86, numbers, character, nasm

我用java编程了很多，知道python的基础知识，有时我玩c++......这些都是高级编程语言，它们很棒，但我很好奇事情在这个更深层次上是如何工作的case 汇编语言... 我开始学习 x86 处理器的汇编并选择 NASM 作为我的汇编程序。我花了一些时间学习寄存器和堆栈是如何工作的，如何存储信息以及如何更改信息，不仅仅是阅读，而是练习，使用调试器等等，有些事情真的开始困扰我：数值操作......

我的意思是，每当从输入中读取某些内容时，它都会作为对应的 ASCII 值存储在内存中，我可以接受...我了解如何使用整个通道偏移和长度读取和写入控制台的基础知识系统但是正如我之前提到的，包括数字在内的字符存储为 ASCII 值。0 存储为 0x30，1 存储为 0x31，等等。这意味着单个数字存储为整个字节，我认为这是一个缺点，因为我知道一个字节可以表示高达 255 的数字，这将节省大量内存和时间来进行数学运算并为其他数据留出空间......在像 c++ 这样的语言中，整数值仅由 4 个字节表示，这意味着这些语言可以存储最多 4294967295 的整数

言归正传...我真正想知道的是什么是表示数字并使用 nasm 进行基本算术运算的最佳方法。我应该将这些数字保留为 ASCII 值并在字节级别上进行操作还是应该转换这些数字，以便一个字节可以容纳更大的值？或者有没有办法更有效地读取数字？

PS.：对不起，很长的帖子，我只是想提供我所关注的整体背景，以便你们可以根据它来帮助我......对于糟糕的英语......我试图尽可能清楚（英语不是我的母语，但我会尽可能多地理解它......在我编程时了解英语很有帮助）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T01:36:10.970

首先，你不能......我再说一遍，你不能将汇编与任何高级语言进行比较！它们存储数据和与数据交互的方式完全不同。他们这样做是为了让程序员的生活更轻松。如果要将 char 的 ASCII 码存储为 DWORD，请继续。

在组装中，绝对没有手牵手。CPU 不知道您想对任何数据做什么，无论是文件中的字节还是键盘上输入的字符。

您在大会中自己做所有事情。您在键盘上按下的字符是 ASCII 字符，因为这是在您键入它们时显示的，如果您想对它们做其他事情，程序员可以根据需要对其进行转换。

将 ASCII 数字转换为数字是微不足道的。

```
Numbers: 0  1  2  3  4  5  6  7  8  9
ASCII:   48 49 50 51 52 53 54 55 56 57 
```

看到它们之间的区别了吗？48是神奇的数字。

你遍历你的字符串，测试每个数字是否在 48 到 57 之间，其他的都跳过。如果 ASCII 字符介于 48 和 57 之间，则从字符中减去 48 即可得到一个数字。您添加 48 以获得数字的 ASCII 字符。

不告诉您使用 atodw/atoi 或其他什么，您可以通过自己了解更多信息，这并不难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T01:16:51.313

我会从ASCII转换。它使一切变得更简单，想象一下将 ascii 数字相乘。如果你有多个使用 ascii 的数字可能会变得非常烦人。此外，您可以声明超过一个字节的变量：

> b=字节
> 
> w=字（2字节）
> 
> dw=双字（4字节）

```
var1 w   0000h ;
var2 dw   0007h
var3 b 0000h 
```

这样您就可以从控制台获取输入。只需一位数：

```
mov ah, 1  ;int 21h (interrupt 21h) in the next line is a function that can do many things
int 21h    ;depending on the value you put in register "ah". Using 1 it reads input the value is stored in "al"
add al, -48 ;ascii -> bin .. here you substract 48 to transform from ASCII
mov [var1],al 
```

你可以像这样添加两个数字（负数需要额外的东西）你会得到

[变量1]=[变量1]+[变量2]

```
mov al,[var2]
add al, [var1]
mov [var1],al 
```

CPU通常也有乘法指令

看看这个，它是 8086 处理器的指令集，这是你可以告诉它做的所有事情。 [8086指令集](http://ece425web.groups.et.byu.net/stable/labs/8086InstructionSet.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T01:17:06.570

与任何语言一样：如果您有一个字符串，但您想对其进行数字运算，请将其转换为数字。除非它不适合您的处理器的任何通用寄存器。

我现在不知道您的目标是什么指令集，但是例如。在 x86-64 中，有 8 位、16 位、32 位和 64 位通用寄存器来保存您的数字。如果您的数字不适合 64 位（在 x86-64 中），那么事情会变得有点复杂。如果您想要目标架构中可用的最大范围的数字，最好的方法是将数字存储在尽可能大的寄存器或内存中。

与高级语言相比，在汇编级别中，有符号变量和无符号变量之间没有区别，它只取决于您如何处理它。但是有有符号和无符号运算，例如有符号乘法 ( `imul`)、有符号除法 ( `idiv`)、无符号乘法 ( `mul`)、无符号除法 ( `div`)。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-11-28T01:17:19.113

Ascii 字符不是数字。

您需要使用**atoi**功能。

# java - 嵌套循环字符 []

> ID：13595809
> 
> 赞同：-1
> 
> 时间：2012-11-28T00:35:39.727
> 
> 标签：java, loops, nested

编写一个循环，显示两个字母的所有可能组合，其中字母为“a”、“b”、“c”、“d”或“e”。组合应按字母升序显示：

aa ab ac ad ae ba bb ... ee

这是我的代码：

```
 Char[] letters = {'a', 'b', 'c', 'd', 'e'};

for(int i=0; i < letters.length() ; i++)
{
  for(int ii=0; ii < letters.length() ; ii++)
  {
    System.out.print(letters[i]);
    System.out.println(letters[ii]);
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:40:57.933

是什么`Char[]`？很可能您的意思是`char[]`甚至`Character[]`，但我更倾向于前者。请记住——Java 中的对象是大写的。基元不是。您可能正在寻找原始数组。

数组也没有对`length`. 您可以通过简单地引用它`letters.length`。

# ios - 访问当前播放曲目的元数据（iPodMusicPlayer 除外）

> ID：13595811
> 
> 赞同：1
> 
> 时间：2012-11-28T00:35:45.787
> 
> 标签：ios, ios5, ios6, mpmusicplayercontroller

现在，我正在使用以下方法获取当前播放歌曲的信息：

```
MPMusicPlayerController *controller = [MPMusicPlayerController iPodMusicPlayer]; 
```

但是，这仅适用于实际通过 iPod 播放器播放的曲目。

我想知道是否有办法从接管 iPod 音乐播放器底座的其他应用程序中获取相同类型的信息。Spotify、Downcast、Instacast 等应用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T13:44:11.040

经过进一步调查，似乎只能从 iPod 播放器中获取元数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T01:41:56.117

不完全确定您要查找的内容，但您可能可以使用 AVURLAsset 从实际文件中获取元数据。我用它来查找 mp3 和 m4a 文件的元数据，但可能还有其他可用格式。有关详细信息，请参阅文档。

```
AVURLAsset *asset = [[AVURLAsset alloc] initWithUrl:@"song.mp3" options:nil];
if (asset != nil)
{
    NSArray *formatArray = asset.availableMetadataFormats;
    if ([formatArray count] > 0)
    {
        NSArray *array = [asset metadataForFormat:[formatArray objectAtIndex:0];
        NSString *artist = @"";
        NSString *songTitle = @"";

        for (AVMetadataItem *metadata in array)
        {
             if ([metadata.commonKey isEqualToString:@"artist"])
                artist = metadata.stringValue;
             else if ([metadata.commonKey isEqualToString:@"title"])
                songTitle = metadata.stringValue;
             etc, ...
        }
     }
} 
```

# ruby - 通过无线网络对 tcp 连接进行故障排除

> ID：13595812
> 
> 赞同：1
> 
> 时间：2012-11-28T00:35:56.107
> 
> 标签：ruby, windows, networking, tcp

我的家庭网络上有两台 Windows 计算机，它们似乎无法通过我正在测试的客户端/服务器 TCP 连接进行通信。

这是我在 Windows Server 2008 机器上运行的简单 Ruby 服务器：

```
require 'socket'

server = TCPServer.open(2000)

puts "Server started"

loop {
  client = server.accept
  client.puts "Hello client"
  client.close
}

puts "Server stopped" 
```

这是我在 Windows 7 机器上运行的一个简单客户端：

```
require 'socket'

hostname='192.168.1.10'
port=2000

s = TCPSocket.open(hostname, port)

while line = s.gets
  puts line.chop
end
s.close 
```

当服务器运行时，我运行客户端我看到这个错误：

client.rb:6:in `initialize'：连接尝试失败，因为连接方在一段时间后没有正确响应，或者连接失败，因为连接的主机没有响应。- 连接（2）（Er rno::ETIMEDOUT）

我在服务器的防火墙上为端口 2000 创建了一个例外，以便它允许任何设备连接（我什至尝试过完全关闭防火墙）。

我也认为代码本身很好，因为当我从与服务器相同的盒子运行客户端时，我可以成功建立连接。

我认为有些东西阻止了网络连接，但我并不精通解决网络问题，那么我应该从哪里开始解决这个问题？

# regex - 使用正则表达式从电子邮件地址中过滤句点

> ID：13595820
> 
> 赞同：0
> 
> 时间：2012-11-28T00:36:37.960
> 
> 标签：regex, email, filtering

我需要使用正则表达式清理一组功能等效的 gmail 地址。您可能知道 gmail hack，其中“brunette.thomas@gmail”被 gmail 视为“brunetteandrew@gmail”。人们通过在他们的电子邮件地址中添加句点来在抽奖中输入多个条目。

我需要将这些过滤到电子邮件地址的 alpha 部分，即转：

> brunettethomas@gmail.com

进入：

> brunettethomas@gmail.com

与周期数无关。

谁能帮我这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:39:10.267

您可以使用它来匹配 at 符号之前的所有句点：

```
\.(?=.*@) 
```

然后你可以用空字符串全局替换它。这仅适用于支持前瞻的正则表达式方言（您尚未说明您正在使用哪种方言）。

# eclipse - 有没有办法让 Eclipse 在后台不刷新工作区？

> ID：13595827
> 
> 赞同：0
> 
> 时间：2012-11-28T00:37:24.430
> 
> 标签：eclipse

Eclipse 似乎检测到文件更改并进行工作区刷新，即使它不在前台（顶部窗口）。有没有办法将其关闭，以便它等到它再次在前台进行工作区刷新，基本上将更改排队，直到我再次激活它？

基本上我不希望它占用 CPU 来尝试重建工作区，而我正在对其他工具进行更改。我经常看到这种情况的主要情况是当我从命令行执行 git rebase 时。在 rebase 运行时，Eclipse 会根据正在进行的更改不断重建工作区。

注意我确实希望它在我再次激活时刷新。本质上，我希望刷新像 IntelliJ 一样工作。

作为参考，这里有一组关于 Eclipse 工作区刷新如何工作的很好的答案 - [Eclipse 可以自动刷新资源吗？](https://stackoverflow.com/questions/1212633/can-eclipse-refresh-resources-automatically)

请注意，刷新工作区甚至会导致 Eclipse 出现问题，此时它会引发错误对话框并将其自身带到前台。 ![在此处输入图像描述](../Images/c2a0db3c23a8666ce071843ab40d4c9f.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T02:38:57.233

自动刷新和自动构建不是一回事。没有办法完全按照您的意愿进行操作，但自动构建而不是自动刷新可能是最接近的事情。然后手动触发刷新将导致对这些更改进行自动构建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:47:11.760

您可以取消选中项目的“自动图片”选项。出于性能原因，我们还建议关闭当前不需要的所有项目，并为每个项目使用不同的工作区。

# python - 搜索名称 python 的字典列表

> ID：13595830
> 
> 赞同：1
> 
> 时间：2012-11-28T00:37:30.740
> 
> 标签：python, list, search, dictionary, dataset

我有一个字典列表，每个字典都有这样的数据：

```
'Caitlyn': {'date': (2012, 11, 24), 'player': 'Caitlyn', 'outcome': 'Win', 'gameid': '00006', 'stats': {'assists': 6, 'kills': 13, 'deaths': 4}} 
```

我从具有如下行和数据的文件中生成每个项目：

```
[00006] Caitlyn - 13/4/6 - Win - 2012-11-24 
```

我想在字典列表中获取匹配玩家姓名的所有索引并打印它们和/或打印其中的数据。我可以打印所有列表并将其格式化以匹配我的文件等，但我不确定如何搜索它，因为它与我在此进行的其他搜索有点不同。

我可以用这个打印整个数据集（我知道很难看，但它有效）：

```
i = 0
for item in records:
    print "\n", "[%s] %s - %s/%s/%s - %s - %s-%s-%s" % (records[i][0], records[i][1]['player'], records[i][1]['stats']['kills'], records[i][1]['stats']['deaths'], records[i][1]['stats']['assists'], records[i][1]['outcome'], records[i][1]['date'][0], records[i][1]['date'][1], records[i][1]['date'][2])
    i = i + 1 
```

有人可以帮忙吗？我需要能够在其中搜索玩家姓名并打印出每个匹配项（并返回索引，以便我可以使用匹配的集合来处理其他内容，而不是再次运行整个搜索），我想我想返回匹配列表，以便我可以使用它们或导出它们或其他任何东西。感谢您的帮助！

**[编辑] 由于到目前为止似乎有更多的问题然后答案，这是到目前为止的整个文件：http:** [//www.pasteall.org/37589/python](http://www.pasteall.org/37589/python)

这是 stats4.txt： http: [//www.pasteall.org/37590](http://www.pasteall.org/37590)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T01:51:26.523

很高兴在这样一个意想不到的地方遇到另一个召唤师。

如果您想跟踪与特定英雄一起玩的所有游戏，您可以构建另一个字典，其中英雄名称作为键，游戏统计列表作为值。

代码应如下所示。

```
records = {}

for line in data:
    # parsing codes

    # store player -> gameid mappings to the index
    if player not in records:
        records[player] = []
    records[player].append(info)

print records['Sona']
# this should print out list of games played with Sona 
```

此更改将使您的数据可以按英雄名称访问，但不再按游戏 ID 排序。如果您仍然需要通过游戏 ID 访问您的数据，我建议您按游戏 ID 存储数据，并构建另一个字典来索引它。这取决于你想对数据做什么。

此外，如果您想对这些数据进行认真的分析，您应该考虑使用一些用于 python 的数据库绑定，例如[sqlite3](http://docs.python.org/2/library/sqlite3.html)，它包含在标准库中。数据库是专为此类任务设计的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T01:49:37.643

重组数据是否为时已晚？

```
>>> Caitlyn = {'games': [{'date': (2012, 11, 24),
                      'gameid': '00006',
                      'outcome': 'Win',
                      'stats': {'assists': 6, 'deaths': 4, 'kills': 13}}]}
>>> game02 = {'date': (2012, 11, 24),
              'gameid': '00007',
              'outcome': 'Loss',
              'stats': {'assists': 4, 'deaths': 3, 'kills': 16}}
>>> Caitlyn['games'].append(game02) 
```

您为每个玩家使用一个字典列表，并将它们保存到他们自己的对象中，它可以很好地腌制，或者可以在基于[文档的 no-sql 数据库](http://api.mongodb.org/python/current/tutorial.html)中原样使用。尽管这确实消除了您迄今为止所做的很多工作，但回报是不错的。持久存储，无需解析/写入文本，并且能够使用数据库风格的逻辑来进行您所说的那种搜索。汇总统计数据是另一个很好的奖励。*尽管这现在*不能回答您的问题，但我希望您至少将其视为一种选择。

# ruby-on-rails - Gemfile 语法错误：尝试启动 localhost 时 <<<<<<< HEAD

> ID：13595831
> 
> 赞同：2
> 
> 时间：2012-11-28T00:37:41.087
> 
> 标签：ruby-on-rails, macos, git, terminal, gemfile

我尝试启动我的 localhost:3000 RoR 应用程序。终端发生了什么：

```
[omrails]$rails s
Gemfile syntax error:
<<<<<<< HEAD
^ 
```

我尝试在 Google 和 Stackoverflow 上搜索，但没有发现任何与我类似的问题。我认为 ny Gemfile 有问题，但我不知道到底是什么。

我的 Gemfile 看起来像这样：

```
source 'https://rubygems.org'

gem 'rails', '3.2.8'
gem 'bootstrap-sass'
gem 'devise'
gem 'omniauth'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'

group :development do
gem 'sqlite3'
end

# Gems used only for assets and not required
# in production environments by default.
group :assets do
gem 'sass-rails',   '~> 3.2.3'
gem 'coffee-rails', '~> 3.2.1'

# See https://github.com/sstephenson/execjs#readme for more supported runtimes
# gem 'therubyracer', :platforms => :ruby

gem 'uglifier', '>= 1.0.3'
end

gem 'jquery-rails'

group :production do
gem 'pg', '0.12.2'
end

# To use ActiveModel has_secure_password
# gem 'bcrypt-ruby', '~> 3.0.0'

# To use Jbuilder templates for JSON
# gem 'jbuilder'

# Use unicorn as the app server
# gem 'unicorn'

# Deploy with Capistrano
# gem 'capistrano'

# To use debugger
# gem 'debugger' 
```

有什么建议在我的 Gemfile 中可能有什么问题吗？如果您有任何其他问题或要求，请随时问我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-28T00:47:44.780

本地区：

```
<<<<<<< HEAD
group :development do
gem 'sqlite3'
end
=======
# gem 'sqlite3'

>>>>>>> 154ef24b95ea600ced834457e146c2fb27a18156 
```

是 git 合并冲突。它表示当前版本（HEAD）和您提取的另一个提交（154ef24b95ea600ced834457e146c2fb27a18156）都发生了变化。不同的文件内容显示在每个区域供您阅读。

当您遇到这样的冲突时（通常是通过运行`git merge`or `git rebase`， or `git pull`），那么您*应该*在将冲突标记为已解决之前实际**修复**冲突。`git add`您可以通过查看由 分隔的两个区域`=======`并决定保留哪个区域来做到这一点。

有时您必须决定如何将两者合并为一个来完成这两个更改所做的事情，但在这种情况下，您可能只想丢弃被注释掉的部分。如果你修剪以 开头的线，以及和线`<<<<<<<`之间的所有内容，包括在内，那么你应该很高兴。 `========``>>>>>>>>`

一般来说，学习 git merge 和 rebase 过程可能不会有什么坏处——它们很强大，但如果你不熟悉，可能会有点复杂。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T00:39:28.390

您已经提交了 Git 中合并冲突的结果。

您需要删除这些行，并特别注意确保代码符合您的预期。

```
<<<<<<< HEAD
group :development do
gem 'sqlite3'
end
=======
# gem 'sqlite3'

>>>>>>> 154ef24b95ea600ced834457e146c2fb27a18156 
```

您可以查看当前的`HEAD`内容以及`154ef24b`合并时的内容。通过删除冲突标记并保留/修改任一侧的块来选择您希望如何解决它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T00:47:30.680

正如亚历克斯所说，您已经在 git 中提交了合并冲突的结果。当他说要​​密切注意代码是您所期望的时，您需要更多关于他的意思的详细信息。您不想只删除冲突标记（<<<<<<、========== 和 >>>>>>>>>>>），您需要实际解决冲突。

`HEAD`进行合并时有以下内容：

```
group :development do  
gem 'sqlite3'
end 
```

在包含您在 ( ) 中合并的提交的分支中，`154ef24b95`您有：

```
# gem 'sqlite3' 
```

这（似乎）意味着合并完成`HEAD`时在开发中使用 sqlite 并且提交`154ef24b95`决定不这样做。您肯定想在此处确定您的项目中实际需要的版本。不要只是删除冲突标记。

# titanium - Titanium Appcelerator - 启用云服务后，在为 Android 编译时出现 UnicodeDecodeError

> ID：13595837
> 
> 赞同：1
> 
> 时间：2012-11-28T00:37:50.313
> 
> 标签：titanium, titanium-mobile, appcelerator-mobile

我有一个具有 UTF8 名称（希伯来语）的应用程序。我为此使用了 platform/android/AndroidManifest.xml 文件。
我设法将其缩小到 Ti.cloudpush 模块。只有当我启用此模块时，我才会收到错误消息。

我曾经能够毫无问题地将它编译到android，但是一旦我启用云服务，我就会收到这个错误 -

```
[ERROR] Exception occured while building Android project:
[ERROR] Traceback (most recent call last):
[ERROR]   File "/Users/Shahar/Library/Application Support/Titanium/mobilesdk/osx/2.1.0.GA/android/builder.py", line 2218, in <module>
[ERROR]     s.build_and_run(True, None, key, password, alias, output_dir)
[ERROR]   File "/Users/Shahar/Library/Application Support/Titanium/mobilesdk/osx/2.1.0.GA/android/builder.py", line 1970, in build_and_run
[ERROR]     self.manifest_changed = self.generate_android_manifest(compiler)
[ERROR]   File "/Users/Shahar/Library/Application Support/Titanium/mobilesdk/osx/2.1.0.GA/android/builder.py", line 1195, in generate_android_manifest
[ERROR]     custom_manifest_contents = fill_manifest(custom_manifest_contents)
[ERROR]   File "/Users/Shahar/Library/Application Support/Titanium/mobilesdk/osx/2.1.0.GA/android/builder.py", line 1122, in fill_manifest
[ERROR]     manifest_source = manifest_source.replace(ti_permissions,permissions_required_xml)
[ERROR] UnicodeDecodeError: 'ascii' codec can't decode byte 0xd7 in position 501: ordinal not in range(128) 
```

这是我的清单文件，其中包含导致问题的部分。如果我删除希伯来语名称，它编译没有任何问题

```
<application
    android:icon="@drawable/appicon"
    android:label="??????"
    android:name="QuestionnaireApplication"
    android:debuggable="false"
>
    <activity
        android:name=".QuestionnaireActivity"
        android:label="??????"
        android:theme="@style/Theme.Titanium"
        android:screenOrientation="portrait"
        android:configChanges="keyboardHidden"
    > 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T23:02:00.933

在 Titanium Studio 中，在工具栏上，单击 Project -> Clean。重建。

# javascript - 如何只注册一次点击事件？

> ID：13595841
> 
> 赞同：1
> 
> 时间：2012-11-28T00:38:38.330
> 
> 标签：javascript, jquery

我正在尝试在我的项目中向我的元素注册一次点击事件。

我简化了我的代码，基本上我的结构如下所示：

```
function objectParent(){

}

objectParent.prototype.click=function()(

   $('#create').click(function(){
     var var1=new objectchild();
         var1.add();
   })

}

function objectchild(){

}

objectchild.prototype.add=function()(

  //The '#aButton' click event will be registered 4 times if the '#create' button is clicked 4 times.
  //so the alert will pop 4 times when 'aButton' is clicked which is not what I wanted.

  //I can use $('#aButton').unbind('click') to remove the click event but I have many buttons in my project
  //and I want to have better solution for this.

  $('#aButton').click(function(){
     alert('click')
   })

}

var test=new objectParent()
    test.click(); 
```

html

```
<a id='create' href='#'>test</a>

//everytime this <a> is clicked, it will create a new objectchild object 
//after click 4 times of this button and click 'aButton', it will pop the alert box 4 times
//I know it register click event 4 times to the 'aButton' 
//I only want to pop the alert box once.

//I can use $('#aButton').unbind('click); to remove the click event but I have many many buttons in my codes
//ex bButton, cButton...etc. I want to have a better approach for my codes.

<a id='aButton' href='#'>button</a> 
```

我希望我能很好地解释我的问题。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-28T00:41:47.510

做就是了：

```
$('#aButton').one('click', function(){
     alert('click')
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:41:48.650

尝试：

```
var clickHandler = function(event) {
  $('#element').unbind('click', clickHandler);
  ...
} 
$('#element').on('click', clickHandler); 
```

[http://jsfiddle.net/zYGhz/](http://jsfiddle.net/zYGhz/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T02:07:38.060

我认为 Nelson & alex 一定误解了 FlyingCat 的要求......
one() 方法只能确保注册的处理程序只被调用一次，
但是如果开发人员多次调用 one() 方法（就像在 FlyingCat 的场景中一样） ,

```
 for (var i = 0; i < 3; i++) {
     $("#element").one(function() {
          alert(1);
     })
 } 
```

单击时每个注册的处理程序将被调用一次，因此问题仍未解决。
**Kolink 的答案是正确的，您必须进行细微的更改。**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T03:26:28.047

到目前为止，最简单的方法是确保在附加新的之前删除 objectchild 的 click 函数的任何先前附件。还有其他方法，但代码会更多。

```
objectchild.prototype.add = function(){
    $('#aButton').off('click.x').on('click.x'function(){
        alert('click');
    });
}; 
```

`.x`用于命名事件。这允许`.off('click.x')`在不影响可能已附加在代码中其他位置的其他点击处理程序的情况下进行操作。如果没有附加其他点击处理程序，则命名空间不是绝对必要的，但它没有害处。

您可能想要`.x`用更有意义的东西替换。

# html - 使用 Respond.js 时访问被拒绝异常

> ID：13595844
> 
> 赞同：1
> 
> 时间：2012-11-28T00:39:01.653
> 
> 标签：html, internet-explorer, css, responsive-design, media-queries

我想在 IE 旧版本上支持媒体查询，我下载了[respond.js](https://github.com/scottjehl/Respond)库，我尝试运行他们提供的测试示例，但在 IE 旧版本中出现此错误

```
Message: Access is denied.

Line: 287
Char: 4
Code: 0 
```

顺便说一句，我没有使用缩小版！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T13:35:25.210

即使我在尝试直接从文件夹中打开“test.html”时也遇到了问题：

```
file:///C:/Respond-master/test/test.html 
```

当我将文件放在本地服务器并从浏览器打开它时得到修复：

```
http://localhost/Respond-master/test/test.html 
```

# javascript - 用于房间设计师项目的画布或 SVG

> ID：13595851
> 
> 赞同：4
> 
> 时间：2012-11-28T00:39:30.823
> 
> 标签：javascript, html, canvas, svg

我即将开始一个房间设计师项目，该项目将允许您将墙壁/门/家具等拖放到网格上以设计房间。我已经决定拖放透明PNG并绝对定位它们是行不通的，我不想使用flash，所以它是Canvas或SVG。

**我：**我以前从未使用过 Canvas 或 SVG，但在 javascript 和 jQuery 方面我非常胜任（我对 OO Javascript、anonymouse 函数、闭包、回调等很满意）并且我读过 Douglas Crockford 的“Javascript:好的部分”并理解其中的大部分内容；-)

**项目**- 需要从组件窗口拖放到设计器窗口，需要在平板电脑（而不是手机）上工作，因此需要关注触摸事件。还需要工具提示、对象分层等。如果我确实使用矢量图形，那么它们无论如何都需要有位图纹理（例如，墙板可能有壁纸纹理）

到目前为止，我已经阅读了一本关于 Canvas 的书，并得出以下结论......

帆布

*   快速地
*   在画布上重绘对象相当简单
*   还不知道鼠标事件
*   EaselJS、FabricJS 和 KinectJS 等库看起来不错。

SVG

*   可扩展（更容易构建缩放功能）
*   易于从 Illustrator 之类的工具导入图形。
*   绘图库看起来不那么丰富/好。
*   不知道鼠标/触摸事件。

所以，我需要尽快弄清楚如何做到这一点。现在我倾向于 Canvas 和一个好的库，因为我相信其中一些可以导入 SVG 以实现可伸缩性。

任何有关前进方向的建议将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-28T03:58:18.223

为了我的钱，如果可能的话，我肯定会选择 SVG（但我确实有更多的 SVG 经验）。它似乎是为 3D 渲染应用程序而设计的。一方面，它是一个完整的 DOM - 因此它为您处理渲染和 z 排序（无需任何重新绘制等），最重要的是 - 提供了大部分对象模型本身。使用画布，您必须创建更多的内存模型来处理所有内容的渲染。使用 SVG，您无需担心遮罩、移动、变换、缩放或渲染任何内容。显然，如果对象在 3D 空间中相交/重叠，它会变得更加复杂——但无论哪种方法都是如此。至少 SVG 为您承担了大部分负担。

但就性能而言，我不能肯定地说。这取决于您的应用程序在做什么。我不认为触摸事件应该是决定因素——你会找到一种方法，即使它意味着覆盖一个透明的画布。SVG 是否支持触摸事件也可能取决于设备/浏览器——但我还没有探索过。

但是画布——这对你有什么用？这是一个位图，仅此而已。任何一天都给我一个漂亮而强大的 DOM，而不是一团内存。

但这只是我的意见！:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T00:46:13.973

我认为最好的解决方案是使用画布来表示网格和房间。然后对于房间里的物品，在画布上使用 svg。如果您使用透明的 png 文件作为家具，那么您根本不需要 svg，但是如果您使用 svg，那么您可以缩放到更大，而不仅仅是稍微大一点。

您在移动设备上遇到的一个问题是内存问题，如果页面上有很多项目，而且它们是 png，这可能是个问题。

如果您在画布上执行“拖放”操作，那么您实际上不需要 javascript 拖放库，只需处理触摸事件即可。

触摸事件的链接：http: [//www.html5canvastutorials.com/kineticjs/html5-canvas-mobile-events/](http://www.html5canvastutorials.com/kineticjs/html5-canvas-mobile-events/)

和一个关于触摸事件的链接：[Javascript Drag and drop for touch devices](https://stackoverflow.com/questions/5186441/javascript-drag-and-drop-for-touch-devices)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-28T04:31:27.217

我不知道您的项目有多复杂，但您应该担心平板电脑的性能，因为正如我在 iPad 2 上所做的一些测试中看到的那样，使用一些 svg 与 css 和 javascript 触摸事件混合，结果并非如此负责任的，和一个明显的滞后。

Canvas 可能有更好的性能，但是您需要为几乎所有内容编写管理脚本，例如存储位置以处理鼠标坐标和地图对象，并且您必须手动重绘每个更改。所以性能主要取决于你对画布管理脚本的优化程度，我不确定是否已经有任何库，答案可能是肯定的。

SGV 正如其他人所说，它通常较慢，但这是因为它不是作为普通位图渲染的，它是矢量元素的 DOM。它也很容易处理事件，您可以将事件附加到任何元素（取决于浏览器实现），您可以将 css 应用于样式，并且可以轻松更改位置、大小、笔触、填充等属性。

对于平板电脑：如果您选择 svg，我会避免使用高分辨率纹理，不要使用 css3 box-shadow 到 svg 元素（使 ipad 非常滞后），并且我会避免使用 jquery 来操作 DOM 和拖放，而是在平板电脑上使用带有非常优化代码的纯 JavaScript。

# ruby-on-rails - 如何根据 Rails 中属性的存在创建条件？

> ID：13595852
> 
> 赞同：1
> 
> 时间：2012-11-28T00:39:30.590
> 
> 标签：ruby-on-rails, nomethoderror

我在 likes_controller 中有以下代码，只要 a`thing`有`owner`. 如果没有，它会破裂。

```
 def create
    @thing = Thing.find(params[:like][:liked_id])
    user = @thing.owner
    current_user.like!(@thing)
    current_user.follow!(user)
    respond_with @thing
  end 
```

我试过使用

```
user = @thing.owner if @thing.owner.exists? 
```

但我得到一个 NoMethodError：

```
NoMethodError in LikesController#create

undefined method `exists?' for nil:NilClass 
```

如何检查 是否存在`owner`？

我现在也注意到我必须将第二行 ( `current_user.follow!(user)`) 放在块中，否则它会再次中断......

编辑：这有效（使用@Amadan的回答）：

```
def create
    @thing = Thing.find(params[:like][:liked_id])
    current_user.like!(@thing)
    user = @thing.owner
    if user
      current_user.follow!(user)
    end
    respond_with @thing
  end 
```

附加信息：如果有人实际使用过它，我应该指出，还需要再做一点小改动才能让它工作。如果 a`user`尝试`like`a`thing`当它们已经`following`是`thing`'s时，上面的代码会出错`owner`。

所以而不是

```
if user 
```

我用了

```
if user && !current_user.following?(user) 
```

希望这会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:43:56.520

在 Rails 中，您可以：

```
user = @thing.owner if @thing.owner.present? 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:52:25.460

插入这一行：

```
return unless user 
```

有些人可能不喜欢它的风格，所以你可以使用这个替代方案：

```
def create
  @thing = Thing.find(params[:like][:liked_id])
  user = @thing.owner
  if user
    current_user.like!(@thing)
    current_user.follow!(user)
    respond_with @thing
  end
end 
```

# grails - 圣杯。调用保存后id为空

> ID：13595854
> 
> 赞同：7
> 
> 时间：2012-11-28T00:39:47.700
> 
> 标签：grails, null, save, flush

我已经对此进行了搜索，但仍然无法弄清楚我做错了什么。调用`save()`域对象后`id`是`null`.

我已经读过如果保存对象时出现问题会发生这种`save(flush:true)`情况，如果是这种情况应该会引发错误，但事实并非如此。看看我的代码和输出：

```
def pic = new Picture(title:'XX', path:"XXX")
album.addToPictures(pic).save()
if(pic.validate())
   println "no errors. New id: " + pic.id
else
   println "with errors" 
```

输出：

```
no errors. New id: null 
```

并且在使用 flush:true 时

```
def pic = new Picture(title:'XX', path:"XXX")
album.addToPictures(pic).save(flush:true)
if(pic.validate())
   println "no errors. New id: " + pic.id
else
   println "with errors" 
```

输出：

```
no errors. New id: 17 
```

如您所见，创建对象没有任何错误，我应该能够`id`在调用`save()`. 有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-28T00:55:16.593

您误解了对象实际持久保存到数据库的时间。当您调用时，对象不会被持久化`obj.save()`，它会在以下任何一个首先发生时被持久化：

*   调用 save() 的事务已提交
*   调用 save() 的 Hibernate 会话已关闭

可以使用显式启动事务

```
SomeDomainClass.withTransaction {
  // code in here runs within a transaction
} 
```

通常，每次调用服务方法时也会隐式启动事务

```
class MyService {

  void doSomething () {
    // code in here runs within a transaction
  }  
} 
```

如果您没有显式或隐式使用事务，则保存的对象会在 Hibernate 会话关闭时（大致）在 HTTP 请求完成时持久化。

但是，如果您调用`someObject.save(flush: true)`您是在告诉 Hibernate 立即持久化该对象，这就是为什么

```
album.addToPictures(pic).save(flush: true) 
```

`Picture`为实例分配一个 ID ，但是

```
album.addToPictures(pic).save() 
```

仅在封闭会话/事务关闭/提交时分配 ID

## 更新

进一步你的评论

> 问题是我想使用 id 作为我需要保存的文件名的一部分。如果我在保存文件时遇到错误怎么办？我应该使用显式事务并将其回滚吗？

是的，使用显式事务，并在确定对象已成功持久化后保存文件，如果持久性失败则回滚事务

```
def pic = new Picture(title:'XX', path:"XXX")

Picture.withTransaction { TransactionStatus status ->        

  try {
    album.addToPictures(pic).save()

  } catch(ex) {
    status.setRollbackOnly()
    throw ex
  }
}

// At this point you can be sure pic has been persisted, so use pic.id to save the file 
```

## 更新 2

根据您的评论

> 一旦确定对象已成功保存，我就不想保存文件，但相反，我想在文件成功保存后保存对象。因此，我将把我的问题重新表述为“有没有办法配置 Grails，以便在对象有效保存在数据库中之前，我可以知道将分配给新对象的 id？”

你已经知道了

```
album.addToPictures(pic).save(flush:true) 
```

将为您提供`Picture`实例的 ID，因此如果您在事务中执行此操作，则无需实际提交事务即可获得 ID。但是，我认为这仅在您使用使用序列的数据库（Oracle，Postgres）时才有效。像下面这样的东西应该工作

```
Picture.withTransaction { TransactionStatus status ->        

  try {
    def pic = new Picture(title:'XX', path:"XXX")  
    album.addToPictures(pic).save(flush: true)

    // pic.id should now be assigned, so save the file. I'm assuming an
    // an exception will be thrown if saving the file fails

  } catch(ex) {
    // you may also want to try rolling back the file save here, i.e. delete it
    status.setRollbackOnly()
    throw ex
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T00:44:46.210

> 那 save(flush:true) 应该抛出一个错误

这不是真的。 `save(failOnError: true)`将导致抛出异常。

您的代码没有任何问题，您看到的行为也没有任何问题。通过不调用flush；`save()`，您试图在实际插入发生之前访问生成的 ID。这就是为什么它是空的。

但是，强制刷新将（有时）强制休眠写入，然后为您提供您期望的 ID。如果您在呼叫后立即需要 ID `save()`，请使用`save(flush: true)`. 没有什么不妥。

# jqplot - 简单的图表线不显示

> ID：13595857
> 
> 赞同：0
> 
> 时间：2012-11-28T00:39:58.317
> 
> 标签：jqplot

```
$(document).ready(function(){
    var line0 =['2008-06-30 8:00AM', '2008-06-30 9:00AM', '2008-06-30 10:00AM', '2008-06-30 11:00AM', '2008-06-30 12:00PM' ];
    var line2=[4, 6.5, 5.7, 9, 8.2];
    var line3=[5, 5.5, 7.7, 11, 7.2];

    var t1=[91.51,91.74,91.62,91.40,91.51];

    var plot1 = $.jqplot('chartdiv4', [t1], {
        title: 'Concern vs. Occurrance',
        seriesDefaults:{renderer:$.jqplot.BarRenderer},
//        axesDefaults: {
//            tickRenderer: $.jqplot.CanvasAxisTickRenderer ,
//            tickOptions: {
//                angle: -30,
//                fontSize: '10pt'
//            }
//        },

        axes: {
            xaxis: {
                renderer: $.jqplot.DateAxisRenderer,
                ticks: line0, 
                tickOptions: {formatString:'%r'},
            },
            yaxis: {label: "Y Axis"}
        }
    })
});
</script> 
```

我正在寻找另一双眼睛。我无法绘制此图表。我看着它让自己发疯。我在这里做了一个jsfiddle：http: [//jsfiddle.net/Rich_Strle/gSQsL/3/](http://jsfiddle.net/Rich_Strle/gSQsL/3/)

如果我注释掉所有图表选项，线条会绘制。当我添加刻度和选项时，刻度会显示但没有线条。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T08:54:03.433

如果您使用的是，`DateAxisRenderer`它看起来好像每个数据点都必须是形式`[date, value]`。请参阅[http://www.jqplot.com/tests/date-axes.php](http://www.jqplot.com/tests/date-axes.php)。

这对我有用：

```
var data = [];

for(var i = 0; i < t1.length; i++){
    data.push([line0[i], t1[i]]);
}

var plot1 = $.jqplot('chartdiv4', [data], { .... 
```

# netbeans - 为什么我在 Java 中的 webproject 调用已经为包含的 Applet 加载了外部库

> ID：13595858
> 
> 赞同：2
> 
> 时间：2012-11-28T00:40:08.863
> 
> 标签：netbeans, applet, external, java

嗨，我编写了包含小程序的 Web 应用程序，我使用这个标签在 Html 页面中启动我的小程序

```
<applet codebase="http://localhost:8084/WebForSpark" code="AppletBroadcaster.ZkusebniApplet" archive="AppletBroadcaster.jar, jave.jar " width="500" height="500"></applet> 
```

我需要在我的小程序中使用外部库 jave.jar，所以我将此文件手动添加到我的 Webproject 的 bulid/web 文件夹中。所以一切运行良好。当运行我的 webproject java 控制台时写这个

```
Basic: Plugin2ClassLoader.getPermissions CeilingPolicy allPerms
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Connecting http://localhost:8084/ with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry found [url: http://localhost:8084/WebForSpark/jave.jar, version: null] prevalidated=false/0
cache: Resource http://localhost:8084/WebForSpark/jave.jar has expired.
network: Connecting http://localhost:8084/WebForSpark/jave.jar with proxy=DIRECT
network: ResponseCode for http://localhost:8084/WebForSpark/jave.jar : 304
network: Encoding for http://localhost:8084/WebForSpark/jave.jar : null
network: Disconnect connection to http://localhost:8084/WebForSpark/jave.jar
cache: Reading Signers from 1048 http://localhost:8084/WebForSpark/jave.jar | C:\Users\TTT\AppData\LocalLow\Sun\Java\Deployment\cache\6.0\3\65f57583-24e73fd0.idx
cache: Done readSigners(http://localhost:8084/WebForSpark/jave.jar)
cache:  Read manifest for http://localhost:8084/WebForSpark/jave.jar: read=1001 full=1001
security: Validate the certificate chain using CertPath API
security: The certificate hasnt been expired, no need to check timestamping info
security: Found jurisdiction list file
security: No need to checking trusted extension for this certificate
security: The CRL support is disabled
security: The OCSP support is disabled
security: This OCSP End Entity validation is disabled
security: Checking if certificate is in Deployment denied certificate store
security: Checking if certificate is in Deployment permanent certificate store
security: Checking if certificate is in Deployment session certificate store
security: Checking if certificate is in Internet Explorer TrustedPublisher certificate store
basic: Dialog type is not candidate for embedding 
```

所以很明显，我的 build/web 文件夹中的 jave.jar 是成立的。

但是当我在我的小程序中按下用于从 jave.jar 执行一些操作的按钮时，javaconsole 会这样写

```
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Connecting http://localhost:8084/ with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Cache entry not found [url: http://localhost:8084/WebForSpark/lib/jave.jar, version: null]
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT
network: Connecting http://localhost:8084/WebForSpark/lib/jave.jar with proxy=DIRECT 
```

jave.jar 应该做的所有事情都正确完成，但我的问题是为什么当我的 jave.jar 在

```
http://localhost:8084/WebForSpark/ 
```

并在小程序启动期间成功加载...我可以做什么来不调用 lib/jave.jar 以及为什么调用它？多谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T01:23:58.857

当前的小程序元素归结为。

```
<applet
    codebase="http://localhost:8084/WebForSpark"
    code="AppletBroadcaster.ZkusebniApplet"
    archive="AppletBroadcaster.jar, jave.jar"
    width="500"
    height="500">
</applet> 
```

这将使 JRE`http://localhost:8084/WebForSpark`从同一路径（或根据包的子目录）在 & （失败）处搜索 Jar 中的任何类。我怀疑这`jave.jar`实际上是另一个地方，所以`archive`属性应该更像：

```
<applet
    codebase="http://localhost:8084/WebForSpark"
    code="AppletBroadcaster.ZkusebniApplet"
    archive="AppletBroadcaster.jar, /path/to/jave.jar"
    width="500"
    height="500">
</applet> 
```

`/path/to/`可能在哪里`/lib/`或其他路径。

# ruby-on-rails - 将哈希数组转换为嵌套哈希数组

> ID：13595870
> 
> 赞同：1
> 
> 时间：2012-11-28T00:41:35.620
> 
> 标签：ruby-on-rails, hash

我想修改我的哈希数组以提高搜索性能

我有：

```
a = [ {"id" => 1, "name" => "Matt", "email" => "matt@example.com"}, {"id" => 2, "name" => "Charlie", "email" => "charlie@example.com"} ] 
```

我想将其转换为：

```
b = [ {1 => { "name" => "Matt", "email" => "matt@example.com"}},{2 => { "name" => "Charlie", "email" => "charlie@example.com"}} ] 
```

请注意，“id”字段不一定是连续的或连续的集合，但每次出现都是唯一的。此外，作为值嵌套在 b 中的散列可以包含“id”键/值对，如果这使事情变得更容易的话。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:50:49.827

要获得您描述的数组：

```
b = a.map {|i| { i["id"] => i } } 
```

但请注意，如果您这样做是为了执行有效的搜索，`id`则构建一个哈希而不是数组：

```
b = a.inject({}) {|h,i| h[i["id"]]=i; h} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T00:52:56.240

尝试：

```
a.map{|record| the_id = record.delete("id"); {the_id => record}} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T00:45:17.450

```
a.each_with_object({}) { |x, h| h[x.delete('id')] = x } 
```

这将构造一个新的散列 ( )，将它与每个元素`{}`一样传递到块中。在块中，从中删除键/值，并将其返回，以便它可以用作索引来为结果哈希分配值。`h``x``x.delete('id')``id``x``h`

根据 kmkaplan 的评论编辑：如果您仍然需要原始数组，请使用：

```
a.each_with_object({}) { |x, h| c = x.clone; h[c.delete('id')] = c } 
```

根据 kmkaplan 的其他评论进行编辑：如果 OP 真的不困惑，Nate Murray 的答案是正确的。

# html - 为什么 max-width 在表中的列上会直观地表现出反作用？

> ID：13595873
> 
> 赞同：0
> 
> 时间：2012-11-27T23:37:16.447
> 
> 标签：html, cross-browser, css

基本上，我有一个可伸缩的表格，我希望我的标签列是固定宽度，我的数据列是动态大小的。我的倾向是`max-width`在我的标签列上设置 via CSS。但是，这会***产生相反的***效果。[我创建了一个复制这个的 jsfiddle。](http://jsfiddle.net/gTbpZ/)（重新调整窗口大小以查看左列动态大小和右列固定大小）

在我自己的网站上，我看到了相同的行为，它发生在 IE 和 Chrome 中。

[如果我切换它并`max-width`在 data column 上进行](http://jsfiddle.net/5ZNSA/1/)设置，一切都会按照我的意愿行事，但对我来说却是一种倒退。我在这里做错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T16:35:38.813

使用 chrome 开发人员工具从数据列中删除 max-width 不会影响它。该类的该列中不需要它。因为表格是 100% 宽度，现在只有您的标签列设置了保持其大小的宽度。所以我猜它的工作原理？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T00:49:30.243

在桌子上设置宽度总是有点……奇怪。“宽度”实际上大部分时间都被认为是“最小宽度”，因为最初“最小宽度”并不存在。

`table-layout:fixed`但是现在，您可以通过添加到其 CSS来强制表格自行运行。

现在您还有另一个问题：此表格布局采用第一行中单元格的宽度，并将它们用于整个表格。

因此，您可以`<colgroup>`在表的第一行之前添加一个。这允许您设置有限数量的样式，但最重要的是`width`. 我从未尝试过使用`max-width`，但我想它可能会很好用。不过，使用百分比宽度可能会更安全。

# emacs - 在emacs中显示八度图输出？

> ID：13595874
> 
> 赞同：3
> 
> 时间：2012-11-28T00:42:09.210
> 
> 标签：emacs, plot, gnuplot, octave

在 emacs 中使用交互式 octave 提示时，绘图会出现在一个新的单独窗口中。（更糟糕的是，在我的配置中，这个窗口甚至不会自己被看到，并且不能通过键盘窗口切换来选择。）

有没有办法让 octave/gnuplot 输出显示在 emacs 缓冲区本身中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T07:54:37.443

如何使用[Emacs IPython Notebook](https://github.com/tkf/emacs-ipython-notebook)和[IPython octave magic](http://ipython.org/ipython-doc/rel-0.13/config/extensions/octavemagic.html)（示例输出： http: [//mentat.za.net/refer/octave_magic.pdf](http://mentat.za.net/refer/octave_magic.pdf)通过[https://github.com/ipython/ipython/pull/1849/](https://github.com/ipython/ipython/pull/1849/)）？免责声明：我编写了 Emacs IPython Notebook。

# javascript - HTML 结束标签 - PHP 没有看到它

> ID：13595875
> 
> 赞同：-2
> 
> 时间：2012-11-28T00:42:14.810
> 
> 标签：javascript, html, end-tag

> **可能重复：**
> [为什么自闭合脚本标签不起作用？](https://stackoverflow.com/questions/69913/why-dont-self-closing-script-tags-work)

我最近在 Ubuntu 上安装了 LAMP 服务器。我很好奇的是以下内容。

文件 test.php 中的这段代码有效：

```
<html>
<head>
<script type='text/javascript'>
</script>
</head>
... 
```

但是，此文件没有（仅`</script>`在代码中的下一个之后显示数据）

```
<html>
<head>
<script type='text/javascript'/>
</head>
... 
```

为什么 PHP（或 HTML）在第二种情况下不承认结束标记？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T00:45:23.817

不承认是因为：

```
<script> 
```

需要关闭

```
</script> 
```

而不仅仅是标签内的 / 。一些 HTML 标签就是这样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T00:46:33.163

您没有正确关闭脚本标签。不同的浏览器可能对此有不同的解释。尤其如此，因为您使用的是 HTML5 文档类型。

如果您使用的是 XHTML 文档类型，那么跨浏览器的自关闭脚本标签会更好。

尽管跨浏览器兼容性的最佳方法是在任何文档类型中根本不使用自闭合脚本标签。

这与 PHP 完全无关。所以不知道为什么在你的标题中。PHP 将继续并按原样呈现您的源代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T00:47:49.150

在第二种情况下，您在打开它的同时关闭了脚本标签：

> ``<script type='text/javascript'`**`/`**>`

我在上面强调了它。如果您查看您提供的第一段代码，您会看到一个脚本标签打开，一个关闭标签是正确的

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T00:48:28.953

正如这个答案中更详细的解释：[https](https://stackoverflow.com/a/206409/476786) ://stackoverflow.com/a/206409/476786 所有`html`标签都是有效的自闭合标签`xhtml`，即`application/xhtml+xml`。在普通的旧 html 中，`text/html`由服务器和浏览器来解释标签，从而导致实现不一致。

# ajax - 在返回数据的 AJAX 调用上处理 Jquery Promise

> ID：13595882
> 
> 赞同：1
> 
> 时间：2012-11-28T00:43:07.793
> 
> 标签：ajax, jquery-deferred

希望有一个关于 jQuery AJAX 调用的数据处理示例。我的 AJAX 调用运行 php 代码，如果不成功则返回 -1。迄今为止，我必须忽略 ajax 代码的返回承诺，而是创建并返回一个新的延迟对象，该对象根据返回数据解决或失败....出于某种原因，我怀疑有一种方法可以实现这一点更少的开销。当前样本为：

```
 send_Data = function(send_data) {
      var dfd = $.Deferred();
      $.post(sendData.php", send_data), function(data) {
      })
      .success(function(data) {if(data==-1) dfd.fail();
                              } else {dfd.resolve(data);}
      .error(function(e){log_error()})
      return  dfd.promise();
   } 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T16:58:28.717

您在提供的示例中犯了一些错误。这是我的 2 美分帮助

```
 myAjax = {
 ,dfd = $.Deferred();
,ajax: function () { $.ajax({
                             url: 'connectorURL'
                            ,type: "POST"
                            ,data: {
                                    ExpectedVariable: YouRDataVariable,                 
                            }
                            ,success: function(data){
                            if(data == '-1') {
                                this.dfd.fail();
                                } else {
                                this.dfd.resolve(data);
                                }
                            ,error: function(){
                            console.log('connector error',arguments);
                                }
                        });
                    }
}

$(document).ready(function(){
    myAjax.ajax();                         
}); 
```

# ruby-on-rails-3 - Rails 3：Has_many 和我

> ID：13595883
> 
> 赞同：2
> 
> 时间：2012-11-28T00:43:09.093
> 
> 标签：ruby-on-rails-3, activerecord, associations, has-many-through

我对 Rails 还很陌生，我得到了这段代码，但我认为我正在阻止它做它的一些 Rails 魔法：

**目标**：创建一个并让创建者通过表中的方法和关联`cause`成为成员。`build``has_many :through``Cause_User_Membership`

**问题**：我已经通过创建一个`cause`然后“手动”创建一个成员资格来实现它。有没有办法在`Cause_User_Membership`创建时自动创建关系`cause`？

**Cause_Controller.rb**

```
def create
@cause = current_user.causes.build(params[:cause].merge :created_by => current_user.id)

respond_to do |format|
  if @cause.save 
    @membership = current_user.cause_user_memberships.build(:cause_id => @cause.id)
    @membership.save
    format.json { render :json => {current_user: current_user, results: @cause}}
  else
    format.json { render :json => {Message: "You messed up"}}
  end
end
end 
```

**用户.rb（片段）**

```
has_many :cause_user_memberships
has_many :causes, :through => :cause_user_memberships 
```

**原因.rb**

```
attr_accessible :title, :location, :description,...
has_many :cause_user_memberships
has_many :users, :through => :cause_user_memberships 
```

**Cause_User_Membership.rb**（<--可能不是我最好的模型名称）

```
 # == Schema Information
#
# Table name: cause_user_memberships
#
#  id         :integer          not null, primary key
#  user_id    :integer          not null
#  cause_id   :integer          not null
#  created_at :datetime         not null
#  updated_at :datetime         not null
#

class CauseUserMembership < ActiveRecord::Base
  attr_accessible :cause_id, :user_id

  belongs_to :user #, :class_name => "User", :foreign_key => "user_id" 
  belongs_to :cause #, :class_name => "Cause", :foreign_key => "cause_id"

end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T00:09:09.410

**更新：**

我发现了一种更“神奇”的方式来使用[`accepts_nested_attributes_for`](http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html#method-i-accepts_nested_attributes_for). 首先，在`CauseUserMembership`模型中添加一行：

```
class CauseUserMembership < ActiveRecord::Base
  attr_accessible :cause_id, :user_id

  belongs_to :user
  belongs_to :cause 

  accepts_nested_attributes_for :cause 
```

通过该更改，您可以执行以下操作：

```
def create
  @membership = current_user.memberships.build
  @membership.cause = Cause.new(params[:cause].merge(:created_by => current_user.id)

  respond_to do |format|
    if @membership.save
      ... 
```

因为您已经告诉 rails 接受`cause`on 关联的嵌套属性，所以它会在保存成员资格本身时保存`CauseUserMembership`您分配给的新原因。`@membership.cause`因此，您可以一次保存原因和成员记录，而不是单独保存。

**原答案：**

我认为您所做的几乎是正确的方法。它可以简化一点：您不需要从 构建`cause`，`current_user`您只需使用`new`（创建时设置和设置的`:through`关联）。`cause``current_user``@membership`

所以像这样（我只改变了第一行`create`）：

```
def create
  @cause = Cause.new(params[:cause].merge(:created_by => current_user.id))

  respond_to do |format|
    if @cause.save
      @membership = current_user.cause_user_memberships.build(:cause_id => @cause.id)
      @membership.save
      ... 
```

另请参阅：[通过关联在 Rails 应用程序中构建/创建属性的多对多](https://stackoverflow.com/questions/9432343/many-to-many-through-association-build-create-properties-in-rails-app)

# c# - 试图让驱动程序处理 GPS 卡

> ID：13595885
> 
> 赞同：1
> 
> 时间：2012-11-28T00:43:44.033
> 
> 标签：c#, pinvoke, device-driver, createfile

当我调用 SetupDiEnumDeviceInterfaces 时，我得到了 success = false 并且最后一个错误是 ERROR_INVALID_USER_BUFFER 1784。不确定代码是否可以正常工作。我正在尝试从供应商那里移植 c 和 C++ 中的代码。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Microsoft.Win32;
using System.Runtime.InteropServices;
using System.Windows;
using System.Management;
using Microsoft.Win32.SafeHandles;
using System.IO;

namespace GPSTester.src.IPParallelHQT
{
class HaveQuick
{

    [DllImport("setupapi.dll", CharSet = CharSet.Auto)]
    static extern IntPtr SetupDiGetClassDevs(
        ref Guid ClassGuid,
        IntPtr Enumerator,
        IntPtr hwndParent,
        uint Flags
        );

    [DllImport(@"setupapi.dll", CharSet = CharSet.Auto, SetLastError = true)]
    public static extern Boolean SetupDiEnumDeviceInterfaces(
       IntPtr hDevInfo,
       ref DeviceInfoData devInfo,
        //           IntPtr devInfo,
       ref Guid interfaceClassGuid,
       UInt32 memberIndex,
       ref DeviceInterfaceData deviceInterfaceData
    );

    [DllImport(@"setupapi.dll", CharSet = CharSet.Auto, SetLastError = true)]
    public static extern Boolean SetupDiGetDeviceInterfaceDetail(
       IntPtr hDevInfo,
       ref DeviceInterfaceData deviceInterfaceData,
       ref DeviceInterfaceDetailData deviceInterfaceDetailData,
       UInt32 deviceInterfaceDetailDataSize,
       out UInt32 requiredSize,
       ref DeviceInfoData deviceInfoData
    );

    [DllImport("setupapi.dll", CharSet = CharSet.Auto, SetLastError = true)]
    static extern bool SetupDiBuildClassInfoList(
            UInt32 Flags,
            [In, Out] Guid[] ClassGuidList,
            UInt32 ClassGuidListSize,
            out UInt32 RequiredSize);

    [DllImport("setupapi.dll", SetLastError = true)]
    static extern bool SetupDiEnumDeviceInfo(
        IntPtr deviceInfoSet, 
        uint memberIndex, 
        ref DeviceInfoData deviceInfoData);

    [DllImport("Kernel32.dll", SetLastError = true, CharSet = CharSet.Auto)]
    static extern IntPtr CreateFile(
        string fileName,
        [MarshalAs(UnmanagedType.U4)] FileAccess fileAccess,
        [MarshalAs(UnmanagedType.U4)] FileShare fileShare,
        int securityAttributes,
        [MarshalAs(UnmanagedType.U4)] FileMode creationDisposition,
        int flags,
        IntPtr template);

    [StructLayout(LayoutKind.Sequential)]
    public struct DeviceInterfaceData
    {
        public uint cbSize;
        public Guid interfaceClassGuid;
        public uint flags;
        public IntPtr reserved;
    }

    [StructLayout(LayoutKind.Sequential)]
    public struct DeviceInfoData
    {
        public uint cbSize;
        public Guid ClassGuid;
        public uint DevInst;
        public IntPtr Reserved;
    }

    // Device interface detail data
    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]
    public struct DeviceInterfaceDetailData
    {
        public UInt32 cbSize;
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 256)]
        public string DevicePath;
    }

    private const int ERROR_NO_MORE_ITEMS = 259;

    public enum DeviceFlags 
    {
        Default = 0x00000001, // only valid with DeviceInterface
        Present = 0x00000002,
        AllClasses = 0x00000004,
        Profile = 0x00000008,
        DeviceInterface = 0x00000010,
    }

    public const short INVALID_HANDLE_VALUE = -1;

    int lastError;

    public HaveQuick()
    {
        bool success = true;

        Guid GUID_DEVINTERFACE_IPHQT = new Guid(0x13FF045F, 0xe9D2, 0x479C, 0xB3,   0x90, 0x8C, 0xAE, 0xC7, 0xD1, 0x1C, 0xC4);
        IntPtr hDeviceInfo = SetupDiGetClassDevs(ref GUID_DEVINTERFACE_IPHQT, IntPtr.Zero, IntPtr.Zero, (uint)(DeviceFlags.Present | DeviceFlags.DeviceInterface));
        if (hDeviceInfo == IntPtr.Zero)
        {
            lastError = Marshal.GetLastWin32Error();
            Console.WriteLine("**Error: couldn't get class info error code = {0}\n");
            return;
        }

        uint devNum = 0x0000;    //Enter board number(starting from zero)
        // Find the interface for device devNum
        DeviceInterfaceData interfaceData = new DeviceInterfaceData();                  // Interface data for this device
        interfaceData.cbSize = (uint)Marshal.SizeOf(interfaceData);
        success = SetupDiEnumDeviceInterfaces(hDeviceInfo, ref deviceInfoData, ref GUID_DEVINTERFACE_IPHQT, devNum, ref interfaceData);
        if (!success)
        {
            lastError = Marshal.GetLastWin32Error();
            Console.WriteLine("**Error: couldn't enum device error number = {0}\n", lastError);
        }

        // Found our device, get the details data to obtain the symbolic link name

        UInt32 requiredSize;                 // Size of buffer reguired to get the symbolic link name
        DeviceInterfaceDetailData deviceDetailData = new DeviceInterfaceDetailData();
        uint deviceInterfaceDetailDataSize = (uint)Marshal.SizeOf(deviceDetailData);
        success = SetupDiGetDeviceInterfaceDetail(hDeviceInfo, ref interfaceData, ref deviceDetailData, deviceInterfaceDetailDataSize, out requiredSize, ref deviceInfoData);
        if (!success)
        {
            lastError = Marshal.GetLastWin32Error();
            Console.WriteLine("**Error: couldn't get interface detail error number = {0}\n", lastError);
        }

        // Get the detail info
        success = SetupDiGetDeviceInterfaceDetail(hDeviceInfo, ref interfaceData, ref deviceDetailData, deviceInterfaceDetailDataSize, out requiredSize, ref deviceInfoData);
        if (!success)
        {
            lastError = Marshal.GetLastWin32Error();
            Console.WriteLine("**Error: couldn't get interface detail(2) error number = {0}\n", lastError);
        }
        string deviceName = deviceDetailData.DevicePath;
        IntPtr  hIpHqt = CreateFile(deviceName, 
                                FileAccess.Read | FileAccess.Write,
                                FileShare.Read | FileShare.Write,
                                0, FileMode.Open, 0, IntPtr.Zero);

        if (hIpHqt == IntPtr.Zero)
        {
            lastError = Marshal.GetLastWin32Error();
            Console.WriteLine("**Error: couldn't open %s, (%d)\n", deviceName, lastError);
        }
    }

}

} 
```

# c# - 如何确定服务器上是否存在 Internet 文件？

> ID：13595888
> 
> 赞同：0
> 
> 时间：2012-11-28T00:44:00.667
> 
> 标签：c#, httpwebrequest

直到最近，我还使用 HttpWebRequest 来确定 Internet 上是否存在文件。但是现在，我意识到如果服务器不存在，它可以处理 404，我只会得到默认的 404 服务器错误页面。在这种情况下，HttpWebRequest**不会引发异常。**我想不出一种方法来判断是否发生了 404 错误。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:47:25.003

检查`StatusCode`和`StatusResponse`中的`HttpWebResponse`。您可以随时`throw`根据收到的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:48:55.350

在返回“找不到页面”页面的服务器上，如果您尝试在浏览器中获取不存在的文件并查看开发工具，则返回代码仍然是 404 Not Found。

通常，您希望该`HttpWebRequest.GetResponse`方法返回一个 http 响应代码，但[.NET 会为 http 错误引发异常](http://www.motobit.com/tips/detpg_net-getresponse-404/)。

```
try {  
    HttpWebRequest httpReq = (HttpWebRequest)WebRequest.Create("http://www.contoso.com");
    using (HttpWebResponse httpRes = (HttpWebResponse)httpReq.GetResponse())
    {            
        if (httpRes.StatusCode == HttpStatusCode.OK)
            Console.WriteLine("\r\nResponse Status Code is OK and StatusDescription is: {0}", httpRes.StatusDescription);
        // Releases the resources of the response.
        httpRes.Close();
    }
}
catch (WebException ex) {
    Console.WriteLine("Error returned: {0}",ex.Response);
    // can throw again here.
    throw;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T00:57:12.257

如果`GetResponse`或它的异步等价物正在抛出，抓住它`WebException`，你会发现它有许多方便的属性。

特别是，[WebException.Response](http://msdn.microsoft.com/en-us/library/system.net.webexception.response.aspx)可能对您非常有用。

# c++ - 如何在 operator[] 声明中将 decltype 应用于成员函数

> ID：13595889
> 
> 赞同：1
> 
> 时间：2012-11-28T00:44:05.330
> 
> 标签：c++, templates, c++11

```
template <typename T>
class smart_ptr
{
public:
    // ... removed other member functions for simplicity
    T* get() { return ptr; }

    template <typename U>
    auto operator [](U u) const -> decltype((*get())[u])
    {
        return (*get())[u];
    }

    template <typename U>
    auto operator [](U u) -> decltype((*get())[u])
    {
        return (*get())[u];
    }

/*
    // These work fine:

    template <typename U>
    int operator [](U u)
    {
        return (*get())[u];
    }

    template <typename U>
    int& operator [](U u)
    {
        return (*get())[u];
    }
*/
private:
    T* ptr;
};

struct Test
{
};

struct Test2
{
    int& operator [](int i) { return m_Val; }
    int operator [](int i) const { return m_Val; }

    int m_Val;
};

int main()
{
    smart_ptr<Test> p1;
    smart_ptr<Test2> p2;
    p2[0] = 1;
} 
```

错误：

```
prog.cpp: In function 'int main()':
prog.cpp:55:9: error: no match for 'operator[]' in 'p2[0]' 
```

ideone：http: [//ideone.com/VyjJ28](http://ideone.com/VyjJ28)

我试图在没有明确指定`operator []`返回类型的情况下使 smart_ptr 与返回类型一起工作。但是，从上面很明显，编译器无法编译代码。如果有人可以帮助我，我将不胜感激。`T::operator []``int`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T01:23:46.610

看来您想要更好的编译器错误。以下是[clang](http://clang.llvm.org/)对这个来源的看法（好吧，它说了很多，但这描述了问题）：

```
decltype.cpp: In instantiation of ‘class smart_ptr<Test>’:
decltype.cpp:53:21:   required from here
decltype.cpp:9:51:error: cannot call member function ‘T* smart_ptr<T>::get() [with T = Test]’ without object
     auto operator [](U u) const -> decltype((*get())[u])       
                                                   ^ 
```

该问题的解决方法是调用`get()`一个对象，例如：

```
auto operator[](U u) const -> decltype((*this->get())[u]) 
```

（当然，这也要求有一个`const`成员`get()`）。

# java - 带有递归的回文检查器？

> ID：13595890
> 
> 赞同：0
> 
> 时间：2012-11-28T00:44:09.820
> 
> 标签：java, recursion

我正在制作一个 java 程序来检查用户的输入，看看它是否是回文。我的代码在下面，但在：

```
if(isPalindrome() = true)
     System.out.println("You typed a palindrome!"); 
```

部分我收到错误消息“赋值的左侧必须是变量”。不是变量吗？我能做些什么来解决它？任何建议表示赞赏！

```
public class PalindromeChecker
{
public static void main(String [] args)
{
    String answer;
    while(answer.equalsIgnoreCase("y"))
    {
        System.out.println("Please enter a String of characters.  I will check to see if");
        System.out.println("what you typed is a palindrome.");
        Scanner keys = new Scanner(System.in);
        String string = keys.nextLine();
        if(isPalindrome() = true)
            System.out.println("You typed a palindrome!");
        else
            System.out.println("That is not a palindrome.");
        System.out.print("Check another string? Y/N: ");
        answer = keys.next();
    }
}

public static boolean isPalindome(String string)
{
    if(string.length() <= 0)
        System.out.println("Not enough characters to check.");
    string = string.toUpperCase();
    return isPalindrome(string,0,string.length()-1);
}

private static boolean isPalindrome(String string, int last, int first)
{
    if(last <= first)
        return true;
    if(string.charAt(first) < 'A' || (string.charAt(first) > 'Z'))
        return isPalindrome(string,first + 1, last);
    if(string.charAt(last) < 'A' || (string.charAt(last) > 'Z'))
        return isPalindrome(string,first, last - 1);
    if(string.charAt(first) != string.charAt(last))
        return false;
    return isPalindrome(string,first + 1, last - 1);
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T00:45:38.793

使用双等号`==`进行比较。一个等号`=`是赋值运算符。

```
if (isPalindrome() == true) 
```

或者更好的是，根本不使用布尔比较`==`。如果你只写，它读起来更像英语：

```
if (isPalindrome()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T00:45:55.923

您的方法调用应该是： isPalindrome 期望字符串参数：

```
if(isPalindome(string )) 
```

而且您不需要进行相等性检查，因为返回类型无论如何都是布尔值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T00:46:02.100

利用

```
if(isPalindome(string)==true) 
```

反而。

两个变化：

1) 你需要传递`string`给`isPalindome`.

2）为了比较，您需要使用两个等号，而不仅仅是一个。

另外，我相信您可能打算写“isPalindrome”而不是“isPalindome”

# apache - 拒绝对文件的所有访问，但只有一个 ip | htaccess

> ID：13595893
> 
> 赞同：3
> 
> 时间：2012-11-28T00:44:18.003
> 
> 标签：apache, .htaccess

我尝试了以下但不起作用（没有人可以访问文件，包括我希望它访问的 IP）

```
<Files something.php>
Order allow,deny
Deny from all
allow from zzz.zzz.zzz.zzz
</Files> 
```

我想拒绝除一个 ip 之外的全世界对文件的访问，我该怎么做？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T02:10:24.717

我在一篇较早的帖子中找到了我的答案，其中一个答案在这里：[.htaccess: 如何限制通过 IP 访问单个文件？](https://stackoverflow.com/questions/3604526/htaccess-how-to-restrict-access-to-a-single-file-by-ip?rq=1)，正确的是：

```
 <Files something.php>
 Order deny, allow
 Deny from all
 allow from zzz.zzz.zzz.zzz
</Files> 
```

从原来的我将“命令允许，拒绝”更改为“命令拒绝，允许”并且它有效！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-19T05:38:02.023

它不起作用的原因是您的`Deny`指令覆盖了您的`Allow`指令。什么`Order Allow,Deny`是：

1.  评估`Allow`，如果有任何匹配，则标记“允许”。
2.  评估`Deny`，如果有任何匹配则标记“拒绝”（即使之前匹配`Allow`）
3.  评估标志。如果未设置标志，则拒绝它。

**因此，如果您不**希望所有请求都被拒绝，则**需要**删除。只是 MickeyRoush 回答的一个注释。 **`Deny from All`**

 **至于`Order Deny,Allow`，它是“相反的”：

1.  评估`Deny`，如果有任何匹配，则标记“拒绝”。
2.  评估`Allow`，如果有任何匹配则标记“允许”（即使之前匹配`Deny`）
3.  评估标志。如果未设置标志，则允许。

有关更多信息，请参阅 MickeyRoush 提供的链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T18:21:28.287

实际上，您使用的第一个指令会起作用，但它需要在正确的位置。

```
Order Allow,Deny
<Files something.php>
Allow from zzz.zzz.zzz.zzz
</Files> 
```

请注意，我删除了所有拒绝，因为它不是必需的。

[http://httpd.apache.org/docs/2.2/mod/mod_authz_host.html#order](http://httpd.apache.org/docs/2.2/mod/mod_authz_host.html#order)**

# jquery - jQuery 覆盖的背景图像不显示，但工作正常（IE10/Chrome）

> ID：13595900
> 
> 赞同：0
> 
> 时间：2012-11-28T00:44:53.037
> 
> 标签：jquery, html, css, overlay, background-image

我在[这里](http://jquerytools.github.com/demos/overlay/apple.html)使用示例作为起点。我有一个网站，我想添加覆盖功能。我已经从上面的链接中复制了代码。覆盖按预期工作，但我没有看到关闭按钮。

我可以在 Chrome 和 IE10 中单击它，然后在覆盖层外部单击以将其关闭。但是，不显示 x 标记。我尝试更改 z-index 无济于事。关闭类应该是自动生成的。我弄乱了所有其他 css 属性，图像响应。除了显示实际图像。我以为是路径，所以我将图像移动到根文件夹，仍然没有。

```
.apple_overlay .close {
background-image:url(close.png);
background-color:darkgreen;
position:absolute; right:5px; top:5px;
cursor:pointer;
height:35px;
width:35px; 
```

}

我在这里想念什么？感谢您的关注。

# java - 从集合或列表中返回最高的 int

> ID：13595901
> 
> 赞同：0
> 
> 时间：2012-11-28T00:44:58.047
> 
> 标签：java, int

我知道我可以`Math.max(int, int)`用来返回两个整数中的最高值，但是假设我有一个 SQL 表，其中包含名称、某种排名/分数（以整数的形式），我如何获取这些分数并获得其中最高的？

或者，我怎样才能将它们从高到低排序，然后我可以处理其余的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T00:50:20.553

你可以通过一个简单的 MySQL 查询来做到这一点。

例子：

```
SELECT * FROM table_name ORDER BY score DESC LIMIT 1; 
```

第一行将是最高的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T00:52:01.937

好吧，排序比找到最大值更昂贵。

找到最大值的可能最流行的代码是：

```
int max = data[0];
for (int i = 1; i < data.length; i++) {
    max = Math.max(max, data[i]);
} 
```

这样做并没有错。

排序会起作用，但排序是 in `O(n log n)`，而这显然只是`O(n)`。

# c - 如何将 4x5 矩阵中的行左移 2 个元素

> ID：13595907
> 
> 赞同：-1
> 
> 时间：2012-11-28T00:45:39.917
> 
> 标签：c, arrays, matrix

> 给定一个数组 p[5]，编写一个函数将其循环左移两个位置。因此，如果 p[0] = 15, p[1]= 30, p[2] = 28, p[3]= 19 和 p[4] = 61，那么在移位后 p[0] = 28, p[ 1] = 19, p[2] = 61, p[3] = 15 和 p[4] = 30。为 (4 x 5 ) 矩阵调用此函数并将其行左移 2。

下面是我到目前为止的代码，但它不起作用。问题在于，由于辅助函数需要一个参数`int *`，它不会在主函数中使用数组，因此它做的不对。虽然它编译得很好。

```
#include<stdio.h>

void moveLeft2(int p[5])
{
    int temp1 = p[0];
    int temp2 = p[1];

    for(int i = 0; i <  5 - 2; i++)
    {
        p[i] = p[i + 2];
    }

    p[3] = temp1;
    p[4] = temp2;
}

int main()
{
    int p[4][5] = {
        {15,30,28,19,61},
        {1,2,3,4,5},
        {6,7,8,9,20},
        {11,12,13,14,15}};
    int i;

    moveLeft2(p);
    return 0;
} 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T01:36:06.603

```
void moveLeft2(int p[5]) 
```

那个声明实际上是一个谎言。它的意思是

```
void moveLeft2(int *p) 
```

即传递给的参数`moveLeft2`应该是一个指向`int`. 该实现假定指针指向一个足够大的内存块以容纳五个`int`s，这不是由类型强制执行的，因此是不安全的，但这里重要的一点是函数参数必须具有 type `int*`。

如果你有

```
int row[5] = {1,2,3,4,5};
moveLeft2(row); 
```

即使在最高警告级别，编译器也不会发出警告。这是因为数组在传递给函数时会转换为指向其第一个元素的指针（以及在大多数其他上下文中；数组**不会**转换为指向其第一个元素的指针作为`sizeof`,`_Alignof`和`&`[address] 运算符的参数）。因此，传递的参数正好具有所需的类型。

宣言

```
int p[4][5] = {...}; 
```

声明`p`为 4 个数组，`int`每个数组 5 秒。`p[0]`是第一个`int[5]`，所以

```
moveLeft2(p[0]); 
```

是一个类型正确的函数调用（数组`p[0]`被转换为指向其第一个元素的指针，即`&p[0][0]`）。该数组`p[0]`是一个由五个组成的数组`int`s的数组，所以满足实现中的假设，`moveLeft2`调用不仅类型正确，而且语义正确。

这同样适用于数组（数组）的其他行`p`，因此

```
for(i = 0; i < 4; ++i) {
    moveLeft2(p[i]);
} 
```

一个接一个地移动所有四行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T07:01:17.747

**替代品：**

*   `void moveLeft2(int p[5])`和`void moveLeft2(int *p)`
*   `moveLeft2(p);`和`moveLeft2(p[i]);`
*   `for (i = 0; i < 4; i ++)`之前添加`moveLeft2(p[i]);`

**代码：**

```
#include<stdio.h>

void moveLeft2(int *p)
{
    int temp1 = p[0];
    int temp2 = p[1];
    int i;

    for(i = 0; i <  5 - 2; i++)
    {
        p[i] = p[i + 2];
    }

    p[3] = temp1;
    p[4] = temp2;
}

int main()
{
    int p[4][5] = {
        {15,30,28,19,61},
        {1,2,3,4,5},
        {6,7,8,9,20},
        {11,12,13,14,15}};
    int i;

    for (i = 0; i < 4; i ++)
        moveLeft2(p[i]);
    return 0;
} 
```

# java - 小程序中的井字游戏：图像不工作

> ID：13595908
> 
> 赞同：0
> 
> 时间：2012-11-28T00:45:51.307
> 
> 标签：java, jframe, japplet

```
/**
 *
 * @author suchit
 * Date : 11/25/2012
 * History :
 */

import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.GridLayout;
import java.awt.Image;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.io.File;
import java.io.IOException;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.imageio.ImageIO;
import javax.swing.JApplet;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.border.LineBorder;

/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

public class TicTacToe extends JApplet {

    static Cell[] arrCell=new Cell[9];
    static int fsize=400;
    static char drawCh;
    static JLabel lblMsg = new JLabel("Start the game: Player1 mark X");
    static boolean gameOver = false;
    static JFrame frame = new JFrame("TicTacToe Game");
    JButton btnStart = new JButton("New Game");
    static Image bg;
    static File fn;
    /**
     * @param args the command line arguments
     */
    public TicTacToe()      //default constructor
    {
      JPanel objPanel = new JPanel(new GridLayout(3, 3, 0, 0));     //creates j panel
      for(int i=0;i<9;i++)              // add nine objects on jpanel
        {
            arrCell[i]=new Cell();
        }  
      for(int i=0;i<9;i++)
        {
            objPanel.add(arrCell[i]);
        }

       objPanel.setBorder(new LineBorder(Color.BLACK, 1));      // create border
       //objPanel.add(btnStart);//add button
       objPanel.add(lblMsg);    // Display message
       //btnStart.addActionListener(new StartAction());       // Add action listener to the button

 // Place the panel and the label to the applet
        add(objPanel, BorderLayout.CENTER);
        add(lblMsg, BorderLayout.SOUTH);
        //add(btnStart,BorderLayout.NORTH);
    } // end of constructor
    public static void main(String[] args) {
        // TODO code application logic here

        frame.setSize(new Dimension(fsize,fsize));
        //frame.setPreferredSize();
        TicTacToe objTicTacToe = new TicTacToe();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setVisible(true);

        frame.add(objTicTacToe);

    } // end of main

class StartAction implements ActionListener
    {

        public void actionPerformed(ActionEvent e)
        {
            fsize++;
            drawCh='A';
            gameOver=false;
            for(int i=0; i<9;i++)
            {
                arrCell[i].value='A';
            }
            frame.setSize(new Dimension(fsize,fsize));
            lblMsg.setText("Player1's Turn: mark X");
        }
    } // end of class StartAction

    public static boolean isGameOver()          // checks wather any one won and game is over
 {
     boolean winner=false;
     boolean Draw=false;
     //if any three consucutive rows will have same value then player won the game
     if((arrCell[0].value ==drawCh && arrCell[1].value== drawCh &&arrCell[2].value==drawCh))
     {
         winner=true;
     }
     if((arrCell[3].value ==drawCh && arrCell[4].value== drawCh &&arrCell[5].value==drawCh))
     {
         winner=true;
     }
     if((arrCell[6].value ==drawCh && arrCell[7].value== drawCh &&arrCell[8].value==drawCh))
     {
         winner=true;
     }
     if((arrCell[0].value ==drawCh && arrCell[3].value== drawCh &&arrCell[6].value==drawCh))
     {
         winner=true;
     }
     if((arrCell[1].value ==drawCh && arrCell[4].value== drawCh &&arrCell[7].value==drawCh))
     {
         winner=true;
     }
     if((arrCell[2].value ==drawCh && arrCell[5].value== drawCh &&arrCell[8].value==drawCh))
     {
         winner=true;
     }
     if((arrCell[0].value ==drawCh && arrCell[4].value== drawCh &&arrCell[8].value==drawCh))
     {
         winner=true;
     }
     if((arrCell[2].value ==drawCh && arrCell[4].value== drawCh &&arrCell[6].value==drawCh))
     {
         winner=true;
     }

     if(winner)
     {
         if(drawCh=='X')
            lblMsg.setText("Player1 Won, Game Over");   // player 1 won
         else if(drawCh=='O')
             lblMsg.setText("Player2 Won, Game Over");  // player 2 won
         else
             winner=false;      // no one won, its a default values of all boxes

     }
     for(int i=0;i<9;i++)
     {
         if(arrCell[i].value=='A')
         {
            Draw=false;
            break;
         }
         else
            {
            Draw=true;
            }
     }
if(Draw)
{
    lblMsg.setText("Game Over : Result Draw");
}
     System.out.println("Draw="+Draw);
     return winner;

 } // end of isGameOver()
 public static class Cell extends JPanel
 {
     char value='A';
     public Cell()
     {
         this.setBorder(new LineBorder(Color.black, 1)); // Set cell's border
         this.setPreferredSize(new Dimension(100,100));
         addMouseListener(new MouseListener());
     }

     private class MouseListener extends MouseAdapter {
 /** Handle mouse click on a cell */
 public void mouseClicked(MouseEvent e){

 if(!gameOver && value=='A')       
 {
        if(drawCh=='X')     // set the message for the next player and current image to draw
        {
            lblMsg.setText("Player1's Turn: mark X");
            drawCh='O';
        }

        else if(drawCh=='O')    // set the message for the next player and current image to draw
        {
            lblMsg.setText("Player2's Turn: mark O");
            drawCh='X';
        }
        else        // set the message for the next player and current image to draw at start of the game
        {
         drawCh='X';
         lblMsg.setText("Player2's Turn: mark O");
        }       
        repaint();
        value=drawCh;
    }

 }   // end of mouseClicked

} // end of MouseListener

      protected void paintComponent(Graphics g) 
      {
         try {
             //super.paintComponent(g);
             System.out.println("gameOver = "+gameOver);
           System.out.println("Drawing");
           if (drawCh == 'X')      // draw X
              {
               fn = new File("D:\\Java Projects\\HW9\\images\\tictactoeX.png");
               bg = ImageIO.read(fn);
               g.drawImage(bg, 0, 0, this);
               //g.drawLine(10, 10, getWidth() - 10, getHeight() - 10);
                // g.drawLine(getWidth() - 10, 10, 10, getHeight() - 10);
              }
           else if (drawCh == 'O') // Draw O
              {
               fn = new File("D:\\Java Projects\\HW9\\images\\tic-tac-toe-O.png");   
               bg = ImageIO.read(fn);
               g.drawImage(bg, 0, 0, this);
               //g.drawOval(10, 10, getWidth() - 20, getHeight() - 20);
              }

           gameOver=isGameOver();
         } // end of paint component
         catch (IOException ex) {
             Logger.getLogger(TicTacToe.class.getName()).log(Level.SEVERE, null, ex);
         }
 }  // end of paint component

 } // end of Cells

}   // end of tictactoe 
```

我已经为井字游戏编写了代码。现在我以某种方式编写代码，使其既可以用作应用程序，也可以用作小程序。但问题是当我将它作为小程序运行时它不显示图像。我尝试了 drawLine 和 drawOwal 方法而不是绘制图像，并且效果很好。

但是我的教授希望我必须使用图像来运行它。任何人都可以给我任何解决方案吗？

提前致谢。还用这篇文章上传代码。如果有人有解决方案，请告诉我。我明天需要展示作业... :(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T10:54:56.097

小程序是沙盒的，因此无权访问小程序代码来源之外的资源。另外，不要从该`paintComponent`方法加载图像。而是从`init`被调用一次的小程序方法加载：

```
public void init() {
    xImage = getImage(getDocumentBase(), "tictactoeX.png");
    oImage = getImage(getDocumentBase(), "tictactoeO.png");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T01:11:42.033

Applet 无法写入或读取本地文件。

# javascript - Sqlite CREATE TABLE IF NOT EXISTS 不起作用？

> ID：13595912
> 
> 赞同：0
> 
> 时间：2012-11-28T00:45:59.357
> 
> 标签：javascript, sqlite

我错过了什么？我可以在 Inspector 窗口中看到数据库，但没有表。我可以在控制台中创建表格并显示它们，但它们不会自动出现。

这是 openDatabase 调用：

```
<script>var newdb = openDatabase('db2', '1.00', 'DB1', (100 * 1024 * 1024)); 
```

如果它们不存在，这是创建表的调用：

```
 newdb.transaction(function (tx) {
      tx.executeSql('CREATE TABLE IF NOT EXISTS LOGS (id unique, log)');
      tx.executeSql('CREATE TABLE IF NOT EXISTS OBSERVATIONS (observation_id unique,     field_id, observation_date, phase_id, magnitude_id, summary)');
      tx.executeSql('INSERT INTO LOGS (id, log) VALUES (1, "Test Field 1")');
      tx.executeSql('INSERT INTO LOGS (id, log) VALUES (2, "Test Field 2")');
      tx.executeSql('INSERT INTO LOGS (id, log) VALUES (4, "Test Field 3")');
      tx.executeSql('INSERT INTO OBSERVATIONS (observation_id, field_id, observation_date, phase_id, magnitude_id, summary, plant_no) VALUES (1, 1, "1/1/2012", 1234, 5678, "This is Observation 1", 100)');
      tx.executeSql('INSERT INTO OBSERVATIONS (observation_id, field_id, observation_date, phase_id, magnitude_id, summary, plant_no) VALUES (2, 1, "1/2/2012", 1234, 5679, "This is Observation 2", 101)');
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T01:08:41.473

啊。我是个白痴。

我在插入观察时有错误的论点。

# c - 未定义对 rdtsc 的引用

> ID：13595919
> 
> 赞同：1
> 
> 时间：2012-11-28T00:46:32.320
> 
> 标签：c, rdtsc

我正在编写创建树的代码和不同的创建树的方法。不过，我似乎无法让 rdtsc 正常运行。

这是我的代码：

```
 #include <stdio.h>
    #include <stdlib.h>
    #define SIZE 10
    struct tnode {
        int val;
        struct tnode *left;
        struct tnode *right;
    };
    struct tnode *addnode(struct tnode *p, long n);
    void treeprint(struct tnode *p);

    main () {
        long data[SIZE]={6, 3, 8, 1, 7, 5, 2, 9, 0, 4};
        int i;
        struct tnode *node, *root;
        unsigned long long rdtsc();
        unsigned long long a, b;

        printf("size of tnode   = %d\n", sizeof(struct tnode));
        printf("size of *node = %d\n", sizeof *node);
        printf("size of &node = %d\n", sizeof &node);
        printf("size of root = %d\n", sizeof root);
        printf("size of *root = %d\n", sizeof *root);
        printf("size of &root = %d\n", sizeof &root);

        a = rdtsc();
        root = NULL;
        for (i = 0; i < SIZE; i++)
            root = addnode(root, data[i]);
        b = rdtsc();
        treeprint(root);
        printf("It took %llu to make this tree.\n", b-a);
    } 
```

假设上面列出的所有函数都得到了处理（当然，除了 rdtsc）。

当我尝试编译时，我收到此错误：

```
/tmp/cccnojMf.o: In function `main':
tree.c:(.text+0xd9): undefined reference to `rdtsc'
tree.c:(.text+0x120): undefined reference to `rdtsc'
collect2: ld returned 1 exit status 
```

任何想法为什么我会收到这个未定义的参考错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:58:14.870

添加它并用作函数。

```
 __inline__ uint64_t rdtsc(void)
   {
uint32_t lo, hi;
__asm__ __volatile__ (
        "xorl %%eax,%%eax \n        cpuid"
        ::: "%rax", "%rbx", "%rcx", "%rdx");
__asm__ __volatile__ ("rdtsc" : "=a" (lo), "=d" (hi));
return (uint64_t)hi << 32 | lo;
 } 
```

# android - LocalBroadcastManager 与 Context.registerReceiver()、Context.sendBroadcast(Intent) 和 Context.unregisterReceiver() 是否相同？

> ID：13595925
> 
> 赞同：38
> 
> 时间：2012-11-28T00:47:17.873
> 
> 标签：android, broadcastreceiver

我正在使用`Context.registerReceiver(), Context.sendBroadcast(Intent) , and Context.unregisterReceiver()`

但是当我看到这个类时`LocalBroadcastManager`，它已经`registerReceiver(), sendBroadcast(Intent) ,`和`unregisterReceiver()`喜欢了`Context`。

我很困惑。我应该什么时候使用`LocalBroadcastManager`？他们一样`Context`吗？

问候，

谢谢...

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-11-28T03:42:20.860

LocalBroadcastManager 顾名思义，是**仅对**您的应用程序可用的广播方法的实现。这有一些好处，最大的好处是安全，少了一个需要注意的洞。在实施方面，有几点需要牢记：

*   此类来自 Android 支持库
*   方法调用必须以`LocalBroadcastManager.getInstance([CONTEXT])`where`[CONTEXT]`是 Context 类的子类开头，例如 Activity。
*   当你使用这个类时，它纯粹是为了**你的**应用程序。使用它来注册接收器并进行系统范围的广播将失败。

所以这个类与 Context 不同，它只是一个非常具体的、仅限应用程序的 Context 接收器/广播方法的实现。当您的听众绝对没有必要收听全局（系统范围）广播并且您的广播不需要针对您的应用程序之外的任何内容时，您应该使用它。

# java - Esper窗口使用：基于事件离开窗口的重新计算

> ID：13595930
> 
> 赞同：1
> 
> 时间：2012-11-28T00:47:34.223
> 
> 标签：java, esper, complex-event-processing

我需要有点像这样。

```
//Create a named window (w1)
Create window w1....

//then insert events into window
insert into w1....
select amount,.....
from....
where...

//remove from window
on RemoveEventArrived as r
Delete from w1
where w1.id = r.id 
```

现在从 w1 命名窗口插入另一个事件

```
//inserting into final output event
insert into derivedevent
select sum(w.amount)
from w1 as w

suppose event sequence:
1\. Event with id=1 and amount= 100 arrived.
   o/p of sum(amount) triggered and gives 100.

2\. Event withid = 2 and amount=200 arrived.
  o/p of sum(amount) triggered and gives 300.

3\. **Remove** Event with id=1 arrived.
o/p of sum(amount) triggered and gives 200.

4\. Event with id = 3 and amount=500 arrived
o/p of sum(amount) triggered and gives  700 
```

但有些第三事件无法自动触发派生事件重新计算。
第 4 个事件的到来触发并根据需要提供输出。
有什么标准的做法吗？

**我想计算新事件是进入窗口还是离开窗口的总和。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T11:56:25.563

3\. 事件（删除）确实会通过“插入派生事件”触发新总和的输出，除非没有删除任何内容，因此您的 id 键可能是错误的。如果仍有问题，请向 esper 用户邮件列表发送一个最小的测试用例。或者使用@Audit 查看引擎在内部对每个语句做了什么。

# java - 取消文档/文档标签的最佳方法 JTabbedPane Java

> ID：13595933
> 
> 赞同：0
> 
> 时间：2012-11-28T00:47:45.950
> 
> 标签：java, swing, jtabbedpane

正如标题所暗示的那样，从 JTabbedPane 中记录/撤消选项卡的最佳方法是什么？类似于您如何在 Chrome 中拖动选项卡并打开一个新窗口，然后将其拖回将其重新放回原处？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:54:08.457

这不是一个简单的问题。

首先，您需要一个触发器，您可以确定该选项卡将被取消停靠。请记住，选项卡可以重新排序，因此仅监视拖动事件是不够的

其次，如果窗口关闭（或者即使您想要），您需要通过某种方式确定如何“重新停靠”选项卡。

之后，它变得像从标签中移除组件并将反之亦然放置到框架上一样简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-26T22:18:39.453

我使用MouseMotionListener 和MouseListener 做到了这一点。当您将选项卡标题拖动很长一段距离时，这只会取消停靠，并在您关闭取消停靠的框架时重新停靠它。

```
 import java.awt.BorderLayout;
import java.awt.Component;
import java.awt.Container;
import java.awt.Image;
import java.awt.Point;
import java.awt.Rectangle;
import java.awt.Window;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.awt.event.MouseMotionListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;

import javax.swing.ImageIcon;
import javax.swing.JFileChooser;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JSlider;
import javax.swing.JSpinner;
import javax.swing.JTabbedPane;
import javax.swing.JTextArea;
import javax.swing.JTree;

public class DockableTabbedPane extends JTabbedPane {

    private DockableTabbedPane  DraggableTabbedPane;
    public DockableTabbedPane() {
        super();
        DraggableTabbedPane = this;
        TabDragListener tabDragger = new TabDragListener();
        this.addMouseListener(tabDragger);
        this.addMouseMotionListener(tabDragger);        
    }

    private class TabDragListener implements MouseListener, MouseMotionListener {

        Point p0,p0screen;

        Component current;
        String title;

        public void mousePressed(MouseEvent e) {
            p0 = e.getPoint();

            for (int i = 0; i < getTabCount(); i++) {
                Rectangle bounds = getBoundsAt(i);
                if (bounds.contains(p0)) {
                    current = DockableTabbedPane.this.getComponentAt(i);   
                    title =DockableTabbedPane.this.getTitleAt(i);
                    p0screen = getLocationOnScreen();
                }
            }
        };

        public void mouseDragged(MouseEvent e) {
            Point p = e.getPoint();
            JFrame frame;

            if (current != null) {
                // check for a significant  drag
                if( p.distance(p0)>20){

                    frame = undock(current,title);
                    current = null; 

                }
            }
        }

        public void mouseMoved(MouseEvent arg0) {}

        public void mouseClicked(MouseEvent arg0) {}

        public void mouseEntered(MouseEvent arg0) {}

        public void mouseExited(MouseEvent arg0) {}

        public void mouseReleased(MouseEvent arg0) {
            current=null;
            title =null;
        }
    }

    private UndockedFrame undock(Component current,String title) {

        Point p = current.getLocationOnScreen();
        remove(current);
        UndockedFrame frame = new UndockedFrame(current,title);

        p.translate(20, 20);
        frame.setLocation(p);
        frame.setVisible(true);
        fireStateChanged();
        return frame;    

    }

    private class UndockedFrame extends JFrame {
        Component current;
        String title;
        public UndockedFrame(Component current,String title) {
            this.current = current;

            this.setTitle(title);

            Container content = this.getContentPane();
            content.setLayout(new BorderLayout());
            content.add(current, BorderLayout.CENTER);
            this.setBounds(current.getBounds());
            this.addWindowListener(new UndockedFrameListener());
        }

        public void redock() {

            this.dispose();
            add(title, current);

        }
    }

    // Redock on close
    private class UndockedFrameListener extends WindowAdapter {
        public void windowClosing(WindowEvent e) {
            Window w = e.getWindow();
            if (w instanceof UndockedFrame) {
                UndockedFrame frame = (UndockedFrame)w;
                frame.redock();
            }
        }
    }
    public static void main(String[] args) {
        JFrame frame = new JFrame();
        DockableTabbedPane pane = new DockableTabbedPane();
        pane.add(new JTree(), "Tree 0");
        pane.add(new JTextArea(" Hello"), "Tree 1");
        pane.add(new JFileChooser(), "Tree 2");
        pane.add(new JSpinner(), "Tree 3");
        pane.add(new JSlider(),"Tree 4");
        frame.getContentPane().add(pane);
        frame.setBounds(100, 100, 400, 400);
        frame.addWindowListener(new WindowAdapter() {
            public void windowClosing(WindowEvent e) {
                System.exit(0);
            }
        });
        frame.setVisible(true);
    }
} 
```

# php - 将时间字符串转换为十进制小时 PHP

> ID：13595935
> 
> 赞同：10
> 
> 时间：2012-11-28T00:47:55.063
> 
> 标签：php, mysql, time, format

我想在 PHP 中以小时为单位将时间字符串（例如 2:12:0）转换为十进制格式（例如 2:12:0 为 2.2 小时）。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-11-28T00:57:41.883

一个相当愚蠢的转换，从我的头顶，使用冒号爆炸：

```
<?php 

$hms = "2:12:0";
$decimalHours = decimalHours($hms);

function decimalHours($time)
{
    $hms = explode(":", $time);
    return ($hms[0] + ($hms[1]/60) + ($hms[2]/3600));
}

echo $decimalHours;

?> 
```

# opengl - GL_TEXTURE_LOD_BIAS_EXT 替换？

> ID：13595936
> 
> 赞同：0
> 
> 时间：2012-11-28T00:48:07.330
> 
> 标签：opengl

我有一个旧的 OGL 代码，我试图在我的 Mac OSX 10.6 上编译，但是当我编译和运行时，它说不支持 GL_TEXTURE_LOD_BIAS_EXT。我可以用什么来替换它以便它运行？我 Mac 上的 OGL 版本是 2.1，从 1.4 左右开始支持这个 EXT，所以我认为它可以正常运行，但显然不是。我可以用什么代替它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:56:38.420

你通过去掉`_EXT`后缀来替换它。这是OpenGL 2.1的*核心功能。*您根本不应该检查扩展名；版本说 2.1，所以`GL_TEXTURE_LOD_BIAS`可用。

# php - 用户在注册/认证前将商品添加到购物车

> ID：13595937
> 
> 赞同：4
> 
> 时间：2012-11-28T00:48:10.803
> 
> 标签：php, e-commerce, shopping-cart

我可以知道我应该如何允许未登录用户添加项目吗？（我们使用定制的解决方案，不使用开源电子商务包）

考虑是：

1.  存储在数据库中：如果未登录用户信息作为访客用户存储在数据库中（为每个用户创建一个 newid 并将该 id 存储在浏览器的会话中），那么我们应该如何知道何时删除它们？

2.  Store at client：如果所有信息都保存在cookie中，那么就需要单独写一组代码，比较麻烦。

有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T01:35:46.343

你可以做任何一个 - 这两种技术都是有效的，**但**在许多情况下，如果用户尚未通过登录或注册进行身份验证，电子商务网站会使用 cookie 来存储临时购物车的内容。

*注意：即使您使用数据库来存储临时购物车，您仍然需要设置一个 cookie 以初步识别它们：*

```
 // Temp user id
  $cart_id = "108376"; // Pulled from DB

  // Two week cookie (86,400 secs per day for 14 days)
  setcookie('abc_cart_id', '$cart_id', time() + 86400 * 14); 
```

**- 或者 -**

使用 cookie，一旦他们登录或注册，您可以将 cookie 的内容（和购物车内容）写入您的数据库。这样，您就不会将不必要的条目添加到孤立的或需要在以后丢弃的数据库中（以及管理它的过程）。

在我见过的许多商业解决方案中（使用 PHP，有时包含数百个项目），cookie 通常采用[序列化数组](http://php.net/manual/en/function.serialize.php)的形式或使用[JSON](http://en.wikipedia.org/wiki/JSON)：

```
 // Serialise array
  $cart = serialize($cart_contents);

  // Two week cookie (86,400 secs per day for 14 days)
  setcookie('abc_cart', '$cart', time() + 86400 * 14); 
```

然后在新用户返回时使用它重新填充他们的购物车：

```
 if (isset($_COOKIE['abc_cart']))
  {
     $cart = unserialize($_COOKIE['abc_cart'];
     // Take action ~ populate cart/DB etc...
  } 
```

它在 CRM 术语中也很有用，您可以根据他们尚未注册/还不是客户的事实更改 UX/为他们提供优惠或激励措施〜*您的第一个订单可享受 20% 的折扣......*

在 Cookie 和 DB 方法中，您需要考虑 cookie 集的生命周期，因为相关用户可能在共享计算机上，并根据您认为合适的方式进行设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T01:01:01.443

设置一个唯一的 cookie，将其存储在您的数据库中，包括添加的项目。因此，将购物篮和独特的访客连接在一起。这样，当您的潜在买家回来时，您仍然知道他的购物篮/兴趣 不要担心删除，除非您的数据库中有数十亿条记录。但是，存放几周就足够了:)

# html - 使用 WebRTC 时，点对点架构对于构建像 Skype 这样的视频聊天服务是多余的吗？

> ID：13595939
> 
> 赞同：0
> 
> 时间：2012-11-28T00:48:17.440
> 
> 标签：html, webkit, skype, webrtc

我们正在使用 WebRTC 并试图了解它的好处。

Skype 能够为数亿人提供服务的原因之一是其分散的点对点架构，可以降低服务器成本。

WebRTC 是否允许人们构建类似于 Skype 的视频聊天应用程序，因为架构可以是分散的（即，视频流不是从广播公司通过中央服务器路由到听众，而是直接从广播公司路由到听众）？

或者，换一种说法，WebRTC 是否允许人们从本质上复制类似于 Skype 的 P2P 架构的好处？

或者你还需要类似于 Skype 的 P2P 架构的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T00:58:46.160

是的，这基本上就是 WebRTC 所做的。使用 getPeerConnection() API 的调用不会通过中央服务器发送语音/视频数据，而是使用 ICE、STUN 和 TURN 等防火墙穿越协议来实现直接的点对点连接。但是，初始调用设置仍然需要一个服务器（很可能是运行 WebSocket 实现的东西，但它可以是任何你可以弄清楚如何让 JavaScript 与之交谈的东西），以便两个客户端可以弄清楚它们是都在线，发出他们想要连接的信号，然后弄清楚怎么做（这就是 ICE/STUN/TURN 位的来源）。

然而，Skype 的 P2P 架构不仅仅是来回传递语音/视频数据。Skype 的大部分 IP 不在编解码器或协议中（其中大部分是从 Global IP Solutions 获得许可的，Google 两年前购买了该解决方案，然后将其开源，并且构成了 Chrome 的 WebRTC 实施的基础）。Skype 的真实 IP 都在 WebRTC 中，它仍然依赖于服务器：确定哪些人在线，他们在哪里，以及如何控制他们，并以大规模去中心化的方式进行*。*（有关一些粗略的详细信息，请参见[此处](http://www.slideshare.net/Sandra4211/voip-skype-architecture)。）我认为您可能可以使用[DataStream](http://www.w3.org/2011/04/webrtc/wiki/images/e/e0/WebRTCDataStreamsIETF82.5.pdf)getPeerConnection() API 的一部分来做那种事情，如果你真的非常聪明的话——但这会很复杂，而且很可能会践踏一些 Skype 专利。除非您想变得非常非常庞大，否则您可能只想运行自己的集中式存在和位置服务器，并通过标准 WebSockets 处理所有这些东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T05:08:09.427

我应该注意到 Skype 的网络架构自创建以来已经发生了变化。它不再（据我所知）使用随机用户作为超级节点将数据从客户端 1 中继到客户端 2；它不能很好地扩展并导致结果的剧烈变化（并且惹恼了没有防火墙连接和带宽的人）。

您绝对可以使用 WebRTC 构建类似 SKype 的东西——甚至更多。:-)

# symfony - MAMP / Symfony：MAMP 覆盖 php.ini 中的 date.timezone 设置，Symfony 失败

> ID：13595942
> 
> 赞同：5
> 
> 时间：2012-11-28T00:48:43.273
> 
> 标签：symfony, mamp, php

我正在尝试在 MAMP 中配置 Symfony2 框架。

但是，在`php.ini`I have correct set`date.timezone`中，MAMP 似乎以某种方式覆盖了设置并改为使用系统时间。

因此，Symphony 的`config.php`页面会发送以下警告：

> 警告：date_default_timezone_get() [function.date-default-timezone-get]：依赖系统的时区设置是不安全的。您*需要*使用 date.timezone 设置或 date_default_timezone_set() 函数。如果您使用了这些方法中的任何一种，但仍然收到此警告，您很可能拼错了时区标识符。我们在第 434 行的 /Applications/MAMP/htdocs/Symfony/app/SymfonyRequirements.php 中为“EST/-5.0/no DST”选择了“America/New_York”

Symfony 在解决此问题之前无法显示起始页。解决方案是什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T03:07:38.910

检查您的系统中是否有两个`php.ini`文件。您可能会`date.timezone`在其中一个中添加该行，但 MAMP 正在使用另一个。

如果这对您不起作用，请尝试在`web/app.php`和`web/app_dev.php`文件的开头添加以下行（如错误消息所示）：

```
date_default_timezone_get('Europe/London'); 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-10T21:32:53.500

我仍在努力找出 MAMP 覆盖 php.ini date.timezone 设置的原因和方式，但是，我在 Symfony php 文件中找到了快速修复解决方案，它至少现在解决了这个问题。

我添加了以下代码：

```
date_default_timezone_set ('America/New_York'); 
```

-- 在 Symfony 的 config.php 和 app_dev.php 文件的顶部，紧跟在开始的 php 标签之后，在脚本的最顶部。这消除了警告信息，并使 Symfony 能够在 MAMP 上工作。

我预见到必须在 Symfony 中的其他一些 php 文件中添加相同的代码，因为我一直在修改它，这应该不是问题。或者我可能会弄清楚如何覆盖 MAMP 的覆盖。

不过，这是一个可行的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-04T23:07:22.837

*   复制

`cp /etc/php.ini.default /etc/php.ini`

*   更改权限

`chmod -R 775 /etc/php.ini`

*   编辑

`sudo vi /etc/php.ini`

*   搜索`date.timezone`并将其更改为（示例）：

`date.timezone = "Europe/London"`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-25T18:14:13.333

你在命令行吗？因为命令行可能会得到与 MAMP 不同的 php.ini。

要从命令行查看哪个是您的 php.ini，您可以执行以下操作：

```
$ php -i | grep 'Configuration File' 
```

（参考：[如何找到命令行使用的php.ini文件？](https://stackoverflow.com/questions/2750580/how-to-find-the-php-ini-file-used-by-the-command-line)）

尝试在“/etc/php.ini”中设置“date.timezone”，或者它所说的任何地方都是您的 php.ini 文件。

您还可以更改 php.ini 文件：

```
$ php -help | grep "php.ini"
  -c <path>|<file> Look for php.ini file in this directory 
```

像...

```
$ php -c /Applications/MAMP/conf/php5.5.14/php.ini ... 
```

例如：

```
$ php -c /Applications/MAMP/conf/php5.5.14/php.ini -i | grep 'Configuration File' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-26T16:36:32.880

如果您的问题是如何在 MAMP PRO 上更改 php.ini 文件，请尝试编辑模板。

文件 -> 编辑模板

您可以在 MAMP 手册[第 24 页中看到](http://www.mamp.info/en/documentation/MAMP-PRO-3-User-Guide.pdf)

更多信息在[这里](http://www.crained.com/488/mamp-how-to-edit-the-php-ini-file/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-10-15T11:47:38.780

在 MAMP 3.0.1 中，您正在使用的相应 php 文件夹版本中的 php.ini 文件的值 date.timezone 在分号后声明，这会将其转换为注释而不是命令。在 C:\MAMP\conf\php5.5.12（或您的 php 版本）中的 php.ini 中，删除第 703 行中的分号并根据指南[http://php.net/manual/en/timezones 定义您的本地时间。 .php](http://php.net/manual/en/timezones.php) _

希望这对你有用:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-12-25T17:13:44.277

就像 Pedro Luz 提到的，你必须在你的 mac 的 php.ini 而不是 MAMP 中设置时区。

不要忘记重新启动你的 mac 的 apache：

```
sudo /usr/sbin/apachectl restart 
```

这个解决方案对我有用：

```
[OK]                                          
 Your system is ready to run Symfony2 projects 
```

# python - python genfromtxt 问题

> ID：13595945
> 
> 赞同：2
> 
> 时间：2012-11-28T00:48:54.860
> 
> 标签：python, numpy, genfromtxt

我是 Python 新手……这是我的问题。对于我在 Python 中测试的优化子例程，我需要解析一个带有数字的 csv 文件。

因此 csv 文件的格式为：

```
Support load summary for anchor at node 5,

Load combination,FX (N),FY (N),FZ (N),MX (Nm),MY (Nm),MZ (Nm),,

Sustained,-3,-2679,120,2012,164,69,,
Operating1,1472,2710,-672,-4520,8743,-2047,,
Maximum,1472,2710,120,2012,8743,69,,
Minimum,-3,-2679,-672,-4520,164,-2047,,

Support load summary for anchor at node 40,

Load combination,FX (N),FY (N),FZ (N),MX (Nm),MY (Nm),MZ (Nm),,

Sustained,9,-3872,-196,-91,854,-3914,,
Operating1,-2027,-8027,3834,-7573,-9102,-6323,,
Maximum,9,-3872,3834,-91,854,-3914,,
Minimum,-2027,-8027,-196,-7573,-9102,-6323,,

Support load summary for anchor at node 125,

Load combination,FX (N),FY (N),FZ (N),MX (Nm),MY (Nm),MZ (Nm),,

Sustained,-7,-2448,76,264,83,1320,,
Operating1,556,-3771,-3162,-6948,-1367,1272,,
Maximum,556,-2448,76,264,83,1320,,
Minimum,-7,-3771,-3162,-6948,-1367,1272,,

Support load summary for Hanger at node 10,

Load combination,Load (N),,

Sustained,-3668,,
Operating1,-13876,,
Maximum,-3668,,
Minimum,-13876,,

Support load summary for Hanger at node 20B,

Load combination,Load (N),,

Sustained,-14305,,
Operating1,-13359,,
Maximum,-13359,,
Minimum,-14305,,

Support load summary for restraint at node 115B,

Load combination,FX (N),FY (N),FZ (N),,

Sustained,,-5655,,,
Operating1,3696,,
Maximum,,3696,,,
Minimum,,-5655,,, 
```

我的代码主要在以开头的行上工作

```
Operating1,
Maximum, 
Minimum, 
```

工作（成本函数）是对这些关键字之一之后的所有数字进行总计（代数）。有时您可以在上面的数据文件中看到，第二列或第三列中只有一个数字。（见数据文件的结尾），有时，像下面的文件片段一样根本没有数字（见下面的 Operating1 行）。

```
Support load summary for Hanger at node 115B,

Load combination,Load (N),,

Sustained,-5188,,
Operating1,,,
Maximum,,,
Minimum,-5188,, 
```

我正在使用 np.genfromtxt()。效果很好，除非我遇到列中值少于 4 个或有时根本没有值的行。

我在 genfromtxt() 上使用 sum() - 请参阅代码。当只有一个值时，我使用了 float()。当没有时，我试图识别并分配零给总数。我可以为每种情况进行自定义，但我想知道是否有一种通用的、更抽象的方法来读取和汇总不可预测的情况下的数字。

另外，我尝试了“missing_values”和“filling_values”，但它们似乎不起作用。如何计算文件中非零列的数量？

到目前为止，这是部分代码：

```
def optimize(fn, optflag):

    modeltotals = []
    i=0
    csv1 = []
    j = 1 # line # count

    for line in csv.reader(filelist) :
    temp = repr(line)  

    if "Support load summary" in temp :
       csv1.append(line) # just making another list of actionable lines for future use
       if (d): print "\n", line
       continue
    if (optflag == "ope") : # optimize on Operating loads
       if "Operating1" in temp:
          csv1.append(line)
          if (len(line) > 4):
              modeltotals.append(sum(np.genfromtxt(line[1:], delimiter=",")))
              if (d): print "Sum of OPE Loads:", modeltotals[i], "\n"
          elif (len(line) > 0 and len(line) <= 4):
              if (d): print "line=", line, "length", len(line)
              line1 = np.genfromtxt(line[1:], delimiter=",")
              if not line1: # meaning if array is empty
                  modeltotals.append(0)
              else:
                  modeltotals.append(np.genfromtxt(line[1:], delimiter=",", missing_values=[0,0,0,0]))
              if (d): print "OPE Max:", modeltotals[i],"\n"

          i +=1
    elif (optflag == "minmax") : #optimize on all loads, min and max.
       #print  "i=", i
       if "Maximum" in temp:
          csv1.append(line)
          if (len(line) > 4):
              modeltotals.append(sum(np.genfromtxt(line[1:], delimiter=",")))
              if (d): print "Sum of Maxs:", modeltotals[i]
          elif (len(line) <= 4):
              #line1 = np.genfromtxt(line[1:], delimiter=",", filling_values = 0)
              #modeltotals.append(sum(line1))

              if (d): print "line=", line, "length", len(line)
              line1 = np.genfromtxt(line[1:], delimiter=",")
              print "line1 =", line1
              if not line1: # meaning if array is empty
                  modeltotals.append(0) 
              else:
                  modeltotals.append(np.genfromtxt(line[1:], delimiter=",", filling_values = 0))
              if (d): print "Max:", modeltotals[i]

          i+=1
       elif "Minimum" in temp:
          csv1.append(line)
          if (len(line) > 4):
              #print "#", j, "line", line
              modeltotals.append(sum(np.genfromtxt(line[1:], delimiter=",")))
              if (d): print "Sum of Mins:", modeltotals[i]

          elif (len(line) > 0 and len(line) <= 4):
              if (d): print "line=", line, "length", len(line)
              line1 = np.genfromtxt(line[1:], delimiter=",")
              if not line1: # meaning if array is empty
                  modeltotals.append(0)
              else:
                  modeltotals.append(np.genfromtxt(line[1:], delimiter=","))
              if (d): print "Min:", modeltotals[i]

          i +=1
    j+=1
 if len(modeltotals) > 0:
     print modeltotals
     average = float(sum(modeltotals))/len(modeltotals)  #sometimes error here
 else:
     return "000"  # error, seems like no file was analyzed
 if (d):
     print "Current model mean =", average

 del csv1[:]
 return abs(average) 
```

我在不同文件中遇到的几个错误是相似的：

```
['Support load summary for restraint at node 20B', '']
Traceback (most recent call last):
File "sor4.py", line 190, in <module>
modelmean[filename] = optimize(filename, args.optimizeon)
  File "sor4.py", line 107, in optimize
   modeltotals.append(sum(np.genfromtxt(line[1:], delimiter=",")))
TypeError: iteration over a 0-d array 
```

另一个错误是“无法转换为标量”。

我了解这些错误，但对如何巧妙处理它们的 Python 知之甚少。对不起，很长的帖子；我会更好地更简洁地介绍信息。正如这里的另一位海报所说，我将不胜感激地接受您的回答。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T08:31:14.790

我将您的问题简化为以下代码。它检查 nans 和空输入字符串。

```
from StringIO import StringIO
import numpy as np

def getnumbers(s):
    try:
        res = np.genfromtxt(s, delimiter=",")
        return res[np.where(np.isnan(res), False, True)]
    except IOError as ioe:
        return np.array(0.)

print(sum(getnumbers(StringIO('1., 2., , '))))
print(sum(getnumbers(StringIO('')))) 
```

它给出了结果

```
3.0
0.0 
```

# svn - svn import 是否服从 svn propedit svn:ignore

> ID：13595952
> 
> 赞同：0
> 
> 时间：2012-11-28T00:49:33.287
> 
> 标签：svn, version-control, import, repository

我有一个空的回购，我正在做

```
 svn import /var/www/source_proj/ svn:///ipaddress//var/www/proj/ -m "First Import" 
```

但它似乎是“添加”我告诉它不要的所有文件。它实际上是在添加文件吗？我不能等到添加过程完成，因为它在一个目录中有千兆字节的不需要的小文件。

我做了一个 svn propedit svn:ignore 。为了

```
proj/sites/default/files
proj/sites/all/all-files 
```

但我仍然看到类似的东西

```
Adding         source_proj/sites/all/all-files/2011-06-13/list_a85705_2011-06-13.csv
Adding         source_proj/sites/all/all-files/2011-06-13/list_a97207_2011-06-13.csv
Adding         source_proj/sites/all/all-files/2011-06-13/list_a24983_2011-06-13.csv 
```

或者，如果我知道将现有目录转换为一个很好的存储库，使用以前的空白存储库，然后提交所有新的、未忽略的文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T01:01:21.887

因为 `svn import [PATH] URL`PATH 应该是普通的、未版本化的树。没有等待和处理任何 SVN 功能。

如果您想将工作副本提交到新的、不同的 repo，您​​可以（可以）使用 relocate-commit（如果 UUID-problem 没有阻止它）

# c++ - Visual Studio 2012 C++ OpenGL GLFW 链接器错误

> ID：13595956
> 
> 赞同：2
> 
> 时间：2012-11-28T00:50:03.157
> 
> 标签：c++, visual-c++, opengl, glfw

我正在使用 Visual Studio 2010 Express 上的 OpenGL 在 C++ 中制作 2d 横向滚动条。我正在尝试编译我的代码，并且它可以正确构建，但是我在 main() 函数中初始化的 GLFW 函数出现链接器错误。这是我的代码：

```
#include <iostream>
#include <ctime>

#include <GL\glfw.h>

#include "Player.h"

void render();
void update();

Player Player1;
 //Cross platform sleep implementation
void _sleep(double ms)
{
    double st = clock();
    if(ms <= 0)
            ms = 10;
    while(clock() < (ms + st));
}

int main(int argc, char** argv)
{
    std::cout <<"Loading Prized Fighter"<< std::endl;
    glfwInit(); //Initialize GLFW

    //Create GLFW window
    if(glfwOpenWindow(800, 600, 5, 6, 5, 0, 8, 0, GLFW_WINDOW) != GL_TRUE)
        std::cout << "Error creating window!" << std::endl;

    //Set window title
    glfwSetWindowTitle("Prized Fighter");

    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();

    //Start main game loop
    //This calls the functions which update objects and render them to the screen
    while(true)
    {
        update();
        render();

        glfwSwapBuffers(); //Switch buffers (double rendering)
        _sleep(10.0); //Let a bit of CPU time for other processes
    }

    return 0;
}

/*
     - Render function -
      Used to draw objects to the screen
*/
void render()
{
     glClearColor(0.0f, 0.0f, 0.0f, 0.0f); //Color to clear the screen
     glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

     //TODO: Draw stuff here
     Player1.draw();
}

/*
     - Update function -
     Updates objects; states, locations, etc
*/
void update()
{
     //TODO: Update objects here
     Player1.update();
} 
```

当我编译时，我收到以下错误：

> 1>----- 构建开始：项目：Priced Fighter，配置：调试 Win32 ------ 1>main.obj：错误 LNK2019：未解析的外部符号 _glfwSwapBuffers 在 >function _WinMain@8 中引用
> 
> 1>main.obj : 错误 LNK2019: >function _WinMain@8 中引用的未解析外部符号 _glfwSetWindowTitle
> 
> 1>main.obj : 错误 LNK2019: >function _WinMain@8 中引用的无法解析的外部符号 _glfwOpenWindow
> 
> 1>main.obj : 错误 LNK2019: 函数 >_WinMain@8 中引用的未解析外部符号 _glfwInit
> 
> 1>MSVCRTD.lib(crtexew.obj) : error LNK2019: unresolved external symbol *WinMain@16 >referenced in function _* _tmainCRTStartup
> 
> 1>c:\users\brennan\documents\visual studio 2010\Projects\Prized Fighter\Debug\Prized >Fighter.exe：致命错误 LNK1120：5 个未解决的外部文件 ========== 构建：0 成功， 1 失败，0 最新，0 跳过 ==========

链接过程中出了什么问题 - 代码中是否有错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:57:54.033

看起来您需要链接：

```
glfw.lib 
opengl32.lib 
```

值得阅读发行说明：[这里](http://www.glfw.org/release-2.7.7.html#compiling)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T01:00:47.600

您收到这些错误是因为您没有链接到 GFWL 库，或者没有正确链接到它。该库包含您尝试调用的函数的定义。

GFWL 自述文件的第 4.2 节解释了链接时要使用哪些库；如果您是静态链接（看起来像）或使用 DLL，您需要的步骤会有所不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-18T11:47:24.410

对于已经链接到正确库并且可能对 C++ 项目的 GLAD 文件有类似问题的未来读者：

我只需要通过“属性”选项卡将glad.c 文件包含在项目中（每当您单击文件时都会弹出该文件，您可以通过“视图”>“属性窗口”启用属性选项卡）。

确保“包含在项目中”设置为 True：![](../Images/e7f845337f41ad8557d1aa8fa0918b46.png)

这就是为什么我有未解析的glad.c 外部符号的原因，这里的任何人都可能会发现它有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-12-06T20:05:34.507

据我所知，我在设置中正确链接了所有内容，但由于某种原因，Visual Studio 2017 仍然没有在我的解决方案中包含glad.c。即使它被放入文件夹中，它也只会在我选择文件夹视图而不是解决方案视图时出现。

最终，我只是在我的预处理器语句之后输入了#include“glad.c”，它对我有用。

# java - 为什么 -Xss 不增加创建的线程数？

> ID：13595967
> 
> 赞同：2
> 
> 时间：2012-11-28T00:51:20.797
> 
> 标签：java, multithreading, memory, jvm

我需要一些关于如何最好地调整我的内存设置以允许更多线程的输入。

我阅读了关于[Java VM 可以支持多少线程？](https://stackoverflow.com/questions/763579/how-many-threads-can-a-java-vm-support)并遵循那里的java示例（dieLikeaDog），它确实有效，在死前产生了不到800个线程。

如上面的（dieLikeaDog 示例）链接中，代码使所有可以使用的线程，直到出现以下错误结果：java.lang.OutOfMemoryError：无法创建新的本机线程

在命令行上指定 Xss（例如 java -Xss104k dieLikeADog）不会改变创建的线程数。

我还尝试更改 -Xms 和 -Xmx 并没有更改它可以产生的线程数。

改变线程数的一件事是 my -u ulimit （用于最大用户进程）。使这个更大确实增加了线程的数量。

我的ulimit如下：

```
$ ulimit -a
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 46588
max locked memory       (kbytes, -l) 64
max memory size         (kbytes, -m) unlimited
open files                      (-n) 1024
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) 8192
cpu time               (seconds, -t) unlimited
max user processes              (-u) 1024
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited 
```

我有点困惑，因为我从阅读其他示例中认为指定较小的 -Xss 应该会增加线程数。

是否还有其他事情阻止 Xss 工作？

万一这很重要，我在 64 位 fedora 15 系统上运行（带有 6 gigs 的 ram）：

```
 OS:
    Linux
    2.6.42.12-1.fc15.x86_64
    amd64

  JVM:
    Sun Microsystems Inc.
    Java(TM) SE Runtime Environment
    Java HotSpot(TM) 64-Bit Server VM
    1.6.0_27 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T05:34:03.220

该`-Xss`参数控制如何为每个线程的堆栈分配 mush 内存。选择一个值是平衡堆栈深度与可用内存的情况。设置值`-Xss104k`意味着 104KB 的可用内存~~（用 设置`-Xmx`）~~将为每个启动的线程的堆栈消耗。~~如果您从头开始，`-Xmx1024k`那么内存将在您达到 10 个线程之前耗尽，因为 1M 的内存包括堆和类（permgen）以及线程堆栈。~~

我的方法是首先检查要在线程中运行的代码。递归繁重的代码需要更多的堆栈。只迭代大量数据的代码可能需要很少的堆栈。

平衡所涉及的力的一种经验方法是减少，`-Xss`直到你得到一个`StackOverflowError`. 这意味着您的线程即将耗尽堆栈。为最后一个有效的值添加一些填充。如果最后一个没有导致 a 的值`StackOverflowError`是“-Xss1k `, the try`-Xss2k `or`-Xss3k `. If the stack is wiping out at something like`10k 15k” `I'd try just bumping to`。

~~现在您有了线程堆栈的大小。你的总内存 ( `-Xmx`) 减去 permgen，减去所需的堆数量，就可以得到线程剩余的空间。如果您需要 1000K 的堆和 50K 的 permgen，并且您计算出 2K 的堆栈大小，那么运行十个线程，您正在查看`-Xmx1070K`您的最小内存。~~

也就是说，看看你想要完成什么。为什么需要更多线程？也许答案不是更多的线程，而是一种不同的算法，可以在使用更少线程的同时更快地处理数据。

**更新**

我已经删除了我发现不正确的部分原始答案。

栈空间不是取自堆空间，它们是分开分配的。线程堆栈和堆都计入进程的虚拟内存。减少堆允许更多线程，增加它允许更少。

在 32 位 JVM 上，我能够将堆栈大小减少到 1K。在 64 位 JVM 上，104K 是最小值。

我在具有 4G 内存和 2 个内核的 64 位 Windows 7 机器上进行了一些测试。

使用 32 位 JVM，`-Xss8k`该`-Xmx128m`程序为我提供了大约 5000 个线程。这似乎是最好的情况。我没有找到可以增加线程数量超过该点的选项组合。如果我增加堆大小，最大线程数就会下降。线程堆栈大小似乎与系统页面大小有关，因为如果我选择少于 8k 的堆栈，最大线程实际上会变得更糟。

~~Ubuntu Quantal 上的 32 位 JVM 似乎也存在约 5000 个线程限制。~~

使用 64 位 JVM，情况就完全不同了。和程序超过 50000 个线程`-Xss104k`。`-Xmx128m`那时，Windows*真的很*不高兴。它停止响应几分钟，然后开始杀死其他进程。我猜是为了释放更多内存。

**更新：**

在 Ubuntu 上进行更多测试：我发现我为虚拟内存设置了 ulimit。在`ulimit -v unlimited`程序结束〜36000个线程之后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-02T08:04:31.893

原因可能在于您提供的 ulimits：

```
max user processes              (-u) 1024 
```

每个线程都将计入该值。由于您不仅在运行 JVM，因此已经从该值中扣除了相当多的线程。

尝试执行

```
ulimit -u 4000 
```

并重新运行测试（在您执行命令的 shell 中！），您可以创建的线程数不应该增加。

# facebook-graph-api - 有没有办法在 Ads API 中检索所有可定位的城市？

> ID：13595969
> 
> 赞同：9
> 
> 时间：2012-11-28T00:51:35.297
> 
> 标签：facebook-graph-api, ads, facebook-ads-api

自动完成 API 允许我们通过省略查询字符串并将结果限制设置为较大的数字来检索所有国家、地区和语言环境的列表，但此功能在城市级别不可用。

有没有一种方法可以检索所有可定位城市及其 ID 的完整列表？如果没有，我们可以缓存城市的自动完成数据来建立这样一个列表吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-04T07:44:49.147

可能不支持该功能，因为大量返回数据会导致获取世界上所有城市，即使是分页也是如此。虽然按国家（通过使用`country_list=["ca"]`）限制响应数据然后获取所有城市听起来并不太牵强，但是，它也没有实现。

对我来说，听起来你有两个选择。

1.  [使用我们的错误工具](http://developers.facebook.com/bugs/create)创建错误报告以请求愿望清单功能（不保证任何事情，但如果我们选择实施它，至少我们可以跟踪它，并且可以作为衡量对该功能的兴趣的一种方式）
2.  IANAL，但根据[FB 平台政策](https://developers.facebook.com/policy/)第 2 节第 2 部分的规定

> 您可以缓存通过使用 Facebook API 接收到的数据，以改善您的应用程序的用户体验，但您应该尽量使数据保持最新。此许可不授予您对此类数据的任何权利。

听起来您*可以*缓存自动完成数据，因为它会更好地改善您的应用程序的用户体验，但是，请记住您没有数据的权限。我会对此持谨慎态度，因为如果您非常努力地获得所有内置的缓存功能只是让 FB 说它是不允许的，那真的很糟糕。在走这条路之前，我会向一些专家提供更多建议。

# java - 部署图标

> ID：13595973
> 
> 赞同：3
> 
> 时间：2012-11-28T00:52:09.470
> 
> 标签：java, netbeans, icons

当我安装“干净并构建”结果时，如何让我的图标出现？

我的 Netbeans 7 平台应用程序运行正常，但有一个图标的 Netbeans 框。我已经定义了“品牌文献”中指定的所有图标，但没有一个用于“可点击的 exe”。它们确实显示在顶部组件窗口中。

# java - 未使用 Maven -DlocalRepositoryPath，而是使用默认的本地存储库位置

> ID：13595979
> 
> 赞同：3
> 
> 时间：2012-11-28T00:53:06.023
> 
> 标签：java, maven-2, repository, dependency-management

我正在使用以下命令在我的项目中创建一个本地存储库（在许多系统上使用，所以我尝试在我的项目文件夹中使用本地 maven 存储库来存储在任何在线存储库中都找不到的外部 jars ):

```
C:\Users\someone\workspace\someProject>mvn install:install-file
    -Dfile=somePackage-1.0.0.jar
    -DgroupId=foo.bar
    -DartifactId=somePackage
    -Dversion=1.0.0
    -Dpackaging=jar
    -DlocalRepositoryPath=libs
    -DcreateChecksum=true 
```

这是从 Windows 命令行运行的。不知何故，即使使用 -DlocalRepositoryPath，它仍在将 jar 安装到默认的本地存储库（C:\Users\someone\.m2\ 等）。我在这里做错了什么？我尝试了 libs 路径的不同变体，例如 /libs、/libs/、完整路径，使用“”，但没有任何效果。为什么 -DlocalRepositoryPath 参数在这里不起作用？我正在使用 Maven 2.2.1。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T01:52:16.320

install:install-file 选项在使用插件版本 2.2 时会忽略 localRepositoryPath。但是，它适用于 2.3 及更高版本。

另外，尝试使用插件的完全限定名称来指定版本：

```
mvn org.apache.maven.plugins:maven-install-plugin:2.3.1:install-file \
                         -Dfile=<path-to-your-file> -DgroupId=<myGroup> \ 
                         -DartifactId=<myArtifactId> -Dversion=<myVersion> \
                         -Dpackaging=<myPackaging> -DlocalRepositoryPath=<path> 
```

# android - 锁屏小部件太小

> ID：13595990
> 
> 赞同：3
> 
> 时间：2012-11-28T00:54:11.130
> 
> 标签：android, android-widget

我在查找 Android 4.2 中引入的锁屏小部件的参考资料时遇到了很多麻烦。

我创建了一个在启动器上运行良好的小部件，它的大小符合我的预期。但是，我已启用此小部件以显示在锁屏上，但垂直尺寸不正确。

根据[http://developer.android.com/guide/topics/appwidgets/index.html#lockscreen](http://developer.android.com/guide/topics/appwidgets/index.html#lockscreen)如果您设置它将占用垂直可用的大小`android:resizeMode="vertical"`

> 如果小部件将自身标记为可垂直调整大小，则小部件高度在显示解锁 UI 的竖屏手机上显示为“小”。在所有其他情况下，小部件的大小以填充可用高度。

我还使用了[http://developer.android.com/guide/practices/ui_guidelines/widget_design.html中描述的大小](http://developer.android.com/guide/practices/ui_guidelines/widget_design.html)

**瓷砖 > 尺寸**

*   1 > 40dp
*   2 > 110dp
*   3 > 180dp
*   4 > 250dp
*   … > …</li>
*   n > 70 × n - 30

我已经设置了这个，并且似乎比“小”小部件还要小。基本上，有谁知道*图像 1*中的小部件有什么问题，它不会扩展？我的代码如下。

1）它在默认状态下的样子。

![在此处输入图像描述](../Images/34c3b03121562c70ae1d5f4b82fa1593.png)

2) 在另一个屏幕上展开时的样子。

![在此处输入图像描述](../Images/1363a16c8f63a2a3109cf2244313f71c.png)

**xml/clock_widget.xml**

```
<appwidget-provider xmlns:android="http://schemas.android.com/apk/res/android"
    android:initialKeyguardLayout="@layout/clock_widget"
    android:initialLayout="@layout/clock_widget"
    android:minHeight="110dp"
    android:minWidth="180dp"
    android:resizeMode="vertical"
    android:updatePeriodMillis="1000"
    android:widgetCategory="keyguard|home_screen" >

</appwidget-provider> 
```

**布局/clock_widget.xml**

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/clock_widget"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical">

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal">

        <TextView
            android:id="@+id/widget_hour"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text=""
            android:textAppearance="?android:attr/textAppearanceLarge"
            android:textSize="36sp" />

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text=":"
            android:textAppearance="?android:attr/textAppearanceLarge"
            android:textSize="36sp" />

        <TextView
            android:id="@+id/widget_minute"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text=""
            android:textAppearance="?android:attr/textAppearanceLarge"
            android:textSize="36sp" />

    </LinearLayout>

    <TextView
        android:id="@+id/widget_date"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:text=""
        android:textAppearance="?android:attr/textAppearanceMedium" />
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T15:18:39.663

看起来这只发生在模拟器中。在真实硬件上进行测试工作正常。

# django - contenttypes.contenttype 在此迁移中不可用

> ID：13595991
> 
> 赞同：6
> 
> 时间：2012-11-28T00:54:13.540
> 
> 标签：django, migration, django-south

我正在尝试将一些模型从一个 Django 应用程序迁移到另一个，并基于这个问题[如何将模型从一个 django 应用程序迁移到一个新应用程序？](https://stackoverflow.com/questions/1258130/how-do-i-migrate-a-model-out-of-one-django-app-and-into-a-new-one)我已经完成了很多工作，但是在创建第一个迁移时，我收到了这个错误：

```
"The model 'contenttype' from the app 'contenttypes' is not available in this migration." 
```

谷歌和 SO 似乎没有找到任何发生这种情况的案例，并且上述问题也没有具体说明，除了代码中的注释：

```
if not db.dry_run:
    # For permissions to work properly after migrating
    orm['contenttypes.contenttype'].objects.filter(app_label='common', model='cat').update(app_label='specific') 
```

非常感谢任何洞察我做错了什么。

这是两个迁移文件：

创造：

```
# encoding: utf-8
import datetime
from south.db import db
from south.v2 import SchemaMigration
from django.db import models

class Migration(SchemaMigration):

    def forwards(self, orm):
        db.rename_table('cars_country', 'general_country')
        if not db.dry_run:
            # For permissions to work properly after migrating
            orm['contenttypes.ContentType'].objects.filter(app_label='cars', model='country').update(app_label='general')

    def backwards(self, orm):
        pass 
```

删除：

```
# encoding: utf-8
import datetime
from south.db import db
from south.v2 import SchemaMigration
from django.db import models

class Migration(SchemaMigration):

    depends_on = (
        ('general', '0002_create_country'),
    )

    def forwards(self, orm):

        db.alter_column('cars_club', 'country_id', self.gf('django.db.models.fields.related.ForeignKey')(to=orm['general.Country'], null=True))

    def backwards(self, orm):

        db.rename_table('general_country', 'cars_country')
        db.alter_column('cars_club', 'country_id', self.gf('django.db.models.fields.related.ForeignKey')(to=orm['cars.Country'], null=True)) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T12:21:53.713

好的，找到了解决方案。dgel 的冻结通知让我检查了 South 文档，并且有一个关于 ORM 迁移的通知：*这是通过在每次迁移的底部将模型序列化到一个名为模型的大字典中来完成的。很容易看到；它是底部的一大块密集代码。*

所以基本上我只需要将 orm['contenttypes.contenttype] 移动到第二个迁移文件，因为 contenttype 模型字典已经存在。现在一切似乎都按原样工作了。

# php - 执行查询无结果且无错误

> ID：13595996
> 
> 赞同：2
> 
> 时间：2012-11-28T00:55:04.320
> 
> 标签：php, mysql, database, mysqli

一切都很好。数据库和表的名称，列的名称等。 $username 是好的并且存在于数据库中。然而，在此运行之后，如果我“警告”$dbuid，它会显示为 0，而 $dbusername 显示为空。MySQLi 不会抛出任何错误。（这就是为什么我做了 if(! .. ) echo error;，看看它是否会引发任何错误，但它工作得很好。）我哪里出错了？

```
if(!$msmysqli = new mysqli("localhost","root","","ms")){
   echo $msmysqli->connect_error;
}
if(!$stmt = $msmysqli->prepare("SELECT id,name,password FROM accounts WHERE name=?")){
   echo $msmysqli->error;
}
if(!$stmt->bind_param("s",$username)){
   echo $stmt->error;
}
if(!$stmt->execute()){
   echo $stmt->error;
}
if(!$stmt->bind_result($dbuid,$dbusername,$dbpassword)){
   echo $stmt->error;
}
$stmt->close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:58:15.817

您只需忘记[获取](http://php.net/manual/en/mysqli-stmt.fetch.php)结果即可获得该行...这就是您的代码无法按预期工作的原因！要记住的另一件事是，至少在 php 中，对象在[构造](http://php.net/manual/en/language.oop5.decon.php)时总是返回其实例！语句 $msmysqli = new mysqli(...) 永远不会是假的！这就是为什么你应该检查你的连接，如图所示！

```
$msmysqli = new mysqli("localhost","root","","ms");

if ( $msmysqli->connect_errno ) echo $msmysqli->connect_error;

if( $stmt = $msmysqli->prepare("SELECT id,name,password FROM accounts WHERE name=?") ) {
    $stmt->bind_param("s",$username);
    $stmt->execute();
    $stmt->bind_result($dbuid,$dbusername,$dbpassword);
    $stmt->fetch();
    $stmt->close();
} else {
    echo $msmysqli->error;
}

$msmysqli->close(); 
```

# cucumber - 验证下拉列表中不存在某个值

> ID：13595998
> 
> 赞同：1
> 
> 时间：2012-11-28T00:55:20.560
> 
> 标签：cucumber, watir

我希望验证下拉列表中不存在某个值。

所以html是：

```
<select id="delivery" name="delivery" onchange="this.form.submit();">
  <option  selected="selected" value="Del1">Delivey1</option>
</select> 
```

因此，我希望确保当我的购物篮中有某些物品时，送货选项 2 不存在。

所以我正在尝试的代码：

```
result = @browser.select(:id, "delivery").include? ("Delivery2")
assert result = false 
```

但是，这不起作用。

任何建议或帮助将不胜感激！！

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T02:32:34.327

根据您的代码，我猜这`result`是正确的。看起来问题出在断言上。做断言

```
assert result = false 
```

不是有效的语法（您不能在此处进行分配）。

请尝试以下方法之一：

```
assert( result == false )  #Note that it is == instead of =
assert_equal( true, result ) 
```

# .net - 禁用 Visual Studio devenv 解决方案保存对话框

> ID：13595999
> 
> 赞同：191
> 
> 时间：2012-11-28T00:55:29.630
> 
> 标签：.net, visual-studio, visual-studio-2012

当我在文件管理器中双击解决方案文件打开我的解决方案时，Visual Studio 2012 会询问我是否要保存 devenv.sln： ![在此处输入图像描述](../Images/27e0018027ea84a4fe4dc1d45827a303.png)

我怎样才能避免这种烦人的事情？（除了打开vs first and than solution - 我只想在我的文件管理器中单击一个解决方案文件）。

* * *

## 回答 #1

> 赞同：312
> 
> 时间：2013-01-20T10:08:42.973

[如此处](http://social.msdn.microsoft.com/Forums/en/vssetup/thread/8716b5e9-0565-459e-8970-93db52cab466)所示，您必须配置`"C:\Program Files (x86)\Common Files\microsoft shared\MSEnv\vslauncher.exe"`为以管理员身份运行。

1.  右键点击`C:\Program Files (x86)\Common Files\microsoft shared\MSEnv\VSLauncher.exe`
2.  选择属性
3.  点击兼容性
4.  设置“以管理员身份运行此程序”。

我也为`C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\devenv.exe`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-04-19T21:23:05.977

另一个不太明显的选项是将 devenv.sln 文件保存到该版本的 Visual Studio 的 Visual Studio IDE 文件夹中。这是[上面提到的链接中描述的](https://social.msdn.microsoft.com/Forums/vstudio/en-US/8716b5e9-0565-459e-8970-93db52cab466/save-changes-to-devenvsln?forum=vssetup)一个选项。

可能*不是*最好的选择，但它仍然是一个选择。