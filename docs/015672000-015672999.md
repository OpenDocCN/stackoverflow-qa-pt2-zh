# StackOverflow 问答 15672000-15672999

# asp.net - 如何将消息记录到 Windows Azure 存储？

> ID：15672003
> 
> 赞同：1
> 
> 时间：2013-03-28T00:15:29.807
> 
> 标签：asp.net, .net, azure

我试图完成一个非常简单的任务几个小时而没有成功。**我只想将消息记录到 Windows Azure 存储，以便稍后进行分析**。

我已经尝试过：

我已经启用了这样的诊断：

![在此处输入图像描述](../Images/daa4ac3a6ed38d847307d351931c2149.png)

之后我把这条线放在我的`Application_Start`：

```
Trace.TraceError("My Error"); 
```

我希望它被记录到 Windows Azure 存储中。但事实并非如此。[然后我在这里](http://msdn.microsoft.com/en-us/library/windowsazure/hh508983.aspx)读到我应该先配置`DiagnosticMonitor`类。但我认真地认为这个类已被弃用..因为它在`Microsoft.WindowsAzure.StorageClient`版本 1.7 的程序集中（其他版本是 1.8 或 2.0），当我添加对它的引用时，我的所有`CloudStorageAccount`引用都变得模棱两可，因为这个程序集有我已经拥有的类与其他组件`Microsoft.WindowsAzure.Storage`（较新）。我真的认为我不应该添加对`StorageClient`.

简而言之..我正在阅读很多文件并且无处可去。

你能……告诉我具体做什么吗？我会非常感激。谢谢。

PS：我在 2012 年 10 月将 VS 2012 与 Windows Azure 工具一起使用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T03:02:31.610

您所做的（在您的屏幕截图中）启用了诊断。您需要做的下一件事是在代码中配置诊断。为此，请按照下列步骤操作：

1.  在 web.config 中添加以下代码行：

    ```
     <system.diagnostics>
    <trace>
      <listeners>
        <add type="Microsoft.WindowsAzure.Diagnostics.DiagnosticMonitorTraceListener, Microsoft.WindowsAzure.Diagnostics, Version=1.8.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" name="AzureDiagnostics">
          <filter type=""/>
        </add>
      </listeners>
    </trace></system.diagnostics> 
    ```

2.  在您角色的 OnStart() 方法中配置诊断。该代码仅适用于跟踪日志：

    ```
     DiagnosticMonitorConfiguration config = DiagnosticMonitor.GetDefaultInitialConfiguration();

        // Set an overall quota of 8GB.
        config.OverallQuotaInMB = 4096;
        // Set the sub-quotas and make sure it is less than the OverallQuotaInMB set above
        config.Logs.BufferQuotaInMB = 512;
        TimeSpan myTimeSpan = TimeSpan.FromMinutes(2);
        config.Logs.ScheduledTransferPeriod = myTimeSpan;//Transfer data to storage every 2 minutes

        // Filter what will be sent to persistent storage.
        config.Logs.ScheduledTransferLogLevelFilter = LogLevel.Undefined;//Transfer everything
        // Apply the updated configuration to the diagnostic monitor.
        // The first parameter is for the connection string configuration setting.
        DiagnosticMonitor.Start("Microsoft.WindowsAzure.Plugins.Diagnostics.ConnectionString", config); 
    ```

这应该用于诊断。

关于旧存储客户端库和新存储客户端库的混淆：当前 Windows Azure 诊断模块依赖于旧存储客户端库 ( `Microsoft.WindowsAzure.StorageClient.dll`)。所以你需要确保在你的项目中引用了这个库。`C:\Program Files\Microsoft SDKs\Windows Azure\.NET SDK\2012-10\ref`您可以从文件夹中手动添加参考。如果您同时使用旧的存储客户端库和新的 ( `Microsoft.WindowsAzure.Storage.dll`)，就会出现混乱。因此，您需要确保 CloudStorageAccount 对象的范围正确。

设置完所有内容后，您应该能够看到`WADLogsTable`在您的存储帐户中创建的名称的表以及进入该表的数据。

# iphone - 使用 UIColor 创建颜色

> ID：15672008
> 
> 赞同：-2
> 
> 时间：2013-03-28T00:16:06.597
> 
> 标签：iphone, ios, ios5, uicolor

我正在尝试在 Xcode 中创建以下颜色，但似乎无法使其匹配？

![在此处输入图像描述](../Images/5528456ae5b4cd461b3d96f08be4eb7b.png)

我尝试了以下方法：

```
setBackgroundColor:[[UIColor alloc] initWithRed:0 green:47 blue:135 alpha:1]]; 
```

是不是我做错了什么，或者应该改变颜色不符合我的预期？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T00:19:09.873

试试这个

`setBackgroundColor:[[UIColor alloc] initWithRed:15/255.0f green:47/255.0f blue:135/255.f alpha:1]];`

[UIColor 期望颜色是介于 0 和 1 之间的值](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIColor_Class/Reference/Reference.html)，因此您必须将这些值除以 255。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T01:05:59.580

如果要用作 RGB 值，则可以如下定义：

```
#define RGB(r,g,b) [UIColor colorWithRed:r/255.0 green:g/255.0 blue:b/255.0 alpha:1] 
```

# algorithm - 哲学家晚餐的指挥解决方案

> ID：15672010
> 
> 赞同：2
> 
> 时间：2013-03-28T00:16:16.620
> 
> 标签：algorithm, concurrency, dining-philosopher

所描述的哲学家晚餐问题的指挥解决方案建议使用大小为 4 的信号量，并且所有哲学家都尝试在右叉之前先获得左叉。 [http://en.wikipedia.org/wiki/Dining_philosophers_problem#Conductor_solution](http://en.wikipedia.org/wiki/Dining_philosophers_problem#Conductor_solution)

信号量是否应该用于访问左叉的每个人和访问右叉的每个人？

如果一个哲学家可以在规定的时间内得到左叉但没有得到右叉，他应该怎么做？他们应该把左叉还给吗？

哲学家按什么顺序返回叉子有关系吗？

当然，这种解决方案仍然会导致饥饿。例如，wiki 说 A 和 C 都有两个分叉。这意味着信号量将不再对任何人说分叉并挂在第五个。D 和 E 之间的叉子必须留在桌子上。然后说A返回他的右叉。

现在信号量将回到 3。

D 可以再试一次左叉，然后意识到他不能正确。B只能离开。又没用。

A 可以尝试再次选择右叉，因为他已经有了左叉。这意味着我们绕着圈子转。

我错过了一些东西

帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T00:33:50.367

我相信哲学家总是“同时”返回两个叉子。通过要求哲学家先获得左叉然后获得右叉，这个问题得到了进一步简化。锁获取顺序确实有助于简化死锁问题。遵循导体方案将保证不可能出现死锁。

这里的额外技巧是服务员要求 5 个哲学家中只有 4 个可以同时拿着叉子（所以它更像是一个计数信号量，计数哲学家而不是叉子）。

# java - DocumentBuilder 从绝对路径解析文件

> ID：15672013
> 
> 赞同：0
> 
> 时间：2013-03-28T00:16:29.380
> 
> 标签：java, jfilechooser, absolute-path

我有一个带有 JFileChooser 的基本 Java-UI。

我尝试使用此代码解析所选文件：

```
Document document = builder.parse(getClass().getResourceAsStream(<SELECTED_PATH>)); 
```

可悲的是我得到了这个输出：

```
java.lang.IllegalArgumentException: InputStream cannot be null
at javax.xml.parsers.DocumentBuilder.parse(DocumentBuilder.java:120)
at wordpress2myblog.WordpressBlog.importWP(WordpressBlog.java:59)
at wordpress2myblog.WPImportUI.jButton1MouseClicked(WPImportUI.java:165)
at wordpress2myblog.WPImportUI.access$000(WPImportUI.java:16)
at wordpress2myblog.WPImportUI$1.mouseClicked(WPImportUI.java:51)
at java.awt.AWTEventMulticaster.mouseClicked(AWTEventMulticaster.java:253)
at java.awt.Component.processMouseEvent(Component.java:6385)
at javax.swing.JComponent.processMouseEvent(JComponent.java:3275)
at java.awt.Component.processEvent(Component.java:6147)
at java.awt.Container.processEvent(Container.java:2083)
at java.awt.Component.dispatchEventImpl(Component.java:4744)
at java.awt.Container.dispatchEventImpl(Container.java:2141)
at java.awt.Component.dispatchEvent(Component.java:4572)
at java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:4619)
at java.awt.LightweightDispatcher.processMouseEvent(Container.java:4289)
at java.awt.LightweightDispatcher.dispatchEvent(Container.java:4210)
at java.awt.Container.dispatchEventImpl(Container.java:2127)
at java.awt.Window.dispatchEventImpl(Window.java:2489)
at java.awt.Component.dispatchEvent(Component.java:4572)
at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:710)
at java.awt.EventQueue.access$400(EventQueue.java:82)
at java.awt.EventQueue$2.run(EventQueue.java:669)
at java.awt.EventQueue$2.run(EventQueue.java:667)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:87)
at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:98)
at java.awt.EventQueue$3.run(EventQueue.java:683)
at java.awt.EventQueue$3.run(EventQueue.java:681)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:87)
at java.awt.EventQueue.dispatchEvent(EventQueue.java:680)
at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:296)
at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:211)
at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:205)
at java.awt.Dialog$1.run(Dialog.java:1049)
at java.awt.Dialog$3.run(Dialog.java:1101)
at java.security.AccessController.doPrivileged(Native Method)
at java.awt.Dialog.show(Dialog.java:1099)
at java.awt.Component.show(Component.java:1591)
at java.awt.Component.setVisible(Component.java:1543)
at java.awt.Window.setVisible(Window.java:843)
at java.awt.Dialog.setVisible(Dialog.java:984)
at wordpress2myblog.WPImportUI$3.run(WPImportUI.java:222)
at java.awt.event.InvocationEvent.dispatch(InvocationEvent.java:209)
at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:708)
at java.awt.EventQueue.access$400(EventQueue.java:82)
at java.awt.EventQueue$2.run(EventQueue.java:669)
at java.awt.EventQueue$2.run(EventQueue.java:667)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:87)
at java.awt.EventQueue.dispatchEvent(EventQueue.java:678)
at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:296)
at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:211)
at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:201)
at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:196)
at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:188)
at java.awt.EventDispatchThread.run(EventDispatchThread.java:122) 
```

如果我尝试使用硬编码的相对路径解析文件，则代码可以正常工作。但是随着从文件选择器获取的路径，这些错误会杀死我的程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T00:21:38.810

使用 JFileChooser 中的 getSelectedFile() 方法并使用返回的文件创建一个 InputStream。

```
JFileChooser chooser = new JFileChooser();
File file = chooser.getSelectedFile();
InputStream inputStream = new FileInputStream(file);
Document document = builder.parse(inputStream); 
```

# c# - XNA Side Scrolling Shooter - 我怎样才能让子弹携带一个值并在以后引用该值？

> ID：15672017
> 
> 赞同：0
> 
> 时间：2013-03-28T00:16:39.433
> 
> 标签：c#, xna, game-engine

**前提：**

我正在独立开发一款横向卷轴射击游戏，其中涉及玩家射击 3 种不同类型的子弹（我们将它们称为 1 型、2 型和 3 型）。如果有意义的话，玩家可以在这些子弹类型之间切换以消灭不同的敌人（例如：1 型子弹杀死 2 型敌人；2 型子弹杀死 1 型敌人）。

在我的 Game1.cs 中，在 Update 方法下，我为每个敌人提供了一个简单的解决方法，如果 bulletType = x，如果子弹对特定类型的子弹较弱，子弹将与敌人发生碰撞并造成伤害。 **代码：**

```
//PlayerBullet vs Enemy
for (int i = 0; i < player.bulletList.Count; i++)
{
    if (player.bulletType == 1)
    {
        if (player.bulletList[i].hitBox.Intersects(e.hitBox))
        {
            //destroy bullet and damage ship
            player.bulletList[i].isVisible = false;
            e.isVisible = false;

            //Score
            hud.playerScore += 20;

            //Explosion
            explosionList.Add(new Explosion(Content.Load<Texture2D>("explosion3"), new Vector2(e.position.X, e.position.Y)));

            //Sound
            sm.explodeSound.Play();
        }
    }
} 
```

在播放器类中，通过按数字键盘键来切换子弹类型（Num1 = bulletType 1，Num2 = bulletType2 等）。这些子弹中的每一个都有与之关联的相应纹理。

这些单个子弹的射速足够快，在屏幕上绘制时看起来像一条实线。

**问题：**

当玩家射出一排 Type 1 Bullets 杀死 Type 2 Enemies，然后在 Type 1 Bullets 与 Type 2 Enemies 碰撞之前将 bulletType 切换为 Type 2 Bullets，即使纹理为 Bullet Type，子弹也不会碰撞1.

基本上，当玩家切换子弹类型时，它会更改屏幕上所有绘制的子弹的子弹类型，而不仅仅是切换子弹类型后发射的子弹。我需要让我的子弹带有一个值，并且我需要能够在玩家输入键时即时切换该值。我不确定如何做到这一点。我有一个 Bullet 类，其构造函数的值为“bulletType”，当玩家按下相应按钮调用 Shoot 函数时使用该值。

子弹类构造函数：

```
public Bullet(Texture2D newTexture, int newBulletType)
{
    velocity = 10;
    texture = newTexture;
    isVisible = false;
    bulletType = newBulletType;
} 
```

拍摄功能：

```
public void ShootYellow()
{
    //Shoot only when delay resets
    if (bulletDelay >= 0)
        bulletDelay--;

    //Create bullet at delay zero on player
    if (bulletDelay <= 0)
    {
        //Sound Effect
        //sm.playerShootSound.Play();

        Bullet newBullet = new Bullet(bulletYellowTexture, bulletType); //Create Bullet
        newBullet.position = new Vector2(position.X + 6 - newBullet.texture.Width / 2, position.Y + 30); //Spawn location of bullet

        //Make bullet visible
        newBullet.isVisible = true;

        //Add bullet to list
        if (bulletList.Count() < 256)
            bulletList.Add(newBullet);
    }

    //reset delay
    if (bulletDelay == 0)
        bulletDelay = 0;
} 
```

至少，我至少希望所有绘制的纹理都使用 bulletType 开关进行更新。这样所有绘制的子弹纹理都会切换到当前选择的子弹类型。

# json - 如何在 Play + Scala 中为自定义对象定义 json writer？

> ID：15672019
> 
> 赞同：1
> 
> 时间：2013-03-28T00:16:45.590
> 
> 标签：json, scala, playframework

您能否演示一下如何在 Scala 和 Play Framework 2.1-RC2 中为我的课程定义 json writer？

该文档相当混乱（并且将成为 Web 开发人员社区更广泛采用 Scala/Play 的重大障碍）。例如，不仅不清楚以下代码（取自**[此处](http://www.playframework.com/documentation/2.1.0/ScalaJsonCombinators)**）应该位于何处

```
implicit val taskWrites = (
  (__ \ "id").write[String] ~
  (__ \ "label").write[Boolean] ~
)(unlift(Task.unapply)) 
```

但如果我把它放在`object`定义中，它也是不可编译的。播放给我以下错误

```
not found: value __ 
```

这是我的 Task.scala

[http://pastebin.com/hG8F6Gqk](http://pastebin.com/hG8F6Gqk)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T06:26:39.413

好吧，原来问题很明显。我忘记导入了`play.api.libs.functional.syntax._`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-26T12:09:08.000

```
import play.api.libs.json._
import play.api.libs.functional.syntax._ 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-28T02:50:07.270

您使用的下划线不是标准下划线。

你的下划线：__

ASCII 字符 #95：_

# c# - C# Silverlight WCF Linq 服务从 MSQL 数据库中选择

> ID：15672024
> 
> 赞同：0
> 
> 时间：2013-03-28T00:17:45.547
> 
> 标签：c#, sql-server, wcf, linq, silverlight

我对此感到非常痛苦，我有一项任务，无法弄清楚如何使用 silverlight WCF Linq 服务。我有来自 Locations 表绑定到组合框的值，所以城市可以正确显示。在 SelectionChanged 事件中，我想将 location_name 传递给 GetWeather() 函数并显示另一个表中的相关天气。我不知道如何使用 location_name 来选择相关的 P_id，它在天气表中作为 location_id，然后显示来自相关 location_id 的天气。

这是我到目前为止的代码......但它不起作用......我只是希望它简单，因为 C# 根本不是我的包。

我的 GetWeather() 函数的 ServiceReference 文件是

```
[OperationContract]
public string GetWeather(string location_name)
{
    DataClasses1DataContext a = new DataClasses1DataContext();

    var identity = (from o in a.locations
                    where o.location_name == location_name
                    select o.P_Id);
    var weatherType = (from o in a.weathers
                       where o.location_id.Equals(identity)
                       select o.weather).ToString();

    return weatherType;
} 
```

主 C# 页面中的代码在这里......我做错了什么......

```
private void location_cmb_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
    a.GetWeatherCompleted += new EventHandler<GetWeatherCompletedEventArgs>(a_GetWeatherCompleted);
    a.GetWeatherAsync(location_cmb.SelectedItem.ToString());
}

void a_GetWeatherCompleted(object sender, GetWeatherCompletedEventArgs e)
{
    textBlock2.Text = e.Result;
} 
```

Visual Studio 没有显示任何错误，但它仍然没有运行......我没有想法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T00:27:38.573

我不确定是不是这样，但我注意到了一些事情：

这段代码：

```
(from o in a.locations where o.location_name == location_name select o.P_Id) 
```

实际上返回一个[集合](http://msdn.microsoft.com/en-us/library/bb534638.aspx)，而不是单个项目，因此当您尝试使用它时它可能无法正常工作：

```
(from o in a.weathers where o.location_id.Equals(identity) select o.weather) 
```

为了表明您只希望从查询中返回一个元素，您可以使用[First](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.first.aspx)、[Single](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.single.aspx)、[FirstOrDefault](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.firstordefault.aspx)或[SingleOrDefault](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.singleordefault.aspx)方法。

例如：

```
var identity = (from o in a.locations where o.location_name == location_name select o.P_Id).Single(); 
```

我会快速阅读每种方法（First、FirstOrDefault 等），看看哪种方法适合您的用例，但如果您确定会得到 1 个结果（即 location_name 在您的数据库中是唯一的），然后使用 Single( ） 应该可以。

这将为您提供`identity`（我假设它是整数类型），您可以在以下查询中使用它：

```
var weatherType = (from o in a.weathers where o.location_id == identity select o.weather).Single(); 
```

要获得一条记录...我在这里假设 o.weather（即`weather`数据库中的类/列中的属性）是一个字符串，并且您只想要/期望一条记录。

也许试试看？

* * *

**PS。**在方法中阅读您的查询`GetWeather()`，我认为也可以将您的两个查询组合成一个调用......但我认为也许我们应该让基础工作然后从那里开始（遵循“让它工作，让更好”的口头禅）。

**聚苯乙烯。**使用 your `DataContext`，您可能应该考虑将其包装在`using`语句中，或者在完成使用后将其[丢弃。](http://social.msdn.microsoft.com/Forums/en-US/adodotnetentityframework/thread/2625b105-2cff-45ad-ba29-abdd763f74fe/)

* * *

我不会做好这方面的工作，但这是（根据我有限的理解）在此响应中上面列出的方法`First`之间的关键区别：`SingleOrDefault`

*   `First`返回集合中的第一项，如果集合为空（零元素）则抛出异常
*   `FirstOrDefault`如果集合为空（零元素），则返回集合中的第一项或 null
*   `Single`返回集合中唯一的项目，如果集合中没有一个项目，则抛出异常
*   `SingleOrDefault`返回集合中的第一项，如果集合为空（零元素）则返回 null，如果集合有超过 1 个元素则抛出异常

# java - 使用 Play 框架，在与数据库相关的异常之后持久化 Hibernate 对象

> ID：15672026
> 
> 赞同：0
> 
> 时间：2013-03-28T00:17:53.370
> 
> 标签：java, hibernate, jpa, playframework

我是一名 Play/Hibernate 新手，试图扩展我继承的 Play 1.2.3 应用程序，该应用程序解析具有不可靠数据的文件内容并尝试将其持久保存到数据库中。

当应用程序在将其内容持久保存到数据库时出现问题时，我需要一种在数据库中进行标记的方法。在应用程序甚至没有捕获 SQL 异常并直接崩溃之前。因此，我将整个事情包装在一个 try-catch 块中，希望在 catch 块中我可以优雅地处理错误并将故障记录在数据库中。

粗略地说，这就是我将代码更新为：

```
try {
   MyObject parent = new MyObject();
   // Persist the parent object and all of its child objects.  The SQL errors are 
   // occurring on the child objects.
   parent.save();
   // Do a bit more processing
   parent.status=1;
   parent.save(); 
}
catch {
   // This is what I'm trying to do -- set the failure status 
   // in the database to look at later
   parent.status = 0;
   parent.save();
} 
```

MyObject 继承自：

```
package models;
import javax.persistence.*;

import javax.persistence.GeneratedValue;
import javax.persistence.Id;
import javax.persistence.MappedSuperclass;

@MappedSuperclass
public class MyObjectModel extends play.db.jpa.GenericModel { .. } 
```

上面写的代码抛出：

```
ERROR: current transaction is aborted, commands ignored until end of transaction block
ERROR ~ Could not synchronize database state with session 
```

`parent.refresh()`我之前试过打电话`save()`，但结果是：

```
play.exceptions.JavaExecutionException: org.hibernate.exception.GenericJDBCException: 
could not load an entity: [models.MyObject#465655] 
```

我尝试创建一个新的 MyObject 对象并为其赋予与前一个相同的值，包括先前获取的 Hibernate ID（和调用`merge()`），但这导致：

```
PersistenceException occured : org.hibernate.PersistentObjectException: 
detached entity passed to persist: models.MyObject 
```

如果我不给它之前获取的 Hibernate ID，它会抛出：

```
ERROR: current transaction is aborted, commands ignored until end of transaction block
PersistenceException occured : org.hibernate.exception.GenericJDBCException: 
could not get next sequence value 
```

我认为上述方法是最好的方法，因为这会使我无法级联到所有我不想这样做的子对象（并且会再次失败）。

[查看文档](http://www.playframework.com/documentation/api/1.1/play/db/jpa/GenericModel.html)，我没有想法。希望有人可以帮助我！我想做的只是将状态代码写入*父*对象（不是所有有问题的子对象）的数据库行，以便我可以标记此处存在持久性失败。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T08:17:07.350

我想当你有这样的异常时，事务被标记为仅回滚（通过`JPA.setRollbackOnly()`。你所要做的就是提交当前事务并启动一个新事务（通过`JPAPlugin.closeTx`和`startTx`）。

# eclipse - Eclipse Juno：Hibernate Code Generation 菜单项在哪里？

> ID：15672028
> 
> 赞同：1
> 
> 时间：2013-03-28T00:18:07.033
> 
> 标签：eclipse, eclipse-juno, eclipse-indigo

在 eclipse`Indigo`及以下版本中，曾经有一个 Code Generation 菜单：

![靛青](../Images/191682b63cd58ae500e6808f42162c44.png)

我似乎在 Eclipse 中找不到它`Juno`..

![朱诺](../Images/afbfad849ee5757de4994e8de9c74b6e.png)

它在哪里 ？我错过了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T07:32:32.987

请检查您是否可以通过 Window -> Customize Perspective -> Menu Visibility -> Run 自行启用它。

# jquery - jqueryUI：第一次单击时初始化对话框内容

> ID：15672033
> 
> 赞同：0
> 
> 时间：2013-03-28T00:18:45.147
> 
> 标签：jquery, jquery-ui

这对于有经验的 jqueryUI 用户来说应该很容易。我想要实现的是：

*   在页面刚刚呈现时有一个按钮（仅此而已）
*   单击此按钮时，将打开一个对话框并使用 AJAX 生成对话框内容

目前我已经拥有了其中的大部分，但使用了两个不同的 jquery UI 按钮。我正在使用 icanhaz，但它应该没有什么区别，因为我让这部分工作正常。这是html部分：

```
<script id="user" type="text/html">
    <p>
        There are following users:
        <ul>
        {{#users}}
            <input type="checkbox" name="user" value="{{ username }}" />{{ fullname }}
            {{^last}}<br />{{/last}}
        {{/users}}
        </ul>
    </p>
</script>

<a id="user-btn" class="btn">show users</a>

<a id="dialog-btn" class="btn">show dialog</a>

<div id="dialog-message" title="Select users">
</div> 
```

这是javascript部分：

```
$(document).ready( function() {

    $("#user-btn").click(function() {
        $.ajax({
            type: "GET",
            dataType: "json",
            url: "../php/client/json.php",
            data: {
                type: "users"
            }
        }).done(function( response ) {
            var element = $('#dialog-message');
            element.append(ich.user(response));
        });
    });

    $("#dialog-btn").click(function() {
        $("#dialog-message").dialog().dialog("open");
    });
}); 
```

当我单击第一个按钮“显示用户”时，它会生成对话框的内容。当我单击“显示对话框”时，将创建并打开对话框。我只是想清理它-单击时调用ajax（并渲染icanhaz），使用渲染的html创建对话框，打开对话框并显示（只需单击一次）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T00:22:35.093

```
$(document).ready( function() {

    $("#user-btn").click(function() {
        if ($('#dialog-message').is('.ui-dialog-content')) {
            // data already loaded and dialog already initialized
            $('#dialog-message').dialog('open');
        } else {
            // request data and initialize dialog
            $.ajax({
                type: "GET",
                dataType: "json",
                url: "../php/client/json.php",
                data: {
                    type: "users"
                }
            }).done(function( response ) {
                $('#dialog-message')
                    .append(ich.user(response)) // load data into element
                    .dialog(); // show as dialog (autoOpen is true by default)
            });
        }
    });
}); 
```

`$('#dialog-message').is('.ui-dialog-content')`只是检查对话框是否已经在元素上初始化的一种方法；可能有更好的方法。

# javascript - 将数组中的函数调用到表中

> ID：15672041
> 
> 赞同：0
> 
> 时间：2013-03-28T00:19:37.450
> 
> 标签：javascript, html, arrays, function, random

我正在尝试使用随机数将包含简单数学问题的几个函数调用到数组中，然后调用到表中。我想我很接近，我只是不确定如何写表格。我有如下：

HTML：

```
</head>
<body>
<div>
    <table id="content">
    </table>
</div>
</body>
</html> 
```

脚本：

```
function RandX(){

var x = Math.floor(Math.random()*300);
}

function RandY(){                       
var y = Math.floor(Math.random()*300);
}

var math1 = function(x,y) {return x * y;};  
var math2 = function(x,y) {return x + 1;};
var math3 = function(x,y) {return x/y;};
var math4 = function(x,y) {return x % y;};
var math5 = function(x,y) {return math.sqrt(x^2 + y^2);};
var math6 = function(x,y) {return x^2;};
var math7 = function(x,y) {return (10*x) + (y/2);};
var math8 = function(x,y) {return SIGMA)

var maths = [];

maths.push(math1);
maths.push(math2);
maths.push(math3);
maths.push(math4);
maths.push(math5);
maths.push(math6);
maths.push(math7);
maths.push(math8);
//maths[0](RandX,2);//return RandX* RandY
//maths[1](3,4);//12 - put random numbners here?

 var c = document.getElementById("Content");
 var content = document.createElement("tr");
 for( var i = 0; i < maths.length; i++ ){
  var d = document.createElement("<td>" + "</td>);
  d.innerHTML = "<td>" + maths[0](RandX(), RandY()) + "</td>"; 
  content.appendChild(d);
 }
 c.appendChild(content); 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T00:29:24.597

您的脚本中有一些错误 - 这是正确的：

[http://jsfiddle.net/wMF5M/](http://jsfiddle.net/wMF5M/)

```
function RandX(){
var x = Math.floor(Math.random()*300);
    return x;
}

function RandY(){                       
var y = Math.floor(Math.random()*300);
    return y;
}

var math1 = function(x,y) {return x * y;};  
var math2 = function(x,y) {return x + 1;};
var math3 = function(x,y) {return x/y;};
var math4 = function(x,y) {return x % y;};
var math5 = function(x,y) {return math.sqrt(x^2 + y^2);};
var math6 = function(x,y) {return x^2;};
var math7 = function(x,y) {return (10*x) + (y/2);};
var math8 = function(x,y) {return SIGMA;}

var maths = [];

maths.push(math1);
maths.push(math2);
maths.push(math3);
maths.push(math4);
maths.push(math5);
maths.push(math6);
maths.push(math7);
maths.push(math8);
//maths[0](RandX,2);//return RandX* RandY
//maths[1](3,4);//12 - put random numbners here?

 var content = document.getElementById("content");
 var tr = document.createElement("tr");
 for( var i = 0; i < maths.length; i++ ){
  var td = document.createElement('td');
  td.innerHTML =  + maths[0](RandX(), RandY());
  tr.appendChild(td);
 }
 content.appendChild(tr); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T01:15:52.343

我希望这有帮助！

[http://jsfiddle.net/Jra9w/1/](http://jsfiddle.net/Jra9w/1/)

 `````
//You don't need 2 different functions to execute the same logic, so here
//RandX and RandY are combined into randNum
function randNum() {

    return Math.floor(Math.random() * 300);

}

//Instead of instanciating the array and then pushing the functions into 
//it you can instanciate the array already initialized with a set of items.
var maths = [
        function (x, y) { return x * y; },
        function (x, y) { return x + 1; },
        function (x, y) { return x / y; },
        function (x, y) { return x * y; },
        function (x, y) { return Math.sqrt(x^2 + y^2); },
        function (x, y) { return x^2; },
        function (x, y) { return (10 * x) + (y / 2); },
        function (x, y) { 
            //SIGMA is not defined in your code and I am
            //not sure what you want to do in here. This function will throw
            //an error if you try to return the undeclared SIGMA variable

            //return SIGMA;
        }
    ],
    i = 0,
    len = maths.length,

    //JavaScript is a case-sensitive language so you must write the id exactly as defined
    //in the id attribute of the html element
    tableElement = document.getElementById('content'),
    results = [];

//Note that we have cached the maths.length result into the 'len' variable instead of
//putting it directly into the loop condition. The reason for this is that the condition //will be evaluated on each iterations and property lookups are expensive in JavaScript, so 
//we try to reduce them.

for (; i < len; i++) {
    //we push all the results into a new array
    results.push(maths[i](randNum(), randNum()));
}

//Array.join is faster for concatenating strings that using the + operator when you want to 
//concatenate a lot of strings together.
tableElement.innerHTML = '<tr><td>' + results.join('</td><td>') + '</td></tr>'; 
````  `* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T00:27:15.340

您可以遍历这些项目并将它们添加到表中，如下所示：

```
var contentDiv = document.getElementById("Content");
var row = document.createElement("tr");
for( var i = 0; i < maths.length; i++ ){
    var cell = document.createElement("td");
    cell.innerHTML = maths[i]; 
    content.appendChild(cell);
}
contentDiv.appendChild(content); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-28T00:49:09.703

这些函数需要返回一个值。由于除了名称之外它们是相同的，因此两个函数似乎没有多大意义：

```
function RandX(){
  return Math.floor(Math.random()*300);
}

function RandY(){                       
  return Math.floor(Math.random()*300);
} 
```

分配给变量，然后推入数组的函数可以简单地在数组文字中分配：

```
var maths = [
    function(x,y) {return x * y;},
    function(x,y) {return x + 1;},
    function(x,y) {return x/y;},
    function(x,y) {return x % y;},
    function(x,y) {return math.sqrt(x^2 + y^2);},
    function(x,y) {return x^2;},
    function(x,y) {return (10*x) + (y/2);},
    function(x,y) {return SIGMA)
];

 var c = document.getElementById("Content");
 var content = document.createElement("tr");
 for( var i = 0; i < maths.length; i++ ){

   // The argument for createElement is the tagname, not markup
   var d = document.createElement('td'); 
```

您不能将 TD 指定为 TD 的内容。由于这只是文本，最好创建一个文本节点并插入它。此外，您想每次调用不同的函数，所以使用`i`：

```
 d.appendChild(document.createTextNode(maths[i](RandX(), RandY()))); 
 }

// In IE, you must append rows to a table section element, (thead, tfoot or tbody):
c.tBodies[0].appendChild(content); 
```

HTH。``

# java - 在jsp中添加一个类

> ID：15672047
> 
> 赞同：3
> 
> 时间：2013-03-28T00:20:08.163
> 
> 标签：java, apache, class, jsp, tomcat

我正在使用以下 JSP 页面：

```
<%@page import="java.util.*" %> 

<%
 String[] colors = {"Gray", "Brown", "Red" , "Orange", "yellow", "Green", "Blue", "purple"};
 String color, numero;

 color=request.getParameter("colores");
 numero=request.getParameter("numeros");

 int c = Integer.parseInt(request.getParameter("colores")); 
 int num = Integer.parseInt(request.getParameter("numeros"));

%>

<HTML>

  <BODY>  

    <TABLE BORDER="1" align="center" bgcolor="#E8FDFF" height="40%">

     <TR>
     <TD bgcolor="<%=colors[c-1] %>"> 

    <% HERE GOES THE JAVA PART %>

     </TD>
     </TR>

    </TABLE>

  </BODY>

</HTML> 
```

我想添加一个 java 类和方法，如下所示：

```
public class Tabla 
{
public static void main (String[] args) 
    {        
        int n=67;       
        int j;

        Tabla table = new Tabla ();
        int dato[];
        dato=table.producto(n);        

        for (j=0;j<10;j++)
        {System.out.println(dato[j]);
        }

    }

    public int [] producto(int num) 
    { 
        // make a 10-element array
        int a[] = new int[10];

       // fill up the array with products
        for (int i = 0; i < 10; i++)
        {a[i] = num * (i+1); }

        return a;        

    }    

} 
```

我尝试将整个代码添加到 jsp 页面，但它不起作用。我不知道该怎么做。

我已经“搜索”了解决方案，人们谈论了一个类文件夹。我在我的 PC 中找到了用于 Apache Tomcat 的类文件夹，这是我正在使用的软件，但类文件有点“编码”，所以我想我没有做正确的事情。

任何关于我能做什么的建议或想法都会非常感激

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T05:15:28.410

您不能`main()`在 Web 应用程序中使用方法，因此将您的类与`main()`方法放在 jsp 页面中根本没有运气。您可以通过其他方式尝试以下两种方法中的任何一种：

*   编写一个简单的 bean 类，以公共方法的形式将您的代码放在那里，将该类导入您的 jsp 中，并通过使用该类对象的`<jsp:useBean >`标记集属性创建该类对象，`<jsp:setProperty >`并根据您的简单调用该对象的方法要求。
*   创建一个只有应用程序的一些视图部分的 jsp 页面，获取`<form > tag`您的 jsp，获取一个 servlet 并将其映射到 url 模式，在表单标签中使用这个 servlet 的 url 作为操作值，就像这样将控件发送到一个 servlet，把servlet 中的逻辑`doGet(-,-)`或`doPost(-,-)`执行逻辑的方法。

# jboss7.x - JBoss7.1.3：@EJB 工作，而@Inject 失败

> ID：15672051
> 
> 赞同：0
> 
> 时间：2013-03-28T00:20:28.473
> 
> 标签：jboss7.x, java-ee-6

我最近用 Glassfish 开发了一个应用程序，开发过程非常顺利，现在有了 JBoss，我也在尝试做同样的事情，但由于各种问题而减慢了速度，例如：@EJB 有效，但 @Inject 失败。我还没有一个花哨的类，我只有一个 Singleton Startup 类和一个我注入的简单无状态类，令我惊讶的是，注入不起作用。这是我的课：

```
package com.czetsuya.dropship;

import javax.annotation.PostConstruct;
import javax.ejb.EJB;
import javax.ejb.Singleton;
import javax.ejb.Startup;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

@Singleton
@Startup
public class StartupListener {
    private Logger log = LoggerFactory.getLogger(StartupListener.class);

    @EJB
    private TestService testService;

    public StartupListener() {

    }   

    @PostConstruct
    private void init() {
        testService.test();
        log.debug("startup");
    }
} 
```

服务等级：

```
package com.czetsuya.dropship;

import javax.ejb.LocalBean;
import javax.ejb.Stateless;

@Stateless
@LocalBean
public class TestService {
    public TestService() {

    }

    public void test() {
        System.out.println("run");
    }
} 
```

另一件事是，如果我将记录器注入以下生产者，它也不起作用并抛出：

```
Caused by: org.jboss.weld.exceptions.DeploymentException: WELD-001408 Unsatisfied dependencies for type [Logger] with qualifiers [@Default] at injection point [[field] @Inject private com.czetsuya.dropship.StartupListener.log] 
```

记录器生产者：

```
@Produces
Logger createLogger(InjectionPoint injectionPoint) {
    return LoggerFactory.getLogger(injectionPoint.getMember().getDeclaringClass().getName());
} 
```

请注意，我的 ejb 和 war 项目中有 beans.xml。

我的 beans.xml 文件：

```
<beans xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"xsi:schemaLocation="http://java.sun.com/xml/ns/javaeehttp://java.sun.com/xml/ns/javaee/beans_1_0.xsd"></beans> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T00:39:14.610

嗯，我的错，似乎是一个损坏的构建，在我 Project clean 和 maven clean 并将 beans.xml 内容更改为：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:s="urn:java:ee" xmlns:security="urn:java:org.jboss.seam.security" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://jboss.org/schema/cdi/beans_1_0.xsd"></beans> 
```

注射现在有效。以及记录器注入。

# oracle - 使用多个表数据触发

> ID：15672054
> 
> 赞同：0
> 
> 时间：2013-03-28T00:20:49.577
> 
> 标签：oracle, plsql, triggers

```
create or replace 
trigger audit_att_eval
    AFTER INSERT OR UPDATE OF evaluation ON attendance
    FOR EACH ROW
DECLARE
  fname VARCHAR2(22);
  sname VARCHAR2(22);
  ctitle VARCHAR(30);
  ostartdate DATE;
  oinstructor VARCHAR2(12);
BEGIN
  SELECT student.first_name, student.surname, course.title, offering.start_date, offering.instructor
  INTO fname, sname, ctitle, ostartdate, oinstructor
  FROM student, course, offering, attendance
  WHERE student.student_id = attendance.student_id
  AND attendance.offering_id = offering.offering_id
  AND offering.course_id = course.course_id;
IF (:NEW.evaluation = 0)
    THEN
      INSERT INTO eval_audit
      VALUES (fname, sname, ctitle, ostartdate, oinstructor, :NEW.evaluation);   
  END IF;
END; 
```

这可以编译，但是当我通过尝试更新现有的出勤率来测试它时。评估我收到以下错误：

```
Error report:
SQL Error: ORA-04091: table.ATTENDANCE is mutating, trigger/function may not see it
ORA-04088: error during execution of trigger 'OPS$1022005.AUDIT_ATT_EVAL'
04091\. 00000 -  "table %s.%s is mutating, trigger/function may not see it"
*Cause:    A trigger (or a user defined plsql function that is referenced in
           this statement) attempted to look at (or modify) a table that was
           in the middle of being modified by the statement which fired it.
*Action:   Rewrite the trigger (or function) so it does not read that table. 
```

一如既往，我将不胜感激任何帮助引导我走向正确的方向。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T00:36:31.937

当我们执行一些 DML 操作（在您的情况下为 INSERT/UPDATE）并且我们试图从同一个触发器中选择受影响的记录（您从考勤表中获取）时，通常会发生变异错误。所以基本上我们试图从拥有触发器的表中选择触发器中的记录。这会造成不一致，并且 Oracle 会引发变异错误

```
create or replace 
trigger audit_att_eval
   AFTER INSERT OR UPDATE OF evaluation ON attendance
   FOR EACH ROW
DECLARE
  --fname VARCHAR2(22);
  --sname VARCHAR2(22);
  --ctitle VARCHAR(30);
  --ostartdate DATE;
  --oinstructor VARCHAR2(12);

CURSOR fetch_audit_details
   IS 
    SELECT student.first_name, student.surname, course.title, offering.start_date, offering.instructor
  --INTO fname, sname, ctitle, ostartdate, oinstructor
  FROM student
      , course
      , offering
   -- ,attendence   i have removed this because this is not allowed in this trigger
  WHERE student.student_id = :NEW.student_id    --use the new student id
  AND :NEW.offering_id = offering.offering_id   ----use the new offering_id
  AND offering.course_id = course.course_id;     

fetch_audit_row fetch_audit_details%ROWTYPE;

BEGIN

IF (:NEW.evaluation = 0)
  THEN
  --You need details only when evaluation value is 0 ,thats why i put this inside 
  --condition
   OPEN fetch_audit_details;
   FETCH fetch_audit_details INTO fetch_audit_row;
   CLOSE fetch_audit_details;

  --check whether this cursor returns null ,do what you need to do in this situation??

 INSERT INTO eval_audit
     VALUES (fetch_audit_row.first_name, fetch_audit_row.surname, fetch_audit_row.title, fetch_audit_row.start_date, fetch_audit_row.instructor, 0);   
   END IF;
  END; 
```

# php - 使用 PHP 将 JSON 保存到 mySQL

> ID：15672058
> 
> 赞同：0
> 
> 时间：2013-03-28T00:21:25.407
> 
> 标签：php, mysql, json

我需要将一组数据保存到 MySQL。但是数组的长度不是固定的。

该数组可能类似于：

```
array(key1 => value1) 
```

或喜欢

```
array(key1 => value1, key2=> value2) 
```

等等。

如果它是一个固定长度的数组，那么 JOIN 可以解决这个问题。我正在考虑将其保存为 JSON 字符串

数据表如下：

```
id -- context -- content (JSON Str) 
```

这是一个好主意吗？有没有更好的方法来做到这一点？
谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T00:25:39.227

您可能需要考虑一个单独的表，这样以后查询起来会容易得多。

```
data [table]
- id
- context

data_items [table]
- data_id [foreign_key]
- key
- value 
```

在数组中插入尽可能多的 data_items 记录，链接到一个数据记录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T00:25:08.807

是的，将数组数据存储在 JSON 中是个好主意。序列化更便携，并且根据我的经验，它更擅长处理 UTF-8 字符。

FTR 我通常尽量不在数据库中存储大量“内容”数据，而是选择像 MongoDB 这样的针/干草堆文件存储。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T00:25:20.003

如果您确实知道不需要访问 json 字符串中的任何数据，并且您永远不会尝试根据此信息访问任何行，那么将其存储为 json 字符串可能会起作用。

通常使用第二个表来规范化数据是一个更好的主意。或者切换到 NOSQL 数据库解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-28T00:27:09.713

您当然可以以 PHP 的序列化格式或 JSON 等序列化格式存储序列化数据。我唯一的问题是您是否需要访问此序列化数组中的任何数据（即查询此数据）。如果您总是要查询某种 id，这应该可以正常工作。但是，如果您需要实际处理数据库中的数据，您可能需要考虑使用 NoSQL 解决方案来处理非结构化数据。

# python - 如何编写可重复的 raw_input？

> ID：15672060
> 
> 赞同：0
> 
> 时间：2013-03-28T00:21:34.110
> 
> 标签：python, raw-input

所以我正在尝试编写一个脚本，允许用户在不同类别下写下笔记，然后将这些笔记打印到输出文件中。下面看一些示例代码。

```
def notes():
    global text
    text = raw_input("\nPlease enter any notes.\n>>> ")
    print "\Note added to report."
    notes_menu()

def print_note():
    new_report.write("\nNotes: \n%r" % text) 
```

我的问题分为两部分：

1.  我可以用什么来做到这一点，以便如果再次调用 notes 方法（文本已经分配给字符串），它会创建一个名为 text1 的新变量，并且会在调用 notes 方法和 text 时继续这样做多次分配？

2.  如何让打印方法继续检查并打印尽可能多的文本^ nths？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T07:07:20.110

使用

> iter(callable, sentinel) -> 迭代器

```
>>> list(iter(raw_input, ''))
apple
1 2 3
foo bar

['apple', '1 2 3', 'foo bar'] 
```

自定义它：

```
>>> list(iter(lambda: raw_input('Enter note: '), ''))
Enter note: test
Enter note: test 2
Enter note: 
['test', 'test 2'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T00:30:53.537

我想你会想要使用循环来阅读多行笔记，将它们添加到列表中。这是一个如何工作的示例：

```
def notes():
    lines = []
    print "Please enter any notes. (Enter a blank line to end.)"
    while True: # loop until breaking
        line = raw_input(">>> ")
        if not line:
            break
        lines.append(line)

    return lines 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T00:27:39.493

你应该使用`list`s ：

```
texts = []
def notes():
    global texts
    txt = raw_input("\nPlease enter any notes.\n>>> ")
    texts.append(txt) # Add the entered text inside the list
    print "\Note added to report."
    notes_menu()

def print_note():
    for txt in texts:
        new_report.write("\nNotes: \n%r" % txt) 
```

我希望那是你想要的。

编辑：因为我很确定我之所以被否决是因为我使用了`global`，所以我想澄清一下：我使用`global`是因为 OP used `global`，而不是因为这是一个好的解决方案。

# wpf - 如何在我的 .NET 应用程序中以编程方式显示来自 Windows Shell 的新对象列表

> ID：15672063
> 
> 赞同：1
> 
> 时间：2013-03-28T00:21:42.110
> 
> 标签：wpf, shell, contextmenu, explorer

当您右键单击桌面时，您会看到包含“新建”子菜单的外壳上下文菜单。

示例 1：

![外壳新对象列表](../Images/6843401aa08a92131bdd6de41d216c31.png)

示例 2：

![在此处输入图像描述](../Images/66765f8127c47b1fd56b00c1b5281bea.png)

我想知道是否可以将此功能添加到我的 C# WPF 应用程序中？我会将这些项目放在我的应用程序的上下文菜单中，但我不知道如何获取所有这些项目以及如何执行所选项目（例如，创建新的默认文件）。

我认为这需要一些 COM 互操作，但我在网上找不到任何示例代码（甚至不是非托管示例）。我尝试显示整个菜单上下文（通过使用 gong .net shell lib），但是其中缺少这个“新”子菜单，所以我认为它可能不是 shell 上下文菜单的一部分，而是由 Windows 资源管理器动态添加的。理想情况下，即使我需要显示整个上下文菜单，我也希望从 Windows 资源管理器中重用此功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T01:36:01.570

这些被称为 ShellNew 类。它们只是 Windows 查找的注册表项。

这是一个开源项目，它有一些使用它们的辅助函数：

[http://sourceforge.net/projects/shellnewhandler/](http://sourceforge.net/projects/shellnewhandler/)

我猜您想从注册表中检索这些列表并将它们填充到您的应用程序中？

作为您需要什么信息的示例，打开 regedit 并转到 HKEY_CLASSES_ROOT 然后查找“.txt”关键字。它有一个“ShellNew”键，我认为它还从 notepad.exe 检索一个新文件名作为字符串资源（这是可选的，但给它一个“New Text Document.txt”名称）。您还会注意到 .txt 注册表项的默认键是“txtfile”。这指向另一个描述文件类型并给出其图标路径的键。

# python - 什么是 ExpatError？

> ID：15672064
> 
> 赞同：5
> 
> 时间：2013-03-28T00:22:17.410
> 
> 标签：python, xml

我一直在尝试使用 Python 解析 XML，并且发现在我的 XML 标记中出现拼写错误会引发`ExpatError`. 由于我不认为我的代码驻留在国外，`ExpatError`一般来说，指的是什么？

拼写错误的代码：

```
minidom.parseString("<people><pesron>Dan</person><person>John</person></people>") 
```

结果是：

```
ExpatError                                Traceback (most recent call last)
<ipython-input-5-9c00296c48cb> in <module>()
----> 1 minidom.parseString("<people><pesron>Dan</person><person>John</person></people>")

/Library/Frameworks/Python.framework/Versions/7.3/lib/python2.7/xml/dom/minidom.pyc in parseString(string, parser)
   1928     if parser is None:
   1929         from xml.dom import expatbuilder
-> 1930         return expatbuilder.parseString(string)
   1931     else:
   1932         from xml.dom import pulldom

/Library/Frameworks/Python.framework/Versions/7.3/lib/python2.7/xml/dom/expatbuilder.pyc in parseString(string, namespaces)
    938     else:
    939         builder = ExpatBuilder()
--> 940     return builder.parseString(string)
    941 
    942 

/Library/Frameworks/Python.framework/Versions/7.3/lib/python2.7/xml/dom/expatbuilder.pyc in parseString(self, string)
    221         parser = self.getParser()
    222         try:
--> 223             parser.Parse(string, True)
    224             self._setup_subset(string)
    225         except ParseEscape:

ExpatError: mismatched tag: line 1, column 21 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2021-01-04T09:27:13.603

总结和扩展对该问题的评论：

[`ExpatError`](https://docs.python.org/3/library/pyexpat.html#xml.parsers.expat.ExpatError)是[expat](https://docs.python.org/3/library/pyexpat.html)报告错误时引发的异常类型。expat 是 Python 标准库的 XML 解析模块。

[`minidom`](https://docs.python.org/3/library/xml.dom.minidom.html)，Python 的文档对象模型接口的最小实现，在`minidom.parseString()`被调用时在内部使用 expat 来解析 XML 输入。

输入 XML 中的拼写错误给它留下了一个`<pesron>`未关闭的标签，触发 expat 通过抛出`ExpatError`.

至于名字 expat 的由来，它不是对英文“expatriate”的引用，而是模块描述的缩短版本：(E)Xml PArser Toolkit。

# c# - 尝试使用 Action.Method arg 运行 DynamicMethod 时出现 VerificationException

> ID：15672065
> 
> 赞同：2
> 
> 时间：2013-03-28T00:22:17.763
> 
> 标签：c#, .net, cil, reflection.emit

我试图在事件发生时触发一个动作，忽略事件参数（至少现在）。我通过反射找到事件，然后创建一个匹配预期签名的动态方法（不能保证它只是发件人/EventArgs) 并从那里尝试调用该操作。

```
/// <summary>
/// Execute an action when an event fires, ignoring it's parameters.
/// 'type' argument is element.GetType()
/// </summary>
bool TryAsEvent(Type type, UIElement element, string actionStr, Action act)
{
    try
    {
        //Get event info
        var eventInfo = type.GetEvent(actionStr); //Something like 'Click'
        var eventType = eventInfo.EventHandlerType;

        //Get parameters
        var methodInfo = eventType.GetMethod("Invoke");
        var parameterInfos = methodInfo.GetParameters();
        var paramTypes = parameterInfos.Select((info => info.ParameterType)).ToArray();

        //Create method
        var dynamicMethod = new DynamicMethod("", typeof(void), paramTypes);

        //Static method that will invoke the Action (from our parameter 'act')
        //Necessary because the action itself wasn't recognized as a static method
        // which caused an InvalidProgramException
        MethodInfo exec = typeof(ThisClass).GetMethod("ExecuteEvent");

        //Generate IL
        var il = dynamicMethod.GetILGenerator();
        il.DeclareLocal(typeof(MethodInfo));

        //MethodInfo miExecuteAction = act.Method;
        //Commented out some trial and failure stuff
        il.Emit(OpCodes.Ldobj, act.Method);
        //il.Emit(OpCodes.Stloc, lc);
        //il.Emit(OpCodes.Ldloc, lc);
        //il.Emit(OpCodes.Ldobj, act.Method);
        //il.Emit(OpCodes.Ldarg_0);
        //il.Emit(OpCodes.Pop);
        il.EmitCall(OpCodes.Call, exec, null);
        il.Emit(OpCodes.Ret);

        //Test the method (the event under test has a handler taking 2 args):
        //var act2 = dynamicMethod.CreateDelegate(eventType);
        //act2.DynamicInvoke(new object[]{null, null});

        //Add handler
        var handler = dynamicMethod.CreateDelegate(eventType);
        eventInfo.AddEventHandler(element, handler);

        return true;
    }
    catch
    {
        return false;
    }
}

public static void ExecuteEvent(MethodInfo i)
{
    i.Invoke(null, null);
} 
```

谁能告诉我如何实现这一目标？

更新：这是一个模仿真实场景的简洁 VS11 项目文件：

[下载](https://mega.co.nz/#!6oI3zD7b!bp-5XCNa52I1A3rUopLEBywOtJtVjjf2XNCVEJl9tZc)

**更新（修复）：**

```
public class Program
{
    public static void Main(string[] args)
    {
        var x = new Provider();

        new Program().TryAsEvent(
            x.GetType(),
            x,
            "Click",
            new Program().TestInstanceMethod);
            //Use this lambda instead to test a static action
            //() => Console.WriteLine("Action fired when event did."));

        x.Fire();
        Console.ReadLine();
    }

    public void TestInstanceMethod()
    {
        Console.WriteLine("Action fired when event did.");
    }

    /// <summary>
    /// Execute an action when an event fires, ignoring it's parameters.
    /// </summary>
    bool TryAsEvent(Type type, object element, string actionStr, Action act)
    {
        try
        {
            var getMFromH = typeof(MethodBase)
                .GetMethod("GetMethodFromHandle", 
                BindingFlags.Public | BindingFlags.Static, 
                null, 
                new[] { typeof(RuntimeMethodHandle) }, null);

            //Get event info
            var eventInfo = type.GetEvent(actionStr);
            var eventType = eventInfo.EventHandlerType;

            //Get parameters
            var methodInfo = eventType.GetMethod("Invoke");
            var parameterInfos = methodInfo.GetParameters();
            var paramTypes = parameterInfos.Select((info => info.ParameterType)).ToArray();

            //Non-static action?
            var target = act.Target;
            if (target != null) //Prepend instance object
                paramTypes = new[] {target.GetType()}.Union(paramTypes).ToArray();

            //Create method
            var dynamicMethod = new DynamicMethod("", typeof(void), paramTypes);

            //Static method that will invoke the Action (from our parameter 'act')
            var exec = typeof (Program).GetMethod
                (target != null // Call proper method based on scope of action
                     ? "ExecuteEvent"
                     : "ExecuteEventStati");

            //Generate IL
            var il = dynamicMethod.GetILGenerator();
            if (target != null) //Push object instance on stack if working with non-static action
                il.Emit(OpCodes.Ldarg_0);
            il.Emit(OpCodes.Ldtoken, act.Method);
            il.Emit(OpCodes.Call, getMFromH);
            il.Emit(OpCodes.Call, exec);
            il.Emit(OpCodes.Ret);

            //Add handler
            var handler =
                target != null
                //Call with target obj if we're working with a non-static action
                ? dynamicMethod.CreateDelegate(eventType, target)
                : dynamicMethod.CreateDelegate(eventType);
            eventInfo.AddEventHandler(element, handler);

            return true;
        }
        catch (Exception ex)
        {
            Console.WriteLine("Exception: " + ex);
            return false;
        }
    }

    public static void ExecuteEventStati(MethodInfo i)
    {
        i.Invoke(null, null);
    }
    public static void ExecuteEvent(object o, MethodInfo i)
    {
        i.Invoke(o, null);
    }
} 
```

这是该示例的无关代码（以防有人想要复制和粘贴）：

```
public class Provider
{
    public event MyRoutedEventHandler Click;

    public void Fire()
    {
        if (Click != null)
            Click(this, new MyRoutedEventArgs());
    }
}

public delegate void MyRoutedEventHandler(object sender, MyRoutedEventArgs e);

public class MyRoutedEventArgs : RoutedEventArgs
{
    public MyRoutedEventArgs()
    {
    }

    public MyRoutedEventArgs(RoutedEvent routedEvent)
        : this(routedEvent, (object)null)
    {
    }

    public MyRoutedEventArgs(RoutedEvent routedEvent, object source)
        : base(routedEvent, source){}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T22:12:32.770

你不能这样用`ldobj`。 `ldobj`应该从堆栈中获取地址或托管引用，并将存储在该地址的值类型装箱到对象中。相反，您使用`ldobj`空堆栈调用并且使用了错误的重载`Emit`（第二个参数应该是值类型的类型，而不是任意对象实例）。

相反，您应该使用`ldtoken`（使用`Emit`您已经在使用的重载，将操作的方法作为第二个参数传递），然后调用`MethodBase.GetMethodFromHandle`您的`ExecuteEvent`方法。请注意，您应该使用类似`Emit(OpCodes.Call, exec)`here 而不是的调用`EmitCall`，其文档明确指出它仅用于调用 varargs 方法，而不用于正常调用。这应该适用于非泛型方法的委托 - 对于泛型方法，您需要跳过一些额外的障碍。

这应该可以清除 IL 生成中最明显的问题。但是，我认为您的方法至少存在一个概念问题：如果`Action`委托指向非静态方法怎么办？然后，您还需要捕获和使用动作的`Target`，这将是非常重要的。

# javascript - 如何控制台记录单个对象值而不是全部？

> ID：15672067
> 
> 赞同：0
> 
> 时间：2013-03-28T00:22:29.367
> 
> 标签：javascript, facebook-graph-api, jquery-mobile, facebook-javascript-sdk, javascript-objects

我只是想修复我的代码。当我单击列表中的一个名称时，它会出现，如下所示，而不是控制台记录单击的名称，它将控制台记录单击的名称，以及该名称后面的每个名称。因此，如果我单击第一个名称，它将控制台记录该名称和之后的每个名称，如果单击最后一个名称，它将仅控制台记录该名称，依此类推。

![在此处输入图像描述](../Images/f6ebadaccfd03809b03392271fbce3f1.png) ![在此处输入图像描述](../Images/de65cf52f46f91366670878f47cf0320.png)

我不太确定出了什么问题。这是我的代码：

```
function getGroupWall() {
    $("#groupUL").html("");
    function splitName(txt){
                var myString = txt;

                var mySplitResult = myString.split(" ");

                console.log("The first element is " + mySplitResult[0]); 
                console.log("The second element is  " + mySplitResult[1]); 
                console.log("The third element is  " + mySplitResult[2]); 

    };
    FB.api('/421727124532461/feed?limit=5', 'get', function(response){
        console.log(response.data);
        for (i=0; j=response.data.length; i++) {
            $("#groupUL").append("<li>" + "<h4>Item Description:</h4> " + response.data[i].message + "<br /> " + "<h2>Posted By:</h2> <a href='#' class='splitNames'>" + response.data[i].from.name + "</a>" + "<br />"+ "<h4># of Replys: </h4>" + response.data[i].comments.count + "<br />" +  "<a href='" + response.data[i].link + "' target='new' style='text-align:right;'>(external url)</a>" + "<br /> " + "<img src='"+response.data[i].picture+"'>" + "</li><br />");
            $(".splitNames").click((function (item) {
                return function (event) {
                    splitName(item.from.name)
                }
            }(response.data[i])));
        }
    });
} 
```

我也收到此错误： ![在此处输入图像描述](../Images/ca85814c16fc42fabe727753084e2b77.png)

...但它似乎显示回复的数量很好？如此处所示：

![http://i.stack.imgur.com/uNtRt.png](../Images/ffd5f27843364737162671e90b80e1ef.png)

# sql-server-2005 - 选择列值作为列名

> ID：15672070
> 
> 赞同：0
> 
> 时间：2013-03-28T00:22:41.347
> 
> 标签：sql-server-2005, pivot, union

我有下表：tb_answers

表结构如下

```
ID | QUESTIONID | SURVEYID | LEAGUEID | MEMBERID | ANSWER | DATEADDED | DIVISIONID 
```

样本数据

```
302347 | 2336 | 172 | 146 | 68 | 467 Vallie Lane | 2012-05-21 16:36:22.433 | 0
302350 | 2340 | 172 | 146 | 68 | 591             | 2012-05-21 16:36:22.483 591 
```

我需要按如下方式呈现这些数据。

```
DYNNAMIC LIST OF QUESTION#QUESTIONID# | MEMBERID | DIVISION
DYNNAMIC LIST OF VALUES OF QUESTION#QUESTIONID#|#MEMBERID#|DIVISION 
```

所以我可以按值排序`QUESTION#QUESTIONID#`

这可能吗？我不擅长枢轴和联合，因此不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T00:35:03.980

这是官方的 MS 示例：

```
SELECT 'AverageCost' AS Cost_Sorted_By_Production_Days, 
[0], [1], [2], [3], [4]
FROM
(SELECT DaysToManufacture, StandardCost 
    FROM Production.Product) AS SourceTable
PIVOT
(
AVG(StandardCost)
FOR DaysToManufacture IN ([0], [1], [2], [3], [4])
) AS PivotTable; 
```

这是数据的一个支点：

```
USE AdventureWorks2008R2 ;
GO
SELECT DaysToManufacture, AVG(StandardCost) AS AverageCost 
FROM Production.Product
GROUP BY DaysToManufacture; 
```

产生这个

```
DaysToManufacture          AverageCost    
0                          5.0885    
1                          223.88    
2                          359.1082    
4                          949.4105 
```

如您所见，他们明确指定了透视列 - 它不是数据驱动的。要使事情完全由数据驱动，您基本上必须执行两次，第一次将列名生成到字符串模板中。第二遍执行生成的 SQL。

```
DECLARE @dyncols AS VARCHAR(MAX) = (SELECT 
  STUFF((SELECT DISTINCT ',' + QUOTENAME(CONVERT(VARCHAR(50), YOURPIVOTCOL)) 
  FROM YOURTABLE FOR XML PATH(''), TYPE).VALUE('.', 'VARCHAR(MAX)'),1,1,'')) 
```

# c# - 接收“Install”方法中使用的参数的安装程序类

> ID：15672072
> 
> 赞同：2
> 
> 时间：2013-03-28T00:23:11.757
> 
> 标签：c#, installation

我有一个继承自 System.Configuration.Install.Installer 类的类，用于安装 Windows 服务。它看起来像这样：

```
[RunInstaller(true)]
public class HostInstaller : Installer
{
    private const string _serviceName = "My service name";
    private ServiceProcessInstaller _process;
    private ServiceInstaller _service;

    public HostInstaller()
    {
        _process = new ServiceProcessInstaller();
        _process.Account = ServiceAccount.User;
        _process.Username = "My user name";  // Hard coded
        _process.Password = "My password";   // Hard coded
        _service = new ServiceInstaller();
        _service.ServiceName = _serviceName;
        _service.Description = "My service description";
        _service.StartType = ServiceStartMode.Automatic;
        Installers.Add(_process);
        Installers.Add(_service);
    }
} 
```

我使用 InstallUtil.exe 实用程序安装和卸载此服务，一切正常。

然后我必须接收用户名和密码作为参数（而不是硬编码），所以我更改了类并覆盖了“安装”方法，并从构造函数中移动了上面提到的代码部分。

```
public override void Install(System.Collections.IDictionary stateSaver)
{
    string userName = this.Context.Parameters["UserName"];
    if (userName == null)
    {
        throw new InstallException("Missing parameter 'UserName'");
    }

    string password = this.Context.Parameters["Password"];
    if (password == null)
    {
        throw new InstallException("Missing parameter 'Password'");
    }

    _process = new ServiceProcessInstaller();
    _process.Account = ServiceAccount.User;
    _process.Username = userName;
    _process.Password = password;
    _service = new ServiceInstaller();
    _service.ServiceName = _serviceName;
    _service.Description = "My service description";
    _service.StartType = ServiceStartMode.Automatic;
    Installers.Add(_process);
    Installers.Add(_service);

    base.Install(stateSaver);
} 
```

现在，我再次安装服务，使用这个：

InstallUtil.exe /UserName=UserName /Password=UserPassword 路径...

使用所需的用户名和密码，该服务的安装运行良好。但是，我现在确实遇到了卸载服务的问题。我正在使用 InstallUtil.exe /u，但服务仍然存在。

[我在这里](http://msdn.microsoft.com/en-us/library/system.configuration.install.installer.install.aspx)读到了一个有用的提示：

如果您需要在 Install 方法中将安装程序实例添加到 Installers 集合，请务必在 Uninstall 方法中对集合执行相同的添加操作。但是，如果将安装程序实例添加到自定义安装程序的类构造函数中的 Installers 集合，则可以避免在这两种方法中维护集合。

我真的不明白什么可以解决这个问题。

任何帮助将不胜感激。

埃拉德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T22:26:41.903

*** 解决方案 ***

这是我找到的解决方案，确实是根据我上面显示的链接：

在 Uninstall() 方法中，我所做的与在 Install() 方法中的操作完全相同（除了订阅 AfterInstall 事件），然后调用 base.Uninstall() 方法。

该方法如下所示：

```
public override void Uninstall(System.Collections.IDictionary stateSaver)
{
    string userName = this.Context.Parameters["UserName"];
    if (userName == null)
    {
        throw new InstallException("Missing parameter 'UserName'");
    }

    string password = this.Context.Parameters["Password"];
    if (password == null)
    {
        throw new InstallException("Missing parameter 'Password'");
    }

    _process = new ServiceProcessInstaller();
    _process.Account = ServiceAccount.User;
    _process.Username = userName;
    _process.Password = password;
    _service = new ServiceInstaller();
    _service.ServiceName = _serviceName;
    _service.Description = "My service description";
    _service.StartType = ServiceStartMode.Automatic;
    Installers.Add(_process);
    Installers.Add(_service);

    base.Uninstall(stateSaver);
} 
```

当然，这两种方法的公共代码都应该包装到一个私有方法中。

现在，为了卸载服务，您应该使用用户名和密码调用 InstallUtil.exe，如下所示：

InstallUtil.exe /u /UserName=UserName /Password=UserPassword 路径...

祝你好运，

埃拉德

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T00:46:21.513

从你的链接

> 如果在派生类中重写 Install 方法，请确保在派生方法中首先调用基类的 Install 方法。

你`base.Install(...)`最后打电话了。按照文档的建议，在执行任何其他工作之前尝试调用它，看看是否可以缓解您的问题。

# ios - '-[AVPlayer superview]: 无法识别的选择器发送到实例 0x21011ad0'

> ID：15672075
> 
> 赞同：0
> 
> 时间：2013-03-28T00:23:24.277
> 
> 标签：ios, objective-c, avfoundation, avplayer, unrecognized-selector

每当我尝试播放视频时，我的应用程序总是崩溃，尽管我的 AVPlayer 实例被保留了。

```
NSURL *url = [[NSBundle mainBundle] URLForResource:@"dd4dcafeea5111e1ad6712313b030e5d" withExtension:@"mp4"];

self.videoPlayer = [AVPlayer playerWithURL:url];
[self addSubview:self.videoPlayer];
[((AVPlayer *)self.videoPlayer) play]; 
```

它被分配给这个属性：

```
@property (strong) id videoPlayer; 
```

这里发生了什么？我没有保留我应该保留的东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T00:26:07.967

`AVPlayer`不是 的子类`UIView`。您不能将模型对象添加到视图层次结构中。

# java - JFrame 随机渲染图形

> ID：15672077
> 
> 赞同：1
> 
> 时间：2013-03-28T00:23:50.667
> 
> 标签：java, swing, graphics, jframe, jpanel

我是 Java 游戏编程的新手。我遵循了一些教程并观看了一些视频。我显然做错了，因为我每加载应用程序 10 次，图形就会显示一次。

游戏概念是一本足球剧本。我的目标是教我 8 岁的孩子在存在不同情况时该领域的哪一部分。

我使用 Eclipse 作为 IDE。以下是班级和相关成员的摘要。下面表示的类用于绘制一个字段和字段上的几条线。

注意：许多逻辑已被删除以最小化这篇文章的大小。如果您需要更多信息，请告诉我。

```
 public class SoccerPlaybook {

  public static void main(String[] args) {
    new SoccerPlaybook();
  }

  public SoccerPlaybook() {
    JFrame frame = new JFrame();
    frame.add(new Game(this));
  }
}

public class Game extends JPanel {

  public Game(SoccerPlaybook soccerPlaybook) {
    this.soccerPlaybook = soccerPlaybook;
  }

  public void paintComponent(Graphics g) {      
    field.paintComponent(g);
  } 
}

public class Field extends JPanel {

  public Field(Game game) {
    this.game = game;
  }

  public void paintComponent(Graphics g) {
    g.setColor(Color.GREEN);
    g.fillRect(0, 0, game.getSoccerPlaybook().getWidth(), game.getSoccerPlaybook().getHeight());

    g.setColor(Color.WHITE);
    g.drawLine(200, 50, 400, 50);
    g.drawLine(200, 300, 400, 300);
    g.drawLine(200, 50, 200, 300);
    g.drawLine(325, 100, 400, 100);
    g.drawLine(325, 250, 400, 250);
    g.drawLine(325, 100, 325, 250);
  } 
} 
```

我尝试过使用paint和paintComponent。两者似乎具有相同的结果。

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:03:03.707

我认为你需要这样做：

```
frame.pack();
frame.setVisible(true); 
```

这将布局框架并确保它被显示。您应该在添加 Game JPanel 后立即执行此操作。

您可能还会发现需要为 Game JPanel 设置首选大小。如果是这样，请在 Game 构造函数中添加以下内容：

```
this.setPreferredSize(new Dimensions(600, 400)); 
```

# ruby - rspec / minitest中类似黄瓜的表步骤？

> ID：15672079
> 
> 赞同：1
> 
> 时间：2013-03-28T00:23:54.527
> 
> 标签：ruby, unit-testing, rspec, cucumber, minitest

我想知道是否有任何东西可以帮助我将表格测试向量输入到我的 rspec 和/或 minitest 测试中？就像您可以在 Cucumber 步骤中使用的表格一样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T03:04:37.427

由于您不使用 Cucumber，我想阅读您的代码的人将是您或同行开发人员。

在这种情况下，你可以自由地使用 Array 或 Hash 或`%w{}`标签来表示 cucumber 中的“表”，它们比开发人员眼中的“表”要干净得多。

# html - 如果页面宽度缩小，将 4 个图像水平居中并垂直堆叠？

> ID：15672085
> 
> 赞同：0
> 
> 时间：2013-03-28T00:24:27.060
> 
> 标签：html, css, centering

我目前一页有 4 张图片。我很想将它们水平居中，这样当页面缩小时，它们会继续保持居中。如果页面缩小太多，我想垂直堆叠它们。

这是一个做我想做的事情的网站：http: [//www.wpexplorer.me/premium/photojax/](http://www.wpexplorer.me/premium/photojax/)

这是我的代码：

[http://jsfiddle.net/NYcdS/](http://jsfiddle.net/NYcdS/)

## HTML

```
<div id="menu">
<img class ="blog" src="http://s18.postimg.org/il7hbk7i1/image.png">
<img class ="music" src="http://s18.postimg.org/4st2fxgqh/image.png">
<img class ="projects" src="http://s18.postimg.org/sxtrxn115/image.png">
<img class ="bio" src="http://s18.postimg.org/5xn4lb37d/image.png"> 
```

## CSS

```
#menu {
    height: 300px;
    width: 1070px;
    background: #222;
    margin: 30px auto;
}

.blog {
    height: 300px;
    width: 250px;
}

.music {
    height: 300px;
    width: 250px;
}

.projects {
    height: 300px;
    width: 250px;
}

.bio {
    height: 300px;
    width: 250px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T01:52:20.580

在我看来，你想要这样简单的东西：

```
#menu {
    text-align: center;
    margin: auto;
} 
```

[http://jsfiddle.net/5W2C2/3/](http://jsfiddle.net/5W2C2/3/)

（使图像更小一点，以便更容易地看到 jsfiddle 中发生了什么）

是这样吗？

# ruby - RSpec HaveSelector 在使用 Capybara 时无法正常工作

> ID：15672088
> 
> 赞同：4
> 
> 时间：2013-03-28T00:24:31.733
> 
> 标签：ruby, rspec, capybara

Capybara没有按照我期望的方式`HaveSelector`使用 RSpec 。`expect`我是 Capybara 和 RSpec 的新手，所以这很可能是我对 RSpec 或 Capybara 的误解，或者它可能是 Capybara（2.0.2 版）的缺陷。请帮助我理解我的错误或制作错误报告/功能请求。

在我的 RSpec 中，我写道：

```
expect { click('.special-div .submit') }.to have_css('.submitted') 
```

我希望这在功能上等同于

```
click('.special-div .submit')
page.should have_css('.submitted') 
```

但事实并非如此。相反，匹配器`have_css`尝试匹配 proc 对象的字符串转换，而不是调用 proc 对象的结果。（换句话说，`click('.special-div .submit')`永远不会被执行。）

是水豚的行为：

*   很合理
*   Capybara 中缺失功能的示例
*   Capybara 2.0.2 中的一个错误
*   还有什么？

另外，我显然可以通过使用上面的 2 行版本来做我想做的事，但是我们的团队正在尝试标准化`expect {}`，那么有没有办法使用`expect {}`表格并让它做我想做的事？

**编辑**

我继承了我正在使用的代码，所以我没有意识到，正如 Andrey Botalov 指出的那样，`click`它不是 Capybara 的标准部分。看起来应该是这样，但又`click`已经被大量用于其他事情，所以 Capybara 最好不要添加另一个定义。

由于有些人似乎持怀疑态度，因此我向您保证，这段代码运行良好：

```
click('.special-div .submit')
page.should have_css('.submitted') 
```

对于那些想知道的人来说`have_css()`，这就是 RSpec 的魔力`has_css?`。对于那些想知道的`click`人，在我的项目中，有人方便地创建了`click`如下功能：

```
 def click(css)
    page.execute_script("$('#{css}').first().trigger('click');")
  end 
```

为什么？因为没有一个明显的替代方案奏效。

```
click_on('.special-div .submit')  # Fails because click_on does not take CSS
# Cannot use click_button() because we are clicking on a <div>
find('.special-div .submit').click # Raises exception because there are more than one
first('.special-div .submit').click # Fails because the div is not visible 
```

继续前进，@zetetic 询问是否

```
expect(click('.special-div .submit')).to have_css('.submitted') 
```

会工作。不，它对我们不起作用，因为我们仍在使用 RSpec 2.9 并且该语法是在 2.11 中引入的，但即使我们升级它仍然无法工作，因为`click`它不返回对象。`click`如果我们升级到 2.11 并更改为 return ，它可能会起作用`page`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T01:51:29.627

有几个问题，`expect { click('.special-div .submit') }.to have_css('.submitted')`这就是我如此困惑的原因。

最让我困惑的是 RSpec 的`expect {...}.to ...`语法。我认为这种语法会导致匹配器运行代码`{}`并将匹配器应用于结果或类似的东西。[给定示例](http://myronmars.to/n/dev-blog/2012/06/rspecs-new-expectation-syntax)似乎是有道理的：

```
expect { something }.to raise_error(SomeError) 
```

事实证明，这通常不是真的。只有某些匹配器期望“实际”（介于 'expect' 和 '.to' 之间）是 a`Proc`然后调用它。大多数匹配器期望“实际”是一个对象。所以：

```
expect { 1 + 1 }.to eq(2) 
```

`Proc`尝试将 a与 a进行比较时引发异常`Fixnum`。

因此，Capybara 的`has_css?`匹配器完全合理地期望“实际”是响应`has_selector?`而不是响应的对象`Proc`。这确实是我的主要问题，因此，Capybara 摆脱了困境。

进一步让我感到困惑的是，Capybara 提供了一个 DSL，因此在我的示例 `has_css?`中，它等同于`page.has_css?`让我期望它`have_css(css)`会继续神奇地针对`page`.

关于编写测试的更好方法。@deviousdodo 大部分是正确的，这就是为什么我要奖励这个答案。我想要的是

```
expect {
  click('.special-div .submit') 
}.to change { page.has_css?('.submitted') }.from(false).to(true) 
```

实际上，虽然它超出了原始问题的范围，但我真正想要的是

```
expect { 
  click('.special-div .submit')
  page.should have_css('.submitted')
}.to change { Click.count }.by 1 
```

我想要这个的原因是因为我最想检查的是点击记录在数据库中（`Click.count`增量），但我必须等待点击触发的 AJAX 调用完成，这是由`has_css?`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T23:11:26.310

编辑：答案的第一部分是错误的，所以我改变了它。

我最初说这段代码

```
expect { click('.special-div .submit') }.to have_css('.submitted') 
```

相当于：

```
click('.special-div .submit').should have_css('.submitted') 
```

但这不是真的，因为传递给的 proc`expect`实际上不会被评估（您可以阅读@OldPro 的答案以获取更多详细信息）。

解决方案是`expect change`：

```
expect {
  click_button('Button label')
}.to change { page.has_css?('.submitted') }.from(false).to(true) 
```

您可以在[rspec 网站](https://www.relishapp.com/rspec/rspec-expectations/v/2-0/docs/matchers/expect-change)上找到更多详细信息。

# javascript - jQuery悬停列表

> ID：15672089
> 
> 赞同：0
> 
> 时间：2013-03-28T00:24:34.793
> 
> 标签：javascript, jquery, html

我对jquery“.hover”的功能有疑问。当鼠标悬停在#navigation 上时，什么也没有发生。我的代码html是：

```
 <ul id="navigation">
<li class="home"><a href="" title="Home"></a></li>
<li class="about"><a href="" title="O nas"></a></li>
<li class="realization"><a href="" title="Realizacje"></a></li>
<li class="devblog"><a href="" title="devBlog"></a></li>
<li class="contact"><a href="" title="Kontakt"></a></li> 
```

JavaScript：

```
<script src="js/jquery.min.js"></script>
<script type="text/javascript">

$(document).ready(function() {
  $('#navigation > li').hover(
   function () {
    $('a',$(this)).stop().animate({'marginLeft':$('.con').offset().left + $('.con').width()},200);
    alert($('#navigation li').is('.hovered'));
  },
  function () {
    $('a',$(this)).stop().animate({'margin-left':  $('.con').offset().left + $('.con').width() - 235}, 200);
    alert($('#navigation li').is('.hovered'));
  }
  );

  $('#navigation a').css('margin-left',  $('.con').offset().left + $('.con').width() - 235  + 'px');
  console.log($('.con').offset().left + $('.con').width() - 235  + 'px');

  alert($('#navigation').is('.hovered'));

});
</script> 
```

有谁知道会发生什么？

我的网站有完整的代码：http: [//jsfiddle.net/pasterz/cCTgf/](http://jsfiddle.net/pasterz/cCTgf/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T00:36:20.083

此代码工作正常：

```
function () {
        $('a', $(this)).stop().animate({
            'marginLeft': 200
        }, 200);
        alert($(this).is(':hover'));
} 
```

确保“.con”类存在

# c# - 下一个能被 X 整除的最近数

> ID：15672096
> 
> 赞同：16
> 
> 时间：2013-03-28T00:25:05.627
> 
> 标签：c#

我想要做的基本上是取用户输入的任何数字，并将其四舍五入到下一个可被 X 整除的最接近的整数，不包括 1。

即（X = 300）：

> 输入 = 1 输出 = 300
> 
> 输入 = 500 输出 = 600
> 
> 输入 = 841 输出 = 900
> 
> 输入 = 305 输出 = 300

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-03-28T00:26:39.007

只需（整数）除以 X，加一，然后乘以 X。

```
int output = ((input / x) + 1) * x; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-28T03:31:34.500

根据您的示例行为，我会执行以下操作：

```
双GetNearestWholeMultiple（双输入，双X）
    {
      var output = Math.Round(输入/X);
      if (输出 == 0 && 输入 > 0) 输出 += 1;
      输出 *= X;

      返回输出；
    }

```

# php - PHP 中的 file_get_contents 获取本地 asp 文件的渲染

> ID：15672099
> 
> 赞同：1
> 
> 时间：2013-03-28T00:25:09.210
> 
> 标签：php, asp-classic, windows-server-2003, file-get-contents

我在托管 ASP 网站的 Windows Server 2003 中有一个正在运行的服务器。我有一个 PHP 函数试图`file_get_contents`从属于该服务器的 URL 中使用。问题是 ASP URL 和 PHP 函数属于同一个服务器。我会更好地解释它：

我的网站 www.myweb.com 托管在我的服务器中。

文件 www.myweb.com/phpfile.php 需要从文件 www.myweb.com/aspfile.asp 中获取内容`file_get_contents`。如果我`phpfile.php`从外部服务器运行它可以工作，但如果我从我的服务器运行它会失败。

我很确定问题是这两个文件都属于同一个本地主机，所以当我尝试获取`aspfile.asp`内容时，它会跳过 Web 服务器并且不会获取呈现的内容。我的问题是：我该如何解决？我怎样才能准确地告诉服务器寻找呈现的内容而不是在本地主机中寻找？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T00:29:57.973

您必须从服务器获取 HTTP URL。否则，当直接访问 ASP 文件时，您将不会触发 ASP 渲染，因为您将从文件中读取实际的源代码。

需要检查您的服务器是否设置为接受与其自身的连接。通常这不是问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T02:16:48.390

我刚刚在我的开发服务器上尝试了以下内容，它似乎有效

```
<?php 
$url = 'http://localhost/mydirectory/myaspfile.asp';
$string = file_get_contents($url);
print $string
?> 
```

我的 php 和 asp 文件在同一个目录中。您是否有可能有防火墙阻止您的 php 安装进行传出连接？

如果有人感兴趣，这里是如何在 asp 中做同样的事情。

```
<% 
url = "http://localhost/mydirectory/myaspfile.asp" 
set xmlhttp = server.CreateObject("Msxml2.ServerXMLHTTP.6.0") 
xmlhttp.open "GET", url, false 
xmlhttp.send "" 
Response.write xmlhttp.responseText 
set xmlhttp = nothing 
%> 
```

# bash - 如何使用 shell 脚本将多个文件从 mp4 转换为 flv

> ID：15672101
> 
> 赞同：0
> 
> 时间：2013-03-28T00:25:12.403
> 
> 标签：bash, shell, batch-file, ffmpeg, file-conversion

假设我在目录中有一堆视频，`/home/user/videos/awaiting_conversion`我将如何使用 cron 运行与此类似的脚本以将每个视频批量转换为不同的格式？

`/bin/sh -c $'nice /usr/bin/ffmpeg -i \044'\'$'/home/user/videos/awaiting_conversion/video_file_1.mp4'\'$' -s \044'\'$'480x320'\'$' -vcodec libx264 -acodec libmp3lame -ab \044'\'$'64k'\'$' -vpre fast -crf \044'\'$'30'\'$' -ar \044'\'$'22050'\'$' -f flv -y \044'\'$'/home/user/videos/converted/video_file_1.flv'\'$''`

上面的脚本适用于单次转换，但是：

1.  它假定视频的名称是静态/已知的（批量转换时不会出现这种情况）。
2.  它假设只有一个视频要转换（可能是也可能不是），即没有“循环”。
3.  它将原始文件留在原处而不是删除它（这是我希望发生的事情以防止重复转换）。

最终的问题是如何为其中存在的每个视频运行该脚本`/home/user/videos/awaiting_conversion`，并将文件名作为变量传递？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T00:32:58.003

尝试这样做：

```
#!/bin/bash

checkFile(){
    [[ -s $1 && -f $1 ]] && return 0 || return 1
}

mp42flv(){
    for arg; do
        checkFile "$arg" || continue
        /usr/bin/ffmpeg \
            -i "$arg" \
            -s '480x320' \
            -vcodec libx264 \
            -acodec libmp3lame \
            -ab '64k' \
            -vpre fast \
            -crf '30' \
            -ar '22050' \
            -f flv \
            -y "${arg%.*}.flv" ||
                echo >&2 "Error treating $arg"
    done
}

if [[ -t 0 ]]; then
    mp42flv "$@"
else
    while IFS= read -r a; do
        checkFile "$a" || continue
        mp42flv "$a"
    done
fi 
```

## 用法

*   带着一团`./script.sh /home/user/videos/converted/video_file*.mp4`
*   带有文件名`./script.sh /home/user/videos/converted/video_file_01.mp4`
*   通过管道[查找](/questions/tagged/find "显示标记为“查找”的问题")`find /home/user/videos/converted -type f -name '*video*mp4' |./script.sh`（脚本检测使用`STDIN`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T00:49:56.207

在这种情况下，`basename`命令是你的朋友。你可以使用模式...

```
VIDEOS = /home/user/videos
for srcfile in ${VIDEOS}/awaiting_conversion/*.mp4 ; do
    dstfile=${VIDEOS}/converted/`basename ${srcfile} .mp4`.flv
    convertcommand ${srcfile} ${dstfile}
done 
```

basename 从 srcfile 中删除目录并删除后缀。然后，您只需添加新路径并附加新后缀。

自动删除旧的 srcfile 时要小心。您可能可以检查一些事情，例如 a) ffmpeg 返回码，b) dstfile 的文件大小是一定大小或更大，也许 c) 让它自动为您播放新文件，以便您可以快速查看它然后控制 - c 如果质量不正确，则退出转换或其他内容。如果您只是想防止重复转换，最好将文件移动到另一个目录，然后在确认其一切正常后将其删除。

# css - 打开谷歌地图时出现白框

> ID：15672113
> 
> 赞同：-1
> 
> 时间：2013-03-28T00:26:13.630
> 
> 标签：css, google-maps

我在页面上隐藏了一个隐藏的谷歌地图。当我单击链接打开地图时，地图会打开，但我还会看到一个奇怪的白框出现在页面上其他内容的上方。

这似乎与包含谷歌地图的表格有关。

您可以通过单击“搜索 Google 地图”来查看我在说什么。

[在这个页面上](http://dev2.whygo.com.au/searchWhiteBox.html)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T18:06:54.303

这个问题的原因是谷歌地图包含在 2 个嵌套表中。

外面的桌子有一个固定高度的图像被拉伸以在左侧创建一个假列。当包含标记的大小增加时，它要么不会导致回流，要么是其他一些问题。

我通过在内表上使用更好的仿列技术和重复 1 像素高的图像解决了这个问题。

所以这与谷歌地图无关。我被其他帖子误导了，我发现关于白框和谷歌地图。

# ruby-on-rails - CanCan + Devise：管理员用户无法获得权限，即使他应该

> ID：15672120
> 
> 赞同：1
> 
> 时间：2013-03-28T00:27:06.510
> 
> 标签：ruby-on-rails, devise, cancan

这是代码。

```
class WebsitesController < ApplicationController
  load_and_authorize_resource

  ...
end 
```

```
class ApplicationController < ActionController::Base
  ...

  check_authorization :unless => :do_not_check_authorization?

  private
    def do_not_check_authorization?
      respond_to?(:devise_controller?)
    end
end 
```

```
class Ability
  include CanCan::Ability

  def initialize(user)
    user ||= User.new
    if user.role? == "admin"
      can :manage, :all
    elsif user.role? == "developer"
      can :manage, :websites
      can :manage, :pages
      can :manage, :templates
    elsif user.role? == "editor"
      can :manage, :pages
    end
  end
end 
```

从外观上看，具有管理员角色的用户应该能够对网站控制器执行任何操作，因为`can :manage, :all`.

但是当我点击网站/索引时，我得到

```
CanCan::AccessDenied in WebsitesController#index

You are not authorized to access this page. 
```

为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T00:50:50.993

我太笨了

我`user.role?`回来了`true`，但`true == "admin"`总是假的。

# qt - 使用 Qt 编译项目后将一些文件复制到构建目录

> ID：15672130
> 
> 赞同：4
> 
> 时间：2013-03-28T00:27:49.930
> 
> 标签：qt, qt4

如此处所述完成：[https](https://stackoverflow.com/a/7810877/630169) ://stackoverflow.com/a/7810877/630169但是 make 说我：

> make: `install' 不需要做任何事情。

并且没有复制任何内容来构建目录。Pro 文件包含以下行：

```
wav_files.path = %{buildDir}
wav_files.files += %{sourceDir}/hurray.wav

INSTALLS += wav_files 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-07T12:17:54.603

这是我用于复制其他运行时文件以构建路径和安装目标的内容：

1.  在这里定义你的文件。

    ```
    ## === define copy files for installation and build ===

    copytarget.path    = /path/to/installation
    copytarget.files  += $$files(example/filename*)
    ## wildcard for filename1 filename2 filename3 ...

    message("found files for copytarget: "$$copytarget.files) 
    ```

2.  你必须添加一个 qmake 编译器：

    ```
    ## === os specific dir separator ===

    win32: copytarget.files ~= s,/,\\,g

    ## === copy compiler for makefile ===

    DirSep = /
    win32: DirSep = \\

    for(f,copytarget.files) tmp += $$PWD$$DirSep$${f} ## make absolute paths
    copycompiler.input        = tmp

    isEmpty(DESTDIR):DESTDIR=.
    copycompiler.output       = $$DESTDIR$$DirSep${QMAKE_FILE_BASE}${QMAKE_FILE_EXT}

    copycompiler.commands     = $(COPY_FILE) ${QMAKE_FILE_IN} ${QMAKE_FILE_OUT}

    copycompiler.CONFIG       = no_link no_clean
    ## other CONFIG options are: depends explicit_dependencies target_predeps

    copycompiler.variable_out = QMAKE_DISTCLEAN
    QMAKE_EXTRA_COMPILERS += copycompiler 
    ```

3.  一个单独的makefile目标：

    ```
    ## == makefile copy target ===
    copyfiles.recurse_target = compiler_copycompiler_make_all
    copyfiles.depends        = $$copyfiles.recurse_target
    copyfiles.CONFIG        += recursive 
    ```

4.  在源构建步骤之后附加目标：

    ```
    QMAKE_EXTRA_TARGETS += copyfiles
    POST_TARGETDEPS     += copyfiles ## copy files after source compilation 
    ```

5.  包括运行时文件以安装目标

    ```
    INSTALLS += copytarget 
    ```

# c - 从二进制转换为十进制

> ID：15672131
> 
> 赞同：-2
> 
> 时间：2013-03-28T00:27:55.317
> 
> 标签：c

该代码应将二进制数转换为十进制数，但事实并非如此。任何人都可以请检查我可能出错的地方。

```
#include <stdio.h>
#include <math.h>
#include <string.h>

int main()
{

    char s[40];
    int base;
    int index,n,p,sum=0;     /* n is the number of digits in the converted value */

    printf("enter the number and base: ");
    scanf("%s %d",s,&base);

    for(n=strlen(s)-1;n>=0;n--)
    {
        p=strlen(s);
        for(index=strlen(s)-(p-1); index<=p; index++)
        {
        sum += s[index] * pow(base,n);
        }
    }
    printf("decimal no. is %d",sum);
    printf("\n");

} 
```

输出：：

```
enter the number and base:1011
2 
```

十进制数 是 1487

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T00:38:00.147

您的代码有几个问题：

*   您只需要一个，而不是两个循环
*   您正在使用代表数字的字符，即`'0'`or `'1'`，而不是数字的值
*   你的数学有点偏离：应该用从后面开始的数字位置替换`pow(base,n)`。`n`

以下是修复代码的方法：

```
// Power starts at the length-1
p=strlen(s)-1;
for(index=0; index < strlen(s); index++, p-- /* <<< Power counts down */)
{
    sum += (s[index]-'0') * pow(base,p);
    //               ^^^-- Note the minus '0' above:
    //                     That's what gives you a digit's value
} 
```

这是[关于 ideone 的演示](http://ideone.com/wVwqPN)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T00:34:34.637

```
p = 1; sum = 0;
for(n=strlen(s)-1;n>=0;n--)
{
    sum += (s[n] - '0') * p;
    p = p << 1;
} 
```

我推荐上面的代码，而不是你的双倍循环。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T01:17:06.300

我的回答是：

```
#include <stdio.h>
#include <math.h>
#include <string.h> 
int main(int argc, char *argv[]){
    char s[40];
    int base;
    int index,n,p,sum=0;/*n is the number of digits in the converted value */
    printf("enter the number and base: ");
    scanf("%s %d",s,&base);

    p = strlen(s);
    index = 0;
    for(n = 40 - p - 1; n >= 0; n--)
        sum += (s[n] - '0') * pow(base, index++);
    printf("decimal no. is %d",sum);
    printf("\n");
    return 0; 
} 
```

# mysql - MySQL 使用 FK 与复合索引

> ID：15672132
> 
> 赞同：0
> 
> 时间：2013-03-28T00:27:57.657
> 
> 标签：mysql, indexing

在多对多表中，最好使用为每列创建索引的 FK，复合索引，因为无论如何都会对两个键进行查询（假设有 2 列），还是同时使用 FK 和复合索引同时？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T00:31:54.760

我会同时使用。它们服务于不同的目的。如果复合索引是指列的组合是唯一的，那么您需要它来实现引用完整性。为了完整性，您还需要两列上的外键，以便存在于多对多表中的每个值也存在于它映射的表中。这同时创建了用于连接的索引，您肯定会这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T00:49:32.690

如果您想提高速度，可以使用 NoSQL 代替 RDBMS。

但是，假设 A 和 B 是两个表，AID 是 A 的键，BID 是 B 的键。A 和 B 之间存在多对多关系，因此您创建的 AB 表具有一列用于 AID，另一个用于 BID。如果您不创建主键，那么您可能会有重复项，应该避免这种情况。所以你需要一个 AB 的主键。如果主键是 AID，那么您不能插入相同 AID 的两个不同配对。如果 AID = 1 有两对，BID = 1 和 BID = 2，那么你会成功插入 AID = 1，BID = 1，但是当你尝试插入 AID = 1，BID = 2 时，系统会抛出错误，因为 AID = 1 已经存在并且是主键。总之，您绝对需要 AB 表的二维键 (AID, BID)。

现在让我们转向外键。如果您不为引用 A.AID 的 AB.AID 创建外键，则可以从 A 表中删除一条记录，并且 AB 中仍然存在不存在的 id。因此，您需要为 AID 和 BID 创建外键。这比速度优先级更高，这是一个数据完整性保护问题。

# ruby - 在 OSX Mountain Lion 上安装新的 RVM Ruby 1.9.3 时出现“错误的 ecpoint”SSL 错误

> ID：15672133
> 
> 赞同：1
> 
> 时间：2013-03-28T00:28:00.007
> 
> 标签：ruby, rvm, osx-mountain-lion, ruby-1.9.3, rest-client

尝试使用 Ruby 1.9.3 &`rest-client`发出 https 请求，例如：

```
RestClient.get('https://google.com') 
```

总是给我一个 SSL 错误，

```
OpenSSL::SSL::SSLError: SSL_connect returned=1 errno=0 state=SSLv3 read server key exchange B: bad ecpoint 
```

我无法弄清楚。`bad ecpoint`?

我`rest-client`在另一台 Mountain Lion 机器上使用 1.9.3 & 提出同样的请求没有任何问题。

关于这台机器的注意事项： MacBook pro 安装了全新的 Mountain Lion，我最初通过 XCode 命令行工具安装 gcc-4.2 时遇到了一些问题，但最终通过[homebrew/dupes](https://github.com/Homebrew/homebrew-dupes)获得了 gcc-4.2 。从那时起，我已经卸载并重新安装了 RVM 和 1.9.3。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-30T04:21:04.297

解释我的评论...

将 RVM 更新到最新的开发版本（但`stable`也应该可以）：

```
rvm get head 
```

为 ruby​​ 安装所有必需的库（`autolibs=4`用于完全自动化）：

```
rvm --autolibs=4 --debug requirements 
```

最后重新安装红宝石：

```
rvm reinstall 1.9.3 
```

您可以使用以下命令在 RVM 中启用完整的库自动化：

```
rvm autolibs enable 
```

# sql-server - 将浮点数转换为日期时间

> ID：15672134
> 
> 赞同：2
> 
> 时间：2013-03-28T00:28:05.097
> 
> 标签：sql-server

我有一个`FLOAT`日期字段，如下所示：

```
+-----------+
| FloatDate |
+-----------+
| 1012013   | -- Jan 1
| 3262013   | -- Mar 26
| 11072013  | -- Nov 7
| 10012013  | -- Oct 1
+-----------+ 
```

我想将此数据插入另一个表，其 dateField 的数据类型为`DATETIME`.

所以，我正在尝试将 FloatDate 值转换为 DATETIME 但我一直在失败..

我试过了

```
INSERT INTO NEWTABLE 
(DateTimeDate)
SELECT CONVERT(DATETIME, CAST(CAST(FloatDate AS INTEGER) AS CHAR), 112)
FROM OLDTABLE 
```

但这给了我一个错误，上面写着

> 从字符串转换日期时间时转换失败

如果 FloatDate 的日期格式是 YYYYMMDD，它似乎可以工作。所以，如果我这样做，它会起作用。

```
DECLARE @test FLOAT
SET @test = 2132013                                                                                                                            
SELECT @test,  CONVERT(DATETIME, CAST(RIGHT(CAST(@test AS INTEGER), 4) AS CHAR(4)) + 
CASE WHEN LEN(CAST(@test AS INTEGER)) = 7 THEN '0' + CAST(LEFT(CAST(@test AS INTEGER), 3) AS CHAR(3))
     WHEN LEN(CAST(@test AS INTEGER)) = 8 THEN CAST(LEFT(CAST(@test AS INTEGER), 4) AS CHAR(4)) END, 1) 
```

但是，我想知道我是否让这太复杂而只是错过了更简单的解决方案，或者这是我能实现的唯一方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-28T00:38:09.307

假设您有其他值，例如：

```
 3092013 -- March 9th
10052013 -- October 5th
 1112013 -- January 11th
11012013 -- November 1st 
```

然后你可以这样做：

```
DECLARE @x TABLE(FloatDate FLOAT);

INSERT @x VALUES
( 3092013),-- -- March 9th
(10052013),-- -- October 5th
( 1112013),-- -- January 11th
(11012013);-- -- November 1st

;WITH s(d) AS (SELECT RIGHT('0' + CONVERT(VARCHAR(32), 
  CONVERT(INT, FloatDate)), 8) FROM @x),
d(d) AS (SELECT CONVERT(DATETIME, 
  RIGHT(d,4) + LEFT(d,2) + SUBSTRING(d,3,2)) FROM s)
SELECT d FROM d; 
```

结果：

```
d
-----------------------
2013-03-09 00:00:00.000
2013-10-05 00:00:00.000
2013-01-11 00:00:00.000
2013-11-01 00:00:00.000 
```

在您的示例中，它将是：

```
;WITH s(d) AS (SELECT RIGHT('0' + CONVERT(VARCHAR(32), 
  CONVERT(INT, FloatDate)), 8) FROM dbo.OLDTABLE),
d(d) AS (SELECT CONVERT(DATETIME, 
  RIGHT(d,4) + LEFT(d,2) + SUBSTRING(d,3,2)) FROM s)
INSERT dbo.NEWTABLE
SELECT d FROM d; 
```

当然，即使您获得了正确的*有效值*语法，您也可能在其中有一些错误的数据。由于您使用过`FLOAT`，您没有得到任何固有的验证，因此该列可能包含`-999`或`45671213`等。

你觉得这很痛苦吗？好的！*应该*很痛苦。您应该回到决定将日期存储在`FLOAT`列中并将它们踢到胫骨上的人。询问他们是否使用地理数据类型存储工资。我很高兴您正在解决此问题，但不应允许这些人靠近数据库设计。

最后，请不要这样做：

```
CAST(anything AS CHAR) 
```

始终指定长度。原因如下：

*   [要踢的坏习惯：在没有（长度）的情况下声明 VARCHAR](https://sqlblog.org/2009/10/09/bad-habits-to-kick-declaring-varchar-without-length)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-03-12T01:39:19.743

如果你有一个八位数字（浮点数），你可以这样做

```
select cast(cast(cast([invoice date] as int) as varchar(8)) as datetime) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-12-02T14:12:47.413

```
print (convert(float, CAST('1900-01-01 03:30' AS DATETIME)))--days 0,145833333333333
print (convert(float, CAST('1900-01-01 03:30' AS DATETIME))*24)--hours 3,5
print (convert(float, CAST('1900-01-01 03:30' AS DATETIME))*24*60)--minutes 210
print (convert(float, CAST('1900-01-01 03:30' AS DATETIME))*24*60*60)--seconds 12600 
```

第二种方法更干净

```
print (CAST(CAST('1900-01-01 03:30' AS DATETIME) AS FLOAT))--days 0,145833333333333
print (CAST(CAST('1900-01-01 03:30' AS DATETIME) AS FLOAT)*24)--hours 3,5
print (CAST(CAST('1900-01-01 03:30' AS DATETIME) AS FLOAT)*24*60)--minutes 210
print (CAST(CAST('1900-01-01 03:30' AS DATETIME) AS FLOAT)*24*60*60)--seconds 12600 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-02-22T18:14:35.313

为了能够将浮点日期转换为日期时间格式，您需要将浮点数据转换为 Varchar。这就是@yogesh-sharma 回答有效的原因。

# windows - 为 Perl 脚本提供用户输入的 Windows 批处理脚本

> ID：15672137
> 
> 赞同：0
> 
> 时间：2013-03-28T00:28:29.530
> 
> 标签：windows, perl, input, batch-file

我正在运行一个等待用户输入的 Perl 脚本。如何获取批处理文件来运行脚本并提供输入？

我无法修改 Perl 源代码以接受命令行参数。这是一个插图。

```
::fill.bat
perl "lazy.pl"
::Pause for 25 seconds tow wait for program to receive user input
ping -n 25 -w 1000 127.0.0.1 > nul 
@Echo off
::Want this to enter "y" when asked "Update script before using? [y]"
Echo y 
```

![在此处输入图像描述](../Images/0f22dc90b2c80a11b6e68c269c13cee5.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T00:51:44.543

尝试将您的答案传递到您的 perl 脚本的执行中。

```
echo y| perl "lazy.pl" 
```

这种方法[适用于其他地方](http://social.technet.microsoft.com/Forums/en-US/ITCG/thread/b7baef00-e0e3-41b2-8968-87352769c386/)。我敢打赌它也可能在这里工作。

* * *

对于更复杂的脚本交互，请尝试[expect](http://docs.activestate.com/activetcl/8.5/expect4win/)。 `expect`是一个基于 TCL 的脚本解释器，允许与控制台应用程序进行脚本交互。[这是一个Windows](http://docs.activestate.com/activetcl/8.5/expect4win/ex_usage.html)脚本的 Expect示例：

```
spawn perl lazy.pl
expect "Update script before using? [y]"
exp_send "y\r"
expect "Another question? [y]"
exp_send "y\r" 
```

# text - 如何在 Lua 中正确对齐文本？

> ID：15672139
> 
> 赞同：1
> 
> 时间：2013-03-28T00:28:34.747
> 
> 标签：text, sdk, lua, alignment, coronasdk

我已经尝试了几个关于如何在 Lua 中正确对齐文本的示例。到目前为止，我一直没有成功。我正在使用 Corona SDK。任何建议表示赞赏。杰瑞

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T03:23:51.787

也许这会起作用：

```
local textObj = display.newText(.....);
textObj:setReferencePoint(display.CenterRightReferencePoint);
textObj.x = 100; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-28T21:09:38.990

在具有图形 2.0 的新版本 Corona SDK 中，您需要执行以下操作：

```
rowScore.anchorX = 1 
```

用.`rowScore`创建的变量在哪里？`display.newText`这是一个完整的例子：

```
local rowScore = display.newText({
    text="My Score", 
    fontSize=40 
})
rowScore.anchorX = 1
rowScore.x = 30
rowScore.y = 100 
```

请注意，我没有使用该`align="right"`参数，因为它在 Windows 模拟器上运行，但在 Android 上不运行。

# scheme - 方案：列表中出现的次数

> ID：15672144
> 
> 赞同：1
> 
> 时间：2013-03-28T00:29:00.217
> 
> 标签：scheme, racket

我正在尝试编写一个名为“p”的方案函数，其中一个参数 X 是字母列表。如果 a 的数量比 b 的数量少 1，则该函数应返回 true。这就是我所拥有的，但无法解决参数错误。任何帮助是极大的赞赏。

```
#lang scheme

(define p
(lambda (X)
(let ((countA 0))
(let ((countB 0))
(count(countA countB X)
(if (= countA (- countB 1))
#t
#f))))))

(define count
(lambda (A B X)
(if (null? (cdr X))
(car X)
((if (string=? "a" (car X))
((+ A 1) (p(cdr X)))
((if (string=? "b" (car X))
((+ B 1) (p(cdr X)))
(p(cdr X))))))))) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T00:57:21.450

我打赌这是一个家庭作业。如果不是，这是解决它的惯用方法：

```
(define (p lst)
  (= (count-letters "a" lst)
     (- (count-letters "b" lst) 1)))

(define (count-letters letter lst)
  (count (lambda (e) (string=? e letter))
         lst)) 
```

...但是，当然，您应该手动解决它。关于您的代码的一些反馈：

*   有多个错位的括号
*   特别是，将双括号括在`if`
*   您`let`用于此问题的方式不正确，如果您更改 s 中定义的变量的值，它*可能会*`let`起作用，但我真的怀疑这是在这种情况下编写解决方案的最佳方法
*   您错误地假设传递给`count`过程的参数会在返回后以某种方式存储结果`count`- 这是不对的，它不会那样工作

从上面的代码中获取想法来编写自己的解决方案 - 首先，您需要定义一个*不*使用的`count-letters`函数，并且对于给定的字母，计算它在列表中出现的次数。有了这个过程，编写过程就很容易了（事实上，你可以直接扼杀我上面的实现！）。不要忘记测试它：*`count``p`*

 *```
(p '("a" "b" "b"))
=> #t
(p '("a" "a" "b" "b"))
=> #f 
```*

# android - Android WebView 未知铬错误：-6

> ID：15672150
> 
> 赞同：2
> 
> 时间：2013-03-28T00:29:33.360
> 
> 标签：android, android-webview

我在片段中使用 WebView 仅显示我的资产中的动画 gif。每当我通过按下按钮加载新网址时，我都会收到错误：未知铬错误：-6

这有什么具体原因吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-28T11:13:40.670

我可以说原因是找不到 URL，例如我正在使用 phonegap ，当我通过 $.get(myUrl......) 加载资源时

它给了我同样的错误，当路径正确解决时，问题就会解决。

该文件也应读取为 file:///android_asset/www/myUrl

您的代码会有所帮助

# python - 单元测试是否可以断言方法调用 sys.exit()？

> ID：15672151
> 
> 赞同：112
> 
> 时间：2013-03-28T00:29:34.270
> 
> 标签：python, unit-testing

我有一个有时调用的 Python 2.7 方法

```
sys.exit(1) 
```

是否可以进行单元测试来验证在满足正确条件时调用这行代码？

* * *

## 回答 #1

> 赞同：185
> 
> 时间：2013-03-28T00:30:49.900

是的。`sys.exit`raises `SystemExit`，所以你可以检查它[`assertRaises`](http://docs.python.org/2/library/unittest.html#unittest.TestCase.assertRaises)：

```
with self.assertRaises(SystemExit):
    your_method() 
```

的实例`SystemExit`具有设置为建议退出状态的属性`code`，并且由返回的上下文管理器`assertRaises`具有捕获的异常实例`exception`，因此检查退出状态很容易：

```
with self.assertRaises(SystemExit) as cm:
    your_method()

self.assertEqual(cm.exception.code, 1) 
```

[sys.exit 文档](http://docs.python.org/2/library/sys.html#sys.exit)：

> 退出 Python。这是通过引发`SystemExit`异常来实现的……可以在外部级别拦截退出尝试。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-03-28T01:10:54.750

这是一个完整的工作示例。尽管[Pavel 的回答非常出色](https://stackoverflow.com/questions/15672151/is-it-possible-for-a-unit-test-to-assert-that-a-method-calls-sys-exit/15672165#15672165)，但我还是花了一些时间才弄清楚这一点，所以我将其包括在此处，希望对您有所帮助。

```
import unittest
from glf.logtype.grinder.mapping_reader import MapReader

INCOMPLETE_MAPPING_FILE="test/data/incomplete.http.mapping"

class TestMapReader(unittest.TestCase):

    def test_get_tx_names_incomplete_mapping_file(self):
        map_reader = MapReader()
        with self.assertRaises(SystemExit) as cm:
            tx_names = map_reader.get_tx_names(INCOMPLETE_MAPPING_FILE)
        self.assertEqual(cm.exception.code, 1) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-12-01T22:44:01.663

[我在Python 单元测试文档](http://pyunit.sourceforge.net/pyunit.html)中搜索“Testing for Exceptions”找到了您问题的答案。使用您的示例，单元测试将如下所示：

```
self.assertRaises(SystemExit, your_function, argument 1, argument 2) 
```

请记住包含测试函数所需的所有参数。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-01-27T04:18:12.827

[作为对Pavel 出色答案](https://stackoverflow.com/questions/15672151/is-it-possible-for-a-unit-test-to-assert-that-a-method-calls-sys-exit/15672165#15672165)的附加说明，如果您正在测试的功能中提供了特定状态，您还可以检查它们。例如，如果`your_method()`包含以下内容`sys.exit("Error")`，则可以专门测试“错误”：

```
with self.assertRaises(SystemExit) as cm:
    your_method()
    self.assertEqual(cm.exception, "Error") 
```

# activemq - optimizeAcknowledge 与 DUPS_OK_ACKNOWLEDGE

> ID：15672152
> 
> 赞同：1
> 
> 时间：2013-03-28T00:29:43.157
> 
> 标签：activemq

在`optimizeAcknowledge`ActiveMQ 连接帮助页面上的选项下，它说：

“或者，您可以为消费者使用 Session.DUPS_OK_ACKNOWLEDGE 确认模式，这通常可以更快。”

我知道这两个选项都允许您分批发送确认，但是还有其他区别吗？

来源：[http ://activemq.apache.org/connection-configuration-uri.html](http://activemq.apache.org/connection-configuration-uri.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T15:23:29.560

Session.DUPS_OK_ACKNOWLEDGE 比优化确认模式稍微懒一点，但仅在与主题一起使用时才使用，否则除非启用优化确认，否则它不会产生太大影响。当与队列 Session.DUPS_OK_ACKNOWLEDGE 一起使用时，它会恢复为单个确认，因此它几乎只在您从主题中消费时才值得使用。

优化的确认模式将尝试对任何目标类型的确认进行批量处理，只要您不禁用“checkForDuplicates”选项，消息审核功能就可以防止在您使用故障转移时可能发生的重复传递。

# javascript - javascript & 表单电子邮件

> ID：15672153
> 
> 赞同：0
> 
> 时间：2013-03-28T00:29:44.053
> 
> 标签：javascript, jquery, forms

我目前有以下 javascript 用于我的表单：

```
$('#myform').on('submit', function(e){
    e.preventDefault();
    $.get($(this).attr('action') + $(this).serialize());
    alert("Thank You! \nTop Up for: <?php echo "$username" ?> Purchased Successfully");
    location.reload();
}); 
```

我现在基本上想要让它在每次将表单提交到固定电子邮件地址时发送一封电子邮件。基本上每次这个脚本运行时，它都应该发送一封电子邮件到 stephan@test.com

有任何想法吗？我不知道如何

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T01:21:56.443

如果您没有 SMTP 服务器，您可以使用 Mandrill 和 MailChimp（请参阅[此处），这些对于让您创建自己的电子邮件模板很有用。](http://mandrill.com/)如果您有 SMTP，那么您应该编写一个 PHP 功能来支持电子邮件发送。该主题有很多文章，只需使用搜索引擎即可。

# angularjs - 当路由配置（Angular）中的承诺被拒绝时，如何重定向到 404？

> ID：15672154
> 
> 赞同：3
> 
> 时间：2013-03-28T00:29:52.053
> 
> 标签：angularjs, angularjs-routing

在 Angular 中尝试加载给定 url 中的参数的资源时，当 API 以 404 响应时，将客户端重定向到错误路由的最佳方法是什么？

当有人访问例如 orders/1 时，他们会看到订单，但如果要么没有访问权限，要么找不到订单或发生任何其他异常，如何最好地处理？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-28T00:41:15.807

您可以使用这个问题中建议的拦截器：

[使用 AngularJS 的全局 Ajax 错误处理程序](https://stackoverflow.com/questions/11971213/error-401-handling-with-angularjs)

当资源请求从服务器返回时，它会首先命中拦截器。您可以检查响应的状态并根据需要做出反应。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-28T03:41:27.603

您可以使用[$routeChangeError](http://docs.angularjs.org/api/ngRoute.%24route#events_%24routechangeerror)事件

```
$scope.$on('$routeChangeError', function(arg1, arg2, arg3, arg4){
    if(arg4.status == 404) {
        $location.url('/my-error-route');
    }
}); 
```

# excel - Excel 公式从单元格区域中获取值，按字母顺序排序并写为单个字符串

> ID：15672155
> 
> 赞同：2
> 
> 时间：2013-03-28T00:29:55.803
> 
> 标签：excel, sorting, formula

我目前有一个翻译列表和他们可以说的语言：

```
 |   A   |     B      |     C      |     D      |             F             |
  +-------+------------+------------+------------+---------------------------+
1 | Name  | Language 1 | Language 2 | Language 3 | Combined                  |
  +=======+============+============+============+===========================+
2 | John  | English    | Chinese    | Spanish    | English, Chinese, Spanish |
3 | Wendy | Chinese    | French     | English    | Chinese, French, English  |
4 | Peter | Spanish    | Chinese    | English    | Spanish, Chinese, English | 
```

在 FI 列中，我使用以下公式将每个人的所有语言组合在一起：

```
=$B2&", "&$C2&", "&$D2 
```

我在数据透视表中使用此列来报告可以说相同语言组合的人。我的问题是，如果以不同的顺序输入语言（例如第 2 行和第 4 行），则报告显示为不同的组合。是否有一个公式可以用来获取三个语言单元格，按字母顺序对它们进行排序并将其写成字符串？

希望这很清楚。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T02:07:22.393

您可能希望以不同的方式处理此问题。

不要将语言名称连接在一起，您应该`vlookup`对代码（二进制）执行 a 操作，然后将它们加在一起以得出代表该组合的代码。这里的关键是，英语的位置（第一、第二或第三）并不重要。

这是一个工作示例： ![工作示例](../Images/b27e6e1955057f8357c142b4e00b6bdb.png)

在单独的工作表上，定义一个列表（并将范围命名为“语言”）。这也有利于验证语言的输入。请注意，ID 以 2^n 递增，其中 n 为 1、2、3（等）。

![语言表](../Images/980ecffe24b9753531032528ceda0fd7.png)

幕后公式。请注意，它执行`vlookup`：第一个参数来自输入表，第二个参数是查找表（上面定义的语言），第三个参数是语言表中的第二列，并且完全匹配（如果值，它将返回 n/a尚未在语言中定义）。

![幕后花絮](../Images/932d8bacd8da0b87319fdae542da44a1.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-28T00:57:21.557

不使用任何代码，您只需选择每一行，使用`Sort`，然后在选项下，选择`Left to Right`而不是默认值。您必须一次完成这一行，因此如果您有很多行，可能会很乏味，在这种情况下，基于 VBA 的解决方案会更实用。

![从左到右排序](../Images/fb6d30cc0e35e61b35834828bfb66aff.png)

对于 VBA 解决方案，应该这样做。选择包含需要排序的数据的所有单元格，然后运行下面的宏。然后，您可以使用相同的公式将它们组合成一个字符串。

```
Sub SortEachRowAlpha()

'First, select the range that needs to be sorted.
'
Dim r As Long 'row iterator:
Dim keyRange As Range

For r = 1 To Selection.Rows.Count
    Set keyRange = Range(Selection.Rows(r).Address)

    ActiveSheet.Sort.SortFields.Clear
    ActiveSheet.Sort.SortFields.Add Key:=keyRange, _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    With ActiveSheet.Sort
        .SetRange keyRange
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlLeftToRight
        .SortMethod = xlPinYin
        .Apply
    End With
Next

End Sub 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-28T02:00:45.263

花了我一段时间，但我终于想出了一个公式解决方案。

把这个放在单元格中`E2`

`=CONCATENATE(INDEX(B2:D2,1,MATCH(SMALL(COUNTIF(B2:D2,"<"&B2:D2),1),COUNTIF(B2:D2,"<"&B2:D2),0)),", ",INDEX(B2:D2,1,MATCH(SMALL(COUNTIF(B2:D2,"<"&B2:D2),2),COUNTIF(B2:D2,"<"&B2:D2),0)),", ",INDEX(B2:D2,1,MATCH(SMALL(COUNTIF(B2:D2,"<"&B2:D2),3),COUNTIF(B2:D2,"<"&B2:D2),0)))`

按输入公式`CTRL+SHIFT+ENTER`

向下拖动公式。

![在此处输入图像描述](../Images/8fa0ac4e323719ea2262b9c7cd06583e.png)

`COUNTIF()`这通过使用该函数与该函数结合使用一个数组对三列进行排序来`SMALL()`工作。`SMALL()`然后我重复 3 次，使用该函数更改我想要显示的索引。这有点难以理解，但它完成了工作:)

这里有一个链接，更详细地描述了这样的公式是如何工作的：

[http://www.get-digital-help.com/2009/03/27/sorting-text-cells-using-array-formula/](http://www.get-digital-help.com/2009/03/27/sorting-text-cells-using-array-formula/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-28T00:45:14.417

你最好的选择是使用 VBA。编写一个循环，通过逗号分隔符将每种语言提取到一个数组中，对其进行排序并将其吐回单元格

编辑：事实上，将单独的语言读入数组会更有意义。天色已晚

# php - 急切的 php newb 请求有关 wordpress 代码的建议

> ID：15672156
> 
> 赞同：2
> 
> 时间：2013-03-28T00:29:56.287
> 
> 标签：php, wordpress

## 刚开始使用 PHP 的设计师正在寻找更优雅的解决方案

我正在尝试创建一个只有在帖子有评论时才会出现在帖子旁边的 div。我可以开始工作的唯一代码如下 & 那是通过创建两个变量，我觉得比我自己更有经验的人不需要，我只是无法用代码表达我在寻找什么。这是我使用 php 的第一周，所以我一直在谷歌搜索解决方案，只能找到使用 wordpress 函数 get_comments_number(); 生成评论数量的示例；& 然后用 javascript 隐藏 0 的 div，这对于如此琐碎的事情来说似乎过于复杂。

我喜欢有一些更像底部代码的东西，尤其是它输出单数和复数注释文本的方式，但我还不够胜任。

任何示例/建议将不胜感激

```
 <?php 
          $b = 0;
          $commBox = get_comments_number();

          if($commBox <=$b) {
                echo ""; 
          }else{
                echo "<div class=\"commentbox\"> $commBox </div>"; 
        }?> 
```

* * *

```
 <?php if ( have_comments() ); ?>
     <div class="commentbox">
     <?php printf( _n( '1 comment;', '%1$s comments;', get_comments_number(), 'ves'),
     number_format_i18n( get_comments_number() ) ); ?>
     </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T00:34:46.183

您是否尝试过运行以下代码。如果帖子确实有评论，这只会创建一个 div，这意味着您不需要任何 JavaScript 来隐藏没有评论，因为它们不存在：

```
<?php 

if ( get_comments_number() > 0 ) {

echo '<div class="commentbox">';

comments_number( 'no comments', 'one comment', '% comments' );

echo '</div>';

}

?> 
```

请注意该功能的使用，该`comments_number()`功能适用​​于您想要根据单个或多个评论显示不同的值。函数参考可以在[这里](http://codex.wordpress.org/comments_number)找到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T00:41:20.833

清理顶部代码（我认为您要的是：

```
 <?php 
      $commBox = get_comments_number();
      if($commBox) {
            echo "<div class=\"commentbox\"> $commBox </div>"; 
    }
    ?> 
```

这基本上只是检查 $commBox 是否为真（在 PHP 0 中为假，非零数字为真）并删除 uneccessary `echo ""`。

您可以通过拥有一个返回 get_comments_number() 的函数来创建一个 have_comments() 函数，但我不确定这是否有必要。

编辑：类似于：

```
echo "<div class=\"commentbox\"> $commBox comment" . ($commBox == 1 ? 's' : '') . " </div>"; 
```

如果有超过 1 条评论，则应显示“评论”，如果有一条评论，则应显示“评论”（尽管这是未经测试的）。

# generics - 返回具有参数化类型的 .Net 字典。C++/CLI

> ID：15672160
> 
> 赞同：0
> 
> 时间：2013-03-28T00:30:13.723
> 
> 标签：generics, dictionary, c++-cli

我对 VS2012 IDE 有一些分歧，我最近从 C# 迁移到 C++/CLI，我可能几乎不知道，但除了这个小问题，一切都进展顺利。我非常了解参数化类型，但我似乎无法弄清楚如何返回具有参数化类型的东西。我在多个网站上查找了所有内容，发现有两种方法可以做到这一点：a`generic`和 a`template`

这就是我在 C# 中的做法：`public static Dictionary<TKey, TVal> MakeDictionary<TKey, TVal>(List<TKey> Keys, List<TVal> Values){/*code*/}`在 C++/CLI 中我尝试过：

```
generic<typename TKey, typename TVal> static Dictionary<TKey, TVal> ^MakeDictionary<TKey, TVal>(List<TKey> ^Keys, List<TVal> ^Values){/*code*/} 
```

和

```
template<typename TKey, typename TVal> static Dictionary<TKey, TVal> ^MakeDictionary<TKey, TVal>(List<TKey> ^Keys, List<TVal> ^Values){/*code*/} 
```

除其他外，编译器总是遇到相同的问题，无法识别 TKey 和 TVal。

我的问题：如何指定类型参数，我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T02:11:44.017

您未正确组合指定泛型类型参数的 C# 和 C++/CLI 语法。在 C# 中，它是通过将它们放在`<brackets>`方法名称之后来完成的。在 C++/CLI 中，它是通过将它们放在`generic<>`子句中来完成的。所以只需删除方法名称后面的那些：

```
generic<typename TKey, typename TVal> 
static Dictionary<TKey, TVal>^  MakeDictionary(List<TKey>^ Keys, List<TVal>^ Values) {} 
```

# java - 在java中打印一个平方根符号（√）

> ID：15672161
> 
> 赞同：2
> 
> 时间：2013-03-28T00:30:20.223
> 
> 标签：java, unicode, printing, square-root

我只是想知道如何在 Java 中打印平方根（√）字符？我假设你使用它的 unicode 或其他东西？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-28T00:36:21.643

简单地

```
System.out.println("Square Root: \u221A"); 
```

资料来源：[谷歌上的第一场比赛](http://www.fileformat.info/info/unicode/char/221a/index.htm)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T00:31:53.577

这是它的 unicode 编号：[http ://www.fileformat.info/info/unicode/char/221a/index.htm](http://www.fileformat.info/info/unicode/char/221a/index.htm)

这会将其打印到我的文件中：

```
package com.sandbox;

import org.apache.commons.io.FileUtils;

import java.io.File;
import java.io.IOException;
import java.text.ParseException;

public class Sandbox {

    public static void main(String[] args) throws ParseException, IOException {
        FileUtils.write(new File("out.txt"), "\u221A", "UTF8");
    }

} 
```

当我打开那个文件时，它里面有平方根符号。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T00:32:10.017

已经提出了一个与此相关的问题：

[平方根字符/符号](https://stackoverflow.com/questions/6726799/square-root-character-symbol)

查看帖子，看看这是否适合您。该网站也可能为您提供一些答案：

[http://java2everyone.blogspot.com/2009/04/square-root-symbol-in-java.html](http://java2everyone.blogspot.com/2009/04/square-root-symbol-in-java.html)

# javascript - 在我的javascript函数中，我试图从表单用户输入中获取值到我创建的函数并输出答案

> ID：15672164
> 
> 赞同：0
> 
> 时间：2013-03-28T00:30:45.073
> 
> 标签：javascript, function, input

我正在尝试将表单中的值转换为函数并返回值这是我的函数

```
function createInput(){
  var weight;
  weight = document.bmiCalc.weight.value;

  var height = getElementById('height').value;
  input.onclick = function calcBMI()
    {
    // calculate users BMI

    var BMI = weight * 703 / Math.pow(height, 2);
  return BMI;
  }
  document.getElementById("BMI").appendChild();
} 
```

这是我的html页面中的表单代码

```
 <form id="bmiCalc">
      <h2> Calculate your Current BMI</h2>
        <p><label> Please enter your weight in lbs: <input type="text" name = "weight" id=   "weight"></label></p>
        <p><label>  Please enter your height in inches: <input type="text" name ="height" id="height"></label>
          <button type="submit">Submit</button></p>
        <p><label> Your current BMI is: <input name="BMI" id="BMI"></label></p>
     </form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T00:42:28.323

更改了您的 html 和 js：

[http://jsfiddle.net/CQxnx/](http://jsfiddle.net/CQxnx/)

html:

```
<h2> Calculate your Current BMI</h2>
<label> Please enter your weight in lbs:</label> <input type="text" name="weight" id="weight">
<br />    
<label>  Please enter your height in inches:</label> <input type="text" name="height" id="height">
    <br />
    <input type="button" value="calculate" onclick="calcBMI();" />
    <br />

 <div id="msg"></div> 
```

js：

```
function calcBMI(){
    var weight = document.getElementById('weight').value;

    var height = document.getElementById('height').value;
     // calculate users BMI

    var BMI = weight * 703 / Math.pow(height, 2);
    var msg = document.getElementById('msg');
    msg.innerHTML = 'Your current BMI is:' + BMI;

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T00:43:31.397

你似乎有点偏离，但你从来没有真正调用过这个`createInput`函数。即使在那之后，您实际上也不会附加输入按钮。没有`BMI`ID 元素，并且`createInput`会在调用时计算重量/高度，而不是在单击按钮时。

相反，您应该只将按钮放在 DOM 中，然后将计算函数绑定到它。

```
document.getElementById('calculate').addEventListener('click', function () {
    document.getElementById("BMI").textContent =
        document.getElementById('weight').value * 703 /
        Math.pow(document.getElementById('height').value, 2);
}); 
```

[http://jsfiddle.net/fsKNb/](http://jsfiddle.net/fsKNb/)

# java - 获取数组的用户输入

> ID：15672171
> 
> 赞同：0
> 
> 时间：2013-03-28T00:31:27.523
> 
> 标签：java, arrays

作业链接：http: [//i.imgur.com/fc86hG9.png](http://i.imgur.com/fc86hG9.png)

我在辨别如何获取一系列数字并将它们应用于没有循环的数组时遇到了一些麻烦。不仅如此，我在比较它们时也遇到了一些麻烦。到目前为止我写的是：

```
import java.util.Scanner;

public class Lottery {

public static void main(String[] args) {
 int userInputs[] = new int[5];
 int lotteryNumbers [] = new int[5];
 int matchedNumbers =0;
 char repeatLottery = '\0';

    Scanner in = new Scanner (System.in);

    do{
        System.out.println("Enter your 5 single-digit lottery numbers.\n (Use the spacebar to separate digits): ");
            for(int i = 0; i <5; i++ )
            userInputs[i] = in.nextInt();

            System.out.println("Your inputs: ");
            printArray(userInputs);

        System.out.println("\nLottery Numbers: ");
        readIn(lotteryNumbers);
        for(int i=0; i<5; i++) {
            System.out.print(lotteryNumbers[i] + " ");
        }

        matchedNumbers = compareArr(userInputs, lotteryNumbers);

        System.out.println("\n\nYou matched " + matchedNumbers + " numbers");

        System.out.println("\nDo you wish to play again?(Enter Y or N): ");
         repeatLottery = in.next().charAt(0);
    }
    while (repeatLottery == 'Y' || repeatLottery == 'y');

}
public static void printArray(int arr[]){

    int n = arr.length;

    for (int i = 0; i < n; i++) {
        System.out.print(arr[i] + " ");
    }
}

public static void readIn(int[] List) {
    for(int j=0; j<List.length; j++) {
        List[j] = (int) (Math.random()*10);
    }
}

public static int compareArr (int[] list1, int[] list2) {
    int same = 0;
    for (int i = 0; i <= list1.length-1; i++) {
        for(int j = 0; j <= list2.length-1; j++) {
            if (list1[i] == list2[j]) {
                same++;

            }

        }
    }
    return same;
} 
```

}

您会注意到，我注释掉了输入行，因为我不太确定如何处理它。如果我将它们放在一个数组中，我认为我应该能够相当容易地比较它们。这是我们的第一个分配处理数组，我认为它似乎有点深入，因为它只有一个课时；所以，请原谅我的无知。:P

编辑：

我在最后添加了一个新方法来比较数字，但问题是它一般比较它们，而不是从一个位置到另一个位置。这似乎是现在的主要问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T00:50:13.773

你的问题不是 100% 清楚，但我会尽力而为。1-我没有看到读取用户输入的任何问题

```
int[] userInput = new int[5]; // maybe here you had a mistake
int[] lotterryArray = new int[5]; // and here you were declaring your arrays in a wrong way
Scanner scanner = new Scanner(system.in);
for ( int i = 0 ; i < 5 ; i++)
{
 userInput[i] = scanner.nextInt();
} // this will populate your array try to print it to make sure 
```

编辑：在您共享的关于分配的链接中很重要，比较需要检查值和位置，因此如果在 loterry 数组中的输入一个中有两个 5 一，它们需要在同一位置再次检查分配

```
// to compare
int result = 0 ; // this will be the number of matched digits
for ( int i = 0 ; i < 5 ; i++)
{
   if ( userInput[i] == loterryArray[i] )
       result++
}
// in this comparsion if the digits are equale in value and location result will be incremented 
```

# css - 我的页面上呈现的 HTML 与 PrimeFaces 展示页面不同

> ID：15672173
> 
> 赞同：0
> 
> 时间：2013-03-28T00:31:39.277
> 
> 标签：css, jsf, primefaces, firebug

我正在尝试使用 primefaces [Element Layout](http://www.primefaces.org/showcase/ui/layoutElement.jsf)。

我已将上述链接中提供的代码插入到我的 xhtml 页面（因此该代码现在嵌套在其他 primefaces 组件中......）。

这是我从上面的链接获得的代码：

```
<p:layout style="min-width:400px;min-height:200px;" id="layout">  
    <p:layoutUnit position="west" resizable="true" size="100" minSize="40" maxSize="200">  
        West  
    </p:layoutUnit>  

    <p:layoutUnit position="center">  
        Center  
    </p:layoutUnit>  
</p:layout> 
```

但是，布局未正确呈现。例如，它有`"visibility: hidden;"`.

我试图将上面链接中的 html 与在我的页面中创建的 html 进行比较。

这是在上述链接中创建的相关 html：

```
<div id="layout" class="ui-layout-container" style="min-width: 400px; min-height: 200px; overflow: visible; position: relative;">
    <div id="j_idt18" class="ui-layout-unit ui-widget ui-widget-content ui-corner-all ui-layout-west ui-layout-pane ui-layout-pane-west" style="position: absolute; margin: 0px; left: 0px; right: auto; top: 0px; bottom: 0px; height: 194px; z-index: 0; width: 94px; display: block; visibility: visible;">
        <div class="ui-layout-unit-content ui-widget-content" style="position: relative; height: 191px; visibility: visible;"> West </div>
    </div>
    <div id="j_idt20" class="ui-layout-unit ui-widget ui-widget-content ui-corner-all ui-layout-center ui-layout-pane ui-layout-pane-center" style="position: absolute; margin: 0px; left: 107px; right: 0px; top: 0px; bottom: 0px; height: 194px; width: 792px; z-index: 0; display: block; visibility: visible;">
        <div class="ui-layout-unit-content ui-widget-content" style="position: relative; height: 191px; visibility: visible;"> Center </div>
    </div>
    <div id="j_idt18-resizer" class="ui-layout-resizer ui-layout-resizer-west ui-layout-resizer-open ui-layout-resizer-west-open" style="position: absolute; padding: 0px; margin: 0px; font-size: 1px; text-align: left; overflow: hidden; z-index: 2; cursor: w-resize; left: 100px; height: 201px; width: 6px; top: 0px;" title="Resize" aria-disabled="false"></div>
</div> 
```

这是在我的页面中创建的 html：

```
<div id="form:tabView:tabViewExceptions:layout" style="min-width:400px;min-height:200px;">
    <div id="form:tabView:tabViewExceptions:j_idt113" class="ui-layout-unit ui-widget ui-widget-content ui-corner-all ui-layout-west">
        <div class="ui-layout-unit-content ui-widget-content"> West </div>
    </div>
    <div id="form:tabView:tabViewExceptions:j_idt115" class="ui-layout-unit ui-widget ui-widget-content ui-corner-all ui-layout-center">
        <div class="ui-layout-unit-content ui-widget-content"> Center </div>
    </div>
</div> 
```

所以这向我解释了为什么布局在我的页面上不起作用。

但是为什么相同的 JSF 代码会创建不同的 html（如果您忽略不同的 id，这是有道理的）？

为什么`div`链接中某些 s 上的样式具有在我的页面中创建的样式中没有出现的属性？

我该如何解决？

# python - 根据列的高度绘制带有 x 轴值的直方图

> ID：15672178
> 
> 赞同：2
> 
> 时间：2013-03-28T00:32:18.127
> 
> 标签：python, matplotlib, plot, histogram

所以说我有以下内容：

```
[1,5,1,1,6,3,3,4,5,5,5,2,5]

Counts: {1:3, 2:1, 3:2, 4:1, 5:5, 6:1} 
```

现在，我想打印一个在 x 轴上排序的直方图，如下所示：

传统的直方图是：

```
 X  
        X
X       X  
X   X   X
X X X X X X
1 2 3 4 5 6 
```

我想要的是：

```
 X  
        X
      X X  
    X X X
X X X X X 
2 4 3 1 5 
```

我当前的绘图代码是：

```
plt.clf()
plt.cla()
plt.xlim(0,1)
plt.axvline(x=.85, color='r',linewidth=0.1)
plt.hist(correlation,2000,(0.0,1.0))
plt.xlabel(index[thecolumn]+' histogram')
plt.ylabel('X Data')

savefig(histogramsave,format='pdf') 
```

请帮助我如何做到这一点......我知道我之前发布过类似的问题，但我相信我不清楚......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T01:33:50.537

直方图不是您要查找的图表。使用条形图。

```
import numpy as np
import matplotlib.pyplot as plt

data = [1, 5, 1, 1, 6, 3, 3, 4, 5, 5, 5, 2, 5]
correlation = [(i, data.count(i)) for i in set(data)]
correlation.sort(key=lambda x: x[1])

labels, values = zip(*correlation)

indexes = np.arange(len(correlation))
width = 1

plt.bar(indexes, values, width)
plt.xticks(indexes + width * 0.5, labels)
plt.show() 
```

![条形图](../Images/f7d47d109aa2da89f78e0bcc42ed5833.png)

**编辑：**对于大量数据，最好使用[collections.Counter](http://docs.python.org/2/library/collections.html#collections.Counter)而不是使用`count`.

* * *

这是更快地归档相同结果的方法（既没有条形图也没有历史记录）：

```
from collections import Counter
import numpy as np
import matplotlib.pyplot as plt
data = np.random.random_integers(0, 10**4, 10**5)
correlation = Counter(data).items()
correlation.sort(key=lambda x: x[1])
labels, values = zip(*correlation)
indexes = np.arange(len(correlation))

plt.plot(indexes, values)
plt.fill_between(indexes, values, 0)
plt.show() 
```

# android - 从 zip 文件中提取子文件

> ID：15672179
> 
> 赞同：0
> 
> 时间：2013-03-28T00:32:26.237
> 
> 标签：android, unzip, zipfile

我在一个 zip 文件中有许多图像文件（超过 50,000 个）。如何在不提取整个 zip 的情况下通过 zip 文件中的名称获取文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T02:19:01.027

您是否要求以编程方式或手动方式执行此操作？

如果您想以编程方式执行此操作，您可以使用[ZipInputStream](http://developer.android.com/reference/java/util/zip/ZipInputStream.html)并迭代您的文件并仅精确到您想要的文件。

请查看以下帖子以获取一些示例。

[如何在 Android 中以编程方式解压缩文件？](https://stackoverflow.com/questions/3382996/how-to-unzip-files-programmatically-in-android)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T01:06:27.847

根资源管理器允许您打开 .zip 文件而不提取它，然后只需浏览它并找到您想要单击并按住它并单击提取的图像！

# html - CSS 文本换行问题和共同主机的 HTML 设置

> ID：15672180
> 
> 赞同：0
> 
> 时间：2013-03-28T00:32:28.330
> 
> 标签：html, css, word-wrap

好的，我有这样的 HTML 设置：

```
<div class="bullet">
    <div style="float: left; padding-right: 1em;">
        <img src="images/ofn_bullet.png" alt="OFN" style="max-width: 100%; border: none;" />
    </div>
    <div style="float: left;">
        Cooperative Business Assistance Corporation<br />Camden, NJ
    </div>
    <br class="clear" />
</div> 
```

其中有很多，在此页面上列出： [http](http://opportunityfinance.net/Test/2013conf/index.html) ://opportunityfinance.net/Test/2013conf/index.html 他们一个接一个地列出，因为不幸的是我不知道该怎么做。有没有更简单的方法可以为每个联合主持人做到这一点？我已经尝试使用设置了`<ul>`标签的标签`list-type-image`，并为此设置`<li>`标签（这是我的第一次尝试），但我不知道如何在调整页面大小时调整图像大小，所以我放弃了那个尝试，并在上面进行了以下尝试。但我现在有其他问题。基本上，这两个`div`标签都有一个`float: left`应该可以工作的样式，但是如果你看下面的图片......在缩小它的大小时不能正常工作：

![文本换行到下一行而不是停留在图像的右侧](../Images/2a7730d999e8a2d3f06268a07fc05aca.png)

老实说，我不知道该怎么做，也不想使用桌子。但如果可能的话，我确实需要对齐它旁边的文本，使其位于图像的中间。如果可能的话，就像 2 行应该在`vertically aligned`中一样`middle` `vertical-align: middle`。在任何情况下，我都需要文本始终保持在图像的右侧，即使浏览器缩小了！这是正在使用的CSS：

```
.clear
{
    clear: both;
}

div.bullet
{
    display: block;
    width: 100%;
    text-align: left;
} 
```

我想知道 Co-Hosts 列是否有比我使用的更好的设置解决方案。请记住，页面需要缩小（文本和所有）以适应更小的屏幕分辨率和手机。也不能有水平滚动条。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T00:36:18.263

尝试删除`float: left;`（`.bullet`文本 div）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T00:50:16.543

您可以将 cohosts 作为无序列表。然后，您可以将图像设置为每个列表项的背景图像。

```
<ul class='cohosts'>
    <li>The text</li>
    <li>The text</li>
</ul> 
```

然后将css设置为这样的东西

```
.cohosts li {
    padding-left: 20px; /* Whatever the with of the image */
    background-image: url('images/ofn_bullet.png');
} 
```

# mysql - 查找重复的电话号码（即使格式不同）

> ID：15672181
> 
> 赞同：2
> 
> 时间：2013-03-28T00:32:28.360
> 
> 标签：mysql, sql

我正在使用以下查询从表中选择重复的电话号码。

```
SELECT id, REPLACE( REPLACE( REPLACE( REPLACE( REPLACE( phone, "+", '' ) , ")", '' ) , "(", '' ) , "-", '' ) , ' ', '' ) AS strippedPhone
FROM `customers`
GROUP BY strippedPhone
HAVING count( strippedPhone ) >1
LIMIT 0 , 300 
```

它看起来很难看，并且没有考虑到电话号码字段中字母数字字符的可能性。

还有更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T00:49:02.993

在我看来，您将在将电话号码存储到数据库之前对其进行规范化。无论格式如何，任何能够比较电话号码的 sql 查询都将非常低效。如果您在将电话号码插入数据库之前重新格式化电话号码，检查重复号码是微不足道的。

如果要在现有数据库上执行此操作，则必须首先对数据库中的数据进行规范化，但这只需执行一次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T00:38:27.057

这个 StackOverflow post [MySQL strip non-numeric characters to compare](https://stackoverflow.com/questions/287105/mysql-strip-non-numeric-characters-to-compare)有一个使用 NumericOnly 函数的解决方案。

[http://venerableagents.wordpress.com/2011/01/29/mysql-numeric-functions/](http://venerableagents.wordpress.com/2011/01/29/mysql-numeric-functions/)

# json - WCF 中具有接口类型参数的通用返回类型

> ID：15672183
> 
> 赞同：9
> 
> 时间：2013-03-28T00:32:49.780
> 
> 标签：json, wcf, generics, serialization, interface

如何从`OperationContracts`我的 WCF REST 服务中返回泛型类型参数中的接口类型？更具体地说，它适用于一个操作，但当我使用`T`作为接口的泛型添加第二个操作时不起作用。

我使用 JSON 作为请求和响应格式，提供一个非 WCF 客户端来解析它需要的数据的 JSON 响应。我没有使用 SOAP，也没有使用服务生成的 WSDL。

我的服务接口：

```
[ServiceContract]
[ServiceKnownType("GetServiceKnownTypes", typeof(ServiceKnownTypesHelper))]
public interface IMyService
{
    [WebGet(UriTemplate="count")]
    [OperationContract]
    IServiceResult<int> GetCount();

    [WebGet(UriTemplate="desc")]
    [OperationContract]
    IServiceResult<string> GetDescription();

    [WebGet(UriTemplate="foo")]
    [OperationContract]
    IServiceResult<IFooData> GetFooData();

    // Fails when I invoke either method if I uncomment this operation.
    //[WebGet(UriTemplate="bar")]
    //[OperationContract]
    //IServiceResult<IBarData> GetBarData();
} 
```

我离开`GetCount()`并`GetDescription()`在示例中指出这两个通用结果工作正常，但显然它们是具体类型。甚至在我添加接口在哪里`GetFooData()`的第二种方法之前都可以正常工作。`IServiceResult<T>``T`

`GetFooData()`和的返回类型不同`GetBarData()`，实现它们的具体类也不相同。

你可能会想象我已经将实现简化为一个框架，因为我不认为实现是问题的核心：

```
#region My service implementation
public class MyService : IMyService
{
    public IServiceResult<int> GetCount()
    {
        return new ServiceResult<int>(42);
    }
    public IServiceResult<string> GetDescription()
    {
        return new ServiceResult<string>("Muffins");
    }
    public IServiceResult<IFooData> GetFooData()
    {
        return new ServiceResult<IFooData>(new FooData() { Foo = 99 });
    }
    public IServiceResult<IBarData> GetBarData()
    {
        return new ServiceResult<IBarData>(new BarData() { Bar = "Elvis was here" });
    }
}
#endregion

#region ServiceKnownTypesHelper.GetServiceKnownTypes():
public static class ServiceKnownTypesHelper
{
    private static IList<Type> serviceKnownTypes = new List<Type>()
        {
            typeof(FooData),
            typeof(BarData),
            typeof(ServiceResult<int>),
            typeof(ServiceResult<string>),
            typeof(ServiceResult<IFooData>),
            typeof(ServiceResult<IBarData>),
        };

    public static IEnumerable<Type> GetServiceKnownTypes(ICustomAttributeProvider paramIgnored)
    {
        return serviceKnownTypes;
    }
}
#endregion

#region IServiceResult<T> and its concrete implementation:
public interface IServiceResult<T>
{
    IList<string> Errors { get; }
    T Value { get; set; }
}

[DataContract]
public class ServiceResult<T> : IServiceResult<T>
{
    public ServiceResult(T value)
    {
        this.Value = value;
    }

    private IList<string> errors = new List<string>();

    [DataMember]
    public IList<string> Errors
    {
        get
        {
            return this.errors;
        }
    }

    [DataMember]
    public T Value { get; set; }
}
#endregion

#region IFooData and its concrete implementation:
public interface IFooData
{
    int Foo { get; set; }
}

[DataContract]
public class FooData: IFooData
{
    [DataMember]
    public int Foo { get; set; }
}
#endregion

#region IBarData and its concrete implementation:
public interface IBarData
{
    string Bar { get; set; }
}

[DataContract]
public class BarData: IBarData
{
    [DataMember]
    public string Bar { get; set; }
}
#endregion 
```

当我`GetBarData()`从浏览器调用时出现错误消息：

```
类型“ServiceResult`1[IBarData]”无法添加到已知类型列表，因为
具有相同数据合约名称的另一种类型 'ServiceResult`1[IFooData]'
'http://schemas.datacontract.org/2004/07/ServiceResultOfanyType' 是
已经存在。

```

错误消息的其余部分是关于碰撞集合类型`List<Test>`和的红鲱鱼`Test[]`，这里不是这种情况。

显然，`IFooData`它们`IBarData`不一样，实现它们的类也不一样。

那么为什么要`ServiceResult<IFooData>`和`ServiceResult<IBarData>`两者都解决`ServiceResultOfanyType`呢？

我错过了什么，还是没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-02T22:13:00.640

经过多次试验和错误，我终于得到了这个工作与最小的变化：

*   我的服务操作现在返回`ServiceResult<T>`而不是`IServiceResult<T>`. 事实上，`IServiceResult<T>`现在已经完全没有了。
*   `GetServiceKnownTypes()`不再返回 的所有变体`ServiceResult<T>`。我只返回`DataContract`用作 s 的 s `T`。

    ```
    #region My service interface
    [ServiceContract]
    [ServiceKnownType("GetServiceKnownTypes", typeof(ServiceKnownTypesHelper))]
    public interface IMyService
    {
        [WebGet(UriTemplate="count")]
        [OperationContract]
        ServiceResult<int> GetCount();

        [WebGet(UriTemplate="desc")]
        [OperationContract]
        ServiceResult<string> GetDescription();

        [WebGet(UriTemplate="foo")]
        [OperationContract]
        ServiceResult<IFooData> GetFooData();

        [WebGet(UriTemplate="bar")]
        [OperationContract]
        ServiceResult<IBarData> GetBarData();
    }
    #endregion
    #region My service implementation (minus bodies)
    public class MyService : IMyService
    {
        public ServiceResult<int> GetCount() {}
        public ServiceResult<string> GetDescription() {}
        public ServiceResult<IFooData> GetFooData() {}
        public ServiceResult<IBarData> GetBarData() {}
    }
    #endregion
    #region ServiceKnownTypes
    // My list of ServiceKnownTypes is now much shorter and simpler. I was feeding the service too much information
    public static class ServiceKnownTypesHelper
    {
        private static IList<Type> serviceKnownTypes = new List<Type>()
            {
                typeof(FooData),
                typeof(BarData),
                //typeof(ServiceResult<int>),
                //typeof(ServiceResult<string>),
                //typeof(ServiceResult<IFooData>),
                //typeof(ServiceResult<IBarData>),
            };

        // Remaining implementation is the same as before
    }
    #endregion
    #region ServiceResult<T> with no interface (it's not used or needed)
    [DataContract]
    public class ServiceResult<T> //: IServiceResult<T>
    {
        // implementation is the same as before
    }
    #endregion 
    ```

我现在可以调用所有这些方法，并在`ServiceContract`.

# iphone - iOS 应用程序没有使用 nib，无法启动

> ID：15672189
> 
> 赞同：1
> 
> 时间：2013-03-28T00:33:23.223
> 
> 标签：iphone, ios, objective-c, memory-management, viewcontroller

我越来越看到在代码中创建所有视图的好处，并希望完全切换到这种开发风格。正如标题所示，我遇到了一些小问题。像往常一样，我确信这是我几乎没有忽略的东西。看看我的代码，你能提供一个建议吗？ARC 已启用。

发生的情况是，`-(id)init;`当我在应用程序委托中检查该方法时该方法返回 nil，我似乎无法弄清楚为什么......该`self = [super init];`调用似乎总是有效，但在这种情况下不是。

**主.m**：

```
int main(int argc, char *argv[])
{
    @autoreleasepool {
        return UIApplicationMain(argc, argv, nil, NSStringFromClass([BCAppDelegate class]));
    }
} 
```

在**BCAppDelegate.m**中：

```
@implementation BCAppDelegate

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    self.window.backgroundColor = [UIColor whiteColor];

    BCViewController *bcv = [[BCViewController alloc] init];

    if (bcv == nil) { printf("it's nil\n"); }

    UIView *view = [[UIView alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    [view setBackgroundColor:[UIColor blueColor]];
    [bcv setView:view];

    [self.window setRootViewController:bcv];
    [self.window makeKeyAndVisible];
    return YES;
} 
```

**BCViewController.h**：

```
@interface BCViewController : UIViewController <UIImagePickerControllerDelegate>
{
    /*some IVARS*/
}

-(id)init;

@end 
```

在**BCViewController.m**中：

```
@implementation BCViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

-(id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil { return nil; }

-(id)init
{
    self = [super init];
    if (!self) {
        return nil;
    }
    return self;
}

- (void)loadView
{
    /* No Code yet */
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T00:38:11.920

> ```
> -(id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil { 
>      return nil; 
> } 
> ```

不要那样做。这是 UIViewController 的指定初始化器。你破坏了这个类的功能。返回调用的结果`super`（可能带有一些额外的初始化）或者根本不实现这个方法。

要完全在代码中生成视图控制器的视图，请实现`loadView`. 就这样。同样，不要以你正在做的方式实现它！如果你`loadView`完全实现，你*必须*创建一个 UIView 并设置`self.view`它。

阅读，阅读，阅读文档！它告诉你你的责任是什么。阅读并服从。使用并为框架工作，不要攻击或颠覆框架。

这是我书中的一部分，展示了如何使用视图控制器而不是 nib 来启动应用程序：

[http://www.aeth.com/iOSBook/ch19.html#_manual_view](http://www.apeth.com/iOSBook/ch19.html#_manual_view)

# asp.net-mvc-3 - 将带有编辑器的图像上传到 MVC

> ID：15672190
> 
> 赞同：1
> 
> 时间：2013-03-28T00:33:28.727
> 
> 标签：asp.net-mvc-3, http-post, image-uploading, redactor

这在这里可能有点太具体了，我可能需要联系编辑器支持，但我在这里看到了关于编辑器的其他问题，所以我想我会试一试......

行 ...

因此，我正在尝试按照此处的示例使图像上传正常工作...

[http://imperavi.com/redactor/docs/images/](http://imperavi.com/redactor/docs/images/)

我的客户端代码...

```
 $("textarea").redactor({
            focus: true,
            imageUpload: '/MyController/UploadImage'
        }); 
```

我的 MVC 控制器动作看起来像这样......

```
 public JsonResult UploadImage(object image)
    {
        // Do something with whatever that was i got from redactor
        var result = new { filelink = "" };
        return Json(result);
    } 
```

问题是……编辑器实际上给了我什么？是整个文件吗？一大块？我似乎无法分辨，因为该对象根本没有类型信息，而且原始帖子信息似乎太少而不能真正成为整个图像文件。

有没有人有过这方面的经验/实际上之前做过？我真的不想在我的服务器上为这个 1 功能设置 php。

编辑：好的多一点挖掘表明，如果我拉出底层的 Request 对象，它有一个 files 属性，显然包含我发布的图像文件。我想我也许可以从这里弄清楚。

在我得到一个代码块的地方，我会把它作为答案发布。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T20:30:37.853

您正在接收一个 HttpPostedFileBase 对象。这是我的实现：

jQuery：

```
$('#blog-post').redactor(
    {
    imageUpload: '/blog/images/',
    imageGetJson: '/images/locations/blogs/'
}); 
```

然后在控制器中：

```
 public ActionResult Images(HttpPostedFileBase file)
    {
        // Verify that the user selected a file
        if( file != null && file.ContentLength > 0 )
        {
            // extract only the fielname
            var fileName = Path.GetFileName( file.FileName );
            // store the file
            var path = Path.Combine( ImageLocation.BlogPicturePath, fileName );

            file.SaveAs( path );
        }
        return Json( new { filelink = ImageLocation.BlogPictureUrl + "/" + file.FileName } );
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T01:43:21.003

好的，嗯......我想我在那里......这需要一些清理，我不希望你们理解我的自定义 DMS 代码引擎盖下发生的事情，但假设它接受流并返回一个FileInfo 对象，理论上这也应该对你有用......

```
 public ActionResult Upload()
        {
            // this object is specific to my system but all it does is 
            // stream the file to a path on the server (code not needed for this Q)
            var dmsService = _kernel.Get<IDMSFileSystemService>();

            List<FileInfo> savedFiles = new List<FileInfo>();

            for (int i = 0; i < Request.Files.Count; i++)
            {
                var file = Request.Files[i];
                using (file.InputStream)
                {
                    savedFiles.Add(dmsService.AddFromStream(file.InputStream, file.FileName);
                }
            }
            var result = savedFiles.Select(f => new { filelink = f.Path}).ToArray();
            return Json(result);
        } 
```

出人意料地简单对... :)

# qt - 大量项目的 QGraphicsView 框架性能问题

> ID：15672192
> 
> 赞同：1
> 
> 时间：2013-03-28T00:33:32.723
> 
> 标签：qt, qt5

我在 Windows 中使用 qt 5.0.1。我正在创建 200k+ 自定义 QGraphicsItem。我在这些自定义项中添加了基本功能，例如鼠标悬停、鼠标单击等。这些项是静态的。但在这些项目之上，我添加了一些动画项目（最多 200 个）（不同的属性动画、比例、不透明度等）。当我在场景中添加这些项目时，它变得非常慢，在一个相对强大的工作站中。

```
QGraphicsScene *scene = new QGraphicsScene();
scene->setSceneRect(0, 0, width, height);
scene->setBackgroundBrush(Qt::darkGray);
scene->setItemIndexMethod(QGraphicsScene::NoIndex);

QGraphicsView *view = new QGraphicsView( scene );
view->setRenderHint(QPainter::Antialiasing, false);
view->setResizeAnchor(QGraphicsView::AnchorViewCenter);
view->setVerticalScrollBarPolicy(Qt::ScrollBarAlwaysOff);
view->resize( width, height );
view->setOptimizationFlags(QGraphicsView::DontSavePainterState);
view->setViewportUpdateMode( QGraphicsView::SmartViewportUpdate);
view->setTransformationAnchor(QGraphicsView::AnchorUnderMouse);
view->setCacheMode(QGraphicsView::CacheBackground);
view->setViewportUpdateMode( QGraphicsView::FullViewportUpdate);
view->show(); 
```

我尝试了以下方法，但它使渲染视图非常糟糕，因为它似乎启用了抗锯齿，但我需要一些像素标签精度。

```
view->setViewport(new QGLWidget( QGLFormat(QGL::SampleBuffers))); 
```

我错过了一些重要的 Qt 编程技巧吗？请建议。我可以发布代码，或者如果以防万一请告诉我更多解释。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T12:10:14.547

当你有很多项目时，瓶颈是当你同时在屏幕上有很多项目时，这意味着它们相当小。在这种情况下，建议使用不同的 LOD - 这是细节级别。当项目较小时，画出它的简化版本。将其与 LOD 烘焙和缓存以及用于绘制的 OpenGL 小部件相结合，您一次可以轻松获得数万甚至数十万个项目。

# java - Java：单击 JButton 时图形消失

> ID：15672194
> 
> 赞同：1
> 
> 时间：2013-03-28T00:34:15.267
> 
> 标签：java, arrays, swing, graphics, jpanel

对于我的算法类，我们必须使用合并排序对数组进行排序，并在每一步将数组绘制为直方图，以图形方式查看发生了什么。我在使用paintComponent 方法更新数组时遇到了问题。当我第一次运行该程序时，它会显示混乱的数组（应该如此），然后当我单击合并排序按钮时，我希望看到排序后的数组，但我什么也没得到。任何帮助将不胜感激，谢谢。

注意：我知道我现在没有使用合并排序，我只是想让图形首先工作。

```
package a2;

import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Graphics;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.Arrays;

import javax.swing.JButton; 
import javax.swing.JFrame;
import javax.swing.JOptionPane;
import javax.swing.JPanel;

public class GraphicalSort extends JFrame implements ActionListener {
    static int[] data = new int[200];
    JPanel panel = new JPanel(); //Panel to hold graphical display of array
    JPanel buttonsPanel = new JPanel();
    JButton mButton = new JButton("Mergesort");

    int xPos = 0;
    static int barWidth = 8;
    static int barHeight = 1;

    public GraphicalSort() { 
        setLayout(new BorderLayout());
        mButton.addActionListener(this);
        buttonsPanel.add(mButton);
        for (int i = 0; i < data.length; i++) {
            data[i] = (int) (500 * Math.random() + 1);
        }
        setSize(barWidth * data.length, barHeight * 500 + buttonsPanel.getHeight());
        panel = new ArrayPanel();
        add(buttonsPanel, BorderLayout.NORTH);
        add(panel, BorderLayout.CENTER);
        repaint();
        validate();
    }

    public static void main(String[] args) {
        GraphicalSort gs = new GraphicalSort();
        gs.setTitle("Graphical Sort");
        gs.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        gs.setLocationRelativeTo(null);
        gs.setResizable(false);
        gs.setVisible(true);
    }

    @SuppressWarnings("serial")
    class ArrayPanel extends JPanel {
        public void paintComponent(Graphics g) {
            super.paintComponent(g);
            g.setColor(Color.BLACK);
            for (int i = 0; i < data.length; i++) {
                g.fillRect(xPos, (barHeight * 500) - (barHeight * data[i]), barWidth, barHeight * data[i]);
                xPos += barWidth;
            }   
        }
    }

    @Override
    public void actionPerformed(ActionEvent e) {
        remove(panel);
        if (e.getSource() == mButton) {
            Arrays.sort(data);
            panel = new ArrayPanel();
    }
        add(panel, BorderLayout.CENTER);
        repaint();
        validate();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T00:46:45.597

您需要重置`xPos`变量，否则 x 坐标将出现在屏幕外：

```
int xPos = 0; 
```

*另外：*创建一个新`ArrayPanel`的是不必要的——只需重置变量并调用 repaint 将通过创建`xPos`一个类成员变量来工作`ArrayPanel`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-28T00:48:47.173

您没有重置 xPos 实例变量，它实际上不应该是实例变量，因为您只需要在paintComponent 中使用它。所以摆脱它并将其移至 paintComponent() 方法。

您也不需要删除并重新添加面板。所以这就是我所做的（注意删除了静态变量！那些应该是实例变量）：

```
int[] data = new int[200];
JPanel panel;
JPanel buttonsPanel = new JPanel();
JButton mButton = new JButton("Mergesort");

int barWidth = 8;
int barHeight = 1;

class ArrayPanel extends JPanel {
    public void paintComponent(Graphics g) {
        super.paintComponent(g);
        g.setColor(Color.BLACK);
        int xPos = 0;
        for (int i = 0; i < data.length; i++) {
            System.out.println("Drawing " + i);
            g.fillRect(xPos, (barHeight * 500) - (barHeight * data[i]), barWidth, barHeight * data[i]);
            xPos += barWidth;
        }   
    }
}

public void actionPerformed(ActionEvent e) {
    Arrays.sort(data);
    panel.repaint();
} 
```

# java - 如何对文件和目录列表进行排序，以便首先列出目录

> ID：15672195
> 
> 赞同：1
> 
> 时间：2013-03-28T00:34:23.947
> 
> 标签：java, android, file

我有一个文件和目录列表，但列表中没有组织。我想用首先按字母顺序列出的目录对它们进行排序，然后是文件。我怎样才能做到这一点？

```
private void fill(File[] files) {
        this.directoryEntries.clear();

        // and the ".." == 'Up one level'
        if(this.currentDirectory.getParent() != null && !this.currentDirectory.equals("/sd card"))
                this.directoryEntries.add(new IconifiedText(
                                getString(R.string.up_one_level),
                                getResources().getDrawable(R.drawable.uponelevel)));

        Drawable currentIcon = null;
        for (File current_File : files){
                if (current_File.isDirectory()) {
                        currentIcon = getResources().getDrawable(R.drawable.folder);
                }else{
                        String fileName = current_File.getName();
                        /* Determine the Icon to be used,
                         * depending on the FileEndings defined in:
                         * res/values/fileendings.xml. */
                        if(checkEndsWithInStringArray(fileName, getResources().
                                getStringArray(R.array.fileEndingJs))){
                                currentIcon = getResources().getDrawable(R.drawable.mimejs);
                        }else if(checkEndsWithInStringArray(fileName, getResources().
                                getStringArray(R.array.fileEndingHTML))){
                                currentIcon = getResources().getDrawable(R.drawable.mimehtml);
                        }else if(checkEndsWithInStringArray(fileName, getResources().
                                getStringArray(R.array.fileEndingCSS))){
                                currentIcon = getResources().getDrawable(R.drawable.mimecss);
                        }else if(checkEndsWithInStringArray(fileName, getResources().
                                getStringArray(R.array.fileEndingXML))){
                                currentIcon = getResources().getDrawable(R.drawable.mimexml);
                        }else if(checkEndsWithInStringArray(fileName, getResources().
                                getStringArray(R.array.fileEndingPhp))){
                            currentIcon = getResources().getDrawable(R.drawable.mimephp);
                    }else{
                            currentIcon = getResources().getDrawable(R.drawable.mimetxt);
                        }                              
                }
                switch (this.displayMode) {
                        case ABSOLUTE:
                                /* On absolute Mode, we show the full path */
                                this.directoryEntries.add(new IconifiedText(current_File
                                                .getPath(), currentIcon));
                                break;
                        case RELATIVE:
                                /* On relative Mode, we have to cut the
                                 * current-path at the beginning */
                                int currentPathStringLenght = this.currentDirectory.getAbsolutePath().length();
                                this.directoryEntries.add(new IconifiedText(
                                                current_File.getAbsolutePath().
                                                substring(currentPathStringLenght),
                                                currentIcon));

                                break;
                }
        }
        Collections.sort(this.directoryEntries);

        itla.setListItems(this.directoryEntries);              
        this.setListAdapter(itla);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T06:43:41.413

编写一个按以下方式排序的[比较器](http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html)`isDirectory()`

```
class FileTypeComparator implements Comparator<File> {

    @Override
    public int compare(File file1, File file2) {

        if (file1.isDirectory() && file2.isFile())
            return -1;
        if (file1.isDirectory() && file2.isDirectory()) {
            return 0;
        }
        if (file1.isFile() && file2.isFile()) {
            return 0;
        }
        return 1;
    }
} 
```

另一个按`getName()`

```
class FileNameComparator implements Comparator<File> {

    @Override
    public int compare(File file1, File file2) {

        return String.CASE_INSENSITIVE_ORDER.compare(file1.getName(),
                file2.getName());
    }
} 
```

然后使用 Guavas [Ordering.compound(Comparator compare2)](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Ordering.html#compound%28java.util.Comparator%29)将两者结合起来`Comparators`

```
Collections.sort(files,Ordering.from(new FileTypeComparator()).compound(new FileNameComparator())); 
```

# linux - “less”命令如何获得标准输入？

> ID：15672201
> 
> 赞同：4
> 
> 时间：2013-03-28T00:34:53.347
> 
> 标签：linux, bash, shell, pipe, less-unix

我只是想知道这个问题：如果我可以使用“ls -al | less”之类的东西，那么less 应该能够等待来自标准输入的输入。我期望发生的是在运行“less”命令后，程序挂起并等待输入（由于调用 gets() 或类似的东西。）

但为什么实际上它显示错误消息“缺少文件名（“less --help”寻求帮助）”结束退出？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T00:40:45.383

`less`命令可以同时检查两者`argc>1`并`stdin`与文件（不是 tty）相关联。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T00:40:15.863

less 命令不是在这个问题上设计的。当您在 bash 中执行命令时，它将一次显示所有信息。less 命令用于一次一屏显示命令的 STDOUT 或文件的内容。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-28T00:56:14.600

```
$ ls -al | less
total 16
drwxrwxr-x  4 hdante hdante 4096 Nov 24 17:11 .
drwxr-xr-x 88 hdante hdante 4096 Mar 24 22:14 ..
drwxrwxr-x  2 hdante hdante 4096 Nov 25 01:55 new
drwxrwxr-x  3 hdante hdante 4096 Nov 24 18:27 old
(END) 
```

有用。你的少有问题。从更少的手册页：

[http://www.linuxmanpages.com/man1/less.1.php](http://www.linuxmanpages.com/man1/less.1.php) [https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man1/less.1.html](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man1/less.1.html)

该手册将文件名描述为可选。

诊断问题的提示：

*   尝试别名 | grep less，查看命令是否被修改
*   尝试设置 | grep LESS，并检查LESSCLOSE 和LESSOPEN 正在运行的脚本

# c++ - 将基类数据从一个派生类复制到另一个

> ID：15672207
> 
> 赞同：2
> 
> 时间：2013-03-28T00:35:08.510
> 
> 标签：c++, inheritance, casting

假设我有三个类：

```
typedef struct base
{
    float A;
    float B;
    ...
    base() : A(1.0f), B(1.0f) {}
} base;

class derived1 : base
{
    int C;
    int D;
};

class derived2 : base
{
    int E;
    int F;
}; 
```

我想将基类数据从一个派生类对象复制到另一个。
执行以下操作是否安全，仅将 A、B 等的基类值从一个对象复制到另一个对象？

```
derived1* object1 = new derived1;
derived2* object2 = new derived2;

void make_object1()
{
    object1->C = 2;
    object1->D = 3;
}

void make_object2()
}
    object2->A = 4;
    object2->B = 5;
    object2->E = 6;
    object2->F = 7;
}

void transfer_base()
{
    *((base*)object1) = *((base*)object2);
} 
```

假设我的程序经常需要执行此类操作，是否有更好（更快的代码）方法来完成此操作？我这样做的原因是我编写了一个模拟和一个图形渲染器。我想尽可能有效地仅使用从模拟对象中选择的数据来更新图形显示对象。模拟是 CPU 密集型的......到目前为止，这种方法似乎正在奏效，但我担心我可能忽略了一些东西......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T00:39:23.967

编码

```
*((base*)object1) = *((base*)object2); 
```

非常不安全，因为 C 风格的强制转换几乎可以做任何事情。比如重新解释，或者抛弃constness。

相反，如果您想调用`base::operator=`，则*显式*调用它。显式 = 好，隐式 = 坏。

IE，

```
object1->base::operator=( *object2 ); 
```

这仍然不是“安全的”，因为切片可能会破坏派生类的类不变量。任何试图了解这段代码中发生的事情的人都可能会对基类子对象中值的突然变化感到惊讶，并浪费大量时间试图确定这些值的来源。但至少它没有 C 风格的铸造那么糟糕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T00:48:44.547

相反，为什么不在基类中创建自己的赋值方法（删除不需要的 C 工件类型定义）：

```
struct base
{
    float A;
    float B;
    ...
    base() : A(1.0f), B(1.0f) {}
    base& assign_base(const base& right) { A = right.A; B = right.B; }
}; 
```

然后你可以说

```
der1.assign_base(der2); 
```

# javascript - NetSuite - 将上下文设置为“已计划”后，销售订单中未设置字段

> ID：15672211
> 
> 赞同：0
> 
> 时间：2013-03-28T00:35:37.797
> 
> 标签：javascript, netsuite

希望您能提供帮助。我目前正在尝试通过用户事件脚本执行最简单的任务之一——即在销售订单的“折扣率”字段中设置一个新值。我的脚本在客户端测试时工作正常，但是当触发预定脚本时，该字段无法设置/更新。

以下代码位于“提交前”操作中。你能看出我做错了什么吗？

```
function beforeSubmit_discountVAT(type){

if(nlapiGetContext().getExecutionContext() !='scheduled')
    return;

  var getDiscountVal = nlapiGetFieldValue('discountrate');
  var correctDiscount = getDiscountVal / 1.2;
  nlapiSetFieldValue('discountrate', correctDiscount);
} 
```

简而言之 - 我要做的就是将折扣值减去 20%。当从预定脚本触发用户事件脚本时，您可以使用“nlapiSetFieldValue”吗？

提前致谢。

运单

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-16T01:01:00.803

编辑现有记录时，`nlapiSetFieldValue`不能在与记录一起存储的字段上的加载前事件中使用。从函数的 JSDocs 中：

> 设置给定正文字段的值。此 API 可在用户事件 beforeLoad 脚本中用于初始化新记录或非存储字段的字段。

`nlapiSetFieldValue`因此只能在新记录或非存储字段的加载前可靠地使用。

意识到这是一个月前的事情，所以您可能已经找到了解决方案，我会将您的代码移至“提交前”事件。我使用计划脚本对此进行了测试：

```
var customer = nlapiLoadRecord('customer', '31294');
nlapiSubmitRecord(customer); 
```

和客户记录上的用户事件，提交前事件：

```
if (nlapiGetContext().getExecutionContext() === 'scheduled') {
    nlapiSetFieldValue('url', 'http://www.google.com/', false);
} 
```

这在 2013.1 沙盒环境中按预期工作。

`nlapiSubmitField`在另一个答案中提到的在提交后使用是一个不必要的长时间操作，它将使用额外的治理单元。如果这是您的脚本唯一要做的事情，这没什么大不了的，但是如果您扩展脚本或添加循环，它可以在性能和治理使用方面迅速增加。

此外，这可能不是必需的，但您应该确保这样`getDiscountVal`做`Number`：

```
var getDiscountVal = parseInt(nlapiGetFieldValue('discountrate'), 10); 
```

如果它以 a 的形式返回，`String`那么您的除法操作可能会产生奇怪的结果，这也可能导致`nlapiSetFieldValue`失败或将字段设置为奇数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T06:35:34.083

两个建议

*   通过添加一些 nlapiLogExecution 语句确保您的脚本正在执行
*   不要在 beforesubmit 中执行此操作，而是使用 nlapiSubmitField 在 aftersubmit 函数中更改此字段

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-04T14:41:17.320

“*当从计划脚本触发用户事件脚本时，您可以使用 'nlapiSetFieldValue' 吗？* ”

是的，绝对是的。上下文也是正确的。

请确保您在最后提交记录 nlapiSubmitRecord(recordObj)。

如果您对 nlapiSubmitRecord() 不满意，您显然可以使用 nlapiSubmitField()

如果您仍然遇到困难，请粘贴完整的代码，以便我们为您提供帮助。

干杯！！！

# python - python 秘密单词程序

> ID：15672225
> 
> 赞同：1
> 
> 时间：2013-03-28T00:36:56.783
> 
> 标签：python

我正在尝试编写一个程序，用户必须猜测一个字母以解锁秘密单词。如果在最多 8 次猜测之前正确猜测了秘密单词，则该函数返回 true，否则该函数返回 false。出于某种原因，我的函数无法产生正确的输出。我会输入字母'a'，它会打印“迄今为止猜测的字母：['a']”，然后程序将结束。我需要帮助来解决这个问题。

```
secretWord = 'hello'
lettersGuessed = []

def isWordGuessed(secretWord,lettersGuessed):
  guess  = 0
  while guess <= 8:
    secretLetters = list(secretWord)
    secretWordLen = len(secretLetters)
    letter = input('Enter a letter: ')
    lettersGuessed.append(letter)

    print('Letters guessed so far: ',lettersGuessed)

    if letter not in secretLetters:
        guess += 1

    while letter in secretLetters:
        secretLetters.remove(letter)

    if secretLetters == []:
       return True
    else:
       return False

   isWordGuessed(secretWord,lettersGuessed) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T00:48:30.747

最后一条`if`语句缩进太远，导致它成为`while`循环的一部分。由于条件的两个分支都会导致函数返回，因此它总是在循环的第一次迭代时返回。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-28T00:55:45.567

正如 kwatford 解释的那样，您的第一个问题是，您每次都通过循环返回。您可以通过将`if`语句移出`while`循环来解决此问题。

正如 Vorticity 所解释的，你的下一个问题是它永远不会提前返回，即使用户猜到了整个单词。要解决此问题，请将`if`零件移回循环内，但将`else`零件留在循环外（这意味着您不再需要`else`）

在那之后，它*仍然*不起作用，因为你`secretLetters = list(secretWord)`每次都在循环中做，所以你只能在一次猜测中猜出所有字母才能获胜（这是不可能的，除非这个词是，比如说，`"a"`或`"aaaaa"`）。要解决这个问题，请将那条线移到循环之外。

把它们放在一起：

```
def isWordGuessed(secretWord,lettersGuessed):
  guess  = 0
  secretLetters = list(secretWord)
  while guess <= 8:
    secretWordLen = len(secretLetters)
    letter = input('Enter a letter: ')
    lettersGuessed.append(letter)

    print('Letters guessed so far: ',lettersGuessed)

    if letter not in secretLetters:
        guess += 1

    while letter in secretLetters:
        secretLetters.remove(letter)

    if secretLetters == []:
       return True

  return False 
```

* * *

作为旁注，您可以做很多事情来简化这一点。

首先，你真的只需要一组密码中的所有字母——你不需要知道顺序，或者每个字母有多少副本，等等。所以，代替 a `list`，使用 a `set`。这也意味着您不需要围绕`secretLetters.remove(letter)`.

更简单的是，您创建`secretWordLen`但从不使用它。

您还接受并附加到`lettersGuessed`调用者传入的一个，但调用者只是传递给您一个空列表，并且在事后从未使用它，所以为什么要打扰呢？而且，如果您不需要为了调用者的利益而对其进行变异，则可以将其保留为字符串，以便用户看到`help`而不是`['h', 'e', 'l', 'p']`，这要好得多。

您还有一些正在测试的案例，即使它们不可能是真的。

最后，一个空列表（或集合，或任何其他序列）是错误的，因此没有理由显式地与空列表进行比较。

当我这样做时，我将 PEP8-ify 间距以更容易看到缩进。

所以：

```
def isWordGuessed(secretWord):
    guess = 0
    lettersGuessed = ''
    secretLetters = set(secretWord)
    while guess <= 8:
        letter = input('Enter a letter: ')
        lettersGuessed += letter
        print('Letters guessed so far:', lettersGuessed)
        if letter not in secretLetters:
            guess += 1
        else:
            secretLetters.remove(letter)
            if not secretLetters:
                return True
    return False 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T00:50:45.693

您只需要为`False`案件移动您的退货。基本上，按照您现在编写代码的方式，您将永远不会回到循环的开头。此外，正如 abarnert 所指出的，您永远不会退出循环，因为您每次循环时都会重新初始化 secretLetters。您必须在循环外对其进行初始化。您的代码应如下所示：

```
secretWord = 'hello'
lettersGuessed = []

def isWordGuessed(secretWord,lettersGuessed):
    guess  = 0
    secretLetters = list(secretWord)
    secretWordLen = len(secretLetters)
    while guess <= 8:
        letter = input('Enter a letter: ')
        lettersGuessed.append(letter)

        print('Letters guessed so far: ',lettersGuessed)

        if letter not in secretLetters:
            guess += 1

        while letter in secretLetters:
            secretLetters.remove(letter)

        if secretLetters == []:
            #Return true if all correct letters have been guessed
            return True

    #Return false if guessed incorrectly eight times
    return False 
```

# php - PHP 和 UTF-8 字符的问题

> ID：15672231
> 
> 赞同：1
> 
> 时间：2013-03-28T00:37:54.990
> 
> 标签：php, utf-8

我最近一直在网站上工作（本地主机环境）。今天我在网上做了，我遇到了一个非常奇怪的问题：

每当我尝试从我的数据库中输出 UTF-8 字符（希伯来语）时，它都能完美运行，但是当我尝试回显简单文本时（例如：echo "שלום";）我得到问号（不是带有黑色背景的问号） .

我试图寻找解决方案，但没有找到。我希望你们能帮我解决这个问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T00:41:07.603

检查事项：

1.  您是否尝试告诉客户端浏览器您正在使用什么字符集：（`<meta http-equiv="Content-Type" content="text/html; charset=utf-8">`< [meta charset="utf-8"> vs <meta http-equiv="Content-Type">](https://stackoverflow.com/q/4696499/1481489)）

2.  您的文件/编辑器是否设置为 UTF-8？Eclipse 默认为 cp1252，常见的 windows 编辑器将默认为 ISO-8859-1 或 UCS-2。

3.  在您的 php.ini 文件中，确认`default_charset = "UTF-8"`（参见[http://www.php.net/manual/en/ini.core.php#ini.default-charset](http://www.php.net/manual/en/ini.core.php#ini.default-charset)）

4.  强制 HTTP 事务中的内容类型（通过响应标头）：`header('Content-type: text/html; charset=utf-8');`确保在将任何内容刷新到浏览器之前包含此内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T00:40:15.127

您的代码文件中的编码错误。您的编辑器错误地保存了它们，您可能没有费心为“Content-type”发送 HTTP 标头，您的 localhost 也没有，但您的在线服务器现在可以。

更改编码，一切都会好起来的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T00:46:30.977

我最近遇到了这个问题。使用此代码解决它：

```
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
```

# c# - RSA 加密导致错误

> ID：15672237
> 
> 赞同：0
> 
> 时间：2013-03-28T00:38:11.103
> 
> 标签：c#, .net, rsa

我希望您能帮助我解决我在尝试使用 RSA 作为加密类型实现 QueryString 加密模块时遇到的一个奇怪错误。我的问题是2折：

1.  你能帮我解决我遇到的错误吗？

2.  您是否推荐 RSA 以外的其他方法来加密 QueryString？

**背景/重要信息：**
我创建了一个名为 QueryString 的对象，我将其存储在会话中（并使用 SessionID 生成密钥/盐）。我在生成密钥的 Session Start 上实例化它，然后它自然会在 Session.Abandon 上消失...和东西）...我将我的公钥和私钥存储在对象本身中，作为对象的内部属性。

另一个重要的事情是我的网站有很多网格，其中包含链接的记录行，因此它们都必须在设置之前加密（href = ...）......所以QueryString对象我created 可能会很快被征税（在使用 OnRowCreated 循环或加密hrefs的东西时）。

**错误：**
当我尝试加密或解密时，我目前遇到以下类型的间歇性错误，无法重现（它们随机发生......相信我......非常随机）：
错误类型 1 : CreateProvHandle 错误类型 2: 找不到指定的文件。错误类型 3：试图执行未经授权的操作。

对于错误 1 ​​和 2，到目前为止，我设法通过简单地递归调用导致它的方法（加密或解密）来处理它，它们通常只递归一次（使用我的指标，我最大的是 3）并且错误神奇消失了...所以我将其归咎于对对象本身或其他东西的调用太快...但是如果有人对为什么会发生这种情况或如何解决此问题有任何线索，我很想消除递归我的方法并在发生重大异常时真正抛出。最重要的是，我告诉我的 RSA 参数不要在 CSP 存储中保留任何东西，所以我认为文件无关紧要，但显然不是......

对于错误 3，我根本无法理解它！我的 RSA 参数说不要在 CSP 中保留任何内容，所以我不知道它如何、何时或为什么会尝试访问文件（是的，我在重复自己！），更不用说受限制的文件或用户不会无权访问？请帮我！！

这是我的 RSA 参数的一些代码......也许你会在那里找到一些与我正在尝试做的事情不符的东西（在对象实例化时生成一次密钥，将对象存储在会话中，然后使用它来自该点打开/断开与任何远程/调用不属于站点或.NET的服务器进程的连接）？

```
public static void AssignParameter()
    {
        const int PROVIDER_RSA_FULL = 1;
        const string CONTAINER_NAME = "ICareContainer";
        CspParameters cspParams;
        cspParams = new CspParameters(PROVIDER_RSA_FULL);
        cspParams.KeyContainerName = CONTAINER_NAME;
        cspParams.Flags = CspProviderFlags.UseMachineKeyStore;
        cspParams.ProviderName = "Microsoft Strong Cryptographic Provider";
        CryptoKeyAccessRule rule = new CryptoKeyAccessRule("everyone", CryptoKeyRights.FullControl, AccessControlType.Allow);
        cspParams.CryptoKeySecurity = new CryptoKeySecurity();
        cspParams.CryptoKeySecurity.SetAccessRule(rule);

        rsa = new RSACryptoServiceProvider(cspParams);
        rsa.PersistKeyInCsp = false;
        rsa.KeySize = 1024;
    }

public static string[] GetKeys()
    {
        AssignParameter();
        string[] keys =  new string[2];
        //privatekey
        keys[0] = rsa.ToXmlString(true);
        //publickey
        keys[1] = rsa.ToXmlString(false);

        return keys;
    }

public static string EncryptData(string data2Encrypt, string key)
    {
        AssignParameter();
        string publicOnlyKeyXML = key;
        rsa.FromXmlString(publicOnlyKeyXML);
        //read plaintext, encrypt it to ciphertext  
        byte[] plainbytes = System.Text.Encoding.Default.GetBytes(data2Encrypt);
        byte[] cipherbytes = rsa.Encrypt(plainbytes, false);
        return Convert.ToBase64String(cipherbytes);
    }

public static string DecryptData(string data2Decrypt, string key)
    {
        AssignParameter();
        byte[] getpassword = Convert.FromBase64String(data2Decrypt);
        string publicPrivateKeyXML = key;
        rsa.FromXmlString(publicPrivateKeyXML);
        //read ciphertext, decrypt it to plaintext  
        byte[] plain = rsa.Decrypt(getpassword, false);
        return System.Text.Encoding.Default.GetString(plain);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T14:07:25.260

啊是的......愚蠢的错误（他们不总是吗？）：

```
Normal Class
    Static Crypto Class
    End Static
End Normal 
```

你能找到问题吗？为什么我会遇到碰撞错误？我已将静态更改为正常，一切都很好。

干杯!

# java - 主类中的变量未在另一个文件中存储

> ID：15672239
> 
> 赞同：-1
> 
> 时间：2013-03-28T00:38:14.490
> 
> 标签：java, swing, variables, user-interface

我是编程的新手，因为我没有找到解决问题的方法，所以再次发布。我正在编写一个由三个文件组成的简单项目。在主类中，我构建了 gui：

// AlladinLamp.java

```
import statements go here

public class AlladinLamp  {

   int fnh;
   JComboBox runners;
   other variables go here

   actionListener and other methods go here, including

   public int getFNH()  { return fnh; }

   ActionListener runnersActionListener = new ActionListener()  {
          @Override
          public void actionPerformed( ActionEvent e ) {
             String  runnersNumber = ( String )runners.getSelectedItem();
             fnh = Integer.parseInt( runnersNumber );          
             hNam = new String[ fnh ];
             hNum = new int[ fnh ];
             hVal = new int[ fnh ];
             jtxt = new JTextField[ fnh ];
             reducedFNH = reduce( fnh );                
           }
   };

   public AlladinLamp()  {

      gui built here...

      String[] numberOfRunners = { "8", "9", "10", "11", "12",
                                "13", "14", "15", "16", "17",
                                "18", "19", "20", "21", "22" };

      runners = new JComboBox( numberOfRunners );
      runners.setMaximumRowCount(5); 

      runners.addActionListener( runnersActionListener );

      ...
}

public static void main( String args[] )  {

   SwingUtilities.invokeLater( new Runnable()  {
            @Override
            public void run()  {
                AlladinLamp lamp = new AlladinLamp();                 
            }
        });

} 
```

另一个文件没有收到跑步者组合框生成的值

// 进程.java

```
import statements go here

public class Processes  {

int fullNH;
AlladinLamp lamp;

public Process()  {

  lamp = new AlladinLamp();
  fullNH = lamp.getFNH();

  ...

} 
```

第二个文件中没有读取变量 fnh。有人可以建议我做错什么吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:40:16.193

编辑：好的。`AlladinLamp`您在第二个文件的这一行创建一个新的

```
lamp = new AlladinLamp(); 
```

现在，程序立即尝试在这条线上获取 FNH

```
fullNH = lamp.getFNH(); 
```

问题是，如果`AlladinLamp`是你的主类，那么调用`new AlladinLamp()`另一个类将创建一个新实例`AlladinLamp`（一个全新的对象）。然后你试图`fnh`从那个新的中得到正确的`AlladinLamp`——它将是空的。

您需要做的是获取现有对象`AlladinLamp`，然后调用`getFNH()`它。

**如果**你是这样`Processes`从你的`AlladinLamp`课开始的

```
new Processes(); 
```

然后将`Processes`构造函数更改为类似

```
public class Processes {

    AlladinLamp lamp;
    int fullNH;    

    public Processes(AlladinLamp al) {
        lamp = al;
        fullNH = lamp.getFNH();
    }
} 
```

当你`Processes`从你的`AlladinLamp`班级开始时，你想这样开始：

```
new Processes(this); 
```

# java - 创建 owl 文件时出错

> ID：15672240
> 
> 赞同：1
> 
> 时间：2013-03-28T00:38:15.000
> 
> 标签：java, jena

我想用这段代码创建本体：

```
public static void main(String[] args) throws FileNotFoundException {
    // TODO code application logic here
    OntModel my_model= ModelFactory.createOntologyModel();
    ObjectProperty op = my_model.createObjectProperty("b");
    OntClass my_class = my_model.createClass("student");
    DatatypeProperty  dtp = my_model.createDatatypeProperty("name");
    dtp.addDomain(my_class);
    FileOutputStream univer= new FileOutputStream("c:/uni.owl");
    my_model.write(univer,"RDF/XML-ABBREV","ns");

} 
```

但它给出了这个错误：

```
java.lang.NoClassDefFoundError: com/hp/hpl/jena/rdf/model/Resource
Caused by: java.lang.ClassNotFoundException: com.hp.hpl.jena.rdf.model.Resource
        at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:307)
        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:248)
Could not find the main class: javaapplication6.Main.  Program will exit.
Exception in thread "main" Java Result: 1 
```

我不明白是什么问题。感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T02:05:26.020

[NoClassDefFoundError](http://docs.oracle.com/javase/6/docs/api/java/lang/NoClassDefFoundError.html)表示 Java 虚拟机或 ClassLoader 实例尝试加载类的定义（作为正常方法调用的一部分或作为使用 new 表达式创建新实例的一部分）并且找不到类的定义。

尝试从[此处下载](http://jena.apache.org/download/)[Apache Jena 库](http://jena.apache.org/index.html)并将其放入您的类路径中

# java - 计算循环和 fcfs 工作时间

> ID：15672244
> 
> 赞同：1
> 
> 时间：2013-03-28T00:38:29.263
> 
> 标签：java, c, multithreading

为什么 fcfs 从 0 99 和从 99 到 198

而对于Round robin，我不明白为什么第一个工作完成时间是500。

一个解释和例子会有所帮助，谢谢![在此处输入图像描述](../Images/51348e9b88148d123db4bcb40b81627d.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T00:55:35.620

在 FCFS 下，作业 1 的等待时间为 0，因为它是在时间 t = 0 时的唯一作业，因此它会立即被调度。作业 2 在 t=1 出现，但在作业 1 在时间 t=100 完成后调度，这意味着等待99 秒（t=1 到 t=100）直到它被安排。类似地，作业 3 在 t=2 出现，并且仅在作业 1 和 2 完成后（即 t=200）才被安排，这意味着等待 200-2 = 198 秒。

对于循环，每个作业运行 1 秒并切换上下文。这有条不紊地发生。因此，在作业 1 从 t=0 运行到 t=1 之后，作业 2 从 t=1 运行到 2，作业 3 从 t=2 运行到 3，依此类推，直到 1 再次从 t=5 运行到 t=6。这样，作业 1 在 5 个周期内执行一次。由于 proc 1 总共需要 100 秒，因此它将在 500 秒时完成。

如果您对此解释有帮助，请点赞。

编辑：

循环赛详情：

作业 1 以 1 秒的块运行总共 100 秒，每个块以 4 秒的间隔（1（作业 2 的块）+1（作业 3）+1（作业 4）+1（作业 5））。所以它运行在 t=0, t=5, t=10... 每次只运行 1 秒，由作业 2、3、4、5 的类似 1 秒执行交错。这样，它的第 100 次也是最后一次执行将在 t=500 进行。

# vim - 在 vim 上运行 python

> ID：15672250
> 
> 赞同：3
> 
> 时间：2013-03-28T00:39:23.623
> 
> 标签：vim, python-2.7, numpy, ubuntu-12.04, ipython

在 askubuntu.com 上，有人告诉我如何[在 Vim 上运行 python](https://askubuntu.com/questions/273066/running-python-in-vim/273068?noredirect=1#comment344013_273068)。我正在测试[使用 python 求解非线性方程](https://stackoverflow.com/questions/15649134/using-python-to-solve-a-nonlinear-equation/15652210?noredirect=1#15652210)的代码 1st 或 2nd 代码 python 代码的设置。

我唯一不同的是添加 print(a) 作为最后一行。我昨天从 shell 运行了这个，它运行良好。有人可以让我知道出了什么问题吗？

好的，所以我用适当的问号更正了 vimrc，

```
chmod +x ~/path/to/file/hw6problem2.py 
```

然后从 vim 我跑了

```
:Shell ./# 
```

但我再次收到相同的语法错误。**（文件是否必须保存为 .sh 因为我无法运行任何 .py 文件？）**

```
dustin@dustin:~$ vim /home/dustin/Documents/School/UVM/Engineering/OrbitalMechanics/hw6problem2.py

File "hw6problem2.py", line 14
a0 = max(s/2, (s - c)/2)
 ^
SyntaxError: invalid syntax

shell returned 1

Press ENTER or type command to continue 
```

vimrc

```
syntax on
au BufWinLeave * mkview "records settings
au BufWinEnter * silent loadview "reloads settings

set nu "puts line numbers on
set ic "case insensitive
set foldmethod=syntax "for the latex-suite
set autoread "autoload when files in the buffer have been modified
set autochdir "autochange directory

"set wrap
set wrap
" set lines=50 columns=80

" resizes window
:map g1 :set lines=20<CR>:set columns=80<CR>
:map g2 :set lines=50<CR>:set columns=80<CR>
:map g3 :set lines=50<CR>:set columns=170<CR>
:map <F6> :! firefox % &<CR>
:map E Ea

"set autoindent

set tabstop=4
set shiftwidth=2
set expandtab
set smartindent
"
" Stuff for latex-suite 

" REQUIRED. This makes vim invoke Latex-Suite when you open a tex file.
" It also allows you to set different actions for different filetypes
" in ~/.vim/after/ftplugin/*.vim
filetype plugin on

set shellslash

" IMPORTANT: grep will sometimes skip displaying the file name if you
" search in a singe file. This will confuse Latex-Suite. Set your grep
" program to always generate a file-name.
set grepprg=grep\ -nH\ $*

" OPTIONAL: This enables automatic indentation as you type.
filetype indent on

" OPTIONAL: Starting with Vim 7, the filetype of empty .tex files defaults to
" 'plaintex' instead of 'tex', which results in vim-latex not being loaded.
" The following changes the default filetype back to 'tex':
let g:tex_flavor='latex'
let g:Tex_ViewRule_pdf = 'okular'

"""""""""""""""""""""""""""""""""""""""
" => Shell command
"""""""""""""""""""""""""""""""""""""""

command! -complete=shellcmd -nargs=+ Shell call s:RunShellCommand(<q-args>)

function! s:RunShellCommand(cmdline)
let isfirst = 1
let words = []
for word in split(a:cmdline)
if isfirst
  let isfirst = 0  " don't change first word (shell command)
 else
  if word[0] =~ '\v[%#<]'
    let word = expand(word)
  endif
  let word = shellescape(word, 1)
endif
call add(words, word)
endfor
let expanded_cmdline = join(words)
rightbelow new
setlocal buftype=nofile bufhidden=wipe nobuflisted noswapfile nowrap
call setline(1, 'You entered:  ' . a:cmdline)
call setline(2, 'Expanded to:  ' . expanded_cmdline)
call append(line('$'), substitute(getline(2), '.', '=', 'g'))
silent execute '$read !'. expanded_cmdline
1
endfunction 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T04:00:45.817

这很可能是一个python问题。

另一方面，有一个很棒的 shell 函数用于执行脚本并将输出重定向到 vim 缓冲区（拆分窗口）。

执行当前脚本的语法（你应该有 chmod +x 和 shebang 行）：

```
:Shell ./# 
```

为了添加功能，将其添加到`.vimrc`：

```
command! -complete=shellcmd -nargs=+ Shell call s:RunShellCommand(<q-args>)

function! s:RunShellCommand(cmdline)
  let isfirst = 1
  let words = []
  for word in split(a:cmdline)
    if isfirst
      let isfirst = 0  " don't change first word (shell command)
    else
      if word[0] =~ '\v[%#<]'
        let word = expand(word)
      endif
      let word = shellescape(word, 1)
    endif
    call add(words, word)
  endfor
  let expanded_cmdline = join(words)
  rightbelow new
  setlocal buftype=nofile bufhidden=wipe nobuflisted noswapfile nowrap
  call setline(1, 'You entered:  ' . a:cmdline)
  call setline(2, 'Expanded to:  ' . expanded_cmdline)
  call append(line('$'), substitute(getline(2), '.', '=', 'g'))
  silent execute '$read !'. expanded_cmdline
  1
endfunction 
```

[https://github.com/ruslanosipov/dotfiles/blob/master/.vimrc#L137](https://github.com/ruslanosipov/dotfiles/blob/master/.vimrc#L137)

# git - Jenkins 不断在构建队列中添加作业并不断构建它们

> ID：15672252
> 
> 赞同：1
> 
> 时间：2013-03-28T00:39:38.050
> 
> 标签：git, build, jenkins

我们将 Jenkins 与 Git 一起使用，所有作业都配置为，每次提交到 Git 时，清理工作区并触发构建。这个场景运行良好。

现在的情况是，不知道确切原因但可能在系统重新启动时，所有作业都像无限循环一样不断添加到构建队列中，然后作业开始失败。（当单独触发作业时，它们会成功）

针对以上情况可以做些什么？

我已经给`POLL SCM ****`了它，以便它在提交后立即从 git 中获取更改，这会是一个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-09T09:22:27.847

今晚我刚刚遇到了 Builds in Jenkins 的这种循环效果。我正在运行当前版本的 Jenkins 1.598 并使用当前版本的 GIT 插件 2.3.4。

除了将令牌添加到 GIT URL 文本字段中的 https 之外，其他设置均未更改。我有一个构建后选项，它在第一次构建成功完成后运行不同的构建。我总共有 4 种此类构建，总共 8 个构建。保存所有令牌更改的设置后，我同时运行了 4 个构建。这就是循环开始的地方。

我开始注意到第一个构建将完成并触发第二个后续构建。二次后构建完成后，神秘的前 4 个构建出现在队列中。我还确保在二级构建中没有任何其他构建后设置指向第一个构建。

因此，就我而言，最新版本似乎仍然存在这个循环问题。

解决方案：正如 Dan Woodward 所指出的，在服务中为我们的 Microsoft OS 服务器重新启动 Jenkins 实例解决了这个问题。我的预感是，在每次设置更改后，重新启动 Jenkins 可能是一个好主意，即使这不是 Jenkins 的要求。但是，它可能会解决任何可能的问题，例如此循环错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-23T16:53:42.953

这可以通过以下方式回答：[Jenkins 会定期丢失工作空间，触发不需要的构建](https://stackoverflow.com/questions/6333989/jenkins-loses-workspaces-periodically-triggers-unwanted-build)。

基于这个问题，我更新了所有插件并重新启动了我的 jenkins 实例。现在情况似乎好多了。

# xampp - vhosts 只为所有域显示一个根

> ID：15672253
> 
> 赞同：0
> 
> 时间：2013-03-28T00:39:48.453
> 
> 标签：xampp, mamp, apache, hosts

我正在使用 MAMP。我希望单独的域在我的本地计算机上使用不同的根。

*   我希望“localhost”进入我的 htdocs 文件夹。
*   我希望“wowzers.loc”使用 /Donald/Projects/wowzers 作为它的根。
*   我希望“secondsite.loc”使用 /Donald/Projects/secondsite 作为它的根。

这是我的 httpd-vhosts.conf 文件：

```
NameVirtualHost *:80

<VirtualHost *>
  DocumentRoot "/Users/donald/Projects/wowzers"
  ServerName wowzers.loc
</VirtualHost>

<VirtualHost *>
  DocumentRoot "/Users/donald/Projects/secondsite"
  ServerName secondsite.loc
</VirtualHost> 
```

现在，输入“localhost”、“wowzers.loc”或“secondsite.loc”都将导航到我的 vhosts 文件中的第一个条目。在此示例中，所有内容都导航到“wowzers.loc”。

为什么我所有的服务器名称都指向顶部条目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T00:52:10.360

您应该在没有引号的情况下尝试它，`DocumentRoot`并将相同的参数传递`NameVirtualHost`给 `VirtualHost`ie：`<VirtualHost *:80>`

[阿帕奇文档](http://httpd.apache.org/docs/2.2/mod/core.html#namevirtualhost)

# java - 打印链表最有效的方法是什么？

> ID：15672254
> 
> 赞同：0
> 
> 时间：2013-03-28T00:39:48.907
> 
> 标签：java, printing, linked-list

可以说我有一个字符串的链接列表。打印这个链表最有效的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:13:22.207

@Thilo 是正确的。显而易见的解决方案是正确的……前提是您不以一种悲观的方式格式化字符串（例如，通过附加到一个大字符串），或者隐式地过多地刷新输出。

* * *

但还有一点需要说的是：

> 不要沉迷于性能/效率。

大多数时候，这样的东西的性能/效率并不重要。在这种情况下，除非您做错了什么，否则格式化列表所花费的时间相对于输出字符所花费的时间可能很小，而与运行整个程序所花费的时间相比，TINY 是很小的。

而且很有可能您实际上花更多的时间来*思考*这个问题而不是节省下来的时间......对于等待计算机给他们答案的最终用户。

性能*可能*很重要。但这在这里不太重要。*当你有证据*表明需要努力时，最好只花精力让事情变得更快。首先让程序运行，对其进行分析，*然后才*决定优化它是否有任何价值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T00:41:58.183

与任何列表或数组相同：循环遍历元素并依次打印每个元素。上）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T00:59:44.490

您可以先将 转换`LinkedList`为数组（使用`.toArray(new String[0])`），然后使用[Arrays.deepToString()打印它](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#deepToString%28java.lang.Object%5B%5D%29)

```
Arrays.deepToString(convertedArray); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-28T01:04:52.587

Java 集合实现了特定于数据结构的优化迭代器。具体来说`LinkedList`，迭代器保留一个指向最后返回元素的指针，以允许恒定的时间`next()`和`previous()`操作。

另一方面，如果要打印以控制每个元素，最好的方法是使用缓冲区。

```
PrintWriter out = new PrintWriter(System.out, false); // autoFlush false
// for-each or iterator
//     out.print(obj);
out.flush(); // flush to the output 
```

如果您只使用`System.out`，则每个操作都会立即发送到输出，这可能会很慢。您是否看到禁用或更改某些应用服务器中的日志级别以获得更好的性能？

# google-chrome - Chrome 扩展开发频道下载权限

> ID：15672257
> 
> 赞同：2
> 
> 时间：2013-03-28T00:40:14.013
> 
> 标签：google-chrome, google-chrome-extension

`Chrome Version 27.0.1448.0 dev`尝试打电话时

```
chrome.downloads.download(url:song.url); 
```

我收到错误`chrome.downloads is not available: You do not have permission to access this API. Ensure that the required permission or manifest property is included in your manifest.json.`

我的权限看起来像。

```
"permissions": [
    "downloads",
    "https://*/*", "http://*/*",
    "tabs"
 ], 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:37:14.170

我相信这是一项实验性功能，因此您可能还需要请求“实验性”许可。

# python - 在 Windows 上安装 Skype4Py

> ID：15672263
> 
> 赞同：2
> 
> 时间：2013-03-28T00:40:32.707
> 
> 标签：python, skype4py

我正在尝试在 Windows 上安装 Skype4Py，但它只是不断向我抛出这个错误，我不知道如何解决它。

```
Traceback (most recent call last):
  File "Z:\Temp\Programming\Skype4Py-1.0.34\setup.py", line 152, in <module>
    cmdclass=commands)
  File "C:\Python27\lib\distutils\core.py", line 140, in setup
    raise SystemExit, gen_usage(dist.script_name) + "\nerror: %s" % msg
SystemExit: usage: setup.py [global_opts] cmd1 [cmd1_opts] [cmd2 [cmd2_opts] ...]
   or: setup.py --help [cmd1 cmd2 ...]
   or: setup.py --help-commands``
   or: setup.py cmd --help

error: no commands supplied 
```

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T11:29:40.350

您使用什么命令进行安装？

你有`install`选择吗？

安装命令应如下所示：

```
python setup.py install 
```

# vb.net - 制作复选框将多行文本放入标签中

> ID：15672271
> 
> 赞同：1
> 
> 时间：2013-03-28T00:41:10.933
> 
> 标签：vb.net, button, label

所以我有 4 个复选框，如果其中一个被选中，我想将该文本放入标签中。

我的问题是，当检查一个框时，它只是在标签中包含该文本，而不是其他已检查的文本。我希望它为每个选中的框都有一个新行，以将新行文本放入标签中。

我怎样才能让程序通过复选框，如果它们被选中，则将该文本放入标签中，并为选中的下一个框开始一个新行并将该文本放在那里？

置于按钮点击事件之下。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T00:47:52.987

又快又脏，但如果我理解你的要求，这应该可行。

```
 Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click

    Label1.Text = ""

    If (CheckBox1.Checked) Then
        Label1.Text &= CheckBox1.Text & vbCrLf
    End If

    If (CheckBox2.Checked) Then
        Label1.Text &= CheckBox2.Text & vbCrLf
    End If

    If (CheckBox3.Checked) Then
        Label1.Text &= CheckBox3.Text & vbCrLf
    End If

    If (CheckBox4.Checked) Then
        Label1.Text &= CheckBox4.Text & vbCrLf
    End If

    End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T05:44:40.913

将所有`CheckBox`es 放在同一个容器中。在此示例中，它们都包含在`Panel1`. 这将获取所有被检查`Text`的 es 属性`CheckBox`，并将其`Text`放入`Label1.Text`. 当没有选择任何内容时，`Exception`抛出一个（序列不包含任何元素）。

```
Try
    Label1.Text = Panel1.Controls.OfType(Of CheckBox). _
        Where(Function(arg) arg.Checked). _
        Select(Function(arg) arg.Text). _
        Aggregate(Function(aggregate, nextItem) aggregate & Environment.NewLine & nextItem)
Catch ex As Exception
    Label1.Text = "Nothing selected"
End Try 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T06:01:59.063

试试这个代码，

[**注：**测试与`IDE`]

```
 Private Sub Common_Cheked_Change_Handler(ByVal sender As System.Object, _
 ByVal e As System.EventArgs) Handles _
 CheckBox1.CheckedChanged, CheckBox2.CheckedChanged, _
 CheckBox3.CheckedChanged, CheckBox4.CheckedChanged

        Label1.Text = String.Empty

        Label1.Text = If(CheckBox1.Checked = True, CheckBox1.Text & vbCrLf, String.Empty) & _
         If(CheckBox2.Checked = True, CheckBox2.Text & vbCrLf, String.Empty) & _
          If(CheckBox3.Checked = True, CheckBox3.Text & vbCrLf, String.Empty) & _
           If(CheckBox4.Checked = True, CheckBox4.Text, String.Empty)

 End Sub 
```

# prolog - 如何在序言中输出文本？

> ID：15672272
> 
> 赞同：1
> 
> 时间：2013-03-28T00:41:11.367
> 
> 标签：prolog

我是 Prolog 的新手，我正在尝试编写一些输出。

我有一个功能：`father(X,Y)`如果 X 是 Y 的父亲，那就是真的，所以会发生这种情况：

```
?- father(homer,bart)
true 
```

我该怎么做这样的事情：

```
doTests :-
  write('Test1 expect true ==> '),(write father(homer,bart)),nl,
  write('Test2 expect false ==> '),(write father(homer,nelson)),nl,
  write('Test3 expect true ==> '),(write father(abe,homer)). 
```

所以我得到这样的东西......

```
?- doTests.
Test1 expect true ==> true
Test2 expect false ==> false
Test3 expect true ==> true 
```

?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T07:54:28.043

我会分解模式：

```
:- meta_predicate oneTest(+,:).

oneTest(Label, Pred) :- 
   (call(Pred) -> R = true ; R = false), format('~s ==> ~s~n', [Label, R]).

doTests :-
  oneTest('Test1 expect true', father(homer,bart)),
  oneTest('Test2 expect false', father(homer,nelson)),
  oneTest('Test3 expect true', father(abe,homer)). 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T01:35:48.600

testfather :-father(homer, bart), writeln('Yes Homer is barts Father')。

如果 homer 不是 bart 的父亲，你将永远无法到达 writeln

如果要打印变量，请执行此操作

testfather :-father(X, bart), write(X), write('是 bart'的父亲'), nl。

# sql - 以不同于工作日的方式汇总周末数据

> ID：15672274
> 
> 赞同：1
> 
> 时间：2013-03-28T00:41:13.850
> 
> 标签：sql, sql-server, sql-server-2008

我有这个查询：

```
SELECT 'Submission Date' = CAST(Submitted AS DATE)
    ,'DayOfWeek' = DATEPART(weekday, CAST(Submitted AS DATE))
    ,'DayOfWeekForm' = DATENAME(dw, CAST(Submitted AS DATE))
    ,'Submission Count' = count(*)
    ,'End Column' = CASE 
        WHEN (DATEPART(weekday, CAST(Submitted AS DATE))) IN (
                '1'
                ,'7'
                )
            THEN ('Weekend')
        ELSE DATENAME(dw, CAST(Submitted AS DATE))
        END
    ,'End Sub' = CASE 
        WHEN ('End Column' = 'Weekend')
            THEN NULL
        ELSE count(*)
        END
FROM dbo.xyz
WHERE CAST(Submitted AS DATE) BETWEEN '2012-09-01'
        AND '2012-09-10'
GROUP BY CAST(Submitted AS DATE)
ORDER BY CAST(Submitted AS DATE) 
```

它返回：

```
Sub Date   DW  DayOfWeek   Sub Count  End Column  End Sub
---------  --  ----------  ---------  ----------  -------
 9/1/2012  7   Saturday    20         Weekend     20
 9/4/2012  3   Tuesday     126        Tuesday     126
 9/5/2012  4   Wednesday   141        Wednesday   141
 9/6/2012  5   Thursday    167        Thursday    167
 9/7/2012  6   Friday      132        Friday      132
 9/8/2012  7   Saturday    28         Weekend     28
 9/9/2012  1   Sunday      6          Weekend     6
9/10/2012  2   Monday      210        Monday      210 
```

我的目标是将周末的提交添加到之前的星期五。即我希望 09-01、09-08、09-09 的 End Sub 字段显示为 NULL。09-07 显示 166。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:17:04.233

这会做：

```
SELECT CAST(Submitted AS DATE) AS [Submission Date]
    , DATEPART(weekday, CAST(Submitted AS DATE)) AS [DayOfWeek]
    , DATENAME(dw, CAST(Submitted AS DATE)) AS [DayOfWeekForm]
    , count(*) AS [Submission Count]
    , CASE 
        WHEN (DATEPART(weekday, CAST(Submitted AS DATE))) IN (
                '1'
                ,'7'
                )
            THEN ('Weekend')
        ELSE DATENAME(dw, CAST(Submitted AS DATE))
        END AS [End Column]
    , xyz_cnt._cnt AS [End Sub]
FROM dbo.xyz LEFT JOIN
 (SELECT CASE DATEPART(weekday, CAST(Submitted AS DATE))  
        WHEN '1' THEN DATEADD(dd, -2, CAST(Submitted AS DATE))
        WHEN '7' THEN DATEADD(dd, -1, CAST(Submitted AS DATE))
        ELSE CAST(Submitted AS DATE) END AS [SubmitDate]
    , count(*) AS _cnt 
  FROM dbo.xyz
  GROUP BY
  CASE DATEPART(weekday, CAST(Submitted AS DATE))  
        WHEN '1' THEN DATEADD(dd, -2, CAST(Submitted AS DATE))
        WHEN '7' THEN DATEADD(dd, -1, CAST(Submitted AS DATE))
        ELSE CAST(Submitted AS DATE) END ) AS xyz_cnt 
  ON CAST(xyz.Submitted AS DATE) = xyz_cnt.SubmitDate
WHERE CAST(Submitted AS DATE) BETWEEN '2012-09-01'
        AND '2012-09-10'
GROUP BY CAST(Submitted AS DATE), xyz_cnt._cnt
ORDER BY CAST(Submitted AS DATE) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T01:39:49.693

不确定我是否已经处理了所有潜在的边缘情况，但这是一种似乎至少可以解决直接示例的方法。

```
DECLARE @start DATE = '2012-09-01', @end DATE = '2012-09-10';

;WITH n(d,c,rn) AS 
(
  SELECT 
    CONVERT(DATE, Submitted), COUNT(*),
    ROW_NUMBER() OVER (ORDER BY CONVERT(DATE, Submitted))
  FROM dbo.xyz 
  WHERE Submitted >= @start AND Submitted < DATEADD(DAY, 1, @end)
  GROUP BY CONVERT(DATE, Submitted)
),
x(d,rn,c,dw,dn) AS 
(
  SELECT d,rn,c,DATEPART(WEEKDAY, d),DATENAME(WEEKDAY, d) FROM n
)
SELECT 
  [Sub Date] = x.d,
  [DayOfWeek] = x.dw,
  [DayOfWeekForm] = x.dn,
  [Sub Count] = x.c,
  [End Column] = CASE WHEN x.dw IN (1,7) THEN 'Weekend' ELSE x.dn END,
  [End Sub] = CASE 
    WHEN x.dw IN (1,7) THEN NULL 
    WHEN x.dw = 6 THEN x.c 
        + CASE WHEN x2.d = DATEADD(DAY, 1, x.d) THEN x2.c ELSE 0 END
        + CASE WHEN x3.d = DATEADD(DAY, 2, x.d) THEN x3.c ELSE 0 END
    ELSE x.c END 
FROM x
LEFT OUTER JOIN x AS x2 ON x.rn  = x2.rn-1 
LEFT OUTER JOIN x AS x3 ON x2.rn = x3.rn-1
ORDER BY x.d; 
```

结果：

```
Sub Date    DayOfWeek  DayOfWeekForm  Sub Count  End Column  End Sub
----------  ---------  -------------  ---------  ----------  -------
2012-09-01  7          Saturday       20         Weekend     NULL
2012-09-04  3          Tuesday        126        Tuesday     126
2012-09-05  4          Wednesday      141        Wednesday   141
2012-09-06  5          Thursday       167        Thursday    167
2012-09-07  6          Friday         132        Friday      166
2012-09-08  7          Saturday       28         Weekend     NULL
2012-09-09  1          Sunday         6          Weekend     NULL
2012-09-10  2          Monday         210        Monday      210 
```

# javascript - 为什么我的 Ember 模板无法渲染？

> ID：15672277
> 
> 赞同：2
> 
> 时间：2013-03-28T00:41:29.340
> 
> 标签：javascript, model-view-controller, ember.js, javascript-framework

[这是这个问题的小提琴](http://jsfiddle.net/Gqc53/5/)（在第 5 行添加/删除单斜杠并重新运行）

基本上，两种绑定方式（*专有名词？*）我的应用程序模板。我希望这两种方法都能奏效，但一种有效，一种无效。

## 作品

```
this.register( 'view:application',     Ember.View.extend());
this.register( 'template:application', Ember.Handlebars.compile( 'Hello, world!' )); 
```

## 破碎的

```
this.register( 'view:application', Ember.View.extend({
  'template': Ember.Handlebars.compile( 'Hello, world!' )
})); 
```

这似乎适用于所有资源/路由，而不仅仅是在应用程序级别。

*那么，为什么第二种方法不起作用呢？*

**编辑**：这是[另一个小提琴](http://jsfiddle.net/TSaF3/1/)，它使用上面的方法 2（损坏）成功显示了 Handlebars 视图助手。似乎这只是路线视图的问题。

**编辑 2**：感谢[c4p](https://stackoverflow.com/users/844923/c4p)这是 Github 上的一个问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T10:20:28.907

看看这个[相关的问题](https://stackoverflow.com/questions/15676017/ember-js-rc1-view-not-displayed-when-specifying-template)。

简短的摘要：

*   Ember 期望在全局变量中找到模板`Ember.TEMPLATES`。当你使用 Ember.Handlebars.compile 时，编译后的模板会被放入全局变量`Handlebars.templates`中。
*   如果要以这种方式使用编译，则必须执行以下操作：

* * *

```
Ember.TEMPLATES['posts-template'] = Ember.Handlebars.compile('I am the template');
App.PostsView = Ember.View.extend({
    templateName: 'posts-template'
}); 
```

# javascript - AngularJS 引导导航栏

> ID：15672278
> 
> 赞同：3
> 
> 时间：2013-03-28T00:41:30.483
> 
> 标签：javascript, twitter-bootstrap, angularjs, pug, navbar

我正在尝试显示引导导航栏并删除来自角度控制器的数据中的 html 元素被告。

我有以下玉代码：

```
div.navbar.navbar-fixed-top
    div.navbar-inner
        div.container-fluid(data-ng-controller="NavCtrl")

            a.btn.btn-navbar(data-toggle='collapse', data-target='.nav-collapse')
                span.icon-bar
                span.icon-bar
                span.icon-bar

            div.nav-collapse.collapse
                ul.nav
                    li  
                        a(href='/topics') Topics
                    li(ng-show="curUser.admin")
                        a(href='/users') Users
                    li(ng-show="curUser.admin")
                        a(href='/organizations') Organizations
                    li(ng-show="curUser.admin")
                        a(href='/topicConfs') TopicConfig
                    li.divider
                ul.nav.pull-right
                    {{authenticated}}
                    li.dropdown(ng-show="authenticated")
                        a.dropdown-toggle(role='button', data-toggle='dropdown', href='#') {{curUser.email}}
                            b.caret
                        ul.dropdown-menu(role='menu')
                            li
                                a(href='/users/{{curUser._id}}') Profile
                            li.divider
                            li
                                a.btn(ng-click="logout()") Logout 
```

以及具有以下功能的控制器：

```
function NavCtrl($location, $scope, $rootScope, CurrentUser){
  $scope.curUser = CurrentUser.getUser()
  $scope.authenticated = CurrentUser.isAuthenticated()

  $rootScope.$on('$routeChangeStart', function(){
    $scope.curUser = CurrentUser.getUser()
    $scope.authenticated = CurrentUser.isAuthenticated()
  })

  $scope.logout = function(){
    CurrentUser.logout(function(result){
      $scope.curUser = CurrentUser.getUser()
      $scope.authenticated = CurrentUser.isAuthenticated()
      console.log("authenticated before logout is %j", $scope.authenticated)

      $location.url('/')
    })
  }
} 
```

一切都正确显示，直到`$scope.authenticated`设置为`false`并`$scope.user`设置为`{}`导航栏中没有更新 ng-show 属性的位置。

我需要做什么才能让引导导航元素响应变量的`$scope`变化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T01:22:00.100

当 Angular 的 $scope 属性在 Angular 的“外部”更改时，`$scope.$apply()`需要调用以使 Angular 进入其[摘要循环](http://docs.angularjs.org/guide/concepts#runtime)。投影到当前视图的任何属性都将具有 $watches，摘要循环将对其进行评估。当在其中一个 $watches 中检测到更改时，会更新视图。

Angular 的“外部”示例：

*   浏览器事件回调。例如，
    `element.bind('someEvent', function() {`
        `//need to call scope.$apply in here`
    `})`
*   第三方插件回调。例如，传递给`logout`上面的回调。
*   第三方 AJAX 回调。
*   第三方承诺。

# java - 使用for循环从html中提取数据后，如何将数据一一插入到数据库中？

> ID：15672281
> 
> 赞同：0
> 
> 时间：2013-03-28T00:42:14.133
> 
> 标签：java, html, list

我已经使用 Jsoup 从 HTML 中提取了多个数据，现在我正在尝试使用 netbeans 上的 JDBC 将其一一插入到 derby db 中。

这是我的代码：

```
public String nameOf() {
    String nameStr = null;
    String nameResults = "";

    for(int j=100;j<=110;j++) {
        refNum = j;

        //System.out.println("Reference Number: " + refNum);

        try {                
            //crawl and parse HTML from definition and causes page
            Document docDandC = Jsoup.connect("http://www.abcd.edu/encylopedia/article/000" + refNum + ".htm").get();

            // scrape name data
            Elements name = docDandC.select("title");

            nameStr = name.get(0).text();
            //System.out.println(nameStr);

            nameResults += nameStr + " ";

        } catch (Exception e) {
            //System.out.println("Reference number " + refNum + " does not exist.");
        }            
    }
    return nameResults; 
```

所以这个方法从 10 个不同的 HTML 中获取疾病的名称。我想要做的是一次将一个名称插入到我使用 JDBC 创建的 derby 数据库中。我已经完成了所有设置，剩下要做的就是将每个名称插入名为 DISEASE 的表的相应名称字段中（其中包含字段：id、名称等）。

```
nameResults += nameStr + " "; 
```

这部分也让我担心，因为有些疾病可以有多个词。也许我应该使用某种列表？

请帮忙！提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T01:20:36.847

就像是：

```
public List<String> nameOf() {
    ...
    List<String> nameResults = new ArrayList<String>();
    ...
    nameResults.add(nameStr);
    ...
    return nameResults; 
```

# php - 轮询 Azure 队列返回损坏的管道

> ID：15672282
> 
> 赞同：2
> 
> 时间：2013-03-28T00:42:24.523
> 
> 标签：php, sockets, azure, long-polling, azure-storage-queues

使用**azure-sdk-for-php**长轮询 Azure 队列存储时，如果我的请求相隔超过 30 秒，则库会因以下错误而死：

```
PHP Notice:  fwrite(): send of 277 bytes failed with errno=32 Broken pipe in ..../vendor/pear-pear.php.net/HTTP_Request2/HTTP/Request2/SocketWrapper.php on line 188 
```

如果我将**睡眠**功能设置为 30 秒，一切都会很好，但我会发出很多我不需要的请求。

我的工人代码：

```
use WindowsAzure\Common\ServicesBuilder;
use WindowsAzure\Common\ServiceException;

Class Worker_Task {

    public $queueRestProxy;

    public $servicesBuilder;

    public $connectionString;

    public function __construct() {
        $this->connectionString = Config::get('azure.connection_string');
        $this->servicesBuilder = ServicesBuilder::getInstance();
        $this->queueRestProxy = $this->servicesBuilder->createQueueService($this->connectionString);
    }
    public function emails() {

        $this->write('Processing mails...');

        while(true) {

            $this->queueRestProxy = $this->servicesBuilder->createQueueService($this->connectionString);

            // Get message.
            $listMessagesResult = $this->queueRestProxy->listMessages("emails");
            $messages = $listMessagesResult->getQueueMessages();

            foreach($messages as $message) {

                // Process Message
                $content = json_decode($message->getMessageText());

                // Dispatch Email

                // Delete Job
                $this->deleteJob('emails', $message->getMessageId(), $message->getPopReceipt());
            }

            sleep(30);
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T15:20:52.140

这看起来像过载或超时问题。PHP 库无法写入 Azure 套接字。可能您使用无限循环超出了 Azure 负载限制`while(true) { ... }`。

不要`queueService`在每个循环中创建，因为您会无限关闭和打开梨形套接字。

尝试移动线：

```
$this->queueRestProxy = $this->servicesBuilder->createQueueService($this->connectionString); 
```

之前`while(true) {`：

```
$this->write('Processing mails...');
$this->queueRestProxy = $this->servicesBuilder->createQueueService($this->connectionString);    
while(true) {
        // Get message. 
```

如果这没有帮助，那么`azure-sdk-for-php`库可能错误地使用了套接字机制 - 在[https://github.com/WindowsAzure/azure-sdk-for-php](https://github.com/WindowsAzure/azure-sdk-for-php)上创建新问题或使用此方法：[AzurePHP - Polling an Azure Queue](https://stackoverflow.com/questions/8763515/azurephp-polling-an-azure-queue?rq=1)

# php - 在 php 中调用存储过程后 SQL 查询无法运行

> ID：15672285
> 
> 赞同：1
> 
> 时间：2013-03-28T00:42:37.853
> 
> 标签：php, mysql, stored-procedures

**在我的 php 代码中，我在普通 SQL 之前调用存储过程（链接：SELECT * FROM `TABLE`;）查询运行。对于该存储过程运行，但普通 SQL 无法运行。在这两种情况下我都使用 mysql_query() 。但是当我运行正常的 SQL 时，它会同时运行。**

我有一个具有 mysql_query() 的类 dataManager

这是我的代码：

> ```
> require_once 'DL/DataManager.php'; 
> require_once 'utils/Utils.php';
> require_once 'DL/class/event/Event.php'; 
> ```

```
$Utils = new Utils();
$obj = new Event();

$result = array();

$result = $obj->get_all_event_data("NULL"); //Query =  "CALL events_all_data(" . $ID . ");";

echo date("y-m-d h:i:s")."<br />";

echo $Utils->getString_UserName_ByUserID( "23" )."<br />"; // Not Run   Query = SELECT  `USER_NICK` FROM  `USER_INFO` WHERE  `USER_ID` ='".$string ."';"; 
```

**数据管理器.php**

> ```
> public function openConnection()
> {
>     $this->connection = mysql_connect($this->HostName, $this->UserName, $this->PassWord);
>         if (!$this->connection)
>         {
>                 return mysql_error();
>         }
>         mysql_select_db($this->DataBase);
>         return $this->connection;
> } 
> ```

**执行sql查询**

```
public function retrieveData($Query = "")
{
    //$Query = mysql_real_escape_string($Query);
    //echo "DB retriveData query : ".$Query. " <br />";
    $data = mysql_query($Query);
    $num_rows = mysql_num_rows($data);
    //echo "db ret number : ".$num_rows." asdas: ". "\n";

    if($num_rows)
    {
        $this->Data = array();
        //$i = 0;
        while ($mat[] = mysql_fetch_row($data));
            //echo $mat[$i++][2]."<br />";
        $this->Data = $mat;
        //print_r($this->Data);
    //$result = $this->getArrayTranspose($mat);
    }
    else
    {
        $this->Data = NULL;
    }

    //return $result;

} 
```

**连接关闭**

```
public function closeConnection()
{
    if(!$this->connection)
    {
        mysql_close ();

        return ;
    }
    else if($this->connection == NULL)
    {
        mysql_close ();

        return ;
    }
    else if(!isset($this->connection))
    {
        mysql_close ();

        return ;
    }
    else if(is_resource($this->connection))
    {
        mysql_close($this->connection);
        return ;
    }
    else
    {
        //mysql_close();
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T06:44:46.247

在您的代码中，您没有提到任何地方`$string` 尝试运行这样的查询以获取错误代码。

```
 $mat=mysql_query($query) or die (mysql_error()); 
```

试试看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-03T11:04:35.333

Mysql 错误是：**命令不同步；你现在不能运行这个命令**

# php - 带有数字键的 Reflection::getProperties() 的奇怪行为

> ID：15672287
> 
> 赞同：2
> 
> 时间：2013-03-28T00:43:09.090
> 
> 标签：php, object, reflection, properties

```
$obj = (object)array('a', 'b', 'c');
$refl = new \ReflectionObject($obj);
$props = $refl->getProperties(\ReflectionProperty::IS_PUBLIC | \ReflectionProperty::IS_PROTECTED);    

foreach($props as $prop)
  print $prop->name; 
```

打印一些奇怪的名称，例如`line`,`file`和`line`（而不是 1、2、3）。为什么？我意识到名称是无效的，因为它们是数字，但是为什么我会得到这些随机字符串？

`get_object_vars($obj)`什么都不显示，`print_r((array)$obj)`实际上正确打印了值。

* * *

如果反射不能显示数字属性，有什么办法可以让它忽略它们吗？

* * *

它也发生在许多 SPL 交互器（如`ArrayObject`s、`SplFixedArray`s、`SplHeap`s）上。显然这种行为只存在于某些 PHP 5.3 版本中。PHP 5.4 什么也没显示。

* * *

[相关的 PHP 错误](https://bugs.php.net/bug.php?id=49154)和我对解决方案的看法（[`property_exists`](http://php.net/manual/en/function.property-exists.php)忽略无效名称）：

```
if(version_compare(PHP_VERSION, '5.4') < 0){
  $props = array_filter($props, function($prop) use($obj){
    return !$prop->isPublic() || property_exists($obj, $prop->name);
  });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T00:45:49.400

将数组转换为对象会将数组键转换为属性名称，并将值转换为它们的值。

您的数组有数字键。您的对象具有数字属性。哪些是无效的。

你真的想要：

`$obj = (object) array('a'=> null, 'b' => null, 'c'=> null);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T01:24:09.283

[这是一个无法修复的错误......或奇怪的 php 行为](https://bugs.php.net/bug.php?id=60379)。因此，如果您不确定其中的数字键，则不能使用对象类型转换。使用这样的东西

```
$obj = new \stdClass();
foreach($array as $key=>$value)
    $obj->{$key} = $value; 
```

* * *

您可以从奇怪的 php 行为中使用另一个肮脏的技巧。无需反射即可获取所有属性。

```
$obj = (object) array('a', 'b', 'c');
$obj->{0}='asd';
while (list($field, $value) = each($obj))
    {
    var_dump($field, $value);
    } 
```

我也认为这个问题只发生在 stdClass 对象上。

# c# - 在视图中请求权限是正确的还是应该是MVC中的模型？

> ID：15672288
> 
> 赞同：0
> 
> 时间：2013-03-28T00:43:12.537
> 
> 标签：c#, asp.net-mvc-3

伙计们，我已经阅读了很多关于这件事的帖子，但我还看不到这里的光芒。

在控制器中请求执行/执行或在视图中显示某些内容的权限非常容易，但在模型中执行此操作更复杂，至少是发生在我身上的事情。在控制器中，因为您可以轻松访问会话对象：HttpContext.Current.Session["UserPermissions"] 并且从视图中我可以有一个 sessionmanager 并像这样访问：SessionManager.IsAllowed(Permission.SuperUser) 这也是在控制器中构建。但是我们如何在模型和连接到数据库的业务层中轻松做到这一点呢？

这是我的例子-

当我需要从数据库中获取一些信息并基于用户权限时，我不想用我知道用户无权访问的数据填充对象。

解析视图中的对象并仅显示允许用户查看的项目很容易，但在将它们带到视图之前过滤这些项目不是更好吗？

有人可以向我展示一个示例，其中我实现了一个权限类以在我的所有模型中使用它吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T02:20:21.420

我通常有一个 CurrentUser 类驻留在模型中，我在其中跟踪所有重要的用户属性，例如权限、用户 ID、姓名、电子邮件地址等。将类保留在模型中可以轻松访问控制器，这可能会发生大部分权限检查，具体取决于您的应用程序。这也将允许将 CurrentUser 模型作为视图模型传递给视图。

我根据用户当前在其 CurrentUser 类中的角色来限制视图中的项目，并且仅在必要时将 CurrentUser 对象传递给视图。CurrentUser 类在应用程序启动时被实例化，并且可以根据需要尽可能多地或尽可能少地更新。我正在处理的当前应用程序需要相当频繁地更新用户的角色。

如果角色保存在 CurrentUser 对象中，则可以轻松地检查控制器和模型中的用户权限。实现一个方法，例如（使用 MVC Simple Membership Provider）：

```
bool IsUserInRole(string roleName) {
    if (currentUser != null)
        {
            return currentUser.Roles.Contains(roleName);
        }
} 
```

使您能够检查当前角色，而不管您当前处于 MVC 的哪个部分。

我建议不要将 CurrentUser 传递给数据抽象层（位于数据库顶部的层），而是以可以将访问要求作为参数传入或为每个角色实现单独方法的方式实现方法您可能正在使用的。

# javascript - JavaScript Tic Tac Toe - 查找数组中所有可能的数字组合

> ID：15672290
> 
> 赞同：2
> 
> 时间：2013-03-28T00:43:15.343
> 
> 标签：javascript, html, css, web, tic-tac-toe

我目前正在使用网络（HTML、CSS、Javascript）编写一个基本的井字游戏（多人游戏，无 AI）。游戏逻辑显然都在 Javascript 中。我有个问题。以下是我的代码。

```
window.onload = function () {
    console.log("Page has loaded");
}
var ctx;
var turn = 0;
var winningCombo = [
    [1, 4, 7],
    [2, 5, 8],
    [3, 6, 9],
    [1, 2, 3],
    [4, 5, 6],
    [7, 8, 9],
    [1, 5, 9],
    [3, 5, 7]
];
var playedComboX = [];
var playedComboO = [];
var filledSquares = [0];
var filled = false;
console.log(winningCombo.length);
var checkWinnerX = function () {
    for(var i = 0; i < winningCombo.length; i++) {
        console.log('Its in the X check winner loop');
        if((winningCombo[i][0] == playedComboX[0]) && (winningCombo[i][1] == playedComboX[1]) && (winningCombo[i][2] == playedComboX[2])) {
            alert("Congrats, you have won!");
            return true;
        }
        return false;
    }
}
var checkWinnerO = function () {
    for(var i = 0; i < winningCombo.length; i++) {
        console.log('Its in the 0 check winner loop');
        if(winningCombo[i][0] == playedComboO[0] && winningCombo[i][1] == playedComboO[1] && winningCombo[i][2] == playedComboO[2]) {
            console.log('It has passed the if statement for X');
            alert("Congrats, you have won!");
            return true;
        }
        return false;
    }
}
var checkWinner = function () {}
var draw = function (squareNumber) {
    console.log('draw has been called');
    var squareID = "square" + squareNumber;
    var squareClicked = document.getElementById(squareID);
    ctx = squareClicked.getContext('2d');
    for(var i = 0; i < filledSquares.length; i++) {
        if(filledSquares[i] == squareNumber) {
            filled = true;
        } else {
            filled = false;
        }
    }
    if(filled == true) {
        alert("Invalid Move! Square is already occupied");
    } else {
        filledSquares.push(squareNumber);
        ctx.beginPath();
        if(turn % 2 == 0) {
            //Drawing a 'X'
            ctx.moveTo(20, 20);
            ctx.lineTo(135, 135);
            ctx.moveTo(135, 20);
            ctx.lineTo(20, 135);
            ctx.lineWidth = 6;
            ctx.stroke();
            turn++;
            playedComboX.push(squareNumber);
            checkWinnerX();
        } else {
            //Drawing a Circle
            ctx.arc(75, 75, 65, 2 * Math.PI, false);
            ctx.lineWidth = 6;
            ctx.stroke();
            turn++;
            playedComboO.push(squareNumber);
            checkWinnerO();
        }
    }
} 
```

现在，这些`checkWinner`函数只检查与数组中的数组元素是否完全匹配`winningCombo`（例如：如果组合是`3,1,2`而不是，`1,2,3`则它不会注册）。无论如何我可以检查每个元素中3个数字的所有可能组合吗？希望我的解释有道理，谢谢。

PS：如果任何代码写得不如我好，请原谅我，这是我第一次尝试编写游戏。但要随心所欲！

更新 2：

```
var checkWinnerX = function () {
    for(var i = 0; i < winningCombo.length; i++) {
        console.log('Its in the X check winner loop');
        if((winningCombo[i][0] == sortedArrayX[0]) && (winningCombo[i][1] == sortedArrayX[1]) && (winningCombo[i][2] == sortedArrayX[2])) {
            alert("Congrats, you have won!");
            return true;
        }
        return false;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-19T18:25:35.497

我认为更好的方法是：

```
for(var i = 0; i < winningCombo.length; i++) {
    if ( playedComboO.indexOf(winningCombo[i][0]) >= 0 ) {
        if ( playedComboO.indexOf(winningCombo[i][1]) >= 0 ) {
            if ( playedComboO.indexOf(winningCombo[i][2]) >= 0 ) {
                 //blah blah blah you win whatever
            alert("Congrats, you have won!");
        return true;
            }
       }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T00:47:13.820

在与 winsCombo 比较之前对已播放的数组进行排序。

```
playedComboO.sort(function (a, b) {
    return a - b;
}); 
```

我认为`playedComboO.sort()`(and `playedComboX.sort()`) 也可以工作，但默认排序功能是按字符串而不是按数字。

# javascript - 当鼠标悬停在“谷歌地图标记”上时，如何在保持“标题”值的同时隐藏“标题”？

> ID：15672303
> 
> 赞同：0
> 
> 时间：2013-03-28T00:45:15.387
> 
> 标签：javascript

当鼠标悬停在“谷歌地图标记”上时，如何在保持“标题”值的同时隐藏“标题”？我使用“标签”而不是“标题”来显示标记的标题（使用“google-maps-utility-library-v3”）。但是标记需要标题值。因为标记在内部用于标识“标题”。我应该向谷歌地图开发者询问吗？有人帮帮我。我试过了，但我找不到答案。。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T00:33:02.580

如果你想在信息窗口中隐藏你的标题，你可以使用 CSS 来完成这项工作。

`.bubbleContainer h3{ display:none; }`

当您单击并打开信息窗口时，它将隐藏标题或者您可以使用 javascript 来触发它。

# c++ - winapi c 列表视图

> ID：15672306
> 
> 赞同：0
> 
> 时间：2013-03-28T00:45:38.703
> 
> 标签：c++, winapi, listview

我创建了一个列表视图：

```
ListView = CreateWindow(WC_LISTVIEW, NULL, WS_CHILD | WS_VISIBLE | LVS_REPORT,
            50,50,200,100,
            hwnd, (HMENU) ID_LISTV,
            GetModuleHandle(NULL),
            NULL); 
```

之后我填写数据

之后我想删除所有项目和列。我怎样才能做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-28T00:49:00.533

`LVM_DELETEALLITEMS`您可以使用消息（或关联的宏）清除列表视图的内容：

```
ListView_DeleteAllItems(ListView); 
```

`LVM_DELETECOLUMN`您可以使用该消息删除列。没有办法一次将它们全部删除；你需要一一做。

# php - PHP 表单：不更新 mysql 数据库

> ID：15672308
> 
> 赞同：0
> 
> 时间：2013-03-28T00:45:45.223
> 
> 标签：php, mysql

我几乎没有编程经验并尝试了第一个项目，我有点卡在如何更新数据库上，所以我点击编辑，正确的记录被加载到编辑屏幕 update.php

当我点击更新时，我从updated.php收到消息说数据库已更新，但数据库没有更新，当我显示记录时它们与更新前相同，在此先感谢您的帮助.

以下代码：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>Form Edit Data</title>
</head>

<body>
    <table border=1>
    <tr>
        <td align=center>Form Edit Employees Data</td>
    </tr>
    <tr>
    <td>
        <table>
        <?
        $user_name = "";
        $password = "";
        $database = "";
        $server = "localhost";

        mysql_connect($server, $user_name, $password);
        $db_found = mysql_select_db($database);
        $id = $_GET['id'];
        $order = "SELECT * FROM MY_ID where ID = ' " .$id . " ' ";
        $result = mysql_query($order);
        $row = mysql_fetch_array($result);
        ?>
        <form method="post" action="edit_data.php"?id=<?= $id ?>>
            <input type="text" name="id" value="<? echo "$row[ID]"?>">
            <tr>        
                <td>First Name</td>
                <td>
                    <input type="text" name="FirsName" size="20" value="<? echo "$row[FirstName]"?>">
                </td>
            </tr>
            <tr>
                <td>Sur Name</td>
                <td>
                    <input type="text" name="SurName" size="40" value="<? echo "$row[SurName]"?>">
                </td>
            </tr>
            <tr>
                <td>Address</td>
                <td>
                    <input type="text" name="Address" size="40" value="<? echo "$row[Address]"?>">
                </td>
            </tr>
            <tr>
                <td align="right">
                    <input type="submit" name="submit" value="submit">
                </td>
            </tr>
        </form>
        </table>

    </td>
    </tr>
    </table>
</body>
</html> 
```

这是另一个文件

```
<?php
$user_name = "";
$password = "";
$database = "";
$server = "";

mysql_connect($server, $user_name, $password);
$db_found = mysql_select_db($database);

$id = $_REQUEST['ID'];
$FirstName = trim(mysql_real_escape_string($_POST["FirstName"]));
$SurName = trim(mysql_real_escape_string($_POST["SurName"]));
$Address = trim(mysql_real_escape_string($_POST["Address"]));

$sql = "UPDATE MY_ID SET FirstName='$FirstName',SurName='$SurName',Address='$Address' WHERE ID='$id'";
$result=mysql_query($sql);

if ($result){
    echo "Successful";
    echo "<BR>";
    echo "<a href='edit.php'>View result</a>";
}
else {
    echo "ERROR";
}

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T00:49:45.863

看起来你忘记了双引号和句号。你应该把它写成：'".$example."'

```
$sql = "UPDATE MY_ID SET FirstName='".$FirstName."',SurName='".$SurName."',Address='".$Address.:' WHERE ID='".$id."'"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T00:54:17.287

这是因为您的表单方法是`POST`，并且您正在尝试`GET`ID。可能 ID 返回 null。我的建议是在你的表单中放置一个隐藏的输入`name="ID"`，然后在你发布的页面中阅读它`$_POST["ID"];`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T01:16:31.567

是的，答案正如曼苏尔所说。您不应该对变量使用单一配额。

因此，编写如下代码是一种不好的做法：

```
<input type="text" value="<?php echo "$row[name]"; ?>"> 
```

它应该是

```
<input type="text" value="<?php echo $row['name']; ?>"> 
```

很清楚，并且在插入或更新记录时，您应该编写如下：

```
$sql = "UPDATE MY_ID SET FirstName='" . $FirstName . "',
                         SurName='" . $SurName . "',
                         Address='" . $Address . "' 
         WHERE ID='" . $id . "'";
mysql_query($sql); 
```

# random - 简单快速的随机素数生成器？

> ID：15672310
> 
> 赞同：0
> 
> 时间：2013-03-28T00:45:46.897
> 
> 标签：random, generator, primes

我知道有许多素数发生器，例如 Eratosthenes 或 Atkin 的筛子。但它们会按顺序生成数字，从小数字开始。我可以使用什么方法来获取间隔中的素数而不从较小的开始？

一个选项可能是使用随机数生成器并使用素数测试、确定性或概率性测试输出，具体取决于我想要实现的目标。无论如何，测试将是缓慢而复杂的。

是否有任何快速简便的方法可以不连续地生成素数？一个伪素数生成器也可以。

问候

* * *

我更清楚地重写了这个问题：

我怎样才能在给定的间隔内生成素数，而无需： - 从较小的顺序到最大的（与 Erathostenes 筛一样） - 也不对随机序列使用慢概率素数测试？

是否有任何 FAST 和 EASY 算法或函数以这样的方式生成数字，如果你长时间运行它，你会得到一个区间内的所有素数？（我不介意它是否也会产生一些复合材料）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T13:46:52.663

如果区间不是太大，区间的低端又不是太高，可以使用分段的埃拉托色尼筛；“太大”和“太高”的定义取决于你的抱负和耐心，但任何大于 10^15 的东西都不太可能成功。否则，您可以在所需的间隔中选择一个随机奇数，测试它的素数，如果它是素数则保留它或尝试下一个更大的奇数，继续直到找到素数；如果您愿意，可以通过使用质数轮生成候选质数来加快速度，而不仅仅是测试下一个奇数。没有第三种选择。

你说过如果这个数字是复合的，你不会太介意。在这种情况下，您可以生成一个随机奇数，仅针对以 2 为基数且没有其他基数的强伪素数对其进行测试，如果测试表明它是素数，则保留它，或者如果测试表明它是，则使用下一个奇数重试合成的。这不是一个完美的素数测试，但它比 Miller-Rabin 测试的 25 个随机碱基测试更快，并且比 Lucas 伪素测试更快，并且可能足以满足您的目的。

您可以通过在 Stack Overflow 上搜索或查看[我的博客](http://programmingpraxis.com/contents/themes/#Prime%20Numbers)来找到所有这些内容的描述，或者如果您有其他具体问题，也可以在这里提问。

# scala - Scala中的类型别名有序泛型

> ID：15672312
> 
> 赞同：8
> 
> 时间：2013-03-28T00:45:53.023
> 
> 标签：scala, generics, comparable, type-alias

我对二叉树的外观有一个最小的定义：

```
type Tree[T] = Option[Node[T]]
case class Node[T](left: Tree[T], entry: T, right: Tree[T]) 
```

我现在想将二叉**搜索**树定义为：

```
type BST[T: Ordering] = Tree[T] 
```

但这不会编译。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-28T01:38:33.370

你得到的编译错误基本上说*上下文边界*不能用于类型别名。上下文边界确实在函数或类定义中起作用。例如，

```
class BST[T: Ordering](val tree: Tree[T]) 
```

实际上是简写符号

```
class BST[T](val tree: Tree[T])(implicit ordering: Ordering[T]) 
```

请注意，不同的`BST`对象可能具有不同`Ordering`的 s，并且这些值必须在运行时存储。

对于您的用例，最简单的方法可能是将上下文绑定到您想到的通用函数上，

```
def f[T: Ordering](t1: Tree[T], t2: Tree[T]) {
  import scala.math.Ordering.Implicits._
  t1.get.entry < t2.get.entry
} 
```

然后将在类型已知`Ordering[T]`的 的调用站点找到适当的隐式。`f``T`

# php - 按顺序从两个保持值中构建新数组

> ID：15672313
> 
> 赞同：-2
> 
> 时间：2013-03-28T00:45:55.000
> 
> 标签：php, html

我有两个数组：

```
a:
Array
(
    [0] => 2
    [1] => 5
)

b:
Array
(
    [0] => Sentry
    [1] => Maxima
) 
```

我正在尝试获得一个看起来像这样的新数组

```
c:
Array
(
    ["Sentry"] => 2
    ["Maxima"] => 5
) 
```

碰巧每个数组中的第 0 和第 1 个元素排列得很好，如果我可以将它们放在同一个数组中，我认为我可以继续。我尝试手动执行此操作（尽管我更喜欢使用 for 循环）：

```
$c[] = $b[0] => $a[0] 
```

但显然这是错误的。

结果是：

> 解析错误：语法错误，第 7 行 C:\xampp\htdocs\xampp\mine\complex_csv\to_array.php 中的意外 '=>' (T_DOUBLE_ARROW)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T03:59:07.370

您可以使用[array_combine](http://php.net/manual/en/function.array-combine.php "array_combine")

```
<?php

$a = array(2, 5);
$b = array('Sentry', 'Maxima');

print_r(array_combine($b, $a)); 
```

# objective-c - 搜索大量文本的 iOS 应用

> ID：15672315
> 
> 赞同：3
> 
> 时间：2013-03-28T00:46:19.813
> 
> 标签：objective-c, cocoa-touch, search

如果这是重复，我深表歉意，但老实说，我已尽我最大的努力对此进行研究，但并没有想出太多。

我正在制作一个 iPad 参考应用程序，它可以搜索几本大型教科书（可能总共 3-4k 页）。这是一个相当简单的想法：用户可以选择任何文本组合进行搜索，输入他的词条，应用程序将在所有文本中找到这些词条并将它们返回，并在表格视图中进行索引。

视图控制器有一系列开关，它们的值通过方法读取到 NSSet 中并传递给搜索控制器。那部分有效。

我有一个 SearchController 类，视图控制器实例化并调用一个方法：

```
-(void)performSearchWithString:(NSString *)searchString andTexts:(NSSet *)texts
{
for (id book in texts) {
    if ([book isEqual:kBook1]){
        NSError *error = nil;
        NSURL *url = [[NSBundle mainBundle] URLForResource:@"neiJing" withExtension:@"txt"];
        NSString *text = [NSString stringWithContentsOfURL:url encoding:NSStringEncodingConversionAllowLossy error:&error];
        [text enumerateSubstringsInRange:NSMakeRange(0, [text length])
                                 options:NSStringEnumerationByWords
                              usingBlock:^(NSString *substring, NSRange substringRange, NSRange enclosingRange, BOOL *stop) {
                                  NSRange found = [substring rangeOfString:text];
                                  if (found.location != NSNotFound) {
                                      NSLog(@"%@", substring);
                                  } else {
                                      NSLog(@"Not found");
                                  }
                              }];
    } 
```

我似乎已经成功地枚举了所有文本中的每个单词，但没有找到返回值，所以我得到了一个永无止境的“未找到”流。

我在每个我知道肯定存在的文本中插入了一个测试短语，但它没有出现。

我有一种感觉，这一切都错了。即使我完成了这项工作，对于可用的应用程序而言，性能影响可能太大了......我仍在尝试将我的头绕在块上。我只是没有找到任何现成的解决方案来搜索大量文本并挑选结果。如果有人对我可能改编的开源库有任何提示或参考，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T01:00:26.027

看起来您正在搜索传递给块的每个子字符串内的整个文本。此行是问题所在（并导致保留周期）：

```
NSRange found = [substring rangeOfString:text]; 
```

代码需要寻找它可以找到的东西：

```
NSString *findMe = @"A string we expect to find";        
[text enumerateSubstringsInRange:NSMakeRange(0, [text length])
                         options:NSStringEnumerationByWords
                      usingBlock:^(NSString *substring, NSRange substringRange, NSRange enclosingRange, BOOL *stop) {
                                  if ([findMe isEqualToString:substring] ) {
                                      NSLog(@"Found %@", substring);
                                  } else {
                                      NSLog(@"Not found");
                                  }
                              }]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T01:27:18.093

我不认为代码块是你想要的。它遍历文本中的每个单词，并且您想要找到所有搜索字符串。这是一个基于最后一次成功匹配设置新搜索范围的循环。

```
-(void)performSearchWithString:(NSString *)searchString andTexts:(NSSet *)texts
{
for (id book in texts) {
    if ([book isEqual:kBook1]){
        NSError *error = nil;
        NSURL *url = [[NSBundle mainBundle] URLForResource:@"neiJing" withExtension:@"txt"];
        NSString *text = [NSString stringWithContentsOfURL:url encoding:NSStringEncodingConversionAllowLossy error:&error];

        NSRange searchRange = NSMakeRange(0, [text length]);
        NSRange match = [text rangeOfString:searchString options:0 range:searchRange];
        while (match.location != NSNotFound) {

            // match is the range of the current successful match
            NSLog(@"matching range -- %@", NSStringFromRange(match));

            NSUInteger locationOfNextSearchRange = NSMaxRange(match);
            searchRange = NSMakeRange(locationOfNextSearchRange, [text length] - locationOfNextSearchRange);
            match = [text rangeOfString:searchString options:0 range:searchRange];
        }
    }
} 
```

# google-app-engine - 更新数据存储中的实体的成本（并且可能附加属性）？

> ID：15672318
> 
> 赞同：1
> 
> 时间：2013-03-28T00:46:32.630
> 
> 标签：google-app-engine, google-cloud-datastore

我有一个两部分的问题。

假设我有一个具有 blob 属性的实体...

```
# create entity

Entity(ndb.Model):
    blob = ndb.BlobProperty(indexed=False)

e = Entity()
e.blob = 'abcd'
e_key = e.put()

# update entity

e = e_key.get()
e.blob += 'efg'
e.put() 
```

所以问题是：

1.  我第一次 put() 那个实体时，成本是 2 Write Ops；如上例所示，更新实体需要多少 Ops？

2.  当我向属性添加“efg”时，必须先将旧属性读入内存，应用引擎是否提供了一种无需先读取旧值即可追加旧值的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T00:57:28.357

没有部分更新。每次覆盖整个实体。索引的数量也会对成本产生影响。您可能想查看[https://developers.google.com/appengine/articles/life_of_write](https://developers.google.com/appengine/articles/life_of_write) 以详细了解发生的情况。

# php - 用 PHP 保存 JS 输出

> ID：15672320
> 
> 赞同：1
> 
> 时间：2013-03-28T00:46:40.520
> 
> 标签：php, javascript, output

我想保存 JavaScript 代码的输出/结果。例如：

```
<script>document.write(navigator.appVersion)</script> 
```

对于 PHP，我没有问题：

```
$ip = $_SERVER['REMOTE_ADDR']; 
$file = "log.txt"; 
$open = fopen($file, "a+"); 
```

然后写：

```
fwrite($open, "<b>IP Address:</b> " .$ip . "<br/>"); 
```

现在我想用同样的方法写出 JavaScript 的结果。

当然这是行不通的：

```
fwrite($open, "<script>document.write(navigator.appVersion)</script>"); 
```

有什么帮助吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T00:50:11.490

如果您需要获取有关用户浏览器的信息，请使用 PHP 函数。除非您使用 Ajax 将其发回，否则您无法从 PHP 获取 Javascript 输出。

要使用 PHP 获取浏览器信息，请使用[`get_browser()`](http://php.net/manual/en/function.get-browser.php)

# html - 文本落在右列的底部

> ID：15672323
> 
> 赞同：0
> 
> 时间：2013-03-28T00:46:56.280
> 
> 标签：html, css

我希望有人可以帮助，我无法解决这个问题。我正在使用 _s 模板创建一个 wordpress 主题，但我的右栏有问题。

如果我只插入一堆换行符，则流程是正确的。但是，只要我插入任何文本、img 或其他任何内容，该数据就会低于中心列。

我知道这很简单，我只是没有看到。

这是该页面的链接。 [http://juststin.com/test/help.html](http://juststin.com/test/help.html)

这是CSS

```
.content-area {
        float: left;
}
.site-content {
        margin: 0 20%;
        width: 60%;
        -moz-border-radius: 25px 25px;
        border-radius: 25px 25px;
        border-width: 5px;
        border-style: solid;
        border-color: #333333;
        background: #ffffff;
}
.pictures {
        margin: 0 81%;
        width: 20%;
        -moz-border-radius: 25px 25px;
        border-radius: 25px 25px;
        border-width: 2px;
        border-style: solid;
        border-color: #ffffff;
        background: #ffffff;
}
.site-main .widget-area {
        float: left;
        margin: 0 0 0 -100%;
        width: 20%;
        background: #2E9AFE;
        background: #333333;
}
.site-footer {
        clear: both;
        width: 100%;
        background: #ffffff;
        -moz-border-radius: 25px 25px;
        border-radius: 25px 25px;
        border-width: 5px;
        border-style: solid;
        border-color: #333333;
}
.site-header {
        clear: both;
        width: 100%;
        background: #ffffff;
        -moz-border-radius: 25px 25px;
        border-radius: 25px 25px;
        border-width: 5px;
        border-style: solid;
        border-color: #333333;
}

.menu-div {
        border-width: 2px;
        border-style: solid;
        border-color: #ffffff;
        background-color: #ffffff;
        -moz-border-radius: 25px 25px;
        border-radius: 25px 25px;
        overflow: visible;
}

#page {
        width: 90%;
        margin: 0 auto;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T01:55:06.443

您确实需要对列布局标记进行一些更改。我对您的标记和 css 进行了一些编辑以使其正常工作（我不建议您使用它。）。看看[http://pastebin.com/raw.php?i=hqi0MLTc](http://pastebin.com/raw.php?i=hqi0MLTc)

题外话：就我个人而言，我更喜欢对侧边栏/左右列使用固定宽度，仅对内容区域使用流动宽度。

希望这对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T00:58:46.607

问题是你奇怪的列布局。给`margin-left -100%`你`.widget-area`而不是仅仅在你的`#primary`专栏之前呈现它。您的`#pictures`列没有浮动，因此它在100% 的`#primary`容器之后流动。`width`

选项 1) 将列放在应该去的地方，不要使用负边距。

`#primary`选项 2) 为(看起来大约 60% ) 分配一个固定宽度并`#pictures`向左浮动

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T21:25:51.327

问题最终是我不得不减小右侧栏的大小。我猜测添加边框会将尺寸增加到 100% 以上。

# qt - TCP 套接字通信被破坏

> ID：15672324
> 
> 赞同：0
> 
> 时间：2013-03-28T00:46:58.760
> 
> 标签：qt, tcp, qtcpsocket

我正在尝试使用 TCP 服务器并使用 QTcpSocket 客户端连接到它。大多数时候，服务器和客户端碰巧在同一台机器上，但这不是必需的。我想要做的是将文件从正在运行的多线程进程传输到想要共享服务器和客户端使用的信息的 GUI。

连接等似乎很好。事实上，这段代码似乎在很长一段时间内都能完美运行，但现在我在不同的硬件上运行它，在 Ubuntu 12.04 而不是 10.04 上，我偶尔会在收到的代码中嵌入杂散字节——通常（但不是总是）空值。我无法弄清楚出了什么问题，并欢迎任何建议。

这是读取我的文件并将字节发送到连接的客户端的服务器部分：

```
int fileSize;
                printf(" about to open the file\n");
                ini_fd = fopen (rov_ini_file_name, "r");

                if(!ini_fd){
                    break;
                }
                fseek(ini_fd,0,SEEK_END);
                fileSize = ftell(ini_fd);
                fseek(ini_fd,0,SEEK_SET);
                int totalBytesSent =0;
                int line = 0;
                int len;
                while (!feof (ini_fd))
                    {
                    ch = fgets (&(my_line[0]), MAX_CHARACTER_COUNT - 1, ini_fd);
                    if (ch){
                        len = strlen(&(my_line[0]));
                        bytes_sent = sendto(tio.my_tio_port_table_entry.to_sock, 
                        &(my_line[0]), 
                        len, 
                        0, 
                        (struct sockaddr *) (&(tio.my_tio_port_table_entry.ToAddr)), 
                        sizeof (tio.my_tio_port_table_entry.ToAddr));
                        totalBytesSent += bytes_sent;
                        line++;
                        //printf(" line %d bytes sent = %d total bytes = %d\n",line,bytes_sent,totalBytesSent);
                    }
                }
                len = sprintf(&(my_line[0]),"END_OF_INI_FILE");
                bytes_sent = sendto(tio.my_tio_port_table_entry.to_sock, 
                        &(my_line[0]), 
                        len, 
                        0, 
                        (struct sockaddr *) (&(tio.my_tio_port_table_entry.ToAddr)), 
                        sizeof (tio.my_tio_port_table_entry.ToAddr));

                tio.my_tio_port_table_entry.connected = FALSE;
                break; 
```

这是我读取正在发送的数据的地方。这是连接到 readyRead 信号的插槽

```
 void    AlvGUI::readIniFromServer()
{

  QByteArray inArray(iniClient->bytesAvailable(),0);

  if(!iniStarted)
    {
      tempIniFile = new QTemporaryFile;
      if(tempIniFile->open())
        {
          iniStarted = true;
        }
      else
        {
          // error should be here!
        }

    }

  int bytesRead = iniClient->read(inArray.data(),inArray.size());
  int endLoc = inArray.lastIndexOf("END_OF_INI_FILE");
  if(-1 != endLoc)
    {
      inArray.chop(endLoc);
      bytesRead = endLoc;
      iniFinished = true;
    }
  tempIniFile->write(inArray.data(),bytesRead);
  if(iniFinished)
    {
      tempIniFile->flush();
      tempIniFile->close();
      iniFile.close_ini();
      char *theTempFile = strdup((char *)tempIniFile->fileName().toAscii().data());
      iniFile.open_ini(theTempFile);
      gotIni = true;
      iniRequestTimer->stop();
      makeGui();
      free(theTempFile);
      hotelSetup = true;
      iniClient->abort();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T01:47:00.860

像往常一样，问一个问题会让我更深入地挖掘。我没有 tcp 服务器问题——我确认通过使用 telnet 连接到我的服务器，然后将输出重定向到一个文件——这是完美的

所以我更深入地研究了我的代码，而不是截断保存在 QtByteArray 中的传入数据，而是截断它——这会从 QtByteArray 的末尾读取字节数。除了当我使用 QtByteArray 的 data() 成员函数时，我只是得到一个 char 指针，因此可以访问所有数据。数据在我做chop()的地方被破坏了

# c++ - C ++：类之间的“未解决的重载函数类型”

> ID：15672325
> 
> 赞同：2
> 
> 时间：2013-03-28T00:46:58.753
> 
> 标签：c++, class, function, pointers

这可能是基本的东西，我有一个来自一个类（称为`cell`）的函数，其标识符`woo_func_ptr`采用指向`void`不带参数的类型函数的指针（`void (*void_ptr)(void)`）（我`typedef`）。在另一个类中，我有一个对象，`cell`我使用方法`woo_func_ptr`。它不允许我这样做，我在上面的标题中得到了错误。如果这两个函数没有嵌入到一个类中，它们就可以正常工作

```
typedef void (*void_ptr)(void);

double WOO{0};

struct cell {
void woo_func_ptr(void_ptr jo)
{
    jo();
}
};

class woosah
{
public:
void woo_func()
{
    WOO+=rand();
    std::cout << WOO << std::endl;
};

void run()
{
    // other stuff
    temp_cell.woo_func_ptr(woo_func);
    // yet more stuff
}

cell temp_cell;
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T01:20:23.880

首先，指向 woosah 成员函数的指针应声明为

```
 typedef void (woosah::*void_ptr)(void); 
```

然后编译器会抱怨它在解析这个语句时需要查看 woosah 定义。

如果您让编译器首先通过向上移动类 woosah 来解析它，那么它会抱怨未定义类型单元（因为它包含在 woosah 中）。由于解析时的循环依赖，这仍然无法解决您的问题。

解决循环依赖的一种方法是使**temp_cell**成为指向单元实例的指针，并将其包含在 woosah 中。

另请注意，调用成员函数的语法是使用 .* 或 ->*

```
 void run()
      {
          // other stuff
          temp_cell->woo_func_ptr(temp_cell->*woo_func); // assuming temp_cell is pointer to some cell instance
         // yet more stuff
       } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-28T00:51:44.003

成员函数不同于常规函数。这就是为什么有一个单独的“指向成员函数的指针”类型。这是因为成员函数传递了隐式`this`指针。

事实上，标准甚至（严重）限制了指向成员函数的指针的转换。

这就是你错误的根源。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-28T01:11:04.080

[http://msdn.microsoft.com/en-us/library/b0x1aatf(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/b0x1aatf(v=vs.80).aspx)显示了类似的错误及其修复。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-28T01:16:33.377

您可以使用静态类函数...

改变

```
void woo_func() 
```

到

```
static void woo_func() 
```

如果您尝试访问特定对象的数据成员，这可能不是您想要的。

成员函数有点特殊，不应被视为普通函数。

# excel - Excel时间序列数据图

> ID：15672328
> 
> 赞同：2
> 
> 时间：2013-03-28T00:47:12.593
> 
> 标签：excel, charts, time-series

我正在尝试绘制一些时间序列数据，但到目前为止，这让我很难过。这里的突出部分是每个数据点都与一个开放日期和一个关闭日期相关联。我想要一个时间序列折线图来计算给定日期打开的数量。

*   示例：打开 - 关闭
*   第一条记录：2/10/2013 - 3/1/2013
*   第二条记录：2/15/2013 - 3/5/2013

我正在寻找的图表将从 0 开始，在 2/10 上升到 1 在 2/15 再次上升到 2，然后在 3/1 下降 1 并在 3/5 回到 0。

实际数据集包含数百条记录，因此无法手动处理。我敢肯定一定有一个简单的方法来做到这一点，但我还没有找到它。尝试了帮助和谷歌搜索，但我不确定我在寻找什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T01:28:43.003

像这样使用`CountIfs()`函数：

![日期参数的 CountIfs](../Images/a1268627dcd7af7e97e8c01bae239835.png)

因此，您指定类别标签，然后使用该`COUNTIFS()`函数评估每个类别标签当时打开的记录数。

您可以将 Countifs 函数的结果用作直方图、时间序列、条形图等的频率。

然后，在 E 和 F 列中绘制数据（或者您的工作表恰好是排列的）以创建图表。

**编辑**

要在计数中包含空白值，请修改公式：

`=COUNTIFS($B$3:$B$7,"<="&E3,$C$3:$C$7,">="&E3)+COUNTIFS($B$3:$B$7,"<="&E3,$C$3:$C$7,"")`

# php - PHP反序列化和访问数组

> ID：15672332
> 
> 赞同：0
> 
> 时间：2013-03-28T00:47:39.933
> 
> 标签：php, arrays, serialization

我有一些想要序列化的复杂数据。

当我试图反序列化它时，我得到的只是：

```
bool(false) bool(false) bool(false) bool(false) bool(false) bool(false) bool(false) bool(false) bool(false) bool(false)...etc... 
```

这是序列化的字符串：

```
a:6:{i:0;a:10:{s:6:"ItemID";s:1:"1";s:11:"ItemEventID";s:1:"1";s:7:"ItemCat";s:3:"REG";s:8:"ItemName";s:21:"Inscrição Masculina";s:8:"ItemCost";s:4:"9.00";s:12:"ItemCurrency";s:3:"EUR";s:8:"ItemFree";s:1:"N";s:9:"ItemStart";s:9:"2013-1-12";s:7:"ItemEnd";s:8:"2013-4-7";s:7:"ItemQty";s:1:"1";}i:1;a:10:{s:6:"ItemID";s:1:"3";s:11:"ItemEventID";s:1:"1";s:7:"ItemCat";s:3:"REG";s:8:"ItemName";s:36:"Inscrição Feminina (oferta jersey)";s:8:"ItemCost";s:4:"9.00";s:12:"ItemCurrency";s:3:"EUR";s:8:"ItemFree";s:1:"N";s:9:"ItemStart";s:9:"2013-1-12";s:7:"ItemEnd";s:8:"2013-4-7";s:7:"ItemQty";s:1:"0";}i:2;a:10:{s:6:"ItemID";s:1:"4";s:11:"ItemEventID";s:1:"1";s:7:"ItemCat";s:3:"MLS";s:8:"ItemName";s:8:"Almoços";s:8:"ItemCost";s:4:"5.00";s:12:"ItemCurrency";s:3:"EUR";s:8:"ItemFree";s:1:"N";s:9:"ItemStart";s:9:"2013-1-12";s:7:"ItemEnd";s:8:"2013-4-7";s:7:"ItemQty";s:1:"0";}i:3;a:10:{s:6:"ItemID";s:2:"13";s:11:"ItemEventID";s:1:"1";s:7:"ItemCat";s:3:"MDS";s:8:"ItemName";s:16:"Jersey Masculino";s:8:"ItemCost";s:5:"10.00";s:12:"ItemCurrency";s:3:"EUR";s:8:"ItemFree";s:1:"N";s:9:"ItemStart";s:9:"2013-1-13";s:7:"ItemEnd";s:8:"2013-4-7";s:7:"ItemQty";s:1:"0";}i:4;a:10:{s:6:"ItemID";s:2:"14";s:11:"ItemEventID";s:1:"1";s:7:"ItemCat";s:3:"MDS";s:8:"ItemName";s:35:"Calção Ciclismo Alusivo ao Evento";s:8:"ItemCost";s:5:"28.00";s:12:"ItemCurrency";s:3:"EUR";s:8:"ItemFree";s:1:"N";s:9:"ItemStart";s:9:"2013-1-16";s:7:"ItemEnd";s:8:"2013-4-7";s:7:"ItemQty";s:1:"0";}i:5;a:10:{s:6:"ItemID";s:2:"11";s:11:"ItemEventID";s:1:"1";s:7:"ItemCat";s:3:"DSC";s:8:"ItemName";s:72:"Desconto de 1€ por ter licença de Competição/Betetista/Cicloturista";s:8:"ItemCost";s:5:"-1.00";s:12:"ItemCurrency";s:3:"EUR";s:8:"ItemFree";s:1:"N";s:9:"ItemStart";s:9:"2013-1-13";s:7:"ItemEnd";s:8:"2013-4-7";s:7:"ItemQty";s:1:"0";}} 
```

我正在尝试使用这个：

```
$temp = unserialize(utf8_encode($dataArr[6]));
var_dump($temp); 
```

在这个站点中，当我粘贴我的序列化数据时，一切都很好：

[http://www.unserialize.com/s/4bc6dd21-e7ab-8189-ba1d-00002a57a4cb](http://www.unserialize.com/s/4bc6dd21-e7ab-8189-ba1d-00002a57a4cb)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T01:03:04.993

您必须删除`utf8_encode`.

如果`$dataArr`是您的字符串，那么您必须在访问数组中的变量之前对其进行反序列化。

```
$dataArr = 'a:6:{i:0;a:10:{s:6:"ItemID";s:1:"1";s:11:"ItemEventID";s:1:"1";s:7:"ItemCat";s:3:"REG";s:8:"ItemName";s:21:"Inscrição Masculina";s:8:"ItemCost";s:4:"9.00";s:12:"ItemCurrency";s:3:"EUR";s:8:"ItemFree";s:1:"N";s:9:"ItemStart";s:9:"2013-1-12";s:7:"ItemEnd";s:8:"2013-4-7";s:7:"ItemQty";s:1:"1";}i:1;a:10:{s:6:"ItemID";s:1:"3";s:11:"ItemEventID";s:1:"1";s:7:"ItemCat";s:3:"REG";s:8:"ItemName";s:36:"Inscrição Feminina (oferta jersey)";s:8:"ItemCost";s:4:"9.00";s:12:"ItemCurrency";s:3:"EUR";s:8:"ItemFree";s:1:"N";s:9:"ItemStart";s:9:"2013-1-12";s:7:"ItemEnd";s:8:"2013-4-7";s:7:"ItemQty";s:1:"0";}i:2;a:10:{s:6:"ItemID";s:1:"4";s:11:"ItemEventID";s:1:"1";s:7:"ItemCat";s:3:"MLS";s:8:"ItemName";s:8:"Almoços";s:8:"ItemCost";s:4:"5.00";s:12:"ItemCurrency";s:3:"EUR";s:8:"ItemFree";s:1:"N";s:9:"ItemStart";s:9:"2013-1-12";s:7:"ItemEnd";s:8:"2013-4-7";s:7:"ItemQty";s:1:"0";}i:3;a:10:{s:6:"ItemID";s:2:"13";s:11:"ItemEventID";s:1:"1";s:7:"ItemCat";s:3:"MDS";s:8:"ItemName";s:16:"Jersey Masculino";s:8:"ItemCost";s:5:"10.00";s:12:"ItemCurrency";s:3:"EUR";s:8:"ItemFree";s:1:"N";s:9:"ItemStart";s:9:"2013-1-13";s:7:"ItemEnd";s:8:"2013-4-7";s:7:"ItemQty";s:1:"0";}i:4;a:10:{s:6:"ItemID";s:2:"14";s:11:"ItemEventID";s:1:"1";s:7:"ItemCat";s:3:"MDS";s:8:"ItemName";s:35:"Calção Ciclismo Alusivo ao Evento";s:8:"ItemCost";s:5:"28.00";s:12:"ItemCurrency";s:3:"EUR";s:8:"ItemFree";s:1:"N";s:9:"ItemStart";s:9:"2013-1-16";s:7:"ItemEnd";s:8:"2013-4-7";s:7:"ItemQty";s:1:"0";}i:5;a:10:{s:6:"ItemID";s:2:"11";s:11:"ItemEventID";s:1:"1";s:7:"ItemCat";s:3:"DSC";s:8:"ItemName";s:72:"Desconto de 1€ por ter licença de Competição/Betetista/Cicloturista";s:8:"ItemCost";s:5:"-1.00";s:12:"ItemCurrency";s:3:"EUR";s:8:"ItemFree";s:1:"N";s:9:"ItemStart";s:9:"2013-1-13";s:7:"ItemEnd";s:8:"2013-4-7";s:7:"ItemQty";s:1:"0";}}';

$temp = unserialize($dataArr);

//Now you can access every element with its index.
var_dump($temp[0]);
var_dump($temp[1]);
var_dump($temp[2]);
var_dump($temp[3]);
var_dump($temp[4]);
var_dump($temp[5]); 
```

# java - 如何使用 Smack XMPP API 处理（失败的）登录尝试

> ID：15672342
> 
> 赞同：2
> 
> 时间：2013-03-28T00:48:48.053
> 
> 标签：java, authentication, login, xmpp, smack

我正在开发一个基于 XMPP 和 Smack API 的聊天服务器，它连接到一个 Openfire 服务器（由一个也和我一起开发的朋友托管）。

所以，我几天前才开始编程（OS X 10.8 上的 Netbeans），今天我继续讨论连接和登录方面。

我可以通过正确选择用户名+密码完美登录：P 但我不知道如何处理无效的登录尝试并让应用程序显示一条消息，然后允许用户重试。

这是我的代码，它在用户按下我的 Swing JForm 中的按钮后触发：

（注意：XMPPConnection 对象已在另一个类中创建，并且已与服务器建立连接。您可以看到我正在从另一个类中调用该对象）

```
private void btnIniciarSesionActionPerformed(java.awt.event.ActionEvent evt) {                                                 
    String Usuario = txtUsuario.getText();
    String Password = new String (pwdContrasena.getPassword());

    if (Usuario.equals("") || Password.equals("")){
        // Missing data
        JOptionPane.showMessageDialog(null, "Missing data");
    }
    else{
        //Try to login
        try{
            Proyecto_chat.conexion.login(Usuario, Password, "x");
        }
        catch (XMPPException ex){
            Logger.getLogger(Ventana_login.class.getName()).log(Level.SEVERE, null, ex);
            // Problem
        }
        if (Proyecto_chat.conexion.isAuthenticated() == true){  //Login has been successful
            jLabel1.setVisible(false);
            System.out.println("Authenticated as " + Usuario);
            JOptionPane.showMessageDialog(null, "Authenticated as " + Usuario);
            //Exit login window and carry on  
        }
        else{
            JOptionPane.showMessageDialog(null, "login error");
        }
    }
} 
```

我应该玩我得到的那个例外吗？->

```
SEVERE: null
SASL authentication DIGEST-MD5 failed: not-authorized: 
at org.jivesoftware.smack.SASLAuthentication.authenticate(SASLAuthentication.java:337)
at org.jivesoftware.smack.XMPPConnection.login(XMPPConnection.java:203)
at proyecto_chat.Ventana_login.btnIniciarSesionActionPerformed(Ventana_login.java:159)
at proyecto_chat.Ventana_login.access$100(Ventana_login.java:15)
at proyecto_chat.Ventana_login$2.actionPerformed(Ventana_login.java:73)
at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:2018)
(...) more lines that I think are not critical for this 
```

由于密码以纯文本形式存储（大学项目，所以没关系）以简化从应用程序内部更改它们，我可以从客户端计算机连接到数据库（远程服务器中的 PostgreSQL），并检查密码并且只如果用户和密码匹配，则执行“conexion.login”，但那将是......你知道......错了

在网上四处寻找没有运气之后，我决定去这里，问问，睡觉，第二天早上醒来，提出一些建议；）感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T13:13:27.377

不确定我是否理解您的要求，但如果是“我如何确定 Smack 登录尝试失败的原因？” 那么这是我的答案：

如果您想确定登录失败的原因，您必须从 Smack 3.2.2 开始评估 (XMPP)Exception 的消息字符串。这些区分各种失败原因的消息字符串目前在源代码中是硬编码的，这通常不是一个好主意。

不久前，我创建了[SMACK-416 “改进 connect() 和 login() 上的异常”](http://issues.igniterealtime.org/browse/SMACK-426)来解决这个问题。这个想法是用类层次结构替换硬编码的字符串/失败原因。但它肯定需要几个月的时间才能实施（可能需要几周/几个月/几年才能发布）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T16:34:23.287

实际上，主要问题是当我尝试使用无效的用户名/密码登录时，抛出了一些异常（以及我设置的信息显示），但应用程序不允许我再次登录（好像我更正了我的数据并再次单击该按钮）。

我终于通过将 .connect() 放在 .login() 方法后面来解决这个问题，并在登录错误的情况下调用 .disconnect() ，因此每次用户尝试登录时都会重新连接服务器。

这可能不是理想的方法，但我发现它既简单又可行。感谢您的帮助！

# cookies - Safari 6 Web Inspector：看不到我的域级 cookie

> ID：15672343
> 
> 赞同：2
> 
> 时间：2013-03-28T00:48:49.243
> 
> 标签：cookies, safari

我在 Safari 6 开发人员工具中查看 cookie 值时遇到问题。只是要清楚 - cookie 工作正常。我可以看到/获取/回显页面上 cookie 的值。但是，我在 Web Inspector 的存储部分看不到它。

我想知道问题是否出在多级子域上。我们有这些：

www.domain.com
sub.domain.com
www.dev.int.domain.com（仅在使用 VPN 时可访问）

我们希望所有域都可以访问此 cookie，因此我们设置一个域级 cookie，如下所示（示例）：
Set-Cookie: UserLoginCookie=someencryptedvalue; 域=.domain.com；过期=周日，2014 年 3 月 23 日 00:02:56；最大年龄=31104000；路径=/; 版本=1；HttpOnly

我正在查看 Web Inspector，在 Cookie 下的存储部分。
当我加载 www.domain.com 时，我在列表中看到了 UserLoginCookie。
当我加载 sub.domain.com 时，我在列表中看到了 UserLoginCookie。
当我加载 www.dev.int.domain.com 时，我看不到 cookie，即使我可以读取/设置它。

我试图用谷歌搜索这个并搜索stackoverflow，但我一无所获。有谁知道这是 Safari 的错误，还是我在某处遗漏了一个步骤/选项？

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-02T18:44:34.000

我猜这是 Safari 尚未修复的基于 Webkit 的错误 - [Webkit 开发人员工具不显示父域 cookie？](https://stackoverflow.com/questions/4108904/webkit-developer-tools-does-not-show-parent-domain-cookies)

没有简单的方法可以做到这一点，因为 Safari 删除了从“安全”选项卡中查看单个 cookie 的功能：根据本[HOWTO](http://www.wikihow.com/Delete-Cookies-Using-the-Safari-Web-Browser)[缺少“显示 cookie”按钮](https://discussions.apple.com/thread/3206191?start=15&tstart=0)。我也尝试过“ [Safari Cookies](http://www.sweetpproductions.com/safaricookies/) ”插件，但它不起作用，因为 cookie 列表没有为我刷新。

我已决定在开发人员控制台中使用“document.cookie”检查 cookie。

# java - 界面中有什么可以“覆盖”？

> ID：15672344
> 
> 赞同：2
> 
> 时间：2013-03-28T00:48:49.500
> 
> 标签：java, overriding

从 Java 1.6 开始，我们可以使用 @Override 来标记接口中定义的方法的实现。我理解拥有该注释的价值，我系统地使用它。但是有人可以向我解释一下到底有什么可以“覆盖”，因为接口只定义了一个合同并且不提供默认实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T06:29:01.300

是的，没有什么可以覆盖的，唯一合理的解释是这是惯例的一个分支。

在实现接口的类的上下文中，您实际上并不需要它，因为如果您无论如何都未能为所有接口方法编写代码，编译器会发出尖叫声。在此设置中，注释的作用类似于标记，与注释没有什么不同。

此外，如果它与接口相关，IDE 应该停止在自动生成的快速修复方法存根中包含 @Override 它。

最重要的是，如果在接口方法的实现上使用了 @Override 注释，它们应该生成一个“未使用”的代码警告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T00:54:04.877

从语义上讲，仅当您将接口视为一种空基类而不是完全不同的事物时才有意义。从历史上看，这实际上是接口概念的起源。C++ 是一种没有“接口”的原生概念的语言，但它支持为单个类提供多个基类。许多使用该语言的人认为拥有多个基类太笨拙而没有用——除非基类根本没有实现，只有方法定义。随后的语言，如 Java，将纯接口基类的概念形式化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T02:07:16.970

我想它在这种情况下可能有用。

```
interface Goable {
  void go(Location loc);
}

class Vehicle implements Goable {
  void go() {
    ...
  }

  void go(Location loc) {
    ...
  }
} 
```

在 Vehicle 类中，使用**@Override**可以帮助识别实现的方法。

# .htaccess - 在 htaccess 中重定向以限制 cookie 的发送

> ID：15672350
> 
> 赞同：0
> 
> 时间：2013-03-28T00:49:27.877
> 
> 标签：.htaccess, joomla, dns, yslow, cookieless

我想编写一个重定向以避免在图形和 css 文件上发送 cookie。我想我想要的是将 html 和 php 重定向到 www，而将其他重定向到 root，可能将 js 保留在 www 上，以便脚本可以处理 cookie。这适用于不支持 cookie 的 Joomla 安装，我不想更改模板文件等。相关问题，如果将 html 发送到 www，我可以将无 cookie 文件重定向到 root，还是我需要创建一个子域（这会使模板的不变策略复杂化）

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T15:58:57.063

# c# - 从 C# 调用 C++ 函数，具有大量复杂的输入和输出参数

> ID：15672351
> 
> 赞同：3
> 
> 时间：2013-03-28T00:49:29.377
> 
> 标签：c#, c++, dll, interop, pinvoke

我是 C# 新手，但我曾广泛使用 C++。我有一个需要从 C# 调用的 C++ 函数。在阅读了一些 SO 的答案和一些谷歌搜索后，我得出结论，我需要为该函数创建一个纯 C 接口。我已经这样做了，但仍然对如何从 C# 调用它感到困惑。

C++ 中的函数如下所示：

```
int processImages(
    std::string& inputFilePath,                      // An input file
    const std::vector<std::string>& inputListOfDirs, // Input list of dirs
    std::vector<InternalStruct>& vecInternalStruct,  // Input/Output struct
    std::vector<std::vector< int > >& OutputIntsForEachFile,
    std::vector< std::vector<SmallStruct> >& vecVecSmallStruct, // Output
    int verboseLevel
    ); 
```

在 C 中转换的相同函数如下所示：

```
int processImagesC(
    char* p_inputFilePath,               // An input file
    char** p_inputListOfDirs,            // Input list of dirs
    size_t* p_numInputDirs,              // Indicating number of elements
    InternalStruct* p_vecInternalStruct, // Input/Output struct
    size_t* p_numInternalStructs, 
    int** p_OutputIntsForEachFile,       // a 2d array each row ending with -1
    size_t* p_numOutputIntsForEachFile //one number indicating its number of rows
    SmallStruct** p_vecVecSmallStruct,   // Output
    size_t* p_numInVecSmallStruct,
    int verboseLevel
    ); 
```

这是基于[此](https://stackoverflow.com/questions/2179270/pass-c-sharp-string-to-c-and-pass-c-result-string-char-whatever-to-c-s)建议。

现在我需要从 C# 调用它，这就是混淆的地方。我已尽力转换结构。

C# 代码如下所示：

```
[DllImport(
    @"C:\path\to\cppdll.dll", CallingConvention=CallingConvention.Cdecl, 
    EntryPoint="processImagesC", SetLastError=true)]
[return: MarshalAs(UnmanagedType.I4)]
unsafe public static extern int processImagesC(
    String inputFilePath,
    String[] inputListOfDirs,
    ref uint numInputListOfDirs,

    // Should I use ref InternalStruct * vecInternalStruct?
    ref InternalStruct[] vecInternalStruct, 

    ref uint numInternalStruct,

    // Or ref int[] or ref int[][] or int[][]?
    ref int[][] OutputIntsForEachFile, 

    ref uint numOutputIntsForEachFile,

    // again, ref ..[], [][], or ref [][]?
    ref SmallStruct[][] vecVecSmallStruct, 

    int verboseLevel
); 
```

在 C/C++ 代码中完成所有输出变量（指针）的内存分配。这可能意味着我们需要将代码声明为不安全，对吗？

我们如何处理内存释放？我是否应该编写另一个 API（函数）来释放 C/C++ 分配的对象/数组？

C++ 代码需要符合标准且独立于平台，因此我不能在其中插入任何特定于 Windows 的内容。

我希望有人能理解这一点并提供答案，或者至少为我指明正确的方向。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T14:58:16.563

由于似乎有人对将 It Just Works (IJW) 与 C++/CLI 结合使用有些兴趣，因此我将发布一些关于此的信息，需要进行进一步的谷歌搜索和研究才能弄清楚这一切。C++/CLI 可以使用单个编译器标志启用（/CLI，通过属性页->常规->公共语言运行时支持启用）。C++/cli**不是**c++，而只是另一种托管语言。C++/CLI 类可以编译成 dll 并直接从其他 .NET 项目（C#、VB.NET 等）调用。但是，与其他 .NET 语言不同，它可以直接与 C++ 代码交互。

[这](http://www.codeproject.com/Articles/19354/Quick-C-CLI-Learn-C-CLI-in-less-than-10-minutes)是学习 C++/CLI 的一个不错的开始。要学习的重要内容是告诉您该类是托管的（.NET 类）而不是 Vanila C++ 的装饰。“ref”关键字将定义标记为 .NET 定义：

```
public ref class Foo{ public: void bar();};//Managed class, visible to C#
public ref struct Foo{};//Managed struct, visible to C# 
```

所有引用类都使用句柄​​而不是指针或引用来引用。句柄由 ^ 运算符表示。要创建新句柄，请使用 gcnew，要访问句柄的函数/成员，请使用 -> 运算符。

```
//in main
Foo^ a = gcnew Foo();
a->bar(); 
```

您经常必须将常见的结构从 C# 移动到本机类型，然后再返回。（例如托管 Array^ 或 String^ 到 void* 或 std::string）。这个过程称为编组。[这个方便的表格](http://msdn.microsoft.com/en-us/library/vstudio/bb384865.aspx)对于弄清楚这一点非常有用。

一个常见的任务是为原生类创建一个包装器，如下所示：

```
//Foo.h
#include <string>
namespace nativeFoo
{
    class Foo
    {
     private:
        std::string fooHeader;
     public:
        Foo() {fooHeader = "asdf";}
        std::string Bar(std::string& b) {return fooHeader+b;}
    };
}
//ManagedFoo.h
#include "foo.h"
namespace managedFoo
{
    public ref class Foo
    {
        private:
             nativeFoo::Foo* _ptr;
        public:
             Foo(){_ptr = new nativeFoo::Foo();}
             ~Foo(){!Foo();}
             !Foo(){if (_ptr){delete ptr;ptr = NULL;}}

             String^ bar(String^ b)
             {
                 return marshal_as<String^>(_ptr->bar(marshal_as<std::string>(b)));
             }
    };
} 
```

警告：我完全遗漏了一堆#include 和#using 语句，这只是为了给出如何使用它的一般要点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T01:54:56.943

从此开始：

*   [如何从 C# 将结构作为指针传递给 C dll](https://stackoverflow.com/questions/15197195/how-to-pass-structure-as-pointer-in-c-dll-from-c-sharp/15197411#15197411)

还有一些关于编组的事情：

*   [没有序列化的深度复制数组c#](https://stackoverflow.com/questions/15368699/deep-copying-an-array-c-sharp-without-serialization/15371104#15371104)

请注意，[Marshal.Copy](http://msdn.microsoft.com/en-us/library/4cew0s1h.aspx)还为数组使用重载。通过编组，您可以摆脱`ref`您确实想要的例外情况。只需按照他们的方式编写 C/C++。

以下有点复杂：

*   [物理磁盘大小不正确 (IoCtlDiskGetDriveGeometry)](https://stackoverflow.com/questions/15051660/physical-disk-size-not-correct-ioctldiskgetdrivegeometry/15073586#15073586)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T01:11:07.750

我经常看到处理这种情况的两种方法是使用“FreeResource”风格的 API，或者在函数中指定输出缓冲区的大小。

**方法一**

C++

```
void GetName(char ** _str)
{
    if (!_str)
        return; // error
    *_str = new char[20];
    strcpy(*str, "my name");
}

void FreeString(char * _str)
{
    delete str;
} 
```

客户（任何语言）

```
char * name;
GetName(&name);
...
FreeString(name); 
```

**方法二**

C++

```
void GetName(char * _str, size_t _len)
{
    if (_len < 20)
        return; // error
    strcpy(str, "my name");
} 
```

客户（任何语言）

```
char * name = new char[20];
GetName(name, 20);
... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-14T03:24:34.523

如果您愿意使用第三方工具，有一个名为 C#/.NET PInvoke Interop SDK 的工具可能对您有所帮助。但你也可以自己做。对于具有几个方法的简单类，您可以在托管 C# 代码中编写自己的代码。

从 .NET 世界中实例化 C++ 对象的基本思想是从 .NET 中分配 C++ 对象的确切大小，然后调用从 C++ DLL 导出的构造函数来初始化对象，然后您将能够调用任何访问该 C++ 对象的函数，如果任何方法涉及其他 C++ 类，您还需要将它们包装在 C# 类中，对于具有原始类型的方法，您可以简单地 P/Invoke 它们。如果你只有几个方法可以调用，那会很简单，手动编码不会花很长时间。完成 C++ 对象后，调用 C++ 对象的析构函数方法，这也是一个导出函数。如果它没有，那么你只需要从.NET 中释放你的内存。

这是一个例子。

```
public class SampleClass : IDisposable
{    
    [DllImport("YourDll.dll", EntryPoint="ConstructorOfYourClass", CharSet=CharSet.Ansi,          CallingConvention=CallingConvention.ThisCall)]
    public extern static void SampleClassConstructor(IntPtr thisObject);

    [DllImport("YourDll.dll", EntryPoint="DoSomething", CharSet=CharSet.Ansi,      CallingConvention=CallingConvention.ThisCall)]
    public extern static void DoSomething(IntPtr thisObject);

    [DllImport("YourDll.dll", EntryPoint="DoSomethingElse", CharSet=CharSet.Ansi,      CallingConvention=CallingConvention.ThisCall)]
    public extern static void DoSomething(IntPtr thisObject, int x);

    IntPtr ptr;

    public SampleClass(int sizeOfYourCppClass)
    {
        this.ptr = Marshal.AllocHGlobal(sizeOfYourCppClass);
        SampleClassConstructor(this.ptr);  
    }

    public void DoSomething()
    {
        DoSomething(this.ptr);
    }

    public void DoSomethingElse(int x)
    {
        DoSomethingElse(this.ptr, x);
    }

    public void Dispose()
    {
        Marshal.FreeHGlobal(this.ptr);
    }
} 
```

有关详细信息，请参阅以下链接，

[C#/.NET PInvoke 互操作 SDK](http://www.xinterop.com/index.php/2013/04/13/introduction-to-c-pinvoke-interop-sdk/)

该工具[xInterop NGen++ 2.0 已发布。](http://www.xinterop.com/index.php/xinterop-ngen-2-0)如果您有兴趣为本地 C++ DLL 创建 C# 包装器，请查看它。

（我是SDK工具的作者）

# objective-c - 为什么我不能将 nil 对象添加到 NSMutableArrays？

> ID：15672363
> 
> 赞同：7
> 
> 时间：2013-03-28T00:51:03.300
> 
> 标签：objective-c, c, nsmutablearray, nsarray, null

我有一种情况，我希望能够维护一个可能都指向 nil 的指针数组。

```
Equipment *equipment[19]; 
```

但是，我发现我不能将指针数组或双指针设置为对象的属性。

当我不能使用 C 样式数组时，我的解决方法是使用 NSArray 对象。因此，我尝试执行以下操作：

```
NSMutableArray *equipment = [NSMutableArray arrayWithCapacity: NUM_EQUIPSLOTS];
for (int i=0; i<NUM_EQUIPSLOTS; i++) {
    [equipment setObject: nil atIndexedSubscript: i];
} 
```

这里的想法是我有一个空指针数组，稍后将指向东西。

```
*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '*** -[__NSArrayM insertObject:atIndex:]: object cannot be nil'
*** First throw call stack:
(0x246e012 0x1e4be7e 0x2421b6a 0x2421a20 0xebd02 0xde82b 0xc9d5a 0xcb6bd 0x4d525 0xc94fa 0xc8b6a 0xa18157 0xa18747 0xa1994b 0xa2acb5 0xa2bbeb 0xa1d698 0x3176df9 0x3176ad0 0x23e3bf5 0x23e3962 0x2414bb6 0x2413f44 0x2413e1b 0xa1917a 0xa1affc 0xc8526 0x1fa5)
libc++abi.dylib: terminate called throwing an exception 
```

我知道我可以很容易地使用 C 风格的数组和单个对象来做到这一点。我宁愿这样做而不是像这样愚蠢的事情：

```
Equipment *equipment0 = nil;
Equipment *equipment1 = nil;
Equipment *equipment2 = nil;
// ...
Equipment *equipment18 = nil; 
```

这可能与 NSArray 模型本身的结构有关。有人会向我解释为什么会这样，以及为什么我不能简单地在 NSArray 中添加或设置 nil 对象吗？先感谢您。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-28T01:05:49.670

“为什么”既琐碎又令人不满意。这是因为`NSMutableArray`持有对象，而`nil`不是对象。ObjC 在对象和原始类型之间有很大的区别。`nil`是原始类型。作为`CodaFi`注释，您可以使用`NSNull`或`NSPointerArray`来解决这些问题。典型的解决方案是`NSNull`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-28T04:44:07.387

没有充分的理由。`NSArray`并`NSMutableArray`存储指向对象的指针。`nil`是一个体面的指向对象的指针。Java 的等价物是`ArrayList`，它确实允许`null`元素。这只是一个设计选择。

这种设计选择的一个可能的历史原因是创建数组并用元素填充它的最常见方法是使用`-initWithObjects:...`or`+arrayWithObjects:...`方法，它使用可变参数来获取用户想要提供的尽可能多的参数并将其放入数组中. 由于在 C 中使用 varargs，不可能确定参数的数量，他们选择指示有多少`nil`作为“终止符”来表示列表结束的方式。（还有其他表示数字的方法，例如将数字作为第一个参数传递。）这种方法的缺点是您不能将`nil`其作为要放入数组的“参数”之一，因为它会终止名单。

但是，这些方法并不是创建数组并用元素填充它的唯一方法。您可以创建一个空数组并分别添加每个数组，或者您可以使用`-initWithObjects:count:`or`+arrayWithObjects:count:`方法，它们不是可变参数，因此没有`nil`终止符问题。现在，还有数组字面量语法（在`-initWithObjects:count:`内部调用），这使它变得更加容易。完全可以想象拥有`NSArray`并且`NSMutableArray`允许`nil`元素；只是你不能使用`-initWithObjects:...`或`+arrayWithObjects:...`添加`nil`元素。然而，他们选择不这样做。

# c# - 如何根据数组的值显示位置

> ID：15672365
> 
> 赞同：0
> 
> 时间：2013-03-28T00:51:25.520
> 
> 标签：c#, arrays

我一直在课堂上学习 C#，并尝试在空闲时间自学。

我正在尝试用 C# 制作我的第一款游戏。到目前为止，我的代码是：

```
 static void Main(string[] args)
    {

        string aValue;
        int Limit = 20;

        int[,] MOVEMENT = new int[20,20];           

        // MOVEMENT

        for (int i = 0; i < 20;)
            for (int j = 0; j < 20;)
            {
                Console.WriteLine("Which direction do you wish to move in?");
                aValue = Console.ReadLine();

                // MOVE NORTH
                if (aValue == "North" || aValue == "north")
                {
                    i = i + 1;

                    if (i >= 20)
                    {
                        Console.WriteLine("You cannot move any further in this direction!");
                        i = 20;
                    }
                }

                // MOVE SOUTH
                if (aValue == "South" || aValue == "south")
                {
                    i = i - 1;

                    if (i <= 0)
                    {
                        Console.WriteLine("You cannot move any further in this direction!");
                        i = 0;
                    }
                }

                // MOVE EAST
                if (aValue == "East" || aValue == "east")
                {
                    j = j + 1;

                    if (j >= 20)
                    {
                        Console.WriteLine("You cannot move any further in this direction!");
                        j = 20;
                    }
                }

                // MOVE WEST
                if (aValue == "West" || aValue == "west")
                {
                    j = j - 1;

                    if (j <= 0)
                    {
                        Console.WriteLine("You cannot move any further in this direction!");
                        j = 0;
                    }
                }

                // Display where the character is after each movement and list possible events 
                // in the area. 

                Console.WriteLine("You are now at {0},{1}", i, j);

            }
        Console.ReadLine();
} 
```

现在想让数组的每个元素对应游戏中的不同位置。例如：0,0 可能是 Home。0,1 可能是村庄。0,2 可能是沙漠。1,5 可能是湖。

我希望每个位置都有自己的描述和一些事件（使用 If 语句等）。我不确定如何让代码显示位置（这只是元素的值吗？），这取决于 i 和 j 也相等。我被告知最好使用 switch 语句来完成这项工作，但我已经尝试过了，但我无法让它工作。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:02:11.090

为什么不使用对象？

```
public class Location{
    public int Latitude   {get;set;}
    public int Longitude  {get;set;}
    public string Name{get;set;}
    public string Description  {get;set;}
} 
```

并使用 LINQ 检索名称和值

```
yourIEnumerableLocation.FirstOrDefault(x=> x.Latitude== yourXposition && x.Longitude == yourYposition) 
```

或按照 Gam Erix 的解释使用字典

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T01:01:58.833

我建议您使用结构和字符串的[字典（或 2 个字符串的结构 - 分别是描述和位置），您可以在其中为每个位置分配一些信息，如下所示：](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx?cs-save-lang=1&cs-lang=csharp#code-snippet-1)

```
using System;
public struct Point
{
   public int x, y;

   public Point(int p1, int p2)
   {
      x = p1;
      y = p2;
   }
}
public struct Information
{
   public string description, location;

   public Information(string desc, string loc)
   {
      description = desc;
      location = loc;
   }
}
var info = new Dictionary<Point, Information>();

info[Point(i,j)] = Information("This is our lovely lake","Lake"); 
```

# ant - 中断还是继续实施？

> ID：15672366
> 
> 赞同：2
> 
> 时间：2013-03-28T00:51:29.200
> 
> 标签：ant, ant-contrib

ant-contrib 中的 for/foreach 循环是否支持等效的“break”或“continue”语句？据我所知，他们没有。

有没有可行的变通办法？

谢谢-T

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T09:26:57.883

没有简单的方法来实现此行为，但也许以下建议会有所帮助。

*   使用[`for`任务](http://ant-contrib.sourceforge.net/tasks/tasks/for.html)（即不是 foreach）
*   将`keepgoing`属性设置为 true
*   使用带有条件的[`fail`任务](http://ant.apache.org/manual/Tasks/fail.html)，以便需要跳过的项目将失败。

* * *

每当您检测到需要中断时，您都可以通过定义属性来获得诸如*中断之类的东西*`myBreakProperty`

```
 <for list="a,b,c,d,e" param="letter" keepgoing="true">
    <sequential>
       <if>
         <equals arg1="@{letter}" arg2="c" />
       <then>
         <property name="myBreakProperty" value="nevermind the value"/>
       </then>
     </if>
     <fail if="myBreakProperty"/>
     <echo>Letter @{letter}</echo>
    </sequential>
 </for> 
```

输出将是： `Letter a Letter b`

* * *

要获得类似*continue*的东西：

```
 <for list="a,b,c,d,e" param="letter" keepgoing="true">
    <sequential>
       <if>
         <equals arg1="@{letter}" arg2="c" />
       <then>
         <fail/>
       </then>
     </if>
     <echo>Letter @{letter}</echo>
    </sequential>
 </for> 
```

输出将是： `Letter a Letter b Letter d Letter e`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-11T23:28:34.380

您可以创建一个中断流程，而不会运行像失败这样苛刻的事情。使用属性来检测何时要中断，您可以实现如下所示：

```
<var name="break.flag" unset="true"/>

<for list="a,b,c,d,e" param="letter">
    <sequential>
        <if>
            <not>
                <isset property="break.flag"/>
            </not>
        <then>
            <if>
                <equals arg1="@{letter}" arg2="c" />
            <then>
                <property name="break.flag" value="true"/>
            </then>
            </if>

            <if>
                <not>
                    <isset property="break.flag"/>
                </not>
            <then>
                <echo>Letter @{letter}</echo>
                <echo>Do the rest of the loop here</echo>
            </then>
            </if>
        </then>
        </if>
    </sequential>
</for> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-01-03T19:45:40.470

要真正打破循环，您可以将 fail 与 trycatch 一起使用

```
 <trycatch>
                <try>
                    <for param="i" begin="1" end="99">
                        <sequential>
                            ...
                            <fail message="break" />
                        </sequential>
                    </for>
                </try>
                <catch />
            </trycatch> 
```

# c# - 填充嵌套列表

> ID：15672369
> 
> 赞同：0
> 
> 时间：2013-03-28T00:51:53.027
> 
> 标签：c#, winforms, visual-studio-2010, arraylist

我有一个生成按钮网格的程序，我想将这些按钮存储在嵌套数组列表中，但我正在做的方式似乎不正确

这是我的代码：

```
 List<List<Button>> buttonsList = new List<List<Button>>();
        List<Button[]> rowList = new List<Button[]>();

        //Some method that creates a grid of buttons
        buttons = new Button[row][];
        for (int r = 0; r < row; r++)
        { 
            buttons[r] = new Button[col];
            buttonsList.Add(rowList[r]);    
            for (int c = 0; c < col; c++)
            {
                buttons[r][c] = new Button();
                rowList[c].Add(buttons[r][c]);
            }
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T01:00:36.323

您需要了解的第一件事是 a`List<T>`和 a`T[]`不等价*（*见脚注）。您的代码似乎想将列表视为数组，但这行不通。

A`List<List<Button>>`可以按以下方式使用：

```
var listOfLists = new List<List<Button>>();
var listOfButtons = new List<Button>();
listOfButtons.Add(new Button());
listOfLists.Add(listOfButtons); 
```

您可以继续向按钮列表添加按钮、创建更多按钮列表、向其中添加按钮，并将所有按钮添加到列表列表中，您可以在循环或嵌套循环中完成所有这些操作。

数组`Button[][]`的处理方式不同。它不是动态大小的，并且会以不同的方式使用。

```
var arrayOfArrays = new Button[10][];
var arrayOfButtons = new Button[3];
arrayOfButtons[0] = new Button();
arrayOfButtons[1] = new Button();
arrayOfButtons[2] = new Button();
arrayOfArrays[0] = arrayOfButtons; 
```

然后你还有 9 个可以设置的按钮数组（在这个例子中）。

您的代码尝试将按钮数组添加到需要按钮列表的列表中。还有一些其他的项目需要整理，但基本的想法是你把这两个不同的集合混在一起了，编译器会大声抱怨。

要修复您的代码，首先为您需要做的事情使用正确的类型，然后在您的逻辑中始终如一地正确使用这些类型。

作为初学者，看看你在这些片段上能走多远。

```
// using List<List<Button>>

var buttonLists = new List<List<Button>>();

for (int r = 0; r < row; r++)
{ 
    var buttonRow = new List<Button>();
    buttonLists.Add(buttonRow);    
    for (int c = 0; c < col; c++)
    {
        buttonRow.Add(new Button());
    }
}

// using Button[][]

var buttonArrays = new Button[row][];

for (int r = 0; r < row; r++)
{
    buttonArrays[r] = new Button[col];
    for (int c = 0; c < col; c++)
    {
        buttonArrays[r][c] = new Button();
    }
} 
```

* * *

*除非您通过通用接口类型引用它们，在这种情况下它们仍然不等效但*兼容*，但这超出了此答案的范围，并且鉴于所涉及的代码片段，这在此上下文中并不是特别有用。

# javascript - 播放一组声音文件

> ID：15672370
> 
> 赞同：-1
> 
> 时间：2013-03-28T00:51:55.840
> 
> 标签：javascript, html

我正在尝试将变量传递给 JavaScript 函数并使用 HTML5`<audio>`元素播放它。

如果我将字符串参数传递给函数，这只是一个文件，我会播放它。但是如果我传递一个数组，我想逐首歌播放整个数组。

这是我的基本想法：

```
function playSound(sound) {
    var audio = document.getElementById('sound');
    if(sound instanceof Array) {
        // Play the whole array
    }
    else {
        // Play only one file
        audio.src = sound;
        audio.play();
    }
} 
```

你可以帮帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:03:11.800

您可以继续`playSound`循环调用并将调用绑定到`onended`：

```
if (sound instanceof Array) {
    audio.src = sound.shift();
    audio.play;
    if (sound.length) {
        audio.addEventListener('ended', function () {
            playSound(sound);
        });
    }
} 
```

# ruby-on-rails - 通过外键链接 Rails 对象

> ID：15672374
> 
> 赞同：1
> 
> 时间：2013-03-28T00:52:11.897
> 
> 标签：ruby-on-rails, ruby

通过外键链接 rails 对象的最佳方法是什么？这是我的例子。从业者有一张考勤卡（收集每天的工作时间）。我想把从业者的身份证放在预约上以显示这一点：

来自 routes.rb

```
 resources :locations do
    resources :practitioners, only: [:new, :create]
  end

  resources :practitioners, except: [:new, :create] do
    resources :timecards, except: :delete
    resources :appointments
  end 
```

timecard.rb - 你可以在这里看到我强制 timecard.practitioner_id 为 3，但这是一个蛮力测试工作。

```
class Timecard < ActiveRecord::Base
  belongs_to :practitioner
 attr_protected :id

  before_save :set_practitioner_id

  def set_practitioner_id
    if self.practitioner_id.blank?
      self.practitioner_id = 3
    end
  end
end 
```

从我的控制器...

```
def create
    @practitioner = Practitioner.find(params[:practitioner_id])
    @timecard = Timecard.create(params[:timecard])

    respond_to do |format|
      if @timecard.save
        format.html { redirect_to @practitioner, notice: 'Timecard was successfully created.' }
        format.json { render json: @timecard, status: :created, location: @timecard }
      else
        format.html { render action: "new" }
        format.json { render json: @timecard.errors, status: :unprocessable_entity }
      end
    end
  end 
```

我可以看到practice_id = 3 的参数（这是我想要使用的），我只是不知道如何在代码中访问它。

```
Parameters:

{"utf8"=>"✓",
 "authenticity_token"=>"DIp4R31McXnBNP4NB06KDTzV+8lLcWvxbq1w9J+Z1+M=",
 "timecard"=>{
   "hours_worked"=>"2",
   "activity_date(1i)"=>"2013",
   "activity_date(2i)"=>"3",
   "activity_date(3i)"=>"20",
   "practitioner_id"=>"",
   "location_id"=>"1"
 },
 "commit"=>"Create Timecard",
 "practitioner_id"=>"3"   <== this is what I want to use
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:02:02.567

如果我理解您的问题，您可以`@timecard.practitioner = @practitioner`在将考勤卡保存到控制器之前进行简单设置。您可以这样做，因为`belongs_to` [它为您提供](http://apidock.com/rails/ActiveRecord/Associations/ClassMethods/belongs_to)了一个`practioner=`“分配关联对象、提取主键并将其设置为外键”的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T01:03:03.100

我假设从业者有很多时间卡，所以你应该能够做类似的事情

```
# practitioner.rb
has_many :timecards

# controller
@practitioner = Practitioner.find(params[:practitioner_id])
@timecard = @practitioner.timecards.build(params[:timecard]) 
```

建立关联将为您设置外键。

# performance - 优化 Magento 加载速度 - 无法确定为什么初始接收速度如此之慢

> ID：15672375
> 
> 赞同：0
> 
> 时间：2013-03-28T00:52:16.107
> 
> 标签：performance, magento, optimization

虽然我们的网站在图形和设计方面尚未完成，但大多数后端操作已接近完成。

然而，在优化了 mysql 数据库之后，在 pingdom.com 上进行测试时，我们仍然会收到一个显着的初始接收期：

[http://tools.pingdom.com/fpt/#!/IuoBna86v/http://foscam-uk.com](http://tools.pingdom.com/fpt/#!/IuoBna86v/http://foscam-uk.com)

根据 Pingdom：

黄色部分是解析主机名和类似的时间（在启动到 Web 服务器的连接之前），绿色部分是连接到 Web 服务器，蓝色部分是从中检索内容所需的时间网络服务器。

在询问我们托管的 VPS 支持团队后，我们得到了答复：“您是否尝试过优化您的脚本？我相信那里的高等待时间表示实际的网站加载时间（意味着您的脚本加载）；不是与网站/服务器的实际连接。

现在，pingdom 显示 js/css 加载速度相对较快，mysql 数据库方面的事情似乎也没有减慢任何速度 - 有人对这可能是什么或可能导致它有任何建议吗？

非常感谢您的时间和帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T04:10:59.467

1.  89 requests are too many.
2.  Reduce number of image request by creating sprites.This is pretty important from what is shown in pingdom.
3.  Keep Alive should be set to On and Keep alive time should be a bit higher(15 seconds or so).
4.  Use of compiler plus merge and minify js/css is recommended.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-01T12:17:43.847

更改托管服务提供商。8秒加载非常非常慢。这意味着对于没有缓存网站部分的用户（第一次访问者）来说，实际上大约需要 15-17 秒。我的网站 www.bebepunk.ro 在 2.5 秒内根据 pingdom 加载，用户仍然抱怨网站运行缓慢。[还可以通过http://www.webpagetest.org](http://www.webpagetest.org)检查这两个值。

# ios - UITextField 在 CABasicAnimation 期间被裁剪，keyPath 为 bounds.size.width

> ID：15672376
> 
> 赞同：2
> 
> 时间：2013-03-28T00:52:32.453
> 
> 标签：ios, uitextfield, core-animation, cabasicanimation

我手头有一个奇怪的问题。我有 UITextField。当点击按钮时，此 TextField 的宽度会调整大小。为此，我首先做了以下事情：

```
CGRect newbounds = originalBounds;
newbounds.size.width = newbounds.size.width/2;

[UIView beginAnimations:nil context:nil];
self.textField2.bounds = newbounds;
[UIView commitAnimations]; 
```

很简单，它奏效了。现在我继续前进并尝试对动画进行更多控制。为此，我使用以下内容进入 CABasicAnimation 的下一个级别：

```
CGRect newbounds = originalBounds;
newbounds.size.width = newbounds.size.width/2;

CABasicAnimation *animShrink = [CABasicAnimation animation];
animShrink.keyPath = @"bounds";
animShrink.toValue = [NSValue valueWithCGRect:newbounds];
animShrink.duration = 0.5;
animShrink.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];
animShrink.delegate = self;

[self.textField2.layer addAnimation:animShrink forKey:@"shrink"]; 
```

那就是我在动画过程中遇到剪辑问题的时候，可以在以下位置看到：[http](http://coldstorage.macbonsai.com/public/cabasic_animation_clipping.png) ://coldstorage.macbonsai.com/public/cabasic_animation_clipping.png （因为根据 Stackoverflow，我“需要至少 10 个声望才能发布图像” ）。

所以我尝试了以下版本的动画：

```
CGRect newbounds = originalBounds;
newbounds.size.width = newbounds.size.width/2;

CABasicAnimation *animShrink = [CABasicAnimation animation];
animShrink.keyPath = @"bounds.size.width";
animShrink.fromValue = [NSNumber numberWithFloat:originalBounds.size.width];
animShrink.toValue = [NSNumber numberWithFloat:newbounds.size.width];
animShrink.duration = 0.5;
animShrink.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];
animShrink.delegate = self;

[self.textField2.layer addAnimation:animShrink forKey:@"shrink"]; 
```

还是遇到了同样的问题。此时，我从 UITextField 中删除了所有约束并尝试了 CABasicAnimation 版本。同样的问题。在这一点上，我不知道还能做什么。任何帮助将不胜感激。

提前谢谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-13T16:03:50.860

如果您将按钮的样式更改为 UITextBorderStyleNone 它不会被剪裁。

我的猜测是，当样式为 UITextBorderStyleRoundedRect 时，Apple 可能只是将 UIImageView 添加到带有“圆形矩形”图像的按钮中，因此当您为按钮的图层设置动画时，它的子视图不会一起动画，因为在 iOS 中您必须明确动画所有子层。

# list - 如何在不返回列表的情况下将元素添加到列表中？

> ID：15672378
> 
> 赞同：1
> 
> 时间：2013-03-28T00:52:36.780
> 
> 标签：list, functional-programming, ocaml

在不返回列表的情况下在列表中插入元素的最佳方法是什么？当我尝试使用 operator`::`时，它返回一个列表：

```
element :: lst 
```

但是，我希望返回值是单位，类似于工作方式`Hashtbl.add`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T16:08:53.667

你想做的事不能做，因为列表是不可更改的。

它们是不可更改的，因为这“完全不是”你在函数式编程中做事的方式。您将原始列表提供给一个函数并获得一个新列表。如果列表对某些事情有好处，那么您将继续努力。

但是有希望：您可以使用参考。来自交互式会话的代码：

```
# let mylist = ["one";"two";"tree"] ;;
val mylist : string list = ["one"; "two"; "tree"]
#  mylist.[1];;
Error: This expression has type string list
       but an expression was expected of type string
#  mylist.(1);;
Error: This expression has type string list
   but an expression was expected of type 'a array
# List.iter (function e -> print_endline e) mylist;;
one
two
tree
- : unit = ()
# let r = ref [];;
val r : '_a list ref = {contents = []}
# r := "zero" :: mylist;;
- : unit = ()
# List.iter (function e -> print_endline e) !r;;
zero
one
two
tree
- : unit = ()
# List.iter (function e -> print_endline e) ("minus" :: !r);;
minus
zero
one
two
tree
- : unit = ()
# List.iteri (fun cnt -> fun e -> Printf.printf "Element %d: %s" cnt e) !r;;
Element 0: zeroElement 1: oneElement 2: twoElement 3: tree- : unit = ()
# 
```

代码步行：

*   定义我的列表
*   尝试访问列表中的一个元素，这是不可能的
*   另一个尝试访问一个元素，不行。您必须能够访问它以存储新值
*   列表迭代以打印列表的示例
*   创建 '_a list ref 类型的引用 r
*   在 r 中存储字符串和 mylist
*   在 r 中迭代列表以进行打印，以查看数据是否存在
*   使用列表的动态更改迭代列表
*   最后用 Caml 语法给出 List.iteri 的（差）示例

我之所以这么明确，是因为我在尝试熟悉 FP 时完全错过了这些示例。

/STR。

# java - java中页面解析期间HTTP中的错误503

> ID：15672381
> 
> 赞同：0
> 
> 时间：2013-03-28T00:53:05.143
> 
> 标签：java, url, ioexception

今天我正在开发一个 java RMI 服务器（以及客户端），它从页面获取信息并返回我想要的内容。我把代码放在这里。问题是有时我传递给该方法的 url 会抛出一个 IOException，表示给定的 url 会产生 503 HTTP 错误。如果它总是这样可能很容易，但问题是它有时会出现。我有这种方法结构，因为我解析的页面来自一家气象公司，我想要来自许多城市的信息，而不仅仅是一个城市，所以有些城市一有机会就完美运行，而另一些城市则失败了。有什么建议么？

```
public ArrayList<Medidas> parse(String url){
        medidas = new ArrayList<Medidas>();
        int v=0;

            String sourceLine;
            String content = "";
        try{
            // The URL address of the page to open.

            URL address = new URL(url);

            // Open the address and create a BufferedReader with the source code.
            InputStreamReader pageInput = new InputStreamReader(address.openStream());
            BufferedReader source = new BufferedReader(pageInput);

            // Append each new HTML line into one string. Add a tab character.
            while ((sourceLine = source.readLine()) != null){
                if(sourceLine.contains("<tbody>")) v=1;
                else if (sourceLine.contains("</tbody>"))
                    break;
                 else if(v==1)
                    content += sourceLine + "\n";
            }
       ........................
       ........................  NOW THE PARSING CODE, NOT IMPORTANT
   } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T01:02:07.300

1.  检查 IOException 是否真的不是 MalformedURLException。尝试打印出 URL 以验证错误的 URL 不会导致 IOException。
2.  您正在解析的文件有多大？也许您的 JVM 内存不足。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T06:38:45.287

HTTP 500 错误反映了服务器错误，因此它可能与您的客户端代码无关。如果您在请求中传递无效参数，您将收到 400 错误。

503是“服务不可用”，可能是服务器超载无法处理您的请求时发送的。从可公开访问的服务器，这可以解释不稳定的行为。

**编辑**

当您检测到 503 时，在您的代码中构建一个重试处理程序。Apache [HTTPClient](http://hc.apache.org/)可以自动为您执行此操作。

[HTTP 状态码列表](http://en.wikipedia.org/wiki/List_of_HTTP_status_codes)

# hadoop - Hadoop MapReduce 中的“Map”和“Reduce”函数

> ID：15672382
> 
> 赞同：1
> 
> 时间：2013-03-28T00:53:16.927
> 
> 标签：hadoop, mapreduce

我一直在看 hadoop 的这个字数统计示例：http: [//hadoop.apache.org/docs/r1.0.4/mapred_tutorial.html#Source+Code](http://hadoop.apache.org/docs/r1.0.4/mapred_tutorial.html#Source+Code)

我对 Map 功能有点困惑。在显示的 map 函数中，它接受 LongWritable 类型的“key”，但该参数从未在 Map 函数的主体中使用。应用程序程序员希望 Hadoop 为这个密钥传递什么？如果 map 函数只是从一行文本或其他东西中解析值，为什么它需要一个键。有人可以给我一个输入需要键和值的例子吗？我只看到地图为 V1 -> (K2, V2)。

另一个问题：在hadoop的实际实现中，它们是否有多个reduction步骤？如果是这样，如果函数是 (K2, V2) -> (K3, V3)，hadoop 如何多次应用相同的归约函数？如果再做一次归约，需要取入类型(K3, V3)...

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T01:11:40.813

那里有一个键，因为 map() 方法总是传递一个键和一个值（和一个上下文）。是否实际使用键和/或值取决于您。在这种情况下，键代表正在读取的文件中的行号。字数逻辑不需要那个。map() 方法只使用该值，在文本文件的情况下是文件的一行。

至于您的第二个问题（实际上应该是它自己的堆栈溢出问题），您可能在 hadoop 工作流程中有任意数量的 map/reduce 作业。其中一些作业将读取为输入预先存在的文件，而其他作业将读取其他作业的输出。每个作业将有一个或多个映射器和一个减速器。

# java - Java OCR 检测数独网格数字

> ID：15672386
> 
> 赞同：1
> 
> 时间：2013-03-28T00:53:42.373
> 
> 标签：java, ocr, tesseract

我使用 Tess4j 进行光学识别，它几乎适用于我提供给我的程序的图片。我将数独扫描网格切割成 81 个盒子。但是，当我取一个包含数字的正方形时，Tess4j 无法检测到该数字。我不知道为什么，数字在白色背景上是黑色的。谁能帮帮我？

感谢您的回复！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T23:38:10.187

您可以尝试 Tesseract 必须获得的各种页面分割模式 (PSM) 以获得最佳结果。

```
pagesegmode values are:
0 = Orientation and script detection (OSD) only.
1 = Automatic page segmentation with OSD.
2 = Automatic page segmentation, but no OSD, or OCR
3 = Fully automatic page segmentation, but no OSD. (Default)
4 = Assume a single column of text of variable sizes.
5 = Assume a single uniform block of vertically aligned text.
6 = Assume a single uniform block of text.
7 = Treat the image as a single text line.
8 = Treat the image as a single word.
9 = Treat the image as a single word in a circle.
10 = Treat the image as a single character. 
```

# powershell - Robocopy 发送电子邮件、附件、附加文件名

> ID：15672388
> 
> 赞同：1
> 
> 时间：2013-03-28T00:53:54.680
> 
> 标签：powershell, outlook, robocopy

我正在使用 robocopy 将一个硬盘备份到另一个下面是我正在使用的代码：

```
robocopy "\\server_location\XXXX" "\\local_location\xxxx" /copyall /TEE /S /r:1 /ndl /xc /xo /xn /log+:"C:\desktop\log.TXT"

START mailto:myemail.job.com?subject=Ovl%%2Reportˆ&body=Test,%%0D%%0A%%0D%%0AHere%%20is%%20is%%the%%20ovl%%20report.%%0D%%0A%%0D%%0ABye 
```

我需要能够做几件事：

1.  通过 Outlook 自动通过电子邮件发送文本文件（powershell？）。

2.  如果时间戳不同，则在比较文件时，附加目标文件名，然后从源复制文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T02:23:37.960

因此，这是我在许多 robocopy 工作中使用的脚本。我不确定它是否适合您的“通过 Outlook 发送电子邮件”，因为它只是在执行 SMTP，实际上并没有连接到 Outlook 来执行此操作。该脚本是一个 Powershell 2.0 脚本，记住只有 Server 2008R2 和 Windows Vista+ 有 /MT 选项，与 /TEE 选项一起使用是不好的。脚本在帖子的底部。

对于第二点，我认为您可能需要两个不同的脚本，一个专门忽略时间戳，另一个包含时间戳差异文件，如果直接在第一个之后运行应该是正确的。这将与 /XO 开关一起使用，即“/XO : eXclude Older - 如果目标文件存在并且与源文件的日期相同或更新 - 不要费心去覆盖它。”

其他可能有助于您编写脚本的选项是：

/XC | /XN : 排除已更改 | 较新的文件 /XL ：排除“孤独”文件和目录（存在于源中但不存在于目标中）这将防止将任何新文件添加到目标中。/XX ：排除“eXtra”文件和目录（存在于目标但不存在于源中）这将防止从目标中删除任何内容。（这是默认设置）

```
#*=============================================
#* Base variables
#*=============================================

$SourceFolder = "C:\SourceFolder"
$DestinationFolder = "C:\DestinationFolder"
$Logfile = "C:\Robocopy.log"
$Subject = "Robocopy Results: Copy Purpose - Location to Location"
$SMTPServer = "smtp.server.com"
$Sender = "Server <email@address.com>"
$Recipients = "User1 <email@address.com>"
$Admin = "Admin <email@address.com>"
$SendEmail = $True
$IncludeAdmin = $True
$AsAttachment = $False

#*=============================================
#* GMAIL variables
#*=============================================
#$SMTPServer = "smtp.gmail.com"
#$cred = New-Object System.Net.NetworkCredential("username", "password");
# Add "-UseSsl -Credential $cred" to the Send-MailMessage

#*=============================================
#* SCRIPT BODY
#*=============================================

# Change robocopy options as needed. ( http://ss64.com/nt/robocopy.html )
Robocopy $SourceFolder $DestinationFolder /MIR /R:2 /W:5 /LOG:$Logfile /NP /NDL

# The following attempts to get the error code for Robocopy
# and use this as extra infromation and email determination.
# NO OTHER CODE BETWEEN THE SWITCH AND THE ROBOCOPY COMMAND
Switch ($LASTEXITCODE)
{
16
{
$exit_code = "16"
$exit_reason = "***FATAL ERROR***"
#$IncludeAdmin = $False
#$SendEmail = $False
}
8
{
$exit_code = "8"
$exit_reason = "**FAILED COPIES**"
#$IncludeAdmin = $False
#$SendEmail = $False
}
4
{
$exit_code = "4"
$exit_reason = "*MISMATCHES*"
$IncludeAdmin = $False
#$SendEmail = $False
}
2
{
$exit_code = "2"
$exit_reason = "EXTRA FILES"
$IncludeAdmin = $False
#$SendEmail = $False
}
1
{
$exit_code = "1"
$exit_reason = "Copy Successful"
$IncludeAdmin = $False
#$SendEmail = $False
}
0
{
$exit_code = "0"
$exit_reason = "No Change"
$SendEmail = $False
$IncludeAdmin = $False
}
default
{
$exit_code = "Unknown ($LASTEXITCODE)"
$exit_reason = "Unknown Reason"
#$SendEmail = $False
$IncludeAdmin = $False
}
}

# Modify the subject with Exit Reason and Exit Code
$Subject += " : " + $exit_reason + " EC: " + $exit_code

# Test log file size to determine if it should be emailed
# or just a status email
If ((Get-ChildItem $Logfile).Length -lt 25mb)
{
If ($IncludeAdmin)
{
If ($AsAttachment)
{
Send-MailMessage -From $Sender -To $Recipients -Cc $Admin -Subject $Subject -Body "Robocopy results are attached." -Attachment $Logfile -DeliveryNotificationOption onFailure -SmtpServer $SMTPServer
} Else {
Send-MailMessage -From $Sender -To $Recipients -Cc $Admin -Subject $Subject -Body (Get-Content $LogFile | Out-String) -DeliveryNotificationOption onFailure -SmtpServer $SMTPServer
}
} Else {
If ($AsAttachment)
{
Send-MailMessage -From $Sender -To $Recipients -Subject $Subject -Body "Robocopy results are attached." -Attachment $Logfile -DeliveryNotificationOption onFailure -SmtpServer $SMTPServer
} Else {
Send-MailMessage -From $Sender -To $Recipients -Subject $Subject -Body (Get-Content $LogFile | Out-String) -DeliveryNotificationOption onFailure -SmtpServer $SMTPServer
}
}
} Else {
# Creat the email body from the beginning and end of the $Logfile
$Body = "Logfile was too large to send." + (Get-Content $LogFile -TotalCount 15 | Out-String) + (Get-Content $LogFile | Select-Object -Last 13 | Out-String)
# Include Admin if log file was too large to email
Send-MailMessage -From $Sender -To $Recipients -Cc $Admin -Subject $Subject -Body $Body -DeliveryNotificationOption onFailure -SmtpServer $SMTPServer
#Exclude Admin if log file was too large to email
#Send-MailMessage -From $Sender -To $Recipients -Subject $Subject -Body $Body -DeliveryNotificationOption onFailure -SmtpServer $SMTPServer
}

#*=============================================
#* END OF SCRIPT: Copy-RobocopyAndEmail.ps1
#*============================================= 
```

# android - Android 电池电量小部件

> ID：15672391
> 
> 赞同：0
> 
> 时间：2013-03-28T00:54:11.910
> 
> 标签：android, service, android-appwidget, batterylevel

我正在研究显示剩余电池电量的android小部件。

它似乎在模拟器上工作，除了模拟器的电池电量没有移动，所以我无法进一步测试。在真实设备 (ICS) 上，它只显示初始 textview("TEST") 并且不执行任何其他操作。

显现

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.battery"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="17" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <receiver android:name="main.MyBatteryWidget"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
        </intent-filter>
        <meta-data android:name="android.appwidget.provider"
            android:resource="@xml/widget_info" />
    </receiver>
    <service android:name="main.MyBatteryWidget$BatteryUpdateService"
        android:exported="false" >
        <intent-filter>
            <action android:name="com.example.battery.action.UPDATE" />
        </intent-filter>
    </service>
</application> 
```

小部件信息.xml

```
<?xml version="1.0" encoding="utf-8"?>
<appwidget-provider xmlns:android="http://schemas.android.com/apk/res/android"
    android:updatePeriodMillis="0"
    android:minWidth="40dip"
    android:minHeight="72dip"
    android:initialLayout="@layout/widget_layout" >

</appwidget-provider> 
```

小部件布局.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <TextView android:id="@+id/textView"
        android:text="TEST"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" />

</LinearLayout> 
```

MyBatteryWidget.java

```
package main;

import android.app.Service;
import android.appwidget.AppWidgetManager;
import android.appwidget.AppWidgetProvider;
import android.content.BroadcastReceiver;
import android.content.ComponentName;
import android.content.Context;
import android.content.Intent;
import android.content.IntentFilter;
import android.os.BatteryManager;
import android.os.IBinder;
import android.util.Log;
import android.widget.RemoteViews;

import com.example.battery.R;

public class MyBatteryWidget extends AppWidgetProvider {

    @Override
    public void onUpdate(Context context, AppWidgetManager appWidgetManager,
        int[] appWidgetIds) {
        Log.d("TEST", "onUpdate");
        context.getApplicationContext().startService(new Intent("com.example.battery.action.UPDATE"));
    }

    public static class BatteryUpdateService extends Service {
        private static int level = 0;
        private static int scale = 0;

        private BroadcastReceiver receiver = new BroadcastReceiver(){
            @Override
            public void onReceive(Context context, Intent intent) {
                String action = intent.getAction();

                if (action.equals(Intent.ACTION_BATTERY_CHANGED)) {
                    level = intent.getIntExtra(BatteryManager.EXTRA_LEVEL, -1);
                    scale = intent.getIntExtra(BatteryManager.EXTRA_SCALE, -1);
                    Log.d("TEST", "receive");
                    updateViews(context);
                }
            }
        };

        private void updateViews(Context context) {
            RemoteViews views = new RemoteViews(context.getPackageName(), R.layout.widget_layout);
            views.setTextViewText(R.id.textView, String.valueOf(level / scale));
            ComponentName componentName = new ComponentName(context, MyBatteryWidget.class);
            AppWidgetManager appWidgetManager = AppWidgetManager.getInstance(context);
            appWidgetManager.updateAppWidget(componentName, views);
        }

        @Override
        public int onStartCommand(Intent intent, int flags, int startId) {
            // TODO Auto-generated method stub
            Log.d("TEST", "start");
            registerReceiver(receiver, new IntentFilter(Intent.ACTION_BATTERY_CHANGED));
            return super.onStartCommand(intent, flags, startId);
        }

        @Override
        public IBinder onBind(Intent intent) {
            // TODO Auto-generated method stub
            return null;
        }

    }

} 
```

日志猫

```
03-27 19:51:34.963: D/dalvikvm(608): Not late-enabling CheckJNI (already on)
03-27 19:51:35.043: E/Trace(608): error opening trace file: No such file or directory (2)
03-27 19:51:35.083: D/TEST(608): onUpdate
03-27 19:51:35.103: D/TEST(608): start
03-27 19:51:35.133: D/TEST(608): receive 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T01:15:30.287

```
Intent.ACTION_BATTERY_CHANGED 
```

您必须在 Android Manifest 中收听

```
<receiver android:name=".myReceiver" >
    <intent-filter>
        <action android:name="Intent.ACTION_BATTERY_CHANGED" />
    </intent-filter>
</receiver> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T20:02:53.853

有关工作示例，请查看我的迷你状态小部件，请参阅[代码](https://bitbucket.org/jholetzeck/ministatus-android/src/0d594b5dbe0f/src/de/holetzeck/ministatus/MiniStatusService.java?at=default)

# objective-c - Scanf 倒计时

> ID：15672393
> 
> 赞同：0
> 
> 时间：2013-03-28T00:54:21.180
> 
> 标签：objective-c, xcode4.5, scanf

我正在通过objective-C进行scanf倒计时，因此程序将从您输入的任何数字开始倒计时。但是，代码中有一个烦人的语义错误：格式字符串未使用数据参数。此外，该程序不会倒计时，它只会在我输入数字后将输出显示为零。

```
#import <Foundation/Foundation.h>

int main(int argc, const char * argv[])
{

    @autoreleasepool {

        int x,number;

        NSLog(@"please enter a number:");
        scanf("i", &number);
        for (x = number;  x>=0; x--)
            NSLog(@"%i",x);
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T00:55:37.550

您需要传递`%i`，而`i`不是`scanf`.

当您传递`i`时，格式字符串的格式说明符为零，导致语义分析器产生警告。这也是为什么没有输入`number`变量的原因，所以倒计时也不会发生。

# perl - HTTP::Request 在 perl 中使用 LWP:UserAgent 进行身份验证：CRFS 问题

> ID：15672399
> 
> 赞同：0
> 
> 时间：2013-03-28T00:54:53.950
> 
> 标签：perl, authentication, csrf

我正在尝试使用 perl HTTP:Request 和 LWP:UserAgent 登录一个网站。我添加了我使用 Firebug 找到的所有 http 标头，但无论如何都会收到未定义 CRFS 令牌的错误

```
my $ua = LWP::UserAgent->new(keep_alive=>1);
$useragent->credentials('www.refer.org:80','','maila@gmail.com','pwd');
$request = HTTP::Request->new('POST','https://www.refer.org/account/signin', 
HTTP::Headers->new(<add all headers found in the header>));
$response = $useragent->request($request);
print $response->as_string; 
```

Firebug 找到的标头：

```
Request URL:https://bla/login
Request Method:POST
Status Code:200 OK
Request Headersview source
Accept:*/*
Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3
Accept-Encoding:gzip,deflate,sdch
Accept-Language:en-US,en;q=0.8,de;q=0.6
Connection:keep-alive
Content-Length:58
Content-Type:application/x-www-form-urlencoded
Cookie:logout=1364426556.61; sessionid=47b306354faa7357281a6cb1f0298df1;    maestro_user=%7B%22id%22%3A%22%22%2C%22email_address%22%3A%22%22%2C%22external_id%22%3A%226c104964ceb5d7ceb4575cab729ba7aa%22%2C%22photo_24%22%3A%22%22%2C%22photo_60%22%3A%22%22%2C%22photo_120%22%3A%22%22%2C%22display_name%22%3A%22%22%2C%22full_name%22%3A%22%22%2C%22privacy%22%3A100%2C%22groups%22%3A%5B%5D%2C%22is_superuser%22%3Afalse%2C%22is_staff%22%3Afalse%2C%22identity_verified%22%3Afalse%2C%22locale%22%3A%22en_US%22%2C%22timezone%22%3A%22%22%7D; __utma=158142248.1347071395.1348726747.1364423066.1364426537.88; __utmb=158142248.4.10.1364426537; __utmc=158142248; __utmz=158142248.1348726747.1.1.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided); csrftoken=zUZft9KwWmmogYbjR906daJB
Host:https://www.referer.org/
Origin:https://www.referer.org/
Referer:https://www.referer.org/account/signin
User-Agent:Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.22 (KHTML, like Gecko) Chrome/25.0.1364.172 Safari/537.22
X-CSRFToken:zUZft9KwWmmogYbjR906daJB
X-Requested-With:XMLHttpRequest 
```

如果有人感兴趣，这是 Firebug 中的响应标头

```
Response Headersview source
Cache-Control:no-cache, no-store, must-revalidate
Connection:keep-alive
Content-Encoding:gzip
Content-Length:725
Content-Type:application/json
Date:Wed, 27 Mar 2013 23:23:18 GMT
Server:nginx/1.2.6
Set-Cookie:sessionid=1ac9a133760f02c6fb8c61daebe7fc6d; expires=Wed, 10-Apr-2013 23:23:18 GMT; httponly; Max-Age=1209600; Path=/
Set- Cookie:maestro_login="cuPT1ZexESKY8gOQaLRRoBzxTnS0diEitb7Dy4g9h9FwfWO4PM5ppRYnQlLFM6++HX5TcA1lrrly5Fi/ie1bjw==|mRCAxgo374DL1N6yNRkDOh6Zony+s8InBTugfXb/ovuNff0LfudF6Z6mVP2qz2zxIgZ/kGUCbgRcb7+KUEvLPGY8AWBa2wCAV71fgUaAysm5NAPEaXV0k4C5ErQhOldAMVvyTspAR2PIXT+T2GY0mUGtUUTvZ1G2PI5knDjxQ2lnLuJNjEn0knrOA9bRspfAq8RwCl1cCSO5VjmrSquRlCEUf8MdUBD9Ea3abyKpDyfFx0vMBa2QMjxzOBYGqou8UPDizbjL4E6E5axmXl+wRt+QwpZNHASTh3l3h5Q90R2bWtLWlNQdC+mOlC4p0UXsQkIed9J7WXgQXpYbFNf6R7395LNJhr8mz0lQBWRimGBmqJCfpeKtYYACeH22QtXnRkgQxx44VmZ3XbaiKGKOdL7b/2kw9tJQxFZC/5bPQwemWxmJMfLW8YZtxdcugoKACnpyENjuxlHm7Ndt36KXKIq2rZdtwP8joLYpQQdkc6g="; expires=Fri, 26-Apr-2013 23:23:18 GMT; Max-Age=2592000; Path=/
Vary:Cookie
Vary:Accept-Encoding 
```

以及我执行 perl 代码时的响应

```
HTTP/1.1 403 FORBIDDEN
Cache-Control: no-cache, no-store, must-revalidate
Connection: keep-alive
Date: Thu, 28 Mar 2013 07:17:48 GMT
Server: nginx/1.2.6
Vary: Accept-Encoding
Content-Length: 1006
Content-Type: text/html; charset=utf-8
Content-Type: text/html; charset=utf-8
Client-Date: Thu, 28 Mar 2013 07:17:48 GMT
Client-Peer: xxx
Client-Response-Num: 1
Client-SSL-Cert-Issuer: /C=US/ST=Arizona/L=Scottsdale/O=GoDaddy.com,    
Inc./OU=http://certificates.godaddy.com/repository/CN=Go Daddy Secure Certification   
Authority/serialNumber=07969287
Client-SSL-Cert-Subject: /O=*.refer.org/OU=Domain Control Validated/CN=*.refer.org
Client-SSL-Cipher: AES256-SHA
Client-SSL-Warning: Peer certificate not verified
Title: 403 Forbidden
X-Meta-Robots: NONE,NOARCHIVE

<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="robots" content="NONE,NOARCHIVE">
<title>403 Forbidden</title>
<style type="text/css">
html * { padding:0; margin:0; }
body * { padding:10px 20px; }
body * * { padding:0; }
body { font:small sans-serif; background:#eee; }
body>div { border-bottom:1px solid #ddd; }
h1 { font-weight:normal; margin-bottom:.4em; }
h1 span { font-size:60%; color:#666; font-weight:normal; }
#info { background:#f6f6f6; }
#info ul { margin: 0.5em 4em; }
#info p, #summary p { padding-top:10px; }
#summary { background: #ffc; }
#explanation { background:#eee; border-bottom: 0px none; }
</style>
</head>
<body>
<div id="summary">
<h1>Forbidden <span>(403)</span></h1>
<p>CSRF verification failed. Request aborted.</p>

</div>
<div id="explanation">
<p><small>More information is available with DEBUG=True.</small></p>
</div>

</body>
</html> 
```

我没有使用“https://bla/login”，因为链接上的网站永久不可用

我明天会试试万维网：机制。但是在这里我想知道是否还有其他方法来定义 CSRF 标头？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:52:18.850

我在您的代码中看到了很多问题：

*   **您不**发布而是获取（您没有使用您的`$req` 对象！）。
*   **您不会向**目标站点发送 cookie，但 Firefox 会发送一些 cookie。
*   **您也没有设置Referer标头**。

生命短暂，所以使用 WWW::Mechanize 代替普通的 LWP...

PS你可以这样设置标题：

```
$req->header("X-CSRFToken" => "zUZft9KwWmmogYbjR906daJB", Referer => 'http://ww
w.test.com/', "X-Requested-With" => "XMLHttpRequest"); 
```

*强调文本*

# excel - Excel根据单元格内容过滤数据验证列表

> ID：15672404
> 
> 赞同：3
> 
> 时间：2013-03-28T00:55:29.157
> 
> 标签：excel, filter, validation

我目前有一个看起来像这样的表：

```
 |   A   |     B     |
  +-------+-----------+
1 | State | City      |
  +=======+===========+
2 | NSW   | Goulburn  |
3 | NSW   | Sydney    |
4 | VIC   | Melbourne |
5 | VIC   | Horsham   |
6 | NSW   | Tamworth  | 
```

然后我有另一个看起来像这样的表：

```
 |   A   |     B     |      C     |
  +-------+-----------+------------+
1 | State | City      | Other data |
  +=======+===========+============+
2 |       |           |            | 
```

在第二个表中，我对 State 和 City 列应用了数据验证，并引用了第一个表中的数据。所以我有所有州和城市的下拉列表。

我想要做的是，如果用户在州列中输入“新南威尔士州”，城市列中的选项列表将被过滤以仅显示位于新南威尔士州的城市

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T00:19:19.447

将它放在工作表的代码模块中。

更改 的定义`shTable`以引用查找表所在的工作表。

```
Private Sub Worksheet_Change(ByVal Target As Range)
Dim myVal As String
Dim cityList As String
Dim table As Range
Dim cl As Range
Dim shTable As Worksheet: Set shTable = Sheets("Index") '<modify as needed'

If Intersect(Target, Range("A:A")) Is Nothing Then Exit Sub

myVal = Target.Value
With shTable
    Set table = .Range("A2", .Range("A2").End(xlDown)) 'contains your city/state table'
End With
    For Each cl In table
    'Build a comma-separated list of matching cities in the state.'
        If cl.Value = myVal Then
            If cityList = vbNullString Then
                cityList = cl.Offset(0, 1)
            Else:
                If InStr(1, cityList, cl.Offset(0,1).Value, vbBinaryCompare) > 0 Then
                'avoid duplicates, but this is not a foolproof method.'
                'probably should rewrite using an array or scripting dictionary'
                'otherwise the possibility of partial match is a potential error.'
                    cityList = cityList & "," & cl.Offset(0, 1)
                End If
            End If

        End If
    Next

'Now, with the cell next to the changed cell, remove '
' any existing validation, then add new validation '
' based on the cityList we compiled above.
With Target.Offset(0, 1).Validation
    .Delete
    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
    xlBetween, Formula1:=cityList
    .IgnoreBlank = True
    .InCellDropdown = True
    .InputTitle = ""
    .ErrorTitle = ""
    .InputMessage = ""
    .ErrorMessage = ""
    .ShowInput = True
    .ShowError = True
End With

End Sub 
```

# java - 使用 java GUI 备份 MYSQL

> ID：15672412
> 
> 赞同：2
> 
> 时间：2013-03-28T00:56:20.207
> 
> 标签：java, mysql, mysqldump, restore, database-backups

我正在尝试备份我的数据库，这是我编写的代码，但由于某种原因它没有备份？我正在使用`local host (MAMP)`，我正在使用的操作系统是`MAC OSX`.

```
public boolean databaseBackup(String dbName, String dbUserName, String dbPassword, String path) {
        String qu = "/Applications/MAMP/Library/bin/mysqldump -u" + dbUserName + " -p" + dbPassword + " --database" + dbName + " -r " + path;

System.out.println(qu);

Process runtimeProcess;

Properties pr = new Properties();

pr.setProperty("user", "username");

pr.setProperty("password", "password");

    Connection con = null;

    PreparedStatement stmt = null;

    try {
        con = DriverManager.getConnection("jdbc:mysql://localhost:8889/Database", pr);
        runtimeProcess = Runtime.getRuntime().exec(qu);
        int processComplete = runtimeProcess.waitFor();
        if (processComplete == 0) {
            System.out.println("5");

            System.out.println("Backed up");
            return true;
        } else {
            System.out.println("Not Backed up");
        }
    } catch (Exception ex) {
        ex.printStackTrace();
    }
    return false;
} 
```

}

* * *

在我的 jframe 表单中，我写了这个：

```
code.databaseBackup("Database","root", "root", "/Users/dipeshramesh/Dropbox/TeamProject/TeamProject2.sql"); 
```

因此，当一个人按下备份按钮时，它会调用`code.databaseBackup`方法并执行其工作。

如果我运行它，它会显示一条消息“未备份”，知道吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T05:51:56.747

采用`String qu = "/Applications/MAMP/Library/bin/mysqldump -u" + dbUserName + " -p" + dbPassword + " --database" + dbName + " > " + path;`

命令 -`/Applications/MAMP/Library/bin/mysqldump -u yourUser -p --opt yourdb > yourdump.sql`

# grails - Grails 2.2.1 没有读取插件配置文件

> ID：15672415
> 
> 赞同：0
> 
> 时间：2013-03-28T00:57:13.177
> 
> 标签：grails, upgrade, config

我有一个应用程序和一个使用 Grails 2.1.1 构建的插件，我升级到了 2.2.1，但我遇到了一个奇怪的问题。我的应用程序开始崩溃，因为我的应用程序`Config.groovy`中定义的配置值突然解析为`groovy.Util.ConfigObject`它们的实际值而不是它们的实际值。这是问题的第 1 部分，第 2 部分是在我的应用程序中，我在我的应用程序中定义`Config.groovy`

```
grails.config.defaults.locations = [
    "classpath:DemoPluginConfig.groovy",
] 
```

`DemoPluginConfig.groovy`包含此属性

```
oo.memcached.timeout=400000 
```

并且该`DemoPluginConfig.groovy`文件位于`src/java`我的 Demo 插件的文件夹中。我有一个 memcache 服务，一旦服务准备好，我将尝试设置该超时属性：

```
def void afterPropertiesSet() {

        ConnectionFactoryBuilder cfb = new ConnectionFactoryBuilder()
        def config = grailsApplication.config;
        def operationTimeOut = config.oo.memcached.timeout
        cfb.setOpTimeout(timeOut)

    } 
```

grails run-app 此时出现错误：

```
Caused by MissingMethodException: No signature of method: net.spy.memcached.ConnectionFactoryBuilder.setOpTimeout() is applicable for argument types: (groovy.util.ConfigObject) values: [[:]]
Possible solutions: setOpTimeout(long)
->>   55 | unwrap                          in org.codehaus.groovy.runtime.ScriptBytecodeAdapter
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|     46 | call                            in org.codehaus.groovy.runtime.callsite.PojoMetaClassSite
|     45 | defaultCall . . . . . . . . . . in org.codehaus.groovy.runtime.callsite.CallSiteArray
|    108 | call                            in org.codehaus.groovy.runtime.callsite.AbstractCallSite
|    116 | call . . . . . . . . . . . . .  in     ''
|     20 | afterPropertiesSet              in com.millennialmedia.ui.core.MemcachedService
|   1514 | invokeInitMethods . . . . . . . in org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory
|   1452 | initializeBean                  in     ''
|    519 | doCreateBean . . . . . . . . .  in     ''
|    122 | doCreateBean                    in org.codehaus.groovy.grails.commons.spring.ReloadAwareAutowireCapableBeanFactory
|    456 | createBean . . . . . . . . . .  in org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory
|    271 | resolveInnerBean                in org.springframework.beans.factory.support.BeanDefinitionValueResolver
|    126 | resolveValueIfNecessary . . . . in     ''
|   1360 | applyPropertyValues             in org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory
|   1118 | populateBean . . . . . . . . .  in     '' 
```

如果我尝试再运行 grails run-app 几次，它会成功启动，但应用程序在加载另一个页面时崩溃，这`groovy.Util.ConfigObject`是不可序列化的错误。在应用程序崩溃之前逐步调试表明，当我们到达该`setOptTimeOut`行时，`grailsApplication.config`只包含我应用程序的 Config.groovy 中的配置选项，就好像插件中的值`DemoPLuginConfig.groovy`被忽略了一样。

恢复到 2.1.1 使一切恢复正常。在这一点上，我不知道在哪里看。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T02:37:20.847

尝试将 Groovy 配置放在*grails-app/conf*而不是*src/java*中。然后，看看您是否可以在一致的基础上重现您的错误。

如果一切都失败了，*grails clean*可能会占上风。

希望能帮助到你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T01:32:25.393

你不应该使用`operationTimeOut`而不是`timeOut`下面

```
cfb.setOpTimeout(timeOut) 
```

# python - 隐式与显式对象方法内存基准差异

> ID：15672416
> 
> 赞同：1
> 
> 时间：2013-03-28T00:57:16.667
> 
> 标签：python, oop, memory, timeit

我对将对象传递给方法的两种不同方法进行了基准测试，隐式对象传递比显式方法花费的时间更少。我的书说这些是相同的过程。什么解释了差异？

首先，这是类定义：

```
class Point:
    def reset(self)
        self.x = 0
        self.y = 0 
```

因此，当我在以下两组代码中的每一个上运行“timeit”时，第一个每个循环返回 317 ns，第二个每个循环返回 400 ns。这是隐式的对象方法传递代码，其中 Python 将对象传递给幕后的方法：

```
p = Point()
p.reset() 
```

这是明确的替代方案：

```
p = Point()
Point.reset(p) 
```

有人可以告诉我解释基准差异的内存分配级别发生了什么吗？一种方式比另一种方式更“pythonic”吗？为什么程序员会选择一个而不是另一个（超出速度）？

谢谢，

迈克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T01:05:44.017

我相信第一种方法更 Pythonic，因为`reset`它是 object 的方法`p`，而不是 class 的 classmethod `Point`。区别基本上是，方法是`reset`属于类`Point`还是属于类的对象`Point`？

使用第一种方法使代码更易于理解，如果您想使用第二种样式，您可以将其设为 a`staticmethod`以表明该方法是从实例调用的，`class`而不是从实例调用的（这有点糟糕的设计）。

这纯粹是根据我的经验。

# list - （方案）找出列表中的某些数字加起来是否等于某个数字？

> ID：15672422
> 
> 赞同：1
> 
> 时间：2013-03-28T00:58:01.877
> 
> 标签：list, scheme

我正在制作一个带有列表和总和的程序。如果列表中的某些数字加起来等于总和，则返回 true。否则，返回假。它似乎适用于某些情况，但不适用于其他情况。例如，

如果我输入这个：

```
(numlist-sum '(5 9) 9) 
```

它应该返回 true，因为其中一个数字 (9) 等于总和 (9)。但是，由于某种原因，它返回错误。

我无法弄清楚问题是什么。请帮忙？

```
(define (numlist-sum? ls sum)
  (if (null? ls) #t
    (if (and (null? (cdr ls)) (equal? (car ls) sum)) #t
      (if (equal? (car ls) sum) #t
          (if (equal? (cdr ls) sum) #t
              (if (equal? (apply + (car ls) (cdr ls)) sum) #t
                  #f)))))) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T01:14:06.043

我会给你一些解决这个问题的提示（看起来像家庭作业）。首先编写一个生成列表所有可能子集的过程（例如，列表的[幂集](http://en.wikipedia.org/wiki/Power_set)）。例如：

```
(powerset '(1 2 3))
=> '(() (1) (2) (3) (1 2) (1 3) (2 3) (1 2 3)) 
```

有了上面的过程（并且很容易找到算法，Google 是你最好的朋友），只需遍历每个子列表并将其值相加即可：

```
(apply + '(2 3))
=> 5 
```

如果其中一个子列表的总和等于预期值，则返回`#t`。如果没有一个总和满足预期值，则返回`#f`。

**编辑：**

我忘了提，这是一个众所周知的问题 - 它是[子集和问题，可以使用](http://en.wikipedia.org/wiki/Subset_sum_problem)[动态编程](http://en.wikipedia.org/wiki/Dynamic_programming)有效地解决（至少，比生成幂集更有效）。但我不认为这特别是本作业的目标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T15:04:56.963

这是一个解决方案，它逐个检查每个元素，然后如果第一个元素不是总和，则向下递归列表。

```
(define (numlist-sum list sum)
  (and (not (null? list))
       (let ((head (car list)))
         (cond ((number? head)
                (or (= sum head)
                    (numlist-sum (cdr list) sum)))
               ((list? head)
                (or (= sum (apply + head))
                    (numlist-sum (cdr list) sum)))
               (else 'ill-formed-list))))) 
```

另外，请注意，您的代码可以重写为：

```
(define (numlist-sum? ls sum)
  (or (null? ls)
      (if (and (null? (cdr ls)) (equal? (car ls) sum))
      (equal? (car ls) sum)
      (equal? (cdr ls) sum)
      (equal? (apply + (car ls) (cdr ls)) sum))) 
```

我想说 '(if pred #t else ...) 的使用有点尴尬，并且隐藏了代码的真实逻辑。

# c# - 应用程序中的全局设置

> ID：15672426
> 
> 赞同：1
> 
> 时间：2013-03-28T00:58:23.220
> 
> 标签：c#, asp.net-mvc

在具有多个程序集的 ASP.NET MVC 应用程序上，我需要访问一些设置。

基本上。这些设置是来自 Web.Config AppSettings 的常量或值。

`Settings`我的想法是在我需要的地方注入一个类，作为一个单例：

```
public interface ISettings {
  LoggerSettings Logger { get; }
} // ISettings

public class LoggerSettings {
  public String Levels { get { return ConfigurationManager.AppSettings["Logger.Levels"]; } }
  public const String Report = "team@xyz.com";
} // LoggerSettings

public class Settings : ISettings {
  public LoggerSettings Logger { get; private set; }

  public Settings() {
    Logger = new LoggerSettings();
  }
} // Settings 
```

1.  您如何看待这种方法并将类作为单例注入？

2.  在这种情况下，我是否需要将任何类/属性设置为静态？我想我需要将 LoggerSettings 及其属性设为静态，不是吗？否则我需要在构建设置时创建一个新实例？

有人可以请教我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T01:02:02.270

如果您实际上是在*注入*您的类（通过 DI 框架），并且“单例”意味着您在 DI 框架中使用了单例“范围”，那么这种方法就可以正常工作。如果这实际上是您正在做的事情，那么您的所有属性都不需要是静态的，因为相同的“单例”实例将被注入到任何依赖它的类中。

# ruby-on-rails - Capybara::InfiniteRedirectError

> ID：15672427
> 
> 赞同：5
> 
> 时间：2013-03-28T00:58:29.567
> 
> 标签：ruby-on-rails, cucumber, capybara

使用 OmniAuth（使用 omniauth_crowd），如果用户未提交正确的用户名和密码，我希望将用户重定向回登录页面。它在生产中运行良好，但我在测试它时遇到了烦人的问题。

为了模拟 OmniAuth 提供程序，我使用了 OmniAuth 插件作者推荐的以下代码：

```
OmniAuth.config.test_mode = true
OmniAuth.config.mock_auth[:someProvider] = :invalid_credentials
visit_page @page 
```

上面的代码会自动（即无需输入用户名和密码）将 Capybara 重定向到`session#failure`. 我的`session#failure`重定向到`login_path`.

因此我最终陷入了一个循环：

```
redirected more than 5 times, check for infinite redirects. (Capybara::InfiniteRedirectError) 
```

对于我的情况，最好的解决方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T22:43:12.777

我对 Omniauth 有一个类似的问题。
不确定是否有解决方法，因为它是有效的方式`OmniAuth.config.mock_auth`。

我的解决方案是使用`fakeweb`而不是 OmniAuth 模拟。
您可能应该从查看omniauth_crowd 自身的测试方式开始。
这是一个很好的例子： [https ://github.com/robdimarco/omniauth_crowd/blob/master/spec/omniauth/strategies/crowd_spec.rb#L49-69](https://github.com/robdimarco/omniauth_crowd/blob/master/spec/omniauth/strategies/crowd_spec.rb#L49-69)

# django - 从对象获取动态值

> ID：15672434
> 
> 赞同：0
> 
> 时间：2013-03-28T01:00:04.410
> 
> 标签：django

在保存我的一个 django 模型时，我使用 django-dirtyfields 来获取所有已更改的字段。它们不存储新值，所以我所做的是将所有脏字段（更改的字段）抓取到一个名为dirty_fields 的列表中。然后我保存对象，然后尝试将新字段的所有值获取到它们已更改的值。为什么我所拥有的不起作用？我得到'对象没有属性'字段'

```
new_values = ['{0}: {1}'.format(field,self.field) for field in dirty_fields] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:28:36.083

`dirty_fields`将是更改字段的字典。例如

```
{'boolean': True, 'characters': 'testing'} 
```

当您使用 进行迭代时`for field in dirty_fields`，`field`指的是字典键，例如`'boolean'`and `'characters'`。您不能使用，因为这将尝试在您的实例上`self.field`查找属性名称。`field`

相反，您需要获取键值，并要求使用[getattr()](http://docs.python.org/2/library/functions.html#getattr)`field`在 self 的实例上查找此字段。

试试这个：

```
new_values = ['{0}: {1}'.format(field, getattr(self, field)) for field in dirty_fields] 
```

# sybase - Sybase 中的大型更新

> ID：15672436
> 
> 赞同：1
> 
> 时间：2013-03-28T01:00:19.927
> 
> 标签：sybase, updates, long-integer

我需要您的帮助来解决我在进行大型更新时遇到的问题。嗨，我们想为开发人员/测试人员创建一个服务器，并且我们希望从生产中获得一个副本，所以我们想用我执行更新时生成的随机 NSS 来混淆 NSS，所以我创建了一个执行此操作的函数过程。这是它的更新：

```
UPDATE CUSTOMERS SET 
NAME = 'John',
LAST NAME ='Doe',
NSS = RandomNSS    
plan '(i_scan PK_CUSTOMERS CUSTOMERS)' 
```

更新工作正常，除了表的长度为 900 万，因此我暂停了日志或您没有锁定的消息，因此该过程永远不会完成，所以我尝试实现以下内容：

```
SET ROWCOUNT  10000 

WHILE (1 = 1) 
  BEGIN 
    BEGIN TRANSACTION
UPDATE CUSTOMERS SET
NAME = 'John',
LAST NAME ='Doe',
NSS = RandomNSS    
plan '(i_scan PK_CUSTOMERS CUSTOMERS)'

    IF @@ROWCOUNT = 0 
      BEGIN 
        COMMIT TRANSACTION        
        BREAK 
      END     
    COMMIT TRANSACTION 
  END 

SET ROWCOUNT  0 
```

但这并没有解决问题，因为我没有 where 子句，所以即使所有客户的名字都是 John Doe，更新也永远不会完成，所以你能帮我创建一个查询来帮助我完成这个过程吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T02:09:28.537

首先，在 DEV 系统上，我将更改数据库的设置，以便它在检查点时截断事务日志。这将在您完成更新时防止日志被填满。因为 DEV 数据库是从 PROD 数据库恢复的，所以为了可恢复性转储事务日志并不重要。

```
sp_dboption DEV_DB, 'trunc log on chkpt', true 
```

如果您必须进行更新，请尝试更改 while 循环以继续，直到所有名称都更改为“John”，如下所示。

```
SET ROWCOUNT 10000

while ( select count(*) from CUSTOMERS where name != "John" and LAST_NAME != 'Doe' ) > 0
BEGIN
  BEGIN TRANSACTION
   UPDATE CUSTOMERS SET
     NAME = 'John',
     LAST NAME ='Doe',
     NSS = RandomNSS
   WHERE name != "John" AND LAST_NAME != "DOE"    
     plan '(i_scan PK_CUSTOMERS CUSTOMERS)'
   COMMIT TRANSACTION 
END 

SET ROWCOUNT  0 
```

或者，您可以在数据库上创建一个视图，获取您想要的生产数据，同时隐藏您不希望开发人员看到的字段。然后可以使用此视图**选择到DevelopmentDB，或使用****bcp**导出/导入

 **```
create view DEV_VIEW (NAME, LAST_NAME, NSS, colA, colB) as
select "John", "Doe", RandomNSS, other_colA, other_colB
from CUSTOMERS 
```**

# java - selenium executeScript 挂在 IE 上

> ID：15672440
> 
> 赞同：3
> 
> 时间：2013-03-28T01:00:30.913
> 
> 标签：java, javascript, internet-explorer, selenium, webdriver

好的，我已经在网上搜索了 2 天来解决模态对话框问题。那里有很好的信息，除了 IE 之外，一切都有效。我正在尝试打开文件上传对话框并选择一个新文件。我创建了 autoIT 脚本，它们在 FF 和 Chrome 上运行得很好。当我尝试使用 IE 时，“executeScript”不会返回到我的测试脚本。在 IE 中打开“文件上传”对话框。但这就是我的脚本停止的地方。如果我手动运行 autoIT 脚本，它会在“文件上传”对话框关闭后返回到测试脚本。

```
//WebDriver driver = new FirefoxDriver();
// processPage(driver);
WebDriver ieDriver =new InternetExplorerDriver();
processPage(ieDriver);
// WebDriver chromeDriver = new ChromeDriver();
// processPage(chromeDriver); 
```

. . . 其他代码。.

```
WebElement element = driver.findElement(By.name(uploadDifferntFile));
if (driver instanceof InternetExplorerDriver) {
  ((InternetExplorerDriver) driver).executeScript("arguments[0].click();", element);

} else if(driver instanceof FirefoxDriver){
  ((FirefoxDriver) driver).executeScript("arguments[0].click();", element);

} else if(driver instanceof ChromeDriver){
  ((ChromeDriver) driver).executeScript("arguments[0].click();", element);

} 
```

. . . 汽车信息技术。. .

```
try {
    Process proc = Runtime.getRuntime().exec(fileToExecute);
} catch (IOException e) {
    System.out.println("Failed to execute autoIT");
    e.printStackTrace();
} 
```

感谢你的支持

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T21:42:04.027

它似乎与在 IE 中的参数 [0].click 操作期间调用的模态对话框有关，请参阅[https://code.google.com/p/selenium/wiki/InternetExplorerDriver](https://code.google.com/p/selenium/wiki/InternetExplorerDriver)，部分“单击元素或提交表单和警报（ )”，我认为它描述了同样的问题。

尝试的几个选项是：

1.  将您的 JavaScript 代码替换为“element.click()”或“element.sendKeys(Keys.ENTER)”
2.  在执行参数 [0] 之前启动一个新线程。单击，在该线程中稍等片刻，然后运行 ​​autoIt 代码

您也可以用 JavascriptExecutor 替换现有代码，只编写一次 JavaSrcipt：

```
WebElement element = driver.findElement(By.name(uploadDifferntFile));
if (driver instanceof JavascriptExecutor) {
  ((JavascriptExecutor) driver).executeScript("arguments[0].click();", element);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-26T09:26:24.477

我刚刚遇到了同样的问题，因为 sendKeys 不是我使用 Internet Explorer 的稳定解决方案。所以我用 AutoIt 构建了一个变体。

对于 Firefox，我使用 JavaScript，对于 IE，我双击输入字段：

```
// fileInput is the WebElement resulting from the input field with type file
if (browser == "FF") {
    JavascriptExecutor executor = (JavascriptExecutor)driver;
    executor.executeScript("arguments[0].click();", fileInput);
} else {
    Actions action = new Actions(driver);
    Action doubleClick = action.doubleClick(fileInput).build();
    doubleClick.perform();
} 
```

# content-management-system - 在 liferay 中以编程方式执行工作流转换？

> ID：15672441
> 
> 赞同：2
> 
> 时间：2013-03-28T01:00:34.850
> 
> 标签：content-management-system, workflow, portlet, liferay-6

我在工作流的最后一步有两个名为“已批准”和“拒绝”的转换，但我想从我的 portlet 控制工作流操作。

有人知道如何在 liferay 中以编程方式执行工作流转换吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-16T00:55:42.397

我当前的代码

```
 JournalArticle journalArticle = JournalArticleLocalServiceUtil.getArticle(id);
            getPermissionChecker().init(u.getUser(), true);

            WorkflowInstanceLink wil= WorkflowInstanceLinkLocalServiceUtil.getWorkflowInstanceLink(companyId, journalArticle.getGroupId(), JournalArticle.class.getName(), journalArticle.getId());
            WorkflowInstance workflowInstance = WorkflowInstanceManagerUtil.getWorkflowInstance(companyId, wil.getWorkflowInstanceId());
            Map<String, Serializable> workflowContext = workflowInstance.getWorkflowContext();

            List<Integer> logTypes_assign = new ArrayList<Integer>();
            logTypes_assign.add(WorkflowLog.TASK_ASSIGN);
            List<WorkflowLog> workflowLogs_assign = WorkflowLogManagerUtil.getWorkflowLogsByWorkflowInstance(companyId, wil.getWorkflowInstanceId(), logTypes_assign, QueryUtil.ALL_POS, QueryUtil.ALL_POS, WorkflowComparatorFactoryUtil.getLogCreateDateComparator(true));
            //WorkflowPermissionUtil.hasPermission(permissionChecker, groupId, className, classPK, actionId);

            if(workflowLogs_assign.size() > 0){             
                long taskId = workflowLogs_assign.get(workflowLogs_assign.size()-1).getWorkflowTaskId();
                WorkflowTask task = WorkflowTaskManagerUtil.getWorkflowTask(companyId, taskId);
                _log.info("task : "+task.getName());
                WorkflowTask nextTask = WorkflowTaskManagerUtil.assignWorkflowTaskToUser(companyId, userId, task.getWorkflowTaskId(), userId, "auto assign", task.getDueDate(), workflowContext);               
                WorkflowTaskManagerUtil.completeWorkflowTask(companyId, userId, nextTask.getWorkflowTaskId(), "next task transition name", "next task name", workflowContext);
            } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-12T16:00:50.053

```
workflowInstance1 = WorkflowInstanceManagerUtil.signalWorkflowInstance(service.getCompanyId(), user.getUserId(),
            workflowInstanceId, transitionNAME, workflowInstance.getWorkflowContext()); 
```

# javascript - Facebook Like Box HTML5 不工作

> ID：15672443
> 
> 赞同：1
> 
> 时间：2013-03-28T01:00:39.167
> 
> 标签：javascript, facebook, html, twitter

当我使用 HTML5 代码并且我无法使用 iframe 时，Facebook Like Box 不起作用，因为它会阻止我网站上的某些链接工作。我已经尝试将 js 定位在 body 标记之后，但它仍然不起作用。

```
<script>(function(d, s, id) {
var js, fjs = d.getElementsByTagName(s)[0];
if (d.getElementById(id)) return;
js = d.createElement(s); js.id = id;
js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=458816400855910";
fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script> 
```

twitter 小部件可能会干扰它，但似乎只有 Facebook 小部件受到影响。

```
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="http://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-25T08:20:40.200

更改以下内容

```
js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=458816400855910"; 
```

至

```
js.src = "**https:**//connect.facebook.net/en_US/all.js#xfbml=1&appId=458816400855910"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T01:33:07.757

在身体标签之后？！

让它在最后，即

```
<html>
<body>

    Place the stuff here, between the body tag!

</body>
<!-- NOT HERE, not AFTER! -->
</html> 
```

# c# - 如何使用 Visual Studio 2010 将 Windows 控制台应用程序 C# 项目更改为 Windows 服务？

> ID：15672447
> 
> 赞同：2
> 
> 时间：2013-03-28T01:01:27.623
> 
> 标签：c#, visual-studio-2010, service, windows-services, console-application

我使用[本教程](http://www.codeproject.com/Articles/3938/Creating-a-C-Service-Step-by-Step-Lesson-I)使用 Visual Studio 2010 及其股票控制台应用程序项目创建 C# Windows 服务，但是在我更改了所有内容并尝试安装它之后：

> "C:\Windows\Microsoft.NET\Framework\v4.0.30319\installutil" /i myservice.exe

我在控制面板的服务列表中没有看到我的服务。然后我检查了输出`installutil`并发现了这条消息：

> 删除 InstallState 文件，因为没有安装程序。

我不确定它为什么这么说，因为我确实有一个安装程序类，定义如下：

```
namespace MySrvr
{
    class MyServiceInstaller : System.Configuration.Install.Installer
    {
        public MyServiceInstaller()
        {
            ServiceProcessInstaller process = new ServiceProcessInstaller();

            process.Account = ServiceAccount.LocalSystem;

            ServiceInstaller serviceAdmin = new ServiceInstaller();

            serviceAdmin.StartType = ServiceStartMode.Automatic;

            serviceAdmin.ServiceName = "MyServiceName";
            serviceAdmin.DisplayName = "My Service Display Name";
            serviceAdmin.Description = "My Service Description";

            Installers.Add(process);
            Installers.Add(serviceAdmin);
        }

    }
} 
```

那么我在这里做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-28T03:26:23.287

好，我知道了。两个错误：

1.  安装程序类必须声明为`public`

2.  `[RunInstaller(true)]`它前面必须有属性。

像这样：

```
namespace MySrvr
{
    [RunInstaller(true)]
    public class MyServiceInstaller : System.Configuration.Install.Installer
    {
    }
} 
```

的版本`installutil`与它无关。

# python - pandas combine_first 与特定的索引列？

> ID：15672450
> 
> 赞同：2
> 
> 时间：2013-03-28T01:02:00.113
> 
> 标签：python, pandas

我正在尝试在 pandas 中加入两个数据框以具有以下行为：我想加入指定的列，但有它所以冗余列不会添加到数据框中。这类似于`combine_first`except`combine_first`似乎不采用索引列可选参数。例子：

```
# combine df1 and df2 based on "id" column
df1 = pandas.merge(df2, how="outer", on=["id"]) 
```

上面的问题是除“id”之外的 df1/df2 共有的列将被添加两次（带`_x,_y`前缀）到 df1。我该怎么做：

```
# Do outer join from df2 to df1, matching items by "id" but not adding
# columns that are redundant (df1 takes precedence if the values disagree)
df1.combine_first(df2, on=["id"]) 
```

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:43:55.197

如果您尝试在排除任何冗余列的同时将列合并到，则以下内容应该有效`df2`。`df1`

```
df1.set_index("id", inplace=True)
df2.set_index("id", inplace=True)
df3 = df1.merge(df2.ix[:,df2.columns-df1.columns], left_index=True, right_index=True, how="outer") 
```

但是，这显然不会使用来自的值更新*任何*值，因为它只会引入非冗余列。但是，既然您说将优先考虑任何不同意的价值观，也许这会奏效？`df1``df2``df1`

# python - 在python中只重复一次字符正则表达式

> ID：15672457
> 
> 赞同：0
> 
> 时间：2013-03-28T01:02:56.707
> 
> 标签：python, regex

我只想在字符串中间匹配一次重复字符（/）。一开始它必须是[http://www.website/shop](http://www.website/shop)。现在我正在使用这段代码，它匹配所有的 html。我该如何限制它。

'^[http://www.website/shop/].*.html$'

使用这个正则表达式，没有结果 ^[http://]\W*(/){2}\W

有效的

```
 http://www.website/shop/men.html
   http://www.website/shop/women.html 
```

无效的

```
 http://www.website/shop/men/footwear.html
   http://www.website/shop/men/causal.html
   http://www.website/shop/women/footwear.html 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:12:11.003

这个正则表达式应该工作

```
"http://www.website/shop/\w*.html" 
```

...如果在斜线之后还有另一个斜线，它将不匹配`.../shop/`

# android - 在活动之间导航时如何提供动画？

> ID：15672467
> 
> 赞同：-3
> 
> 时间：2013-03-28T01:03:24.863
> 
> 标签：android, android-animation

我想在使用滑动的活动之间导航时提供动画。请注意，它不是“片段”而是“活动”。我设法在活动之间导航。现在我想为它制作动画。请告诉我该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:11:40.220

您可以使用[`overridePendingTransition (int enterAnim, int exitAnim)`](http://developer.android.com/reference/android/app/Activity.html#overridePendingTransition%28int,%20int%29)动画来制作活动之间的过渡。只需在开始新活动之前调用它。

# r - 在 R 中一次遍历 10 列

> ID：15672468
> 
> 赞同：2
> 
> 时间：2013-03-28T01:03:35.023
> 
> 标签：r, traminer, sequence-alignment

我有一个包含 1000 列的数据框。我试图一次循环超过 10 列，并使用包中的`seqdef()`函数`TraMineR`对这些列中的数据进行序列对齐。因此，我想将此函数应用于第一次复飞中的第 1-10 列，以及第二次复飞中的第 11-20 列，一直到 1000。

这是我正在使用的代码。

```
library(TraMineR)
by(df[, 1:10], seqdef(df)) 
```

但是，这只循环前 10 个然后停止。如何在 10 列的块中循环它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T01:24:33.930

您可以使用`mapply`并设置要循环的列序列来执行类似的操作。

```
colpicks <- seq(10,1000,by=10)
mapply(function(start,stop) seqdef(df[,start:stop]), colpicks-9, colpicks) 
```

# jquery - 如果隐藏的所有 div 否则在 div 之间淡出，我如何使用 jQuery slideToggle？

> ID：15672469
> 
> 赞同：0
> 
> 时间：2013-03-28T01:04:01.557
> 
> 标签：jquery, fade, slidetoggle

在我的公司网站上，我正在尝试创建一个与团队会面的部分，其中我有一排四个团队成员的缩略图，我希望他们的简历在单击缩略图时滑动/淡入下方，并在缩略图时滑动/淡出再次点击。

我用下面的代码实现了这一点：

```
$(".team-desc").hide(); //hide all the team descriptions

  $(".team-toggle").click(function () {
        var divname= this.getAttribute('data-team');
          $("#"+divname)
          .slideToggle("slow")
          .animate(
            { opacity: 1 },
            { queue: false, duration: 'slow' }
            )
          .siblings()
          .hide();
        }); 
```

这几乎可以按预期工作。

我想要实现的是一种在 bios 之间淡入淡出的方法，如果一个 bios 已经可见，以避免在团队成员 bios 之间切换时我目前得到的折叠然后扩展效果。

我假设这需要通过测试当前是否可见任何 bio div 来完成，但我不确定如何分解代码以使其工作。

任何帮助或指示将不胜感激。

有关信息，我的 html 标记是：

```
<li class="team-toggle" data-team="<?php the_title(); ?>"><?php the_post_thumbnail(); ?></li> 
```

和

```
<div class="team-desc" id="<?php the_title(); ?>">
   <?php the_content(); ?>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T01:14:39.580

```
$(".team-desc").hide();

$(".team-toggle").click(function () {
    var divname = $(this).data('team'),
        visible = $(".team-desc").is(':visible');

    if (visible) {
        $("#"+divname).fadeIn('slow').siblings(':visible').fadeOut('slow');
    }else{
        $("#"+divname)
              .slideToggle("slow")
              .animate(
                { opacity: 1 },
                { queue: false, duration: 'slow' }
               )
              .siblings()
              .hide();
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T01:18:17.697

您始终可以使用以下方法选择所有元素`$.each()`并对其进行操作：

```
$('.your-elements').each(function(){
    $(this).click(function() {
    if ($(this).is(':visible')) {
        $('.your-elements').not($(this)).stop().animate({
           // ...
        });
    } else {
        $(this).stop().animate({
            // ...
        });
        $('.your-elements').not($(this)).stop().animate({
           // ...
        });
    }
    });
}); 
```

# r - 制作每个表格行的 bin 并在 R 中绘制堆栈条图

> ID：15672471
> 
> 赞同：1
> 
> 时间：2013-03-28T01:04:18.480
> 
> 标签：r

我正计划制作堆栈条形图，就像 [在 R](https://stackoverflow.com/questions/7583432/plot-stacked-bar-plot-in-r)

我有没有任何标题的表格格式的原始数据（每行包含七个值）：

```
1.028 1.125 1.475 0.793 0.803 0.815 0.974
0.867 1.115 1.256 1.377 1.029 1.184 1.135
0.497 0.400 0.313 0.570 0.319 0.558 0.475
0.541 0.646 0.309 0.692 0.813 0.575 0.806
1.153 1.184 0.792 0.666 0.976 0.607 0.706
1.236 1.049 1.424 1.773 1.019 0.910 1.376 
```

我的计划是首先为每行制作步长为 1 的不同间隔的箱。

```
0-1  1-2  2-3
4    3    0
1    6    0
... 
```

其次，在 x 轴上制作每行间隔的堆叠条。

我做了很多谷歌搜索。我停在了这里......

```
> mytable = read.table("./temp.out")
> m <-apply(mytable, 1, cut, seq(0, 3, 1))
> m
[,1]    [,2]    [,3]    [,4]    [,5]    [,6]    [,7]
[1,] "(1,2]" "(0,1]" "(0,1]" "(0,1]" "(0,1]" "(1,2]" "(1,2]"

[2,] "(1,2]" "(1,2]" "(0,1]" "(0,1]" "(0,1]" "(1,2]" "(1,2]"

[3,] "(1,2]" "(1,2]" "(0,1]" "(0,1]" "(0,1]" "(0,1]" "(1,2]"

[4,] "(0,1]" "(1,2]" "(0,1]" "(0,1]" "(0,1]" "(0,1]" "(1,2]"

[5,] "(0,1]" "(1,2]" "(0,1]" "(0,1]" "(0,1]" "(0,1]" "(1,2]"

[6,] "(0,1]" "(1,2]" "(0,1]" "(0,1]" "(0,1]" "(0,1]" "(0,1]"

[7,] "(0,1]" "(1,2]" "(0,1]" "(0,1]" "(0,1]" "(0,1]" "(1,2]" 
```

之后，我无法在频率表中将其转换为

```
0-1  1-2  2-3
4    3    0
1    6    0
... 
```

你能建议我如何制作频率表吗？得到频率表后，这些数据可以绘制在堆栈栏中吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T01:39:25.327

您可以使用匿名函数获取所需的信息，如下所示：

```
m <- t(apply(mytable, 1, function(x) table(cut(x,seq(0, 3, 1)))))

> m
     (0,1] (1,2] (2,3]
[1,]     4     3     0
[2,]     1     6     0
[3,]     7     0     0
[4,]     7     0     0
[5,]     5     2     0
[6,]     1     6     0 
```

如果您将数据保留为转置格式而没有`t`类似...

```
m <- apply(mytable, 1, function(x) table(cut(x,seq(0, 3, 1)))) 
```

...您可以按原样绘制条形图：

```
barplot(m) 
```

# linux - 具有 64 位 unixODBC 段错误的 Informix

> ID：15672477
> 
> 赞同：3
> 
> 时间：2013-03-28T01:05:15.090
> 
> 标签：linux, segmentation-fault, odbc, informix, unixodbc

使用带有 unixODBC 的 Informix 64 位驱动程序（Redhat 和 2.3.1 都默认使用 2.2.14）并且当列具有 NULL 值时会遇到问题。unixODBC 将 SQLLEN 用于（最后一个）StrLen_or_Ind 参数，而 Informix 64 位驱动程序似乎使用 SQLINTEGER。

因此，当测试返回值是否为 SQL_NULL_DATA 时，测试不起作用.. 因为当被视为 64 位整数时，作为 32 位整数的值 -1（SQL_NULL_DATA 被定义为）是 4294967296。

我在将驱动程序与 PHP ODBC 一起使用时发现了这个问题，因为它导致了段错误。有谁知道解决方法？我想过有一个自定义编译的 unixODBC 和 PHP 可以与 Informix ODBC 驱动程序一起使用，但是它不能与其他 ODBC 驱动程序一起正常工作:(

下面是我编写的一个简单的 C 程序来测试它。

```
#include <stdio.h>
#include <stdlib.h>
#include <sql.h>
#include <sqlext.h>

typedef struct odbc_connection {
    SQLHENV henv;
    SQLHDBC hdbc;
} odbc_connection;

typedef struct odbc_result_value {
    char name[32];
    char *value;
    SQLLEN vallen;
    SQLLEN coltype;
} odbc_result_value;

typedef struct odbc_result {
    SQLHSTMT stmt;
    odbc_result_value *values;
    SQLSMALLINT numcols;
    odbc_connection *conn;
} odbc_result;

int print_error (SQLHENV    henv,
                 SQLHDBC    hdbc,
                 SQLHSTMT   hstmt)
{
    SQLCHAR     buffer[SQL_MAX_MESSAGE_LENGTH + 1];
    SQLCHAR     sqlstate[SQL_SQLSTATE_SIZE + 1];
    SQLINTEGER  sqlcode;
    SQLSMALLINT length;

    while ( SQLError(henv, hdbc, hstmt, sqlstate, &sqlcode, buffer,
                     SQL_MAX_MESSAGE_LENGTH + 1, &length) == SQL_SUCCESS )
    {
        printf("\n **** ERROR *****\n");
        printf("         SQLSTATE: %s\n", sqlstate);
        printf("Native Error Code: %ld\n", sqlcode);
        printf("%s \n", buffer);
    };

    return ( SQL_ERROR);
}

int terminate(SQLHENV henv,
              SQLHDBC hdbc)
{
    SQLRETURN   rc;

    rc = SQLDisconnect (hdbc);               /* disconnect from database  */
    if (rc != SQL_SUCCESS )
        print_error (henv, hdbc, SQL_NULL_HSTMT);
    rc = SQLFreeConnect (hdbc);              /* free connection handle    */
    if (rc != SQL_SUCCESS )
        print_error (henv, hdbc, SQL_NULL_HSTMT);
    rc = SQLFreeEnv (henv);                  /* free environment handle   */
    if (rc != SQL_SUCCESS )
        print_error (henv, hdbc, SQL_NULL_HSTMT);

    return(rc);
}

int check_error (SQLHENV    henv,
                 SQLHDBC    hdbc,
                 SQLHSTMT   hstmt,
                 SQLRETURN  frc)
{
    SQLRETURN   rc;

    print_error(henv, hdbc, hstmt);

    switch (frc){
    case SQL_SUCCESS : break;
    case SQL_ERROR :
    case SQL_INVALID_HANDLE:
        printf("\n ** FATAL ERROR, Attempting to rollback transaction**\n");
        rc = SQLTransact(henv, hdbc, SQL_ROLLBACK);
        if (rc != SQL_SUCCESS)
            printf("Rollback Failed, Exiting application\n");
        else
            printf("Rollback Successful, Exiting application\n");
        terminate(henv, hdbc);
        exit(frc);
        break;
    case SQL_SUCCESS_WITH_INFO :
        printf("\n ** Warning Message, application continuing\n");
        break;
    case SQL_NO_DATA_FOUND :
        printf("\n ** No Data Found ** \n");
        break;
    default :
        printf("\n ** Invalid Return Code ** \n");
        printf(" ** Attempting to rollback transaction **\n");
        SQLTransact(henv, hdbc, SQL_ROLLBACK);
        terminate(henv, hdbc);
        exit(frc);
        break;
    }
    return(SQL_SUCCESS);

}

odbc_connection* odbc_connect(char *dsn, char *user, char* password)
{
    SQLRETURN rc;
    odbc_connection *conn;

    conn = (odbc_connection *) malloc(sizeof(odbc_connection));

    // Allocate environment handle
    rc = SQLAllocEnv(&conn->henv);
    if (rc != SQL_SUCCESS) {
        printf("Unable to allocate environment\n");
        check_error(conn->henv, conn->hdbc, SQL_NULL_HSTMT, rc);
    }

    // Allocate connection handle
    rc = SQLAllocConnect(conn->henv, &conn->hdbc);
    if (rc != SQL_SUCCESS) {
        printf("Unable to allocate connection handle\n");
        check_error(conn->henv, conn->hdbc, SQL_NULL_HSTMT, rc);
    }

    // Connect to database
rc = SQLConnect(conn->hdbc, dsn, SQL_NTS, user, SQL_NTS, password,
SQL_NTS);
    if (rc != SQL_SUCCESS) {
        printf("Unable to connect\n");
        check_error(conn->henv, conn->hdbc, SQL_NULL_HSTMT, rc);
    }

    return conn;
}

odbc_result* odbc_query(odbc_connection *conn, char *sql)
{
    SQLRETURN rc;
    odbc_result *result;
    int i;
    SQLSMALLINT colnamelen; /* Not used */
    SQLLEN displaysize;

    result = (odbc_result *) malloc(sizeof(odbc_result));
    result->conn = conn;

    rc = SQLAllocStmt(conn->hdbc, &(result->stmt));
    if (rc != SQL_SUCCESS) {
        printf("Unable to allocate statement\n");
        check_error(conn->henv, conn->hdbc, SQL_NULL_HSTMT, rc);
    }

    rc = SQLExecDirect(result->stmt, sql, SQL_NTS);
    if (rc != SQL_SUCCESS) {
        printf("Unable to execute statement\n");
        check_error(conn->henv, conn->hdbc, SQL_NULL_HSTMT, rc);
    }

    SQLNumResultCols(result->stmt, &(result->numcols));

    if (result->numcols > 0) {
        // Bind columns
        result->values = (odbc_result_value *) malloc(sizeof(odbc_result_value) * result->numcols);

        for (i = 0; i < result->numcols; i++) {
            rc = SQLColAttributes(result->stmt, (SQLUSMALLINT)(i+1),
                SQL_COLUMN_NAME, result->values[i].name,
                sizeof(result->values[i].name), &colnamelen, 0);
            rc = SQLColAttributes(result->stmt, (SQLUSMALLINT)(i+1), 
                SQL_COLUMN_TYPE, NULL, 0, NULL, &result->values[i].coltype);
            rc = SQLColAttributes(result->stmt, (SQLUSMALLINT)(i+1),
                SQL_COLUMN_DISPLAY_SIZE, NULL, 0, NULL, &displaysize);
            result->values[i].value = (char *) malloc(sizeof(char) * (displaysize + 1));
            rc = SQLBindCol(result->stmt, (SQLUSMALLINT)(i+1), SQL_C_CHAR,
                result->values[i].value, displaysize + 1, &result->values[i].vallen);
        }
    }

    return result;
}

int odbc_print_row(odbc_result *result) {
    SQLRETURN rc;
    int i;

    rc = SQLFetch(result->stmt);
    if (rc != SQL_SUCCESS) {
        return 0;
    }

    for (i = 0; i < result->numcols; i++) {
        /* BUG: the 64 bit informix driver here is has returned a 32 bit -1
        integer but is stored in a 64 integer field */
        if (result->values[i].vallen == SQL_NULL_DATA) {
            printf("NULL;");
        } else {
            printf("\"");
            printf("%s", result->values[i].value);
            printf("\";");
        }
    }
    printf("\n");
    return 1;
}

int main(int argc, char *argv[])
{
    odbc_connection* conn;
    odbc_result *result;

    conn = odbc_connect("authlive", "auth", "xxx");
    result = odbc_query(conn, argv[1]);

    while (odbc_print_row(result));

    SQLFreeStmt(result->stmt, SQL_CLOSE);
    free(result);
    terminate(conn->henv, conn->hdbc);
    free(conn);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T01:49:15.987

这是 CSDK 3.70 和早期版本的 Informix ODBC 驱动程序中的一个已知问题。

昨天（2013-03-26），IBM 发布了 IBM Informix 12.10.xC1 和配套的 IBM Informix ClientSDK 4.10.xC1。那里的 ODBC 版本应该具有 SQLLEN 和 SQLULEN 的正确 64 位类型。

这意味着如果你升级了，你应该没问题。这确实意味着任何代码都需要使用新版本的 ODBC 重新编译。这也意味着在使用 Informix 3.70 和更早版本时，一些（商业）ODBC 驱动程序管理器需要重新构建，或者配置为使用标准的 64 位驱动程序接口而不是有缺陷的 Informix 接口。新的 4.10 驱动程序。

# asp.net - 尝试使用 Web Deploy 将我的 ASP.NET MVC 应用程序发布到 Windows Azure 时，我不断收到此布尔错误

> ID：15672480
> 
> 赞同：1
> 
> 时间：2013-03-28T01:05:34.300
> 
> 标签：asp.net, asp.net-mvc, azure, microsoft-web-deploy

当我尝试使用 Web Deploy 将我的应用程序发布到 Windows Azure 时，我不断收到此错误：

> 错误 1 ​​在“@(WebConfigsToTransform)!='' And $(TransformWebConfigEnabled) And !$(UseParameterizeToTransformWebConfig)”条件下，应将“$(TransformWebConfigEnabled)”计算为布尔值而不是“0”

我正在尝试将以下元素添加到我的 . **csproj**文件设置（在`PropertyGroup`元素中），这样我就不会得到参数化的**web.config**文件：

```
<TransformWebConfigEnabled>False</TransformWebConfigEnabled>
  <AutoParameterizationWebConfigConnectionStrings>
    False
  </AutoParameterizationWebConfigConnectionStrings> 
```

当我将这些元素添加到项目文件中时，我在`TransformWebConfigEnabled`元素下看到一条蓝线，好像有什么问题，并且 Visual Studio 声明它是该元素的无效子`PropertyGroup`元素。现在，即使我从项目文件中删除了这些元素，它仍然给我上面的错误消息。

有什么想法吗？

# javascript - 在javascript文件上设置路径？

> ID：15672481
> 
> 赞同：1
> 
> 时间：2013-03-28T01:05:35.093
> 
> 标签：javascript

我想将任何 url 路径设置为 javascript 文件，例如：

```
$ image_path = "http://siteurl.com/inc/" 
```

如何在下面输入我的代码：

```
css({"background":"url(image/bg.png) no-repeat scroll 0 0"}) 
```

我想把里面的 url 变成 url( `image_path`+ image/bg.png) 所以我的 url css 变成**[http://siteurl.com/inc/image/bg.png](http://siteurl.com/inc/image/bg.png)**

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:07:37.077

将其连接到字符串中，如下所示：

```
var image_path = "http://siteurl.com/inc/"

element.css("background" , "url(" + image_path + "image/bg.png) no-repeat scroll 0 0"); 
```

# sql - 如何运行 TVF X 次以满足每个条件

> ID：15672488
> 
> 赞同：0
> 
> 时间：2013-03-28T01:06:24.970
> 
> 标签：sql, sql-server, tsql, function

我有一个表值函数，它返回一个类似的结果集

```
id     condition state     costs
1      yes                 300
2      yes                 1000
3      yes                 120
4      no                  20
5      no                  240 
```

该函数本身基于此查询

```
;with x
as
(
select   c.pat_id
        ,sum(std_cost) as Costs
        from claims as c 
        where c.pat_id in
        (
            select   c.pat_id
                from claims as c
                where c.admission_date between '2007-01-01' and '2007-01-31'
        )
        group by c.pat_id

),y
as
(
    select c.pat_id
        from claims as c
        inner join icd_patient as i
        on i.id=c.id
        inner join tblicd as t
        on t.icd=i.icd
        where t.icd like '707%'
        group by c.pat_id
)               

select   [Condition State]
        ,count(*) as  [Number Patients]
        ,avg(costs) as [Average Healthcare costs]
    from
    (
    select   x.pat_id
            ,case when y.pat_id is null then 'Condition Absent' else 'Condition Present' end as [Condition State]
            ,costs
            from x
            left join y on x.pat_id=y.pat_id
    )r
    group by [Condition State] 
```

该行`LIKE '707%'`当然由函数中的参数替换。我有一个名为的表`tbliICD`，其中包含一个代码列表，这是此函数中输入参数的来源。我想知道如何为表中的每个代码运行此查询`tblicd`。我可以用什么样的方法来做到这一点？是否可以发送包含我需要的每个代码的表值参数并让它为每个代码运行一次函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:30:33.050

使用交叉应用。它看起来像这样：

```
SELECT
  t.col, t.code, f.id, f.conditionState, f.costs
FROM yourTable AS t
CROSS APPLY dbo.yourTVF(t.code) AS f; 
```

如果您的函数是内联 TVF，这可能非常有效。

# asp.net-mvc - 绝对 URL 上的重定向在 MVC 4 中不起作用

> ID：15672491
> 
> 赞同：3
> 
> 时间：2013-03-28T01:06:38.473
> 
> 标签：asp.net-mvc, redirect, arr

由于某些原因，我必须将请求从我的 MVC 4 应用程序重定向到具有位于另一个域中的绝对 URL 的页面。这是我使用的代码：

```
public ActionResult Test(string url)
{
    return Redirect(url);
} 
```

当我在本地机器上尝试时一切正常，但是当我将代码发布到生产环境并尝试让它在那里工作时，我遇到了一些问题......例如，将请求重定向到' [https://stackoverflow .com/questions/ask](https://stackoverflow.com/questions/ask) ' 它将被重定向到 'http://{{myserverdomain.com}}/questions/ask'。所以请求将被重定向到本地路径'questions/ask'而不是绝对 URL。

不知道我应该检查什么以及在哪里检查。我会很感激任何提示可能是什么问题以及在哪里检查它......

以防万一：服务器是 Windows Server 2008 R2 Enterprise

**更新**

URL/HTML 编码不是问题的原因。将方法更改为

```
public ActionResult Test()
{
    return Redirect("https://stackoverflow.com/questions/ask");
} 
```

将给出相同的结果...它将被重定向到“问题/询问”/怀疑​​是 URL 重写模块的原因，但还不知道如何检查它...

**解决方案**

这是帮助解决问题的链接：[http ://forums.iis.net/t/1171047.aspx](http://forums.iis.net/t/1171047.aspx)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-28T01:27:03.173

这很奇怪，因为它是正确的方式......

```
public ActionResult YourAction()
{
    // ...
    return Redirect("http://www.example.com");
} 
```

您不能直接从 ajax 响应执行服务器端重定向。但是，您可以返回带有新 url 的 JsonResult 并使用 javascript 执行重定向。

服务器端 ：

```
public ActionResult YourAction()
{
    // ...
    return Json(new {url = "http://www.example.com"});
} 
```

客户端：

```
$.post("@Url.Action("YourAction")", function(data) {
    window.location = data.url;
}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-06-04T16:23:42.953

在尝试修复它之后，我没有取得任何成功......所以我决定采用其他方式并通过重定向页面准备某种自定义重定向，该重定向页面会更改 JavaScript 位置。

这是代码...

**辅助方法**：

```
public static void CustomRedirect(this HttpResponseBase response, string url)
{
    string customRedirectPage = ConfigurationManager.AppSettings["custom_redirect_page"];

    if (string.IsNullOrEmpty(customRedirectPage))
        response.Redirect(url);
    else
    {
        byte[] bytesToEncode = Encoding.UTF8.GetBytes(url);
        string base64 = Convert.ToBase64String(bytesToEncode);
        response.Redirect(string.Format("{0}?url={1}", customRedirectPage, base64));
    }
} 
```

**网络配置**：

```
<add key="custom_redirect_page" value="/Redirect/RedirectTo"/> 
```

**控制器**：

```
 public ActionResult RedirectTo(string url)
    {
        return View((object)System.Text.Encoding.UTF8.GetString(Convert.FromBase64String(url)));
    } 
```

和**HTML**：

```
@section Scripts {
    <script type="text/javascript">
        $(document).ready(function () {
            var url = '@Html.Raw(Model)';
            window.location = url;
        });
    </script>
} 
```

不喜欢这种黑客，但这对我有用......

# java - BufferedReader 从未关闭，但文件能够删除

> ID：15672492
> 
> 赞同：0
> 
> 时间：2013-03-28T01:06:54.740
> 
> 标签：java, file, bufferedreader, java-io

最近，我查看了我们的应用程序代码，发现代码中有一个问题。

```
/**
 * truncate cat tree(s) from the import file
 */
private void truncateCatTreesInFile(File file, String userImplCode) throws Exception
 {
     String rowStr = null, treeCode = null;
     BufferedReader reader = new BufferedReader(new FileReader(file));
     rowStr = reader.readLine(); // skip 1st row - header
     Impl impl;
     List<String> row = null;
     Set<String> truncatedTrees = new HashSet<String>();
     while ((rowStr = reader.readLine()) != null)
     {
         row = CrudServiceHelper.getRowFromFile(rowStr);
         if (row == null) continue;

         impl = getCatImportImpl(row.get(ECatTreeExportImportData.IMPL.getIndex()), userImplCode);
         treeCode = row.get(ECatTreeExportImportData.TREE_CODE.getIndex());
         if(truncatedTrees.contains(treeCode)) continue;

         truncatedTrees.add(treeCode);             
         CatTree catTree = _treeDao.findByCodeAndImpl(treeCode, impl.getId());
         if(catTree!= null) _treeDao.makeTransient(catTree);             
     }
     _treeDao.flush();   
 } 
```

查看上面的代码，“阅读器”从未关闭，我认为这可能是一个问题，但实际上，它工作正常，该文件可以被 tomcat 删除。

```
 javax.servlet.context.tempdir>
 [java] 2013-03-27 17:45:54,285 INFO [org.apache.struts2.dispatcher.Dispatch 
```

呃] -

基本上，我要做的是从浏览器上传一个文件，并根据该文件生成 sql 以将数据插入我们的数据库。全部完成后，删除文件。

我很惊讶这段代码运行良好，有人知道吗？我试图用谷歌搜索它，但我没有任何想法。

谢谢，杰克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T17:18:55.300

不关闭阅读器可能会导致资源泄漏。删除打开的文件可能仍然很好。

在 Linux（和其他 Unix 变体）下，如果只是从文件中取消链接，则删除文件。一个没有任何名称的文件实际上被释放了。所以打开一个文件，删除它（删除它的名字）然后读写它是一种众所周知的获取临时文件的方法。一旦文件关闭，空间就会被释放，但不会更早。

在 Windows 下，某些程序会锁定它们读取的文件，这会阻止其他进程删除此类文件。但并非所有程序都这样做。我没有一台 Windows 机器来实际测试 Java 是如何处理这个问题的。

代码没有崩溃的事实并不意味着代码完全正确地工作。如果应用程序由于泄漏而消耗越来越多的 RAM，那么您注意到的问题可能会在很久以后才会显现出来。不过，这不太可能：垃圾收集器最终会关闭读取器，而且可能很快就会关闭，因为`reader`它是本地的并且永远不会从方法中泄漏。

# c# - 如何查找对特定程序集的所有代码引用

> ID：15672498
> 
> 赞同：2
> 
> 时间：2013-03-28T01:07:43.947
> 
> 标签：c#, visual-studio

有谁知道是否有任何方法可以找到对引用程序集的所有代码引用？

例如，假设有一个项目包含 15 个程序集引用，但并非所有这些引用都在使用。是否有可能查看一个特定参考的所有用法？

我知道如何做到这一点的唯一方法是删除引用并尝试构建。错误列表向我显示了所有参考资料，但这似乎有点 hacky..

我正在使用 VS 2012，更新 1。

谢谢。

# jquery - 浮动时间轴范围

> ID：15672500
> 
> 赞同：0
> 
> 时间：2013-03-28T01:07:57.370
> 
> 标签：jquery, flot, timestamp

如何在浮动图中设置选项，以便仅显示当天的数据？我有时间戳和格式工作，但我不知道如何让它只显示当天（所以轴不断更新到当天）。

编辑：

这是我目前正在使用的代码片段：

```
// mode specific options
                    tickDecimals: null, // no. of decimals, null means auto
                    tickSize: null, // number or [number, "unit"]
                    minTickSize: [1, "hour"], // number or [number, "unit"]
                    monthNames: null, // list of names of months
                    timeformat: "%H:%I",
                    twelveHourClock: "12" // 12 or 24 time in time mode 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T13:08:09.590

在调用 plot() 之前尝试设置 xaxis 最小/最大选项。Time1 是一天的第一个 00:00:00 小时的毫秒数，Time2 是一天的 23:00:00 小时。

```
data: [.....],
...    
xaxis{ min: Time1, max: Time2} 
```

# php - 试图让 str_replace 在自定义 Magento 代码中工作

> ID：15672502
> 
> 赞同：1
> 
> 时间：2013-03-28T01:07:58.427
> 
> 标签：php, string, magento

这是我的代码：

```
<?php
    $_rtl           = Mage::getStoreConfig('custom_menu/general/rtl') + 0;
    $_categories    = $this->getStoreCategories();
    if (is_object($_categories)) $_categories = $this->getStoreCategories()->getNodes();
?>
<div class="nav-container">
<div style="z-index:999;position:relative;top:-8px;left:979px;cursor:pointer;"><img src="<?php echo $this->getSkinUrl('images/Truck-Prince-text.png'); ?>" height="91" width="123" style="position:absolute;" onclick="location.href='<?php echo Mage::getUrl('checkout/cart'); ?>'"></div>
    <div id="custommenu" class="<?php echo $_rtl ? ' rtl' : ''; ?>">
        <?php if ($this->showHomeLink()) : ?>
        <div class="menu">
            <div class="parentMenu menu0">
                <a href="<?php echo $this->getUrl('') ?>">
                    <span><?php echo $this->__('Home'); ?></span>
                </a>
            </div>
        </div>
        <?php endif ?>
        <?php foreach ($_categories as $_category): ?>
            <?php echo $this->drawCustomMenuItem($_category) ?>
        <?php endforeach ?>
    <?php echo $this->getLayout()->createBlock('cms/block')->setBlockId('nav-links-after')->toHtml() ?>
        <div class="clearBoth"></div>
    </div>
</div> 
```

我想要做的是这样的事情，但我不知道如何在不导致错误的情况下插入它。我基本上想用字符串替换的urls来改变现有的url..

```
<?php // We must replace URLs on the fly to use landing pages and not break subcat navigation
    $_category = str_replace('wild-bird-feed-supplies.html', 'landing-wild-bird-feed-supplies', $_category);
    $_category = str_replace('lawn-garden-supplies.html', 'landing-lawn-garden-supplies', $_category);
    $_category = str_replace('pet-food-supplies.html', 'landing-pet-food-supplies', $_category);
    $_category = str_replace('animal-feed-supplies.html', 'landing-animal-feed-supplies', $_category); ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T01:18:34.883

我终于能够得到它:)这就是我所做的......

```
<?php
    $_rtl           = Mage::getStoreConfig('custom_menu/general/rtl') + 0;
    $_categories    = $this->getStoreCategories();
    if (is_object($_categories)) $_categories = $this->getStoreCategories()->getNodes();
?>
<div class="nav-container">
<div style="z-index:999;position:relative;top:-8px;left:979px;cursor:pointer;"><img src="<?php echo $this->getSkinUrl('images/Truck-Prince-text.png'); ?>" height="91" width="123" style="position:absolute;" onclick="location.href='<?php echo Mage::getUrl('checkout/cart'); ?>'"></div>
    <div id="custommenu" class="<?php echo $_rtl ? ' rtl' : ''; ?>">
        <?php if ($this->showHomeLink()) : ?>
        <div class="menu">
            <div class="parentMenu menu0">
                <a href="<?php echo $this->getUrl('') ?>">
                    <span><?php echo $this->__('Home'); ?></span>
                </a>
            </div>
        </div>
        <?php endif ?>
        <?php foreach ($_categories as $_category): ?>
            <?php $_category = $this->drawCustomMenuItem($_category) ?>

    <?php // We must replace URLs on the fly to use landing pages and not break subcat navigation
    $_category = str_replace('wild-bird-feed-supplies.html', 'landing-wild-bird-feed-supplies', $_category);
    $_category = str_replace('lawn-garden-supplies.html', 'landing-lawn-garden-supplies', $_category);
    $_category = str_replace('pet-food-supplies.html', 'landing-pet-food-supplies', $_category);
    $_category = str_replace('animal-feed-supplies.html', 'landing-animal-feed-supplies', $_category); ?>

    <?php echo $_category; ?>

        <?php endforeach ?>
    <?php echo $this->getLayout()->createBlock('cms/block')->setBlockId('nav-links-after')->toHtml() ?>
        <div class="clearBoth"></div>
    </div>
</div> 
```

# .htaccess - 重定向工作正常，但我得到文件不存在于日志中

> ID：15672503
> 
> 赞同：0
> 
> 时间：2013-03-28T01:08:17.543
> 
> 标签：.htaccess

我有这个 .htaccess 文件

```
DirectoryIndex index.php

RewriteEngine on

RewriteRule ^user/([_.0-9a-zA-Z]+)$ show-user.php?user=$1 [L] 
```

在浏览器中重定向很好，但是如果在我的服务器上的错误日志中我可以看到数百个“文件不存在”错误，你知道为什么吗？

以下是日志中的错误示例：

```
[Thu Mar 28 02:58:43 2013] [error] [client xxx.xxx.xxx.xxx] File does not exist: /home/folder/public_html/user, referer: domain/user/username0001 
```

而且有数百个！但一切正常！我该怎么做才能使这些错误不显示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T11:20:26.090

已修复，我必须像这样使用 /show-user.php

```
RewriteRule ^user/([_.0-9a-zA-Z]+)$ /show-user.php?user=$1 [L] 
```

# wordpress - Apache mod_rewrite 被 Wordpress 重写规则覆盖的别名

> ID：15672504
> 
> 赞同：1
> 
> 时间：2013-03-28T01:08:25.153
> 
> 标签：wordpress, apache, .htaccess, mod-rewrite, saml-2.0

我在同一个盒子上有一个 Wordpress 实例和一个 SimpleSAMLphp 实例，需要从同一个子域访问，看起来 Wordpress 正在干扰 Apache Alias。

**httpd.conf**

```
#
# VHOST for the Wordpress instance and provides an alias
# so simpleSAMLphp can be accessed at saml.domain.com/saml
#
<VirtualHost *:80>
        RewriteEngine On
        RewriteCond %{SERVER_PORT} !^443$
        RewriteRule ^/(.*) https://%{HTTP_HOST}/$1 [NC,R,L]
</VirtualHost>
<VirtualHost *:443>
        ServerAdmin admin@domain.com
        ErrorLog logs/saml.domain.com-error_log
        CustomLog logs/saml.domain.com-access_log common

        SSLEngine On
        SSLCertificateFile /etc/pki/tls/certs/ca.crt
        SSLCertificateKeyFile /etc/pki/tls/private/ca.key

        RewriteLog "/var/log/httpd/mod_rewrite.log"

        ServerName saml.domain.com
        DocumentRoot "/var/www/html"
        <Directory "/var/www/html">
                Options All
                AllowOverride All
                Require all granted
        </Directory>

        Alias /saml "/var/simplesamlphp/www"
        <Directory "/var/simplesamlphp/www">
                Options All
                AllowOverride All
                Require all granted
        </Directory>
</VirtualHost> 
```

**.htaccess**

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress 
```

**/var/log/httpd/ssl_error_log**

```
[Wed Mar 27 18:00:03 2013] [error] [client 10.0.3.133] File does not exist: /var/www/html/favicon.ico
[Wed Mar 27 18:00:05 2013] [error] [client 10.0.3.133] File does not exist: /var/www/simplesamlphp
[Wed Mar 27 18:00:05 2013] [error] [client 10.0.3.133] File does not exist: /var/www/html/favicon.ico
[Wed Mar 27 18:03:46 2013] [error] [client 10.0.3.133] File does not exist: /var/www/html/favicon.ico
[Wed Mar 27 18:03:47 2013] [error] [client 10.0.3.133] File does not exist: /var/www/html/favicon.ico
[Wed Mar 27 18:03:56 2013] [error] [client 10.0.3.133] File does not exist: /var/www/simplesamlphp 
```

**/var/log/httpd/mod_rewrite.log**

*文件为空白*

[http://saml.domain.com/saml](http://saml.domain.com/saml) = simpleSAMLphp 管理菜单。

[http://saml.domain.com/anything-else](http://saml.domain.com/anything-else) = Wordpress 页面

转到 saml.domain.com/saml 的结果是一个 Wordpress 404 页面。在我强制使用 SSL 并修复 Wordpress 重写之前，我已经完成了这项工作，所以如果有人有任何有用的信息，那就太好了！

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T15:47:54.140

问题是我在*/etc/httpd/conf/httpd.conf*而不是*/etc/httpd/conf.d/ssl.conf*中指定了 SSL Vhost 。

这样做的结果是 Apache 附带的默认 SSL Vhost 覆盖了我在*httpd.conf 中*的内容。我所要做的就是删除*httpd.conf*中的 SSL Vhost 声明并将其与*ssl.conf中的声明合并*

# ios - TextInput 崩溃 - 如何调试？

> ID：15672506
> 
> 赞同：5
> 
> 时间：2013-03-28T01:08:43.340
> 
> 标签：ios, crash

我的 iOS 应用程序在崩溃线程中使用以下或类似堆栈获取崩溃报告：

```
0   TextInput                           0x0003149a TIInputManager::apply_case_changes_to_result(std::vector >&, KB::Hashmap const&, std::vector > const&) const + 402
1   TextInput                           0x00030bf3 TIInputManager::lookup() + 863
2   TextInput                           0x000307ad TIInputManager::autocorrection() + 61
3   TextInput                           0x00042d21 -[TIKeyboardInputManagerZephyr autocorrection] + 137
4   UIKit                               0x0011a319 -[UIKeyboardImpl generateCandidatesWithOptions:] + 377
5   UIKit                               0x00133071 -[UIKeyboardImpl addInputString:fromVariantKey:] + 2597
6   UIKit                               0x00130f8d -[UIKeyboardImpl handleKeyEvent:] + 1453
7   UIKit                               0x001308b7 -[UIKeyboardLayoutStar sendStringAction:forKey:isPopupVariant:] + 487
8   UIKit                               0x0012f3ad -[UIKeyboardLayoutStar touchUp:] + 3101
9   UIKit                               0x0012e737 -[UIKeyboardLayout touchesEnded:withEvent:] + 387
10  UIKit                               0x000165f9 -[UIWindow _sendTouchesForEvent:] + 525
11  UIKit                               0x00003809 -[UIApplication sendEvent:] + 381
12  UIKit                               0x00003123 _UIApplicationHandleEvent + 6155
13  GraphicsServices                    0x000065a3 _PurpleEventCallback + 591
14  GraphicsServices                    0x000061d3 PurpleEventCallback + 35
15  CoreFoundation                      0x00097173 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__ + 35
16  CoreFoundation                      0x00097117 __CFRunLoopDoSource1 + 139
17  CoreFoundation                      0x00095f99 __CFRunLoopRun + 1385
18  CoreFoundation                      0x00008ebd CFRunLoopRunSpecific + 357
19  CoreFoundation                      0x00008d49 CFRunLoopRunInMode + 105
20  GraphicsServices                    0x000052eb GSEventRunModal + 75
21  UIKit                               0x00057301 UIApplicationMain + 1121
22  MyApp                               0x0000294b main (main.mm:8) 
```

只有最下面的一行 ( `main`) 是我的。看起来崩溃发生在文本输入框架内的某个修饰事件处理程序中，并且与自动更正有关。

这些崩溃伴随着令人沮丧的一致性——这看起来像是我的一个微妙的错误，而不是 iOS 本身的错误。调用堆栈不一致——有时以 UIKit 结尾，有时以 libobjc 结尾。然而，iOS 版本似乎始终是 6.x。

知道如何调试这个吗？

编辑：线程 0 中的 SIGSEGV/SEGV_ACCERR。错误地址各不相同 - 有时为零，有时不是。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-20T05:20:25.813

这实际上是苹果的一个错误。进入模拟器上的设置（即模拟器上的设置应用程序）并关闭自动更正。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-03T10:19:43.897

我在 iOS 6.1.3（两次）和 6.1.4（一次）上看到了同样的情况，所有这些都报告为崩溃日志。在 Apple 的 C++ 代码中，所有 . 我认为除了向 Apple 提交错误报告（我提出的错误报告为：15573020）之外，我们无能为力。Apple 将重复报告视为错误优先级的指标，因此如果您遇到问题，我建议您在[https://bugreport.apple.com](https://bugreport.apple.com)添加报告并参考我提供的报告。

# javascript - javascript打开一个带有所有工具栏的新窗口（最大化）

> ID：15672507
> 
> 赞同：0
> 
> 时间：2013-03-28T01:08:47.310
> 
> 标签：javascript, popupwindow

我的初始代码就是这样。

`<a href="http://www.google.com.sg" target="_blank">test</a>`

然后我被抱怨新窗口没有最大化。他们希望它最大化。

`onclicked`所以，现在我在`a`标签上调用一个javascript函数

然后我研究了谷歌如何使用所有工具栏打开最大化等等。

这是我发现的结果，我对其进行了调整以达到这一目标。

```
w=800 
h=600 
if (window.screen) { 
w = window.screen.availWidth; 
h = window.screen.availHeight; 
} 
window.open('http://www.google.com.sg','newwin','width='+w+',height='+h+',top=0,left=0,resizable=yes,scrollbars=yes,toolbar=yes,menubar=yes,location=yes'); 
```

上面的脚本将打开一个包含所有工具栏等的新窗口，但屏幕尺寸是真实的屏幕尺寸，因此它会延伸到窗口任务栏。

我可以尝试从高度减去一些，但我也发现右上角的按钮并没有真正最大化。

有没有办法做到这一点？

# ajax - Django：是否可以创建 Json 并将其从视图发送到另一台服务器？

> ID：15672508
> 
> 赞同：0
> 
> 时间：2013-03-28T01:08:52.440
> 
> 标签：ajax, django, json, django-views, query-string

如果我有一个像这样`<a href="/account/user">Get User Data</a>`指向我自己服务器内部*视图*的链接，有没有办法将 json 对象（可能只是使用 ajax？）发送到另一台外部服务器并检索答案？像这样的东西：

```
from django.shortcuts import render

def profile(request):
   #send a json object to another server like http://www.myotherserver.com/user
   #get the answer and process it
   return render(request, 'accounts/profile.html' , 
                {'profile_user': data_from_the_external_server}) 
```

上面我当然可以用 jquery-ajax 来实现它，但我只是想知道我是否可以这样做......

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T02:02:26.513

当然可以。为什么不可能？

如果没有必要，不要在 AJAX 中编码。

您需要两件事，您需要准备要发送的 JSon，然后您需要将其发送到您想要的 API：

1.  查看“simplejson”以创建要发送的 json 数据。
2.  查看“urllib”以在 Python 中向另一台服务器发送请求（例如：[How to send a POST request using django?](https://stackoverflow.com/questions/5308060/how-to-send-a-post-request-using-django)）

也不要把它直接放在你的视野中。为它创建一个新类。因此，在您看来，您将拥有类似的东西：

```
def profile(request):
    # instantiate your service here (better with DI)

    profile_user = my_service.get_profile_user()
    return render(
        request, 
        'accounts/profile.html' , 
        {
            'profile_user': profile_user
        }
    ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T02:01:19.257

如果您需要将 HTTP 数据（通过 POST 或 GET）发送到另一台服务器并从您的视图中接收结果，您可以使用 Python 的[urllib2](http://docs.python.org/2/library/urllib2.html)库。但是，有一个更简单的第三方库，称为[Requests](http://docs.python-requests.org/en/latest/index.html)可以为您处理此任务。

# mysql - MySQL 显示总和 0

> ID：15672512
> 
> 赞同：0
> 
> 时间：2013-03-28T01:09:59.747
> 
> 标签：mysql

所以我有一个包含一组订单项目的表，订单项目表跟踪特定订单中包含多少特定项目。下面是此示例中使用的表格的简化版本。

**订单项表**

```
order_item_id : int
order_item_item_id : int
order_item_quantity : int
order_item_order_id : int 
```

**订单表**

```
order_id : int
order_date : date 
```

我正在尝试执行一个查询，该查询将平均每周、每月和所有时间的特定 order_item_item_id 的销售额。

目前我的查询如下

```
SELECT totalAvg.item 

ROUND(AVG(totalAvg.total)+0.4999999, 0) AS totalAverage,  
ROUND(AVG(monthAvg.total)+0.4999999, 0) AS monthAverage, 
ROUND(AVG(weekAvg.total)+0.4999999, 0) AS weekAverage from

(SELECT orderitem.order_item_item_id AS item, SUM(orderitem.order_item_quantity) AS total,
 DATE(`order`.order_date) AS date FROM orderitem, `order` WHERE orderitem.order_item_order_id = 
`order`.order_id GROUP BY DATE(`order`.order_date), order_item_item_id) AS totalAvg,

(SELECT orderitem.order_item_item_id AS item, SUM(orderitem.order_item_quantity) AS total, 
DATE(`order`.order_date) AS date FROM orderitem, `order` WHERE orderitem.order_item_order_id =
`order`.order_id AND `order`.order_date > date_sub(now(), interval 1 week) GROUP BY 
DATE(`order`.order_date), order_item_item_id) AS weekAvg,

(SELECT orderitem.order_item_item_id AS item, SUM(orderitem.order_item_quantity) AS total,
DATE(`order`.order_date) AS date FROM orderitem, `order` WHERE orderitem.order_item_order_id = 
`order`.order_id AND `order`.order_date > date_sub(now(), interval 1 month) GROUP BY 
DATE(`order`.order_date), order_item_item_id) AS monthAvg,

WHERE totalAvg.item = monthAvg.item AND
monthAvg.item = weekAvg.item 
GROUP BY item 
```

这样做的问题是，如果 weekAvg 表中不存在项目，则不会为 totalAvg 或 monthAvg 打印任何结果。我怎样才能在单个语句中执行此操作？

**样本数据**

```
{order_id : 5, order_date : 02/02/2013}
{order_id : 6, order_date : 13/03/2013}

{order_item_id : 1, order_item_order_id : 5, order_item_item_id : 1, order_item_quantity : 3}
{order_item_id : 2, order_item_order_id : 6, order_item_item_id : 1, order_item_quantity : 4} 
```

当前输出不会返回任何内容，因为每周报告没有 id 为 1 的订单项的条目。我试图解决这个问题，以便它输出以下内容

```
totalAverage = 3.5
monthAverage = 4
weekAverage = 0 
```

这些值的计算如下：

总平均数 = 售出的特定商品的总数除以该商品的售出天数。

月和周值与之前的计算相同，但有时间限制，因此订单必须在上周/月内下达。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T01:43:45.487

您需要使用[外连接](http://dev.mysql.com/doc/refman/5.5/en/join.html)将 totalAvg 连接到 monthAvg 和 weekAvg。您可以使用[`COALESCE()`](http://dev.mysql.com/doc/refman/5.5/en/comparison-operators.html#function_coalesce)来确保为空的周或月值获得 0 而不是 NULL。

您还应该使用 ANSI 连接语法。它不易出错且更具可读性。

尝试这样的事情：

```
SELECT totalAvg.item,
ROUND(AVG(totalAvg.total)+0.4999999, 0) AS totalAverage,  
COALESCE(ROUND(AVG(monthAvg.total)+0.4999999, 0),0) AS monthAverage, 
COALESCE(ROUND(AVG(weekAvg.total)+0.4999999, 0),) AS weekAverage 
from
(
  SELECT orderitem.order_item_item_id AS item, 
    SUM(orderitem.order_item_quantity) AS total,
    DATE(`order`.order_date) AS date 
  FROM orderitem
    inner join `order` on orderitem.order_item_order_id = `order`.order_id 
  GROUP BY DATE(`order`.order_date), order_item_item_id
) AS totalAvg
left outer join
(
  SELECT orderitem.order_item_item_id AS item, 
    SUM(orderitem.order_item_quantity) AS total, 
    DATE(`order`.order_date) AS date 
  FROM orderitem
    inner join `order` on orderitem.order_item_order_id = `order`.order_id 
  WHERE `order`.order_date > date_sub(now(), interval 1 week) 
  GROUP BY 
  DATE(`order`.order_date), order_item_item_id
) AS weekAvg on weekAvg.item = totalAvg.item
left outer join
(
  SELECT orderitem.order_item_item_id AS item, 
    SUM(orderitem.order_item_quantity) AS total,
    DATE(`order`.order_date) AS date 
  FROM orderitem
    inner join `order` on orderitem.order_item_order_id = `order`.order_id 
  WHERE `order`.order_date > date_sub(now(), interval 1 month) 
  GROUP BY DATE(`order`.order_date), order_item_item_id
) AS monthAvg on monthAvg.item = totalAvg.item
GROUP BY item 
```

# java - 中断线程时出现 IllegalMonitorStateException

> ID：15672515
> 
> 赞同：0
> 
> 时间：2013-03-28T01:10:28.480
> 
> 标签：java, multithreading, wait

我得到一个 IllegalMonitorStateException 并且我觉得我无法阅读更多内容，所以我问是否有人知道我做错了什么。我在程序运行结束时收到此错误，在计数器（门类中的线程之间的共享资源）处于等待状态之后。为了告诉线程结束，我从 main 方法中中断它们。

Counter 类具有关键部分的其他方法。

```
 private int currentValue; /* to keep score of people passing */

            /* critical section */
    public synchronized boolean isFull() {
        if(busy) {  /* lock */
            try {
                wait();
            } catch (InterruptedException e) {
                System.out.println("isFull was interrupted waiting");
            }
        }
        busy=true;
                    /* is not full notify threads waiting to resume work*/
        if(currentValue < maxValue) {
            notify();
            busy=false; /* unlock */
            return false;
        }
                    /* do not notify threads */
        return true;
    }

            /* critical section */
    public synchronized void addPersons() {
        if(busy) {
            try {
                wait();
            } catch (InterruptedException e) {
                System.out.println("addPersons was interrupted waiting");
            }   
        }
        busy=true;
        currentValue += nr_p;
        notify();
        busy=false;
    }

            public synchronized int getValue() {
        return currentValue;
    } 
```

Gate 类中的 run 方法（也有线程）：

```
 public void run() {
        while(!blocked) {
            int waitTime = (r.nextInt(5) + 1) * 1000; /* random seconds */
            if(counter.isFull(gatenr))
                try {
                       t.wait(); /* here is where the IllegalMonitorStateException occurs. */   
                } catch (InterruptedException e) {
                    System.out.println("Shutting gate off from waiting");
                }
            if(t.isInterrupted()) { /* check if thread is interrupted */
                System.out.println("breaking");
                break;
            }
            counter.addPersons(1);
            nrOfPassengers++;
            try {
                Thread.sleep(waitTime);
            } catch (InterruptedException e) {
                System.out.println("Shutting gate off from sleep");
            }
        }
    }

        /* used by main to interrupt threads from wait statement and close gate */
    public synchronized void close() {
        t.interrupt();
        blocked = true;
    } 
```

主要方法有以下几行：

```
 while(counter.getValue() < MAX) { 
                Thread.sleep(3000);
            }
            System.out.println("Announcement: Ship is full!");

            /* wait for child threads to finish */
            for(Gate g: gates) {
                g.close(); /* interrupts thread in gate object */
                System.out.println(g.getNoOfPassangers() + " passed through gate nr " + g.getId());
            }
           } 
```

这让我发疯，我已经阅读了有关监视器错误的所有信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:45:10.893

`t.wait();`应该在一个`synchronized(t)`块中。

但是我在你的代码中看不到任何`t.notifyAll()`东西，所以看起来你可以永远等待。另请注意，标准习惯用法是循环等待以处理虚假唤醒。

# mysql - 在一对多关系查询中使用 LIMIT

> ID：15672516
> 
> 赞同：0
> 
> 时间：2013-03-28T01:10:30.083
> 
> 标签：mysql, sql

我有两张表`tabA`and ，从to`tabB`有一对多的关系。我有一个查询：`tabA``tabB`

```
SELECT * FROM `tabA` LEFT JOIN `tabB` ON `tabA`.`aID` = `tabB`.`aID` 
```

并且返回的行是一个大集合，`tabA`每个对 的`tabB`引用都有多个重复项`tabA`。

我知道我可以使用`GROUP BY`将`tabA`行限制为唯一元素，除非我使用该`GROUP_CONCAT`函数使用自定义字段，并结合两个`REPLACE`用于转义的函数（这会严重影响性能），否则我会松开所有包含在`tabB`. 示例查询如下所示：

```
 SELECT `tabA`.*,
          GROUP_CONCAT(REPLACE(REPLACE(`tabB`.`tabBCol1`, '/', '//'), ',', '/,')) AS `tabBCol`,
          GROUP_CONCAT(REPLACE(REPLACE(`tabB`.`tabBCol2`, '/', '//'), ',', '/,')) AS `tabBCo2` 
     FROM `tabA` 
LEFT JOIN `tabB` ON `tabA`.`aID` = `tabB`.`aID` 
 GROUP BY `tabA`.`aID` 
```

该查询将允许我使用`LIMIT`语法，因此我可以（例如）仅显示 5 个条目，从 5 个（即`LIMIT 5,5`）之后开始。当我将它应用于前一个查询时，我不会得到接下来的 5 个查询，而是基于关联数量的随机数据集。

那么，除了第二个查询之外，有没有什么方法可以获取行，有关联，但允许使用`LIMIT`语法，并且没有过多`REPLACE`函数的性能影响？

**额外的**

虽然我可以为每一行使用多个子查询，但使用第一个带有`GROUP BY`语法的查询（这将允许我`WHERE`为关联应用任何条件），我试图找到一种方法来避免 N+1 选择问题（尽管在这个例子中，我的`LIMIT`语法是`LIMIT 5,5`，我将把它应用到更大`LIMIT`的 s（一次最多 1000 行））。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:21:24.230

尝试两个查询：

```
// get those 5 records
SELECT * FROM Cars   WHERE some_conditon = blabla LIMIT 5;

// get all associated records from related table
SELECT * FROM Wheels WHERE car_id IN (1, 3, 5, 123, 16); 
```

结果不会有任何 N 问题，因为您总是有两个查询。即使您在第一个查询中有 1000 条记录，使用这种简单的方法总是比 joins/groups by/concats/etc 更好。

# java - Struts2 标签单选按钮

> ID：15672517
> 
> 赞同：0
> 
> 时间：2013-03-28T01:10:32.573
> 
> 标签：java, button, struts2, radio

我有这个遍历对象的迭代器。

```
 <s:iterator value = "choices" status = "key">
        <s:set var = "test" value ="%{#key.index}"/>
             <input type = "radio" name="choices[{key.index}].answer" />
             <s:textfield name = "choices[%{#key.index}].value" value = "%{choices[%{#key.index}].value}"/>
            <br>
        </s:iterator> 
```

哪里`answer`是一个布尔值，我试图通过单选按钮设置。

但问题是，在生成的 html 上，单选按钮。是这样的

```
<input type = "radio" name="choices[%{#key.index}].answer" /> 
```

它没有索引/索引。它只给了我`%{#key.index}`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T04:02:07.350

您必须使用属性标签来获取实际值

```
<input type = "radio" name="<s:property value='%{choices[#key.index].answer}' />" /> 
```

更好地使用struts标签库的radio标签，像这样

```
<s:radio name="choices[%{#key.index}].answer" / > 
```

# java - Java MVC 样式计算器的 if 语句存在问题

> ID：15672521
> 
> 赞同：0
> 
> 时间：2013-03-28T01:11:01.947
> 
> 标签：java, swing, model-view-controller, user-interface, calculator

我必须在java中使用类之间的MVC样式格式制作计算器GUI样式，我试图通过具有真/假布尔值来区分他们输入的第一个数字和第二个数字，所以如果它是真的那么数字就是第一个，如果它是假的，那么它应该识别出它是一个新数字，并且他们已经按下了加号或减号。我使用了一个返回布尔值的公共布尔方法，但是我在 Calculations 类中的 if 语句由于某种原因不起作用。这是代码

计算类

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;

class Calc extends JFrame implements ActionListener {

    private JTextField numDisplay = new JTextField(10);
    private JButton plusButton = new JButton("+");
    private JButton minusButton = new JButton("-");
    private JButton clearButton = new JButton("Clear");
    private JButton equalsButton = new JButton("=");
    private JButton zeroButton = new JButton("0");
    private JButton oneButton = new JButton("1");
    private JButton twoButton = new JButton("2");
    private JButton threeButton = new JButton("3");
    private JButton fourButton = new JButton("4");
    private JButton fiveButton = new JButton("5");
    private JButton sixButton = new JButton("6");
    private JButton sevenButton = new JButton("7");
    private JButton eightButton = new JButton("8");
    private JButton nineButton = new JButton("9");
    private String number = "";
    private boolean trueFalse;   //plus or minus
    private boolean onOff = false;   //false = 1st int, true = 2nd int
    private int total;

    Calc(){
        JPanel calcPanel = new JPanel();

        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        this.setSize(400, 600);
        calcPanel.add(numDisplay);
        calcPanel.add(plusButton);
        calcPanel.add(minusButton);
        calcPanel.add(clearButton);
        calcPanel.add(equalsButton);
        calcPanel.add(zeroButton);
        calcPanel.add(oneButton);
        calcPanel.add(twoButton);
        calcPanel.add(threeButton);
        calcPanel.add(fourButton);
        calcPanel.add(fiveButton);
        calcPanel.add(sixButton);
        calcPanel.add(sevenButton);
        calcPanel.add(eightButton);
        calcPanel.add(nineButton);

        this.add(calcPanel);

        plusButton.addActionListener(this);
        minusButton.addActionListener(this);
        clearButton.addActionListener(this);
        equalsButton.addActionListener(this);
        zeroButton.addActionListener(this);
        oneButton.addActionListener(this);
        twoButton.addActionListener(this);
        threeButton.addActionListener(this);
        fourButton.addActionListener(this);
        fiveButton.addActionListener(this);
        sixButton.addActionListener(this);
        sevenButton.addActionListener(this);
        eightButton.addActionListener(this);
        nineButton.addActionListener(this);

    }
    public void actionPerformed(ActionEvent event){
        if (event.getSource() instanceof JButton){
            JButton clickedButton = (JButton) event.getSource();
            String buttonText = clickedButton.getText();
            number = number + buttonText;
            if (clickedButton == clearButton){
                number = "";
                onOff = false;
            }
            if (clickedButton == plusButton){
                trueFalse = true;
                onOff = true;
            }
            if (clickedButton == minusButton){
                trueFalse = false;
                onOff = true;
                number = "";
            }
        }
    }
    public int getNumber(){
        return Integer.parseInt(number);
    }
    public boolean trueFalse(){
        return trueFalse;
    }
    public boolean onOff(){
        return onOff;
    }
    public int total(){
        return total;
    }
} 
```

这是我遇到问题的计算类。

```
public class Calculations
{
    private Calc theView;
    private CalculationModel theModel;
    private boolean onOff = theView.onOff();
    private boolean trueFalse = theView.trueFalse();

    public Calculations(Calc theView, CalculationModel theModel)
    {
        this.theView = theView;
        this.theModel = theModel;
    }

    if(trueFalse == true)     //this if statement isn't working
    {
        private int number1 = theView.getNumber();
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:16:29.760

您需要声明`number1`为类成员变量

```
private int number1; 
```

`private`关键字只能在类块中使用。另外，更换

```
if (trueFalse == true)     
{
   private int number1 = theView.getNumber(); 
} 
```

和

```
if (trueFalse)    
{
   number1 = theView.getNumber();
} 
```

并将其放在一个方法中。

请参阅：[声明成员变量](http://docs.oracle.com/javase/tutorial/java/javaOO/variables.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T01:18:52.513

你有空指针异常吗？我不确定这一点，但尝试在计算构造函数中添加它

```
trueFalse = theView.trueFalse() 
```

并将第 4 行编辑为

```
private boolean trueFalse = false; 
```

编辑：并在构造函数之前声明 number1

# javascript - Javascript专注于加载输入框

> ID：15672529
> 
> 赞同：2
> 
> 时间：2013-03-28T01:11:43.370
> 
> 标签：javascript, html, input, dom-events

不管我做什么，这个页面根本不起作用。我希望它专注于加载时的输入框。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Home Screen</title>
<style type="text/css">
input {border:0px;}
input:focus {outline:none;}
</style>
</head>
<body onload="document.getElementById("search").focus()">
<input id="search" />
</body>
</html> 
```

我知道我用这段代码打破了一堆规则，所以你不需要说什么。

编辑：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Home Screen</title>
<style type="text/css">
input {border:0px;}
input:focus {outline:none;}
</style>
</head>
<body onload="document.getElementById('search').focus()">
<input id="search" onblur="setTimeout(document.getElementById('search').focus(),10)" />
</body>
</html> 
```

编辑2：

```
<script type="text/javascript">
function refocus()
{
setTimeout(document.getElementById("search").focus(),10);
}
</script>

<input id="search" onblur="refocus()" /> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T01:22:47.197

双引号不能包含双引号，不仅在javascript中，任何其他语言都是一样的。

```
<body onload="document.getElementById('search').focus()"> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-28T01:16:38.657

如果您使用的是 jquery：

```
$(function() {
  $("#search").focus();
}); 
```

或原型：

```
Event.observe(window, 'load', function() {
  $("search").focus();
}); 
```

或纯javascript：

```
window.onload = function() {
  document.getElementById("search").focus();
}; 
```

它的可读性比内联事件“更好”......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T01:15:34.900

您必须放入`search`单引号：

```
<body onload="document.getElementById('search').focus()"> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-28T01:16:43.370

将搜索放在单引号中，因为 document.getelementbyid 周围有双引号

```
 <body onload="document.getElementById('search').focus()"> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-28T01:17:43.550

您遇到此问题是因为您在 onfocus 事件中使用了相同的引号，您可以更改`"search"`为`'search'`解决此问题。

```
<body onload="document.getElementById('search').focus()"> 
```

理想情况下，您应该在 JavaScript 中附加您的事件，以便您的标记保持清晰，并且页面的所有功能方面都位于一个位置。

[jsFiddle](http://jsfiddle.net/Dp2Cj/)

```
<script type="text/javascript">
    window.onload = function () {
        document.getElementById("search").focus();
    }
</script> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-09-10T07:47:11.923

使用 setTimeout 函数在代码中设置一些延迟来解决此问题。

```
function fireOnClick() {
    // Set text filed focus after some delay
    setTimeout(function() { jQuery('#globalText').focus() }, 20);
    // Do your work.....
} 
```

# syntax-highlighting - 如何使用 Jekyll 和 Pygments 获得内联代码？

> ID：15672530
> 
> 赞同：9
> 
> 时间：2013-03-28T01:11:48.220
> 
> 标签：syntax-highlighting, jekyll, css, pygments

我正在使用带有 Liquid 标签的 Markdown 来标记 Jekyll 生成的网站的一些代码，并希望包含一些内联（在段落中）和具有彩色语法（使用 Pygments）的代码，但它没有似乎工作。

标记

```
Lorem ipsum dolor {% highlight javascript %} var sit = "amet"; {% endhighlight %} consectetur adipiscing elit. 
```

结果是

```
<p>Lorem ipsum dolor <div class='highlight'><pre><code class='javascript'> <span class='kd'>var</span> <span class='nx'>sit</span> <span class='o'>=</span> <span class='s2'>&quot;amet&quot;</span><span class='p'>;</span></code></pre></div> consectetur adipiscing elit.</p> 
```

我非常希望突出显示的文本不包含在 中`<div class='highlight'>`，或者至少是`<span class='highlight'>`.

[正如其他地方所建议](https://stackoverflow.com/questions/12441501/pygments-syntax-highlighting-in-jekyll-without-starting-a-div)的那样，使用`{% highlight javascript nowrap %}`不起作用。（也许这是我的设置的问题——Ruby 2.0、Jekyll 0.12.1、pygments.rb 0.3.7？）

我想[在 GitHub 上托管这个页面](https://help.github.com/articles/using-jekyll-with-pages)，这意味着*我不能依赖插件*。无赖，对吧？

**附录：**行号（即`{% highlight javascript linenos %}`）似乎也不起作用。男人。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-12-14T03:37:11.563

最简单的方法是使用 Github Flavored Markdown 并使用它们的默认内联代码。

在您的`_config.yml`文件中，将您的降价更改为 redcarpet。您现在已准备好使用 GFM。

```
markdown: redcarpet 
```

现在你可以关注所有的[GitHub Markdown](https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet)了。内联代码如下：

```
Here is some `inline code` in the middle of sencence 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-10T18:44:06.720

您可以将 CSS 类添加到您在帖子中放置的任何对象。

如果你像这样定义一个 CSS 条目：

```
.inlined { display:inline; } 
```

然后，您可以将此类添加到生成的`<div>`执行此操作中：

```
Lorem ipsum dolor 
{% highlight javascript %}var sit="amet"; {% endhighlight %}{: .inlined } 
consectetur adipiscing elit. 
```

这适用于所有类型的对象（表格、图像等）。我现在无法测试它，但我认为这将解决问题。

测试时，请查看输出 HTML。然后你会发现你的`<div>`now 已经`class=inlined`设置了属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-10T05:13:56.100

If you include the following two functions (and call them):

```
var inlineElements = function() {
    var inlinedElements = document.getElementsByClassName('inlined');
    inlinedElements = Array.prototype.concat.apply([], inlinedElements); // copy
    for (var i = 0; i < inlinedElements.length; i++) {
        var div = inlinedElements[i];
        var span = document.createElement('span');
        span.innerHTML = div.children[0].innerHTML;
        var previous = div.previousElementSibling;
        var paragraph;
        if (previous.tagName.toLowerCase() === 'p') {
            paragraph = previous;
        } else {
            paragraph = document.createElement('p');
            div.parentNode.insertBefore(paragraph, div);
        }
        div.remove();
        paragraph.innerHTML += ' ' + span.innerHTML + ' ';
        paragraph.classList.add('highlight');
        paragraph.classList.add('inlined');
        if (div.classList.contains('connectNext')) {
            paragraph.classList.add('connectNext');
        }
    }
}

var connectElements = function() {
    while (true) {
        var connectNextElements = document.getElementsByClassName('connectNext');
        if (connectNextElements.length == 0) break;
        var prefix = connectNextElements[0];
        var next = prefix.nextElementSibling;
        prefix.innerHTML += ' ' + next.innerHTML;
        next.remove();
        if (!next.classList.contains('connectNext')) {
            prefix.classList.remove('connectNext');
        }
    }
}

inlineElements();
connectElements(); 
```

You can use .inline and .connectNext in your Markdown:

```
{% highlight objective-c %}
[[NSObject alloc] init];
{% endhighlight %} {: .inlined .connectNext }
vs.
{% highlight java %}
new Object();
{% endhighlight %} {: .inlined } 
```

`.connectNext` will make ensure that the text following the code block is also inlined in the same `<p>`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-13T08:42:07.787

.highlight div 有什么问题？它放在那里是为了使语法突出显示易于主题化。要将包装器更改为跨度，我敢打赌您必须更改 Jekyll 配置。

仅当您有多行代码段时才会出现行号。

# android - 尝试打开 android SQLite 数据库时找不到文件异常

> ID：15672532
> 
> 赞同：4
> 
> 时间：2013-03-28T01:12:06.933
> 
> 标签：android, sqlite

我在 android 应用程序中有以下代码作为 DataBaseHelper：

```
 public class DbUtils {

    private static final String DB_PATH = "/data/data/com.project.skcompanion/databases/";

    private static final String DB_NAME = "basesh.sqlite";

    public static void createDatabaseIfNotExists(Context context) throws IOException {
        Log.d("check1", "check1");
        boolean createDb = false;

        File dbDir = new File(DB_PATH);

        File dbFile = new File(DB_PATH + DB_NAME);

        if (!dbDir.exists()) {
            dbDir.mkdir();
            createDb = true;
        }
        else if (!dbFile.exists()) {
            createDb = true;
        }
        else {
            // Check that we have the latest version of the db
            boolean doUpgrade = false;

            if (doUpgrade) {
                dbFile.delete();
                createDb = true;
            }
        }
        Log.d("check2", "check2");
        if (createDb) {
            Log.d("check3", "check3");
            // Open your local db
            AssetManager am = context.getAssets();
            InputStream myInput = am.open(DB_NAME);
            Log.d("check4", "check4");
            // Open the empty db
            OutputStream myOutput = new FileOutputStream(dbFile);
            // transfer bytes from the inputfile to the outputfile
            byte[] buffer = new byte[1024];
            int length;

            while ((length = myInput.read(buffer)) > 0) {
                myOutput.write(buffer, 0, length);
            }

            // Close the streams
            myOutput.flush();
            myOutput.close();
            myInput.close();

        }

    }

    public static SQLiteDatabase getStaticDb() {

        return SQLiteDatabase.openDatabase(DB_PATH + DB_NAME, null, SQLiteDatabase.NO_LOCALIZED_COLLATORS);

    } 
```

但是当代码尝试打开 basesh.sqlite 时，它​​会发送 FileNotFoundException。我在资产/数据库中有我的 basesh.sqlite 文件。经过一些调试，我认为问题出在这一行。

```
InputStream myInput = am.open(DB_NAME); 
```

但我不知道为什么它没有打开我的文件。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T02:25:31.587

您不需要创建文件本身。只需创建一个数据库，就会创建。

试试这个助手：

```
public class DatabaseHelper extends SQLiteOpenHelper {

    private final Context context;

    public DatabaseHelper(Context context) {
        super(context, context.getString(R.string.app_name), null, Integer.valueOf(context.getString(R.string.database_version)));
        this.context = context;
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        createDb(db);
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        String[] versions = context.getResources().getStringArray(R.array.database_upgrade);
        for (int i = oldVersion; i < newVersion; i++) {
            String[] statements = versions[i - 1].split(";");
            for (String statement : statements) {
                db.execSQL(statement);
            }
        }
    }

    private void createDb(SQLiteDatabase db) {
        try {
            db.beginTransaction();
            String[] tables = context.getResources().getStringArray(R.array.database_tables);
            for (String table : tables) {
                db.execSQL(table);
            }
        } catch (SQLException e) {
            Log.e(context.getString(R.string.app_name), context.getString(R.string.database_access_error));
        } finally {
            db.endTransaction();
        }
    }
} 
```

并且，对于资源，包括更新其结构的数据库的新版本号：

```
<string name="database_version">2</string>

<string-array name="database_tables">
    <item>CREATE TABLE "COLLECT" (
        _ID INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
        DATE TEXT NOT NULL,
        SENT INTEGER, 
        OM REAL,
        CMSR REAL,
        DC REAL
        );</item>
</string-array>
<string-array name="database_upgrade">
    <item>ALTER TABLE COLLECT ADD COLUMN SENT INTEGER;</item>
</string-array> 
```

如您所见，当`database_version`是 1 时，sqliteHelper 只是创建了我的`collect`表，作为我的示例。如果数据库已经存在，例如示例，并且版本号现在是 2 或更高，sqliteHelper 会更新 db 结构读取数组`database_upgrade`迭代其所有项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T02:04:52.990

您的问题是您将数据库文件 basesh.sqlite 放入`assets/databases`，这是错误的。context.getAssets().open("basesh.sqlite") 进行调查`assets`，但什么也没找到。所以你需要把它放在下面`assets`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T02:09:09.150

你正在尝试打开

```
InputStream myInput = am.open(DB_NAME); 
```

当您创建数据库时，您在此路径上创建它

```
private static final String DB_PATH = "/data/data/com.project.skcompanion/databases/"; 
```

将您的代码更新为此

```
InputStream myInput = am.open(DB_PATH+DB_NAME); 
```

# google-apps-script - 将用户从一个应用脚本作为匿名用户定向到域后面的另一个应用脚本

> ID：15672535
> 
> 赞同：0
> 
> 时间：2013-03-28T01:12:36.023
> 
> 标签：google-apps-script

我深入学习了 App Script，但是 Google 提供的东西太多了，我在弄清楚我需要什么时有点不知所措。

我正在为一个非营利组织设计一个在线志愿者申请工作流程，并最终设计其他东西。

以下是我对流程的设想。

1.  新用户出现第一个 Web App 页面要求输入第一个最后一个中间和电子邮件地址
2.  First Last Middle 以某种方式一起使用，以使用配置 API（已经弄清楚这部分）为用户创建域登录，同时提示用户创建密码
3.  此时，用户被传递到仅为域用户运行的实际应用程序 web 应用程序，以便可以利用域后用户的应用程序脚本的宽松规则，并且整个信息的潮起潮落都留在我们的域后面。

现在我不清楚的是从第 2 步到第 3 步的跳转。

从运行创建新用户域帐户作为本质上匿名用户身份的入口点应用程序到运行域级应用程序作为他们的新域的过渡，最好和最轻松（对于用户而不是我）是什么？用户身份。

我一直在研究 OAUTH，但似乎更多的是用于与驱动器和 youtube 等外部集成。我对这个项目的目标是让所有东西（除了客户端验证和 jQuery 之类的东西）都从谷歌的云中运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T03:52:34.753

在 #2 中，我假设您有一个未使用的 gapps 帐户池。在#3 中，您需要先让用户在 gapps 中登录。为此，您需要显示一个特殊的登录网址，该网址将重定向到其他应用程序。另一种方法是手动执行 oauth 流程并使用重定向 url 访问新应用程序。

# javascript - Jquery Mobile .load() 没有从应用程序缓存中检索内容

> ID：15672537
> 
> 赞同：1
> 
> 时间：2013-03-28T01:12:57.960
> 
> 标签：javascript, jquery, jquery-mobile

我有一个使用 cache.manifest 在本地缓存 HTML 内容的应用程序。当我使用 Jquery .load() 检索此内容时，不会从应用程序缓存中检索该内容，并且如果设备处于脱机状态，则调用将失败。

正在加载 cache.manifest 中指定的文件，当我在站点中加载时，我可以在 charles 中看到。

离线时，我可以在浏览器中输入缓存文件的 URL，它显示得很好，只是不使用 .load()，所以我确信 cache.manifest 正在正确加载所有内容。

我的问题是，如何使用 jquery 或纯 JS 加载 HTML 页面，并确保它在设备离线时使用应用程序缓存？

```
CACHE MANIFEST
/m2/docs/e5a133db912860d8ec124cce9caa78d1/Q00X03.htm
/m2/docs/e5a133db912860d8ec124cce9caa78d1/M00X03.htm
/m2/docs/e5a133db912860d8ec124cce9caa78d1/Q97X01.htm
/m2/docs/e5a133db912860d8ec124cce9caa78d1/M97X01.htm
/m2/style.css
/m2/docs/e5a133db912860d8ec124cce9caa78d1/index.htm
/m2/docs/e5a133db912860d8ec124cce9caa78d1/doc.json 
```

然后像这样调用：

```
$("#docu").load("/m2/docs/e5a133db912860d8ec124cce9caa78d1/M97X01.htm"); 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T09:54:04.823

我能够让它工作（相当混乱）：

在我的应用程序中，我制作了一个隐藏的 iFrame：

```
<div style="display:none;">         
<iframe id="dummyContent"></iframe>
</div> 
```

为这个 iFrame 设置一个侦听器以读出 BODY 并在它加载时将其插入到我的显示元素中：

```
$("#dummyContent").load(function(){
    var $con = $("#dummyContent").contents().find("body");
    $("#docu").html($con);  // docu is my display div
}); 
```

为内容检索按钮设置一个单击处理程序，以将 iFrame 的 src 设置为我的内容： **这是按预期从应用程序缓存加载的。**

> ```
> $("#questionButton").click(function(ev) {
>      $("#dummyContent").attr("src","/m2/docs/e5a133db912860d8ec124cce9caa78d1/M97X01.htm");
> }); 
> ```

如果有人有不同的方法，我将不胜感激，也许不使用 iFrame。这个解决方案就在那里，使用表格来对齐页面内容......

# php - 谷歌图json php带注释的时间线不起作用

> ID：15672541
> 
> 赞同：0
> 
> 时间：2013-03-28T01:13:35.753
> 
> 标签：php, html, json, wordpress, google-visualization

我在使用 google graph api 时遇到问题。

问题是日期在带注释的时间线图中不起作用。图表不可见。数据来自 MySQL 数据库，运行良好。这是一个wordpress网站。如果使用带 int 的 BarChart 而不是 Date 则可以。

json数据：

```
{"cols":[{"label":"Datum","type":"string"},{"label":"Relax","type":"date"},
{"label":"Rest","type":"date"},{"label":"Active","type":"date"}],
"rows":[{"c":[{"v":"2013-03-27 17:05"},{"v":"Date(2012, 12, 1)"},
{"v":"Date(2012, 12, 1)"},{"v":"Date(2012, 12, 1)"}]},
{"c":[{"v":"2013-03-27 16:53"},{"v":"Date(2012, 12, 1)"},
{"v":"Date(2012, 12, 1)"},{"v":"Date(2012, 12, 1)"}]},
{"c":[{"v":"2013-03-27 16:53"},{"v":"Date(2012, 12, 1)"},
{"v":"Date(2012, 12, 1)"},{"v":"Date(2012, 12, 1)"}]},
{"c":[{"v":"2013-03-27 16:51"},{"v":"Date(2012, 12, 1)"},
{"v":"Date(2012, 12, 1)"},{"v":"Date(2012, 12, 1)"}]},
{"c":[{"v":"2013-03-27 16:41"},{"v":"Date(2012, 12, 1)"},
{"v":"Date(2012, 12, 1)"},{"v":"Date(2012, 12, 1)"}]},
{"c":[{"v":"2013-03-27 16:38"},{"v":"Date(2012, 12, 1)"},
{"v":"Date(2012, 12, 1)"},{"v":"Date(2012, 12, 1)"}]},
{"c":[{"v":"2013-03-27 16:32"},{"v":"Date(2012, 12, 1)"},
{"v":"Date(2012, 12, 1)"},{"v":"Date(2012, 12, 1)"}]},
{"c":[{"v":"2013-03-27 16:31"},{"v":"Date(2012, 12, 1)"},
{"v":"Date(2012, 12, 1)"},{"v":"Date(2012, 12, 1)"}]},
{"c":[{"v":"2013-03-27 16:31"},{"v":"Date(2012, 12, 1)"},
{"v":"Date(2012, 12, 1)"},{"v":"Date(2012, 12, 1)"}]},
{"c":[{"v":"2013-03-27 16:30"},{"v":"Date(2012, 12, 1)"},
{"v":"Date(2012, 12, 1)"},{"v":"Date(2012, 12, 1)"}]}]} 
```

php/html 代码这是一个文件。

```
$con = mysql_connect($db_host,$db_user,$db_pass) or die("Failed to connect with database!!!!");
mysql_select_db($db_db);

$sth = mysql_query("SELECT * FROM {$table}");

$rows = array();
//flag is not needed
$flag = true;
$table = array();
$table['cols'] = array(

    //Labels your chart, this represent the column title
    array('label' => 'Datum', 'type' => 'string'),
    array('label' => 'Relax', 'type' => 'date'),
    array('label' => 'Rest', 'type' => 'date'),
    array('label' => 'Active', 'type' => 'date')
);

$rows = array();
while($r = mysql_fetch_assoc($sth)) {
    $temp = array();
    // the following line will used to slice the Pie chart
    $temp[] = array('v' => (string) $r['Date']); 

    //Values of the each slice
    $temp[] = array('v' => "Date(2012, 12, 1)"); 
    $temp[] = array('v' => "Date(2012, 12, 1)");
    $temp[] = array('v' => "Date(2012, 12, 1)");

    $rows[] = array('c' => $temp);
}

$table['rows'] = $rows;
$jsonTable = json_encode($table);
echo $jsonTable;
?>

  <head>
    <!--Load the AJAX API-->
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript">

    // Load the Visualization API and the piechart package.
    google.load('visualization', '1', {'packages':['annotatedtimeline']});

    // Set a callback to run when the Google Visualization API is loaded.
    google.setOnLoadCallback(drawChart);

    function drawChart() {

      // Create our data table out of JSON data loaded from server.
      var data = new google.visualization.DataTable(<?=$jsonTable?>);/*
      var options = {
            displayAnnotations: true,
            annotationsWidth: 20,
            scaleType: 'maximized'  
        };

      var chart = new google.visualization.AnnotatedTimeLine(document.getElementById('chart_div'));
      chart.draw(data, options);
      */
      var chart = new google.visualization.AnnotatedTimeLine(document.getElementById('chart_div'));    
        chart.draw(data, 
            {
                displayAnnotations: true,
                annotationsWidth: 20,
                scaleType: 'maximized'      
            }
        );
    }
    </script>
  </head>

  <body>
    <!--Div that will hold the pie chart-->
    <div id="chart_div"></div>
  </body>

<?php include (TEMPLATEPATH . '/searchform.php'); ?>
</div>
<?php get_footer(); ?> 
```

# rdf - DBpedia，获取 Place 的直接或间接类型

> ID：15672546
> 
> 赞同：0
> 
> 时间：2013-03-28T01:14:10.727
> 
> 标签：rdf, sparql, dbpedia

我只想获得的直接或间接子类`http://dbpedia.org/ontology/Place`

```
 SELECT DISTINCT ?type,?label WHERE {
         :Mauritius rdf:type ?type .
         ?type rdfs:label ?label .
         FILTER (LANG(?label)='en')
    } 
```

上面的查询有效。但是它返回给我不同类型的不同结果。我只想将类型限制为的直接或间接子类`http://dbpedia.org/ontology/Place`，

这可能吗？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:29:50.797

太好了，知道了，使用`rdfs:subClassOf`并且不要忘记`*`制作它`rdfs:subClassOf*`

```
SELECT DISTINCT ?type,?label WHERE {
     :Mauritius rdf:type ?type .
     ?type rdfs:label ?label .
     ?type rdfs:subClassOf* dbpedia-owl:Place .
     FILTER (LANG(?label)='en')
} 
```

# github-api - 如何使用 curl 命令在 API 中标记提交

> ID：15672547
> 
> 赞同：15
> 
> 时间：2013-03-28T01:14:33.697
> 
> 标签：github-api

我正在尝试使用 curl 命令来标记提交。这可能吗？我浏览了来自 GitHub 的[create-a-tag-object](http://developer.github.com/v3/git/tags/#create-a-tag-object)链接，但它不起作用。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-03-28T09:26:40.523

创建标签有点复杂，但如果您只遵循 API 文档就可以了。请注意，[API 文档说](http://developer.github.com/v3/git/tags/#create-a-tag-object)：

> 请注意，创建标签对象不会创建在 Git 中创建标签的引用。如果要在 Git 中创建带注释的标签，则必须执行此调用以创建标签对象，然后创建 refs/tags/[tag] 引用。如果你想创建一个轻量级标签，你只需要创建引用——这个调用是不必要的。

因此，在继续创建标签之前，您应该知道要创建什么样的标签——带[注释的或轻量级](http://git-scm.com/book/en/Git-Basics-Tagging)的。基本上，带注释的标签与轻量级标签相同，但它还包含标签的消息、标签作者的信息以及标签的创建日期和时间。轻量级标签只是指向历史中特定提交的命名指针。

好的，所以，API 文档基本上说的是：如果你想创建一个带注释的标签 - 你必须进行 2 次 API 调用，如果你想创建一个轻量级标签 - 你只需要进行 1 次调用。因此，我将给出一个使用 2 个 API 调用创建带注释标签的示例，如果您想创建一个轻量级标签 - 只需跳过第一个 API 调用并转到第二个。

要创建带注释的标签，您必须：

### 第1步

[使用标签 API 创建标签对象](http://developer.github.com/v3/git/tags/#create-a-tag-object)。API 文档在这里有点不清楚应该如何传递参数。缺少的是您需要发送到服务器的消息示例。因此，在本地磁盘上创建一个名为的文件`tag_object_req.json`，并将以下 JSON 文档放入其中：

```
{
  "tag": "v0.0.1",
  "object": "c5f8759ffd808d4a57ea36c63960f3e2cc6fcc2b",
  "message": "creating a tag",
  "tagger": {
    "name": "Ivan Zuzak",
    "email": "izuzak@gmail.com",
    "date": "2012-06-17T14:53:35-07:00"
  },
  "type": "commit"
} 
```

显然，您必须替换文档中的信息以反映您的情况。[参数的含义在此处](http://developer.github.com/v3/git/tags/#create-a-tag-object)的 API 文档中进行了描述。

保存文件后，您可以使用 curl 进行 API 调用来创建标签对象：

```
curl -v -X POST -d @tag_object_req.json --header "Content-Type:application/json" -u izuzak "https://api.github.com/repos/izuzak/test/git/tags" 
```

所以，这部`-v`分会强制 curl 输出所有的 HTTP 头，这`-X POST`部分意味着必须发出一个 HTTP POST 请求，`-d @tag_object_req.json`指定哪个文件将作为 POST 请求的内容（正文），`--header "Content-Type:application/json"`指定请求的媒体类型（ JSON 消息），并`-u izuzak`指定您的用户名以进行授权（当您发出请求时，curl 会询问您的密码）。

您得到的响应应该是`201 Created`HTTP 响应，JSON 消息的结构如下：

```
{
  "sha": "e6d9fb6b9a13cab11923345e2400d5cf8df97267",
  "url": "https://api.github.com/repos/izuzak/test/git/tags/e6d9fb6b9a13cab11923345e2400d5cf8df97267",
  "tagger": {
    "name": "Ivan Zuzak",
    "email": "izuzak@gmail.com",
    "date": "2012-06-17T21:53:35Z"
  },
  "object": {
    "sha": "c5f8759ffd808d4a57ea36c63960f3e2cc6fcc2b",
    "type": "commit",
    "url": "https://api.github.com/repos/izuzak/test/git/commits/c5f8759ffd808d4a57ea36c63960f3e2cc6fcc2b"
  },
  "tag": "v0.0.1",
  "message": "creating a tag"
} 
```

在继续之前，请注意`sha`您刚刚创建的对象的属性 ( `e6d9fb6b9a13cab11923345e2400d5cf8df97267`)，因为您将在下一步中使用该值。

### 第2步

[使用引用 API 创建标签引用](http://developer.github.com/v3/git/refs/#create-a-reference)。API 文档在这里更清楚地说明了请求的外观。因此，您首先必须在磁盘上创建另一个名为 的文件`tag_ref_req.json`，并将此内容放入其中：

```
{
  "ref": "refs/tags/v0.0.1",
  "sha": "e6d9fb6b9a13cab11923345e2400d5cf8df97267"
} 
```

但是，请注意，`sha`此 JSON 中的值取决于您创建的标签类型。如果您正在创建带注释的标签，则 sha 的值与您从上一步中获得的值相同 - 标签对象的 sha ( `e6d9fb6b9a13cab11923345e2400d5cf8df97267`)。但是，如果您正在创建轻量级标记，则 sha 的值是您使用标记标记的提交对象的 sha，因为您尚未创建标记对象。在我的情况下，您可以在步骤 1 中看到我标记的提交对象是`c5f8759ffd808d4a57ea36c63960f3e2cc6fcc2b`，如果您正在创建轻量级标签，这在您的情况下当然会有所不同。

好的，所以在您创建了这个文件并定义了标签的 sha 和名称之后，您可以使用 curl 以与上一步类似的方式发出 API 请求：

```
curl -v -X POST -d @tag_ref_req.json --header "Content-Type:application/json" -u izuzak "https://api.github.com/repos/izuzak/test/git/refs" 
```

请注意，我们现在正在以`https://api.github.com/repos/izuzak/test/git/refs`第二个文件作为内容发出请求。

响应应该再次是`201 Created`HTTP 响应，正文将是一个 JSON 文档，如下所示：

```
{
  "ref": "refs/tags/v0.0.1",
  "url": "https://api.github.com/repos/izuzak/test/git/refs/tags/v0.0.1",
  "object": {
    "sha": "e6d9fb6b9a13cab11923345e2400d5cf8df97267",
    "type": "tag",
    "url": "https://api.github.com/repos/izuzak/test/git/tags/e6d9fb6b9a13cab11923345e2400d5cf8df97267"
  }
} 
```

现在您可以导航到 GitHub 上的项目并转到“切换分支/标签”并在那里查看您的标签。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-20T09:10:13.190

您还可以尝试新的 Releases API

[http://developer.github.com/v3/repos/releases/#create-a-release](http://developer.github.com/v3/repos/releases/#create-a-release)

```
curl \
    --user <username> \
    --header "Accept: application/vnd.github.manifold-preview" \
    --data "tag_name=mytagname" \
    "https://api.github.com/repos/<username>/<repository>/releases" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-05-28T18:19:24.953

这是 curl 将创建**Releases**。（但正如[ChuckK](https://stackoverflow.com/a/19475706/6785908)提到的，它可能只创建轻量级标签，我还没有亲自验证过）

```
curl \
    --user <Your Github username> \
    --header "Accept: application/vnd.github.manifold-preview" \
    --data '{"tag_name": "v1.0.0", "target_commitish": "master", "name": "v1.0.0", "body": "Description of the release", "draft": false, "prerelease": false }' \
"https://api.github.com/repos/<OrganizationName>/<RepoName>/releases" -X POST 
```

在这里添加这个，以防有人来找这个，比如我。

# c++ - foreach(int i.. 和 foreach(auto i) 之间的区别

> ID：15672549
> 
> 赞同：4
> 
> 时间：2013-03-28T01:15:09.167
> 
> 标签：c++, auto

我正在 Mac OX (LLVM 4.2) 附带的 Clang 编译器上试验 C++11 功能，以下结果让我感到困惑：

```
// clang compile with "c++ -std=c++11 -stdlib=libc++"
#include <iostream>
#include <vector>
int main(void) {
    using namespace std;
    vector<int> alist={1, 2, 3, 4};

    for (int i=0; i<alist.size(); i++) {
        cout << alist[i] << " ";
    }
    cout << endl;

    for (auto i: alist) {
        cout << alist[i] << " ";
    }
    cout << endl;

    return 0;
} 
```

在运行环境中，我得到不同的输出，如下所示：

```
1 2 3 4 
2 3 4 0 
```

为什么我会得到不同的结果？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-28T01:17:47.337

```
for (auto i: alist) 
```

这会获取 中的每个**值**，`alist`因此`i`变为：

```
1,2,3,4 
```

然后你做

```
cout << alist[i] << " "; 
```

这意味着`alist[1]`, `alist[2]`，`alist[3]`而`alist[4]`不是值 1, 2, 3, 4。你应该简单地写：

```
cout << i << " "; 
```

# python - tkinter 列表框 get(ACTIVE) 方法

> ID：15672552
> 
> 赞同：28
> 
> 时间：2013-03-28T01:15:31.233
> 
> 标签：python, widget, tkinter

我试图使当前选定的`Listbox`项目被打印出来。例如，当我选择项目“一”时，它应该打印出“一”，当我选择项目“二”时，它应该打印出“二”等。以下是我尝试过的。

```
from Tkinter import*
root=Tk()
sizex = 600
sizey = 400
posx  = 40
posy  = 20
root.wm_geometry("%dx%d+%d+%d" % (sizex, sizey, posx, posy))
itemsforlistbox=['one','two','three','four','five','six','seven']

def CurSelet(evt):
    value=str((mylistbox.get(ACTIVE)))
    print value

mylistbox=Listbox(root,width=60,height=10,font=('times',13))
mylistbox.bind('<<ListboxSelect>>',CurSelet)
mylistbox.place(x=32,y=90)

for items in itemsforlistbox:
    mylistbox.insert(END,items)
root.mainloop() 
```

我的问题是每当我在列表框中选择一个项目时，它实际上是在打印出之前选择的项目。例如，当我在列表中选择项目“二”时，它正在打印出“一”。为了让事情更清楚，请参阅以下内容

1.  我选择了项目“一”，它打印出“一”
2.  我选择了项目“二”，它再次打印出“一”
3.  我选择了项目“三”，它打印出“二”等等......

我错过了什么吗？还是我误解了`get(ACTIVE)`工作方式？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-03-28T01:25:18.527

一个项目在您单击后变为活动状态——这意味着在您的`ListboxSelect`方法返回之后。因此，您将打印出在此单击*之前*处于活动状态的任何内容（通常是指您*上次*单击的内容）。

另外，鉴于您多次提到“选定”，我认为您想要的是*选定*的值，而不是*活动*的值，因此您应该要求这样做。

对于带有`selectmode=SINGLE`或`BROWSE`（默认的，您所拥有的）列表框的列表框，您可以轻松地修复这两个问题。只需更改此：

```
mylistbox.get(ACTIVE) 
```

到：

```
mylistbox.get(mylistbox.curselection()) 
```

如果您需要处理`MULTIPLE`or `EXTENDED`，那么当然有 0 到 7 个选择而不是 1，因此您需要执行以下操作：

```
values = [mylistbox.get(idx) for idx in mylistbox.curselection()]
print ', '.join(values) 
```

当我们这样做时，我不确定你为什么要这样做`str((mylistbox.get(ACTIVE)))`，甚至`str(mylistbox.get(ACTIVE))`。使用单个索引的结果`mylistbox.get`将是一个字符串，与您插入的相同。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-11-06T11:04:25.053

这似乎对我有用：

```
mylistbox.get(ANCHOR) 
```

根据您的代码，它将打印出当前项目。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-02-19T23:18:23.010

您可以使用它，它不需要列表框。因此，如果您有多个列表框，它将从任何

```
from tkinter import*
root=Tk()
sizex = 600
sizey = 400
posx  = 40
posy  = 20
root.wm_geometry("%dx%d+%d+%d" % (sizex, sizey, posx, posy))
itemsforlistbox=['one','two','three','four','five','six','seven']

def CurSelet(event):
    widget = event.widget
    selection=widget.curselection()
    picked = widget.get(selection[1])
    print(picked)

mylistbox=Listbox(root,width=60,height=10,font=('times',13))
mylistbox.bind('<<ListboxSelect>>',CurSelet)
mylistbox.place(x=32,y=90)

for items in itemsforlistbox:
    mylistbox.insert(END,items)
root.mainloop() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-12-13T14:30:22.057

如 user1576772 所述，正确答案应该是：

```
mylistbox.get(ANCHOR) 
```

问题`curselection()`是它每次都返回当前选择的整个列表。

考虑一种情况，您滚动列表框并希望始终向前或向后获取最后一个选定的项目（不是突出显示列表中的最后一个项目，用户按下的最后一个项目）！`curselection()`将为您提供所有当前选择的项目，这很有帮助，但您永远不会知道最后选择了哪个项目！

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-06-24T23:01:30.540

该行`picked = widget.get(selection[1])`应该是`picked = widget.get(selection[0])`.

否则，将出现“索引超出范围”错误。

# iphone - 无限滚动图像；在纵向模式下从左到右滚动

> ID：15672554
> 
> 赞同：0
> 
> 时间：2013-03-28T01:15:39.107
> 
> 标签：iphone, ios, cocoa-touch

我正在尝试在设备处于纵向模式时使图像水平向右滚动。图像需要自动滚动，直到计时器结束，并且需要无缝滚动。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T03:37:05.780

试试这个，希望这会有所帮助。

```
// Create Image's array

    NSMutableArray * imagesArray = [[NSMutableArray alloc]init];
    for (int imageCount = 0; imageCount < YOURCOUNT;imageCount++)
     {
       [imagesArray addObject:[UIImage imageNamed:@"localImagePath%d.png",imageCount]];
     }
// Create ScrollView    

    UIScrollView * scrollview = [[UIScrollView alloc]initWithFrame:CGRectMake(0.0,0.0,320.0,480.0)];
    scrollview.contentSize = CGSizeMake(scrollview.frame.size.width * YOURCOUNT,scrollview.frame.size.height);

// Add those image's to the scrollview 

    CGFloat xPos = 0.0;
    for (UIImage * image in imagesArray) {
     @autoreleasepool {
      UIImageView * imageview = [[UIImageView alloc]initWithImage:image];
      imageview.frame = CGRectMake(xPos, 0.0,scrollview.frame.size.width,scrollview.frame.size.height);
                    [scrollview addSubview:imageview];
                    xPos += scrollview.frame.size.width;
      }
    }

    [self.view addSubview:scrollview];

// Animate to the Right

    [UIView animateWithDuration:10.0 delay:0 options:UIViewAnimationTransitionNone
                             animations:^{
                                 [scrollview setContentOffset:CGPointMake(scrollview.contentSize.width - scrollview.frame.size.width,0.0) animated:NO];
                             }
                             completion:^(BOOL finished) {
                                 NSLog(@"Finished");
                             }]; 
```

# json - 在 Go 中处理 JSON 发布请求

> ID：15672556
> 
> 赞同：300
> 
> 时间：2013-03-28T01:16:07.317
> 
> 标签：json, go

所以我有以下内容，这似乎令人难以置信，我一直在想，Go 有比这更好的设计库，但我找不到 Go 处理 JSON 数据的 POST 请求的示例。它们都是表单 POST。

这是一个示例请求：`curl -X POST -d "{\"test\": \"that\"}" http://localhost:8082/test`

这是代码，嵌入了日志：

```
package main

import (
    "encoding/json"
    "log"
    "net/http"
)

type test_struct struct {
    Test string
}

func test(rw http.ResponseWriter, req *http.Request) {
    req.ParseForm()
    log.Println(req.Form)
    //LOG: map[{"test": "that"}:[]]
    var t test_struct
    for key, _ := range req.Form {
        log.Println(key)
        //LOG: {"test": "that"}
        err := json.Unmarshal([]byte(key), &t)
        if err != nil {
            log.Println(err.Error())
        }
    }
    log.Println(t.Test)
    //LOG: that
}

func main() {
    http.HandleFunc("/test", test)
    log.Fatal(http.ListenAndServe(":8082", nil))
} 
```

一定有更好的方法，对吧？我只是很难找到最佳实践。

（Go 在搜索引擎中也被称为 Golang，在这里提到是为了让其他人可以找到它。）

* * *

## 回答 #1

> 赞同：444
> 
> 时间：2013-03-28T15:11:53.443

请使用`json.Decoder`而不是`json.Unmarshal`.

```
func test(rw http.ResponseWriter, req *http.Request) {
    decoder := json.NewDecoder(req.Body)
    var t test_struct
    err := decoder.Decode(&t)
    if err != nil {
        panic(err)
    }
    log.Println(t.Test)
} 
```

* * *

## 回答 #2

> 赞同：98
> 
> 时间：2013-03-28T01:24:28.913

您需要从`req.Body`. 该`ParseForm`方法从 中读取`req.Body`，然后以标准 HTTP 编码格式对其进行解析。您想要的是读取正文并以 JSON 格式对其进行解析。

这是您更新的代码。

```
package main

import (
    "encoding/json"
    "log"
    "net/http"
    "io/ioutil"
)

type test_struct struct {
    Test string
}

func test(rw http.ResponseWriter, req *http.Request) {
    body, err := ioutil.ReadAll(req.Body)
    if err != nil {
        panic(err)
    }
    log.Println(string(body))
    var t test_struct
    err = json.Unmarshal(body, &t)
    if err != nil {
        panic(err)
    }
    log.Println(t.Test)
}

func main() {
    http.HandleFunc("/test", test)
    log.Fatal(http.ListenAndServe(":8082", nil))
} 
```

* * *

## 回答 #3

> 赞同：72
> 
> 时间：2016-03-15T00:01:24.680

我被这个确切的问题逼疯了。我的 JSON Marshaller 和 Unmarshaller 没有填充我的 Go 结构。然后我在[https://eager.io/blog/go-and-json](https://eager.io/blog/go-and-json)找到了解决方案：

> “与 Go 中的所有结构一样，重要的是要记住只有首字母大写的字段对 JSON Marshaller 等外部程序可见。”

在那之后，我的 Marshaller 和 Unmarshaller 完美地工作了！

* * *

## 回答 #4

> 赞同：72
> 
> 时间：2019-03-07T21:10:45.063

有两个原因`json.Decoder`应该优先于`json.Unmarshal`- 2013 年最流行的答案中没有解决：

1.  2018 年 2 月，`go 1.10`引入了一种新方法[json.Decoder.DisallowUnknownFields()](https://golang.org/pkg/encoding/json/#Decoder.DisallowUnknownFields) ，它解决了检测不需要的 JSON 输入的问题
2.  `req.Body`已经是一个`io.Reader`. 如果流是读取其全部内容然后执行会`json.Unmarshal`浪费资源，例如 10MB 的无效 JSON 块。如果遇到无效的 JSON ，解析请求正文，使用`json.Decoder`, 因为它*流入*将触发早期解析错误。实时处理 I/O 流是首选*方式*。

* * *

解决一些关于检测不良用户输入的用户评论：

要强制执行必填字段和其他卫生检查，请尝试：

```
d := json.NewDecoder(req.Body)
d.DisallowUnknownFields() // catch unwanted fields

// anonymous struct type: handy for one-time use
t := struct {
    Test *string `json:"test"` // pointer so we can test for field absence
}{}

err := d.Decode(&t)
if err != nil {
    // bad JSON or unrecognized json field
    http.Error(rw, err.Error(), http.StatusBadRequest)
    return
}

if t.Test == nil {
    http.Error(rw, "missing field 'test' from JSON object", http.StatusBadRequest)
    return
}

// optional extra check
if d.More() {
    http.Error(rw, "extraneous data after JSON object", http.StatusBadRequest)
    return
}

// got the input we expected: no more, no less
log.Println(*t.Test) 
```

[操场](https://play.golang.org/p/1wAH5QAWSlM)

典型输出：

```
$ curl -X POST -d "{}" http://localhost:8082/strict_test

expected json field 'test'

$ curl -X POST -d "{\"Test\":\"maybe?\",\"Unwanted\":\"1\"}" http://localhost:8082/strict_test

json: unknown field "Unwanted"

$ curl -X POST -d "{\"Test\":\"oops\"}g4rB4g3@#$%^&*" http://localhost:8082/strict_test

extraneous data after JSON

$ curl -X POST -d "{\"Test\":\"Works\"}" http://localhost:8082/strict_test 

log: 2019/03/07 16:03:13 Works 
```

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2015-04-17T01:48:03.233

我发现文档中的以下示例非常有用（来源[here](http://golang.org/pkg/encoding/json/#example_Decoder)）。

```
package main

import (
    "encoding/json"
    "fmt"
    "io"
    "log"
    "strings"
)

func main() {
    const jsonStream = `
        {"Name": "Ed", "Text": "Knock knock."}
        {"Name": "Sam", "Text": "Who's there?"}
        {"Name": "Ed", "Text": "Go fmt."}
        {"Name": "Sam", "Text": "Go fmt who?"}
        {"Name": "Ed", "Text": "Go fmt yourself!"}
    `
    type Message struct {
        Name, Text string
    }
    dec := json.NewDecoder(strings.NewReader(jsonStream))
    for {
        var m Message
        if err := dec.Decode(&m); err == io.EOF {
            break
        } else if err != nil {
            log.Fatal(err)
        }
        fmt.Printf("%s: %s\n", m.Name, m.Text)
    }
} 
```

这里的关键是 OP 正在寻找解码

```
type test_struct struct {
    Test string
} 
```

...在这种情况下，我们将删除`const jsonStream`, 并将`Message`结构替换为`test_struct`：

```
func test(rw http.ResponseWriter, req *http.Request) {
    dec := json.NewDecoder(req.Body)
    for {
        var t test_struct
        if err := dec.Decode(&t); err == io.EOF {
            break
        } else if err != nil {
            log.Fatal(err)
        }
        log.Printf("%s\n", t.Test)
    }
} 
```

**更新**：我还要补充一点，[这篇文章](http://thenewstack.io/make-a-restful-json-api-go/)还提供了一些关于使用 JSON 响应的重要数据。作者解释说`struct tags`，我不知道。

由于 JSON 通常看起来不像`{"Test": "test", "SomeKey": "SomeVal"}`，而是`{"test": "test", "somekey": "some value"}`，您可以像这样重组您的结构：

```
type test_struct struct {
    Test string `json:"test"`
    SomeKey string `json:"some-key"`
} 
```

...现在您的处理程序将使用“some-key”而不是“SomeKey”（您将在内部使用）解析 JSON。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2020-01-21T23:59:04.063

```
type test struct {
    Test string `json:"test"`
}

func test(w http.ResponseWriter, req *http.Request) {
    var t test_struct

    body, _ := ioutil.ReadAll(req.Body)
    json.Unmarshal(body, &t)

    fmt.Println(t)
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-09-09T16:29:21.680

我喜欢在本地定义自定义结构。所以：

```
// my handler func
func addImage(w http.ResponseWriter, r *http.Request) {

    // define custom type
    type Input struct {
        Url        string  `json:"url"`
        Name       string  `json:"name"`
        Priority   int8    `json:"priority"`
    }

    // define a var 
    var input Input

    // decode input or return error
    err := json.NewDecoder(r.Body).Decode(&input)
    if err != nil {
        w.WriteHeader(400)
        fmt.Fprintf(w, "Decode error! please check your JSON formating.")
        return
    }

    // print user inputs
    fmt.Fprintf(w, "Inputed name: %s", input.Name)

} 
```

# sql - 只执行最后一个插入语句

> ID：15672558
> 
> 赞同：1
> 
> 时间：2013-03-28T01:16:14.190
> 
> 标签：sql, oracle

我对 SQL 很陌生，我正在尝试将一堆 INSERT 语句插入到表中。我正在使用 SQL Developer 和 Oracle 11g。

我的桌子：

```
CREATE OR REPLACE TYPE friendlist AS VARRAY(20) OF VARCHAR2(50);
/

create or replace type table fbuser(fbid varchar(10) not null enable,firstname varchar(30),lastname varchar(30),dob
date,birthcity varchar(30),birthstate varchar(25),friends friendlist,primary key(fbid));
/ 
```

还有我的插入语句：

```
insert into fbuser values('f1','abhinav','cheatham',to_date('01-jul-1969','dd-mon-yyyy'),'lake city','fl',friendlist('f2','f7','f9'));
/

insert into fbuser values('f2','abhishek','deponto',to_date('05-feb-1984','dd-mon-yyyy'),'adak','ak',friendlist('f1','f6','f9','f16','f18'));
/

insert into fbuser values('f3','aldrich','chapel',to_date('27-may-1988','dd-mon-yyyy'),'vernon hills','il',null);
/ 
```

我也试过没有 / 。但它给了我同样的错误。我哪里错了？你能推荐一个好的教程/网站，我可以从中学习吗？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T01:22:09.447

您可以使用以下语法插入多行：

```
INSERT ALL
  INTO mytable (column1, column2, column3) VALUES ('val1.1', 'val1.2', 'val1.3')
  INTO mytable (column1, column2, column3) VALUES ('val2.1', 'val2.2', 'val2.3')
  INTO mytable (column1, column2, column3) VALUES ('val3.1', 'val3.2', 'val3.3')
SELECT NULL FROM DUAL; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T02:43:17.847

我不确定您是如何成功执行该 CREATE TABLE 语句的 - 它在我的系统 (11gR2) 上无效。我有更好的运气：

```
create table fbuser(fbid varchar2(10) not null enable
     , firstname varchar2(30), lastname varchar2(30), dob date
     , birthcity varchar2(30), birthstate varchar2(25)    
     , friends friendlist, primary key (fbid)); 
```

然后插入物按应有的方式进行。

插入后的 / 字符将导致每个插入执行两次。用分号或 / 终止它们，但不能同时使用两者。

# java - 如何裁剪位图？

> ID：15672561
> 
> 赞同：0
> 
> 时间：2013-03-28T01:16:28.753
> 
> 标签：java, android, paint, crop

我开发了一个绘画应用程序，我想插入裁剪功能，我使用 CanvasView 中的这段代码：

```
public void Crop() {
    // TODO Auto-generated method stub
    int value = 0;
    if (bitmap.getHeight() <= bitmap.getWidth()) {
        value = bitmap.getHeight();
    } else {
        value = bitmap.getWidth();
    }

    Bitmap finalBitmap = null;
    finalBitmap = Bitmap.createBitmap(bitmap, 0, 0, value, value);
    Bitmap lastBitmap = null;
    lastBitmap = Bitmap.createScaledBitmap(finalBitmap, 144, 144, true);

} 
```

但我收到以下错误

```
03-28 03:10:18.365: E/AndroidRuntime(19708): FATAL EXCEPTION: main
03-28 03:10:18.365: E/AndroidRuntime(19708): java.lang.NullPointerException
03-28 03:10:18.365: E/AndroidRuntime(19708):    at baked.soft.CanvasView.Crop(CanvasView.java:670)
03-28 03:10:18.365: E/AndroidRuntime(19708):    at baked.soft.FirstActivity$7.onClick(FirstActivity.java:157)
03-28 03:10:18.365: E/AndroidRuntime(19708):    at android.view.View.performClick(View.java:4232)
03-28 03:10:18.365: E/AndroidRuntime(19708):    at android.view.View$PerformClick.run(View.java:17318)
03-28 03:10:18.365: E/AndroidRuntime(19708):    at android.os.Handler.handleCallback(Handler.java:615)
03-28 03:10:18.365: E/AndroidRuntime(19708):    at android.os.Handler.dispatchMessage(Handler.java:92)
03-28 03:10:18.365: E/AndroidRuntime(19708):    at android.os.Looper.loop(Looper.java:137)
03-28 03:10:18.365: E/AndroidRuntime(19708):    at android.app.ActivityThread.main(ActivityThread.java:4921)
03-28 03:10:18.365: E/AndroidRuntime(19708):    at java.lang.reflect.Method.invokeNative(Native Method)
03-28 03:10:18.365: E/AndroidRuntime(19708):    at java.lang.reflect.Method.invoke(Method.java:511)
03-28 03:10:18.365: E/AndroidRuntime(19708):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1038)
03-28 03:10:18.365: E/AndroidRuntime(19708):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:805)
03-28 03:10:18.365: E/AndroidRuntime(19708):    at dalvik.system.NativeStart.main(Native Method) 
```

这是有错误的行：

```
if (bitmap.getHeight() <= bitmap.getWidth()) { 
```

来自 FirstActivity 的位图

```
imageViewCrop = (ImageView)this.findViewById(R.id.imageViewCrop);
    imageViewCrop.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            Bitmap bitmap = Bitmap.createBitmap(myView.getWidth(),myView.getHeight(),Config.ARGB_8888);
            Canvas canvas = new Canvas(bitmap);
            myView.draw(canvas);
            Toast.makeText(getApplicationContext(), "Redo tool clicked", Toast.LENGTH_SHORT).show();
            myView.Crop();  
            bitmap.recycle();
        }
    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T01:20:47.100

输入`bitmap`为空，因此`NullPoinerException`.

* * *

顺便说一句，您的代码应该看起来更像这样：

```
public void Crop() {
    if(bitmap == null) {
        return;
    }

    final int value;
    if (bitmap.getHeight() <= bitmap.getWidth()) {
        value = bitmap.getHeight();
    } else {
        value = bitmap.getWidth();
    }

    final Bitmap finalBitmap = Bitmap.createBitmap(bitmap, 0, 0, value, value);
    final Bitmap lastBitmap = Bitmap.createScaledBitmap(finalBitmap, 144, 144, true);
} 
```

# c# - 等待异步操作完成

> ID：15672568
> 
> 赞同：1
> 
> 时间：2013-03-28T01:16:59.743
> 
> 标签：c#, windows, windows-phone-7, windows-phone-8

我有一个关于异步方法如何在 c# 上工作的问题。我试图让 convertAddressToCoordinate 方法将 myLocation 变量设置为 GeoCoordinate。但是，甚至在设置 myLocation 值之前调用 compareDistance 方法。在调用 compareDistance() 之前，如何确保 myLocation 值不为空？

```
public GeoCoordinate myLocation = null;

public void returnClosestCurrent(string address)
 {

     convertAddressToCoordinate(address);
     compareDistance(myLocation);

 }

 public void convertAddressToCoordinate(string add)
 {
    WebClient wc = new WebClient();
     wc.DownloadStringCompleted += wc_DownloadStringCompleted;
     wc.DownloadStringAsync(new Uri("http://maps.googleapis.com/maps/api/geocode/json?address=1600+bay+st&sensor=false"));

 }

 void wc_DownloadStringCompleted(object sender, DownloadStringCompletedEventArgs e)
 {

    XDocument xdoc = XDocument.Parse(e.Result, LoadOptions.None);

     var data = from query in xdoc.Descendants("location")
                 select new Location
                 {
                     lat = (string)query.Element("lat"),
                     lng = (string)query.Element("lng")
                 };

     GeoCoordinate destinationGeo = new GeoCoordinate(Convert.ToDouble(data.ElementAt(0).lat), Convert.ToDouble(data.ElementAt(0).lng));

     myLocation = destinationGeo;

 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T01:22:07.307

您可以使用 await 关键字来获取异步任务的值

[http://msdn.microsoft.com/en-us/library/vstudio/hh156528.aspx](http://msdn.microsoft.com/en-us/library/vstudio/hh156528.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T01:35:16.427

查看您的代码，在我看来，`compareDistance(myLocation);`应该只在方法结束时调用`wc_DownloadStringCompleted`。

更改后，一切都应该正常工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T02:03:06.107

`await`你会想要`wc.DownloadStringAsync`

```
public async Task returnClosestCurrent(string address)
{
    await convertAddressToCoordinate(address)
              .ContinueWith(t => compareDistance(myLocation));
}

public async Task convertAddressToCoordinate(string add)
{
    WebClient wc = new WebClient();
    wc.DownloadStringCompleted += wc_DownloadStringCompleted;
    await wc.DownloadStringAsync(new Uri("http://maps.googleapis.com/maps/api/geocode/json?address=1600+bay+st&sensor=false"));
} 
```

带有`async`/的模式`await`是代码倾向于将所有内容都变成`async`/`await`

它可以重构使用[`WebClient.DownloadStringTaskAsync`](http://msdn.microsoft.com/en-us/library/hh138332.aspx)

```
public async Task ReturnClosestCurrent(string address)
{
    await convertAddressToCoordinate(address)
            .ContinueWith(t => compareDistance(t.Result));
}

public async Task<GeoCoordinate> ConvertAddressToCoordinate(string add)
{
    WebClient wc = new WebClient();
    wc.DownloadStringCompleted += wc_DownloadStringCompleted;
    var content = await wc.DownloadStringTaskAsync(new Uri("http://maps.googleapis.com/maps/api/geocode/json?address=1600+bay+st&sensor=false"));

    return ParseContent(content);
}

private GeoCoordinate ParseContent(string content)
{
    XDocument xdoc = XDocument.Parse(content, LoadOptions.None);

    var data = from query in xdoc.Descendants("location")
             select new Location
             {
                 lat = (string)query.Element("lat"),
                 lng = (string)query.Element("lng")
             };

    GeoCoordinate destinationGeo = new GeoCoordinate(Convert.ToDouble(data.ElementAt(0).lat), Convert.ToDouble(data.ElementAt(0).lng));

    return destinationGeo;
} 
```

# structuremap - 初始化对象属性

> ID：15672571
> 
> 赞同：0
> 
> 时间：2013-03-28T01:17:07.177
> 
> 标签：structuremap

我在我的服务中注入了一个全局设置接口，作为 Singleton，使用 StructureMap：

```
public interface ISettings {
  LoggerSettings Logger { get; }
} // ISettings

public class LoggerSettings {
  public String Levels { get { return ConfigurationManager.AppSettings["Logger.Levels"]; } }
  public const String Report = "team@xyz.com";
} // LoggerSettings

public class Settings : ISettings {
  public LoggerSettings Logger { get; private set; }
} // Settings 
```

作为 SM 配置，我有：

```
For<ISettings>().Singleton().Use<Settings>(); 
```

我可以注入这个对象，但是当我检查注入的对象时，它的属性 Logger 为空......我怎样才能让 SM 初始化对象属性？

我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T09:58:51.510

您需要一个`Settings`具有`LoggerSettings`参数的类的构造函数，以便 StructureMap 可以在创建时设置 Logger 属性。

如果您由于某种原因不能/不想使用构造函数注入，则需要将类上的`Logger`属性的设置器设为`Settings`公共并在 StructureMap 中[配置属性注入。](https://stackoverflow.com/questions/4979453/structuremap-beginner-property-injection)

**TL; DR**：`Settings`看起来像这样：

```
public class Settings : ISettings {
    public Settings(LoggerSettings logger)
    {
         Logger = logger;
    }

    public LoggerSettings Logger { get; private set; }
} 
```

# c# - 从日历中选择日期到文本框中

> ID：15672572
> 
> 赞同：0
> 
> 时间：2013-03-28T01:17:43.210
> 
> 标签：c#, asp.net

我正在尝试将从日历中选择的日期放入文本框中。

我不断收到无法将日期转换为字符串的错误消息。

我对编码非常陌生，无法弄清楚如何正确解析它以使其正常工作。

谁能帮我？我正在使用 Visual Studio 2010。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T01:50:58.427

不能用字符串分配 TextBox 对象。您只能获取或设置其 Text 属性`TxtTrvFrm.Text`

从你的例子

**错误的：**

```
TxtTrvFrm.ToString() = cdrDepart.SelectedDate 
```

**正确的：**

```
TxtTrvFrm.Text = cdrDepart.SelectedDate.ToString(); 
```

您还可以使用 ToString 或 Text 来获取 datePicker 的当前选定值。

```
 //Output: 3/28/2013 12:00:00 AM
        TxtTrvFrm.Text = this.datePicker1.ToString();

        //Output: 3/28/2013
        TxtTrvFrm.Text = this.datePicker1.Text;

        //Output: 3/28/2013 12:00:00 AM
        TxtTrvFrm.Text = this.datePicker1.SelectedDate.ToString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T01:21:16.597

您通常只需调用 ToString()。你能显示你的代码吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T01:38:13.023

当我将日历中的选定日期转换为字符串时，我使用这个：

```
string dateTime= Calendar.SelectedDate.ToString(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-28T01:40:11.120

试试这个，它是一个 lambda 版本

```
cdrDepart.SelectedDatesChanged += (a, b) =>
{
   TxtTrvFrm.text = cdrDepart.SelectedDate.Value.ToString("yy'.'MM'.'dd");
}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-14T06:17:38.520

如果您尝试将它们放入变量中，请尝试如下：

> 字符串日期 = Convert.ToString(Calendar1.SelectedDate);
> 
> TBDate.Text = 日期；

# php - CakePHP 数据库错误。拒绝访问

> ID：15672574
> 
> 赞同：0
> 
> 时间：2013-03-28T01:17:46.023
> 
> 标签：php, mysql, cakephp, hostmonster

我最近在我的 hostmonster 共享服务器上安装了 CakePHP 并创建了一个新的数据库和用户（具有完全权限），我得到以下信息：

```
Cake is NOT able to connect to the database.

Database connection "Mysql" is missing, or could not be created.
SQLSTATE[42000] [1044] Access denied for user '[user]'@'[host]' to database '[db]' 
```

*   为安全起见，括号中的项目不包括在内。

我已验证 PDO 和 PDO mysql 已启用。凭据已被多次检查和重新检查。我是否缺少其他一些秘密设置，或者主机是否限制了对我的数据库用户的控制？

我的 database.php 配置：

```
public $default = array(
    'datasource' => 'Database/Mysql',
    'persistent' => false,
    'host' => 'host',
    'login' => 'user',
    'password' => 'pass',
    'database' => 'db',
    'prefix' => '',
    //'encoding' => 'utf8',
);

public $test = array(
    'datasource' => 'Database/Mysql',
    'persistent' => false,
    'host' => 'host',
    'login' => 'user',
    'password' => 'pass',
    'database' => 'db',
    'prefix' => '',
    //'encoding' => 'utf8',
); 
```

此外，我已经能够通过以下代码使用完全相同的凭据通过 PDO 成功连接到数据库：

```
$hostname = "host";
$db = "db";
$username = "user";
$password = "pas";

try {
  $db = new PDO("mysql:host=$hostname;dbname=$db", $username, $password);
  echo "Connected to database";
}
catch(PDOException $e) {
  echo $e->getMessage();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T01:29:50.260

SQLSTATE[42000] [1044] 用户 '[user]'@'[host]' 对数据库 '[db]' 的访问被拒绝

意思是，那个蛋糕知道你的数据库细节，但它们不起作用。从链中“删除”蛋糕并尝试从 index.php 中自行连接。

然后尝试从控制台连接。

很可能您设置了错误的数据库详细信息，或者它们在数据库端没有足够的权限。

# c# - IBM MQ 和 .NET 中的 MQRC_Q_MGR_NAME_ERROR 异常

> ID：15672582
> 
> 赞同：1
> 
> 时间：2013-03-28T01:18:13.793
> 
> 标签：c#, .net, websphere, message-queue, ibm-mq

我正在使用 MQ.NET 类，但是当我指定正确的队列管理器时，我仍然得到以下错误。

例外：

CompCode：2，原因：2058 MQRC_Q_MGR_NAME_ERROR 数据：{System.Collections.ListDictionaryInternal}

消息：“MQRC_Q_MGR_NAME_ERROR” 来源：“amqmdnet”

```
MQQueueManager mqQMgr=null; 
//MYMGRTEST is my queue manager
mqQMgr = new MQQueueManager("MYMGRTEST"); -> This piece of line throws above exception. 
```

发生这种情况的可能原因是什么（网络权限/管理员权限/？）？有什么措施可以纠正吗？

我还在 websphere 的错误文件夹下的错误日志中看到此信息。

> AMQ9518：找不到文件“C:\Program Files (x86)\IBM\WebSphere MQ\AMQCLCHL.TAB”。

说明：该程序要求文件“C:\Program Files (x86)\IBM\WebSphere MQ\AMQCLCHL.TAB”存在且可用。

操作：这可能是由可选环境变量 MQCHLLIB、MQCHLTAB 或 MQDATA 的无效值引起的。如果这些变量有效或未设置，那么记录文件的名称并告诉系统管理员必须确保文件“C:\Program Files (x86)\IBM\WebSphere MQ\AMQCLCHL.TAB”对程序可用。

不知道那个错误是关于什么的，因为我已经在我的系统中安装了 MQ 客户端。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T09:22:14.567

希望您正在设置 MQEnvironment：

```
MQEnvironment.channel
MQEnvironment.port
MQEnvironment.hostname 
```

您需要在其中设置正确的值。像：

```
MQEnvironment.hostname="localhost", 
MQEnvironment.port=1414
MQEnvironment.channel="SYSTEM.DEF.CHANNEL" 
```

# r - 遍历矩阵的对角线+1

> ID：15672585
> 
> 赞同：3
> 
> 时间：2013-03-28T01:18:36.303
> 
> 标签：r, matrix

我需要遍历对角线+1（即对角线右侧的值 1 列）并将值写入数据帧中的列：

```
write.csv(data.frame(matrix[1,2], matrix[2,3], matrix[3,4]) 
```

如何使用函数来做到这一点，而不仅仅是列出值的所有位置？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-28T02:07:52.360

`row()`一种快速的方法是使用经常被忽视的和`col()`函数，而无需以编程方式计算索引。这些为矩阵的每个元素分别返回该元素所属的行或列。

对角线是元素的行索引等于列索引的位置。第一个下对角线是行索引等于列索引*加 1*的位置，而第一个上对角线是行索引等于列索引*减 1*的位置。

这里有些例子：

```
m <- matrix(1:25, ncol = 5)
m

> m
     [,1] [,2] [,3] [,4] [,5]
[1,]    1    6   11   16   21
[2,]    2    7   12   17   22
[3,]    3    8   13   18   23
[4,]    4    9   14   19   24
[5,]    5   10   15   20   25 
```

## 对角线

```
m[row(m) == col(m)]
diag(m)

> m[row(m) == col(m)]
[1]  1  7 13 19 25
> diag(m) ## just to show this is correct
[1]  1  7 13 19 25 
```

## 第一个对角线

```
m[row(m) == col(m) + 1

> m[row(m) == col(m) + 1]
[1]  2  8 14 20 
```

## 第一个超对角线

```
m[row(m) == col(m) -1]

> m[row(m) == col(m) -1]
[1]  6 12 18 24 
```

可以通过增加添加到列索引的值来提取高阶超对角线和下对角线。

## 创建数据框并写出

本质上你已经有了这个，但是

```
write.csv(data.frame(m[row(m) == col(m) + 1), file = "subdiag.csv") 
```

## 下对角线或超对角线的一般函数

```
diags <- function(m, type = c("sub", "super"), offset = 1) {
  type <- match.arg(type)
  FUN <-
  if(isTRUE(all.equal(type, "sub")))
    `+`
  else
    `-`
  m[row(m) == FUN(col(m), offset)] 
} 
```

在使用中，我们有：

```
> diags(m)
[1]  2  8 14 20
> diags(m, type = "super")
[1]  6 12 18 24
> diags(m, offset = 2)
[1]  3  9 15 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-28T01:28:25.957

您可以使用矩阵进行索引。

例如

```
m <- matrix(1:25, ncol = 5) 
```

可以使用非对角线访问

```
offd <- cbind(1:4,2:5)

m[offd]

## [1]  6 12 18 24 
```

您可以创建一个执行此操作的函数

```
offdiag <- function(m, offset){
  i <- seq_len(nrow(m)-offset)
  j <- i + offset
  m[cbind(i,j)]

}

offdiag(m, 1)
## [1]  6 12 18 24
offdiag(m, 2)
[1] 11 17 23
offdiag(m, 3)
## [1] 16 22
offdiag(m, 4)
## [1] 21 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-28T01:52:50.740

取子矩阵，然后是它的对角线。

使用 mnel 的`m`：

```
diag(m[, -1])
[1]  6 12 18 24 
```

作为具有可变偏移量的函数（但在这种形式下，它并不比 mnel 的解决方案更干净）：

```
offdiag <- function(m, offset) {
  s <- seq(offset)
  diag(m[,-s, drop=FALSE])
}

offdiag(m, 1)
## [1]  6 12 18 24
offdiag(m, 2)
## [1] 11 17 23
offdiag(m, 3)
## [1] 16 22
offdiag(m, 4)
## [1] 21 
```

# sharepoint - 将文档库 Web 部件添加到网站定义中的页面时，如何选择哪个视图？

> ID：15672586
> 
> 赞同：1
> 
> 时间：2013-03-28T01:18:38.273
> 
> 标签：sharepoint, sharepoint-2010, document-library, sharepointdocumentlibrary, site-definition

在我的自定义 SharePoint 2010 网站定义中：

1.  我的站点定义中有一个具有多个视图的自定义列表实例...
2.  我有一个页面，我想显示其中一个视图...
3.  在页面的 Elements.xml 定义中，我可以在哪里选择显示下面列表实例的 Schema.xml 中显示的“通信”或“会计”视图？

XML 已被清理以简化阅读。

**列出实例的 Schema.xml**

```
<List Title="Client Documents" Direction="none" Url="Client Documents" BaseType="1" Type="101" BrowserFileHandling="Permissive" EnableContentTypes="TRUE" DisableAttachments="TRUE" Catalog="FALSE" VersioningEnabled="TRUE" SendToLocation="|" ImageUrl="/_layouts/images/itdl.png" xmlns:ows="Microsoft SharePoint" xmlns:spctf="http://schemas.microsoft.com/sharepoint/v3/contenttype/forms" xmlns="http://schemas.microsoft.com/sharepoint/">
  <MetaData>
    <ContentTypes>...</ContentTypes>
    <Fields>...</Fields>
    <Forms />
    <Views>
      ...
      <View DisplayName="CORE Client - Accounting" BaseViewID="1" Type="HTML" MobileView="TRUE" ImageUrl="/_layouts/images/dlicon.png" XslLink="main.xsl" WebPartZoneID="Main" WebPartOrder="1" Url="Forms/CORE Client  Accounting.aspx" SetupPath="pages\viewpage.aspx">
        <XslLink>main.xsl</XslLink>
        <Query>
          <Where>
            <Eq>
              <FieldRef Name="ContentType" />
              <Value Type="Computed">Client - Accounting</Value>
            </Eq>
          </Where>
        </Query>
        <ViewFields>...</ViewFields>
        <RowLimit Paged="TRUE">30</RowLimit>
        <Aggregations Value="Off" />
      </View>
      <View DisplayName="CORE Client - Correspondence" BaseViewID="1" Type="HTML" MobileView="TRUE" ImageUrl="/_layouts/images/dlicon.png" XslLink="main.xsl" WebPartZoneID="Main" WebPartOrder="1" Url="Forms/CORE Client  Correspondence.aspx" SetupPath="pages\viewpage.aspx">
        <XslLink>main.xsl</XslLink>
        <Query>
          <GroupBy Collapse="TRUE" GroupLimit="30">
            <FieldRef Name="Client_x0020_Correspondence_x0020_Type" />
          </GroupBy>
          <Where>
            <Eq>
              <FieldRef Name="ContentType" />
              <Value Type="Computed">Client - Correspondence</Value>
            </Eq>
          </Where>
        </Query>
        <ViewFields>...</ViewFields>
        <RowLimit Paged="TRUE">30</RowLimit>
        <Aggregations Value="Off" />
      </View>
      ...
    </Views>
  </MetaData>
</List> 
```

**模块的 Elements.xml**

```
<File Url="ClientDocumentsCorrespondence.aspx" Path="default.aspx" Type="GhostableInLibrary" >
    <Property Name="PublishingPageLayout" Value="~SiteCollection/_catalogs/masterpage/PLClientDocuments.aspx" />
    <Property Name="Title" Value="GASOP Client Documents - Correspondence" />
    <Property Name="ContentType" Value="Welcome Page" />
    <AllUsersWebPart WebPartOrder="0" WebPartZoneID="zone1">...</AllUsersWebPart>
    <AllUsersWebPart WebPartOrder="1" WebPartZoneID="zone1">...</AllUsersWebPart>
    <View List="Client Documents"
        DisplayName=""
        Url=""
        DefaultView="FALSE"
        BaseViewID="1"
        Type="HTML"
        WebPartOrder="0"
        WebPartZoneID="zone2"
        ContentTypeID="0x"
        ID="g_4d8c86ec_b324_4f6a_a2e9_ba1a36466c68"
        Hidden="TRUE">
    <![CDATA[<webParts>
        <webPart xmlns="http://schemas.microsoft.com/WebPart/v3">
            <metaData>
            <type name="Microsoft.SharePoint.WebPartPages.XsltListViewWebPart, Microsoft.SharePoint, Version=14.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" />
            <importErrorMessage>Cannot import this Web Part.</importErrorMessage>
            </metaData>
            <data>
            <properties>...</properties>
            </data>
        </webPart>
    </webParts>]]>
    </View>
</File> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T06:39:35.660

它似乎在`schema.xml`您创建了两个视图，但都具有相同的 BaseViewID。`BaseViewID`对于每个视图，您必须是唯一的。1 是 AllItems 视图（默认视图）的 ID。

参考这篇文章：[http ://social.msdn.microsoft.com/Forums/en-US/sharepointdevelopment/thread/52e45ddd-73a8-400f-890c-323a0eaaeccb](http://social.msdn.microsoft.com/Forums/en-US/sharepointdevelopment/thread/52e45ddd-73a8-400f-890c-323a0eaaeccb)

复制粘贴`default view`并给出 的唯一 ID `BaseViewID`。

### 比你的`Module's Elements.xml`

```
 <View List="Lists/Client Documents" BaseViewID="<<Your View Unique ID>>"  DisplayName="Client Documents" Name="Client Documents" RecurrenceRowset="TRUE" WebPartZoneID="Main" WebPartOrder="0">
      <![CDATA[
          <webParts>
              <webPart xmlns="http://schemas.microsoft.com/WebPart/v3">
                  <metaData>
                      <type name="Microsoft.SharePoint.WebPartPages.XsltListViewWebPart,Microsoft.SharePoint,Version=14.0.0.0,Culture=neutral,PublicKeyToken=71e9bce111e9429c" />
                      <importErrorMessage>Cannot import this Web Part.</importErrorMessage>
                  </metaData>
                  <data>
                      <properties>
                          <property name="Title">Invoice Approved</property>
                          <property name="AllowConnect" type="bool">True</property>
                          <property name="AllowClose" type="bool">False</property>
                      </properties>
                  </data>
              </webPart>
          </webParts>
      ]]>
    </View> 
```

请阅读更多详细信息： http: [//blog.qumsieh.ca/2010/09/01/sharepoint-2010-schema-xml-onet-xml-and-toolbar-type/](http://blog.qumsieh.ca/2010/09/01/sharepoint-2010-schema-xml-onet-xml-and-toolbar-type/)

# c - C - 无法让 shmget/shmat 编译

> ID：15672587
> 
> 赞同：0
> 
> 时间：2013-03-28T01:18:43.930
> 
> 标签：c, shared-memory, minix

我正在拔头发，试图弄清楚为什么这在我的 Minix 系统上不起作用。

当我尝试编译我的 C 程序时，我收到以下错误：

```
#make
       link  pm/pm
program.o: In function `do_function':
program.c:(.text+0x1e): undefined reference to `shmget'
program.c:(.text+0x36): undefined reference to `shmat'
clang: error: linker command failed with exit code 1 (use -v to see invocation)
*** Error code 1

Stop.
make: stopped in /usr/src/servers/pm
# 
```

这是我的代码：

```
#include <sys/shm.h>
#include <sys/types.h>
#include <sys/ipc.h>
#include <sys/stat.h>
/* Some other includes here */

typedef struct {
    //struct elemLi *next;
    //elem sem;
    int ref_count;
} elemLi;

int do_function(void){
    int segment_id; //Shared Memory ID
    struct elemLi* sli; //Shared Memory Pointer
    segment_id = shmget(IPC_PRIVATE, sizeof(elemLi),0660 | IPC_CREAT);
    sli = (struct elemLi *)shmat(segment_id,NULL,0);
    return -1;
} 
```

正如你所看到的，我已经为这些调用包含了正确的头文件，它仍然说引用是未定义的。我能够在另一个程序中成功地使用它，所以我完全不知道为什么它在这种情况下不起作用。

编辑：这是在系统调用中。我认为这没有什么区别。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T03:55:34.303

感谢大家的帮助，看起来它*是*链接器中缺少的库。我将 libc, using `-lc`, 添加到 Makefile 中，现在它似乎可以正常编译了。

# ruby-on-rails - 如何存储一次记录并在其他表中多次引用它？

> ID：15672590
> 
> 赞同：0
> 
> 时间：2013-03-28T01:18:56.747
> 
> 标签：ruby-on-rails, database-design, activerecord, normalization

我有一张配料表。当用户输入一种成分时，它会保存在表格中。现在我注意到许多记录重复，我不希望这样，我想要的是每个记录都被引用（如果它已经存在）。

例如，我在数据库中保存了大约 20 次面粉。我希望它保存一次，对于每个食谱，当用户输入面粉时，它应该只在数据库中引用该成分。我如何实现这一目标？

我已经有一个 Entry 模型（recipe）和一个 join EntryIngredient 模型。因此，每当一个条目保存一个已经存在的成分时，我希望它只引用 EntryIngredient 表中的那个成分（作为外键）而不是创建一个新的成分。

```
class Ingredient < ActiveRecord::Base
  has_many :entry_ingredients
  has_many :entries, :through => :entry_ingredients

end

class EntryIngredient < ActiveRecord::Base
  belongs_to :entry
  belongs_to :ingredient

  accepts_nested_attributes_for :ingredient, :reject_if => lambda { |a| a[:name].blank? }, :allow_destroy => true

end

class Entry < ActiveRecord::Base
  belongs_to :user
  has_many :entry_ingredients
  has_many :ingredients, :through => :entry_ingredients
  has_many :steps

  accepts_nested_attributes_for :entry_ingredients, :allow_destroy => true
  accepts_nested_attributes_for :steps, :reject_if => lambda { |s| s[:description].blank? }, :allow_destroy => true

end 
```

* * *

**更新：**

动态查找器听起来像是他们做我想要的，特别是`find_or_create`或者`first_or_create`但我无法弄清楚如何在我的设置中使用它们。谁能在这里把我推向正确的方向？这是我尝试过的，但我意识到这只是在调用条目#new 时创建一个新成分......不是我想要发生的事情

```
 #entries_controller.rb
  def new
    @entry = Entry.new
    @entry.entry_ingredients.build.build_ingredient
    @entry.steps.build

    @ingredient = Ingredient.where(params[:ingredient]).first_or_create()

    respond_to do |format|
      format.html # new.html.erb
      format.xml  { render :xml => @entry }
    end
  end

#_entry_ingredient_fields.html.erb
<%= f.fields_for :ingredient do |builder| %>
  <%= builder.label :name %>
  <%= builder.text_field :name, :class => "ingredient_field" %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:26:32.827

如果没有看到一些代码，很难确切地知道你需要什么，但如果我理解正确，你只想创建一种成分，前提是它还不存在。

查看 rails 的[动态查找器](http://guides.rubyonrails.org/active_record_querying.html#dynamic-finders)。如果您使用方法名称，例如

```
@ingredient = Ingredient.find_or_create_by_name("flour") 
```

如果之前没有名称为“flour”的条目，它将创建一个新对象，或者返回一个名为“flour”的现有成分。在这两种情况下，@ingredient 都将保存上述语句返回的所需条目。只有当它还不存在时，Rails 才会为您创建它。

# opencv - Mat::clone 和 Mat::copyTo 有什么区别？

> ID：15672600
> 
> 赞同：47
> 
> 时间：2013-03-28T01:21:02.713
> 
> 标签：opencv

我知道“copyTo”可以处理掩码。但是当不需要面具时，我可以同时使用两者吗？

[http://docs.opencv.org/modules/core/doc/basic_structures.html#mat-clone](http://docs.opencv.org/modules/core/doc/basic_structures.html#mat-clone)

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2015-07-06T01:23:25.143

实际上，即使**没有**面具，它们也不相同。

主要区别在于，当目的矩阵和源矩阵的类型和大小相同时，`copyTo`不会改变目的矩阵的地址，而`clone`总是为目的矩阵分配一个新的地址。

`copyTo`当在或之前使用复制赋值运算符复制目标矩阵时，这一点很重要`clone`。例如，

使用`copyTo`：

```
Mat mat1 = Mat::ones(1, 5, CV_32F);
Mat mat2 = mat1;
Mat mat3 = Mat::zeros(1, 5, CV_32F);
mat3.copyTo(mat1);
cout << mat1 << endl;
cout << mat2 << endl; 
```

输出：

```
[0, 0, 0, 0, 0]
[0, 0, 0, 0, 0] 
```

使用`clone`：

```
Mat mat1 = Mat::ones(1, 5, CV_32F);
Mat mat2 = mat1;
Mat mat3 = Mat::zeros(1, 5, CV_32F);
mat1 = mat3.clone();
cout << mat1 << endl;
cout << mat2 << endl; 
```

输出：

```
[0, 0, 0, 0, 0]
[1, 1, 1, 1, 1] 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-03-28T17:19:05.030

这是`Mat::clone()`函数的实现：

```
inline Mat Mat::clone() const
{
  Mat m;
  copyTo(m);
  return m;
} 
```

因此，正如@rotating_image 所提到的，如果您不提供`mask`功能`copyTo()`，则与`clone()`.

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2013-03-28T17:22:05.710

`Mat::copyTo`适用于当您已经有一个目的地`cv::Mat`（可能是或）已经分配了正确的数据大小时。`Mat::clone`当您知道必须分配一个新的`cv::Mat`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-01-21T15:59:35.500

copyTo 不会在更快的堆中分配新内存。

# sql-server - 允许远程访问 vb.net 中的 Sql Server 数据库

> ID：15672601
> 
> 赞同：0
> 
> 时间：2013-03-28T01:21:10.567
> 
> 标签：sql-server, vb.net, tsql, connection, connection-string

我有我`Database.mdf`的位于`C:\Program Files\My Database`。当我在运行时访问它时（使用我的 vb.net 程序）我有一个错误说

> 建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。

我在这里尝试做的事情是允许其他用户在使用不同的计算机时通过 LAN 访问同一个数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-08T02:32:12.683

我现在设法做我想做的事。通过从*SQL Server Configuration Manager*启用**SQL Server Browser**和**TCP/IP**，将**TCP 端口**从它的*Properties*设置为**1433**。在您的**防火墙**中允许**端口 1433的****异常**，然后使用指向您服务器的 Sql 服务器的连接字符串。它将允许其他用户访问您的 SQL 数据库。

 ********像这样：

```
dbConn = New SqlConnection("Data Source=MYSERVER-NAME\SQLEXPRESS;Initial Catalog=myDatabase;User ID=sa;Password=pass") 
```

在研究中，这个页面帮助了很多[ConnectionStrings.com](http://www.connectionstrings.com/sqlconnection/)********

# php - php中的键和值数组访问

> ID：15672602
> 
> 赞同：0
> 
> 时间：2013-03-28T01:21:16.177
> 
> 标签：php, arrays, key

我正在调用一个函数，例如：

```
get(array('id_person' => $person, 'ot' => $ot  )); 
```

在函数中如何访问键和值，因为它们是可变的？

```
function get($where=array()) {

  echo where[0];
  echo where[1];
} 
```

如何在`'id_person' => $person, 'ot' => $ot` 不使用**foreach**的情况下提取，因为我知道函数内部有多少键值对？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:22:48.400

如果您知道它们将始终拥有这些密钥，则可以通过`$where['id_person']`/访问它们。`$where['ot']`

如果你想访问第一个和第二个元素，你可以这样做

```
reset($where)
$first = current($where);
$second = next($where); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T01:24:24.723

几种方式。如果您知道期望什么键，您可以直接寻址`$where['id_person'];`或者您可以将它们提取为局部变量：

```
function get($where=array()) {
   extract($where);
   echo $id_person;
} 
```

如果您不知道会发生什么，只需遍历它们：

```
foreach($where AS $key => $value) {
    echo "I found $key which is $value!";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T01:23:40.950

就像在 JavaScript 中做的一样`$where['id_person']`。`$where['ot']`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-28T01:28:34.253

如果您不关心键并希望将数组用作有序数组，则可以对其进行移位。

```
function get($where=array()) {
$value1 = array_shift($where);
$value2 = array_shift($where);
} 
```

# android - Android Image Cropper的源码在哪里

> ID：15672606
> 
> 赞同：0
> 
> 时间：2013-03-28T01:21:34.307
> 
> 标签：android

我正在尝试自己制作一个 android 图像裁剪器。由于Android中有一个系统图像裁剪器（**com.android.camera.CropImage**），所以我想查看系统图像裁剪器的代码以了解如何实现。

由于图像裁剪器是一个内部 API，所以我从安卓手机下载了 framework.jar，然后用 dex2jar 解压，然后我得到了所有包含内部 API 的 API。

但是解压后文件太多，找不到哪个文件表示cropper。

有人知道怎么找到吗？

提示：com.android.camera.CropImage

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:39:00.630

这可能是您正在寻找的：

[https://github.com/CyanogenMod/android_packages_apps_Gallery/blob/jellybean-stable/src/com/android/camera/CropImage.java](https://github.com/CyanogenMod/android_packages_apps_Gallery/blob/jellybean-stable/src/com/android/camera/CropImage.java)

# android - android 滑动菜单和可扩展列表视图不起作用

> ID：15672607
> 
> 赞同：1
> 
> 时间：2013-03-28T01:21:39.820
> 
> 标签：android, expandablelistview, slidingmenu

---更新如下---

我在[SlidingMenu](https://github.com/jfeinstein10/SlidingMenu)片段中显示[ExpandableListView](http://developer.android.com/reference/android/widget/ExpandableListView.html) (ELV)时遇到问题。片段加载正常，如果我使用 ListView 没有问题。我已经实现了一个自定义适配器来加载组和子项的视图，当 ELV 在正常活动中加载时，一切都按预期工作。

我已经调试了很长时间，并且绘制了实际的 ELV（我将背景设置为全红色，它显示了我期望的位置），但是没有绘制组和子元素。加载带有滑动菜单的活动（如 getGroupView）时，将调用适配器中的所有相关方法。任何人都可以帮助我让实际的组和孩子在 SlidingMenu 中显示吗？

这是我在布局 XML 中的 ELV：

```
<ExpandableListView
    android:id="@+id/trackermenutypes_explist"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:transcriptMode="disabled"
    android:layout_gravity="right"
    android:layout_margin="15dp"
/> 
```

适配器中获取视图的方法：

```
 @Override
    public View getGroupView(int groupPosition, boolean isExpanded, View convertView, ViewGroup parent) {
        if (convertView == null) {
            convertView = mInflater.inflate(R.layout.listitem_typegroup, null);
        }
        ((TextView) convertView.findViewById(R.id.listitem_typegroup_name)).setText(mTypeGroups.get(groupPosition).getName());
        Log.d(TAG, "Returning GroupView for group \"" + mTypeGroups.get(groupPosition).getName() + "\"");
        return convertView;
    }

    @Override
    public View getChildView(int groupPosition, int childPosition, boolean isLastChild, View convertView, ViewGroup parent) {
        if (convertView == null) {
            convertView = mInflater.inflate(R.layout.listitem_type, null);
        }
        ((TextView) convertView.findViewById(R.id.listitem_type_name)).setText(mGroupedTypes.get(groupPosition).get(childPosition).getName());
        Log.d(TAG, "Returning ChildView for type \"" + mGroupedTypes.get(groupPosition).get(childPosition).getName() + "\"");
        return convertView;
    } 
```

我的片段 onActivityCreated 方法（工作 ListView 在底部注释掉）：

```
@Override
public void onActivityCreated(Bundle savedInstanceState) {
    Log.d(TAG, "onActivityCreated");
    super.onActivityCreated(savedInstanceState);
    mContext = (TrackerActivity) getActivity();
    //lTypesList = getListView();
    lExpList = (ExpandableListView)mContext.findViewById(R.id.trackermenutypes_explist);
    mPrefs = PreferenceManager.getDefaultSharedPreferences(mContext);

    mTypeGroupDataSource = new TypeGroupDataSource(mContext);
    mTypeGroupDataSource.open();
    mTypeGroups = mTypeGroupDataSource.getAllTypeGroups();

    mTypeDataSource = new TypeDataSource(mContext);
    mTypeDataSource.open();
    mTypes = mTypeDataSource.getTypesOfClub(DataService.DEFAULT_CLUB_ID);
    mTypes.addAll(mTypeDataSource.getTypesOfClub(mPrefs.getLong(DataService.PREFS_CLUB_ID, -1)));

    TypeAdapter typeAdapter = new TypeAdapter(mContext, mTypeGroups, mTypes);
    lExpList.setAdapter(typeAdapter);

    lExpList.setOnChildClickListener(new OnChildClickListener() {
        @Override
        public boolean onChildClick(ExpandableListView parent, View v, int groupPosition, int childPosition, long id) {
            mContext.updateCurrentType(id);
            mContext.getSlidingMenu().toggle();
            return true;
        }
    });
    Log.d(TAG, "Expanding " + typeAdapter.getGroupCount() + " groups");
    for (int i = 0; i < typeAdapter.getGroupCount(); i++){
        lExpList.expandGroup(i);
    }
    //TODO Implement "Add Type" feature
    /*ArrayAdapter<TypeData> typeAdapter = new ArrayAdapter<TypeData>(mContext, R.layout.listitem_type, R.id.listitem_type_name, mTypes);
    setListAdapter(typeAdapter);

    lTypesList.setOnItemClickListener(new OnItemClickListener() {
        @Override
        public void onItemClick(AdapterView<?> parent, View item, int position, long id) {
            mContext.updateCurrentType(position);
            mContext.getSlidingMenu().toggle();
        }
    });*/
} 
```

---更新---我想出了一种方法来绘制组和项目，方法是使我的片段成为 ListFragment 并改用 setList。这是一种 hack，因为现在 setAdapter 不适用于我的自定义 BaseExpandableListAdapter。当我在实际列表中调用它时（来自 findViewByID），它不会对触摸事件做出反应。所以现在我有一个漂亮的清单，不能用。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T16:09:03.570

在没有“破解”它并使用 ListFragment 的情况下，我似乎找不到任何关于让 ExpandableListView 在 SlidingMenu 中显示的答案 - 这导致无法在片段上使用标准 setAdapter 来设置 ExpandableListAdapter。如果可用的话，也许 ExpandableListFragment 可以解决问题。

对触摸事件没有反应的更新错误是我自己的错 - 我在适配器的 isChildSelectable 方法中返回 false。

# regex - .gitignore 的扩展正则表达式 (ERE)

> ID：15672613
> 
> 赞同：35
> 
> 时间：2013-03-28T01:22:05.103
> 
> 标签：regex, git, gitignore, metacharacters

有没有办法在`.gitignore`文件中使用扩展正则表达式（ERE）？例如，我想`+`在文件中使用重复字符`.gitignore`。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-03-28T07:28:17.193

如[here](https://stackoverflow.com/a/1470664/6309)所示并在“ [this question](https://stackoverflow.com/a/2902126/6309) ”中详细说明，函数[fnmatch()](http://pubs.opengroup.org/onlinepubs/000095399/functions/fnmatch.html)用于解释 glob 模式，这意味着不支持正则表达式。

这是[`gitignore`手册页](http://git-scm.com/docs/gitignore)提到的：

> 否则，`git treats the pattern as a shell glob suitable for consumption by fnmatch(3)`带有`FNM_PATHNAME`标志：模式中的通配符将不匹配`/`路径名中的 a。
> 例如，“ `Documentation/*.html`”匹配“ `Documentation/git.html`”，但不匹配“ `Documentation/ppc/ppc.html`”或“ `tools/perf/Documentation/perf.html`”。

[您可以在这些](https://stackoverflow.com/questions/1247772/is-there-an-equivalent-of-java-util-regex-for-glob-type-patterns) [问题](https://stackoverflow.com/questions/445910/create-regex-from-glob-expression)中看到 glob 模式和正则表达式之间的一些对应关系。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-03-28T02:20:53.820

（`.gitignore`和其他）文件使用文件名 glob，而不是正则表达式。

我非常怀疑你能否说服 git 黑客改变这一点：现在太根深蒂固了，glob 作为文件名匹配器更加熟悉。

# windows - 如何使用变量正确获取当前目录路径？尝试运行病毒扫描程序以从上下文菜单中扫描当前目录

> ID：15672617
> 
> 赞同：-1
> 
> 时间：2013-03-28T01:22:23.510
> 
> 标签：windows, variables, cmd, registry, working-directory

我可以使用该变量`%CD%`运行命令行病毒扫描程序，以像这样从命令提示符扫描当前目录。

```
C:\AVPTool\AVPTool.exe SCAN %CD% /R:KAVSCANLOG.txt 
```

我想从上下文菜单中使用它，只需单击两次即可轻松扫描文件夹。

我修改了注册表并创建了一个名为`Scan with AVPTool`in的键`HKEY_CLASSES_ROOT\Directory\shell`，在该键中我创建了另一个名为的键`command`并将值更改为

```
"cmd.exe /k cd %1 & C:\AVPTool\AVPTool.exe SCAN %CD% /R:KAVSCANLOG.txt" 
```

但这不起作用，因为`%CD%`没有翻译到当前工作目录中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T05:37:17.957

我会尝试

```
"cmd.exe /k cd %1 & C:\AVPTool\AVPTool.exe SCAN "%1" /R:KAVSCANLOG.txt" 
```

由于该行将通过替换 %-variables 来处理**然后**执行，因此 %CD% 将替换为 INVOKING 进程的当前目录，而不是进程运行所在的目录。当前目录仅`cd`在执行后更改，并且到那时，`%CD%`已经安装到命令中 - 就像`cmd.exe`调用时一样。

# json - 获取无法识别的字段“状态”（类 ektron.cms.jdbc.extractors.AssetDataResponse），未使用 Jersey 客户端 API 标记为可忽略错误

> ID：15672619
> 
> 赞同：0
> 
> 时间：2013-03-28T01:22:35.157
> 
> 标签：json, jersey, deserialization

我从 RESTful 服务返回了以下 JSON

```
{
    "Status": "Success",
    "Success": true,
    "Path": "D:\\Work\\Sites\\EKSites\\OnTrek\\privateassets\\0\\155\\156\\ceb3dc64-33ed-4e96-80a2-846120ecd9ee.pdf",
    "Timestamp": "2013-03-27T18:35:23.8997358-04:00"
} 
```

我正在尝试将 JSON 反序列化为这个数据类：

```
package ektron.cms.jdbc.extractors;

@JsonPropertyOrder({ "Status", "Success", "Path", "Timestamp" })
public class AssetDataResponse {

    @JsonProperty("Status")
    private String Status;

    @JsonProperty("Success")
    private Boolean Success;

    @JsonProperty("Path")
    private String Path;

    @JsonProperty("Timestamp")
    private String Timestamp;

    private Map<String, Object> additionalProperties = new HashMap<String, Object>();

    @JsonProperty("Status")
    public String getStatus() {
        return Status;
    }

    @JsonProperty("Status")
    public void setStatus(String Status) {
        this.Status = Status;
    }

    @JsonProperty("Success")
    public Boolean getSuccess() {
        return Success;
    }

    @JsonProperty("Success")
    public void setSuccess(Boolean Success) {
        this.Success = Success;
    }

    @JsonProperty("Path")
    public String getPath() {
        return Path;
    }

    @JsonProperty("Path")
    public void setPath(String Path) {
        this.Path = Path;
    }

    @JsonProperty("Timestamp")
    public String getTimestamp() {
        return Timestamp;
    }

    @JsonProperty("Timestamp")
    public void setTimestamp(String Timestamp) {
        this.Timestamp = Timestamp;
    }

    @Override
    public String toString() {
        return ToStringBuilder.reflectionToString(this);
    }

    @JsonAnyGetter
    public Map<String, Object> getAdditionalProperties() {
        return this.additionalProperties;
    }

    @JsonAnySetter
    public void setAdditionalProperties(String name, Object value) {
        this.additionalProperties.put(name, value);
    }
} 
```

以下是我的客户端代码：

```
package ektron.common.network;
//...
ClientConfig clientConfig = new DefaultClientConfig();

clientConfig.getFeatures().put(JSONConfiguration.FEATURE_POJO_MAPPING, Boolean.TRUE);

clientConfig.getClasses().add(JacksonJsonProvider.class);
client = Client.create(clientConfig);

WebResource webResource = 
    client.resource(
            String.format("http://%s:%d/%s","localhost",7605,"asset"));

String return =             
webResource
    .path("3f7078c4")
    .path("ceb3dc64-33ed-4e96-80a2-846120ecd9ee")
    .accept(MediaType.APPLICATION_JSON)
    .get(String.class); //This piece works and I get my JSON response as 
                        //indicated above 
```

但是，如果我将以上内容更改为：

```
AssetDataResponse resp = 
        webResource
            .path("3f7078c4")
            .path("ceb3dc64-33ed-4e96-80a2-846120ecd9ee")
            .accept(MediaType.APPLICATION_JSON)
            .get(AssetDataResponse.class); 
```

我收到以下错误：

> 无法识别的字段“状态”（类 ektron.cms.jdbc.extractors.AssetDataResponse），未标记为可忽略

我需要在 ClientConfig 上进行任何配置以使反序列化正常工作吗？对此的任何帮助将不胜感激。我是 .NET 开发人员，对 Java 很陌生，对 Jersey 框架不太熟悉。我已经检查了一个类似[问题](https://stackoverflow.com/questions/4486787/jackson-with-json-unrecognized-field-not-marked-as-ignorable)的答案，我的案例与那里列出的案例不同。

客户端罐子

*   annotations-1.3.9.jar
*   asm-3.1.jar
*   codemodel-2.4.1.jar
*   杰克逊注释-2.1.2.jar
*   杰克逊核心2.1.3.jar
*   杰克逊核心asl-1.9.11.jar
*   jackson-databind-2.1.3.jar
*   杰克逊-jaxrs-1.9.2.jar
*   jackson-mapper-asl-1.9.11.jar
*   杰克逊-xc-1.9.2.jar
*   jcommander-1.30.jar
*   jersey-apache-client-1.17.jar
*   jersey-atom-abdera-1.17.jar
*   jersey-client-1.17.jar
*   jersey-core-1.17.jar
*   jersey-guice-1.17.jar
*   jersey-json-1.17.jar
*   jersey-multipart-1.17.jar
*   jersey-server-1.17.jar
*   jersey-servlet-1.17.jar
*   抛弃-1.1.jar
*   jsr311-api-1.1.1.jar
*   验证-api-1.0.0.GA.jar

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T16:47:51.010

我解决了这个问题。问题是我正在从两个版本的杰克逊库中导入类，正如“感知”所指出的那样。我现在可以将最新稳定版本的 Jackson 库与 Jersey 客户端一起使用。

感谢感知您的建议。

这是我的客户端代码现在的样子。

```
import com.fasterxml.jackson.core.JsonParser;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.jaxrs.json.JacksonJsonProvider;
import com.sun.jersey.api.client.Client;
import com.sun.jersey.api.client.WebResource;
import com.sun.jersey.api.client.config.ClientConfig;
import com.sun.jersey.api.client.config.DefaultClientConfig;
import com.sun.jersey.api.json.JSONConfiguration;

...
    /**
 * Wrapper class for a RESTful Service
 */
public class RestServiceWrapper
{

    public ResponseData performRequest(
                List<String> reqArgs,
                ResponseType rType,
                Class<?> dataType
                )
    {
        ResponseData data = new ResponseData();

        for(String arg: nullCheck(reqArgs))
        {
            if(StringUtils.isNotEmpty(arg))
            {
                webResource=webResource.path(arg);
            }
        }
        data.data = webResource
                .accept(MediaType.APPLICATION_JSON) //For now only JSON supported
                .get(AssetDataResponse.class);
        data.rType = ResponseType.JSON;

        return data;
    }

    protected ServiceInfo svcInfo;

    public RestServiceWrapper(ServiceInfo svcInfo) {

        ClientConfig clientConfig = new DefaultClientConfig();
        clientConfig.getFeatures().put(JSONConfiguration.FEATURE_POJO_MAPPING, Boolean.TRUE);
        clientConfig.getClasses().add(JacksonJsonProvider.class);
        client = Client.create(clientConfig);
        this.svcInfo = svcInfo;
        this.webResource = 
                client.resource(
                        String.format("http://%s:%d/%s",svcInfo.Host,svcInfo.Port,svcInfo.EndPoint));
    }

    private static <T> Iterable<T> nullCheck(Iterable<T> iterable) {
        return iterable == null ? Collections.<T>emptyList() : iterable;
    }

    protected Client client;
    protected WebResource webResource;
} 
```

我必须包括以下失败的行，我再次遇到了原始错误

```
clientConfig.getClasses().add(JacksonJsonProvider.class); 
```

从导入的 JacksonJsonProvider

```
//jackson-jaxrs-json-provider-2.1.3.jar
import com.fasterxml.jackson.jaxrs.json.JacksonJsonProvider; 
```

我的罐子现在看起来像。

```
annotations-1.3.9.jar
asm-3.1.jar
codemodel-2.4.1.jar
jackson-annotations-2.1.2.jar
jackson-core-2.1.3.jar
jackson-databind-2.1.3.jar
jackson-jaxrs-json-provider-2.1.3.jar
jcommander-1.30.jar
jersey-apache-client-1.17.jar
jersey-atom-abdera-1.17.jar
jersey-client-1.17.jar
jersey-core-1.17.jar
jersey-guice-1.17.jar
jersey-json-1.17.jar
jersey-multipart-1.17.jar
jersey-server-1.17.jar
jersey-servlet-1.17.jar
jettison-1.1.jar
jsonschema2pojo-core-0.3.5.jar
jsr311-api-1.1.1.jar
validation-api-1.0.0.GA.jar 
```

# textures - D3DXCreateTextureFromFile 只返回一个指针，而不是对我来说任何体面的消息？

> ID：15672620
> 
> 赞同：0
> 
> 时间：2013-03-28T01:22:42.217
> 
> 标签：textures, assert, directx-9

C++ DirectX Visual Studio 2012 的以下代码：

```
 HRESULT result;

    sprite = NULL;
    result = D3DXCreateSprite( gfx.d3dDevice, &sprite );
    assert( !FAILED( result ) );

    gTexture = NULL;
    result = D3DXCreateTextureFromFile( gfx.d3dDevice, _fileName, &gTexture );
    assert( !FAILED( result ) ); 
```

说第一个断言结果是 S_OK，但是当它到达第二个断言时，它只是声明一个指针并给出一个断言失败错误窗口？我不知道它有什么问题，因为它没有给我任何工作！

任何想法我做错了什么？

_filename 是 .jpg -> "图像/场景/区域/背景.jpg"

编辑:: 我发现了问题，但是，我如何才能得到一个可以帮助我更好地解决这个问题的结果？这是一个错误的文件路径......我不明白为什么结果没有给我任何回报？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T01:36:23.250

您可以使用`DXGetErrorString`和`DXGetErrorDescription`函数来获取有关错误的信息。

此外，您不应为此使用断言。这些是在正常情况下可能发生的错误，而不是开发错误。

# php - Laravel - 使用外部请求时POST数据为空

> ID：15672628
> 
> 赞同：6
> 
> 时间：2013-03-28T01:24:04.910
> 
> 标签：php, laravel

我是 laravel 的新手，我正在尝试实现一个简单的 rest api。

我已经实现了控制器，并通过单元测试进行了测试。

我的问题是 POST 请求。

通过测试 Input:json 有数据，通过外部休息客户端它返回 null。

这是单元测试的代码

```
 $newMenu = array(
      'name'=>'Christmas Menu', 
      'description'=>'Christmas Menu',
      'img_url'=>'http://www.example.com',
      'type_id'=>1,
    );
    Request::setMethod('POST'); 
    Input::$json = $newMenu;
    $response = Controller::call('menu@index'); 
```

我究竟做错了什么？

**更新：**

这真的让我发疯

我已经实例化了一个新的 laravel 项目，并且只有以下代码：

路线

```
Route::get('test', 'home@index');
Route::post('test', 'home@index'); 
```

控制器：

```
class Home_Controller extends Base_Controller {

    public $restful = true;
    public function get_index()
    {
        return Response::json(['test'=>'hello world']);
    }
    public function post_index()
    {
        return Response::json(['test'=>Input::all()]);
    }
} 
```

卷曲调用：

```
curl -H "Accept:application/json" -H"Content-type: application/json" -X POST -d '{"title":"world"}' http://localhost/laravel-post/public/test 
```

回复：

```
{"test":[]} 
```

谁能指出我出了什么问题。

这真的阻止了我使用 laravel，我真的很喜欢这个概念。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-04T06:21:48.647

因为您将 JSON 作为 HTTP 正文发布，所以您无法通过**Input::all()**获得它；你应该使用：

```
$postInput = file_get_contents('php://input');
$data = json_decode($postInput, true);

$response = array('test' => $data);
return Response::json($response); 
```

你也可以使用

```
Route::any('test', 'home@index'); 
```

代替

```
Route::get('test', 'home@index');
Route::post('test', 'home@index'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-13T00:11:01.723

如果使用：`Route::post('test', 'XYZController@test');`
发送数据格式：`Content-type : application/json`
例如：`{"data":"foo bar"}`

您可以通过以下方式获取帖子（任何其他：get、put...等）数据：

```
Input::get('data'); 
```

这清楚地写在这里： http: [//laravel.com/docs/requests](http://laravel.com/docs/requests) 。正确`Content-type`很重要！

我不确定您的 CURL 调用是否正确。也许这会有所帮助：[How to POST JSON data with Curl from Terminal/Commandline to Test Spring REST?](https://stackoverflow.com/questions/7172784/how-to-post-json-data-with-curl-from-terminal-commandline-to-test-spring-rest)

我正在使用`Input::get('data')`并且它有效。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-09-06T06:54:38.177

删除标头*Content-type: application/json*如果您将其作为键值对而不是 json 发送

# ruby-on-rails - 将现有 Rails 应用程序部署到 AWS Elastic Beanstalk

> ID：15672636
> 
> 赞同：4
> 
> 时间：2013-03-28T01:24:50.597
> 
> 标签：ruby-on-rails, amazon-web-services, amazon-elastic-beanstalk

我是 Rails 的新手，我正在尝试将现有的 Rails 应用程序部署到 AWS Elastic Beanstalk。但我得到的只是“祝贺页面”（仅供参考：我可以使用“rails server”在“localhost:3000”上运行应用程序）

我按照以下说明进行操作：http: [//docs.aws.amazon.com/elasticbeanstalk/latest/dg/create_deploy_Ruby_rails.html](http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create_deploy_Ruby_rails.html)

任何帮助，将不胜感激。谢谢。

这是我所做的：

```
# cd /var/www/myapp
# bundle update
# bundle install
# git init 
# git add .
# git commit -m "Initial commit"
# eb init
 // .....configuration
 // ..
# eb start
# git add .gitignore && git commit -m "Ignore .elasticbeanstalk from Git"
# git aws.push
# eb status --verbose

Retrieving status of environment "pb03-env".
URL     : pb03-env-biyaffm422.elasticbeanstalk.com
Status  : Ready
Health  : Green
Environment Name:       pb03-env
Environment ID:         e-mpnrf7js5g
Solution Stack:         32bit Amazon Linux running Ruby 1.9.3
Version Label:          git-5d8712738fd03dee0d5e6a8782055089e028f22d-1364429448649
Date Created:           2013-03-27 23:48:49
Date Updated:           2013-03-28 00:14:30
Description:            None

RDS Database: AWSEBRDSDatabase | aazyq.c0pga7irhsn.us-east-1.rds.amazonaws.com:3306
Database Engine:        mysql 5.5.27
Allocated Storage:      5
Instance Class:         db.t1.micro
Multi AZ:               False
Master Username:        ebroot
Creation Time:          2013-03-27 23:53:41
DB Instance Status:     available 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T22:27:57.310

我发现发生了什么事。这是一个“git”问题。

这是以下帖子中指出的类似问题： [部署到 Heroku - 无法摆脱“欢迎使用 Rails”默认页面](https://stackoverflow.com/questions/8323987/deploying-to-heroku-cant-get-rid-of-the-welcome-to-rails-default-page) ，除非它是 Heroku 的。

无论如何，这就是我为解决它所做的：

```
git rm public/index.html
git commit -m "Removed public/index.html"
git aws.push 
```

# iphone - GKTurnBasedMatch 匹配等待直到另一个玩家匹配

> ID：15672638
> 
> 赞同：1
> 
> 时间：2013-03-28T01:25:04.020
> 
> 标签：iphone, ios, objective-c, ipad, game-center

我发现默认的基于回合的匹配过程对用户来说并不直观。即使尚未找到其他玩家，匹配器也会返回匹配，然后本地用户必须轮流参加新游戏，之后他/她必须在游戏屏幕中等待。相反，我宁愿让用户留在交互式屏幕中，在那里他们可以取消他们的匹配请求或等到匹配（然后我决定谁先开始）。有没有办法做到这一点，不是一种解决方法，而是一种强大的方法？

我当前的代码对我的目的没有任何作用，如下所示：

```
-(IBAction)gcMatchPressed:(id)sender
{
    GKMatchRequest *request = [[GKMatchRequest alloc] init];
    request.minPlayers = 2;
    request.maxPlayers = 2;
    request.playerGroup = PLAYERGROUP;

    [GKTurnBasedMatch findMatchForRequest:request withCompletionHandler:^(GKTurnBasedMatch *match, NSError *error) {
        if (match != nil)
        {
            self.gcMatch = match;
            [self performSegueWithIdentifier:@"Multiplayer" sender:self];
        }
    } ];
} 
```

# c# - WCF 3.5、4.0、4.5 比较？

> ID：15672643
> 
> 赞同：7
> 
> 时间：2013-03-28T01:25:56.993
> 
> 标签：c#, wcf

我只是想知道 WCF 只是想知道 WCF 3.5、4.0 和 4.5 之间的区别。

与 WCF 4.0 相比，使用 WCF 4.5 有什么优势吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-28T01:28:35.493

1.  WCF 4.5 中有哪些新功能？让我们从 WCF 配置开始

2.  WCF 4.5 中有哪些新功能？单个 WSDL 文件

3.  WCF 4.5 中有哪些新功能？配置文件中的配置工具提示和智能感知

4.  WCF 4.5 中有哪些新功能？配置验证

5.  WCF 4.5 中有哪些新功能？IIS 中单个端点上的多重身份验证支持

6.  WCF 4.5 中有哪些新功能？IIS 的自动 HTTPS 端点

7.  WCF 4.5 中有哪些新功能？基本HttpsBinding

8.  WCF 4.5 中有哪些新功能？更改了 ASP.NET 兼容模式的默认值

[http://blogs.microsoft.co.il/blogs/idof/archive/2012/01/17/what-s-new-in-wcf-4-5-improved-streaming-in-iis-hosting.aspx](http://blogs.microsoft.co.il/blogs/idof/archive/2012/01/17/what-s-new-in-wcf-4-5-improved-streaming-in-iis-hosting.aspx)

# design-patterns - 规范模式已修改（构造函数中的候选）

> ID：15672644
> 
> 赞同：2
> 
> 时间：2013-03-28T01:25:57.933
> 
> 标签：design-patterns, specification-pattern

我知道设计模式是由设计而不是由特定代码设置的，但有时我会担心我过多地弯曲模式并且不再遵循设计。

例如，规范模式如下所示：

```
 public interface ISpecification<T>
{
    bool IsSatisfiedBy(T candidate);
} 
```

但对我来说，这不是很可读：

```
 _customerAccountIsActive
.And(_hasReachedRentalThreshold)
.And(_customerAccountHasLateFees)
.IsSatisfiedBy(this); 
```

所以我将其更改为在构造函数中传递候选人：

```
public abstract class Specification<TEntity> : ISpecification<TEntity>
{
    protected TEntity _candidate;

    public Specification(TEntity candidate)
    {
        _candidate = candidate;
    }

    public bool IsSatisfied()
    {
        return IsSatisfiedBy(_candidate);
    }
} 
```

我什至重载了布尔运算符，所以我可以写这样的东西：

```
_customerAccountIsActive 
&& _customerAccountHasLateFees
&& _hasReachedRentalThreshold 
```

现在我想从对设计模式更有经验的人那里知道我是否扭曲了太多以及我应该注意哪些风险。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-29T07:54:10.330

您可以在这里找到类似的问题[如何调整规范模式来评估对象的组合？](https://stackoverflow.com/questions/2327511/how-to-adapt-the-specification-pattern-to-evaluate-a-combination-of-objects). 我和你有同样的问题，我能想到有 2 种改编。

我的问题是在一个规范中比较 2 种不同类型的 TEntity 的 2 个对象。

现在，我正在尝试将第二个实体添加到 IsSatisfied(T 候选人)，如下所示： IsSatisfied(T firstCandidate, K secondCandidate)

所以规范将成为规范，但我认为我将失去将规范与规范结合的能力。

到目前为止，我还没有任何关于将第二个候选者添加到规范中的好主意。

我可以想到两种解决方法：

1.  使用参数对象并将此对象用作候选对象：

    ```
    public class ParameterObject<T,K>
    {
      public T FirstObject { get; set; }
      public K SecondObject { get; set; {
    }

    public SomeSpecification: Specification<ParameterObject<Order, Customer>>

    public bool IsSatisfied(ParameterObject candidate)
    {
       // do some check between order and customer candidates.
    } 
    ```

2.  使用构造函数注入：

    ```
    public class OutOfRangeOrderSpeficiation: Specification<Order>
    {
       private ICriteria _criteria;

        public OutOfRangeOrderSpeficiation(ICriteria criteria)
        {
           _criteria = criteria;
        }

        public bool IsSatisfied(Order candidate)
        {
          // comparing between order candidate and _criteria.
          return false;
        }
    } 
    ```

# javascript - javascript，单击按钮时向下滑动div？

> ID：15672647
> 
> 赞同：0
> 
> 时间：2013-03-28T01:26:33.463
> 
> 标签：javascript, html

当用户单击另一个充当关闭按钮的 div 时，我试图让一个 div 使用 javascript 向下滑动大约 200px 的页面。

有人可以告诉我我会怎么做吗？

```
<script>
$('.chat_close').click(function(e){
        $('.chat_box').slideDown();
    });

</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:40:59.723

前段时间有人已经问过同样的问题了。阿维纳什 回复:

```
var minheight = 20;
var maxheight = 100;
var time = 1000;
var timer = null;
var toggled = false;

window.onload = function() {
    var controler = document.getElementById('slide');
    var slider = document.getElementById('slider');
    slider.style.height = minheight + 'px'; //not so imp,just for my example
    controler.onclick = function() {  
        clearInterval(timer);
        var instanceheight = parseInt(slider.style.height);  // Current height
        var init = (new Date()).getTime(); //start time
        var height = (toggled = !toggled) ? maxheight: minheight; //if toggled

        var disp = height - parseInt(slider.style.height);
        timer = setInterval(function() {
            var instance = (new Date()).getTime() - init; //animating time
            if(instance <= time ) { //0 -> time seconds
                var pos = instanceheight + Math.floor(disp * instance / time);
                slider.style.height =  pos + 'px';
            }else {
                slider.style.height = height + 'px'; //safety side ^^
                clearInterval(timer);
            }
        },1);
    };
}; 
```

您可以在此 URL 上看到它：

[http://jsbin.com/azewi5](http://jsbin.com/azewi5)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T01:35:15.330

利用`animate`

另外，使用`.on`

```
<script type="text/javascript">
$('.chat_close').on('click', function(e){
        $('.chat_box').animate({"top": "200px");
    });

</script> 
```

**HTML：**

```
<div class="chat_close">
</div> 
```

# ruby - 使用 heroku pg:transfer 失败

> ID：15672651
> 
> 赞同：3
> 
> 时间：2013-03-28T01:26:53.580
> 
> 标签：ruby, heroku, pg, heroku-postgres

我正在尝试使用 heroku pg:transfer 将我的本地数据库传输到 Heroku。

这是我正在运行的命令

```
heroku pg:transfer -f postgres://<username>:<password>@localhost:5432/<db_name> -t postgres://<app_path>.compute-1.amazonaws.com:5432/<stuff> --app <app_name> --confirm <app_name> 
```

我收到以下错误消息

```
pg_restore: [archiver] did not find magic string in file header
pg_dump: [custom archiver] could not write to output file: Invalid argument
pg_dump: *** aborted because of error 
```

我在 Windows 上使用 Postgres。有谁知道如何解决这一问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-23T19:52:46.463

**导入** PG 备份可用作将数据库转储从其他来源导入 Heroku Postgres 数据库的便捷工具。

使用开源[pg_dump](http://www.postgresql.org/docs/9.1/interactive/backup-dump.html)工具以压缩格式转储本地数据库：

```
$ PGPASSWORD=mypassword pg_dump -Fc --no-acl --no-owner -h localhost -U myuser mydb > mydb.dump 
```

**导入 Heroku Postgres**

为了让 PG Backups 访问和导入您的转储文件，您需要使用 HTTP 可访问的 URL 将其上传到某处。我们建议使用 Amazon S3。

在命令中使用原始文件 URL `pgbackups:restore`：

> 请务必在临时 S3 URL 周围使用单引号，因为它包含与号和其他字符，否则会混淆您的 shell。

# c# - Tomcat7.0.37 Websocket发送0x81 0x00 0x11

> ID：15672654
> 
> 赞同：2
> 
> 时间：2013-03-28T01:27:20.970
> 
> 标签：c#, java, tomcat, websocket

我正在使用[websocket-sharp](https://github.com/sta/websocket-sharp)尝试使用他们的 webchat 示例与 Tomcat7 websocket 交谈。使用浏览器和 apache 网站 ( `http://localhost:8080/examples/websocket/chat.html`) 中包含的 js 聊天 Web 客户端，我可以来回聊天，但是当我尝试使用 C# 时，每当服务器发送消息时尝试抓取 websocket 框架时都会出错。不过，我已经能够从客户端发送消息了。

让我感到困惑的流是：

`0x81 0x00 0x11`

我看过这里：[https](https://datatracker.ietf.org/doc/html/draft-ietf-hybi-thewebsocketprotocol-17#section-5) ://datatracker.ietf.org/doc/html/draft-ietf-hybi-thewebsocketprotocol-17#section-5 ，但我不确定Apache为什么要发送那个字节流。我在 C# 和 tomcat 中都添加了断点，当它向浏览器发送消息时，它会完好无损，但是当它到达 C# 应用程序时，我得到一个三字节字符串。这是另一个：

`0x81 0x00 0x20`

有谁知道为什么会这样？

[还有 this](https://stackoverflow.com/questions/9182350/decode-a-websocket-frame)描述了当长度为 126 和 127 时会发生什么，但是 0x81 是 129 ......所以很困惑。

这是一个错误吗？

# ruby - Ruby 1.9.3：创建新对象时收到 Stack Level Too Deep 错误

> ID：15672667
> 
> 赞同：0
> 
> 时间：2013-03-28T01:28:57.447
> 
> 标签：ruby

我不是 Ruby 方面的专家，但我试图在某些脚本中跟踪问题，但无法联系到这个特定脚本的专家，以了解我们收到此错误的原因。我已经将事情缩小到这个特定的功能，据我所知，第一个 print 语句发生但 end print 语句没有。堆栈级别太深错误仅在此函数完全存在时发生，如下所示：

```
def load_power_ports(io_info)
  return if !io_info
  io_info.each_key do |key|
    print key
    if !@power_controllers[key.to_s.downcase]
      @power_controllers[key.to_s.downcase] = Object.const_get($equipment_table['power_controller'][key.to_s.downcase][0].driver_class_name).new($equipment_table['power_controller'][key.to_s.downcase][0])
    end
  end
  print "end of equipment power block"
rescue Exception => e
  raise e.to_s + "\nUnable to create power controller: " + io_info.to_s
end 
```

打印语句仅用于查看正在传递哪些信息、程序正在执行多远以及正在执行的迭代。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:38:17.100

是直接调用还是间接`driver_class_name`调用的构造函数？`load_power_ports`如果是这样，你最终会得到无限递归，这会让你的堆栈溢出（哦，讽刺的是）。这是我能看到的唯一可能存在该问题的地方。

# jquery - 一个简单的待办事项列表 - 完成项目，向下滑动所有项目

> ID：15672674
> 
> 赞同：0
> 
> 时间：2013-03-28T01:30:12.180
> 
> 标签：jquery, animation

**tl;dr 完成一个项目后，我希望所有项目和下面的列表动画化并取代它。**

这是我的 jsFiddle - [http://jsfiddle.net/mattermill/GRFFD/4/](http://jsfiddle.net/mattermill/GRFFD/4/)

我正在创建一个基本的待办事项列表，以同时让自己熟悉 jQuery 和 Ruby on Rails。现在我只是在处理 jQuery 动画。

目前它由两个列表组成：**不完整的项目**和**完整的项目**。要完成一个项目，您只需单击该项目的文本，它会淡出并将自身附加到已完成的项目列表中。我想让该项目*下方*的所有项目以及已完成的项目列表进行动画处理，以在发生时取代最近完成的项目`fadeOut()`。

不幸的是，我什至不知道从哪里开始。我有一点运气，`nextAll()`但我不认为这是解决这个问题的方法，因为它不适用于已完成的项目列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:34:42.337

碰巧这（几乎）是[`hide`](http://api.jquery.com/hide)动画时的默认行为；只是改变：

```
item.fadeOut(300, function() { 
```

到：

```
item.hide(300, function() { 
```

**[尝试一下。](http://jsfiddle.net/GRFFD/6/)**

不幸的是，这也会为左右填充设置动画，这看起来很糟糕。您可以使用[`animate`](http://api.jquery.com/animate)显式指定要更改的属性：

```
item.animate({height: 0, opacity: 0, paddingTop: 0, paddingBottom: 0}, 300, function() { 
```

这看起来是所有这些中最好的，但它有一个问题：完成后它不会自动删除其属性。如果您希望它们在动画完成后重置，您必须手动执行此操作：

```
item.css({height: '', opacity: '', paddingTop: '', paddingBottom: ''); 
```

**[尝试一下。](http://jsfiddle.net/GRFFD/15/)**

# c++ - 复数简单错误

> ID：15672677
> 
> 赞同：0
> 
> 时间：2013-03-28T01:30:33.700
> 
> 标签：c++, compilation, compiler-errors

嘿伙计们，我是 C++ 新手，每次我编译我的代码时，它总是说我在很多行上有一个 errorc2413，但我显然在那里有一个分号。每当我键入诸如 ex 之类的内容时，通常都会发生这种情况。复杂的。真实的。我想知道你能不能帮帮我？

```
using namespace std;
#include <iostream>

class Complex
{ 
private:
        double real;
      double imaginary;
public:
Complex()
{
    real = 0.0;
    imaginary = 0.0;
}
Complex(double r, double i)
{
    real = r;
    imaginary= i;
}

//Setters
void setReal(double r)
{
    real = r;
}
void setImaginary(double i)
{
    imaginary = i;
}

//Getters
double getReal()
{
    return real;
}// end getReal
double getImaginary()
{
    return imaginary;
}//end of getImaginary()

void output()
{
    cout<< real <<" + i"<< imaginary; 
}

Complex add(Complex a)
{
    Complex result;
    result.real= a.real + real;
    result.imaginary = a.imaginary+imaginary;
    return result;

}
Complex subtract(Complex a)
{
    Complex result;
    Complex.real = (real - a.real);
    Complex.imaginary = (imaginary - a.imaginary);
    return result;
}
Complex mul(Complex a)
{
    Complex result;
    Complex.real = (real*a.real)-(imaginary*a.imaginary);
    Complex.imaginary = (real*a.imaginary)+(imaginary*a.real);
    return result;
}
Complex div(Complex a)
{
    Complex result;
    result.real = 
    ((real*a.real)+(imaginary*a.imaginary))/((a.real*a.real)+(a.imaginary+a.imaginary));
    result.imaginary = 
        ((imaginary*a.real)-(real*a.imaginary))/((a.real*a.real)+(a.imaginary+a.imaginary));
    return result;
}
}//end complex class 
```

> 1>----- 构建开始：项目：复数计算器，配置：调试 Win32 ------ 1> Calculator.cpp 1>c:\users\victor\documents\visual studio 2010\projects\complex数字计算器\复数计算器\calculator.cpp(3)：错误 C2143：语法错误：缺少“;” 在“使用”之前 1>c:\users\victor\documents\visual studio 2010\projects\复数计算器\复数计算器\complex.h(57)：错误 C2143：语法错误：缺少“；” 前 '。' 1>c:\users\victor\documents\visual studio 2010\projects\复数计算器\复数计算器\complex.h(57)：错误C2143：语法错误：缺少';' 前 '。' 1>c:\users\victor\documents\visual studio 2010\projects\复数计算器\复数计算器\complex.h(58)：错误C2143：语法错误：缺少 ';' 前 '。' 1>c:\users\victor\documents\visual studio 2010\projects\复数计算器\复数计算器\complex.h(58)：错误C2143：语法错误：缺少';' 前 '。' 1>c:\users\victor\documents\visual studio 2010\projects\复数计算器\复数计算器\complex.h(64)：错误C2143：语法错误：缺少';' 前 '。' 1>c:\users\victor\documents\visual studio 2010\projects\复数计算器\复数计算器\complex.h(64)：错误C2143：语法错误：缺少';' 前 '。' 1>c:\users\victor\documents\visual studio 2010\projects\复数计算器\复数计算器\complex.h(65): 错误 C2143: 语法错误: 缺少';' 前 '。' 1>c: \users\victor\documents\visual studio 2010\projects\复数计算器\复数计算器\complex.h（65）：错误C2143：语法错误：缺少';' 前 '。' ========== 构建：0 成功，1 失败，0 最新，0 跳过 ==========

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-28T01:34:58.833

所以有几个错误，一个类定义的结尾需要一个`;`. 它看起来也像你在几个地方`Complex`代替了`result`，例如：

```
Complex mul(Complex a)
{
    Complex result;
    Complex.real = (real*a.real)-(imaginary*a.imaginary);
    Complex.imaginary = (real*a.imaginary)+(imaginary*a.real);
    return result;
} 
```

看起来应该是：

```
Complex mul(Complex a)
{
    Complex result;
    result.real = (real*a.real)-(imaginary*a.imaginary);
    result.imaginary = (real*a.imaginary)+(imaginary*a.real);
    return result;
} 
```

一旦我解决了上述问题，它看起来就像编译得很好。该函数`subtract`也有与`mul`. 还建议`const`在您的吸气剂上使用，例如：

```
double getReal() const
{                ^^^^^
    return real;
} 
```

对于您知道永远不应更改任何对象变量的方法，这是一种很好的做法。

# javascript - 骨干路由，backbone.history 启动后的多个路由器

> ID：15672683
> 
> 赞同：1
> 
> 时间：2013-03-28T01:31:49.463
> 
> 标签：javascript, backbone.js, backbone-routing

所以我有点问题。

我的情况是，我需要多个 Backbone.Router 来相应地处理自己的路由等，并且我根据主路由器（以下示例中的路由器 1）对当前路由的了解动态加载它们。

我遇到的主要问题是这样的。

*   Router1 加载
*   Backbone.history.start()
*   Router1 加载 Router2
*   Router2 不做任何事情，因为历史已经开始

有什么可能的方法可以让 router2 查看当前的历史片段，而无需再次调用 router1 中的路由？

IE 不要手动调用 Backbone.history.loadUrl(Backbone.history.getFragment());

编辑：

主要目标是现在我有两个视图，显然每个视图都有一个路由器。考虑到将来可能会有 n 个视图知道每个单独的视图，因此拥有一个巨大的路由器是没有意义的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T10:12:42.283

我建议您尝试查看[MarionetteJS](http://marionettejs.com)，它是使用 Backbone 构建复合应用程序的绝佳框架。[具体看MarionetteJS 示例应用](http://bbclonemail.herokuapp.com/)的源码。它所做的是将应用程序分成几个子应用程序。每个子应用都有自己的路由器，但它们都在父应用上定义了单独的路由器。当父应用初始化时，所有路由器都被创建，然后才被`Backbone.history.start()`调用。我意识到这个答案需要你深入了解 Marionette，它的学习曲线很陡峭，但我认为这完全值得。[我们已经构建了SOOMLA 设计器网络应用程序](http://designer.soom.la/)的整个架构在它的上面。当您想要超越重复的 Backbone 样板代码时，Marionette 已被证明是一个很好的解决方案。感谢Derick [Bailey](https://stackoverflow.com/users/93448/derick-bailey)提供了一个很棒的开源框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T13:12:55.543

您能否提供一个重现您的案例的jsfiddle？因为您通常可以这样做（我个人有一个应用程序实例化路由器，启动历史记录，实例化其他几个，它工作得非常好。）

在此之前，这里有一些关于路由器的信息：
- 当您实例化路由器时，路由绑定到 Backbone.history （一个唯一对象）
- 这意味着您不能期望两个路由器都执行回调
- 它也意味着有一个固定的顺序：将首先检查最后实例化的路由器的路由

**编辑：**
好的，我猜您希望执行两条路线，因为您希望有人直接进入 tab1/stuff。
丑陋的方式：您可以停止 Backbone.history (Backbone.history.stop()) 并在之后立即启动它，router2 的路由将被绑定......
其他可能性：您为什么不将所有路由放在主路由器中？好吧，我想如果你真的有太多，那是可以理解的。
最后一种可能性（我能想到的）：使用最后一个路由器的路由首先测试的事实，这就是您所需要的。更改主路由器的路由，添加一个通用路由来满足您的需要（例如 tab1）。不要做任何事情，向后导航到 /tab1。准备 2 个导航，如下所示：

```
this.navigate('/tab1', {trigger: true});
this.once('someEvent', function() {
    this.navigate('/tab1/stuff', {trigger: true});
}); 
```

如果您有足够通用的 URL，则可以将 tab1 & stuff 替换为您将与通用路由匹配的参数。

**编辑 2：**
好的，这是一个编辑，假设我在上一条评论中写了所有内容，并且您使用主题标签（或 URL）访问您的主干视图，例如视图/操作。我会尽量做到更彻底（因为我仍然没有你问题的所有细节）。

[这个jsfiddle](http://jsfiddle.net/bggxt/)显示了原理。现在，它仍然会与客户的历史记录混淆（我认为在 Backbone 中可能有一种方法可以避免这种情况，如果这对你来说是个问题，你必须调查一下）。

现在，事实上可能还有其他几个问题。其中最少的可能是辅助路由器中的样板（您必须将*view/*放在任何路由之前）。有解决方案，但这太深入了。更大的一个是：
我已经说过了，但是只会匹配一个路由。因此，您的主路由器不能用于处理客户端将更改视图的事实（例如从*view1/action1*到*view2/action2*，router2 之前已经加载）。action2 将被执行，但如果您在主路由器中重新加载视图，则不会执行此操作。
就像最后一条评论一样，您可以在创建主路由器后修改路由器核心初始化方法以添加样板行为（重新加载您的视图？）：这是一个可能适合您[的示例。](http://jsfiddle.net/rU56H/)

# javascript - 我们可以让 JQuery UI Draggables / Sortables 在鼠标右键上工作吗

> ID：15672684
> 
> 赞同：10
> 
> 时间：2013-03-28T01:32:16.027
> 
> 标签：javascript, jquery, jquery-ui

我有一个页面，其功能绑定到鼠标左右键，即。鼠标左键可拖动/可排序，鼠标右键可自定义上下文菜单。

我想要做的是切换功能，以便上下文菜单在鼠标左键单击时起作用，而 JQuery UI Draggable/Sortable 在鼠标右键单击时起作用。

谢谢你的帮助。

PS：我可以使自定义上下文菜单在鼠标左键上工作。所以我只需要 JQuery UI Draggable/Sortable 的帮助。谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-30T17:16:57.193

如果不破解 jQuery UI 代码，实际上是不可能的。

我不知道您为什么要使用此行为，因为可能会使您的最终用户感到困惑，但这是一个可能的解决方案。

从这个 jQuery UI 票[http://bugs.jqueryui.com/ticket/6909](http://bugs.jqueryui.com/ticket/6909)开始，我构建了一个自定义版本的 jQuery UI。所以你必须使用库的修改版本。

我使用以下方法禁用整个页面的浏览器右键单击默认菜单：

```
<body oncontextmenu="return false;"> 
```

或引用特定元素：

```
$("#sortable").bind("contextmenu",function(e){
    return false;
}); 
```

以下是对 jQuery UI 代码的两个主要自定义编辑。

在`ui.mouse`默认选项中添加选项：

> 其中：1

来自 jQuery UI 参考：

> 其中（数字）默认值：1
> 
> 一个与“which”事件属性匹配的数字，以指示按下的鼠标按钮。（0 = 任意按钮，1 = 左按钮，2 = 中按钮，3 = 右按钮）

在函数`_mouseDown`中更改代码以读取此选项：

```
tnIsLeft = (event.which == this.options.which) // instead of this (event.which == 1) 
```

理论上，在未来版本的 jQuery UI 中，这将在没有任何 hack 的情况下得到支持。

这是一个工作小提琴：http: [//jsfiddle.net/IrvinDominin/nLdLu/](http://jsfiddle.net/IrvinDominin/nLdLu/)

## 编辑

以下是带有右键单击 mod 的 pastebin 版本，包括：

> *   包括：jquery.ui.core.js、jquery.ui.widget.js、jquery.ui.mouse.js、jquery.ui.position.js、jquery.ui.draggable.js、jquery.ui.droppable.js、 jquery.ui.resizable.js，jquery.ui.selectable.js，jquery.ui.sortable.js

链接： http: [//pastebin.com/nn3Pj0pM](http://pastebin.com/nn3Pj0pM)

通常，修改后的副本并不是一件好事，您还可以扩展和覆盖让鼠标右键起作用所需的两个功能，但主要问题仍然存在：如果您升级 jQuery UI，您必须检查兼容性或将您的 mod 移植到更新的版本。对于我所看到的 jQuery UI 2.x 将支持该`which`实现。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-04T01:34:51.863

无需创建 jQuery UI 的自定义构建并直接修改文件，您只需扩展可拖动（和可排序，如果需要），以允许鼠标右键单击。jQuery UI 中的所有鼠标交互都由 Mouse Widget ($.ui.mouse) 处理。并且可拖动小部件正在扩展鼠标小部件。所以简而言之，draggable 具有与鼠标相同的方法。如果您覆盖可拖动原型（$.ui.draggable.prototype）上的那些，那么您可以在所有可拖动对象上获得您的功能，而无需修改 jQuery UI 文件。

直接修改 3rd 方框架通常不是一个好主意，因为它会阻止您升级，或者每次升级时都会要求您复制更改。

主要思想是重写一些函数：

```
$.extend($.ui.draggable.prototype, {...}); 
```

这是修改后的可拖动的工作示例：http: [//jsfiddle.net/NjXdv/4/](http://jsfiddle.net/NjXdv/4/) 它需要一个额外的参数：mouseButton。如果您不传递任何内容，它将使用鼠标左键。如果你传入 3，它将使用鼠标右键。您也可以尝试将 2 传递给中间按钮。

PS 这将阻止上下文菜单仅在您关心的元素上打开，而不是在整个页面上禁用它。

**更新：**

如果你想让所有 jQuery UI 控件能够使用不同的鼠标按钮，那么你应该扩展鼠标本身而不是扩展可拖动的。正如我之前所说，每个 jQuery UI 控件都从 $.ui.mouse 读取鼠标事件，所以如果你覆盖它，它将级联到每个控件。这是可排序和可拖动的更新示例：http: [//jsfiddle.net/NjXdv/7/](http://jsfiddle.net/NjXdv/7/)。希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-05T08:16:55.707

来自 JQuery Ui 核心文件

```
$.extend( $.ui, {
    version: "1.8.23",

    keyCode: {
        ALT: 18,
        BACKSPACE: 8,
        CAPS_LOCK: 20,
        COMMA: 188,
        COMMAND: 91,
        COMMAND_LEFT: 91, // COMMAND
        COMMAND_RIGHT: 93,
        CONTROL: 17,
        DELETE: 46,
        DOWN: 40,
        END: 35,
        ENTER: 13,
        ESCAPE: 27,
        HOME: 36,
        INSERT: 45,
        LEFT: 37,
        MENU: 93, // COMMAND_RIGHT
        NUMPAD_ADD: 107,
        NUMPAD_DECIMAL: 110,
        NUMPAD_DIVIDE: 111,
        NUMPAD_ENTER: 108,
        NUMPAD_MULTIPLY: 106,
        NUMPAD_SUBTRACT: 109,
        PAGE_DOWN: 34,
        PAGE_UP: 33,
        PERIOD: 190,
        RIGHT: 39,
        SHIFT: 16,
        SPACE: 32,
        TAB: 9,
        UP: 38,
        WINDOWS: 91 // COMMAND
    }
}); 
```

如果我们交换 LEFT 和 RIGHT 的键码，那么它可能会起作用..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-05T11:35:46.440

试试这个：

```
$('#element').mousedown(function(event) {
    if(event.which == 1) {
        $('#element').draggable();
        $('#element').sortable();
    } else if (event.which == 3) {
        // context menu functions
    }
}); 
```

# python - python: xlrd/csv - xlrd/csv 包将对象读入内存时的空单元处理

> ID：15672686
> 
> 赞同：2
> 
> 时间：2013-03-28T01:32:27.210
> 
> 标签：python, sql, csv, xlrd, string

是否可以选择更改 csv 和 xlrd 包处理空单元格的默认方式？默认情况下，空单元格被分配一个空字符串值 = ''。当使用数据库时，这是有问题的，因为空字符串不是 None 值，许多与数据库接口的 python 包（例如 SQLAlchemy）可以将其作为*Null*处理以供数据库使用。

例如，如果在假定为小数/整数/浮点数/双精度的字段中出现空单元格，则数据库将抛出异常，因为对十进制/整数/浮点类型的字段进行了字符串插入/双倍的。

我还没有找到任何示例或文档来说明我如何做到这一点。我目前的方法是检查数据并执行以下操作：

```
if item[i] == '': 
   item[i] = None 
```

这样做的问题是我不拥有数据并且无法控制其质量。我可以想象这将是一种常见的情况，因为许多应用程序使用的文件/数据是由它们以外的来源生成的。

如果有办法改变默认处理，那么我认为这将是一个明智的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T06:17:44.773

我有和你一样的设置（ORM 的 sqlalchemy，以及我几乎无法控制的数据，通过 excel 文件提供）。我发现我需要先整理 xlrd 中的数据，然后再将其转储到数据库中。我不知道您可以对 xlrd 模块进行任何调整。

更笼统地说：最好尝试获取尽可能多的示例 excel 文件样本，看看您的应用程序是否可以处理它。我发现偶尔会出现奇怪的字符通过 excel（人们从不同语言复制粘贴），这会导致进一步崩溃。还发现在某些情况下文件格式不是 UTF-8 而是 iso-8859 或其他格式。我最终使用 iconv 来转换文件。

您可能还想看看这篇[stackoverflow 文章](https://stackoverflow.com/questions/11603009/how-to-detect-if-a-cell-is-empty-when-reading-excel-files-using-the-xlrd-library)

总体而言，xlrd 为我们工作，但我对围绕该项目的活动印象不深。好像我正在使用一个几乎没有维护的库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-20T19:31:47.513

在实际读取数据之前，您可以使用以下代码将正在读取的工作表中所有空单元格的值更改为 NULL（或 None，或任何您喜欢的）。它遍历所有行和列并检查 cell_type 是否为 EMPTY，然后将相应单元格的值更改为“NULL”。

```
import xlrd

book = xlrd.open_workbook("data.xlsx")
sheet_name = book.sheet_names()[0] #getting the sheetname of the  first sheet
sheet = book.sheet_by_name(sheet_name)

for r in range(0,sheet.nrows): #create a list with all row numbers that contain data and loop through it
    for s in range(0, sheet.ncols):       #create a list with all column numbers that contain data and loop through i
        if sheet.cell_type(r, c) == xlrd.XL_CELL_EMPTY:
            sheet._cell_values[r][c] = 'NULL' 
```

然后您可以读取数据（例如从第一列），如果单元格之前为空，您将获得 NULL 作为值：

```
for r in range(0,sheet.nrows):
    data_column_1 = sheet.cell(r,0).value 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-29T11:30:08.217

`xlrd`会告诉你你有什么类型的单元格（空或空白、文本、数字、日期、错误）。

这在`xlrd`文档中有所介绍。查看 Cell 类，以及 Sheet 类的这些方法：cell_type、col_types 和 row_types。

该`csv`格式无法表达“根本没有数据”和“值是零长度字符串”之间的区别。您仍然需要检查`''`并采取相应措施。

# excel - 抑制数据透视图中的数据透视项目

> ID：15672688
> 
> 赞同：0
> 
> 时间：2013-03-28T01:32:41.153
> 
> 标签：excel, vba

我创建了一个数据透视表，其中列出了给定日期到商店的访客数量。有 3 列数据，日期列和代表访问者的两列数字。当我从这些数据创建图表时，我得到一个数据条，表示构成数据的日期范围之前和之后的日期。我可以使用以下命令抑制在我想要查看的日期之前发生的所有日期：

```
With Worksheets("Pivot Tables").PivotTables("Weekly Statistics").PivotFields("Date")
    .PivotItems.Item(1).Visible = False 
```

但是，我找不到一种方法来抑制今天日期之后发生的日期。这让我的条形图上有一列是空白的，并且轴值“>3/27/2013”​​。我可以通过实际输入这一行来抑制它：

```
 .PivotItems.Item(">3/27/2013").Visible = False 
```

但是每次更新工作表时都必须手动执行此操作很费力，并且使工作表对其他人无法使用。我试图创建一个变量来更新 () 中的值，但我无法让它工作。

```
 Dim t
     t = Worksheets("Data").Range("i3").Value   
     .PivotItems.Item(t).Visible = False 
```

（其中`i3`的一个单元格`Worksheet("Data")`是日期的串联；在这种情况下，单元格内容是`">3/27/2013"`）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T07:02:31.500

您可以尝试使用替代过滤技术：

```
t="3/27/2013"
Worksheets("Pivot Tables").PivotTables("Weekly Statistics").PivotFields("Date").PivotFilters.Add Type:=xlBefore, Value1:=t 
```

但是，它从 Excel 2007 开始使用。

如果不工作尝试开始：

```
 Worksheets("Pivot Tables").PivotTables("Weekly Statistics").PivotFields("Date").ClearAllFilters 
```

# php - WordPress登录表单代码

> ID：15672695
> 
> 赞同：1
> 
> 时间：2013-03-28T01:33:16.497
> 
> 标签：php, wordpress, wordpress-theming, buddypress

我在 WordPress 侧边栏小部件中有以下内容，该小部件用作我的利基的在线社区。现在我可以在用户未登录时显示表单并显示“欢迎来到社区！” 用户注销时的消息——这很棒。但是，登录功能似乎不起作用。我能得到一些帮助吗？

```
<form name="loginform" id="loginform" action="https://domain.org/wp-login.php"        
 method="post">
    <p class="login-username">
        <label for="user_login">Username</label>
        <input type="text" name="log" id="user_login" class="input" value="" 
                        size="20" />
        </p>
    <p class="login-password">
        <label for="user_pass">Password</label>
        <input type="password" name="pwd" id="user_pass" class="input" 
                        value="" size="20" />
    </p>
    <p class="login-submit">
        <input type="submit" name="wp-submit" id="wp-submit" class="button-
                        primary" value="Log In" />
        <input type="hidden" name="redirect_to" 
                       value="https://domain.org/" />
        </p>

    </form>
<?php } else { ?>
               <h4>Welcome to the Community!<h4>
  <?php } ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T01:36:51.363

试试这个...

```
if (!is_user_logged_in()) {
    wp_login_form();
} else {
    echo '<h4>Welcome to the Community!</h4>';
} 
```

您还可以将配置数组传递给`wp_login_form()`查看[http://codex.wordpress.org/Function_Reference/wp_login_form](http://codex.wordpress.org/Function_Reference/wp_login_form)

# ruby - Rails 应用程序中的 Ruby 方法

> ID：15672702
> 
> 赞同：0
> 
> 时间：2013-03-28T01:34:02.850
> 
> 标签：ruby, ruby-on-rails-3

我有一个我创建的方法，它基于作为参数传递的整数进行一些计算。当我将该方法添加到我的视图时，它只输出最后一个变量。

预算.rb（模型）

```
def self.percent_calculate(question)
    reception = question * 0.5
    ceremony = question * 0.03
    clothes = question * 0.1
    flowers = question * 0.1
    entertain = question * 0.1
    photo = question * 0.12
    rings = question * 0.03
    misc = question * 0.02
end 
```

index.html.erb(查看)

```
<%= Budget.percent_calculate(5000.to_i) %> 
```

这个look的输出是：150.0，这是misc变量的计算。

我想一个接一个地分别输出每个变量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T01:38:45.483

ruby 只返回方法的最后一行，除非您`return`在方法中间调用。也就是说，您希望将计算分离为不同的方法并一一调用它们。通过一些元编程，这可以通过以下方式实现

```
CALCULATION_PERCENTAGES = {
  reception: 0.5,
  ceremony: 0.03,
  clothes: 0.1,
  flowers: 0.1,
  entertain: 0.1,
  photo: 0.12,
  rings: 0.03,
  misc: 0.02
}

class << self
  CALCULATION_PERCENTAGES.each do |cp, weight|
    define_method "#{cp}_value" do |question|
      weight * question
    end
  end
end 
```

然后你可以打电话

```
<%= Budget.reception_value 5000 %>
<%= Budget.ceremony_value 5000 %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T01:39:30.500

Ruby 中的每个方法都返回方法中最后一条语句的值，这就是你得到 misc 的原因。

你是说你想输出每个变量。您要么需要单独的方法，要么需要返回某种数组、对象或哈希来压缩您尝试使用的所有数据。例如，这将返回一个哈希：

```
def self.percent_calculate(question)
{:reception => question * 0.5,
  :ceremony => question * 0.03,
  :clothes => question * 0.1,
  :flowers => question * 0.1,
  :entertain => question * 0.1,
  :photo => question * 0.12,
  :rings => question * 0.03,
  :misc => question * 0.02}
end 
```

然后你可以像访问它

```
calculations = percent_calculate(question)
calculations[:reception] 
```

获取接收值。

# jquery - 使用 ajax 回调时，jqueryui 工具提示无法关闭

> ID：15672705
> 
> 赞同：2
> 
> 时间：2013-03-28T01:34:23.753
> 
> 标签：jquery, jquery-ui, jquery-ui-tooltip

我遇到了一个问题，如果您选择多个实例，使用带有 jQ​​ueryUI 工具提示的 ajax 调用会导致工具提示无法关闭。

我在这里演示过，[http://jsfiddle.net/MHptk/11/](http://jsfiddle.net/MHptk/11/)

```
var html = '';
var testbox = $("#testid"); //div element
for (var i=0; i<25; i++) {
html += '<a href="#" title="test!">test!</a><br />';
}

testbox.html(html);

testbox.tooltip(
    {tooltipClass:'preview-tip',
     content: function(callback) {
         $.ajax({url: '/echo/html/',
                 data: {
                     html: 'woop!',
                 },
                 method: 'post',
                 success: function(data) {
                     callback(data);
                 },
         });
     }, 
    }); 
```

在链接上快速滚动鼠标，您会看到工具提示无法关闭。在我的真实示例中，我正在创建一个带有 jquery ajax 调用的表，其中包含多个链接，这些链接本身将发出 ajax 请求。我也尝试使用 open: 来设置内容，但发生了同样的问题。

对于解决方法，我认为我可以在创建表时直接填充标题 attr ，但鉴于数据的高度易变性，这并不合适。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-31T17:03:38.330

您可以通过将以下内容插入工具提示来稍微缓解该问题...

```
close: function( event, ui ) {
    $(".ui-tooltip").hide();
} 
```

虽然 div 应该在关闭时隐藏，但添加此代码会隐藏所有 ui-tooltip div。当一个关闭。我已经在原始消息中引用的小提琴上对此进行了测试，结果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T04:13:12.613

我认为只是大量链接如此紧密加上ajax调用导致了这个问题。如果你把它们分散一点，我看不到同样的问题。那是很多快速连续触发的ajax调用。

我刚刚在你的小提琴中插入了一个`<p>no link</p>`给它更多空间

[新的小提琴链接](http://jsfiddle.net/oumichaelm/MHptk/13/)

# dependencies - 嵌套要求的 requireJS 2.1.5 依赖项乱序

> ID：15672706
> 
> 赞同：2
> 
> 时间：2013-03-28T01:34:24.650
> 
> 标签：dependencies, requirejs

所以这是我的代码流程：

```
main.js --> jquerymobile --> router --> extra --> lib1 --> lib2 
```

在 extra.js 中，加载 lib2 后，我设置了我的模块

```
//extra.js
require( ['lib1'], function () {
        $("#body").append('<p>got lib1</p>');
        require(['lib2'], 
            $("#body").append( '<p>got lib2</p>' );
            window.stuff = true;
            $("#body").append( '<p>set my module</
        });

}); 
```

在我的 router.js 中，我在额外加载后使用我的模块：

```
//router.js
require(['../extra'], function() {
        $("#body").append( '<p>using my module</p>' );
        console.log( window.stuff );
    }); 
```

我希望在 router.js 中使用我的模块之前对其进行设置。但是，这是我得到的顺序：

```
set my router
using my module
got lib1
got lib2
set my module 
```

当然，当我尝试使用我的模块（window.stuff）时，我会变得不确定。

这是此错误的演示：[https ://dl.dropbox.com/u/19311981/demo.zip](https://dl.dropbox.com/u/19311981/demo.zip)

你们能帮我弄清楚我在指定依赖项时做错了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T13:16:38.303

确保在额外返回时加载 lib1 和 lib2 的唯一方法是使用[定义语法](http://requirejs.org/docs/api.html#defdep)并预先将它们声明为依赖项。稍后再做类似于任何其他异步调用。你不知道它什么时候会回来。

```
//extra.js
define(['lib1', 'lib2'], function(lib1, lib2) {
    $("#body").append('<p>got lib1</p>');
    $("#body").append( '<p>got lib2</p>' );
    window.stuff = true;
    $("#body").append( '<p>set my module</
    return something;
}); 
```

您可能还想重新考虑使用全局 window.something 变量作为模块的通信方法。相反，让模块返回一些您可以使用的对象：

```
//router.js
require(['../extra'], function(extra) {
    $("#body").append( '<p>using my module</p>' );
    console.log( extra );
}); 
```

# javascript - 如何在 angularjs 指令中要求控制器

> ID：15672709
> 
> 赞同：88
> 
> 时间：2013-03-28T01:34:29.647
> 
> 标签：javascript, angularjs, angularjs-directive

谁能告诉我如何将一个指令中的控制器包含在另一个 angularJS 指令中。例如我有以下代码

```
var app = angular.module('shop', []).
config(['$routeProvider', function ($routeProvider) {
    $routeProvider.when('/', {
        templateUrl: '/js/partials/home.html'
    })
        .when('/products', {
        controller: 'ProductsController',
        templateUrl: '/js/partials/products.html'
    })
        .when('/products/:productId', {
        controller: 'ProductController',
        templateUrl: '/js/partials/product.html'
    });
}]);

app.directive('mainCtrl', function () {
    return {
        controller: function ($scope) {}
    };
});

app.directive('addProduct', function () {
    return {
        restrict: 'C',
        require: '^mainCtrl',
        link: function (scope, lElement, attrs, mainCtrl) {
            //console.log(cartController);
        }
    };
}); 
```

总而言之，我应该能够访问 addProduct 指令中的控制器，但我不能。有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：189
> 
> 时间：2013-03-28T20:49:24.257

我很幸运并在对该问题的评论中回答了这个问题，但为了完整起见，我发布了一个完整的答案，因此我们可以将此问题标记为“已回答”。

* * *

这取决于你想通过共享控制器来完成什么；您可以共享同一个控制器（尽管有不同的实例），也可以共享同一个控制器实例。

**共享控制器**

通过将相同的方法传递给两个指令，两个指令可以使用相同的控制器，如下所示：

```
app.controller( 'MyCtrl', function ( $scope ) {
  // do stuff...
});

app.directive( 'directiveOne', function () {
  return {
    controller: 'MyCtrl'
  };
});

app.directive( 'directiveTwo', function () {
  return {
    controller: 'MyCtrl'
  };
}); 
```

每个指令都将获得自己的控制器实例，但这允许您在任意数量的组件之间共享逻辑。

**需要控制器**

如果你想共享一个控制器的同一个*实例*，那么你使用`require`.

`require`确保存在另一个指令，然后将其控制器作为参数包含在链接函数中。因此，如果您在一个元素上有两个指令，则您的指令可以*要求*存在另一个指令并获得对其控制器方法的访问权限。一个常见的用例是 require `ngModel`。

`^require`, 添加插入符号后，除了当前元素之外，还会检查指令上方的元素以尝试查找其他指令。这使您可以创建复杂的组件，其中“子组件”可以通过其控制器与父组件进行通信以达到很好的效果。示例可能包括选项卡，其中每个窗格都可以与整个选项卡通信以处理切换；手风琴套装可以确保一次只打开一个；等等

无论哪种情况，您都必须同时使用这两个指令才能使其工作。`require`是组件之间通信的一种方式。

查看指令指南页面了解更多信息：[http ://docs.angularjs.org/guide/directive](http://docs.angularjs.org/guide/directive)

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-04-20T20:39:55.820

Mark Rajcok 在这里有一个很好的 stackoverflow 答案：

[**AngularJS 指令控制器需要父指令控制器？**](https://stackoverflow.com/questions/15622863/angularjs-directive-controllers-requiring-parent-directive-controllers)

带有指向这个非常清晰的 jsFiddle 的链接：http: [//jsfiddle.net/mrajcok/StXFK/](http://jsfiddle.net/mrajcok/StXFK/)

```
<div ng-controller="MyCtrl">
    <div screen>
        <div component>
            <div widget>
                <button ng-click="widgetIt()">Woo Hoo</button>
            </div>
        </div>
    </div>
</div> 
```

JavaScript

```
var myApp = angular.module('myApp',[])

.directive('screen', function() {
    return {
        scope: true,
        controller: function() {
            this.doSomethingScreeny = function() {
                alert("screeny!");
            }
        }
    }
})

.directive('component', function() {
    return {
        scope: true,
        require: '^screen',
        controller: function($scope) {
            this.componentFunction = function() {
                $scope.screenCtrl.doSomethingScreeny();
            }
        },
        link: function(scope, element, attrs, screenCtrl) {
            scope.screenCtrl = screenCtrl
        }
    }
})

.directive('widget', function() {
    return {
        scope: true,
        require: "^component",
        link: function(scope, element, attrs, componentCtrl) {
            scope.widgetIt = function() {
                componentCtrl.componentFunction();
            };
        }
    }
})

//myApp.directive('myDirective', function() {});
//myApp.factory('myService', function() {});

function MyCtrl($scope) {
    $scope.name = 'Superhero';
} 
```

# ios - 如何强制执行 iOS 应用的最低要求？

> ID：15672712
> 
> 赞同：0
> 
> 时间：2013-03-28T01:34:44.910
> 
> 标签：ios

我有一个 iOS 应用程序，它至少需要一台装有 iOS 5 的 iPad。我什至不希望拥有旧设备（因此没有 gamekit）的人甚至能够下载该应用程序——它不会运行。

有没有办法在应用商店中强制执行此操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T01:42:17.303

应用程序支持的最低 iOS 版本`Deployment Target`由其构建目标中的设置决定。将此设置为`5.0`。

要将应用程序限制在 iPad 上，请将其`Devices`设置设置为“iPad”而不是“通用”。

# hadoop - Pig：联合mapreduce的结果时出错

> ID：15672713
> 
> 赞同：3
> 
> 时间：2013-03-28T01:34:47.900
> 
> 标签：hadoop, apache-pig

# 猪脚本

```
base = load 'u.base' as (uid:long, gid:long, pref:double);
sim1 = mapreduce 'mahout-core-0.7-job.jar'
        store base into 'input'
        load 'output' as (gid1:long, gid2:long, sim:double)
        `org.apache.mahout.cf.taste.hadoop.similarity.item.ItemSimilarityJob -i input -o output -s SIMILARITY_EUCLIDEAN_DISTANCE`;
sim2 = foreach sim1 generate gid2 as gid1, gid1 as gid2, sim;
sim3 = union sim1,sim2;
dump sim3; 
```

# 猪产量

```
2013-03-28 09:21:32,564 [main] INFO  org.apache.pig.tools.pigstats.ScriptState - Pig features used in the script: UNION,NATIVE
2013-03-28 09:21:32,676 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MRCompiler - File concatenation threshold: 100 optimistic? false
2013-03-28 09:21:32,699 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MultiQueryOptimizer - MR plan size before optimization: 4
2013-03-28 09:21:32,702 [main] ERROR org.apache.pig.tools.grunt.Grunt - ERROR 2127: Internal Error: Cloning of plan failed for optimization.
Details at logfile: /home/chenwl/logs/pig_1364433685680.log 
```

# 猪原木

```
Pig Stack Trace
---------------
ERROR 2127: Internal Error: Cloning of plan failed for optimization.

org.apache.pig.impl.logicalLayer.FrontendException: ERROR 1066: Unable to open iterator for alias sim3
    at org.apache.pig.PigServer.openIterator(PigServer.java:836)
    at org.apache.pig.tools.grunt.GruntParser.processDump(GruntParser.java:696)
    at org.apache.pig.tools.pigscript.parser.PigScriptParser.parse(PigScriptParser.java:320)
    at org.apache.pig.tools.grunt.GruntParser.loadScript(GruntParser.java:531)
    at org.apache.pig.tools.grunt.GruntParser.processScript(GruntParser.java:480)
    at org.apache.pig.tools.pigscript.parser.PigScriptParser.Script(PigScriptParser.java:804)
    at org.apache.pig.tools.pigscript.parser.PigScriptParser.parse(PigScriptParser.java:449)
    at org.apache.pig.tools.grunt.GruntParser.parseStopOnError(GruntParser.java:194)
    at org.apache.pig.tools.grunt.GruntParser.parseStopOnError(GruntParser.java:170)
    at org.apache.pig.tools.grunt.Grunt.run(Grunt.java:69)
    at org.apache.pig.Main.run(Main.java:538)
    at org.apache.pig.Main.main(Main.java:157)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.hadoop.util.RunJar.main(RunJar.java:156)
Caused by: org.apache.pig.PigException: ERROR 1002: Unable to store alias sim3
    at org.apache.pig.PigServer.storeEx(PigServer.java:935)
    at org.apache.pig.PigServer.store(PigServer.java:898)
    at org.apache.pig.PigServer.openIterator(PigServer.java:811)
    ... 16 more
Caused by: org.apache.pig.impl.plan.optimizer.OptimizerException: ERROR 2127: Internal Error: Cloning of plan failed for optimization.
    at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MultiQueryOptimizer.mergeDiamondMROper(MultiQueryOptimizer.java:304)
    at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MultiQueryOptimizer.visitMROp(MultiQueryOptimizer.java:219)
    at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceOper.visit(MapReduceOper.java:273)
    at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceOper.visit(MapReduceOper.java:46)
    at org.apache.pig.impl.plan.ReverseDependencyOrderWalker.walk(ReverseDependencyOrderWalker.java:71)
    at org.apache.pig.impl.plan.PlanVisitor.visit(PlanVisitor.java:46)
    at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MultiQueryOptimizer.visit(MultiQueryOptimizer.java:94)
    at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher.compile(MapReduceLauncher.java:617)
    at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher.launchPig(MapReduceLauncher.java:146)
    at org.apache.pig.PigServer.launchPlan(PigServer.java:1264)
    at org.apache.pig.PigServer.executeCompiledLogicalPlan(PigServer.java:1249)
    at org.apache.pig.PigServer.storeEx(PigServer.java:931)
    ... 18 more
Caused by: java.lang.CloneNotSupportedException: Unable to find clone for op 1-36: Native('hadoop jar mahout-core-0.7-job.jar org.apache.mahout.cf.taste.hadoop.similarity.item.ItemSimilarityJob -i input -o output -s SIMILARITY_EUCLIDEAN_DISTANCE ') - scope-12
    at org.apache.pig.backend.hadoop.executionengine.physicalLayer.plans.PhysicalPlan.clone(PhysicalPlan.java:273)
    at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MultiQueryOptimizer.mergeDiamondMROper(MultiQueryOptimizer.java:298)
    ... 29 more
================================================================================ 
```

# 环境

*   操作系统：ubuntu 12.04
*   Hadoop：1.0.4 Subversion [https://svn.apache.org/repos/asf/hadoop/common/branches/branch-1.0](https://svn.apache.org/repos/asf/hadoop/common/branches/branch-1.0) -r 1393290
*   猪：0.11.0 (r1446324)

PS：

如果 sim1 是从 hdfs 加载的，它可以工作，例如`sim1 = load 'sim' as (gid1:long, gid2:long, sim:double)`.

# python - pyopengl - 动态更新顶点缓冲区对象中的值

> ID：15672720
> 
> 赞同：3
> 
> 时间：2013-03-28T01:35:51.337
> 
> 标签：python, opengl, numpy, pyopengl, vertex-buffer

我想在`PyOpenGL`. 阅读了一下，VBO 似乎是实现这一目标的明智方法。

以前从未使用过 VBO，我无法弄清楚如何动态更新它们 - 理想情况下，我只想修改`numpy`顶点数组的元素，然后仅将更改的元素传播到 GPU。我曾假设`OpenGL.arrays.vbo.VBO`包装器使用它的`copy_data()`方法自动执行此操作，但似乎不是。

这是一个愚蠢的例子：

```
from OpenGL import GL as gl
from OpenGL import GLUT as glut
from OpenGL.arrays import vbo
import numpy as np

class VBOJiggle(object):

    def __init__(self,nvert=100,jiggliness=0.01):
        self.nvert = nvert
        self.jiggliness = jiggliness

        verts = 2*np.random.rand(nvert,2) - 1
        self.verts = np.require(verts,np.float32,'F')
        self.vbo = vbo.VBO(self.verts)

    def draw(self):

        gl.glClearColor(0,0,0,0)
        gl.glClear(gl.GL_COLOR_BUFFER_BIT)

        gl.glEnableClientState(gl.GL_VERTEX_ARRAY)

        self.vbo.bind()

        gl.glVertexPointer(2,gl.GL_FLOAT,0,self.vbo)
        gl.glColor(0,1,0,1)
        gl.glDrawArrays(gl.GL_LINE_LOOP,0,self.vbo.data.shape[0])

        gl.glDisableClientState(gl.GL_VERTEX_ARRAY)

        self.vbo.unbind()

        self.jiggle()

        glut.glutSwapBuffers()

    def jiggle(self):

        # jiggle half of the vertices around randomly
        delta = (np.random.rand(self.nvert//2,2) - 0.5)*self.jiggliness
        self.verts[:self.nvert:2] += delta

        # the data attribute of the vbo is the same as the numpy array
        # of vertices
        assert self.verts is self.vbo.data

        # # Approach 1:
        # # it seems like this ought to work, but it doesn't - all the
        # # vertices remain static even though the vbo's data gets updated
        # self.vbo.copy_data()

        # Approach 2:
        # this works, but it seems unnecessary to copy the whole array
        # up to the GPU, particularly if the array is large and I have
        # modified only a small subset of vertices
        self.vbo.set_array(self.verts)

if __name__ == '__main__':
    glut.glutInit()
    glut.glutInitDisplayMode( glut.GLUT_DOUBLE | glut.GLUT_RGB )
    glut.glutInitWindowSize( 250, 250 )
    glut.glutInitWindowPosition( 100, 100 )
    glut.glutCreateWindow( None )

    demo = VBOJiggle()
    glut.glutDisplayFunc( demo.draw )
    glut.glutIdleFunc( demo.draw )

    glut.glutMainLoop() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2019-03-17T17:22:46.020

要完全回答这个问题，我不得不先提一下OpenGL缓冲区更新。

OpenGL 指令[`glBufferData`](https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glBufferData.xhtml)创建并初始化缓冲区对象的数据存储。缓冲区对象的现有数据存储被完全破坏，并创建一个新的数据存储（可能具有不同的大小）。如果将数据指针传递给函数，则数据存储完全由数据初始化。假设缓冲区的大小和提供的数据的大小相等。

[`glBufferSubData`](https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glBufferSubData.xhtml)更新现有数据存储的整个数据或数据子集。假设数据存储是之前创建的，由`glBufferData`. 没有数据存储被破坏或创建。

当然，从技术上讲`glBufferData`，总是可以使用而不是`glBufferSubData`，但`glBufferSubData`性能会更好，因为消除了昂贵的缓冲区创建（分配）。

使用

> ```
> self.vbo.set_array(self.verts) 
> ```

是个坏主意，因为从实现（[*PyOpenGL/OpenGL/arrays/vbo.py*](https://github.com/Distrotech/PyOpenGL/blob/master/OpenGL/arrays/vbo.py)）中可以看出，此方法创建一个全新的缓冲区，可能具有新的大小，并将强制重新创建缓冲区对象的数据存储（因为`self.copied = False`）。

如果缓冲区是之前创建的，那么`self.vbo.copy_data()`将更新数据`glBufferSubData`（参见`if self.copied:`参考资料`copy_data`）。为了使这项工作，缓冲区必须是当前绑定的缓冲区（`self.vbo.bind()`）。此外，必须设置复制信息 ( `VBO.copy_segments`)。复制信息由项目设置者 ( `VBO.__setitem__`) 声明。

这意味着，在“方法 1”中，您必须执行以下操作：

```
self.vbo[:] = self.verts
self.vbo.bind()
self.vbo.copy_data() 
```

由于[`OpenGL.arrays.vbo`](http://pyopengl.sourceforge.net/documentation/pydoc/OpenGL.arrays.vbo.html)它只不过是 OpenGL 缓冲区指令的包装器，因此我更愿意`glBufferSubData`直接使用，这样在以下情况下性能最佳：

```
# Approach 3:
# Direct buffer update by `glBufferSubData`
self.vbo.bind()
self.vbo.implementation.glBufferSubData(self.vbo.target, 0, self.vbo.data) 
```

使用这种方法，甚至可以更新数据存储的子集。请注意，第二个参数`glBufferSubData`是缓冲区对象数据存储的字节偏移量。此外还有一个重载实现，它可以处理缓冲区大小和直接数据指针。

# javascript - 围绕 js-only 组件创建 asp.net ajax 控件是否比通过 jquery 执行 ajax 更好？

> ID：15672721
> 
> 赞同：0
> 
> 时间：2013-03-28T01:35:54.460
> 
> 标签：javascript, jquery, asp.net, ajax

围绕组件创建 asp.net 客户端控件并让它处理与服务器通信、查询数据、保存数据或使用 jquery 查询服务器（并处理响应）更好吗？

我是 asp.net 的新手，不确定要获得与完全基于 javascript 的解决方案类似的结果所需的工作量。

组件是 100% javascript，经常向服务器询问数据（每 0.5-2 秒），让用户做一些更改，稍后由服务器保存，组件作为 asp.net 站点的一部分托管。组件查询仅针对几种类型的数据/每个查询最多 4-5 个参数，查询的顺序无关紧要。保存数据的情况类似。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T02:16:24.757

我认为您应该创建一些原型来处理您需要的所有功能。这当然更好，因为当你想创建一个新请求时，你将只使用你的原型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T04:15:00.397

是的，最好创建一个 ASP.NET 复合控件并实现 IScriptcontrol 接口。

然后定义您的 JavaScript 原型并将其用于所有客户端操作。这两个链接通过解释如何做到这一点给出了公平的解释。基本上你想要的已经得到 MS 的支持，并且大多数 ASP.NET 的第三方控件都是以这种方式构建的。

[将客户端功能添加到 Web 服务器控件](http://msdn.microsoft.com/en-us/library/bb386450%28v=vs.90%29.aspx)

[使用 ASP.NET AJAX 扩展将客户端功能添加到 Web 服务器控件](http://www.myjotter.com/ajax/tutorials/IScriptControlTutorial1.aspx)

# c# - Selenium 提交按钮单击 1 分钟后服务器没有响应

> ID：15672723
> 
> 赞同：1
> 
> 时间：2013-03-28T01:36:02.490
> 
> 标签：c#, selenium, selenium-webdriver, selenium-chromedriver

我有一个填写表格（使用最新的 ChromeDriver）并单击提交按钮的硒测试。然后，此按钮会进行一些计算，最多可能需要 5 分钟（它实际上会在后端生成一个 SSRS 报告，但这不应该有任何区别）

1分钟后它失败了：

```
No response from server for url http://localhost:53596/session/985300748128c44714abaf1690b52414/element/:wdc:1364433458070/submit 
```

我相信 IWebElement.Submit() 和 .Click() 会阻塞，直到页面被更改（我真的不希望发生这种情况，我宁愿做我自己的等待代码，但我看不到如何在没有等待的情况下单击按钮？）。如果我不能关闭它，我可以延长超时时间吗？我尝试将 ImplicitylyWait 超时设置为 2000 秒，但这没有任何区别。

有谁能告诉我这个 1 分钟超时的定义在哪里以及如何将其关闭？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T04:45:24.200

阅读有关显式和隐式等待[Webdriver 文档](http://docs.seleniumhq.org/docs/04_webdriver_advanced.jsp#explicit-and-implicit-waits-reference)。

在您的情况下，您可能希望使用 WebDriverWait 使用显式等待。

# google-drive-api - 列表请求期间出现 500 错误

> ID：15672724
> 
> 赞同：1
> 
> 时间：2013-03-28T01:36:20.927
> 
> 标签：google-drive-api

尝试执行时开始出现 500 错误`gapi.client.drive.files.list`，即使使用 API exprorer。

授权工作正常。

要求：

```
GET https://www.googleapis.com/drive/v2/files?key={YOUR_API_KEY}

Authorization:  Bearer ZZZZZZZZZZZZZ
X-JavaScript-User-Agent:  Google APIs Explorer 
```

回复：

```
500 Internal Server Error

cache-control:  private, max-age=0
content-encoding:  gzip
content-length:  66
content-type:  application/json; charset=UTF-8
date:  Thu, 28 Mar 2013 01:24:28 GMT
expires:  Thu, 28 Mar 2013 01:24:28 GMT
server:  GSE

{
 "error": {
  "code": 500,
  "message": null
 }
} 
```

昨天还在工作。

**更新**

显然，如果我将结果集限制为**19**（无查询字符串）或**13**（*q: 'root' in parents*） ，它会起作用

我猜谷歌开发者昨天引入了某种限制？或者我可能有一个无效的文件条目开始破坏谷歌服务器？

我该如何调查？

谢谢！

# css - 从 Windows 更改为 Ubuntu 时，Rails Application.css 为空

> ID：15672727
> 
> 赞同：0
> 
> 时间：2013-03-28T01:36:47.933
> 
> 标签：css, ruby-on-rails, windows-7, ubuntu-12.04

我正在尝试将我的 Rails 代码从 Windows 切换到 Ubuntu，并且 css 文件已停止工作。这是相同版本的代码和相同版本的rails。我能想到的唯一主要区别是 Ruby 版本更高，但我不明白为什么这只会影响 css。

如果我查看 Windows 中的 html 源代码，在 application.css 下，我可以看到加载的不同元素一个接一个。一切正常。但是，完全相同的代码在 Ubuntu 上不包含任何内容 - 只是 application.css 文件，带有 require self 和 require 树。

Firefox 控制台或我正在运行 rails 的终端上没有任何错误。

我猜这与我所做的配置或某些资源不可用有关，但没有任何错误，我不知道从哪里开始寻找。这是 Ubuntu 与 Windows 的对比吗？

如何让 css 再次工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T01:41:18.787

您可以尝试从服务器中清除资产缓存：

```
rake assets::clean 
```

尝试也运行 dos2unix 或其他东西 - 也许从 windows 的回车在 ubuntu 上是邪恶的？

```
find . -name -exec dos2unix {} \; 
```

# php - PHP - get_file_contents 不能作为数组工作？

> ID：15672729
> 
> 赞同：0
> 
> 时间：2013-03-28T01:36:58.417
> 
> 标签：php, arrays, string, file-get-contents, array-splice

我正在使用`$file_contents = file_get_contents($file_name)`然后使用`$file_contents = array_splice($file_contents, 30, 7, 'changedText')`来更新文件代码中的某些内容。然而，这不断导致：

```
Warning: array_splice(): The first argument should be an array 
```

据我了解， file_get_contents() 返回的字符串应该能够像任何其他数组一样被处理。有什么理由让我遇到麻烦吗？非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-28T01:38:06.183

从[手册](http://us3.php.net/manual/en/function.file-get-contents.php)：

> file_get_contents — 将整个文件读入字符串

所以你没有数组。你有一个字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T01:42:16.717

阅读[文档](http://php.net/manual/en/function.file-get-contents.php)。

即使字符串支持使用方括号，它也不是数组：

```
$str[0] 
```

将[str_split](http://php.net/manual/en/function.str-split.php)函数用于您想要的行为。它会将您的字符串转换为真正的数组，然后您可以将其用作`array_splice`函数中的参数。例如：

```
echo('<pre>');
var_dump(array_slice(str_split("Stack Overflow"), 6));
echo('</pre>');
die(); 
```

我认为它有帮助。

# java - 引发两个单独的 FileNotFoundExceptions Java 的问题

> ID：15672730
> 
> 赞同：3
> 
> 时间：2013-03-28T01:37:00.617
> 
> 标签：java

我需要两个单独的异常，一个在 .pro 文件丢失时抛出，另一个在丢失的文件是 .cmd 时抛出，如果其中任何一个丢失，当前设置都会抛出两个异常。我在这里做错了什么？

```
import java.io.File;
import java.io.FileNotFoundException;
import java.util.ArrayList;
import java.util.Scanner;

import javax.xml.ws.Holder;

public class Inventory {

    static String FileSeparator = System.getProperty("file.separator");

    public static void main(String[] args) {
        String path = args[0];
        String name = args[1];
        ArrayList<Holder> because = new ArrayList<Holder>();

        try {
            File product = new File(path + name + ".pro");
            Scanner scan = new Scanner(product);
            while (scan.hasNext()) {
                System.out.print(scan.next());
            }
            scan.close();
        } catch (FileNotFoundException e) {
            System.out.println("Usage: java Inventory <path> <filename>");
            System.out.println("The products file \"" + name + ".pro\" does not exist.");
        }

        try {
            File command = new File(path + name + ".cmd");
            Scanner scan = new Scanner(command);

            while (scan.hasNext()) {
                System.out.println(scan.next());
            }
        } catch (FileNotFoundException f) {
            System.out.println("Usage: java Inventory <path> <filename>");
            System.out.println("The commands file \"" + name + ".cmd\" does not exist.");
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T01:47:21.910

尝试像这样重构：

```
 File product = new File(path + name + ".pro");
        if (!product.exists()) {
            System.out.println("Usage: java Inventory <path> <filename>");
            System.out.println("The products file \"" + name + ".pro\" does not exist.");
            return;
        }

        File command = new File(path + name + ".cmd");
        if (!command.exists()) {
            System.out.println("Usage: java Inventory <path> <filename>");
            System.out.println("The commands file \"" + name + ".cmd\" does not exist.");
            return;
        }
        try {
            Scanner scan = new Scanner(product);
            while (scan.hasNext()) {
                System.out.print(scan.next());
            }
            scan.close();

            scan = new Scanner(command);
            while (scan.hasNext()) {
                System.out.println(scan.next());
            }
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T01:53:32.247

如果我将 File 对象更改为以下内容，则对我有用：

```
File product = new File(path, name + ".pro"); 
```

# python - 将 16 位灰度转换为 QImage

> ID：15672743
> 
> 赞同：4
> 
> 时间：2013-03-28T01:38:59.380
> 
> 标签：python, numpy, pyqt4, qimage, qpixmap

我正在开发基于 PyQt4 GUI 的基于传感器的 Python 应用程序。传感器正在生成 16 位测量值……每条“线”有 256 个 16 位“像素”。通过获得 256 行来获取一个正方形的“图像”，从而得到一个 (256,256) 个 16 位数字的 Numpy 数组。我只是想将其显示为灰度图像。传感器循环在 QThread 中运行并发出 QImage 信号。该信号连接到一个插槽，该插槽通过将数据打包成 32 位 RGB 图像来呈现主 GUI 中的数据。当然，要将 16 位灰度像素打包成 32 位 RGB 图像，我不得不将 16 位像素缩放为 8 位，并且会丢失大量动态范围。提供了一个 MWE，显示了我当前的策略（这显然不是我基于传感器的大型线程应用程序......它只是提取了显着部分）。

```
#!/usr/bin/python
# -*- coding: utf-8 -*-

"""
Grayscale to RGB32 QPixmap tests
"""

import sys
import numpy as np
from PyQt4 import QtGui, QtCore

class PixmapTest(QtGui.QWidget):

    def __init__(self):
        super(PixmapTest, self).__init__()
        self.initUI()

    def initUI(self):      
        imglayout = QtGui.QHBoxLayout(self)

        img_16bit = np.random.randint(0,65535,size=(256,256)).astype(np.uint32)
        img_16bit_to_8bit = (img_16bit / 65535.0 * 255).astype(np.uint32)
        packed_img_array = (255 << 24 | (img_16bit_to_8bit) << 16 | (img_16bit_to_8bit) << 8 | (img_16bit_to_8bit)).flatten()
        img = QtGui.QImage(packed_img_array, 256, 256, QtGui.QImage.Format_RGB32)
        pixmap = QtGui.QPixmap(img.scaledToWidth(img.width()*2))

        imglabel = QtGui.QLabel(self)
        imglabel.setPixmap(pixmap)

        imglayout.addWidget(imglabel)
        self.setLayout(imglayout)

        self.move(300, 200)
        self.setWindowTitle('QPixmap Test')
        self.show()        

def main():

    app = QtGui.QApplication(sys.argv)
    form = PixmapTest()
    sys.exit(app.exec_())

if __name__ == '__main__':
    main() 
```

具体来说，我的问题是：

1.  有没有更好的办法？解决方案必须保持“轻量级”（即 PyQt4 QImage/QPixmap）。我不能使用 Matplotlib 或任何重量级的东西，因为它太慢了。越接近原生 Python/Numpy 越好。我意识到这最终是 QImage 类的一个限制，但我希望有一个聪明的解决方案，我只是没有看到，让我保持我拥有的当前信号/插槽“接线”。

2.  通过实验，我发现我必须将最终得到处理的所有数组声明为最终在 QImage 中作为 np.uint32 （尽管 np.int32 似乎也可以工作）。如果我只是将倒数第二个数组声明为 uint32/int32，则它不起作用。我不明白为什么。

3.  我玩过改变亮度`Y' = 0.2126 * R + 0.7152 * G + 0.0722 * B`和其他类似的转换。可能在这里“抛光粪便”，但我想我会包括这个，因为 SX 上的其他答案似乎表明这很重要。尽管动态范围有所损失，但似乎可以像在我的 MWE 中那样简单地为 R、G、B 分配相同的值。

根据下面评论中的要求，这里是来自传感器的一些样本数据的直方图，用于说明动态范围：

![实际传感器数据的直方图](../Images/b4c2c45a952747276837c4071535b368.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T03:56:55.590

这里我使用一些函数数据进行演示：

```
y, x = np.mgrid[-10:10:256j, -10:10:256j]
data = ((np.sin(y**2 + x**2) + 2) * 1000).astype(np.uint16)

img_8bit = (data / 256.0).astype(np.uint8) # use the high 8bit
img_8bit = ((data - data.min()) / (data.ptp() / 255.0)).astype(np.uint8) # map the data range to 0 - 255
img = QtGui.QImage(img_8bit.repeat(4), 256, 256, QtGui.QImage.Format_RGB32) 
```

当使用高 8bit 时，它看起来像：

![在此处输入图像描述](../Images/8a4221f27a10a6adbcdd26351b082cd2.png)

当将最小值和最大值映射到 (0, 255) 时，它看起来像：

![在此处输入图像描述](../Images/17b00ad15d7f6adc6b0171281ad9578c.png)

要将 8 位图像转换为 32 位，只需调用`img_8bit.repeat(4)`，这将每个字节重复 4 次，因此可以将内存视为 uint32 缓冲区。由于您创建`QImage`by `Format_RGB32`not `Format_ARGB32`，因此不使用最高有效字节。

# c++ - std::copy 将指针设置为空

> ID：15672748
> 
> 赞同：0
> 
> 时间：2013-03-28T01:39:40.103
> 
> 标签：c++, copy, std

我正在编写一些代码，并且我有一点要获取一些二进制数据，然后想从中提取一些字节。所以，我有以下内容：

```
unsigned char * payload;
int payload_size;
uint32_t major = 0, minor = 0;
payload = out_resp.get_payload(&payload_size); // Retrieve the data, return a pointer
if(payload_size >= 8) { // Need at least 8 bytes in the payload
    std::copy(payload, payload + 4, &major);
    std::copy(payload + 4, payload + 8, &minor);
} 
```

如您所见，有效载荷的前四个字节应放在 中`major`，接下来的四个字节应放在`minor`. 但是，在进行调试时，我注意到在第一个之后`std::copy`，我的变量`payload`设置为`NULL`!

这是预期的行为`std::copy`，还是出了什么问题？我是否应该通过简单地创建另一个指针并将其传递给来避免这种情况`std::copy`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T01:50:32.220

`std::copy`不像`memcpy`。您的`std::copy(payload, payload + 4, &major);`遗嘱副本：

```
(&major)[0] = payload[0];
(&major)[1] = payload[1];
(&major)[2] = payload[2];
(&major)[3] = payload[3]; 
```

这不是你需要的。`(&major)[1]`超出范围，因此分配给它会导致未定义的行为。

# objective-c - 如何在 Objective-C 中获取自 1972 年以来的时间

> ID：15672750
> 
> 赞同：0
> 
> 时间：2013-03-28T01:39:54.610
> 
> 标签：objective-c

我知道在 python 中，你可以得到自 1972 年或附近某个时间以来的毫秒数。我想知道 Objective-C 中是否有类似的功能，或者我是否需要做一些计算来计算它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-28T01:43:27.950

嗯，有`[[NSDate date] timeIntervalSince1970]`，它给出了自 1970 年 1 月 1 日午夜以来的时间（以秒为单位）。

`[NSDate date]`返回当前时间；您可以获得相对于您拥有`NSDate`对象的任何时间的秒数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T01:49:50.763

从它的声音来看，您并不关心特定的开始日期，只关心您可以从中获得毫秒数的经过时间数。`CFAbsoluteTimeGetCurrent()`将为您提供当前系统时间的双精度值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T01:50:11.873

如果它不必是Objective-C：

```
long timeSinceEpoch = time(NULL); 
```

# c - Linux termios 修改串口 read() 后的第一个字符

> ID：15672751
> 
> 赞同：6
> 
> 时间：2013-03-28T01:40:02.557
> 
> 标签：c, linux, serial-port, termios

我的 termios 设置正在修改使用 read() 从串行端口读取的第一个字符。我有一个微控制器与一个 linux 盒子交谈。微控制器响应从 linux 机器发送的命令。设置如下：

*   微控制器（PIC24F）RS485 端口 <--> RS485 到 USB 转换器 <--> Ubuntu PC。

当我运行诸如 Cutecom 之类的终端程序时，一切都按计划进行。我向 PIC 发送了一个命令字符，然后我得到了响应，但是当我使用我的命令行程序时，第一个字符正在被修改。这是我的代码：

```
#include <string.h>
#include <stdlib.h>
#include <stdio.h>
#include <unistd.h>
#include <fcntl.h>
#include <termios.h>

#define DEVICE "/dev/ttyUSB0"
#define SPEED B38400 

int main()
{
    struct termios tio; //to hold serial port settings
    struct termios stdio; //so we can accept user input
    struct termios old_stdio; //save the current port settings
    int tty_fd; //file descriptor for serial port
    int res, n, res2, read1, wri;
    char buf[255];
    char buf2[255]; 

    //save the current port settings
    tcgetattr(STDOUT_FILENO,&old_stdio); 

    //setup serial port settings
    bzero(&tio, sizeof(tio));
    tio.c_iflag = 0;
    tio.c_iflag = IGNPAR | IGNBRK | IXOFF;
    tio.c_oflag = 0;
    tio.c_cflag = CS8 | CREAD | CLOCAL; //8n1 see termios.h 
    tio.c_lflag = ICANON;

    //open the serial port
    tty_fd=open(DEVICE, O_RDWR | O_NOCTTY); 

    //set the serial port speed to SPEED
    cfsetospeed(&tio,SPEED); 

    //apply to the serial port the settings made above
    tcsetattr(tty_fd,TCSANOW,&tio); 

    for(n = 5; n > 0; n--)
    {
    printf("Please enter a command: ");
    (void)fgets(buf2, 255, stdin);
    (void)write(tty_fd, buf2, strlen(buf2));                   
    printf("Ok. Waiting for reply.");
    res = read(tty_fd, buf, 255);       
    printf("Read:%d START%d %d %d %d %dFINISH\n",res,buf[0],buf[1],buf[2],buf[3],
    buf[4]);              
    }

    //close the serial port 
    close(tty_fd); 

    //restore the original port settings
    tcsetattr(STDOUT_FILENO,TCSANOW,&old_stdio); 

    return EXIT_SUCCESS; 
} 
```

这是我得到的结果示例。

*   当 PIC 发送“00000\n”时，输出为： 读取：6 START-16 48 48 48 48FINISH
*   当 PIC 发送“23456\n”时，输出为：读取：6 START-14 51 52 53 54FINISH
*   当 PIC 发送“34567\n”时，输出为：读取：6 START-14 52 53 54 55FINISH
*   当 PIC 发送“45678\n”时，输出为：读取：6 START-12 53 54 55 56FINISH
*   当 PIC 发送“56789\n”时，输出为：读取：6 START-12 54 55 56 57FINISH

出于某种原因，第一个字符被某些 termios 设置弄乱了。它必须是 termios 设置，因为上面相同的测试输入在我运行 Cutecom 时完全返回。我一遍又一遍地阅读手册页，在输入控件上尝试了所有不同的设置，但无论我做什么都无法解决这个问题。

为了一个简单的修复，我可以将我的数据转移到 1 个字符上，但希望避免这样做。

有没有人遇到过这样的问题或知道该怎么做？

非常感谢。

28/3/13 很好的建议奥斯汀。对于那些对此感兴趣的人，有两个输出：

*   首先是我程序中的 termios 设置

    速度 38400 波特；第 0 行；第 0 列；线 = 0; 内部 = ; 退出 = ; 擦除 = ; 杀死 = ; eof = ; eol = ; eol2 = ; 开关 = ; 开始 = ; 停止 = ; 怀疑 = ; rprnt = ; 错误 = ; 下一个 = ; 冲洗 = ; 最小值 = 0; 时间=0；-parenb -parodd cs8 -hupcl -cstopb cread clocal -crtscts ignbrk -brkint ignpar -parmrk -inpck -istrip -inlcr -igncr -icrnl -ixon ixoff -iuclc -ixany -imaxbel -iutf8 -opost -olcuc -ocrnl -onlcr -onocr -onlret -ofill -ofdel nl0 cr0 tab0 bs0 vt0 ff0 -isig icanon -iexten -echo -echo -echok -echonl -noflsh -xcase -tostop -echoprt -echoctl -echoke

*   还有cutecom使用的设置

    速度 38400 波特；第 0 行；第 0 列；线 = 0; 内部 = ^C; 退出 = ^\; 擦除 = ^?; 杀死 = ^U; eof = ^D; eol = ; eol2 = ; 开关 = ; 开始 = ^Q; 停止 = ^S; 悬念 = ^Z; rprnt = ^R; 错误 = ^W; 下一个 = ^V; 冲洗 = ^O; 最小值 = 60；时间=1；-parenb -parodd cs8 hupcl -cstopb cread clocal -crtscts ignbrk -brkint -ignpar -parmrk -inpck -istrip -inlcr -igncr -icrnl -ixon -ixoff -iuclc -ixany -imaxbel -iutf8 -opost -olcuc -ocrnl -onlcr - onocr -onlret -ofill -ofdel nl0 cr0 tab0 bs0 vt0 ff0 -isig -icanon -iexten -echo -echo -echok -echonl -noflsh -xcase -tostop -echoprt -echoctl -echoke

我仍在经历这一切，当我取得进展时会更新帖子。

29/3/13 仍然有同样的问题。我什至找到了 Cutecom 的源代码，并遵循了他们使用的 termios 设置。问题仍然存在。第一个字符已损坏！！！！

*   这是我程序中的 Termios 设置。由于某种原因无法设置冲洗。

    速度 38400 波特；第 0 行；第 0 列；线 = 0; 内部 = ^?; 退出 = ^\; 擦除 = ^H; 杀死 = ^U; eof = ^D; eol = ; eol2 = ; 开关 = ; 开始 = ^Q; 停止 = ^S; 悬念 = ^Z; rprnt = ^R; 错误 = ^W; 下一个 = ^V; 冲洗 = ; 最小值 = 60；时间=1；-parenb -parodd cs8 hupcl -cstopb cread clocal -crtscts ignbrk -brkint -ignpar -parmrk -inpck -istrip -inlcr -igncr -icrnl -ixon -ixoff -iuclc -ixany -imaxbel -iutf8 -opost -olcuc -ocrnl -onlcr - onocr -onlret -ofill -ofdel nl0 cr0 tab0 bs0 vt0 ff0 -isig -icanon -iexten -echo -echo -echok -echonl -noflsh -xcase -tostop -echoprt -echoctl -echoke

*   还有我的新代码：

    ```
    #include <stdlib.h>
    #include <stdio.h>
    #include <unistd.h>
    #include <fcntl.h>
    #include <termios.h>
    #include <sys/ioctl.h>

    #define DEVICE "/dev/ttyUSB0"
    #define SPEED B38400 

    int main()
    {
    struct termios tio; //to hold serial port settings
    struct termios stdio; //so we can accept user input
        struct termios old_stdio; //save the current port settings
        int tty_fd; //file descriptor for serial port
        int retval, res, n, res2, read1, wri;
        char buf[255];
        char buf2[255]; 

        tty_fd = open(DEVICE, O_RDWR | O_NDELAY);
        if(tty_fd < 0)
        {
            perror(DEVICE);
            exit(-1);
        }
        printf("Init 1 complete.\n");

        tcflush(tty_fd, TCIOFLUSH);

        int f = fcntl(tty_fd, F_GETFL, 0);
        fcntl(tty_fd, F_SETFL, f & ~O_NDELAY);

        retval = tcgetattr(tty_fd, &old_stdio);
        if(retval != 0)
        {
            perror(DEVICE);
            exit(-1);
        }
        printf("Init 2 complete.\n");

        struct termios newtio;
        retval = tcgetattr(tty_fd, &newtio);
        if(retval != 0)
        {
            perror(DEVICE);
            exit(-1);
        }
        printf("Init 3 complete.\n");

        cfsetospeed(&newtio, SPEED);
        cfsetispeed(&newtio, SPEED);

        newtio.c_cflag = (newtio.c_cflag & ~CSIZE) | CS8;
        newtio.c_cflag |= CLOCAL | CREAD;
        newtio.c_cflag &= ~(PARENB | PARODD);
        newtio.c_cflag &= ~CRTSCTS;
        newtio.c_cflag &= ~CSTOPB;

        newtio.c_iflag = IGNBRK;
        newtio.c_iflag &= ~(IXON | IXOFF | IXANY);

        newtio.c_lflag = 0;

        newtio.c_oflag = 0;

        newtio.c_cc[VTIME] = 1;
        newtio.c_cc[VMIN] = 60;
        newtio.c_cc[VINTR] = 127; 
        newtio.c_cc[VQUIT] = 28;
        newtio.c_cc[VERASE] = 8;
        newtio.c_cc[VKILL] =  21;
        newtio.c_cc[VEOF] = 4;
        newtio.c_cc[VSTOP] = 19;
        newtio.c_cc[VSTART] = 17;
        newtio.c_cc[VSUSP] = 26;
        newtio.c_cc[VREPRINT] = 18;
        newtio.c_cc[VFLSH] = 15;
        newtio.c_cc[VWERASE] = 23;
        newtio.c_cc[VLNEXT] = 22;

        retval = tcsetattr(tty_fd, TCSANOW, &newtio);
        if(retval != 0)
        {
            perror(DEVICE);
            exit(-1);
        }
        printf("Init 4 complete.\n");

        int mcs = 0;
        ioctl(tty_fd, TIOCMGET, &mcs);
        mcs |= TIOCM_RTS;
        ioctl(tty_fd, TIOCMSET, &mcs);

        retval = tcgetattr(tty_fd, &newtio);
        if(retval != 0)
        {
            perror(DEVICE);
            exit(-1);
        }
        printf("Init 5 complete.\n");

        newtio.c_cflag &= ~CRTSCTS;

        retval = tcsetattr(tty_fd, TCSANOW, &newtio);
        if(retval != 0)
        {
            perror(DEVICE);
            exit(-1);
        }
        printf("Init 6 complete.\n");

        for(n = 5; n > 0; n--)
        {
        printf("Please enter a command: ");
        (void)fgets(buf2, 255, stdin);
        (void)write(tty_fd, buf2, strlen(buf2));
        printf("Ok. Waiting for reply\n");
        res = read(tty_fd, buf, 255);       
        printf("Read:%d START%d %d %d %d %dFINISH\n",res,buf[0],buf[1],buf[2], buf[3],
        buf[4]);              
        }

        //restore the original port settings
        tcsetattr(tty_fd, TCSANOW, &old_stdio); 

        close(tty_fd);

        return EXIT_SUCCESS; //return all good
    } 
    ```

我完全不知道可以做什么或应该从这里拿走它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T02:37:36.147

快速扫描您的代码，我看不出任何明显错误。`unsigned char buf[]`如果您希望使用 8 位值，您可能需要考虑迁移到。

由于您在 Cutecom 中有一个工作程序，您可以使用他们的 termios 设置作为参考来调试您自己的程序。

在 Cutecom 上运行时`/dev/ttyUSB0`，在另一个终端中运行以下命令来转储 tty 设置：

```
stty -a -F /dev/ttyUSB0 
```

在运行程序时执行相同的操作并查找两种配置之间的差异。尝试在您的程序中设置终端设置以完全匹配为 Cutecom 报告的设置。

**更新：**

由于修复 termios 设置并没有解决问题，这里有一些进一步的尝试。我冒险猜测某处存在时间问题。在 Cutecom 控制台上打字时，您一次将 1 个字符发送到您的设备，字符之间有很多毫秒。使用您的程序时，输入命令后将发送一个完整的字符缓冲区，并以驱动程序允许的速度连续发送字符。也许您的 PIC 程序无法处理数据流的时序，或者需要两个停止位而不是一个停止位，从而导致一些奇怪的返回码。

可能最好的起点是回到源头。拿起示波器或逻辑分析仪，验证 PIC 发送的数据是否正确。您必须了解位电平波形，允许开始位和停止位。比较 Cutecom 和您的程序的波形。如果使用逻辑分析仪，请确保使用的时钟是波特率的高倍数。例如 32 乘数。

另一种调试方法是使用`strace`验证驱动程序返回的字符实际上是不正确的，这不是您的程序的问题。使用`strace`，您将能够看到程序的原始读/写以及内核返回的内容。用于`strace -o ~/tmp/strace_output.txt -ttt -xx your_program`在程序运行时转储所有系统调用。有时，仅仅跟踪程序的过程就会减慢它足以显示时序错误的程度。您可以将读/写的时间与`strace`Cutecom 的时间进行比较。只是为了测试，您可以添加自己的`write()`函数，该函数发送字符串但在每个字符之间延迟少量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T01:24:01.843

我终于解决了。这是修复它的原因：

*   (void)write(tty_fd, buf2, 1);

问题已解决，但不能 100% 确定它为什么会这样做。问题是我的程序在微控制器写入后附加了一个 \n。当我对Cutecom 和我的程序进行strace 时，我发现Cutecom 只写“1”，而我的程序会写“1\n”。我只是想得不够透彻，因为当使用 Cutecom 发送一个字符时，您在用户提示中键入例如 1，然后按 Enter。在 PIC 方面，我的程序如下所示：

```
while(1)
{
    WATCHDOG();

    if(flag == 1)
    {
        char *start = str2;
        RS485_TXEN1();
        indicator = UART1_getch(); //get character sent from PC
        switch(indicator)
        {
            case '1' :                       
                    UART1_putstr("00000\n");
                    DAC_Write( DAC_CH_2, 4095);
                    break;
            case '2' :                      
                    UART1_putstr("23456\n");
                    DAC_Write( DAC_CH_2, 0);
                    break;
            case '3' :
                    UART1_putstr("34567\n");
                    break;
            case '4' :                       
                    UART1_putstr("45678\n");
                    break;
            case '\n' :
                    UART1_putch('\n');
                    break;
            default  :         
                    UART1_putstr("56789\n");                  
                    break;
        }
        RS485_RXEN1();
        flag = 0;
    }
} 
```

当一个字符到达 UART RX 时，会产生一个中断。我在这个中断服务程序中设置了“标志”，然后在 main() 中服务接收到的命令。不确定第一个字符是如何被修改的，但看起来由于“case '\n' :”而发生了一些覆盖或写入中断。

最后进行了简单的修复，甚至学到了一些使用 Linux 系统和调试的宝贵经验。感谢所有提供建议的人。对于任何想要开始连接 linux 机器和微控制器的人来说，上述代码可能有助于您入门。

# macos - 使用 AppleScript (Mountain Lion) 执行终端命令

> ID：15672752
> 
> 赞同：0
> 
> 时间：2013-03-28T01:40:02.757
> 
> 标签：macos, terminal, applescript

这曾经在 Mountain Lion OS X 之前工作：

```
tell application "Terminal"
    activate
    do script "cd /"
end tell 
```

现在，打开了新的 bash 窗口，但**没有执行**任何操作，*无论命令行脚本是什么*。

它在我尝试过的几个系统上都坏了，但这是一个普遍的问题吗？有解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T02:47:45.290

检查 Terminal.app 的 Preferences，有很多新窗口的选项以及启动时要打开的 Shell 等等——</p>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T02:04:52.453

按预期工作。

您的环境或 .bashrc 最近有什么变化吗？

```
bash$ cat t.applescript 
tell application "Terminal"
    activate
    do script "cd /"
end tell 
```

```
bash$ osascript t.applescript
tab 1 of window id 9766 
```

  新终端窗口打开，“cd /”在缓冲区中可见，shell 位于 /。

```
bash$ uname -smr
Darwin 12.2.0 x86_64 
```

编辑：也在 10.8.3 上验证

```
bash$ uname -smr
Darwin 12.3.0 x86_64 
```

# mysql - 获取日期范围内的最大数据而不重复 MYSQL

> ID：15672754
> 
> 赞同：2
> 
> 时间：2013-03-28T01:40:12.860
> 
> 标签：mysql, sql, group-by, between

我在查询时遇到了麻烦。

```
SELECT * FROM YourTable AS T1
INNER JOIN
(SELECT user_id , MIN(some_timestamp)  AS some_timestamp FROM YourTable
GROUP BY user_id) AS T2
ON T1.User_Id = T2.User_Id AND T1.some_timestamp = T2.some_timestamp
WHERE Some_Timestamp BETWEEN '13-Jun-12 08:00' AND '13-Jun-12 10:00'
```

* * *

表名称：YourTable

```
 | PK_ID | USER_ID |  SOME_TIMESTAMP |
------------------------------------|
|     1 |     123 | 13-Jun-12 14:30 |
|     2 |     123 | 13-Jun-12 08:50 |
|     3 |     567 | 13-Jun-12 09:23 |
|     4 |     567 | 13-Jun-12 09:45 |
|     5 |     567 | 13-Jun-12 09:40 |
|     6 |     890 | 13-Jun-12 08:44 | 
```

我想要得到的是这样
1\. 从 [13-Jun-12 08:00] 和 [13-Jun-12 10:00] 之间的特定日期范围获取数据
2\. 一旦获取范围内的日期，它将获取没有重复的最新日期。

输出应该是这样的：
1.date range between

```
[13-Jun-12 08:00] & [13-Jun-12 10:00]
```

2\. 只获取最新的时间戳，不重复。

结果应该是这样的

```
 | PK_ID | USER_ID |  SOME_TIMESTAMP |
------------------------------------|
|     2 |     123 | 13-Jun-12 08:50 |
|     4 |     567 | 13-Jun-12 09:45 |
|     6 |     890 | 13-Jun-12 08:44 | 
```

非常感谢大家！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T01:46:57.647

```
SELECT 
    pk_id,
    user_id,
    MAX(some_timestamp)
FROM
    your_table
WHERE
    some_timestamp>= '13-Jun-12 08:00' 
AND some_timestamp<= '13-Jun-12 10:00'
GROUP BY
    user_id
ORDER BY
    pk_id ASC 
```

[SQL小提琴](http://www.sqlfiddle.com/#!2/627af/3)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T01:58:13.053

您的查询非常接近。需要选择`MAX`而不是`MIN`，并且需要将`WHERE`条件移动到子查询中：

```
SELECT * 
FROM YourTable AS T1
  INNER JOIN
  (SELECT user_id , MAX(some_timestamp)  AS some_timestamp 
   FROM YourTable
  WHERE Some_Timestamp BETWEEN '2013-06-12 08:00' AND '2013-06-12 10:00'
   GROUP BY user_id) AS T2
    ON T1.User_Id = T2.User_Id AND T1.some_timestamp = T2.some_timestamp 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!2/53b02/2)

返回：

```
PK_ID    USER_ID   SOME_TIMESTAMP
2        123       June, 12 2013 08:50
4        567       June, 12 2013 09:45
6        890       June, 12 2013 08:44 
```

根据需要格式化您的`SOME_TIMESTAMP`字段。我还建议使用`>=`and`<=`而不是，`BETWEEN`因为使用`BETWEEN`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T01:58:20.673

我想你想要`pk_id`最大时间戳的时间。

要在 MySQL 中执行此操作，您通常必须重新加入原始数据。但是，在您的情况下，pk_id 似乎随着时间戳的增加而增加。如果这是真的，那么下面的查询应该返回你想要的：

```
select max(pk_id) as pk_id, user_id, max(some_timestamp)
FROM your_table
WHERE Some_Timestamp between '13-Jun-12 08:00' AND Some_Timestamp <= '13-Jun-12 10:00'
GROUP BY user_id
ORDER BY pk_id ASC 
```

如果不包含`max(pk_id)`，则将返回任意`pk_id`值，它与最大时间戳无关。

# css - 父菜单和子菜单垂直分隔符（唯一、高级）

> ID：15672756
> 
> 赞同：1
> 
> 时间：2013-03-28T01:40:21.773
> 
> 标签：css

我在[http://www.roydukkey.com](http://www.roydukkey.com)有以下导航。导航被设计为在父菜单和它的子菜单之间有垂直分隔符。如果您在“联系人”菜单项下查看它的设计方式，请查看“项目”下的内容。在菜单上没有子项的地方不应该存在垂直分隔符。

**如何仅通过 CSS 实现正确的设计？**

* * *

**这目前无法通过 CSS 实现。**

这是我选择的解决方案：

```
// Naivagation Vertical Separator Counter
$("#main > ul > li > ul .level-has-sub").each(function(){
    $(this).find("> ul > li")
        .slice(0, $(this).find("~ li").length + 1)
        .addClass("vertical-separator")
}); 
```

他们只是为垂直分隔符设置这些项目的样式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T21:48:50.580

纯 CSS 是不可能的。您必须计算`<li>`child 中 s的数量`<ul>`。如果您重组了菜单，则可以将分隔符放在子项中`<ul>`。然后，您可以 a)`<li>`在 child的 every 左侧显示分隔符`<ul>`，或者`:first-child`仅在第一个显示分隔符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T22:00:50.777

你不能精确地做到这一点，因为 CSS 不能（还）知道另一个 DOM 元素的子元素数量。

CSS4 可能会在不久的将来做到这一点（提升到样式的父级）：http: [//www.w3.org/TR/selectors4/#subject](http://www.w3.org/TR/selectors4/#subject)。这看起来也很有趣，虽然不是纯 CSS；[http://demo.idered.pl/jQuery.cssParentSelector/](http://demo.idered.pl/jQuery.cssParentSelector/)。也许您可以在计算子菜单的子菜单后再次下降，但是使用 CSS 的低逻辑选择方法来实现这将非常复杂。

您可能最好在[SASS](http://sass-lang.com)中执行此操作，但它不再是原生 CSS，然后您不妨回退到 JavaScript。

这是一个示例，说明如何根据“至少”拥有多少个子项来设置父项本身的样式；

[JSfiddle](http://jsfiddle.net/bus9p/)

**HTML**

```
<ul>
    <li>
        <ul class="submenu">
            <li>Contact 1.1</li>
            <li>Contact 1.2</li>
            <li>Contact 1.3</li>
            <li>Contact 1.4</li>
        </ul>
    </li>
</ul>

<ul>
    <li>
        <ul class="submenu">
            <li>Contact 2.1</li>
            <li>Contact 2.1</li>
            <li>Contact 2.3</li>
        </ul>
    </li>
</ul> 
```

**CSS**

```
li {
    list-style: none;
    display: inline-block;
    border: 1px dotted red;
    padding: 15px;
}

.submenu li {
    display: block;
    padding: 15px;
    border: 0px;
    border-top: 1px dotted blue;
}

.submenu li:nth-child(1) {
    border: 0px;
}

/* This style only happens if the menu has 4 or more children li's */
.submenu li:first-child:nth-last-child(4),
.submenu li:first-child:nth-last-child(4) ~ li {
    border-left: 1px dotted blue;
} 
```

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-31T22:01:07.403

你的 CSS 被缩小了，所以我不能给你行号。

在您的 custom.css 文件中替换

```
#main li li.level-open:after, #main li li.level-open~li:after {rules} 
```

和

```
#main li li.level-open:after {rules} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-01T13:40:58.687

解决方案位于您可能期望的其他地方。

您已经错过了“联系人”菜单上的所有工作正常的期望。我添加了一个新元素只是为了表明“ `bug`”在菜单的设计中。

![在此处输入图像描述](../Images/dfe1cd11b8e0f02110a5a7c6f0c2de7d.png)

所以问题出在下拉菜单的设计上。要解决此问题，请查看您的 css 并查找

```
#main li li.level-open:after, #main li li.level-open ~ li:after 
```

并删除行：

```
border-right: 1px dotted #7F7F7F; 
```

现在，为了实现添加虚线菜单，您必须更改一点您的 php 代码。你不能在 CSS 中做到这一点。至少在我的小研究中我找不到。

创建一个新类 - 例如，在您的代码中，创建一个算法以将该 css 类添加到将在左侧有元素时`.dotted-right-border`打印在左侧的每个元素。`li``li`

**更新：**

好吧。我通常不喜欢说某事是不可能的，但在这种情况下，我认为用纯 CSS 进行更改是不可能的。甚至当前创建的菜单项也正在添加`level-open`到 HTML 标记中，因此需要围绕它做一些事情。对于这种情况，可能还有另一种方法，例如：

*   修改类 `#main li li.level-open:after, #main li li.level-open ~ li:after`

并更改提到的行：

```
border-right: 1px dotted #7F7F7F; 
```

进线：

```
border-right: 1px dotted transparent; 
```

然后为`border-color: #7F7F7F`子菜单下的每个新项目进行设置，但是您无法确定子菜单是否在左侧匹配，因此它将显示/不显示虚线边框。这只是一个示例方法。如果我解释的方法很好。

这一切最终都变成了一种情况——`How can you tell apart if the sub menu has a parent item on the left side in order to show dotted border?`这就是为什么我认为没有纯粹的 CSS 解决方案。但如果有人知道得更好，那就更好了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-04T06:40:37.020

CSS选择器不能引用子元素，我知道的唯一类（伪）：empty。在您的父母级别的情况下，您需要有关孩子数量的信息。解决方案是在设计时提供此信息并对其进行编码（例如，在类属性中）。

根据您的代码，对于项目节点，您需要添加如下信息：

```
<li class="level-has-sub limit">...</li>
<li class="level-has-sub limit2">...</li>
<li class="level-has-sub limit">...</li>
<li class="level-has-sub">...</li> 
```

以及相应的 CSS：

```
#main li li.level-open~li:after {
content: "";
position: absolute;
top: 10px;
bottom: 10px;
right: -17px;
border-right: none;
z-index: 1;
}
// above is not necessary if you remove this selector from your css

/* main job */
#main li li.level-open:not([class*=limit])~li:after {
content: "";
position: absolute;
top: 10px;
bottom: 10px;
right: -17px;
border-right: 1px dotted #7f7f7f;
z-index: 1;
}

#main li li.level-open.limit2+li:after, 
#main li li.level-open.limit3+li:after, 
#main li li.level-open.limit4+li:after
{
content: "";
position: absolute;
top: 10px;
bottom: 10px;
right: -17px;
border-right: 1px dotted #7f7f7f;
z-index: 1;
}

#main li li.level-open.limit3+li+li:after,
#main li li.level-open.limit4+li+li:after {
content: "";
position: absolute;
top: 10px;
bottom: 10px;
right: -17px;
border-right: 1px dotted #7f7f7f;
z-index: 1;
}

#main li li.level-open.limit4+li+li+li:after {
content: "";
position: absolute;
top: 10px;
bottom: 10px;
right: -17px;
border-right: 1px dotted #7f7f7f;
z-index: 1;
} 
```

如您所见，多个选择器存在问题，例如：

```
#main li li.level-open.limit2+li:after, 
#main li li.level-open.limit3+li:after, 
#main li li.level-open.limit4+li:after 
```

您可以通过使用属性子字符串编码来解决它，例如：limit1、limit11、limit111 和选择器 [class*=limit1]、[class*=limit11]、[class*=limit111]。

**注意：** 我使用子字符串选择器 [class*=limit] 女巫有点不可预测；）您可以将其更改为 pair: [class^="limit"], [class*="limit"] 以获得更好的控制。

希望能帮助到你 ：）

# android - 在自定义 LinearLayout 周围绘制边框

> ID：15672757
> 
> 赞同：0
> 
> 时间：2013-03-28T01:40:23.787
> 
> 标签：android, android-linearlayout, android-view, android-custom-view

这是我的屏幕布局的简要说明。

```
<CustomLayout>
    <CardView>
        <CustomTextView />
        <CustomTextView />
        <CustomTextView />
    </CardView>
    <CustomTextView />
    <CustomTextView />
</CustomLayout> 
```

我对它进行了编码，`CardView extends LinearLayout`并且`CustomTextView extends TextView`. 一切正常，除了我想`CardView`在第二个的底部和底部画一条边界线`CustomTextView`。为此，我对 my`CardView`和 my使用相同的方法`CustomTextView`：

```
@Override
protected void onDraw(Canvas canvas) {
    super.onDraw(canvas);
    getLocalVisibleRect(mRect);
    if (mDrawBottomBorder)
        canvas.drawLine(mRect.left, mRect.bottom, mRect.right, mRect.bottom, mBorderPaint);
} 
```

在这两种情况下都会调用该方法，即为 my `CardView`，`CustomTextView`但它不会为 my 绘制边框`CardView`！我怀疑这是因为它`extends LinearLayout`而不是`TextView`但它不应该工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T02:23:25.643

好的，我想通了。`CustomTextView`我的布局中的第三个`CardView`覆盖了它下面的边框，所以这条线不可见。

# java - 使用 mysql-connector-java-5.1.24 将 Java 连接到 MySQL

> ID：15672759
> 
> 赞同：0
> 
> 时间：2013-03-28T01:40:50.633
> 
> 标签：java, mysql, windows, jdbc

我正在阅读 JDBC API 教程和参考 3/E（MAN，多么枯燥的书籍），并且在使用 Oracle 提供的 MySQL 连接器将我的 Java 程序连接到我的 MySQL 数据库时遇到了麻烦。

我已经把它放在我的文件夹中

```
C:\Windows\Sun\Java\mysql-connector-java-5.1.24 
```

我已经将我在 JGrasp 中的 Workspace CLASSPATH 指向

```
C:\Windows\Sun\Java\mysql-connector-java-5.1.24\mysql-connector-java-5.1.24-bin.jar 
```

我正在尝试连接到名为“Coffee”的数据库。它肯定存在：

```
mysql> show databases;
+---------------------+
| Database            |
+---------------------+
| information_schema  |
| coffee              |
| mysql               |
| performance_schema  |
| phpmyadmin          |
+---------------------+
5 rows in set (0.03 sec) 
```

这是我的Java代码。（如果你有这本书，我在第 88 页。我的代码和他们的代码之间的唯一区别是一些注释，我将使用 MySQL。）

```
//first, import sql package
import java.sql.*;

//name class CreateCoffees
public class CreateCoffees { 

    public static void main(String[] args){

        String url = "jdbc:mysql://127.0.0.1:coffee";

        //declare variables 
        Connection conn;

        String createString =   "create table COFFEES " +
                                        "(COF_NAME varchar(32), " +
                                        "SUP_ID int, " +
                                        "PRICE float, " +
                                        "SALES int, " +
                                        "TOTAL int)";

        Statement stmt;

        //instructions
        try{
            Class.forName("com.mysql.jdbc.Driver");
        }
        catch(java.lang.ClassNotFoundException cnfe){
            System.out.println("Class Not Found - " + cnfe.getMessage());
        }       

        try{
            conn = DriverManager.getConnection(url, "root", "");

            stmt = conn.createStatement();

            stmt.executeUpdate(createString);

            stmt.close();
            conn.close();
        }
        catch(SQLException sqle){
            System.out.println("SQL Exception: " + sqle.getMessage());
        }

    }

} 
```

一切都编译得很好，但是当我运行它时，我抛出了以下 SQLException：

```
SQL Exception: Cannot load connection class because of underlying exception: 'java.lang.NumberFormatException: For input string: "coffee"'. 
```

我到底做错了什么？我可以运行一些东西来测试 Java 和数据库之间的连接性吗？我对两者都很陌生。

另外，应该注意的是，这不是家庭作业。

编辑：看起来有问题的代码行是

```
 String url = "jdbc:mysql://127.0.0.1:coffee"; 
```

并应更改为

```
 String url = "jdbc:mysql://127.0.0.1/coffee"; 
```

因为咖啡是一个数据库而不是一个端口。

我想我需要更多。感谢所有帮助过的人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T01:43:58.810

您的连接 URL`coffee`用作端口。你应该使用类似的东西：

```
jdbc:mysql://127.0.0.1:3306/coffee 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T01:42:34.277

为什么将“咖啡”作为端口号？你应该有你的mysql服务器端口号

```
jdbc:mysql://127.0.0.1:coffee 
```

提示：默认端口号是 3306。所以试试

```
jdbc:mysql://127.0.0.1:3306/coffee 
```

（假设您的数据库名称是咖啡）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T01:44:11.710

我认为解析器感到困惑并认为这`coffee`是一个端口号。

试试这个：

```
jdbc:mysql://127.0.0.1/coffee 
```

# c# - 数组值不变？

> ID：15672761
> 
> 赞同：1
> 
> 时间：2013-03-28T01:40:56.103
> 
> 标签：c#

由于某种原因，这不会编辑输入到其中的数组的大小，并且不会将数据添加到输入的数组中。

```
 public static void RandomizeArray(int[] array)
    {
        int intRead;
        int intReadSeed;
        Random randomNum = new Random();
        Console.WriteLine("How many ints do you want to randomly generated?");
        intRead = Convert.ToInt32(Console.ReadLine());
        array = new int[intRead];
        Console.WriteLine("What's the maximum value of the randomly generated ints?");
        intReadSeed = Convert.ToInt32(Console.ReadLine());
        for (int i = 0; i < intRead; i++)
        {
            array[i] = (randomNum.Next(intReadSeed));
        }
        Console.WriteLine("Randomization Complete.\n");
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-28T01:43:12.293

当您将数组传递给此方法时，您通过值传递它 - 也就是说，您创建了一个全新的变量，该变量也指向同一个对象。如果您`array`在方法中编辑变量以指向一个新数组，它也不会使另一个变量指向您的新数组 - 它仍然指向旧数组。因此，当您返回时，您尚未对`array`传入的内容进行任何编辑。

要解决此问题，`return array;`请在方法结束时将签名从 更改`void`为`int[]`。或者您可以`out int[] array`作为参数执行，因此您可以通过引用传递并对其进行编辑。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-28T01:47:53.147

简单修复将参数声明为`out`.

```
public static void RandomizeArray(out int[] array)
{
    int intRead;
    int intReadSeed;
    Random randomNum = new Random();

    Console.WriteLine("How many ints do you want to randomly generated?");

    intRead = Convert.ToInt32(Console.ReadLine());
    array = new int[intRead];

    Console.WriteLine("What's the maximum value of the randomly generated ints?");
    intReadSeed = Convert.ToInt32(Console.ReadLine());

    for (int i = 0; i < intRead; i++)
    {
        array[i] = (randomNum.Next(intReadSeed));
    }

    Console.WriteLine("Randomization Complete.\n");
} 
```

这样你就可以调用它：

```
int[] array;

RandomizeArray(out array); 
```

但是，最好简单地返回一个数组。

```
public static int[] GenerateRandomizedArray()
{
    int intRead;
    int intReadSeed;
    Random randomNum = new Random();

    Console.WriteLine("How many ints do you want to randomly generated?");
    intRead = Convert.ToInt32(Console.ReadLine());
    var array = new int[intRead];

    Console.WriteLine("What's the maximum value of the randomly generated ints?");
    intReadSeed = Convert.ToInt32(Console.ReadLine());

    for (int i = 0; i < intRead; i++)
    {
        array[i] = (randomNum.Next(intReadSeed));
    }

    Console.WriteLine("Randomization Complete.\n");

    return array;
} 
```

# android - 允许用户在 Spinner 中输入新值

> ID：15672767
> 
> 赞同：4
> 
> 时间：2013-03-28T01:41:17.817
> 
> 标签：android, android-widget

首先，我是android开发的新手。我正在构建一个小型应用程序，它的 UI 中包含一个微调器，它具有四个数字的预定义集合（数组），我正在使用`ArrayAdapter`从资源文件将值提供给微调器。

微调器工作正常，用户可以选择值。但我也希望用户能够输入新值，如果他们想输入一个新值。我该怎么做？

**Activity 的 onCreate 方法中的代码**：

`Spinner spinner = (Spinner) findViewById(R.id.spinner); // Create an ArrayAdapter using the string array and a default spinner layout ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(this, R.array.points_preset, android.R.layout.simple_spinner_item); // Specify the layout to use when the list of choices appears adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item); // Apply the adapter to the spinner spinner.setAdapter(adapter); spinner.setOnItemSelectedListener(new SpinnerActivity());`

**SpinnerActivity 类的代码：**

**更新包括输入对话框：**

```
 public class SpinnerActivity extends Activity implements OnItemSelectedListener {

        public void onItemSelected(AdapterView<?> parent, final View view, 
                int pos, long id) {
            if (pos==3)
            {
                // Set an EditText view to get user input 
                final EditText input = new EditText(MainActivity.this);

                new AlertDialog.Builder(MainActivity.this)
                                            .setMessage("Enter your Point here")
                    .setView(input)
                    .setPositiveButton("Ok", new DialogInterface.OnClickListener() {
                         public void onClick(DialogInterface dialog, int whichButton) {
                          Editable   editable = input.getText(); 
                          //if I uncomment following line, the application terminates
                       // Spinner spinner = (Spinner) findViewById(R.id.spinner);

                         }
                    })
                    .setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
                         public void onClick(DialogInterface dialog, int whichButton) {
                                // Do nothing.
                         }
                    }).show(); 
            }

                                    }

        public void onNothingSelected(AdapterView<?> parent) {
            // Another interface callback
        }
    }
                    ` 
```

**Strings.xml 资源文件**

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name">PointCalculator</string>
    <string name="menu_settings">Settings</string>
    <string-array name="points_preset">
    <item>3</item>
    <item>10</item>
    <item>0</item>
    <item>Oth</item>
    </string-array>

</resources> 
```

SpinnerActivity 类的更新和工作版本

`

```
public class SpinnerActivity extends Activity implements OnItemSelectedListener {

                public void onItemSelected(AdapterView<?> parent, final View view, 
                        int pos, long id) {
                    if (pos==3)
                    {
                        // Set an EditText view to get user input 
                        final EditText input = new EditText(MainActivity.this);

                        new AlertDialog.Builder(MainActivity.this)
                                                    .setMessage("Enter your Point here")
                            .setView(input)
                            .setPositiveButton("Ok", new DialogInterface.OnClickListener() {
                                 public void onClick(DialogInterface dialog, int whichButton) {
                                  Editable   editable = input.getText(); 

                           arrayList.add(editable.toString());
                            adapter.notifyDataSetChanged();

                                 }
                            })
                            .setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
                                 public void onClick(DialogInterface dialog, int whichButton) {
                                        // Do nothing.
                                 }
                            }).show(); 
                    }

                                            }

                public void onNothingSelected(AdapterView<?> parent) {
                    // Another interface callback
                }
            }` 
```

谢谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-28T01:51:46.720

有几种方法可以做到这一点。我们这样做的一种方法是有一个`spinner`项目，上面写着“添加项目”。在`onItemSelected`我们有一个`AlertDialog`弹出的`EditText`输入项目然后你只需将它添加到你的`Array`或你正在使用的任何东西。您也可以在他们`EditText`旁边`Spinner`或任何地方添加新项目，然后当他们单击 a 时，`Button`您将其添加到存储数据的任何位置并调用`notfiyDataSetChanged()`以更新`Spinner`. 我希望这回答了你的问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T02:23:18.703

您创建 ArrayAdapter 的方式不允许您非常轻松地添加到数组中，因为将根据资源创建支持数组。

首先从资源中加载数组并将其添加到列表中。然后使用该列表创建 ArrayAdapter。

然后，您可以通过添加到支持列表来将项目添加到微调器。您将需要在适配器上调用 notifyDatasetChanged() 以让它知道您更改了适配器中的可用项目。

# jquery - 无法完美居中元素

> ID：15672768
> 
> 赞同：0
> 
> 时间：2013-03-28T01:41:18.180
> 
> 标签：jquery, html, css, positioning

我无法完美地将具有动态大小的 div 居中，该大小会根据用户上传的图像的尺寸而变化。该功能应该将 div 绝对定位在所有其他内容的屏幕中心，但是无论我使用什么图像，它都会偏离一小部分......见下文：

[http://i.imgur.com/F9NNDAH.jpg](http://i.imgur.com/F9NNDAH.jpg)

这是CSS：

```
.prompt_background {
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0;
    left: 0;
    background-color: black;
    -moz-opacity:.50; 
    filter:alpha(opacity=50); 
    opacity:.50;
    display: none;
}

.prompt_box {
    -webkit-border-radius: 5px;
    -moz-border-radius: 5px;
    border-radius: 5px;
    background-color: white;
    z-index: 1;
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    behavior: url(PIE.htc);
}

.prompt_content {
    width: 100%;
    margin: 10px;
} 
```

我加载它的方式是这样的：

```
function showprompt() {
$('.prompt_box')
    .css("margin-left", -(($('.prompt_box').width())/2)+"px") //Horizontal center
    .css("margin-top", -(($('.prompt_box').height())/2)+"px"); //Vertical center

$('.prompt_background')
    .css('height', $(document).height())
    .css("width", $(document).width()); //Background stretch

$('.prompt_background')
    .css('filter', 'alpha(opacity=50)'); //Background opacity
$('.prompt_background, .prompt_box')
    .fadeIn(500); //Animation
} 
```

至于 HTML，它只是三个空的 div，我通过 ajax 将内容加载到其中

```
<div class="prompt_background">
</div>
<div class="prompt_box">
    <div class="prompt_content">
    </div>
</div> 
```

# python - 更新连接到单个数据模型的多个对话框上的多个视图

> ID：15672770
> 
> 赞同：1
> 
> 时间：2013-03-28T01:41:30.223
> 
> 标签：python, model-view-controller, model, pyqt, qcombobox

我有两个表单，两个视图连接到同一个 dataModel 类，但是当我在一个表单上更改数据时，它不会在另一个表单上更改。

我试图在几个不同的对话框/表单上获取一个组合框，以便在底层数据从另一个对话框/表单更改时得到更新。

这是我的代码：

```
class Model(QStringListModel):

    def __init__(self, parent=None):
        super(Model, self).__init__(parent)
        data = QStringList()
        data << "one" << "two" << "three" << "four" << "five"
        self.setStringList(data)

class Form_2(QDialog):

    def __init__(self, parent=None):
        super(Form_2, self).__init__(parent)
        self.model = Model()
        self.combo = QListView()
        self.combo.setModel(self.model)

        layout = QVBoxLayout()
        layout.addWidget(self.combo)
        self.setLayout(layout)

class Form_1(QDialog):

    def __init__(self, parent=None):
        super(Form_1, self).__init__(parent)
        self.model = Model()
        self.listView = QListView()
        self.listView.setModel(self.model)
        self.combo = QComboBox()
        self.combo.setModel(self.model)
        self.form2_button = QPushButton("Open Form_2")

        layout = QVBoxLayout()
        layout.addWidget(self.listView)
        layout.addWidget(self.combo)
        layout.addWidget(self.form2_button)
        self.setLayout(layout)

        self.connect(self.form2_button, SIGNAL("clicked()"), self.form_2)

    def form_2(self):
        self.ft = Form_2()
        self.ft.show()

app = QApplication(sys.argv)
form = Form_1()
form.show()
app.exec_() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T15:37:51.000

下面是一个基本示例，说明当修改任何这些视图时，基于同一模型的多个视图如何自我更新：

```
#!/usr/bin/env python
#-*- coding:utf-8 -*-

from PyQt4 import QtGui, QtCore

class MyDialog(QtGui.QWidget):
    def __init__(self, modelSource, parent=None):
        super(MyDialog, self).__init__(parent)

        self.tableView = QtGui.QTableView(self)
        self.tableView.horizontalHeader().setStretchLastSection(True)
        self.tableView.setModel(modelSource)

        self.listView = QtGui.QListView(self)
        self.listView.setModel(modelSource)
        self.listView.setModelColumn(0)

        self.comboBox = QtGui.QComboBox(self)
        self.comboBox.setModel(modelSource)
        self.comboBox.setModelColumn(1)

        self.layoutGrid = QtGui.QGridLayout(self)
        self.layoutGrid.addWidget(self.comboBox, 0, 0, 1, 2)
        self.layoutGrid.addWidget(self.listView, 1, 0, 1, 1)
        self.layoutGrid.addWidget(self.tableView, 1, 1, 1, 1)

class MyWindow(QtGui.QWidget):
    _dialogs = []
    def __init__(self, parent=None):
        super(MyWindow, self).__init__(parent)

        self.modelSource = QtGui.QStandardItemModel(self)

        for rowNumber in range(3):
            items = []
            for columnNumber in range(3):
                item = QtGui.QStandardItem()
                item.setText("row: {0} column {1}".format(rowNumber, columnNumber))

                items.append(item)

            self.modelSource.appendRow(items)

        self.labelDialogs = QtGui.QLabel(self)
        self.labelDialogs.setText("Select a number of dialogs to create:")

        self.spinBoxDialogs = QtGui.QSpinBox(self)
        self.spinBoxDialogs.setValue(3)

        self.pushButtonShow = QtGui.QPushButton(self)
        self.pushButtonShow.setText("Show Dialogs!")
        self.pushButtonShow.clicked.connect(self.on_pushButtonShow_clicked)

        self.pushButtonClose = QtGui.QPushButton(self)
        self.pushButtonClose.setText("Close Dialogs")
        self.pushButtonClose.clicked.connect(self.on_pushButtonClose_clicked)

        self.layoutHorizontal = QtGui.QHBoxLayout(self)
        self.layoutHorizontal.addWidget(self.labelDialogs)
        self.layoutHorizontal.addWidget(self.spinBoxDialogs)
        self.layoutHorizontal.addWidget(self.pushButtonShow)
        self.layoutHorizontal.addWidget(self.pushButtonClose)

    @QtCore.pyqtSlot()
    def on_pushButtonShow_clicked(self): 
        self._dialogs = []
        dialogsNumber = self.spinBoxDialogs.value()

        for dialogNumber in range(dialogsNumber):  
            dialog = MyDialog(self.modelSource)
            dialog.show()
            dialog.move(100, 100)

            self._dialogs.append(dialog)

    @QtCore.pyqtSlot()
    def on_pushButtonClose_clicked(self): 
        for dialog in self._dialogs:
            dialog.close()

        self._dialogs = []

if __name__ == "__main__":
    import sys

    app = QtGui.QApplication(sys.argv)
    app.setApplicationName('MyWindow')

    main = MyWindow()
    main.show()

    sys.exit(app.exec_()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T21:33:27.643

感谢 ccc.larc 给我答案。我们基本上只能使用模型的一个实例，如果模型有多个实例，它就不起作用。因此，您始终必须将模型的相同实例传递给您希望它使用的任何形式。

如果我理解正确，这就是@X.Jacobs 所说的，我只是展示我的新代码，它更简单一些，可以更好地理解它与我以前的代码的对比（那不起作用）

所以我上面的代码只需要一个小改动。

```
class Model(QStringListModel):

    def __init__(self, parent=None): 
        super(Model, self).__init__(parent)
        data = QStringList()
        data << "one" << "two" << "three" << "four" << "five"
        self.setStringList(data)

class Form_2(QDialog):

    def __init__(self, model, parent=None): #get the model from the calling form
        super(Form_2, self).__init__(parent)
        self.model = model
        self.combo = QListView()
        self.combo.setModel(self.model)

        layout = QVBoxLayout()
        layout.addWidget(self.combo)
        self.setLayout(layout)

class Form_1(QDialog):

    def __init__(self, parent=None):
        super(Form_1, self).__init__(parent)
        self.model = Model()
        self.listView = QListView()
        self.listView.setModel(self.model)
        self.combo = QComboBox()
        self.combo.setModel(self.model)
        self.form2_button = QPushButton("Open Form_2")

        layout = QVBoxLayout()
        layout.addWidget(self.listView)
        layout.addWidget(self.combo)
        layout.addWidget(self.form2_button)
        self.setLayout(layout)

        self.connect(self.form2_button, SIGNAL("clicked()"), self.form_2)

    def form_2(self):
        self.ft = Form_2(self.model) #pass the same model to the new form
        self.ft.show()

app = QApplication(sys.argv)
form = Form_1()
form.show()
app.exec_() 
```

# javascript - 添加新条形图时的 D3 比例图

> ID：15672773
> 
> 赞同：0
> 
> 时间：2013-03-28T01:41:45.197
> 
> 标签：javascript, html, button, d3.js, scale

我正在尝试缩放我的条形图，以使它们看起来都没有异常大，超出范围。我能够部分地做到这一点。

当我在尝试更新当前数据之前尝试添加数据时，我的问题就出现了，即如果我在 clickEvent 之前调用 addData，则渲染不会被缩放。即使在我反复添加数据之后。它只会在我调用 clickEvent 函数时缩放，之后每次渲染时都会缩放。

我不确定，我做错了什么，所以任何帮助将不胜感激。

这是jsfiddle链接：

[http://jsfiddle.net/NkkDC/4/](http://jsfiddle.net/NkkDC/4/)

以下是功能：

```
function clickEvent(d, i) {
    var op = prompt("Please enter the value", d);
    data[i] = parseInt(op, 10);
    render();

};    

function addData() {
    var op = prompt("Please enter the value", "");
    var len = data.length;
    data[len] = op;
    render();
}; 
```

在 jsfiddle 中，我的按钮在单击时似乎没有提示输入框。对此的帮助也将不胜感激。

谢谢！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T01:52:12.467

也使用 d3 将事件添加到按钮：

```
d3.select("button").on("click", function(d, i) {
    var op = prompt("Please enter the value", "");
    var newData = parseInt(op, 10);
    if (!isNaN(newData)) {
      data.push(newData);
      render();
    }
}); 
```

# git - 从分支创建分支

> ID：15672774
> 
> 赞同：0
> 
> 时间：2013-03-28T01:41:46.803
> 
> 标签：git, version-control, merge, branch

假设我有主人

假设我这样做`git branch branchA master` 了，然后我在 branchA 上进行开发，然后我想从 branchA 创建另一个分支，所以我这样做`git branch branchB branchA` ，然后我继续在 branchA 和 branchB 上进行开发，每个分支都开发了自己的东西我的问题是：

假设我最终想在开发完成后将 branchA 和 branchB 合并为 master 。假设我在分支 A 和分支 B 上都做了一大堆`git pull origin master`。假设有时我想在分支 A 和分支 B 之间合并。

1.  `git pull origin master`每当我尝试在分支之间合并或最终将分支合并到最终产品中时，单独分支中的更改是否会相互冲突。
2.  进行此分支和单独开发是否会使分支（branchA 和 branchB）之间难以合并...即，当我尝试在 branchA 和 branchB 之间合并时，这是否会不必要地增加冲突的机会

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T01:51:55.380

我不完全理解你在做什么，但我建议如下：

*   如果您从 master 分支分支分支 A，最好在那里开发并合并回 master。不要将master集成到branchA中。如果需要，在 master 之上 rebase branchA
*   最好不要分支分支A，或者如果你这样做，考虑冻结分支A（现在分支B取决于它的历史......）。在这种情况下，将 branchB 合并回 branchA，并将结果合并到 master。

我并不是说它不能以其他方式完成，但我知道 gitk 显示的任何更多类似网格的图形都会让我感到困惑。保持简单，处理 VCS 已经足够复杂了。

# oracle11g - 使用 inside in 语句时，如果不使用索引，则无法评估 SDO_NN

> ID：15672776
> 
> 赞同：3
> 
> 时间：2013-03-28T01:41:55.107
> 
> 标签：oracle11g, oracle-spatial

如果我运行以下查询：

```
select B3.bid as id ,B3.bshape as shape 
from Buildings B3 
where B3.bid in 
(
   select distinct B1.bid from Buildings B1, 
   (
     select * from Buildings B where B.bname in (select BOF.bname from Buildings_On_Fire BOF)
   ) B2 where sdo_nn(B1.bshape, B2.bshape, 'distance=100') = 'TRUE' and B1.bname != b2.bname
) 
```

我收到以下错误：

> 第 1 行的错误：
> ORA-13249：不使用索引就无法评估 SDO_NN
> ORA-06512：在“MDSYS.MD”，第 1723 行
> ORA-06512：在“MDSYS.MDERR”，第 17行 ORA-06512：在“MDSYS.MD”
> 。 PRVT_IDX”，第 9 行

但是，如果只运行以下子查询：

```
select distinct B1.bid from Buildings B1, 
(
   select * from Buildings B  where B.bname in (select BOF.bname from Buildings_On_Fire BOF)
) B2 where sdo_nn(B1.bshape, B2.bshape, 'distance=100') = 'TRUE' and B1.bname != b2.bname 
```

这执行得很好。我已经验证了空间索引，它们似乎是有效的。
我是 Oracle 新手，不知道下一步该做什么。请帮忙。

如果有不需要更改上述查询的解决方案，那将是最好的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-18T14:33:01.417

A bit late for an answer, but here comes ...

The error you get is because the optimizer did not use the spatial index to solve the SDO_NN operator. Contrary to the other spatial operators (SDO_RELATE, SDO_WIHIN_DISTANCE), SDO_NN cannot be resolved without the help of the index.

Then again I suspect your query is incorrectly formulated. If I understand correctly, what you want to do is find all buildings that are within a distance of 100 (what ? meters ?) from any building that is on fire. For that, use the SDO_WITHIN_DISTANCE operator.

Let's assume your tables are like this:

buildings (bid number, bname varchar2(30), bshape sdo_geometry)

buildings_on_fire (bid number, bname varchar2(30))

The select will then be like this:

```
select b1.bid as id, b1.bshape as shape
from   buildings b1, 
       buildings b2, 
       buildings_on_fire bof
where  b2.bname = bof.bname
and    b1.bname <> b2.bname
and    sdo_within_distance (
         b1.bshape, b2.bshape, 
         'distance=100 unit=meter'
       ) = 'TRUE'; 
```

# java - 文本复制

> ID：15672778
> 
> 赞同：0
> 
> 时间：2013-03-28T01:41:56.397
> 
> 标签：java, swing

我正在使用简单的文本编辑器和主面板，我有 JList 与当前打开的文件（CDocument 类）和活动文档，其中显示的内容（也是 CDocument 类）。我将打开的文件（CDocument 对象）存储在向量中，并且在右侧显示了活动文档。![在此处输入图像描述](../Images/cf73ea2f8bcd27337d19b83373a12d99.png)

现在，在程序启动时，没有活动文档，打开的文档列表为空。单击文件->新建后，我从 CDocument 类创建新的空对象。如果我在活动文档区域（屏幕截图上的红色区域）中输入一些内容，然后我重新单击文件-> 新建，我会得到新的、空的（没有文本 - 我已经仔细检查过）CDocument 对象。但是，之前活动文档中的文本仍然显示在新创建的（红色区域 - 新空的 CDocument）中。我在这里破坏我的大脑，因为我不知道为什么？！这是文件->新代码块：`

```
if(e.getSource()==this.menuItemFileNew())
{
    CDocument currentDocument=new CDocument();

    if(this.panelMain().documentActive()!=null)
    {
        this.panelMain().remove(this.panelMain().documentActive());
    }

    this.panelMain().openedDocuments().add(currentDocument);
    this.panelMain().setDocumentActive(currentDocument);

    this.panelMain().add(panelMain().documentActive().pane(),
            BorderLayout.CENTER);
    this.panelMain().documentActive().addKeyListener(this);
    this.panelMain().documentActive().requestFocus();

    this.menuItemFileSave().setEnabled(true);
    this.menuItemFileSaveAs().setEnabled(true);
    this.menuItemFileClose().setEnabled(true);
    this.menuItemFileCloseAll().setEnabled(true);

    this.toolBarFileSwitcher().panelActiveDocumentInfo().
            panelFileSizeInfo().updatePanel(this.panelMain().documentActive().getText().length(),
                false);

    this.toolBarFileSwitcher().listOpenedFiles().model().addElement(currentDocument.filename());
    this.toolBarFileSwitcher().listOpenedFiles().setSelectedIndex(this.toolBarFileSwitcher().listOpenedFiles().model().size()-1);
    this.toolBarFileSwitcher().setVisible(true);
} 
```

`

为什么显示文字，我试过updateUI，重绘，没有任何效果！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T03:21:11.540

用于[`Action`](http://docs.oracle.com/javase/tutorial/uiswing/misc/action.html)封装与您的`CDocument`数据类型相关的功能。这将有助于确保*所有*调用都是一致的。此[示例](https://stackoverflow.com/a/5129757/230513)管理图像，而此[示例](https://stackoverflow.com/a/4039359/230513)说明文件菜单。

# c++ - fstream 文件被重写

> ID：15672785
> 
> 赞同：0
> 
> 时间：2013-03-28T01:42:37.057
> 
> 标签：c++, file-io, fstream

我正在开发一个将输出文本文件的程序。每当我想写入文件时，我都会打开它，`seekp()`直到文件末尾，写入它，然后关闭它。但是，似乎每次执行新的写入时，它都会替换文件中先前存在的所有数据。

```
output.open("output.txt", fstream::out);
output.seekp(0, ios::end);
output << "Record " << key << " does not exist.\r";
output.close(); 
```

这是将每次写入附加到文件末尾的正确方法吗？任何可能导致整个文件被重写的想法将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T01:45:24.763

添加`fstream::app`标志。

```
output.open("output.txt", fstream::out | fstream::app); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T01:47:48.063

`fstream::out`总是覆盖文件中的数据。附加，使用模块`fstream::app`

# reporting-services - SSRS 2008 R2 - 从子报表中查找

> ID：15672786
> 
> 赞同：-1
> 
> 时间：2013-03-28T01:42:42.110
> 
> 标签：reporting-services

是否可以从子报告中查找 SSRS 2008 报告？如果是这样，有人可以告诉我怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T07:07:23.043

不，查找功能不会超出报告的范围。你的问题不是很清楚你到底想要完成什么（这会很有帮助），但我会试着猜测。

如果您希望将一些值从父数据集中传递给子报表，您可以查看[这篇关于这样做的博客文章](http://geekswithblogs.net/thomasthedeuce/archive/2009/11/13/136287.aspx)，尽管我自己没有尝试过。如果您需要在两个报告中再次使用数据集，您还可以使用共享数据集来避免重写查询。

根据[这个 msdn 社交线程](http://social.msdn.microsoft.com/forums/en-US/sqlreportingservices/thread/e1fc8e37-781e-4e96-b582-529d0befb400)，似乎无法将值从子报告传递给父报告。但是，[sqlservercentral.com 上的另一个线程](http://www.sqlservercentral.com/Forums/Topic834917-1063-1.aspx)似乎有一些承诺，但似乎并不适合所有人。再一次，我自己没有尝试过。

祝你好运，让我们知道是否有任何效果！

# networking - 回声检查是否通常用于任何现代系统？

> ID：15672798
> 
> 赞同：0
> 
> 时间：2013-03-28T01:44:24.977
> 
> 标签：networking, error-checking

我知道*回声检查*不被认为是一个好的机制。但是，我想知道今天的系统是否还在使用它？

编辑：

实际上，这是我家庭作业的一部分，但我在网上找不到太多关于这方面的资源，所以在这里问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-01T16:01:15.537

终端经常使用本地回声，但可以打开远程回声，在这个意义上是回声检查。在 telnet 上查看这篇论文：

Telnet 和 Telnet 协议（IBM 公司白皮书） [http://bandwidthco.com./whitepapers/netforensics/telnet/Telnet%20and%20the%20Telnet%20Protocol.pdf](http://bandwidthco.com./whitepapers/netforensics/telnet/Telnet%20and%20the%20Telnet%20Protocol.pdf)

# c# - DMX USB Pro(FTDI) 工作非常零散

> ID：15672800
> 
> 赞同：0
> 
> 时间：2013-03-28T01:44:42.480
> 
> 标签：c#, serial-port, ftdi, dmx512

我一直在尝试编写一个使用 Enttec DMX USB Pro 盒子将数据发送到舞台灯的 C# 应用程序。提供了我正在使用的 C# 包装器，并且我已经得到了预期的响应，但它很少起作用。我似乎必须在使用现成的应用程序和“重置”连接之间切换几次，然后我才能让它开始响应我的写入。

我的 DMX 代码是

```
class DmxDriver
{
    const int DMX_PACKET_SIZE = 513;
    private bool connected;
    private FTDI device;
    private int startAddr;

    private byte[] packet;
    public DmxDriver(int baseDmxAddr)
    {
        startAddr = baseDmxAddr;
        device = new FTDI();
        FTDI.FT_STATUS result =  device.OpenByIndex(0);
        if (result == FTDI.FT_STATUS.FT_OK)
        {
            connected = true;
            Console.WriteLine("DMX connected");
        }
        else
        {
            connected = false;
            Console.WriteLine("DMX CONNECTION FAILED");
        }

        packet = new byte[DMX_PACKET_SIZE];
        for (int i = 0; i < DMX_PACKET_SIZE; i++)
        {
            packet[i] = 0;
        }
    }

    ~DmxDriver()
    {
        device.Close();
    }

    public bool deviceConnected()
    {
        return connected;
    }
    public void sendData()
    {
        if (packet.Length != 513)
        {
            return;
        }
        uint written = 0;
        FTDI.FT_STATUS result;

        byte[] header = new byte[4];
        header[0] = 0x7E; //start code
        header[1] = 6; //DMX TX
        header[2] = 255 & 0xFF; //pack length logical and with max packet size
        header[3] = 255 >> 8; //packet length shifted by byte length? DMX standard idk

        result = device.Write(header, 4, ref written);//send dmx header

        Console.WriteLine(result);
        Console.WriteLine(written);

        result = device.Write(packet, 513, ref written);//send data array
        Console.WriteLine(result);
        Console.WriteLine(written);

        byte[] endcode = new byte[1];
        endcode[0] = 0xE7;
        device.Write(endcode, 1, ref written);//send dmx end code

    } 
```

# php - 如何使用 PHP 为用于显示图像的计数器创建一个变量？

> ID：15672801
> 
> 赞同：1
> 
> 时间：2013-03-28T01:44:54.473
> 
> 标签：php, arrays, image

每次有人加载页面时，我都会尝试显示不同的图像，我没有使用 PHP 的经验，但我真的需要这样做，这是代码，图像在我的服务器上的目录名称“imagenes”上。

```
<?php
session_start();
$counter_name = "counter.txt";

// Check if a text file exists. If not create one and initialize it to zero.
if (!file_exists($counter_name)) {
$f = fopen($counter_name, "w");
fwrite($f,"0");
fclose($f);
}

// Read the current value of our counter file
$f = fopen($counter_name,"r");
$counterVal = fread($f, filesize($counter_name));
fclose($f);

// Has visitor been counted in this session?
// If not, increase counter value by one

 $_SESSION['hasVisited']="yes";
 $counterVal++;
 $f = fopen($counter_name, "w");
 fwrite($f, $counterVal);
 fclose($f); 
 include($_SERVER['DOCUMENT_ROOT']/imagenes);

 echo "You are visitor number $counterVal to this site";
$arr1=array('1.jpg','2.jpg','3.jpg','4.jpg','5.jpg','6.jpg','7.jpg','8.jpg','9.jpg','10.jpg','11.jpg','12.jpg','13.jpg','14.jpg','15.jpg','16.jpg','17.jpg','18.jpg','19.jpg','20.jpg','21.jpg','22.jpg','23.jpg','24.jpg','24.jpg','25.jpg','26.jpg','27.jpg','28.jpg','29.jpg','30.jpg'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T01:49:01.903

根据您的操作方式，如果您真的想要显示随机图像，那么您可以这样做；

$num = rand(1, 30) //1-30之间的数字

//显示图片

```
<img src="path-to-image/<?php echo $num."jpg"; ?>"> 
```

但是，如果它必须是唯一的图像，那么您需要在 .txt 文件中添加一个字段来记录已经显示的图像；

或者您可以在顶部执行完全相同的操作，但使用 $counterVal 而不是 $num

```
<img src="cinreyesbarrandey.com/Imagenes/<?php echo $counterVal; ?>.jpg"> 
```

# excel - Stata：变量类型（8位数字）

> ID：15672802
> 
> 赞同：0
> 
> 时间：2013-03-28T01:45:09.040
> 
> 标签：excel, type-conversion, stata

```
input a
88888888
99999999
end
export excel a.xlsx, replace 
```

然后，如果我打开 excel 文件，数字显示为 8.89e+07 和 1.00e+08。我怎样才能将这些恢复到原始数字。我必须在 Excel 中执行此操作吗？有什么办法可以阻止 Stata 将这些数字转换为“科学”格式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T11:25:28.740

您的`input`命令的效果是将这些数字读入`float`类型变量。但是 a 中没有足够的位`float`来准确地保存 99999999。这是有据可查的。

参见例如帮助`data types`：

" `float`s 的精度大约为 7 位；数字的大小无关紧要。因此，1234567 可以完美地存储为`float`，1234567e+20 也可以。但是，数字 123456789 将四舍五入为 123456792。一般来说，这四舍五入没关系。

如果您要存储标识号，则四舍五入可能很重要。如果标识号为整数且不超过 9 位，则存储为`long`s；否则，将它们存储为`double`s。 `double`s 有 16 位的准确度。”

因此，您使用不适当的数据类型降低了数据质量。那是问题，不是`export excel`。

# c++ - C++ 交换指针

> ID：15672805
> 
> 赞同：18
> 
> 时间：2013-03-28T01:45:14.180
> 
> 标签：c++, pointers

我正在研究一个交换指针的函数，但我不知道为什么这不起作用。当我在交换函数中打印出 r 和 s 时，值被交换，这让我相信我正在操作一个我不理解的副本，因为我通过引用 p 和 q 传递。

```
void swap(int *r, int *s)
{
    int *pSwap = r;
    r = s;
    s = pSwap;
    return;
}

int main()
{
    int p = 7;
    int q = 9;  
    swap(&p, &q);
    cout << "p = " << p << "q= " << q << endl;
    return 0;
} 
```

打印：p = 7q = 9

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-03-28T01:54:57.930

在你的`swap`函数内部，你只是改变指针的方向，即改变指针指向的对象（这里，特别是对象的地址`p`和`q`）。指针指向的对象根本没有改变。

你可以`std::swap`直接使用。或者像下面这样编写你的交换函数：

```
void swap(int *r, int *s)
{
   int temp = *r;
   *r = *s;
   *s = temp;
   return;
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2018-07-18T17:59:01.080

taocp 接受的答案也没有完全交换指针。以下是交换指针的正确方法。

```
void swap(int **r, int **s)
{
    int *pSwap = *r;
    *r = *s;
    *s = pSwap;
}

int main()
{
    int *p = new int(7);
    int *q = new int(9);

    cout << "p = " << std::hex << p << std::endl;
    cout << "q = " << std::hex << q << std::endl << std::endl;

    swap(&p, &q);

    cout << "p = " << std::hex << p << std::endl;
    cout << "q = " << std::hex << q << std::endl << std::endl;

    cout << "p = " << *p << " q= " << *q << endl;
    return 0;
} 
```

我机器上的输出：

```
p = 0x2bf6440
q = 0x2bf6460

p = 0x2bf6460
q = 0x2bf6440

p = 9 q= 7 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T01:57:42.143

该行`r=s`正在将指针的副本设置为指针`r`的副本`s`。

相反（如果你不想使用 std:swap）你需要这样做

```
void swap(int *r, int *s)
{
    int tmp = *r;
    *r = *s;
    *s = tmp;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-28T02:07:34.730

您传递了对您的值的引用，这些引用不是指针。因此，编译器会创建临时`(int*)`的 's 并将它们传递给函数。

想想什么`p`和`q`是：它们是变量，这意味着它们是分配在内存中某处的插槽（在堆栈上，但这在这里并不重要）。您可以在什么意义上谈论“交换指针”？这不像您可以交换插槽的地址。

您可以做的是交换保存实际地址的两个容器的值 - 这些是指针。

如果你想交换指针，你必须创建指针变量，并将它们传递给函数。

像这样：

```
int p = 7;
int q = 9;

int *pptr = &p;
int *qptr = &q;
swap(pptr, qptr);
cout << "p = " << *pptr << "q= " << *qptr << endl;
return 0; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-28T02:19:54.103

在您的示例中，您没有通过引用传递。这个版本通过引用，

```
void swap2(int &r, int &s)
{
    int pSwap = r;
    r = s;
    s = pSwap;
    return;
}

int main()
{
    int p = 7;
    int q = 9;
    swap2(p, q);
    cout << "p = " << p << "q= " << q << endl;
    return 0;
} 
```

通过引用传递与通过值或指针传递不同。有关说明，请参阅 Web 上的 C++ 教程。我的大脑太小了，不能浪费细胞来存储我可以在网上轻松找到的细节。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-03-29T09:39:07.857

问题是范围的变化。下一个函数适用于任何类型的指针。

```
void swapPointers(void* ptrA, void* ptrB){
    void* swapPtr = *(void**)ptrA;
    *(void**)ptrA = *(void**)ptrB;
    *(void**)ptrB = swapPtr;
}

int main(){
    int a = 5;
    int b = 6;
    int* ptra = &a;
    int*ptrb = &b;
    swapPointers(&ptra, &ptrb);
} 
```

# java - 如何在我的程序中为随机数分配字符串值

> ID：15672811
> 
> 赞同：3
> 
> 时间：2013-03-28T01:46:45.413
> 
> 标签：java, if-statement, random

正如标题所示，我正在做一个老虎机的家庭作业程序。我四处搜索，我很满意该程序对我来说足够正确。我遇到的问题是在生成随机数之上，我应该为数字 1-5（樱桃、橙子、李子、铃铛、甜瓜、酒吧）分配值。然后我要在程序运行时显示输出而不是数字。谁能让我指出如何做到这一点的正确方向？

```
import java.util.Random;
import java.util.Scanner;

public class SlotMachineClass {

public static void main(String[] args) {

    Scanner input = new Scanner(System.in);

    int Coins = 1000;
    int Wager = 0;

    System.out.println("Steve's Slot Machine");
    System.out.println("You have " + Coins + " coins.");
    System.out.println("Enter your bet and press Enter to play");

    while (Coins > 0)
    {
    int first = new Random().nextInt(5)+1;
    int second = new Random().nextInt(5)+1;
    int third = new Random().nextInt(5)+1;

    Wager = input.nextInt();

    if(Wager > Coins)
             Wager = Coins;

    System.out.println(first + " " + second + " " + third);

    if(first == second && second == third)
    { Coins = Coins + (Wager * 3);
         System.out.println("You won " + (Wager * 3) + "!!!!" + " You now have " + Coins + " coins.");
         System.out.println("Enter another bet or close program to exit");}

    else if((first == second && first != third) || (first != second && first == third) || (first != second && second == third))
    { Coins = Coins + (Wager * 2);
         System.out.println("You won " + (Wager * 2) + "!!!" + " You now have " + Coins + " coins.");
         System.out.println("Enter another bet or close program to exit");}

    else {Coins = Coins - Wager;  
    System.out.println("You Lost!" + "\nPlay Again? if so Enter your bet.");}

    }

    while (Wager == 0)
    {
        System.out.println("You ran out of coins. Thanks for playing."); 
    }

} 
```

}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T01:52:08.600

如果你有一个`int`并且想要一些`String`与之相关的，有几种方法可以做到这一点。

第一个是有一个字符串数组并查找它们。

```
public static String[] text = new String[] {"Cherry", "Bell", "Lemon", "Bar", "Seven"};
public String getNameForReel(int reelValue) {
    return text[reelValue];
}
// And to call it...
System.out.println(getNameForReel(first)); //etc... 
```

或者，您可以在 switch 语句中执行此操作（我不喜欢这样做，但您可能会这样做）：

```
public String getNameForReel(int reelValue) {
    switch(reelValue) {
       case 0: return "Cherry";
       case 1: return "Bell";
       case 2: return "Lemon";
       case 3: return "Bar";
       case 4: return "Seven";
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-28T01:54:26.490

您需要一个查找表：

```
String[] text = new String[] {"Cherry", "Bell", "Lemon", "Bar", "Seven"}; 
```

然后你可以做

```
System.out.println(text[first] + " " + text[second] + " " + text[third]); 
```

无需创建更多方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T01:53:07.787

创建一个数组：

```
String[] s = {Cherries, Oranges, Plums, Bells, Melons, Bars}; 
```

然后你可以打印`s[num-1]`而不是`num`（其中 num 是随机整数）。例如，如果您的随机 int 为 2，则打印 s[2-1] 即 s[1]，这将是橙色。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-28T02:23:45.083

新程序员最有可能在介绍课程中使用的非数组解决方案是嵌套的 if-else：

```
String fruitToPrint = "";
if (num == 0)
   fruitToPrint = "Cherries";
else if (num == 1)
   fruitToPrint = "Oranges";
else if (num == 2)
   fruitToPrint = "Plums";
else if (num == 3)
   fruitToPrint = "Bells";
else if (num == 4)
   fruitToPrint = "Melons";
else if (num == 5)
   fruitToPrint = "Bars";
else
   System.out.println("Couldn't assign fruit from num=" + num);

System.out.println("The corresponding fruit was " + fruitToPrint); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-28T02:30:38.930

这是我认为遵循最佳编程实践的问题的替代解决方案。对于您的分配，这可能比数组更不允许，并且将是您在 StackOverflow 上得到答案的一个致命的赠品，但问题将有助于使用`enum`带有`int`->`enum`映射的类型：

```
enum Fruit {
   Cherries(1), 
   Oranges(2), 
   Plums(3), 
   Melons(4), 
   Bars(5);

   private static final Map<Integer, Fruit> lookupMap = new HashMap<Integer, Fruit>();
   static {
      for (Fruit fruit : Fruit.values()) {
         lookupMap.put(fruit.getLookup());
      }
   }

   static Fruit fromLookup(int lookup) {
      return lookupMap.get(lookup);
   }

   private final int lookup;       

   private Fruit(int lookup) {
      this.lookup = lookup;
   }

   int getLookup() {
      return lookup;
   }
}

void printEnumExample() {
   int fruitToPrint = 4;
   System.out.println(Fruit.fromLookup(fruitToPrint)); // <- This will print "Melons"
} 
```

# c++ - 链表的析构函数

> ID：15672812
> 
> 赞同：0
> 
> 时间：2013-03-28T01:46:49.403
> 
> 标签：c++, linked-list, destructor

我有一个linked_list，目前我的析构函数不能正常工作。不完全确定为什么。有人可以解释我如何解决这个问题吗？

```
class linked_list {
 private:

struct node
{
    // String in this node
    std::string data;

    // Pointer to next node
    struct node *next;
};

//First item in the list
struct node *first; 
```

这是我的析构函数

```
linked_list::~linked_list(void)
{
while (first)
{
    delete first;
    first = first->next;
}
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-28T01:48:10.380

问题出在这里：

```
delete first;
first = first->next; 
```

当你删除`first`的时候，然后尝试访问`first->next`。缓存`first->next`到 type 的临时变量中`node*`，然后`delete first`修复此问题：

```
struct node* temp;
while (first != NULL)
{
    temp = first->next;
    delete first;
    first = temp;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-28T01:51:39.867

改成

```
 linked_list::~linked_list(void)
{
struct node *next;
while (first != NULL)
{
    next = first->next;
    delete first;
    first = next;
}
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-15T05:45:57.663

当您首先“删除”时，实际上是从其中清除了所有链接。现在，如果您尝试使用它访问其他节点，将不会产生所需的结果。

首先，您必须使用其他指针指向该节点，以便您仍然有一些链接可以稍后访问。

# prolog - 为什么这个简单的序言函数失败了？

> ID：15672822
> 
> 赞同：0
> 
> 时间：2013-03-28T01:48:05.303
> 
> 标签：prolog

我在 Prolog 中编写了一些简单的父/父/祖先函数。除了祖先，一切都很好。像这样 ...

```
?- parent(abe,homer).
true.

?- parent(homer,bart).
true.

?- ancestor(abe,bart).
false. 
```

为什么我的祖先（abe，bart）返回错误？这是我的功能……

```
%% returns true is X is an ancestor of Y, otherwise returns false
ancestor(X,Y) :-
  parent(X,Z),
  ancestor(Z,Y). 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T02:07:35.013

您需要做的就是将其添加到数据库中，

```
ancestor(A, B) :- parent(A, B). 
```

因为孩子的父母也是祖先。

# html - 菜单栏的 W3 验证错误

> ID：15672825
> 
> 赞同：0
> 
> 时间：2013-03-28T01:48:29.177
> 
> 标签：html, validation, dreamweaver

在我的网站 goblinnightvision.com 上，我遇到了几个我不明白的 w3 验证错误。我希望你们中的一些专家能给我一些帮助。下面我列出了一些我得到的验证错误：

第 60 行，第 13 列：文档类型不允许在此处使用元素“br”；假设缺少“li”开始标签

第 63 行，第 32 列：文档类型在此处不允许元素“li”；缺少“ul”、“ol”、“menu”、“dir”开始标签之一

*   晚上……</p>

    第 66 行，第 12 列：省略了“li”的结束标记，但指定了 OMITTAG NO

    第 60 行，第 8 列：开始标签在这里

    问候杰夫

    好的，当然，如果没有我现在复制到此消息中的代码，您就不能说太多。我希望你能告诉我我做错了什么。

    亲爱的麦克斯，

    感谢您对此的帮助。关于这些错误，我已经复制了菜单栏的一部分，也许这对你有意义，因为它对我来说仍然没有意义。当然，我是这方面的新手；-)

    ```
     <ul>

                    <li> <a href="index.html">Home</a> <!-- Hovedpunkt -->
                  </li>
                  <!-- end main LI -->
              </ul> <!-- end main UL -->

                <ul>

                    <li> <a href="#">About nightvision</a> <!-- Hovedpunkt -->

                        <ul>

                            <li><a href="what_is_night_vision.html">what is night vision</a></li>
                            <br /> <!-- Underpunkt -->
                            <li><a href="uses_of_nightvision.html">Uses of Night Vision</a></li>
                            <br /> <!-- Underpunkt -->
                            <li><a href="all_our_night_vision_videos.html">Night Vision Videos</a></li>
                            <br /> <!-- Underpunkt -->

                      </ul> <!-- end inner UL -->

                  </li> <!-- end main LI -->

        </ul> <!-- end main UL --> 
    ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T17:23:07.197

我只是再次偶然发现了这个链接，我不太确定你是否已经弄清楚了，但我们开始吧。我想我个人拥有我认为您需要的东西，所以我将分享我拥有的东西。我还假设您需要一个下拉菜单，该下拉菜单只能通过我将提供给您的一些 CSS 来获得。

HTML：

```
 <div id="dropnav">
          <ul class="navbar">
             <li><a href="/index.html">Home</a></li>
             <li><a href="#.html">#</a>
                <ul>
                   <li><a href="#.html">#</a></li>
                   <li><a href="#.html">#</a></li>

                </ul>         
             </li>
             <li><a href="#.html">#</a>
                <ul>
                   <li><a href="#.html" >#</a></li>
                    <li><a href="#.html" >#</a></li>

                </ul>         
             </li>
             <li><a href="#.html">#</a>
                <ul>
                   <li><a href="#.html">#</a></li>

                </ul>         
             </li>
             <li><a href="#.html">#</a>
                <ul>
                   <li><a href="#.html">#</a></li>

                </ul>         
             </li>
             <li><a href="#.html">#</a>
                <ul>
                   <li><a href="#.html">#</a></li>
                   <li><a href="#.html">#</a></li>

                </ul>  

          </ul>
</div> 
```

CSS：

```
#dropnav    {
    width: 100%; /* Spans the width of the page */
    height: 50px; 
    padding-bottom: 10px;
    margin: 0; /* Ensures there is no space between sides of the screen and the menu */
    z-index: 1; /* Makes sure that your menu remains on top of other page elements */
    position: relative;
    background-color: rgba(0, 0, 0, 0.00);
    }
.navbar {
    height: 50px;
        padding: 0;
        padding-bottom: 10px;
    margin: 0;
    position: absolute; /* Ensures that the menu doesn’t affect other elements */
    border-right: 1px solid #54879d; 
    }
.navbar li  {
    padding-bottom: 10px;
            height: auto;
            width: 150px;  /* Each menu item is 150px wide */
            float: left;  /* This lines up the menu items horizontally */
            object-position: top;
            text-align: center;  /* All text is placed in the center of the box */
            list-style: none;  /* Removes the default styling (bullets) for the list */
            font: normal bold 12px/1.2em Arial, Verdana, Helvetica;  
            padding: 0;
            margin: 0;
            background-color: rgba(0, 0, 0, 0.00);
                        }
.navbar a   {                           
        padding: 18px 0;  /* Adds a padding on the top and bottom so the text appears centered vertically */
        border-left: 1px solid #000; /* Creates a border in a slightly lighter shade of blue than the background.  Combined with the right border, this creates a nice effect. */
        border-right: 1px solid #000; /* Creates a border in a slightly darker shade of blue than the background.  Combined with the left border, this creates a nice effect. */
        text-decoration: none;  /* Removes the default hyperlink styling. */
        color: white; /* Text color is white */
        display: block;
        }

.navbar li:hover, a:hover {
    background-color: rgba(0, 0, 0, 0.00);
}

.navbar li ul   {
        display: none;  /* Hides the drop-down menu */
        height: auto;                                   
        margin: 0; /* Aligns drop-down box underneath the menu item */
        padding: 0; /* Aligns drop-down box underneath the menu item */         
        }               

.navbar li:hover ul     {
                        display: block; /* Displays the drop-down box when the menu item is hovered over */
                        }

.navbar li ul li {
    background-color: #808080;
}

.navbar li ul li a  {
        border-left: 1px solid #808080;
        border-right: 1px solid #808080;
        border-top: 1px solid #808080;
        border-bottom: 1px solid #808080;
        }

.navbar li ul li a:hover {
    background-color: #9a9a9a;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T05:30:01.240

让我们从这个开始：

```
Line 63, Column 32: document type does not allow element "li"
here; missing one of "ul", "ol", "menu", "dir" start-tag. 
```

这基本上是说你不能有一个`<li>`没有`<ul>, <ol>`标签（你需要指定它是什么类型的列表）。

```
Line 66, Column 12: end tag for "li" omitted, but OMITTAG NO was specified 
```

这意味着您有一个结束`<li>`标签，但没有开始一个。

```
Line 60, Column 13: document type does not allow element "br" here; 
assuming missing "li" start-tag 
```

我不完全确定这个，但我认为它是说你不应该放置一个`<br />`内部`<li>`元素，因为这些`<li>`项目无论如何都放在单独的一行上。

```
Line 60, Column 8: start tag was here 
```

这个，我不知道是否没有代码可以使用。

希望这有帮助。

# java - 根据调用堆栈有条件地禁用记录器

> ID：15672827
> 
> 赞同：0
> 
> 时间：2013-03-28T01:48:49.903
> 
> 标签：java, log4j

我有一个 Web 服务，其中有几个其他 Web 服务作为依赖项。其中一个依赖项是我每 15 秒发送一次不重要的小数据位的服务。我每 10 分钟向另一个依赖项发送重要的数据。我希望看到每 10 分钟发生一次的呼叫的日志行，而不是每 15 秒发生的呼叫（这使我的日志非常嘈杂）。

问题是两个调用都是使用相同的第三方类进行的：httpclient。日志行如下所示：

```
27 Mar 2013 18:14:54,001 [DEBUG]  (main) httpclient.wire.content: blah blah blah 
```

我尝试过使用[NDC](http://logging.apache.org/log4j/1.2/manual.html#Nested_Diagnostic_Contexts)，但不知道如何根据堆栈顶部的诊断上下文配置我的记录器阈值。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T02:06:26.607

将 httpclient.wire.content 记录器级别至少设置为 WARN 并在发送重要数据之前进行日志调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T02:17:49.470

如果您想在使用重要数据拨打电话后打开/关闭日志记录或更改日志级别，您可以执行以下操作

```
LogManager.getLogger(Class.forName("httpclient.wire.content"))‌​.setLevel(Level.OFF); 
```

更改类的级别应该更改该特定类的日志记录。

仅供参考 -`LogManager.getCurrentLoggers();`应该返回所有记录器

# javascript - 设置全局变量并在 jquery/javascript 中访问它

> ID：15672829
> 
> 赞同：2
> 
> 时间：2013-03-28T01:48:51.777
> 
> 标签：javascript, jquery, variables, global-variables

我在创建全局变量并通过 jquery 重置它时遇到问题。这是我的代码

```
var x = 1;
$(document).ready(function () {
    $("#button").click(function () {
        if(x === 1) {
            alert("test1");
            var x = 2;
        } else if(x === 2) {
            alert("test2");
            var x = 3;
        } else {
            alert("test 3");
        }
    });
}); 
```

我希望能够单击同一个按钮三次并显示所有测试，但它直接进入最后一个选项`"test 3"`。如果这是一个愚蠢的问题，我深表歉意，但我对 jquery 和 javascript 有点陌生。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T01:50:14.980

只需`var`从点击事件回调中的变量赋值中删除。`var`使变量成为该范围/闭包的本地变量。

```
 if (x === 1) {
      alert("test1");
      x = 2;
  }
  else if (x === 2) {
      alert("test2");
      x = 3;
  }
  else {
      alert("test 3");
  } 
```

顺便说一句，第一个`var`不是必需的，当代码不在闭包/函数中时，它会做同样的事情`var x = 1`。`x = 1`他们所做的只是分配`window.x = 1`。

# salesforce - 使用自定义按钮更新标准 Salesforce 对象

> ID：15672830
> 
> 赞同：1
> 
> 时间：2013-03-28T01:48:53.183
> 
> 标签：salesforce

我正在尝试更新标准 salesforce 合同对象的状态字段。由于我们使用的是自定义布局，因此最好在顶部简单地放置一个按钮来完成此操作。我尝试使用以下描述的方法：[http ://sfdc.arrowpointe.com/2009/01/08/invoke-apex-from-a-custom-button-using-a-visualforce-page/](http://sfdc.arrowpointe.com/2009/01/08/invoke-apex-from-a-custom-button-using-a-visualforce-page/)

但是我的实现出现错误：java.lang.IllegalArgumentException: Illegal view ID cancel。ID 必须以 / 开头

有没有人能够在不涉及实现细节的情况下帮助这个设计？有没有更简单的方法来实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T00:31:43.373

一种更简单的方法是直接在自定义按钮中使用[AJAX 工具包，而不是使用 Apex。](http://www.salesforce.com/us/developer/docs/ajax/)也就是说，它会是这样的：

```
{!REQUIRESCRIPT("/soap/ajax/13.0/connection.js")}

var contractObj = new sforce.SObject("Contract");
contractObj.Id='{!Contract.Id}';
contractObj.Status='Your New Status Value Here';
var result=sforce.connection.update([contractObj]);

if (result[0].success=='false') {
    alert(result[0].errors.message);
} else {
    location.reload(true);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T03:02:11.373

> 但是我的实现出现错误：java.lang.IllegalArgumentException: Illegal view ID cancel。ID 必须以 / 开头

这几乎肯定是您的控制器操作方法返回的对象的问题。

示例方法`autoRun()`返回一个 PageReference。你的方法返回什么？它应该是 PageReference 或 null。

# android - SharedPreferences 是否在 Eclipse 模拟器中工作？

> ID：15672831
> 
> 赞同：0
> 
> 时间：2013-03-28T01:48:57.757
> 
> 标签：android, sharedpreferences

我正在尝试使用 SharedPreferences 保存用户 ID。保存为 SharePreferences 的值是否会在我的应用程序中的所有活动中持续存在，以便我可以从任何应用程序访问用户 ID？下面是我保存用户标识的代码。

```
 userid = result.substring(3, result.length());
                Log.d("userid at onpostexecute", userid);
                SharedPreferences.Editor editor = getPreferences(MODE_PRIVATE).edit();  // to update userid
                editor.putString("userid", userid);
                editor.commit(); 
```

这是在另一个活动中从 SharedPreferences 访问用户 ID 的代码。

```
 SharedPreferences prefs = getPreferences(MODE_PRIVATE);  // to access userid
        String userid = prefs.getString("userid", "");
        Log.d("shared prefs userid", userid); 
```

奇怪的是，上面的代码在我的 onCreate 方法中，但它没有显示在 Logcat 中，即使在这段代码之前和之后显示了其他日志数据。那么我的代码是否有问题，我什至无法让它显示在我的 logcat 中？我什至无法判断它是否正在更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T01:59:38.250

我假设你的意思是你可以从任何地方访问它们`Activity`，是的，即使你离开你的应用程序并回来，它们也会持续存在。[从文档](http://developer.android.com/guide/topics/data/data-storage.html)

> SharedPreferences 类提供了一个通用框架，允许您保存和检索原始数据类型的持久键值对。您可以使用 SharedPreferences 保存任何原始数据：布尔值、浮点数、整数、长整数和字符串。此数据将在用户会话中持续存在（即使您的应用程序被终止）。

如果这`Log.d("userid at onpostexecute", userid);`甚至没有出现，那么我会在那里放置一个断点并确保你有一个`userid`. 我还会检查您的 logcat 过滤器以确保您获得所有日志。只需确保微调器中的类型设置为“详细”即可

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T01:59:55.217

如果您告诉它，保存为 sharedPreferences 的值可以在活动之间共享。现在，您正在创建一个只能由同一活动访问的首选项。你需要使用：

```
SharedPreferences preferences = PreferenceManager.getDefaultSharedPreferences(context);
SharedPreferences.Editor editor = preferences.edit(); 
```

像这样，您正在您的应用程序之间创建一个 sharedPreference 。在另一个问题的已接受答案中有很多关于该主题的解释。[问题链接](https://stackoverflow.com/questions/2614719/how-do-i-get-the-sharedpreferences-from-a-preferenceactivity-in-android) 正如答案中所讨论的，您用于保存首选项的方式仅适用于保存它的同一活动。

# knockout.js - 淘汰赛渲染的全局拦截？

> ID：15672832
> 
> 赞同：0
> 
> 时间：2013-03-28T01:49:01.070
> 
> 标签：knockout.js

我正在尝试获取一个使用敲除的网页并将 JQuery UI 日期选择器应用于所有日期字段（使用 HTML5 输入类型），因为有问题的浏览器不自动支持新类型。我已经看到了可以手动应用于元素的自定义绑定。但我希望能够在全球范围内应用这种行为，而不必单独处理每个模板。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T15:22:55.020

促进[小提琴](http://jsfiddle.net/tyrsius/3W28V/1)的评论回答。

```
$('[datepicker][data-bind]').each(function (i) {
        console.log($(this).attr("data-bind"));
        var attr = $(this).attr("data-bind").replace("value", "datepicker");
        $(this).attr("data-bind", attr);
      }); 
```

# r - 使用旧矩阵值作为指数在 R 中创建新矩阵

> ID：15672834
> 
> 赞同：1
> 
> 时间：2013-03-28T01:49:05.163
> 
> 标签：r, matrix

如果我有一个矩阵 mat1

```
 [,1] [,2] [,3]
[1,]    1    3    5
[2,]    2    4    6 
```

可以通过一个非常简单的命令将所有单个值平方

```
mat1 * mat1

     [,1] [,2] [,3]
[1,]    1    9   25
[2,]    4   16   36 
```

现在，我想做的是创建一个新矩阵，其中所有值都由 ) 计算，`e^(old_value`例如 、`e^1`等。我怎样才能做到这一点？`e^2``e^3`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:51:04.123

`exp`计算指数函数

```
> mat1 <- matrix(1:6, nrow=2)
> exp(mat1)
         [,1]     [,2]     [,3]
[1,] 2.718282 20.08554 148.4132
[2,] 7.389056 54.59815 403.4288 
```

# php - SQL全文搜索与空输入的不同组合，使用PHP

> ID：15672837
> 
> 赞同：0
> 
> 时间：2013-03-28T01:49:38.270
> 
> 标签：php, mysql, search, parameters, full-text-search

假设我的 SQL 表有列`Title`, `Price`，`YearsOld`并且我想使用来自 html 页面的输入表单来搜索匹配的结果。

我希望用户能够将他们希望的任何输入表单留空。因此，如果他们将所有字段留空，它将返回每个条目。如果他们`Title`留空但输入 a`maxPrice`然后它将显示所有价格和`maxAge`年龄低于他们提交的项目，无论标题如何。`maxPrice``maxAge`

我是否必须使用 if 语句考虑空白/非空白字段条目的每个组合？还是有更好的方法来做到这一点？

例如，我想避免看起来像这样的代码：

```
 if($_POST['titleSearch' == "") {
    if($_POST['maxAge'] == NULL) {
        if($_POST['maxPrice'] == NULL) {
            $query = $conn->prepare("SELECT * FROM table");
    }
    else if($_POST['maxAge'] != NULL) {
        if($_POST['maxPrice'] == NULL) {
            $query = $conn->prepare("SELECT * FROM table 
                WHERE age <  $_POST['maxAge'])";
        }

      # etc etc etc

    }
} 
```

任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T02:16:50.677

更有效的方法是：

```
$tSet = strlen($_POST['titleSearch']);
$aSet = strlen($_POST['maxAge']);

if(!$tSet && !$aSet){
    $query = $conn->prepare("SELECT * FROM table");
} else if ($tSet && !$aSet){
    $query = $conn->prepare("SELECT * FROM table WHERE title=" . $_POST['titleSearch']);
} 
```

# ruby-on-rails - Rails：通过关联删除多态 STI has_many 失败

> ID：15672838
> 
> 赞同：0
> 
> 时间：2013-03-28T01:49:50.520
> 
> 标签：ruby-on-rails, activerecord, has-many, polymorphic-associations, sti

我有一个名为 User 的模型，它有许多通过分类模型关联的“分类法”。其中一种分类法是称为 Topic 的模型（继承自分类法）。我的模型用户也称为“可分类”。

*编辑：添加了更多模型来澄清问题*

```
class User < ActiveRecord::Base
  has_many :classifications, :as => :classifiable, :foreign_key => :classifiable_id
  has_many :topics, :through => :classifications, :source => :taxonomy, :source_type => "Topic"
end

class Taxonomy < ActiveRecord::Base
end

class Topic < Taxonomy
  has_many :classifications, :as => :taxonomy, :foreign_key => :taxonomy_id, :source_type => "Topic"
  has_many :professionals, :through => :classifications, :source => :classifiable, :source_type => "User", :conditions => {:is_a_professional => true}
  has_many :questions,     :through => :classifications, :source => :classifiable, :source_type => "Question"
  has_many :guides,        :through => :classifications, :source => :classifiable, :source_type => "Guide"
end

class Classification < ActiveRecord::Base
  attr_accessible :classifiable, :classifiable_id, :classifiable_type,
                  :taxonomy, :taxonomy_id, :taxonomy_type

  belongs_to :classifiable, :polymorphic => true
  belongs_to :taxonomy,     :polymorphic => true
end 
```

除非我想删除关联，否则一切正常。

```
user = User.find(12) # any user
topic = user.topics.last # any of his topics
user.topics.delete(topic) 
```

SQL ActiveRecord 运行如下：

```
DELETE FROM "classifications" WHERE "classifications"."classifiable_id" = 12 AND "classifications"."classifiable_type" = 'User' AND "classifications"."taxonomy_id" = 34 AND "classifications"."taxonomy_type" = 'Taxonomy' 
```

显然，taxonomy_type 是错误的，它应该是“Topic”而不是“Taxonomy”。

由于我使用的是多态关联和 STI，因此我必须这样配置 ActiveRecord：

```
ActiveRecord::Base.store_base_sti_class = false 
```

但是，它似乎不会在 collection.delete 上触发。这是rails的错误吗？

# sql - 参数数据类型 varchar 对 EncryptByKey 函数加密的参数 3 无效

> ID：15672840
> 
> 赞同：1
> 
> 时间：2013-03-28T01:50:02.497
> 
> 标签：sql, sql-server, encryption

我目前正在进行评估并且在 SQL 加密方面遇到了一些麻烦，我需要在注册时加密其中三个列，它们是 varchar，但随后需要将它们转换为 varbinary 以进行 AES_256 加密。我已经设置了密钥和证书，这只是我目前需要帮助的 T SQL。

```
CREATE PROCEDURE dbo.Register
@Email nvarchar (60),
@Password varbinary (256),
@Fname varchar (24),
@Lname varchar (24),
@DoB date,
@HomePhoneNo nvarchar (20),
@MobileNo nvarchar (20),
@SecretQuestion1 varbinary (256),
@SecretQuestion2 varbinary (256)
AS
BEGIN
IF EXISTS (SELECT @Email FROM Customers.Customers)
DROP PROCEDURE dbo.Register
ROLLBACK

OPEN SYMMETRIC KEY Password_Key_DB
        DECRYPTION BY CERTIFICATE PasswordEncryption
        SET NOCOUNT ON
INSERT INTO Customers.Customers
VALUES 
(
@Email, 
ENCRYPTBYKEY(Key_GUID('Password_Key_DB'), @Password, CONVERT (varchar, @Password)),
@Fname, 
@Lname, 
@DoB,
@HomePhoneNo, 
@MobileNo,
ENCRYPTBYKEY(Key_GUID('Password_Key_DB'), @SecretQuestion1, CONVERT (varchar,                 @SecretQuestion1)),
ENCRYPTBYKEY(Key_GUID('Password_Key_DB'), @SecretQuestion2, CONVERT (varchar,     @SecretQuestion2))
)
END
GO 
```

# c# - 将文件名保存到sql数据库并同时运行ssis包

> ID：15672844
> 
> 赞同：6
> 
> 时间：2013-03-28T01:50:14.297
> 
> 标签：c#, asp.net, sql, ssis, sql-server-2008-r2

场景：我正在开发一个 Web 应用程序，它允许用户将 Excel 文件上传到 SQL Server 2008 R2 数据库中各自的表中。当用户单击上传按钮时，我还在运行使用 SSIS 开发的 ETL 流程。

我的开发环境：Asp.net、IIS7、C#、SQL Server 2008 R2

我目前面临将文件的文件名保存到表格中的另一列的问题，因为我还将为用户创建 gridview 功能，以查看已经上传到数据库中的文件并使用户能够下载错误文件。

问题：在 ETL 过程中运行 SSIS 包时，有什么方法可以将文件名保存到相同的表中？

以下是我的代码示例：

```
string filePath1 = Server.MapPath(System.IO.Path.GetFileName(file.FileName.ToString()));
file.SaveAs(filePath1);

package = app.LoadPackage(packageString, null);
package.Connections["Excel Connection Manager"].ConnectionString = @"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + filePath1 + ";Extended Properties=Excel 12.0;HDR=YES;IMEX=1";
Microsoft.SqlServer.Dts.Runtime.DTSExecResult results = package.Execute(); 
```

此方法允许我检索 fileName ：

```
String.Format("File : {0} uploaded.", file.FileName) 
```

那么当我执行包时，如何同时将文件名保存到表中呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T14:44:51.733

```
 string connectionString = DAO.GetConnectionString(); 
SqlConnection sqlConn = new SqlConnection(connectionString);
 sqlConn.Open() 
strQuery = "update uploadSummaryDB set fileName = @fileName where id in (select max(id) from uploadSummaryDB)"; 
SqlCommand command = new SqlCommand(strQuery,sqlConn); 
command.Parameters.Add("@fileName", SqlDbType.NVarChar).Value = file.FileName.ToString(); command.ExecuteNonQuery(); 
```

# javascript - 查询嵌套的 JSON 对象

> ID：15672846
> 
> 赞同：0
> 
> 时间：2013-03-28T01:50:27.060
> 
> 标签：javascript, ajax, json, dom

我是 javascript 和 json 的新手，找不到任何解释如何获取嵌套 json 对象的示例。

这很好用：

```
var someJson={"name":"spuder"};
alert(someJson.name);
//alert shows spuder 
```

这将返回未定义：

```
//This is the json from the stream I am reading
var someJson={"name":"spuder","car":[{"model":"ford","year":"2000"}] };
alert(?????); 
```

你如何返回 spuders 车型或车年？

```
alert(someJson.car.model); //doesn't work.. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T02:01:52.427

您已经创建了您`car`的数组。获取数组中第一辆车的型号：

```
alert(someJson.car[0].model); 
```

[http://jsfiddle.net/YUrRg/](http://jsfiddle.net/YUrRg/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T01:52:19.480

您在 someJson 对象中创建了一个数组而不是一个对象。此外，您的撇号从 2000 年开始，但以引号结束。

```
var someJson={"name":"spuder","car":{"model":"ford","year":"2000"}};
alert(someJson.car.model); 
```

# ajax - 406 不可接受：Spring 3.2 + JSON + AJAX

> ID：15672848
> 
> 赞同：3
> 
> 时间：2013-03-28T01:50:32.653
> 
> 标签：ajax, json, jquery, spring-mvc

搜索了大量的网站，甚至是 stackoverflow，但还没有找到解决这个问题的方法。看起来很多人都遇到过这个问题，但它似乎缺少一个涵盖所有方面的统一解决方案。已经花了1.5天了。

我看到该方法正在被调用，但某处`@ResponseBody`没有正确翻译。有人可以看看，让我知道问题是什么。我已经在github上上传了代码。[链接到github上的源代码](https://github.com/hth/StatusInvoke)

```
@RequestMapping(value = "/find_user", method = RequestMethod.GET)
public @ResponseBody List<String> findUser(@RequestParam("term") String name) {
    log.info("Search string for user name: " + name);   
    List<String> users = new ArrayList<String>();
    users.add("Sam");
    users.add("Dan");
    return users;
} 
```

下面的浏览器屏幕截图带有 406 响应

![在此处输入图像描述](../Images/8fd3d49145bf656ec0640884dc04f853.png)

**请注意：啊！多么痛苦。此设置适用于 Spring 3.1.4 而不适用于 3.2.X**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-28T06:32:38.523

天哪，差点要了我的命。我尽我所能，仍然卡在那里。但最后我想通了。原因是Spring，下载Spring 3.1.1，将所有jar替换为3.1.1jar，就可以了。你所有的配置都很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-25T10:43:30.703

我也遇到了同样的问题。在调试 Spring 之后，我发现它`ServletPathExtensionContentNegotiationStrategy`试图根据 URL 中的扩展来确定媒体类型。（可能是因为它无法推断它应该从`Accept`包含`*/*`在我的案例中的标头返回什么媒体类型。）

因此，解决此问题的方法之一是通过替换来重命名映射中的`.html`URL `.json`。

# c++ - 在代码块中测试 glut.h 错误

> ID：15672849
> 
> 赞同：0
> 
> 时间：2013-03-28T01:50:47.040
> 
> 标签：c++, opengl, codeblocks, glut, pragma

尝试使用 glut 构建项目时出现错误。不在 main.cpp 中，而是在我包含的 glut.h 中。

```
#pragma comment (lib, "winmm.lib")     /* link with Windows MultiMedia lib */
#pragma comment (lib, "opengl32.lib")  /* link with Microsoft OpenGL lib */
#pragma comment (lib, "glu32.lib")     /* link with OpenGL Utility lib */
#pragma comment (lib, "glut32.lib")    /* link with Win32 GLUT lib */

#pragma warning (disable:4244)  /* Disable bogus conversion warnings. */
#pragma warning (disable:4305)  /* VC++ 5.0 version of above warning. */ 
```

所有这些行都是在描述中显示错误的行：警告：忽略 #pragma 警告 [-Wunkown-pragmas]

所有这些行都是相同的错误。

我还在 glut.h 文件中遇到了一个额外的错误。它上线了：

```
typedef unsigned short wchar_t; 
```

此错误内容为：错误：重新声明内置 C++ 类型“wchar-t”[-fpermissive]

任何知道我应该如何解决这个问题的人。链接似乎很好，因为它意识到 glut.h 文件存在，但 glut.h 是提供错误的文件。

# jquery - jQuery 循环。前一位数字加一

> ID：15672851
> 
> 赞同：0
> 
> 时间：2013-03-28T01:51:00.287
> 
> 标签：jquery, loops, add, intervals

每次文档间隔时，如何添加到最后一个数字+1？我得到这个：[jsfiddle.net/zAt7C/1/](http://jsfiddle.net/zAt7C/1/)

```
$(document).ready(function () {
    // verification
    $('title').text('jQuery is working!');

    // loop
    setInterval(function () {
        for (var i = 1; i < 2; i++) {
            $('.repeat').append(i + ' ');
        };
    }, 1000);
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T01:56:54.517

`**[LIVE DEMO](http://jsfiddle.net/zAt7C/5/)**`

```
var i = 0;
setInterval(function () {
    $('.repeat').append(' '+ (i++) );
}, 1000); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T01:57:46.673

**[jsFiddle 演示](http://jsfiddle.net/zAt7C/3/)**

答案实际上在于变量作用域的使用。该变量`i`仅存在于`setInterval`回调函数的范围内。在该函数之前和之后，该变量不存在，因此它不能保存值……它只是在每次函数启动时重新初始化。如果我们将变量移到`setTimeout`函数之外，它就会成为更大范围的一部分，即`$(document).ready`事件处理程序的一部分。它将对该范围和该范围内的所有其他范围（在本例中为`setTimeout`回调）保持可用。

一本关于 Javascript 的好书是 Douglas Crockford 的[Javascript: The Good Parts](http://shop.oreilly.com/product/9780596517748.do)。还有一篇很好的文章解释了[JavaScript 闭包如何工作？](https://stackoverflow.com/questions/111102/how-do-javascript-closures-work)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T02:06:23.380

```
$(document).ready(function () {
    // verification
    $('title').text('jQuery is working!');

    (function func (i) {
        setTimeout(function () {
            $('.repeat').append(i + ' ');
            i += 1;

            if (i <= 10) {
                func(i);
            }
        }, 1000);
    }(0))
}); 
```

[小提琴](http://jsfiddle.net/ethagnawl/6vzBq/)

# c# - 从列表中删除多个值

> ID：15672855
> 
> 赞同：3
> 
> 时间：2013-03-28T01:51:45.220
> 
> 标签：c#, asp.net

我已将一个列表定义为

```
List<List<int>> thirdLevelIntersection = new List<List<int>>(); 
```

我把代码写成

```
for(int i = 0; i < 57; i++)
{
    if(my condition)
        thirdLevelIntersection[i] = null;
    else
    {
       //some logic
    }    
} 
```

所以我得到了 0 到 56 个值的列表，一些任意值是空的，比如 thirdlevelIntersection[1],thirdlevelIntersection[10],thirdlevelIntersection[21],thirdlevelIntersection[21],thirdlevelIntersection[14],thirdlevelIntersection[15],thirdlevelIntersection[51 ]（共 7 个）。

现在我想从列表中删除这些值。

并且有一个来自thirdlevelIntersection[0] thirdlevelIntersection[49] 的列表。

我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T01:54:07.717

完成循环后，请尝试

```
thirdLevelIntersection.RemoveAll(list => list == null); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T01:54:38.990

如果您是`thirdLevelIntersection`从`sourceCollection`某种类型创建的，则可以使用 Linq。

```
List<List<int>> thirdLevelIntersection = 
    (from item in sourceCollection
     where !(my condition)
     select item)
    .ToList(); 
```

或者，如果您正在通过多个语句构建列表，您可以在创建它时执行此操作：

```
thirdLevelIntersection.AddRange(
    from item in sourceCollection
    where !(my condition)
    select item); 
```

这消除了在添加项目后从列表中删除项目的必要性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T01:55:07.960

您可以在迭代列表时通过调用`RemoveAt()`然后递减来执行此操作`i`（因此考虑下一个值）。

```
List<List<int>> thirdLevelIntersection = new List<List<int>>();

for(int i=0;i<57;i++)
{
    if (my condition)
    {
        thirdLevelIntersection.RemoveAt(i--);
        continue;
    }
    else
    {
        //some logic
    }
} 
```

# ios - 如何在弹出的子视图中有一个 UITableView？

> ID：15672864
> 
> 赞同：0
> 
> 时间：2013-03-28T01:52:36.187
> 
> 标签：ios, objective-c

我有一个带有适当协议的 MainWindowViewController。我还在 MainWindowViewController 中实现了 dataSouce 方法。

```
@interface MainWindowController : UIViewController < UITableViewDelegate, UITableViewDataSource, UAModalPanelDelegate, UIGestureRecognizerDelegate> 
```

我在`viewDidLoad`MainWindowViewController 中设置了委托和数据源。

```
self.friendsTableView.delegate = self;
self.friendsTableView.dataSource = self; 
```

应该发生的是我按下了朋友按钮。加载了一个名为 FriendsPopUpView_iPhone 的 xib 文件，它应该会显示一个`UITableView`朋友。但是friendsPopUpView 的tableview 显示为空行。我究竟做错了什么？

FriendsPopUpView_iPhone.xib 包含一个`UITableView`. FriendsTableView 是 FriendsPopUpView_iPhone.xib 中创建的 tableview 的一个出口。FriendsPopUpView 是 FriendsPopUpView_iPhone.xib`UIView`中视图的出口。这是连接到主 MainWindowController 上的朋友按钮的操作。

```
- (IBAction)on_friends:(id)sender {
    if (self.friendsPopUpView == nil) {
        [[NSBundle mainBundle] loadNibNamed:@"FriendsPopUpView_iPhone" owner:self options:nil];
        [self.view addSubview:self.friendsPopUpView];

        UIButton* clickedButton = (UIButton*) sender;
        CGRect sFrame = CGRectMake(clickedButton.frame.origin.x-100, clickedButton.frame.origin.y,
                                   self.friendsPopUpView.frame.size.width,
                                   self.friendsPopUpView.frame.size.height);
        self.friendsPopUpView.frame = sFrame;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T02:16:53.023

弹出视图笔尖是否包含连接到 MainWindowViewController 类的插座（如 self.friendsPopUpView）？它必须为了使任何事情起作用。

在表视图存在之前，您不能设置委托和数据源。当 MainWindowViewController viewDidLoad 触发时它不存在。要在代码中设置委托和数据源，请在加载 nib 后执行，一旦表存在。

如果您将其他插座（如 friendsPopUp 和 friendsTableView）设置为 nib 插座（连接到您将设置为 MainWindowViewController 的“文件所有者”），那么您可以以相同的方式设置委托和数据源，无需代码。否则，请在加载笔尖后在代码中执行...

```
- (IBAction)on_friends:(id)sender {
    if (self.friendsPopUpView == nil) {
    [[NSBundle mainBundle] loadNibNamed:@"FriendsPopUpView_iPhone" owner:self options:nil];

    // assuming you have a friendsPopUpView outlet setup in the nib
    // also assuming you have a friendsTableView outlet setup in the nib, both of these connected

    // now this will work
    self.friendsTableView.delegate = self;
    self.friendsTableView.dataSource = self; 
```

# mysql - Ejabberd 如何管理用于集群的数据库？

> ID：15672868
> 
> 赞同：6
> 
> 时间：2013-03-28T01:53:02.207
> 
> 标签：mysql, erlang, cluster-computing, ejabberd, mnesia

它是将所有数据复制到每个节点还是将数据片段存储在每个节点上，然后在运行时从不同节点获取每个需要的片段？或者这是如何工作的？

如果您使用 MySQL 而不是 Mnesia，集群是否仍能正常工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-28T16:47:55.900

默认情况下，所有内容都转到 mnesia，并且大部分内容都被复制。您还可以选择是否将 mnesia 表放入磁盘或内存。基本上，您可以根据需要重新配置 mnesia 表位置，但通常表会在内存中复制，以保持它们关闭。

集群 ejabberd 也是通过跨越 mnesia 集群上的节点来完成的，因此可能不值得努力摆脱它。

大多数 mods（实现 xeps）使用 mnesia，但是它们具有 mysql 等价物。它甚至更广泛 - 它们具有以“_odbc”为后缀的 SQL 等价物。示例：mod_roster 和 mod_roster_odbc。

总而言之，您最终可以使用轻量级的 mnesia 来处理配置和一些内存中的东西，并使用中央 mysql 来处理繁重的东西。mysql 的位置可在 ejabberd 配置中配置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-28T14:10:07.293

Mnesia 可以很容易地支持集群，但它确实需要在交互式会话中[进行一些修改。](http://www.ejabberd.im/files/doc/guide.html#htoc28)`erl`至于具体的机制，都是由erlang和mnesia内置的集群处理的，这超出了我的专业范围。您可以告诉它在每个节点上存储副本（副本），但它是一个细粒度的控件，需要根据您的需要进行调整，正如[本文档](http://www.ejabberd.im/node/4330)的第一条评论所暗示的那样。不幸的是，我找不到任何关于碎片如何工作的信息，尽管我怀疑 mnesia 会缓存（在内存或磁盘上，取决于配置）它从另一个节点检索到的任何结构。

您可能会[看一下这个](http://www.ejabberd.im/node/4165)，因为它解释了 SQL 的注意事项 - 即使用它不会消除在 ejabberd 中使用 Mnesia。似乎共享 mysql 主机是一种选择，或者在 mysql 的集群功能中使用主从复制配置也可能会起作用，因为共享 SQL 服务器可以工作。

# php - 如果分数表中有分数，如何按用户名获取该顺序的列表？

> ID：15672870
> 
> 赞同：0
> 
> 时间：2013-03-28T01:53:26.353
> 
> 标签：php, sql-order-by, mysql

我有 2 个名为“user”和“score”的表
我想按用户名列出用户顺序，用户名应该在 score 表中

用户表：

```
 id Username
 1  D
 2  B
 3  F
 4  A
 5  E
 6  C 
```

成绩表：

```
 Scorid UserID score
 1      3      156
 2      4      202
 3      4      890
 4      6      346
 5      3      657
 6      5      658
 7      5      700
 8      5      263
 9      2      1089
 10     3      745 
```

我想要一个这样的列表：

```
 UserName score
 A        890
 A        202
 B        1089
 C        346
 E        700
 E        658
 E        263
 F        745
 F        657
 F        156 
```

*列表必须按用户名排序，并且分数也在他们的用户名组中排序
*用户“D”未列出，因为它没有任何分数
*用户可能有多个分数

我正在用 PHP 编写，我正在使用 mysql

哪个查询在一个查询中给出此列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T02:00:23.167

```
Select Username, score 
from   user, score 
where  score.UserID = user.id and 
       score > 0
order  by username, score 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T02:01:05.687

```
SELECT
user.username,
score.score
FROM user
LEFT JOIN score
ON score.UserID = user.id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T02:03:14.353

这是您要使用正确名称运行的查询（MySQL）（请注意，我已将您的表名称更改为复数）：

```
SELECT username, score
FROM  `score` 
JOIN  `user` ON id = UserID
ORDER BY username ASC , score DESC 
```

# javascript - 使用 requireJS 优化器为 highcharts 保留 jQuery 依赖项

> ID：15672872
> 
> 赞同：1
> 
> 时间：2013-03-28T01:53:34.650
> 
> 标签：javascript, highcharts, requirejs, shim

我正在测试 requireJS 并尝试使用 highcharts 制作一个简单的项目。我以[requireJS 多页示例项目](https://github.com/requirejs/example-multipage)作为起点。

我的 dir 结构看起来与基本结构相同，在 lib 目录中添加了 highstock.js。

*   **page1.html**：应用程序的第 1 页。
*   **page2.html**：应用程序的第 2 页。
*   **js**
    *   **app**：存储应用程序特定模块的目录。
    *   **lib**：存放第三方模块的目录，例如 jQuery。
    *   **common.js**：包含 requirejs 配置，它将是一组通用模块的构建目标。
    *   **page1.js**：用于 page1.html 的数据主。加载公共模块，然后加载**app/main1**，即页面 1 的主模块。
    *   **page2.js**：用于 page2.html 的数据主。加载公共模块，然后加载**app/main2**，即页面 2 的主模块。

common.js 保存配置，我在那里为 highstock 添加了一个垫片：

```
requirejs.config({
    baseUrl: 'js/lib',
    paths: {
        app: '../app'
    },
    shim: {
        "highstock": {
            "exports": "Highcharts",
            "deps": [ "jquery"] 
        },
    } // end Shim Configuration
  } ); 
```

我也在使用基本构建文件，添加了一行来将 common.js 设置为配置文件，另一行用于禁用缩小。

```
optimize: "none",
mainConfigFile: '../www/js/common.js', 
```

在 apps/main1.js 我添加了一个`var HighCharts= require('highstock');`然后我尝试使用它。

当我在正常构建中运行它时，一切正常。所有依赖项都保持并且所有内容都加载。

当我尝试优化我的构建时，highcharts 没有收到 jQuery 依赖项。我想我明白它为什么会发生，但我不知道如何解决它。

我的构建创建了 3 个文件，common.js、page1.js 和 page2.js。

构建输出的相关部分：

```
js/lib/../common.js
----------------
js/lib/../common.js
js/lib/jquery.js
...

js/lib/../page1.js
----------------
js/lib/../page1.js
js/lib/highstock.js
js/app/main1.js
... 
```

然后我的页面引用构建的 page1。当它尝试加载 highstock 模块时，它会出错，因为 jQuery 尚未加载/不可访问。

当我看到构建的 page1 时，我明白了原因。

```
require(['./common'], function (common) {
    require(['app/main1']); //highcharts is in main1 in the non-optimized version
});

define("../page1", function(){});
//a few more defines

(function () { // start highcharts module definition HERE 
```

因此，不是在加载 common（包括 jQuery）之后在回调中定义，而是在发出请求之后但在回调执行之前加载它。

我的问题是，为什么会发生这种情况而不是在回调内部（这是在非优化版本中加载它的地方）。我在 build.js 文件和配置文件中尝试了多个选项，但似乎缺少一些关键概念或小错误。

很抱歉这个超长的问题，但我觉得所有信息都是必要的。如果需要更多信息，我可以发布它，或者删除一些多余的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T12:08:08.770

请看一个非常简单的例子，它使用需要 js [http://jsfiddle.net/wAM3h/](http://jsfiddle.net/wAM3h/)

```
 require({
    paths: {
        jquery: "//cdnjs.cloudflare.com/ajax/libs/jquery/1.8.2/jquery.min",
        hchart: [
            "http://code.highcharts.com/highcharts",
            "http://code.highcharts.com/highcharts-more",
            "http://code.highcharts.com/modules/exporting"
        ]
    }
},
['jquery', 'hchart'], function($, hc) {

    window.chart = new Highcharts.Chart(options);
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-29T17:59:55.217

不确定您是否仍然参与该项目：

我看到您没有在上面的代码中定义`path`库`highcharts`。即使在你提到的回购中我也看不到它。

并且，再次，`highcharts`防止重新声明此命名空间，因此您必须使用不同的名称 - 因此，在填充时必须使用不同的名称

**注意：**类似的库`highcharts`可以安全地在 amd 模块中使用，而无需使用 shim（除非您需要显式访问由它导出的对象）。

因此，您的**配置文件**应如下所示：

```
requirejs.config({
    baseUrl: 'js/lib',
    paths: {
        app: '../app',
        'highstock-custom-name': 'path/to/highcharts.js'
    },
    shim: {
        "highstock-custom-name": {
          ... //as is, although not necessary
        }
    }
}); 
```

# asp.net-mvc-4 - ASP.NET MVC，保持动态选择列表的正确方法？

> ID：15672874
> 
> 赞同：0
> 
> 时间：2013-03-28T01:54:14.560
> 
> 标签：asp.net-mvc-4

我正在学习 MVC4+EF 5.0 项目，我使用 VS2012 默认模板创建空白项目并将数据库搭建为 *.edmx 模型，以及用于编辑在哪个公司工作的**员工的编辑视图。**

我遇到的一个问题是当用户输入失败并返回到它时，在编辑视图（下拉）中维护 SelectList。

DropDownList 从控制器绑定 ListItem：

**编辑.cshtml**

```
@Html.DropDownListFor(model => model.CompanyID, (SelectList)ViewData["CompanySelectList"]) 
```

**成员控制器.cs**

```
[HttpGet]
public ActionResult Edit(int SelectedCompanyID = 0, int StaffID = 0)
{
    IQueryable<company_benefit> companys = from c in db.company where c.ID.Equals(CompanyID) select c ;
    ViewData["CompanySelectList"] = new SelectList(companys, "ID", "Name", SelectedCompanyID);

    staff s = db.staff.Find(StaffID);
    if (s == null)
    {
        return HttpNotFound();
    }
    return View(s);
}

    [HttpPost]
    public ActionResult Edit(staff s)
    {
        if (ModelState.IsValid)
        {
            db.Entry(s).State = EntityState.Modified;
            db.SaveChanges();
            return RedirectToAction("Index"); //Edit Success
        }

        return View(s); //Edit Fail
    } 
```

如果有人提交带有无效数据的表单导致输入失败，它将返回视图。但是，SelectList 是从 ViewData 绑定的，所以加载页面时 ViewData 会消失，这是 viewdata 的行为，我更改为 TempData 也无济于事。

那么当发布到编辑操作时我需要再次构建 SelectList 吗？

我关心使用 session 来存储它，但害怕打破 MVC 设计模式。

我的英语不好，很抱歉造成混乱。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T02:01:05.923

一个快速的解决方案是在您的 http post 方法中再次编辑创建您的视图数据

```
[HttpPost]
public ActionResult Edit(staff s)
{
    if (ModelState.IsValid)
    {
        db.Entry(s).State = EntityState.Modified;
        db.SaveChanges();
        return RedirectToAction("Index"); //Edit Success
    }
    IQueryable<company_benefit> companys = from c in db.company where c.ID.Equals(CompanyID) select c ;
    ViewData["CompanySelectList"] = new SelectList(companys, "ID", "Name", SelectedCompanyID);

    return View(s); //Edit Fail
} 
```

您所做的基本上是说，当您从编辑视图返回到服务器时，服务器应该重建视图数据并调用相同的视图，以便它可以填充列表。

有一种更好的方法可以创建一个包含当前模型和 a 的模型，`list<companys> companies = new list<companys>();`然后从数据库中再次填充它。再次，这个概念是相同的，只是使用强类型模型。

# sql - 选择分组依据 > 1 的所有结果

> ID：15672875
> 
> 赞同：4
> 
> 时间：2013-03-28T01:54:16.817
> 
> 标签：sql, postgresql, aggregate-functions

我有一张桌子，里面有一个地址。我想选择与另一个帐户位于同一地址的每个帐户。

如果我的数据看起来像这样：

```
------------------------------------
| Account Number | Address          |
| 12345          | 55 Bee St        |
| 23456          | 94 Water way     |
| 34567          | 15 Beagle Drive  |
| 45678          | 55 Bee St        |
| 56789          | 94 Water way     |
| 67890          | 12 Green St      |
------------------------------------- 
```

我想做一些类似的事情：

```
SELECT * FROM accounts WHERE group by address > 1; 
```

这样我的结果将是：

```
------------------------------------
| Account Number | Address          |
| 12345          | 55 Bee St        |
| 23456          | 94 Water way     |
| 45678          | 55 Bee St        |
| 56789          | 94 Water way     |
------------------------------------- 
```

如果有什么不同，那就是 PostgreSQL 数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:57:31.790

您需要使用两个地址相同但确保两行之间的帐号不同的连接条件将表连接到自身：

```
select distinct account_number, address
from accounts a1
join accounts a2 on a1.account_number > a2.account_number
   and a1.address = a2.address 
```

请注意使用`>`帐号之间的比较，这不仅可以防止行连接到自身，还可以防止反向连接。

我添加`distinct`了以防三个帐户具有相同的地址，否则您不需要它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T02:05:04.367

对同一张表进行左连接，找到地址相同的记录，并按字段分组，然后可以统计匹配的地址，得到至少有一个匹配地址的记录：

```
select a.AccountNumber, a.Address
from accounts a
left join accounts o on o.Address = a.Address and o.AccountNumber <> a.AccountNumber
group by a.AccountNumber, a.Address
having count(o.AccountNumber) >= 1 
```

这种方法为您提供每个帐号的地址，并且如果地址出现两次以上，它不会给您重复。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T02:13:36.650

这应该可以解决问题：

```
SELECT *
FROM Account A1
WHERE
    EXISTS (
        SELECT *
        FROM Account A2
        WHERE
            A1.AccountNumber <> A2.AccountNumber
            AND A1.Address = A2.Address
    ) 
```

简而言之：选择每个帐户，以便有一个不同的帐户 ( `A1.AccountNumber <> A2.AccountNumber`) 具有相同的地址 ( `A1.Address = A2.Address`)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-28T11:35:13.223

这是展示三个有效答案的性能的测试。
`EXISTS`优于带有`LEFT JOIN`/的那个`GROUP BY`：

### 测试设置

具有 100k 行的表，有 1000 个不同的值`b`。
性能差距随着行数的增加而扩大 - 更少的重复意味着更少的差异。
没有索引。

```
CREATE TABLE tbl (a text, b text);
INSERT INTO tbl
SELECT (random()*10000)::int::text
      ,(random()*1000)::int || ' some more text here'
FROM   generate_series(1, 100000) g; 
```

### 1\. @[古法](https://stackoverflow.com/a/15672979/939860)：`LEFT JOIN`//`GROUP BY``HAVING`

```
EXPLAIN ANALYZE
SELECT t.a, t.b
FROM   tbl t
LEFT   join tbl t2 on t2.b = t.b and t2.a <> t.a
GROUP  by t.a, t.b
HAVING count(t2.a) >= 1; 
```

### 2\. 相同的，解开的只是`JOIN`/`GROUP BY`

```
EXPLAIN ANALYZE
SELECT t.a, t.b
FROM   tbl t
JOIN   tbl t2 ON t2.b = t.b AND t2.a <> t.a
GROUP  BY t.a, t.b; 
```

### 3\. [@布兰科](https://stackoverflow.com/a/15673074/939860)：`EXISTS`

```
EXPLAIN ANALYZE
SELECT *
FROM   tbl t
WHERE  EXISTS (
    SELECT *
    FROM   tbl t2
    WHERE  t2.a <> t.a
    AND    t2.b = t.b
    ); 
```

### 4\. [@波西米亚](https://stackoverflow.com/a/15672908/939860)：`DISTINCT`

```
EXPLAIN ANALYZE
SELECT DISTINCT t.a, t.b
FROM   tbl t
JOIN   tbl t2 on t2.b = t.b and t2.a <> t.a; 
```

[**-> SQLfiddle**显示查询的 EXPLAIN ANALYZE 输出](http://www.sqlfiddle.com/#!12/75cad/1)。

1.  总运行时间：**12208.954 毫秒**
2.  总运行时间：11504.460 毫秒
3.  总运行时间：**272.508 毫秒**——！~ 比 1 快 45 倍。
4.  总运行时间：11540.627 毫秒

添加多列索引（[**SQLfiddle**](http://www.sqlfiddle.com/#!12/4985e/1)）后..

```
CREATE INDEX a_b_idx ON tbl(b, a); 
```

..*运行时不会改变*。Postgres 不使用索引。它显然希望顺序表扫描更快，因为无论如何都必须读取整个表。

除了执行时间，还要注意**行数**，这证明了我所讨论
的观点： JOIN 创建了很多中间重复项，`EXISTS`版本开始避免这些重复项：

输出`EXPLAIN ANALYZE`为**1.**：

```
HashAggregate（成本=230601.26..230726.26 行=10000 宽度=31）（实际时间=12127.090..12183.087 行=99476 循环=1）
过滤器：（计数（t2.a）> = 1）
-> Hash Left Join (cost=3670.00..154661.89 rows=10125250 width=31) (实际时间=99.591..5897.744 rows=9991102 loops=1)
哈希条件：（tb = t2.b）
加入过滤器：(t2.a ta)
加入过滤器删除的行：101052
-> Seq Scan on tbl t (cost=0.00..1736.00 rows=100000 width=27) (实际时间=0.036..36.197 rows=100000 loops=1)
-> 哈希（成本=1736.00..1736.00 行=100000 宽度=27）（实际时间=99.141..99.141 行=100000 循环=1）
存储桶：2048 批次：8 内存使用量：784kB
-> tbl t2 上的 Seq Scan（成本=0.00..1736.00 行=100000 宽度=27）（实际时间=0.004..44.899 行=100000 循环=1）
总运行时间：12208.954 毫秒

```

**3**的输出`EXPLAIN ANALYZE`。：

 **```
Hash Semi Join (cost=3670.00..7783.00 rows=1 width=27) (实际时间=81.630..247.371 rows=100000 loops=1)
哈希条件：（tb = t2.b）
加入过滤器：(t2.a ta)
加入过滤器删除的行数：1009
-> Seq Scan on tbl t (cost=0.00..1736.00 rows=100000 width=27) (实际时间=0.010..32.758 rows=100000 loops=1)
-> 哈希（成本=1736.00..1736.00 行=100000 宽度=27）（实际时间=81.388..81.388 行=100000 循环=1）
存储桶：2048 批次：8 内存使用量：784kB
-> tbl t2 上的 Seq Scan（成本=0.00..1736.00 行=100000 宽度=27）（实际时间=0.003..32.114 行=100000 循环=1）
总运行时间：272.508 毫秒

```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-28T01:56:48.737

你想要一个`HAVING`子句：

```
SELECT * FROM accounts
GROUP BY address
HAVING COUNT(address) > 1; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-28T01:59:43.947

我相信您正在寻找 HAVING 子句：

```
 select address,sum(accountnumber) group by address having sum(accountnumber) >1 
```**

# android - 如何创建应用信息页面

> ID：15672877
> 
> 赞同：0
> 
> 时间：2013-03-28T01:54:28.290
> 
> 标签：android, eclipse-adt

我需要为显示有关该应用程序的信息的 android 应用程序创建一个页面。app版本、db版本、php版本等

有没有一种简单的方法可以做到这一点，或者我应该把它全部写在一个带有 XML 的页面上？

我打算使用默认的 android 库。我在哪里可以找到那个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T02:14:49.927

您可以使用[SharedPreferences遵循 Android 风格](http://developer.android.com/reference/android/content/SharedPreferences.html)

# qt - qt3 到 qt4 包括文件更改

> ID：15672885
> 
> 赞同：0
> 
> 时间：2013-03-28T01:55:07.563
> 
> 标签：qt, qt4

将 qt3 代码转换为 qt4 代码时遇到问题。我找到了代码“

```
#include <qdict.h> 
```

并使用两个名为 QDict 和 QDictIterator 的 Qt 类，但 Qt4 没有 qdict.h 文件

QT4中怎么找对口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T06:26:13.563

是`QDict`你说的吗？

[http://doc.qt.io/qt-4.8/porting4.html#qdict-t](http://doc.qt.io/qt-4.8/porting4.html#qdict-t)

# php - AsteriskNOW 和 AGI 脚本

> ID：15672891
> 
> 赞同：0
> 
> 时间：2013-03-28T01:55:52.247
> 
> 标签：php, asterisk, agi

我目前正在尝试用 PHP 编写我的第一个 AGI 脚本以在我的 AsteriskNOW 服务器上使用。我正在尝试的所有教程都不起作用，我想知道它是否可能与使用 AsteriskNOW 而不仅仅是 Asterisk 有关？

另外，我在哪里可以找到适合初学者 AGI 脚本编写者的最新教程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T18:10:46.013

asterisknow 没有什么特别之处。请仔细阅读手册，大部分手册都可以正常工作。在做 AGI 之前，强烈建议做一些拨号方案应用程序并阅读一些可靠的书，如“Asterisk the future of telephony”。

# java - Java 多个 repaint() 调用被忽略

> ID：15672894
> 
> 赞同：1
> 
> 时间：2013-03-28T01:56:08.367
> 
> 标签：java, swing, user-interface, graphics, repaint

对于我的算法课，我们的任务是对数组执行合并排序并以动画的形式显示正在发生的事情。我的代码（理论上）可以正常工作，但是当我快速多次调用 repaint() （为数组设置动画）时，它们被忽略了。没有动画显示，只是最后的数组。控制台中的每个“*”之后应该有一个“-”，但事实并非如此，有很多“*”（应该有）但只有一个“-”。' * ' 表示何时应该调用 repaint 方法，而 '-' 表示何时实际调用它。

```
package a2;

import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Graphics;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.Arrays;
import java.util.Random;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JOptionPane;
import javax.swing.JPanel;

public class GraphicalSort extends JFrame implements ActionListener {
    int[] data = new int[200];
    int[] helper = new int[200];
    JPanel panel = new JPanel(); //Panel to hold graphical display of array
    JPanel buttonsPanel = new JPanel();
    JButton mButton = new JButton("Mergesort");
    JButton sButton = new JButton("Scramble");

    //Constants to scale the width and height
    int barWidth = 8;
    int barHeight = 1;

    public GraphicalSort() {
        setLayout(new BorderLayout());
        mButton.addActionListener(this);
        sButton.addActionListener(this);
        buttonsPanel.add(sButton);
        buttonsPanel.add(mButton);
        for (int i = 0; i < data.length; i++) {
            data[i] = (int) (500 * Math.random() + 1);
            helper[i] = data[i];
        }
        setSize(barWidth * data.length, barHeight * 500 + buttonsPanel.getHeight());
        panel = new ArrayPanel();
        add(buttonsPanel, BorderLayout.NORTH);
        add(panel, BorderLayout.CENTER);

        repaint();
        validate();
    }

    public static void main(String[] args) {
        GraphicalSort gs = new GraphicalSort();
        gs.setTitle("Graphical Sort");
        gs.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        gs.setLocationRelativeTo(null);
        gs.setResizable(false);
        gs.setVisible(true);
    }

    @SuppressWarnings("serial")
    class ArrayPanel extends JPanel {
        public void paintComponent(Graphics g) {
            super.paintComponent(g);
            g.setColor(Color.BLACK);
            System.out.println("-"); //when repaint is actually called
            int xPos = 0;
            for (int i = 0; i < data.length; i++) {
                g.fillRect(xPos, (barHeight * 500) - (barHeight * data[i]), barWidth, barHeight * data[i]);
                xPos += barWidth;
            }   
        }
    }

    @Override
    public void actionPerformed(ActionEvent e) {
        if (e.getSource() == mButton) {
            mergesort(0, data.length - 1);
        } else if (e.getSource() == sButton) {
            Random r = new Random();
            for (int i = 0; i < data.length; i++) {
                int index = r.nextInt(data.length);
                int temp = data[i];
                data[i] = data[index];
                data[index] = temp;
                panel.repaint();
            }
        }
    }

    private void mergesort(int low, int high)  {
        // Check if low is smaller then high, if not then the array is sorted
        if (low < high) {
            // Get the index of the element which is in the middle
            int middle = (low + high) / 2;
            // Sort the left side of the array
            mergesort(low, middle);
            // Sort the right side of the array
            mergesort(middle + 1, high);
            // Combine them both
            merge(low, middle, high);
            System.out.println("*"); //When the repaint should be called
            panel.repaint();
        }
    }

    private void merge(int low, int middle, int high) {

        // Copy both parts into the helper array
        for (int i = low; i <= high; i++) {
            helper[i] = data[i];
        }       

        int i = low;
        int j = middle + 1;
        int k = low;
        // Copy the smallest values from either the left or the right side back
        // to the original array
        while (i <= middle && j <= high) {
            if (helper[i] <= helper[j]) {
                data[k] = helper[i];
                i++;
            } else {
                data[k] = helper[j];
                j++;
            }
            k++;
        }
        // Copy the rest of the left side of the array into the target array
        while (i <= middle) {
            data[k] = helper[i];
            k++;
            i++;
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:58:45.727

您的合并排序发生的速度比您想象的要快，并且重绘被调用得如此接近以至于它们被“堆叠”，当这种情况发生时，是的，它们可以被忽略。即使它们没有被忽略，代码的速度也会导致 GUI 没有可见的变化，即使该过程确实花费了很多时间，GUI 也会被锁定，因为 Swing 事件线程也会被锁定忙着画画。

解决方案是减慢您的代码速度，但`Thread.sleep(...)`如果不在后台线程中调用，而不是使用 Swing 计时器，则不会再次占用 Swing 事件线程。这将允许代码以较慢的逐步方式进行，但不会占用 Swing 事件线程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T02:43:03.057

要在“争夺”期间查看动画，您可以将您的动作执行方法替换为以下内容。可以选择添加代码以将加扰限制为一次一个加扰。

```
public void actionPerformed(final ActionEvent e) {
    if (e.getSource() == mButton) {
        mergesort(0, data.length - 1);
    } else if (e.getSource() == sButton) {
        new Thread(new Runnable() {
            public void run() {
                final Random r = new Random();
                for (int i = 0; i < data.length; i++) {
                    try {Thread.sleep(10);} 
                    catch (final InterruptedException e) 
                    { e.printStackTrace(); }
                    final int index = r.nextInt(data.length);
                    final int temp = data[i];
                    data[i] = data[index];
                    data[index] = temp;
                    panel.repaint();
                }
            }
        }).start();
    }
} 
```

# excel - 自动筛选结果的 ActiveX 文本框搜索非常慢 - Excel 2010

> ID：15672895
> 
> 赞同：0
> 
> 时间：2013-03-28T01:56:13.297
> 
> 标签：excel, textbox, activex, autofilter, vba

我使用以下代码设置了一个 ActiveX 文本框来过滤 1,400 奇数行自动过滤数据；

```
Private Sub TextBox3_Change()

Application.Calculation = xlManual

     Application.ScreenUpdating = False
Selection.AutoFilter Field:=5, Criteria1:="*" & TextBox3.Value & "*", Operator:=xlOr

On Error Resume Next

If Range("B7:B1307").SpecialCells(xlCellTypeVisible).Count = 0 Then
Call ClearAllFilters

  ActiveSheet.Range("B7:B1307").AutoFilter Field:=5, Criteria1:="<>"

 Selection.AutoFilter Field:=6, Criteria1:="*" & TextBox3.Value & "*", Operator:=xlOr
 End If
         Application.ScreenUpdating = True
 Application.Calculation = xlAutomatic
 End Sub 
```

* * *

问题是每次击键都会计算 - 每次击键最多需要 20 秒。

有没有办法阻止它做任何事情，直到用户按下回车键（最好！）或焦点从文本框移开？

如果上面的代码显示不正确，我深表歉意！这里看起来不错，但预览看起来有点古怪！

谢谢，马特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T05:44:56.603

试试这个

```
Private Sub TextBox1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, _
ByVal Shift As Integer)
    '~~> Trap enter key
    Select Case KeyCode
        Case 13
            '~~> Your code goes here
    End Select
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T06:30:35.070

在您的第二个想法中，当用户离开 TextBox 时，您可以使用以下事件：

```
Private Sub TextBox1_LostFocus()
    'your code goes here

End Sub 
```

# php - MySQL即使在函数停止后插入新行

> ID：15672896
> 
> 赞同：-2
> 
> 时间：2013-03-28T01:56:19.633
> 
> 标签：php, mysql, codeigniter

**由于函数很**长，您实际上可以跳过该函数，因为它们仅从 HTML 标签中提取特定数据请尝试通过为这种规模的问题提供逻辑来提供帮助**完整的数据库。实际的函数很长，插入到 4 个不同的表中，估计有 60k 行。我的问题是即使在函数完成执行后，我也可以看到新行被添加到我的数据库中。我猜 MySQL 的插入速度低于我的迭代速度。**

 ****控制器**

```
public function start()
{
    // set the loop running for ever
    ini_set('MAX_EXECUTION_TIME', -1);  
    set_time_limit(0);          
    $lastId = $this->Kpkt_model->last_temp_id();
    if($lastId == 0 OR $lastId == '' OR $lastId == '0')
    {
        $lastId = 0;
    }
    else
    {
        $lastId = $this->Kpkt_model->last_temp_id();
    }
    // add 1 to start the process
    $i = $lastId+1;
    // set the errors to 0
    $errors = 0;

    while($errors < 25)
    {
        usleep(100);
        if($this->_scrap_all($i) == 'empty')
        {
            // its an empty record, add 1 to the errors
            $errors++;

        }
        else
        {
            $errors = 0;
        }
        $i++;
    }

}

function _scrap_all($i)
{

    $url = "mydesiredwebsite.com?PMJU_KOD=$i";

    $html = file_get_html($url);
    // then check if the html element exists to avoid trying to parse non-html

    $tag = $html->find('td[class=tdSecondtext1]');

    // now we need to remove all the redundant spaces
    $tag = preg_replace("/[[:blank:]]+/"," ",$tag);
    // lets sanitize the dirty string from the html special characters
    $tag = preg_replace("/&#?[a-z0-9]{2,8};/i","",$tag);

    $name =  strip_tags(str_replace("\n","", str_replace("\r","", $tag[0])));

    $file = strip_tags(str_replace("\n","", str_replace("\r","", $tag[1])));
    $roc = strip_tags(str_replace("\n","", str_replace("\r","", $tag[2])));
    $address = strip_tags(str_replace("\n","", str_replace("\r","", $tag[3])));
    $city = strip_tags(str_replace("\n","", str_replace("\r","", $tag[4])));
    $postcode = strip_tags(str_replace("\n","", str_replace("\r","", $tag[5])));
    $district = strip_tags(str_replace("\n","", str_replace("\r","", $tag[6])));
    $state = strip_tags(str_replace("\n","", str_replace("\r","", $tag[7])));
    $telephone = strip_tags(str_replace("\n","", str_replace("\r","", $tag[8])));
    $fax = strip_tags(str_replace("\n","", str_replace("\r","", $tag[9])));
    $website = strip_tags(str_replace("\n","", str_replace("\r","", $tag[10])));
    $last_update = strip_tags(str_replace("\n","", str_replace("\r","", $tag[11])));

    // check to see if this array contains data or has returned from the error page
    if(strlen($name) < 4)
    {
        // here we can assume the project is empty by looking at it's file (unique id)

        return 'empty';
    }
    else
    {
        /*
         The project file is not empty, proceed to add to database
         we need to convert this number into a date format
         */
        $date = str_replace('/', '-', $last_update);

        $last_update = date('Y-m-d', strtotime($date));

        // begin insertion
        $this->Kpkt_model->insert_company_temp($name, $file, $roc, $address, $city, $postcode, $district, $state, $telephone, $fax, $website, $last_update);                            
        // echo "<span style='color:green'>company #<strong>$i</strong> added to database!</span><br/>"; 
        // lets search the details

        $links = $html->find('a[href^=DetailProjek.cfm]');
        if (sizeof($links > 0))
        {

            foreach($links as $key=>$link)
            {
                // eurika!
                $anchor = $link->getAttribute ( 'href' );
                // change the spaces to html notation
                $anchor = str_replace(' ', '%20', $anchor);

                $url = "mydesiredwebsite.com/$anchor";
                $html2 = file_get_html($url);

                $tag = $html2->find('td[class=tdSecondtext1]');

                // now we need to remove all the redundant spaces
                $tag = preg_replace("/[[:blank:]]+/"," ",$tag);
                // lets sanitize the dirty string from the html special characters
                $tag = preg_replace("/&#?[a-z0-9]{2,8};/i","",$tag);

                // this is our foreign key
                $developer = strip_tags(str_replace("\n","", str_replace("\r","", $tag[1])));

                // first batch
                $name =  strip_tags(str_replace("\n","", str_replace("\r","", $tag[12])));
                $file =  strip_tags(str_replace("\n","", str_replace("\r","", $tag[13])));
                $lot_no =  strip_tags(str_replace("\n","", str_replace("\r","", $tag[14])));
                $state =  strip_tags(str_replace("\n","", str_replace("\r","", $tag[15])));
                $housing_no =  strip_tags(str_replace("\n","", str_replace("\r","", $tag[16])));
                $bank_name =  strip_tags(str_replace("\n","", str_replace("\r","", $tag[17])));
                $license_no =  strip_tags(str_replace("\n","", str_replace("\r","", $tag[18])));
                $license_expire =  strip_tags(str_replace("\n","", str_replace("\r","", $tag[19])));
                $permit_no =  strip_tags(str_replace("\n","", str_replace("\r","", $tag[20])));
                $permit_expire =  strip_tags(str_replace("\n","", str_replace("\r","", $tag[21])));
                $land_status =  strip_tags(str_replace("\n","", str_replace("\r","", $tag[22])));

                $date1 = str_replace('/', '-', $license_expire);
                $license_expire = date('Y-m-d', strtotime($date1));

                $date2 = str_replace('/', '-', $permit_expire);
                $permit_expire = date('Y-m-d', strtotime($date2));      

                $this->Kpkt_model->add_project_information_temp(
                    $developer,
                    $name,
                    $file,
                    $lot_no,
                    $state,
                    $housing_no,
                    $bank_name,
                    $license_no,
                    $license_expire,
                    $permit_no,
                    $permit_expire,
                    $land_status

                    );

                $project_id = $this->Kpkt_model->get_last_id();                     

                /* 
                    delete the first 23 items of the array
                    since we dont know how many rows of data are under here, we deduct the company details and
                    primary project details
                    sizeof(array) - 23 / 12 = the number of rows we need to insert
                    MD 30/01/2013
                */

                $newTags = array_slice($tag, 23);
                // separate them into batches of 12
                $newTags = array_chunk($newTags, 12);
                // now we iterate through the array and add the details in
                foreach($newTags AS $tag)
                {

                    $category =  strip_tags(str_replace("\n","", str_replace("\r","", $tag[0])));
                    $type =  strip_tags(str_replace("\n","", str_replace("\r","", $tag[1])));
                    $storey =  strip_tags(str_replace("\n","", str_replace("\r","", $tag[2])));
                    $floorArea =  strip_tags(str_replace("\n","", str_replace("\r","", $tag[3])));
                    $totalArea =  strip_tags(str_replace("\n","", str_replace("\r","", $tag[4])));
                    $units =  strip_tags(str_replace("\n","", str_replace("\r","", $tag[5])));
                    $tcf =  strip_tags(str_replace("\n","", str_replace("\r","", $tag[6])));
                    $cf =  strip_tags(str_replace("\n","", str_replace("\r","", $tag[7])));
                    $priceMax =  strip_tags(str_replace("\n","", str_replace("\r","", $tag[8])));
                    $priceStandard =  strip_tags(str_replace("\n","", str_replace("\r","", $tag[9])));
                    $priceMin =  strip_tags(str_replace("\n","", str_replace("\r","", $tag[10])));
                    $progressReport =  strip_tags(str_replace("\n","", str_replace("\r","", $tag[11])));

                    $date1 = str_replace('/', '-', $tcf);
                    $tcf = date('Y-m-d', strtotime($date1));

                    $date2 = str_replace('/', '-', $cf);
                    $cf = date('Y-m-d', strtotime($date2)); 

                    $this->Kpkt_model->add_project_development_information_temp(
                        $developer,
                        $project_id,
                        $category,
                        $type,
                        $storey,
                        $floorArea,
                        $totalArea,
                        $units,
                        $tcf,
                        $cf,
                        $priceMax,
                        $priceStandard,
                        $priceMin,
                        $progressReport                                 
                        );
                }

                // clean the memory
                $sellingInfoLinks = $html2->find('a[href^=LaporanJualRumah.cfm]');
                $html->clear(); 
                unset($html2);
                unset($tag);
                unset($tags);

                if(sizeof($sellingInfoLinks > 0 ))
                {
                    foreach($sellingInfoLinks AS $key=>$selling)
                    {
                        // now we sift through the selling information
                        $anchor = $selling->getAttribute ( 'href' );
                        // change the spaces to html notation
                        $anchor = str_replace(' ', '%20', $anchor);

                        $url = "mydesiredwebsite.com/$anchor";
                        $html3 = file_get_html($url);

                        $tag = $html3->find('tr[bgcolor!=#fc6535] td div font');

                        // now we need to remove all the redundant spaces
                        $tag = preg_replace("/[[:blank:]]+/"," ",$tag);
                        // lets sanitize the dirty string from the html special characters
                        $tag = preg_replace("/&#?[a-z0-9]{2,8};/i","",$tag);

                        // there are 12 items per array
                        $numRows = sizeof($tag) / 12;

                        $tag = array_chunk($tag, 12);
                        foreach ($tag as $value)
                        {
                            // echo '<pre>';
                            // print_r($value);
                            // echo '</pre>';
                            // we break down the selling information into chunks of 12 to insert into the database, each bunch of 12 is one set of data
                            $company_id = $developer;
                            $project_id = $project_id;

                            $roomType = strip_tags(str_replace("\n","", str_replace("\r","", $value[0])));
                            $levels = strip_tags(str_replace("\n","", str_replace("\r","", $value[1])));
                            $local = strip_tags(str_replace("\n","", str_replace("\r","", $value[2])));
                            $chinse = strip_tags(str_replace("\n","", str_replace("\r","", $value[3])));
                            $indian = strip_tags(str_replace("\n","", str_replace("\r","", $value[4])));
                            $other = strip_tags(str_replace("\n","", str_replace("\r","", $value[5])));
                            $foreign = strip_tags(str_replace("\n","", str_replace("\r","", $value[6])));
                            $totalSold = strip_tags(str_replace("\n","", str_replace("\r","", $value[7])));
                            $totalUnsold = strip_tags(str_replace("\n","", str_replace("\r","", $value[8])));
                            $totalPerUnit = strip_tags(str_replace("\n","", str_replace("\r","", $value[9])));
                            $approvedUnits = strip_tags(str_replace("\n","", str_replace("\r","", $value[10])));
                            $developedUnits = strip_tags(str_replace("\n","", str_replace("\r","", $value[11])));
                            //echo sizeof($totalPerUnit);
                            $this->Kpkt_model->add_selling_information_temp(
                                $company_id,
                                $project_id,
                                $roomType,
                                $levels,
                                $local,
                                $chinse,
                                $indian,
                                $other,
                                $foreign,
                                $totalSold,
                                $totalUnsold,
                                $totalPerUnit,
                                $approvedUnits,
                                $developedUnits
                                );
                            # code...
                        }
                        $html3->clear(); 
                        unset($html3);
                        unset($tag);

                    }

                }
            }
        }

    }
// clean the memory
$html->clear(); 
unset($html);
unset($tag);        
} 
```

**模型**

```
function insert_company_temp($name, $file, $roc, $address, $city, $postcode, $district, $state, $telephone, $fax, $website, $last_update)
{
    $data = array(
        'file'          =>  $file,
        'name'          =>  $name,
        'roc'           =>  $roc,
        'address'       =>  $address,
        'city'          =>  $city,
        'postcode'      =>  $postcode,
        'district'      =>  $district,
        'state'         =>  $state,
        'telephone'     =>  $telephone,
        'fax'           =>  $fax,
        'website'       =>  $website,
        'last_update'   =>  $last_update

    );

    $this->db->insert('kpkt_company_temp', $data);      
    //echo $this->db->last_query();
}   

function last_id()
{
    $query = "SELECT MAX(id) AS id FROM kpkt_company";
    $res = $this->db->query($query);
    return $res->row('id');
    //echo $this->db->last_query();

}

function last_temp_id()
{
    $query = "SELECT MAX(id) AS id FROM kpkt_company_temp";
    $res = $this->db->query($query);
    return $res->row('id');
    //echo $this->db->last_query();

}

function add_project_information_temp(
                $developer,
                $name,
                $file,
                $lot_no,
                $state,
                $housing_no,
                $bank_name,
                $license_no,
                $license_expire,
                $permit_no,
                $permit_expire,
                $land_status
                )
{
    $data = array(
        'developer_id'      =>  $developer,
        'name'              =>  $name,
        'file'              =>  $file,
        'lot_no'            =>  $lot_no,
        'state'             =>  $state,
        'housing_no'        =>  $housing_no,
        'bank_name'         =>  $bank_name,
        'license'           =>  $license_no,
        'license_expire'    =>  $license_expire,
        'permit_no'         =>  $permit_no,
        'permit_expire'     =>  $permit_expire,
        'land_status'       =>  $land_status

    );

    $this->db->insert('kpkt_project_information_temp', $data);          
}

function add_project_development_information_temp(
                $developer,
                $project_id,
                $category,
                $type,
                $storey,
                $floorArea,
                $totalArea,
                $units,
                $tcf,
                $cf,
                $priceMax,
                $priceStandard,
                $priceMin,
                $progressReport 
                )
{
    $data = array(
        'developer_id'      =>  $developer,
        'project_id'        =>  $project_id,
        'house_category'    =>  $category,
        'house_type'        =>  $type,
        'levels'            =>  $storey,
        'floor_area'        =>  $floorArea,
        'total_area'        =>  $totalArea,
        'units'             =>  $units,
        'tcf'               =>  $tcf,
        'cf'                =>  $cf,
        'price_max'         =>  $priceMax,
        'price_standard'    =>  $priceStandard,
        'price_min'         =>  $priceMin,
        'progress_report'   =>  $progressReport         
    );

    $this->db->insert('kpkt_project_development_information_temp', $data);      
}

function add_selling_information_temp(
                $company_id,
                $project_id,
                $roomType,
                $levels,
                $local,
                $chinese,
                $indian,
                $other,
                $foreign,
                $totalSold,
                $totalUnsold,
                $totalPerUnit,
                $approvedUnits,
                $developedUnits
                )
{
    $data = array(
        'developer_id'  =>  $company_id,
        'project_id'    =>  $project_id,
        'house_type'    =>  $roomType,
        'levels'        =>  $levels,
        'bumi'          =>  $local,
        'chinese'       =>  $chinese,
        'indian'        =>  $indian,
        'other'         =>  $other,
        'foreigner'     =>  $foreign,
        'units_sold'    =>  $totalSold,
        'units_unsold'  =>  $totalUnsold,
        'price_per_unit'=>  $totalPerUnit,
        'approved_units'=>  $approvedUnits,
        'developed_units'=> $developedUnits         
    );

    $this->db->insert('kpkt_selling_information_temp', $data);
} 
```

所以再次澄清一下，一切都运行得非常顺利，没有任何问题，除了`INSERT`陈述不断落后可以这么说。我怎样才能`while`节流`function start()`？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T02:06:30.687

您正在使用 usleep，这是一个微秒的暂停；[http://php.net/manual/en/function.usleep.php](http://php.net/manual/en/function.usleep.php)

你有usleep(100)，这个停顿几乎不明显。

也许使用；sleep(1) 或将 usleep 移动到 100000 = 0.1 秒**

# c++ - 如何导出链接器选项？

> ID：15672897
> 
> 赞同：1
> 
> 时间：2013-03-28T01:56:22.420
> 
> 标签：c++, bash, linker, g++, export

我几乎可以肯定这是一个骗局，但我什至没有基本词汇来开始研究这个问题。

我有一些`g++`链接器标志，我想将它们永久`export`化为`/etc/bash.bashrc`.

[对于 websocket++ https://stackoverflow.com/a/15469310/1382306](https://stackoverflow.com/a/15469310/1382306)和mysql 连接器 c++ [https://stackoverflow.com/a/11879650/1382306](https://stackoverflow.com/a/11879650/1382306)`-D_WEBSOCKETPP_CPP11_STL_ -D_WEBSOCKETPP_NO_CPP11_REGEX_ -lboost_regex -lboost_system`的答案，是否可以这样做？`-lmysqlcppconn`

如果是这样，请告诉我如何。如果没有，请告诉我如何开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T02:23:15.923

如果您`make`改用，则会将各种标准环境变量发送到编译器。一个是`LDFLAGS`，例如：

```
$ export LDFLAGS='-Wl,--print-map'
$ make foo.cpp
g++   -Wl,--print-map  foo.cpp   -o foo      // default rule
[...] 
```

链接器标志必须在 . 之后以逗号分隔传递`-Wl`。

`g++`或者，您可以使用适当的环境变量创建别名或 shell 函数来调用。

# android - 来自`super.onRestoreInstanceState（）`的EditText的奇怪日志消息（在最简单的应用程序中）

> ID：15672899
> 
> 赞同：1
> 
> 时间：2013-03-28T01:56:27.853
> 
> 标签：android, android-activity, android-edittext, screen-orientation, android-orientation

我只有一个最简单的应用程序：

**MainActivity.java**

```
package com.example.simplestedittext;

import android.app.Activity;
import android.os.Bundle;

public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }
} 
```

**activity_main.xml**

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <EditText
        android:id="@+id/editText1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:hint="@string/hello_world" >
    </EditText>
</LinearLayout> 
```

每当我旋转屏幕时，我都会在 Eclipse 中收到这条消息：

> 03-28 09:54:46.624: I/TextView(2778): [android.widget.EditText@405320b0 is not instanceof CheckBox] === ss.text 是

如果我在 EditText 框中输入了“aaa”，则消息将是：

> 03-28 09:54:53.593: I/TextView(2778): [android.widget.EditText@40541820 is not instanceof CheckBox] === ss.text 是 aaa

那条消息是什么意思？我的应用程序有问题吗？

而且，你有这些信息吗？

# 编辑：

~~好吧，刚刚注意到，它不仅会在屏幕旋转时发生，而且在切换回此应用程序时也会发生。~~（不，对不起，不再）

### 我有突破！

我确定该消息是从`super.onRestoreInstanceState();`

**MainActivity.java**

```
package com.example.simplestedittext;

import android.app.Activity;
import android.os.Bundle;

public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }
    @Override
    protected void onRestoreInstanceState(Bundle savedInstanceState) {
        System.out.println("before");
        super.onRestoreInstanceState(savedInstanceState);
        System.out.println("after");
    }
} 
```

并且输出消息变为：

```
03-28 10:33:36.515: I/System.out(4147): before
03-28 10:33:36.515: I/TextView(4147): [android.widget.EditText@4053a138 is not instanceof CheckBox] === ss.text is 
03-28 10:33:36.523: I/System.out(4147): after
03-28 10:33:44.328: I/System.out(4147): before
03-28 10:33:44.328: I/TextView(4147): [android.widget.EditText@40549128 is not instanceof CheckBox] === ss.text is aaa
03-28 10:33:44.328: I/System.out(4147): after 
```

希望它可以帮助你帮助我:-)

# 编辑2：

请注意：**没有什么**是崩溃的。我只是对“信息”级别的日志消息感到好奇（并且不满意）：-/

**AndroidManifest.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.testorientation"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="4"
        android:targetSdkVersion="17" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.example.testorientation.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T02:51:44.700

```
Remove

super.onRestoreInstanceState(savedInstanceState);

from onrestoreinstancestate(); and run again 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T02:01:04.250

尝试这个

```
<EditText
    android:id="@+id/editText1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:hint="@string/hello_world" /> 
```

# java - 在 SwingWorker 中调用 super.approveSelection()

> ID：15672905
> 
> 赞同：2
> 
> 时间：2013-03-28T01:57:23.123
> 
> 标签：java, swing, swingworker

我有一个定制的 JFileChooser

它的approveSelection() 方法稍作修改：

```
public void approveSelection()
{
    File file = getSelectedFile();

    changeGui();

    final Object a = makeALongCalcualtion(file);

    if (a != null)
    {
        super.approveSelection();

        SwingWorker<Document, Void> open = new SwingWorker<Document, Void>()
        {
            @Override
            protected Document doInBackground() throws Exception
            {
                return createADocument(a);
            }

            @Override
            protected void done()
            {
                try
                {
                    if(get() != null)
                    {
                        changeGui();
                    }

                    else
                    {
                        //TODO error message
                        changeGui();                        
                    }
                }

                catch (InterruptedException | ExecutionException e)
                {                   
                    //TODO error message
                    changeGui();
                }           
            }
        };

        open.execute();
    }

    else
    {
        //TODO error message
        changeGui();
    }
} 
```

changeGui() 方法将 JProgressBar 设置为不确定并使用新字符串更新 JLabel。

如果提供给 makeALongCalcualtion(file) 的文件类型无效，它将返回 null，否则返回传递给 SwingWorker 的信息，SwingWorker 可以使用它在程序中实际创建文件的表示（文档对象）。

但是，这不起作用，因为 makeALongCalcualtion(file) 没有在 SwingWorker 方法中调用，这会阻塞 EDT。

为了解决这个问题，我必须在 SwingWorker 中调用 makeALongCalcualtion(file)。我可以毫无问题地将那部分代码移入 SwingWorker，但随后我将不得不（由于我的代码逻辑）将 super.approveSelection() 一起移动。

所以底线是，对于这种特定情况，我如何从 doInBackground() 中调用 super.approveSelection() ？

//更多信息

应该发生什么：

1.  用户选择并打开文件
2.  JLabel 和 JProgressBar 更新，不确定进度开始播放。
3.  如果 makeALongCalcualtion(file) return null 用户会收到错误窗口警告，但 JFileChooser 会打开，从而可以在错误窗口关闭时再次选择。
4.  否则，调用 super.approveSelection()，允许选择器关闭。
5.  创建了一个文档（但如果出现问题，创建文档的方法返回 null）。
6.  如果一切正常，JLabel 会更新，progressBar 动画会停止（indeterminate 设置为 false）。
7.  如果出现问题，则与步骤 6 中的情况相同，只是 JLabel 中的消息不同。

发生什么了：

1.  相同的
2.  相同的
3.  一样，但是当 makeALongCalculation(file); 开始，progressBar 冻结。
4.  相同的
5.  相同的
6.  相同，但动画没有停止（因为进度条被冻结），只有冻结的“图片”被删除，进度条返回到之前的状态。
7.  相同的

**编辑**

我对我的程序做了一些改动，现在我有了这个：

批准选择（）：

```
public void approveSelection()
{
    File file = getSelectedFile();

    Main.getStatusBar().startOpen();

    final WorkOpen open = new WorkOpen(file);

    open.execute();

    open.addPropertyChangeListener(new PropertyChangeListener()
    {
        @Override
        public  void propertyChange(PropertyChangeEvent evt) {
            if ("state".equals(evt.getPropertyName())) {
                if (evt.getNewValue().equals("DONE"))
                {
                    if (open.failed())
                    {
                        //TODO error message                        
                        Main.getStatusBar().endOpen(false);
                    }

                    else
                    {
                        Main.getStatusBar().endOpen(true);
                    }
                }
            }
        }
    });
} 
```

摇摆工人：

```
class WorkOpen extends SwingWorker<Document, Void>
{
boolean failed = false;
File file;

public boolean failed()
{
    return failed;
}

@Override
protected Document doInBackground() throws Exception
{
    ArrayList<String> data = Opener.extractData(file);

    if (data != null)
    {
        //My little path/name/similar managing system
        FileComplex fullPath = new FileComplex(file.toString());

        return Opener.createDocument(fullPath.getFullName(), fullPath.getFullPath(), data); 
    }

    else
    {
        failed = true;
        return null;
    }
}

@Override
protected void done()
{
    try
    {
        if(get() != null)
        {
            Main.addDocument(get());
        }
    }

    catch (InterruptedException | ExecutionException e)
    {
        failed = true;
    }           
}

WorkOpen(File file)
{
    this.file = file;
}
} 
```

现在的问题是在哪里调用 super.approveSelection()。它必须等待工作人员完成执行，但我无法从属性更改侦听器中调用它。

在这里做什么？

**编辑 2**

正如 HovercraftFullOfEels 建议的那样，我修复了我的代码并编译并运行。但是 JProgressBar 冻结的问题仍然存在。另外，我不得不介绍一些我不知道是否应该拥有的东西：

```
private void superApproveSelection()
    {
        super.approveSelection();
    }

    public void approveSelection()
    {
        final File file = getSelectedFile();

        class OpenWorker extends SwingWorker<Boolean, Void>
        {
            Document document;

            Document getDocument()
            {
                return document;
            }

            @Override
            protected Boolean doInBackground() throws Exception
            {
                ArrayList<String> data = Opener.extractData(file);

                if (data != null)
                {
                    //I had to start the progressBar here, because if invalid
                    //file was selected (extractData(file) returns null if it was),
                    //nothing should happen (maybe an error
                    //window later, handled with a new Runnable() same as this:
                    SwingUtilities.invokeLater(new Runnable()
                    {
                        @Override
                        public void run()
                        {
                            Main.getStatusBar().startOpen();            
                        }               
                    });

                    FileComplex fullPath = new FileComplex(file.toString());

                    document = Opener.createDocument(fullPath.getFullName(), fullPath.getFullPath(), data); 

                    return true;
                }

                else
                {
                    return false;
                }
            }
        };

        final OpenWorker opener = new OpenWorker();

        opener.addPropertyChangeListener(new PropertyChangeListener()
        {
            @Override
            public  void propertyChange(PropertyChangeEvent evt)
            {
                if ("state".equals(evt.getPropertyName()))
                {
                    if (evt.getNewValue() == SwingWorker.StateValue.DONE)
                    {
                        if(opener.getDocument() != null)
                        {
                            superApproveSelection();
                            Main.addDocument(opener.getDocument());
                            Main.getStatusBar().endOpen(true);
                        }

                        else
                        {
                            try
                            {
                                //I'm retrieveing doInBackground()'s value to see if
                                //progressBar needs stoping (it also displays some
                                //text, so it must not be called unless the
                                //progressBar was started).
                                if (opener.get())
                                {
                                    Main.getStatusBar().endOpen(false);
                                }
                            }

                            catch (InterruptedException | ExecutionException e) 
                            {
                                //TODO error something went wrong
                            }
                        }
                    }
                }
            }
        });

        opener.execute();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T02:07:01.600

> “为了解决这个问题，我必须在 SwingWorker 中调用 makeALongCalcualtion(file)。我可以将这部分代码毫无问题地移入 SwingWorker，但随后我将不得不（由于我的代码逻辑）移动super.approveSelection() 以及它。”

不，一点也不真实。`super.approveSelection()`不必在 SwingWorker 内部调用。

为什么不简单地创建一个 SwingWorker，向它添加一个 PropertyChangeListener，当 SwingWorker 的状态完成时，`super.approveSelection()`如果指示调用呢？

好的，下面是我的示例。后续解释：

```
import java.awt.*;
import java.awt.Dialog.ModalityType;
import java.beans.PropertyChangeEvent;
import java.beans.PropertyChangeListener;
import java.io.File;
import java.util.Scanner;
import java.util.concurrent.ExecutionException;

import javax.swing.*;
import javax.swing.text.*;

@SuppressWarnings("serial")
public class ApproveSelectionTest extends JPanel {
   private JTextArea textArea = new JTextArea(30, 60);

   public ApproveSelectionTest() {
      textArea.setEditable(false);
      textArea.setFocusable(false);

      JPanel btnPanel = new JPanel();
      btnPanel.add(new JButton(new MyGetFileAction("Get Text File Text")));

      setLayout(new BorderLayout());
      add(new JScrollPane(textArea), BorderLayout.CENTER);
      add(btnPanel, BorderLayout.PAGE_END);
   }

   private class MyGetFileAction extends AbstractAction {
      public MyGetFileAction(String text) {
         super(text);
      }

      public void actionPerformed(java.awt.event.ActionEvent arg0) {
         MyFileChooser myFileChooser = new MyFileChooser();
         int result = myFileChooser.showOpenDialog(ApproveSelectionTest.this);
         if (result == JFileChooser.APPROVE_OPTION) {
            Document doc = myFileChooser.getDocument();
            textArea.setDocument(doc);
         }
      };
   }

   private static void createAndShowGui() {
      ApproveSelectionTest mainPanel = new ApproveSelectionTest();

      JFrame frame = new JFrame("ApproveSelectionTest");
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.getContentPane().add(mainPanel);
      frame.pack();
      frame.setLocationByPlatform(true);
      frame.setVisible(true);
   }

   public static void main(String[] args) {
      SwingUtilities.invokeLater(new Runnable() {
         public void run() {
            createAndShowGui();
         }
      });
   }
}

@SuppressWarnings("serial")
class MyFileChooser extends JFileChooser {
   private WorkOpen workOpen = null;
   private JDialog progressDialog = null;

   public MyFileChooser() {
   }

   @Override
   public void approveSelection() {
      JProgressBar progBar = new JProgressBar();
      progBar.setIndeterminate(true);
      Window win = SwingUtilities.getWindowAncestor(this);
      progressDialog = new JDialog(win, "Checking File", ModalityType.APPLICATION_MODAL);
      progressDialog.getContentPane().add(progBar);
      progressDialog.pack();
      progressDialog.setLocationRelativeTo(null);

      File file = getSelectedFile();

      workOpen = new WorkOpen(file);

      workOpen.addPropertyChangeListener(new PropertyChangeListener() {

         @Override
         public void propertyChange(PropertyChangeEvent pcEvt) {
            if (SwingWorker.StateValue.DONE == pcEvt.getNewValue()) {
               if (progressDialog != null) {
                  progressDialog.dispose();
               }

               try {
                  boolean bool = workOpen.get().booleanValue();
                  if (bool) {
                     superApproveSelection();
                  } else {
                     JOptionPane.showMessageDialog(MyFileChooser.this, "Invalid File Chosen");
                  }
               } catch (InterruptedException e) {
                  e.printStackTrace();
               } catch (ExecutionException e) {
                  e.printStackTrace();
               }
            }
         }
      });

      workOpen.execute();
      progressDialog.setVisible(true);

   }

   // ****** this is key *****
   private void superApproveSelection() {
      super.approveSelection();
   }

   public Document getDocument() {
      if (workOpen == null) {
         return null;
      } else {
         return workOpen.getDocument();
      }
   }
}

class WorkOpen extends SwingWorker<Boolean, Void> {
   private static final long SLEEP_TIME = 4 * 1000;
   private Document document = null;
   private File file = null;

   public WorkOpen(File file) {
      this.file  = file;
   }

   @Override
   protected Boolean doInBackground() throws Exception {
      if (file == null || !file.exists()) {
         return Boolean.FALSE;
      }
      Thread.sleep(SLEEP_TIME);
      String fileName = file.getName();
      if (fileName.contains(".txt")) {
         Scanner scan = new Scanner(file);
         StringBuilder stringBuilder = new StringBuilder();
         while (scan.hasNextLine()) {
            stringBuilder.append(scan.nextLine() + "\n");
         }

         document = new PlainDocument();
         document.insertString(0, stringBuilder.toString(), null);
         return Boolean.TRUE;
      }
      return Boolean.FALSE;
   }

   public Document getDocument() {
      return document;
   }

} 
```

我的例子的解释和要点：

*   这个例子表现得非常简单。您选择一个文件，如果该文件存在并在其名称中包含“.txt”，则它会读入文档并在 JTextField 中显示文本。
*   否则它会显示一条警告消息*，但会显示 JFileChooser*。
*   可能是关键点：我为 MyFileChooser 类提供了一个私有`superApproveSelection()`方法，可以由我的 PropertyChangeListener 调用。这会将 super 的`approveSelection()`方法暴露给内部类，这是您遇到的问题之一。
*   调用代码的顺序在我的`approveSelection()`覆盖中很重要。
*   在这种方法中，我首先创建了我的 JProgressBar 及其对话框，但还没有立即显示它。它确实不必首先创建，但它肯定需要最后显示。
*   我创建了我的 SwingWorker，workOpen，但还没有执行它。
*   *在执行 SwingWorker之前*，我将 PropertyChangeListener 添加到SwingWorker。
*   然后我执行我的 SwingWorker
*   然后我用不确定的 JProgressBar 显示我的模态 JDialog。
*   我的 SwingWorker 的结构使其 doInBackground 返回一个布尔值，而不是一个文档。
*   如果一切正常，我让它创建一个（非常简单的）文档，其中包含文本文件的内容，并设置一个可通过 getter 方法获得的私有“doc”字段，然后如果一切正常，则让 doInBackground 返回 Boolean.TRUE .
*   我给我的 doInBackground 一个 Thread.sleep(4000) 只是为了假装它的动作需要很多时间。你的当然不会有这个。
*   如果 SwingWorker 已完成，则在 PropertyChangeListener 中，我将处理进度条对话框，然后调用`get()`SW 以获取布尔结果。
*   如果为 Boolean.TRUE，则调用上述`superApproveSelection()`方法。
*   否则显示错误消息。请注意，由于未调用 super 的approveSelection()，因此仍显示文件选择器对话框。
*   如果调用了approveSelection，那么显示我的文件选择器对话框的代码将获得适当的返回值，将从文件选择器中提取文档并在JTextArea 中显示文档。

# r - 包不可用（对于 R 版本 2.15.2）

> ID：15672906
> 
> 赞同：0
> 
> 时间：2013-03-28T01:57:28.253
> 
> 标签：r

我正在尝试安装 fEcofin 软件包，但收到以下消息：

```
Warning message:
package ‘fEcofin’ is not available (for R version 2.15.2) 
```

我在 R 控制台和 RStudio 中尝试过以下操作，但无济于事。有没有办法可以安装和使用这个包？

```
install.packages("fEcofin")
install.packages("fEcofin", type="source") 
```

# java - 复杂的 MapReduce 配置场景

> ID：15672910
> 
> 赞同：2
> 
> 时间：2013-03-28T01:57:43.347
> 
> 标签：java, configuration, hadoop, mapreduce

考虑一个应用程序，该应用程序希望使用以下简化序列`Hadoop`来处理大量专有的二进制编码文本数据：`MapReduce`

1.  获取文件或目录的 URL 作为输入
2.  读取在输入 URL 下找到的二进制文件列表
3.  从每个文件中提取文本数据
4.  将文本数据保存到新的提取的纯文本文件中
5.  将提取的文件分类为具有特殊特征（例如“上下文”）的（子）格式
6.  如有必要，根据上下文拆分每个提取的文本文件
7.  使用原始（未拆分）文件的上下文处理每个拆分
8.  将处理结果提交到专有数据存储库

第 5 步中确定的特定格式特征（上下文）也作为键值对保存在（小）文本文件中，以便第 6 步和第 7 步可以访问它们。

步骤 6 中的拆分使用自定义`InputFormat`类（每种自定义文件格式一个）进行。

为了在 Hadoop 中实现此场景，可以将步骤 1 - 步骤 5 集成到 a 中`Mapper`，并将另一个`Mapper`用于步骤 7。

这种方法的一个问题是如何让自定义`InputFormat`知道使用哪些提取的文件来生成拆分。例如，格式 A 可能表示 2 个提取的文件，其特征略有不同（例如，不同的行分隔符），因此 2 个不同的上下文，保存在 2 个不同的文件中。

综上所述，`getSplits(JobConf)`每个自定义的方法`InputFormat`在拆分之前都需要访问每个文件的上下文。`InputFormat`但是，每种格式最多可以有 1 个类，那么**如何将适当的提取文件集与正确的上下文文件相关联呢？**

一个解决方案可能是使用一些特定的命名约定来关联提取的文件和上下文（反之亦然），但有没有更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-03T03:03:05.720

这听起来更像是一个 Storm（流处理）问题，其中 spout 从 URL 加载二进制文件列表，并且拓扑中的后续螺栓执行以下每个操作。

# windows - 桌面应用程序与 Web 应用程序开发的区别和相似之处

> ID：15672914
> 
> 赞同：1
> 
> 时间：2013-03-28T01:57:51.890
> 
> 标签：windows, offlineapps

如果这个问题有含糊之处，请原谅我。简而言之，我已经建立网站好几年了，使用 PHP、Javascript、JSON、AJAX、HTML、CSS3 和 ASP-（很多年前我不知道更好）。

最近，我遇到了客户更喜欢在桌面（离线）上而不是在网络上使用应用程序的项目。

学习这个会不会有很长的路要走？从网络到桌面，我无法理解。有人可以给我一个 50,000 英尺的概览，了解我需要研究的内容吗？不需要细节..只是一个整体方法。

有没有我应该阅读的软件包，可以说是用于“离线”运行系统的工具？我不确定那里的术语，甚至不确定从哪里开始。

主要原因之一是 Imagemagick 之类的功能似乎太慢而无法在线处理图像。客户想要不需要依赖互联网速度的工具。Go Daddy 在升级他们的工具时毫无用处，我希望做一个独立的图像处理系统。

另外，我想制作桌面小部件，如时间跟踪工具，或者任何可以独立并从我将创建的下载程序运行的东西。

这真的是个坏主意吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T02:10:22.017

试试[Auto it](http://www.autoitscript.com/site/autoit/)，它的足迹很小，非常适合编写小工具。它确实有一个 GUI 编辑器。

自动它小部件的示例

[自动它小部件](http://www.autoitscript.com/forum/topic/128035-weather-desktop-widget/)

除此之外，您可以为 VB 或 C# 使用工业级 Microsoft 开发人员工作室。您甚至可以在 VBA excel 中制作应用程序。

# c++ - 未解析的外部符号 C++ - 错误的声明？

> ID：15672916
> 
> 赞同：0
> 
> 时间：2013-03-28T01:57:59.723
> 
> 标签：c++, compiler-errors, external

我在写课时遇到问题。当我将定义移动到另一个源文件以保持“干净”时，出现了问题。

我收到的消息是：

```
1>------ Build started: Project: 1 projekt - sklep, Configuration: Debug Win32 ------
1>  main.cpp
.1funkcje.obj : error LNK2001: unresolved external symbol "class Rachunek Kasa_sklepowa" .(?Kasa_sklepowa@@3VRachunek@@A)
1>metody_r.obj : error LNK2001: unresolved external symbol "class Rachunek Kasa_sklepowa" .(?Kasa_sklepowa@@3VRachunek@@A)

1>C:\Users\Ja\Desktop\Studia\PW\Semestr II\C++\Cwiczenia - klasy,obiekty\Debug\1 projekt - .sklep.exe : fatal error LNK1120: 1 unresolved externals

========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

我在 main.cpp 中声明为全局的对象在哪里`Kasa_Sklepowa`- 我猜这可能是出现问题的原因。

在它向我展示带字符串的类声明中有问题之前。

```
#pragma once

class Rachunek
{
double saldo_ogolne;
public:
    Rachunek() {saldo_ogolne=0;};
    ~Rachunek();
    void transakcja(std::string,std::string,double);
    void czysc_zarobki();
}; 
```

源文件 (cpp)

```
extern Rachunek Kasa_sklepowa;
void Rachunek::transakcja(string _pes,string co,double ile)
{ 
     bla bla
     } 
```

主文件

```
Rachunek Kasa_sklepowa();
int main (int agc, char**argv)
{
...
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T02:11:14.250

我认为您不需要 cpp 文件上的 extern 声明。

关于您之前遇到的与字符串相关的错误 - 确保您`#import <string>`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T02:14:30.270

这一行：

```
Rachunek Kasa_sklepowa(); 
```

声明一个函数，它不同于变量。

您需要做的是将此行写在与 Rachunek 类相同的标题中：

```
extern Rachunek Kasa_sklepowa; 
```

并在相应的 .cpp 文件中写入：

```
Rachunek Kasa_sklepowa; 
```

第一行只是声明它对编译器可见，第二行实际定义它以便将其放置在 .obj 文件中并且对链接器可见。

顺便说一句，更好的方法是使用静态变量：

```
class Rachunek
{
public:
    static Rachunek Kasa_sklepowa;

    ... 
```

在 .cpp 文件中，写入：

```
Rachunek Rachunek::Kasa_sklepowa; 
```

# ruby - 添加关联时访问many_to_many连接表的续集

> ID：15672918
> 
> 赞同：5
> 
> 时间：2013-03-28T01:58:20.470
> 
> 标签：ruby, sequel

我正在使用 Sequel 构建愿望清单系统。我有一个`wishlists`和`items`表和一个`items_wishlists`连接表（该名称是续集选择的名称）。该`items_wishlists`表还有一个用于 facebook id 的额外列（因此我可以存储 opengraph 操作），它是一个 NOT NULL 列。

我还设置了带有续集 many_to_many 关联的模型`Wishlist`。`Item`该类`Wishlist`还具有`:select`将 many_to_many 关联设置为 的选项`select: [:items.*, :items_wishlists__facebook_action_id]`。

有没有一种方法可以在创建关联时添加额外的数据，比如`wishlist.add_item my_item, facebook_action_id: 'xxxx'`什么？在我创建关联后我不能这样做，因为 facebook id 在列上没有 NULL。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-28T14:48:52.670

推荐的方法是为连接表添加一个模型。但是，如果你不想这样做，你可以这样做：

```
class Wishlist
  def _add_item(item, hash={})
    model.db[:items_wishlists].insert(hash.merge(:item_id=>item.id, :wishlist_id=>id))
  end
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-01-07T16:27:36.273

我认为还有另一种可能。

首先是您问题的 MWE（最小工作示例）：

```
 require 'sequel'
  Sequel.extension :pretty_table  #Sequel::PrettyTable.print()/Sequel::PrettyTable.string()

  DB = Sequel.sqlite
  DB.create_table(:wishlists){
        primary_key :id
        String :listname
  }
  DB.create_table(:items){
        primary_key :id
        String :descr
    }
  DB.create_table(:items_wishlists){
        primary_key :id
        foreign_key :wishlist_id, :wishlists
        foreign_key :item_id, :items

        add_column :facebook_id, type: :nvarchar
  }

  class Item < Sequel::Model
    many_to_many :wishlists 
  end

  class Wishlist < Sequel::Model
    many_to_many :items
  end

  w1 = Wishlist.create(listname: 'list1')
  w1.add_item(Item.create(descr: 'item 1'))
  #w1.add_item(Item.create(descr: 'item 2'), facebook_id: 'fb2')  ##<- This does not work

  #Sequel::PrettyTable.print(Wishlist)
  #Sequel::PrettyTable.print(Item)
  Sequel::PrettyTable.print(DB[:items_wishlists]) 
```

要允许`ad_item`使用参数 ( `Wishlist#add_item(Item.create(descr: 'item 2'), facebook_id: 'fb2')`)，您必须定义一个`adder`，如下例所示：

```
require 'sequel'
Sequel.extension :pretty_table  
Sequel::PrettyTable.print()/Sequel::PrettyTable.string()

DB = Sequel.sqlite
DB.create_table(:wishlists){
      primary_key :id
      String :listname
}
DB.create_table(:items){
      primary_key :id
      String :descr
  }
DB.create_table(:items_wishlists){
      primary_key :id
      foreign_key :wishlist_id, :wishlists
      foreign_key :item_id, :items

      add_column :facebook_id, type: :nvarchar
}

class Item < Sequel::Model
  #~ many_to_many :wishlists 
end

class Wishlist < Sequel::Model
  many_to_many :items, 
                join_table: :items_wishlists, class: Item,
                left_key: :wishlist_id, right_key: :item_id, 
                adder: (lambda do |item, facebook_id: nil|
                      self.db[:items_wishlists].insert(wishlist_id: self.id, item_id: item.id, facebook_id: facebook_id)
                end)
end

w1 = Wishlist.create(listname: 'list1')
w1.add_item(Item.create(descr: 'item 1'))
w1.add_item(Item.create(descr: 'item 2'), facebook_id: 'fb2')

Sequel::PrettyTable.print(DB[:items_wishlists]) 
```

结果：

```
+-----------+--+-------+-----------+
|facebook_id|id|item_id|wishlist_id|
+-----------+--+-------+-----------+
|           | 1|      1|          1|
|fb2        | 2|      2|          1|
+-----------+--+-------+-----------+ 
```

但下一个问题将在稍后出现：

随着`w1.items`您获得项目列表，但您无权访问参数。（至少到目前为止我没有发现任何方法。我仍在研究，但我希望我需要一个连接表的模型（参见 Jeremys 的建议））

# javascript - Jquery TypeError：$ 不是函数

> ID：15672922
> 
> 赞同：1
> 
> 时间：2013-03-28T01:58:39.310
> 
> 标签：javascript, jquery

我得到了这个脚本：

```
<script>
    $(document).ready(function () {
        $('a[@href^= ""] img').parent().click(function () {
            var linkz = $(this).attr("href");
            if(linkz.toLowerCase().indexOf("http: //www.website.com") >= 0) {
                window.open($(this).attr("href"));
                return false;
            } else {
                window.open("http://www.website.com/p/img.html?img=" + $(this).attr("href "));
                return false;
            }
        });
    });
</script> 
```

在新页面中打开所有图像，并在新链接中传递图像 url。但我得到

> `TypeError: $ is not a function.`

我试图添加 jQuery(document) 而不是 $(document) 但后来我得到了

> `$(&#39;a[@href^=&quot;&quot;] img&#39;)`类型错误：$ 不是函数

这里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T02:01:25.720

要么你没有包含 jQuery，要么你运行了 noConflict() 并且它释放了对 $.

[http://api.jquery.com/jQuery.noConflict/](http://api.jquery.com/jQuery.noConflict/)

如果你使用 noConflict，你只需要在整个过程中使用 jQuery()，包括 jQuery('a[@href^=""] img')。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T02:00:44.890

看起来您没有正确包含 jQuery，因为浏览器不知道是什么`$`。确保包含类似这样的内容`<head>`以包含 jQuery：

```
<script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.min.js"></script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T02:01:33.520

你还没有添加jQuery添加这个`<head></head>`

```
 <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script> 
```

**如果您在本地进行测试，并且带宽较低，则将脚本下载一次** [http://code.jquery.com/jquery-1.9.1.min.js](http://code.jquery.com/jquery-1.9.1.min.js) **到您的文件夹**并使用
`<script src="jquery-1.9.1.min.js"></script>`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-24T17:51:20.993

尝试这个;

```
<script language="JavaScript" type="text/javascript" src="jquery/jquery.js"></script>
<script>
    jQuery.noConflict();
    (function ($) {
        function readyFn() {
            // Set your code here!!
        }

        $(document).ready(readyFn); 
    })(jQuery);

</script> 
```

**或者在你的情况下：**

```
<script language="JavaScript" type="text/javascript" src="jquery/jquery.js"></script>
<script>
    jQuery.noConflict();
    (function ($) {
        function readyFn() {
             $('a[@href^= ""] img').parent().click(function () {
             var linkz = $(this).attr("href");
             if(linkz.toLowerCase().indexOf("http: //www.website.com") >= 0) {
                 window.open($(this).attr("href"));
                 return false;
             } else {
                 window.open("http://www.website.com/p/img.html?img=" + $(this).attr("href"));
                 return false;
             }
        });
        }

        $(document).ready(readyFn); 
    })(jQuery);

</script> 
```

# c# - 将 curl 示例转换为 c#.net

> ID：15672925
> 
> 赞同：1
> 
> 时间：2013-03-28T01:59:10.807
> 
> 标签：c#, .net, curl

您将如何在 c# 中编写此 CURL 示例：

```
curl -u d4a581cceff06c03a47015643661ee75:x https://sample.crm.com/api/users 
```

# html - 如何使用 CSS 和 HTML 设置 hr 标签的样式？

> ID：15672926
> 
> 赞同：1
> 
> 时间：2013-03-28T01:59:15.397
> 
> 标签：html, css

如何设置 hr 标签的样式？

```
#footer hr
{
    background-image: -moz-linear-gradient(left, rgba(0,0,0,0), rgba(0,0,0,0.75), rgba(0,0,0,0)); 
} 
```

这在 Firefox 中不起作用。我什至尝试过`background:`，但这没有用。还有其他方法可以使它工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T04:10:16.187

Its working you need to just use hr in div with your css id footer. As like below

```
<div id="footer">
   <hr />
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T02:03:18.760

尝试背景：而不是背景图像：

有关 Firefox 中的工作示例，请参见此处：

[http://playground.genelocklin.com/gradient-hr/](http://playground.genelocklin.com/gradient-hr/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-21T13:08:19.543

```
 hrshadow {
        height: 12px;
        border: 0;
        box-shadow: inset 0 12px 12px -12px rgba(0,0,0,0.5);
    }

/****************************/

Newhr {
    height: 30px;
    border-style: solid;
    border-color: black;
    border-width: 1px 0 0 0;
    border-radius: 20px;
}
Newhr:before { 
    display: block;
    content: "";
    height: 30px;
    margin-top: -31px;    
    border-style: solid;
    border-color: black;
    border-width: 0 0 1px 0;
    border-radius: 20px;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-28T02:56:58.563

好吧，你可以尝试像这样制作一个 div：

```
CSS:
div.hr{
    background-image:url('yourimage.jpg');
    height: 5px;
    width:  400px; /*About the size of the content area that you are putting it in*/
    margin-left: auto;
    margin-right: auto;
}

HTML:
<div id="hr">
</div> 
```

有任何问题吗？

编辑：看看查理的答案，你可以尝试这样的事情：

```
<div id="footer">
    <hr id="footer" />
</div>

#footer
{
    height:10px;
    background-color: black;
    padding: 0px
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-28T02:11:11.857

您需要指定的高度`<hr />`

看[这个](http://jsfiddle.net/YGjbT/1/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-21T13:03:32.243

```
.myhr {
    border: 0;
    height: 1px;
    background: #333;
    background-image: -webkit-linear-gradient(left, #ccc, #333, #ccc); 
    background-image:    -moz-linear-gradient(left, #ccc, #333, #ccc); 
    background-image:     -ms-linear-gradient(left, #ccc, #333, #ccc); 
    background-image:      -o-linear-gradient(left, #ccc, #333, #ccc); 
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-04-21T13:11:51.690

```
 .hrstyle {
        padding: 0;
        border: none;
        border-top: medium double #333;
        color: #333;
        text-align: center;
    }
    .hrstyle:after {
        content: "§";
        display: inline-block;
        position: relative; 
        top: -0.7em;  
        font-size: 1.5em;
        padding: 0 0.25em;
        background: white;
    }

/****dashed line *****/

.dash_hr {
    border: 0;
    border-bottom: 1px dashed #ccc;
    background: #999;
} 
```

# r - 如何将数据帧的唯一列发送到处理向量的自定义函数

> ID：15672936
> 
> 赞同：0
> 
> 时间：2013-03-28T02:00:32.490
> 
> 标签：r

朋友们，我有一个数据框，我想从中选择唯一的三列并将所选列发送到一个自定义函数，该函数将返回一个列向量和一些标量。我想知道是否有办法在 R 中使用简洁的代码来做到这一点。现在让我详细说明。

假设这是我的数据框：

```
> data
  X1 X2 X3 X4 X5
1  1  5  9 13 17
2  2  6 10 14 18
3  3  7 11 15 19
4  4  8 12 16 20 
```

然后，我创建一个索引以从该数据框中选择所有三个唯一列：

```
> cols=combn(ncol(mat), 3)
> cols
     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
[1,]    1    1    1    1    1    1    2    2    2     3
[2,]    2    2    2    3    3    4    3    3    4     4
[3,]    3    4    5    4    5    5    4    5    5     5 
```

并连接名称：

```
> nams<-apply(combn(colnames(data),3), 2, function(z) paste(z, collapse = ' '))
> nams
 [1] "X1 X2 X3" "X1 X2 X4" "X1 X2 X5" "X1 X3 X4" "X1 X3 X5" "X1 X4 X5" "X2 X3 X4"
 [8] "X2 X3 X5" "X2 X4 X5" "X3 X4 X5" 
```

现在这是我不确定如何进行的部分。如何最好地编写一个自定义函数，该函数对发送给它的三个向量进行操作并返回一个由向量​​和标量组成的对象，例如返回 X1+X2+X3 以及 X1、X2 和 X3 的均值和标准差等标量。

假设以下是函数：

```
someFunc <- function(subMat){
    someFunc$vector=subMat[,1]+subMat[,2]+subMat[,3] # return vector
    someFunc$mean1=mean(subMat[,1])
    someFunc$sd1=sd(subMat[,1])
    someFunc$mean2=mean(subMat[,2])
    someFunc$sd2=sd(subMat[,2])
    someFunc$mean3=mean(subMat[,3])
    someFunc$sd3=sd(subMat[,3])
    return(someFunc)
} 
```

我想我想弄清楚如何构建 R 中的自定义函数来处理和发送向量+标量，因此将上述函数视为我的粗略尝试。

下一步。在其他帖子之一中@Prasad Chalasani 指出，发送此类函数的正确 R 方法将涉及使用 apply 函数，但我似乎无法将这些部分放在一起。

```
result <- apply( cols, 2, someFunc ........ 
```

如果有任何含糊之处，请告诉我，我会尽我所能进一步澄清问题。总之：我有一个数据框，我想从中将所有唯一的三列发送到一个函数，然后返回多个结果。无法定义这样的函数并使用 apply 向其发送数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T02:12:13.063

您可以传递一个函数combn，这似乎是您真正想要做的。在这种情况下，您不想简化结果。

A`list`似乎是您想要返回的内容

您可以使用`setNames`在一行中设置结果的名称，使用`combn`with`paste`给出一个合理的名称

```
someFunc <- function(dd, .which){
  rr <- list(vec = rowSums(dd[,.which]))
  names(rr) <- paste('sum', paste(.which,collapse = '.'),sep='.')
  means <- lapply(dd[.which],mean)
  sds <- lapply(dd[.which], sd)

  return(c(rr, sd = sds, mean =means))
}
results <- setNames(combn(names(data),3, FUN = someFunc,dd = data, simplify = FALSE), 
                    combn(names(data),3, FUN = paste, collapse=':'))
head(results,2)
# $`X1:X2:X3`
# $`X1:X2:X3`$sum.X1.X2.X3
# 1  2  3  4 
# 15 18 21 24 
# 
# $`X1:X2:X3`$sd.X1
# [1] 1.290994
# 
# $`X1:X2:X3`$sd.X2
# [1] 1.290994
# 
# $`X1:X2:X3`$sd.X3
# [1] 1.290994
# 
# $`X1:X2:X3`$mean.X1
# [1] 2.5
# 
# $`X1:X2:X3`$mean.X2
# [1] 6.5
# 
# $`X1:X2:X3`$mean.X3
# [1] 10.5
# 
# 
# $`X1:X2:X4`
# $`X1:X2:X4`$sum.X1.X2.X4
# 1  2  3  4 
# 19 22 25 28 
# 
# $`X1:X2:X4`$sd.X1
# [1] 1.290994
# 
# $`X1:X2:X4`$sd.X2
# [1] 1.290994
# 
# $`X1:X2:X4`$sd.X4
# [1] 1.290994
# 
# $`X1:X2:X4`$mean.X1
# [1] 2.5
# 
# $`X1:X2:X4`$mean.X2
# [1] 6.5
# 
# $`X1:X2:X4`$mean.X4
# [1] 14.5 
```

# bash - 在 Unix 中，如何计算字符串在一定行数中出现的次数并与该返回值相乘

> ID：15672956
> 
> 赞同：0
> 
> 时间：2013-03-28T02:01:55.057
> 
> 标签：bash, unix

我正在尝试使用类似 ``expr 2 \\* grep -c ",2,1," my_course` 的方法将 2 乘以包含字符串“,2,1”的行数，但出现 `"expr: non-integer argument"`错误。我是 Unix 新手，所以有人能指出我正确的方向吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T02:10:16.097

被`grep ...`解释为 的参数`expr`，它有点不喜欢那串单词。您需要运行 grep 并将输出捕获为参数，例如：

expr 2 \* $(grep -c ",2,1," my_course)

在`$(...)`里面运行程序，并将返回的内容放入字符串列表中。

（这与 bash，其他 shell 可能需要使用反引号而不是`$(...)`）

# c - 使用 memcpy 与直接方法复制结构数组

> ID：15672958
> 
> 赞同：1
> 
> 时间：2013-03-28T02:02:26.100
> 
> 标签：c, memcpy

假设 pp 是一个指向长度为 n 的结构数组的指针。[被动态分配]假设我想创建该结构数组的副本并创建一个指向它的指针，方法如下：

```
struct someStruct* pp2 = malloc(_appropriate_size_);
memcpy(pp2, pp, _appropriate_length_); 
```

我也可以做一个循环并做`pp2[i]=pp[i]`for `0 <= i <= n`。

这些方法有什么区别，哪个更好，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T02:15:29.837

对于所有架构都没有明确的答案。您需要进行分析以确定哪种方法最好。

但是恕我直言，我想这`memcpy`会更快，因为有人花时间为您的特定架构/平台，并且能够使用特定的细微差别来加快速度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T02:21:13.873

前者使用 C 中禁止使用的标识符：任何以 . 为前缀的东西`_`。后者在 C89 中无效，因为结构分配在 C99 中已合理化。假设这些因素都不会导致问题，则没有功能差异。

*更好*的定义不明确；如果您将“更好”定义为*C89 中的编译*，那么前者*可能*会更好。但是，如果您将“更好”*定义为在 C99 中没有未定义的行为*，那么后者会更好。如果您将“更好”定义为*更优化*，则没有明确的答案，因为一种实现可能会对两者产生较差的性能，而另一种实现可能会产生较差的性能，而另一种实现可能会产生完美的最佳代码，甚至两者的代码相同。无论如何，这不太可能成为您算法的瓶颈......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T02:16:39.920

我会说 memcpy 更快 - 通常针对底层平台进行调整，并且可能使用 DMA 启动的传输（没有 L1/L2 缓存副本）。for 循环可能会涉及额外的传输。但是，这取决于底层编译器的智能程度——如果它发现 n 的静态定义值，它可能会用 memcpy 替换它。正如 Mystical 所提到的，值得对例程进行计时或检查汇编代码。

# image - 在控制其大小的同时将图像放置在窗口上-directX，c ++

> ID：15672960
> 
> 赞同：1
> 
> 时间：2013-03-28T02:02:52.260
> 
> 标签：image, textures, direct3d, image-size

*所有代码都是伪代码*

我有一个尺寸为 1024 x 768 的图像。

这是一张.jpg

我有一个大小为 1024 x 768 的窗口。

我创建了一个精灵，为其获取纹理，然后将其绘制到屏幕上。

例如：

```
D3DXCreateSprite( gfx.d3dDevice, &sprite );
D3DXCreateTextureFromFile( gfx.d3dDevice, _fileName, &gTexture );
....
pos.x = 0.0f;
pos.y = 0.0f;
pos.z = 0.0f;
sprite->Draw( scenes[ 0 ]->backgroundImage->gTexture, NULL, NULL, &pos, 0xFFFFFFFF ); 
```

当它出现在屏幕上时，图片被扭曲并且看起来不应该如何：

![在此处输入图像描述](../Images/202a6a43abdc72e860916d764df17f33.png)

我的问题是：

当纹理、精灵或绘图功能似乎都没有功能时，如何控制图像输出的大小..？

我想也许这与 Rect 有关，但它只是剪辑图像//耸肩//

可能是我需要使用的：

*   [http://msdn.microsoft.com/en-us/library/ms887494.aspx](http://msdn.microsoft.com/en-us/library/ms887494.aspx)
*   [directx 纹理尺寸](https://stackoverflow.com/questions/8942959/directx-texture-dimensions?rq=1)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T20:50:56.640

```
result = D3DXCreateTextureFromFileEx( 
    gfx.d3dDevice, 
    _fileName, 
    1024, 
    768, 
    D3DX_DEFAULT, 
    0, 
    D3DFMT_UNKNOWN, 
    D3DPOOL_MANAGED, 
    D3DX_DEFAULT, 
    D3DX_DEFAULT, 
    0, 
    NULL, 
    NULL, 
    &gTexture 
); 
```

D3DXCreateTextureFromFileEx 允许在没有任何大小扭曲的情况下创建纹理：

*   这很有帮助：[directx 纹理尺寸](https://stackoverflow.com/questions/8942959/directx-texture-dimensions?rq=1)
*   这非常有帮助：http: [//msdn.microsoft.com/en-us/library/ms887494.aspx](http://msdn.microsoft.com/en-us/library/ms887494.aspx)

# ios - 带有 AFNetworking 的 UITableViewCell setImageWithURL 太大

> ID：15672964
> 
> 赞同：0
> 
> 时间：2013-03-28T02:03:12.437
> 
> 标签：ios, uitableview, afnetworking

我有一个“基本”表格视图单元格并想设置一个图像：

```
[cell.imageView setImageWithURL:urlOfAvatar placeholderImage:[UIImage imageNamed:@"none40"]]; 
```

不幸的是，结果是图像对于单元格来说太大了。有可能使这看起来正确吗？

![在此处输入图像描述](../Images/813142be4a1cdf4d60f15942a1d7b8b0.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T02:29:00.037

编写自定义cell继承UITableViewCell，并覆盖layoutSubViews。</p>

如何：[https ://stackoverflow.com/a/4866205/946434](https://stackoverflow.com/a/4866205/946434)

# javascript - 如何在内部创建标签元素和风格呢？

> ID：15672970
> 
> 赞同：1
> 
> 时间：2013-03-28T02:03:56.263
> 
> 标签：javascript, html, css, placeholder, textinput

我可以在输入元素中制作标签（我的“消失的文本”）：

HTML

```
<input name="firstName" type="text" maxlength="40" value="Enter your first name"
 onfocus="if(this.value==this.defaultValue)this.value=''" 
 onblur="if(this.value=='')this.value=this.defaultValue" /> 
```

然后设置样式，使我消失的文本褪色（#333）。并设置它的样式，以便当我开始在字段中输入值时，文本为黑色（#000）。

CSS

```
input[type=text] {
    color: #333;
}
input[type=text]:focus {
    color: #000;
} 
```

在您进入下一个输入字段之前，一切正常。然后，您刚刚输入值的字段将变回`#333`颜色。`#000`我可以明白为什么会发生这种情况，但是如果输入字段已放入值，则无法完全了解如何将值保持为黑色。

提前感谢您的帮助和教育！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-28T02:05:14.893

## HTML5

`<input>`HTML5 为被调用的标签带来了一个方便的属性，该属性`placeholder`支持对这个功能的原生支持。

[jsFiddle](http://jsfiddle.net/mPr6m/)

```
<input type="text" placeholder="Search..." /> 
```

### 支持

所有最新的浏览器都支持这个，[但是 IE9 及以下不](http://caniuse.com/input-placeholder)支持。

### `<label>`

请注意，[占位符属性不是每个输入都应具有的`<label>`标签](https://stackoverflow.com/questions/9157867/placeholder-vs-label-for-input-in-html5)的替代品，请确保您包含标签，`<input>`即使它对用户不可见。

```
<label for="search">Search</label>
<input id="search" placeholder="Search..." /> 
```

上述`<label>`内容可以隐藏，因此仍可用于以下辅助技术：

```
label[for=search] {
    position:absolute;
    left:-9999px;
    top:-9999px;
} 
```

## 跨浏览器解决方案

这是一个潜在的跨浏览器解决方案，我已将代码从标签移到脚本标签中，然后使用该类`placeholder`来指示何时淡化文本。

[jsFiddle](http://jsfiddle.net/PYGth/3/)

**HTML**

```
<input name="firstName" type="text" maxlength="40" value="Enter your first name" 
    class="placeholder" id="my-input" /> 
```

**CSS**

```
input[type=text].placeholder {
    color: #999;
} 
```

**JS**

```
<script type="text/javascript">
var input = document.getElementById('my-input');

input.onfocus = function () {
    if (this.value == this.defaultValue && this.className == 'placeholder') {
        this.value = '';
    }
    this.className = '';
};
input.onblur = function() {
    if (this.value == '') {
        this.className = 'placeholder';
        this.value = this.defaultValue;
    }
};
</script> 
```

### 全部应用`input[type=text]`

我们可以将上述解决方案扩展为适用于所有人`input[type=text]`，方法是使用`document.getElementsByTagName()`、循环它们并检查`type`属性`element.getAttribute()`。

[jsFiddle](http://jsfiddle.net/p3FhA/1/)

```
var input = document.getElementsByTagName('input');

for (var i = 0; i < input.length; i++) {
    if (input[i].getAttribute('type') === 'text') {
        input[i].onfocus = inputOnfocus;
        input[i].onblur = inputOnblur;
    }
}
function inputOnfocus () {
    if (this.value == this.defaultValue && this.className == 'placeholder') {
        this.value = '';
    }
    this.className = '';
}
function inputOnblur() {
    if (this.value == '') {
        this.className = 'placeholder';
        this.value = this.defaultValue;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T23:16:19.720

这似乎使用 jQuery 和 Modernizer 库的组合来工作 xbrowser。

要求 jQuery 和 Modernizer 库在网站上并正确引用。

**HTML**

```
<head>
<script src="jquery-1.9.1.min.js"></script>
<script src="modernizr.js"></script>

<script>
$(document).ready(function(){

if(!Modernizr.input.placeholder){

$('[placeholder]').focus(function() {
  var input = $(this);
  if (input.val() == input.attr('placeholder')) {
    input.val('');
    input.removeClass('placeholder');
  }
}).blur(function() {
  var input = $(this);
  if (input.val() == '' || input.val() == input.attr('placeholder')) {
    input.addClass('placeholder');
    input.val(input.attr('placeholder'));
  }
}).blur();
$('[placeholder]').parents('form').submit(function() {
  $(this).find('[placeholder]').each(function() {
    var input = $(this);
    if (input.val() == input.attr('placeholder')) {
      input.val('');
    }
  })
});

}
</script>
</head>

<body>
<form>
<input name="firstName" type="text" maxlength="40" placeholder="Enter your first name">
</form> 
```

**CSS**

```
input[type=text] {
color: #000;
}

input[type=text].placeholder {
color: #666;
} 
```

来源：[http ://webdesignerwall.com/tutorials/cross-browser-html5-placeholder-text](http://webdesignerwall.com/tutorials/cross-browser-html5-placeholder-text)

# c# - c# - 在列表中搜索组合

> ID：15672972
> 
> 赞同：1
> 
> 时间：2013-03-28T02:03:58.290
> 
> 标签：c#, list, search, combinations

我有以下内容：

```
public class Address{
    public string Number { get; set; }
    public string Street { get; set; }
    public string Suburb { get; set; }
}

List<Address> MyAddressList = new List<Address>();

Address MyAddress = new Address();
myAddress.Number = "5"
myAddress.Street = "Smith St"
myAddress.Suburb = "Smithsville"
MyAddressList.Add(MyAddress);

Address MyAddress2 = new Address();
myAddress2.Number = "10"
myAddress2.Street = "John St"
myAddress2.Suburb = "Johnsville"
MyAddressList.Add(MyAddress2);

string [] StreetToFind = new string {"Smith St"};
string [] SuburbToFind = new string {"Smithsville"};
string [] secondSuburbToFind = new string {"Johnsville"}; 
```

我想搜索此列表并查找值的组合，如果找到该组合则返回布尔值。

首先，我可以在 Street 属性中搜索单个值：

```
bool StreetIsFound = MyAddressList.Select(x => x.Street).Intersect(StreetToFind).Any(); 
```

郊区也一样：

```
bool SuburbIsFind = = MyAddressList.Select(x => x.Suburb).Intersect(SuburbToFind).Any(); 
```

但我希望能够同时搜索两者（bool StreetandSuburbFound）

因此，如果我搜索 StreetToFind 和 SuburbToFind，StreetandSuburbFound 将为真，但如果搜索 StreetToFind 和 secondSuburbToFind，则为假。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-28T02:05:33.503

您只需调用[`Any`](http://msdn.microsoft.com/en-us/library/bb534972.aspx). 像这样

```
var isFound = MyAddressList.Any(x => StreetToFind.Contains(x.Street) && SuburbToFind.Contains(x.Suburb)); 
```

或者在查询语法中

```
var isFound =
    (from x in MyAddressList
     where StreetToFind.Contains(x.Street)
        && SuburbToFind.Contains(x.Suburb)
     select x)
    .Any(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T02:09:33.700

或者pswg的代码的方法链版本：

```
MyAddressList.Any(x => StreetToFind.Contains(x.Street) 
                       && SuburbToFind.Contains(x.Suburb)) 
```

（显然根据需要进行调整`Contains`等）

# c# - 验证 XML 文件中的值

> ID：15672975
> 
> 赞同：1
> 
> 时间：2013-03-28T02:04:40.747
> 
> 标签：c#, xml

我正在尝试验证用户名复选框以查看输入的值是否存在于 XML 文件中。

单击按钮时，它应检查输入的名称是否存在于 XML 文件中，然后继续，如果不存在，则应出现消息框。

当前代码显示 txt_Username.Text = Pupil.forename 由于其保护级别而无法访问。

单击按钮时：

```
private void btnNext_Click(object sender, RoutedEventArgs e, Pupil p)
{
    if (txt_Username.Text = Pupil.forename)
    {
        this.Hide();
        Display nw = new Display(theClass);
        nw.ShowDialog();
        this.Show();
    }
    MessageBox.Show("Cannot Find username");
} 
```

学生班级：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace PassingData
{
    public class Pupil
    {
        private string forename;
        private int score;

        public Pupil(string forename, int score)
        {
            this.forename = forename;
            this.score = score;
        }

        public Pupil()
        {
            this.forename = "Unknown";
        }

        public string Forename
        {
            get { return forename; }
            set { forename = value; }
        }

        public int Score
        {
            get { return score; }
            set { score = value; }
        }

        override public string ToString()
        {
            string output = forename + "\t" + score;
            return output;
        }
    }
} 
```

XML 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<ArrayOfPupil xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Pupil>
    <Forename>Andy</Forename>
    <Score>0</Score>
  </Pupil>
  <Pupil>
    <Forename>Bob</Forename>
    <Score>10</Score>
  </Pupil>
  <Pupil>
    <Forename>Carl</Forename>
    <Score>20</Score>
  </Pupil>
  <Pupil>
    <Forename>Dave</Forename>
    <Score>30</Score>
  </Pupil>
  <Pupil>
    <Forename>Eric</Forename>
    <Score>40</Score>
  </Pupil>
  <Pupil>
    <Forename>Frank</Forename>
    <Score>50</Score>
  </Pupil>
</ArrayOfPupil> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T02:09:29.823

1.  'forename' 是一个私有变量
2.  `Pupil`不是静态类
3.  您需要创建一个实例`Pupil`并改为使用`Forename`属性。

    ie `Pupil.Forename`在非静态类上是不允许的。反而

    瞳孔 objPupil = 新瞳孔（）；var myForeName = objPupil.Forename;

4.  在你的`If`陈述中只有一个`=`。

5.  默认按钮单击处理程序/委托不能有额外的参数`Pupil p`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T02:35:07.693

1.  您正在引用“forename”（私有字段），但应该引用“Forename”（公共属性）。
2.  您正在引用“Pupil.forename”，但应该引用“p.Forename”。
3.  正如@MattMeadows 提到的，在检查相等性时应该使用“==”，而不是“=”。

我还建议仅设置和获取值的自动属性：http: [//msdn.microsoft.com/en-us/library/bb384054.aspx](http://msdn.microsoft.com/en-us/library/bb384054.aspx)。

前任：

```
public string Forename { get; set; } 
```

# php - php 和 twig 语法

> ID：15672978
> 
> 赞同：0
> 
> 时间：2013-03-28T02:04:58.547
> 
> 标签：php, symfony, twig

我有以下代码来提取所有者对象的用户名。Owner 对象本质上是商店的所有者。下面是它在 Shop 类中的定义方式。

```
 /**
     * Set owner
     *
     * @param User $owner
     * @return Shop
     */
    public function setOwner(User $owner = null)
    {
        $this->owner = $owner;

        return $this;
    }

    /**
     * Get owner
     *
     * @return User
     */
    public function getOwner()
    {
        return $this->owner;
    }
    /** 
```

如您所见，所有者返回一个用户对象。但是，当我对 User 类执行 .username 时，我总是不确定。为什么是这样？

```
"<%= '/profile/'+item.get('shop').owner.username %>"> 
```

当我执行以下操作时：

```
 "<%= '/profile/'+item.get('shop').name %>"> 
```

它打印得很好。

以下是商店中的更多代码：

```
class Shop
{
    /**
     * @ORM\Id
     * @ORM\Column(type="integer")
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    protected $id;

    /**
     * @Exclude()
     * @ORM\Column(name="isVisible", type="boolean")
     */
    private $isVisible = false;

    /**
     * @ORM\OneToOne(targetEntity="Shopious\MainBundle\Entity\ShopLogo", mappedBy="shop", cascade={"persist","remove"})
     */
    protected $shoplogo;

    /**
     * @Assert\NotBlank(message="Shope name should not be blank")
     * @ORM\Column(name="name", type="string", length=100, unique=true)
     */
    protected $name;

    /**
     * Assert\NotBlank(message="Description should not be blank")
     * @ORM\Column(name="description", type="string", length=350, nullable=true)
     */
    protected $description = "";

    /**
     * @ORM\Column(name="tags", type="text",nullable=true)
     */
    protected $tags = "";

    /**
     * @ORM\OneToMany(targetEntity="Shopious\MainBundle\Entity\Product", mappedBy="shop", cascade={"remove","persist"})
     */
    protected $products;

    /**
     * @Exclude()
     * @ORM\OneToOne(targetEntity="Shopious\UserBundle\Entity\User", inversedBy="shop")
     * @ORM\JoinColumn(name="user_id", referencedColumnName="id", onDelete="CASCADE", nullable=true)
     */
    protected $owner;

    /**
     * @Exclude()
     * @ORM\OneToOne(targetEntity="Shopious\MainBundle\Entity\PaymentInfo", inversedBy="shop", cascade={"persist","remove"})
     * @ORM\JoinColumn(name="paymentInfo_id", referencedColumnName="id" , onDelete="CASCADE")
     */
    protected $paymentInfo;

    /**
     *
     * @ORM\OneToMany(targetEntity="Shopious\MainBundle\Entity\ShopTestimonial", mappedBy="shop", cascade={"persist","remove"})
     */
    protected $testimonials;

    public function __toString()
    {
        return $this->shopname;
    }

    /**
     * @ORM\PrePersist
     */
    public function initialisation()
    {
        $this->shoplogo = new ShopLogo();
        $this->shoplogo->setShop($this);

    }
    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set owner
     *
     * @param User $owner
     * @return Shop
     */
    public function setOwner(User $owner = null)
    {
        $this->owner = $owner;

        return $this;
    }

    /**
     * Get owner
     *
     * @return User
     */
    public function getOwner()
    {
        return $this->owner;
    }
    /**
     * Constructor
     */
    public function __construct()
    {
        $this->products = new ArrayCollection();
    }

    /**
     * Set shopname
     *
     * @param string $shopname
     * @return Shop
     */
    public function setName($shopname)
    {
        $this->name = $shopname;

        //return $this;
    }

    /**
     * Get shopname
     *
     * @return string 
     */
    public function getName()
    {
        return $this->name;
    }

    /**
     * Set description
     *
     * @param string $description
     * @return Shop
     */
    public function setDescription($description)
    {
        $this->description = $description;

        return $this;
    }

    /**
     * Get description
     *
     * @return string 
     */
    public function getDescription()
    {
        return $this->description;
    }

    /**
     * Add products
     *
     * @param Product $products
     * @return Shop
     */
    public function addProduct(Product $products)
    {
        $this->products[] = $products;

        return $this;
    }

    /**
     * Remove products
     *
     * @param Product $products
     */
    public function removeProduct(Product $products)
    {
        $this->products->removeElement($products);
    }

    /**
     * Get products
     *
     * @return Collection
     */
    public function getProducts()
    {
        return $this->products;
    }

    public function getPaymentInfo()
    {
        return $this->paymentInfo;
    }

    public function setPaymentInfo(\Shopious\MainBundle\Entity\PaymentInfo $paymentInfo)
    {
        $this->paymentInfo = $paymentInfo;
    }

    /**
     * Set tags
     *
     * @param string $tags
     * @return Shop
     */
    public function setTags($tags)
    {
        $this->tags = $tags;

        return $this;
    }

    /**
     * Get tags
     *
     * @return string 
     */
    public function getTags()
    {
        return $this->tags;
    }

    /**
     * Set shoplogo
     *
     * @param Shopious\MainBundle\Entity\ShopLogo $shoplogo
     * @return Shop
     */
    public function setShoplogo(\Shopious\MainBundle\Entity\ShopLogo $shoplogo = null)
    {
        $this->shoplogo = $shoplogo;

        return $this;
    }

    /**
     * Get shoplogo
     *
     * @return Shopious\MainBundle\Entity\ShopLogo 
     */
    public function getShoplogo()
    {
        return $this->shoplogo;
    }

    /**
     * Add testimonials
     *
     * @param \Shopious\MainBundle\Entity\ShopTestimonial $testimonials
     * @return Shop
     */
    public function addTestimonial(\Shopious\MainBundle\Entity\ShopTestimonial $testimonials)
    {
        $this->testimonials[] = $testimonials;

        return $this;
    }

    /**
     * Remove testimonials
     *
     * @param \Shopious\MainBundle\Entity\ShopTestimonial $testimonials
     */
    public function removeTestimonial(\Shopious\MainBundle\Entity\ShopTestimonial $testimonials)
    {
        $this->testimonials->removeElement($testimonials);
    }

    /**
     * Get testimonials
     *
     * @return \Doctrine\Common\Collections\Collection 
     */
    public function getTestimonials()
    {
        return $this->testimonials;
    }

    /**
     * Set isVisible
     *
     * @param boolean $isVisible
     * @return Product
     */
    public function setIsVisible($isVisible)
    {
        $this->isVisible = $isVisible;

        return $this;
    }

    /**
     * Get isVisible
     *
     * @return boolean 
     */
    public function getIsVisible()
    {
        return $this->isVisible;
    }

} 
```

一些获取数据值的代码：

```
public function getItemsAction()
    {
        try{
            $query = $this->getRequest()->query;
            $em = $this->getDoctrine()->getEntityManager();
            $items = $em->getRepository('ShopiousMainBundle:Product')->filterBy(
                    $query->get('category'), 
                    $query->get('tag'), 
                    $query->get('size'), 
                    $query->get('price'), 
                    $query->get('shop'), 
                    $query->get('sort'),
                    $query->get('page')
                );

            return $this->Json($items);
        }catch(\Exception $ex){
            return $this->Json($ex->getMessage(),false);
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T02:11:10.683

听起来类所有者的名称存储在变量“名称”中，而不是“用户名”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T02:20:15.527

我认为 `protected $username;` 不只存在 `protected $name;`

如果你想

> "<%= '/profile/'+item.get('shop').owner.username %>"> 然后改

首先将此添加到您的课程中

```
 protected   $username[]; 

public function addUsers(User $user = null)
{
   array_push($this->username, $user);

    return $this->username;
}

public function getUsers()
{
   return $this->username;
} 
```

或单个用户

```
protected   $username; 

public function addUsers(User $user = null)
{
   $this->username= $user;

    return $this->username;
}

public function getUsers()
{
   return $this->username;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T03:07:24.000

我猜这是因为他们不是关系的数据。看起来您可能有一个项目，您正在调用一个方法来获取另一个对象，然后在该对象上调用另一个方法来获取另一个对象。由于第一个调用是一个代理对象，它可能不会使用它加载第二个代理对象数据。如果您像在控制器中那样查看模板外部数据中的数据，我猜它没有在那里定义。您可能希望确保在访问视图之前加载数据。我认为问题的根源在于最初的关系。

为了帮助您，您可以在获取数据或设置值的地方发布一些控制器代码。

# opencv - 在opencv中找到带有“System.AccessViolationException”的轮廓

> ID：15672980
> 
> 赞同：0
> 
> 时间：2013-03-28T02:05:12.673
> 
> 标签：opencv, image-processing, visual-studio-2010

我正在尝试将 Opencv2.4.4 中的 findContours 函数与 VS2010express(C++) 一起使用，代码如下。垫 canny_output; std::vector > 轮廓；

```
/// Detect edges using canny
Canny( src_gray, canny_output, 100, 200, 3 );
/// Find contours
threshold(canny_output,canny_output,0,255,THRESH_BINARY);

findContours( canny_output, contours, CV_RETR_TREE, CV_CHAIN_APPROX_SIMPLE ); 
```

但程序总是会在系统错误 System.AccessViolationException 的最后一行触发断点。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T03:13:09.990

建议：

1.  确保`contours`是`vector< vector<Point> >`
2.  在 Canny 操作之后，您可以直接将边缘提供给 findContour ..为什么要进行阈值处理？阈值也为零...跳过该行...因为 canny 的输出是二进制图像。
3.  确保`cannny_output`也是灰色图像。

编辑：试试这个..虽然这给出了外部轮廓..检查 findcontour 是否正在运行..

`findContours(canny_output,contours,CV_RETR_EXTERNAL,CV_CHAIN_APPROX_NONE,Point())`

# apache-flex - 如何在火花列表中呈现 DisplayObject 实例的集合？

> ID：15672981
> 
> 赞同：0
> 
> 时间：2013-03-28T02:05:14.600
> 
> 标签：apache-flex, drag-and-drop, flex-spark

是否可以从 DisplayObjects 的 ArrayCollection（即：Canvas）中显示 Spark List 显示项目？除非我指定 itemRenderer，否则类似下面的代码不会呈现任何内容。

```
<s:List dataProvider="{ displayObjects }"> 
    <s:layout>
        <s:VerticalLayout rowHeight="290" gap="20" />
    </s:layout>
</s:List> 
```

原因是利用列表的拖放功能重新排列自定义组件。目前，我正在使用 VGroup（没有拖放），并且不想重新创建使用 List 控件“免费”获得的所有拖放功能。也可以接受其他可行的解决方案。

TIA。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T00:44:45.940

尝试这个：

![在此处输入图像描述](../Images/98bf2a73a74ff5341632edc1d87b31c5.png)

//应用

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
           xmlns:s="library://ns.adobe.com/flex/spark" 
           xmlns:mx="library://ns.adobe.com/flex/mx" 
           minWidth="955" minHeight="600" 
           creationComplete="init()">
<fx:Script>
    <![CDATA[
        import mx.collections.ArrayCollection;
        import mx.containers.Canvas;

        [Bindable]private var displayObjects:ArrayCollection = new ArrayCollection();
        [Bindable]private var size:int = 40;

        private const COLOR:Array = ["0x00ff00", "0xff0000", "0x0000ff", "0xffff00" , "0x00ffff"];

        private function doAddCanvas(colorId:int):Canvas
        {
            var canvas:Canvas = new Canvas();
            canvas.setStyle("backgroundColor", COLOR[colorId]);
            canvas.width = size;
            canvas.height = size;
            return canvas;
        }

        protected function init():void
        {
            for (var i:int = 0; i < 5; i++)
                displayObjects.addItem(doAddCanvas(i));
        }
    ]]>
</fx:Script>

<s:VGroup x="20" y="20">
    <s:List 
        width="100" height="150" 
        dataProvider="{displayObjects}" 
        itemRenderer="com.ListItemRenderer" 
        dragEnabled="true" dropEnabled="true" 
        dragMoveEnabled="true">

        <s:layout>
            <s:VerticalLayout rowHeight="{size}" gap="20" />
        </s:layout>
    </s:List>
</s:VGroup>
</s:Application> 
```

//ItemRenderer

```
<?xml version="1.0" encoding="utf-8"?>
<s:ItemRenderer xmlns:fx="http://ns.adobe.com/mxml/2009" 
            xmlns:s="library://ns.adobe.com/flex/spark" 
            xmlns:mx="library://ns.adobe.com/flex/mx" 
            autoDrawBackground="true">
<fx:Script>
    <![CDATA[
        import mx.containers.Canvas;

        override public function set data(value:Object):void
        {
            if (value != null)
            {
                hgMain.removeAllElements();
                hgMain.addElement(value as Canvas);
            }
            super.data = value;
        }
    ]]>
</fx:Script>

<s:HGroup id="hgMain" width="100%" height="100%"/>

</s:ItemRenderer> 
```

# c# - 避免在 xml 序列化期间序列化私有数据成员

> ID：15672983
> 
> 赞同：-1
> 
> 时间：2013-03-28T02:05:15.680
> 
> 标签：c#, wcf

我有一个如下的数据合同：

```
[DataContract]
class Person
{
    private string m_name;
    [DataMember]
    public string Name
     { get {return m_name;}
       set {m_name = value;}
     }
} 
```

当 xml 序列化程序序列化此对象时，它会生成带有私有成员的 xml，例如

```
<person><m_name>john</m_name></person> 
```

如何强制序列化程序仅序列化公共属性。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T02:55:21.910

您的私人成员写入 xml 很奇怪。我试图模仿你的情况，序列化程序只写了公共字段：

```
    [数据合约]
    公共类人
    {
        私有字符串 m_name;
        [数据成员]
        公共字符串名称
        {
            得到 { 返回 m_name; }
            设置 { m_name = 值；}
        }
    }

 `private void Form1_Load(object sender, EventArgs e)
    {
        var person = new Person() {Name = "john"};

        var xs = new XmlSerializer(typeof(Person));
        var sw = new StreamWriter(@"c:\person.xml");
        xs.Serialize(sw, person);
    }` 

您还可以阅读：http: [//msdn.microsoft.com/en-us/library/83y7df3e%28VS.71%29.aspx](http://msdn.microsoft.com/en-us/library/83y7df3e%28VS.71%29.aspx)

            回答 #2

赞同：1

时间：2013-03-28T06:33:21.410

I did something similar to Andark's answer, except I used the `DataContractSerializer` instead of `XmlSerializer`.  This was done in VS 2012 targeting .NET 4.5.

Here's the test code:

```
using Sytem;
using System.IO;
using System.Runtime.Serialization;

namespace ConsoleApplication1
{

    class Program
    {

        static void Main(string[] args)
        {

            Person myPerson = new Person() { Name = "Tim" };

            using (FileStream writer = new FileStream("Person.xml", FileMode.Create, FileAccess.Write))
            {

                DataContractSerializer dcs = new DataContractSerializer(typeof(Person));
                dcs.WriteObject(writer, myPerson);
            }
        }
    }

    [DataContract]
    class Person
    {

        private string m_name;

        public string Name
        {
            get
            {
                return m_name;
            }
            set
            {
                m_name = value;
            }
        }
    }
} 
```

When I run this, I get the following XML:

```
<Person xmlns="http://schemas.datacontract.org/2004/07/ConsoleApplication1"
        xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
  <Name>Tim</Name>
<Person> 
```

Which is what is expected.

It's important to note that the default serializer for `DataContract` is the `DataContractSerializer`, **not** `XmlSerializer`, and there are some differences.  Only members that are marked with `[DataMember]` should be serialized, and the access level (private, public, etc) is irrelevant - if you mark a private field or member with `[DataMember]`, it will be serialized.

```

# visual-c++ - c++ 警告：期望声明

> ID：15672987
> 
> 赞同：0
> 
> 时间：2013-03-28T02:05:35.987
> 
> 标签：visual-c++, compiler-errors

我在模板类中实现了一个 c++ 函数`Valli<I>`。我正在使用 Visual C++ IDE。总是有一个错误`while`是：

```
expected a declaration 
```

我一遍又一遍地检查代码，并没有发现任何错误。

```
template<class I>
void Valli<I>::insert(I& new_item){
    int front=0;
    int rear=links.size()-1;
    int mid=(front+rear)/2;

    //this while loop binsearches the vector<iterator>
    while(rear!=front){
        if(new_item>links[mid]*){
        front=mid;
        mid=(front+rear)/2;
        }else{
            if(new_item<links[mid]*){
            rear=mid;
            mid=(front+rear)/2;
            }else{

            rear=mid;
            front=mid;
            }
        }
    }
...
...
} 
```

# android - 如何选择首先使用哪个 editText？

> ID：15672988
> 
> 赞同：0
> 
> 时间：2013-03-28T02:05:46.647
> 
> 标签：android, cursor, android-edittext, selected

我的手机上有两个编辑文本字段：

“姓名：”和“电话：”

每当我启动我的程序时，我的光标已经在数字键盘拉起的“电话”字段中。但是，我希望它以第一个 editText 'name' 为中心，以便常规键盘拉起。

有谁知道为什么会这样，以及如何纠正它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T02:09:22.323

```
(EditText)txtName = findViewById(R.id.NAME_ID);
txtName.requestFocus(); 
```

膨胀布局后，在 onCreate() 中执行此操作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T02:07:26.987

查看`requestFocus`布局上的标签

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T02:08:45.017

您可以在代码中使用视图上的 requestFocus() 方法执行此操作：

[https://developer.android.com/reference/android/view/View.html#requestFocus()](https://developer.android.com/reference/android/view/View.html#requestFocus())

或在布局中的视图标签内使用标签：

[https://developer.android.com/guide/topics/resources/layout-resource.html#requestfocus-element](https://developer.android.com/guide/topics/resources/layout-resource.html#requestfocus-element)

# excel-2007 - 在 LibreOffice/Excel 中制作动态公式时需要帮助

> ID：15672989
> 
> 赞同：0
> 
> 时间：2013-03-28T02:06:04.423
> 
> 标签：excel-2007, excel-formula

我需要帮助制作动态公式，但我不知道该怎么做。这是我的结构。

```
A4=1
B4=0
C4=1
D4=SUM(A4+B4+C4)
H4=(A4-C4)/D4*100 
```

现在我们来到单元格 J4。我需要 J4 做的是：如果 H4 小于 78%，我希望它告诉我在单元格 A4 中还需要多少才能在单元格 H4 中显示 78% 或更高的值。这是我拥有的示例公式，但它不正确。

```
=IF(H4>=0.78,"You 're fine","You Need "&INT((SUM(A4:C4)*0.78+H4)/0.22)&" to get to 78%") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T10:10:57.283

尝试这个：

```
 =IF(H4>=78,"OK",CONCATENATE("You need ",INT((A4/H4)*(100+H4))," to get to your goal"))

Test Values:
A4=100
B4=0
C4=56

Sums:
D4= 156
H4=28 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T04:00:01.677

*也许*这会适合：

`=IF(H4<78,"You Need "&ROUNDUP((89*C4+39*B4)/11-A4,2)&" to get to 78%","You're fine")`

# javascript - 在Javascript中引用数组的最后一个元素？

> ID：15672990
> 
> 赞同：1
> 
> 时间：2013-03-28T02:06:08.183
> 
> 标签：javascript

在我的代码中，我有很多这样的代码：

```
my_array[my_array.length - 1] = sth; 
```

是否可以定义一个简单的变量来指向数组的最后一个元素？像这样：

```
var ref =  (&|*, sth like that) my_array[my_array.length - 1];
ref = sth; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-28T02:12:09.307

您将不得不更改数组原型，并像下面这样使用它：

```
var arr = ['a','b','c'];

Array.prototype.last=function() {
    if(this.length >= 1) {
        return this[this.length - 1];
    }
    else {
        return null;
    }
};

arr.last(); 
```

Shuold 工作 - 您可以在 Chrome JS 控制台中检查它。

# javascript - 为跨域 ajax 调用配置 apache mod_proxy

> ID：15672993
> 
> 赞同：0
> 
> 时间：2013-03-28T02:06:23.870
> 
> 标签：javascript, apache, api, mod-proxy

我今天开始开发一个使用 Clipped API ( [http://clipped.me/api.html](http://clipped.me/api.html) ) 的小型 JavaScript 应用程序，但了解到存在跨域 AJAX 调用问题，并且 API 的开发人员没有添加支持 JSONP。这是应用程序本身：

```
var clippedAPI = "http://clipped.me/algorithm/clippedapi.php";

    $.ajax({
        url: clippedAPI,
        type: "GET",
        dataType: "JSONP",
        data: {
        url: "http://pandodaily.com/2013/03/26/y-combinator-demo-day-2013-still-looking-for- the-next-airbnb-or-dropbox/"}
    }).done(function(json) {
        console.log("JSON Data: " + json.title );
    }).fail(function(jqxhr, textStatus, error){
        var err = textStatus + ', ' + error;
        console.log("Request Failed: " + err);
}); 
```

我已经在我的 Ubuntu 机器上设置了 Apache 服务器，并被建议使用 mod_proxy 来设置反向代理。问题是我只是不知道该怎么做——这是我第一次使用 Apache。我知道所有基础知识，例如在终端中访问我的主要 Apache 配置文件。任何人都可以告诉菜鸟如何做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T02:17:06.560

## Ubuntu 中的 Apache mod_proxy

在 Ubuntu 中使用 Apache 设置反向代理：

**1.安装reverse_proxy模块**

```
sudo apt-get install libapache2-mod-proxy-html 
```

**2\. 如果尚未安装 libxml，请安装它。**

```
apt-get install libxml2-dev 
```

**3.加载apache2.conf文件中的模块**

```
LoadModule  proxy_module         /usr/lib/apache2/modules/mod_proxy.so
LoadModule  proxy_http_module    /usr/lib/apache2/modules/mod_proxy_http.so
LoadModule  headers_module       /usr/lib/apache2/modules/mod_headers.so
LoadModule  deflate_module       /usr/lib/apache2/modules/mod_deflate.so
LoadFile    /usr/lib/libxml2.so 
```

4.假设您想转发所有开始到**internal.server**的请求，然后将以下内容添加到您的 apache2.conf 文件中

```
# Disable proxy requests, using ProxyPass in vhost
ProxyRequests Off

# Block all requests
<Proxy *>
  Order deny,allow
  Deny from all
</Proxy>

<Proxy balancer://cluster>
        BalancerMember http://internal.server:802
        BalancerMember http://internal.server:801
        #below is to transfer sessions
        #ProxySet lbmethod=bytraffic

</Proxy>

<Location /balancer-manager>
    SetHandler balancer-manager
    Order Deny,Allow
#   Deny from all
    Allow from all
</Location> 
```

5.祝你一切顺利！

**更新：**

```
sudo  aptitude download libxml2
sudo  ar -xf libxml2_2.7.8.dfsg-5.1ubuntu4_amd64.deb 
```

**以下文件将从 ubuntu 包中提取。
control.tar.gz data.tar.gz debian-binary libxml2_2.7.8.dfsg-5.1ubuntu4_amd64.deb**

```
# rm libxml2_2.7.8.dfsg-5.1ubuntu4_amd64.deb control.tar.gz
# tar xf data.tar.gz
# cd usr/lib/x86_64-linux-gnu/
# ls 
```

**以下文件将在那里
libxml2.so.2 libxml2.so.2.7.8**

```
# mv * /usr/lib/x86_64-linux-gnu/
# cp /usr/lib/x86_64-linux-gnu/libxml2.so.2* /usr/lib/
# /etc/init.d/apache2 start 
```

*   启动 web 服务器 apache2 [确定]

# ruby-on-rails - 如何在 Rails 3.2.11 中刷新生产日志？

> ID：15672998
> 
> 赞同：1
> 
> 时间：2013-03-28T02:06:54.900
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2, production-environment

现在，我的 Rails 应用程序似乎每隔一段时间就会写入 production.log。如何使日志立即更新？或者有没有办法强制日志刷新？